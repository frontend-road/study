{"id":82764,"title":"JavaScriptæ‰§è¡Œï¼ˆä¸€ï¼‰ï¼šPromiseé‡Œçš„ä»£ç ä¸ºä»€ä¹ˆæ¯”setTimeoutå…ˆæ‰§è¡Œï¼Ÿ","content":"<p>ä½ å¥½ï¼Œæˆ‘æ˜¯winterã€‚è¿™ä¸€éƒ¨åˆ†æˆ‘ä»¬æ¥è®²ä¸€è®²JavaScriptçš„æ‰§è¡Œã€‚</p><p>é¦–å…ˆæˆ‘ä»¬è€ƒè™‘ä¸€ä¸‹ï¼Œå¦‚æœæˆ‘ä»¬æ˜¯æµè§ˆå™¨æˆ–è€…Nodeçš„å¼€å‘è€…ï¼Œæˆ‘ä»¬è¯¥å¦‚ä½•ä½¿ç”¨JavaScriptå¼•æ“ã€‚</p><p>å½“æ‹¿åˆ°ä¸€æ®µJavaScriptä»£ç æ—¶ï¼Œæµè§ˆå™¨æˆ–è€…Nodeç¯å¢ƒé¦–å…ˆè¦åšçš„å°±æ˜¯ï¼›ä¼ é€’ç»™JavaScriptå¼•æ“ï¼Œå¹¶ä¸”è¦æ±‚å®ƒå»æ‰§è¡Œã€‚</p><p>ç„¶è€Œï¼Œæ‰§è¡ŒJavaScriptå¹¶éä¸€é”¤å­ä¹°å–ï¼Œå®¿ä¸»ç¯å¢ƒå½“é‡åˆ°ä¸€äº›äº‹ä»¶æ—¶ï¼Œä¼šç»§ç»­æŠŠä¸€æ®µä»£ç ä¼ é€’ç»™JavaScriptå¼•æ“å»æ‰§è¡Œï¼Œæ­¤å¤–ï¼Œæˆ‘ä»¬å¯èƒ½è¿˜ä¼šæä¾›APIç»™JavaScriptå¼•æ“ï¼Œæ¯”å¦‚setTimeoutè¿™æ ·çš„APIï¼Œå®ƒä¼šå…è®¸JavaScriptåœ¨ç‰¹å®šçš„æ—¶æœºæ‰§è¡Œã€‚</p><p>æ‰€ä»¥ï¼Œæˆ‘ä»¬é¦–å…ˆåº”è¯¥å½¢æˆä¸€ä¸ªæ„Ÿæ€§çš„è®¤çŸ¥ï¼šä¸€ä¸ªJavaScriptå¼•æ“ä¼šå¸¸é©»äºå†…å­˜ä¸­ï¼Œå®ƒç­‰å¾…ç€æˆ‘ä»¬ï¼ˆå®¿ä¸»ï¼‰æŠŠJavaScriptä»£ç æˆ–è€…å‡½æ•°ä¼ é€’ç»™å®ƒæ‰§è¡Œã€‚</p><p>åœ¨ES3å’Œæ›´æ—©çš„ç‰ˆæœ¬ä¸­ï¼ŒJavaScriptæœ¬èº«è¿˜æ²¡æœ‰å¼‚æ­¥æ‰§è¡Œä»£ç çš„èƒ½åŠ›ï¼Œè¿™ä¹Ÿå°±æ„å‘³ç€ï¼Œå®¿ä¸»ç¯å¢ƒä¼ é€’ç»™JavaScriptå¼•æ“ä¸€æ®µä»£ç ï¼Œå¼•æ“å°±æŠŠä»£ç ç›´æ¥é¡ºæ¬¡æ‰§è¡Œäº†ï¼Œè¿™ä¸ªä»»åŠ¡ä¹Ÿå°±æ˜¯å®¿ä¸»å‘èµ·çš„ä»»åŠ¡ã€‚</p><p>ä½†æ˜¯ï¼Œåœ¨ES5ä¹‹åï¼ŒJavaScriptå¼•å…¥äº†Promiseï¼Œè¿™æ ·ï¼Œä¸éœ€è¦æµè§ˆå™¨çš„å®‰æ’ï¼ŒJavaScriptå¼•æ“æœ¬èº«ä¹Ÿå¯ä»¥å‘èµ·ä»»åŠ¡äº†ã€‚</p><!-- [[[read_end]]] --><p>ç”±äºæˆ‘ä»¬è¿™é‡Œä¸»è¦è®²JavaScriptè¯­è¨€ï¼Œé‚£ä¹ˆé‡‡çº³JSCå¼•æ“çš„æœ¯è¯­ï¼Œæˆ‘ä»¬æŠŠå®¿ä¸»å‘èµ·çš„ä»»åŠ¡ç§°ä¸ºå®è§‚ä»»åŠ¡ï¼ŒæŠŠJavaScriptå¼•æ“å‘èµ·çš„ä»»åŠ¡ç§°ä¸ºå¾®è§‚ä»»åŠ¡ã€‚</p><h2>å®è§‚å’Œå¾®è§‚ä»»åŠ¡</h2><p>JavaScriptå¼•æ“ç­‰å¾…å®¿ä¸»ç¯å¢ƒåˆ†é…å®è§‚ä»»åŠ¡ï¼Œåœ¨æ“ä½œç³»ç»Ÿä¸­ï¼Œé€šå¸¸ç­‰å¾…çš„è¡Œä¸ºéƒ½æ˜¯ä¸€ä¸ªäº‹ä»¶å¾ªç¯ï¼Œæ‰€ä»¥åœ¨Nodeæœ¯è¯­ä¸­ï¼Œä¹Ÿä¼šæŠŠè¿™ä¸ªéƒ¨åˆ†ç§°ä¸ºäº‹ä»¶å¾ªç¯ã€‚</p><p>ä¸è¿‡ï¼Œæœ¯è¯­æœ¬èº«å¹¶éæˆ‘ä»¬éœ€è¦é‡ç‚¹è®¨è®ºçš„å†…å®¹ï¼Œæˆ‘ä»¬åœ¨è¿™é‡ŒæŠŠé‡ç‚¹æ”¾åœ¨äº‹ä»¶å¾ªç¯çš„åŸç†ä¸Šã€‚åœ¨åº•å±‚çš„C/C++ä»£ç ä¸­ï¼Œè¿™ä¸ªäº‹ä»¶å¾ªç¯æ˜¯ä¸€ä¸ªè·‘åœ¨ç‹¬ç«‹çº¿ç¨‹ä¸­çš„å¾ªç¯ï¼Œæˆ‘ä»¬ç”¨ä¼ªä»£ç æ¥è¡¨ç¤ºï¼Œå¤§æ¦‚æ˜¯è¿™æ ·çš„ï¼š</p><pre><code class=\"language-C\">while(TRUE) {\n    r = wait();\n    execute(r);\n}\n</code></pre><p>æˆ‘ä»¬å¯ä»¥çœ‹åˆ°ï¼Œæ•´ä¸ªå¾ªç¯åšçš„äº‹æƒ…åŸºæœ¬ä¸Šå°±æ˜¯åå¤â€œç­‰å¾…-æ‰§è¡Œâ€ã€‚å½“ç„¶ï¼Œå®é™…çš„ä»£ç ä¸­å¹¶æ²¡æœ‰è¿™ä¹ˆç®€å•ï¼Œè¿˜æœ‰è¦åˆ¤æ–­å¾ªç¯æ˜¯å¦ç»“æŸã€å®è§‚ä»»åŠ¡é˜Ÿåˆ—ç­‰é€»è¾‘ï¼Œè¿™é‡Œä¸ºäº†æ–¹ä¾¿ä½ ç†è§£ï¼Œæˆ‘å°±æŠŠè¿™äº›éƒ½çœç•¥æ‰äº†ã€‚</p><p>è¿™é‡Œæ¯æ¬¡çš„æ‰§è¡Œè¿‡ç¨‹ï¼Œå…¶å®éƒ½æ˜¯ä¸€ä¸ªå®è§‚ä»»åŠ¡ã€‚æˆ‘ä»¬å¯ä»¥å¤§æ¦‚ç†è§£ï¼šå®è§‚ä»»åŠ¡çš„é˜Ÿåˆ—å°±ç›¸å½“äºäº‹ä»¶å¾ªç¯ã€‚</p><p>åœ¨å®è§‚ä»»åŠ¡ä¸­ï¼ŒJavaScriptçš„Promiseè¿˜ä¼šäº§ç”Ÿå¼‚æ­¥ä»£ç ï¼ŒJavaScriptå¿…é¡»ä¿è¯è¿™äº›å¼‚æ­¥ä»£ç åœ¨ä¸€ä¸ªå®è§‚ä»»åŠ¡ä¸­å®Œæˆï¼Œå› æ­¤ï¼Œæ¯ä¸ªå®è§‚ä»»åŠ¡ä¸­åˆåŒ…å«äº†ä¸€ä¸ªå¾®è§‚ä»»åŠ¡é˜Ÿåˆ—ï¼š</p><p><img src=\"https://static001.geekbang.org/resource/image/16/65/16f70a9a51a65d5302166b0d78414d65.jpg?wh=1398*1636\" alt=\"\"></p><p>æœ‰äº†å®è§‚ä»»åŠ¡å’Œå¾®è§‚ä»»åŠ¡æœºåˆ¶ï¼Œæˆ‘ä»¬å°±å¯ä»¥å®ç°JavaScriptå¼•æ“çº§å’Œå®¿ä¸»çº§çš„ä»»åŠ¡äº†ï¼Œä¾‹å¦‚ï¼šPromiseæ°¸è¿œåœ¨é˜Ÿåˆ—å°¾éƒ¨æ·»åŠ å¾®è§‚ä»»åŠ¡ã€‚setTimeoutç­‰å®¿ä¸»APIï¼Œåˆ™ä¼šæ·»åŠ å®è§‚ä»»åŠ¡ã€‚</p><p>æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬æ¥è¯¦ç»†ä»‹ç»ä¸€ä¸‹Promiseã€‚</p><h2>Promise</h2><p>Promiseæ˜¯JavaScriptè¯­è¨€æä¾›çš„ä¸€ç§æ ‡å‡†åŒ–çš„å¼‚æ­¥ç®¡ç†æ–¹å¼ï¼Œå®ƒçš„æ€»ä½“æ€æƒ³æ˜¯ï¼Œéœ€è¦è¿›è¡Œioã€ç­‰å¾…æˆ–è€…å…¶å®ƒå¼‚æ­¥æ“ä½œçš„å‡½æ•°ï¼Œä¸è¿”å›çœŸå®ç»“æœï¼Œè€Œè¿”å›ä¸€ä¸ªâ€œæ‰¿è¯ºâ€ï¼Œå‡½æ•°çš„è°ƒç”¨æ–¹å¯ä»¥åœ¨åˆé€‚çš„æ—¶æœºï¼Œé€‰æ‹©ç­‰å¾…è¿™ä¸ªæ‰¿è¯ºå…‘ç°ï¼ˆé€šè¿‡Promiseçš„thenæ–¹æ³•çš„å›è°ƒï¼‰ã€‚</p><p>Promiseçš„åŸºæœ¬ç”¨æ³•ç¤ºä¾‹å¦‚ä¸‹ï¼š</p><pre><code>    function sleep(duration) {\n        return new Promise(function(resolve, reject) {\n            setTimeout(resolve,duration);\n        })\n    }\n    sleep(1000).then( ()=&gt; console.log(&quot;finished&quot;));\n</code></pre><p>è¿™æ®µä»£ç å®šä¹‰äº†ä¸€ä¸ªå‡½æ•°sleepï¼Œå®ƒçš„ä½œç”¨æ˜¯ç­‰å€™ä¼ å…¥å‚æ•°æŒ‡å®šçš„æ—¶é•¿ã€‚</p><p>Promiseçš„thenå›è°ƒæ˜¯ä¸€ä¸ªå¼‚æ­¥çš„æ‰§è¡Œè¿‡ç¨‹ï¼Œä¸‹é¢æˆ‘ä»¬å°±æ¥ç ”ç©¶ä¸€ä¸‹Promiseå‡½æ•°ä¸­çš„æ‰§è¡Œé¡ºåºï¼Œæˆ‘ä»¬æ¥çœ‹ä¸€æ®µä»£ç ç¤ºä¾‹ï¼š</p><pre><code>    var r = new Promise(function(resolve, reject){\n        console.log(&quot;a&quot;);\n        resolve()\n    });\n    r.then(() =&gt; console.log(&quot;c&quot;));\n    console.log(&quot;b&quot;)\n</code></pre><p>æˆ‘ä»¬æ‰§è¡Œè¿™æ®µä»£ç åï¼Œæ³¨æ„è¾“å‡ºçš„é¡ºåºæ˜¯ a b cã€‚åœ¨è¿›å…¥console.log(â€œbâ€) ä¹‹å‰ï¼Œæ¯«æ— ç–‘é—® r å·²ç»å¾—åˆ°äº†resolveï¼Œä½†æ˜¯Promiseçš„resolveå§‹ç»ˆæ˜¯å¼‚æ­¥æ“ä½œï¼Œæ‰€ä»¥cæ— æ³•å‡ºç°åœ¨bä¹‹å‰ã€‚</p><p>æ¥ä¸‹æ¥æˆ‘ä»¬è¯•è¯•è·ŸsetTimeoutæ··ç”¨çš„Promiseã€‚</p><p>åœ¨è¿™æ®µä»£ç ä¸­ï¼Œæˆ‘è®¾ç½®äº†ä¸¤æ®µäº’ä¸ç›¸å¹²çš„å¼‚æ­¥æ“ä½œï¼šé€šè¿‡setTimeoutæ‰§è¡Œconsole.log(â€œdâ€)ï¼Œé€šè¿‡Promiseæ‰§è¡Œconsole.log(â€œcâ€)ã€‚</p><pre><code>    var r = new Promise(function(resolve, reject){\n        console.log(&quot;a&quot;);\n        resolve()\n    });\n    setTimeout(()=&gt;console.log(&quot;d&quot;), 0)\n    r.then(() =&gt; console.log(&quot;c&quot;));\n    console.log(&quot;b&quot;)\n</code></pre><p>æˆ‘ä»¬å‘ç°ï¼Œä¸è®ºä»£ç é¡ºåºå¦‚ä½•ï¼Œdå¿…å®šå‘ç”Ÿåœ¨cä¹‹åï¼Œå› ä¸ºPromiseäº§ç”Ÿçš„æ˜¯JavaScriptå¼•æ“å†…éƒ¨çš„å¾®ä»»åŠ¡ï¼Œè€ŒsetTimeoutæ˜¯æµè§ˆå™¨APIï¼Œå®ƒäº§ç”Ÿå®ä»»åŠ¡ã€‚</p><p>ä¸ºäº†ç†è§£å¾®ä»»åŠ¡å§‹ç»ˆå…ˆäºå®ä»»åŠ¡ï¼Œæˆ‘ä»¬è®¾è®¡ä¸€ä¸ªå®éªŒï¼šæ‰§è¡Œä¸€ä¸ªè€—æ—¶1ç§’çš„Promiseã€‚</p><pre><code>    setTimeout(()=&gt;console.log(&quot;d&quot;), 0)\n    var r = new Promise(function(resolve, reject){\n        resolve()\n    });\n    r.then(() =&gt; { \n        var begin = Date.now();\n        while(Date.now() - begin &lt; 1000);\n        console.log(&quot;c1&quot;) \n        new Promise(function(resolve, reject){\n            resolve()\n        }).then(() =&gt; console.log(&quot;c2&quot;))\n    });\n</code></pre><p>è¿™é‡Œæˆ‘ä»¬å¼ºåˆ¶äº†1ç§’çš„æ‰§è¡Œè€—æ—¶ï¼Œè¿™æ ·ï¼Œæˆ‘ä»¬å¯ä»¥ç¡®ä¿ä»»åŠ¡c2æ˜¯åœ¨dä¹‹åè¢«æ·»åŠ åˆ°ä»»åŠ¡é˜Ÿåˆ—ã€‚</p><p>æˆ‘ä»¬å¯ä»¥çœ‹åˆ°ï¼Œå³ä½¿è€—æ—¶ä¸€ç§’çš„c1æ‰§è¡Œå®Œæ¯•ï¼Œå†enqueçš„c2ï¼Œä»ç„¶å…ˆäºdæ‰§è¡Œäº†ï¼Œè¿™å¾ˆå¥½åœ°è§£é‡Šäº†å¾®ä»»åŠ¡ä¼˜å…ˆçš„åŸç†ã€‚</p><p>é€šè¿‡ä¸€ç³»åˆ—çš„å®éªŒï¼Œæˆ‘ä»¬å¯ä»¥æ€»ç»“ä¸€ä¸‹å¦‚ä½•åˆ†æå¼‚æ­¥æ‰§è¡Œçš„é¡ºåºï¼š</p><ul>\n<li>é¦–å…ˆæˆ‘ä»¬åˆ†ææœ‰å¤šå°‘ä¸ªå®ä»»åŠ¡ï¼›</li>\n<li>åœ¨æ¯ä¸ªå®ä»»åŠ¡ä¸­ï¼Œåˆ†ææœ‰å¤šå°‘ä¸ªå¾®ä»»åŠ¡ï¼›</li>\n<li>æ ¹æ®è°ƒç”¨æ¬¡åºï¼Œç¡®å®šå®ä»»åŠ¡ä¸­çš„å¾®ä»»åŠ¡æ‰§è¡Œæ¬¡åºï¼›</li>\n<li>æ ¹æ®å®ä»»åŠ¡çš„è§¦å‘è§„åˆ™å’Œè°ƒç”¨æ¬¡åºï¼Œç¡®å®šå®ä»»åŠ¡çš„æ‰§è¡Œæ¬¡åºï¼›</li>\n<li>ç¡®å®šæ•´ä¸ªé¡ºåºã€‚</li>\n</ul><p>æˆ‘ä»¬å†æ¥çœ‹ä¸€ä¸ªç¨å¾®å¤æ‚çš„ä¾‹å­ï¼š</p><pre><code>    function sleep(duration) {\n        return new Promise(function(resolve, reject) {\n            console.log(&quot;b&quot;);\n            setTimeout(resolve,duration);\n        })\n    }\n    console.log(&quot;a&quot;);\n    sleep(5000).then(()=&gt;console.log(&quot;c&quot;));\n</code></pre><p>è¿™æ˜¯ä¸€æ®µéå¸¸å¸¸ç”¨çš„å°è£…æ–¹æ³•ï¼Œåˆ©ç”¨PromiseæŠŠsetTimeoutå°è£…æˆå¯ä»¥ç”¨äºå¼‚æ­¥çš„å‡½æ•°ã€‚</p><p>æˆ‘ä»¬é¦–å…ˆæ¥çœ‹ï¼ŒsetTimeoutæŠŠæ•´ä¸ªä»£ç åˆ†å‰²æˆäº†2ä¸ªå®è§‚ä»»åŠ¡ï¼Œè¿™é‡Œä¸è®ºæ˜¯5ç§’è¿˜æ˜¯0ç§’ï¼Œéƒ½æ˜¯ä¸€æ ·çš„ã€‚</p><p>ç¬¬ä¸€ä¸ªå®è§‚ä»»åŠ¡ä¸­ï¼ŒåŒ…å«äº†å…ˆååŒæ­¥æ‰§è¡Œçš„ console.log(â€œaâ€); å’Œ console.log(â€œbâ€);ã€‚</p><p>setTimeoutåï¼Œç¬¬äºŒä¸ªå®è§‚ä»»åŠ¡æ‰§è¡Œè°ƒç”¨äº†resolveï¼Œç„¶åthenä¸­çš„ä»£ç å¼‚æ­¥å¾—åˆ°æ‰§è¡Œï¼Œæ‰€ä»¥è°ƒç”¨äº†console.log(â€œcâ€)ï¼Œæœ€ç»ˆè¾“å‡ºçš„é¡ºåºæ‰æ˜¯ï¼š a b cã€‚</p><p>Promiseæ˜¯JavaScriptä¸­çš„ä¸€ä¸ªå®šä¹‰ï¼Œä½†æ˜¯å®é™…ç¼–å†™ä»£ç æ—¶ï¼Œæˆ‘ä»¬å¯ä»¥å‘ç°ï¼Œå®ƒä¼¼ä¹å¹¶ä¸æ¯”å›è°ƒçš„æ–¹å¼ä¹¦å†™æ›´ç®€å•ï¼Œä½†æ˜¯ä»ES6å¼€å§‹ï¼Œæˆ‘ä»¬æœ‰äº†async/awaitï¼Œè¿™ä¸ªè¯­æ³•æ”¹è¿›è·ŸPromiseé…åˆï¼Œèƒ½å¤Ÿæœ‰æ•ˆåœ°æ”¹å–„ä»£ç ç»“æ„ã€‚</p><h2>æ–°ç‰¹æ€§ï¼šasync/await</h2><p>async/awaitæ˜¯ES2016æ–°åŠ å…¥çš„ç‰¹æ€§ï¼Œå®ƒæä¾›äº†ç”¨forã€ifç­‰ä»£ç ç»“æ„æ¥ç¼–å†™å¼‚æ­¥çš„æ–¹å¼ã€‚å®ƒçš„è¿è¡Œæ—¶åŸºç¡€æ˜¯Promiseï¼Œé¢å¯¹è¿™ç§æ¯”è¾ƒæ–°çš„ç‰¹æ€§ï¼Œæˆ‘ä»¬å…ˆæ¥çœ‹ä¸€ä¸‹åŸºæœ¬ç”¨æ³•ã€‚</p><p>asyncå‡½æ•°å¿…å®šè¿”å›Promiseï¼Œæˆ‘ä»¬æŠŠæ‰€æœ‰è¿”å›Promiseçš„å‡½æ•°éƒ½å¯ä»¥è®¤ä¸ºæ˜¯å¼‚æ­¥å‡½æ•°ã€‚</p><p>asyncå‡½æ•°æ˜¯ä¸€ç§ç‰¹æ®Šè¯­æ³•ï¼Œç‰¹å¾æ˜¯åœ¨functionå…³é”®å­—ä¹‹å‰åŠ ä¸Šasyncå…³é”®å­—ï¼Œè¿™æ ·ï¼Œå°±å®šä¹‰äº†ä¸€ä¸ªasyncå‡½æ•°ï¼Œæˆ‘ä»¬å¯ä»¥åœ¨å…¶ä¸­ä½¿ç”¨awaitæ¥ç­‰å¾…ä¸€ä¸ªPromiseã€‚</p><pre><code>function sleep(duration) {\n    return new Promise(function(resolve, reject) {\n        setTimeout(resolve,duration);\n    })\n}\nasync function foo(){\n    console.log(&quot;a&quot;)\n    await sleep(2000)\n    console.log(&quot;b&quot;)\n}\n</code></pre><p>è¿™æ®µä»£ç åˆ©ç”¨äº†æˆ‘ä»¬ä¹‹å‰å®šä¹‰çš„sleepå‡½æ•°ã€‚åœ¨å¼‚æ­¥å‡½æ•°fooä¸­ï¼Œæˆ‘ä»¬è°ƒç”¨sleepã€‚</p><p>asyncå‡½æ•°å¼ºå¤§ä¹‹å¤„åœ¨äºï¼Œå®ƒæ˜¯å¯ä»¥åµŒå¥—çš„ã€‚æˆ‘ä»¬åœ¨å®šä¹‰äº†ä¸€æ‰¹åŸå­æ“ä½œçš„æƒ…å†µä¸‹ï¼Œå¯ä»¥åˆ©ç”¨asyncå‡½æ•°ç»„åˆå‡ºæ–°çš„asyncå‡½æ•°ã€‚</p><pre><code>function sleep(duration) {\n    return new Promise(function(resolve, reject) {\n        setTimeout(resolve,duration);\n    })\n}\nasync function foo(name){\n    await sleep(2000)\n    console.log(name)\n}\nasync function foo2(){\n    await foo(&quot;a&quot;);\n    await foo(&quot;b&quot;);\n}\n</code></pre><p>è¿™é‡Œfoo2ç”¨awaitè°ƒç”¨äº†ä¸¤æ¬¡å¼‚æ­¥å‡½æ•°fooï¼Œå¯ä»¥çœ‹åˆ°ï¼Œå¦‚æœæˆ‘ä»¬æŠŠsleepè¿™æ ·çš„å¼‚æ­¥æ“ä½œæ”¾å…¥æŸä¸€ä¸ªæ¡†æ¶æˆ–è€…åº“ä¸­ï¼Œä½¿ç”¨è€…å‡ ä¹ä¸éœ€è¦äº†è§£Promiseçš„æ¦‚å¿µå³å¯è¿›è¡Œå¼‚æ­¥ç¼–ç¨‹äº†ã€‚</p><p>æ­¤å¤–ï¼Œgenerator/iteratorä¹Ÿå¸¸å¸¸è¢«è·Ÿå¼‚æ­¥ä¸€èµ·æ¥è®²ï¼Œæˆ‘ä»¬å¿…é¡»è¯´æ˜ generator/iterator å¹¶éå¼‚æ­¥ä»£ç ï¼Œåªæ˜¯åœ¨ç¼ºå°‘async/awaitçš„æ—¶å€™ï¼Œä¸€äº›æ¡†æ¶ï¼ˆæœ€è‘—åçš„è¦æ•°coï¼‰ä½¿ç”¨è¿™æ ·çš„ç‰¹æ€§æ¥æ¨¡æ‹Ÿasync/awaitã€‚</p><p>ä½†æ˜¯generatorå¹¶éè¢«è®¾è®¡æˆå®ç°å¼‚æ­¥ï¼Œæ‰€ä»¥æœ‰äº†async/awaitä¹‹åï¼Œgenerator/iteratoræ¥æ¨¡æ‹Ÿå¼‚æ­¥çš„æ–¹æ³•åº”è¯¥è¢«åºŸå¼ƒã€‚</p><h2>ç»“è¯­</h2><p>åœ¨ä»Šå¤©çš„æ–‡ç« é‡Œï¼Œæˆ‘ä»¬å­¦ä¹ äº†JavaScriptæ‰§è¡Œéƒ¨åˆ†çš„çŸ¥è¯†ï¼Œé¦–å…ˆæˆ‘ä»¬å­¦ä¹ äº†JavaScriptçš„å®è§‚ä»»åŠ¡å’Œå¾®è§‚ä»»åŠ¡ç›¸å…³çš„çŸ¥è¯†ã€‚æˆ‘ä»¬æŠŠå®¿ä¸»å‘èµ·çš„ä»»åŠ¡ç§°ä¸ºå®è§‚ä»»åŠ¡ï¼ŒæŠŠJavaScriptå¼•æ“å‘èµ·çš„ä»»åŠ¡ç§°ä¸ºå¾®è§‚ä»»åŠ¡ã€‚è®¸å¤šçš„å¾®è§‚ä»»åŠ¡çš„é˜Ÿåˆ—ç»„æˆäº†å®è§‚ä»»åŠ¡ã€‚</p><p>é™¤æ­¤ä¹‹å¤–ï¼Œæˆ‘ä»¬è¿˜å±•å¼€ä»‹ç»äº†ç”¨Promiseæ¥æ·»åŠ å¾®è§‚ä»»åŠ¡çš„æ–¹å¼ï¼Œå¹¶ä¸”ä»‹ç»äº†async/awaitè¿™ä¸ªè¯­æ³•çš„æ”¹è¿›ã€‚</p><p>æœ€åï¼Œç•™ç»™ä½ ä¸€ä¸ªå°ç»ƒä¹ ï¼šæˆ‘ä»¬ç°åœ¨è¦å®ç°ä¸€ä¸ªçº¢ç»¿ç¯ï¼ŒæŠŠä¸€ä¸ªåœ†å½¢divæŒ‰ç…§ç»¿è‰²3ç§’ï¼Œé»„è‰²1ç§’ï¼Œçº¢è‰²2ç§’å¾ªç¯æ”¹å˜èƒŒæ™¯è‰²ï¼Œä½ ä¼šæ€æ ·ç¼–å†™è¿™ä¸ªä»£ç å‘¢ï¼Ÿæ¬¢è¿ä½ ç•™è¨€è®¨è®ºã€‚</p><p></p>","neighbors":{"left":{"article_title":"JavaScriptå¯¹è±¡ï¼šä½ çŸ¥é“å…¨éƒ¨çš„å¯¹è±¡åˆ†ç±»å—ï¼Ÿ","id":80011},"right":{"article_title":"JavaScriptæ‰§è¡Œï¼ˆäºŒï¼‰ï¼šé—­åŒ…å’Œæ‰§è¡Œä¸Šä¸‹æ–‡åˆ°åº•æ˜¯æ€ä¹ˆå›äº‹ï¼Ÿ","id":83302}},"comments":[{"had_liked":false,"id":69886,"user_name":"æ¨å­¦èŒ‚","can_delete":false,"product_type":"c1","uid":1377459,"ip_address":"","ucode":"C12DAA295CC945","user_header":"https://static001.geekbang.org/account/avatar/00/15/04/b3/3f0b69f9.jpg","comment_is_top":false,"comment_ctime":1550896537,"is_pvip":false,"replies":[{"id":"25838","content":"è¿™ä¸ªå†™çš„å®Œå…¨æŒ‘ä¸å‡ºæ¯›ç—…ï¼Œå…¶å®ƒåŒå­¦å¯ä»¥å‚è€ƒã€‚","user_name":"ä½œè€…å›å¤","user_name_real":"winter","uid":"1268524","ctime":1551425286,"ip_address":"","comment_id":69886,"utype":1}],"discussion_count":14,"race_medal":0,"score":"2295063432601","product_id":100023201,"comment_content":"function sleep(duration){<br>    return new Promise(function(resolve){<br>        setTimeout(resolve, duration);<br>    })<br>}<br>async function changeColor(duration,color){<br>    document.getElementById(&quot;traffic-light&quot;).style.background = color;<br>    await sleep(duration);<br><br>}<br>async function main(){<br>    while(true){<br>        await changeColor(3000,&quot;green&quot;);<br>        await changeColor(1000, &quot;yellow&quot;);<br>        await changeColor(2000, &quot;red&quot;);<br>    }<br>}<br>main()","like_count":535,"discussions":[{"author":{"id":1268524,"avatar":"https://static001.geekbang.org/account/avatar/00/13/5b/2c/12bfd3cd.jpg","nickname":"winter","note":"","ucode":"2B068EDEAFEB56","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":440332,"discussion_content":"è¿™ä¸ªå†™çš„å®Œå…¨æŒ‘ä¸å‡ºæ¯›ç—…ï¼Œå…¶å®ƒåŒå­¦å¯ä»¥å‚è€ƒã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1551425286,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1126631,"avatar":"http://thirdwx.qlogo.cn/mmopen/vi_32/s0bx4WXQNkAJ3c3map0g6dlt3sKDgTtN7Ria96YoufjQcVVI8Shv5CN1jnK1ZTImNnlPcibRqvyiaUuhpIvV1TpnQ/132","nickname":"wingsico","note":"","ucode":"A91CB7B0497708","race_medal":0,"user_type":1,"is_pvip":true},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":222494,"discussion_content":"changeColorå’Œsleepè€¦åˆåœ¨ä¸€èµ·äº†ï¼Œä¸åº”è¯¥æŠŠsleepå†™åœ¨changeColorä¸­ï¼Œåœ¨mainä¸­åº”è¯¥ä½¿ç”¨å¦‚ä¸‹æ–¹å¼ï¼š\n\n```js\nfunction changeColor(d, color) {\n    d.style.color = color\n}\n\nasync function main() {\n    while(true) {\n        changeColor(dom, &#39;green&#39;)\n        await sleep(3000)\n        changeColor(dom, &#39;yellow&#39;)\n        await sleep(1000)\n        changeColor(dom, &#39;red&#39;)\n        await sleep(2000)\n    }\n}\n```","likes_number":16,"is_delete":false,"is_hidden":false,"ctime":1586149351,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":4,"child_discussions":[{"author":{"id":1373792,"avatar":"http://thirdwx.qlogo.cn/mmopen/vi_32/mjBQmRMl11m8TYkFXlZNO5WEaGeWicHhxO64iaxpjfKcjzHPmehwmhM8ib6RszfomgZ4oXlbmaJicnGot39tnNicfVA/132","nickname":"è®¸é‡‘æ˜Ÿ","note":"","ucode":"8CC38A6871B17D","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":1126631,"avatar":"http://thirdwx.qlogo.cn/mmopen/vi_32/s0bx4WXQNkAJ3c3map0g6dlt3sKDgTtN7Ria96YoufjQcVVI8Shv5CN1jnK1ZTImNnlPcibRqvyiaUuhpIvV1TpnQ/132","nickname":"wingsico","note":"","ucode":"A91CB7B0497708","race_medal":0,"user_type":1,"is_pvip":true},"discussion":{"id":271335,"discussion_content":"è¯·é—®è¿™æ ·å†™æ¯”ä¸Šé¢å¥½åœ¨å“ªï¼Ÿ","likes_number":1,"is_delete":false,"is_hidden":false,"ctime":1590118745,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":222494,"ip_address":""},"score":271335,"extra":""},{"author":{"id":1665385,"avatar":"https://static001.geekbang.org/account/avatar/00/19/69/69/f7cde15c.jpg","nickname":"Albert.Ejiestein","note":"","ucode":"CC342398930C25","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":1373792,"avatar":"http://thirdwx.qlogo.cn/mmopen/vi_32/mjBQmRMl11m8TYkFXlZNO5WEaGeWicHhxO64iaxpjfKcjzHPmehwmhM8ib6RszfomgZ4oXlbmaJicnGot39tnNicfVA/132","nickname":"è®¸é‡‘æ˜Ÿ","note":"","ucode":"8CC38A6871B17D","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":275199,"discussion_content":"è§£è€¦","likes_number":1,"is_delete":false,"is_hidden":false,"ctime":1590676197,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":271335,"ip_address":""},"score":275199,"extra":""},{"author":{"id":1997806,"avatar":"https://static001.geekbang.org/account/avatar/00/1e/7b/ee/53124b75.jpg","nickname":"ä¸œå¡èŠå£«","note":"","ucode":"FF267B7E865AD2","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":1126631,"avatar":"http://thirdwx.qlogo.cn/mmopen/vi_32/s0bx4WXQNkAJ3c3map0g6dlt3sKDgTtN7Ria96YoufjQcVVI8Shv5CN1jnK1ZTImNnlPcibRqvyiaUuhpIvV1TpnQ/132","nickname":"wingsico","note":"","ucode":"A91CB7B0497708","race_medal":0,"user_type":1,"is_pvip":true},"discussion":{"id":320542,"discussion_content":"changeColor(dom, &#39;green&#39;)\n        await sleep(3000)\nè¿™ä¸¤è¡Œå†å°è£…æˆä¸€ä¸ªæ–¹æ³• å…¥å‚æ˜¯æ—¶é—´å’Œé¢œè‰² æ˜¯ä¸æ˜¯æ›´ç®€æ´ï¼Œæ–¹æ³•åµŒå¥—ç®—è€¦åˆå—","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1604394568,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":222494,"ip_address":""},"score":320542,"extra":""}]},{"author":{"id":1382913,"avatar":"https://static001.geekbang.org/account/avatar/00/15/1a/01/938ab37d.jpg","nickname":"å¯’å¤œ","note":"","ucode":"45771EAA805409","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":242263,"discussion_content":"document.getElementById(&#34;traffic-light&#34;)æœ€å¥½ç¼“å­˜ä¸€ä¸‹","likes_number":7,"is_delete":false,"is_hidden":false,"ctime":1587473107,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":2328769,"avatar":"","nickname":"Geek_2b435a","note":"","ucode":"70A1A0D25EF386","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":327239,"discussion_content":"é¸¡è›‹é‡ŒæŒ‘éª¨å¤´çš„è¯ç”±äºsetTimeoutä¼šè¢«åŠ å…¥åˆ°çš„é˜Ÿåˆ—æœ«å°¾ï¼Œå®é™…ä¸Šè¿è¡Œä¼šè¶…è¿‡3ç§’ã€2ç§’ã€1ç§’","likes_number":5,"is_delete":false,"is_hidden":false,"ctime":1605772679,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1383510,"avatar":"https://static001.geekbang.org/account/avatar/00/15/1c/56/b7329e72.jpg","nickname":"è‰èˆŸ","note":"","ucode":"41FE0F9AAA9285","race_medal":0,"user_type":1,"is_pvip":true},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":544495,"discussion_content":"ä¸ºä»€ä¹ˆè¦åŠ wile(true) {...} ?","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1641540749,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":1,"child_discussions":[{"author":{"id":1374066,"avatar":"https://static001.geekbang.org/account/avatar/00/14/f7/72/2d35f80c.jpg","nickname":"xing.org1^","note":"","ucode":"C68AEA172B1623","race_medal":1,"user_type":1,"is_pvip":false},"reply_author":{"id":1383510,"avatar":"https://static001.geekbang.org/account/avatar/00/15/1c/56/b7329e72.jpg","nickname":"è‰èˆŸ","note":"","ucode":"41FE0F9AAA9285","race_medal":0,"user_type":1,"is_pvip":true},"discussion":{"id":584233,"discussion_content":"åƒå¤§è¡—ä¸Šçš„ğŸš¥ ä¸€ç›´å˜æ¢é¢œè‰²æ°¸ä¸åœæ¯ğŸ™ˆ","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1660701582,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":544495,"ip_address":"åŒ—äº¬"},"score":584233,"extra":""}]},{"author":{"id":1802517,"avatar":"","nickname":"Geek_f1e564","note":"","ucode":"ABFE6F4FF647E8","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":376087,"discussion_content":"è¿˜å°è£…èµ·æ¥äº†ï¼Œå¥½æ£’","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1621952987,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1946181,"avatar":"https://static001.geekbang.org/account/avatar/00/1d/b2/45/b49a92f5.jpg","nickname":"åè„‘å‹º","note":"","ucode":"50704EC5545C4C","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":232338,"discussion_content":"const trafficLight = document.querySelector(&#39;.traffic-lights&#39;)\n\nstart()\n\nasync function start(params) {\n  while (true) {\n    await generateLight(trafficLight, &#39;green&#39;, 3000)\n    await generateLight(trafficLight, &#39;yellow&#39;, 1000)\n    await generateLight(trafficLight, &#39;red&#39;, 2000)\n  }\n}\n\nfunction generateLight(el, color, duration) {\n  return new Promise(resolve => {\n    el.style.backgroundColor = color\n    setTimeout(resolve, duration)\n  })\n}\n","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1586866845,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1453214,"avatar":"https://static001.geekbang.org/account/avatar/00/16/2c/9e/7e57f97c.jpg","nickname":"è‰¯çºµ","note":"","ucode":"234B6F9190A0AD","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":148064,"discussion_content":"while(true){...}è¿˜æ˜¯å­¦å•ç‰‡æœºçš„æ—¶å€™æ‰æ•¢ç”¨çš„ä¸œè¥¿å‘¢ï¼Œä¸çŸ¥é“ä¼šåœ¨jsä¸­å¯¼è‡´ä»€ä¹ˆé—®é¢˜","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1579688369,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":1,"child_discussions":[{"author":{"id":1042089,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/e6/a9/b459efb7.jpg","nickname":"å¦‚æ•…","note":"","ucode":"F6895792309942","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":1453214,"avatar":"https://static001.geekbang.org/account/avatar/00/16/2c/9e/7e57f97c.jpg","nickname":"è‰¯çºµ","note":"","ucode":"234B6F9190A0AD","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":311129,"discussion_content":"å› ä¸ºå•ç‰‡æœºå°±æ˜¯éœ€è¦ä¸æ–­å¾ªç¯è¿è¡Œå•Š è¿™é‡Œå¦‚æœä¹Ÿéœ€è¦ä¸æ–­å¾ªç¯è¿è¡Œ ä¹Ÿæ²¡å•¥é—®é¢˜å§","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1602232100,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":148064,"ip_address":""},"score":311129,"extra":""}]}]},{"had_liked":false,"id":72072,"user_name":"whatever","can_delete":false,"product_type":"c1","uid":1388132,"ip_address":"","ucode":"7CF85666425B65","user_header":"https://static001.geekbang.org/account/avatar/00/15/2e/64/10182523.jpg","comment_is_top":false,"comment_ctime":1551513582,"is_pvip":false,"discussion_count":11,"race_medal":0,"score":"791825496046","product_id":100023201,"comment_content":"https:&#47;&#47;jakearchibald.com&#47;2015&#47;tasks-microtasks-queues-and-schedules&#47;<br>ä¸ºäº†æ›´æ·±å…¥çš„ç†è§£å®ä»»åŠ¡å’Œå¾®ä»»åŠ¡ï¼Œè¯»äº†è¿™ç¯‡ã€‚æ„Ÿè§‰æ–‡ä¸­è¯´çš„å¾®ä»»åŠ¡æ€»æ˜¯å…ˆäºå®ä»»åŠ¡ä¼šè®©äººäº§ç”Ÿè¯¯è§£ï¼Œæ›´å‡†ç¡®çš„è¯´æ³•åº”è¯¥æ˜¯å¾®ä»»åŠ¡æ€»ä¼šåœ¨ä¸‹ä¸€ä¸ªå®ä»»åŠ¡ä¹‹å‰æ‰§è¡Œï¼Œåœ¨æœ¬èº«æ‰€å±çš„å®ä»»åŠ¡ç»“æŸåç«‹å³æ‰§è¡Œã€‚","like_count":185,"discussions":[{"author":{"id":1996106,"avatar":"","nickname":"Geek_1e6198","note":"","ucode":"785EBE404903DD","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":268622,"discussion_content":"æ‰§è¡Œä¸»çº¿ç¨‹å®ä»»åŠ¡-->æ‰§è¡Œæ‰€æœ‰çš„å¾®ä»»åŠ¡,ç›´åˆ°æ¸…ç©ºå¾®ä»»åŠ¡çš„é˜Ÿåˆ—-->æ‰§è¡Œä¸€ä¸ªå®ä»»åŠ¡--->æ‰§è¡Œå¾®ä»»åŠ¡(å› ä¸ºè¿™æ—¶å€™å¯èƒ½åˆäº§ç”Ÿäº†æ–°çš„å¾®ä»»åŠ¡)--ä¸€ä¸ªå®-->æ‰€æœ‰å¾®  ç„¶åä¸€ç›´å¾ªç¯å¾€å¤ç›´åˆ°ç»“æŸ","likes_number":13,"is_delete":false,"is_hidden":false,"ctime":1589808955,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1330852,"avatar":"https://static001.geekbang.org/account/avatar/00/14/4e/a4/433305bb.jpg","nickname":"å¡æ´›æ–¯(à¹‘Åà¯°Åà¹‘)","note":"","ucode":"6F311BF03B76FD","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":6160,"discussion_content":"æ©ï¼Œç¡®å®ä¼šæœ‰æ­§ä¹‰ï¼Œäº‹ä»¶å¾ªç¯çš„æ˜¯å®è§‚ä»»åŠ¡ï¼Œå¾®ä»»åŠ¡æ˜¯åœ¨å®è§‚ä»»åŠ¡é‡Œï¼Œæ‰€ä»¥è¯´å¾®è§‚ä»»åŠ¡å§‹ç»ˆåœ¨å®è§‚ä»»åŠ¡ä¹‹å‰æ‰§è¡Œï¼Œæ˜¯æœ‰æ­§ä¹‰çš„ï¼Œåº”è¯¥æ˜¯æ¯æ‰§è¡Œå®Œä¸€ä¸ªå®è§‚ä»»åŠ¡ï¼ˆåŒ…æ‹¬å¾®è§‚ä»»åŠ¡ï¼‰ï¼Œæ‰ä¼šæ‰§è¡Œä¸‹ä¸ªå®è§‚ä»»åŠ¡ï¼Œæ‰€ä»¥ä¸Šé¢çš„ä¾‹å­æ˜¯æŠŠå¾®è§‚ä»»åŠ¡åŠ å…¥åˆ°äº†å½“å‰å®è§‚ä»»åŠ¡é‡Œäº†ï¼Œå¿…é¡»ç­‰å½“å‰å®è§‚ä»»åŠ¡ï¼ˆåŒ…æ‹¬æ‰€æœ‰å¾®è§‚ä»»åŠ¡ï¼‰æ‰§è¡Œå®Œï¼Œæ‰ä¼šæ‰§è¡Œ setTimeout é‡Œçš„ä¸‹ä¸€ä¸ªå®è§‚ä»»åŠ¡ã€‚","likes_number":11,"is_delete":false,"is_hidden":false,"ctime":1566734234,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1375156,"avatar":"https://static001.geekbang.org/account/avatar/00/14/fb/b4/afbaab2f.jpg","nickname":"å¾ä¸‰å“","note":"","ucode":"6B30D451EBD60D","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":79145,"discussion_content":"ä¹Ÿä¸æ˜¯å®ä»»åŠ¡ç»“æŸåæ‰§è¡Œï¼Œè€Œæ˜¯å®ä»»åŠ¡é‡Œçš„åŒæ­¥ä»£ç æ‰§è¡Œå®Œåç«‹å³éå†æ‰§è¡Œå½“å‰å¾®ä»»åŠ¡åˆ—è¡¨ã€‚","likes_number":8,"is_delete":false,"is_hidden":false,"ctime":1576062038,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":1,"child_discussions":[{"author":{"id":1376337,"avatar":"https://static001.geekbang.org/account/avatar/00/15/00/51/f5bffcde.jpg","nickname":"qyy","note":"","ucode":"1C402850653320","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":1375156,"avatar":"https://static001.geekbang.org/account/avatar/00/14/fb/b4/afbaab2f.jpg","nickname":"å¾ä¸‰å“","note":"","ucode":"6B30D451EBD60D","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":305669,"discussion_content":"å¯¹çš„","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1600052147,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":79145,"ip_address":""},"score":305669,"extra":""}]},{"author":{"id":1905171,"avatar":"https://static001.geekbang.org/account/avatar/00/1d/12/13/e103a6e3.jpg","nickname":"æ‰©æ•£æ€§ç™¾ä¸‡å’¸é¢åŒ…","note":"","ucode":"6D703D51553B42","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":240479,"discussion_content":"æˆ‘ä¹Ÿè§‰å¾—ä½ æ˜¯å¯¹çš„ã€‚\n\n    function sleep(duration) {\n        return new Promise(function(resolve, reject) {\n            console.log(&#34;b&#34;);\n            setTimeout(resolve,duration);\n        })\n    }\n    console.log(&#34;a&#34;);\n    sleep(5000).then(()=>console.log(&#34;c&#34;));\nåº”è¯¥è¯´æ¯ä¸€è½®å®ä»»åŠ¡æ‰§è¡Œå®Œäº†åéƒ½ä¼šå»æ‰§è¡Œä¸€éå¾®ä»»åŠ¡ã€‚\nç»“åˆçœ‹äº†å…¶ä»–å¸–å­åï¼Œæˆ‘å¯¹äºè¿™æ®µä»£ç çš„çœŸæ­£è§£é‡Šæ˜¯ï¼šé¦–å…ˆæ‰“å°a, bæ²¡æœ‰é—®é¢˜ï¼Œå…¶æ¬¡setTimeoutæŠŠä¸€ä¸ªä»»åŠ¡æ·»åŠ åˆ°å®ä»»åŠ¡é˜Ÿåˆ—ï¼Œç»§ç»­æ‰§è¡Œ.thenï¼ŒæŠŠå›è°ƒæ·»åŠ åˆ°å¾®ä»»åŠ¡é˜Ÿåˆ—ã€‚scriptå®ä»»åŠ¡ç°åœ¨æ‰§è¡Œå®Œæ¯•ï¼Œè¦å»æ£€æŸ¥å¾®ä»»åŠ¡é˜Ÿåˆ—ï¼Œä½†æ˜¯å‘ç°è¿˜æ²¡æœ‰resolveï¼Œä¸åº”è¯¥æ‰§è¡Œæ‰“å°cï¼Œäºæ˜¯å†è·³å›å®ä»»åŠ¡é˜Ÿåˆ—ã€‚å®ä»»åŠ¡å’Œå¾®ä»»åŠ¡éƒ½æ²¡åŠæ³•æ‰§è¡Œï¼Œæ‰€ä»¥æˆ‘ä¼°è®¡JSä¼šåœ¨å®é˜Ÿåˆ—å’Œå¾®é˜Ÿåˆ—åå¤æ¨ªè·³ï¼ˆEvent Loopï¼‰ã€‚ç­‰åˆ°setTimeoutæ‰§è¡Œå®Œåï¼Œå»æ‰§è¡Œå¾®ä»»åŠ¡log cæ‰æˆåŠŸã€‚","likes_number":7,"is_delete":false,"is_hidden":false,"ctime":1587368214,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":2,"child_discussions":[{"author":{"id":1011450,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/6e/fa/e217af92.jpg","nickname":"mgcnrx11","note":"","ucode":"C4EAA3DA82424B","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":1905171,"avatar":"https://static001.geekbang.org/account/avatar/00/1d/12/13/e103a6e3.jpg","nickname":"æ‰©æ•£æ€§ç™¾ä¸‡å’¸é¢åŒ…","note":"","ucode":"6D703D51553B42","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":351537,"discussion_content":"é¦–å…ˆæ‰“å°aï¼Œbæ²¡æœ‰é—®é¢˜ï¼Œä½†åç»­ç»§ç»­æ‰§è¡Œçš„thenï¼Œæˆ‘è§‰å¾—thenè¿™é‡Œçš„ä½œç”¨åªæ˜¯æ³¨å†Œä¸€ä¸ªå‡½æ•°ç»™resolveçš„æ—¶å€™å»ä½¿ç”¨ï¼Œè¿™é‡Œå¹¶æ²¡æœ‰â€œæŠŠå›è°ƒæ·»åŠ åˆ°å¾®ä»»åŠ¡é˜Ÿåˆ—â€ï¼Œå› æ­¤ä¹Ÿä¸åº”è¯¥æ˜¯â€œæ£€æŸ¥å¾®ä»»åŠ¡é˜Ÿåˆ—ï¼Œä½†æ˜¯å‘ç°è¿˜æ²¡æœ‰resolveï¼Œä¸åº”è¯¥æ‰§è¡Œæ‰“å°cï¼Œäºæ˜¯å†è·³å›å®ä»»åŠ¡é˜Ÿåˆ—â€ã€‚åœ¨ç­‰åˆ°setTimeoutçš„ç¬¬äºŒä¸ªå®ä»»åŠ¡æ‰§è¡Œresolveåï¼Œè¿™ä¸ªå›è°ƒå‡½æ•°ä¼šè¢«åŠ å…¥å¾®ä»»åŠ¡é˜Ÿåˆ—ï¼Œåç»­æ‰ä¼šæ‰“å°cã€‚","likes_number":1,"is_delete":false,"is_hidden":false,"ctime":1614320494,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":240479,"ip_address":""},"score":351537,"extra":""},{"author":{"id":2063532,"avatar":"https://static001.geekbang.org/account/avatar/00/1f/7c/ac/482c6eb4.jpg","nickname":"è€å¾","note":"","ucode":"34566E3D28620C","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":1011450,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/6e/fa/e217af92.jpg","nickname":"mgcnrx11","note":"","ucode":"C4EAA3DA82424B","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":399551,"discussion_content":"æ„Ÿè§‰ä½ æ˜¯å¯¹çš„, ä¾ç¨€è®°å¾—thenåªæ˜¯ç»™resolveæ³¨å†Œä¸€ä¸ªå‡½æ•°. æ‰€ä»¥å®é™…ä¸Šå›è°ƒå‡½æ•°æ˜¯åœ¨çœŸæ­£resolveä¹‹åå†åŠ å…¥åˆ°å¾®ä»»åŠ¡é˜Ÿåˆ—","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1632990192,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":351537,"ip_address":""},"score":399551,"extra":""}]},{"author":{"id":1592279,"avatar":"https://static001.geekbang.org/account/avatar/00/18/4b/d7/f46c6dfd.jpg","nickname":"William Ning","note":"","ucode":"4DB8D05E69E5F3","race_medal":0,"user_type":1,"is_pvip":true},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":364745,"discussion_content":"å¯ä»¥å‚è€ƒéš”å£ä¸“æ æå…µè€å¸ˆçš„ã€Šæµè§ˆå™¨åŸç†ä¸å®è·µã€‹äº‹ä»¶å¾ªç¯å®è§‚å¾®è§‚ä»»åŠ¡è®²çš„å¾ˆè¯¦ç»†ï½","likes_number":1,"is_delete":false,"is_hidden":false,"ctime":1617591368,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1120997,"avatar":"https://static001.geekbang.org/account/avatar/00/11/1a/e5/6899701e.jpg","nickname":"favorlm","note":"","ucode":"CFD52127AA6E1D","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":4534,"discussion_content":"ä½ è¯´çš„æœ‰é“ç†","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1565525159,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":2,"child_discussions":[{"author":{"id":1057245,"avatar":"https://static001.geekbang.org/account/avatar/00/10/21/dd/f0a0f17b.jpg","nickname":"é˜³æ˜","note":"","ucode":"BB2498A0EF75A6","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":1120997,"avatar":"https://static001.geekbang.org/account/avatar/00/11/1a/e5/6899701e.jpg","nickname":"favorlm","note":"","ucode":"CFD52127AA6E1D","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":5874,"discussion_content":"å…¶å®æ²¡æœ‰å®ä»»åŠ¡çš„è¯´æ³•éƒ½æ˜¯ç¿»è¯‘æ•´å‡ºæ¥çš„ï¼Œéƒ½æ˜¯ç›´æ¥å«çš„taskå’ŒmicroTaskï¼Œæˆ‘å¾ˆå°‘çœ‹åˆ°æœ‰macroTaskçš„è¯´æ³•ã€‚ã€‚ã€‚","likes_number":2,"is_delete":false,"is_hidden":false,"ctime":1566522114,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":4534,"ip_address":""},"score":5874,"extra":""},{"author":{"id":1013281,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/76/21/abb7bfe3.jpg","nickname":"Damon","note":"","ucode":"E07522227DE1E4","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":1057245,"avatar":"https://static001.geekbang.org/account/avatar/00/10/21/dd/f0a0f17b.jpg","nickname":"é˜³æ˜","note":"","ucode":"BB2498A0EF75A6","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":309599,"discussion_content":"ç¡®å®æ˜¯","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1601364190,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":5874,"ip_address":""},"score":309599,"extra":""}]}]},{"had_liked":false,"id":227181,"user_name":"é©¬å…‹è±š","can_delete":false,"product_type":"c1","uid":1999043,"ip_address":"","ucode":"2DE14669743258","user_header":"https://static001.geekbang.org/account/avatar/00/1e/80/c3/82923c17.jpg","comment_is_top":false,"comment_ctime":1592307222,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"233520541206","product_id":100023201,"comment_content":"å®ä»»åŠ¡å’Œå¾®ä»»åŠ¡çš„æ‰§è¡Œé¡ºåºå…¶å®å¾ˆå¥½ç†è§£ã€‚é¦–å…ˆä¸€ä¸ªjsè„šæœ¬æœ¬èº«å¯¹äºæµè§ˆå™¨è€Œè¨€å°±æ˜¯ä¸€ä¸ªå®ä»»åŠ¡ï¼Œä¹Ÿæ˜¯ç¬¬ä¸€ä¸ªå®ä»»åŠ¡ï¼Œè€Œå¤„äºå…¶ä¸­çš„ä»£ç å¯èƒ½æœ‰3ç§ï¼šéå¼‚æ­¥ä»£ç ã€äº§ç”Ÿå¾®ä»»åŠ¡çš„å¼‚æ­¥ä»£ç ï¼ˆpromiseç­‰ï¼‰ã€äº§ç”Ÿå®ä»»åŠ¡çš„å¼‚æ­¥ä»£ç (settimeoutã€setintervalç­‰)ã€‚<br>æˆ‘ä»¬çŸ¥é“å®ä»»åŠ¡å¤„äºä¸€ä¸ªé˜Ÿåˆ—ä¸­ï¼Œåº”å½“å…ˆæ‰§è¡Œå®Œä¸€ä¸ªå®ä»»åŠ¡æ‰ä¼šæ‰§è¡Œä¸‹ä¸€ä¸ªå®ä»»åŠ¡ï¼Œæ‰€ä»¥åœ¨jsè„šæœ¬ä¸­ï¼Œä¼šå…ˆæ‰§è¡Œéå¼‚æ­¥ä»£ç ï¼Œå†æ‰§è¡Œå¾®ä»»åŠ¡ä»£ç ï¼Œæœ€åæ‰§è¡Œå®ä»»åŠ¡ä»£ç ã€‚è¿™æ—¶å€™æˆ‘ä»¬è¿›è¡Œåˆ°äº†ä¸‹ä¸€ä¸ªå®ä»»åŠ¡ä¸­ï¼ŒåˆæŒ‰ç…§è¿™ä¸ªé¡ºåºæ‰§è¡Œã€‚<br>å¾®ä»»åŠ¡æ€»æ˜¯å…ˆäºå®ä»»åŠ¡è¿™ä¸ªè¯´æ³•ä¸å‡†ç¡®ï¼Œåº”è¯¥æ˜¯å¤„äºåŒä¸€çº§çš„æƒ…å†µä¸‹æ‰èƒ½è¿™ä¹ˆè¯´ã€‚å®é™…ä¸Šå¾®ä»»åŠ¡æ°¸è¿œæ˜¯å®ä»»åŠ¡çš„ä¸€éƒ¨åˆ†ï¼Œå®ƒå¤„äºä¸€ä¸ªå¤§çš„å®ä»»åŠ¡å†…ã€‚<br><br><br>","like_count":55},{"had_liked":false,"id":69847,"user_name":"è´¹é©¬","can_delete":false,"product_type":"c1","uid":1190201,"ip_address":"","ucode":"BCAAF9C16F0CC5","user_header":"https://static001.geekbang.org/account/avatar/00/12/29/39/0aec7827.jpg","comment_is_top":false,"comment_ctime":1550885161,"is_pvip":false,"replies":[{"id":"25834","content":"è¿™ä¸ªå†™çš„ä¸é”™ï¼Œä¸è¿‡ï¼Œæ—¢ç„¶éƒ½ç”¨åˆ°äº†awaitï¼Œæ˜¯ä¸æ˜¯å¯ä»¥ä¸ç”¨é€’å½’å‘¢ï¼Ÿ","user_name":"ä½œè€…å›å¤","user_name_real":"winter","uid":"1268524","ctime":1551425027,"ip_address":"","comment_id":69847,"utype":1}],"discussion_count":5,"race_medal":0,"score":"151874740521","product_id":100023201,"comment_content":"const lightEle = document.getElementById(&#39;traffic-light&#39;);<br>function changeTrafficLight(color, duration) {<br>  return new Promise(function(resolve, reject) {<br>    lightEle.style.background = color;<br>    setTimeout(resolve, duration);<br>  })<br>}<br><br>async function trafficScheduler() {<br>  await changeTrafficLight(&#39;green&#39;, 3000);<br>  await changeTrafficLight(&#39;yellow&#39;, 1000);<br>  await changeTrafficLight(&#39;red&#39;, 2000);<br>  trafficScheduler();<br>}<br><br>trafficScheduler();","like_count":35,"discussions":[{"author":{"id":1268524,"avatar":"https://static001.geekbang.org/account/avatar/00/13/5b/2c/12bfd3cd.jpg","nickname":"winter","note":"","ucode":"2B068EDEAFEB56","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":440314,"discussion_content":"è¿™ä¸ªå†™çš„ä¸é”™ï¼Œä¸è¿‡ï¼Œæ—¢ç„¶éƒ½ç”¨åˆ°äº†awaitï¼Œæ˜¯ä¸æ˜¯å¯ä»¥ä¸ç”¨é€’å½’å‘¢ï¼Ÿ","likes_number":1,"is_delete":false,"is_hidden":false,"ctime":1551425027,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1953884,"avatar":"http://thirdwx.qlogo.cn/mmopen/vi_32/ukjhibz6ORn08JzfiaeicejOZHeoSRgo6r0acKMMjFOMibu0ic67dgCL3ia8Eic5PicD2rLtgMKG28Zr9ErGGlWPjr48WQ/132","nickname":"é²é»æ˜","note":"","ucode":"2A5CBCAD144187","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":227436,"discussion_content":"while(1)","likes_number":1,"is_delete":false,"is_hidden":false,"ctime":1586492600,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1515764,"avatar":"https://static001.geekbang.org/account/avatar/00/17/20/f4/eeb0ae3d.jpg","nickname":"ç´«deé£’æ®‡","note":"","ucode":"94064BBDF1F60E","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":102446,"discussion_content":"é‚£ä¹ˆé¡ºåŠ¿é—®ä¸ªé—®é¢˜ï¼Œé€’å½’å’Œå¾ªç¯å“ªä¸ªæ•ˆç‡æ›´é«˜å‘¢ï¼Ÿ","likes_number":1,"is_delete":false,"is_hidden":false,"ctime":1577346669,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":1,"child_discussions":[{"author":{"id":1201350,"avatar":"https://static001.geekbang.org/account/avatar/00/12/54/c6/c2481790.jpg","nickname":"lisiur","note":"","ucode":"CEB2DBCE29CAA7","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":1515764,"avatar":"https://static001.geekbang.org/account/avatar/00/17/20/f4/eeb0ae3d.jpg","nickname":"ç´«deé£’æ®‡","note":"","ucode":"94064BBDF1F60E","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":171870,"discussion_content":"ä¸€èˆ¬æƒ…å†µä¸‹å¾ªç¯æ•ˆç‡é«˜å§ï¼Œé€’å½’ä¼šäº§ç”Ÿå‡½æ•°è°ƒç”¨ï¼Œè¿‡å¤šçš„å‡½æ•°è°ƒç”¨è¿˜ä¼šé€ æˆæ ˆæº¢å‡ºï¼Œso...","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1581754535,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":102446,"ip_address":""},"score":171870,"extra":""}]},{"author":{"id":1376538,"avatar":"http://thirdwx.qlogo.cn/mmopen/vi_32/DYAIOgq83epoDIyoOY3Iv5mxKtAQ0QwhMoiakFU3NyLRQoj89VibqibosfatYBaUemmUQ8FnBVbGibJAnhRibXJ4FiaQ/132","nickname":"è¶…è¶…","note":"","ucode":"19DE2A60A574AB","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":27618,"discussion_content":"...","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1570671767,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":70821,"user_name":"deiphi","can_delete":false,"product_type":"c1","uid":1231746,"ip_address":"","ucode":"33B02A42BC9699","user_header":"https://static001.geekbang.org/account/avatar/00/12/cb/82/d01f40b4.jpg","comment_is_top":false,"comment_ctime":1551189957,"is_pvip":false,"replies":[{"id":"25923","content":"å“ˆå“ˆå“ˆ è¿™ä¸ªç¡¬æ ¸äº†å•Šâ€¦â€¦  ç»“æœå€’æ˜¯å¯¹çš„<br><br>ä¸è¯•è¯•Promiseå—ï¼Ÿ æˆ‘è®²äº†è¿™ä¹ˆå¤šå‘¢â€¦â€¦","user_name":"ä½œè€…å›å¤","user_name_real":"winter","uid":"1268524","ctime":1551432423,"ip_address":"","comment_id":70821,"utype":1}],"discussion_count":8,"race_medal":0,"score":"143285110725","product_id":100023201,"comment_content":"&#47;&#47; æ¯”è¾ƒåŸå§‹çš„å†™æ³•<br>function color () { <br>\tconsole.log(&#39;green&#39;);<br>\t<br>\tsetTimeout(() =&gt; {<br>\t\t\tconsole.log(&#39;yellow&#39;);<br>\t\t\t<br>\t\t\tsetTimeout(() =&gt; {<br>\t\t\t\tconsole.log(&#39;red&#39;);<br>\t\t\t\t<br>\t\t\t\tsetTimeout(color, 2000);<br>\t\t\t}, 1000)<br>\t}, 3000);<br>}<br>color();","like_count":33,"discussions":[{"author":{"id":1268524,"avatar":"https://static001.geekbang.org/account/avatar/00/13/5b/2c/12bfd3cd.jpg","nickname":"winter","note":"","ucode":"2B068EDEAFEB56","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":440846,"discussion_content":"å“ˆå“ˆå“ˆ è¿™ä¸ªç¡¬æ ¸äº†å•Šâ€¦â€¦  ç»“æœå€’æ˜¯å¯¹çš„\n\nä¸è¯•è¯•Promiseå—ï¼Ÿ æˆ‘è®²äº†è¿™ä¹ˆå¤šå‘¢â€¦â€¦","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1551432423,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1388875,"avatar":"https://static001.geekbang.org/account/avatar/00/15/31/4b/0f5b3a0a.jpg","nickname":"Glee","note":"","ucode":"AA0D428E34D29E","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":32458,"discussion_content":"åŸè°…æˆ‘ç¬‘å‡ºäº†çŒªå«å£°ï¼Œå¤ªç¡¬æ ¸äº†ï¼Œå¥½å¯çˆ±~å“ˆå“ˆå“ˆ","likes_number":5,"is_delete":false,"is_hidden":false,"ctime":1571039106,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":1,"child_discussions":[{"author":{"id":1081340,"avatar":"http://thirdqq.qlogo.cn/qqapp/101418266/26D1B956D260F4480FA4FF037DE840B9/100","nickname":"ã€€ã€€ã€€","note":"","ucode":"E1D783DC763052","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":1388875,"avatar":"https://static001.geekbang.org/account/avatar/00/15/31/4b/0f5b3a0a.jpg","nickname":"Glee","note":"","ucode":"AA0D428E34D29E","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":41556,"discussion_content":"åŸè°…æˆ‘ä¹Ÿæƒ³åˆ°çš„æ˜¯è¿™ç§æ–¹å¼_(:Ğ·ã€âˆ )_","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1572450164,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":32458,"ip_address":""},"score":41556,"extra":""}]},{"author":{"id":1382731,"avatar":"https://static001.geekbang.org/account/avatar/00/15/19/4b/c30b6362.jpg","nickname":"å‘¨ä¼Ÿ","note":"","ucode":"BE5DA105390106","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":392602,"discussion_content":"ç¬¬ä¸€ä¸ªæ€è·¯å°±æ˜¯è¿™ä¸ªï¼Œå“ˆå“ˆ","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1631068284,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":2113186,"avatar":"https://static001.geekbang.org/account/avatar/00/20/3e/a2/67c01ee5.jpg","nickname":"Moxy","note":"","ucode":"33C14F3D510320","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":368100,"discussion_content":"hhhhh å¥½ä¸€ä¸ª Callback Hell ....","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1618566509,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1765033,"avatar":"https://static001.geekbang.org/account/avatar/00/1a/ee/a9/ccd0bd02.jpg","nickname":"è¿½é£å°‘å¹´","note":"","ucode":"2EC84A63290E82","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":308941,"discussion_content":"666","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1601127836,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1177430,"avatar":"https://static001.geekbang.org/account/avatar/00/11/f7/56/b82eeac7.jpg","nickname":"champå¯å£å¯ä¹äº†","note":"","ucode":"EA75C67E9124C7","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":259975,"discussion_content":"å¾ªç¯å‘¢","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1588834363,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":1,"child_discussions":[{"author":{"id":1998206,"avatar":"","nickname":"æ‹¾æ¢¦è€…","note":"","ucode":"3A0F800005A1D4","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":1177430,"avatar":"https://static001.geekbang.org/account/avatar/00/11/f7/56/b82eeac7.jpg","nickname":"champå¯å£å¯ä¹äº†","note":"","ucode":"EA75C67E9124C7","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":264214,"discussion_content":"æ˜¯å¾ªç¯ ä»–é€’å½’äº†ç›¸å½“äº","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1589294536,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":259975,"ip_address":""},"score":264214,"extra":""}]}]},{"had_liked":false,"id":71268,"user_name":"å¥‡å¥‡","can_delete":false,"product_type":"c1","uid":1031906,"ip_address":"","ucode":"1AED63F069C040","user_header":"https://static001.geekbang.org/account/avatar/00/0f/be/e2/57d62270.jpg","comment_is_top":false,"comment_ctime":1551315100,"is_pvip":false,"discussion_count":2,"race_medal":0,"score":"113220464796","product_id":100023201,"comment_content":"æ€ä¹ˆåŒºåˆ†æ˜¯å®¿ä¸»ç¯å¢ƒè¿˜æ˜¯jså¼•æ“å‘èµ·çš„ä»»åŠ¡å‘¢","like_count":26,"discussions":[{"author":{"id":1484978,"avatar":"https://static001.geekbang.org/account/avatar/00/16/a8/b2/10ca1126.jpg","nickname":"å°˜åŸƒğŸˆ","note":"","ucode":"7DFA126EB1FCF9","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":345152,"discussion_content":"å¯ä¸å¯ä»¥è¿™æ ·ç†è§£ï¼šä»»åŠ¡çš„äº§ç”Ÿæ˜¯å› ä¸ºéœ€è¦å®¿ä¸»éœ€è¦åœ¨ç‰¹å®šæ—¶æœºå»ä¼ é€’ç»™jså¼•æ“å»æ‰§è¡Œï¼Œæ¯”å¦‚ setTimeout   setInterval è¿™æ ·çš„api ç§°ä¸ºå®¿ä¸»ä»»åŠ¡ï¼Œè¿™æ ·çš„ä»»åŠ¡å¯èƒ½æœ‰ Promiseè¿™æ · çš„å¼‚æ­¥ä»£ç ï¼Œæ‰€ä»¥ å¾®ä»»åŠ¡å¿…é¡»ä¿è¯åœ¨åŒä¸€ä¸ªå®ä»»åŠ¡ä¸­æ‰§è¡Œ","likes_number":1,"is_delete":false,"is_hidden":false,"ctime":1611671240,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1698735,"avatar":"https://static001.geekbang.org/account/avatar/00/19/eb/af/e49af9a8.jpg","nickname":"JC.å½¦","note":"","ucode":"E87C1420B140F4","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":259407,"discussion_content":"å¦‚äº‹ä»¶å°±æ˜¯å¯„ä¸»ç¯å¢ƒå‘èµ·çš„ï¼ŒPromise,awaitå°±æ˜¯jså¼•æ“å‘èµ·çš„ã€‚","likes_number":1,"is_delete":false,"is_hidden":false,"ctime":1588776712,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":203202,"user_name":"wingsico","can_delete":false,"product_type":"c1","uid":1126631,"ip_address":"","ucode":"A91CB7B0497708","user_header":"http://thirdwx.qlogo.cn/mmopen/vi_32/s0bx4WXQNkAJ3c3map0g6dlt3sKDgTtN7Ria96YoufjQcVVI8Shv5CN1jnK1ZTImNnlPcibRqvyiaUuhpIvV1TpnQ/132","comment_is_top":false,"comment_ctime":1586155211,"is_pvip":true,"discussion_count":3,"race_medal":0,"score":"70305631947","product_id":100023201,"comment_content":"è¿™ä¸€èŠ‚ä¸»è¦è®²äº†ä¸€ä¸‹JSçš„æ‰§è¡Œæ ˆï¼Œä»å®¿ä¸»ç¯å¢ƒåˆ°JSå¼•æ“ï¼Œåˆ†ä¸ºå®ä»»åŠ¡å’Œå¾®ä»»åŠ¡ã€‚ä½†å®é™…ä¸Šå¹¶æ²¡æœ‰é˜è¿°çš„ååˆ†æ¸…æ¥šï¼Œåªæ˜¯æ ¹æ®ä¸€äº›æ¯”è¾ƒæµ…æ˜¾çš„ç°è±¡æ¥è¯´æ˜äº†ä¸€ä¸‹è¿™äº›ä»»åŠ¡çš„æ‰§è¡Œæœºåˆ¶ã€‚<br><br>å¯¹äºä¸ºä»€ä¹ˆé‡‡ç”¨äº‹ä»¶å¾ªç¯ï¼Œä»¥åŠå¤šç§å®ä»»åŠ¡é˜Ÿåˆ—ä»¥åŠæµè§ˆå™¨æ¸²æŸ“ï¼ŒIOï¼Œç½‘ç»œè¯·æ±‚ç­‰å‡æ— æ¶‰åŠã€‚<br><br>å®é™…ä¸Šäº‹ä»¶å¾ªç¯ä¾èµ–äºå®¿ä¸»ï¼Œæ˜¯å®¿ä¸»éœ€è¦äº‹ä»¶å¾ªç¯æ¥åè°ƒjsä¸­å¤šç§äº‹ä»¶æºè¿›è¡Œäº¤äº’ã€‚è€Œäº‹ä»¶å¾ªç¯å¹¶ä¸æ˜¯jsæœ¬èº«å…·æœ‰çš„èƒ½åŠ›ã€‚<br><br>å¯¹äºæµè§ˆå™¨ä¸­çš„å¤šç§çš„å®ä»»åŠ¡é˜Ÿåˆ—ï¼Œå¯åˆ†ä¸ºé¡µé¢æ¸²æŸ“ã€ç”¨æˆ·äº¤äº’ã€ç½‘ç»œè¯·æ±‚ã€History APIä»¥åŠè®¡æ—¶å™¨ç­‰ï¼Œä¸åŒç§ç±»çš„å®ä»»åŠ¡é˜Ÿåˆ—ä¹‹é—´çš„ä¼˜å…ˆçº§ä¸åŒï¼Œä¹Ÿè·Ÿå®é™…æ‰§è¡Œçš„æ—¶æœºæœ‰å…³ï¼Œä¸åŒæ—¶æœºå¾—åˆ°çš„ç»“æœä¹Ÿä¼šä¸åŒã€‚<br><br>è€Œæµè§ˆå™¨ä¸­çš„äº‹ä»¶å¾ªç¯ä¸Nodeä¸­çš„äº‹ä»¶å¾ªç¯ä¹Ÿæœ‰åŒºåˆ«ï¼ˆåŸå› ä¸Šé¢è¯´äº†ï¼‰ï¼ŒNodeä¸­æ²¡æœ‰DOMï¼Œæ²¡æœ‰é¡µé¢æ¸²æŸ“ï¼Œä½†å¤šäº†æ–‡ä»¶è¯»å–ç­‰ã€‚åœ¨Node11ä¹‹å‰ï¼ŒNodeä¸­ä¸€æ¬¡äº‹ä»¶å¾ªç¯å¯ä»¥æ‰§è¡Œå®Œæ‰€æœ‰å®ä»»åŠ¡åå†è¿›å…¥ä¸‹ä¸€æ¬¡äº‹ä»¶å¾ªç¯ã€‚åœ¨Nodeä¸­ï¼Œå„ç§ä¸åŒçš„å®ä»»åŠ¡ä¹‹é—´ä¹Ÿæœ‰ä¼˜å…ˆçº§ï¼Œå¹¶ä¸”æ˜¯å›ºå®šçš„ï¼Œä½†è·Ÿæ‰§è¡Œçš„æ—¶æœºä¹Ÿæœ‰å…³ç³»ã€‚æ‰€ä»¥æˆ‘ä»¬ä¹Ÿç»å¸¸çœ‹åˆ°é‡å¤æ‰§è¡Œä¸€æ®µä»£ç ä¼šå¾—åˆ°ä¸åŒçš„ç»“æœã€‚ä½†å…·ä½“çš„ä¸€ä¸ªè¿ä½œæœºåˆ¶æˆ‘ç›®å‰ä»ç„¶æ²¡æœ‰ææ¸…æ¥šï¼Œç¿»çœ‹äº†å¾ˆå¤šèµ„æ–™ä¹Ÿæ²¡æœ‰å¯¹è¿™éƒ¨åˆ†æœ‰ç€è¯¦ç»†çš„é˜è¿°ã€‚<br><br>","like_count":17,"discussions":[{"author":{"id":2813740,"avatar":"https://static001.geekbang.org/account/avatar/00/2a/ef/2c/9f96ded7.jpg","nickname":"Ha0ran","note":"","ucode":"A36AD84DAC48B2","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":573938,"discussion_content":"å®˜ç½‘è²Œä¼¼æœ‰ä¸€ç¯‡å…³äºNodeçš„äº‹ä»¶å¾ªç¯","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1653737410,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1564786,"avatar":"https://static001.geekbang.org/account/avatar/00/17/e0/72/6e0314e7.jpg","nickname":"Ace","note":"","ucode":"C77191A6B18845","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":310024,"discussion_content":"æˆ‘ä¹Ÿè§‰å¾—æ—¶é—´å¾ªç¯æ²¡æ€ä¹ˆè®²æ¸…æ¥šã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1601561130,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1163321,"avatar":"https://static001.geekbang.org/account/avatar/00/11/c0/39/16340f72.jpg","nickname":"zlxag","note":"","ucode":"136FB0201B64A3","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":258630,"discussion_content":"å¯èƒ½æ˜¯æœ‰äº›æ¦‚å¿µä¸æ¸…æ™°","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1588695863,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":201621,"user_name":"é¡¾ç›¼ç¥é£ğŸ‘»","can_delete":false,"product_type":"c1","uid":1411966,"ip_address":"","ucode":"EB3579A3868D14","user_header":"https://static001.geekbang.org/account/avatar/00/15/8b/7e/f78e86a8.jpg","comment_is_top":false,"comment_ctime":1585813287,"is_pvip":false,"discussion_count":5,"race_medal":0,"score":"66010322727","product_id":100023201,"comment_content":"js ç‰ˆæœ¬ æœ€é«˜èµåŒå­¦å¤Ÿæ ‡å‡† æ¥ä¸ª css ç‰ˆæœ¬ å“ˆå“ˆ<br>&lt;div class=&quot;toggle-color&quot;&gt;&lt;&#47;div&gt;<br>.toggle-color {<br>\t\t\twidth: 100px;<br>\t\t\theight: 100px;<br>\t\t\tanimation: toggle_color linear 6s infinite<br>\t\t}<br><br>\t\t@keyframes toggle_color {<br><br>\t\t\t0%,<br>\t\t\t50% {<br>\t\t\t\tbackground: green<br>\t\t\t}<br><br>\t\t\t51%,<br>\t\t\t67% {<br>\t\t\t\tbackground: yellow<br>\t\t\t}<br><br>\t\t\t68%,<br>\t\t\t100% {<br>\t\t\t\tbackground: red<br>\t\t\t}<br>\t\t}","like_count":15,"discussions":[{"author":{"id":1376539,"avatar":"https://static001.geekbang.org/account/avatar/00/15/01/1b/936b51bd.jpg","nickname":"åŸ¼ç‰","note":"","ucode":"7F60115E0651C3","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":327219,"discussion_content":"ç§€å„¿","likes_number":2,"is_delete":false,"is_hidden":false,"ctime":1605770478,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1400998,"avatar":"https://static001.geekbang.org/account/avatar/00/15/60/a6/341c3e31.jpg","nickname":"ä¸å¸¦å¸ƒå…œ","note":"","ucode":"3BC07B89A3B058","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":341451,"discussion_content":"è¿‡æ¸¡æ•ˆæœèƒ½ä¼˜åŒ–å—","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1610423405,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1289909,"avatar":"https://static001.geekbang.org/account/avatar/00/13/ae/b5/75daf3a2.jpg","nickname":"éƒ­ç«‹leeà¸ˆà¸¸à¹Šà¸š","note":"","ucode":"DB13454A74D502","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":321632,"discussion_content":"çš®ï¼ŒåŒå­¦ä»¬ä¸è¦æ¨¡ä»¿, æœ‰å¾ˆå¤šç¼ºç‚¹\n","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1604613640,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1365578,"avatar":"https://static001.geekbang.org/account/avatar/00/14/d6/4a/159db001.jpg","nickname":"ã€‚ã€‚ã€‚","note":"","ucode":"7F943EEB55560C","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":311508,"discussion_content":"æˆ‘è­¦å‘Šä½ ï¼Œä½ ä¸è¦åœ¨è¿™é‡Œæ²¹ï½ï½ï½ï½å“ˆå“ˆå“ˆå“ˆå“ˆå“ˆ","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1602380626,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1910075,"avatar":"https://static001.geekbang.org/account/avatar/00/1d/25/3b/a971fc8e.jpg","nickname":"é˜¿æ„Ÿ","note":"","ucode":"7BCB7E44A832D1","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":253347,"discussion_content":"ğŸ‘ğŸ»cssç§€åŒå­¦","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1588228640,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":70072,"user_name":"è®¸å‰ä¸­","can_delete":false,"product_type":"c1","uid":1395219,"ip_address":"","ucode":"031FCB7DD2441F","user_header":"https://static001.geekbang.org/account/avatar/00/15/4a/13/42e02b09.jpg","comment_is_top":false,"comment_ctime":1550985504,"is_pvip":false,"replies":[{"id":"25846","content":"å®ƒäº§ç”ŸPromiseï¼Œå½“ç„¶æ˜¯å¾®è§‚ä»»åŠ¡äº†","user_name":"ä½œè€…å›å¤","user_name_real":"winter","uid":"1268524","ctime":1551425655,"ip_address":"","comment_id":70072,"utype":1}],"discussion_count":2,"race_medal":0,"score":"57385560352","product_id":100023201,"comment_content":"async&#47;awaitå‡½æ•°å±äºå®è§‚è¿˜æ˜¯å¾®è§‚ï¼Ÿ","like_count":13,"discussions":[{"author":{"id":1268524,"avatar":"https://static001.geekbang.org/account/avatar/00/13/5b/2c/12bfd3cd.jpg","nickname":"winter","note":"","ucode":"2B068EDEAFEB56","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":440428,"discussion_content":"å®ƒäº§ç”ŸPromiseï¼Œå½“ç„¶æ˜¯å¾®è§‚ä»»åŠ¡äº†","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1551425655,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":1,"child_discussions":[{"author":{"id":3166573,"avatar":"https://static001.geekbang.org/account/avatar/00/30/51/6d/e4aed428.jpg","nickname":"%","note":"","ucode":"C5FC6B541307AE","race_medal":1,"user_type":1,"is_pvip":false},"reply_author":{"id":1268524,"avatar":"https://static001.geekbang.org/account/avatar/00/13/5b/2c/12bfd3cd.jpg","nickname":"winter","note":"","ucode":"2B068EDEAFEB56","race_medal":0,"user_type":2,"is_pvip":false},"discussion":{"id":588242,"discussion_content":"æ‰€ä»¥awaitåé¢çš„ä»£ç å¯ä»¥ç†è§£ä¸ºéƒ½æ˜¯asyncäº§ç”Ÿçš„promiseçš„resolveå¾®ä»»åŠ¡å—","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1663605282,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":440428,"ip_address":"ä¸Šæµ·"},"score":588242,"extra":""}]}]},{"had_liked":false,"id":70752,"user_name":"å¥¥æ–¯ç‰¹æ´›å¤«æ–¯åŸº","can_delete":false,"product_type":"c1","uid":1379844,"ip_address":"","ucode":"9AFECAC3A1FCAD","user_header":"https://static001.geekbang.org/account/avatar/00/15/0e/04/d710d928.jpg","comment_is_top":false,"comment_ctime":1551174916,"is_pvip":false,"replies":[{"id":"25922","content":"åº”è¯¥è¯´ä¸€ä¸ªscriptæ ‡ç­¾æ˜¯ä¸€ä¸ªå®ä»»åŠ¡ã€‚","user_name":"ä½œè€…å›å¤","user_name_real":"winter","uid":"1268524","ctime":1551432365,"ip_address":"","comment_id":70752,"utype":1}],"discussion_count":1,"race_medal":0,"score":"44500847876","product_id":100023201,"comment_content":"åŒæ­¥çš„ä»£ç å’ŒsetTimeoutéƒ½æ˜¯å®ä»»åŠ¡ï¼Ÿ","like_count":11,"discussions":[{"author":{"id":1268524,"avatar":"https://static001.geekbang.org/account/avatar/00/13/5b/2c/12bfd3cd.jpg","nickname":"winter","note":"","ucode":"2B068EDEAFEB56","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":440809,"discussion_content":"åº”è¯¥è¯´ä¸€ä¸ªscriptæ ‡ç­¾æ˜¯ä¸€ä¸ªå®ä»»åŠ¡ã€‚","likes_number":1,"is_delete":false,"is_hidden":false,"ctime":1551432365,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":84085,"user_name":"å°å­”","can_delete":false,"product_type":"c1","uid":1470304,"ip_address":"","ucode":"F76D25C5417F2D","user_header":"https://static001.geekbang.org/account/avatar/00/16/6f/60/edbb8b8a.jpg","comment_is_top":false,"comment_ctime":1554780490,"is_pvip":false,"replies":[{"id":"30358","content":"1. å¯¹<br>2. è¿˜æ˜¯å®è§‚ä»»åŠ¡ï¼Œå› ä¸ºä½ è°ƒç”¨åˆ°äº†å¼•æ“ä»¥å¤–çš„APIå‘€","user_name":"ä½œè€…å›å¤","user_name_real":"winter","uid":"1268524","ctime":1554804214,"ip_address":"","comment_id":84085,"utype":1}],"discussion_count":1,"race_medal":0,"score":"35914518858","product_id":100023201,"comment_content":"1. async&#47;await ï¼Œé‡åˆ°awaitæ—¶å°±ä¼šé€€å‡ºæ‰§è¡Œï¼Œæˆ‘æƒ³é—®ä¸‹ï¼Œé€€å‡ºä¹‹åæ˜¯å¤„äºç­‰å¾…awaitæ‰§è¡Œå®Œå†å¼€å§‹ä¹‹åå—ï¼Ÿ<br>2. å¦‚æœpromiseä¸­äº§ç”ŸsetTimeoutå‡½æ•°ï¼Œé‚£ä¹ˆåœ¨è¿™é‡Œçš„setTimeoutæ˜¯å¤„äºå¾®è§‚ä»»åŠ¡å¯¹å—ï¼Ÿå› ä¸ºè¿™æ˜¯jså¼•æ“ç›´æ¥å‘èµ·çš„ï¼Ÿ<br>","like_count":8,"discussions":[{"author":{"id":1268524,"avatar":"https://static001.geekbang.org/account/avatar/00/13/5b/2c/12bfd3cd.jpg","nickname":"winter","note":"","ucode":"2B068EDEAFEB56","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":446248,"discussion_content":"1. å¯¹\n2. è¿˜æ˜¯å®è§‚ä»»åŠ¡ï¼Œå› ä¸ºä½ è°ƒç”¨åˆ°äº†å¼•æ“ä»¥å¤–çš„APIå‘€","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1554804214,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":94783,"user_name":"CaveShao","can_delete":false,"product_type":"c1","uid":1478271,"ip_address":"","ucode":"E45740787F82AB","user_header":"https://static001.geekbang.org/account/avatar/00/16/8e/7f/4ff4472f.jpg","comment_is_top":false,"comment_ctime":1557896784,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"27327700560","product_id":100023201,"comment_content":"   function func(color, duration) {<br>        return new Promise(function(resolve, reject) {<br>            light.style.backgroundColor = color;<br>            setTimeout(function() {<br>                it.next();<br>            }, duration)<br>        })<br>    }<br><br>    function* main() {<br>        while (1) {<br>            yield func(&#39;red&#39;,2000);<br>            yield func(&#39;yellow&#39;,1000);<br>            yield func(&#39;green&#39;,3000);<br>        }<br>    }<br><br>    var it = main();<br>    it.next();","like_count":6},{"had_liked":false,"id":78665,"user_name":"å¸…æ°”å°ç†ŠçŒ«","can_delete":false,"product_type":"c1","uid":1022199,"ip_address":"","ucode":"88FE6B57F55063","user_header":"https://static001.geekbang.org/account/avatar/00/0f/98/f7/abb7bfe3.jpg","comment_is_top":false,"comment_ctime":1553215057,"is_pvip":false,"discussion_count":3,"race_medal":0,"score":"27323018833","product_id":100023201,"comment_content":"æ€ä¹ˆç¡®å®šè¿™ä¸ªå¾®ä»»åŠ¡å±äºä¸€ä¸ªå®ä»»åŠ¡å‘¢ï¼Œjsä¸»çº¿ç¨‹è·‘ä¸‹æ¥ï¼Œé‡åˆ°setTImeoutä¼šæ”¾åˆ°å¼‚æ­¥é˜Ÿåˆ—å®ä»»åŠ¡ä¸­ï¼Œé‚£ä¸‹é¢çš„é‡åˆ°çš„promiseæ€ä¹ˆåˆ¤æ–­å‡ºå®ƒæ˜¯å±äºè¿™ä¸ªå®ä»»åŠ¡å‘¢ï¼Ÿæ˜¯ä¸æ˜¯åªæœ‰è¿™ä¸ªå®ä»»åŠ¡æ²¡æœ‰ä»å¼‚æ­¥é˜Ÿåˆ—ä¸­å–å‡ºï¼Œä¸­é—´æ‰€ç¢°åˆ°çš„æ‰€æœ‰å¾®ä»»åŠ¡éƒ½å±äºè¿™ä¸ªå®ä»»åŠ¡ï¼Ÿ","like_count":6,"discussions":[{"author":{"id":1344810,"avatar":"https://static001.geekbang.org/account/avatar/00/14/85/2a/376dd985.jpg","nickname":"uccs","note":"","ucode":"93DF5B81AB170E","race_medal":0,"user_type":1,"is_pvip":true},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":304356,"discussion_content":"å®ä»»åŠ¡æœ‰å®ä»»åŠ¡é˜Ÿåˆ—ï¼Œå¾®ä»»åŠ¡æœ‰å¾®ä»»åŠ¡é˜Ÿåˆ—ï¼Œä¸€ä¸ªå®ä»»åŠ¡ä¼šè·Ÿä¸€ä¸ªå¾®ä»»åŠ¡é˜Ÿåˆ—ï¼Œä¹Ÿå°±æ˜¯è¯´åœ¨å½“å‰å®ä»»åŠ¡æ‰§è¡Œç»“æŸå‰ï¼Œä¼šå»æ‰§è¡Œå½“å‰å®ä»»åŠ¡äº§ç”Ÿçš„å¾®ä»»åŠ¡é˜Ÿåˆ—ï¼Œå¾®ä»»åŠ¡é˜Ÿåˆ—æ‰§è¡Œå®Œåï¼Œåœ¨ä»å®ä»»åŠ¡é˜Ÿåˆ—ä¸­å–å‡ºä¸€ä¸ªå®ä»»åŠ¡æ‰§è¡Œï¼Œè¿™ä¸ªå®ä»»åŠ¡æ‰§è¡Œç»“æŸå‰ï¼Œå†æ‰§è¡Œè¿™ä¸ªå®ä»»åŠ¡ä¸­äº§ç”Ÿçš„å¾®ä»»åŠ¡é˜Ÿåˆ—ï¼Œä¸€ç›´è¿™æ ·é‡å¤æ‰§è¡Œï¼Œç›´åˆ°å…¨éƒ¨çš„å®ä»»åŠ¡å’Œå¾®ä»»åŠ¡æ‰§è¡Œå®Œ","likes_number":2,"is_delete":false,"is_hidden":false,"ctime":1599552490,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1201350,"avatar":"https://static001.geekbang.org/account/avatar/00/12/54/c6/c2481790.jpg","nickname":"lisiur","note":"","ucode":"CEB2DBCE29CAA7","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":171878,"discussion_content":"æˆ‘çš„ç†è§£æ˜¯ï¼Œå®ä»»åŠ¡å’Œå¾®ä»»åŠ¡æ˜¯ä¸¤ä¸ªä¸ç›¸å…³é˜Ÿåˆ—ï¼Œjsæ˜¯å•çº¿ç¨‹çš„ï¼Œæ‰€ä»¥ä»»ä½•æ—¶å€™ï¼Œæ–°åŠ çš„ä»»åŠ¡ä¸æ˜¯å®ä»»åŠ¡å°±æ˜¯å¾®ä»»åŠ¡ã€‚æ‰§è¡Œé¡ºåºæ˜¯ï¼šä¾æ¬¡æ‰§è¡Œå®ä»»åŠ¡ï¼Œä½†æ˜¯æ‰§è¡Œä¸‹ä¸€ä¸ªå®ä»»åŠ¡çš„å‰ææ˜¯å½“å‰å¾®ä»»åŠ¡é˜Ÿåˆ—ä¸ºç©ºã€‚","likes_number":2,"is_delete":false,"is_hidden":false,"ctime":1581754874,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1113661,"avatar":"","nickname":"Geek_c0a663","note":"","ucode":"9DD00AFB8E65F8","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":289688,"discussion_content":"æ—¢ç„¶ä¸‹ä¸€ä¸ªå®ä»»åŠ¡æ‰§è¡Œå‰å¾®ä»»åŠ¡é˜Ÿåˆ—å¿…ä¸ºç©ºï¼Œé‚£å°±æ„å‘³ç€å¾®ä»»åŠ¡é˜Ÿåˆ—çš„æ›´æ–°å¿…ç”±å½“å‰å®ä»»åŠ¡æ‰§è¡Œè¿‡ç¨‹ä¸­çš„é€»è¾‘è§¦å‘","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1594179829,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":70672,"user_name":"å‘¨åºçŒ¿","can_delete":false,"product_type":"c1","uid":1374169,"ip_address":"","ucode":"C6D09DBAA22F94","user_header":"https://static001.geekbang.org/account/avatar/00/14/f7/d9/3014889f.jpg","comment_is_top":false,"comment_ctime":1551161583,"is_pvip":false,"replies":[{"id":"25919","content":"é¢ è¿™ä¸ªç»“æœæ˜¯å¯¹çš„ ä¸è¿‡å°è£…æˆè¿™æ · åˆé€‚å—ï¼Ÿ","user_name":"ä½œè€…å›å¤","user_name_real":"winter","uid":"1268524","ctime":1551432117,"ip_address":"","comment_id":70672,"utype":1}],"discussion_count":1,"race_medal":0,"score":"18731030767","product_id":100023201,"comment_content":"&#47;&#47; å¦ç±»çš„å†™æ³•<br> var lightDiv = document.getElementById(&#39;light&#39;)<br>    function wait(seconds){<br>      return new Promise((resolve)=&gt;{<br>        setTimeout(resolve,seconds)<br>      })<br>    }<br><br>    function light(color, waitTime){<br>      this.color = color<br>      this.waitTime = waitTime<br>    }<br>    light.prototype.run = function(){<br>      lightDiv.style.backgroundColor = this.color<br>      return wait(this.waitTime).then(()=&gt;{<br>        return this.nextLight.run()<br>      })<br>    }<br><br>    let redLight = new light(&#39;red&#39;,2000)<br>    let yellowLight = new light(&#39;yellow&#39;,1000)<br>    let greenLight = new light(&#39;green&#39;,3000)<br><br>    redLight.nextLight = greenLight<br>    yellowLight.nextLight = redLight<br>    greenLight.nextLight = yellowLight<br><br>    redLight.run()","like_count":4,"discussions":[{"author":{"id":1268524,"avatar":"https://static001.geekbang.org/account/avatar/00/13/5b/2c/12bfd3cd.jpg","nickname":"winter","note":"","ucode":"2B068EDEAFEB56","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":440761,"discussion_content":"é¢ è¿™ä¸ªç»“æœæ˜¯å¯¹çš„ ä¸è¿‡å°è£…æˆè¿™æ · åˆé€‚å—ï¼Ÿ","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1551432117,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":69882,"user_name":"è®¸ç«¥ç«¥","can_delete":false,"product_type":"c1","uid":1003005,"ip_address":"","ucode":"4B799C0C6BC678","user_header":"https://static001.geekbang.org/account/avatar/00/0f/4d/fd/0aa0e39f.jpg","comment_is_top":false,"comment_ctime":1550896078,"is_pvip":false,"replies":[{"id":"25837","content":"ä½ è¿™ä¸ªæœ‰ç‚¹é—®é¢˜ï¼Œæ‰§è¡Œå¤šäº†å¯èƒ½çˆ†æ ˆï¼Œæ”¹æ”¹è¯•è¯•ï¼Ÿ","user_name":"ä½œè€…å›å¤","user_name_real":"winter","uid":"1268524","ctime":1551425229,"ip_address":"","comment_id":69882,"utype":1}],"discussion_count":6,"race_medal":0,"score":"18730765262","product_id":100023201,"comment_content":"async function controlLoop () {<br>  await changeColor(&#39;green&#39;, 3000)<br>  await changeColor(&#39;yellow&#39;, 1000)<br>  await changeColor(&#39;red&#39;, 2000)<br>  await controlLoop()<br>}<br><br>async function changeColor (color, time) {<br>  console.log(color + &#39; begin&#39;)<br>  return new Promise((resolve) =&gt; {<br>    setTimeout(() =&gt; {<br>      console.log(color + &#39; end&#39;)<br>      resolve()<br>    }, time)<br>  })<br>}<br><br>controlLoop()","like_count":4,"discussions":[{"author":{"id":1268524,"avatar":"https://static001.geekbang.org/account/avatar/00/13/5b/2c/12bfd3cd.jpg","nickname":"winter","note":"","ucode":"2B068EDEAFEB56","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":440329,"discussion_content":"ä½ è¿™ä¸ªæœ‰ç‚¹é—®é¢˜ï¼Œæ‰§è¡Œå¤šäº†å¯èƒ½çˆ†æ ˆï¼Œæ”¹æ”¹è¯•è¯•ï¼Ÿ","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1551425229,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1267308,"avatar":"https://static001.geekbang.org/account/avatar/00/13/56/6c/0e19dcbf.jpg","nickname":"jss","note":"","ucode":"DB0D2CA916EF17","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":286003,"discussion_content":"      let colorArr = [\n        { color: &#34;green&#34;, duration: 1 },\n        { color: &#34;yellow&#34;, duration: 1 },\n        { color: &#34;red&#34;, duration: 1 },\n      ];\n\n      let count = 0;\n\n      function autoRun() {\n        let color = colorArr[count % 3].color;\n        let duration = colorArr[(count + 1) % 3].duration;\n        return new Promise((resolve) => {\n          setTimeout(() => {\n            resolve()\n            setColor(color);\n          }, duration);\n        });\n      }\n\n      function setColor(color) {\n        document.querySelector(&#39;.color&#39;).style.backgroundColor = color\n        console.log(count, color);\n        count++;\n        autoRun()\n      }\n\n      autoRun();\n\næˆ‘è¿™æ ·è¯•äº†ä¸€ä¸‹æ‰§è¡Œ20000æ¬¡æ²¡æœ‰çˆ†æ ˆ","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1593010837,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1698448,"avatar":"http://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTKwic6jhGhicZ99aYDhGvJQ6zz8EVbCJsTh1qfhors2FzCSZAO8z4ibArGnsyOl7Tc8e3Vr4240V7oqQ/132","nickname":"Geek_7cc450","note":"","ucode":"337CC3DEA138F4","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":44487,"discussion_content":"æ˜¯å› ä¸ºä¸€ç›´é€’å½’æ²¡æœ‰è¿”å›å—ï¼Ÿ","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1572953496,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1078023,"avatar":"https://static001.geekbang.org/account/avatar/00/10/73/07/c1a31ede.jpg","nickname":"åˆ˜å…ˆæ£®","note":"","ucode":"87ACF0D9AFD52D","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":37070,"discussion_content":"è™½ç„¶ç”¨äº†é€’å½’ä½†æ˜¯æ²¡æœ‰å¼•ç”¨ä»»ä½•å˜é‡ï¼Œåº”è¯¥ä¸ä¼šçˆ†å§","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1571494075,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1391613,"avatar":"https://static001.geekbang.org/account/avatar/00/15/3b/fd/37bf3990.jpg","nickname":"ç‹å† ","note":"","ucode":"DC1DF5FE36C7F0","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":8102,"discussion_content":"ä¸ºå•¥ä¼šçˆ†æ ˆ+1","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1567779337,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1374653,"avatar":"https://static001.geekbang.org/account/avatar/00/14/f9/bd/77862a22.jpg","nickname":"CHENJIAJIE","note":"","ucode":"11C522D35C9771","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":3804,"discussion_content":"èƒ½è§£ç­”ä¸€ä¸‹ä¸ºä»€ä¹ˆä¼šçˆ†æ ˆå—","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1564824358,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":131752,"user_name":"dellyoung","can_delete":false,"product_type":"c1","uid":1133028,"ip_address":"","ucode":"3672FF1D1F8EFD","user_header":"https://static001.geekbang.org/account/avatar/00/11/49/e4/fb47bfcd.jpg","comment_is_top":false,"comment_ctime":1567874182,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"14452776070","product_id":100023201,"comment_content":"15è¡Œä»£ç æœ€ç®€å®ç°ï¼š<br>const changeNowColor = (time) =&gt; {<br>    setTimeout(() =&gt; {<br>        switch (document.getElementById(&#39;root&#39;).style.background) {<br>            case &#39;green&#39;:<br>                document.getElementById(&#39;root&#39;).style.background = &#39;yellow&#39;;<br>                return changeNowColor(1000);<br>            case &#39;yellow&#39;:<br>                document.getElementById(&#39;root&#39;).style.background = &#39;red&#39;;<br>                return changeNowColor(2000);<br>            case &#39;red&#39;:<br>                document.getElementById(&#39;root&#39;).style.background = &#39;green&#39;;<br>                return changeNowColor(3000);<br>        }<br>    }, time);<br>};<br>changeNowColor(3000);","like_count":4},{"had_liked":false,"id":111594,"user_name":"ğŸ‡¨ğŸ‡³ğŸ‡¨ğŸ‡³ğŸ‡¨ğŸ‡³","can_delete":false,"product_type":"c1","uid":1023202,"ip_address":"","ucode":"814DE82B65007E","user_header":"https://static001.geekbang.org/account/avatar/00/0f/9c/e2/368f6734.jpg","comment_is_top":false,"comment_ctime":1562570539,"is_pvip":false,"replies":[{"id":"58921","content":"è¿™ä¸æ˜¯èƒ¡è¯´å‘¢ä¹ˆã€‚","user_name":"ä½œè€…å›å¤","user_name_real":"winter","uid":"1268524","ctime":1574221132,"ip_address":"","comment_id":111594,"utype":1}],"discussion_count":2,"race_medal":0,"score":"14447472427","product_id":100023201,"comment_content":"async&#47;awiat åªæ˜¯generator&#47;iteratorçš„è¯­æ³•ç³–è€Œå·²","like_count":3,"discussions":[{"author":{"id":1268524,"avatar":"https://static001.geekbang.org/account/avatar/00/13/5b/2c/12bfd3cd.jpg","nickname":"winter","note":"","ucode":"2B068EDEAFEB56","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":457384,"discussion_content":"è¿™ä¸æ˜¯èƒ¡è¯´å‘¢ä¹ˆã€‚","likes_number":1,"is_delete":false,"is_hidden":false,"ctime":1574221132,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1367464,"avatar":"https://static001.geekbang.org/account/avatar/00/14/dd/a8/a2c910b6.jpg","nickname":"katalya","note":"","ucode":"CCD1FE6C4F8C1E","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":584414,"discussion_content":"é˜®ä¸€å³°çš„ç½‘å€ä¹Ÿæœ‰è¿™ä¸ªè¯´æ³•ï¼Œè¿™ç»™æˆ‘å¹²æ‡µäº†","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1660810557,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":"å¹¿ä¸œ"},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":84758,"user_name":"æ‹’ç»ç¬¬åä¸ƒæ¬¡ğŸ¤¤","can_delete":false,"product_type":"c1","uid":1170443,"ip_address":"","ucode":"B75CE9C1D29D30","user_header":"https://static001.geekbang.org/account/avatar/00/11/dc/0b/0baff83d.jpg","comment_is_top":false,"comment_ctime":1554903177,"is_pvip":false,"discussion_count":1,"race_medal":0,"score":"14439805065","product_id":100023201,"comment_content":"    let sleep = (color,deep)=&gt;{<br>      return new Promise(reslove=&gt;{<br>        setTimeout(()=&gt;reslove(color) ,deep)<br>      })<br>    }<br>    async function  changColor (color){<br>      await sleep (&#39;green&#39;,3000),<br>      await sleep (&#39;yellow&#39;,1000)<br>      await sleep (&#39;red&#39;,2000)<br>    }<br>    changColor();","like_count":3,"discussions":[{"author":{"id":1663917,"avatar":"https://static001.geekbang.org/account/avatar/00/19/63/ad/5e90bac7.jpg","nickname":"Amui","note":"","ucode":"4D76F86046B06A","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":161169,"discussion_content":"åªæ‰§è¡Œäº†ä¸€æ¬¡å•Š","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1580873648,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":72120,"user_name":"oillie","can_delete":false,"product_type":"c1","uid":1031714,"ip_address":"","ucode":"5907CE80C45CB5","user_header":"https://static001.geekbang.org/account/avatar/00/0f/be/22/8bb1640f.jpg","comment_is_top":false,"comment_ctime":1551525164,"is_pvip":false,"discussion_count":2,"race_medal":0,"score":"14436427052","product_id":100023201,"comment_content":"ä¸€ä¸ªå®ä»»åŠ¡åŒ…å«ä¸€ä¸ªå¾®ä»»åŠ¡é˜Ÿåˆ—ï¼Ÿè¿˜æ˜¯ä¸€ä¸ªevent loopé‡Œåªæœ‰ä¸€ä¸ªå¾®ä»»åŠ¡é˜Ÿåˆ—ï¼Œè™½ç„¶ä¸å½±å“å®é™…æ•ˆæœï¼Œä½†è¿˜æ˜¯æƒ³ç¡®è®¤ä¸‹..","like_count":3,"discussions":[{"author":{"id":2813740,"avatar":"https://static001.geekbang.org/account/avatar/00/2a/ef/2c/9f96ded7.jpg","nickname":"Ha0ran","note":"","ucode":"A36AD84DAC48B2","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":573939,"discussion_content":"äº‹ä»¶å¾ªç¯é‡Œå¯ä»¥åŒ…å«äº†å¤šä¸ªå®ä»»åŠ¡ï¼Œå®ä»»åŠ¡é‡Œå¯ä»¥åŒ…å«å¤šä¸ªå¾®ä»»åŠ¡","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1653737487,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1113661,"avatar":"","nickname":"Geek_c0a663","note":"","ucode":"9DD00AFB8E65F8","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":289689,"discussion_content":"ä¸»è¦è¿˜æ˜¯æ¦‚å¿µç†è§£ä¸ºä¸»ï¼Œå‰è€…æ¯”è¾ƒåˆé€‚ï¼Œæ•´ä½“ç†è§£æ¯”è¾ƒæ–¹ä¾¿ï¼›åè€…åå®ç°ç»†èŠ‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1594180079,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":70824,"user_name":"Geek_e21f0d","can_delete":false,"product_type":"c1","uid":1386373,"ip_address":"","ucode":"B83F55322BF73B","user_header":"http://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTJEPMj69Hy9qq8SuEsiccKKaJQt20vvjl9Z9DMJxNmvrq6X3LrDMONTT6Jkg70kEVg13Lkdc6eMWlA/132","comment_is_top":false,"comment_ctime":1551190839,"is_pvip":false,"replies":[{"id":"25924","content":"å°è£…ä¸æ˜¯è¶Šå¤æ‚è¶Šå¥½ï¼Œå¤ªå¤æ‚äº†è¿˜ä¸å¦‚ç›´æ¥setTimeoutäº†","user_name":"ä½œè€…å›å¤","user_name_real":"winter","uid":"1268524","ctime":1551432482,"ip_address":"","comment_id":70824,"utype":1}],"discussion_count":1,"race_medal":0,"score":"14436092727","product_id":100023201,"comment_content":"let lightStates = [{<br>        color: &#39;green&#39;,<br>        duration: 3000<br>    },<br>    {<br>        color: &#39;yellow&#39;,<br>        duration: 1000<br>    },<br>    {<br>        color: &#39;red&#39;,<br>        duration: 2000<br>    }];<br>    let setLightColorAndVisibleDuration = function(color, duration) {<br>        &#47;&#47;set light color<br>        return new Promise((resolve) =&gt; {<br>            setTimeout(() =&gt; {<br>                resolve();<br>            }, duration);<br>        });<br>    }<br>    let startShowLight = async function() {<br>        let index = 0;<br>        while(index &lt;= lightStates.length - 1) {<br>            let nextState = lightStates[index];<br>            await setLightColorAndVisibleDuration(nextState.color, nextState.duration);<br>            index++;<br>        }<br>        <br>    };<br>    startShowLight();","like_count":3,"discussions":[{"author":{"id":1268524,"avatar":"https://static001.geekbang.org/account/avatar/00/13/5b/2c/12bfd3cd.jpg","nickname":"winter","note":"","ucode":"2B068EDEAFEB56","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":440848,"discussion_content":"å°è£…ä¸æ˜¯è¶Šå¤æ‚è¶Šå¥½ï¼Œå¤ªå¤æ‚äº†è¿˜ä¸å¦‚ç›´æ¥setTimeoutäº†","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1551432482,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":70669,"user_name":"Jurieo","can_delete":false,"product_type":"c1","uid":1382175,"ip_address":"","ucode":"A4ED90DC31F446","user_header":"https://static001.geekbang.org/account/avatar/00/15/17/1f/47868a4a.jpg","comment_is_top":false,"comment_ctime":1551161268,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"14436063156","product_id":100023201,"comment_content":"å“ˆå“ˆï¼Œæˆ‘è‡ªå·±æ€è€ƒçš„æ‰§è¡Œé¡ºåºæ˜¯ åŒæ­¥-å¼‚æ­¥-å›è°ƒï¼ŒæˆåŠŸæ­£ç¡®è¾“å‡ºäº†è€å¸ˆä½ ä¸Šé¢çš„å„ä¸ªä»£ç çš„ç­”æ¡ˆã€‚","like_count":3},{"had_liked":false,"id":69824,"user_name":"NeverEver","can_delete":false,"product_type":"c1","uid":1247966,"ip_address":"","ucode":"29194A962340A6","user_header":"https://static001.geekbang.org/account/avatar/00/13/0a/de/8c4810b0.jpg","comment_is_top":false,"comment_ctime":1550854674,"is_pvip":false,"replies":[{"id":"25830","content":"ä»£ç å†™å†™çœ‹å‘€ã€‚ åŠ¨æ‰‹æ˜¯æ”¶è·æœ€å¤§çš„ã€‚","user_name":"ä½œè€…å›å¤","user_name_real":"winter","uid":"1268524","ctime":1551424934,"ip_address":"","comment_id":69824,"utype":1}],"discussion_count":1,"race_medal":0,"score":"14435756562","product_id":100023201,"comment_content":"æˆ‘æƒ³åˆ°çš„æ–¹æ³•æ˜¯ç”¨Recursionã€‚å†™ä¸€ä¸ªå‡½æ•°setColorï¼Œéœ€è¦ä¸€ä¸ªå‚æ•°colorï¼Œå‡½æ•°é‡Œé¦–å…ˆæŠŠdivçš„backgroundColorè®¾ç½®colorï¼Œç„¶åç”¨setTimeoutæ¥è®¾ç½®ä¸‹ä¸€ä¸ªé¢œè‰²ï¼Œæ ¹æ®ä¼ å…¥çš„colorç›¸åº”æ›´æ”¹æ—¶é—´å’Œé¢œè‰²å³å¯","like_count":3,"discussions":[{"author":{"id":1268524,"avatar":"https://static001.geekbang.org/account/avatar/00/13/5b/2c/12bfd3cd.jpg","nickname":"winter","note":"","ucode":"2B068EDEAFEB56","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":440303,"discussion_content":"ä»£ç å†™å†™çœ‹å‘€ã€‚ åŠ¨æ‰‹æ˜¯æ”¶è·æœ€å¤§çš„ã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1551424934,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":307059,"user_name":"Friday","can_delete":false,"product_type":"c1","uid":1438506,"ip_address":"","ucode":"AAC10610CF848D","user_header":"http://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTJ9Y45QovHzGatCRAIdAaCmWuQIZv88zdDeWsbR8w58FX34a4g5PPdna4f5phodeKDia2kWNR9mjJA/132","comment_is_top":false,"comment_ctime":1628844203,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"10218778795","product_id":100023201,"comment_content":"è¿™ä¸€ç« å…³äºå®ä»»åŠ¡å’Œå¾®ä»»åŠ¡çš„è®²è§£å¾ˆä¸æ¸…æ¥šã€‚ç¬¬ä¸€å¹¶ä¸æ˜¯å®ä»»åŠ¡åŒ…å«å¾®ä»»åŠ¡ã€‚ç¬¬äºŒä¹Ÿä¸æ˜¯å¾®ä»»åŠ¡å…ˆäºå®ä»»åŠ¡æ‰§è¡Œã€‚è€å¸ˆçš„è¿™ä¸€ç« çœŸçš„è®²çš„å¾ˆä¹±ã€‚","like_count":2},{"had_liked":false,"id":213986,"user_name":"î€šsh","can_delete":false,"product_type":"c1","uid":1428920,"ip_address":"","ucode":"720991D01D50D9","user_header":"https://static001.geekbang.org/account/avatar/00/15/cd/b8/14597b01.jpg","comment_is_top":false,"comment_ctime":1588608243,"is_pvip":false,"discussion_count":1,"race_medal":0,"score":"10178542835","product_id":100023201,"comment_content":"æœ‰ä¸€ç‚¹æ²¡æ˜ç™½è€å¸ˆï¼Œjsæ˜¯å•çº¿ç¨‹çš„ å®ä»»åŠ¡æ˜¯ç”±æµè§ˆå™¨æ‰§è¡Œçš„ æ‰€ä»¥æ˜¯å¼‚æ­¥ï¼Œè¿™ä¸ªç†è§£ã€‚ä½†æ˜¯å¾®ä»»åŠ¡promiseæ‚¨è¿™é‡Œè¯´æ˜¯jsè‡ªèº«æ‰§è¡Œçš„ï¼Œé‚£ä¹ˆæ—¢ç„¶jsæ˜¯å•çº¿ç¨‹ï¼Œå¾ˆå¥½å¥‡è¿™é‡Œçš„å¼‚æ­¥æ˜¯å¦‚ä½•åšåˆ°çš„å‘¢ï¼Ÿ","like_count":2,"discussions":[{"author":{"id":2225061,"avatar":"https://static001.geekbang.org/account/avatar/00/21/f3/a5/b34f7074.jpg","nickname":"Hero","note":"","ucode":"1B916D1F98BEB6","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":398327,"discussion_content":"jsæœ¬èº«æ˜¯ä¸€ä¸ªå•çº¿ç¨‹ï¼Œä½†æ˜¯æµè§ˆå™¨æ˜¯å¤šçº¿ç¨‹ã€‚  å¼‚æ­¥çº¿ç¨‹å’Œjsçº¿ç¨‹éƒ½æ˜¯æµè§ˆå™¨ä¼—å¤šçº¿ç¨‹ä¸­çš„ä¸€éƒ¨åˆ†ï¼Œæµè§ˆå™¨æ€»å…±æœ‰å¤§æ¦‚å…­ä¸ƒä¸ªçº¿ç¨‹ã€‚ å°è±¡ä¸­æ˜¯è¿™æ ·çš„ ä½ å¯ä»¥å†å»ç ”ç©¶ä¸‹å“ˆã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1632757582,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":104655,"user_name":"å¤§åŠ›","can_delete":false,"product_type":"c1","uid":1364353,"ip_address":"","ucode":"1B2125C519443D","user_header":"https://static001.geekbang.org/account/avatar/00/14/d1/81/89ba9d81.jpg","comment_is_top":false,"comment_ctime":1560815470,"is_pvip":false,"replies":[{"id":"58944","content":"æ›´ä¹±äº†ï¼Œå¾ˆéš¾åˆ†æ","user_name":"ä½œè€…å›å¤","user_name_real":"winter","uid":"1268524","ctime":1574222298,"ip_address":"","comment_id":104655,"utype":1}],"discussion_count":1,"race_medal":0,"score":"10150750062","product_id":100023201,"comment_content":"ç”¨äº†async, awaitåè²Œä¼¼å®è§‚ä¸å¾®è§‚ä»»åŠ¡åˆ†å¾—æ²¡é‚£ä¹ˆæ¸…æ™°äº†ã€‚","like_count":2,"discussions":[{"author":{"id":1268524,"avatar":"https://static001.geekbang.org/account/avatar/00/13/5b/2c/12bfd3cd.jpg","nickname":"winter","note":"","ucode":"2B068EDEAFEB56","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":454362,"discussion_content":"æ›´ä¹±äº†ï¼Œå¾ˆéš¾åˆ†æ","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1574222298,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":84996,"user_name":"aå°ç£Šã€‚à¸ˆà¸¸à¹Šà¸š ğŸŒ¹","can_delete":false,"product_type":"c1","uid":1291044,"ip_address":"","ucode":"9F9CE2C46BB7DB","user_header":"https://static001.geekbang.org/account/avatar/00/13/b3/24/1ee8fe0e.jpg","comment_is_top":false,"comment_ctime":1554953750,"is_pvip":false,"discussion_count":3,"race_medal":0,"score":"10144888342","product_id":100023201,"comment_content":"å¤§ä½¬ä»¬æˆ‘æœ‰é—®é¢˜æƒ³ä¸æ˜ç™½ï¼š<br>new Promise(function(resovle, reject) {<br>        setTimeout(resovle, duration);<br>      })<br>setTimeout(resovle, duration);å’ŒsetTimeout(() =&gt; {resovle()}, duration);ä¸¤è€…åˆ°åº•æœ‰ä»€ä¹ˆåŒºåˆ«ï¼Œæƒ³ä¸æ˜ç™½ï¼Œæ±‚æ•™","like_count":2,"discussions":[{"author":{"id":1910075,"avatar":"https://static001.geekbang.org/account/avatar/00/1d/25/3b/a971fc8e.jpg","nickname":"é˜¿æ„Ÿ","note":"","ucode":"7BCB7E44A832D1","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":253388,"discussion_content":"é¢è¯•é¢˜ä½ çœ‹çœ‹\nfunction sayHi(){\n    console.log(&#39;Hello,&#39;, this.name);\n}\nvar person1 = {\n    name: &#39;YvetteLau&#39;,\n    sayHi: function(){\n        setTimeout(function(){\n            console.log(&#39;Hello,&#39;,this.name);\n        })\n    }\n}\nvar person2 = {\n    name: &#39;Christina&#39;,\n    sayHi: sayHi\n}\nvar name=&#39;Wiliam&#39;;\nperson1.sayHi();\nsetTimeout(person2.sayHi,100);\nsetTimeout(function(){\n    person2.sayHi();\n},200);\nç»“æœä¸º:\n\nHello, Wiliam\nHello, Wiliam\nHello, Christina\næ¥è‡ª\nhttps://github.com/YvetteLau/Blog/issues/6","likes_number":2,"is_delete":false,"is_hidden":false,"ctime":1588231357,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1193745,"avatar":"https://static001.geekbang.org/account/avatar/00/12/37/11/423fa8c5.jpg","nickname":"ä¸€ç›´å¾ˆå®‰é™","note":"","ucode":"13154258644BD0","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":306436,"discussion_content":"æ‰€ä»¥ï¼Œæ•´ä¸¤ç§å†™æ³•çš„thisæŒ‡å‘ä¸æ˜¯ä¸€æ ·çš„å—","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1600267910,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1910075,"avatar":"https://static001.geekbang.org/account/avatar/00/1d/25/3b/a971fc8e.jpg","nickname":"é˜¿æ„Ÿ","note":"","ucode":"7BCB7E44A832D1","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":253374,"discussion_content":"å‰å‡ å¤©çœ‹äº†æœ‰å…³thisæŒ‡å‘çš„é—®é¢˜ï¼Œåœ¨setTimeoutä¸­thisæœ‰æ—¶å€™å˜çš„å¥‡æ€ªã€‚è¿™é‡Œåº”è¯¥å¯ä»¥å›ç­”ä¸€ä¸ªåŒºåˆ«ç‚¹â€¦â€¦\nsetTimeout(myArray.myMethod, 1000); // prints &#34;[object Window]&#34; after 1 second\nè‹¥ä½ æƒ³æŠŠthisä¾æ—§æŒ‡å‘myArrayè¿™ä¸ªå¯¹è±¡ï¼Œä¸€ä¸ªé€šç”¨çš„æ–¹æ³•æ˜¯ç”¨åŒ…è£…å‡½æ•°æ¥è®¾ç½®thisï¼š\nsetTimeout(function(){myArray.myMethod()}, 2000); // prints &#34;zero,one,two&#34; after 2 seconds\næˆ–è€…\nsetTimeout(() => {myArray.myMethod()}, 2000); // prints &#34;zero,one,two&#34; after 2 seconds\næ¥è‡ª\nhttps://developer.mozilla.org/zh-CN/docs/Web/API/Window/setTimeout\n\nsetTimeout(fn,delay) { fn(); } å®é™…ä¸Šfnæ˜¯ä¸€ä¸ªå‚æ•°ä¼ é€’çš„å¼•ç”¨(fn=obj.cool),åœ¨fn=obj.coolè¿™é‡Œï¼Œthisçš„æŒ‡å‘ä»objå˜æˆäº†å…¨å±€ï¼Œï¼ˆfnçš„è°ƒç”¨è€…æ˜¯windowå¯¹è±¡ï¼Œæ‰€ä»¥thisæŒ‡å‘äº†window)  è¿™å‡ å¥è¯æ„æ€èƒ½å¤Ÿè¯´æ˜thisçš„å˜åŒ–\næ¥è‡ª https://segmentfault.com/q/1010000010340361\n","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1588230622,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":83166,"user_name":"Geek_55d7cf","can_delete":false,"product_type":"c1","uid":1294267,"ip_address":"","ucode":"E2D10A487E399A","user_header":"https://static001.geekbang.org/account/avatar/00/13/bf/bb/c0e9847e.jpg","comment_is_top":false,"comment_ctime":1554447506,"is_pvip":false,"replies":[{"id":"30362","content":"å¾ˆå¤šå•Š è¿˜æœ‰event","user_name":"ä½œè€…å›å¤","user_name_real":"winter","uid":"1268524","ctime":1554804841,"ip_address":"","comment_id":83166,"utype":1}],"discussion_count":1,"race_medal":0,"score":"10144382098","product_id":100023201,"comment_content":"é™¤äº†setTimeoutè¿˜æœ‰å“ªäº›å®è§‚ä»»åŠ¡å‘¢ï¼Ÿ<br>","like_count":2,"discussions":[{"author":{"id":1268524,"avatar":"https://static001.geekbang.org/account/avatar/00/13/5b/2c/12bfd3cd.jpg","nickname":"winter","note":"","ucode":"2B068EDEAFEB56","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":445897,"discussion_content":"å¾ˆå¤šå•Š è¿˜æœ‰event","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1554804841,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":72655,"user_name":"sura","can_delete":false,"product_type":"c1","uid":1375463,"ip_address":"","ucode":"B4EB11AA17C40B","user_header":"https://static001.geekbang.org/account/avatar/00/14/fc/e7/6454a621.jpg","comment_is_top":false,"comment_ctime":1551686432,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"10141621024","product_id":100023201,"comment_content":"å…³äºasync await æ¨èçœ‹è¿™ä¸ª https:&#47;&#47;segmentfault.com&#47;q&#47;1010000016147496","like_count":2},{"had_liked":false,"id":69890,"user_name":"ä¸æ›¾æ½‡æ´’","can_delete":false,"product_type":"c1","uid":1236542,"ip_address":"","ucode":"5084439B0BC796","user_header":"https://static001.geekbang.org/account/avatar/00/12/de/3e/2e87843c.jpg","comment_is_top":false,"comment_ctime":1550897276,"is_pvip":false,"replies":[{"id":"25839","content":"å±äºç¬¬äºŒä¸ªå®ä»»åŠ¡ï¼Œå› ä¸ºå®ƒåœ¨setTimeoutä¹‹åæ‰§è¡Œã€‚","user_name":"ä½œè€…å›å¤","user_name_real":"winter","uid":"1268524","ctime":1551425338,"ip_address":"","comment_id":69890,"utype":1}],"discussion_count":2,"race_medal":0,"score":"10140831868","product_id":100023201,"comment_content":"è€å¸ˆä½ å¥½ï¼Œçœ‹äº†è¿™ç¯‡æ–‡ç« åå—ç›ŠåŒªæµ…ï¼Œæœ‰ä¸ªå°é—®é¢˜:<br>åœ¨Promiseæ®µçš„æœ€åä¸€ä¸ªä¾‹å­ä¸­ï¼Œæœ€åä¸€å¥ä»£ç :<br>sleep(5000).then(()=&gt;{console.log(&#39;c&#39;)})ï¼Œ<br>è¿™é‡Œé¢çš„æ‰“å°cæ˜¯å±äºç¬¬ä¸€ä¸ªå®ä»»åŠ¡è¿˜æ˜¯å±äºsetTimeäº§ç”Ÿçš„ç¬¬äºŒä¸ªå®ä»»åŠ¡å‘¢?","like_count":2,"discussions":[{"author":{"id":1268524,"avatar":"https://static001.geekbang.org/account/avatar/00/13/5b/2c/12bfd3cd.jpg","nickname":"winter","note":"","ucode":"2B068EDEAFEB56","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":440334,"discussion_content":"å±äºç¬¬äºŒä¸ªå®ä»»åŠ¡ï¼Œå› ä¸ºå®ƒåœ¨setTimeoutä¹‹åæ‰§è¡Œã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1551425338,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1384028,"avatar":"http://thirdwx.qlogo.cn/mmopen/vi_32/DYAIOgq83eplmzz3iccOAekzibWpSkMDlCE8oTujvy8aBMv0wANjTzuyyNXtfuiauGHMtfHtia9T0bd7w0B3lvg3zw/132","nickname":"ç‹æ–¹å›­","note":"","ucode":"1E07EA4453B702","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":128435,"discussion_content":"æç„¶å¤§æ‚Ÿ","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1578639108,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":69829,"user_name":"é˜¿æˆ","can_delete":false,"product_type":"c1","uid":1390032,"ip_address":"","ucode":"CEC3CD65FB9333","user_header":"https://static001.geekbang.org/account/avatar/00/15/35/d0/f2ac6d91.jpg","comment_is_top":false,"comment_ctime":1550879362,"is_pvip":false,"replies":[{"id":"25832","content":"å˜¿ è¿™æ˜¯å€Ÿç”¨äº†æˆ‘çš„Sleepå—<br><br>ä¸è¿‡æˆ‘çš„sleepé‡Œå•ä½å¯æ˜¯æ¯«ç§’å•Šâ€¦â€¦","user_name":"ä½œè€…å›å¤","user_name_real":"winter","uid":"1268524","ctime":1551424985,"ip_address":"","comment_id":69829,"utype":1}],"discussion_count":1,"race_medal":0,"score":"10140813954","product_id":100023201,"comment_content":"ç•¥ç®€é™‹...<br>&#47;&#47; sleep,green,red,yellow already defined<br>async function main () {<br>  while (true) {<br>    green()<br>    await sleep(3)<br>    yellow ()<br>    await sleep (1)<br>    red()<br>    await sleep(2)<br>  }<br>}<br>main()","like_count":2,"discussions":[{"author":{"id":1268524,"avatar":"https://static001.geekbang.org/account/avatar/00/13/5b/2c/12bfd3cd.jpg","nickname":"winter","note":"","ucode":"2B068EDEAFEB56","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":440305,"discussion_content":"å˜¿ è¿™æ˜¯å€Ÿç”¨äº†æˆ‘çš„Sleepå—\n\nä¸è¿‡æˆ‘çš„sleepé‡Œå•ä½å¯æ˜¯æ¯«ç§’å•Šâ€¦â€¦","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1551424985,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":333768,"user_name":"ç”µå•è½¦","can_delete":false,"product_type":"c1","uid":2859389,"ip_address":"","ucode":"21FE87326A8B9C","user_header":"https://static001.geekbang.org/account/avatar/00/2b/a1/7d/64ed0fdd.jpg","comment_is_top":false,"comment_ctime":1644504578,"is_pvip":true,"discussion_count":0,"race_medal":0,"score":"5939471874","product_id":100023201,"comment_content":"ä»»åŠ¡é˜Ÿåˆ—é‡Œçš„æ¯ä¸ªå®ä»»åŠ¡éƒ½æœ‰ä¸€ä¸ªå¾®ä»»åŠ¡é˜Ÿåˆ—ç”¨æ¥ä¿å­˜å½“å‰å®ä»»åŠ¡æ‰§è¡ŒæœŸé—´äº§ç”Ÿçš„å¾®ä»»åŠ¡ï¼Œå¾®ä»»åŠ¡æ˜¯åœ¨å½“å‰å®ä»»åŠ¡çš„æœ€åæ‰§è¡Œçš„ï¼Œå› ä¸ºå¾®ä»»åŠ¡ä¹Ÿæ˜¯å½“å‰å®ä»»åŠ¡çš„ä¸€éƒ¨åˆ†ï¼Œå¾®ä»»åŠ¡ä¸»è¦å°±ä¸¤ç§ï¼Œpromiseçš„resolveå’Œrejectä¼šäº§ç”Ÿä¸€ä¸ªå¾®ä»»åŠ¡ï¼ŒmutationObserverä¹Ÿä¼šç”Ÿæˆä¸€ä¸ªå¾®ä»»åŠ¡ï¼Œå¹¶ä¸”å¾®ä»»åŠ¡é‡Œäº§ç”Ÿçš„å¾®ä»»åŠ¡ä¼šè¢«åŠ åˆ°å½“å‰ä¸ºä»»åŠ¡é˜Ÿåˆ—ç»§ç»­æ‰§è¡Œï¼Œæ‰€ä»¥å¾®ä»»åŠ¡é‡Œå¾ªç¯äº§ç”Ÿå¾®ä»»åŠ¡ä¼šå¯¼è‡´ä¸»çº¿ç¨‹ä¸€ç›´è€—åœ¨å½“å‰å®ä»»åŠ¡çš„å¾®ä»»åŠ¡é˜Ÿåˆ—ï¼Œä»è€Œå¡æ­»é¡µé¢æ¸²æŸ“","like_count":1},{"had_liked":false,"id":273744,"user_name":"Vfeelit","can_delete":false,"product_type":"c1","uid":1501818,"ip_address":"","ucode":"F3FF2B069F347F","user_header":"https://static001.geekbang.org/account/avatar/00/16/ea/7a/d857723d.jpg","comment_is_top":false,"comment_ctime":1610668582,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"5905635878","product_id":100023201,"comment_content":"ä¸å¤Ÿé€šä¿—æ˜“æ‡‚ æ–°æ‰‹è’™åœˆ async await åˆ°åº•åšäº†ä»€ä¹ˆé­”æ³• æ²¡è¯´æ˜ç™½","like_count":1},{"had_liked":false,"id":236355,"user_name":"William","can_delete":false,"product_type":"c1","uid":1047143,"ip_address":"","ucode":"C7CE9F8C840BD8","user_header":"https://static001.geekbang.org/account/avatar/00/0f/fa/67/1a8d096e.jpg","comment_is_top":false,"comment_ctime":1595397962,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"5890365258","product_id":100023201,"comment_content":"function sleep (duration) {<br>    return new Promise((resolve, reject) =&gt; {<br>        setTimeout(resolve, duration)<br>    })<br>}<br>async function green(){<br>    await sleep(3000)<br>    return &#39;green&#39;<br>}<br>async function yellow(){<br>    await sleep(1000)<br>    return &#39;yellow&#39;<br>}<br>async function red(){<br>    await sleep(2000)<br>    return &#39;red&#39;<br>}<br>async function start(){<br>    document.body.style.backgroundColor = await green()<br>    document.body.style.backgroundColor = await yellow()<br>    document.body.style.backgroundColor = await red()<br>    start()<br>}<br>start()","like_count":1},{"had_liked":false,"id":112539,"user_name":"Y","can_delete":false,"product_type":"c1","uid":1555967,"ip_address":"","ucode":"4AA6170E230C0C","user_header":"https://static001.geekbang.org/account/avatar/00/17/bd/ff/f4f2ae6a.jpg","comment_is_top":false,"comment_ctime":1562754519,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"5857721815","product_id":100023201,"comment_content":"function light(duration) {<br>    return new Promise((resolve) =&gt; {<br>        setTimeout(resolve,duration)<br>    })<br>}<br><br>async function show() {<br>    console.log(&quot;green&quot;);<br>    await light(3000);<br>    console.log(&quot;yellow&quot;);<br>    await light(1000);<br>    console.log(&quot;red&quot;);<br>    await light(2000);<br>    return true<br>}<br><br>async function cycle() {<br>    while(await show());<br>}<br><br>cycle()","like_count":1},{"had_liked":false,"id":104249,"user_name":"å¤å‘³","can_delete":false,"product_type":"c1","uid":1555103,"ip_address":"","ucode":"ADD7D1013D7D31","user_header":"https://static001.geekbang.org/account/avatar/00/17/ba/9f/01696794.jpg","comment_is_top":false,"comment_ctime":1560697581,"is_pvip":true,"discussion_count":0,"race_medal":0,"score":"5855664877","product_id":100023201,"comment_content":"function light(status, wait) {<br>    console.log(status);<br>    return new Promise(reslove =&gt; setTimeout(reslove, wait * 1000));<br>}<br><br>async function run () {<br>    while(true) {<br>        await light(&#39;green&#39;, 3)<br>        await light(&#39;yellow&#39;, 1)<br>        await light(&#39;red&#39;, 2);<br>    }<br>}<br><br>run()","like_count":1},{"had_liked":false,"id":94772,"user_name":"CaveShao","can_delete":false,"product_type":"c1","uid":1478271,"ip_address":"","ucode":"E45740787F82AB","user_header":"https://static001.geekbang.org/account/avatar/00/16/8e/7f/4ff4472f.jpg","comment_is_top":false,"comment_ctime":1557892776,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"5852860072","product_id":100023201,"comment_content":"let light = document.querySelector(&#39;.light&#39;);<br><br>    function red() {<br>        return new Promise(function(resolve, reject) {<br>            light.style.backgroundColor = &#39;red&#39;;<br>            setTimeout(function() {<br>            \tresolve(green())<br>            }, 2000);<br>        })<br>    }<br><br>    function green() {<br>        return new Promise(function(resolve, reject) {<br>            light.style.backgroundColor = &#39;green&#39;;<br>            setTimeout(function() {<br>            \tresolve(yellow())<br>            }, 3000);<br>        })<br>    }<br><br>    function yellow() {<br>        return new Promise(function(resolve, reject) {<br>            light.style.backgroundColor = &#39;yellow&#39;;<br>            setTimeout(function() {<br>            \tresolve(red())<br>            }, 1000);<br>        })<br>    }<br>    <br>    red();","like_count":1},{"had_liked":false,"id":85086,"user_name":"ç‹ç„","can_delete":false,"product_type":"c1","uid":1394410,"ip_address":"","ucode":"E54ABB340D1E49","user_header":"https://static001.geekbang.org/account/avatar/00/15/46/ea/b86667b8.jpg","comment_is_top":false,"comment_ctime":1554975610,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"5849942906","product_id":100023201,"comment_content":"        function changeColor() {<br>            console.time();<br>            const timer1 = setTimeout(function () {<br>                clearTimeout(timer1);<br>                console.timeEnd();<br>                console.log(&#39;green&#39;);<br><br>                console.time();<br>                const timer2 = setTimeout(function () {<br>                    clearTimeout(timer2);<br>                    console.timeEnd();<br>                    console.log(&#39;yellow&#39;);<br>                    console.time();<br>                    const timer3 = setTimeout(function () {<br>                        clearTimeout(timer3);<br>                        console.timeEnd();<br>                        console.log(&#39;red&#39;);<br>                        console.time();<br>                        const timer4 = setTimeout(function () {<br>                            clearTimeout(timer4);<br>                            console.timeEnd();<br>                        }, 1000);<br>                    }, 2000);<br>                }, 3000);<br>            }, 0);<br>        }","like_count":1},{"had_liked":false,"id":76614,"user_name":"sheeeeep","can_delete":false,"product_type":"c1","uid":1340246,"ip_address":"","ucode":"218AA77BAA73C8","user_header":"https://static001.geekbang.org/account/avatar/00/14/73/56/9cfb1e43.jpg","comment_is_top":false,"comment_ctime":1552643416,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"5847610712","product_id":100023201,"comment_content":"var element = document.getElementsByClassName(&#39;lighter&#39;)[0]<br><br>function sleep(duration) {<br>    return new Promise((resolve, reject) =&gt; {<br>        var begin = Date.now();<br>        setTimeout(() =&gt; resolve(), duration);<br>    })<br>}<br><br>function changeColor(color) {<br>    element.style.backgroundColor = color;<br>}<br><br>async function change() {<br>    changeColor(&#39;green&#39;);<br>    await sleep(3000);<br>    changeColor(&#39;yellow&#39;);<br>    await sleep(1000);<br>    changeColor(&#39;red&#39;)<br>    await sleep(2000);<br>    return new Promise((resolve, reject) =&gt; {<br>        resolve();<br>    })<br>}<br><br>async function main() {<br>    while (true) {<br>        await change();<br>    }<br>}<br><br>main()<br><br><br><br>","like_count":1},{"had_liked":false,"id":70273,"user_name":"clannad-","can_delete":false,"product_type":"c1","uid":1384428,"ip_address":"","ucode":"917AF04B71FF35","user_header":"https://static001.geekbang.org/account/avatar/00/15/1f/ec/dede5cb2.jpg","comment_is_top":false,"comment_ctime":1551062220,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"5846029516","product_id":100023201,"comment_content":"  const box = document.querySelector(&#39;.box&#39;);<br>  const oSpan = box.getElementsByTagName(&#39;span&#39;)[0];<br>  const arr = [&#39;green&#39;,&#39;yellow&#39;,&#39;red&#39;];<br>  oSpan.style.backgroundColor = arr[0];<br><br>  function changeColor (num,time){<br>    oSpan.style.backgroundColor = arr[num];<br>    return new Promise((resolve,reject) =&gt; {<br>      setTimeout(resolve,time )<br>    })<br>  }<br>  async function eventFn(){<br>      await changeColor(0,3*1000)<br>      await changeColor(1,1*1000)<br>      await changeColor(2,2*1000)<br>      eventFn()<br>  }<br>  eventFn()","like_count":1},{"had_liked":false,"id":70147,"user_name":"è¾¾è¾¾","can_delete":false,"product_type":"c1","uid":1103097,"ip_address":"","ucode":"19A236D444817B","user_header":"https://static001.geekbang.org/account/avatar/00/10/d4/f9/48da7701.jpg","comment_is_top":false,"comment_ctime":1551012828,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"5845980124","product_id":100023201,"comment_content":"ç»ˆäºçŸ¥é“ä¸ºä»€ä¹ˆè¦æœ‰å®ä»»åŠ¡å’Œå¾®ä»»åŠ¡å¾—åŒºåˆ†äº†","like_count":1},{"had_liked":false,"id":355569,"user_name":"äºº","can_delete":false,"product_type":"c1","uid":1471805,"ip_address":"æ±Ÿè‹","ucode":"A46558DA3A6CD9","user_header":"https://static001.geekbang.org/account/avatar/00/16/75/3d/15e0cb84.jpg","comment_is_top":false,"comment_ctime":1661501634,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1661501634","product_id":100023201,"comment_content":"äº‹ä»¶å¾ªç¯è¯´çš„æœ‰äº›æ¨¡ç³Šã€‚  è¯´ä¸‹æˆ‘çš„ç†è§£ã€‚ å®¿ä¸»ç¯å¢ƒä¹Ÿå°±æ˜¯æµè§ˆå™¨åœ¨è§£æåˆ°scriptæ ‡ç­¾æ—¶ï¼Œå‘ç°æ˜¯ä¸€ä¸ªè„šæœ¬ï¼Œå°±è°ƒç”¨javascriptå¼•æ“ï¼Œå»è§£ææ‰§è¡Œè„šæœ¬ã€‚æ­¤æ—¶å°±å¼€å¯äº†ä¸€ä¸ªå®ä»»åŠ¡ã€‚ æ‰§è¡Œè„šæœ¬è¿‡ç¨‹ä¸­ï¼Œç¢°åˆ°äº†setTimeout, å°±ä¼šå‘å®ä»»åŠ¡é˜Ÿåˆ—æ·»åŠ ä¸€ä¸ªä»»åŠ¡ã€‚ å¦‚æœç¢°åˆ°promiseï¼Œå°±ä¼šå‘å¾®ä»»åŠ¡é˜Ÿåˆ—æ·»åŠ ä¸€ä¸ªä»»åŠ¡ã€‚<br><br>å½“å‰scirptè„šæœ¬è§£æå®Œæ¯•åï¼Œä¼šå»æŸ¥çœ‹å¾®ä»»åŠ¡é˜Ÿåˆ—ï¼Œå¦‚æœæœ‰ä»»åŠ¡ï¼Œå°±å»æ‰§è¡Œã€‚ æ‰§è¡Œå®Œå¾®ä»»åŠ¡ï¼Œ jså¼•æ“æŠŠæ§åˆ¶æƒäº¤è¿˜ç»™æµè§ˆå™¨å»æ¸²æŸ“ï¼Œæ¸²æŸ“å®Œæ¯•åï¼ŒæŸ¥çœ‹å®ä»»åŠ¡é˜Ÿåˆ—ï¼Œä¾æ¬¡å¾ªç¯ï¼Œç›´è‡³å®Œæˆæ‰€æœ‰ä»»åŠ¡ã€‚","like_count":0},{"had_liked":false,"id":355163,"user_name":"Geek_d8c13d","can_delete":false,"product_type":"c1","uid":2788818,"ip_address":"åŒ—äº¬","ucode":"92F4D269AFE597","user_header":"","comment_is_top":false,"comment_ctime":1661149114,"is_pvip":false,"discussion_count":2,"race_medal":0,"score":"1661149114","product_id":100023201,"comment_content":"function sleep(duration) {<br>      return new Promise(function (resolve, reject) {<br>        console.log(&quot;b&quot;);<br>        setTimeout(() =&gt; {<br>          resolve()<br>          console.log(11111);<br>        }, duration);<br>      })<br>    }<br>    console.log(&quot;a&quot;);<br>    sleep(5000)<br>      .then(() =&gt; console.log(&quot;c&quot;))<br>è¿™ä¸ªä¸ºä»€ä¹ˆä¼šå…ˆlog1111ï¼Œå†logcå‘¢","like_count":0,"discussions":[{"author":{"id":3166573,"avatar":"https://static001.geekbang.org/account/avatar/00/30/51/6d/e4aed428.jpg","nickname":"%","note":"","ucode":"C5FC6B541307AE","race_medal":1,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":588244,"discussion_content":"resolveå°±æ˜¯() =&gt; console.log(&#34;c&#34;)","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1663606264,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":"ä¸Šæµ·"},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":3166573,"avatar":"https://static001.geekbang.org/account/avatar/00/30/51/6d/e4aed428.jpg","nickname":"%","note":"","ucode":"C5FC6B541307AE","race_medal":1,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":588243,"discussion_content":"å› ä¸ºsetTimeOutæ•´ä¸ªå›è°ƒæ˜¯ä¸€ä¸ªå®ä»»åŠ¡ï¼Œresolveæ˜¯é‡Œé¢çš„å¾®ä»»åŠ¡ï¼Œæ‰€ä»¥å…ˆæ‰§è¡Œäº†1111","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1663606238,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":"ä¸Šæµ·"},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":347138,"user_name":"Ha0ran","can_delete":false,"product_type":"c1","uid":2813740,"ip_address":"","ucode":"A36AD84DAC48B2","user_header":"https://static001.geekbang.org/account/avatar/00/2a/ef/2c/9f96ded7.jpg","comment_is_top":false,"comment_ctime":1653739300,"is_pvip":false,"discussion_count":1,"race_medal":0,"score":"1653739300","product_id":100023201,"comment_content":"å¼€å¤´çš„æœ‰ç‚¹éš¾ç†è§£ã€‚æŠŠå®è§‚ä»»åŠ¡å’Œ JS å¼•æ“åˆ†å¼€äº†ï¼Œå¯¹æˆ‘æ¥è¯´ï¼Œå®¹æ˜“ç†è§£æˆ JS å¼•æ“çš„éƒ½æ˜¯å¾®ä»»åŠ¡ï¼Œè€Œå®ä»»åŠ¡åœ¨ JS å¼•æ“ä¹‹å¤–ã€‚å¸Œæœ›æœ‰äººèƒ½ç»™ç‚¹å»ºè®®å¸®åŠ©æˆ‘ç†è§£ä¸€ä¸‹","like_count":0,"discussions":[{"author":{"id":2790781,"avatar":"https://static001.geekbang.org/account/avatar/00/2a/95/7d/2aaae850.jpg","nickname":"Janus","note":"","ucode":"1D8AEB85D92B86","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":574004,"discussion_content":"å»ºè®®çœ‹éš”å£æå…µè€å¸ˆçš„è®²è§£ï¼Œæ›´å¥½æ‡‚ã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1653793553,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":346571,"user_name":"Geek_6cd24e","can_delete":false,"product_type":"c1","uid":1747383,"ip_address":"","ucode":"7DD1B435EF2860","user_header":"https://static001.geekbang.org/account/avatar/00/1a/a9/b7/b1ae1deb.jpg","comment_is_top":false,"comment_ctime":1653234156,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1653234156","product_id":100023201,"comment_content":"    const el = document.querySelector(&quot;.trafficLight&quot;);<br><br>    function light(color, duration) {<br>      return new Promise(function (resolve, reject) {<br>        el.style.backgroundColor = color;<br>        setTimeout(() =&gt; {<br>          resolve();<br>        }, duration);<br>      });<br>    }<br><br>    async function compeleteLight() {<br>      await light(&quot;green&quot;, 3000);<br>      await light(&quot;yellow&quot;, 1000);<br>      await light(&quot;red&quot;, 2000);<br><br>      compeleteLight();<br>    }<br><br>    compeleteLight();","like_count":0},{"had_liked":false,"id":343802,"user_name":"docker","can_delete":false,"product_type":"c1","uid":2762850,"ip_address":"","ucode":"9B9E246E092B1C","user_header":"https://static001.geekbang.org/account/avatar/00/2a/28/62/f1ba1593.jpg","comment_is_top":false,"comment_ctime":1651061411,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1651061411","product_id":100023201,"comment_content":"let a;<br>function sleep(duration) {<br>  return new Promise(function(resolve, reject) {<br>    a = 2;<br>    setTimeout(() =&gt; {<br>      console.log(&quot;UUU&quot;);<br>    }, duration);<br>    return resolve;<br>  })<br>}<br>async function foo(){<br>  console.log(&quot;a&quot;)<br>  sleep(4000).then(r =&gt; console.log(&quot;b&quot;))<br>  console.log(&quot;c&quot;)<br>}<br>foo().then(r =&gt; console.log(a));<br>console.log(&quot;e&quot;);<br><br>ä¸ºä»€ä¹ˆbæ²¡æœ‰æ‰“å°å‡ºæ¥å‘¢","like_count":0},{"had_liked":false,"id":343551,"user_name":"Chousen","can_delete":false,"product_type":"c1","uid":1647604,"ip_address":"","ucode":"F6E7B26F9A0544","user_header":"https://static001.geekbang.org/account/avatar/00/19/23/f4/95ae3dda.jpg","comment_is_top":false,"comment_ctime":1650901925,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1650901925","product_id":100023201,"comment_content":"mutation observer åˆ°åº•æ˜¯ä¸ªå®¿ä¸»APIè¿˜æ˜¯æµè§ˆå™¨å¼•æ“api","like_count":0},{"had_liked":false,"id":343207,"user_name":"*é£","can_delete":false,"product_type":"c1","uid":1177558,"ip_address":"","ucode":"C60C936C350A8D","user_header":"https://static001.geekbang.org/account/avatar/00/11/f7/d6/07bb5633.jpg","comment_is_top":false,"comment_ctime":1650707624,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1650707624","product_id":100023201,"comment_content":"<br>class Lignt {<br>    constructor(color, duration) {<br>      this.color = color;<br>      this.duration = duration;<br>    }<br>    lightOn() {<br>      document<br>      .getElementById(&quot;xxxx&quot;)<br>      .setAttribute(&quot;style&quot;, `background: ${this.color};height:100px;width:100px;`);<br>    }<br>  }<br>  <br>  class RedLignt extends Lignt {<br>    constructor(machine, duration) {<br>      super(&quot;red&quot;, duration);<br>      this.machine = machine;<br>    }<br>    async lightOn() {<br>      super.lightOn()<br>      await lightOnTime(this.duration);<br>      this.machine.setMachineState(this.machine.GreenState);<br>    }<br>  }<br>  <br>  class GreenLignt extends Lignt {<br>    constructor(machine, duration) {<br>      super(&quot;green&quot;, duration);<br>      this.machine = machine;<br>    }<br>    async lightOn() {<br>      super.lightOn()<br>      await lightOnTime(this.duration);<br>      this.machine.setMachineState(this.machine.YellowState);<br>    }<br>  }<br>  <br>  class YellowLignt extends Lignt {<br>    constructor(machine, duration) {<br>      super(&quot;yellow&quot;, duration);<br>      this.machine = machine;<br>    }<br>    async lightOn() {<br>      super.lightOn()<br>      await lightOnTime(this.duration);<br>      this.machine.setMachineState(this.machine.RedState);<br>    }<br>  }<br>  <br>  class Machine {<br>    constructor() {<br>      this.GreenState = new GreenLignt(this, 3000);<br>      this.YellowState = new YellowLignt(this, 1000);<br>      this.RedState = new RedLignt(this, 2000);<br>      this.state = this.GreenState;<br>    }<br>    setMachineState(state) {<br>      this.state = state;<br>      this.start();<br>    }<br>    start() {<br>      this.state.lightOn();<br>    }<br>  }<br>  new Machine().start();<br>  <br>  function lightOnTime(duration) {<br>    return new Promise((reslove, reject) =&gt; {<br>      setTimeout(reslove, duration);<br>    });<br>  }","like_count":0},{"had_liked":false,"id":342178,"user_name":"é˜¿è¶….","can_delete":false,"product_type":"c1","uid":1576230,"ip_address":"","ucode":"2B96DE690C98DB","user_header":"https://static001.geekbang.org/account/avatar/00/18/0d/26/73411dd3.jpg","comment_is_top":false,"comment_ctime":1650085360,"is_pvip":true,"discussion_count":0,"race_medal":0,"score":"1650085360","product_id":100023201,"comment_content":"<br>&#47;&#47;æœ€å°é¢—ç²’åŒ–,å•ä¸€èŒè´£;<br><br>&#47;&#47; åˆ‡æ¢é¢œè‰²<br>function changeColor(color) {<br>  console.log(&quot;åˆ‡æ¢é¢œè‰²ä¸º:&quot;, color);<br>}<br><br>&#47;&#47; æ§åˆ¶å™¨<br>function conFun(time) {<br>  switch (time) {<br>    case 0:<br>      changeColor(&#39;ç»¿&#39;);<br>      break;<br>    case 3:<br>      changeColor(&#39;é»„&#39;);<br>      break;<br>    case 5:<br>      changeColor(&#39;çº¢&#39;);<br>      break;<br>  }<br>}<br><br>&#47;&#47; ä¸»ç¨‹åº<br>function main() {<br>  let time = 0;<br>  conFun(time % 6);<br>  setInterval(() =&gt; {<br>    conFun(time++ % 6);<br>  }, 1000);<br>}<br><br>main();<br>","like_count":0},{"had_liked":false,"id":342177,"user_name":"é˜¿è¶….","can_delete":false,"product_type":"c1","uid":1576230,"ip_address":"","ucode":"2B96DE690C98DB","user_header":"https://static001.geekbang.org/account/avatar/00/18/0d/26/73411dd3.jpg","comment_is_top":false,"comment_ctime":1650084796,"is_pvip":true,"discussion_count":0,"race_medal":0,"score":"1650084796","product_id":100023201,"comment_content":"function changeColor(color) {<br>  console.log(&quot;åˆ‡æ¢é¢œè‰²ä¸º:&quot;, color);<br>}<br><br>function conFun(time) {<br>  switch (time) {<br>    case 0:<br>      changeColor(&#39;ç»¿&#39;)<br>      break<br>    case 3:<br>      changeColor(&#39;é»„&#39;)<br>      break<br>    case 5:<br>      changeColor(&#39;çº¢&#39;)<br>      break<br>  }<br>}<br><br>function start() {<br>  let time = 0;<br>  conFun(time % 6)<br>  setInterval(() =&gt; {<br>    time++<br>    conFun(time % 6)<br>  }, 1000);<br>}<br><br>start();<br>","like_count":0},{"had_liked":false,"id":339912,"user_name":"é”é”çˆ±å—çƒ","can_delete":false,"product_type":"c1","uid":1158621,"ip_address":"","ucode":"7AA4CA355B9D69","user_header":"https://static001.geekbang.org/account/avatar/00/11/ad/dd/970e7b4a.jpg","comment_is_top":false,"comment_ctime":1648460443,"is_pvip":true,"discussion_count":0,"race_medal":0,"score":"1648460443","product_id":100023201,"comment_content":"çœ‹å®Œè¿™ç¯‡ä¹‹åçœŸçš„é†é†çŒé¡¶ï¼Œä»¥å‰æä¸å¤ªæ˜ç™½çš„å®è§‚ï¼Œå¾®è§‚ä»»åŠ¡éƒ½ææ‡‚äº†ã€‚","like_count":0},{"had_liked":false,"id":337055,"user_name":"å‘¨èƒœ","can_delete":false,"product_type":"c1","uid":1974266,"ip_address":"","ucode":"BAE27CC6F67BB9","user_header":"https://thirdwx.qlogo.cn/mmopen/vi_32/DYAIOgq83erw3icVIkgTwYx5H9gwOSHdVibjxvzrmSe8G3Cg7kOicjibkHaDeibkntE4kdhibj4KHM0zCzM07YlbbteA/132","comment_is_top":false,"comment_ctime":1646573531,"is_pvip":true,"discussion_count":0,"race_medal":0,"score":"1646573531","product_id":100023201,"comment_content":"æˆ‘ä»¬æŠŠå®¿ä¸»å‘èµ·çš„ä»»åŠ¡ç§°ä¸ºå®è§‚ä»»åŠ¡ï¼ŒæŠŠJavaScriptå¼•æ“å‘èµ·çš„ä»»åŠ¡ç§°ä¸ºå¾®è§‚ä»»åŠ¡ã€‚åœ¨å®è§‚ä»»åŠ¡ä¸­ï¼ŒJavaScript çš„ Promise è¿˜ä¼šäº§ç”Ÿå¼‚æ­¥ä»£ç ï¼ŒJavaScript å¿…é¡»ä¿è¯è¿™äº›å¼‚æ­¥ä»£ç åœ¨ä¸€ä¸ªå®è§‚ä»»åŠ¡ä¸­å®Œæˆï¼Œå› æ­¤ï¼Œæ¯ä¸ªå®è§‚ä»»åŠ¡ä¸­åˆåŒ…å«äº†ä¸€ä¸ªå¾®è§‚ä»»åŠ¡é˜Ÿåˆ—ã€‚<br><br>æœ€åå®ç°çº¢ç»¿ç¯<br><br>function light(ele, color, duration) {<br>  return new Promise(resolve, reject) {<br>    ele.style.backgroundColor = color;<br>    setTimeout(resolve, duration);<br>  }<br>}<br><br>setInterval(() =&gt; {<br>  await light(ele, &#39;green&#39;, 3000);<br>  await light(ele, &#39;yellow&#39;, 1000);<br>  await light(ele, &#39;red&#39;, 2000);<br>}, 6000)","like_count":0},{"had_liked":false,"id":335194,"user_name":"é˜¿æ˜Ÿ","can_delete":false,"product_type":"c1","uid":1136547,"ip_address":"","ucode":"C5B7FA33365A28","user_header":"https://static001.geekbang.org/account/avatar/00/11/57/a3/09efc7cb.jpg","comment_is_top":false,"comment_ctime":1645401582,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1645401582","product_id":100023201,"comment_content":"æˆ‘ä¸€ç›´è®¤ä¸º async&#47;await çš„èƒŒåå°±æ˜¯ç”¨ generator+iterator æ¥å®ç°çš„, å¯¹å§?","like_count":0},{"had_liked":false,"id":333903,"user_name":"å°å°ä¸€åªå¸†","can_delete":false,"product_type":"c1","uid":2152578,"ip_address":"","ucode":"38402FEC9EE899","user_header":"https://static001.geekbang.org/account/avatar/00/20/d8/82/f05df6b6.jpg","comment_is_top":false,"comment_ctime":1644574781,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1644574781","product_id":100023201,"comment_content":"    function sleep(duration){<br>        return new Promise(function(resolve){<br>            setTimeout(resolve, duration);<br>        })<br>    }<br><br>    async function changeColor(color, time) {<br>      document.querySelector(&#39;.light&#39;).style.background = color<br>      await sleep(time)<br>    } <br><br>    async function main(startTime, cb) {<br>      await changeColor(&#39;green&#39;, startTime)<br>      await changeColor(&#39;yellow&#39;, 3000)<br>      await changeColor(&#39;red&#39;, 1000)<br>      return main(2000)<br>    }<br><br>    main(0)","like_count":0},{"had_liked":false,"id":331351,"user_name":"pasico","can_delete":false,"product_type":"c1","uid":2595067,"ip_address":"","ucode":"FAC45A23621F2D","user_header":"https://static001.geekbang.org/account/avatar/00/27/98/fb/aa63be6f.jpg","comment_is_top":false,"comment_ctime":1642559380,"is_pvip":true,"discussion_count":0,"race_medal":0,"score":"1642559380","product_id":100023201,"comment_content":"const config = [{<br>    color: &#39;green&#39;,<br>    duration: 3<br>},{<br>    color: &#39;yellow&#39;,<br>    duration: 1<br>},{<br>    color: &#39;red&#39;,<br>    duration: 2<br>}]<br>let index = -1<br>let duration = 0<br><br>setInterval(()=&gt;{<br>    if(duration === 0){<br>        index = (index+1)%config.length<br>        let c = config[index]<br>        console.log(c.color)<br>        duration = c.duration-1<br>    }else{<br>        duration--<br>        console.log(&#39;-&#39;)<br>    }<br>}, 1000)","like_count":0},{"had_liked":false,"id":330284,"user_name":"è·¯å","can_delete":false,"product_type":"c1","uid":2832929,"ip_address":"","ucode":"3ABC31EFF5EC4D","user_header":"","comment_is_top":false,"comment_ctime":1641893432,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1641893432","product_id":100023201,"comment_content":"<br>    function sleep(duration) {<br>        return new Promise(function(resolve, reject) {<br>            console.log(&quot;b&quot;);<br>            resolve(duration);<br>            &#47;&#47; setTimeout(resolve,duration);<br>        })<br>    }<br>    console.log(&quot;a&quot;);<br>    sleep(0).then(()=&gt;console.log(&quot;c&quot;));<br>    console.log(&quot;d&quot;)<br>Promiseå‡½æ•°é‡Œé¢æ²¡æœ‰å®è§‚ä»»åŠ¡äº†.ä¸ºä»€ä¹ˆcè¿˜æ˜¯ä¼šæ¯”dæ…¢?","like_count":0},{"had_liked":false,"id":330275,"user_name":"Geek_3cedc4","can_delete":false,"product_type":"c1","uid":2882197,"ip_address":"","ucode":"DAFC72DD926AD5","user_header":"","comment_is_top":false,"comment_ctime":1641889950,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1641889950","product_id":100023201,"comment_content":"&quot;åœ¨å®è§‚ä»»åŠ¡ä¸­ï¼ŒJavaScript çš„ Promise è¿˜ä¼šäº§ç”Ÿå¼‚æ­¥ä»£ç ï¼ŒJavaScript å¿…é¡»ä¿è¯è¿™äº›å¼‚æ­¥ä»£ç åœ¨ä¸€ä¸ªå®è§‚ä»»åŠ¡ä¸­å®Œæˆï¼Œå› æ­¤ï¼Œæ¯ä¸ªå®è§‚ä»»åŠ¡ä¸­åˆåŒ…å«äº†ä¸€ä¸ªå¾®è§‚ä»»åŠ¡é˜Ÿåˆ—&quot;<br>è¿™ä¸ªå¯ä»¥è§£é‡Šä¸‹ä¸ºå•¥JavaScript å¿…é¡»ä¿è¯è¿™äº›å¼‚æ­¥ä»£ç åœ¨ä¸€ä¸ªå®è§‚ä»»åŠ¡ä¸­å®Œæˆå—ï¼Ÿ","like_count":0},{"had_liked":false,"id":328561,"user_name":"æ³·æ²å¿ƒ","can_delete":false,"product_type":"c1","uid":1293186,"ip_address":"","ucode":"E811D9F1A17689","user_header":"https://static001.geekbang.org/account/avatar/00/13/bb/82/5a32de87.jpg","comment_is_top":false,"comment_ctime":1640772603,"is_pvip":false,"discussion_count":0,"race_medal":1,"score":"1640772603","product_id":100023201,"comment_content":"æˆ‘æ¥æä¸ªèŠ±é‡Œèƒ¡å“¨çš„ï¼Œæ§åˆ¶å°ç›´æ¥å¯ä»¥çœ‹æ•ˆæœï¼Œå“ˆå“ˆå“ˆå“ˆå“ˆå“ˆï¼š<br><br>function sleep(duration = 0) {<br>  return new Promise(function (resolve, reject) {<br>    setTimeout(resolve, duration)<br>  })<br>}<br>const fontStyle = &#39;font-size: 24px;font-weight: bold;&#39;<br>const color = {<br>  green: { name: &#39;ç»¿ç»¿ç»¿&#39;, time: 3000, style: `${fontStyle}color: green` },<br>  yellow: { name: &#39;é»„é»„é»„&#39;, time: 1000, style: `${fontStyle}color: yellow` },<br>  red: { name: &#39;çº¢çº¢çº¢&#39;, time: 2000, style: `${fontStyle}color: red` },<br>}<br>const logger = target =&gt; console.log(`%c${target.name}`, target.style)<br><br>const handleStart = async () =&gt; {<br>  while (true) {<br>    await sleep(color.green.time)<br>    logger(color.green)<br>    await sleep(color.yellow.time)<br>    logger(color.yellow)<br>    await sleep(color.red.time)<br>    logger(color.red)<br>  }<br>}<br><br>console.log(&#39;%cStart&#39;, fontStyle)<br>handleStart()","like_count":0},{"had_liked":false,"id":317686,"user_name":"é‚¬æ˜Œæ˜","can_delete":false,"product_type":"c1","uid":2393393,"ip_address":"","ucode":"30838A94D4D244","user_header":"","comment_is_top":false,"comment_ctime":1634889976,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1634889976","product_id":100023201,"comment_content":"function sleep(duration) { return new Promise(function(resolve, reject) { setTimeout(resolve,duration); }) }<br>let arr = [{color:&#39;green&#39;,time:3000},{color:&#39;yellow&#39;,time:1000},{color:&#39;red&#39;,time:2000}]<br>let div = document.getElementById(&#39;light&#39;)<br>let i = 0;<br>async function main() {<br>    await changeColor(div,arr[i])<br>    if(++i &gt;= arr.length) i = 0;<br>    main()<br>}<br>main()<br><br>async function changeColor(node,item) {<br>    node.style.backgroundColor = item.color;<br>    await sleep(item.time)<br>}","like_count":0},{"had_liked":false,"id":315331,"user_name":"forguo","can_delete":false,"product_type":"c1","uid":1386513,"ip_address":"","ucode":"AF7C6D8B352C81","user_header":"https://static001.geekbang.org/account/avatar/00/15/28/11/aa878061.jpg","comment_is_top":false,"comment_ctime":1633838980,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1633838980","product_id":100023201,"comment_content":"mounted() {<br>        &#47;&#47; ç»¿è‰² 3 ç§’ï¼Œé»„è‰² 1 ç§’ï¼Œçº¢è‰² 2 ç§’å¾ªç¯æ”¹å˜èƒŒæ™¯è‰²<br>        this.trafficSwitch();<br>    },<br>    methods: {<br>        async switchColor (color, delay) {<br>            this.color = color<br>            await this.switchCount(delay);<br>        },<br>        switchCount (delay) {<br>            return new Promise((resolve) =&gt; {<br>                setTimeout(() =&gt; {<br>                    resolve();<br>                }, delay);<br>            })<br>        },<br>        async switchGreen () {<br>            await this.switchColor(&#39;green&#39;, 3000);<br>            await this.switchYellow();<br>        },<br>        async switchYellow () {<br>            await this.switchColor(&#39;yellow&#39;, 1000);<br>            await this.switchRed();<br>        },<br>        async switchRed () {<br>            await this.switchColor(&#39;red&#39;, 2000);<br>            await this.switchGreen();<br>        },<br>        async trafficSwitch () {<br>            &#47;&#47; ç»¿è‰² 3 ç§’ï¼Œé»„è‰² 1 ç§’ï¼Œçº¢è‰² 2 ç§’å¾ªç¯æ”¹å˜èƒŒæ™¯è‰²<br>            await this.switchGreen();<br>        }<br>    }","like_count":0},{"had_liked":false,"id":298999,"user_name":"zgy","can_delete":false,"product_type":"c1","uid":1387798,"ip_address":"","ucode":"05EA6845199250","user_header":"https://static001.geekbang.org/account/avatar/00/15/2d/16/b525a71d.jpg","comment_is_top":false,"comment_ctime":1624420849,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1624420849","product_id":100023201,"comment_content":"  function fn (n, color) {<br>    return new Promise(receive =&gt; {<br>      document.querySelector(&#39;.box&#39;).style.background = color<br>      setTimeout(() =&gt; {<br>        receive()<br>      }, n)<br>    })<br>  }<br>  async function aFn () {<br>    await fn (3000, &#39;green&#39;)<br>    await fn (1000, &#39;yellow&#39;)<br>    await fn (2000, &#39;red&#39;)<br>    aFn ()<br>  }<br>  aFn ()","like_count":0},{"had_liked":false,"id":289385,"user_name":"Geek","can_delete":false,"product_type":"c1","uid":2575914,"ip_address":"","ucode":"CD2C5AB66EA7C4","user_header":"https://static001.geekbang.org/account/avatar/00/27/4e/2a/41db4a2c.jpg","comment_is_top":false,"comment_ctime":1618993674,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1618993674","product_id":100023201,"comment_content":"    async change(){<br>        const d = document.querySelector(&quot;.light&quot;);<br>        while(true) {<br>            d.style.background = &#39;green&#39;;<br>            await this.turnColor(3000);<br>            d.style.background = &#39;yellow&#39;;<br>            await this.turnColor(1000);<br>            d.style.background = &#39;red&#39;;<br>            await this.turnColor(2000);<br><br>        }<br>    }<br><br>    turnColor(duration){<br>        return new Promise(function(resolve, reject){<br>            setTimeout(resolve, duration);<br>        })<br>    }","like_count":0},{"had_liked":false,"id":289342,"user_name":"ZWS","can_delete":false,"product_type":"c1","uid":1033683,"ip_address":"","ucode":"89C9D92070F716","user_header":"https://static001.geekbang.org/account/avatar/00/0f/c5/d3/d4b3e22c.jpg","comment_is_top":false,"comment_ctime":1618984874,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1618984874","product_id":100023201,"comment_content":"function sleep(duration, callback){<br>  const now = Date.now();<br>  while (Date.now() - now &lt; duration);<br>  return new Promise((resolve) =&gt; {<br>    callback();<br>    resolve();<br>  })<br>}<br><br>function turnColor(color){<br>  return function(){<br>    console.log(color);<br>  }<br>}<br><br>function traffic(){<br>  sleep(3000, turnColor(&#39;green&#39;));<br>  sleep(1000, turnColor(&#39;yellow&#39;));<br>  sleep(2000, turnColor(&#39;red&#39;));<br>  traffic();<br>}<br><br>traffic();","like_count":0},{"had_liked":false,"id":288718,"user_name":"åˆ«çœ‹äº†ä½ å¸…ä¸è¿‡æˆ‘","can_delete":false,"product_type":"c1","uid":2561212,"ip_address":"","ucode":"93E628027649FA","user_header":"https://static001.geekbang.org/account/avatar/00/27/14/bc/26fa6643.jpg","comment_is_top":false,"comment_ctime":1618640155,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1618640155","product_id":100023201,"comment_content":"async function foo2(){<br>    await foo(&quot;a&quot;);<br>    await foo(&quot;b&quot;);<br>}<br>æ‰§è¡Œfoo2()ï¼Œä¸ºä»€ä¹ˆåªæ‰“å°äº†ä¸€ä¸ªpromiseï¼Ÿä¸æ˜¯ä¸¤æ¬¡await fooå—ï¼Ÿ","like_count":0},{"had_liked":false,"id":282871,"user_name":"ç‹éœ¸å¤©","can_delete":false,"product_type":"c1","uid":1917769,"ip_address":"","ucode":"5DF357985CA483","user_header":"","comment_is_top":false,"comment_ctime":1615449016,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1615449016","product_id":100023201,"comment_content":"const sleep = (duration) =&gt; {<br>        return new Promise((resolve, reject) =&gt; {<br>            setTimeout(resolve, duration);<br>        });<br>    }<br>    const change = async() =&gt; {<br>        console.log(&#39;ç»¿&#39;);<br>        await sleep(3000);<br>        console.log(&#39;é»„&#39;);<br>        await sleep(1000);<br>        console.log(&#39;çº¢&#39;);<br>        await sleep(2000);<br>        this.change();<br>    }<br>change();","like_count":0},{"had_liked":false,"id":282132,"user_name":"Alan He","can_delete":false,"product_type":"c1","uid":2033513,"ip_address":"","ucode":"A0780F4619D388","user_header":"https://static001.geekbang.org/account/avatar/00/1f/07/69/43cf2251.jpg","comment_is_top":false,"comment_ctime":1615102875,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1615102875","product_id":100023201,"comment_content":" var lightEl = document.getElementsByClassName(&#39;light&#39;)[0];<br><br>      function sleep(second) {<br>        return new Promise(function (resolve, reject) {<br>          window.setTimeout(function () {<br>            resolve();<br>          }, second * 1000);<br>        });<br>      }<br><br>      async function trafficLight() {<br>        lightEl.style.backgroundColor = &#39;green&#39;;<br>        await sleep(3);<br>        lightEl.style.backgroundColor = &#39;yellow&#39;;<br>        await sleep(1);<br>        lightEl.style.backgroundColor = &#39;red&#39;;<br>        await sleep(2);<br>      }<br><br>      async function main() {<br>        while (true) {<br>          await trafficLight();<br>        }<br>      }<br>      main();","like_count":0},{"had_liked":false,"id":275483,"user_name":"zgy","can_delete":false,"product_type":"c1","uid":1387798,"ip_address":"","ucode":"05EA6845199250","user_header":"https://static001.geekbang.org/account/avatar/00/15/2d/16/b525a71d.jpg","comment_is_top":false,"comment_ctime":1611560181,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1611560181","product_id":100023201,"comment_content":"    async function fn () {<br>      try {<br>        await f(3000, &#39;green&#39;)<br>        await f (1000, &#39;yellow&#39;)<br>        await f(2000, &#39;red&#39;)<br>        fn ()<br>      } catch {<br>        throw (new Error(&#39;é”™è¯¯&#39;))<br>      }<br>    }<br>    function f (time, color) {<br>      return new Promise((resolve) =&gt; {<br>        document.querySelector(&#39;.box&#39;).style.background = color<br>        setTimeout(resolve, time)<br>      })<br>    }<br>    fn ()","like_count":0},{"had_liked":false,"id":273020,"user_name":"ä¸å¸¦å¸ƒå…œ","can_delete":false,"product_type":"c1","uid":1400998,"ip_address":"","ucode":"3BC07B89A3B058","user_header":"https://static001.geekbang.org/account/avatar/00/15/60/a6/341c3e31.jpg","comment_is_top":false,"comment_ctime":1610414961,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1610414961","product_id":100023201,"comment_content":"var toGreen=async function(){<br>      document.querySelector(&#39;.light&#39;).style.background=&#39;green&#39;<br>      await setTimeout(toYellow,3000)<br>    } <br>    var toYellow=async function(){<br>      document.querySelector(&#39;.light&#39;).style.background=&#39;yellow&#39;<br>      await setTimeout(toRed,1000)<br>    }<br>    var toRed=async function(){<br>      document.querySelector(&#39;.light&#39;).style.background=&#39;red&#39;<br>      await setTimeout(toGreen,2000)<br>    }<br>    function openLight(){<br>      toGreen()<br>    }<br><br>    openLight()","like_count":0},{"had_liked":false,"id":269302,"user_name":"Steve","can_delete":false,"product_type":"c1","uid":2145313,"ip_address":"","ucode":"C921D4E486ACF5","user_header":"","comment_is_top":false,"comment_ctime":1608606709,"is_pvip":true,"discussion_count":0,"race_medal":0,"score":"1608606709","product_id":100023201,"comment_content":"function green() {<br>\tdocument.getElementById(&quot;circle&quot;).style.backgroundColor = &#39;green&#39;;<br>}<br><br>function yellow() {<br>\tdocument.getElementById(&quot;circle&quot;).style.backgroundColor = &#39;yellow&#39;;<br>}<br><br>function red() {<br>\tdocument.getElementById(&quot;circle&quot;).style.backgroundColor = &#39;red&#39;;<br>}<br><br>function sleep(duration) {<br>\treturn new Promise((resolve) =&gt; {<br>  \tsetTimeout(resolve, duration);<br>  })<br>}<br><br>async function start() {<br>  green();<br>\tawait sleep(3000);<br>  yellow();<br>  await sleep(1000);<br>  red();<br>  await sleep(2000);<br>\tawait start();<br>}<br><br>start().then(() =&gt; {})","like_count":0},{"had_liked":false,"id":264255,"user_name":"å›è‡ªå…°èŠ³","can_delete":false,"product_type":"c1","uid":2029706,"ip_address":"","ucode":"780F3AFEEB9B73","user_header":"https://static001.geekbang.org/account/avatar/00/1e/f8/8a/f7e7fd54.jpg","comment_is_top":false,"comment_ctime":1606391843,"is_pvip":false,"discussion_count":1,"race_medal":0,"score":"1606391843","product_id":100023201,"comment_content":"&quot;Promise æ°¸è¿œåœ¨é˜Ÿåˆ—å°¾éƒ¨æ·»åŠ å¾®è§‚ä»»åŠ¡&quot;<br>æœ‰ä¸ªç–‘é—®ï¼Œè¿™é‡Œçš„é˜Ÿåˆ—å°¾éƒ¨æ˜¯æŒ‡ä»€ä¹ˆé˜Ÿåˆ—ï¼Ÿæ˜¯æ·»åŠ åˆ°å¾®ä»»åŠ¡é˜Ÿåˆ—çš„å°¾éƒ¨ï¼Œè¿˜æ˜¯æ•´ä¸ªå®ä»»åŠ¡é˜Ÿåˆ—çš„å°¾éƒ¨ï¼Ÿ","like_count":0,"discussions":[{"author":{"id":2033513,"avatar":"https://static001.geekbang.org/account/avatar/00/1f/07/69/43cf2251.jpg","nickname":"Alan He","note":"","ucode":"A0780F4619D388","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":353244,"discussion_content":"åº”è¯¥æ˜¯å¾®ä»»åŠ¡é˜Ÿåˆ—çš„å°¾éƒ¨","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1615091927,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":263926,"user_name":"Winter","can_delete":false,"product_type":"c1","uid":1492258,"ip_address":"","ucode":"A6F398C4303713","user_header":"https://static001.geekbang.org/account/avatar/00/16/c5/22/aca9a785.jpg","comment_is_top":false,"comment_ctime":1606295935,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1606295935","product_id":100023201,"comment_content":"å¦‚æœæ— é™å¾ªç¯çš„è¯å¯¹äºå†…å­˜è€—å°½çš„é—®é¢˜è¦æ€ä¹ˆè§£å†³å‘¢","like_count":0},{"had_liked":false,"id":262598,"user_name":"Geek_2b435a","can_delete":false,"product_type":"c1","uid":2328769,"ip_address":"","ucode":"70A1A0D25EF386","user_header":"","comment_is_top":false,"comment_ctime":1605776147,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1605776147","product_id":100023201,"comment_content":"å„ä½å¤§ä½¬å¯ä»¥çœ‹çœ‹è¿™æ®µå¤±è´¥çš„ä»£ç <br>(()=&gt; {<br>    let dom = document.getElementById(&#39;a&#39;);<br>    let backgroundColor = dom.style.backgroundColor;<br>    function changeColor(color) {<br>        let begin = Date.now();<br>        let afterColor = &#39;&#39;;<br>        switch(color) {<br>            case &#39;red&#39;:<br>                afterColor = &#39;green&#39;;<br>                while(Date.now() - begin &lt; 1000 * 2);<br>                dom.style.backgroundColor = afterColor;<br>                changeColor(afterColor);<br>                break;<br>            case &#39;green&#39;: <br>                afterColor = &#39;yellow&#39;;<br>                while(Date.now() - begin &lt; 1000 * 3);<br>                dom.style.backgroundColor = afterColor;<br>                changeColor(afterColor);<br>                break;<br>            case &#39;yellow&#39;:<br>                afterColor = &#39;red&#39;;<br>                while(Date.now() - begin &lt; 1000 * 1);<br>                dom.style.backgroundColor = afterColor;<br>                changeColor(afterColor);<br>                break;<br>            default: break;<br>        }<br>    }<br>    changeColor(backgroundColor);<br>})();<br>ç†è§£ä¸‹æ¸²æŸ“æœºåˆ¶","like_count":0},{"had_liked":false,"id":262142,"user_name":"ç”˜åº·è‰º","can_delete":false,"product_type":"c1","uid":1953633,"ip_address":"","ucode":"D06219B5C592CF","user_header":"https://static001.geekbang.org/account/avatar/00/1d/cf/61/f592700e.jpg","comment_is_top":false,"comment_ctime":1605622034,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1605622034","product_id":100023201,"comment_content":" function sleep(duration) {<br>            return new Promise(function (resolve) {<br>                setTimeout(resolve, duration);<br>            });<br><br>        }<br>        async function changeColor(color, duration) {<br><br>            await sleep(duration).then(() =&gt; document.getElementById(&quot;light&quot;).style.background = color);<br>            <br>        }<br><br>        async function cycleLightColor() {<br><br>            while (true) {<br>                await changeColor(&quot;#ffff00&quot;, 1000);<br>                await changeColor(&quot;#ff0000&quot;, 2000);<br>                await changeColor(&quot;#00ff00&quot;, 3000);<br>            }<br>        }<br>       cycleLightColor();","like_count":0},{"had_liked":false,"id":260978,"user_name":"é£æ§","can_delete":false,"product_type":"c1","uid":2068807,"ip_address":"","ucode":"85738351C986BE","user_header":"https://static001.geekbang.org/account/avatar/00/1f/91/47/996be32b.jpg","comment_is_top":false,"comment_ctime":1605165875,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1605165875","product_id":100023201,"comment_content":"function sleep(duration){<br>    return new Promise(function(resolve){<br>        setTimeout(resolve, duration);<br>    })<br>}<br>async function changeColor(duration,color){<br>    document.getElementById(&quot;traffic-light&quot;).style.background = color;<br>    await sleep(duration);<br><br>}<br>async function main(){<br>    while(true){<br>        await changeColor(3000,&quot;green&quot;);<br>        await changeColor(1000, &quot;yellow&quot;);<br>        await changeColor(2000, &quot;red&quot;);<br>    }<br>}<br>main()","like_count":0},{"had_liked":false,"id":257805,"user_name":"Neisun","can_delete":false,"product_type":"c1","uid":1925475,"ip_address":"","ucode":"FC6F52FA0729B0","user_header":"https://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTIhXibVTuCiaFaE03OHEj9jb4VxC41rDFnQRRjr4yheCdOppUDIciaGzZKmaciczVia4yKSUWxpM9dFf3w/132","comment_is_top":false,"comment_ctime":1604136451,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1604136451","product_id":100023201,"comment_content":"        function sleep(duration) {<br>            return new Promise((resolve,reject) =&gt; {<br>                setTimeout(resolve,duration)<br>            })<br>        }<br>        async function light() {<br>            console.log(&quot;ç»¿ç¯äº®&quot;)<br>            await sleep(3000)<br>            console.log(&quot;é»„ç¯äº®&quot;)<br>            await sleep(1000)<br>            console.log(&quot;çº¢ç¯äº®&quot;)<br>            await sleep(2000)<br>            light()<br>        }","like_count":0},{"had_liked":false,"id":255802,"user_name":"åŠæ©™æ±","can_delete":false,"product_type":"c1","uid":1477902,"ip_address":"","ucode":"BB93BB9CCB7FA2","user_header":"https://static001.geekbang.org/account/avatar/00/16/8d/0e/5e97bbef.jpg","comment_is_top":false,"comment_ctime":1603434092,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1603434092","product_id":100023201,"comment_content":"å®è§‚ä»»åŠ¡ï¼Œå¾®è§‚ä»»åŠ¡ï¼Œåˆæœ‰ä¸€å †åè¯æœ¯è¯­åˆ—è¡¨è¦è¡¥ä¹ äº†~ï¼ˆPSï¼šå¥½æ‹…å¿ƒä¿ºçš„å¤´å‘ï¼‰","like_count":0},{"had_liked":false,"id":255445,"user_name":"ç›´é¢æŒ‘æˆ˜","can_delete":false,"product_type":"c1","uid":2226314,"ip_address":"","ucode":"7C6541B9EE1B04","user_header":"https://static001.geekbang.org/account/avatar/00/21/f8/8a/18b7f008.jpg","comment_is_top":false,"comment_ctime":1603346452,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1603346452","product_id":100023201,"comment_content":"é—®ä¸‹è€å¸ˆï¼Œè¿™ä¸€è¯¾ç†è§£èµ·æ¥æœ‰ç‚¹åƒåŠ›ï¼Œæ˜¯ä¸æ˜¯éœ€è¦å…ˆæ‰¾ä¸€æœ¬jsçš„ä¹¦ç±å­¦ä¹ ä¸€ä¸‹ï¼Ÿæœ‰æ¨èçš„ä¹¦ç±å—ï¼ˆçœ‹å®Œä»¥åèƒ½å¤§æ¦‚çœ‹æ‡‚æœ¬è¯¾ç¨‹jséƒ¨åˆ†ä»£ç ï¼‰","like_count":0},{"had_liked":false,"id":255065,"user_name":"æ­£ç»å·¥ç¨‹å¸ˆ","can_delete":false,"product_type":"c1","uid":1350996,"ip_address":"","ucode":"680B53F09A9CF5","user_header":"https://static001.geekbang.org/account/avatar/00/14/9d/54/d43922b6.jpg","comment_is_top":false,"comment_ctime":1603261774,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1603261774","product_id":100023201,"comment_content":"async function show(execute,time){<br>    execute();<br>    return new Promise((resolve,reject)=&gt;{<br>        setTimeout(resolve,time)<br>    })<br>}<br><br>async function main(){<br>    while(true){<br>        await show(()=&gt;{console.log(&#39;green&#39;)},3000)<br>        await show(()=&gt;{console.log(&#39;yellow&#39;)},1000)<br>        await show(()=&gt;{console.log(&#39;red&#39;)},2000)<br>    }<br>}<br>main()","like_count":0},{"had_liked":false,"id":254036,"user_name":"Geek_luo","can_delete":false,"product_type":"c1","uid":2190670,"ip_address":"","ucode":"0A7207157BD00F","user_header":"https://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTIbSS9mUibLF6aicw1SNL1AEBt3U8jcKUIfealiaRc9oBtRRkIS8wAPPeducahUzWVo1AeFOYAJklFibw/132","comment_is_top":false,"comment_ctime":1603025270,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1603025270","product_id":100023201,"comment_content":"class TrafficLight {<br>            constructor(dom) {<br>                this.light = dom<br>            }<br>            wait(time) {<br>                return new Promise(resolve =&gt; {<br>                    setTimeout(() =&gt; {<br>                        resolve()<br>                    }, time)<br>                })<br>            }<br>            async changeColor(color, time) {<br>                this.light.style.backgroundColor = color<br>                await this.wait(time)<br>            }<br>            async roll() {<br>                while(true) {<br>                    await this.changeColor(&#39;green&#39;, 3000)<br>                    await this.changeColor(&#39;yellow&#39;, 1000)<br>                    await this.changeColor(&#39;red&#39;, 2000)<br>                }<br>            }<br>        }<br>        new TrafficLight(document.querySelector(&#39;.light&#39;)).roll()","like_count":0},{"had_liked":false,"id":252907,"user_name":"ywding","can_delete":false,"product_type":"c1","uid":2188098,"ip_address":"","ucode":"17FA8552026B54","user_header":"https://static001.geekbang.org/account/avatar/00/21/63/42/31e0cb29.jpg","comment_is_top":false,"comment_ctime":1602512769,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1602512769","product_id":100023201,"comment_content":"æ¥ä¸ªä¸ä¸€æ ·çš„å§ï¼Œå€’è®¡æ—¶ä¹Ÿé¡ºä¾¿å±•ç¤ºäº†ï¼›<br>let config = [{color: &quot;green&quot;, time: 6},<br>            {color: &quot;yellow&quot;, time: 3},<br>            {color: &quot;red&quot;, time: 9}];<br><br>        (function show({color, time }) {<br>            box.style.backgroundColor = color;<br>            box.innerHTML = time;<br>            let showInterval = setInterval(() =&gt; {<br>                box.innerHTML = --time<br>            }, 1000);<br>            setTimeout(() =&gt; {<br>                clearInterval(showInterval);<br>                config.push(config.shift());<br>                show(config[0])<br>            }, time * 1000);<br>        })(config[0])","like_count":0},{"had_liked":false,"id":252752,"user_name":"Geek_512c73","can_delete":false,"product_type":"c1","uid":2223895,"ip_address":"","ucode":"4A4CF0D2CE6B69","user_header":"https://thirdwx.qlogo.cn/mmopen/vi_32/Y3I7p9ry5Vo3CpSL5tETO7fyiaCC72CowPTWxeGrgzuvNhTN4yBJR05BGqUmyoYhzCYBPT9HFVz6pxPY3jAUMLw/132","comment_is_top":false,"comment_ctime":1602474527,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1602474527","product_id":100023201,"comment_content":"let timeout = function (delay){<br>        return new Promise(resolve =&gt; setTimeout(resolve,delay))<br>    }<br><br>    let change_bgColor = async function (el, color, duration){<br>        el.style.backgroundColor = color<br>        if(duration){<br>            await timeout(duration)<br>        }<br>    }<br><br>    let el = document.createElement(&quot;div&quot;)<br>    el.style.width = &quot;100px&quot;<br>    el.style.height = &quot;100px&quot;<br>    el.style.borderRadius = &quot;100px&quot;<br>    document.body.appendChild(el)<br><br>    let start = async function(){<br>        while (1){<br>            await change_bgColor(el, &quot;green&quot;, 3000)<br>            await change_bgColor(el, &quot;yellow&quot;, 1000)<br>            await change_bgColor(el, &quot;red&quot;, 2000)<br>        }<br>    }<br><br>    start()","like_count":0},{"had_liked":false,"id":252560,"user_name":"æ´ªæ˜ä¼Ÿ","can_delete":false,"product_type":"c1","uid":1925056,"ip_address":"","ucode":"CAD0D845C93CA3","user_header":"","comment_is_top":false,"comment_ctime":1602382364,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1602382364","product_id":100023201,"comment_content":"function sleep(c,duration) {<br>    return new Promise(function (resolve, reject) {<br>         console.log(&#39;color is &#39;+c+&#39; time is &#39;+duration)<br>        setTimeout(resolve,duration);<br>    })<br>}<br>async function foo() {<br>            while (true) {<br>                await sleep(&#39;green&#39;, 3000)<br>                await sleep(&#39;yellow&#39;, 1000)<br>                await sleep(&#39;red&#39;, 2000)<br>            }<br>        }<br>        foo()","like_count":0},{"had_liked":false,"id":251456,"user_name":"åœŸè±†é¸¡å—_o0","can_delete":false,"product_type":"c1","uid":1131629,"ip_address":"","ucode":"1003C0074B722E","user_header":"https://static001.geekbang.org/account/avatar/00/11/44/6d/10a6cc99.jpg","comment_is_top":false,"comment_ctime":1601575842,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1601575842","product_id":100023201,"comment_content":"æˆ‘æƒ³é—®ä¸ªé—®é¢˜ï¼Œä»»åŠ¡è¯¥æ€ä¹ˆå®šä¹‰ï¼Ÿ<br> ä¸‹è¾¹çš„ä»£ç é‡Œ r=ã€‚ã€‚ã€‚è¿™æ˜¯å®šä¹‰ï¼Œr.thenæ˜¯ä¸€ä¸ªå®è§‚ä»»åŠ¡ï¼Œä¸‹è¾¹çš„clog cï¼Œåº”è¯¥æ˜¯åº”è¯¥æ˜¯ä¸€ä¸ªå®è§‚ä»»åŠ¡å—ï¼Ÿ <br>   var r = new Promise(function(resolve, reject){<br>        console.log(&quot;a&quot;);<br>        resolve()<br>    });<br>    r.then(() =&gt; console.log(&quot;c&quot;));<br>    console.log(&quot;b&quot;)","like_count":0},{"had_liked":false,"id":251049,"user_name":"æ–‡è‰ºä¸èµ·æ¥çš„æˆ‘","can_delete":false,"product_type":"c1","uid":1015847,"ip_address":"","ucode":"11AE5CB9D0A700","user_header":"https://static001.geekbang.org/account/avatar/00/0f/80/27/abb7bfe3.jpg","comment_is_top":false,"comment_ctime":1601345057,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1601345057","product_id":100023201,"comment_content":"&lt;!DOCTYPE html&gt;<br>&lt;html lang=&quot;en&quot;&gt;<br>&lt;head&gt;<br>    &lt;meta charset=&quot;UTF-8&quot;&gt;<br>    &lt;meta name=&quot;viewport&quot; content=&quot;width=device-width, initial-scale=1.0&quot;&gt;<br>    &lt;title&gt;Document&lt;&#47;title&gt;<br>&lt;&#47;head&gt;<br>&lt;style&gt;<br>    #demo {<br>        width: 50px;<br>        height: 50px;<br>        border-radius: 25px;<br>    }<br>&lt;&#47;style&gt;<br>&lt;body&gt;<br>    &lt;div id=&quot;demo&quot;&gt;&lt;&#47;div&gt;<br>&lt;&#47;body&gt;<br>&lt;script&gt;<br><br>    let div = document.getElementById(&#39;demo&#39;)<br><br>    function sleep(wait) {<br>        return new Promise(function(resolve, reject) {<br>            setTimeout(resolve, wait)<br>        })<br>    }<br>    async function change() {<br>        while(1) {<br>            await sleep(3000)<br>            div.style.background = &#39;green&#39;<br>            await sleep(2000)<br>            div.style.background = &#39;red&#39;<br>            await sleep(1000)<br>            div.style.background = &#39;yellow&#39;<br>        }<br>        <br>    }<br><br>    change()<br><br>&lt;&#47;script&gt;<br>&lt;&#47;html&gt;","like_count":0},{"had_liked":false,"id":249872,"user_name":"filter","can_delete":false,"product_type":"c1","uid":1064585,"ip_address":"","ucode":"4559F7E9638E06","user_header":"https://static001.geekbang.org/account/avatar/00/10/3e/89/ce5c0938.jpg","comment_is_top":false,"comment_ctime":1600839199,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1600839199","product_id":100023201,"comment_content":"const colors = [&#39;yellow&#39;, &#39;red&#39;, &#39;green&#39;];<br>const circle = document.getElementById(&#39;circle&#39;)<br><br>const changeColor = (color) =&gt; {<br>  circle.style.backgroundColor = color<br>}<br><br><br>const delay = time =&gt; {<br>  return new Promise((resolve) =&gt; <br>    setTimeout(resolve, time)<br>  )<br>}<br><br>let index = 0;<br>const change = async () =&gt; {<br>  changeColor(colors[index])<br>  const r = await delay((index + 1) * 1000)<br>  index = (index === 2 ? 0 : index + 1);<br>  change()<br>}<br>change()<br>","like_count":0},{"had_liked":false,"id":247879,"user_name":"zly","can_delete":false,"product_type":"c1","uid":2175260,"ip_address":"","ucode":"BBBCA6CD16FFBF","user_header":"https://static001.geekbang.org/account/avatar/00/21/31/1c/51f4d08e.jpg","comment_is_top":false,"comment_ctime":1599900878,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1599900878","product_id":100023201,"comment_content":" function sleep(duration) {<br>     return new Promise((reslove) =&gt; {<br>         setTimeout(() =&gt; {<br>             reslove()<br>         }, duration)<br>     })<br> }<br><br> async function setLight(color, time) {<br>     console.log(`turnLight:${color}`)<br>     await sleep(time)<br> }<br><br> class Light{<br>    constructor(colorTimeList,initColor){<br>        this.colorTimeList=colorTimeList<br>        this.color=initColor<br>    }<br>    async LightInit(){<br>        let onColor=this.colorTimeList.find((item)=&gt;{<br>            return item.color==this.color<br>        })<br>        await setLight(this.color,onColor.time)<br>        this.color=onColor.next<br>        this.LightInit()<br>    }<br> }<br><br> let light=new Light([{color:&#39;green&#39;,time:3000,next:&#39;yellow&#39;},{color:&#39;yellow&#39;,time:1000,next:&#39;red&#39;},{color:&#39;red&#39;,time:2000,next:&#39;green&#39;}],&#39;green&#39;)<br> light.LightInit()","like_count":0},{"had_liked":false,"id":243022,"user_name":"Ys","can_delete":false,"product_type":"c1","uid":1587362,"ip_address":"","ucode":"087EA88667A90B","user_header":"https://static001.geekbang.org/account/avatar/00/18/38/a2/efe4d995.jpg","comment_is_top":false,"comment_ctime":1597921570,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1597921570","product_id":100023201,"comment_content":"JavaScriptå¼•æ“é€šå¸¸å¤„äºç©ºé—²çŠ¶æ€ï¼Œå½“macrotask queueä¸ä¸ºç©ºæ—¶ï¼Œä»é˜Ÿå¤´å¼€å§‹æ‰§è¡Œmacrotaskã€‚å½“ä¸€ä¸ªmacrotaskæ‰§è¡Œç»“æŸï¼Œä¼šæ‰§è¡Œmicrotask queueä¸­æ‰€æœ‰ä»»åŠ¡ã€‚å¦‚æœå®¿ä¸»ç¯å¢ƒæ˜¯æµè§ˆå™¨ï¼Œæ­¤æ—¶åœ¨å¼€å§‹æ‰§è¡Œä»¥ä¸‹ä¸€ä¸ªmacrotaskä¹‹å‰ï¼Œä¼šé‡æ–°æ¸²æŸ“é¡µé¢ã€‚","like_count":0},{"had_liked":false,"id":242506,"user_name":"ç¾ç¾","can_delete":false,"product_type":"c1","uid":1148422,"ip_address":"","ucode":"44CC95C45AF345","user_header":"https://static001.geekbang.org/account/avatar/00/11/86/06/72b01bb7.jpg","comment_is_top":false,"comment_ctime":1597744142,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1597744142","product_id":100023201,"comment_content":"ç½®é¡¶çœŸçš„è¦æŒ‘é”™è¿˜æ˜¯èƒ½æœ‰ä¸¤å¤„ï¼ˆè§æ³¨é‡Šï¼‰ã€‚ä¸è¿‡å·²ç»æå…¶å®Œç¾äº†ã€‚<br><br>async function sleep(duration){<br>        return new Promise((resolve)=&gt;{<br>            setTimeout(resolve, duration);<br>        })<br>    }<br>    &#47;&#47; é˜²æ­¢å¤šæ¬¡è·å–dom<br>    const trafficLight = document.querySelector(&#39;#traffic-light&#39;);<br>    function setColor(color){<br>        trafficLight.style.backgroundColor = color;<br>    }<br>    async function initTrafficLight(){<br>        &#47;&#47; sleepå’Œè®¾ç½®é¢œè‰²è§£è€¦<br>        while(true){<br>            setColor(&#39;green&#39;)<br>            await sleep(3000)<br>            setColor(&#39;yellow&#39;)<br>            await sleep(1000)<br>            setColor(&#39;red&#39;)<br>            await sleep(2000)<br>        }<br>    }<br>    initTrafficLight()","like_count":0},{"had_liked":false,"id":239731,"user_name":"ä¸æ›¾ç›¸è¯†","can_delete":false,"product_type":"c1","uid":1607957,"ip_address":"","ucode":"0BEDA6BDCA5F56","user_header":"https://static001.geekbang.org/account/avatar/00/18/89/15/381ce65f.jpg","comment_is_top":false,"comment_ctime":1596626954,"is_pvip":true,"discussion_count":0,"race_medal":0,"score":"1596626954","product_id":100023201,"comment_content":"&lt;body&gt;<br>    &lt;div class=&quot;l&quot;&gt;&lt;&#47;div&gt;<br>&lt;&#47;body&gt;<br>&lt;script&gt;<br>    &#47;&#47; é¢œè‰²å˜åŒ–è§„åˆ™<br>    var colorC = {<br><br>        redC() {<br>            return {<br>                color: &#39;red&#39;,<br>                during: 1,<br>            }<br>        },<br>        greenC() {<br>            return {<br>                color: &#39;green&#39;,<br>                during: 2,<br>            }<br>        },<br>        yellowC() {<br>            return {<br>                color: &#39;yellow&#39;,<br>                during: 3,<br>            }<br>        },<br>    }<br><br>    var l = document.querySelector(&#39;.l&#39;);<br>    console.dir(l,&#39;---l&#39;);<br>    <br>    var light = {<br>        color: &#39;red&#39;,<br>        changeColor({during, color},l) {<br>            return new Promise((resolve, reject) =&gt; {<br>                setTimeout(() =&gt; {<br>                    console.log(color,&#39;---color&#39;);<br>                    l.style.backgroundColor = color;<br>                    resolve()<br>                }, during * 1000);<br>            })<br>        },<br>    }<br>    <br>    var lightChange =async ()=&gt;{<br>        l.style.backgroundColor = light.color;<br>        await light.changeColor(colorC.greenC(),l);<br>        await light.changeColor(colorC.yellowC(),l);<br>        await light.changeColor(colorC.redC(),l)<br>    }<br>    lightChange();<br>    setInterval(() =&gt; {<br>        lightChange();<br>    }, (colorC.greenC().during+colorC.redC().during+colorC.yellowC().during)*1000);<br>é»˜é»˜å­¦ä¹ ...ç¬¬ä¸€æ¬¡å‘ï¼Œè§ç¬‘äº†ï¼Œwinå¤§","like_count":0},{"had_liked":false,"id":233797,"user_name":"Geek_b68746","can_delete":false,"product_type":"c1","uid":1812972,"ip_address":"","ucode":"A1A7B41F8ED26A","user_header":"http://thirdwx.qlogo.cn/mmopen/vi_32/tUyk7nlYNPFEPlI5KgtWazegUkicNIMkFMSl3OCb5Kic6KE1yQibJpojhc7JEIXC8WXlzYoRcIXhYxnUJKCsDLaQw/132","comment_is_top":false,"comment_ctime":1594455784,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1594455784","product_id":100023201,"comment_content":"&#47;&#47;æ¨¡æ‹Ÿdivå…ƒç´ colorå±æ€§<br>const div = {<br>    color: &quot;&quot;<br>};<br>&#47;&#47;è‡ªå®šä¹‰æ ·å¼<br>const colors = [<br>    {<br>        color: &quot;green&quot;,<br>        time: 3000<br>    },<br>    {<br>        color: &quot;yellow&quot;,<br>        time: 1000<br>    },<br>    {<br>        color: &quot;red&quot;,<br>        time: 2000<br>    }<br>];<br><br>&#47;&#47;jsé€»è¾‘éƒ¨åˆ†<br>function changeColor(colors) {<br>    &#47;&#47;å°è£…çº¢ç»¿ç¯ä»»åŠ¡åˆ—è¡¨<br>    const tasks = [];<br>    colors.map(color =&gt; {<br>        tasks.push(() =&gt; {<br>            return new Promise((resolve, reject) =&gt; {<br>                div.color = color.color;<br>                console.log(`div å¼€å¯ ${div.color} ç¯ ${Number(color.time &#47; 1000)} ç§’`);<br>                setTimeout(() =&gt; {<br>                    flag = false;<br>                    resolve();<br>                }, color.time);<br>            })<br>        })<br>    });<br><br>    &#47;&#47;å¼€å¯å¾ªç¯ä»»åŠ¡<br>    let index = 0;<br>    logic(tasks, index);<br><br>}<br><br>function logic(tasks, index) {<br>    const p1 = new Promise((resolve, reject) =&gt; {<br>        tasks[index]().then(() =&gt; {<br>            index++;<br>            if (index === colors.length) {<br>                index = 0;<br>            }<br>            resolve(index);<br>        });<br>    });<br>    p1.then(index =&gt; {<br>        logic(tasks, index);<br>    })<br>}<br><br>changeColor(colors);<br>&#47;&#47;è¾“å‡ºï¼š<br>div å¼€å¯ green ç¯ 3 ç§’<br>div å¼€å¯ yellow ç¯ 1 ç§’<br>div å¼€å¯ red ç¯ 2 ç§’<br>div å¼€å¯ green ç¯ 3 ç§’<br>div å¼€å¯ yellow ç¯ 1 ç§’<br>div å¼€å¯ red ç¯ 2 ç§’<br>","like_count":0},{"had_liked":false,"id":233010,"user_name":"Cander","can_delete":false,"product_type":"c1","uid":1381524,"ip_address":"","ucode":"838B8F877C7080","user_header":"https://static001.geekbang.org/account/avatar/00/15/14/94/7fcd4c89.jpg","comment_is_top":false,"comment_ctime":1594191720,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1594191720","product_id":100023201,"comment_content":"function show(color, duration) {<br>  return new Promise(r =&gt; {<br>    console.log(color);<br>    setTimeout(r, duration);<br>  })<br>}<br><br>async function loop() {<br>  await show(&#39;green&#39;, 3000)<br>  await show(&#39;yellow&#39;, 1000)<br>  await show(&#39;red&#39;, 2000)<br>  loop();<br>}<br><br>loop();<br>","like_count":0},{"had_liked":false,"id":232712,"user_name":"Kevin","can_delete":false,"product_type":"c1","uid":1923859,"ip_address":"","ucode":"89EA5FCF036C42","user_header":"https://static001.geekbang.org/account/avatar/00/1d/5b/13/6db9ba58.jpg","comment_is_top":false,"comment_ctime":1594096265,"is_pvip":true,"discussion_count":0,"race_medal":0,"score":"1594096265","product_id":100023201,"comment_content":"&lt;body&gt;<br>  &lt;div id=&quot;box&quot; style=&quot;position:fixed;top:0;left:45%;width:150px;height:150px; border-radius:50%;&quot;&gt;&lt;&#47;div&gt;<br>&lt;&#47;body&gt;<br>&lt;&#47;html&gt;<br>&lt;script&gt;<br>  <br><br>  function changeColor(color, second){<br>    return new Promise((reslove, reject) =&gt; {<br>      let _box = document.getElementById(&#39;box&#39;);<br>      _box.style.backgroundColor = color;<br>      setTimeout(reslove, second)<br>    })<br>  }<br><br>  async function changeColorLoop(){<br>    await changeColor(&#39;green&#39;, 3000);<br>    await changeColor(&#39;yellow&#39;, 1000);<br>    await changeColor(&#39;red&#39;, 2000);<br>    await changeColorLoop();<br>  }<br>    onload = async () =&gt;{<br>      await changeColorLoop()<br>    }<br><br>&lt;&#47;script&gt;","like_count":0},{"had_liked":false,"id":232708,"user_name":"æˆ‘äº”å²äº†å‘€","can_delete":false,"product_type":"c1","uid":1234802,"ip_address":"","ucode":"8B45200F1C65E0","user_header":"https://static001.geekbang.org/account/avatar/00/12/d7/72/deec1d6b.jpg","comment_is_top":false,"comment_ctime":1594093809,"is_pvip":true,"discussion_count":0,"race_medal":0,"score":"1594093809","product_id":100023201,"comment_content":"const action = (time, color) =&gt; {<br>  return new Promise((res) =&gt; {<br>    changeColor(color)<br>    setTimeout(res, time * 1000)<br>  })<br>}<br><br>const changeColor = (color) =&gt; {<br>  document.getElementById(&#39;box&#39;).style.background = color<br>}<br><br>const main = async () =&gt; {<br>  while(true) {<br>    await action(3, &#39;green&#39;)<br>    await action(1, &#39;yellow&#39;)<br>    await action(2, &#39;red&#39;)<br>  }<br>}<br><br>main()","like_count":0},{"had_liked":false,"id":227113,"user_name":"LittleWorker","can_delete":false,"product_type":"c1","uid":1796818,"ip_address":"","ucode":"FD8C99BA4E7FBE","user_header":"https://static001.geekbang.org/account/avatar/00/1b/6a/d2/87bca0e6.jpg","comment_is_top":false,"comment_ctime":1592290142,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1592290142","product_id":100023201,"comment_content":"let colorList = [<br>  { color: &#39;green&#39;, duration: 3000 },<br>  { color: &#39;yellow&#39;, duration: 1000 },<br>  { color: &#39;red&#39;, duration: 2000 }<br>]<br>function showLight(color, duration) {<br>  return new Promise(resolve =&gt; {<br>    console.log(new Date().toLocaleTimeString(), &#39; current color =&gt;&#39;, color)<br>    setTimeout(() =&gt; {<br>      resolve()<br>    }, duration)<br>  })<br>}<br><br>async function doLight() {<br>  let index = 0<br>  while (true) {<br>    const { color, duration } = colorList[index % 3]<br>    await showLight(color, duration)<br>    index++<br>  }<br>}<br>doLight()","like_count":0},{"had_liked":false,"id":222541,"user_name":"éƒ½å¸‚å¤œå½’äºº","can_delete":false,"product_type":"c1","uid":1071909,"ip_address":"","ucode":"DFF59BE3D80B42","user_header":"https://static001.geekbang.org/account/avatar/00/10/5b/25/d78cc1fe.jpg","comment_is_top":false,"comment_ctime":1590830732,"is_pvip":true,"discussion_count":0,"race_medal":0,"score":"1590830732","product_id":100023201,"comment_content":"åœ¨å®è§‚ä»»åŠ¡ä¸­ï¼ŒJavaScript çš„ Promise è¿˜ä¼šäº§ç”Ÿå¼‚æ­¥ä»£ç ã€‚Promise æ°¸è¿œåœ¨é˜Ÿåˆ—å°¾éƒ¨æ·»åŠ å¾®è§‚ä»»åŠ¡ã€‚setTimeout ç­‰å®¿ä¸» APIï¼Œåˆ™ä¼šæ·»åŠ å®è§‚ä»»åŠ¡ã€‚è¿™ä¸¤å¥æ„Ÿè§‰æœ‰ç‚¹çŸ›ç›¾ã€‚å¯èƒ½æ˜¯æˆ‘ç†è§£çš„ä¸åˆ°ä½ã€‚","like_count":0},{"had_liked":false,"id":222486,"user_name":"SuperFour","can_delete":false,"product_type":"c1","uid":1378323,"ip_address":"","ucode":"BBFEA454D107F1","user_header":"https://static001.geekbang.org/account/avatar/00/15/08/13/af055726.jpg","comment_is_top":false,"comment_ctime":1590819156,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1590819156","product_id":100023201,"comment_content":"const lightQuery = [{<br>    color:&#39;red&#39;,<br>    duration:2000,<br>},{<br>    color:&#39;yellow&#39;,<br>    duration:1000,<br>},{<br>    color:&#39;green&#39;,<br>    duration:3000,<br>}];<br>async function sleepTime(duration){<br>    return new Promise((resolve,reject) =&gt; {<br>        setTimeout(resolve,duration)<br>    })<br>    <br>}<br><br>async function main(){<br>    let $light = document.getElementById(&#39;light&#39;),value = null;<br>    let deltaTime = 20;<br>    let startTime = endTime = new Date().getTime()<br>    while(endTime - startTime &lt;= deltaTime * 1000){<br>        for(let i = 0; i &lt; lightQuery.length; i ++){<br>            value = lightQuery[i]<br>            console.log(value.color);<br>            $light.setAttribute(&#39;class&#39;,`light ${value.color}`)<br>            await sleepTime(value.duration)<br>        }<br>        endTime = new Date().getTime()<br>        console.log(&#39;endTime - startTime:&#39;,endTime - startTime);<br>    }<br>}<br><br>main()","like_count":0},{"had_liked":false,"id":221389,"user_name":"zgy","can_delete":false,"product_type":"c1","uid":1387798,"ip_address":"","ucode":"05EA6845199250","user_header":"https://static001.geekbang.org/account/avatar/00/15/2d/16/b525a71d.jpg","comment_is_top":false,"comment_ctime":1590488628,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1590488628","product_id":100023201,"comment_content":"setInterval(fn, 3000)<br>function delay(ms) { return new Promise(reslove) { setTimeout (reslove, ms)}};<br>async function fn() {<br>   this.color = &#39;red&#39;;<br>   await delay(1000);<br>   this.color = &#39;yellow&#39;;<br>   await delay(2000);<br>}<br>function main() {<br>while (true) {<br>  color = &#39;green&#39;;<br>  await delay(3000);<br>  color = &#39;yellow&#39;;<br>  await delay(1000);<br>  color = &#39;red&#39;;<br>  await delay(2000);<br>}<br>}","like_count":0},{"had_liked":false,"id":219158,"user_name":"æå²©","can_delete":false,"product_type":"c1","uid":1793763,"ip_address":"","ucode":"A7E1259C5B81AB","user_header":"https://static001.geekbang.org/account/avatar/00/1b/5e/e3/da3167ff.jpg","comment_is_top":false,"comment_ctime":1589957226,"is_pvip":false,"discussion_count":1,"race_medal":0,"score":"1589957226","product_id":100023201,"comment_content":"ä¸ºä»€ä¹ˆasync&#47;await é‡Œ åŠ ä¸Šwhile(true) å°±ä¸€ç›´å¾ªç¯æ‰§è¡Œå‘¢<br>","like_count":0,"discussions":[{"author":{"id":1469314,"avatar":"http://thirdwx.qlogo.cn/mmopen/vi_32/uFebicU5uiaOkAbJPdT8bwXc6YSvCz4KANoibpe8udF7tPGuhapxeMib21A9gG6npBEUvwbIBeH7dZwJmibVibvJVWzA/132","nickname":"fairy631","note":"","ucode":"96CF3E6137E971","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":289974,"discussion_content":"å› ä¸º true æ°¸è¿œä¸ºçœŸ,æ‰€ä»¥ä¼šä¸€ç›´å¾ªç¯","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1594287633,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":217541,"user_name":"æ´›å¥‡","can_delete":false,"product_type":"c1","uid":1624355,"ip_address":"","ucode":"662B4005721119","user_header":"https://static001.geekbang.org/account/avatar/00/18/c9/23/76511858.jpg","comment_is_top":false,"comment_ctime":1589530482,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1589530482","product_id":100023201,"comment_content":"let b = calc(20);<br>let c = calc(30);<br>let result=a+await b +await c;<br>å’Œ<br>let b = await calc(20);<br>let c = await calc(30);<br>let result = a + b + c;<br>å¦‚æœcalcå‡½æ•°å†…æ˜¯sleep 2ç§’ï¼Œä¸ºä»€ä¹ˆ å‰è€…æ˜¯æ€»å…±sleep 2ç§’ ï¼Œè€Œåè€…æ˜¯4ç§’ï¼Ÿ","like_count":0},{"had_liked":false,"id":216637,"user_name":"åœ°çƒå¤–åœ°äºº","can_delete":false,"product_type":"c1","uid":1966404,"ip_address":"","ucode":"28457E37C632ED","user_header":"https://static001.geekbang.org/account/avatar/00/1e/01/44/3a9b2b69.jpg","comment_is_top":false,"comment_ctime":1589299589,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1589299589","product_id":100023201,"comment_content":"è€å¸ˆèƒ½è®²è®²åœ¨ async await ä¸­çš„é—­åŒ…é—®é¢˜å—ï¼Ÿ","like_count":0},{"had_liked":false,"id":215505,"user_name":"daisyå°ä»™å¥³","can_delete":false,"product_type":"c1","uid":1504233,"ip_address":"","ucode":"07BC6A944505A1","user_header":"https://static001.geekbang.org/account/avatar/00/16/f3/e9/3296bf51.jpg","comment_is_top":false,"comment_ctime":1589005365,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1589005365","product_id":100023201,"comment_content":"function sleep(duration) {<br>    return new Promise(function(resolve, reject) {<br>        setTimeout(resolve,duration);<br>    })<br>}<br>async function showColor(color, time){<br>    await sleep(time)<br>    console.log(color)<br>}<br>async function foo2(){<br>    await showColor(&quot;green&quot;, 3000);<br>    await showColor(&quot;yellow&quot;, 2000);<br>    await showColor(&quot;red&quot;, 1000);<br>}","like_count":0},{"had_liked":false,"id":215205,"user_name":"EmilyLucky","can_delete":false,"product_type":"c1","uid":1972343,"ip_address":"","ucode":"DBA5FE296CF473","user_header":"https://static001.geekbang.org/account/avatar/00/1e/18/77/d665f258.jpg","comment_is_top":false,"comment_ctime":1588929070,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1588929070","product_id":100023201,"comment_content":"const trafficLight = document.getElementById(&quot;trafficLight&quot;);<br>function changeColor(elem,color,delay){<br>   return new Promise((resolve,reject) =&gt; {<br>       elem.style.backgroundColor = color;<br>       setTimeout(resolve,delay);<br>   });<br>}<br>async function startTwinkle(){<br>    while(true){<br>        await changeColor(trafficLight,&quot;green&quot;,3000);<br>        await changeColor(trafficLight,&quot;yellow&quot;,1000);<br>        await changeColor(trafficLight,&quot;red&quot;,2000);<br>    }<br>}<br>startTwinkle();","like_count":0},{"had_liked":false,"id":209450,"user_name":"ä»»ç¥–é›·","can_delete":false,"product_type":"c1","uid":1928073,"ip_address":"","ucode":"B741330D3EEF46","user_header":"http://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTJTPJHXTB9bmiaQEs56CmKYB5pn1uhk1wJibiatIdH2gia12XnxLjdtGoFWEWPgrC2DTUADgF9ic6TszEQ/132","comment_is_top":false,"comment_ctime":1587550966,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1587550966","product_id":100023201,"comment_content":"MutationObserverå±äºå¾®ä»»åŠ¡å—ï¼Ÿæ˜¯JavaScriptå¼•æ“å‘èµ·çš„å—ï¼Ÿ","like_count":0},{"had_liked":false,"id":208487,"user_name":"æ‰©æ•£æ€§ç™¾ä¸‡å’¸é¢åŒ…","can_delete":false,"product_type":"c1","uid":1905171,"ip_address":"","ucode":"6D703D51553B42","user_header":"https://static001.geekbang.org/account/avatar/00/1d/12/13/e103a6e3.jpg","comment_is_top":false,"comment_ctime":1587368711,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1587368711","product_id":100023201,"comment_content":"<br>    setTimeout(()=&gt;console.log(&quot;d&quot;), 0)<br>    var r = new Promise(function(resolve, reject){<br>        resolve()<br>    });<br>    r.then(() =&gt; { <br>        var begin = Date.now();<br>        while(Date.now() - begin &lt; 1000);<br>        console.log(&quot;c1&quot;) <br>        new Promise(function(resolve, reject){<br>            resolve()<br>        }).then(() =&gt; console.log(&quot;c2&quot;))<br>    });<br><br>å¯¹äºè¿™ä¸€æ®µä»£ç ä¹Ÿå¯ä»¥ç”¨åŒæ ·çš„ç†è®ºè§£é‡Šï¼Œé¦–å…ˆ.thenæ·»åŠ åˆ°å¾®é˜Ÿåˆ—åå¼€å§‹æ‰§è¡Œï¼Œè¿™ä¸ªè¿‡ç¨‹ä¸­ç»§ç»­æ·»åŠ ä»»åŠ¡åˆ°å¾®é˜Ÿåˆ—ã€‚è¦åœ¨è·³å›å»æ‰§è¡Œå®ä»»åŠ¡é˜Ÿåˆ—å‰æŠŠæ‰€æœ‰å¾®ä»»åŠ¡æ‰§è¡Œå®Œï¼Œåªå¥½ç»§ç»­æ‰“å°c2ã€‚<br><br>Source: https:&#47;&#47;jakearchibald.com&#47;2015&#47;tasks-microtasks-queues-and-schedules&#47;","like_count":0},{"had_liked":false,"id":208486,"user_name":"æ‰©æ•£æ€§ç™¾ä¸‡å’¸é¢åŒ…","can_delete":false,"product_type":"c1","uid":1905171,"ip_address":"","ucode":"6D703D51553B42","user_header":"https://static001.geekbang.org/account/avatar/00/1d/12/13/e103a6e3.jpg","comment_is_top":false,"comment_ctime":1587368478,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1587368478","product_id":100023201,"comment_content":"    function sleep(duration) {<br>        return new Promise(function(resolve, reject) {<br>            console.log(&quot;b&quot;);<br>            setTimeout(resolve,duration);<br>        })<br>    }<br>    console.log(&quot;a&quot;);<br>    sleep(5000).then(()=&gt;console.log(&quot;c&quot;));<br>æ­£ç¡®è¯´æ³•åº”è¯¥æ˜¯æ¯ä¸€ä¸ªå®ä»»åŠ¡æ‰§è¡Œå®Œäº†åéƒ½ä¼šå»æ‰§è¡Œæ‰€æœ‰åœ¨é˜Ÿåˆ—ä¸­çš„å¾®ä»»åŠ¡ã€‚<br>ç»“åˆçœ‹äº†å…¶ä»–å¸–å­åï¼Œæˆ‘å¯¹äºè¿™æ®µä»£ç çš„çœŸæ­£è§£é‡Šæ˜¯ï¼šé¦–å…ˆæ‰“å°a, bæ²¡æœ‰é—®é¢˜ï¼Œå…¶æ¬¡setTimeoutæŠŠä¸€ä¸ªä»»åŠ¡æ·»åŠ åˆ°å®ä»»åŠ¡é˜Ÿåˆ—ï¼Œç»§ç»­æ‰§è¡Œ.thenï¼ŒæŠŠå›è°ƒæ·»åŠ åˆ°å¾®ä»»åŠ¡é˜Ÿåˆ—ã€‚scriptå®ä»»åŠ¡ç°åœ¨æ‰§è¡Œå®Œæ¯•ï¼Œè¦å»æ£€æŸ¥å¾®ä»»åŠ¡é˜Ÿåˆ—ï¼Œä½†æ˜¯å‘ç°è¿˜æ²¡æœ‰resolveï¼Œä¸åº”è¯¥æ‰§è¡Œæ‰“å°cï¼Œäºæ˜¯å†è·³å›å®ä»»åŠ¡é˜Ÿåˆ—ï¼ˆè¿™æ—¶å€™æœ‰ä¸ªç–‘é—®ï¼Œåº”è¯¥æ˜¯é˜»å¡åœ¨é˜Ÿåˆ—ä¸­ç­‰å¾…ä»»åŠ¡å®Œæˆï¼Ÿè¿˜æ˜¯åå¤æ¨ªè·³ï¼ŸæŒ‰ç…§æˆ‘çš„å‡è®¾çš„è¯ï¼Œå¿…é¡»è¦è‡³å°‘å®Œæˆä¸€ä¸ªå®ä»»åŠ¡æ‰èƒ½è·³å¾®ä»»åŠ¡ï¼Œæ‰€ä»¥åº”è¯¥æ˜¯é˜»å¡äº†ï¼‰ã€‚ç­‰åˆ°setTimeoutæ‰§è¡Œå®Œåï¼Œå»æ‰§è¡Œå¾®ä»»åŠ¡log cæ‰æˆåŠŸã€‚","like_count":0},{"had_liked":false,"id":206479,"user_name":"åè„‘å‹º","can_delete":false,"product_type":"c1","uid":1946181,"ip_address":"","ucode":"50704EC5545C4C","user_header":"https://static001.geekbang.org/account/avatar/00/1d/b2/45/b49a92f5.jpg","comment_is_top":false,"comment_ctime":1586867077,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1586867077","product_id":100023201,"comment_content":"const trafficLight = document.querySelector(&#39;.traffic-lights&#39;)<br><br>start()<br><br>async function start() {<br>  while (true) {<br>    await generateLight(trafficLight, &#39;green&#39;, 3000)<br>    await generateLight(trafficLight, &#39;yellow&#39;, 1000)<br>    await generateLight(trafficLight, &#39;red&#39;, 2000)<br>  }<br>}<br><br>function generateLight(el, color, duration) {<br>  return new Promise(resolve =&gt; {<br>    el.style.backgroundColor = color<br>    setTimeout(resolve, duration)<br>  })<br>}<br>","like_count":0},{"had_liked":false,"id":204696,"user_name":"æ›™å…‰","can_delete":false,"product_type":"c1","uid":1476450,"ip_address":"","ucode":"04D65BF7F19845","user_header":"https://static001.geekbang.org/account/avatar/00/16/87/62/f99b5b05.jpg","comment_is_top":false,"comment_ctime":1586443134,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1586443134","product_id":100023201,"comment_content":"async å‡½æ•°å¿…å®šè¿”å› Promiseï¼Œæˆ‘ä»¬æŠŠæ‰€æœ‰è¿”å› Promise çš„å‡½æ•°éƒ½å¯ä»¥è®¤ä¸ºæ˜¯å¼‚æ­¥å‡½æ•°ã€‚<br>async function sleep1(duration) {<br>    setTimeout(function(){console.log(&quot;123&quot;);},duration);<br>}<br>async function foo2(){<br>    await foo(&quot;a&quot;);<br>    await foo(&quot;b&quot;);<br>    await sleep1(1000);<br>}<br>é‚£ä¹ˆ await sleep1(1000);æ˜¯è¿”å›Promiseè¿˜æ˜¯è¿”å›æ™®é€šå‡½æ•°ï¼Ÿ","like_count":0},{"had_liked":false,"id":202072,"user_name":"sry","can_delete":false,"product_type":"c1","uid":1379091,"ip_address":"","ucode":"C2942BA09082EC","user_header":"https://static001.geekbang.org/account/avatar/00/15/0b/13/3d14f827.jpg","comment_is_top":false,"comment_ctime":1585898570,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1585898570","product_id":100023201,"comment_content":"const $trafficLight = document.getElementById(&#39;traffic-light&#39;);<br>function changeBg(color, duration) {<br>    $trafficLight.style.background = color;<br>    return new Promise((resolve, reject) =&gt; {<br>        setTimeout(() =&gt; {<br>            resolve()<br>        }, duration);<br>    });<br>}<br>async function start() {<br>    while(true) {<br>        await changeBg(&#39;green&#39;, 3000);<br>        await changeBg(&#39;yellow&#39;, 1000);<br>        await changeBg(&#39;red&#39;, 2000);<br>    }<br>}","like_count":0},{"had_liked":false,"id":199633,"user_name":"éƒ‘ç¥ºè´¤","can_delete":false,"product_type":"c1","uid":1375644,"ip_address":"","ucode":"7238FA6C9132A2","user_header":"https://static001.geekbang.org/account/avatar/00/14/fd/9c/7b2b494c.jpg","comment_is_top":false,"comment_ctime":1585492902,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1585492902","product_id":100023201,"comment_content":"åŸå…ˆå¯¹äºjsçš„è¿™äº›åŸºç¡€ä¸æ€ä¹ˆæ·±å…¥çš„ç†è§£ï¼Œç°åœ¨æ¥è¡¥è¯¾","like_count":0},{"had_liked":false,"id":195381,"user_name":"æœç„¶çˆ¸çˆ¸","can_delete":false,"product_type":"c1","uid":1467300,"ip_address":"","ucode":"0E5F031A0E6A69","user_header":"https://static001.geekbang.org/account/avatar/00/16/63/a4/e663c4d4.jpg","comment_is_top":false,"comment_ctime":1585184465,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1585184465","product_id":100023201,"comment_content":"javascriptè¯­è¨€sdk æ–‡æ¡£","like_count":0},{"had_liked":false,"id":191478,"user_name":"g1f9","can_delete":false,"product_type":"c1","uid":1912902,"ip_address":"","ucode":"94B9852BF1277D","user_header":"","comment_is_top":false,"comment_ctime":1584777066,"is_pvip":false,"discussion_count":1,"race_medal":0,"score":"1584777066","product_id":100023201,"comment_content":"function delay(t){<br>  return new Promise((rs,rj)=&gt;{<br>    setTimeout(rs,t)<br>  })<br>}<br>function green(){<br>  console.log(&#39;green&#39;)<br>  return delay(3000)<br>}<br>function yellow(){<br>  console.log(&#39;yellow&#39;)<br>  return delay(1000)<br>}<br>function red(){<br>  console.log(&#39;red&#39;)<br>  return delay(2000)<br>}<br><br>function light(){<br>  green().then(yellow).then(red).then(light)<br>}","like_count":0,"discussions":[{"author":{"id":1910075,"avatar":"https://static001.geekbang.org/account/avatar/00/1d/25/3b/a971fc8e.jpg","nickname":"é˜¿æ„Ÿ","note":"","ucode":"7BCB7E44A832D1","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":253349,"discussion_content":"ä¼ ç»Ÿpromise  .then   .then â€¦â€¦","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1588228697,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":187954,"user_name":"hhk","can_delete":false,"product_type":"c1","uid":1138826,"ip_address":"","ucode":"72EC677FBDC79B","user_header":"http://thirdwx.qlogo.cn/mmopen/vi_32/gvfibNc3Bol6DzLMG5ia9wSLVYseoq326iae7TczmgmBj9u3Jwt8c0hl9KSzY4GNTFn0ic9m1ibzicqJ3aGzeQemec2Q/132","comment_is_top":false,"comment_ctime":1584282699,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1584282699","product_id":100023201,"comment_content":"&gt; ä½†æ˜¯ generator å¹¶éè¢«è®¾è®¡æˆå®ç°å¼‚æ­¥ï¼Œæ‰€ä»¥æœ‰äº† async&#47;await ä¹‹åï¼Œgenerator&#47;iterator æ¥æ¨¡æ‹Ÿå¼‚æ­¥çš„æ–¹æ³•åº”è¯¥è¢«åºŸå¼ƒ  <br>ä¸ºä»€ä¹ˆè¿™æ ·è¯´, é‚£redux-sagaæ€ä¹ˆè®²","like_count":0},{"had_liked":false,"id":186031,"user_name":"è´Ÿé‡å‰è¡Œ","can_delete":false,"product_type":"c1","uid":1626236,"ip_address":"","ucode":"5C34FFA20F476D","user_header":"http://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTJTH83G2zVZb77xAECyrEia7agaibOT1UlqSjRiciae5OE8nicW9pTPPlfq6h6mBM7UhPk640c3ibMSOWmA/132","comment_is_top":false,"comment_ctime":1583744569,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1583744569","product_id":100023201,"comment_content":"&#47;&#47; vueä¸­çš„å®ç°<br>    function sleep(duration) {<br>      return new Promise(resolve =&gt; {<br>        setTimeout(resolve, duration);<br>      });<br>    }<br><br>    const fn = async () =&gt; {<br>      &#47;&#47; eslint-disable-next-line no-constant-condition<br>      while (true) {<br>        this.bgc = &#39;green&#39;<br>        await sleep(3000);<br>        this.bgc = &quot;yellow&quot;;<br>        await sleep(1000);<br>        this.bgc = &quot;red&quot;;<br>        await sleep(2000);<br>      }<br>    }<br>    fn()","like_count":0},{"had_liked":false,"id":184850,"user_name":"Bryant-cx","can_delete":false,"product_type":"c1","uid":1242146,"ip_address":"","ucode":"ED9A93A527F695","user_header":"https://static001.geekbang.org/account/avatar/00/12/f4/22/257e9e21.jpg","comment_is_top":false,"comment_ctime":1583418119,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1583418119","product_id":100023201,"comment_content":"document.addEventListener(&#39;DOMContentLoaded&#39;, function () {<br>  const div = document.querySelectorAll(&#39;div&#39;)[0]<br><br>  function repeat () {<br>    sleep(3000)<br>      .then(() =&gt; {<br>        div.style = &#39;background: #eab30c;&#39;<br>        return sleep(1000)<br>      })<br>      .then(() =&gt; {<br>        div.style = &#39;background: #f00;&#39;<br>        return sleep(2000)<br>      })<br>      .then(() =&gt; {<br>        div.style = &#39;background: #0f0;&#39;<br>        repeat()<br>      })<br>  }<br><br>  repeat()<br>})<br><br>function sleep (duration) {<br>  return new Promise((resolve, reject) =&gt; {<br>    setTimeout(resolve, duration)<br>  })<br>}","like_count":0},{"had_liked":false,"id":184393,"user_name":"ğŸ‘‰ L.eğŸ‘ˆ","can_delete":false,"product_type":"c1","uid":1422959,"ip_address":"","ucode":"DC033198E84C95","user_header":"https://static001.geekbang.org/account/avatar/00/15/b6/6f/a952dac5.jpg","comment_is_top":false,"comment_ctime":1583305911,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1583305911","product_id":100023201,"comment_content":"function wait (duration, color) {<br>            return new Promise ((resolve, reject) =&gt; {<br>                setTimeout(() =&gt; {<br>                    resolve()<br>                }, duration)<br>                let circle = document.getElementById(&#39;circle&#39;)<br>                circle.style.background = color<br>            })<br>        }<br>        async function changeColor () {<br>            await wait(3000, &#39;green&#39;)<br>            await wait(1000, &#39;yellow&#39;)<br>            await wait(2000, &#39;red&#39;)<br>        }<br>        changeColor()","like_count":0},{"had_liked":false,"id":167382,"user_name":"Kravis","can_delete":false,"product_type":"c1","uid":1691885,"ip_address":"","ucode":"B52815536CEF2D","user_header":"https://static001.geekbang.org/account/avatar/00/19/d0/ed/bf0990ec.jpg","comment_is_top":false,"comment_ctime":1577781402,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1577781402","product_id":100023201,"comment_content":"const lightElement = document.querySelector(&#39;.traffic-light&#39;);<br><br>const setTrafficLight = (color, duration) =&gt; {<br>  lightElement.className = `traffic-light ${color}`;<br><br>  return new Promise((resolve) =&gt; {<br>    setTimeout(resolve, duration);<br>  });<br>};<br><br>const loop = async () =&gt; {<br>  while (true) {<br>    await setTrafficLight(&#39;green&#39;, 3000);<br>    await setTrafficLight(&#39;yellow&#39;, 1000);<br>    await setTrafficLight(&#39;red&#39;, 2000);<br>  }<br>};<br><br>loop();","like_count":0},{"had_liked":false,"id":161166,"user_name":"å®‹ç‰","can_delete":false,"product_type":"c1","uid":1465180,"ip_address":"","ucode":"75CC99DA84B0CF","user_header":"https://static001.geekbang.org/account/avatar/00/16/5b/5c/34905e98.jpg","comment_is_top":false,"comment_ctime":1576135479,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1576135479","product_id":100023201,"comment_content":"function changeColor(color,duration){<br>    return new Promise(function(resolve,reject){<br>        document.getElementById(&#39;trafficLight&#39;).style.background=color<br>        setTimeout(resolve,duration)<br>    })<br>}<br>async function test(){<br>    while(true){<br>        await changeColor(&#39;green&#39;,3000);<br>        await changeColor(&#39;yellow&#39;,1000);<br>        await changeColor(&#39;red&#39;,2000);<br>    }<br>}<br>test()","like_count":0},{"had_liked":false,"id":159052,"user_name":"gresen","can_delete":false,"product_type":"c1","uid":1381834,"ip_address":"","ucode":"F050CE6ED526EE","user_header":"https://wx.qlogo.cn/mmopen/vi_32/DYAIOgq83epLdWbztjssWulaNnFTaC4lJd12vZZgsz5cROnFrERY8YlBA4dW3QGHd6wU8HgC6IPwnIFcTo1lgA/132","comment_is_top":false,"comment_ctime":1575526198,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1575526198","product_id":100023201,"comment_content":"var lamp = document.getElementById(&quot;lamp&quot;);<br>\tfunction Fn(className, time) {<br>\t\tlamp.className = className<br>\t\treturn new Promise((resolve, reject) =&gt; {<br>\t\t\tsetTimeout(resolve, time)<br>\t\t})<br>\t};<br><br>\tasync function asyncFn() {<br>\t\twhile(true) {<br>\t\t\tawait Fn(&#39;green&#39;, 3000)<br>\t\t\tawait Fn(&#39;red&#39;, 1000)<br>\t\t\tawait Fn(&#39;yellow&#39;, 2000)<br>\t\t}<br>\t}<br>\tasyncFn();","like_count":0},{"had_liked":false,"id":158776,"user_name":"ç‹å¤©ç‹—","can_delete":false,"product_type":"c1","uid":1376470,"ip_address":"","ucode":"C0832F5785F44D","user_header":"https://static001.geekbang.org/account/avatar/00/15/00/d6/3eff7492.jpg","comment_is_top":false,"comment_ctime":1575449355,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1575449355","product_id":100023201,"comment_content":"  function colors(color) {<br>    light.style.background = color;<br>    console.log(color);<br>  }<br>  <br>  function fn() {<br>    light.style.background = &#39;green&#39;;<br>    setTimeout(&quot;colors(&#39;red&#39;)&quot;,3000);<br>    setTimeout(&quot;colors(&#39;yellow&#39;)&quot;, 5000);<br>  }<br>  function xh() {<br>    setInterval(&quot;fn()&quot;, 6000);<br>  }<br>  xh();","like_count":0},{"had_liked":false,"id":155736,"user_name":"haha","can_delete":false,"product_type":"c1","uid":1392569,"ip_address":"","ucode":"F91C0B43A9F180","user_header":"https://static001.geekbang.org/account/avatar/00/15/3f/b9/eaba519e.jpg","comment_is_top":false,"comment_ctime":1574746319,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1574746319","product_id":100023201,"comment_content":"function sleep(duration){<br>    return new Promise(function(resolve){<br>        setTimeout(resolve, duration);<br>    })<br>}<br>async function changeColor(duration,color){<br>    document.getElementById(&quot;traffic-light&quot;).style.background = color;<br>    await sleep(duration);<br><br>}<br>async function main(){<br>  await changeColor(3000,&quot;green&quot;);<br>  await changeColor(1000, &quot;yellow&quot;);<br>  await changeColor(2000, &quot;red&quot;);<br>  await main();<br>}<br>main()","like_count":0},{"had_liked":false,"id":153340,"user_name":"çŒ«æ€»","can_delete":false,"product_type":"c1","uid":1510269,"ip_address":"","ucode":"610BFD3253B1BA","user_header":"","comment_is_top":false,"comment_ctime":1574220081,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1574220081","product_id":100023201,"comment_content":"    const testDom = document.getElementById(&#39;test&#39;)<br><br>    function changeColor (color, dur) {<br>      return new Promise(resolve =&gt; {<br>        setTimeout(() =&gt; {<br>          testDom.style.background = color<br>          resolve()<br>        }, dur);<br>      })<br>    }<br><br>    async function onece () {<br>      await changeColor(&#39;red&#39;, 3000)<br>      await changeColor(&#39;green&#39;, 2000)<br>      await changeColor(&#39;yellow&#39;, 1000)<br>    }<br><br>    function carousel() {<br>      onece().then(resolve =&gt; {<br>        carousel()<br>      })<br>    }<br><br>    carousel()","like_count":0},{"had_liked":false,"id":151476,"user_name":"ææ‰¬","can_delete":false,"product_type":"c1","uid":1376098,"ip_address":"","ucode":"9ABA00C143C34D","user_header":"https://static001.geekbang.org/account/avatar/00/14/ff/62/8c302aa5.jpg","comment_is_top":false,"comment_ctime":1573727759,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1573727759","product_id":100023201,"comment_content":"async function changeLight() {<br>  let _node = document.getElementById(&#39;light-wrap&#39;)<br>  await _change(3000, &#39;green&#39;)<br>  await _change(1000, &#39;yellow&#39;)<br>  await _change(2000, &#39;red&#39;)<br><br>  function _change(tms, _color) {<br>    return new Promise((resolve) =&gt; {<br>      _node.style.backgroundColor = _color;<br>      setTimeout(resolve, tms)<br>    })<br>  }<br>}<br><br>async function loop() {<br>  await changeLight()<br>  loop()<br>}<br><br>loop()","like_count":0},{"had_liked":false,"id":143932,"user_name":"æ¶¯æ¸Š","can_delete":false,"product_type":"c1","uid":1443237,"ip_address":"","ucode":"F364D121087F1F","user_header":"https://static001.geekbang.org/account/avatar/00/16/05/a5/69955c34.jpg","comment_is_top":false,"comment_ctime":1571808890,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1571808890","product_id":100023201,"comment_content":"å¯¹å‰ç«¯æŒºæ„Ÿå…´è¶£çš„ï¼Œå­¦äº†è¯¾ç¨‹å—ç›Šè‰¯å¤šï¼Œæ¯”è¾ƒå–œæ¬¢è¿™ç§ä»åŸç†å±‚é¢å»ç†è§£çš„ï¼Œå°ç»ƒä¹ åšäº†ä¸‹ä¼ªåŠ£æ¿çš„ï¼Œ<br>  function light(duration){<br>    return new Promise(function(resolve,reject){<br>      setTimeout(resolve,duration);<br>    })<br>  }<br>  async function dynamicTrafficLight(){<br>    while(true){<br>      console.log(&#39;green&#39;);<br>      await light(3000);<br>      console.log(&#39;yellow&#39;);<br>      await light(1000);<br>      console.log(&#39;red&#39;);<br>      await light(2000);<br>    }<br>  }<br>  dynamicTrafficLight();","like_count":0},{"had_liked":false,"id":143541,"user_name":"FC.@","can_delete":false,"product_type":"c1","uid":1383423,"ip_address":"","ucode":"A0E0111A25A113","user_header":"https://static001.geekbang.org/account/avatar/00/15/1b/ff/e60f7d17.jpg","comment_is_top":false,"comment_ctime":1571728576,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1571728576","product_id":100023201,"comment_content":"const ct = document.getElementById(&#39;ct&#39;)<br><br>function light(color, timer) {<br>    return new Promise((resolve, reject) =&gt; {<br>        setTimeout(() =&gt; {<br>            ct.style.background = color;<br>            resolve()<br>        }, timer)<br>    })<br>}<br><br>async function lighting() {<br>    await light(&#39;red&#39;, 3000)<br>    await light(&#39;yellow&#39;, 1000)<br>    await light(&#39;green&#39;, 2000)<br><br>    return lighting()<br>}<br>lighting()","like_count":0},{"had_liked":false,"id":120990,"user_name":"Hc_Zzz","can_delete":false,"product_type":"c1","uid":1009735,"ip_address":"","ucode":"85B8FB5E07E2B9","user_header":"https://static001.geekbang.org/account/avatar/00/0f/68/47/893fb1ba.jpg","comment_is_top":false,"comment_ctime":1565031199,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1565031199","product_id":100023201,"comment_content":"codepen è¿è¡Œæ•ˆæœï¼š https:&#47;&#47;codepen.io&#47;HanchengZhao-1471862086&#47;pen&#47;oKpNpm?editors=1111","like_count":0},{"had_liked":false,"id":116159,"user_name":"å°ç“¶å„¿","can_delete":false,"product_type":"c1","uid":1375564,"ip_address":"","ucode":"BC40A5F600FC0F","user_header":"https://static001.geekbang.org/account/avatar/00/14/fd/4c/e405a855.jpg","comment_is_top":false,"comment_ctime":1563795347,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1563795347","product_id":100023201,"comment_content":"const changeColor = (color, duration) =&gt; {<br>  return new Promise((resolve, reject) =&gt; {<br>\tsetTimeout(resolve, duration, color)<br>  })<br>}<br>const colorArr = [{label: &#39;red&#39;, time: 2000}, {label: &#39;green&#39;, time: 3000}, {label: &#39;yellow&#39;, time: 1000}]; <br>colorArr.forEach(item =&gt; {<br>  changeColor(item.label, item.time).then(res =&gt; {console.log(`${res}ç¯æ¥å•¦`)})<br>})","like_count":0},{"had_liked":false,"id":113621,"user_name":"siegfried","can_delete":false,"product_type":"c1","uid":1007931,"ip_address":"","ucode":"31673819DD2605","user_header":"https://static001.geekbang.org/account/avatar/00/0f/61/3b/abb7bfe3.jpg","comment_is_top":false,"comment_ctime":1563095809,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1563095809","product_id":100023201,"comment_content":"var trafficLight = () =&gt; {<br>\t&#47;&#47; å®ç°ä¸€ä¸ªçº¢ç»¿ç¯ï¼ŒæŠŠä¸€ä¸ªåœ†å½¢ div æŒ‰ç…§ç»¿è‰² 3sï¼Œé»„è‰² 1s , çº¢è‰² 2s. å¾ªç¯è¾“å‡º<br>\tasync function exec() {<br>\t\tconst ts = [<br>\t\t\t{<br>\t\t\t\tduration: 3000,<br>\t\t\t\tcolor: &#39;green&#39;<br>\t\t\t},<br>\t\t\t{<br>\t\t\t\tduration: 1000,<br>\t\t\t\tcolor: &#39;yellow&#39;<br>\t\t\t},<br>\t\t\t{<br>\t\t\t\tduration: 2000,<br>\t\t\t\tcolor: &#39;red&#39;<br>\t\t\t}<br>\t\t];\t<br><br>\t\t&#47;&#47; å•æ¬¡è¾“å‡º<br>\t\tfor (let i = 0; i &lt; ts.length; i++) {<br>\t\t\tawait light(ts[i].color, ts[i].duration)<br>\t\t}<br><br>\t\t&#47;&#47; æ— é™å¾ªç¯<br>\t\tlet i = 0;<br>\t\twhile (1) {<br>\t\t\tp = ts[i];<br>\t\t\tawait light(ts[i].color, ts[i].duration)<br>\t\t\t++i<br>\t\t\ti = (i % ts.length)<br>\t\t}<br><br>\t\t&#47;&#47; wrong forEachæ˜¯å¹¶å‘æ‰§è¡Œçš„ï¼Œä¸ä¼šç»§å‘æ‰§è¡Œ<br>\t\tts.forEach(async function (t) {<br>\t\t\tawait light(t.color, t.duration)<br>\t\t})<br>\t}<br><br>\tfunction light(color, duration) {<br>\t\treturn new Promise(resolve =&gt; {<br>\t\t\tconsole.log(color)<br><br>\t\t\tsetTimeout(() =&gt; {<br>\t\t\t\tresolve()<br>\t\t\t}, duration)<br>\t\t})<br>\t}<br>}","like_count":0},{"had_liked":false,"id":113495,"user_name":"å¤§åŠ›","can_delete":false,"product_type":"c1","uid":1364353,"ip_address":"","ucode":"1B2125C519443D","user_header":"https://static001.geekbang.org/account/avatar/00/14/d1/81/89ba9d81.jpg","comment_is_top":false,"comment_ctime":1563031538,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1563031538","product_id":100023201,"comment_content":"let changeColor = (div, duration, color) =&gt; {<br>\treturn new Promise((resolve, reject) =&gt; {<br>\t\tsetTimeout(resolve, duration * 1000);<br>\t})<br>\t.then(() =&gt; {<br>\t\tlet style = div.getAttribute(&#39;style&#39;);<br>\t\tstyle = style || {};<br>\t\tstyle[&#39;background-color&#39;] = color;<br>\t\tconsole.log(&#39;current color: &#39; + color);<br>\t});<br>};<br><br>let flash = async div =&gt; {<br>\twhile(true) {<br>\t\tawait changeColor(div, 3, &#39;green&#39;);<br>\t\tawait changeColor(div, 1, &#39;yellow&#39;);<br>\t\tawait changeColor(div, 2, &#39;red&#39;);<br>\t}<br>};<br><br>let div = document.createElement(&#39;div&#39;);<br>div.setAttribute(&#39;class&#39;, &#39;traffic-light&#39;);<br>flash(div);","like_count":0},{"had_liked":false,"id":111207,"user_name":"zker-non","can_delete":false,"product_type":"c1","uid":1388586,"ip_address":"","ucode":"5A1C3212ED0912","user_header":"http://thirdwx.qlogo.cn/mmopen/vi_32/5tO3rCyAaJAnXITSxSnWhntTb5URuVh0nibtZ6oIXzeRqPG1MZVe6HpXxXOgrG4IiaYY2MzQlVTkxeOv228muCEQ/132","comment_is_top":false,"comment_ctime":1562510948,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1562510948","product_id":100023201,"comment_content":"function stay(time) {<br>\treturn new Promise(function(resolve) {<br>  \tsetTimeout(resolve, time);<br>  })<br>}<br><br>async function switchColorContinue(elem) {<br>\tlet colors = [&quot;green&quot;, &quot;yellow&quot;, &quot;red&quot;];<br>  let duration = {<br>  \tgreen: 3000,<br>    yellow: 1000,<br>    red: 2000<br>  }<br>  while(true) {<br>  \tfor (const color of colors) {<br>  \t\telem.style.backgroundColor = color;<br>    \tawait stay(duration[color])<br>  \t}<br>  }<br>  <br>  <br><br>}<br><br>let target = document.getElementById(&quot;circle&quot;);<br><br>switchColorContinue(target);","like_count":0},{"had_liked":false,"id":107108,"user_name":"å¥‹é€—çš„ç å†œå“¥","can_delete":false,"product_type":"c1","uid":1582667,"ip_address":"","ucode":"46195536825201","user_header":"https://static001.geekbang.org/account/avatar/00/18/26/4b/d1fc46d6.jpg","comment_is_top":false,"comment_ctime":1561460508,"is_pvip":false,"replies":[{"id":"58935","content":"è¿™ä¸ªä¸å¤ªè¡Œï¼Œå®Œå…¨æ˜¯å›è°ƒï¼Œæ²¡æœ‰ç”¨ä¸ŠPromiseçš„ä¼˜åŠ¿å•Š","user_name":"ä½œè€…å›å¤","user_name_real":"winter","uid":"1268524","ctime":1574221830,"ip_address":"","comment_id":107108,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1561460508","product_id":100023201,"comment_content":"&#47;&#47; å®ç°ä¸€ä¸ªçº¢ç»¿ç¯ï¼ŒæŠŠä¸€ä¸ªåœ†å½¢ div æŒ‰ç…§ç»¿è‰²3 ç§’ï¼Œé»„è‰² 1 ç§’ï¼Œçº¢è‰² 2 ç§’å¾ªç¯æ”¹å˜èƒŒæ™¯è‰²<br>&#47;&#47; åˆå§‹åŒ–åˆ›å»ºå…ƒç´ <br>var div = document.createElement(&quot;div&quot;)<br>div.className = &#39;light&#39;<br>div.innerText=&#39;&#39;<br>div.style.backgroundColor = &#39;&#39;<br>div.align = &#39;center&#39;<br>div.style.fontSize = &#39;30px&#39;<br>div.style.lineHeight = &#39;100px&#39;<br>div.style.color = &#39;#fff&#39;<br>div.style.height = 100<br>div.style.width = 100<br>div.style.borderRadius = &#39;50px&#39;<br>document.body.appendChild(div)<br><br>var sleep = function (duration) {<br>    return new Promise(function(resolve, reject) {<br>        setTimeout(resolve,duration);<br>    })<br>}<br><br>&#47;&#47; ç»¿ç¯<br>var green = function () {<br>  document.querySelector(&#39;.light&#39;).style.backgroundColor = &#39;green&#39;<br>  sleep(3000).then(()=&gt; { yellow() });<br>}<br><br>&#47;&#47; é»„ç¯<br>var yellow = function () {<br>  document.querySelector(&#39;.light&#39;).style.backgroundColor = &#39;yellow&#39;<br>  sleep(1000).then(()=&gt; { red() });<br>}<br><br>&#47;&#47; çº¢ç¯<br>var red = function () {<br>  document.querySelector(&#39;.light&#39;).style.backgroundColor = &#39;red&#39;<br>  sleep(2000).then(()=&gt; { green() });<br>}<br><br>var init = function() {<br>  &#47;&#47; ç»¿ç¯å¯åŠ¨<br>  green()<br>}<br><br>&#47;&#47; æ‰§è¡Œ<br>init()","like_count":0,"discussions":[{"author":{"id":1268524,"avatar":"https://static001.geekbang.org/account/avatar/00/13/5b/2c/12bfd3cd.jpg","nickname":"winter","note":"","ucode":"2B068EDEAFEB56","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":455367,"discussion_content":"è¿™ä¸ªä¸å¤ªè¡Œï¼Œå®Œå…¨æ˜¯å›è°ƒï¼Œæ²¡æœ‰ç”¨ä¸ŠPromiseçš„ä¼˜åŠ¿å•Š","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1574221830,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":104796,"user_name":"Geek_14c289","can_delete":false,"product_type":"c1","uid":1581042,"ip_address":"","ucode":"4BFE1658D17849","user_header":"http://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTLM6pIKfRqnNN0tb6ckakFXib6erRDWWMvaEPX2P9uCUo3qyM3ZQgicjIOcSNzAv0ZnKtJymqxFtRcQ/132","comment_is_top":false,"comment_ctime":1560840480,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1560840480","product_id":100023201,"comment_content":"&lt;!DOCTYPE html&gt;<br>&lt;html lang=&quot;en&quot;&gt;<br>&lt;head&gt;<br>    &lt;meta charset=&quot;UTF-8&quot;&gt;<br>    &lt;title&gt;Title&lt;&#47;title&gt;<br>    &lt;style&gt;<br>        .circle{<br>            width: 50px;<br>            height: 50px;<br>            border-radius: 25px;<br>            border: solid 1px #333333;<br>        }<br>        .green{<br>            background: green;<br>        }<br>        .yellow{<br>            background: yellow;<br>        }<br>        .red{<br>            background: red;<br>        }<br>    &lt;&#47;style&gt;<br>&lt;&#47;head&gt;<br>&lt;body&gt;<br>&lt;div class=&quot;circle&quot; id=&quot;circle1&quot;&gt;&lt;&#47;div&gt;<br>&lt;div class=&quot;circle&quot; id=&quot;circle2&quot;&gt;&lt;&#47;div&gt;<br>&lt;div class=&quot;circle&quot; id=&quot;circle3&quot;&gt;&lt;&#47;div&gt;<br>&lt;script&gt;<br>    var dom1 = document.getElementById(&#39;circle1&#39;);<br>    var dom2 = document.getElementById(&#39;circle2&#39;);<br>    var dom3 = document.getElementById(&#39;circle3&#39;);<br>    window.onload = function () {<br>        turnGreen();<br>    };<br>    function turnGreen() {<br>        dom1.className = &#39;circle green&#39;;<br>        dom2.className = &#39;circle&#39;;<br>        dom3.className = &#39;circle&#39;;<br>        setTimeout(function () {<br>            turnYellow();<br>        }, 3000);<br>    }<br>    function turnYellow() {<br>        dom1.className = &#39;circle&#39;;<br>        dom2.className = &#39;circle yellow&#39;;<br>        dom3.className = &#39;circle&#39;;<br>        setTimeout(function () {<br>            turnRed();<br>        }, 1000);<br>    }<br>    function turnRed() {<br>        dom1.className = &#39;circle&#39;;<br>        dom2.className = &#39;circle&#39;;<br>        dom3.className = &#39;circle red&#39;;<br>        setTimeout(function () {<br>            turnGreen();<br>        }, 2000);<br>    }<br>&lt;&#47;script&gt;<br>&lt;&#47;body&gt;<br>&lt;&#47;html&gt;","like_count":0},{"had_liked":false,"id":104442,"user_name":"ç å†œ","can_delete":false,"product_type":"c1","uid":1387777,"ip_address":"","ucode":"07EA25C61A8721","user_header":"https://static001.geekbang.org/account/avatar/00/15/2d/01/b201d82b.jpg","comment_is_top":false,"comment_ctime":1560755423,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1560755423","product_id":100023201,"comment_content":"function changeColor(color,duration){<br>      return new Promise((resolve,reject) =&gt; {<br>        setTimeout( () =&gt; {<br>                             document.getElementById(&#39;traffic-light&#39;).style.background=color;<br>          resolve();<br>        },duration);<br>      })<br>    }<br>    <br>    async function foo(){<br>      document.getElementById(&#39;traffic-light&#39;).style.background=&#39;green&#39;;<br>      while(true){<br>        await changeColor(&#39;yellow&#39;,3000);<br>        await changeColor(&#39;red&#39;,1000);<br>        await changeColor(&#39;green&#39;,2000);<br>      }<br>      <br>    }<br><br>    foo();","like_count":0},{"had_liked":false,"id":103425,"user_name":"Jaykey","can_delete":false,"product_type":"c1","uid":1167992,"ip_address":"","ucode":"535FEA1292D290","user_header":"https://static001.geekbang.org/account/avatar/00/11/d2/78/1f1b45f9.jpg","comment_is_top":false,"comment_ctime":1560432741,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1560432741","product_id":100023201,"comment_content":"function lightTime (duration) {<br>    return new Promise((resolve, reject) =&gt; {<br>        setTimeout(resolve, duration);<br>    })<br>}<br>async function light (color, time) {<br>    await lightTime(time)<br>    console.log(color)<br>}<br><br>async function crossRoad() {<br>\twhile(2&gt;1) {<br>        await light(&#39;green&#39;, 3000);<br>        await light(&#39;yellow&#39;, 1000);<br>        await light(&#39;red&#39;, 2000);<br>    }<br>}<br><br>crossRoad()","like_count":0},{"had_liked":false,"id":102911,"user_name":"gzj","can_delete":false,"product_type":"c1","uid":1380895,"ip_address":"","ucode":"688831FC7BAD88","user_header":"","comment_is_top":false,"comment_ctime":1560327263,"is_pvip":false,"discussion_count":2,"race_medal":0,"score":"1560327263","product_id":100023201,"comment_content":"è€å¸ˆï¼Œé—®ä¸‹ç¬¬ä¸€ä¸ªç•™è¨€é‡Œ mainå‡½æ•°ä¸­çš„ while(true){} æœ‰ä»€ä¹ˆç”¨æ„å—ï¼Ÿ","like_count":0,"discussions":[{"author":{"id":1641179,"avatar":"","nickname":"ä¸‰ä¸ƒäºŒåå‡ ","note":"","ucode":"5E55B19DD04FDC","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":6704,"discussion_content":"ä¸€ç›´å¾ªç¯æ‰§è¡Œ","likes_number":1,"is_delete":false,"is_hidden":false,"ctime":1567061089,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1485599,"avatar":"","nickname":"èƒ¡æ¡ƒå¤¹å­","note":"","ucode":"EA58FBAD8143E7","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":194787,"discussion_content":"ç¡®ä¿ä¸‰ä¸ªå•æ¬¡å®šæ—¶å™¨èƒ½æ°¸è¿œæ‰§è¡Œä¸‹å»","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1583242708,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":101861,"user_name":"ç§¯å¾®","can_delete":false,"product_type":"c1","uid":1378111,"ip_address":"","ucode":"373DF8B1DC002B","user_header":"https://static001.geekbang.org/account/avatar/00/15/07/3f/43872dff.jpg","comment_is_top":false,"comment_ctime":1559998902,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1559998902","product_id":100023201,"comment_content":"-macro-taskåŒ…æ‹¬ï¼š<br>script(æ•´ä½“ä»£ç ), setTimeout, setInterval, setImmediate, I&#47;O, UI renderingã€‚<br><br>micro-taskåŒ…æ‹¬ï¼š<br>process.nextTick, Promises, Object.observe, MutationObserver.<br><br>ä¸çŸ¥é“æœ‰æ²¡æœ‰é”™è¯¯ï¼Ÿ","like_count":0},{"had_liked":false,"id":97460,"user_name":"å°‘å¹´","can_delete":false,"product_type":"c1","uid":1527279,"ip_address":"","ucode":"AE7BE546913C0E","user_header":"https://static001.geekbang.org/account/avatar/00/17/4d/ef/25dda3a4.jpg","comment_is_top":false,"comment_ctime":1558675877,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1558675877","product_id":100023201,"comment_content":"var light = document.getElementById(&#39;light&#39;);<br>function sleep(duration) {<br>\treturn new Promise((resolve, reject)=&gt;{<br>\t\tsetTimeout(resolve, duration);<br>\t});<br>}<br>async function change (duration, color) {<br>\tlight.style.background = color;<br>\tawait sleep(duration);<br>}<br>(async function run() {<br>\tawait change(3 * 1000, &#39;green&#39;);<br>\tawait change(1 * 1000, &#39;yellow&#39;);<br>\tawait change(2 * 1000, &#39;red&#39;);<br>\tawait run();<br>})();","like_count":0},{"had_liked":false,"id":97406,"user_name":"Roam","can_delete":false,"product_type":"c1","uid":1387678,"ip_address":"","ucode":"1CB7B8555AF16C","user_header":"https://static001.geekbang.org/account/avatar/00/15/2c/9e/b44ed40d.jpg","comment_is_top":false,"comment_ctime":1558665583,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1558665583","product_id":100023201,"comment_content":"function sleep (duration) {<br>  return new Promise(resolve =&gt; {<br>    setTimeout(resolve, duration)<br>  })<br>}<br><br>function changeBackgroundColor (el, color) {<br>  el.style.backgroundColor = color<br>}<br><br>async function loop (el, queue) {<br>  if (queue.length &lt; 1) return<br><br>  const item = queue.shift()<br><br>  queue.push(item)<br>  changeBackgroundColor(el, item.color)<br>  await sleep(item.duration)<br><br>  loop(el, queue)<br>}<br><br>function start () {<br>  const el = document.getElementById(&#39;el&#39;)<br>  const queue = [<br>    {<br>      color: &#39;green&#39;,<br>      duration: 3000<br>    },<br>    {<br>      color: &#39;yellow&#39;,<br>      duration: 1000<br>    },<br>    {<br>      color: &#39;red&#39;,<br>      duration: 2000<br>    }<br>  ]<br><br>  loop(el, queue)<br>}<br><br>start()","like_count":0},{"had_liked":false,"id":96463,"user_name":"é‡Šç„¶","can_delete":false,"product_type":"c1","uid":1420287,"ip_address":"","ucode":"840244682A26CB","user_header":"https://static001.geekbang.org/account/avatar/00/15/ab/ff/a39e1ad7.jpg","comment_is_top":false,"comment_ctime":1558429624,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1558429624","product_id":100023201,"comment_content":"let light = document.getElementById(&#39;light&#39;);<br>function changeColor() {<br>\tsetTimeout(()=&gt; {<br>\t\tlight.style.background = &#39;yellow&#39;;<br>\t},3000)<br>\tsetTimeout(()=&gt; {<br>\t\tlight.style.background = &#39;red&#39;;<br>\t},4000)<br>\tsetTimeout(()=&gt; {<br>\t\tlight.style.background = &#39;green&#39;;<br>\t\tchange()<br>\t},6000)<br><br>}<br>changeColor()","like_count":0},{"had_liked":false,"id":94156,"user_name":"å¥¥æ–¯ç‰¹æ´›å¤«æ–¯åŸº","can_delete":false,"product_type":"c1","uid":1379844,"ip_address":"","ucode":"9AFECAC3A1FCAD","user_header":"https://static001.geekbang.org/account/avatar/00/15/0e/04/d710d928.jpg","comment_is_top":false,"comment_ctime":1557734291,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1557734291","product_id":100023201,"comment_content":"å¯ä»¥è®²è®²æµè§ˆå™¨ä¸­çš„äº‹ä»¶å¾ªç¯å’Œnodeä¸­çš„äº‹ä»¶å¾ªç¯çš„åŒºåˆ«å—","like_count":0},{"had_liked":false,"id":91148,"user_name":"xuanyuan","can_delete":false,"product_type":"c1","uid":1113737,"ip_address":"","ucode":"1EC79B9372868F","user_header":"http://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTI2icbib62icXtibTkThtyRksbuJLoTLMts7zook2S30MiaBtbz0f5JskwYicwqXkhpYfvCpuYkcvPTibEaQ/132","comment_is_top":false,"comment_ctime":1556881902,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1556881902","product_id":100023201,"comment_content":"å®è§‚è®¤ä¸ºå’Œå¾®è§‚ä»»åŠ¡è¿˜æ˜¯æ„Ÿè§‰æ²¡çœ‹æ˜ç™½","like_count":0},{"had_liked":false,"id":90174,"user_name":"Sher","can_delete":false,"product_type":"c1","uid":1462558,"ip_address":"","ucode":"9A6645FD2CD64A","user_header":"https://static001.geekbang.org/account/avatar/00/16/51/1e/0717c37a.jpg","comment_is_top":false,"comment_ctime":1556439583,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1556439583","product_id":100023201,"comment_content":"async&#47;await æ˜¯ åº”è¯¥æ˜¯ ES2017 ï¼Œæˆ‘é…ç½® .eslintrc.jsonï¼Œè¿™æ ·æ‰ä¸ä¼šæŠ¥é”™<br>&quot;parserOptions&quot;: {<br>        &quot;ecmaVersion&quot;: 2017,<br>        &quot;sourceType&quot;: &quot;module&quot;<br>    },","like_count":0},{"had_liked":false,"id":89774,"user_name":"Zkerhcy","can_delete":false,"product_type":"c1","uid":1231133,"ip_address":"","ucode":"43A883F6FB6070","user_header":"https://static001.geekbang.org/account/avatar/00/12/c9/1d/c7586cfc.jpg","comment_is_top":false,"comment_ctime":1556261742,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1556261742","product_id":100023201,"comment_content":"let sleep = duration =&gt;<br>  new Promise(function(resolve, reject) {<br>    setTimeout(resolve, duration)<br>  })<br>;(async function trafficLight() {<br>  while (true) {<br>    console.log(&quot;Green&quot;)<br>    await sleep(3000)<br>    console.log(&quot;Yellow&quot;)<br>    await sleep(1000)<br>    console.log(&quot;Red&quot;)<br>    await sleep(2000)<br>  }<br>})()<br>","like_count":0},{"had_liked":false,"id":87255,"user_name":"åšæŒä¸‹å‘¢","can_delete":false,"product_type":"c1","uid":1434062,"ip_address":"","ucode":"12246A8DDAE92E","user_header":"http://thirdwx.qlogo.cn/mmopen/vi_32/DYAIOgq83epia1vHGsTDRTyfFcrsiabK2nIWITdhIEUDBw9ZHviaZSg82tsRiatIQ4BQ14p8AicbjYCleHH3I0YfPFQ/132","comment_is_top":false,"comment_ctime":1555553067,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1555553067","product_id":100023201,"comment_content":"function change(duration, bgcolor) {<br>    return new Promise(function(resolve, reject) {<br>        setTimeout(function(){<br>            document.getElementById(&#39;light&#39;).style.backgroundColor = bgcolor;<br>            resolve();<br>        }, duration);<br>    });<br>}<br>        <br>async function green() {<br>    await change(3000, &#39;yellow&#39;);<br>    yellow();<br>}<br><br>async function yellow() {<br>    await change(1000, &#39;red&#39;);<br>    red();<br>}<br><br>async function red() {<br>    await change(2000, &#39;green&#39;);<br>    green();<br>}<br><br>green();","like_count":0},{"had_liked":false,"id":86491,"user_name":"ç‹ç„","can_delete":false,"product_type":"c1","uid":1394410,"ip_address":"","ucode":"E54ABB340D1E49","user_header":"https://static001.geekbang.org/account/avatar/00/15/46/ea/b86667b8.jpg","comment_is_top":false,"comment_ctime":1555382727,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1555382727","product_id":100023201,"comment_content":"console promiseæ˜¯ä»€ä¹ˆä»»åŠ¡ è¿˜æ˜¯ä»€ä¹ˆï¼Ÿ æˆ‘æœ‰ç‚¹ä¸è§£","like_count":0},{"had_liked":false,"id":85626,"user_name":"Geek_0bb537","can_delete":false,"product_type":"c1","uid":1488361,"ip_address":"","ucode":"BE1A16372FC814","user_header":"https://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTJDSY5xBJ2PH4lqNtWJqhe1HcYkP7S9ibAXChONgCBX5pJ2gaU3icXhltQgqhzDyML3EzFicxPeE4Tiag/132","comment_is_top":false,"comment_ctime":1555147028,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1555147028","product_id":100023201,"comment_content":"winterè€å¸ˆ è¿™ä¸ªasync&amp;&amp;awaitå¯å¦ç†è§£æˆgeneratorå’Œcoæ¨¡å—çš„æ•´åˆ ç„¶åæ‰©å±•äº†ä¸€äº›åŠŸèƒ½","like_count":0},{"had_liked":false,"id":85401,"user_name":"chwech","can_delete":false,"product_type":"c1","uid":1469503,"ip_address":"","ucode":"C6F721086D80C7","user_header":"https://static001.geekbang.org/account/avatar/00/16/6c/3f/b83f0b5e.jpg","comment_is_top":false,"comment_ctime":1555053376,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1555053376","product_id":100023201,"comment_content":"var c = document.getElementsByClassName(&#39;box&#39;)[0]<br><br>  function turnColor(el, color, s) {<br>    return new Promise((resolve, reject) =&gt; {<br>      setTimeout(() =&gt; {<br>        el.style.background = color<br>        resolve()<br>      }, s)\t<br>    })<br>  }<br><br>  async function start(aa) {<br>    await turnColor(c, &#39;green&#39;, 3000)<br>    await turnColor(c, &#39;yellow&#39;, 1000)<br>    await turnColor(c, &#39;red&#39;, 2000)<br>    return start()<br>  }<br><br>  start()","like_count":0},{"had_liked":false,"id":84603,"user_name":"Cander","can_delete":false,"product_type":"c1","uid":1381524,"ip_address":"","ucode":"838B8F877C7080","user_header":"https://static001.geekbang.org/account/avatar/00/15/14/94/7fcd4c89.jpg","comment_is_top":false,"comment_ctime":1554883912,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1554883912","product_id":100023201,"comment_content":"<br>setTimeout(() =&gt; {<br>  console.log(1)<br>}, 0)<br><br>new Promise(r =&gt; {<br>  console.log(2)<br>  r()<br>}).then(r =&gt; {<br>  console.log(3)<br>  new Promise(s =&gt; {<br>    console.log(4)<br>    s()<br>  }).then(q =&gt; {<br>    console.log(5)<br>  })<br>})<br>è€å¸ˆ, æˆ‘ä¸æ˜ç™½ä¸ºä»€ä¹ˆåœ¨å¾®ä»»åŠ¡ä¸­æ·»åŠ å¾®ä»»åŠ¡, è¿˜æ˜¯ä¼šæ—©ä¸å®ä»»åŠ¡æ‰§è¡Œ? å¯ä»¥å¸®æˆ‘è§£ç­”ä¸‹å—?","like_count":0},{"had_liked":false,"id":84146,"user_name":"å­™å°åš","can_delete":false,"product_type":"c1","uid":1462889,"ip_address":"","ucode":"2309114BFE2123","user_header":"https://static001.geekbang.org/account/avatar/00/16/52/69/cd5147df.jpg","comment_is_top":false,"comment_ctime":1554793609,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1554793609","product_id":100023201,"comment_content":"let light = document.getElementById(&quot;light&quot;);<br><br>    function changeColor (await, color) {<br>      return new Promise((resolve, reject) =&gt; {<br>        light.className = color<br>        setTimeout(resolve, await)<br>      })<br>    }<br><br>    async function main () {<br>      while (!document.hidden) {<br>        await changeColor(3000, &quot;green&quot;);<br>        await changeColor(1000, &quot;yellow&quot;);<br>        await changeColor(2000, &quot;red&quot;);<br>      }<br>    }<br><br>    main();","like_count":0},{"had_liked":false,"id":83607,"user_name":"ç§¦ä¸œ","can_delete":false,"product_type":"c1","uid":1365487,"ip_address":"","ucode":"3E21D2777B1D3D","user_header":"http://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTIHiaJ01zhIap20ckTyMWg3NycAd2yTRVwJyKQfdCt7rR2MlnBak1yZOfuRfxq51lstxQJ9ic6df9icQ/132","comment_is_top":false,"comment_ctime":1554684716,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1554684716","product_id":100023201,"comment_content":"http:&#47;&#47;www.ruanyifeng.com&#47;blog&#47;2014&#47;10&#47;event-loop.html<br>é˜®å¤§ç¥è®²è§£çš„æ›´åŠ é€å½»ã€‚å®è§‚ï¼Œå¾®è§‚ï¼Œæœ‰ç‚¹ã€‚ã€‚ã€‚","like_count":0},{"had_liked":false,"id":80039,"user_name":"ç†æƒ³ä¸¤æ—¬åŠ.","can_delete":false,"product_type":"c1","uid":1378789,"ip_address":"","ucode":"3A9A963DAF380C","user_header":"https://static001.geekbang.org/account/avatar/00/15/09/e5/666ba844.jpg","comment_is_top":false,"comment_ctime":1553597785,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1553597785","product_id":100023201,"comment_content":"è€å¸ˆæ‚¨å¥½ï¼Œä¸‹é¢è¿™ä¸ªè‡ªå·±ç»ƒä¹ çš„ä¾‹å­å¸Œæœ›æ‚¨èƒ½å¸®è§£ç­”ï¼š<br><br>console.log(&#39;sync1&#39;);<br><br>    setTimeout(function () {<br>        console.log(&#39;setTimeout1&#39;)<br>    }, 0);<br><br>    var promise = new Promise(function (resolve, reject) {<br>        setTimeout(function () {<br>            console.log(&#39;setTimeoutPromise&#39;)<br>        }, 0);<br>        console.log(&#39;promise&#39;);<br>        resolve();<br>    });<br><br><br>    promise.then(() =&gt; {<br>        console.log(&#39;pro_then&#39;);<br>        setTimeout(() =&gt; {<br>            console.log(&#39;pro_timeout&#39;);<br>        }, 0)<br>    })<br><br>    setTimeout(function () {<br>        console.log(&#39;last_setTimeout&#39;)<br>    }, 0);<br>    console.log(&#39;sync2&#39;);<br><br>ä¸ºä»€ä¹ˆ promise.thenä¸­çš„settimeoutæ˜¯æœ€åæ‰“å°çš„ï¼Ÿ<br>ä¸ç”¨ç®¡æ˜¯å®ä»»åŠ¡ä¾æ¬¡æ‰§è¡Œå—","like_count":0},{"had_liked":false,"id":80029,"user_name":"ç¿°å¼Ÿ","can_delete":false,"product_type":"c1","uid":1144772,"ip_address":"","ucode":"42149ACC75AA08","user_header":"http://thirdwx.qlogo.cn/mmopen/vi_32/EJZoM46wR6QqTeibhPZsO5wJTeUia4RndGicWfDZLw153WibjsnJXqEtGZICxAa8icb36pDkficTic3FViaySd1z9HmQBw/132","comment_is_top":false,"comment_ctime":1553596279,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1553596279","product_id":100023201,"comment_content":"        function sleep(duration) {<br>            return new Promise(function (resolve) {<br>                setTimeout(resolve, duration)<br>            })<br>        }<br>        function setColor(color) {<br>            document.querySelector(&#39;.box&#39;).style.backgroundColor = color;<br>        }<br><br>        async function showColor() {<br>            setColor(&quot;green&quot;)<br>            await sleep(3000).then(() =&gt; {<br>                setColor(&quot;yellow&quot;)<br>            })<br>            await sleep(1000).then(() =&gt; {<br>                setColor(&quot;blue&quot;)<br>            })<br>            await sleep(2000).then(() =&gt; {<br>                showColor()<br>            })<br>        }<br><br>        showColor()","like_count":0},{"had_liked":false,"id":79271,"user_name":"ç¬¨é¸Ÿ","can_delete":false,"product_type":"c1","uid":1011000,"ip_address":"","ucode":"EE93B7BDD677E4","user_header":"https://static001.geekbang.org/account/avatar/00/0f/6d/38/c951cb2e.jpg","comment_is_top":false,"comment_ctime":1553420589,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1553420589","product_id":100023201,"comment_content":"with å½±å“åˆ° function ä½œç”¨åŸŸæ˜¯æŒ‡ env çš„å€¼è¢«æ›´æ”¹äº†å§","like_count":0},{"had_liked":false,"id":79024,"user_name":"psaren","can_delete":false,"product_type":"c1","uid":1471497,"ip_address":"","ucode":"E1764DA7BBDB70","user_header":"https://wx.qlogo.cn/mmopen/vi_32/Ab0qA9O310giaLldWw1ibsD8tMNIHzspD0rHYqFkkFodK89zdOgfymSttqBfibM5N3u3Gf6G3unibicKyy96Z2JM1cA/132","comment_is_top":false,"comment_ctime":1553326065,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1553326065","product_id":100023201,"comment_content":"ä¸‹é¢é“¾æ¥æ‰“å¼€codeopen  <br>å¯ä»¥çœ‹åˆ°è¯¦ç»†çš„ HTMLã€CSSã€JSå’Œå®ç°æ•ˆæœ<br>https:&#47;&#47;codepen.io&#47;psaren&#47;pen&#47;RdEzYL<br><br>const light = document.querySelector(&#39;#light&#39;)<br>function sleep(duration) {<br>  return new Promise(function(resolve, reject) {<br>    setTimeout(resolve, duration);<br>  }) <br>}<br>const lightup = async (lighType, duration) =&gt; {<br>  light.className = `light ${lighType}`<br>  await sleep(duration)<br>}<br>const init = async () =&gt; {<br>  while(true){<br>    await lightup(&#39;green&#39;, 3000);<br>    await lightup(&#39;yellow&#39;, 1000);<br>    await lightup(&#39;red&#39;, 2000);<br>  }<br>}<br>init()","like_count":0},{"had_liked":false,"id":78732,"user_name":"..","can_delete":false,"product_type":"c1","uid":1378900,"ip_address":"","ucode":"2054C3A3E90DBD","user_header":"https://static001.geekbang.org/account/avatar/00/15/0a/54/c659cca5.jpg","comment_is_top":false,"comment_ctime":1553225551,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1553225551","product_id":100023201,"comment_content":"function setColor(time , color) {<br>        return new Promise((resolve , reflect) =&gt; {<br>            document.getElementById(&#39;light&#39;).style.background = color;<br>            setTimeout(() =&gt; {<br>                resolve();<br>            }, time)<br>        })<br>    }<br>    async function setLight() {<br>        while (true) {<br>            await setColor(1000 , &#39;green&#39;)<br>            await setColor(2000 , &#39;red&#39;)<br>            await setColor(3000 , &#39;blue&#39;)<br>        }<br>    }<br>    setLight();","like_count":0},{"had_liked":false,"id":78298,"user_name":"Jy","can_delete":false,"product_type":"c1","uid":1027312,"ip_address":"","ucode":"B8D9382C1503E2","user_header":"https://static001.geekbang.org/account/avatar/00/0f/ac/f0/5d52d73e.jpg","comment_is_top":false,"comment_ctime":1553127807,"is_pvip":true,"discussion_count":0,"race_medal":0,"score":"1553127807","product_id":100023201,"comment_content":"ä¸ºä»€ä¹ˆè¦è®¾è®¡micro taskï¼Œæˆ‘çŸ¥é“è¿™æ ·JSå¼•æ“å¯ä»¥è‡ªä¸»åœ°æ‰§è¡Œä»»åŠ¡ï¼Œä½†è¿™æ ·çš„å¥½å¤„æ˜¯ï¼Ÿæé«˜æ€§èƒ½ï¼Ÿ","like_count":0},{"had_liked":false,"id":78219,"user_name":"å‘¨é£","can_delete":false,"product_type":"c1","uid":1073374,"ip_address":"","ucode":"F85FA236EB0C0D","user_header":"https://static001.geekbang.org/account/avatar/00/10/60/de/5c67895a.jpg","comment_is_top":false,"comment_ctime":1553095010,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1553095010","product_id":100023201,"comment_content":"&lt;html&gt;<br>&lt;head&gt;&lt;&#47;head&gt;<br>&lt;body&gt;<br>\t&lt;div id=&quot;light&quot;&gt;&lt;&#47;div&gt;<br>\t&lt;script type=&quot;text&#47;javascript&quot;&gt;<br>\t\tsetColor(&#39;red&#39;);<br>\t\trun()<br>\t\tasync function run(){<br>\t\t   while(1){<br>\t\t\tawait sleep(3000).then(()=&gt;{setColor(&#39;yellow&#39;)});<br>\t\t\tawait sleep(1000).then(()=&gt;{setColor(&#39;green&#39;)});<br>\t\t\tawait sleep(2000).then(()=&gt;{setColor(&#39;red&#39;)});\t\t\t \t\t\t\t<br>\t\t   }<br>\t\t}\t\t<br><br>\t\tfunction setColor(color){\t\t\t<br>\t\t\tdocument.getElementById(&#39;light&#39;).style=`background-color:${color};width:100px;height:100px;border-radius: 50%;`;<br>\t\t}\t<br>\t\tfunction sleep(timeout){<br>\t\t\treturn new Promise(function(resolve,reject){<br>\t\t\t\tsetTimeout(resolve,timeout);<br>\t\t\t})<br>\t\t}\t<br>\t&lt;&#47;script&gt;<br>&lt;&#47;body&gt;<br>\t<br>&lt;&#47;html&gt;","like_count":0},{"had_liked":false,"id":76173,"user_name":"ğŸš‚ğŸš‚ğŸš‚","can_delete":false,"product_type":"c1","uid":1406838,"ip_address":"","ucode":"E4179F2648B296","user_header":"http://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTJByxt4cWqx8Aru7iaOPk2sibeWhwBfES6EKACnN2AvSyFC9DN5ibbWezicd6lA13Siaa3JyYjjSnY9BIg/132","comment_is_top":false,"comment_ctime":1552543517,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1552543517","product_id":100023201,"comment_content":"å“ˆå“ˆ<br><br>function run(color,times){<br>   return setInterval(()=&gt;{<br>      &#47;&#47;change color<br>   },times)<br>}<br>let timerArr = [3000,1000,2000]<br>[&#39;green&#39;,&#39;yellow&#39;,red].forEach(function(color,key){<br>  run(color,timerArr[key])<br>})","like_count":0},{"had_liked":false,"id":75811,"user_name":"zhaizy","can_delete":false,"product_type":"c1","uid":1030249,"ip_address":"","ucode":"F77BF55E2CA57F","user_header":"https://static001.geekbang.org/account/avatar/00/0f/b8/69/bf6fffbe.jpg","comment_is_top":false,"comment_ctime":1552474545,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1552474545","product_id":100023201,"comment_content":"è€å¸ˆï¼Œè¿˜æ˜¯æ²¡æ˜ç™½async awaitçš„å®ç°åŸç†ã€‚æ˜¯å¦è·Ÿgeneratorä¸€æ ·å‘¢ï¼Ÿ","like_count":0},{"had_liked":false,"id":75672,"user_name":"å­é›…","can_delete":false,"product_type":"c1","uid":1011448,"ip_address":"","ucode":"AC0A63406EAA6B","user_header":"https://static001.geekbang.org/account/avatar/00/0f/6e/f8/bc90c8af.jpg","comment_is_top":false,"comment_ctime":1552447565,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1552447565","product_id":100023201,"comment_content":"getResult() {<br>        this.changeColor(&#39;red&#39;)<br>        let green = new Promise((resolve, reject)=&gt;{<br>            setTimeout(resolve, 3000)<br>        })<br>        green.then(()=&gt;{<br>          this.changeColor(&#39;orange&#39;)<br>          let orange = new Promise((resolve, reject)=&gt;{<br>            setTimeout(resolve, 1000)<br>          })<br>          orange.then(()=&gt;{<br>            this.changeColor(&#39;green&#39;)<br>            let red = new Promise((resolve, reject) =&gt;{<br>              setTimeout(resolve,2000)<br>            })<br>            red.then(()=&gt;{<br>              this.getResult()<br>            })<br>          })<br>        })<br>      }<br><br>     changeColor(col) {<br>       this.$refs.lamp.style.backgroundColor = col<br>     }<br><br>     getResult()","like_count":0},{"had_liked":false,"id":74757,"user_name":"undefined","can_delete":false,"product_type":"c1","uid":1378655,"ip_address":"","ucode":"2635757CFCF9EF","user_header":"https://static001.geekbang.org/account/avatar/00/15/09/5f/2937f890.jpg","comment_is_top":false,"comment_ctime":1552292786,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1552292786","product_id":100023201,"comment_content":"const div = document.querySelector(&#39;.div&#39;);<br>const conf = {<br>\tgreen: 3000,<br>\tred: 2000,<br>\tyellow: 1000<br>}<br>\t\t\t<br>function sleep(time, bg){<br>\treturn new Promise((resolve, reject) =&gt; {<br>\t\tdiv.style.backgroundColor = bg;<br>\t\tsetTimeout(() =&gt; {<br>\t\t\tresolve()<br>\t\t}, time)<br>\t})<br>}<br><br>while(true){<br>\tfor(let [key, value] of Object.entries(conf)){<br>\t\tawait sleep(value, key)<br>\t}<br>}","like_count":0},{"had_liked":false,"id":74647,"user_name":"å­˜","can_delete":false,"product_type":"c1","uid":1293900,"ip_address":"","ucode":"66DDE719450B77","user_header":"https://static001.geekbang.org/account/avatar/00/13/be/4c/8d19d90a.jpg","comment_is_top":false,"comment_ctime":1552272245,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1552272245","product_id":100023201,"comment_content":"\t $(function(){<br>\t\t\t \tvar light=document.getElementById(&quot;light&quot;);<br>\t\t\t \t$(light).css(&quot;backgroundColor&quot;,&quot;red&quot;);<br>\t\t\t \tsetInterval(function(){<br>\t\t\t \t\tsetTimeout(function(){<br>\t\t\t \t\t\t$(light).css(&quot;backgroundColor&quot;,&quot;yellow&quot;);<br>\t\t\t \t\t},2000);<br>\t\t\t \t\tsetTimeout(function(){<br>\t\t\t \t\t\t$(light).css(&quot;backgroundColor&quot;,&quot;blue&quot;);<br>\t\t\t \t\t},3000);<br>\t\t\t \t\tsetTimeout(function(){<br>\t\t\t \t\t\t$(light).css(&quot;backgroundColor&quot;,&quot;red&quot;);<br>\t\t\t \t\t},6000);<br>\t\t\t \t},6000);<br>\t\t\t });","like_count":0},{"had_liked":false,"id":74562,"user_name":"å­˜","can_delete":false,"product_type":"c1","uid":1293900,"ip_address":"","ucode":"66DDE719450B77","user_header":"https://static001.geekbang.org/account/avatar/00/13/be/4c/8d19d90a.jpg","comment_is_top":false,"comment_ctime":1552235937,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1552235937","product_id":100023201,"comment_content":"è€å¸ˆæˆ‘å‘ç° <br>setTimeout(()=&gt;console.log(&quot;d&quot;),0);<br>setTimeout(console.log(&quot;d&quot;),0);  çš„æ‰§è¡ŒåŸç†ä¸åŒï¼Œè€å¸ˆèƒ½è§£é‡Šä¸€ä¸‹ å—ï¼Ÿ","like_count":0},{"had_liked":false,"id":74422,"user_name":"withinã€ƒ","can_delete":false,"product_type":"c1","uid":1451554,"ip_address":"","ucode":"8F2219F0DC463C","user_header":"https://static001.geekbang.org/account/avatar/00/16/26/22/f826d202.jpg","comment_is_top":false,"comment_ctime":1552222535,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1552222535","product_id":100023201,"comment_content":"function sleep (duration) {<br>  return new Promise((resolve) =&gt; {<br>    setTimeout(resolve, duration)<br>  })<br>}<br><br>function changeDivColor (color) {<br>  document.querySelector(&#39;div&#39;).style.backgroundColor = color<br>}<br><br>async function asyncChangeDivColor (duration, color) {<br>  await sleep(duration)<br>  changeDivColor(color)<br>}<br><br>async function loopMain () {<br>  while (true) {<br>    await asyncChangeDivColor(1000, &#39;red&#39;)<br>    await asyncChangeDivColor(1000, &#39;yellow&#39;)<br>    await asyncChangeDivColor(1000, &#39;black&#39;)<br>  }<br>}<br><br>try {<br>  loopMain()<br>} catch (e) {<br>  errHandler(e)<br>}<br><br>function errHandler (err) {<br>  console.log(err)<br>}","like_count":0},{"had_liked":false,"id":74030,"user_name":"å¤§æ ‘","can_delete":false,"product_type":"c1","uid":1390549,"ip_address":"","ucode":"0B4C9091520DFA","user_header":"https://static001.geekbang.org/account/avatar/00/15/37/d5/22299804.jpg","comment_is_top":false,"comment_ctime":1552089423,"is_pvip":false,"discussion_count":0,"race_medal":1,"score":"1552089423","product_id":100023201,"comment_content":"function f2() { };<br><br>var f3 = new Function(&#39;console.log(typeof f2);&#39;)<br>f3(); &#47;&#47; &#39;undefined&#39;<br><br>var f3 = function () { console.log(typeof f2); }<br>f3();&#47;&#47; &#39;function&#39;","like_count":0},{"had_liked":false,"id":73800,"user_name":"æ¨æ–Œ","can_delete":false,"product_type":"c1","uid":1382239,"ip_address":"","ucode":"AE5ACF205E7CD7","user_header":"https://static001.geekbang.org/account/avatar/00/15/17/5f/1911049c.jpg","comment_is_top":false,"comment_ctime":1552004566,"is_pvip":false,"discussion_count":1,"race_medal":0,"score":"1552004566","product_id":100023201,"comment_content":"æˆ‘å…³å¿ƒçš„æ˜¯ ä¸ºä»€ä¹ˆä¼šæœ‰promise asyncè¿™ç§ç»“æ„çš„å‡ºç°ï¼Œå…·ä½“å¸¦æ¥äº†ä»€ä¹ˆä¼˜åŠ¿ï¼Œè¿™ä¸ªç‚¹å¥½åƒç¨¿å­ä¸­æ²¡æåˆ°","like_count":0,"discussions":[{"author":{"id":1379378,"avatar":"https://static001.geekbang.org/account/avatar/00/15/0c/32/e0178185.jpg","nickname":"youngleish","note":"","ucode":"A1FEEEBBD3D18B","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":303108,"discussion_content":"è¿™ä¸ªå¯ä»¥å»çœ‹ä½ ä¸çŸ¥é“çš„JSä¸­å·","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1599143265,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":73570,"user_name":"è¥¿ç“œç‚’æ¨æ¢…","can_delete":false,"product_type":"c1","uid":1374870,"ip_address":"","ucode":"41ED188AFC7299","user_header":"http://thirdwx.qlogo.cn/mmopen/vi_32/8YDz4aIA1oIVUEttAgWicDA9adEFBbEibykia2A4ajm6Jhj7CZiadIO63hnUeZR4zZGLibxPWHiaF322DehKLvXcEt3A/132","comment_is_top":false,"comment_ctime":1551927188,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1551927188","product_id":100023201,"comment_content":"æœ‰ä¸ªé—®é¢˜æ²¡ç†è§£ï¼Œ<br>\t\tfunction sleep(duration) {<br>\t\t\treturn new Promise(function(resolve,reject) {<br>\t\t\t\tsetTimeout(resolve,duration);<br>\t\t\t})<br>\t\t}<br>\t\tasync function change(time,color) {<br>\t\t\tdiv.style.backgroundColor = color;<br>\t\t\tawait sleep(time);<br>\t\t}<br>\t\tasync function foo2() {<br>\t\t\t\tawait change(2000,&#39;green&#39;)<br>\t\t\t\tawait change(1500,&#39;yellow&#39;)<br>\t\t\t\tawait change(1000,&#39;red&#39;)<br>\t\t}<br><br>\t\twhile(true) {<br>\t\t\tfoo2()<br>\t        }<br>å¦‚æ³¨é‡Šï¼Œä¸ºä»€ä¹ˆæˆ‘whileå†™åœ¨å¤–é¢ä¸è¡Œå‘¢","like_count":0},{"had_liked":false,"id":73560,"user_name":"å¦‚æ–¯","can_delete":false,"product_type":"c1","uid":1393087,"ip_address":"","ucode":"62A6244C4717D0","user_header":"https://static001.geekbang.org/account/avatar/00/15/41/bf/3afa1344.jpg","comment_is_top":false,"comment_ctime":1551926323,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1551926323","product_id":100023201,"comment_content":"let transLamp = ( function(){<br>        let pos = 0, <br>            lightObjArr = [<br>                {<br>                    color: &#39;green&#39;,<br>                    time: 3000<br>                }, {<br>                    color: &#39;yellow&#39;,<br>                    time: 1000<br>                }, {<br>                    color: &#39;red&#39;,<br>                    time: 2000<br>                }<br>            ]<br>        <br>        function sleep(duration) {<br>            return new Promise( function (resolve, reject) {<br>                setTimeout(resolve, duration)<br>            })<br>        }<br>        function colorFn (color) {<br>            console.log(color)<br>        }<br><br>        return function light({color=&#39;green&#39;, time=3000}={}) {<br>            colorFn(color)<br>            sleep(time).then(function() {<br>                pos += 1<br>                return light(lightObjArr[pos % 3])<br>            })<br>        }<br>    }())<br>transLamp()<br>","like_count":0},{"had_liked":false,"id":73545,"user_name":"kovar","can_delete":false,"product_type":"c1","uid":1384697,"ip_address":"","ucode":"A9A6C929FF4BCC","user_header":"","comment_is_top":false,"comment_ctime":1551922767,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1551922767","product_id":100023201,"comment_content":"é‚£ä¹ˆanimation frameçš„æ›´æ–°æ˜¯åœ¨å“ªä¸ªæ—¶é—´ç‚¹å‘¢?æˆ‘é‡åˆ°è¿‡setTimeoutå’ŒrequestAnimationFrameæ‰§è¡Œé¡ºåºé—®é¢˜","like_count":0},{"had_liked":false,"id":73360,"user_name":"[å·²é‡ç½®]","can_delete":false,"product_type":"c1","uid":1380263,"ip_address":"","ucode":"7CE91D63AD9481","user_header":"https://static001.geekbang.org/account/avatar/00/15/0f/a7/783e4f88.jpg","comment_is_top":false,"comment_ctime":1551867806,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1551867806","product_id":100023201,"comment_content":"https:&#47;&#47;www.jianshu.com&#47;p&#47;12b9f73c5a4f æ¨èä¸€ä¸‹è¿™ä¸ªå†™çš„æ¯”è¾ƒè¯¦ç»†","like_count":0},{"had_liked":false,"id":73213,"user_name":"uNeedSweetDouble","can_delete":false,"product_type":"c1","uid":1389442,"ip_address":"","ucode":"A2258F4AAD6924","user_header":"https://static001.geekbang.org/account/avatar/00/15/33/82/5bb2bacc.jpg","comment_is_top":false,"comment_ctime":1551841227,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1551841227","product_id":100023201,"comment_content":"è€å¸ˆ, æ€ä¹ˆåˆ¤æ–­æ˜¯æœ‰å‡ ä¸ªå®ä»»åŠ¡å‘¢","like_count":0},{"had_liked":false,"id":72969,"user_name":"å‘¨æ˜æ°","can_delete":false,"product_type":"c1","uid":1229939,"ip_address":"","ucode":"EBD72A6D9EA4A9","user_header":"https://static001.geekbang.org/account/avatar/00/12/c4/73/cd06e186.jpg","comment_is_top":false,"comment_ctime":1551767453,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1551767453","product_id":100023201,"comment_content":"function changeColor(color, times) {<br>  return new Promise(function(resolve, reject){<br>    setTimeout(function(){<br>      document.getElementsByTagName(&#39;div&#39;)[0].style.backgroundColor = color;<br>      resolve();<br>    },times)<br>  })<br>}<br>async function loop() {<br>  while(true){<br>    await changeColor(&#39;green&#39;, 3000);<br>    await changeColor(&#39;yellow&#39;, 2000);<br>    await changeColor(&#39;red&#39;, 1000);<br>  }<br>}<br>loop();<br>","like_count":0},{"had_liked":false,"id":72779,"user_name":"æ¢¦è‹¥æ™¨æ›¦","can_delete":false,"product_type":"c1","uid":1298887,"ip_address":"","ucode":"046F4768C8EE1E","user_header":"https://static001.geekbang.org/account/avatar/00/13/d1/c7/68ba1061.jpg","comment_is_top":false,"comment_ctime":1551715846,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1551715846","product_id":100023201,"comment_content":"        const node = document.getElementById(&#39;light&#39;)<br>        function changeBgCol(color, duration) {<br>            return new Promise((resolve, reject) =&gt; {<br>                node.style.background = color;<br>                setTimeout(resolve, duration)<br>            })<br>        }<br>        async function main() {<br>            while(true) {<br>                await changeBgCol(&#39;#009688&#39;, 3000)<br>                await changeBgCol(&#39;#ffeb3b&#39;, 1000)<br>                await changeBgCol(&#39;#f44336&#39;, 3000)<br>            }<br>        }<br>        main()","like_count":0},{"had_liked":false,"id":72233,"user_name":"TY","can_delete":false,"product_type":"c1","uid":1042575,"ip_address":"","ucode":"DCCD035EAF5686","user_header":"http://thirdwx.qlogo.cn/mmopen/vi_32/nD10dsXDZ07WyBbqheDtflyxqaR7QsuznhEgtTia0Pticf5fSjQhgSKUUTbibBozY5h2QAD0oYoBCNbvLGpHVeTow/132","comment_is_top":false,"comment_ctime":1551537871,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1551537871","product_id":100023201,"comment_content":"await ç›¸å½“äºå†™ä¸€ä¸ª then ç„¶åæŠŠå®ƒåº•ä¸‹æ‰€æœ‰çš„ä»£ç å…¨éƒ¨åŒ…è¿›å», ç„¶åæŠŠåŸå…ˆåµŒå¥—çš„ catch ç»™å…¨éƒ¨å¹³çº§äº†, ç„¶è€Œ await åªèƒ½åœ¨ async çš„ function é‡Œé¢è¿™ä¸€ç‰¹æ€§å¯¼è‡´æ€»ä¼šæœ‰ä¸€ä¸ª then åœ¨æœ€å¤–é¢æˆ–è€…è®©æœ€å¤–é¢è°ƒç”¨çš„ async å‡½æ•°ä¸è¿”å›å€¼ä¹Ÿå¤„ç†å¥½å¼‚å¸¸(è®© resolve å’Œ reject å˜å¾—æ²¡æœ‰æ„ä¹‰), æ‰¾äº†ç‚¹ä¸œè¥¿çœ‹å’Œè‡ªå·±éªŒè¯äº†ä¸€ä¸‹(ä¸€ä¸ªä»Šæ—¥å¤´æ¡çš„é¢è¯•é¢˜), ä¸åŒçš„ chrome ç‰ˆæœ¬è¾“å‡ºçš„é¡ºåºè¿˜ä¸ä¸€æ ·<br><br>è€å®è¯´, è™½ç„¶æƒ³ä¸å‡ºæ¥ä»€ä¹ˆå¥½çš„åŠæ³•, ä½†æ˜¯æ€»è§‰å¾—ç°åœ¨è¿™ä¸ª await è§£å†³æ–¹æ¡ˆå¸¦æ¥çš„è¿™ä¸ªä»»åŠ¡é˜Ÿåˆ—, è·Ÿ go é‡Œé¢çš„ defer æœ‰ç‚¹åƒ, æˆ‘ä¸ªäººè§‰å¾—å®ƒä»¬å¸¦æ¥çš„é—®é¢˜æ¯”å®ƒä»¬æƒ³è¦è§£å†³çš„é—®é¢˜è¿˜è¦å¤š","like_count":0},{"had_liked":false,"id":72176,"user_name":"TY","can_delete":false,"product_type":"c1","uid":1042575,"ip_address":"","ucode":"DCCD035EAF5686","user_header":"http://thirdwx.qlogo.cn/mmopen/vi_32/nD10dsXDZ07WyBbqheDtflyxqaR7QsuznhEgtTia0Pticf5fSjQhgSKUUTbibBozY5h2QAD0oYoBCNbvLGpHVeTow/132","comment_is_top":false,"comment_ctime":1551531565,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1551531565","product_id":100023201,"comment_content":"å¯¹äºä¸€ä¸ªé js çš„ coder å¯¹è¿™ç¯‡ç†è§£èµ·æ¥å¥½è´¹åŠ², ä¸æ˜¯è¯´åŠ äº† async çš„ function è¿”å›çš„æ˜¯éšå¼çš„ Promise ä¹ˆ, æ–¹æ³•çš„è¿”å›ä¼šè¢«å°è£…æˆ resolve, ç†è§£äº†åŠå¤©, æˆ‘è¿˜æ˜¯è§‰å¾—åœ¨ sleep é‡Œé¢çš„ setTimeout é‚£é‡Œæ²¡åŠæ³•ç”¨ async, å¿…é¡»ç”¨ Promise, ç»“æœå¯¼è‡´ä¸¤ç§æ–¹å¼ä½ ä¸­æœ‰æˆ‘æˆ‘ä¸­æœ‰ä½ , æ€ç»´åˆ‡æ¢äº†å¥½å¤šæ¬¡, ä¸æ˜¯å¾ˆæ‡‚è¿™ä¸ªç‰¹æ€§çš„æ„ä¹‰åœ¨å“ª, è²Œä¼¼åœ¨ js åœˆæ˜¯ä¸€ä¸ªå¾ˆå‰å®³çš„ä¸œè¥¿","like_count":0},{"had_liked":false,"id":72069,"user_name":"Vincent W","can_delete":false,"product_type":"c1","uid":1015794,"ip_address":"","ucode":"F4F839466FDB76","user_header":"https://static001.geekbang.org/account/avatar/00/0f/7f/f2/a9b71207.jpg","comment_is_top":false,"comment_ctime":1551512818,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1551512818","product_id":100023201,"comment_content":"async function fn1() {<br>    console.log(1)<br>    await console.log(2)<br>    console.log(3)<br>}<br><br>fn1()<br><br>new Promise((resolve, reject) =&gt; {<br>    console.log(1)<br>    resolve()<br>}).then(data =&gt;  console.log(4))<br><br>è€å¸ˆ await åé¢çš„ çš„ console.log(3) å’Œ then ä¸­çš„console.log(4) æ‰§è¡Œé¡ºåºè¯¥æ€ä¹ˆåˆ†æ","like_count":0},{"had_liked":false,"id":71785,"user_name":"é£å¹ä¸€ä¸ªå¤§è€³ä¸œ","can_delete":false,"product_type":"c1","uid":1393383,"ip_address":"","ucode":"53918AD171F5C5","user_header":"https://static001.geekbang.org/account/avatar/00/15/42/e7/e5afadf7.jpg","comment_is_top":false,"comment_ctime":1551432203,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1551432203","product_id":100023201,"comment_content":"è€å¸ˆè¯´æˆ‘åªè·‘ä¸€æ¬¡ï¼Œç°åœ¨åŠ ä¸Šå¾ªç¯<br>function light(time,color) {<br>\treturn new Promise(function(resolve,reject) {<br>\t\tsetTimeout(()=&gt;{<br>\t\t\tresolve();console.log(color);<br>\t\t},time)<br>\t})<br>}<br>async function run() {<br>\tawait light(3000, &#39;green&#39;)<br>\tawait light(1000, &#39;red&#39;)<br>\tawait light(2000, &#39;yellow&#39;)<br>}<br><br>while(true) {<br>\tawait run()<br>}","like_count":0},{"had_liked":false,"id":70705,"user_name":"MarlboroKay","can_delete":false,"product_type":"c1","uid":1099304,"ip_address":"","ucode":"3F6B5861795A61","user_header":"https://static001.geekbang.org/account/avatar/00/10/c6/28/d6f49ec2.jpg","comment_is_top":false,"comment_ctime":1551167432,"is_pvip":false,"replies":[{"id":"25920","content":"ç”¨äº† await å°±ä¸è¦thenäº†å•Šã€‚","user_name":"ä½œè€…å›å¤","user_name_real":"winter","uid":"1268524","ctime":1551432261,"ip_address":"","comment_id":70705,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1551167432","product_id":100023201,"comment_content":"function main(duration,color){<br>\t\t\treturn new Promise(function(resolve,reject){<br>\t\t\t\tsetTimeout(resolve,duration)<br>\t\t\t});<br>\t\t}<br>\t\tfunction changeColor(color){<br>\t\t\tvar lamp = document.getElementById(&#39;#lapm&#39;);<br>\t\t\tlapm.style.backgroundColor = color;<br>\t\t}<br><br>\t\tasync function change(){<br>\t\t\tawait main(3000).then(()=&gt;changeColor(&#39;yellow&#39;));<br>\t\t\tawait main(1000).then(()=&gt;changeColor(&#39;red&#39;));<br>\t\t\tawait main(2000).then(()=&gt;changeColor(&#39;green&#39;));<br>\t\t\treturn change();<br>\t\t}<br>\t\tchange();<br>PS:æ‰§è¡Œè€—æ—¶1ç§’çš„Promis ä»£ç æ®µç¬¬5è¡Œï¼šåº”è¯¥æ˜¯ r1.then(...)","like_count":0,"discussions":[{"author":{"id":1268524,"avatar":"https://static001.geekbang.org/account/avatar/00/13/5b/2c/12bfd3cd.jpg","nickname":"winter","note":"","ucode":"2B068EDEAFEB56","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":440785,"discussion_content":"ç”¨äº† await å°±ä¸è¦thenäº†å•Šã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1551432261,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":70297,"user_name":"å‘¨å°æˆ","can_delete":false,"product_type":"c1","uid":1229260,"ip_address":"","ucode":"5B47835DE09E1A","user_header":"https://static001.geekbang.org/account/avatar/00/12/c1/cc/6b6bbd41.jpg","comment_is_top":false,"comment_ctime":1551066259,"is_pvip":false,"replies":[{"id":"25077","content":"è°¢è°¢ä½ çš„æç¤ºï¼Œæˆ‘ä»¬é—®é—®è€å¸ˆå“ˆ","user_name":"ç¼–è¾‘å›å¤","user_name_real":"é©¬è¶Š","uid":"1003953","ctime":1551068516,"ip_address":"","comment_id":70297,"utype":2}],"discussion_count":1,"race_medal":0,"score":"1551066259","product_id":100023201,"comment_content":"è®²çš„å¾ˆé€šä¿—æ˜“æ‡‚ï¼Œè®¤è¯†æ›´æ¸…æ™°äº†ã€‚æ‰§è¡Œè€—æ—¶1ç§’çš„Promiseé‚£é‡Œçš„ä»£ç æœ‰äº›å°é—®é¢˜å“¦ï¼Œr.thenåº”è¯¥æ”¹æˆr1.then","like_count":0,"discussions":[{"author":{"id":1003953,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/51/b1/7d6879dc.jpg","nickname":"æœªè®¾ç½®","note":"","ucode":"9DFC368CA29EDC","race_medal":0,"user_type":4,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":440551,"discussion_content":"è°¢è°¢ä½ çš„æç¤ºï¼Œæˆ‘ä»¬é—®é—®è€å¸ˆå“ˆ","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1551068516,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":4}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":70270,"user_name":"é£å¹ä¸€ä¸ªå¤§è€³ä¸œ","can_delete":false,"product_type":"c1","uid":1393383,"ip_address":"","ucode":"53918AD171F5C5","user_header":"https://static001.geekbang.org/account/avatar/00/15/42/e7/e5afadf7.jpg","comment_is_top":false,"comment_ctime":1551062023,"is_pvip":false,"replies":[{"id":"25915","content":"ä½ è¿™ä¸ªåªæœ‰ä¸€éå•Š  çº¢ç»¿ç¯è¿™æ ·å¯ä¸è¡Œ","user_name":"ä½œè€…å›å¤","user_name_real":"winter","uid":"1268524","ctime":1551431715,"ip_address":"","comment_id":70270,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1551062023","product_id":100023201,"comment_content":"function light(time, color) {<br>\treturn new Promise(function(resolve,reject) {<br>\t\tsetTimeout(()=&gt; {<br>\t\t\tresolve();<br>\t\t\tconsole.log(color)<br>\t\t}, time)<br>    })<br>}<br><br>async function run() {<br>\tawait light(3000, &#39;green&#39;)<br>\tawait light(1000, &#39;red&#39;)<br>\tawait light(2000, &#39;yellow&#39;)<br>}<br><br>run()","like_count":0,"discussions":[{"author":{"id":1268524,"avatar":"https://static001.geekbang.org/account/avatar/00/13/5b/2c/12bfd3cd.jpg","nickname":"winter","note":"","ucode":"2B068EDEAFEB56","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":440534,"discussion_content":"ä½ è¿™ä¸ªåªæœ‰ä¸€éå•Š  çº¢ç»¿ç¯è¿™æ ·å¯ä¸è¡Œ","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1551431715,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":70090,"user_name":"xlm","can_delete":false,"product_type":"c1","uid":1382463,"ip_address":"","ucode":"DF8CA3B2F676D8","user_header":"https://static001.geekbang.org/account/avatar/00/15/18/3f/93e02812.jpg","comment_is_top":false,"comment_ctime":1550993358,"is_pvip":false,"replies":[{"id":"25848","content":"generator å’Œ async æ˜¯ä½¿ç”¨äº†ä¸€ç»„å…±åŒåŸºç¡€è®¾æ–½çš„ä¸¤ç§å®Œå…¨ä¸åŒä½œç”¨çš„å‡½æ•°ã€‚","user_name":"ä½œè€…å›å¤","user_name_real":"winter","uid":"1268524","ctime":1551425781,"ip_address":"","comment_id":70090,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1550993358","product_id":100023201,"comment_content":"async&#47;awaitçš„å®ç°åŸç†æ˜¯Generator +Promiseçš„è¯­æ³•ç³–ğŸ˜³ ï¼Ÿ","like_count":0,"discussions":[{"author":{"id":1268524,"avatar":"https://static001.geekbang.org/account/avatar/00/13/5b/2c/12bfd3cd.jpg","nickname":"winter","note":"","ucode":"2B068EDEAFEB56","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":440434,"discussion_content":"generator å’Œ async æ˜¯ä½¿ç”¨äº†ä¸€ç»„å…±åŒåŸºç¡€è®¾æ–½çš„ä¸¤ç§å®Œå…¨ä¸åŒä½œç”¨çš„å‡½æ•°ã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1551425781,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":70088,"user_name":"AICC","can_delete":false,"product_type":"c1","uid":1020746,"ip_address":"","ucode":"C1D18B1E8B2DCE","user_header":"https://static001.geekbang.org/account/avatar/00/0f/93/4a/de82f373.jpg","comment_is_top":false,"comment_ctime":1550992790,"is_pvip":false,"replies":[{"id":"25847","content":"å“ˆå“ˆ è¿™ä¸ªå†™é”™äº†<br><br>å‰é¢éƒ½å¾ˆå¥½ï¼Œå¯æƒœè°ƒç”¨çš„æ—¶å€™å‡ºäº†é”™ã€‚","user_name":"ä½œè€…å›å¤","user_name_real":"winter","uid":"1268524","ctime":1551425709,"ip_address":"","comment_id":70088,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1550992790","product_id":100023201,"comment_content":"function sleep(duration) {<br>  return new Promise(function(resolve, reject) {<br>      setTimeout(resolve,duration);<br>  })<br>}<br>async function foo(duration,name){<br>  console.log(name)<br>  await sleep(duration)<br>}<br>async function foo2(){<br>  await foo(3000,&quot;ç»¿&quot;);<br>  await foo(1000,&quot;é»„&quot;);<br>  await foo(2000,&quot;çº¢&quot;);<br>}<br><br>while(true) {<br>  foo2()<br>}","like_count":0,"discussions":[{"author":{"id":1268524,"avatar":"https://static001.geekbang.org/account/avatar/00/13/5b/2c/12bfd3cd.jpg","nickname":"winter","note":"","ucode":"2B068EDEAFEB56","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":440433,"discussion_content":"å“ˆå“ˆ è¿™ä¸ªå†™é”™äº†\n\nå‰é¢éƒ½å¾ˆå¥½ï¼Œå¯æƒœè°ƒç”¨çš„æ—¶å€™å‡ºäº†é”™ã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1551425709,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]}]}