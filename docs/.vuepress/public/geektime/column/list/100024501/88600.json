{"id":88600,"title":"12 | iOS 崩溃千奇百怪，如何全面监控？","content":"<p>你好，我是戴铭。今天我要跟你说的是崩溃监控。</p><p>App上线后，我们最怕出现的情况就是应用崩溃了。但是，我们线下测试好好的App，为什么上线后就发生崩溃了呢？这些崩溃日志信息是怎么采集的？能够采集的全吗？采集后又要怎么分析、解决呢？</p><p>接下来，通过今天这篇文章，<strong>你就可以了解到造成崩溃的情况有哪些，以及这些崩溃的日志都是如何捕获收集到的。</strong></p><p>App 上线后，是很脆弱的，导致其崩溃的问题，不仅包括编写代码时的各种小马虎，还包括那些被系统强杀的疑难杂症。</p><p>下面，我们就先看看几个常见的编写代码时的小马虎，是如何让应用崩溃的。</p><ul>\n<li>数组越界：在取数据索引时越界，App会发生崩溃。还有一种情况，就是给数组添加了 nil 会崩溃。</li>\n<li>多线程问题：在子线程中进行 UI 更新可能会发生崩溃。多个线程进行数据的读取操作，因为处理时机不一致，比如有一个线程在置空数据的同时另一个线程在读取这个数据，可能会出现崩溃情况。</li>\n<li>主线程无响应：如果主线程超过系统规定的时间无响应，就会被 Watchdog 杀掉。这时，崩溃问题对应的异常编码是0x8badf00d。关于这个异常编码，我还会在后文和你说明。</li>\n<li>野指针：指针指向一个已删除的对象访问内存区域时，会出现野指针崩溃。野指针问题是需要我们重点关注的，因为它是导致App崩溃的最常见，也是最难定位的一种情况。关于野指针等内存相关问题，我会在第14篇文章“临近 OOM，如何获取详细内存分配信息，分析内存问题？”里和你详细说明。</li>\n</ul><!-- [[[read_end]]] --><p>程序崩溃了，你的 App 就不可用了，对用户的伤害也是最大的。因此，每家公司都会非常重视自家产品的崩溃率，并且会将崩溃率（也就是一段时间内崩溃次数与启动次数之比）作为优先级最高的技术指标，比如千分位是生死线，万分位是达标线等，去衡量一个App的高可用性。</p><p>而崩溃率等技术指标，一般都是由崩溃监控系统来搜集。同时，崩溃监控系统收集到的堆栈信息，也为解决崩溃问题提供了最重要的信息。</p><p>但是，崩溃信息的收集却并没有那么简单。因为，有些崩溃日志是可以通过信号捕获到的，而很多崩溃日志却是通过信号捕获不到的。</p><p>你可以看一下下面这幅图，我列出了常见的部分崩溃情况：</p><p><img src=\"https://static001.geekbang.org/resource/image/f9/fe/f97dda3b49351f74747dd74128a0ddfe.png?wh=2732*2048\" alt=\"\"></p><center><span class=\"reference\">图1 常见的部分崩溃情况分类</span></center><p>通过这张图片，我们可以看到， KVO问题、NSNotification 线程问题、数组越界、野指针等崩溃信息，是可以通过信号捕获的。但是，像后台任务超时、内存被打爆、主线程卡顿超阈值等信息，是无法通过信号捕捉到的。</p><p>但是，只有捕获到所有崩溃的情况，我们才能实现崩溃的全面监控。也就是说，只有先发现了问题，然后才能够分析问题，最后解决问题。接下来，我就一起分析下如何捕获到这两类崩溃信息。</p><h2>我们先来看看信号可捕获的崩溃日志收集</h2><p>收集崩溃日志最简单的方法，就是打开 Xcode 的菜单选择 Product -&gt; Archive。如下图所示：</p><p><img src=\"https://static001.geekbang.org/resource/image/bb/86/bbabfbe28cf3bbd2bfb38d6396b28886.png?wh=1604*666\" alt=\"\"></p><center><span class=\"reference\">图2 收集崩溃日志最简单的方法</span></center><p>然后，在提交时选上“Upload your app’s symbols to receive symbolicated reports from Apple”，以后你就可以直接在 Xcode 的 Archive 里看到符号化后的崩溃日志了。</p><p>但是这种查看日志的方式，每次都是纯手工的操作，而且时效性较差。所以，目前很多公司的崩溃日志监控系统，都是通过<a href=\"https://www.plcrashreporter.org/\">PLCrashReporter</a> 这样的第三方开源库捕获崩溃日志，然后上传到自己服务器上进行整体监控的。</p><p>而没有服务端开发能力，或者对数据不敏感的公司，则会直接使用 <a href=\"https://get.fabric.io/\">Fabric</a>或者<a href=\"https://bugly.qq.com/v2/\">Bugly</a>来监控崩溃。</p><p>你可能纳闷了：PLCrashReporter 和 Bugly这类工具，是怎么知道 App 什么时候崩溃的？接下来，我就和你详细分析下。</p><p>在崩溃日志里，你经常会看到下面这段说明：</p><pre><code>Exception Type:        EXC_BAD_ACCESS (SIGSEGV)\n</code></pre><p>它表示的是，EXC_BAD_ACCESS 这个异常会通过 SIGSEGV 信号发现有问题的线程。虽然信号的种类有很多，但是都可以通过注册 signalHandler 来捕获到。其实现代码，如下所示：</p><pre><code>void registerSignalHandler(void) {\n    signal(SIGSEGV, handleSignalException);\n    signal(SIGFPE, handleSignalException);\n    signal(SIGBUS, handleSignalException);\n    signal(SIGPIPE, handleSignalException);\n    signal(SIGHUP, handleSignalException);\n    signal(SIGINT, handleSignalException);\n    signal(SIGQUIT, handleSignalException);\n    signal(SIGABRT, handleSignalException);\n    signal(SIGILL, handleSignalException);\n}\n\nvoid handleSignalException(int signal) {\n    NSMutableString *crashString = [[NSMutableString alloc]init];\n    void* callstack[128];\n    int i, frames = backtrace(callstack, 128);\n    char** traceChar = backtrace_symbols(callstack, frames);\n    for (i = 0; i &lt;frames; ++i) {\n        [crashString appendFormat:@&quot;%s\\n&quot;, traceChar[i]];\n    }\n    NSLog(crashString);\n}\n</code></pre><p>上面这段代码对各种信号都进行了注册，捕获到异常信号后，在处理方法 handleSignalException 里通过 backtrace_symbols 方法就能获取到当前的堆栈信息。堆栈信息可以先保存在本地，下次启动时再上传到崩溃监控服务器就可以了。</p><p>先将捕获到的堆栈信息保存在本地，是为了实现堆栈信息数据的持久化存储。那么，为什么要实现持久化存储呢？</p><p>这是因为，在保存完这些堆栈信息以后，App 就崩溃了，崩溃后内存里的数据也就都没有了。而将数据保存在本地磁盘中，就可以在App下次启动时能够很方便地读取到这些信息。</p><h2>信号捕获不到的崩溃信息怎么收集？</h2><p>你是不是经常会遇到这么一种情况，App 退到后台后，即使代码逻辑没有问题也很容易出现崩溃。而且，这些崩溃往往是因为系统强制杀掉了某些进程导致的，而系统强杀抛出的信号还由于系统限制无法被捕获到。</p><p>一般，在退后台时你都会把关键业务数据保存在内存中，如果保存过程中出现了崩溃就会丢失或损坏关键数据，进而数据损坏又会导致应用不可用。这种关键数据的损坏会给用户带来巨大的损失。</p><p>那么，后台容易崩溃的原因是什么呢？如何避免后台崩溃？怎么去收集后台信号捕获不到的那些崩溃信息呢？还有哪些信号捕获不到的崩溃情况？怎样监控其他无法通过信号捕获的崩溃信息？</p><p>现在，你就带着这五个问题，继续听我说。</p><p>首先，我们来看第一个问题，<strong>后台容易崩溃的原因是什么？</strong></p><p>这里，我先介绍下 iOS 后台保活的5种方式：Background Mode、Background Fetch、Silent Push、PushKit、Background Task。</p><ul>\n<li>使用 Background Mode方式的话，App Store在审核时会提高对App 的要求。通常情况下，只有那些地图、音乐播放、VoIP 类的 App 才能通过审核。</li>\n<li>Background Fetch方式的唤醒时间不稳定，而且用户可以在系统里设置关闭这种方式，导致它的使用场景很少。</li>\n<li>Silent Push 是推送的一种，会在后台唤起 App 30秒。它的优先级很低，会调用 application:didReceiveRemoteNotifiacation:fetchCompletionHandler: 这个 delegate，和普通的 remote push notification 推送调用的 delegate 是一样的。</li>\n<li>PushKit 后台唤醒 App 后能够保活30秒。它主要用于提升 VoIP 应用的体验。</li>\n<li>Background Task 方式，是使用最多的。App 退后台后，默认都会使用这种方式。</li>\n</ul><p>接下来，我们就看一下，<strong>Background Task 方式为什么是使用最多的，它可以解决哪些问题？</strong></p><p>在你的程序退到后台以后，只有几秒钟的时间可以执行代码，接下来就会被系统挂起。进程挂起后所有线程都会暂停，不管这个线程是文件读写还是内存读写都会被暂停。但是，数据读写过程无法暂停只能被中断，中断时数据读写异常而且容易损坏文件，所以系统会选择主动杀掉 App 进程。</p><p>而Background Task这种方式，就是系统提供了 beginBackgroundTaskWithExpirationHandler 方法来延长后台执行时间，可以解决你退后台后还需要一些时间去处理一些任务的诉求。</p><p>Background Task 方式的使用方法，如下面这段代码所示：</p><pre><code>- (void)applicationDidEnterBackground:(UIApplication *)application {\n    self.backgroundTaskIdentifier = [application beginBackgroundTaskWithExpirationHandler:^( void) {\n        [self yourTask];\n    }];\n}\n</code></pre><p>在这段代码中，yourTask 任务最多执行3分钟，3分钟内 yourTask 运行完成，你的 App 就会挂起。 如果 yourTask 在3分钟之内没有执行完的话，系统会强制杀掉进程，从而造成崩溃，这就是为什么App退后台容易出现崩溃的原因。</p><p>后台崩溃造成的影响是未知的。持久化存储的数据出现了问题，就会造成你的 App 无法正常使用。</p><p>接下来，我们再看看第二个问题：<strong>如何避免后台崩溃呢？</strong></p><p>你知道了， App 退后台后，如果执行时间过长就会导致被系统杀掉。那么，如果我们要想避免这种崩溃发生的话，就需要严格控制后台数据的读写操作。比如，你可以先判断需要处理的数据的大小，如果数据过大，也就是在后台限制时间内或延长后台执行时间后也处理不完的话，可以考虑在程序下次启动或后台唤醒时再进行处理。</p><p>同时，App退后台后，这种由于在规定时间内没有处理完而被系统强制杀掉的崩溃，是无法通过信号被捕获到的。这也说明了，随着团队规模扩大，要想保证 App 高可用的话，后台崩溃的监控就尤为重要了。</p><p>那么，我们又应该<strong>怎么去收集退后台后超过保活阈值而导致信号捕获不到的那些崩溃信息呢？</strong></p><p>采用Background Task方式时，我们可以根据 beginBackgroundTaskWithExpirationHandler 会让后台保活3分钟这个阈值，先设置一个计时器，在接近3分钟时判断后台程序是否还在执行。如果还在执行的话，我们就可以判断该程序即将后台崩溃，进行上报、记录，以达到监控的效果。</p><p><strong>还有哪些信号捕获不到的崩溃情况？怎样监控其他无法通过信号捕获的崩溃信息？</strong></p><p>其他捕获不到的崩溃情况还有很多，主要就是内存打爆和主线程卡顿时间超过阈值被 watchdog 杀掉这两种情况。</p><p>其实，监控这两类崩溃的思路和监控后台崩溃类似，我们都先要找到它们的阈值，然后在临近阈值时还在执行的后台程序，判断为将要崩溃，收集信息并上报。</p><blockquote>\n<p>备注：关于内存和卡顿阈值是怎么获取的，我会在第13篇文章“如何利用 RunLoop 原理去监控卡顿？”，以及第14篇文章“临近 OOM，如何获取详细内存分配信息，分析内存问题？”中和你详细说明。</p>\n</blockquote><p>对于内存打爆信息的收集，你可以采用内存映射（mmap）的方式来保存现场。主线程卡顿时间超过阈值这种情况，你只要收集当前线程的堆栈信息就可以了。</p><h2>采集到崩溃信息后如何分析并解决崩溃问题呢？</h2><p>通过上面的内容，我们已经解决了崩溃信息采集的问题。现在，我们需要对这些信息进行分析，进而解决App的崩溃问题。</p><p>我们采集到的崩溃日志，主要包含的信息为：进程信息、基本信息、异常信息、线程回溯。</p><ul>\n<li>进程信息：崩溃进程的相关信息，比如崩溃报告唯一标识符、唯一键值、设备标识；</li>\n<li>基本信息：崩溃发生的日期、iOS 版本；</li>\n<li>异常信息：异常类型、异常编码、异常的线程；</li>\n<li>线程回溯：崩溃时的方法调用栈。</li>\n</ul><p>通常情况下，我们分析崩溃日志时最先看的是异常信息，分析出问题的是哪个线程，在线程回溯里找到那个线程；然后，分析方法调用栈，符号化后的方法调用栈可以完整地看到方法调用的过程，从而知道问题发生在哪个方法的调用上。</p><p>其中，方法调用栈如下图所示：</p><p><img src=\"https://static001.geekbang.org/resource/image/93/2a/93ae6e6c8275486052e08317a0d9db2a.png?wh=1830*1144\" alt=\"\"></p><center><span class=\"reference\">图3 方法调用栈展示图片</span></center><p>方法调用栈顶，就是最后导致崩溃的方法调用。完整的崩溃日志里，除了线程方法调用栈还有异常编码。异常编码，就在异常信息里。</p><p>一些被系统杀掉的情况，我们可以通过异常编码来分析。你可以在维基百科上，查看<a href=\"https://en.wikipedia.org/wiki/Hexspeak\">完整的异常编码</a>。这里列出了44种异常编码，但常见的就是如下三种：</p><ul>\n<li>0x8badf00d，表示 App 在一定时间内无响应而被 watchdog 杀掉的情况。</li>\n<li>0xdeadfa11，表示App被用户强制退出。</li>\n<li>0xc00010ff，表示App因为运行造成设备温度太高而被杀掉。</li>\n</ul><p>0x8badf00d 这种情况是出现最多的。当出现被 watchdog 杀掉的情况时，我们就可以把范围控制在主线程被卡的情况。我会在第13篇文章“如何利用 RunLoop 原理去监控卡顿？”中，和你详细说明如何去监控这种情况来防范和快速定位到问题。</p><p>0xdeadfa11 的情况，是用户的主动行为，我们不用太关注。</p><p>0xc00010ff 这种情况，就要对每个线程 CPU 进行针对性的检查和优化。我会在第18篇文章“怎么减少 App 的电量消耗？”中，和你详细说明。</p><p>除了崩溃日志外，崩溃监控平台还需要对所有采集上来的日志进行统计。我以腾讯的 <a href=\"https://bugly.qq.com/v2/\">Bugly 平台</a>为例，和你一起看一下崩溃监控平台一般都会记录哪些信息，来辅助开发者追溯崩溃问题。</p><p><img src=\"https://static001.geekbang.org/resource/image/55/2a/5546c31d852c3fc5c617ad2f7df08d2a.png?wh=1900*864\" alt=\"\"></p><center><span class=\"reference\">图4 Bugly的崩溃趋势展示</span></center><p>上图展示的就是整体崩溃情况的趋势图，你可以选择 App 的不同版本查看不同时间段的趋势。这个相当于总控台，能够全局观察 App 的崩溃大盘。</p><p>除了崩溃率，你还可以在这个平台上能查看次数、用户数等趋势。下图展示的是某一个App的崩溃在不同 iOS 系统、不同iPhone 设备、App 版本的占比情况。这也是全局大盘观察，从不同维度来分析。</p><p><img src=\"https://static001.geekbang.org/resource/image/0a/7c/0a663cafbb223c58c0f6b0ac49c32a7c.png?wh=1886*712\" alt=\"\"></p><center><span class=\"reference\">图5 App崩溃在不同的系统版本、设备、版本版本的占比</span></center><p>有了全局大盘信息，一旦出现大量崩溃，你就需要明白是哪些方法调用出现了问题，需要根据影响的用户数量按照从大到小的顺序排列出来，优先解决影响面大的问题。如下图所示：</p><p><img src=\"https://static001.geekbang.org/resource/image/03/d9/03ae8ce7dd38af5d1d96a8b71f1d9dd9.png?wh=1858*506\" alt=\"\"></p><center><span class=\"reference\">图6 App 崩溃问题列表</span></center><p>同时，每个崩溃也都有自己的崩溃趋势图、iOS 系统分布图等信息，来辅助开发者跟踪崩溃修复效果。</p><p>有了崩溃的方法调用堆栈后，大部分问题都能够通过方法调用堆栈，来快速地定位到具体是哪个方法调用出现了问题。有些问题仅仅通过这些堆栈还无法分析出来，这时就需要借助崩溃前用户相关行为和系统环境状况的日志来进行进一步分析。</p><p>关于日志如何收集协助分析问题，我会在第15篇文章“日志监控：怎样获取 App 中的全量日志？”中，和你详细说明。</p><h2>小结</h2><p>学习完今天的这篇文章，我相信你就不再是只能依赖现有工具来解决线上崩溃问题的 iOS 开发者了。在遇到那些工具无法提供信息的崩溃场景时，你也有了自己动手去收集崩溃信息的能力。</p><p>现有的崩溃监控系统，不管是开源的崩溃日志收集库还是类似 Bugly 的崩溃监控系统，离最优解都还有一定的距离。</p><p>这个“非最优”，我们需要分两个维度来看：一个维度是，怎样才能够让崩溃信息的收集效率更高，丢失率更低；另一个维度是，如何能够收集到更多的崩溃信息，特别是系统强杀带来的崩溃。</p><p>随着iOS 系统的迭代更新，强杀阈值和强杀种类都在不断变化，因此崩溃监控系统也需要跟上系统迭代更新的节奏，同时还要做好向下兼容。</p><h2>课后小作业</h2><p>请你写一段代码，在 App 退后台以后执行一段超过3分钟的任务，在临近3分钟时打印出线程堆栈。</p><p>感谢你的收听，欢迎你在评论区给我留言分享你的观点，也欢迎把它分享给更多的朋友一起阅读。</p><p><span class=\"reference\">最近，我收到一些同学的反馈，说这门课的一些内容比较深，一时难以琢磨透。如果你也有这样的感受，推荐你学习极客时间刚刚上新的另一门视频课程：由腾讯高级工程师朱德权，主讲的《从 0 开发一款 iOS App》。</span></p><p><span class=\"reference\">朱德权老师将会基于最新技术，从实践出发，手把手带你构建类今日头条的App。要知道，那些很牛的 iOS 开发者，往往都具备独立开发一款 App 的能力。</span></p><p><span class=\"reference\">这门课正在上新优惠，欢迎点击<a href=\"https://time.geekbang.org/course/intro/169?utm_term=zeusKHUZ0&amp;utm_source=app&amp;utm_medium=geektime&amp;utm_campaign=169-presell&amp;utm_content=daiming\">这里</a>试看。</span></p><p></p>","comments":[{"had_liked":false,"id":85094,"user_name":"Hjay","can_delete":false,"product_type":"c1","uid":1334835,"ip_address":"","ucode":"279C233D6AC437","user_header":"https://static001.geekbang.org/account/avatar/00/14/5e/33/6d1687fd.jpg","comment_is_top":false,"comment_ctime":1554977766,"is_pvip":false,"replies":[{"id":"30681","content":"你说的没错，现在收集 crash 的框架都是用的Mach异常+Unix信号方式这样的方式。","user_name":"作者回复","user_name_real":"戴铭","uid":"1140280","ctime":1555124872,"ip_address":"","comment_id":85094,"utype":1}],"discussion_count":4,"race_medal":0,"score":"100339225574","product_id":100024501,"comment_content":"文中所讲的crash捕获只说了针对信号的，基本都是需要内核操作的一些才会以信号的形式给到进程，而oc自己也有定义一些并没深入到内核的一些exception，这些是通过注册exceptionhandle来进行捕获的，所以crash的收集应该是分两块，只说信号这一种是不够完整的","like_count":23,"discussions":[{"author":{"id":1140280,"avatar":"https://static001.geekbang.org/account/avatar/00/11/66/38/f9999b2b.jpg","nickname":"戴铭","note":"","ucode":"D61E685F962387","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":446556,"discussion_content":"你说的没错，现在收集 crash 的框架都是用的Mach异常+Unix信号方式这样的方式。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1555124872,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1097252,"avatar":"https://static001.geekbang.org/account/avatar/00/10/be/24/51d5d1f2.jpg","nickname":"iOS小菜鸟","note":"","ucode":"6F0C7DCE309692","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":37639,"discussion_content":"所以说，压根就没有介绍全啊，这么重要的一块给漏讲了。","likes_number":2,"is_delete":false,"is_hidden":false,"ctime":1571650169,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":2,"child_discussions":[{"author":{"id":1202431,"avatar":"https://static001.geekbang.org/account/avatar/00/12/58/ff/a722ba13.jpg","nickname":"Aa","note":"","ucode":"C72E9C081F3BC9","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":1097252,"avatar":"https://static001.geekbang.org/account/avatar/00/10/be/24/51d5d1f2.jpg","nickname":"iOS小菜鸟","note":"","ucode":"6F0C7DCE309692","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":140150,"discussion_content":"你说的没错","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1579349475,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":37639,"ip_address":""},"score":140150,"extra":""},{"author":{"id":1337598,"avatar":"https://static001.geekbang.org/account/avatar/00/14/68/fe/1353168d.jpg","nickname":"岁月","note":"","ucode":"29A2A2BC3C4FE4","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":1202431,"avatar":"https://static001.geekbang.org/account/avatar/00/12/58/ff/a722ba13.jpg","nickname":"Aa","note":"","ucode":"C72E9C081F3BC9","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":216444,"discussion_content":"看不出这个专栏有什么诚意..\n有些文章都是用作者很久以前的博文直接复制过来的..","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1585451886,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":140150,"ip_address":""},"score":216444,"extra":""}]}]},{"had_liked":false,"id":83344,"user_name":"WeZZard","can_delete":false,"product_type":"c1","uid":1471692,"ip_address":"","ucode":"7499FC0D624F08","user_header":"https://static001.geekbang.org/account/avatar/00/16/74/cc/5ff05eb3.jpg","comment_is_top":false,"comment_ctime":1554541538,"is_pvip":false,"discussion_count":1,"race_medal":0,"score":"53094149090","product_id":100024501,"comment_content":"爆棧也可以引起崩潰。看了很多 iOS 面試的鏈表題答案都是單純用的自動引用計數管理後繼節點，這種做法下鏈表長到數萬後一析構就會崩，原因就是自動引用計數引起的鏈錶各節點鏈式析構所導致的爆棧。","like_count":12,"discussions":[{"author":{"id":1430042,"avatar":"https://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTL8bkxdc5LXXZJWia2EBD8kIM3ic9KiaVibqVGicHyeHCB8GXvLOaDNMxSVqMnnnFRrlf6BDuYtcoLUribw/132","nickname":"Geek_fd2ec3","note":"","ucode":"F61F9E228B4EFA","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":268484,"discussion_content":"怎么解决的呢","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1589789032,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":92990,"user_name":"Null","can_delete":false,"product_type":"c1","uid":1382587,"ip_address":"","ucode":"A7D4DF2A43C7D8","user_header":"https://static001.geekbang.org/account/avatar/00/15/18/bb/9299fab1.jpg","comment_is_top":false,"comment_ctime":1557373876,"is_pvip":true,"discussion_count":1,"race_medal":0,"score":"44507046836","product_id":100024501,"comment_content":"老师，我是做SDK，要如何从捕获的日志中区分出来哪些是我的SDK的，哪些是主端APP的，哪些是其他Framwork。目前了解的，动态库收集的日志会有库信息，静态库收集到的信息都是APP的名字。。拜求老师指导下。","like_count":10,"discussions":[{"author":{"id":1467974,"avatar":"http://thirdwx.qlogo.cn/mmopen/vi_32/DYAIOgq83eqRllUL85m1azlV9BxVGpsAPhLiaLLeWjRsTO5cIxG9NFJavpiabEzVD9qDzudnjwMr2zWBXMMgAQww/132","nickname":"leopardpan","note":"","ucode":"8A721910CCCFB5","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":281039,"discussion_content":"可以通过类名和方法名判断，一般做sdk的类前缀都有自己的标识，例如系统的NS这样，一是为了防止跟应用内其它的framework或代码类名冲突，二是为了出问题得时候好区分是哪个sdk里的代码问题。\n","likes_number":1,"is_delete":false,"is_hidden":false,"ctime":1591665117,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":89478,"user_name":"Lotty周小鱼","can_delete":false,"product_type":"c1","uid":1453544,"ip_address":"","ucode":"FBC2E6DE49895A","user_header":"https://static001.geekbang.org/account/avatar/00/16/2d/e8/d53cc6ee.jpg","comment_is_top":false,"comment_ctime":1556182591,"is_pvip":false,"replies":[{"id":"32664","content":"很好的建议","user_name":"作者回复","user_name_real":"戴铭","uid":"1140280","ctime":1556891215,"ip_address":"","comment_id":89478,"utype":1}],"discussion_count":1,"race_medal":0,"score":"40210888255","product_id":100024501,"comment_content":"有个小小的建议，希望戴老师以后贴出的代码片段写一下来源或者源码链接，这样方便查看的时候快速翻阅上下文。","like_count":9,"discussions":[{"author":{"id":1140280,"avatar":"https://static001.geekbang.org/account/avatar/00/11/66/38/f9999b2b.jpg","nickname":"戴铭","note":"","ucode":"D61E685F962387","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":448148,"discussion_content":"很好的建议","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1556891215,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":211480,"user_name":"null","can_delete":false,"product_type":"c1","uid":1642151,"ip_address":"","ucode":"B0ACD1B5CA541B","user_header":"https://static001.geekbang.org/account/avatar/00/19/0e/a7/9b79c245.jpg","comment_is_top":false,"comment_ctime":1587970786,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"31652741858","product_id":100024501,"comment_content":"1. 测试后台执行联调时间时，不能是调试状态。必须断开xcode<br>2. beginBackgroundTaskWithExpirationHandler与endBackgroundTask是成对出现的。如果不成对出现，5s app会被杀掉。<br>3.正确写法:yourTask应该放在beginBackgroundTaskWithExpirationHandler前调用,而不是block块<br> [self yourTaskWithApplication:application];<br>    self.backgroundTaskIdentifier = [application beginBackgroundTaskWithExpirationHandler:^(void) {<br>        [application endBackgroundTask:self.backgroundTaskIdentifier];<br>        self.backgroundTaskIdentifier = UIBackgroundTaskInvalid;<br>    }];<br>4. 我们可以借助 控制台 来判断app是否还在执行，日志是否还在打印<br>","like_count":7},{"had_liked":false,"id":83765,"user_name":"yehot","can_delete":false,"product_type":"c1","uid":1003962,"ip_address":"","ucode":"2F1C2A1E5DB900","user_header":"https://static001.geekbang.org/account/avatar/00/0f/51/ba/cae2ed38.jpg","comment_is_top":false,"comment_ctime":1554712518,"is_pvip":false,"discussion_count":5,"race_medal":0,"score":"31619483590","product_id":100024501,"comment_content":"使用 registerSignalHandler 和handleSignalHandler 是能够捕获到异常。<br>但是，这个时候 app 已经立即要 crash 了。捕获的异常怎么才能确保能够持久化到沙盒呢？写入文件的代码是没法保证在 crash 前正常执行完的吧！","like_count":7,"discussions":[{"author":{"id":2368333,"avatar":"","nickname":"Geek_83bbf5","note":"","ucode":"64B18E8DFC04AF","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":350722,"discussion_content":"写入数据的时候 - (void)performSelectorOnMainThread:(SEL)aSelector withObject:(nullable id)arg waitUntilDone:(BOOL)wait;\nwaitUntilDone 设置为YES 就是主线程同步执行 执行完才会崩溃","likes_number":2,"is_delete":false,"is_hidden":false,"ctime":1613990020,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":2681398,"avatar":"https://static001.geekbang.org/account/avatar/00/28/ea/36/7d088c63.jpg","nickname":"D","note":"","ucode":"4112DE94C80A5B","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":390330,"discussion_content":"我是通过同步的网络请求来实现上传log的","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1629784529,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":1,"child_discussions":[{"author":{"id":2858088,"avatar":"https://thirdwx.qlogo.cn/mmopen/vi_32/DYAIOgq83eqLlZ7ibJqRocm0EM4YF8iaJJFeicGI9U0gh5ZLeWTjXeicOFlT4tjKtIz8SpGqBPXAspLMbWD5GnrdhQ/132","nickname":"痴人指路","note":"","ucode":"302C8ACA410F38","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":2681398,"avatar":"https://static001.geekbang.org/account/avatar/00/28/ea/36/7d088c63.jpg","nickname":"D","note":"","ucode":"4112DE94C80A5B","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":548611,"discussion_content":"不保险，网络本身就是不可靠的","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1643275869,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":390330,"ip_address":""},"score":548611,"extra":""}]},{"author":{"id":1108007,"avatar":"https://static001.geekbang.org/account/avatar/00/10/e8/27/4cb985b9.jpg","nickname":"春风","note":"","ucode":"29A33F2D4EA374","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":307512,"discussion_content":"我测试有时间保存信息。如果比较耗时可以使用 mmap（有第三方微信MMKV） 保存数据","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1600673599,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1458781,"avatar":"http://thirdwx.qlogo.cn/mmopen/vi_32/DYAIOgq83erQ5LXNgaZ3RUt15nM76EZ91BJiaqW3Ud1Qsg9icZ3fDAyibl5UIvvJJHOy6ANUTlYEFnlS7kb09icJeA/132","nickname":"rico","note":"","ucode":"8B52C9130B5EDF","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":304962,"discussion_content":"可以通过runloop保活线程，持久化数据后再让app crash。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1599724659,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":83353,"user_name":"Adam","can_delete":false,"product_type":"c1","uid":1456034,"ip_address":"","ucode":"3CCF37176E2E6E","user_header":"https://static001.geekbang.org/account/avatar/00/16/37/a2/045733b3.jpg","comment_is_top":false,"comment_ctime":1554542866,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"27324346642","product_id":100024501,"comment_content":"@Mhy<br>1. ‘If your app targets iOS 9.0 and later or OS X v10.11 and later, you don&#39;t need to unregister an observer in its deallocation method。’ 在9.0之前需要手动remove 观察者，如果没有移除会出现观察者崩溃情况。<br>2. NSNotification 有同步、异步、聚合发送等线程问题，不同的线程处理不好就可能出现崩溃，情况比较多可以参考一些资料。","like_count":6},{"had_liked":false,"id":83287,"user_name":"Mhy","can_delete":false,"product_type":"c1","uid":1287774,"ip_address":"","ucode":"DE19BCAD1F856E","user_header":"https://static001.geekbang.org/account/avatar/00/13/a6/5e/b05254a6.jpg","comment_is_top":false,"comment_ctime":1554519208,"is_pvip":false,"discussion_count":1,"race_medal":0,"score":"23029355688","product_id":100024501,"comment_content":"请问关于NSNotification线程问题能大致的讲一下吗 ","like_count":5,"discussions":[{"author":{"id":1002401,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/4b/a1/c2719a5a.jpg","nickname":"Panda🐟","note":"","ucode":"C6007A3192516A","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":5464,"discussion_content":"http://southpeak.github.io/2015/03/14/nsnotification-and-multithreading/","likes_number":1,"is_delete":false,"is_hidden":false,"ctime":1566286646,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":128907,"user_name":"一纸丶荒年","can_delete":false,"product_type":"c1","uid":1458078,"ip_address":"","ucode":"9A4C0364B97780","user_header":"https://static001.geekbang.org/account/avatar/00/16/3f/9e/7a6e6442.jpg","comment_is_top":false,"comment_ctime":1566982507,"is_pvip":false,"discussion_count":1,"race_medal":0,"score":"18746851691","product_id":100024501,"comment_content":"老师 您好 , 我 想知道的是  你讲这一篇文章 没有确切的解决问题吖, 我想了解的是  怎么来解读那些 堆栈信息. 那些崩溃日志, 都看不懂的.","like_count":4,"discussions":[{"author":{"id":2029340,"avatar":"https://static001.geekbang.org/account/avatar/00/1e/f7/1c/d1cff020.jpg","nickname":"MELO","note":"","ucode":"70BE8FBA819F73","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":281723,"discussion_content":"导出Crash文件，配合dsym文件，用Xcode 工具symbolicatecrash做符号化解析","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1591797950,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":132164,"user_name":"will","can_delete":false,"product_type":"c1","uid":1457442,"ip_address":"","ucode":"93DC3993A50CBB","user_header":"https://static001.geekbang.org/account/avatar/00/16/3d/22/c6ff6e02.jpg","comment_is_top":false,"comment_ctime":1568034568,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"14452936456","product_id":100024501,"comment_content":"老师，我这个对吗，我看了，系统刚好在快3分钟到时候执行打印线程堆栈信息<br>- (void)applicationDidEnterBackground:(UIApplication *)application {<br>    UIApplication  *app = [UIApplication sharedApplication];<br>    __block UIBackgroundTaskIdentifier bgTask = 0;<br>    <br>    NSLog(@&quot;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&quot;);<br>    <br>    <br>    bgTask = [app beginBackgroundTaskWithExpirationHandler:^{<br>        NSLog(@&quot;&lt;&lt;&lt;&lt;&lt;&lt;&quot;);<br>        NSLog(@&quot;线程堆栈信息：%@&quot;,[NSThread callStackSymbols]);<br>        if (bgTask != UIBackgroundTaskInvalid) {<br>            [app endBackgroundTask:bgTask];<br>            bgTask = UIBackgroundTaskInvalid;<br>        }<br>        <br>    }];<br>}","like_count":3},{"had_liked":false,"id":94533,"user_name":"鼠辈","can_delete":false,"product_type":"c1","uid":1457947,"ip_address":"","ucode":"F8CD6602D9320E","user_header":"https://static001.geekbang.org/account/avatar/00/16/3f/1b/40293181.jpg","comment_is_top":false,"comment_ctime":1557835101,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"14442736989","product_id":100024501,"comment_content":"- (void)applicationDidEnterBackground:(UIApplication *)application {<br>    self.backgroundTaskIdentifier = [application beginBackgroundTaskWithExpirationHandler:^( void) {<br>        [self yourTask];<br>    }];<br>}<br>这个代码中的yourTask，是后台申请3分钟之后，才会调用的吧，这个时候如果没有执行完,我试了不会崩溃。求解释","like_count":3},{"had_liked":false,"id":85164,"user_name":"Hiuzi","can_delete":false,"product_type":"c1","uid":1458862,"ip_address":"","ucode":"E9D5D92CF3D294","user_header":"","comment_is_top":false,"comment_ctime":1554992970,"is_pvip":false,"replies":[{"id":"30677","content":"没法集成两个版本，符号肯定冲突","user_name":"作者回复","user_name_real":"戴铭","uid":"1140280","ctime":1555123691,"ip_address":"","comment_id":85164,"utype":1}],"discussion_count":1,"race_medal":0,"score":"14439894858","product_id":100024501,"comment_content":"戴老师，有没有办法在一个项目了集成某个第三方sdk的两个版本？最近被admob sdk坑惨了，一个月发了4个版本都是修复bug的，我想更新下如果有闪退只能回退老版本了，回退老版本只能发版解决了，有没有不发版的方案解决这个问题呢？","like_count":3,"discussions":[{"author":{"id":1140280,"avatar":"https://static001.geekbang.org/account/avatar/00/11/66/38/f9999b2b.jpg","nickname":"戴铭","note":"","ucode":"D61E685F962387","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":446578,"discussion_content":"没法集成两个版本，符号肯定冲突","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1555123691,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":170826,"user_name":"小敏","can_delete":false,"product_type":"c1","uid":1032627,"ip_address":"","ucode":"ECBCEBF8A3D496","user_header":"https://thirdwx.qlogo.cn/mmopen/vi_32/mJsLrs6JP47z0lZCsPKyIicWYcolVZ0ZuMicsefoiaFfPbf5zcsV2vtOw7zHsgq4UzZqwpSRdwJB6ic102icm9m824Q/132","comment_is_top":false,"comment_ctime":1578732433,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"10168667025","product_id":100024501,"comment_content":"老师，Pl和友盟冲突怎么解决？","like_count":2},{"had_liked":false,"id":96441,"user_name":"周小明","can_delete":false,"product_type":"c1","uid":1187141,"ip_address":"","ucode":"A7BA114A53DD3D","user_header":"https://static001.geekbang.org/account/avatar/00/12/1d/45/aaad1f9a.jpg","comment_is_top":false,"comment_ctime":1558425222,"is_pvip":false,"discussion_count":3,"race_medal":0,"score":"10148359814","product_id":100024501,"comment_content":"打印到了 1000+ 超过了10 分钟都没有 kill。请问是怎么回事呢？<br><br>```` objc<br>- (void)applicationDidEnterBackground:(UIApplication *)application {<br>    [application beginBackgroundTaskWithExpirationHandler:^{<br>        __block int i = 1;<br>        dispatch_source_t timer = dispatch_source_create(DISPATCH_SOURCE_TYPE_TIMER, 0, 0, dispatch_get_main_queue());<br>        dispatch_source_set_timer(timer, DISPATCH_TIME_NOW, 1ull * NSEC_PER_SEC, 0 * NSEC_PER_SEC);<br>        dispatch_source_set_event_handler(timer, ^{<br>            NSLog(@&quot;%d&quot;,i);<br>            i++;<br>            if (i &gt; 60*100 + 5) {<br>                dispatch_source_cancel(timer);<br>            }<br>            <br>        });<br>        dispatch_resume(timer);<br>        <br>    }];<br>}<br><br>````","like_count":2,"discussions":[{"author":{"id":1015911,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/80/67/abb7bfe3.jpg","nickname":"涂海生","note":"","ucode":"E3DA62CF9A7745","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":2427,"discussion_content":"你可能是真机调试，真机调试就不会被kill","likes_number":1,"is_delete":false,"is_hidden":false,"ctime":1563598130,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":1,"child_discussions":[{"author":{"id":1000014,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/42/4e/05e2b4a0.jpg","nickname":"Alan","note":"","ucode":"9B9F596302FAAF","race_medal":0,"user_type":8,"is_pvip":false},"reply_author":{"id":1015911,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/80/67/abb7bfe3.jpg","nickname":"涂海生","note":"","ucode":"E3DA62CF9A7745","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":3450,"discussion_content":"111","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1564485066,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":2427,"ip_address":""},"score":3450,"extra":""}]},{"author":{"id":1642151,"avatar":"https://static001.geekbang.org/account/avatar/00/19/0e/a7/9b79c245.jpg","nickname":"null","note":"","ucode":"B0ACD1B5CA541B","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":248787,"discussion_content":"在评论区找到原因了。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1587895836,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":85371,"user_name":"ssala","can_delete":false,"product_type":"c1","uid":1005356,"ip_address":"","ucode":"CCD82C81756FC6","user_header":"https://static001.geekbang.org/account/avatar/00/0f/57/2c/b0793828.jpg","comment_is_top":false,"comment_ctime":1555047765,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"10144982357","product_id":100024501,"comment_content":"我们采用的fabric监控APP crash问题，但是有些crash的堆栈完全看不出头绪，千奇百怪。","like_count":2},{"had_liked":false,"id":85367,"user_name":"青冈","can_delete":false,"product_type":"c1","uid":1080446,"ip_address":"","ucode":"8E54B939937E6D","user_header":"http://thirdwx.qlogo.cn/mmopen/vi_32/DYAIOgq83eoYBX95GZxEdKz9LQJVwohUiaRxNge5WpHRbeOC2tGc2rsdpfYKCTKdQicBn8MvSrlZTX7HY2jS3YFA/132","comment_is_top":false,"comment_ctime":1555046934,"is_pvip":false,"replies":[{"id":"30675","content":"在DidEnterBackground里尽快完成，不要超时了。","user_name":"作者回复","user_name_real":"戴铭","uid":"1140280","ctime":1555123613,"ip_address":"","comment_id":85367,"utype":1}],"discussion_count":3,"race_medal":0,"score":"10144981526","product_id":100024501,"comment_content":"戴老师，bugly针对应用进入后台被系统强杀也算是一种crash。您告诉我是后台工作超时，那这种情况的话我是应该在DidEnterBackground这种函数中做什么处理；还是在bugly中做什么配置，不捕捉把这种情况下的crash呢?  app进入后台之后，bugly抓捕crash的名称是 SEGV 是 segmentation violation 的缩写，是当一个进程执行了一个无效的内存引用，或发生段错误时发送给它的信号。这种的话，我应该","like_count":2,"discussions":[{"author":{"id":1140280,"avatar":"https://static001.geekbang.org/account/avatar/00/11/66/38/f9999b2b.jpg","nickname":"戴铭","note":"","ucode":"D61E685F962387","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":446646,"discussion_content":"在DidEnterBackground里尽快完成，不要超时了。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1555123613,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1344353,"avatar":"https://static001.geekbang.org/account/avatar/00/14/83/61/b32787f6.jpg","nickname":"rjb","note":"","ucode":"7D8ECE9044F5A0","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":307439,"discussion_content":"app进入后台之后，bugly抓捕crash的名称是 SEGV。那么进入后台后的这个崩溃如何产生的。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1600651049,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1000014,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/42/4e/05e2b4a0.jpg","nickname":"Alan","note":"","ucode":"9B9F596302FAAF","race_medal":0,"user_type":8,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":3448,"discussion_content":"666","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1564483212,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":100851,"user_name":"小袋子","can_delete":false,"product_type":"c1","uid":1403825,"ip_address":"","ucode":"2797320994938C","user_header":"https://static001.geekbang.org/account/avatar/00/15/6b/b1/32cb2393.jpg","comment_is_top":false,"comment_ctime":1559655011,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"5854622307","product_id":100024501,"comment_content":"建议要自己实现 crash 日志采集系统的同学可以参考 KSCrash，另外做 SDK 的同学要实现一套收集 SDK 相关的 crash，真的是世纪难题，我能想到的方法就是用 hook 的方式实时记录 SDK 的调用栈， crash 的时候上传，辅助排查。另外可以将 SDK 的业务都放在一个带有 SDK 标识的 GCD 队列中，这样崩溃日志会明确指向 SDK，省得无法确定问题的归属方。（找客户要符号表真的很困难）","like_count":1},{"had_liked":false,"id":89236,"user_name":"(Jet)黄仲平","can_delete":false,"product_type":"c1","uid":1244363,"ip_address":"","ucode":"2AF4F9B460795C","user_header":"https://static001.geekbang.org/account/avatar/00/12/fc/cb/5e79c6ed.jpg","comment_is_top":false,"comment_ctime":1556113765,"is_pvip":false,"discussion_count":2,"race_medal":0,"score":"5851081061","product_id":100024501,"comment_content":"戴老师好，我最近有一个困惑，就是我们公司计划做一个自己的“crash监控系统”。其中有一个很重要的目标是要实现crash日志，能定位到责任人，然后进行快速响应。<br>目前我个人对这件事的解决思路如下：<br>1. 收集crash日志，并上传日志到服务器上；<br>2. 通过解析git 库的提交日志，对代码文件与作者与进行关连并把日志提交到服务器；<br>3.  发生crash时，通过把错误堆栈信息与符号表(dysm)进行匹配，找到堆栈信息里含特定前缀的文件名。进行责任人匹配；<br>第一个问题：以上是我的解决思路。不知道戴老师是否也是这种思路？<br>第二个问题：在上面的第一步日志收集时是通过 文中“handleSignalException”方法来收集？还是通过PLCrashReporter 来进行收集？<br>第三个问题：dysm 在解析堆栈信息时的工作原理有无相关文章 进行介绍；<br><br>望老师百忙之中帮忙答复，不胜感激。<br>","like_count":1,"discussions":[{"author":{"id":1375813,"avatar":"https://static001.geekbang.org/account/avatar/00/14/fe/45/992ffe11.jpg","nickname":"老林sir","note":"","ucode":"757727F69D926C","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":1729,"discussion_content":"定位到责任人？搞笑的吧","likes_number":2,"is_delete":false,"is_hidden":false,"ctime":1562852929,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":2858088,"avatar":"https://thirdwx.qlogo.cn/mmopen/vi_32/DYAIOgq83eqLlZ7ibJqRocm0EM4YF8iaJJFeicGI9U0gh5ZLeWTjXeicOFlT4tjKtIz8SpGqBPXAspLMbWD5GnrdhQ/132","nickname":"痴人指路","note":"","ucode":"302C8ACA410F38","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":548615,"discussion_content":"定位到责任人我也觉得有点玄乎，人可是流动的，而且，大型项目都会存在同一个功能模块先后同时多人维护与迭代","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1643277305,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":84160,"user_name":"drunkenMouse","can_delete":false,"product_type":"c1","uid":1454037,"ip_address":"","ucode":"AA8CEA703ECBE8","user_header":"","comment_is_top":false,"comment_ctime":1554795397,"is_pvip":false,"replies":[{"id":"30734","content":"对，不一定非要在后台","user_name":"作者回复","user_name_real":"戴铭","uid":"1140280","ctime":1555145457,"ip_address":"","comment_id":84160,"utype":1}],"discussion_count":1,"race_medal":0,"score":"5849762693","product_id":100024501,"comment_content":"“先要找到它们的阈值，然后在临近阈值时还在执行的后台程序”其实不一定非要是在后台吧？<br>","like_count":1,"discussions":[{"author":{"id":1140280,"avatar":"https://static001.geekbang.org/account/avatar/00/11/66/38/f9999b2b.jpg","nickname":"戴铭","note":"","ucode":"D61E685F962387","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":446265,"discussion_content":"对，不一定非要在后台","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1555145457,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":83920,"user_name":"易若风云","can_delete":false,"product_type":"c1","uid":1040086,"ip_address":"","ucode":"6FB7B508301FED","user_header":"https://static001.geekbang.org/account/avatar/00/0f/de/d6/abb7bfe3.jpg","comment_is_top":false,"comment_ctime":1554733527,"is_pvip":false,"discussion_count":1,"race_medal":0,"score":"5849700823","product_id":100024501,"comment_content":"戴老师，问一下，oc引起的崩溃，如数组越界，为什么没有信号产生呢？那这个崩溃是从哪里发出的？","like_count":1,"discussions":[{"author":{"id":1458103,"avatar":"https://static001.geekbang.org/account/avatar/00/16/3f/b7/bca5b113.jpg","nickname":"BiuBiu崽","note":"","ucode":"5DF7740130C4B3","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":352498,"discussion_content":"NSException 可以捕获","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1614755669,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":83708,"user_name":"CoderJJMa","can_delete":false,"product_type":"c1","uid":1199251,"ip_address":"","ucode":"9A16138343D733","user_header":"https://static001.geekbang.org/account/avatar/00/12/4c/93/28bbf22e.jpg","comment_is_top":false,"comment_ctime":1554707277,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"5849674573","product_id":100024501,"comment_content":"- (BOOL)application:(UIApplication *)application didFinishLaunchingWithOptions:(NSDictionary *)launchOptions {<br>    _timer = [NSTimer scheduledTimerWithTimeInterval:1 target:self selector:@selector(repeater) userInfo:nil repeats:YES];<br>    return YES;<br>}<br><br>-(void)repeater{<br>    <br>    NSLog(@&quot;%s&quot;,__func__);<br>    <br>}<br><br>- (void)applicationDidEnterBackground:(UIApplication *)application {<br>    <br>    NSLog(@&quot;===== : applicationDidEnterBackground&quot;);<br>    NSLog(@&quot;begin=============&quot;);<br><br>  self.bgIdentify = [application beginBackgroundTaskWithExpirationHandler:^{<br>        [self endBack];<br>    }];<br>}<br><br>-(void)endBack{<br>    <br>    NSLog(@&quot;end=============&quot;);<br>    NSLog(@&quot;callStackSymbols : %@&quot;,[NSThread callStackSymbols]);<br><br>    [[UIApplication sharedApplication] endBackgroundTask:self.bgIdentify];<br>    self.bgIdentify = UIBackgroundTaskInvalid;<br>}","like_count":1},{"had_liked":false,"id":354901,"user_name":"mk_objc","can_delete":false,"product_type":"c1","uid":2619203,"ip_address":"四川","ucode":"6516A1962A0F0F","user_header":"https://static001.geekbang.org/account/avatar/00/27/f7/43/7e9c6434.jpg","comment_is_top":false,"comment_ctime":1660874671,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1660874671","product_id":100024501,"comment_content":"没讲到重点","like_count":0},{"had_liked":false,"id":346830,"user_name":"NPC","can_delete":false,"product_type":"c1","uid":1458738,"ip_address":"","ucode":"7D89075DB55C4E","user_header":"http://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTKyibtHpR7gUQwQyDnbQO5pODsRumWTMfyCeP0SyIJicJxNggANSGXibYJia35n2a4Xayb8LpicyPIicERQ/132","comment_is_top":false,"comment_ctime":1653466285,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1653466285","product_id":100024501,"comment_content":"戴铭老师，我想请教一下，目前bugly有什么crash是无法捕获到的","like_count":0},{"had_liked":false,"id":300339,"user_name":"sky","can_delete":false,"product_type":"c1","uid":2132195,"ip_address":"","ucode":"BFF31CCDFF8A86","user_header":"https://static001.geekbang.org/account/avatar/00/20/88/e3/1fb72807.jpg","comment_is_top":false,"comment_ctime":1625123344,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1625123344","product_id":100024501,"comment_content":"完整的异常编码 老师，文中这个链接打不开了，其他地方还可以看吗","like_count":0},{"had_liked":false,"id":300085,"user_name":"涂海生","can_delete":false,"product_type":"c1","uid":1015911,"ip_address":"","ucode":"E3DA62CF9A7745","user_header":"https://static001.geekbang.org/account/avatar/00/0f/80/67/abb7bfe3.jpg","comment_is_top":false,"comment_ctime":1624979120,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1624979120","product_id":100024501,"comment_content":"没有具体分析信号量的crash","like_count":0},{"had_liked":false,"id":298551,"user_name":"Geek_14b699","can_delete":false,"product_type":"c1","uid":1229594,"ip_address":"","ucode":"02AC3773765AB9","user_header":"https://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTJuQocTOGrXzPb8fgDibrdH5jBAtrdWckiaKjvner6OT1DeKtRm43Wo2jFqTuiaqmsKNqvfbxj25H4bg/132","comment_is_top":false,"comment_ctime":1624188411,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1624188411","product_id":100024501,"comment_content":"为什么bugly需要上传符号表，自己如果写了crash收集是不是也需要用到符号表呢？","like_count":0},{"had_liked":false,"id":292323,"user_name":"阿呆","can_delete":false,"product_type":"c1","uid":1455575,"ip_address":"","ucode":"7D02867E9D9527","user_header":"https://static001.geekbang.org/account/avatar/00/16/35/d7/8ac38c7d.jpg","comment_is_top":false,"comment_ctime":1620782924,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1620782924","product_id":100024501,"comment_content":"之前买的时候没有那么多内容，没想到一直在更新。感谢戴老师","like_count":0},{"had_liked":false,"id":279880,"user_name":"Geek_83bbf5","can_delete":false,"product_type":"c1","uid":2368333,"ip_address":"","ucode":"64B18E8DFC04AF","user_header":"","comment_is_top":false,"comment_ctime":1613990138,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1613990138","product_id":100024501,"comment_content":"signal采集的崩溃，堆栈信息要怎么获取才能定位准确呢？ 试写的demo 堆栈信息无法定位到具体操作","like_count":0},{"had_liked":false,"id":234325,"user_name":"MELO","can_delete":false,"product_type":"c1","uid":2029340,"ip_address":"","ucode":"70BE8FBA819F73","user_header":"https://static001.geekbang.org/account/avatar/00/1e/f7/1c/d1cff020.jpg","comment_is_top":false,"comment_ctime":1594646076,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1594646076","product_id":100024501,"comment_content":"老师：怎么把一个线程运行到指定的处理器核心上？","like_count":0},{"had_liked":false,"id":220456,"user_name":"kango","can_delete":false,"product_type":"c1","uid":1517095,"ip_address":"","ucode":"3D740DB0CE94F7","user_header":"https://static001.geekbang.org/account/avatar/00/17/26/27/a4abd984.jpg","comment_is_top":false,"comment_ctime":1590246178,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1590246178","product_id":100024501,"comment_content":" KVO 问题、NSNotification 线程问题、数组越界、野指针等崩溃信息，是可以通过信号捕获的","like_count":0},{"had_liked":false,"id":219995,"user_name":"zruibin","can_delete":false,"product_type":"c1","uid":1002555,"ip_address":"","ucode":"C4A356409C8312","user_header":"https://static001.geekbang.org/account/avatar/00/0f/4c/3b/9311c93f.jpg","comment_is_top":false,"comment_ctime":1590133026,"is_pvip":false,"discussion_count":1,"race_medal":0,"score":"1590133026","product_id":100024501,"comment_content":"内存打爆如何用mmap()来保存现场这点麻烦呢说清楚点吗？比如内存的边界阈值是多少？现场是什么现场？各大堆栈的耗时与大小？","like_count":0,"discussions":[{"author":{"id":2029340,"avatar":"https://static001.geekbang.org/account/avatar/00/1e/f7/1c/d1cff020.jpg","nickname":"MELO","note":"","ucode":"70BE8FBA819F73","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":290938,"discussion_content":"OOM的阈值，可以用task_vm_info_data_t或者os proc 的函数 os_proc_avariable_memory()来获取。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1594645990,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":160184,"user_name":"普通拳","can_delete":false,"product_type":"c1","uid":1585359,"ip_address":"","ucode":"80612EB6C25F23","user_header":"https://static001.geekbang.org/account/avatar/00/18/30/cf/cccf3f6b.jpg","comment_is_top":false,"comment_ctime":1575887346,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1575887346","product_id":100024501,"comment_content":"戴老师讲解很透彻。不过我有一个疑问，很多公司的iOS开发人员有限，大部分情况下没有太多人力物力去做一些很底层的事情，比如收集崩溃日志等。您之前在滴滴的时候，这些崩溃日志的收集、性能监控等等，都是自己团队开发的吗？你们整个iOS技术团队包括业务组在内，一共大概有多少人啊？希望老师能解答我的疑惑~","like_count":0},{"had_liked":false,"id":143215,"user_name":"iOS小菜鸟","can_delete":false,"product_type":"c1","uid":1097252,"ip_address":"","ucode":"6F0C7DCE309692","user_header":"https://static001.geekbang.org/account/avatar/00/10/be/24/51d5d1f2.jpg","comment_is_top":false,"comment_ctime":1571650254,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1571650254","product_id":100024501,"comment_content":"漏讲了一个重要的Mach异常，不补上吗","like_count":0},{"had_liked":false,"id":116085,"user_name":"西京富贵兔","can_delete":false,"product_type":"c1","uid":1455922,"ip_address":"","ucode":"4E185A019A072E","user_header":"https://static001.geekbang.org/account/avatar/00/16/37/32/758ef1c7.jpg","comment_is_top":false,"comment_ctime":1563783566,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1563783566","product_id":100024501,"comment_content":"戴老师，关于 SIGTRAP 这种问题怎么分析好呢？","like_count":0},{"had_liked":false,"id":109189,"user_name":"tomcat","can_delete":false,"product_type":"c1","uid":1133556,"ip_address":"","ucode":"A7CE9FEE5E03CD","user_header":"https://static001.geekbang.org/account/avatar/00/11/4b/f4/de7809c1.jpg","comment_is_top":false,"comment_ctime":1561977373,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1561977373","product_id":100024501,"comment_content":"进入后台之后能在非主线程打印日志吗？主线程打印日志的话可能会造成干扰。","like_count":0},{"had_liked":false,"id":108075,"user_name":"星星","can_delete":false,"product_type":"c1","uid":1529046,"ip_address":"","ucode":"963621AAA04E41","user_header":"","comment_is_top":false,"comment_ctime":1561680143,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1561680143","product_id":100024501,"comment_content":"请教一个问题，app如果crash后，怎么防止app闪退呢，看了一些文章，OC可以通过分类和runtime替换一些可能crash的方法，swift需要怎么处理呢？","like_count":0},{"had_liked":false,"id":102575,"user_name":"Sawillow","can_delete":false,"product_type":"c1","uid":1465136,"ip_address":"","ucode":"0D4187EF5B8336","user_header":"https://static001.geekbang.org/account/avatar/00/16/5b/30/e3a73c11.jpg","comment_is_top":false,"comment_ctime":1560256866,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1560256866","product_id":100024501,"comment_content":"完整的编码异常   无法查看","like_count":0},{"had_liked":false,"id":95228,"user_name":"Null","can_delete":false,"product_type":"c1","uid":1382587,"ip_address":"","ucode":"A7D4DF2A43C7D8","user_header":"https://static001.geekbang.org/account/avatar/00/15/18/bb/9299fab1.jpg","comment_is_top":false,"comment_ctime":1557992279,"is_pvip":true,"replies":[{"id":"35013","content":"通过方法堆栈看","user_name":"作者回复","user_name_real":"戴铭","uid":"1140280","ctime":1558850954,"ip_address":"","comment_id":95228,"utype":1}],"discussion_count":2,"race_medal":0,"score":"1557992279","product_id":100024501,"comment_content":"crash中是否有明确的标识显示是由于哪个三方库引起的吗？","like_count":0,"discussions":[{"author":{"id":1140280,"avatar":"https://static001.geekbang.org/account/avatar/00/11/66/38/f9999b2b.jpg","nickname":"戴铭","note":"","ucode":"D61E685F962387","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":450377,"discussion_content":"通过方法堆栈看","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1558850954,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1229594,"avatar":"https://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTJuQocTOGrXzPb8fgDibrdH5jBAtrdWckiaKjvner6OT1DeKtRm43Wo2jFqTuiaqmsKNqvfbxj25H4bg/132","nickname":"Geek_14b699","note":"","ucode":"02AC3773765AB9","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":379851,"discussion_content":"方法堆栈需要用到符号表么","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1624188674,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":89771,"user_name":"阿伦","can_delete":false,"product_type":"c1","uid":1454351,"ip_address":"","ucode":"58D147F6211016","user_header":"http://thirdwx.qlogo.cn/mmopen/vi_32/dHawibgghoCDFTuT4uIF3y6ZzQJ2azhU4Yq0ZLtMYiaPUP6mo6v30ib95DXgH1cVxY4MaEk4WBw1X4QWbdOSC8lQg/132","comment_is_top":false,"comment_ctime":1556261499,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1556261499","product_id":100024501,"comment_content":"尴尬...写了个定时器，定了时间177s时输出堆栈信息...结果发现174秒时就已经被kill了...","like_count":0},{"had_liked":false,"id":89347,"user_name":"二木又土","can_delete":false,"product_type":"c1","uid":1296963,"ip_address":"","ucode":"7D939045990B4D","user_header":"https://static001.geekbang.org/account/avatar/00/13/ca/43/63bdc516.jpg","comment_is_top":false,"comment_ctime":1556157220,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1556157220","product_id":100024501,"comment_content":"“Upload your app’s symbols to receive symbolicated reports from Apple”，这个只能用户授权允许上传崩溃信息，开发者才能看到的吧","like_count":0},{"had_liked":false,"id":86456,"user_name":"wendell","can_delete":false,"product_type":"c1","uid":1182836,"ip_address":"","ucode":"4445CC15200C07","user_header":"https://static001.geekbang.org/account/avatar/00/12/0c/74/dc8e0bde.jpg","comment_is_top":false,"comment_ctime":1555379242,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1555379242","product_id":100024501,"comment_content":"@Mhy PLCrashReporter 导入项目中 出现 bitcode 问题，网上很少相关信息，请问怎么解？或者又没有可以替代它的来源库。谢谢🙏","like_count":0},{"had_liked":false,"id":84086,"user_name":"沉默是金","can_delete":false,"product_type":"c1","uid":1426919,"ip_address":"","ucode":"2F89ABDE3A8359","user_header":"https://static001.geekbang.org/account/avatar/00/15/c5/e7/84f2c620.jpg","comment_is_top":false,"comment_ctime":1554780498,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1554780498","product_id":100024501,"comment_content":"swift的Array的数组越界或者强制解包等等造成的崩溃，现在主流的三方像腾讯的bugly都无法捕获这个事件。不知道大家都是怎么捕获的","like_count":0},{"had_liked":false,"id":83844,"user_name":"Hy","can_delete":false,"product_type":"c1","uid":1239531,"ip_address":"","ucode":"BF6AC9AA9B26A7","user_header":"https://static001.geekbang.org/account/avatar/00/12/e9/eb/2394e520.jpg","comment_is_top":false,"comment_ctime":1554723471,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1554723471","product_id":100024501,"comment_content":"大佬，最好能出一个如何提高野指针闪退，进而减少线上闪退，比如释放掉的内存添加标记为已经释放，当有调用该内存时会闪退，来增加野指针复现度。","like_count":0},{"had_liked":false,"id":83839,"user_name":"Hy","can_delete":false,"product_type":"c1","uid":1239531,"ip_address":"","ucode":"BF6AC9AA9B26A7","user_header":"https://static001.geekbang.org/account/avatar/00/12/e9/eb/2394e520.jpg","comment_is_top":false,"comment_ctime":1554723118,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1554723118","product_id":100024501,"comment_content":"大佬，目前项目有动态库插件，app上线后有统计到有些动态库加载失败的闪退，大致理由是从xx路径未能加载A.framework，但是在另外一个路径xxy找到了A.framework。","like_count":0},{"had_liked":false,"id":83835,"user_name":"Hy","can_delete":false,"product_type":"c1","uid":1239531,"ip_address":"","ucode":"BF6AC9AA9B26A7","user_header":"https://static001.geekbang.org/account/avatar/00/12/e9/eb/2394e520.jpg","comment_is_top":false,"comment_ctime":1554722407,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1554722407","product_id":100024501,"comment_content":"微信读书有监测主线程卡顿的文章，起一个不会被退出的线程，监测主线程的runloop状态","like_count":0},{"had_liked":false,"id":83774,"user_name":"青冈","can_delete":false,"product_type":"c1","uid":1080446,"ip_address":"","ucode":"8E54B939937E6D","user_header":"http://thirdwx.qlogo.cn/mmopen/vi_32/DYAIOgq83eoYBX95GZxEdKz9LQJVwohUiaRxNge5WpHRbeOC2tGc2rsdpfYKCTKdQicBn8MvSrlZTX7HY2jS3YFA/132","comment_is_top":false,"comment_ctime":1554714404,"is_pvip":false,"replies":[{"id":"30354","content":"后台工作超时","user_name":"作者回复","user_name_real":"戴铭","uid":"1140280","ctime":1554791538,"ip_address":"","comment_id":83774,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1554714404","product_id":100024501,"comment_content":"Bugly中，针对应用进入后台被系统强杀也算是一种crash。这种怎么处理呢？","like_count":0,"discussions":[{"author":{"id":1140280,"avatar":"https://static001.geekbang.org/account/avatar/00/11/66/38/f9999b2b.jpg","nickname":"戴铭","note":"","ucode":"D61E685F962387","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":446142,"discussion_content":"后台工作超时","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1554791538,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":83682,"user_name":"Hy","can_delete":false,"product_type":"c1","uid":1239531,"ip_address":"","ucode":"BF6AC9AA9B26A7","user_header":"https://static001.geekbang.org/account/avatar/00/12/e9/eb/2394e520.jpg","comment_is_top":false,"comment_ctime":1554698742,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1554698742","product_id":100024501,"comment_content":"前排","like_count":0},{"had_liked":false,"id":83669,"user_name":"王强😄😄😄😁","can_delete":false,"product_type":"c1","uid":1342362,"ip_address":"","ucode":"A1F3F8B677BC02","user_header":"http://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTLB4OXWgz6l6IiaXKjABEU1iagBItV04ZnLicm4Aczxme80y2NFhdyn71x9VGyN7oXAQfVyPzY3c4ibYQ/132","comment_is_top":false,"comment_ctime":1554694801,"is_pvip":false,"replies":[{"id":"30268","content":"下一篇就是了","user_name":"作者回复","user_name_real":"戴铭","uid":"1140280","ctime":1554711315,"ip_address":"","comment_id":83669,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1554694801","product_id":100024501,"comment_content":"戴铭老师，主线程无响应 这个可以提前讲吗，最近工程需要到这个地方的知识，谢谢戴铭老师。","like_count":0,"discussions":[{"author":{"id":1140280,"avatar":"https://static001.geekbang.org/account/avatar/00/11/66/38/f9999b2b.jpg","nickname":"戴铭","note":"","ucode":"D61E685F962387","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":446121,"discussion_content":"下一篇就是了","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1554711315,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":83445,"user_name":"小前端","can_delete":false,"product_type":"c1","uid":1271383,"ip_address":"","ucode":"F9C45FDF0E9084","user_header":"https://static001.geekbang.org/account/avatar/00/13/66/57/f76f20b6.jpg","comment_is_top":false,"comment_ctime":1554603651,"is_pvip":false,"replies":[{"id":"30161","content":"一次启动最多一次崩溃，一次启动没有崩溃说明成功了，一次启动崩溃了说明失败了","user_name":"作者回复","user_name_real":"戴铭","uid":"1140280","ctime":1554617245,"ip_address":"","comment_id":83445,"utype":1}],"discussion_count":2,"race_medal":0,"score":"1554603651","product_id":100024501,"comment_content":"文中说Crash率一般是crash次数与启动次数的比值？是说我一天打开100次app，crash了两次，所以是2个点？我觉得是不是用DAU作为分母更合适？","like_count":0,"discussions":[{"author":{"id":1140280,"avatar":"https://static001.geekbang.org/account/avatar/00/11/66/38/f9999b2b.jpg","nickname":"戴铭","note":"","ucode":"D61E685F962387","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":446026,"discussion_content":"一次启动最多一次崩溃，一次启动没有崩溃说明成功了，一次启动崩溃了说明失败了","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1554617245,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1409087,"avatar":"https://static001.geekbang.org/account/avatar/00/15/80/3f/bc65b009.jpg","nickname":"Yest","note":"","ucode":"1E82B6355890C0","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":3035,"discussion_content":"有没有一种启动就崩溃，比如内存不足，这种能监控到启动or崩溃吗？如果不能，这样的情况，就影响不到 分子or分母了","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1564126976,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":83350,"user_name":"Adam","can_delete":false,"product_type":"c1","uid":1456034,"ip_address":"","ucode":"3CCF37176E2E6E","user_header":"https://static001.geekbang.org/account/avatar/00/16/37/a2/045733b3.jpg","comment_is_top":false,"comment_ctime":1554542624,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1554542624","product_id":100024501,"comment_content":"@Mhy  <br>1. iOS 9.0之后NSNotificationCenter不会对一个dealloc的观察者发送消息，所以如果iOS9.0之前的系统需要add 需要 remove 来保证不会出现delloc后找不到观察者导致崩溃<br>‘If your app targets iOS 9.0 and later or OS X v10.11 and later, you don&#39;t need to unregister an observer in its deallocation method。’<br><br>2. NSNotification 有很多种线程实现方式，同步、异步、聚合，所以不恰当的线程发送和接收会出现崩溃问题。这里情况比较多，可以查询相关资料。","like_count":0},{"had_liked":false,"id":83272,"user_name":"Dude","can_delete":false,"product_type":"c1","uid":1453365,"ip_address":"","ucode":"71341F7E27CFB8","user_header":"http://thirdwx.qlogo.cn/mmopen/vi_32/DYAIOgq83eqzYdgPK7wApOch4BlROWdiarexic8KmhqBEH2IicFj93HzqcwPSn5KpKjptraCVZ4AMs9bWeQglIorQ/132","comment_is_top":false,"comment_ctime":1554511950,"is_pvip":false,"replies":[{"id":"30123","content":"崩溃列表点击进去就可以看到详情了","user_name":"作者回复","user_name_real":"戴铭","uid":"1140280","ctime":1554549406,"ip_address":"","comment_id":83272,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1554511950","product_id":100024501,"comment_content":"Bugly中在哪可以看到异常编码？","like_count":0,"discussions":[{"author":{"id":1140280,"avatar":"https://static001.geekbang.org/account/avatar/00/11/66/38/f9999b2b.jpg","nickname":"戴铭","note":"","ucode":"D61E685F962387","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":445951,"discussion_content":"崩溃列表点击进去就可以看到详情了","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1554549406,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]}]}