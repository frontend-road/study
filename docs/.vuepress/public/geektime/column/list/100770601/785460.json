{"id":785460,"title":"12ï½œæ·±å…¥ç†è§£Word2Vecï¼šè§£å¼€è¯å‘é‡ç”Ÿæˆçš„å¥¥ç§˜","content":"<p>ä½ å¥½ï¼Œæˆ‘æ˜¯ç‹¬è¡Œã€‚</p><p>å‰é¢å‡ èŠ‚è¯¾æˆ‘ä»¬å­¦ä¹ äº†æœºå™¨å­¦ä¹ å’ŒNLPçš„åŸºæœ¬ç†è®ºï¼Œç›¸ä¿¡ä½ å¯¹äººå·¥æ™ºèƒ½å·²ç»æœ‰äº†åˆæ­¥çš„è®¤è¯†ã€‚è¿™èŠ‚è¯¾æˆ‘ä»¬å­¦ä¹ Word2Vecï¼Œé¡¾åæ€ä¹‰å°±æ˜¯<strong>è¯è¯­ to å‘é‡</strong>ã€‚æˆ‘ä»¬ä¸Šä¸€èŠ‚è¯¾å­¦ä¹ çš„NLPè¿‡ç¨‹ï¼Œåœ¨æ–‡æœ¬é¢„å¤„ç†ä¹‹åï¼Œæœ‰ä¸€ä¸ªç‰¹å¾æå–ï¼Œå…¶ä¸­å°±æ¶‰åŠåˆ°å°†è¯è¯­è½¬åŒ–æˆæ•°å€¼å½¢å¼ï¼Œä»¥ä¾¿è®¡ç®—æœºèƒ½å¤Ÿç†è§£ï¼ŒæŒ‡çš„å°±æ˜¯Word2Vecçš„è¿‡ç¨‹ã€‚</p><p>ä¸ºä»€ä¹ˆè¦å­¦ä¹ Word2Vecï¼Ÿè¿˜æ˜¯ä¸ºäº†ç†è§£å¤§æ¨¡å‹çš„åŸç†æ‰“åŸºç¡€ï¼Œæˆ‘ä»¬æ•´ä¸ªè¯¾ç¨‹çš„ç›®çš„ä¹‹ä¸€å°±æ˜¯å¼„æ‡‚å¤§è¯­è¨€æ¨¡å‹çš„åŸç†ï¼Œæ‰€ä»¥åœ¨æ­£å¼å­¦ä¹ Transformerä¹‹å‰ï¼Œæˆ‘ä¼šä¸ºä½ ä»‹ç»ä¸€äº›å‰ç½®çŸ¥è¯†ï¼Œé™¤äº†ä¹‹å‰è®²è§£çš„MLå’ŒNLPçš„åŸºæœ¬æ¦‚å¿µå¤–ï¼Œè¿˜åŒ…æ‹¬Word2Vecä»¥åŠåé¢çš„Seq2Seqç­‰ã€‚ä¸‹é¢æˆ‘ä»¬å¼€å§‹ç”±æµ…å…¥æ·±å­¦ä¹ ä¸‹Word2Vecã€‚</p><h2>Word2Vec</h2><p>Word2Vecæ˜¯ä¸€ç§å¹¿æ³›ä½¿ç”¨çš„NLPæŠ€æœ¯ï¼Œç›®çš„æ˜¯å°†è¯è¯­è½¬æ¢æˆå‘é‡å½¢å¼ï¼Œä½¿è®¡ç®—æœºèƒ½å¤Ÿç†è§£ã€‚å®ƒé€šè¿‡å­¦ä¹ å¤§é‡æ–‡æœ¬æ•°æ®ï¼Œæ•æ‰åˆ°è¯è¯­é—´çš„ä¸Šä¸‹æ–‡å…³ç³»ï¼Œè¿›è€Œç”Ÿæˆè¯çš„é«˜ç»´è¡¨ç¤ºï¼Œå³è¯å‘é‡ã€‚</p><p>Word2Vecæœ‰ä¸¤ç§ä¸»è¦æ¨¡å‹ï¼šSkip-Gramå’ŒCBOWï¼ŒSkip-Gramçš„ç›®æ ‡æ˜¯æ ¹æ®ç›®æ ‡è¯é¢„æµ‹å…¶å‘¨å›´çš„ä¸Šä¸‹æ–‡è¯æ±‡ï¼Œä¸ä¹‹ç›¸åï¼ŒCBOWæ¨¡å‹çš„ç›®æ ‡æ˜¯æ ¹æ®å‘¨å›´çš„ä¸Šä¸‹æ–‡è¯æ±‡æ¥é¢„æµ‹ç›®æ ‡è¯ã€‚Word2Vecçš„ä¼˜ç‚¹æ˜¯èƒ½å¤Ÿæ­ç¤ºè¯ä¸è¯ä¹‹é—´çš„ç›¸ä¼¼æ€§ï¼Œæ¯”å¦‚é€šè¿‡è®¡ç®—å‘é‡ä¹‹é—´çš„è·ç¦»æ¥æ‰¾åˆ°è¯­ä¹‰ä¸Šç›¸è¿‘çš„è¯ã€‚Word2Vecçš„åº”ç”¨éå¸¸å¹¿æ³›ï¼ŒåŒ…æ‹¬ä½†ä¸é™äºæƒ…æ„Ÿåˆ†æã€æœºå™¨ç¿»è¯‘å’Œæ¨èç³»ç»Ÿç­‰ã€‚å°½ç®¡éå¸¸æœ‰ç”¨ï¼Œä½†æ˜¯å®ƒä¹Ÿæœ‰å±€é™æ€§ï¼Œæ¯”å¦‚æ— æ³•å¤„ç†å¤šä¹‰è¯ï¼Œå› ä¸ºæ¯ä¸ªè¯ä»…è¢«èµ‹äºˆä¸€ä¸ªå‘é‡ï¼Œä¸è€ƒè™‘ä¸Šä¸‹æ–‡ä¸­çš„å¤šç§å«ä¹‰ã€‚</p><!-- [[[read_end]]] --><h2>æ¨¡å‹æ¶æ„</h2><p>Word2Vecæ¨¡å‹åŸºäºä¸¤ç§ä¸»è¦æ¶æ„ï¼šè¿ç»­è¯è¢‹ï¼ˆContinuous Bag of Words, CBOWï¼‰å’Œè·³å­—æ¨¡å‹ï¼ˆSkip-Gramï¼‰ã€‚ä½ å¯ä»¥çœ‹ä¸€ä¸‹è¿™ä¸¤ç§æ¶æ„çš„ç¤ºæ„å›¾ã€‚</p><p><img src=\"https://static001.geekbang.org/resource/image/bb/96/bb02a2747856d8614dc1e9c185526a96.png?wh=2422x1106\" alt=\"\"></p><h4>è¿ç»­è¯è¢‹ï¼ˆCBOWï¼‰</h4><p>ç¤ºæ„å›¾å·¦åŠéƒ¨åˆ†æ˜¯CBOWæ¨¡å‹ï¼Œå®ƒæ˜¯ä¸€ç§é€šè¿‡ä¸Šä¸‹æ–‡é¢„æµ‹ç›®æ ‡è¯çš„ç¥ç»ç½‘ç»œæ¶æ„ã€‚åœ¨Word2Vecä¸­ï¼ŒCBOWå°è¯•ä»ä¸€ä¸ªè¯çš„â€œä¸Šä¸‹æ–‡â€æ¥é¢„æµ‹è¿™ä¸ªè¯æœ¬èº«ã€‚ä¸Šä¸‹æ–‡ç”±ç›®æ ‡è¯å‘¨å›´çš„ä¸€ä¸ªæˆ–å¤šä¸ªè¯ç»„æˆï¼Œè¿™ä¸ªæ•°ç›®ç”±çª—å£å¤§å°å†³å®šã€‚çª—å£æ˜¯æŒ‡ä¸Šä¸‹æ–‡è¯è¯­çš„èŒƒå›´ï¼Œå¦‚æœçª—å£ä¸º10ï¼Œé‚£ä¹ˆæ¨¡å‹å°†ä½¿ç”¨ç›®æ ‡è¯å‰åå„10ä¸ªè¯ã€‚</p><h4>è·³å­—æ¨¡å‹ï¼ˆSkip-Gramï¼‰</h4><p>ç¤ºæ„å›¾çš„å³åŠéƒ¨åˆ†æ˜¯Skip-Gramæ¨¡å‹ï¼Œå®ƒæ˜¯ä¸€ç§é€šè¿‡ä¸€ä¸ªç»™å®šçš„ç›®æ ‡è¯æ¥é¢„æµ‹å…¶ä¸Šä¸‹æ–‡è¯çš„ç¥ç»ç½‘ç»œæ¶æ„ã€‚ä¸CBOWæ¨¡å‹ç›¸åï¼ŒSkip-Gramæ¯æ¬¡æ¥æ”¶ä¸€ä¸ªè¯ä½œä¸ºè¾“å…¥ï¼Œå¹¶é¢„æµ‹å®ƒå‘¨å›´çš„è¯ï¼Œè¿™ä½¿å…¶åœ¨å¤„ç†è¾ƒå¤§æ•°æ®é›†å’Œæ•è·ç½•è§è¯æˆ–çŸ­è¯­æ—¶è¡¨ç°æ›´å‡ºè‰²ã€‚</p><h2>æ„å»ºè‡ªå·±çš„Word2Vecæ¨¡å‹</h2><p>åŸºäºä¸Šè¿°çš„æ¶æ„ï¼Œæˆ‘ä»¬è‡ªå·±ä»0ï½1æ„å»ºä¸€ä¸ªWord2Vecæ¨¡å‹ã€‚</p><h4>æ•°æ®æ”¶é›†å’Œé¢„å¤„ç†</h4><p>æˆ‘ä»ç½‘ä¸Šä¸‹è½½äº†ä¸€ä¸ªå…¬å¼€çš„<a href=\"http://www.nlpir.org/wordpress/2017/12/03/nlpir%E5%BE%AE%E5%8D%9A%E5%86%85%E5%AE%B9%E8%AF%AD%E6%96%99%E5%BA%93-23%E4%B8%87%E6%9D%A1/\">å¾®åšå†…å®¹æ•°æ®é›†</a>ã€‚æˆ‘ä»¬å…ˆè¿›è¡Œæ–‡æœ¬é¢„å¤„ç†ã€‚å›æƒ³ä¸€ä¸‹æˆ‘ä»¬å‰å‡ èŠ‚è¯¾æåˆ°çš„æ–¹æ³•ï¼Œæ­¥éª¤å°±æ˜¯æ•°æ®åŠ è½½-&gt;å»é™¤åœç”¨è¯-&gt;åˆ†è¯ç­‰ç­‰ã€‚è¿™é‡Œæˆ‘ä»¬å°±è¿›è¡Œè¿™äº›ç®€å•çš„é¢„å¤„ç†æ“ä½œã€‚</p><pre><code class=\"language-python\">import jieba\nimport xml.etree.ElementTree as ET\n\n# è¯»å–XMLæ–‡ä»¶å¹¶è§£æ\nfile_path = 'data.xml'\ntree = ET.parse(file_path)\nroot = tree.getroot()\n\n# è·å–æ‰€æœ‰&lt;article&gt;æ ‡ç­¾çš„å†…å®¹\ntexts = [record.find('article').text for record in root.findall('RECORD')]\nprint(len(texts))\n\n# åœç”¨è¯åˆ—è¡¨ï¼Œå®é™…åº”ç”¨ä¸­éœ€è¦æ ¹æ®å®é™…æƒ…å†µæ‰©å±•\nstop_words = set([\"çš„\", \"äº†\", \"åœ¨\", \"æ˜¯\", \"æˆ‘\", \"æœ‰\", \"å’Œ\", \"å°±\"])\n\n# åˆ†è¯å’Œå»é™¤åœç”¨è¯\nprocessed_texts = []\nfor text in texts:\n    if text is not None:\n        words = jieba.cut(text)\n        processed_text = [word for word in words if word not in stop_words]\n        processed_texts.append(processed_text)\n\n# æ‰“å°é¢„å¤„ç†åçš„æ–‡æœ¬\nfor text in processed_texts:\n    print(text)\n\n</code></pre><p>é¢„å¤„ç†å®Œæˆåï¼Œäº§ç”Ÿäº†40831æ¡æ•°æ®ç”¨æ¥è®­ç»ƒã€‚</p><h4>è®­ç»ƒæ¨¡å‹</h4><p>æˆ‘ä»¬ç›´æ¥ä½¿ç”¨gensimåº“ï¼Œè¿™ä¸ªåº“æä¾›äº†ä¸€ä¸ªç®€æ´çš„APIæ¥è®­ç»ƒWord2Vecæ¨¡å‹ã€‚æˆ‘ä»¬é€‰æ‹©CBOWæ¨¡å‹ã€‚vector_sizeå‚æ•°è®¾ç½®äº†è¯å‘é‡çš„ç»´åº¦ï¼Œwindowå‚æ•°è®¾ç½®äº†ä¸Šä¸‹æ–‡çª—å£çš„å¤§å°ï¼Œmin_countå‚æ•°è®¾ç½®äº†è¯é¢‘çš„æœ€å°é˜ˆå€¼ï¼Œworkerså‚æ•°è®¾ç½®äº†è®­ç»ƒçš„çº¿ç¨‹æ•°ï¼Œsg=1è¡¨ç¤ºä½¿ç”¨Skip-Gramæ¶æ„ï¼Œsg=0è¡¨ç¤ºä½¿ç”¨CBOWæ¶æ„ã€‚ä½ å¯ä»¥çœ‹ä¸€ä¸‹å…·ä½“çš„ä»£ç ã€‚</p><pre><code class=\"language-python\"># è®­ç»ƒWord2Vecæ¨¡å‹\nmodel = Word2Vec(sentences=processed_texts, vector_size=100, window=5, min_count=1, workers=4, sg=1)\n# ä¿å­˜æ¨¡å‹\nmodel.save(\"word2vec.model\")\n</code></pre><p>å½“æ‰§è¡Œå®Œä¸Šé¢çš„ä»£ç åï¼Œæœ¬åœ°ç”Ÿæˆäº†3ä¸ªæ–‡ä»¶ã€‚</p><ol>\n<li><strong>word2vec.model</strong>ï¼šä¸»æ¨¡å‹æ–‡ä»¶ï¼ŒåŒ…å«äº†æ¨¡å‹çš„å‚æ•°ã€è¯æ±‡è¡¨ç­‰ä¿¡æ¯ã€‚ä¸ä»…å­˜å‚¨äº†æ¨¡å‹çš„æ¶æ„ä¿¡æ¯ï¼Œè¿˜åŒ…æ‹¬äº†è¯æ±‡é¢‘ç‡ã€æ¨¡å‹è®­ç»ƒçŠ¶æ€ç­‰ã€‚è¿™ä¸ªæ–‡ä»¶æ˜¯åŠ è½½å®Œæ•´æ¨¡å‹æ‰€å¿…éœ€çš„ã€‚</li>\n<li><strong>word2vec.model.wv.vectors.npy</strong>ï¼šè¿™ä¸ªæ–‡ä»¶å­˜å‚¨äº†æ¨¡å‹ä¸­æ‰€æœ‰è¯æ±‡çš„è¯å‘é‡ã€‚Word2Vecæ¨¡å‹é€šè¿‡å­¦ä¹ è¿™äº›è¯å‘é‡æ¥æ•æ‰è¯è¯­ä¹‹é—´çš„å…³ç³»ã€‚.npyæ˜¯NumPyæ•°ç»„çš„æ–‡ä»¶æ ¼å¼ï¼Œè¿™æ„å‘³ç€è¿™äº›å‘é‡æ˜¯ä»¥NumPyæ•°ç»„çš„å½¢å¼å­˜å‚¨çš„ï¼Œå¯ä»¥é«˜æ•ˆåœ°åŠ è½½å’Œå¤„ç†ã€‚</li>\n<li><strong>word2vec.model.syn1neg.npy</strong>ï¼šè¿™ä¸ªæ–‡ä»¶å­˜å‚¨çš„æ˜¯è®­ç»ƒè¿‡ç¨‹ä¸­ä½¿ç”¨çš„è´Ÿé‡‡æ ·æƒé‡ã€‚å½“è®¾ç½®Word2Vecæ¨¡å‹çš„negativeå‚æ•°å¤§äº0æ—¶ï¼Œå¯ç”¨è´Ÿé‡‡æ ·æ¥ä¼˜åŒ–æ¨¡å‹çš„è®­ç»ƒè¿‡ç¨‹ã€‚è¿™ä¸ªæ–‡ä»¶ä¸­çš„æƒé‡æ˜¯æ¨¡å‹è®­ç»ƒä¸­ç”¨äºè´Ÿé‡‡æ ·çš„éƒ¨åˆ†ï¼Œå¯¹äºæ¨¡å‹çš„å­¦ä¹ å’Œç”Ÿæˆè¯å‘é‡è‡³å…³é‡è¦ã€‚</li>\n</ol><h4>è¯„ä¼°ä¸åº”ç”¨</h4><p>æ¨¡å‹è®­ç»ƒå®Œæˆï¼Œæˆ‘ä»¬å¯ä»¥ç®€å•çœ‹ä¸€ä¸‹æ•ˆæœã€‚</p><pre><code class=\"language-python\"># åŠ è½½æ¨¡å‹\nmodel = Word2Vec.load(\"word2vec.model\")\nprint(\"æ¨¡å‹åŠ è½½å®Œæˆ\")\n\n# ä½¿ç”¨æ¨¡å‹\n# è·å–ä¸€ä¸ªè¯çš„å‘é‡\nprint(model.wv['ç§‘æŠ€'])\n\n# æ‰¾åˆ°æœ€ç›¸ä¼¼çš„è¯\nsimilar_words = model.wv.most_similar('ç§‘æŠ€', topn=5)\nprint(similar_words)\n</code></pre><p>ç¨‹åºè¾“å‡ºå¦‚ä¸‹ï¼š</p><pre><code class=\"language-python\">[ 0.08377746&nbsp; 1.4331518&nbsp; &nbsp;0.5016794&nbsp; -0.09138884 -0.1221515&nbsp; -0.08544948\n&nbsp; 0.20863684&nbsp; 0.9883061&nbsp; -0.26002824 -0.02130504&nbsp; 0.43953782 -0.11446979\n&nbsp; 0.4636304&nbsp; -0.67642045&nbsp; 0.47473285 -0.4832982&nbsp; &nbsp;0.35540286 -0.5201831\n&nbsp; 0.0174433&nbsp; -0.40980706 -0.14922573&nbsp; 0.5372444&nbsp; &nbsp;0.53256696 -0.4517828\n&nbsp;-1.1696991&nbsp; &nbsp;0.32669672 -0.34389514&nbsp; 0.5889707&nbsp; -0.20616521 -0.20512877\n&nbsp; 0.6516593&nbsp; -1.3999687&nbsp; -0.00352089&nbsp; 0.422699&nbsp; &nbsp;-0.32610646&nbsp; 1.5900621\n&nbsp; 0.8748267&nbsp; -0.00933662 -0.77871656 -0.2894545&nbsp; &nbsp;0.7261106&nbsp; -0.05075585\n&nbsp;-0.5845707&nbsp; &nbsp;0.7334658&nbsp; -0.22150414&nbsp; 0.3801838&nbsp; -0.50801146 -0.8370443\n&nbsp;-0.03138219&nbsp; 0.08028921&nbsp; 0.2562184&nbsp; -0.49664307 -0.8038274&nbsp; &nbsp;0.0211964\n&nbsp;-0.6316118&nbsp; &nbsp;0.12551498&nbsp; 0.58615136&nbsp; 0.467213&nbsp; &nbsp;-0.15562508 -0.58768135\n&nbsp; 0.07793431&nbsp; 0.19536994 -0.1413024&nbsp; -0.3790597&nbsp; &nbsp;0.19154921&nbsp; 0.4437868\n&nbsp; 0.08398101&nbsp; 0.10911901 -0.6428759&nbsp; -0.07833739 -0.8982224&nbsp; &nbsp;0.8185256\n&nbsp; 0.4029754&nbsp; &nbsp;0.05831718 -0.23952699&nbsp; 0.06487722 -0.6090112&nbsp; -0.03935737\n&nbsp;-0.1745928&nbsp; &nbsp;0.2225394&nbsp; -0.7901157&nbsp; -0.08253222 -0.3205032&nbsp; &nbsp;0.16001679\n&nbsp;-0.06188322 -0.4120766&nbsp; -0.55351204&nbsp; 1.1411817&nbsp; -0.24971966&nbsp; 0.01067457\n&nbsp; 0.205598&nbsp; &nbsp; 0.4778782&nbsp; -0.2214068&nbsp; -0.5329161&nbsp; &nbsp;0.9778511&nbsp; &nbsp;0.5545867\n&nbsp; 0.50671256&nbsp; 0.6427801&nbsp; -0.45557818 -0.29751778]\n[('äº§ä¸š', 0.9526691436767578), ('åˆ›æ–°', 0.9492118954658508), ('ç”Ÿæ€', 0.9462338089942932), ('åº”ç”¨', 0.9439343810081482), ('æˆ˜ç•¥', 0.9437689185142517)]\n</code></pre><p>è¿™æ˜¯ä¸€ä¸ª100ç»´çš„å‘é‡ç©ºé—´ï¼Œå’Œç§‘æŠ€æ¯”è¾ƒç›¸ä¼¼çš„è¯æœ‰äº§ä¸šã€åˆ›æ–°ã€ç”Ÿæ€ã€åº”ç”¨ã€æˆ˜ç•¥ã€‚çœ‹ç€è¿˜æŒºåƒè¿™ä¹ˆå›äº‹ï¼ŒåŸºæœ¬å‡†ç¡®çš„ã€‚æˆ‘ä»¬æ€ä¹ˆç§‘å­¦åœ°è¿›è¡Œè¯„ä¼°å‘¢ï¼Ÿæœ‰å¥½å‡ ç§æ–¹å¼ã€‚</p><ol>\n<li><strong>è¯ç›¸ä¼¼åº¦è®¡ç®—ï¼š</strong>é€šè¿‡æ¯”è¾ƒæ¨¡å‹ç”Ÿæˆçš„è¯ä¸äººå·¥æ ‡æ³¨çš„è¯çš„ç›¸ä¼¼åº¦ï¼Œæ¥è¯„ä¼°æ¨¡å‹ï¼Œä¸€è‡´æ€§è¶Šé«˜ï¼Œè¯´æ˜æ•ˆæœè¶Šå¥½ã€‚å¸¸ç”¨çš„æ•°æ®é›†åŒ…æ‹¬WordSim-353ã€SimLex-999ç­‰ã€‚</li>\n<li><strong>è¯ç±»æ¯”è®¡ç®—ï¼š</strong>è¯„ä¼°æ¨¡å‹åœ¨è§£å†³â€œè¯Aä¹‹äºè¯Bå¦‚åŒè¯Cä¹‹äºä»€ä¹ˆâ€è¿™ç±»é—®é¢˜çš„èƒ½åŠ›ï¼Œæ¯”å¦‚ï¼ŒåŒ—äº¬ä¹‹äºä¸­å›½å¦‚åŒå·´é»ä¹‹äºä»€ä¹ˆï¼Ÿ</li>\n<li><strong>OOVè¯æ¯”ç‡ï¼š</strong>è¯„ä¼°æ•°æ®é›†ä¸­æœ‰å¤šå°‘è¯å¯¹å› ä¸ºåŒ…å«æœªçŸ¥è¯ï¼ˆæ¨¡å‹è¯æ±‡è¡¨å¤–çš„è¯ï¼‰è€Œè¢«æ’é™¤åœ¨è¯„ä¼°ä¹‹å¤–çš„æ¯”ç‡ã€‚ç†æƒ³æƒ…å†µä¸‹ï¼ŒOOVç‡åº”è¯¥å°½å¯èƒ½ä½ï¼Œä»¥ç¡®ä¿è¯„ä¼°ç»“æœèƒ½æ›´å…¨é¢åœ°ä»£è¡¨æ¨¡å‹çš„æ€§èƒ½ã€‚</li>\n<li><strong>å®šæ€§åˆ†æï¼š</strong>å¯¹äºç»™å®šçš„è¯æ±‡ï¼ŒæŸ¥çœ‹æ¨¡å‹è®¤ä¸ºä¸å…¶æœ€ç›¸ä¼¼çš„å…¶ä»–è¯æ±‡ï¼Œåˆ¤æ–­è¿™äº›ç›¸ä¼¼è¯æ˜¯å¦ç¬¦åˆé¢„æœŸã€‚</li>\n<li><strong>å®é™…åº”ç”¨ï¼š</strong>å°†Word2Vecæ¨¡å‹åº”ç”¨åˆ°å…·ä½“çš„ä¸‹æ¸¸ä»»åŠ¡ï¼Œå¦‚æ–‡æœ¬åˆ†ç±»ã€æƒ…æ„Ÿåˆ†æã€å®ä½“è¯†åˆ«ç­‰ï¼Œè§‚å¯Ÿæ¨¡å‹è¡¨ç°çš„æå‡ã€‚é€šè¿‡æ¯”è¾ƒä½¿ç”¨Word2Vecè¯å‘é‡å‰åçš„ä»»åŠ¡è¡¨ç°ï¼Œå¯ä»¥é—´æ¥è¯„ä¼°Word2Vecæ¨¡å‹çš„æœ‰æ•ˆæ€§ã€‚</li>\n</ol><p>æˆ‘ä»¬é‡‡ç”¨ç¬¬ä¸€ç§æ–¹å¼ï¼Œæ¥è¯¦ç»†çœ‹ä¸€ä¸‹è¯„ä¼°è¿‡ç¨‹ã€‚</p><p>é¦–å…ˆï¼Œæ‰‹åŠ¨åˆ›å»ºè¯„ä¼°æ•°æ®é›† <a href=\"https://pan.baidu.com/s/1Z8jbZJin5glccoK7hHsPsg?pwd=2vmk\">valid.tsv</a>ï¼Œå†…å®¹å¦‚ä¸‹ï¼š</p><p><img src=\"https://static001.geekbang.org/resource/image/76/c5/7618b4b032aaf28c88cf616a6f6613c5.jpg?wh=1050x1168\" alt=\"å›¾ç‰‡\"></p><p>æ€»å…±3åˆ—ï¼Œç¬¬1åˆ—å’Œç¬¬2åˆ—æ˜¯ç›¸ä¼¼è¯ï¼Œç¬¬3åˆ—æ˜¯æˆ‘äººå·¥æ‰“çš„åˆ†ï¼Œå®é™…è¯„ä¼°è¿‡ç¨‹ä¸­ï¼Œè¯„ä¼°æ•°æ®é›†å¯ä»¥è‡ªå·±åŸºäºåå¥½è¿›è¡Œäººå·¥æ‰“åˆ†ï¼ŒåŒæ—¶ï¼Œå‡†å¤‡çš„è¯æ±‡æ•°é‡å¯ä»¥å†å¤šä¸€äº›ï¼Œä¸ºäº†èŠ‚çœæ—¶é—´ï¼Œæˆ‘åªå‡†å¤‡äº†äºŒåæ¥ä¸ªè¯ã€‚æ•°æ®é›†å‡†å¤‡å¥½å°±å¯ä»¥è¯„ä¼°äº†ã€‚</p><pre><code class=\"language-python\"># åŠ è½½æ¨¡å‹\nmodel = Word2Vec.load(\"word2vec.model\")\nprint(\"æ¨¡å‹åŠ è½½å®Œæˆ\")\n# ç±»æ¯”\nresult = model.wv.evaluate_word_pairs(\"valid.tsv\")\nprint(result)\n\n</code></pre><p>è¿è¡Œç¨‹åºè¾“å…¥å¦‚ä¸‹ç»“æœï¼š</p><pre><code class=\"language-plain\">(PearsonRResult(statistic=0.5510228130115481, pvalue=0.021875787422131296), SignificanceResult(statistic=0.5076852492192858, pvalue=0.03748715633121946), 10.526315789473683)\n</code></pre><p>æ•´ä½“åˆ†ä¸ºPearsonå’ŒSpearmanç›¸å…³æ€§ç³»æ•°ï¼Œä»¥åŠOOVç‡ï¼Œå…ˆæ¥çœ‹Pearsonç³»æ•°ã€‚</p><ul>\n<li>\n<p>statistic=0.5510228130115481ï¼šèŒƒå›´ä»-1åˆ°1ï¼Œå…¶ä¸­1è¡¨ç¤ºå®Œå…¨æ­£ç›¸å…³ï¼Œ-1è¡¨ç¤ºå®Œå…¨è´Ÿç›¸å…³ï¼Œ0è¡¨ç¤ºæ— ç›¸å…³ã€‚è¿™ä¸ªå€¼0.55æ„å‘³ç€æˆ‘ä»¬çš„æ¨¡å‹è¯å‘é‡ä¸äººå·¥è¯„åˆ†ä¹‹é—´å­˜åœ¨ä¸­ç­‰ç¨‹åº¦çš„æ­£ç›¸å…³ã€‚</p>\n</li>\n<li>\n<p>pvalue=0.021875787422131296ï¼šè¿™æ˜¯på€¼ï¼Œç”¨äºæ£€éªŒç›¸å…³æ€§çš„ç»Ÿè®¡æ˜¾è‘—æ€§ã€‚ä¸€ä¸ªå¸¸ç”¨çš„æ˜¾è‘—æ€§æ°´å¹³é˜ˆå€¼æ˜¯0.05ã€‚è¿™ä¸ªpå€¼çº¦0.022ï¼Œå°äº0.05ï¼Œæ„å‘³ç€è¿™ä¸ªç›¸å…³æ€§æ˜¯ç»Ÿè®¡æ˜¾è‘—çš„ï¼Œæˆ‘ä»¬æœ‰è¶³å¤Ÿçš„è¯æ®è®¤ä¸ºæ¨¡å‹çš„è¯å‘é‡ä¸äººå·¥è¯„åˆ†ä¹‹é—´çš„ç›¸å…³æ€§ä¸æ˜¯å¶ç„¶å‡ºç°çš„ã€‚ç®€å•æ¥è®²å°±åƒæ‘‡å¥–ç°åœºçš„å…¬è¯å‘˜ä¸€æ ·ï¼Œè¯æ˜è¯„ä¼°ç»“æœä¸æ˜¯å¶ç„¶çš„ï¼Œæ˜¯æœ‰è¯´æœåŠ›çš„ã€‚<br>\nå†æ¥çœ‹Spearmanç³»æ•°ã€‚</p>\n</li>\n<li>\n<p>statistic=0.5076852492192858ï¼šåŒæ ·èŒƒå›´ä»-1åˆ°1ã€‚Spearmanç›¸å…³æ€§è€ƒè™‘çš„æ˜¯å˜é‡ä¹‹é—´çš„ç­‰çº§ç›¸å…³ï¼Œè€Œä¸æ˜¯ç›´æ¥çš„æ•°å€¼å¤§å°ã€‚è¿™ä¸ªå€¼0.51ä¹Ÿè¡¨ç¤ºäº†ä¸­ç­‰ç¨‹åº¦çš„æ­£ç›¸å…³ã€‚</p>\n</li>\n<li>\n<p>pvalue=0.03748715633121946ï¼šåŒæ ·æ˜¯på€¼ï¼Œå°äº0.05çš„å¸¸ç”¨æ˜¾è‘—æ€§æ°´å¹³ï¼Œè¡¨ç¤ºè¿™ç§ç›¸å…³æ€§æ˜¯ç»Ÿè®¡æ˜¾è‘—çš„ã€‚<br>\næœ€åçœ‹ä¸‹OOVç‡ï¼Œå°±æ˜¯è¯„ä¼°æ•°æ®é›†ä¸­å‡ºç°çš„è¯æ±‡ä¸åœ¨æ¨¡å‹è¯æ±‡è¡¨é‡Œçš„æ¦‚ç‡ã€‚</p>\n</li>\n<li>\n<p>10.526315789473683ï¼šè¡¨ç¤ºåœ¨æˆ‘ä»¬çš„è¯„ä¼°æ•°æ®é›†ä¸­ï¼Œæœ‰å¤§çº¦10.53%çš„è¯å¯¹åŒ…å«è‡³å°‘ä¸€ä¸ªä¸åœ¨æ¨¡å‹è¯æ±‡è¡¨ä¸­çš„è¯ï¼ˆOOVè¯ï¼‰ã€‚è¿™éƒ¨åˆ†è¯å¯¹åœ¨è¯„ä¼°è¿‡ç¨‹ä¸­è¢«å¿½ç•¥ï¼Œä¸å‚ä¸ç›¸å…³æ€§è®¡ç®—ã€‚</p>\n</li>\n</ul><p>æ€»ä½“çœ‹ï¼Œä¸€ä¸ªå¥½çš„Word2Vecæ¨¡å‹åº”è¯¥åœ¨ç›¸å…³æ€§æµ‹è¯•ä¸­å±•ç°å‡ºä¸äººç±»åˆ¤æ–­ä¸€è‡´çš„è¶‹åŠ¿ï¼Œæ¯”å¦‚æœ‰è¾ƒé«˜çš„Pearsonå’ŒSpearmanç›¸å…³æ€§ç³»æ•°ã€å…·æœ‰ç»Ÿè®¡æ˜¾è‘—æ€§ï¼Œå³è¾ƒä½çš„på€¼ï¼ŒåŒæ—¶å…·æœ‰å¯æ¥å—çš„OOVç‡ã€‚</p><p>æˆ‘ä»¬æœ¬æ¬¡è®­ç»ƒçš„æ¨¡å‹ï¼Œç›¸å…³æ€§ç³»æ•°å‘ˆä¸­ç­‰ï¼Œç»Ÿè®¡æ˜¾è‘—çš„på€¼è¾ƒä½ï¼Œè¡¨æ˜æ¨¡å‹æœ‰ä¸€å®šæ•ˆæœï¼Œä½†æ˜¯å¦â€œè¶³å¤Ÿå¥½â€è¿˜éœ€è¦æ ¹æ®æ¨¡å‹çš„å®é™…åº”ç”¨åœºæ™¯å’Œè¦æ±‚æ¥å†³å®šã€‚æ¯”å¦‚ï¼Œå¯¹äºä¸€äº›åº”ç”¨æ¥è¯´ï¼Œå¯èƒ½éœ€è¦æ›´é«˜çš„ç›¸ä¼¼åº¦å‡†ç¡®æ€§ï¼›è€Œå¯¹äºå…¶ä»–åº”ç”¨æ¥è¯´ï¼Œå½“å‰æ¨¡å‹çš„è¡¨ç°å¯èƒ½å·²ç»è¶³å¤Ÿã€‚å¦å¤–ï¼Œæˆ‘ä»¬è¿˜éœ€è¦æ¢ç´¢é™ä½OOVç‡çš„æ–¹æ³•ï¼Œæ¯”å¦‚æ‰©å¤§è®­ç»ƒæ•°æ®é›†æˆ–é‡‡ç”¨é¢„è®­ç»ƒçš„è¯å‘é‡ï¼Œå¯èƒ½ä¼šè¿›ä¸€æ­¥æå‡æ¨¡å‹çš„è¡¨ç°ã€‚</p><p>å…¶ä»–è¯„ä¼°æ–¹æ³•æˆ‘ä»¬å°±ä¸ä¸€ä¸€å°è¯•äº†ï¼Œå¤§åŒå°å¼‚ï¼Œæ„Ÿå…´è¶£çš„è¯ï¼Œä½ å¯ä»¥æŒ¨ä¸ªè¯•ä¸€ä¸‹ã€‚</p><h2>æ¨¡å‹çš„ä¼˜ç¼ºç‚¹</h2><p>ä¸ºä»€ä¹ˆWord2Vecä½¿ç”¨å¾—æ¯”è¾ƒå¹¿æ³›å‘¢ï¼Ÿä»ä¸Šé¢çš„å­¦ä¹ è¿‡ç¨‹ä¸­ï¼Œæˆ‘ä»¬å°±èƒ½çœ‹å‡ºæ¥ï¼ŒWord2Vec æ€»ä½“ä¸Šè¿˜æ˜¯æ¯”è¾ƒå®¹æ˜“ç†è§£çš„ï¼Œä¸Šæ‰‹ä¹Ÿæ¯”è¾ƒç®€å•ã€‚è¿™é‡Œï¼Œæˆ‘ä»¬æ¥æ€»ç»“ä¸‹Word2Vecçš„ä¼˜ç¼ºç‚¹ã€‚</p><h4>ä¼˜ç‚¹</h4><ol>\n<li><strong>è¯åµŒå…¥è´¨é‡é«˜</strong>ï¼šWord2Vecèƒ½å¤Ÿå­¦ä¹ åˆ°å¯Œå«è¯­ä¹‰ä¿¡æ¯çš„é«˜è´¨é‡è¯å‘é‡ï¼Œä½¿è¯­ä¹‰ä¸Šç›¸è¿‘çš„è¯åœ¨å‘é‡ç©ºé—´ä¸­ä¹Ÿç›¸è¿‘ã€‚</li>\n<li><strong>æ•æ‰å¤šç§è¯­è¨€è§„å¾‹</strong>ï¼šWord2Vecèƒ½å¤Ÿæ•æ‰åˆ°ä¸€å®šçš„è¯­æ³•å’Œè¯­ä¹‰è§„å¾‹ï¼Œæ¯”å¦‚è¯ç±»æ¯”ï¼šç”·äººä¹‹äºå¥³äººå¦‚åŒå›½ç‹ä¹‹äºç‹åã€‚</li>\n<li><strong>æ•ˆç‡é«˜</strong>ï¼šç›¸æ¯”äºæ—©æœŸçš„åŸºäºçŸ©é˜µåˆ†è§£çš„è¯åµŒå…¥æ–¹æ³•ï¼ŒWord2Vecçš„è®­ç»ƒæ•ˆç‡æ›´é«˜ï¼Œå°¤å…¶æ˜¯åœ¨å¤„ç†å¤§è§„æ¨¡è¯­æ–™åº“æ—¶ã€‚</li>\n<li><strong>å¯è§£é‡Šæ€§</strong>ï¼šWord2Vecæ¨¡å‹å­¦ä¹ åˆ°çš„è¯å‘é‡å…·æœ‰ä¸€å®šçš„å¯è§£é‡Šæ€§ï¼Œå¯ä»¥é€šè¿‡å‘é‡è¿ç®—è¿›è¡Œè¯ä¹‹é—´çš„å…³ç³»æ¢ç´¢ã€‚</li>\n</ol><h4>ç¼ºç‚¹</h4><ol>\n<li><strong>OOVé—®é¢˜</strong>ï¼šWord2Vecæ¨¡å‹åªèƒ½å¯¹å…¶è®­ç»ƒæœŸé—´è§è¿‡çš„è¯æ±‡ç”Ÿæˆå‘é‡ã€‚å¯¹äºæ–°å‡ºç°çš„æˆ–è€…ç½•è§çš„è¯æ±‡ï¼Œæ¨¡å‹æ— æ³•ç›´æ¥æä¾›è¯å‘é‡ï¼ˆå°½ç®¡å¯ä»¥é€šè¿‡ä¸€äº›æŠ€å·§è¿›è¡Œå¤„ç†ï¼‰ã€‚</li>\n<li><strong>è¯ä¹‰å¤šæ ·æ€§</strong>ï¼šWord2Vecä¸ºæ¯ä¸ªè¯æ±‡ç”Ÿæˆä¸€ä¸ªå”¯ä¸€çš„å‘é‡ï¼Œå› æ­¤æ— æ³•ç›´æ¥å¤„ç†ä¸€ä¸ªè¯å¤šç§å«ä¹‰çš„æƒ…å†µï¼Œä¹Ÿå°±æ˜¯å¤šä¹‰è¯é—®é¢˜ã€‚</li>\n<li><strong>ä¾èµ–äºå¤§é‡æ–‡æœ¬æ•°æ®</strong>ï¼šä¸ºäº†è®­ç»ƒå‡ºé«˜è´¨é‡çš„è¯å‘é‡ï¼ŒWord2Vecéœ€è¦å¤§é‡çš„æ–‡æœ¬æ•°æ®ã€‚åœ¨æ•°æ®é‡è¾ƒå°çš„æƒ…å†µä¸‹ï¼Œæ¨¡å‹çš„æ•ˆæœå¯èƒ½ä¼šå—é™ã€‚</li>\n<li><strong>ä¸Šä¸‹æ–‡ç‹¬ç«‹</strong>ï¼šWord2Vecç”Ÿæˆçš„è¯å‘é‡æ˜¯é™æ€çš„ï¼Œä¸è€ƒè™‘è¯åœ¨ç‰¹å®šå¥å­ä¸­çš„ä¸Šä¸‹æ–‡ã€‚è¿™ä¸åæ¥çš„ä¸Šä¸‹æ–‡ç›¸å…³çš„è¯åµŒå…¥æ¨¡å‹ï¼Œå¦‚ELMoã€BERTç­‰å½¢æˆå¯¹æ¯”ã€‚</li>\n<li><strong>ç¼ºä¹å±‚æ¬¡åŒ–è¡¨ç¤º</strong>ï¼šWord2Vecæä¾›çš„æ˜¯è¯æ±‡çº§åˆ«çš„å‘é‡è¡¨ç¤ºï¼Œç¼ºä¹æ›´ç»†è‡´çš„è¯­æ³•å’Œè¯­ä¹‰ç»“æ„ä¿¡æ¯ï¼Œè¿™äº›åœ¨ä¸€äº›å¤æ‚çš„NLPä»»åŠ¡ä¸­å¯èƒ½æ˜¯å¿…éœ€çš„ã€‚<br>\nä¸‹é¢æˆ‘ä»¬çœ‹ä¸‹Word2Vecæœ‰å“ªäº›å®é™…çš„åº”ç”¨åœºæ™¯ã€‚</li>\n</ol><h2>åº”ç”¨åœºæ™¯åŠæ¡ˆä¾‹</h2><p>Word2Vecæ¨¡å‹å› ä¸ºèƒ½å¤Ÿæ•æ‰åˆ°è¯è¯­å’Œè¯è¯­ä¹‹é—´å¤æ‚çš„è¯­ä¹‰è¯­æ³•å…³ç³»ï¼Œæ‰€ä»¥åœ¨NLPä»»åŠ¡ä¸­è¢«å¹¿æ³›ä½¿ç”¨ã€‚</p><p><strong>è®¡ç®—æ–‡æœ¬ç›¸ä¼¼åº¦</strong>ï¼šæ¯”è¾ƒæ–‡æœ¬ä¸­è¯å‘é‡çš„å¹³å‡å€¼æˆ–åŠ æƒå¹³å‡å€¼ï¼Œå¯ä»¥ç”¨äºæ–‡æ¡£åˆ†ç±»ã€æ¨èç³»ç»Ÿä¸­ç›¸ä¼¼é¡¹ç›®çš„æ£€ç´¢ï¼Œæˆ–è€…åœ¨æ³•å¾‹æ–‡æ¡£ã€å­¦æœ¯è®ºæ–‡ç­‰é¢†åŸŸå†…æŸ¥æ‰¾ç›¸å…³å†…å®¹ã€‚</p><p><strong>æƒ…æ„Ÿåˆ†æ</strong>ï¼šå°¤å…¶æ˜¯ç¤¾äº¤åª’ä½“å¹³å°ï¼Œç”¨Word2Vecæ¨¡å‹æ¥è¯†åˆ«ç”¨æˆ·è¯„è®ºã€å¸–å­æˆ–æ–°é—»æŠ¥é“ä¸­çš„æƒ…ç»ªæ€åº¦ã€‚</p><p><strong>æœºå™¨ç¿»è¯‘</strong>ï¼šWord2Vecå¯ä»¥ç”¨æ¥ç”Ÿæˆæºè¯­è¨€å’Œç›®æ ‡è¯­è¨€çš„è¯å‘é‡ï¼Œé€šè¿‡è¿™äº›å‘é‡ï¼Œå¯ä»¥æ”¹è¿›ç¿»è¯‘æ¨¡å‹çš„æ€§èƒ½ï¼Œå°¤å…¶æ˜¯åœ¨å¤„ç†ç½•è§è¯æˆ–çŸ­è¯­æ—¶ï¼ŒWord2Vecèƒ½å¤Ÿæä¾›æ›´åŠ ä¸°å¯Œçš„è¯­ä¹‰ä¿¡æ¯ã€‚</p><p><strong>æœç´¢å¼•æ“ä¼˜åŒ–</strong>ï¼šåœ¨æœç´¢å¼•æ“ä¸­ï¼ŒWord2Vecå¯ä»¥ç”¨æ¥ç†è§£ç”¨æˆ·æŸ¥è¯¢çš„æ„å›¾ï¼Œå¹¶æé«˜æœç´¢ç»“æœçš„ç›¸å…³æ€§ã€‚é€šè¿‡åˆ†ææŸ¥è¯¢å’Œæ–‡æ¡£å†…å®¹çš„è¯å‘é‡ç›¸ä¼¼åº¦ï¼Œæœç´¢å¼•æ“èƒ½å¤Ÿæä¾›æ›´å‡†ç¡®ã€æ›´è´´è¿‘ç”¨æˆ·æ„å›¾çš„æœç´¢ç»“æœã€‚</p><p><strong>å†…å®¹æ¨èç³»ç»Ÿ</strong>ï¼šåœ¨æ¨èç³»ç»Ÿä¸­ï¼ŒWord2Vecå¯ä»¥ç”¨æ¥åˆ†æç”¨æˆ·çš„é˜…è¯»æˆ–è´­ä¹°å†å²ï¼Œå¹¶æ¨èè¯­ä¹‰ä¸Šç›¸è¿‘çš„äº§å“æˆ–å†…å®¹ã€‚è¿™ç§åŸºäºå†…å®¹çš„æ¨èæ–¹å¼èƒ½å¤Ÿæä¾›æ›´åŠ ä¸ªæ€§åŒ–çš„æ¨èï¼Œæé«˜ç”¨æˆ·æ»¡æ„åº¦å’Œå‚ä¸åº¦ã€‚</p><h2>å°ç»“</h2><p>è¿™èŠ‚è¯¾ä»åŸç†åˆ°å®æ“è®²è§£äº†Word2Vecæ¨¡å‹ï¼Œæˆ‘ä»¬é€šè¿‡è„‘å›¾æ¥ç®€å•æ€»ç»“ä¸‹è¿™èŠ‚è¯¾å†…å®¹çš„çŸ¥è¯†ç‚¹ã€‚</p><p><img src=\"https://static001.geekbang.org/resource/image/67/f5/67342063bb9148719463e061c8debff5.jpg?wh=2337x2132\" alt=\"å›¾ç‰‡\"></p><p>ä½ å¯ä»¥æŒ‰ç…§å­¦ä¹ çš„çŸ¥è¯†è‡ªå·±æ„å»ºä¸€ä¸ªWord2Vecæ¨¡å‹ï¼Œå¹¶åº”ç”¨åˆ°å®é™…äº§å“ä¸­ï¼Œå½“ç„¶ä¹Ÿå¯ä»¥ä½¿ç”¨ä¸šç•Œå·²ç»è®­ç»ƒå¥½çš„æ¯”è¾ƒæˆç†Ÿçš„Word2Vecæ¨¡å‹ï¼Œæ¯”å¦‚Googleçš„GoogleNews-vectors-negative300æ¨¡å‹ï¼Œè¿™ä¸ªæ¨¡å‹åœ¨åŒ…å«å¤§çº¦1000äº¿ä¸ªå•è¯çš„Googleæ–°é—»æ•°æ®é›†ä¸Šé¢„è®­ç»ƒå¾—åˆ°ï¼Œæ¨¡å‹ä¸­çš„æ¯ä¸ªå•è¯éƒ½è¢«è¡¨ç¤ºä¸ºä¸€ä¸ª300ç»´çš„å‘é‡ï¼Œæ¨¡å‹æ˜¯æ¯”è¾ƒå¼ºå¤§çš„ã€‚ä½ å¯ä»¥è¯•ä¸€è¯•ã€‚</p><h2>æ€è€ƒé¢˜</h2><p>ç›®å‰ä¸è®ºæ˜¯ç”µå•†ã€æ–°é—»è¿˜æ˜¯ç¤¾äº¤å¹³å°ï¼Œä¸ªæ€§åŒ–æ¨èéƒ½å¾ˆå¸¸è§ï¼Œå¦‚æœè®©ä½ æ¥è®¾è®¡ä¸€ä¸ªæ–°é—»æ¨èç³»ç»Ÿï¼Œè¯·æ€è€ƒä¸€ä¸‹ï¼Œæ€ä¹ˆå®ç°ï¼Ÿä½ å¯ä»¥æŠŠæ€è·¯æ”¾åœ¨è¯„è®ºåŒºï¼Œæˆ‘ä»¬ä¸€èµ·è®¨è®ºï¼Œå¦‚æœä½ è§‰å¾—è¿™èŠ‚è¯¾çš„å†…å®¹å¯¹ä½ æœ‰å¸®åŠ©çš„è¯ï¼Œæ¬¢è¿ä½ åˆ†äº«ç»™å…¶ä»–æœ‹å‹ï¼Œæˆ‘ä»¬ä¸‹èŠ‚è¯¾å†è§ã€‚</p>","comments":[{"had_liked":false,"id":391837,"user_name":"å¼ ç”³å‚²","can_delete":false,"product_type":"c1","uid":1182372,"ip_address":"åŒ—äº¬","ucode":"22D46BC529BA8A","user_header":"https://static001.geekbang.org/account/avatar/00/12/0a/a4/828a431f.jpg","comment_is_top":false,"comment_ctime":1719230406,"is_pvip":false,"replies":[{"id":142468,"content":"å¼ºï¼","user_name":"ä½œè€…å›å¤","user_name_real":"ç¼–è¾‘","uid":2083554,"ctime":1719461009,"ip_address":"æµ™æ±Ÿ","comment_id":391837,"utype":1}],"discussion_count":1,"race_medal":2,"score":2,"product_id":100770601,"comment_content":"ç¬¬12è®²æ‰“å¡~\næ€è€ƒé¢˜ï¼šå®ç°æ–°é—»æ¨èç³»ç»Ÿï¼Œä¸€ä¸ªç®€å•çš„æ€è·¯æ˜¯ï¼Œå°†æ¯ä¸ªç”¨æˆ·çš„æµè§ˆã€æœç´¢ã€è¯„è®ºç­‰å†å²è®°å½•ï¼Œé€šè¿‡Embeddingå‘é‡åŒ–åï¼Œå­˜å‚¨åœ¨å‘é‡æ•°æ®ä¸­ï¼›åŒæ—¶å°†æ–°é—»çš„æ–‡æœ¬ä¹Ÿå‘é‡åŒ–å…¥åº“ã€‚åœ¨åšç›¸å…³æ¨èæ—¶ï¼Œå¯ä»¥åŸºäºå‘é‡æ•°æ®åº“çš„ç´¢å¼•èƒ½åŠ›ï¼Œåˆ©ç”¨ä½™å¼¦è·ç¦»ç­‰ï¼Œè®¡ç®—ç›¸å…³åº¦æœ€é«˜çš„å‡ æ¡æ–°é—»ï¼Œç»™ç”¨æˆ·æ¨èã€‚","like_count":5,"discussions":[{"author":{"id":2083554,"avatar":"http://thirdwx.qlogo.cn/mmopen/vi_32/DYAIOgq83erZP8e2vqiaACFaDxruOzUTPbPv2uRUTp9UuEg98Ib9aYddjZK2kastqf0B14Ec7uXx7CCSXr0fhAA/132","nickname":"Geek_cf2545","note":"","ucode":"B69DF1E734FBA2","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":647090,"discussion_content":"å¼ºï¼","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1719461009,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"æµ™æ±Ÿ","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2,\"source\":0}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":392773,"user_name":"å¼  Â·ä¸‡å²ï¼","can_delete":false,"product_type":"c1","uid":3923442,"ip_address":"ä¸­å›½å°æ¹¾","ucode":"C95598C751FCC1","user_header":"https://static001.geekbang.org/account/avatar/00/3b/dd/f2/3513c633.jpg","comment_is_top":false,"comment_ctime":1721731546,"is_pvip":false,"replies":[{"id":142736,"content":"ğŸ‘ğŸ»ğŸ‘ğŸ»","user_name":"ä½œè€…å›å¤","user_name_real":"ç¼–è¾‘","uid":2083554,"ctime":1722309141,"ip_address":"æµ™æ±Ÿ","comment_id":392773,"utype":1}],"discussion_count":1,"race_medal":0,"score":2,"product_id":100770601,"comment_content":"å…³äºè¿™ä¸ªxmlæ–‡ä»¶æ— æ³•æ­£å¸¸è¯»å–çš„é—®é¢˜ï¼Œä¸»è¦æ˜¯å› ä¸ºxmlé»˜è®¤æ²¡æœ‰é¢„å®šä¹‰HTMLä¸­çš„ &amp;brvbar; å®ä½“ï¼Œè¿˜æœ‰å­˜åœ¨æŸäº›ä¸èƒ½ç¼–ç çš„å­—ç¬¦ä¸²ã€‚æˆ‘çš„è§£å†³æ–¹æ¡ˆæ˜¯ç›´æ¥ç®€å•æš´åŠ›çš„å­—ç¬¦ä¸²æ›¿æ¢\nimport os\n\npath1 = &#39;data.xml&#39;\npath2 = &#39;data1.xml&#39;\nwith open(path1, &#39;r&#39;, encoding=&#39;utf-8&#39;,) as f1:\n    with open(path2, &#39;a+&#39;, encoding=&#39;utf-8&#39;) as f2:\n        line = f1.readline()\n        while line:\n            # print(line.strip())\n            f2.write(line.replace(&#39;&amp;brvbar;&#39;, &#39;Â¦&#39;).replace(&#39;ï¿¿&#39;,&#39;&#39;))\n            line = f1.readline() ","like_count":0,"discussions":[{"author":{"id":2083554,"avatar":"http://thirdwx.qlogo.cn/mmopen/vi_32/DYAIOgq83erZP8e2vqiaACFaDxruOzUTPbPv2uRUTp9UuEg98Ib9aYddjZK2kastqf0B14Ec7uXx7CCSXr0fhAA/132","nickname":"Geek_cf2545","note":"","ucode":"B69DF1E734FBA2","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":648854,"discussion_content":"ğŸ‘ğŸ»ğŸ‘ğŸ»","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1722309141,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"æµ™æ±Ÿ","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2,\"source\":0}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":392760,"user_name":"é»„è“‰ Jessie","can_delete":false,"product_type":"c1","uid":1033945,"ip_address":"åŒ—äº¬","ucode":"F3205D3B9172F0","user_header":"https://static001.geekbang.org/account/avatar/00/0f/c6/d9/9058e13c.jpg","comment_is_top":false,"comment_ctime":1721716514,"is_pvip":false,"replies":[{"id":142735,"content":"ğŸ‘ğŸ»ğŸ‘ğŸ»","user_name":"ä½œè€…å›å¤","user_name_real":"ç¼–è¾‘","uid":2083554,"ctime":1722309125,"ip_address":"æµ™æ±Ÿ","comment_id":392760,"utype":1}],"discussion_count":2,"race_medal":0,"score":2,"product_id":100770601,"comment_content":"å¯¹äº&amp;brvbar;æ— æ³•è§£æçš„é—®é¢˜ï¼Œå¯ä»¥ç”¨ä»£ç å°†å…¶æ›¿æ¢ä¸ºï½œã€‚ç„¶åè¿˜ä¼šé‡åˆ°ä¸€ä¸ªæŠ¥é”™ï¼Œxml.etree.ElementTree.ParseError: not well-formed (invalid token): line 411575, column 19ã€‚è¿™ä¸ªæ˜¯å› ä¸ºxmlæ–‡ä»¶é‡Œæœ‰ç‰¹æ®Šå­—ç¬¦ï¼Œæ‰¾åˆ°å¯¹åº”è¡Œ411575ï¼Œå¤åˆ¶è¿™ä¸ªå­—ç¬¦æ‰¹é‡æ›¿æ¢æ‰å°±å¯ä»¥è¿è¡ŒæˆåŠŸã€‚\nå®æµ‹èƒ½è¿è¡Œèµ·æ¥çš„é¢„å¤„ç†ä»£ç å¦‚ä¸‹ï¼ˆæ›¿æ¢ç‰¹æ®Šå­—ç¬¦åï¼‰\n```python\nimport jieba\nimport xml.etree.ElementTree as ET\nimport re\n\n# é¢„å¤„ç†æ­¥éª¤\n# è¯»å–XMLæ–‡ä»¶å¹¶è§£æ\nfile_path = &#39;data.xml&#39;\n\n# è¯»å–XMLæ–‡ä»¶å†…å®¹\nwith open(file_path, &#39;r&#39;, encoding=&#39;utf-8&#39;) as file:\n    content = file.read()\n\n# æ›¿æ¢ç‰¹æ®Šå®ä½“ï¼Œè¿™é‡Œå°† &amp;brvbar; æ›¿æ¢ä¸ºç›¸åº”çš„ç¬¦å·ï¼ˆÂ¦ï¼‰\ncontent = content.replace(&#39;&amp;brvbar;&#39;, &#39;Â¦&#39;)\n\n# ä½¿ç”¨ET.fromstringè§£æå­—ç¬¦ä¸²ï¼Œè€Œä¸æ˜¯ç›´æ¥è§£ææ–‡ä»¶\nroot = ET.fromstring(content)\n\n# è·å–æ‰€æœ‰&lt;article&gt;æ ‡ç­¾çš„å†…å®¹\ntexts = [record.find(&#39;article&#39;).text for record in root.findall(&#39;RECORD&#39;)]\nprint(len(texts))\n\n# åœç”¨è¯åˆ—è¡¨ï¼Œå®é™…åº”ç”¨ä¸­éœ€è¦æ ¹æ®å®é™…æƒ…å†µæ‰©å±•\nstop_words = set([&quot;çš„&quot;, &quot;äº†&quot;, &quot;åœ¨&quot;, &quot;æ˜¯&quot;, &quot;æˆ‘&quot;, &quot;æœ‰&quot;, &quot;å’Œ&quot;, &quot;å°±&quot;])\n\n# åˆ†è¯å’Œå»é™¤åœç”¨è¯\nprocessed_texts = []\nfor text in texts:\n    if text is not None:\n        words = jieba.cut(text)\n        processed_text = [word for word in words if word not in stop_words]\n        processed_texts.append(processed_text)\n\n# æ‰“å°é¢„å¤„ç†åçš„æ–‡æœ¬\nfor text in processed_texts:\n    print(text)","like_count":0,"discussions":[{"author":{"id":2083554,"avatar":"http://thirdwx.qlogo.cn/mmopen/vi_32/DYAIOgq83erZP8e2vqiaACFaDxruOzUTPbPv2uRUTp9UuEg98Ib9aYddjZK2kastqf0B14Ec7uXx7CCSXr0fhAA/132","nickname":"Geek_cf2545","note":"","ucode":"B69DF1E734FBA2","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":648853,"discussion_content":"ğŸ‘ğŸ»ğŸ‘ğŸ»","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1722309126,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"æµ™æ±Ÿ","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2,\"source\":0}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1542987,"avatar":"https://static001.geekbang.org/account/avatar/00/17/8b/4b/15ab499a.jpg","nickname":"é£è½»æ‰¬","note":"","ucode":"DB972F2DF059C4","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":648819,"discussion_content":"æœ‰ä¸€ä¸ª?çš„ç‰¹æ®Šå­—ç¬¦ï¼Œè¿˜éœ€è¦æ‰¹é‡æ›¿æ¢ä¸‹ã€‚ç”¨ä¸€ä¸ªç¼–è¾‘å™¨æ‰“å¼€æ–‡ä»¶ï¼Œç„¶åæ‰¹é‡æ›¿æ¢è¿™ä¸ªï¼Ÿçš„ç‰¹æ®Šå­—ç¬¦å³å¯","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1722251759,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":"åŒ—äº¬","group_id":0},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":392301,"user_name":"Juha","can_delete":false,"product_type":"c1","uid":1347609,"ip_address":"åŒ—äº¬","ucode":"5B9301CC960D84","user_header":"https://static001.geekbang.org/account/avatar/00/14/90/19/b3403815.jpg","comment_is_top":false,"comment_ctime":1720527338,"is_pvip":true,"replies":[{"id":142594,"content":"ä½ å¥½ï¼Œã€ä¸çŸ¥é“æœ‰æ²¡æœ‰ä¸€æ ·æ— æ³•æ­£å¸¸è¯»å–çš„ã€‘æ˜¯ä»€ä¹ˆæ„æ€ï¼Ÿ","user_name":"ä½œè€…å›å¤","user_name_real":"ç¼–è¾‘","uid":2083554,"ctime":1720604582,"ip_address":"æµ™æ±Ÿ","comment_id":392301,"utype":1}],"discussion_count":4,"race_medal":0,"score":2,"product_id":100770601,"comment_content":"è¿™ä¸ªxmlæ–‡ä»¶ï¼Œä¸çŸ¥é“æœ‰æ²¡æœ‰ä¸€æ ·æ— æ³•æ­£å¸¸è¯»å–çš„ï¼Œå¦‚æœæ¢äº†lxmlçš„è¯ï¼Œæ•°æ®ä¼šå˜å¾—å¾ˆå¤šï¼Œç»“æœä¸å‡†ç¡®","like_count":0,"discussions":[{"author":{"id":2083554,"avatar":"http://thirdwx.qlogo.cn/mmopen/vi_32/DYAIOgq83erZP8e2vqiaACFaDxruOzUTPbPv2uRUTp9UuEg98Ib9aYddjZK2kastqf0B14Ec7uXx7CCSXr0fhAA/132","nickname":"Geek_cf2545","note":"","ucode":"B69DF1E734FBA2","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":647785,"discussion_content":"ä½ å¥½ï¼Œã€ä¸çŸ¥é“æœ‰æ²¡æœ‰ä¸€æ ·æ— æ³•æ­£å¸¸è¯»å–çš„ã€‘æ˜¯ä»€ä¹ˆæ„æ€ï¼Ÿ","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1720604582,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"æµ™æ±Ÿ","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2,\"source\":0}","child_discussion_number":1,"child_discussions":[{"author":{"id":1347609,"avatar":"https://static001.geekbang.org/account/avatar/00/14/90/19/b3403815.jpg","nickname":"Juha","note":"","ucode":"5B9301CC960D84","race_medal":0,"user_type":1,"is_pvip":true},"reply_author":{"id":2083554,"avatar":"http://thirdwx.qlogo.cn/mmopen/vi_32/DYAIOgq83erZP8e2vqiaACFaDxruOzUTPbPv2uRUTp9UuEg98Ib9aYddjZK2kastqf0B14Ec7uXx7CCSXr0fhAA/132","nickname":"Geek_cf2545","note":"","ucode":"B69DF1E734FBA2","race_medal":0,"user_type":2,"is_pvip":false},"discussion":{"id":647803,"discussion_content":"é‚£ä¸ªæ•°æ®é›† æŒ‰ç…§è€å¸ˆç»™çš„ä»£ç  æ²¡æ³•æ­£å¸¸è¯»å–å‘¢","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1720615505,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":647785,"ip_address":"åŒ—äº¬","group_id":0},"score":647803,"extra":""}]},{"author":{"id":1033945,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/c6/d9/9058e13c.jpg","nickname":"é»„è“‰ Jessie","note":"","ucode":"F3205D3B9172F0","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":648506,"discussion_content":"å¯¹ï¼ŒæŒ‰ç…§è€å¸ˆç»™çš„ä»£ç æŠ¥é”™ï¼šxml.etree.ElementTree.ParseError: undefined entity: line 3735, column 63ã€‚å¸Œæœ›è€å¸ˆèƒ½ç»™èƒ½è¿è¡Œçš„ç¤ºä¾‹ä»£ç ","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1721716232,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":"åŒ—äº¬","group_id":0},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1119877,"avatar":"https://static001.geekbang.org/account/avatar/00/11/16/85/b3af5d54.jpg","nickname":"å°±åœ¨è¿™å„¿ğŸ’‹","note":"","ucode":"36644369AB020E","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":647915,"discussion_content":"æˆ‘ä¹Ÿæ˜¯è¿™ç§æƒ…å†µ, æ— æ³•è§£æ &amp;brvbar; è¿™ç±»å­—ç¬¦,æ”¹ç”¨lxmlä¼šè®©ç»“æœä¸å‡†ç¡®","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1720774199,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":"å¹¿ä¸œ","group_id":0},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":396539,"user_name":"æµ©ä»”æ˜¯ç¨‹åºå‘˜","can_delete":false,"product_type":"c1","uid":1104601,"ip_address":"å¹¿ä¸œ","ucode":"A7E5CF9E1571A2","user_header":"https://static001.geekbang.org/account/avatar/00/10/da/d9/f051962f.jpg","comment_is_top":false,"comment_ctime":1734874734,"is_pvip":false,"replies":null,"discussion_count":0,"race_medal":0,"score":2,"product_id":100770601,"comment_content":"è€å¸ˆï¼Œä½ å¥½ï¼ŒåŸºäºWord2Vecæ˜¯æ€ä¹ˆå®ç°æƒ…æ„Ÿåˆ†æçš„å‘¢ï¼Ÿæ˜¯é¢„å…ˆå®šä¹‰ä¸€äº›æ¯”å¦‚è´Ÿé¢æƒ…ç»ªçš„è¯è¯­ï¼Œè®¡ç®—æ‹¿åˆ°ä¸€ç»„å‘é‡ã€‚ç„¶åè¾“å…¥ä¸€ä¸ªè¯ï¼Œè®¡ç®—å‡ºå‘é‡ï¼Œè·Ÿé¢„å…ˆå®šä¹‰å¥½è´Ÿé¢æƒ…ç»ªçš„å‘é‡è®¡ç®—ç›¸ä¼¼åº¦ï¼Œåˆ¤æ–­æ˜¯å¦ä¸ºè´Ÿé¢æƒ…ç»ªå—ï¼Ÿ\n","like_count":0}]}