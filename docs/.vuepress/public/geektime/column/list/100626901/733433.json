{"id":733433,"title":"21ï½œWebå¼€å‘ï¼ˆä¸Šï¼‰ï¼šå¦‚ä½•ä½¿ç”¨Axumæ¡†æ¶è¿›è¡ŒWebåç«¯å¼€å‘ï¼Ÿ","content":"<p>ä½ å¥½ï¼Œæˆ‘æ˜¯Mike, ä»Šå¤©æˆ‘ä»¬æ¥è®²ä¸€è®²å¦‚ä½•ç”¨Axumæ¡†æ¶è¿›è¡ŒWebæœåŠ¡å™¨åç«¯å¼€å‘ã€‚</p><p>å…³äºRustæ˜¯å¦é€‚åˆåšWebåç«¯å¼€å‘ï¼Œå¾ˆå¤šäººæŒæ€€ç–‘æ€åº¦ã€‚è®¤ä¸ºWebå¼€å‘è®²ç©¶çš„æ˜¯æ•æ·ï¼Œä¸€ç§åŠ¨æ€çš„ã€å¸¦è¿è¡Œæ—¶çš„ã€æ–¹ä¾¿ä¿®æ”¹çš„è¯­è¨€å¯èƒ½æ›´é€‚åˆWebå¼€å‘ã€‚</p><p>ä½†æœ‰ä¸€äº›å› ç´ ï¼Œå…¶å®å†³å®šäº†Rustéå¸¸é€‚åˆWebå¼€å‘ã€‚</p><ol>\n<li>æ—¶ä»£å˜åŒ–ï¼šèŠ¯ç‰‡æ‘©å°”å®šå¾‹å·²å¤±æ•ˆï¼ŒæœåŠ¡å™¨æˆæœ¬é€æ¸å æ®ç›¸å½“å¤§çš„æ¯”ä¾‹ï¼Œæ— è„‘å †æœåŠ¡å™¨çš„æ—¶ä»£å·²ç»è¿‡å»ã€‚å½“å‰é˜¶æ®µï¼Œå¯¹äºè§„æ¨¡ç¨å¾®å¤§ä¸€äº›çš„å…¬å¸æ¥è¯´ï¼Œé™æœ¬å¢æ•ˆæ˜¯ä¸€ä¸ªå¾ˆé‡è¦çš„ä»»åŠ¡ã€‚è€ŒRustçš„é«˜æ€§èƒ½å’Œç¨³å®šå¯é çš„è¡¨ç°éå¸¸é€‚åˆå¸®åŠ©å…¬å¸èŠ‚çœæœåŠ¡å™¨æˆæœ¬ã€‚</li>\n<li>éšç€ä¸šåŠ¡çš„æˆå‹ï¼Œä¸€äº›æ ¸å¿ƒä¸šåŠ¡ä¼šè¶‹äºç¨³å®šï¼Œæ¨¡å‹å’Œæµç¨‹æŠ½è±¡å·²ç»åŸºæœ¬ä¸ä¼šæœ‰å¤§çš„æ”¹åŠ¨ã€‚è¿™æ—¶ï¼Œä½¿ç”¨Rusté‡å†™æˆ–éƒ¨åˆ†é‡å†™è¿™äº›ä¸šåŠ¡ï¼Œä¼šå¸¦æ¥æ›´å¼ºçš„æ€§èƒ½å’Œæ›´å¯é ç¨³å®šçš„æœåŠ¡è¡¨ç°ã€‚</li>\n<li>Rustéå¸¸é€‚åˆç”¨æ¥åšä¸€äº›é€šç”¨çš„ä¸­é—´ä»¶æœåŠ¡ï¼Œç›®å‰å¼€æºç¤¾åŒºå·²ç»å‡ºç°äº†ä¸€äº›ç›¸å½“ä¼˜ç§€çš„ä¸­é—´ä»¶äº§å“ã€‚</li>\n<li>Rustçš„è¡¨è¾¾èƒ½åŠ›å…¶å®éå¸¸å¼ºï¼Œå…¶å¼ºå¤§çš„ç±»å‹ç³»ç»Ÿå¯å¸®åŠ©å¼€å‘è€…è½»æ¾åœ°å¯¹é—®é¢˜è¿›è¡Œå»ºæ¨¡ã€‚ä¸€ä¸ªä¸­ç­‰ç†Ÿç»ƒçš„Rustå¼€å‘è€…åšåŸå‹çš„é€Ÿåº¦ä¸ä¼šæ¯”Pythonæ…¢å¤šå°‘ï¼Œåœ¨å¤æ‚é—®é¢˜åœºæ™¯ä¸‹ï¼Œç”šè‡³æ›´å¿«ã€‚</li>\n<li>Rustçš„è¯­è¨€å±‚é¢çš„è®¾è®¡ä½¿å®ƒç‰¹åˆ«é€‚åˆåšé‡æ„ã€‚é‡æ„Rustå·¥ç¨‹ç‰¹åˆ«å¿«ï¼Œé‡æ„å®Œåï¼Œä¹Ÿä¸ç”¨æ‹…å¿ƒå‡ºé”™çš„é—®é¢˜ã€‚ç›¸å¯¹äºåŠ¨æ€è¯­è¨€ï¼Œå¯¹åº”çš„æµ‹è¯•ç”¨ä¾‹éƒ½å¯ä»¥å°‘å‡†å¤‡å¾ˆå¤šã€‚</li>\n</ol><!-- [[[read_end]]] --><h2>Rust Web Backend ç”Ÿæ€</h2><p>Rust Webåç«¯å¼€å‘ç”Ÿæ€ç›®å‰å¤„äºä¸€ç§æ¬£æ¬£å‘è£çš„å±€é¢ã€‚å°±Webå¼€å‘æ¡†æ¶æ¥è¯´ï¼Œèƒ½å«å¾—ä¸Šåå­—çš„å°±æœ‰åå‡ ç§ï¼Œå…¶ä¸­æŒ‰ <a href=\"https://crates.io\">crates.io</a> æœ€æ–°ä¸‹è½½é‡æ’åï¼Œæ’åˆ—é å‰çš„æ˜¯è¿™å‡ ä½ã€‚</p><ol>\n<li>Axum</li>\n<li>Actix-web</li>\n<li>Rocket</li>\n<li>Poem</li>\n<li>Rouille</li>\n<li>Salvo</li>\n</ol><p>ä»æœ€è¿‘ä¸‹è½½çš„ç»å¯¹æ•°é‡æ¥è¯´ï¼ŒAxum çš„ä¸‹è½½é‡æ˜¯ç¬¬äºŒå Actix-web çš„ 3 å€å¤šã€‚å› æ­¤ï¼Œæˆ‘ä»¬é€‰æ‹©äº†ä¸‹è½½é‡æœ€å¤šçš„æ¡†æ¶â€”â€”Axumã€‚</p><h3>TokioæŠ€æœ¯æ ˆä»‹ç»</h3><p>Axumæœ‰è¿™ä¹ˆå¼ºåŠ²çš„è¡¨ç°ï¼Œå¾—ç›Šäºå…¶æœ¬èº«ä¼˜ç§€çš„è®¾è®¡ï¼Œè¿˜æœ‰å®ƒæ— ç¼ä¾èµ–çš„ Tokio æŠ€æœ¯æ ˆã€‚Tokioä» 2017 å¹´å‘å¸ƒ 0.1 ç‰ˆæœ¬å¼€å§‹åˆ°ç°åœ¨ï¼Œå·²ç»å½¢æˆä¸€å¥—å¼ºå¤§çš„æŠ€æœ¯æ ˆã€‚</p><p><img src=\"https://static001.geekbang.org/resource/image/e1/40/e1e84b20997c3a99540c7559e6dc5b40.jpg?wh=1414x1594\" alt=\"\"></p><p>è¿™äº›å¯é çš„å·¥å…·é“¾ï¼Œä¸ºRuståœ¨æœåŠ¡å™¨ç«¯çš„å‘å±•æ‰“ä¸‹äº†åšå®çš„åŸºç¡€ï¼Œè¶Šæ¥è¶Šå¤šçš„é¡¹ç›®å¼€å§‹é‡‡ç”¨è¿™ä¸€å¥—æŠ€æœ¯æ ˆã€‚</p><h2>Axumæ¡†æ¶</h2><blockquote>\n<p>Axumæ˜¯ä¸€ä¸ªä¸“æ³¨äºäººä½“å·¥ç¨‹å­¦å’Œæ¨¡å—åŒ–çš„Webå¼€å‘æ¡†æ¶ã€‚â€”â€”å®˜æ–¹æ–‡æ¡£çš„Slogan</p>\n</blockquote><p>ä»ä¸Šå±‚è§†è§’æ¥çœ‹ï¼ŒAxumå…·æœ‰ä»¥ä¸‹ç‰¹æ€§ï¼š</p><ol>\n<li>å†™Routerå’ŒHandlerçš„æ—¶å€™ï¼Œä¸éœ€è¦ä½¿ç”¨å®ï¼ˆéæ ‡æ³¨é£æ ¼ï¼‰ã€‚</li>\n<li>ä½¿ç”¨è§£åŒ…å™¨è¿›è¡Œå£°æ˜å¼çš„è¯·æ±‚è§£æã€‚</li>\n<li>ç®€å•å’Œå¯é¢„æµ‹çš„é”™è¯¯å¤„ç†æ¨¡å‹ã€‚</li>\n<li>ç”Ÿæˆå“åº”æ—¶åªéœ€ç”¨åˆ°æœ€å°çš„æ ·æ¿ä»£ç ã€‚</li>\n<li>å……åˆ†åˆ©ç”¨ tower å’Œ tower-http çš„ä¸­é—´ä»¶ã€æœåŠ¡å’Œå·¥å…·çš„ç”Ÿæ€ç³»ç»Ÿã€‚</li>\n</ol><p>ç‰¹åˆ«æ˜¯æœ€åä¸€ç‚¹ï¼Œè®©Axumæ˜¾è‘—ä¸åŒäºå…¶ä»–æ¡†æ¶ã€‚Axumè‡ªå·±ä¸å¸¦ä¸­é—´ä»¶ç³»ç»Ÿï¼Œè€Œæ˜¯ä½¿ç”¨ tower ç³»çš„ä¸­é—´ä»¶ã€‚è¿™æ ·å°±èƒ½å’Œç”Ÿæ€é‡Œçš„å…¶ä»–é¡¹ç›®ï¼Œå¦‚ hyper æˆ– tonic å…±äº«ä¸­é—´ä»¶ç³»ç»Ÿã€‚ è¿™ç§è®¾è®¡å¤ªæ£’äº†ã€‚</p><h3>Towerä¸­é—´å±‚æœåŠ¡</h3><p>Toweræ˜¯ä¸€ä¸ªæ¨¡å—åŒ–ã€å¯é‡ç”¨çš„ç»„ä»¶ç³»ç»Ÿï¼Œç”¨äºæ„å»ºç¨³å¥çš„ç½‘ç»œæœåŠ¡ç«¯å’Œå®¢æˆ·ç«¯åº”ç”¨ã€‚å®ƒå¯¹<strong>è¯·æ±‚/å“åº”æ¨¡å‹</strong>åšäº†ä¸€ä¸ªç»Ÿä¸€çš„æœåŠ¡æŠ½è±¡ï¼Œå’Œå…·ä½“çš„å®ç°åè®®æ— å…³ã€‚ä½ å¯ä»¥çœ‹ä¸€ä¸‹Serviceçš„å®šä¹‰ã€‚</p><pre><code class=\"language-plain\">async fn(Request) -&gt; Result&lt;Response, Error&gt;\n</code></pre><p>ToweråŒ…å« Service å’Œ Layer ä¸¤ä¸ªæŠ½è±¡ã€‚ä¸€ä¸ªServiceæ˜¯ä¸€ä¸ªæ¥å—è¯·æ±‚ï¼Œåšå‡ºå“åº”çš„å¼‚æ­¥å‡½æ•°ï¼›è€Œä¸€ä¸ª Layer æ¥å—ä¸€ä¸ªServiceï¼Œå¤„ç†å¹¶è¿”å›å¦ä¸€ä¸ªServiceã€‚Serviceå’ŒLayerä¸€èµ·ï¼Œå°±å¯ä»¥æ–¹ä¾¿åœ°æ„å»ºä¸­é—´ä»¶æœåŠ¡ã€‚è€Œå®Œå…¨åŸºäºæµï¼ˆstreamï¼‰çš„æœåŠ¡ï¼Œå¹¶ä¸é€‚åˆä½¿ç”¨Towerã€‚</p><h3>Tower-httpä»‹ç»</h3><p><a href=\"https://docs.rs/tower-http/latest/tower_http/\">Tower-http</a> æ˜¯ä¸€ä¸ªä¸“é—¨ç”¨äºæä¾›HTTPç›¸å…³çš„ä¸­é—´ä»¶å’Œè®¾æ–½çš„åº“ï¼Œé‡Œé¢ç½—åˆ—äº†äºŒåå¤šä¸ªä¸­é—´ä»¶ã€‚</p><p>åœ¨Axumä¸­ï¼Œæœ€å¸¸ç”¨çš„ä¸­é—´ä»¶æ˜¯ä¸‹é¢è¿™å‡ ä¸ªã€‚</p><ul>\n<li>TracyLayer ä¸­é—´ä»¶ï¼Œç”¨äºæä¾›é«˜å±‚æ—¥å¿—æˆ–è·Ÿè¸ªã€‚</li>\n<li>CorsLayer ä¸­é—´ä»¶ï¼Œç”¨äºå¤„ç†CORSã€‚</li>\n<li>CompressionLayer ä¸­é—´ä»¶ï¼Œç”¨äºè‡ªåŠ¨å‹ç¼©å“åº”ã€‚</li>\n<li>RequestIdLayer å’Œ PropagateRequestIdLayer&nbsp;ä¸­é—´ä»¶ï¼Œç”¨äºè®¾ç½®å’Œä¼ æ’­è¯·æ±‚IDã€‚</li>\n<li>TimeoutLayer ä¸­é—´ä»¶ï¼Œç”¨äºè®¾ç½®è¶…æ—¶ã€‚</li>\n<li>HandleErrorLayer ä¸­é—´ä»¶ï¼Œç”¨äºè½¬æ¢å„ç§é”™è¯¯ç±»å‹åˆ°å“åº”ã€‚</li>\n</ul><p>è€Œæ¯ä¸ªä¸­é—´ä»¶éƒ½å¯ä»¥ç”¨åœ¨å…¨å±€Routerã€æ¨¡å—Routerå’ŒHandlerä¸‰ä¸ªå±‚æ¬¡ã€‚</p><h3>Router</h3><p>Routerç”¨æ¥å®šä¹‰URLåˆ°handlerçš„æ˜ å°„ï¼Œå¹¶ç”¨æ¥æ„å»ºæ¨¡å—åŒ–URLçš„å±‚çº§ï¼Œæ—¢èƒ½æ”¯æŒå…¨å±€æ€§è·¯ç”±ï¼Œä¹Ÿèƒ½æ”¯æŒæ¨¡å—å±‚çº§çš„è·¯ç”±ã€‚æ¯”å¦‚ï¼š</p><pre><code class=\"language-rust\">let user_routes = Router::new().route(\"/:id\", get(|| async {}));\nlet team_routes = Router::new().route(\"/\", post(|| async {}));\nlet api_routes = Router::new()\n    .nest(\"/users\", user_routes)\n    .nest(\"/teams\", team_routes);\nlet app = Router::new().nest(\"/api\", api_routes);\n</code></pre><h3>Handler</h3><p>åœ¨Axumé‡Œï¼ŒHandleræ˜¯ä¸€ä¸ªå¼‚æ­¥å‡½æ•°ï¼Œè¿™ä¸ªå¼‚æ­¥å‡½æ•°æ¥å—ä¸€ä¸ªæˆ–å¤šä¸ªè§£åŒ…å™¨ä½œä¸ºå‚æ•°ï¼Œè¿”å›ä¸€ä¸ªå¯ä»¥è½¬æ¢ä¸ºå“åº”ï¼ˆimpl IntoResponseï¼‰çš„ç±»å‹ã€‚</p><p>æœ€ç®€å•çš„ handler ç±»ä¼¼ä¸‹é¢è¿™ä¸ªæ ·å­ï¼š</p><pre><code class=\"language-plain\">async fn string_handler() -&gt; String {\n    \"Hello, World!\".to_string()\n}\n</code></pre><h2>ä½¿ç”¨Axumè¿›è¡ŒWebåç«¯å¼€å‘</h2><p>ç°åœ¨è¯ä¸å¤šè¯´ï¼Œè®©æˆ‘ä»¬å¼€å§‹Axumå®æˆ˜ç¯èŠ‚å§ï¼</p><p><span class=\"reference\">æ³¨ï¼šç›®å‰ï¼ˆ2023å¹´12æœˆï¼‰Axumçš„æœ€æ–°ç‰ˆæœ¬æ˜¯ v0.7 ç‰ˆï¼Œæˆ‘ä»¬ä¸‹é¢ä¼šåŸºäºè¿™ä¸ªç‰ˆæœ¬æ¥ç¼–å†™ä»£ç ã€‚</span></p><h3>ç¬¬ä¸€æ­¥ï¼šHello world</h3><p>æˆ‘ä»¬å…ˆæ¥çœ‹çœ‹Axumçš„Hello Worldæ˜¯ä»€ä¹ˆæ ·å­ã€‚</p><pre><code class=\"language-plain\">use axum::{response::Html, routing::get, Router};\n\n#[tokio::main]\nasync fn main() {\n    // build our application with a route\n    let app = Router::new().route(\"/\", get(handler));\n\n    // run it\n    let listener = tokio::net::TcpListener::bind(\"127.0.0.1:3000\")\n        .await\n        .unwrap();\n    println!(\"listening on {}\", listener.local_addr().unwrap());\n    axum::serve(listener, app).await.unwrap();\n}\n\nasync fn handler() -&gt; Html&lt;&amp;'static str&gt; {\n    Html(\"&lt;h1&gt;Hello, World!&lt;/h1&gt;\")\n}\n</code></pre><p>è¿™é‡Œæˆ‘ç»™å‡ºè¿™ä¸ªæ­¥éª¤çš„<a href=\"https://github.com/miketang84/jikeshijian/tree/master/2122-axumapp_stepbystep/axumapp01_helloworld\">åŸå§‹ä»£ç åœ°å€</a>ï¼Œä½ å¯ä»¥ç›´æ¥ä¸‹è½½åˆ°æœ¬åœ°è¿è¡Œã€‚</p><p>ä»è¿™ä¸ªä¾‹å­é‡Œï¼Œæˆ‘ä»¬å¯ä»¥ä¸€çª¥Axumåº”ç”¨çš„åŸºæœ¬ç»“æ„ã€‚é¦–å…ˆï¼Œä¸€ä¸ªAxumåº”ç”¨å…¶å®å°±æ˜¯ä¸€ä¸ªTokioåº”ç”¨ï¼Œä»¥æ ‡å¿—æ€§çš„tokio::mainå±æ€§å®å¼€å¤´ã€‚</p><pre><code class=\"language-plain\">#[tokio::main]\nasync fn main() {\n</code></pre><p>ç„¶åï¼Œåˆ›å»ºä¸€ä¸ªRouterå®ä¾‹ï¼Œä»£è¡¨Appã€‚åœ¨Routerä¸­ï¼Œç»‘å®šURLä¸handlerã€‚</p><p>ç„¶åä½¿ç”¨ <code>tokio::net::TcpListener::bind()</code> ç›‘å¬æœåŠ¡å™¨åœ°å€ï¼Œå¹¶å°†ç”Ÿæˆçš„ listener ä¼ å…¥ <code>axum::serve()</code> ä¸­ä½¿ç”¨ï¼Œå¯åŠ¨axumæœåŠ¡ã€‚è€Œè¿™ä¸ªåº”ç”¨çš„ handler å‚æ•°é‡Œæ²¡æœ‰è§£åŒ…å™¨ï¼ˆextractorï¼‰ï¼Œæ˜¯å› ä¸ºæˆ‘ä»¬æš‚æ—¶ä¸è§£æè¯·æ±‚å‚æ•°ï¼Œæ‰€ä»¥å‚æ•°éƒ¨åˆ†ç•™ç©ºã€‚</p><pre><code class=\"language-plain\">async fn handler() -&gt; Html&lt;&amp;'static str&gt; {\n    Html(\"&lt;h1&gt;Hello, World!&lt;/h1&gt;\")\n}\n</code></pre><p>ç„¶åï¼Œè¿™ä¸ªhandlerçš„è¿”å›å€¼æ˜¯ <code>Html&lt;&amp;'static str&gt;</code> ç±»å‹ï¼Œå®ƒå·²ç»å®ç°äº† IntoResponseï¼Œæ‰€ä»¥å¯ä»¥ä½œä¸º Response è¿”å›ç±»å‹ã€‚ä¸‹é¢æˆ‘ä»¬æ¥æµ‹è¯•ï¼Œæ‰“å¼€ç»ˆç«¯åœ¨ä»£ç ç›®å½•ä¸‹æ‰§è¡Œ <code>cargo run</code>ã€‚ç»ˆç«¯ä¸‹è¾“å‡º <code>listening on 127.0.0.1:3000</code>ã€‚</p><p>æ‰“å¼€æµè§ˆå™¨ï¼Œè¾“å…¥ <code>127.0.0.1:3000</code>ï¼Œå¯ä»¥çœ‹åˆ°ä¸‹é¢è¿™æ ·çš„é¡µé¢æ•ˆæœã€‚</p><p><img src=\"https://static001.geekbang.org/resource/image/d7/cb/d757695525f1fd973f4532bf7475fdcb.png?wh=1920x499\" alt=\"å›¾ç‰‡\"></p><h3>ç¬¬äºŒæ­¥ï¼šå®ç°é™æ€æ–‡ä»¶æœåŠ¡</h3><p>é™æ€æ–‡ä»¶æœåŠ¡éå¸¸æœ‰ç”¨ï¼Œç”¨äºå¯¹æœåŠ¡å™¨ä¸Šçš„é™æ€èµ„æºå¦‚å›¾ç‰‡ã€HTMLã€JSã€CSSç­‰æ–‡ä»¶æä¾›æœåŠ¡ã€‚ä¸‹é¢æˆ‘ä»¬æ¥çœ‹çœ‹å¦‚ä½•ä½¿ç”¨Axumå®ç°ä¸€ä¸ªç®€å•çš„é™æ€æ–‡ä»¶æœåŠ¡ã€‚æˆ‘ä»¬åªéœ€è¦å¼•å…¥ServeDiræœåŠ¡ï¼Œç„¶ååœ¨Routerå®ä¾‹ä¸Šä½¿ç”¨ nest_service æŒ‚è½½è¿™ä¸ªæœåŠ¡å°±å¯ä»¥äº†ã€‚</p><pre><code class=\"language-rust\">&nbsp; &nbsp; Router::new().nest_service(\"/assets\", ServeDir::new(\"assets\"))\n</code></pre><p><code>ServeDir::new()</code> çš„å‚æ•°æ˜¯èµ„æºç›®å½•çš„è·¯å¾„ï¼Œä¸Šé¢ä¸€å¥è¡¨ç¤ºæŠŠ <code>/assets/*</code> çš„URLæ˜ å°„åˆ° assets ç›®å½•ä¸‹çš„å“ªäº›æ–‡ä»¶ã€‚</p><p>è€Œå¦‚æœéœ€è¦é…ç½®è·å–é»˜è®¤æ–‡ä»¶ï¼Œå¯ä»¥æŒ‰ç…§ä¸‹é¢è¿™æ ·ï¼Œåœ¨ServeDiré‡Œé…ç½®not_found_serviceï¼Œä¼ ä¸€ä¸ªServeFileå®ä¾‹è¿›å»ï¼Œè¿™ä¸ªServeFileå®ä¾‹å°±æ˜¯é»˜è®¤è·å–çš„é‚£ä¸ªæ–‡ä»¶ã€‚ç„¶ååœ¨Routerå®ä¾‹é…ç½®æ—¶ï¼Œæ·»åŠ ä¸€ä¸ª fallback_service æŒ‚è½½ serve_dirã€‚</p><pre><code class=\"language-rust\">let serve_dir =\n    ServeDir::new(\"assets2\")\n    .not_found_service(ServeFile::new(\"assets2/index.html\"));\nlet app = Router::new()\n    .route(\"/foo\", get(handler))\n    .nest_service(\"/assets\", ServeDir::new(\"assets\"))\n    .nest_service(\"/assets2\", serve_dir.clone())\n    .fallback_service(serve_dir);\n</code></pre><p>ä¸Šè¿°ç¤ºä¾‹é‡Œï¼Œå³ä½¿æˆ‘ä»¬è®¿é—®ä¸€äº›ä¸å­˜åœ¨çš„URLåœ°å€ï¼ŒæœåŠ¡å™¨ä¹Ÿä¼šè¿”å›assets2ç›®å½•ä¸‹çš„index.htmlæ–‡ä»¶ã€‚è¿™é€šå¸¸æ­£æ˜¯æˆ‘ä»¬æƒ³è¦çš„ã€‚ä½ å¯ä»¥æ ¹æ®<a href=\"https://github.com/miketang84/jikeshijian/tree/master/2122-axumapp_stepbystep/axumapp02_staticfile\">ç¤ºä¾‹æºç </a>è‡ªè¡Œæµ‹è¯•ï¼ŒæŸ¥çœ‹æ•ˆæœã€‚</p><p>ä½ å¯ä»¥å°è¯•å¦‚ä¸‹URLåœ°å€ï¼š</p><pre><code>http://127.0.0.1:3000/\nhttp://127.0.0.1:3000/foo\nhttp://127.0.0.1:3000/bar\nhttp://127.0.0.1:3000/assets/index.html\nhttp://127.0.0.1:3000/assets/ferris.png\nhttp://127.0.0.1:3000/assets/script.js\nhttp://127.0.0.1:3000/assets2/index.html\nhttp://127.0.0.1:3000/assets2/ferris2.png\nhttp://127.0.0.1:3000/assets2/script.js\n...\n</code></pre><h3>ç¬¬ä¸‰æ­¥ï¼šåŠ å…¥æ—¥å¿—è®°å½•</h3><p>æ—¥å¿—ç³»ç»Ÿæ˜¯ä¸€ä¸ªæœåŠ¡å¿…ä¸å¯å°‘çš„ç»„ä»¶ï¼Œæˆ‘ä»¬ä¸€èµ·æ¥çœ‹çœ‹å¦‚ä½•ä¸ºAxumåº”ç”¨æ·»åŠ æ—¥å¿—ã€‚åœ¨Axumä¸­æ·»åŠ æ—¥å¿—å¾ˆç®€å•ã€‚ç¬¬ä¸€æ­¥ï¼Œæˆ‘ä»¬éœ€è¦æ·»åŠ  tracing å’Œ tracing-subscriber ä¸¤ä¸ªcratesã€‚</p><pre><code class=\"language-rust\">cargo add tracing\ncargo add tracing-subscriber\n</code></pre><p>ç„¶åå¼•å…¥TraceLayerã€‚</p><pre><code class=\"language-rust\">use tower_http::trace::TraceLayer;\n</code></pre><p>åœ¨mainå‡½æ•°çš„å¼€å¤´æ·»åŠ ä»£ç ï¼š</p><pre><code class=\"language-rust\">&nbsp; &nbsp; tracing_subscriber::fmt::init();\n</code></pre><p>å†åœ¨Routeré…ç½®çš„æ—¶å€™ï¼Œæ·»åŠ ä¸‹é¢è¿™è¡Œä»£ç é…ç½®æ—¥å¿—ä¸­é—´ä»¶æœåŠ¡å°±å¯ä»¥äº†ã€‚</p><pre><code class=\"language-rust\">let app = Router::new()\n    .route(\"/foo\", get(handler))\n    .nest_service(\"/assets\", serve_dir.clone())\n    .fallback_service(serve_dir)\n    .layer(TraceLayer::new_for_http());  // æ·»åŠ è¿™è¡Œ\n</code></pre><p>ä½¿ç”¨æ—¶ï¼Œéœ€è¦æŒ‰ç…§ä¸‹é¢è¿™ä¸ªæ–¹å¼æ¥ä½¿ç”¨ã€‚</p><pre><code class=\"language-rust\">tracing::debug!(\"listening on {}\", addr);\n</code></pre><p>æˆ‘ä»¬ç”¨ä¸Šé¢ä¸€å¥æ›¿ä»£äº†ä¹‹å‰çš„ <code>println!</code>ï¼Œåœ¨ä¸€ä¸ªæ­£ç»ä¸€ç‚¹çš„åº”ç”¨ä¸­ï¼Œæˆ‘ä»¬éƒ½ä¸ä¼šä½¿ç”¨ <code>println!</code> å»æ‰“å°æ—¥å¿—çš„ã€‚</p><p>è¿™é‡Œéœ€è¦è¡¥å……ä¸€ç‚¹çŸ¥è¯†ï¼šRustä¸­çš„æ—¥å¿—æ ‡å‡†ã€‚Rustæ ‡å‡†çš„logåè®®åœ¨<a href=\"https://docs.rs/log/latest/log/\">é“¾æ¥</a>é‡Œã€‚è¿™ä¸ªcrateä¸­å®šä¹‰äº†5ä¸ªçº§åˆ«çš„æ—¥å¿—æ‰“å°è¯­å¥ã€‚</p><ul>\n<li><code>error!</code></li>\n<li><code>warn!</code></li>\n<li><code>info!</code></li>\n<li><code>debug!</code></li>\n<li><code>trace!</code></li>\n</ul><p>è¿™5ä¸ªçº§åˆ«ä»ä¸Šåˆ°ä¸‹è­¦ç¤ºç¨‹åº¦ä¸ºç”±é«˜åˆ°ä½ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œè¶Šå¾€ä¸‹ä¼šè¶Šè¯¦ç»†ã€‚</p><p>ä½†æ˜¯è¿™åªæ˜¯ä¸€å¥—åè®®çš„å®šä¹‰ï¼Œè€Œä¸æ˜¯å…·ä½“å®ç°ã€‚å…·ä½“ä½¿ç”¨çš„æ—¶å€™ï¼Œéœ€è¦ç”¨å¦å¤–çš„crateæ¥å®ç°ã€‚æˆ‘ä»¬å¸¸ç”¨çš„ env_logger å°±æ˜¯å…¶ä¸­ä¸€ç§å®ç°ï¼Œå®ƒæŠŠæ—¥å¿—è¾“å‡ºåˆ°æ ‡å‡†ç»ˆç«¯é‡Œï¼Œç”¨ç¯å¢ƒå˜é‡æ¥æ§åˆ¶æ‰“å°çš„çº§åˆ«å¼€å…³ã€‚è€Œè¿™é‡Œæˆ‘ä»¬ä½¿ç”¨çš„ tracing åº“ä¹Ÿæ˜¯è¿™æ ·ä¸€ç§å®ç°ã€‚å®ƒæ˜¯ä¸ºtokioå¼‚æ­¥è¿è¡Œæ—¶ä¸“é—¨è®¾è®¡çš„ï¼Œé€‚åˆåœ¨å¼‚æ­¥å¹¶å‘ä»£ç ä¸­ä½¿ç”¨ã€‚</p><p>ä½ å¯ä»¥ä½¿ç”¨RUST_LOGæ¥æ‰“å¼€æ—¥å¿—å¼€å…³ã€‚æ¯”å¦‚ï¼š</p><pre><code class=\"language-rust\">RUST_LOG=trace cargo run\n</code></pre><p>è®¿é—® <a href=\"http://127.0.0.1:3000/foo\">http://127.0.0.1:3000/foo</a> ï¼Œå¯ä»¥çœ‹åˆ°ï¼ŒTRACEçº§åˆ«çš„å’ŒDEBUGçº§åˆ«çš„æ—¥å¿—éƒ½æ‰“å°å‡ºæ¥äº†ã€‚</p><pre><code class=\"language-rust\">2023-12-11T05:36:39.240674Z TRACE mio::poll: registering event source with poller: token=Token(0), interests=READABLE | WRITABLE\n2023-12-11T05:36:39.240718Z DEBUG axumapp03: listening on 127.0.0.1:3000\n2023-12-11T05:36:50.029388Z TRACE mio::poll: registering event source with poller: token=Token(1), interests=READABLE | WRITABLE\n2023-12-11T05:36:50.029678Z TRACE mio::poll: registering event source with poller: token=Token(2), interests=READABLE | WRITABLE\n2023-12-11T05:36:50.030011Z DEBUG request{method=GET uri=/foo version=HTTP/1.1}: tower_http::trace::on_request: started processing request\n2023-12-11T05:36:50.030127Z DEBUG request{method=GET uri=/foo version=HTTP/1.1}: tower_http::trace::on_response: finished processing request\n latency=0 ms status=200\n</code></pre><p>ç”¨debugæ¨¡å¼æ—¥å¿—ä¼šå°‘ä¸€äº›ã€‚</p><pre><code class=\"language-rust\">RUST_LOG=debug cargo run\n</code></pre><p>è®¿é—® <a href=\"http://127.0.0.1:3000/foo\">http://127.0.0.1:3000/foo</a> ï¼Œ è¾“å‡ºï¼š</p><pre><code class=\"language-rust\">2023-12-11T05:43:45.223551Z DEBUG axumapp03: listening on 127.0.0.1:3000\n2023-12-11T05:43:50.558174Z DEBUG request{method=GET uri=/foo version=HTTP/1.1}: tower_http::trace::on_request: started processing request\n2023-12-11T05:43:50.558303Z DEBUG request{method=GET uri=/foo version=HTTP/1.1}: tower_http::trace::on_response: finished processing request\n latency=0 ms status=200\n</code></pre><p>æˆ‘ä»¬è¿˜å¯ä»¥æŒ‡å®šåªæ‰“å°æŸäº›crateé‡Œçš„æ—¥å¿—ã€‚</p><pre><code class=\"language-rust\">RUST_LOG=tower_http=debug,axumapp03=debug cargo run\n</code></pre><p>è®¿é—® <a href=\"http://127.0.0.1:3000/foo\">http://127.0.0.1:3000/foo</a> ï¼Œè¾“å‡ºï¼š</p><pre><code class=\"language-rust\">2023-12-11T05:45:03.578294Z DEBUG axumapp03: listening on 127.0.0.1:3000\n2023-12-11T05:45:08.036568Z DEBUG request{method=GET uri=/foo version=HTTP/1.1}: tower_http::trace::on_request: started processing request\n2023-12-11T05:45:08.036696Z DEBUG request{method=GET uri=/foo version=HTTP/1.1}: tower_http::trace::on_response: finished processing request\n latency=0 ms status=200\n</code></pre><p>ä½ å¯ä»¥ä¸‹è½½<a href=\"https://github.com/miketang84/jikeshijian/tree/master/2122-axumapp_stepbystep/axumapp03_addlog\">æºç </a>è‡ªè¡Œæµ‹è¯•æŸ¥çœ‹æ•ˆæœã€‚</p><h3>ç¬¬å››æ­¥ï¼šè§£æ Get è¯·æ±‚å‚æ•°</h3><p>ä¸€èˆ¬ä¸€ä¸ªURLæ˜¯è¿™æ ·çš„ï¼š</p><pre><code>https://rustcc.cn/article?id=8ba98036-e2fb-41cf-9dad-7cd874c397c4\n</code></pre><p>æœ€åé¢ä¸€æ®µæ˜¯ queryï¼Œquery çš„æ ¼å¼ä¸ºé”®å€¼å¯¹åˆ—è¡¨ï¼Œæ¯”å¦‚ <code>x1=yyy&amp;x2=zzz</code> ï¼Œé”®å€¼å¯¹ä¹‹é—´ä½¿ç”¨ &amp; ç¬¦å·éš”å¼€ã€‚</p><p>Axumé‡‡ç”¨ä¸€ç§è§£åŒ…å™¨ï¼ˆextractorï¼‰çš„æ–¹å¼ï¼Œç›´æ¥ä»HTTP Requesté‡Œæå–å‡ºå¼€å‘è€…å…³å¿ƒçš„å‚æ•°ä¿¡æ¯ã€‚è¿™ç§è®¾è®¡æœ‰ä¸€äº›å¥½å¤„ï¼š</p><ol>\n<li>å‡å°‘æ ·æ¿é‡å¤ä»£ç ï¼Œå¯ä»¥è®©ä»£ç æ›´ç´§å‡‘æ˜“è¯»ã€‚</li>\n<li>ç±»å‹åŒ–ï¼Œå……åˆ†åˆ©ç”¨Rustå¼ºå¤§çš„ç±»å‹èƒ½åŠ›ã€‚</li>\n<li>é…ç½®å¼å¼€å‘ï¼Œè½»æ¾æƒ¬æ„ã€‚</li>\n</ol><p>ä¸‹é¢æˆ‘ä»¬å…ˆæ¥çœ‹å¦‚ä½•ä»GETè¯·æ±‚çš„URLä¸­ï¼Œå–å‡ºQueryå‚æ•°ã€‚</p><p>åœ¨ Axumä¸­ï¼Œæˆ‘ä»¬åªéœ€è¦åœ¨Handlerä¸­è¿™æ ·é…ç½®è§£åŒ…å™¨å°±å¯ä»¥ã€‚</p><pre><code class=\"language-plain\">#[derive(Debug, Deserialize)]\nstruct InputParams {\n&nbsp; &nbsp; foo: i32,\n&nbsp; &nbsp; bar: String,\n&nbsp; &nbsp; third: Option&lt;i32&gt;,\n}\n\nasync fn query(Query(params): Query&lt;InputParams&gt;) -&gt; impl IntoResponse {\n&nbsp; &nbsp; tracing::debug!(\"query params {:?}\", params);\n&nbsp; &nbsp; Html(\"&lt;h3&gt;Test query&lt;/h3&gt;\")\n}\n</code></pre><p>è¿™é‡Œè¿™ä¸ª params å‚æ•°å°±æ˜¯æˆ‘ä»¬æƒ³è¦çš„queryè¯·æ±‚å‚æ•°ã€‚å¯ä»¥çœ‹åˆ°ï¼ŒAxumæ¡†æ¶è‡ªåŠ¨å¸®æˆ‘ä»¬å¤„ç†äº†è§£æå·¥ä½œï¼Œè®©æˆ‘ä»¬ç›´æ¥å¾—åˆ°äº†Rust ç»“æ„ä½“å¯¹è±¡ã€‚å‡è½»äº†æˆ‘ä»¬å¤„ç†å…·ä½“åè®®çš„ç¹çåº¦ï¼Œä¸æ˜“å‡ºé”™ã€‚è¯·æ³¨æ„ç¤ºä¾‹ç¬¬8è¡Œçš„å‚æ•°ä¸­ä½¿ç”¨äº†æ¨¡å¼åŒ¹é…ï¼Œä½ å¯ä»¥å›é¡¾ä¸€ä¸‹<a href=\"https://time.geekbang.org/column/article/720999\">ç¬¬ 6 è®²</a>çš„æ¨¡å¼åŒ¹é…ç›¸å…³çŸ¥è¯†ç‚¹ã€‚</p><p>æˆ‘ä»¬å¯ä»¥ç»§ç»­æŠ˜è…¾ä¸€ä¸‹ï¼ŒInputParamsé‡Œå®šä¹‰äº†ä¸€ä¸ªthirdå­—æ®µï¼Œå®ƒæ˜¯ <code>Option&lt;i32&gt;</code> ç±»å‹ï¼Œè¯·ä½ å°è¯•åœ¨æµè§ˆå™¨URLåœ°å€æ æˆ–æ’ä»¶ä¸­å˜æ¢è¯·æ±‚å‚æ•°ï¼ŒæŸ¥çœ‹åŠæ—¥å¿—è¾“å‡ºè¿”å›æƒ…å†µã€‚å¯èƒ½çš„å‚æ•°ç»„åˆæœ‰ä¸‹é¢è¿™å‡ ç§ã€‚</p><pre><code>http://127.0.0.1:3000/query?foo=1&amp;bar=2&amp;third=3\nhttp://127.0.0.1:3000/query?foo=1&amp;bar=2\nhttp://127.0.0.1:3000/query?foo=1\nhttp://127.0.0.1:3000/query?bar=2\nhttp://127.0.0.1:3000/query?foo=1&amp;bar=2&amp;third=3&amp;another=4\n</code></pre><p>æœ¬ç¤ºä¾‹å®Œæ•´ä»£ç åœ¨<a href=\"https://github.com/miketang84/jikeshijian/tree/master/2122-axumapp_stepbystep/axumapp04_query\">è¿™é‡Œ</a>ã€‚</p><h2>å°ç»“</h2><p>é€šè¿‡è¿™èŠ‚è¯¾çš„å±•ç¤ºï¼Œä½ æœ‰æ²¡æœ‰ä½“ä¼šåˆ°ä½¿ç”¨Rustè¿›è¡ŒWebå¼€å‘çš„æ„Ÿè§‰ï¼Ÿå…¶å®è·Ÿé‚£äº›åŠ¨æ€è¯­è¨€å¦‚Pythonã€JavaScriptç­‰å¼€å‘Webæ²¡å¤ªå¤§åŒºåˆ«ï¼ŒAxumçš„ä»£ç ä¹Ÿæ˜¯æ¯”è¾ƒç²¾ç»ƒçš„ã€‚è¯·ä½ ä¸€å®šè¦å‚è€ƒæˆ‘ç»™å‡ºçš„ä»£ç ç¤ºä¾‹ï¼Œå¯¹ç…§æºä»£ç åœ¨ä½ çš„æœ¬åœ°è·‘èµ·æ¥ã€‚Webå¼€å‘ä¸€ä¸ªéå¸¸æ–¹ä¾¿çš„åœ°æ–¹å°±æ˜¯æ–¹ä¾¿æµ‹è¯•ï¼Œæ˜“äºçœ‹åˆ°æ¸è¿›çš„æ•ˆæœæ­£åé¦ˆï¼Œæ‰€ä»¥åŠ¨æ‰‹æ˜¯éå¸¸é‡è¦è€Œä¸”é«˜æ•ˆçš„ã€‚</p><p>ç›¸æ¯”äºåŠ¨æ€è¯­è¨€æ¥è®²ï¼ŒRustçš„å¼ºç±»å‹æ›´åŠ èƒ½å¤Ÿä¿è¯Webåç«¯æœåŠ¡çš„æ­£ç¡®æ€§å’Œå¯é æ€§ã€‚æ€§èƒ½è‡ªä¸ç”¨è¯´ï¼Œä½ é€‰æ‹©äº†Rustï¼Œå°±æ˜¯é€‰æ‹©äº†é«˜èµ·ç‚¹ã€‚</p><p>åŒæ—¶ä½ å¯ä»¥çœ‹åˆ°ï¼Œè¿™èŠ‚è¯¾å‡ºç°çš„Axumç¤ºä¾‹ä»£ç ï¼Œä¸€ç‚¹éƒ½ä¸å¤æ‚ï¼Œç”šè‡³éƒ½æ²¡æœ‰ç”¨åˆ°Rustçš„æ‰€è°“å„ç§é«˜çº§ç‰¹æ€§ã€‚å…¶å®å°±æ˜¯è¿™æ ·ï¼Œä½ ç”¨Ruståšæ—¥å¸¸å¼€å‘ï¼Œç‰¹åˆ«æ˜¯ä¸šåŠ¡å¼€å‘ï¼Œæ ¹æœ¬ä¸éš¾ï¼Œä¸è¦è¢«é‚£äº›æ‰€è°“çš„é«˜çº§ç‰¹æ€§å“åˆ°ï¼Œå…ˆç”¨ç°æˆçš„æ¡†æ¶ï¼Œå¿«é€Ÿæ£é¼“å‡ºè‡ªå·±çš„ä¸œè¥¿ï¼Œåé¢å†æ…¢æ…¢ä¸Šéš¾åº¦å°±å¥½äº†ã€‚</p><h2>æ€è€ƒé¢˜</h2><p>è¯·ä½ è¯´ä¸€è¯´Request/Response æ¨¡å‹æ˜¯ä»€ä¹ˆï¼ŒAxumæ¡†æ¶å’Œå…¶ä»–gRPCæ¡†æ¶ï¼ˆæ¯”å¦‚Tonicï¼‰æœ‰ä»€ä¹ˆåŒºåˆ«ã€‚æ¬¢è¿ä½ æŠŠè‡ªå·±çš„æ€è€ƒåˆ†äº«åˆ°è¯„è®ºåŒºï¼Œä¹Ÿæ¬¢è¿ä½ æŠŠè¿™èŠ‚è¯¾çš„å†…å®¹åˆ†äº«ç»™å…¶ä»–æœ‹å‹ï¼Œæˆ‘ä»¬ä¸‹èŠ‚è¯¾å†è§ï¼</p>","comments":[{"had_liked":false,"id":385206,"user_name":"å°è™å­ğŸ¯","can_delete":false,"product_type":"c1","uid":2843479,"ip_address":"åŒ—äº¬","ucode":"4C9530B3FB407B","user_header":"https://static001.geekbang.org/account/avatar/00/2b/63/57/cba4c68b.jpg","comment_is_top":true,"comment_ctime":1702283413,"is_pvip":false,"replies":[{"id":140406,"content":"å¯¹çš„ï¼Œä»Šå¤©å·²ç»æ›´æ–°å•¦","user_name":"ä½œè€…å›å¤","user_name_real":"ç¼–è¾‘","uid":2186062,"ctime":1702289574,"ip_address":"é‡åº†","comment_id":385206,"utype":1}],"discussion_count":1,"race_medal":0,"score":2,"product_id":100626901,"comment_content":"ç‰ˆæœ¬å·²ç»æ›´æ–°åˆ° 0.7 å•¦","like_count":3,"discussions":[{"author":{"id":2186062,"avatar":"https://static001.geekbang.org/account/avatar/00/21/5b/4e/8e1f699e.jpg","nickname":"Mike Tang","note":"","ucode":"55775BCEDB5937","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":633536,"discussion_content":"å¯¹çš„ï¼Œä»Šå¤©å·²ç»æ›´æ–°å•¦","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1702289574,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"é‡åº†","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2,\"source\":0}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":385171,"user_name":"é¸ æ‘©æ™º","can_delete":false,"product_type":"c1","uid":1106201,"ip_address":"æ±Ÿè‹","ucode":"853E584FC4CD64","user_header":"https://static001.geekbang.org/account/avatar/00/10/e1/19/c756aaed.jpg","comment_is_top":false,"comment_ctime":1702259350,"is_pvip":true,"replies":[{"id":140405,"content":"å¥½çš„ï¼Œæ„Ÿè°¢è¡¥å……winä¸‹çš„ä¿¡æ¯ã€‚","user_name":"ä½œè€…å›å¤","user_name_real":"ç¼–è¾‘","uid":2186062,"ctime":1702270508,"ip_address":"é‡åº†","comment_id":385171,"utype":1}],"discussion_count":1,"race_medal":0,"score":2,"product_id":100626901,"comment_content":"windows powershellä¸­çš„å¯åŠ¨å‘½ä»¤ï¼š$env:RUST_LOG=&quot;debug&quot; ; cargo run ã€‚ä¸è®¾ç½®çº§åˆ«çš„è¯ï¼Œé»˜è®¤çœ‹ä¸åˆ°debugçº§åˆ«çš„æ—¥å¿—","like_count":3,"discussions":[{"author":{"id":2186062,"avatar":"https://static001.geekbang.org/account/avatar/00/21/5b/4e/8e1f699e.jpg","nickname":"Mike Tang","note":"","ucode":"55775BCEDB5937","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":633507,"discussion_content":"å¥½çš„ï¼Œæ„Ÿè°¢è¡¥å……winä¸‹çš„ä¿¡æ¯ã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1702270508,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"é‡åº†","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2,\"source\":0}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":386484,"user_name":"tan","can_delete":false,"product_type":"c1","uid":1477463,"ip_address":"é‡åº†","ucode":"20E176CB1EFD51","user_header":"https://static001.geekbang.org/account/avatar/00/16/8b/57/a3daeaae.jpg","comment_is_top":false,"comment_ctime":1704941021,"is_pvip":false,"replies":[{"id":140898,"content":"ğŸ‘","user_name":"ä½œè€…å›å¤","user_name_real":"ç¼–è¾‘","uid":2186062,"ctime":1705027438,"ip_address":"é‡åº†","comment_id":386484,"utype":1}],"discussion_count":1,"race_medal":0,"score":2,"product_id":100626901,"comment_content":"æ—¶åŒºè®¾ç½®\nâ— cargo add time --features macros\nâ— cargo add tracing-subscriber --features time\n\n```rust\nuse time::macros::{format_description, offset};\nuse tracing_subscriber::fmt::time::OffsetTime;\n\nlet time_fmt = format_description!(&quot;[year]-[month]-[day]T[hour]:[minute]:[second].[subsecond digits:3]&quot;);\nlet timer = OffsetTime::new(offset!(+8), time_fmt);\n\n\n&#47;&#47; init \ntracing_subscriber::fmt().with_max_level(Level::TRACE).with_timer(timer).init();\n\n\n&#47;&#47; use\ntracing::info!(&quot;listening on {}&quot;, listener.local_addr().unwrap());\n```\n","like_count":2,"discussions":[{"author":{"id":2186062,"avatar":"https://static001.geekbang.org/account/avatar/00/21/5b/4e/8e1f699e.jpg","nickname":"Mike Tang","note":"","ucode":"55775BCEDB5937","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":635659,"discussion_content":"ğŸ‘","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1705027438,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"é‡åº†","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2,\"source\":0}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":385163,"user_name":"ä¸€åª","can_delete":false,"product_type":"c1","uid":1234345,"ip_address":"ä¸Šæµ·","ucode":"084823F4BE9EFD","user_header":"https://static001.geekbang.org/account/avatar/00/12/d5/a9/2cac96a9.jpg","comment_is_top":false,"comment_ctime":1702251939,"is_pvip":false,"replies":[{"id":140400,"content":"æŠ±æ­‰ï¼Œæ–‡ç« æ˜¯åŸºäº0.6çš„ç‰ˆæœ¬ï¼Œè¿™ä¸ªæœˆå‡ºçš„0.7æœ‰ä¸€äº›break changeã€‚ä»Šå¤©å·²ç»æ›´æ–°äº†ã€‚","user_name":"ä½œè€…å›å¤","user_name_real":"ä½œè€…","uid":2186062,"ctime":1702264339,"ip_address":"é‡åº†","comment_id":385163,"utype":1}],"discussion_count":1,"race_medal":0,"score":2,"product_id":100626901,"comment_content":"ç¬¬ä¸€ä¸ªä¾‹å­ hello-world éœ€è¦ä½¿ç”¨é“¾æ¥ä¸­çš„ä¾èµ–ç‰ˆæœ¬æ‰èƒ½è¿è¡Œï¼Œåº”è¯¥æ˜¯åº“çš„æ¥å£å‘ç”Ÿå˜æ›´äº†ã€‚\næˆ–è€…ä½¿ç”¨ å®˜æ–¹æœ€æ–°ä¾‹å­\n```rust\nuse axum::{response::Html, routing::get, Router};\n\n#[tokio::main]\nasync fn main() {\n    &#47;&#47; build our application with a route\n    let app = Router::new().route(&quot;&#47;&quot;, get(handler));\n\n    &#47;&#47; run it\n    let listener = tokio::net::TcpListener::bind(&quot;127.0.0.1:3000&quot;)\n        .await\n        .unwrap();\n    println!(&quot;listening on {}&quot;, listener.local_addr().unwrap());\n    axum::serve(listener, app).await.unwrap();\n}\n\nasync fn handler() -&gt; Html&lt;&amp;&#39;static str&gt; {\n    Html(&quot;&lt;h1&gt;Hello, World!&lt;&#47;h1&gt;&quot;)\n}\n```","like_count":2,"discussions":[{"author":{"id":2186062,"avatar":"https://static001.geekbang.org/account/avatar/00/21/5b/4e/8e1f699e.jpg","nickname":"Mike Tang","note":"","ucode":"55775BCEDB5937","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":633496,"discussion_content":"æŠ±æ­‰ï¼Œæ–‡ç« æ˜¯åŸºäº0.6çš„ç‰ˆæœ¬ï¼Œè¿™ä¸ªæœˆå‡ºçš„0.7æœ‰ä¸€äº›break changeã€‚ä»Šå¤©å·²ç»æ›´æ–°äº†ã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1702264339,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"é‡åº†","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2,\"source\":0}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":385649,"user_name":"buoge","can_delete":false,"product_type":"c1","uid":1018506,"ip_address":"åŒ—äº¬","ucode":"646FC6717A09BF","user_header":"https://static001.geekbang.org/account/avatar/00/0f/8a/8a/7c1baa25.jpg","comment_is_top":false,"comment_ctime":1703041574,"is_pvip":false,"replies":[{"id":140551,"content":"å¾ˆæ£’ï¼","user_name":"ä½œè€…å›å¤","user_name_real":"ç¼–è¾‘","uid":2186062,"ctime":1703122324,"ip_address":"é‡åº†","comment_id":385649,"utype":1}],"discussion_count":1,"race_medal":0,"score":2,"product_id":100626901,"comment_content":"æ—¥å¿—éƒ¨åˆ†é…åˆè¿™ä¸ªçœ‹ä¼šæ›´ä½³\nä½¿ç”¨ tracing è®°å½•æ—¥å¿—ï¼šhttps:&#47;&#47;course.rs&#47;logs&#47;tracing.html","like_count":1,"discussions":[{"author":{"id":2186062,"avatar":"https://static001.geekbang.org/account/avatar/00/21/5b/4e/8e1f699e.jpg","nickname":"Mike Tang","note":"","ucode":"55775BCEDB5937","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":634226,"discussion_content":"å¾ˆæ£’ï¼","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1703122325,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"é‡åº†","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2,\"source\":0}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":388006,"user_name":"åœŸåœŸäºº","can_delete":false,"product_type":"c1","uid":1045486,"ip_address":"ç¦å»º","ucode":"6501B7D4F63E95","user_header":"https://static001.geekbang.org/account/avatar/00/0f/f3/ee/33ef689b.jpg","comment_is_top":false,"comment_ctime":1709126978,"is_pvip":false,"replies":[{"id":141755,"content":"æŠ¥é”™ä¿¡æ¯æ˜¯ä»€ä¹ˆï¼Ÿ\n\nå¯åŠ¨çº¿ç¨‹æ•°å¯ä»¥é…ç½®çš„ï¼Œé»˜è®¤å°±æ˜¯åˆ†é…æ ¸å¿ƒæ•°ã€‚","user_name":"ä½œè€…å›å¤","user_name_real":"ç¼–è¾‘","uid":2186062,"ctime":1713028859,"ip_address":"åŠ æ‹¿å¤§","comment_id":388006,"utype":1}],"discussion_count":1,"race_medal":0,"score":2,"product_id":100626901,"comment_content":"Axum ctrl cé€€å‡ºä¸ºå•¥ä¼šæŠ¥é”™ï¼Ÿè¿˜æœ‰å¯åŠ¨çº¿ç¨‹ä¸ä¼šæŒ‰æ ¸æ•°è‡ªåŠ¨åˆ†é…å—ï¼Ÿ","like_count":0,"discussions":[{"author":{"id":2186062,"avatar":"https://static001.geekbang.org/account/avatar/00/21/5b/4e/8e1f699e.jpg","nickname":"Mike Tang","note":"","ucode":"55775BCEDB5937","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":641837,"discussion_content":"æŠ¥é”™ä¿¡æ¯æ˜¯ä»€ä¹ˆï¼Ÿ\n\nå¯åŠ¨çº¿ç¨‹æ•°å¯ä»¥é…ç½®çš„ï¼Œé»˜è®¤å°±æ˜¯åˆ†é…æ ¸å¿ƒæ•°ã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1713028859,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"åŠ æ‹¿å¤§","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2,\"source\":0}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":385478,"user_name":"Geek_e72251","can_delete":false,"product_type":"c1","uid":3733050,"ip_address":"å¹¿ä¸œ","ucode":"894904DE2E6AC0","user_header":"https://thirdwx.qlogo.cn/mmopen/vi_32/VF71Gcf2C2bjYPFCRv0TPfwhkJmT5WhtusltuaXQM0KMDibdallNFypqWV6v2FJ4bqNwzujiaF5LEDeia7JMZTTtw/132","comment_is_top":false,"comment_ctime":1702725069,"is_pvip":false,"replies":[{"id":140568,"content":"è¿™é‡Œï¼šhttps:&#47;&#47;users.rust-lang.org&#47;t&#47;tracing-print-in-different-timezone&#47;83994&#47;4\nhttps:&#47;&#47;rustcc.cn&#47;article?id=66e2a76e-8c65-42f7-a773-66dff1a2a21e","user_name":"ä½œè€…å›å¤","user_name_real":"ç¼–è¾‘","uid":2186062,"ctime":1703123665,"ip_address":"é‡åº†","comment_id":385478,"utype":1}],"discussion_count":2,"race_medal":0,"score":2,"product_id":100626901,"comment_content":"tracingè¾“å‡ºçš„æ—¥å¿—æ—¶åŒºä¸å¯¹ï¼Œæ€ä¹ˆè®¾ç½®æ—¶åŒºå•Šï¼Ÿ","like_count":0,"discussions":[{"author":{"id":2186062,"avatar":"https://static001.geekbang.org/account/avatar/00/21/5b/4e/8e1f699e.jpg","nickname":"Mike Tang","note":"","ucode":"55775BCEDB5937","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":634244,"discussion_content":"è¿™é‡Œï¼šhttps://users.rust-lang.org/t/tracing-print-in-different-timezone/83994/4\nhttps://rustcc.cn/article?id=66e2a76e-8c65-42f7-a773-66dff1a2a21e","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1703123665,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"é‡åº†","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2,\"source\":0}","child_discussion_number":1,"child_discussions":[{"author":{"id":1477463,"avatar":"https://static001.geekbang.org/account/avatar/00/16/8b/57/a3daeaae.jpg","nickname":"tan","note":"","ucode":"20E176CB1EFD51","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":2186062,"avatar":"https://static001.geekbang.org/account/avatar/00/21/5b/4e/8e1f699e.jpg","nickname":"Mike Tang","note":"","ucode":"55775BCEDB5937","race_medal":0,"user_type":2,"is_pvip":false},"discussion":{"id":635483,"discussion_content":"é“¾æ¥ä¸èƒ½çœ‹äº†","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1704876930,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":634244,"ip_address":"é‡åº†","group_id":0},"score":635483,"extra":""}]}]},{"had_liked":false,"id":385263,"user_name":"Carlsama","can_delete":false,"product_type":"c1","uid":2074039,"ip_address":"å¹¿ä¸œ","ucode":"51817638E336F0","user_header":"https://thirdwx.qlogo.cn/mmopen/vi_32/1ooqYIZ7khDvoGHWv21vPYECXjd562DM1boWqIUxhyNUic5uyYnfglAjluMZWLZcONtTSib57EAJz4cicm4nBkpug/132","comment_is_top":false,"comment_ctime":1702364136,"is_pvip":false,"replies":[{"id":140424,"content":"æ˜¯çš„ï¼Œæ›´æ–°åˆ°0.7å•¦ï¼Œå¯ä»¥ç­‰ä»Šæ™šçš„ï¼ˆä¸‹ï¼‰å‡ºæ¥ä¸€èµ·çœ‹","user_name":"ç¼–è¾‘å›å¤","user_name_real":"ç¼–è¾‘","uid":2843479,"ctime":1702364239,"ip_address":"åŒ—äº¬","comment_id":385263,"utype":2}],"discussion_count":1,"race_medal":0,"score":2,"product_id":100626901,"comment_content":"å†…å®¹å·²ç»è°ƒæ•´åˆ°0.7äº†å—ï¼Ÿçœ‹äº†è¯„è®ºæœ‰ç‚¹ä¸æ•¢è·Ÿç€æŠ„å†™ä»£ç ï¼Œç­‰éƒ½æ›´å®Œå†ä¸€å—çœ‹","like_count":0,"discussions":[{"author":{"id":2843479,"avatar":"https://static001.geekbang.org/account/avatar/00/2b/63/57/cba4c68b.jpg","nickname":"å°è™å­ğŸ¯","note":"","ucode":"4C9530B3FB407B","race_medal":0,"user_type":8,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":633599,"discussion_content":"æ˜¯çš„ï¼Œæ›´æ–°åˆ°0.7å•¦ï¼Œå¯ä»¥ç­‰ä»Šæ™šçš„ï¼ˆä¸‹ï¼‰å‡ºæ¥ä¸€èµ·çœ‹","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1702364239,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"åŒ—äº¬","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":8,\"source\":0}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":385247,"user_name":"My dream","can_delete":false,"product_type":"c1","uid":1077733,"ip_address":"å››å·","ucode":"2FEFB344230C17","user_header":"https://static001.geekbang.org/account/avatar/00/10/71/e5/bcdc382a.jpg","comment_is_top":false,"comment_ctime":1702348430,"is_pvip":false,"replies":[{"id":140431,"content":"xlsxå’Œpdfçš„ç”ŸæˆåŸç†å°±æ˜¯ æ•°æ®+ driverã€‚crates.io ä¸Šä½ å¯ä»¥æœç´¢è¿™ä¸¤ä¸ªå…³é”®å­—ï¼Œæ‰¾ä¸‹è½½é‡æœ€å¤§çš„ç”¨ã€‚ä½ å…ˆæ‹¿åˆ°æ•°æ®ï¼Œç„¶åæŒ‰å¯¹åº”æ ¼å¼åœ¨axum handleré‡Œé¢è°ƒç”¨é©±åŠ¨å¤„ç†å°±è¡Œå•¦","user_name":"ä½œè€…å›å¤","user_name_real":"ç¼–è¾‘","uid":2186062,"ctime":1702436225,"ip_address":"é‡åº†","comment_id":385247,"utype":1}],"discussion_count":1,"race_medal":0,"score":2,"product_id":100626901,"comment_content":"æ€ä¹ˆç”¨è¿™ä¸ªæ¡†æ¶å®ç°è¯»å–ã€å¯¼å‡ºxlsæˆ–è€…pdfæ–‡ä»¶å•Šï¼Ÿ","like_count":0,"discussions":[{"author":{"id":2186062,"avatar":"https://static001.geekbang.org/account/avatar/00/21/5b/4e/8e1f699e.jpg","nickname":"Mike Tang","note":"","ucode":"55775BCEDB5937","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":633653,"discussion_content":"xlsxå’Œpdfçš„ç”ŸæˆåŸç†å°±æ˜¯ æ•°æ®+ driverã€‚crates.io ä¸Šä½ å¯ä»¥æœç´¢è¿™ä¸¤ä¸ªå…³é”®å­—ï¼Œæ‰¾ä¸‹è½½é‡æœ€å¤§çš„ç”¨ã€‚ä½ å…ˆæ‹¿åˆ°æ•°æ®ï¼Œç„¶åæŒ‰å¯¹åº”æ ¼å¼åœ¨axum handleré‡Œé¢è°ƒç”¨é©±åŠ¨å¤„ç†å°±è¡Œå•¦","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1702436225,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"é‡åº†","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2,\"source\":0}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":385167,"user_name":"é›å’Œ","can_delete":false,"product_type":"c1","uid":2695785,"ip_address":"å¹¿ä¸œ","ucode":"C703A7FDCAD58C","user_header":"https://thirdwx.qlogo.cn/mmopen/vi_32/qUHuge7oea6mA4bUTyJ4rpTP7Havj5m2WEqKvrARDbe8HYnu52vQ8DfAWNkLEfQbic83ibDhnUZYRTwut5Dl8icDA/132","comment_is_top":false,"comment_ctime":1702253923,"is_pvip":false,"replies":[{"id":140404,"content":"å¥½çš„ï¼Œè°¢è°¢ï¼Œé©¬ä¸Šå¤„ç†ã€‚å¦å¤–ï¼Œæˆ‘ä»¬æ­£åœ¨å‡çº§åˆ°0.7æ¥è®²è§£ã€‚2ï¼Œ3å¤©æå®šã€‚","user_name":"ä½œè€…å›å¤","user_name_real":"ç¼–è¾‘","uid":2186062,"ctime":1702270472,"ip_address":"é‡åº†","comment_id":385167,"utype":1}],"discussion_count":1,"race_medal":0,"score":2,"product_id":100626901,"comment_content":"è€å¸ˆï¼Œæ–‡ä¸­è¯´çš„evn_loggeræ˜¯ä¸æ˜¯ç¬”è¯¯äº†å‘¢ï¼Ÿå®é™…æ˜¯env_loggerï¼Ÿ","like_count":0,"discussions":[{"author":{"id":2186062,"avatar":"https://static001.geekbang.org/account/avatar/00/21/5b/4e/8e1f699e.jpg","nickname":"Mike Tang","note":"","ucode":"55775BCEDB5937","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":633506,"discussion_content":"å¥½çš„ï¼Œè°¢è°¢ï¼Œé©¬ä¸Šå¤„ç†ã€‚å¦å¤–ï¼Œæˆ‘ä»¬æ­£åœ¨å‡çº§åˆ°0.7æ¥è®²è§£ã€‚2ï¼Œ3å¤©æå®šã€‚","likes_number":1,"is_delete":false,"is_hidden":false,"ctime":1702270472,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"é‡åº†","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2,\"source\":0}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":385164,"user_name":"-","can_delete":false,"product_type":"c1","uid":1546505,"ip_address":"é™•è¥¿","ucode":"7B34258D346793","user_header":"https://static001.geekbang.org/account/avatar/00/17/99/09/29c46a7b.jpg","comment_is_top":false,"comment_ctime":1702252066,"is_pvip":false,"replies":[{"id":140401,"content":"ä»Šå¤©ç´§æ€¥æ›´æ–°äº†ã€‚","user_name":"ä½œè€…å›å¤","user_name_real":"ä½œè€…","uid":2186062,"ctime":1702264367,"ip_address":"é‡åº†","comment_id":385164,"utype":1}],"discussion_count":2,"race_medal":0,"score":3,"product_id":100626901,"comment_content":"å’‹æ²¡æœ‰ç”¨æœ€æ–°ç‰ˆçš„0.7ç‰ˆæœ¬å•Šï¼Ÿ","like_count":0,"discussions":[{"author":{"id":2186062,"avatar":"https://static001.geekbang.org/account/avatar/00/21/5b/4e/8e1f699e.jpg","nickname":"Mike Tang","note":"","ucode":"55775BCEDB5937","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":633497,"discussion_content":"ä»Šå¤©ç´§æ€¥æ›´æ–°äº†ã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1702264367,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"é‡åº†","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2,\"source\":0}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1519230,"avatar":"https://static001.geekbang.org/account/avatar/00/17/2e/7e/a15b477c.jpg","nickname":"Noya","note":"","ucode":"52EEB72E80BAF8","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":633489,"discussion_content":"```rust\nasync fn serve(app: Router, port: u16) {\n    let addr = SocketAddr::from(([127, 0, 0, 1], port));\n    let listener = TcpListener::bind(addr).await.unwrap();\n    tracing::debug!(&#34;listening on {}&#34;, addr);\n    axum::serve(\n        listener,\n        app.layer(TraceLayer::new_for_http()).into_make_service(),\n    )\n    .await\n    .unwrap();\n}\n```","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1702262339,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":"æµ™æ±Ÿ","group_id":0},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":385161,"user_name":"åˆ˜ä¸¹","can_delete":false,"product_type":"c1","uid":1081922,"ip_address":"å¹¿ä¸œ","ucode":"66594D1C957E15","user_header":"https://static001.geekbang.org/account/avatar/00/10/82/42/8b04d489.jpg","comment_is_top":false,"comment_ctime":1702244608,"is_pvip":false,"replies":[{"id":140403,"content":"å¥½çš„ï¼Œè°¢è°¢ï¼Œé©¬ä¸Šå¤„ç†ã€‚å¦å¤–ï¼Œæˆ‘ä»¬æ­£åœ¨å‡çº§åˆ°0.7æ¥è®²è§£ã€‚2ï¼Œ3å¤©æå®šã€‚","user_name":"ä½œè€…å›å¤","user_name_real":"ç¼–è¾‘","uid":2186062,"ctime":1702270467,"ip_address":"é‡åº†","comment_id":385161,"utype":1}],"discussion_count":1,"race_medal":0,"score":3,"product_id":100626901,"comment_content":"é”™åˆ«å­—ï¼š \ncarge add tracing-subscriber\n","like_count":0,"discussions":[{"author":{"id":2186062,"avatar":"https://static001.geekbang.org/account/avatar/00/21/5b/4e/8e1f699e.jpg","nickname":"Mike Tang","note":"","ucode":"55775BCEDB5937","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":633505,"discussion_content":"å¥½çš„ï¼Œè°¢è°¢ï¼Œé©¬ä¸Šå¤„ç†ã€‚å¦å¤–ï¼Œæˆ‘ä»¬æ­£åœ¨å‡çº§åˆ°0.7æ¥è®²è§£ã€‚2ï¼Œ3å¤©æå®šã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1702270467,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"é‡åº†","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2,\"source\":0}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":385160,"user_name":"åˆ˜ä¸¹","can_delete":false,"product_type":"c1","uid":1081922,"ip_address":"å¹¿ä¸œ","ucode":"66594D1C957E15","user_header":"https://static001.geekbang.org/account/avatar/00/10/82/42/8b04d489.jpg","comment_is_top":false,"comment_ctime":1702244165,"is_pvip":false,"replies":[{"id":140399,"content":"æŠ±æ­‰ï¼Œè¿™ç¯‡æ–‡ç« åœ¨å†™çš„æ—¶å€™æ˜¯ä»Šå¹´ä¸ŠåŠå¹´ï¼Œåé¢æˆ‘æ›´æ–°ä¸€ä¸‹ã€‚å·²ç»æ›´æ–°äº†ã€‚","user_name":"ä½œè€…å›å¤","user_name_real":"ä½œè€…","uid":2186062,"ctime":1702264285,"ip_address":"é‡åº†","comment_id":385160,"utype":1}],"discussion_count":2,"race_medal":0,"score":3,"product_id":100626901,"comment_content":"è€å¸ˆï¼Œè¯·é—®èƒ½å¦ä»‹ç»æœ€æ–°ç‰ˆæœ¬çš„ axum ?","like_count":0,"discussions":[{"author":{"id":2186062,"avatar":"https://static001.geekbang.org/account/avatar/00/21/5b/4e/8e1f699e.jpg","nickname":"Mike Tang","note":"","ucode":"55775BCEDB5937","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":633495,"discussion_content":"æŠ±æ­‰ï¼Œè¿™ç¯‡æ–‡ç« åœ¨å†™çš„æ—¶å€™æ˜¯ä»Šå¹´ä¸ŠåŠå¹´ï¼Œåé¢æˆ‘æ›´æ–°ä¸€ä¸‹ã€‚å·²ç»æ›´æ–°äº†ã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1702264285,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"é‡åº†","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2,\"source\":0}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1519230,"avatar":"https://static001.geekbang.org/account/avatar/00/17/2e/7e/a15b477c.jpg","nickname":"Noya","note":"","ucode":"52EEB72E80BAF8","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":633490,"discussion_content":"ç¨å¾®æ”¹æ”¹å°±å¥½å•¦!\n```rust\nuse std::net::SocketAddr;\n\nuse axum::{response::Html, routing, Router};\nuse tokio::net::TcpListener;\n\n#[tokio::main]\nasync fn main() {\n    let app = Router::new().route(&#34;/&#34;, routing::get(handler));\n    let addr = SocketAddr::from(([127, 0, 0, 1], 3088));\n    println!(&#34;Listening on {addr}&#34;);\n    let listener = TcpListener::bind(addr).await.unwrap();\n    axum::serve(listener, app.into_make_service()).await.unwrap();\n}\n\nasync fn handler() -&gt; Html&lt;&amp;&#39;static str&gt; {\n    Html(&#34;&lt;h1&gt; Hello, World!!!! &lt;/h1&gt;&#34;)\n}\n\n```","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1702262396,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":"æµ™æ±Ÿ","group_id":0},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":391901,"user_name":"å®‰çŸ³","can_delete":false,"product_type":"c1","uid":1508755,"ip_address":"æµ™æ±Ÿ","ucode":"185AD0046CF1C2","user_header":"https://static001.geekbang.org/account/avatar/00/17/05/93/3c3f2a6d.jpg","comment_is_top":false,"comment_ctime":1719372807,"is_pvip":false,"replies":null,"discussion_count":0,"race_medal":0,"score":3,"product_id":100626901,"comment_content":"å¹¶å‘æ€§èƒ½å¥½åƒæ²¡æœ‰nodeçš„å¥½ã€‚ã€‚ã€‚ã€‚","like_count":0}]}