{"id":414478,"title":"06ï½œget hands dirtyï¼šSQLæŸ¥è¯¢å·¥å…·æ€ä¹ˆä¸€é±¼å¤šåƒï¼Ÿ","content":"<p>ä½ å¥½ï¼Œæˆ‘æ˜¯é™ˆå¤©ã€‚</p><p>é€šè¿‡ HTTPie å’Œ Thumbor çš„ä¾‹å­ï¼Œç›¸ä¿¡ä½ å¯¹ Rust çš„èƒ½åŠ›å’Œä»£ç é£æ ¼æœ‰äº†æ¯”è¾ƒç›´è§‚çš„äº†è§£ã€‚ä¹‹å‰æˆ‘ä»¬è¯´è¿‡Rustçš„åº”ç”¨èŒƒå›´éå¸¸å¹¿ï¼Œä½†æ˜¯è¿™ä¸¤ä¸ªä¾‹å­ä½“ç°å¾—è¿˜ä¸æ˜¯å¤ªæ˜æ˜¾ã€‚</p><p>æœ‰åŒå­¦æƒ³çœ‹çœ‹ï¼Œåœ¨å®é™…å·¥ä½œä¸­æœ‰å¤§é‡ç”Ÿå‘½å‘¨æœŸæ ‡æ³¨çš„ä»£ç çš„æ ·å­ï¼›æœ‰åŒå­¦å¯¹ Rust çš„å®å¥½å¥‡ï¼›æœ‰åŒå­¦å¯¹ Rust å’Œå…¶å®ƒè¯­è¨€çš„äº’æ“ä½œæ„Ÿå…´è¶£ï¼›è¿˜æœ‰åŒå­¦æƒ³çŸ¥é“ Rust åšå®¢æˆ·ç«¯çš„æ„Ÿè§‰ã€‚æ‰€ä»¥ï¼Œæˆ‘ä»¬ä»Šå¤©å°±æ¥<strong>ç”¨ä¸€ä¸ªå¾ˆç¡¬æ ¸çš„ä¾‹å­æŠŠè¿™äº›å†…å®¹éƒ½æ¶µç›–è¿›æ¥</strong>ã€‚</p><p>è¯ä¸å¤šè¯´ï¼Œæˆ‘ä»¬ç›´æ¥å¼€å§‹ã€‚</p><h2>SQL</h2><p>æˆ‘ä»¬å·¥ä½œçš„æ—¶å€™ç»å¸¸ä¼šè·Ÿå„ç§æ•°æ®æºæ‰“äº¤é“ï¼Œæ•°æ®æºåŒ…æ‹¬æ•°æ®åº“ã€Parquetã€CSVã€JSON ç­‰ï¼Œè€Œæ‰“äº¤é“çš„è¿‡ç¨‹æ— éæ˜¯ï¼šæ•°æ®çš„è·å–ï¼ˆfetchï¼‰ã€è¿‡æ»¤ï¼ˆfilterï¼‰ã€æŠ•å½±ï¼ˆprojectionï¼‰å’Œæ’åºï¼ˆsortï¼‰ã€‚</p><p>åšå¤§æ•°æ®çš„åŒå­¦å¯ä»¥ç”¨ç±»ä¼¼ Spark SQL çš„å·¥å…·æ¥å®Œæˆå„ç§å¼‚è´¨æ•°æ®çš„æŸ¥è¯¢ï¼Œä½†æ˜¯æˆ‘ä»¬å¹³æ—¶ç”¨ SQL å¹¶æ²¡æœ‰è¿™ä¹ˆå¼ºå¤§ã€‚å› ä¸ºè™½ç„¶ç”¨ SQL å¯¹æ•°æ®åº“åšæŸ¥è¯¢ï¼Œä»»ä½• DBMS éƒ½æ”¯æŒï¼Œå¦‚æœæƒ³ç”¨ SQL æŸ¥è¯¢ CSV æˆ–è€… JSONï¼Œå°±éœ€è¦å¾ˆå¤šé¢å¤–çš„å¤„ç†ã€‚</p><p>æ‰€ä»¥å¦‚æœèƒ½æœ‰ä¸€ä¸ªç®€å•çš„å·¥å…·ï¼Œ<strong>ä¸éœ€è¦å¼•å…¥ Sparkï¼Œå°±èƒ½æ”¯æŒå¯¹ä»»ä½•æ•°æ®æºä½¿ç”¨ SQL æŸ¥è¯¢</strong>ï¼Œæ˜¯ä¸æ˜¯å¾ˆæœ‰æ„ä¹‰ï¼Ÿ</p><p>æ¯”å¦‚ï¼Œå¦‚æœä½ çš„ shell æ”¯æŒè¿™æ ·ä½¿ç”¨æ˜¯ä¸æ˜¯çˆ½çˆ†äº†ï¼Ÿ<img src=\"https://static001.geekbang.org/resource/image/3e/7c/3e8e6586d8599e39a6704cf82352cd7c.jpg?wh=1920x703\" alt=\"\"><br>\nå†æ¯”å¦‚ï¼Œæˆ‘ä»¬çš„å®¢æˆ·ç«¯ä¼šä»æœåŠ¡å™¨ API è·å–æ•°æ®çš„å­é›†ï¼Œå¦‚æœè¿™ä¸ªå­é›†å¯ä»¥åœ¨å‰ç«¯é€šè¿‡ SQL ç›´æ¥åšä¸€äº›é¢å¤–æŸ¥è¯¢ï¼Œé‚£å°†éå¸¸çµæ´»ï¼Œå¹¶ä¸”ç”¨æˆ·å¯ä»¥å¾—åˆ°å³æ—¶çš„å“åº”ã€‚</p><!-- [[[read_end]]] --><p>è½¯ä»¶é¢†åŸŸæœ‰ä¸ªè‘—åçš„<a href=\"https://zh.wikipedia.org/wiki/%E6%A0%BC%E6%9E%97%E6%96%AF%E6%BD%98%E7%AC%AC%E5%8D%81%E5%AE%9A%E5%BE%8B\">æ ¼æ—æ–¯æ½˜ç¬¬åå®šå¾‹</a>ï¼š</p><blockquote>\n<p>ä»»ä½• C æˆ– Fortran ç¨‹åºå¤æ‚åˆ°ä¸€å®šç¨‹åº¦ä¹‹åï¼Œéƒ½ä¼šåŒ…å«ä¸€ä¸ªä¸´æ—¶å¼€å‘çš„ã€ä¸åˆè§„èŒƒçš„ã€å……æ»¡ç¨‹åºé”™è¯¯çš„ã€è¿è¡Œé€Ÿåº¦å¾ˆæ…¢çš„ã€åªæœ‰ä¸€åŠåŠŸèƒ½çš„ Common Lisp å®ç°ã€‚</p>\n</blockquote><p>æˆ‘ä»¬ä»¿ç…§å®ƒæ¥ä¸€ä¸ªç¨‹åºå›ç¬¬å››åäºŒå®šå¾‹ï¼š</p><blockquote>\n<p>ä»»ä½• API æ¥å£å¤æ‚åˆ°ä¸€å®šç¨‹åº¦åï¼Œéƒ½ä¼šåŒ…å«ä¸€ä¸ªä¸´æ—¶å¼€å‘çš„ã€ä¸åˆè§„èŒƒçš„ã€å……æ»¡ç¨‹åºé”™è¯¯çš„ã€è¿è¡Œé€Ÿåº¦å¾ˆæ…¢çš„ã€åªæœ‰ä¸€åŠåŠŸèƒ½çš„ SQL å®ç°ã€‚</p>\n</blockquote><p>æ‰€ä»¥ï¼Œæˆ‘ä»¬ä»Šå¤©å°±æ¥è®¾è®¡ä¸€ä¸ªå¯ä»¥å¯¹ä»»ä½•æ•°æ®æºä½¿ç”¨ SQL æŸ¥è¯¢ï¼Œå¹¶è·å¾—ç»“æœçš„åº“å¦‚ä½•ï¼Ÿå½“ç„¶ï¼Œä½œä¸ºä¸€ä¸ª MVPï¼ˆMimimu Viable Productï¼‰ï¼Œæˆ‘ä»¬å°±æš‚ä¸”åªæ”¯æŒå¯¹ CSV çš„ SQL æŸ¥è¯¢ã€‚ä¸å•å¦‚æ­¤ï¼Œæˆ‘ä»¬è¿˜å¸Œæœ›è¿™ä¸ªåº“å¯ä»¥ç»™ Python3 å’Œ Node.js ä½¿ç”¨ã€‚</p><p>çŒœä¸€çŒœè¿™ä¸ªåº“è¦èŠ±å¤šå°‘è¡Œä»£ç ï¼Ÿä»Šå¤©éš¾åº¦æ¯”è¾ƒå¤§ï¼Œæ€ä¹ˆç€è¦ 500 è¡Œå§ï¼Ÿæˆ‘ä»¬æš‚ä¸”ä»¥ 500 è¡Œä»£ç ä¸ºåŸºå‡†æ¥æŒ‘æˆ˜ã€‚</p><h2>è®¾è®¡åˆ†æ</h2><p>æˆ‘ä»¬é¦–å…ˆéœ€è¦ä¸€ä¸ª SQL è§£æå™¨ã€‚åœ¨ Rust ä¸‹ï¼Œå†™ä¸€ä¸ªè§£æå™¨å¹¶ä¸å›°éš¾ï¼Œå¯ä»¥ç”¨ <a href=\"https://github.com/serde-rs/serde\">serde</a>ã€ç”¨ä»»ä½• <a href=\"https://en.wikipedia.org/wiki/Parser_combinator\">parser combinator</a> æˆ–è€… <a href=\"https://en.wikipedia.org/wiki/Parsing_expression_grammar\">PEG parser</a> æ¥å®ç°ï¼Œæ¯”å¦‚ <a href=\"https://github.com/Geal/nom\">nom</a> æˆ–è€… <a href=\"https://github.com/pest-parser/pest\">pest</a>ã€‚ä¸è¿‡ SQL è§£æï¼Œè¿™ç§è¶³å¤Ÿå¸¸è§çš„éœ€æ±‚ï¼ŒRust ç¤¾åŒºå·²ç»æœ‰æ–¹æ¡ˆï¼Œæˆ‘ä»¬ç”¨ <a href=\"https://github.com/sqlparser-rs/sqlparser-rs\">sqlparser-rs</a>ã€‚</p><p>æ¥ä¸‹æ¥å°±æ˜¯å¦‚ä½•æŠŠ CSV æˆ–è€…å…¶å®ƒæ•°æ®æºåŠ è½½ä¸º DataFrameã€‚</p><p>åšè¿‡æ•°æ®å¤„ç†æˆ–è€…ä½¿ç”¨è¿‡ <a href=\"https://pandas.pydata.org/pandas-docs/stable/index.html\">pandas</a> çš„åŒå­¦ï¼Œåº”è¯¥å¯¹ DataFrame å¹¶ä¸é™Œç”Ÿï¼Œå®ƒæ˜¯ä¸€ä¸ªçŸ©é˜µæ•°æ®ç»“æ„ï¼Œå…¶ä¸­æ¯ä¸€åˆ—å¯èƒ½åŒ…å«ä¸åŒçš„ç±»å‹ï¼Œå¯ä»¥åœ¨ DataFrame ä¸Šåšè¿‡æ»¤ã€æŠ•å½±å’Œæ’åºç­‰æ“ä½œã€‚</p><p>åœ¨ Rust ä¸‹ï¼Œæˆ‘ä»¬å¯ä»¥ç”¨ <a href=\"https://github.com/pola-rs/polars\">polars</a> ï¼Œæ¥å®Œæˆæ•°æ®ä» CSV åˆ° DataFrame çš„åŠ è½½å’Œå„ç§åç»­æ“ä½œã€‚</p><p>ç¡®å®šäº†è¿™ä¸¤ä¸ªåº“ä¹‹åï¼Œåç»­çš„å·¥ä½œå°±æ˜¯ï¼šå¦‚ä½•æŠŠ sqlparser è§£æå‡ºæ¥çš„æŠ½è±¡è¯­æ³•æ ‘ <a href=\"https://en.wikipedia.org/wiki/Abstract_syntax_tree\">AST</a>ï¼ˆAbstract Syntax Treeï¼‰ï¼Œæ˜ å°„åˆ° polars çš„ DataFrame çš„æ“ä½œä¸Šã€‚</p><p>æŠ½è±¡è¯­æ³•æ ‘æ˜¯ç”¨æ¥æè¿°å¤æ‚è¯­æ³•è§„åˆ™çš„å·¥å…·ï¼Œå°åˆ° SQL æˆ–è€…æŸä¸ª DSLï¼Œå¤§åˆ°ä¸€é—¨ç¼–ç¨‹è¯­è¨€ï¼Œå…¶è¯­è¨€ç»“æ„éƒ½å¯ä»¥é€šè¿‡ AST æ¥æè¿°ï¼Œå¦‚ä¸‹å›¾æ‰€ç¤ºï¼ˆæ¥æºï¼š<a href=\"https://en.wikipedia.org/wiki/Abstract_syntax_tree\">wikipedia</a>ï¼‰ï¼š</p><p><img src=\"https://static001.geekbang.org/resource/image/2f/80/2f60e2d0a908e84ef33634d840ea6380.png?wh=800x903\" alt=\"å›¾ç‰‡\"></p><p>å¦‚ä½•åœ¨ SQL è¯­æ³•å’Œ DataFrame çš„æ“ä½œé—´è¿›è¡Œæ˜ å°„å‘¢ï¼Ÿæ¯”å¦‚æˆ‘ä»¬è¦ä»æ•°æ®ä¸­é€‰å‡ºä¸‰åˆ—æ˜¾ç¤ºï¼Œé‚£è¿™ä¸ª â€œselect a, b, câ€ å°±è¦èƒ½æ˜ å°„åˆ° DataFrame é€‰å– aã€bã€c ä¸‰åˆ—è¾“å‡ºã€‚</p><p>polars å†…éƒ¨æœ‰è‡ªå·±çš„ AST å¯ä»¥æŠŠå„ç§æ“ä½œèšåˆèµ·æ¥ï¼Œæœ€åä¸€å¹¶æ‰§è¡Œã€‚æ¯”å¦‚å¯¹äº â€œwhere a &gt; 10 and b &lt; 5â€ï¼Œ Polars çš„è¡¨è¾¾å¼æ˜¯ï¼š<code>col(\"a\").gt(lit(10)).and(col(\"b\").lt(lit(5)))</code>ã€‚col ä»£è¡¨åˆ—ï¼Œgt/lt æ˜¯å¤§äº/å°äºï¼Œlit æ˜¯å­—é¢é‡çš„æ„æ€ã€‚</p><p>æœ‰äº†è¿™ä¸ªè®¤çŸ¥ï¼Œâ€œå¯¹ CSV ç­‰æºè¿›è¡Œ SQL æŸ¥è¯¢â€æ ¸å¿ƒè¦è§£å†³çš„é—®é¢˜å˜æˆäº†ï¼Œ<strong>å¦‚ä½•æŠŠä¸€ä¸ª ASTï¼ˆ SQL AST ï¼‰è½¬æ¢æˆå¦ä¸€ä¸ª ASTï¼ˆ DataFrame AST ï¼‰</strong>ã€‚</p><p>ç­‰ç­‰ï¼Œè¿™ä¸å°±æ˜¯å®ç¼–ç¨‹ï¼ˆå¯¹äº Rust æ¥è¯´ï¼Œæ˜¯è¿‡ç¨‹å®ï¼‰åšçš„äº‹æƒ…ä¹ˆï¼Ÿå› ä¸ºè¿›ä¸€æ­¥åˆ†æäºŒè€…çš„æ•°æ®ç»“æ„ï¼Œæˆ‘ä»¬å¯ä»¥å¾—åˆ°è¿™æ ·çš„å¯¹åº”å…³ç³»ï¼š</p><p><img src=\"https://static001.geekbang.org/resource/image/dd/72/ddd4995deecc4b7897bf73beb0e2cb72.jpg?wh=1920x1266\" alt=\"\"></p><p>ä½ çœ‹ï¼Œæˆ‘ä»¬è¦åšçš„ä¸»è¦äº‹æƒ…å…¶å®å°±æ˜¯ï¼Œåœ¨ä¸¤ä¸ªæ•°æ®ç»“æ„ä¹‹é—´è¿›è¡Œè½¬æ¢ã€‚æ‰€ä»¥ï¼Œå†™å®Œä»Šå¤©çš„ä»£ç ï¼Œä½ è‚¯å®šä¼šå¯¹å®æœ‰è¶³å¤Ÿçš„ä¿¡å¿ƒã€‚</p><p>å®ç¼–ç¨‹å¹¶æ²¡æœ‰ä»€ä¹ˆå¤§ä¸äº†çš„ï¼ŒæŠ›å¼€ quote/unquoteï¼Œå®ƒä¸»è¦çš„å·¥ä½œå°±æ˜¯æŠŠä¸€æ£µè¯­æ³•æ ‘è½¬æ¢æˆå¦ä¸€é¢—è¯­æ³•æ ‘ï¼Œè€Œè¿™ä¸ªè½¬æ¢çš„è¿‡ç¨‹æ·±å…¥ä¸‹å»ï¼Œä¸è¿‡å°±æ˜¯æ•°æ®ç»“æ„åˆ°æ•°æ®ç»“æ„çš„è½¬æ¢è€Œå·²ã€‚æ‰€ä»¥ä¸€å¥è¯æ€»ç»“ï¼š<strong>å®ç¼–ç¨‹çš„ä¸»è¦æµç¨‹å°±æ˜¯å®ç°è‹¥å¹² From<t> å’Œ TryFrom<t></t></t></strong>ï¼Œæ˜¯ä¸æ˜¯å¾ˆç®€å•ã€‚</p><p>å½“ç„¶ï¼Œè¿™ä¸ªè½¬æ¢çš„è¿‡ç¨‹éå¸¸çç¢ï¼Œå¦‚æœè¯­è¨€æœ¬èº«æ²¡æœ‰å¾ˆå¥½çš„æ¨¡å¼åŒ¹é…èƒ½åŠ›ï¼Œè¿›è¡Œå®ç¼–ç¨‹ç»å¯¹æ˜¯å¯¹è‡ªå·±éäººé“çš„æŠ˜ç£¨ã€‚</p><p>å¥½åœ¨ Rust æœ‰å¾ˆæ£’çš„æ¨¡å¼åŒ¹é…æ”¯æŒï¼Œå®ƒè™½ç„¶æ²¡æœ‰ Erlang/Elixir çš„æ¨¡å¼åŒ¹é…é‚£ä¹ˆå¼ºå¤§ï¼Œä½†è¶³ä»¥ç§’æ€ç»å¤§å¤šæ•°çš„ç¼–ç¨‹è¯­è¨€ã€‚å¾…ä¼šä½ åœ¨å†™çš„æ—¶å€™ï¼Œèƒ½ç›´è§‚æ„Ÿå—åˆ°ã€‚</p><h2>åˆ›å»ºä¸€ä¸ª SQL æ–¹è¨€</h2><p>å¥½ï¼Œåˆ†æå®Œè¦åšçš„äº‹æƒ…ï¼Œæ¥ä¸‹æ¥å°±æ˜¯æŒ‰éƒ¨å°±ç­å†™ä»£ç äº†ã€‚</p><p>æˆ‘ä»¬ç”¨  <code>cargo new queryer --lib</code> ç”Ÿæˆä¸€ä¸ªåº“ã€‚ç”¨ VSCode æ‰“å¼€ç”Ÿæˆçš„ç›®å½•ï¼Œåˆ›å»ºå’Œ src å¹³çº§çš„ examplesï¼Œå¹¶åœ¨ Cargo.toml ä¸­æ·»åŠ ä»£ç ï¼š</p><pre><code class=\"language-bash\">[[example]]\nname = \"dialect\"\n\n[dependencies]\nanyhow = \"1\" # é”™è¯¯å¤„ç†ï¼Œå…¶å®å¯¹äºåº“æˆ‘ä»¬åº”è¯¥ç”¨ thiserrorï¼Œä½†è¿™é‡Œç®€å•èµ·è§å°±ä¸èŠ‚å¤–ç”Ÿæäº†\nasync-trait = \"0.1\" # å…è®¸ trait é‡Œæœ‰ async fn\nsqlparser = \"0.10\" # SQL è§£æå™¨\npolars = { version = \"0.15\", features = [\"json\", \"lazy\"] } # DataFrame åº“\nreqwest = { version = \"0.11\", default-features = false, features = [\"rustls-tls\"] } # æˆ‘ä»¬çš„è€æœ‹å‹ HTTP å®¢æˆ·ç«¯\ntokio = { version = \"1\", features = [\"fs\"]} # æˆ‘ä»¬çš„è€æœ‹å‹å¼‚æ­¥åº“ï¼Œæˆ‘ä»¬è¿™é‡Œéœ€è¦å¼‚æ­¥æ–‡ä»¶å¤„ç†\ntracing = \"0.1\" # æ—¥å¿—å¤„ç†\n\n[dev-dependencies]\ntracing-subscriber = \"0.2\" # æ—¥å¿—å¤„ç†\ntokio = { version = \"1\", features = [\"full\"]} # åœ¨ example ä¸‹æˆ‘ä»¬éœ€è¦æ›´å¤šçš„ tokio feature\n</code></pre><p>ä¾èµ–æå®šã€‚å› ä¸ºå¯¹ sqlparser çš„åŠŸèƒ½ä¸å¤ªç†Ÿæ‚‰ï¼Œè¿™é‡Œå†™ä¸ª example å°è¯•ä¸€ä¸‹ï¼Œå®ƒä¼šåœ¨ examples ç›®å½•ä¸‹å¯»æ‰¾ <a href=\"http://dialect.rs\">dialect.rs</a> æ–‡ä»¶ã€‚</p><p>æ‰€ä»¥ï¼Œæˆ‘ä»¬åˆ›å»º examples/dialect.rs æ–‡ä»¶ï¼Œå¹¶å†™ä¸€äº›æµ‹è¯• sqlparser çš„ä»£ç ï¼š</p><pre><code class=\"language-rust\">use sqlparser::{dialect::GenericDialect, parser::Parser};\n\nfn main() {\n    tracing_subscriber::fmt::init();\n\n    let sql = \"SELECT a a1, b, 123, myfunc(b), * \\\n    FROM data_source \\\n    WHERE a &gt; b AND b &lt; 100 AND c BETWEEN 10 AND 20 \\\n    ORDER BY a DESC, b \\\n    LIMIT 50 OFFSET 10\";\n\n    let ast = Parser::parse_sql(&amp;GenericDialect::default(), sql);\n    println!(\"{:#?}\", ast);\n}\n</code></pre><p>è¿™æ®µä»£ç ç”¨ä¸€ä¸ª SQL è¯­å¥æ¥æµ‹è¯•<code>Parser::parse_sql</code>ä¼šè¾“å‡ºä»€ä¹ˆæ ·çš„ç»“æ„ã€‚å½“ä½ å†™åº“ä»£ç æ—¶ï¼Œå¦‚æœé‡åˆ°ä¸æ˜ç™½çš„ç¬¬ä¸‰æ–¹åº“ï¼Œå¯ä»¥ç”¨æ’°å†™ example è¿™ç§æ–¹å¼å…ˆè¯•ä¸€ä¸‹ã€‚<br>\næˆ‘ä»¬è¿è¡Œ <code>cargo run --example dialect</code>æŸ¥çœ‹ç»“æœï¼š</p><pre><code class=\"language-rust\">Ok([Query(\n    Query {\n        with: None,\n        body: Select(\n            Select {\n                distinct: false,\n                top: None,\n                projection: [ ... ],\n\t\t\t\t\t\t\t\tfrom: [ TableWithJoins { ... } ],\n\t\t\t\t\t\t\t\tselection: Some(BinaryOp { ... }),\n                ...\n            }\n        ),\n        order_by: [ OrderByExpr { ... } ],\n        limit: Some(Value( ... )),\n        offset: Some(Offset { ... })\n    }\n])\n</code></pre><p>æˆ‘æŠŠè¿™ä¸ªç»“æ„ç®€åŒ–äº†ä¸€ä¸‹ï¼Œä½ åœ¨å‘½ä»¤è¡Œé‡Œçœ‹åˆ°çš„ï¼Œä¼šè¿œæ¯”è¿™ä¸ªå¤æ‚ã€‚</p><p>å†™åˆ°ç¬¬9è¡Œè¿™é‡Œï¼Œä½ æœ‰æ²¡æœ‰çªå‘å¥‡æƒ³ï¼Œ<strong>å¦‚æœ SQL ä¸­çš„ FROM å­å¥åé¢å¯ä»¥æ¥ä¸€ä¸ª URL æˆ–è€…æ–‡ä»¶åè¯¥å¤šå¥½</strong>ï¼Ÿè¿™æ ·ï¼Œæˆ‘ä»¬å¯ä»¥ä»è¿™ä¸ª URL æˆ–æ–‡ä»¶ä¸­è¯»å–æ•°æ®ã€‚å°±åƒå¼€å¤´é‚£ä¸ª â€œselect * from psâ€ çš„ä¾‹å­ï¼ŒæŠŠ ps å‘½ä»¤ä½œä¸ºæ•°æ®æºï¼Œä»å®ƒçš„è¾“å‡ºä¸­å¾ˆæ–¹ä¾¿åœ°å–æ•°æ®ã€‚</p><p>ä½†æ˜¯æ™®é€šçš„ SQL è¯­å¥æ˜¯ä¸æ”¯æŒè¿™ç§å†™æ³•çš„ï¼Œä¸è¿‡ sqlparser å…è®¸ä½ åˆ›å»ºè‡ªå·±çš„ SQL æ–¹è¨€ï¼Œé‚£æˆ‘ä»¬å°±æ¥å°è¯•ä¸€ä¸‹ã€‚</p><p>åˆ›å»º src/dialect.rs æ–‡ä»¶ï¼Œæ·»å…¥ä¸‹é¢çš„ä»£ç ï¼š</p><pre><code class=\"language-rust\">use sqlparser::dialect::Dialect;\n\n#[derive(Debug, Default)]\npub struct TyrDialect;\n\n// åˆ›å»ºè‡ªå·±çš„ sql æ–¹è¨€ã€‚TyrDialect æ”¯æŒ identifier å¯ä»¥æ˜¯ç®€å•çš„ url\nimpl Dialect for TyrDialect {\n    fn is_identifier_start(&amp;self, ch: char) -&gt; bool {\n        ('a'..='z').contains(&amp;ch) || ('A'..='Z').contains(&amp;ch) || ch == '_'\n    }\n\n    // identifier å¯ä»¥æœ‰ ':', '/', '?', '&amp;', '='\n    fn is_identifier_part(&amp;self, ch: char) -&gt; bool {\n        ('a'..='z').contains(&amp;ch)\n            || ('A'..='Z').contains(&amp;ch)\n            || ('0'..='9').contains(&amp;ch)\n            || [':', '/', '?', '&amp;', '=', '-', '_', '.'].contains(&amp;ch)\n    }\n}\n\n/// æµ‹è¯•è¾…åŠ©å‡½æ•°\npub fn example_sql() -&gt; String {\n    let url = \"https://raw.githubusercontent.com/owid/covid-19-data/master/public/data/latest/owid-covid-latest.csv\";\n\n    let sql = format!(\n        \"SELECT location name, total_cases, new_cases, total_deaths, new_deaths \\\n        FROM {} where new_deaths &gt;= 500 ORDER BY new_cases DESC LIMIT 6 OFFSET 5\",\n        url\n    );\n\n    sql\n}\n\n#[cfg(test)]\nmod tests {\n    use super::*;\n    use sqlparser::parser::Parser;\n\n    #[test]\n    fn it_works() {\n        assert!(Parser::parse_sql(&amp;TyrDialect::default(), &amp;example_sql()).is_ok());\n    }\n}\n</code></pre><p>è¿™ä¸ªä»£ç ä¸»è¦å®ç°äº† sqlparser çš„ Dialect traitï¼Œå¯ä»¥é‡è½½ SQL è§£æå™¨åˆ¤æ–­æ ‡è¯†ç¬¦çš„æ–¹æ³•ã€‚ä¹‹åæˆ‘ä»¬éœ€è¦åœ¨ src/lib.rs ä¸­æ·»åŠ </p><pre><code class=\"language-rust\">mod dialect;\n</code></pre><p>å¼•å…¥è¿™ä¸ªæ–‡ä»¶ï¼Œæœ€åä¹Ÿå†™äº†ä¸€ä¸ªæµ‹è¯•ï¼Œä½ å¯ä»¥è¿è¡Œ  <code>cargo test</code> æµ‹è¯•ä¸€ä¸‹çœ‹çœ‹ã€‚<br>\næµ‹è¯•é€šè¿‡ï¼ç°åœ¨æˆ‘ä»¬å¯ä»¥æ­£å¸¸è§£æå‡ºè¿™æ ·çš„ SQL äº†ï¼š</p><pre><code class=\"language-sql\">SELECT * from https://abc.xyz/covid-cases.csv where new_deaths &gt;= 500\n</code></pre><p>Coolï¼ä½ çœ‹ï¼Œå¤§çº¦ç”¨äº† 10 è¡Œä»£ç ï¼ˆç¬¬ 7 è¡Œåˆ°ç¬¬ 19 è¡Œï¼‰ï¼Œé€šè¿‡æ·»åŠ å¯ä»¥è®© URL åˆæ³•çš„å­—ç¬¦ï¼Œå°±å®ç°äº†ä¸€ä¸ªè‡ªå·±çš„æ”¯æŒ URL çš„ SQL æ–¹è¨€è§£æã€‚</p><p>ä¸ºä»€ä¹ˆè¿™ä¹ˆå‰å®³ï¼Ÿå› ä¸ºé€šè¿‡ traitï¼Œä½ å¯ä»¥å¾ˆæ–¹ä¾¿åœ°åš<a href=\"https://en.wikipedia.org/wiki/Inversion_of_control\">æ§åˆ¶åè½¬ï¼ˆInversion of Controlï¼‰</a>ï¼Œåœ¨ Rust å¼€å‘ä¸­ï¼Œè¿™æ˜¯å¾ˆå¸¸è§çš„ä¸€ä»¶äº‹æƒ…ã€‚</p><h2>å®ç° AST çš„è½¬æ¢</h2><p>åˆšåˆšå®Œæˆäº†SQLè§£æï¼Œæ¥ç€å°±æ˜¯ç”¨polarsåšASTè½¬æ¢äº†ã€‚</p><p>ç”±äºæˆ‘ä»¬ä¸å¤ªäº†è§£ polars åº“ï¼Œæ¥ä¸‹æ¥è¿˜æ˜¯å…ˆæµ‹è¯•ä¸€ä¸‹æ€ä¹ˆç”¨ã€‚åˆ›å»º examples/covid.rsï¼ˆè®°å¾—åœ¨ Cargo.toml ä¸­æ·»åŠ å®ƒå“¦ï¼‰ï¼Œæ‰‹å·¥å®ç°ä¸€ä¸ª DataFrame çš„åŠ è½½å’ŒæŸ¥è¯¢ï¼š</p><pre><code class=\"language-rust\">use anyhow::Result;\nuse polars::prelude::*;\nuse std::io::Cursor;\n\n#[tokio::main]\nasync fn main() -&gt; Result&lt;()&gt; {\n    tracing_subscriber::fmt::init();\n\n    let url = \"https://raw.githubusercontent.com/owid/covid-19-data/master/public/data/latest/owid-covid-latest.csv\";\n    let data = reqwest::get(url).await?.text().await?;\n\n    // ä½¿ç”¨ polars ç›´æ¥è¯·æ±‚\n    let df = CsvReader::new(Cursor::new(data))\n        .infer_schema(Some(16))\n        .finish()?;\n\n    let filtered = df.filter(&amp;df[\"new_deaths\"].gt(500))?;\n    println!(\n        \"{:?}\",\n        filtered.select((\n            \"location\",\n            \"total_cases\",\n            \"new_cases\",\n            \"total_deaths\",\n            \"new_deaths\"\n        ))\n    );\n\n    Ok(())\n}\n</code></pre><p>å¦‚æœæˆ‘ä»¬è¿è¡Œè¿™ä¸ª exampleï¼Œå¯ä»¥å¾—åˆ°ä¸€ä¸ªæ‰“å°å¾—éå¸¸æ¼‚äº®çš„è¡¨æ ¼ï¼Œå®ƒä» GitHub ä¸Šçš„ <a href=\"https://raw.githubusercontent.com/owid/covid-19-data/master/public/data/latest/owid-covid-latest.csv\">owid-covid-latest.csv</a> æ–‡ä»¶ä¸­ï¼Œè¯»å–å¹¶æŸ¥è¯¢ new_deaths å¤§äº 500 çš„å›½å®¶å’ŒåŒºåŸŸï¼š<br>\n<img src=\"https://static001.geekbang.org/resource/image/31/69/3117645de41cc1d0d6d320c5dd6d2c69.png?wh=1682x1254\" alt=\"\"></p><p>æˆ‘ä»¬æœ€ç»ˆè¦å®ç°çš„å°±æ˜¯è¿™ä¸ªæ•ˆæœï¼Œé€šè¿‡è§£æä¸€æ¡åšç±»ä¼¼æŸ¥è¯¢çš„ SQLï¼Œæ¥è¿›è¡Œç›¸åŒçš„æ•°æ®æŸ¥è¯¢ã€‚æ€ä¹ˆåšå‘¢ï¼Ÿ</p><p>ä»Šå¤©ä¸€å¼€å§‹å·²ç»åˆ†æè¿‡äº†ï¼Œ<strong>ä¸»è¦çš„å·¥ä½œå°±æ˜¯æŠŠ sqlparser è§£æå‡ºæ¥çš„ AST è½¬æ¢æˆ polars å®šä¹‰çš„ AST</strong>ã€‚å†å›é¡¾ä¸€ä¸‹ SQL AST çš„è¾“å‡ºï¼š</p><pre><code class=\"language-rust\">Ok([Query(\n    Query {\n        with: None,\n        body: Select(\n            Select {\n                distinct: false,\n                top: None,\n                projection: [ ... ],\n\t\t\t\t\t\t\t\tfrom: [ TableWithJoins { ... } ],\n\t\t\t\t\t\t\t\tselection: Some(BinaryOp { ... }),\n                ...\n            }\n        ),\n        order_by: [ OrderByExpr { ... } ],\n        limit: Some(Value( ... )),\n        offset: Some(Offset { ... })\n    }\n])\n</code></pre><p>è¿™é‡Œçš„ Query æ˜¯ Statement enum å…¶ä¸­ä¸€ä¸ªç»“æ„ã€‚SQL è¯­å¥é™¤äº†æŸ¥è¯¢å¤–ï¼Œè¿˜æœ‰æ’å…¥æ•°æ®ã€åˆ é™¤æ•°æ®ã€åˆ›å»ºè¡¨ç­‰å…¶ä»–è¯­å¥ï¼Œæˆ‘ä»¬ä»Šå¤©ä¸å…³å¿ƒè¿™äº›ï¼Œåªå…³å¿ƒ Queryã€‚</p><p>æ‰€ä»¥ï¼Œå¯ä»¥åˆ›å»ºä¸€ä¸ªæ–‡ä»¶ src/convert.rsï¼Œ<strong>å…ˆå®šä¹‰ä¸€ä¸ªæ•°æ®ç»“æ„ Sql æ¥æè¿°ä¸¤è€…çš„å¯¹åº”å…³ç³»ï¼Œç„¶åå†å®ç° Sql çš„ TryFrom<statement> trait</statement></strong>ï¼š</p><pre><code class=\"language-rust\">/// è§£æå‡ºæ¥çš„ SQL\npub struct Sql&lt;'a&gt; {\n    pub(crate) selection: Vec&lt;Expr&gt;,\n    pub(crate) condition: Option&lt;Expr&gt;,\n    pub(crate) source: &amp;'a str,\n    pub(crate) order_by: Vec&lt;(String, bool)&gt;,\n    pub(crate) offset: Option&lt;i64&gt;,\n    pub(crate) limit: Option&lt;usize&gt;,\n}\n\nimpl&lt;'a&gt; TryFrom&lt;&amp;'a Statement&gt; for Sql&lt;'a&gt; {\n    type Error = anyhow::Error;\n\t\tfn try_from(sql: &amp;'a Statement) -&gt; Result&lt;Self, Self::Error&gt; {\n        match sql {\n            // ç›®å‰æˆ‘ä»¬åªå…³å¿ƒ query (select ... from ... where ...)\n            Statement::Query(q) =&gt; {\n\t\t\t\t\t\t\t...\n\t\t\t\t\t\t}\n\t\t\t\t}\n\t\t}\n}\n</code></pre><p>æ¡†æœ‰äº†ï¼Œç»§ç»­å†™è½¬æ¢ã€‚æˆ‘ä»¬çœ‹ Query çš„ç»“æ„ï¼šå®ƒæœ‰ä¸€ä¸ª bodyï¼Œæ˜¯ Select ç±»å‹ï¼Œå…¶ä¸­åŒ…å« projectionã€fromã€selectã€‚åœ¨ Rust é‡Œï¼Œæˆ‘ä»¬å¯ä»¥ç”¨ä¸€ä¸ªèµ‹å€¼è¯­å¥ï¼ŒåŒæ—¶ä½¿ç”¨æ¨¡å¼åŒ¹é…åŠ ä¸Šæ•°æ®çš„è§£æ„ï¼Œå°†å®ƒä»¬éƒ½å–å‡ºæ¥ï¼š</p><pre><code class=\"language-rust\">let Select {\n    from: table_with_joins,\n    selection: where_clause,\n    projection,\n\n    group_by: _,\n    ..\n} = match &amp;q.body {\n    SetExpr::Select(statement) =&gt; statement.as_ref(),\n    _ =&gt; return Err(anyhow!(\"We only support Select Query at the moment\")),\n};\n</code></pre><p>ä¸€å¥è¯ï¼Œä»åŒ¹é…åˆ°å–å¼•ç”¨ï¼Œå†åˆ°å°†å¼•ç”¨å†…éƒ¨å‡ ä¸ªå­—æ®µèµ‹å€¼ç»™å‡ ä¸ªå˜é‡ï¼Œéƒ½å®Œæˆäº†ï¼ŒçœŸæ˜¯å¤ªèˆ’æœäº†ï¼è¿™æ ·èƒ½å¤Ÿæå¤§æé«˜ç”Ÿäº§åŠ›çš„è¯­è¨€ï¼Œä½ æ€èƒ½ä¸çˆ±å®ƒï¼Ÿ</p><p>æˆ‘ä»¬å†çœ‹ä¸€ä¸ªå¤„ç† Offset çš„ä¾‹å­ï¼Œéœ€è¦æŠŠ sqlparser çš„ Offset è½¬æ¢æˆ i64ï¼ŒåŒæ ·ï¼Œå¯ä»¥å®ç°ä¸€ä¸ª TryFrom traitã€‚è¿™æ¬¡æ˜¯åœ¨ match çš„ä¸€ä¸ªåˆ†æ”¯ä¸Šï¼Œåšäº†æ•°æ®ç»“æ„çš„è§£æ„ã€‚</p><pre><code class=\"language-rust\">use sqlparser::ast::Offset as SqlOffset;\n\n// å› ä¸º Rust trait çš„å­¤å„¿è§„åˆ™ï¼Œæˆ‘ä»¬å¦‚æœè¦æƒ³å¯¹å·²æœ‰çš„ç±»å‹å®ç°å·²æœ‰çš„ traitï¼Œ\n// éœ€è¦ç®€å•åŒ…è£…ä¸€ä¸‹\n\npub struct Offset&lt;'a&gt;(pub(crate) &amp;'a SqlOffset);\n\n/// æŠŠ SqlParser çš„ offset expr è½¬æ¢æˆ i64\nimpl&lt;'a&gt; From&lt;Offset&lt;'a&gt;&gt; for i64 {\n    fn from(offset: Offset) -&gt; Self {\n        match offset.0 {\n            SqlOffset {\n                value: SqlExpr::Value(SqlValue::Number(v, _b)),\n                ..\n            } =&gt; v.parse().unwrap_or(0),\n            _ =&gt; 0,\n        }\n    }\n}\n</code></pre><p>æ˜¯çš„ï¼Œæ•°æ®çš„è§£æ„ä¹Ÿå¯ä»¥åœ¨åˆ†æ”¯ä¸Šè¿›è¡Œï¼Œå¦‚æœä½ è¿˜è®°å¾—ç¬¬ä¸‰è®²ä¸­è°ˆåˆ°çš„ if let / while letï¼Œä¹Ÿæ˜¯è¿™ä¸ªç”¨æ³•ã€‚è¿™æ ·å¯¹æ¨¡å¼åŒ¹é…çš„å…¨æ–¹ä½æ”¯æŒï¼Œä½ ç”¨å¾—è¶Šå¤šï¼Œå°±ä¼šè¶Šæ„Ÿæ¿€ Rust çš„ä½œè€…ï¼Œå°¤å…¶åœ¨å¼€å‘è¿‡ç¨‹å®çš„æ—¶å€™ã€‚</p><p>ä»è¿™æ®µä»£ç ä¸­è¿˜å¯ä»¥çœ‹åˆ°ï¼Œå®šä¹‰çš„æ•°æ®ç»“æ„ Offset ä½¿ç”¨äº†ç”Ÿå‘½å‘¨æœŸæ ‡æ³¨ &lt;'a&gt;ï¼Œè¿™æ˜¯å› ä¸ºå†…éƒ¨ä½¿ç”¨äº† SqlOffset çš„å¼•ç”¨ã€‚æœ‰å…³ç”Ÿå‘½å‘¨æœŸçš„çŸ¥è¯†ï¼Œæˆ‘ä»¬å¾ˆå¿«å°±ä¼šè®²åˆ°ï¼Œè¿™é‡Œä½ æš‚ä¸”ä¸éœ€è¦ç†è§£ä¸ºä»€ä¹ˆè¦è¿™ä¹ˆåšã€‚</p><p>æ•´ä¸ª src/convert.rs ä¸»è¦éƒ½æ˜¯é€šè¿‡æ¨¡å¼åŒ¹é…ï¼Œè¿›è¡Œä¸åŒå­ç±»å‹ä¹‹é—´çš„è½¬æ¢ï¼Œä»£ç æ¯”è¾ƒæ— è¶£ï¼Œè€Œä¸”å’Œä¸Šé¢çš„ä»£ç ç±»ä¼¼ï¼Œæˆ‘å°±ä¸è´´äº†ï¼Œä½ å¯ä»¥åœ¨è¿™é—¨è¯¾ç¨‹çš„ <a href=\"https://github.com/tyrchen/geektime-rust/blob/master/06_queryer/queryer/src/convert.rs\">GitHub repo</a> ä¸‹çš„ 06_queryer/queryer/src/convert.rs ä¸­è·å–ã€‚</p><p>æœªæ¥ä½ åœ¨ Rust ä¸‹å†™è¿‡ç¨‹å®ï¼ˆprocedure macroï¼‰ï¼Œå¹²çš„åŸºæœ¬å°±æ˜¯è¿™ä¸ªå·¥ä½œï¼Œåªä¸è¿‡ï¼Œæœ€åä½ éœ€è¦æŠŠè½¬æ¢åçš„ AST ä½¿ç”¨ quote è¾“å‡ºæˆä»£ç ã€‚åœ¨è¿™ä¸ªä¾‹å­é‡Œï¼Œæˆ‘ä»¬ä¸éœ€è¦è¿™ä¹ˆåšï¼Œpolars çš„ lazy æ¥å£ç›´æ¥èƒ½å¤„ç† ASTã€‚</p><p>è¯´å¥é¢˜å¤–è¯ï¼Œæˆ‘ä¹‹æ‰€ä»¥ä¸åŒå…¶çƒ¦åœ°è®²è¿°æ•°æ®è½¬æ¢çš„è¿™ä¸ªè¿‡ç¨‹ï¼Œæ˜¯å› ä¸ºå®ƒæ˜¯æˆ‘ä»¬ç¼–ç¨‹æ´»åŠ¨ä¸­éå¸¸é‡è¦çš„éƒ¨åˆ†ã€‚ä½ æƒ³æƒ³ï¼Œæˆ‘ä»¬å†™ä»£ç ï¼Œä¸»è¦éƒ½åœ¨å¤„ç†ä»€ä¹ˆï¼Ÿ<strong>ç»å¤§å¤šæ•°å¤„ç†é€»è¾‘éƒ½æ˜¯æŠŠæ•°æ®ä»ä¸€ä¸ªæ¥å£è½¬æ¢æˆå¦ä¸€ä¸ªæ¥å£</strong>ã€‚</p><p>ä»¥æˆ‘ä»¬ç†Ÿæ‚‰çš„ç”¨æˆ·æ³¨å†Œæµç¨‹ä¸ºä¾‹ï¼š</p><ol>\n<li>ç”¨æˆ·çš„è¾“å…¥è¢«å‰ç«¯æ ¡éªŒåï¼Œè½¬æ¢æˆ CreateUser å¯¹è±¡ï¼Œç„¶åå†è½¬æ¢æˆä¸€ä¸ª HTTP POST è¯·æ±‚ã€‚</li>\n<li>å½“è¿™ä¸ªè¯·æ±‚åˆ°è¾¾æœåŠ¡å™¨åï¼ŒæœåŠ¡å™¨å°†å…¶è¯»å–ï¼Œå†è½¬æ¢æˆæœåŠ¡å™¨çš„ CreateUser å¯¹è±¡ï¼Œè¿™ä¸ªå¯¹è±¡åœ¨æ ¡éªŒå’Œæ­£è§„åŒ–ï¼ˆnormalizationï¼‰åè¢«è½¬æˆä¸€ä¸ª ORM å¯¹è±¡ï¼ˆå¦‚æœä½¿ç”¨ ORM çš„è¯ï¼‰ï¼Œç„¶å ORM å¯¹è±¡å†è¢«è½¬æ¢æˆ SQLï¼Œå‘é€ç»™æ•°æ®åº“æœåŠ¡å™¨ã€‚</li>\n<li>æ•°æ®åº“æœåŠ¡å™¨å°† SQL è¯·æ±‚åŒ…è£…æˆä¸€ä¸ª <a href=\"https://en.wikipedia.org/wiki/Write-ahead_logging\">WAL</a>ï¼ˆWrite-Ahead Loggingï¼‰ï¼Œè¿™ä¸ª WAL å†è¢«æ›´æ–°åˆ°æ•°æ®åº“æ–‡ä»¶ä¸­ã€‚</li>\n</ol><p>æ•´ä¸ªæ•°æ®è½¬æ¢è¿‡ç¨‹å¦‚ä¸‹å›¾æ‰€ç¤ºï¼š<img src=\"https://static001.geekbang.org/resource/image/f0/e9/f0c1ab58fbe1e97f8938f01ca97c3ae9.jpg?wh=1920x653\" alt=\"\"></p><p>è¿™æ ·çš„å¤„ç†æµç¨‹ï¼Œç”±äºå®ƒå’Œä¸šåŠ¡é«˜åº¦ç»‘å®šï¼Œå¾€å¾€å®¹æ˜“è¢«å†™å¾—å¾ˆè€¦åˆï¼Œä¹…è€Œä¹…ä¹‹å°±å˜æˆäº†éš¾ä»¥ç»´æŠ¤çš„æ„å¤§åˆ©é¢æ¡ã€‚<strong>å¥½çš„ä»£ç ï¼Œ<strong><strong>åº”è¯¥</strong></strong>æ˜¯æ¯ä¸ªä¸»æµç¨‹éƒ½æ¸…æ™°ç®€çº¦ï¼Œä»£ç æ°åˆ°å¥½å¤„åœ°å‡ºç°<strong><strong>åœ¨</strong></strong>é‚£é‡Œï¼Œè®©äººä¸éœ€è¦æ³¨é‡Šä¹Ÿèƒ½æ˜ç™½ä½œè€…åœ¨å†™ä»€ä¹ˆã€‚</strong></p><p>è¿™å°±æ„å‘³ç€ï¼Œæˆ‘ä»¬è¦æŠŠé‚£äº›å¹¶ä¸é‡è¦çš„ç»†èŠ‚å°è£…åœ¨å•ç‹¬çš„åœ°æ–¹ï¼Œå°è£…çš„ç²’åº¦ä»¥ä¸€æ¬¡å†™å®Œã€åŸºæœ¬ä¸éœ€è¦å†å˜åŠ¨ä¸ºæœ€ä½³ï¼Œæˆ–è€…å³ä½¿å˜åŠ¨ï¼Œå®ƒçš„å½±å“ä¹Ÿéå¸¸å±€éƒ¨ã€‚</p><p>è¿™æ ·çš„ä»£ç ï¼Œæ–¹ä¾¿é˜…è¯»ã€å®¹æ˜“æµ‹è¯•ã€ç»´æŠ¤ç®€å•ï¼Œå¤„ç†èµ·æ¥æ›´æ˜¯ä¸€ç§äº«å—ã€‚Rust æ ‡å‡†åº“çš„ From<t> / TryFrom<t> trait ï¼Œå°±æ˜¯å‡ºäºè¿™ä¸ªç›®çš„è®¾è®¡çš„ï¼Œéå¸¸å€¼å¾—æˆ‘ä»¬å¥½å¥½ä½¿ç”¨ã€‚</t></t></p><h2>ä»æºä¸­å–æ•°æ®</h2><p>å®Œæˆäº† AST çš„è½¬æ¢ï¼Œæ¥ä¸‹æ¥å°±æ˜¯ä»æºä¸­è·å–æ•°æ®ã€‚</p><p>æˆ‘ä»¬é€šè¿‡å¯¹ Sql ç»“æ„çš„å¤„ç†å’Œå¡«å……ï¼Œå¯ä»¥å¾—åˆ° SQL FROM å­å¥é‡Œçš„æ•°æ®æºï¼Œè¿™ä¸ªæºï¼Œæˆ‘ä»¬è§„å®šå®ƒå¿…é¡»æ˜¯ä»¥ http(s):// æˆ–è€… file:// å¼€å¤´çš„å­—ç¬¦ä¸²ã€‚å› ä¸ºï¼Œä»¥ http å¼€å¤´æˆ‘ä»¬å¯ä»¥é€šè¿‡ URL è·å–å†…å®¹ï¼Œfile å¼€å¤´æˆ‘ä»¬å¯ä»¥é€šè¿‡æ–‡ä»¶åï¼Œæ‰“å¼€æœ¬åœ°æ–‡ä»¶è·å–å†…å®¹ã€‚</p><p>æ‰€ä»¥æ‹¿åˆ°äº†è¿™ä¸ªæè¿°äº†æ•°æ®æºçš„å­—ç¬¦ä¸²åï¼Œå¾ˆå®¹æ˜“èƒ½å†™å‡ºè¿™æ ·çš„ä»£ç ï¼š</p><pre><code class=\"language-rust\">/// ä»æ–‡ä»¶æºæˆ–è€… http æºä¸­è·å–æ•°æ®\nasync fn retrieve_data(source: impl AsRef&lt;str&gt;) -&gt; Result&lt;String&gt; {\n    let name = source.as_ref();\n    match &amp;name[..4] {\n        // åŒ…æ‹¬ http / https\n        \"http\" =&gt; Ok(reqwest::get(name).await?.text().await?),\n        // å¤„ç† file://&lt;filename&gt;\n        \"file\" =&gt; Ok(fs::read_to_string(&amp;name[7..]).await?),\n        _ =&gt; Err(anyhow!(\"We only support http/https/file at the moment\")),\n    }\n}\n</code></pre><p>ä»£ç çœ‹èµ·æ¥å¾ˆç®€å•ï¼Œä½†æœªæ¥å¹¶ä¸å®¹æ˜“ç»´æŠ¤ã€‚å› ä¸ºä¸€æ—¦ä½ çš„ HTTP è¯·æ±‚è·å¾—çš„ç»“æœéœ€è¦åšä¸€äº›åç»­çš„å¤„ç†ï¼Œè¿™ä¸ªå‡½æ•°å¾ˆå¿«å°±ä¼šå˜å¾—å¾ˆå¤æ‚ã€‚é‚£è¯¥æ€ä¹ˆåŠå‘¢ï¼Ÿ</p><p>å¦‚æœä½ å›é¡¾å‰ä¸¤è®²æˆ‘ä»¬å†™çš„ä»£ç ï¼Œç›¸ä¿¡ä½ å¿ƒé‡Œé©¬ä¸Šæœ‰äº†ç­”æ¡ˆï¼š<strong>å¯ä»¥ç”¨ trait æŠ½å– fetch çš„é€»è¾‘ï¼Œå®šä¹‰å¥½æ¥å£ï¼Œç„¶åæ”¹å˜ retrieve_data çš„å®ç°</strong>ã€‚</p><p>æ‰€ä»¥ä¸‹é¢æ˜¯ src/fetcher.rs çš„å®Œæ•´ä»£ç ï¼š</p><pre><code class=\"language-rust\">use anyhow::{anyhow, Result};\nuse async_trait::async_trait;\nuse tokio::fs;\n\n// Rust çš„ async trait è¿˜æ²¡æœ‰ç¨³å®šï¼Œå¯ä»¥ç”¨ async_trait å®\n#[async_trait]\npub trait Fetch {\n    type Error;\n    async fn fetch(&amp;self) -&gt; Result&lt;String, Self::Error&gt;;\n}\n\n/// ä»æ–‡ä»¶æºæˆ–è€… http æºä¸­è·å–æ•°æ®ï¼Œç»„æˆ data frame\npub async fn retrieve_data(source: impl AsRef&lt;str&gt;) -&gt; Result&lt;String&gt; {\n    let name = source.as_ref();\n    match &amp;name[..4] {\n        // åŒ…æ‹¬ http / https\n        \"http\" =&gt; UrlFetcher(name).fetch().await,\n        // å¤„ç† file://&lt;filename&gt;\n        \"file\" =&gt; FileFetcher(name).fetch().await,\n        _ =&gt; return Err(anyhow!(\"We only support http/https/file at the moment\")),\n    }\n}\n\nstruct UrlFetcher&lt;'a&gt;(pub(crate) &amp;'a str);\nstruct FileFetcher&lt;'a&gt;(pub(crate) &amp;'a str);\n\n#[async_trait]\nimpl&lt;'a&gt; Fetch for UrlFetcher&lt;'a&gt; {\n    type Error = anyhow::Error;\n\n    async fn fetch(&amp;self) -&gt; Result&lt;String, Self::Error&gt; {\n        Ok(reqwest::get(self.0).await?.text().await?)\n    }\n}\n\n#[async_trait]\nimpl&lt;'a&gt; Fetch for FileFetcher&lt;'a&gt; {\n    type Error = anyhow::Error;\n\n    async fn fetch(&amp;self) -&gt; Result&lt;String, Self::Error&gt; {\n        Ok(fs::read_to_string(&amp;self.0[7..]).await?)\n    }\n}\n</code></pre><p>è¿™çœ‹ä¸Šå»ä¼¼ä¹æ²¡æœ‰æ”¶ç›Šï¼Œè¿˜è®©ä»£ç å˜å¾—æ›´å¤šã€‚ä½†å®ƒæŠŠ retrieve_data å’Œå…·ä½“æ¯ä¸€ç§ç±»å‹çš„å¤„ç†åˆ†ç¦»äº†ï¼Œè¿˜æ˜¯æˆ‘ä»¬ä¹‹å‰è®²çš„æ€æƒ³ï¼Œé€šè¿‡å¼€é—­åŸåˆ™ï¼Œæ„å»ºä½è€¦åˆã€é«˜å†…èšçš„ä»£ç ã€‚è¿™æ ·æœªæ¥æˆ‘ä»¬ä¿®æ”¹ UrlFetcher æˆ–è€… FileFetcherï¼Œæˆ–è€…æ·»åŠ æ–°çš„ Fetcherï¼Œå¯¹ retrieve_data çš„å˜åŠ¨éƒ½æ˜¯æœ€å°çš„ã€‚</p><p>ç°åœ¨æˆ‘ä»¬å®Œæˆäº†SQLçš„è§£æã€å®ç°äº†ä»SQLåˆ°DataFrameçš„ASTçš„è½¬æ¢ï¼Œä»¥åŠæ•°æ®æºçš„è·å–ã€‚æŒ‘æˆ˜å·²ç»å®Œæˆä¸€å¤§åŠäº†ï¼Œå°±å‰©ä¸»æµç¨‹é€»è¾‘äº†ã€‚</p><h2>ä¸»æµç¨‹</h2><p>ä¸€èˆ¬æˆ‘ä»¬åœ¨åšä¸€ä¸ªåº“çš„æ—¶å€™ï¼Œä¸ä¼šæŠŠå†…éƒ¨ä½¿ç”¨çš„æ•°æ®ç»“æ„æš´éœ²å‡ºå»ï¼Œè€Œæ˜¯ä¼šç”¨è‡ªå·±çš„æ•°æ®ç»“æ„åŒ…è£¹å®ƒã€‚</p><p>ä½†è¿™æ ·ä»£ç æœ‰ä¸€ä¸ªé—®é¢˜ï¼š<strong>åŸæœ‰æ•°æ®ç»“æ„çš„æ–¹æ³•ï¼Œå¦‚æœæˆ‘ä»¬æƒ³æš´éœ²å‡ºå»ï¼Œæ¯ä¸ªæ¥å£éƒ½éœ€è¦å®ç°ä¸€é</strong>ï¼Œè™½ç„¶é‡Œé¢çš„ä»£ç å°±æ˜¯ä¸€å¥ç®€å•çš„ proxyï¼Œä½†è¿˜æ˜¯å¾ˆéº»çƒ¦ã€‚è¿™æ˜¯æˆ‘è‡ªå·±åœ¨ä½¿ç”¨å¾ˆå¤šè¯­è¨€çš„ä¸€ä¸ªç—›ç‚¹ã€‚</p><p>æ­£å¥½åœ¨ queryer åº“é‡Œä¹Ÿä¼šæœ‰è¿™ä¸ªé—®é¢˜ï¼šSQL æŸ¥è¯¢åçš„ç»“æœï¼Œä¼šæ”¾åœ¨ä¸€ä¸ª polars çš„ DataFrame ä¸­ï¼Œä½†æˆ‘ä»¬ä¸æƒ³ç›´æ¥æš´éœ²è¿™ä¸ª DataFrame å‡ºå»ã€‚å› ä¸ºä¸€æ—¦è¿™ä¹ˆåšï¼Œæœªæ¥æˆ‘ä»¬æƒ³åŠ é¢å¤–çš„ metadataï¼Œå°±æ— èƒ½ä¸ºåŠ›äº†ã€‚</p><p>æ‰€ä»¥æˆ‘å®šä¹‰äº†ä¸€ä¸ª DataSetï¼ŒåŒ…è£¹ä½ DataFrameã€‚å¯æ˜¯ï¼Œæˆ‘è¿˜æƒ³æš´éœ² DataSet çš„æ¥å£ï¼Œå®ƒæœ‰å¥½å¤šå‡½æ•°ï¼Œæ€»ä¸èƒ½æŒ¨ä¸ª proxy å§ï¼Ÿ</p><p>ä¸ç”¨ã€‚Rust æä¾›äº† Deref å’Œ DerefMut trait åšè¿™ä¸ªäº‹æƒ…ï¼Œå®ƒå…è®¸ç±»å‹åœ¨è§£å¼•ç”¨æ—¶ï¼Œå¯ä»¥è§£å¼•ç”¨åˆ°å…¶å®ƒç±»å‹ã€‚æˆ‘ä»¬åé¢åœ¨ä»‹ç» Rust å¸¸ç”¨ trait æ—¶ï¼Œä¼šè¯¦ç»†ä»‹ç»è¿™ä¸¤ä¸ª traitï¼Œç°åœ¨å…ˆæ¥çœ‹çš„ DataSet æ€ä¹ˆå¤„ç†ï¼š</p><pre><code class=\"language-rust\">#[derive(Debug)]\npub struct DataSet(DataFrame);\n\n/// è®© DataSet ç”¨èµ·æ¥å’Œ DataFrame ä¸€è‡´\nimpl Deref for DataSet {\n    type Target = DataFrame;\n\n    fn deref(&amp;self) -&gt; &amp;Self::Target {\n        &amp;self.0\n    }\n}\n\n/// è®© DataSet ç”¨èµ·æ¥å’Œ DataFrame ä¸€è‡´\nimpl DerefMut for DataSet {\n    fn deref_mut(&amp;mut self) -&gt; &amp;mut Self::Target {\n        &amp;mut self.0\n    }\n}\n\n// DataSet è‡ªå·±çš„æ–¹æ³•\nimpl DataSet {\n    /// ä» DataSet è½¬æ¢æˆ csv\n    pub fn to_csv(&amp;self) -&gt; Result&lt;String&gt; {\n        ...\n    }\n}\n</code></pre><p>å¯ä»¥çœ‹åˆ°ï¼ŒDataSet åœ¨è§£å¼•ç”¨æ—¶ï¼Œå®ƒçš„ Target æ˜¯ DataFrameï¼Œè¿™æ · DataSet åœ¨ç”¨æˆ·ä½¿ç”¨æ—¶ï¼Œå°±å’Œ DataFrame ä¸€è‡´äº†ï¼›æˆ‘ä»¬è¿˜ä¸º DataSet å®ç°äº† to_csv æ–¹æ³•ï¼Œå¯ä»¥æŠŠæŸ¥è¯¢ç»“æœç”Ÿæˆå‡º CSVã€‚</p><p>å¥½ï¼Œå®šä¹‰å¥½ DataSetï¼Œæ ¸å¿ƒå‡½æ•° query å®ç°èµ·æ¥å…¶å®å¾ˆç®€å•ï¼šå…ˆè§£æå‡ºæˆ‘ä»¬è¦çš„ Sql ç»“æ„ï¼Œç„¶åä» source ä¸­è¯»å…¥ä¸€ä¸ª DataSetï¼Œåš filter / order_by / offset / limit / select ç­‰æ“ä½œï¼Œæœ€åè¿”å› DataSetã€‚</p><p>DataSet çš„å®šä¹‰å’Œ query å‡½æ•°éƒ½åœ¨ src/lib.rsï¼Œå®ƒçš„å®Œæ•´ä»£ç å¦‚ä¸‹ï¼š</p><pre><code class=\"language-rust\">use anyhow::{anyhow, Result};\nuse polars::prelude::*;\nuse sqlparser::parser::Parser;\nuse std::convert::TryInto;\nuse std::ops::{Deref, DerefMut};\nuse tracing::info;\n\nmod convert;\nmod dialect;\nmod loader;\nmod fetcher;\nuse convert::Sql;\nuse loader::detect_content;\nuse fetcher::retrieve_data;\n\npub use dialect::example_sql;\npub use dialect::TyrDialect;\n\n#[derive(Debug)]\npub struct DataSet(DataFrame);\n\n/// è®© DataSet ç”¨èµ·æ¥å’Œ DataFrame ä¸€è‡´\nimpl Deref for DataSet {\n    type Target = DataFrame;\n\n    fn deref(&amp;self) -&gt; &amp;Self::Target {\n        &amp;self.0\n    }\n}\n\n/// è®© DataSet ç”¨èµ·æ¥å’Œ DataFrame ä¸€è‡´\nimpl DerefMut for DataSet {\n    fn deref_mut(&amp;mut self) -&gt; &amp;mut Self::Target {\n        &amp;mut self.0\n    }\n}\n\nimpl DataSet {\n    /// ä» DataSet è½¬æ¢æˆ csv\n    pub fn to_csv(&amp;self) -&gt; Result&lt;String&gt; {\n        let mut buf = Vec::new();\n        let writer = CsvWriter::new(&amp;mut buf);\n        writer.finish(self)?;\n        Ok(String::from_utf8(buf)?)\n    }\n}\n\n/// ä» from ä¸­è·å–æ•°æ®ï¼Œä» where ä¸­è¿‡æ»¤ï¼Œæœ€åé€‰å–éœ€è¦è¿”å›çš„åˆ—\npub async fn query&lt;T: AsRef&lt;str&gt;&gt;(sql: T) -&gt; Result&lt;DataSet&gt; {\n    let ast = Parser::parse_sql(&amp;TyrDialect::default(), sql.as_ref())?;\n\n    if ast.len() != 1 {\n        return Err(anyhow!(\"Only support single sql at the moment\"));\n    }\n\n    let sql = &amp;ast[0];\n\n    // æ•´ä¸ª SQL AST è½¬æ¢æˆæˆ‘ä»¬å®šä¹‰çš„ Sql ç»“æ„çš„ç»†èŠ‚éƒ½åŸ‹è—åœ¨ try_into() ä¸­\n    // æˆ‘ä»¬åªéœ€å…³æ³¨æ•°æ®ç»“æ„çš„ä½¿ç”¨ï¼Œæ€ä¹ˆè½¬æ¢å¯ä»¥ä¹‹åéœ€è¦çš„æ—¶å€™æ‰å…³æ³¨ï¼Œè¿™æ˜¯\n    // å…³æ³¨ç‚¹åˆ†ç¦»ï¼Œæ˜¯æˆ‘ä»¬æ§åˆ¶è½¯ä»¶å¤æ‚åº¦çš„æ³•å®ã€‚\n    let Sql {\n        source,\n        condition,\n        selection,\n        offset,\n        limit,\n        order_by,\n    } = sql.try_into()?;\n\n    info!(\"retrieving data from source: {}\", source);\n\n    // ä» source è¯»å…¥ä¸€ä¸ª DataSet\n    // detect_contentï¼Œæ€ä¹ˆ detect ä¸é‡è¦ï¼Œé‡è¦çš„æ˜¯å®ƒèƒ½æ ¹æ®å†…å®¹è¿”å› DataSet\n    let ds = detect_content(retrieve_data(source).await?).load()?;\n\n    let mut filtered = match condition {\n        Some(expr) =&gt; ds.0.lazy().filter(expr),\n        None =&gt; ds.0.lazy(),\n    };\n\n    filtered = order_by\n        .into_iter()\n        .fold(filtered, |acc, (col, desc)| acc.sort(&amp;col, desc));\n\n    if offset.is_some() || limit.is_some() {\n        filtered = filtered.slice(offset.unwrap_or(0), limit.unwrap_or(usize::MAX));\n    }\n\n    Ok(DataSet(filtered.select(selection).collect()?))\n}\n</code></pre><p>åœ¨ query å‡½æ•°çš„ä¸»æµç¨‹ä¸­ï¼Œæ•´ä¸ª SQL AST è½¬æ¢æˆäº†æˆ‘ä»¬å®šä¹‰çš„ Sql ç»“æ„ï¼Œç»†èŠ‚éƒ½åŸ‹è—åœ¨ try_into() ä¸­ï¼Œæˆ‘ä»¬åªéœ€å…³æ³¨æ•°æ®ç»“æ„ Sql çš„ä½¿ç”¨ï¼Œæ€ä¹ˆè½¬æ¢ä¹‹åéœ€è¦çš„æ—¶å€™å†å…³æ³¨ã€‚</p><p>è¿™å°±æ˜¯<a href=\"https://en.wikipedia.org/wiki/Separation_of_concerns\">å…³æ³¨ç‚¹åˆ†ç¦»ï¼ˆSeparation of Concernsï¼‰</a>ï¼Œæ˜¯æˆ‘ä»¬æ§åˆ¶è½¯ä»¶å¤æ‚åº¦çš„æ³•å®ã€‚Rust  æ ‡å‡†åº“ä¸­é‚£äº›ç»è¿‡åƒé”¤ç™¾ç‚¼çš„ traitï¼Œå°±æ˜¯ç”¨æ¥å¸®åŠ©æˆ‘ä»¬å†™å‡ºæ›´å¥½çš„ã€å¤æ‚åº¦æ›´ä½çš„ä»£ç ã€‚</p><p>ä¸»æµç¨‹é‡Œæœ‰ä¸ª detect_content å‡½æ•°ï¼Œå®ƒå¯ä»¥è¯†åˆ«æ–‡æœ¬å†…å®¹ï¼Œé€‰æ‹©ç›¸åº”çš„åŠ è½½å™¨æŠŠæ–‡æœ¬åŠ è½½ä¸º DataSetï¼Œå› ä¸ºç›®å‰åªæ”¯æŒ CSVï¼Œä½†æœªæ¥å¯ä»¥æ”¯æŒ JSON ç­‰å…¶ä»–æ ¼å¼ã€‚è¿™ä¸ªå‡½æ•°å®šä¹‰åœ¨ src/loader.rs é‡Œï¼Œæˆ‘ä»¬åˆ›å»ºè¿™ä¸ªæ–‡ä»¶ï¼Œå¹¶æ·»å…¥ä¸‹é¢çš„ä»£ç ï¼š</p><pre><code class=\"language-rust\">use crate::DataSet;\nuse anyhow::Result;\nuse polars::prelude::*;\nuse std::io::Cursor;\n\npub trait Load {\n    type Error;\n    fn load(self) -&gt; Result&lt;DataSet, Self::Error&gt;;\n}\n\n#[derive(Debug)]\n#[non_exhaustive]\npub enum Loader {\n    Csv(CsvLoader),\n}\n\n#[derive(Default, Debug)]\npub struct CsvLoader(pub(crate) String);\n\nimpl Loader {\n    pub fn load(self) -&gt; Result&lt;DataSet&gt; {\n        match self {\n            Loader::Csv(csv) =&gt; csv.load(),\n        }\n    }\n}\n\npub fn detect_content(data: String) -&gt; Loader {\n    // TODO: å†…å®¹æ£€æµ‹\n    Loader::Csv(CsvLoader(data))\n}\n\nimpl Load for CsvLoader {\n    type Error = anyhow::Error;\n\n    fn load(self) -&gt; Result&lt;DataSet, Self::Error&gt; {\n        let df = CsvReader::new(Cursor::new(self.0))\n            .infer_schema(Some(16))\n            .finish()?;\n        Ok(DataSet(df))\n    }\n}\n</code></pre><p>åŒæ ·ï¼Œé€šè¿‡ traitï¼Œæˆ‘ä»¬è™½ç„¶ç›®å‰åªæ”¯æŒ CsvLoaderï¼Œä½†ä¿ç•™äº†ä¸ºæœªæ¥æ·»åŠ æ›´å¤š Loader çš„æ¥å£ã€‚</p><p>å¥½ï¼Œç°åœ¨è¿™ä¸ªåº“å°±å…¨éƒ¨å†™å®Œäº†ï¼Œå°è¯•ç¼–è¯‘ä¸€ä¸‹ã€‚å¦‚æœé‡åˆ°äº†é—®é¢˜ï¼Œä¸è¦ç€æ€¥ï¼Œå¯ä»¥åœ¨è¿™é—¨è¯¾çš„ <a href=\"https://github.com/tyrchen/geektime-rust/blob/master/06_queryer/queryer\">GitHub repo</a> é‡Œè·å–å®Œæ•´çš„ä»£ç ï¼Œç„¶åå¯¹åº”ä¿®æ”¹ä½ æœ¬åœ°çš„é”™è¯¯ã€‚</p><p>å¦‚æœä»£ç ç¼–è¯‘é€šè¿‡äº†ï¼Œä½ å¯ä»¥ä¿®æ”¹ä¹‹å‰çš„ examples/covid.rsï¼Œä½¿ç”¨ SQL æ¥æŸ¥è¯¢æµ‹è¯•ä¸€ä¸‹ï¼š</p><pre><code class=\"language-rust\">use anyhow::Result;\nuse queryer::query;\n\n#[tokio::main]\nasync fn main() -&gt; Result&lt;()&gt; {\n    tracing_subscriber::fmt::init();\n\n    let url = \"https://raw.githubusercontent.com/owid/covid-19-data/master/public/data/latest/owid-covid-latest.csv\";\n\n    // ä½¿ç”¨ sql ä» URL é‡Œè·å–æ•°æ®\n    let sql = format!(\n        \"SELECT location name, total_cases, new_cases, total_deaths, new_deaths \\\n        FROM {} where new_deaths &gt;= 500 ORDER BY new_cases DESC\",\n        url\n    );\n    let df1 = query(sql).await?;\n    println!(\"{:?}\", df1);\n\n    Ok(())\n}\n</code></pre><p>Bingoï¼ä¸€åˆ‡æ­£å¸¸ï¼Œæˆ‘ä»¬å®Œæˆäº†ï¼Œç”¨ SQL è¯­å¥è¯·æ±‚ç½‘ç»œä¸Šçš„æŸä¸ª CSV ï¼Œå¹¶å¯¹ CSV åšæŸ¥è¯¢å’Œæ’åºï¼Œè¿”å›ç»“æœçš„æ­£ç¡®æ— è¯¯ï¼<br>\n<img src=\"https://static001.geekbang.org/resource/image/be/7f/be4577cd181ea6e9fc44f5b6e735867f.png?wh=1662x1256\" alt=\"\"></p><p>ç”¨ tokei æŸ¥çœ‹ä»£ç è¡Œæ•°ï¼Œå¯ä»¥çœ‹åˆ°ï¼Œç”¨äº† 375 è¡Œï¼Œè¿œä½äº 500 è¡Œçš„ç›®æ ‡ï¼</p><pre><code class=\"language-bash\">â¯ tokei src/\n-------------------------------------------------------------------------------\n Language            Files        Lines         Code     Comments       Blanks\n-------------------------------------------------------------------------------\n Rust                    5          466          375           22           69\n-------------------------------------------------------------------------------\n Total                   5          466          375           22           69\n-------------------------------------------------------------------------------\n</code></pre><p>åœ¨è¿™ä¹ˆå°çš„ä»£ç é‡ä¸‹ï¼Œæˆ‘ä»¬åœ¨æ¶æ„ä¸Šåšäº†å¾ˆå¤šä¸ºè§£è€¦è€ƒè™‘çš„å·¥ä½œï¼šæ•´ä¸ªæ¶æ„è¢«æ‹†æˆäº† Sql Parserã€Fetcherã€Loader å’Œ query å››ä¸ªéƒ¨åˆ†ã€‚<br>\n<img src=\"https://static001.geekbang.org/resource/image/35/1d/3580d96a85486849c9535cbdc6a6e51d.jpg?wh=1920x777\" alt=\"\"><br>\nå…¶ä¸­æœªæ¥å¯èƒ½å­˜åœ¨å˜åŒ–çš„ Fetcher å’Œ Loader å¯ä»¥è½»æ¾æ‰©å±•ï¼Œæ¯”å¦‚æˆ‘ä»¬ä¸€å¼€å§‹æåˆ°çš„é‚£ä¸ª â€œselect * from psâ€ï¼Œå¯ä»¥ç”¨ä¸€ä¸ª StdoutFetcher å’Œ TsvLoader æ¥å¤„ç†ã€‚</p><h2>æ”¯æŒå…¶å®ƒè¯­è¨€</h2><p>ç°åœ¨æˆ‘ä»¬çš„æ ¸å¿ƒä»£ç å†™å®Œäº†ï¼Œæœ‰æ²¡æœ‰æ„Ÿè§‰è‡ªå·±æˆå°±æ„Ÿçˆ†æ£šï¼Œå®ç°çš„queryerå·¥å…·å¯ä»¥åœ¨ Rust ä¸‹ä½œä¸ºä¸€ä¸ªåº“ï¼Œæä¾›ç»™å…¶å®ƒ Rust ç¨‹åºç”¨ï¼Œè¿™å¾ˆç¾å¦™ã€‚</p><p>ä½†æˆ‘ä»¬çš„æ•…äº‹è¿˜è¿œä¸æ­¢å¦‚æ­¤ã€‚è¿™ä¹ˆç‰›çš„åŠŸèƒ½ï¼Œåªèƒ½ Rust ç¨‹åºå‘˜äº«ç”¨ï¼Œå¤ªæš´æ®„å¤©ç‰©äº†ã€‚æ¯•ç«Ÿç‹¬ä¹ä¹ä¸å¦‚ä¼—ä¹ä¹ã€‚æ‰€ä»¥ï¼Œæˆ‘ä»¬æ¥è¯•ç€<strong>å°†å®ƒé›†æˆåˆ°å…¶å®ƒè¯­è¨€ï¼Œæ¯”å¦‚å¸¸ç”¨çš„ Node.js/Python</strong>ã€‚</p><p>Node.js/Python ä¸­æœ‰å¾ˆå¤šé«˜æ€§èƒ½çš„ä»£ç ï¼Œéƒ½æ˜¯ C/C++ å†™çš„ï¼Œä½†è·¨è¯­è¨€è°ƒç”¨å¾€å¾€æ¶‰åŠç¹æ‚çš„æ¥å£è½¬æ¢ä»£ç ï¼Œæ‰€ä»¥ç”¨ C/C++ ï¼Œå†™è¿™äº›æ¥å£è½¬æ¢çš„æ—¶å€™éå¸¸ç—›è‹¦ã€‚</p><p>æˆ‘ä»¬çœ‹çœ‹å¦‚æœç”¨ Rust çš„è¯ï¼Œèƒ½å¦é¿å…è¿™äº›ç¹æ–‡ç¼›èŠ‚ï¼Ÿæ¯•ç«Ÿï¼Œæˆ‘ä»¬å¯¹ä½¿ç”¨ Rust ï¼Œä¸ºå…¶å®ƒè¯­è¨€æä¾›é«˜æ€§èƒ½ä»£ç ï¼Œæœ‰å¾ˆé«˜çš„æœŸæœ›ï¼Œå¦‚æœè¿™ä¸ªè¿‡ç¨‹ä¹Ÿå¾ˆå¤æ‚ï¼Œé‚£æ€ä¹ˆç”¨å¾—èµ·æ¥ï¼Ÿ</p><p>å¯¹äº queryer åº“ï¼Œæˆ‘ä»¬æƒ³æš´éœ²å‡ºæ¥çš„ä¸»è¦æ¥å£æ˜¯ï¼šqueryï¼Œç”¨æˆ·ä¼ å…¥ä¸€ä¸ª SQL å­—ç¬¦ä¸²å’Œä¸€ä¸ªè¾“å‡ºç±»å‹çš„å­—ç¬¦ä¸²ï¼Œè¿”å›ä¸€ä¸ªæŒ‰ç…§ SQL æŸ¥è¯¢å¤„ç†è¿‡çš„ã€ç¬¦åˆè¾“å‡ºç±»å‹çš„å­—ç¬¦ä¸²ã€‚æ¯”å¦‚å¯¹ Python æ¥è¯´ï¼Œå°±æ˜¯ä¸‹é¢çš„æ¥å£ï¼š</p><pre><code class=\"language-python\">def query(sql, output = 'csv')\n</code></pre><p>å¥½ï¼Œæˆ‘ä»¬æ¥è¯•è¯•çœ‹ã€‚</p><p>å…ˆåˆ›å»ºä¸€ä¸ªæ–°çš„ç›®å½• queryer ä½œä¸º workspaceï¼ŒæŠŠç°æœ‰çš„ queryer ç§»è¿›å»ï¼Œæˆä¸ºå®ƒçš„å­ç›®å½•ã€‚ç„¶åï¼Œæˆ‘ä»¬åˆ›å»ºä¸€ä¸ª Cargo.tomlï¼ŒåŒ…å«ä»¥ä¸‹ä»£ç ï¼š</p><pre><code class=\"language-bash\">[workspace]\n\nmembers = [\n  \"queryer\",\n  \"queryer-py\"\n]\n</code></pre><h3>Python</h3><p>æˆ‘ä»¬åœ¨ workspace çš„æ ¹ç›®å½•ä¸‹ï¼Œ <code>cargo new queryer-py --lib</code> ï¼Œç”Ÿæˆä¸€ä¸ªæ–°çš„ crateã€‚åœ¨ queryer-py ä¸‹ï¼Œç¼–è¾‘ Cargo.tomlï¼š</p><pre><code class=\"language-bash\">[package]\nname = \"queryer_py\" # Python æ¨¡å—éœ€è¦ç”¨ä¸‹åˆ’çº¿\nversion = \"0.1.0\"\nedition = \"2018\"\n\n[lib]\ncrate-type = [\"cdylib\"] # ä½¿ç”¨ cdylib ç±»å‹\n\n[dependencies]\nqueryer = { path = \"../queryer\" } # å¼•å…¥ queryer\ntokio = { version = \"1\", features = [\"full\"] }\n\n[dependencies.pyo3] # å¼•å…¥ pyo3\nversion = \"0.14\"\nfeatures = [\"extension-module\"]\n\n[build-dependencies]\npyo3-build-config = \"0.14\"\n</code></pre><p>Rust å’Œ Python äº¤äº’çš„åº“æ˜¯ <a href=\"https://github.com/PyO3/pyo3\">pyo3</a>ï¼Œæ„Ÿå…´è¶£ä½ å¯ä»¥è¯¾åçœ‹å®ƒçš„æ–‡æ¡£ã€‚åœ¨ src/lib.rs ä¸‹ï¼Œæ·»å…¥å¦‚ä¸‹ä»£ç ï¼š</p><pre><code class=\"language-rust\">use pyo3::{exceptions, prelude::*};\n\n#[pyfunction]\npub fn example_sql() -&gt; PyResult&lt;String&gt; {\n    Ok(queryer::example_sql())\n}\n\n#[pyfunction]\npub fn query(sql: &amp;str, output: Option&lt;&amp;str&gt;) -&gt; PyResult&lt;String&gt; {\n    let rt = tokio::runtime::Runtime::new().unwrap();\n    let data = rt.block_on(async { queryer::query(sql).await.unwrap() });\n    match output {\n        Some(\"csv\") | None =&gt; Ok(data.to_csv().unwrap()),\n        Some(v) =&gt; Err(exceptions::PyTypeError::new_err(format!(\n            \"Output type {} not supported\",\n            v\n        ))),\n    }\n}\n\n#[pymodule]\nfn queryer_py(_py: Python, m: &amp;PyModule) -&gt; PyResult&lt;()&gt; {\n    m.add_function(wrap_pyfunction!(query, m)?)?;\n    m.add_function(wrap_pyfunction!(example_sql, m)?)?;\n    Ok(())\n}\n</code></pre><p>å³ä½¿æˆ‘ä¸è§£é‡Šè¿™äº›ä»£ç ï¼Œä½ ä¹ŸåŸºæœ¬èƒ½æ˜ç™½å®ƒåœ¨å¹²å˜›ã€‚æˆ‘ä»¬ä¸º Python æ¨¡å—æä¾›äº†ä¸¤ä¸ªæ¥å£ example_sql å’Œ queryã€‚</p><p>æ¥ä¸‹æ¥åœ¨ queryer-py ç›®å½•ä¸‹ï¼Œåˆ›å»º virtual envï¼Œç„¶åç”¨ <code>maturin develop</code> æ„å»º python æ¨¡å—ï¼š</p><pre><code class=\"language-bash\">python3 -m venv .env\nsource .env/bin/activate\npip install maturin ipython\nmaturin develop\n</code></pre><p>æ„å»ºå®Œæˆåï¼Œå¯ä»¥ç”¨ ipython æµ‹è¯•ï¼š</p><pre><code class=\"language-bash\">In [1]: import queryer_py\n\nIn [2]: sql = queryer_py.example_sql()\n\nIn [3]: print(queryer_py.query(sql, 'csv'))\nname,total_cases,new_cases,total_deaths,new_deaths\nIndia,32649947.0,46759.0,437370.0,509.0\nIran,4869414.0,36279.0,105287.0,571.0\nAfrica,7695475.0,33957.0,193394.0,764.0\nSouth America,36768062.0,33853.0,1126593.0,1019.0\nBrazil,20703906.0,27345.0,578326.0,761.0\nMexico,3311317.0,19556.0,257150.0,863.0\n\nIn [4]: print(queryer_py.query(sql, 'json'))\n---------------------------------------------------------------------------\nTypeError                                 Traceback (most recent call last)\n&lt;ipython-input-4-7082f1ffe46a&gt; in &lt;module&gt;\n----&gt; 1 print(queryer_py.query(sql, 'json'))\n\nTypeError: Output type json not supported\n</code></pre><p>Coolï¼ä»…ä»…å†™äº† 20 è¡Œä»£ç ï¼Œå°±è®©æˆ‘ä»¬çš„æ¨¡å—å¯ä»¥è¢« Python è°ƒç”¨ï¼Œé”™è¯¯å¤„ç†ä¹Ÿå¾ˆæ­£å¸¸ã€‚ä½ çœ‹ï¼Œåœ¨ç”¨ Rust åº“çš„åŸºç¡€ä¸Šï¼Œæˆ‘ä»¬ç¨å¾®å†™ä¸€äº›è¾…åŠ©ä»£ç ï¼Œå°±èƒ½å¤Ÿè®©å®ƒå’Œä¸åŒçš„è¯­è¨€é›†æˆèµ·æ¥ã€‚æˆ‘è§‰å¾—è¿™æ˜¯ Rust éå¸¸æœ‰æ½œåŠ›çš„ä½¿ç”¨æ–¹å‘ã€‚</p><p>æ¯•ç«Ÿï¼Œå¯¹å¾ˆå¤šå…¬å¸æ¥è¯´ï¼ŒåŸæœ‰çš„ä»£ç åº“æƒ³è¦å®Œæ•´è¿ç§»åˆ° Rust æˆæœ¬å¾ˆå¤§ï¼Œä½†æ˜¯é€šè¿‡ Rust å’Œå„ä¸ªè¯­è¨€è½»ä¾¿åœ°é›†æˆï¼Œå¯ä»¥æŠŠéƒ¨åˆ†éœ€è¦é«˜æ€§èƒ½çš„ä»£ç è¿ç§»åˆ° Rustï¼Œå°åˆ°ç”œå¤´ï¼Œå†ä¸€ç‚¹ç‚¹æ¨å¹¿ã€‚è¿™æ ·ï¼ŒRust å°±èƒ½åº”ç”¨èµ·æ¥äº†ã€‚</p><h2>å°ç»“</h2><p>å›é¡¾è¿™å‘¨çš„ Rust ä»£ç ä¹‹æ—…ï¼Œæˆ‘ä»¬å…ˆåšäº†ä¸ª HTTPieï¼Œæµç¨‹ç®€å•ï¼Œé’é“œçº§éš¾åº¦ï¼Œä½ å­¦å®Œæ‰€æœ‰æƒï¼Œç†è§£äº†åŸºæœ¬çš„ trait åå°±èƒ½å†™ã€‚</p><p>ä¹‹åçš„ Thumborï¼Œå¼•å…¥äº†å¼‚æ­¥ã€æ³›å‹å’Œæ›´å¤šçš„ traitï¼Œç™½é“¶çº§éš¾åº¦ï¼Œåœ¨ä½ å­¦å®Œç±»å‹ç³»ç»Ÿï¼Œå¯¹å¼‚æ­¥ç¨æœ‰äº†è§£åï¼Œåº”è¯¥å¯ä»¥æå®šã€‚</p><p>ä»Šå¤©çš„ Queryerï¼Œä½¿ç”¨äº†å¤§é‡çš„ trait ï¼Œæ¥è®©ä»£ç ç»“æ„è¶³å¤Ÿç¬¦åˆå¼€é—­åŸåˆ™å’Œå…³æ³¨ç‚¹åˆ†ç¦»ï¼Œç”¨äº†ä¸å°‘ç”Ÿå‘½å‘¨æœŸæ ‡æ³¨ï¼Œæ¥å‡å°‘ä¸å¿…è¦çš„å†…å­˜æ‹·è´ï¼Œè¿˜åšäº†ä¸å°‘å¤æ‚çš„æ¨¡å¼åŒ¹é…æ¥è·å–æ•°æ®ï¼Œæ˜¯é»„é‡‘çº§éš¾åº¦ï¼Œåœ¨å­¦å®Œæœ¬è¯¾ç¨‹çš„è¿›é˜¶ç¯‡åï¼Œä½ åº”è¯¥å¯ä»¥ç†è§£è¿™äº›ä»£ç ã€‚</p><p>å¾ˆå¤šäººè§‰å¾— Rust ä»£ç å¾ˆéš¾å†™ï¼Œå°¤å…¶æ˜¯æ³›å‹æ•°æ®ç»“æ„å’Œç”Ÿå‘½å‘¨æœŸæ…åœ¨ä¸€èµ·çš„æ—¶å€™ã€‚ä½†åœ¨å‰ä¸¤ä¸ªä¾‹å­é‡Œï¼Œç”Ÿå‘½å‘¨æœŸçš„æ ‡æ³¨åªå‡ºç°è¿‡äº†ä¸€æ¬¡ã€‚æ‰€ä»¥ï¼Œ<strong>å…¶å®å¤§éƒ¨åˆ†æ—¶å€™ï¼Œä½ çš„ä»£ç å¹¶ä¸éœ€è¦å¤æ‚çš„ç”Ÿå‘½å‘¨æœŸæ ‡æ³¨</strong>ã€‚</p><p>åªè¦å¯¹æ‰€æœ‰æƒå’Œç”Ÿå‘½å‘¨æœŸçš„ç†è§£æ²¡æœ‰é—®é¢˜ï¼Œå¦‚æœä½ é™·å…¥äº†æ— ä¼‘æ­¢çš„ç”Ÿå‘½å‘¨æœŸæ ‡æ³¨ï¼Œå’Œç¼–è¯‘å™¨ç—›è‹¦åœ°ææ–—ï¼Œé‚£ä½ ä¹Ÿè®¸è¦åœä¸‹æ¥å…ˆæƒ³ä¸€æƒ³ï¼š</p><p>ç¼–è¯‘å™¨å¦‚æ­¤ä¸å–œæ¬¢æˆ‘çš„å†™æ³•ï¼Œä¼šä¸ä¼šæˆ‘çš„è®¾è®¡æœ¬èº«å°±æœ‰é—®é¢˜å‘¢ï¼Ÿæˆ‘æ˜¯ä¸æ˜¯è¯¥ä½¿ç”¨æ›´å¥½çš„æ•°æ®ç»“æ„ï¼Ÿæˆ‘æ˜¯ä¸æ˜¯è¯¥é‡æ–°è®¾è®¡ä¸€ä¸‹ï¼Ÿæˆ‘çš„ä»£ç æ˜¯ä¸æ˜¯è¿‡åº¦è€¦åˆäº†ï¼Ÿ</p><p>å°±åƒèŒ´é¦™è±†çš„èŒ´å­—æœ‰å››ç§å†™æ³•ä¸€æ ·ï¼ŒåŒä¸€ä¸ªéœ€æ±‚ï¼Œç”¨ç›¸åŒçš„è¯­è¨€ï¼Œä¸åŒçš„äººä¹Ÿä¼šæœ‰ä¸åŒçš„å†™æ³•ã€‚ä½†æ˜¯ï¼Œ<strong>ä¼˜ç§€çš„è®¾è®¡ä¸€å®šæ˜¯äº§ç”Ÿç®€å•æ˜“è¯»çš„ä»£ç ï¼Œè€Œä¸æ˜¯ç›¸å</strong>ã€‚</p><p>å¥½ï¼Œè¿™å‘¨çš„ä»£ç ä¹‹æ—…å°±å‘Šä¸€æ®µè½äº†ï¼Œæ¥ä¸‹æ¥æˆ‘ä»¬å°±è¦å±•å¼€ä¸€æ®µå£®ä¸½çš„æ¢é™©ï¼Œä½ å°†ä¼šåƒæ¯”å°”åšÂ·å·´é‡‘æ–¯é‚£æ ·ï¼Œåœ¨é€šå¾€å­¤å±±çš„å†’é™©ä¹‹æ—…ä¸­ï¼Œä¸€ç‚¹ç‚¹æ¢ç´¢è¿·äººçš„ä¸­åœŸä¸–ç•Œã€‚ç­‰åˆ°æˆ‘ä»¬å­¦å®Œäº†æ‰€æœ‰æƒã€ç±»å‹ç³»ç»Ÿã€traitã€æ™ºèƒ½æŒ‡é’ˆç­‰å†…å®¹ä¹‹åï¼Œå†æ¥çœ‹è¿™ä¸‰ä¸ªå®ä¾‹ï¼Œç›¸ä¿¡ä½ ä¼šæœ‰ä¸ä¸€æ ·çš„æ„Ÿæ‚Ÿã€‚æˆ‘ä¹Ÿä¼šåœ¨åç»­çš„è¯¾ç¨‹ä¸­ï¼Œæ ¹æ®å·²å­¦å†…å®¹ï¼Œå›é¡¾ä»Šå¤©å†™çš„ä»£ç ï¼Œç»§ç»­ä¼˜åŒ–å’Œå®Œå–„å®ƒä»¬ã€‚</p><h2>æ€è€ƒé¢˜</h2><p>Node.js çš„å¤„ç†å’Œ Python éå¸¸ç±»ä¼¼ï¼Œä½†æ¥å£ä¸å¤ªä¸€æ ·ï¼Œå°±ä½œä¸ºä»Šå¤©çš„æ€è€ƒé¢˜è®©ä½ å°è¯•ä¸€ä¸‹ã€‚å°æç¤ºï¼šRust å’Œ nodejs é—´äº¤äº’å¯ä»¥ä½¿ç”¨ <a href=\"https://github.com/neon-bindings/neon\">neon</a>ã€‚</p><p>æ¬¢è¿åœ¨ç•™è¨€åŒºåˆ†äº«ä½ çš„æ€è€ƒã€‚ä½ çš„ Rust å­¦ä¹ ç¬¬å…­æ¬¡æ‰“å¡æˆåŠŸï¼Œæˆ‘ä»¬ä¸‹ä¸€è®²è§ï¼</p><h2>å‚è€ƒèµ„æ–™</h2><p>æˆ‘ä»¬çš„ queryer åº“ç›®å‰ä½¿ç”¨åˆ°äº†æ“ä½œç³»ç»Ÿçš„åŠŸèƒ½ï¼Œæ¯”å¦‚æ–‡ä»¶ç³»ç»Ÿï¼Œæ‰€ä»¥å®ƒæ— æ³•è¢«ç¼–è¯‘æˆ WebAssemblyã€‚æœªæ¥å¦‚æœèƒ½ç§»é™¤å¯¹æ“ä½œç³»ç»Ÿçš„ä¾èµ–ï¼Œè¿™ä¸ªä»£ç è¿˜èƒ½è¢«ç¼–è¯‘æˆ WASMï¼Œä¾› Web å‰ç«¯ä½¿ç”¨ã€‚</p><p>å¦‚æœæƒ³åœ¨ iOS/Android ä¸‹ä½¿ç”¨è¿™ä¸ªåº“ï¼Œå¯ä»¥ç”¨ç±»ä¼¼ Python/Node.js çš„æ–¹æ³•åšæ¥å£å°è£…ï¼ŒMozilla æä¾›äº†ä¸€ä¸ª <a href=\"https://github.com/mozilla/uniffi-rs\">uniffi</a> çš„åº“ï¼Œå®ƒè‡ªå·±çš„ Firefox  å„ä¸ªç«¯ä¹Ÿæ˜¯è¿™ä¹ˆå¤„ç†çš„ï¼š</p><p><img src=\"https://static001.geekbang.org/resource/image/ab/f2/ab423b37a2c4b6bc3f5c17ca2c2e1af2.png?wh=3641x2386\" alt=\"\"></p><p>å¯¹äºæ¡Œé¢å¼€å‘ï¼ŒRust ä¸‹æœ‰ä¸€ä¸ªå¾ˆæœ‰æ½œåŠ›çš„å®¢æˆ·ç«¯å¼€å‘å·¥å…· <a href=\"https://github.com/tauri-apps/tauri\">tauri</a>ï¼Œå®ƒå¾ˆæœ‰æœºä¼šå–ä»£å¾ˆå¤šä½¿ç”¨ Electron çš„åœºåˆã€‚</p><p>æˆ‘å†™äº†ä¸€ä¸ªç®€å•çš„ tuari App å« data-viewerï¼Œå¦‚æœä½ æ„Ÿå…´è¶£çš„è¯ï¼Œå¯ä»¥åœ¨ <a href=\"https://github.com/tyrchen/geektime-rust/blob/master/06_queryer/data-viewer\">github repo</a> ä¸‹çš„ data-viewer ç›®å½•ä¸‹çœ‹ tauri ä½¿ç”¨ queryer çš„ä»£ç ï¼Œä¸‹é¢æ˜¯è¿è¡Œåçš„æ•ˆæœã€‚ä¸ºäº†è®©ä»£ç æœ€ç®€å•ï¼Œå‰ç«¯æ²¡æœ‰ç”¨ä»»ä½•æ¡†æ¶ï¼Œå¦‚æœä½ æ˜¯ä¸€åå‰ç«¯å¼€å‘è€…ï¼Œå¯ä»¥ç”¨ Vue æˆ–è€… React åŠ ä¸Šä¸€ä¸ªåˆé€‚çš„ CSS åº“è®©æ•´ä¸ªç•Œé¢å˜å¾—æ›´åŠ å‹å¥½ã€‚<br>\n<img src=\"https://static001.geekbang.org/resource/image/82/e7/826ef4913c54c81f8a5fa25ca92481e7.png?wh=2000x1433\" alt=\"\"></p>","comments":[{"had_liked":false,"id":310386,"user_name":"è‘¡è„","can_delete":false,"product_type":"c1","uid":1018673,"ip_address":"","ucode":"6E8597D1B09807","user_header":"http://thirdwx.qlogo.cn/mmopen/ajNVdqHZLLDoDeeNST87MZEdfT8n7yEWp06KsFCTs2ssFh2tbHu413nibrRObOia1Zn9pqiaHgIicVkSHRZM3LHOEA/132","comment_is_top":true,"comment_ctime":1630636850,"is_pvip":false,"replies":[{"id":"112460","content":"ğŸ‘","user_name":"ä½œè€…å›å¤","comment_id":310386,"uid":"1079375","ip_address":"","utype":1,"ctime":1630651484,"user_name_real":"Tyr"}],"discussion_count":2,"race_medal":0,"score":"9.2233721157948006e+18","product_id":100085301,"comment_content":"è€å¸ˆçš„è¯¾ç¨‹æ¶ˆé™¤äº†å¯¹è§£å†³è¿™ç±»é—®é¢˜(è‡ªå·±å®ç°ä¸€ä¸ªè§£æå™¨çš„æ‰©å±•)çš„ææƒ§ï¼Œæˆ–è€…è¯´ä»¥å‰ä¸€ç›´åœ¨ä½¿ç”¨é«˜çº§å°è£…çš„è¯­è¨€ï¼Œå¯¹è¿™äº›åä½å±‚ä¸€ç‚¹çš„ä¸œè¥¿æ€»æ˜¯ä¸æ•¢è§¦ç¢°ï¼Œä¸€ç‚¹ç‚¹åˆ†æä¸‹æ¥ï¼Œå®Œå…¨æ²¡æœ‰æƒ³è±¡ä¸­çš„é‚£ä¹ˆéš¾ã€‚å“ˆå“ˆï¼Œè¿™å°±æ˜¯get hands dirtyçš„ç²¾è¦å§ã€‚å­¦ä¹ rustå¾ˆå¥½ï¼Œå¬è€å¸ˆè®²è¯¾æ›´å¥½ï¼Œæ„Ÿè°¢è€å¸ˆã€‚","like_count":18,"discussions":[{"author":{"id":1079375,"avatar":"https://static001.geekbang.org/account/avatar/00/10/78/4f/e74f870c.jpg","nickname":"Tyr","note":"","ucode":"EAAFC8063202E0","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":526212,"discussion_content":"ğŸ‘","likes_number":1,"is_delete":false,"is_hidden":false,"ctime":1630651484,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1401568,"avatar":"https://static001.geekbang.org/account/avatar/00/15/62/e0/d2ff52da.jpg","nickname":"è®°äº‹æœ¬","note":"","ucode":"FA942636EE0CC8","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":554264,"discussion_content":"å¥½","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1646291922,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":312901,"user_name":"leesper","can_delete":false,"product_type":"c1","uid":1351104,"ip_address":"","ucode":"CC76320571BECA","user_header":"https://static001.geekbang.org/account/avatar/00/14/9d/c0/cb5341ec.jpg","comment_is_top":true,"comment_ctime":1632110603,"is_pvip":false,"replies":[{"id":"113367","content":"è¯´å¾—éå¸¸å¥½ï¼<br><br>å¯¹äºã€Œæœ‰ç€å¤æ‚ä¸šåŠ¡é€»è¾‘çš„é«˜æ€§èƒ½æœåŠ¡å™¨ã€ï¼Œé™¤äº†ä½ è¯´çš„è¿™äº›ï¼Œè¿˜æœ‰åœ¨å¤„ç†çš„æ•´ä¸ª pipeline ä¸­è¦è€ƒè™‘å¼•å…¥ hook  åšäº‹ä»¶é€šçŸ¥ï¼Œä»¥æ»¡è¶³æ—¥å¿—ï¼Œç›‘æ§ç­‰éœ€æ±‚ã€‚åœ¨ç¬¬ 21 è®²æˆ‘ä»¬è®¨è®º KV server çš„æ—¶å€™ï¼Œä¼šé€æ­¥æŠŠä½ è¯´çš„è¿™äº›ç‚¹éƒ½ä½“ç°åˆ°ã€‚","user_name":"ä½œè€…å›å¤","comment_id":312901,"uid":"1079375","ip_address":"","utype":1,"ctime":1632153991,"user_name_real":"Tyr"}],"discussion_count":1,"race_medal":0,"score":"9.2233721115012997e+18","product_id":100085301,"comment_content":"<br>é™ˆå¤©è€å¸ˆï¼Œå­¦å®Œäº†è¿™èŠ‚è¯¾ç¨‹ï¼Œæˆ‘è§‰å¾—ä½ å’Œé™ˆçš“è€å¸ˆç»™äº†æˆ‘æ–°çš„å¯å‘ã€‚<br><br>åœ¨é™ˆçš“è€å¸ˆçš„ã€Šå·¦è€³å¬é£ã€‹çš„ã€Šç¼–ç¨‹çš„æœ¬è´¨ã€‹ä¸€èŠ‚ï¼Œæåˆ°äº†è¿™ä¹ˆä¸¤ä¸ªå…¬å¼<br><br>ï¼ˆ1ï¼‰ç¨‹åº=ç®—æ³•+æ•°æ®ç»“æ„<br>ï¼ˆ2ï¼‰ç®—æ³•=é€»è¾‘+æ§åˆ¶<br><br>æˆ‘ä»è¿™ä¸¤ä¸ªå…¬å¼ä¸­é¢†æ‚Ÿå‡ºï¼šâ€œç¨‹åº=é€»è¾‘æŠ½è±¡+æ•°æ®ç»“æ„+æ§åˆ¶â€ã€‚æ•°æ®ç»“æ„æ˜¯ä¸šåŠ¡é€»è¾‘çš„é™æ€çš„æè¿°ï¼Œå®ƒç”¨æœ¯è¯­è¡¨ç¤ºæ•°æ®ç»“æ„çš„å®šä¹‰ï¼Œè€Œé€»è¾‘æŠ½è±¡æ˜¯åŠ¨æ€çš„ï¼Œæ˜¯å¯¹ä¸šåŠ¡æµç¨‹çš„æŠ½è±¡ã€‚<br><br>æ‚¨åœ¨è¯¾ç¨‹é‡Œæ‰€è¯´çš„â€œç»å¤§å¤šæ•°å¤„ç†é€»è¾‘éƒ½æ˜¯æŠŠæ•°æ®ä»ä¸€ä¸ªæ¥å£è½¬æ¢æˆå¦ä¸€ä¸ªæ¥å£ã€‚â€ã€â€œå¥½çš„ä»£ç ï¼Œåº”è¯¥æ˜¯æ¯ä¸ªä¸»æµç¨‹éƒ½æ¸…æ™°ç®€çº¦ï¼Œä»£ç æ°åˆ°å¥½å¤„åœ°å‡ºç°åœ¨é‚£é‡Œï¼Œè®©äººä¸éœ€è¦æ³¨é‡Šä¹Ÿèƒ½æ˜ç™½ä½œè€…åœ¨å†™ä»€ä¹ˆâ€<br><br>ä¸é™ˆçš“è€å¸ˆçš„â€œæœ‰æ•ˆåœ°åˆ†ç¦» Logicã€Control å’Œ Data æ˜¯å†™å‡ºå¥½ç¨‹åºçš„å…³é”®æ‰€åœ¨ï¼â€ï¼Œå…¶å®è¡¨è¾¾çš„æ˜¯åŒä¸€ä¸ªæ„æ€ã€‚å†™ä»»ä½•ä»£ç ï¼Œè®¾è®¡å¥½Logicå’ŒDataï¼Œä¸šåŠ¡æµç¨‹å°±ç®—å®Œæˆäº†ï¼ˆåŠŸèƒ½æ€§éœ€æ±‚ï¼‰ï¼Œç„¶ååœ¨è¿™ä¸ªåŸºç¡€ä¸Šä¸æ–­åœ°ä¼˜åŒ–Controlï¼Œå°±èƒ½æé«˜ä»£ç æ€§èƒ½ï¼ˆéåŠŸèƒ½æ€§éœ€æ±‚ï¼‰ã€‚<br><br>ä»¥â€œé«˜æ€§èƒ½ç½‘ç»œç¼–ç¨‹â€ä¸ºä¾‹ï¼Œç½‘ç»œç¼–ç¨‹çš„ä¸šåŠ¡é€»è¾‘æ˜¯â€œå®¢æˆ·æœº-æœåŠ¡å™¨æ¨¡å‹â€ï¼š<br><br>ï¼ˆ1ï¼‰å®¢æˆ·è¿›ç¨‹å‘é€è¯·æ±‚<br>ï¼ˆ2ï¼‰æœåŠ¡è¿›ç¨‹å¤„ç†è¯·æ±‚ï¼ˆå¯èƒ½ä¼šè®¿é—®æŸäº›æœ¬åœ°æˆ–è¿œç¨‹èµ„æºï¼‰<br>ï¼ˆ3ï¼‰æœåŠ¡è¿›ç¨‹å‘é€å“åº”<br>ï¼ˆ4ï¼‰å®¢æˆ·è¿›ç¨‹å¤„ç†å“åº”<br><br>åœ¨è¿™ä¸ªè¿‡ç¨‹ä¸­æ‰€ä½“ç°çš„å°±æ˜¯æ‚¨æ‰€è¯´çš„â€œç»å¤§å¤šæ•°å¤„ç†é€»è¾‘éƒ½æ˜¯æŠŠæ•°æ®ä»ä¸€ä¸ªæ¥å£è½¬æ¢æˆå¦ä¸€ä¸ªæ¥å£â€çš„è¿‡ç¨‹ï¼š<br><br>ï¼ˆ1ï¼‰å®¢æˆ·è¿›ç¨‹ä¸­çš„ä¸šåŠ¡æ•°æ®å˜æˆè¯·æ±‚æ•°æ®åŒ…<br>ï¼ˆ2ï¼‰è¯·æ±‚æ•°æ®åŒ…ç¼–ç æˆå­—èŠ‚æµå‘é€åˆ°ç½‘ç»œä¸Š<br>ï¼ˆ3ï¼‰æœåŠ¡è¿›ç¨‹è·å¾—å­—èŠ‚æµæŠŠå®ƒè§£ç æˆè¯·æ±‚æ•°æ®åŒ…<br>ï¼ˆ4ï¼‰æœåŠ¡è¿›ç¨‹æ ¹æ®è¯·æ±‚æ•°æ®åŒ…è®¿é—®èµ„æºå¾—åˆ°ç»“æœ<br>ï¼ˆ5ï¼‰å®¢æˆ·è¿›ç¨‹æŠŠç»“æœæ•°æ®å˜æˆå“åº”æ•°æ®åŒ…<br>ï¼ˆ6ï¼‰å“åº”æ•°æ®åŒ…ç¼–ç æˆå­—èŠ‚æµå‘é€åˆ°ç½‘ç»œä¸Š<br>ï¼ˆ7ï¼‰å®¢æˆ·è¿›ç¨‹è·å¾—å­—èŠ‚æµæŠŠå®ƒè§£ç æˆå“åº”æ•°æ®åŒ…<br>ï¼ˆ8ï¼‰å®¢æˆ·è¿›ç¨‹å¤„ç†å“åº”æ•°æ®åŒ…<br><br>å¯¹äºä¸€ä¸ªæœ€ç®€å•çš„iterative echo serveræ¥è¯´ï¼Œä¸€æ¬¡æœåŠ¡ä¸€ä¸ªå®¢æˆ·ç«¯ï¼Œå­—èŠ‚ç è§£ç æˆå­—ç¬¦ä¸²ï¼Œä¸šåŠ¡é€»è¾‘å°±æ˜¯æŠŠå®¢æˆ·ç«¯å‘æ¥çš„å†åŸå°ä¸åŠ¨ç¼–ç æˆå­—èŠ‚ç å‘å›å»å°±å¯ä»¥äº†ã€‚<br><br>ç„¶è€Œå¯¹äºä¸€ä¸ªæœ‰ç€å¤æ‚ä¸šåŠ¡é€»è¾‘çš„é«˜æ€§èƒ½æœåŠ¡å™¨æ¥è¯´ï¼Œè¦è€ƒè™‘çš„ç‚¹å°±ä¸ä¸€æ ·äº†ï¼š<br>ï¼ˆ1ï¼‰è¦å®ç°å­—èŠ‚ç å’Œâ€œè‡ªå®šä¹‰æ¶ˆæ¯â€ä¹‹é—´çš„æ¥å›è½¬æ¢ï¼Œå°±è¦è‡ªå®šä¹‰Codecï¼Œç”šè‡³è¦å¼•å…¥protobuffer&#47;flatbufferï¼Œå¹¶å®ç°æ¶ˆæ¯çš„æ³¨å†Œæœºåˆ¶<br>ï¼ˆ2ï¼‰è¦ä¸€æ¬¡æœåŠ¡å¤šä¸ªå®¢æˆ·ç«¯ï¼Œå°±è¦å¼•å…¥epoll&#47;kqueueè¿™æ ·çš„IO multiplexingæœºåˆ¶ï¼Œå®ç°å•ä¸ªçº¿ç¨‹ç›‘å¬å¤šä¸ªsocket fdï¼Œç”šè‡³one-loop-per-threadï¼Œå¹¶åšå¥½ç½‘ç»œè¿æ¥ç®¡ç†ï¼Œå…³é—­æœåŠ¡å™¨çš„æ—¶å€™ä¸èƒ½ç¡¬ç€é™†ï¼Œè¦ä¼˜é›…å…³é—­ï¼šç­‰å¾…æ‰€æœ‰ç½‘ç»œè¿æ¥æ¥æ”¶å¹¶å¤„ç†å®Œæ¶ˆæ¯å†é€€å‡º<br>ï¼ˆ3ï¼‰è¦æé«˜IOæ€§èƒ½ï¼Œå°±è¦å¼•å…¥nonblocking IO<br>ï¼ˆ4ï¼‰è¦é¿å…å¤æ‚ä¸šåŠ¡é€»è¾‘å ç”¨IOçº¿ç¨‹èµ„æºï¼Œå°±è¦å¼•å…¥å·¥ä½œè€…çº¿ç¨‹æ± ï¼ŒæŠŠæœåŠ¡ç«¯å¯¹æ¶ˆæ¯çš„å¤„ç†æ”¾åˆ°å¦ä¸€ä¸ªçº¿ç¨‹ä¸­æ‰§è¡Œï¼Œå¹¶åšå¥½IOçº¿ç¨‹å’Œå·¥ä½œè€…çº¿ç¨‹çš„åŒæ­¥<br>ï¼ˆ5ï¼‰å¦‚æœæœåŠ¡ç«¯è¦è®¿é—®è¿œç¨‹èµ„æºï¼Œå°±è¦å¼•å…¥é…ç½®ï¼Œåœ¨æœåŠ¡å¯åŠ¨æ—¶è£…é…å¥½å„ç§mysqlæˆ–è€…redisçš„handleï¼Œç”šè‡³è‡ªå·±å®ç°ä¸€ä¸ªconnectorè®¿é—®å…¶ä»–çš„æœåŠ¡<br><br>è¿™äº›éƒ½æ˜¯å±äºControlèŒƒç•´è¦è€ƒè™‘çš„ä¸œè¥¿ã€‚Logicå†³å®šäº†ç¨‹åºå¤æ‚åº¦çš„ä¸‹é™ï¼ŒControlå†³å®šäº†ä¸Šé™ã€‚æŠŠLogicå’ŒControlæ··åœ¨ä¸€èµ·ï¼Œå¾€å¾€æ˜¯å†™å‡ºæ¥çš„ä»£ç éš¾ä»¥ç»´æŠ¤çš„åŸå› ã€‚","like_count":18,"discussions":[{"author":{"id":1079375,"avatar":"https://static001.geekbang.org/account/avatar/00/10/78/4f/e74f870c.jpg","nickname":"Tyr","note":"","ucode":"EAAFC8063202E0","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":527153,"discussion_content":"è¯´å¾—éå¸¸å¥½ï¼\n\nå¯¹äºã€Œæœ‰ç€å¤æ‚ä¸šåŠ¡é€»è¾‘çš„é«˜æ€§èƒ½æœåŠ¡å™¨ã€ï¼Œé™¤äº†ä½ è¯´çš„è¿™äº›ï¼Œè¿˜æœ‰åœ¨å¤„ç†çš„æ•´ä¸ª pipeline ä¸­è¦è€ƒè™‘å¼•å…¥ hook  åšäº‹ä»¶é€šçŸ¥ï¼Œä»¥æ»¡è¶³æ—¥å¿—ï¼Œç›‘æ§ç­‰éœ€æ±‚ã€‚åœ¨ç¬¬ 21 è®²æˆ‘ä»¬è®¨è®º KV server çš„æ—¶å€™ï¼Œä¼šé€æ­¥æŠŠä½ è¯´çš„è¿™äº›ç‚¹éƒ½ä½“ç°åˆ°ã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1632153991,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":310368,"user_name":"pedro","can_delete":false,"product_type":"c1","uid":1200704,"ip_address":"","ucode":"F40C839DDFD599","user_header":"https://static001.geekbang.org/account/avatar/00/12/52/40/e57a736e.jpg","comment_is_top":true,"comment_ctime":1630633207,"is_pvip":false,"replies":[{"id":"112458","content":"ğŸ‘ å…¨éƒ½è·Ÿä¸‹æ¥å•¦ã€‚å¯ä»¥è¯•ç€å†™å†™ nodejs çš„æ”¯æŒã€‚å¦‚æœæœ‰ç–‘é—®ï¼Œå¯ä»¥å» github repo é‡Œæ‰¾ç­”æ¡ˆ :)","user_name":"ä½œè€…å›å¤","comment_id":310368,"uid":"1079375","ip_address":"","utype":1,"ctime":1630651035,"user_name_real":"Tyr"}],"discussion_count":1,"race_medal":0,"score":"9.2233720642551992e+18","product_id":100085301,"comment_content":"In [1]:  import queryer_py<br><br>In [2]: sql = queryer_py.example_sql()<br><br>In [3]: print(queryer_py.query(sql, &#39;csv&#39;))<br>name,total_cases,new_cases,total_deaths,new_deaths<br>European Union,36489548.0,84973.0,766627.0,541.0<br>India,32857937.0,47092.0,439529.0,509.0<br>South America,36922209.0,37641.0,1131322.0,1104.0<br>Iran,5025233.0,33170.0,108393.0,599.0<br>Africa,7821187.0,30793.0,196917.0,639.0<br>Brazil,20804215.0,27345.0,581150.0,737.0<br><br>æœ¬å‘¨æœ€éª„å‚²ã€æœ€çˆ½çš„demoï¼š<br><br>```shell<br>$ tree .<br><br>.<br>â”œâ”€â”€ httpie<br>â”‚Â Â  â”œâ”€â”€ src<br>â”‚Â Â  â””â”€â”€ target<br>â”œâ”€â”€ queryer_all<br>â”‚Â Â  â”œâ”€â”€ queryer<br>â”‚Â Â  â”œâ”€â”€ queryer-py<br>â”‚Â Â  â””â”€â”€ target<br>â”œâ”€â”€ scrape_url<br>â”‚Â Â  â”œâ”€â”€ src<br>â”‚Â Â  â””â”€â”€ target<br>â”œâ”€â”€ thumbor<br>â”‚Â Â  â”œâ”€â”€ src<br>â”‚Â Â  â””â”€â”€ target<br>```","like_count":6,"discussions":[{"author":{"id":1079375,"avatar":"https://static001.geekbang.org/account/avatar/00/10/78/4f/e74f870c.jpg","nickname":"Tyr","note":"","ucode":"EAAFC8063202E0","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":526208,"discussion_content":"ğŸ‘ å…¨éƒ½è·Ÿä¸‹æ¥å•¦ã€‚å¯ä»¥è¯•ç€å†™å†™ nodejs çš„æ”¯æŒã€‚å¦‚æœæœ‰ç–‘é—®ï¼Œå¯ä»¥å» github repo é‡Œæ‰¾ç­”æ¡ˆ :)","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1630651035,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":310341,"user_name":"Fenix","can_delete":false,"product_type":"c1","uid":1074098,"ip_address":"","ucode":"AA8C1EECDFD405","user_header":"https://static001.geekbang.org/account/avatar/00/10/63/b2/9223bc53.jpg","comment_is_top":false,"comment_ctime":1630599339,"is_pvip":true,"replies":[{"id":"112440","content":"ğŸ‘ å¸Œæœ›èƒ½å¤Ÿå¸®åˆ°","user_name":"ä½œè€…å›å¤","comment_id":310341,"uid":"1079375","ip_address":"","utype":1,"ctime":1630632139,"user_name_real":"Tyr"}],"discussion_count":1,"race_medal":0,"score":"61760141483","product_id":100085301,"comment_content":"å¤ªèµäº†ï¼Œè¿™ç§æ•™å­¦æ¨¡å¼ï¼Œå¤„ç†é—®é¢˜çš„æ€è·¯å¾ˆæœ‰å¯å‘","like_count":14,"discussions":[{"author":{"id":1079375,"avatar":"https://static001.geekbang.org/account/avatar/00/10/78/4f/e74f870c.jpg","nickname":"Tyr","note":"","ucode":"EAAFC8063202E0","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":526202,"discussion_content":"ğŸ‘ å¸Œæœ›èƒ½å¤Ÿå¸®åˆ°","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1630632139,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":313549,"user_name":"Geek_01c6d8","can_delete":false,"product_type":"c1","uid":2051145,"ip_address":"","ucode":"E93426CB6535A1","user_header":"","comment_is_top":false,"comment_ctime":1632490078,"is_pvip":false,"replies":[{"id":"113748","content":"è°¢è°¢æŠ¬çˆ±ï¼","user_name":"ä½œè€…å›å¤","comment_id":313549,"uid":"1079375","ip_address":"","utype":1,"ctime":1632798987,"user_name_real":"Tyr"}],"discussion_count":1,"race_medal":0,"score":"31697261150","product_id":100085301,"comment_content":"å…¨ç½‘æœ€å¥½çš„rustè¯¾ç¨‹ï¼Œæ²¡æœ‰ä¹‹ä¸€ï¼ï¼ï¼","like_count":8,"discussions":[{"author":{"id":1079375,"avatar":"https://static001.geekbang.org/account/avatar/00/10/78/4f/e74f870c.jpg","nickname":"Tyr","note":"","ucode":"EAAFC8063202E0","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":527387,"discussion_content":"è°¢è°¢æŠ¬çˆ±ï¼","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1632798987,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":310516,"user_name":"bearlu","can_delete":false,"product_type":"c1","uid":1030862,"ip_address":"","ucode":"14F260C8B24E27","user_header":"https://static001.geekbang.org/account/avatar/00/0f/ba/ce/fd45714f.jpg","comment_is_top":false,"comment_ctime":1630716916,"is_pvip":true,"replies":[{"id":"112500","content":"æˆ‘å°±æ˜¯åœ¨éœ€è¦çš„æ—¶å€™æŸ¥é˜…ï¼Œå¹¶ä¸ä¼šç³»ç»Ÿåœ°å»ä¸€ç¯‡ç¯‡è¯»ã€‚å¯¹äºè¦äº†è§£çš„æ•°æ®ç»“æ„ï¼Œæˆ‘ä¼šå»çœ‹å®ƒéƒ½å®ç°äº†å“ªäº› traitã€‚æœªæ¥ä½ ä¼šé€æ¸æ˜ç™½è¿™éå¸¸é‡è¦ã€‚æœ‰æ—¶å€™ç”šè‡³è¢«æ•°æ®ç»“æ„è‡ªå·±æä¾›äº†å“ªäº›åŠŸèƒ½æ›´é‡è¦ã€‚","user_name":"ä½œè€…å›å¤","comment_id":310516,"uid":"1079375","ip_address":"","utype":1,"ctime":1630734309,"user_name_real":"Tyr"}],"discussion_count":1,"race_medal":0,"score":"27400520692","product_id":100085301,"comment_content":"è€å¸ˆå¦‚ä½•æœ‰æ•ˆé˜…è¯»docs.rsï¼Œæˆ‘çœ‹ä½ å¼•å…¥æ¥çš„crateçš„æ–‡æ¡£ï¼Œä½†æ˜¯ä¸çŸ¥é“å¦‚ä½•æœ‰æ•ˆå­¦ä¹ ï¼Ÿ","like_count":6,"discussions":[{"author":{"id":1079375,"avatar":"https://static001.geekbang.org/account/avatar/00/10/78/4f/e74f870c.jpg","nickname":"Tyr","note":"","ucode":"EAAFC8063202E0","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":526259,"discussion_content":"æˆ‘å°±æ˜¯åœ¨éœ€è¦çš„æ—¶å€™æŸ¥é˜…ï¼Œå¹¶ä¸ä¼šç³»ç»Ÿåœ°å»ä¸€ç¯‡ç¯‡è¯»ã€‚å¯¹äºè¦äº†è§£çš„æ•°æ®ç»“æ„ï¼Œæˆ‘ä¼šå»çœ‹å®ƒéƒ½å®ç°äº†å“ªäº› traitã€‚æœªæ¥ä½ ä¼šé€æ¸æ˜ç™½è¿™éå¸¸é‡è¦ã€‚æœ‰æ—¶å€™ç”šè‡³è¢«æ•°æ®ç»“æ„è‡ªå·±æä¾›äº†å“ªäº›åŠŸèƒ½æ›´é‡è¦ã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1630734309,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":311435,"user_name":"Colt","can_delete":false,"product_type":"c1","uid":1117983,"ip_address":"","ucode":"7BDB5F469E325D","user_header":"https://static001.geekbang.org/account/avatar/00/11/0f/1f/e894ae27.jpg","comment_is_top":false,"comment_ctime":1631237631,"is_pvip":false,"replies":[{"id":"112857","content":"è°¢è°¢èµèµï¼","user_name":"ä½œè€…å›å¤","comment_id":311435,"uid":"1079375","ip_address":"","utype":1,"ctime":1631242091,"user_name_real":"Tyr"}],"discussion_count":1,"race_medal":0,"score":"23106074111","product_id":100085301,"comment_content":"è€å¸ˆçš„æ€è·¯éå¸¸æ­£ï¼Œè¿™å‡ æ¬¡å®è·µè¯¾å¯ä»¥çœ‹å‡ºRUSTçš„é­…åŠ›å’Œä¼˜é›…ï¼Œèƒ½åŠ›æœ‰é™éœ€è¦å¤šå“å‡ æ¬¡","like_count":5,"discussions":[{"author":{"id":1079375,"avatar":"https://static001.geekbang.org/account/avatar/00/10/78/4f/e74f870c.jpg","nickname":"Tyr","note":"","ucode":"EAAFC8063202E0","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":526601,"discussion_content":"è°¢è°¢èµèµï¼","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1631242091,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":310407,"user_name":"è€è€","can_delete":false,"product_type":"c1","uid":1214893,"ip_address":"","ucode":"C32E743518DECD","user_header":"https://static001.geekbang.org/account/avatar/00/12/89/ad/4efd929a.jpg","comment_is_top":false,"comment_ctime":1630643863,"is_pvip":true,"replies":[{"id":"112465","content":"è°¢è°¢ï¼è¿™å‘¨å…ˆç»™å¤§å®¶çœ‹çœ‹ Rust èƒ½åšä»€ä¹ˆï¼Œæ€ä¹ˆåšã€‚ä¸‹å‘¨èµ·å°±è¦ä»å †å’Œæ ˆçš„å…³ç³»å…¥æ‰‹è®²æ‰€æœ‰æƒå•¦ã€‚","user_name":"ä½œè€…å›å¤","comment_id":310407,"uid":"1079375","ip_address":"","utype":1,"ctime":1630651670,"user_name_real":"Tyr"}],"discussion_count":1,"race_medal":0,"score":"23105480343","product_id":100085301,"comment_content":"å¤ªå¼ºäº†ï¼è¿™ç§å®æˆ˜æ€§è´¨çš„æ•™å­¦æ­£æ˜¯å¤§å®¶éƒ½éœ€è¦çš„ï¼ä¸æ˜¯é‚£ç§é‡å¤å•°å—¦è¯­æ³•ç»†èŠ‚çš„çƒ‚è¯¾ç¨‹","like_count":5,"discussions":[{"author":{"id":1079375,"avatar":"https://static001.geekbang.org/account/avatar/00/10/78/4f/e74f870c.jpg","nickname":"Tyr","note":"","ucode":"EAAFC8063202E0","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":526225,"discussion_content":"è°¢è°¢ï¼è¿™å‘¨å…ˆç»™å¤§å®¶çœ‹çœ‹ Rust èƒ½åšä»€ä¹ˆï¼Œæ€ä¹ˆåšã€‚ä¸‹å‘¨èµ·å°±è¦ä»å †å’Œæ ˆçš„å…³ç³»å…¥æ‰‹è®²æ‰€æœ‰æƒå•¦ã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1630651670,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":310360,"user_name":"æ‹‰æ–¯ç‰¹","can_delete":false,"product_type":"c1","uid":2738694,"ip_address":"","ucode":"1E69B8052C1F59","user_header":"https://static001.geekbang.org/account/avatar/00/29/ca/06/a110cc63.jpg","comment_is_top":false,"comment_ctime":1630631617,"is_pvip":false,"replies":[{"id":"112441","content":"è°¢è°¢å¤¸å¥–ï¼å¸Œæœ›èƒ½å¤Ÿå¸®åˆ°ã€‚","user_name":"ä½œè€…å›å¤","comment_id":310360,"uid":"1079375","ip_address":"","utype":1,"ctime":1630632158,"user_name_real":"Tyr"}],"discussion_count":1,"race_medal":0,"score":"18810500801","product_id":100085301,"comment_content":"é€šè¿‡ä¸€ä¸ªå®é™…æ¡ˆä¾‹å±•ç°äº†rustçš„ç‰¹æ€§ï¼Œè®¾è®¡æ¨¡å¼çš„ä½¿ç”¨ï¼Œå†³è§£é—®é¢˜çš„æ€è·¯å’Œè®¾è®¡è¿‡ç¨‹ã€‚ç®€ç›´ä¸è¦å¤ªæ£’ï½","like_count":5,"discussions":[{"author":{"id":1079375,"avatar":"https://static001.geekbang.org/account/avatar/00/10/78/4f/e74f870c.jpg","nickname":"Tyr","note":"","ucode":"EAAFC8063202E0","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":526207,"discussion_content":"è°¢è°¢å¤¸å¥–ï¼å¸Œæœ›èƒ½å¤Ÿå¸®åˆ°ã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1630632158,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":336756,"user_name":"è¾£ä¹ˆå¤§","can_delete":false,"product_type":"c1","uid":1396951,"ip_address":"","ucode":"AB308B6DCA0108","user_header":"https://static001.geekbang.org/account/avatar/00/15/50/d7/f82ed283.jpg","comment_is_top":false,"comment_ctime":1646355692,"is_pvip":true,"discussion_count":0,"race_medal":0,"score":"14531257580","product_id":100085301,"comment_content":"æ€»ç®—ç£•ç£•ç»Šç»ŠæŠŠè¿™èŠ‚è·Ÿä¸‹æ¥äº†ï¼Œè¿˜æ²¡åŠé€€ï¼<br><br>ä¸€ä¸ªå°é—®é¢˜çš„è§£å†³æ–¹æ¡ˆï¼š<br>æç¤ºdns error<br>PanicException: called `Result::unwrap()` on an `Err` value: error sending request for url (https:&#47;&#47;raw.githubusercontent.com&#47;owid&#47;covid-19-data&#47;master&#47;public&#47;data&#47;latest&#47;owid-covid-latest.csv): error trying to connect: dns error: è¯·æ±‚çš„åç§°æœ‰æ•ˆï¼Œä½†æ˜¯æ‰¾ä¸åˆ°è¯·æ±‚çš„ç±»å‹çš„æ•°æ®ã€‚ (os error 11004)<br><br>Caused by:<br>    0: error trying to connect: dns error: è¯·æ±‚çš„åç§°æœ‰æ•ˆï¼Œä½†æ˜¯æ‰¾ä¸åˆ°è¯·æ±‚çš„ç±»å‹çš„æ•°æ®ã€‚ (os error 11004)<br>    1: dns error: è¯·æ±‚çš„åç§°æœ‰æ•ˆï¼Œä½†æ˜¯æ‰¾ä¸åˆ°è¯·æ±‚çš„ç±»å‹çš„æ•°æ®ã€‚ (os error 11004)<br>    2: è¯·æ±‚çš„åç§°æœ‰æ•ˆï¼Œä½†æ˜¯æ‰¾ä¸åˆ°è¯·æ±‚çš„ç±»å‹çš„æ•°æ®ã€‚ (os error 11004)<br><br>windowsè§£å†³æ–¹æ¡ˆï¼š<br>1ã€æŸ¥æ‰¾ ip https:&#47;&#47;ipaddress.com&#47;website&#47;raw.githubusercontent.com<br>2ã€ä¿®æ”¹hosts ï¼ŒC:\\Windows\\System32\\drivers\\etc<br>æ–°å¢ å¦‚185.199.109.133 raw.githubusercontent.com çš„ipåœ°å€ï¼Œä¿å­˜<br>","like_count":3},{"had_liked":false,"id":310642,"user_name":"ç„æ¾ˆ","can_delete":false,"product_type":"c1","uid":2675290,"ip_address":"","ucode":"268FA9DFCD3E18","user_header":"https://static001.geekbang.org/account/avatar/00/28/d2/5a/63af190e.jpg","comment_is_top":false,"comment_ctime":1630816200,"is_pvip":false,"replies":[{"id":"112559","content":"é¦–å…ˆ deref çš„ç”¨é€”ä¸æ˜¯æ¨¡æ‹Ÿç»§æ‰¿ã€‚å®ƒæœ€æ ¹æºçš„éœ€æ±‚æ˜¯ä¸ºåªèƒ½æŒ‡é’ˆæä¾›å¯¹å†…éƒ¨æ•°æ®çš„æ–¹ä¾¿çš„è®¿é—®ï¼šhttps:&#47;&#47;doc.rust-lang.org&#47;std&#47;ops&#47;trait.Deref.htmlã€‚å½“ä½ éœ€è¦ä½ çš„æ•°æ®ç»“æ„åœ¨ä½¿ç”¨æ—¶ç”¨èµ·æ¥å¯ä»¥æ„Ÿè§‰å’Œå†…éƒ¨çš„æ•°æ®ç±»ä¼¼æ—¶ï¼Œå¯ä»¥ä½¿ç”¨ Deref traitã€‚æ¯”å¦‚æˆ‘å¯ä»¥æ„å»ºä¸€ä¸ª Memmap  ç»“æ„ï¼ŒæŠŠæ–‡ä»¶ mmap åˆ°å†…å­˜ä¸­ï¼Œä½†å¦‚æœæˆ‘æä¾›ä¸€ç³»åˆ—é¢å¤–çš„æ¥å£ï¼Œä¼šè®©ä½¿ç”¨è€…å¾ˆä¸æ–¹ä¾¿ï¼Œä½†æˆ‘æŠŠå®ƒ deref åˆ° &amp;[u8]ï¼Œè®©ç”¨æˆ·æ“ä½œèµ·æ¥åƒä¸€ä¸ªå†…å­˜ bufferï¼Œç”¨èµ·æ¥å°±å¾ˆèˆ’æœã€‚å½“ç„¶ï¼Œæ»¥ç”¨å®ƒä¼šç»™ä½¿ç”¨è€…å¸¦æ¥ä¸€äº›å›°æƒ‘ï¼Œæ‰€ä»¥æ ‡å‡†æ–‡æ¡£å»ºè®®åªæœ‰åœ¨æ„å»ºæ™ºèƒ½æŒ‡é’ˆæ—¶ä½¿ç”¨ã€‚<br><br>æˆ‘çš„å»ºè®®ï¼š<br>1. ç®€å•çš„æ•°æ®ç»“æ„çš„å°è£…ã€‚åƒæˆ‘ DataSet çš„ä½¿ç”¨é‚£æ ·ã€‚<br>2. æ™ºèƒ½æŒ‡é’ˆã€‚æ¯”å¦‚ä½ è¦å®ç°ä¸€ä¸ª SmartStringï¼Œåœ¨ &lt; 24 å­—èŠ‚æ—¶ä½¿ç”¨æ ˆä¸Šçš„å†…å­˜ï¼Œæ›´å¤§çš„å­—ç¬¦ä¸²æ‰ä½¿ç”¨ Stringã€‚è¿™æ ·çš„åœºåˆï¼Œå¦‚æœä¸ç”¨ Derefï¼Œä½¿ç”¨èµ·æ¥ä¼šéå¸¸ä¸å‹å¥½ã€‚","user_name":"ä½œè€…å›å¤","comment_id":310642,"uid":"1079375","ip_address":"","utype":1,"ctime":1630861515,"user_name_real":"Tyr"}],"discussion_count":1,"race_medal":0,"score":"14515718088","product_id":100085301,"comment_content":"è€å¸ˆä½ å¥½ï¼Œæœ‰è§‚ç‚¹è®¤ä¸ºç”¨ Deref æ¨¡æ‹Ÿç»§æ‰¿é€šå¸¸ä¸æ˜¯å¥½çš„åšæ³•ã€‚ä¾‹å¦‚ï¼šhttps:&#47;&#47;www.zhihu.com&#47;question&#47;36488041<br>https:&#47;&#47;rust-unofficial.github.io&#47;patterns&#47;anti_patterns&#47;deref.html<br>æœ‰å¥½å¤„ä¹Ÿæœ‰åå¤„ï¼Œæˆ‘ä»¬è¯¥å¦‚ä½•æƒè¡¡ä»¥è‡³äºé˜²æ­¢æ»¥ç”¨å‘¢ã€‚","like_count":4,"discussions":[{"author":{"id":1079375,"avatar":"https://static001.geekbang.org/account/avatar/00/10/78/4f/e74f870c.jpg","nickname":"Tyr","note":"","ucode":"EAAFC8063202E0","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":526297,"discussion_content":"é¦–å…ˆ deref çš„ç”¨é€”ä¸æ˜¯æ¨¡æ‹Ÿç»§æ‰¿ã€‚å®ƒæœ€æ ¹æºçš„éœ€æ±‚æ˜¯ä¸ºåªèƒ½æŒ‡é’ˆæä¾›å¯¹å†…éƒ¨æ•°æ®çš„æ–¹ä¾¿çš„è®¿é—®ï¼šhttps://doc.rust-lang.org/std/ops/trait.Deref.htmlã€‚å½“ä½ éœ€è¦ä½ çš„æ•°æ®ç»“æ„åœ¨ä½¿ç”¨æ—¶ç”¨èµ·æ¥å¯ä»¥æ„Ÿè§‰å’Œå†…éƒ¨çš„æ•°æ®ç±»ä¼¼æ—¶ï¼Œå¯ä»¥ä½¿ç”¨ Deref traitã€‚æ¯”å¦‚æˆ‘å¯ä»¥æ„å»ºä¸€ä¸ª Memmap  ç»“æ„ï¼ŒæŠŠæ–‡ä»¶ mmap åˆ°å†…å­˜ä¸­ï¼Œä½†å¦‚æœæˆ‘æä¾›ä¸€ç³»åˆ—é¢å¤–çš„æ¥å£ï¼Œä¼šè®©ä½¿ç”¨è€…å¾ˆä¸æ–¹ä¾¿ï¼Œä½†æˆ‘æŠŠå®ƒ deref åˆ° &amp;amp;[u8]ï¼Œè®©ç”¨æˆ·æ“ä½œèµ·æ¥åƒä¸€ä¸ªå†…å­˜ bufferï¼Œç”¨èµ·æ¥å°±å¾ˆèˆ’æœã€‚å½“ç„¶ï¼Œæ»¥ç”¨å®ƒä¼šç»™ä½¿ç”¨è€…å¸¦æ¥ä¸€äº›å›°æƒ‘ï¼Œæ‰€ä»¥æ ‡å‡†æ–‡æ¡£å»ºè®®åªæœ‰åœ¨æ„å»ºæ™ºèƒ½æŒ‡é’ˆæ—¶ä½¿ç”¨ã€‚\n\næˆ‘çš„å»ºè®®ï¼š\n1. ç®€å•çš„æ•°æ®ç»“æ„çš„å°è£…ã€‚åƒæˆ‘ DataSet çš„ä½¿ç”¨é‚£æ ·ã€‚\n2. æ™ºèƒ½æŒ‡é’ˆã€‚æ¯”å¦‚ä½ è¦å®ç°ä¸€ä¸ª SmartStringï¼Œåœ¨ &amp;lt; 24 å­—èŠ‚æ—¶ä½¿ç”¨æ ˆä¸Šçš„å†…å­˜ï¼Œæ›´å¤§çš„å­—ç¬¦ä¸²æ‰ä½¿ç”¨ Stringã€‚è¿™æ ·çš„åœºåˆï¼Œå¦‚æœä¸ç”¨ Derefï¼Œä½¿ç”¨èµ·æ¥ä¼šéå¸¸ä¸å‹å¥½ã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1630861515,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":310483,"user_name":"pedro","can_delete":false,"product_type":"c1","uid":1200704,"ip_address":"","ucode":"F40C839DDFD599","user_header":"https://static001.geekbang.org/account/avatar/00/12/52/40/e57a736e.jpg","comment_is_top":false,"comment_ctime":1630673759,"is_pvip":false,"replies":[{"id":"112485","content":"éå¸¸æ£’ï¼","user_name":"ä½œè€…å›å¤","comment_id":310483,"uid":"1079375","ip_address":"","utype":1,"ctime":1630686963,"user_name_real":"Tyr"}],"discussion_count":1,"race_medal":0,"score":"14515575647","product_id":100085301,"comment_content":"Node æ¥äº†ï¼š<br><br>```js<br>node <br>Welcome to Node.js v14.17.5.<br>Type &quot;.help&quot; for more information.<br>&gt; const rs = require(&#39;.&#39;)<br>undefined<br>&gt; rs.example_sql()<br>&#39;SELECT location name, total_cases, new_cases, total_deaths, new_deaths FROM https:&#47;&#47;raw.githubusercontent.com&#47;owid&#47;covid-19-data&#47;master&#47;public&#47;data&#47;latest&#47;owid-covid-latest.csv where new_deaths &gt;= 500 ORDER BY new_cases DESC LIMIT 6 OFFSET 5&#39;<br>```<br><br>çˆ½ï½","like_count":3,"discussions":[{"author":{"id":1079375,"avatar":"https://static001.geekbang.org/account/avatar/00/10/78/4f/e74f870c.jpg","nickname":"Tyr","note":"","ucode":"EAAFC8063202E0","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":526247,"discussion_content":"éå¸¸æ£’ï¼","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1630686963,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":310395,"user_name":"èŒ¶åº•","can_delete":false,"product_type":"c1","uid":1188926,"ip_address":"","ucode":"687DD3686A84D2","user_header":"https://static001.geekbang.org/account/avatar/00/12/24/3e/692a93f7.jpg","comment_is_top":false,"comment_ctime":1630639096,"is_pvip":false,"replies":[{"id":"112455","content":"å¤ªæ¿€åŠ¨äº†ï¼Œæ‰€ä»¥7ä¸ªå­—é‡Œæ‰‹è¯¯äº†2ä¸ªå—ğŸ˜‚","user_name":"ç¼–è¾‘å›å¤","comment_id":310395,"uid":"2547771","ip_address":"","utype":2,"ctime":1630645602,"user_name_real":"å¶å¦‚èŠŠ"}],"discussion_count":1,"race_medal":0,"score":"14515540984","product_id":100085301,"comment_content":"ä»Šå¤©è¿™ä¸ªé›€é£Ÿå¸…","like_count":3,"discussions":[{"author":{"id":2547771,"avatar":"https://static001.geekbang.org/account/avatar/00/26/e0/3b/8ec916b2.jpg","nickname":"å¤šå°‘","note":"","ucode":"0A6EF7AA6E4BB7","race_medal":0,"user_type":4,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":526216,"discussion_content":"å¤ªæ¿€åŠ¨äº†ï¼Œæ‰€ä»¥7ä¸ªå­—é‡Œæ‰‹è¯¯äº†2ä¸ªå—ğŸ˜‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1630645602,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":4}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":336487,"user_name":"è¾£ä¹ˆå¤§","can_delete":false,"product_type":"c1","uid":1396951,"ip_address":"","ucode":"AB308B6DCA0108","user_header":"https://static001.geekbang.org/account/avatar/00/15/50/d7/f82ed283.jpg","comment_is_top":false,"comment_ctime":1646185133,"is_pvip":true,"discussion_count":0,"race_medal":0,"score":"10236119725","product_id":100085301,"comment_content":"è€å¸ˆï¼Œè¯·æ•™ä¸€ä¸ªé—®é¢˜ï¼Œä»£ç ä¸­ä¸‹è½½githubä¸­çš„covid-19 dataçš„csvï¼Œåœ¨æˆ‘çš„macproä¸Šè¿è¡ŒæŠ¥é”™ï¼Œæç¤ºoserror 61,connection refusedï¼ŒåŒæ ·çš„ä»£ç åœ¨windowsä¸Šè¿è¡Œæ˜¯okçš„ï¼Œè¯·é—®æƒ³åœ¨macä¸Šè¿è¡Œè¯¥å¦‚ä½•æ’æŸ¥è¿™ä¸ªé”™è¯¯å‘¢ï¼Ÿ","like_count":2},{"had_liked":false,"id":323456,"user_name":"æ–½æ³°åš","can_delete":false,"product_type":"c1","uid":2718966,"ip_address":"","ucode":"E88E4E737398EF","user_header":"https://static001.geekbang.org/account/avatar/00/29/7c/f6/028f80a8.jpg","comment_is_top":false,"comment_ctime":1637911207,"is_pvip":false,"replies":[{"id":"118887","content":"broken pipe ä¸€èˆ¬æ˜¯æœåŠ¡ç«¯å…³é—­è€Œå®¢æˆ·ç«¯è¿˜åœ¨ç»§ç»­å‘é€æ•°æ®ï¼Œå¯ä»¥çœ‹çœ‹ä½ çš„å®¢æˆ·ç«¯æ˜¯å¦å¤šä¸ª request ä¹‹é—´é—´éš”æ—¶é—´å¤ªä¹…è€Œæ²¡æœ‰ keep-aliveã€‚å¦‚æœæ²¡æœ‰çº¿ç´¢ï¼Œå¯ä»¥æŠ“åŒ…çœ‹çœ‹ï¼Œæ˜¯ä¸æ˜¯åœ¨å¤šä¸ª reqest é—´æ”¶åˆ°äº† FIN&#47;RSTã€‚","user_name":"ä½œè€…å›å¤","comment_id":323456,"uid":"1079375","ip_address":"","utype":1,"ctime":1639850524,"user_name_real":"ç¼–è¾‘"}],"discussion_count":1,"race_medal":0,"score":"10227845799","product_id":100085301,"comment_content":"reqwest è¯·æ±‚ï¼Œbroken pipeæ€ä¹ˆç ´ï¼Ÿ","like_count":2,"discussions":[{"author":{"id":1079375,"avatar":"https://static001.geekbang.org/account/avatar/00/10/78/4f/e74f870c.jpg","nickname":"Tyr","note":"","ucode":"EAAFC8063202E0","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":539848,"discussion_content":"broken pipe ä¸€èˆ¬æ˜¯æœåŠ¡ç«¯å…³é—­è€Œå®¢æˆ·ç«¯è¿˜åœ¨ç»§ç»­å‘é€æ•°æ®ï¼Œå¯ä»¥çœ‹çœ‹ä½ çš„å®¢æˆ·ç«¯æ˜¯å¦å¤šä¸ª request ä¹‹é—´é—´éš”æ—¶é—´å¤ªä¹…è€Œæ²¡æœ‰ keep-aliveã€‚å¦‚æœæ²¡æœ‰çº¿ç´¢ï¼Œå¯ä»¥æŠ“åŒ…çœ‹çœ‹ï¼Œæ˜¯ä¸æ˜¯åœ¨å¤šä¸ª reqest é—´æ”¶åˆ°äº† FIN/RSTã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1639850524,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":315755,"user_name":"null","can_delete":false,"product_type":"c1","uid":1374135,"ip_address":"","ucode":"A6E989C8B0BC39","user_header":"https://static001.geekbang.org/account/avatar/00/14/f7/b7/4097aa22.jpg","comment_is_top":false,"comment_ctime":1633964169,"is_pvip":false,"replies":[{"id":"115291","content":":) ","user_name":"ä½œè€…å›å¤","comment_id":315755,"uid":"1079375","ip_address":"","utype":1,"ctime":1635132920,"user_name_real":"Tyr"}],"discussion_count":1,"race_medal":0,"score":"10223898761","product_id":100085301,"comment_content":"ç†è®ºæ—¶é•¿ï¼š24:58ï¼Œå®é™…æ—¶å¸¸ï¼š24å°æ—¶","like_count":2,"discussions":[{"author":{"id":1079375,"avatar":"https://static001.geekbang.org/account/avatar/00/10/78/4f/e74f870c.jpg","nickname":"Tyr","note":"","ucode":"EAAFC8063202E0","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":528160,"discussion_content":":) ","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1635132920,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":311487,"user_name":"å…´å°ç‹¸","can_delete":false,"product_type":"c1","uid":1140825,"ip_address":"","ucode":"8A1CDD3F0A59C0","user_header":"","comment_is_top":false,"comment_ctime":1631254033,"is_pvip":false,"replies":[{"id":"112864","content":"åˆ«ç€æ€¥ï¼Œçœ‹ä¸æ‡‚æ˜¯æ­£å¸¸çš„ã€‚ä½“ä¼šä¸€ä¸‹å†™æ³•ï¼ŒçŸ¥é“è¿™æ®µä»£ç åœ¨å¹²å•¥å°±è¡Œã€‚å…ˆæŠŠå­¦ä¹ çš„å…´è¶£æèµ·æ¥ï¼Œæ‰èƒ½æ’‘ä½åé¢ç»†è‡´ï¼ˆæ¯ç‡¥ï¼‰çš„è¯­æ³•å­¦ä¹ ã€‚è¦æ˜¯å®åœ¨å¿ƒé‡Œæ…Œï¼Œä½ ä¹Ÿå¯ä»¥é…ç€ä¸­æ–‡çš„æ–‡æ¡£åŒæ­¥å­¦ï¼Œæ”’æ”’åŸºç¡€è¯­æ³•çŸ¥è¯†ã€‚","user_name":"ç¼–è¾‘å›å¤","comment_id":311487,"uid":"2547771","ip_address":"","utype":2,"ctime":1631254523,"user_name_real":"å¶å¦‚èŠŠ"}],"discussion_count":1,"race_medal":0,"score":"10221188625","product_id":100085301,"comment_content":"è¯´å®è¯ï¼Œè¶Šæ•²è¶Šæ…Œï¼Œæˆ‘å®Œå…¨ä¸çŸ¥é“åœ¨åšå•¥å­~","like_count":2,"discussions":[{"author":{"id":2547771,"avatar":"https://static001.geekbang.org/account/avatar/00/26/e0/3b/8ec916b2.jpg","nickname":"å¤šå°‘","note":"","ucode":"0A6EF7AA6E4BB7","race_medal":0,"user_type":4,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":526631,"discussion_content":"åˆ«ç€æ€¥ï¼Œçœ‹ä¸æ‡‚æ˜¯æ­£å¸¸çš„ã€‚ä½“ä¼šä¸€ä¸‹å†™æ³•ï¼ŒçŸ¥é“è¿™æ®µä»£ç åœ¨å¹²å•¥å°±è¡Œã€‚å…ˆæŠŠå­¦ä¹ çš„å…´è¶£æèµ·æ¥ï¼Œæ‰èƒ½æ’‘ä½åé¢ç»†è‡´ï¼ˆæ¯ç‡¥ï¼‰çš„è¯­æ³•å­¦ä¹ ã€‚è¦æ˜¯å®åœ¨å¿ƒé‡Œæ…Œï¼Œä½ ä¹Ÿå¯ä»¥é…ç€ä¸­æ–‡çš„æ–‡æ¡£åŒæ­¥å­¦ï¼Œæ”’æ”’åŸºç¡€è¯­æ³•çŸ¥è¯†ã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1631254523,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":4}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":311202,"user_name":"noisyes","can_delete":false,"product_type":"c1","uid":2538540,"ip_address":"","ucode":"94EC310B284AD2","user_header":"https://static001.geekbang.org/account/avatar/00/26/bc/2c/963688bb.jpg","comment_is_top":false,"comment_ctime":1631103687,"is_pvip":false,"replies":[{"id":"112789","content":"åé¢è¿˜ä¼šæœ‰æ›´ç‰›é€¼çš„ :)","user_name":"ä½œè€…å›å¤","comment_id":311202,"uid":"1079375","ip_address":"","utype":1,"ctime":1631150455,"user_name_real":"Tyr"}],"discussion_count":1,"race_medal":0,"score":"10221038279","product_id":100085301,"comment_content":"æˆ‘åªèƒ½è¯´ç‰›é€¼","like_count":2,"discussions":[{"author":{"id":1079375,"avatar":"https://static001.geekbang.org/account/avatar/00/10/78/4f/e74f870c.jpg","nickname":"Tyr","note":"","ucode":"EAAFC8063202E0","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":526520,"discussion_content":"åé¢è¿˜ä¼šæœ‰æ›´ç‰›é€¼çš„ :)","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1631150455,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":338762,"user_name":"TimJuly","can_delete":false,"product_type":"c1","uid":1065064,"ip_address":"","ucode":"56FE7BF7447DEA","user_header":"https://thirdwx.qlogo.cn/mmopen/vi_32/DYAIOgq83eooNCNEO0vhRiagdrCnNW2LWzzV4g5tXJ9KkTu9hegCTx6lBrA06AZ3Uylb2wdKjvtrmZUWkKKHTGA/132","comment_is_top":false,"comment_ctime":1647704056,"is_pvip":true,"discussion_count":0,"race_medal":0,"score":"5942671352","product_id":100085301,"comment_content":"ä¸–ç•Œä¸Šæœ€å¥½çš„è¯­è¨€åµŒå…¥ rustï¼š<br>php -dextension=.&#47;target&#47;debug&#47;libqueryer.dylib test.php<br>Ok(DataSet(shape: (3, 5)<br>+-----------------------+-------------+-----------+--------------+------------+<br>| name                  | total_cases | new_cases | total_deaths | new_deaths |<br>| ---                   | ---         | ---       | ---          | ---        |<br>| str                   | f64         | f64       | f64          | f64        |<br>+=======================+=============+===========+==============+============+<br>| &quot;Lower middle income&quot; | 8.6854748e7 | 2.14076e5 | 1.290687e6   | 581        |<br>+-----------------------+-------------+-----------+--------------+------------+<br>| &quot;Upper middle income&quot; | 1.2277862e8 | 2.01718e5 | 2.473506e6   | 1539       |<br>+-----------------------+-------------+-----------+--------------+------------+<br>| &quot;South America&quot;       | 5.5508796e7 | 8.6086e4  | 1.270783e6   | 689        |<br>+-----------------------+-------------+-----------+--------------+------------+<br>))","like_count":1},{"had_liked":false,"id":331576,"user_name":"no-one","can_delete":false,"product_type":"c1","uid":1476425,"ip_address":"","ucode":"43D4C5450AAC83","user_header":"https://static001.geekbang.org/account/avatar/00/16/87/49/1796143f.jpg","comment_is_top":false,"comment_ctime":1642660890,"is_pvip":false,"discussion_count":1,"race_medal":0,"score":"5937628186","product_id":100085301,"comment_content":"æ•°æ®é›†ä¸èƒ½ç”¨ï¼Œæœ‰æ²¡æœ‰ä»€ä¹ˆåŠæ³•è§£å†³ï¼Œæ— æ³•ç›´æ¥è®¿é—®raw.githubusercontents.comï¼Œæˆ‘é…ç½®https:&#47;&#47;raw.staticdn.net&#47;owid&#47;covid-19-data&#47;master&#47;public&#47;data&#47;latest&#47;owid-covid-latest.csv ä½†æ˜¯è¿˜æ˜¯æŠ¥é”™<br><br>Error: error sending request for url (https:&#47;&#47;raw.githubusercontents.com&#47;owid&#47;covid-19-data&#47;master&#47;public&#47;data&#47;latest&#47;owid-covid-latest.csv): connection error: broken pipe<br><br>Caused by:<br>    0: connection error: broken pipe<br>    1: broken pipe","like_count":1,"discussions":[{"author":{"id":2991652,"avatar":"https://static001.geekbang.org/account/avatar/00/2d/a6/24/961129f1.jpg","nickname":"forever è’™","note":"","ucode":"472EB8946A3F96","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":575571,"discussion_content":"åŒæ ·æ•°æ®é›†ä¸èƒ½ç”¨\n","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1654936613,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":330037,"user_name":"æ²ä½‘","can_delete":false,"product_type":"c1","uid":2372564,"ip_address":"","ucode":"2643B3CB341906","user_header":"https://static001.geekbang.org/account/avatar/00/24/33/d4/02774d66.jpg","comment_is_top":false,"comment_ctime":1641745833,"is_pvip":false,"replies":[{"id":"120702","content":"ğŸ‘","user_name":"ä½œè€…å›å¤","user_name_real":"ç¼–è¾‘","uid":"1079375","ctime":1642293595,"ip_address":"","comment_id":330037,"utype":1}],"discussion_count":2,"race_medal":0,"score":"5936713129","product_id":100085301,"comment_content":"å¦‚æœå¼•å…¥pyo3é‡åˆ°è¿™ä¸ªé—®é¢˜ï¼šunresolved macro `proc_macro_call!`<br>è¯·å‚è€ƒï¼šhttps:&#47;&#47;github.com&#47;rust-analyzer&#47;rust-analyzer&#47;issues&#47;6835","like_count":1,"discussions":[{"author":{"id":1079375,"avatar":"https://static001.geekbang.org/account/avatar/00/10/78/4f/e74f870c.jpg","nickname":"Tyr","note":"","ucode":"EAAFC8063202E0","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":546311,"discussion_content":"ğŸ‘","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1642293596,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1080653,"avatar":"https://static001.geekbang.org/account/avatar/00/10/7d/4d/d98865b2.jpg","nickname":"è€å®äººHoney","note":"","ucode":"EA4AB5C0C33090","race_medal":0,"user_type":1,"is_pvip":true},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":545962,"discussion_content":"å…³æ‰é”™è¯¯æç¤ºï¼Ÿ","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1642093185,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":311496,"user_name":"å…´å°ç‹¸","can_delete":false,"product_type":"c1","uid":1140825,"ip_address":"","ucode":"8A1CDD3F0A59C0","user_header":"","comment_is_top":false,"comment_ctime":1631257018,"is_pvip":false,"replies":[{"id":"112878","content":"ä½ å¯ä»¥çœ‹åˆ°ï¼Œæˆ‘å¯¹å¤–éƒ¨åŒ…çš„æ•°æ®ç»“æ„åšäº†ä¸€å±‚å°è£…ï¼Œä»å†…å­˜å¸ƒå±€çš„è§’åº¦ï¼Œè¿™å°è£…æ˜¯ä¸å­˜åœ¨çš„ï¼Œä»ç±»å‹ç³»ç»Ÿçš„è§’åº¦ï¼Œè¿™å±‚å°è£…å¯ä»¥è®©æˆ‘ä¸ºã€Œæˆ‘çš„ç±»å‹ã€å®ç° From traitã€‚","user_name":"ä½œè€…å›å¤","user_name_real":"Tyr","uid":"1079375","ctime":1631284418,"ip_address":"","comment_id":311496,"utype":1}],"discussion_count":1,"race_medal":0,"score":"5926224314","product_id":100085301,"comment_content":"&#47;&#47;&#47; æŠŠ SqlParser çš„ SelectItem è½¬æ¢æˆ DataFrame çš„ Expr<br>åƒè¿™äº›åŠŸèƒ½ï¼Œæ˜¯ä¸ºå¤–éƒ¨å¼•å…¥çš„ç»“æ„å®ç°æŸäº›ç‰¹å®šçš„ trait å—ï¼Ÿè¿™æ ·ç®—ä¿®æ”¹å¤–éƒ¨åŒ…çš„åŠŸèƒ½å—ï¼Ÿ","like_count":1,"discussions":[{"author":{"id":1079375,"avatar":"https://static001.geekbang.org/account/avatar/00/10/78/4f/e74f870c.jpg","nickname":"Tyr","note":"","ucode":"EAAFC8063202E0","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":526635,"discussion_content":"ä½ å¯ä»¥çœ‹åˆ°ï¼Œæˆ‘å¯¹å¤–éƒ¨åŒ…çš„æ•°æ®ç»“æ„åšäº†ä¸€å±‚å°è£…ï¼Œä»å†…å­˜å¸ƒå±€çš„è§’åº¦ï¼Œè¿™å°è£…æ˜¯ä¸å­˜åœ¨çš„ï¼Œä»ç±»å‹ç³»ç»Ÿçš„è§’åº¦ï¼Œè¿™å±‚å°è£…å¯ä»¥è®©æˆ‘ä¸ºã€Œæˆ‘çš„ç±»å‹ã€å®ç° From traitã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1631284418,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":311265,"user_name":"yyxxccc","can_delete":false,"product_type":"c1","uid":2759441,"ip_address":"","ucode":"BEC53F4F4922B8","user_header":"https://static001.geekbang.org/account/avatar/00/2a/1b/11/5e235665.jpg","comment_is_top":false,"comment_ctime":1631150298,"is_pvip":false,"replies":[{"id":"112799","content":"å“ˆå“ˆçœ‹å®Œè§‰å¾—ä¸é”™ï¼Œä¸€å®šè¦åŠ¨æ‰‹å†™å†™ï¼Œä½“éªŒä¼šå®Œå…¨ä¸ä¸€æ ·ã€‚ä¸è¿‡è¯¾ç¨‹è¿˜æ˜¯è¦ç»™å¤§å®¶è®²æ¸…æ¥šçŸ¥è¯†ç‚¹å˜›ï¼Œæ„Ÿæ€§ä¸€æŠŠè¿˜æ˜¯å¾—ç†æ€§å›æ¥ã€‚ä½ å¦‚æœæœ‰å…´è¶£å¯ä»¥è‡ªå·±åšäº›æ‹“å±•æˆ–è€…å…¶ä»–å°é¡¹ç›®å†æ„Ÿå—ä¸€ä¸‹","user_name":"ç¼–è¾‘å›å¤","user_name_real":"å¶å¦‚èŠŠ","uid":"2547771","ctime":1631152535,"ip_address":"","comment_id":311265,"utype":2}],"discussion_count":1,"race_medal":0,"score":"5926117594","product_id":100085301,"comment_content":"é™ˆè€å¸ˆå†æ¥å‡ ä¸ªç™½é‡‘ï¼Œç‹è€…çº§éš¾åº¦çš„ğŸ‘ï¼Œè¿™ä¸€è®²çœ‹å¾—æˆ‘åœ°é“åè¿‡ç«™äº†ğŸ˜‚ã€‚","like_count":2,"discussions":[{"author":{"id":2547771,"avatar":"https://static001.geekbang.org/account/avatar/00/26/e0/3b/8ec916b2.jpg","nickname":"å¤šå°‘","note":"","ucode":"0A6EF7AA6E4BB7","race_medal":0,"user_type":4,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":526542,"discussion_content":"å“ˆå“ˆçœ‹å®Œè§‰å¾—ä¸é”™ï¼Œä¸€å®šè¦åŠ¨æ‰‹å†™å†™ï¼Œä½“éªŒä¼šå®Œå…¨ä¸ä¸€æ ·ã€‚ä¸è¿‡è¯¾ç¨‹è¿˜æ˜¯è¦ç»™å¤§å®¶è®²æ¸…æ¥šçŸ¥è¯†ç‚¹å˜›ï¼Œæ„Ÿæ€§ä¸€æŠŠè¿˜æ˜¯å¾—ç†æ€§å›æ¥ã€‚ä½ å¦‚æœæœ‰å…´è¶£å¯ä»¥è‡ªå·±åšäº›æ‹“å±•æˆ–è€…å…¶ä»–å°é¡¹ç›®å†æ„Ÿå—ä¸€ä¸‹","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1631152535,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":4}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":310419,"user_name":"qinsi","can_delete":false,"product_type":"c1","uid":1667175,"ip_address":"","ucode":"090D9C4068FF12","user_header":"https://static001.geekbang.org/account/avatar/00/19/70/67/0c1359c2.jpg","comment_is_top":false,"comment_ctime":1630648244,"is_pvip":true,"replies":[{"id":"112481","content":"å®ç¼–ç¨‹ä¸è¿‡æ˜¯æŠŠç»™ä½ çš„ ASTï¼ˆå’Œæ–‡ä¸­ SQL è§£æå‡ºæ¥çš„ä¸œè¥¿ç±»ä¼¼ï¼‰ä¸­çš„æŸäº›éƒ¨åˆ†è½¬æ¢æˆå…¶å®ƒ AST æˆ–è€…æ•°æ®ç»“æ„çš„è¿‡ç¨‹ã€‚ç­‰æ”¶é›†å¥½éœ€è¦çš„ä¿¡æ¯ï¼Œæœ€åå°±æ˜¯è‹¥å¹² quote ç”Ÿæˆç›®æ ‡ä»£ç æ”¶å°¾ã€‚æ‰€ä»¥æˆ‘è¯´å®ƒçš„ä¸»è¦æµç¨‹å°±æ˜¯ä¸åœåœ°åœ¨åš From&#47;TryFromã€‚ä¸æ˜¯è¯´ From&#47;TryFrom å°±æ˜¯å®ç¼–ç¨‹ã€‚ä»£ç é‡Œæ˜¯æ²¡æœ‰å®šä¹‰å®ï¼Œä½†ä½ åœ¨çœŸæ­£å¤„ç†è¿‡ç¨‹å®çš„æ—¶å€™ï¼Œ80% çš„ä»£ç å’Œ convert.rs é‡Œåšçš„äº‹æƒ…ç±»ä¼¼ã€‚","user_name":"ä½œè€…å›å¤","user_name_real":"Tyr","uid":"1079375","ctime":1630684055,"ip_address":"","comment_id":310419,"utype":1}],"discussion_count":1,"race_medal":0,"score":"5925615540","product_id":100085301,"comment_content":"ã€å®ç¼–ç¨‹çš„ä¸»è¦æµç¨‹å°±æ˜¯å®ç°è‹¥å¹² Fromå’Œ TryFromã€è¿™é‡Œæœ‰ç‚¹ç»•ã€‚æ˜¯è¯´å®ç°From traitçš„å·¥ä½œå¯ä»¥ç®—æ˜¯ä¸€ç§å®ç¼–ç¨‹å—ï¼Ÿæ¯•ç«Ÿä»£ç é‡Œåªæ˜¯å®ç°äº†traitï¼Œæ²¡æœ‰å®šä¹‰å®ã€‚","like_count":1,"discussions":[{"author":{"id":1079375,"avatar":"https://static001.geekbang.org/account/avatar/00/10/78/4f/e74f870c.jpg","nickname":"Tyr","note":"","ucode":"EAAFC8063202E0","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":526230,"discussion_content":"å®ç¼–ç¨‹ä¸è¿‡æ˜¯æŠŠç»™ä½ çš„ ASTï¼ˆå’Œæ–‡ä¸­ SQL è§£æå‡ºæ¥çš„ä¸œè¥¿ç±»ä¼¼ï¼‰ä¸­çš„æŸäº›éƒ¨åˆ†è½¬æ¢æˆå…¶å®ƒ AST æˆ–è€…æ•°æ®ç»“æ„çš„è¿‡ç¨‹ã€‚ç­‰æ”¶é›†å¥½éœ€è¦çš„ä¿¡æ¯ï¼Œæœ€åå°±æ˜¯è‹¥å¹² quote ç”Ÿæˆç›®æ ‡ä»£ç æ”¶å°¾ã€‚æ‰€ä»¥æˆ‘è¯´å®ƒçš„ä¸»è¦æµç¨‹å°±æ˜¯ä¸åœåœ°åœ¨åš From/TryFromã€‚ä¸æ˜¯è¯´ From/TryFrom å°±æ˜¯å®ç¼–ç¨‹ã€‚ä»£ç é‡Œæ˜¯æ²¡æœ‰å®šä¹‰å®ï¼Œä½†ä½ åœ¨çœŸæ­£å¤„ç†è¿‡ç¨‹å®çš„æ—¶å€™ï¼Œ80% çš„ä»£ç å’Œ convert.rs é‡Œåšçš„äº‹æƒ…ç±»ä¼¼ã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1630684055,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":358179,"user_name":"é¾æ³³ç’Ÿ","can_delete":false,"product_type":"c1","uid":3178110,"ip_address":"å¹¿ä¸œ","ucode":"ED407D0E8919BD","user_header":"https://static001.geekbang.org/account/avatar/00/30/7e/7e/6181039c.jpg","comment_is_top":false,"comment_ctime":1664005769,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1664005769","product_id":100085301,"comment_content":"Covid.rs åœ¨ examples çš„éƒ¨åˆ†ä»£ç æœ‰æŠ¥é”™è¯·çš„è°ƒæ•´ä¸º<br><br><br>let filtered = df.filter(&amp;df.column(&quot;new_deaths&quot;)?.gt(500)?)?;<br>    println!(<br>        &quot;{:?}&quot;,<br>        filtered.select([<br>            &quot;location&quot;,<br>            &quot;total_cases&quot;,<br>            &quot;new_cases&quot;,<br>            &quot;total_deaths&quot;,<br>            &quot;new_deaths&quot;<br>        ])<br>    );","like_count":0},{"had_liked":false,"id":356841,"user_name":"é£æ–©æ–­æ™šéœ","can_delete":false,"product_type":"c1","uid":2160093,"ip_address":"æ¹–åŒ—","ucode":"74BC020047A2B4","user_header":"https://static001.geekbang.org/account/avatar/00/20/f5/dd/bb991e80.jpg","comment_is_top":false,"comment_ctime":1662631221,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1662631221","product_id":100085301,"comment_content":"æ•°æ®é›†å¯ä»¥ç”¨æˆ‘è¿™ä¸ªã€‚ã€‚ https:&#47;&#47;gitee.com&#47;ekoclike&#47;get&#47;raw&#47;main&#47;qwe.csv","like_count":0},{"had_liked":false,"id":355011,"user_name":"æš‚æ—¶ç”¨è¿™ä¸ªåå­—å’Œå¤´åƒ","can_delete":false,"product_type":"c1","uid":1049013,"ip_address":"åŒ—äº¬","ucode":"39B8F94C750FC4","user_header":"https://static001.geekbang.org/account/avatar/00/10/01/b5/d53eb811.jpg","comment_is_top":false,"comment_ctime":1660974061,"is_pvip":false,"replies":[{"id":"129153","content":"å†™ç¨¿çš„å½“æ—¶è€å¸ˆéƒ½æ˜¯è·‘è¿‡çš„ï¼Œä¸è¿‡rustè¯­è¨€å’Œç›¸å…³åº“æ›´æ–°å¿«ï¼Œå¦‚æœæ–‡ç¨¿ä¸­ä»£ç è¿è¡Œæœ‰è¯¯ï¼Œä¸€æ˜¯å¯ä»¥å‚è€ƒgithubä¸Šçš„æœ€æ–°ä»£ç ï¼ŒäºŒæ˜¯å¯ä»¥å»ç•™è¨€åŒºæ‰¾æ‰¾ç›¸å…³è®¨è®º","user_name":"ç¼–è¾‘å›å¤","user_name_real":"ç¼–è¾‘","uid":"2547771","ctime":1661003876,"ip_address":"åŒ—äº¬","comment_id":355011,"utype":2}],"discussion_count":1,"race_medal":0,"score":"1660974061","product_id":100085301,"comment_content":"ä¸ºå•¥è¯¾ç¨‹ç»å¤§å¤šæ•°ä»£ç éƒ½æ— æ³•è¿è¡Œçš„ï¼Ÿè€å¸ˆæœ‰è·‘è¿‡çš„å—<br>error[E0308]: mismatched types<br>   --&gt; 06_queryer&#47;queryer&#47;src&#47;lib.rs:78:59<br>    |<br>78  |         .fold(filtered, |acc, (col, desc)| acc.sort(&amp;col, desc));<br>    |                                                ----       ^^^^ expected struct `SortOptions`, found `bool`<br>    |                                                |<br>    |                                                arguments to this function are incorrect<br>    |<br>note: associated function defined here<br>   --&gt; &#47;root&#47;.cargo&#47;registry&#47;src&#47;github.com-1ecc6299db9ec823&#47;polars-lazy-0.23.2&#47;src&#47;frame&#47;mod.rs:271:12<br>    |<br>271 |     pub fn sort(self, by_column: &amp;str, options: SortOptions) -&gt; Self {<br>    |            ^^^^<br>","like_count":0,"discussions":[{"author":{"id":2547771,"avatar":"https://static001.geekbang.org/account/avatar/00/26/e0/3b/8ec916b2.jpg","nickname":"å¤šå°‘","note":"","ucode":"0A6EF7AA6E4BB7","race_medal":0,"user_type":4,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":584654,"discussion_content":"å†™ç¨¿çš„å½“æ—¶è€å¸ˆéƒ½æ˜¯è·‘è¿‡çš„ï¼Œä¸è¿‡rustè¯­è¨€å’Œç›¸å…³åº“æ›´æ–°å¿«ï¼Œå¦‚æœæ–‡ç¨¿ä¸­ä»£ç è¿è¡Œæœ‰è¯¯ï¼Œä¸€æ˜¯å¯ä»¥å‚è€ƒgithubä¸Šçš„æœ€æ–°ä»£ç ï¼ŒäºŒæ˜¯å¯ä»¥å»ç•™è¨€åŒºæ‰¾æ‰¾ç›¸å…³è®¨è®º","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1661003876,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"åŒ—äº¬"},"score":2,"extra":"{\"reply\":true,\"user_type\":4}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":352511,"user_name":"Rootrl","can_delete":false,"product_type":"c1","uid":1035390,"ip_address":"","ucode":"50FE3BBA92D417","user_header":"https://static001.geekbang.org/account/avatar/00/0f/cc/7e/0d050964.jpg","comment_is_top":false,"comment_ctime":1658740052,"is_pvip":true,"discussion_count":0,"race_medal":0,"score":"1658740052","product_id":100085301,"comment_content":"è¢«è€å¸ˆè¿™â€œä¸‰æ¿æ–§â€é•‡ä½äº†ã€‚ã€‚ å¾—ï¼Œè¿˜æ˜¯çœ‹å®Œåé¢å†æ¥åšé¡¹ç›®å§~","like_count":0},{"had_liked":false,"id":348778,"user_name":"å°æ°","can_delete":false,"product_type":"c1","uid":2853200,"ip_address":"","ucode":"BBDF8E9F348F65","user_header":"https://static001.geekbang.org/account/avatar/00/2b/89/50/aee9fdab.jpg","comment_is_top":false,"comment_ctime":1655384578,"is_pvip":true,"discussion_count":0,"race_medal":0,"score":"1655384578","product_id":100085301,"comment_content":"&#47;&#47;æœ€åç»ˆäºæ‰“å°å‡ºæ¥äº†ã€‚<br>In [1]: import queryer_py<br><br>In [2]: sql = queryer_py.example_sql()<br><br>In [3]: print(queryer_py.query(sql, &#39;csv&#39;))<br>name,total_cases,new_cases,total_deaths,new_deaths<br>World,324247961.0,3315994.0,5536264.0,7912.0<br>World,311269128.0,3188197.0,5501583.0,6425.0<br>World,320931967.0,3182700.0,5528352.0,8217.0<br>World,314300524.0,3031399.0,5510916.0,9333.0<br>World,303867545.0,2943889.0,5485492.0,7290.0<br>High income,172625621.0,2821346.0,2017981.0,6039.0<br><br>node çš„ç‰ˆæœ¬<br>âœ  queryer-js node<br>Welcome to Node.js v14.16.0.<br>Type &quot;.help&quot; for more information.<br>&gt; let sql = require(&#39;.&#39;)<br>undefined<br>&gt; sql.query()<br>&#39;name,total_cases,new_cases,total_deaths,new_deaths\\n&#39; +<br>  &#39;World,324247830.0,3315981.0,5536265.0,7913.0\\n&#39; +<br>  &#39;World,311269022.0,3188191.0,5501583.0,6425.0\\n&#39; +<br>  &#39;World,320931849.0,3182697.0,5528352.0,8217.0\\n&#39; +<br>  &#39;World,314300414.0,3031395.0,5510916.0,9333.0\\n&#39; +<br>  &#39;World,303867451.0,2943887.0,5485492.0,7290.0\\n&#39; +<br>  &#39;High income,172625462.0,2821336.0,2017982.0,6039.0\\n&#39;<br><br><br>&#47;&#47; è€å¸ˆèƒ½æˆ‘çœ‹ä¸‹æˆ‘å†™çš„ä»£ç å—ï¼Ÿæˆ‘çœ‹äº†nenoçš„å®˜æ–¹æ–‡æ¡£ï¼Œå¥½åƒä¸èƒ½å¤šä¸ªå‚æ•°çš„functionï¼Œåªèƒ½æ˜¯â€œFunctionContextâ€ï¼Œæ‰€ä»¥æ–¹æ³•é‡Œé¢çš„ï¼Œsqlå’Œcsvéƒ½å†™æ­»äº†ã€‚<br>fn query (mut cx: FunctionContext) -&gt; JsResult&lt;JsString&gt;{<br>    let rt = tokio::runtime::Runtime::new().unwrap();<br>    let data = rt.block_on(async { queryer::query(queryer::example_sql()).await.unwrap() });<br>    Ok(cx.string(data.to_csv().unwrap()))<br>}<br><br><br>#[neon::main]<br>fn main(mut cx: ModuleContext) -&gt; NeonResult&lt;()&gt; {<br>    cx.export_function(&quot;query&quot;, query)?;<br>    Ok(())<br>}","like_count":0},{"had_liked":false,"id":348777,"user_name":"å°æ°","can_delete":false,"product_type":"c1","uid":2853200,"ip_address":"","ucode":"BBDF8E9F348F65","user_header":"https://static001.geekbang.org/account/avatar/00/2b/89/50/aee9fdab.jpg","comment_is_top":false,"comment_ctime":1655384568,"is_pvip":true,"discussion_count":0,"race_medal":0,"score":"1655384568","product_id":100085301,"comment_content":"&#47;&#47; è¿™ç¯‡æ–‡ç« çœ‹äº†æˆ‘3å¤©ï¼Œç®—æ˜¯æˆ‘çœ‹çš„éå¸¸è®¤çœŸçš„æ–‡æ¡£ï¼ŒçœŸçš„æ˜¯åªèƒ½ä¸€ä¸ªä¸€ä¸ªæ¥<br><br>&#47;&#47; åˆ†æï¼š<br>&#47;&#47; 1ã€ä½¿ç”¨ sqlparser è§£æsql<br><br>&#47;&#47; 2ã€ä½¿ç”¨ polars å¯¹ csv -&gt; (è½¬åŒ–) DataFrame<br><br>&#47;&#47; 3ã€sql ast -&gt; ï¼ˆæ˜ å°„ï¼‰DataFrame, ç”¨ä»£ç åº“çš„æ–¹å¼è¡¨è¾¾å°±æ˜¯ SqlParser AST -&gt; ï¼ˆè½¬åŒ–ï¼‰Polars AST<br>&#47;&#47; æ­¤è¿‡ç¨‹å«è¯­æ³•ä¹‹é—´çš„è½¬åŒ–ï¼Œä¹Ÿå«æ•°æ®ç»“æ„çš„è½¬åŒ–<br><br><br>&#47;&#47; æ–‡ä»¶ï¼š<br>&#47;&#47; examples&#47;dialect.rs æ–‡ä»¶ï¼ŒæŸ¥çœ‹ sqlparserçš„AST<br><br>&#47;&#47; src&#47;dialect.rsæ–‡ä»¶ï¼Œæµ‹è¯•æ˜¯å¦èƒ½æ­£å¸¸è§£æè‡ªå®šçš„æ–¹è¨€sql <br>&#47;&#47;ï¼ˆSELECT * from https:&#47;&#47;abc.xyz&#47;covid-cases.csv where new_deaths &gt;= 500ï¼‰<br><br>&#47;&#47; example&#47;covid.rs, å®ç°ä¸€ä¸ªDataFrameçš„åŠ è½½å’ŒæŸ¥è¯¢<br><br>&#47;&#47; æ¥ä¸‹æ¥çš„é‡ç‚¹æ¥äº†ï¼Œsrc&#47;convert.rs, å®šä¹‰ä¸€ä¸ªæ•°æ®ç»“æ„æ¥æè¿°ä¸¤è€…å¯¹åº”çš„å…³ç³»<br>&#47;&#47; è¿™ä¸ªæ˜¯æœ¬ç¯‡æ–‡ç« çš„æ ¸å¿ƒï¼Œçœ‹è€å¸ˆçš„è®²è§£è¿˜å¥½ï¼Œä½†æ˜¯çœŸæ­£å»çœ‹å®Œæ•´çš„ä»£ç ï¼Œæ•´ä¸ªäººéƒ½æ˜¯æ‡µçš„ï¼Œç‰¹åˆ«æ˜¯æ¶‰åŠåˆ°rustçš„ç”Ÿå‘½å‘¨æœŸã€‚å…¶å®å°±æ˜¯è‡ªå·±ç”¨çš„å°‘<br><br>&#47;&#47; è·å–æ•°æ®ï¼Œå°†retrieve_data å’Œå…·ä½“æ¯ä¸€ç§ç±»å‹çš„å¤„ç†åˆ†ç¦»ï¼Œå®ç°ä½è€¦åˆã€é«˜å†…èš <br><br>&#47;&#47; ä¸»æµç¨‹ï¼Œåœ¨è§£å¼•ç”¨å°±æŒºæ‡µçš„ã€‚æ‰€ä»¥è¿™ä¸ªæ–‡ä»¶å°±çœ‹å¾—äº‘é‡Œé›¾é‡Œ","like_count":0},{"had_liked":false,"id":341958,"user_name":"å…´å°ç‹¸","can_delete":false,"product_type":"c1","uid":1140825,"ip_address":"","ucode":"8A1CDD3F0A59C0","user_header":"","comment_is_top":false,"comment_ctime":1649931353,"is_pvip":false,"replies":[{"id":"125093","content":"å…ˆæœ‰ä¸ªå¤§æ¦‚æ„Ÿè§‰ï¼Œåé¢å…·ä½“æŒæ¡ä¸ºä»€ä¹ˆè¦è¿™ä¹ˆå†™ä¼šæ›´æœ‰é’ˆå¯¹æ€§ã€‚å¦‚æœå®åœ¨æ‡µé€¼ï¼Œget hands dirtyéƒ¨åˆ†å¯ä»¥å…ˆè·³è¿‡ï¼Œåé¢å¤šå­¦ç‚¹å†å›æ¥ï¼ŒåŠ æ²¹ï½","user_name":"ç¼–è¾‘å›å¤","user_name_real":"ç¼–è¾‘","uid":"2547771","ctime":1650262310,"ip_address":"","comment_id":341958,"utype":2}],"discussion_count":1,"race_medal":0,"score":"1649931353","product_id":100085301,"comment_content":"å””~æˆ‘ä»£ç æŠ„äº†ä¸€åŠéƒ½æ˜¯ä¸æ‡‚çš„ï¼Œæˆ‘è¿™æ ·æŠ„æœ‰æ•ˆå—ï¼Ÿè€å¸ˆã€‚æˆ‘ä¹Ÿä¸ç†è§£ä¸ºå•¥è¦è¿™æ ·å†™ï¼Œä¹Ÿä¸çŸ¥é“è¿™æ ·å®ç°çš„é“ç†","like_count":0,"discussions":[{"author":{"id":2547771,"avatar":"https://static001.geekbang.org/account/avatar/00/26/e0/3b/8ec916b2.jpg","nickname":"å¤šå°‘","note":"","ucode":"0A6EF7AA6E4BB7","race_medal":0,"user_type":4,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":564507,"discussion_content":"å…ˆæœ‰ä¸ªå¤§æ¦‚æ„Ÿè§‰ï¼Œåé¢å…·ä½“æŒæ¡ä¸ºä»€ä¹ˆè¦è¿™ä¹ˆå†™ä¼šæ›´æœ‰é’ˆå¯¹æ€§ã€‚å¦‚æœå®åœ¨æ‡µé€¼ï¼Œget hands dirtyéƒ¨åˆ†å¯ä»¥å…ˆè·³è¿‡ï¼Œåé¢å¤šå­¦ç‚¹å†å›æ¥ï¼ŒåŠ æ²¹ï½","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1650262311,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":4}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":335800,"user_name":"åµ©","can_delete":false,"product_type":"c1","uid":1082928,"ip_address":"","ucode":"7CB4B8EAD84E8F","user_header":"https://static001.geekbang.org/account/avatar/00/10/86/30/a5eff028.jpg","comment_is_top":false,"comment_ctime":1645692836,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1645692836","product_id":100085301,"comment_content":"å¯ä»¥è¯´å­¦å®Œè¿™ä¸€ç« å°±ç‡ƒèµ·æ¥äº†ï½","like_count":0},{"had_liked":false,"id":333873,"user_name":"Alice","can_delete":false,"product_type":"c1","uid":1926134,"ip_address":"","ucode":"6D8F901229B182","user_header":"https://static001.geekbang.org/account/avatar/00/1d/63/f6/225df928.jpg","comment_is_top":false,"comment_ctime":1644568272,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1644568272","product_id":100085301,"comment_content":"sqlparser [0.14.0] 2022-02-09 ç‰ˆæœ¬ä¿®æ”¹å¢åŠ äº†å¯¹é€šé…ç¬¦ WildCard çš„é™åˆ¶ï¼Œå¦‚æœåªæ˜¯ä¸ºäº†è®©æ•™ç¨‹ä»£ç å¿«é€Ÿé€šè¿‡ï¼Œå¯ä»¥åˆ é™¤ WildCard çš„æ¨¡å¼åŒ¹é…ç¼–è¯‘å³å¯<br><br>&#47;&#47; SqlExpr::Wildcard =&gt; Ok(Self::Wildcard),<br><br>Add FunctionArgExpr and remove Expr::[Qualified]Wildcard<br><br>è¯¥ä¿®æ”¹çš„ PR å…¥å£ï¼šhttps:&#47;&#47;github.com&#47;sqlparser-rs&#47;sqlparser-rs&#47;pull&#47;378","like_count":0},{"had_liked":false,"id":331753,"user_name":"matrix","can_delete":false,"product_type":"c1","uid":1679933,"ip_address":"","ucode":"7D085F45C8A0DB","user_header":"http://thirdwx.qlogo.cn/mmopen/vi_32/ygRfx93LO1ziazydV4eZRGdqkxJVXJzbnFWicvzibnmYdvjYdiaya2wS4EbAURxKnMXbt9rrGsN4DINsc2XzAKibtuA/132","comment_is_top":false,"comment_ctime":1642751007,"is_pvip":false,"discussion_count":1,"race_medal":0,"score":"1642751007","product_id":100085301,"comment_content":"é™ˆå¤©è€å¸ˆï¼Œ polars å‡çº§åˆ°0.18ä¹‹åï¼Œ Exprè¿™ä¸ªenumä¸­çš„ç±»å‹çš„å±æ€§éƒ½å˜æˆäº† Arc&lt;str&gt; ï¼Œè¿™ç§æƒ…å†µä¸‹è¯¥æ€ä¹ˆè½¬æ¢Identifierè¿™äº›å€¼å‘¢?","like_count":0,"discussions":[{"author":{"id":1926134,"avatar":"https://static001.geekbang.org/account/avatar/00/1d/63/f6/225df928.jpg","nickname":"Alice","note":"","ucode":"6D8F901229B182","race_medal":0,"user_type":8,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":550508,"discussion_content":"å¯ä»¥å°è¯•è¿™æ ·çš„å†™æ³•ï¼šArc::from(alias.to_string())\n\nå¦‚æœä½ å·²ç»å­¦å®Œäº†å¤§å¤šæ•°è¯¾ç¨‹å†…å®¹ï¼Œå¯ä»¥é˜…è¯»ä¸€ä¸‹å’Œè¿™ä¸ªé—®é¢˜æœ‰å…³çš„ RFC æ–‡æ¡£ï¼š\nhttps://github.com/rust-lang/rfcs/blob/master/text/1845-shared-from-slice.md","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1644572374,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":330826,"user_name":"è€å®äººHoney","can_delete":false,"product_type":"c1","uid":1080653,"ip_address":"","ucode":"EA4AB5C0C33090","user_header":"https://static001.geekbang.org/account/avatar/00/10/7d/4d/d98865b2.jpg","comment_is_top":false,"comment_ctime":1642184525,"is_pvip":true,"replies":[{"id":"120751","content":"ğŸ‘","user_name":"ä½œè€…å›å¤","user_name_real":"ç¼–è¾‘","uid":"1079375","ctime":1642308063,"ip_address":"","comment_id":330826,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1642184525","product_id":100085301,"comment_content":"neno done<br>```rs<br>use neon::prelude::*;<br><br>fn example_sql(mut cx: FunctionContext) -&gt; JsResult&lt;JsString&gt; {<br>    Ok(cx.string(queryer::example_sql()))<br>}<br><br>fn query(mut cx: FunctionContext) -&gt; JsResult&lt;JsString&gt; {<br>    let sql = cx.argument::&lt;JsString&gt;(0)?;<br>    let output = cx.argument_opt(1);<br>    let rt = tokio::runtime::Runtime::new().unwrap();<br>    let data = rt.block_on(async { queryer::query(sql.value(&amp;mut cx)).await.unwrap() });<br>    if let Some(v) = output {<br>        let csv: Handle&lt;JsString&gt; = v.downcast(&amp;mut cx).unwrap();<br>        let csv = csv.value(&amp;mut cx);<br>        if csv.eq(&quot;csv&quot;) {<br>            return Ok(cx.string(data.to_csv().unwrap()));<br>        }<br>        return cx.throw_error(format!(<br>            &quot;Output type {} not supported&quot;,<br>            csv<br>        ));<br>    } else {<br>        return Ok(cx.string(data.to_csv().unwrap()));<br>    }<br><br>}<br><br>#[neon::main]<br>fn main(mut cx: ModuleContext) -&gt; NeonResult&lt;()&gt; {<br>    cx.export_function(&quot;example_sql&quot;, example_sql)?;<br>    cx.export_function(&quot;query&quot;, query)?;<br>    Ok(())<br>}<br>```","like_count":0,"discussions":[{"author":{"id":1079375,"avatar":"https://static001.geekbang.org/account/avatar/00/10/78/4f/e74f870c.jpg","nickname":"Tyr","note":"","ucode":"EAAFC8063202E0","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":546389,"discussion_content":"ğŸ‘","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1642308063,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":330672,"user_name":"è€å®äººHoney","can_delete":false,"product_type":"c1","uid":1080653,"ip_address":"","ucode":"EA4AB5C0C33090","user_header":"https://static001.geekbang.org/account/avatar/00/10/7d/4d/d98865b2.jpg","comment_is_top":false,"comment_ctime":1642093017,"is_pvip":true,"replies":[{"id":"120683","content":"è¿™ä¸ªææ€•è¦å¥½å¥½çœ‹ pyo3 çš„æ–‡æ¡£","user_name":"ä½œè€…å›å¤","user_name_real":"ç¼–è¾‘","uid":"1079375","ctime":1642292295,"ip_address":"","comment_id":330672,"utype":1}],"discussion_count":2,"race_medal":0,"score":"1642093017","product_id":100085301,"comment_content":"pyo3è¿™ä¸ªä¾‹å­ï¼Œç°åœ¨æœ‰ç‚¹è·‘ä¸åŠ¨äº†ã€‚<br>ld: symbol(s) not found for architecture x86_64<br>          clang: error: linker command failed with exit code 1 (use -v to see invocation)<br>https:&#47;&#47;github.com&#47;PyO3&#47;pyo3&#47;issues&#47;1800ï¼Œæš‚æ—¶ä¸æ˜¯å¾ˆæ‡‚ä¸ºä»€ä¹ˆ","like_count":0,"discussions":[{"author":{"id":1079375,"avatar":"https://static001.geekbang.org/account/avatar/00/10/78/4f/e74f870c.jpg","nickname":"Tyr","note":"","ucode":"EAAFC8063202E0","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":546292,"discussion_content":"è¿™ä¸ªææ€•è¦å¥½å¥½çœ‹ pyo3 çš„æ–‡æ¡£","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1642292295,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1005944,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/59/78/4f384f93.jpg","nickname":"é¾™","note":"","ucode":"B353E8002D2BF3","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":556078,"discussion_content":"ä¸€å¼€å§‹ä¹Ÿæ˜¯æŠ¥è¿™ä¸ªé”™ï¼Œåæ¥å‘ç°æ˜¯å°‘äº†build.rsï¼ŒåŠ ä¸Šè€å¸ˆçš„è¿™ä¸ªæ–‡ä»¶å°±å¯ä»¥äº†","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1647187171,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":328478,"user_name":"ä¸Šæ²…åŒå­¦","can_delete":false,"product_type":"c1","uid":1238646,"ip_address":"","ucode":"CDE043A508E4EA","user_header":"https://static001.geekbang.org/account/avatar/00/12/e6/76/26f555ce.jpg","comment_is_top":false,"comment_ctime":1640749313,"is_pvip":false,"replies":[{"id":"120774","content":"lol","user_name":"ä½œè€…å›å¤","user_name_real":"ç¼–è¾‘","uid":"1079375","ctime":1642309445,"ip_address":"","comment_id":328478,"utype":1}],"discussion_count":1,"race_medal":1,"score":"1640749313","product_id":100085301,"comment_content":"è®²çš„å¤ªæ£’äº†ï¼å°±æ˜¯æ²¡æ€ä¹ˆçœ‹æ‡‚ï¼Œè¦æ…¢æ…¢å•ƒã€‚ã€‚","like_count":0,"discussions":[{"author":{"id":1079375,"avatar":"https://static001.geekbang.org/account/avatar/00/10/78/4f/e74f870c.jpg","nickname":"Tyr","note":"","ucode":"EAAFC8063202E0","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":546413,"discussion_content":"lol","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1642309446,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":328065,"user_name":"Geek_9d1ee1","can_delete":false,"product_type":"c1","uid":2541935,"ip_address":"","ucode":"D09037B4B3EE53","user_header":"","comment_is_top":false,"comment_ctime":1640511149,"is_pvip":false,"replies":[{"id":"120782","content":"Trait å’Œå®ç° Trait çš„ Struct åªè¦å…¶ä¸­ä¸€ä¸ªæ˜¯è‡ªå·±å®šä¹‰çš„å°±å¯ä»¥é¿å…å­¤å„¿è§„åˆ™","user_name":"ä½œè€…å›å¤","user_name_real":"ç¼–è¾‘","uid":"1079375","ctime":1642309713,"ip_address":"","comment_id":328065,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1640511149","product_id":100085301,"comment_content":"å›æ¥çœ‹è¿™ä¸ªä»£ç ï¼Œå‘ç°ä¸ªé—®é¢˜ï¼Œ<br><br>&#47;&#47;&#47; æŠŠ SqlParser çš„ BinaryOperator è½¬æ¢æˆ DataFrame çš„ Operator<br>impl TryFrom&lt;Operation&gt; for Operator {...}<br><br>è¿™é‡Œ Operator æ˜¯ä¸ªå¤–éƒ¨çš„(Polars é‡Œçš„) Type, ä¸ºä»€ä¹ˆå¯ä»¥ä¸ºè¿™ä¸ªå®ç° TryFrom","like_count":0,"discussions":[{"author":{"id":1079375,"avatar":"https://static001.geekbang.org/account/avatar/00/10/78/4f/e74f870c.jpg","nickname":"Tyr","note":"","ucode":"EAAFC8063202E0","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":546421,"discussion_content":"Trait å’Œå®ç° Trait çš„ Struct åªè¦å…¶ä¸­ä¸€ä¸ªæ˜¯è‡ªå·±å®šä¹‰çš„å°±å¯ä»¥é¿å…å­¤å„¿è§„åˆ™","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1642309713,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":323588,"user_name":"Lambda","can_delete":false,"product_type":"c1","uid":1867180,"ip_address":"","ucode":"F7A95A0491D298","user_header":"https://static001.geekbang.org/account/avatar/00/1c/7d/ac/a6026f3b.jpg","comment_is_top":false,"comment_ctime":1638006916,"is_pvip":true,"replies":[{"id":"118883","content":"bï¼ˆï¿£â–½ï¿£ï¼‰d","user_name":"ä½œè€…å›å¤","user_name_real":"ç¼–è¾‘","uid":"1079375","ctime":1639850091,"ip_address":"","comment_id":323588,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1638006916","product_id":100085301,"comment_content":"æˆ‘çœ‹ä¸æ‡‚, ä½†æˆ‘å¤§å—éœ‡æ’¼","like_count":0,"discussions":[{"author":{"id":1079375,"avatar":"https://static001.geekbang.org/account/avatar/00/10/78/4f/e74f870c.jpg","nickname":"Tyr","note":"","ucode":"EAAFC8063202E0","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":539844,"discussion_content":"bï¼ˆï¿£â–½ï¿£ï¼‰d","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1639850091,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":320109,"user_name":"Roy Liang","can_delete":false,"product_type":"c1","uid":1098898,"ip_address":"","ucode":"1DF5FC831A35DA","user_header":"https://static001.geekbang.org/account/avatar/00/10/c4/92/338b5609.jpg","comment_is_top":false,"comment_ctime":1636083547,"is_pvip":false,"replies":[{"id":"116344","content":"ä½ å¯ä»¥è‡ªå·±æ‰“å°ï¼Œæˆ–è€…åœ¨è¿è¡Œæ—¶ä¼ å…¥ç›¸åº”çš„ç¯å¢ƒå˜é‡ï¼šhttps:&#47;&#47;docs.rs&#47;polars-core&#47;0.17.0&#47;src&#47;polars_core&#47;fmt.rs.html#324-461","user_name":"ä½œè€…å›å¤","user_name_real":"Tyr","uid":"1079375","ctime":1636526110,"ip_address":"","comment_id":320109,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1636083547","product_id":100085301,"comment_content":"æ€æ ·æ‰èƒ½ä½¿DataSetæ˜¾ç¤ºè¶…è¿‡8è¡Œ8åˆ—ï¼Œç°åœ¨è¶…è¿‡è¿™ä¸ªæ•°å°±æœ‰è¡Œæˆ–è€…åˆ—ç”¨çœç•¥å·ä»£æ›¿äº†","like_count":0,"discussions":[{"author":{"id":1079375,"avatar":"https://static001.geekbang.org/account/avatar/00/10/78/4f/e74f870c.jpg","nickname":"Tyr","note":"","ucode":"EAAFC8063202E0","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":529878,"discussion_content":"ä½ å¯ä»¥è‡ªå·±æ‰“å°ï¼Œæˆ–è€…åœ¨è¿è¡Œæ—¶ä¼ å…¥ç›¸åº”çš„ç¯å¢ƒå˜é‡ï¼šhttps://docs.rs/polars-core/0.17.0/src/polars_core/fmt.rs.html#324-461","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1636526110,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":319956,"user_name":"Roy Liang","can_delete":false,"product_type":"c1","uid":1098898,"ip_address":"","ucode":"1DF5FC831A35DA","user_header":"https://static001.geekbang.org/account/avatar/00/10/c4/92/338b5609.jpg","comment_is_top":false,"comment_ctime":1636018043,"is_pvip":false,"replies":[{"id":"116347","content":"åœ¨æ•°æ®å¤„ç†ä¸­ï¼Œç”¨åˆ°çš„ json ä¸€èˆ¬æ˜¯ ndjsonï¼šhttp:&#47;&#47;ndjson.org&#47;","user_name":"ä½œè€…å›å¤","user_name_real":"Tyr","uid":"1079375","ctime":1636526222,"ip_address":"","comment_id":319956,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1636018043","product_id":100085301,"comment_content":"æˆ‘è‡ªå·±å®ç°äº†JsonReaderï¼Œä¸çŸ¥é“ä¸ºä»€ä¹ˆä¸æ”¯æŒæ ‡å‡†çš„JSONï¼Œåªæ”¯æŒè¿™ç§æ ¼å¼ï¼ˆå¤–å±‚æ²¡æœ‰ä¸­æ‹¬å·ï¼Œå¯¹è±¡ä¹‹é—´æ²¡æœ‰é€—å·åˆ†éš”åªæœ‰æ¢è¡Œï¼Œæˆå‘˜ä¸èƒ½æ˜¯åµŒå¥—çš„JSONï¼‰<br>{&quot;a&quot;:1, &quot;b&quot;:2.0, &quot;c&quot;:false, &quot;d&quot;:&quot;4&quot;}<br>{&quot;a&quot;:-10, &quot;b&quot;:-3.5, &quot;c&quot;:true, &quot;d&quot;:&quot;4&quot;}","like_count":0,"discussions":[{"author":{"id":1079375,"avatar":"https://static001.geekbang.org/account/avatar/00/10/78/4f/e74f870c.jpg","nickname":"Tyr","note":"","ucode":"EAAFC8063202E0","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":529827,"discussion_content":"åœ¨æ•°æ®å¤„ç†ä¸­ï¼Œç”¨åˆ°çš„ json ä¸€èˆ¬æ˜¯ ndjsonï¼šhttp://ndjson.org/","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1636526222,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":319314,"user_name":"å®ä¿¡","can_delete":false,"product_type":"c1","uid":2819142,"ip_address":"","ucode":"1EFF0C4182412F","user_header":"https://static001.geekbang.org/account/avatar/00/2b/04/46/c673e5ad.jpg","comment_is_top":false,"comment_ctime":1635739899,"is_pvip":false,"replies":[{"id":"116386","content":"æœ‰æ²¡æœ‰å¯èƒ½ä½ æ„å¤–æ”¹åŠ¨äº†ï¼ŸæŠŠè¿™ä¸ªç›®å½•åˆ äº†å†é‡æ–°æ‹‰è¯•è¯•çœ‹","user_name":"ä½œè€…å›å¤","user_name_real":"Tyr","uid":"1079375","ctime":1636556389,"ip_address":"","comment_id":319314,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1635739899","product_id":100085301,"comment_content":"error: missing `struct` for struct definition<br>  --&gt; &#47;Users&#47;pundix041&#47;.cargo&#47;registry&#47;src&#47;github.com-1ecc6299db9ec823&#47;http-0.2.5&#47;src&#47;header&#47;map.rs:45:4<br>   |<br>45 | pub structHeaderMap&lt;T = HeaderValue&gt; {<br>   |    ^<br>   |<br>help: add `struct` here to parse `structHeaderMap` as a public struct<br>   |<br>45 | pub struct structHeaderMap&lt;T = HeaderValue&gt; {<br><br><br>http 0.2.5åŒ…ï¼Œæˆ‘çœ‹æ–‡æ¡£éƒ½æ˜¯æ­£ç¡®çš„ï¼Œååæˆ‘ç¼–è¯‘æ—¶è‡ªåŠ¨æ‹‰ä¸‹æ¥çš„åŒ…ï¼Œstruct HeaderMapå°‘äº†ä¸ªç©ºæ ¼ï¼Œå¯¼è‡´ç¼–è¯‘ä¸è¿‡ï¼Œè¿™æ˜¯ä¸ºå•¥å•Š","like_count":0,"discussions":[{"author":{"id":1079375,"avatar":"https://static001.geekbang.org/account/avatar/00/10/78/4f/e74f870c.jpg","nickname":"Tyr","note":"","ucode":"EAAFC8063202E0","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":529588,"discussion_content":"æœ‰æ²¡æœ‰å¯èƒ½ä½ æ„å¤–æ”¹åŠ¨äº†ï¼ŸæŠŠè¿™ä¸ªç›®å½•åˆ äº†å†é‡æ–°æ‹‰è¯•è¯•çœ‹","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1636556389,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":318503,"user_name":"çŸ³å¤´","can_delete":false,"product_type":"c1","uid":1013081,"ip_address":"","ucode":"D72F9EDFABFFBA","user_header":"https://static001.geekbang.org/account/avatar/00/0f/75/59/bd80584f.jpg","comment_is_top":false,"comment_ctime":1635316689,"is_pvip":false,"replies":[{"id":"116577","content":"é¦–å…ˆä½ è¦ä½¿ç”¨ release buildï¼Œdebug binary æºå¸¦å¾ˆå¤šè°ƒè¯•ä¿¡æ¯ï¼Œæ‰€ä»¥å¾ˆå¤§ã€‚å¦‚æœä½ æƒ³è¿›ä¸€æ­¥ç¼©å‡å¤§å°ï¼Œå¯ä»¥çœ‹ï¼šhttps:&#47;&#47;github.com&#47;johnthagen&#47;min-sized-rust","user_name":"ä½œè€…å›å¤","user_name_real":"Tyr","uid":"1079375","ctime":1636642386,"ip_address":"","comment_id":318503,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1635316689","product_id":100085301,"comment_content":"é’ˆå¯¹ jsï¼Œä¸ºå•¥ç¼–è¯‘å‡ºæ¥çš„index.node é‚£ä¹ˆå¤§å‘¢ï¼Ÿ æ¯”è¾ƒå¥½å¥‡ã€‚<br><br>```bash<br>(.env) âœ  queryer-js git:(master) âœ— du -h index.node<br> 23M\tindex.node<br>```","like_count":0,"discussions":[{"author":{"id":1079375,"avatar":"https://static001.geekbang.org/account/avatar/00/10/78/4f/e74f870c.jpg","nickname":"Tyr","note":"","ucode":"EAAFC8063202E0","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":529275,"discussion_content":"é¦–å…ˆä½ è¦ä½¿ç”¨ release buildï¼Œdebug binary æºå¸¦å¾ˆå¤šè°ƒè¯•ä¿¡æ¯ï¼Œæ‰€ä»¥å¾ˆå¤§ã€‚å¦‚æœä½ æƒ³è¿›ä¸€æ­¥ç¼©å‡å¤§å°ï¼Œå¯ä»¥çœ‹ï¼šhttps://github.com/johnthagen/min-sized-rust","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1636642386,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":318093,"user_name":"é˜¿æˆ","can_delete":false,"product_type":"c1","uid":1390032,"ip_address":"","ucode":"CEC3CD65FB9333","user_header":"https://static001.geekbang.org/account/avatar/00/15/35/d0/f2ac6d91.jpg","comment_is_top":false,"comment_ctime":1635147871,"is_pvip":false,"replies":[{"id":"116589","content":"ğŸ‘","user_name":"ä½œè€…å›å¤","user_name_real":"Tyr","uid":"1079375","ctime":1636644090,"ip_address":"","comment_id":318093,"utype":1}],"discussion_count":2,"race_medal":0,"score":"1635147871","product_id":100085301,"comment_content":"æ¥æ¥æ¥ï¼Œçœ‹çœ‹ä¿ºçš„ğŸ˜†:<br>node<br>https:&#47;&#47;github.com&#47;Rust-Beginner&#47;queryer&#47;blob&#47;master&#47;queryer-node&#47;README.md<br><br>è€å¸ˆåœ¨è·å– sql å’Œ output å‚æ•°çš„æ—¶å€™ç”¨çš„éƒ½æ˜¯cx.argumentï¼Œä½†æˆ‘è¿è¡Œçš„æ—¶å€™å‘ç°å¦‚æœåªä¼ ä¸€ä¸ªå‚æ•°ä¼šç›´æ¥æŠ¥ TypeError: not enough argumentsã€‚æ”¹ç”¨ cx.argument_opt å°±å¥½äº†ï¼Œå…·ä½“å‚è€ƒæˆ‘çš„ä»£ç ã€‚<br><br>å¦å¤–æˆ‘çš„è¾“å‡ºä½¿ç”¨ console.table ç¾åŒ–äº†ä¸€ä¸‹ï¼Œè¿˜å¤„ç†äº†æŸ¥è¯¢ç»“æœä¸ºç©ºçš„æƒ…å†µã€‚<br><br>webå‰ç«¯<br>https:&#47;&#47;github.com&#47;Rust-Beginner&#47;queryer&#47;blob&#47;master&#47;queryer-fed&#47;README.md<br><br>ä½œä¸ºä¸€åå‰ç«¯erï¼Œç•Œé¢æ˜¯ä¸èƒ½é©¬é©¬è™è™å“’ï¼Œç”¨æˆ·ä½“éªŒä¹Ÿè¦æœ‰ä¸€ç‚¹ï½ï½<br>å’Œè€å¸ˆçš„æ¯”èµ·æ¥ï¼Œé«˜ä¸‹ç«‹åˆ¤å“ˆå“ˆå“ˆï¼ˆå¯¹ä¸èµ·ğŸ˜‚<br>","like_count":0,"discussions":[{"author":{"id":1079375,"avatar":"https://static001.geekbang.org/account/avatar/00/10/78/4f/e74f870c.jpg","nickname":"Tyr","note":"","ucode":"EAAFC8063202E0","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":529101,"discussion_content":"ğŸ‘","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1636644090,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1098898,"avatar":"https://static001.geekbang.org/account/avatar/00/10/c4/92/338b5609.jpg","nickname":"Roy Liang","note":"","ucode":"1DF5FC831A35DA","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":412177,"discussion_content":"cloneäº†ä»£ç ï¼Œæ€ä¹ˆä½¿ç”¨å‘¢ï¼Ÿ","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1636095241,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":317761,"user_name":"ãƒ¾(â—Â°âˆ‡Â°â—)ï¾‰ï¾","can_delete":false,"product_type":"c1","uid":1044175,"ip_address":"","ucode":"89545632BDA56E","user_header":"http://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTJOBwR7MCVqwZbPA5RQ2mjUjd571jUXUcBCE7lY5vSMibWn8D5S4PzDZMaAhRPdnRBqYbVOBTJibhJg/132","comment_is_top":false,"comment_ctime":1634951202,"is_pvip":false,"replies":[{"id":"115230","content":"ä»è¯­è¨€çš„è¡¨ç°åŠ›æ¥è¯´ï¼ŒRust æ¯” java æ›´å¥½ï¼Œä½†æ€»ä½“ä»£ç é‡æ˜¯ä¸ªè·Ÿå…·ä½“å®ç°éå¸¸ç›¸å…³çš„ä¸œè¥¿ï¼Œä½ å¯ä»¥è®¤ä¸ºäºŒè€…ä»£ç é‡åœ¨ä¸€ä¸ªæ•°é‡çº§ã€‚","user_name":"ä½œè€…å›å¤","user_name_real":"Tyr","uid":"1079375","ctime":1635121461,"ip_address":"","comment_id":317761,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1634951202","product_id":100085301,"comment_content":"ä¸çŸ¥é“é‡å†™ä¸€ä¸‹DataXçš„æ•°æ®åŒæ­¥æ ¸å¿ƒéœ€è¦å¤šå°‘è¡Œä»£ç ","like_count":0,"discussions":[{"author":{"id":1079375,"avatar":"https://static001.geekbang.org/account/avatar/00/10/78/4f/e74f870c.jpg","nickname":"Tyr","note":"","ucode":"EAAFC8063202E0","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":528959,"discussion_content":"ä»è¯­è¨€çš„è¡¨ç°åŠ›æ¥è¯´ï¼ŒRust æ¯” java æ›´å¥½ï¼Œä½†æ€»ä½“ä»£ç é‡æ˜¯ä¸ªè·Ÿå…·ä½“å®ç°éå¸¸ç›¸å…³çš„ä¸œè¥¿ï¼Œä½ å¯ä»¥è®¤ä¸ºäºŒè€…ä»£ç é‡åœ¨ä¸€ä¸ªæ•°é‡çº§ã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1635121461,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":315343,"user_name":"ä¸‰å¶è™«tlb","can_delete":false,"product_type":"c1","uid":1010499,"ip_address":"","ucode":"A8236974932E6E","user_header":"https://static001.geekbang.org/account/avatar/00/0f/6b/43/b6bcab56.jpg","comment_is_top":false,"comment_ctime":1633847742,"is_pvip":false,"replies":[{"id":"114431","content":"å“ˆå“ˆä¸ç„¶æ€ä¹ˆå«é»„é‡‘çº§éš¾åº¦å‘¢ï¼Œéš¾åº¦é«˜æ‰æœ‰æŒ‘æˆ˜çš„å¿«ä¹ï¼ŒåŠ æ²¹åŠ æ²¹ğŸ’ª","user_name":"ç¼–è¾‘å›å¤","user_name_real":"å¶å¦‚èŠŠ","uid":"2547771","ctime":1634003458,"ip_address":"","comment_id":315343,"utype":2}],"discussion_count":1,"race_medal":0,"score":"1633847742","product_id":100085301,"comment_content":"è¿™èŠ‚å¥½éš¾","like_count":0,"discussions":[{"author":{"id":2547771,"avatar":"https://static001.geekbang.org/account/avatar/00/26/e0/3b/8ec916b2.jpg","nickname":"å¤šå°‘","note":"","ucode":"0A6EF7AA6E4BB7","race_medal":0,"user_type":4,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":527939,"discussion_content":"å“ˆå“ˆä¸ç„¶æ€ä¹ˆå«é»„é‡‘çº§éš¾åº¦å‘¢ï¼Œéš¾åº¦é«˜æ‰æœ‰æŒ‘æˆ˜çš„å¿«ä¹ï¼ŒåŠ æ²¹åŠ æ²¹ğŸ’ª","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1634003458,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":4}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":312772,"user_name":"è€å®äººHoney","can_delete":false,"product_type":"c1","uid":1080653,"ip_address":"","ucode":"EA4AB5C0C33090","user_header":"https://static001.geekbang.org/account/avatar/00/10/7d/4d/d98865b2.jpg","comment_is_top":false,"comment_ctime":1631980586,"is_pvip":true,"replies":[{"id":"113406","content":"ğŸ‘","user_name":"ä½œè€…å›å¤","user_name_real":"Tyr","uid":"1079375","ctime":1632240402,"ip_address":"","comment_id":312772,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1631980586","product_id":100085301,"comment_content":"ç»ˆäºè·‘é€šäº†åŸºæœ¬æ¬¾äº†<br>DataSet(shape: (8, 5)<br>+------------------+--------------+-----------+--------------+------------+<br>| name             | total_cases  | new_cases | total_deaths | new_deaths |<br>| ---              | ---          | ---       | ---          | ---        |<br>| str              | f64          | f64       | f64          | f64        |<br>+==================+==============+===========+==============+============+<br>| &quot;World&quot;          | 2.27649349e8 | 5.93099e5 | 4.679137e6   | 8881       |<br>+------------------+--------------+-----------+--------------+------------+<br>| &quot;North America&quot;  | 5.0443159e7  | 2.36269e5 | 1.025098e6   | 3151       |<br>+------------------+--------------+-----------+--------------+------------+<br>| &quot;United States&quot;  | 4.1993789e7  | 2.07886e5 | 6.72635e5    | 2635       |<br>+------------------+--------------+-----------+--------------+------------+<br>| &quot;Asia&quot;           | 7.3737284e7  | 1.90107e5 | 1.096865e6   | 2820       |<br>+------------------+--------------+-----------+--------------+------------+<br>| &quot;Europe&quot;         | 5.7839559e7  | 1.2877e5  | 1.204783e6   | 1783       |<br>+------------------+--------------+-----------+--------------+------------+<br>| &quot;European Union&quot; | 3.7314706e7  | 5.2745e4  | 7.63775e5    | 544        |<br>+------------------+--------------+-----------+--------------+------------+<br>| &quot;South America&quot;  | 3.7334191e7  | 1.9913e4  | 1.145044e6   | 654        |<br>+------------------+--------------+-----------+--------------+------------+<br>| &quot;Russia&quot;         | 7.130245e6   | 1.9589e4  | 1.93111e5    | 771        |<br>+------------------+--------------+-----------+--------------+------------+","like_count":0,"discussions":[{"author":{"id":1079375,"avatar":"https://static001.geekbang.org/account/avatar/00/10/78/4f/e74f870c.jpg","nickname":"Tyr","note":"","ucode":"EAAFC8063202E0","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":527106,"discussion_content":"ğŸ‘","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1632240402,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":312771,"user_name":"è€å®äººHoney","can_delete":false,"product_type":"c1","uid":1080653,"ip_address":"","ucode":"EA4AB5C0C33090","user_header":"https://static001.geekbang.org/account/avatar/00/10/7d/4d/d98865b2.jpg","comment_is_top":false,"comment_ctime":1631978219,"is_pvip":true,"replies":[{"id":"113405","content":"æ²¡æœ‰å…³ç³»ã€‚Rust ç¼–è¯‘å™¨ä¼šå¤„ç†ã€‚","user_name":"ä½œè€…å›å¤","user_name_real":"Tyr","uid":"1079375","ctime":1632240392,"ip_address":"","comment_id":312771,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1631978219","product_id":100085301,"comment_content":"DataSet åœ¨lib.rsï¼ŒLoadåœ¨loader.rsï¼Œlib.rså’Œloader.rså­˜åœ¨äº’ç›¸ä¾èµ–çš„å…³ç³»ï¼Œè¿™æ ·å­å¥½å—ï¼Œæœ‰ä¸ªç–‘é—®è¯·æ•™ä¸‹è€å¸ˆ","like_count":0,"discussions":[{"author":{"id":1079375,"avatar":"https://static001.geekbang.org/account/avatar/00/10/78/4f/e74f870c.jpg","nickname":"Tyr","note":"","ucode":"EAAFC8063202E0","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":527105,"discussion_content":"æ²¡æœ‰å…³ç³»ã€‚Rust ç¼–è¯‘å™¨ä¼šå¤„ç†ã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1632240392,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":311906,"user_name":"èƒ¡å°æ¶µ","can_delete":false,"product_type":"c1","uid":2004538,"ip_address":"","ucode":"2E750C65EC282C","user_header":"https://static001.geekbang.org/account/avatar/00/1e/96/3a/e06f8367.jpg","comment_is_top":false,"comment_ctime":1631527473,"is_pvip":false,"replies":[{"id":"113013","content":"åŸºç¡€è¯­æ³•åé¢ä¼šè®²ï¼Œä½†æ˜¯å¦‚æœæ³›è®²å°±æ²¡å•¥æ„æ€äº†ï¼Œè¯­æ³•çš„ç†è§£é‡éš¾ç‚¹ä¼šæ˜¯è¯¾ç¨‹çš„é‡ç‚¹ï¼Œæ‰€ä»¥å­¦åˆ°å…·ä½“è¯­æ³•çš„æ—¶å€™ï¼Œä¹Ÿæ¨èæ­é…åŠ é¤é‡Œçš„åŸºç¡€èµ„æ–™æ¥å­¦ä¹ å’Œç»ƒä¹ ã€‚","user_name":"ç¼–è¾‘å›å¤","user_name_real":"å¶å¦‚èŠŠ","uid":"2547771","ctime":1631531535,"ip_address":"","comment_id":311906,"utype":2}],"discussion_count":1,"race_medal":0,"score":"1631527473","product_id":100085301,"comment_content":"ç¬¬ä¸€æ¬¡å­¦ï¼Œç›´æ¥ä¸Šä¸‰ç›˜ç¡¬èœï¼ŒçœŸçš„å¾ˆæ‡µé€¼ã€‚ã€‚ã€‚è¯·é—®åŸºæœ¬çš„è¯­æ³•åé¢è¿˜ä¼šæ¶µç›–å˜›ï¼Ÿè¿˜éœ€ä¸éœ€è¦æ‰¾å…¶ä»–èµ„æ–™è¡¥ä¸‹åŸºæœ¬è¯­æ³•ï¼Ÿ","like_count":0,"discussions":[{"author":{"id":2547771,"avatar":"https://static001.geekbang.org/account/avatar/00/26/e0/3b/8ec916b2.jpg","nickname":"å¤šå°‘","note":"","ucode":"0A6EF7AA6E4BB7","race_medal":0,"user_type":4,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":526790,"discussion_content":"åŸºç¡€è¯­æ³•åé¢ä¼šè®²ï¼Œä½†æ˜¯å¦‚æœæ³›è®²å°±æ²¡å•¥æ„æ€äº†ï¼Œè¯­æ³•çš„ç†è§£é‡éš¾ç‚¹ä¼šæ˜¯è¯¾ç¨‹çš„é‡ç‚¹ï¼Œæ‰€ä»¥å­¦åˆ°å…·ä½“è¯­æ³•çš„æ—¶å€™ï¼Œä¹Ÿæ¨èæ­é…åŠ é¤é‡Œçš„åŸºç¡€èµ„æ–™æ¥å­¦ä¹ å’Œç»ƒä¹ ã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1631531535,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":4}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":311125,"user_name":"cool~doudouğŸ’¯","can_delete":false,"product_type":"c1","uid":1019392,"ip_address":"","ucode":"B4F0E04C86EDB4","user_header":"https://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTJCoNOgDmxPbMHmttcSa0LJShp2x4PkvAJw4eicvmUK487lPJZlDbhDbDtBcA49YBDQt9VMlvdqd7Q/132","comment_is_top":false,"comment_ctime":1631081371,"is_pvip":false,"replies":[{"id":"112750","content":"å“ˆå“ˆå“ˆ","user_name":"ç¼–è¾‘å›å¤","user_name_real":"å¶å¦‚èŠŠ","uid":"2547771","ctime":1631081671,"ip_address":"","comment_id":311125,"utype":2}],"discussion_count":1,"race_medal":0,"score":"1631081371","product_id":100085301,"comment_content":"æˆ‘æ“¦ï¼Œè€å¸ˆå¥½ï¼Œæˆ‘åœ¨å¬è¯¾çš„æ—¶å€™å‘ç°ï¼Œè¿™ä¸ªå£°éŸ³ä¸ºå•¥è¿™ä¹ˆç†Ÿæ‚‰ï¼Œä»”ç»†ä¸€æƒ³åŸæ¥æˆ‘åœ¨æ²¹ç®¡ä¸Šçœ‹è€å¸ˆçš„rustè¯¾ç¨‹ï¼Œçœ‹äº†ä¸‰éï¼Œé‚£å‡ å¤©å…¨æ˜¯è¿™ä¸ªå£°éŸ³åœ¨è„‘å­é‡Œ ï¼Œ è¿™ä¸ªå£°éŸ³æˆ‘éƒ½å¿«é­”æ–äº†","like_count":0,"discussions":[{"author":{"id":2547771,"avatar":"https://static001.geekbang.org/account/avatar/00/26/e0/3b/8ec916b2.jpg","nickname":"å¤šå°‘","note":"","ucode":"0A6EF7AA6E4BB7","race_medal":0,"user_type":4,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":526482,"discussion_content":"å“ˆå“ˆå“ˆ","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1631081671,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":4}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":310864,"user_name":"Geek_be0d87","can_delete":false,"product_type":"c1","uid":2192311,"ip_address":"","ucode":"8259B623EEDCC6","user_header":"https://thirdwx.qlogo.cn/mmopen/vi_32/bqWMox7TsotHiapiaEbJG6YKLfOqYib1b65oW5FA2qiboazIjfSia3VdP90aMKtg3qsibIviaRsYSp9aFia2hYEqgumibug/132","comment_is_top":false,"comment_ctime":1630938538,"is_pvip":false,"replies":[{"id":"112656","content":"å“ˆå“ˆï¼Œè°¢è°¢åšçˆ±ã€‚ç°åœ¨æˆ‘å…ˆæŠŠè¿™é—¨è¯¾åšå¥½ã€‚","user_name":"ä½œè€…å›å¤","user_name_real":"Tyr","uid":"1079375","ctime":1630951205,"ip_address":"","comment_id":310864,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1630938538","product_id":100085301,"comment_content":"è€å¸ˆ å†å¼€ä¸ªç¨‹åºè®¾è®¡çš„è¯¾å§","like_count":0,"discussions":[{"author":{"id":1079375,"avatar":"https://static001.geekbang.org/account/avatar/00/10/78/4f/e74f870c.jpg","nickname":"Tyr","note":"","ucode":"EAAFC8063202E0","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":526380,"discussion_content":"å“ˆå“ˆï¼Œè°¢è°¢åšçˆ±ã€‚ç°åœ¨æˆ‘å…ˆæŠŠè¿™é—¨è¯¾åšå¥½ã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1630951205,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":310469,"user_name":"Akon Convict","can_delete":false,"product_type":"c1","uid":1044453,"ip_address":"","ucode":"364E1CA9F347C7","user_header":"https://static001.geekbang.org/account/avatar/00/0f/ef/e5/7ee97c9a.jpg","comment_is_top":false,"comment_ctime":1630665030,"is_pvip":true,"replies":[{"id":"112484","content":"å°±æ˜¯è¦è¿™ä¸ªéœ‡æ’¼çš„æ•ˆæœï¼ˆå¼€ç©ç¬‘ğŸ˜ï¼‰ç°åœ¨å¤§å®¶éƒ½ä¸å¤ªç†è§£è¯­æ³•ï¼Œéƒ½åœ¨ä¸€ä¸ªå­—ä¸€ä¸ªå­—æŠ„å†™ä»£ç ï¼Œï¼ˆå½“ç„¶ä¹‹å‰å­¦è¿‡ä¸€äº›çš„å¤§ä½¬ä¼šåœ¨ç•™è¨€åŒºåˆ†äº«ä½œä¸šï¼‰æ‰€ä»¥ä¸ç†è§£éå¸¸æ­£å¸¸ï¼Œä¹Ÿä¸è¦æ‹…å¿ƒï¼Œåé¢éƒ½ä¼šè®²åˆ°ã€‚è¿™å‘¨çš„æŒ‘æˆ˜ç›®æ ‡å¾ˆç®€å•ï¼Œè¿è¡Œå‡ºæ¥ï¼Œå°±è¾¾æ ‡äº†ã€‚","user_name":"ç¼–è¾‘å›å¤","user_name_real":"å¶å¦‚èŠŠ","uid":"2547771","ctime":1630686710,"ip_address":"","comment_id":310469,"utype":2}],"discussion_count":1,"race_medal":0,"score":"1630665030","product_id":100085301,"comment_content":"è¿™ä¸€å †ç‰¹æ€§åŸºæœ¬ä¸Šçœ‹æ‡µäº†ã€‚","like_count":0,"discussions":[{"author":{"id":2547771,"avatar":"https://static001.geekbang.org/account/avatar/00/26/e0/3b/8ec916b2.jpg","nickname":"å¤šå°‘","note":"","ucode":"0A6EF7AA6E4BB7","race_medal":0,"user_type":4,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":526245,"discussion_content":"å°±æ˜¯è¦è¿™ä¸ªéœ‡æ’¼çš„æ•ˆæœï¼ˆå¼€ç©ç¬‘ğŸ˜ï¼‰ç°åœ¨å¤§å®¶éƒ½ä¸å¤ªç†è§£è¯­æ³•ï¼Œéƒ½åœ¨ä¸€ä¸ªå­—ä¸€ä¸ªå­—æŠ„å†™ä»£ç ï¼Œï¼ˆå½“ç„¶ä¹‹å‰å­¦è¿‡ä¸€äº›çš„å¤§ä½¬ä¼šåœ¨ç•™è¨€åŒºåˆ†äº«ä½œä¸šï¼‰æ‰€ä»¥ä¸ç†è§£éå¸¸æ­£å¸¸ï¼Œä¹Ÿä¸è¦æ‹…å¿ƒï¼Œåé¢éƒ½ä¼šè®²åˆ°ã€‚è¿™å‘¨çš„æŒ‘æˆ˜ç›®æ ‡å¾ˆç®€å•ï¼Œè¿è¡Œå‡ºæ¥ï¼Œå°±è¾¾æ ‡äº†ã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1630686710,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":4}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":310420,"user_name":"lwx","can_delete":false,"product_type":"c1","uid":1438618,"ip_address":"","ucode":"4ECE8D7662884A","user_header":"https://thirdwx.qlogo.cn/mmopen/vi_32/0tOImISYW8gQfsjAneCdic5B0lLLmmyicQyAaD3pDG9K0vzQBL8FG2hF0pY30035mcic7ftYgjpKDeb5mIH2QHepA/132","comment_is_top":false,"comment_ctime":1630648992,"is_pvip":false,"replies":[{"id":"112482","content":"å¤šè¯»å¤šå†™å¤šæ€è€ƒï¼Œä½ ä¹Ÿå¯ä»¥è¶Šæ¥è¶Šç‰›é€¼ :)","user_name":"ä½œè€…å›å¤","user_name_real":"Tyr","uid":"1079375","ctime":1630684125,"ip_address":"","comment_id":310420,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1630648992","product_id":100085301,"comment_content":"çœ‹å®Œåªæœ‰ä¸€ä¸ªæ„Ÿè§‰ï¼Œå¤©å“¥ç‰›é€¼","like_count":0,"discussions":[{"author":{"id":1079375,"avatar":"https://static001.geekbang.org/account/avatar/00/10/78/4f/e74f870c.jpg","nickname":"Tyr","note":"","ucode":"EAAFC8063202E0","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":526231,"discussion_content":"å¤šè¯»å¤šå†™å¤šæ€è€ƒï¼Œä½ ä¹Ÿå¯ä»¥è¶Šæ¥è¶Šç‰›é€¼ :)","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1630684125,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]}]}