{"id":65287,"title":"33 | æ·±å…¥è§£æå®¹å™¨è·¨ä¸»æœºç½‘ç»œ","content":"<p>ä½ å¥½ï¼Œæˆ‘æ˜¯å¼ ç£Šã€‚ä»Šå¤©æˆ‘å’Œä½ åˆ†äº«çš„ä¸»é¢˜æ˜¯ï¼šæ·±å…¥è§£æå®¹å™¨è·¨ä¸»æœºç½‘ç»œã€‚</p><p>åœ¨ä¸Šä¸€ç¯‡æ–‡ç« ä¸­ï¼Œæˆ‘ä¸ºä½ è¯¦ç»†è®²è§£äº†åœ¨å•æœºç¯å¢ƒä¸‹ï¼ŒLinuxå®¹å™¨ç½‘ç»œçš„å®ç°åŸç†ï¼ˆç½‘æ¡¥æ¨¡å¼ï¼‰ã€‚å¹¶ä¸”æåˆ°äº†ï¼Œåœ¨Dockerçš„é»˜è®¤é…ç½®ä¸‹ï¼Œä¸åŒå®¿ä¸»æœºä¸Šçš„å®¹å™¨é€šè¿‡IPåœ°å€è¿›è¡Œäº’ç›¸è®¿é—®æ˜¯æ ¹æœ¬åšä¸åˆ°çš„ã€‚</p><p>è€Œæ­£æ˜¯ä¸ºäº†è§£å†³è¿™ä¸ªå®¹å™¨â€œè·¨ä¸»é€šä¿¡â€çš„é—®é¢˜ï¼Œç¤¾åŒºé‡Œæ‰å‡ºç°äº†é‚£ä¹ˆå¤šçš„å®¹å™¨ç½‘ç»œæ–¹æ¡ˆã€‚è€Œä¸”ï¼Œç›¸ä¿¡ä½ ä¸€ç›´ä»¥æ¥éƒ½æœ‰è¿™æ ·çš„ç–‘é—®ï¼šè¿™äº›ç½‘ç»œæ–¹æ¡ˆçš„å·¥ä½œåŸç†åˆ°åº•æ˜¯ä»€ä¹ˆï¼Ÿ</p><p>è¦ç†è§£å®¹å™¨â€œè·¨ä¸»é€šä¿¡â€çš„åŸç†ï¼Œå°±ä¸€å®šè¦å…ˆä»Flannelè¿™ä¸ªé¡¹ç›®è¯´èµ·ã€‚</p><p>Flannelé¡¹ç›®æ˜¯CoreOSå…¬å¸ä¸»æ¨çš„å®¹å™¨ç½‘ç»œæ–¹æ¡ˆã€‚äº‹å®ä¸Šï¼ŒFlannelé¡¹ç›®æœ¬èº«åªæ˜¯ä¸€ä¸ªæ¡†æ¶ï¼ŒçœŸæ­£ä¸ºæˆ‘ä»¬æä¾›å®¹å™¨ç½‘ç»œåŠŸèƒ½çš„ï¼Œæ˜¯Flannelçš„åç«¯å®ç°ã€‚ç›®å‰ï¼ŒFlannelæ”¯æŒä¸‰ç§åç«¯å®ç°ï¼Œåˆ†åˆ«æ˜¯ï¼š</p><ol>\n<li>\n<p>VXLANï¼›</p>\n</li>\n<li>\n<p>host-gwï¼›</p>\n</li>\n<li>\n<p>UDPã€‚</p>\n</li>\n</ol><p>è¿™ä¸‰ç§ä¸åŒçš„åç«¯å®ç°ï¼Œæ­£ä»£è¡¨äº†ä¸‰ç§å®¹å™¨è·¨ä¸»ç½‘ç»œçš„ä¸»æµå®ç°æ–¹æ³•ã€‚å…¶ä¸­ï¼Œhost-gwæ¨¡å¼ï¼Œæˆ‘ä¼šåœ¨ä¸‹ä¸€ç¯‡æ–‡ç« ä¸­å†åšè¯¦ç»†ä»‹ç»ã€‚</p><p>è€ŒUDPæ¨¡å¼ï¼Œæ˜¯Flannelé¡¹ç›®æœ€æ—©æ”¯æŒçš„ä¸€ç§æ–¹å¼ï¼Œå´ä¹Ÿæ˜¯æ€§èƒ½æœ€å·®çš„ä¸€ç§æ–¹å¼ã€‚æ‰€ä»¥ï¼Œè¿™ä¸ªæ¨¡å¼ç›®å‰å·²ç»è¢«å¼ƒç”¨ã€‚ä¸è¿‡ï¼ŒFlannelä¹‹æ‰€ä»¥æœ€å…ˆé€‰æ‹©UDPæ¨¡å¼ï¼Œå°±æ˜¯å› ä¸ºè¿™ç§æ¨¡å¼æ˜¯æœ€ç›´æ¥ã€ä¹Ÿæ˜¯æœ€å®¹æ˜“ç†è§£çš„å®¹å™¨è·¨ä¸»ç½‘ç»œå®ç°ã€‚</p><!-- [[[read_end]]] --><p>æ‰€ä»¥ï¼Œåœ¨ä»Šå¤©è¿™ç¯‡æ–‡ç« ä¸­ï¼Œ<span class=\"orange\">æˆ‘ä¼šå…ˆä»UDPæ¨¡å¼å¼€å§‹ï¼Œæ¥ä¸ºä½ è®²è§£å®¹å™¨â€œè·¨ä¸»ç½‘ç»œâ€çš„å®ç°åŸç†ã€‚</span></p><p>åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œæˆ‘æœ‰ä¸¤å°å®¿ä¸»æœºã€‚</p><ul>\n<li>å®¿ä¸»æœºNode 1ä¸Šæœ‰ä¸€ä¸ªå®¹å™¨container-1ï¼Œå®ƒçš„IPåœ°å€æ˜¯100.96.1.2ï¼Œå¯¹åº”çš„docker0ç½‘æ¡¥çš„åœ°å€æ˜¯ï¼š100.96.1.1/24ã€‚</li>\n<li>å®¿ä¸»æœºNode 2ä¸Šæœ‰ä¸€ä¸ªå®¹å™¨container-2ï¼Œå®ƒçš„IPåœ°å€æ˜¯100.96.2.3ï¼Œå¯¹åº”çš„docker0ç½‘æ¡¥çš„åœ°å€æ˜¯ï¼š100.96.2.1/24ã€‚</li>\n</ul><p>æˆ‘ä»¬ç°åœ¨çš„ä»»åŠ¡ï¼Œå°±æ˜¯è®©container-1è®¿é—®container-2ã€‚</p><p>è¿™ç§æƒ…å†µä¸‹ï¼Œcontainer-1å®¹å™¨é‡Œçš„è¿›ç¨‹å‘èµ·çš„IPåŒ…ï¼Œå…¶æºåœ°å€å°±æ˜¯100.96.1.2ï¼Œç›®çš„åœ°å€å°±æ˜¯100.96.2.3ã€‚ç”±äºç›®çš„åœ°å€100.96.2.3å¹¶ä¸åœ¨Node 1çš„docker0ç½‘æ¡¥çš„ç½‘æ®µé‡Œï¼Œæ‰€ä»¥è¿™ä¸ªIPåŒ…ä¼šè¢«äº¤ç»™é»˜è®¤è·¯ç”±è§„åˆ™ï¼Œé€šè¿‡å®¹å™¨çš„ç½‘å…³è¿›å…¥docker0ç½‘æ¡¥ï¼ˆå¦‚æœæ˜¯åŒä¸€å°å®¿ä¸»æœºä¸Šçš„å®¹å™¨é—´é€šä¿¡ï¼Œèµ°çš„æ˜¯ç›´è¿è§„åˆ™ï¼‰ï¼Œä»è€Œå‡ºç°åœ¨å®¿ä¸»æœºä¸Šã€‚</p><p>è¿™æ—¶å€™ï¼Œè¿™ä¸ªIPåŒ…çš„ä¸‹ä¸€ä¸ªç›®çš„åœ°ï¼Œå°±å–å†³äºå®¿ä¸»æœºä¸Šçš„è·¯ç”±è§„åˆ™äº†ã€‚æ­¤æ—¶ï¼ŒFlannelå·²ç»åœ¨å®¿ä¸»æœºä¸Šåˆ›å»ºå‡ºäº†ä¸€ç³»åˆ—çš„è·¯ç”±è§„åˆ™ï¼Œä»¥Node 1ä¸ºä¾‹ï¼Œå¦‚ä¸‹æ‰€ç¤ºï¼š</p><pre><code># åœ¨Node 1ä¸Š\n$ ip route\ndefault via 10.168.0.1 dev eth0\n100.96.0.0/16 dev flannel0  proto kernel  scope link  src 100.96.1.0\n100.96.1.0/24 dev docker0  proto kernel  scope link  src 100.96.1.1\n10.168.0.0/24 dev eth0  proto kernel  scope link  src 10.168.0.2\n</code></pre><p>å¯ä»¥çœ‹åˆ°ï¼Œç”±äºæˆ‘ä»¬çš„IPåŒ…çš„ç›®çš„åœ°å€æ˜¯100.96.2.3ï¼Œå®ƒåŒ¹é…ä¸åˆ°æœ¬æœºdocker0ç½‘æ¡¥å¯¹åº”çš„100.96.1.0/24ç½‘æ®µï¼Œåªèƒ½åŒ¹é…åˆ°ç¬¬äºŒæ¡ã€ä¹Ÿå°±æ˜¯100.96.0.0/16å¯¹åº”çš„è¿™æ¡è·¯ç”±è§„åˆ™ï¼Œä»è€Œè¿›å…¥åˆ°ä¸€ä¸ªå«ä½œflannel0çš„è®¾å¤‡ä¸­ã€‚</p><p>è€Œè¿™ä¸ªflannel0è®¾å¤‡çš„ç±»å‹å°±æ¯”è¾ƒæœ‰æ„æ€äº†ï¼šå®ƒæ˜¯ä¸€ä¸ªTUNè®¾å¤‡ï¼ˆTunnelè®¾å¤‡ï¼‰ã€‚</p><p>åœ¨Linuxä¸­ï¼ŒTUNè®¾å¤‡æ˜¯ä¸€ç§å·¥ä½œåœ¨ä¸‰å±‚ï¼ˆNetwork Layerï¼‰çš„è™šæ‹Ÿç½‘ç»œè®¾å¤‡ã€‚TUNè®¾å¤‡çš„åŠŸèƒ½éå¸¸ç®€å•ï¼Œå³ï¼š<strong>åœ¨æ“ä½œç³»ç»Ÿå†…æ ¸å’Œç”¨æˆ·åº”ç”¨ç¨‹åºä¹‹é—´ä¼ é€’IPåŒ…ã€‚</strong></p><p>ä»¥flannel0è®¾å¤‡ä¸ºä¾‹ï¼šåƒä¸Šé¢æåˆ°çš„æƒ…å†µï¼Œå½“æ“ä½œç³»ç»Ÿå°†ä¸€ä¸ªIPåŒ…å‘é€ç»™flannel0è®¾å¤‡ä¹‹åï¼Œflannel0å°±ä¼šæŠŠè¿™ä¸ªIPåŒ…ï¼Œäº¤ç»™åˆ›å»ºè¿™ä¸ªè®¾å¤‡çš„åº”ç”¨ç¨‹åºï¼Œä¹Ÿå°±æ˜¯Flannelè¿›ç¨‹ã€‚è¿™æ˜¯ä¸€ä¸ªä»å†…æ ¸æ€ï¼ˆLinuxæ“ä½œç³»ç»Ÿï¼‰å‘ç”¨æˆ·æ€ï¼ˆFlannelè¿›ç¨‹ï¼‰çš„æµåŠ¨æ–¹å‘ã€‚</p><p>åä¹‹ï¼Œå¦‚æœFlannelè¿›ç¨‹å‘flannel0è®¾å¤‡å‘é€äº†ä¸€ä¸ªIPåŒ…ï¼Œé‚£ä¹ˆè¿™ä¸ªIPåŒ…å°±ä¼šå‡ºç°åœ¨å®¿ä¸»æœºç½‘ç»œæ ˆä¸­ï¼Œç„¶åæ ¹æ®å®¿ä¸»æœºçš„è·¯ç”±è¡¨è¿›è¡Œä¸‹ä¸€æ­¥å¤„ç†ã€‚è¿™æ˜¯ä¸€ä¸ªä»ç”¨æˆ·æ€å‘å†…æ ¸æ€çš„æµåŠ¨æ–¹å‘ã€‚</p><p>æ‰€ä»¥ï¼Œå½“IPåŒ…ä»å®¹å™¨ç»è¿‡docker0å‡ºç°åœ¨å®¿ä¸»æœºï¼Œç„¶ååˆæ ¹æ®è·¯ç”±è¡¨è¿›å…¥flannel0è®¾å¤‡åï¼Œå®¿ä¸»æœºä¸Šçš„flanneldè¿›ç¨‹ï¼ˆFlannelé¡¹ç›®åœ¨æ¯ä¸ªå®¿ä¸»æœºä¸Šçš„ä¸»è¿›ç¨‹ï¼‰ï¼Œå°±ä¼šæ”¶åˆ°è¿™ä¸ªIPåŒ…ã€‚ç„¶åï¼Œflanneldçœ‹åˆ°äº†è¿™ä¸ªIPåŒ…çš„ç›®çš„åœ°å€ï¼Œæ˜¯100.96.2.3ï¼Œå°±æŠŠå®ƒå‘é€ç»™äº†Node 2å®¿ä¸»æœºã€‚</p><p>ç­‰ä¸€ä¸‹ï¼Œ<strong>flanneldåˆæ˜¯å¦‚ä½•çŸ¥é“è¿™ä¸ªIPåœ°å€å¯¹åº”çš„å®¹å™¨ï¼Œæ˜¯è¿è¡Œåœ¨Node 2ä¸Šçš„å‘¢ï¼Ÿ</strong></p><p>è¿™é‡Œï¼Œå°±ç”¨åˆ°äº†Flannelé¡¹ç›®é‡Œä¸€ä¸ªéå¸¸é‡è¦çš„æ¦‚å¿µï¼šå­ç½‘ï¼ˆSubnetï¼‰ã€‚</p><p>äº‹å®ä¸Šï¼Œåœ¨ç”±Flannelç®¡ç†çš„å®¹å™¨ç½‘ç»œé‡Œï¼Œä¸€å°å®¿ä¸»æœºä¸Šçš„æ‰€æœ‰å®¹å™¨ï¼Œéƒ½å±äºè¯¥å®¿ä¸»æœºè¢«åˆ†é…çš„ä¸€ä¸ªâ€œå­ç½‘â€ã€‚åœ¨æˆ‘ä»¬çš„ä¾‹å­ä¸­ï¼ŒNode 1çš„å­ç½‘æ˜¯100.96.1.0/24ï¼Œcontainer-1çš„IPåœ°å€æ˜¯100.96.1.2ã€‚Node 2çš„å­ç½‘æ˜¯100.96.2.0/24ï¼Œcontainer-2çš„IPåœ°å€æ˜¯100.96.2.3ã€‚</p><p>è€Œè¿™äº›å­ç½‘ä¸å®¿ä¸»æœºçš„å¯¹åº”å…³ç³»ï¼Œæ­£æ˜¯ä¿å­˜åœ¨Etcdå½“ä¸­ï¼Œå¦‚ä¸‹æ‰€ç¤ºï¼š</p><pre><code>$ etcdctl ls /coreos.com/network/subnets\n/coreos.com/network/subnets/100.96.1.0-24\n/coreos.com/network/subnets/100.96.2.0-24\n/coreos.com/network/subnets/100.96.3.0-24\n</code></pre><p>æ‰€ä»¥ï¼Œflanneldè¿›ç¨‹åœ¨å¤„ç†ç”±flannel0ä¼ å…¥çš„IPåŒ…æ—¶ï¼Œå°±å¯ä»¥æ ¹æ®ç›®çš„IPçš„åœ°å€ï¼ˆæ¯”å¦‚100.96.2.3ï¼‰ï¼ŒåŒ¹é…åˆ°å¯¹åº”çš„å­ç½‘ï¼ˆæ¯”å¦‚100.96.2.0/24ï¼‰ï¼Œä»Etcdä¸­æ‰¾åˆ°è¿™ä¸ªå­ç½‘å¯¹åº”çš„å®¿ä¸»æœºçš„IPåœ°å€æ˜¯10.168.0.3ï¼Œå¦‚ä¸‹æ‰€ç¤ºï¼š</p><pre><code>$ etcdctl get /coreos.com/network/subnets/100.96.2.0-24\n{&quot;PublicIP&quot;:&quot;10.168.0.3&quot;}\n</code></pre><p>è€Œå¯¹äºflanneldæ¥è¯´ï¼Œåªè¦Node 1å’ŒNode 2æ˜¯äº’é€šçš„ï¼Œé‚£ä¹ˆflanneldä½œä¸ºNode 1ä¸Šçš„ä¸€ä¸ªæ™®é€šè¿›ç¨‹ï¼Œå°±ä¸€å®šå¯ä»¥é€šè¿‡ä¸Šè¿°IPåœ°å€ï¼ˆ10.168.0.3ï¼‰è®¿é—®åˆ°Node 2ï¼Œè¿™æ²¡æœ‰ä»»ä½•é—®é¢˜ã€‚</p><p>æ‰€ä»¥è¯´ï¼Œflanneldåœ¨æ”¶åˆ°container-1å‘ç»™container-2çš„IPåŒ…ä¹‹åï¼Œå°±ä¼šæŠŠè¿™ä¸ªIPåŒ…ç›´æ¥å°è£…åœ¨ä¸€ä¸ªUDPåŒ…é‡Œï¼Œç„¶åå‘é€ç»™Node 2ã€‚ä¸éš¾ç†è§£ï¼Œè¿™ä¸ªUDPåŒ…çš„æºåœ°å€ï¼Œå°±æ˜¯flanneldæ‰€åœ¨çš„Node 1çš„åœ°å€ï¼Œè€Œç›®çš„åœ°å€ï¼Œåˆ™æ˜¯container-2æ‰€åœ¨çš„å®¿ä¸»æœºNode 2çš„åœ°å€ã€‚</p><p>å½“ç„¶ï¼Œè¿™ä¸ªè¯·æ±‚å¾—ä»¥å®Œæˆçš„åŸå› æ˜¯ï¼Œæ¯å°å®¿ä¸»æœºä¸Šçš„flanneldï¼Œéƒ½ç›‘å¬ç€ä¸€ä¸ª8285ç«¯å£ï¼Œæ‰€ä»¥flanneldåªè¦æŠŠUDPåŒ…å‘å¾€Node 2çš„8285ç«¯å£å³å¯ã€‚</p><p>é€šè¿‡è¿™æ ·ä¸€ä¸ªæ™®é€šçš„ã€å®¿ä¸»æœºä¹‹é—´çš„UDPé€šä¿¡ï¼Œä¸€ä¸ªUDPåŒ…å°±ä»Node 1åˆ°è¾¾äº†Node 2ã€‚è€ŒNode 2ä¸Šç›‘å¬8285ç«¯å£çš„è¿›ç¨‹ä¹Ÿæ˜¯flanneldï¼Œæ‰€ä»¥è¿™æ—¶å€™ï¼Œflanneldå°±å¯ä»¥ä»è¿™ä¸ªUDPåŒ…é‡Œè§£æå‡ºå°è£…åœ¨é‡Œé¢çš„ã€container-1å‘æ¥çš„åŸIPåŒ…ã€‚</p><p>è€Œæ¥ä¸‹æ¥flanneldçš„å·¥ä½œå°±éå¸¸ç®€å•äº†ï¼šflanneldä¼šç›´æ¥æŠŠè¿™ä¸ªIPåŒ…å‘é€ç»™å®ƒæ‰€ç®¡ç†çš„TUNè®¾å¤‡ï¼Œå³flannel0è®¾å¤‡ã€‚</p><p>æ ¹æ®æˆ‘å‰é¢è®²è§£çš„TUNè®¾å¤‡çš„åŸç†ï¼Œè¿™æ­£æ˜¯ä¸€ä¸ªä»ç”¨æˆ·æ€å‘å†…æ ¸æ€çš„æµåŠ¨æ–¹å‘ï¼ˆFlannelè¿›ç¨‹å‘TUNè®¾å¤‡å‘é€æ•°æ®åŒ…ï¼‰ï¼Œæ‰€ä»¥Linuxå†…æ ¸ç½‘ç»œæ ˆå°±ä¼šè´Ÿè´£å¤„ç†è¿™ä¸ªIPåŒ…ï¼Œå…·ä½“çš„å¤„ç†æ–¹æ³•ï¼Œå°±æ˜¯é€šè¿‡æœ¬æœºçš„è·¯ç”±è¡¨æ¥å¯»æ‰¾è¿™ä¸ªIPåŒ…çš„ä¸‹ä¸€æ­¥æµå‘ã€‚</p><p>è€ŒNode 2ä¸Šçš„è·¯ç”±è¡¨ï¼Œè·ŸNode 1éå¸¸ç±»ä¼¼ï¼Œå¦‚ä¸‹æ‰€ç¤ºï¼š</p><pre><code># åœ¨Node 2ä¸Š\n$ ip route\ndefault via 10.168.0.1 dev eth0\n100.96.0.0/16 dev flannel0  proto kernel  scope link  src 100.96.2.0\n100.96.2.0/24 dev docker0  proto kernel  scope link  src 100.96.2.1\n10.168.0.0/24 dev eth0  proto kernel  scope link  src 10.168.0.3\n</code></pre><p>ç”±äºè¿™ä¸ªIPåŒ…çš„ç›®çš„åœ°å€æ˜¯100.96.2.3ï¼Œå®ƒè·Ÿç¬¬ä¸‰æ¡ã€ä¹Ÿå°±æ˜¯100.96.2.0/24ç½‘æ®µå¯¹åº”çš„è·¯ç”±è§„åˆ™åŒ¹é…æ›´åŠ ç²¾ç¡®ã€‚æ‰€ä»¥ï¼ŒLinuxå†…æ ¸å°±ä¼šæŒ‰ç…§è¿™æ¡è·¯ç”±è§„åˆ™ï¼ŒæŠŠè¿™ä¸ªIPåŒ…è½¬å‘ç»™docker0ç½‘æ¡¥ã€‚</p><p>æ¥ä¸‹æ¥çš„æµç¨‹ï¼Œå°±å¦‚åŒæˆ‘åœ¨ä¸Šä¸€ç¯‡æ–‡ç« <a href=\"https://time.geekbang.org/column/article/64948\">ã€Šæµ…è°ˆå®¹å™¨ç½‘ç»œã€‹</a>ä¸­å’Œä½ åˆ†äº«çš„é‚£æ ·ï¼Œdocker0ç½‘æ¡¥ä¼šæ‰®æ¼”äºŒå±‚äº¤æ¢æœºçš„è§’è‰²ï¼Œå°†æ•°æ®åŒ…å‘é€ç»™æ­£ç¡®çš„ç«¯å£ï¼Œè¿›è€Œé€šè¿‡Veth Pairè®¾å¤‡è¿›å…¥åˆ°container-2çš„Network Namespaceé‡Œã€‚</p><p>è€Œcontainer-2è¿”å›ç»™container-1çš„æ•°æ®åŒ…ï¼Œåˆ™ä¼šç»è¿‡ä¸ä¸Šè¿°è¿‡ç¨‹å®Œå…¨ç›¸åçš„è·¯å¾„å›åˆ°container-1ä¸­ã€‚</p><p>éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œä¸Šè¿°æµç¨‹è¦æ­£ç¡®å·¥ä½œè¿˜æœ‰ä¸€ä¸ªé‡è¦çš„å‰æï¼Œé‚£å°±æ˜¯docker0ç½‘æ¡¥çš„åœ°å€èŒƒå›´å¿…é¡»æ˜¯Flannelä¸ºå®¿ä¸»æœºåˆ†é…çš„å­ç½‘ã€‚è¿™ä¸ªå¾ˆå®¹æ˜“å®ç°ï¼Œä»¥Node 1ä¸ºä¾‹ï¼Œä½ åªéœ€è¦ç»™å®ƒä¸Šé¢çš„Docker Daemonå¯åŠ¨æ—¶é…ç½®å¦‚ä¸‹æ‰€ç¤ºçš„bipå‚æ•°å³å¯ï¼š</p><pre><code>$ FLANNEL_SUBNET=100.96.1.1/24\n$ dockerd --bip=$FLANNEL_SUBNET ...\n</code></pre><p>ä»¥ä¸Šï¼Œå°±æ˜¯åŸºäºFlannel UDPæ¨¡å¼çš„è·¨ä¸»é€šä¿¡çš„åŸºæœ¬åŸç†äº†ã€‚æˆ‘æŠŠå®ƒæ€»ç»“æˆäº†ä¸€å¹…åŸç†å›¾ï¼Œå¦‚ä¸‹æ‰€ç¤ºã€‚</p><p><img src=\"https://static001.geekbang.org/resource/image/83/6c/8332564c0547bf46d1fbba2a1e0e166c.jpg?wh=1857*878\" alt=\"\" title=\"å›¾1 åŸºäºFlannel UDPæ¨¡å¼çš„è·¨ä¸»é€šä¿¡çš„åŸºæœ¬åŸç†\"></p><p>å¯ä»¥çœ‹åˆ°ï¼ŒFlannel UDPæ¨¡å¼æä¾›çš„å…¶å®æ˜¯ä¸€ä¸ªä¸‰å±‚çš„Overlayç½‘ç»œï¼Œå³ï¼šå®ƒé¦–å…ˆå¯¹å‘å‡ºç«¯çš„IPåŒ…è¿›è¡ŒUDPå°è£…ï¼Œç„¶ååœ¨æ¥æ”¶ç«¯è¿›è¡Œè§£å°è£…æ‹¿åˆ°åŸå§‹çš„IPåŒ…ï¼Œè¿›è€ŒæŠŠè¿™ä¸ªIPåŒ…è½¬å‘ç»™ç›®æ ‡å®¹å™¨ã€‚è¿™å°±å¥½æ¯”ï¼ŒFlannelåœ¨ä¸åŒå®¿ä¸»æœºä¸Šçš„ä¸¤ä¸ªå®¹å™¨ä¹‹é—´æ‰“é€šäº†ä¸€æ¡â€œéš§é“â€ï¼Œä½¿å¾—è¿™ä¸¤ä¸ªå®¹å™¨å¯ä»¥ç›´æ¥ä½¿ç”¨IPåœ°å€è¿›è¡Œé€šä¿¡ï¼Œè€Œæ— éœ€å…³å¿ƒå®¹å™¨å’Œå®¿ä¸»æœºçš„åˆ†å¸ƒæƒ…å†µã€‚</p><p>æˆ‘å‰é¢æ›¾ç»æåˆ°ï¼Œä¸Šè¿°UDPæ¨¡å¼æœ‰ä¸¥é‡çš„æ€§èƒ½é—®é¢˜ï¼Œæ‰€ä»¥å·²ç»è¢«åºŸå¼ƒäº†ã€‚é€šè¿‡æˆ‘ä¸Šé¢çš„è®²è¿°ï¼Œä½ æœ‰æ²¡æœ‰å‘ç°æ€§èƒ½é—®é¢˜å‡ºç°åœ¨äº†å“ªé‡Œå‘¢ï¼Ÿ</p><p>å®é™…ä¸Šï¼Œç›¸æ¯”äºä¸¤å°å®¿ä¸»æœºä¹‹é—´çš„ç›´æ¥é€šä¿¡ï¼ŒåŸºäºFlannel UDPæ¨¡å¼çš„å®¹å™¨é€šä¿¡å¤šäº†ä¸€ä¸ªé¢å¤–çš„æ­¥éª¤ï¼Œå³flanneldçš„å¤„ç†è¿‡ç¨‹ã€‚è€Œè¿™ä¸ªè¿‡ç¨‹ï¼Œç”±äºä½¿ç”¨åˆ°äº†flannel0è¿™ä¸ªTUNè®¾å¤‡ï¼Œä»…åœ¨å‘å‡ºIPåŒ…çš„è¿‡ç¨‹ä¸­ï¼Œå°±éœ€è¦ç»è¿‡ä¸‰æ¬¡ç”¨æˆ·æ€ä¸å†…æ ¸æ€ä¹‹é—´çš„æ•°æ®æ‹·è´ï¼Œå¦‚ä¸‹æ‰€ç¤ºï¼š</p><p><img src=\"https://static001.geekbang.org/resource/image/84/8d/84caa6dc3f9dcdf8b88b56bd2e22138d.png?wh=890*593\" alt=\"\" title=\"å›¾2 TUNè®¾å¤‡ç¤ºæ„å›¾\"></p><p>æˆ‘ä»¬å¯ä»¥çœ‹åˆ°ï¼š</p><p>ç¬¬ä¸€æ¬¡ï¼Œç”¨æˆ·æ€çš„å®¹å™¨è¿›ç¨‹å‘å‡ºçš„IPåŒ…ç»è¿‡docker0ç½‘æ¡¥è¿›å…¥å†…æ ¸æ€ï¼›</p><p>ç¬¬äºŒæ¬¡ï¼ŒIPåŒ…æ ¹æ®è·¯ç”±è¡¨è¿›å…¥TUNï¼ˆflannel0ï¼‰è®¾å¤‡ï¼Œä»è€Œå›åˆ°ç”¨æˆ·æ€çš„flanneldè¿›ç¨‹ï¼›</p><p>ç¬¬ä¸‰æ¬¡ï¼Œflanneldè¿›è¡ŒUDPå°åŒ…ä¹‹åé‡æ–°è¿›å…¥å†…æ ¸æ€ï¼Œå°†UDPåŒ…é€šè¿‡å®¿ä¸»æœºçš„eth0å‘å‡ºå»ã€‚</p><p>æ­¤å¤–ï¼Œæˆ‘ä»¬è¿˜å¯ä»¥çœ‹åˆ°ï¼ŒFlannelè¿›è¡ŒUDPå°è£…ï¼ˆEncapsulationï¼‰å’Œè§£å°è£…ï¼ˆDecapsulationï¼‰çš„è¿‡ç¨‹ï¼Œä¹Ÿéƒ½æ˜¯åœ¨ç”¨æˆ·æ€å®Œæˆçš„ã€‚åœ¨Linuxæ“ä½œç³»ç»Ÿä¸­ï¼Œä¸Šè¿°è¿™äº›ä¸Šä¸‹æ–‡åˆ‡æ¢å’Œç”¨æˆ·æ€æ“ä½œçš„ä»£ä»·å…¶å®æ˜¯æ¯”è¾ƒé«˜çš„ï¼Œè¿™ä¹Ÿæ­£æ˜¯é€ æˆFlannel UDPæ¨¡å¼æ€§èƒ½ä¸å¥½çš„ä¸»è¦åŸå› ã€‚</p><p>æ‰€ä»¥è¯´ï¼Œ<strong>æˆ‘ä»¬åœ¨è¿›è¡Œç³»ç»Ÿçº§ç¼–ç¨‹çš„æ—¶å€™ï¼Œæœ‰ä¸€ä¸ªéå¸¸é‡è¦çš„ä¼˜åŒ–åŸåˆ™ï¼Œå°±æ˜¯è¦å‡å°‘ç”¨æˆ·æ€åˆ°å†…æ ¸æ€çš„åˆ‡æ¢æ¬¡æ•°ï¼Œå¹¶ä¸”æŠŠæ ¸å¿ƒçš„å¤„ç†é€»è¾‘éƒ½æ”¾åœ¨å†…æ ¸æ€è¿›è¡Œ</strong>ã€‚è¿™ä¹Ÿæ˜¯ä¸ºä»€ä¹ˆï¼ŒFlannelåæ¥æ”¯æŒçš„<span class=\"orange\">VXLANæ¨¡å¼ï¼Œé€æ¸æˆä¸ºäº†ä¸»æµçš„å®¹å™¨ç½‘ç»œæ–¹æ¡ˆçš„åŸå› ã€‚</span></p><p>VXLANï¼Œå³Virtual Extensible LANï¼ˆè™šæ‹Ÿå¯æ‰©å±•å±€åŸŸç½‘ï¼‰ï¼Œæ˜¯Linuxå†…æ ¸æœ¬èº«å°±æ”¯æŒçš„ä¸€ç§ç½‘ç»œè™šä¼¼åŒ–æŠ€æœ¯ã€‚æ‰€ä»¥è¯´ï¼ŒVXLANå¯ä»¥å®Œå…¨åœ¨å†…æ ¸æ€å®ç°ä¸Šè¿°å°è£…å’Œè§£å°è£…çš„å·¥ä½œï¼Œä»è€Œé€šè¿‡ä¸å‰é¢ç›¸ä¼¼çš„â€œéš§é“â€æœºåˆ¶ï¼Œæ„å»ºå‡ºè¦†ç›–ç½‘ç»œï¼ˆOverlay Networkï¼‰ã€‚</p><p>VXLANçš„è¦†ç›–ç½‘ç»œçš„è®¾è®¡æ€æƒ³æ˜¯ï¼šåœ¨ç°æœ‰çš„ä¸‰å±‚ç½‘ç»œä¹‹ä¸Šï¼Œâ€œè¦†ç›–â€ä¸€å±‚è™šæ‹Ÿçš„ã€ç”±å†…æ ¸VXLANæ¨¡å—è´Ÿè´£ç»´æŠ¤çš„äºŒå±‚ç½‘ç»œï¼Œä½¿å¾—è¿æ¥åœ¨è¿™ä¸ªVXLANäºŒå±‚ç½‘ç»œä¸Šçš„â€œä¸»æœºâ€ï¼ˆè™šæ‹Ÿæœºæˆ–è€…å®¹å™¨éƒ½å¯ä»¥ï¼‰ä¹‹é—´ï¼Œå¯ä»¥åƒåœ¨åŒä¸€ä¸ªå±€åŸŸç½‘ï¼ˆLANï¼‰é‡Œé‚£æ ·è‡ªç”±é€šä¿¡ã€‚å½“ç„¶ï¼Œå®é™…ä¸Šï¼Œè¿™äº›â€œä¸»æœºâ€å¯èƒ½åˆ†å¸ƒåœ¨ä¸åŒçš„å®¿ä¸»æœºä¸Šï¼Œç”šè‡³æ˜¯åˆ†å¸ƒåœ¨ä¸åŒçš„ç‰©ç†æœºæˆ¿é‡Œã€‚</p><p>è€Œä¸ºäº†èƒ½å¤Ÿåœ¨äºŒå±‚ç½‘ç»œä¸Šæ‰“é€šâ€œéš§é“â€ï¼ŒVXLANä¼šåœ¨å®¿ä¸»æœºä¸Šè®¾ç½®ä¸€ä¸ªç‰¹æ®Šçš„ç½‘ç»œè®¾å¤‡ä½œä¸ºâ€œéš§é“â€çš„ä¸¤ç«¯ã€‚è¿™ä¸ªè®¾å¤‡å°±å«ä½œVTEPï¼Œå³ï¼šVXLAN Tunnel End Pointï¼ˆè™šæ‹Ÿéš§é“ç«¯ç‚¹ï¼‰ã€‚</p><p>è€ŒVTEPè®¾å¤‡çš„ä½œç”¨ï¼Œå…¶å®è·Ÿå‰é¢çš„flanneldè¿›ç¨‹éå¸¸ç›¸ä¼¼ã€‚åªä¸è¿‡ï¼Œå®ƒè¿›è¡Œå°è£…å’Œè§£å°è£…çš„å¯¹è±¡ï¼Œæ˜¯äºŒå±‚æ•°æ®å¸§ï¼ˆEthernet frameï¼‰ï¼›è€Œä¸”è¿™ä¸ªå·¥ä½œçš„æ‰§è¡Œæµç¨‹ï¼Œå…¨éƒ¨æ˜¯åœ¨å†…æ ¸é‡Œå®Œæˆçš„ï¼ˆå› ä¸ºVXLANæœ¬èº«å°±æ˜¯Linuxå†…æ ¸ä¸­çš„ä¸€ä¸ªæ¨¡å—ï¼‰ã€‚</p><p>ä¸Šè¿°åŸºäºVTEPè®¾å¤‡è¿›è¡Œâ€œéš§é“â€é€šä¿¡çš„æµç¨‹ï¼Œæˆ‘ä¹Ÿä¸ºä½ æ€»ç»“æˆäº†ä¸€å¹…å›¾ï¼Œå¦‚ä¸‹æ‰€ç¤ºï¼š</p><p><img src=\"https://static001.geekbang.org/resource/image/03/f5/03185fab251a833fef7ed6665d5049f5.jpg?wh=1767*933\" alt=\"\" title=\"å›¾3 åŸºäºFlannel VXLANæ¨¡å¼çš„è·¨ä¸»é€šä¿¡çš„åŸºæœ¬åŸç†\n\"></p><p>å¯ä»¥çœ‹åˆ°ï¼Œå›¾ä¸­æ¯å°å®¿ä¸»æœºä¸Šåå«flannel.1çš„è®¾å¤‡ï¼Œå°±æ˜¯VXLANæ‰€éœ€çš„VTEPè®¾å¤‡ï¼Œå®ƒæ—¢æœ‰IPåœ°å€ï¼Œä¹Ÿæœ‰MACåœ°å€ã€‚</p><p>ç°åœ¨ï¼Œæˆ‘ä»¬çš„container-1çš„IPåœ°å€æ˜¯10.1.15.2ï¼Œè¦è®¿é—®çš„container-2çš„IPåœ°å€æ˜¯10.1.16.3ã€‚</p><p>é‚£ä¹ˆï¼Œä¸å‰é¢UDPæ¨¡å¼çš„æµç¨‹ç±»ä¼¼ï¼Œå½“container-1å‘å‡ºè¯·æ±‚ä¹‹åï¼Œè¿™ä¸ªç›®çš„åœ°å€æ˜¯10.1.16.3çš„IPåŒ…ï¼Œä¼šå…ˆå‡ºç°åœ¨docker0ç½‘æ¡¥ï¼Œç„¶åè¢«è·¯ç”±åˆ°æœ¬æœºflannel.1è®¾å¤‡è¿›è¡Œå¤„ç†ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œæ¥åˆ°äº†â€œéš§é“â€çš„å…¥å£ã€‚ä¸ºäº†æ–¹ä¾¿å™è¿°ï¼Œæˆ‘æ¥ä¸‹æ¥ä¼šæŠŠè¿™ä¸ªIPåŒ…ç§°ä¸ºâ€œåŸå§‹IPåŒ…â€ã€‚</p><p>ä¸ºäº†èƒ½å¤Ÿå°†â€œåŸå§‹IPåŒ…â€å°è£…å¹¶ä¸”å‘é€åˆ°æ­£ç¡®çš„å®¿ä¸»æœºï¼ŒVXLANå°±éœ€è¦æ‰¾åˆ°è¿™æ¡â€œéš§é“â€çš„å‡ºå£ï¼Œå³ï¼šç›®çš„å®¿ä¸»æœºçš„VTEPè®¾å¤‡ã€‚</p><p>è€Œè¿™ä¸ªè®¾å¤‡çš„ä¿¡æ¯ï¼Œæ­£æ˜¯æ¯å°å®¿ä¸»æœºä¸Šçš„flanneldè¿›ç¨‹è´Ÿè´£ç»´æŠ¤çš„ã€‚</p><p>æ¯”å¦‚ï¼Œå½“Node 2å¯åŠ¨å¹¶åŠ å…¥Flannelç½‘ç»œä¹‹åï¼Œåœ¨Node 1ï¼ˆä»¥åŠæ‰€æœ‰å…¶ä»–èŠ‚ç‚¹ï¼‰ä¸Šï¼Œflanneldå°±ä¼šæ·»åŠ ä¸€æ¡å¦‚ä¸‹æ‰€ç¤ºçš„è·¯ç”±è§„åˆ™ï¼š</p><pre><code>$ route -n\nKernel IP routing table\nDestination     Gateway         Genmask         Flags Metric Ref    Use Iface\n...\n10.1.16.0       10.1.16.0       255.255.255.0   UG    0      0        0 flannel.1\n</code></pre><p>è¿™æ¡è§„åˆ™çš„æ„æ€æ˜¯ï¼šå‡¡æ˜¯å‘å¾€10.1.16.0/24ç½‘æ®µçš„IPåŒ…ï¼Œéƒ½éœ€è¦ç»è¿‡flannel.1è®¾å¤‡å‘å‡ºï¼Œå¹¶ä¸”ï¼Œå®ƒæœ€åè¢«å‘å¾€çš„ç½‘å…³åœ°å€æ˜¯ï¼š10.1.16.0ã€‚</p><p>ä»å›¾3çš„Flannel VXLANæ¨¡å¼çš„æµç¨‹å›¾ä¸­æˆ‘ä»¬å¯ä»¥çœ‹åˆ°ï¼Œ10.1.16.0æ­£æ˜¯Node 2ä¸Šçš„VTEPè®¾å¤‡ï¼ˆä¹Ÿå°±æ˜¯flannel.1è®¾å¤‡ï¼‰çš„IPåœ°å€ã€‚</p><p>ä¸ºäº†æ–¹ä¾¿å™è¿°ï¼Œæ¥ä¸‹æ¥æˆ‘ä¼šæŠŠNode 1å’ŒNode 2ä¸Šçš„flannel.1è®¾å¤‡åˆ†åˆ«ç§°ä¸ºâ€œæºVTEPè®¾å¤‡â€å’Œâ€œç›®çš„VTEPè®¾å¤‡â€ã€‚</p><p>è€Œè¿™äº›VTEPè®¾å¤‡ä¹‹é—´ï¼Œå°±éœ€è¦æƒ³åŠæ³•ç»„æˆä¸€ä¸ªè™šæ‹Ÿçš„äºŒå±‚ç½‘ç»œï¼Œå³ï¼šé€šè¿‡äºŒå±‚æ•°æ®å¸§è¿›è¡Œé€šä¿¡ã€‚</p><p>æ‰€ä»¥åœ¨æˆ‘ä»¬çš„ä¾‹å­ä¸­ï¼Œâ€œæºVTEPè®¾å¤‡â€æ”¶åˆ°â€œåŸå§‹IPåŒ…â€åï¼Œå°±è¦æƒ³åŠæ³•æŠŠâ€œåŸå§‹IPåŒ…â€åŠ ä¸Šä¸€ä¸ªç›®çš„MACåœ°å€ï¼Œå°è£…æˆä¸€ä¸ªäºŒå±‚æ•°æ®å¸§ï¼Œç„¶åå‘é€ç»™â€œç›®çš„VTEPè®¾å¤‡â€ï¼ˆå½“ç„¶ï¼Œè¿™ä¹ˆåšè¿˜æ˜¯å› ä¸ºè¿™ä¸ªIPåŒ…çš„ç›®çš„åœ°å€ä¸æ˜¯æœ¬æœºï¼‰ã€‚</p><p>è¿™é‡Œéœ€è¦è§£å†³çš„é—®é¢˜å°±æ˜¯ï¼š<strong>â€œç›®çš„VTEPè®¾å¤‡â€çš„MACåœ°å€æ˜¯ä»€ä¹ˆï¼Ÿ</strong></p><p>æ­¤æ—¶ï¼Œæ ¹æ®å‰é¢çš„è·¯ç”±è®°å½•ï¼Œæˆ‘ä»¬å·²ç»çŸ¥é“äº†â€œç›®çš„VTEPè®¾å¤‡â€çš„IPåœ°å€ã€‚è€Œè¦æ ¹æ®ä¸‰å±‚IPåœ°å€æŸ¥è¯¢å¯¹åº”çš„äºŒå±‚MACåœ°å€ï¼Œè¿™æ­£æ˜¯ARPï¼ˆAddress Resolution Protocol ï¼‰è¡¨çš„åŠŸèƒ½ã€‚</p><p>è€Œè¿™é‡Œè¦ç”¨åˆ°çš„ARPè®°å½•ï¼Œä¹Ÿæ˜¯flanneldè¿›ç¨‹åœ¨Node 2èŠ‚ç‚¹å¯åŠ¨æ—¶ï¼Œè‡ªåŠ¨æ·»åŠ åœ¨Node 1ä¸Šçš„ã€‚æˆ‘ä»¬å¯ä»¥é€šè¿‡ipå‘½ä»¤çœ‹åˆ°å®ƒï¼Œå¦‚ä¸‹æ‰€ç¤ºï¼š</p><pre><code># åœ¨Node 1ä¸Š\n$ ip neigh show dev flannel.1\n10.1.16.0 lladdr 5e:f8:4f:00:e3:37 PERMANENT\n</code></pre><p>è¿™æ¡è®°å½•çš„æ„æ€éå¸¸æ˜ç¡®ï¼Œå³ï¼šIPåœ°å€10.1.16.0ï¼Œå¯¹åº”çš„MACåœ°å€æ˜¯5e:f8:4f:00:e3:37ã€‚</p><blockquote>\n<p>å¯ä»¥çœ‹åˆ°ï¼Œæœ€æ–°ç‰ˆæœ¬çš„Flannelå¹¶ä¸ä¾èµ–L3 MISSäº‹ä»¶å’ŒARPå­¦ä¹ ï¼Œè€Œä¼šåœ¨æ¯å°èŠ‚ç‚¹å¯åŠ¨æ—¶æŠŠå®ƒçš„VTEPè®¾å¤‡å¯¹åº”çš„ARPè®°å½•ï¼Œç›´æ¥ä¸‹æ”¾åˆ°å…¶ä»–æ¯å°å®¿ä¸»æœºä¸Šã€‚</p>\n</blockquote><p>æœ‰äº†è¿™ä¸ªâ€œç›®çš„VTEPè®¾å¤‡â€çš„MACåœ°å€ï¼Œ<strong>Linuxå†…æ ¸å°±å¯ä»¥å¼€å§‹äºŒå±‚å°åŒ…å·¥ä½œäº†</strong>ã€‚è¿™ä¸ªäºŒå±‚å¸§çš„æ ¼å¼ï¼Œå¦‚ä¸‹æ‰€ç¤ºï¼š</p><p><img src=\"https://static001.geekbang.org/resource/image/f2/55/f208fba66d2b58405864882342b23255.jpg?wh=799*179\" alt=\"\" title=\"å›¾4 Flannel VXLANæ¨¡å¼çš„å†…éƒ¨å¸§\"></p><p>å¯ä»¥çœ‹åˆ°ï¼ŒLinuxå†…æ ¸ä¼šæŠŠâ€œç›®çš„VTEPè®¾å¤‡â€çš„MACåœ°å€ï¼Œå¡«å†™åœ¨å›¾ä¸­çš„Inner Ethernet Headerå­—æ®µï¼Œå¾—åˆ°ä¸€ä¸ªäºŒå±‚æ•°æ®å¸§ã€‚</p><p>éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œä¸Šè¿°å°åŒ…è¿‡ç¨‹åªæ˜¯åŠ ä¸€ä¸ªäºŒå±‚å¤´ï¼Œä¸ä¼šæ”¹å˜â€œåŸå§‹IPåŒ…â€çš„å†…å®¹ã€‚æ‰€ä»¥å›¾ä¸­çš„Inner IP Headerå­—æ®µï¼Œä¾ç„¶æ˜¯container-2çš„IPåœ°å€ï¼Œå³10.1.16.3ã€‚</p><p>ä½†æ˜¯ï¼Œä¸Šé¢æåˆ°çš„è¿™äº›VTEPè®¾å¤‡çš„MACåœ°å€ï¼Œå¯¹äºå®¿ä¸»æœºç½‘ç»œæ¥è¯´å¹¶æ²¡æœ‰ä»€ä¹ˆå®é™…æ„ä¹‰ã€‚æ‰€ä»¥ä¸Šé¢å°è£…å‡ºæ¥çš„è¿™ä¸ªæ•°æ®å¸§ï¼Œå¹¶ä¸èƒ½åœ¨æˆ‘ä»¬çš„å®¿ä¸»æœºäºŒå±‚ç½‘ç»œé‡Œä¼ è¾“ã€‚ä¸ºäº†æ–¹ä¾¿å™è¿°ï¼Œæˆ‘ä»¬æŠŠå®ƒç§°ä¸ºâ€œå†…éƒ¨æ•°æ®å¸§â€ï¼ˆInner Ethernet Frameï¼‰ã€‚</p><p>æ‰€ä»¥æ¥ä¸‹æ¥ï¼ŒLinuxå†…æ ¸è¿˜éœ€è¦å†æŠŠâ€œå†…éƒ¨æ•°æ®å¸§â€è¿›ä¸€æ­¥å°è£…æˆä¸ºå®¿ä¸»æœºç½‘ç»œé‡Œçš„ä¸€ä¸ªæ™®é€šçš„æ•°æ®å¸§ï¼Œå¥½è®©å®ƒâ€œè½½ç€â€â€œå†…éƒ¨æ•°æ®å¸§â€ï¼Œé€šè¿‡å®¿ä¸»æœºçš„eth0ç½‘å¡è¿›è¡Œä¼ è¾“ã€‚</p><p>æˆ‘ä»¬æŠŠè¿™æ¬¡è¦å°è£…å‡ºæ¥çš„ã€å®¿ä¸»æœºå¯¹åº”çš„æ•°æ®å¸§ç§°ä¸ºâ€œå¤–éƒ¨æ•°æ®å¸§â€ï¼ˆOuter Ethernet Frameï¼‰ã€‚</p><p>ä¸ºäº†å®ç°è¿™ä¸ªâ€œæ­ä¾¿è½¦â€çš„æœºåˆ¶ï¼ŒLinuxå†…æ ¸ä¼šåœ¨â€œå†…éƒ¨æ•°æ®å¸§â€å‰é¢ï¼ŒåŠ ä¸Šä¸€ä¸ªç‰¹æ®Šçš„VXLANå¤´ï¼Œç”¨æ¥è¡¨ç¤ºè¿™ä¸ªâ€œä¹˜å®¢â€å®é™…ä¸Šæ˜¯ä¸€ä¸ªVXLANè¦ä½¿ç”¨çš„æ•°æ®å¸§ã€‚</p><p>è€Œè¿™ä¸ªVXLANå¤´é‡Œæœ‰ä¸€ä¸ªé‡è¦çš„æ ‡å¿—å«ä½œ<strong>VNI</strong>ï¼Œå®ƒæ˜¯VTEPè®¾å¤‡è¯†åˆ«æŸä¸ªæ•°æ®å¸§æ˜¯ä¸æ˜¯åº”è¯¥å½’è‡ªå·±å¤„ç†çš„é‡è¦æ ‡è¯†ã€‚è€Œåœ¨Flannelä¸­ï¼ŒVNIçš„é»˜è®¤å€¼æ˜¯1ï¼Œè¿™ä¹Ÿæ˜¯ä¸ºä½•ï¼Œå®¿ä¸»æœºä¸Šçš„VTEPè®¾å¤‡éƒ½å«ä½œflannel.1çš„åŸå› ï¼Œè¿™é‡Œçš„â€œ1â€ï¼Œå…¶å®å°±æ˜¯VNIçš„å€¼ã€‚</p><p><strong>ç„¶åï¼ŒLinuxå†…æ ¸ä¼šæŠŠè¿™ä¸ªæ•°æ®å¸§å°è£…è¿›ä¸€ä¸ªUDPåŒ…é‡Œå‘å‡ºå»ã€‚</strong></p><p>æ‰€ä»¥ï¼Œè·ŸUDPæ¨¡å¼ç±»ä¼¼ï¼Œåœ¨å®¿ä¸»æœºçœ‹æ¥ï¼Œå®ƒä¼šä»¥ä¸ºè‡ªå·±çš„flannel.1è®¾å¤‡åªæ˜¯åœ¨å‘å¦å¤–ä¸€å°å®¿ä¸»æœºçš„flannel.1è®¾å¤‡ï¼Œå‘èµ·äº†ä¸€æ¬¡æ™®é€šçš„UDPé“¾æ¥ã€‚å®ƒå“ªé‡Œä¼šçŸ¥é“ï¼Œè¿™ä¸ªUDPåŒ…é‡Œé¢ï¼Œå…¶å®æ˜¯ä¸€ä¸ªå®Œæ•´çš„äºŒå±‚æ•°æ®å¸§ã€‚è¿™æ˜¯ä¸æ˜¯è·Ÿç‰¹æ´›ä¼Šæœ¨é©¬çš„æ•…äº‹éå¸¸åƒå‘¢ï¼Ÿ</p><p>ä¸è¿‡ï¼Œä¸è¦å¿˜äº†ï¼Œä¸€ä¸ªflannel.1è®¾å¤‡åªçŸ¥é“å¦ä¸€ç«¯çš„flannel.1è®¾å¤‡çš„MACåœ°å€ï¼Œå´ä¸çŸ¥é“å¯¹åº”çš„å®¿ä¸»æœºåœ°å€æ˜¯ä»€ä¹ˆã€‚</p><p>ä¹Ÿå°±æ˜¯è¯´ï¼Œè¿™ä¸ªUDPåŒ…è¯¥å‘ç»™å“ªå°å®¿ä¸»æœºå‘¢ï¼Ÿ</p><p>åœ¨è¿™ç§åœºæ™¯ä¸‹ï¼Œflannel.1è®¾å¤‡å®é™…ä¸Šè¦æ‰®æ¼”ä¸€ä¸ªâ€œç½‘æ¡¥â€çš„è§’è‰²ï¼Œåœ¨äºŒå±‚ç½‘ç»œè¿›è¡ŒUDPåŒ…çš„è½¬å‘ã€‚è€Œåœ¨Linuxå†…æ ¸é‡Œé¢ï¼Œâ€œç½‘æ¡¥â€è®¾å¤‡è¿›è¡Œè½¬å‘çš„ä¾æ®ï¼Œæ¥è‡ªäºä¸€ä¸ªå«ä½œFDBï¼ˆForwarding Databaseï¼‰çš„è½¬å‘æ•°æ®åº“ã€‚</p><p>ä¸éš¾æƒ³åˆ°ï¼Œè¿™ä¸ªflannel.1â€œç½‘æ¡¥â€å¯¹åº”çš„FDBä¿¡æ¯ï¼Œä¹Ÿæ˜¯flanneldè¿›ç¨‹è´Ÿè´£ç»´æŠ¤çš„ã€‚å®ƒçš„å†…å®¹å¯ä»¥é€šè¿‡bridge fdbå‘½ä»¤æŸ¥çœ‹åˆ°ï¼Œå¦‚ä¸‹æ‰€ç¤ºï¼š</p><pre><code># åœ¨Node 1ä¸Šï¼Œä½¿ç”¨â€œç›®çš„VTEPè®¾å¤‡â€çš„MACåœ°å€è¿›è¡ŒæŸ¥è¯¢\n$ bridge fdb show flannel.1 | grep 5e:f8:4f:00:e3:37\n5e:f8:4f:00:e3:37 dev flannel.1 dst 10.168.0.3 self permanent\n</code></pre><p>å¯ä»¥çœ‹åˆ°ï¼Œåœ¨ä¸Šé¢è¿™æ¡FDBè®°å½•é‡Œï¼ŒæŒ‡å®šäº†è¿™æ ·ä¸€æ¡è§„åˆ™ï¼Œå³ï¼š</p><p>å‘å¾€æˆ‘ä»¬å‰é¢æåˆ°çš„â€œç›®çš„VTEPè®¾å¤‡â€ï¼ˆMACåœ°å€æ˜¯5e:f8:4f:00:e3:37ï¼‰çš„äºŒå±‚æ•°æ®å¸§ï¼Œåº”è¯¥é€šè¿‡flannel.1è®¾å¤‡ï¼Œå‘å¾€IPåœ°å€ä¸º10.168.0.3çš„ä¸»æœºã€‚æ˜¾ç„¶ï¼Œè¿™å°ä¸»æœºæ­£æ˜¯Node 2ï¼ŒUDPåŒ…è¦å‘å¾€çš„ç›®çš„åœ°å°±æ‰¾åˆ°äº†ã€‚</p><p>æ‰€ä»¥<strong>æ¥ä¸‹æ¥çš„æµç¨‹ï¼Œå°±æ˜¯ä¸€ä¸ªæ­£å¸¸çš„ã€å®¿ä¸»æœºç½‘ç»œä¸Šçš„å°åŒ…å·¥ä½œã€‚</strong></p><p>æˆ‘ä»¬çŸ¥é“ï¼ŒUDPåŒ…æ˜¯ä¸€ä¸ªå››å±‚æ•°æ®åŒ…ï¼Œæ‰€ä»¥Linuxå†…æ ¸ä¼šåœ¨å®ƒå‰é¢åŠ ä¸Šä¸€ä¸ªIPå¤´ï¼Œå³åŸç†å›¾ä¸­çš„Outer IP Headerï¼Œç»„æˆä¸€ä¸ªIPåŒ…ã€‚å¹¶ä¸”ï¼Œåœ¨è¿™ä¸ªIPå¤´é‡Œï¼Œä¼šå¡«ä¸Šå‰é¢é€šè¿‡FDBæŸ¥è¯¢å‡ºæ¥çš„ç›®çš„ä¸»æœºçš„IPåœ°å€ï¼Œå³Node 2çš„IPåœ°å€10.168.0.3ã€‚</p><p>ç„¶åï¼ŒLinuxå†…æ ¸å†åœ¨è¿™ä¸ªIPåŒ…å‰é¢åŠ ä¸ŠäºŒå±‚æ•°æ®å¸§å¤´ï¼Œå³åŸç†å›¾ä¸­çš„Outer Ethernet Headerï¼Œå¹¶æŠŠNode 2çš„MACåœ°å€å¡«è¿›å»ã€‚è¿™ä¸ªMACåœ°å€æœ¬èº«ï¼Œæ˜¯Node 1çš„ARPè¡¨è¦å­¦ä¹ çš„å†…å®¹ï¼Œæ— éœ€Flannelç»´æŠ¤ã€‚è¿™æ—¶å€™ï¼Œæˆ‘ä»¬å°è£…å‡ºæ¥çš„â€œå¤–éƒ¨æ•°æ®å¸§â€çš„æ ¼å¼ï¼Œå¦‚ä¸‹æ‰€ç¤ºï¼š</p><p><img src=\"https://static001.geekbang.org/resource/image/8c/85/8cede8f74a57617494027ba137383f85.jpg?wh=1864*192\" alt=\"\" title=\"å›¾5 Flannel VXLANæ¨¡å¼çš„å¤–éƒ¨å¸§\"></p><p>è¿™æ ·ï¼Œå°åŒ…å·¥ä½œå°±å®£å‘Šå®Œæˆäº†ã€‚</p><p>æ¥ä¸‹æ¥ï¼ŒNode 1ä¸Šçš„flannel.1è®¾å¤‡å°±å¯ä»¥æŠŠè¿™ä¸ªæ•°æ®å¸§ä»Node 1çš„eth0ç½‘å¡å‘å‡ºå»ã€‚æ˜¾ç„¶ï¼Œè¿™ä¸ªå¸§ä¼šç»è¿‡å®¿ä¸»æœºç½‘ç»œæ¥åˆ°Node 2çš„eth0ç½‘å¡ã€‚</p><p>è¿™æ—¶å€™ï¼ŒNode 2çš„å†…æ ¸ç½‘ç»œæ ˆä¼šå‘ç°è¿™ä¸ªæ•°æ®å¸§é‡Œæœ‰VXLAN Headerï¼Œå¹¶ä¸”VNI=1ã€‚æ‰€ä»¥Linuxå†…æ ¸ä¼šå¯¹å®ƒè¿›è¡Œæ‹†åŒ…ï¼Œæ‹¿åˆ°é‡Œé¢çš„å†…éƒ¨æ•°æ®å¸§ï¼Œç„¶åæ ¹æ®VNIçš„å€¼ï¼ŒæŠŠå®ƒäº¤ç»™Node 2ä¸Šçš„flannel.1è®¾å¤‡ã€‚</p><p>è€Œflannel.1è®¾å¤‡åˆ™ä¼šè¿›ä¸€æ­¥æ‹†åŒ…ï¼Œå–å‡ºâ€œåŸå§‹IPåŒ…â€ã€‚æ¥ä¸‹æ¥å°±å›åˆ°äº†æˆ‘åœ¨ä¸Šä¸€ç¯‡æ–‡ç« ä¸­åˆ†äº«çš„å•æœºå®¹å™¨ç½‘ç»œçš„å¤„ç†æµç¨‹ã€‚æœ€ç»ˆï¼ŒIPåŒ…å°±è¿›å…¥åˆ°äº†container-2å®¹å™¨çš„Network Namespaceé‡Œã€‚</p><p>ä»¥ä¸Šï¼Œå°±æ˜¯Flannel VXLANæ¨¡å¼çš„å…·ä½“å·¥ä½œåŸç†äº†ã€‚</p><h2>æ€»ç»“</h2><p>åœ¨æœ¬ç¯‡æ–‡ç« ä¸­ï¼Œæˆ‘ä¸ºä½ è¯¦ç»†è®²è§£äº†Flannel UDPå’ŒVXLANæ¨¡å¼çš„å·¥ä½œåŸç†ã€‚è¿™ä¸¤ç§æ¨¡å¼å…¶å®éƒ½å¯ä»¥ç§°ä½œâ€œéš§é“â€æœºåˆ¶ï¼Œä¹Ÿæ˜¯å¾ˆå¤šå…¶ä»–å®¹å™¨ç½‘ç»œæ’ä»¶çš„åŸºç¡€ã€‚æ¯”å¦‚Weaveçš„ä¸¤ç§æ¨¡å¼ï¼Œä»¥åŠDockerçš„Overlayæ¨¡å¼ã€‚</p><p>æ­¤å¤–ï¼Œä»ä¸Šé¢çš„è®²è§£ä¸­æˆ‘ä»¬å¯ä»¥çœ‹åˆ°ï¼ŒVXLANæ¨¡å¼ç»„å»ºçš„è¦†ç›–ç½‘ç»œï¼Œå…¶å®å°±æ˜¯ä¸€ä¸ªç”±ä¸åŒå®¿ä¸»æœºä¸Šçš„VTEPè®¾å¤‡ï¼Œä¹Ÿå°±æ˜¯flannel.1è®¾å¤‡ç»„æˆçš„è™šæ‹ŸäºŒå±‚ç½‘ç»œã€‚å¯¹äºVTEPè®¾å¤‡æ¥è¯´ï¼Œå®ƒå‘å‡ºçš„â€œå†…éƒ¨æ•°æ®å¸§â€å°±ä»¿ä½›æ˜¯ä¸€ç›´åœ¨è¿™ä¸ªè™šæ‹Ÿçš„äºŒå±‚ç½‘ç»œä¸ŠæµåŠ¨ã€‚è¿™ï¼Œä¹Ÿæ­£æ˜¯è¦†ç›–ç½‘ç»œçš„å«ä¹‰ã€‚</p><blockquote>\n<p>å¤‡æ³¨ï¼šå¦‚æœä½ æƒ³è¦åœ¨æˆ‘ä»¬å‰é¢éƒ¨ç½²çš„é›†ç¾¤ä¸­å®è·µFlannelçš„è¯ï¼Œå¯ä»¥åœ¨MasterèŠ‚ç‚¹ä¸Šæ‰§è¡Œå¦‚ä¸‹å‘½ä»¤æ¥æ›¿æ¢ç½‘ç»œæ’ä»¶ã€‚<br>\nç¬¬ä¸€æ­¥ï¼Œæ‰§è¡Œ<code>$ rm -rf /etc/cni/net.d/*</code>ï¼›<br>\nç¬¬äºŒæ­¥ï¼Œæ‰§è¡Œ<code>$ kubectl delete -f \"https://cloud.weave.works/k8s/net?k8s-version=1.11\"</code>ï¼›<br>\nç¬¬ä¸‰æ­¥ï¼Œåœ¨<code>/etc/kubernetes/manifests/kube-controller-manager.yaml</code>é‡Œï¼Œä¸ºå®¹å™¨å¯åŠ¨å‘½ä»¤æ·»åŠ å¦‚ä¸‹ä¸¤ä¸ªå‚æ•°ï¼š<br>\n<code>--allocate-node-cidrs=true</code><br>\n<code>--cluster-cidr=10.244.0.0/16</code><br>\nç¬¬å››æ­¥ï¼Œ é‡å¯æ‰€æœ‰kubeletï¼›<br>\nç¬¬äº”æ­¥ï¼Œ æ‰§è¡Œ<code>$ kubectl create -f https://raw.githubusercontent.com/coreos/flannel/bc79dd1505b0c8681ece4de4c0d86c5cd2643275/Documentation/kube-flannel.yml</code>ã€‚</p>\n</blockquote><h2>æ€è€ƒé¢˜</h2><p>å¯ä»¥çœ‹åˆ°ï¼ŒFlannelé€šè¿‡ä¸Šè¿°çš„â€œéš§é“â€æœºåˆ¶ï¼Œå®ç°äº†å®¹å™¨ä¹‹é—´ä¸‰å±‚ç½‘ç»œï¼ˆIPåœ°å€ï¼‰çš„è¿é€šæ€§ã€‚ä½†æ˜¯ï¼Œæ ¹æ®è¿™ä¸ªæœºåˆ¶çš„å·¥ä½œåŸç†ï¼Œä½ è®¤ä¸ºFlannelèƒ½è´Ÿè´£ä¿è¯äºŒå±‚ç½‘ç»œï¼ˆMACåœ°å€ï¼‰çš„è¿é€šæ€§å—ï¼Ÿä¸ºä»€ä¹ˆå‘¢ï¼Ÿ</p><p>æ„Ÿè°¢ä½ çš„æ”¶å¬ï¼Œæ¬¢è¿ä½ ç»™æˆ‘ç•™è¨€ï¼Œä¹Ÿæ¬¢è¿åˆ†äº«ç»™æ›´å¤šçš„æœ‹å‹ä¸€èµ·é˜…è¯»ã€‚</p>","neighbors":{"left":{"article_title":"32 | æµ…è°ˆå®¹å™¨ç½‘ç»œ","id":64948},"right":{"article_title":"34 | Kubernetesç½‘ç»œæ¨¡å‹ä¸CNIç½‘ç»œæ’ä»¶","id":67351}},"comments":[{"had_liked":false,"id":67901,"user_name":"å®çˆ·","can_delete":false,"product_type":"c1","uid":1153664,"ip_address":"","ucode":"DD517FA7EB59AB","user_header":"https://static001.geekbang.org/account/avatar/00/11/9a/80/2bf8d7fc.jpg","comment_is_top":false,"comment_ctime":1550317962,"is_pvip":false,"discussion_count":6,"race_medal":0,"score":"778939398538","product_id":100015201,"comment_content":"è¿™é‡Œä½¿ç”¨UDPï¼Œä¸éœ€è¦å¯é ï¼Œå› ä¸ºå¯é æ€§ä¸æ˜¯è¿™ä¸€å±‚éœ€è¦è€ƒè™‘çš„äº‹æƒ…ï¼Œè¿™ä¸€å±‚éœ€è¦è€ƒè™‘çš„äº‹æƒ…å°±æ˜¯æŠŠè¿™ä¸ªåŒ…å‘é€åˆ°ç›®æ ‡åœ°å€ã€‚å¦‚æœå‡ºç°äº†UDPä¸¢åŒ…çš„æƒ…å†µï¼Œä¹Ÿå®Œå…¨æ²¡æœ‰å…³ç³»ï¼Œè¿™é‡ŒUDPåŒ…è£¹çš„æ˜¯æˆ‘ä»¬çœŸæ­£çš„æ•°æ®åŒ…ï¼Œå¦‚æœæˆ‘ä»¬ä¸Šå±‚ä½¿ç”¨çš„æ˜¯TCPåè®®ï¼Œè€ŒFlannelä½¿ç”¨UDPåŒ…è£¹äº†æˆ‘ä»¬çš„æ•°æ®åŒ…ï¼Œå½“å‡ºç°ä¸¢åŒ…äº†ï¼ŒTCPçš„ç¡®è®¤æœºåˆ¶ä¼šå‘ç°è¿™ä¸ªä¸¢åŒ…è€Œé‡ä¼ ï¼Œä»è€Œä¿è¯å¯é ã€‚","like_count":182,"discussions":[{"author":{"id":1887603,"avatar":"https://static001.geekbang.org/account/avatar/00/1c/cd/73/f6889c2f.jpg","nickname":"Wind","note":"","ucode":"AD108636DE44C4","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":333162,"discussion_content":"è¿™é‡Œçš„udpå…¶å®æ˜¯å……å½“äº†â€œæ•°æ®é“¾è·¯å±‚â€œï¼Œ è¿™å±‚æœ¬æ¥å°±å…è®¸ä¸¢åŒ…\n","likes_number":14,"is_delete":false,"is_hidden":false,"ctime":1607469426,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":1,"child_discussions":[{"author":{"id":1207457,"avatar":"https://static001.geekbang.org/account/avatar/00/12/6c/a1/80d83f0a.jpg","nickname":"Ellison","note":"","ucode":"A2FB94D4F6A332","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":1887603,"avatar":"https://static001.geekbang.org/account/avatar/00/1c/cd/73/f6889c2f.jpg","nickname":"Wind","note":"","ucode":"AD108636DE44C4","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":350309,"discussion_content":"ä¸€èˆ¬éƒ½æ˜¯å†…ç½‘IPè¿›è¡Œä¼ è¾“ï¼Œ å¦‚æœå‡ºç°ä¸¢åŒ…äº†ï¼Œ è‚¯å®šä½ è®¾å¤‡é—®é¢˜","likes_number":2,"is_delete":false,"is_hidden":false,"ctime":1613809834,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":333162,"ip_address":""},"score":350309,"extra":""}]},{"author":{"id":1022156,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/98/cc/d7793058.jpg","nickname":"lgjchina","note":"","ucode":"4B5482C935BB3C","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":313894,"discussion_content":"å¯é æ€§æ˜¯TCPçš„é‡ä¼ æœºåˆ¶ï¼Œå‘é€æ–¹æ²¡æœ‰æ”¶åˆ°ç¡®è®¤ç„¶åé‡ä¼ ï¼Œå®¹å™¨ç½‘ç»œæ ˆåªç®¡æ”¶å‘ã€‚å¦å¤–ä¸€èˆ¬åœ¨å†…ç½‘ä¸­ï¼ŒUDPæ˜¯éå¸¸å¯é çš„ï¼Œé™¤éå‡ºç°ç½‘ç»œè®¾å¤‡æ•…éšœã€‚","likes_number":7,"is_delete":false,"is_hidden":false,"ctime":1603102583,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1910345,"avatar":"https://static001.geekbang.org/account/avatar/00/1d/26/49/491fbb94.jpg","nickname":"WiSoniC","note":"","ucode":"FB5EDF6B902950","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":261835,"discussion_content":"ç²¾è¾Ÿï¼Œæ˜¯ä¸æ˜¯å¯ä»¥ç†è§£å®¹å™¨ä¸­çš„TCPæ•°æ®åŒ…è¢«å®¿ä¸»æœºå°è£…æˆäº†UDPæ•°æ®åŒ…ï¼Œå¯é æ€§éƒ¨åˆ†å®é™…æ˜¯å®¹å™¨å†…éƒ¨çš„ç½‘ç»œæ ˆåœ¨ç»´æŠ¤ï¼Ÿ","likes_number":4,"is_delete":false,"is_hidden":false,"ctime":1589012250,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":2,"child_discussions":[{"author":{"id":1224228,"avatar":"https://static001.geekbang.org/account/avatar/00/12/ae/24/5723e6fe.jpg","nickname":"ç»æœ›çš„ç”Ÿé±¼ç‰‡","note":"","ucode":"5F4337E4623FEC","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":1910345,"avatar":"https://static001.geekbang.org/account/avatar/00/1d/26/49/491fbb94.jpg","nickname":"WiSoniC","note":"","ucode":"FB5EDF6B902950","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":347850,"discussion_content":"æˆ‘ç†è§£æ˜¯çš„ï¼Œå¯é æ€§æ˜¯åœ¨å®¹å™¨å°è£…çš„tcpæ•°æ®åŒ…é‡Œä¿è¯çš„","likes_number":1,"is_delete":false,"is_hidden":false,"ctime":1612340427,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":261835,"ip_address":""},"score":347850,"extra":""},{"author":{"id":1313840,"avatar":"https://static001.geekbang.org/account/avatar/00/14/0c/30/bb4bfe9d.jpg","nickname":"lyonger","note":"","ucode":"E89A75DADEA2A1","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":1910345,"avatar":"https://static001.geekbang.org/account/avatar/00/1d/26/49/491fbb94.jpg","nickname":"WiSoniC","note":"","ucode":"FB5EDF6B902950","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":385443,"discussion_content":"æˆ‘ä¹Ÿæ˜¯è¿™ä¹ˆç†è§£çš„","likes_number":1,"is_delete":false,"is_hidden":false,"ctime":1627047366,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":261835,"ip_address":""},"score":385443,"extra":""}]}]},{"had_liked":false,"id":37333,"user_name":"Maiza","can_delete":false,"product_type":"c1","uid":1007248,"ip_address":"","ucode":"D6911CDAC0D8C7","user_header":"https://static001.geekbang.org/account/avatar/00/0f/5e/90/5f79859b.jpg","comment_is_top":false,"comment_ctime":1541551811,"is_pvip":false,"discussion_count":1,"race_medal":0,"score":"211994949315","product_id":100015201,"comment_content":"åˆ†åˆ†é’Ÿå˜æˆäº†è®¡ç®—æœºç½‘ç»œè¯¾ç¨‹ ğŸ˜„","like_count":50,"discussions":[{"author":{"id":1845394,"avatar":"https://static001.geekbang.org/account/avatar/00/1c/28/92/436735f5.jpg","nickname":"æ™æœˆ520","note":"","ucode":"4F05E02A5C1608","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":287687,"discussion_content":"æˆ‘ä»¥å‰æ˜¯æç½‘ç»œçš„ çœ‹è¿™ä¸ªéƒ½çœ‹ä¸æ‡‚","likes_number":3,"is_delete":false,"is_hidden":false,"ctime":1593510233,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":37503,"user_name":"è™è™â¤ï¸","can_delete":false,"product_type":"c1","uid":1086535,"ip_address":"","ucode":"157F261E80291A","user_header":"https://static001.geekbang.org/account/avatar/00/10/94/47/75875257.jpg","comment_is_top":false,"comment_ctime":1541614869,"is_pvip":false,"discussion_count":1,"race_medal":0,"score":"160455404821","product_id":100015201,"comment_content":"æˆ‘åˆæ€è€ƒäº†ä¸€ä¸‹ï¼ŒäºŒå±‚ç½‘ç»œå¯èƒ½æ— æ³•è¿é€šã€‚å› ä¸ºflannelç½‘ç»œä¸­ï¼Œnodeä¸Šçš„fdbæ˜¯é é…ç½®è€Œéå­¦ä¹ å¾—åˆ°ã€‚å½“node1ä¸Šçš„å®¹å™¨1æƒ³è¦é€šè¿‡macåœ°å€ç›´è¿node2ä¸Šçš„å®¹å™¨2æ—¶ï¼Œç”±äºnode1ä¸­çš„fdbä¸­æ²¡æœ‰é…ç½®å®¹å™¨2çš„macåœ°å€ç›¸å…³è®°å½•ï¼Œæ‰€ä»¥flannel.1æ— æ³•æ‰¾åˆ°VTEPå‡ºå£çš„ipã€‚æ•…è€ŒäºŒå±‚ç½‘ç»œæ²¡æœ‰è¿é€šæ€§ã€‚<br><br>å¦‚æœæƒ³è¦æœ‰è¿é€šæ€§ï¼Œéœ€è¦é…ç½®VTEPä¸ºå­¦ä¹ æ¨¡å¼ï¼Œå¹¶ä¸”æŠŠæ‰€æœ‰çš„VTEPåŠ å…¥ä¸€ä¸ªåˆ†ç»„ä¸­ã€‚è¿™æ ·åœ¨fdbè¡¨ä¸­æŸ¥è¯¢ä¸åˆ°macåœ°å€æ—¶ï¼Œvxlanåœ¨VTEPç»„ä¸­å‘èµ·å¹¿æ’­(æˆ–è€…ç»„æ’­ï¼Ÿè¿™ä¸ªæ¦‚å¿µæˆ‘æœ‰ç‚¹æ··æ·†)ã€‚VTEPä¹Ÿå¯ä½œä¸ºä¸€ä¸ªç½‘æ¡¥è®¾å¤‡ï¼Œç»§ç»­å‘docker0ï¼Œè¿›è€Œç›®çš„nodeä¸Šçš„æ‰€æœ‰å®¹å™¨å¹¿æ’­ã€‚æ­£ç¡®çš„ç›®çš„åœ°å€ä¼šå“åº”è¯·æ±‚ï¼Œè€Œä¸”åˆšæ‰é€”ç»çš„è®¾å¤‡fdbéƒ½å­¦ä¹ åˆ°äº†æºå®¹å™¨çš„mac åœ°å€æ˜ å°„ï¼Œæ‰€ä»¥å“åº”æ•°æ®å¯ä»¥é¡ºåˆ©è¿”å›æºå®¹å™¨ã€‚è¿™æ ·å°±å®Œæˆäº†äºŒå±‚ç½‘ç»œçš„è¿é€šã€‚","like_count":37,"discussions":[{"author":{"id":1172019,"avatar":"https://static001.geekbang.org/account/avatar/00/11/e2/33/3ca366bf.jpg","nickname":"å¯»æ‰¾ä¹Œæ‰˜é‚¦","note":"","ucode":"12143F0FAAAF2B","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":18224,"discussion_content":"å‚è€ƒVxlanç½‘ç»œOverlay çš„æ–¹æ¡ˆå°±å¯ä»¥ï¼Œè‡ªå­¦ä¹ ","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1569033819,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":135631,"user_name":"ä¿Šé‡†","can_delete":false,"product_type":"c1","uid":1046158,"ip_address":"","ucode":"AB08F7D04C20CB","user_header":"https://static001.geekbang.org/account/avatar/00/0f/f6/8e/c9c94420.jpg","comment_is_top":false,"comment_ctime":1569231502,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"134713217678","product_id":100015201,"comment_content":"è¯»äº†è‡³å°‘6éäº†ï¼Œæ¯æ¬¡éƒ½æœ‰æ–°çš„æ”¶è·ï¼Œæ„Ÿè°¢ç£Šå“¥ç»™åŠ›çš„åˆ†äº«ã€‚","like_count":32},{"had_liked":false,"id":37391,"user_name":"é˜¿é¹","can_delete":false,"product_type":"c1","uid":1207915,"ip_address":"","ucode":"88C847A20EEA9A","user_header":"https://static001.geekbang.org/account/avatar/00/12/6e/6b/9c3f3abb.jpg","comment_is_top":false,"comment_ctime":1541567808,"is_pvip":false,"discussion_count":1,"race_medal":0,"score":"65966077248","product_id":100015201,"comment_content":"æˆ‘çœ‹å¾ˆå¤šæ–‡ç« éƒ½æ¨ècalicoï¼Œè€å¸ˆè§‰å¾—å‘¢","like_count":15,"discussions":[{"author":{"id":1845394,"avatar":"https://static001.geekbang.org/account/avatar/00/1c/28/92/436735f5.jpg","nickname":"æ™æœˆ520","note":"","ucode":"4F05E02A5C1608","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":287688,"discussion_content":"calico è¦å¯¹ç½‘ç»œå¾ˆç†Ÿæ‚‰ é€‚åˆå¤§çš„ç¯å¢ƒ","likes_number":2,"is_delete":false,"is_hidden":false,"ctime":1593510259,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":61713,"user_name":"å‡Œ","can_delete":false,"product_type":"c1","uid":1257995,"ip_address":"","ucode":"41369B360C794F","user_header":"https://static001.geekbang.org/account/avatar/00/13/32/0b/81ae214b.jpg","comment_is_top":false,"comment_ctime":1547780321,"is_pvip":false,"discussion_count":4,"race_medal":0,"score":"53087387873","product_id":100015201,"comment_content":"flannelè¿›ç¨‹è´Ÿè´£å­ç½‘-&gt;VTEP macï¼ŒVTEP mac-&gt;èŠ‚ç‚¹ip(fdb)çš„ç»´æŠ¤ï¼Œä¸ºä»€ä¹ˆä¸ç›´æ¥ç»´æŠ¤å­ç½‘-&gt;èŠ‚ç‚¹ipè¡¨æ›´ç›´æ¥ï¼Œä¸­é—´çš„äºŒå±‚ç½‘ç»œæ„Ÿè§‰å¤šæ­¤ä¸€ä¸¾çš„","like_count":12,"discussions":[{"author":{"id":1359866,"avatar":"https://static001.geekbang.org/account/avatar/00/14/bf/fa/de262c51.jpg","nickname":"é’Ÿé˜…","note":"","ucode":"3CCB22D2E3E10F","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":76669,"discussion_content":"éœ€è¦è§£è€¦VTEP å’Œhost nodeï¼Œæ¯”å¦‚dest node is down, VTEP è¿ç§»åˆ°æ–°çš„nodeä¸Šçš„æƒ…å†µ","likes_number":21,"is_delete":false,"is_hidden":false,"ctime":1575822918,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":3,"child_discussions":[{"author":{"id":1837179,"avatar":"https://static001.geekbang.org/account/avatar/00/1c/08/7b/7f086546.jpg","nickname":"Alex","note":"","ucode":"70806CEA9AB15E","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":1359866,"avatar":"https://static001.geekbang.org/account/avatar/00/14/bf/fa/de262c51.jpg","nickname":"é’Ÿé˜…","note":"","ucode":"3CCB22D2E3E10F","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":537043,"discussion_content":"æœ‰é“ç†","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1638943687,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":76669,"ip_address":""},"score":537043,"extra":""},{"author":{"id":2956746,"avatar":"","nickname":"Geek_4911b5","note":"","ucode":"EB3F19827ECCD2","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":1359866,"avatar":"https://static001.geekbang.org/account/avatar/00/14/bf/fa/de262c51.jpg","nickname":"é’Ÿé˜…","note":"","ucode":"3CCB22D2E3E10F","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":560058,"discussion_content":"è¿™æ ·çš„è¯ï¼Œæˆ‘è§‰å¾—ç°æœ‰çš„é€»è¾‘ä¹Ÿå¾—å¤„ç†ä½ è¯´çš„æƒ…å†µï¼Œå¹¶ä¸”flannelåº”è¯¥è¦ä¿è¯VTEPè¿ç§»çš„åœºæ™¯ã€‚\n\nè¿™é‡Œæˆ‘è§‰å¾—åº”è¯¥æ˜¯æŠ¥æ–‡åˆ°è¾¾node2åï¼Œåç»­çš„é€šä¿¡å®Œå…¨æ˜¯äºŒå±‚çš„ï¼Œè€ŒVETPå¾—macå°±ç›¸å½“äºä¸€ä¸ªäºŒå±‚äº¤æ¢æœºã€‚\n\nå½“ç„¶å¦‚æœæƒ³ç›´æ¥æ‰¾åˆ°å®¹å™¨çš„macä¹Ÿè¡Œï¼Œä½†æ˜¯è¿™æ ·è·¯ç”±ä¿¡æ¯å°±å¾—å¾ˆå¤§å¾ˆå¤§","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1649150404,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":76669,"ip_address":""},"score":560058,"extra":""},{"author":{"id":2334257,"avatar":"https://thirdwx.qlogo.cn/mmopen/vi_32/4fZ9thib248ZkR1N3Eekeyb8N1V1Ud0uePctlI4VQUibPSmEZvgoP0VYl6IsVHJc7ZMiczQMtU76y6E6ag1zNAK4Q/132","nickname":"Geek_336577","note":"","ucode":"4826355EBA4950","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":2956746,"avatar":"","nickname":"Geek_4911b5","note":"","ucode":"EB3F19827ECCD2","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":576448,"discussion_content":"è½¬ç§»åï¼Œå†™å…¥ETCDï¼Œé›†ç¾¤å†…æ‰€æœ‰flanneldéƒ½ä¼šwatch etcdï¼Œç›‘å¬åˆ°å˜åŒ–åï¼Œåšæœ¬èŠ‚ç‚¹çš„ä¿®æ”¹","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1655558030,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":560058,"ip_address":""},"score":576448,"extra":""}]}]},{"had_liked":false,"id":281452,"user_name":"å¤§æä»å„¿","can_delete":false,"product_type":"c1","uid":1120756,"ip_address":"","ucode":"EBF09A3AAF93DC","user_header":"https://static001.geekbang.org/account/avatar/00/11/19/f4/34fdd4be.jpg","comment_is_top":false,"comment_ctime":1614753842,"is_pvip":true,"discussion_count":1,"race_medal":0,"score":"40269459506","product_id":100015201,"comment_content":"è¿™ä¸ªå’Œä¸€èˆ¬çš„ç½‘ç»œä¼ è¾“ä¸åŒï¼Œä¸€èˆ¬çš„ç½‘ç»œä¼ è¾“ä¼šç›´æ¥è¯·æ±‚ipåœ°å€ï¼Œæ ¹æ®ipåœ°å€ï¼Œå‘é€ARPè¯·æ±‚æ¥è·å–ä¸‹ä¸€è·³è®¾å¤‡çš„macåœ°å€ï¼Œè·å–macåœ°å€ä¹‹åä¼šç¼“å­˜ä¸‹æ¥ï¼Œè¿™æ˜¯ä¸€èˆ¬è·¯ç”±å™¨æˆ–è€…ç½‘æ¡¥åšçš„äº‹æƒ…ã€‚ä½†åœ¨å®¹å™¨ç½‘ç»œé‡Œæˆ‘ä»¬åªçŸ¥é“ç›®æ ‡å®¹å™¨çš„ipåœ°å€ï¼Œå¹¶ä¸çŸ¥é“å®¿ä¸»æœºçš„ipåœ°å€ï¼Œéœ€è¦å°†å®¹å™¨çš„ipåœ°å€å’Œå®¿ä¸»æœºçš„ipåœ°å€å…³è”èµ·æ¥ã€‚è¿™ä¸ªå…³ç³»ç”±è·¯ç”±è§„åˆ™, fdbå­˜å‚¨çš„æ•°æ®å’ŒARPè®°å½•ä¸‹æ¥ï¼Œè¿™äº›éƒ½æ˜¯åœ¨åˆ›å»ºnodeèŠ‚ç‚¹çš„æ—¶å€™ï¼Œç”±å„ä¸ªèŠ‚ç‚¹çš„flanneldåˆ›å»ºå‡ºæ¥ã€‚é€šè¿‡è·¯ç”±è§„åˆ™çŸ¥é“äº†è¯¥å°†æ•°æ®åŒ…å‘é€åˆ°flannel.1è¿™ä¸ªvtepè®¾å¤‡å¤„ç†å¹¶ä¸”çŸ¥é“äº†ç›®åœ°vtepçš„ipåœ°å€ï¼Œé€šè¿‡vtep IPåœ°å€ip neigh show dev flannel.1 æ‰¾åˆ°äº†å¯¹ç«¯çš„vtep macåœ°å€ï¼Œé€šè¿‡å¯¹ç«¯vtep macåœ°å€æŸ¥è¯¢ bridge fdb list æŸ¥åˆ°äº†è¿™ä¸ªmacåœ°å€å¯¹åº”çš„å®¿ä¸»æœºåœ°å€ã€‚ è¿™æ ·å°è£…å‡ºåŒ…ä¹‹åæŒ‰ç…§vxlané€»è¾‘è¿›è¡Œæ­£å¸¸å‘é€ã€‚","like_count":10,"discussions":[{"author":{"id":2530236,"avatar":"https://static001.geekbang.org/account/avatar/00/26/9b/bc/16d405c8.jpg","nickname":"å–·ç«é¾™çš„æ¢¦æƒ³","note":"","ucode":"D883506CEBFDD6","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":554474,"discussion_content":"è€è¡¨ï¼Œæˆ‘è’™åœˆäº†","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1646393029,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":105556,"user_name":"å¤","can_delete":false,"product_type":"c1","uid":1010922,"ip_address":"","ucode":"74E6838226A405","user_header":"https://static001.geekbang.org/account/avatar/00/0f/6c/ea/ce9854a5.jpg","comment_is_top":false,"comment_ctime":1561029644,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"40215735308","product_id":100015201,"comment_content":"å¥½æ·±çš„åŠŸåº•","like_count":9},{"had_liked":false,"id":78488,"user_name":"whatever","can_delete":false,"product_type":"c1","uid":1446891,"ip_address":"","ucode":"675C63131E2BAF","user_header":"https://static001.geekbang.org/account/avatar/00/16/13/eb/150bf071.jpg","comment_is_top":false,"comment_ctime":1553158227,"is_pvip":true,"discussion_count":1,"race_medal":0,"score":"35912896595","product_id":100015201,"comment_content":"è€å¸ˆæ‚¨å°†çš„å…³äºlinuxç½‘ç»œæ–¹é¢çš„èƒ½ä»‹ç»ä¸€æœ¬ä¹¦å—ï¼Ÿæˆ‘æƒ³ä½“ç³»åŒ–çš„å­¦ä¹ ä¸€ä¸‹ç›¸å…³çŸ¥è¯†ã€‚æ¯”å¦‚flannel.1æ˜¯æ€ä¹ˆä»‹å…¥åˆ°æ“ä½œç³»ç»Ÿå†…æ ¸é‚£é‡Œçš„ï¼Œæ˜¯linuxæœ¬èº«æä¾›äº†æ‰©å±•å—ï¼Œè¿™äº›é—®é¢˜æˆ‘è§‰å¾—è¿˜æ˜¯éœ€è¦ä½“ç³»åŒ–çš„å­¦ä¹ ä¸€ä¸‹ï¼Œè¦ä¸æ„Ÿè§‰çŸ¥å…¶ç„¶ä¸çŸ¥å…¶æ‰€ä»¥ç„¶","like_count":8,"discussions":[{"author":{"id":1264563,"avatar":"https://static001.geekbang.org/account/avatar/00/13/4b/b3/01d64240.jpg","nickname":"é¾Ÿé¾ŸğŸ¢","note":"","ucode":"C53C0D15C9EA83","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":574579,"discussion_content":"å»ºè®®ä½ çœ‹çœ‹åè®®æ ˆçš„åˆ†å±‚ï¼Œflannel.1åªæ˜¯Linuxä¸Šé¢çš„å…¶ä¸­ä¸€ç§è™šæ‹Ÿè®¾å¤‡ã€‚å¯¹äºåè®®æ ˆæ¥è¯´ï¼Œè¿™äº›è®¾å¤‡éƒ½æ˜¯æ— å·®åˆ«åŒ–çš„","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1654159648,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":38261,"user_name":"å‹¤åŠ³çš„å°èƒ–å­-libo","can_delete":false,"product_type":"c1","uid":1158344,"ip_address":"","ucode":"5BB20CD5A56568","user_header":"https://static001.geekbang.org/account/avatar/00/11/ac/c8/4b1c0d40.jpg","comment_is_top":false,"comment_ctime":1542007632,"is_pvip":false,"replies":[{"id":"13793","content":"ç°åœ¨å®ƒä»¬éƒ½ä¸ä¾èµ–etcdï¼Œç›´æ¥è¿apiserver","user_name":"ä½œè€…å›å¤","user_name_real":"Geek_6ef93d","uid":"1218095","ctime":1542070717,"ip_address":"","comment_id":38261,"utype":1}],"discussion_count":2,"race_medal":0,"score":"35901746000","product_id":100015201,"comment_content":"Flannelä¸­çš„UDPéœ€è¦Etcdæ¥ç»´æŠ¤ç›¸å…³çš„å­ç½‘ä¸å®¿ä¸»æœºçš„å¯¹åº”å…³ç³»ï¼Œåœ¨VxLanä¸­ä¹Ÿéœ€è¦Etcdå—ï¼Ÿè€å¸ˆï¼Œä»€ä¹ˆæ—¶å€™å¯ä»¥è®²ä¸‹Etcdåœ¨k8sä¸­çš„åŸç†ä¸åº”ç”¨ï¼Ÿ","like_count":9,"discussions":[{"author":{"id":1218095,"avatar":"https://static001.geekbang.org/account/avatar/00/12/96/2f/876085fa.jpg","nickname":"å¼ ç£Š Kubernetes","note":"","ucode":"16E29BDAB1F5BC","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":428659,"discussion_content":"ç°åœ¨å®ƒä»¬éƒ½ä¸ä¾èµ–etcdï¼Œç›´æ¥è¿apiserver","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1542070717,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1207457,"avatar":"https://static001.geekbang.org/account/avatar/00/12/6c/a1/80d83f0a.jpg","nickname":"Ellison","note":"","ucode":"A2FB94D4F6A332","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":350679,"discussion_content":"æ„Ÿè§‰å¯¹apiserviceçš„å¼€é”€æ›´å¤§äº†ï¼Œ è¿˜å¥½æœ‰informer","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1613977421,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":38216,"user_name":"ä½•å…ˆç”Ÿ","can_delete":false,"product_type":"c1","uid":1178630,"ip_address":"","ucode":"A004799E6D813F","user_header":"https://static001.geekbang.org/account/avatar/00/11/fc/06/6cc5d4d5.jpg","comment_is_top":false,"comment_ctime":1541990617,"is_pvip":false,"replies":[{"id":"13732","content":"å¥½é—®é¢˜ã€‚ä½ å¯ä»¥æƒ³æƒ³ï¼Œè¿™é‡Œæ˜¯ä¸æ˜¯éœ€è¦â€œå¯é â€å‘¢ï¼Ÿ","user_name":"ä½œè€…å›å¤","user_name_real":"Geek_6ef93d","uid":"1218095","ctime":1542000504,"ip_address":"","comment_id":38216,"utype":1}],"discussion_count":12,"race_medal":0,"score":"35901728985","product_id":100015201,"comment_content":"ä¸ºä»€ä¹ˆè¦ä½¿ç”¨UDPå‘¢ï¼ŒUDPä¸æ˜¯ä¸å¯é çš„å—","like_count":8,"discussions":[{"author":{"id":1587282,"avatar":"https://static001.geekbang.org/account/avatar/00/18/38/52/526c10f9.jpg","nickname":"é˜¿ä¸ƒ","note":"","ucode":"B14B05BD0EB78A","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":281623,"discussion_content":"1ã€ä¸éœ€è¦å¯é ã€‚å› ä¸ºè¿™ä¸ªudpé‡Œé¢åŒ…è£¹çš„æ˜¯tcpçš„å†…å®¹ï¼Œæ”¶å‘åŒç«¯å¦‚æœå‘ç°ä¸¢åŒ…ï¼Œè¿˜æ˜¯ä¼šé‡ä¼ çš„ã€‚\n2ã€å±€åŸŸç½‘ç¯å¢ƒä¸‹ï¼Œå¯é æ€§æœ‰ä¸€å®šä¿éšœï¼Œä¸ä¼šå› ä¸ºä½¿ç”¨äº†udpé€ æˆé¢‘ç¹ä¸¢åŒ…ã€‚\n3ã€udpå¼€é”€å°ã€‚","likes_number":17,"is_delete":false,"is_hidden":false,"ctime":1591779287,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":3,"child_discussions":[{"author":{"id":1029436,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/b5/3c/967d7291.jpg","nickname":"è‰ºè¶…(é²é¸£)","note":"","ucode":"7F749FA543E0F1","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":1587282,"avatar":"https://static001.geekbang.org/account/avatar/00/18/38/52/526c10f9.jpg","nickname":"é˜¿ä¸ƒ","note":"","ucode":"B14B05BD0EB78A","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":295304,"discussion_content":"è¯·æ•™ä¸€ä¸‹ï¼Œudpé‡Œé¢åŒ…è£¹çš„æ˜¯tcpçš„å†…å®¹ï¼Œè¿™ä¸ªæ€ä¹ˆç†è§£å‘¢ï¼Ÿ","likes_number":2,"is_delete":false,"is_hidden":false,"ctime":1596160341,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":281623,"ip_address":""},"score":295304,"extra":""},{"author":{"id":1186807,"avatar":"https://static001.geekbang.org/account/avatar/00/12/1b/f7/45e8b64a.jpg","nickname":"Fire","note":"","ucode":"4A2C50B77EDB2C","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":1029436,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/b5/3c/967d7291.jpg","nickname":"è‰ºè¶…(é²é¸£)","note":"","ucode":"7F749FA543E0F1","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":342968,"discussion_content":"ä¹Ÿä¸ä¸€å®šæ˜¯tcpï¼Œè¿™é‡Œç›¸å½“äºæ˜¯ç”¨udpå°è£…ç½‘ç»œåŒ…æ¨¡æ‹Ÿä¸‰å±‚è·¯ç”±é€‰è·¯ï¼Œå¯¹å®¹å™¨æ¥è¯´æ˜¯å¯ä»¥æŠŠè¿™ä¸ªudpéš§é“å½“æˆä¸‰å±‚ipåŒ…ï¼ŒipåŒ…ä¸ä¿è¯åˆ°è¾¾ï¼Œè¿™ä¸€ç‚¹å’ŒudpåŒ…çš„ç‰¹æ€§å®Œå…¨å»åˆã€‚åŸºäºè¿™ä¸ªæ¨¡æ‹Ÿçš„ipè§„åˆ™ï¼Œå®¹å™¨å¯ä»¥å‘é€å¤šç§ä¸Šå±‚åè®®ï¼Œæ¯”å¦‚tcpï¼Œudpã€‚","likes_number":3,"is_delete":false,"is_hidden":false,"ctime":1610888289,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":295304,"ip_address":""},"score":342968,"extra":""},{"author":{"id":1237070,"avatar":"https://static001.geekbang.org/account/avatar/00/12/e0/4e/c266bdb4.jpg","nickname":"[å°ç‹—]","note":"","ucode":"090AEAC8A86134","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":1029436,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/b5/3c/967d7291.jpg","nickname":"è‰ºè¶…(é²é¸£)","note":"","ucode":"7F749FA543E0F1","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":349920,"discussion_content":"ä½ ä¸ºä»€ä¹ˆè¦é€šä¿¡å‘¢ï¼Ÿ ä¸æ˜¯ä¸ºäº†åº”ç”¨å—ï¼Ÿéš¾é“å°±æ˜¯pingå—ï¼Ÿ ä»–çš„æ„æ€æ˜¯å‰æœŸçš„å°è£…éƒ½æ˜¯ä¸ºäº†ä¸€ä¸ªè¿è¾“çš„è½½ä½“åšçš„è§„åˆ™ï¼ŒçœŸæ­£è¦è¾¾åˆ°çš„ç›®çš„æ˜¯bodyé‡Œé¢çš„å†…å®¹å¯ä»¥è¢«å¯¹ç«¯è¿›è¡Œè§£å¸§è¯†åˆ«ï¼Œè½¬å‘è·¯ç”±æ‰¾åˆ°æœ€ç»ˆçš„å®¿ä¸»ï¼Œè¿›è¡Œåº”ç”¨å±‚æ“ä½œ","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1613629904,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":295304,"ip_address":""},"score":349920,"extra":""}]},{"author":{"id":1158795,"avatar":"https://static001.geekbang.org/account/avatar/00/11/ae/8b/43ce01ca.jpg","nickname":"ezekiel","note":"","ucode":"AB4AB6FA8612D8","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":342641,"discussion_content":"å› ä¸ºåœ¨å†…ç½‘ï¼Œç½‘ç»œç¯å¢ƒæ¯”è¾ƒå¥½ã€‚è€Œä¸”å¯é æ€§ä¿è¯å¯ä»¥åœ¨flannelå†…ä¿è¯","likes_number":3,"is_delete":false,"is_hidden":false,"ctime":1610761455,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1172019,"avatar":"https://static001.geekbang.org/account/avatar/00/11/e2/33/3ca366bf.jpg","nickname":"å¯»æ‰¾ä¹Œæ‰˜é‚¦","note":"","ucode":"12143F0FAAAF2B","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":18226,"discussion_content":"UDPå¼€é”€å°ï¼Œå¦‚æœæ´ªæ³›æ²¡ç»“æœï¼Œå¯ä»¥å†æ¬¡å‘ã€‚è€Œä¸”éƒ½æ˜¯å±€åŸŸç½‘ï¼Œç½‘ç»œå¯é æ€§æœ‰ä¿è¯ã€‚","likes_number":3,"is_delete":false,"is_hidden":false,"ctime":1569033951,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1218095,"avatar":"https://static001.geekbang.org/account/avatar/00/12/96/2f/876085fa.jpg","nickname":"å¼ ç£Š Kubernetes","note":"","ucode":"16E29BDAB1F5BC","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":428643,"discussion_content":"å¥½é—®é¢˜ã€‚ä½ å¯ä»¥æƒ³æƒ³ï¼Œè¿™é‡Œæ˜¯ä¸æ˜¯éœ€è¦â€œå¯é â€å‘¢ï¼Ÿ","likes_number":1,"is_delete":false,"is_hidden":false,"ctime":1542000504,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1175140,"avatar":"https://static001.geekbang.org/account/avatar/00/11/ee/64/55adb692.jpg","nickname":"îŒ‡ æµ·å¤§","note":"","ucode":"03D1013FBE6047","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":347331,"discussion_content":"ç½‘ç»œå¯é æ€§å†³å®šäºæ•°æ®å†…éƒ¨tcpä¿è¯ï¼Œudpæ— éœ€å»ºç«‹è¿æ¥ å ç”¨èµ„æº","likes_number":1,"is_delete":false,"is_hidden":false,"ctime":1612195569,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":2334257,"avatar":"https://thirdwx.qlogo.cn/mmopen/vi_32/4fZ9thib248ZkR1N3Eekeyb8N1V1Ud0uePctlI4VQUibPSmEZvgoP0VYl6IsVHJc7ZMiczQMtU76y6E6ag1zNAK4Q/132","nickname":"Geek_336577","note":"","ucode":"4826355EBA4950","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":576452,"discussion_content":"åº”ç”¨å±‚ä½¿ç”¨çš„TCPåè®®ï¼Œå¯ä»¥ä¿è¯","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1655558194,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1290469,"avatar":"http://thirdwx.qlogo.cn/mmopen/vi_32/Um0fKCDsGBRStZBF1M4HLPSq8jiancnNoYKiaYyYldFX0NObkyUFmnVKTgjm6Y7wUiaCQ3Vm9Ic213l65kJfUzq4w/132","nickname":"Geek_c92584","note":"","ucode":"D9DA02DA718977","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":377744,"discussion_content":"å’ŒIPä¸€æ ·ï¼Œå°½æœ€å¤§åŠªåŠ›ä¼ é€å°±å¥½äº†","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1622803715,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1139121,"avatar":"https://static001.geekbang.org/account/avatar/00/11/61/b1/1261c177.jpg","nickname":"èƒ–èƒ–è™","note":"","ucode":"9CA8F99CC82944","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":342217,"discussion_content":"æˆ‘è§‰å¾—è¿˜æœ‰ä¸€ç‚¹ï¼Œå¦‚æœä½¿ç”¨TCPåè®®çš„è¯ï¼Œæœ¬èº«æ˜¯éœ€è¦å»ºç«‹è¿æ¥çš„ï¼Œéšä¹‹è€Œæ¥çš„æ˜¯TCPåè®®ç›¸å…³çš„ä¸€ç³»åˆ—ç½‘ç»œç›¸å…³çš„æ§åˆ¶ï¼Œæ¯”è¾ƒå¤æ‚ã€‚å®¿ä¸»æœºä¹‹é—´é€šä¿¡å®é™…ä¸Šåªéœ€è¦æŠŠæ•°æ®åŒ…æŠ•é€’è¿‡å»å°±å¯ä»¥äº†ï¼Œæ²¡æœ‰å¿…è¦å†åŠ ä¸Šè¿™ä¹ˆä¸€å±‚æ§åˆ¶ã€‚ç›¸å…³å…·ä½“åº”ç”¨çš„æ§åˆ¶åœ¨å°è£…å†…çš„åè®®å·²ç»åšè¿‡äº†ã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1610616467,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1042891,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/e9/cb/cbc3ca53.jpg","nickname":"é’±å¤šå¤š","note":"","ucode":"1D8E525B37283E","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":201713,"discussion_content":"æ¨¡æ‹Ÿ IP","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1583829363,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":55819,"user_name":"divfor","can_delete":false,"product_type":"c1","uid":1000315,"ip_address":"","ucode":"3B14C74252741D","user_header":"https://static001.geekbang.org/account/avatar/00/0f/43/7b/0c7f8fbe.jpg","comment_is_top":false,"comment_ctime":1546315515,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"31611086587","product_id":100015201,"comment_content":"è®²éš§é“æ¨¡å¼ä¸æmtuå¤„ç†ï¼Œæ˜¯ä¸æ˜¯ç¼ºäº†ä»€ä¹ˆ","like_count":7},{"had_liked":false,"id":37319,"user_name":"ç¨‹ç‡•å","can_delete":false,"product_type":"c1","uid":1105759,"ip_address":"","ucode":"7BF6821D186E23","user_header":"https://static001.geekbang.org/account/avatar/00/10/df/5f/dabab90b.jpg","comment_is_top":false,"comment_ctime":1541550587,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"27311354363","product_id":100015201,"comment_content":"å„ä¸ªnodeä¼šå°†è‡ªå·±çš„vtepä¿¡æ¯ä¸ŠæŠ¥ç»™apiserverï¼Œapiserverå°†ä¿¡æ¯åŒæ­¥ç»™å„ä¸ªèŠ‚ç‚¹çš„flanneldï¼Œflanneldé€šè¿‡netlinkä¸‹å‘ï¼Œå®Œæˆä¿¡æ¯çš„åŒæ­¥","like_count":6},{"had_liked":false,"id":69978,"user_name":"Rain","can_delete":false,"product_type":"c1","uid":1175329,"ip_address":"","ucode":"603DFFAC6A3755","user_header":"https://static001.geekbang.org/account/avatar/00/11/ef/21/69c181b8.jpg","comment_is_top":false,"comment_ctime":1550923893,"is_pvip":false,"discussion_count":10,"race_medal":0,"score":"23025760373","product_id":100015201,"comment_content":"æŠ“åŒ…åˆ†æäº†ä¸‹ï¼Œç¡®å®å¦‚è€å¸ˆæ‰€æè¿°ï¼Œå¤–éƒ¨æ•°æ®å¸§çš„æºå’Œç›®çš„MACåœ°å€åˆ†åˆ«ä¸ºå®¿ä¸»æœºç½‘å¡çš„MACåœ°å€ï¼Œå¤–éƒ¨IPå¤´çš„æºå’Œç›®çš„åœ°å€åˆ†åˆ«ä¸ºå®¿ä¸»æœºçš„IPåœ°å€ï¼Œå†…éƒ¨æ•°æ®å¸§ä¸­çš„æºå’Œç›®çš„MACåœ°å€åˆ†åˆ«ä¸ºVTEPè®¾å¤‡çš„MACåœ°å€ï¼Œå†…éƒ¨IPå¤´çš„æºå’Œç›®çš„åœ°å€åˆ†åˆ«ä¸ºå®¹å™¨çš„IPåœ°å€ã€‚ä½†æ˜¯æœ‰ä¸ªé—®é¢˜ï¼Œåšäº†ä¸ªæµ‹è¯•ï¼Œåœ¨å®¹å™¨é‡Œé¢arpingå¦ä¸€ä¸ªå®¿ä¸»æœºä¸Šçš„å®¹å™¨åœ°å€ï¼Œå´å¾—ä¸åˆ°å›åº”ï¼Œè¿™æ˜¯ä¸ºä»€ä¹ˆï¼Ÿå¹¿æ’­åœ°å€ä¸ä¼šè¢«å°è£…å‡ºå»å—ï¼Ÿ","like_count":5,"discussions":[{"author":{"id":1162382,"avatar":"","nickname":"ç¥ç¯","note":"","ucode":"615A1404E157E2","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":21323,"discussion_content":"æˆ‘æŠ“åŒ…çš„æƒ…å†µæœ‰æ‰€ä¸åŒï¼Œæˆ‘æŠ“åŒ…æ˜¾ç¤ºå¤–å±‚æ•°æ®å¸§çš„æºç›®macåœ°å€åˆ†åˆ«æ˜¯å®¿ä¸»æœºçš„æºç›®macåœ°å€ï¼Œæºç›®ipåœ°å€åˆ†åˆ«æ˜¯å®¿ä¸»æœºçš„æºç›®ipåœ°å€ã€‚å†…å±‚æ•°æ®åŒ…çš„æºç›®macåœ°å€æ˜¯flannelçš„æºç›®macåœ°å€ï¼Œä½†æ˜¯æºIPæ˜¯æºflannelçš„åœ°å€ï¼Œç›®çš„IPåœ°å€æ˜¯ç›®çš„å®¹å™¨çš„IPï¼Œè¿™é‡Œä¸ºä»€ä¹ˆæºIPä¼šå˜æˆflannelçš„IPï¼Ÿæ˜¯é…ç½®æœ‰é—®é¢˜è¿˜æ˜¯å“ªé‡Œçš„é—®é¢˜ï¼Ÿå“ªä½è€å¸ˆå¸®å¿™åˆ†æä¸‹","likes_number":1,"is_delete":false,"is_hidden":false,"ctime":1569467604,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":1,"child_discussions":[{"author":{"id":2848426,"avatar":"","nickname":"Geek_7b826d","note":"","ucode":"0602900CB534A6","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":1162382,"avatar":"","nickname":"ç¥ç¯","note":"","ucode":"615A1404E157E2","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":562476,"discussion_content":"åŒé—®","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1649834120,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":21323,"ip_address":""},"score":562476,"extra":""}]},{"author":{"id":1172019,"avatar":"https://static001.geekbang.org/account/avatar/00/11/e2/33/3ca366bf.jpg","nickname":"å¯»æ‰¾ä¹Œæ‰˜é‚¦","note":"","ucode":"12143F0FAAAF2B","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":18221,"discussion_content":"å¯èƒ½æ˜¯Vxlançš„éš§é“å†…éƒ¨åšäº†å¹¿æ’­æŠ‘åˆ¶ã€‚ä½†æ˜¯æœ‰ä¸ªç–‘é—®ï¼ŒäºŒå±‚é€šä¿¡å¦‚ä½•è¿‡å»å®¹å™¨MAC","likes_number":1,"is_delete":false,"is_hidden":false,"ctime":1569033735,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":1,"child_discussions":[{"author":{"id":1446375,"avatar":"https://static001.geekbang.org/account/avatar/00/16/11/e7/044a9a6c.jpg","nickname":"bookå°¾æ±","note":"","ucode":"AE2B8DFC643ACC","race_medal":0,"user_type":1,"is_pvip":true},"reply_author":{"id":1172019,"avatar":"https://static001.geekbang.org/account/avatar/00/11/e2/33/3ca366bf.jpg","nickname":"å¯»æ‰¾ä¹Œæ‰˜é‚¦","note":"","ucode":"12143F0FAAAF2B","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":189330,"discussion_content":"è¿™ä¸ªæœ‰äº†å®¹å™¨çš„ipåœ°å€ï¼Œä¼šæ ¹æ®è·¯ç”±è¡¨è½¬å‘åˆ°ç½‘æ¡¥ï¼Œç½‘æ¡¥åœ¨æ ¹æ®è‡ªå·±ç»´æŠ¤çš„è·¯ç”±è¡¨é€‰æ‹©å¯¹åº”çš„viræ¥å£è¿›è¡Œè½¬å‘å°±åˆ°å®¹å™¨äº†å§","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1582870276,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":18221,"ip_address":""},"score":189330,"extra":""}]},{"author":{"id":1412891,"avatar":"","nickname":"æ€ç»´å†³å®šæœªæ¥","note":"","ucode":"88CC245B3C6E2D","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":3971,"discussion_content":"VETPè®¾å¤‡çš„MACåœ°å€ä¸å°±æ˜¯å®¿ä¸»æœºçš„MACåœ°å€å—ï¼Ÿ","likes_number":1,"is_delete":false,"is_hidden":false,"ctime":1565012260,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":1,"child_discussions":[{"author":{"id":1566413,"avatar":"https://static001.geekbang.org/account/avatar/00/17/e6/cd/bf5e928c.jpg","nickname":"å°å¤ªé˜³","note":"","ucode":"80FD4A871ABFAD","race_medal":0,"user_type":1,"is_pvip":true},"reply_author":{"id":1412891,"avatar":"","nickname":"æ€ç»´å†³å®šæœªæ¥","note":"","ucode":"88CC245B3C6E2D","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":4776,"discussion_content":"ä¸æ˜¯ã€‚å®¿ä¸»æœºä¸Šå¯ä»¥æœ‰å¤šä¸ªvtep","likes_number":4,"is_delete":false,"is_hidden":false,"ctime":1565712278,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":3971,"ip_address":""},"score":4776,"extra":""}]},{"author":{"id":2032032,"avatar":"https://static001.geekbang.org/account/avatar/00/1f/01/a0/07ca2bd2.jpg","nickname":"ä¸€è·¯é¡ºé£","note":"","ucode":"D46B7F92D65189","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":355766,"discussion_content":"è¯·é—®å°è£…çš„udpæ˜¯é€šè¿‡ä»€ä¹ˆç«¯å£å‘é€å’Œæ¥æ”¶å‘¢ï¼Œè¿™ä¸ªç«¯å£æ˜¯å›ºå®šçš„å—ï¼Ÿ","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1615474140,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":1,"child_discussions":[{"author":{"id":1057843,"avatar":"https://static001.geekbang.org/account/avatar/00/10/24/33/bcf37f50.jpg","nickname":"é˜¿ç”˜","note":"","ucode":"BC93175B70E05D","race_medal":0,"user_type":1,"is_pvip":true},"reply_author":{"id":2032032,"avatar":"https://static001.geekbang.org/account/avatar/00/1f/01/a0/07ca2bd2.jpg","nickname":"ä¸€è·¯é¡ºé£","note":"","ucode":"D46B7F92D65189","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":540500,"discussion_content":"äº’è”ç½‘å·ç åˆ†é…å±€ï¼ˆInternet Assigned Numbers Authorityï¼ŒIANAï¼‰ä¹Ÿä¸“é—¨åˆ†é…äº† 4789 ä½œä¸º VTEP è®¾å¤‡çš„ UDP ç«¯å£ï¼ˆä»¥å‰ Linux VXLAN ç”¨çš„é»˜è®¤ç«¯å£æ˜¯ 8472ï¼Œç›®å‰è¿™ä¸¤ä¸ªç«¯å£åœ¨è®¸å¤šåœºæ™¯ä¸­ä»æœ‰å¹¶å­˜çš„æƒ…å†µï¼‰ã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1640070305,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":355766,"ip_address":""},"score":540500,"extra":""}]},{"author":{"id":2054990,"avatar":"","nickname":"æµ·æŸ”å„¿ç¨€ç½•","note":"","ucode":"CBEEBEA2CAE8A7","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":290890,"discussion_content":"ä¸é”™","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1594633666,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":2054990,"avatar":"","nickname":"æµ·æŸ”å„¿ç¨€ç½•","note":"","ucode":"CBEEBEA2CAE8A7","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":290889,"discussion_content":"ä¸é”™","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1594633646,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":261803,"user_name":"ch_ort","can_delete":false,"product_type":"c1","uid":1580926,"ip_address":"","ucode":"B79746E687F29E","user_header":"","comment_is_top":false,"comment_ctime":1605528026,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"18785397210","product_id":100015201,"comment_content":"å®¹å™¨â€œè·¨ä¸»é€šä¿¡â€çš„ä¸‰ç§ä¸»æµå®ç°æ–¹æ³•ï¼šUDPã€host-gwã€VXLANï¼Œå…¶ä¸­ï¼š<br>ï¼ˆ1ï¼‰UDPï¼šæœ€ç›´æ¥ã€æœ€å®¹æ˜“ç†è§£ã€æ€§èƒ½æœ€å·®çš„å®ç°æ–¹å¼ ã€‚ æ¯”å¦‚Flannelçš„å®ç°ä¸­ï¼Œflanneldå°†ä¸åŒå®¿ä¸»æœºåˆ’åˆ†æˆä¸åŒçš„å­ç½‘ï¼Œä¸åŒçš„å®¹å™¨æ‰€åœ¨çš„å®¿ä¸»æœºä¸åŒåˆ™å­ç½‘ä¹Ÿä¸åŒï¼Œè¿™äº›&lt;å®¿ä¸»æœº,å­ç½‘&gt;ä¿¡æ¯å­˜å‚¨åœ¨etcdä¸­ã€‚å½“å®¹å™¨éœ€è¦â€œè·¨ä¸»é€šä¿¡â€æ—¶ï¼Œ flanneldè¿›ç¨‹ä¼šå°†å‘å‡ºç«¯çš„IPåŒ…è¿›è¡ŒUDPå°è£…ï¼Œç„¶åå‘é€åˆ°ç›®çš„ç«¯çš„å®¿ä¸»æœºä¸Šï¼Œç›®çš„ç«¯çš„å®¿ä¸»æœºçš„flanneldå†è¿›è¡Œè§£å°è£…å‘é€ç»™å¯¹åº”çš„å®¹å™¨æ¥ä½¿ç”¨ã€‚<br><br>ï¼ˆ2ï¼‰VXLANï¼š  Virtual Extensible LANï¼ˆè™šæ‹Ÿå¯æ‰©å±•å±€åŸŸç½‘ï¼‰ï¼Œé€šè¿‡VXLANæŠ€æœ¯åœ¨å†…æ ¸æ€ä¸Šå®ç°äº†UDPæ–¹å¼çš„å°è£…å’Œè§£å°è£…ï¼Œæé«˜äº†æ€§èƒ½ï¼Œå³ç”¨VTEPå®ç°äº†flanneldè¿›ç¨‹çš„åŠŸèƒ½<br>","like_count":4},{"had_liked":false,"id":235310,"user_name":"æµ·æŸ”å„¿ç¨€ç½•","can_delete":false,"product_type":"c1","uid":2054990,"ip_address":"","ucode":"CBEEBEA2CAE8A7","user_header":"","comment_is_top":false,"comment_ctime":1594969401,"is_pvip":false,"discussion_count":1,"race_medal":0,"score":"18774838585","product_id":100015201,"comment_content":"æå¼€å‘çš„è¯´ç½‘ç»œï¼Œå¾ˆç®€å•çš„ç½‘ç»œé“ç†è®²çš„å•°é‡Œå•°å—¦ï¼Œè®©æç½‘ç»œçš„çœ‹çš„è´¹åŠ²ã€‚ä¸¤ä»¶äº‹æ•°æ®å¹³é¢å’Œæ§åˆ¶å¹³é¢ä»¥åŠæ•°æ®åŒ…åœ¨æ¯ä¸ªè½¬å‘é˜¶æ®µæ˜¯å¦‚ä½•å°è£…è§£å°è£…çš„éœ€è¦æŸ¥ä»€ä¹ˆè¡¨ã€‚<br>è¿˜æœ‰K8Så±äºPAASå°±ä¸åº”è¯¥æœ‰å¤šç§Ÿæˆ·è¯´æ³•ï¼Œå¤šç§Ÿæˆ·æ˜¯IAASå±‚é¢çš„ã€‚K8Sä»åº•å±‚ç½‘ç»œå±‚é¢å°±åšä¸åˆ°IAASå±‚é¢çš„ç§Ÿæˆ·åœ°å€ç©ºé—´çš„éš”ç¦»å’Œè§£å†³åœ°å€é‡å ã€‚","like_count":4,"discussions":[{"author":{"id":1095819,"avatar":"https://static001.geekbang.org/account/avatar/00/10/b8/8b/68555cbf.jpg","nickname":"Geek_122dd9","note":"","ucode":"12BDEF1FC06633","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":586206,"discussion_content":"ä¸æ˜¯æ¯ä¸ªäººéƒ½è·Ÿä½ ä¸€æ ·ç†Ÿæ‚‰ç½‘ç»œ","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1662033039,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":"å¹¿ä¸œ"},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":153066,"user_name":"djfhchdh","can_delete":false,"product_type":"c1","uid":1484184,"ip_address":"","ucode":"E71D75328CE398","user_header":"https://static001.geekbang.org/account/avatar/00/16/a5/98/a65ff31a.jpg","comment_is_top":false,"comment_ctime":1574151535,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"18754020719","product_id":100015201,"comment_content":"å…³é”®æ˜¯é‚£ä¸ªfdbï¼Œå¦‚æœfdbèƒ½å¤Ÿè®°å½•å®¹å™¨macå’Œå®¿ä¸»æœºipçš„å¯¹åº”å…³ç³»ï¼Œé‚£å°±å¯ä»¥ä¿è¯äºŒå±‚è¿é€šæ€§","like_count":4},{"had_liked":false,"id":37306,"user_name":"xianhai","can_delete":false,"product_type":"c1","uid":1073505,"ip_address":"","ucode":"906578663CEB3E","user_header":"https://static001.geekbang.org/account/avatar/00/10/61/61/677e8f92.jpg","comment_is_top":false,"comment_ctime":1541545099,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"14426446987","product_id":100015201,"comment_content":"etcdctl ls è¿™ä¸ªå‘½ä»¤ä¸å­˜åœ¨å•Šã€‚<br>æˆ‘æ˜¯ç”¨è¿™ä¸ªå‘½ä»¤å®‰è£…etcdctlçš„ï¼šgo get github.com&#47;coreos&#47;etcd&#47;cmd&#47;etcdctl<br><br>æå®¢æ—¶é—´ç‰ˆæƒæ‰€æœ‰: https:&#47;&#47;time.geekbang.org&#47;column&#47;article&#47;65287","like_count":3},{"had_liked":false,"id":325927,"user_name":"æˆ‘æ¥çƒ¤çƒ¤ä½ ","can_delete":false,"product_type":"c1","uid":2268886,"ip_address":"","ucode":"C0444817B6B16F","user_header":"https://static001.geekbang.org/account/avatar/00/22/9e/d6/4b07f8b5.jpg","comment_is_top":false,"comment_ctime":1639236900,"is_pvip":false,"discussion_count":1,"race_medal":0,"score":"10229171492","product_id":100015201,"comment_content":"VXLANçš„å®ç°è¿‡ç¨‹ä¸ºä»€ä¹ˆä¸€å®šè¦å¥—ä¸€ä¸ªUDPåœ¨ä¸­é—´ï¼Ÿï¼Ÿï¼Ÿéå¸¸è´¹è§£","like_count":2,"discussions":[{"author":{"id":1264563,"avatar":"https://static001.geekbang.org/account/avatar/00/13/4b/b3/01d64240.jpg","nickname":"é¾Ÿé¾ŸğŸ¢","note":"","ucode":"C53C0D15C9EA83","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":574580,"discussion_content":"åè¿‡æ¥æƒ³å¯èƒ½å°±æ˜ç™½äº†ï¼Œå¦‚æœæ²¡æœ‰è¿™ä¸ªUDP headerï¼Œä½ å»å®ç°vxlanæ€ä¹ˆå°è£…è¿™ä¸ªether frame","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1654159758,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":293631,"user_name":"ç½—å³°","can_delete":false,"product_type":"c1","uid":1218501,"ip_address":"","ucode":"5F3D6AF8F28322","user_header":"https://static001.geekbang.org/account/avatar/00/12/97/c5/84491beb.jpg","comment_is_top":false,"comment_ctime":1621472561,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"10211407153","product_id":100015201,"comment_content":"ç¡®å®å›¾å¤šæœ¯è¯­å°‘ï¼ŒåŸºç¡€å·®çš„äººä¹Ÿèƒ½æ˜ç™½ä¸ªå¤§æ¦‚","like_count":2},{"had_liked":false,"id":284098,"user_name":"æˆ‘æ˜¯è°","can_delete":false,"product_type":"c1","uid":1131907,"ip_address":"","ucode":"AE3996142811F4","user_header":"https://static001.geekbang.org/account/avatar/00/11/45/83/93d389ba.jpg","comment_is_top":false,"comment_ctime":1616063291,"is_pvip":false,"discussion_count":4,"race_medal":0,"score":"10205997883","product_id":100015201,"comment_content":"è€å¸ˆè¯·æ•™2ä¸ªé—®é¢˜å“ˆï¼Œ<br>1. vxlanåè®®ä¸­ï¼Œå†…å±‚macå¤´åº”è¯¥æ˜¯æºè™šæ‹Ÿæœºå’Œç›®æ ‡è™šæ‹Ÿæœºçš„macåœ°å€ï¼Œå¤–å±‚ipå¤´æ˜¯æºå’Œç›®çš„ç«¯vtepè®¾å¤‡çš„ipï¼Œå¤–å±‚macå¤´æ˜¯æºå’Œç›®çš„ç«¯vtepè®¾å¤‡çš„macåœ°å€ã€‚ä¸ºä»€ä¹ˆflannelçš„vxlanæ–¹æ¡ˆä¸­ä¸æ˜¯è¿™ä¸ªæ ·å­ï¼Œæ˜¯flanneldå¯¹flannel.1è®¾å¤‡å°åŒ…è§£åŒ…è¿›è¡Œäº†è°ƒæ•´å—ï¼Ÿè¿™ä¸ªåœ°æ–¹æœ‰å¾ˆå¤§ç–‘è™‘<br>2. flannel.1è¿™ä¸ªvtepè®¾å¤‡å°åŒ…æ˜¯ä¼šå°è£…åˆ°å¤–å±‚çš„macå¤´æ‰ç®—å°è£…å®Œæ¯•å—ï¼Ÿè¿˜æ˜¯åªæ˜¯å°è£…åˆ°æ·»åŠ vxlanå¤´ï¼Œå…¶ä»–çš„äº¤ç”±å†…æ ¸å®Œæˆçš„ï¼Ÿå› ä¸ºæˆ‘çœ‹æ–‡ç« ä»‹ç»ï¼Œflannel.1è§£åŒ…æ—¶ä»å†…å±‚æ•°æ®åŒ…å¼€å§‹è§£æçš„ã€‚æ‰€ä»¥è¿™ä¸€å—ä¹Ÿå¾ˆè¿·æƒ‘ã€‚","like_count":2,"discussions":[{"author":{"id":2848426,"avatar":"","nickname":"Geek_7b826d","note":"","ucode":"0602900CB534A6","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":562979,"discussion_content":"è¿™ä¸ªé—®é¢˜å¯ä»¥å›åˆ°ä¸€ä¸‹å—","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1649919441,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":2848426,"avatar":"","nickname":"Geek_7b826d","note":"","ucode":"0602900CB534A6","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":562477,"discussion_content":"åŒé—®åœ¨flannelä¸ŠæŠ“åŒ…ä¸ºå•¥æŠ“ä¸åˆ°vxlançš„åŒ…ï¼Œåªåœ¨å®¿ä¸»æœºä¸ŠæŠ“åŒ…æŠ“åˆ°äº†vxlançš„åŒ…","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1649834246,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1135299,"avatar":"https://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTKzqiaZnBw2myRWY802u48Rw3W2zDtKoFQ6vN63m4FdyjibM21FfaOYe8MbMpemUdxXJeQH6fRdVbZA/132","nickname":"kissingers","note":"","ucode":"615151808CF628","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":379714,"discussion_content":"åŒé—®","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1624090801,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":2449777,"avatar":"https://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTLDUJyeq54fiaXAgF62tNeocO3lHsKT4mygEcNoZLnibg6ONKicMgCgUHSfgW8hrMUXlwpNSzR8MHZwg/132","nickname":"types","note":"","ucode":"8B50927EF1804F","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":360213,"discussion_content":"åŒæ ·çš„é—®é¢˜ï¼Œvxlanä¸­outer source ip/macæ˜¯è‡ªèº«vtepè®¾å¤‡çš„ã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1616390760,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":62168,"user_name":"å‡Œ","can_delete":false,"product_type":"c1","uid":1257995,"ip_address":"","ucode":"41369B360C794F","user_header":"https://static001.geekbang.org/account/avatar/00/13/32/0b/81ae214b.jpg","comment_is_top":false,"comment_ctime":1547966927,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"10137901519","product_id":100015201,"comment_content":"flannelçš„åŸºç¡€æ˜¯ä¸åŒnodeåˆ†å­ç½‘è¿™æ˜¯ä¸‰å±‚çš„æ¦‚å¿µï¼ŒäºŒå±‚æ˜¾ç„¶æ— æ³•æ»¡è¶³","like_count":2},{"had_liked":false,"id":43113,"user_name":"jssfy","can_delete":false,"product_type":"c1","uid":1137238,"ip_address":"","ucode":"F16353CFE607B7","user_header":"https://static001.geekbang.org/account/avatar/00/11/5a/56/115c6433.jpg","comment_is_top":false,"comment_ctime":1543170176,"is_pvip":false,"replies":[{"id":"15415","content":"ä¸»æœºä¸Šçš„agentè¦è´Ÿè´£ç»´æŠ¤è¿™äº›ä¿¡æ¯","user_name":"ä½œè€…å›å¤","user_name_real":"Geek_6ef93d","uid":"1218095","ctime":1543192223,"ip_address":"","comment_id":43113,"utype":1}],"discussion_count":1,"race_medal":0,"score":"10133104768","product_id":100015201,"comment_content":"è¯·é—®bridge fdbçœ‹åˆ°çš„å…¶å®ƒèŠ‚ç‚¹vtepçš„å¯¹åº”å…³ç³»vtepæ˜¯å„èŠ‚ç‚¹ä¸»åŠ¨æ³¨å†Œçš„ï¼Ÿ","like_count":2,"discussions":[{"author":{"id":1218095,"avatar":"https://static001.geekbang.org/account/avatar/00/12/96/2f/876085fa.jpg","nickname":"å¼ ç£Š Kubernetes","note":"","ucode":"16E29BDAB1F5BC","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":430301,"discussion_content":"ä¸»æœºä¸Šçš„agentè¦è´Ÿè´£ç»´æŠ¤è¿™äº›ä¿¡æ¯","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1543192223,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":41522,"user_name":"å°è°¢åŒå­¦","can_delete":false,"product_type":"c1","uid":1032544,"ip_address":"","ucode":"E809E6BC470631","user_header":"https://static001.geekbang.org/account/avatar/00/0f/c1/60/fc3689d0.jpg","comment_is_top":false,"comment_ctime":1542800183,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"10132734775","product_id":100015201,"comment_content":"è¯·é—®ä¸ºä»€ä¹ˆvxlanä¸€å®šè¦ä½¿ç”¨udpå»ºç«‹è¿æ¥å‘¢ï¼Ÿ","like_count":2},{"had_liked":false,"id":37389,"user_name":"è™è™â¤ï¸","can_delete":false,"product_type":"c1","uid":1086535,"ip_address":"","ucode":"157F261E80291A","user_header":"https://static001.geekbang.org/account/avatar/00/10/94/47/75875257.jpg","comment_is_top":false,"comment_ctime":1541565437,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"10131500029","product_id":100015201,"comment_content":"åŸºäºudp backendçš„flannelä¸èƒ½å®ç°2å±‚è¿é€šï¼Œflannel0æ˜¯tunè®¾å¤‡ï¼Œå·¥ä½œåœ¨ä¸‰å±‚ç½‘ç»œã€‚<br><br>åŸºäºvxlan backendçš„flannelæˆ‘è®¤ä¸ºå¯ä»¥å®ç°2å±‚è¿é€šã€‚vxlanå°è£…è½¬å‘çš„æ˜¯äºŒå±‚æ•°æ®å¸§ï¼Œæ•´ä¸ªflannelç½‘ç»œé‡Œåªæœ‰äº¤æ¢è®¾å¤‡ï¼Œè®¾å¤‡éƒ½åœ¨ä¸€ä¸ªå¹¿æ’­åŸŸé‡Œã€‚æ‰€ä»¥å³ä½¿arpè¡¨é‡Œæ²¡æœ‰è®°å½•ä¹Ÿå¯ä»¥é€šè¿‡å¹¿æ’­å®ç°2å±‚è¿é€šã€‚flannel.1å¯ä»¥é€šè¿‡æ‰‹åŠ¨ç»´æŠ¤fdbè¡¨ï¼ˆè®°å½•ç›®çš„å®¹å™¨çš„macåœ°å€å’Œå…¶æ‰€åœ¨ä¸»æœºçš„æ˜ å°„ï¼‰ï¼Œæˆ–è€…åœ¨vtepåˆ†ç»„ä¸­è¿›è¡Œå¹¿æ’­ï¼Œæ¥æ‰¾åˆ°ç›®çš„VTEPï¼Œè¿›è€Œè½¬å‘åˆ°ç›®çš„å®¹å™¨ã€‚","like_count":2},{"had_liked":false,"id":37355,"user_name":"Acter","can_delete":false,"product_type":"c1","uid":1082561,"ip_address":"","ucode":"EF747BEAD2A797","user_header":"https://static001.geekbang.org/account/avatar/00/10/84/c1/dfcad82a.jpg","comment_is_top":false,"comment_ctime":1541554650,"is_pvip":true,"discussion_count":1,"race_medal":0,"score":"10131489242","product_id":100015201,"comment_content":"æ–‡ä¸­æ‰€è¿°â€œcontainer-1é‡Œçš„è¿›ç¨‹å‘èµ·çš„IPåŒ…ï¼Œæ ¹æ®é»˜è®¤è·¯ç”±è§„åˆ™ï¼Œé€šè¿‡å®¹å™¨çš„ç½‘å…³è¿›å…¥docker0ç½‘æ¡¥ï¼Œä»è€Œå‡ºç°åœ¨å®¿ä¸»æœºä¸Šã€‚â€è¯·é—®è€å¸ˆâ€œå®¹å™¨çš„ç½‘å…³â€æ˜¯è°ï¼Ÿ","like_count":2,"discussions":[{"author":{"id":1158275,"avatar":"https://static001.geekbang.org/account/avatar/00/11/ac/83/2f143a22.jpg","nickname":"é›ªç²®","note":"","ucode":"363A83AC7CE8B6","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":26745,"discussion_content":"å®¹å™¨çš„ç½‘å…³å°±æ˜¯docker0æ¡¥","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1570616571,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":318011,"user_name":"é™ˆæ–¯ä½³","can_delete":false,"product_type":"c1","uid":1259323,"ip_address":"","ucode":"C236F874FC767A","user_header":"https://static001.geekbang.org/account/avatar/00/13/37/3b/495e2ce6.jpg","comment_is_top":false,"comment_ctime":1635123285,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"5930090581","product_id":100015201,"comment_content":"ç¬¬ä¸‰åä¸‰è¯¾:æ·±å…¥è§£æå®¹å™¨è·¨ä¸»æœºç½‘ç»œ<br>åœ¨Linuxä¸­ï¼ŒTUNè®¾å¤‡æ˜¯ä¸€ç§å·¥ä½œåœ¨ä¸‰å±‚ï¼ˆNetwork Layerï¼‰çš„è™šæ‹Ÿç½‘ç»œè®¾å¤‡ï¼Œå®ƒçš„åŠŸèƒ½æ˜¯åœ¨æ“ä½œç³»ç»Ÿå†…æ ¸å’Œç”¨æˆ·åº”ç”¨ç¨‹åºä¹‹é—´ä¼ é€’IPåŒ…ã€‚<br><br>Funnelçš„å­ç½‘å’Œå®¿ä¸»æœºçš„å¯¹åº”å…³ç³»ä¿å­˜åœ¨etcdä¸­<br><br>Funnel UDP æ¨¡å¼æä¾›çš„å…¶å®æ˜¯ä¸€ä¸ªä¸‰å±‚çš„Overlayç½‘ç»œï¼Œå³ï¼šå®ƒé¦–å…ˆå¯¹å‘å‡ºç«¯çš„IPåŒ…è¿›è¡ŒUDPå°è£…ï¼Œç„¶ååœ¨æ¥æ”¶ç«¯è¿›è¡Œè§£å°è£…æ‹¿åˆ°åŸå§‹çš„IPåŒ…ï¼Œè¿›è€ŒæŠŠè¿™ä¸ªIPåŒ…è½¬å‘ç»™ç›®æ ‡å®¹å™¨ã€‚<br><br>VXLANçš„è¦†ç›–ç½‘ç»œè®¾è®¡æ€æƒ³æ˜¯ï¼šåœ¨ç°æœ‰çš„ä¸‰å±‚ç½‘ç»œä¹‹ä¸Šè¦†ç›–ä¸€å±‚è™šæ‹Ÿçš„ã€ç”±å†…æ ¸VXLANæ¨¡å—è´Ÿè´£ç»´æŠ¤çš„äºŒå±‚ç½‘ç»œï¼Œä½¿å¾—è¿æ¥åœ¨è¿™ä¸ªVXLANäºŒå±‚ç½‘ç»œä¸Šçš„â€œä¸»æœºâ€ä¹‹é—´ï¼Œå¯ä»¥åƒåœ¨åŒä¸€ä¸ªLANå±€åŸŸç½‘é‡Œé‚£æ ·è‡ªç”±çš„é€šä¿¡ã€‚","like_count":1},{"had_liked":false,"id":303290,"user_name":"Ilovek8s","can_delete":false,"product_type":"c1","uid":1542450,"ip_address":"","ucode":"64DF0F7D0CF0B0","user_header":"http://thirdwx.qlogo.cn/mmopen/vi_32/a8PMLmCTCBa40j7JIy3d8LsdbW5hne7lkk9KOGQuiaeVk4cn06KWwlP3ic69BsQLpNFtRTjRdUM2ySDBAv1MOFfA/132","comment_is_top":false,"comment_ctime":1626703650,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"5921670946","product_id":100015201,"comment_content":"ä½ è®¤ä¸º Flannel èƒ½è´Ÿè´£ä¿è¯äºŒå±‚ç½‘ç»œï¼ˆMAC åœ°å€ï¼‰çš„è¿é€šæ€§å—ï¼Ÿä¸ºä»€ä¹ˆå‘¢ï¼Ÿ<br>ç­”ï¼šä¸èƒ½ï¼Œå› ä¸ºæœ€æ–°ç‰ˆçš„flannelå·²ç»ä¸ä¾èµ–L3 MISSäº‹ä»¶å’ŒARPå­¦ä¹ ï¼Œflannelå¯åŠ¨æ—¶å°±ä¼šåœ¨æ¯ä¸ªèŠ‚ç‚¹å°†vtepä¸macå¯¹åº”èµ·æ¥ï¼Œè€Œå°è£…èµ·æ¥çš„å†…éƒ¨æ•°æ®å¸§å¯¹å®¿ä¸»æœºä¹‹é—´çš„é€šä¿¡æ˜¯æ²¡æœ‰æ„ä¹‰çš„ï¼Œå¿…é¡»å†å°è£…ä¸€å±‚èŠ‚ç‚¹ä¹‹é—´çš„åŒ…å¤´ï¼Œä½†è¿™æ—¶å€™çš„å¤–å±‚åŒ…å¤´ä¿¡æ¯åˆä¸èƒ½ä¿è¯å®¹å™¨ä¹‹é—´çš„äºŒå±‚è¿é€šä¿¡","like_count":1},{"had_liked":false,"id":221202,"user_name":"superkong","can_delete":false,"product_type":"c1","uid":1066996,"ip_address":"","ucode":"D43F0D6B236B7E","user_header":"https://static001.geekbang.org/account/avatar/00/10/47/f4/a7389cd3.jpg","comment_is_top":false,"comment_ctime":1590425433,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"5885392729","product_id":100015201,"comment_content":"éå¸¸ç²¾å½©ï¼","like_count":1},{"had_liked":false,"id":149376,"user_name":"å¥¶çˆ¸ç†Šå¤§","can_delete":false,"product_type":"c1","uid":1518372,"ip_address":"","ucode":"8C4BF29560B218","user_header":"https://static001.geekbang.org/account/avatar/00/17/2b/24/1ad936e6.jpg","comment_is_top":false,"comment_ctime":1573204680,"is_pvip":true,"discussion_count":0,"race_medal":0,"score":"5868171976","product_id":100015201,"comment_content":"æ‚¨å¥½ï¼Œcalico èŠ‚ç‚¹èƒ½å¦ä¸èŠ‚ç‚¹é—´è·¯ç”±å™¨å»ºç«‹ bdp è¿æ¥ï¼Œè¿™æ ·å°±çœå»äº†ipipæ¨¡å¼çš„æ€§èƒ½æŸè€—ã€‚","like_count":1},{"had_liked":false,"id":114328,"user_name":"iGeneral","can_delete":false,"product_type":"c1","uid":1274314,"ip_address":"","ucode":"F7EA381C34955E","user_header":"https://static001.geekbang.org/account/avatar/00/13/71/ca/87688ff9.jpg","comment_is_top":false,"comment_ctime":1563275124,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"5858242420","product_id":100015201,"comment_content":"æƒ³èµ·æ¥åŸæ¥åšæ¯•ä¸šè®¾è®¡çš„æ—¶å€™ï¼Œè·¨ä¸»æœºç›´æ¥å®¹å™¨çš„é€šä¿¡å¥½åƒç›´æ¥ç”¨çš„etcdæœåŠ¡å‘ç°ï¼Œç›´æ¥å§dockerçš„ç½‘ç»œæš´éœ²å‡ºå»ï¼Œç„¶åä¾èµ–etcdæ¥åšçš„è·¨ä¸»æœºé€šä¿¡ã€‚ å…¶å®è¿˜å¯ä»¥","like_count":1},{"had_liked":false,"id":73742,"user_name":"å½¦","can_delete":false,"product_type":"c1","uid":1125048,"ip_address":"","ucode":"13EE4093C488A5","user_header":"https://static001.geekbang.org/account/avatar/00/11/2a/b8/edbafb82.jpg","comment_is_top":false,"comment_ctime":1551967139,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"5846934435","product_id":100015201,"comment_content":"è¯·é—®ï¼ŒæŸä¸ªèŠ‚ç‚¹ä¸Šflannelè¿›ç¨‹å¯åŠ¨åï¼Œä¼šå‘é€ç›¸å…³çŠ¶æ€åˆ°å…¶ä»–èŠ‚ç‚¹---é‚£ä¹ˆï¼Œè¿™ä¸ªå…±äº«çš„é…ç½®ä¿¡æ¯æ˜¯ä¸æ˜¯ç»è¿‡Etcdå¤„ç†çš„ï¼ŸFDBè¿™ä¸ªè½¬å‘æ•°æ®åº“æ˜¯ä¸æ˜¯ä¹Ÿæ˜¯åœ¨è¿™ä¸ªæ—¶æœºå½¢æˆçš„ï¼Ÿ è¿™æ · åœ¨æ‰“ä¸Šå¤–å±‚æ ‡ç­¾æ—¶å°±è¿™ç›´æ¥ä»å†…æ ¸æ€è¿›è¡Œæ“ä½œï¼Œä»è€Œæ•ˆç‡æ¯”è¾ƒé«˜ã€‚","like_count":1},{"had_liked":false,"id":44284,"user_name":"å‘¨å¨„å­","can_delete":false,"product_type":"c1","uid":1228039,"ip_address":"","ucode":"18A1E6926C095A","user_header":"https://static001.geekbang.org/account/avatar/00/12/bd/07/bf8c31fb.jpg","comment_is_top":false,"comment_ctime":1543400149,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"5838367445","product_id":100015201,"comment_content":"container vethè®¾å¤‡éƒ½æ˜¯attachåœ¨bridgeä¸Šçš„, åº”è¯¥æ— æ³•ä¿è¯äºŒå±‚ç½‘ç»œï¼ˆMAC åœ°å€ï¼‰çš„è¿é€šæ€§<br>","like_count":1},{"had_liked":false,"id":37994,"user_name":"blackpiglet","can_delete":false,"product_type":"c1","uid":1032928,"ip_address":"","ucode":"58AA8329C91767","user_header":"https://static001.geekbang.org/account/avatar/00/0f/c2/e0/7188aa0a.jpg","comment_is_top":false,"comment_ctime":1541844697,"is_pvip":false,"discussion_count":1,"race_medal":0,"score":"5836811993","product_id":100015201,"comment_content":"æ€è€ƒé¢˜ï¼šFlannel èƒ½è´Ÿè´£ä¿è¯äºŒå±‚ç½‘ç»œï¼ˆMAC åœ°å€ï¼‰çš„è¿é€šæ€§å—ï¼Ÿ<br><br>å›ç­”ï¼šæˆ‘è§‰å¾—ä¸èƒ½ï¼ŒFlannel çš„å·¥ä½œæ¨¡å¼éƒ½æ˜¯æ ¹æ® IP æ¥åˆ¤æ–­ä¸‹ä¸€æ¡è·³è½¬åˆ°å“ªä¸ªç½‘ç»œè®¾å¤‡ä¸Šï¼Œæ˜¯åŸºäºä¸‰å±‚åšè·¯ç”±ã€‚å¦‚æœè¦åŸºäº MAC åšå¯»å€çš„è¯ï¼ŒFlannel æ— æ³•çŸ¥é“å…¶ä»–ä¸»æœºä¸Šçš„å®¹å™¨çš„ MAC åœ°å€ï¼Œæ‰€ä»¥æ— æ³•è½¬å‘ã€‚","like_count":1,"discussions":[{"author":{"id":1584072,"avatar":"https://static001.geekbang.org/account/avatar/00/18/2b/c8/3692a09c.jpg","nickname":"åˆ˜æ–‡","note":"","ucode":"DCA71276CA2C49","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":414157,"discussion_content":"åº”è¯¥æ˜¯çš„ï¼ŒåŸºäºmacåœ°å€åªèƒ½è½¬å‘åˆ°å®¿ä¸»æœºï¼Œæ— æ³•ç›´æ¥åˆ°è¾¾è™šæ‹Ÿè®¾å¤‡","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1636679347,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":37865,"user_name":"Len","can_delete":false,"product_type":"c1","uid":1022767,"ip_address":"","ucode":"53C623CE17973F","user_header":"https://static001.geekbang.org/account/avatar/00/0f/9b/2f/b7a3625e.jpg","comment_is_top":false,"comment_ctime":1541755459,"is_pvip":true,"discussion_count":0,"race_medal":0,"score":"5836722755","product_id":100015201,"comment_content":"åœ¨åŒä¸€ä¸ªç½‘ç»œé‡Œï¼Œæ·»åŠ å®¹å™¨ç½‘ç»œå’Œå„ä¸»æœºä¹‹é—´çš„æ˜ å°„ï¼Œèƒ½è¾¾åˆ°è¿é€šæ€§ï¼Œä¸åœ¨ä¸€ä¸ªç½‘ç»œé‡Œåº”è¯¥æ²¡å‘åšåˆ°äºŒå±‚ç½‘ç»œçš„è¿é€šæ€§å§ï¼Ÿä¸çŸ¥é“å›ç­”çš„å¯¹ä¸å¯¹ã€‚","like_count":1},{"had_liked":false,"id":37617,"user_name":"è‰¾æ–¯Zè‰¾ç©†","can_delete":false,"product_type":"c1","uid":1107498,"ip_address":"","ucode":"DAA7686EC80430","user_header":"https://static001.geekbang.org/account/avatar/00/10/e6/2a/2ac18fb8.jpg","comment_is_top":false,"comment_ctime":1541652844,"is_pvip":false,"replies":[{"id":"13575","content":"çœ‹serviceéƒ¨åˆ†è®²è§£","user_name":"ä½œè€…å›å¤","user_name_real":"Geek_6ef93d","uid":"1218095","ctime":1541719345,"ip_address":"","comment_id":37617,"utype":1}],"discussion_count":1,"race_medal":0,"score":"5836620140","product_id":100015201,"comment_content":"æ‚¨å¥½ï¼Œæˆ‘é‡åˆ°ä¸€ä¸ªé—®é¢˜<br>æˆ‘åœ¨ä¸€ä¸ªè¢«serviceé€‰ä¸­çš„appé‡Œè®¿é—®ä¸äº†è¿™ä¸ªserviceçš„portå¯ä»¥pingé€šï¼Œç”¨podçš„ipå¯ä»¥è®¿é—®åˆ°ç«¯å£<br>åˆ«çš„podå¯ä»¥è®¿é—®åˆ°serviceçš„port<br>è¿™ä¸ªpodä¹Ÿå¯ä»¥è®¿é—®åˆ«çš„serviceçš„port<br>kube-proxyç”¨çš„æ¨¡å¼æ˜¯ipvs","like_count":1,"discussions":[{"author":{"id":1218095,"avatar":"https://static001.geekbang.org/account/avatar/00/12/96/2f/876085fa.jpg","nickname":"å¼ ç£Š Kubernetes","note":"","ucode":"16E29BDAB1F5BC","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":428427,"discussion_content":"çœ‹serviceéƒ¨åˆ†è®²è§£","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1541719345,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":37520,"user_name":"æœˆäº®ä¸Šçœ‹æ˜Ÿæ˜Ÿ","can_delete":false,"product_type":"c1","uid":1255514,"ip_address":"","ucode":"3143782B54D388","user_header":"https://static001.geekbang.org/account/avatar/00/13/28/5a/dc141082.jpg","comment_is_top":false,"comment_ctime":1541635358,"is_pvip":false,"replies":[{"id":"13578","content":"é•œåƒå¾—ç»™å®¹å™¨åšrootfsã€‚ä½ ç†è§£ä¸€ä¸‹å¯¹ä¸€ä¸ªè¿›ç¨‹æ¥è¯´ï¼Œrootfsè·Ÿæ™®é€šç›®å½•çš„åŒºåˆ«ã€‚","user_name":"ä½œè€…å›å¤","user_name_real":"Geek_6ef93d","uid":"1218095","ctime":1541719531,"ip_address":"","comment_id":37520,"utype":1}],"discussion_count":1,"race_medal":0,"score":"5836602654","product_id":100015201,"comment_content":"ç£Šå“¥ï¼Œé—®ä½ ä¸ªdockerçš„é—®é¢˜ï¼Œé•œåƒloadåˆ°ä¸»æœºä¸Šï¼Œé•œåƒé‡Œçš„æ–‡ä»¶æ˜¯ä¸æ˜¯å­˜å‚¨åœ¨ä¸»æœºçš„æŸä¸ªç›®å½•ä¸Šï¼Œèµ·æ¥çš„å®¹å™¨è®¿é—®è¿™ä¸ªæ–‡ä»¶ï¼Œå®é™…ä¸Šå°±æ˜¯è®¿é—®ä¸»æœºä¸Šçš„è¿™ä¸ªæ–‡ä»¶ï¼Ÿå¦‚æœæ˜¯è¿™æ ·çš„è¯ï¼Œåˆ›å»ºä¸ªæ•°æ®å·æ”¾è¿™ä¸ªæ–‡ä»¶ï¼Œè®©å®¹å™¨å»è®¿é—®è¿™ä¸ªæ•°æ®å·é‡Œçš„è¿™ä¸ªæ–‡ä»¶ï¼Œå…¶å®ä¹Ÿæ˜¯è®¿é—®ä¸»æœºæŸä¸ªç›®å½•é‡Œçš„æ–‡ä»¶ï¼Œä¸çŸ¥é“è¿™ä¸¤ç§æ–¹å¼æœ‰ä»€ä¹ˆåŒºåˆ«å‘¢ï¼Ÿè¯·ç£Šå“¥æŒ‡å¯¼ä¸‹å‘¢","like_count":1,"discussions":[{"author":{"id":1218095,"avatar":"https://static001.geekbang.org/account/avatar/00/12/96/2f/876085fa.jpg","nickname":"å¼ ç£Š Kubernetes","note":"","ucode":"16E29BDAB1F5BC","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":428379,"discussion_content":"é•œåƒå¾—ç»™å®¹å™¨åšrootfsã€‚ä½ ç†è§£ä¸€ä¸‹å¯¹ä¸€ä¸ªè¿›ç¨‹æ¥è¯´ï¼Œrootfsè·Ÿæ™®é€šç›®å½•çš„åŒºåˆ«ã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1541719531,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":360097,"user_name":"æ¢¦å›æ±‰å”","can_delete":false,"product_type":"c1","uid":1321581,"ip_address":"å››å·","ucode":"9C66E35165F813","user_header":"https://static001.geekbang.org/account/avatar/00/14/2a/6d/0e436c1c.jpg","comment_is_top":false,"comment_ctime":1666173461,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1666173461","product_id":100015201,"comment_content":"å¯¹äºTUNè®¾å¤‡çš„æè¿°å¤ªç²¾é«“äº†ï¼Œè§£å†³äº†æˆ‘å¾ˆå¤šå¹´çš„å›°æƒ‘ã€‚æˆ‘ä¹‹å‰ä¸€ç›´ä¸èƒ½æ˜ç™½ä»å®¹å™¨æµåˆ°å®¿ä¸»æœºçš„åŒ…ä¸ºä»€ä¹ˆå¯ä»¥èµ°ä¸¤æ¬¡è·¯ç”±è¡¨ï¼Œç°åœ¨å¯ç®—æ˜¯æ˜ç™½äº†ã€‚","like_count":0},{"had_liked":false,"id":359347,"user_name":"ç”°å°éº¦","can_delete":false,"product_type":"c1","uid":1648999,"ip_address":"åŒ—äº¬","ucode":"4C10997F6173ED","user_header":"https://static001.geekbang.org/account/avatar/00/19/29/67/fc61a741.jpg","comment_is_top":false,"comment_ctime":1665460786,"is_pvip":true,"discussion_count":0,"race_medal":0,"score":"1665460786","product_id":100015201,"comment_content":"åªæœ‰å¾ˆæ·±çš„åŠŸåº•ï¼Œæ‰èƒ½ç”¨è¿™ä¹ˆç›´è§‚çš„æ–‡å­—ï¼Œå†™å‡ºæ˜“äºç†è§£çš„å¹²è´§ï¼ï¼ï¼","like_count":0},{"had_liked":false,"id":358461,"user_name":"AB","can_delete":false,"product_type":"c1","uid":1202470,"ip_address":"æµ™æ±Ÿ","ucode":"0BB62078D5D1CA","user_header":"https://static001.geekbang.org/account/avatar/00/12/59/26/e9594316.jpg","comment_is_top":false,"comment_ctime":1664333815,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1664333815","product_id":100015201,"comment_content":"flanneldå·¥ä½œåœ¨ç”¨æˆ·ç©ºé—´ï¼Œå°è£…UDPåŒ…åœ¨å†…æ ¸ç©ºé—´ï¼Œflanneldä¼ è¾“åˆ°eth0ä¸­é—´æ˜¯ä¸æ˜¯è¿˜æœ‰ä¸€ä¸ªæ­¥éª¤å°è£…å’Œè§£å°","like_count":0},{"had_liked":false,"id":354892,"user_name":"Geek_1cc6d1","can_delete":false,"product_type":"c1","uid":1850248,"ip_address":"åŒ—äº¬","ucode":"3E083616DD0742","user_header":"http://thirdwx.qlogo.cn/mmopen/vi_32/DYAIOgq83erZCyXaP2gbxwFHxvtnyaaF2Pyy5KkSMsk9kh7SJl8icp1CD6wicb6VJibiblGibbpDo6IuHrdST6AnWQg/132","comment_is_top":false,"comment_ctime":1660870123,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1660870123","product_id":100015201,"comment_content":"ä¸»æœºç½‘é€šä¸å°±å¯ä»¥äº†ä¹ˆï¼Œä¸ºä»€ä¹ˆè¦å¤šè¿™ä¹ˆä¸€å±‚è™šæ‹Ÿç½‘ç»œï¼Ÿ","like_count":0},{"had_liked":false,"id":348741,"user_name":"é›å—é£","can_delete":false,"product_type":"c1","uid":1427499,"ip_address":"","ucode":"8CA46975D6EEA1","user_header":"https://static001.geekbang.org/account/avatar/00/15/c8/2b/169ad3d0.jpg","comment_is_top":false,"comment_ctime":1655363740,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1655363740","product_id":100015201,"comment_content":"å¤ªå¤æ‚äº†, å¯¹ç½‘ç»œçŸ¥è¯†è–„å¼±çš„æˆ‘æ˜¯ä¸ªé‡é”¤","like_count":0},{"had_liked":false,"id":343589,"user_name":"çªçªå¤´","can_delete":false,"product_type":"c1","uid":1063866,"ip_address":"","ucode":"5C2635ED6484F8","user_header":"https://static001.geekbang.org/account/avatar/00/10/3b/ba/3b30dcde.jpg","comment_is_top":false,"comment_ctime":1650942606,"is_pvip":true,"discussion_count":0,"race_medal":0,"score":"1650942606","product_id":100015201,"comment_content":"flannelæŸ¥æ‰¾ç›®æ ‡ipå¯¹åº”çš„macåœ°å€åŠç›®çš„ä¸»æœºçš„ipå…¶å®æ˜¯é€šè¿‡fdbæŸ¥æ‰¾å‡ºæ¥çš„ï¼Œè€Œfdbæ˜¯ç”±flannelç»´æŠ¤çš„ï¼Œæ‰€ä»¥è¿™å—æ˜¯å¦å¯é è¿˜æ˜¯çœ‹flannelå¯¹fdbç»´æŠ¤çš„æ¨¡å¼å§ï¼Œå¦‚æœåªæ˜¯node2åŠ å…¥æ—¶æ³¨å†Œé€€å‡ºæ—¶åˆ é™¤è€Œæ²¡æœ‰è¿›è¡ŒçŠ¶æ€ç»´æŠ¤çš„è¯é‚£å°±ä¸å¯é äº†","like_count":0},{"had_liked":false,"id":342142,"user_name":"å‹¤å¥‹çš„è¾£ç‰›è‚‰","can_delete":false,"product_type":"c1","uid":1676412,"ip_address":"","ucode":"D48CC31A8D44FC","user_header":"https://static001.geekbang.org/account/avatar/00/19/94/7c/70bf584f.jpg","comment_is_top":false,"comment_ctime":1650034678,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1650034678","product_id":100015201,"comment_content":"VXLANçš„å®ç°è¿‡ç¨‹ä¸ºä»€ä¹ˆä¸€å®šè¦å¥—ä¸€ä¸ªUDPåœ¨ä¸­é—´ï¼Ÿ","like_count":0},{"had_liked":false,"id":341925,"user_name":"Geek_7b826d","can_delete":false,"product_type":"c1","uid":2848426,"ip_address":"","ucode":"0602900CB534A6","user_header":"","comment_is_top":false,"comment_ctime":1649919375,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1649919375","product_id":100015201,"comment_content":"æŒ‰æ–‡ä¸­è®²åˆ°çš„åœ¨fannel.1 ä¸ŠæŠ“åŒ…å¯ä»¥æŠ“åˆ°vxlançš„æŠ¥æ–‡å—ï¼Ÿ ","like_count":0},{"had_liked":false,"id":340378,"user_name":"Eason Lau","can_delete":false,"product_type":"c1","uid":1035123,"ip_address":"","ucode":"51C987C477F1F0","user_header":"https://static001.geekbang.org/account/avatar/00/0f/cb/73/9eb7c992.jpg","comment_is_top":false,"comment_ctime":1648784687,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1648784687","product_id":100015201,"comment_content":"çœ‹æ‡‚äº†ä¸åŒå®¿ä¸»æœºä¼ è¾“æ•°æ®çš„åŸç†","like_count":0},{"had_liked":false,"id":335275,"user_name":"the outsider","can_delete":false,"product_type":"c1","uid":1665646,"ip_address":"","ucode":"3209715E5AD7A4","user_header":"https://static001.geekbang.org/account/avatar/00/19/6a/6e/38738a57.jpg","comment_is_top":false,"comment_ctime":1645436430,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1645436430","product_id":100015201,"comment_content":"è€å¸ˆï¼Œè¯·æ•™ä¸ªé—®é¢˜ï¼Œæˆ‘ä»¬ç”Ÿäº§ç¯å¢ƒå·²ç»éƒ¨ç½²å¥½çš„é›†ç¾¤ï¼ˆv1.19ï¼‰ï¼Œä¸¤ä¸ªpodä¹‹é—´ï¼Œçªç„¶ä¹‹é—´æ— æ³•hostsè§£æï¼ˆsvc.nsï¼‰ï¼Œä¸¤ä¸ªnodeä¹‹é—´å…¶ä»–çš„podèƒ½é€šè¿‡ï¼ˆsvc.nsï¼‰é€šä¿¡ã€‚æˆ‘ä»¬æ²¡æ‰¾åˆ°åŸå› ï¼Œè€å¸ˆèƒ½éº»çƒ¦å¸®å¿™åˆ†æä¸€ä¸‹å—ï¼Ÿæ„Ÿè°¢è€å¸ˆ","like_count":0},{"had_liked":false,"id":330709,"user_name":"cosz3","can_delete":false,"product_type":"c1","uid":1218665,"ip_address":"","ucode":"B9023D4A088CF2","user_header":"https://static001.geekbang.org/account/avatar/00/12/98/69/5a1c6620.jpg","comment_is_top":false,"comment_ctime":1642127878,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1642127878","product_id":100015201,"comment_content":"æˆ‘ç”¨ kubeadmn éƒ¨ç½²åå®‰è£…äº† cni Flannelï¼Œä½¿ç”¨çš„æ˜¯ cni0 æ²¡æœ‰ ä½¿ç”¨ docker0ï¼Œ kubeadmn å®‰è£…æ—¶å€™æ€ä¹ˆæŒ‡å®šä½¿ç”¨ docker0 å‘¢ï¼Ÿ","like_count":0},{"had_liked":false,"id":325039,"user_name":"è¿½é£ç­çš„äºº","can_delete":false,"product_type":"c1","uid":1488020,"ip_address":"","ucode":"2993D60F94C396","user_header":"https://static001.geekbang.org/account/avatar/00/16/b4/94/2796de72.jpg","comment_is_top":false,"comment_ctime":1638784142,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1638784142","product_id":100015201,"comment_content":"è®¡ç®—æœºç½‘ç»œ   TCP&#47;IPåè®®å·ä¸€","like_count":0},{"had_liked":false,"id":316625,"user_name":"æ¨","can_delete":false,"product_type":"c1","uid":1971269,"ip_address":"","ucode":"7EFEFE285975C6","user_header":"http://thirdwx.qlogo.cn/mmopen/vi_32/oltLEqTrmHm2aJP99BK6tHu5h7hp4aj08wR5Wt6H31iadFduDAVvjYKmhQ2nvGbLV3lkVdiat2GRasgWXoJeTibUg/132","comment_is_top":false,"comment_ctime":1634460529,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1634460529","product_id":100015201,"comment_content":"flannel vtepæœ‰ä¸ªç½‘ç»œåŒ…å‘é€å›¾å°±å¥½äº†  å°±åƒé‚£ä¸ªudpæ¨¡å¼","like_count":0},{"had_liked":false,"id":315767,"user_name":"è¨€åˆæœ¨æ‰","can_delete":false,"product_type":"c1","uid":1201009,"ip_address":"","ucode":"300BEDC1B07DF1","user_header":"https://static001.geekbang.org/account/avatar/00/12/53/71/a4e9f20e.jpg","comment_is_top":false,"comment_ctime":1633970975,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1633970975","product_id":100015201,"comment_content":"çœ‹å®Œæ„Ÿè§‰ä¸Šäº†ä¸€èŠ‚è®¡ç®—æœºç½‘ç»œè¯¾ç¨‹ï¼Œè€å¸ˆè®²çš„éå¸¸å¥½ï¼Œå¯¹ä¸åŒå®¿ä¸»æœºçš„é€šä¿¡æœ‰äº†æ¯”è¾ƒè¯¦ç»†çš„äº†è§£ï¼Œä¹‹å‰åªæ˜¯çŸ¥é“dockerä¸åŒæ•°ç»„æ˜¯ä¾é overlayæ¥å®ç°çš„ï¼Œä½†æ˜¯å…·ä½“çš„å°±ä¸çŸ¥é“äº†ã€‚","like_count":0},{"had_liked":false,"id":307122,"user_name":"æ‹›è€³","can_delete":false,"product_type":"c1","uid":1001825,"ip_address":"","ucode":"D163E1A6377CF6","user_header":"https://static001.geekbang.org/account/avatar/00/0f/49/61/abb7bfe3.jpg","comment_is_top":false,"comment_ctime":1628872383,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1628872383","product_id":100015201,"comment_content":"è€å¸ˆï¼Œnode1ä¸Šçš„è¿™æ¡è·¯ç”±æ˜¯è°åˆ›å»ºçš„å‘¢ï¼Ÿ<br>100.96.0.0&#47;16 dev flannel0  proto kernel  scope link  src 100.96.1.0","like_count":0},{"had_liked":false,"id":306336,"user_name":"csw354","can_delete":false,"product_type":"c1","uid":2648492,"ip_address":"","ucode":"60F2065B574B34","user_header":"https://thirdwx.qlogo.cn/mmopen/vi_32/Bb0c1RZVKHXhoCWYZK4I8aXMUHib1iaPia4P9v6zY5bDRBib4b2sfoMkaAPajm4fch9d3EMmSia2wmcglD057aflGkw/132","comment_is_top":false,"comment_ctime":1628501378,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1628501378","product_id":100015201,"comment_content":"é‚£ä¹ˆï¼Œä¸å‰é¢ UDP æ¨¡å¼çš„æµç¨‹ç±»ä¼¼ï¼Œå½“ container-1 å‘å‡ºè¯·æ±‚ä¹‹åï¼Œè¿™ä¸ªç›®çš„åœ°å€æ˜¯ 10.1.16.3 çš„ IP åŒ…ï¼Œä¼šå…ˆå‡ºç°åœ¨ docker0 ç½‘æ¡¥ï¼Œç„¶åè¢«è·¯ç”±åˆ°æœ¬æœº flannel.1 è®¾å¤‡è¿›è¡Œå¤„ç†ã€‚<br>å¦‚æœæ˜¯â€œè¢«è·¯ç”±â€ï¼Œé‚£æœ¬æ¥çš„äºŒå±‚åŒ…ä¸å°±ä¼šè¢«å‰¥ç¦»ä»¥å¤ªç½‘æŠ¥å¤´ï¼Œåªæœ‰ä¸‰å±‚IPæŠ¥æ–‡ï¼Œé‚£vtepå°è£…çš„ä¸ä¹Ÿå˜æˆä¸‰å±‚IPæŠ¥æ–‡ï¼Œè€Œä¸æ˜¯äºŒå±‚ä»¥å¤ªç½‘æŠ¥æ–‡å—","like_count":0},{"had_liked":false,"id":305634,"user_name":"Demon.Lee","can_delete":false,"product_type":"c1","uid":1052859,"ip_address":"","ucode":"7F0E5493A8E345","user_header":"https://static001.geekbang.org/account/avatar/00/10/10/bb/f1061601.jpg","comment_is_top":false,"comment_ctime":1628079460,"is_pvip":false,"discussion_count":0,"race_medal":1,"score":"1628079460","product_id":100015201,"comment_content":"è¯·æ•™è€å¸ˆå’Œå°ä¼™ä¼´ä¸€ä¸ªé—®é¢˜ã€‚<br>ä¸€ä¸ªç®€å•çš„ k8s é›†ç¾¤ï¼ˆ1ä¸ª master ï¼Œ2ä¸ª workerï¼‰ ï¼Œmaster çš„ ip ä¸º 10.5.xx.xxï¼Œ2 ä¸ª worker çš„ ip ä¸º 192.168.100.xxã€‚<br><br>æœ‰ä¸€ä¸ª pod æš´éœ²äº†ä¸€ä¸ª https ç«¯å£ï¼ˆæ¯”å¦‚443ï¼‰ï¼Œç„¶å é€šè¿‡ curl https:&#47;&#47;xxx:443&#47;apis&#47;xxx è®¿é—®ï¼ˆè°ƒç”¨æ˜¯ä¼šå¸¦ä¸Štokenï¼‰ï¼Œå¦‚æœè¿™ä¸ª pod ä¸åœ¨ master èŠ‚ç‚¹ä¸Šï¼Œé‚£ä¹ˆåœ¨ master èŠ‚ç‚¹ä¸Šå‘èµ·è¯·æ±‚åä¸€ç›´æ²¡ååº”ï¼Œç›´åˆ°è¶…æ—¶ã€‚è€Œåœ¨ 2 ä¸ª worker èŠ‚ç‚¹å‘èµ·è¯·æ±‚ï¼Œåˆ™å¯ä»¥æ­£å¸¸è¿”å›ã€‚<br>å¦‚æœå°†è¿™ä¸ª pod å¼ºåˆ¶è°ƒåº¦åˆ° master èŠ‚ç‚¹ä¸Šï¼Œé‚£ä¹ˆåœ¨ master èŠ‚ç‚¹ä¸Šå‘èµ·è¯·æ±‚ï¼Œå¯ä»¥æ­£å¸¸è¿”å›ï¼Œä½†åœ¨  2 ä¸ª worker èŠ‚ç‚¹å‘èµ·è¯·æ±‚ï¼Œä¼šè¶…æ—¶æ— å“åº”ã€‚<br><br>å¯¼è‡´è¿™ä¸ªé—®é¢˜çš„åŸå› ä¼šæ˜¯ä»€ä¹ˆå‘¢","like_count":0},{"had_liked":false,"id":302692,"user_name":"PeiHongbing","can_delete":false,"product_type":"c1","uid":1635932,"ip_address":"","ucode":"F115AD8740B0DC","user_header":"https://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTKSEVQdSoW2SwDic2U3uIibsa1bH3qSSzCvYTN5xHC5ppGDS2DBxL1KcbuxZ6Ez6kyOGj1F4toiaiazBA/132","comment_is_top":false,"comment_ctime":1626335898,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1626335898","product_id":100015201,"comment_content":"è¯·é—®æ€ä¹ˆæ­å»ºå®éªŒç¯å¢ƒå‘¢ï¼Ÿ","like_count":0},{"had_liked":false,"id":302111,"user_name":"éƒ‘äºšåˆš","can_delete":false,"product_type":"c1","uid":1983303,"ip_address":"","ucode":"F4CD42D82551AF","user_header":"https://static001.geekbang.org/account/avatar/00/1e/43/47/2bc320bf.jpg","comment_is_top":false,"comment_ctime":1626085435,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1626085435","product_id":100015201,"comment_content":"vxlanä¸­çš„Outer UDP headeræ˜¯vxlanåè®®è§„å®šçš„ï¼š<br>VXLANå¤´å’ŒåŸå§‹ä»¥å¤ªå¸§ä¸€èµ·ä½œä¸ºUDPçš„æ•°æ®ã€‚UDPå¤´ä¸­ï¼Œç›®çš„ç«¯å£å·ï¼ˆVXLAN Portï¼‰å›ºå®šä¸º4789ï¼Œæºç«¯å£å·ï¼ˆUDP Src. Portï¼‰æ˜¯åŸå§‹ä»¥å¤ªå¸§é€šè¿‡å“ˆå¸Œç®—æ³•è®¡ç®—åçš„å€¼ã€‚<br>æ˜¯è¿™æ ·çš„å—ï¼Ÿ","like_count":0},{"had_liked":false,"id":299946,"user_name":"æå¥","can_delete":false,"product_type":"c1","uid":1297756,"ip_address":"","ucode":"5919D20D0A4489","user_header":"https://static001.geekbang.org/account/avatar/00/13/cd/5c/b31e126e.jpg","comment_is_top":false,"comment_ctime":1624932361,"is_pvip":true,"discussion_count":0,"race_medal":0,"score":"1624932361","product_id":100015201,"comment_content":"æœ€åé—®é¢˜:<br>æŠ›å¼€flannelï¼Œlinuxä¸‹vxlan+bridgeæŠ€æœ¯å¯ä»¥å®ç°äºŒå±‚äº’é€šï¼Œè¿™ä¹Ÿæ˜¯openstacké‡Œå®ç°ç§Ÿæˆ·éš”ç¦»çš„ä¸€ç§æ–¹å¼<br><br>ä½†å…·ä½“åˆ°flannel, flannelé‡Œç”¨vxlanåªæ˜¯å®ç°äº†ä¸‰å±‚äº’é€š","like_count":0},{"had_liked":false,"id":294589,"user_name":"æé’æƒ…æ„é‡","can_delete":false,"product_type":"c1","uid":2626238,"ip_address":"","ucode":"3F27F555C2C06D","user_header":"https://static001.geekbang.org/account/avatar/00/28/12/be/a12a7963.jpg","comment_is_top":false,"comment_ctime":1622011109,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1622011109","product_id":100015201,"comment_content":"å¸Œæœ›è€å¸ˆè§£ç­”ä¸‹ç–‘æƒ‘ï¼Œæˆ‘åŠ äº†ä¸€ä¸ªè‡ªå¯åŠ¨ä»»åŠ¡ï¼Œæƒ³åœ¨å®¹å™¨å¯åŠ¨ä¹‹åè‡ªå¯åŠ¨ä¸€ä¸ªè„šæœ¬ã€‚ä½†æ˜¯æ¯æ¬¡éƒ½éœ€è¦æˆ‘åœ¨k8sçš„dashboardä¸­é€‰æ‹©podçš„æ‰§è¡ŒæŒ‰é’®ï¼Œä¹Ÿå°±æ˜¯execè¿›å…¥å®¹å™¨ä¸­æ‰ä¼šè§¦å‘è‡ªå¯åŠ¨ä»»åŠ¡ã€‚å¾ˆç–‘æƒ‘","like_count":0},{"had_liked":false,"id":284608,"user_name":"å§œå°§","can_delete":false,"product_type":"c1","uid":2405411,"ip_address":"","ucode":"D813E046DD81E8","user_header":"https://static001.geekbang.org/account/avatar/00/24/b4/23/0e296758.jpg","comment_is_top":false,"comment_ctime":1616385781,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1616385781","product_id":100015201,"comment_content":"å’±ä»¬ç°åœ¨kubernetesVersion: ç‰ˆæœ¬å·²ç»å¾ˆé«˜äº†ï¼Œdemonsetè¿™äº›éƒ½ä¸æ”¯æŒäº†ï¼Œ<br>æ‰€ä»¥å®‰è£…flannelçš„æ—¶å€™å¯ä»¥ç”¨ä¸‹é¢è¿™ä¸ª<br>kubectl create -f https:&#47;&#47;raw.githubusercontent.com&#47;coreos&#47;flannel&#47;master&#47;Documentation&#47;kube-flannel.yml<br>","like_count":0},{"had_liked":false,"id":283113,"user_name":"æˆ‘","can_delete":false,"product_type":"c1","uid":1228448,"ip_address":"","ucode":"CEB9CAA8A65930","user_header":"https://static001.geekbang.org/account/avatar/00/12/be/a0/af1725e1.jpg","comment_is_top":false,"comment_ctime":1615551613,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1615551613","product_id":100015201,"comment_content":"å®¹å™¨ç½‘ç»œ æ˜¯ä¸æ˜¯ä¼šé™ä½ç½‘ç»œæ€§èƒ½ï¼Ÿè½¬å‘å‡ æ¬¡ æ•°æ®æ‹·è´ä¹Ÿå¤š","like_count":0},{"had_liked":false,"id":258159,"user_name":"Denuth","can_delete":false,"product_type":"c1","uid":1284665,"ip_address":"","ucode":"E20A7E707155CD","user_header":"https://static001.geekbang.org/account/avatar/00/13/9a/39/82679f79.jpg","comment_is_top":false,"comment_ctime":1604315354,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1604315354","product_id":100015201,"comment_content":"è¿™ä¸ªäº‘çš„ç½‘ç»œ å¯çœŸæ˜¯è€æ¯çŒªçš„çš® ä¸€å±‚å¥—ä¸€å±‚","like_count":0},{"had_liked":false,"id":256031,"user_name":"çŒ«ä¸åƒé±¼","can_delete":false,"product_type":"c1","uid":1551837,"ip_address":"","ucode":"3A15C951912525","user_header":"https://static001.geekbang.org/account/avatar/00/17/ad/dd/2630314e.jpg","comment_is_top":false,"comment_ctime":1603509664,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1603509664","product_id":100015201,"comment_content":"è¿™ä¸ªåŸç†æ˜¯ä¸æ˜¯æœ‰ç‚¹åƒVPNçš„åŸç†ã€‚é€šè¿‡ç‚¹å¯¹ç‚¹éš§é“åè®®å®ç°ä¸€ä¸ªå¤§çš„è™šæ‹Ÿå±€åŸŸç½‘","like_count":0},{"had_liked":false,"id":250305,"user_name":"Heaven","can_delete":false,"product_type":"c1","uid":1694207,"ip_address":"","ucode":"FA33FBCC66C911","user_header":"https://static001.geekbang.org/account/avatar/00/19/d9/ff/b23018a6.jpg","comment_is_top":false,"comment_ctime":1601018191,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1601018191","product_id":100015201,"comment_content":"å…³äºè¿™ä¸ªé—®é¢˜,flannelç»´æŠ¤çš„å¿…ç„¶æ˜¯å­ç½‘,ä¹Ÿå°±æ˜¯ä¸‰å±‚ä¸Šçš„æ¦‚å¿µ,æƒ³è¦ç›´æ¥æ‰“é€šäºŒå±‚çš„ç½‘è·¯è”é€š,é‚£ä¹ˆå°±éœ€è¦è€ƒè™‘ä¸åŒå®¿ä¸»æœºä¹‹é—´å®¹å™¨å¦‚ä½•çŸ¥é“å½¼æ­¤çš„MACåœ°å€å‘¢?å¯ä»¥å‚è€ƒVXLANçš„è§£å†³æ–¹æ¡ˆ,æ¯ä¸€ä¸ªVTEPéƒ½é€šè¿‡IGMP,åŠ å…¥ä¸€ä¸ªç»„æ’­ç»„éœ€è¦VTEPéƒ½æŒ‚è½½åˆ°ä¸€ä¸ªç»„å†…,æ–¹ä¾¿è¿›è¡Œå¹¿æ’­arpè¯·æ±‚,ä»è€Œæ‰“é€šäºŒå±‚ç½‘ç»œ","like_count":0},{"had_liked":false,"id":247000,"user_name":"é™å¿ƒ","can_delete":false,"product_type":"c1","uid":1335457,"ip_address":"","ucode":"EB264FA6519FDA","user_header":"https://static001.geekbang.org/account/avatar/00/14/60/a1/8f003697.jpg","comment_is_top":false,"comment_ctime":1599554458,"is_pvip":true,"discussion_count":0,"race_medal":5,"score":"1599554458","product_id":100015201,"comment_content":"è€å¸ˆçš„çŸ¥è¯†é¢ä¸ä»…å…¨é¢ï¼Œè€Œä¸”è¿˜å¾ˆæœ‰æ·±åº¦ï¼Œä¹Ÿå…·æœ‰å¾ˆå¼ºçš„ä½“ç³»ç»“æ„ã€‚ä¸éš¾k8sè®²çš„é€å½»ï¼Œè€Œä¸”å¯¹äºç½‘ç»œçš„çŸ¥è¯†ä¹Ÿç†è§£é¢‡æ·±ã€‚å¾ˆè£å¹¸é‡åˆ°äº†è¿™ä¹ˆå¥½çš„è€å¸ˆã€‚ä¸è¿‡æ„Ÿè§‰ï¼Œè¿™ä¸ªè¯¾ç¨‹æˆ‘è¦å®Œå…¨æ¶ˆåŒ–æ‰ï¼Œå¯èƒ½éœ€è¦3éã€‚","like_count":0},{"had_liked":false,"id":245961,"user_name":"å¤§Gæ¥äº†å‘¦","can_delete":false,"product_type":"c1","uid":1610260,"ip_address":"","ucode":"97711D9CCA73B0","user_header":"https://static001.geekbang.org/account/avatar/00/18/92/14/6ca50b3b.jpg","comment_is_top":false,"comment_ctime":1599121806,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1599121806","product_id":100015201,"comment_content":"è®²çš„çœŸå¥½ï¼ä¸€éå¬æ˜ç™½ï¼Œå‰å®³ï¼","like_count":0},{"had_liked":false,"id":242381,"user_name":"å†¬å†¬","can_delete":false,"product_type":"c1","uid":1180054,"ip_address":"","ucode":"B673E6482B5C93","user_header":"https://static001.geekbang.org/account/avatar/00/12/01/96/afcb6174.jpg","comment_is_top":false,"comment_ctime":1597708658,"is_pvip":false,"discussion_count":0,"race_medal":2,"score":"1597708658","product_id":100015201,"comment_content":"nodeè·¨ä¸»æœºé€šä¿¡å¼•å…¥äº†flannelç»„ä»¶ï¼Œä»node1è¯·æ±‚node2åœ¨æ¯ä¸ªç»„ä»¶å¯¹è¯·æ±‚åŒ…è¿›è¡Œåˆ†å‘ï¼ˆdocker0ã€flannelï¼‰,flannelåŒ…å«å­ç½‘ åœ¨node2åœ°å€åœ¨subnetèŒƒå›´å†…ï¼Œåˆ™å¯¹è¯·æ±‚åŒ…è¿›è¡Œåˆ†å‘ æœ€ç»ˆè¾¾åˆ°node2ä¸Šçš„containerã€‚<br>è¯¾åé—®é¢˜ï¼šæˆ‘è§‰å¾—ä¸åˆé€‚ï¼Œmacåœ°å€ä¸ºç¡¬ä»¶åœ°å€ å½“ä¸è¯·æ±‚èŠ‚ç‚¹ç›´è¿æ—¶ å¯é€šè¿‡macå®ç°ï¼Œä½†å½“ç›®çš„nodeä¸åœ¨subnetæ—¶ï¼Œè¿˜æ˜¯è¦éœ€è¦rarpï¼ˆåœ°å€é€†è§£æï¼‰è½¬æ¢ä¸ºip ç„¶åå°†æ•°æ®åŒ…åˆ†å‘åˆ°ç›®çš„nodeã€‚ <br> ","like_count":0},{"had_liked":false,"id":241738,"user_name":"ä¸å•¦ä¸å•¦ä¸","can_delete":false,"product_type":"c1","uid":1793080,"ip_address":"","ucode":"F538996E183F52","user_header":"https://static001.geekbang.org/account/avatar/00/1b/5c/38/9d7198b7.jpg","comment_is_top":false,"comment_ctime":1597405266,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1597405266","product_id":100015201,"comment_content":"éš§é“ç”»çš„å¤ªå¥½çœ‹äº†å“ˆå“ˆ","like_count":0},{"had_liked":false,"id":241441,"user_name":"æ˜","can_delete":false,"product_type":"c1","uid":2108110,"ip_address":"","ucode":"57B974802AD79A","user_header":"https://static001.geekbang.org/account/avatar/00/20/2a/ce/fea443f7.jpg","comment_is_top":false,"comment_ctime":1597296602,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1597296602","product_id":100015201,"comment_content":"&quot;ä¸ºäº†æ–¹ä¾¿å™è¿°ï¼Œæ¥ä¸‹æ¥æˆ‘ä¼šæŠŠ Node 1 å’Œ Node 2 ä¸Šçš„ flannel.1 è®¾å¤‡åˆ†åˆ«ç§°ä¸ºâ€œæº VTEP è®¾å¤‡â€å’Œâ€œç›®çš„ VTEP è®¾å¤‡â€ã€‚è€Œè¿™äº› VTEP è®¾å¤‡ä¹‹é—´ï¼Œå°±éœ€è¦æƒ³åŠæ³•ç»„æˆä¸€ä¸ªè™šæ‹Ÿçš„äºŒå±‚ç½‘ç»œï¼Œå³ï¼šé€šè¿‡äºŒå±‚æ•°æ®å¸§è¿›è¡Œé€šä¿¡ã€‚&quot;<br>1ã€VTEPå¹¶ä¸éœ€è¦å·¥ä½œåœ¨äºŒå±‚ç½‘ç»œï¼Œä¸¤ä¸ªflannel.1ä¹Ÿæ˜¯ç”¨IPåœ°å€æ¥æ‰¾å¯¹ç«¯ã€‚2ã€ä¸åŒNODEä¸Šçš„containerï¼Œå­ç½‘ä¸åŒï¼Œé‚£å°±æ˜¯ä¸‰å±‚é€šä¿¡äº†ã€‚3ã€æœ€åé€šè¿‡å®¿ä¸»æœºä»¥UDPé€šä¿¡ï¼Œé‚£è¿™ä¸ªè·¯ç”±å¯è¾¾å³å¯ã€‚ ä¼¼ä¹åŸç†ä¸Šä¸éœ€è¦ï¼Œcontainerä¹‹é—´ä¹Ÿä¸ä¼šæ˜¯äºŒå±‚ç½‘ç»œï¼Ÿ","like_count":0},{"had_liked":false,"id":234039,"user_name":"æµ·ç›—èˆ¹é•¿","can_delete":false,"product_type":"c1","uid":1363634,"ip_address":"","ucode":"ECB28BA21A4113","user_header":"https://static001.geekbang.org/account/avatar/00/14/ce/b2/1f914527.jpg","comment_is_top":false,"comment_ctime":1594560326,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1594560326","product_id":100015201,"comment_content":"æ˜¯é€šè¿‡ä»€ä¹ˆæŠ€æœ¯ï¼Ÿåœ¨å“ªä¸€æ­¥è®¾ç½®ä¸åŒnodeä¸Šdocker0çš„å­ç½‘æ®µçš„ï¼Ÿ","like_count":0},{"had_liked":false,"id":217048,"user_name":"Andy","can_delete":false,"product_type":"c1","uid":1119133,"ip_address":"","ucode":"4BCA899B8E4E85","user_header":"https://static001.geekbang.org/account/avatar/00/11/13/9d/0ff43179.jpg","comment_is_top":false,"comment_ctime":1589412504,"is_pvip":false,"discussion_count":1,"race_medal":0,"score":"1589412504","product_id":100015201,"comment_content":"ä¹‹å‰å­¦æŠ€æœ¯æ—¶ï¼Œä¹¦ä¸Šè¯´udpæ€§èƒ½å·®ï¼Œæ˜¯å¹¿æ’­æ–¹å¼çš„é€šä¿¡ã€‚ä»¥åè¿˜ä¼šå‡ºç°tcpçš„ç½‘ç»œæ’ä»¶ï¼Ÿ","like_count":0,"discussions":[{"author":{"id":1145068,"avatar":"https://static001.geekbang.org/account/avatar/00/11/78/ec/f7f0d21a.jpg","nickname":"Dev-L","note":"","ucode":"485E940C3F17B9","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":292995,"discussion_content":"å•¥ï¼Ÿä¸ä¼šçœ‹äº†å‡ä¹¦å§ï¼Ÿudpæ¯”tcpé«˜æ•ˆå§","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1595407022,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":209844,"user_name":"lpf32","can_delete":false,"product_type":"c1","uid":1039717,"ip_address":"","ucode":"E1B127FDFF74BB","user_header":"https://static001.geekbang.org/account/avatar/00/0f/dd/65/3b4a2930.jpg","comment_is_top":false,"comment_ctime":1587624204,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1587624204","product_id":100015201,"comment_content":"è™šæ‹ŸäºŒå±‚ç½‘ç»œçš„è¿é€šæ€§ä¾èµ–äºnodeèŠ‚ç‚¹ä¸‰å±‚ç½‘ç»œçš„è”é€šæ€§ï¼Œè‡ªèº«å¹¶ä¸èƒ½ä¿è¯è”é€š","like_count":0},{"had_liked":false,"id":209251,"user_name":"å¼ ä¸‰","can_delete":false,"product_type":"c1","uid":1004092,"ip_address":"","ucode":"1155528FAE1546","user_header":"https://static001.geekbang.org/account/avatar/00/0f/52/3c/d6fcb93a.jpg","comment_is_top":false,"comment_ctime":1587524003,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1587524003","product_id":100015201,"comment_content":"å­¦ä¹ äº†ï¼Œç²¾å½©ï¼Œé¡ºä¾¿å­¦ä¹ äº†OSIåˆ†å±‚æ¨¡å‹ä¸­æ¯ä¸€å±‚ä¹‹é—´çš„è¿æ¥ã€‚è°¢è°¢","like_count":0},{"had_liked":false,"id":198665,"user_name":"vincent","can_delete":false,"product_type":"c1","uid":1796234,"ip_address":"","ucode":"9FAD09D87C1E42","user_header":"","comment_is_top":false,"comment_ctime":1585462975,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1585462975","product_id":100015201,"comment_content":"openstackçš„ç½‘ç»œå¯ä»¥å®ç°è™šæœºç½‘ç»œçš„ç›¸äº’éš”ç¦»ï¼Œkubernetesæ˜¯å¦æœ‰ç±»ä¼¼çš„æœºåˆ¶å¯ä»¥å®ç°","like_count":0},{"had_liked":false,"id":195937,"user_name":"é‚£è¿¦æ ‘","can_delete":false,"product_type":"c1","uid":1055625,"ip_address":"","ucode":"34519C1DEA41A0","user_header":"https://static001.geekbang.org/account/avatar/00/10/1b/89/b7fae170.jpg","comment_is_top":false,"comment_ctime":1585224930,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1585224930","product_id":100015201,"comment_content":"ä¸çŸ¥é“podé—´çš„ç½‘ç»œäº¤äº’ä¼šä¸ä¼šæœ‰æ¯”è¾ƒå¤§çš„æµé‡æ€§èƒ½æŸè€—å‘¢","like_count":0},{"had_liked":false,"id":188642,"user_name":"dancer","can_delete":false,"product_type":"c1","uid":1019036,"ip_address":"","ucode":"B8D5641A3AC490","user_header":"https://static001.geekbang.org/account/avatar/00/0f/8c/9c/d48473ab.jpg","comment_is_top":false,"comment_ctime":1584384235,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1584384235","product_id":100015201,"comment_content":"è¿™èŠ‚è¯¾çš„å†…å®¹éœ€è¦å¤šå¤ä¹ å‡ éï¼Œç„¶åç”¨è‡ªå·±çš„ç†è§£æŠŠå›¾ç”»å‡ºæ¥ã€‚","like_count":0},{"had_liked":false,"id":186404,"user_name":"èŠ’æœå°‘ä¾ ","can_delete":false,"product_type":"c1","uid":1350159,"ip_address":"","ucode":"98D0BBB52BB80F","user_header":"https://static001.geekbang.org/account/avatar/00/14/9a/0f/da7ed75a.jpg","comment_is_top":false,"comment_ctime":1583836867,"is_pvip":true,"discussion_count":0,"race_medal":0,"score":"1583836867","product_id":100015201,"comment_content":"çœ‹å®Œåé¢çš„è¯¾ç¨‹ï¼Œå†å›å¤´åå¤è§‚çœ‹ã€æ¨æ•²ï¼Œç»ˆäºæœ‰ç§å»“ç„¶å¼€æœ—çš„æ„Ÿè§‰","like_count":0},{"had_liked":false,"id":175246,"user_name":"Dale","can_delete":false,"product_type":"c1","uid":1010056,"ip_address":"","ucode":"DD4717C06E417D","user_header":"https://static001.geekbang.org/account/avatar/00/0f/69/88/528442b0.jpg","comment_is_top":false,"comment_ctime":1580628856,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1580628856","product_id":100015201,"comment_content":"flannel udpéš§é“å°±æ˜¯ipipéš§é“çš„å®ç°æ–¹å¼äº†ã€‚","like_count":0},{"had_liked":false,"id":175191,"user_name":"Dale","can_delete":false,"product_type":"c1","uid":1010056,"ip_address":"","ucode":"DD4717C06E417D","user_header":"https://static001.geekbang.org/account/avatar/00/0f/69/88/528442b0.jpg","comment_is_top":false,"comment_ctime":1580609342,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1580609342","product_id":100015201,"comment_content":"æ€è€ƒé¢˜ï¼šä½ è®¤ä¸º Flannel èƒ½è´Ÿè´£ä¿è¯äºŒå±‚ç½‘ç»œï¼ˆMAC åœ°å€ï¼‰çš„è¿é€šæ€§å—ï¼Ÿä¸ºä»€ä¹ˆå‘¢ï¼Ÿ<br>æˆ‘è®¤ä¸ºæ˜¯å¯ä»¥è¿é€šçš„ã€‚å› ä¸ºå®¹å™¨ä¸å®¿ä¸»æœºé€šè¿‡bridgeè™šæ‹Ÿç½‘æ¡¥è¿é€šï¼Œç›´æ¥é€šè¿‡veth pairçš„macåœ°å€å¯ä»¥è¿é€šã€‚åœ¨è·¨å®¿ä¸»æœºä¸Šï¼Œflannelçš„VETPä¸Šä¹Ÿæœ‰macåœ°å€ï¼Œå¯ä»¥å’Œå®¿ä¸»æœºè¿é€šï¼Œè·¨å®¿ä¸»æœºäºŒå±‚æ˜¯è¿é€šï¼Œæ•´ä¸ªè¿‡ç¨‹éƒ½å¯ä»¥é€šè¿‡äºŒå±‚è¿é€š","like_count":0},{"had_liked":false,"id":174732,"user_name":"ZARD","can_delete":false,"product_type":"c1","uid":1544906,"ip_address":"","ucode":"F85773DD7B94B2","user_header":"https://static001.geekbang.org/account/avatar/00/17/92/ca/6616a42b.jpg","comment_is_top":false,"comment_ctime":1580366008,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1580366008","product_id":100015201,"comment_content":"è€å¸ˆï¼ŒUDPæ¨¡å¼ä¸‹ï¼Œå®¿ä¸»æœºä¸Šå®¹å™¨çš„å­ç½‘å¯ç›´æ¥å¯¹åº”å®¿ä¸»æœºçš„IPåœ°å€ã€‚  è€Œåœ¨VXLANæ¨¡å¼ä¸‹ï¼Œæ˜¯é€šè¿‡FDBè¡¨æ¥æ‰¾å¯¹åº”å®¿ä¸»æœºçš„IPåœ°å€çš„ï¼Œé‚£UDPæ¨¡å¼ä¸‹å­ç½‘å’Œå®¿ä¸»æœºIPåœ°å€è¿™ä¸ªå¯¹åº”å…³ç³»åœ¨VXLANæ¨¡å¼ä¸‹è¿˜æœ‰å—ã€‚","like_count":0},{"had_liked":false,"id":158647,"user_name":"super","can_delete":false,"product_type":"c1","uid":1431893,"ip_address":"","ucode":"C5AB6ED96F278E","user_header":"https://static001.geekbang.org/account/avatar/00/15/d9/55/c60c5547.jpg","comment_is_top":false,"comment_ctime":1575427139,"is_pvip":true,"discussion_count":0,"race_medal":0,"score":"1575427139","product_id":100015201,"comment_content":"flannel vxlanæŠ“flannel.1ç½‘å¡çœ‹åˆ°çš„åŸåœ°å€æ˜¯flannelç½‘å¡åœ°å€æ˜¯å’‹åšåˆ°çš„å‘¢ï¼Ÿæœ‰çŸ¥é“çš„ä¹ˆï¼Ÿ","like_count":0},{"had_liked":false,"id":153061,"user_name":"djfhchdh","can_delete":false,"product_type":"c1","uid":1484184,"ip_address":"","ucode":"E71D75328CE398","user_header":"https://static001.geekbang.org/account/avatar/00/16/a5/98/a65ff31a.jpg","comment_is_top":false,"comment_ctime":1574150148,"is_pvip":false,"discussion_count":3,"race_medal":0,"score":"1574150148","product_id":100015201,"comment_content":"æœ‰ä¸€ä¸ªé—®é¢˜ï¼Œvxlanè¦æ±‚å®¿ä¸»æœºä¹‹é—´æ˜¯äºŒå±‚è¿é€šå—ï¼Ÿ","like_count":0,"discussions":[{"author":{"id":2334257,"avatar":"https://thirdwx.qlogo.cn/mmopen/vi_32/4fZ9thib248ZkR1N3Eekeyb8N1V1Ud0uePctlI4VQUibPSmEZvgoP0VYl6IsVHJc7ZMiczQMtU76y6E6ag1zNAK4Q/132","nickname":"Geek_336577","note":"","ucode":"4826355EBA4950","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":349466,"discussion_content":"å¿…é¡»ä¸ç”¨ï¼Œæ•°æ®ä»ä¸€ä¸ªæœºå™¨åˆ°å¦å¤–ä¸€ä¸ªæœºå™¨å®é™…ä¸Šæ˜¯èµ°çš„udpå³3å±‚çš„ä¸€ä¸ªé€šä¿¡ã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1613224410,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":2108110,"avatar":"https://static001.geekbang.org/account/avatar/00/20/2a/ce/fea443f7.jpg","nickname":"æ˜","note":"","ucode":"57B974802AD79A","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":298427,"discussion_content":"è¿™ä¸ªåœ°æ–¹åŒæ ·ç–‘æƒ‘ã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1597296664,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1920729,"avatar":"https://static001.geekbang.org/account/avatar/00/1d/4e/d9/550bb4a2.jpg","nickname":"åˆ˜æ™“æ´","note":"","ucode":"4862B1CBB501D2","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":221247,"discussion_content":"ä¸éœ€è¦ï¼Œä¸‰å±‚è¿é€šå³å¯","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1585994719,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":152333,"user_name":"æ‹‰æ¬§","can_delete":false,"product_type":"c1","uid":1206605,"ip_address":"","ucode":"40996A8093A95F","user_header":"https://static001.geekbang.org/account/avatar/00/12/69/4d/81c44f45.jpg","comment_is_top":false,"comment_ctime":1573975924,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1573975924","product_id":100015201,"comment_content":"ä¸èƒ½å§ï¼Œè™½ç„¶flannelå®ç°çš„æ˜¯è™šæ‹Ÿçš„äºŒå±‚ï¼Œå®é™…ä¸Šè¿˜æ˜¯åœ¨ä¸‰å±‚è¿›è¡Œå·¥ä½œçš„ï¼Œmacå±‚è”é€šå®Œå…¨æ˜¯ç‰©ç†å±‚çš„äº‹æƒ…ï¼Œéœ€è¦é“¾è·¯ä¸Šçš„äº¤æ¢æœºå’Œè·¯ç”±ä¿æŒæ­£å¸¸å·¥ä½œï¼Œä¸æ˜¯è½¯ä»¶èƒ½è§£å†³çš„é—®é¢˜","like_count":0},{"had_liked":false,"id":141231,"user_name":"hal","can_delete":false,"product_type":"c1","uid":1359844,"ip_address":"","ucode":"98E625F7327FD9","user_header":"https://static001.geekbang.org/account/avatar/00/14/bf/e4/45758517.jpg","comment_is_top":false,"comment_ctime":1571130851,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1571130851","product_id":100015201,"comment_content":"ğŸ‚.......æˆ‘ç«Ÿç„¶å¬æ‡‚äº†","like_count":0},{"had_liked":false,"id":133926,"user_name":"Geek_7a4ed9","can_delete":false,"product_type":"c1","uid":1120458,"ip_address":"","ucode":"323557E5FC4328","user_header":"https://static001.geekbang.org/account/avatar/00/11/18/ca/2ad3676d.jpg","comment_is_top":false,"comment_ctime":1568700171,"is_pvip":true,"discussion_count":0,"race_medal":0,"score":"1568700171","product_id":100015201,"comment_content":"VXLANæ¨¡å¼ä¸‹å°åŒ…çš„æ—¶å€™ä¸ºä»€ä¹ˆéœ€è¦ç›®çš„VTEPè®¾å¤‡çš„MACåœ°å€,è¿™ä¸ªMACåœ°å€æœ‰å•¥ä½œç”¨ï¼Ÿ<br>æˆ‘ç›®å‰çš„ç†è§£ï¼Œç›®æ ‡æœºå™¨eth0æ¥æ”¶åˆ°åŸå§‹æ•°æ®åŒ…åï¼Œæ ¹æ®VNIå°†åŒ…ä¼ ç»™flannel.1 è®¾å¤‡ï¼Œflannel.1 è®¾å¤‡å†å°†æ•°æ®åŒ…è½¬åˆ°docker0ç½‘å…³å°±å¯ä»¥äº†å•Šã€‚","like_count":0},{"had_liked":false,"id":91525,"user_name":"éšæ„é—¨","can_delete":false,"product_type":"c1","uid":1316502,"ip_address":"","ucode":"6AADD9C133AFCB","user_header":"https://static001.geekbang.org/account/avatar/00/14/16/96/1538f36c.jpg","comment_is_top":false,"comment_ctime":1557048499,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1557048499","product_id":100015201,"comment_content":"å›¾ 1 åŸºäº Flannel UDP æ¨¡å¼çš„è·¨ä¸»é€šä¿¡çš„åŸºæœ¬åŸ...é‡Œé¢çš„flannelçš„ipæ˜¯ä¸æ˜¯åº”è¯¥æ˜¯100.96.0.0&#47;16å•Šï¼Ÿ<br><br>","like_count":0},{"had_liked":false,"id":85047,"user_name":"xfan","can_delete":false,"product_type":"c1","uid":1315147,"ip_address":"","ucode":"48ED8D498D7F56","user_header":"https://static001.geekbang.org/account/avatar/00/14/11/4b/fa64f061.jpg","comment_is_top":false,"comment_ctime":1554966623,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1554966623","product_id":100015201,"comment_content":"ä¸¤ä¸ªå­— å¯é ","like_count":0},{"had_liked":false,"id":81364,"user_name":"fangxuan","can_delete":false,"product_type":"c1","uid":1073369,"ip_address":"","ucode":"3870F2BF5679A2","user_header":"https://static001.geekbang.org/account/avatar/00/10/60/d9/829ac53b.jpg","comment_is_top":false,"comment_ctime":1553872743,"is_pvip":false,"discussion_count":0,"race_medal":1,"score":"1553872743","product_id":100015201,"comment_content":"flanneldç»´æŠ¤äº†å¾ˆå¤šä¿¡æ¯ï¼Œè¿™äº›ä¿¡æ¯éƒ½æ˜¯å­˜åœ¨ç”¨æˆ·æ€è¿˜æ˜¯å†…æ ¸æ€ï¼Ÿå¦å¤–ï¼Œå¦‚æœnode1å’Œnode2ä¸åœ¨ä¸€ä¸ªç½‘æ®µï¼Œå³ä¸­é—´æœ‰ä¸ªè·¯ç”±å™¨ï¼Œfdbä¸­å­˜çš„è®°å½•ä¸­å­˜çš„å°±æ˜¯è·¯ç”±å™¨çš„ipäº†å—ï¼Ÿè¿™ä¸ªå°±ç±»ä¼¼è·¯ç”±å­¦ä¹ äº†å•Šï¼Œflanneldæ˜¯æ€ä¹ˆåšåˆ°çš„ï¼Ÿ","like_count":0},{"had_liked":false,"id":71154,"user_name":"LEON","can_delete":false,"product_type":"c1","uid":1109922,"ip_address":"","ucode":"58F7AF5302FCAD","user_header":"https://static001.geekbang.org/account/avatar/00/10/ef/a2/6ea5bb9e.jpg","comment_is_top":false,"comment_ctime":1551274627,"is_pvip":true,"discussion_count":0,"race_medal":0,"score":"1551274627","product_id":100015201,"comment_content":"ä¸ºä»€ä¹ˆæœ‰çš„æ•™ææ˜¯flannel.0æœ‰çš„æ˜¯flannel.1ã€‚è¿™ä¸¤ä¸ªflannelæˆ‘çœ‹é‡Œé¢åœ°å€çš„æ©ç ä¸ä¸€æ ·ï¼Œæœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿ","like_count":0},{"had_liked":false,"id":63192,"user_name":"Adam","can_delete":false,"product_type":"c1","uid":1305633,"ip_address":"","ucode":"338BA720880E4F","user_header":"https://static001.geekbang.org/account/avatar/00/13/ec/21/b0fe1bfd.jpg","comment_is_top":false,"comment_ctime":1548296334,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1548296334","product_id":100015201,"comment_content":"è€å¸ˆï¼Œè¯·é—®ä¸‹ï¼Œvxlanæ¨¡å¼ä¸‹ï¼Œå®¿ä¸»æœºæ˜¯å¦ä¸éœ€è¦åœ¨åŒä¸€ä¸ªå­ç½‘å†…ï¼Ÿè·¯ç”±ä¸Šå¯è¾¾å°±è¡Œï¼Ÿ","like_count":0},{"had_liked":false,"id":62177,"user_name":"å‡Œ","can_delete":false,"product_type":"c1","uid":1257995,"ip_address":"","ucode":"41369B360C794F","user_header":"https://static001.geekbang.org/account/avatar/00/13/32/0b/81ae214b.jpg","comment_is_top":false,"comment_ctime":1547970278,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1547970278","product_id":100015201,"comment_content":"udpçš„æ¨¡å¼æ¯”vxlanæ•°æ®åŒ…è¦å°‘ä¸€å±‚åŒ…è£…å§","like_count":0},{"had_liked":false,"id":51386,"user_name":"(!0+)[+]+([+]+)[-~]","can_delete":false,"product_type":"c1","uid":1133804,"ip_address":"","ucode":"1544F3EEF6AC6E","user_header":"https://static001.geekbang.org/account/avatar/00/11/4c/ec/9fea079a.jpg","comment_is_top":false,"comment_ctime":1545180109,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1545180109","product_id":100015201,"comment_content":"flannelè¦ä¿è¯å®¹å™¨äºŒå±‚ç½‘ç»œè”é€šï¼Œé¦–å…ˆè¦çŸ¥é“node2ä¸Šçš„å®¹å™¨macåœ°å€äºŒå±‚å¸§éœ€è¦å‘å¾€node2çš„VTEPè®¾å¤‡","like_count":0},{"had_liked":false,"id":49307,"user_name":"jssfy","can_delete":false,"product_type":"c1","uid":1137238,"ip_address":"","ucode":"F16353CFE607B7","user_header":"https://static001.geekbang.org/account/avatar/00/11/5a/56/115c6433.jpg","comment_is_top":false,"comment_ctime":1544663554,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1544663554","product_id":100015201,"comment_content":"å¯ä»¥çœ‹åˆ°ï¼ŒFlannel é€šè¿‡ä¸Šè¿°çš„â€œéš§é“â€æœºåˆ¶ï¼Œå®ç°äº†å®¹å™¨ä¹‹é—´ä¸‰å±‚ç½‘ç»œï¼ˆIP åœ°å€ï¼‰çš„è¿é€šæ€§ã€‚ä½†æ˜¯ï¼Œæ ¹æ®è¿™ä¸ªæœºåˆ¶çš„å·¥ä½œåŸç†ï¼Œä½ è®¤ä¸º Flannel èƒ½è´Ÿè´£ä¿è¯äºŒå±‚ç½‘ç»œï¼ˆMAC åœ°å€ï¼‰çš„è¿é€šæ€§å—ï¼Ÿä¸ºä»€ä¹ˆå‘¢ï¼Ÿ<br>å¦‚æœæ¯ä¸ªflanneldè¿›ç¨‹éƒ½å•ç‹¬ç»´æŠ¤ä¸€ä¸ªå¤§çš„å®¹å™¨arpè¡¨ï¼Œæ˜¯å¦å°±å¯ä»¥å®ç°äºŒå±‚çš„äº’é€šï¼Ÿ","like_count":0},{"had_liked":false,"id":47272,"user_name":"pepezzzz","can_delete":false,"product_type":"c1","uid":1143169,"ip_address":"","ucode":"414AD2DFD4BA1A","user_header":"https://static001.geekbang.org/account/avatar/00/11/71/81/4e47560f.jpg","comment_is_top":false,"comment_ctime":1544096153,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1544096153","product_id":100015201,"comment_content":"å‘å¾€æˆ‘ä»¬å‰é¢æåˆ°çš„â€œç›®çš„ VTEP è®¾å¤‡â€ï¼ˆMAC åœ°å€æ˜¯ 5e:f8:4f:00:e3:37ï¼‰çš„äºŒå±‚æ•°æ®å¸§ï¼Œåº”è¯¥é€šè¿‡ flannel.1 è®¾å¤‡ï¼Œå‘å¾€ IP åœ°å€ä¸º 10.168.0.3 çš„ä¸»æœºã€‚<br><br><br>é€šè¿‡ flannel.1 è®¾å¤‡ ï¼Œè¿™ä¸ªæ˜¯ä¸æ˜¯ä¸å¯¹ï¼Œåº”è¯¥æ˜¯æ¥è‡ªäºã€‚<br>","like_count":0},{"had_liked":false,"id":44401,"user_name":"åœ¨è·¯ä¸Š","can_delete":false,"product_type":"c1","uid":1143372,"ip_address":"","ucode":"335960F683C23C","user_header":"https://static001.geekbang.org/account/avatar/00/11/72/4c/4d636a23.jpg","comment_is_top":false,"comment_ctime":1543420970,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1543420970","product_id":100015201,"comment_content":"ç”±äºæˆ‘ä»¬çš„ IP åŒ…çš„ç›®çš„åœ°å€æ˜¯ 100.96.2.3ï¼Œå®ƒåŒ¹é…ä¸åˆ°æœ¬æœº docker0 ç½‘æ¡¥å¯¹åº”çš„ 100.96.1.0&#47;24 ç½‘æ®µï¼Œåªèƒ½åŒ¹é…åˆ°ç¬¬äºŒæ¡ã€ä¹Ÿå°±æ˜¯ 100.96.0.0&#47;16 å¯¹åº”çš„è¿™æ¡è·¯ç”±è§„åˆ™ï¼Œä»è€Œè¿›å…¥åˆ°ä¸€ä¸ªå«ä½œ flannel0 çš„è®¾å¤‡ä¸­ã€‚<br>è¿™é‡Œä¸å¤ªç†è§£ï¼Œä¸ºä»€ä¹ˆåŒ¹é…åˆ°ç¬¬äºŒæ¡è·¯ç”±è§„åˆ™äº†å‘¢ï¼Ÿ","like_count":0},{"had_liked":false,"id":37743,"user_name":"é™†åŸ¹å°”","can_delete":false,"product_type":"c1","uid":1095319,"ip_address":"","ucode":"B9AE067272513B","user_header":"https://static001.geekbang.org/account/avatar/00/10/b6/97/93e82345.jpg","comment_is_top":false,"comment_ctime":1541723189,"is_pvip":false,"replies":[{"id":"13634","content":"bpfå…¶å®è·Ÿç½‘ç»œå…³ç³»ä¸å¤§ï¼Œå’±ä»¬ä»¥åæœ‰æœºä¼šå†è®²","user_name":"ä½œè€…å›å¤","user_name_real":"Geek_6ef93d","uid":"1218095","ctime":1541767210,"ip_address":"","comment_id":37743,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1541723189","product_id":100015201,"comment_content":"è€å¸ˆèƒ½è¯´ä¸€ä¸‹æœ€è¿‘å¾ˆç«çš„ciliumå—ï¼ŒBPFçš„å†…éƒ¨æœºåˆ¶","like_count":0,"discussions":[{"author":{"id":1218095,"avatar":"https://static001.geekbang.org/account/avatar/00/12/96/2f/876085fa.jpg","nickname":"å¼ ç£Š Kubernetes","note":"","ucode":"16E29BDAB1F5BC","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":428474,"discussion_content":"bpfå…¶å®è·Ÿç½‘ç»œå…³ç³»ä¸å¤§ï¼Œå’±ä»¬ä»¥åæœ‰æœºä¼šå†è®²","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1541767210,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":37681,"user_name":"LEON","can_delete":false,"product_type":"c1","uid":1109922,"ip_address":"","ucode":"58F7AF5302FCAD","user_header":"https://static001.geekbang.org/account/avatar/00/10/ef/a2/6ea5bb9e.jpg","comment_is_top":false,"comment_ctime":1541676941,"is_pvip":true,"replies":[{"id":"13579","content":"ä½ è‡ªå·±å†™çš„javaåº”ç”¨ï¼Œç”¨æˆ·æ€ã€‚ä½ è‡ªå·±å†™çš„linuxå†…æ ¸æ¨¡å—ï¼Œå†…æ ¸æ€ã€‚","user_name":"ä½œè€…å›å¤","user_name_real":"Geek_6ef93d","uid":"1218095","ctime":1541719598,"ip_address":"","comment_id":37681,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1541676941","product_id":100015201,"comment_content":"è€å¸ˆï¼Œè¯·é—®å†…æ ¸æ€å’Œç”¨æˆ·æ€å…·ä½“æŒ‡çš„æ˜¯ä»€ä¹ˆå‘¢ï¼Ÿè¯¥å¦‚ä½•ç†è§£ï¼Ÿ","like_count":0,"discussions":[{"author":{"id":1218095,"avatar":"https://static001.geekbang.org/account/avatar/00/12/96/2f/876085fa.jpg","nickname":"å¼ ç£Š Kubernetes","note":"","ucode":"16E29BDAB1F5BC","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":428446,"discussion_content":"ä½ è‡ªå·±å†™çš„javaåº”ç”¨ï¼Œç”¨æˆ·æ€ã€‚ä½ è‡ªå·±å†™çš„linuxå†…æ ¸æ¨¡å—ï¼Œå†…æ ¸æ€ã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1541719598,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":37417,"user_name":"swordholder","can_delete":false,"product_type":"c1","uid":1002569,"ip_address":"","ucode":"3D1361126AD3CB","user_header":"https://static001.geekbang.org/account/avatar/00/0f/4c/49/d21c134f.jpg","comment_is_top":false,"comment_ctime":1541578749,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1541578749","product_id":100015201,"comment_content":"VXLANå°±æ˜¯å°†äºŒå±‚ç½‘ç»œå¸§å°è£…åœ¨UDPåŒ…ä¸­è¿›è¡Œä¼ è¾“ã€‚<br>å› æ­¤æˆ‘è§‰å¾—å¯¹äºäºŒå±‚ç½‘ç»œå¸§ï¼Œå¯ä»¥å°†ç›®çš„MACåœ°å€é…ç½®åœ¨ FDBï¼ˆForwarding Databaseï¼‰ä¸­ï¼ŒæŒ‡æ˜å‡ºå£è®¾å¤‡flannel.1 å’Œç›®çš„IPåœ°å€ï¼Œåé¢å°±æ˜¯æ­£å¸¸çš„UDPåŒ…ä¼ è¾“è¿‡ç¨‹ã€‚","like_count":0},{"had_liked":false,"id":37392,"user_name":"é£è½¨","can_delete":false,"product_type":"c1","uid":1185844,"ip_address":"","ucode":"7B8A5233B61EB0","user_header":"https://static001.geekbang.org/account/avatar/00/12/18/34/c082419c.jpg","comment_is_top":false,"comment_ctime":1541567924,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1541567924","product_id":100015201,"comment_content":"æ ¹æ®æ–‡ä¸­æè¿°ï¼Œå®¹å™¨ä¹‹é—´äºŒå±‚ç½‘ç»œä¸é€šï¼ŒVTEPè®¾å¤‡ä¹‹é—´äºŒå±‚ç½‘ç»œæ˜¯è”é€šçš„ã€‚<br>å®¹å™¨é€šè¿‡docker0ç½‘æ¡¥ä¸VTEPè®¾å¤‡é€šä¿¡ï¼Œæ‰€ä»¥å®¹å™¨ä¹‹é—´çš„äºŒå±‚ç½‘ç»œä¸è”é€šã€‚<br>æ¨è®º:<br>è¦è®©å®¹å™¨ä¹‹é—´äºŒå±‚ç½‘ç»œè”é€šï¼Œé™¤éæ¯ä¸ªå®¹å™¨éƒ½æ‹¥æœ‰è‡ªå·±çš„VTEPè®¾å¤‡ï¼Œä¸”è¿™äº›è®¾å¤‡çš„VNIæ ‡è¯†ä¸€æ ·ï¼ŒåŒä¸€å°å®¿ä¸»æœºä¸Šçš„VTEPè®¾å¤‡VNIåº”è¯¥ä¸èƒ½ä¸€æ ·ã€‚<br><br>å®¹å™¨ä¹‹é—´è¿›è¡ŒäºŒå±‚é€šä¿¡ä¼¼ä¹æ²¡æœ‰å¿…è¦ã€‚","like_count":0},{"had_liked":false,"id":37345,"user_name":"Vincen","can_delete":false,"product_type":"c1","uid":1218185,"ip_address":"","ucode":"1029A901EC7BA0","user_header":"https://static001.geekbang.org/account/avatar/00/12/96/89/9312b3a2.jpg","comment_is_top":false,"comment_ctime":1541553426,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1541553426","product_id":100015201,"comment_content":"åº”è¯¥ä¸èƒ½å§ äºŒå±‚çš„æ•°æ®åŒ…æ ¹æœ¬ä¸ä¼šå‘é€ç»™flannel","like_count":0},{"had_liked":false,"id":37327,"user_name":"DJH","can_delete":false,"product_type":"c1","uid":1256740,"ip_address":"","ucode":"2BDEF123B3DB6A","user_header":"https://static001.geekbang.org/account/avatar/00/13/2d/24/28acca15.jpg","comment_is_top":false,"comment_ctime":1541551520,"is_pvip":false,"discussion_count":1,"race_medal":0,"score":"1541551520","product_id":100015201,"comment_content":"è¯·æ•™ä¸€ä¸‹ï¼Œæ¯ä¸ªä¸»æœºä¸Šçš„VTEAPè®¾å¤‡çš„VNIå€¼æ˜¯ä¸æ˜¯éƒ½æ˜¯ä¸åŒï¼ˆå”¯ä¸€ï¼‰çš„ï¼Ÿ","like_count":0,"discussions":[{"author":{"id":1281551,"avatar":"http://thirdwx.qlogo.cn/mmopen/vi_32/pZ5ibu3jOPTfWVtzTeNTiaL2PiabGT2Y2yKd2TNDcZMkIY34T5fhGcSnBjgpkd54Q3S6b3gRW3yYTxZk0QHYB0qnw/132","nickname":"å•Šæ ‘","note":"","ucode":"F1072F4610B6F8","race_medal":0,"user_type":1,"is_pvip":true},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":582985,"discussion_content":"VNI çš„é»˜è®¤å€¼æ˜¯ 1","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1659861867,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":"å¹¿ä¸œ"},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]}]}