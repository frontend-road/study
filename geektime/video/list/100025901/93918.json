{"id":93918,"title":"20 | 滚动视图的基类UIScrollView简介","content":"<p><strong>PDF 课件和源代码下载地址：</strong></p><p><a href=\"https://gitee.com/geektime-geekbang/geektime-ios-course\">https://gitee.com/geektime-geekbang/geektime-ios-course</a></p>","comments":[{"had_liked":false,"id":101723,"user_name":"Masami","can_delete":false,"product_type":"c3","uid":1505981,"ip_address":"","ucode":"73E03F53335DBC","user_header":"https://static001.geekbang.org/account/avatar/00/16/fa/bd/7bf33188.jpg","comment_is_top":false,"comment_ctime":1559930334,"is_pvip":false,"replies":[{"id":37018,"content":"整体的原因就是因为UIScrollViewContentInsetAdjustmentBehavior这个属性。\n\n在项目中我们没有设置，默认系统会在addsubview之后，就是scrollView展示之前自动的调整Inset，导致了offset的变化，所以初始化的时候，其实整体的页面是下移的。\n\n设置了pagingEnabled，系统会自动的处理offset来实现分页的效果.所以对于垂直方向，所以这种自动处理在滑动时会导致之前变化的offset回滚到0。所以就有了上移，而不设置pagingEnabled时系统不会自动调整offset，完全由用户操作，所以就不会出现这种现象。\n\n解决的办法就是设置scrollView.contentInsetAdjustmentBehavior = UIScrollViewContentInsetAdjustmentNever。在日常frame布局的项目中，所有的scrollView也都设置了这个属性。相关的知识因为在之后的课程中会进行讲解，所以在当前的项目中，没有设置这个属性。","user_name":"作者回复","user_name_real":"dequanzhu","uid":1041455,"ctime":1560247553,"ip_address":"","comment_id":101723,"utype":1}],"discussion_count":1,"race_medal":0,"score":2,"product_id":100025901,"comment_content":"我发现pagingEnabled在案例中，除了翻页的效果外，使用之后整个scrollView刚开始是正常的，然后经过点击或滑动，它就会自动上移一个导航栏的高度后，保持这个高度。\n如果没有使用scrollView.pagingEnabled。那么scrollView高度就稳定在导航栏高度之下。\n请问这是什么原因呢？使用和不使用它，会造成\n不一样的结果，那如何解决呢？","like_count":6,"discussions":[{"author":{"id":1041455,"avatar":"http://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTKJ3dLlYr6tznfnZXJNsD7Jw48BVnFSib3RO3VWEN0pgebRY1jaR8YXLQ6iaAjTsFiamOWSA3UPAa37A/132","nickname":"Geek_e7jq8k","note":"","ucode":"352964E5D793DA","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":453087,"discussion_content":"整体的原因就是因为UIScrollViewContentInsetAdjustmentBehavior这个属性。\n\n在项目中我们没有设置，默认系统会在addsubview之后，就是scrollView展示之前自动的调整Inset，导致了offset的变化，所以初始化的时候，其实整体的页面是下移的。\n\n设置了pagingEnabled，系统会自动的处理offset来实现分页的效果.所以对于垂直方向，所以这种自动处理在滑动时会导致之前变化的offset回滚到0。所以就有了上移，而不设置pagingEnabled时系统不会自动调整offset，完全由用户操作，所以就不会出现这种现象。\n\n解决的办法就是设置scrollView.contentInsetAdjustmentBehavior = UIScrollViewContentInsetAdjustmentNever。在日常frame布局的项目中，所有的scrollView也都设置了这个属性。相关的知识因为在之后的课程中会进行讲解，所以在当前的项目中，没有设置这个属性。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1560247553,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":136471,"user_name":"Bojack","can_delete":false,"product_type":"c3","uid":1251080,"ip_address":"","ucode":"A57E552845DB28","user_header":"http://thirdwx.qlogo.cn/mmopen/vi_32/DYAIOgq83eoLw2qjwoaVCDq8BqCcXOibyTG3rxiaJlDy2lt62IkiaDrrHeVwq4Pe8RpBbYJTIiadyicZ7InBCLCjJtQ/132","comment_is_top":false,"comment_ctime":1569457130,"is_pvip":false,"replies":[{"id":53132,"content":"view的bounds，scrollview的bounds是相同的，同时scrollview 中 contentsize的height也是和view&#47;scrollView height相同，比如iphoneXR中，都是896. 为什么会出现滚动条呢？在课程中也讲过，对于一个滚动视图来说，影响滚动的不光有contentSize，还有contentInset。所以我们可以在视图加载完成之后选择合适的时机增加断点，可以发现scrollView的contentInset是有值的。那么为什么我们没有设置contentInset，它自动就有值了？是因为在iOS11之后，系统增加了contentInsetAdjustmentBehavior这个属性，默认是UIScrollViewContentInsetAdjustmentAutomatic，他会根据当前的页面结构（比如在navigation controller中）自动的设置contentInset来进行适配。当然这个属性在使用frame布局的项目中会造成一定的迷惑，所以可以手动的设置该属性为UIScrollViewContentInsetAdjustmentNever，这样就和我们设置frame时候的预期相同了。可以增加这个属性之后，结合断点在看下～","user_name":"作者回复","user_name_real":"朱德权","uid":1041455,"ctime":1570072044,"ip_address":"","comment_id":136471,"utype":1}],"discussion_count":1,"race_medal":0,"score":2,"product_id":100025901,"comment_content":"想问下老师，UIViewController的高度是多少，为什么还会出现纵向滚动条。","like_count":1,"discussions":[{"author":{"id":1041455,"avatar":"http://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTKJ3dLlYr6tznfnZXJNsD7Jw48BVnFSib3RO3VWEN0pgebRY1jaR8YXLQ6iaAjTsFiamOWSA3UPAa37A/132","nickname":"Geek_e7jq8k","note":"","ucode":"352964E5D793DA","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":468651,"discussion_content":"view的bounds，scrollview的bounds是相同的，同时scrollview 中 contentsize的height也是和view/scrollView height相同，比如iphoneXR中，都是896. 为什么会出现滚动条呢？在课程中也讲过，对于一个滚动视图来说，影响滚动的不光有contentSize，还有contentInset。所以我们可以在视图加载完成之后选择合适的时机增加断点，可以发现scrollView的contentInset是有值的。那么为什么我们没有设置contentInset，它自动就有值了？是因为在iOS11之后，系统增加了contentInsetAdjustmentBehavior这个属性，默认是UIScrollViewContentInsetAdjustmentAutomatic，他会根据当前的页面结构（比如在navigation controller中）自动的设置contentInset来进行适配。当然这个属性在使用frame布局的项目中会造成一定的迷惑，所以可以手动的设置该属性为UIScrollViewContentInsetAdjustmentNever，这样就和我们设置frame时候的预期相同了。可以增加这个属性之后，结合断点在看下～","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1570072044,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":131845,"user_name":"Geek_da3bc7","can_delete":false,"product_type":"c3","uid":1614700,"ip_address":"","ucode":"409778DAFD2C7B","user_header":"","comment_is_top":false,"comment_ctime":1567934663,"is_pvip":false,"replies":[{"id":50466,"content":"加油！","user_name":"作者回复","user_name_real":"朱德权","uid":1041455,"ctime":1568018725,"ip_address":"","comment_id":131845,"utype":1}],"discussion_count":1,"race_medal":0,"score":2,"product_id":100025901,"comment_content":"这个适合刚入行的朋友们","like_count":1,"discussions":[{"author":{"id":1041455,"avatar":"http://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTKJ3dLlYr6tznfnZXJNsD7Jw48BVnFSib3RO3VWEN0pgebRY1jaR8YXLQ6iaAjTsFiamOWSA3UPAa37A/132","nickname":"Geek_e7jq8k","note":"","ucode":"352964E5D793DA","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":466642,"discussion_content":"加油！","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1568018725,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":131281,"user_name":"itgou","can_delete":false,"product_type":"c3","uid":1394159,"ip_address":"","ucode":"4F6FFA0DD1ACBA","user_header":"https://wx.qlogo.cn/mmopen/vi_32/pTZS48zWWAhI0zGXrib8s124HSenCS2FTDD0r4SKCqw2ub4adicI4x2wTeH7bHdlsl8QwxeVmzTGs1PIImURxxPg/132","comment_is_top":false,"comment_ctime":1567689852,"is_pvip":false,"replies":[{"id":50470,"content":"frame是相对于父View坐标系下的位置，而bounds是相对于自己坐标系的位置。简单的说就是对于size来说，两者是一样的，而对于origin ，frame是这个view在superView的位置，而bounds一般来说是origin是{0,0}","user_name":"作者回复","user_name_real":"朱德权","uid":1041455,"ctime":1568019106,"ip_address":"","comment_id":131281,"utype":1}],"discussion_count":3,"race_medal":0,"score":2,"product_id":100025901,"comment_content":"frame和bounds有什么区别呢？","like_count":1,"discussions":[{"author":{"id":1041455,"avatar":"http://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTKJ3dLlYr6tznfnZXJNsD7Jw48BVnFSib3RO3VWEN0pgebRY1jaR8YXLQ6iaAjTsFiamOWSA3UPAa37A/132","nickname":"Geek_e7jq8k","note":"","ucode":"352964E5D793DA","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":466369,"discussion_content":"frame是相对于父View坐标系下的位置，而bounds是相对于自己坐标系的位置。简单的说就是对于size来说，两者是一样的，而对于origin ，frame是这个view在superView的位置，而bounds一般来说是origin是{0,0}","likes_number":1,"is_delete":false,"is_hidden":false,"ctime":1568019106,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1457784,"avatar":"http://thirdwx.qlogo.cn/mmopen/vi_32/DYAIOgq83ep8unibCib9rdHib0D6Rf6TjecPQu1yic0G9sjzriczlTcwGHP6DaxtEmHyN7pCrD9zV7OSegyf7EUBvaA/132","nickname":"Geek__2099","note":"","ucode":"01444B60F18A66","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":361358,"discussion_content":"view自身的坐标系原点，是间接的用bounds.orgin来定义view左上角的坐标，来明确的。\nbounds.ogrin(0,0),表示原点与左上角重合。\n显然，如果bounds.ogrin(10,10),则表示原点，在左上角的左上方。\n\n对于child view来说，它在父view中位置，要在父view的坐标系中，用frame.ogrin(x,y)来表示其左上角的坐标来确定。故在默认情况下，frame.ogrin是相对于父view的左上角来确定的。\n\n因此两者区别是：bounds的用途是确定自身坐标系，而frame的用途是确定自身在父坐标系中的位置。\n\n在scrollview中，可以发现bounds.ogrin与contentOffset一致。contentView的左上角就是自身坐标系的原点.\n\n对于size来说，修改farme.size,不会改变frame.orgin.修改bounds.size,将以其中心点为中心，按比例缩放，会改变frame.orgin的。无论修改哪个都不会改变bounds.orgin，且frame.size与ogrin.size也保持一致。\n\n","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1616649448,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1614700,"avatar":"","nickname":"Geek_da3bc7","note":"","ucode":"409778DAFD2C7B","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":8347,"discussion_content":"frame是指添加视图内部坐标  bounds 是包含添加的坐标","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1567934925,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":120762,"user_name":"Geek_562ab0","can_delete":false,"product_type":"c3","uid":1583189,"ip_address":"","ucode":"8062DCBA7DB7F9","user_header":"http://thirdwx.qlogo.cn/mmopen/vi_32/Zb3b6PrfcFIZIkLYtUUNlJpvey599DLPCFQUQxLSx0GosujYvsa8CribLle3TU88nx8bg1hsfABMX1NvUy3sdOg/132","comment_is_top":false,"comment_ctime":1564991881,"is_pvip":false,"replies":[{"id":44357,"content":"具体可以看下https:&#47;&#47;gcc.gnu.org&#47;onlinedocs&#47;gcc&#47;Statement-Exprs.html 哈。其实也可以不用纠结，就是一个书写的方式而已，在代码较多的时候会显得整洁一些。","user_name":"作者回复","user_name_real":"dequanzhu","uid":1041455,"ctime":1565006875,"ip_address":"","comment_id":120762,"utype":1}],"discussion_count":1,"race_medal":0,"score":2,"product_id":100025901,"comment_content":"[scrollView addSubview:({...})]; 这里addSubview 后面的代码是block吗，而且为什么要在后面写 view; 这句代码呢？","like_count":0,"discussions":[{"author":{"id":1041455,"avatar":"http://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTKJ3dLlYr6tznfnZXJNsD7Jw48BVnFSib3RO3VWEN0pgebRY1jaR8YXLQ6iaAjTsFiamOWSA3UPAa37A/132","nickname":"Geek_e7jq8k","note":"","ucode":"352964E5D793DA","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":461465,"discussion_content":"具体可以看下https://gcc.gnu.org/onlinedocs/gcc/Statement-Exprs.html 哈。其实也可以不用纠结，就是一个书写的方式而已，在代码较多的时候会显得整洁一些。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1565006875,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":119081,"user_name":"Geek_baozi","can_delete":false,"product_type":"c3","uid":1505815,"ip_address":"","ucode":"516056866F51AD","user_header":"","comment_is_top":false,"comment_ctime":1564499626,"is_pvip":false,"replies":[{"id":44294,"content":"可以简单的debug下，contentSize横向是否可以滚动？showsHorizontalScrollIndicator是否有正确的设置？是否能看到scrollview的底部没有被遮挡？如果还是没有找到问题的愿意，建议发下代码的地址哈，我帮你看下","user_name":"作者回复","user_name_real":"dequanzhu","uid":1041455,"ctime":1564970303,"ip_address":"","comment_id":119081,"utype":1}],"discussion_count":3,"race_medal":0,"score":2,"product_id":100025901,"comment_content":"为何我的横向移动看不到滚动条呢？纵向是正常的，是被底部的tabbar挡住了吗","like_count":0,"discussions":[{"author":{"id":1041455,"avatar":"http://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTKJ3dLlYr6tznfnZXJNsD7Jw48BVnFSib3RO3VWEN0pgebRY1jaR8YXLQ6iaAjTsFiamOWSA3UPAa37A/132","nickname":"Geek_e7jq8k","note":"","ucode":"352964E5D793DA","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":460739,"discussion_content":"可以简单的debug下，contentSize横向是否可以滚动？showsHorizontalScrollIndicator是否有正确的设置？是否能看到scrollview的底部没有被遮挡？如果还是没有找到问题的愿意，建议发下代码的地址哈，我帮你看下","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1564970186,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1317994,"avatar":"https://static001.geekbang.org/account/avatar/00/14/1c/6a/988ad74a.jpg","nickname":"乐只君子","note":"","ucode":"DBBDB0AB9474C0","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":160376,"discussion_content":"模拟器 6s iOS 10.3.1 好像真的没有横向滚动条","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1580796570,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1505815,"avatar":"","nickname":"Geek_baozi","note":"","ucode":"516056866F51AD","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":6084,"discussion_content":"Xcode版本升级后无此问题，谢谢老师","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1566662083,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":190061,"user_name":"Shnerd","can_delete":false,"product_type":"c3","uid":1440263,"ip_address":"","ucode":"3630276571AF66","user_header":"https://static001.geekbang.org/account/avatar/00/15/fa/07/1d50f530.jpg","comment_is_top":false,"comment_ctime":1584599456,"is_pvip":false,"replies":null,"discussion_count":0,"race_medal":0,"score":2,"product_id":100025901,"comment_content":"讲的很清楚。👍","like_count":2},{"had_liked":false,"id":291136,"user_name":"wxyzjp 123","can_delete":false,"product_type":"c3","uid":2573454,"ip_address":"","ucode":"6E8739C65165BE","user_header":"https://static001.geekbang.org/account/avatar/00/27/44/8e/5a841e48.jpg","comment_is_top":false,"comment_ctime":1620044854,"is_pvip":false,"replies":null,"discussion_count":1,"race_medal":0,"score":2,"product_id":100025901,"comment_content":"想问一下addsubview那里，view.background那行下面为什么还有一个view；呢，41行","like_count":0,"discussions":[{"author":{"id":1409779,"avatar":"https://static001.geekbang.org/account/avatar/00/15/82/f3/41231058.jpg","nickname":"化随风","note":"","ucode":"EE0072D09D2531","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":597285,"discussion_content":"这是返回值","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1671613898,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":"江苏","group_id":0},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]}]}