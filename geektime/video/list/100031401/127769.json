{"id":127769,"title":"73 | 深入理解Service和ServiceDiscovery","content":"<ul>\n<li>\n<p>代码：<a href=\"https://gitee.com/geektime-geekbang/staffjoy\">https://gitee.com/geektime-geekbang/staffjoy</a></p>\n</li>\n<li>\n<p>课件：<a href=\"https://pan.baidu.com/s/1Q7eP3yZ1Vm8J2nhle5RzTQ\">https://pan.baidu.com/s/1Q7eP3yZ1Vm8J2nhle5RzTQ</a> 提取码: 1aeh</p>\n</li>\n</ul>","comments":[{"had_liked":false,"id":148291,"user_name":"🍒古刹飞鹰🍒","can_delete":false,"product_type":"c3","uid":1666659,"ip_address":"","ucode":"375F9FCF925CA6","user_header":"https://static001.geekbang.org/account/avatar/00/19/6e/63/b15d1d87.jpg","comment_is_top":false,"comment_ctime":1572968777,"is_pvip":false,"replies":[{"id":57229,"content":"课程第2章有解释dubbo -&gt; SpringCloud -&gt; Kubernetes的演进历史，从某种意义上讲，这三者解决相同基本问题：分布式微服务基础框架(或平台)，只不过是三家不同公司(阿里&#47;Netflix&#47;Google)分别发展出来的不同体系。所以，它们是有功能冗余的，k8s是微服务最全面的平台型解决方案，它内置支持服务发现(Service)、网关&#47;反向代理(Ingress)，和分布式配置(configmap)等。所以，我个人的建议是，如果采用K8s，就不要用SpringCloud大套餐了，用K8s + SpringBoot就够了，K8s和裸框架配合比较好，并且它是具体框架无关的。","user_name":"作者回复","user_name_real":"杨波","uid":1030344,"ctime":1573044465,"ip_address":"","comment_id":148291,"utype":1}],"discussion_count":3,"race_medal":0,"score":2,"product_id":100031401,"comment_content":"老师，我有点迷糊，如果启用 kubernetes   那SpringCloud里的eurka、gateway、配置中心、监控什么的是不是就可以弃用了？，因为kubernetes里有相关配套的服务，是不是可以直接使用kubernetes的了？","like_count":8,"discussions":[{"author":{"id":1030344,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/b8/c8/c94d38a7.jpg","nickname":"杨波","note":"","ucode":"FA3418BB703BCA","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":473453,"discussion_content":"课程第2章有解释dubbo -&amp;gt; SpringCloud -&amp;gt; Kubernetes的演进历史，从某种意义上讲，这三者解决相同基本问题：分布式微服务基础框架(或平台)，只不过是三家不同公司(阿里/Netflix/Google)分别发展出来的不同体系。所以，它们是有功能冗余的，k8s是微服务最全面的平台型解决方案，它内置支持服务发现(Service)、网关/反向代理(Ingress)，和分布式配置(configmap)等。所以，我个人的建议是，如果采用K8s，就不要用SpringCloud大套餐了，用K8s + SpringBoot就够了，K8s和裸框架配合比较好，并且它是具体框架无关的。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1573044465,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1048261,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/fe/c5/3467cf94.jpg","nickname":"正是那朵玫瑰","note":"","ucode":"73D630B654573F","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":376600,"discussion_content":"如果不用springcloud了，那hytrix的熔断功能有谁来代替呢？","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1622208083,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1666659,"avatar":"https://static001.geekbang.org/account/avatar/00/19/6e/63/b15d1d87.jpg","nickname":"🍒古刹飞鹰🍒","note":"","ucode":"375F9FCF925CA6","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":45522,"discussion_content":"谢谢老师，我明白了","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1573045651,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":166032,"user_name":"DDs moving castle","can_delete":false,"product_type":"c3","uid":1066684,"ip_address":"","ucode":"08CA816F665E39","user_header":"https://static001.geekbang.org/account/avatar/00/10/46/bc/463cca3f.jpg","comment_is_top":false,"comment_ctime":1577367373,"is_pvip":false,"replies":[{"id":64900,"content":"iptables规则设置支持简单的负载均衡策略，ipvs模式则支持高级的负载均衡策略，参考：\nhttps:&#47;&#47;kubernetes.io&#47;blog&#47;2018&#47;07&#47;09&#47;ipvs-based-in-cluster-load-balancing-deep-dive&#47;","user_name":"作者回复","user_name_real":"杨波","uid":1030344,"ctime":1577702944,"ip_address":"","comment_id":166032,"utype":1}],"discussion_count":1,"race_medal":0,"score":2,"product_id":100031401,"comment_content":"用户空间代理模式中kube-proxy可以根据负载均衡策略返回某个pod IP，变成了iptables&#47;ipvs模式后，netfilter内部也有负载均衡策略可以选出某个pod？这是基于Linux内核某个版本的升级吗？","like_count":2,"discussions":[{"author":{"id":1030344,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/b8/c8/c94d38a7.jpg","nickname":"杨波","note":"","ucode":"FA3418BB703BCA","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":479362,"discussion_content":"iptables规则设置支持简单的负载均衡策略，ipvs模式则支持高级的负载均衡策略，参考：\nhttps://kubernetes.io/blog/2018/07/09/ipvs-based-in-cluster-load-balancing-deep-dive/","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1577702944,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":136863,"user_name":"狼鱼","can_delete":false,"product_type":"c3","uid":1109255,"ip_address":"","ucode":"CA06ACA2AF8044","user_header":"https://static001.geekbang.org/account/avatar/00/10/ed/07/3a3e766f.jpg","comment_is_top":false,"comment_ctime":1569544656,"is_pvip":false,"replies":[{"id":52570,"content":"prometheus支持通过k8s的REST API获取集群内pod的ip地址，进行pod级别监控，也可以监控节点&#47;服务&#47;端点级别，细节配置可以参考官方文档：\nhttps:&#47;&#47;prometheus.io&#47;docs&#47;prometheus&#47;latest&#47;configuration&#47;configuration&#47;#kubernetes_sd_config\n","user_name":"作者回复","user_name_real":"杨波","uid":1030344,"ctime":1569588826,"ip_address":"","comment_id":136863,"utype":1}],"discussion_count":1,"race_medal":0,"score":2,"product_id":100031401,"comment_content":"如果想获取service中所有有效的pod 的 ip 地址，有方法吗？ 比如想配置到 prometheus 中拉取数据","like_count":2,"discussions":[{"author":{"id":1030344,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/b8/c8/c94d38a7.jpg","nickname":"杨波","note":"","ucode":"FA3418BB703BCA","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":468833,"discussion_content":"prometheus支持通过k8s的REST API获取集群内pod的ip地址，进行pod级别监控，也可以监控节点/服务/端点级别，细节配置可以参考官方文档：\nhttps://prometheus.io/docs/prometheus/latest/configuration/configuration/#kubernetes_sd_config\n","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1569588826,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":137254,"user_name":"杨波","can_delete":false,"product_type":"c3","uid":1030344,"ip_address":"","ucode":"FA3418BB703BCA","user_header":"https://static001.geekbang.org/account/avatar/00/0f/b8/c8/c94d38a7.jpg","comment_is_top":false,"comment_ctime":1569668906,"is_pvip":false,"replies":null,"discussion_count":0,"race_medal":0,"score":2,"product_id":100031401,"comment_content":"课程补充材料，作者亲自撰写的博文《Kubernetes网络三部曲之二～Service网络》\nhttps:&#47;&#47;blog.csdn.net&#47;yang75108&#47;article&#47;details&#47;101267444\n","like_count":10},{"had_liked":false,"id":343829,"user_name":"wahaha","can_delete":false,"product_type":"c3","uid":1008747,"ip_address":"","ucode":"EAD5AEE19ECF8B","user_header":"http://thirdwx.qlogo.cn/mmopen/vi_32/WFX7G7hO480BopLPxhY0DqTtDicUCgNHnk4XP1gJfsv37DCRvK9mwRTDHdQX4y0MTdp8DWsnxmkBsmw2Fdtib7MQ/132","comment_is_top":false,"comment_ctime":1651071874,"is_pvip":false,"replies":null,"discussion_count":0,"race_medal":0,"score":2,"product_id":100031401,"comment_content":"请问有没有springboot在k8s下同步通过feign进行服务间通信的示例？","like_count":1},{"had_liked":false,"id":308535,"user_name":"艺超(鲁鸣)","can_delete":false,"product_type":"c3","uid":1029436,"ip_address":"","ucode":"7F749FA543E0F1","user_header":"https://static001.geekbang.org/account/avatar/00/0f/b5/3c/967d7291.jpg","comment_is_top":false,"comment_ctime":1629679677,"is_pvip":false,"replies":null,"discussion_count":0,"race_medal":0,"score":2,"product_id":100031401,"comment_content":"用户空间模式下，kube proxy和net filter也有交互吗？那条虚线","like_count":0}]}