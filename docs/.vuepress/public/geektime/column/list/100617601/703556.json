{"id":703556,"title":"09ï½œé“¾ï¼ˆä¸‹ï¼‰ï¼šæƒ³å­¦â€œè‚²èŠ±â€è¿˜æ˜¯â€œæ’èŠ±â€ï¼Ÿç”¨RouterChainç¡®å®šå®¢æˆ·æ„å›¾","content":"<p>ä½ å¥½ï¼Œæˆ‘æ˜¯é»„ä½³ã€‚æ¬¢è¿æ¥åˆ°LangChainå®æˆ˜è¯¾ï¼</p><p>ä¸Šä¸€èŠ‚è¯¾ä¸­ï¼Œæˆ‘å¸¦ç€ä½ å­¦ä¹ äº†Chainçš„åŸºæœ¬æ¦‚å¿µï¼Œè¿˜ä½¿ç”¨äº†LLMChainå’ŒSequencialChainï¼Œè¿™ä¸€èŠ‚è¯¾ï¼Œæˆ‘ä»¬å†æ¥çœ‹çœ‹å…¶ä»–ç±»å‹çš„ä¸€äº›Chainçš„ç”¨æ³•ã€‚</p><h2>ä»»åŠ¡è®¾å®š</h2><p>é¦–å…ˆï¼Œè¿˜æ˜¯å…ˆçœ‹ä¸€ä¸‹ä»Šå¤©è¦å®Œæˆä¸€ä¸ªä»€ä¹ˆæ ·çš„ä»»åŠ¡ã€‚</p><p>è¿™é‡Œå‡è®¾å’±ä»¬çš„é²œèŠ±è¿è¥æ™ºèƒ½å®¢æœChatBoté€šå¸¸ä¼šæ¥åˆ°ä¸¤å¤§ç±»é—®é¢˜ã€‚</p><ol>\n<li><strong>é²œèŠ±å…»æŠ¤</strong>ï¼ˆä¿æŒèŠ±çš„å¥åº·ã€å¦‚ä½•æµ‡æ°´ã€æ–½è‚¥ç­‰ï¼‰</li>\n<li><strong>é²œèŠ±è£…é¥°</strong>ï¼ˆå¦‚ä½•æ­é…èŠ±ã€å¦‚ä½•è£…é¥°åœºåœ°ç­‰ï¼‰</li>\n</ol><p>ä½ çš„éœ€æ±‚æ˜¯ï¼Œ<strong>å¦‚æœæ¥åˆ°çš„æ˜¯ç¬¬ä¸€ç±»é—®é¢˜ï¼Œä½ è¦ç»™ChatBot AæŒ‡ç¤ºï¼›å¦‚æœæ¥åˆ°ç¬¬äºŒç±»çš„é—®é¢˜ï¼Œä½ è¦ç»™ChatBot BæŒ‡ç¤º</strong>ã€‚</p><p><img src=\"https://static001.geekbang.org/resource/image/d8/59/d8491e696c03f49a331c94e31d20e559.jpg?wh=1490x1077\" alt=\"\"></p><p>æˆ‘ä»¬å¯ä»¥æ ¹æ®è¿™ä¸¤ä¸ªåœºæ™¯æ¥æ„å»ºä¸¤ä¸ªä¸åŒçš„ç›®æ ‡é“¾ã€‚é‡åˆ°ä¸åŒç±»å‹çš„é—®é¢˜ï¼ŒLangChainä¼šé€šè¿‡RouterChainæ¥è‡ªåŠ¨å¼•å¯¼å¤§è¯­è¨€æ¨¡å‹é€‰æ‹©ä¸åŒçš„æ¨¡æ¿ã€‚</p><p>å½“ç„¶æˆ‘ä»¬çš„è¿è¥è¿‡ç¨‹ä¼šé‡åˆ°æ›´å¤šç§ç±»çš„é—®é¢˜ï¼Œä½ åªéœ€è¦é€šè¿‡åŒæ ·çš„æ–¹æ³•æ‰©å……é€»è¾‘å³å¯ã€‚</p><h2>æ•´ä½“æ¡†æ¶</h2><p>RouterChainï¼Œä¹Ÿå«è·¯ç”±é“¾ï¼Œèƒ½åŠ¨æ€é€‰æ‹©ç”¨äºç»™å®šè¾“å…¥çš„ä¸‹ä¸€ä¸ªé“¾ã€‚æˆ‘ä»¬ä¼šæ ¹æ®ç”¨æˆ·çš„é—®é¢˜å†…å®¹ï¼Œé¦–å…ˆä½¿ç”¨è·¯ç”±å™¨é“¾ç¡®å®šé—®é¢˜æ›´é€‚åˆå“ªä¸ªå¤„ç†æ¨¡æ¿ï¼Œç„¶åå°†é—®é¢˜å‘é€åˆ°è¯¥å¤„ç†æ¨¡æ¿è¿›è¡Œå›ç­”ã€‚å¦‚æœé—®é¢˜ä¸é€‚åˆä»»ä½•å·²å®šä¹‰çš„å¤„ç†æ¨¡æ¿ï¼Œå®ƒä¼šè¢«å‘é€åˆ°é»˜è®¤é“¾ã€‚</p><p>åœ¨è¿™é‡Œï¼Œæˆ‘ä»¬ä¼šç”¨LLMRouterChainå’ŒMultiPromptChainï¼ˆä¹Ÿæ˜¯ä¸€ç§è·¯ç”±é“¾ï¼‰ç»„åˆå®ç°è·¯ç”±åŠŸèƒ½ï¼Œè¯¥MultiPromptChainä¼šè°ƒç”¨LLMRouterChainé€‰æ‹©ä¸ç»™å®šé—®é¢˜æœ€ç›¸å…³çš„æç¤ºï¼Œç„¶åä½¿ç”¨è¯¥æç¤ºå›ç­”é—®é¢˜ã€‚</p><!-- [[[read_end]]] --><p><strong>å…·ä½“æ­¥éª¤å¦‚ä¸‹ï¼š</strong></p><ol>\n<li>æ„å»ºå¤„ç†æ¨¡æ¿ï¼šä¸ºé²œèŠ±æŠ¤ç†å’Œé²œèŠ±è£…é¥°åˆ†åˆ«å®šä¹‰ä¸¤ä¸ªå­—ç¬¦ä¸²æ¨¡æ¿ã€‚</li>\n<li>æç¤ºä¿¡æ¯ï¼šä½¿ç”¨ä¸€ä¸ªåˆ—è¡¨æ¥ç»„ç»‡å’Œå­˜å‚¨è¿™ä¸¤ä¸ªå¤„ç†æ¨¡æ¿çš„å…³é”®ä¿¡æ¯ï¼Œå¦‚æ¨¡æ¿çš„é”®ã€æè¿°å’Œå®é™…å†…å®¹ã€‚</li>\n<li>åˆå§‹åŒ–è¯­è¨€æ¨¡å‹ï¼šå¯¼å…¥å¹¶å®ä¾‹åŒ–è¯­è¨€æ¨¡å‹ã€‚</li>\n<li>æ„å»ºç›®æ ‡é“¾ï¼šæ ¹æ®æç¤ºä¿¡æ¯ä¸­çš„æ¯ä¸ªæ¨¡æ¿æ„å»ºäº†å¯¹åº”çš„LLMChainï¼Œå¹¶å­˜å‚¨åœ¨ä¸€ä¸ªå­—å…¸ä¸­ã€‚</li>\n<li>æ„å»ºLLMè·¯ç”±é“¾ï¼šè¿™æ˜¯å†³ç­–çš„æ ¸å¿ƒéƒ¨åˆ†ã€‚é¦–å…ˆï¼Œå®ƒæ ¹æ®æç¤ºä¿¡æ¯æ„å»ºäº†ä¸€ä¸ªè·¯ç”±æ¨¡æ¿ï¼Œç„¶åä½¿ç”¨è¿™ä¸ªæ¨¡æ¿åˆ›å»ºäº†ä¸€ä¸ªLLMRouterChainã€‚</li>\n<li>æ„å»ºé»˜è®¤é“¾ï¼šå¦‚æœè¾“å…¥ä¸é€‚åˆä»»ä½•å·²å®šä¹‰çš„å¤„ç†æ¨¡æ¿ï¼Œè¿™ä¸ªé»˜è®¤é“¾ä¼šè¢«è§¦å‘ã€‚</li>\n<li>æ„å»ºå¤šæç¤ºé“¾ï¼šä½¿ç”¨MultiPromptChainå°†LLMè·¯ç”±é“¾ã€ç›®æ ‡é“¾å’Œé»˜è®¤é“¾ç»„åˆåœ¨ä¸€èµ·ï¼Œå½¢æˆä¸€ä¸ªå®Œæ•´çš„å†³ç­–ç³»ç»Ÿã€‚</li>\n</ol><h2>å…·ä½“å®ç°</h2><p>ä¸‹é¢ï¼Œå°±æ˜¯ç”¨è·¯ç”±é“¾è‡ªåŠ¨é€‰æ‹©å¤„ç†æ¨¡æ¿çš„å…·ä½“ä»£ç å®ç°ã€‚</p><h3>æ„å»ºæç¤ºä¿¡æ¯çš„æ¨¡æ¿</h3><p>é¦–å…ˆï¼Œæˆ‘ä»¬é’ˆå¯¹ä¸¤ç§åœºæ™¯ï¼Œæ„å»ºä¸¤ä¸ªæç¤ºä¿¡æ¯çš„æ¨¡æ¿ã€‚</p><pre><code class=\"language-plain\"># æ„å»ºä¸¤ä¸ªåœºæ™¯çš„æ¨¡æ¿\nflower_care_template = \"\"\"ä½ æ˜¯ä¸€ä¸ªç»éªŒä¸°å¯Œçš„å›­ä¸ï¼Œæ“…é•¿è§£ç­”å…³äºå…»èŠ±è‚²èŠ±çš„é—®é¢˜ã€‚\n&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; ä¸‹é¢æ˜¯éœ€è¦ä½ æ¥å›ç­”çš„é—®é¢˜:\n&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; {input}\"\"\"\n\nflower_deco_template = \"\"\"ä½ æ˜¯ä¸€ä½ç½‘çº¢æ’èŠ±å¤§å¸ˆï¼Œæ“…é•¿è§£ç­”å…³äºé²œèŠ±è£…é¥°çš„é—®é¢˜ã€‚\n&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; ä¸‹é¢æ˜¯éœ€è¦ä½ æ¥å›ç­”çš„é—®é¢˜:\n&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; {input}\"\"\"\n\n# æ„å»ºæç¤ºä¿¡æ¯\nprompt_infos = [\n&nbsp; &nbsp; {\n&nbsp; &nbsp; &nbsp; &nbsp; \"key\": \"flower_care\",\n&nbsp; &nbsp; &nbsp; &nbsp; \"description\": \"é€‚åˆå›ç­”å…³äºé²œèŠ±æŠ¤ç†çš„é—®é¢˜\",\n&nbsp; &nbsp; &nbsp; &nbsp; \"template\": flower_care_template,\n&nbsp; &nbsp; },\n&nbsp; &nbsp; {\n&nbsp; &nbsp; &nbsp; &nbsp; \"key\": \"flower_decoration\",\n&nbsp; &nbsp; &nbsp; &nbsp; \"description\": \"é€‚åˆå›ç­”å…³äºé²œèŠ±è£…é¥°çš„é—®é¢˜\",\n&nbsp; &nbsp; &nbsp; &nbsp; \"template\": flower_deco_template,\n&nbsp; &nbsp; }]\n</code></pre><h3>åˆå§‹åŒ–è¯­è¨€æ¨¡å‹</h3><p>æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬åˆå§‹åŒ–è¯­è¨€æ¨¡å‹ã€‚</p><pre><code class=\"language-plain\"># åˆå§‹åŒ–è¯­è¨€æ¨¡å‹\nfrom langchain.llms import OpenAI\nimport os\nos.environ[\"OPENAI_API_KEY\"] = 'ä½ çš„OpenAI Key'\nllm = OpenAI()\n</code></pre><h3>æ„å»ºç›®æ ‡é“¾</h3><p>ä¸‹é¢ï¼Œæˆ‘ä»¬å¾ªç¯prompt_infosè¿™ä¸ªåˆ—è¡¨ï¼Œæ„å»ºå‡ºä¸¤ä¸ªç›®æ ‡é“¾ï¼Œåˆ†åˆ«è´Ÿè´£å¤„ç†ä¸åŒçš„é—®é¢˜ã€‚</p><pre><code class=\"language-plain\"># æ„å»ºç›®æ ‡é“¾\nfrom langchain.chains.llm import LLMChain\nfrom langchain.prompts import PromptTemplate\nchain_map = {}\nfor info in prompt_infos:\n&nbsp; &nbsp; prompt = PromptTemplate(template=info['template'], \n&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; input_variables=[\"input\"])\n    print(\"ç›®æ ‡æç¤º:\\n\",prompt)\n&nbsp; &nbsp; chain = LLMChain(llm=llm, prompt=prompt,verbose=True)\n&nbsp; &nbsp; chain_map[info[\"key\"]] = chain\n</code></pre><p>è¿™é‡Œï¼Œç›®æ ‡é“¾æç¤ºæ˜¯è¿™æ ·çš„ï¼š</p><pre><code class=\"language-plain\">ç›®æ ‡æç¤º:\ninput_variables=['input'] \noutput_parser=None partial_variables={} \ntemplate='ä½ æ˜¯ä¸€ä¸ªç»éªŒä¸°å¯Œçš„å›­ä¸ï¼Œæ“…é•¿è§£ç­”å…³äºå…»èŠ±è‚²èŠ±çš„é—®é¢˜ã€‚\\n&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; ä¸‹é¢æ˜¯éœ€è¦ä½ æ¥å›ç­”çš„é—®é¢˜:\\n&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; \n{input}' template_format='f-string' \nvalidate_template=True\n\nç›®æ ‡æç¤º:\ninput_variables=['input'] \noutput_parser=None partial_variables={} \ntemplate='ä½ æ˜¯ä¸€ä½ç½‘çº¢æ’èŠ±å¤§å¸ˆï¼Œæ“…é•¿è§£ç­”å…³äºé²œèŠ±è£…é¥°çš„é—®é¢˜ã€‚\\n&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; ä¸‹é¢æ˜¯éœ€è¦ä½ æ¥å›ç­”çš„é—®é¢˜:\\n&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; \n{input}' template_format='f-string' \nvalidate_template=True\n</code></pre><p>å¯¹äºæ¯ä¸ªåœºæ™¯ï¼Œæˆ‘ä»¬åˆ›å»ºä¸€ä¸ª LLMChainï¼ˆè¯­è¨€æ¨¡å‹é“¾ï¼‰ã€‚æ¯ä¸ªé“¾ä¼šæ ¹æ®å…¶åœºæ™¯æ¨¡æ¿ç”Ÿæˆå¯¹åº”çš„æç¤ºï¼Œç„¶åå°†è¿™ä¸ªæç¤ºé€å…¥è¯­è¨€æ¨¡å‹è·å–ç­”æ¡ˆã€‚</p><h3>æ„å»ºè·¯ç”±é“¾</h3><p>ä¸‹é¢ï¼Œæˆ‘ä»¬æ„å»ºè·¯ç”±é“¾ï¼Œè´Ÿè´£æŸ¥çœ‹ç”¨æˆ·è¾“å…¥çš„é—®é¢˜ï¼Œç¡®å®šé—®é¢˜çš„ç±»å‹ã€‚</p><pre><code class=\"language-plain\"># æ„å»ºè·¯ç”±é“¾\nfrom langchain.chains.router.llm_router import LLMRouterChain, RouterOutputParser\nfrom langchain.chains.router.multi_prompt_prompt import MULTI_PROMPT_ROUTER_TEMPLATE as RounterTemplate\ndestinations = [f\"{p['key']}: {p['description']}\" for p in prompt_infos]\nrouter_template = RounterTemplate.format(destinations=\"\\n\".join(destinations))\nprint(\"è·¯ç”±æ¨¡æ¿:\\n\",router_template)\nrouter_prompt = PromptTemplate(\n&nbsp; &nbsp; template=router_template,\n&nbsp; &nbsp; input_variables=[\"input\"],\n&nbsp; &nbsp; output_parser=RouterOutputParser(),)\nprint(\"è·¯ç”±æç¤º:\\n\",router_prompt)\nrouter_chain = LLMRouterChain.from_llm(llm, \n&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;router_prompt,\n&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;verbose=True)\n</code></pre><p>è¾“å‡ºï¼š</p><pre><code>è·¯ç”±æ¨¡æ¿:\n Given a raw text input to a language model select the model prompt best suited for the input. You will be given the names of the available prompts and a description of what the prompt is best suited for. You may also revise the original input if you think that revising it will ultimately lead to a better response from the language model.\n\n&lt;&lt; FORMATTING &gt;&gt;\nReturn a markdown code snippet with a JSON object formatted to look like:\n```json\n{{\n    &quot;destination&quot;: string \\ name of the prompt to use or &quot;DEFAULT&quot;\n    &quot;next_inputs&quot;: string \\ a potentially modified version of the original input\n}}\n```\n\nREMEMBER: &quot;destination&quot; MUST be one of the candidate prompt names specified below OR it can be &quot;DEFAULT&quot; if the input is not well suited for any of the candidate prompts.\nREMEMBER: &quot;next_inputs&quot; can just be the original input if you don't think any modifications are needed.\n\n&lt;&lt; CANDIDATE PROMPTS &gt;&gt;\nflower_care: é€‚åˆå›ç­”å…³äºé²œèŠ±æŠ¤ç†çš„é—®é¢˜\nflower_decoration: é€‚åˆå›ç­”å…³äºé²œèŠ±è£…é¥°çš„é—®é¢˜\n\n&lt;&lt; INPUT &gt;&gt;\n{input}\n\n&lt;&lt; OUTPUT &gt;&gt;\n\nè·¯ç”±æç¤º:\ninput_variables=['input'] output_parser=RouterOutputParser(default_destination='DEFAULT', next_inputs_type=&lt;class 'str'&gt;, next_inputs_inner_key='input') \npartial_variables={} \ntemplate='Given a raw text input to a language model select the model prompt best suited for the input. You will be given the names of the available prompts and a description of what the prompt is best suited for. You may also revise the original input if you think that revising it will ultimately lead to a better response from the language model.\\n\\n\n&lt;&lt; FORMATTING &gt;&gt;\\n\nReturn a markdown code snippet with a JSON object formatted to look like:\\n```json\\n{{\\n &quot;destination&quot;: string \\\\ name of the prompt to use or &quot;DEFAULT&quot;\\n    &quot;next_inputs&quot;: string \\\\ a potentially modified version of the original input\\n}}\\n```\\n\\n\nREMEMBER: &quot;destination&quot; MUST be one of the candidate prompt names specified below OR it can be &quot;DEFAULT&quot; if the input is not well suited for any of the candidate prompts.\\n\nREMEMBER: &quot;next_inputs&quot; can just be the original input if you don\\'t think any modifications are needed.\\n\\n&lt;&lt; CANDIDATE PROMPTS &gt;&gt;\\n\nflower_care: é€‚åˆå›ç­”å…³äºé²œèŠ±æŠ¤ç†çš„é—®é¢˜\\n\nflower_decoration: é€‚åˆå›ç­”å…³äºé²œèŠ±è£…é¥°çš„é—®é¢˜\\n\\n\n&lt;&lt; INPUT &gt;&gt;\\n{input}\\n\\n&lt;&lt; OUTPUT &gt;&gt;\\n' \ntemplate_format='f-string' \nvalidate_template=True\n</code></pre><p>è¿™é‡Œæˆ‘è¯´ä¸€ä¸‹è·¯ç”±å™¨é“¾æ˜¯å¦‚ä½•æ„é€ æç¤ºä¿¡æ¯ï¼Œæ¥å¼•å¯¼å¤§æ¨¡å‹æŸ¥çœ‹ç”¨æˆ·è¾“å…¥çš„é—®é¢˜å¹¶ç¡®å®šé—®é¢˜çš„ç±»å‹çš„ã€‚</p><p>å…ˆçœ‹è·¯ç”±æ¨¡æ¿éƒ¨åˆ†ï¼Œè¿™æ®µæ¨¡æ¿å­—ç¬¦ä¸²æ˜¯ä¸€ä¸ªæŒ‡å¯¼æ€§çš„è¯´æ˜ï¼Œç›®çš„æ˜¯å¼•å¯¼è¯­è¨€æ¨¡å‹æ­£ç¡®å¤„ç†ç”¨æˆ·çš„è¾“å…¥ï¼Œå¹¶å°†å…¶å®šå‘åˆ°é€‚å½“çš„æ¨¡å‹æç¤ºã€‚</p><p><strong>1. è·¯ç”±æ¨¡æ¿çš„è§£é‡Š</strong></p><p>è·¯ç”±æ¨¡æ¿æ˜¯è·¯ç”±åŠŸèƒ½å¾—ä»¥å®ç°çš„æ ¸å¿ƒã€‚æˆ‘ä»¬æ¥è¯¦ç»†åˆ†è§£ä¸€ä¸‹è¿™ä¸ªæ¨¡æ¿çš„æ¯ä¸ªéƒ¨åˆ†ã€‚</p><p><strong>å¼•è¨€</strong></p><blockquote>\n<p>Given a raw text input to a language model select the model prompt best suited for the input.</p>\n</blockquote><p>è¿™æ˜¯ä¸€ä¸ªç®€å•çš„å¼•å¯¼è¯­å¥ï¼Œå‘Šè¯‰æ¨¡å‹ä½ å°†ç»™å®ƒä¸€ä¸ªè¾“å…¥ï¼Œå®ƒéœ€è¦æ ¹æ®è¿™ä¸ªè¾“å…¥é€‰æ‹©æœ€é€‚åˆçš„æ¨¡å‹æç¤ºã€‚</p><blockquote>\n<p>You will be given the names of the available prompts and a description of what the prompt is best suited for.</p>\n</blockquote><p>è¿™é‡Œè¿›ä¸€æ­¥æé†’æ¨¡å‹ï¼Œå®ƒå°†è·å¾—å„ç§æ¨¡å‹æç¤ºçš„åç§°å’Œæè¿°ã€‚</p><blockquote>\n<p>You may also revise the original input if you think that revising it will ultimately lead to a better response from the language model.</p>\n</blockquote><p>è¿™æ˜¯ä¸€ä¸ªå¯é€‰çš„æ­¥éª¤ï¼Œå‘Šè¯‰æ¨¡å‹å®ƒå¯ä»¥æ›´æ”¹åŸå§‹è¾“å…¥ä»¥è·å¾—æ›´å¥½çš„å“åº”ã€‚</p><p><strong>æ ¼å¼è¯´æ˜(&lt;&lt; FORMATTING &gt;&gt;)</strong></p><p>æŒ‡å¯¼æ¨¡å‹å¦‚ä½•æ ¼å¼åŒ–å…¶è¾“å‡ºï¼Œä½¿å…¶ä»¥ç‰¹å®šçš„æ–¹å¼è¿”å›ç»“æœã€‚</p><blockquote>\n<p>Return a markdown code snippet with a JSON object formatted to look like:</p>\n</blockquote><p>è¡¨ç¤ºæ¨¡å‹çš„è¾“å‡ºåº”è¯¥æ˜¯ä¸€ä¸ª Markdown ä»£ç ç‰‡æ®µï¼Œå…¶ä¸­åŒ…å«ä¸€ä¸ªç‰¹å®šæ ¼å¼çš„ JSON å¯¹è±¡ã€‚</p><p>ä¸‹é¢çš„ä»£ç å—æ˜¾ç¤ºäº†æœŸæœ›çš„ JSON ç»“æ„ï¼Œå…¶ä¸­ destination æ˜¯æ¨¡å‹é€‰æ‹©çš„æç¤ºåç§°ï¼ˆæˆ–â€œDEFAULTâ€ï¼‰ï¼Œè€Œ next_inputs æ˜¯å¯èƒ½è¢«ä¿®è®¢çš„åŸå§‹è¾“å…¥ã€‚</p><p><strong>é¢å¤–çš„è¯´æ˜å’Œè¦æ±‚</strong></p><blockquote>\n<p>REMEMBER: â€œdestinationâ€ MUST be one of the candidate prompt names specified below OR it can be â€œDEFAULTâ€â€¦</p>\n</blockquote><p>è¿™æ˜¯ä¸€ä¸ªé‡è¦çš„æŒ‡å¯¼ï¼Œæé†’æ¨¡å‹ â€œdestinationâ€ å­—æ®µçš„å€¼å¿…é¡»æ˜¯ä¸‹é¢åˆ—å‡ºçš„æç¤ºä¹‹ä¸€æˆ–æ˜¯ â€œDEFAULTâ€ã€‚</p><blockquote>\n<p>REMEMBER: â€œnext_inputsâ€ can just be the original input if you donâ€™t think any modifications are needed.</p>\n</blockquote><p>è¿™å†æ¬¡å¼ºè°ƒï¼Œé™¤éæ¨¡å‹è®¤ä¸ºæœ‰å¿…è¦ï¼Œå¦åˆ™åŸå§‹è¾“å…¥ä¸éœ€è¦ä¿®æ”¹ã€‚</p><p><strong>å€™é€‰æç¤º(&lt;&lt; CANDIDATE PROMPTS &gt;&gt;)</strong></p><p>åˆ—å‡ºäº†ä¸¤ä¸ªç¤ºä¾‹æ¨¡å‹æç¤ºåŠå…¶æè¿°ï¼š</p><ul>\n<li>â€œflower_care: é€‚åˆå›ç­”å…³äºé²œèŠ±æŠ¤ç†çš„é—®é¢˜â€ï¼Œé€‚åˆå¤„ç†ä¸èŠ±å‰æŠ¤ç†ç›¸å…³çš„é—®é¢˜ã€‚</li>\n<li>â€œflower_decoration: é€‚åˆå›ç­”å…³äºé²œèŠ±è£…é¥°çš„é—®é¢˜â€ï¼Œé€‚åˆå¤„ç†ä¸èŠ±å‰è£…é¥°ç›¸å…³çš„é—®é¢˜ã€‚</li>\n</ul><p><strong>è¾“å…¥/è¾“å‡ºéƒ¨åˆ†</strong></p><blockquote>\n<p>&lt;&lt; INPUT &gt;&gt;\\n{input}\\n\\n&lt;&lt; OUTPUT &gt;&gt;\\nï¼š</p>\n</blockquote><p>è¿™éƒ¨åˆ†ä¸ºæ¨¡å‹æä¾›äº†ä¸€ä¸ªæ ¼å¼åŒ–çš„æ¡†æ¶ï¼Œå…¶ä¸­å®ƒå°†æ¥æ”¶ä¸€ä¸ªåä¸º {input} çš„è¾“å…¥ï¼Œå¹¶åœ¨æ­¤åçš„éƒ¨åˆ†è¾“å‡ºç»“æœã€‚</p><p>æ€»çš„æ¥è¯´ï¼Œè¿™ä¸ªæ¨¡æ¿çš„ç›®çš„æ˜¯è®©æ¨¡å‹çŸ¥é“å¦‚ä½•å¤„ç†ç”¨æˆ·çš„è¾“å…¥ï¼Œå¹¶æ ¹æ®æä¾›çš„æç¤ºåˆ—è¡¨é€‰æ‹©ä¸€ä¸ªæœ€ä½³çš„æ¨¡å‹æç¤ºæ¥å›åº”ã€‚</p><p><strong>2. è·¯ç”±æç¤ºçš„è§£é‡Š</strong></p><p>è·¯ç”±æç¤º (router_promptï¼‰åˆ™æ ¹æ®è·¯ç”±æ¨¡æ¿ï¼Œç”Ÿæˆäº†å…·ä½“ä¼ é€’ç»™LLMçš„è·¯ç”±æç¤ºä¿¡æ¯ã€‚</p><ul>\n<li>å…¶ä¸­input_variables æŒ‡å®šæ¨¡æ¿æ¥æ”¶çš„è¾“å…¥å˜é‡åï¼Œè¿™é‡Œåªæœ‰ <code>\"input\"</code>ã€‚</li>\n<li>output_parser æ˜¯ä¸€ä¸ªç”¨äºè§£ææ¨¡å‹è¾“å‡ºçš„å¯¹è±¡ï¼Œå®ƒæœ‰ä¸€ä¸ªé»˜è®¤çš„ç›®çš„åœ°å’Œä¸€ä¸ªæŒ‡å‘ä¸‹ä¸€è¾“å…¥çš„é”®ã€‚</li>\n<li>template æ˜¯å®é™…çš„è·¯ç”±æ¨¡æ¿ï¼Œç”¨äºç»™æ¨¡å‹æä¾›æŒ‡ç¤ºã€‚è¿™å°±æ˜¯åˆšæ‰è¯¦ç»†è§£é‡Šçš„æ¨¡æ¿å†…å®¹ã€‚</li>\n<li>template_format æŒ‡å®šæ¨¡æ¿çš„æ ¼å¼ï¼Œè¿™é‡Œæ˜¯ <code>\"f-string\"</code>ã€‚</li>\n<li>validate_template æ˜¯ä¸€ä¸ªå¸ƒå°”å€¼ï¼Œå¦‚æœä¸º Trueï¼Œåˆ™ä¼šåœ¨ä½¿ç”¨æ¨¡æ¿å‰éªŒè¯å…¶æœ‰æ•ˆæ€§ã€‚</li>\n</ul><p>ç®€è€Œè¨€ä¹‹ï¼Œè¿™ä¸ªæ„é€ å…è®¸ä½ å°†ç”¨æˆ·çš„åŸå§‹è¾“å…¥é€å…¥è·¯ç”±å™¨ï¼Œç„¶åè·¯ç”±å™¨ä¼šå†³å®šå°†è¯¥è¾“å…¥å‘é€åˆ°å“ªä¸ªå…·ä½“çš„æ¨¡å‹æç¤ºï¼Œæˆ–è€…æ˜¯å¦éœ€è¦å¯¹è¾“å…¥è¿›è¡Œä¿®è®¢ä»¥è·å¾—æœ€ä½³çš„å“åº”ã€‚</p><h3>æ„å»ºé»˜è®¤é“¾</h3><p>é™¤äº†å¤„ç†ç›®æ ‡é“¾å’Œè·¯ç”±é“¾ä¹‹å¤–ï¼Œæˆ‘ä»¬è¿˜éœ€è¦å‡†å¤‡ä¸€ä¸ªé»˜è®¤é“¾ã€‚å¦‚æœè·¯ç”±é“¾æ²¡æœ‰æ‰¾åˆ°é€‚åˆçš„é“¾ï¼Œé‚£ä¹ˆï¼Œå°±ä»¥é»˜è®¤é“¾è¿›è¡Œå¤„ç†ã€‚</p><pre><code class=\"language-plain\"># æ„å»ºé»˜è®¤é“¾\nfrom langchain.chains import ConversationChain\ndefault_chain = ConversationChain(llm=llm, \n&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; output_key=\"text\",\n&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; verbose=True)\n</code></pre><h3>æ„å»ºå¤šæç¤ºé“¾</h3><p>æœ€åï¼Œæˆ‘ä»¬ä½¿ç”¨MultiPromptChainç±»æŠŠå‰å‡ ä¸ªé“¾æ•´åˆåœ¨ä¸€èµ·ï¼Œå®ç°è·¯ç”±åŠŸèƒ½ã€‚è¿™ä¸ªMultiPromptChainç±»æ˜¯ä¸€ä¸ªå¤šè·¯é€‰æ‹©é“¾ï¼Œå®ƒä½¿ç”¨ä¸€ä¸ªLLMè·¯ç”±å™¨é“¾åœ¨å¤šä¸ªæç¤ºä¹‹é—´è¿›è¡Œé€‰æ‹©ã€‚</p><p><strong>MultiPromptChainä¸­æœ‰ä¸‰ä¸ªå…³é”®å…ƒç´ ã€‚</strong></p><ul>\n<li>router_chainï¼ˆç±»å‹RouterChainï¼‰ï¼šè¿™æ˜¯ç”¨äºå†³å®šç›®æ ‡é“¾å’Œå…¶è¾“å…¥çš„é“¾ã€‚å½“ç»™å®šæŸä¸ªè¾“å…¥æ—¶ï¼Œè¿™ä¸ªrouter_chainå†³å®šå“ªä¸€ä¸ªdestination_chainåº”è¯¥è¢«é€‰ä¸­ï¼Œä»¥åŠä¼ ç»™å®ƒçš„å…·ä½“è¾“å…¥æ˜¯ä»€ä¹ˆã€‚</li>\n<li>destination_chainsï¼ˆç±»å‹Mapping[str, LLMChain]ï¼‰ï¼šè¿™æ˜¯ä¸€ä¸ªæ˜ å°„ï¼Œå°†åç§°æ˜ å°„åˆ°å¯ä»¥å°†è¾“å…¥è·¯ç”±åˆ°çš„å€™é€‰é“¾ã€‚ä¾‹å¦‚ï¼Œä½ å¯èƒ½æœ‰å¤šç§å¤„ç†æ–‡æœ¬è¾“å…¥çš„æ–¹æ³•ï¼ˆæˆ–â€œé“¾â€ï¼‰ï¼Œæ¯ç§æ–¹æ³•é’ˆå¯¹ç‰¹å®šç±»å‹çš„é—®é¢˜ã€‚destination_chainså¯ä»¥æ˜¯è¿™æ ·ä¸€ä¸ªå­—å…¸ï¼š<code>{'weather': weather_chain, 'news': news_chain}</code>ã€‚åœ¨è¿™é‡Œï¼Œweather_chainå¯èƒ½ä¸“é—¨å¤„ç†ä¸å¤©æ°”ç›¸å…³çš„é—®é¢˜ï¼Œè€Œnews_chainå¤„ç†ä¸æ–°é—»ç›¸å…³çš„é—®é¢˜ã€‚</li>\n<li>default_chainï¼ˆç±»å‹LLMChainï¼‰ï¼šå½“ router_chain æ— æ³•å°†è¾“å…¥æ˜ å°„åˆ°destination_chainsä¸­çš„ä»»ä½•ä¸€ä¸ªé“¾æ—¶ï¼ŒLLMChain å°†ä½¿ç”¨æ­¤é»˜è®¤é“¾ã€‚è¿™æ˜¯ä¸€ä¸ªå¤‡é€‰æ–¹æ¡ˆï¼Œç¡®ä¿å³ä½¿è·¯ç”±å™¨ä¸èƒ½å†³å®šæ­£ç¡®çš„é“¾ï¼Œä¹Ÿæ€»æœ‰ä¸€ä¸ªé“¾å¯ä»¥å¤„ç†è¾“å…¥ã€‚</li>\n</ul><p><strong>å®ƒçš„å·¥ä½œæµç¨‹å¦‚ä¸‹ï¼š</strong></p><ol>\n<li>è¾“å…¥é¦–å…ˆä¼ é€’ç»™router_chainã€‚</li>\n<li>router_chainæ ¹æ®æŸäº›æ ‡å‡†æˆ–é€»è¾‘å†³å®šåº”è¯¥ä½¿ç”¨å“ªä¸€ä¸ªdestination_chainã€‚</li>\n<li>è¾“å…¥éšåè¢«è·¯ç”±åˆ°é€‰å®šçš„destination_chainï¼Œè¯¥é“¾è¿›è¡Œå¤„ç†å¹¶è¿”å›ç»“æœã€‚</li>\n<li>å¦‚æœrouter_chainä¸èƒ½å†³å®šæ­£ç¡®çš„destination_chainï¼Œåˆ™è¾“å…¥ä¼šè¢«ä¼ é€’ç»™default_chainã€‚</li>\n</ol><p>è¿™æ ·ï¼ŒMultiPromptChainå°±ä¸ºæˆ‘ä»¬æä¾›äº†ä¸€ä¸ªåœ¨å¤šä¸ªå¤„ç†é“¾ä¹‹é—´åŠ¨æ€è·¯ç”±è¾“å…¥çš„æœºåˆ¶ï¼Œä»¥å¾—åˆ°æœ€ç›¸å…³æˆ–æœ€ä¼˜çš„è¾“å‡ºã€‚</p><p>å®ç°ä»£ç å¦‚ä¸‹ï¼š</p><pre><code class=\"language-plain\"># æ„å»ºå¤šæç¤ºé“¾\nfrom langchain.chains.router import MultiPromptChain\nchain = MultiPromptChain(\n&nbsp; &nbsp; router_chain=router_chain,\n&nbsp; &nbsp; destination_chains=chain_map,\n&nbsp; &nbsp; default_chain=default_chain,\n&nbsp; &nbsp; verbose=True)\n</code></pre><h2>è¿è¡Œè·¯ç”±é“¾</h2><p>å¥½äº†ï¼Œè‡³æ­¤æˆ‘ä»¬çš„é“¾è·¯å·²ç»å‡†å¤‡å¥½äº†ã€‚ç°åœ¨å¼€å§‹æå‡ºå„ç§é—®é¢˜ï¼Œæµ‹è¯•ä¸€ä¸‹æˆ‘ä»¬çš„é“¾ã€‚</p><p><strong>æµ‹è¯•Aï¼š</strong></p><p>print(chain.run(â€œå¦‚ä½•ä¸ºç«ç‘°æµ‡æ°´ï¼Ÿâ€))</p><p>è¾“å‡ºï¼š</p><p><img src=\"https://static001.geekbang.org/resource/image/89/a2/89d0bfac97b259b93240a10cf777d9a2.png?wh=1097x821\" alt=\"\"></p><p><strong>æµ‹è¯•Bï¼š</strong></p><p>print(chain.run(â€œå¦‚ä½•ä¸ºå©šç¤¼åœºåœ°è£…é¥°èŠ±æœµï¼Ÿâ€))</p><p>è¾“å‡ºï¼š</p><p><img src=\"https://static001.geekbang.org/resource/image/4f/ed/4f848ca6592476358a25bf91996aa0ed.png?wh=1095x834\" alt=\"\"></p><p><strong>æµ‹è¯•Cï¼š</strong></p><p>print(chain.run(â€œå¦‚ä½•è€ƒå…¥å“ˆä½›å¤§å­¦ï¼Ÿâ€))</p><p>è¾“å‡ºï¼š</p><p><img src=\"https://static001.geekbang.org/resource/image/ac/12/acd4a69df2cef81b1f7bcf33f9b4bb12.png?wh=1093x806\" alt=\"\"></p><p>è¿™ä¸‰ä¸ªæµ‹è¯•ï¼Œåˆ†åˆ«è¢«è·¯ç”±åˆ°äº†ä¸‰ä¸ªä¸åŒçš„ç›®æ ‡é“¾ï¼Œå…¶ä¸­ä¸¤ä¸ªæ˜¯æˆ‘ä»¬é¢„è®¾çš„â€œä¸“å®¶ç±»å‹â€ç›®æ ‡é“¾ï¼Œè€Œç¬¬ä¸‰ä¸ªé—®é¢˜ï¼šå¦‚ä½•è€ƒå…¥å“ˆä½›å¤§å­¦ï¼Ÿè¢«æ¨¡å‹ä¸€çœ¼çœ‹ç©¿ï¼Œå¹¶ä¸å±äºä»»ä½•é²œèŠ±è¿è¥ä¸šåŠ¡åœºæ™¯ï¼Œè·¯ç”±é“¾æŠŠå®ƒæŠ›å…¥äº†ä¸€ä¸ª â€œdefault chainâ€ â€”â€” ConversationChain å»è§£å†³ã€‚</p><h2>æ€»ç»“æ—¶åˆ»</h2><p>åœ¨è¿™ä¸ªç¤ºä¾‹ä¸­ï¼Œæˆ‘ä»¬çœ‹åˆ°äº†LLMRouterChainä»¥åŠMultiPromptChainã€‚å…¶ä¸­ï¼ŒLLMRouterChainç»§æ‰¿è‡ªRouterChainï¼›è€ŒMultiPromptChainåˆ™ç»§æ‰¿è‡ªMultiRouteChainã€‚</p><p>æ•´ä½“ä¸Šï¼Œæˆ‘ä»¬é€šè¿‡MultiPromptChainæŠŠå…¶ä»–é“¾ç»„ç»‡èµ·æ¥ï¼Œå®Œæˆäº†è·¯ç”±åŠŸèƒ½ã€‚</p><pre><code class=\"language-plain\">chain = MultiPromptChain(\n&nbsp; &nbsp; router_chain=router_chain,\n&nbsp; &nbsp; destination_chains=chain_map,\n&nbsp; &nbsp; default_chain=default_chain,\n&nbsp; &nbsp; verbose=True)\n</code></pre><p>åœ¨LangChainçš„ chains -&gt; router -&gt; base.py æ–‡ä»¶ä¸­ï¼Œå¯ä»¥çœ‹åˆ°RouterChainå’ŒMultiRouteChainçš„ä»£ç å®ç°ã€‚</p><h2>æ€è€ƒé¢˜</h2><ol>\n<li>é€šè¿‡verbose=Trueè¿™ä¸ªé€‰é¡¹çš„è®¾å®šï¼Œåœ¨è¾“å‡ºæ—¶æ˜¾ç¤ºäº†é“¾çš„å¼€å§‹å’Œç»“æŸæ—¥å¿—ï¼Œä»è€Œå¾—åˆ°å…¶ç›¸äº’è°ƒç”¨æµç¨‹ã€‚è¯·ä½ å°è¯•æŠŠè¯¥é€‰é¡¹è®¾ç½®ä¸ºFalseï¼Œçœ‹ä¸€çœ‹è¾“å‡ºç»“æœæœ‰ä½•ä¸åŒã€‚</li>\n<li>åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œæˆ‘ä»¬ä½¿ç”¨äº†ConversationChainä½œä¸ºdefault_chainï¼Œè¿™ä¸ªChainæ˜¯LLMChainçš„å­ç±»ï¼Œä½ èƒ½å¦æŠŠè¿™ä¸ªChainæ›¿æ¢ä¸ºLLMChainï¼Ÿ</li>\n</ol><p>æœŸå¾…åœ¨ç•™è¨€åŒºçœ‹åˆ°ä½ çš„åˆ†äº«ã€‚å¦‚æœä½ è§‰å¾—å†…å®¹å¯¹ä½ æœ‰å¸®åŠ©ï¼Œä¹Ÿæ¬¢è¿åˆ†äº«ç»™æœ‰éœ€è¦çš„æœ‹å‹ï¼æœ€åå¦‚æœä½ å­¦æœ‰ä½™åŠ›ï¼Œå¯ä»¥è¿›ä¸€æ­¥å­¦ä¹ ä¸‹é¢çš„å»¶ä¼¸é˜…è¯»ã€‚</p><h2>å»¶ä¼¸é˜…è¯»</h2><ol>\n<li>ä»£ç ï¼ŒRouterChainå’ŒMultiRouteChainçš„<a href=\"https://github.com/langchain-ai/langchain/blob/master/libs/langchain/langchain/chains/router/base.py\">å®ç°ç»†èŠ‚</a></li>\n<li>ä»£ç ï¼ŒMultiPromptChainçš„<a href=\"https://github.com/langchain-ai/langchain/blob/master/libs/langchain/langchain/chains/router/multi_prompt.py\">å®ç°ç»†èŠ‚</a></li>\n</ol>","comments":[{"had_liked":false,"id":381547,"user_name":"åœ¨è·¯ä¸Š","can_delete":false,"product_type":"c1","uid":1402511,"ip_address":"å¹¿ä¸œ","ucode":"6E31908EFE1107","user_header":"https://static001.geekbang.org/account/avatar/00/15/66/8f/02be926d.jpg","comment_is_top":false,"comment_ctime":1695372277,"is_pvip":false,"replies":[{"id":139074,"content":"å¾ˆç²¾è¾Ÿ","user_name":"ä½œè€…å›å¤","user_name_real":"ç¼–è¾‘","uid":1809833,"ctime":1695872204,"ip_address":"æ–°åŠ å¡","comment_id":381547,"utype":1}],"discussion_count":1,"race_medal":0,"score":2,"product_id":100617601,"comment_content":"ConversationChainå’ŒLLMChainçš„åŒºåˆ«åœ¨äºï¼ŒConversationChainæœ‰memoryæˆå‘˜å˜é‡ï¼Œèƒ½ä¿ç•™å¯¹è¯ä¸Šä¸‹æ–‡ï¼Œè€ŒLLMChainä¸è¡Œã€‚åœ¨æºç ä¸Šï¼Œè·Ÿè¸ªConversationBufferMemory.load_memory_variables()å¯çŸ¥ï¼Œå¯¹è¯ä¸Šä¸‹æ–‡ä¼šä½œä¸ºinputsçš„ä¸€éƒ¨åˆ†ä¼ å…¥PromptTemplateï¼Œæˆä¸ºllmçš„æç¤ºè¯ã€‚","like_count":19,"discussions":[{"author":{"id":1809833,"avatar":"https://static001.geekbang.org/account/avatar/00/1b/9d/a9/4602808f.jpg","nickname":"é»„ä½³","note":"","ucode":"8EC41D2EAB0E3C","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":628806,"discussion_content":"å¾ˆç²¾è¾Ÿ","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1695872204,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"æ–°åŠ å¡","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":381663,"user_name":"é˜¶å‰æ¢§å¶","can_delete":false,"product_type":"c1","uid":1399555,"ip_address":"æ±Ÿè‹","ucode":"85AADEA5908028","user_header":"https://static001.geekbang.org/account/avatar/00/15/5b/03/660c8a3c.jpg","comment_is_top":false,"comment_ctime":1695625667,"is_pvip":false,"replies":[{"id":139078,"content":"åŒå­¦æå‡ºäº†ä¸€ä¸ªå¥½é—®é¢˜ã€‚å¾ˆå¯å‘æ€è€ƒã€‚\nä¸€ä¸ªè·¯ç”±é“¾ï¼Œå®ƒæ ¹æ®LLMçš„è¾“å‡ºå†³å®šä¸‹ä¸€æ­¥åº”è¯¥å»å“ªä¸ªé“¾ã€‚å¯ä»¥çœ‹ä¸€ä¸‹è·¯ç”±é“¾çš„å†…éƒ¨ä»£ç ï¼Œå½“LLMè¿”å›ä¸€ä¸ªç»“æœæ—¶ï¼Œå®ƒé€šè¿‡ RouterOutputParser è¿›è¡Œè§£æã€‚æ­¤è§£æå™¨è¿”å›ä¸€ä¸ªå­—å…¸ï¼Œå…¶ä¸­åŒ…å«ä¸¤ä¸ªå…³é”®éƒ¨åˆ†ï¼šdestination å’Œ next_inputsã€‚å…¶ä¸­ï¼Œdestination æ ‡è¯†äº†ä¸‹ä¸€æ­¥åº”è¯¥è·¯ç”±åˆ°å“ªä¸ªé“¾ã€‚\né‚£ä¹ˆï¼Œæˆ‘ä»¬æ˜¯å¯ä»¥ä»destinationçŸ¥é“æ˜¯é‚£ä¸ªChainè§£å†³çš„é—®é¢˜çš„å“ˆã€‚é‚£ä¹ˆå¦‚æœä½ æƒ³è¦è¿™ä¸ªå…·ä½“çš„Chainè¿”å›å…·ä½“çš„æ•°æ®æ ¼å¼ï¼Œä¹Ÿæ˜¯å¯ä»¥åœ¨ç»™åˆ°è¿™ä¸ªå…·ä½“Chainçš„æç¤ºä¸­æŒ‡å®šçš„å“ˆã€‚åº”è¯¥éƒ½åšçš„åˆ°ã€‚åŒå­¦å¯ä»¥è‡ªå·±ç¼–å†™ä»£ç è¯•è¯•ã€‚","user_name":"ä½œè€…å›å¤","user_name_real":"ç¼–è¾‘","uid":1809833,"ctime":1695876860,"ip_address":"æ–°åŠ å¡","comment_id":381663,"utype":1}],"discussion_count":1,"race_medal":0,"score":2,"product_id":100617601,"comment_content":"åœ¨è¿™ç§è·¯ç”±é“¾ä¸­ï¼Œè¿”å›çš„æ•°æ®ä¹Ÿæƒ³åšç»“æ„åŒ–jsonè§£æï¼Œé‚£æœ€ç»ˆllmè¿”å›çš„ç»“æœï¼Œå¦‚ä½•å»ç¡®å®šæ˜¯å“ªä¸ªchainè¿”å›çš„ï¼Ÿç»§è€Œé€‰æ‹©å¯¹åº”çš„parserå¤„ç†","like_count":5,"discussions":[{"author":{"id":1809833,"avatar":"https://static001.geekbang.org/account/avatar/00/1b/9d/a9/4602808f.jpg","nickname":"é»„ä½³","note":"","ucode":"8EC41D2EAB0E3C","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":628813,"discussion_content":"åŒå­¦æå‡ºäº†ä¸€ä¸ªå¥½é—®é¢˜ã€‚å¾ˆå¯å‘æ€è€ƒã€‚\nä¸€ä¸ªè·¯ç”±é“¾ï¼Œå®ƒæ ¹æ®LLMçš„è¾“å‡ºå†³å®šä¸‹ä¸€æ­¥åº”è¯¥å»å“ªä¸ªé“¾ã€‚å¯ä»¥çœ‹ä¸€ä¸‹è·¯ç”±é“¾çš„å†…éƒ¨ä»£ç ï¼Œå½“LLMè¿”å›ä¸€ä¸ªç»“æœæ—¶ï¼Œå®ƒé€šè¿‡ RouterOutputParser è¿›è¡Œè§£æã€‚æ­¤è§£æå™¨è¿”å›ä¸€ä¸ªå­—å…¸ï¼Œå…¶ä¸­åŒ…å«ä¸¤ä¸ªå…³é”®éƒ¨åˆ†ï¼šdestination å’Œ next_inputsã€‚å…¶ä¸­ï¼Œdestination æ ‡è¯†äº†ä¸‹ä¸€æ­¥åº”è¯¥è·¯ç”±åˆ°å“ªä¸ªé“¾ã€‚\né‚£ä¹ˆï¼Œæˆ‘ä»¬æ˜¯å¯ä»¥ä»destinationçŸ¥é“æ˜¯é‚£ä¸ªChainè§£å†³çš„é—®é¢˜çš„å“ˆã€‚é‚£ä¹ˆå¦‚æœä½ æƒ³è¦è¿™ä¸ªå…·ä½“çš„Chainè¿”å›å…·ä½“çš„æ•°æ®æ ¼å¼ï¼Œä¹Ÿæ˜¯å¯ä»¥åœ¨ç»™åˆ°è¿™ä¸ªå…·ä½“Chainçš„æç¤ºä¸­æŒ‡å®šçš„å“ˆã€‚åº”è¯¥éƒ½åšçš„åˆ°ã€‚åŒå­¦å¯ä»¥è‡ªå·±ç¼–å†™ä»£ç è¯•è¯•ã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1695876860,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"æ–°åŠ å¡","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":383095,"user_name":"é²¸é±¼","can_delete":false,"product_type":"c1","uid":1052643,"ip_address":"åŒ—äº¬","ucode":"71437C1C601040","user_header":"https://static001.geekbang.org/account/avatar/00/10/0f/e3/c49aa508.jpg","comment_is_top":false,"comment_ctime":1698400642,"is_pvip":false,"replies":[{"id":139554,"content":"éå¸¸æ£’çš„åˆ†äº«ï¼Œè°¢è°¢åŒå­¦ï¼ï¼ğŸ¤¡","user_name":"ä½œè€…å›å¤","user_name_real":"ç¼–è¾‘","uid":1809833,"ctime":1698480901,"ip_address":"ç‘å£«","comment_id":383095,"utype":1}],"discussion_count":1,"race_medal":0,"score":2,"product_id":100617601,"comment_content":"æˆ‘å‘ç°ä½¿ç”¨MultiPromptChain.from_promptsæ–¹æ³•ä¼šæ›´ç®€æ´ï¼Œå…¶å†…éƒ¨å®ç°å°±æ˜¯è€å¸ˆä¸Šé¢åˆ—å‡ºçš„å†…å®¹ç±»ä¼¼\nflower_care_template = &quot;&quot;&quot;\nä½ æ˜¯ä¸€ä¸ªç»éªŒä¸°å¯Œçš„å›­ä¸ï¼Œæ“…é•¿è§£ç­”å…³äºå…»èŠ±è‚²èŠ±çš„é—®é¢˜ã€‚\nä¸‹é¢æ˜¯éœ€è¦ä½ æ¥å›ç­”çš„é—®é¢˜:\n{input}&quot;&quot;&quot;\nflower_deco_template = &quot;&quot;&quot;\nä½ æ˜¯ä¸€ä½ç½‘çº¢æ’èŠ±å¤§å¸ˆï¼Œæ“…é•¿è§£ç­”å…³äºé²œèŠ±è£…é¥°çš„é—®é¢˜ã€‚\nä¸‹é¢æ˜¯éœ€è¦ä½ æ¥å›ç­”çš„é—®é¢˜:\n{input}&quot;&quot;&quot;\nprompt_infos = [\n    {\n        &#39;name&#39;: &#39;flower_care&#39;,\n        &#39;description&#39;: &#39;é€‚åˆå›ç­”å…³äºé²œèŠ±æŠ¤ç†çš„é—®é¢˜&#39;,\n        &#39;prompt_template&#39;: flower_care_template,\n    },\n    {\n        &#39;name&#39;: &#39;flower_decoration&#39;,\n        &#39;description&#39;: &#39;é€‚åˆå›ç­”å…³äºé²œèŠ±è£…é¥°çš„é—®é¢˜&#39;,\n        &#39;prompt_template&#39;: flower_care_template,\n    },\n]\n\nllm = OpenAI()\nchain = MultiPromptChain.from_prompts(llm=llm, prompt_infos=prompt_infos, verbose=True)\nprint(chain.run(&quot;å¦‚ä½•ä¸ºç«ç‘°æµ‡æ°´ï¼Ÿ&quot;))","like_count":4,"discussions":[{"author":{"id":1809833,"avatar":"https://static001.geekbang.org/account/avatar/00/1b/9d/a9/4602808f.jpg","nickname":"é»„ä½³","note":"","ucode":"8EC41D2EAB0E3C","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":630458,"discussion_content":"éå¸¸æ£’çš„åˆ†äº«ï¼Œè°¢è°¢åŒå­¦ï¼ï¼ğŸ¤¡","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1698480901,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"ç‘å£«","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":381507,"user_name":"é»„æŒ¯å®‡","can_delete":false,"product_type":"c1","uid":1686397,"ip_address":"åŒ—äº¬","ucode":"976BC7B46DA419","user_header":"https://static001.geekbang.org/account/avatar/00/19/bb/7d/26340713.jpg","comment_is_top":false,"comment_ctime":1695302155,"is_pvip":false,"replies":[{"id":138977,"content":"å¯¹ï¼Œrouter_chainæ˜¯ä¸€ä¸ªç®€å•agentäº†ã€‚è¿™æ˜¯å› ä¸ºå®ƒçš„Routerè·¯å¾„æ˜¯LLMæ¨å‡ºæ¥çš„ï¼Œä¸æ˜¯äººä¸ºæŒ‡å®šçš„ã€‚Agentä¹Ÿå°±æ˜¯è®©LLMæ¨å‡ºæ¥è°ƒç”¨å“ªä¸ªToolï¼Œå¦å¤–Agentè¿˜å¤šåŠ äº†ReActç­‰æ¨ç†æ¡†æ¶ã€‚","user_name":"ä½œè€…å›å¤","user_name_real":"ç¼–è¾‘","uid":1809833,"ctime":1695346596,"ip_address":"æ–°åŠ å¡","comment_id":381507,"utype":1}],"discussion_count":1,"race_medal":0,"score":2,"product_id":100617601,"comment_content":"æ„Ÿè§‰router_chainæ˜¯ä¸€ä¸ªagentäº†ï¼Œåªä¸è¿‡agentè°ƒç”¨çš„æ˜¯ä¸åŒçš„toolï¼Œrouter_chainè°ƒç”¨çš„æ˜¯å…¶ä»–çš„å¤§æ¨¡å‹LLM","like_count":3,"discussions":[{"author":{"id":1809833,"avatar":"https://static001.geekbang.org/account/avatar/00/1b/9d/a9/4602808f.jpg","nickname":"é»„ä½³","note":"","ucode":"8EC41D2EAB0E3C","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":628479,"discussion_content":"å¯¹ï¼Œrouter_chainæ˜¯ä¸€ä¸ªç®€å•agentäº†ã€‚è¿™æ˜¯å› ä¸ºå®ƒçš„Routerè·¯å¾„æ˜¯LLMæ¨å‡ºæ¥çš„ï¼Œä¸æ˜¯äººä¸ºæŒ‡å®šçš„ã€‚Agentä¹Ÿå°±æ˜¯è®©LLMæ¨å‡ºæ¥è°ƒç”¨å“ªä¸ªToolï¼Œå¦å¤–Agentè¿˜å¤šåŠ äº†ReActç­‰æ¨ç†æ¡†æ¶ã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1695346596,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"æ–°åŠ å¡","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":381553,"user_name":"é˜¿æ–¯è’‚èŠ¬","can_delete":false,"product_type":"c1","uid":1024164,"ip_address":"å¹¿ä¸œ","ucode":"61D5E3BDA4EBC5","user_header":"https://static001.geekbang.org/account/avatar/00/0f/a0/a4/b060c723.jpg","comment_is_top":false,"comment_ctime":1695375893,"is_pvip":false,"replies":[{"id":138985,"content":"æˆ‘è§‰å¾—Chainå°±æ˜¯ä¸ªå°è£…å’Œç»„åˆï¼ŒAgentæ‰æ˜¯é©±åŠ¨åŠ›ã€‚","user_name":"ä½œè€…å›å¤","user_name_real":"ç¼–è¾‘","uid":1809833,"ctime":1695442207,"ip_address":"æ–°åŠ å¡","comment_id":381553,"utype":1}],"discussion_count":1,"race_medal":0,"score":2,"product_id":100617601,"comment_content":"æ‰“å¡ markï¼è¯¾è·Ÿä¸Šäº†ï¼Œä»£ç è¿˜æ²¡è·Ÿä¸Šã€‚chains çš„ç†å¿µç®—ä¸ç®—å°±æ˜¯åˆ©ç”¨LLMæ¥é©±åŠ¨LLMï¼Ÿ","like_count":2,"discussions":[{"author":{"id":1809833,"avatar":"https://static001.geekbang.org/account/avatar/00/1b/9d/a9/4602808f.jpg","nickname":"é»„ä½³","note":"","ucode":"8EC41D2EAB0E3C","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":628525,"discussion_content":"æˆ‘è§‰å¾—Chainå°±æ˜¯ä¸ªå°è£…å’Œç»„åˆï¼ŒAgentæ‰æ˜¯é©±åŠ¨åŠ›ã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1695442208,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"æ–°åŠ å¡","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":384905,"user_name":"dydcm","can_delete":false,"product_type":"c1","uid":1105690,"ip_address":"å¹¿ä¸œ","ucode":"7A3F4F292F3DB5","user_header":"http://thirdwx.qlogo.cn/mmopen/vi_32/hllDt1dmuR6iciaahutPe9NjOic5OPMc7fbTysLTn8wgCSPW3zjYvd5rYDWBwQkSmqfsFntK12fLmam63FWpMklfg/132","comment_is_top":false,"comment_ctime":1701771019,"is_pvip":false,"replies":[{"id":140915,"content":"import numpy as np å‡ºé”™ï¼Œçœ‹èµ·æ¥ç¯å¢ƒçš„é—®é¢˜ã€‚é‡è£…ä¸€ä¸‹ç¯å¢ƒï¼Ÿ","user_name":"ä½œè€…å›å¤","user_name_real":"ç¼–è¾‘","uid":1809833,"ctime":1705069115,"ip_address":"ç‘å£«","comment_id":384905,"utype":1}],"discussion_count":1,"race_medal":0,"score":2,"product_id":100617601,"comment_content":"è€å¸ˆæ‚¨å¥½ï¼Œæˆ‘è·‘æ ·ä¾‹çš„æ—¶å€™ä¸€ç›´æŠ¥ä¸€ä¸ªé”™ï¼Œèƒ½éº»çƒ¦å¸®å¿™çœ‹ä¸‹åŸå› å—ï¼ŸæŠ¥é”™å¦‚ä¸‹ï¼š\n\nThe above exception was the direct cause of the following exception:\nã€‚ã€‚ã€‚\n\n File &quot;&#47;Library&#47;Frameworks&#47;Python.framework&#47;Versions&#47;3.12&#47;lib&#47;python3.12&#47;site-packages&#47;langchain&#47;utils&#47;__init__.py&quot;, line 15, in &lt;module&gt;\n    from langchain.utils.math import cosine_similarity, cosine_similarity_top_k\n  File &quot;&#47;Library&#47;Frameworks&#47;Python.framework&#47;Versions&#47;3.12&#47;lib&#47;python3.12&#47;site-packages&#47;langchain&#47;utils&#47;math.py&quot;, line 5, in &lt;module&gt;\n    import numpy as np\n  File &quot;&#47;Library&#47;Frameworks&#47;Python.framework&#47;Versions&#47;3.12&#47;lib&#47;python3.12&#47;site-packages&#47;numpy&#47;__init__.py&quot;, line 135, in &lt;module&gt;\n    raise ImportError(msg) from e\nImportError: Error importing numpy: you should not try to import numpy from\n        its source directory; please exit the numpy source tree, and relaunch\n        your python interpreter from there.\n\n  ","like_count":0,"discussions":[{"author":{"id":1809833,"avatar":"https://static001.geekbang.org/account/avatar/00/1b/9d/a9/4602808f.jpg","nickname":"é»„ä½³","note":"","ucode":"8EC41D2EAB0E3C","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":635721,"discussion_content":"import numpy as np å‡ºé”™ï¼Œçœ‹èµ·æ¥ç¯å¢ƒçš„é—®é¢˜ã€‚é‡è£…ä¸€ä¸‹ç¯å¢ƒï¼Ÿ","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1705069115,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"ç‘å£«","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2,\"source\":0}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":383506,"user_name":"SH","can_delete":false,"product_type":"c1","uid":1013132,"ip_address":"æµ™æ±Ÿ","ucode":"0A3202CE56C118","user_header":"https://static001.geekbang.org/account/avatar/00/0f/75/8c/791d0f5e.jpg","comment_is_top":false,"comment_ctime":1699185416,"is_pvip":false,"replies":[{"id":140204,"content":"é€šè¿‡æ˜¾ç¤ºverboseæˆ–è€…è®¾ç½®å…¨å±€debugï¼Œå°±å¯ä»¥çœ‹åˆ°å…·ä½“çš„æç¤ºæ¨¡æ¿ã€‚","user_name":"ä½œè€…å›å¤","user_name_real":"ç¼–è¾‘","uid":1809833,"ctime":1700584332,"ip_address":"ç‘å£«","comment_id":383506,"utype":1}],"discussion_count":1,"race_medal":0,"score":2,"product_id":100617601,"comment_content":"è¿™èŠ‚é‡Œé¢çš„é—®é¢˜ï¼Œå¦‚æœä½¿ç”¨ å½“å‰çš„ ChatGPT æˆ‘ä»¬å¦‚æœç›´æ¥å‘ä»–æé—®çš„æ—¶å€™ï¼Œä»–çš„å†…éƒ¨æ˜¯å¦å·²ç»å¸®åŠ©æˆ‘è°ƒæ•´å¥½äº†ç›¸å…³çš„æç¤ºæ¨¡ç‰ˆï¼Œé€šè¿‡ç›¸å…³çš„é“¾ æ¥å›ç­”ç›¸å…³çš„é—®é¢˜å‘¢ï¼Ÿ  \n\nå®é™…æµ‹è¯•äº†ä¸€ä¸‹ï¼Œæ²¡æœ‰æç¤ºæ¨¡æ¿é—®ï¼Œä¸åŠ äº†æç¤ºæ¨¡æ¿ï¼ˆå‘Šè¯‰ä»–æ˜¯ä¸ªä¸“é—¨ï¼‰ï¼Œä¸¤ç§æ–¹å¼è¾“å‡ºçš„ç¡®ä¼šæœ‰äº›å·®å¼‚ï¼›","like_count":0,"discussions":[{"author":{"id":1809833,"avatar":"https://static001.geekbang.org/account/avatar/00/1b/9d/a9/4602808f.jpg","nickname":"é»„ä½³","note":"","ucode":"8EC41D2EAB0E3C","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":632254,"discussion_content":"é€šè¿‡æ˜¾ç¤ºverboseæˆ–è€…è®¾ç½®å…¨å±€debugï¼Œå°±å¯ä»¥çœ‹åˆ°å…·ä½“çš„æç¤ºæ¨¡æ¿ã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1700584332,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"ç‘å£«","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":382495,"user_name":"sunny","can_delete":false,"product_type":"c1","uid":1094714,"ip_address":"å®‰å¾½","ucode":"1F8F1A30B26BD2","user_header":"https://static001.geekbang.org/account/avatar/00/10/b4/3a/02ea71fa.jpg","comment_is_top":false,"comment_ctime":1697458254,"is_pvip":false,"replies":[{"id":139446,"content":"å¥½é—®é¢˜ã€‚\nRouterChainç”±ä¸¤ä¸ªä¸»è¦ç»„ä»¶ç»„æˆ:\n1. RouterChainæœ¬èº«(è´Ÿè´£é€‰æ‹©ä¸‹ä¸€ä¸ªè¦è°ƒç”¨çš„é“¾)\n2. destination_chains: è·¯ç”±å™¨å¯ä»¥è·¯ç”±åˆ°çš„é“¾\nRouterChainçš„ä½œç”¨æ˜¯æ ¹æ®è¾“å…¥åŠ¨æ€é€‰æ‹©ä¸‹ä¸€ä¸ªè¦æ‰§è¡Œçš„é“¾ã€‚å®ƒä¸éœ€è¦é€šè¿‡ä¸ºå¤§å‹è¯­è¨€æ¨¡å‹ç¼–å†™æç¤ºæ¥æ¨æ–­ç”¨æˆ·çš„æ„å›¾ã€‚\nç›¸å,RouterChainåœ¨å†…éƒ¨ç»´æŠ¤ä¸€ç»„å¯èƒ½çš„ç›®æ ‡é“¾(destination_chains)ã€‚å¯¹äºæ¯ä¸ªè¾“å…¥,å®ƒä¼šæ ¹æ®å†…éƒ¨é€»è¾‘é€‰æ‹©ä¸‹ä¸€ä¸ªè¦è¿è¡Œçš„ç›®æ ‡é“¾ã€‚\nä¾‹å¦‚,EmbeddingRouterChainä½¿ç”¨è¾“å…¥çš„åµŒå…¥å‘é‡ä¸ç›®æ ‡é“¾æè¿°çš„åµŒå…¥å‘é‡è¿›è¡Œç›¸ä¼¼æ€§æ¯”è¾ƒ,é€‰æ‹©ç›¸ä¼¼åº¦æœ€é«˜çš„é“¾ã€‚LLMRouterChainä½¿ç”¨å°å‹è¯­è¨€æ¨¡å‹æ ¹æ®ç›®æ ‡é“¾çš„æè¿°æ¥é€‰æ‹©é“¾ã€‚\nRouterChainè‡ªåŠ¨å¤„ç†è·¯ç”±é€»è¾‘,ç”¨æˆ·åªéœ€è¦æä¾›ç›®æ ‡é“¾,è€Œä¸éœ€è¦ç¼–å†™é€‰æ‹©ç›®æ ‡é“¾çš„æç¤ºã€‚å®ƒåŠ¨æ€åœ°æ ¹æ®æ¯ä¸ªè¾“å…¥é€‰æ‹©ä¸‹ä¸€ä¸ªé“¾,å®ç°äº†å¯é…ç½®çš„å¤šä»»åŠ¡é“¾ã€‚â€”â€” æˆ‘è®¤ä¸ºæ­¤å¤„å¯¹äºdestination_chainsçš„è¯´æ˜æ–‡å­—éå¸¸é‡è¦ï¼Œå…¶å®ƒé—®é¢˜RouterChainå†…éƒ¨è§£å†³ â€”â€” åŒå­¦ä»¬æœ‰ä¸åŒæ„è§ä¹ˆï¼Ÿ","user_name":"ä½œè€…å›å¤","user_name_real":"ç¼–è¾‘","uid":1809833,"ctime":1698140335,"ip_address":"ç‘å£«","comment_id":382495,"utype":1}],"discussion_count":4,"race_medal":0,"score":2,"product_id":100617601,"comment_content":"æ–‡ç« ä¸­çš„è¿™ä¸€æ®µè¯ï¼š\nï¼ˆRouterChainï¼Œä¹Ÿå«è·¯ç”±é“¾ï¼Œèƒ½åŠ¨æ€é€‰æ‹©ç”¨äºç»™å®šè¾“å…¥çš„ä¸‹ä¸€ä¸ªé“¾ã€‚æˆ‘ä»¬ä¼šæ ¹æ®ç”¨æˆ·çš„é—®é¢˜å†…å®¹ï¼Œé¦–å…ˆä½¿ç”¨è·¯ç”±å™¨é“¾ç¡®å®šé—®é¢˜æ›´é€‚åˆå“ªä¸ªå¤„ç†æ¨¡æ¿ï¼Œç„¶åå°†é—®é¢˜å‘é€åˆ°è¯¥å¤„ç†æ¨¡æ¿è¿›è¡Œå›ç­”ã€‚å¦‚æœé—®é¢˜ä¸é€‚åˆä»»ä½•å·²å®šä¹‰çš„å¤„ç†æ¨¡æ¿ï¼Œå®ƒä¼šè¢«å‘é€åˆ°é»˜è®¤é“¾ã€‚ï¼‰\næˆ‘çš„ç–‘é—®æ˜¯ï¼šè¿™é‡ŒæŒ‡è·¯ç”±é“¾æ˜¯èƒ½è‡ªåŠ¨æ¨ç†å‡ºç”¨æˆ·æ„å›¾ï¼Œè¿›è€Œé€‰æ‹©å¯¹åº”æ„å›¾æ‰€è¦èµ°çš„ä»»åŠ¡å¤„ç†ç›®æ ‡é“¾å—ï¼›ä¸éœ€è¦é€šè¿‡å†™prompt+ç”¨æˆ·è¾“å…¥é€å…¥åˆ°å¤§æ¨¡å‹è®©å¤§æ¨¡å‹è¿›è¡Œè‡ªåŠ¨æ¨ç†åšé€‰æ‹©é¢˜è¾“å‡ºæ„å›¾å—ï¼Ÿ\nï¼ˆæ¯”å¦‚å†™ä¸ªprompt:\nè¯·ç†è§£è¿™ä¸€æ®µè¯{å˜é‡=ç”¨æˆ·è¾“å…¥},åˆ¤æ–­è¿™æ®µè¯æ˜¯æƒ³è¿›è¡Œ[é²œèŠ±å…»æŠ¤]è¿˜æ˜¯[é²œèŠ±åŸ¹è‚²];\n##è‹¥æ˜¯é²œèŠ±å…»æŠ¤è¯·è¾“å‡º&quot;A&quot;,è‹¥æ˜¯é²œèŠ±åŸ¹è‚²è¾“å‡ºâ€Bâ€œï¼‰\nè¿™æ ·å¾—åˆ°åˆ°äº†Aæˆ–Båˆ¤æ–­å‡ºäº†ç”¨æˆ·æ„å›¾èµ°å“ªä¸ªç›®æ ‡é“¾","like_count":0,"discussions":[{"author":{"id":1809833,"avatar":"https://static001.geekbang.org/account/avatar/00/1b/9d/a9/4602808f.jpg","nickname":"é»„ä½³","note":"","ucode":"8EC41D2EAB0E3C","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":630150,"discussion_content":"å¥½é—®é¢˜ã€‚\nRouterChainç”±ä¸¤ä¸ªä¸»è¦ç»„ä»¶ç»„æˆ:\n1. RouterChainæœ¬èº«(è´Ÿè´£é€‰æ‹©ä¸‹ä¸€ä¸ªè¦è°ƒç”¨çš„é“¾)\n2. destination_chains: è·¯ç”±å™¨å¯ä»¥è·¯ç”±åˆ°çš„é“¾\nRouterChainçš„ä½œç”¨æ˜¯æ ¹æ®è¾“å…¥åŠ¨æ€é€‰æ‹©ä¸‹ä¸€ä¸ªè¦æ‰§è¡Œçš„é“¾ã€‚å®ƒä¸éœ€è¦é€šè¿‡ä¸ºå¤§å‹è¯­è¨€æ¨¡å‹ç¼–å†™æç¤ºæ¥æ¨æ–­ç”¨æˆ·çš„æ„å›¾ã€‚\nç›¸å,RouterChainåœ¨å†…éƒ¨ç»´æŠ¤ä¸€ç»„å¯èƒ½çš„ç›®æ ‡é“¾(destination_chains)ã€‚å¯¹äºæ¯ä¸ªè¾“å…¥,å®ƒä¼šæ ¹æ®å†…éƒ¨é€»è¾‘é€‰æ‹©ä¸‹ä¸€ä¸ªè¦è¿è¡Œçš„ç›®æ ‡é“¾ã€‚\nä¾‹å¦‚,EmbeddingRouterChainä½¿ç”¨è¾“å…¥çš„åµŒå…¥å‘é‡ä¸ç›®æ ‡é“¾æè¿°çš„åµŒå…¥å‘é‡è¿›è¡Œç›¸ä¼¼æ€§æ¯”è¾ƒ,é€‰æ‹©ç›¸ä¼¼åº¦æœ€é«˜çš„é“¾ã€‚LLMRouterChainä½¿ç”¨å°å‹è¯­è¨€æ¨¡å‹æ ¹æ®ç›®æ ‡é“¾çš„æè¿°æ¥é€‰æ‹©é“¾ã€‚\nRouterChainè‡ªåŠ¨å¤„ç†è·¯ç”±é€»è¾‘,ç”¨æˆ·åªéœ€è¦æä¾›ç›®æ ‡é“¾,è€Œä¸éœ€è¦ç¼–å†™é€‰æ‹©ç›®æ ‡é“¾çš„æç¤ºã€‚å®ƒåŠ¨æ€åœ°æ ¹æ®æ¯ä¸ªè¾“å…¥é€‰æ‹©ä¸‹ä¸€ä¸ªé“¾,å®ç°äº†å¯é…ç½®çš„å¤šä»»åŠ¡é“¾ã€‚â€”â€” æˆ‘è®¤ä¸ºæ­¤å¤„å¯¹äºdestination_chainsçš„è¯´æ˜æ–‡å­—éå¸¸é‡è¦ï¼Œå…¶å®ƒé—®é¢˜RouterChainå†…éƒ¨è§£å†³ â€”â€” åŒå­¦ä»¬æœ‰ä¸åŒæ„è§ä¹ˆï¼Ÿ","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1698140335,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"ç‘å£«","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":1,"child_discussions":[{"author":{"id":1008312,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/62/b8/0e1b655e.jpg","nickname":"fireshort","note":"","ucode":"10550CA9C6C730","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":1809833,"avatar":"https://static001.geekbang.org/account/avatar/00/1b/9d/a9/4602808f.jpg","nickname":"é»„ä½³","note":"","ucode":"8EC41D2EAB0E3C","race_medal":0,"user_type":2,"is_pvip":false},"discussion":{"id":632600,"discussion_content":"é»„è€å¸ˆï¼Œè¿™é‡Œä¸åŒæ„ä½ çš„æ„è§ã€‚\n\nå­¦é»„è€å¸ˆè¿™é—¨è¯¾ï¼Œå»ºè®®å¤§å®¶ç”¨LangChainçš„smithå¹³å°ï¼Œå¯ä»¥å¾ˆæ¸…æ¥šçœ‹åˆ°å„ç§ç»†èŠ‚ã€‚LLMRouterChainå…¶å®æ˜¯ç”Ÿæˆäº†è¿™æ ·çš„Promptä¼ ç»™LLMï¼Œç”±LLMæ¥è¿”å›ç›®æ ‡è·¯ç”±ï¼š\n\nGiven a raw text input to a language model select the model prompt best suited for the input. You will be given the names of the available prompts and a description of what the prompt is best suited for. You may also revise the original input if you think that revising it will ultimately lead to a better response from the language model.\n\n&lt;&lt; FORMATTING &gt;&gt;\nReturn a markdown code snippet with a JSON object formatted to look like:\n```json\n{\n    &#34;destination&#34;: string \\ name of the prompt to use or &#34;DEFAULT&#34;\n    &#34;next_inputs&#34;: string \\ a potentially modified version of the original input\n}\n```\n\nREMEMBER: &#34;destination&#34; MUST be one of the candidate prompt names specified below OR it can be &#34;DEFAULT&#34; if the input is not well suited for any of the candidate prompts.\nREMEMBER: &#34;next_inputs&#34; can just be the original input if you don&#39;t think any modifications are needed.\n\n&lt;&lt; CANDIDATE PROMPTS &gt;&gt;\nflower_care: é€‚åˆå›ç­”å…³äºé²œèŠ±æŠ¤ç†çš„é—®é¢˜\nflower_decoration: é€‚åˆå›ç­”å…³äºé²œèŠ±è£…é¥°çš„é—®é¢˜\n\n&lt;&lt; INPUT &gt;&gt;\nå¦‚ä½•ä¸ºå©šç¤¼åœºåœ°è£…é¥°èŠ±æœµï¼Ÿ\n\n&lt;&lt; OUTPUT (must include ```json at the start of the response) &gt;&gt;\n&lt;&lt; OUTPUT (must end with ```) &gt;&gt;\n\nLLMçš„è¾“å‡ºæ˜¯ï¼š\n```json\n{\n    &#34;destination&#34;: &#34;flower_decoration&#34;,\n    &#34;next_inputs&#34;: &#34;å¦‚ä½•ä¸ºå©šç¤¼åœºåœ°è£…é¥°èŠ±æœµï¼Ÿ&#34;\n}\n```\n","likes_number":3,"is_delete":false,"is_hidden":false,"ctime":1701056419,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":630150,"ip_address":"å¹¿ä¸œ","group_id":0},"score":632600,"extra":""}]},{"author":{"id":1070253,"avatar":"https://static001.geekbang.org/account/avatar/00/10/54/ad/6ee2b7cb.jpg","nickname":"Jacob.C","note":"","ucode":"034998E7A7CCD1","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":632676,"discussion_content":"æˆ‘è§‰å¾—è¿™ä½åŒå­¦è¯´çš„æ˜¯å¯è¡Œçš„ï¼Œè€Œä¸”é€‚åˆä½œä¸ºèŠå¤©é¡µé¢çš„ prompt æ²¡é—®é¢˜ã€‚è¦æ˜¯æ”¾åˆ°é¡¹ç›®é‡Œï¼Œè¿˜æ˜¯é€‰æ‹©ç»“æ„åŒ–çš„æ–¹å¼ï¼Œå·¥ç¨‹æ€§ï¼ˆç¨³å®šæ€§å’Œå¯è§‚æµ‹æ€§ï¼‰æ›´å¥½ã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1701180733,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":"å¹¿ä¸œ","group_id":0},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1008312,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/62/b8/0e1b655e.jpg","nickname":"fireshort","note":"","ucode":"10550CA9C6C730","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":630138,"discussion_content":"ä»”ç»†çœ‹æ–‡ç« çš„è·¯ç”±æ¨¡æ¿è§£é‡Šã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1698137818,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":"å¹¿ä¸œ","group_id":0},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":382491,"user_name":"Geek_19a2eb","can_delete":false,"product_type":"c1","uid":3732186,"ip_address":"æµ™æ±Ÿ","ucode":"CCB604FB93E07B","user_header":"","comment_is_top":false,"comment_ctime":1697453174,"is_pvip":false,"replies":[{"id":139442,"content":"å¤§æ¨¡å‹æœ‰æ—¶ç»™å‡ºçš„ç»“æœä¸ç¨³å®šã€‚è§£å†³æ–¹æ¡ˆï¼š1. é‡æ–°è¿è¡Œã€‚2. å¯ä»¥è€ƒè™‘è¾“å‡ºè§£ææ—¶ä½¿ç”¨æˆ‘ä»¬ä¹‹å‰ï¼ˆç¬¬7è¯¾ï¼‰è®²è¿‡çš„é”™è¯¯å¤„ç†æœºåˆ¶ã€‚","user_name":"ä½œè€…å›å¤","user_name_real":"ç¼–è¾‘","uid":1809833,"ctime":1698139408,"ip_address":"ç‘å£«","comment_id":382491,"utype":1}],"discussion_count":2,"race_medal":0,"score":2,"product_id":100617601,"comment_content":"å°±æ˜¯å½“è¾“å…¥çš„å†…å®¹åŒ¹é…ä¸ä¸Šå…¶ä»–çš„é“¾çš„æ—¶å€™åˆ°é»˜è®¤è·¯ç”±è¿™æŠ¥é”™  å…¶ä»–çš„é“¾éƒ½æ˜¯æ­£å¸¸çš„  æŠ¥é”™ä¿¡æ¯å¦‚ä¸‹ï¼Œéº»çƒ¦è€å¸ˆå¸®å¿™çœ‹ä¸‹ åˆšå…¥é—¨çš„å°ç™½ï¼Œå¤šå¤šç†è§£ï¼šOutputParserException: Parsing text\n```json\n{\n    &quot;destination&quot;: &quot;DEFAULT&quot;,\n    &quot;next_inputs&quot;: &quot;å¦‚ä½•è€ƒå…¥å“ˆä½›å¤§å­¦?&quot;\n}\n raised following error:\nGot invalid JSON object. Error: Expecting value: line 1 column 1 (char 0)","like_count":0,"discussions":[{"author":{"id":1809833,"avatar":"https://static001.geekbang.org/account/avatar/00/1b/9d/a9/4602808f.jpg","nickname":"é»„ä½³","note":"","ucode":"8EC41D2EAB0E3C","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":630146,"discussion_content":"å¤§æ¨¡å‹æœ‰æ—¶ç»™å‡ºçš„ç»“æœä¸ç¨³å®šã€‚è§£å†³æ–¹æ¡ˆï¼š1. é‡æ–°è¿è¡Œã€‚2. å¯ä»¥è€ƒè™‘è¾“å‡ºè§£ææ—¶ä½¿ç”¨æˆ‘ä»¬ä¹‹å‰ï¼ˆç¬¬7è¯¾ï¼‰è®²è¿‡çš„é”™è¯¯å¤„ç†æœºåˆ¶ã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1698139408,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"ç‘å£«","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":3732186,"avatar":"","nickname":"Geek_19a2eb","note":"","ucode":"CCB604FB93E07B","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":629754,"discussion_content":"ä¹°å®Œè¯¾ éƒ½ä¸å¸¦å›å¤çš„  å¥½å¥½å¥½","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1697598102,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":"æµ™æ±Ÿ","group_id":0},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":382490,"user_name":"Geek_19a2eb","can_delete":false,"product_type":"c1","uid":3732186,"ip_address":"æµ™æ±Ÿ","ucode":"CCB604FB93E07B","user_header":"","comment_is_top":false,"comment_ctime":1697452966,"is_pvip":false,"replies":[{"id":139440,"content":"è¿™æ˜¯å¤§æ¨¡å‹ç»™å‡ºçš„ç­”æ¡ˆæ ¼å¼ä¸ç¨³å®šé€ æˆçš„ã€‚å¤šè¿è¡Œå‡ æ¬¡å°±å¥½äº†ã€‚åŒæ—¶åŒå­¦ä¹Ÿå¯ä»¥æ€è€ƒä¸€ä¸‹æœ‰æ²¡æœ‰ä»€ä¹ˆé”™è¯¯å¤„ç†æ–¹æ¡ˆã€‚","user_name":"ä½œè€…å›å¤","user_name_real":"ç¼–è¾‘","uid":1809833,"ctime":1698138974,"ip_address":"ç‘å£«","comment_id":382490,"utype":1}],"discussion_count":1,"race_medal":0,"score":2,"product_id":100617601,"comment_content":"è€å¸ˆæ‚¨å¥½ æˆ‘è¿è¡Œåˆ°print(chain.run(â€œå¦‚ä½•è€ƒå…¥å“ˆä½›å¤§å­¦ï¼Ÿâ€))çš„æ—¶å€™æŠ¥é”™  èƒ½ç»™çœ‹ä¸‹æ˜¯å•¥åŸå› å—  æŠ¥é”™å¦‚ä¸‹ï¼š\nOutputParserException: Parsing text\n```json\n{\n    &quot;destination&quot;: &quot;DEFAULT&quot;,\n    &quot;next_inputs&quot;: &quot;å¦‚ä½•è€ƒå…¥å“ˆä½›å¤§å­¦?&quot;\n}\n raised following error:\nGot invalid JSON object. Error: Expecting value: line 1 column 1 (char 0)","like_count":0,"discussions":[{"author":{"id":1809833,"avatar":"https://static001.geekbang.org/account/avatar/00/1b/9d/a9/4602808f.jpg","nickname":"é»„ä½³","note":"","ucode":"8EC41D2EAB0E3C","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":630143,"discussion_content":"è¿™æ˜¯å¤§æ¨¡å‹ç»™å‡ºçš„ç­”æ¡ˆæ ¼å¼ä¸ç¨³å®šé€ æˆçš„ã€‚å¤šè¿è¡Œå‡ æ¬¡å°±å¥½äº†ã€‚åŒæ—¶åŒå­¦ä¹Ÿå¯ä»¥æ€è€ƒä¸€ä¸‹æœ‰æ²¡æœ‰ä»€ä¹ˆé”™è¯¯å¤„ç†æ–¹æ¡ˆã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1698138974,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"ç‘å£«","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":382262,"user_name":"æ¼ç½‘ä¹‹æ¸”","can_delete":false,"product_type":"c1","uid":1092258,"ip_address":"åŒ—äº¬","ucode":"8D7896E99E784C","user_header":"https://static001.geekbang.org/account/avatar/00/10/aa/a2/c7a3758d.jpg","comment_is_top":false,"comment_ctime":1696952101,"is_pvip":false,"replies":[{"id":139247,"content":"ä¸ºäº†æ¸…æ™°å’Œä¸€è‡´çš„å®ç°ï¼Œå¦‚æœRouterChainä¸­çš„æ‰€æœ‰åˆ†æ”¯éƒ½æœŸæœ›ç›¸åŒçš„è¾“å…¥æ ¼å¼ï¼Œé€šå¸¸ä¼šæ›´ç®€å•ã€‚è¿™ç¡®ä¿äº†è·¯ç”±é€»è¾‘ä¿æŒç®€å•ï¼Œè¡Œä¸ºæ˜¯å¯é¢„æµ‹çš„ã€‚ä½†æ˜¯ï¼Œå¦‚æœçœŸçš„éœ€è¦æ”¯æŒä¸åŒçš„å‚æ•°ç”¨äºä¸åŒçš„é“¾ï¼Œé‚£ä¹ˆé€šè¿‡ä¸€äº›é¢å¤–çš„å¼€å‘å·¥ä½œåº”è¯¥æ˜¯å¯èƒ½çš„ã€‚","user_name":"ä½œè€…å›å¤","user_name_real":"ç¼–è¾‘","uid":1809833,"ctime":1696988640,"ip_address":"ç‘å£«","comment_id":382262,"utype":1}],"discussion_count":1,"race_medal":0,"score":3,"product_id":100617601,"comment_content":"RouterChainä¸­æ¯ä¸ªåˆ†æ”¯chainçš„è¾“å…¥å‚æ•°è¦æ±‚æ˜¯ç›¸åŒçš„ä¹ˆï¼Œå¯ä»¥ä½¿ç”¨ä¸åŒæ•°é‡çš„å‚æ•°ä¹ˆ","like_count":0,"discussions":[{"author":{"id":1809833,"avatar":"https://static001.geekbang.org/account/avatar/00/1b/9d/a9/4602808f.jpg","nickname":"é»„ä½³","note":"","ucode":"8EC41D2EAB0E3C","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":629365,"discussion_content":"ä¸ºäº†æ¸…æ™°å’Œä¸€è‡´çš„å®ç°ï¼Œå¦‚æœRouterChainä¸­çš„æ‰€æœ‰åˆ†æ”¯éƒ½æœŸæœ›ç›¸åŒçš„è¾“å…¥æ ¼å¼ï¼Œé€šå¸¸ä¼šæ›´ç®€å•ã€‚è¿™ç¡®ä¿äº†è·¯ç”±é€»è¾‘ä¿æŒç®€å•ï¼Œè¡Œä¸ºæ˜¯å¯é¢„æµ‹çš„ã€‚ä½†æ˜¯ï¼Œå¦‚æœçœŸçš„éœ€è¦æ”¯æŒä¸åŒçš„å‚æ•°ç”¨äºä¸åŒçš„é“¾ï¼Œé‚£ä¹ˆé€šè¿‡ä¸€äº›é¢å¤–çš„å¼€å‘å·¥ä½œåº”è¯¥æ˜¯å¯èƒ½çš„ã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1696988640,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"ç‘å£«","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":382079,"user_name":"å¤è½deçƒ¦æ¼","can_delete":false,"product_type":"c1","uid":1875724,"ip_address":"å¹¿ä¸œ","ucode":"0CBDC51EF566A6","user_header":"https://static001.geekbang.org/account/avatar/00/1c/9f/0c/8484f8b1.jpg","comment_is_top":false,"comment_ctime":1696665065,"is_pvip":false,"replies":[{"id":139191,"content":"å®˜æ–¹çš„åº”è¯¥æ²¡æœ‰ï¼ŒåŒå­¦å¯ä»¥ç ”ç©¶ä¸€ä¸‹è¿™ä¸ªï¼šhttps:&#47;&#47;github.com&#47;ninehills&#47;langchain-wenxin","user_name":"ä½œè€…å›å¤","user_name_real":"ç¼–è¾‘","uid":1809833,"ctime":1696783217,"ip_address":"ç‘å£«","comment_id":382079,"utype":1}],"discussion_count":1,"race_medal":0,"score":3,"product_id":100617601,"comment_content":"langchainæœ‰é›†æˆæ–‡å¿ƒä¸€è¨€ä¹ˆï¼Ÿè¿™ä¸ªæ¡ˆä¾‹èƒ½ç”¨åœ¨æ–‡å¿ƒä¸€è¨€ä¸Šä¹ˆï¼Ÿ","like_count":0,"discussions":[{"author":{"id":1809833,"avatar":"https://static001.geekbang.org/account/avatar/00/1b/9d/a9/4602808f.jpg","nickname":"é»„ä½³","note":"","ucode":"8EC41D2EAB0E3C","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":629184,"discussion_content":"å®˜æ–¹çš„åº”è¯¥æ²¡æœ‰ï¼ŒåŒå­¦å¯ä»¥ç ”ç©¶ä¸€ä¸‹è¿™ä¸ªï¼šhttps://github.com/ninehills/langchain-wenxin","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1696783217,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"ç‘å£«","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":382010,"user_name":"zhouqin","can_delete":false,"product_type":"c1","uid":1005403,"ip_address":"å››å·","ucode":"88C28CE9B6AE88","user_header":"https://static001.geekbang.org/account/avatar/00/0f/57/5b/caacc46f.jpg","comment_is_top":false,"comment_ctime":1696507658,"is_pvip":false,"replies":[{"id":139174,"content":"å¥½ä¸»æ„ï¼ŒæŠŠGPTçš„æ²¹æ°´æ¦¨å¹²ã€‚","user_name":"ä½œè€…å›å¤","user_name_real":"ç¼–è¾‘","uid":1809833,"ctime":1696668161,"ip_address":"ç‘å£«","comment_id":382010,"utype":1}],"discussion_count":1,"race_medal":0,"score":3,"product_id":100617601,"comment_content":"å»ºè®®æœ‰å¼€å‘ç»éªŒçš„åŒå­¦ï¼Œå…ˆé€šè¿‡gptæŠŠä½œè€…æ–‡ç« æ ¸å¿ƒç‚¹ç²¾ç‚¼å‡ºæ¥ã€‚ç„¶åç”¨ä½œè€…é€šè¿‡LangChainæ¨¡æ¿è·‘å‡ºçš„æç¤ºè¯ï¼Œé€šè¿‡gptæˆ–è€…claudeåšéªŒè¯ã€‚å¤šè·‘å‡ éå°±èƒ½æ„Ÿè§‰åˆ°å¤§æ¨¡å‹çš„æ€ç»´æ–¹å¼ã€‚æœ€åå†å»çœ‹ä»£ç ã€‚äº‹åŠåŠŸå€ã€ã€ï¼šã€‹","like_count":0,"discussions":[{"author":{"id":1809833,"avatar":"https://static001.geekbang.org/account/avatar/00/1b/9d/a9/4602808f.jpg","nickname":"é»„ä½³","note":"","ucode":"8EC41D2EAB0E3C","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":629102,"discussion_content":"å¥½ä¸»æ„ï¼ŒæŠŠGPTçš„æ²¹æ°´æ¦¨å¹²ã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1696668161,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"ç‘å£«","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":381858,"user_name":"Geek_7ca963","can_delete":false,"product_type":"c1","uid":2657690,"ip_address":"åŒ—äº¬","ucode":"610B7FD6D30207","user_header":"https://static001.geekbang.org/account/avatar/00/28/8d/9a/6c9a252e.jpg","comment_is_top":false,"comment_ctime":1696035254,"is_pvip":false,"replies":[{"id":139101,"content":"è¿™é‡Œçš„Chainåªæ˜¯ç®€å•çš„è·¯ç”±åŠŸèƒ½ï¼Œè‡ªä¸»æ€§ä¸å¦‚Agentçš„è®¾è®¡å¤æ‚ã€‚","user_name":"ä½œè€…å›å¤","user_name_real":"ç¼–è¾‘","uid":1809833,"ctime":1696240080,"ip_address":"æ–°åŠ å¡","comment_id":381858,"utype":1}],"discussion_count":1,"race_medal":0,"score":3,"product_id":100617601,"comment_content":"è€å¸ˆï¼ŒAgent å’Œ Chain åˆ°åº•æœ‰å•¥åŒºåˆ« ï¼Ÿ chain ä¼¼ä¹ä¹Ÿå¯ä»¥åš actï¼Œç”šè‡³åˆ¤æ–­ç”¨é€”","like_count":0,"discussions":[{"author":{"id":1809833,"avatar":"https://static001.geekbang.org/account/avatar/00/1b/9d/a9/4602808f.jpg","nickname":"é»„ä½³","note":"","ucode":"8EC41D2EAB0E3C","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":628918,"discussion_content":"è¿™é‡Œçš„Chainåªæ˜¯ç®€å•çš„è·¯ç”±åŠŸèƒ½ï¼Œè‡ªä¸»æ€§ä¸å¦‚Agentçš„è®¾è®¡å¤æ‚ã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1696240080,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"æ–°åŠ å¡","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":381549,"user_name":"Webber","can_delete":false,"product_type":"c1","uid":2776202,"ip_address":"ä¸Šæµ·","ucode":"F9662546472FA7","user_header":"https://static001.geekbang.org/account/avatar/00/2a/5c/8a/244128ff.jpg","comment_is_top":false,"comment_ctime":1695372938,"is_pvip":false,"replies":[{"id":138987,"content":"å¥½é—®é¢˜å•Šï¼ŒåŒå­¦ã€‚é©¬ä¸Šå°±è®²Agentäº†ã€‚è¿™æ˜¯LangChainçš„ç²¾é«“ã€‚\nä½ éœ€è¦Passå¤šä¸ªå·¥å…·ç»™Chainï¼Œç„¶åLLMè¦åˆ†è§£Taskï¼Œéœ€è¦æ¨ç†å‡ºå…ˆåšä»€ä¹ˆååšä»€ä¹ˆã€‚\n1. æ€è€ƒ1 - å…ˆåšNERï¼Œè§£æå‡ºç›®çš„åœ°å’Œå‡ºå‘åœ°ã€‚\n2. è¡ŒåŠ¨1 - è°ƒç”¨å¦å¤–ä¸€ä¸ªLLMï¼ŒåšNERï¼Œæ‹¿ç»“æœ\n3. æ‹¿åˆ°æ€è€ƒ1çš„ç»“æœï¼Œè¿›è¡Œè§‚å¯Ÿã€‚\n4. æ€è€ƒ2 - æŠŠæ€è€ƒ1çš„ç»“æœPassç»™ç¬¬äºŒä¸ªå·¥å…·ã€‚è¿™ä¸ªå·¥å…·é€‰æ‹©æ˜¯é«˜å¾·åœ°å›¾\n5. è¡ŒåŠ¨2\nã€‚ã€‚ã€‚ã€‚ã€‚\n","user_name":"ä½œè€…å›å¤","user_name_real":"ç¼–è¾‘","uid":1809833,"ctime":1695451081,"ip_address":"æ–°åŠ å¡","comment_id":381549,"utype":1}],"discussion_count":2,"race_medal":0,"score":3,"product_id":100617601,"comment_content":"è€å¸ˆå•¥æ—¶å€™æ›´æ–°agentçš„å†…å®¹å•Šï¼Œæˆ‘åœ¨ç”¨langchainåšä¸€ä¸ªagentã€‚é‡åˆ°ä¸€ä¸ªé—®é¢˜ï¼Œå°±æ˜¯åœ¨æœ€å¼€å§‹è¾“å…¥çš„æ˜¯ä¸€ä¸ªqueryï¼Œæ¯”å¦‚ï¼šå¸®æˆ‘ä»ä¸Šæµ·ä¸­å¿ƒå¤§å¦å¯¼èˆªåˆ°ä¸Šæµ·è™¹æ¡¥ç«è½¦ç«™ï¼Œagentæ­¤æ—¶å†³å®šå»è°ƒç”¨é«˜å¾·å¯¼èˆªè¿™ä¸ªtoolï¼Œé«˜å¾·å¯¼èˆªtoolæ¥æ”¶çš„è¾“å…¥æ˜¯å‡ºå‘åœ°å’Œç›®çš„åœ°ï¼Œé‚£ä¹ˆè¿™ä¸ªå‡ºå‘åœ°å’Œç›®çš„åœ°æ˜¯æ€ä¹ˆè§£æå‡ºæ¥ä¼ ç»™é«˜å¾·å¯¼èˆªtoolçš„å‘¢ï¼Œæ˜¯åœ¨è‡ªå®šä¹‰toolçš„descriptionä¸­å†™promptè®©æ¨¡å‹æå–å‡ºå‘åœ°å’Œç›®çš„åœ°ä¸¤ä¸ªå®ä½“å—ï¼Œä¸æ‡‚æ€ä¹ˆæ‰èƒ½ç»™æƒ³è¦è°ƒç”¨çš„toolä¼ é€’tooléœ€è¦çš„å‚æ•°ã€‚å¦‚æœæœ‰10ä¸ªtoolï¼Œæ¯ä¸ªtoolæ¥æ”¶çš„è¾“å…¥å‚æ•°éƒ½ä¸ä¸€æ ·ï¼Œä¸çŸ¥é“æ€ä¹ˆæ‰èƒ½å®ç°ç»™æŒ‡å®štoolä¼ é€’ç‰¹å®šå‚æ•°çš„ç›®æ ‡ã€‚","like_count":0,"discussions":[{"author":{"id":1809833,"avatar":"https://static001.geekbang.org/account/avatar/00/1b/9d/a9/4602808f.jpg","nickname":"é»„ä½³","note":"","ucode":"8EC41D2EAB0E3C","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":628528,"discussion_content":"å¥½é—®é¢˜å•Šï¼ŒåŒå­¦ã€‚é©¬ä¸Šå°±è®²Agentäº†ã€‚è¿™æ˜¯LangChainçš„ç²¾é«“ã€‚\nä½ éœ€è¦Passå¤šä¸ªå·¥å…·ç»™Chainï¼Œç„¶åLLMè¦åˆ†è§£Taskï¼Œéœ€è¦æ¨ç†å‡ºå…ˆåšä»€ä¹ˆååšä»€ä¹ˆã€‚\n1. æ€è€ƒ1 - å…ˆåšNERï¼Œè§£æå‡ºç›®çš„åœ°å’Œå‡ºå‘åœ°ã€‚\n2. è¡ŒåŠ¨1 - è°ƒç”¨å¦å¤–ä¸€ä¸ªLLMï¼ŒåšNERï¼Œæ‹¿ç»“æœ\n3. æ‹¿åˆ°æ€è€ƒ1çš„ç»“æœï¼Œè¿›è¡Œè§‚å¯Ÿã€‚\n4. æ€è€ƒ2 - æŠŠæ€è€ƒ1çš„ç»“æœPassç»™ç¬¬äºŒä¸ªå·¥å…·ã€‚è¿™ä¸ªå·¥å…·é€‰æ‹©æ˜¯é«˜å¾·åœ°å›¾\n5. è¡ŒåŠ¨2\nã€‚ã€‚ã€‚ã€‚ã€‚\n","likes_number":2,"is_delete":false,"is_hidden":false,"ctime":1695451081,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"æ–°åŠ å¡","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":2776202,"avatar":"https://static001.geekbang.org/account/avatar/00/2a/5c/8a/244128ff.jpg","nickname":"Webber","note":"","ucode":"F9662546472FA7","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":628529,"discussion_content":"å¥½çš„ï¼Œè°¢è°¢è€å¸ˆç»™çš„æ€è·¯","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1695452081,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":"ä¸Šæµ·","group_id":0},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":388675,"user_name":"å‰å®³äº†æˆ‘çš„å›½","can_delete":false,"product_type":"c1","uid":1052191,"ip_address":"ä¸Šæµ·","ucode":"CD0A54A1B998AA","user_header":"https://static001.geekbang.org/account/avatar/00/10/0e/1f/d0472177.jpg","comment_is_top":false,"comment_ctime":1710662990,"is_pvip":false,"replies":null,"discussion_count":0,"race_medal":0,"score":3,"product_id":100617601,"comment_content":"langchainè¿­ä»£å¤ªå¿«ï¼Œåœ¨æœ€æ–°çš„0.1.12ç‰ˆæœ¬ä¸­ï¼Œå¯ä»¥é€šè¿‡MultiPromptChainç›´æ¥å®ç° router èƒ½åŠ›ï¼Œå…¨éƒ¨ä»£ç å¦‚ä¸‹ï¼š\n\nfrom langchain.chains.router import MultiPromptChain\nfrom langchain_openai import ChatOpenAI\n\nflower_care_template = &quot;&quot;&quot;\nä½ æ˜¯ä¸€ä½ç»éªŒä¸°å¯Œçš„å›­ä¸ï¼Œæ“…é•¿è§£ç­”å…³äºå…»èŠ±è‚²èŠ±çš„é—®é¢˜ï¼Œä¸‹é¢æ˜¯éœ€è¦ä½ æ¥å›ç­”çš„é—®é¢˜ï¼š{input}\n&quot;&quot;&quot;\n\nflower_deco_template = &quot;&quot;&quot;\nä½ æ˜¯ä¸€ä½ç½‘çº¢æ’èŠ±å¤§å¸ˆï¼Œæ“…é•¿è§£ç­”å…³äºé²œèŠ±è£…é¥°çš„é—®é¢˜ï¼Œä¸‹é¢æ˜¯éœ€è¦ä½ æ¥å›ç­”çš„é—®é¢˜ï¼š{input}\n&quot;&quot;&quot;\n\nprompt_infos = [\n    {\n        &quot;name&quot;: &quot;flower_care&quot;,\n        &quot;prompt_template&quot;: flower_care_template,\n        &quot;description&quot;: &quot;é€‚åˆå›ç­”å…³äºé²œèŠ±æŠ¤ç†çš„é—®é¢˜&quot;\n    },\n    {\n        &quot;name&quot;: &quot;flower_deco&quot;,\n        &quot;prompt_template&quot;: flower_deco_template,\n        &quot;description&quot;: &quot;é€‚åˆå›ç­”å…³äºé²œèŠ±è£…é¥°çš„é—®é¢˜&quot;\n    }\n]\n\nllm = ChatOpenAI()\nrouter_chain = MultiPromptChain.from_prompts(llm=llm, prompt_infos=prompt_infos, verbose=True)\nprint(router_chain.invoke({&quot;input&quot;: &quot;å¦‚ä½•ä¸ºç«ç‘°èŠ±æµ‡æ°´?&quot;}))\n\n","like_count":2},{"had_liked":false,"id":393136,"user_name":"yanyu-xin","can_delete":false,"product_type":"c1","uid":1899757,"ip_address":"å¹¿ä¸œ","ucode":"3AA389F9E4C236","user_header":"","comment_is_top":false,"comment_ctime":1722949082,"is_pvip":false,"replies":null,"discussion_count":0,"race_medal":0,"score":3,"product_id":100617601,"comment_content":"ç”¨é˜¿é‡Œäº‘çš„é€šä¹‰å¤§æ¨¡å‹ä»£æ›¿OpenAI ,ä¹Ÿé¡ºåˆ©å®ŒæˆRouterChainç¡®å®šå®¢æˆ·æ„å›¾çš„ä»£ç ç»ƒä¹ ã€‚\nâ€”â€”\n# æ—§ä»£ç ï¼š\n# åˆå§‹åŒ–è¯­è¨€æ¨¡å‹\nfrom langchain.llms import OpenAI\nllm = OpenAI()\nâ€”â€”\n# æ–°ä»£ç ï¼š\n# ç”¨é˜¿é‡Œäº‘çš„å¤§è¯­è¨€æ¨¡å‹\nfrom langchain_community.llms import Tongyi\nDASHSCOPE_API_KEY = &quot; API_KEY&quot;  # # è®¾ç½®APIå¯†é’¥ï¼Œç”¨ä½ çš„ DASHSCOPE_API_KEY ä»£æ›¿\nllm = Tongyi(dashscope_api_key=DASHSCOPE_API_KEY)","like_count":1},{"had_liked":false,"id":392498,"user_name":"å¼ ç”³å‚²","can_delete":false,"product_type":"c1","uid":1182372,"ip_address":"åŒ—äº¬","ucode":"22D46BC529BA8A","user_header":"https://static001.geekbang.org/account/avatar/00/12/0a/a4/828a431f.jpg","comment_is_top":false,"comment_ctime":1721109066,"is_pvip":false,"replies":null,"discussion_count":0,"race_medal":2,"score":3,"product_id":100617601,"comment_content":"ç¬¬9è®²æ‰“å¡~\nLangChainå†…ç½®äº†å¾ˆå¤šåŠŸèƒ½ä¸°å¯Œçš„Chainï¼Œæ˜¯ä¸ªå®è—é›†åˆ~","like_count":1},{"had_liked":false,"id":388763,"user_name":"Geek_e74222","can_delete":false,"product_type":"c1","uid":3864625,"ip_address":"æ¹–åŒ—","ucode":"61626A4620E761","user_header":"","comment_is_top":false,"comment_ctime":1710833532,"is_pvip":false,"replies":null,"discussion_count":0,"race_medal":0,"score":3,"product_id":100617601,"comment_content":"è€å¸ˆä½ å¥½ï¼Œæˆ‘é€šè¿‡æœ¬åœ°éƒ¨ç½²chatglm3-6bæ¥å®ç°äº†æœ¬æ¬¡è¯¾ç¨‹ä¸­çš„ä¾‹å­ï¼Œä½†æ˜¯å¾ˆå¥‡æ€ªï¼Œæ— è®ºæˆ‘çš„è¾“å…¥æ˜¯å¦è·Ÿæˆ‘ä»¬çš„æç¤ºæ¨¡æ¿ç›¸å…³ï¼Œå®ƒæ€»æ˜¯ä¼šé€‰æ‹©ç›®æ ‡é“¾ä¸­çš„ä¸€ä¸ªå»è°ƒç”¨ï¼Œè€Œä¸æ˜¯è°ƒç”¨default_chain,è¿™è·Ÿæˆ‘çš„promptå†…å®¹ç›¸å…³å—ï¼Ÿè¿˜æ˜¯è¯´è·Ÿå¤§æ¨¡å‹çš„èƒ½åŠ›ç›¸å…³å‘¢ï¼Ÿå¸Œæœ›æ‚¨èƒ½è§£ç­”ï¼Œæ„Ÿè°¢ï¼","like_count":1},{"had_liked":false,"id":394374,"user_name":"åˆ˜åŒè£","can_delete":false,"product_type":"c1","uid":3870283,"ip_address":"åŒ—äº¬","ucode":"FB42C207F24A18","user_header":"https://static001.geekbang.org/account/avatar/00/3b/0e/4b/ff4a21de.jpg","comment_is_top":false,"comment_ctime":1726651751,"is_pvip":false,"replies":null,"discussion_count":0,"race_medal":0,"score":3,"product_id":100617601,"comment_content":"routerChain ","like_count":0},{"had_liked":false,"id":388769,"user_name":"Jason Lee","can_delete":false,"product_type":"c1","uid":3867398,"ip_address":"æ±Ÿè‹","ucode":"BAC70C20234F98","user_header":"https://static001.geekbang.org/account/avatar/00/3b/03/06/791d0f5e.jpg","comment_is_top":false,"comment_ctime":1710842528,"is_pvip":false,"replies":null,"discussion_count":0,"race_medal":0,"score":4,"product_id":100617601,"comment_content":"ConversationChainå’ŒLLMChainéƒ½æœ‰memoryæˆå‘˜å˜é‡ï¼Œéƒ½èƒ½ä¿æŒä¸Šä¸‹æ–‡ã€‚\næºç ä¸ŠConversationChain extends LLMChainã€‚\nåŒºåˆ«æ˜¯ ConversationChainåœ¨LLMChainåŸºç¡€ä¸Šæ‰©å±•äº†ä¸€ä¸ªlc_nameé™æ€å±æ€§ã€‚","like_count":0},{"had_liked":false,"id":388737,"user_name":"å­é£é±¼","can_delete":false,"product_type":"c1","uid":1201744,"ip_address":"å¹¿ä¸œ","ucode":"0C7BCDB9424AC8","user_header":"https://static001.geekbang.org/account/avatar/00/12/56/50/f54bd646.jpg","comment_is_top":false,"comment_ctime":1710807616,"is_pvip":false,"replies":null,"discussion_count":0,"race_medal":0,"score":4,"product_id":100617601,"comment_content":"è€å¸ˆä½ å¥½ï¼Œæˆ‘æƒ³é—®ä¸€ä¸‹ä¸Šé¢çš„ç¤ºä¾‹ï¼Œå¦‚æœç›´æ¥æŠŠinputä¸¢ç»™llmï¼Œä¸Šè¿°ä¸‰ç§inputåº”è¯¥ä¹Ÿèƒ½ç»™å‡ºä¸åŒçš„å›ç­”å§ã€‚è¯·é—®è·¯ç”±é“¾çš„æœ€ä½³ä½¿ç”¨åœºæ™¯æ˜¯ä»€ä¹ˆå‘¢","like_count":0},{"had_liked":false,"id":388427,"user_name":"Longerian","can_delete":false,"product_type":"c1","uid":1032464,"ip_address":"æµ™æ±Ÿ","ucode":"0B74EE70D09A2A","user_header":"https://static001.geekbang.org/account/avatar/00/0f/c1/10/28d5a686.jpg","comment_is_top":false,"comment_ctime":1710165741,"is_pvip":false,"replies":null,"discussion_count":0,"race_medal":0,"score":4,"product_id":100617601,"comment_content":"æ€è€ƒé¢˜2:\n# ç”¨LLMChainä»£æ›¿ ConversationChain\nfrom langchain.prompts import PromptTemplate\n# åŸå§‹å­—ç¬¦ä¸²æ¨¡æ¿\ntemplate = &quot;&quot;&quot;\nThe following is a friendly conversation between a human and an AI. The AI is talkative and provides lots of specific details from its context. If the AI does not know the answer to a question, it truthfully says it does not know.\n\nCurrent conversation:\n\nHuman: {input}\nAI:\n&quot;&quot;&quot;\n# åˆ›å»ºLangChainæ¨¡æ¿\nprompt_temp = PromptTemplate.from_template(template)\ndefault_chain = LLMChain(\n    llm=llm,\n    prompt=prompt_temp)","like_count":0},{"had_liked":false,"id":387765,"user_name":"æ´‹","can_delete":false,"product_type":"c1","uid":1378913,"ip_address":"åŒ—äº¬","ucode":"863193F96C0E81","user_header":"https://static001.geekbang.org/account/avatar/00/15/0a/61/ff5549d1.jpg","comment_is_top":false,"comment_ctime":1708561307,"is_pvip":false,"replies":null,"discussion_count":0,"race_medal":0,"score":4,"product_id":100617601,"comment_content":"æœ€æ–°ç‰ˆè¿˜ç”¨è¿™æ ·å†™å—ï¼Œæ€ä¹ˆç”¨LCELå®ç°","like_count":0},{"had_liked":false,"id":386985,"user_name":"Geek_1b01a0","can_delete":false,"product_type":"c1","uid":3816020,"ip_address":"è¾½å®","ucode":"206B6A87B6E7B2","user_header":"","comment_is_top":false,"comment_ctime":1706078967,"is_pvip":false,"replies":null,"discussion_count":1,"race_medal":0,"score":4,"product_id":100617601,"comment_content":"SequentialChainå’ŒRouterChainå¯ä»¥ç»“åˆä½¿ç”¨å—","like_count":0,"discussions":[{"author":{"id":2635514,"avatar":"https://static001.geekbang.org/account/avatar/00/28/36/fa/b10c84fd.jpg","nickname":"å‹‡å¾€ç›´å‰ï¼","note":"","ucode":"5A097AF1507092","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":637940,"discussion_content":"åŒé—®\n","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1709125684,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":"åŒ—äº¬","group_id":0},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]}]}