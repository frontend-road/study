{"id":320675,"title":"15 | 平台：智能家居开源平台的生态是怎样的？","content":"<p>你好，我是郭朝斌。</p><p>在学完了这门课程的前十几讲之后，你已经对物联网有了一个从整体到细节的全面了解。我想，你现在应该迫不及待地想要动手实践了吧？</p><p>在正式进入实战篇之前，我想以智能家居领域为例，带你了解一下开源平台。</p><h2>智能家居：生态开放</h2><p>为什么选择智能家居这个领域呢？最重要的原因当然是因为实战篇的动手项目是智能家居领域的。而另一个原因是，智能家居的生态环境比较开放，很有活力，而且也更贴近我们的日常生活。</p><p>在<a href=\"https://time.geekbang.org/column/article/313631\">第9讲</a>，我提到过和工业物联网相关的一些开源项目。相比之下，工业物联网领域更加封闭，如果不是行业从业人员，你很难理解它的功能需求。</p><p>那么，什么是平台，平台有什么用呢？就拿智能家居平台来说好了，它给各种智能家居产品提供了一个<strong>统一的接入系统</strong>，让用户可以<strong>管理</strong>和<strong>控制</strong>产品，同时也为各种智能家居产品之间的<strong>联动</strong>提供了条件。</p><p>如果没有智能家居平台，那么各种智能家居产品就是一个个孤立的单品，既不能远程控制，也不能实现联动功能。</p><p>如果你买过小米的智能产品，应该接触过小米的米家平台，它就是一个典型的智能家居平台。国内类似的还有阿里巴巴的天猫精灵、京东微联和海尔U+等。国外知名的智能家居平台有苹果的Apple HomeKit、亚马逊的Amazon Echo和谷歌的Google Home等。</p><!-- [[[read_end]]] --><h2>开源平台：方便定制</h2><p>不过，刚才提到的这些都是商业公司运营的平台，它们使用的技术和通信协议都是公司制定的，能够选择的产品也只能是已经接入平台的产品。作为开发实践者，我们可以定制的部分非常少。</p><p>所以在这一讲，我想介绍一下智能家居的开源平台生态。</p><p>一方面，开源平台能为你提供一个现成的基础，你可以在这个基础上快速地搭建出自己的智能家居系统。而且这些平台不但可以提供丰富的特性，一般也会提供各种定制能力，方便你基于自己的需求灵活地调整。</p><p>另一方面，就算你在工作中不直接使用这些开源平台，你也可以从它们的架构设计和实现逻辑中汲取灵感。</p><p>在介绍完智能家居的开源生态之后，我还会选择其中一个开源平台，带你在树莓派开发板上运行起来，这样你也可以初步体验一下智能家居软件。</p><h2>热度比较高的开源平台</h2><p>那么你觉得智能家居的开源平台多吗？我告诉你，其实非常多。这也从侧面反映出智能家居是一个非常被看好的领域。</p><p>在这一讲中，把所有的开源项目都讲一遍是不现实的，所以我精心挑选了5个热度比较高的项目介绍，供你参考。</p><ol>\n<li>\n<h4>Home Assistant</h4>\n</li>\n</ol><p>首先要说的就是<a href=\"https://www.home-assistant.io/\">Home Assistant</a>。由于支持丰富的硬件和软件组件，能够实现自由灵活的配置和定制开发，所以它是现在热度最高的开源平台。大量极客用户组成了庞大而活跃的社群，他们贡献了很多基于Home Assistant的开源组件和丰富的使用资料。</p><p>这些组件要怎么配置呢？在Home Assistant中，你需要通过configuration.yaml配置文件来定义你需要使用的组件以及组件之间的联动方式等。</p><p>从文件的扩展名你应该可以看出，它的配置文件使用的是<a href=\"https://yaml.org/\">YAML语言</a>。这种语言是专门为配置文件设计的，写起来比JSON要简单得多。</p><p>另外，Home Assistant是基于Python 3语言实现的，理论上支持在任何有Python 3的系统环境中运行，当然也包括树莓派。它对于树莓派的支持非常好。</p><p>虽然是开源软件，但是我们也需要注意开源许可协议。Home Assistant的代码采用的是<a href=\"https://github.com/home-assistant/core/blob/master/LICENSE.md\">Apache License 2.0</a>协议。</p><ol start=\"2\">\n<li>\n<h4>Domoticz</h4>\n</li>\n</ol><p>第2个要讲的是<a href=\"https://www.domoticz.com/\">Domoticz</a>，它是一个开源的家居自动化平台，可以帮你实现对智能家居设备和传感器的控制和监测等目的。除了它原生支持的设备，你还可以使用很多开源插件。当然，你也可以选择用Python语言开发自己的插件，从而支持自己特有的设备。</p><p>Domoticz主要是通过Web界面来进行自定义和配置。它还同时提供了iOS和Android两大系统的App供你查看和控制设备。</p><p>Domoticz是基于C++语言开发的。跟Python语言开发的软件不同，它还需要编译不同的安装包，这显然不够方便。不过，Domoticz官方已经为Windows和Linux系统准备了二进制安装包，包括使用ARM架构芯片的树莓派，也已经有了编译好的可执行文件。</p><p>Domoticz代码采用的是<a href=\"https://github.com/domoticz/domoticz/blob/master/License.txt\">GNU General Public License v3.0</a>（GPLv3）开源协议。</p><ol start=\"3\">\n<li>\n<h4>openHAB</h4>\n</li>\n</ol><p>第3个要讲的是openHAB。它的出发点是提供一个家庭自动化的总线，所以在设计上尽量抽象而模糊设备本身，便于你根据需求添加设备和插件。在openHAB中，插件是通过Bindings来实现设备和openHAB内核的交换信息的。</p><p>交互界面方面，openHAB也提供了丰富的选择，包括原生的iOS和Android平台的App以及Web页面和Windows 10应用程序等。</p><p>openHAB是基于Java语言开发的。除了常见的电脑平台，它还支持用Docker镜像的方式安装使用。另外，它还专门提供了openHABian系统的镜像文件，所以在树莓派上使用openHAB软件是非常方便的。</p><p>openHAB代码采用的是<a href=\"https://github.com/openhab/openhab-core/blob/master/LICENSE\">Eclipse Public License 2.0</a>开源协议。</p><ol start=\"4\">\n<li>\n<h4>Gladys Assistant</h4>\n</li>\n</ol><p>第4个要讲的是<a href=\"https://gladysassistant.com/en/\">Gladys Assistant</a>。它是一个刚刚重新设计和开发的智能家居平台。它原生支持Z-Wave、MQTT和小米等设备接口，并且在平台中嵌入了自己的 NLP（自然语言处理）对话引擎。你可以在平台上定义复杂的场景模式。</p><p>Gladys Assistant的主要交互界面是Web页面。不过这些Web界面在手机上的体验也非常好，因为它是基于PWA（Progressive Web App）实现的。PWA技术使Web应用在手机的体验基本和原生App一致。</p><p>Gladys Assistant使用JavaScript语言实现的。它对于树莓派的支持非常不错，提供了基于Raspbian的系统镜像。另外，通过Docker的方式对MacOS和Windows系统也提供了支持。</p><p>Gladys Assistant代码采用的是 <a href=\"https://github.com/GladysAssistant/Gladys/blob/master/LICENSE\">Apache License 2.0</a>开源协议。</p><ol start=\"5\">\n<li>\n<h4>WebThingsIO</h4>\n</li>\n</ol><p>不知道你是否还记得，我在加餐的书单推荐中提到过<a href=\"https://www.w3.org/WoT/\">WoT</a>标准。这里我要介绍的<a href=\"https://iot.mozilla.org/\">WebThingsIO</a>项目正是Mozilla在领导开发的一个基于WoT理念的开源实现。</p><p>其中，WebThings Gateway是一个智能家居网关软件（也就是控制中心）实现，你可以使用它提供的Web界面来实现对设备的查看和控制。它也支持定义联动的规则，还提供了用插件方式来扩展对其他设备的支持。</p><p>WebThings Gateway主要是使用JavaScript语言实现的。它为树莓派专门制作了系统镜像文件，你可以直接烧录使用。对于常用的Linux系统，也可以直接通过软件包管理器安装使用。</p><p>WebThings Framework是一个软件组件集合，你可以基于这些组件来开发支持<a href=\"https://iot.mozilla.org/wot/\">Web Thing API</a>的硬件设备。它有不同的编程语言实现，包括Node.js、Python（包括MicroPython）、Java、Rust、C++（Arduino实现）。</p><p>WebThingsIO的代码采用的是<a href=\"https://github.com/WebThingsIO/gateway/blob/master/LICENSE\">Mozilla Public License 2.0</a>开源协议。</p><p>这里，我把这5个开源的智能家居平台的特性总结为一个表格，方便你随时参考。</p><p><img src=\"https://static001.geekbang.org/resource/image/3f/6a/3f957676a982afacb7619925ed19986a.jpg?wh=2700*1342\" alt=\"\"></p><h2>Gladys Assistant具体使用：动手实践</h2><p>这5个比较有代表性的智能家居开源平台，对于树莓派的支持都不错的。现在，我们就开始动手，在树莓派上安装一个开源平台，体验一下通过智能家居系统监测设备数值的过程。</p><p>使用哪个平台呢？我们就选择Gladys Assistant吧。它的优势是Web页面在手机上体验不错，不需要你去搜索或者编译手机上的App了。</p><p>其他几个开源平台的安装和使用方法都差不多。你掌握了一个，那么利用镜像文件安装其他几个也不成问题。</p><h3>第一步：准备器材</h3><p>首先我介绍一下需要准备的器材有哪些：</p><ol>\n<li><strong>树莓派Raspberry Pi 4B</strong>，要求内存2GB以上，但是8GB内存版本要谨慎选择，因为有些开源平台软件对Arm 64bit芯片支持不够好。</li>\n<li><strong>供电电源</strong>，要求支持3A以上电流。</li>\n<li><strong>Micro SD卡</strong>，也叫TF卡，存储容量最好在16GB以上。在选择的时候，你要关注读写速度等级，比如U3表示最低写入速度是30MB/s。同时你也要关注<a href=\"https://www.sdcard.org/chs/developers/overview/application/index.html\">应用性能等级</a>，它定义了Micro SD卡进行随机读写的性能，最好是选择Application Performance Class 2（卡面上标识A2图标）。在卡上存储应用程序和应用程序数据时，这个性能指标非常重要。</li>\n</ol><p><img src=\"https://static001.geekbang.org/resource/image/f4/66/f4928d8a87bde8b4e235b8cdf057d266.jpg?wh=2700*1025\" alt=\"\"></p><ol start=\"4\">\n<li><strong>Micro SD卡读卡器</strong>。有些电脑自带这个接口，如果没有的话，你可以买一个便宜的使用。</li>\n<li><strong>普通网线</strong>。如果你希望以有线的方式使用树莓派，可以准备一根。同时，我也会介绍树莓派接入Wi-Fi的方式。</li>\n</ol><h3>第二步：烧录系统镜像</h3><p>树莓派板子在启动的时候，会从SD卡读取操作系统镜像文件，完成操作系统的引导启动工作。所以我们接下来要在SD卡上烧录系统镜像。</p><p>具体怎么烧录呢？我们可以使用一个免费的烧录工具，<strong>Etcher</strong>。它支持MacOS、Windows和Linux三种主流的电脑系统，你可以从<a href=\"https://etcher.io/\">官方网站</a>上下载和安装。也可以点击<a href=\"https://github.com/balena-io/etcher/releases\">这个链接</a>下载最新版。</p><p>然后，下载树莓派的系统镜像文件。树莓派有官方的操作系统镜像 Raspbian可以选择，但是为了避免手动在 Raspbian系统中安装 Gladys Assistant 软件的麻烦，我们直接选择官方提供的已经配置好Gladys Assistant的Raspbian镜像文件。</p><p>从<a href=\"https://cdn.elephantcdn.com/gh/gladysassistant/gladys/releases/download/v4.0.0/gladys-4.0.0-rev3.img.zip\">这个链接</a>中下载好镜像文件，并且解压缩得到\"img\"扩展名的文件。然后把Micro SD卡插入读卡器，或者直接插入你的电脑接口中。运行Etcher软件，按照步骤把镜像文件烧录到存储卡中。</p><p><img src=\"https://static001.geekbang.org/resource/image/1b/73/1bcbb300760c8febe63898a0174c3273.png?wh=1592*954\" alt=\"\"></p><p>树莓派支持网线接口，不过，如果你希望树莓派接入家里的Wi-Fi热点，而不是使用网线访问网络，那么就需要在Micro SD卡中增加一个配置文件。</p><p>这个配置文件的文件名必须是wpa_supplicant.conf。你可以在电脑上使用自己熟悉的文本编辑器创建这个文件，并且在文件中输入下面的内容：</p><pre><code>ctrl_interface=DIR=/var/run/wpa_supplicant GROUP=netdev\nupdate_config=1\ncountry=CN\n\n\nnetwork={\n ssid=&quot;你的Wi-Fi热点SSID名称&quot;\n psk=&quot;你的Wi-Fi热点密码&quot;\n key_mgmt=WPA-PSK\n}\n</code></pre><p>注意，将Wi-Fi热点的SSID和密码替换为你家里的Wi-Fi路由器的真实情况。</p><p>然后将这个文件拷贝到Micro SD卡的根目录。这时，你就可以把Micro SD卡插入树莓派开发板了。</p><h3>第三步：启动系统</h3><p>烧录好镜像文件，准备好Micro SD卡后，你可以把Micro SD卡从读卡器取出，插入树莓派的对应接口中。</p><p>接着，接上电源线（如果你使用网线方式，记得也将网线接入树莓派板的网口上）。这时树莓派将自动启动运行，需要等待一段时间。</p><p>过一会儿之后，在你的电脑上，打开浏览器，输入 \"<a href=\"http://gladys.local\">http://gladys.local</a>\" 来访问树莓派上的Gladys Assistant系统，如下图所示。</p><p>如果你使用的电脑系统是比较老的Windows版本，可能无法通过这种方式访问树莓派，而是需要将“gladys.local”替换为树莓派的IP地址。</p><p>怎么获取到树莓派的IP地址呢？你可以使用一些网络分析软件，比如Android手机上安装Network Scanner，iOS手机上安装iNet来扫描网络。</p><p><img src=\"https://static001.geekbang.org/resource/image/60/cf/600490ac2f908cb13ce81b379a8fdacf.png?wh=2140*1136\" alt=\"\"></p><p>那么，为什么不给树莓派接一个显示器，而要通过你的电脑上的浏览器来访问呢？这是因为Gladys Assistant 为了简化镜像，没有提供可视化的桌面环境。其实你只要熟悉了操作方法，就会发现这样的设计是非常方便的，因为你不需要为树莓派再准备个显示器了。</p><h3>第四步：在Gladys Assistant上添加设备</h3><p>因为我们是第一次配置Gladys Assistant，所以要在上面的页面中选择“Create local account with your Email”，来创建一个本地账号。</p><p>创建完账号后，其他的步骤不是必填项，你根据喜好填写就行了。房屋配置部分，你可以创建一个名称为bedroom的房间，后面会用到。最后，你应该可以看到这个Dashboard页面。</p><p><img src=\"https://static001.geekbang.org/resource/image/14/3a/14de681771577c2b8d56fc3590f12d3a.png?wh=2620*1190\" alt=\"\"></p><p>接下来，我们来添加一个设备，来体验一下Gladys Assistant的功能。</p><p>那么，添加什么设备呢？我们还没有讲到实战篇的具体项目呢。不过，我们可以用电脑来模拟一个设备。你还记得第8讲介绍的MQTT协议吗？Gladys Assistant系统支持MQTT通信协议的设备。所以，我们可以通过电脑终端的命令行来模拟一个设备，发送MQTT消息给Gladys Assistant，让Gladys Assistant来展示这个设备。</p><p>首先，我们在Gladys Assistant上准备MQTT Broker。选择Dashboard 上部的标签页“Integrations”，点击MQTT标签。</p><p><img src=\"https://static001.geekbang.org/resource/image/a2/ab/a2f23d7ce6f2e95d557dce9c93481dab.png?wh=2636*1442\" alt=\"\"></p><p>进入MQTT设置界面后，你现在需要点击左边的Setup，开始安装MQTT Broker。我们通过默认选项，即使用Docker的方式来完成。</p><p><img src=\"https://static001.geekbang.org/resource/image/ce/1a/ce2016b8d4ee5ed95e91856a04f44d1a.png?wh=2634*1026\" alt=\"\"></p><p>这个过程需要几分钟时间。完成后，你就可以看到MQTT Broker的用户名和密码。我将密码改成了geektimetest，为了便于记忆，你也可以选择一个自己的密码。同时，你需要将用户名和密码记录下来，因为后面模拟设备发送MQTT消息时会用到。</p><p><img src=\"https://static001.geekbang.org/resource/image/52/89/52d0ccc87753ea79c670d8d5b798dd89.png?wh=2656*1334\" alt=\"\"></p><p>接着，我们点击左边的Device，切换到MQTT设备页面。点击右上角的New打开创建页面。设备名称我们可以选择Temperature Sensor，External ID填写mqtt:bedroom:temperature-sensor。字符串中bedroom是和下一项房间填写的信息一致的。</p><p><img src=\"https://static001.geekbang.org/resource/image/55/d6/554e038f3a7a7f8e2bbd3c14632269d6.png?wh=2622*1410\" alt=\"\"></p><p>然后，我们为设备添加特性（Features）。这里，我们选择Temperature 类型。</p><p><img src=\"https://static001.geekbang.org/resource/image/e8/db/e8f806569bf36852abe3712c6fed5fdb.png?wh=2150*1014\" alt=\"\"></p><p>选择完类型后，我们点击Add feature，开始设置具体的特性参数。你可以按照下图的内容来设置自己的参数。其中，external ID填写mqtt:bedroom:temperature-sensor:temperature字符串。最下面的MQTT Topic，你需要记录下来，后面发送消息时需要用到。</p><p><img src=\"https://static001.geekbang.org/resource/image/a0/ae/a03735551ee3e3124131169c1b4d60ae.png?wh=1568*1636\" alt=\"\"></p><p>点击下部的保存（Save）和返回（Back），然后我们可以看到创建完成的MQTT设备。</p><p><img src=\"https://static001.geekbang.org/resource/image/cc/e2/cc37b26e8d548465a4c3aa1dba87a1e2.png?wh=2636*1414\" alt=\"\"></p><p>在模拟发送MQTT消息之前，我们还需要编辑一下Dashboard界面。你需要点击左上角切换回Home标签页，然后点击右上角的Edit按键。在编辑界面的Column 1 选择Devices in room类别。然后依次选择bedroom和我们刚创建的设备Temperature Sensor传感器。</p><p><img src=\"https://static001.geekbang.org/resource/image/2e/9e/2e2bd7fyyaa7ba7b7eb79026db90f89e.png?wh=1172*1308\" alt=\"\"></p><p>点击页面右下角的Save，保存Dashboard的编辑界面。</p><p><img src=\"https://static001.geekbang.org/resource/image/16/07/16ca1f18eb80eb0fd2efd37d04a49c07.png?wh=2632*658\" alt=\"\"></p><p>当然，现在传感器没有数值显示。</p><h3>第五步：模拟MQTT设备</h3><p>接下来，我们打开一个终端命令窗口，输入下面的命令：</p><pre><code>hbmqtt_pub -d --url mqtt://gladys:geektimetest@gladys.local:1883 -t gladys/master/device/mqtt:bedroom:temperature-sensor/feature/mqtt:bedroom:temperature-sensor:temperature/state -m 25.2\n</code></pre><p>其中，gladys:geektimetest是用户名和密码，它们以分号相连。gladys.local是树莓派的域名。-t后面的消息主题就是你刚才记录的MQTT Topic字符串。-m后面是温度数值。</p><p>执行这个命令后，你再打开Gladys Assistant的Dashboard界面，这时你就可以看到设备卡片显示出来了刚才发送的温度数值。</p><p><img src=\"https://static001.geekbang.org/resource/image/c9/4d/c931174c7c4dd9cafde673ee795bf24d.png?wh=2568*658\" alt=\"\"></p><h2>小结</h2><p>总结一下，在这一讲中，我介绍了智能家居开源平台的生态，并且带你动手在树莓派上安装了Gladys Assistant，然后体验了一下使用过程。</p><ol>\n<li>智能家居平台为各种智能家居产品提供了一个统一的接入系统，让用户可以管理和控制产品，同时也为各种智能家居产品之间的联动提供了条件。</li>\n<li>了解开源的智能家居平台有两大好处，一是你可以基于它们快速地搭建智能家居系统，另一个是你可以在工作中借鉴它们的设计思想和架构。</li>\n<li>开源的智能家居平台有很多，热度比较高的平台有5个，分别是Home Assistant、Domoticz、openHAB、Gladys Assistant 和WebThingsIO。</li>\n<li>利用开源平台，在树莓派开发板上搭建智能家居系统的一般步骤包括：准备器材，烧录系统镜像，启动系统，添加设备，接收和显示设备信息等。</li>\n</ol><p>在实战篇，等你掌握了开发智能硬件的基本方法，可以将这一讲中的模拟设备替换为真实的温度传感器设备。期待你的动手实践。</p><p>而且之后，等你熟悉树莓派开发板的使用方法，你也可以在树莓派上尝试一下其它几个开源平台。它们的基本功能都比较接近，你可以根据自己喜好，或者熟悉的编程语言选择。</p><h2>思考题</h2><p>最后，我给你留一个思考题吧。</p><p>在这一讲的动手实验环节，我们是通过访问<a href=\"http://gladys.local\">http://gladys.local</a> 来查看Gladys Assistant的Dashboard等Web应用界面的。为什么我们可以通过gladys.local 域名来访问树莓派开发板呢？为什么有的老版本电脑系统不支持呢？这是使用了什么网络协议？</p><p>欢迎你在留言区写一写自己的答案，也欢迎你将这一讲分享给对智能家居 DIY感兴趣的朋友，大家一起交流学习。</p>","neighbors":{"left":{"article_title":"14 | 安全：物联网平台如何应对安全风险？","id":319440},"right":{"article_title":"16 | 实战准备：如何搭建硬件开发环境？","id":321652}},"comments":[{"had_liked":false,"id":267830,"user_name":"Garwen","can_delete":false,"product_type":"c1","uid":1045062,"ip_address":"","ucode":"C76346E1734AB8","user_header":"https://static001.geekbang.org/account/avatar/00/0f/f2/46/09c457eb.jpg","comment_is_top":false,"comment_ctime":1607947452,"is_pvip":false,"replies":[{"id":"99487","content":"赞👍<br>关键词mDNS","user_name":"作者回复","user_name_real":"郭朝斌","uid":"2302171","ctime":1610865403,"ip_address":"","comment_id":267830,"utype":1}],"discussion_count":1,"race_medal":0,"score":"61737489596","product_id":100063601,"comment_content":"gladys.local作为一个在局域网内部生效的域名，首先肯定是域名解析器解析到了其局域网内部ip地址才可能路由成功。那就是说树莓派在完成安装gladys后，要向其他同局域网内的设备传递自己的域名和ip的对应关系，然后才能被对应设备的DNS记录缓存。那本地访问时首先通过dns缓存查询到了ip地址就可以完成访问，老系统电脑不支持的情况应该是在系统中不支持更新本地dns缓存的协议。以下是在网上搜集到资料：<br>每个进入局域网的主机，如果开启了mDNS服务的话，都会向局域网内的所有主机组播一个消息，我是谁，和我的IP地址是多少。然后其他也有该服务的主机就会响应，也会告诉你，它是谁，它的IP地址是多少。mDNS的域名与普通DNS的域名是通过后缀.local区分开来的。如果一台终端需要访问一个mDNS域名，他就会向局域网内发送组播，询问该域名的IP是多少。","like_count":14,"discussions":[{"author":{"id":2302171,"avatar":"https://static001.geekbang.org/account/avatar/00/23/20/db/b04f43dc.jpg","nickname":"郭朝斌","note":"","ucode":"2969986E1B3851","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":511760,"discussion_content":"赞👍\n关键词mDNS","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1610865403,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":302760,"user_name":"ホシゾラ","can_delete":false,"product_type":"c1","uid":2661934,"ip_address":"","ucode":"40F9FF449F9FA4","user_header":"https://static001.geekbang.org/account/avatar/00/28/9e/2e/b14e4617.jpg","comment_is_top":false,"comment_ctime":1626355902,"is_pvip":false,"discussion_count":1,"race_medal":0,"score":"31691126974","product_id":100063601,"comment_content":"&quot;&quot;&quot;<br>课程里使用的 hbmqtt 库太久没有维护，所以不支持新版本的 websockets 库<br>所以我选择使用 paho-mqtt 模块来实现 MQTT 的收发消息<br>使用 `pip install paho-mqtt` 命令来安装该库<br>下面是实现简单发送温度信息的代码，我也加了注释说明各方法<br>&quot;&quot;&quot;<br><br>import paho.mqtt.client as mqtt<br><br>host = &quot;gladys.local&quot;  # 主机名&#47;IP地址<br>port = 1883  # 端口<br><br># 设置（自己的） topic<br>topic = &#39;gladys&#47;master&#47;device&#47;mqtt:Bedroom:temperature-sensor&#47;feature&#47;mqtt:Bedroom:temperature-sensor:temperature&#47;state&#39;<br><br># 要发送的信息，这里是温度<br>msg = &#39;25.5&#39;<br><br># 实例化客户端对象<br>client = mqtt.Client()<br><br># 设置（自己的）用户名和密码<br>client.username_pw_set(username=用户名, password=密码)<br># 连接主机<br>client.connect(host, port, 60)<br><br># 发送消息<br>client.publish(topic, msg, 0)<br><br># 在 connect() 之前或之后调用 loop_start()，会在后台运行一个线程来自动调用loop()，<br># 这释放了可能阻塞的其他工作的主线程，该调用也处理重新连接到代理。<br>client.loop_start()<br>","like_count":7,"discussions":[{"author":{"id":2573588,"avatar":"","nickname":"Geek_8b92bf","note":"","ucode":"0EED09DA79D171","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":591737,"discussion_content":"请问设备在哪里买，课程链接打不开，也不知道怎么加课程群","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1666783202,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":"广东"},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":269239,"user_name":"熊猫","can_delete":false,"product_type":"c1","uid":1080238,"ip_address":"","ucode":"23C85117A16BEF","user_header":"https://static001.geekbang.org/account/avatar/00/10/7b/ae/66ae403d.jpg","comment_is_top":false,"comment_ctime":1608564318,"is_pvip":false,"replies":[{"id":"99457","content":"也许效果更好吧，没有尝试过视频","user_name":"作者回复","user_name_real":"郭朝斌","uid":"2302171","ctime":1610860616,"ip_address":"","comment_id":269239,"utype":1}],"discussion_count":1,"race_medal":0,"score":"14493466206","product_id":100063601,"comment_content":"老师，动手多的的能否视频的形式呈现？😁","like_count":3,"discussions":[{"author":{"id":2302171,"avatar":"https://static001.geekbang.org/account/avatar/00/23/20/db/b04f43dc.jpg","nickname":"郭朝斌","note":"","ucode":"2969986E1B3851","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":512203,"discussion_content":"也许效果更好吧，没有尝试过视频","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1610860616,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":268293,"user_name":"Socrakit","can_delete":false,"product_type":"c1","uid":1335223,"ip_address":"","ucode":"41A4D7D369B3AB","user_header":"https://static001.geekbang.org/account/avatar/00/14/5f/b7/c474f406.jpg","comment_is_top":false,"comment_ctime":1608127260,"is_pvip":true,"replies":[{"id":"99477","content":"赞","user_name":"作者回复","user_name_real":"郭朝斌","uid":"2302171","ctime":1610864797,"ip_address":"","comment_id":268293,"utype":1}],"discussion_count":1,"race_medal":0,"score":"14493029148","product_id":100063601,"comment_content":"SSH 登录方式<br>主机：gladys.local<br>端口：22<br>login: pi<br>password: raspberry<br><br>新建 &#47;etc&#47;docker&#47;daemon.json 设置镜像，例如：<br>{<br>  &quot;registry-mirrors&quot;: [<br>    &quot;https:&#47;&#47;dockerhub.azk8s.cn&quot;,<br>    &quot;https:&#47;&#47;reg-mirror.qiniu.com&quot;,<br>    &quot;https:&#47;&#47;registry.docker-cn.com&quot;<br>  ]<br>}","like_count":3,"discussions":[{"author":{"id":2302171,"avatar":"https://static001.geekbang.org/account/avatar/00/23/20/db/b04f43dc.jpg","nickname":"郭朝斌","note":"","ucode":"2969986E1B3851","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":511901,"discussion_content":"赞","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1610864797,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":268064,"user_name":"贤伟","can_delete":false,"product_type":"c1","uid":1496738,"ip_address":"","ucode":"02E467263201DF","user_header":"https://static001.geekbang.org/account/avatar/00/16/d6/a2/be61c162.jpg","comment_is_top":false,"comment_ctime":1608042163,"is_pvip":false,"replies":[{"id":"99482","content":"大赞👍","user_name":"作者回复","user_name_real":"郭朝斌","uid":"2302171","ctime":1610865006,"ip_address":"","comment_id":268064,"utype":1}],"discussion_count":1,"race_medal":0,"score":"14492944051","product_id":100063601,"comment_content":"在gladys 上配置MQTT时，报错： An error occured while installing Docker container, please consult Gladys lo...<br>原因是docker pull eclipse-mosquitto 失败<br><br>可以通过ssh登录系统，修改docker的repo，比如阿里云的镜像：https:&#47;&#47;xwx6wxd1.mirror.aliyuncs.com&#47;， 手动pull 和start 镜像","like_count":3,"discussions":[{"author":{"id":2302171,"avatar":"https://static001.geekbang.org/account/avatar/00/23/20/db/b04f43dc.jpg","nickname":"郭朝斌","note":"","ucode":"2969986E1B3851","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":511832,"discussion_content":"大赞👍","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1610865006,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":267732,"user_name":"瑞泉","can_delete":false,"product_type":"c1","uid":1111565,"ip_address":"","ucode":"D38E24A98FDAE3","user_header":"https://static001.geekbang.org/account/avatar/00/10/f6/0d/e16dff4e.jpg","comment_is_top":false,"comment_ctime":1607908099,"is_pvip":false,"replies":[{"id":"99491","content":"在同一个局域网，树莓派也链接Wi-Fi。不需要设置hosts","user_name":"作者回复","user_name_real":"郭朝斌","uid":"2302171","ctime":1610865721,"ip_address":"","comment_id":267732,"utype":1}],"discussion_count":3,"race_medal":0,"score":"10197842691","product_id":100063601,"comment_content":"老师，你用其他在同一个局域网的电脑访问http:&#47;&#47;gladys.local，还是用电脑直接用网线与树莓派板子链接？文中没看到有描述，如果在同一个局域网的电脑访问，这个电脑要配置host说明域名对应的IP吧","like_count":2,"discussions":[{"author":{"id":2302171,"avatar":"https://static001.geekbang.org/account/avatar/00/23/20/db/b04f43dc.jpg","nickname":"郭朝斌","note":"","ucode":"2969986E1B3851","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":511723,"discussion_content":"在同一个局域网，树莓派也链接Wi-Fi。不需要设置hosts","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1610865721,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1617700,"avatar":"https://static001.geekbang.org/account/avatar/00/18/af/24/da70ea90.jpg","nickname":"rmliu","note":"","ucode":"083E8B5C161272","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":334625,"discussion_content":"我测试使用的是：用其他在同一个局域网的电脑访问：http://gladys.local\n\n不需要配置host。\n\n有一个平台问题是：\n1）Windows平台会访问不了，需要使用IP访问。\n2）MAC平台可以直接浏览器访问。","likes_number":2,"is_delete":false,"is_hidden":false,"ctime":1607921308,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1486568,"avatar":"https://static001.geekbang.org/account/avatar/00/16/ae/e8/d01b90c3.jpg","nickname":"种花家","note":"","ucode":"1BBBF4E10255E9","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":334734,"discussion_content":"Windows平台360浏览器IP访问不了时，谷歌浏览器可以","likes_number":1,"is_delete":false,"is_hidden":false,"ctime":1607954915,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":267720,"user_name":"刘元鹏","can_delete":false,"product_type":"c1","uid":2129923,"ip_address":"","ucode":"BB5CB8331ED276","user_header":"https://thirdwx.qlogo.cn/mmopen/vi_32/DYAIOgq83ep3GzlpfKL4gCaFJWf9t6pO9V0f9xictlNxXD1ibcVThpSsMY9edud039GKACMuS30PhnWIDxib5HPcQ/132","comment_is_top":false,"comment_ctime":1607904599,"is_pvip":false,"replies":[{"id":"99492","content":"是的","user_name":"作者回复","user_name_real":"郭朝斌","uid":"2302171","ctime":1610865741,"ip_address":"","comment_id":267720,"utype":1}],"discussion_count":1,"race_medal":0,"score":"10197839191","product_id":100063601,"comment_content":"通过mDNS广播的吗","like_count":2,"discussions":[{"author":{"id":2302171,"avatar":"https://static001.geekbang.org/account/avatar/00/23/20/db/b04f43dc.jpg","nickname":"郭朝斌","note":"","ucode":"2969986E1B3851","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":511719,"discussion_content":"是的","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1610865741,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":268717,"user_name":"sugar","can_delete":false,"product_type":"c1","uid":1167046,"ip_address":"","ucode":"454538FF253B5F","user_header":"https://static001.geekbang.org/account/avatar/00/11/ce/c6/958212b5.jpg","comment_is_top":false,"comment_ctime":1608304878,"is_pvip":false,"replies":[{"id":"99494","content":"解压zip包后，img文件的md5是什么呢","user_name":"作者回复","user_name_real":"郭朝斌","uid":"2302171","ctime":1610866061,"ip_address":"","comment_id":268717,"utype":1}],"discussion_count":2,"race_medal":0,"score":"5903272174","product_id":100063601,"comment_content":"在mac上用etcher往sd卡上烧录gladys树莓派镜像时，遇到报错说镜像损坏，换了多张sd卡、重新去官网下载了镜像（对比md5发现其实是一致的，文件并没损坏）.. 是不是只能怀疑我的读卡器坏了？","like_count":1,"discussions":[{"author":{"id":2302171,"avatar":"https://static001.geekbang.org/account/avatar/00/23/20/db/b04f43dc.jpg","nickname":"郭朝斌","note":"","ucode":"2969986E1B3851","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":512015,"discussion_content":"解压zip包后，img文件的md5是什么呢","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1610866061,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1167046,"avatar":"https://static001.geekbang.org/account/avatar/00/11/ce/c6/958212b5.jpg","nickname":"sugar","note":"","ucode":"454538FF253B5F","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":337273,"discussion_content":"此问题后来得到了解决： 问题在于国内用户访问etcher官网下载dmg时 有概率获取latest version失败，进而造成下载到兜底的非常低的版本。经过与etcher项目maintainer沟通，获取了最新版本dmg后此问题解决。另外，刷镜像失败也可以考虑下加sudo执行等方式解决权限相关问题","likes_number":1,"is_delete":false,"is_hidden":false,"ctime":1608859286,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":267860,"user_name":"aゞ颜ͯ七ͯ岁ͯer","can_delete":false,"product_type":"c1","uid":2312775,"ip_address":"","ucode":"46F36C75920DAD","user_header":"https://static001.geekbang.org/account/avatar/00/23/4a/47/3501a883.jpg","comment_is_top":false,"comment_ctime":1607955850,"is_pvip":false,"replies":[{"id":"99485","content":"👍👍","user_name":"作者回复","user_name_real":"郭朝斌","uid":"2302171","ctime":1610865162,"ip_address":"","comment_id":267860,"utype":1}],"discussion_count":2,"race_medal":0,"score":"5902923146","product_id":100063601,"comment_content":"玩过homeassistant，还有iobroker，diy自己的智能家居还是非常有成就感的，尤其是站在巨人的肩膀上😄😄","like_count":1,"discussions":[{"author":{"id":2302171,"avatar":"https://static001.geekbang.org/account/avatar/00/23/20/db/b04f43dc.jpg","nickname":"郭朝斌","note":"","ucode":"2969986E1B3851","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":511765,"discussion_content":"👍👍","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1610865162,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1497684,"avatar":"https://static001.geekbang.org/account/avatar/00/16/da/54/835d24f3.jpg","nickname":"评分家","note":"","ucode":"74854639559545","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":335115,"discussion_content":"有机会交流交流下哈。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1608095032,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":357855,"user_name":"Geek_494be2","can_delete":false,"product_type":"c1","uid":3027287,"ip_address":"广东","ucode":"C9DB856E82CEAB","user_header":"","comment_is_top":false,"comment_ctime":1663685842,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1663685842","product_id":100063601,"comment_content":"目前看其实使用gladys assistant 制作好的镜像就是在启动系统的时候加了一个启动脚本，在&lt;span style=&quot;color:red&quot;&gt;&#47;var&#47;lib&#47;gladysassistant&lt;span&gt; 目录下，有一个init-containers.sh的文件，如果看不到前端网页的话，可以遵循以下步骤搞定：<br><br>前提是ssh连接到你的树莓派里后<br><br>1. 配置docker镜像源：<br> sudo nano &#47;etc&#47;docker&#47;daemon.json<br>将以下内容复制到文件中：<br>{<br>    &quot;registry-mirrors&quot; : [<br>    &quot;https:&#47;&#47;registry.docker-cn.com&quot;,<br>    &quot;https:&#47;&#47;docker.mirrors.ustc.edu.cn&quot;,<br>    &quot;http:&#47;&#47;hub-mirror.c.163.com&quot;,<br>    &quot;https:&#47;&#47;cr.console.aliyun.com&#47;&quot;<br>  ]<br>}<br><br>按ctrl + o （mac是 control + O）保存，回车，ctrl + X 退出<br><br>更改时区:<br>运行 timedatectl set-timezone Asia&#47;Shanghai<br><br>然后运行：<br>sudo .&#47;var&#47;lib&#47;gladysassistant&#47;init-containers.sh<br><br>等下载完docker镜像就行<br><br>","like_count":0},{"had_liked":false,"id":335861,"user_name":"小伟","can_delete":false,"product_type":"c1","uid":1026271,"ip_address":"","ucode":"BF17F586365E65","user_header":"https://static001.geekbang.org/account/avatar/00/0f/a8/df/a206a1a2.jpg","comment_is_top":false,"comment_ctime":1645726306,"is_pvip":true,"discussion_count":0,"race_medal":0,"score":"1645726306","product_id":100063601,"comment_content":"可能与网络环境有关，我的win10电脑，访问gladys.local显示“无法访问此网站”<br>解决方法：<br>1. Android手机下载Network Scanner软件，扫描后获取有Raspberry Pi字样的IP，使用IP访问；<br>2. 还是不能找到，确认树莓派是否接入了路由器----1. wpa_supplicant.conf配置中信息是否正确  2. 信号是否够好(信号不好也可能连不上)；<br>3. 经过以上操作还连不上，建议直连网线确认；","like_count":0},{"had_liked":false,"id":323265,"user_name":"Geek_1bbdee","can_delete":false,"product_type":"c1","uid":2836446,"ip_address":"","ucode":"1EB65CEA584C54","user_header":"https://thirdwx.qlogo.cn/mmopen/vi_32/0OaV2KicIgpZdNYqIyqcM1ZfF9QPE8QtXaVicTfGuWfx9zRgatNYJDV2DBzrUPXdl7msYsf4Jia3cY6lRThcFGspg/132","comment_is_top":false,"comment_ctime":1637806826,"is_pvip":false,"discussion_count":1,"race_medal":0,"score":"1637806826","product_id":100063601,"comment_content":"老师，配置好 Gladys Assistant 的 Raspbian 镜像文件下载网址打不开，怎么回事","like_count":0,"discussions":[{"author":{"id":1088166,"avatar":"http://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTIgJNHEEbicY7JUlMYoZjI5BicxjcART3WAO2Z54ztv5PAeC6QUIJbqRFE42HAgVpfjmunqH59mfJ5w/132","nickname":"werther","note":"","ucode":"2146BFEB251249","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":577276,"discussion_content":"https://github.com/GladysAssistant/Gladys/releases/tag/v4.0.0","likes_number":1,"is_delete":false,"is_hidden":false,"ctime":1655998638,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":321159,"user_name":"aLong","can_delete":false,"product_type":"c1","uid":2409553,"ip_address":"","ucode":"11DB1B9C579811","user_header":"https://static001.geekbang.org/account/avatar/00/24/c4/51/5bca1604.jpg","comment_is_top":false,"comment_ctime":1636692585,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1636692585","product_id":100063601,"comment_content":"用过 home assistant。目前家里基本都是米家平台的设备。通过一个插件可以直接导入，不用像之前在yaml文件中做修改。感觉对小白体验好点。","like_count":0},{"had_liked":false,"id":299826,"user_name":"A=X+Y+Z","can_delete":false,"product_type":"c1","uid":2657220,"ip_address":"","ucode":"B8820F4F0FF710","user_header":"https://static001.geekbang.org/account/avatar/00/28/8b/c4/74d67cf0.jpg","comment_is_top":false,"comment_ctime":1624873103,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1624873103","product_id":100063601,"comment_content":"老师，在windows终端中进行模拟 MQTT 设备出现：<br>&#39;hbmqtt_pub&#39; 不是内部或外部命令，也不是可运行的程序<br>或批处理文件。<br>这个怎么解决呢，","like_count":0},{"had_liked":false,"id":289929,"user_name":"符海明","can_delete":false,"product_type":"c1","uid":2583344,"ip_address":"","ucode":"680BF5F86BADAA","user_header":"https://static001.geekbang.org/account/avatar/00/27/6b/30/68a58b48.jpg","comment_is_top":false,"comment_ctime":1619267179,"is_pvip":false,"replies":[{"id":"106692","content":"先确认一下板子的工作状态，是否正常启动。我没有这样的板子，也不在现场，不太好分析出具体的问题。","user_name":"作者回复","user_name_real":"郭朝斌","uid":"2302171","ctime":1621759385,"ip_address":"","comment_id":289929,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1619267179","product_id":100063601,"comment_content":"老师，我手头暂时只有树莓派3B+,N按您的操作烧录了系统后一直打不开http:&#47;&#47;gladys.local&#47;这个网址，改成ip地址后也是打不开，请问是什么原因呢？","like_count":0,"discussions":[{"author":{"id":2302171,"avatar":"https://static001.geekbang.org/account/avatar/00/23/20/db/b04f43dc.jpg","nickname":"郭朝斌","note":"","ucode":"2969986E1B3851","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":519058,"discussion_content":"先确认一下板子的工作状态，是否正常启动。我没有这样的板子，也不在现场，不太好分析出具体的问题。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1621759385,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":281054,"user_name":"Lx_","can_delete":false,"product_type":"c1","uid":1299975,"ip_address":"","ucode":"A8288C8C618599","user_header":"https://static001.geekbang.org/account/avatar/00/13/d6/07/6ec20361.jpg","comment_is_top":false,"comment_ctime":1614564943,"is_pvip":true,"replies":[{"id":"102041","content":"查看一下gladys的运行状态是否OK","user_name":"作者回复","user_name_real":"郭朝斌","uid":"2302171","ctime":1614576475,"ip_address":"","comment_id":281054,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1614564943","product_id":100063601,"comment_content":"老师 请问一下我hbmqtt最后执行报错，说连不上我的gladys<br>ConnectException(OSError(&quot;Multiple exceptions<br>这是为什么？","like_count":0,"discussions":[{"author":{"id":2302171,"avatar":"https://static001.geekbang.org/account/avatar/00/23/20/db/b04f43dc.jpg","nickname":"郭朝斌","note":"","ucode":"2969986E1B3851","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":516287,"discussion_content":"查看一下gladys的运行状态是否OK","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1614576475,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":278883,"user_name":"Jerry","can_delete":false,"product_type":"c1","uid":2304867,"ip_address":"","ucode":"5F7DCD6515393B","user_header":"https://static001.geekbang.org/account/avatar/00/23/2b/63/d627d2cf.jpg","comment_is_top":false,"comment_ctime":1613436193,"is_pvip":false,"replies":[{"id":"102065","content":"通过scp等命令行或filezilla等软件来传输","user_name":"作者回复","user_name_real":"郭朝斌","uid":"2302171","ctime":1614580243,"ip_address":"","comment_id":278883,"utype":1}],"discussion_count":2,"race_medal":0,"score":"1613436193","product_id":100063601,"comment_content":"请问，代码怎么发布道树莓派里面的系统里呢","like_count":0,"discussions":[{"author":{"id":2302171,"avatar":"https://static001.geekbang.org/account/avatar/00/23/20/db/b04f43dc.jpg","nickname":"郭朝斌","note":"","ucode":"2969986E1B3851","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":515543,"discussion_content":"通过scp等命令行或filezilla等软件来传输","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1614580243,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1323223,"avatar":"https://static001.geekbang.org/account/avatar/00/14/30/d7/4999e677.jpg","nickname":"大王叫我来巡山","note":"","ucode":"DC23F4F0444F4F","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":351024,"discussion_content":"铁，没有代码。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1614126723,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":274270,"user_name":"Geek_8414f1","can_delete":false,"product_type":"c1","uid":2414033,"ip_address":"","ucode":"264516DD9F8AEF","user_header":"","comment_is_top":false,"comment_ctime":1610949543,"is_pvip":false,"replies":[{"id":"100783","content":"可以检查一下网络，还确定不了，只能接显示器看看具体的输出信息或者错误信息，排除掉硬件的问题，再看软件系统的问题。","user_name":"作者回复","user_name_real":"郭朝斌","uid":"2302171","ctime":1612589249,"ip_address":"","comment_id":274270,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1610949543","product_id":100063601,"comment_content":"树莓派系统无法正常启动<br><br>raspderry pi 4 系统正常启动，MQTT 操作成功。后断开电源，第二天再通电后，系统无法启动，sd卡格式化后，重新烧录也无法启动，Google 后也没找到原因。<br><br>问题描述：<br>1、插入电源，电源灯（红）常亮<br>2、绿灯，先慢闪（可用肉眼数），多次后，变快闪（用眼数不过来），多次后，又变慢闪（比前一次慢闪要慢），多次后，变的更慢，闪一下，过会(约1到几秒)再闪一下，多次后，绿灯就不亮了。断电再试，同样效果。从通电到绿灯不亮整个过程大概在1分钟左右。<br>","like_count":0,"discussions":[{"author":{"id":2302171,"avatar":"https://static001.geekbang.org/account/avatar/00/23/20/db/b04f43dc.jpg","nickname":"郭朝斌","note":"","ucode":"2969986E1B3851","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":513958,"discussion_content":"可以检查一下网络，还确定不了，只能接显示器看看具体的输出信息或者错误信息，排除掉硬件的问题，再看软件系统的问题。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1612589249,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":269810,"user_name":"like_wind","can_delete":false,"product_type":"c1","uid":1755021,"ip_address":"","ucode":"2733C299AE56AE","user_header":"http://thirdwx.qlogo.cn/mmopen/vi_32/DYAIOgq83eolBabicK5OTVJJJlUA4wwRtwCohCb75ahtbiaopsicnG3HRQTBOVEUrRY1KYCRZH78cDweQllh0Jzeg/132","comment_is_top":false,"comment_ctime":1608793139,"is_pvip":false,"replies":[{"id":"99273","content":"基本可以这样看","user_name":"作者回复","user_name_real":"郭朝斌","uid":"2302171","ctime":1610807976,"ip_address":"","comment_id":269810,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1608793139","product_id":100063601,"comment_content":"终于到实战环节了。可不可以这么理解：“烧录”可以理解为类似制作windows启动盘，然后把启动盘安装在树莓派的板子上，同时也安装了Gladys Assistant平台(这个平台可不可以理解为一个管理系统？)，然后模拟(客户端pub 消息)传感器设备发送数据到平台，最后完成在平台的web界面展示数据","like_count":0,"discussions":[{"author":{"id":2302171,"avatar":"https://static001.geekbang.org/account/avatar/00/23/20/db/b04f43dc.jpg","nickname":"郭朝斌","note":"","ucode":"2969986E1B3851","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":512401,"discussion_content":"基本可以这样看","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1610807976,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":268042,"user_name":"小叶","can_delete":false,"product_type":"c1","uid":1271831,"ip_address":"","ucode":"639A452A0634FA","user_header":"https://static001.geekbang.org/account/avatar/00/13/68/17/8cc195cc.jpg","comment_is_top":false,"comment_ctime":1608036682,"is_pvip":true,"discussion_count":1,"race_medal":0,"score":"1608036682","product_id":100063601,"comment_content":"树莓派上安装了Gladys Assistant后 怎么 关闭树莓派呢？直接拔树莓派电源？有哪位同学知道吗？","like_count":0,"discussions":[{"author":{"id":1755021,"avatar":"http://thirdwx.qlogo.cn/mmopen/vi_32/DYAIOgq83eolBabicK5OTVJJJlUA4wwRtwCohCb75ahtbiaopsicnG3HRQTBOVEUrRY1KYCRZH78cDweQllh0Jzeg/132","nickname":"like_wind","note":"","ucode":"2733C299AE56AE","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":337080,"discussion_content":"ssh 远程连接，shutdown 试试？","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1608793180,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":267766,"user_name":"加油加油","can_delete":false,"product_type":"c1","uid":2032995,"ip_address":"","ucode":"4326347ED6E532","user_header":"https://static001.geekbang.org/account/avatar/00/1f/05/63/dd59ad18.jpg","comment_is_top":false,"comment_ctime":1607917375,"is_pvip":false,"replies":[{"id":"99490","content":"问极客商城的同学，应该是完整套餐里有","user_name":"作者回复","user_name_real":"郭朝斌","uid":"2302171","ctime":1610865656,"ip_address":"","comment_id":267766,"utype":1}],"discussion_count":3,"race_medal":0,"score":"1607917375","product_id":100063601,"comment_content":"老师问下，文中提到的硬件设备在专栏中提到的硬件套餐中包含吗？","like_count":0,"discussions":[{"author":{"id":2302171,"avatar":"https://static001.geekbang.org/account/avatar/00/23/20/db/b04f43dc.jpg","nickname":"郭朝斌","note":"","ucode":"2969986E1B3851","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":511735,"discussion_content":"问极客商城的同学，应该是完整套餐里有","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1610865656,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1625530,"avatar":"https://static001.geekbang.org/account/avatar/00/18/cd/ba/3a348f2d.jpg","nickname":"YueShi","note":"","ucode":"8F7AFAE4641A7D","race_medal":0,"user_type":1,"is_pvip":true},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":334830,"discussion_content":"是的，都有","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1608001745,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":1,"child_discussions":[{"author":{"id":2311396,"avatar":"","nickname":"JY","note":"","ucode":"5DE1DC047946E6","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":1625530,"avatar":"https://static001.geekbang.org/account/avatar/00/18/cd/ba/3a348f2d.jpg","nickname":"YueShi","note":"","ucode":"8F7AFAE4641A7D","race_medal":0,"user_type":1,"is_pvip":true},"discussion":{"id":334975,"discussion_content":"标准套餐也有吗？我买的标准套餐，好像没有树莓派啊","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1608039759,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":334830,"ip_address":""},"score":334975,"extra":""}]}]}]}