{"id":76307,"title":"11 | æ•°æ®ç§‘å­¦å®¶80%æ—¶é—´éƒ½èŠ±è´¹åœ¨äº†è¿™äº›æ¸…æ´—ä»»åŠ¡ä¸Šï¼Ÿ","content":"<p>æˆ‘ä»¬åœ¨ä¸Šä¸€èŠ‚ä¸­è®²äº†æ•°æ®é‡‡é›†ï¼Œä»¥åŠç›¸å…³çš„å·¥å…·ä½¿ç”¨ï¼Œä½†åšå®Œæ•°æ®é‡‡é›†å°±å¯ä»¥ç›´æ¥è¿›è¡ŒæŒ–æ˜äº†å—ï¼Ÿè‚¯å®šä¸æ˜¯çš„ã€‚</p><p>å°±æ‹¿åšé¥­æ‰“ä¸ªæ¯”æ–¹å§ï¼Œå¯¹äºå¾ˆå¤šäººæ¥è¯´ï¼Œçƒ­æ²¹ä¸‹é”…ã€æŒå‹ºç¿»ç‚’ä¸€å®šæ˜¯åšé¥­ä¸­æœ€è¿‡ç˜¾çš„ç¯èŠ‚ï¼Œä½†å®é™…ä¸Šç‚’èœè¿™ä¸ªè¿‡ç¨‹åªå åšé¥­æ—¶é—´çš„20%ï¼Œå‰©ä¸‹80%çš„æ—¶é—´éƒ½æ˜¯åœ¨åšå‡†å¤‡ï¼Œæ¯”å¦‚ä¹°èœã€æ‹©èœã€æ´—èœç­‰ç­‰ã€‚</p><p>åœ¨æ•°æ®æŒ–æ˜ä¸­ï¼Œæ•°æ®æ¸…æ´—å°±æ˜¯è¿™æ ·çš„å‰æœŸå‡†å¤‡å·¥ä½œã€‚å¯¹äºæ•°æ®ç§‘å­¦å®¶æ¥è¯´ï¼Œæˆ‘ä»¬ä¼šé‡åˆ°å„ç§å„æ ·çš„æ•°æ®ï¼Œåœ¨åˆ†æå‰ï¼Œè¦æŠ•å…¥å¤§é‡çš„æ—¶é—´å’Œç²¾åŠ›æŠŠæ•°æ®â€œ<strong>æ•´ç†è£å‰ª</strong>â€æˆè‡ªå·±æƒ³è¦æˆ–éœ€è¦çš„æ ·å­ã€‚</p><p>ä¸ºä»€ä¹ˆå‘¢ï¼Ÿå› ä¸ºæˆ‘ä»¬é‡‡é›†åˆ°çš„æ•°æ®å¾€å¾€æœ‰å¾ˆå¤šé—®é¢˜ã€‚</p><p>æˆ‘ä»¬å…ˆçœ‹ä¸€ä¸ªä¾‹å­ï¼Œå‡è®¾è€æ¿ç»™ä½ ä»¥ä¸‹çš„æ•°æ®ï¼Œè®©ä½ åšæ•°æ®åˆ†æï¼Œä½ çœ‹åˆ°è¿™ä¸ªæ•°æ®åæœ‰ä»€ä¹ˆæ„Ÿè§‰å‘¢ï¼Ÿ</p><p><img src=\"https://static001.geekbang.org/resource/image/5e/23/5e69b73b96c0d824240ac8035fe69723.png?wh=522*334\" alt=\"\"></p><p>ä½ åˆšçœ‹åˆ°è¿™äº›æ•°æ®å¯èƒ½ä¼šæ¯”è¾ƒæ‡µï¼Œå› ä¸ºè¿™äº›æ•°æ®ç¼ºå°‘æ ‡æ³¨ã€‚</p><p>æˆ‘ä»¬åœ¨æ”¶é›†æ•´ç†æ•°æ®çš„æ—¶å€™ï¼Œä¸€å®šè¦å¯¹æ•°æ®åšæ ‡æ³¨ï¼Œæ•°æ®è¡¨å¤´å¾ˆé‡è¦ã€‚æ¯”å¦‚è¿™ä»½æ•°æ®è¡¨ï¼Œå°±ç¼ºå°‘åˆ—åçš„æ ‡æ³¨ï¼Œè¿™æ ·ä¸€æ¥æˆ‘ä»¬å°±ä¸çŸ¥é“æ¯åˆ—æ•°æ®æ‰€ä»£è¡¨çš„å«ä¹‰ï¼Œæ— æ³•ä»ä¸šåŠ¡ä¸­ç†è§£è¿™äº›æ•°å€¼çš„ä½œç”¨ï¼Œä»¥åŠè¿™äº›æ•°å€¼æ˜¯å¦æ­£ç¡®ã€‚ä½†åœ¨å®é™…å·¥ä½œä¸­ï¼Œä¹Ÿå¯èƒ½åƒè¿™ä¸ªæ¡ˆä¾‹ä¸€æ ·ï¼Œæ•°æ®æ˜¯ç¼ºå°‘æ ‡æ³¨çš„ã€‚</p><p>æˆ‘ç®€å•è§£é‡Šä¸‹è¿™äº›æ•°æ®ä»£è¡¨çš„å«ä¹‰ã€‚</p><p>è¿™æ˜¯ä¸€å®¶æœè£…åº—ç»Ÿè®¡çš„ä¼šå‘˜æ•°æ®ã€‚æœ€ä¸Šé¢çš„ä¸€è¡Œæ˜¯åˆ—åæ ‡ï¼Œæœ€å·¦ä¾§ä¸€åˆ—æ˜¯è¡Œåæ ‡ã€‚</p><p>åˆ—åæ ‡ä¸­ï¼Œç¬¬0åˆ—ä»£è¡¨çš„æ˜¯åºå·ï¼Œç¬¬1åˆ—ä»£è¡¨çš„ä¼šå‘˜çš„å§“åï¼Œç¬¬2åˆ—ä»£è¡¨å¹´é¾„ï¼Œç¬¬3åˆ—ä»£è¡¨ä½“é‡ï¼Œç¬¬4~6åˆ—ä»£è¡¨ç”·æ€§ä¼šå‘˜çš„ä¸‰å›´å°ºå¯¸ï¼Œç¬¬7~9åˆ—ä»£è¡¨å¥³æ€§ä¼šå‘˜çš„ä¸‰å›´å°ºå¯¸ã€‚</p><!-- [[[read_end]]] --><p>äº†è§£å«ä¹‰ä»¥åï¼Œæˆ‘ä»¬å†çœ‹ä¸‹ä¸­é—´éƒ¨åˆ†å…·ä½“çš„æ•°æ®ï¼Œä½ å¯èƒ½ä¼šæƒ³ï¼Œè¿™äº›æ•°æ®æ€ä¹ˆè¿™ä¹ˆâ€œè„ä¹±å·®â€å•Šï¼Œæœ‰å¾ˆå¤šå€¼æ˜¯ç©ºçš„ï¼ˆNaNï¼‰ï¼Œè¿˜æœ‰ç©ºè¡Œçš„æƒ…å†µã€‚</p><p>æ˜¯çš„ï¼Œè¿™è¿˜ä»…ä»…æ˜¯ä¸€å®¶å•†åº—çš„éƒ¨åˆ†ä¼šå‘˜æ•°æ®ï¼Œæˆ‘ä»¬ä¸€çœ¼çœ‹è¿‡å»å°±èƒ½å‘ç°ä¸€äº›é—®é¢˜ã€‚æ—¥å¸¸å·¥ä½œä¸­çš„æ•°æ®ä¸šåŠ¡ä¼šå¤æ‚å¾ˆå¤šï¼Œé€šå¸¸æˆ‘ä»¬è¦ç»Ÿè®¡æ›´å¤šçš„æ•°æ®ç»´åº¦ï¼Œæ¯”å¦‚100ä¸ªæŒ‡æ ‡ï¼Œæ•°æ®é‡é€šå¸¸éƒ½æ˜¯è¶…è¿‡TBã€EBçº§åˆ«çš„ï¼Œæ‰€ä»¥æ•´ä¸ªæ•°æ®åˆ†æçš„å¤„ç†éš¾åº¦æ˜¯å‘ˆæŒ‡æ•°çº§å¢åŠ çš„ã€‚è¿™ä¸ªæ—¶å€™ï¼Œä»…ä»…é€šè¿‡è‚‰çœ¼å°±å¾ˆéš¾æ‰¾åˆ°é—®é¢˜æ‰€åœ¨äº†ã€‚</p><p>æˆ‘ä¸¾äº†è¿™æ ·ä¸€ä¸ªç®€å•çš„ä¾‹å­ï¼Œå¸¦ä½ ç†è§£åœ¨æ•°æ®åˆ†æä¹‹å‰ä¸ºä»€ä¹ˆè¦æœ‰æ•°æ®æ¸…æ´—è¿™ä¸ªé‡è¦çš„å‡†å¤‡å·¥ä½œã€‚æœ‰ç»éªŒçš„æ•°æ®åˆ†æå¸ˆéƒ½çŸ¥é“ï¼Œ<strong>å¥½çš„æ•°æ®åˆ†æå¸ˆå¿…å®šæ˜¯ä¸€åæ•°æ®æ¸…æ´—é«˜æ‰‹ï¼Œè¦çŸ¥é“åœ¨æ•´ä¸ªæ•°æ®åˆ†æè¿‡ç¨‹ä¸­ï¼Œä¸è®ºæ˜¯åœ¨æ—¶é—´è¿˜æ˜¯åŠŸå¤«ä¸Šï¼Œæ•°æ®æ¸…æ´—å¤§æ¦‚éƒ½å åˆ°äº†80%</strong>ã€‚</p><h2>æ•°æ®è´¨é‡çš„å‡†åˆ™</h2><p>åœ¨ä¸Šé¢è¿™ä¸ªæœè£…åº—ä¼šå‘˜æ•°æ®çš„æ¡ˆä¾‹ä¸­ï¼Œä¸€çœ‹åˆ°è¿™äº›æ•°æ®ï¼Œä½ è‚¯å®šèƒ½å‘ç°å‡ ä¸ªé—®é¢˜ã€‚ä½ æ˜¯ä¸æ˜¯æƒ³çŸ¥é“ï¼Œæœ‰æ²¡æœ‰ä¸€äº›å‡†åˆ™æ¥è§„èŒƒè¿™äº›æ•°æ®çš„è´¨é‡å‘¢ï¼Ÿ</p><p>å‡†åˆ™è‚¯å®šæ˜¯æœ‰çš„ã€‚ä¸è¿‡å¦‚æœæ•°æ®å­˜åœ¨ä¸ƒå…«ç§ç”šè‡³æ›´å¤šçš„é—®é¢˜ï¼Œæˆ‘ä»¬å¾ˆéš¾å°†è¿™äº›è§„åˆ™éƒ½è®°ä½ã€‚æœ‰ç ”ç©¶è¯´ä¸€ä¸ªäººçš„çŸ­æœŸè®°å¿†ï¼Œæœ€å¤šå¯ä»¥è®°ä½7æ¡å†…å®¹æˆ–ä¿¡æ¯ï¼Œè¶…è¿‡7æ¡å°±è®°ä¸ä½äº†ã€‚è€Œæ•°æ®æ¸…æ´—è¦è§£å†³çš„é—®é¢˜ï¼Œè¿œä¸æ­¢7æ¡ï¼Œæˆ‘ä»¬ä¸‡ä¸€æ¼æ‰ä¸€é¡¹è¯¥æ€ä¹ˆåŠå‘¢ï¼Ÿæœ‰æ²¡æœ‰ä¸€ç§æ–¹æ³•ï¼Œæˆ‘ä»¬æ—¢å¯ä»¥å¾ˆæ–¹ä¾¿åœ°è®°ä½ï¼Œåˆèƒ½ä¿è¯æˆ‘ä»¬çš„æ•°æ®å¾—åˆ°å¾ˆå¥½çš„æ¸…æ´—ï¼Œæå‡æ•°æ®è´¨é‡å‘¢ï¼Ÿ</p><p>åœ¨è¿™é‡Œï¼Œæˆ‘å°†æ•°æ®æ¸…æ´—è§„åˆ™æ€»ç»“ä¸ºä»¥ä¸‹4ä¸ªå…³é”®ç‚¹ï¼Œç»Ÿä¸€èµ·æ¥å«â€œ<strong><span class=\"orange\">å®Œå…¨åˆä¸€</span></strong>â€ï¼Œä¸‹é¢æˆ‘æ¥è§£é‡Šä¸‹ã€‚</p><ol>\n<li>\n<p><strong>å®Œ</strong>æ•´æ€§ï¼šå•æ¡æ•°æ®æ˜¯å¦å­˜åœ¨ç©ºå€¼ï¼Œç»Ÿè®¡çš„å­—æ®µæ˜¯å¦å®Œå–„ã€‚</p>\n</li>\n<li>\n<p><strong>å…¨</strong>é¢æ€§ï¼šè§‚å¯ŸæŸä¸€åˆ—çš„å…¨éƒ¨æ•°å€¼ï¼Œæ¯”å¦‚åœ¨Excelè¡¨ä¸­ï¼Œæˆ‘ä»¬é€‰ä¸­ä¸€åˆ—ï¼Œå¯ä»¥çœ‹åˆ°è¯¥åˆ—çš„å¹³å‡å€¼ã€æœ€å¤§å€¼ã€æœ€å°å€¼ã€‚æˆ‘ä»¬å¯ä»¥é€šè¿‡å¸¸è¯†æ¥åˆ¤æ–­è¯¥åˆ—æ˜¯å¦æœ‰é—®é¢˜ï¼Œæ¯”å¦‚ï¼šæ•°æ®å®šä¹‰ã€å•ä½æ ‡è¯†ã€æ•°å€¼æœ¬èº«ã€‚</p>\n</li>\n<li>\n<p><strong>åˆ</strong>æ³•æ€§ï¼šæ•°æ®çš„ç±»å‹ã€å†…å®¹ã€å¤§å°çš„åˆæ³•æ€§ã€‚æ¯”å¦‚æ•°æ®ä¸­å­˜åœ¨éASCIIå­—ç¬¦ï¼Œæ€§åˆ«å­˜åœ¨äº†æœªçŸ¥ï¼Œå¹´é¾„è¶…è¿‡äº†150å²ç­‰ã€‚</p>\n</li>\n<li>\n<p>å”¯<strong>ä¸€</strong>æ€§ï¼šæ•°æ®æ˜¯å¦å­˜åœ¨é‡å¤è®°å½•ï¼Œå› ä¸ºæ•°æ®é€šå¸¸æ¥è‡ªä¸åŒæ¸ é“çš„æ±‡æ€»ï¼Œé‡å¤çš„æƒ…å†µæ˜¯å¸¸è§çš„ã€‚è¡Œæ•°æ®ã€åˆ—æ•°æ®éƒ½éœ€è¦æ˜¯å”¯ä¸€çš„ï¼Œæ¯”å¦‚ä¸€ä¸ªäººä¸èƒ½é‡å¤è®°å½•å¤šæ¬¡ï¼Œä¸”ä¸€ä¸ªäººçš„ä½“é‡ä¹Ÿä¸èƒ½åœ¨åˆ—æŒ‡æ ‡ä¸­é‡å¤è®°å½•å¤šæ¬¡ã€‚</p>\n</li>\n</ol><p>åœ¨å¾ˆå¤šæ•°æ®æŒ–æ˜çš„æ•™å­¦ä¸­ï¼Œæ•°æ®å‡†åˆ™é€šå¸¸ä¼šåˆ—å‡ºæ¥7~8é¡¹ï¼Œåœ¨è¿™é‡Œæˆ‘ä»¬å½’ç±»æˆäº†â€œå®Œå…¨åˆä¸€â€4é¡¹å‡†åˆ™ï¼ŒæŒ‰ç…§ä»¥ä¸Šçš„åŸåˆ™ï¼Œæˆ‘ä»¬èƒ½è§£å†³æ•°æ®æ¸…ç†ä¸­é‡åˆ°çš„å¤§éƒ¨åˆ†é—®é¢˜ï¼Œä½¿å¾—<strong>æ•°æ®æ ‡å‡†ã€å¹²å‡€ã€è¿ç»­</strong>ï¼Œä¸ºåç»­æ•°æ®ç»Ÿè®¡ã€æ•°æ®æŒ–æ˜åšå¥½å‡†å¤‡ã€‚å¦‚æœæƒ³è¦è¿›ä¸€æ­¥ä¼˜åŒ–æ•°æ®è´¨é‡ï¼Œè¿˜éœ€è¦åœ¨å®é™…æ¡ˆä¾‹ä¸­çµæ´»ä½¿ç”¨ã€‚</p><h2>æ¸…æ´—æ•°æ®ï¼Œä¸€ä¸€å‡»ç ´</h2><p>äº†è§£äº†æ•°æ®è´¨é‡å‡†åˆ™ä¹‹åï¼Œæˆ‘ä»¬é’ˆå¯¹ä¸Šé¢æœè£…åº—ä¼šå‘˜æ•°æ®æ¡ˆä¾‹ä¸­çš„é—®é¢˜è¿›è¡Œä¸€ä¸€å‡»ç ´ã€‚</p><p>è¿™é‡Œä½ å°±éœ€è¦Pythonçš„Pandaså·¥å…·äº†ã€‚è¿™ä¸ªå·¥å…·æˆ‘ä»¬ä¹‹å‰ä»‹ç»è¿‡ã€‚å®ƒæ˜¯åŸºäºNumPyçš„å·¥å…·ï¼Œä¸“é—¨ä¸ºè§£å†³æ•°æ®åˆ†æä»»åŠ¡è€Œåˆ›å»ºã€‚Pandas çº³å…¥äº†å¤§é‡åº“ï¼Œæˆ‘ä»¬å¯ä»¥åˆ©ç”¨è¿™äº›åº“é«˜æ•ˆåœ°è¿›è¡Œæ•°æ®æ¸…ç†å·¥ä½œã€‚</p><p>è¿™é‡Œæˆ‘è¡¥å……è¯´æ˜ä¸€ä¸‹ï¼Œå¦‚æœä½ å¯¹Pythonè¿˜ä¸æ˜¯å¾ˆç†Ÿæ‚‰ï¼Œä½†æ˜¯å¾ˆæƒ³ä»äº‹æ•°æ®æŒ–æ˜ã€æ•°æ®åˆ†æç›¸å…³çš„å·¥ä½œï¼Œé‚£ä¹ˆèŠ±ä¸€äº›æ—¶é—´å’Œç²¾åŠ›æ¥å­¦ä¹ ä¸€ä¸‹Pythonæ˜¯å¾ˆæœ‰å¿…è¦çš„ã€‚Pythonæ‹¥æœ‰ä¸°å¯Œçš„åº“ï¼Œå ªç§°æ•°æ®æŒ–æ˜åˆ©å™¨ã€‚å½“ç„¶äº†ï¼Œæ•°æ®æ¸…æ´—çš„å·¥å…·ä¹Ÿè¿˜æœ‰å¾ˆå¤šï¼Œè¿™é‡Œæˆ‘ä»¬åªæ˜¯ä»¥Pandasä¸ºä¾‹ï¼Œå¸®ä½ åº”ç”¨æ•°æ®æ¸…æ´—å‡†åˆ™ï¼Œå¸¦ä½ æ›´åŠ ç›´è§‚åœ°äº†è§£æ•°æ®æ¸…æ´—åˆ°åº•æ˜¯æ€ä¹ˆå›äº‹å„¿ã€‚</p><p>ä¸‹é¢ï¼Œæˆ‘ä»¬å°±ä¾ç…§â€œå®Œå…¨åˆä¸€â€çš„å‡†åˆ™ï¼Œä½¿ç”¨Pandasæ¥è¿›è¡Œæ¸…æ´—ã€‚</p><p><strong>1.  å®Œæ•´æ€§</strong></p><p><strong>é—®é¢˜1ï¼šç¼ºå¤±å€¼</strong></p><p>åœ¨æ•°æ®ä¸­æœ‰äº›å¹´é¾„ã€ä½“é‡æ•°å€¼æ˜¯ç¼ºå¤±çš„ï¼Œè¿™å¾€å¾€æ˜¯å› ä¸ºæ•°æ®é‡è¾ƒå¤§ï¼Œåœ¨è¿‡ç¨‹ä¸­ï¼Œæœ‰äº›æ•°å€¼æ²¡æœ‰é‡‡é›†åˆ°ã€‚é€šå¸¸æˆ‘ä»¬å¯ä»¥é‡‡ç”¨ä»¥ä¸‹ä¸‰ç§æ–¹æ³•ï¼š</p><ul>\n<li>\n<p>åˆ é™¤ï¼šåˆ é™¤æ•°æ®ç¼ºå¤±çš„è®°å½•ï¼›</p>\n</li>\n<li>\n<p>å‡å€¼ï¼šä½¿ç”¨å½“å‰åˆ—çš„å‡å€¼ï¼›</p>\n</li>\n<li>\n<p>é«˜é¢‘ï¼šä½¿ç”¨å½“å‰åˆ—å‡ºç°é¢‘ç‡æœ€é«˜çš„æ•°æ®ã€‚</p>\n</li>\n</ul><p>æ¯”å¦‚æˆ‘ä»¬æƒ³å¯¹df[â€˜Ageâ€™]ä¸­ç¼ºå¤±çš„æ•°å€¼ç”¨å¹³å‡å¹´é¾„è¿›è¡Œå¡«å……ï¼Œå¯ä»¥è¿™æ ·å†™ï¼š</p><pre><code>df['Age'].fillna(df['Age'].mean(), inplace=True)\n</code></pre><p>å¦‚æœæˆ‘ä»¬ç”¨æœ€é«˜é¢‘çš„æ•°æ®è¿›è¡Œå¡«å……ï¼Œå¯ä»¥å…ˆé€šè¿‡value_countsè·å–Ageå­—æ®µæœ€é«˜é¢‘æ¬¡age_maxfï¼Œç„¶åå†å¯¹Ageå­—æ®µä¸­ç¼ºå¤±çš„æ•°æ®ç”¨age_maxfè¿›è¡Œå¡«å……ï¼š</p><pre><code>age_maxf = train_features['Age'].value_counts().index[0]\ntrain_features['Age'].fillna(age_maxf, inplace=True)\n</code></pre><p><strong>é—®é¢˜2ï¼šç©ºè¡Œ</strong></p><p>æˆ‘ä»¬å‘ç°æ•°æ®ä¸­æœ‰ä¸€ä¸ªç©ºè¡Œï¼Œé™¤äº† index ä¹‹å¤–ï¼Œå…¨éƒ¨çš„å€¼éƒ½æ˜¯ NaNã€‚Pandas çš„ read_csv() å¹¶æ²¡æœ‰å¯é€‰å‚æ•°æ¥å¿½ç•¥ç©ºè¡Œï¼Œè¿™æ ·ï¼Œæˆ‘ä»¬å°±éœ€è¦åœ¨æ•°æ®è¢«è¯»å…¥ä¹‹åå†ä½¿ç”¨ dropna() è¿›è¡Œå¤„ç†ï¼Œåˆ é™¤ç©ºè¡Œã€‚</p><pre><code># åˆ é™¤å…¨ç©ºçš„è¡Œ\ndf.dropna(how='all',inplace=True) \n</code></pre><p><strong>2.  å…¨é¢æ€§</strong></p><p><strong>é—®é¢˜ï¼šåˆ—æ•°æ®çš„å•ä½ä¸ç»Ÿä¸€</strong></p><p>è§‚å¯Ÿweightåˆ—çš„æ•°å€¼ï¼Œæˆ‘ä»¬èƒ½å‘ç°weight åˆ—çš„å•ä½ä¸ç»Ÿä¸€ã€‚æœ‰çš„å•ä½æ˜¯åƒå…‹ï¼ˆkgsï¼‰ï¼Œæœ‰çš„å•ä½æ˜¯ç£…ï¼ˆlbsï¼‰ã€‚</p><p>è¿™é‡Œæˆ‘ä½¿ç”¨åƒå…‹ä½œä¸ºç»Ÿä¸€çš„åº¦é‡å•ä½ï¼Œå°†ç£…ï¼ˆlbsï¼‰è½¬åŒ–ä¸ºåƒå…‹ï¼ˆkgsï¼‰ï¼š</p><pre><code># è·å– weight æ•°æ®åˆ—ä¸­å•ä½ä¸º lbs çš„æ•°æ®\nrows_with_lbs = df['weight'].str.contains('lbs').fillna(False)\nprint df[rows_with_lbs]\n# å°† lbsè½¬æ¢ä¸º kgs, 2.2lbs=1kgs\nfor i,lbs_row in df[rows_with_lbs].iterrows():\n\t# æˆªå–ä»å¤´å¼€å§‹åˆ°å€’æ•°ç¬¬ä¸‰ä¸ªå­—ç¬¦ä¹‹å‰ï¼Œå³å»æ‰lbsã€‚\n\tweight = int(float(lbs_row['weight'][:-3])/2.2)\n\tdf.at[i,'weight'] = '{}kgs'.format(weight) \n</code></pre><p><strong>3.  åˆç†æ€§</strong></p><p><strong>é—®é¢˜ï¼šéASCIIå­—ç¬¦</strong></p><p>æˆ‘ä»¬å¯ä»¥çœ‹åˆ°åœ¨æ•°æ®é›†ä¸­ Firstname å’Œ Lastname æœ‰ä¸€äº›é ASCII çš„å­—ç¬¦ã€‚æˆ‘ä»¬å¯ä»¥é‡‡ç”¨åˆ é™¤æˆ–è€…æ›¿æ¢çš„æ–¹å¼æ¥è§£å†³éASCIIé—®é¢˜ï¼Œè¿™é‡Œæˆ‘ä»¬ä½¿ç”¨åˆ é™¤æ–¹æ³•ï¼š</p><pre><code># åˆ é™¤é ASCII å­—ç¬¦\ndf['first_name'].replace({r'[^\\x00-\\x7F]+':''}, regex=True, inplace=True)\ndf['last_name'].replace({r'[^\\x00-\\x7F]+':''}, regex=True, inplace=True)\n</code></pre><p><strong>4.  å”¯ä¸€æ€§</strong></p><p><strong>é—®é¢˜1ï¼šä¸€åˆ—æœ‰å¤šä¸ªå‚æ•°</strong></p><p>åœ¨æ•°æ®ä¸­ä¸éš¾å‘ç°ï¼Œå§“ååˆ—ï¼ˆNameï¼‰åŒ…å«äº†ä¸¤ä¸ªå‚æ•° Firstname å’Œ Lastnameã€‚ä¸ºäº†è¾¾åˆ°æ•°æ®æ•´æ´ç›®çš„ï¼Œæˆ‘ä»¬å°† Name åˆ—æ‹†åˆ†æˆ Firstname å’Œ Lastnameä¸¤ä¸ªå­—æ®µã€‚æˆ‘ä»¬ä½¿ç”¨Pythonçš„splitæ–¹æ³•ï¼Œstr.split(expand=True)ï¼Œå°†åˆ—è¡¨æ‹†æˆæ–°çš„åˆ—ï¼Œå†å°†åŸæ¥çš„ Name åˆ—åˆ é™¤ã€‚</p><pre><code># åˆ‡åˆ†åå­—ï¼Œåˆ é™¤æºæ•°æ®åˆ—\ndf[['first_name','last_name']] = df['name'].str.split(expand=True)\ndf.drop('name', axis=1, inplace=True)\n</code></pre><p><strong>é—®é¢˜2ï¼šé‡å¤æ•°æ®</strong></p><p>æˆ‘ä»¬æ ¡éªŒä¸€ä¸‹æ•°æ®ä¸­æ˜¯å¦å­˜åœ¨é‡å¤è®°å½•ã€‚å¦‚æœå­˜åœ¨é‡å¤è®°å½•ï¼Œå°±ä½¿ç”¨ Pandas æä¾›çš„ drop_duplicates() æ¥åˆ é™¤é‡å¤æ•°æ®ã€‚</p><pre><code># åˆ é™¤é‡å¤æ•°æ®è¡Œ\ndf.drop_duplicates(['first_name','last_name'],inplace=True)\n</code></pre><p>è¿™æ ·ï¼Œæˆ‘ä»¬å°±å°†ä¸Šé¢æ¡ˆä¾‹ä¸­çš„ä¼šå‘˜æ•°æ®è¿›è¡Œäº†æ¸…ç†ï¼Œæ¥çœ‹çœ‹æ¸…ç†ä¹‹åçš„æ•°æ®ç»“æœã€‚æ€ä¹ˆæ ·ï¼Ÿæ˜¯ä¸æ˜¯åˆå¹²å‡€åˆæ ‡å‡†ï¼Ÿ</p><p><img src=\"https://static001.geekbang.org/resource/image/71/fe/71001f8efb2692e77fa1285bcf7f91fe.png?wh=1441*398\" alt=\"\"></p><h2>å…»æˆæ•°æ®å®¡æ ¸çš„ä¹ æƒ¯</h2><p>ç°åœ¨ï¼Œä½ æ˜¯ä¸æ˜¯èƒ½æ„Ÿå—åˆ°æ•°æ®é—®é¢˜ä¸æ˜¯å°äº‹ï¼Œä¸Šé¢è¿™ä¸ªç®€å•çš„ä¾‹å­é‡Œéƒ½æœ‰6å¤„é”™è¯¯ã€‚æ‰€ä»¥æˆ‘ä»¬å¸¸è¯´ï¼Œç°å®ä¸–ç•Œçš„æ•°æ®æ˜¯â€œè‚®è„çš„â€ï¼Œéœ€è¦æ¸…æ´—ã€‚</p><p>ç¬¬ä¸‰æ–¹çš„æ•°æ®è¦æ¸…æ´—ï¼Œè‡ªæœ‰äº§å“çš„æ•°æ®ï¼Œä¹Ÿéœ€è¦æ•°æ®æ¸…æ´—ã€‚æ¯”å¦‚ç¾å›¢è‡ªèº«åšæ•°æ®æŒ–æ˜çš„æ—¶å€™ï¼Œä¹Ÿéœ€è¦å»é™¤çˆ¬è™«æŠ“å–ï¼Œä½œå¼Šæ•°æ®ç­‰ã€‚å¯ä»¥è¯´<strong>æ²¡æœ‰é«˜è´¨é‡çš„æ•°æ®ï¼Œå°±æ²¡æœ‰é«˜è´¨é‡çš„æ•°æ®æŒ–æ˜ï¼Œè€Œæ•°æ®æ¸…æ´—æ˜¯é«˜è´¨é‡æ•°æ®çš„ä¸€é“ä¿éšœã€‚</strong></p><p>å½“ä½ ä»äº‹è¿™æ–¹é¢å·¥ä½œçš„æ—¶å€™ï¼Œä½ ä¼šå‘ç°å…»æˆæ•°æ®å®¡æ ¸çš„ä¹ æƒ¯éå¸¸é‡è¦ã€‚è€Œä¸”è¶Šæ˜¯ä¼˜ç§€çš„æ•°æ®æŒ–æ˜äººå‘˜ï¼Œè¶Šä¼šæœ‰â€œæ•°æ®å®¡æ ¸â€çš„â€œèŒä¸šç—…â€ã€‚è¿™å°±å¥½æ¯”ç¼–è¾‘éå¸¸åœ¨æ„æ–‡ç« ä¸­çš„é”™åˆ«å­—ã€è¯­æ³•ä¸€æ ·ã€‚</p><p>æ•°æ®çš„è§„èŒƒæ€§ï¼Œå°±åƒæ˜¯ä½ çš„ä½œå“ä¸€æ ·ï¼Œé€šè¿‡æ¸…æ´—ä¹‹åï¼Œä¼šå˜å¾—éå¸¸å¹²å‡€ã€æ ‡å‡†ã€‚å½“ç„¶äº†ï¼Œè¿™ä¹Ÿæ˜¯ä¸€é—¨éœ€è¦ä¸æ–­ä¿®ç‚¼çš„åŠŸå¤«ã€‚ç»ˆæœ‰ä¸€å¤©ï¼Œä½ ä¼šè¿›å…¥è¿™æ ·ä¸€ç§å¢ƒç•Œï¼šçœ‹ä¸€çœ¼æ•°æ®ï¼Œå·®ä¸å¤š7ç§’é’Ÿçš„æ—¶é—´ï¼Œå°±èƒ½çŸ¥é“è¿™ä¸ªæ•°æ®æ˜¯å¦å­˜åœ¨é—®é¢˜ã€‚ä¸ºäº†è¿™ä¸€çœ¼çš„åŠŸåŠ›ï¼Œæˆ‘ä»¬è¦åšå¾ˆå¤šç»ƒä¹ ã€‚</p><p>åˆšå¼€å§‹æ¥è§¦æ•°æ®ç§‘å­¦å·¥ä½œçš„æ—¶å€™ï¼Œä¸€å®šä¼šè§‰å¾—æ•°æ®æŒ–æ˜æ˜¯ä»¶å¾ˆé…·ã€å¾ˆæœ‰ä»·å€¼çš„äº‹ã€‚ç¡®å®å¦‚æ­¤ï¼Œä¸è¿‡ä»Šå¤©æˆ‘è¿˜è¦å‘Šè¯‰ä½ ï¼Œå†é…·ç‚«çš„äº‹ä¹Ÿç¦»ä¸å¼€åŸºç¡€æ€§çš„å·¥ä½œï¼Œå°±åƒæˆ‘ä»¬ä»Šå¤©è®²çš„æ•°æ®æ¸…æ´—å·¥ä½œã€‚å¯¹äºè¿™äº›åŸºç¡€æ€§çš„å·¥ä½œï¼Œæˆ‘ä»¬éœ€è¦è€ä¸‹æ€§å­ï¼Œä¸€ä¸ªå‘ä¸€ä¸ªå‘åœ°å»è§£å†³ã€‚</p><p>å¥½äº†ï¼Œæœ€åæˆ‘ä»¬æ¥æ€»ç»“ä¸‹ä»Šå¤©çš„å†…å®¹ï¼Œä½ éƒ½æ”¶è·äº†ä»€ä¹ˆï¼Ÿ</p><p><img src=\"https://static001.geekbang.org/resource/image/87/dd/87c0f81b493e99e715e9129cd3134bdd.jpg?wh=2249*1724\" alt=\"\"></p><p>å­¦ä¹ å®Œä»Šå¤©çš„å†…å®¹åï¼Œç»™ä½ ç•™ä¸ªå°ä½œä¸šå§ã€‚ä¸‹é¢æ˜¯ä¸€ä¸ªç¾é£Ÿæ•°æ®ï¼Œå¦‚æœä½ æ‹¿åˆ°ä¸‹é¢çš„æ•°æ®ï¼ŒæŒ‰ç…§æˆ‘ä»¬ä»Šå¤©è®²çš„å‡†åˆ™ï¼Œä½ èƒ½æ‰¾åˆ°å‡ ç‚¹é—®é¢˜ï¼Ÿå¦‚æœä½ æ¥æ¸…æ´—è¿™äº›æ•°æ®ï¼Œä½ æ‰“ç®—æ€æ ·æ¸…æ´—å‘¢ï¼Ÿ</p><p><img src=\"https://static001.geekbang.org/resource/image/34/fd/347fcfd86d83ff92923cbd01707a35fd.png?wh=523*355\" alt=\"\"></p><p>æ¬¢è¿åœ¨ç•™è¨€åŒºå†™ä¸‹ä½ çš„æ€è€ƒï¼Œå¦‚æœä½ å¯¹ä»Šå¤©â€œæ•°æ®æ¸…æ´—â€çš„å†…å®¹è¿˜æœ‰ç–‘é—®ï¼Œä¹Ÿæ¬¢è¿ç•™è¨€å’Œæˆ‘è®¨è®ºã€‚ä¹Ÿæ¬¢è¿ç‚¹å‡»â€œè¯·æœ‹å‹è¯»â€ï¼ŒæŠŠè¿™ç¯‡æ–‡ç« åˆ†äº«ç»™ä½ çš„æœ‹å‹æˆ–è€…åŒäº‹ã€‚</p>","neighbors":{"left":{"article_title":"10ä¸¨Pythonçˆ¬è™«ï¼šå¦‚ä½•è‡ªåŠ¨åŒ–ä¸‹è½½ç‹ç¥–è´¤æµ·æŠ¥ï¼Ÿ","id":76001},"right":{"article_title":"12 | æ•°æ®é›†æˆï¼šè¿™äº›å¤§å·ä¸€å…±20äº¿ç²‰ä¸ï¼Ÿ","id":76787}},"comments":[{"had_liked":false,"id":65444,"user_name":"third","can_delete":false,"product_type":"c1","uid":1025114,"ip_address":"","ucode":"9A37408A834F0B","user_header":"https://static001.geekbang.org/account/avatar/00/0f/a4/5a/e708e423.jpg","comment_is_top":false,"comment_ctime":1549361271,"is_pvip":false,"replies":[{"id":64608,"content":"æ„Ÿè°¢åˆ†äº«","user_name":"ä½œè€…å›å¤","user_name_real":"cy","uid":1306094,"ctime":1577622361,"ip_address":"","comment_id":65444,"utype":1}],"discussion_count":3,"race_medal":0,"score":2,"product_id":100021701,"comment_content":"è‡ªå·±ä¸çŸ¥é“æœ‰æ²¡æœ‰ä»€ä¹ˆå¥½çš„å·¥å…·ï¼Œæ‰€ä»¥å°±æŠŠå›¾ç‰‡ä¸Šä¸€ä¸ªä¸€ä¸ªæ•²è¿›å»äº†ã€‚\næ•°æ®.csvæ ¼å¼\né“¾æ¥ï¼šhttps:&#47;&#47;pan.baidu.com&#47;s&#47;1jNnUpntrlxFSubmna3HtXw \næå–ç ï¼še9hc","like_count":47},{"had_liked":false,"id":58524,"user_name":"wonderland","can_delete":false,"product_type":"c1","uid":1362584,"ip_address":"","ucode":"ACA8577C9EDE88","user_header":"https://static001.geekbang.org/account/avatar/00/14/ca/98/a75e400b.jpg","comment_is_top":false,"comment_ctime":1547102914,"is_pvip":false,"replies":[{"id":64790,"content":"Good Job","user_name":"ä½œè€…å›å¤","user_name_real":"cy","uid":1306094,"ctime":1577625591,"ip_address":"","comment_id":58524,"utype":1}],"discussion_count":5,"race_medal":0,"score":2,"product_id":100021701,"comment_content":"ä¸€ã€é¦–å…ˆæŒ‰ç…§æ‰€è®²çš„æ•°æ®è´¨é‡å‡†åˆ™ï¼Œæ•°æ®å­˜åœ¨çš„é—®é¢˜æœ‰ï¼š\n1.&quot;å®Œæ•´æ€§&quot;é—®é¢˜ï¼šæ•°æ®æœ‰ç¼ºå¤±ï¼Œåœ¨ouncesåˆ—çš„ç¬¬ä¸‰è¡Œå­˜åœ¨ç¼ºå¤±å€¼\nå¤„ç†åŠæ³•ï¼šå¯ä»¥ç”¨è¯¥åˆ—çš„å¹³å‡å€¼æ¥å¡«å……æ­¤ç¼ºå¤±å€¼\n2.â€œå…¨é¢æ€§â€é—®é¢˜ï¼šfoodåˆ—çš„å€¼å¤§å°å†™ä¸ç»Ÿä¸€\nå¤„ç†åŠæ³•ï¼šç»Ÿä¸€æ”¹ä¸ºå°å†™\n3.â€œåˆç†æ€§â€é—®é¢˜ï¼šæŸä¸€è¡Œçš„ounceså€¼å‡ºç°è´Ÿå€¼\nå¤„ç†åŠæ³•ï¼šå°†è¯¥æ¡æ•°æ®è®°å½•åˆ é™¤\n4.â€œå”¯ä¸€æ€§â€é—®é¢˜ï¼šfoodåˆ—å¤§å°å†™ç»Ÿä¸€åä¼šå‡ºç°åŒåç°è±¡ï¼Œ\nå¤„ç†åŠæ³•ï¼šéœ€è¦å°†foodåˆ—å’Œanimalåˆ—å€¼å‡ç›¸åŒçš„æ•°æ®è®°å½•è¿›è¡Œåˆå¹¶åˆ°åŒä¸€å¤©è®°å½•ä¸­å›½","like_count":45,"discussions":[{"author":{"id":1306094,"avatar":"https://static001.geekbang.org/account/avatar/00/13/ed/ee/c4779b67.jpg","nickname":"cy","note":"","ucode":"50D653399A31F6","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":438453,"discussion_content":"æ„Ÿè°¢åˆ†äº«","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1577622361,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1594560,"avatar":"https://static001.geekbang.org/account/avatar/00/18/54/c0/94dd77d2.jpg","nickname":"éœè·‘è·‘","note":"","ucode":"EF7454E2A0E031","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":2022,"discussion_content":"å¤šè°¢å…ˆè¡Œè€…","likes_number":1,"is_delete":false,"is_hidden":false,"ctime":1563182048,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1028558,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/b1/ce/3d7f253c.jpg","nickname":"Oreo0206:)","note":"","ucode":"2EA4965506E23C","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":269928,"discussion_content":"æ„Ÿè°¢åˆ†äº«ï¼Œä½†åˆ†äº«æ–‡ä»¶å·²ç»ä¸å­˜åœ¨äº†","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1589964593,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":85129,"user_name":"æ»¢","can_delete":false,"product_type":"c1","uid":1221511,"ip_address":"","ucode":"971A6F20AF3F9A","user_header":"https://static001.geekbang.org/account/avatar/00/12/a3/87/c415e370.jpg","comment_is_top":false,"comment_ctime":1554986281,"is_pvip":false,"replies":[{"id":64268,"content":"æ»¢åŒå­¦å¾ˆå¥½çš„åˆ†äº«ï¼","user_name":"ä½œè€…å›å¤","user_name_real":"cy","uid":1306094,"ctime":1577615723,"ip_address":"","comment_id":85129,"utype":1}],"discussion_count":6,"race_medal":0,"score":2,"product_id":100021701,"comment_content":"åŸå§‹æ•°æ®é“¾æ¥ï¼šhttps:&#47;&#47;github.com&#47;onlyAngelia&#47;Read-Mark&#47;blob&#47;master&#47;æ•°æ®åˆ†æ&#47;geekTime&#47;data&#47;accountMessage.xlsx    ï¼ˆè¯¾ç¨‹ä¸­è®²è§£åŸå§‹æ•°æ®-ç‚¹å‡»view Rawå³å¯ä¸‹è½½ï¼‰\nè¯¾åç»ƒä¹ åŸå§‹æ•°æ®: https:&#47;&#47;github.com&#47;onlyAngelia&#47;Read-Mark&#47;blob&#47;master&#47;æ•°æ®åˆ†æ&#47;geekTime&#47;data&#47;foodInformation.xlsx ï¼ˆç‚¹å‡»View Rawä¸‹è½½ï¼‰","like_count":38,"discussions":[{"author":{"id":1306094,"avatar":"https://static001.geekbang.org/account/avatar/00/13/ed/ee/c4779b67.jpg","nickname":"cy","note":"","ucode":"50D653399A31F6","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":436107,"discussion_content":"Good Job","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1577625591,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1402511,"avatar":"https://static001.geekbang.org/account/avatar/00/15/66/8f/02be926d.jpg","nickname":"åœ¨è·¯ä¸Š","note":"","ucode":"6E31908EFE1107","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":537103,"discussion_content":"æ€»ç»“çš„å¾ˆæ£’!","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1638957084,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":2546519,"avatar":"https://static001.geekbang.org/account/avatar/00/26/db/57/67084c71.jpg","nickname":"ç®€å•","note":"","ucode":"640B84253343AB","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":368974,"discussion_content":"åŒä¸€å¤©è®°å½•ä¸­å›½ï¼Ÿä»€ä¹ˆé¬¼ï¼Ÿ","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1618892860,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":2443427,"avatar":"https://static001.geekbang.org/account/avatar/00/25/48/a3/2df11999.jpg","nickname":"Boom clap!!!","note":"","ucode":"E9AF8ECB963239","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":366143,"discussion_content":"ä¿©æ¡æ•°æ®æ€ä¹ˆåˆå¹¶å‘¢","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1617969746,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1040331,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/df/cb/81317179.jpg","nickname":"æ±ªç‰æ–Œ","note":"","ucode":"698975CA69D1E6","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":212277,"discussion_content":"æ€»ç»“çš„å¾ˆæ£’!","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1584953632,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":68589,"user_name":"Geek_5hxn61","can_delete":false,"product_type":"c1","uid":1361640,"ip_address":"","ucode":"435FEBF630BAB8","user_header":"https://thirdwx.qlogo.cn/mmopen/vi_32/DYAIOgq83eonMJazpAb9sj7ialYVsumyv9wC1F8RTHpmBPMgj7yNDmof7cpuONtultJc8NRlLyQ34uHjmxByfPg/132","comment_is_top":false,"comment_ctime":1550550890,"is_pvip":false,"replies":[{"id":64532,"content":"Good Job","user_name":"ä½œè€…å›å¤","user_name_real":"cy","uid":1306094,"ctime":1577621343,"ip_address":"","comment_id":68589,"utype":1}],"discussion_count":2,"race_medal":0,"score":2,"product_id":100021701,"comment_content":"import pandas as pd\n&quot;&quot;&quot;åˆ©ç”¨Pandasæ¸…æ´—ç¾é£Ÿæ•°æ®&quot;&quot;&quot;\n\n# è¯»å–csvæ–‡ä»¶\ndf = pd.read_csv(&quot;c.csv&quot;)\n\ndf[&#39;food&#39;] = df[&#39;food&#39;].str.lower()  # ç»Ÿä¸€ä¸ºå°å†™å­—æ¯\ndf.dropna(inplace=True)  # åˆ é™¤æ•°æ®ç¼ºå¤±çš„è®°å½•\ndf[&#39;ounces&#39;] = df[&#39;ounces&#39;].apply(lambda a: abs(a))  # è´Ÿå€¼ä¸åˆæ³•ï¼Œå–ç»å¯¹å€¼\n\n# æŸ¥æ‰¾foodé‡å¤çš„è®°å½•ï¼Œåˆ†ç»„æ±‚å…¶å¹³å‡å€¼\nd_rows = df[df[&#39;food&#39;].duplicated(keep=False)]\ng_items = d_rows.groupby(&#39;food&#39;).mean()\ng_items[&#39;food&#39;] = g_items.index\nprint(g_items)\n\n# éå†å°†é‡å¤foodçš„å¹³å‡å€¼èµ‹å€¼ç»™df\nfor i, row in g_items.iterrows():\n    df.loc[df.food == row.food, &#39;ounces&#39;] = row.ounces\ndf.drop_duplicates(inplace=True)  # åˆ é™¤é‡å¤è®°å½•\n\ndf.index = range(len(df))  # é‡è®¾ç´¢å¼•å€¼\nprint(df)","like_count":26,"discussions":[{"author":{"id":1306094,"avatar":"https://static001.geekbang.org/account/avatar/00/13/ed/ee/c4779b67.jpg","nickname":"cy","note":"","ucode":"50D653399A31F6","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":439740,"discussion_content":"Good Job","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1577621343,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1187061,"avatar":"https://static001.geekbang.org/account/avatar/00/12/1c/f5/fd386689.jpg","nickname":"Venom","note":"","ucode":"2055AC6F322781","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":69199,"discussion_content":"å‰å®³å‰å®³","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1575270227,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":57686,"user_name":"è¥¿å—ååŒ—","can_delete":false,"product_type":"c1","uid":1062864,"ip_address":"","ucode":"5815D63C4926BC","user_header":"https://static001.geekbang.org/account/avatar/00/10/37/d0/26975fba.jpg","comment_is_top":false,"comment_ctime":1546868657,"is_pvip":false,"replies":[{"id":20936,"content":"å¯¹çš„ ä¸€å®šè¦è‡ªå·±æ¨¡æ‹Ÿæ“ä½œä¸‹","user_name":"ä½œè€…å›å¤","user_name_real":"cy","uid":1306094,"ctime":1547000948,"ip_address":"","comment_id":57686,"utype":1}],"discussion_count":1,"race_medal":0,"score":2,"product_id":100021701,"comment_content":"è¿™äº›ä¸œè¥¿ï¼Œå¤§å®¶éƒ½ä¸€å®šè¦ä¸Šæ‰‹å»å®ç°ä¸€éã€‚æœ€ç®€å•çš„å°±æ˜¯ï¼Œæä¸€ä¸ªæ–‡æœ¬ï¼ŒæŠŠè¿™äº›æ•°æ®æ”¾è¿›å»ï¼Œç”¨Pythonè¯»è¿™ä¸ªæ–‡æœ¬ï¼Œè½¬æˆdataframeï¼ŒæŠŠè€å¸ˆè®²çš„é‚£äº›æ¸…æ´—ç›¸å…³çš„APIéƒ½ä¸€ä¸ªä¸€ä¸ªè¯•ä¸€ä¸‹ï¼Œæ‰ä¼šæœ‰ä½“ä¼šï¼Œå…‰çœ‹ä¸€éçœŸçš„æ²¡å•¥ç”¨çš„ï¼\nç°åœ¨åªæ˜¯å¾ˆå°‘çš„å‡ åæ¡æ•°æ®ï¼Œç­‰ä½ çœŸæ­£å»æé‚£äº›ä¸Šäº¿çš„æ•°æ®çš„æ—¶å€™ï¼Œå°±çŸ¥é“æ ¸å¯¹æ•°æ®æ˜¯ä¸ªå¤šä¹ˆå¤æ‚çš„äº‹æƒ…äº†â€¦â€¦","like_count":16,"discussions":[{"author":{"id":1306094,"avatar":"https://static001.geekbang.org/account/avatar/00/13/ed/ee/c4779b67.jpg","nickname":"cy","note":"","ucode":"50D653399A31F6","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":439740,"discussion_content":"Good Job","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1577621343,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1187061,"avatar":"https://static001.geekbang.org/account/avatar/00/12/1c/f5/fd386689.jpg","nickname":"Venom","note":"","ucode":"2055AC6F322781","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":69199,"discussion_content":"å‰å®³å‰å®³","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1575270227,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":85004,"user_name":"æ»¢","can_delete":false,"product_type":"c1","uid":1221511,"ip_address":"","ucode":"971A6F20AF3F9A","user_header":"https://static001.geekbang.org/account/avatar/00/12/a3/87/c415e370.jpg","comment_is_top":false,"comment_ctime":1554954750,"is_pvip":false,"replies":[{"id":64273,"content":"ä¸é”™çš„åˆ†äº«","user_name":"ä½œè€…å›å¤","user_name_real":"cy","uid":1306094,"ctime":1577615835,"ip_address":"","comment_id":85004,"utype":1}],"discussion_count":2,"race_medal":0,"score":2,"product_id":100021701,"comment_content":"è§‰å¾—å®Œå…¨åˆä¸€åŸåˆ™æŒºå¥½ï¼Œä¸è¿‡æœ‰äº›æ“ä½œé¡ºåºæ˜¯ä¸æ˜¯å¾—æ›´æ”¹ä¸€ä¸‹ï¼Œæ¯”å¦‚æ•°å€¼è¡¥å…¨è¦åœ¨åˆ é™¤å…¨ç©ºè¡Œä¹‹åï¼Œå¦åˆ™åœ¨è¡¥å…¨çš„æ—¶å€™å…¨ç©ºè¡Œä¹Ÿä¼šè¡¥å…¨ã€‚æ¥ä¸‹æ¥æ€»ç»“åœ¨æ¸…æ´—è¿‡ç¨‹ä¸­çš„é—®é¢˜ï¼šï¼ˆ1ï¼‰ ä¸çŸ¥é“Python2 æ‰§è¡Œæƒ…å†µå¦‚ä½•ï¼Œåœ¨ç”¨Python3è¿›è¡Œæ•°æ®æ¸…ç†çš„æ—¶å€™ï¼Œå¯¹äºå¥³æ€§ä¸‰å›´æ•°æ®è¡¥å…¨çš„æ—¶å€™å› ä¸ºåˆ—ä¸­æœ‰ç©ºå­—ç¬¦çš„å­˜åœ¨ï¼Œä¼šæç¤ºâ€˜must str not intâ€™,éœ€è¦è‡ªå·±è¿‡æ»¤å«æœ‰æ•°å€¼çš„æœ‰æ•ˆæ•°æ®è¿›è¡Œmean()è®¡ç®—ã€‚  (2)ç”Ÿæˆçš„æ–°åˆ—ä¸€èˆ¬ä¼šè‡ªåŠ¨è¡¥åˆ°åé¢ï¼Œä½†first_name,last_nameéœ€è¦åœ¨ç¬¬ä¸€åˆ—å’Œç¬¬äºŒåˆ—ï¼Œæ‰€ä»¥è¦è¿›è¡Œåˆ—ç§»åŠ¨æˆ–åˆ—äº¤æ¢ã€‚(3)åœ¨åˆ é™¤æ•°æ®ä¹‹åé»˜è®¤åŠ è½½çš„ç´¢å¼•ä¼šå‡ºç°é—®é¢˜ï¼Œéœ€è¦è‡ªå·±æ›´æ–°ç´¢å¼•","like_count":9,"discussions":[{"author":{"id":1306094,"avatar":"https://static001.geekbang.org/account/avatar/00/13/ed/ee/c4779b67.jpg","nickname":"cy","note":"","ucode":"50D653399A31F6","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":446527,"discussion_content":"ä¸é”™çš„åˆ†äº«","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1577615835,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1939199,"avatar":"http://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTJ2I86HeBpalc1SlDpicfCxeHic4nAOa9anTmfKOWqjuto1Yib9sxW1zuIpc1pVtJQsiazpMxvnKQ2stg/132","nickname":"ç”°æ­","note":"","ucode":"B35F0FD63CFF78","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":285637,"discussion_content":"æƒ³è¯·é—®ä¸€ä¸‹ï¼Œç¬¬ï¼ˆ1ï¼‰ç‚¹åº”è¯¥æ€ä¹ˆè¿‡æ»¤å«æœ‰æ•°å€¼çš„æœ‰æ•ˆæ•°æ®ï¼Ÿè¿˜æœ‰ç¬¬ï¼ˆ3ï¼‰ç‚¹æ€ä¹ˆæ›´æ–°ç´¢å¼•ï¼Ÿæ˜¯éœ€è¦è‡ªå·±æ‰‹åŠ¨å†™åºå·å—ï¼Ÿæ±‚æŒ‡ç‚¹ï¼Œå¤šè°¢","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1592900833,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":59084,"user_name":"å‘¨é£","can_delete":false,"product_type":"c1","uid":1073374,"ip_address":"","ucode":"F85FA236EB0C0D","user_header":"https://static001.geekbang.org/account/avatar/00/10/60/de/5c67895a.jpg","comment_is_top":false,"comment_ctime":1547297535,"is_pvip":false,"replies":[{"id":64770,"content":"Good Job","user_name":"ä½œè€…å›å¤","user_name_real":"cy","uid":1306094,"ctime":1577625297,"ip_address":"","comment_id":59084,"utype":1}],"discussion_count":1,"race_medal":0,"score":2,"product_id":100021701,"comment_content":"å®Œæ•´æ€§ï¼šounces åˆ—æ•°æ®ä¸­å­˜åœ¨NAN\nå…¨é¢æ€§ï¼šfoodåˆ—æ•°æ®ä¸­å­˜åœ¨å¤§å°å†™ä¸ä¸€è‡´é—®é¢˜\nåˆæ³•æ€§ï¼šouncesåˆ—æ•°æ®å­˜åœ¨è´Ÿå€¼\nå”¯ä¸€æ€§ï¼šfoodåˆ—æ•°æ®å­˜åœ¨é‡å¤\n# -*- coding: utf-8 -*\nimport pandas as pd\nimport numpy as np\nfrom pandas import Series, DataFrame\ndf = pd.read_csv(&#39;.&#47;fooddata.csv&#39;)\n# æŠŠounces åˆ—ä¸­çš„NaNæ›¿æ¢ä¸ºå¹³å‡å€¼\ndf[&#39;ounces&#39;].fillna(df[&#39;ounces&#39;].mean(), inplace=True)\n# æŠŠfoodåˆ—ä¸­çš„å¤§å†™å­—æ¯å…¨éƒ¨è½¬æ¢ä¸ºå°å†™\ndf[&#39;food&#39;] = df[&#39;food&#39;].str.lower()\n# æŠŠounces åˆ—ä¸­çš„è´Ÿæ•°è½¬åŒ–ä¸ºæ­£æ•°\ndf[&#39;ounces&#39;]= df[&#39;ounces&#39;].apply(lambda x: abs(x))\n#åˆ é™¤foodåˆ—ä¸­çš„é‡å¤å€¼\ndf.drop_duplicates(&#39;food&#39;,inplace=True)\nprint (df)\n","like_count":6,"discussions":[{"author":{"id":1306094,"avatar":"https://static001.geekbang.org/account/avatar/00/13/ed/ee/c4779b67.jpg","nickname":"cy","note":"","ucode":"50D653399A31F6","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":436295,"discussion_content":"Good Job","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1577625297,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":57899,"user_name":"ä¸Šå®˜","can_delete":false,"product_type":"c1","uid":1353145,"ip_address":"","ucode":"037968A8E0C566","user_header":"http://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTJAeZ2VCia2y3bW9N7EMfgBqX8WClXUydwaXDPcK7Bm3XaMnMKx7q5ffA0UuTeJmEusxtQAibf8djCA/132","comment_is_top":false,"comment_ctime":1546937210,"is_pvip":false,"replies":[{"id":20922,"content":"æˆªå–ä»å¤´å¼€å§‹åˆ°å€’æ•°ç¬¬ä¸‰ä¸ªå­—ç¬¦ä¹‹å‰ï¼Œå³å»æ‰lbsã€‚","user_name":"ä½œè€…å›å¤","user_name_real":"cy","uid":1306094,"ctime":1546999598,"ip_address":"","comment_id":57899,"utype":1}],"discussion_count":1,"race_medal":0,"score":2,"product_id":100021701,"comment_content":"weight = int(float((lbs_row[&#39;weight&#39;][:-3])&#47;2.2)\nè€å¸ˆå¥½ï¼Œè¿™è¡Œä»£ç ä¸­[ï¼š-3]çš„ä½œç”¨æ˜¯ä»€ä¹ˆå•Šï¼Ÿ\n\n\n","like_count":6,"discussions":[{"author":{"id":1306094,"avatar":"https://static001.geekbang.org/account/avatar/00/13/ed/ee/c4779b67.jpg","nickname":"cy","note":"","ucode":"50D653399A31F6","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":435817,"discussion_content":"æˆªå–ä»å¤´å¼€å§‹åˆ°å€’æ•°ç¬¬ä¸‰ä¸ªå­—ç¬¦ä¹‹å‰ï¼Œå³å»æ‰lbsã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1546999598,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":58797,"user_name":"åŒ—æ–¹","can_delete":false,"product_type":"c1","uid":1114754,"ip_address":"","ucode":"D04589B652AC29","user_header":"https://static001.geekbang.org/account/avatar/00/11/02/82/abed70a0.jpg","comment_is_top":false,"comment_ctime":1547195220,"is_pvip":false,"replies":[{"id":64777,"content":"Good Job","user_name":"ä½œè€…å›å¤","user_name_real":"cy","uid":1306094,"ctime":1577625415,"ip_address":"","comment_id":58797,"utype":1}],"discussion_count":1,"race_medal":0,"score":2,"product_id":100021701,"comment_content":"#!&#47;usr&#47;bin&#47;env python\n# -*- coding:utf8 -*-\n# __author__ = &#39;åŒ—æ–¹å§†Q&#39;\n# __datetime__ = 2019&#47;1&#47;11 15:53\n\n\nimport pandas as pd\n\n# å¯¼å…¥\ndf = pd.read_csv(&quot;.&#47;s11.csv&quot;)\n# å»é™¤å®Œå…¨çš„ç©ºè¡Œ\ndf.dropna(how=&#39;all&#39;, inplace=True)\n# é£Ÿç‰©ååˆ‡åˆ†å¹¶å»æ‰åŸæœ¬åˆ—\ndf[[&quot;first_name&quot;, &quot;last_name&quot;]] = df[&quot;food&quot;].str.split(expand=True)\ndf.drop(&quot;food&quot;, axis=1, inplace=True)\n# åç§°é¦–å­—æ¯å¤§å†™\ndf[&quot;first_name&quot;] = df[&quot;first_name&quot;].str.capitalize()\ndf[&quot;last_name&quot;] = df[&quot;last_name&quot;].str.capitalize()\n# ä»¥é£Ÿç‰©åä¸ºæ ‡å‡†å»é‡\ndf.drop_duplicates([&quot;first_name&quot;, &quot;last_name&quot;], inplace=True)\n\nprint(df)","like_count":3,"discussions":[{"author":{"id":1306094,"avatar":"https://static001.geekbang.org/account/avatar/00/13/ed/ee/c4779b67.jpg","nickname":"cy","note":"","ucode":"50D653399A31F6","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":436212,"discussion_content":"Good Job","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1577625415,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":149128,"user_name":"qinggeouye","can_delete":false,"product_type":"c1","uid":1251536,"ip_address":"","ucode":"5B53EEDD7BEC9C","user_header":"https://static001.geekbang.org/account/avatar/00/13/18/d0/49b06424.jpg","comment_is_top":false,"comment_ctime":1573155240,"is_pvip":false,"replies":[{"id":59815,"content":"ä¸é”™ æŠŠä»£ç æ”¾åˆ°GitHubä¸Šæ˜¯å¾ˆå¥½çš„æ–¹å¼","user_name":"ä½œè€…å›å¤","user_name_real":"cy","uid":1306094,"ctime":1574756605,"ip_address":"","comment_id":149128,"utype":1}],"discussion_count":2,"race_medal":0,"score":2,"product_id":100021701,"comment_content":"https:&#47;&#47;github.com&#47;qinggeouye&#47;GeekTime&#47;blob&#47;master&#47;DataAnalysis&#47;11_data_clean.py\n\nimport pandas as pd\n\n# è¯»å–æ•°æ®\ndata_init = pd.read_csv(&quot;.&#47;11_clothingStoreMembers.csv&quot;)\n\n# æ¸…æ´—æ•°æ®\n\n# åˆ é™¤ &#39;\\t&#39; åˆ—, è¯»å– csv æ–‡ä»¶å¤šäº†ä¸€åˆ—\ndata_init.drop(columns=&#39;\\t&#39;, inplace=True)\n# é‡å‘½ååˆ—å\ndata_init.rename(\n    columns={&quot;0&quot;: &quot;SEQ&quot;, &quot;1&quot;: &quot;NAME&quot;, &quot;2&quot;: &quot;AGE&quot;, &quot;3&quot;: &quot;WEIGHT&quot;, &quot;4&quot;: &quot;BUST_M&quot;, &quot;5&quot;: &quot;WAIST_M&quot;, &quot;6&quot;: &quot;HIP_M&quot;,\n             &quot;7&quot;: &quot;BUST_F&quot;, &quot;8&quot;: &quot;WAIST_F&quot;, &quot;9&quot;: &quot;HIP_F&quot;}, inplace=True)\nprint(data_init)\n\n# 1ã€å®Œæ•´æ€§\n# åˆ é™¤ç©ºè¡Œ\ndata_init.dropna(how=&#39;all&#39;, inplace=True)\n\n# 4ã€å”¯ä¸€æ€§\n# ä¸€åˆ—å¤šä¸ªå‚æ•°åˆ‡åˆ†\ndata_init[[&quot;FIRST_NAME&quot;, &quot;LAST_NAME&quot;]] = data_init[&quot;NAME&quot;].str.split(expand=True)\ndata_init.drop(&quot;NAME&quot;, axis=1, inplace=True)\n# åˆ é™¤é‡å¤æ•°æ®\ndata_init.drop_duplicates([&quot;FIRST_NAME&quot;, &quot;LAST_NAME&quot;], inplace=True)\n\n# 2ã€å…¨é¢æ€§\n# åˆ—æ•°æ®å•ä½ç»Ÿä¸€, ä½“é‡ WEIGHT å•ä½ç»Ÿä¸€ï¼ˆlbs è‹±é•‘ï¼Œ kg åƒå…‹ï¼‰\nrows_with_lbs = data_init[&quot;WEIGHT&quot;].str.contains(&quot;lbs&quot;).fillna(False)\nprint(rows_with_lbs)\n# lbs è½¬ä¸º kg\nfor i, lbs_row in data_init[rows_with_lbs].iterrows():\n    weight = int(float(lbs_row[&quot;WEIGHT&quot;][:-3]) &#47; 2.2)\n    data_init.at[i, &quot;WEIGHT&quot;] = &quot;{}kgs&quot;.format(weight)\nprint(data_init)\n\n# 3ã€åˆç†æ€§\n# é ASCII å­—ç¬¦è½¬æ¢ï¼Œè¿™é‡Œåˆ é™¤å¤„ç†\ndata_init[&quot;FIRST_NAME&quot;].replace({r&#39;[^\\x00-\\x7F]+&#39;: &#39;&#39;}, regex=True, inplace=True)\ndata_init[&quot;LAST_NAME&quot;].replace({r&#39;[^\\x00-\\x7F]+&#39;: &#39;&#39;}, regex=True, inplace=True)\n\n# 1ã€å®Œæ•´æ€§\n# è¡¥å……ç¼ºå¤±å€¼-å‡å€¼è¡¥å……\ndata_init[&quot;AGE&quot;].fillna(data_init[&quot;AGE&quot;].mean(), inplace=True)\n# ä½“é‡å…ˆå»æ‰ kgs çš„å•ä½ç¬¦å·\ndata_init[&quot;WEIGHT&quot;].replace(&#39;kgs$&#39;, &#39;&#39;, regex=True, inplace=True)  # ä¸å¸¦å•ä½ç¬¦å· kgs\ndata_init[&quot;WEIGHT&quot;] = data_init[&quot;WEIGHT&quot;].astype(&#39;float&#39;)\ndata_init[&quot;WEIGHT&quot;].fillna(data_init[&quot;WEIGHT&quot;].mean(), inplace=True)\n\ndata_init.replace(&#39;-&#39;, 0, regex=True, inplace=True)  # è¯»å–çš„ csv æ•°æ®å¤šäº†&#39;-&#39;\ndata_init[&quot;WAIST_F&quot;] = data_init[&quot;WAIST_F&quot;].astype(&#39;float&#39;)\ndata_init[&quot;WAIST_F&quot;].fillna(data_init[&quot;WAIST_F&quot;].mean(), inplace=True)\n\n# ç”¨æœ€é«˜é¢‘çš„æ•°æ®å¡«å……\nage_max_freq = data_init[&quot;AGE&quot;].value_counts().index[0]\nprint(age_max_freq)\ndata_init[&quot;AGE&quot;].fillna(age_max_freq, inplace=True)\nprint(data_init)","like_count":2,"discussions":[{"author":{"id":1306094,"avatar":"https://static001.geekbang.org/account/avatar/00/13/ed/ee/c4779b67.jpg","nickname":"cy","note":"","ucode":"50D653399A31F6","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":473745,"discussion_content":"ä¸é”™ æŠŠä»£ç æ”¾åˆ°GitHubä¸Šæ˜¯å¾ˆå¥½çš„æ–¹å¼","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1574756605,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1320751,"avatar":"https://static001.geekbang.org/account/avatar/00/14/27/2f/48607919.jpg","nickname":"$KIiiijiii","note":"","ucode":"0F2F14A8956E9F","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":414244,"discussion_content":"å‘ç°åºå·8çš„ç©ºè¡Œæ— æ³•åˆ é™¤ï¼Œå› ä¸ºä»–ä¸æ˜¯å…¨ç©º","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1636700697,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":65444,"user_name":"third","can_delete":false,"product_type":"c1","uid":1025114,"ip_address":"","ucode":"9A37408A834F0B","user_header":"https://static001.geekbang.org/account/avatar/00/0f/a4/5a/e708e423.jpg","comment_is_top":false,"comment_ctime":1549361271,"is_pvip":false,"replies":[{"id":64608,"content":"æ„Ÿè°¢åˆ†äº«","user_name":"ä½œè€…å›å¤","user_name_real":"cy","uid":1306094,"ctime":1577622361,"ip_address":"","comment_id":65444,"utype":1}],"discussion_count":3,"race_medal":0,"score":2,"product_id":100021701,"comment_content":"è‡ªå·±ä¸çŸ¥é“æœ‰æ²¡æœ‰ä»€ä¹ˆå¥½çš„å·¥å…·ï¼Œæ‰€ä»¥å°±æŠŠå›¾ç‰‡ä¸Šä¸€ä¸ªä¸€ä¸ªæ•²è¿›å»äº†ã€‚\næ•°æ®.csvæ ¼å¼\né“¾æ¥ï¼šhttps:&#47;&#47;pan.baidu.com&#47;s&#47;1jNnUpntrlxFSubmna3HtXw \næå–ç ï¼še9hc","like_count":47,"discussions":[{"author":{"id":1306094,"avatar":"https://static001.geekbang.org/account/avatar/00/13/ed/ee/c4779b67.jpg","nickname":"cy","note":"","ucode":"50D653399A31F6","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":438453,"discussion_content":"æ„Ÿè°¢åˆ†äº«","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1577622361,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1594560,"avatar":"https://static001.geekbang.org/account/avatar/00/18/54/c0/94dd77d2.jpg","nickname":"éœè·‘è·‘","note":"","ucode":"EF7454E2A0E031","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":2022,"discussion_content":"å¤šè°¢å…ˆè¡Œè€…","likes_number":1,"is_delete":false,"is_hidden":false,"ctime":1563182048,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1028558,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/b1/ce/3d7f253c.jpg","nickname":"Oreo0206:)","note":"","ucode":"2EA4965506E23C","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":269928,"discussion_content":"æ„Ÿè°¢åˆ†äº«ï¼Œä½†åˆ†äº«æ–‡ä»¶å·²ç»ä¸å­˜åœ¨äº†","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1589964593,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":58524,"user_name":"wonderland","can_delete":false,"product_type":"c1","uid":1362584,"ip_address":"","ucode":"ACA8577C9EDE88","user_header":"https://static001.geekbang.org/account/avatar/00/14/ca/98/a75e400b.jpg","comment_is_top":false,"comment_ctime":1547102914,"is_pvip":false,"replies":[{"id":64790,"content":"Good Job","user_name":"ä½œè€…å›å¤","user_name_real":"cy","uid":1306094,"ctime":1577625591,"ip_address":"","comment_id":58524,"utype":1}],"discussion_count":5,"race_medal":0,"score":2,"product_id":100021701,"comment_content":"ä¸€ã€é¦–å…ˆæŒ‰ç…§æ‰€è®²çš„æ•°æ®è´¨é‡å‡†åˆ™ï¼Œæ•°æ®å­˜åœ¨çš„é—®é¢˜æœ‰ï¼š\n1.&quot;å®Œæ•´æ€§&quot;é—®é¢˜ï¼šæ•°æ®æœ‰ç¼ºå¤±ï¼Œåœ¨ouncesåˆ—çš„ç¬¬ä¸‰è¡Œå­˜åœ¨ç¼ºå¤±å€¼\nå¤„ç†åŠæ³•ï¼šå¯ä»¥ç”¨è¯¥åˆ—çš„å¹³å‡å€¼æ¥å¡«å……æ­¤ç¼ºå¤±å€¼\n2.â€œå…¨é¢æ€§â€é—®é¢˜ï¼šfoodåˆ—çš„å€¼å¤§å°å†™ä¸ç»Ÿä¸€\nå¤„ç†åŠæ³•ï¼šç»Ÿä¸€æ”¹ä¸ºå°å†™\n3.â€œåˆç†æ€§â€é—®é¢˜ï¼šæŸä¸€è¡Œçš„ounceså€¼å‡ºç°è´Ÿå€¼\nå¤„ç†åŠæ³•ï¼šå°†è¯¥æ¡æ•°æ®è®°å½•åˆ é™¤\n4.â€œå”¯ä¸€æ€§â€é—®é¢˜ï¼šfoodåˆ—å¤§å°å†™ç»Ÿä¸€åä¼šå‡ºç°åŒåç°è±¡ï¼Œ\nå¤„ç†åŠæ³•ï¼šéœ€è¦å°†foodåˆ—å’Œanimalåˆ—å€¼å‡ç›¸åŒçš„æ•°æ®è®°å½•è¿›è¡Œåˆå¹¶åˆ°åŒä¸€å¤©è®°å½•ä¸­å›½","like_count":45,"discussions":[{"author":{"id":1306094,"avatar":"https://static001.geekbang.org/account/avatar/00/13/ed/ee/c4779b67.jpg","nickname":"cy","note":"","ucode":"50D653399A31F6","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":436107,"discussion_content":"Good Job","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1577625591,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1402511,"avatar":"https://static001.geekbang.org/account/avatar/00/15/66/8f/02be926d.jpg","nickname":"åœ¨è·¯ä¸Š","note":"","ucode":"6E31908EFE1107","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":537103,"discussion_content":"æ€»ç»“çš„å¾ˆæ£’!","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1638957084,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":2546519,"avatar":"https://static001.geekbang.org/account/avatar/00/26/db/57/67084c71.jpg","nickname":"ç®€å•","note":"","ucode":"640B84253343AB","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":368974,"discussion_content":"åŒä¸€å¤©è®°å½•ä¸­å›½ï¼Ÿä»€ä¹ˆé¬¼ï¼Ÿ","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1618892860,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":2443427,"avatar":"https://static001.geekbang.org/account/avatar/00/25/48/a3/2df11999.jpg","nickname":"Boom clap!!!","note":"","ucode":"E9AF8ECB963239","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":366143,"discussion_content":"ä¿©æ¡æ•°æ®æ€ä¹ˆåˆå¹¶å‘¢","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1617969746,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1040331,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/df/cb/81317179.jpg","nickname":"æ±ªç‰æ–Œ","note":"","ucode":"698975CA69D1E6","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":212277,"discussion_content":"æ€»ç»“çš„å¾ˆæ£’!","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1584953632,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":85129,"user_name":"æ»¢","can_delete":false,"product_type":"c1","uid":1221511,"ip_address":"","ucode":"971A6F20AF3F9A","user_header":"https://static001.geekbang.org/account/avatar/00/12/a3/87/c415e370.jpg","comment_is_top":false,"comment_ctime":1554986281,"is_pvip":false,"replies":[{"id":64268,"content":"æ»¢åŒå­¦å¾ˆå¥½çš„åˆ†äº«ï¼","user_name":"ä½œè€…å›å¤","user_name_real":"cy","uid":1306094,"ctime":1577615723,"ip_address":"","comment_id":85129,"utype":1}],"discussion_count":6,"race_medal":0,"score":2,"product_id":100021701,"comment_content":"åŸå§‹æ•°æ®é“¾æ¥ï¼šhttps:&#47;&#47;github.com&#47;onlyAngelia&#47;Read-Mark&#47;blob&#47;master&#47;æ•°æ®åˆ†æ&#47;geekTime&#47;data&#47;accountMessage.xlsx    ï¼ˆè¯¾ç¨‹ä¸­è®²è§£åŸå§‹æ•°æ®-ç‚¹å‡»view Rawå³å¯ä¸‹è½½ï¼‰\nè¯¾åç»ƒä¹ åŸå§‹æ•°æ®: https:&#47;&#47;github.com&#47;onlyAngelia&#47;Read-Mark&#47;blob&#47;master&#47;æ•°æ®åˆ†æ&#47;geekTime&#47;data&#47;foodInformation.xlsx ï¼ˆç‚¹å‡»View Rawä¸‹è½½ï¼‰","like_count":38,"discussions":[{"author":{"id":1306094,"avatar":"https://static001.geekbang.org/account/avatar/00/13/ed/ee/c4779b67.jpg","nickname":"cy","note":"","ucode":"50D653399A31F6","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":446567,"discussion_content":"æ»¢åŒå­¦å¾ˆå¥½çš„åˆ†äº«ï¼","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1577615723,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1995338,"avatar":"https://static001.geekbang.org/account/avatar/00/1e/72/4a/e916629c.jpg","nickname":"Ceci","note":"","ucode":"11F89A3FFA1232","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":264223,"discussion_content":"ç‚¹å‡»view Raw  æ€»æ˜¯æ— æ³•è®¿é—®æ­¤ç½‘ç«™  ä¸ºä»€ä¹ˆå•Šï¼Ÿ","likes_number":1,"is_delete":false,"is_hidden":false,"ctime":1589295042,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"","child_discussion_number":1,"child_discussions":[{"author":{"id":1221511,"avatar":"https://static001.geekbang.org/account/avatar/00/12/a3/87/c415e370.jpg","nickname":"æ»¢","note":"","ucode":"971A6F20AF3F9A","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":1995338,"avatar":"https://static001.geekbang.org/account/avatar/00/1e/72/4a/e916629c.jpg","nickname":"Ceci","note":"","ucode":"11F89A3FFA1232","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":284304,"discussion_content":"ğŸ˜‚ğŸ˜‚ğŸ˜‚ åœ¨ç½‘é¡µé‡Œç‚¹å‡»view raw ä¸æ˜¯ç›´æ¥å¼¹ä¸‹è½½å˜›","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1592492746,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":264223,"ip_address":"","group_id":0},"score":284304,"extra":""}]},{"author":{"id":1903481,"avatar":"https://static001.geekbang.org/account/avatar/00/1d/0b/79/4202ffc6.jpg","nickname":"ğŸŒ•","note":"","ucode":"85899FCC7FB482","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":216627,"discussion_content":"è°¢è°¢","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1585471118,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1019533,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/8e/8d/abb7bfe3.jpg","nickname":"Ed_Leeâ„¢","note":"","ucode":"06189702C9DE00","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":40262,"discussion_content":"æ„Ÿè°¢","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1572142710,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1018526,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/8a/9e/94bdcdc5.jpg","nickname":"Noah","note":"","ucode":"A13DBCE8BA74CC","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":24640,"discussion_content":"éå¸¸æ„Ÿè°¢ï¼","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1570205577,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":68589,"user_name":"Geek_5hxn61","can_delete":false,"product_type":"c1","uid":1361640,"ip_address":"","ucode":"435FEBF630BAB8","user_header":"https://thirdwx.qlogo.cn/mmopen/vi_32/DYAIOgq83eonMJazpAb9sj7ialYVsumyv9wC1F8RTHpmBPMgj7yNDmof7cpuONtultJc8NRlLyQ34uHjmxByfPg/132","comment_is_top":false,"comment_ctime":1550550890,"is_pvip":false,"replies":[{"id":64532,"content":"Good Job","user_name":"ä½œè€…å›å¤","user_name_real":"cy","uid":1306094,"ctime":1577621343,"ip_address":"","comment_id":68589,"utype":1}],"discussion_count":2,"race_medal":0,"score":2,"product_id":100021701,"comment_content":"import pandas as pd\n&quot;&quot;&quot;åˆ©ç”¨Pandasæ¸…æ´—ç¾é£Ÿæ•°æ®&quot;&quot;&quot;\n\n# è¯»å–csvæ–‡ä»¶\ndf = pd.read_csv(&quot;c.csv&quot;)\n\ndf[&#39;food&#39;] = df[&#39;food&#39;].str.lower()  # ç»Ÿä¸€ä¸ºå°å†™å­—æ¯\ndf.dropna(inplace=True)  # åˆ é™¤æ•°æ®ç¼ºå¤±çš„è®°å½•\ndf[&#39;ounces&#39;] = df[&#39;ounces&#39;].apply(lambda a: abs(a))  # è´Ÿå€¼ä¸åˆæ³•ï¼Œå–ç»å¯¹å€¼\n\n# æŸ¥æ‰¾foodé‡å¤çš„è®°å½•ï¼Œåˆ†ç»„æ±‚å…¶å¹³å‡å€¼\nd_rows = df[df[&#39;food&#39;].duplicated(keep=False)]\ng_items = d_rows.groupby(&#39;food&#39;).mean()\ng_items[&#39;food&#39;] = g_items.index\nprint(g_items)\n\n# éå†å°†é‡å¤foodçš„å¹³å‡å€¼èµ‹å€¼ç»™df\nfor i, row in g_items.iterrows():\n    df.loc[df.food == row.food, &#39;ounces&#39;] = row.ounces\ndf.drop_duplicates(inplace=True)  # åˆ é™¤é‡å¤è®°å½•\n\ndf.index = range(len(df))  # é‡è®¾ç´¢å¼•å€¼\nprint(df)","like_count":26,"discussions":[{"author":{"id":1306094,"avatar":"https://static001.geekbang.org/account/avatar/00/13/ed/ee/c4779b67.jpg","nickname":"cy","note":"","ucode":"50D653399A31F6","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":446567,"discussion_content":"æ»¢åŒå­¦å¾ˆå¥½çš„åˆ†äº«ï¼","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1577615723,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1995338,"avatar":"https://static001.geekbang.org/account/avatar/00/1e/72/4a/e916629c.jpg","nickname":"Ceci","note":"","ucode":"11F89A3FFA1232","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":264223,"discussion_content":"ç‚¹å‡»view Raw  æ€»æ˜¯æ— æ³•è®¿é—®æ­¤ç½‘ç«™  ä¸ºä»€ä¹ˆå•Šï¼Ÿ","likes_number":1,"is_delete":false,"is_hidden":false,"ctime":1589295042,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"","child_discussion_number":1,"child_discussions":[{"author":{"id":1221511,"avatar":"https://static001.geekbang.org/account/avatar/00/12/a3/87/c415e370.jpg","nickname":"æ»¢","note":"","ucode":"971A6F20AF3F9A","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":1995338,"avatar":"https://static001.geekbang.org/account/avatar/00/1e/72/4a/e916629c.jpg","nickname":"Ceci","note":"","ucode":"11F89A3FFA1232","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":284304,"discussion_content":"ğŸ˜‚ğŸ˜‚ğŸ˜‚ åœ¨ç½‘é¡µé‡Œç‚¹å‡»view raw ä¸æ˜¯ç›´æ¥å¼¹ä¸‹è½½å˜›","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1592492746,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":264223,"ip_address":"","group_id":0},"score":284304,"extra":""}]},{"author":{"id":1903481,"avatar":"https://static001.geekbang.org/account/avatar/00/1d/0b/79/4202ffc6.jpg","nickname":"ğŸŒ•","note":"","ucode":"85899FCC7FB482","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":216627,"discussion_content":"è°¢è°¢","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1585471118,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1019533,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/8e/8d/abb7bfe3.jpg","nickname":"Ed_Leeâ„¢","note":"","ucode":"06189702C9DE00","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":40262,"discussion_content":"æ„Ÿè°¢","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1572142710,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1018526,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/8a/9e/94bdcdc5.jpg","nickname":"Noah","note":"","ucode":"A13DBCE8BA74CC","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":24640,"discussion_content":"éå¸¸æ„Ÿè°¢ï¼","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1570205577,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":57686,"user_name":"è¥¿å—ååŒ—","can_delete":false,"product_type":"c1","uid":1062864,"ip_address":"","ucode":"5815D63C4926BC","user_header":"https://static001.geekbang.org/account/avatar/00/10/37/d0/26975fba.jpg","comment_is_top":false,"comment_ctime":1546868657,"is_pvip":false,"replies":[{"id":20936,"content":"å¯¹çš„ ä¸€å®šè¦è‡ªå·±æ¨¡æ‹Ÿæ“ä½œä¸‹","user_name":"ä½œè€…å›å¤","user_name_real":"cy","uid":1306094,"ctime":1547000948,"ip_address":"","comment_id":57686,"utype":1}],"discussion_count":1,"race_medal":0,"score":2,"product_id":100021701,"comment_content":"è¿™äº›ä¸œè¥¿ï¼Œå¤§å®¶éƒ½ä¸€å®šè¦ä¸Šæ‰‹å»å®ç°ä¸€éã€‚æœ€ç®€å•çš„å°±æ˜¯ï¼Œæä¸€ä¸ªæ–‡æœ¬ï¼ŒæŠŠè¿™äº›æ•°æ®æ”¾è¿›å»ï¼Œç”¨Pythonè¯»è¿™ä¸ªæ–‡æœ¬ï¼Œè½¬æˆdataframeï¼ŒæŠŠè€å¸ˆè®²çš„é‚£äº›æ¸…æ´—ç›¸å…³çš„APIéƒ½ä¸€ä¸ªä¸€ä¸ªè¯•ä¸€ä¸‹ï¼Œæ‰ä¼šæœ‰ä½“ä¼šï¼Œå…‰çœ‹ä¸€éçœŸçš„æ²¡å•¥ç”¨çš„ï¼\nç°åœ¨åªæ˜¯å¾ˆå°‘çš„å‡ åæ¡æ•°æ®ï¼Œç­‰ä½ çœŸæ­£å»æé‚£äº›ä¸Šäº¿çš„æ•°æ®çš„æ—¶å€™ï¼Œå°±çŸ¥é“æ ¸å¯¹æ•°æ®æ˜¯ä¸ªå¤šä¹ˆå¤æ‚çš„äº‹æƒ…äº†â€¦â€¦","like_count":16,"discussions":[{"author":{"id":1306094,"avatar":"https://static001.geekbang.org/account/avatar/00/13/ed/ee/c4779b67.jpg","nickname":"cy","note":"","ucode":"50D653399A31F6","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":435699,"discussion_content":"å¯¹çš„ ä¸€å®šè¦è‡ªå·±æ¨¡æ‹Ÿæ“ä½œä¸‹","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1547000948,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":85004,"user_name":"æ»¢","can_delete":false,"product_type":"c1","uid":1221511,"ip_address":"","ucode":"971A6F20AF3F9A","user_header":"https://static001.geekbang.org/account/avatar/00/12/a3/87/c415e370.jpg","comment_is_top":false,"comment_ctime":1554954750,"is_pvip":false,"replies":[{"id":64273,"content":"ä¸é”™çš„åˆ†äº«","user_name":"ä½œè€…å›å¤","user_name_real":"cy","uid":1306094,"ctime":1577615835,"ip_address":"","comment_id":85004,"utype":1}],"discussion_count":2,"race_medal":0,"score":2,"product_id":100021701,"comment_content":"è§‰å¾—å®Œå…¨åˆä¸€åŸåˆ™æŒºå¥½ï¼Œä¸è¿‡æœ‰äº›æ“ä½œé¡ºåºæ˜¯ä¸æ˜¯å¾—æ›´æ”¹ä¸€ä¸‹ï¼Œæ¯”å¦‚æ•°å€¼è¡¥å…¨è¦åœ¨åˆ é™¤å…¨ç©ºè¡Œä¹‹åï¼Œå¦åˆ™åœ¨è¡¥å…¨çš„æ—¶å€™å…¨ç©ºè¡Œä¹Ÿä¼šè¡¥å…¨ã€‚æ¥ä¸‹æ¥æ€»ç»“åœ¨æ¸…æ´—è¿‡ç¨‹ä¸­çš„é—®é¢˜ï¼šï¼ˆ1ï¼‰ ä¸çŸ¥é“Python2 æ‰§è¡Œæƒ…å†µå¦‚ä½•ï¼Œåœ¨ç”¨Python3è¿›è¡Œæ•°æ®æ¸…ç†çš„æ—¶å€™ï¼Œå¯¹äºå¥³æ€§ä¸‰å›´æ•°æ®è¡¥å…¨çš„æ—¶å€™å› ä¸ºåˆ—ä¸­æœ‰ç©ºå­—ç¬¦çš„å­˜åœ¨ï¼Œä¼šæç¤ºâ€˜must str not intâ€™,éœ€è¦è‡ªå·±è¿‡æ»¤å«æœ‰æ•°å€¼çš„æœ‰æ•ˆæ•°æ®è¿›è¡Œmean()è®¡ç®—ã€‚  (2)ç”Ÿæˆçš„æ–°åˆ—ä¸€èˆ¬ä¼šè‡ªåŠ¨è¡¥åˆ°åé¢ï¼Œä½†first_name,last_nameéœ€è¦åœ¨ç¬¬ä¸€åˆ—å’Œç¬¬äºŒåˆ—ï¼Œæ‰€ä»¥è¦è¿›è¡Œåˆ—ç§»åŠ¨æˆ–åˆ—äº¤æ¢ã€‚(3)åœ¨åˆ é™¤æ•°æ®ä¹‹åé»˜è®¤åŠ è½½çš„ç´¢å¼•ä¼šå‡ºç°é—®é¢˜ï¼Œéœ€è¦è‡ªå·±æ›´æ–°ç´¢å¼•","like_count":9,"discussions":[{"author":{"id":1306094,"avatar":"https://static001.geekbang.org/account/avatar/00/13/ed/ee/c4779b67.jpg","nickname":"cy","note":"","ucode":"50D653399A31F6","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":435699,"discussion_content":"å¯¹çš„ ä¸€å®šè¦è‡ªå·±æ¨¡æ‹Ÿæ“ä½œä¸‹","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1547000948,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":59084,"user_name":"å‘¨é£","can_delete":false,"product_type":"c1","uid":1073374,"ip_address":"","ucode":"F85FA236EB0C0D","user_header":"https://static001.geekbang.org/account/avatar/00/10/60/de/5c67895a.jpg","comment_is_top":false,"comment_ctime":1547297535,"is_pvip":false,"replies":[{"id":64770,"content":"Good Job","user_name":"ä½œè€…å›å¤","user_name_real":"cy","uid":1306094,"ctime":1577625297,"ip_address":"","comment_id":59084,"utype":1}],"discussion_count":1,"race_medal":0,"score":2,"product_id":100021701,"comment_content":"å®Œæ•´æ€§ï¼šounces åˆ—æ•°æ®ä¸­å­˜åœ¨NAN\nå…¨é¢æ€§ï¼šfoodåˆ—æ•°æ®ä¸­å­˜åœ¨å¤§å°å†™ä¸ä¸€è‡´é—®é¢˜\nåˆæ³•æ€§ï¼šouncesåˆ—æ•°æ®å­˜åœ¨è´Ÿå€¼\nå”¯ä¸€æ€§ï¼šfoodåˆ—æ•°æ®å­˜åœ¨é‡å¤\n# -*- coding: utf-8 -*\nimport pandas as pd\nimport numpy as np\nfrom pandas import Series, DataFrame\ndf = pd.read_csv(&#39;.&#47;fooddata.csv&#39;)\n# æŠŠounces åˆ—ä¸­çš„NaNæ›¿æ¢ä¸ºå¹³å‡å€¼\ndf[&#39;ounces&#39;].fillna(df[&#39;ounces&#39;].mean(), inplace=True)\n# æŠŠfoodåˆ—ä¸­çš„å¤§å†™å­—æ¯å…¨éƒ¨è½¬æ¢ä¸ºå°å†™\ndf[&#39;food&#39;] = df[&#39;food&#39;].str.lower()\n# æŠŠounces åˆ—ä¸­çš„è´Ÿæ•°è½¬åŒ–ä¸ºæ­£æ•°\ndf[&#39;ounces&#39;]= df[&#39;ounces&#39;].apply(lambda x: abs(x))\n#åˆ é™¤foodåˆ—ä¸­çš„é‡å¤å€¼\ndf.drop_duplicates(&#39;food&#39;,inplace=True)\nprint (df)\n","like_count":6,"discussions":[{"author":{"id":1306094,"avatar":"https://static001.geekbang.org/account/avatar/00/13/ed/ee/c4779b67.jpg","nickname":"cy","note":"","ucode":"50D653399A31F6","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":446527,"discussion_content":"ä¸é”™çš„åˆ†äº«","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1577615835,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1939199,"avatar":"http://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTJ2I86HeBpalc1SlDpicfCxeHic4nAOa9anTmfKOWqjuto1Yib9sxW1zuIpc1pVtJQsiazpMxvnKQ2stg/132","nickname":"ç”°æ­","note":"","ucode":"B35F0FD63CFF78","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":285637,"discussion_content":"æƒ³è¯·é—®ä¸€ä¸‹ï¼Œç¬¬ï¼ˆ1ï¼‰ç‚¹åº”è¯¥æ€ä¹ˆè¿‡æ»¤å«æœ‰æ•°å€¼çš„æœ‰æ•ˆæ•°æ®ï¼Ÿè¿˜æœ‰ç¬¬ï¼ˆ3ï¼‰ç‚¹æ€ä¹ˆæ›´æ–°ç´¢å¼•ï¼Ÿæ˜¯éœ€è¦è‡ªå·±æ‰‹åŠ¨å†™åºå·å—ï¼Ÿæ±‚æŒ‡ç‚¹ï¼Œå¤šè°¢","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1592900833,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":57899,"user_name":"ä¸Šå®˜","can_delete":false,"product_type":"c1","uid":1353145,"ip_address":"","ucode":"037968A8E0C566","user_header":"http://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTJAeZ2VCia2y3bW9N7EMfgBqX8WClXUydwaXDPcK7Bm3XaMnMKx7q5ffA0UuTeJmEusxtQAibf8djCA/132","comment_is_top":false,"comment_ctime":1546937210,"is_pvip":false,"replies":[{"id":20922,"content":"æˆªå–ä»å¤´å¼€å§‹åˆ°å€’æ•°ç¬¬ä¸‰ä¸ªå­—ç¬¦ä¹‹å‰ï¼Œå³å»æ‰lbsã€‚","user_name":"ä½œè€…å›å¤","user_name_real":"cy","uid":1306094,"ctime":1546999598,"ip_address":"","comment_id":57899,"utype":1}],"discussion_count":1,"race_medal":0,"score":2,"product_id":100021701,"comment_content":"weight = int(float((lbs_row[&#39;weight&#39;][:-3])&#47;2.2)\nè€å¸ˆå¥½ï¼Œè¿™è¡Œä»£ç ä¸­[ï¼š-3]çš„ä½œç”¨æ˜¯ä»€ä¹ˆå•Šï¼Ÿ\n\n\n","like_count":6,"discussions":[{"author":{"id":1306094,"avatar":"https://static001.geekbang.org/account/avatar/00/13/ed/ee/c4779b67.jpg","nickname":"cy","note":"","ucode":"50D653399A31F6","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":436295,"discussion_content":"Good Job","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1577625297,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":58797,"user_name":"åŒ—æ–¹","can_delete":false,"product_type":"c1","uid":1114754,"ip_address":"","ucode":"D04589B652AC29","user_header":"https://static001.geekbang.org/account/avatar/00/11/02/82/abed70a0.jpg","comment_is_top":false,"comment_ctime":1547195220,"is_pvip":false,"replies":[{"id":64777,"content":"Good Job","user_name":"ä½œè€…å›å¤","user_name_real":"cy","uid":1306094,"ctime":1577625415,"ip_address":"","comment_id":58797,"utype":1}],"discussion_count":1,"race_medal":0,"score":2,"product_id":100021701,"comment_content":"#!&#47;usr&#47;bin&#47;env python\n# -*- coding:utf8 -*-\n# __author__ = &#39;åŒ—æ–¹å§†Q&#39;\n# __datetime__ = 2019&#47;1&#47;11 15:53\n\n\nimport pandas as pd\n\n# å¯¼å…¥\ndf = pd.read_csv(&quot;.&#47;s11.csv&quot;)\n# å»é™¤å®Œå…¨çš„ç©ºè¡Œ\ndf.dropna(how=&#39;all&#39;, inplace=True)\n# é£Ÿç‰©ååˆ‡åˆ†å¹¶å»æ‰åŸæœ¬åˆ—\ndf[[&quot;first_name&quot;, &quot;last_name&quot;]] = df[&quot;food&quot;].str.split(expand=True)\ndf.drop(&quot;food&quot;, axis=1, inplace=True)\n# åç§°é¦–å­—æ¯å¤§å†™\ndf[&quot;first_name&quot;] = df[&quot;first_name&quot;].str.capitalize()\ndf[&quot;last_name&quot;] = df[&quot;last_name&quot;].str.capitalize()\n# ä»¥é£Ÿç‰©åä¸ºæ ‡å‡†å»é‡\ndf.drop_duplicates([&quot;first_name&quot;, &quot;last_name&quot;], inplace=True)\n\nprint(df)","like_count":3,"discussions":[{"author":{"id":1306094,"avatar":"https://static001.geekbang.org/account/avatar/00/13/ed/ee/c4779b67.jpg","nickname":"cy","note":"","ucode":"50D653399A31F6","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":435817,"discussion_content":"æˆªå–ä»å¤´å¼€å§‹åˆ°å€’æ•°ç¬¬ä¸‰ä¸ªå­—ç¬¦ä¹‹å‰ï¼Œå³å»æ‰lbsã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1546999598,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":149128,"user_name":"qinggeouye","can_delete":false,"product_type":"c1","uid":1251536,"ip_address":"","ucode":"5B53EEDD7BEC9C","user_header":"https://static001.geekbang.org/account/avatar/00/13/18/d0/49b06424.jpg","comment_is_top":false,"comment_ctime":1573155240,"is_pvip":false,"replies":[{"id":59815,"content":"ä¸é”™ æŠŠä»£ç æ”¾åˆ°GitHubä¸Šæ˜¯å¾ˆå¥½çš„æ–¹å¼","user_name":"ä½œè€…å›å¤","user_name_real":"cy","uid":1306094,"ctime":1574756605,"ip_address":"","comment_id":149128,"utype":1}],"discussion_count":2,"race_medal":0,"score":2,"product_id":100021701,"comment_content":"https:&#47;&#47;github.com&#47;qinggeouye&#47;GeekTime&#47;blob&#47;master&#47;DataAnalysis&#47;11_data_clean.py\n\nimport pandas as pd\n\n# è¯»å–æ•°æ®\ndata_init = pd.read_csv(&quot;.&#47;11_clothingStoreMembers.csv&quot;)\n\n# æ¸…æ´—æ•°æ®\n\n# åˆ é™¤ &#39;\\t&#39; åˆ—, è¯»å– csv æ–‡ä»¶å¤šäº†ä¸€åˆ—\ndata_init.drop(columns=&#39;\\t&#39;, inplace=True)\n# é‡å‘½ååˆ—å\ndata_init.rename(\n    columns={&quot;0&quot;: &quot;SEQ&quot;, &quot;1&quot;: &quot;NAME&quot;, &quot;2&quot;: &quot;AGE&quot;, &quot;3&quot;: &quot;WEIGHT&quot;, &quot;4&quot;: &quot;BUST_M&quot;, &quot;5&quot;: &quot;WAIST_M&quot;, &quot;6&quot;: &quot;HIP_M&quot;,\n             &quot;7&quot;: &quot;BUST_F&quot;, &quot;8&quot;: &quot;WAIST_F&quot;, &quot;9&quot;: &quot;HIP_F&quot;}, inplace=True)\nprint(data_init)\n\n# 1ã€å®Œæ•´æ€§\n# åˆ é™¤ç©ºè¡Œ\ndata_init.dropna(how=&#39;all&#39;, inplace=True)\n\n# 4ã€å”¯ä¸€æ€§\n# ä¸€åˆ—å¤šä¸ªå‚æ•°åˆ‡åˆ†\ndata_init[[&quot;FIRST_NAME&quot;, &quot;LAST_NAME&quot;]] = data_init[&quot;NAME&quot;].str.split(expand=True)\ndata_init.drop(&quot;NAME&quot;, axis=1, inplace=True)\n# åˆ é™¤é‡å¤æ•°æ®\ndata_init.drop_duplicates([&quot;FIRST_NAME&quot;, &quot;LAST_NAME&quot;], inplace=True)\n\n# 2ã€å…¨é¢æ€§\n# åˆ—æ•°æ®å•ä½ç»Ÿä¸€, ä½“é‡ WEIGHT å•ä½ç»Ÿä¸€ï¼ˆlbs è‹±é•‘ï¼Œ kg åƒå…‹ï¼‰\nrows_with_lbs = data_init[&quot;WEIGHT&quot;].str.contains(&quot;lbs&quot;).fillna(False)\nprint(rows_with_lbs)\n# lbs è½¬ä¸º kg\nfor i, lbs_row in data_init[rows_with_lbs].iterrows():\n    weight = int(float(lbs_row[&quot;WEIGHT&quot;][:-3]) &#47; 2.2)\n    data_init.at[i, &quot;WEIGHT&quot;] = &quot;{}kgs&quot;.format(weight)\nprint(data_init)\n\n# 3ã€åˆç†æ€§\n# é ASCII å­—ç¬¦è½¬æ¢ï¼Œè¿™é‡Œåˆ é™¤å¤„ç†\ndata_init[&quot;FIRST_NAME&quot;].replace({r&#39;[^\\x00-\\x7F]+&#39;: &#39;&#39;}, regex=True, inplace=True)\ndata_init[&quot;LAST_NAME&quot;].replace({r&#39;[^\\x00-\\x7F]+&#39;: &#39;&#39;}, regex=True, inplace=True)\n\n# 1ã€å®Œæ•´æ€§\n# è¡¥å……ç¼ºå¤±å€¼-å‡å€¼è¡¥å……\ndata_init[&quot;AGE&quot;].fillna(data_init[&quot;AGE&quot;].mean(), inplace=True)\n# ä½“é‡å…ˆå»æ‰ kgs çš„å•ä½ç¬¦å·\ndata_init[&quot;WEIGHT&quot;].replace(&#39;kgs$&#39;, &#39;&#39;, regex=True, inplace=True)  # ä¸å¸¦å•ä½ç¬¦å· kgs\ndata_init[&quot;WEIGHT&quot;] = data_init[&quot;WEIGHT&quot;].astype(&#39;float&#39;)\ndata_init[&quot;WEIGHT&quot;].fillna(data_init[&quot;WEIGHT&quot;].mean(), inplace=True)\n\ndata_init.replace(&#39;-&#39;, 0, regex=True, inplace=True)  # è¯»å–çš„ csv æ•°æ®å¤šäº†&#39;-&#39;\ndata_init[&quot;WAIST_F&quot;] = data_init[&quot;WAIST_F&quot;].astype(&#39;float&#39;)\ndata_init[&quot;WAIST_F&quot;].fillna(data_init[&quot;WAIST_F&quot;].mean(), inplace=True)\n\n# ç”¨æœ€é«˜é¢‘çš„æ•°æ®å¡«å……\nage_max_freq = data_init[&quot;AGE&quot;].value_counts().index[0]\nprint(age_max_freq)\ndata_init[&quot;AGE&quot;].fillna(age_max_freq, inplace=True)\nprint(data_init)","like_count":2,"discussions":[{"author":{"id":1306094,"avatar":"https://static001.geekbang.org/account/avatar/00/13/ed/ee/c4779b67.jpg","nickname":"cy","note":"","ucode":"50D653399A31F6","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":436212,"discussion_content":"Good Job","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1577625415,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":61489,"user_name":"Chino","can_delete":false,"product_type":"c1","uid":1347181,"ip_address":"","ucode":"0240D89E5F74B4","user_header":"https://static001.geekbang.org/account/avatar/00/14/8e/6d/c68e07ef.jpg","comment_is_top":false,"comment_ctime":1547707617,"is_pvip":false,"replies":[{"id":64708,"content":"Good Job!","user_name":"ä½œè€…å›å¤","user_name_real":"cy","uid":1306094,"ctime":1577624548,"ip_address":"","comment_id":61489,"utype":1}],"discussion_count":1,"race_medal":0,"score":3,"product_id":100021701,"comment_content":"æœ‰ä¸€ä¸ªé—®é¢˜ å°±æ˜¯ä»£ç æœ€åé‚£é‡Œto_excel å¦‚æœå‚æ•°çš„è·¯å¾„æ˜¯æŒ‡å®šçš„é‚£ç§ å°±ä¼šæŠ¥é”™æ˜¾ç¤ºfilenotfound æœäº†å¾ˆä¹…éƒ½æ²¡æ‰¾åˆ°æ˜¯ä»€ä¹ˆåŸå›  æ±‚è§£\nå¦å¤–æ„Ÿè§‰è¿™ä¸€è®²æœ‰å¥½å¤šç‚¹éƒ½æ²¡è®²æ·±å…¥å‘€ ä¸‹é¢ä»£ç æ˜¯å¯¹è¯¾ç¨‹ä¸­çš„æ ·ä¾‹è¿›è¡Œæ¸…æ´— æ„Ÿè§‰åªèƒ½åšåˆ°å‡ å°ç‚¹äº†. ç‰¹åˆ«æ˜¯åœ¨å¡«å……nanå€¼çš„æ—¶å€™ ä¸€å¼€å§‹æƒ³ç€éå†æ¯ä¸€ä¸ªnanå€¼ ç„¶åå†ç‰¹åˆ¤åˆ—çš„ç±»å‹è¿›è¡Œå¡«å……çš„. ä½†æ˜¯å‘ç°ä¸‰å›´é‚£é‡Œæœ‰ä¸ªå¤§é—®é¢˜ æŒ‰ç†è¯´ä¸‰å›´åº”è¯¥æ˜¯intç±»å‹ ä½†æ˜¯å› ä¸ºæœ‰- è¿™ä¸ªä¸œè¥¿çš„å­˜åœ¨ æçš„ä¸‰å›´æ˜¯objectç±»å‹ ä¸€å¼€å§‹èµ‹å€¼çš„æ—¶å€™æŠ¥é”™æç¤ºéœ€è¦str åæ¥æƒ³æŠŠåˆ—çš„ç±»å‹è½¬æ¢æˆintä¹Ÿå¤±è´¥äº† è¿˜æœ‰å¥½å¤šåœ°æ–¹éƒ½å¡ç€äº†...\nimport pandas as pd\nimport numpy as np\nfrom pandas import Series, DataFrame\n\ndata = DataFrame(pd.read_excel(&#39;~&#47;Desktop&#47;data.xlsx&#39;))\n\nprint(data)\n\n# æ›´æ”¹åˆ—å\ndata.rename(columns={0:&#39;åºå·&#39;,1:&#39;å§“å&#39;,2:&#39;å¹´é¾„&#39;,3:&#39;ä½“é‡&#39;,4:&#39;ç”·ä¸‰å›´1&#39;,5:&#39;ç”·ä¸‰å›´2&#39;,6:&#39;ç”·ä¸‰å›´3&#39;,7:&#39;å¥³ä¸‰å›´1&#39;,8:&#39;å¥³ä¸‰å›´2&#39;,9:&#39;å¥³ä¸‰å›´3&#39;},inplace = True)\n\n# å»æ‰é‡å¤è¡Œ\ndata = data.drop_duplicates()\n\n# 1.å®Œæ•´æ€§\n# å¡«å……ç¼ºå¤±å€¼\ncol = data.columns.values.tolist()\nrow = data._stat_axis.values.tolist()\n\n# å…ˆæŠŠå§“åçš„æ•°æ®ç±»å‹æ”¹æˆå­—ç¬¦ä¸²\ndata[&#39;å§“å&#39;] = data[&#39;å§“å&#39;].astype(&#39;str&#39;) \n\n# 1.1 å…ˆæ¸…é™¤ç©ºè¡Œ\ndata.dropna(how = &#39;all&#39;, inplace = True)\n\n# 1.2 å¡«å……ç¼ºå¤±å€¼\nage_maxf = data[&#39;å¹´é¾„&#39;].value_counts().index[0]\n\n# ä»¥å¹´é¾„é¢‘ç‡æœ€å¤§å€¼æ¥å¡«å……\ndata[&#39;å¹´é¾„&#39;].fillna(age_maxf, inplace=True)\n\n# 2.å…¨é¢æ€§\n# æŠŠä½“é‡å•ä½ä¸ºlbsçš„è½¬åŒ–ä¸ºkgs 2.2lbs = 1kgs\n# æŠŠæ‰€æœ‰ä½“é‡å•ä½ä¸ºlbsçš„è®°å½•å­˜æ”¾åœ¨ä¸€èµ· (å¦‚æœä½“é‡æ˜¯nanåˆ™ä¸è¦)\nrows_with_lbs = data[&#39;ä½“é‡&#39;].str.contains(&#39;lbs&#39;).fillna(False)\n\nfor i,lbs_row in data[rows_with_lbs].iterrows():\n    weight = int(float(lbs_row[&#39;ä½“é‡&#39;][:-3]) &#47; 2.2)\n    # ç¬¬ä¸€ä¸ªå‚æ•°æ˜¯yåæ ‡(ç«–) ç¬¬äºŒä¸ªå‚æ•°æ˜¯xåæ ‡(æ¨ª) \n    data.at[i,&#39;ä½“é‡&#39;] = &#39;{}kgs&#39;.format(weight)\n\nprint(data)\n\n# æŠŠæ¸…æ´—åçš„æ•°æ®è¾“å‡º\ndata.to_excel(&#39;CleanData.xlsx&#39;)\n# ä¼šæŠ¥é”™\n# data.to_excel(&#39;~&#47;Desktop&#47;CleanData.xlsx&#39;)","like_count":2},{"had_liked":false,"id":70685,"user_name":"ä¸€è¯­ä¸­çš„","can_delete":false,"product_type":"c1","uid":1320112,"ip_address":"","ucode":"E1A0EFCEAD83B4","user_header":"https://static001.geekbang.org/account/avatar/00/14/24/b0/a6e0b03a.jpg","comment_is_top":false,"comment_ctime":1551163790,"is_pvip":false,"replies":[{"id":64502,"content":"Good Job","user_name":"ä½œè€…å›å¤","user_name_real":"cy","uid":1306094,"ctime":1577620138,"ip_address":"","comment_id":70685,"utype":1}],"discussion_count":1,"race_medal":0,"score":3,"product_id":100021701,"comment_content":"#pdè¯»å–æ•°æ®\ndf = pd.read_excel(&#39;testdata11.xlsx&#39;)\n#1.å®Œæ•´æ€§ï¼Œouncesåˆ—NAå€¼ç”¨å¹³å‡å€¼å¡«å……\ndf[&#39;ounces&#39;].fillna(df[&#39;ounces&#39;].mean(), inplace=True)\n#2.å…¨é¢æ€§ï¼Œç»Ÿä¸€foodåˆ—å¤§å°å†™\ndf[&#39;food&#39;] = df[&#39;food&#39;].str.lower()\n#3.åˆæ³•æ€§ï¼Œouncesåˆ—è´Ÿå€¼å–ç»å¯¹å€¼\ndf[&#39;ounces&#39;] = df[&#39;ounces&#39;].apply(lambda x: abs(x))\n#4.å”¯ä¸€æ€§.animalåˆ—æœ‰é‡å¤å€¼\ndf.drop_duplicates(&#39;food&#39;, inplace=True)\n#5.é‡æ–°æ’åºæ˜¾ç¤º\ndf.reset_index(drop=True, inplace=True)\nprint(df)\n\n","like_count":1,"discussions":[{"author":{"id":1306094,"avatar":"https://static001.geekbang.org/account/avatar/00/13/ed/ee/c4779b67.jpg","nickname":"cy","note":"","ucode":"50D653399A31F6","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":436887,"discussion_content":"Good Job!","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1577624548,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":68444,"user_name":"littlePerfect","can_delete":false,"product_type":"c1","uid":1243521,"ip_address":"","ucode":"99E8B9D004BE0D","user_header":"https://static001.geekbang.org/account/avatar/00/12/f9/81/54b1a5a8.jpg","comment_is_top":false,"comment_ctime":1550500505,"is_pvip":false,"replies":[{"id":64536,"content":"Good Sharing","user_name":"ä½œè€…å›å¤","user_name_real":"cy","uid":1306094,"ctime":1577621418,"ip_address":"","comment_id":68444,"utype":1}],"discussion_count":1,"race_medal":0,"score":3,"product_id":100021701,"comment_content":"import pandas as pd\n\ndf = pd.read_excel(&quot;E:\\data_analys_work&#47;food_data.xlsx&quot;)\n\n# 1. å®Œæ•´æ€§é—®é¢˜: ç¼ºå¤±å€¼\n# df[&#39;ounces&#39;].fillna(df[&#39;ounces&#39;].mean(),inplace=True) # å¹³å‡å€¼\nounces_maxf = df[&#39;ounces&#39;].value_counts().index[0] # å‡ºç°é¢‘ç‡æœ€é«˜çš„å€¼\ndf[&#39;ounces&#39;].fillna(ounces_maxf, inplace=True)\n\n# 2. å…¨é¢æ€§é—®é¢˜: åˆ—é¦–å­—æ¯ä¸ç»Ÿä¸€\ndf[&#39;food&#39;] = df[&#39;food&#39;].str.title()\n\n# 3. åˆç†æ€§é—®é¢˜: åˆ—æ•°æ®çš„å•ä½ä¸ç»Ÿä¸€\ndf[&#39;ounces&#39;] = df[&#39;ounces&#39;].apply(lambda x: abs(x))\n\n# 4. å”¯ä¸€æ€§é—®é¢˜: é£Ÿç‰©é‡å¤å‡ºç°,æ±‚å’Œåˆå¹¶,å¹¶åˆ é™¤å¤šä½™è¡Œ\n# æ²¡æƒ³å‡ºæ¥.....\n","like_count":1,"discussions":[{"author":{"id":1306094,"avatar":"https://static001.geekbang.org/account/avatar/00/13/ed/ee/c4779b67.jpg","nickname":"cy","note":"","ucode":"50D653399A31F6","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":440771,"discussion_content":"Good Job","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1577620138,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":66574,"user_name":"Geek_hve78z","can_delete":false,"product_type":"c1","uid":1015045,"ip_address":"","ucode":"386803B8FC2DD5","user_header":"https://static001.geekbang.org/account/avatar/00/0f/7d/05/4bad0c7c.jpg","comment_is_top":false,"comment_ctime":1549960817,"is_pvip":false,"replies":[{"id":64584,"content":"æ•´ç†çš„ä¸é”™","user_name":"ä½œè€…å›å¤","user_name_real":"cy","uid":1306094,"ctime":1577622020,"ip_address":"","comment_id":66574,"utype":1}],"discussion_count":1,"race_medal":0,"score":3,"product_id":100021701,"comment_content":"1ã€å®Œæ•´æ€§ï¼š\nåœ¨ouncesä¸€åˆ—ï¼Œå­˜åœ¨ç¼ºå¤±å€¼ã€‚å¤„ç†æ­¥éª¤ï¼šåˆ é™¤ï¼Œå› ä¸ºæœ‰é‡å¤å€¼\n2ã€å…¨é¢æ€§ï¼š\nfoodåˆ—é¦–å­—æ¯å¤§å°å†™ä¸ç»Ÿä¸€ã€‚å¤„ç†æ­¥éª¤ï¼šåˆ©ç”¨DataFrame.columns.str.lower()å…¨éƒ¨æ¢æˆå°å†™\n3ã€åˆæ³•æ€§ï¼š\nåœ¨é‡é‡ä¸€åˆ—ï¼Œå­˜åœ¨è´Ÿæ•°ã€‚å¤„ç†æ­¥éª¤ï¼Œåˆ é™¤\n4ã€å”¯ä¸€æ€§ï¼š\nåœ¨é£Ÿå“åç§°ä¸€åˆ—ï¼Œç»Ÿä¸€å¤§å°å†™åï¼Œå­˜åœ¨é‡å¤å€¼ã€‚å¤„ç†ï¼šæ±‚å’Œåˆå¹¶","like_count":1,"discussions":[{"author":{"id":1306094,"avatar":"https://static001.geekbang.org/account/avatar/00/13/ed/ee/c4779b67.jpg","nickname":"cy","note":"","ucode":"50D653399A31F6","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":439677,"discussion_content":"Good Sharing","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1577621418,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":61508,"user_name":"Chino","can_delete":false,"product_type":"c1","uid":1347181,"ip_address":"","ucode":"0240D89E5F74B4","user_header":"https://static001.geekbang.org/account/avatar/00/14/8e/6d/c68e07ef.jpg","comment_is_top":false,"comment_ctime":1547709454,"is_pvip":false,"replies":[{"id":64707,"content":"Good Job!","user_name":"ä½œè€…å›å¤","user_name_real":"cy","uid":1306094,"ctime":1577624541,"ip_address":"","comment_id":61508,"utype":1}],"discussion_count":1,"race_medal":0,"score":3,"product_id":100021701,"comment_content":"ä½œä¸š\nimport pandas as pd\nimport numpy as py\nfrom pandas import Series, DataFrame\n\ndata = DataFrame(pd.read_excel(&#39;~&#47;Desktop&#47;HomeworkData.xlsx&#39;))\n\n# æŠŠé£Ÿç‰©çš„åå­—ç»Ÿä¸€å¤§å°å†™\ndata[&#39;food&#39;] = data[&#39;food&#39;].str.title()\n\n# å®Œæ•´æ€§\n# å¡«å……ç©ºå€¼\ndata[&#39;ounces&#39;].fillna(data[&#39;ounces&#39;].mean(), inplace = True)\n\n# å…¨é¢æ€§\n# æ²¡æœ‰å‘ç°é—®é¢˜\n\n# åˆç†æ€§\n# ounceså€¼åº”å¤§äºç­‰äº0 è´Ÿå€¼å–ç»å¯¹å€¼\ndata[&#39;ounces&#39;][data[&#39;ounces&#39;] &lt; 0] = data[&#39;ounces&#39;][data[&#39;ounces&#39;] &lt; 0] * -1\n\n# å”¯ä¸€æ€§\n# æ¸…é™¤é£Ÿç‰©åé‡å¤çš„æ•°æ®\ndata.drop_duplicates(&#39;food&#39;,inplace = True)\n\ndata.to_excel(&#39;HomeworkCleanData.xlsx&#39;)\n","like_count":1,"discussions":[{"author":{"id":1306094,"avatar":"https://static001.geekbang.org/account/avatar/00/13/ed/ee/c4779b67.jpg","nickname":"cy","note":"","ucode":"50D653399A31F6","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":438842,"discussion_content":"æ•´ç†çš„ä¸é”™","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1577622020,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":277329,"user_name":"é»ƒå–»æ¦†","can_delete":false,"product_type":"c1","uid":1924811,"ip_address":"","ucode":"644312AE93C490","user_header":"https://static001.geekbang.org/account/avatar/00/1d/5e/cb/ad85b408.jpg","comment_is_top":false,"comment_ctime":1612360063,"is_pvip":false,"replies":[{"id":100859,"content":"åŠ æ²¹~","user_name":"ä½œè€…å›å¤","user_name_real":"cy","uid":1306094,"ctime":1612704706,"ip_address":"","comment_id":277329,"utype":1}],"discussion_count":1,"race_medal":0,"score":3,"product_id":100021701,"comment_content":"1. å®Œæ•´æ€§: æœ‰ä¸€æ ¼ç¼ºå¤±å€¼\n2. å…¨é¢æ€§: å–®ä½ä¸çµ±ä¸€ï¼Œfoodæ¬„ä½å€¼æœ‰å¤§å°å¯«ï¼Œä¸ä¸€è‡´\n3. åˆç†æ€§: è‹¥é€™æ˜¯ç‰©æ–™æ§ç®¡æ¸…å–®ï¼Œè² å€¼å¯èƒ½æ˜¯å‡ºè²¨ï¼Œæ‰€ä»¥æ¸›å°‘åº«å­˜ã€‚éœ€è¦è·Ÿæ¥­ä¸»ç¢ºèªã€‚\n4. å”¯ä¸€æ€§: è‹¥æ˜¯å‡ºè²¨ç´€éŒ„ï¼Œå°±æ²’å¿…è¦è¦æ±‚foodæ¬„ä½æ˜¯å”¯ä¸€ã€‚","like_count":0,"discussions":[{"author":{"id":1306094,"avatar":"https://static001.geekbang.org/account/avatar/00/13/ed/ee/c4779b67.jpg","nickname":"cy","note":"","ucode":"50D653399A31F6","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":436891,"discussion_content":"Good Job!","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1577624541,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":250700,"user_name":"McKee Chen","can_delete":false,"product_type":"c1","uid":2037505,"ip_address":"","ucode":"F74B76542FAB65","user_header":"https://static001.geekbang.org/account/avatar/00/1f/17/01/1c5309a3.jpg","comment_is_top":false,"comment_ctime":1601198743,"is_pvip":false,"replies":[{"id":103013,"content":"éå¸¸æ£’ï¼å¯¹æŸä¸€åˆ—çš„æ–‡æœ¬å­—ç¬¦ä¸²è¿›è¡Œå°å†™æ“ä½œæ—¶ï¼Œä¹Ÿå¯ä»¥ä½¿ç”¨df1[&#39;food&#39;].str.lower()","user_name":"ä½œè€…å›å¤","user_name_real":"cy","uid":1306094,"ctime":1615999972,"ip_address":"","comment_id":250700,"utype":1}],"discussion_count":1,"race_medal":0,"score":3,"product_id":100021701,"comment_content":"#ç»ƒä¹ \næˆ‘çš„æ€è€ƒï¼šä»excelä¸­æ‰“å¼€æ•°æ®ï¼Œå¯¹å…¶ç©ºç™½å€¼è¿›è¡Œå¡«å……ï¼Œç„¶åå¯¹foodåˆ—çš„å€¼å…¨éƒ¨å°å†™ï¼Œå†æŒ‰foodå’Œanimalå¯¹æ•°æ®è¿›è¡Œåˆ†ç±»ï¼Œè®¡ç®—ounceså‡å€¼ï¼Œæœ€åæ•°æ®è¾“å‡ºæˆæ–°çš„excel\nimport pandas as pd\nimport numpy as np\nfrom pandas import Series,DataFrame\n#å»ºç«‹æ•°æ®è¡¨\ndf1 = pd.read_excel(r&#39;C:\\Users\\XXX\\Desktop\\0928.xlsx&#39;)\n#ç”¨ounces.mean()å¡«å……ç©ºç™½å€¼\ndf1[&#39;ounces&#39;].fillna(df1[&#39;ounces&#39;].mean(), inplace=True)\n#å°†foodåˆ—å…¨éƒ¨å°å†™\nfor i in range(9):\n    df1.at[i,&#39;food&#39;] = df1[&#39;food&#39;][i].lower()\n#é€šè¿‡groupbyå¯¹ç›¸åŒçš„foodå’Œanimalæ±‚ounceså‡å€¼\ndf1 = df1.groupby([df1[&#39;food&#39;],df1[&#39;animal&#39;]]).mean()\ndf1.to_excel(r&#39;C:\\Users\\XXX\\Desktop\\0928_1.xlsx&#39;)\n\nè€å¸ˆè®²çš„æ•°æ®æ¸…æ´—éå¸¸æ˜“æ‡‚ï¼Œå¾—å¤šåŠ ç»ƒä¹ ï¼Œæ‰èƒ½ç†Ÿèƒ½ç”Ÿå·§ï¼Œå¹¶è¦åšåˆ°æ¸©æ•…çŸ¥æ–°","like_count":0,"discussions":[{"author":{"id":1306094,"avatar":"https://static001.geekbang.org/account/avatar/00/13/ed/ee/c4779b67.jpg","nickname":"cy","note":"","ucode":"50D653399A31F6","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":515007,"discussion_content":"åŠ æ²¹~","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1612704706,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":245050,"user_name":"æ‹¾å…‰","can_delete":false,"product_type":"c1","uid":2087581,"ip_address":"","ucode":"3F88BAB08EF775","user_header":"https://static001.geekbang.org/account/avatar/00/1f/da/9d/1f825568.jpg","comment_is_top":false,"comment_ctime":1598795206,"is_pvip":false,"replies":[{"id":103495,"content":"æ„Ÿè°¢åˆ†äº«ï¼Œå¤§å®¶å¯ä»¥ç›´æ¥å¤åˆ¶ä½¿ç”¨å“¦","user_name":"ä½œè€…å›å¤","user_name_real":"cy","uid":1306094,"ctime":1616688513,"ip_address":"","comment_id":245050,"utype":1}],"discussion_count":1,"race_medal":0,"score":3,"product_id":100021701,"comment_content":"è¿™æ˜¯ocrè¯†åˆ«çš„æºæ•°æ®ï¼Œä¾›å®éªŒç”¨\n[[&quot;bacon&quot;, 4.0, &quot;pig&quot;],\n[&quot;pulled pork&quot;, 3.0, &quot;pig&quot;],\n[&quot;bacon&quot;, NaN , &quot;pig&quot;],\n[&quot;Pastrami&quot;, 6.0, &quot;cow&quot;],\n[&quot;corned beef&quot;, 7.5, &quot;cow&quot;],\n[&quot;Bacon&quot;, 8.0, &quot;pig&quot;],\n[&quot;pastrami&quot;, 3.0, &quot;cow&quot;],\n[&quot;honey ham&quot;, 5.0, &quot;pig&quot;],\n[&quot;nova lox&quot;, 6.0, &quot;salmon&quot;]]","like_count":0,"discussions":[{"author":{"id":1306094,"avatar":"https://static001.geekbang.org/account/avatar/00/13/ed/ee/c4779b67.jpg","nickname":"cy","note":"","ucode":"50D653399A31F6","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":504777,"discussion_content":"æ„Ÿè°¢åˆ†äº«ï¼Œå¤§å®¶å¯ä»¥ç›´æ¥å¤åˆ¶ä½¿ç”¨å“¦","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1616688513,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":232800,"user_name":"çƒ­æ²³","can_delete":false,"product_type":"c1","uid":2047160,"ip_address":"","ucode":"7D0AC18CE97BFD","user_header":"https://static001.geekbang.org/account/avatar/00/1f/3c/b8/cd7dc389.jpg","comment_is_top":false,"comment_ctime":1594120765,"is_pvip":false,"replies":[{"id":103520,"content":"è´Ÿæ•°è½¬æ­£æ•°å¯ä»¥ä½¿ç”¨pandasç°æˆçš„APIï¼šdf[&quot;ounces&quot;] = df[&quot;ounces&quot;].abs()","user_name":"ä½œè€…å›å¤","user_name_real":"cy","uid":1306094,"ctime":1616694924,"ip_address":"","comment_id":232800,"utype":1}],"discussion_count":1,"race_medal":0,"score":3,"product_id":100021701,"comment_content":"import pandas as pd\n\nfile_path = &quot;.&#47;foodInformation.csv&quot;\ndf = pd.read_csv(file_path)\n#æ•°æ®æ¸…æ´—å››é¡¹åŸºæœ¬åŸåˆ™\n#1ã€å®Œæ•´æ€§ï¼šç¼ºå¤±ã€ç©ºè¡Œ\n#åˆ é™¤ç©ºè¡Œ,howä¸å†™å«æœ‰nançš„è¡Œå…¨éƒ¨åˆ é™¤\ndf.dropna(how=&quot;all&quot;, inplace=True)\n\n#å‡å€¼æ›¿æ¢\n#df[&quot;ounces&quot;].fillna(df[&quot;ounces&quot;].mean(), inplace=True)\n#é«˜é¢‘æ›¿æ¢\nou_maxf = df[&quot;ounces&quot;].value_counts().index[0]\ndf[&quot;ounces&quot;].fillna(ou_maxf, inplace=True)\n\n#2ã€åˆæ³•æ€§ï¼šè´Ÿæ•°è½¬ä¸ºæ­£æ•°\n# for i in df[&quot;ounces&quot;]:\n#     if i&lt;0:\n#         i = abs(i)\ndf[&quot;ounces&quot;] = df[&quot;ounces&quot;].apply(lambda a: abs(a))\n\n#åˆæ³•æ€§ï¼šç»Ÿä¸€å¤§å°å†™\ndf[&quot;food&quot;] = df[&quot;food&quot;].str.lower()\n\n#å”¯ä¸€æ€§ï¼šåˆ é™¤é‡å¤\ndf.drop_duplicates(&quot;food&quot;, inplace=True)\n\n#æ’åº\ndf_sort = df.sort_values(by=[&quot;ounces&quot;], axis=0, ascending=True)\n\nprint(df_sort)\n","like_count":0,"discussions":[{"author":{"id":1306094,"avatar":"https://static001.geekbang.org/account/avatar/00/13/ed/ee/c4779b67.jpg","nickname":"cy","note":"","ucode":"50D653399A31F6","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":500772,"discussion_content":"è´Ÿæ•°è½¬æ­£æ•°å¯ä»¥ä½¿ç”¨pandasç°æˆçš„APIï¼šdf[&amp;quot;ounces&amp;quot;] = df[&amp;quot;ounces&amp;quot;].abs()","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1616694924,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":232799,"user_name":"çƒ­æ²³","can_delete":false,"product_type":"c1","uid":2047160,"ip_address":"","ucode":"7D0AC18CE97BFD","user_header":"https://static001.geekbang.org/account/avatar/00/1f/3c/b8/cd7dc389.jpg","comment_is_top":false,"comment_ctime":1594120733,"is_pvip":false,"replies":[{"id":103521,"content":"df[&quot;ounces&quot;] = df[&quot;ounces&quot;].abs() å¯ä»¥å°†æ‰€æœ‰DataFrameä¸­çš„è´Ÿæ•°è½¬ä¸ºæ­£æ•°ã€‚","user_name":"ä½œè€…å›å¤","user_name_real":"cy","uid":1306094,"ctime":1616694971,"ip_address":"","comment_id":232799,"utype":1}],"discussion_count":1,"race_medal":0,"score":3,"product_id":100021701,"comment_content":"import pandas as pd\n\nfile_path = &quot;.&#47;foodInformation.csv&quot;\ndf = pd.read_csv(file_path)\n#æ•°æ®æ¸…æ´—å››é¡¹åŸºæœ¬åŸåˆ™\n#1ã€å®Œæ•´æ€§ï¼šç¼ºå¤±ã€ç©ºè¡Œ\n#åˆ é™¤ç©ºè¡Œ,howä¸å†™å«æœ‰nançš„è¡Œå…¨éƒ¨åˆ é™¤\ndf.dropna(how=&quot;all&quot;, inplace=True)\n\n#å‡å€¼æ›¿æ¢\n#df[&quot;ounces&quot;].fillna(df[&quot;ounces&quot;].mean(), inplace=True)\n#é«˜é¢‘æ›¿æ¢\nou_maxf = df[&quot;ounces&quot;].value_counts().index[0]\ndf[&quot;ounces&quot;].fillna(ou_maxf, inplace=True)\n\n#2ã€åˆæ³•æ€§ï¼šè´Ÿæ•°è½¬ä¸ºæ­£æ•°\n# for i in df[&quot;ounces&quot;]:\n#     if i&lt;0:\n#         i = abs(i)\ndf[&quot;ounces&quot;] = df[&quot;ounces&quot;].apply(lambda a: abs(a))\n\n#åˆæ³•æ€§ï¼šç»Ÿä¸€å¤§å°å†™\ndf[&quot;food&quot;] = df[&quot;food&quot;].str.lower()\n\n#å”¯ä¸€æ€§ï¼šåˆ é™¤é‡å¤\ndf.drop_duplicates(&quot;food&quot;, inplace=True)\n\n#æ’åº\ndf_sort = df.sort_values(by=[&quot;ounces&quot;], axis=0, ascending=True)\n\nprint(df_sort)\n","like_count":0,"discussions":[{"author":{"id":1306094,"avatar":"https://static001.geekbang.org/account/avatar/00/13/ed/ee/c4779b67.jpg","nickname":"cy","note":"","ucode":"50D653399A31F6","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":500771,"discussion_content":"df[&amp;quot;ounces&amp;quot;] = df[&amp;quot;ounces&amp;quot;].abs() å¯ä»¥å°†æ‰€æœ‰DataFrameä¸­çš„è´Ÿæ•°è½¬ä¸ºæ­£æ•°ã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1616694971,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":61489,"user_name":"Chino","can_delete":false,"product_type":"c1","uid":1347181,"ip_address":"","ucode":"0240D89E5F74B4","user_header":"https://static001.geekbang.org/account/avatar/00/14/8e/6d/c68e07ef.jpg","comment_is_top":false,"comment_ctime":1547707617,"is_pvip":false,"replies":[{"id":64708,"content":"Good Job!","user_name":"ä½œè€…å›å¤","user_name_real":"cy","uid":1306094,"ctime":1577624548,"ip_address":"","comment_id":61489,"utype":1}],"discussion_count":1,"race_medal":0,"score":3,"product_id":100021701,"comment_content":"æœ‰ä¸€ä¸ªé—®é¢˜ å°±æ˜¯ä»£ç æœ€åé‚£é‡Œto_excel å¦‚æœå‚æ•°çš„è·¯å¾„æ˜¯æŒ‡å®šçš„é‚£ç§ å°±ä¼šæŠ¥é”™æ˜¾ç¤ºfilenotfound æœäº†å¾ˆä¹…éƒ½æ²¡æ‰¾åˆ°æ˜¯ä»€ä¹ˆåŸå›  æ±‚è§£\nå¦å¤–æ„Ÿè§‰è¿™ä¸€è®²æœ‰å¥½å¤šç‚¹éƒ½æ²¡è®²æ·±å…¥å‘€ ä¸‹é¢ä»£ç æ˜¯å¯¹è¯¾ç¨‹ä¸­çš„æ ·ä¾‹è¿›è¡Œæ¸…æ´— æ„Ÿè§‰åªèƒ½åšåˆ°å‡ å°ç‚¹äº†. ç‰¹åˆ«æ˜¯åœ¨å¡«å……nanå€¼çš„æ—¶å€™ ä¸€å¼€å§‹æƒ³ç€éå†æ¯ä¸€ä¸ªnanå€¼ ç„¶åå†ç‰¹åˆ¤åˆ—çš„ç±»å‹è¿›è¡Œå¡«å……çš„. ä½†æ˜¯å‘ç°ä¸‰å›´é‚£é‡Œæœ‰ä¸ªå¤§é—®é¢˜ æŒ‰ç†è¯´ä¸‰å›´åº”è¯¥æ˜¯intç±»å‹ ä½†æ˜¯å› ä¸ºæœ‰- è¿™ä¸ªä¸œè¥¿çš„å­˜åœ¨ æçš„ä¸‰å›´æ˜¯objectç±»å‹ ä¸€å¼€å§‹èµ‹å€¼çš„æ—¶å€™æŠ¥é”™æç¤ºéœ€è¦str åæ¥æƒ³æŠŠåˆ—çš„ç±»å‹è½¬æ¢æˆintä¹Ÿå¤±è´¥äº† è¿˜æœ‰å¥½å¤šåœ°æ–¹éƒ½å¡ç€äº†...\nimport pandas as pd\nimport numpy as np\nfrom pandas import Series, DataFrame\n\ndata = DataFrame(pd.read_excel(&#39;~&#47;Desktop&#47;data.xlsx&#39;))\n\nprint(data)\n\n# æ›´æ”¹åˆ—å\ndata.rename(columns={0:&#39;åºå·&#39;,1:&#39;å§“å&#39;,2:&#39;å¹´é¾„&#39;,3:&#39;ä½“é‡&#39;,4:&#39;ç”·ä¸‰å›´1&#39;,5:&#39;ç”·ä¸‰å›´2&#39;,6:&#39;ç”·ä¸‰å›´3&#39;,7:&#39;å¥³ä¸‰å›´1&#39;,8:&#39;å¥³ä¸‰å›´2&#39;,9:&#39;å¥³ä¸‰å›´3&#39;},inplace = True)\n\n# å»æ‰é‡å¤è¡Œ\ndata = data.drop_duplicates()\n\n# 1.å®Œæ•´æ€§\n# å¡«å……ç¼ºå¤±å€¼\ncol = data.columns.values.tolist()\nrow = data._stat_axis.values.tolist()\n\n# å…ˆæŠŠå§“åçš„æ•°æ®ç±»å‹æ”¹æˆå­—ç¬¦ä¸²\ndata[&#39;å§“å&#39;] = data[&#39;å§“å&#39;].astype(&#39;str&#39;) \n\n# 1.1 å…ˆæ¸…é™¤ç©ºè¡Œ\ndata.dropna(how = &#39;all&#39;, inplace = True)\n\n# 1.2 å¡«å……ç¼ºå¤±å€¼\nage_maxf = data[&#39;å¹´é¾„&#39;].value_counts().index[0]\n\n# ä»¥å¹´é¾„é¢‘ç‡æœ€å¤§å€¼æ¥å¡«å……\ndata[&#39;å¹´é¾„&#39;].fillna(age_maxf, inplace=True)\n\n# 2.å…¨é¢æ€§\n# æŠŠä½“é‡å•ä½ä¸ºlbsçš„è½¬åŒ–ä¸ºkgs 2.2lbs = 1kgs\n# æŠŠæ‰€æœ‰ä½“é‡å•ä½ä¸ºlbsçš„è®°å½•å­˜æ”¾åœ¨ä¸€èµ· (å¦‚æœä½“é‡æ˜¯nanåˆ™ä¸è¦)\nrows_with_lbs = data[&#39;ä½“é‡&#39;].str.contains(&#39;lbs&#39;).fillna(False)\n\nfor i,lbs_row in data[rows_with_lbs].iterrows():\n    weight = int(float(lbs_row[&#39;ä½“é‡&#39;][:-3]) &#47; 2.2)\n    # ç¬¬ä¸€ä¸ªå‚æ•°æ˜¯yåæ ‡(ç«–) ç¬¬äºŒä¸ªå‚æ•°æ˜¯xåæ ‡(æ¨ª) \n    data.at[i,&#39;ä½“é‡&#39;] = &#39;{}kgs&#39;.format(weight)\n\nprint(data)\n\n# æŠŠæ¸…æ´—åçš„æ•°æ®è¾“å‡º\ndata.to_excel(&#39;CleanData.xlsx&#39;)\n# ä¼šæŠ¥é”™\n# data.to_excel(&#39;~&#47;Desktop&#47;CleanData.xlsx&#39;)","like_count":2,"discussions":[{"author":{"id":1306094,"avatar":"https://static001.geekbang.org/account/avatar/00/13/ed/ee/c4779b67.jpg","nickname":"cy","note":"","ucode":"50D653399A31F6","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":436887,"discussion_content":"Good Job!","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1577624548,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":70685,"user_name":"ä¸€è¯­ä¸­çš„","can_delete":false,"product_type":"c1","uid":1320112,"ip_address":"","ucode":"E1A0EFCEAD83B4","user_header":"https://static001.geekbang.org/account/avatar/00/14/24/b0/a6e0b03a.jpg","comment_is_top":false,"comment_ctime":1551163790,"is_pvip":false,"replies":[{"id":64502,"content":"Good Job","user_name":"ä½œè€…å›å¤","user_name_real":"cy","uid":1306094,"ctime":1577620138,"ip_address":"","comment_id":70685,"utype":1}],"discussion_count":1,"race_medal":0,"score":3,"product_id":100021701,"comment_content":"#pdè¯»å–æ•°æ®\ndf = pd.read_excel(&#39;testdata11.xlsx&#39;)\n#1.å®Œæ•´æ€§ï¼Œouncesåˆ—NAå€¼ç”¨å¹³å‡å€¼å¡«å……\ndf[&#39;ounces&#39;].fillna(df[&#39;ounces&#39;].mean(), inplace=True)\n#2.å…¨é¢æ€§ï¼Œç»Ÿä¸€foodåˆ—å¤§å°å†™\ndf[&#39;food&#39;] = df[&#39;food&#39;].str.lower()\n#3.åˆæ³•æ€§ï¼Œouncesåˆ—è´Ÿå€¼å–ç»å¯¹å€¼\ndf[&#39;ounces&#39;] = df[&#39;ounces&#39;].apply(lambda x: abs(x))\n#4.å”¯ä¸€æ€§.animalåˆ—æœ‰é‡å¤å€¼\ndf.drop_duplicates(&#39;food&#39;, inplace=True)\n#5.é‡æ–°æ’åºæ˜¾ç¤º\ndf.reset_index(drop=True, inplace=True)\nprint(df)\n\n","like_count":1,"discussions":[{"author":{"id":1306094,"avatar":"https://static001.geekbang.org/account/avatar/00/13/ed/ee/c4779b67.jpg","nickname":"cy","note":"","ucode":"50D653399A31F6","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":440771,"discussion_content":"Good Job","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1577620138,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":68444,"user_name":"littlePerfect","can_delete":false,"product_type":"c1","uid":1243521,"ip_address":"","ucode":"99E8B9D004BE0D","user_header":"https://static001.geekbang.org/account/avatar/00/12/f9/81/54b1a5a8.jpg","comment_is_top":false,"comment_ctime":1550500505,"is_pvip":false,"replies":[{"id":64536,"content":"Good Sharing","user_name":"ä½œè€…å›å¤","user_name_real":"cy","uid":1306094,"ctime":1577621418,"ip_address":"","comment_id":68444,"utype":1}],"discussion_count":1,"race_medal":0,"score":3,"product_id":100021701,"comment_content":"import pandas as pd\n\ndf = pd.read_excel(&quot;E:\\data_analys_work&#47;food_data.xlsx&quot;)\n\n# 1. å®Œæ•´æ€§é—®é¢˜: ç¼ºå¤±å€¼\n# df[&#39;ounces&#39;].fillna(df[&#39;ounces&#39;].mean(),inplace=True) # å¹³å‡å€¼\nounces_maxf = df[&#39;ounces&#39;].value_counts().index[0] # å‡ºç°é¢‘ç‡æœ€é«˜çš„å€¼\ndf[&#39;ounces&#39;].fillna(ounces_maxf, inplace=True)\n\n# 2. å…¨é¢æ€§é—®é¢˜: åˆ—é¦–å­—æ¯ä¸ç»Ÿä¸€\ndf[&#39;food&#39;] = df[&#39;food&#39;].str.title()\n\n# 3. åˆç†æ€§é—®é¢˜: åˆ—æ•°æ®çš„å•ä½ä¸ç»Ÿä¸€\ndf[&#39;ounces&#39;] = df[&#39;ounces&#39;].apply(lambda x: abs(x))\n\n# 4. å”¯ä¸€æ€§é—®é¢˜: é£Ÿç‰©é‡å¤å‡ºç°,æ±‚å’Œåˆå¹¶,å¹¶åˆ é™¤å¤šä½™è¡Œ\n# æ²¡æƒ³å‡ºæ¥.....\n","like_count":1,"discussions":[{"author":{"id":1306094,"avatar":"https://static001.geekbang.org/account/avatar/00/13/ed/ee/c4779b67.jpg","nickname":"cy","note":"","ucode":"50D653399A31F6","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":439677,"discussion_content":"Good Sharing","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1577621418,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":66574,"user_name":"Geek_hve78z","can_delete":false,"product_type":"c1","uid":1015045,"ip_address":"","ucode":"386803B8FC2DD5","user_header":"https://static001.geekbang.org/account/avatar/00/0f/7d/05/4bad0c7c.jpg","comment_is_top":false,"comment_ctime":1549960817,"is_pvip":false,"replies":[{"id":64584,"content":"æ•´ç†çš„ä¸é”™","user_name":"ä½œè€…å›å¤","user_name_real":"cy","uid":1306094,"ctime":1577622020,"ip_address":"","comment_id":66574,"utype":1}],"discussion_count":1,"race_medal":0,"score":3,"product_id":100021701,"comment_content":"1ã€å®Œæ•´æ€§ï¼š\nåœ¨ouncesä¸€åˆ—ï¼Œå­˜åœ¨ç¼ºå¤±å€¼ã€‚å¤„ç†æ­¥éª¤ï¼šåˆ é™¤ï¼Œå› ä¸ºæœ‰é‡å¤å€¼\n2ã€å…¨é¢æ€§ï¼š\nfoodåˆ—é¦–å­—æ¯å¤§å°å†™ä¸ç»Ÿä¸€ã€‚å¤„ç†æ­¥éª¤ï¼šåˆ©ç”¨DataFrame.columns.str.lower()å…¨éƒ¨æ¢æˆå°å†™\n3ã€åˆæ³•æ€§ï¼š\nåœ¨é‡é‡ä¸€åˆ—ï¼Œå­˜åœ¨è´Ÿæ•°ã€‚å¤„ç†æ­¥éª¤ï¼Œåˆ é™¤\n4ã€å”¯ä¸€æ€§ï¼š\nåœ¨é£Ÿå“åç§°ä¸€åˆ—ï¼Œç»Ÿä¸€å¤§å°å†™åï¼Œå­˜åœ¨é‡å¤å€¼ã€‚å¤„ç†ï¼šæ±‚å’Œåˆå¹¶","like_count":1,"discussions":[{"author":{"id":1306094,"avatar":"https://static001.geekbang.org/account/avatar/00/13/ed/ee/c4779b67.jpg","nickname":"cy","note":"","ucode":"50D653399A31F6","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":438842,"discussion_content":"æ•´ç†çš„ä¸é”™","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1577622020,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":61508,"user_name":"Chino","can_delete":false,"product_type":"c1","uid":1347181,"ip_address":"","ucode":"0240D89E5F74B4","user_header":"https://static001.geekbang.org/account/avatar/00/14/8e/6d/c68e07ef.jpg","comment_is_top":false,"comment_ctime":1547709454,"is_pvip":false,"replies":[{"id":64707,"content":"Good Job!","user_name":"ä½œè€…å›å¤","user_name_real":"cy","uid":1306094,"ctime":1577624541,"ip_address":"","comment_id":61508,"utype":1}],"discussion_count":1,"race_medal":0,"score":3,"product_id":100021701,"comment_content":"ä½œä¸š\nimport pandas as pd\nimport numpy as py\nfrom pandas import Series, DataFrame\n\ndata = DataFrame(pd.read_excel(&#39;~&#47;Desktop&#47;HomeworkData.xlsx&#39;))\n\n# æŠŠé£Ÿç‰©çš„åå­—ç»Ÿä¸€å¤§å°å†™\ndata[&#39;food&#39;] = data[&#39;food&#39;].str.title()\n\n# å®Œæ•´æ€§\n# å¡«å……ç©ºå€¼\ndata[&#39;ounces&#39;].fillna(data[&#39;ounces&#39;].mean(), inplace = True)\n\n# å…¨é¢æ€§\n# æ²¡æœ‰å‘ç°é—®é¢˜\n\n# åˆç†æ€§\n# ounceså€¼åº”å¤§äºç­‰äº0 è´Ÿå€¼å–ç»å¯¹å€¼\ndata[&#39;ounces&#39;][data[&#39;ounces&#39;] &lt; 0] = data[&#39;ounces&#39;][data[&#39;ounces&#39;] &lt; 0] * -1\n\n# å”¯ä¸€æ€§\n# æ¸…é™¤é£Ÿç‰©åé‡å¤çš„æ•°æ®\ndata.drop_duplicates(&#39;food&#39;,inplace = True)\n\ndata.to_excel(&#39;HomeworkCleanData.xlsx&#39;)\n","like_count":1,"discussions":[{"author":{"id":1306094,"avatar":"https://static001.geekbang.org/account/avatar/00/13/ed/ee/c4779b67.jpg","nickname":"cy","note":"","ucode":"50D653399A31F6","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":436891,"discussion_content":"Good Job!","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1577624541,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":277329,"user_name":"é»ƒå–»æ¦†","can_delete":false,"product_type":"c1","uid":1924811,"ip_address":"","ucode":"644312AE93C490","user_header":"https://static001.geekbang.org/account/avatar/00/1d/5e/cb/ad85b408.jpg","comment_is_top":false,"comment_ctime":1612360063,"is_pvip":false,"replies":[{"id":100859,"content":"åŠ æ²¹~","user_name":"ä½œè€…å›å¤","user_name_real":"cy","uid":1306094,"ctime":1612704706,"ip_address":"","comment_id":277329,"utype":1}],"discussion_count":1,"race_medal":0,"score":3,"product_id":100021701,"comment_content":"1. å®Œæ•´æ€§: æœ‰ä¸€æ ¼ç¼ºå¤±å€¼\n2. å…¨é¢æ€§: å–®ä½ä¸çµ±ä¸€ï¼Œfoodæ¬„ä½å€¼æœ‰å¤§å°å¯«ï¼Œä¸ä¸€è‡´\n3. åˆç†æ€§: è‹¥é€™æ˜¯ç‰©æ–™æ§ç®¡æ¸…å–®ï¼Œè² å€¼å¯èƒ½æ˜¯å‡ºè²¨ï¼Œæ‰€ä»¥æ¸›å°‘åº«å­˜ã€‚éœ€è¦è·Ÿæ¥­ä¸»ç¢ºèªã€‚\n4. å”¯ä¸€æ€§: è‹¥æ˜¯å‡ºè²¨ç´€éŒ„ï¼Œå°±æ²’å¿…è¦è¦æ±‚foodæ¬„ä½æ˜¯å”¯ä¸€ã€‚","like_count":0,"discussions":[{"author":{"id":1306094,"avatar":"https://static001.geekbang.org/account/avatar/00/13/ed/ee/c4779b67.jpg","nickname":"cy","note":"","ucode":"50D653399A31F6","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":515007,"discussion_content":"åŠ æ²¹~","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1612704706,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":250700,"user_name":"McKee Chen","can_delete":false,"product_type":"c1","uid":2037505,"ip_address":"","ucode":"F74B76542FAB65","user_header":"https://static001.geekbang.org/account/avatar/00/1f/17/01/1c5309a3.jpg","comment_is_top":false,"comment_ctime":1601198743,"is_pvip":false,"replies":[{"id":103013,"content":"éå¸¸æ£’ï¼å¯¹æŸä¸€åˆ—çš„æ–‡æœ¬å­—ç¬¦ä¸²è¿›è¡Œå°å†™æ“ä½œæ—¶ï¼Œä¹Ÿå¯ä»¥ä½¿ç”¨df1[&#39;food&#39;].str.lower()","user_name":"ä½œè€…å›å¤","user_name_real":"cy","uid":1306094,"ctime":1615999972,"ip_address":"","comment_id":250700,"utype":1}],"discussion_count":1,"race_medal":0,"score":3,"product_id":100021701,"comment_content":"#ç»ƒä¹ \næˆ‘çš„æ€è€ƒï¼šä»excelä¸­æ‰“å¼€æ•°æ®ï¼Œå¯¹å…¶ç©ºç™½å€¼è¿›è¡Œå¡«å……ï¼Œç„¶åå¯¹foodåˆ—çš„å€¼å…¨éƒ¨å°å†™ï¼Œå†æŒ‰foodå’Œanimalå¯¹æ•°æ®è¿›è¡Œåˆ†ç±»ï¼Œè®¡ç®—ounceså‡å€¼ï¼Œæœ€åæ•°æ®è¾“å‡ºæˆæ–°çš„excel\nimport pandas as pd\nimport numpy as np\nfrom pandas import Series,DataFrame\n#å»ºç«‹æ•°æ®è¡¨\ndf1 = pd.read_excel(r&#39;C:\\Users\\XXX\\Desktop\\0928.xlsx&#39;)\n#ç”¨ounces.mean()å¡«å……ç©ºç™½å€¼\ndf1[&#39;ounces&#39;].fillna(df1[&#39;ounces&#39;].mean(), inplace=True)\n#å°†foodåˆ—å…¨éƒ¨å°å†™\nfor i in range(9):\n    df1.at[i,&#39;food&#39;] = df1[&#39;food&#39;][i].lower()\n#é€šè¿‡groupbyå¯¹ç›¸åŒçš„foodå’Œanimalæ±‚ounceså‡å€¼\ndf1 = df1.groupby([df1[&#39;food&#39;],df1[&#39;animal&#39;]]).mean()\ndf1.to_excel(r&#39;C:\\Users\\XXX\\Desktop\\0928_1.xlsx&#39;)\n\nè€å¸ˆè®²çš„æ•°æ®æ¸…æ´—éå¸¸æ˜“æ‡‚ï¼Œå¾—å¤šåŠ ç»ƒä¹ ï¼Œæ‰èƒ½ç†Ÿèƒ½ç”Ÿå·§ï¼Œå¹¶è¦åšåˆ°æ¸©æ•…çŸ¥æ–°","like_count":0,"discussions":[{"author":{"id":1306094,"avatar":"https://static001.geekbang.org/account/avatar/00/13/ed/ee/c4779b67.jpg","nickname":"cy","note":"","ucode":"50D653399A31F6","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":506264,"discussion_content":"éå¸¸æ£’ï¼å¯¹æŸä¸€åˆ—çš„æ–‡æœ¬å­—ç¬¦ä¸²è¿›è¡Œå°å†™æ“ä½œæ—¶ï¼Œä¹Ÿå¯ä»¥ä½¿ç”¨df1[&amp;#39;food&amp;#39;].str.lower()","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1615999972,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":245050,"user_name":"æ‹¾å…‰","can_delete":false,"product_type":"c1","uid":2087581,"ip_address":"","ucode":"3F88BAB08EF775","user_header":"https://static001.geekbang.org/account/avatar/00/1f/da/9d/1f825568.jpg","comment_is_top":false,"comment_ctime":1598795206,"is_pvip":false,"replies":[{"id":103495,"content":"æ„Ÿè°¢åˆ†äº«ï¼Œå¤§å®¶å¯ä»¥ç›´æ¥å¤åˆ¶ä½¿ç”¨å“¦","user_name":"ä½œè€…å›å¤","user_name_real":"cy","uid":1306094,"ctime":1616688513,"ip_address":"","comment_id":245050,"utype":1}],"discussion_count":1,"race_medal":0,"score":3,"product_id":100021701,"comment_content":"è¿™æ˜¯ocrè¯†åˆ«çš„æºæ•°æ®ï¼Œä¾›å®éªŒç”¨\n[[&quot;bacon&quot;, 4.0, &quot;pig&quot;],\n[&quot;pulled pork&quot;, 3.0, &quot;pig&quot;],\n[&quot;bacon&quot;, NaN , &quot;pig&quot;],\n[&quot;Pastrami&quot;, 6.0, &quot;cow&quot;],\n[&quot;corned beef&quot;, 7.5, &quot;cow&quot;],\n[&quot;Bacon&quot;, 8.0, &quot;pig&quot;],\n[&quot;pastrami&quot;, 3.0, &quot;cow&quot;],\n[&quot;honey ham&quot;, 5.0, &quot;pig&quot;],\n[&quot;nova lox&quot;, 6.0, &quot;salmon&quot;]]","like_count":0,"discussions":[{"author":{"id":1306094,"avatar":"https://static001.geekbang.org/account/avatar/00/13/ed/ee/c4779b67.jpg","nickname":"cy","note":"","ucode":"50D653399A31F6","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":506264,"discussion_content":"éå¸¸æ£’ï¼å¯¹æŸä¸€åˆ—çš„æ–‡æœ¬å­—ç¬¦ä¸²è¿›è¡Œå°å†™æ“ä½œæ—¶ï¼Œä¹Ÿå¯ä»¥ä½¿ç”¨df1[&amp;#39;food&amp;#39;].str.lower()","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1615999972,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":232800,"user_name":"çƒ­æ²³","can_delete":false,"product_type":"c1","uid":2047160,"ip_address":"","ucode":"7D0AC18CE97BFD","user_header":"https://static001.geekbang.org/account/avatar/00/1f/3c/b8/cd7dc389.jpg","comment_is_top":false,"comment_ctime":1594120765,"is_pvip":false,"replies":[{"id":103520,"content":"è´Ÿæ•°è½¬æ­£æ•°å¯ä»¥ä½¿ç”¨pandasç°æˆçš„APIï¼šdf[&quot;ounces&quot;] = df[&quot;ounces&quot;].abs()","user_name":"ä½œè€…å›å¤","user_name_real":"cy","uid":1306094,"ctime":1616694924,"ip_address":"","comment_id":232800,"utype":1}],"discussion_count":1,"race_medal":0,"score":3,"product_id":100021701,"comment_content":"import pandas as pd\n\nfile_path = &quot;.&#47;foodInformation.csv&quot;\ndf = pd.read_csv(file_path)\n#æ•°æ®æ¸…æ´—å››é¡¹åŸºæœ¬åŸåˆ™\n#1ã€å®Œæ•´æ€§ï¼šç¼ºå¤±ã€ç©ºè¡Œ\n#åˆ é™¤ç©ºè¡Œ,howä¸å†™å«æœ‰nançš„è¡Œå…¨éƒ¨åˆ é™¤\ndf.dropna(how=&quot;all&quot;, inplace=True)\n\n#å‡å€¼æ›¿æ¢\n#df[&quot;ounces&quot;].fillna(df[&quot;ounces&quot;].mean(), inplace=True)\n#é«˜é¢‘æ›¿æ¢\nou_maxf = df[&quot;ounces&quot;].value_counts().index[0]\ndf[&quot;ounces&quot;].fillna(ou_maxf, inplace=True)\n\n#2ã€åˆæ³•æ€§ï¼šè´Ÿæ•°è½¬ä¸ºæ­£æ•°\n# for i in df[&quot;ounces&quot;]:\n#     if i&lt;0:\n#         i = abs(i)\ndf[&quot;ounces&quot;] = df[&quot;ounces&quot;].apply(lambda a: abs(a))\n\n#åˆæ³•æ€§ï¼šç»Ÿä¸€å¤§å°å†™\ndf[&quot;food&quot;] = df[&quot;food&quot;].str.lower()\n\n#å”¯ä¸€æ€§ï¼šåˆ é™¤é‡å¤\ndf.drop_duplicates(&quot;food&quot;, inplace=True)\n\n#æ’åº\ndf_sort = df.sort_values(by=[&quot;ounces&quot;], axis=0, ascending=True)\n\nprint(df_sort)\n","like_count":0,"discussions":[{"author":{"id":1306094,"avatar":"https://static001.geekbang.org/account/avatar/00/13/ed/ee/c4779b67.jpg","nickname":"cy","note":"","ucode":"50D653399A31F6","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":504777,"discussion_content":"æ„Ÿè°¢åˆ†äº«ï¼Œå¤§å®¶å¯ä»¥ç›´æ¥å¤åˆ¶ä½¿ç”¨å“¦","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1616688513,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":232799,"user_name":"çƒ­æ²³","can_delete":false,"product_type":"c1","uid":2047160,"ip_address":"","ucode":"7D0AC18CE97BFD","user_header":"https://static001.geekbang.org/account/avatar/00/1f/3c/b8/cd7dc389.jpg","comment_is_top":false,"comment_ctime":1594120733,"is_pvip":false,"replies":[{"id":103521,"content":"df[&quot;ounces&quot;] = df[&quot;ounces&quot;].abs() å¯ä»¥å°†æ‰€æœ‰DataFrameä¸­çš„è´Ÿæ•°è½¬ä¸ºæ­£æ•°ã€‚","user_name":"ä½œè€…å›å¤","user_name_real":"cy","uid":1306094,"ctime":1616694971,"ip_address":"","comment_id":232799,"utype":1}],"discussion_count":1,"race_medal":0,"score":3,"product_id":100021701,"comment_content":"import pandas as pd\n\nfile_path = &quot;.&#47;foodInformation.csv&quot;\ndf = pd.read_csv(file_path)\n#æ•°æ®æ¸…æ´—å››é¡¹åŸºæœ¬åŸåˆ™\n#1ã€å®Œæ•´æ€§ï¼šç¼ºå¤±ã€ç©ºè¡Œ\n#åˆ é™¤ç©ºè¡Œ,howä¸å†™å«æœ‰nançš„è¡Œå…¨éƒ¨åˆ é™¤\ndf.dropna(how=&quot;all&quot;, inplace=True)\n\n#å‡å€¼æ›¿æ¢\n#df[&quot;ounces&quot;].fillna(df[&quot;ounces&quot;].mean(), inplace=True)\n#é«˜é¢‘æ›¿æ¢\nou_maxf = df[&quot;ounces&quot;].value_counts().index[0]\ndf[&quot;ounces&quot;].fillna(ou_maxf, inplace=True)\n\n#2ã€åˆæ³•æ€§ï¼šè´Ÿæ•°è½¬ä¸ºæ­£æ•°\n# for i in df[&quot;ounces&quot;]:\n#     if i&lt;0:\n#         i = abs(i)\ndf[&quot;ounces&quot;] = df[&quot;ounces&quot;].apply(lambda a: abs(a))\n\n#åˆæ³•æ€§ï¼šç»Ÿä¸€å¤§å°å†™\ndf[&quot;food&quot;] = df[&quot;food&quot;].str.lower()\n\n#å”¯ä¸€æ€§ï¼šåˆ é™¤é‡å¤\ndf.drop_duplicates(&quot;food&quot;, inplace=True)\n\n#æ’åº\ndf_sort = df.sort_values(by=[&quot;ounces&quot;], axis=0, ascending=True)\n\nprint(df_sort)\n","like_count":0,"discussions":[{"author":{"id":1306094,"avatar":"https://static001.geekbang.org/account/avatar/00/13/ed/ee/c4779b67.jpg","nickname":"cy","note":"","ucode":"50D653399A31F6","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":500772,"discussion_content":"è´Ÿæ•°è½¬æ­£æ•°å¯ä»¥ä½¿ç”¨pandasç°æˆçš„APIï¼šdf[&amp;quot;ounces&amp;quot;] = df[&amp;quot;ounces&amp;quot;].abs()","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1616694924,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":226764,"user_name":"As1m0v","can_delete":false,"product_type":"c1","uid":2035261,"ip_address":"","ucode":"279177F30FA011","user_header":"https://static001.geekbang.org/account/avatar/00/1f/0e/3d/ded8bc06.jpg","comment_is_top":false,"comment_ctime":1592198839,"is_pvip":false,"replies":[{"id":103728,"content":"ä¸é”™ï¼ï¼ï¼åŠ æ²¹ï¼ï¼","user_name":"ä½œè€…å›å¤","user_name_real":"cy","uid":1306094,"ctime":1617038085,"ip_address":"","comment_id":226764,"utype":1}],"discussion_count":1,"race_medal":0,"score":4,"product_id":100021701,"comment_content":"Python3 \nJupyter Notebook\nç»ƒä¹ é¢˜å›ç­”\n# æ ¹æ®ouncesåˆ—åˆ é™¤å«æœ‰ç¼ºå¤±å€¼æ•°æ®é¡¹\nfile2.dropna(subset = [&#39;ounces&#39;], inplace = True)\n\n# å°†foodåˆ—ä¸­æ¯ä¸€è¡Œæ•°æ®ç»Ÿä¸€å¤§å°å†™\nfile2[&#39;food&#39;] = file2[&#39;food&#39;].str.lower()\n\n# å°†ouncesåˆ—ä¸­æ•°æ®ç»Ÿä¸€ä¸ºæ­£æ•°(æ–¹æ³•ä¸€)\nfile2[&#39;ounces&#39;] = file2[&#39;ounces&#39;].abs()\n\n# å°†ouncesåˆ—ä¸­å¼‚å¸¸æ•°æ®åˆ é™¤(æ–¹æ³•äºŒ)\n# è¿™ç§æƒ…å†µä¸‹ï¼Œè¿™ä¸€æ–¹æ³•å¯ä»¥å’Œç¬¬ä¸€æ¡åˆå¹¶\n#file2 = file2[file2[&#39;ounces&#39;]&gt;0]\n\n# å°†å…·æœ‰ç›¸åŒfoodåˆ—å€¼å’Œanimalåˆ—å€¼çš„æ•°æ®ï¼ˆå¯é€‰ï¼‰\nfile3 = file2.groupby([&#39;food&#39;,&#39;animal&#39;]).sum()","like_count":0},{"had_liked":false,"id":224102,"user_name":"æ¸…é£","can_delete":false,"product_type":"c1","uid":1987801,"ip_address":"","ucode":"5F99A1442E0390","user_header":"https://static001.geekbang.org/account/avatar/00/1e/54/d9/76a53118.jpg","comment_is_top":false,"comment_ctime":1591275449,"is_pvip":false,"replies":[{"id":103738,"content":"items = df.groupby(&#39;food&#39;).mean()\nitems[&#39;food&#39;] = items.index\nå¯ä»¥åˆå¹¶ä¸ºï¼š\nitems = df.groupby(&#39;food&#39;, as_index=False).mean()\n\nfor å¾ªç¯éƒ¨åˆ†çš„ä»£ç ï¼Œå¯ä»¥è¯•è¯•df = df.merge(items, on=&#39;food&#39;)","user_name":"ä½œè€…å›å¤","user_name_real":"cy","uid":1306094,"ctime":1617039895,"ip_address":"","comment_id":224102,"utype":1}],"discussion_count":1,"race_medal":0,"score":4,"product_id":100021701,"comment_content":"import pandas as pd\nimport numpy as np\ndf = pd.DataFrame({&#39;food&#39;:[&#39;bacon&#39;, &#39;pulled pork&#39;, &#39;bacon&#39;, &#39;Pastrami&#39;, &#39;corned beef&#39;, &#39;Bacon&#39;, &#39;pastrami&#39;, &#39;honey ham&#39;, &#39;nova lox&#39;],\n                  &#39;ounces&#39;:[4.0, 3.0, None, 6.0, 7.5, 8.0, -3.0, 5.0, 6.0],\n                  &#39;animal&#39;:[&#39;pig&#39;, &#39;pig&#39;, &#39;pig&#39;, &#39;cow&#39;, &#39;cow&#39;, &#39;pig&#39;, &#39;cow&#39;, &#39;pig&#39;, &#39;salmon&#39;]},\n                 columns=[&#39;food&#39;, &#39;ounces&#39;, &#39;animal&#39;])\ndf\ndf.isnull().any()\n# å¤„ç†Noneå€¼ èµ‹å€¼ä¸ºé«˜é¢‘è¯\n# è¿™é‡Œåˆå§‹å¤„ç†æ—¶æŒ‰èµ‹å€¼ åæ¥å‘ç°åˆ é™¤å¯èƒ½æ›´å¥½ä¸€ç‚¹\n# df[&#39;ounces&#39;].fillna(df[&#39;ounces&#39;].value_counts().index[0], inplace=True)\ndf.dropna(inplace=True)\n# æŠŠè´Ÿå€¼èµ‹å€¼ä¸º6.0\n# df[&#39;ounces&#39;].where(df[&#39;ounces&#39;] &gt; 0, df[&#39;ounces&#39;].value_counts().index[0])\n# ç»å¯¹å€¼å¤„ç†\ndf[&#39;ounces&#39;] = df[&#39;ounces&#39;].apply(lambda x:abs(x))\ndf\ndf[&#39;food&#39;] = df[&#39;food&#39;].str.lower()\nitems = df.groupby(&#39;food&#39;).mean()\nitems[&#39;food&#39;] = items.index\nfor i, row in items.iterrows():\n    df.loc[df[&#39;food&#39;] == row[&#39;food&#39;],&#39;ounces&#39;] = row[&#39;ounces&#39;]\ndf.drop_duplicates(inplace=True)\ndf.reset_index(inplace=True, drop=True)\ndf","like_count":0,"discussions":[{"author":{"id":1306094,"avatar":"https://static001.geekbang.org/account/avatar/00/13/ed/ee/c4779b67.jpg","nickname":"cy","note":"","ucode":"50D653399A31F6","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":498356,"discussion_content":"ä¸é”™ï¼ï¼ï¼åŠ æ²¹ï¼ï¼","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1617038085,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":206915,"user_name":"å¤•å­","can_delete":false,"product_type":"c1","uid":1916066,"ip_address":"","ucode":"4115ABE599B2F4","user_header":"https://static001.geekbang.org/account/avatar/00/1d/3c/a2/09a2215c.jpg","comment_is_top":false,"comment_ctime":1586956374,"is_pvip":false,"replies":[{"id":103981,"content":"ä¸é”™","user_name":"ä½œè€…å›å¤","user_name_real":"cy","uid":1306094,"ctime":1617291501,"ip_address":"","comment_id":206915,"utype":1}],"discussion_count":1,"race_medal":0,"score":4,"product_id":100021701,"comment_content":"ï¼ˆ1ï¼‰å®Œæ•´æ€§ï¼šouncesåˆ—å­˜åœ¨ç©ºå€¼NaN\næ¸…æ´—æ–¹å¼ï¼šç”¨å‡å€¼å¡«å……\nï¼ˆ2ï¼‰å…¨é¢æ€§ï¼šfoodåˆ—å¤§å°å†™ä¸ç»Ÿä¸€\næ¸…æ´—æ–¹å¼ï¼šç»Ÿä¸€ä¸ºå°å†™\nï¼ˆ3ï¼‰åˆç†æ€§ï¼šouncesåˆ—å­˜åœ¨è´Ÿå€¼\næ¸…æ´—æ–¹å¼ï¼šåˆ¤æ–­æ˜¯å¦åˆç†ï¼Œè‹¥ä¸åˆç†ï¼Œåˆ é™¤æˆ–è€…å‡å€¼å¡«å……\nï¼ˆ4ï¼‰å”¯ä¸€æ€§ï¼šfoodåˆ—æœ‰é‡å¤\næ¸…æ´—æ–¹å¼ï¼šå»é‡","like_count":0,"discussions":[{"author":{"id":1306094,"avatar":"https://static001.geekbang.org/account/avatar/00/13/ed/ee/c4779b67.jpg","nickname":"cy","note":"","ucode":"50D653399A31F6","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":497366,"discussion_content":"items = df.groupby(&amp;#39;food&amp;#39;).mean()\nitems[&amp;#39;food&amp;#39;] = items.index\nå¯ä»¥åˆå¹¶ä¸ºï¼š\nitems = df.groupby(&amp;#39;food&amp;#39;, as_index=False).mean()\n\nfor å¾ªç¯éƒ¨åˆ†çš„ä»£ç ï¼Œå¯ä»¥è¯•è¯•df = df.merge(items, on=&amp;#39;food&amp;#39;)","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1617039895,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":206277,"user_name":"å“å“Ÿå“Ÿ","can_delete":false,"product_type":"c1","uid":1619213,"ip_address":"","ucode":"8E8C2899B73DF8","user_header":"https://static001.geekbang.org/account/avatar/00/18/b5/0d/df1f17b5.jpg","comment_is_top":false,"comment_ctime":1586833419,"is_pvip":false,"replies":[{"id":103985,"content":"å¯ä»¥è¯•è¯•è£…anacondaï¼Œä½¿ç”¨condaçš„è™šæ‹Ÿç¯å¢ƒï¼Œå¯ä»¥çœå»å¾ˆå¤šç¯å¢ƒä¸Šçš„é—®é¢˜ã€‚","user_name":"ä½œè€…å›å¤","user_name_real":"cy","uid":1306094,"ctime":1617292012,"ip_address":"","comment_id":206277,"utype":1}],"discussion_count":1,"race_medal":0,"score":4,"product_id":100021701,"comment_content":"1ï¼Œç¬¬å››è¡Œç¬¬äºŒåˆ—ç¼ºå¤±æ•°æ®ï¼Œéœ€åˆ é™¤ã€‚\n2ï¼Œå€’æ•°ç¬¬3è¡Œç¬¬2åˆ—æ•°æ®ä¸åˆæ³•ï¼Œéœ€åˆ é™¤ã€‚\n3ï¼Œé‡å¤æ•°æ®ï¼Œbaconæœ‰3æ¡æ•°æ®ã€pastramiæœ‰2è¡Œæ•°æ®ï¼Œå¦‚æœæ•°æ®æœ‰æ•ˆéœ€åˆå¹¶ï¼Œå¦åˆ™åˆ é™¤ã€‚\n4ï¼Œfoodåˆ—æœ‰å¤§å°å†™ï¼Œéœ€ç»Ÿä¸€æ›¿æ¢ã€‚\n\næ“ä½œæ­¥éª¤ï¼šå…ˆåˆ é™¤ç©ºå€¼ã€ä¸åˆæ³•æ•°æ®ã€‚æ›¿æ¢å¤§å°å†™ï¼Œåˆå¹¶æœ‰æ•ˆæ•°æ®ã€åˆ é™¤é‡å¤æ•°æ®ã€‚\n\nç¯å¢ƒå°±æ•´äº†å‡ å¤©ç»“æœè¿˜æ˜¯æ²¡æå®šï¼ŒpyCharmè£…ç¬¬ä¸‰æ–¹åº“é¡ºåˆ©çš„æ—¶å€™çœŸç®€å•ï¼Œä¸€æ—¦æœ‰é—®é¢˜å„ç§å¤æ‚ï¼Œæœ€åç”¨Spyderè·‘äº†ã€æ™¨æ˜Ÿã€‘åŒå­¦çš„ä»£ç ç»ˆäºè·‘é€šäº†ï¼Œå·®ç‚¹åˆæ­»åœ¨ç¯å¢ƒä¸Šã€‚ã€‚ã€‚","like_count":0,"discussions":[{"author":{"id":1306094,"avatar":"https://static001.geekbang.org/account/avatar/00/13/ed/ee/c4779b67.jpg","nickname":"cy","note":"","ucode":"50D653399A31F6","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":491949,"discussion_content":"ä¸é”™","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1617291501,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":200150,"user_name":"Geek_æ¨—","can_delete":false,"product_type":"c1","uid":1920476,"ip_address":"","ucode":"F6D9D29ED521F8","user_header":"https://static001.geekbang.org/account/avatar/00/1d/4d/dc/6c0a311e.jpg","comment_is_top":false,"comment_ctime":1585550918,"is_pvip":false,"replies":[{"id":104331,"content":"å“ˆå“ˆï¼Œå­¦å®Œå°±å¯ä»¥æ‘†è„±è¿™ç§çƒ¦æ¼äº†","user_name":"ä½œè€…å›å¤","user_name_real":"cy","uid":1306094,"ctime":1617903111,"ip_address":"","comment_id":200150,"utype":1}],"discussion_count":1,"race_medal":0,"score":4,"product_id":100021701,"comment_content":"åˆšå¼€å§‹æ¥è§¦è¿™ä¸ªå·¥ä½œæ—¶ï¼Œå°±å› ä¸ºä¸æ³¨æ„æ•°æ®çš„æ•´æ´ï¼ŒçŠ¯äº†ä¸å°‘ç¬‘è¯ã€‚è·‘å‡ºæ¥çš„æŠ¥è¡¨æ•°æ®å“æ­»ä¸ªäººã€‚","like_count":0,"discussions":[{"author":{"id":1306094,"avatar":"https://static001.geekbang.org/account/avatar/00/13/ed/ee/c4779b67.jpg","nickname":"cy","note":"","ucode":"50D653399A31F6","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":489948,"discussion_content":"å“ˆå“ˆï¼Œå­¦å®Œå°±å¯ä»¥æ‘†è„±è¿™ç§çƒ¦æ¼äº†","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1617903111,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":196659,"user_name":"åå…­ã€‚","can_delete":false,"product_type":"c1","uid":1935100,"ip_address":"","ucode":"DD4A02E3D904D5","user_header":"","comment_is_top":false,"comment_ctime":1585300567,"is_pvip":false,"replies":[{"id":104223,"content":"Good Job","user_name":"ä½œè€…å›å¤","user_name_real":"cy","uid":1306094,"ctime":1617731565,"ip_address":"","comment_id":196659,"utype":1}],"discussion_count":1,"race_medal":0,"score":4,"product_id":100021701,"comment_content":"import pandas as pd\nfrom pandas import Series,DataFrame\n\ndf = pd.read_csv(&#39;dws&#47;foodInfo.csv&#39;)\n# é¦–å…ˆ é€šè¿‡å­¦ä¹ çš„æ•°æ®åˆ†æçš„â€˜å®Œå…¨åˆä¸€â€™ç®€å•æ¸…æ´—å®šç†æ¥åˆ†ææ•°æ®\n# æ•°æ®å­˜åœ¨ç©ºå€¼ï¼ˆç©ºå€¼å¯ä»¥åˆ é™¤æˆ–æ˜¯ä½¿ç”¨å‡å€¼å¡«å…¥ï¼Œæ­¤å¤„æˆ‘ä»¬åˆ é™¤ï¼‰ã€å¤§å°å†™ä¸ä¸€ã€å•ä½ä¸åˆç†å­˜åœ¨è´Ÿæ•°\n# é¦–å…ˆå»é™¤å¯¼å…¥è¿›æ¥æ—¶å¤šå‡ºå’Œè¡Œ\ndf = df.dropna()\ndf = df.drop(df[df[&#39;ounces&#39;] &lt; 0].index)\ndf[&#39;food&#39;] = df[&#39;food&#39;].str.lower()\n# å¯¹æ•°æ®è¿›è¡Œé‡æ–°è¡Œç´¢å¼•\ndf.index = range(len(df))\n# df.reindex(index=list(range(len(df))))\ndf\n\n\tfood\tounces\tanimal\n0\tbacon\t4.0\tpig\n1\tpulled port\t3.0\tpig\n2\tpastrami\t6.0\tcow\n3\tcorned beef\t7.5\tcow\n4\tbacon\t8.0\tpig\n5\thoney ham\t5.0\tpig\n6\tnova lox\t6.0\tsalmon\n\n\n","like_count":0,"discussions":[{"author":{"id":1306094,"avatar":"https://static001.geekbang.org/account/avatar/00/13/ed/ee/c4779b67.jpg","nickname":"cy","note":"","ucode":"50D653399A31F6","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":489353,"discussion_content":"Good Job","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1617731565,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":195806,"user_name":"pyall","can_delete":false,"product_type":"c1","uid":1928703,"ip_address":"","ucode":"6C2A8DB86EE8FB","user_header":"https://static001.geekbang.org/account/avatar/00/1d/6d/ff/d5d14e2c.jpg","comment_is_top":false,"comment_ctime":1585216161,"is_pvip":false,"replies":[{"id":104347,"content":"Good Job!!!","user_name":"ä½œè€…å›å¤","user_name_real":"cy","uid":1306094,"ctime":1617904222,"ip_address":"","comment_id":195806,"utype":1}],"discussion_count":1,"race_medal":0,"score":4,"product_id":100021701,"comment_content":"æ•´ç†æ€è·¯ï¼š\n1ã€åˆ æ‰æ— æ•ˆæ•°æ®ï¼ˆæ•´è¡Œï¼‰ï¼Œå¹¶å¡«å……ç¼ºå¤±å€¼\n2ã€æ·»åŠ æ€§åˆ«åˆ—ï¼Œå¡«å……æ€§åˆ«å€¼\n3ã€åˆå¹¶ä¸‰ç»´ï¼ˆä¸‰åˆ—ï¼‰æ•°æ®\n4ã€é‡å‘½åè¡¨å¤´å­—æ®µåç§°\n5ã€ç¬¬3åˆ—ç»Ÿä¸€æ ‡å‡†å•ä½ï¼Œä¸”æ•°å­—åŒ–\n\n&quot;&quot;&quot;\nimport pandas as pd\nimport numpy as np\nimport matplotlib.pyplot as plt\n\npath = r&quot;E:\\accountMessage.xlsx&quot;\n\ndf = pd.read_excel(path)\ndf.columns #Index([&#39;\\t&#39;, 0, 1, 2, 3, 4, 5, 6, 7, 8, 9], dtype=&#39;object&#39;)\n#df.drop([&#39;&#39;])\ndf = df[[ 0, 1, 2, 3, 4, 5, 6, 7, 8, 9]]\n#1ã€åˆ æ‰ç©ºå€¼ï¼ˆæ•´è¡Œï¼‰\ndf.dropna(axis=0,how=&#39;all&#39;,inplace = True)\n\n#é‡å‘½åè¡¨å¤´å­—æ®µåç§°\ndf = df.rename(columns = {0:&#39;id&#39;,1:&#39;Name&#39;,2:&#39;Age&#39;,3:&#39;Weight&#39;})\ndf[&#39;Age&#39;] = df[&#39;Age&#39;].fillna(round(df[&#39;Age&#39;].mean(),0)) #ä½¿ç”¨å¹³å‡æ•°å¡«å……\ndf[&#39;Age&#39;].value_counts().index[0]#ä½¿ç”¨é¢‘æ•°æœ€é«˜çš„æ•°å¡«å……\n\n\n#2ã€æ·»åŠ æ€§åˆ«åˆ—ï¼Œå¡«å……æ€§åˆ«å€¼\ndf[&#39;sex&#39;]=&#39;&#39;\ndf[&#39;sex&#39;][df[4]==&quot;-&quot;]=&#39;female&#39;\ndf[&#39;sex&#39;][df[4]!=&quot;-&quot;]=&#39;male&#39;\n\n#3ã€åˆå¹¶ä¸‰ç»´ï¼ˆä¸‰åˆ—ï¼‰æ•°æ®\ndf[df==&#39;-&#39;]=0\ndf2 = df.replace(&#39;-&#39;,0)\ndf2[&#39;d1&#39;] =df2[4] +df2[7]\ndf2[&#39;d2&#39;] =df2[5] +df2[8]\ndf2[&#39;d3&#39;] =df2[6] +df2[9]\n\ndf3 = df2.drop([4,5,6,7,8,9],axis=1)\ndf3 = df2.drop([4]) #é»˜è®¤åˆ é™¤è¡Œæ•°æ®\n\n#5ã€ç¬¬3åˆ—ç»Ÿä¸€æ ‡å‡†å•ä½ï¼Œä¸”æ•°å­—åŒ–\n#1ç£…(lb)=0.4535924å…¬æ–¤(kg)\n\ndf3.isnull().sum()\n\n#æ•°å­—ä¸å­—æ¯åˆ†å¼€,åˆ†æˆä¸¤åˆ—\ndf3[&#39;Weight&#39;].str.replace(&#39;s&#39;,&quot;z&quot;)\ndf3[&#39;w_unit&#39;] = df3[&#39;Weight&#39;].str[-3:]\ndf3[&#39;w_new&#39;] = df3[&#39;Weight&#39;].str[:-3].astype(float)\n\n#è½¬åŒ–å•ä½æ•°å€¼\ndf3[&#39;w_kg&#39;] = 0\n#ä¸æ‰§è¡Œ\ndf3[df3[&#39;w_unit&#39;]==&#39;lbs&#39;].loc[:,&#39;w_kg&#39;] = df3[&#39;w_new&#39;]*0.4535924\n#æ‰§è¡ŒæˆåŠŸ\ndf3.loc[:,&#39;w_kg&#39;][df3[&#39;w_unit&#39;]==&#39;lbs&#39;] = df3[&#39;w_new&#39;]*0.4535924\ndf3.loc[:,&#39;w_kg&#39;][df3[&#39;w_unit&#39;]==&#39;kgs&#39;] = df3[&#39;w_new&#39;]","like_count":0,"discussions":[{"author":{"id":1306094,"avatar":"https://static001.geekbang.org/account/avatar/00/13/ed/ee/c4779b67.jpg","nickname":"cy","note":"","ucode":"50D653399A31F6","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":489159,"discussion_content":"Good Job!!!","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1617904222,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":193772,"user_name":"å‘¨é“­å®‡","can_delete":false,"product_type":"c1","uid":1911388,"ip_address":"","ucode":"19C800CFC4F1F1","user_header":"","comment_is_top":false,"comment_ctime":1584960637,"is_pvip":false,"replies":[{"id":104354,"content":"Good Job","user_name":"ä½œè€…å›å¤","user_name_real":"cy","uid":1306094,"ctime":1617904565,"ip_address":"","comment_id":193772,"utype":1}],"discussion_count":1,"race_medal":0,"score":4,"product_id":100021701,"comment_content":"data = {&#39;food&#39;:[&#39;bacon&#39;,&#39;pulled pork&#39;,&#39;bacon&#39;,&#39;Pastrami&#39;,&#39;couned beef&#39;,&#39;bacon&#39;,&#39;pastrami&#39;,&#39;honey ham&#39;,&#39;nova lox&#39;],\n        &#39;ounces&#39;:[4.0,3.0,None,6.0,7.5,8.0,-3.0,5.0,6.0],\n        &#39;animal&#39;:[&#39;pig&#39;,&#39;pig&#39;,&#39;pig&#39;,&#39;cow&#39;,&#39;cow&#39;,&#39;pig&#39;,&#39;cow&#39;,&#39;pig&#39;,&#39;salmon&#39;,]}\n\ndf1 = DataFrame(data)\ndf1.columns = df1.columns.str.title() # å¤§å†™å¼€å¤´\ndf1[&#39;Food&#39;] = df1[&#39;Food&#39;].str.title()\ndf1[&#39;Ounces&#39;].fillna(df1[&#39;Ounces&#39;].mean(),inplace=True) # å¡«å……ç©ºå€¼\ndf1[&#39;Ounces&#39;] = df1[&#39;Ounces&#39;].apply(lambda a:abs(a)) # æ›¿æ¢è´Ÿå€¼\ndf1.sort_values([&#39;Food&#39;],ascending=[False],inplace=True) # é‡æ–°æ’åº\ndf1.index = range(len(df1)) \nindexArray = [0]\nfor i in range(1,df1[&#39;Food&#39;].count()): \n    indexArray.append(i)\ndf1[&#39;Id&#39;] = indexArray\npysqldf = lambda sql: sqldf(sql, globals())\ndata1 = {&#39;Food&#39;:[&#39;0&#39;]}\nlastResult = DataFrame(data1) # åˆ›å»ºä¸€ä¸ªæ–°çš„æ•°æ® ç”¨æ¥åˆ¤æ–­æ˜¯å¦ä¸ºé‡å¤æ•°æ®\nrepeatArray = []\nfor i in range(0,df1[&#39;Food&#39;].count()): # æ‰¾å‡ºåˆ—å€¼å‡ç›¸åŒè¡Œ\n    sql = &quot;select * from df1 where Animal = &#39;{}&#39; AND Food = &#39;{}&#39;&quot;.format(df1[&#39;Animal&#39;][i],df1[&#39;Food&#39;][i])\n    result = DataFrame(pysqldf(sql))\n    if len(result) != 1:\n        if result[&#39;Food&#39;][0] != lastResult[&#39;Food&#39;][0]: # åˆ¤æ–­æ˜¯å¦æ•°æ®\n            lastResult = result\n            repeatArray.append(result)\n\n\n\ndef calculate(result): # è®¡ç®—å¹³å‡æ•°\n    mean = 0.0;\n    for i in range(0,result[&#39;Food&#39;].count()):\n        mean = result[&#39;Ounces&#39;][i] + mean\n\n    mean = mean &#47; result[&#39;Food&#39;].count()\n    return mean\n\ndef replaceOunces(result,mean): # å°†å¹³å‡æ•°æ”¹ä¸ºOuncesçš„å€¼\n\n    for i in range(0,result[&#39;Food&#39;].count()):\n        resultId = result[&#39;Id&#39;][i]\n        df1.Ounces[df1[&#39;Id&#39;]==resultId]=mean\n\n\nfor i in range(0,len(repeatArray)): # åˆæ¬¡æ¸…æ´—\n    mean = calculate(repeatArray[i])\n    replaceOunces(repeatArray[i],mean)\n\ndf1.drop([&#39;Id&#39;],axis=1,inplace=True) #åˆ é™¤\ndf1.drop_duplicates(inplace=True) # å»é‡\nprint(df1)\n\n&#39;&#39;&#39;\nè¾“å‡ºç»“æœ\n          Food    Ounces  Animal\n0  Pulled Pork  3.000000     pig\n1     Pastrami  4.500000     cow\n3     Nova Lox  6.000000  salmon\n4    Honey Ham  5.000000     pig\n5  Couned Beef  7.500000     cow\n6        Bacon  5.520833     pig\n\n&#39;&#39;&#39;","like_count":0,"discussions":[{"author":{"id":1306094,"avatar":"https://static001.geekbang.org/account/avatar/00/13/ed/ee/c4779b67.jpg","nickname":"cy","note":"","ucode":"50D653399A31F6","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":488653,"discussion_content":"Good Job","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1617904565,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":133878,"user_name":"å¢å˜‰æ•","can_delete":false,"product_type":"c1","uid":1293670,"ip_address":"","ucode":"64E17B0637EB86","user_header":"https://static001.geekbang.org/account/avatar/00/13/bd/66/bf0cfd22.jpg","comment_is_top":false,"comment_ctime":1568689721,"is_pvip":false,"replies":[{"id":53361,"content":"æ–‡å­—ç›¸å¯¹æ•°å€¼å°±æ¯”è¾ƒå›°éš¾äº†ï¼Œé™¤éæ˜¯ç¦»æ•£å˜é‡ï¼Œæ¯”å¦‚â€œç”·â€â€œå¥³â€è¿™ç§çš„ï¼Œå½“ç¦»æ•£å˜é‡çš„å¯é€‰é¡¹æ¯”è¾ƒå°‘çš„æƒ…å†µä¸‹ï¼Œå¯ä»¥æŒ‰ç…§é«˜é¢‘å€¼çš„æ–¹å¼è¿›è¡Œè¡¥å…¨ï¼Œå½“ç„¶ä½ ä¹Ÿå¯ä»¥æ ¹æ®é‚£æ¡æ•°æ®è‡ªèº«çš„æƒ…å†µï¼Œé€‰æ‹©é€‚åˆçš„è¡¥å…¨æ–¹å¼","user_name":"ä½œè€…å›å¤","user_name_real":"cy","uid":1306094,"ctime":1570428121,"ip_address":"","comment_id":133878,"utype":1}],"discussion_count":1,"race_medal":0,"score":4,"product_id":100021701,"comment_content":"æ–‡å­—çš„ç¼ºå¤±è¯¥å¦‚ä½•å®ç°æ•°æ®æ¸…æ´—","like_count":0,"discussions":[{"author":{"id":1306094,"avatar":"https://static001.geekbang.org/account/avatar/00/13/ed/ee/c4779b67.jpg","nickname":"cy","note":"","ucode":"50D653399A31F6","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":467542,"discussion_content":"æ–‡å­—ç›¸å¯¹æ•°å€¼å°±æ¯”è¾ƒå›°éš¾äº†ï¼Œé™¤éæ˜¯ç¦»æ•£å˜é‡ï¼Œæ¯”å¦‚â€œç”·â€â€œå¥³â€è¿™ç§çš„ï¼Œå½“ç¦»æ•£å˜é‡çš„å¯é€‰é¡¹æ¯”è¾ƒå°‘çš„æƒ…å†µä¸‹ï¼Œå¯ä»¥æŒ‰ç…§é«˜é¢‘å€¼çš„æ–¹å¼è¿›è¡Œè¡¥å…¨ï¼Œå½“ç„¶ä½ ä¹Ÿå¯ä»¥æ ¹æ®é‚£æ¡æ•°æ®è‡ªèº«çš„æƒ…å†µï¼Œé€‰æ‹©é€‚åˆçš„è¡¥å…¨æ–¹å¼","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1570428121,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":126229,"user_name":"æ¨é™†ä¼Ÿ","can_delete":false,"product_type":"c1","uid":1108457,"ip_address":"","ucode":"3BC968447406EB","user_header":"https://static001.geekbang.org/account/avatar/00/10/e9/e9/1f95e422.jpg","comment_is_top":false,"comment_ctime":1566351551,"is_pvip":false,"replies":[{"id":53412,"content":"èµ ä¸è¿‡æ•°æ®æ¸…æ´—é€šå¸¸æ˜¯ä¸ªåå¤çš„è¿‡ç¨‹ï¼Œä¹Ÿå°±æ˜¯æ¸…æ´—äº†ä¸€éƒ¨åˆ†æ•°æ®ä¹‹åé‡æ–°æ£€æŸ¥ï¼Œç„¶åå†æ‰¾åˆ°æ–°çš„é—®é¢˜ç»§ç»­æ¸…æ´—ï¼Œæ‰€ä»¥æ•°æ®é‡å¤§çš„æ—¶å€™ï¼Œå°±åƒæ‰¾Bugä¸€æ ·ï¼ŒèŠ±è´¹çš„æ—¶é—´ä¹Ÿå¾ˆå¤š","user_name":"ä½œè€…å›å¤","user_name_real":"cy","uid":1306094,"ctime":1570435043,"ip_address":"","comment_id":126229,"utype":1}],"discussion_count":1,"race_medal":4,"score":4,"product_id":100021701,"comment_content":"å¾®æœåŠ¡æ¶æ„æä¾›æ•°æ®çš„å¾®æœåŠ¡ä¸­ä¹Ÿå¯ä»¥å¸çº³æ•°æ®æ¸…æ´—çš„æ€æƒ³","like_count":0,"discussions":[{"author":{"id":1306094,"avatar":"https://static001.geekbang.org/account/avatar/00/13/ed/ee/c4779b67.jpg","nickname":"cy","note":"","ucode":"50D653399A31F6","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":467542,"discussion_content":"æ–‡å­—ç›¸å¯¹æ•°å€¼å°±æ¯”è¾ƒå›°éš¾äº†ï¼Œé™¤éæ˜¯ç¦»æ•£å˜é‡ï¼Œæ¯”å¦‚â€œç”·â€â€œå¥³â€è¿™ç§çš„ï¼Œå½“ç¦»æ•£å˜é‡çš„å¯é€‰é¡¹æ¯”è¾ƒå°‘çš„æƒ…å†µä¸‹ï¼Œå¯ä»¥æŒ‰ç…§é«˜é¢‘å€¼çš„æ–¹å¼è¿›è¡Œè¡¥å…¨ï¼Œå½“ç„¶ä½ ä¹Ÿå¯ä»¥æ ¹æ®é‚£æ¡æ•°æ®è‡ªèº«çš„æƒ…å†µï¼Œé€‰æ‹©é€‚åˆçš„è¡¥å…¨æ–¹å¼","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1570428121,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":226764,"user_name":"As1m0v","can_delete":false,"product_type":"c1","uid":2035261,"ip_address":"","ucode":"279177F30FA011","user_header":"https://static001.geekbang.org/account/avatar/00/1f/0e/3d/ded8bc06.jpg","comment_is_top":false,"comment_ctime":1592198839,"is_pvip":false,"replies":[{"id":103728,"content":"ä¸é”™ï¼ï¼ï¼åŠ æ²¹ï¼ï¼","user_name":"ä½œè€…å›å¤","user_name_real":"cy","uid":1306094,"ctime":1617038085,"ip_address":"","comment_id":226764,"utype":1}],"discussion_count":1,"race_medal":0,"score":4,"product_id":100021701,"comment_content":"Python3 \nJupyter Notebook\nç»ƒä¹ é¢˜å›ç­”\n# æ ¹æ®ouncesåˆ—åˆ é™¤å«æœ‰ç¼ºå¤±å€¼æ•°æ®é¡¹\nfile2.dropna(subset = [&#39;ounces&#39;], inplace = True)\n\n# å°†foodåˆ—ä¸­æ¯ä¸€è¡Œæ•°æ®ç»Ÿä¸€å¤§å°å†™\nfile2[&#39;food&#39;] = file2[&#39;food&#39;].str.lower()\n\n# å°†ouncesåˆ—ä¸­æ•°æ®ç»Ÿä¸€ä¸ºæ­£æ•°(æ–¹æ³•ä¸€)\nfile2[&#39;ounces&#39;] = file2[&#39;ounces&#39;].abs()\n\n# å°†ouncesåˆ—ä¸­å¼‚å¸¸æ•°æ®åˆ é™¤(æ–¹æ³•äºŒ)\n# è¿™ç§æƒ…å†µä¸‹ï¼Œè¿™ä¸€æ–¹æ³•å¯ä»¥å’Œç¬¬ä¸€æ¡åˆå¹¶\n#file2 = file2[file2[&#39;ounces&#39;]&gt;0]\n\n# å°†å…·æœ‰ç›¸åŒfoodåˆ—å€¼å’Œanimalåˆ—å€¼çš„æ•°æ®ï¼ˆå¯é€‰ï¼‰\nfile3 = file2.groupby([&#39;food&#39;,&#39;animal&#39;]).sum()","like_count":0,"discussions":[{"author":{"id":1306094,"avatar":"https://static001.geekbang.org/account/avatar/00/13/ed/ee/c4779b67.jpg","nickname":"cy","note":"","ucode":"50D653399A31F6","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":498356,"discussion_content":"ä¸é”™ï¼ï¼ï¼åŠ æ²¹ï¼ï¼","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1617038085,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":224102,"user_name":"æ¸…é£","can_delete":false,"product_type":"c1","uid":1987801,"ip_address":"","ucode":"5F99A1442E0390","user_header":"https://static001.geekbang.org/account/avatar/00/1e/54/d9/76a53118.jpg","comment_is_top":false,"comment_ctime":1591275449,"is_pvip":false,"replies":[{"id":103738,"content":"items = df.groupby(&#39;food&#39;).mean()\nitems[&#39;food&#39;] = items.index\nå¯ä»¥åˆå¹¶ä¸ºï¼š\nitems = df.groupby(&#39;food&#39;, as_index=False).mean()\n\nfor å¾ªç¯éƒ¨åˆ†çš„ä»£ç ï¼Œå¯ä»¥è¯•è¯•df = df.merge(items, on=&#39;food&#39;)","user_name":"ä½œè€…å›å¤","user_name_real":"cy","uid":1306094,"ctime":1617039895,"ip_address":"","comment_id":224102,"utype":1}],"discussion_count":1,"race_medal":0,"score":4,"product_id":100021701,"comment_content":"import pandas as pd\nimport numpy as np\ndf = pd.DataFrame({&#39;food&#39;:[&#39;bacon&#39;, &#39;pulled pork&#39;, &#39;bacon&#39;, &#39;Pastrami&#39;, &#39;corned beef&#39;, &#39;Bacon&#39;, &#39;pastrami&#39;, &#39;honey ham&#39;, &#39;nova lox&#39;],\n                  &#39;ounces&#39;:[4.0, 3.0, None, 6.0, 7.5, 8.0, -3.0, 5.0, 6.0],\n                  &#39;animal&#39;:[&#39;pig&#39;, &#39;pig&#39;, &#39;pig&#39;, &#39;cow&#39;, &#39;cow&#39;, &#39;pig&#39;, &#39;cow&#39;, &#39;pig&#39;, &#39;salmon&#39;]},\n                 columns=[&#39;food&#39;, &#39;ounces&#39;, &#39;animal&#39;])\ndf\ndf.isnull().any()\n# å¤„ç†Noneå€¼ èµ‹å€¼ä¸ºé«˜é¢‘è¯\n# è¿™é‡Œåˆå§‹å¤„ç†æ—¶æŒ‰èµ‹å€¼ åæ¥å‘ç°åˆ é™¤å¯èƒ½æ›´å¥½ä¸€ç‚¹\n# df[&#39;ounces&#39;].fillna(df[&#39;ounces&#39;].value_counts().index[0], inplace=True)\ndf.dropna(inplace=True)\n# æŠŠè´Ÿå€¼èµ‹å€¼ä¸º6.0\n# df[&#39;ounces&#39;].where(df[&#39;ounces&#39;] &gt; 0, df[&#39;ounces&#39;].value_counts().index[0])\n# ç»å¯¹å€¼å¤„ç†\ndf[&#39;ounces&#39;] = df[&#39;ounces&#39;].apply(lambda x:abs(x))\ndf\ndf[&#39;food&#39;] = df[&#39;food&#39;].str.lower()\nitems = df.groupby(&#39;food&#39;).mean()\nitems[&#39;food&#39;] = items.index\nfor i, row in items.iterrows():\n    df.loc[df[&#39;food&#39;] == row[&#39;food&#39;],&#39;ounces&#39;] = row[&#39;ounces&#39;]\ndf.drop_duplicates(inplace=True)\ndf.reset_index(inplace=True, drop=True)\ndf","like_count":0,"discussions":[{"author":{"id":1306094,"avatar":"https://static001.geekbang.org/account/avatar/00/13/ed/ee/c4779b67.jpg","nickname":"cy","note":"","ucode":"50D653399A31F6","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":497366,"discussion_content":"items = df.groupby(&amp;#39;food&amp;#39;).mean()\nitems[&amp;#39;food&amp;#39;] = items.index\nå¯ä»¥åˆå¹¶ä¸ºï¼š\nitems = df.groupby(&amp;#39;food&amp;#39;, as_index=False).mean()\n\nfor å¾ªç¯éƒ¨åˆ†çš„ä»£ç ï¼Œå¯ä»¥è¯•è¯•df = df.merge(items, on=&amp;#39;food&amp;#39;)","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1617039895,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":206915,"user_name":"å¤•å­","can_delete":false,"product_type":"c1","uid":1916066,"ip_address":"","ucode":"4115ABE599B2F4","user_header":"https://static001.geekbang.org/account/avatar/00/1d/3c/a2/09a2215c.jpg","comment_is_top":false,"comment_ctime":1586956374,"is_pvip":false,"replies":[{"id":103981,"content":"ä¸é”™","user_name":"ä½œè€…å›å¤","user_name_real":"cy","uid":1306094,"ctime":1617291501,"ip_address":"","comment_id":206915,"utype":1}],"discussion_count":1,"race_medal":0,"score":4,"product_id":100021701,"comment_content":"ï¼ˆ1ï¼‰å®Œæ•´æ€§ï¼šouncesåˆ—å­˜åœ¨ç©ºå€¼NaN\næ¸…æ´—æ–¹å¼ï¼šç”¨å‡å€¼å¡«å……\nï¼ˆ2ï¼‰å…¨é¢æ€§ï¼šfoodåˆ—å¤§å°å†™ä¸ç»Ÿä¸€\næ¸…æ´—æ–¹å¼ï¼šç»Ÿä¸€ä¸ºå°å†™\nï¼ˆ3ï¼‰åˆç†æ€§ï¼šouncesåˆ—å­˜åœ¨è´Ÿå€¼\næ¸…æ´—æ–¹å¼ï¼šåˆ¤æ–­æ˜¯å¦åˆç†ï¼Œè‹¥ä¸åˆç†ï¼Œåˆ é™¤æˆ–è€…å‡å€¼å¡«å……\nï¼ˆ4ï¼‰å”¯ä¸€æ€§ï¼šfoodåˆ—æœ‰é‡å¤\næ¸…æ´—æ–¹å¼ï¼šå»é‡","like_count":0,"discussions":[{"author":{"id":1306094,"avatar":"https://static001.geekbang.org/account/avatar/00/13/ed/ee/c4779b67.jpg","nickname":"cy","note":"","ucode":"50D653399A31F6","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":491949,"discussion_content":"ä¸é”™","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1617291501,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":206277,"user_name":"å“å“Ÿå“Ÿ","can_delete":false,"product_type":"c1","uid":1619213,"ip_address":"","ucode":"8E8C2899B73DF8","user_header":"https://static001.geekbang.org/account/avatar/00/18/b5/0d/df1f17b5.jpg","comment_is_top":false,"comment_ctime":1586833419,"is_pvip":false,"replies":[{"id":103985,"content":"å¯ä»¥è¯•è¯•è£…anacondaï¼Œä½¿ç”¨condaçš„è™šæ‹Ÿç¯å¢ƒï¼Œå¯ä»¥çœå»å¾ˆå¤šç¯å¢ƒä¸Šçš„é—®é¢˜ã€‚","user_name":"ä½œè€…å›å¤","user_name_real":"cy","uid":1306094,"ctime":1617292012,"ip_address":"","comment_id":206277,"utype":1}],"discussion_count":1,"race_medal":0,"score":4,"product_id":100021701,"comment_content":"1ï¼Œç¬¬å››è¡Œç¬¬äºŒåˆ—ç¼ºå¤±æ•°æ®ï¼Œéœ€åˆ é™¤ã€‚\n2ï¼Œå€’æ•°ç¬¬3è¡Œç¬¬2åˆ—æ•°æ®ä¸åˆæ³•ï¼Œéœ€åˆ é™¤ã€‚\n3ï¼Œé‡å¤æ•°æ®ï¼Œbaconæœ‰3æ¡æ•°æ®ã€pastramiæœ‰2è¡Œæ•°æ®ï¼Œå¦‚æœæ•°æ®æœ‰æ•ˆéœ€åˆå¹¶ï¼Œå¦åˆ™åˆ é™¤ã€‚\n4ï¼Œfoodåˆ—æœ‰å¤§å°å†™ï¼Œéœ€ç»Ÿä¸€æ›¿æ¢ã€‚\n\næ“ä½œæ­¥éª¤ï¼šå…ˆåˆ é™¤ç©ºå€¼ã€ä¸åˆæ³•æ•°æ®ã€‚æ›¿æ¢å¤§å°å†™ï¼Œåˆå¹¶æœ‰æ•ˆæ•°æ®ã€åˆ é™¤é‡å¤æ•°æ®ã€‚\n\nç¯å¢ƒå°±æ•´äº†å‡ å¤©ç»“æœè¿˜æ˜¯æ²¡æå®šï¼ŒpyCharmè£…ç¬¬ä¸‰æ–¹åº“é¡ºåˆ©çš„æ—¶å€™çœŸç®€å•ï¼Œä¸€æ—¦æœ‰é—®é¢˜å„ç§å¤æ‚ï¼Œæœ€åç”¨Spyderè·‘äº†ã€æ™¨æ˜Ÿã€‘åŒå­¦çš„ä»£ç ç»ˆäºè·‘é€šäº†ï¼Œå·®ç‚¹åˆæ­»åœ¨ç¯å¢ƒä¸Šã€‚ã€‚ã€‚","like_count":0,"discussions":[{"author":{"id":1306094,"avatar":"https://static001.geekbang.org/account/avatar/00/13/ed/ee/c4779b67.jpg","nickname":"cy","note":"","ucode":"50D653399A31F6","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":491737,"discussion_content":"å¯ä»¥è¯•è¯•è£…anacondaï¼Œä½¿ç”¨condaçš„è™šæ‹Ÿç¯å¢ƒï¼Œå¯ä»¥çœå»å¾ˆå¤šç¯å¢ƒä¸Šçš„é—®é¢˜ã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1617292012,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":200150,"user_name":"Geek_æ¨—","can_delete":false,"product_type":"c1","uid":1920476,"ip_address":"","ucode":"F6D9D29ED521F8","user_header":"https://static001.geekbang.org/account/avatar/00/1d/4d/dc/6c0a311e.jpg","comment_is_top":false,"comment_ctime":1585550918,"is_pvip":false,"replies":[{"id":104331,"content":"å“ˆå“ˆï¼Œå­¦å®Œå°±å¯ä»¥æ‘†è„±è¿™ç§çƒ¦æ¼äº†","user_name":"ä½œè€…å›å¤","user_name_real":"cy","uid":1306094,"ctime":1617903111,"ip_address":"","comment_id":200150,"utype":1}],"discussion_count":1,"race_medal":0,"score":4,"product_id":100021701,"comment_content":"åˆšå¼€å§‹æ¥è§¦è¿™ä¸ªå·¥ä½œæ—¶ï¼Œå°±å› ä¸ºä¸æ³¨æ„æ•°æ®çš„æ•´æ´ï¼ŒçŠ¯äº†ä¸å°‘ç¬‘è¯ã€‚è·‘å‡ºæ¥çš„æŠ¥è¡¨æ•°æ®å“æ­»ä¸ªäººã€‚","like_count":0,"discussions":[{"author":{"id":1306094,"avatar":"https://static001.geekbang.org/account/avatar/00/13/ed/ee/c4779b67.jpg","nickname":"cy","note":"","ucode":"50D653399A31F6","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":491737,"discussion_content":"å¯ä»¥è¯•è¯•è£…anacondaï¼Œä½¿ç”¨condaçš„è™šæ‹Ÿç¯å¢ƒï¼Œå¯ä»¥çœå»å¾ˆå¤šç¯å¢ƒä¸Šçš„é—®é¢˜ã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1617292012,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":196659,"user_name":"åå…­ã€‚","can_delete":false,"product_type":"c1","uid":1935100,"ip_address":"","ucode":"DD4A02E3D904D5","user_header":"","comment_is_top":false,"comment_ctime":1585300567,"is_pvip":false,"replies":[{"id":104223,"content":"Good Job","user_name":"ä½œè€…å›å¤","user_name_real":"cy","uid":1306094,"ctime":1617731565,"ip_address":"","comment_id":196659,"utype":1}],"discussion_count":1,"race_medal":0,"score":4,"product_id":100021701,"comment_content":"import pandas as pd\nfrom pandas import Series,DataFrame\n\ndf = pd.read_csv(&#39;dws&#47;foodInfo.csv&#39;)\n# é¦–å…ˆ é€šè¿‡å­¦ä¹ çš„æ•°æ®åˆ†æçš„â€˜å®Œå…¨åˆä¸€â€™ç®€å•æ¸…æ´—å®šç†æ¥åˆ†ææ•°æ®\n# æ•°æ®å­˜åœ¨ç©ºå€¼ï¼ˆç©ºå€¼å¯ä»¥åˆ é™¤æˆ–æ˜¯ä½¿ç”¨å‡å€¼å¡«å…¥ï¼Œæ­¤å¤„æˆ‘ä»¬åˆ é™¤ï¼‰ã€å¤§å°å†™ä¸ä¸€ã€å•ä½ä¸åˆç†å­˜åœ¨è´Ÿæ•°\n# é¦–å…ˆå»é™¤å¯¼å…¥è¿›æ¥æ—¶å¤šå‡ºå’Œè¡Œ\ndf = df.dropna()\ndf = df.drop(df[df[&#39;ounces&#39;] &lt; 0].index)\ndf[&#39;food&#39;] = df[&#39;food&#39;].str.lower()\n# å¯¹æ•°æ®è¿›è¡Œé‡æ–°è¡Œç´¢å¼•\ndf.index = range(len(df))\n# df.reindex(index=list(range(len(df))))\ndf\n\n\tfood\tounces\tanimal\n0\tbacon\t4.0\tpig\n1\tpulled port\t3.0\tpig\n2\tpastrami\t6.0\tcow\n3\tcorned beef\t7.5\tcow\n4\tbacon\t8.0\tpig\n5\thoney ham\t5.0\tpig\n6\tnova lox\t6.0\tsalmon\n\n\n","like_count":0,"discussions":[{"author":{"id":1306094,"avatar":"https://static001.geekbang.org/account/avatar/00/13/ed/ee/c4779b67.jpg","nickname":"cy","note":"","ucode":"50D653399A31F6","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":489948,"discussion_content":"å“ˆå“ˆï¼Œå­¦å®Œå°±å¯ä»¥æ‘†è„±è¿™ç§çƒ¦æ¼äº†","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1617903111,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":195806,"user_name":"pyall","can_delete":false,"product_type":"c1","uid":1928703,"ip_address":"","ucode":"6C2A8DB86EE8FB","user_header":"https://static001.geekbang.org/account/avatar/00/1d/6d/ff/d5d14e2c.jpg","comment_is_top":false,"comment_ctime":1585216161,"is_pvip":false,"replies":[{"id":104347,"content":"Good Job!!!","user_name":"ä½œè€…å›å¤","user_name_real":"cy","uid":1306094,"ctime":1617904222,"ip_address":"","comment_id":195806,"utype":1}],"discussion_count":1,"race_medal":0,"score":4,"product_id":100021701,"comment_content":"æ•´ç†æ€è·¯ï¼š\n1ã€åˆ æ‰æ— æ•ˆæ•°æ®ï¼ˆæ•´è¡Œï¼‰ï¼Œå¹¶å¡«å……ç¼ºå¤±å€¼\n2ã€æ·»åŠ æ€§åˆ«åˆ—ï¼Œå¡«å……æ€§åˆ«å€¼\n3ã€åˆå¹¶ä¸‰ç»´ï¼ˆä¸‰åˆ—ï¼‰æ•°æ®\n4ã€é‡å‘½åè¡¨å¤´å­—æ®µåç§°\n5ã€ç¬¬3åˆ—ç»Ÿä¸€æ ‡å‡†å•ä½ï¼Œä¸”æ•°å­—åŒ–\n\n&quot;&quot;&quot;\nimport pandas as pd\nimport numpy as np\nimport matplotlib.pyplot as plt\n\npath = r&quot;E:\\accountMessage.xlsx&quot;\n\ndf = pd.read_excel(path)\ndf.columns #Index([&#39;\\t&#39;, 0, 1, 2, 3, 4, 5, 6, 7, 8, 9], dtype=&#39;object&#39;)\n#df.drop([&#39;&#39;])\ndf = df[[ 0, 1, 2, 3, 4, 5, 6, 7, 8, 9]]\n#1ã€åˆ æ‰ç©ºå€¼ï¼ˆæ•´è¡Œï¼‰\ndf.dropna(axis=0,how=&#39;all&#39;,inplace = True)\n\n#é‡å‘½åè¡¨å¤´å­—æ®µåç§°\ndf = df.rename(columns = {0:&#39;id&#39;,1:&#39;Name&#39;,2:&#39;Age&#39;,3:&#39;Weight&#39;})\ndf[&#39;Age&#39;] = df[&#39;Age&#39;].fillna(round(df[&#39;Age&#39;].mean(),0)) #ä½¿ç”¨å¹³å‡æ•°å¡«å……\ndf[&#39;Age&#39;].value_counts().index[0]#ä½¿ç”¨é¢‘æ•°æœ€é«˜çš„æ•°å¡«å……\n\n\n#2ã€æ·»åŠ æ€§åˆ«åˆ—ï¼Œå¡«å……æ€§åˆ«å€¼\ndf[&#39;sex&#39;]=&#39;&#39;\ndf[&#39;sex&#39;][df[4]==&quot;-&quot;]=&#39;female&#39;\ndf[&#39;sex&#39;][df[4]!=&quot;-&quot;]=&#39;male&#39;\n\n#3ã€åˆå¹¶ä¸‰ç»´ï¼ˆä¸‰åˆ—ï¼‰æ•°æ®\ndf[df==&#39;-&#39;]=0\ndf2 = df.replace(&#39;-&#39;,0)\ndf2[&#39;d1&#39;] =df2[4] +df2[7]\ndf2[&#39;d2&#39;] =df2[5] +df2[8]\ndf2[&#39;d3&#39;] =df2[6] +df2[9]\n\ndf3 = df2.drop([4,5,6,7,8,9],axis=1)\ndf3 = df2.drop([4]) #é»˜è®¤åˆ é™¤è¡Œæ•°æ®\n\n#5ã€ç¬¬3åˆ—ç»Ÿä¸€æ ‡å‡†å•ä½ï¼Œä¸”æ•°å­—åŒ–\n#1ç£…(lb)=0.4535924å…¬æ–¤(kg)\n\ndf3.isnull().sum()\n\n#æ•°å­—ä¸å­—æ¯åˆ†å¼€,åˆ†æˆä¸¤åˆ—\ndf3[&#39;Weight&#39;].str.replace(&#39;s&#39;,&quot;z&quot;)\ndf3[&#39;w_unit&#39;] = df3[&#39;Weight&#39;].str[-3:]\ndf3[&#39;w_new&#39;] = df3[&#39;Weight&#39;].str[:-3].astype(float)\n\n#è½¬åŒ–å•ä½æ•°å€¼\ndf3[&#39;w_kg&#39;] = 0\n#ä¸æ‰§è¡Œ\ndf3[df3[&#39;w_unit&#39;]==&#39;lbs&#39;].loc[:,&#39;w_kg&#39;] = df3[&#39;w_new&#39;]*0.4535924\n#æ‰§è¡ŒæˆåŠŸ\ndf3.loc[:,&#39;w_kg&#39;][df3[&#39;w_unit&#39;]==&#39;lbs&#39;] = df3[&#39;w_new&#39;]*0.4535924\ndf3.loc[:,&#39;w_kg&#39;][df3[&#39;w_unit&#39;]==&#39;kgs&#39;] = df3[&#39;w_new&#39;]","like_count":0,"discussions":[{"author":{"id":1306094,"avatar":"https://static001.geekbang.org/account/avatar/00/13/ed/ee/c4779b67.jpg","nickname":"cy","note":"","ucode":"50D653399A31F6","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":489353,"discussion_content":"Good Job","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1617731565,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":193772,"user_name":"å‘¨é“­å®‡","can_delete":false,"product_type":"c1","uid":1911388,"ip_address":"","ucode":"19C800CFC4F1F1","user_header":"","comment_is_top":false,"comment_ctime":1584960637,"is_pvip":false,"replies":[{"id":104354,"content":"Good Job","user_name":"ä½œè€…å›å¤","user_name_real":"cy","uid":1306094,"ctime":1617904565,"ip_address":"","comment_id":193772,"utype":1}],"discussion_count":1,"race_medal":0,"score":4,"product_id":100021701,"comment_content":"data = {&#39;food&#39;:[&#39;bacon&#39;,&#39;pulled pork&#39;,&#39;bacon&#39;,&#39;Pastrami&#39;,&#39;couned beef&#39;,&#39;bacon&#39;,&#39;pastrami&#39;,&#39;honey ham&#39;,&#39;nova lox&#39;],\n        &#39;ounces&#39;:[4.0,3.0,None,6.0,7.5,8.0,-3.0,5.0,6.0],\n        &#39;animal&#39;:[&#39;pig&#39;,&#39;pig&#39;,&#39;pig&#39;,&#39;cow&#39;,&#39;cow&#39;,&#39;pig&#39;,&#39;cow&#39;,&#39;pig&#39;,&#39;salmon&#39;,]}\n\ndf1 = DataFrame(data)\ndf1.columns = df1.columns.str.title() # å¤§å†™å¼€å¤´\ndf1[&#39;Food&#39;] = df1[&#39;Food&#39;].str.title()\ndf1[&#39;Ounces&#39;].fillna(df1[&#39;Ounces&#39;].mean(),inplace=True) # å¡«å……ç©ºå€¼\ndf1[&#39;Ounces&#39;] = df1[&#39;Ounces&#39;].apply(lambda a:abs(a)) # æ›¿æ¢è´Ÿå€¼\ndf1.sort_values([&#39;Food&#39;],ascending=[False],inplace=True) # é‡æ–°æ’åº\ndf1.index = range(len(df1)) \nindexArray = [0]\nfor i in range(1,df1[&#39;Food&#39;].count()): \n    indexArray.append(i)\ndf1[&#39;Id&#39;] = indexArray\npysqldf = lambda sql: sqldf(sql, globals())\ndata1 = {&#39;Food&#39;:[&#39;0&#39;]}\nlastResult = DataFrame(data1) # åˆ›å»ºä¸€ä¸ªæ–°çš„æ•°æ® ç”¨æ¥åˆ¤æ–­æ˜¯å¦ä¸ºé‡å¤æ•°æ®\nrepeatArray = []\nfor i in range(0,df1[&#39;Food&#39;].count()): # æ‰¾å‡ºåˆ—å€¼å‡ç›¸åŒè¡Œ\n    sql = &quot;select * from df1 where Animal = &#39;{}&#39; AND Food = &#39;{}&#39;&quot;.format(df1[&#39;Animal&#39;][i],df1[&#39;Food&#39;][i])\n    result = DataFrame(pysqldf(sql))\n    if len(result) != 1:\n        if result[&#39;Food&#39;][0] != lastResult[&#39;Food&#39;][0]: # åˆ¤æ–­æ˜¯å¦æ•°æ®\n            lastResult = result\n            repeatArray.append(result)\n\n\n\ndef calculate(result): # è®¡ç®—å¹³å‡æ•°\n    mean = 0.0;\n    for i in range(0,result[&#39;Food&#39;].count()):\n        mean = result[&#39;Ounces&#39;][i] + mean\n\n    mean = mean &#47; result[&#39;Food&#39;].count()\n    return mean\n\ndef replaceOunces(result,mean): # å°†å¹³å‡æ•°æ”¹ä¸ºOuncesçš„å€¼\n\n    for i in range(0,result[&#39;Food&#39;].count()):\n        resultId = result[&#39;Id&#39;][i]\n        df1.Ounces[df1[&#39;Id&#39;]==resultId]=mean\n\n\nfor i in range(0,len(repeatArray)): # åˆæ¬¡æ¸…æ´—\n    mean = calculate(repeatArray[i])\n    replaceOunces(repeatArray[i],mean)\n\ndf1.drop([&#39;Id&#39;],axis=1,inplace=True) #åˆ é™¤\ndf1.drop_duplicates(inplace=True) # å»é‡\nprint(df1)\n\n&#39;&#39;&#39;\nè¾“å‡ºç»“æœ\n          Food    Ounces  Animal\n0  Pulled Pork  3.000000     pig\n1     Pastrami  4.500000     cow\n3     Nova Lox  6.000000  salmon\n4    Honey Ham  5.000000     pig\n5  Couned Beef  7.500000     cow\n6        Bacon  5.520833     pig\n\n&#39;&#39;&#39;","like_count":0,"discussions":[{"author":{"id":1306094,"avatar":"https://static001.geekbang.org/account/avatar/00/13/ed/ee/c4779b67.jpg","nickname":"cy","note":"","ucode":"50D653399A31F6","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":489159,"discussion_content":"Good Job!!!","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1617904222,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":133878,"user_name":"å¢å˜‰æ•","can_delete":false,"product_type":"c1","uid":1293670,"ip_address":"","ucode":"64E17B0637EB86","user_header":"https://static001.geekbang.org/account/avatar/00/13/bd/66/bf0cfd22.jpg","comment_is_top":false,"comment_ctime":1568689721,"is_pvip":false,"replies":[{"id":53361,"content":"æ–‡å­—ç›¸å¯¹æ•°å€¼å°±æ¯”è¾ƒå›°éš¾äº†ï¼Œé™¤éæ˜¯ç¦»æ•£å˜é‡ï¼Œæ¯”å¦‚â€œç”·â€â€œå¥³â€è¿™ç§çš„ï¼Œå½“ç¦»æ•£å˜é‡çš„å¯é€‰é¡¹æ¯”è¾ƒå°‘çš„æƒ…å†µä¸‹ï¼Œå¯ä»¥æŒ‰ç…§é«˜é¢‘å€¼çš„æ–¹å¼è¿›è¡Œè¡¥å…¨ï¼Œå½“ç„¶ä½ ä¹Ÿå¯ä»¥æ ¹æ®é‚£æ¡æ•°æ®è‡ªèº«çš„æƒ…å†µï¼Œé€‰æ‹©é€‚åˆçš„è¡¥å…¨æ–¹å¼","user_name":"ä½œè€…å›å¤","user_name_real":"cy","uid":1306094,"ctime":1570428121,"ip_address":"","comment_id":133878,"utype":1}],"discussion_count":1,"race_medal":0,"score":4,"product_id":100021701,"comment_content":"æ–‡å­—çš„ç¼ºå¤±è¯¥å¦‚ä½•å®ç°æ•°æ®æ¸…æ´—","like_count":0,"discussions":[{"author":{"id":1306094,"avatar":"https://static001.geekbang.org/account/avatar/00/13/ed/ee/c4779b67.jpg","nickname":"cy","note":"","ucode":"50D653399A31F6","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":488653,"discussion_content":"Good Job","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1617904565,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":126229,"user_name":"æ¨é™†ä¼Ÿ","can_delete":false,"product_type":"c1","uid":1108457,"ip_address":"","ucode":"3BC968447406EB","user_header":"https://static001.geekbang.org/account/avatar/00/10/e9/e9/1f95e422.jpg","comment_is_top":false,"comment_ctime":1566351551,"is_pvip":false,"replies":[{"id":53412,"content":"èµ ä¸è¿‡æ•°æ®æ¸…æ´—é€šå¸¸æ˜¯ä¸ªåå¤çš„è¿‡ç¨‹ï¼Œä¹Ÿå°±æ˜¯æ¸…æ´—äº†ä¸€éƒ¨åˆ†æ•°æ®ä¹‹åé‡æ–°æ£€æŸ¥ï¼Œç„¶åå†æ‰¾åˆ°æ–°çš„é—®é¢˜ç»§ç»­æ¸…æ´—ï¼Œæ‰€ä»¥æ•°æ®é‡å¤§çš„æ—¶å€™ï¼Œå°±åƒæ‰¾Bugä¸€æ ·ï¼ŒèŠ±è´¹çš„æ—¶é—´ä¹Ÿå¾ˆå¤š","user_name":"ä½œè€…å›å¤","user_name_real":"cy","uid":1306094,"ctime":1570435043,"ip_address":"","comment_id":126229,"utype":1}],"discussion_count":1,"race_medal":4,"score":4,"product_id":100021701,"comment_content":"å¾®æœåŠ¡æ¶æ„æä¾›æ•°æ®çš„å¾®æœåŠ¡ä¸­ä¹Ÿå¯ä»¥å¸çº³æ•°æ®æ¸…æ´—çš„æ€æƒ³","like_count":0,"discussions":[{"author":{"id":1306094,"avatar":"https://static001.geekbang.org/account/avatar/00/13/ed/ee/c4779b67.jpg","nickname":"cy","note":"","ucode":"50D653399A31F6","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":463895,"discussion_content":"èµ ä¸è¿‡æ•°æ®æ¸…æ´—é€šå¸¸æ˜¯ä¸ªåå¤çš„è¿‡ç¨‹ï¼Œä¹Ÿå°±æ˜¯æ¸…æ´—äº†ä¸€éƒ¨åˆ†æ•°æ®ä¹‹åé‡æ–°æ£€æŸ¥ï¼Œç„¶åå†æ‰¾åˆ°æ–°çš„é—®é¢˜ç»§ç»­æ¸…æ´—ï¼Œæ‰€ä»¥æ•°æ®é‡å¤§çš„æ—¶å€™ï¼Œå°±åƒæ‰¾Bugä¸€æ ·ï¼ŒèŠ±è´¹çš„æ—¶é—´ä¹Ÿå¾ˆå¤š","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1570435043,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":124710,"user_name":"æ¨å®å¼º","can_delete":false,"product_type":"c1","uid":1189290,"ip_address":"","ucode":"B2352D7EA24F31","user_header":"https://static001.geekbang.org/account/avatar/00/12/25/aa/ced0170d.jpg","comment_is_top":false,"comment_ctime":1565949170,"is_pvip":false,"replies":[{"id":63519,"content":"Good Job","user_name":"ä½œè€…å›å¤","user_name_real":"cy","uid":1306094,"ctime":1577516450,"ip_address":"","comment_id":124710,"utype":1}],"discussion_count":2,"race_medal":0,"score":5,"product_id":100021701,"comment_content":"data = {\n        &quot;ID&quot;: [1.0, 2.0, 3.0, 4.0, 5.0, 6.0, 7.0, 8.0, None, 9.0,  10.0],\n        &quot;name&quot;: [&#39;Mickey Mouse&#39;, &#39;Donald Dunck&#39;, &#39;Mini Mouse&#39;, &#39;Scrooge McDuck&#39;, &#39;Pink Panther&#39;, &#39;Huey  McDuck&#39;, &#39;Dewey McDuck&#39;, &#39;Scoopy Doo&#39;, None, &#39;Huey  McDuck&#39;, &#39;Louie McDuck&#39;],\n        &quot;age&quot;: [56.0, 34.0, 16.0, None, 54.0, 52.0, 19.0, 32.0, None, 52.0, 12.0],\n        &quot;weight&quot;: [&#39;70kgs&#39;, &#39;154.89lbs&#39;, None, &#39;78kgs&#39;, &#39;198.658lbs&#39;, &#39;189lbs&#39;, &#39;56kgs&#39;, &#39;78kgs&#39;, None, &#39;189lbs&#39;, &#39;45kgs&#39;],\n        &quot;m0006&quot;: [72.0, None, None, 78, None, None, None, 78.0, None, None, None],\n        &quot;m0612&quot;: [69, None, None, 79, None, None, None, 76, None, None, None],\n        &quot;m1218&quot;: [71.0, None, None, 72, None, None, None, 75.0, None, None, None],\n        &quot;f0006&quot;: [None, 85, 65, None, 69, 68, 71, None, None, 68, 92],\n        &quot;f0612&quot;: [None, 84, 69, None, None, 75, 78, None, None, 75, 95],\n        &quot;f1218&quot;: [None, 76, 72, None, 75, 72, 75, None, None, 72, 87]\n}","like_count":0},{"had_liked":false,"id":122338,"user_name":"å™¼é‡Œå•ªå•¦å•ªå•¦å™¼é‡Œå™¼é‡Œå•ªå•¦","can_delete":false,"product_type":"c1","uid":1109143,"ip_address":"","ucode":"2A4B86D38F7E11","user_header":"https://static001.geekbang.org/account/avatar/00/10/ec/97/58e7bc9a.jpg","comment_is_top":false,"comment_ctime":1565343102,"is_pvip":false,"replies":[{"id":63561,"content":"Good Job","user_name":"ä½œè€…å›å¤","user_name_real":"cy","uid":1306094,"ctime":1577518227,"ip_address":"","comment_id":122338,"utype":1}],"discussion_count":1,"race_medal":0,"score":5,"product_id":100021701,"comment_content":"#coding = utf-8\n\n&#39;&#39;&#39;\nä¸‹é¢æ˜¯å¯¹è‚‰ç±»æ•°æ®è¿›è¡Œæ¸…æ´—çš„ç»ƒä¹ \n\næˆ‘ä»¬çœ‹åˆ°æ•°æ®ï¼Œæœ‰ä»¥ä¸‹éœ€è¦å…³æ³¨çš„ï¼š\n1. é£Ÿç‰©åç§°ä¸­é¦–å­—æ¯æœ‰å¤§å†™æœ‰å°å†™\n2. æœ‰å¾ˆå¤šé‡å¤æ•°æ®ï¼Œéœ€è¦åˆå¹¶\n&#39;&#39;&#39;\n\nimport pandas\nimport pandas as pd \nfrom pandas import Series, DataFrame\n\ndf = DataFrame(pd.read_excel(r&#39;F:\\Work\\open_courses\\Data_Analysis_by_python\\clean_data\\foodInformation.xlsx&#39;))\n\nprint(df)\nprint(&#39;---------------------------------------------&#39;)\n\n\n&#39;&#39;&#39;\né¦–å…ˆå°†é£Ÿç‰©åç§°è°ƒæ•´æˆç»Ÿä¸€çš„å¤§å°å†™\n&#39;&#39;&#39;\ndf[&#39;food&#39;] = df[&#39;food&#39;].str.capitalize()\nprint(df)\nprint(&#39;---------------------------------------------&#39;)\n&#39;&#39;&#39;\næ‰¾åˆ°ç›¸åŒçš„é¡¹ï¼Œå¯¹æ•°æ®è¿›è¡Œåˆå¹¶\n1. é¦–å…ˆé’ˆå¯¹foodå¯¹dfè¿›è¡Œåˆ†ç»„ï¼Œå¹¶è¿›è¡Œæ•°æ®åˆå¹¶\n2. å¯¹åˆ†ç»„åçš„æ•°æ®è¿›è¡Œé‡æ–°DataFrameè½¬æ¢ï¼Œå½¢æˆæ–°çš„DataFrame\n3. å¯¹åŸæ¥çš„dataframeè¿›è¡Œå¤„ç†ï¼Œå»é‡+å»é™¤æ²¡æœ‰æ„ä¹‰çš„åˆ—\n4. ä¸¤ä¸ªdataframeåˆå¹¶\n&#39;&#39;&#39;\n#å¯¹æ•°æ®è¿›è¡Œåˆ†ç»„\ngroupbyObj = df.groupby(df[&#39;food&#39;]).sum()\nprint(groupbyObj)\nprint(&#39;---------------------------------------------&#39;)\n#å¯¹åˆ†ç»„åçš„æ•°æ®è¿›è¡ŒDataFrameåŒ–\nnew_df = groupbyObj.reset_index()\nprint(new_df)\nprint(&#39;---------------------------------------------&#39;)\n#å°†åŸæœ‰çš„æ•°æ®è¡¨è¿›è¡Œå»é‡,å¹¶åˆ é™¤ouncesåˆ—\ndf.drop_duplicates([&#39;food&#39;], inplace=True)\ndf = df.reindex(range(df.shape[0]), method = &#39;bfill&#39;)\ndf.drop(columns = [&#39;ounces&#39;], inplace = True)\nprint(df)\nprint(&#39;---------------------------------------------&#39;)\n#ä¸¤ä¸ªDataFrameåˆå¹¶\nresult = pd.merge(df, new_df, on = &#39;food&#39;)\nprint(result)\n\n#æ‰“å°\n#result.to_csv(r&#39;F:\\Work\\open_courses\\Data_Analysis_by_python\\clean_data\\foodInformation_new.csv&#39;)","like_count":0,"discussions":[{"author":{"id":1306094,"avatar":"https://static001.geekbang.org/account/avatar/00/13/ed/ee/c4779b67.jpg","nickname":"cy","note":"","ucode":"50D653399A31F6","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":462212,"discussion_content":"Good Job","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1577518227,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":119462,"user_name":"ç‹å¼ ","can_delete":false,"product_type":"c1","uid":1526391,"ip_address":"","ucode":"8153B5532B2C62","user_header":"https://static001.geekbang.org/account/avatar/00/17/4a/77/754a127b.jpg","comment_is_top":false,"comment_ctime":1564595211,"is_pvip":false,"replies":[{"id":63601,"content":"å¤šè°¢åˆ†äº«","user_name":"ä½œè€…å›å¤","user_name_real":"cy","uid":1306094,"ctime":1577520588,"ip_address":"","comment_id":119462,"utype":1}],"discussion_count":1,"race_medal":0,"score":5,"product_id":100021701,"comment_content":"#_*_ coding:utf-8 _*_\nimport pandas as pd\ndata = {&#39;ounces&#39;:[4.0,3.0,None,6.0,7.5,8.0,-3.0,5.0,6.0],&#39;animal&#39;:[&#39;pig&#39;,&#39;pig&#39;,&#39;pig&#39;,&#39;cow&#39;,&#39;cow&#39;,&#39;pig&#39;,&#39;cow&#39;,&#39;pig&#39;,&#39;salmon&#39;]}\ndf=pd.DataFrame(data,index=[&#39;bacon&#39;,&#39;pulled pork&#39;,&#39;bacon&#39;,&#39;Pastrami&#39;,&#39;corned beef&#39;,&#39;bacon&#39;,&#39;Pastrami&#39;,&#39;honey ham&#39;,&#39;nova lox&#39;],columns=[&#39;ounces&#39;,&#39;animal&#39;])\nprint(df)\ndf.to_excel(&#39;data1.xlsx&#39;)\n------------------------\nä½ ä»¬è¦çš„æ•°æ®","like_count":0,"discussions":[{"author":{"id":1306094,"avatar":"https://static001.geekbang.org/account/avatar/00/13/ed/ee/c4779b67.jpg","nickname":"cy","note":"","ucode":"50D653399A31F6","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":460913,"discussion_content":"å¤šè°¢åˆ†äº«","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1577520588,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":118924,"user_name":"å»ºå¼º","can_delete":false,"product_type":"c1","uid":1397126,"ip_address":"","ucode":"62B03D0E0C64EC","user_header":"https://static001.geekbang.org/account/avatar/00/15/51/86/b5fd8dd8.jpg","comment_is_top":false,"comment_ctime":1564470177,"is_pvip":false,"replies":[{"id":63610,"content":"Good Job","user_name":"ä½œè€…å›å¤","user_name_real":"cy","uid":1306094,"ctime":1577521036,"ip_address":"","comment_id":118924,"utype":1}],"discussion_count":1,"race_medal":0,"score":5,"product_id":100021701,"comment_content":"1.&quot;food&quot;åˆ—æ•°æ®å¤§å°å†™ä¸ç»Ÿä¸€ï¼Œæ¸…æ´—æ–¹æ³•ï¼šç»Ÿä¸€è½¬æ¢æˆå°å†™ã€‚\n2.&quot;ounces&quot;åˆ—æ•°æ®æœ‰ç¼ºå¤±å€¼ï¼Œç”¨å¹³å‡å€¼å¡«å……ã€‚\n3.&quot;ounces&quot;åˆ—æœ‰ä¸€è¡Œæ•°æ®æ˜¯-3ï¼Œä¸åˆç†æ•°æ®ï¼Œè½¬æ¢ä¸ºæ­£æ•°ã€‚\n4.&quot;food&quot;åˆ—ä¸­ï¼Œå€¼=&quot;bacon&quot;ã€&quot;pastrami&quot;çš„è¡Œæœ‰é‡å¤ï¼Œå¯è€ƒè™‘æŠŠè¿™äº›é‡å¤è¡Œè¿›è¡Œåˆå¹¶å¤„ç†ã€‚\n\nä»¥ä¸Šæ˜¯æˆ‘èƒ½å‘ç°çš„å‡ ç‚¹é—®é¢˜ï¼Œè¯·è€å¸ˆæŒ‡æ­£ã€‚","like_count":0,"discussions":[{"author":{"id":1306094,"avatar":"https://static001.geekbang.org/account/avatar/00/13/ed/ee/c4779b67.jpg","nickname":"cy","note":"","ucode":"50D653399A31F6","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":460913,"discussion_content":"å¤šè°¢åˆ†äº«","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1577520588,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":104481,"user_name":"TONY","can_delete":false,"product_type":"c1","uid":1068130,"ip_address":"","ucode":"632E2309166536","user_header":"","comment_is_top":false,"comment_ctime":1560763515,"is_pvip":false,"replies":[{"id":64092,"content":"Good Job","user_name":"ä½œè€…å›å¤","user_name_real":"cy","uid":1306094,"ctime":1577609159,"ip_address":"","comment_id":104481,"utype":1}],"discussion_count":1,"race_medal":0,"score":5,"product_id":100021701,"comment_content":"import pandas as pd\nimport numpy as np\ndf = pd.read_csv(&quot;.&#47;foods.csv&quot;)\ndf.columns = df.columns.str.strip() #å»æ‰åˆ—åç©ºæ ¼ï¼Œå¦åˆ™å½±å“åç»­å¯¹åˆ—çš„æ“ä½œï¼›\ndf[&#39;food&#39;] = df[&#39;food&#39;].str.strip() #å»æ‰foodåˆ—åç§°ç©ºæ ¼ï¼Œå¦åˆ™å½±å“å¯¹åç§°çš„æ“ä½œï¼›\ndf[&#39;food&#39;] = df[&#39;food&#39;].str.capitalize() # å¯¹foodåç§°é¦–å­—æ¯å¤§å†™\ndf[&#39;ounces&#39;] = df[&#39;ounces&#39;].apply(lambda a: abs(a)) #å¯¹ouncesåˆ—è´Ÿå€¼å–ç»å¯¹å€¼\ndf.fillna(df.mean(),inplace = True) #åœ¨å–ç»å¯¹å€¼åç”¨åˆ—å¹³å‡å€¼å¡«å……NaNå€¼\ndf\ndf.drop_duplicates(&#39;food&#39;,inplace = True)  #åˆ é™¤foodåˆ—é‡å¤æ•°æ®\ndf\ndf.to_csv(&#39;.&#47;foods.csv&#39;)  #å°†ç»“æœå†™å›csv\nprint(df)","like_count":0,"discussions":[{"author":{"id":1306094,"avatar":"https://static001.geekbang.org/account/avatar/00/13/ed/ee/c4779b67.jpg","nickname":"cy","note":"","ucode":"50D653399A31F6","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":460665,"discussion_content":"Good Job","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1577521036,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":92455,"user_name":"å¿˜çŸ¢","can_delete":false,"product_type":"c1","uid":1513551,"ip_address":"","ucode":"FAFD133BC2F6E4","user_header":"http://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTLVjETMtKViaoBEibZH2nS7jb4521k2ZsJHtkYnq4mglU8Jju6GiczexAZWpbXtQVico2c12JPSPaWpbA/132","comment_is_top":false,"comment_ctime":1557277107,"is_pvip":false,"replies":[{"id":64196,"content":"ä¹Ÿå¯ä»¥ï¼Œæœ‰4600ä¸‡æ¡æ•°æ®é‡ï¼Œä½ ä¹Ÿå¯ä»¥é‡‡ç”¨Pythonæ¥å¤„ç†ï¼Œå°±éœ€è¦ç”¨ä¸€äº›æ–¹æ³•äº†ï¼Œæ¯”å¦‚åˆ†chunkï¼ˆå—ï¼‰è¯»å–ï¼Œç„¶åæ“ä½œ","user_name":"ä½œè€…å›å¤","user_name_real":"cy","uid":1306094,"ctime":1577614056,"ip_address":"","comment_id":92455,"utype":1}],"discussion_count":1,"race_medal":0,"score":5,"product_id":100021701,"comment_content":"è¯·é—®è€å¸ˆï¼Œä¸Šäº¿æ¡è®°å½•çš„æ•°æ®é‡ä¹Ÿé€‚åˆç”¨Pythonæ¥ä½œæ¸…æ´—å—ï¼Ÿ","like_count":0,"discussions":[{"author":{"id":1306094,"avatar":"https://static001.geekbang.org/account/avatar/00/13/ed/ee/c4779b67.jpg","nickname":"cy","note":"","ucode":"50D653399A31F6","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":454288,"discussion_content":"Good Job","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1577609159,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":90242,"user_name":"å†¯å¾·ç« ","can_delete":false,"product_type":"c1","uid":1184025,"ip_address":"","ucode":"EF2343BE787C82","user_header":"https://static001.geekbang.org/account/avatar/00/12/11/19/6e0c5c9e.jpg","comment_is_top":false,"comment_ctime":1556457716,"is_pvip":false,"replies":[{"id":64209,"content":"æ€»ç»“ä¸é”™","user_name":"ä½œè€…å›å¤","user_name_real":"cy","uid":1306094,"ctime":1577614249,"ip_address":"","comment_id":90242,"utype":1}],"discussion_count":1,"race_medal":0,"score":5,"product_id":100021701,"comment_content":"1.æ•°æ®æ¸…æ´—æ˜¯æ•°æ®åˆ†æçš„åŸºç¡€ï¼Œæ•°æ®å‡†ç¡®æ€§å†³å®šç»“æœå‡†ç¡®æ€§ã€‚\n\n2.æ•°æ®æ¸…æ´—å æ•°æ®æŒ–æ˜å·¥ä½œé‡80ï¼Œ\n\n3.æ•°æ®æ¸…æ´—ï¼Œå®Œå…¨åˆä¸€åŸåˆ™ã€‚\nå®Œæ•´æ€§ï¼Œç¡®ä¿æ²¡æœ‰ç©ºå€¼ã€‚\nå…¨é¢æ€§ï¼Œç¡®è®¤å•ä½ï¼Œæ•°æ®è´¨é‡\nåˆæ³•æ€§ï¼Œæ•°æ®æ˜¯å¦éµä»è‡ªç„¶è§„å¾‹ã€‚\nå”¯ä¸€æ€§ï¼Œå»é™¤é‡å¤æ•°æ®ã€‚\n4.æ•°æ®ç»“æœæ£€æ ¸ä¹ æƒ¯ã€‚","like_count":0,"discussions":[{"author":{"id":1306094,"avatar":"https://static001.geekbang.org/account/avatar/00/13/ed/ee/c4779b67.jpg","nickname":"cy","note":"","ucode":"50D653399A31F6","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":449267,"discussion_content":"ä¹Ÿå¯ä»¥ï¼Œæœ‰4600ä¸‡æ¡æ•°æ®é‡ï¼Œä½ ä¹Ÿå¯ä»¥é‡‡ç”¨Pythonæ¥å¤„ç†ï¼Œå°±éœ€è¦ç”¨ä¸€äº›æ–¹æ³•äº†ï¼Œæ¯”å¦‚åˆ†chunkï¼ˆå—ï¼‰è¯»å–ï¼Œç„¶åæ“ä½œ","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1577614056,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":85661,"user_name":"é’çŸ³","can_delete":false,"product_type":"c1","uid":1215531,"ip_address":"","ucode":"B0056AD6453322","user_header":"https://static001.geekbang.org/account/avatar/00/12/8c/2b/3ab96998.jpg","comment_is_top":false,"comment_ctime":1555165683,"is_pvip":false,"replies":[{"id":64264,"content":"Good Job","user_name":"ä½œè€…å›å¤","user_name_real":"cy","uid":1306094,"ctime":1577615664,"ip_address":"","comment_id":85661,"utype":1}],"discussion_count":1,"race_medal":0,"score":5,"product_id":100021701,"comment_content":"#!usr&#47;bin&#47;python3\n# -*- coding:utf-8 -*-\n\nimport os\nimport numpy as np\nimport pandas as pd\n\n\npath = &#39;&#47;Users&#47;albert.ming.xu&#47;Downloads&#47;11.data.xlsx&#39;\nnew_path = os.path.splitext(path)[0] + &#39;_new&#39; + os.path.splitext(path)[1]\ndata_type = {&#39;food&#39;: np.str, &#39;ounces&#39;: np.float, &#39;animal&#39;: np.str}\n\ndf = pd.read_excel(path, sheet_name=0, header=0, dtype=data_type)\n\n# ç»Ÿä¸€foodåç§°ä¸ºå°å†™å­—æ¯\ndf[&#39;food&#39;] = df[&#39;food&#39;].str.lower()\n# å•ä½å–ç»å¯¹å€¼\ndf[&#39;ounces&#39;] = df[&#39;ounces&#39;].abs()\n# å°†ouncesåˆ—çš„ç©ºè¡Œå¡«å……ä¸ºå¹³å‡å€¼\ndf[&#39;ounces&#39;].fillna(df[&#39;ounces&#39;].mean(), inplace=True)\n# åˆ é™¤ä»»æ„å­—æ®µåŒ…å«ç©ºå€¼çš„æ•°æ®\ndf.dropna(how=&#39;any&#39;, axis=0, inplace=True)\n# åˆ é™¤foodå­—æ®µå‡ºç°é‡å¤çš„è¡Œï¼Œä½†baconæœ€åä¼šå­˜åœ¨ä¸‰è¡Œæ•°æ®ï¼Œouncesåˆ†åˆ«æ˜¯4.0ã€5.31ã€8.0ï¼Œæœ€åä¿ç•™å“ªä¸ªæ•°æ®æ›´å¥½æ˜¯ä¸ªé—®é¢˜\ndf.drop_duplicates(&#39;food&#39;, inplace=True)\n\ndf.to_excel(new_path, float_format=&quot;%.2f&quot;)\n","like_count":0,"discussions":[{"author":{"id":1306094,"avatar":"https://static001.geekbang.org/account/avatar/00/13/ed/ee/c4779b67.jpg","nickname":"cy","note":"","ucode":"50D653399A31F6","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":448437,"discussion_content":"æ€»ç»“ä¸é”™","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1577614249,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":85072,"user_name":"æ»¢","can_delete":false,"product_type":"c1","uid":1221511,"ip_address":"","ucode":"971A6F20AF3F9A","user_header":"https://static001.geekbang.org/account/avatar/00/12/a3/87/c415e370.jpg","comment_is_top":false,"comment_ctime":1554971253,"is_pvip":false,"replies":[{"id":64270,"content":"Good Job","user_name":"ä½œè€…å›å¤","user_name_real":"cy","uid":1306094,"ctime":1577615774,"ip_address":"","comment_id":85072,"utype":1}],"discussion_count":1,"race_medal":0,"score":5,"product_id":100021701,"comment_content":"å½•å…¥çš„åŸå§‹æ•°æ®é“¾æ¥ï¼š\nå…³äºç»ƒä¹ ï¼šé¦–å…ˆæŠŠè¿™ä»½æ•°æ®å½“åšé£Ÿææ¶ˆè€—ï¼Œå•ä½ä¸ºç›å¸ï¼ˆå½“ç„¶å¯¹ä¸šåŠ¡çš„ç†è§£æœ‰å¤šç§ï¼‰ã€‚ ï¼ˆ1ï¼‰å¯¹äºè¿™ä»½æ•°æ®NaNå€¼åº”è¯¥åˆ é™¤ï¼Œä¸èƒ½è¿›è¡Œè¡¥å…¨ï¼›ï¼ˆ2ï¼‰å¦‚æœæ˜¯é£Ÿææ¶ˆè€—ï¼Œè´Ÿæ•°çš„å­˜åœ¨ä¹Ÿæ˜¯åˆç†çš„ï¼Œä¸ç”¨å¯¹é½æ±‚ç»å¯¹å€¼ï¼ˆ3ï¼‰é‡å¤çš„åŸå§‹æ•°æ®ä¸èƒ½åˆ é™¤ï¼Œåº”è¯¥æ˜¯æ±‡æ€»åå†è¿›è¡Œåˆ é™¤ï¼Œä»¥ä¸‹æ˜¯ä»£ç ï¼ŒPython3.6 IDLE \n&gt;&gt;&gt; import pandas as pd\n&gt;&gt;&gt; from pandas import Series,DataFrame\n&gt;&gt;&gt; df = DataFrame(pd.read_excel(&#39;&#47;Users&#47;apple&#47;Desktop&#47;GitHubProject&#47;Read mark&#47;æ•°æ®åˆ†æ&#47;geekTime&#47;data&#47;foodInformation.xlsx&#39;))\n&gt;&gt;&gt; print (df)\n          food  ounces  animal\n0        bacon     4.0     pig\n1  pulled port     3.0     pig\n2        bacon     NaN     pig\n3     Pastrami     6.0     cow\n4  corned beef     7.5     cow\n5        Bacon     8.0     pig\n6     pastrami    -3.0     cow\n7    honey ham     5.0     pig\n8     nova lox     6.0  salmon\n#åˆ é™¤ç©ºå€¼\n&gt;&gt;&gt; df.dropna(inplace=True)\n#foodä¸€æ å…¨éƒ¨æ¢æˆå°å†™\n&gt;&gt;&gt; df[&#39;food&#39;]=df[&#39;food&#39;].str.lower()\n #æŸ¥æ‰¾foodé‡å¤è®°å½•ï¼Œåˆ†ç»„æ±‚å…¶æ€»å’Œ\n&gt;&gt;&gt; food_rows = df[df[&#39;food&#39;].duplicated(keep=False)]\n&gt;&gt;&gt; food_items=food_rows.groupby(&#39;food&#39;).sum()\n&gt;&gt;&gt; food_items[&#39;food&#39;]=food_items.index\n#æ•°æ®èµ‹å€¼æ›¿æ¢\n&gt;&gt;&gt; for i,row in food_items.iterrows():\n\tdf.loc[df[&#39;food&#39;]==row[&#39;food&#39;],&#39;ounces&#39;]=row[&#39;ounces&#39;]\n#åˆ é™¤é‡å¤\n&gt;&gt;&gt; df.drop_duplicates(inplace=True)\n#é‡æ–°ç”Ÿæˆç´¢å¼•\n&gt;&gt;&gt; df.index=range(df.shape[0])\n&gt;&gt;&gt; print (df)\n          food  ounces  animal\n0        bacon    12.0     pig\n1  pulled port     3.0     pig\n2     pastrami     3.0     cow\n3  corned beef     7.5     cow\n4    honey ham     5.0     pig\n5     nova lox     6.0  salmon\n","like_count":0,"discussions":[{"author":{"id":1306094,"avatar":"https://static001.geekbang.org/account/avatar/00/13/ed/ee/c4779b67.jpg","nickname":"cy","note":"","ucode":"50D653399A31F6","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":446547,"discussion_content":"Good Job","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1577615774,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":84023,"user_name":"FeiFei","can_delete":false,"product_type":"c1","uid":1045586,"ip_address":"","ucode":"01CD655DD4E56C","user_header":"https://static001.geekbang.org/account/avatar/00/0f/f4/52/10c4d863.jpg","comment_is_top":false,"comment_ctime":1554770580,"is_pvip":false,"replies":[{"id":64288,"content":"å“ˆå“ˆå“ˆ å¾ˆå¥½çš„åˆ†äº«","user_name":"ä½œè€…å›å¤","user_name_real":"cy","uid":1306094,"ctime":1577616120,"ip_address":"","comment_id":84023,"utype":1}],"discussion_count":1,"race_medal":0,"score":5,"product_id":100021701,"comment_content":"80ï¼…æ—¶é—´éœ€è¦åœ¨æ•°æ®æ¸…æ´—ä¸Šã€‚\næ‹…å¿ƒå…¬å¸ä¸èƒ½ç»™äºˆé‚£ä¹ˆå¤šæ—¶é—´æ¥åšè¿™ä»¶äº‹ã€‚","like_count":0,"discussions":[{"author":{"id":1306094,"avatar":"https://static001.geekbang.org/account/avatar/00/13/ed/ee/c4779b67.jpg","nickname":"cy","note":"","ucode":"50D653399A31F6","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":446220,"discussion_content":"å“ˆå“ˆå“ˆ å¾ˆå¥½çš„åˆ†äº«","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1577616120,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":124710,"user_name":"æ¨å®å¼º","can_delete":false,"product_type":"c1","uid":1189290,"ip_address":"","ucode":"B2352D7EA24F31","user_header":"https://static001.geekbang.org/account/avatar/00/12/25/aa/ced0170d.jpg","comment_is_top":false,"comment_ctime":1565949170,"is_pvip":false,"replies":[{"id":63519,"content":"Good Job","user_name":"ä½œè€…å›å¤","user_name_real":"cy","uid":1306094,"ctime":1577516450,"ip_address":"","comment_id":124710,"utype":1}],"discussion_count":2,"race_medal":0,"score":5,"product_id":100021701,"comment_content":"data = {\n        &quot;ID&quot;: [1.0, 2.0, 3.0, 4.0, 5.0, 6.0, 7.0, 8.0, None, 9.0,  10.0],\n        &quot;name&quot;: [&#39;Mickey Mouse&#39;, &#39;Donald Dunck&#39;, &#39;Mini Mouse&#39;, &#39;Scrooge McDuck&#39;, &#39;Pink Panther&#39;, &#39;Huey  McDuck&#39;, &#39;Dewey McDuck&#39;, &#39;Scoopy Doo&#39;, None, &#39;Huey  McDuck&#39;, &#39;Louie McDuck&#39;],\n        &quot;age&quot;: [56.0, 34.0, 16.0, None, 54.0, 52.0, 19.0, 32.0, None, 52.0, 12.0],\n        &quot;weight&quot;: [&#39;70kgs&#39;, &#39;154.89lbs&#39;, None, &#39;78kgs&#39;, &#39;198.658lbs&#39;, &#39;189lbs&#39;, &#39;56kgs&#39;, &#39;78kgs&#39;, None, &#39;189lbs&#39;, &#39;45kgs&#39;],\n        &quot;m0006&quot;: [72.0, None, None, 78, None, None, None, 78.0, None, None, None],\n        &quot;m0612&quot;: [69, None, None, 79, None, None, None, 76, None, None, None],\n        &quot;m1218&quot;: [71.0, None, None, 72, None, None, None, 75.0, None, None, None],\n        &quot;f0006&quot;: [None, 85, 65, None, 69, 68, 71, None, None, 68, 92],\n        &quot;f0612&quot;: [None, 84, 69, None, None, 75, 78, None, None, 75, 95],\n        &quot;f1218&quot;: [None, 76, 72, None, 75, 72, 75, None, None, 72, 87]\n}","like_count":0,"discussions":[{"author":{"id":1306094,"avatar":"https://static001.geekbang.org/account/avatar/00/13/ed/ee/c4779b67.jpg","nickname":"cy","note":"","ucode":"50D653399A31F6","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":463290,"discussion_content":"Good Job","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1577516450,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1308516,"avatar":"https://static001.geekbang.org/account/avatar/00/13/f7/64/03d8154f.jpg","nickname":"å¯ä¹æ³¡æ¸æ","note":"","ucode":"C709B781DF0456","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":8318,"discussion_content":"å¥½äººå‘ï¼Œ æˆ‘è¯»äº†å‰é¢å‡ æ¥¼githubé‡Œçš„æ•°æ®å ä¸€ç›´æ— æ³•é‡å‘½åã€‚ã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1567915685,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":122338,"user_name":"å™¼é‡Œå•ªå•¦å•ªå•¦å™¼é‡Œå™¼é‡Œå•ªå•¦","can_delete":false,"product_type":"c1","uid":1109143,"ip_address":"","ucode":"2A4B86D38F7E11","user_header":"https://static001.geekbang.org/account/avatar/00/10/ec/97/58e7bc9a.jpg","comment_is_top":false,"comment_ctime":1565343102,"is_pvip":false,"replies":[{"id":63561,"content":"Good Job","user_name":"ä½œè€…å›å¤","user_name_real":"cy","uid":1306094,"ctime":1577518227,"ip_address":"","comment_id":122338,"utype":1}],"discussion_count":1,"race_medal":0,"score":5,"product_id":100021701,"comment_content":"#coding = utf-8\n\n&#39;&#39;&#39;\nä¸‹é¢æ˜¯å¯¹è‚‰ç±»æ•°æ®è¿›è¡Œæ¸…æ´—çš„ç»ƒä¹ \n\næˆ‘ä»¬çœ‹åˆ°æ•°æ®ï¼Œæœ‰ä»¥ä¸‹éœ€è¦å…³æ³¨çš„ï¼š\n1. é£Ÿç‰©åç§°ä¸­é¦–å­—æ¯æœ‰å¤§å†™æœ‰å°å†™\n2. æœ‰å¾ˆå¤šé‡å¤æ•°æ®ï¼Œéœ€è¦åˆå¹¶\n&#39;&#39;&#39;\n\nimport pandas\nimport pandas as pd \nfrom pandas import Series, DataFrame\n\ndf = DataFrame(pd.read_excel(r&#39;F:\\Work\\open_courses\\Data_Analysis_by_python\\clean_data\\foodInformation.xlsx&#39;))\n\nprint(df)\nprint(&#39;---------------------------------------------&#39;)\n\n\n&#39;&#39;&#39;\né¦–å…ˆå°†é£Ÿç‰©åç§°è°ƒæ•´æˆç»Ÿä¸€çš„å¤§å°å†™\n&#39;&#39;&#39;\ndf[&#39;food&#39;] = df[&#39;food&#39;].str.capitalize()\nprint(df)\nprint(&#39;---------------------------------------------&#39;)\n&#39;&#39;&#39;\næ‰¾åˆ°ç›¸åŒçš„é¡¹ï¼Œå¯¹æ•°æ®è¿›è¡Œåˆå¹¶\n1. é¦–å…ˆé’ˆå¯¹foodå¯¹dfè¿›è¡Œåˆ†ç»„ï¼Œå¹¶è¿›è¡Œæ•°æ®åˆå¹¶\n2. å¯¹åˆ†ç»„åçš„æ•°æ®è¿›è¡Œé‡æ–°DataFrameè½¬æ¢ï¼Œå½¢æˆæ–°çš„DataFrame\n3. å¯¹åŸæ¥çš„dataframeè¿›è¡Œå¤„ç†ï¼Œå»é‡+å»é™¤æ²¡æœ‰æ„ä¹‰çš„åˆ—\n4. ä¸¤ä¸ªdataframeåˆå¹¶\n&#39;&#39;&#39;\n#å¯¹æ•°æ®è¿›è¡Œåˆ†ç»„\ngroupbyObj = df.groupby(df[&#39;food&#39;]).sum()\nprint(groupbyObj)\nprint(&#39;---------------------------------------------&#39;)\n#å¯¹åˆ†ç»„åçš„æ•°æ®è¿›è¡ŒDataFrameåŒ–\nnew_df = groupbyObj.reset_index()\nprint(new_df)\nprint(&#39;---------------------------------------------&#39;)\n#å°†åŸæœ‰çš„æ•°æ®è¡¨è¿›è¡Œå»é‡,å¹¶åˆ é™¤ouncesåˆ—\ndf.drop_duplicates([&#39;food&#39;], inplace=True)\ndf = df.reindex(range(df.shape[0]), method = &#39;bfill&#39;)\ndf.drop(columns = [&#39;ounces&#39;], inplace = True)\nprint(df)\nprint(&#39;---------------------------------------------&#39;)\n#ä¸¤ä¸ªDataFrameåˆå¹¶\nresult = pd.merge(df, new_df, on = &#39;food&#39;)\nprint(result)\n\n#æ‰“å°\n#result.to_csv(r&#39;F:\\Work\\open_courses\\Data_Analysis_by_python\\clean_data\\foodInformation_new.csv&#39;)","like_count":0,"discussions":[{"author":{"id":1306094,"avatar":"https://static001.geekbang.org/account/avatar/00/13/ed/ee/c4779b67.jpg","nickname":"cy","note":"","ucode":"50D653399A31F6","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":463290,"discussion_content":"Good Job","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1577516450,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1308516,"avatar":"https://static001.geekbang.org/account/avatar/00/13/f7/64/03d8154f.jpg","nickname":"å¯ä¹æ³¡æ¸æ","note":"","ucode":"C709B781DF0456","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":8318,"discussion_content":"å¥½äººå‘ï¼Œ æˆ‘è¯»äº†å‰é¢å‡ æ¥¼githubé‡Œçš„æ•°æ®å ä¸€ç›´æ— æ³•é‡å‘½åã€‚ã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1567915685,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":119462,"user_name":"ç‹å¼ ","can_delete":false,"product_type":"c1","uid":1526391,"ip_address":"","ucode":"8153B5532B2C62","user_header":"https://static001.geekbang.org/account/avatar/00/17/4a/77/754a127b.jpg","comment_is_top":false,"comment_ctime":1564595211,"is_pvip":false,"replies":[{"id":63601,"content":"å¤šè°¢åˆ†äº«","user_name":"ä½œè€…å›å¤","user_name_real":"cy","uid":1306094,"ctime":1577520588,"ip_address":"","comment_id":119462,"utype":1}],"discussion_count":1,"race_medal":0,"score":5,"product_id":100021701,"comment_content":"#_*_ coding:utf-8 _*_\nimport pandas as pd\ndata = {&#39;ounces&#39;:[4.0,3.0,None,6.0,7.5,8.0,-3.0,5.0,6.0],&#39;animal&#39;:[&#39;pig&#39;,&#39;pig&#39;,&#39;pig&#39;,&#39;cow&#39;,&#39;cow&#39;,&#39;pig&#39;,&#39;cow&#39;,&#39;pig&#39;,&#39;salmon&#39;]}\ndf=pd.DataFrame(data,index=[&#39;bacon&#39;,&#39;pulled pork&#39;,&#39;bacon&#39;,&#39;Pastrami&#39;,&#39;corned beef&#39;,&#39;bacon&#39;,&#39;Pastrami&#39;,&#39;honey ham&#39;,&#39;nova lox&#39;],columns=[&#39;ounces&#39;,&#39;animal&#39;])\nprint(df)\ndf.to_excel(&#39;data1.xlsx&#39;)\n------------------------\nä½ ä»¬è¦çš„æ•°æ®","like_count":0,"discussions":[{"author":{"id":1306094,"avatar":"https://static001.geekbang.org/account/avatar/00/13/ed/ee/c4779b67.jpg","nickname":"cy","note":"","ucode":"50D653399A31F6","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":462212,"discussion_content":"Good Job","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1577518227,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":118924,"user_name":"å»ºå¼º","can_delete":false,"product_type":"c1","uid":1397126,"ip_address":"","ucode":"62B03D0E0C64EC","user_header":"https://static001.geekbang.org/account/avatar/00/15/51/86/b5fd8dd8.jpg","comment_is_top":false,"comment_ctime":1564470177,"is_pvip":false,"replies":[{"id":63610,"content":"Good Job","user_name":"ä½œè€…å›å¤","user_name_real":"cy","uid":1306094,"ctime":1577521036,"ip_address":"","comment_id":118924,"utype":1}],"discussion_count":1,"race_medal":0,"score":5,"product_id":100021701,"comment_content":"1.&quot;food&quot;åˆ—æ•°æ®å¤§å°å†™ä¸ç»Ÿä¸€ï¼Œæ¸…æ´—æ–¹æ³•ï¼šç»Ÿä¸€è½¬æ¢æˆå°å†™ã€‚\n2.&quot;ounces&quot;åˆ—æ•°æ®æœ‰ç¼ºå¤±å€¼ï¼Œç”¨å¹³å‡å€¼å¡«å……ã€‚\n3.&quot;ounces&quot;åˆ—æœ‰ä¸€è¡Œæ•°æ®æ˜¯-3ï¼Œä¸åˆç†æ•°æ®ï¼Œè½¬æ¢ä¸ºæ­£æ•°ã€‚\n4.&quot;food&quot;åˆ—ä¸­ï¼Œå€¼=&quot;bacon&quot;ã€&quot;pastrami&quot;çš„è¡Œæœ‰é‡å¤ï¼Œå¯è€ƒè™‘æŠŠè¿™äº›é‡å¤è¡Œè¿›è¡Œåˆå¹¶å¤„ç†ã€‚\n\nä»¥ä¸Šæ˜¯æˆ‘èƒ½å‘ç°çš„å‡ ç‚¹é—®é¢˜ï¼Œè¯·è€å¸ˆæŒ‡æ­£ã€‚","like_count":0,"discussions":[{"author":{"id":1306094,"avatar":"https://static001.geekbang.org/account/avatar/00/13/ed/ee/c4779b67.jpg","nickname":"cy","note":"","ucode":"50D653399A31F6","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":460665,"discussion_content":"Good Job","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1577521036,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":104481,"user_name":"TONY","can_delete":false,"product_type":"c1","uid":1068130,"ip_address":"","ucode":"632E2309166536","user_header":"","comment_is_top":false,"comment_ctime":1560763515,"is_pvip":false,"replies":[{"id":64092,"content":"Good Job","user_name":"ä½œè€…å›å¤","user_name_real":"cy","uid":1306094,"ctime":1577609159,"ip_address":"","comment_id":104481,"utype":1}],"discussion_count":1,"race_medal":0,"score":5,"product_id":100021701,"comment_content":"import pandas as pd\nimport numpy as np\ndf = pd.read_csv(&quot;.&#47;foods.csv&quot;)\ndf.columns = df.columns.str.strip() #å»æ‰åˆ—åç©ºæ ¼ï¼Œå¦åˆ™å½±å“åç»­å¯¹åˆ—çš„æ“ä½œï¼›\ndf[&#39;food&#39;] = df[&#39;food&#39;].str.strip() #å»æ‰foodåˆ—åç§°ç©ºæ ¼ï¼Œå¦åˆ™å½±å“å¯¹åç§°çš„æ“ä½œï¼›\ndf[&#39;food&#39;] = df[&#39;food&#39;].str.capitalize() # å¯¹foodåç§°é¦–å­—æ¯å¤§å†™\ndf[&#39;ounces&#39;] = df[&#39;ounces&#39;].apply(lambda a: abs(a)) #å¯¹ouncesåˆ—è´Ÿå€¼å–ç»å¯¹å€¼\ndf.fillna(df.mean(),inplace = True) #åœ¨å–ç»å¯¹å€¼åç”¨åˆ—å¹³å‡å€¼å¡«å……NaNå€¼\ndf\ndf.drop_duplicates(&#39;food&#39;,inplace = True)  #åˆ é™¤foodåˆ—é‡å¤æ•°æ®\ndf\ndf.to_csv(&#39;.&#47;foods.csv&#39;)  #å°†ç»“æœå†™å›csv\nprint(df)","like_count":0,"discussions":[{"author":{"id":1306094,"avatar":"https://static001.geekbang.org/account/avatar/00/13/ed/ee/c4779b67.jpg","nickname":"cy","note":"","ucode":"50D653399A31F6","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":454288,"discussion_content":"Good Job","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1577609159,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":92455,"user_name":"å¿˜çŸ¢","can_delete":false,"product_type":"c1","uid":1513551,"ip_address":"","ucode":"FAFD133BC2F6E4","user_header":"http://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTLVjETMtKViaoBEibZH2nS7jb4521k2ZsJHtkYnq4mglU8Jju6GiczexAZWpbXtQVico2c12JPSPaWpbA/132","comment_is_top":false,"comment_ctime":1557277107,"is_pvip":false,"replies":[{"id":64196,"content":"ä¹Ÿå¯ä»¥ï¼Œæœ‰4600ä¸‡æ¡æ•°æ®é‡ï¼Œä½ ä¹Ÿå¯ä»¥é‡‡ç”¨Pythonæ¥å¤„ç†ï¼Œå°±éœ€è¦ç”¨ä¸€äº›æ–¹æ³•äº†ï¼Œæ¯”å¦‚åˆ†chunkï¼ˆå—ï¼‰è¯»å–ï¼Œç„¶åæ“ä½œ","user_name":"ä½œè€…å›å¤","user_name_real":"cy","uid":1306094,"ctime":1577614056,"ip_address":"","comment_id":92455,"utype":1}],"discussion_count":1,"race_medal":0,"score":5,"product_id":100021701,"comment_content":"è¯·é—®è€å¸ˆï¼Œä¸Šäº¿æ¡è®°å½•çš„æ•°æ®é‡ä¹Ÿé€‚åˆç”¨Pythonæ¥ä½œæ¸…æ´—å—ï¼Ÿ","like_count":0,"discussions":[{"author":{"id":1306094,"avatar":"https://static001.geekbang.org/account/avatar/00/13/ed/ee/c4779b67.jpg","nickname":"cy","note":"","ucode":"50D653399A31F6","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":449267,"discussion_content":"ä¹Ÿå¯ä»¥ï¼Œæœ‰4600ä¸‡æ¡æ•°æ®é‡ï¼Œä½ ä¹Ÿå¯ä»¥é‡‡ç”¨Pythonæ¥å¤„ç†ï¼Œå°±éœ€è¦ç”¨ä¸€äº›æ–¹æ³•äº†ï¼Œæ¯”å¦‚åˆ†chunkï¼ˆå—ï¼‰è¯»å–ï¼Œç„¶åæ“ä½œ","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1577614056,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":90242,"user_name":"å†¯å¾·ç« ","can_delete":false,"product_type":"c1","uid":1184025,"ip_address":"","ucode":"EF2343BE787C82","user_header":"https://static001.geekbang.org/account/avatar/00/12/11/19/6e0c5c9e.jpg","comment_is_top":false,"comment_ctime":1556457716,"is_pvip":false,"replies":[{"id":64209,"content":"æ€»ç»“ä¸é”™","user_name":"ä½œè€…å›å¤","user_name_real":"cy","uid":1306094,"ctime":1577614249,"ip_address":"","comment_id":90242,"utype":1}],"discussion_count":1,"race_medal":0,"score":5,"product_id":100021701,"comment_content":"1.æ•°æ®æ¸…æ´—æ˜¯æ•°æ®åˆ†æçš„åŸºç¡€ï¼Œæ•°æ®å‡†ç¡®æ€§å†³å®šç»“æœå‡†ç¡®æ€§ã€‚\n\n2.æ•°æ®æ¸…æ´—å æ•°æ®æŒ–æ˜å·¥ä½œé‡80ï¼Œ\n\n3.æ•°æ®æ¸…æ´—ï¼Œå®Œå…¨åˆä¸€åŸåˆ™ã€‚\nå®Œæ•´æ€§ï¼Œç¡®ä¿æ²¡æœ‰ç©ºå€¼ã€‚\nå…¨é¢æ€§ï¼Œç¡®è®¤å•ä½ï¼Œæ•°æ®è´¨é‡\nåˆæ³•æ€§ï¼Œæ•°æ®æ˜¯å¦éµä»è‡ªç„¶è§„å¾‹ã€‚\nå”¯ä¸€æ€§ï¼Œå»é™¤é‡å¤æ•°æ®ã€‚\n4.æ•°æ®ç»“æœæ£€æ ¸ä¹ æƒ¯ã€‚","like_count":0,"discussions":[{"author":{"id":1306094,"avatar":"https://static001.geekbang.org/account/avatar/00/13/ed/ee/c4779b67.jpg","nickname":"cy","note":"","ucode":"50D653399A31F6","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":448437,"discussion_content":"æ€»ç»“ä¸é”™","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1577614249,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":85661,"user_name":"é’çŸ³","can_delete":false,"product_type":"c1","uid":1215531,"ip_address":"","ucode":"B0056AD6453322","user_header":"https://static001.geekbang.org/account/avatar/00/12/8c/2b/3ab96998.jpg","comment_is_top":false,"comment_ctime":1555165683,"is_pvip":false,"replies":[{"id":64264,"content":"Good Job","user_name":"ä½œè€…å›å¤","user_name_real":"cy","uid":1306094,"ctime":1577615664,"ip_address":"","comment_id":85661,"utype":1}],"discussion_count":1,"race_medal":0,"score":5,"product_id":100021701,"comment_content":"#!usr&#47;bin&#47;python3\n# -*- coding:utf-8 -*-\n\nimport os\nimport numpy as np\nimport pandas as pd\n\n\npath = &#39;&#47;Users&#47;albert.ming.xu&#47;Downloads&#47;11.data.xlsx&#39;\nnew_path = os.path.splitext(path)[0] + &#39;_new&#39; + os.path.splitext(path)[1]\ndata_type = {&#39;food&#39;: np.str, &#39;ounces&#39;: np.float, &#39;animal&#39;: np.str}\n\ndf = pd.read_excel(path, sheet_name=0, header=0, dtype=data_type)\n\n# ç»Ÿä¸€foodåç§°ä¸ºå°å†™å­—æ¯\ndf[&#39;food&#39;] = df[&#39;food&#39;].str.lower()\n# å•ä½å–ç»å¯¹å€¼\ndf[&#39;ounces&#39;] = df[&#39;ounces&#39;].abs()\n# å°†ouncesåˆ—çš„ç©ºè¡Œå¡«å……ä¸ºå¹³å‡å€¼\ndf[&#39;ounces&#39;].fillna(df[&#39;ounces&#39;].mean(), inplace=True)\n# åˆ é™¤ä»»æ„å­—æ®µåŒ…å«ç©ºå€¼çš„æ•°æ®\ndf.dropna(how=&#39;any&#39;, axis=0, inplace=True)\n# åˆ é™¤foodå­—æ®µå‡ºç°é‡å¤çš„è¡Œï¼Œä½†baconæœ€åä¼šå­˜åœ¨ä¸‰è¡Œæ•°æ®ï¼Œouncesåˆ†åˆ«æ˜¯4.0ã€5.31ã€8.0ï¼Œæœ€åä¿ç•™å“ªä¸ªæ•°æ®æ›´å¥½æ˜¯ä¸ªé—®é¢˜\ndf.drop_duplicates(&#39;food&#39;, inplace=True)\n\ndf.to_excel(new_path, float_format=&quot;%.2f&quot;)\n","like_count":0,"discussions":[{"author":{"id":1306094,"avatar":"https://static001.geekbang.org/account/avatar/00/13/ed/ee/c4779b67.jpg","nickname":"cy","note":"","ucode":"50D653399A31F6","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":446756,"discussion_content":"Good Job","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1577615664,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":85072,"user_name":"æ»¢","can_delete":false,"product_type":"c1","uid":1221511,"ip_address":"","ucode":"971A6F20AF3F9A","user_header":"https://static001.geekbang.org/account/avatar/00/12/a3/87/c415e370.jpg","comment_is_top":false,"comment_ctime":1554971253,"is_pvip":false,"replies":[{"id":64270,"content":"Good Job","user_name":"ä½œè€…å›å¤","user_name_real":"cy","uid":1306094,"ctime":1577615774,"ip_address":"","comment_id":85072,"utype":1}],"discussion_count":1,"race_medal":0,"score":5,"product_id":100021701,"comment_content":"å½•å…¥çš„åŸå§‹æ•°æ®é“¾æ¥ï¼š\nå…³äºç»ƒä¹ ï¼šé¦–å…ˆæŠŠè¿™ä»½æ•°æ®å½“åšé£Ÿææ¶ˆè€—ï¼Œå•ä½ä¸ºç›å¸ï¼ˆå½“ç„¶å¯¹ä¸šåŠ¡çš„ç†è§£æœ‰å¤šç§ï¼‰ã€‚ ï¼ˆ1ï¼‰å¯¹äºè¿™ä»½æ•°æ®NaNå€¼åº”è¯¥åˆ é™¤ï¼Œä¸èƒ½è¿›è¡Œè¡¥å…¨ï¼›ï¼ˆ2ï¼‰å¦‚æœæ˜¯é£Ÿææ¶ˆè€—ï¼Œè´Ÿæ•°çš„å­˜åœ¨ä¹Ÿæ˜¯åˆç†çš„ï¼Œä¸ç”¨å¯¹é½æ±‚ç»å¯¹å€¼ï¼ˆ3ï¼‰é‡å¤çš„åŸå§‹æ•°æ®ä¸èƒ½åˆ é™¤ï¼Œåº”è¯¥æ˜¯æ±‡æ€»åå†è¿›è¡Œåˆ é™¤ï¼Œä»¥ä¸‹æ˜¯ä»£ç ï¼ŒPython3.6 IDLE \n&gt;&gt;&gt; import pandas as pd\n&gt;&gt;&gt; from pandas import Series,DataFrame\n&gt;&gt;&gt; df = DataFrame(pd.read_excel(&#39;&#47;Users&#47;apple&#47;Desktop&#47;GitHubProject&#47;Read mark&#47;æ•°æ®åˆ†æ&#47;geekTime&#47;data&#47;foodInformation.xlsx&#39;))\n&gt;&gt;&gt; print (df)\n          food  ounces  animal\n0        bacon     4.0     pig\n1  pulled port     3.0     pig\n2        bacon     NaN     pig\n3     Pastrami     6.0     cow\n4  corned beef     7.5     cow\n5        Bacon     8.0     pig\n6     pastrami    -3.0     cow\n7    honey ham     5.0     pig\n8     nova lox     6.0  salmon\n#åˆ é™¤ç©ºå€¼\n&gt;&gt;&gt; df.dropna(inplace=True)\n#foodä¸€æ å…¨éƒ¨æ¢æˆå°å†™\n&gt;&gt;&gt; df[&#39;food&#39;]=df[&#39;food&#39;].str.lower()\n #æŸ¥æ‰¾foodé‡å¤è®°å½•ï¼Œåˆ†ç»„æ±‚å…¶æ€»å’Œ\n&gt;&gt;&gt; food_rows = df[df[&#39;food&#39;].duplicated(keep=False)]\n&gt;&gt;&gt; food_items=food_rows.groupby(&#39;food&#39;).sum()\n&gt;&gt;&gt; food_items[&#39;food&#39;]=food_items.index\n#æ•°æ®èµ‹å€¼æ›¿æ¢\n&gt;&gt;&gt; for i,row in food_items.iterrows():\n\tdf.loc[df[&#39;food&#39;]==row[&#39;food&#39;],&#39;ounces&#39;]=row[&#39;ounces&#39;]\n#åˆ é™¤é‡å¤\n&gt;&gt;&gt; df.drop_duplicates(inplace=True)\n#é‡æ–°ç”Ÿæˆç´¢å¼•\n&gt;&gt;&gt; df.index=range(df.shape[0])\n&gt;&gt;&gt; print (df)\n          food  ounces  animal\n0        bacon    12.0     pig\n1  pulled port     3.0     pig\n2     pastrami     3.0     cow\n3  corned beef     7.5     cow\n4    honey ham     5.0     pig\n5     nova lox     6.0  salmon\n","like_count":0,"discussions":[{"author":{"id":1306094,"avatar":"https://static001.geekbang.org/account/avatar/00/13/ed/ee/c4779b67.jpg","nickname":"cy","note":"","ucode":"50D653399A31F6","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":446756,"discussion_content":"Good Job","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1577615664,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":84023,"user_name":"FeiFei","can_delete":false,"product_type":"c1","uid":1045586,"ip_address":"","ucode":"01CD655DD4E56C","user_header":"https://static001.geekbang.org/account/avatar/00/0f/f4/52/10c4d863.jpg","comment_is_top":false,"comment_ctime":1554770580,"is_pvip":false,"replies":[{"id":64288,"content":"å“ˆå“ˆå“ˆ å¾ˆå¥½çš„åˆ†äº«","user_name":"ä½œè€…å›å¤","user_name_real":"cy","uid":1306094,"ctime":1577616120,"ip_address":"","comment_id":84023,"utype":1}],"discussion_count":1,"race_medal":0,"score":5,"product_id":100021701,"comment_content":"80ï¼…æ—¶é—´éœ€è¦åœ¨æ•°æ®æ¸…æ´—ä¸Šã€‚\næ‹…å¿ƒå…¬å¸ä¸èƒ½ç»™äºˆé‚£ä¹ˆå¤šæ—¶é—´æ¥åšè¿™ä»¶äº‹ã€‚","like_count":0,"discussions":[{"author":{"id":1306094,"avatar":"https://static001.geekbang.org/account/avatar/00/13/ed/ee/c4779b67.jpg","nickname":"cy","note":"","ucode":"50D653399A31F6","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":446547,"discussion_content":"Good Job","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1577615774,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":78367,"user_name":"ã€G YaQiã€","can_delete":false,"product_type":"c1","uid":1461694,"ip_address":"","ucode":"D378F0C8D0EFD0","user_header":"https://static001.geekbang.org/account/avatar/00/16/4d/be/c04c9eac.jpg","comment_is_top":false,"comment_ctime":1553133810,"is_pvip":false,"replies":[{"id":64389,"content":"Good Job","user_name":"ä½œè€…å›å¤","user_name_real":"cy","uid":1306094,"ctime":1577618204,"ip_address":"","comment_id":78367,"utype":1}],"discussion_count":1,"race_medal":0,"score":6,"product_id":100021701,"comment_content":"import pandas as pd\nfrom pandas import Series, DataFrame\n\n# è¯»å…¥æ•°æ®\ndata = DataFrame(pd.read_excel(&#39;C:\\\\Users\\\\Administrator\\\\Desktop\\\\food.xlsx&#39;))\n\n# åˆ é™¤å¼‚å¸¸å€¼æ‰€åœ¨è¡Œ\nrst = data[data[&#39;ounces&#39;] &lt; 0].index.tolist()\ndata.drop(index=rst, inplace=True)\n\n# é£Ÿç‰©åå­—å°å†™\ndata[&#39;food&#39;] = data[&#39;food&#39;].str.lower()\n\n# ä»¥å‡å€¼å¡«å……ç©ºå€¼\ndata[&#39;ounces&#39;].fillna(int(data[&#39;ounces&#39;].mean()), inplace=True)\n\n# é‡ç½®ç´¢å¼•\ndata = data.reset_index(drop=True)\n\nprint(data)","like_count":0},{"had_liked":false,"id":71434,"user_name":"ç‹","can_delete":false,"product_type":"c1","uid":1084336,"ip_address":"","ucode":"44A968CB371704","user_header":"https://static001.geekbang.org/account/avatar/00/10/8b/b0/38aadfa0.jpg","comment_is_top":false,"comment_ctime":1551342311,"is_pvip":false,"replies":[{"id":64490,"content":"ä¸€ä¸ªå«ä¹‰","user_name":"ä½œè€…å›å¤","user_name_real":"cy","uid":1306094,"ctime":1577620009,"ip_address":"","comment_id":71434,"utype":1}],"discussion_count":1,"race_medal":0,"score":6,"product_id":100021701,"comment_content":"ç¬¬ä¸‰ä¸ªè§„åˆ™ï¼Œåˆå€¼å¾—æ˜¯åˆç†æ€§è¿˜æ˜¯åˆæ³•æ€§å‘¢ï¼Ÿ","like_count":0,"discussions":[{"author":{"id":1306094,"avatar":"https://static001.geekbang.org/account/avatar/00/13/ed/ee/c4779b67.jpg","nickname":"cy","note":"","ucode":"50D653399A31F6","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":444067,"discussion_content":"Good Job","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1577618204,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":64508,"user_name":"æ–¹äººå…¶","can_delete":false,"product_type":"c1","uid":1197200,"ip_address":"","ucode":"CF44EBC59493E1","user_header":"https://static001.geekbang.org/account/avatar/00/12/44/90/33ec20bf.jpg","comment_is_top":false,"comment_ctime":1548813595,"is_pvip":false,"replies":[{"id":64627,"content":"åƒä¸‡çº§åˆ«æ˜¯å¯ä»¥çš„ï¼Œå‰ææ˜¯ä½ å¯ä»¥é‡‡ç”¨åˆ†å—çš„æ–¹å¼æ¥æ“ä½œï¼Œchunksize","user_name":"ä½œè€…å›å¤","user_name_real":"cy","uid":1306094,"ctime":1577622649,"ip_address":"","comment_id":64508,"utype":1}],"discussion_count":1,"race_medal":0,"score":6,"product_id":100021701,"comment_content":"pandasé€‚åˆå¤šå¤§çš„æ•°æ®é‡æ¸…æ´—ï¼Ÿåä¸‡çº§åˆ«ï¼Ÿç™¾ä¸‡çº§åˆ«?åƒä¸‡çº§åˆ«ï¼Ÿäº¿çº§åˆ«ï¼Ÿï¼Ÿ","like_count":0,"discussions":[{"author":{"id":1306094,"avatar":"https://static001.geekbang.org/account/avatar/00/13/ed/ee/c4779b67.jpg","nickname":"cy","note":"","ucode":"50D653399A31F6","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":441146,"discussion_content":"ä¸€ä¸ªå«ä¹‰","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1577620009,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":61870,"user_name":"ææ²›æ¬£","can_delete":false,"product_type":"c1","uid":1362695,"ip_address":"","ucode":"98874954230D95","user_header":"https://static001.geekbang.org/account/avatar/00/14/cb/07/e34220d6.jpg","comment_is_top":false,"comment_ctime":1547824257,"is_pvip":false,"replies":[{"id":64694,"content":"åŠ æ²¹~ï¼","user_name":"ä½œè€…å›å¤","user_name_real":"cy","uid":1306094,"ctime":1577624346,"ip_address":"","comment_id":61870,"utype":1}],"discussion_count":1,"race_medal":0,"score":6,"product_id":100021701,"comment_content":"å®Œæ•´æ€§ï¼Œå…¨é¢æ€§ï¼Œåˆç†æ€§ï¼Œä¸€è‡´æ€§ã€‚\n\nç°å®ä¸–ç•Œçš„æ•°æ®æ˜¯è‚®è„çš„ï¼Œéœ€è¦æˆ‘ä»¬æŠŠå®ƒä»¬æ¸…æ´—å¹²å‡€ã€‚\n\né™¤äº†ç®€å•çš„å¤„ç†å¤–ï¼Œè¿˜å¯ä»¥ç”¨pandasã€‚\n\nå‘¨æœ«å¯ä»¥é”®ç›˜æ•²èµ·æ¥äº†ã€‚","like_count":0,"discussions":[{"author":{"id":1306094,"avatar":"https://static001.geekbang.org/account/avatar/00/13/ed/ee/c4779b67.jpg","nickname":"cy","note":"","ucode":"50D653399A31F6","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":438036,"discussion_content":"åƒä¸‡çº§åˆ«æ˜¯å¯ä»¥çš„ï¼Œå‰ææ˜¯ä½ å¯ä»¥é‡‡ç”¨åˆ†å—çš„æ–¹å¼æ¥æ“ä½œï¼Œchunksize","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1577622649,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":61458,"user_name":"LI.T.F","can_delete":false,"product_type":"c1","uid":1357691,"ip_address":"","ucode":"DDC0AB13CA605F","user_header":"https://static001.geekbang.org/account/avatar/00/14/b7/7b/0893dbd9.jpg","comment_is_top":false,"comment_ctime":1547702227,"is_pvip":false,"replies":[{"id":64710,"content":"Good Job~","user_name":"ä½œè€…å›å¤","user_name_real":"cy","uid":1306094,"ctime":1577624564,"ip_address":"","comment_id":61458,"utype":1}],"discussion_count":1,"race_medal":0,"score":6,"product_id":100021701,"comment_content":"åªå‘ç°äº†ä¸‰ç‚¹é”™è¯¯ï¼š\n1.é£Ÿç‰©åç§°æœ‰çš„é¦–å­—æ¯å¤§å†™ï¼Œæœ‰çš„æ²¡æœ‰å¤§å†™\n2.ç›…å¸è¿™ä¸€åˆ—ä¸­æœ‰NAN\n3.ç›…å¸åˆ—æœ‰è´Ÿæ•°\n\næ•°æ®æ¸…ç†ï¼š\n1.é£Ÿç‰©åˆ—é¦–å­—æ¯å¤§å†™\n2.ç›…å¸åˆ—ç”¨å¹³å‡æ•°ä»£æ›¿NAN\n3.ç›…å¸åˆ—çš„è´Ÿæ•°å˜æˆæ­£æ•°","like_count":0,"discussions":[{"author":{"id":1306094,"avatar":"https://static001.geekbang.org/account/avatar/00/13/ed/ee/c4779b67.jpg","nickname":"cy","note":"","ucode":"50D653399A31F6","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":437023,"discussion_content":"åŠ æ²¹~ï¼","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1577624346,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":60972,"user_name":"Neo","can_delete":false,"product_type":"c1","uid":1090494,"ip_address":"","ucode":"44B46DEA4EC71F","user_header":"https://static001.geekbang.org/account/avatar/00/10/a3/be/31086596.jpg","comment_is_top":false,"comment_ctime":1547599919,"is_pvip":false,"replies":[{"id":64730,"content":"Pythonä¹Ÿå¯ä»¥å¤„ç†å¤§é‡çš„æ•°æ®ï¼Œé€‰æ‹©Pythonæ˜¯å› ä¸ºç”¨çš„äººå¤šï¼Œè€Œä¸”å·¥å…·åŒ…å®Œå–„ï¼Œèµ°å‰äººèµ°çš„è·¯ï¼Œä¸éœ€è¦é‡å¤é€ è½®å­","user_name":"ä½œè€…å›å¤","user_name_real":"cy","uid":1306094,"ctime":1577624840,"ip_address":"","comment_id":60972,"utype":1}],"discussion_count":1,"race_medal":0,"score":6,"product_id":100021701,"comment_content":"ä½¿ç”¨pyåšæ•°æ®æ¸…æ´—ï¼Œæ•°æ®é‡å¤§å°æœ‰é™åˆ¶å—ï¼Ÿtbçº§ä¹Ÿæ˜¯å…¨éƒ¨åŠ è½½åˆ°å†…å­˜ä¸­å¤„ç†ï¼Ÿè¿˜æ˜¯ä½¿ç”¨å¤§æ•°æ®æŠ€æœ¯ï¼Ÿé€‰æ‹©ä½¿ç”¨pyæ˜¯å› ä¸ºä»–æœ‰æ•°æ®å¤„ç†çš„åº“ï¼Œå¹¶ä¸”æ˜¯æ–¹ä¾¿å¤„ç†å°‘é‡æ•°æ®çš„å·¥å…·ï¼Œæ˜¯å—ï¼Ÿ","like_count":0,"discussions":[{"author":{"id":1306094,"avatar":"https://static001.geekbang.org/account/avatar/00/13/ed/ee/c4779b67.jpg","nickname":"cy","note":"","ucode":"50D653399A31F6","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":436876,"discussion_content":"Good Job~","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1577624564,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":60595,"user_name":"lee4","can_delete":false,"product_type":"c1","uid":1021495,"ip_address":"","ucode":"36F82406C58075","user_header":"https://static001.geekbang.org/account/avatar/00/0f/96/37/abb7bfe3.jpg","comment_is_top":false,"comment_ctime":1547517423,"is_pvip":false,"replies":[{"id":64737,"content":"Good Job","user_name":"ä½œè€…å›å¤","user_name_real":"cy","uid":1306094,"ctime":1577624921,"ip_address":"","comment_id":60595,"utype":1}],"discussion_count":1,"race_medal":0,"score":6,"product_id":100021701,"comment_content":"é‡ç‚¹è¿˜è¦çœ‹æ•°æ®ä½¿ç”¨çš„åœºæ™¯å’Œç›®çš„ã€‚\næ ¹æ®ç°æœ‰ä¿¡æ¯ï¼Œæœ‰å¯èƒ½é‡‡å–ä»¥ä¸‹è¡ŒåŠ¨ï¼š\n\n1. å°†foodä¸€åˆ—å†…å®¹å†™æ³•ç»Ÿä¸€ï¼Œä¾‹å¦‚å¤§å°å†™\n2. foodä¸€åˆ—ä¸å®œå»é‡ï¼Œå¯èƒ½éœ€è¦å¦è¡Œå»ºç«‹index\n3. ouncesä¸€åˆ—å°†Nanå»é™¤ï¼Œæˆ–å¡«å……ä¸º0 å¹¶å¦è¡Œå»ºç«‹indicatoræ ‡è¯†æ•°æ®ç¼ºå¤±\n4. ouncesä¸€åˆ—å°†è´Ÿå€¼å»é™¤ï¼Œæˆ–å–ç»å¯¹å€¼\n5. animalä¸€åˆ—å¯ä»¥è€ƒè™‘å°†åˆ†ç±»è½¬æ¢ä¸ºæ•°å€¼å‹indicator","like_count":0,"discussions":[{"author":{"id":1306094,"avatar":"https://static001.geekbang.org/account/avatar/00/13/ed/ee/c4779b67.jpg","nickname":"cy","note":"","ucode":"50D653399A31F6","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":436689,"discussion_content":"Pythonä¹Ÿå¯ä»¥å¤„ç†å¤§é‡çš„æ•°æ®ï¼Œé€‰æ‹©Pythonæ˜¯å› ä¸ºç”¨çš„äººå¤šï¼Œè€Œä¸”å·¥å…·åŒ…å®Œå–„ï¼Œèµ°å‰äººèµ°çš„è·¯ï¼Œä¸éœ€è¦é‡å¤é€ è½®å­","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1577624840,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":57473,"user_name":"Hot   Heat","can_delete":false,"product_type":"c1","uid":1235964,"ip_address":"","ucode":"EF8E2ADEB29BEA","user_header":"https://static001.geekbang.org/account/avatar/00/12/db/fc/8ddeaccb.jpg","comment_is_top":false,"comment_ctime":1546819915,"is_pvip":false,"replies":null,"discussion_count":0,"race_medal":0,"score":6,"product_id":100021701,"comment_content":"å¯ä»¥ç»™ä¸ªæ ·ä¾‹æ•°æ®çš„é“¾æ¥å—ï¼Ÿè‡ªå·±åŠ¨æ‰‹æ“ä½œä¸€ä¸‹","like_count":20},{"had_liked":false,"id":64299,"user_name":"çˆ±åšæ¢¦çš„å’¸é±¼","can_delete":false,"product_type":"c1","uid":1051256,"ip_address":"","ucode":"9D9642CF0752BB","user_header":"","comment_is_top":false,"comment_ctime":1548738106,"is_pvip":false,"replies":null,"discussion_count":0,"race_medal":0,"score":6,"product_id":100021701,"comment_content":"å»ºè®®è€å¸ˆæ¶‰åŠåˆ°æ•°æ®é›†ç»ƒä¹ çš„å¯ä»¥æŠŠæ•°æ®æ”¾åœ¨githubä¸Šï¼Œæ–¹ä¾¿æˆ‘ä»¬åšåŒæ­¥ç»ƒä¹ ã€‚","like_count":12},{"had_liked":false,"id":57568,"user_name":"auroroa","can_delete":false,"product_type":"c1","uid":1057164,"ip_address":"","ucode":"0FF44C9A40E8CD","user_header":"https://static001.geekbang.org/account/avatar/00/10/21/8c/f7a24bc5.jpg","comment_is_top":false,"comment_ctime":1546839199,"is_pvip":false,"replies":null,"discussion_count":0,"race_medal":0,"score":6,"product_id":100021701,"comment_content":"æœ€å¤§çš„é—®é¢˜æ˜¯ä¸æ˜¯æ²¡æŠŠæ•°æ®çš„æ¥æºå’Œç›®çš„æè¿°æ¸…æ¥šï¼ŸğŸ˜„","like_count":12,"discussions":[{"author":{"id":1306094,"avatar":"https://static001.geekbang.org/account/avatar/00/13/ed/ee/c4779b67.jpg","nickname":"cy","note":"","ucode":"50D653399A31F6","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":436555,"discussion_content":"Good Job","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1577624921,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":78367,"user_name":"ã€G YaQiã€","can_delete":false,"product_type":"c1","uid":1461694,"ip_address":"","ucode":"D378F0C8D0EFD0","user_header":"https://static001.geekbang.org/account/avatar/00/16/4d/be/c04c9eac.jpg","comment_is_top":false,"comment_ctime":1553133810,"is_pvip":false,"replies":[{"id":64389,"content":"Good Job","user_name":"ä½œè€…å›å¤","user_name_real":"cy","uid":1306094,"ctime":1577618204,"ip_address":"","comment_id":78367,"utype":1}],"discussion_count":1,"race_medal":0,"score":6,"product_id":100021701,"comment_content":"import pandas as pd\nfrom pandas import Series, DataFrame\n\n# è¯»å…¥æ•°æ®\ndata = DataFrame(pd.read_excel(&#39;C:\\\\Users\\\\Administrator\\\\Desktop\\\\food.xlsx&#39;))\n\n# åˆ é™¤å¼‚å¸¸å€¼æ‰€åœ¨è¡Œ\nrst = data[data[&#39;ounces&#39;] &lt; 0].index.tolist()\ndata.drop(index=rst, inplace=True)\n\n# é£Ÿç‰©åå­—å°å†™\ndata[&#39;food&#39;] = data[&#39;food&#39;].str.lower()\n\n# ä»¥å‡å€¼å¡«å……ç©ºå€¼\ndata[&#39;ounces&#39;].fillna(int(data[&#39;ounces&#39;].mean()), inplace=True)\n\n# é‡ç½®ç´¢å¼•\ndata = data.reset_index(drop=True)\n\nprint(data)","like_count":0,"discussions":[{"author":{"id":1306094,"avatar":"https://static001.geekbang.org/account/avatar/00/13/ed/ee/c4779b67.jpg","nickname":"cy","note":"","ucode":"50D653399A31F6","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":444067,"discussion_content":"Good Job","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1577618204,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":71434,"user_name":"ç‹","can_delete":false,"product_type":"c1","uid":1084336,"ip_address":"","ucode":"44A968CB371704","user_header":"https://static001.geekbang.org/account/avatar/00/10/8b/b0/38aadfa0.jpg","comment_is_top":false,"comment_ctime":1551342311,"is_pvip":false,"replies":[{"id":64490,"content":"ä¸€ä¸ªå«ä¹‰","user_name":"ä½œè€…å›å¤","user_name_real":"cy","uid":1306094,"ctime":1577620009,"ip_address":"","comment_id":71434,"utype":1}],"discussion_count":1,"race_medal":0,"score":6,"product_id":100021701,"comment_content":"ç¬¬ä¸‰ä¸ªè§„åˆ™ï¼Œåˆå€¼å¾—æ˜¯åˆç†æ€§è¿˜æ˜¯åˆæ³•æ€§å‘¢ï¼Ÿ","like_count":0,"discussions":[{"author":{"id":1306094,"avatar":"https://static001.geekbang.org/account/avatar/00/13/ed/ee/c4779b67.jpg","nickname":"cy","note":"","ucode":"50D653399A31F6","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":441146,"discussion_content":"ä¸€ä¸ªå«ä¹‰","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1577620009,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":64508,"user_name":"æ–¹äººå…¶","can_delete":false,"product_type":"c1","uid":1197200,"ip_address":"","ucode":"CF44EBC59493E1","user_header":"https://static001.geekbang.org/account/avatar/00/12/44/90/33ec20bf.jpg","comment_is_top":false,"comment_ctime":1548813595,"is_pvip":false,"replies":[{"id":64627,"content":"åƒä¸‡çº§åˆ«æ˜¯å¯ä»¥çš„ï¼Œå‰ææ˜¯ä½ å¯ä»¥é‡‡ç”¨åˆ†å—çš„æ–¹å¼æ¥æ“ä½œï¼Œchunksize","user_name":"ä½œè€…å›å¤","user_name_real":"cy","uid":1306094,"ctime":1577622649,"ip_address":"","comment_id":64508,"utype":1}],"discussion_count":1,"race_medal":0,"score":6,"product_id":100021701,"comment_content":"pandasé€‚åˆå¤šå¤§çš„æ•°æ®é‡æ¸…æ´—ï¼Ÿåä¸‡çº§åˆ«ï¼Ÿç™¾ä¸‡çº§åˆ«?åƒä¸‡çº§åˆ«ï¼Ÿäº¿çº§åˆ«ï¼Ÿï¼Ÿ","like_count":0,"discussions":[{"author":{"id":1306094,"avatar":"https://static001.geekbang.org/account/avatar/00/13/ed/ee/c4779b67.jpg","nickname":"cy","note":"","ucode":"50D653399A31F6","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":438036,"discussion_content":"åƒä¸‡çº§åˆ«æ˜¯å¯ä»¥çš„ï¼Œå‰ææ˜¯ä½ å¯ä»¥é‡‡ç”¨åˆ†å—çš„æ–¹å¼æ¥æ“ä½œï¼Œchunksize","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1577622649,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":61870,"user_name":"ææ²›æ¬£","can_delete":false,"product_type":"c1","uid":1362695,"ip_address":"","ucode":"98874954230D95","user_header":"https://static001.geekbang.org/account/avatar/00/14/cb/07/e34220d6.jpg","comment_is_top":false,"comment_ctime":1547824257,"is_pvip":false,"replies":[{"id":64694,"content":"åŠ æ²¹~ï¼","user_name":"ä½œè€…å›å¤","user_name_real":"cy","uid":1306094,"ctime":1577624346,"ip_address":"","comment_id":61870,"utype":1}],"discussion_count":1,"race_medal":0,"score":6,"product_id":100021701,"comment_content":"å®Œæ•´æ€§ï¼Œå…¨é¢æ€§ï¼Œåˆç†æ€§ï¼Œä¸€è‡´æ€§ã€‚\n\nç°å®ä¸–ç•Œçš„æ•°æ®æ˜¯è‚®è„çš„ï¼Œéœ€è¦æˆ‘ä»¬æŠŠå®ƒä»¬æ¸…æ´—å¹²å‡€ã€‚\n\né™¤äº†ç®€å•çš„å¤„ç†å¤–ï¼Œè¿˜å¯ä»¥ç”¨pandasã€‚\n\nå‘¨æœ«å¯ä»¥é”®ç›˜æ•²èµ·æ¥äº†ã€‚","like_count":0,"discussions":[{"author":{"id":1306094,"avatar":"https://static001.geekbang.org/account/avatar/00/13/ed/ee/c4779b67.jpg","nickname":"cy","note":"","ucode":"50D653399A31F6","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":437023,"discussion_content":"åŠ æ²¹~ï¼","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1577624346,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":61458,"user_name":"LI.T.F","can_delete":false,"product_type":"c1","uid":1357691,"ip_address":"","ucode":"DDC0AB13CA605F","user_header":"https://static001.geekbang.org/account/avatar/00/14/b7/7b/0893dbd9.jpg","comment_is_top":false,"comment_ctime":1547702227,"is_pvip":false,"replies":[{"id":64710,"content":"Good Job~","user_name":"ä½œè€…å›å¤","user_name_real":"cy","uid":1306094,"ctime":1577624564,"ip_address":"","comment_id":61458,"utype":1}],"discussion_count":1,"race_medal":0,"score":6,"product_id":100021701,"comment_content":"åªå‘ç°äº†ä¸‰ç‚¹é”™è¯¯ï¼š\n1.é£Ÿç‰©åç§°æœ‰çš„é¦–å­—æ¯å¤§å†™ï¼Œæœ‰çš„æ²¡æœ‰å¤§å†™\n2.ç›…å¸è¿™ä¸€åˆ—ä¸­æœ‰NAN\n3.ç›…å¸åˆ—æœ‰è´Ÿæ•°\n\næ•°æ®æ¸…ç†ï¼š\n1.é£Ÿç‰©åˆ—é¦–å­—æ¯å¤§å†™\n2.ç›…å¸åˆ—ç”¨å¹³å‡æ•°ä»£æ›¿NAN\n3.ç›…å¸åˆ—çš„è´Ÿæ•°å˜æˆæ­£æ•°","like_count":0,"discussions":[{"author":{"id":1306094,"avatar":"https://static001.geekbang.org/account/avatar/00/13/ed/ee/c4779b67.jpg","nickname":"cy","note":"","ucode":"50D653399A31F6","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":436876,"discussion_content":"Good Job~","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1577624564,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":60972,"user_name":"Neo","can_delete":false,"product_type":"c1","uid":1090494,"ip_address":"","ucode":"44B46DEA4EC71F","user_header":"https://static001.geekbang.org/account/avatar/00/10/a3/be/31086596.jpg","comment_is_top":false,"comment_ctime":1547599919,"is_pvip":false,"replies":[{"id":64730,"content":"Pythonä¹Ÿå¯ä»¥å¤„ç†å¤§é‡çš„æ•°æ®ï¼Œé€‰æ‹©Pythonæ˜¯å› ä¸ºç”¨çš„äººå¤šï¼Œè€Œä¸”å·¥å…·åŒ…å®Œå–„ï¼Œèµ°å‰äººèµ°çš„è·¯ï¼Œä¸éœ€è¦é‡å¤é€ è½®å­","user_name":"ä½œè€…å›å¤","user_name_real":"cy","uid":1306094,"ctime":1577624840,"ip_address":"","comment_id":60972,"utype":1}],"discussion_count":1,"race_medal":0,"score":6,"product_id":100021701,"comment_content":"ä½¿ç”¨pyåšæ•°æ®æ¸…æ´—ï¼Œæ•°æ®é‡å¤§å°æœ‰é™åˆ¶å—ï¼Ÿtbçº§ä¹Ÿæ˜¯å…¨éƒ¨åŠ è½½åˆ°å†…å­˜ä¸­å¤„ç†ï¼Ÿè¿˜æ˜¯ä½¿ç”¨å¤§æ•°æ®æŠ€æœ¯ï¼Ÿé€‰æ‹©ä½¿ç”¨pyæ˜¯å› ä¸ºä»–æœ‰æ•°æ®å¤„ç†çš„åº“ï¼Œå¹¶ä¸”æ˜¯æ–¹ä¾¿å¤„ç†å°‘é‡æ•°æ®çš„å·¥å…·ï¼Œæ˜¯å—ï¼Ÿ","like_count":0,"discussions":[{"author":{"id":1306094,"avatar":"https://static001.geekbang.org/account/avatar/00/13/ed/ee/c4779b67.jpg","nickname":"cy","note":"","ucode":"50D653399A31F6","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":436689,"discussion_content":"Pythonä¹Ÿå¯ä»¥å¤„ç†å¤§é‡çš„æ•°æ®ï¼Œé€‰æ‹©Pythonæ˜¯å› ä¸ºç”¨çš„äººå¤šï¼Œè€Œä¸”å·¥å…·åŒ…å®Œå–„ï¼Œèµ°å‰äººèµ°çš„è·¯ï¼Œä¸éœ€è¦é‡å¤é€ è½®å­","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1577624840,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":60595,"user_name":"lee4","can_delete":false,"product_type":"c1","uid":1021495,"ip_address":"","ucode":"36F82406C58075","user_header":"https://static001.geekbang.org/account/avatar/00/0f/96/37/abb7bfe3.jpg","comment_is_top":false,"comment_ctime":1547517423,"is_pvip":false,"replies":[{"id":64737,"content":"Good Job","user_name":"ä½œè€…å›å¤","user_name_real":"cy","uid":1306094,"ctime":1577624921,"ip_address":"","comment_id":60595,"utype":1}],"discussion_count":1,"race_medal":0,"score":6,"product_id":100021701,"comment_content":"é‡ç‚¹è¿˜è¦çœ‹æ•°æ®ä½¿ç”¨çš„åœºæ™¯å’Œç›®çš„ã€‚\næ ¹æ®ç°æœ‰ä¿¡æ¯ï¼Œæœ‰å¯èƒ½é‡‡å–ä»¥ä¸‹è¡ŒåŠ¨ï¼š\n\n1. å°†foodä¸€åˆ—å†…å®¹å†™æ³•ç»Ÿä¸€ï¼Œä¾‹å¦‚å¤§å°å†™\n2. foodä¸€åˆ—ä¸å®œå»é‡ï¼Œå¯èƒ½éœ€è¦å¦è¡Œå»ºç«‹index\n3. ouncesä¸€åˆ—å°†Nanå»é™¤ï¼Œæˆ–å¡«å……ä¸º0 å¹¶å¦è¡Œå»ºç«‹indicatoræ ‡è¯†æ•°æ®ç¼ºå¤±\n4. ouncesä¸€åˆ—å°†è´Ÿå€¼å»é™¤ï¼Œæˆ–å–ç»å¯¹å€¼\n5. animalä¸€åˆ—å¯ä»¥è€ƒè™‘å°†åˆ†ç±»è½¬æ¢ä¸ºæ•°å€¼å‹indicator","like_count":0,"discussions":[{"author":{"id":1306094,"avatar":"https://static001.geekbang.org/account/avatar/00/13/ed/ee/c4779b67.jpg","nickname":"cy","note":"","ucode":"50D653399A31F6","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":436555,"discussion_content":"Good Job","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1577624921,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":57473,"user_name":"Hot   Heat","can_delete":false,"product_type":"c1","uid":1235964,"ip_address":"","ucode":"EF8E2ADEB29BEA","user_header":"https://static001.geekbang.org/account/avatar/00/12/db/fc/8ddeaccb.jpg","comment_is_top":false,"comment_ctime":1546819915,"is_pvip":false,"replies":null,"discussion_count":0,"race_medal":0,"score":6,"product_id":100021701,"comment_content":"å¯ä»¥ç»™ä¸ªæ ·ä¾‹æ•°æ®çš„é“¾æ¥å—ï¼Ÿè‡ªå·±åŠ¨æ‰‹æ“ä½œä¸€ä¸‹","like_count":20},{"had_liked":false,"id":64299,"user_name":"çˆ±åšæ¢¦çš„å’¸é±¼","can_delete":false,"product_type":"c1","uid":1051256,"ip_address":"","ucode":"9D9642CF0752BB","user_header":"","comment_is_top":false,"comment_ctime":1548738106,"is_pvip":false,"replies":null,"discussion_count":0,"race_medal":0,"score":6,"product_id":100021701,"comment_content":"å»ºè®®è€å¸ˆæ¶‰åŠåˆ°æ•°æ®é›†ç»ƒä¹ çš„å¯ä»¥æŠŠæ•°æ®æ”¾åœ¨githubä¸Šï¼Œæ–¹ä¾¿æˆ‘ä»¬åšåŒæ­¥ç»ƒä¹ ã€‚","like_count":12},{"had_liked":false,"id":57568,"user_name":"auroroa","can_delete":false,"product_type":"c1","uid":1057164,"ip_address":"","ucode":"0FF44C9A40E8CD","user_header":"https://static001.geekbang.org/account/avatar/00/10/21/8c/f7a24bc5.jpg","comment_is_top":false,"comment_ctime":1546839199,"is_pvip":false,"replies":null,"discussion_count":0,"race_medal":0,"score":6,"product_id":100021701,"comment_content":"æœ€å¤§çš„é—®é¢˜æ˜¯ä¸æ˜¯æ²¡æŠŠæ•°æ®çš„æ¥æºå’Œç›®çš„æè¿°æ¸…æ¥šï¼ŸğŸ˜„","like_count":12},{"had_liked":false,"id":58069,"user_name":"nrvna","can_delete":false,"product_type":"c1","uid":1352764,"ip_address":"","ucode":"05830A97EF354D","user_header":"https://static001.geekbang.org/account/avatar/00/14/a4/3c/6d0a0cc8.jpg","comment_is_top":false,"comment_ctime":1546991448,"is_pvip":false,"replies":null,"discussion_count":0,"race_medal":0,"score":7,"product_id":100021701,"comment_content":"jupyter notebookï¼Œpython3\n\nimport pandas as pd\ndf = pd.read_csv(&quot;D:&#47;&#47;Data_for_sci&#47;food.csv&quot;)\ndf.index\n\ndf\n\n# Data cleaning for lowercase\ndf[&#39;food&#39;] = df[&#39;food&#39;].str.lower()\ndf\n\n# Delet NaN\ndf = df.dropna() \ndf.index = range(len(df)) # reset index\ndf\n\n# Get bacon&#39;s mean value and delet second one \ndf.loc[0,&#39;ounces&#39;] = df[df[&#39;food&#39;].isin([&#39;bacon&#39;])].mean()[&#39;ounces&#39;]\ndf.drop(df.index[4],inplace=True)\ndf.index = range(len(df)) # reset index\ndf\n\n#Get pastrami&#39;s mean value and delet second one \ndf.loc[2,&#39;ounces&#39;] = df[df[&#39;food&#39;].isin([&#39;pastrami&#39;])].mean()[&#39;ounces&#39;]\ndf.drop(df.index[4],inplace=True)\ndf.index = range(len(df)) # reset index\ndf\n\n\n\n\n","like_count":8},{"had_liked":false,"id":57551,"user_name":"æ¡ƒå›­æ‚ ç„¶åœ¨","can_delete":false,"product_type":"c1","uid":1017637,"ip_address":"","ucode":"704460D9CAD1CB","user_header":"https://static001.geekbang.org/account/avatar/00/0f/87/25/898dea4e.jpg","comment_is_top":false,"comment_ctime":1546831734,"is_pvip":false,"replies":null,"discussion_count":0,"race_medal":0,"score":7,"product_id":100021701,"comment_content":"æˆ‘çš„ç†è§£ï¼Œä¸èƒ½å¯¹foodåˆ—ç®€å•å»é‡å§ï¼Œè€Œæ˜¯è§„èŒƒouncesåˆ—æ•°æ®åæ±‡æ€»æˆ–è€…ä¿æŒåŸæ ·ï¼Œè¿™å¯èƒ½ä½¿å¨æˆ¿é£Ÿææ¶ˆè€—è®°å½•ã€‚æ•°æ®æ¸…æ´—è¿˜æ˜¯è¦ç»“åˆå®Œå…¨åˆä¸€+ä¸šåŠ¡å«ä¹‰ã€‚","like_count":8},{"had_liked":false,"id":62095,"user_name":"å°ç†ŠçŒ«","can_delete":false,"product_type":"c1","uid":1257442,"ip_address":"","ucode":"7549BA17FFBAD4","user_header":"https://static001.geekbang.org/account/avatar/00/13/2f/e2/3640e491.jpg","comment_is_top":false,"comment_ctime":1547907912,"is_pvip":false,"replies":null,"discussion_count":1,"race_medal":0,"score":7,"product_id":100021701,"comment_content":"å°†ç£…ï¼ˆlbsï¼‰è½¬åŒ–ä¸ºåƒå…‹ï¼ˆkgsï¼‰ï¼š\næ„Ÿè§‰è¿™ä¸ªåœ°æ–¹å†™å¤æ‚äº†ï¼Œç›´æ¥ç”¨æ­£åˆ™è¡¨è¾¾å¼æ›¿æ¢å°±è¡Œäº†\ndf[&#39;Weight&#39;].replace(&#39;lbs$&#39;, &#39;kgs&#39;, regex=True, inplace=True)","like_count":7},{"had_liked":false,"id":66693,"user_name":"Geek_hve78z","can_delete":false,"product_type":"c1","uid":1015045,"ip_address":"","ucode":"386803B8FC2DD5","user_header":"https://static001.geekbang.org/account/avatar/00/0f/7d/05/4bad0c7c.jpg","comment_is_top":false,"comment_ctime":1549981870,"is_pvip":false,"replies":null,"discussion_count":0,"race_medal":0,"score":7,"product_id":100021701,"comment_content":"ä»¥ä¸‹ä¸ºå¯¹æ–‡ä¸­çš„æ¡ˆä¾‹è¿›è¡Œç¼–ç æ“ä½œï¼Œæœ‰ä¸‰ä¸ªé—®é¢˜è¯·æ•™\n1ã€é‡é‡ã€â€˜weightâ€™ã€‘ä¸€åˆ—çš„æ•°æ®ï¼Œå¦‚ä½•åˆ©ç”¨å¹³å‡å€¼è¿›è¡Œå¡«å……ï¼Œå› ä¸ºè¯¥åˆ—æ˜¯å­—ç¬¦ç±»å‹ï¼Œæ— æ³•æ±‚å¹³å‡ã€‚ç›®å‰é‡‡ç”¨é«˜é¢‘æ•°æ®å¡«å……\n2ã€Pink Pantherç”¨æˆ·çš„ä¸‰å›´æ•°æ®å¦‚ä½•å¡«å……ï¼Ÿï¼Œæˆ‘æƒ³åˆ©ç”¨å¯¹åº”æ€§åˆ«çš„å¹³å‡å€¼å¡«å……\n3ã€æ¡ˆä¾‹ä¸­ï¼Œå6åˆ—ä¸æ˜¾ç¤ºâ€˜NaNâ€™ï¼Œæ˜¯å› ä¸ºå¡«å……åˆ—â€˜ç©ºæ ¼â€™å—ï¼Ÿ\n_____________________\nimport pandas as pd\n## å¯¼å…¥æ•°æ®\ndf=pd.read_csv(&#39;ç¬¬11èŠ‚æ•°æ®.csv&#39;)\n## é‡å‘½ååˆ—åcolumns\ndf.rename(columns={&#39;0&#39;:&#39;Number&#39;,&#39;1&#39;:&#39;Name&#39;,&#39;2&#39;:&#39;Age&#39;,&#39;3&#39;:&#39;Weight&#39;,&#39;4&#39;:&#39;m0006&#39;,&#39;5&#39;:&#39;m0612&#39;,&#39;6&#39;:&#39;m1218&#39;\n                  ,&#39;7&#39;:&#39;f0006&#39;,&#39;8&#39;:&#39;f0612&#39;,&#39;9&#39;:&#39;f1218&#39;},inplace=True)\n\n#2.å…¨é¢æ€§\n#åˆ—æ•°æ®ç»Ÿä¸€å•ä½\n# è·å–weight æ•°æ®åˆ—ä¸­å•ä½ä¸ºlbsçš„æ•°æ®\nrows_with_lbs=df[&#39;Weight&#39;].str.contains(&#39;lbs&#39;).fillna(False)\nprint(df[rows_with_lbs])\n# å°†lbsè½¬æ¢ä¸ºkgsï¼Œ2.2lbs=1kgs\nfor i,lbs_row in df[rows_with_lbs].iterrows():\n    # æˆªå–ä»å¤´å¼€å§‹åˆ°å€’æ•°ç¬¬ä¸‰ä¸ªå­—ç¬¦ä¹‹å‰ï¼Œå³å»æ‰lbs\n    weight=int(float(lbs_row[&#39;Weight&#39;][:-3])&#47;2.2)\n    df.at[i,&#39;Weight&#39;]=&#39;{}kgs&#39;.format(weight)\n\n#1.å®Œæ•´æ€§\n# åˆ é™¤å…¨ç©ºçš„è¡Œ\ndf.dropna(how=&#39;all&#39;,inplace=True)\n\n##ç¼ºå¤±å€¼è¡¥å……æ–¹å¼ä¸€\n## df[â€˜Ageâ€™] ä¸­ç¼ºå¤±çš„æ•°å€¼ç”¨å¹³å‡å¹´é¾„è¿›è¡Œå¡«å……\n#df[&#39;Age&#39;].fillna(df[&#39;Age&#39;].mean(),inplace=True)\n\n## ç¼ºå¤±å€¼è¡¥å……æ–¹å¼äºŒ\n## ä½¿ç”¨Ageä¸€åˆ—é«˜é¢‘æ•°æ®è¿›è¡Œå¡«å……\nage_maxf=df[&#39;Age&#39;].value_counts().index[0]\ndf[&#39;Age&#39;].fillna(age_maxf,inplace=True)\n\n## ä½¿ç”¨Weightä¸€åˆ—é«˜é¢‘æ•°æ®è¿›è¡Œå¡«å……\nweight_maxf=df[&#39;Weight&#39;].value_counts().index[0]\ndf[&#39;Weight&#39;].fillna(weight_maxf,inplace=True)\n\n#4.å”¯ä¸€æ€§\n#Nameæ‹†åˆ†ä¸ºfirstnameå’Œlastname\n#åˆ‡åˆ†åå­—ï¼Œåˆ é™¤æºæ•°æ®åˆ—\ndf[[&#39;first_name&#39;,&#39;last_name&#39;]]=df[&#39;Name&#39;].str.split(expand=True)\ndf.drop(&#39;Name&#39;,axis=1,inplace=True)\n\n# ç§»åŠ¨first_nameå’Œlast_nameè¿™ä¿©åˆ—\nfirst_name=df.pop(&#39;first_name&#39;)\ndf.insert(1,&#39;first_name&#39;,first_name)\nlast_name=df.pop(&#39;last_name&#39;)\ndf.insert(2,&#39;last_name&#39;,last_name)\n\n#åˆ é™¤é‡å¤æ•°æ®è¡Œ\ndf.drop_duplicates([&#39;first_name&#39;,&#39;last_name&#39;],inplace=True)\n\n#3.åˆç†æ€§\n# åˆ é™¤éASCIIå­—ç¬¦\ndf[&#39;first_name&#39;].replace({r&#39;[^\\x00-\\x7F]+&#39;:&#39;&#39;},regex=True,inplace=True)\ndf[&#39;last_name&#39;].replace({r&#39;[^\\x00-\\x7F]+&#39;:&#39;&#39;},regex=True,inplace=True)\n\ndf\n","like_count":3},{"had_liked":false,"id":91282,"user_name":"å§œæ³®æ˜Œ","can_delete":false,"product_type":"c1","uid":1107213,"ip_address":"","ucode":"89B63270BAE099","user_header":"https://static001.geekbang.org/account/avatar/00/10/e5/0d/b4258141.jpg","comment_is_top":false,"comment_ctime":1556963886,"is_pvip":false,"replies":null,"discussion_count":0,"race_medal":0,"score":7,"product_id":100021701,"comment_content":"åœ¨å”¯ä¸€æ€§çš„æœ€åä¸€æ­¥ï¼Œå»é‡åè¿˜æœ‰é‡å¤æ•°æ®å•Šï¼ŒHuey McDuckæœ‰ä¸¤æ¡ç›¸åŒæ•°æ®ï¼Œè¿™ä¸ªæœ‰é—®é¢˜å‘¢","like_count":2},{"had_liked":false,"id":61571,"user_name":"lingmacker","can_delete":false,"product_type":"c1","uid":1353113,"ip_address":"","ucode":"2B61674AD47F34","user_header":"https://static001.geekbang.org/account/avatar/00/14/a5/99/db2f6325.jpg","comment_is_top":false,"comment_ctime":1547724781,"is_pvip":false,"replies":null,"discussion_count":1,"race_medal":0,"score":7,"product_id":100021701,"comment_content":"import pandas as pd\n\n\ndef wash_data():\n    data = pd.read_excel(&quot;.&#47;data&#47;data.xlsx&quot;)\n    data[&quot;food&quot;] = data[&quot;food&quot;].str.capitalize()  # é¦–å­—æ¯å¤§å†™\n    data.fillna(0, inplace=True)\n    data.drop_duplicates(&quot;food&quot;, inplace=True)  # åˆ é™¤é‡å¤è¡Œ\n    \n    data.to_excel(&quot;.&#47;data&#47;re_data.xlsx&quot;)\n\n\nif __name__ == &#39;__main__&#39;:\n    wash_data()\n\n\næ˜¯ä¸æ˜¯æ¸…æ´—å¾—å¤ªç®€å•äº†ã€‚ã€‚ã€‚","like_count":2,"discussions":[{"author":{"id":2058384,"avatar":"https://static001.geekbang.org/account/avatar/00/1f/68/90/ca86abe3.jpg","nickname":"CHEN","note":"","ucode":"5B9BA6F6C83F58","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":292715,"discussion_content":"ä½ æ²¡è¿›è¡Œå•ä½æ¢ç®—å§ï¼Ÿ","likes_number":1,"is_delete":false,"is_hidden":false,"ctime":1595315990,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":57649,"user_name":"å¥‹æ–—","can_delete":false,"product_type":"c1","uid":1068400,"ip_address":"","ucode":"3A90F4F7EE329E","user_header":"https://static001.geekbang.org/account/avatar/00/10/4d/70/b4517c57.jpg","comment_is_top":false,"comment_ctime":1546859809,"is_pvip":false,"replies":null,"discussion_count":0,"race_medal":0,"score":7,"product_id":100021701,"comment_content":"è€å¸ˆä½ å¥½ï¼æˆ‘æ˜¯çˆ¬è™«æ–°æ‰‹ï¼Œåœ¨ä¸ºæœºå™¨ç¿»è¯‘æä¾›è¯­æ–™ï¼Œçˆ¬å–å®Œæ•°æ®å¾ˆå¤´ç–¼ï¼Œæ–‡æœ¬æ•°æ®é‡Œæœ‰å¾ˆå¤šé—®é¢˜ï¼Œè€å¸ˆé’ˆå¯¹æ–‡æœ¬ç±»çš„æ•°æ®æ€ä¹ˆå¤„ç†å¥½é‚£ï¼Œpandasé€‚ç”¨å—ï¼Ÿè°¢è°¢äº†","like_count":2},{"had_liked":false,"id":57597,"user_name":"Tommy","can_delete":false,"product_type":"c1","uid":1354011,"ip_address":"","ucode":"98C30F99B5670D","user_header":"https://static001.geekbang.org/account/avatar/00/14/a9/1b/1f13e299.jpg","comment_is_top":false,"comment_ctime":1546845077,"is_pvip":false,"replies":null,"discussion_count":0,"race_medal":0,"score":7,"product_id":100021701,"comment_content":"è„šæœ¬çœ‹ä¸å…¨å•Š","like_count":2},{"had_liked":false,"id":313904,"user_name":"picoasis","can_delete":false,"product_type":"c1","uid":1217329,"ip_address":"","ucode":"D5113416FF2B14","user_header":"https://static001.geekbang.org/account/avatar/00/12/93/31/abb7bfe3.jpg","comment_is_top":false,"comment_ctime":1632732817,"is_pvip":false,"replies":null,"discussion_count":0,"race_medal":0,"score":7,"product_id":100021701,"comment_content":"1. å®Œæ•´æ€§ï¼šå¯¹NaNæ•°æ®è¿›è¡Œå¤„ç†ï¼Œåˆ é™¤ï¼Œæˆ–å–å‡å€¼ï¼Œæˆ–æœ€é«˜é¢‘ç‡å€¼ã€‚\n2. å…¨é¢æ€§ï¼šfoodçš„åç§°ä¸ç»Ÿä¸€ï¼Œå®¹æ˜“å¼•å‘æ­§ä¹‰ï¼Œæ˜¯å¦ä»£è¡¨ä¸åŒçš„ç§ç±»ã€‚ç¡®è®¤æ˜¯ç›¸åŒç§ç±»æ—¶ï¼Œç»Ÿä¸€ä¸ºé¦–å­—æ¯å¤§å†™ï¼Œæˆ–è€…ç»Ÿä¸€å°å†™ã€‚æœ‰å…¶ä»–å«ä¹‰çš„ï¼Œæ”¹å˜åç§°ä¸ºæ›´åŠ ä¸æ˜“æ··æ·†çš„ï¼Œæˆ–è€…å¢åŠ å…¶ä»–æ•°æ®åˆ—è¿›è¡Œæ ‡è¯†ã€‚\n3. åˆæ³•æ€§ï¼šæ²¡æœ‰ç‰¹æ®Šå«ä¹‰çš„æƒ…å†µä¸‹ï¼Œounceså€¼ä¸åº”ä¸ºè´Ÿå€¼ï¼Œå¯ä»¥è€ƒè™‘å–ç»å¯¹å€¼ï¼Œæˆ–ä½œä¸ºæ— æ•ˆæ•°æ®åˆ é™¤æ­¤è¡Œã€‚\n4. å”¯ä¸€æ€§:ä¸€èˆ¬åœ°ï¼Œå°†æœ€å·¦ä¾§åˆ—ä½œä¸ºç´¢å¼•ï¼Œä½†æ­¤æ•°æ®ä¸­æœ€å·¦ä¾§åˆ—é‡å¤æ•°æ®è¾ƒå¤šä¸åˆå¸¸è§„ï¼Œå› æ­¤ä¸å¯ç›´æ¥å»é‡ï¼Œè€Œæ˜¯éœ€è¦æ›´å¤šä¿¡æ¯ï¼Œæ¥ç¡®è®¤ä»£è¡¨çš„ä¸šåŠ¡å«ä¹‰ã€‚","like_count":1},{"had_liked":false,"id":70120,"user_name":"BGBiao","can_delete":false,"product_type":"c1","uid":1044353,"ip_address":"","ucode":"7DBB34AFC772CF","user_header":"https://static001.geekbang.org/account/avatar/00/0f/ef/81/974c87a3.jpg","comment_is_top":false,"comment_ctime":1551000684,"is_pvip":false,"replies":null,"discussion_count":0,"race_medal":0,"score":7,"product_id":100021701,"comment_content":"## é¦–å…ˆæ ·æœ¬æ•°æ®é›†å­˜åœ¨å¦‚ä¸‹é—®é¢˜:\nå®Œæ•´æ€§: ouncesåˆ—å­˜åœ¨ç©ºå€¼\nå…¨é¢æ€§ï¼š\nåˆç†æ€§: ouncesåˆ—å­˜åœ¨è´Ÿå€¼\nå”¯ä¸€æ€§: baconç¾é£Ÿå­˜åœ¨å¤šæ¡è®°å½•ï¼Œå¹¶ä¸”åç§°å­˜åœ¨å¤§å°å†™ï¼Œæ— æ³•å”¯ä¸€åŒºåˆ†ä¸€ä¸ªé£Ÿç‰©ä¿¡æ¯\n## æ ¹æ®ä»¥ä¸Šé—®é¢˜ï¼Œå¯ä»¥åšçš„æ•°æ®æ¸…æ´—ä¸ºï¼š\n1. è¿‡æ»¤å¼‚å¸¸æ•°æ®è¡Œ(åˆ é™¤ouncesåˆ—ä¸ºç©ºå’Œè´Ÿå€¼çš„è¡Œ)\n2.ç»Ÿä¸€foodå­—æ®µå‘½åä½¿ç”¨å°å†™\n## é—®é¢˜çš„æœ¬è´¨: \nå…¶å®ä¸ªäººè®¤ä¸ºé—®é¢˜çš„æœ¬è´¨æ˜¯æ•°æ®æ€ç»´å’Œæ•°æ®æ ‡å‡†ï¼Œå¦‚æœå•çº¯çš„ç»™è¿™æ ·ä¸€ä»½åŸå§‹æ•°æ®ç»™æ•°æ®åˆ†æäººå‘˜ï¼Œä¸æä¾›ä¸Šä¸‹æ–‡ä¿¡æ¯ï¼Œé‚£å…¶å®æ•°æ®åˆ†ææ˜¯å¾ˆéš¾åšå‡ºæ•ˆæœçš„ã€‚æ¯”å¦‚æŒ‰ç…§æˆ‘çš„æ¸…æ´—è§„åˆ™1æ¸…æ´—å®Œæˆåæ•°æ®å¦‚ä¸‹:\n           food  ounces  animal\n0        bacon     4.0     pig\n1  pulled pork     3.0     pig\n2     Pastrami     6.0     cow\n3  corned beef     7.5     cow\n4        Bacon     8.0     pig\n5    honey ham     5.0     pig\n6     nova lox     6.0  salmon\nè™½ç„¶æœ‰baconå’ŒBaconå¯èƒ½æ˜¯ä¸¤ç§é£Ÿç‰©ï¼Œä½†ä¹Ÿå¾ˆå®¹æ˜“äº§ç”Ÿæ•°æ®æ­§ä¹‰ï¼Œå› ä¸ºé£Ÿç‰©æ²¡æœ‰å”¯ä¸€æ ‡è¯†ã€‚å› æ­¤åœ¨æœ‰é™çš„ä¸Šä¸‹æ–‡ç¯å¢ƒä¸­ï¼Œæ•°æ®åˆ†æå¯ä»¥åšåˆ°å¦‚ä¸‹æ•°æ®é›†ã€‚\næ¸…æ´—è¿‡åçš„æ•°æ®:\n           food  ounces  animal      foodtag\n0        Bacon     8.0     pig        bacon\n1     Pastrami     6.0     cow     pastrami\n2        bacon     4.0     pig        bacon\n3  corned beef     7.5     cow  corned beef\n4    honey ham     5.0     pig    honey ham\n5     nova lox     6.0  salmon     nova lox\n6  pulled pork     3.0     pig  pulled pork\n\n## ç›¸å…³codes(å°†ä»¥ä¸‹ä»£ç ç›´æ¥é»è´´ï¼Œåœ¨python3ç¯å¢ƒä¸­è¿è¡Œ)\n#!&#47;usr&#47;bin&#47;env python\n# env: python 3.X\nimport pandas as pd\nimport pandasql\n\ndata = {&#39;food&#39;:[&#39;bacon&#39;,&#39;pulled pork&#39;,&#39;bacon&#39;,&#39;Pastrami&#39;,&#39;corned beef&#39;,&#39;Bacon&#39;,&#39;pastrami&#39;,&#39;honey ham&#39;,&#39;nova lox&#39;],&#39;ounces&#39;:[4.0,3.0,None,6.0,7.5,8.0,-3.0,5.0,6.0],&#39;animal&#39;:[&#39;pig&#39;,&#39;pig&#39;,&#39;pig&#39;,&#39;cow&#39;,&#39;cow&#39;,&#39;pig&#39;,&#39;cow&#39;,&#39;pig&#39;,&#39;salmon&#39;]}\n\nfoods = pd.DataFrame(data)\n\nprint(&quot;åŸå§‹æ•°æ®é›†:\\n %s&quot; % foods)\n\n# æ³¨æ„:å› ä¸ºä¸Šé¢çš„dataæ˜¯æˆ‘è‡ªå·±æ„é€ çš„ï¼Œæ•°æ®ç±»å‹æ˜¯å·²çŸ¥çš„ï¼Œé€šå¸¸åœ¨å¤„ç†æ•°æ®å‰ï¼Œåº”å½“å…ˆæŸ¥çœ‹ä¸‹æ•°æ®ç»“æ„ï¼Œè½¬æ¢æˆç»Ÿä¸€æ•°æ®ç±»å‹\nprint(&quot;æ£€æŸ¥æ•°æ®é›†æ¯åˆ—çš„æ•°æ®ç±»å‹:\\n %s &quot; % foods.dtypes)\n\n# åˆ é™¤ç©ºè¡Œ\nfoods.dropna(axis=0,how=&#39;any&#39;,inplace=True)\n\n# ä½¿ç”¨sqlæ–¹å¼ç›´æ¥è¿‡æ»¤å¼‚å¸¸æ•°æ®\n\nfilterFoods = lambda sql: pandasql.sqldf(sql,globals())\nsql = &#39;select * from foods where ounces &gt; 0&#39;\nfoodsnew = filterFoods(sql)\nprint(&quot;è¿‡æ»¤æ‰å¼‚å¸¸æ•°æ®è¡Œ:\\n %s &quot; % foodsnew)\n\nfoodsnew[&#39;foodtag&#39;] = foodsnew[&#39;food&#39;].str.lower()\n\nprint(&quot;ç»Ÿä¸€é£Ÿç‰©å‘½åè§„èŒƒ:\\n %s &quot; % foodsnew)\n\n# æœ€åå¯ä»¥ä½¿ç”¨sqlè¿›è¡ŒæŒ‰ç…§foodæ’åº\nsql2 = &quot;select * from foodsnew order by food&quot;\nprint(&quot;æ¸…æ´—è¿‡åçš„æ•°æ®:\\n %s &quot; % filterFoods(sql2))\n\n\n\n","like_count":1,"discussions":[{"author":{"id":1560486,"avatar":"https://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTLs1FRrgeeEYvfZLvGqqgIS1bZamyMvUFsIr0qG4vV3nLDnUc7VGlNq2Rm3AHN7MHFDm8s88fvpcA/132","nickname":"Geek_ab1278","note":"","ucode":"BEFF06D7759A89","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":1052,"discussion_content":"éœ€è¦é’ˆå¯¹foodå’Œanimal éƒ½é‡å¤çš„æ¥åˆ é™¤","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1562297162,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":58069,"user_name":"nrvna","can_delete":false,"product_type":"c1","uid":1352764,"ip_address":"","ucode":"05830A97EF354D","user_header":"https://static001.geekbang.org/account/avatar/00/14/a4/3c/6d0a0cc8.jpg","comment_is_top":false,"comment_ctime":1546991448,"is_pvip":false,"replies":null,"discussion_count":0,"race_medal":0,"score":7,"product_id":100021701,"comment_content":"jupyter notebookï¼Œpython3\n\nimport pandas as pd\ndf = pd.read_csv(&quot;D:&#47;&#47;Data_for_sci&#47;food.csv&quot;)\ndf.index\n\ndf\n\n# Data cleaning for lowercase\ndf[&#39;food&#39;] = df[&#39;food&#39;].str.lower()\ndf\n\n# Delet NaN\ndf = df.dropna() \ndf.index = range(len(df)) # reset index\ndf\n\n# Get bacon&#39;s mean value and delet second one \ndf.loc[0,&#39;ounces&#39;] = df[df[&#39;food&#39;].isin([&#39;bacon&#39;])].mean()[&#39;ounces&#39;]\ndf.drop(df.index[4],inplace=True)\ndf.index = range(len(df)) # reset index\ndf\n\n#Get pastrami&#39;s mean value and delet second one \ndf.loc[2,&#39;ounces&#39;] = df[df[&#39;food&#39;].isin([&#39;pastrami&#39;])].mean()[&#39;ounces&#39;]\ndf.drop(df.index[4],inplace=True)\ndf.index = range(len(df)) # reset index\ndf\n\n\n\n\n","like_count":8},{"had_liked":false,"id":57551,"user_name":"æ¡ƒå›­æ‚ ç„¶åœ¨","can_delete":false,"product_type":"c1","uid":1017637,"ip_address":"","ucode":"704460D9CAD1CB","user_header":"https://static001.geekbang.org/account/avatar/00/0f/87/25/898dea4e.jpg","comment_is_top":false,"comment_ctime":1546831734,"is_pvip":false,"replies":null,"discussion_count":0,"race_medal":0,"score":7,"product_id":100021701,"comment_content":"æˆ‘çš„ç†è§£ï¼Œä¸èƒ½å¯¹foodåˆ—ç®€å•å»é‡å§ï¼Œè€Œæ˜¯è§„èŒƒouncesåˆ—æ•°æ®åæ±‡æ€»æˆ–è€…ä¿æŒåŸæ ·ï¼Œè¿™å¯èƒ½ä½¿å¨æˆ¿é£Ÿææ¶ˆè€—è®°å½•ã€‚æ•°æ®æ¸…æ´—è¿˜æ˜¯è¦ç»“åˆå®Œå…¨åˆä¸€+ä¸šåŠ¡å«ä¹‰ã€‚","like_count":8},{"had_liked":false,"id":62095,"user_name":"å°ç†ŠçŒ«","can_delete":false,"product_type":"c1","uid":1257442,"ip_address":"","ucode":"7549BA17FFBAD4","user_header":"https://static001.geekbang.org/account/avatar/00/13/2f/e2/3640e491.jpg","comment_is_top":false,"comment_ctime":1547907912,"is_pvip":false,"replies":null,"discussion_count":1,"race_medal":0,"score":7,"product_id":100021701,"comment_content":"å°†ç£…ï¼ˆlbsï¼‰è½¬åŒ–ä¸ºåƒå…‹ï¼ˆkgsï¼‰ï¼š\næ„Ÿè§‰è¿™ä¸ªåœ°æ–¹å†™å¤æ‚äº†ï¼Œç›´æ¥ç”¨æ­£åˆ™è¡¨è¾¾å¼æ›¿æ¢å°±è¡Œäº†\ndf[&#39;Weight&#39;].replace(&#39;lbs$&#39;, &#39;kgs&#39;, regex=True, inplace=True)","like_count":7,"discussions":[{"author":{"id":2058384,"avatar":"https://static001.geekbang.org/account/avatar/00/1f/68/90/ca86abe3.jpg","nickname":"CHEN","note":"","ucode":"5B9BA6F6C83F58","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":292715,"discussion_content":"ä½ æ²¡è¿›è¡Œå•ä½æ¢ç®—å§ï¼Ÿ","likes_number":1,"is_delete":false,"is_hidden":false,"ctime":1595315990,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":66693,"user_name":"Geek_hve78z","can_delete":false,"product_type":"c1","uid":1015045,"ip_address":"","ucode":"386803B8FC2DD5","user_header":"https://static001.geekbang.org/account/avatar/00/0f/7d/05/4bad0c7c.jpg","comment_is_top":false,"comment_ctime":1549981870,"is_pvip":false,"replies":null,"discussion_count":0,"race_medal":0,"score":7,"product_id":100021701,"comment_content":"ä»¥ä¸‹ä¸ºå¯¹æ–‡ä¸­çš„æ¡ˆä¾‹è¿›è¡Œç¼–ç æ“ä½œï¼Œæœ‰ä¸‰ä¸ªé—®é¢˜è¯·æ•™\n1ã€é‡é‡ã€â€˜weightâ€™ã€‘ä¸€åˆ—çš„æ•°æ®ï¼Œå¦‚ä½•åˆ©ç”¨å¹³å‡å€¼è¿›è¡Œå¡«å……ï¼Œå› ä¸ºè¯¥åˆ—æ˜¯å­—ç¬¦ç±»å‹ï¼Œæ— æ³•æ±‚å¹³å‡ã€‚ç›®å‰é‡‡ç”¨é«˜é¢‘æ•°æ®å¡«å……\n2ã€Pink Pantherç”¨æˆ·çš„ä¸‰å›´æ•°æ®å¦‚ä½•å¡«å……ï¼Ÿï¼Œæˆ‘æƒ³åˆ©ç”¨å¯¹åº”æ€§åˆ«çš„å¹³å‡å€¼å¡«å……\n3ã€æ¡ˆä¾‹ä¸­ï¼Œå6åˆ—ä¸æ˜¾ç¤ºâ€˜NaNâ€™ï¼Œæ˜¯å› ä¸ºå¡«å……åˆ—â€˜ç©ºæ ¼â€™å—ï¼Ÿ\n_____________________\nimport pandas as pd\n## å¯¼å…¥æ•°æ®\ndf=pd.read_csv(&#39;ç¬¬11èŠ‚æ•°æ®.csv&#39;)\n## é‡å‘½ååˆ—åcolumns\ndf.rename(columns={&#39;0&#39;:&#39;Number&#39;,&#39;1&#39;:&#39;Name&#39;,&#39;2&#39;:&#39;Age&#39;,&#39;3&#39;:&#39;Weight&#39;,&#39;4&#39;:&#39;m0006&#39;,&#39;5&#39;:&#39;m0612&#39;,&#39;6&#39;:&#39;m1218&#39;\n                  ,&#39;7&#39;:&#39;f0006&#39;,&#39;8&#39;:&#39;f0612&#39;,&#39;9&#39;:&#39;f1218&#39;},inplace=True)\n\n#2.å…¨é¢æ€§\n#åˆ—æ•°æ®ç»Ÿä¸€å•ä½\n# è·å–weight æ•°æ®åˆ—ä¸­å•ä½ä¸ºlbsçš„æ•°æ®\nrows_with_lbs=df[&#39;Weight&#39;].str.contains(&#39;lbs&#39;).fillna(False)\nprint(df[rows_with_lbs])\n# å°†lbsè½¬æ¢ä¸ºkgsï¼Œ2.2lbs=1kgs\nfor i,lbs_row in df[rows_with_lbs].iterrows():\n    # æˆªå–ä»å¤´å¼€å§‹åˆ°å€’æ•°ç¬¬ä¸‰ä¸ªå­—ç¬¦ä¹‹å‰ï¼Œå³å»æ‰lbs\n    weight=int(float(lbs_row[&#39;Weight&#39;][:-3])&#47;2.2)\n    df.at[i,&#39;Weight&#39;]=&#39;{}kgs&#39;.format(weight)\n\n#1.å®Œæ•´æ€§\n# åˆ é™¤å…¨ç©ºçš„è¡Œ\ndf.dropna(how=&#39;all&#39;,inplace=True)\n\n##ç¼ºå¤±å€¼è¡¥å……æ–¹å¼ä¸€\n## df[â€˜Ageâ€™] ä¸­ç¼ºå¤±çš„æ•°å€¼ç”¨å¹³å‡å¹´é¾„è¿›è¡Œå¡«å……\n#df[&#39;Age&#39;].fillna(df[&#39;Age&#39;].mean(),inplace=True)\n\n## ç¼ºå¤±å€¼è¡¥å……æ–¹å¼äºŒ\n## ä½¿ç”¨Ageä¸€åˆ—é«˜é¢‘æ•°æ®è¿›è¡Œå¡«å……\nage_maxf=df[&#39;Age&#39;].value_counts().index[0]\ndf[&#39;Age&#39;].fillna(age_maxf,inplace=True)\n\n## ä½¿ç”¨Weightä¸€åˆ—é«˜é¢‘æ•°æ®è¿›è¡Œå¡«å……\nweight_maxf=df[&#39;Weight&#39;].value_counts().index[0]\ndf[&#39;Weight&#39;].fillna(weight_maxf,inplace=True)\n\n#4.å”¯ä¸€æ€§\n#Nameæ‹†åˆ†ä¸ºfirstnameå’Œlastname\n#åˆ‡åˆ†åå­—ï¼Œåˆ é™¤æºæ•°æ®åˆ—\ndf[[&#39;first_name&#39;,&#39;last_name&#39;]]=df[&#39;Name&#39;].str.split(expand=True)\ndf.drop(&#39;Name&#39;,axis=1,inplace=True)\n\n# ç§»åŠ¨first_nameå’Œlast_nameè¿™ä¿©åˆ—\nfirst_name=df.pop(&#39;first_name&#39;)\ndf.insert(1,&#39;first_name&#39;,first_name)\nlast_name=df.pop(&#39;last_name&#39;)\ndf.insert(2,&#39;last_name&#39;,last_name)\n\n#åˆ é™¤é‡å¤æ•°æ®è¡Œ\ndf.drop_duplicates([&#39;first_name&#39;,&#39;last_name&#39;],inplace=True)\n\n#3.åˆç†æ€§\n# åˆ é™¤éASCIIå­—ç¬¦\ndf[&#39;first_name&#39;].replace({r&#39;[^\\x00-\\x7F]+&#39;:&#39;&#39;},regex=True,inplace=True)\ndf[&#39;last_name&#39;].replace({r&#39;[^\\x00-\\x7F]+&#39;:&#39;&#39;},regex=True,inplace=True)\n\ndf\n","like_count":3},{"had_liked":false,"id":91282,"user_name":"å§œæ³®æ˜Œ","can_delete":false,"product_type":"c1","uid":1107213,"ip_address":"","ucode":"89B63270BAE099","user_header":"https://static001.geekbang.org/account/avatar/00/10/e5/0d/b4258141.jpg","comment_is_top":false,"comment_ctime":1556963886,"is_pvip":false,"replies":null,"discussion_count":0,"race_medal":0,"score":7,"product_id":100021701,"comment_content":"åœ¨å”¯ä¸€æ€§çš„æœ€åä¸€æ­¥ï¼Œå»é‡åè¿˜æœ‰é‡å¤æ•°æ®å•Šï¼ŒHuey McDuckæœ‰ä¸¤æ¡ç›¸åŒæ•°æ®ï¼Œè¿™ä¸ªæœ‰é—®é¢˜å‘¢","like_count":2},{"had_liked":false,"id":61571,"user_name":"lingmacker","can_delete":false,"product_type":"c1","uid":1353113,"ip_address":"","ucode":"2B61674AD47F34","user_header":"https://static001.geekbang.org/account/avatar/00/14/a5/99/db2f6325.jpg","comment_is_top":false,"comment_ctime":1547724781,"is_pvip":false,"replies":null,"discussion_count":1,"race_medal":0,"score":7,"product_id":100021701,"comment_content":"import pandas as pd\n\n\ndef wash_data():\n    data = pd.read_excel(&quot;.&#47;data&#47;data.xlsx&quot;)\n    data[&quot;food&quot;] = data[&quot;food&quot;].str.capitalize()  # é¦–å­—æ¯å¤§å†™\n    data.fillna(0, inplace=True)\n    data.drop_duplicates(&quot;food&quot;, inplace=True)  # åˆ é™¤é‡å¤è¡Œ\n    \n    data.to_excel(&quot;.&#47;data&#47;re_data.xlsx&quot;)\n\n\nif __name__ == &#39;__main__&#39;:\n    wash_data()\n\n\næ˜¯ä¸æ˜¯æ¸…æ´—å¾—å¤ªç®€å•äº†ã€‚ã€‚ã€‚","like_count":2,"discussions":[{"author":{"id":1560486,"avatar":"https://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTLs1FRrgeeEYvfZLvGqqgIS1bZamyMvUFsIr0qG4vV3nLDnUc7VGlNq2Rm3AHN7MHFDm8s88fvpcA/132","nickname":"Geek_ab1278","note":"","ucode":"BEFF06D7759A89","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":1052,"discussion_content":"éœ€è¦é’ˆå¯¹foodå’Œanimal éƒ½é‡å¤çš„æ¥åˆ é™¤","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1562297162,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":57649,"user_name":"å¥‹æ–—","can_delete":false,"product_type":"c1","uid":1068400,"ip_address":"","ucode":"3A90F4F7EE329E","user_header":"https://static001.geekbang.org/account/avatar/00/10/4d/70/b4517c57.jpg","comment_is_top":false,"comment_ctime":1546859809,"is_pvip":false,"replies":null,"discussion_count":0,"race_medal":0,"score":7,"product_id":100021701,"comment_content":"è€å¸ˆä½ å¥½ï¼æˆ‘æ˜¯çˆ¬è™«æ–°æ‰‹ï¼Œåœ¨ä¸ºæœºå™¨ç¿»è¯‘æä¾›è¯­æ–™ï¼Œçˆ¬å–å®Œæ•°æ®å¾ˆå¤´ç–¼ï¼Œæ–‡æœ¬æ•°æ®é‡Œæœ‰å¾ˆå¤šé—®é¢˜ï¼Œè€å¸ˆé’ˆå¯¹æ–‡æœ¬ç±»çš„æ•°æ®æ€ä¹ˆå¤„ç†å¥½é‚£ï¼Œpandasé€‚ç”¨å—ï¼Ÿè°¢è°¢äº†","like_count":2},{"had_liked":false,"id":57597,"user_name":"Tommy","can_delete":false,"product_type":"c1","uid":1354011,"ip_address":"","ucode":"98C30F99B5670D","user_header":"https://static001.geekbang.org/account/avatar/00/14/a9/1b/1f13e299.jpg","comment_is_top":false,"comment_ctime":1546845077,"is_pvip":false,"replies":null,"discussion_count":0,"race_medal":0,"score":7,"product_id":100021701,"comment_content":"è„šæœ¬çœ‹ä¸å…¨å•Š","like_count":2},{"had_liked":false,"id":313904,"user_name":"picoasis","can_delete":false,"product_type":"c1","uid":1217329,"ip_address":"","ucode":"D5113416FF2B14","user_header":"https://static001.geekbang.org/account/avatar/00/12/93/31/abb7bfe3.jpg","comment_is_top":false,"comment_ctime":1632732817,"is_pvip":false,"replies":null,"discussion_count":0,"race_medal":0,"score":7,"product_id":100021701,"comment_content":"1. å®Œæ•´æ€§ï¼šå¯¹NaNæ•°æ®è¿›è¡Œå¤„ç†ï¼Œåˆ é™¤ï¼Œæˆ–å–å‡å€¼ï¼Œæˆ–æœ€é«˜é¢‘ç‡å€¼ã€‚\n2. å…¨é¢æ€§ï¼šfoodçš„åç§°ä¸ç»Ÿä¸€ï¼Œå®¹æ˜“å¼•å‘æ­§ä¹‰ï¼Œæ˜¯å¦ä»£è¡¨ä¸åŒçš„ç§ç±»ã€‚ç¡®è®¤æ˜¯ç›¸åŒç§ç±»æ—¶ï¼Œç»Ÿä¸€ä¸ºé¦–å­—æ¯å¤§å†™ï¼Œæˆ–è€…ç»Ÿä¸€å°å†™ã€‚æœ‰å…¶ä»–å«ä¹‰çš„ï¼Œæ”¹å˜åç§°ä¸ºæ›´åŠ ä¸æ˜“æ··æ·†çš„ï¼Œæˆ–è€…å¢åŠ å…¶ä»–æ•°æ®åˆ—è¿›è¡Œæ ‡è¯†ã€‚\n3. åˆæ³•æ€§ï¼šæ²¡æœ‰ç‰¹æ®Šå«ä¹‰çš„æƒ…å†µä¸‹ï¼Œounceså€¼ä¸åº”ä¸ºè´Ÿå€¼ï¼Œå¯ä»¥è€ƒè™‘å–ç»å¯¹å€¼ï¼Œæˆ–ä½œä¸ºæ— æ•ˆæ•°æ®åˆ é™¤æ­¤è¡Œã€‚\n4. å”¯ä¸€æ€§:ä¸€èˆ¬åœ°ï¼Œå°†æœ€å·¦ä¾§åˆ—ä½œä¸ºç´¢å¼•ï¼Œä½†æ­¤æ•°æ®ä¸­æœ€å·¦ä¾§åˆ—é‡å¤æ•°æ®è¾ƒå¤šä¸åˆå¸¸è§„ï¼Œå› æ­¤ä¸å¯ç›´æ¥å»é‡ï¼Œè€Œæ˜¯éœ€è¦æ›´å¤šä¿¡æ¯ï¼Œæ¥ç¡®è®¤ä»£è¡¨çš„ä¸šåŠ¡å«ä¹‰ã€‚","like_count":1},{"had_liked":false,"id":70120,"user_name":"BGBiao","can_delete":false,"product_type":"c1","uid":1044353,"ip_address":"","ucode":"7DBB34AFC772CF","user_header":"https://static001.geekbang.org/account/avatar/00/0f/ef/81/974c87a3.jpg","comment_is_top":false,"comment_ctime":1551000684,"is_pvip":false,"replies":null,"discussion_count":0,"race_medal":0,"score":7,"product_id":100021701,"comment_content":"## é¦–å…ˆæ ·æœ¬æ•°æ®é›†å­˜åœ¨å¦‚ä¸‹é—®é¢˜:\nå®Œæ•´æ€§: ouncesåˆ—å­˜åœ¨ç©ºå€¼\nå…¨é¢æ€§ï¼š\nåˆç†æ€§: ouncesåˆ—å­˜åœ¨è´Ÿå€¼\nå”¯ä¸€æ€§: baconç¾é£Ÿå­˜åœ¨å¤šæ¡è®°å½•ï¼Œå¹¶ä¸”åç§°å­˜åœ¨å¤§å°å†™ï¼Œæ— æ³•å”¯ä¸€åŒºåˆ†ä¸€ä¸ªé£Ÿç‰©ä¿¡æ¯\n## æ ¹æ®ä»¥ä¸Šé—®é¢˜ï¼Œå¯ä»¥åšçš„æ•°æ®æ¸…æ´—ä¸ºï¼š\n1. è¿‡æ»¤å¼‚å¸¸æ•°æ®è¡Œ(åˆ é™¤ouncesåˆ—ä¸ºç©ºå’Œè´Ÿå€¼çš„è¡Œ)\n2.ç»Ÿä¸€foodå­—æ®µå‘½åä½¿ç”¨å°å†™\n## é—®é¢˜çš„æœ¬è´¨: \nå…¶å®ä¸ªäººè®¤ä¸ºé—®é¢˜çš„æœ¬è´¨æ˜¯æ•°æ®æ€ç»´å’Œæ•°æ®æ ‡å‡†ï¼Œå¦‚æœå•çº¯çš„ç»™è¿™æ ·ä¸€ä»½åŸå§‹æ•°æ®ç»™æ•°æ®åˆ†æäººå‘˜ï¼Œä¸æä¾›ä¸Šä¸‹æ–‡ä¿¡æ¯ï¼Œé‚£å…¶å®æ•°æ®åˆ†ææ˜¯å¾ˆéš¾åšå‡ºæ•ˆæœçš„ã€‚æ¯”å¦‚æŒ‰ç…§æˆ‘çš„æ¸…æ´—è§„åˆ™1æ¸…æ´—å®Œæˆåæ•°æ®å¦‚ä¸‹:\n           food  ounces  animal\n0        bacon     4.0     pig\n1  pulled pork     3.0     pig\n2     Pastrami     6.0     cow\n3  corned beef     7.5     cow\n4        Bacon     8.0     pig\n5    honey ham     5.0     pig\n6     nova lox     6.0  salmon\nè™½ç„¶æœ‰baconå’ŒBaconå¯èƒ½æ˜¯ä¸¤ç§é£Ÿç‰©ï¼Œä½†ä¹Ÿå¾ˆå®¹æ˜“äº§ç”Ÿæ•°æ®æ­§ä¹‰ï¼Œå› ä¸ºé£Ÿç‰©æ²¡æœ‰å”¯ä¸€æ ‡è¯†ã€‚å› æ­¤åœ¨æœ‰é™çš„ä¸Šä¸‹æ–‡ç¯å¢ƒä¸­ï¼Œæ•°æ®åˆ†æå¯ä»¥åšåˆ°å¦‚ä¸‹æ•°æ®é›†ã€‚\næ¸…æ´—è¿‡åçš„æ•°æ®:\n           food  ounces  animal      foodtag\n0        Bacon     8.0     pig        bacon\n1     Pastrami     6.0     cow     pastrami\n2        bacon     4.0     pig        bacon\n3  corned beef     7.5     cow  corned beef\n4    honey ham     5.0     pig    honey ham\n5     nova lox     6.0  salmon     nova lox\n6  pulled pork     3.0     pig  pulled pork\n\n## ç›¸å…³codes(å°†ä»¥ä¸‹ä»£ç ç›´æ¥é»è´´ï¼Œåœ¨python3ç¯å¢ƒä¸­è¿è¡Œ)\n#!&#47;usr&#47;bin&#47;env python\n# env: python 3.X\nimport pandas as pd\nimport pandasql\n\ndata = {&#39;food&#39;:[&#39;bacon&#39;,&#39;pulled pork&#39;,&#39;bacon&#39;,&#39;Pastrami&#39;,&#39;corned beef&#39;,&#39;Bacon&#39;,&#39;pastrami&#39;,&#39;honey ham&#39;,&#39;nova lox&#39;],&#39;ounces&#39;:[4.0,3.0,None,6.0,7.5,8.0,-3.0,5.0,6.0],&#39;animal&#39;:[&#39;pig&#39;,&#39;pig&#39;,&#39;pig&#39;,&#39;cow&#39;,&#39;cow&#39;,&#39;pig&#39;,&#39;cow&#39;,&#39;pig&#39;,&#39;salmon&#39;]}\n\nfoods = pd.DataFrame(data)\n\nprint(&quot;åŸå§‹æ•°æ®é›†:\\n %s&quot; % foods)\n\n# æ³¨æ„:å› ä¸ºä¸Šé¢çš„dataæ˜¯æˆ‘è‡ªå·±æ„é€ çš„ï¼Œæ•°æ®ç±»å‹æ˜¯å·²çŸ¥çš„ï¼Œé€šå¸¸åœ¨å¤„ç†æ•°æ®å‰ï¼Œåº”å½“å…ˆæŸ¥çœ‹ä¸‹æ•°æ®ç»“æ„ï¼Œè½¬æ¢æˆç»Ÿä¸€æ•°æ®ç±»å‹\nprint(&quot;æ£€æŸ¥æ•°æ®é›†æ¯åˆ—çš„æ•°æ®ç±»å‹:\\n %s &quot; % foods.dtypes)\n\n# åˆ é™¤ç©ºè¡Œ\nfoods.dropna(axis=0,how=&#39;any&#39;,inplace=True)\n\n# ä½¿ç”¨sqlæ–¹å¼ç›´æ¥è¿‡æ»¤å¼‚å¸¸æ•°æ®\n\nfilterFoods = lambda sql: pandasql.sqldf(sql,globals())\nsql = &#39;select * from foods where ounces &gt; 0&#39;\nfoodsnew = filterFoods(sql)\nprint(&quot;è¿‡æ»¤æ‰å¼‚å¸¸æ•°æ®è¡Œ:\\n %s &quot; % foodsnew)\n\nfoodsnew[&#39;foodtag&#39;] = foodsnew[&#39;food&#39;].str.lower()\n\nprint(&quot;ç»Ÿä¸€é£Ÿç‰©å‘½åè§„èŒƒ:\\n %s &quot; % foodsnew)\n\n# æœ€åå¯ä»¥ä½¿ç”¨sqlè¿›è¡ŒæŒ‰ç…§foodæ’åº\nsql2 = &quot;select * from foodsnew order by food&quot;\nprint(&quot;æ¸…æ´—è¿‡åçš„æ•°æ®:\\n %s &quot; % filterFoods(sql2))\n\n\n\n","like_count":1},{"had_liked":false,"id":68236,"user_name":"è‰åŒ…é›·","can_delete":false,"product_type":"c1","uid":1158255,"ip_address":"","ucode":"A6466D21248DF5","user_header":"http://thirdwx.qlogo.cn/mmopen/vi_32/PiajxSqBRaEL8c2Tu3bibiaKQmS1rc58icJOsDKpCtYzhvMMr3YAYTHiboxCAG0CroejUibP0ALOQbzMWz6eyz49Ltcg/132","comment_is_top":false,"comment_ctime":1550463707,"is_pvip":false,"replies":null,"discussion_count":0,"race_medal":0,"score":8,"product_id":100021701,"comment_content":"import pandas as pd\ndf = pd.read_csv(&quot;c:&#47;&#47;leijin&#47;&#47;food.csv&quot;)\ndf.index\nprint (df)\n\ndf[&#39;ounces&#39;]= df[&#39;ounces&#39;].apply(lambda x: abs(x))\ndf[&#39;ounces&#39;].fillna(df[&#39;ounces&#39;].mean(),inplace=True)\n\ndf[&#39;food&#39;] = df[&#39;food&#39;].str.lower()\ndf.index=range(len(df))\n\nprint (df)\n","like_count":1},{"had_liked":false,"id":66710,"user_name":"Geek_hve78z","can_delete":false,"product_type":"c1","uid":1015045,"ip_address":"","ucode":"386803B8FC2DD5","user_header":"https://static001.geekbang.org/account/avatar/00/0f/7d/05/4bad0c7c.jpg","comment_is_top":false,"comment_ctime":1549984896,"is_pvip":false,"replies":null,"discussion_count":0,"race_medal":0,"score":8,"product_id":100021701,"comment_content":"##ä½œä¸š\n\nimport pandas as pd\ndf=pd.read_csv(&#39;ç¬¬11èŠ‚æ•°æ®-2.csv&#39;)\n\n## foodä¸€åˆ—ï¼Œç»Ÿä¸€å˜ä¸ºå°å†™å­—æ¯\ndf[&#39;food&#39;]=df[&#39;food&#39;].str.lower()\n\n##åˆ é™¤é‡é‡ä¸ºç©ºå€¼çš„ä¸€è¡Œ\ndf=df.dropna()\n\n##æŠŠouncesåˆ—ä¸­è´Ÿæ•°è½¬æ¢ä¸ºæ­£æ•°\ndf[&#39;ounces&#39;]=df[&#39;ounces&#39;].apply(lambda x:abs(x))\n\n#é‡æ–°æ’åˆ—åºå·\ndf.index=range(len(df))\ndf","like_count":1},{"had_liked":false,"id":62742,"user_name":"èƒ–çŒ«","can_delete":false,"product_type":"c1","uid":1056791,"ip_address":"","ucode":"266AFE93BBBC78","user_header":"https://static001.geekbang.org/account/avatar/00/10/20/17/6ec9ae65.jpg","comment_is_top":false,"comment_ctime":1548146607,"is_pvip":false,"replies":null,"discussion_count":0,"race_medal":0,"score":8,"product_id":100021701,"comment_content":"#mac python3.6\nimport pandas as pd\n\ndf = pd.read_excel(&quot;.&#47;home_11.xlsx&quot;)\n\ndf.dropna(how=&quot;all&quot;, inplace=True)\ndf[&#39;food&#39;] = df[&#39;food&#39;].str.capitalize()\ndf[&#39;ounces&#39;] = df[&#39;ounces&#39;].apply(lambda x : abs(x))\ndf.fillna(df[&#39;ounces&#39;].mean(), inplace=True)\ndf.drop_duplicates(&#39;food&#39;, inplace=True)\nprint(df)\ndf.to_excel(&quot;.&#47;home_11_washed.xlsx&quot;)","like_count":1},{"had_liked":false,"id":59984,"user_name":"é›¨å…ˆç”Ÿçš„æ™´å¤©","can_delete":false,"product_type":"c1","uid":1246015,"ip_address":"","ucode":"71850548322A1C","user_header":"https://static001.geekbang.org/account/avatar/00/13/03/3f/09308258.jpg","comment_is_top":false,"comment_ctime":1547434962,"is_pvip":false,"replies":null,"discussion_count":0,"race_medal":0,"score":8,"product_id":100021701,"comment_content":"è€å¸ˆ ä½ å¥½ï¼ŒæŒ‰ç…§æ‚¨çš„æ–¹æ³•æˆ‘æ¸…ç†ä¸€ä¸‹æ•°æ®ï¼Œæœ‰ä¸€äº›ç–‘æƒ‘ï¼Œå¸Œæœ›èƒ½æŒ‡æ­£ã€‚\nåœ¨ â€˜æœè£…åº—ç»Ÿè®¡çš„ä¼šå‘˜æ•°æ®â€™ ä¾‹å­ æœ€ç»ˆæ¸…æ´—æˆªå›¾ä¸­ï¼Œæœ€åæˆªå›¾ä¸­ï¼Œ\nNo.1 ä¸ºä»€ä¹ˆ Huey McDuck å‡ºç°äº†ä¸¤æ¬¡ï¼Ÿ \nNo.2 ä¸ºä»€ä¹ˆ Donald Duck çš„ä½“é‡æ•°æ® æ²¡æœ‰è½¬åŒ–æˆKgs?  \næˆ‘è¯•ç€æŒ‰ç…§ä¾‹å­ï¼Œè‡ªå·±åšäº†ä¸€è¾¹ï¼Œå‘ç°ä»¥ä¸‹ä»£ç ï¼Œä¹‹ä¿®æ”¹æˆåŠŸäº† Huey McDuckçš„ä½“é‡æ•°æ®ï¼Œ189lbs=85kg, \n\nrows_with_lbs=df[&#39;weight&#39;].str.contains(&#39;lbs&#39;).fillna(False)\nprint df[rows_with_lbs]\nweight = int(float(lbs_row[&#39;weight&#39;][:-3])&#47;2.2)\ndf.at[i,&#39;weight&#39;]=&#39;{}kgs&#39;.format(weight)\næœ›æ‚¨æŒ‡æ­£","like_count":1},{"had_liked":false,"id":57685,"user_name":"caidy","can_delete":false,"product_type":"c1","uid":1188783,"ip_address":"","ucode":"AEFB529C32C7EE","user_header":"https://static001.geekbang.org/account/avatar/00/12/23/af/84f4714e.jpg","comment_is_top":false,"comment_ctime":1546868631,"is_pvip":false,"replies":null,"discussion_count":0,"race_medal":0,"score":8,"product_id":100021701,"comment_content":"æ ¹æ®å®Œå…¨åˆä¸€å¯¹æ•°æ®è¿›è¡Œæ¸…æ´—\n1. æŠŠæœ‰ç¼ºçœå€¼çš„åˆ æ‰\n2. é‡é‡éœ€è¦æ˜¯æ­£å€¼ï¼ŒæŠŠè´Ÿæ•°çš„å–ç»å¯¹å€¼\n3. æŠŠåç§°å“ªä¸€ç±»éƒ½æ”¹ä¸ºå°å†™\n4. å»é™¤é‡å¤è¡Œï¼Œæˆ–è€…å› ä¸ºæ˜¯é£Ÿç‰©ï¼Œå¯ä»¥æŠŠåŒæ ·åå­—çš„é£Ÿç‰©åŠ èµ·æ¥åˆæˆä¸€è¡Œ","like_count":1},{"had_liked":false,"id":57648,"user_name":"Viola","can_delete":false,"product_type":"c1","uid":1245457,"ip_address":"","ucode":"7E2E1A7654D877","user_header":"","comment_is_top":false,"comment_ctime":1546858912,"is_pvip":false,"replies":null,"discussion_count":0,"race_medal":0,"score":8,"product_id":100021701,"comment_content":"df[&#39;Age&#39;].fillna(df[&#39;Age&#39;].mean(), inplace=True)\nè€å¸ˆå¥½, å¯¹äºæ–‡ä¸­çš„ä¾‹å­ï¼Œè‡ªå·±æ‰‹åŠ¨å°è¯•äº†ä¸‹ï¼Œå‘ç°å¹¶ä¸èƒ½è¿è¡ŒæˆåŠŸï¼Œæ‰€ä»¥æœ‰ä¸ªç–‘é—®ï¼Œ\nåœ¨&#39;Age&#39;åˆ—æ•°æ®æ¸…æ´—å‰ï¼Œè¿˜å­˜åœ¨NANï¼Œè¿™æ ·å»è®¡ç®—å¹³å‡å€¼ï¼ˆdf[&#39;Age&#39;].mean())ï¼Œå¯è¡Œå—ï¼Ÿ\nå¦å¤–æœ‰ä¸ªå»ºè®®ï¼šå¦‚æœæ–‡ä¸­æ¶‰åŠåˆ°å¯¹æ•°æ®çš„å¤„ç†ï¼Œå¯å¦æŠŠæ•°æ®æ–‡ä»¶ä»¥é™„ä»¶æˆ–githubé“¾æ¥çš„å½¢å¼ç»™å‡ºæ¥ï¼Œæ–¹ä¾¿æˆ‘ä»¬å­¦ä¹ å‘¢ï¼Ÿ","like_count":1},{"had_liked":false,"id":57605,"user_name":"è·³è·³","can_delete":false,"product_type":"c1","uid":1172803,"ip_address":"","ucode":"80B697B89E1A0B","user_header":"https://static001.geekbang.org/account/avatar/00/11/e5/43/7bc7cfe3.jpg","comment_is_top":false,"comment_ctime":1546846721,"is_pvip":false,"replies":null,"discussion_count":0,"race_medal":0,"score":8,"product_id":100021701,"comment_content":"1.ä»å®Œæ•´æ€§è€ƒè™‘ï¼Œæœ‰ç¼ºå¤±å€¼ã€‚å¯ä»¥å¡«å……å¹³å‡å€¼\n2.ä»å…¨é¢æ€§è€ƒè™‘ï¼Œfoodåˆ—é¦–å­—æ¯å¤§å°å†™ä¸ç»Ÿä¸€ï¼Œå»ºè®®è§„èŒƒ\n3.ä»åˆç†æ€§è€ƒè™‘ï¼Œå­˜åœ¨è´Ÿå€¼ï¼Œä¿®æ”¹ä¸ºæ­£å€¼\n4.ä»å”¯ä¸€æ€§è€ƒè™‘æœ‰ä¸‰ä¸ªbaconï¼Œä½†æ˜¯ounceså­˜åœ¨ä¸ä¸€è‡´ï¼Œè€ƒè™‘å»æ‰å«NANçš„åˆ—","like_count":1},{"had_liked":false,"id":57537,"user_name":"Alexander","can_delete":false,"product_type":"c1","uid":1187008,"ip_address":"","ucode":"40226A2A3BCBC3","user_header":"https://static001.geekbang.org/account/avatar/00/12/1c/c0/25c15f45.jpg","comment_is_top":false,"comment_ctime":1546830445,"is_pvip":false,"replies":null,"discussion_count":0,"race_medal":0,"score":8,"product_id":100021701,"comment_content":"https:&#47;&#47;mubu.com&#47;doc&#47;7maWZgX_Gg\næœ‰ç©ºå€¼ï¼Œé‡å¤å€¼ï¼Œé”™å€¼\nå…ˆåˆ æ‰é‡å¤å€¼ï¼Œç„¶åæŠŠç›å¸ç”¨ç»å¯¹å€¼éƒ½å˜æˆæ­£æ•°ï¼Œå¹³å‡&#47;ä¸­ä½&#47;ä¼—æ•°å¡«å……ç©ºå€¼","like_count":1},{"had_liked":false,"id":392772,"user_name":"èƒ¡è¶…","can_delete":false,"product_type":"c1","uid":1259236,"ip_address":"å¹¿ä¸œ","ucode":"C2C2AA341F854C","user_header":"https://static001.geekbang.org/account/avatar/00/13/36/e4/f24efa91.jpg","comment_is_top":false,"comment_ctime":1721731424,"is_pvip":false,"replies":null,"discussion_count":0,"race_medal":0,"score":8,"product_id":100021701,"comment_content":"# ä¸€ã€å¯¹ç¼ºå¤±çš„å­—æ®µè¿›è¡Œå¡«å…… ,min-æœ€å°å€¼æ›¿ä»£ï¼Œmean() - å¹³å‡å€¼ï¼Œ max() - æœ€å¤§å€¼\n    df[&#39;Ounces&#39;].fillna(df[&#39;Ounces&#39;].min(), inplace=True)\n\n    # ç»Ÿä¸€è°ƒæ•´ä¸ºå°å†™\n    df[&quot;Food&quot;] = df[&#39;Food&#39;].str.lower()\n\n    # è´Ÿæ•°è½¬ä¸ºç»å¯¹å€¼\n    df[&#39;Ounces&#39;] = df[&#39;Ounces&#39;].abs()\n\n    # æ ¹æ® Food å’Œ Animal åˆ—è¿›è¡Œæ±‡æ€»ï¼ŒOunces åˆ—æ±‚å’Œ\n    df = df.groupby([&#39;Food&#39;, &#39;Animal&#39;], as_index=False)[&#39;Ounces&#39;].sum()","like_count":0},{"had_liked":false,"id":366912,"user_name":"é•¿æ¯›æ€ª^^","can_delete":false,"product_type":"c1","uid":1901268,"ip_address":"æ–°ç–†","ucode":"A99F5F0F788641","user_header":"https://static001.geekbang.org/account/avatar/00/1d/02/d4/947cfdfb.jpg","comment_is_top":false,"comment_ctime":1674581127,"is_pvip":false,"replies":null,"discussion_count":0,"race_medal":0,"score":8,"product_id":100021701,"comment_content":"è¿™å‡ ä¸ªé—®é¢˜æœ‰æ²¡æœ‰å¤„ç†çš„é¡ºåºå‘¢ï¼Ÿæˆ–è€…è¯´ä¸€èˆ¬æƒ…å†µä¸‹ï¼ŒæŒ‰ä»€ä¹ˆé¡ºåºä¸‹å¤„ç†ä¸ä¼šæœ‰éšæ‚£å‘¢ï¼Ÿ","like_count":0},{"had_liked":false,"id":68236,"user_name":"è‰åŒ…é›·","can_delete":false,"product_type":"c1","uid":1158255,"ip_address":"","ucode":"A6466D21248DF5","user_header":"http://thirdwx.qlogo.cn/mmopen/vi_32/PiajxSqBRaEL8c2Tu3bibiaKQmS1rc58icJOsDKpCtYzhvMMr3YAYTHiboxCAG0CroejUibP0ALOQbzMWz6eyz49Ltcg/132","comment_is_top":false,"comment_ctime":1550463707,"is_pvip":false,"replies":null,"discussion_count":0,"race_medal":0,"score":8,"product_id":100021701,"comment_content":"import pandas as pd\ndf = pd.read_csv(&quot;c:&#47;&#47;leijin&#47;&#47;food.csv&quot;)\ndf.index\nprint (df)\n\ndf[&#39;ounces&#39;]= df[&#39;ounces&#39;].apply(lambda x: abs(x))\ndf[&#39;ounces&#39;].fillna(df[&#39;ounces&#39;].mean(),inplace=True)\n\ndf[&#39;food&#39;] = df[&#39;food&#39;].str.lower()\ndf.index=range(len(df))\n\nprint (df)\n","like_count":1},{"had_liked":false,"id":66710,"user_name":"Geek_hve78z","can_delete":false,"product_type":"c1","uid":1015045,"ip_address":"","ucode":"386803B8FC2DD5","user_header":"https://static001.geekbang.org/account/avatar/00/0f/7d/05/4bad0c7c.jpg","comment_is_top":false,"comment_ctime":1549984896,"is_pvip":false,"replies":null,"discussion_count":0,"race_medal":0,"score":8,"product_id":100021701,"comment_content":"##ä½œä¸š\n\nimport pandas as pd\ndf=pd.read_csv(&#39;ç¬¬11èŠ‚æ•°æ®-2.csv&#39;)\n\n## foodä¸€åˆ—ï¼Œç»Ÿä¸€å˜ä¸ºå°å†™å­—æ¯\ndf[&#39;food&#39;]=df[&#39;food&#39;].str.lower()\n\n##åˆ é™¤é‡é‡ä¸ºç©ºå€¼çš„ä¸€è¡Œ\ndf=df.dropna()\n\n##æŠŠouncesåˆ—ä¸­è´Ÿæ•°è½¬æ¢ä¸ºæ­£æ•°\ndf[&#39;ounces&#39;]=df[&#39;ounces&#39;].apply(lambda x:abs(x))\n\n#é‡æ–°æ’åˆ—åºå·\ndf.index=range(len(df))\ndf","like_count":1},{"had_liked":false,"id":62742,"user_name":"èƒ–çŒ«","can_delete":false,"product_type":"c1","uid":1056791,"ip_address":"","ucode":"266AFE93BBBC78","user_header":"https://static001.geekbang.org/account/avatar/00/10/20/17/6ec9ae65.jpg","comment_is_top":false,"comment_ctime":1548146607,"is_pvip":false,"replies":null,"discussion_count":0,"race_medal":0,"score":8,"product_id":100021701,"comment_content":"#mac python3.6\nimport pandas as pd\n\ndf = pd.read_excel(&quot;.&#47;home_11.xlsx&quot;)\n\ndf.dropna(how=&quot;all&quot;, inplace=True)\ndf[&#39;food&#39;] = df[&#39;food&#39;].str.capitalize()\ndf[&#39;ounces&#39;] = df[&#39;ounces&#39;].apply(lambda x : abs(x))\ndf.fillna(df[&#39;ounces&#39;].mean(), inplace=True)\ndf.drop_duplicates(&#39;food&#39;, inplace=True)\nprint(df)\ndf.to_excel(&quot;.&#47;home_11_washed.xlsx&quot;)","like_count":1},{"had_liked":false,"id":59984,"user_name":"é›¨å…ˆç”Ÿçš„æ™´å¤©","can_delete":false,"product_type":"c1","uid":1246015,"ip_address":"","ucode":"71850548322A1C","user_header":"https://static001.geekbang.org/account/avatar/00/13/03/3f/09308258.jpg","comment_is_top":false,"comment_ctime":1547434962,"is_pvip":false,"replies":null,"discussion_count":0,"race_medal":0,"score":8,"product_id":100021701,"comment_content":"è€å¸ˆ ä½ å¥½ï¼ŒæŒ‰ç…§æ‚¨çš„æ–¹æ³•æˆ‘æ¸…ç†ä¸€ä¸‹æ•°æ®ï¼Œæœ‰ä¸€äº›ç–‘æƒ‘ï¼Œå¸Œæœ›èƒ½æŒ‡æ­£ã€‚\nåœ¨ â€˜æœè£…åº—ç»Ÿè®¡çš„ä¼šå‘˜æ•°æ®â€™ ä¾‹å­ æœ€ç»ˆæ¸…æ´—æˆªå›¾ä¸­ï¼Œæœ€åæˆªå›¾ä¸­ï¼Œ\nNo.1 ä¸ºä»€ä¹ˆ Huey McDuck å‡ºç°äº†ä¸¤æ¬¡ï¼Ÿ \nNo.2 ä¸ºä»€ä¹ˆ Donald Duck çš„ä½“é‡æ•°æ® æ²¡æœ‰è½¬åŒ–æˆKgs?  \næˆ‘è¯•ç€æŒ‰ç…§ä¾‹å­ï¼Œè‡ªå·±åšäº†ä¸€è¾¹ï¼Œå‘ç°ä»¥ä¸‹ä»£ç ï¼Œä¹‹ä¿®æ”¹æˆåŠŸäº† Huey McDuckçš„ä½“é‡æ•°æ®ï¼Œ189lbs=85kg, \n\nrows_with_lbs=df[&#39;weight&#39;].str.contains(&#39;lbs&#39;).fillna(False)\nprint df[rows_with_lbs]\nweight = int(float(lbs_row[&#39;weight&#39;][:-3])&#47;2.2)\ndf.at[i,&#39;weight&#39;]=&#39;{}kgs&#39;.format(weight)\næœ›æ‚¨æŒ‡æ­£","like_count":1},{"had_liked":false,"id":57685,"user_name":"caidy","can_delete":false,"product_type":"c1","uid":1188783,"ip_address":"","ucode":"AEFB529C32C7EE","user_header":"https://static001.geekbang.org/account/avatar/00/12/23/af/84f4714e.jpg","comment_is_top":false,"comment_ctime":1546868631,"is_pvip":false,"replies":null,"discussion_count":0,"race_medal":0,"score":8,"product_id":100021701,"comment_content":"æ ¹æ®å®Œå…¨åˆä¸€å¯¹æ•°æ®è¿›è¡Œæ¸…æ´—\n1. æŠŠæœ‰ç¼ºçœå€¼çš„åˆ æ‰\n2. é‡é‡éœ€è¦æ˜¯æ­£å€¼ï¼ŒæŠŠè´Ÿæ•°çš„å–ç»å¯¹å€¼\n3. æŠŠåç§°å“ªä¸€ç±»éƒ½æ”¹ä¸ºå°å†™\n4. å»é™¤é‡å¤è¡Œï¼Œæˆ–è€…å› ä¸ºæ˜¯é£Ÿç‰©ï¼Œå¯ä»¥æŠŠåŒæ ·åå­—çš„é£Ÿç‰©åŠ èµ·æ¥åˆæˆä¸€è¡Œ","like_count":1},{"had_liked":false,"id":57648,"user_name":"Viola","can_delete":false,"product_type":"c1","uid":1245457,"ip_address":"","ucode":"7E2E1A7654D877","user_header":"","comment_is_top":false,"comment_ctime":1546858912,"is_pvip":false,"replies":null,"discussion_count":0,"race_medal":0,"score":8,"product_id":100021701,"comment_content":"df[&#39;Age&#39;].fillna(df[&#39;Age&#39;].mean(), inplace=True)\nè€å¸ˆå¥½, å¯¹äºæ–‡ä¸­çš„ä¾‹å­ï¼Œè‡ªå·±æ‰‹åŠ¨å°è¯•äº†ä¸‹ï¼Œå‘ç°å¹¶ä¸èƒ½è¿è¡ŒæˆåŠŸï¼Œæ‰€ä»¥æœ‰ä¸ªç–‘é—®ï¼Œ\nåœ¨&#39;Age&#39;åˆ—æ•°æ®æ¸…æ´—å‰ï¼Œè¿˜å­˜åœ¨NANï¼Œè¿™æ ·å»è®¡ç®—å¹³å‡å€¼ï¼ˆdf[&#39;Age&#39;].mean())ï¼Œå¯è¡Œå—ï¼Ÿ\nå¦å¤–æœ‰ä¸ªå»ºè®®ï¼šå¦‚æœæ–‡ä¸­æ¶‰åŠåˆ°å¯¹æ•°æ®çš„å¤„ç†ï¼Œå¯å¦æŠŠæ•°æ®æ–‡ä»¶ä»¥é™„ä»¶æˆ–githubé“¾æ¥çš„å½¢å¼ç»™å‡ºæ¥ï¼Œæ–¹ä¾¿æˆ‘ä»¬å­¦ä¹ å‘¢ï¼Ÿ","like_count":1},{"had_liked":false,"id":57605,"user_name":"è·³è·³","can_delete":false,"product_type":"c1","uid":1172803,"ip_address":"","ucode":"80B697B89E1A0B","user_header":"https://static001.geekbang.org/account/avatar/00/11/e5/43/7bc7cfe3.jpg","comment_is_top":false,"comment_ctime":1546846721,"is_pvip":false,"replies":null,"discussion_count":0,"race_medal":0,"score":8,"product_id":100021701,"comment_content":"1.ä»å®Œæ•´æ€§è€ƒè™‘ï¼Œæœ‰ç¼ºå¤±å€¼ã€‚å¯ä»¥å¡«å……å¹³å‡å€¼\n2.ä»å…¨é¢æ€§è€ƒè™‘ï¼Œfoodåˆ—é¦–å­—æ¯å¤§å°å†™ä¸ç»Ÿä¸€ï¼Œå»ºè®®è§„èŒƒ\n3.ä»åˆç†æ€§è€ƒè™‘ï¼Œå­˜åœ¨è´Ÿå€¼ï¼Œä¿®æ”¹ä¸ºæ­£å€¼\n4.ä»å”¯ä¸€æ€§è€ƒè™‘æœ‰ä¸‰ä¸ªbaconï¼Œä½†æ˜¯ounceså­˜åœ¨ä¸ä¸€è‡´ï¼Œè€ƒè™‘å»æ‰å«NANçš„åˆ—","like_count":1},{"had_liked":false,"id":57537,"user_name":"Alexander","can_delete":false,"product_type":"c1","uid":1187008,"ip_address":"","ucode":"40226A2A3BCBC3","user_header":"https://static001.geekbang.org/account/avatar/00/12/1c/c0/25c15f45.jpg","comment_is_top":false,"comment_ctime":1546830445,"is_pvip":false,"replies":null,"discussion_count":0,"race_medal":0,"score":8,"product_id":100021701,"comment_content":"https:&#47;&#47;mubu.com&#47;doc&#47;7maWZgX_Gg\næœ‰ç©ºå€¼ï¼Œé‡å¤å€¼ï¼Œé”™å€¼\nå…ˆåˆ æ‰é‡å¤å€¼ï¼Œç„¶åæŠŠç›å¸ç”¨ç»å¯¹å€¼éƒ½å˜æˆæ­£æ•°ï¼Œå¹³å‡&#47;ä¸­ä½&#47;ä¼—æ•°å¡«å……ç©ºå€¼","like_count":1},{"had_liked":false,"id":392772,"user_name":"èƒ¡è¶…","can_delete":false,"product_type":"c1","uid":1259236,"ip_address":"å¹¿ä¸œ","ucode":"C2C2AA341F854C","user_header":"https://static001.geekbang.org/account/avatar/00/13/36/e4/f24efa91.jpg","comment_is_top":false,"comment_ctime":1721731424,"is_pvip":false,"replies":null,"discussion_count":0,"race_medal":0,"score":8,"product_id":100021701,"comment_content":"# ä¸€ã€å¯¹ç¼ºå¤±çš„å­—æ®µè¿›è¡Œå¡«å…… ,min-æœ€å°å€¼æ›¿ä»£ï¼Œmean() - å¹³å‡å€¼ï¼Œ max() - æœ€å¤§å€¼\n    df[&#39;Ounces&#39;].fillna(df[&#39;Ounces&#39;].min(), inplace=True)\n\n    # ç»Ÿä¸€è°ƒæ•´ä¸ºå°å†™\n    df[&quot;Food&quot;] = df[&#39;Food&#39;].str.lower()\n\n    # è´Ÿæ•°è½¬ä¸ºç»å¯¹å€¼\n    df[&#39;Ounces&#39;] = df[&#39;Ounces&#39;].abs()\n\n    # æ ¹æ® Food å’Œ Animal åˆ—è¿›è¡Œæ±‡æ€»ï¼ŒOunces åˆ—æ±‚å’Œ\n    df = df.groupby([&#39;Food&#39;, &#39;Animal&#39;], as_index=False)[&#39;Ounces&#39;].sum()","like_count":0},{"had_liked":false,"id":366912,"user_name":"é•¿æ¯›æ€ª^^","can_delete":false,"product_type":"c1","uid":1901268,"ip_address":"æ–°ç–†","ucode":"A99F5F0F788641","user_header":"https://static001.geekbang.org/account/avatar/00/1d/02/d4/947cfdfb.jpg","comment_is_top":false,"comment_ctime":1674581127,"is_pvip":false,"replies":null,"discussion_count":0,"race_medal":0,"score":8,"product_id":100021701,"comment_content":"è¿™å‡ ä¸ªé—®é¢˜æœ‰æ²¡æœ‰å¤„ç†çš„é¡ºåºå‘¢ï¼Ÿæˆ–è€…è¯´ä¸€èˆ¬æƒ…å†µä¸‹ï¼ŒæŒ‰ä»€ä¹ˆé¡ºåºä¸‹å¤„ç†ä¸ä¼šæœ‰éšæ‚£å‘¢ï¼Ÿ","like_count":0},{"had_liked":false,"id":351995,"user_name":"xiong","can_delete":false,"product_type":"c1","uid":1099375,"ip_address":"","ucode":"C1BFD9EF96372F","user_header":"https://static001.geekbang.org/account/avatar/00/10/c6/6f/ac3003fa.jpg","comment_is_top":false,"comment_ctime":1658317624,"is_pvip":false,"replies":null,"discussion_count":0,"race_medal":0,"score":9,"product_id":100021701,"comment_content":"å½“æ•°æ®é‡è¿‡å¤§çš„æ—¶å€™ï¼Œå¦‚ä½•åšæ•°æ®å®¡æŸ¥å‘¢ï¼Ÿ","like_count":0},{"had_liked":false,"id":334601,"user_name":"RecordLiu","can_delete":false,"product_type":"c1","uid":1252206,"ip_address":"","ucode":"41178CC21337FB","user_header":"https://static001.geekbang.org/account/avatar/00/13/1b/6e/cd8fea9f.jpg","comment_is_top":false,"comment_ctime":1645014460,"is_pvip":false,"replies":null,"discussion_count":0,"race_medal":0,"score":9,"product_id":100021701,"comment_content":"ä½¿ç”¨è€å¸ˆè¯¾ç¨‹ä¸­è®²åˆ°çš„å®Œå…¨åˆä¸€è§„åˆ™ï¼Œå‘ç°äº†ä»¥ä¸‹é—®é¢˜ï¼š\n1.1.ouncesåˆ—å­˜åœ¨NaNå€¼å’Œè´Ÿæ•°\n2.foodåˆ—é¦–å­—æ¯å¤§å°å†™ä¸ç»Ÿä¸€\n\nä¸»è¦æ•°æ®ä¿¡æ¯ä»£ç å¦‚ä¸‹:\ndef func_abs(df):\n    return abs(df[&#39;ounces&#39;])\n\ndf[&#39;ounces&#39;] = df.apply(func_abs,axis=1)\n\n#ä½¿ç”¨ouncesçš„å¹³å‡å€¼è¿›è¡Œå¡«å……Nullå€¼\ndf[&#39;ounces&#39;].fillna(df[&#39;ounces&#39;].mean(),inplace=True)\n\n#ç»Ÿä¸€foodåˆ—ä¸ºå°å†™\ndf[&#39;food&#39;] = df[&#39;food&#39;].str.lower()","like_count":0},{"had_liked":false,"id":326639,"user_name":"Ronin","can_delete":false,"product_type":"c1","uid":2657638,"ip_address":"","ucode":"6A4AF619EDFD70","user_header":"https://static001.geekbang.org/account/avatar/00/28/8d/66/89202762.jpg","comment_is_top":false,"comment_ctime":1639615920,"is_pvip":false,"replies":null,"discussion_count":0,"race_medal":0,"score":9,"product_id":100021701,"comment_content":"1.å®Œæ•´æ€§ï¼šç¬¬ä¸‰è¡Œounceså­˜åœ¨ç¼ºå¤±å€¼ï¼Œç”¨æ‰€æœ‰åˆ—çš„å¹³å‡å€¼è¿›è¡Œå¡«å……ï¼›\n2.å…¨é¢æ€§ï¼šfoodå±æ€§å¤§å°å†™ä¸ç»Ÿä¸€ï¼Œå…¨éƒ¨æ”¹ä¸ºå°å†™ï¼›\n3.åˆç†æ€§ï¼šç¬¬ä¸ƒè¡Œouncesä¸ºè´Ÿå€¼ï¼Œå–ç»å¯¹å€¼å³å¯ï¼›\n4.å”¯ä¸€æ€§ï¼šå­˜åœ¨foodå’Œanimalç›¸åŒçš„æ•°æ®ï¼Œå°†è¿™äº›æ•°æ®åˆå¹¶ï¼Œå–è¿™å‡ æ¡æ•°æ®ouncesçš„å‡å€¼ä½œä¸ºåˆå¹¶åçš„ouncesã€‚","like_count":0},{"had_liked":false,"id":310490,"user_name":"Kai","can_delete":false,"product_type":"c1","uid":1349659,"ip_address":"","ucode":"1930EED4331EEE","user_header":"https://static001.geekbang.org/account/avatar/00/14/98/1b/4a48bc4f.jpg","comment_is_top":false,"comment_ctime":1630677068,"is_pvip":false,"replies":null,"discussion_count":0,"race_medal":0,"score":9,"product_id":100021701,"comment_content":"import pandas as pd\n\n# Read data from csv, using regular expression to remove whitespaces\ndf = pd.read_csv(&#39;.&#47;11-exercise.csv&#39;, sep=r&#39;\\s*,\\s*&#39;, engine=&#39;python&#39;)\n\n# Lowercase all name in the food column\ndf[&#39;food&#39;] = df[&#39;food&#39;].str.lower()\n\n# Drop rows which have NaN value\ndf.dropna(inplace=True)\n\n# Use abs method to remove negative ounce value\ndf[&#39;ounces&#39;] = df[&#39;ounces&#39;].apply(abs)\n\n# Aggregate the ounces by name\ndf = df.groupby(df[&#39;food&#39;]).aggregate(\n    {&#39;food&#39;: &#39;first&#39;, &#39;ounces&#39;: &#39;sum&#39;, &#39;animal&#39;: &#39;first&#39;})\n\ndf.index = range(len(df))\n\nFinal output\n          food  ounces  animal\n0        bacon    12.0     pig\n1  corned beef     7.5     cow\n2    honey ham     5.0     pig\n3     nova lox     6.0  salmon\n4     pastrami     9.0     cow\n5  pulled pork     3.0     pig","like_count":0},{"had_liked":false,"id":302473,"user_name":"KokutoDa","can_delete":false,"product_type":"c1","uid":1189534,"ip_address":"","ucode":"2561207E84840E","user_header":"https://static001.geekbang.org/account/avatar/00/12/26/9e/836f603b.jpg","comment_is_top":false,"comment_ctime":1626233249,"is_pvip":false,"replies":null,"discussion_count":0,"race_medal":0,"score":9,"product_id":100021701,"comment_content":"è€å¸ˆï¼Œæ•°æ®å‡†å†Œçš„ã€Œåˆç†æ€§ã€å’Œã€Œå…¨é¢æ€§ã€æˆ‘æ„Ÿè§‰è¿™ä¿©å·®ä¸å¤šï¼Œå¸¸è¯†åˆ¤æ–­æ˜¯å¦åˆç†ã€‚æœ‰ä»€ä¹ˆåŒºåˆ«å—ï¼Ÿ","like_count":0},{"had_liked":false,"id":295028,"user_name":"yang","can_delete":false,"product_type":"c1","uid":1940562,"ip_address":"","ucode":"67C86E09BA6E4B","user_header":"https://static001.geekbang.org/account/avatar/00/1d/9c/52/dc770378.jpg","comment_is_top":false,"comment_ctime":1622189056,"is_pvip":false,"replies":null,"discussion_count":0,"race_medal":0,"score":9,"product_id":100021701,"comment_content":"æ¸…æ´—çš„è¯ï¼ŒæŠŠounceså°äºé›¶çš„å’Œç©ºå€¼çš„è¡Œå»æ‰ã€‚","like_count":0},{"had_liked":false,"id":289623,"user_name":"Vimà¹‘Âºà¸±","can_delete":false,"product_type":"c1","uid":2312293,"ip_address":"","ucode":"350C87C7AB96DC","user_header":"https://static001.geekbang.org/account/avatar/00/23/48/65/e8274238.jpg","comment_is_top":false,"comment_ctime":1619101570,"is_pvip":false,"replies":null,"discussion_count":0,"race_medal":0,"score":9,"product_id":100021701,"comment_content":"#python 3\n&quot;&quot;&quot;\nCreated on Thu Apr 22 21:41:13 2021\n\n@author: Yukka\næ•°æ®é—®é¢˜\n\n1.å®Œæ•´æ€§\nounces åˆ—å­˜åœ¨ç©ºå€¼--å»é™¤æ•°æ®\n2.å…¨é¢æ€§\nfoodå¤§å°å†™ä¸ä¸€è‡´--æ”¹ä¸ºä¸€è‡´ï¼Œï¼Œå¹¶åˆå¹¶æ•°æ®\n3.åˆç†æ€§\nè´Ÿå€¼--æ”¹ä¸ºæ­£å€¼\n4.å”¯ä¸€æ€§\nbaconï¼Œpastramié‡å¤å€¼--å°†foodå’Œanimalåˆ—å‡ç›¸åŒåˆ—æ•°æ®è¿›è¡Œåˆå¹¶\n&quot;&quot;&quot;\nimport pandas as pd\n#æ­¥éª¤ä¸€ å¯¼å…¥æ•°æ®æº\ndf = pd.read_csv(&quot;food-clean.csv&quot;)\nprint(&quot;åŸæ•°æ®\\n&quot;,df)\n#æ­¥éª¤äºŒ å°†ouncesåˆ—ç©ºå€¼ç”¨å‡å€¼å¡«å……\ndf[&#39;ounces&#39;].fillna(df[&#39;ounces&#39;].mean(), inplace=True)\nprint(&quot;ç©ºå€¼å¤„ç†\\n&quot;,df)\n#æ­¥éª¤ä¸‰ foodåˆ— å¤§å°å†™ä¸€è‡´æ”¹ä¸ºå°å†™\ndf[&#39;food&#39;]=df[&#39;food&#39;].str.lower()\nprint(&quot;å°å†™å¤„ç†\\n&quot;,df)\n#æ­¥éª¤å›› è´Ÿæ•°æ­£å¤„ç†\ndf[&#39;ounces&#39;]=df[&#39;ounces&#39;].abs() \nprint(&quot;è´Ÿæ•°æ­£å¤„ç†\\n&quot;,df)\n#æ­¥éª¤äº” é‡å¤å€¼baconï¼Œpastrami åˆ é™¤\ndf.drop_duplicates([&#39;food&#39;],inplace=True)\nprint(&quot;é‡å¤å€¼åˆ é™¤\\n&quot;,df)","like_count":0},{"had_liked":false,"id":289622,"user_name":"Vimà¹‘Âºà¸±","can_delete":false,"product_type":"c1","uid":2312293,"ip_address":"","ucode":"350C87C7AB96DC","user_header":"https://static001.geekbang.org/account/avatar/00/23/48/65/e8274238.jpg","comment_is_top":false,"comment_ctime":1619101538,"is_pvip":false,"replies":null,"discussion_count":0,"race_medal":0,"score":9,"product_id":100021701,"comment_content":"# -*- coding: utf-8 -*-\n&quot;&quot;&quot;\nCreated on Thu Apr 22 21:41:13 2021\n\n@author: Yukka\næ•°æ®é—®é¢˜\n\n1.å®Œæ•´æ€§\nounces åˆ—å­˜åœ¨ç©ºå€¼--å»é™¤æ•°æ®\n2.å…¨é¢æ€§\nfoodå¤§å°å†™ä¸ä¸€è‡´--æ”¹ä¸ºä¸€è‡´ï¼Œï¼Œå¹¶åˆå¹¶æ•°æ®\n3.åˆç†æ€§\nè´Ÿå€¼--æ”¹ä¸ºæ­£å€¼\n4.å”¯ä¸€æ€§\nbaconï¼Œpastramié‡å¤å€¼--å°†foodå’Œanimalåˆ—å‡ç›¸åŒåˆ—æ•°æ®è¿›è¡Œåˆå¹¶\n&quot;&quot;&quot;\nimport pandas as pd\n#æ­¥éª¤ä¸€ å¯¼å…¥æ•°æ®æº\ndf = pd.read_csv(&quot;food-clean.csv&quot;)\nprint(&quot;åŸæ•°æ®\\n&quot;,df)\n#æ­¥éª¤äºŒ å°†ouncesåˆ—ç©ºå€¼ç”¨å‡å€¼å¡«å……\ndf[&#39;ounces&#39;].fillna(df[&#39;ounces&#39;].mean(), inplace=True)\nprint(&quot;ç©ºå€¼å¤„ç†\\n&quot;,df)\n#æ­¥éª¤ä¸‰ foodåˆ— å¤§å°å†™ä¸€è‡´æ”¹ä¸ºå°å†™\ndf[&#39;food&#39;]=df[&#39;food&#39;].str.lower()\nprint(&quot;å°å†™å¤„ç†\\n&quot;,df)\n#æ­¥éª¤å›› è´Ÿæ•°æ­£å¤„ç†\ndf[&#39;ounces&#39;]=df[&#39;ounces&#39;].abs() \nprint(&quot;è´Ÿæ•°æ­£å¤„ç†\\n&quot;,df)\n#æ­¥éª¤äº” é‡å¤å€¼baconï¼Œpastrami åˆ é™¤\ndf.drop_duplicates([&#39;food&#39;],inplace=True)\nprint(&quot;é‡å¤å€¼åˆ é™¤\\n&quot;,df)","like_count":0},{"had_liked":false,"id":287479,"user_name":"Boom clap!!!","can_delete":false,"product_type":"c1","uid":2443427,"ip_address":"","ucode":"E9AF8ECB963239","user_header":"https://static001.geekbang.org/account/avatar/00/25/48/a3/2df11999.jpg","comment_is_top":false,"comment_ctime":1617968229,"is_pvip":false,"replies":null,"discussion_count":0,"race_medal":0,"score":9,"product_id":100021701,"comment_content":"ç»ƒä¹ ï¼šimport pandas as pd\ndf=pd.read_csv(&#39;shuju.csv&#39;)#å¯¼å…¥æ•°æ®é›†ï¼Œæˆ‘æŠŠæ•°æ®æ”¾åˆ°äº†pycharmé‡Œ\nprint(df)\ndf[&#39;food&#39;]=df[&#39;food&#39;].str.lower()# æŠŠfoodåˆ—ä¸­çš„å¤§å†™å­—æ¯å…¨éƒ¨è½¬æ¢ä¸ºå°å†™\ndf =df.drop_duplicates()#åˆ é™¤foodåˆ—ä¸­çš„é‡å¤å€¼\ndef zheng(x):\n    return abs(x)\ndf[&#39;ounces&#39;]=df[&#39;ounces&#39;].apply(zheng)# æŠŠounces åˆ—ä¸­çš„è´Ÿæ•°è½¬åŒ–ä¸ºæ­£æ•°\n# æŠŠounces åˆ—ä¸­çš„NaNæ›¿æ¢ä¸ºå¹³å‡å€¼\ndf[&#39;ounces&#39;].fillna(df[&#39;ounces&#39;].mean(),inplace=True)\ndf.dropna(how=&#39;all&#39;,inplace=True)\ndf.reset_index(drop=&#39;true&#39;,inplace=True)#ç»™ç´¢å¼•é‡æ–°æ’åºï¼Œè¿™é‡Œå¥½åƒä¹Ÿæ²¡ç”¨åˆ°\nprint(df)","like_count":0},{"had_liked":false,"id":275182,"user_name":"è¦ç˜¦çš„èƒ–å­ğŸ‘‹ğŸ¼","can_delete":false,"product_type":"c1","uid":1527884,"ip_address":"","ucode":"598037BF56563C","user_header":"https://static001.geekbang.org/account/avatar/00/17/50/4c/22e7b5bf.jpg","comment_is_top":false,"comment_ctime":1611373632,"is_pvip":false,"replies":null,"discussion_count":0,"race_medal":0,"score":9,"product_id":100021701,"comment_content":"import pandas as pd\n\ndf = pd.read_excel(&#39;C:\\\\Users\\\\18371\\\\Downloads\\\\foodInformation.xlsx&#39;)\nprint(df)\nprint(&#39;*&#39;*100)\n\n# æ”¹ä¸ºå°å†™å­—æ¯\ndf[&#39;food&#39;] = df[&#39;food&#39;].str.lower()\nprint(df)\nprint(&#39;*&#39;*100)\n\n# åˆ é™¤è´Ÿæ•°æ•°æ®è¡Œ\ndf.drop(df[df[&#39;ounces&#39;] &lt; 0].index, inplace=True)\nprint(df)\nprint(&#39;*&#39;*100)\n\n# ç”¨å¹³å‡æ•°å¡«å……ç¼ºå¤±è®°å½•\ndf[&#39;ounces&#39;].fillna(df[&#39;ounces&#39;].mean(), inplace=True)\nprint(df)\nprint(&#39;*&#39;*100)\n\n\nd_rows = df[df[&#39;food&#39;].duplicated(keep=False)]\nprint(d_rows)\nprint(&#39;*&#39;*100)\n\nprint(df[&#39;ounces&#39;][df[&#39;food&#39;] == &#39;bacon&#39;])\nprint(df.loc[df[df[&#39;food&#39;] == &#39;bacon&#39;].index, &#39;ounces&#39;])\ndf.loc[df[df[&#39;food&#39;] == &#39;bacon&#39;].index, &#39;ounces&#39;] = d_rows[&#39;ounces&#39;].mean()\nprint(df)\nprint(&#39;*&#39;*100)\n\n# åˆ é™¤é‡å¤è®°å½•\ndf.drop_duplicates(inplace=True)\nprint(df)\nprint(&#39;*&#39;*100)\n\n# é‡è®¾ç´¢å¼•å€¼\ndf.index = range(len(df))\nprint(df)\n\n# ç»“æœ\n          food    ounces  animal\n0        bacon  5.880952     pig\n1  pulled port  3.000000     pig\n2     pastrami  6.000000     cow\n3  corned beef  7.500000     cow\n4    honey ham  5.000000     pig\n5     nova lox  6.000000  salmon\n\nProcess finished with exit code 0","like_count":0},{"had_liked":false,"id":351995,"user_name":"xiong","can_delete":false,"product_type":"c1","uid":1099375,"ip_address":"","ucode":"C1BFD9EF96372F","user_header":"https://static001.geekbang.org/account/avatar/00/10/c6/6f/ac3003fa.jpg","comment_is_top":false,"comment_ctime":1658317624,"is_pvip":false,"replies":null,"discussion_count":0,"race_medal":0,"score":9,"product_id":100021701,"comment_content":"å½“æ•°æ®é‡è¿‡å¤§çš„æ—¶å€™ï¼Œå¦‚ä½•åšæ•°æ®å®¡æŸ¥å‘¢ï¼Ÿ","like_count":0},{"had_liked":false,"id":334601,"user_name":"RecordLiu","can_delete":false,"product_type":"c1","uid":1252206,"ip_address":"","ucode":"41178CC21337FB","user_header":"https://static001.geekbang.org/account/avatar/00/13/1b/6e/cd8fea9f.jpg","comment_is_top":false,"comment_ctime":1645014460,"is_pvip":false,"replies":null,"discussion_count":0,"race_medal":0,"score":9,"product_id":100021701,"comment_content":"ä½¿ç”¨è€å¸ˆè¯¾ç¨‹ä¸­è®²åˆ°çš„å®Œå…¨åˆä¸€è§„åˆ™ï¼Œå‘ç°äº†ä»¥ä¸‹é—®é¢˜ï¼š\n1.1.ouncesåˆ—å­˜åœ¨NaNå€¼å’Œè´Ÿæ•°\n2.foodåˆ—é¦–å­—æ¯å¤§å°å†™ä¸ç»Ÿä¸€\n\nä¸»è¦æ•°æ®ä¿¡æ¯ä»£ç å¦‚ä¸‹:\ndef func_abs(df):\n    return abs(df[&#39;ounces&#39;])\n\ndf[&#39;ounces&#39;] = df.apply(func_abs,axis=1)\n\n#ä½¿ç”¨ouncesçš„å¹³å‡å€¼è¿›è¡Œå¡«å……Nullå€¼\ndf[&#39;ounces&#39;].fillna(df[&#39;ounces&#39;].mean(),inplace=True)\n\n#ç»Ÿä¸€foodåˆ—ä¸ºå°å†™\ndf[&#39;food&#39;] = df[&#39;food&#39;].str.lower()","like_count":0},{"had_liked":false,"id":326639,"user_name":"Ronin","can_delete":false,"product_type":"c1","uid":2657638,"ip_address":"","ucode":"6A4AF619EDFD70","user_header":"https://static001.geekbang.org/account/avatar/00/28/8d/66/89202762.jpg","comment_is_top":false,"comment_ctime":1639615920,"is_pvip":false,"replies":null,"discussion_count":0,"race_medal":0,"score":9,"product_id":100021701,"comment_content":"1.å®Œæ•´æ€§ï¼šç¬¬ä¸‰è¡Œounceså­˜åœ¨ç¼ºå¤±å€¼ï¼Œç”¨æ‰€æœ‰åˆ—çš„å¹³å‡å€¼è¿›è¡Œå¡«å……ï¼›\n2.å…¨é¢æ€§ï¼šfoodå±æ€§å¤§å°å†™ä¸ç»Ÿä¸€ï¼Œå…¨éƒ¨æ”¹ä¸ºå°å†™ï¼›\n3.åˆç†æ€§ï¼šç¬¬ä¸ƒè¡Œouncesä¸ºè´Ÿå€¼ï¼Œå–ç»å¯¹å€¼å³å¯ï¼›\n4.å”¯ä¸€æ€§ï¼šå­˜åœ¨foodå’Œanimalç›¸åŒçš„æ•°æ®ï¼Œå°†è¿™äº›æ•°æ®åˆå¹¶ï¼Œå–è¿™å‡ æ¡æ•°æ®ouncesçš„å‡å€¼ä½œä¸ºåˆå¹¶åçš„ouncesã€‚","like_count":0},{"had_liked":false,"id":310490,"user_name":"Kai","can_delete":false,"product_type":"c1","uid":1349659,"ip_address":"","ucode":"1930EED4331EEE","user_header":"https://static001.geekbang.org/account/avatar/00/14/98/1b/4a48bc4f.jpg","comment_is_top":false,"comment_ctime":1630677068,"is_pvip":false,"replies":null,"discussion_count":0,"race_medal":0,"score":9,"product_id":100021701,"comment_content":"import pandas as pd\n\n# Read data from csv, using regular expression to remove whitespaces\ndf = pd.read_csv(&#39;.&#47;11-exercise.csv&#39;, sep=r&#39;\\s*,\\s*&#39;, engine=&#39;python&#39;)\n\n# Lowercase all name in the food column\ndf[&#39;food&#39;] = df[&#39;food&#39;].str.lower()\n\n# Drop rows which have NaN value\ndf.dropna(inplace=True)\n\n# Use abs method to remove negative ounce value\ndf[&#39;ounces&#39;] = df[&#39;ounces&#39;].apply(abs)\n\n# Aggregate the ounces by name\ndf = df.groupby(df[&#39;food&#39;]).aggregate(\n    {&#39;food&#39;: &#39;first&#39;, &#39;ounces&#39;: &#39;sum&#39;, &#39;animal&#39;: &#39;first&#39;})\n\ndf.index = range(len(df))\n\nFinal output\n          food  ounces  animal\n0        bacon    12.0     pig\n1  corned beef     7.5     cow\n2    honey ham     5.0     pig\n3     nova lox     6.0  salmon\n4     pastrami     9.0     cow\n5  pulled pork     3.0     pig","like_count":0},{"had_liked":false,"id":302473,"user_name":"KokutoDa","can_delete":false,"product_type":"c1","uid":1189534,"ip_address":"","ucode":"2561207E84840E","user_header":"https://static001.geekbang.org/account/avatar/00/12/26/9e/836f603b.jpg","comment_is_top":false,"comment_ctime":1626233249,"is_pvip":false,"replies":null,"discussion_count":0,"race_medal":0,"score":9,"product_id":100021701,"comment_content":"è€å¸ˆï¼Œæ•°æ®å‡†å†Œçš„ã€Œåˆç†æ€§ã€å’Œã€Œå…¨é¢æ€§ã€æˆ‘æ„Ÿè§‰è¿™ä¿©å·®ä¸å¤šï¼Œå¸¸è¯†åˆ¤æ–­æ˜¯å¦åˆç†ã€‚æœ‰ä»€ä¹ˆåŒºåˆ«å—ï¼Ÿ","like_count":0},{"had_liked":false,"id":295028,"user_name":"yang","can_delete":false,"product_type":"c1","uid":1940562,"ip_address":"","ucode":"67C86E09BA6E4B","user_header":"https://static001.geekbang.org/account/avatar/00/1d/9c/52/dc770378.jpg","comment_is_top":false,"comment_ctime":1622189056,"is_pvip":false,"replies":null,"discussion_count":0,"race_medal":0,"score":9,"product_id":100021701,"comment_content":"æ¸…æ´—çš„è¯ï¼ŒæŠŠounceså°äºé›¶çš„å’Œç©ºå€¼çš„è¡Œå»æ‰ã€‚","like_count":0},{"had_liked":false,"id":289623,"user_name":"Vimà¹‘Âºà¸±","can_delete":false,"product_type":"c1","uid":2312293,"ip_address":"","ucode":"350C87C7AB96DC","user_header":"https://static001.geekbang.org/account/avatar/00/23/48/65/e8274238.jpg","comment_is_top":false,"comment_ctime":1619101570,"is_pvip":false,"replies":null,"discussion_count":0,"race_medal":0,"score":9,"product_id":100021701,"comment_content":"#python 3\n&quot;&quot;&quot;\nCreated on Thu Apr 22 21:41:13 2021\n\n@author: Yukka\næ•°æ®é—®é¢˜\n\n1.å®Œæ•´æ€§\nounces åˆ—å­˜åœ¨ç©ºå€¼--å»é™¤æ•°æ®\n2.å…¨é¢æ€§\nfoodå¤§å°å†™ä¸ä¸€è‡´--æ”¹ä¸ºä¸€è‡´ï¼Œï¼Œå¹¶åˆå¹¶æ•°æ®\n3.åˆç†æ€§\nè´Ÿå€¼--æ”¹ä¸ºæ­£å€¼\n4.å”¯ä¸€æ€§\nbaconï¼Œpastramié‡å¤å€¼--å°†foodå’Œanimalåˆ—å‡ç›¸åŒåˆ—æ•°æ®è¿›è¡Œåˆå¹¶\n&quot;&quot;&quot;\nimport pandas as pd\n#æ­¥éª¤ä¸€ å¯¼å…¥æ•°æ®æº\ndf = pd.read_csv(&quot;food-clean.csv&quot;)\nprint(&quot;åŸæ•°æ®\\n&quot;,df)\n#æ­¥éª¤äºŒ å°†ouncesåˆ—ç©ºå€¼ç”¨å‡å€¼å¡«å……\ndf[&#39;ounces&#39;].fillna(df[&#39;ounces&#39;].mean(), inplace=True)\nprint(&quot;ç©ºå€¼å¤„ç†\\n&quot;,df)\n#æ­¥éª¤ä¸‰ foodåˆ— å¤§å°å†™ä¸€è‡´æ”¹ä¸ºå°å†™\ndf[&#39;food&#39;]=df[&#39;food&#39;].str.lower()\nprint(&quot;å°å†™å¤„ç†\\n&quot;,df)\n#æ­¥éª¤å›› è´Ÿæ•°æ­£å¤„ç†\ndf[&#39;ounces&#39;]=df[&#39;ounces&#39;].abs() \nprint(&quot;è´Ÿæ•°æ­£å¤„ç†\\n&quot;,df)\n#æ­¥éª¤äº” é‡å¤å€¼baconï¼Œpastrami åˆ é™¤\ndf.drop_duplicates([&#39;food&#39;],inplace=True)\nprint(&quot;é‡å¤å€¼åˆ é™¤\\n&quot;,df)","like_count":0},{"had_liked":false,"id":289622,"user_name":"Vimà¹‘Âºà¸±","can_delete":false,"product_type":"c1","uid":2312293,"ip_address":"","ucode":"350C87C7AB96DC","user_header":"https://static001.geekbang.org/account/avatar/00/23/48/65/e8274238.jpg","comment_is_top":false,"comment_ctime":1619101538,"is_pvip":false,"replies":null,"discussion_count":0,"race_medal":0,"score":9,"product_id":100021701,"comment_content":"# -*- coding: utf-8 -*-\n&quot;&quot;&quot;\nCreated on Thu Apr 22 21:41:13 2021\n\n@author: Yukka\næ•°æ®é—®é¢˜\n\n1.å®Œæ•´æ€§\nounces åˆ—å­˜åœ¨ç©ºå€¼--å»é™¤æ•°æ®\n2.å…¨é¢æ€§\nfoodå¤§å°å†™ä¸ä¸€è‡´--æ”¹ä¸ºä¸€è‡´ï¼Œï¼Œå¹¶åˆå¹¶æ•°æ®\n3.åˆç†æ€§\nè´Ÿå€¼--æ”¹ä¸ºæ­£å€¼\n4.å”¯ä¸€æ€§\nbaconï¼Œpastramié‡å¤å€¼--å°†foodå’Œanimalåˆ—å‡ç›¸åŒåˆ—æ•°æ®è¿›è¡Œåˆå¹¶\n&quot;&quot;&quot;\nimport pandas as pd\n#æ­¥éª¤ä¸€ å¯¼å…¥æ•°æ®æº\ndf = pd.read_csv(&quot;food-clean.csv&quot;)\nprint(&quot;åŸæ•°æ®\\n&quot;,df)\n#æ­¥éª¤äºŒ å°†ouncesåˆ—ç©ºå€¼ç”¨å‡å€¼å¡«å……\ndf[&#39;ounces&#39;].fillna(df[&#39;ounces&#39;].mean(), inplace=True)\nprint(&quot;ç©ºå€¼å¤„ç†\\n&quot;,df)\n#æ­¥éª¤ä¸‰ foodåˆ— å¤§å°å†™ä¸€è‡´æ”¹ä¸ºå°å†™\ndf[&#39;food&#39;]=df[&#39;food&#39;].str.lower()\nprint(&quot;å°å†™å¤„ç†\\n&quot;,df)\n#æ­¥éª¤å›› è´Ÿæ•°æ­£å¤„ç†\ndf[&#39;ounces&#39;]=df[&#39;ounces&#39;].abs() \nprint(&quot;è´Ÿæ•°æ­£å¤„ç†\\n&quot;,df)\n#æ­¥éª¤äº” é‡å¤å€¼baconï¼Œpastrami åˆ é™¤\ndf.drop_duplicates([&#39;food&#39;],inplace=True)\nprint(&quot;é‡å¤å€¼åˆ é™¤\\n&quot;,df)","like_count":0},{"had_liked":false,"id":287479,"user_name":"Boom clap!!!","can_delete":false,"product_type":"c1","uid":2443427,"ip_address":"","ucode":"E9AF8ECB963239","user_header":"https://static001.geekbang.org/account/avatar/00/25/48/a3/2df11999.jpg","comment_is_top":false,"comment_ctime":1617968229,"is_pvip":false,"replies":null,"discussion_count":0,"race_medal":0,"score":9,"product_id":100021701,"comment_content":"ç»ƒä¹ ï¼šimport pandas as pd\ndf=pd.read_csv(&#39;shuju.csv&#39;)#å¯¼å…¥æ•°æ®é›†ï¼Œæˆ‘æŠŠæ•°æ®æ”¾åˆ°äº†pycharmé‡Œ\nprint(df)\ndf[&#39;food&#39;]=df[&#39;food&#39;].str.lower()# æŠŠfoodåˆ—ä¸­çš„å¤§å†™å­—æ¯å…¨éƒ¨è½¬æ¢ä¸ºå°å†™\ndf =df.drop_duplicates()#åˆ é™¤foodåˆ—ä¸­çš„é‡å¤å€¼\ndef zheng(x):\n    return abs(x)\ndf[&#39;ounces&#39;]=df[&#39;ounces&#39;].apply(zheng)# æŠŠounces åˆ—ä¸­çš„è´Ÿæ•°è½¬åŒ–ä¸ºæ­£æ•°\n# æŠŠounces åˆ—ä¸­çš„NaNæ›¿æ¢ä¸ºå¹³å‡å€¼\ndf[&#39;ounces&#39;].fillna(df[&#39;ounces&#39;].mean(),inplace=True)\ndf.dropna(how=&#39;all&#39;,inplace=True)\ndf.reset_index(drop=&#39;true&#39;,inplace=True)#ç»™ç´¢å¼•é‡æ–°æ’åºï¼Œè¿™é‡Œå¥½åƒä¹Ÿæ²¡ç”¨åˆ°\nprint(df)","like_count":0},{"had_liked":false,"id":275182,"user_name":"è¦ç˜¦çš„èƒ–å­ğŸ‘‹ğŸ¼","can_delete":false,"product_type":"c1","uid":1527884,"ip_address":"","ucode":"598037BF56563C","user_header":"https://static001.geekbang.org/account/avatar/00/17/50/4c/22e7b5bf.jpg","comment_is_top":false,"comment_ctime":1611373632,"is_pvip":false,"replies":null,"discussion_count":0,"race_medal":0,"score":9,"product_id":100021701,"comment_content":"import pandas as pd\n\ndf = pd.read_excel(&#39;C:\\\\Users\\\\18371\\\\Downloads\\\\foodInformation.xlsx&#39;)\nprint(df)\nprint(&#39;*&#39;*100)\n\n# æ”¹ä¸ºå°å†™å­—æ¯\ndf[&#39;food&#39;] = df[&#39;food&#39;].str.lower()\nprint(df)\nprint(&#39;*&#39;*100)\n\n# åˆ é™¤è´Ÿæ•°æ•°æ®è¡Œ\ndf.drop(df[df[&#39;ounces&#39;] &lt; 0].index, inplace=True)\nprint(df)\nprint(&#39;*&#39;*100)\n\n# ç”¨å¹³å‡æ•°å¡«å……ç¼ºå¤±è®°å½•\ndf[&#39;ounces&#39;].fillna(df[&#39;ounces&#39;].mean(), inplace=True)\nprint(df)\nprint(&#39;*&#39;*100)\n\n\nd_rows = df[df[&#39;food&#39;].duplicated(keep=False)]\nprint(d_rows)\nprint(&#39;*&#39;*100)\n\nprint(df[&#39;ounces&#39;][df[&#39;food&#39;] == &#39;bacon&#39;])\nprint(df.loc[df[df[&#39;food&#39;] == &#39;bacon&#39;].index, &#39;ounces&#39;])\ndf.loc[df[df[&#39;food&#39;] == &#39;bacon&#39;].index, &#39;ounces&#39;] = d_rows[&#39;ounces&#39;].mean()\nprint(df)\nprint(&#39;*&#39;*100)\n\n# åˆ é™¤é‡å¤è®°å½•\ndf.drop_duplicates(inplace=True)\nprint(df)\nprint(&#39;*&#39;*100)\n\n# é‡è®¾ç´¢å¼•å€¼\ndf.index = range(len(df))\nprint(df)\n\n# ç»“æœ\n          food    ounces  animal\n0        bacon  5.880952     pig\n1  pulled port  3.000000     pig\n2     pastrami  6.000000     cow\n3  corned beef  7.500000     cow\n4    honey ham  5.000000     pig\n5     nova lox  6.000000  salmon\n\nProcess finished with exit code 0","like_count":0},{"had_liked":false,"id":265776,"user_name":"èŒ¶æ¡","can_delete":false,"product_type":"c1","uid":2254242,"ip_address":"","ucode":"3EC3D9C6BF9091","user_header":"https://static001.geekbang.org/account/avatar/00/22/65/a2/88aca8f7.jpg","comment_is_top":false,"comment_ctime":1607009694,"is_pvip":false,"replies":null,"discussion_count":0,"race_medal":0,"score":10,"product_id":100021701,"comment_content":"# ä½œä¸š\nimport pandas as pd\nfrom pandas import Series,DataFrame\nimport numpy as np\n\ndf = DataFrame(pd.read_excel(&#39;excel2.xlsx&#39;))\n\n# å¤„ç†NaNå€¼\ndf[&#39;ounces&#39;].fillna(df[&#39;ounces&#39;].mean(), inplace=True)\n# å¤„ç†ä¸æ­£ç¡®çš„å€¼\ndf[&#39;ounces&#39;] = abs(df[&#39;ounces&#39;])\n# å¤„ç†é‡å¤å€¼\ndf.drop_duplicates([&#39;food&#39;], inplace=True)\n# å¤„ç†åç§°å¤§å°å†™\ndf[&#39;food&#39;] = df[&#39;food&#39;].str.capitalize()\ndf","like_count":0},{"had_liked":false,"id":207130,"user_name":"éª‘è¡Œçš„æŒæŸœJ","can_delete":false,"product_type":"c1","uid":1474214,"ip_address":"","ucode":"3163102651C653","user_header":"https://static001.geekbang.org/account/avatar/00/16/7e/a6/4e331ef4.jpg","comment_is_top":false,"comment_ctime":1587012135,"is_pvip":false,"replies":null,"discussion_count":0,"race_medal":0,"score":10,"product_id":100021701,"comment_content":"https:&#47;&#47;blog.csdn.net&#47;weixin_41013322&#47;article&#47;details&#47;105510187  ç»ˆäºå¼€å¯äºŒåˆ·é‡æ•´é™ˆè€å¸ˆçš„è¯¾ç¨‹ä¸­æ¼æ‰çš„çŸ¥è¯†ç‚¹ å¸Œæœ›å¯¹å¤§å®¶æœ‰ç”¨ï¼ğŸ˜","like_count":0},{"had_liked":false,"id":179756,"user_name":"will","can_delete":false,"product_type":"c1","uid":1750093,"ip_address":"","ucode":"A36CADCB62BFB5","user_header":"https://static001.geekbang.org/account/avatar/00/1a/b4/4d/f072c7f9.jpg","comment_is_top":false,"comment_ctime":1582092729,"is_pvip":false,"replies":null,"discussion_count":0,"race_medal":0,"score":10,"product_id":100021701,"comment_content":"data={&quot;food&quot;:[&quot;bacon&quot;,&quot;pulled pork&quot;,&quot;bacon&quot;,&quot;Pastrami&quot;,&quot;corned beef&quot;,&quot;Bacon&quot;,&quot;pastrami&quot;,&quot;honey ham&quot;,&quot;nova lox&quot;],&quot;ounces&quot;:[4,3,np.nan,6,7.5,8,-3,5,6],\n      &quot;animal&quot;:[&quot;pig&quot;,&quot;pig&quot;,&quot;pig&quot;,&quot;cow&quot;,&quot;cow&quot;,&quot;pig&quot;,&quot;cow&quot;,&quot;pig&quot;,&quot;salmon&quot;]}\ndf3=pd.DataFrame(data,columns=[&quot;food&quot;,&quot;ounces&quot;,&quot;animal&quot;])\ndf3[&quot;ounces&quot;]=abs(df3[&quot;ounces&quot;].values)\ndf3.fillna(int(df3[&quot;ounces&quot;].mean()),inplace=True)\ndf3[&quot;food&quot;]=df3[&quot;food&quot;].str.title()\ndf3.drop_duplicates([&quot;food&quot;,&quot;ounces&quot;],inplace=True)","like_count":0},{"had_liked":false,"id":176506,"user_name":"é±¼éå­","can_delete":false,"product_type":"c1","uid":1818595,"ip_address":"","ucode":"BB76AE2CB4D680","user_header":"https://static001.geekbang.org/account/avatar/00/1b/bf/e3/2aa8ec84.jpg","comment_is_top":false,"comment_ctime":1581074389,"is_pvip":false,"replies":null,"discussion_count":0,"race_medal":0,"score":10,"product_id":100021701,"comment_content":"çœ‹ç€ç”·å¥³çš„ä¸‰å›´å°ºå¯¸çš„6åˆ—å¾ˆæ‰å¿ƒï¼Œäºæ˜¯åšäº†ä¸€äº›ç®€å•å¤„ç†ã€‚\nimport numpy as np\nimport pandas as pd\nimport matplotlib.pyplot as plt\n\ndf = pd.DataFrame(data)\n\n#åˆ é™¤ç©ºè¡Œå’Œé‡å¤å€¼\ndf.drop_duplicates(&#39;name&#39;,inplace= True)\ndf.dropna(how=&#39;all&#39;,inplace= True)\n\n#å¡«å……å¹´é¾„çš„ç¼ºå¤±å€¼\ndf[&#39;age&#39;].fillna(df[&#39;age&#39;].mean())\n\n\n#å¯¹ä½“é‡è¿›è¡Œæ¢ç®—\n# è·å– weight æ•°æ®åˆ—ä¸­å•ä½ä¸º lbs çš„æ•°æ®\nrows_with_lbs = df[&#39;weight&#39;].str.contains(&#39;lbs&#39;).fillna(False)\n#print (df[rows_with_lbs])\n# å°† lbsè½¬æ¢ä¸º kgs, 2.2lbs=1kgs\nfor i,lbs_row in df[rows_with_lbs].iterrows():\n  # æˆªå–ä»å¤´å¼€å§‹åˆ°å€’æ•°ç¬¬ä¸‰ä¸ªå­—ç¬¦ä¹‹å‰ï¼Œå³å»æ‰lbsã€‚\n  weight = int(float(lbs_row[&#39;weight&#39;][:-3])&#47;2.2)\n  df.at[i,&#39;weight&#39;] = &#39;{}kgs&#39;.format(weight)\n\n\nfor i,sex_row in df.iterrows():\n    sex = (sex_row[&#39;m0&#39;]+sex_row[&#39;m0&#39;]+sex_row[&#39;m0&#39;]) &gt;0\n    if sex:\n        df.at[i,&#39;sex&#39;] = &quot;man&quot;\n    else:\n        df.at[i,&#39;sex&#39;] = &quot;woman&quot;\n\nfor i,sex_row in df.iterrows():\n    if sex_row[&#39;sex&#39;] == &quot;man&quot;:\n        df.at[i, &#39;00&#39;] = sex_row[&#39;m0&#39;]\n        df.at[i, &#39;11&#39;] = sex_row[&#39;m1&#39;]\n        df.at[i, &#39;22&#39;] = sex_row[&#39;m2&#39;]\n    else:\n        df.at[i, &#39;00&#39;] = sex_row[&#39;w0&#39;]\n        df.at[i, &#39;11&#39;] = sex_row[&#39;w1&#39;]\n        df.at[i, &#39;22&#39;] = sex_row[&#39;w2&#39;]\n    \ndf.drop([&#39;m0&#39;,&#39;m1&#39;,&#39;m2&#39;,&#39;w0&#39;,&#39;w1&#39;,&#39;w2&#39;],axis=1,inplace=True)\nprint(df)\n\nç»“æœå¦‚ä¸‹ï¼š\n              name   age weight    sex    00    11    22\n0     mickey mouse  56.0  70kgs    man  72.0  69.0  71.0\n1      donald duck  34.0  70kgs  woman  85.0  84.0  76.0\n2       mini mouse  16.0   None  woman  65.0  69.0  72.0\n3   scrooge mcduck   NaN  78kgs    man  78.0  79.0  72.0\n4     pink panther  54.0  90kgs  woman  69.0   NaN  75.0\n5      huey mcduck  52.0  85kgs  woman  68.0  75.0  72.0\n6     dewey dcduck  19.0  56kgs  woman  71.0  78.0  75.0\n7       scoopy doo  32.0  78kgs    man  78.0  76.0  75.0\n10    louie mcduck  12.0  45kgs  woman  92.0  95.0  87.0\n\n","like_count":0},{"had_liked":false,"id":172501,"user_name":"æç’‡","can_delete":false,"product_type":"c1","uid":1795522,"ip_address":"","ucode":"F311CD7B6F8680","user_header":"https://static001.geekbang.org/account/avatar/00/1b/65/c2/9ecbb0b2.jpg","comment_is_top":false,"comment_ctime":1579193321,"is_pvip":false,"replies":null,"discussion_count":0,"race_medal":0,"score":10,"product_id":100021701,"comment_content":"å¦‚æœæ•°æ®å¾ˆå¤šå¯ä»¥ç”¨infoçœ‹ä¸€ä¸‹ç¼ºå¤±æƒ…å†µ\nfoodé¦–å­—æ¯å¤§å†™\nç”¨baconçš„å‡å€¼å¡«å……baconç¼ºå¤±å€¼\nå°†è´Ÿæ•°ounceåˆ—åˆ é™¤\n\nimport pandas as pd\nimport os\nos.chdir(&#39;C:\\\\Users\\\\Violette\\\\Desktop\\\\&#39;)\ndata=pd.read_csv(&#39;11ä½œä¸šæ•°æ®.csv&#39;,encoding=&#39;UTF-8&#39;)\ndata.info()\ndata.food.str.capitalize()\nmean_ounce=data[(data[&#39;food&#39;]==&#39;Bacon&#39;)&amp;(data[&#39;ounces&#39;].notnull())][&#39;ounces&#39;].mean()\ndata.loc[data[&#39;ounces&#39;].isnull(),&#39;ounces&#39;]=mean_ounce\ndata= data.drop(data[data.ounces &lt; 0].index).reindex()","like_count":0},{"had_liked":false,"id":171799,"user_name":"è‹¹æœ","can_delete":false,"product_type":"c1","uid":1761988,"ip_address":"","ucode":"5D0FA9D8560FD8","user_header":"https://static001.geekbang.org/account/avatar/00/1a/e2/c4/25acaa38.jpg","comment_is_top":false,"comment_ctime":1579014726,"is_pvip":false,"replies":null,"discussion_count":0,"race_medal":0,"score":10,"product_id":100021701,"comment_content":"# -*- coding: utf-8 -*-\nimport numpy\nimport pandas as pd\nimport os\n\nos.chdir(&#39;E:\\\\C-05-æ•°æ®åˆ†æå®æˆ˜\\\\01åŸºç¡€ç¯‡\\\\æ•°æ®æ¸…ç†ææ–™&#39;)\ndf = pd.read_excel(&#39;.\\\\accountMessage.xlsx&#39;)\ndf.drop(columns=[0,&#39;\\t&#39;],inplace = True)\ndf.rename(columns={1:&#39;name&#39;,2:&#39;age&#39;,3:&#39;weights&#39;,4:&#39;m0006&#39;,5:&#39;m0612&#39;,6:&#39;m1218&#39;,7:&#39;f0006&#39;,8:&#39;f0612&#39;,9:&#39;f1218&#39;},inplace=True)\ndf[&#39;age&#39;].fillna(df[&#39;age&#39;].mean(),inplace=True)\n#ç”¨ä½“é‡çš„ä¼—æ•°å¡«å…¥ç©ºå€¼\ndf[&#39;weights&#39;].fillna(df[&#39;weights&#39;].value_counts().index[0] , inplace=True )\n#åˆ é™¤æ‰€ç”¨ç©ºå€¼\ndf.dropna(how=&#39;all&#39;,inplace=True)\nrows_with_lbs = df[&#39;weights&#39;].str.contains(&#39;lbs&#39;)\n# print(df[rows_with_lbs].iterrows())\n# exit()\n#ç»Ÿä¸€å•ä½ä¸ºåƒå…‹\nfor i ,lbs_row in df[rows_with_lbs].iterrows():\n    weight = int(float(lbs_row[&#39;weights&#39;][:-3])&#47;2.2)\n    df.at[i,&#39;weights&#39;] = &#39;{}kgs&#39;.format(weight)\ndf.replace({r&#39;[^\\x00-\\x7F]+&#39;:&#39;&#39;},regex=True)\n# df[&#39;f0612&#39;].fillna(df[&#39;f0612&#39;].mean())\ndf[[&#39;first_name&#39;,&#39;last_name&#39;]] = df[&#39;name&#39;].str.split(expand=True)\ndf.drop(&#39;name&#39;,axis=1,inplace=True)\n# df.drop(columns=[&#39;name&#39;],inplace=True)\ndf.drop_duplicates([&#39;first_name&#39;,&#39;last_name&#39;],inplace=True)\ndf.drop(index=[8],inplace=True)\ncolumns = list(df)\ncolumns.insert(0,columns.pop(columns.index(&#39;last_name&#39;)))\ncolumns.insert(0,columns.pop(columns.index(&#39;first_name&#39;)))\ndf = df.ix[:,columns]\n#f0612ç”¨å¹³å‡æ•°å¡«å……ç©ºå€¼\nf0612_rows = df[&#39;f0612&#39;].str.isalnum().fillna(True)\nf0612_mean = df[f0612_rows][&#39;f0612&#39;].mean()\ndf[&#39;f0612&#39;].fillna(f0612_mean,inplace=True)\ndf.replace(&#39;-&#39;,&#39;&#39;,inplace=True)\ndf.reindex(range(df.shape[0]),method = &#39;bfill&#39;)\nprint (df)\n\ndf.to_excel(&#39;.\\\\new_Message.xlsx&#39;)\n","like_count":0},{"had_liked":false,"id":152066,"user_name":"Ling","can_delete":false,"product_type":"c1","uid":1022786,"ip_address":"","ucode":"EE15D1ABDB073B","user_header":"https://static001.geekbang.org/account/avatar/00/0f/9b/42/aeb79b35.jpg","comment_is_top":false,"comment_ctime":1573868581,"is_pvip":false,"replies":null,"discussion_count":0,"race_medal":0,"score":10,"product_id":100021701,"comment_content":"# jupyter notebook \n# python 3\n\nimport pandas as pd\n\ncolumns = [&quot;food&quot;,&quot;ounces&quot;,&quot;animal&quot;]\n\nvalue = {&quot;food&quot;:[&quot;bacon&quot;,&quot;pulled pork&quot;,&quot;bacon&quot;,&quot;Pastrami&quot;,&quot;corned beef&quot;,&quot;Bacon&quot;,&quot;pastrami&quot;,&quot;honey ham&quot;,&quot;nova lox&quot;],\n        &quot;ounces&quot;:[4.0,3.0,None,6.0,7.5,8.0,-3.0,5.0,6.0],\n        &quot;animal&quot;:[&quot;pig&quot;,&quot;pig&quot;,&quot;pig&quot;,&quot;cow&quot;,&quot;cow&quot;,&quot;pig&quot;,&quot;cow&quot;,&quot;pig&quot;,&quot;salmon&quot;]}\n\ndf = pd.DataFrame(value,columns=columns)\n\n# åˆ é™¤è´Ÿå€¼\ndf = df[df[&quot;ounces&quot;] &gt; 0]\n\n# ä½¿ç”¨å‡å€¼å¡«å……ç©ºå€¼\ndf.fillna(df.ounces.mean())\n\n# food åˆ—è¿›è¡Œå¤§å°å†™è½¬åŒ–\ndf.food = df.food.str.title()\n\n# ä¸€è‡´åŒ–\ndf = pd.DataFrame(df.groupby(by=[&quot;food&quot;,&quot;animal&quot;])[&quot;ounces&quot;].sum())","like_count":0},{"had_liked":false,"id":122011,"user_name":"åˆ«ç¦»","can_delete":false,"product_type":"c1","uid":1207234,"ip_address":"","ucode":"6584C14756B8B0","user_header":"https://static001.geekbang.org/account/avatar/00/12/6b/c2/c61137eb.jpg","comment_is_top":false,"comment_ctime":1565268172,"is_pvip":false,"replies":null,"discussion_count":0,"race_medal":0,"score":10,"product_id":100021701,"comment_content":"         food  ounces  animal\n0        bacon     4.0     pig\n1  pulled pork     3.0     pig\n2        bacon     NaN     pig\n3     Pastrami     6.0     cow\n4  corned beef     7.5     cow\n5        Bacon     8.0     pig\n6     pastrami    -3.0     cow\n7    honey ham     5.0     pig\n8     nova lox     6.0  salmon","like_count":0},{"had_liked":false,"id":111600,"user_name":"xqs42b","can_delete":false,"product_type":"c1","uid":1590102,"ip_address":"","ucode":"E1B85D10E44672","user_header":"https://static001.geekbang.org/account/avatar/00/18/43/56/3572a20c.jpg","comment_is_top":false,"comment_ctime":1562571147,"is_pvip":false,"replies":null,"discussion_count":0,"race_medal":0,"score":10,"product_id":100021701,"comment_content":"è€å¸ˆï¼Œæœ‰ç­”æ¡ˆå—ï¼Ÿï¼Ÿæˆ‘æƒ³çŸ¥é“æˆ‘çš„æƒ³æ³•æœ‰æ²¡æœ‰å•¥é—®é¢˜ï¼","like_count":0},{"had_liked":false,"id":98816,"user_name":"Geek_l0anid","can_delete":false,"product_type":"c1","uid":1258042,"ip_address":"","ucode":"96DE706AAC9D97","user_header":"https://static001.geekbang.org/account/avatar/00/13/32/3a/2d8a2c67.jpg","comment_is_top":false,"comment_ctime":1559099722,"is_pvip":false,"replies":null,"discussion_count":0,"race_medal":0,"score":10,"product_id":100021701,"comment_content":"æ ¹æ®å®Œå…¨åˆä¸€çš„æ³•åˆ™æ¥è¯´ï¼Œé‚£ä¹ˆå®Œæ•´æ€§ï¼šouncesåˆ—å‡ºç°äº†ç¼ºå¤±å€¼ï¼Œå…¨é¢æ€§ï¼šnameåˆ—åç§°å‘½åå¤§å°å†™ä¸ç»Ÿä¸€ï¼Œåˆæ³•æ€§ï¼šouncesåˆ—å‡ºç°äº†è´Ÿå€¼ï¼Œå”¯ä¸€æ€§ï¼šé£Ÿç‰©è¡Œå‡ºç°äº†é‡å¤çš„å€¼ï¼Œä¸çŸ¥é“ä»¥å“ªè¡Œä¸ºä¸»ã€‚","like_count":0},{"had_liked":false,"id":265776,"user_name":"èŒ¶æ¡","can_delete":false,"product_type":"c1","uid":2254242,"ip_address":"","ucode":"3EC3D9C6BF9091","user_header":"https://static001.geekbang.org/account/avatar/00/22/65/a2/88aca8f7.jpg","comment_is_top":false,"comment_ctime":1607009694,"is_pvip":false,"replies":null,"discussion_count":0,"race_medal":0,"score":10,"product_id":100021701,"comment_content":"# ä½œä¸š\nimport pandas as pd\nfrom pandas import Series,DataFrame\nimport numpy as np\n\ndf = DataFrame(pd.read_excel(&#39;excel2.xlsx&#39;))\n\n# å¤„ç†NaNå€¼\ndf[&#39;ounces&#39;].fillna(df[&#39;ounces&#39;].mean(), inplace=True)\n# å¤„ç†ä¸æ­£ç¡®çš„å€¼\ndf[&#39;ounces&#39;] = abs(df[&#39;ounces&#39;])\n# å¤„ç†é‡å¤å€¼\ndf.drop_duplicates([&#39;food&#39;], inplace=True)\n# å¤„ç†åç§°å¤§å°å†™\ndf[&#39;food&#39;] = df[&#39;food&#39;].str.capitalize()\ndf","like_count":0},{"had_liked":false,"id":207130,"user_name":"éª‘è¡Œçš„æŒæŸœJ","can_delete":false,"product_type":"c1","uid":1474214,"ip_address":"","ucode":"3163102651C653","user_header":"https://static001.geekbang.org/account/avatar/00/16/7e/a6/4e331ef4.jpg","comment_is_top":false,"comment_ctime":1587012135,"is_pvip":false,"replies":null,"discussion_count":0,"race_medal":0,"score":10,"product_id":100021701,"comment_content":"https:&#47;&#47;blog.csdn.net&#47;weixin_41013322&#47;article&#47;details&#47;105510187  ç»ˆäºå¼€å¯äºŒåˆ·é‡æ•´é™ˆè€å¸ˆçš„è¯¾ç¨‹ä¸­æ¼æ‰çš„çŸ¥è¯†ç‚¹ å¸Œæœ›å¯¹å¤§å®¶æœ‰ç”¨ï¼ğŸ˜","like_count":0},{"had_liked":false,"id":179756,"user_name":"will","can_delete":false,"product_type":"c1","uid":1750093,"ip_address":"","ucode":"A36CADCB62BFB5","user_header":"https://static001.geekbang.org/account/avatar/00/1a/b4/4d/f072c7f9.jpg","comment_is_top":false,"comment_ctime":1582092729,"is_pvip":false,"replies":null,"discussion_count":0,"race_medal":0,"score":10,"product_id":100021701,"comment_content":"data={&quot;food&quot;:[&quot;bacon&quot;,&quot;pulled pork&quot;,&quot;bacon&quot;,&quot;Pastrami&quot;,&quot;corned beef&quot;,&quot;Bacon&quot;,&quot;pastrami&quot;,&quot;honey ham&quot;,&quot;nova lox&quot;],&quot;ounces&quot;:[4,3,np.nan,6,7.5,8,-3,5,6],\n      &quot;animal&quot;:[&quot;pig&quot;,&quot;pig&quot;,&quot;pig&quot;,&quot;cow&quot;,&quot;cow&quot;,&quot;pig&quot;,&quot;cow&quot;,&quot;pig&quot;,&quot;salmon&quot;]}\ndf3=pd.DataFrame(data,columns=[&quot;food&quot;,&quot;ounces&quot;,&quot;animal&quot;])\ndf3[&quot;ounces&quot;]=abs(df3[&quot;ounces&quot;].values)\ndf3.fillna(int(df3[&quot;ounces&quot;].mean()),inplace=True)\ndf3[&quot;food&quot;]=df3[&quot;food&quot;].str.title()\ndf3.drop_duplicates([&quot;food&quot;,&quot;ounces&quot;],inplace=True)","like_count":0},{"had_liked":false,"id":176506,"user_name":"é±¼éå­","can_delete":false,"product_type":"c1","uid":1818595,"ip_address":"","ucode":"BB76AE2CB4D680","user_header":"https://static001.geekbang.org/account/avatar/00/1b/bf/e3/2aa8ec84.jpg","comment_is_top":false,"comment_ctime":1581074389,"is_pvip":false,"replies":null,"discussion_count":0,"race_medal":0,"score":10,"product_id":100021701,"comment_content":"çœ‹ç€ç”·å¥³çš„ä¸‰å›´å°ºå¯¸çš„6åˆ—å¾ˆæ‰å¿ƒï¼Œäºæ˜¯åšäº†ä¸€äº›ç®€å•å¤„ç†ã€‚\nimport numpy as np\nimport pandas as pd\nimport matplotlib.pyplot as plt\n\ndf = pd.DataFrame(data)\n\n#åˆ é™¤ç©ºè¡Œå’Œé‡å¤å€¼\ndf.drop_duplicates(&#39;name&#39;,inplace= True)\ndf.dropna(how=&#39;all&#39;,inplace= True)\n\n#å¡«å……å¹´é¾„çš„ç¼ºå¤±å€¼\ndf[&#39;age&#39;].fillna(df[&#39;age&#39;].mean())\n\n\n#å¯¹ä½“é‡è¿›è¡Œæ¢ç®—\n# è·å– weight æ•°æ®åˆ—ä¸­å•ä½ä¸º lbs çš„æ•°æ®\nrows_with_lbs = df[&#39;weight&#39;].str.contains(&#39;lbs&#39;).fillna(False)\n#print (df[rows_with_lbs])\n# å°† lbsè½¬æ¢ä¸º kgs, 2.2lbs=1kgs\nfor i,lbs_row in df[rows_with_lbs].iterrows():\n  # æˆªå–ä»å¤´å¼€å§‹åˆ°å€’æ•°ç¬¬ä¸‰ä¸ªå­—ç¬¦ä¹‹å‰ï¼Œå³å»æ‰lbsã€‚\n  weight = int(float(lbs_row[&#39;weight&#39;][:-3])&#47;2.2)\n  df.at[i,&#39;weight&#39;] = &#39;{}kgs&#39;.format(weight)\n\n\nfor i,sex_row in df.iterrows():\n    sex = (sex_row[&#39;m0&#39;]+sex_row[&#39;m0&#39;]+sex_row[&#39;m0&#39;]) &gt;0\n    if sex:\n        df.at[i,&#39;sex&#39;] = &quot;man&quot;\n    else:\n        df.at[i,&#39;sex&#39;] = &quot;woman&quot;\n\nfor i,sex_row in df.iterrows():\n    if sex_row[&#39;sex&#39;] == &quot;man&quot;:\n        df.at[i, &#39;00&#39;] = sex_row[&#39;m0&#39;]\n        df.at[i, &#39;11&#39;] = sex_row[&#39;m1&#39;]\n        df.at[i, &#39;22&#39;] = sex_row[&#39;m2&#39;]\n    else:\n        df.at[i, &#39;00&#39;] = sex_row[&#39;w0&#39;]\n        df.at[i, &#39;11&#39;] = sex_row[&#39;w1&#39;]\n        df.at[i, &#39;22&#39;] = sex_row[&#39;w2&#39;]\n    \ndf.drop([&#39;m0&#39;,&#39;m1&#39;,&#39;m2&#39;,&#39;w0&#39;,&#39;w1&#39;,&#39;w2&#39;],axis=1,inplace=True)\nprint(df)\n\nç»“æœå¦‚ä¸‹ï¼š\n              name   age weight    sex    00    11    22\n0     mickey mouse  56.0  70kgs    man  72.0  69.0  71.0\n1      donald duck  34.0  70kgs  woman  85.0  84.0  76.0\n2       mini mouse  16.0   None  woman  65.0  69.0  72.0\n3   scrooge mcduck   NaN  78kgs    man  78.0  79.0  72.0\n4     pink panther  54.0  90kgs  woman  69.0   NaN  75.0\n5      huey mcduck  52.0  85kgs  woman  68.0  75.0  72.0\n6     dewey dcduck  19.0  56kgs  woman  71.0  78.0  75.0\n7       scoopy doo  32.0  78kgs    man  78.0  76.0  75.0\n10    louie mcduck  12.0  45kgs  woman  92.0  95.0  87.0\n\n","like_count":0},{"had_liked":false,"id":172501,"user_name":"æç’‡","can_delete":false,"product_type":"c1","uid":1795522,"ip_address":"","ucode":"F311CD7B6F8680","user_header":"https://static001.geekbang.org/account/avatar/00/1b/65/c2/9ecbb0b2.jpg","comment_is_top":false,"comment_ctime":1579193321,"is_pvip":false,"replies":null,"discussion_count":0,"race_medal":0,"score":10,"product_id":100021701,"comment_content":"å¦‚æœæ•°æ®å¾ˆå¤šå¯ä»¥ç”¨infoçœ‹ä¸€ä¸‹ç¼ºå¤±æƒ…å†µ\nfoodé¦–å­—æ¯å¤§å†™\nç”¨baconçš„å‡å€¼å¡«å……baconç¼ºå¤±å€¼\nå°†è´Ÿæ•°ounceåˆ—åˆ é™¤\n\nimport pandas as pd\nimport os\nos.chdir(&#39;C:\\\\Users\\\\Violette\\\\Desktop\\\\&#39;)\ndata=pd.read_csv(&#39;11ä½œä¸šæ•°æ®.csv&#39;,encoding=&#39;UTF-8&#39;)\ndata.info()\ndata.food.str.capitalize()\nmean_ounce=data[(data[&#39;food&#39;]==&#39;Bacon&#39;)&amp;(data[&#39;ounces&#39;].notnull())][&#39;ounces&#39;].mean()\ndata.loc[data[&#39;ounces&#39;].isnull(),&#39;ounces&#39;]=mean_ounce\ndata= data.drop(data[data.ounces &lt; 0].index).reindex()","like_count":0},{"had_liked":false,"id":171799,"user_name":"è‹¹æœ","can_delete":false,"product_type":"c1","uid":1761988,"ip_address":"","ucode":"5D0FA9D8560FD8","user_header":"https://static001.geekbang.org/account/avatar/00/1a/e2/c4/25acaa38.jpg","comment_is_top":false,"comment_ctime":1579014726,"is_pvip":false,"replies":null,"discussion_count":0,"race_medal":0,"score":10,"product_id":100021701,"comment_content":"# -*- coding: utf-8 -*-\nimport numpy\nimport pandas as pd\nimport os\n\nos.chdir(&#39;E:\\\\C-05-æ•°æ®åˆ†æå®æˆ˜\\\\01åŸºç¡€ç¯‡\\\\æ•°æ®æ¸…ç†ææ–™&#39;)\ndf = pd.read_excel(&#39;.\\\\accountMessage.xlsx&#39;)\ndf.drop(columns=[0,&#39;\\t&#39;],inplace = True)\ndf.rename(columns={1:&#39;name&#39;,2:&#39;age&#39;,3:&#39;weights&#39;,4:&#39;m0006&#39;,5:&#39;m0612&#39;,6:&#39;m1218&#39;,7:&#39;f0006&#39;,8:&#39;f0612&#39;,9:&#39;f1218&#39;},inplace=True)\ndf[&#39;age&#39;].fillna(df[&#39;age&#39;].mean(),inplace=True)\n#ç”¨ä½“é‡çš„ä¼—æ•°å¡«å…¥ç©ºå€¼\ndf[&#39;weights&#39;].fillna(df[&#39;weights&#39;].value_counts().index[0] , inplace=True )\n#åˆ é™¤æ‰€ç”¨ç©ºå€¼\ndf.dropna(how=&#39;all&#39;,inplace=True)\nrows_with_lbs = df[&#39;weights&#39;].str.contains(&#39;lbs&#39;)\n# print(df[rows_with_lbs].iterrows())\n# exit()\n#ç»Ÿä¸€å•ä½ä¸ºåƒå…‹\nfor i ,lbs_row in df[rows_with_lbs].iterrows():\n    weight = int(float(lbs_row[&#39;weights&#39;][:-3])&#47;2.2)\n    df.at[i,&#39;weights&#39;] = &#39;{}kgs&#39;.format(weight)\ndf.replace({r&#39;[^\\x00-\\x7F]+&#39;:&#39;&#39;},regex=True)\n# df[&#39;f0612&#39;].fillna(df[&#39;f0612&#39;].mean())\ndf[[&#39;first_name&#39;,&#39;last_name&#39;]] = df[&#39;name&#39;].str.split(expand=True)\ndf.drop(&#39;name&#39;,axis=1,inplace=True)\n# df.drop(columns=[&#39;name&#39;],inplace=True)\ndf.drop_duplicates([&#39;first_name&#39;,&#39;last_name&#39;],inplace=True)\ndf.drop(index=[8],inplace=True)\ncolumns = list(df)\ncolumns.insert(0,columns.pop(columns.index(&#39;last_name&#39;)))\ncolumns.insert(0,columns.pop(columns.index(&#39;first_name&#39;)))\ndf = df.ix[:,columns]\n#f0612ç”¨å¹³å‡æ•°å¡«å……ç©ºå€¼\nf0612_rows = df[&#39;f0612&#39;].str.isalnum().fillna(True)\nf0612_mean = df[f0612_rows][&#39;f0612&#39;].mean()\ndf[&#39;f0612&#39;].fillna(f0612_mean,inplace=True)\ndf.replace(&#39;-&#39;,&#39;&#39;,inplace=True)\ndf.reindex(range(df.shape[0]),method = &#39;bfill&#39;)\nprint (df)\n\ndf.to_excel(&#39;.\\\\new_Message.xlsx&#39;)\n","like_count":0},{"had_liked":false,"id":152066,"user_name":"Ling","can_delete":false,"product_type":"c1","uid":1022786,"ip_address":"","ucode":"EE15D1ABDB073B","user_header":"https://static001.geekbang.org/account/avatar/00/0f/9b/42/aeb79b35.jpg","comment_is_top":false,"comment_ctime":1573868581,"is_pvip":false,"replies":null,"discussion_count":0,"race_medal":0,"score":10,"product_id":100021701,"comment_content":"# jupyter notebook \n# python 3\n\nimport pandas as pd\n\ncolumns = [&quot;food&quot;,&quot;ounces&quot;,&quot;animal&quot;]\n\nvalue = {&quot;food&quot;:[&quot;bacon&quot;,&quot;pulled pork&quot;,&quot;bacon&quot;,&quot;Pastrami&quot;,&quot;corned beef&quot;,&quot;Bacon&quot;,&quot;pastrami&quot;,&quot;honey ham&quot;,&quot;nova lox&quot;],\n        &quot;ounces&quot;:[4.0,3.0,None,6.0,7.5,8.0,-3.0,5.0,6.0],\n        &quot;animal&quot;:[&quot;pig&quot;,&quot;pig&quot;,&quot;pig&quot;,&quot;cow&quot;,&quot;cow&quot;,&quot;pig&quot;,&quot;cow&quot;,&quot;pig&quot;,&quot;salmon&quot;]}\n\ndf = pd.DataFrame(value,columns=columns)\n\n# åˆ é™¤è´Ÿå€¼\ndf = df[df[&quot;ounces&quot;] &gt; 0]\n\n# ä½¿ç”¨å‡å€¼å¡«å……ç©ºå€¼\ndf.fillna(df.ounces.mean())\n\n# food åˆ—è¿›è¡Œå¤§å°å†™è½¬åŒ–\ndf.food = df.food.str.title()\n\n# ä¸€è‡´åŒ–\ndf = pd.DataFrame(df.groupby(by=[&quot;food&quot;,&quot;animal&quot;])[&quot;ounces&quot;].sum())","like_count":0},{"had_liked":false,"id":122011,"user_name":"åˆ«ç¦»","can_delete":false,"product_type":"c1","uid":1207234,"ip_address":"","ucode":"6584C14756B8B0","user_header":"https://static001.geekbang.org/account/avatar/00/12/6b/c2/c61137eb.jpg","comment_is_top":false,"comment_ctime":1565268172,"is_pvip":false,"replies":null,"discussion_count":0,"race_medal":0,"score":10,"product_id":100021701,"comment_content":"         food  ounces  animal\n0        bacon     4.0     pig\n1  pulled pork     3.0     pig\n2        bacon     NaN     pig\n3     Pastrami     6.0     cow\n4  corned beef     7.5     cow\n5        Bacon     8.0     pig\n6     pastrami    -3.0     cow\n7    honey ham     5.0     pig\n8     nova lox     6.0  salmon","like_count":0},{"had_liked":false,"id":111600,"user_name":"xqs42b","can_delete":false,"product_type":"c1","uid":1590102,"ip_address":"","ucode":"E1B85D10E44672","user_header":"https://static001.geekbang.org/account/avatar/00/18/43/56/3572a20c.jpg","comment_is_top":false,"comment_ctime":1562571147,"is_pvip":false,"replies":null,"discussion_count":0,"race_medal":0,"score":10,"product_id":100021701,"comment_content":"è€å¸ˆï¼Œæœ‰ç­”æ¡ˆå—ï¼Ÿï¼Ÿæˆ‘æƒ³çŸ¥é“æˆ‘çš„æƒ³æ³•æœ‰æ²¡æœ‰å•¥é—®é¢˜ï¼","like_count":0},{"had_liked":false,"id":98816,"user_name":"Geek_l0anid","can_delete":false,"product_type":"c1","uid":1258042,"ip_address":"","ucode":"96DE706AAC9D97","user_header":"https://static001.geekbang.org/account/avatar/00/13/32/3a/2d8a2c67.jpg","comment_is_top":false,"comment_ctime":1559099722,"is_pvip":false,"replies":null,"discussion_count":0,"race_medal":0,"score":10,"product_id":100021701,"comment_content":"æ ¹æ®å®Œå…¨åˆä¸€çš„æ³•åˆ™æ¥è¯´ï¼Œé‚£ä¹ˆå®Œæ•´æ€§ï¼šouncesåˆ—å‡ºç°äº†ç¼ºå¤±å€¼ï¼Œå…¨é¢æ€§ï¼šnameåˆ—åç§°å‘½åå¤§å°å†™ä¸ç»Ÿä¸€ï¼Œåˆæ³•æ€§ï¼šouncesåˆ—å‡ºç°äº†è´Ÿå€¼ï¼Œå”¯ä¸€æ€§ï¼šé£Ÿç‰©è¡Œå‡ºç°äº†é‡å¤çš„å€¼ï¼Œä¸çŸ¥é“ä»¥å“ªè¡Œä¸ºä¸»ã€‚","like_count":0},{"had_liked":false,"id":89498,"user_name":"ç¿Ÿå°ç«¥","can_delete":false,"product_type":"c1","uid":1466144,"ip_address":"","ucode":"F0A6814C6E75D9","user_header":"https://static001.geekbang.org/account/avatar/00/16/5f/20/fa838240.jpg","comment_is_top":false,"comment_ctime":1556185893,"is_pvip":false,"replies":null,"discussion_count":0,"race_medal":0,"score":11,"product_id":100021701,"comment_content":"path = r&quot;d:&#47;exam.txt&quot;\ndf = pd.read_csv(path, sep=&#39;\\t&#39;)\ndf[&#39;food&#39;] = df[&#39;food&#39;].str.lower()  # foodåˆ—è½¬æ¢ä¸ºå°å†™\nprint(df[&#39;ounces&#39;].isnull().value_counts())#ç»Ÿè®¡ç©ºå¾—æ•°é‡\ndf = df.dropna()  # åˆ é™¤ç©ºè¡Œ\ndf.loc[df[df[&#39;ounces&#39;] &lt; 0].index, &#39;ounces&#39;] = df[df[&#39;food&#39;].isin([&#39;pastrami&#39;])][&#39;ounces&#39;].mean()  # å–å¹³å‡å€¼èµ‹å€¼ç»™å¼‚å¸¸å€¼\n# print(df)\ndf.groupby(&#39;food&#39;).mean()  # è®¡ç®—æ¯ç§é£Ÿç‰©çš„å¹³å‡å€¼\ndf.drop_duplicates([&#39;food&#39;, &#39;animal&#39;], inplace=True)# åˆ é™¤é‡å¤æ•°æ®è¡Œ\ndf.index = range(len(df))","like_count":0},{"had_liked":false,"id":62623,"user_name":"åœ†åœ†çš„å¤§é£Ÿå®¢","can_delete":false,"product_type":"c1","uid":1361827,"ip_address":"","ucode":"B5B87E08869507","user_header":"https://static001.geekbang.org/account/avatar/00/14/c7/a3/1e2f9f5a.jpg","comment_is_top":false,"comment_ctime":1548121648,"is_pvip":false,"replies":null,"discussion_count":0,"race_medal":0,"score":11,"product_id":100021701,"comment_content":"import pandas as pd\ndf = pd.read_csv(&quot;D:\\\\Learning\\\\Data 45 Lessons\\practice11.csv&quot;)\n\n# fill NaN as average\ndf[&#39;ounces&#39;].fillna(df[&#39;ounces&#39;].mean(), inplace = True)\n\n#Delete blank line\ndf.dropna(how = &quot;all&quot;, inplace = True)\n\n#Capitalize food name\ndf[&#39;food&#39;]=df[&#39;food&#39;].str.capitalize()\n\n#Change negative value to positive value\ndf[&#39;ounces&#39;]= df[&#39;ounces&#39;].apply(lambda x: abs(x))\n\n#Delete duplicates\ndf.drop_duplicates([&#39;food&#39;], inplace=True)\n\nprint (df)","like_count":0},{"had_liked":false,"id":58200,"user_name":"å¤è½è‹¥","can_delete":false,"product_type":"c1","uid":1129160,"ip_address":"","ucode":"FAF9968E9B52CE","user_header":"https://static001.geekbang.org/account/avatar/00/11/3a/c8/b85eeb42.jpg","comment_is_top":false,"comment_ctime":1547009660,"is_pvip":false,"replies":null,"discussion_count":0,"race_medal":0,"score":11,"product_id":100021701,"comment_content":"ç”¨ scrapy çˆ¬å–äº†å®‰å±…å®¢æ­¦æ±‰ç§Ÿæˆ¿çš„æ•°æ®2950æ¡ï¼Œæœ‰éœ€è¦çš„å»ä¸‹è½½ï¼šhttps:&#47;&#47;download.csdn.net&#47;download&#47;weidan0302&#47;10905156ï¼Œå¦‚æœéœ€è¦ä»£ç ï¼Œå¯ä»¥è”ç³»æˆ‘","like_count":0},{"had_liked":false,"id":57838,"user_name":"è®²ç©¶äºº","can_delete":false,"product_type":"c1","uid":1352482,"ip_address":"","ucode":"52C0F496A65350","user_header":"https://wx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTKGVWwZB0EwdiajI80w0pIkMRCZGUoAweqG9gVE5hkqkTkZfjTSia7Y9CpAcGMrKTo3UAbHktsFrhYQ/132","comment_is_top":false,"comment_ctime":1546923688,"is_pvip":false,"replies":null,"discussion_count":0,"race_medal":0,"score":11,"product_id":100021701,"comment_content":"è€å¸ˆï¼Œè®²ä¹‰ä¸­çš„æ•°æ®æœ‰æä¾›ä¸‹è½½åœ°å€å—ï¼Ÿ","like_count":0},{"had_liked":false,"id":57712,"user_name":"wolf|â–å¥‡è‘©","can_delete":false,"product_type":"c1","uid":1283222,"ip_address":"","ucode":"04B1BB06CF446E","user_header":"https://static001.geekbang.org/account/avatar/00/13/94/96/520185f0.jpg","comment_is_top":false,"comment_ctime":1546873766,"is_pvip":false,"replies":null,"discussion_count":0,"race_medal":0,"score":11,"product_id":100021701,"comment_content":"å®¢è§‚è¯´åœ¨æå®¢ä¹°äº†å¥½å‡ ä¸ªè¯¾ç¨‹è¿™ä¸ªè¯¾ç¨‹å¸®åŠ©æœ€å¤§ï¼Œå¾ˆå¥½çš„å¸®æˆ‘æ¢³ç†äº†æ€è·¯ï¼Œèƒ½å†å¿«ç‚¹çœ‹åˆ°æ–°è¯¾å°±å¥½äº†ï¼Œé™ˆè€å¸ˆåŠ æ²¹~~","like_count":0},{"had_liked":false,"id":57657,"user_name":"JingZ","can_delete":false,"product_type":"c1","uid":1023464,"ip_address":"","ucode":"6F97895B2CC375","user_header":"https://thirdwx.qlogo.cn/mmopen/vi_32/wJphZ3HcvhjVUyTWCIsCugzfQY5NAy6VJ0XoPLibDlcHWMswFmFe678zd0lUjFETia80NQhyQcVnGDlKgKPcRGyw/132","comment_is_top":false,"comment_ctime":1546862766,"is_pvip":false,"replies":null,"discussion_count":0,"race_medal":0,"score":11,"product_id":100021701,"comment_content":"#2019&#47;1&#47;7 Pandasæ•°æ®æ¸…ç†\n\nå‡è®¾åœºæ™¯æ˜¯é£Ÿå“é‡‡è´­ç¯å¢ƒï¼Œæ ¹æ®â€œå®Œå…¨åˆä¸€â€åŸåˆ™ï¼Œé—®é¢˜å’Œæ¸…æ´—å¦‚ä¸‹ï¼ˆä»£ç å®è·µï¼‰ï¼š\n\n1ã€ouncesç¼ºå¤±å€¼ -&gt; NaNç”¨â€œ0â€æ›¿æ¢\n2ã€ouncesä¸åˆç†å€¼ -&gt; -3ç”¨â€œ3â€æ›¿æ¢ï¼ˆè€ƒè™‘å¯èƒ½è¾“å…¥è€…çš„è¾“å…¥é”™è¯¯ï¼Œé‡‡è´­å¤šç‚¹æ¯”å°‘ç‚¹å¥½ï¼Œå½“ç„¶æˆæœ¬è¿™å„¿åˆ†ææ—¶ç¨å¿½ç•¥ä¸‹ï¼‰\n3ã€foodåˆ—æ•°æ®å¤§å°å†™ -&gt;ç»Ÿä¸€é¦–å­—æ¯ä¸ºå¤§å†™ï¼ˆæ„Ÿè§‰ä¸éœ€è¦åƒäººåå­—é‚£ç§åˆ†å¼€ä¸¤åˆ—ï¼‰\n4ã€animalåˆ—æ„Ÿè§‰éœ€è¦å°†åŒç±»æ”¾ä¸€èµ·è¿›è¡Œæ’åº -&gt;cow&#47;pig&#47;salmonçš„è‹±è¯­å­—æ¯é¡ºåº","like_count":0},{"had_liked":false,"id":57595,"user_name":"æ¢æ—æ¾","can_delete":false,"product_type":"c1","uid":1144766,"ip_address":"","ucode":"FA032C3B4E245E","user_header":"https://static001.geekbang.org/account/avatar/00/11/77/be/1f2409e8.jpg","comment_is_top":false,"comment_ctime":1546844738,"is_pvip":false,"replies":null,"discussion_count":0,"race_medal":0,"score":11,"product_id":100021701,"comment_content":"1ï¼Œ food å¯ä»¥æ”¹ä¸º food name\n2,å€’æ•°ç¬¬3è¡Œ-3.0å’Œæ­£æ•°ç¬¬3è¡ŒNANéœ€è¦å»é™¤ã€‚\n3ï¼Œç»Ÿä¸€å¤§å°å†™ã€‚\n4ï¼Œåˆå¹¶åŒç±»é¡¹ï¼ˆæ­£æ•° 1 ï¼Œ3ï¼Œ 6è¡Œï¼‰ï¼ˆæ­£æ•° 4ï¼Œ7 è¡Œï¼‰ã€‚\n5ï¼ŒæŠŠ ounce å’Œ animal å·¦å³å¯¹è°ƒï¼Œè®©å•ä½åœ¨æœ€å³ç«¯ã€‚\n\n","like_count":0},{"had_liked":false,"id":57566,"user_name":"auroroa","can_delete":false,"product_type":"c1","uid":1057164,"ip_address":"","ucode":"0FF44C9A40E8CD","user_header":"https://static001.geekbang.org/account/avatar/00/10/21/8c/f7a24bc5.jpg","comment_is_top":false,"comment_ctime":1546838724,"is_pvip":false,"replies":null,"discussion_count":0,"race_medal":0,"score":11,"product_id":100021701,"comment_content":"1ã€å®Œæ•´æ€§é—®é¢˜ï¼Œå«æœ‰äº† NA å€¼ï¼Œå› ä¸ºæœ‰é‡å¤è®°å½•ï¼Œæ ¹æ®æ•°æ®æ¥æºæè¿°å¯åˆ¤æ–­å–åŒåç§°è®°å½•ä¸‹çš„å…¶ä»–è¡Œè¯¥åˆ—ä¸ä¸ºç©ºçš„æ•°å€¼\n2ã€å…¨é¢æ€§é—®é¢˜ï¼Œfood åˆ—é¦–å­—æ¯å¤§å°å†™ä¸ä¸€è‡´ï¼Œå¯ç»Ÿä¸€ä¸ºå°å†™\n3ã€åˆç†æ€§é—®é¢˜ï¼Œå«æœ‰ onuces ä¸ºè´Ÿå€¼çš„è®°å½•ï¼Œå› ä¸ºå·²æœ‰è¯¥åç§°é£Ÿç‰©æ•°æ®ï¼Œå¯å‰”é™¤è¯¥è¡Œ\n4ã€å”¯ä¸€æ€§é—®é¢˜ï¼Œç»Ÿä¸€åç§°å¤§å°å†™åæœ‰åŒåé£Ÿç‰©ï¼Œåˆå¹¶è®°å½•åœ¨æ»¡è¶³æ•°æ®åˆç†æ€§å®Œæ•´æ€§æ¡ä»¶ä¸‹åˆ†åˆ«å¯¹å„åˆ—å–æœ€ä¼˜å€¼\nå½“ç„¶æ•°æ®é‡å°‘å’Œæ•°æ®é‡å¤§çš„æ—¶å€™å¤„ç†æ–¹å¼å¯èƒ½ä¸ä¸€æ ·","like_count":0},{"had_liked":false,"id":57556,"user_name":"æµ©ç„¶","can_delete":false,"product_type":"c1","uid":1295043,"ip_address":"","ucode":"D1FB4E3E7ADE5F","user_header":"https://static001.geekbang.org/account/avatar/00/13/c2/c3/da31c9c2.jpg","comment_is_top":false,"comment_ctime":1546833328,"is_pvip":false,"replies":null,"discussion_count":0,"race_medal":0,"score":11,"product_id":100021701,"comment_content":"åˆ æ‰è´Ÿå€¼è¡Œï¼Œpigçš„ç©ºå€¼ç”¨pigçš„å¹³å‡æ•°å¡«å……","like_count":0},{"had_liked":false,"id":57495,"user_name":"æ¢…ç ´çŸ¥æ˜¥è¿‘","can_delete":false,"product_type":"c1","uid":1189241,"ip_address":"","ucode":"A9FCC5B1ED6E0A","user_header":"https://static001.geekbang.org/account/avatar/00/12/25/79/c7bcdefc.jpg","comment_is_top":false,"comment_ctime":1546822927,"is_pvip":false,"replies":null,"discussion_count":0,"race_medal":0,"score":11,"product_id":100021701,"comment_content":"é¦–å…ˆfoodåˆ—æ–‡æœ¬éƒ½æ”¹ä¸ºå°å†™ï¼Œ.lower()ï¼Œå¯¹foodåˆ—å»é‡ï¼Œå»é‡è§„åˆ™ä¸ºç¬¬äºŒåˆ—ä¼˜å…ˆä¿ç•™å¤§äº0çš„æ•°å€¼ï¼Œä¼˜å…ˆä¿ç•™éNAå€¼ï¼Œå»é‡åæ£€éªŒæ˜¯å¦è¿˜æœ‰NAï¼Œå¡«å……NAå€¼ã€‚","like_count":0},{"had_liked":false,"id":89498,"user_name":"ç¿Ÿå°ç«¥","can_delete":false,"product_type":"c1","uid":1466144,"ip_address":"","ucode":"F0A6814C6E75D9","user_header":"https://static001.geekbang.org/account/avatar/00/16/5f/20/fa838240.jpg","comment_is_top":false,"comment_ctime":1556185893,"is_pvip":false,"replies":null,"discussion_count":0,"race_medal":0,"score":11,"product_id":100021701,"comment_content":"path = r&quot;d:&#47;exam.txt&quot;\ndf = pd.read_csv(path, sep=&#39;\\t&#39;)\ndf[&#39;food&#39;] = df[&#39;food&#39;].str.lower()  # foodåˆ—è½¬æ¢ä¸ºå°å†™\nprint(df[&#39;ounces&#39;].isnull().value_counts())#ç»Ÿè®¡ç©ºå¾—æ•°é‡\ndf = df.dropna()  # åˆ é™¤ç©ºè¡Œ\ndf.loc[df[df[&#39;ounces&#39;] &lt; 0].index, &#39;ounces&#39;] = df[df[&#39;food&#39;].isin([&#39;pastrami&#39;])][&#39;ounces&#39;].mean()  # å–å¹³å‡å€¼èµ‹å€¼ç»™å¼‚å¸¸å€¼\n# print(df)\ndf.groupby(&#39;food&#39;).mean()  # è®¡ç®—æ¯ç§é£Ÿç‰©çš„å¹³å‡å€¼\ndf.drop_duplicates([&#39;food&#39;, &#39;animal&#39;], inplace=True)# åˆ é™¤é‡å¤æ•°æ®è¡Œ\ndf.index = range(len(df))","like_count":0},{"had_liked":false,"id":62623,"user_name":"åœ†åœ†çš„å¤§é£Ÿå®¢","can_delete":false,"product_type":"c1","uid":1361827,"ip_address":"","ucode":"B5B87E08869507","user_header":"https://static001.geekbang.org/account/avatar/00/14/c7/a3/1e2f9f5a.jpg","comment_is_top":false,"comment_ctime":1548121648,"is_pvip":false,"replies":null,"discussion_count":0,"race_medal":0,"score":11,"product_id":100021701,"comment_content":"import pandas as pd\ndf = pd.read_csv(&quot;D:\\\\Learning\\\\Data 45 Lessons\\practice11.csv&quot;)\n\n# fill NaN as average\ndf[&#39;ounces&#39;].fillna(df[&#39;ounces&#39;].mean(), inplace = True)\n\n#Delete blank line\ndf.dropna(how = &quot;all&quot;, inplace = True)\n\n#Capitalize food name\ndf[&#39;food&#39;]=df[&#39;food&#39;].str.capitalize()\n\n#Change negative value to positive value\ndf[&#39;ounces&#39;]= df[&#39;ounces&#39;].apply(lambda x: abs(x))\n\n#Delete duplicates\ndf.drop_duplicates([&#39;food&#39;], inplace=True)\n\nprint (df)","like_count":0},{"had_liked":false,"id":58200,"user_name":"å¤è½è‹¥","can_delete":false,"product_type":"c1","uid":1129160,"ip_address":"","ucode":"FAF9968E9B52CE","user_header":"https://static001.geekbang.org/account/avatar/00/11/3a/c8/b85eeb42.jpg","comment_is_top":false,"comment_ctime":1547009660,"is_pvip":false,"replies":null,"discussion_count":0,"race_medal":0,"score":11,"product_id":100021701,"comment_content":"ç”¨ scrapy çˆ¬å–äº†å®‰å±…å®¢æ­¦æ±‰ç§Ÿæˆ¿çš„æ•°æ®2950æ¡ï¼Œæœ‰éœ€è¦çš„å»ä¸‹è½½ï¼šhttps:&#47;&#47;download.csdn.net&#47;download&#47;weidan0302&#47;10905156ï¼Œå¦‚æœéœ€è¦ä»£ç ï¼Œå¯ä»¥è”ç³»æˆ‘","like_count":0},{"had_liked":false,"id":57838,"user_name":"è®²ç©¶äºº","can_delete":false,"product_type":"c1","uid":1352482,"ip_address":"","ucode":"52C0F496A65350","user_header":"https://wx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTKGVWwZB0EwdiajI80w0pIkMRCZGUoAweqG9gVE5hkqkTkZfjTSia7Y9CpAcGMrKTo3UAbHktsFrhYQ/132","comment_is_top":false,"comment_ctime":1546923688,"is_pvip":false,"replies":null,"discussion_count":0,"race_medal":0,"score":11,"product_id":100021701,"comment_content":"è€å¸ˆï¼Œè®²ä¹‰ä¸­çš„æ•°æ®æœ‰æä¾›ä¸‹è½½åœ°å€å—ï¼Ÿ","like_count":0},{"had_liked":false,"id":57712,"user_name":"wolf|â–å¥‡è‘©","can_delete":false,"product_type":"c1","uid":1283222,"ip_address":"","ucode":"04B1BB06CF446E","user_header":"https://static001.geekbang.org/account/avatar/00/13/94/96/520185f0.jpg","comment_is_top":false,"comment_ctime":1546873766,"is_pvip":false,"replies":null,"discussion_count":0,"race_medal":0,"score":11,"product_id":100021701,"comment_content":"å®¢è§‚è¯´åœ¨æå®¢ä¹°äº†å¥½å‡ ä¸ªè¯¾ç¨‹è¿™ä¸ªè¯¾ç¨‹å¸®åŠ©æœ€å¤§ï¼Œå¾ˆå¥½çš„å¸®æˆ‘æ¢³ç†äº†æ€è·¯ï¼Œèƒ½å†å¿«ç‚¹çœ‹åˆ°æ–°è¯¾å°±å¥½äº†ï¼Œé™ˆè€å¸ˆåŠ æ²¹~~","like_count":0},{"had_liked":false,"id":57657,"user_name":"JingZ","can_delete":false,"product_type":"c1","uid":1023464,"ip_address":"","ucode":"6F97895B2CC375","user_header":"https://thirdwx.qlogo.cn/mmopen/vi_32/wJphZ3HcvhjVUyTWCIsCugzfQY5NAy6VJ0XoPLibDlcHWMswFmFe678zd0lUjFETia80NQhyQcVnGDlKgKPcRGyw/132","comment_is_top":false,"comment_ctime":1546862766,"is_pvip":false,"replies":null,"discussion_count":0,"race_medal":0,"score":11,"product_id":100021701,"comment_content":"#2019&#47;1&#47;7 Pandasæ•°æ®æ¸…ç†\n\nå‡è®¾åœºæ™¯æ˜¯é£Ÿå“é‡‡è´­ç¯å¢ƒï¼Œæ ¹æ®â€œå®Œå…¨åˆä¸€â€åŸåˆ™ï¼Œé—®é¢˜å’Œæ¸…æ´—å¦‚ä¸‹ï¼ˆä»£ç å®è·µï¼‰ï¼š\n\n1ã€ouncesç¼ºå¤±å€¼ -&gt; NaNç”¨â€œ0â€æ›¿æ¢\n2ã€ouncesä¸åˆç†å€¼ -&gt; -3ç”¨â€œ3â€æ›¿æ¢ï¼ˆè€ƒè™‘å¯èƒ½è¾“å…¥è€…çš„è¾“å…¥é”™è¯¯ï¼Œé‡‡è´­å¤šç‚¹æ¯”å°‘ç‚¹å¥½ï¼Œå½“ç„¶æˆæœ¬è¿™å„¿åˆ†ææ—¶ç¨å¿½ç•¥ä¸‹ï¼‰\n3ã€foodåˆ—æ•°æ®å¤§å°å†™ -&gt;ç»Ÿä¸€é¦–å­—æ¯ä¸ºå¤§å†™ï¼ˆæ„Ÿè§‰ä¸éœ€è¦åƒäººåå­—é‚£ç§åˆ†å¼€ä¸¤åˆ—ï¼‰\n4ã€animalåˆ—æ„Ÿè§‰éœ€è¦å°†åŒç±»æ”¾ä¸€èµ·è¿›è¡Œæ’åº -&gt;cow&#47;pig&#47;salmonçš„è‹±è¯­å­—æ¯é¡ºåº","like_count":0},{"had_liked":false,"id":57595,"user_name":"æ¢æ—æ¾","can_delete":false,"product_type":"c1","uid":1144766,"ip_address":"","ucode":"FA032C3B4E245E","user_header":"https://static001.geekbang.org/account/avatar/00/11/77/be/1f2409e8.jpg","comment_is_top":false,"comment_ctime":1546844738,"is_pvip":false,"replies":null,"discussion_count":0,"race_medal":0,"score":11,"product_id":100021701,"comment_content":"1ï¼Œ food å¯ä»¥æ”¹ä¸º food name\n2,å€’æ•°ç¬¬3è¡Œ-3.0å’Œæ­£æ•°ç¬¬3è¡ŒNANéœ€è¦å»é™¤ã€‚\n3ï¼Œç»Ÿä¸€å¤§å°å†™ã€‚\n4ï¼Œåˆå¹¶åŒç±»é¡¹ï¼ˆæ­£æ•° 1 ï¼Œ3ï¼Œ 6è¡Œï¼‰ï¼ˆæ­£æ•° 4ï¼Œ7 è¡Œï¼‰ã€‚\n5ï¼ŒæŠŠ ounce å’Œ animal å·¦å³å¯¹è°ƒï¼Œè®©å•ä½åœ¨æœ€å³ç«¯ã€‚\n\n","like_count":0},{"had_liked":false,"id":57566,"user_name":"auroroa","can_delete":false,"product_type":"c1","uid":1057164,"ip_address":"","ucode":"0FF44C9A40E8CD","user_header":"https://static001.geekbang.org/account/avatar/00/10/21/8c/f7a24bc5.jpg","comment_is_top":false,"comment_ctime":1546838724,"is_pvip":false,"replies":null,"discussion_count":0,"race_medal":0,"score":11,"product_id":100021701,"comment_content":"1ã€å®Œæ•´æ€§é—®é¢˜ï¼Œå«æœ‰äº† NA å€¼ï¼Œå› ä¸ºæœ‰é‡å¤è®°å½•ï¼Œæ ¹æ®æ•°æ®æ¥æºæè¿°å¯åˆ¤æ–­å–åŒåç§°è®°å½•ä¸‹çš„å…¶ä»–è¡Œè¯¥åˆ—ä¸ä¸ºç©ºçš„æ•°å€¼\n2ã€å…¨é¢æ€§é—®é¢˜ï¼Œfood åˆ—é¦–å­—æ¯å¤§å°å†™ä¸ä¸€è‡´ï¼Œå¯ç»Ÿä¸€ä¸ºå°å†™\n3ã€åˆç†æ€§é—®é¢˜ï¼Œå«æœ‰ onuces ä¸ºè´Ÿå€¼çš„è®°å½•ï¼Œå› ä¸ºå·²æœ‰è¯¥åç§°é£Ÿç‰©æ•°æ®ï¼Œå¯å‰”é™¤è¯¥è¡Œ\n4ã€å”¯ä¸€æ€§é—®é¢˜ï¼Œç»Ÿä¸€åç§°å¤§å°å†™åæœ‰åŒåé£Ÿç‰©ï¼Œåˆå¹¶è®°å½•åœ¨æ»¡è¶³æ•°æ®åˆç†æ€§å®Œæ•´æ€§æ¡ä»¶ä¸‹åˆ†åˆ«å¯¹å„åˆ—å–æœ€ä¼˜å€¼\nå½“ç„¶æ•°æ®é‡å°‘å’Œæ•°æ®é‡å¤§çš„æ—¶å€™å¤„ç†æ–¹å¼å¯èƒ½ä¸ä¸€æ ·","like_count":0},{"had_liked":false,"id":57556,"user_name":"æµ©ç„¶","can_delete":false,"product_type":"c1","uid":1295043,"ip_address":"","ucode":"D1FB4E3E7ADE5F","user_header":"https://static001.geekbang.org/account/avatar/00/13/c2/c3/da31c9c2.jpg","comment_is_top":false,"comment_ctime":1546833328,"is_pvip":false,"replies":null,"discussion_count":0,"race_medal":0,"score":11,"product_id":100021701,"comment_content":"åˆ æ‰è´Ÿå€¼è¡Œï¼Œpigçš„ç©ºå€¼ç”¨pigçš„å¹³å‡æ•°å¡«å……","like_count":0},{"had_liked":false,"id":57495,"user_name":"æ¢…ç ´çŸ¥æ˜¥è¿‘","can_delete":false,"product_type":"c1","uid":1189241,"ip_address":"","ucode":"A9FCC5B1ED6E0A","user_header":"https://static001.geekbang.org/account/avatar/00/12/25/79/c7bcdefc.jpg","comment_is_top":false,"comment_ctime":1546822927,"is_pvip":false,"replies":null,"discussion_count":0,"race_medal":0,"score":11,"product_id":100021701,"comment_content":"é¦–å…ˆfoodåˆ—æ–‡æœ¬éƒ½æ”¹ä¸ºå°å†™ï¼Œ.lower()ï¼Œå¯¹foodåˆ—å»é‡ï¼Œå»é‡è§„åˆ™ä¸ºç¬¬äºŒåˆ—ä¼˜å…ˆä¿ç•™å¤§äº0çš„æ•°å€¼ï¼Œä¼˜å…ˆä¿ç•™éNAå€¼ï¼Œå»é‡åæ£€éªŒæ˜¯å¦è¿˜æœ‰NAï¼Œå¡«å……NAå€¼ã€‚","like_count":0},{"had_liked":false,"id":57485,"user_name":"æ— æ³•è¨€å–».","can_delete":false,"product_type":"c1","uid":1322328,"ip_address":"","ucode":"7F375BE388D4FC","user_header":"https://static001.geekbang.org/account/avatar/00/14/2d/58/aa35c402.jpg","comment_is_top":false,"comment_ctime":1546821718,"is_pvip":false,"replies":null,"discussion_count":0,"race_medal":0,"score":12,"product_id":100021701,"comment_content":"å¤§å°å†™ é‡å¤å€¼ ç©ºå€¼ åˆ†ç±»æ•°å€¼åŒ– \næœ‰ä¹‹å‰è®²è§£çš„æœè£…åº—ä¼šå‘˜çš„csvå—ï¼Ÿ","like_count":0},{"had_liked":false,"id":57475,"user_name":"Python","can_delete":false,"product_type":"c1","uid":1276314,"ip_address":"","ucode":"969500D2A88AE6","user_header":"https://static001.geekbang.org/account/avatar/00/13/79/9a/4f907ad6.jpg","comment_is_top":false,"comment_ctime":1546820550,"is_pvip":false,"replies":null,"discussion_count":0,"race_medal":0,"score":12,"product_id":100021701,"comment_content":"ç›´æ¥æŠŠè´Ÿä¸‰ï¼Œä»¥åŠç©ºå€¼é‚£ä¸¤è¡Œåˆ é™¤ï¼Œå› ä¸ºå¥¹ä»¬æ—¢æ˜¯foodçš„é‡å¤è¡Œï¼Œä¹Ÿæ˜¯ä¸åˆæ ¼çš„æ•°æ®","like_count":0},{"had_liked":false,"id":57451,"user_name":"è¨±æ•²æ•²","can_delete":false,"product_type":"c1","uid":1046681,"ip_address":"","ucode":"6486466820E7BF","user_header":"https://static001.geekbang.org/account/avatar/00/0f/f8/99/8e760987.jpg","comment_is_top":false,"comment_ctime":1546793174,"is_pvip":false,"replies":null,"discussion_count":0,"race_medal":0,"score":12,"product_id":100021701,"comment_content":"foodéƒ½å°å†™å å»é‡ï¼Œé‡é‡éƒ½å–ç»å¯¹å€¼ï¼Œå†å¡«å……NAå€¼ã€‚","like_count":0},{"had_liked":false,"id":57445,"user_name":"èœ˜è››çš„æ¢¦å‘“","can_delete":false,"product_type":"c1","uid":1190207,"ip_address":"","ucode":"42FF5C7FF4D2E1","user_header":"https://static001.geekbang.org/account/avatar/00/12/29/3f/ae7718f6.jpg","comment_is_top":false,"comment_ctime":1546792554,"is_pvip":false,"replies":null,"discussion_count":0,"race_medal":0,"score":12,"product_id":100021701,"comment_content":"é¦–å…ˆï¼Œç»Ÿä¸€åˆ—åï¼ŒæŠŠåˆ—åéƒ½æ”¹ä¸ºå°å†™ã€‚\nç„¶åï¼Œå¼‚å¸¸å¤„ç†ï¼Œå»æ‰ä¸åˆå¸¸ç†çš„æ•°å€¼(è´Ÿæ•°)ï¼Œç©ºå€¼åˆ é™¤æˆ–ç”¨å¹³å‡æ•°å¡«å……ã€‚\næœ€åï¼Œå»é‡ï¼Œåˆ é™¤é‡å¤åˆ—ã€‚","like_count":0},{"had_liked":false,"id":57485,"user_name":"æ— æ³•è¨€å–».","can_delete":false,"product_type":"c1","uid":1322328,"ip_address":"","ucode":"7F375BE388D4FC","user_header":"https://static001.geekbang.org/account/avatar/00/14/2d/58/aa35c402.jpg","comment_is_top":false,"comment_ctime":1546821718,"is_pvip":false,"replies":null,"discussion_count":0,"race_medal":0,"score":12,"product_id":100021701,"comment_content":"å¤§å°å†™ é‡å¤å€¼ ç©ºå€¼ åˆ†ç±»æ•°å€¼åŒ– \næœ‰ä¹‹å‰è®²è§£çš„æœè£…åº—ä¼šå‘˜çš„csvå—ï¼Ÿ","like_count":0},{"had_liked":false,"id":57475,"user_name":"Python","can_delete":false,"product_type":"c1","uid":1276314,"ip_address":"","ucode":"969500D2A88AE6","user_header":"https://static001.geekbang.org/account/avatar/00/13/79/9a/4f907ad6.jpg","comment_is_top":false,"comment_ctime":1546820550,"is_pvip":false,"replies":null,"discussion_count":0,"race_medal":0,"score":12,"product_id":100021701,"comment_content":"ç›´æ¥æŠŠè´Ÿä¸‰ï¼Œä»¥åŠç©ºå€¼é‚£ä¸¤è¡Œåˆ é™¤ï¼Œå› ä¸ºå¥¹ä»¬æ—¢æ˜¯foodçš„é‡å¤è¡Œï¼Œä¹Ÿæ˜¯ä¸åˆæ ¼çš„æ•°æ®","like_count":0},{"had_liked":false,"id":57451,"user_name":"è¨±æ•²æ•²","can_delete":false,"product_type":"c1","uid":1046681,"ip_address":"","ucode":"6486466820E7BF","user_header":"https://static001.geekbang.org/account/avatar/00/0f/f8/99/8e760987.jpg","comment_is_top":false,"comment_ctime":1546793174,"is_pvip":false,"replies":null,"discussion_count":0,"race_medal":0,"score":12,"product_id":100021701,"comment_content":"foodéƒ½å°å†™å å»é‡ï¼Œé‡é‡éƒ½å–ç»å¯¹å€¼ï¼Œå†å¡«å……NAå€¼ã€‚","like_count":0},{"had_liked":false,"id":57445,"user_name":"èœ˜è››çš„æ¢¦å‘“","can_delete":false,"product_type":"c1","uid":1190207,"ip_address":"","ucode":"42FF5C7FF4D2E1","user_header":"https://static001.geekbang.org/account/avatar/00/12/29/3f/ae7718f6.jpg","comment_is_top":false,"comment_ctime":1546792554,"is_pvip":false,"replies":null,"discussion_count":0,"race_medal":0,"score":12,"product_id":100021701,"comment_content":"é¦–å…ˆï¼Œç»Ÿä¸€åˆ—åï¼ŒæŠŠåˆ—åéƒ½æ”¹ä¸ºå°å†™ã€‚\nç„¶åï¼Œå¼‚å¸¸å¤„ç†ï¼Œå»æ‰ä¸åˆå¸¸ç†çš„æ•°å€¼(è´Ÿæ•°)ï¼Œç©ºå€¼åˆ é™¤æˆ–ç”¨å¹³å‡æ•°å¡«å……ã€‚\næœ€åï¼Œå»é‡ï¼Œåˆ é™¤é‡å¤åˆ—ã€‚","like_count":0}]}