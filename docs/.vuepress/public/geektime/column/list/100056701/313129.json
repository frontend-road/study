{"id":313129,"title":"41 |  ç¬¬35ï½40è®²è¯¾åæ€è€ƒé¢˜ç­”æ¡ˆåŠå¸¸è§é—®é¢˜ç­”ç–‘","content":"<p>ä½ å¥½ï¼Œæˆ‘æ˜¯è’‹å¾·é’§ã€‚</p><p>ä»Šå¤©æ˜¯æˆ‘ä»¬æœ€åä¸€èŠ‚ç­”ç–‘è¯¾ï¼Œæˆ‘ä¼šå¸¦ä½ ä¸€èµ·åˆ†æä¸€ä¸‹ç¬¬35ï½40è®²çš„è¯¾åæ€è€ƒé¢˜ã€‚åŒæ—¶ï¼Œæˆ‘è¿˜ä¼šè®²è§£ä¸¤ä¸ªå…¸å‹é—®é¢˜ï¼Œåˆ†åˆ«æ˜¯åŸå­æ“ä½œä½¿ç”¨é—®é¢˜ï¼Œä»¥åŠRediså’Œå…¶ä»–é”®å€¼æ•°æ®åº“çš„å¯¹æ¯”æƒ…å†µã€‚</p><h2><a href=\"https://time.geekbang.org/column/article/306548\">ç¬¬35è®²</a></h2><p>é—®é¢˜ï¼šå‡è®¾Codisé›†ç¾¤ä¸­ä¿å­˜çš„80%çš„é”®å€¼å¯¹éƒ½æ˜¯Hashç±»å‹ï¼Œæ¯ä¸ªHashé›†åˆçš„å…ƒç´ æ•°é‡åœ¨10ä¸‡~20ä¸‡ä¸ªï¼Œæ¯ä¸ªé›†åˆå…ƒç´ çš„å¤§å°æ˜¯2KBã€‚ä½ è§‰å¾—ï¼Œè¿ç§»è¿™æ ·çš„Hashé›†åˆæ•°æ®ï¼Œä¼šå¯¹Codisçš„æ€§èƒ½é€ æˆå½±å“å—ï¼Ÿ</p><p>ç­”æ¡ˆï¼šå…¶å®å½±å“ä¸å¤§ã€‚è™½ç„¶ä¸€ä¸ªHashé›†åˆæ•°æ®çš„æ€»æ•°æ®é‡æœ‰200MB ~ 400MBï¼ˆ2KB * 0.1M â‰ˆ 200MBåˆ° 2KB * 0.2M  â‰ˆ 400MBï¼‰ï¼Œä½†æ˜¯Codisæ”¯æŒå¼‚æ­¥ã€åˆ†æ‰¹è¿ç§»æ•°æ®ï¼Œæ‰€ä»¥ï¼ŒCodiså¯ä»¥æŠŠé›†åˆä¸­çš„å…ƒç´ åˆ†å¤šä¸ªæ‰¹æ¬¡è¿›è¡Œè¿ç§»ï¼Œæ¯æ‰¹æ¬¡è¿ç§»çš„æ•°æ®é‡ä¸å¤§ï¼Œæ‰€ä»¥ï¼Œä¸ä¼šç»™æºå®ä¾‹é€ æˆå¤ªå¤§å½±å“ã€‚</p><h2><a href=\"https://time.geekbang.org/column/article/307421\">ç¬¬36è®²</a></h2><p>é—®é¢˜ï¼šå‡è®¾ä¸€ä¸ªå•†å“çš„åº“å­˜é‡æ˜¯800ï¼Œæˆ‘ä»¬ä½¿ç”¨ä¸€ä¸ªåŒ…å«äº†4ä¸ªå®ä¾‹çš„åˆ‡ç‰‡é›†ç¾¤æ¥æœåŠ¡ç§’æ€è¯·æ±‚ï¼Œæˆ‘ä»¬è®©æ¯ä¸ªå®ä¾‹å„è‡ªç»´æŠ¤åº“å­˜é‡200ï¼ŒæŠŠå®¢æˆ·ç«¯çš„ç§’æ€è¯·æ±‚åˆ†å‘åˆ°ä¸åŒçš„å®ä¾‹ä¸Šè¿›è¡Œå¤„ç†ï¼Œä½ è§‰å¾—è¿™æ˜¯ä¸€ä¸ªå¥½æ–¹æ³•å—ï¼Ÿ</p><p>ç­”æ¡ˆï¼šè¿™ä¸ªæ–¹æ³•æ˜¯ä¸æ˜¯èƒ½è¾¾åˆ°ä¸€ä¸ªå¥½çš„æ•ˆæœï¼Œä¸»è¦å–å†³äºï¼Œ<strong>å®¢æˆ·ç«¯è¯·æ±‚èƒ½ä¸èƒ½å‡åŒ€åœ°åˆ†å‘åˆ°æ¯ä¸ªå®ä¾‹ä¸Š</strong>ã€‚å¦‚æœå¯ä»¥çš„è¯ï¼Œé‚£ä¹ˆï¼Œæ¯ä¸ªå®ä¾‹éƒ½å¯ä»¥å¸®ç€åˆ†æ‹…ä¸€éƒ¨åˆ†å‹åŠ›ï¼Œé¿å…å‹å®å•ä¸ªå®ä¾‹ã€‚</p><!-- [[[read_end]]] --><p>åœ¨ä¿å­˜å•†å“åº“å­˜æ—¶ï¼Œkeyä¸€èˆ¬å°±æ˜¯å•†å“çš„IDï¼Œæ‰€ä»¥ï¼Œå®¢æˆ·ç«¯åœ¨ç§’æ€åœºæ™¯ä¸­æŸ¥è¯¢åŒä¸€ä¸ªå•†å“çš„åº“å­˜æ—¶ï¼Œä¼šå‘é›†ç¾¤è¯·æ±‚ç›¸åŒçš„keyï¼Œé›†ç¾¤å°±éœ€è¦æŠŠå®¢æˆ·ç«¯å¯¹åŒä¸€ä¸ªkeyçš„è¯·æ±‚å‡åŒ€åœ°åˆ†å‘åˆ°å¤šä¸ªå®ä¾‹ä¸Šã€‚</p><p>ä¸ºäº†è§£å†³è¿™ä¸ªé—®é¢˜ï¼Œå®¢æˆ·ç«¯å’Œå®ä¾‹é—´å°±éœ€è¦æœ‰ä»£ç†å±‚æ¥å®Œæˆè¯·æ±‚çš„è½¬å‘ã€‚ä¾‹å¦‚ï¼Œåœ¨Codisä¸­ï¼Œcodis proxyè´Ÿè´£è½¬å‘è¯·æ±‚ï¼Œé‚£ä¹ˆï¼Œå¦‚æœæˆ‘ä»¬è®©codis proxyæ”¶åˆ°è¯·æ±‚åï¼ŒæŒ‰è½®è¯¢çš„æ–¹å¼æŠŠè¯·æ±‚åˆ†å‘åˆ°ä¸åŒå®ä¾‹ä¸Šï¼ˆå¯ä»¥å¯¹Codisè¿›è¡Œä¿®æ”¹ï¼Œå¢åŠ è½¬å‘è§„åˆ™ï¼‰ï¼Œå°±å¯ä»¥åˆ©ç”¨å¤šå®ä¾‹æ¥åˆ†æ‹…è¯·æ±‚å‹åŠ›äº†ã€‚</p><p>å¦‚æœæ²¡æœ‰ä»£ç†å±‚çš„è¯ï¼Œå®¢æˆ·ç«¯ä¼šæ ¹æ®keyå’ŒSlotçš„æ˜ å°„å…³ç³»ï¼Œä»¥åŠSlotå’Œå®ä¾‹çš„åˆ†é…å…³ç³»ï¼Œç›´æ¥æŠŠè¯·æ±‚å‘ç»™ä¿å­˜keyçš„å”¯ä¸€å®ä¾‹äº†ã€‚åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œè¯·æ±‚å‹åŠ›å°±æ— æ³•ç”±å¤šä¸ªå®ä¾‹è¿›è¡Œåˆ†æ‹…äº†ã€‚é¢˜ç›®ä¸­æè¿°çš„è¿™ä¸ªæ–¹æ³•ä¹Ÿå°±ä¸èƒ½è¾¾åˆ°å¥½çš„æ•ˆæœäº†ã€‚</p><h2><a href=\"https://time.geekbang.org/column/article/308393\">ç¬¬37è®²</a></h2><p>é—®é¢˜ï¼šå½“æœ‰æ•°æ®è®¿é—®å€¾æ–œæ—¶ï¼Œå¦‚æœçƒ­ç‚¹æ•°æ®çªç„¶è¿‡æœŸäº†ï¼Œå‡è®¾Redisä¸­çš„æ•°æ®æ˜¯ç¼“å­˜ï¼Œæ•°æ®çš„æœ€ç»ˆå€¼æ˜¯ä¿å­˜åœ¨åç«¯æ•°æ®åº“ä¸­çš„ï¼Œè¿™æ ·ä¼šå‘ç”Ÿä»€ä¹ˆé—®é¢˜å—?</p><p>ç­”æ¡ˆï¼šåœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œä¼šå‘ç”Ÿç¼“å­˜å‡»ç©¿çš„é—®é¢˜ï¼Œä¹Ÿå°±æ˜¯çƒ­ç‚¹æ•°æ®çªç„¶å¤±æ•ˆï¼Œå¯¼è‡´å¤§é‡è®¿é—®è¯·æ±‚è¢«å‘é€åˆ°æ•°æ®åº“ï¼Œç»™æ•°æ®åº“å¸¦æ¥å·¨å¤§å‹åŠ›ã€‚</p><p>æˆ‘ä»¬å¯ä»¥é‡‡ç”¨<a href=\"https://time.geekbang.org/column/article/296586\">ç¬¬26è®²</a>ä¸­ä»‹ç»çš„æ–¹æ³•ï¼Œä¸ç»™çƒ­ç‚¹æ•°æ®è®¾ç½®è¿‡æœŸæ—¶é—´ï¼Œè¿™æ ·å¯ä»¥é¿å…è¿‡æœŸå¸¦æ¥çš„å‡»ç©¿é—®é¢˜ã€‚</p><p>é™¤æ­¤ä¹‹å¤–ï¼Œæˆ‘ä»¬æœ€å¥½åœ¨æ•°æ®åº“çš„æ¥å…¥å±‚å¢åŠ æµæ§æœºåˆ¶ï¼Œä¸€æ—¦ç›‘æµ‹åˆ°æœ‰å¤§æµé‡è¯·æ±‚è®¿é—®æ•°æ®åº“ï¼Œç«‹åˆ»å¼€å¯é™æµï¼Œè¿™æ ·åšä¹Ÿæ˜¯ä¸ºäº†é¿å…æ•°æ®åº“è¢«å¤§æµé‡å‹åŠ›å‹å®ã€‚å› ä¸ºæ•°æ®åº“ä¸€æ—¦å®•æœºï¼Œå°±ä¼šå¯¹æ•´ä¸ªä¸šåŠ¡åº”ç”¨å¸¦æ¥ä¸¥é‡å½±å“ã€‚æ‰€ä»¥ï¼Œæˆ‘ä»¬å®å¯åœ¨è¯·æ±‚æ¥å…¥æ•°æ®åº“æ—¶ï¼Œå°±ç›´æ¥æ‹’æ¥è¯·æ±‚è®¿é—®ã€‚</p><h2><a href=\"https://time.geekbang.org/column/article/310347\">ç¬¬38è®²</a></h2><p>é—®é¢˜ï¼šå¦‚æœæˆ‘ä»¬é‡‡ç”¨è·ŸCodisä¿å­˜Slotåˆ†é…ä¿¡æ¯ç›¸ç±»ä¼¼çš„æ–¹æ³•ï¼ŒæŠŠé›†ç¾¤å®ä¾‹çŠ¶æ€ä¿¡æ¯å’ŒSlotåˆ†é…ä¿¡æ¯ä¿å­˜åœ¨ç¬¬ä¸‰æ–¹çš„å­˜å‚¨ç³»ç»Ÿä¸Šï¼ˆä¾‹å¦‚Zookeeperï¼‰ï¼Œè¿™ç§æ–¹æ³•ä¼šå¯¹é›†ç¾¤è§„æ¨¡äº§ç”Ÿä»€ä¹ˆå½±å“å—ï¼Ÿ</p><p>ç­”æ¡ˆï¼šå‡è®¾æˆ‘ä»¬å°†Zookeeperä½œä¸ºç¬¬ä¸‰æ–¹å­˜å‚¨ç³»ç»Ÿï¼Œä¿å­˜é›†ç¾¤å®ä¾‹çŠ¶æ€ä¿¡æ¯å’ŒSlotåˆ†é…ä¿¡æ¯ï¼Œé‚£ä¹ˆï¼Œå®ä¾‹åªéœ€è¦å’ŒZookeeperé€šä¿¡äº¤äº’ä¿¡æ¯ï¼Œå®ä¾‹ä¹‹é—´å°±ä¸éœ€è¦å‘é€å¤§é‡çš„å¿ƒè·³æ¶ˆæ¯æ¥åŒæ­¥é›†ç¾¤çŠ¶æ€äº†ã€‚è¿™ç§åšæ³•å¯ä»¥å‡å°‘å®ä¾‹ä¹‹é—´ç”¨äºå¿ƒè·³çš„ç½‘ç»œé€šä¿¡é‡ï¼Œæœ‰åŠ©äºå®ç°å¤§è§„æ¨¡é›†ç¾¤ã€‚è€Œä¸”ï¼Œç½‘ç»œå¸¦å®½å¯ä»¥é›†ä¸­ç”¨åœ¨æœåŠ¡å®¢æˆ·ç«¯è¯·æ±‚ä¸Šã€‚</p><p>ä¸è¿‡ï¼Œåœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œå®ä¾‹è·å–æˆ–æ›´æ–°é›†ç¾¤çŠ¶æ€ä¿¡æ¯æ—¶ï¼Œéƒ½éœ€è¦å’ŒZookeeperäº¤äº’ï¼ŒZookeeperçš„ç½‘ç»œé€šä¿¡å¸¦å®½éœ€æ±‚ä¼šå¢åŠ ã€‚æ‰€ä»¥ï¼Œé‡‡ç”¨è¿™ç§æ–¹æ³•çš„æ—¶å€™ï¼Œéœ€è¦ç»™Zookeeperä¿è¯ä¸€å®šçš„ç½‘ç»œå¸¦å®½ï¼Œé¿å…Zookeeperå—é™äºå¸¦å®½è€Œæ— æ³•å’Œå®ä¾‹å¿«é€Ÿé€šä¿¡ã€‚</p><h2><a href=\"https://time.geekbang.org/column/article/310838\">ç¬¬39è®²</a></h2><p>é—®é¢˜ï¼šä½ è§‰å¾—ï¼ŒRedis 6.0çš„å“ªä¸ªæˆ–å“ªäº›æ–°ç‰¹æ€§ä¼šå¯¹ä½ æœ‰å¸®åŠ©å‘¢ï¼Ÿ</p><p>ç­”æ¡ˆï¼šè¿™ä¸ªè¦æ ¹æ®ä½ ä»¬çš„å…·ä½“éœ€æ±‚æ¥å®šã€‚ä»æå‡æ€§èƒ½çš„è§’åº¦ä¸Šæ¥è¯´ï¼ŒRedis 6.0ä¸­çš„å¤šIOçº¿ç¨‹ç‰¹æ€§å¯ä»¥ç¼“è§£Redisçš„ç½‘ç»œè¯·æ±‚å¤„ç†å‹åŠ›ã€‚é€šè¿‡å¤šçº¿ç¨‹å¢åŠ å¤„ç†ç½‘ç»œè¯·æ±‚çš„èƒ½åŠ›ï¼Œå¯ä»¥è¿›ä¸€æ­¥æå‡å®ä¾‹çš„æ•´ä½“æ€§èƒ½ã€‚ä¸šç•Œå·²ç»æœ‰äººè¯„æµ‹è¿‡ï¼Œè·Ÿ6.0ä¹‹å‰çš„å•çº¿ç¨‹Redisç›¸æ¯”ï¼Œ6.0çš„å¤šçº¿ç¨‹æ€§èƒ½çš„ç¡®æœ‰æå‡ã€‚æ‰€ä»¥ï¼Œè¿™ä¸ªç‰¹æ€§å¯¹ä¸šåŠ¡åº”ç”¨ä¼šæœ‰æ¯”è¾ƒå¤§çš„å¸®åŠ©ã€‚</p><p>å¦å¤–ï¼ŒåŸºäºç”¨æˆ·çš„å‘½ä»¤ç²’åº¦ACLæ§åˆ¶æœºåˆ¶ä¹Ÿéå¸¸æœ‰ç”¨ã€‚å½“Redisä»¥äº‘åŒ–çš„æ–¹å¼å¯¹å¤–æä¾›æœåŠ¡æ—¶ï¼Œå°±ä¼šé¢ä¸´å¤šç§Ÿæˆ·ï¼ˆæ¯”å¦‚å¤šç”¨æˆ·æˆ–å¤šä¸ªå¾®æœåŠ¡ï¼‰çš„åº”ç”¨åœºæ™¯ã€‚æœ‰äº†ACLæ–°ç‰¹æ€§ï¼Œæˆ‘ä»¬å°±å¯ä»¥å®‰å…¨åœ°æ”¯æŒå¤šç§Ÿæˆ·å…±äº«è®¿é—®RedisæœåŠ¡äº†ã€‚</p><h2><a href=\"https://time.geekbang.org/column/article/312568\">ç¬¬40è®²</a></h2><p>é—®é¢˜ï¼šä½ è§‰å¾—ï¼Œæœ‰äº†æŒä¹…åŒ–å†…å­˜åï¼Œè¿˜éœ€è¦Redisä¸»ä»é›†ç¾¤å—ï¼Ÿ</p><p>ç­”æ¡ˆï¼šæŒä¹…åŒ–å†…å­˜è™½ç„¶å¯ä»¥å¿«é€Ÿæ¢å¤æ•°æ®ï¼Œä½†æ˜¯ï¼Œé™¤äº†æä¾›ä¸»ä»æ•…éšœåˆ‡æ¢ä»¥å¤–ï¼Œä¸»ä»é›†ç¾¤è¿˜å¯ä»¥å®ç°è¯»å†™åˆ†ç¦»ã€‚æ‰€ä»¥ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡å¢åŠ ä»å®ä¾‹ï¼Œè®©å¤šä¸ªä»å®ä¾‹å…±åŒåˆ†æ‹…å¤§é‡çš„è¯»è¯·æ±‚ï¼Œè¿™æ ·å¯ä»¥æå‡Redisçš„è¯»æ€§èƒ½ã€‚è€Œæå‡è¯»æ€§èƒ½å¹¶ä¸æ˜¯æŒä¹…åŒ–å†…å­˜èƒ½æä¾›çš„ï¼Œæ‰€ä»¥ï¼Œå¦‚æœä¸šåŠ¡å±‚å¯¹è¯»æ€§èƒ½æœ‰é«˜è¦æ±‚æ—¶ï¼Œæˆ‘ä»¬è¿˜æ˜¯éœ€è¦ä¸»ä»é›†ç¾¤çš„ã€‚</p><h2>å¸¸è§é—®é¢˜ç­”ç–‘</h2><p>å¥½äº†ï¼Œå…³äºæ€è€ƒé¢˜çš„è®¨è®ºï¼Œåˆ°è¿™é‡Œå°±å‘Šä¸€æ®µè½äº†ã€‚æ¥ä¸‹æ¥ï¼Œæˆ‘ç»“åˆæœ€è¿‘æ”¶åˆ°çš„ä¸€äº›é—®é¢˜ï¼Œæ¥å’Œä½ èŠä¸€èŠï¼Œåœ¨è¿›è¡ŒåŸå­æ“ä½œå¼€å‘æ—¶ï¼Œå±€éƒ¨å˜é‡å’Œå…¨å±€å…±äº«å˜é‡å¯¼è‡´çš„å·®å¼‚é—®é¢˜ï¼Œä»¥åŠRediså’Œå¦å¤–ä¸¤ç§å¸¸è§çš„é”®å€¼æ•°æ®åº“Memcachedã€RocksDBçš„ä¼˜åŠ£åŠ¿å¯¹æ¯”ã€‚</p><h3>å…³äºåŸå­æ“ä½œçš„ä½¿ç”¨ç–‘é—®</h3><p>åœ¨<a href=\"https://time.geekbang.org/column/article/299806\">ç¬¬29è®²</a>ä¸­ï¼Œæˆ‘åœ¨ä»‹ç»åŸå­æ“ä½œæ—¶ï¼Œæåˆ°äº†ä¸€ä¸ªå¤šçº¿ç¨‹é™æµçš„ä¾‹å­ï¼Œå€ŸåŠ©å®ƒæ¥è§£é‡Šå¦‚ä½•ä½¿ç”¨åŸå­æ“ä½œã€‚æˆ‘ä»¬å†æ¥å›é¡¾ä¸‹è¿™ä¸ªä¾‹å­çš„ä»£ç ï¼š</p><pre><code>//è·å–ipå¯¹åº”çš„è®¿é—®æ¬¡æ•°\ncurrent = GET(ip)\n//å¦‚æœè¶…è¿‡è®¿é—®æ¬¡æ•°è¶…è¿‡20æ¬¡ï¼Œåˆ™æŠ¥é”™\nIF current != NULL AND current &gt; 20 THEN\n    ERROR &quot;exceed 20 accesses per second&quot;\nELSE\n    //å¦‚æœè®¿é—®æ¬¡æ•°ä¸è¶³20æ¬¡ï¼Œå¢åŠ ä¸€æ¬¡è®¿é—®è®¡æ•°\n    value = INCR(ip)\n    //å¦‚æœæ˜¯ç¬¬ä¸€æ¬¡è®¿é—®ï¼Œå°†é”®å€¼å¯¹çš„è¿‡æœŸæ—¶é—´è®¾ç½®ä¸º60så\n    IF value == 1 THEN\n        EXPIRE(ip,60)\n    END\n    //æ‰§è¡Œå…¶ä»–æ“ä½œ\n    DO THINGS\nEND\n</code></pre><p>åœ¨åˆ†æè¿™ä¸ªä¾‹å­çš„æ—¶å€™ï¼Œæˆ‘æåˆ°ï¼šâ€œç¬¬ä¸€ä¸ªçº¿ç¨‹æ‰§è¡Œäº†INCR(ip)æ“ä½œåï¼Œç¬¬äºŒä¸ªçº¿ç¨‹ç´§æ¥ç€ä¹Ÿæ‰§è¡Œäº†INCR(ip)ï¼Œæ­¤æ—¶ï¼Œipå¯¹åº”çš„è®¿é—®æ¬¡æ•°å°±è¢«å¢åŠ åˆ°äº†2ï¼Œæˆ‘ä»¬å°±ä¸èƒ½å†å¯¹è¿™ä¸ªipè®¾ç½®è¿‡æœŸæ—¶é—´äº†ã€‚â€</p><p>æœ‰åŒå­¦è®¤ä¸ºï¼Œvalueæ˜¯çº¿ç¨‹ä¸­çš„å±€éƒ¨å˜é‡ï¼Œæ‰€ä»¥ä¸¤ä¸ªçº¿ç¨‹åœ¨æ‰§è¡Œæ—¶ï¼Œæ¯ä¸ªçº¿ç¨‹ä¼šå„è‡ªåˆ¤æ–­valueæ˜¯å¦ç­‰äº1ã€‚åˆ¤æ–­å®Œvalueå€¼åï¼Œå°±å¯ä»¥è®¾ç½®ipçš„è¿‡æœŸæ—¶é—´äº†ã€‚å› ä¸ºRedisæœ¬èº«æ‰§è¡ŒINCRå¯ä»¥ä¿è¯åŸå­æ€§ï¼Œæ‰€ä»¥ï¼Œå®¢æˆ·ç«¯çº¿ç¨‹ä½¿ç”¨å±€éƒ¨å˜é‡è·å–ipæ¬¡æ•°å¹¶è¿›è¡Œåˆ¤æ–­æ—¶ï¼Œæ˜¯å¯ä»¥å®ç°åŸå­æ€§ä¿è¯çš„ã€‚</p><p>æˆ‘å†è¿›ä¸€æ­¥è§£é‡Šä¸‹è¿™ä¸ªä¾‹å­ä¸­ä½¿ç”¨Luaè„šæœ¬ä¿è¯åŸå­æ€§çš„åŸå› ã€‚</p><p>åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œvalueå…¶å®æ˜¯ä¸€ä¸ªåœ¨å¤šçº¿ç¨‹ä¹‹é—´å…±äº«çš„å…¨å±€å˜é‡ï¼Œæ‰€ä»¥ï¼Œå¤šçº¿ç¨‹åœ¨è®¿é—®è¿™ä¸ªå˜é‡æ—¶ï¼Œå°±å¯èƒ½ä¼šå‡ºç°ä¸€ç§æƒ…å†µï¼šä¸€ä¸ªçº¿ç¨‹æ‰§è¡Œäº†INCR(ip)åï¼Œç¬¬äºŒä¸ªçº¿ç¨‹ä¹Ÿæ‰§è¡Œäº†INCR(ip)ï¼Œç­‰åˆ°ç¬¬ä¸€ä¸ªçº¿ç¨‹å†ç»§ç»­æ‰§è¡Œæ—¶ï¼Œå°±ä¼šå‘ç”Ÿipå¯¹åº”çš„è®¿é—®æ¬¡æ•°å˜æˆ2çš„æƒ…å†µã€‚è€Œè®¾ç½®è¿‡æœŸæ—¶é—´çš„æ¡ä»¶æ˜¯ipè®¿é—®æ¬¡æ•°ç­‰äº1ï¼Œè¿™å°±æ— æ³•è®¾ç½®è¿‡æœŸæ—¶é—´äº†ã€‚åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬å°±éœ€è¦ç”¨Luaè„šæœ¬ä¿è¯è®¡æ•°å¢åŠ å’Œè®¡æ•°åˆ¤æ–­æ“ä½œçš„åŸå­æ€§ã€‚</p><h3>Rediså’ŒMemcachedã€RocksDBçš„å¯¹æ¯”</h3><p>Memcachedå’ŒRocksDBåˆ†åˆ«æ˜¯å…¸å‹çš„å†…å­˜é”®å€¼æ•°æ®åº“å’Œç¡¬ç›˜é”®å€¼æ•°æ®åº“ï¼Œåº”ç”¨å¾—ä¹Ÿéå¸¸å¹¿æ³›ã€‚å’ŒRedisç›¸æ¯”ï¼Œå®ƒä»¬æœ‰ä»€ä¹ˆä¼˜åŠ¿å’Œä¸è¶³å‘¢ï¼Ÿæ˜¯å¦å¯ä»¥æ›¿ä»£Rediså‘¢ï¼Ÿæˆ‘ä»¬æ¥èŠä¸€èŠè¿™ä¸ªé—®é¢˜ã€‚</p><h4>Rediså’ŒMemcachedçš„æ¯”è¾ƒ</h4><p>å’ŒRedisç›¸ä¼¼ï¼ŒMemcachedä¹Ÿç»å¸¸è¢«å½“åšç¼“å­˜æ¥ä½¿ç”¨ã€‚ä¸è¿‡ï¼ŒMemcachedæœ‰ä¸€ä¸ªæ˜æ˜¾çš„ä¼˜åŠ¿ï¼Œ<strong>å°±æ˜¯å®ƒçš„é›†ç¾¤è§„æ¨¡å¯ä»¥å¾ˆå¤§</strong>ã€‚Memcachedé›†ç¾¤å¹¶ä¸æ˜¯åƒRedis Clusteræˆ–Codisé‚£æ ·ï¼Œä½¿ç”¨Slotæ˜ å°„æ¥åˆ†é…æ•°æ®å’Œå®ä¾‹çš„å¯¹åº”ä¿å­˜å…³ç³»ï¼Œè€Œæ˜¯ä½¿ç”¨ä¸€è‡´æ€§å“ˆå¸Œç®—æ³•æŠŠæ•°æ®åˆ†æ•£ä¿å­˜åˆ°å¤šä¸ªå®ä¾‹ä¸Šï¼Œè€Œä¸€è‡´æ€§å“ˆå¸Œçš„ä¼˜åŠ¿å°±æ˜¯å¯ä»¥æ”¯æŒå¤§è§„æ¨¡çš„é›†ç¾¤ã€‚æ‰€ä»¥ï¼Œå¦‚æœæˆ‘ä»¬éœ€è¦éƒ¨ç½²å¤§è§„æ¨¡ç¼“å­˜é›†ç¾¤ï¼ŒMemcachedä¼šæ˜¯ä¸€ä¸ªä¸é”™çš„é€‰æ‹©ã€‚</p><p>ä¸è¿‡ï¼Œåœ¨ä½¿ç”¨Memcachedæ—¶ï¼Œæœ‰ä¸ªåœ°æ–¹éœ€è¦æ³¨æ„ï¼ŒMemcachedæ”¯æŒçš„æ•°æ®ç±»å‹æ¯”Rediså°‘å¾ˆå¤šã€‚Memcachedåªæ”¯æŒStringç±»å‹çš„é”®å€¼å¯¹ï¼Œè€ŒRediså¯ä»¥æ”¯æŒåŒ…æ‹¬Stringåœ¨å†…çš„å¤šç§æ•°æ®ç±»å‹ï¼Œå½“ä¸šåŠ¡åº”ç”¨æœ‰ä¸°å¯Œçš„æ•°æ®ç±»å‹è¦ä¿å­˜çš„è¯ï¼Œä½¿ç”¨Memcachedä½œä¸ºæ›¿æ¢æ–¹æ¡ˆçš„ä¼˜åŠ¿å°±æ²¡æœ‰äº†ã€‚</p><p>å¦‚æœä½ æ—¢éœ€è¦ä¿å­˜å¤šç§æ•°æ®ç±»å‹ï¼Œåˆå¸Œæœ›æœ‰ä¸€å®šçš„é›†ç¾¤è§„æ¨¡ä¿å­˜å¤§é‡æ•°æ®ï¼Œé‚£ä¹ˆï¼ŒRedisä»ç„¶æ˜¯ä¸€ä¸ªä¸é”™çš„æ–¹æ¡ˆã€‚</p><p>æˆ‘æŠŠRediså’ŒMemcachedçš„å¯¹æ¯”æƒ…å†µæ€»ç»“åœ¨äº†ä¸€å¼ è¡¨é‡Œï¼Œä½ å¯ä»¥çœ‹ä¸‹ã€‚</p><p><img src=\"https://static001.geekbang.org/resource/image/9e/29/9eb06cfea8a3ec6fced6e736e4e9ec29.jpg?wh=2791*724\" alt=\"\"></p><h4>Rediså’ŒRocksDBçš„æ¯”è¾ƒ</h4><p>å’ŒRedisä¸åŒï¼ŒRocksDBå¯ä»¥æŠŠæ•°æ®ç›´æ¥ä¿å­˜åˆ°ç¡¬ç›˜ä¸Šã€‚è¿™æ ·ä¸€æ¥ï¼Œå•ä¸ªRocksDBå¯ä»¥ä¿å­˜çš„æ•°æ®é‡è¦æ¯”Rediså¤šå¾ˆå¤šï¼Œè€Œä¸”æ•°æ®éƒ½èƒ½æŒä¹…åŒ–ä¿å­˜ä¸‹æ¥ã€‚</p><p>é™¤æ­¤ä¹‹å¤–ï¼ŒRocksDBè¿˜èƒ½æ”¯æŒè¡¨ç»“æ„ï¼ˆå³åˆ—æ—ç»“æ„ï¼‰ï¼Œè€ŒRedisçš„åŸºæœ¬æ•°æ®æ¨¡å‹å°±æ˜¯é”®å€¼å¯¹ã€‚æ‰€ä»¥ï¼Œå¦‚æœä½ éœ€è¦ä¸€ä¸ªå¤§å®¹é‡çš„æŒä¹…åŒ–é”®å€¼æ•°æ®åº“ï¼Œå¹¶ä¸”èƒ½æŒ‰ç…§ä¸€å®šè¡¨ç»“æ„ä¿å­˜æ•°æ®ï¼ŒRocksDBæ˜¯ä¸€ä¸ªä¸é”™çš„æ›¿ä»£æ–¹æ¡ˆã€‚</p><p>ä¸è¿‡ï¼ŒRocksDBæ¯•ç«Ÿæ˜¯è¦æŠŠæ•°æ®å†™å…¥åº•å±‚ç¡¬ç›˜è¿›è¡Œä¿å­˜çš„ï¼Œè€Œä¸”åœ¨è¿›è¡Œæ•°æ®æŸ¥è¯¢æ—¶ï¼Œå¦‚æœRocksDBè¦è¯»å–çš„æ•°æ®æ²¡æœ‰åœ¨å†…å­˜ä¸­ç¼“å­˜ï¼Œé‚£ä¹ˆï¼ŒRocksDBå°±éœ€è¦åˆ°ç¡¬ç›˜ä¸Šçš„æ–‡ä»¶ä¸­è¿›è¡ŒæŸ¥æ‰¾ï¼Œè¿™ä¼šæ‹–æ…¢RocksDBçš„è¯»å†™å»¶è¿Ÿï¼Œé™ä½å¸¦å®½ã€‚</p><p>åœ¨æ€§èƒ½æ–¹é¢ï¼ŒRocksDBæ˜¯æ¯”ä¸ä¸ŠRedisçš„ã€‚è€Œä¸”ï¼ŒRocksDBåªæ˜¯ä¸€ä¸ªåŠ¨æ€é“¾æ¥åº“ï¼Œå¹¶æ²¡æœ‰åƒRedisé‚£æ ·æä¾›äº†å®¢æˆ·ç«¯-æœåŠ¡å™¨ç«¯è®¿é—®æ¨¡å¼ï¼Œä»¥åŠä¸»ä»é›†ç¾¤å’Œåˆ‡ç‰‡é›†ç¾¤çš„åŠŸèƒ½ã€‚æ‰€ä»¥ï¼Œæˆ‘ä»¬åœ¨ä½¿ç”¨RocksDBæ›¿ä»£Redisæ—¶ï¼Œéœ€è¦ç»“åˆä¸šåŠ¡éœ€æ±‚é‡ç‚¹è€ƒè™‘æ›¿æ¢çš„å¯è¡Œæ€§ã€‚</p><p>æˆ‘æŠŠRediså’ŒRocksDBçš„å¯¹æ¯”æƒ…å†µæ€»ç»“äº†ä¸‹ï¼Œå¦‚ä¸‹è¡¨æ‰€ç¤ºï¼š</p><p><img src=\"https://static001.geekbang.org/resource/image/7c/82/7c0a225636f4983cb56a5b7265cf5982.jpg?wh=2884*656\" alt=\"\"></p><h2>æ€»ç»“</h2><p>é›†ç¾¤æ˜¯å®é™…ä¸šåŠ¡åº”ç”¨ä¸­å¾ˆé‡è¦çš„ä¸€ä¸ªéœ€æ±‚ï¼Œåœ¨è¯¾ç¨‹çš„æœ€åï¼Œæˆ‘è¿˜æƒ³å†ç»™ä½ æä¸€ä¸ªå°å»ºè®®ã€‚</p><p>é›†ç¾¤éƒ¨ç½²å’Œè¿ç»´æ¶‰åŠçš„å·¥ä½œé‡éå¸¸å¤§ï¼Œæ‰€ä»¥ï¼Œæˆ‘ä»¬ä¸€å®šè¦é‡è§†é›†ç¾¤æ–¹æ¡ˆçš„é€‰æ‹©ã€‚</p><p><strong>é›†ç¾¤çš„å¯æ‰©å±•æ€§æ˜¯æˆ‘ä»¬è¯„ä¼°é›†ç¾¤æ–¹æ¡ˆçš„ä¸€ä¸ªé‡è¦ç»´åº¦</strong>ï¼Œä½ ä¸€å®šè¦å…³æ³¨ï¼Œé›†ç¾¤ä¸­å…ƒæ•°æ®æ˜¯ç”¨Slotæ˜ å°„è¡¨ï¼Œè¿˜æ˜¯ä¸€è‡´æ€§å“ˆå¸Œç»´æŠ¤çš„ã€‚å¦‚æœæ˜¯Slotæ˜ å°„è¡¨ï¼Œé‚£ä¹ˆï¼Œæ˜¯ç”¨ä¸­å¿ƒåŒ–çš„ç¬¬ä¸‰æ–¹å­˜å‚¨ç³»ç»Ÿæ¥ä¿å­˜ï¼Œè¿˜æ˜¯ç”±å„ä¸ªå®ä¾‹æ¥æ‰©æ•£ä¿å­˜ï¼Œè¿™ä¹Ÿæ˜¯éœ€è¦è€ƒè™‘æ¸…æ¥šçš„ã€‚Redis Clusterã€Codiså’ŒMemcachedé‡‡ç”¨çš„æ–¹å¼å„ä¸ç›¸åŒã€‚</p><ul>\n<li>Redis Clusterï¼šä½¿ç”¨Slotæ˜ å°„è¡¨å¹¶ç”±å®ä¾‹æ‰©æ•£ä¿å­˜ã€‚</li>\n<li>Codisï¼šä½¿ç”¨Slotæ˜ å°„è¡¨å¹¶ç”±ç¬¬ä¸‰æ–¹å­˜å‚¨ç³»ç»Ÿä¿å­˜ã€‚</li>\n<li>Memcachedï¼šä½¿ç”¨ä¸€è‡´æ€§å“ˆå¸Œã€‚</li>\n</ul><p>ä»å¯æ‰©å±•æ€§æ¥çœ‹ï¼ŒMemcachedä¼˜äºCodisï¼ŒCodisä¼˜äºRedis Clusterã€‚æ‰€ä»¥ï¼Œå¦‚æœå®é™…ä¸šåŠ¡éœ€è¦å¤§è§„æ¨¡é›†ç¾¤ï¼Œå»ºè®®ä½ ä¼˜å…ˆé€‰æ‹©Codisæˆ–è€…æ˜¯åŸºäºä¸€è‡´æ€§å“ˆå¸Œçš„Redisåˆ‡ç‰‡é›†ç¾¤æ–¹æ¡ˆã€‚</p>","comments":[{"had_liked":false,"id":264391,"user_name":"humor","can_delete":false,"product_type":"c1","uid":1181867,"ip_address":"","ucode":"9B48C4C7BEC92C","user_header":"https://static001.geekbang.org/account/avatar/00/12/08/ab/caec7bca.jpg","comment_is_top":false,"comment_ctime":1606454218,"is_pvip":false,"replies":[{"id":"97918","content":"Redisçš„å®¢æˆ·ç«¯åˆ†ç‰‡æ–¹æ¡ˆShardedJediså°±æ˜¯ç”¨çš„ä¸€è‡´æ€§å“ˆå¸Œæ¥è¿›è¡Œåˆ†ç‰‡çš„ã€‚","user_name":"ä½œè€…å›å¤","user_name_real":"è’‹å¾·é’§","uid":"1609687","ctime":1608993350,"ip_address":"","comment_id":264391,"utype":1}],"discussion_count":2,"race_medal":0,"score":"91800767434","product_id":100056701,"comment_content":"ä½¿ç”¨ä¸€è‡´æ€§å“ˆå¸Œä¸æ˜¯memcachedçš„ä¸“å±æ–¹æ¡ˆå§ï¼Œredisä¹Ÿå¯ä»¥ä½¿ç”¨ä¸€è‡´æ€§å“ˆå¸Œé›†ç¾¤","like_count":21,"discussions":[{"author":{"id":1609687,"avatar":"https://static001.geekbang.org/account/avatar/00/18/8f/d7/fb60129d.jpg","nickname":"è’‹å¾·é’§","note":"","ucode":"833985C2C37C0A","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":510551,"discussion_content":"Redisçš„å®¢æˆ·ç«¯åˆ†ç‰‡æ–¹æ¡ˆShardedJediså°±æ˜¯ç”¨çš„ä¸€è‡´æ€§å“ˆå¸Œæ¥è¿›è¡Œåˆ†ç‰‡çš„ã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1608993350,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":2094925,"avatar":"https://static001.geekbang.org/account/avatar/00/1f/f7/4d/09554c96.jpg","nickname":"iron bo","note":"","ucode":"4BFB1331637AA3","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":371981,"discussion_content":"å®¢æˆ·ç«¯åˆ†ç‰‡ï¼Œæœ‰ç‚¹éš¾ä»¥ç†è§£","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1620114990,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":268919,"user_name":"cpâ˜…é’Šî€¢îˆ±î€²","can_delete":false,"product_type":"c1","uid":1275690,"ip_address":"","ucode":"6B86D4D538BDF7","user_header":"https://static001.geekbang.org/account/avatar/00/13/77/2a/244d98aa.jpg","comment_is_top":false,"comment_ctime":1608433721,"is_pvip":false,"replies":[{"id":"97657","content":"ä¸€è‡´æ€§hashå¯ä»¥æ”¯æŒé›†ç¾¤æ‰©å®¹ï¼Œè€Œä¸”ä½¿ç”¨ä¸€è‡´æ€§å“ˆå¸Œåœ¨è¿›è¡Œé›†ç¾¤æ‰©å®¹æ—¶ï¼Œå‡è®¾æ–°åŠ å…¥èŠ‚ç‚¹åœ¨ä¸€è‡´æ€§å“ˆå¸Œåœ†ç¯ä¸Šæ˜¯Aï¼Œæ²¿é€†æ—¶é’ˆæ–¹å‘çš„å‰ä¸€ä¸ªé›†ç¾¤èŠ‚ç‚¹æ˜¯Bï¼Œé‚£ä¹ˆæ•°æ®è¿ç§»åªéœ€è¦è¿ç§»Bå’ŒAä¹‹é—´çš„æ•°æ®ï¼Œç›¸æ¯”äºæ™®é€šçš„å“ˆå¸Œåå–æ¨¡æ–¹æ³•ï¼Œä¸€è‡´æ€§å“ˆå¸Œèƒ½å‡å°‘æ•°æ®è¿ç§»é‡ã€‚","user_name":"ä½œè€…å›å¤","user_name_real":"è’‹å¾·é’§","uid":"1609687","ctime":1608596897,"ip_address":"","comment_id":268919,"utype":1}],"discussion_count":1,"race_medal":0,"score":"74622877753","product_id":100056701,"comment_content":"ä¸€è‡´æ€§hashæ—¶èƒ½å¦æ”¯æŒé›†ç¾¤æ‰©å®¹ï¼Œæ¶‰åŠåˆ°æ•°æ®è¿ç§»æ˜¯ä¸æ˜¯éº»çƒ¦å¾ˆå¤šã€‚","like_count":17,"discussions":[{"author":{"id":1609687,"avatar":"https://static001.geekbang.org/account/avatar/00/18/8f/d7/fb60129d.jpg","nickname":"è’‹å¾·é’§","note":"","ucode":"833985C2C37C0A","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":512082,"discussion_content":"ä¸€è‡´æ€§hashå¯ä»¥æ”¯æŒé›†ç¾¤æ‰©å®¹ï¼Œè€Œä¸”ä½¿ç”¨ä¸€è‡´æ€§å“ˆå¸Œåœ¨è¿›è¡Œé›†ç¾¤æ‰©å®¹æ—¶ï¼Œå‡è®¾æ–°åŠ å…¥èŠ‚ç‚¹åœ¨ä¸€è‡´æ€§å“ˆå¸Œåœ†ç¯ä¸Šæ˜¯Aï¼Œæ²¿é€†æ—¶é’ˆæ–¹å‘çš„å‰ä¸€ä¸ªé›†ç¾¤èŠ‚ç‚¹æ˜¯Bï¼Œé‚£ä¹ˆæ•°æ®è¿ç§»åªéœ€è¦è¿ç§»Bå’ŒAä¹‹é—´çš„æ•°æ®ï¼Œç›¸æ¯”äºæ™®é€šçš„å“ˆå¸Œåå–æ¨¡æ–¹æ³•ï¼Œä¸€è‡´æ€§å“ˆå¸Œèƒ½å‡å°‘æ•°æ®è¿ç§»é‡ã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1608596897,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":264518,"user_name":"æ¨é€¸æ—","can_delete":false,"product_type":"c1","uid":1167233,"ip_address":"","ucode":"4BF3CF3E2F1AC7","user_header":"https://static001.geekbang.org/account/avatar/00/11/cf/81/96f656ef.jpg","comment_is_top":false,"comment_ctime":1606486214,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"23081322694","product_id":100056701,"comment_content":"æ„Ÿè°¢è€å¸ˆçš„æ•™å­¦ï¼Œä¸€è·¯æ”¶è·å¾ˆå¤šï¿½ï¿½ï¿½ï¿½ï¿½ï¿½","like_count":5},{"had_liked":false,"id":265424,"user_name":"åˆ˜å¤§äºº","can_delete":false,"product_type":"c1","uid":1577210,"ip_address":"","ucode":"F66AE613E80398","user_header":"https://static001.geekbang.org/account/avatar/00/18/10/fa/d977627e.jpg","comment_is_top":false,"comment_ctime":1606894632,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"10196829224","product_id":100056701,"comment_content":"æ‰“å¡ ","like_count":2},{"had_liked":false,"id":268502,"user_name":"æ—…é€”","can_delete":false,"product_type":"c1","uid":1212902,"ip_address":"","ucode":"5022477E8E9441","user_header":"https://static001.geekbang.org/account/avatar/00/12/81/e6/6cafed37.jpg","comment_is_top":false,"comment_ctime":1608219502,"is_pvip":false,"discussion_count":1,"race_medal":0,"score":"5903186798","product_id":100056701,"comment_content":"è€Œä¸€è‡´æ€§å“ˆå¸Œçš„ä¼˜åŠ¿å°±æ˜¯å¯ä»¥æ”¯æŒå¤§è§„æ¨¡çš„é›†ç¾¤ <br>è€å¸ˆ ä¸ºä»€ä¹ˆä¸€è‡´æ€§hashå°±å¯ä»¥æ”¯æŒå¤§è§„æ¨¡é›†ç¾¤å‘¢","like_count":1,"discussions":[{"author":{"id":1801058,"avatar":"https://static001.geekbang.org/account/avatar/00/1b/7b/62/ec94cee4.jpg","nickname":"å½­æ–‡è¾¾","note":"","ucode":"8DCC27EC5AF263","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":403427,"discussion_content":"è¦å…ˆäº†è§£ä¸€ä¸‹ä¸€è‡´æ€§hashçš„åŸç†æ‰æ›´å¥½ç†è§£","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1634082796,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":264459,"user_name":"î‡ å°¿å¸ƒ","can_delete":false,"product_type":"c1","uid":1476323,"ip_address":"","ucode":"D1C8BDA7540962","user_header":"https://static001.geekbang.org/account/avatar/00/16/86/e3/a31f6869.jpg","comment_is_top":false,"comment_ctime":1606470856,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"5901438152","product_id":100056701,"comment_content":"æ‰“å¡","like_count":1},{"had_liked":false,"id":264293,"user_name":"æ—æ—è¦åŠ æ²¹é¸­","can_delete":false,"product_type":"c1","uid":2309104,"ip_address":"","ucode":"E71956CBD3BD4D","user_header":"https://static001.geekbang.org/account/avatar/00/23/3b/f0/0dd9ca93.jpg","comment_is_top":false,"comment_ctime":1606407462,"is_pvip":true,"discussion_count":0,"race_medal":0,"score":"5901374758","product_id":100056701,"comment_content":"æ²™å‘","like_count":1},{"had_liked":false,"id":355682,"user_name":"å¼±æ°´ç©¿äº‘å¤©","can_delete":false,"product_type":"c1","uid":1190060,"ip_address":"ä¸Šæµ·","ucode":"80DC528A23ED7E","user_header":"https://static001.geekbang.org/account/avatar/00/12/28/ac/37a2a265.jpg","comment_is_top":false,"comment_ctime":1661649483,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1661649483","product_id":100056701,"comment_content":"æ‰“å¡","like_count":0},{"had_liked":false,"id":354606,"user_name":"ä¼¯é˜³","can_delete":false,"product_type":"c1","uid":1596631,"ip_address":"åŒ—äº¬","ucode":"DBDC8735AA54AD","user_header":"https://static001.geekbang.org/account/avatar/00/18/5c/d7/3b92bb0d.jpg","comment_is_top":false,"comment_ctime":1660599376,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1660599376","product_id":100056701,"comment_content":"æ‰“å¡","like_count":0},{"had_liked":false,"id":336553,"user_name":"ğŸ’A","can_delete":false,"product_type":"c1","uid":1075412,"ip_address":"","ucode":"914FFA92CA2713","user_header":"https://static001.geekbang.org/account/avatar/00/10/68/d4/c9b5d3f9.jpg","comment_is_top":false,"comment_ctime":1646210946,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1646210946","product_id":100056701,"comment_content":"ç»ˆäºå­¦å®Œäº†ã€‚","like_count":0},{"had_liked":false,"id":296696,"user_name":"BertGeek","can_delete":false,"product_type":"c1","uid":1452799,"ip_address":"","ucode":"8E1D72C9F9778C","user_header":"https://static001.geekbang.org/account/avatar/00/16/2a/ff/a9d72102.jpg","comment_is_top":false,"comment_ctime":1623118540,"is_pvip":false,"discussion_count":1,"race_medal":0,"score":"1623118540","product_id":100056701,"comment_content":"è¯·é—®è€å¸ˆï¼Œredis æ¯ä¸ªå®ä¾‹éƒ½ä¿å­˜å…¨é‡slot æ˜ å°„ä¿¡æ¯ï¼Œè¿˜æ˜¯åªä¿å­˜è‡ªå·±å®ä¾‹çš„slotä¿¡æ¯","like_count":0,"discussions":[{"author":{"id":1102245,"avatar":"https://static001.geekbang.org/account/avatar/00/10/d1/a5/2bbedc3b.jpg","nickname":"over","note":"","ucode":"FE272AC19842D3","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":387886,"discussion_content":"å…¨é‡ï¼Œæ–¹ä¾¿redirect","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1628486994,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":286837,"user_name":"escray","can_delete":false,"product_type":"c1","uid":1020525,"ip_address":"","ucode":"1F4204930E47C4","user_header":"https://static001.geekbang.org/account/avatar/00/0f/92/6d/becd841a.jpg","comment_is_top":false,"comment_ctime":1617627731,"is_pvip":true,"discussion_count":1,"race_medal":2,"score":"1617627731","product_id":100056701,"comment_content":"æœ€åä¸€æ¬¡å¯¹ç­”æ¡ˆï¼ˆåé¢å¥½åƒè¿˜æœ‰ä¸ªæœŸæœ«æµ‹è¯•ï¼Œè’‹è€å¸ˆæœç„¶æ˜¯å­¦é™¢æ´¾ï¼‰<br><br>æ„Ÿè§‰è¿™æ¬¡çš„å‡ é“è¯¾åé¢˜è‡ªå·±ç­”å¾—æ¯”ä»¥å‰è¦é è°±ä¸€äº›ï¼Œå½“ç„¶ä¸€äº›å…·ä½“çš„åˆ†æå¯èƒ½è¿˜æ˜¯ä¸é‚£ä¹ˆåˆ°ä½ã€‚<br><br>å¯¹äº Redis å’Œ Memcached çš„æ¯”è¾ƒï¼Œæœ¬æ–‡ä¸­è®²çš„å†…å®¹åº”è¯¥å·²ç»è¶³å¤Ÿåº”ä»˜é¢è¯•äº†ã€‚<br><br>å…³äº Memcachedã€Codis å’Œ Redis Clusterï¼Œè€å¸ˆæœç„¶è¿˜æ˜¯è¦åçˆ± Codis ä¸€äº›ã€‚","like_count":0,"discussions":[{"author":{"id":1886331,"avatar":"https://static001.geekbang.org/account/avatar/00/1c/c8/7b/153181d7.jpg","nickname":"å¤œè¾‰","note":"","ucode":"9421385F51FF9E","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":376686,"discussion_content":"redis clusterå®˜æ–¹è§£å†³æ–¹æ¡ˆï¼Œé›†ç¾¤çš„éƒ¨ç½²å’Œç»´æŠ¤ç›¸å¯¹ç®€å•","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1622277923,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]}]}