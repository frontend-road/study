{"id":164025,"title":"21 | 系统架构：每秒1万次请求的系统要做服务化拆分吗？","content":"<p>你好，我是唐扬。</p><p>通过前面几个篇章的内容，你已经从数据库、缓存和消息队列的角度对自己的垂直电商系统在性能、可用性和扩展性上做了优化。</p><p>现在你的系统运行稳定好评不断，每天高峰期的流量已经达到了10000/s请求，DAU也涨到了几十万。CEO非常高兴，打算继续完善产品功能进行新一轮的运营推广，争取在下个双十一可以将DAU冲击过百万。\b这时你开始考虑怎么通过技术上的优化改造支撑更高的并发流量，比如支撑过百万的DAU。</p><p>于是你重新审视了自己的系统架构，分析系统中有哪些可以优化的点。</p><p><img src=\"https://static001.geekbang.org/resource/image/61/e7/612173bc83b332bef201e4ad7056f5e7.jpg?wh=1142*661\" alt=\"\"></p><p>目前来看，工程的部署方式还是采用一体化架构。也就是说所有的功能模块，比如电商系统中的订单模块、用户模块、支付模块、物流模块等等都被打包到一个大的Web工程中，然后部署在应用服务器上。</p><p>你隐约觉得这样的部署方式可能存在问题，于是Google了一下后发现当系统发展到一定阶段都要做微服务化的拆分，你也看到淘宝的“五彩石”项目对于淘宝整体架构的扩展性带来的巨大影响。这一切让你心驰神往。</p><p>但是有一个问题一直萦绕在你的心里：究竟是什么促使我们将一体化架构拆分成微服务化架构？是不是说系统的整体QPS到了1万或者到了2万，就一定要做微服务化拆分呢？</p><!-- [[[read_end]]] --><h2>一体化架构的痛点</h2><p>先来回想一下你当初为什么选用了一体化架构。</p><p>在电商项目刚刚启动的时候，你只是希望能够尽量快地将项目搭建起来，方便将产品更早地投放市场快速完成验证。</p><p>在系统开发的初期，这种架构确实给你的开发运维带来了很大的便捷，主要体现在：</p><ul>\n<li>开发简单直接，代码和项目集中式管理；</li>\n<li>只需要维护一个工程，节省维护系统运行的人力成本；</li>\n<li>排查问题的时候，只需要排查这个应用进程就可以了，目标性强。</li>\n</ul><p>但随着功能越来越复杂，开发团队规模越来越大，你慢慢感受到了一体化架构的一些缺陷，这主要体现在以下几个方面。</p><p>在技术层面上，数据库连接数可能成为系统的瓶颈。</p><p>在<a href=\"https://time.geekbang.org/column/article/144796\">第7讲</a>中我提到，数据库的连接是比较重的一类资源，不仅连接过程比较耗时而且连接MySQL的客户端数量有限制，最多可以设置为16384（在实际的项目中，可以依据实际业务来调整）。</p><p>这个数字看着很大，但是因为你的系统是按照一体化架构部署的，在部署结构上没有分层，应用服务器直接连接数据库，那么当前端请求量增加，部署的应用服务器扩容，数据库的连接数也会大增，给你举个例子。</p><p><strong>我之前维护的一个系统中</strong>数据库的最大连接数设置为8000，应用服务器部署在虚拟机上数量大概是50个，每个服务器会和数据库建立30个连接，但是数据库的连接数却远远大于30 * 50 = 1500。</p><p>因为你不仅要支撑来自客户端的外网流量还要部署单独的应用服务支撑来自其它部门的内网调用，也要部署队列处理机处理来自消息队列的消息，这些服务也都是与数据库直接连接的，林林总总加起来，在高峰期的时候数据库的连接数要接近3400。</p><p>所以一旦遇到一些大的运营推广活动服务器就要扩容，数据库连接数也随之增加，基本上就会处在最大连接数的边缘。这就像一颗定时炸弹，随时都会影响服务的稳定。</p><p>除此之外，一体化架构增加了研发的成本抑制了研发效率的提升。</p><blockquote>\n<p>《人月神话》中曾经提到：一个团队内部沟通成本和人员数量n有关，约等于n(n-1)/2，也就是说随着团队人员的增加，沟通的成本呈指数级增长，一个100人的团队需要沟通的渠道大概是100（100-1）/2 = 4950。为了减少沟通成本，我们一般会把团队拆分成若干个小团队，每个小团队5～7人负责一部分功能模块的开发和维护。</p>\n</blockquote><p>比如你的垂直电商系统团队就会被拆分为用户组、订单组、支付组、商品组等等。当如此多的小团队共同维护一套代码和一个系统时，在配合的过程中就会出现问题。</p><p>不同的团队之间沟通少，假如一个团队需要一个发送短信的功能，那么有的研发同学会认为最快的方式不是询问其他团队是否有现成的而是自己写一套，但是这种想法是不合适的，会造成功能服务的重复开发。</p><p>由于代码部署在一起，每个人都向同一个代码库提交代码，代码冲突无法避免；同时功能之间耦合严重，可能你只是更改了很小的逻辑却导致其它功能不可用，从而在测试时需要对整体功能回归，延长了交付时间。</p><p>模块之间互相依赖，一个小团队中的成员犯了一个错误，就可能会影响到其它团队维护的服务，对于整体系统稳定性影响很大。</p><p>最后，一体化架构对于系统的运维也会有很大的影响。</p><p>想象一下，在项目初期你的代码可能只有几千行，构建一次只需要一分钟，那么你可以很敏捷灵活地频繁上线变更修复问题。但是当你的系统扩充到几十万行甚至上百万行代码的时候，一次构建的过程包括编译、单元测试、打包和上传到正式环境，花费的时间可能达到十几分钟，并且任何小的修改，都需要构建整个项目，上线变更的过程非常不灵活。</p><p>而我说的这些问题都可以通过微服务化拆分来解决。</p><h2>如何使用微服务化解决这些痛点</h2><p>之前我在做一个社区业务的时候，开始采用的架构也是一体化的架构，数据库已经做了垂直分库，分出了用户库、内容库和互动库，并且已经将工程拆分了业务池，拆分成了用户池、内容池和互动池。</p><p>当前端的请求量越来越大时，我们发现无论哪个业务池子用户模块都是请求量最大的模块儿，用户库也是请求量最大的数据库。这很好理解，无论是内容还是互动都会查询用户库获取用户数据，所以虽然我们做了业务池的拆分，但实际上每一个业务池子都需要连接用户库并且请求量都很大，这就造成了用户库的连接数比其它都要多一些，容易成为系统的瓶颈。</p><p><img src=\"https://static001.geekbang.org/resource/image/94/11/9417a969ce19be3e70841b8d51cf8011.jpg?wh=1142*447\" alt=\"\"></p><p><strong>那么我们怎么解决这个问题呢？</strong></p><p>其实可以把与用户相关的逻辑部署成一个单独的服务，其它无论是用户池、内容池还是互动池都连接这个服务来获取和更改用户信息，也就是说只有这个服务可以连接用户库，其它的业务池都不直连用户库获取数据。</p><p>由于这个服务只处理和用户相关的逻辑，所以不需要部署太多的实例就可以承担流量，这样就可以有效地控制用户库的连接数，提升了系统的可扩展性。那么如此一来，我们也可以将内容和互动相关的逻辑都独立出来，形成内容服务和互动服务，这样我们就通过<strong>按照业务做横向拆分</strong>的方式解决了数据库层面的扩展性问题。</p><p><img src=\"https://static001.geekbang.org/resource/image/89/f9/897bcb5e27c6492484b625fc06599ff9.jpg?wh=1142*698\" alt=\"\"></p><p>再比如，我们在做社区业务的时候，会有多个模块需要使用地理位置服务，将IP信息或者经纬度信息转换为城市信息。比如推荐内容的时候，可以结合用户的城市信息做附近内容的推荐；展示内容信息的时候也需要展示城市信息等等。</p><p>那么如果每一个模块都实现这么一套逻辑就会导致代码不够重用。因此我们可以把将IP信息或者经纬度信息转换为城市信息，包装成单独的服务供其它模块调用，也就是<strong>我们可以将与业务无关的公用服务抽取出来，下沉成单独的服务。</strong></p><p>按照以上两种拆分方式将系统拆分之后，每一个服务的功能内聚，维护人员职责明确，增加了新的功能只需要测试自己的服务就可以了，而一旦服务出了问题，也可以通过服务熔断、降级的方式减少对于其他服务的影响（我会在第34讲中系统地讲解）。</p><p>另外由于每个服务都只是原有系统的子集，代码行数相比原有系统要小很多，构建速度上也会有比较大的提升。</p><p>微服务化之后，原有单一系统被拆分成多个子服务，无论在开发还是运维上都会引入额外的问题，那么这些问题是什么?我们将如何解决呢？下一节课，我会带你来了解。</p><h2>课程小结</h2><p>本节课，我主要带你了解了实际业务中会基于什么样的考虑对系统做微服务化拆分，其实系统的QPS并不是决定性的因素。影响的因素我归纳为以下几点：</p><ul>\n<li>系统中使用的资源出现扩展性问题，尤其是数据库的连接数出现瓶颈；</li>\n<li>大团队共同维护一套代码，带来研发效率的降低和研发成本的提升；</li>\n<li>系统部署成本越来越高。</li>\n</ul><p><strong>从中你应该有所感悟：</strong>在架构演进的初期和中期，性能、可用性、可扩展性是我们追求的主要目标，高性能和高可用给用户带来更好的使用体验，扩展性可以方便我们支撑更大量级的并发。但是当系统做的越来越大，团队成员越来越多，我们就不得不考虑成本了。</p><p>这里面的“成本”有着复杂的含义，它不仅代表购买服务器的费用，还包括研发团队，内部的开发成本，沟通成本以及运维成本等等，甚至有些时候，成本会成为架构设计中的决定性因素。</p><p>比方说，你做一个直播系统，在架构设计时除了要关注起播速度还需要关注CDN成本；再比如作为团队Leader，你在日常开发中除了要推进正常的功能需求开发，也要考虑完善工具链建设提高工程师的研发效率，降低研发成本。</p><p>这很好理解，如果在一个100个人的团队中，你的工具为每个人每天节省了10分钟，那么加起来就是接近17小时，差不多增加了2个人工作时间。而正是基于提升扩展性和降低成本的考虑，我们最终走上了微服务化的道路。</p><h2>一课一思</h2><p>在实际的项目中，你可能已经将系统拆分成独立的服务部署了，那么在一开始，你在开发和运维的过程中是遇到了哪些问题促使你走上了微服务化的道路呢？欢迎在留言区与我分享你的经验。</p><p>最后，感谢你的阅读，如果这篇文章让你有所收获，也欢迎你将它分享给更多的朋友。</p>","comments":[{"had_liked":false,"id":150080,"user_name":"Wiggins","can_delete":false,"product_type":"c1","uid":1078222,"ip_address":"","ucode":"021EE98CF0E4EE","user_header":"https://static001.geekbang.org/account/avatar/00/10/73/ce/23bd3997.jpg","comment_is_top":false,"comment_ctime":1573459156,"is_pvip":false,"discussion_count":4,"race_medal":1,"score":"100357706964","product_id":100035801,"comment_content":"走上微服务化道路的主要原因还是微服务目前大热加上docker的兴起，出于可能降低成本的考虑。<br>但以前就是SOA的架构，按照模块分解服务，但是并没有微服务，不知道这样的模块分解服务然后通过DNS去访问的方式叫做什么呢？<br>而有个问题在于现在公司的确是将业务按照模块拆分了，但是这些模块还是访问的同一个库，这样微服务拆分是不是并没有性能上的提升，反而因为多了网络传输而更加慢了，只是逻辑分层清晰了？那这个时候还有必须微服务么？毕竟多开一个数据库实例就要有额外的支出。","like_count":24,"discussions":[{"author":{"id":1740057,"avatar":"https://static001.geekbang.org/account/avatar/00/1a/8d/19/c69c43d2.jpg","nickname":"Tim","note":"","ucode":"F15BADC36F8380","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":56727,"discussion_content":"个人理解，如果没有分库的话，微服务主要还是解决高可用的问题，1、微服务要和网关、服务治理服务发现框架结合使用，这保证了请求只会分发到可用的节点。2、相对于soa，微服务的的粒度更小，流量大起来了受影响的范围也会变小，比如我soa有个oms系统单独部署，有查询订单和插入订单两个接口，当查询量激增的情况下，很有可能因为查询耗尽了机器资源，导致插入的接口也不可用，如果用微服务，查询和插入分别单独部署，就不会相互影响，解耦的粒度更细了。3、横向拓展机器资源分配更精准的问题，同样是上面的例子，查询激增如果soa的横向拓展，拓展出来的实例资源可能要同时用对插入和查询，如果是微服务我们只需要拓展查询接口的实例，能精准的把资源分配给查询。","likes_number":19,"is_delete":false,"is_hidden":false,"ctime":1574512411,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1848415,"avatar":"","nickname":"彭发瑞","note":"","ucode":"F8A21C23D65F41","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":312989,"discussion_content":"如果不分数据库，流量大了受影响的范围不一定变小。比如某个微服务调第三方，同时操作了数据库，如果第三方响应慢，会长时间占用数据库链接资源，影响其他所有要使用数据库的微服务。","likes_number":2,"is_delete":false,"is_hidden":false,"ctime":1602902840,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1261493,"avatar":"https://static001.geekbang.org/account/avatar/00/13/3f/b5/5fe77e16.jpg","nickname":"不经意间","note":"","ucode":"C39D98697ACB8B","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":168598,"discussion_content":"典型的无状态应用扩展，然后实现分流。","likes_number":1,"is_delete":false,"is_hidden":false,"ctime":1581591506,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1017733,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/87/85/fb5ffceb.jpg","nickname":"水木江南","note":"","ucode":"9A0044D4A850A1","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":375540,"discussion_content":"目前只能称呼minisevise。有两个办法，拆库真正微服务。或横向拓展做mha高可用。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1621736326,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":150041,"user_name":"chp","can_delete":false,"product_type":"c1","uid":1112415,"ip_address":"","ucode":"F0A2442230CD45","user_header":"https://static001.geekbang.org/account/avatar/00/10/f9/5f/b0a125a9.jpg","comment_is_top":false,"comment_ctime":1573452111,"is_pvip":false,"discussion_count":6,"race_medal":0,"score":"44523125071","product_id":100035801,"comment_content":"现在公司，把业务按模块拆分，每个成员负责一个模块，但是这些模块依然连的同一个库。","like_count":11,"discussions":[{"author":{"id":1602934,"avatar":"https://static001.geekbang.org/account/avatar/00/18/75/76/ed2e44c3.jpg","nickname":"梦在旅途","note":"","ucode":"02A2B792A4E9FF","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":353058,"discussion_content":"拆服务而不拆DB，这样只会导致dB读写压力更大，这样拆分最多只是解决代码耦合问题，便于关注点分离，可快速迭代上线，但如果没有处理好对dB的操作，那可能会比拆分更糟糕。拆分微服务，有利有弊，就看每个公司实际项目取舍，拆分最大问题就是分布式事务问题，如何保证服务链路上所有操作都能同时成功或回滚，不是所有业务都能最终一致性的。","likes_number":4,"is_delete":false,"is_hidden":false,"ctime":1614991320,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1015754,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/7f/ca/ea85bfdd.jpg","nickname":"helloworld","note":"","ucode":"00DF2FEC58D2E6","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":281160,"discussion_content":"伪微服务","likes_number":1,"is_delete":false,"is_hidden":false,"ctime":1591681497,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1261493,"avatar":"https://static001.geekbang.org/account/avatar/00/13/3f/b5/5fe77e16.jpg","nickname":"不经意间","note":"","ucode":"C39D98697ACB8B","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":168604,"discussion_content":"业务规模大了之后，数据库必然要读写分离，水平拆分，","likes_number":1,"is_delete":false,"is_hidden":false,"ctime":1581591709,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1261493,"avatar":"https://static001.geekbang.org/account/avatar/00/13/3f/b5/5fe77e16.jpg","nickname":"不经意间","note":"","ucode":"C39D98697ACB8B","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":168600,"discussion_content":"算是解耦合了吧，避免瓶颈时交叉感染。","likes_number":1,"is_delete":false,"is_hidden":false,"ctime":1581591613,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1015189,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/7d/95/dd73022c.jpg","nickname":"我是曾经那个少年","note":"","ucode":"9F02F7FF147D14","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":295239,"discussion_content":"怎么好多人都是这个样子处理的。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1596123122,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1175495,"avatar":"https://static001.geekbang.org/account/avatar/00/11/ef/c7/07bffbf3.jpg","nickname":"小土豆爸爸","note":"","ucode":"E3FED198AB803A","race_medal":1,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":274054,"discussion_content":"有点危险","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1590539840,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":195481,"user_name":"Alex Liu","can_delete":false,"product_type":"c1","uid":1079515,"ip_address":"","ucode":"68D1F6F9E7F05C","user_header":"https://static001.geekbang.org/account/avatar/00/10/78/db/825d3b7c.jpg","comment_is_top":false,"comment_ctime":1585190818,"is_pvip":false,"replies":[{"id":"75838","content":"是的，会非常痛苦","user_name":"作者回复","user_name_real":"唐扬","uid":"1448977","ctime":1586088856,"ip_address":"","comment_id":195481,"utype":1}],"discussion_count":2,"race_medal":0,"score":"40239896482","product_id":100035801,"comment_content":"现在只要是个项目都恨不得用微服务，而且用的不彻底，反而集成了单体和微服务的缺点，简直就是人间炼狱啊","like_count":9,"discussions":[{"author":{"id":1448977,"avatar":"https://static001.geekbang.org/account/avatar/00/16/1c/11/4b45993d.jpg","nickname":"唐扬","note":"","ucode":"1AF4C4A4DBC6EF","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":489085,"discussion_content":"是的，会非常痛苦","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1586088856,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1272026,"avatar":"https://static001.geekbang.org/account/avatar/00/13/68/da/5bcb83b1.jpg","nickname":"白晨","note":"","ucode":"6D6171B8ECEDDD","race_medal":0,"user_type":1,"is_pvip":true},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":579005,"discussion_content":"有具体的例子说明看看吗","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1657117781,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":224728,"user_name":"沐紫剑","can_delete":false,"product_type":"c1","uid":1059904,"ip_address":"","ucode":"3B820B34687B30","user_header":"https://static001.geekbang.org/account/avatar/00/10/2c/40/d97909b0.jpg","comment_is_top":false,"comment_ctime":1591522544,"is_pvip":false,"replies":[{"id":"82709","content":"一般一个人可以维护2-3个微服务，所以算是合理的","user_name":"作者回复","user_name_real":"唐扬","uid":"1448977","ctime":1591538195,"ip_address":"","comment_id":224728,"utype":1}],"discussion_count":3,"race_medal":0,"score":"31656293616","product_id":100035801,"comment_content":"如果一个系统微服务数比开发人数还要多，这样合理吗","like_count":7,"discussions":[{"author":{"id":1448977,"avatar":"https://static001.geekbang.org/account/avatar/00/16/1c/11/4b45993d.jpg","nickname":"唐扬","note":"","ucode":"1AF4C4A4DBC6EF","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":497585,"discussion_content":"一般一个人可以维护2-3个微服务，所以算是合理的","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1591538195,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":2032149,"avatar":"https://static001.geekbang.org/account/avatar/00/1f/02/15/24b46577.jpg","nickname":"祥先生","note":"","ucode":"CCEDB34201ECC3","race_medal":0,"user_type":1,"is_pvip":true},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":549421,"discussion_content":"Ddd可以用来指导服务划分","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1643965593,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1018972,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/8c/5c/3f164f66.jpg","nickname":"亚林","note":"","ucode":"4A5A6D24314B79","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":532834,"discussion_content":"隔壁老师，提出了三个火枪手原则","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1637717645,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"user_type\":1}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":153075,"user_name":"Geek_33c134","can_delete":false,"product_type":"c1","uid":1596647,"ip_address":"","ucode":"C5BBA83AABD2AC","user_header":"http://thirdwx.qlogo.cn/mmopen/vi_32/Ir1EdhB29109UhH7SGnVLEfEcKcGPDViaTpbS7BYXngqFghThYc093oFCTwsTLjVR7nHPokXJIPm7rbmPAU7TdQ/132","comment_is_top":false,"comment_ctime":1574153556,"is_pvip":false,"replies":[{"id":"59022","content":"可以只是你负责的qps，你需要对你负责的项目模块的数据有足够的了解","user_name":"作者回复","user_name_real":"唐扬","uid":"1448977","ctime":1574294596,"ip_address":"","comment_id":153075,"utype":1}],"discussion_count":4,"race_medal":0,"score":"27343957332","product_id":100035801,"comment_content":"唐老师你好，关于高并发的系统人们都会问系统的qps是多少。但是如果一个系统经过服务化之后，我只会负责其中的一个小模块，所以我关注的只是这个模块的访问量多少。所以系统的qps我是无法关注的，也关注不出什么东西（因为其他的模块都不是我负责的）。想问下这时候人们所问的qps是指模块的qps还是只系统呢？如果是模块的话qps其实是比较小的，很难提到高并发；但是如果是系统的qps，而其他模块是其他部门负责的，与我又没有什么关系。这种情况下应该如何回答呢？","like_count":7,"discussions":[{"author":{"id":1448977,"avatar":"https://static001.geekbang.org/account/avatar/00/16/1c/11/4b45993d.jpg","nickname":"唐扬","note":"","ucode":"1AF4C4A4DBC6EF","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":475033,"discussion_content":"可以只是你负责的qps，你需要对你负责的项目模块的数据有足够的了解","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1574294596,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1276563,"avatar":"https://static001.geekbang.org/account/avatar/00/13/7a/93/c9302518.jpg","nickname":"高志强","note":"","ucode":"68737002043752","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":213901,"discussion_content":"我工作第五年了，都没做过高并发相关的，以前公司有也不是我负责的根本轮不到我这~ 这种东西只有自己做过才能真正的体会深刻。","likes_number":2,"is_delete":false,"is_hidden":false,"ctime":1585133412,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":1,"child_discussions":[{"author":{"id":1015754,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/7f/ca/ea85bfdd.jpg","nickname":"helloworld","note":"","ucode":"00DF2FEC58D2E6","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":1276563,"avatar":"https://static001.geekbang.org/account/avatar/00/13/7a/93/c9302518.jpg","nickname":"高志强","note":"","ucode":"68737002043752","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":281161,"discussion_content":"说到点上了","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1591681600,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":213901,"ip_address":""},"score":281161,"extra":""}]},{"author":{"id":1035243,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/cb/eb/2a51ba53.jpg","nickname":"Sunny Snow","note":"","ucode":"A7C5D3327FD3BD","race_medal":0,"user_type":1,"is_pvip":true},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":297054,"discussion_content":"如果你是刚刚进入某一个大公司，可能你只知道你负责的模块的情况，但是如果你待了2，3年还是只知道自己负责的模块的情况，而连更大的项目结构都不了解，可能就是你自己的问题了吧","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1596762353,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":225196,"user_name":"helloworld","can_delete":false,"product_type":"c1","uid":1015754,"ip_address":"","ucode":"00DF2FEC58D2E6","user_header":"https://static001.geekbang.org/account/avatar/00/0f/7f/ca/ea85bfdd.jpg","comment_is_top":false,"comment_ctime":1591681866,"is_pvip":false,"replies":[{"id":"83113","content":"是的 是有多一跳的问题","user_name":"作者回复","user_name_real":"唐扬","uid":"1448977","ctime":1591803015,"ip_address":"","comment_id":225196,"utype":1}],"discussion_count":1,"race_medal":0,"score":"18771551050","product_id":100035801,"comment_content":"请问老师，若把一个单体服务拆分成多个微服务后，原来客户端只需要一次http调用服务器，微服务化后客户端需要多次http调用服务器端，这就对客户端来说就增加了总的调用时间了，是不是存在这个问题呢？","like_count":4,"discussions":[{"author":{"id":1448977,"avatar":"https://static001.geekbang.org/account/avatar/00/16/1c/11/4b45993d.jpg","nickname":"唐扬","note":"","ucode":"1AF4C4A4DBC6EF","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":497771,"discussion_content":"是的 是有多一跳的问题","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1591803015,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":195018,"user_name":"张传美","can_delete":false,"product_type":"c1","uid":1096088,"ip_address":"","ucode":"2C263F32855906","user_header":"https://static001.geekbang.org/account/avatar/00/10/b9/98/69bf4f3a.jpg","comment_is_top":false,"comment_ctime":1585128215,"is_pvip":false,"replies":[{"id":"75194","content":"个人觉得2个活跃的服务可能已经疲于奔命了","user_name":"作者回复","user_name_real":"唐扬","uid":"1448977","ctime":1585703143,"ip_address":"","comment_id":195018,"utype":1}],"discussion_count":1,"race_medal":0,"score":"18764997399","product_id":100035801,"comment_content":"一个工程师负责几个服务是合理的？<br>我的思考：从服务活跃度，重要度，工程师水平三个角度来考虑<br>1. 活跃又重要的服务，一个高级开发工程师不超过3个？<br>2. 非活跃，非重要的服务在全部服务数中的占比应低于30%？<br>想问下：<br>1. 业界的最佳实践是？<br>2. 您认为一个工程师负责几个服务是合理的？","like_count":5,"discussions":[{"author":{"id":1448977,"avatar":"https://static001.geekbang.org/account/avatar/00/16/1c/11/4b45993d.jpg","nickname":"唐扬","note":"","ucode":"1AF4C4A4DBC6EF","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":488951,"discussion_content":"个人觉得2个活跃的服务可能已经疲于奔命了","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1585703143,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":210697,"user_name":"钱","can_delete":false,"product_type":"c1","uid":1009652,"ip_address":"","ucode":"2C92A243A463D4","user_header":"https://static001.geekbang.org/account/avatar/00/0f/67/f4/9a1feb59.jpg","comment_is_top":false,"comment_ctime":1587809675,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"14472711563","product_id":100035801,"comment_content":"😅核心还是钱，微服务化还挺复杂的尤其是基础设施不健全时搞，问题会更多。所以，能不搞就不搞，但是因为不搞耽误公司赚钱或者使公司多花钱钱时，自然会有人推着你搞，你不搞就搞你。","like_count":4},{"had_liked":false,"id":181597,"user_name":"Thranduil","can_delete":false,"product_type":"c1","uid":1831181,"ip_address":"","ucode":"E06015A78716E8","user_header":"https://static001.geekbang.org/account/avatar/00/1b/f1/0d/b4bd5b79.jpg","comment_is_top":false,"comment_ctime":1582588754,"is_pvip":false,"replies":[{"id":"71105","content":"额 大概率是不可行的，中台其实是对现有业务的抽象，如果连业务都没有，何谈抽象呢","user_name":"作者回复","user_name_real":"唐扬","uid":"1448977","ctime":1583115329,"ip_address":"","comment_id":181597,"utype":1}],"discussion_count":2,"race_medal":0,"score":"14467490642","product_id":100035801,"comment_content":"公司刚开始就直接上中台可行吗？","like_count":3,"discussions":[{"author":{"id":1448977,"avatar":"https://static001.geekbang.org/account/avatar/00/16/1c/11/4b45993d.jpg","nickname":"唐扬","note":"","ucode":"1AF4C4A4DBC6EF","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":485046,"discussion_content":"额 大概率是不可行的，中台其实是对现有业务的抽象，如果连业务都没有，何谈抽象呢","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1583115329,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1246178,"avatar":"https://static001.geekbang.org/account/avatar/00/13/03/e2/5768d26e.jpg","nickname":"inrtyx","note":"","ucode":"81CD18FF34ABAB","race_medal":0,"user_type":1,"is_pvip":true},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":188337,"discussion_content":"怕会扯到蛋","likes_number":2,"is_delete":false,"is_hidden":false,"ctime":1582809441,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":149947,"user_name":"撒旦的堕落","can_delete":false,"product_type":"c1","uid":1116864,"ip_address":"","ucode":"15F6AA41EE556F","user_header":"https://static001.geekbang.org/account/avatar/00/11/0a/c0/401c240e.jpg","comment_is_top":false,"comment_ctime":1573435273,"is_pvip":false,"replies":[{"id":"57790","content":"相同的经历呀，苦涩~","user_name":"作者回复","user_name_real":"唐扬","uid":"1448977","ctime":1573481805,"ip_address":"","comment_id":149947,"utype":1}],"discussion_count":2,"race_medal":0,"score":"14458337161","product_id":100035801,"comment_content":"以前每次发版整个部门的人都要到凌晨  项目太大  导致开发时项目启动耗时太多  自己的代码会牵扯到别人的代码  提交时 代码冲突问题  因为所有人代码都在一块  一个人有功能要上线  其他人都得留下 一个很小的功能上线  测试都到对其他功能做回归测试   真的太难了","like_count":3,"discussions":[{"author":{"id":1448977,"avatar":"https://static001.geekbang.org/account/avatar/00/16/1c/11/4b45993d.jpg","nickname":"唐扬","note":"","ucode":"1AF4C4A4DBC6EF","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":474019,"discussion_content":"相同的经历呀，苦涩~","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1573481805,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1074640,"avatar":"https://static001.geekbang.org/account/avatar/00/10/65/d0/c11d4a31.jpg","nickname":"滴水藏海","note":"","ucode":"9C1F9C91189F69","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":237937,"discussion_content":"合并完代码，还得每个人确认下自己代码有没有漏，哪能记清楚每个细节，于是我们就开始服务化了～","likes_number":1,"is_delete":false,"is_hidden":false,"ctime":1587198531,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":225194,"user_name":"helloworld","can_delete":false,"product_type":"c1","uid":1015754,"ip_address":"","ucode":"00DF2FEC58D2E6","user_header":"https://static001.geekbang.org/account/avatar/00/0f/7f/ca/ea85bfdd.jpg","comment_is_top":false,"comment_ctime":1591681520,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"10181616112","product_id":100035801,"comment_content":"在对单体应用进行微服务改造的过程中，切入点可以从比较高频的业务逻辑入手，可以将这部分业务逻辑首先从单体应用中独立出来，通过微服务的形式进行部署，然后逐渐逐渐地过渡到将其他的逻辑单元","like_count":2},{"had_liked":false,"id":172116,"user_name":"空知","can_delete":false,"product_type":"c1","uid":1013283,"ip_address":"","ucode":"C448E98238DD36","user_header":"https://static001.geekbang.org/account/avatar/00/0f/76/23/31e5e984.jpg","comment_is_top":false,"comment_ctime":1579092425,"is_pvip":false,"replies":[{"id":"66903","content":"是的","user_name":"作者回复","user_name_real":"唐扬","uid":"1448977","ctime":1579228408,"ip_address":"","comment_id":172116,"utype":1}],"discussion_count":2,"race_medal":0,"score":"10169027017","product_id":100035801,"comment_content":"走上微服务的原因是 <br>1、确实是代码量大 交互在一起复杂<br>2、部署、测试麻烦","like_count":2,"discussions":[{"author":{"id":1448977,"avatar":"https://static001.geekbang.org/account/avatar/00/16/1c/11/4b45993d.jpg","nickname":"唐扬","note":"","ucode":"1AF4C4A4DBC6EF","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":481627,"discussion_content":"是的","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1579228408,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1537341,"avatar":"https://static001.geekbang.org/account/avatar/00/17/75/3d/71ad2330.jpg","nickname":"在路上","note":"","ucode":"C68778C04D61DF","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":282372,"discussion_content":"1、研发效率降低导致成本上升和客户投诉\n2、运维困难\n3、系统可用性、可靠性下降\n4、扩展性","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1591955492,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":150462,"user_name":"Devin","can_delete":false,"product_type":"c1","uid":1025067,"ip_address":"","ucode":"7BDCD517BD8DD2","user_header":"https://static001.geekbang.org/account/avatar/00/0f/a4/2b/3ba9f64b.jpg","comment_is_top":false,"comment_ctime":1573540702,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"10163475294","product_id":100035801,"comment_content":"系统QPS并不是微服务化的决定性因素或者说直接因素，主要还是看是否遇到问题了，比如资源问题、效率问题、成本问题等。","like_count":2},{"had_liked":false,"id":150359,"user_name":"阿卡牛","can_delete":false,"product_type":"c1","uid":1022247,"ip_address":"","ucode":"0BC43A904C3199","user_header":"https://static001.geekbang.org/account/avatar/00/0f/99/27/47aa9dea.jpg","comment_is_top":false,"comment_ctime":1573522745,"is_pvip":false,"replies":[{"id":"57978","content":"没有准备好就为服务化是大坑","user_name":"作者回复","user_name_real":"唐扬","uid":"1448977","ctime":1573611036,"ip_address":"","comment_id":150359,"utype":1}],"discussion_count":1,"race_medal":0,"score":"10163457337","product_id":100035801,"comment_content":"之前主导过一个项目，那时正是微服务概念开始流行的时候，脑袋一热，很多东西还没搞懂，就心痒痒地弄起来了。<br>结果当然悲剧了，还好及时止损。<br>不过遇到一个大问题还是可以说说的：就是数据问题，至今没搞明白，多个微服务之间是否可以存在相同的数据。还是必须通过接口的方式获取","like_count":2,"discussions":[{"author":{"id":1448977,"avatar":"https://static001.geekbang.org/account/avatar/00/16/1c/11/4b45993d.jpg","nickname":"唐扬","note":"","ucode":"1AF4C4A4DBC6EF","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":474134,"discussion_content":"没有准备好就为服务化是大坑","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1573611036,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":323062,"user_name":"亚林","can_delete":false,"product_type":"c1","uid":1018972,"ip_address":"","ucode":"4A5A6D24314B79","user_header":"https://static001.geekbang.org/account/avatar/00/0f/8c/5c/3f164f66.jpg","comment_is_top":false,"comment_ctime":1637717775,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"5932685071","product_id":100035801,"comment_content":"前几年，我身边一群人都在谈微服务，但没有人谈康威法则，😭","like_count":1},{"had_liked":false,"id":262128,"user_name":"神毓逍遥","can_delete":false,"product_type":"c1","uid":2147220,"ip_address":"","ucode":"83351CB18B190E","user_header":"https://static001.geekbang.org/account/avatar/00/20/c3/94/e89ebc50.jpg","comment_is_top":false,"comment_ctime":1605618295,"is_pvip":true,"discussion_count":0,"race_medal":0,"score":"5900585591","product_id":100035801,"comment_content":"微服务的好处：<br>1  业务解耦  开发维护简单，构建快<br>2   多语言  多模块  可以提高开发进度","like_count":1},{"had_liked":false,"id":200948,"user_name":"与狼共舞","can_delete":false,"product_type":"c1","uid":1391144,"ip_address":"","ucode":"02AC04B43F0194","user_header":"https://static001.geekbang.org/account/avatar/00/15/3a/28/cf707831.jpg","comment_is_top":false,"comment_ctime":1585697971,"is_pvip":false,"replies":[{"id":"75830","content":"分布式事务都是头大","user_name":"作者回复","user_name_real":"唐扬","uid":"1448977","ctime":1586087700,"ip_address":"","comment_id":200948,"utype":1}],"discussion_count":1,"race_medal":0,"score":"5880665267","product_id":100035801,"comment_content":"java还好像php遇到分布式事务头大。","like_count":1,"discussions":[{"author":{"id":1448977,"avatar":"https://static001.geekbang.org/account/avatar/00/16/1c/11/4b45993d.jpg","nickname":"唐扬","note":"","ucode":"1AF4C4A4DBC6EF","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":490190,"discussion_content":"分布式事务都是头大","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1586087700,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":156995,"user_name":"oneDream","can_delete":false,"product_type":"c1","uid":1091817,"ip_address":"","ucode":"B1ED43FA3DD918","user_header":"https://static001.geekbang.org/account/avatar/00/10/a8/e9/9b69a009.jpg","comment_is_top":false,"comment_ctime":1575010858,"is_pvip":false,"discussion_count":1,"race_medal":0,"score":"5869978154","product_id":100035801,"comment_content":"微服务最根本的应该是解决架构和可扩展的问题，像文章重说的1wqps 在微服务场景中也同样存在","like_count":1,"discussions":[{"author":{"id":1886331,"avatar":"https://static001.geekbang.org/account/avatar/00/1c/c8/7b/153181d7.jpg","nickname":"夜辉","note":"","ucode":"9421385F51FF9E","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":364767,"discussion_content":"但引入了新的技术，又会带来更多的问题","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1617597222,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":150459,"user_name":"longslee","can_delete":false,"product_type":"c1","uid":1465986,"ip_address":"","ucode":"C24E32E5B1B6F5","user_header":"https://static001.geekbang.org/account/avatar/00/16/5e/82/438c8534.jpg","comment_is_top":false,"comment_ctime":1573540312,"is_pvip":false,"replies":[{"id":"57976","content":"👍👍","user_name":"作者回复","user_name_real":"唐扬","uid":"1448977","ctime":1573610958,"ip_address":"","comment_id":150459,"utype":1}],"discussion_count":1,"race_medal":0,"score":"5868507608","product_id":100035801,"comment_content":"打卡。还是有收获的，以前理解微服务化，只知道业务细分和单独部署扩建容易，没想到数据库连接数这个地方也有讲究。  曾经的大项目是一体化的，开发过程比较崩溃的是八竿子打不着的类被远方的一个兄弟改了，我提交代码的时候被卡下来了。。。原因就是紧耦合，而我没有全量更新代码。","like_count":2,"discussions":[{"author":{"id":1448977,"avatar":"https://static001.geekbang.org/account/avatar/00/16/1c/11/4b45993d.jpg","nickname":"唐扬","note":"","ucode":"1AF4C4A4DBC6EF","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":474167,"discussion_content":"👍👍","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1573610958,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":340864,"user_name":"剑八","can_delete":false,"product_type":"c1","uid":1297630,"ip_address":"","ucode":"0A09F41DB8A4E7","user_header":"https://static001.geekbang.org/account/avatar/00/13/cc/de/e28c01e1.jpg","comment_is_top":false,"comment_ctime":1649206428,"is_pvip":true,"discussion_count":0,"race_medal":0,"score":"1649206428","product_id":100035801,"comment_content":"单体发布慢，影响其它模块，代码冲突多，<br>数据库连接受单体应用影响（比如交易流量大要扩容，影响到商品的数据库连接）","like_count":0},{"had_liked":false,"id":317949,"user_name":"青年祭司","can_delete":false,"product_type":"c1","uid":1259156,"ip_address":"","ucode":"C88EDAE3FF09AE","user_header":"https://static001.geekbang.org/account/avatar/00/13/36/94/0b969588.jpg","comment_is_top":false,"comment_ctime":1635069568,"is_pvip":false,"discussion_count":0,"race_medal":5,"score":"1635069568","product_id":100035801,"comment_content":"老师，为什么数据库连接池最大连接数只设置为20到30，而数据库连接数其实很大","like_count":0},{"had_liked":false,"id":168133,"user_name":"L响","can_delete":false,"product_type":"c1","uid":1667491,"ip_address":"","ucode":"012AE7EE725911","user_header":"https://static001.geekbang.org/account/avatar/00/19/71/a3/b881f08c.jpg","comment_is_top":false,"comment_ctime":1578017011,"is_pvip":false,"replies":[{"id":"66195","content":"跨网络调用肯定性能会下降","user_name":"作者回复","user_name_real":"唐扬","uid":"1448977","ctime":1578733101,"ip_address":"","comment_id":168133,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1578017011","product_id":100035801,"comment_content":"我的系统使用的是leveled 只能在进程内读写 目前性能很高 试着拆分成微服务后 增加了网络调用 导致性能降低 这种情况老师遇到过吗","like_count":0,"discussions":[{"author":{"id":1448977,"avatar":"https://static001.geekbang.org/account/avatar/00/16/1c/11/4b45993d.jpg","nickname":"唐扬","note":"","ucode":"1AF4C4A4DBC6EF","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":480147,"discussion_content":"跨网络调用肯定性能会下降","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1578733101,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":163836,"user_name":"yuny","can_delete":false,"product_type":"c1","uid":1365988,"ip_address":"","ucode":"D4A1475B86A03B","user_header":"https://static001.geekbang.org/account/avatar/00/14/d7/e4/0cd835d1.jpg","comment_is_top":false,"comment_ctime":1576809305,"is_pvip":true,"replies":[{"id":"63079","content":"对很多公司来说，中台还比较远","user_name":"作者回复","user_name_real":"唐扬","uid":"1448977","ctime":1577242698,"ip_address":"","comment_id":163836,"utype":1}],"discussion_count":4,"race_medal":0,"score":"1576809305","product_id":100035801,"comment_content":"微服务后，然后就是中台的构建了","like_count":0,"discussions":[{"author":{"id":1448977,"avatar":"https://static001.geekbang.org/account/avatar/00/16/1c/11/4b45993d.jpg","nickname":"唐扬","note":"","ucode":"1AF4C4A4DBC6EF","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":478548,"discussion_content":"对很多公司来说，中台还比较远","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1577242698,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1162113,"avatar":"https://static001.geekbang.org/account/avatar/00/11/bb/81/8260cbf6.jpg","nickname":"Geek_bbe25a","note":"","ucode":"A50329BE030715","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":299141,"discussion_content":"中台到底是个啥玩意儿，每个公司都不一样，我们就公司叫做技术中台，有的公司是业务中台","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1597574894,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":1,"child_discussions":[{"author":{"id":1570088,"avatar":"https://static001.geekbang.org/account/avatar/00/17/f5/28/898a6947.jpg","nickname":"deepz","note":"","ucode":"4BD23A44CDB384","race_medal":0,"user_type":1,"is_pvip":true},"reply_author":{"id":1162113,"avatar":"https://static001.geekbang.org/account/avatar/00/11/bb/81/8260cbf6.jpg","nickname":"Geek_bbe25a","note":"","ucode":"A50329BE030715","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":300781,"discussion_content":"抽象技术、抽象业务。还有别的中台比如数据中台等等。有的公司是会同时有多个方向中台的，便捷高效，提高各方面效率。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1598262929,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":299141,"ip_address":""},"score":300781,"extra":""}]},{"author":{"id":1246178,"avatar":"https://static001.geekbang.org/account/avatar/00/13/03/e2/5768d26e.jpg","nickname":"inrtyx","note":"","ucode":"81CD18FF34ABAB","race_medal":0,"user_type":1,"is_pvip":true},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":188342,"discussion_content":"天下大势，分久必合，合久必分，这不是就微服务和中台吗","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1582809516,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":150707,"user_name":"饭饭","can_delete":false,"product_type":"c1","uid":1097426,"ip_address":"","ucode":"EF6F6B5F6839F3","user_header":"https://static001.geekbang.org/account/avatar/00/10/be/d2/1400c368.jpg","comment_is_top":false,"comment_ctime":1573604078,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1573604078","product_id":100035801,"comment_content":"用户服务伸缩的时候数据库还是会成为瓶颈","like_count":0},{"had_liked":false,"id":150587,"user_name":"啊啊啊哦哦","can_delete":false,"product_type":"c1","uid":1309877,"ip_address":"","ucode":"68C7153ECAAC57","user_header":"http://thirdwx.qlogo.cn/mmopen/vi_32/RNO4yZyBvic914hewmNNE8iblYDcfv5yGHZ9OnKuCuZXNmGR0F5qV3icKLT2xpMt66GyEpicZVvrmz8A6TIqt92MQg/132","comment_is_top":false,"comment_ctime":1573563983,"is_pvip":false,"replies":[{"id":"57980","content":"不是 是部署用户的接口的业务","user_name":"作者回复","user_name_real":"唐扬","uid":"1448977","ctime":1573611111,"ip_address":"","comment_id":150587,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1573563983","product_id":100035801,"comment_content":"用户池值得是用户连接池？","like_count":0,"discussions":[{"author":{"id":1448977,"avatar":"https://static001.geekbang.org/account/avatar/00/16/1c/11/4b45993d.jpg","nickname":"唐扬","note":"","ucode":"1AF4C4A4DBC6EF","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":474209,"discussion_content":"不是 是部署用户的接口的业务","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1573611111,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":150446,"user_name":"海罗沃德","can_delete":false,"product_type":"c1","uid":1165364,"ip_address":"","ucode":"8704F1D6980FA0","user_header":"https://static001.geekbang.org/account/avatar/00/11/c8/34/fb871b2c.jpg","comment_is_top":false,"comment_ctime":1573535992,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1573535992","product_id":100035801,"comment_content":"由於公司是跨國的業務系統，以前的monolith服務器部署在美國，就導致歐洲亞洲訪問速度很慢，但是分地理位置部署成本又太高，就考慮使用AWS的跨region模式，租用AWS的專線來做數據的不同region同步","like_count":0},{"had_liked":false,"id":150344,"user_name":"旅途","can_delete":false,"product_type":"c1","uid":1212902,"ip_address":"","ucode":"5022477E8E9441","user_header":"https://static001.geekbang.org/account/avatar/00/12/81/e6/6cafed37.jpg","comment_is_top":false,"comment_ctime":1573521133,"is_pvip":false,"replies":[{"id":"57977","content":"业务池是为了隔离故障把业务拆分部署，业务池之间是平等的，最好不要相互调用","user_name":"作者回复","user_name_real":"唐扬","uid":"1448977","ctime":1573611016,"ip_address":"","comment_id":150344,"utype":1}],"discussion_count":3,"race_medal":0,"score":"1573521133","product_id":100035801,"comment_content":"老师，业务池的作用什么，其他的业务池只访问用户池可以吗","like_count":0,"discussions":[{"author":{"id":1448977,"avatar":"https://static001.geekbang.org/account/avatar/00/16/1c/11/4b45993d.jpg","nickname":"唐扬","note":"","ucode":"1AF4C4A4DBC6EF","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":474131,"discussion_content":"业务池是为了隔离故障把业务拆分部署，业务池之间是平等的，最好不要相互调用","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1573611016,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1048329,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/ff/09/e0c39733.jpg","nickname":"Jayliud","note":"","ucode":"0274FC2607B1BF","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":128713,"discussion_content":"确实是前后自相矛盾啊\n","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1578661619,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1212902,"avatar":"https://static001.geekbang.org/account/avatar/00/12/81/e6/6cafed37.jpg","nickname":"旅途","note":"","ucode":"5022477E8E9441","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":50070,"discussion_content":"老师，既然拆分了业务，那为什么其他的业务池还会查询用户呢","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1573659654,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":150311,"user_name":"小小小丶盘子","can_delete":false,"product_type":"c1","uid":1308056,"ip_address":"","ucode":"FCD4520F1EF872","user_header":"https://static001.geekbang.org/account/avatar/00/13/f5/98/45374bb9.jpg","comment_is_top":false,"comment_ctime":1573518219,"is_pvip":true,"replies":[{"id":"57981","content":"我觉得如果维护上痛点明显的话是有必要的","user_name":"作者回复","user_name_real":"唐扬","uid":"1448977","ctime":1573611160,"ip_address":"","comment_id":150311,"utype":1}],"discussion_count":2,"race_medal":0,"score":"1573518219","product_id":100035801,"comment_content":"面试的时候，面试官问我，你们体量不大为什么要拆分呢？我从开发的角度回答的。项目维护或者单独优化，提取公共服务之类。老师，如果只是为了开发维护上做业务模块拆分，有必要吗？","like_count":0,"discussions":[{"author":{"id":1448977,"avatar":"https://static001.geekbang.org/account/avatar/00/16/1c/11/4b45993d.jpg","nickname":"唐扬","note":"","ucode":"1AF4C4A4DBC6EF","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":474121,"discussion_content":"我觉得如果维护上痛点明显的话是有必要的","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1573611160,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1022247,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/99/27/47aa9dea.jpg","nickname":"阿卡牛","note":"","ucode":"0BC43A904C3199","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":48749,"discussion_content":"个人觉得完全没必要，实施微服务的成本很大的，对开发人员的能力也有要求","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1573522815,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":150256,"user_name":"星空123","can_delete":false,"product_type":"c1","uid":1596920,"ip_address":"","ucode":"E998A7C585671B","user_header":"https://static001.geekbang.org/account/avatar/00/18/5d/f8/7de2c1cc.jpg","comment_is_top":false,"comment_ctime":1573485390,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1573485390","product_id":100035801,"comment_content":"目前项目还不是微服务的架构。但是早晚会变成微服务的","like_count":0},{"had_liked":false,"id":150020,"user_name":"吃饭饭","can_delete":false,"product_type":"c1","uid":1231549,"ip_address":"","ucode":"95CFA07CDA2957","user_header":"https://static001.geekbang.org/account/avatar/00/12/ca/bd/a51ae4b2.jpg","comment_is_top":false,"comment_ctime":1573447222,"is_pvip":false,"replies":[{"id":"57787","content":"是的~","user_name":"作者回复","user_name_real":"唐扬","uid":"1448977","ctime":1573481709,"ip_address":"","comment_id":150020,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1573447222","product_id":100035801,"comment_content":"一句话：量变引起质变；现在不少人张嘴微服务闭嘴微服务，但是得去衡量自己的业务真的有必要吗？微服务看着优雅其实成本很大，就单纯这个问题每秒上完 QPS ，这业务量很大了，不细粒度怎么可以","like_count":0,"discussions":[{"author":{"id":1448977,"avatar":"https://static001.geekbang.org/account/avatar/00/16/1c/11/4b45993d.jpg","nickname":"唐扬","note":"","ucode":"1AF4C4A4DBC6EF","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":474038,"discussion_content":"是的~","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1573481709,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":149994,"user_name":"风再起时","can_delete":false,"product_type":"c1","uid":1040352,"ip_address":"","ucode":"B642372AFF07E7","user_header":"https://static001.geekbang.org/account/avatar/00/0f/df/e0/c7bb2a98.jpg","comment_is_top":false,"comment_ctime":1573442788,"is_pvip":false,"replies":[{"id":"57788","content":"有时候不止半小时：（","user_name":"作者回复","user_name_real":"唐扬","uid":"1448977","ctime":1573481735,"ip_address":"","comment_id":149994,"utype":1}],"discussion_count":2,"race_medal":0,"score":"1573442788","product_id":100035801,"comment_content":"发个版 ，半小时","like_count":0,"discussions":[{"author":{"id":1448977,"avatar":"https://static001.geekbang.org/account/avatar/00/16/1c/11/4b45993d.jpg","nickname":"唐扬","note":"","ucode":"1AF4C4A4DBC6EF","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":474033,"discussion_content":"有时候不止半小时：（","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1573481735,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1597653,"avatar":"https://static001.geekbang.org/account/avatar/00/18/60/d5/404dcf45.jpg","nickname":"波哦哦","note":"","ucode":"B361CC6AC9FA4E","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":185344,"discussion_content":"发个版，半天。出问题了， 回滚，半天 。 结果是半夜下班回家，第二天回公司挨骂。 哈哈哈哈哈","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1582618529,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":149989,"user_name":"Omer","can_delete":false,"product_type":"c1","uid":1676246,"ip_address":"","ucode":"8EE3E531313265","user_header":"https://static001.geekbang.org/account/avatar/00/19/93/d6/040e4965.jpg","comment_is_top":false,"comment_ctime":1573441881,"is_pvip":false,"replies":[{"id":"57789","content":"是拆分成单独的用户服务，这个服务只处理与用户相关的业务逻辑，所以部署的机器相比web层要少很多","user_name":"作者回复","user_name_real":"唐扬","uid":"1448977","ctime":1573481779,"ip_address":"","comment_id":149989,"utype":1}],"discussion_count":7,"race_medal":0,"score":"1573441881","product_id":100035801,"comment_content":"老师你好 ，我想请教一下。\b<br>数据库那块我有点疑惑，你把用户的模块拆分出来成了单独的用户库访问，为什么就减少了用户库的瓶颈呢，那我拆分之前的所有用户库的请求不减少的情况下都丢给用户模块，那请求数量和建立连接的数量和 不拆分的时候不是都差不多吗，而且还增加了不同服务之间的IO，希望老师看到能点解一下","like_count":0,"discussions":[{"author":{"id":1448977,"avatar":"https://static001.geekbang.org/account/avatar/00/16/1c/11/4b45993d.jpg","nickname":"唐扬","note":"","ucode":"1AF4C4A4DBC6EF","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":474031,"discussion_content":"是拆分成单独的用户服务，这个服务只处理与用户相关的业务逻辑，所以部署的机器相比web层要少很多","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1573481779,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1244596,"avatar":"http://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTLv9HJIW4OACkjlwOQJ9cU7HzvaDFYkACWCib2lzOMef9ZiaGDTVFqjPicpVK5KDRbBRVGGHrMHQO1Rw/132","nickname":"fdconan","note":"","ucode":"01C71C6E9FD1E4","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":52457,"discussion_content":"我理解应该是拆分前，多个业务多个连接池连接用户库。拆分后只有用户服务连接数据库这个连接池，用户服务部署的机器越少，连接池就越少，能达到最佳复用，自然就能降低用户库的瓶颈。不知道是否有理解不对的地方，请老师指教。","likes_number":2,"is_delete":false,"is_hidden":false,"ctime":1574052977,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":1,"child_discussions":[{"author":{"id":1047710,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/fc/9e/0a2afa60.jpg","nickname":"马金良","note":"","ucode":"8A6F568B94497F","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":1244596,"avatar":"http://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTLv9HJIW4OACkjlwOQJ9cU7HzvaDFYkACWCib2lzOMef9ZiaGDTVFqjPicpVK5KDRbBRVGGHrMHQO1Rw/132","nickname":"fdconan","note":"","ucode":"01C71C6E9FD1E4","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":101979,"discussion_content":"兄弟，我觉得你这个理解是对的","likes_number":1,"is_delete":false,"is_hidden":false,"ctime":1577320743,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":52457,"ip_address":""},"score":101979,"extra":""}]},{"author":{"id":1433344,"avatar":"http://thirdwx.qlogo.cn/mmopen/vi_32/EcYNib1bnDf5dz6JcrE8AoyZYMdqic2VNmbBtCcVZTO9EoDZZxqlQDEqQKo6klCCmklOtN9m0dTd2AOXqSneJYLw/132","nickname":"博弈","note":"","ucode":"B1A69837E41972","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":49468,"discussion_content":"这个还是不太懂，为什么部署了更少的服务，但请求数目没有降低，怎么会减少连接数？","likes_number":1,"is_delete":false,"is_hidden":false,"ctime":1573604318,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":1,"child_discussions":[{"author":{"id":1336430,"avatar":"https://static001.geekbang.org/account/avatar/00/14/64/6e/e5ecc1d2.jpg","nickname":"水手","note":"","ucode":"536BB54E1E3617","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":1433344,"avatar":"http://thirdwx.qlogo.cn/mmopen/vi_32/EcYNib1bnDf5dz6JcrE8AoyZYMdqic2VNmbBtCcVZTO9EoDZZxqlQDEqQKo6klCCmklOtN9m0dTd2AOXqSneJYLw/132","nickname":"博弈","note":"","ucode":"B1A69837E41972","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":211862,"discussion_content":"但是连接池少了啊，连接池会与数据库一直保持连接，就算没有请求的话","likes_number":2,"is_delete":false,"is_hidden":false,"ctime":1584890668,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":49468,"ip_address":""},"score":211862,"extra":""}]},{"author":{"id":1123043,"avatar":"https://static001.geekbang.org/account/avatar/00/11/22/e3/510b69f9.jpg","nickname":"benny","note":"","ucode":"E2F30AF0C808D9","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":168188,"discussion_content":"即使连接池变小，相同的请求数目，有些请求就得要更多等待","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1581560602,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1043738,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/ed/1a/ce7f7d54.jpg","nickname":"asdf100","note":"","ucode":"39D8D71453E575","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":48706,"discussion_content":"文章这点确实谅解的不清楚，建议编辑改进下。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1573520797,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]}]}