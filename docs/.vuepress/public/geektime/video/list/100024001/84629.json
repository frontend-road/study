{"id":84629,"title":"10 | Map声明、元素访问及遍历","content":"<h1>课件及源代码地址</h1><p><a href=\"https://gitee.com/geektime-geekbang/go_learning\">https://gitee.com/geektime-geekbang/go_learning</a></p><h2>书目推荐</h2><p><a href=\"time://mall?url=https%3A%2F%2Fh5.youzan.com%2Fv2%2Fgoods%2F1ycmk3uob0ryw\">《计算机程序的构造和解释》</a></p>","comments":[{"had_liked":false,"id":73993,"user_name":"辉仔lovers","can_delete":false,"product_type":"c3","uid":1210219,"ip_address":"","ucode":"3DC5B0CD0B8E71","user_header":"http://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTLVhJRVwJ0eVlC7zjNfWP6PP7VmUkF1X2m6qfh7Wic3NhAOz2fSGibF6LXLcJ59zOz7nBpCcByvtFjw/132","comment_is_top":false,"comment_ctime":1552055702,"is_pvip":false,"replies":[{"id":27069,"content":"capacity是设置初始化容量，map会自动扩容，但扩容会导致内存分配和数据复制，所以如果能够初始化到比较适合的capacity，可以提高性能。\n","user_name":"作者回复","user_name_real":"ChaoCai2010","uid":1008262,"ctime":1552104569,"ip_address":"","comment_id":73993,"utype":1}],"discussion_count":2,"race_medal":0,"score":2,"product_id":100024001,"comment_content":"老师：您好，请教个问题，make方式来创建map的时候传递了第二个参数capcity的作用是什么，是为了当map的长度超过capcity的时候自动扩容吗？其他方式初始化map的时候，是不是底层默认了一个初始容量呢？map的底层数据结构是类似于java中hashmap的哈希表吗？","like_count":9,"discussions":[{"author":{"id":1008262,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/62/86/632ad029.jpg","nickname":"蔡超","note":"","ucode":"4C281BBF511238","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":442372,"discussion_content":"capacity是设置初始化容量，map会自动扩容，但扩容会导致内存分配和数据复制，所以如果能够初始化到比较适合的capacity，可以提高性能。\n","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1552104569,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1105161,"avatar":"https://static001.geekbang.org/account/avatar/00/10/dd/09/feca820a.jpg","nickname":"helloworld","note":"","ucode":"1EECCA0F43E278","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":46651,"discussion_content":"mark","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1573189443,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":77141,"user_name":"行军伙夫","can_delete":false,"product_type":"c3","uid":1198350,"ip_address":"","ucode":"DC1792FDBC8D38","user_header":"https://static001.geekbang.org/account/avatar/00/12/49/0e/6121d428.jpg","comment_is_top":false,"comment_ctime":1552869492,"is_pvip":false,"replies":[{"id":28553,"content":"map的底成采用hash表机制，不是有序的","user_name":"作者回复","user_name_real":"ChaoCai2010","uid":1008262,"ctime":1553157045,"ip_address":"","comment_id":77141,"utype":1}],"discussion_count":4,"race_medal":0,"score":2,"product_id":100024001,"comment_content":"老师你好，我初始化了map[string]int { &quot;1&quot;: 1,  &quot;2&quot;: 4, &quot;3&quot;: 9, &quot;4&quot;: 16 }，当我用range进行遍历的时候，输出的结果并没有按照 1 1 ， 2 4， 3 9， 4 16的顺序进行输出，我想问问range遍历有自定义排序嘛","like_count":6,"discussions":[{"author":{"id":1008262,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/62/86/632ad029.jpg","nickname":"蔡超","note":"","ucode":"4C281BBF511238","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":443600,"discussion_content":"map的底成采用hash表机制，不是有序的","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1553157045,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":3184152,"avatar":"https://static001.geekbang.org/account/avatar/00/30/96/18/67592af2.jpg","nickname":"安然。","note":"","ucode":"3781C87F9ACF59","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":595878,"discussion_content":"mark","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1670422550,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":"北京","group_id":0},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1248307,"avatar":"https://static001.geekbang.org/account/avatar/00/13/0c/33/c5026169.jpg","nickname":"hiyang","note":"","ucode":"E521EE72C0F247","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":400769,"discussion_content":"print时是有序的（顺序和赋值时不一定一样，但是多次print，顺序是一样的），for range时是无序的（多次range的顺序不一样）","likes_number":1,"is_delete":false,"is_hidden":false,"ctime":1633418906,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1105161,"avatar":"https://static001.geekbang.org/account/avatar/00/10/dd/09/feca820a.jpg","nickname":"helloworld","note":"","ucode":"1EECCA0F43E278","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":46653,"discussion_content":"mark","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1573189596,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":75562,"user_name":"大王叫我来巡山","can_delete":false,"product_type":"c3","uid":1099513,"ip_address":"","ucode":"1B8D0C701BC95E","user_header":"https://static001.geekbang.org/account/avatar/00/10/c6/f9/caf27bd3.jpg","comment_is_top":false,"comment_ctime":1552436111,"is_pvip":false,"replies":[{"id":27594,"content":"谢谢你的鼓励！让我们大家持续学习！","user_name":"作者回复","user_name_real":"ChaoCai2010","uid":1008262,"ctime":1552452954,"ip_address":"","comment_id":75562,"utype":1}],"discussion_count":1,"race_medal":0,"score":2,"product_id":100024001,"comment_content":"非常感谢老师，作为软件开发行业的老鸟，写go语言有段时间，依然能有所收获，学习就是个不断交流的过程，我们在每一次交流中都能收获心得体会，对学习常怀敬畏之心，对同行怀谦卑之心。","like_count":5,"discussions":[{"author":{"id":1008262,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/62/86/632ad029.jpg","nickname":"蔡超","note":"","ucode":"4C281BBF511238","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":442943,"discussion_content":"谢谢你的鼓励！让我们大家持续学习！","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1552452954,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":155903,"user_name":"码农Kevin亮","can_delete":false,"product_type":"c3","uid":1116630,"ip_address":"","ucode":"D34562461CA0A1","user_header":"https://static001.geekbang.org/account/avatar/00/11/09/d6/5f366427.jpg","comment_is_top":false,"comment_ctime":1574776705,"is_pvip":false,"replies":[{"id":60933,"content":"fmt的输出在默认情况下是调用类型的String方法的，这样就是说map的String方法里没有输出ok这个值","user_name":"作者回复","user_name_real":"ChaoCai2010","uid":1008262,"ctime":1575623619,"ip_address":"","comment_id":155903,"utype":1}],"discussion_count":1,"race_medal":0,"score":2,"product_id":100024001,"comment_content":"请问老师，既然map的取值是返回两个值，那么为什么打印语句来打印map取值时只会输出值，而不会把ok的布尔值也输出了呢？","like_count":4,"discussions":[{"author":{"id":1008262,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/62/86/632ad029.jpg","nickname":"蔡超","note":"","ucode":"4C281BBF511238","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":475919,"discussion_content":"fmt的输出在默认情况下是调用类型的String方法的，这样就是说map的String方法里没有输出ok这个值","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1575623619,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":77175,"user_name":"蒙晓蒙","can_delete":false,"product_type":"c3","uid":1420568,"ip_address":"","ucode":"0ABAA1E81A7DC6","user_header":"https://static001.geekbang.org/account/avatar/00/15/ad/18/0c3fc20a.jpg","comment_is_top":false,"comment_ctime":1552876586,"is_pvip":false,"replies":[{"id":28552,"content":"map底成是通过hash来指定存储位置的，不是有序的","user_name":"作者回复","user_name_real":"ChaoCai2010","uid":1008262,"ctime":1553157002,"ip_address":"","comment_id":77175,"utype":1}],"discussion_count":1,"race_medal":0,"score":2,"product_id":100024001,"comment_content":"\nfunc TestMapVal(t *testing.T)  {\n\tvar m = map[string]int {&quot;one&quot;:1,&quot;two&quot;:2,&quot;three&quot;:3,&quot;four&quot;:4,&quot;five&quot;:5}\n\tfor k,v:=range m {\n\t\tt.Log(k,v)\n\t}\n}\n运行后输出值为：\n       Map_test.go:25: four 4\n        Map_test.go:25: five 5\n        Map_test.go:25: one 1\n        Map_test.go:25: two 2\n\n想问下为什么是这种输出顺序\n","like_count":2,"discussions":[{"author":{"id":1008262,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/62/86/632ad029.jpg","nickname":"蔡超","note":"","ucode":"4C281BBF511238","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":443621,"discussion_content":"map底成是通过hash来指定存储位置的，不是有序的","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1553157002,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":238569,"user_name":"郭星","can_delete":false,"product_type":"c3","uid":1182219,"ip_address":"","ucode":"8A0F5DF80E0C61","user_header":"https://static001.geekbang.org/account/avatar/00/12/0a/0b/985d3800.jpg","comment_is_top":false,"comment_ctime":1596200414,"is_pvip":false,"replies":[{"id":88419,"content":"是的，Go语言中就是返回该类型的默认值，如果要判断是否存在该元素，要用一以下方式：\nv, isExisting := m1[1]\n","user_name":"作者回复","user_name_real":"ChaoCai2010","uid":1008262,"ctime":1596520990,"ip_address":"","comment_id":238569,"utype":1}],"discussion_count":1,"race_medal":0,"score":2,"product_id":100024001,"comment_content":"func TestDeclareInit(t *testing.T) {\n\t&#47;&#47; 只声明\n\tvar m1 map[int]int &#47;&#47; 初始化值为nil,但支持访问\n\tt.Log(m1)\n\tt.Log(m1[1]) &#47;&#47; 输出了0\n}\nm1为nil 为什么 m1[1] 不会报错呢?","like_count":1,"discussions":[{"author":{"id":1008262,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/62/86/632ad029.jpg","nickname":"蔡超","note":"","ucode":"4C281BBF511238","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":502790,"discussion_content":"是的，Go语言中就是返回该类型的默认值，如果要判断是否存在该元素，要用一以下方式：\nv, isExisting := m1[1]\n","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1596520990,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":361759,"user_name":"　　　　","can_delete":false,"product_type":"c3","uid":1447015,"ip_address":"北京","ucode":"33CF910F811D96","user_header":"https://static001.geekbang.org/account/avatar/00/16/14/67/2b5c88b5.jpg","comment_is_top":false,"comment_ctime":1667830450,"is_pvip":false,"replies":[{"id":131831,"content":"哈哈，java上脑","user_name":"作者回复","user_name_real":"编辑","uid":1008262,"ctime":1668568341,"ip_address":"北京","comment_id":361759,"utype":1}],"discussion_count":2,"race_medal":0,"score":2,"product_id":100024001,"comment_content":"老是情不自禁 想加个 ;","like_count":0,"discussions":[{"author":{"id":1008262,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/62/86/632ad029.jpg","nickname":"蔡超","note":"","ucode":"4C281BBF511238","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":593823,"discussion_content":"哈哈，java上脑","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1668568341,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"北京","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":3184152,"avatar":"https://static001.geekbang.org/account/avatar/00/30/96/18/67592af2.jpg","nickname":"安然。","note":"","ucode":"3781C87F9ACF59","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":595879,"discussion_content":"我总想加一个$符。。。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1670422972,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":"北京","group_id":0},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":250698,"user_name":"Geek_427d0c","can_delete":false,"product_type":"c3","uid":1876823,"ip_address":"","ucode":"D7A04138C4B8CB","user_header":"https://thirdwx.qlogo.cn/mmopen/vi_32/X4ib36ADEvj76XaKD4OUY9k15KqWCAVCwibPicBxz6BBUfDrVolpYInn8zFOw3JBPtVw3L4Lkibaf2eLPemwGKzAXA/132","comment_is_top":false,"comment_ctime":1601198615,"is_pvip":false,"replies":[{"id":91844,"content":"一般这么写\nif a, ok := MyMap[&quot;111&quot;]; !ok{\n\t&#47;&#47; The key doesn&#39;t exist.\n}","user_name":"作者回复","user_name_real":"ChaoCai2010","uid":1008262,"ctime":1601386720,"ip_address":"","comment_id":250698,"utype":1}],"discussion_count":2,"race_medal":0,"score":2,"product_id":100024001,"comment_content":"go的检查map key是否存在相当繁琐啊，比如在java里，可以一行实现：\nmap.get(&quot;a&quot;) != null? map.get(&quot;a&quot;): somethingElse;\n在go得用多行实现？","like_count":0,"discussions":[{"author":{"id":1008262,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/62/86/632ad029.jpg","nickname":"蔡超","note":"","ucode":"4C281BBF511238","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":506263,"discussion_content":"一般这么写\nif a, ok := MyMap[&amp;quot;111&amp;quot;]; !ok{\n\t// The key doesn&amp;#39;t exist.\n}","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1601386720,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1131208,"avatar":"https://static001.geekbang.org/account/avatar/00/11/42/c8/7284c2d7.jpg","nickname":"追忆失去的心","note":"","ucode":"EE772F43A3D54A","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":343965,"discussion_content":"Go不支持三目运算符，要实现三目运算符对于Go的作者来时是很轻松的，但是为了不让代码看起来变得复杂以及语言的简洁性，所以没有加入三目运算符。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1611219353,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":73709,"user_name":"阿鹏","can_delete":false,"product_type":"c3","uid":1207915,"ip_address":"","ucode":"88C847A20EEA9A","user_header":"https://static001.geekbang.org/account/avatar/00/12/6e/6b/9c3f3abb.jpg","comment_is_top":false,"comment_ctime":1551962170,"is_pvip":false,"replies":null,"discussion_count":3,"race_medal":0,"score":2,"product_id":100024001,"comment_content":"因为值是int类型，所以默认是0，如果换成string类型，默认就是空字符串了","like_count":17,"discussions":[{"author":{"id":2055809,"avatar":"https://static001.geekbang.org/account/avatar/00/1f/5e/81/82709d6e.jpg","nickname":"码小呆","note":"","ucode":"44532D6ABF9340","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":581186,"discussion_content":"是的","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1658580823,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1930382,"avatar":"https://static001.geekbang.org/account/avatar/00/1d/74/8e/caa7afec.jpg","nickname":"山水如初","note":"","ucode":"D4BE5C836DE53D","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":380799,"discussion_content":"Python 里面的 collections.defaultdict 也是如此。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1624704315,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1105161,"avatar":"https://static001.geekbang.org/account/avatar/00/10/dd/09/feca820a.jpg","nickname":"helloworld","note":"","ucode":"1EECCA0F43E278","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":46652,"discussion_content":"学习了","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1573189482,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":142118,"user_name":"碧雪天虹","can_delete":false,"product_type":"c3","uid":1258359,"ip_address":"","ucode":"313CC048C7E341","user_header":"https://static001.geekbang.org/account/avatar/00/13/33/77/0c593044.jpg","comment_is_top":false,"comment_ctime":1571296927,"is_pvip":false,"replies":null,"discussion_count":0,"race_medal":0,"score":2,"product_id":100024001,"comment_content":"看到一些同学说排序, 我也尝试了一下, 步骤上就是把key都存储到slice里面, 然后给key排序, 在遍历key并打印值.\n\nfunc TestSortByKey(t *testing.T) {\n\tm1 := map[string]int{&quot;aa&quot;: 1, &quot;zz&quot;: 2, &quot;bb&quot;: 3, &quot;yy&quot;: 4, &quot;cc&quot;: 5, &quot;xx&quot;: 6}\n\ts1 := make([]string, 0, len(m1))\n\tfor k, _ := range m1 {\n\t\ts1 = append(s1, k)\n\t}\n\tsort.Strings(s1)\n\tfor _, k := range s1 {\n\t\tt.Log(k, m1[k])\n\t}\n}","like_count":2},{"had_liked":false,"id":197555,"user_name":"向南","can_delete":false,"product_type":"c3","uid":1325700,"ip_address":"","ucode":"E6072AD7CA6798","user_header":"https://static001.geekbang.org/account/avatar/00/14/3a/84/70340e87.jpg","comment_is_top":false,"comment_ctime":1585385060,"is_pvip":false,"replies":null,"discussion_count":0,"race_medal":0,"score":3,"product_id":100024001,"comment_content":"Go小白尝试map按key排序和按value排序：\n按key排序：\n```golang\nfunc TestMapSortedByKey(t *testing.T) {\n\ttestMap := map[string]int{&quot;a&quot;: 15, &quot;q&quot;: 29, &quot;e&quot;: 73, &quot;h&quot;: 34, &quot;j&quot;: 55, &quot;l&quot;: 86}\n\tt.Log(&quot;unsorted:&quot;)\n\tfor key, value := range testMap {\n\t\tt.Log(key, value)\n\t}\n\tt.Log(&quot;sorted:&quot;)\n\tkeySlice := make([]string, 0, len(testMap))\n\tfor key := range testMap {\n\t\tkeySlice = append(keySlice, key)\n\t}\n\tsort.Strings(keySlice)\n\tfor _, key := range keySlice {\n\t\tt.Log(key, testMap[key])\n\t}\n}\n```\n按value排序：\n```golang\nfunc TestMapSortedByValue(t *testing.T) {\n\ttestMap := map[string]int{&quot;a&quot;: 15, &quot;q&quot;: 29, &quot;e&quot;: 73, &quot;h&quot;: 34, &quot;j&quot;: 55, &quot;l&quot;: 86}\n\tt.Log(&quot;unsorted:&quot;)\n\tfor key, value := range testMap {\n\t\tt.Log(key, value)\n\t}\n\tt.Log(&quot;sorted:&quot;)\n\tvalueSlice := make([]int, 0, len(testMap))\n\tfor _, val := range testMap {\n\t\tvalueSlice = append(valueSlice, val)\n\t}\n\tsort.Ints(valueSlice)\n\tfor index, _ := range valueSlice {\n\t\tfor j := range testMap {\n\t\t\tif testMap[j] == valueSlice[index] {\n\t\t\t\tt.Log(j, valueSlice[index])\n\t\t\t}\n\t\t}\n\t}\n}\n```","like_count":1},{"had_liked":false,"id":83761,"user_name":"butterfly","can_delete":false,"product_type":"c3","uid":1392924,"ip_address":"","ucode":"1B724973303FB0","user_header":"http://thirdwx.qlogo.cn/mmopen/vi_32/rRCSdTPyqWcW6U8DO9xL55ictNPlbQ38VAcaBNgibqaAhcH7mn1W9ddxIJLlMiaA5sngBicMX02w2HP5pAWpBAJsag/132","comment_is_top":false,"comment_ctime":1554711531,"is_pvip":false,"replies":null,"discussion_count":2,"race_medal":0,"score":3,"product_id":100024001,"comment_content":"map中的key，如何使用对象作为key.\n现在项目中都是使用一个string作为key，但有时一个string是不够的,有时需要某个对象中的两个属性来决定map中的key是否相等.像c++中map是需要一个hash函数和equal函数来判断的. \nGolang中如何处理呢？ \n比如有一个对象 Person定义如下， 有这样一个map[Person]string,同时使用 person中的name和age决定一个对象是否重复，进行hash等.\ntype Person struct {\n name string\n age  int\nsex  string\n}","like_count":1,"discussions":[{"author":{"id":2300180,"avatar":"https://static001.geekbang.org/account/avatar/00/23/19/14/4fe2f992.jpg","nickname":"吴笛","note":"","ucode":"5C1262FCC3814B","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":358945,"discussion_content":"我也是初学,提供两个思路, 1是把用于判断重复的字段提取出来做一个结构体,比如叫BaseInfo,里面只村name和age,然后以这个BaseInfo结构体为key, 这个方法的坏处是结构体的对比比较慢. 方法2是把person的name和age提出来做一下哈希,把哈希值作为key,这样就是字符串比较,会快速一些.","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1616077728,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"","child_discussion_number":1,"child_discussions":[{"author":{"id":1392924,"avatar":"http://thirdwx.qlogo.cn/mmopen/vi_32/rRCSdTPyqWcW6U8DO9xL55ictNPlbQ38VAcaBNgibqaAhcH7mn1W9ddxIJLlMiaA5sngBicMX02w2HP5pAWpBAJsag/132","nickname":"butterfly","note":"","ucode":"1B724973303FB0","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":2300180,"avatar":"https://static001.geekbang.org/account/avatar/00/23/19/14/4fe2f992.jpg","nickname":"吴笛","note":"","ucode":"5C1262FCC3814B","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":359865,"discussion_content":"Suan算hash的话会有冲突，第一个靠谱","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1616308844,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":358945,"ip_address":"","group_id":0},"score":359865,"extra":""}]}]},{"had_liked":false,"id":83688,"user_name":"打豆豆","can_delete":false,"product_type":"c3","uid":1123148,"ip_address":"","ucode":"0D58AFDE330E72","user_header":"https://static001.geekbang.org/account/avatar/00/11/23/4c/cbea10cf.jpg","comment_is_top":false,"comment_ctime":1554700647,"is_pvip":false,"replies":null,"discussion_count":0,"race_medal":0,"score":3,"product_id":100024001,"comment_content":"老师，如果我的map想有序输出的话，该怎么办呢\nm2:= map[int]int{1:1,2:2,3:3,4:4}\n\tfor k,v:=range m2{\n\t\tt.Log(k,v)\n\t}\n\n\tfor i:=0;i&lt;len(m2);i++{\n\t\tt.Log(&quot;--&quot;,m2[?])\n\t}\n\n定义了上面的代码，再用for ++循环的时候，没法用index","like_count":1},{"had_liked":false,"id":368837,"user_name":"划船一哥","can_delete":false,"product_type":"c3","uid":1811010,"ip_address":"北京","ucode":"61539E491E86F5","user_header":"https://static001.geekbang.org/account/avatar/00/1b/a2/42/4948f2b9.jpg","comment_is_top":false,"comment_ctime":1676794178,"is_pvip":false,"replies":null,"discussion_count":0,"race_medal":0,"score":3,"product_id":100024001,"comment_content":"map的key不存在，初始化成calue对应的默认值","like_count":0},{"had_liked":false,"id":365421,"user_name":"赵*建","can_delete":false,"product_type":"c3","uid":3246919,"ip_address":"山东","ucode":"2C1F8F844572F6","user_header":"https://static001.geekbang.org/account/avatar/00/31/8b/47/8c17a869.jpg","comment_is_top":false,"comment_ctime":1672491131,"is_pvip":false,"replies":null,"discussion_count":0,"race_medal":0,"score":3,"product_id":100024001,"comment_content":"老师，2023年了，什么时候出新课程?","like_count":0},{"had_liked":false,"id":331992,"user_name":"Fulei","can_delete":false,"product_type":"c3","uid":1114302,"ip_address":"","ucode":"F6A59A5236A131","user_header":"https://static001.geekbang.org/account/avatar/00/11/00/be/1dd039dc.jpg","comment_is_top":false,"comment_ctime":1642949158,"is_pvip":false,"replies":null,"discussion_count":2,"race_medal":0,"score":3,"product_id":100024001,"comment_content":"func TestTravelMap(t *testing.T) {\n\tm1 := map[int]int{1: 1, 2: 4, 3: 9}\n\tfor k, v := range m1 {\n\t\tt.Log(k, v)\n\t}\n}\n输出：\n=== RUN   TestTravelMap\n    &#47;Users&#47;cow&#47;go_learning&#47;src&#47;ch7&#47;map&#47;map_test.go:36: 3 9\n    &#47;Users&#47;cow&#47;go_learning&#47;src&#47;ch7&#47;map&#47;map_test.go:36: 1 1\n    &#47;Users&#47;cow&#47;go_learning&#47;src&#47;ch7&#47;map&#47;map_test.go:36: 2 4\n这是为什么，哪出问题了？","like_count":0,"discussions":[{"author":{"id":3184152,"avatar":"https://static001.geekbang.org/account/avatar/00/30/96/18/67592af2.jpg","nickname":"安然。","note":"","ucode":"3781C87F9ACF59","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":595881,"discussion_content":"作者回复: map的底成采用hash表机制，不是有序的","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1670423032,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":"北京","group_id":0},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":3184152,"avatar":"https://static001.geekbang.org/account/avatar/00/30/96/18/67592af2.jpg","nickname":"安然。","note":"","ucode":"3781C87F9ACF59","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":595880,"discussion_content":"上面的评论已经给出答案了。并不是有序输出。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1670423015,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":"北京","group_id":0},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":285335,"user_name":"escray","can_delete":false,"product_type":"c3","uid":1020525,"ip_address":"","ucode":"1F4204930E47C4","user_header":"https://static001.geekbang.org/account/avatar/00/0f/92/6d/becd841a.jpg","comment_is_top":false,"comment_ctime":1616745488,"is_pvip":true,"replies":null,"discussion_count":0,"race_medal":0,"score":3,"product_id":100024001,"comment_content":"在访问的 Key 不存在时，返回的是 Map 中 Value 类型的默认值，如果是 int ，就是 0；如果是 String ，就是空字符串 &quot;&quot;。\n\n看多了 make 函数，感觉像是在看 C 语言的 malloc\n\nMap 底层使用 Hash 表来存储，无序。\n\n参考 @碧雪天虹  的代码，实现了一下按 key 排序，其实按照 value 排序也没有问题。\n\n看到了其他留言里面对 value 排序的代码，感觉略显繁琐，应该有更好的办法。不知道 go 语言的 map 类型有没有类似于 findByValue 类的操作。","like_count":0},{"had_liked":false,"id":243391,"user_name":"张仁杰","can_delete":false,"product_type":"c3","uid":1128426,"ip_address":"","ucode":"656F88A636A2D4","user_header":"https://static001.geekbang.org/account/avatar/00/11/37/ea/9c1a4aeb.jpg","comment_is_top":false,"comment_ctime":1598084044,"is_pvip":false,"replies":null,"discussion_count":0,"race_medal":0,"score":3,"product_id":100024001,"comment_content":"老师你好，什么时候会出现数据复制呢？超出设定容量，自动扩容的时候产生吗？","like_count":0},{"had_liked":false,"id":232741,"user_name":"郭星","can_delete":false,"product_type":"c3","uid":1182219,"ip_address":"","ucode":"8A0F5DF80E0C61","user_header":"https://static001.geekbang.org/account/avatar/00/12/0a/0b/985d3800.jpg","comment_is_top":false,"comment_ctime":1594105974,"is_pvip":false,"replies":null,"discussion_count":0,"race_medal":0,"score":3,"product_id":100024001,"comment_content":"对于不存在的key进行map查询实际是返回的map声明的value类型的默认值","like_count":0},{"had_liked":false,"id":220572,"user_name":"YanZu","can_delete":false,"product_type":"c3","uid":1223076,"ip_address":"","ucode":"B3954130EF8AD3","user_header":"https://static001.geekbang.org/account/avatar/00/12/a9/a4/9e0834a8.jpg","comment_is_top":false,"comment_ctime":1590289268,"is_pvip":false,"replies":null,"discussion_count":0,"race_medal":0,"score":3,"product_id":100024001,"comment_content":"Go小白尝试map按key排序和按value排序：\n按key排序：\n```golang\nfunc TestMapSortedByKey(t *testing.T) {\n    testMap := map[string]int{&quot;a&quot;: 15, &quot;q&quot;: 29, &quot;e&quot;: 73, &quot;h&quot;: 34, &quot;j&quot;: 55, &quot;l&quot;: 86}\n    t.Log(&quot;unsorted:&quot;)\n    for key, value := range testMap {\n        t.Log(key, value)\n    }\n    t.Log(&quot;sorted:&quot;)\n    keySlice := make([]string, 0, len(testMap))\n    for key := range testMap {\n        keySlice = append(keySlice, key)\n    }\n    sort.Strings(keySlice)\n    for _, key := range keySlice {\n        t.Log(key, testMap[key])\n    }\n}\n```\n按value排序：\n```golang\nfunc TestMapSortedByValue(t *testing.T) {\n    testMap := map[string]int{&quot;a&quot;: 15, &quot;q&quot;: 29, &quot;e&quot;: 73, &quot;h&quot;: 34, &quot;j&quot;: 55, &quot;l&quot;: 86}\n    t.Log(&quot;unsorted:&quot;)\n    for key, value := range testMap {\n        t.Log(key, value)\n    }\n    t.Log(&quot;sorted:&quot;)\n    valueSlice := make([]int, 0, len(testMap))\n    for _, val := range testMap {\n        valueSlice = append(valueSlice, val)\n    }\n    sort.Ints(valueSlice)\n    for index, _ := range valueSlice {\n        for j := range testMap {\n            if testMap[j] == valueSlice[index] {\n                t.Log(j, valueSlice[index])\n            }\n        }\n    }\n}\n```","like_count":0},{"had_liked":false,"id":159833,"user_name":"卡卡","can_delete":false,"product_type":"c3","uid":1123771,"ip_address":"","ucode":"1114D32368CBC1","user_header":"https://static001.geekbang.org/account/avatar/00/11/25/bb/030145ca.jpg","comment_is_top":false,"comment_ctime":1575806041,"is_pvip":false,"replies":null,"discussion_count":0,"race_medal":0,"score":4,"product_id":100024001,"comment_content":"老师，你好，为什么我的IDE运行go run或者go test的时候得3秒多的时间才能出结果，感觉应该秒出的，很简单的测试程序","like_count":0},{"had_liked":false,"id":142112,"user_name":"碧雪天虹","can_delete":false,"product_type":"c3","uid":1258359,"ip_address":"","ucode":"313CC048C7E341","user_header":"https://static001.geekbang.org/account/avatar/00/13/33/77/0c593044.jpg","comment_is_top":false,"comment_ctime":1571296079,"is_pvip":false,"replies":null,"discussion_count":0,"race_medal":0,"score":4,"product_id":100024001,"comment_content":"课程中没有说怎么删除key, 网络找资料试验了一下, 通过delete方法可以删除map中的元素\n\nfunc TestAccessNotExistingKey(t *testing.T) {\n\tm1 := map[int]int{}\n\tt.Log(m1[1])\n\tm1[2] = 0\n\tt.Log(m1[2])\n\tprintKey3Exists(&amp;m1, t)\n\tm1[3] = 0\n\tprintKey3Exists(&amp;m1, t)\n\tdelete(m1, 3)\n\tprintKey3Exists(&amp;m1, t)\n}\n\nfunc printKey3Exists(m *map[int]int, t *testing.T) {\n\tif v, ok := (*m)[3]; ok {\n\t\tt.Logf(&quot;key 3&#39;s value is %d&quot;, v)\n\t} else {\n\t\tt.Log(&quot;key 3 is not existing.&quot;)\n\t}\n}","like_count":0},{"had_liked":false,"id":77097,"user_name":"Steven Fung","can_delete":false,"product_type":"c3","uid":1052952,"ip_address":"","ucode":"193D1031AA362B","user_header":"https://static001.geekbang.org/account/avatar/00/10/11/18/bba8efd2.jpg","comment_is_top":false,"comment_ctime":1552832668,"is_pvip":false,"replies":null,"discussion_count":0,"race_medal":0,"score":4,"product_id":100024001,"comment_content":"nil slice和nil map是在哪里用的，只查到nil slice时在返回值是slice的时候用到，其他地方会用到吗？map呢？","like_count":0},{"had_liked":false,"id":77094,"user_name":"Steven Fung","can_delete":false,"product_type":"c3","uid":1052952,"ip_address":"","ucode":"193D1031AA362B","user_header":"https://static001.geekbang.org/account/avatar/00/10/11/18/bba8efd2.jpg","comment_is_top":false,"comment_ctime":1552832005,"is_pvip":false,"replies":null,"discussion_count":0,"race_medal":0,"score":4,"product_id":100024001,"comment_content":"“capacity是设置初始化容量，map会自动扩容，但扩容会导致内存分配和数据复制”，总觉得map也是有容量大小的，但是为什么cap函数不能获取map的容量？","like_count":0}]}