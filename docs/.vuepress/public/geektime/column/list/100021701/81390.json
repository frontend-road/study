{"id":81390,"title":"26丨K-Means（上）：如何给20支亚洲球队做聚类？","content":"<p>今天我来带你进行K-Means的学习。K-Means是一种非监督学习，解决的是聚类问题。K代表的是K类，Means代表的是中心，你可以理解这个算法的本质是确定K类的中心点，当你找到了这些中心点，也就完成了聚类。</p><p>那么请你和我思考以下三个问题：</p><ul>\n<li>\n<p>如何确定K类的中心点？</p>\n</li>\n<li>\n<p>如何将其他点划分到K类中？</p>\n</li>\n<li>\n<p>如何区分K-Means与KNN？</p>\n</li>\n</ul><p>如果理解了上面这3个问题，那么对K-Means的原理掌握得也就差不多了。</p><p>先请你和我思考一个场景，假设我有20支亚洲足球队，想要将它们按照成绩划分成3个等级，可以怎样划分？</p><h2>K-Means的工作原理</h2><p>对亚洲足球队的水平，你可能也有自己的判断。比如一流的亚洲球队有谁？你可能会说伊朗或韩国。二流的亚洲球队呢？你可能说是中国。三流的亚洲球队呢？你可能会说越南。</p><p>其实这些都是靠我们的经验来划分的，那么伊朗、中国、越南可以说是三个等级的典型代表，也就是我们每个类的中心点。</p><p>所以回过头来，如何确定K类的中心点？一开始我们是可以随机指派的，当你确认了中心点后，就可以按照距离将其他足球队划分到不同的类别中。</p><p>这也就是K-Means的中心思想，就是这么简单直接。你可能会问：如果一开始，选择一流球队是中国，二流球队是伊朗，三流球队是韩国，中心点选择错了怎么办？其实不用担心，K-Means有自我纠正机制，在不断的迭代过程中，会纠正中心点。中心点在整个迭代过程中，并不是唯一的，只是你需要一个初始值，一般算法会随机设置初始的中心点。</p><!-- [[[read_end]]] --><p>好了，那我来把K-Means的工作原理给你总结下：</p><ol>\n<li>\n<p>选取K个点作为初始的类中心点，这些点一般都是从数据集中随机抽取的；</p>\n</li>\n<li>\n<p>将每个点分配到最近的类中心点，这样就形成了K个类，然后重新计算每个类的中心点；</p>\n</li>\n<li>\n<p>重复第二步，直到类不发生变化，或者你也可以设置最大迭代次数，这样即使类中心点发生变化，但是只要达到最大迭代次数就会结束。</p>\n</li>\n</ol><h2>如何给亚洲球队做聚类</h2><p>对于机器来说需要数据才能判断类中心点，所以我整理了2015-2019年亚洲球队的排名，如下表所示。</p><p>我来说明一下数据概况。</p><p>其中2019年国际足联的世界排名，2015年亚洲杯排名均为实际排名。2018年世界杯中，很多球队没有进入到决赛圈，所以只有进入到决赛圈的球队才有实际的排名。如果是亚洲区预选赛12强的球队，排名会设置为40。如果没有进入亚洲区预选赛12强，球队排名会设置为50。</p><p><img src=\"https://static001.geekbang.org/resource/image/d8/4a/d8ac2a98aa728d64f919bac088ed574a.png?wh=784*794\" alt=\"\"><br>\n针对上面的排名，我们首先需要做的是数据规范化。你可以把这些值划分到[0,1]或者按照均值为0，方差为1的正态分布进行规范化。具体数据规范化的步骤可以看下13篇，也就是<a href=\"https://time.geekbang.org/column/article/77059\">数据变换</a>那一篇。</p><p>我先把数值都规范化到[0,1]的空间中，得到了以下的数值表：</p><p><img src=\"https://static001.geekbang.org/resource/image/a7/17/a722eeab035fb13751a6dc5c0530ed17.png?wh=726*789\" alt=\"\"><br>\n如果我们随机选取中国、日本、韩国为三个类的中心点，我们就需要看下这些球队到中心点的距离。</p><p>距离有多种计算的方式，有关距离的计算我在KNN算法中也讲到过：</p><ul>\n<li>\n<p>欧氏距离</p>\n</li>\n<li>\n<p>曼哈顿距离</p>\n</li>\n<li>\n<p>切比雪夫距离</p>\n</li>\n<li>\n<p>余弦距离</p>\n</li>\n</ul><p>欧氏距离是最常用的距离计算方式，这里我选择欧氏距离作为距离的标准，计算每个队伍分别到中国、日本、韩国的距离，然后根据距离远近来划分。我们看到大部分的队，会和中国队聚类到一起。这里我整理了距离的计算过程，比如中国和中国的欧氏距离为0，中国和日本的欧式距离为0.732003。如果按照中国、日本、韩国为3个分类的中心点，欧氏距离的计算结果如下表所示：</p><p><img src=\"https://static001.geekbang.org/resource/image/b6/e9/b603ccdb93420c8455aea7278efaece9.png?wh=616*828\" alt=\"\"><br>\n然后我们再重新计算这三个类的中心点，如何计算呢？最简单的方式就是取平均值，然后根据新的中心点按照距离远近重新分配球队的分类，再根据球队的分类更新中心点的位置。计算过程这里不展开，最后一直迭代（重复上述的计算过程：计算中心点和划分分类）到分类不再发生变化，可以得到以下的分类结果：</p><p><img src=\"https://static001.geekbang.org/resource/image/12/98/12c6039884ee99742fbbebf198425998.png?wh=865*919\" alt=\"\"><br>\n所以我们能看出来第一梯队有日本、韩国、伊朗、沙特、澳洲；第二梯队有中国、伊拉克、阿联酋、乌兹别克斯坦；第三梯队有卡塔尔、泰国、越南、阿曼、巴林、朝鲜、印尼、叙利亚、约旦、科威特和巴勒斯坦。</p><h2>如何使用sklearn中的K-Means算法</h2><p>sklearn是Python的机器学习工具库，如果从功能上来划分，sklearn可以实现分类、聚类、回归、降维、模型选择和预处理等功能。这里我们使用的是sklearn的聚类函数库，因此需要引用工具包，具体代码如下：</p><pre><code>from sklearn.cluster import KMeans\n</code></pre><p>当然K-Means只是sklearn.cluster中的一个聚类库，实际上包括K-Means在内，sklearn.cluster一共提供了9种聚类方法，比如Mean-shift，DBSCAN，Spectral clustering（谱聚类）等。这些聚类方法的原理和K-Means不同，这里不做介绍。</p><p>我们看下K-Means如何创建：</p><pre><code>KMeans(n_clusters=8, init='k-means++', n_init=10, max_iter=300, tol=0.0001, precompute_distances='auto', verbose=0, random_state=None, copy_x=True, n_jobs=1, algorithm='auto')\n</code></pre><p>我们能看到在K-Means类创建的过程中，有一些主要的参数：</p><ul>\n<li>\n<p><strong>n_clusters</strong>: 即K值，一般需要多试一些K值来保证更好的聚类效果。你可以随机设置一些K值，然后选择聚类效果最好的作为最终的K值；</p>\n</li>\n<li>\n<p><strong>max_iter</strong>： 最大迭代次数，如果聚类很难收敛的话，设置最大迭代次数可以让我们及时得到反馈结果，否则程序运行时间会非常长；</p>\n</li>\n<li>\n<p><strong>n_init</strong>：初始化中心点的运算次数，默认是10。程序是否能快速收敛和中心点的选择关系非常大，所以在中心点选择上多花一些时间，来争取整体时间上的快速收敛还是非常值得的。由于每一次中心点都是随机生成的，这样得到的结果就有好有坏，非常不确定，所以要运行n_init次, 取其中最好的作为初始的中心点。如果K值比较大的时候，你可以适当增大n_init这个值；</p>\n</li>\n<li>\n<p><strong>init：</strong> 即初始值选择的方式，默认是采用优化过的k-means++方式，你也可以自己指定中心点，或者采用random完全随机的方式。自己设置中心点一般是对于个性化的数据进行设置，很少采用。random的方式则是完全随机的方式，一般推荐采用优化过的k-means++方式；</p>\n</li>\n<li>\n<p><strong>algorithm</strong>：k-means的实现算法，有“auto” “full”“elkan”三种。一般来说建议直接用默认的\"auto\"。简单说下这三个取值的区别，如果你选择\"full\"采用的是传统的K-Means算法，“auto”会根据数据的特点自动选择是选择“full”还是“elkan”。我们一般选择默认的取值，即“auto” 。</p>\n</li>\n</ul><p>在创建好K-Means类之后，就可以使用它的方法，最常用的是fit和predict这个两个函数。你可以单独使用fit函数和predict函数，也可以合并使用fit_predict函数。其中fit(data)可以对data数据进行k-Means聚类。 predict(data)可以针对data中的每个样本，计算最近的类。</p><p>现在我们要完整地跑一遍20支亚洲球队的聚类问题。我把数据上传到了<a href=\"https://github.com/cystanford/kmeans\">GitHub</a>上，你可以自行下载。</p><pre><code># coding: utf-8\nfrom sklearn.cluster import KMeans\nfrom sklearn import preprocessing\nimport pandas as pd\nimport numpy as np\n# 输入数据\ndata = pd.read_csv('data.csv', encoding='gbk')\ntrain_x = data[[&quot;2019年国际排名&quot;,&quot;2018世界杯&quot;,&quot;2015亚洲杯&quot;]]\ndf = pd.DataFrame(train_x)\nkmeans = KMeans(n_clusters=3)\n# 规范化到[0,1]空间\nmin_max_scaler=preprocessing.MinMaxScaler()\ntrain_x=min_max_scaler.fit_transform(train_x)\n# kmeans算法\nkmeans.fit(train_x)\npredict_y = kmeans.predict(train_x)\n# 合并聚类结果，插入到原数据中\nresult = pd.concat((data,pd.DataFrame(predict_y)),axis=1)\nresult.rename({0:u'聚类'},axis=1,inplace=True)\nprint(result)\n</code></pre><p>运行结果：</p><pre><code>国家  2019年国际排名  2018世界杯  2015亚洲杯  聚类\n0       中国         73       40        7   2\n1       日本         60       15        5   0\n2       韩国         61       19        2   0\n3       伊朗         34       18        6   0\n4       沙特         67       26       10   0\n5      伊拉克         91       40        4   2\n6      卡塔尔        101       40       13   1\n7      阿联酋         81       40        6   2\n8   乌兹别克斯坦         88       40        8   2\n9       泰国        122       40       17   1\n10      越南        102       50       17   1\n11      阿曼         87       50       12   1\n12      巴林        116       50       11   1\n13      朝鲜        110       50       14   1\n14      印尼        164       50       17   1\n15      澳洲         40       30        1   0\n16     叙利亚         76       40       17   1\n17      约旦        118       50        9   1\n18     科威特        160       50       15   1\n19    巴勒斯坦         96       50       16   1\n</code></pre><h2>总结</h2><p>今天我给你讲了K-Means算法原理，我们再来看下开篇我给你提的三个问题。</p><p>如何确定K类的中心点？其中包括了初始的设置，以及中间迭代过程中中心点的计算。在初始设置中，会进行n_init次的选择，然后选择初始中心点效果最好的为初始值。在每次分类更新后，你都需要重新确认每一类的中心点，一般采用均值的方式进行确认。</p><p>如何将其他点划分到K类中？这里实际上是关于距离的定义，我们知道距离有多种定义的方式，在K-Means和KNN中，我们都可以采用欧氏距离、曼哈顿距离、切比雪夫距离、余弦距离等。对于点的划分，就看它离哪个类的中心点的距离最近，就属于哪一类。</p><p>如何区分K-Means和KNN这两种算法呢？刚学过K-Means和KNN算法的同学应该能知道两者的区别，但往往过了一段时间，就容易混淆。所以我们可以从三个维度来区分K-Means和KNN这两个算法：</p><ul>\n<li>\n<p>首先，这两个算法解决数据挖掘的两类问题。K-Means是聚类算法，KNN是分类算法。</p>\n</li>\n<li>\n<p>这两个算法分别是两种不同的学习方式。K-Means是非监督学习，也就是不需要事先给出分类标签，而KNN是有监督学习，需要我们给出训练数据的分类标识。</p>\n</li>\n<li>\n<p>最后，K值的含义不同。K-Means中的K值代表K类。KNN中的K值代表K个最接近的邻居。</p>\n</li>\n</ul><p><img src=\"https://static001.geekbang.org/resource/image/eb/c5/eb60546c6a3d9bc6a1538049c26723c5.png?wh=864*588\" alt=\"\"><br>\n那么学完了今天的内容后，你能说一下K-Means的算法原理吗？如果我们把上面的20支亚洲球队用K-Means划分成5类，在规范化数据的时候采用标准化的方式（即均值为0，方差为1），该如何编写程序呢？运行的结果又是如何？</p><p>欢迎你在评论区与我分享你的答案，也欢迎点击“请朋友读”，把这篇文章分享给你的朋友或者同事。</p><p></p>","neighbors":{"left":{"article_title":"25丨KNN（下）：如何对手写数字进行识别？","id":81018},"right":{"article_title":"27丨K-Means（下）：如何使用K-Means对图像进行分割？","id":81591}},"comments":[{"had_liked":false,"id":68598,"user_name":"third","can_delete":false,"product_type":"c1","uid":1025114,"ip_address":"","ucode":"9A37408A834F0B","user_header":"https://static001.geekbang.org/account/avatar/00/0f/a4/5a/e708e423.jpg","comment_is_top":true,"comment_ctime":1550553738,"is_pvip":false,"replies":[{"id":"24810","content":"举例很生动，代码也正确。大家可以看下。","user_name":"编辑回复","comment_id":68598,"uid":"1165037","ip_address":"","utype":2,"ctime":1550821880,"user_name_real":"何昌梅"}],"discussion_count":2,"race_medal":0,"score":"9.2233721758443008e+18","product_id":100021701,"comment_content":"两者的区别的比喻是，<br>Kmeans开班，选老大，风水轮流转，直到选出最佳中心老大<br>Knn小弟加队伍，离那个班相对近，就是那个班的<br><br>一群人的有些人想要聚在一起<br>首先大家民主（无监督学习）随机选K个老大（随机选择K个中心点）<br>谁跟谁近，就是那个队伍的人（计算距离，距离近的聚合到一块）<br>随着时间的推移，老大的位置在变化（根据算法，重新计算中心点）<br>直到选出真正的中心老大（重复，直到准确率最高）<br><br>Knn<br>一个人想要找到自己的队伍<br>首先听从神的旨意（有监督学习），随机最近的几个邻居<br>看看距离远不远（根据算法，计算距离）<br>近的就是一个班的了（属于哪个分类多，就是哪一类）<br><br>#输入数据<br>#数据探索<br>import pandas as pd<br>data=pd.read_csv(&quot;.&#47;26&#47;data.csv&quot;,encoding=&#39;gbk&#39;)<br># print(data)数据符合完整合一，数据质量较高<br><br>#提取数据<br>train_x=data[[&quot;2019年国际排名&quot;,&quot;2018世界杯&quot;,&quot;2015亚洲杯&quot;]]<br><br>#数据规范化<br>from sklearn import preprocessing<br>ss=preprocessing.StandardScaler()<br>train_ss_x=ss.fit_transform(train_x)<br><br>#对数据进行拟合并预测<br>from sklearn.cluster import KMeans<br>kmeans=KMeans(n_clusters=5)<br>kmeans.fit(train_ss_x)<br>pre=kmeans.predict(train_ss_x)<br><br>#数据对比<br>train_x=pd.DataFrame(train_x)<br>result=pd.concat((data,pd.DataFrame(pre)),axis=1)<br><br>result.rename({0:u&#39;聚类&#39;},axis=1,inplace=True)<br>print(result)","like_count":33,"discussions":[{"author":{"id":1165037,"avatar":"https://static001.geekbang.org/account/avatar/00/11/c6/ed/89a2dc13.jpg","nickname":"丢了个丢丢丢","note":"","ucode":"BDD7E97E0E5E96","race_medal":0,"user_type":4,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":439747,"discussion_content":"举例很生动，代码也正确。大家可以看下。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1550821880,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":4}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1298468,"avatar":"http://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTJOc0n02eNKflX5ey4TYl1NBfb0kicc20AgayEAGDYylalqHnLTeqMnaJ2iaZsLVmqEo0T0YViadU9Ig/132","nickname":"lianlian","note":"","ucode":"79B48B38259097","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":396695,"discussion_content":"哈哈哈笑死我了，第一次看到这么生动的举例O(∩_∩)O哈哈~","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1632479140,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":67486,"user_name":"Lee","can_delete":false,"product_type":"c1","uid":1313515,"ip_address":"","ucode":"ED3D7200A948C3","user_header":"https://static001.geekbang.org/account/avatar/00/14/0a/eb/6d6a94d2.jpg","comment_is_top":true,"comment_ctime":1550157201,"is_pvip":false,"replies":[{"id":"24815","content":"正确","user_name":"编辑回复","comment_id":67486,"uid":"1165037","ip_address":"","utype":2,"ctime":1550822121,"user_name_real":"何昌梅"}],"discussion_count":1,"race_medal":0,"score":"9.2233720684697006e+18","product_id":100021701,"comment_content":"# coding: utf-8<br>from sklearn.cluster import KMeans<br>from sklearn import preprocessing<br>import pandas as pd<br>import numpy as np<br># 输入数据<br>data = pd.read_csv(r&#39;F:\\Python\\notebook\\K-Means\\kmeans-master\\data.csv&#39;, encoding = &#39;gbk&#39;)<br>data.head()<br>train_x = data[[&quot;2019年国际排名&quot;,&quot;2018世界杯&quot;,&quot;2015亚洲杯&quot;]]<br>df = pd.DataFrame(train_x)<br>kmeans = KMeans(n_clusters=5)<br># 规范化<br>min_max_scaler=preprocessing.StandardScaler()<br>train_x=min_max_scaler.fit_transform(train_x)<br># kmeans 算法<br>kmeans.fit(train_x)<br>predict_y = kmeans.predict(train_x)<br># 合并聚类结果，插入到原数据中<br>result = pd.concat((data,pd.DataFrame(predict_y)),axis=1)<br>result.rename({0:u&#39;聚类&#39;},axis=1,inplace=True)<br>print(result)<br><br>       国家  2019年国际排名  2018世界杯  2015亚洲杯  聚类<br>0       中国         73       40        7   0<br>1       日本         60       15        5   3<br>2       韩国         61       19        2   3<br>3       伊朗         34       18        6   3<br>4       沙特         67       26       10   0<br>5      伊拉克         91       40        4   0<br>6      卡塔尔        101       40       13   4<br>7      阿联酋         81       40        6   0<br>8   乌兹别克斯坦         88       40        8   0<br>9       泰国        122       40       17   4<br>10      越南        102       50       17   4<br>11      阿曼         87       50       12   2<br>12      巴林        116       50       11   2<br>13      朝鲜        110       50       14   2<br>14      印尼        164       50       17   1<br>15      澳洲         40       30        1   3<br>16     叙利亚         76       40       17   4<br>17      约旦        118       50        9   2<br>18     科威特        160       50       15   1<br>19    巴勒斯坦         96       50       16   4","like_count":7,"discussions":[{"author":{"id":1165037,"avatar":"https://static001.geekbang.org/account/avatar/00/11/c6/ed/89a2dc13.jpg","nickname":"丢了个丢丢丢","note":"","ucode":"BDD7E97E0E5E96","race_medal":0,"user_type":4,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":439217,"discussion_content":"正确","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1550822121,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":4}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":67564,"user_name":"白夜","can_delete":false,"product_type":"c1","uid":1354449,"ip_address":"","ucode":"7AABFA7C04EA34","user_header":"https://static001.geekbang.org/account/avatar/00/14/aa/d1/076482f3.jpg","comment_is_top":false,"comment_ctime":1550197805,"is_pvip":false,"replies":[{"id":"24814","content":"同一个类别下的平均值。比如都属于同一个类别里面有10个点，那么新的中心点就是这10个点的中心点，一种简单的方式就是取平均值。比如我在文章里举了足球队的例子，一共有3个指标，每个球队都有这三个指标的特征值，那么新的中心点，就是取这个类别中的这些点 这三个指标特征值的平均值。。","user_name":"编辑回复","comment_id":67564,"uid":"1165037","ip_address":"","utype":2,"ctime":1550822100,"user_name_real":"何昌梅"}],"discussion_count":3,"race_medal":0,"score":"35909936173","product_id":100021701,"comment_content":"然后我们再重新计算这三个类的中心点，如何计算呢？最简单的方式就是取平均值，然后根据新的中心点按照距离远近重新分配球队的分类，再根据球队的分类更新中心点的位置。计算过程这里不展开，最后一直迭代（重复上述的计算过程：计算中心点和划分分类）到分类不再发生变化。<br><br>老师，这段可以再解释一下吗？没计算过程不太理解","like_count":9,"discussions":[{"author":{"id":1165037,"avatar":"https://static001.geekbang.org/account/avatar/00/11/c6/ed/89a2dc13.jpg","nickname":"丢了个丢丢丢","note":"","ucode":"BDD7E97E0E5E96","race_medal":0,"user_type":4,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":439250,"discussion_content":"同一个类别下的平均值。比如都属于同一个类别里面有10个点，那么新的中心点就是这10个点的中心点，一种简单的方式就是取平均值。比如我在文章里举了足球队的例子，一共有3个指标，每个球队都有这三个指标的特征值，那么新的中心点，就是取这个类别中的这些点 这三个指标特征值的平均值。。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1550822100,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":4}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1052892,"avatar":"https://static001.geekbang.org/account/avatar/00/10/10/dc/96476998.jpg","nickname":"Hulk","note":"","ucode":"8D6EDC6E370E21","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":1196,"discussion_content":"这段很关键，少了确实看不懂","likes_number":1,"is_delete":false,"is_hidden":false,"ctime":1562393282,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1115232,"avatar":"https://static001.geekbang.org/account/avatar/00/11/04/60/64d166b6.jpg","nickname":"Fan","note":"","ucode":"3BF28670FD9407","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":385616,"discussion_content":"很关键","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1627181348,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":138929,"user_name":"乃鱼同学","can_delete":false,"product_type":"c1","uid":1567940,"ip_address":"","ucode":"50A96C24978057","user_header":"https://static001.geekbang.org/account/avatar/00/17/ec/c4/19f85ada.jpg","comment_is_top":false,"comment_ctime":1570510586,"is_pvip":false,"replies":[{"id":"62713","content":"哈哈哈 这么说很形象","user_name":"作者回复","comment_id":138929,"uid":"1306094","ip_address":"","utype":1,"ctime":1577085845,"user_name_real":"cy"}],"discussion_count":1,"race_medal":0,"score":"23045347066","product_id":100021701,"comment_content":"K-Means 是聚类算法：经常做坏事的人 ，就是坏人。<br>KNN 是分类算法：坏人经常做坏事。<br>我对孩子就是这么说的。","like_count":6,"discussions":[{"author":{"id":1306094,"avatar":"https://static001.geekbang.org/account/avatar/00/13/ed/ee/c4779b67.jpg","nickname":"cy","note":"","ucode":"50D653399A31F6","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":469703,"discussion_content":"哈哈哈 这么说很形象","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1577085845,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":78846,"user_name":"听妈妈的话","can_delete":false,"product_type":"c1","uid":1462417,"ip_address":"","ucode":"089D797A39C791","user_header":"https://static001.geekbang.org/account/avatar/00/16/50/91/0dd2b8ce.jpg","comment_is_top":false,"comment_ctime":1553256386,"is_pvip":false,"replies":[{"id":"64375","content":"Good Job","user_name":"作者回复","comment_id":78846,"uid":"1306094","ip_address":"","utype":1,"ctime":1577617970,"user_name_real":"cy"}],"discussion_count":3,"race_medal":0,"score":"18733125570","product_id":100021701,"comment_content":"代码里的第八行应该去掉列名里的空格：<br>train_x = data[[&#39;2019年国际排名&#39;,&#39;2018世界杯&#39;,&#39;2015亚洲杯&#39;]]<br>Z-score标准化的代码：train_x=preprocessing.scale(train_x)<br><br>国家\t2019年国际排名\t2018世界杯\t2015亚洲杯\t聚类<br>0\t中国\t73\t40\t7\t3<br>1\t日本\t60\t15\t5\t1<br>2\t韩国\t61\t19\t2\t1<br>3\t伊朗\t34\t18\t6\t1<br>4\t沙特\t67\t26\t10\t1<br>5\t伊拉克\t91\t40\t4\t3<br>6\t卡塔尔\t101\t40\t13\t0<br>7\t阿联酋\t81\t40\t6\t3<br>8\t乌兹别克斯坦\t88\t40\t8\t3<br>9\t泰国\t122\t40\t17\t4<br>10\t越南\t102\t50\t17\t4<br>11\t阿曼\t87\t50\t12\t0<br>12\t巴林\t116\t50\t11\t0<br>13\t朝鲜\t110\t50\t14\t0<br>14\t印尼\t164\t50\t17\t2<br>15\t澳洲\t40\t30\t1\t1<br>16\t叙利亚\t76\t40\t17\t4<br>17\t约旦\t118\t50\t9\t0<br>18\t科威特\t160\t50\t15\t2<br>19\t巴勒斯坦\t96\t50\t16\t4","like_count":4,"discussions":[{"author":{"id":1306094,"avatar":"https://static001.geekbang.org/account/avatar/00/13/ed/ee/c4779b67.jpg","nickname":"cy","note":"","ucode":"50D653399A31F6","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":444253,"discussion_content":"Good Job","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1577617970,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1474214,"avatar":"https://static001.geekbang.org/account/avatar/00/16/7e/a6/4e331ef4.jpg","nickname":"骑行的掌柜J","note":"","ucode":"3163102651C653","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":4232,"discussion_content":"是的 前后空格都得去掉","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1565244429,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1464176,"avatar":"","nickname":"周志翔","note":"","ucode":"22866A9A9650E6","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":1893,"discussion_content":"对的，而且还有多个空格","likes_number":1,"is_delete":false,"is_hidden":false,"ctime":1563068884,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":72938,"user_name":"iamtalent123","can_delete":false,"product_type":"c1","uid":1360936,"ip_address":"","ucode":"E009E6F7EE8003","user_header":"","comment_is_top":false,"comment_ctime":1551757291,"is_pvip":false,"replies":[{"id":"40550","content":"可以不用转换，之前已经用了：<br>data = pd.read_csv(&#39;data.csv&#39;, encoding=&#39;gbk&#39;)<br>train_x = data[[&quot;2019年国际排名&quot;,&quot;2018世界杯&quot;,&quot;2015亚洲杯&quot;]]<br>得到的train_x是DataFrame数据结构，你也可以通过查看type(train_x)，所以不用再转换了。","user_name":"编辑回复","comment_id":72938,"uid":"1165037","ip_address":"","utype":2,"ctime":1562554227,"user_name_real":"何昌梅"}],"discussion_count":2,"race_medal":0,"score":"18731626475","product_id":100021701,"comment_content":"老师，请问为什么要对train_x转化为datadframe格式呢？df=pd.DataFrame(train_x)，df有什么用呢？","like_count":4,"discussions":[{"author":{"id":1165037,"avatar":"https://static001.geekbang.org/account/avatar/00/11/c6/ed/89a2dc13.jpg","nickname":"丢了个丢丢丢","note":"","ucode":"BDD7E97E0E5E96","race_medal":0,"user_type":4,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":441833,"discussion_content":"可以不用转换，之前已经用了：\ndata = pd.read_csv(&amp;#39;data.csv&amp;#39;, encoding=&amp;#39;gbk&amp;#39;)\ntrain_x = data[[&amp;quot;2019年国际排名&amp;quot;,&amp;quot;2018世界杯&amp;quot;,&amp;quot;2015亚洲杯&amp;quot;]]\n得到的train_x是DataFrame数据结构，你也可以通过查看type(train_x)，所以不用再转换了。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1562554227,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":4}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1218578,"avatar":"https://static001.geekbang.org/account/avatar/00/12/98/12/a169bdcd.jpg","nickname":"Geek_477c02","note":"","ucode":"CB9A714A50B977","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":114099,"discussion_content":"排名为什么能看做正态分布？？？","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1577957464,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":122796,"user_name":"juixv3937","can_delete":false,"product_type":"c1","uid":1486338,"ip_address":"","ucode":"C164F6641FE043","user_header":"http://thirdwx.qlogo.cn/mmopen/vi_32/1rd5KVxbBWO1Jnq3syrfRQg0NGerVl4Dt7uHTMcy9A7KTqxmy7iaoomoWsjuHM4n7fBr0ESG8OqfJKCDHExzjvQ/132","comment_is_top":false,"comment_ctime":1565526795,"is_pvip":false,"replies":[{"id":"63538","content":"KMeans每次运行结果不一定都相同，有一定随机性","user_name":"作者回复","comment_id":122796,"uid":"1306094","ip_address":"","utype":1,"ctime":1577517329,"user_name_real":"cy"}],"discussion_count":2,"race_medal":0,"score":"10155461387","product_id":100021701,"comment_content":"为什么,你们的代码,运行出来跟我的结果都不一样","like_count":2,"discussions":[{"author":{"id":1306094,"avatar":"https://static001.geekbang.org/account/avatar/00/13/ed/ee/c4779b67.jpg","nickname":"cy","note":"","ucode":"50D653399A31F6","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":462409,"discussion_content":"KMeans每次运行结果不一定都相同，有一定随机性","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1577517329,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1699231,"avatar":"https://static001.geekbang.org/account/avatar/00/19/ed/9f/1ff59689.jpg","nickname":"其实我是JUAN","note":"","ucode":"1C3C89937477DE","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":106089,"discussion_content":"应该类都是一样，就是排序不一样吧","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1577513020,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":85722,"user_name":"周飞","can_delete":false,"product_type":"c1","uid":1073374,"ip_address":"","ucode":"F85FA236EB0C0D","user_header":"https://static001.geekbang.org/account/avatar/00/10/60/de/5c67895a.jpg","comment_is_top":false,"comment_ctime":1555213080,"is_pvip":false,"replies":[{"id":"64263","content":"整理的不错","user_name":"作者回复","comment_id":85722,"uid":"1306094","ip_address":"","utype":1,"ctime":1577615654,"user_name_real":"cy"}],"discussion_count":1,"race_medal":0,"score":"10145147672","product_id":100021701,"comment_content":"k-means的算法原理就是：<br>1.选择几个初始的中心点。<br>2.计算每个点到各个中心点的距离，然后把每个点划分到距离最近的中心点所在的类。<br>3.更新中心点的值。对于每个类，计算类中所有数据的平均值，把平均值作为新的中心点。<br>4.重复 2 和4 步骤，直到每个类中的数据不再变化，或者到达指定的迭代步数。","like_count":2,"discussions":[{"author":{"id":1306094,"avatar":"https://static001.geekbang.org/account/avatar/00/13/ed/ee/c4779b67.jpg","nickname":"cy","note":"","ucode":"50D653399A31F6","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":446780,"discussion_content":"整理的不错","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1577615654,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":68174,"user_name":"FORWARD―MOUNT","can_delete":false,"product_type":"c1","uid":1357857,"ip_address":"","ucode":"CD8E9ECF882980","user_header":"https://static001.geekbang.org/account/avatar/00/14/b8/21/c03839f1.jpg","comment_is_top":false,"comment_ctime":1550453860,"is_pvip":false,"replies":[{"id":"24811","content":"取特征值的平均值为中心点。","user_name":"编辑回复","comment_id":68174,"uid":"1165037","ip_address":"","utype":2,"ctime":1550821961,"user_name_real":"何昌梅"}],"discussion_count":2,"race_medal":0,"score":"10140388452","product_id":100021701,"comment_content":"如何调整聚类中心没听懂","like_count":2,"discussions":[{"author":{"id":1165037,"avatar":"https://static001.geekbang.org/account/avatar/00/11/c6/ed/89a2dc13.jpg","nickname":"丢了个丢丢丢","note":"","ucode":"BDD7E97E0E5E96","race_medal":0,"user_type":4,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":439549,"discussion_content":"取特征值的平均值为中心点。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1550821961,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":4}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1052892,"avatar":"https://static001.geekbang.org/account/avatar/00/10/10/dc/96476998.jpg","nickname":"Hulk","note":"","ucode":"8D6EDC6E370E21","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":1197,"discussion_content":"解释的太简单了，最好迭代两个过程才能听懂啊","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1562393365,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":268220,"user_name":"蔡苗","can_delete":false,"product_type":"c1","uid":1626914,"ip_address":"","ucode":"7F52C3DF6F6278","user_header":"https://static001.geekbang.org/account/avatar/00/18/d3/22/53a608c8.jpg","comment_is_top":false,"comment_ctime":1608105002,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"5903072298","product_id":100021701,"comment_content":"Kmeans的K个数，我使用了肘部原则，确定了聚类较优结果为2个或者3个，2个个数太少，所以最后取值为3，跟老师在案例中取法一致。相应Code我已经贴下来。<br># coding: utf-8<br>from sklearn import preprocessing<br>import pandas as pd<br>import numpy as np<br>from sklearn.cluster import KMeans<br>import matplotlib.pyplot as plt<br># 输入数据<br>data = pd.read_csv(&#39;data.csv&#39;, encoding=&#39;gbk&#39;)<br>print(data.columns)<br>train_x = data[[&quot;2019年国际排名&quot;,&#39;2018年世界杯&#39;,&quot;2015年亚洲杯&quot;]]<br>df = pd.DataFrame(train_x)<br> # 规范化到[0,1]空间<br>min_max_scaler=preprocessing.MinMaxScaler()<br>train_x=min_max_scaler.fit_transform(train_x)<br>SSE=[]<br>for i in range(1,9):#给定k范围 ，最大分为9类，最小分成1类<br>    #肘部原则：利用SSE找K，SSE是样本到簇中心误差平方和<br>    #原理：同簇的样本点越紧，分类较好；同簇种样本数量增多，SSE增大；<br>    #随着分类数目从0开始增多，刚开始SSE减少，后来分类增大到后，SSE突然大幅减少，之后减缓为0.其中分类为N时候，SSE为0。找到大幅下降时候的K值<br>    # kmeans算法<br>    kmeans = KMeans(n_clusters=i)<br>    kmeans.fit(train_x)<br>    SSE.append(kmeans.inertia_)#聚类误差平方和<br>x=range(1,9)<br>plt.xlabel(&#39;k&#39;)<br>plt.ylabel(&#39;SSE&#39;)<br>plt.plot(x,SSE,&#39;o-&#39;)<br>plt.show()<br>#较优聚类为3类<br>kmeans = KMeans(n_clusters=3)<br># kmeans算法<br>kmeans.fit(train_x)<br>predict_y = kmeans.predict(train_x)<br>data[&#39;predict_y&#39;]=pd.DataFrame(predict_y)<br>data.rename({&#39;predict_y&#39;:r&#39;聚类&#39;},axis=1,inplace=True)","like_count":1},{"had_liked":false,"id":235897,"user_name":"Jack","can_delete":false,"product_type":"c1","uid":1038023,"ip_address":"","ucode":"057F1327F688B6","user_header":"https://static001.geekbang.org/account/avatar/00/0f/d6/c7/7390039f.jpg","comment_is_top":false,"comment_ctime":1595238404,"is_pvip":false,"replies":[{"id":"103509","content":"一般使用轮廓系数（越大越好）或者误差平方和（即SSE，一般用于手肘法中确认K值的拐点）","user_name":"作者回复","comment_id":235897,"uid":"1306094","ip_address":"","utype":1,"ctime":1616692208,"user_name_real":"cy"}],"discussion_count":1,"race_medal":0,"score":"5890205700","product_id":100021701,"comment_content":"老师，对于K-Means算法，我们如何评估模型的好坏，常用的评价指标都有哪些呢？","like_count":1,"discussions":[{"author":{"id":1306094,"avatar":"https://static001.geekbang.org/account/avatar/00/13/ed/ee/c4779b67.jpg","nickname":"cy","note":"","ucode":"50D653399A31F6","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":501870,"discussion_content":"一般使用轮廓系数（越大越好）或者误差平方和（即SSE，一般用于手肘法中确认K值的拐点）","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1616692208,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":109168,"user_name":"Yafei","can_delete":false,"product_type":"c1","uid":1233728,"ip_address":"","ucode":"BEA5B162DF2364","user_header":"https://static001.geekbang.org/account/avatar/00/12/d3/40/39d41615.jpg","comment_is_top":false,"comment_ctime":1561974059,"is_pvip":false,"replies":[{"id":"40566","content":"对 可以这么理解，你可以理解是K=3代表是三个类，分别对应Class1, Class2, Class3。我们需要先给这三个类分别指定3个中心点，然后做聚类。最后的聚类标签含义，是我们来标记的。","user_name":"编辑回复","comment_id":109168,"uid":"1165037","ip_address":"","utype":2,"ctime":1562555453,"user_name_real":"何昌梅"}],"discussion_count":1,"race_medal":0,"score":"5856941355","product_id":100021701,"comment_content":"这也就是 K-Means 的中心思想，就是这么简单直接。你可能会问：如果一开始，选择一流球队是中国，二流球队是伊朗，三流球队是韩国，中心点选择错了怎么办？其实不用担心，K-Means 有自我纠正机制，在不断的迭代过程中，会纠正中心点。中心点在整个迭代过程中，并不是唯一的，只是你需要一个初始值，一般算法会随机设置初始的中心点。<br>老师，这段是否表述有误，如果你一开始就给中国一流球队的标签，在计算所有点到中国距离的平均距离过程中，分类点会收敛到这类标签的中心点，但是标签还是一流球队，并不会改变，变化的仅是分类点。因此，对于聚类，我们只是将所有样本点归到一个类别下，具体类别的标签应该是我们自己来标记的。如理解不对，还望指正！","like_count":1,"discussions":[{"author":{"id":1165037,"avatar":"https://static001.geekbang.org/account/avatar/00/11/c6/ed/89a2dc13.jpg","nickname":"丢了个丢丢丢","note":"","ucode":"BDD7E97E0E5E96","race_medal":0,"user_type":4,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":456278,"discussion_content":"对 可以这么理解，你可以理解是K=3代表是三个类，分别对应Class1, Class2, Class3。我们需要先给这三个类分别指定3个中心点，然后做聚类。最后的聚类标签含义，是我们来标记的。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1562555453,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":4}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":90032,"user_name":"Aries","can_delete":false,"product_type":"c1","uid":1224822,"ip_address":"","ucode":"E3BA01BDDD2533","user_header":"https://static001.geekbang.org/account/avatar/00/12/b0/76/a75b0ae3.jpg","comment_is_top":false,"comment_ctime":1556374678,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"5851341974","product_id":100021701,"comment_content":"老师，怎么更换距离计算方法","like_count":1},{"had_liked":false,"id":70806,"user_name":"JingZ","can_delete":false,"product_type":"c1","uid":1023464,"ip_address":"","ucode":"6F97895B2CC375","user_header":"https://thirdwx.qlogo.cn/mmopen/vi_32/wJphZ3HcvhjVUyTWCIsCugzfQY5NAy6VJ0XoPLibDlcHWMswFmFe678zd0lUjFETia80NQhyQcVnGDlKgKPcRGyw/132","comment_is_top":false,"comment_ctime":1551187548,"is_pvip":false,"replies":[{"id":"64500","content":"可以 没用到的工具包 前面可以不import","user_name":"作者回复","comment_id":70806,"uid":"1306094","ip_address":"","utype":1,"ctime":1577620113,"user_name_real":"cy"}],"discussion_count":2,"race_medal":0,"score":"5846154844","product_id":100021701,"comment_content":"import numpy as np 这行代码不需要吧~感觉没用到","like_count":1,"discussions":[{"author":{"id":1306094,"avatar":"https://static001.geekbang.org/account/avatar/00/13/ed/ee/c4779b67.jpg","nickname":"cy","note":"","ucode":"50D653399A31F6","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":440840,"discussion_content":"可以 没用到的工具包 前面可以不import","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1577620113,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1474214,"avatar":"https://static001.geekbang.org/account/avatar/00/16/7e/a6/4e331ef4.jpg","nickname":"骑行的掌柜J","note":"","ucode":"3163102651C653","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":4234,"discussion_content":"确实没有","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1565244712,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":342722,"user_name":"Jeff","can_delete":false,"product_type":"c1","uid":2864924,"ip_address":"","ucode":"F9230D1FA48AE1","user_header":"https://static001.geekbang.org/account/avatar/00/2b/b7/1c/b5c9456b.jpg","comment_is_top":false,"comment_ctime":1650432752,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1650432752","product_id":100021701,"comment_content":"请教一个问题，文章在介绍n_init参数时说，需要不断的迭代初始中心点来找到最好的初始中心点，请问如何判断初始中心点是最好的？","like_count":0},{"had_liked":false,"id":293126,"user_name":"水月","can_delete":false,"product_type":"c1","uid":2344034,"ip_address":"","ucode":"78FC68615016DB","user_header":"https://static001.geekbang.org/account/avatar/00/23/c4/62/269aae3f.jpg","comment_is_top":false,"comment_ctime":1621231084,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1621231084","product_id":100021701,"comment_content":"老师，KMEANS分类之后的结果如果需要可视化展示的话应该怎么做呢？","like_count":0},{"had_liked":false,"id":270022,"user_name":"McKee Chen","can_delete":false,"product_type":"c1","uid":2037505,"ip_address":"","ucode":"F74B76542FAB65","user_header":"https://static001.geekbang.org/account/avatar/00/1f/17/01/1c5309a3.jpg","comment_is_top":false,"comment_ctime":1608880422,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1608880422","product_id":100021701,"comment_content":"K-Means聚类原理:<br>1.初始化k个中心点，计算各点到中心点的距离<br>2.查看聚类结果，重新计算K个聚类中心点<br>3.若聚类中心点不再发生变化，说明已达到最有聚类效果；或者聚类点发生变化但以满足最大迭代次数，此时也应停止继续循环聚类<br><br>KNN和K-Means的区别:<br>1.K值含义不同，KNN中的K是K个邻居，K-Means的K是K个中心点<br>2.KNN是监督学习，K-Means是无监督学习<br>3.KNN是分类算法，K-Means是聚类算法<br><br>#20支亚洲球队用 K-Means 划分成 5 类，在规范化数据的时候采用标准化的方式<br>from sklearn.preprocessing import StandardScaler<br>from sklearn.cluster import KMeans<br>import pandas as pd<br>import numpy as np<br>#导入数据<br>data = pd.read_csv(r&#39;C:\\Users\\chentaoyu\\Desktop\\k-means-profiles\\data.csv&#39;, encoding=&#39;gbk&#39;)<br>train_x = data[[&#39;2019年国际排名&#39;, &#39;2018世界杯&#39;, &#39;2015亚洲杯&#39;]]<br>#建KMeans模型<br>kmeans = KMeans(n_clusters=5)<br>#对数据进行规范化<br>ss = StandardScaler()<br>train_x = ss.fit_transform(train_x)<br>#对模型进行拟合，对每个球队进行聚类，并求出每个球队聚类结果<br>kmeans.fit(train_x)<br>predict_y = kmeans.predict(train_x)<br>#导出聚类结果<br>result = pd.concat((data, pd.DataFrame(predict_y)), axis=1)<br>result.rename({0: u&#39;聚类结果&#39;}, axis=1, inplace=True)<br>print(result)<br><br>#到处聚类结果predict_y<br>print(predict_y)<br><br>[2 0 0 0 0 2 4 2 2 4 4 1 1 1 3 0 4 1 3 4]","like_count":0},{"had_liked":false,"id":263411,"user_name":"非同凡想","can_delete":false,"product_type":"c1","uid":1934969,"ip_address":"","ucode":"713FD449A49D5A","user_header":"https://static001.geekbang.org/account/avatar/00/1d/86/79/066a062a.jpg","comment_is_top":false,"comment_ctime":1606128321,"is_pvip":false,"replies":[{"id":"103000","content":"代码正确","user_name":"作者回复","comment_id":263411,"uid":"1306094","ip_address":"","utype":1,"ctime":1615994744,"user_name_real":"cy"}],"discussion_count":1,"race_medal":0,"score":"1606128321","product_id":100021701,"comment_content":"交作业了<br>import pandas as pd<br>from sklearn.preprocessing import MinMaxScaler,StandardScaler<br>from sklearn.cluster import KMeans<br><br>data  = pd.read_csv(&#39;~&#47;Documents&#47;kmeans&#47;data.csv&#39;,encoding=&#39;gbk&#39;)<br><br>print(data.info())<br>print(data.head())<br><br>features = data.columns[1:]<br><br>train_x = data[features]<br><br># scaler = MinMaxScaler()<br>scaler = StandardScaler()<br>train_x = scaler.fit_transform(train_x)<br><br>model = KMeans(n_clusters=5)<br><br>clusters = model.fit_predict(train_x)<br>data[&#39;聚类&#39;] = clusters<br>print(data)<br><br>       国家  2019年国际排名  2018世界杯  2015亚洲杯  聚类<br>0       中国         73       40        7   2<br>1       日本         60       15        5   1<br>2       韩国         61       19        2   1<br>3       伊朗         34       18        6   1<br>4       沙特         67       26       10   1<br>5      伊拉克         91       40        4   2<br>6      卡塔尔        101       40       13   0<br>7      阿联酋         81       40        6   2<br>8   乌兹别克斯坦         88       40        8   2<br>9       泰国        122       40       17   4<br>10      越南        102       50       17   4<br>11      阿曼         87       50       12   0<br>12      巴林        116       50       11   0<br>13      朝鲜        110       50       14   0<br>14      印尼        164       50       17   3<br>15      澳洲         40       30        1   1<br>16     叙利亚         76       40       17   4<br>17      约旦        118       50        9   0<br>18     科威特        160       50       15   3<br>19    巴勒斯坦         96       50       16   4","like_count":0,"discussions":[{"author":{"id":1306094,"avatar":"https://static001.geekbang.org/account/avatar/00/13/ed/ee/c4779b67.jpg","nickname":"cy","note":"","ucode":"50D653399A31F6","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":510177,"discussion_content":"代码正确","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1615994744,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":212133,"user_name":"Geek_c9fa4e","can_delete":false,"product_type":"c1","uid":1972305,"ip_address":"","ucode":"391982F33C1AAA","user_header":"http://thirdwx.qlogo.cn/mmopen/vi_32/ziaN7rOONp15HJm6A9JoAYicJL8VA59x10DX4JZyvcfqmmpCnumXgAkNn37aFoALftyTaQNlUF7te54LibvVm20TQ/132","comment_is_top":false,"comment_ctime":1588064624,"is_pvip":false,"replies":[{"id":"103968","content":"这里的距离包括类别间距离和类别内距离。","user_name":"作者回复","comment_id":212133,"uid":"1306094","ip_address":"","utype":1,"ctime":1617288817,"user_name_real":"cy"}],"discussion_count":1,"race_medal":0,"score":"1588064624","product_id":100021701,"comment_content":"K-Means的算法原理：就是通过初始化一个类别，通过计算出它们直接的距离，来区别属于哪一个类。","like_count":0,"discussions":[{"author":{"id":1306094,"avatar":"https://static001.geekbang.org/account/avatar/00/13/ed/ee/c4779b67.jpg","nickname":"cy","note":"","ucode":"50D653399A31F6","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":493437,"discussion_content":"这里的距离包括类别间距离和类别内距离。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1617288817,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":202783,"user_name":"JustDoDT","can_delete":false,"product_type":"c1","uid":1127175,"ip_address":"","ucode":"6AF0B80F00EAEF","user_header":"https://static001.geekbang.org/account/avatar/00/11/33/07/8f351609.jpg","comment_is_top":false,"comment_ctime":1586068502,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1586068502","product_id":100021701,"comment_content":"交作业：<br>https:&#47;&#47;github.com&#47;LearningChanging&#47;Data-analysis-in-action&#47;tree&#47;master&#47;26-K-Means%EF%BC%88%E4%B8%8A%EF%BC%89%EF%BC%9A%E5%A6%82%E4%BD%95%E7%BB%9920%E6%94%AF%E4%BA%9A%E6%B4%B2%E7%90%83%E9%98%9F%E5%81%9A%E8%81%9A%E7%B1%BB%EF%BC%9F","like_count":0},{"had_liked":false,"id":185689,"user_name":"William～Zhang","can_delete":false,"product_type":"c1","uid":1527138,"ip_address":"","ucode":"8659B589428F11","user_header":"https://static001.geekbang.org/account/avatar/00/17/4d/62/0fe9cbb3.jpg","comment_is_top":false,"comment_ctime":1583663613,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1583663613","product_id":100021701,"comment_content":"老师，请问规范化数据的时候，什么情况使用min max 什么时候使用z score","like_count":0},{"had_liked":false,"id":184401,"user_name":"鱼非子","can_delete":false,"product_type":"c1","uid":1818595,"ip_address":"","ucode":"BB76AE2CB4D680","user_header":"https://static001.geekbang.org/account/avatar/00/1b/bf/e3/2aa8ec84.jpg","comment_is_top":false,"comment_ctime":1583308111,"is_pvip":false,"replies":[{"id":"104365","content":"Good Job！分享代码会更好哦","user_name":"作者回复","user_name_real":"cy","uid":"1306094","ctime":1617905067,"ip_address":"","comment_id":184401,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1583308111","product_id":100021701,"comment_content":"        国家  2019年国际排名  2018世界杯  2015亚洲杯  聚类<br>0       中国         73       40        7   3<br>1       日本         60       15        5   1<br>2       韩国         61       19        2   1<br>3       伊朗         34       18        6   1<br>4       沙特         67       26       10   3<br>5      伊拉克         91       40        4   3<br>6      卡塔尔        101       40       13   0<br>7      阿联酋         81       40        6   3<br>8   乌兹别克斯坦         88       40        8   3<br>9       泰国        122       40       17   0<br>10      越南        102       50       17   0<br>11      阿曼         87       50       12   2<br>12      巴林        116       50       11   2<br>13      朝鲜        110       50       14   2<br>14      印尼        164       50       17   4<br>15      澳洲         40       30        1   1<br>16     叙利亚         76       40       17   0<br>17      约旦        118       50        9   2<br>18     科威特        160       50       15   4<br>19    巴勒斯坦         96       50       16   0<br>","like_count":0,"discussions":[{"author":{"id":1306094,"avatar":"https://static001.geekbang.org/account/avatar/00/13/ed/ee/c4779b67.jpg","nickname":"cy","note":"","ucode":"50D653399A31F6","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":486002,"discussion_content":"Good Job！分享代码会更好哦","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1617905067,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":184400,"user_name":"鱼非子","can_delete":false,"product_type":"c1","uid":1818595,"ip_address":"","ucode":"BB76AE2CB4D680","user_header":"https://static001.geekbang.org/account/avatar/00/1b/bf/e3/2aa8ec84.jpg","comment_is_top":false,"comment_ctime":1583308077,"is_pvip":false,"replies":[{"id":"104367","content":"Good Job","user_name":"作者回复","user_name_real":"cy","uid":"1306094","ctime":1617905257,"ip_address":"","comment_id":184400,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1583308077","product_id":100021701,"comment_content":"# coding: utf-8<br><br>import numpy as np<br>import pandas as pd<br>from sklearn.cluster import KMeans<br>from sklearn import preprocessing<br><br>data = pd.read_csv(&quot;data.csv&quot;,encoding=&#39;gbk&#39;)<br>print(data.head(5))<br><br>train_x = data[[&quot;2019年国际排名&quot;,&quot;2018世界杯&quot;,&quot;2015亚洲杯&quot;]]<br># df = pd.DataFrame(data)<br><br>model = KMeans(n_clusters=5)<br>stand = preprocessing.StandardScaler()<br># min_max_scaler = preprocessing.MinMaxScaler()<br># train_x = min_max_scaler.fit_transform(train_x)<br>train_x = stand.fit_transform(train_x)<br><br>model.fit(train_x)<br>predict = model.predict(train_x)<br><br># df[&#39;聚类&#39;] = predict<br>data[&#39;聚类&#39;] = predict<br># result = pd.concat((data,pd.DataFrame(predict)),axis=1)<br>print(data)","like_count":0,"discussions":[{"author":{"id":1306094,"avatar":"https://static001.geekbang.org/account/avatar/00/13/ed/ee/c4779b67.jpg","nickname":"cy","note":"","ucode":"50D653399A31F6","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":486001,"discussion_content":"Good Job","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1617905257,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":184399,"user_name":"鱼非子","can_delete":false,"product_type":"c1","uid":1818595,"ip_address":"","ucode":"BB76AE2CB4D680","user_header":"https://static001.geekbang.org/account/avatar/00/1b/bf/e3/2aa8ec84.jpg","comment_is_top":false,"comment_ctime":1583307945,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1583307945","product_id":100021701,"comment_content":"# coding: utf-8<br><br>import numpy as np<br>import pandas as pd<br>from sklearn.cluster import KMeans<br>from sklearn import preprocessing<br><br>data = pd.read_csv(&quot;data.csv&quot;,encoding=&#39;gbk&#39;)<br>print(data.head(5))<br><br>train_x = data[[&quot;2019年国际排名&quot;,&quot;2018世界杯&quot;,&quot;2015亚洲杯&quot;]]<br># df = pd.DataFrame(data)<br><br>model = KMeans(n_clusters=3)<br>min_max_scaler = preprocessing.MinMaxScaler()<br>train_x = min_max_scaler.fit_transform(train_x)<br><br>model.fit(train_x)<br>predict = model.predict(train_x)<br><br># df[&#39;聚类&#39;] = predict<br>data[&#39;聚类&#39;] = predict<br># result = pd.concat((data,pd.DataFrame(predict)),axis=1)<br>print(data)","like_count":0},{"had_liked":false,"id":173668,"user_name":"groot888","can_delete":false,"product_type":"c1","uid":1266597,"ip_address":"","ucode":"50E50681D6BE0C","user_header":"https://thirdwx.qlogo.cn/mmopen/vi_32/oseia6IjJIPziamTI2EQ0Bpr8icUicXTea2UuH105t4Bia4yFwBHld49cIQbjORvDdTtMCVdL39H9WxFwzyXspqqHUg/132","comment_is_top":false,"comment_ctime":1579655724,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1579655724","product_id":100021701,"comment_content":"老师，看到之前的算法，都先用训练数据训练出模型，再用测试数据跑出预测数据，但这篇文章没有训练数据训练模型的步骤，为啥直接就跑出预测数据了呢？","like_count":0},{"had_liked":false,"id":167885,"user_name":"Geek_477c02","can_delete":false,"product_type":"c1","uid":1218578,"ip_address":"","ucode":"CB9A714A50B977","user_header":"https://static001.geekbang.org/account/avatar/00/12/98/12/a169bdcd.jpg","comment_is_top":false,"comment_ctime":1577957506,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1577957506","product_id":100021701,"comment_content":"数据处理部分，为什么能把排名作为正态分布？？？","like_count":0},{"had_liked":false,"id":167143,"user_name":"Untitled","can_delete":false,"product_type":"c1","uid":1039464,"ip_address":"","ucode":"8DD6ABA3E81A2E","user_header":"https://static001.geekbang.org/account/avatar/00/0f/dc/68/006ba72c.jpg","comment_is_top":false,"comment_ctime":1577698091,"is_pvip":false,"discussion_count":0,"race_medal":2,"score":"1577698091","product_id":100021701,"comment_content":"==     分5类（正太分布标准化）      =======<br>        国家  2019年国际排名  2018世界杯  2015亚洲杯  聚类<br>0       中国         73       40        7   2<br>1       日本         60       15        5   1<br>2       韩国         61       19        2   1<br>3       伊朗         34       18        6   1<br>4       沙特         67       26       10   1<br>5      伊拉克         91       40        4   2<br>6      卡塔尔        101       40       13   0<br>7      阿联酋         81       40        6   2<br>8   乌兹别克斯坦         88       40        8   2<br>9       泰国        122       40       17   0<br>10      越南        102       50       17   0<br>11      阿曼         87       50       12   0<br>12      巴林        116       50       11   4<br>13      朝鲜        110       50       14   0<br>14      印尼        164       50       17   3<br>15      澳洲         40       30        1   1<br>16     叙利亚         76       40       17   0<br>17      约旦        118       50        9   4<br>18     科威特        160       50       15   3<br>19    巴勒斯坦         96       50       16   0","like_count":0},{"had_liked":false,"id":152745,"user_name":"Ronnyz","can_delete":false,"product_type":"c1","uid":1488280,"ip_address":"","ucode":"9F34527B1D343D","user_header":"https://static001.geekbang.org/account/avatar/00/16/b5/98/ffaf2aca.jpg","comment_is_top":false,"comment_ctime":1574074426,"is_pvip":false,"replies":[{"id":"62666","content":"正确，Ronnyz的代码能力不错","user_name":"作者回复","user_name_real":"cy","uid":"1306094","ctime":1577082181,"ip_address":"","comment_id":152745,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1574074426","product_id":100021701,"comment_content":"from sklearn.cluster import KMeans\r<br>from sklearn import preprocessing\r<br>import numpy as np\r<br>import pandas as pd\r<br>\r<br>#输出数据\r<br>data=pd.read_csv(&#39;.&#47;kmeans-master&#47;data.csv&#39;,encoding =&#39;gbk&#39;)\r<br>train_x = data[[&#39;2019年国际排名&#39;,&#39;2018世界杯&#39;,&#39;2015亚洲杯&#39;]]\r<br>\r<br>#规范化数据\r<br>min_max_scaler=preprocessing.MinMaxScaler()\r<br>train_x_mm=min_max_scaler.fit_transform(train_x)\r<br># print(train_x)\r<br>\r<br>#构建kmeans聚类器\r<br>kmeans = KMeans(n_clusters=3)\r<br>kmeans.fit(train_x_mm)\r<br>pred_y=kmeans.predict(train_x_mm)\r<br>\r<br>#合并聚类结果\r<br>result = pd.concat((data,pd.DataFrame(pred_y)),axis=1)\r<br>result.rename({0:u&#39;聚类&#39;},axis=1,inplace=True)\r<br>print(result)\r<br>print(&#39;\\n&#39;)\r<br>\r<br>\r<br>#练习：K-Means=5,且采用标准化方式规范化\r<br>\r<br>#规范化数据StandScaler\r<br>ss=preprocessing.StandardScaler()\r<br>train_x_z=ss.fit_transform(train_x)\r<br>print(train_x_z)\r<br>\r<br>#构建kmeans聚类器\r<br>kmeans = KMeans(n_clusters=5)\r<br>kmeans.fit(train_x_z)\r<br>pred2_y=kmeans.predict(train_x_z)\r<br>\r<br>#合并聚类结果\r<br>result = pd.concat((data,pd.DataFrame(pred2_y)),axis=1)\r<br>result.rename({0:u&#39;聚类&#39;},axis=1,inplace=True)\r<br>print(result)","like_count":0,"discussions":[{"author":{"id":1306094,"avatar":"https://static001.geekbang.org/account/avatar/00/13/ed/ee/c4779b67.jpg","nickname":"cy","note":"","ucode":"50D653399A31F6","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":474924,"discussion_content":"正确，Ronnyz的代码能力不错","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1577082181,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":96985,"user_name":"张晓辉","can_delete":false,"product_type":"c1","uid":1085046,"ip_address":"","ucode":"1CD9717DE399C5","user_header":"https://static001.geekbang.org/account/avatar/00/10/8e/76/6d55e26f.jpg","comment_is_top":false,"comment_ctime":1558569869,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1558569869","product_id":100021701,"comment_content":"#coding:utf-8<br>from sklearn.cluster import KMeans<br>from sklearn import preprocessing<br>import pandas as pd <br>import numpy as np<br><br>data = pd.read_csv(&#39;data.csv&#39;, encoding=&#39;utf-8&#39;)<br>train_x = data[[&quot;2019年国际排名&quot;, &quot;2018世界杯&quot;, &quot;2015亚洲杯&quot;]]<br>df = pd.DataFrame(train_x)<br>kmeans = KMeans(n_clusters=5)<br>std = preprocessing.StandardScaler()<br>#min_max_scaler = preprocessing.MinMaxScaler()<br>#train_x = min_max_scaler.fit_transform(train_x)<br>train_x = std.fit_transform(train_x)<br>kmeans.fit(train_x)<br>predict_y = kmeans.predict(train_x)<br>result = pd.concat((data, pd.DataFrame(predict_y)), axis=1)<br>result.rename({0:u&#39;聚类&#39;}, axis=1, inplace=True)<br>print(result)","like_count":0},{"had_liked":false,"id":95896,"user_name":"Frederick","can_delete":false,"product_type":"c1","uid":1514247,"ip_address":"","ucode":"1481E9A581F7C4","user_header":"https://static001.geekbang.org/account/avatar/00/17/1b/07/0c1c76c2.jpg","comment_is_top":false,"comment_ctime":1558249011,"is_pvip":false,"replies":[{"id":"64170","content":"主要用于分类 和 回归","user_name":"作者回复","user_name_real":"cy","uid":"1306094","ctime":1577610907,"ip_address":"","comment_id":95896,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1558249011","product_id":100021701,"comment_content":"老师，我想问下，决策树可以用来聚类吗，如果可以，要怎么做呢？","like_count":0,"discussions":[{"author":{"id":1306094,"avatar":"https://static001.geekbang.org/account/avatar/00/13/ed/ee/c4779b67.jpg","nickname":"cy","note":"","ucode":"50D653399A31F6","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":450631,"discussion_content":"主要用于分类 和 回归","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1577610907,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":92981,"user_name":"Sam.张朝","can_delete":false,"product_type":"c1","uid":1132448,"ip_address":"","ucode":"FB20554D94B250","user_header":"https://static001.geekbang.org/account/avatar/00/11/47/a0/f12115b7.jpg","comment_is_top":false,"comment_ctime":1557372167,"is_pvip":true,"replies":[{"id":"64191","content":"对 聚类算法有一定的随机性","user_name":"作者回复","user_name_real":"cy","uid":"1306094","ctime":1577613972,"ip_address":"","comment_id":92981,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1557372167","product_id":100021701,"comment_content":"运行一次，结果变化一次。","like_count":0,"discussions":[{"author":{"id":1306094,"avatar":"https://static001.geekbang.org/account/avatar/00/13/ed/ee/c4779b67.jpg","nickname":"cy","note":"","ucode":"50D653399A31F6","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":449449,"discussion_content":"对 聚类算法有一定的随机性","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1577613972,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":92980,"user_name":"Sam.张朝","can_delete":false,"product_type":"c1","uid":1132448,"ip_address":"","ucode":"FB20554D94B250","user_header":"https://static001.geekbang.org/account/avatar/00/11/47/a0/f12115b7.jpg","comment_is_top":false,"comment_ctime":1557372139,"is_pvip":true,"replies":[{"id":"64192","content":"0 和 2只是label，关键是和谁聚在一起","user_name":"作者回复","user_name_real":"cy","uid":"1306094","ctime":1577613986,"ip_address":"","comment_id":92980,"utype":1}],"discussion_count":3,"race_medal":0,"score":"1557372139","product_id":100021701,"comment_content":"文章里的代码也好，问题的解决代码也好，中国都会在0 和2 之间变化。运行一次，变化一次。","like_count":0,"discussions":[{"author":{"id":1306094,"avatar":"https://static001.geekbang.org/account/avatar/00/13/ed/ee/c4779b67.jpg","nickname":"cy","note":"","ucode":"50D653399A31F6","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":449448,"discussion_content":"0 和 2只是label，关键是和谁聚在一起","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1577613986,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1546360,"avatar":"https://static001.geekbang.org/account/avatar/00/17/98/78/17953599.jpg","nickname":"张小艺","note":"","ucode":"85222658EA5D6F","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":43092,"discussion_content":"多运行几次，0-4都会出现","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1572853579,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1474214,"avatar":"https://static001.geekbang.org/account/avatar/00/16/7e/a6/4e331ef4.jpg","nickname":"骑行的掌柜J","note":"","ucode":"3163102651C653","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":4233,"discussion_content":"我也发现了 运行一次 变化一次","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1565244536,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":87698,"user_name":"滢","can_delete":false,"product_type":"c1","uid":1221511,"ip_address":"","ucode":"971A6F20AF3F9A","user_header":"https://static001.geekbang.org/account/avatar/00/12/a3/87/c415e370.jpg","comment_is_top":false,"comment_ctime":1555663628,"is_pvip":false,"replies":[{"id":"64247","content":"0， 1， 2只是label，关键是看 聚类出来的 谁和谁聚成了一类。这个数值没有具体含义的","user_name":"作者回复","user_name_real":"cy","uid":"1306094","ctime":1577615287,"ip_address":"","comment_id":87698,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1555663628","product_id":100021701,"comment_content":"老师，想问个问题，为何我计算出来的结果正好相反，就是后面聚类生成的0、1、2 这些数据，最弱的队归位来0类，一流队归类来2类，看留言里的代码大家计算出来的结果也不尽相同，想问下老师，是不是K-Means结果只是起到聚类的效果，没有展示其它属性的效果","like_count":0,"discussions":[{"author":{"id":1306094,"avatar":"https://static001.geekbang.org/account/avatar/00/13/ed/ee/c4779b67.jpg","nickname":"cy","note":"","ucode":"50D653399A31F6","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":447568,"discussion_content":"0， 1， 2只是label，关键是看 聚类出来的 谁和谁聚成了一类。这个数值没有具体含义的","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1577615287,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":85766,"user_name":"周飞","can_delete":false,"product_type":"c1","uid":1073374,"ip_address":"","ucode":"F85FA236EB0C0D","user_header":"https://static001.geekbang.org/account/avatar/00/10/60/de/5c67895a.jpg","comment_is_top":false,"comment_ctime":1555226885,"is_pvip":false,"replies":[{"id":"64262","content":"Good Sharing","user_name":"作者回复","user_name_real":"cy","uid":"1306094","ctime":1577615648,"ip_address":"","comment_id":85766,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1555226885","product_id":100021701,"comment_content":"分为5来的代码：<br># coding: utf-8<br>from sklearn.cluster import KMeans<br>from sklearn import preprocessing<br>import pandas as pd<br>import numpy as np<br># 输入数据<br>data = pd.read_csv(&#39;data.csv&#39;, encoding=&#39;gbk&#39;)<br>print(data)<br>train_x = data[[&quot;2019年国际排名&quot;,&quot;2018世界杯&quot;,&quot;2015亚洲杯&quot;]]<br>df = pd.DataFrame(train_x)<br>kmeans = KMeans(n_clusters=5)<br># 规范化到 [0,1] 空间<br>min_max_scaler=preprocessing.MinMaxScaler()<br>train_x=min_max_scaler.fit_transform(train_x)<br># kmeans 算法<br>kmeans.fit(train_x)<br>predict_y = kmeans.predict(train_x)<br># 合并聚类结果，插入到原数据中<br>result = pd.concat((data,pd.DataFrame(predict_y)),axis=1)<br>result.rename({0:u&#39;聚类&#39;},axis=1,inplace=True)<br>result.sort_values(&#39;聚类&#39;,inplace=True)<br>print(result)<br>运行结果：<br>        国家  2019年国际排名  2018世界杯  2015亚洲杯  聚类<br>0       中国         73       40        7   0<br>5      伊拉克         91       40        4   0<br>7      阿联酋         81       40        6   0<br>8   乌兹别克斯坦         88       40        8   0<br>18     科威特        160       50       15   1<br>14      印尼        164       50       17   1<br>1       日本         60       15        5   2<br>2       韩国         61       19        2   2<br>3       伊朗         34       18        6   2<br>4       沙特         67       26       10   2<br>15      澳洲         40       30        1   2<br>17      约旦        118       50        9   3<br>11      阿曼         87       50       12   3<br>12      巴林        116       50       11   3<br>13      朝鲜        110       50       14   3<br>16     叙利亚         76       40       17   4<br>9       泰国        122       40       17   4<br>6      卡塔尔        101       40       13   4<br>10      越南        102       50       17   4<br>19    巴勒斯坦         96       50       16   4<br>","like_count":0,"discussions":[{"author":{"id":1306094,"avatar":"https://static001.geekbang.org/account/avatar/00/13/ed/ee/c4779b67.jpg","nickname":"cy","note":"","ucode":"50D653399A31F6","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":446800,"discussion_content":"Good Sharing","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1577615648,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":81765,"user_name":"滨滨","can_delete":false,"product_type":"c1","uid":1334567,"ip_address":"","ucode":"881EFA798BEE34","user_header":"https://static001.geekbang.org/account/avatar/00/14/5d/27/74e152d3.jpg","comment_is_top":false,"comment_ctime":1554029212,"is_pvip":false,"replies":[{"id":"64344","content":"总结的不错 很形象","user_name":"作者回复","user_name_real":"cy","uid":"1306094","ctime":1577617266,"ip_address":"","comment_id":81765,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1554029212","product_id":100021701,"comment_content":"Kmeans开班，选老大，风水轮流转，直到选出最佳中心老大<br>Knn小弟加队伍，离那个班相对近，就是那个班的<br><br>一群人的有些人想要聚在一起<br>首先大家民主（无监督学习）随机选K个老大（随机选择K个中心点）<br>谁跟谁近，就是那个队伍的人（计算距离，距离近的聚合到一块）<br>随着时间的推移，老大的位置在变化（根据算法，重新计算中心点）<br>直到选出真正的中心老大（重复，直到准确率最高）<br><br>Knn<br>一个人想要找到自己的队伍<br>首先听从神的旨意（有监督学习），随机最近的几个邻居<br>看看距离远不远（根据算法，计算距离）<br>近的就是一个班的了（属于哪个分类多，就是哪一类）","like_count":0,"discussions":[{"author":{"id":1306094,"avatar":"https://static001.geekbang.org/account/avatar/00/13/ed/ee/c4779b67.jpg","nickname":"cy","note":"","ucode":"50D653399A31F6","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":445339,"discussion_content":"总结的不错 很形象","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1577617266,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":73172,"user_name":"跳跳","can_delete":false,"product_type":"c1","uid":1172803,"ip_address":"","ucode":"80B697B89E1A0B","user_header":"https://static001.geekbang.org/account/avatar/00/11/e5/43/7bc7cfe3.jpg","comment_is_top":false,"comment_ctime":1551835097,"is_pvip":false,"replies":[{"id":"64460","content":"Good Job 加油","user_name":"作者回复","user_name_real":"cy","uid":"1306094","ctime":1577619564,"ip_address":"","comment_id":73172,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1551835097","product_id":100021701,"comment_content":"k-means的原理是：先假定有要聚类个数个中心点，然后根据中心点对其余点分类。接着重新计算中心点，计算的时候采用取均值的方式，再重新划分中心点，再对其余点分类。以此类推<br># coding: utf-8<br>from sklearn.cluster import KMeans<br>from sklearn import preprocessing<br>import pandas as pd<br>import numpy as np<br># 输入数据<br>data = pd.read_csv(&#39;data1.csv&#39;, encoding=&#39;gbk&#39;)<br>train_x = data[[&quot;2019年国际排名&quot;,&quot;2018世界杯&quot;,&quot;2015亚洲杯&quot;]]<br>df = pd.DataFrame(train_x)<br>kmeans = KMeans(n_clusters=5)<br># 规范化到标准空间<br>ss = preprocessing.StandardScaler()<br>train_x = ss.fit_transform(train_x)<br># kmeans 算法<br>kmeans.fit(train_x)<br>predict_y = kmeans.predict(train_x)<br># 合并聚类结果，插入到原数据中<br>result = pd.concat((data,pd.DataFrame(predict_y)),axis=1)<br>result.rename({0:u&#39;聚类&#39;},axis=1,inplace=True)<br>print(result)<br>k-means分成5类在代码中体现为n_clusters=5，0-1标准化体现在StandardScaler<br><br>","like_count":0,"discussions":[{"author":{"id":1306094,"avatar":"https://static001.geekbang.org/account/avatar/00/13/ed/ee/c4779b67.jpg","nickname":"cy","note":"","ucode":"50D653399A31F6","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":441949,"discussion_content":"Good Job 加油","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1577619564,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":72461,"user_name":"fancy","can_delete":false,"product_type":"c1","uid":1243166,"ip_address":"","ucode":"0C51F80B9C35B1","user_header":"https://static001.geekbang.org/account/avatar/00/12/f8/1e/0d5f8336.jpg","comment_is_top":false,"comment_ctime":1551634057,"is_pvip":false,"replies":[{"id":"64471","content":"Good Job","user_name":"作者回复","user_name_real":"cy","uid":"1306094","ctime":1577619719,"ip_address":"","comment_id":72461,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1551634057","product_id":100021701,"comment_content":"K-Means算法原理：<br>1. 初始化K类，比如K=3，K1=中国，K2=日本，K3=韩国，所以，此时这三类的中心点分别为K1=(0.3,0.71428571,0.375)<br>K2=(0.2,0,0.25)<br>K3=(0.20769231,0.11428571,0.0624)<br>将每个国家看作一个点，此时这三个类别还是空的，不包含任何样本数据中的点<br>2. 计算样本数据中各点到初始化中心点的距离，每个点被分配到距离近的中心点所在的类别<br>3. 经过步骤2的计算分类后，现在K1，K2，K3中都包含了多个点，这时，分别计算每个类别中的所有点的特征值的平均值，将这个平均值作为新的中心点，这就是为什么叫K-Means；在这里，每个点含有三个特征，那么就要分别计算这三个特征值的平均值<br>4. 再次计算各点到新的中心点的距离，每个中心点代表的类别不变，还是中、日、韩三国。将点分类到距离近的那个类别<br>5. 重复3，4，直到各点所属类别不再发生变化，或者到达了max_iter所设置的最大迭代次数，停止。","like_count":0,"discussions":[{"author":{"id":1306094,"avatar":"https://static001.geekbang.org/account/avatar/00/13/ed/ee/c4779b67.jpg","nickname":"cy","note":"","ucode":"50D653399A31F6","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":441598,"discussion_content":"Good Job","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1577619719,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":71311,"user_name":"mickey","can_delete":false,"product_type":"c1","uid":1051663,"ip_address":"","ucode":"8B490C2DDE4010","user_header":"https://static001.geekbang.org/account/avatar/00/10/0c/0f/93d1c8eb.jpg","comment_is_top":false,"comment_ctime":1551318062,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1551318062","product_id":100021701,"comment_content":"# coding: utf-8<br>from sklearn.cluster import KMeans<br>from sklearn import preprocessing<br>import pandas as pd<br>import numpy as np<br><br># 输入数据<br>data = pd.read_csv(&#39;data.csv&#39;, encoding=&#39;gbk&#39;)<br><br>train_x = data[[u&quot;2019年国际排名&quot;, u&quot;2018世界杯&quot;, u&quot;2015亚洲杯&quot;]]<br>df = pd.DataFrame(train_x)<br><br>kmeans = KMeans(n_clusters=5)<br><br># 规范化采用标准化的方式（即均值为 0，方差为 1）<br>min_max_scaler = preprocessing.StandardScaler()<br>train_x = min_max_scaler.fit_transform(train_x)<br><br># kmeans算法<br>kmeans.fit(train_x)<br>predict_y = kmeans.predict(train_x)<br><br># 合并聚类结果，插入到原数据中<br>result = pd.concat((data, pd.DataFrame(predict_y)), axis=1)<br>result.rename({0: u&#39;聚类&#39;}, axis=1, inplace=True)<br>print(result)<br><br><br>        国家  2019年国际排名  2018世界杯  2015亚洲杯  聚类<br>0       中国       73.0     40.0      7.0   3<br>1       日本       60.0     15.0      5.0   1<br>2       韩国       61.0     19.0      2.0   1<br>3       伊朗       34.0     18.0      6.0   1<br>4       沙特       67.0     26.0     10.0   1<br>5      伊拉克       91.0     40.0      4.0   3<br>6      卡塔尔      101.0     40.0     13.0   0<br>7      阿联酋       81.0     40.0      6.0   3<br>8   乌兹别克斯坦       88.0     40.0      8.0   3<br>9       泰国      122.0     40.0     17.0   0<br>10      越南      102.0     50.0     17.0   0<br>11      阿曼       87.0     50.0     12.0   2<br>12      巴林      116.0     50.0     11.0   2<br>13      朝鲜      110.0     50.0     14.0   2<br>14      印尼      164.0     50.0     17.0   4<br>15      澳洲       40.0     30.0      1.0   1<br>16     叙利亚       76.0     40.0     17.0   0<br>17      约旦      118.0     50.0      9.0   2<br>18     科威特      160.0     50.0     15.0   4<br>19    巴勒斯坦       96.0     50.0     16.0   0","like_count":0},{"had_liked":false,"id":70396,"user_name":"liyooo","can_delete":false,"product_type":"c1","uid":1005581,"ip_address":"","ucode":"37F0D21CB9D142","user_header":"","comment_is_top":false,"comment_ctime":1551091985,"is_pvip":false,"replies":[{"id":"64504","content":"谢谢！","user_name":"作者回复","user_name_real":"cy","uid":"1306094","ctime":1577620174,"ip_address":"","comment_id":70396,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1551091985","product_id":100021701,"comment_content":"眼界大开！","like_count":0,"discussions":[{"author":{"id":1306094,"avatar":"https://static001.geekbang.org/account/avatar/00/13/ed/ee/c4779b67.jpg","nickname":"cy","note":"","ucode":"50D653399A31F6","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":440608,"discussion_content":"谢谢！","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1577620174,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":70255,"user_name":"TKbook","can_delete":false,"product_type":"c1","uid":1073829,"ip_address":"","ucode":"F6E0E99CC79059","user_header":"https://static001.geekbang.org/account/avatar/00/10/62/a5/43aa0c27.jpg","comment_is_top":false,"comment_ctime":1551060187,"is_pvip":false,"replies":[{"id":"64507","content":"Good Job","user_name":"作者回复","user_name_real":"cy","uid":"1306094","ctime":1577620191,"ip_address":"","comment_id":70255,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1551060187","product_id":100021701,"comment_content":"# 划分成 5 类<br>kmeans = KMeans(n_clusters=5)<br># Z-Score规范化<br>from sklearn.preprocessing import StandardScaler<br>standardscaler = StandardScaler()<br>train_x = standardscaler.fit_transform(train_x)<br>kmeans.fit(train_x)<br>predict_y = kmeans.predict(train_x)<br>result = pd.concat((data, pd.DataFrame(predict_y)), axis=1)<br>result.rename({0: &#39;聚类&#39;}, axis=1, inplace=True)<br>result<br>国家\t2019年国际排名\t2018世界杯\t2015亚洲杯\t聚类<br>0\t中国\t73\t40\t7\t3<br>1\t日本\t60\t15\t5\t1<br>2\t韩国\t61\t19\t2\t1<br>3\t伊朗\t34\t18\t6\t1<br>4\t沙特\t67\t26\t10\t1<br>5\t伊拉克\t91\t40\t4\t3<br>6\t卡塔尔\t101\t40\t13\t0<br>7\t阿联酋\t81\t40\t6\t3<br>8\t乌兹别克斯坦\t88\t40\t8\t3<br>9\t泰国\t122\t40\t17\t4<br>10\t越南\t102\t50\t17\t4<br>11\t阿曼\t87\t50\t12\t0<br>12\t巴林\t116\t50\t11\t0<br>13\t朝鲜\t110\t50\t14\t0<br>14\t印尼\t164\t50\t17\t2<br>15\t澳洲\t40\t30\t1\t1<br>16\t叙利亚\t76\t40\t17\t4<br>17\t约旦\t118\t50\t9\t0<br>18\t科威特\t160\t50\t15\t2<br>19\t巴勒斯坦\t96\t50\t16\t4<br>","like_count":0,"discussions":[{"author":{"id":1306094,"avatar":"https://static001.geekbang.org/account/avatar/00/13/ed/ee/c4779b67.jpg","nickname":"cy","note":"","ucode":"50D653399A31F6","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":440522,"discussion_content":"Good Job","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1577620191,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":69869,"user_name":"王彬成","can_delete":false,"product_type":"c1","uid":1015045,"ip_address":"","ucode":"386803B8FC2DD5","user_header":"https://static001.geekbang.org/account/avatar/00/0f/7d/05/4bad0c7c.jpg","comment_is_top":false,"comment_ctime":1550893316,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1550893316","product_id":100021701,"comment_content":"K-Means 的算法原理：<br>1、随机选择K个中心点<br>2、把每个数据点分配到离它最近的中心点；<br>3、重新计算每类中的点到该类中心点距离的平均值<br>4、分配每个数据到它最近的中心点；<br>5、重复步骤3和4，直到所有的观测值不再被分配或是达到最大的迭代次数<br># 采用 Z-Score规范化，并且划分为5类<br># coding:utf-8<br>from sklearn.cluster import KMeans<br>from sklearn import preprocessing<br>import pandas as pd<br>import numpy as np<br><br>#输入数据<br>data=pd.read_csv(&#39;.&#47;kmeans-master&#47;data.csv&#39;,encoding=&#39;gbk&#39;)<br>train_x=data[[&#39;2019年国际排名&#39;,&#39;2018世界杯&#39;,&#39;2015亚洲杯&#39;]]<br>df=pd.DataFrame(train_x)<br>kmeans=KMeans(n_clusters=5)<br><br># 采用 Z-Score规范化<br>ss=preprocessing.StandardScaler()<br>train_x=ss.fit_transform(train_x)<br><br># kmeans 算法<br>kmeans.fit(train_x)<br>predict_y=kmeans.predict(train_x)<br><br># 合并聚类结果，插入到原数据中<br>result=pd.concat((data,pd.DataFrame(predict_y)),axis=1)<br>result.rename({0:u&#39;聚类&#39;},axis=1,inplace=True)<br>print(result)<br>","like_count":0},{"had_liked":false,"id":68440,"user_name":"Chen","can_delete":false,"product_type":"c1","uid":1359478,"ip_address":"","ucode":"DBCC6C2A5D513E","user_header":"https://static001.geekbang.org/account/avatar/00/14/be/76/55e5e326.jpg","comment_is_top":false,"comment_ctime":1550500233,"is_pvip":false,"discussion_count":1,"race_medal":0,"score":"1550500233","product_id":100021701,"comment_content":"求教k-means可视化","like_count":0,"discussions":[{"author":{"id":1606706,"avatar":"http://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTKGRpeljInKj7fUQvwrB9v6kmTOkJlG9ghUoWCXquaDDFmtXeDrEL4p8Gscfx4ZmfeSs2GbZgwwibg/132","nickname":"GodlikeJy","note":"","ucode":"85291FA61A13B8","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":162488,"discussion_content":"pca 或者t-sne降维","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1580995302,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":68224,"user_name":"深白浅黑","can_delete":false,"product_type":"c1","uid":1123923,"ip_address":"","ucode":"DCCAA31DE8B127","user_header":"https://static001.geekbang.org/account/avatar/00/11/26/53/60fe31fb.jpg","comment_is_top":false,"comment_ctime":1550460590,"is_pvip":false,"replies":[{"id":"64543","content":"Good Job","user_name":"作者回复","user_name_real":"cy","uid":"1306094","ctime":1577621506,"ip_address":"","comment_id":68224,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1550460590","product_id":100021701,"comment_content":"kmean是无监督的聚类算法，先对K类数量进行设置，再设置K类的中心点，算法会自行在迭代过程中对中心点进行调整，按照各点与中心点的距离进行分类划分，直至分类不变。<br>比较适数据特征的归类。<br>        国家  2019年国际排名  2018世界杯  2015亚洲杯  聚类<br>0       中国         73       40        7   3<br>1       日本         60       15        5   1<br>2       韩国         61       19        2   1<br>3       伊朗         34       18        6   1<br>4       沙特         67       26       10   1<br>5      伊拉克         91       40        4   3<br>6      卡塔尔        101       40       13   0<br>7      阿联酋         81       40        6   3<br>8   乌兹别克斯坦         88       40        8   3<br>9       泰国        122       40       17   2<br>10      越南        102       50       17   2<br>11      阿曼         87       50       12   0<br>12      巴林        116       50       11   0<br>13      朝鲜        110       50       14   0<br>14      印尼        164       50       17   4<br>15      澳洲         40       30        1   1<br>16     叙利亚         76       40       17   2<br>17      约旦        118       50        9   0<br>18     科威特        160       50       15   4<br>19    巴勒斯坦         96       50       16   2","like_count":0,"discussions":[{"author":{"id":1306094,"avatar":"https://static001.geekbang.org/account/avatar/00/13/ed/ee/c4779b67.jpg","nickname":"cy","note":"","ucode":"50D653399A31F6","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":439573,"discussion_content":"Good Job","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1577621506,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":67965,"user_name":"切克闹","can_delete":false,"product_type":"c1","uid":1234713,"ip_address":"","ucode":"12EE07083CDA88","user_header":"https://static001.geekbang.org/account/avatar/00/12/d7/19/5ee3f996.jpg","comment_is_top":false,"comment_ctime":1550371394,"is_pvip":false,"replies":[{"id":"24812","content":"取特征值的平均值为中心点。","user_name":"编辑回复","user_name_real":"何昌梅","uid":"1165037","ctime":1550821995,"ip_address":"","comment_id":67965,"utype":2}],"discussion_count":1,"race_medal":0,"score":"1550371394","product_id":100021701,"comment_content":"K-Means中关于如何更新中心点，以及方式不太清楚","like_count":0,"discussions":[{"author":{"id":1165037,"avatar":"https://static001.geekbang.org/account/avatar/00/11/c6/ed/89a2dc13.jpg","nickname":"丢了个丢丢丢","note":"","ucode":"BDD7E97E0E5E96","race_medal":0,"user_type":4,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":439445,"discussion_content":"取特征值的平均值为中心点。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1550821995,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":4}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":67753,"user_name":"李沛欣","can_delete":false,"product_type":"c1","uid":1362695,"ip_address":"","ucode":"98874954230D95","user_header":"https://static001.geekbang.org/account/avatar/00/14/cb/07/e34220d6.jpg","comment_is_top":false,"comment_ctime":1550241560,"is_pvip":false,"replies":[{"id":"24813","content":"总结正确","user_name":"编辑回复","user_name_real":"何昌梅","uid":"1165037","ctime":1550822035,"ip_address":"","comment_id":67753,"utype":2}],"discussion_count":1,"race_medal":0,"score":"1550241560","product_id":100021701,"comment_content":"K-means是聚类算法，属于非监督式学习，K代表了类别数；<br><br>KNN 是分类算法，属于有监督式学习，K代表了K个抱团的邻居；<br><br>看到Kmeans总会想起被因子分析法支配的恐惧，哈哈😄","like_count":0,"discussions":[{"author":{"id":1165037,"avatar":"https://static001.geekbang.org/account/avatar/00/11/c6/ed/89a2dc13.jpg","nickname":"丢了个丢丢丢","note":"","ucode":"BDD7E97E0E5E96","race_medal":0,"user_type":4,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":439358,"discussion_content":"总结正确","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1550822035,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":4}","child_discussion_number":0,"child_discussions":[]}]}]}