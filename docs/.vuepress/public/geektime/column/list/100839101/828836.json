{"id":828836,"title":"13ï½œä»å¤´å®ç°ä¸€ä¸ªAgent","content":"<p>ä½ å¥½ï¼Œæˆ‘æ˜¯éƒ‘æ™”ï¼</p><p>ä¸Šä¸€è®²ï¼Œæˆ‘ä»¬å·²ç»ä»æ¦‚å¿µä¸Šäº†è§£äº† Agentã€‚ä½ ç°åœ¨çŸ¥é“ Agent å…¶å®ä¹Ÿæ˜¯ä¸€ä¸ªè½¯ä»¶ç³»ç»Ÿï¼Œåªä¸è¿‡ï¼Œå› ä¸ºæœ‰äº†å¤§æ¨¡å‹çš„åŠ æŒï¼Œå®ƒæœ‰äº†ä¸€ä¸ªå¯ä»¥åšâ€œè‡ªä¸»â€æ¨ç†çš„å¤§è„‘ï¼Œå®Œæˆå¾ˆå¤šâ€œæ™ºèƒ½â€çš„å·¥ä½œã€‚</p><p>è¿™ä¸€è®²ï¼Œæˆ‘ä»¬æ¥å®ç°ä¸€ä¸ª Agentã€‚ä¸åŒäºä¹‹å‰å€ŸåŠ© LangChainï¼Œè¿™æ¬¡æˆ‘ä»¬ä¼šç”¨æ›´åº•å±‚çš„æ–¹å¼å®ç°ä¸€ä¸ª Agentï¼Œå¸®åŠ©ä½ æ›´å¥½åœ°ç†è§£ Agent çš„è¿ä½œåŸç†ã€‚</p><p>æˆ‘ä»¬æ„å»ºè¿™ä¸ª Agent ä¼šåŸºäº ReAct æ¥å®ç°ï¼Œæˆ‘ä»¬åœ¨ <a href=\"https://time.geekbang.org/column/article/822235\">04 è®²</a>ä»‹ç»è¿‡ï¼ŒReAct è¡¨ç¤º Reasoning + Actingï¼Œä¹Ÿå°±æ˜¯æ¨ç†å’Œè¡ŒåŠ¨ã€‚é‡‡ç”¨è¿™ä¸ªæ¨¡å¼ï¼Œè¦ç»å†æ€è€ƒï¼ˆThoughtï¼‰ã€è¡ŒåŠ¨ï¼ˆActionï¼‰ã€è§‚å¯Ÿï¼ˆObservationï¼‰ä¸‰ä¸ªé˜¶æ®µã€‚</p><p>å¤§æ¨¡å‹ä¼šå…ˆæ€è€ƒè¦åšä»€ä¹ˆï¼Œå†³å®šé‡‡ç”¨æ€æ ·çš„è¡ŒåŠ¨ï¼Œç„¶ååœ¨ç¯å¢ƒä¸­æ‰§è¡Œè¿™ä¸ªè¡ŒåŠ¨ï¼Œè¿”å›ä¸€ä¸ªè§‚å¯Ÿç»“æœã€‚æœ‰äº†è¿™ä¸ªè§‚å¯Ÿç»“æœï¼Œå¤§æ¨¡å‹å°±ä¼šé‡å¤æ€è€ƒçš„è¿‡ç¨‹ï¼Œå†æ¬¡è€ƒè™‘è¦åšä»€ä¹ˆï¼Œé‡‡ç”¨æ€æ ·çš„è¡ŒåŠ¨ï¼Œè¿™ä¸ªè¿‡ç¨‹ä¼šæŒç»­åˆ°å¤§æ¨¡å‹å†³å®šè¿™ä¸ªè¿‡ç¨‹ç»“æŸä¸ºæ­¢ã€‚</p><p>æˆ‘ä»¬çš„å®ç°ä»£ç å‚è€ƒäº† Simon Willison çš„ä¸€ç¯‡<a href=\"https://til.simonwillison.net/llms/python-react-pattern\">æ–‡ç« </a>ï¼Œè¿™ç¯‡æ–‡ç« ä»‹ç»äº†å¦‚ä½•ç”¨ Python å®ç° ReAct æ¨¡å¼ã€‚</p><h2>åŸºç¡€çš„èŠå¤©æœºå™¨äºº</h2><p>æˆ‘ä»¬å…ˆæ¥å®ç°ä¸€ä¸ªåŸºç¡€çš„èŠå¤©æœºå™¨äººï¼š</p><pre><code class=\"language-python\">from openai import OpenAI\n\nDEFAULT_MODEL = \"gpt-4o-mini\"\nclient = OpenAI()\n\nclass Agent:\n    def __init__(self, system=\"\"):\n        self.system = system\n        self.messages = []\n        if self.system:\n            self.messages.append({\"role\": \"system\", \"content\": system})\n\n    def invoke(self, message):\n        self.messages.append({\"role\": \"user\", \"content\": message})\n        result = self.execute()\n        self.messages.append({\"role\": \"assistant\", \"content\": result})\n        return result\n\n    def execute(self):\n        completion = client.chat.completions.create(\n            model=DEFAULT_MODEL,\n            messages=self.messages,\n            temperature=0\n        )\n        return completion.choices[0].message.content\n</code></pre><!-- [[[read_end]]] --><p>æˆ‘ä»¬é‡‡ç”¨äº†ç›´æ¥çš„ OpenAI Python åº“å®ç°ï¼š</p><ul>\n<li>\n<p>åˆå§‹åŒ–çš„æ—¶å€™ï¼Œæˆ‘ä»¬å¯ä»¥ä¼ å…¥ç³»ç»Ÿæç¤ºè¯ç»™è¿™ä¸ª Agent åšä¸€äº›åˆå§‹çš„è®¾å®šã€‚ <code>messages</code> æ˜¯æˆ‘ä»¬ç»´æŠ¤çš„å†å²æ¶ˆæ¯åˆ—è¡¨ï¼Œå¦‚æœè®¾å®šäº†ç³»ç»Ÿæç¤ºè¯ï¼Œå°±æŠŠå®ƒåŠ åˆ°å†å²æ¶ˆæ¯é‡Œã€‚</p>\n</li>\n<li>\n<p><code>invoke</code> æ˜¯ä¸»è¦çš„å¯¹å¤–æ¥å£ã€‚è°ƒç”¨ä¹‹å‰ï¼Œæˆ‘ä»¬æŠŠæ¶ˆæ¯å­˜æ”¾åˆ°å†å²æ¶ˆæ¯é‡Œï¼Œç­‰åˆ°è°ƒç”¨å¤§æ¨¡å‹ä¹‹åï¼Œå†æŠŠåº”ç­”å­˜æ”¾åˆ°å†å²æ¶ˆæ¯é‡Œã€‚</p>\n</li>\n<li>\n<p><code>execute</code> å¤„ç†äº†è¯·æ±‚å¤§æ¨¡å‹çš„è¿‡ç¨‹ï¼Œæ¨¡å‹å’Œæ¶ˆæ¯éƒ½æ¯”è¾ƒå¥½ç†è§£ã€‚<code>temperature</code> çš„å€¼æ˜¯ 0ï¼Œå› ä¸ºè¿™é‡Œç”¨åˆ°çš„æ˜¯å¤§æ¨¡å‹çš„æ¨ç†è¿‡ç¨‹ï¼Œæ‰€ä»¥ï¼Œæˆ‘ä»¬å¸Œæœ›ç¡®å®šæ€§å¼ºä¸€äº›ã€‚å¦å¤–ï¼Œè¿™é‡Œæˆ‘ä»¬ä½¿ç”¨äº†åŒæ­¥å¤„ç†ï¼Œå› ä¸ºæˆ‘ä»¬è¿™é‡Œæ˜¯æŠŠå¤§æ¨¡å‹å½“ä½œæ¨ç†å¼•æ“ï¼Œéœ€è¦ç­‰å¾…æ‰€æœ‰çš„å†…å®¹å›æ¥ã€‚</p>\n</li>\n</ul><p>æœ‰äº†å‰é¢çš„åŸºç¡€ï¼Œè¿™æ®µä»£ç åº”è¯¥æ¯”è¾ƒå®¹æ˜“ç†è§£ï¼Œä½†æˆ‘ä»¬ä¹Ÿèƒ½çœ‹åˆ°è¿™æ®µä»£ç å­˜åœ¨çš„é—®é¢˜ï¼Œæ¯”å¦‚å†å²æ¶ˆæ¯ä¼šæ— é™è†¨èƒ€ã€‚æ‰€ä»¥ï¼Œå®ƒåªæ˜¯ä¸€æ®µç¤ºä¾‹ä»£ç ï¼Œä¸èƒ½ç”¨åœ¨ç”Ÿäº§é‡Œã€‚</p><h2>ReAct æç¤ºè¯</h2><p>è¦åˆ›å»ºä¸€ä¸ªåŸºäº ReAct çš„ Agentï¼Œå…³é”®æ˜¯è¦æœ‰ä¸€ä¸ªç‰¹å®šçš„æç¤ºè¯ã€‚ä¸‹é¢æ˜¯æˆ‘ä»¬è¿™ä¸ªä¾‹å­é‡Œçš„æç¤ºè¯ï¼š</p><pre><code class=\"language-python\">prompt = \"\"\"\nYou run in a loop of Thought, Action, PAUSE, Observation.\nAt the end of the loop you output an Answer\nUse Thought to describe your thoughts about the question you have been asked.\nUse Action to run one of the actions available to you - then return PAUSE.\nObservation will be the result of running those actions.\n\nYour available actions are:\n\ncalculate:\ne.g. calculate: 4 * 7 / 3\nRuns a calculation and returns the number - uses Python so be sure to use floating point syntax if necessary\n\nask_fruit_unit_price:\ne.g. ask_fruit_unit_price: apple\nAsks the user for the price of a fruit\n\nExample session:\n\nQuestion: What is the unit price of apple?\nThought: I need to ask the user for the price of an apple to provide the unit price. \nAction: ask_fruit_unit_price: apple\nPAUSE\n\nYou will be called again with this:\n\nObservation: Apple unit price is 10/kg\n\nYou then output:\n\nAnswer: The unit price of apple is 10 per kg.\n\"\"\".strip()\n</code></pre><p>è¿™æ®µæç¤ºè¯åˆ†æˆäº†ä¸‰ä¸ªéƒ¨åˆ†ï¼ŒReAct æè¿°ã€å¯ç”¨çš„åŠ¨ä½œå’Œç¤ºä¾‹ã€‚</p><p>ReAct æè¿°ï¼Œç»™å¤§æ¨¡å‹è§£é‡Šäº†ReAct çš„ä¸‰ä¸ªé˜¶æ®µï¼šæ€è€ƒï¼ˆThoughtï¼‰ã€è¡ŒåŠ¨ï¼ˆActionï¼‰ã€è§‚å¯Ÿï¼ˆObservationï¼‰ã€‚è¿™é‡Œè¿˜å¤šäº†ä¸€ä¸ªæš‚åœï¼ˆPauseï¼‰ï¼Œå…¶ä¸»è¦çš„ç›®çš„å°±æ˜¯åœä¸‹æ¥ï¼Œè¿™æ—¶æ‰§è¡Œæµç¨‹å°±å›åˆ°æˆ‘ä»¬è¿™é‡Œï¼Œæ‰§è¡Œç›¸åº”çš„åŠ¨ä½œã€‚å½“åŠ¨ä½œæ‰§è¡Œå®Œæ¯•ï¼Œå†æŠŠæ§åˆ¶æƒè¿”å›ç»™å¤§æ¨¡å‹ã€‚</p><pre><code class=\"language-plain\">You run in a loop of Thought, Action, PAUSE, Observation.\nAt the end of the loop you output an Answer\nUse Thought to describe your thoughts about the question you have been asked.\nUse Action to run one of the actions available to you - then return PAUSE.\nObservation will be the result of running those actions.\n</code></pre><p>å¯ç”¨çš„åŠ¨ä½œï¼Œå‘Šè¯‰å¤§æ¨¡å‹åœ¨æ€è€ƒçš„æ—¶å€™å¯ä»¥ç»“åˆå“ªäº›åŠ¨ä½œæ¥å®Œæˆå·¥ä½œã€‚ä¸ºäº†ç®€åŒ–ï¼Œæˆ‘ä»¬è¿™é‡Œåªè®¾è®¡äº†ä¸¤ä¸ªåŠ¨ä½œï¼Œä¸€ä¸ªæ˜¯è®¡ç®—ï¼Œæ ¹æ®ä¸€ä¸ªç®—å¼å¾—åˆ°ä¸€ä¸ªç»“æœï¼›å¦ä¸€ä¸ªæ˜¯è¯¢é—®æ°´æœä»·æ ¼ã€‚è¿™æ ·ï¼Œå¤§æ¨¡å‹æ€è€ƒçš„ç»“æœå°±å¯ä»¥æ˜¯è®©æˆ‘ä»¬æ‰§è¡Œä¸€ä¸ªå…·ä½“çš„åŠ¨ä½œã€‚</p><pre><code class=\"language-plain\">Your available actions are:\n\ncalculate:\ne.g. calculate: 4 * 7 / 3\nRuns a calculation and returns the number - uses Python so be sure to use floating point syntax if necessary\n\nask_fruit_unit_price:\ne.g. ask_fruit_unit_price: apple\nAsks the user for the price of a fruit\n</code></pre><p>æœ€åæ˜¯ä¸€ä¸ªç¤ºä¾‹ï¼Œå±•ç°äº†ä¸€ä¸ªå®Œæ•´çš„æ€è€ƒè¿‡ç¨‹ã€‚ä»é—®é¢˜å¼€å§‹ï¼Œå¤§æ¨¡å‹ç»™å‡ºäº†æ€æ ·çš„æ€è€ƒï¼Œåšå‡ºäº†å“ªäº›åŠ¨ä½œï¼Œç„¶åå°†è§‚å¯Ÿç»“æœè¿”å›ç»™å¤§æ¨¡å‹ï¼Œæœ€ç»ˆå¤§æ¨¡å‹ç»™å‡ºäº†è¾“å‡ºã€‚è¿™é‡Œç»™å‡ºçš„ç¤ºä¾‹ï¼Œæ˜¯ä¸ºäº†ä¾›å¤§æ¨¡å‹æ›´å¥½åœ°å‚è€ƒï¼Œè¿˜è®°å¾—æˆ‘ä»¬åœ¨æç¤ºå·¥ç¨‹ä¸­è®²è¿‡çš„å°‘æ ·æœ¬æç¤ºå—ï¼Ÿè¿™ä¸ªæç¤ºè¯å°±æ˜¯ ReAct å’Œå°‘æ ·æœ¬æç¤ºçš„ç»“åˆã€‚</p><pre><code class=\"language-plain\">Example session:\n\nQuestion: What is the unit price of apple?\nThought: I need to ask the user for the price of an apple to provide the unit price. \nAction: ask_fruit_unit_price: apple\nPAUSE\n\nYou will be called again with this:\n\nObservation: Apple unit price is 10/kg\n\nYou then output:\n\nAnswer: The unit price of apple is 10 per kg.\n</code></pre><h2>åŠ¨ä½œ</h2><p>åœ¨æç¤ºè¯é‡Œï¼Œæˆ‘ä»¬ç»™å‡ºäº†å¯ç”¨çš„åŠ¨ä½œï¼Œè¿™æ˜¯æˆ‘ä»¬è¦å®ç°çš„ä»£ç ã€‚å¤§æ¨¡å‹ä¼šå‘Šè¯‰æˆ‘ä»¬è¦åšä»€ä¹ˆåŠ¨ä½œï¼Œä½†å…·ä½“æ€æ ·åšæ˜¯æˆ‘ä»¬çš„äº‹æƒ…ã€‚ä¸‹é¢æ˜¯ä¸¤ä¸ªåŠ¨ä½œçš„å®ç°ï¼š</p><pre><code class=\"language-python\">def calculate(what):\n    return eval(what)\n\n\ndef ask_fruit_unit_price(fruit):\n    if fruit.casefold() == \"apple\":\n        return \"Apple unit price is 10/kg\"\n    elif fruit.casefold() == \"banana\":\n        return \"Banana unit price is 6/kg\"\n    else:\n        return \"{} unit price is 20/kg\".format(fruit)\n</code></pre><p><code>calculate</code> é‡‡ç”¨äº† Python æœ¬èº«çš„ eval æœºåˆ¶å®ç°ï¼Œè€Œ <code>ask_fruit_unit_price</code> åˆ™å®ç°äº†ä¸åŒæ°´æœä»·æ ¼ã€‚å¦‚ä½ æ‰€è§ï¼Œè¿™ä¸¤ä¸ªå‡½æ•°éƒ½å¾ˆç®€å•ï¼Œä½†å®ƒä»¬æ€æ ·å®ç°å¹¶ä¸é‡è¦ï¼Œé‡ç‚¹æ˜¯æˆ‘ä»¬æœ‰äº†ä¸€ä¸ªæ¥å£å»å®ç°è‡ªå·±çš„æœºåˆ¶ï¼Œæˆ‘ä»¬å¯ä»¥è°ƒç”¨ä¸€äº›å¤–éƒ¨ API å»æŸ¥è¯¢ä¹Ÿå¥½ï¼Œå»æ‰§è¡Œä¸€ä¸ªæ“ä½œä¹Ÿç½¢ï¼Œè¿™æ ·ï¼ŒAgent å°±èƒ½è·³å‡ºå¤§æ¨¡å‹æœ¬èº«çš„é™åˆ¶äº†ã€‚æ‰€ä»¥ï¼Œ<strong>åŠ¨ä½œä»£ç æ˜¯æˆ‘ä»¬å‘æŒ¥æƒ³è±¡åŠ›çš„é‡è¦ä¸€ç¯ã€‚</strong></p><h2>ç»„åˆèµ·æ¥</h2><p>æˆ‘ä»¬è¦å®ç° Agent çš„åŸºç¡€ç»„ä»¶éƒ½æœ‰äº†ï¼Œæ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬å°±æŠŠå®ƒä»¬ç»„åˆåˆ°ä¸€èµ·ã€‚</p><pre><code class=\"language-python\">action_re = re.compile(r'^Action: (\\w+): (.*)$')\n\nknown_actions = {\n    \"calculate\": calculate,\n    \"ask_fruit_unit_price\": ask_fruit_unit_price\n}\n\ndef query(question, max_turns=5):\n    i = 0\n    agent = Agent(prompt)\n    next_prompt = question\n    while i &lt; max_turns:\n        i += 1\n        result = agent.invoke(next_prompt)\n        print(result)\n        actions = [action_re.match(a) for a in result.split('\\n') if action_re.match(a)]\n        if actions:\n            # There is an action to run\n            action, action_input = actions[0].groups()\n            if action not in known_actions:\n                raise Exception(\"Unknown action: {}: {}\".format(action, action_input))\n            print(\" -- running {} {}\".format(action, action_input))\n            observation = known_actions[action](action_input)\n            print(\"Observation:\", observation)\n            next_prompt = \"Observation: {}\".format(observation)\n        else:\n            return\n</code></pre><p>è¿™é‡Œæˆ‘ä»¬å®ç°äº†ä¸€ä¸ª <code>query</code> å‡½æ•°ï¼Œå…¶æ ¸å¿ƒæ˜¯ä¸€ä¸ªå¾ªç¯ã€‚æ¯æ¬¡å¾ªç¯æˆ‘ä»¬éƒ½ä¼šè¯¢é—®å¤§æ¨¡å‹ï¼Œèµ·å§‹çš„æç¤ºè¯å°±æ˜¯ç”¨æˆ·çš„é—®é¢˜ã€‚æ¯æ¬¡è¯¢é—®çš„ç»“æœï¼Œæˆ‘ä»¬ä¼šå…ˆä»é‡Œé¢åˆ†æå‡ºè¦æ‰§è¡Œçš„åŠ¨ä½œï¼Œè¿™é‡Œé‡‡ç”¨äº†æ­£åˆ™è¡¨è¾¾å¼ç›´æ¥åŒ¹é…æ–‡æœ¬ï¼š</p><pre><code class=\"language-python\">action_re = re.compile(r'^Action: (\\w+): (.*)$')\n\nactions = [action_re.match(a) for a in result.split('\\n') if action_re.match(a)]\n</code></pre><p>å¦‚æœå­˜åœ¨è¦æ‰§è¡Œçš„åŠ¨ä½œï¼Œæˆ‘ä»¬å°±æ¥æ‰§è¡Œè¿™ä¸ªåŠ¨ä½œã€‚åœ¨ç»“æœä¸­æ‹†åˆ†å‡ºåŠ¨ä½œåŠå…¶è¾“å‡ºï¼Œç„¶åï¼Œå»æ‰§è¡Œï¼š</p><pre><code class=\"language-python\">action, action_input = actions[0].groups()\nobservation = known_actions[action](action_input)\n</code></pre><p>æœ€åï¼Œå†æŠŠæ‰§è¡Œçš„ç»“æœä½œä¸ºè§‚å¯Ÿç»“æœï¼Œå‘é€ç»™å¤§æ¨¡å‹è¿›è¡Œä¸‹ä¸€è½®çš„è¯¢é—®ï¼š</p><pre><code class=\"language-python\">next_prompt = \"Observation: {}\".format(observation)\n</code></pre><p>ä¸‡äº‹ä¿±å¤‡ï¼Œæˆ‘ä»¬æ¥æ‰§è¡Œä¸€ä¸‹ã€‚æˆ‘ä»¬é—®ä¸€ä¸ªé—®é¢˜ï¼š3 åƒå…‹è‹¹æœå’Œ 2 åƒå…‹é¦™è•‰ä¸€å…±å¤šå°‘é’±ï¼Ÿ</p><pre><code class=\"language-python\">query(\"What is the total price of 3kg of apple and 2kg of banana?\")\n</code></pre><p>Agent è¾“å‡ºçš„ç»“æœå¦‚ä¸‹ï¼š</p><pre><code class=\"language-plain\">Thought: To find the total price, I need to know the price per kilogram of both apples and bananas. I will ask for the price of each fruit.&nbsp;\n\nAction: ask_fruit_unit_price: apple\nPAUSE\n&nbsp;-- running ask_fruit_unit_price apple\nObservation: Apple unit price is 10/kg\nThought: Now that I have the price for apples, I need to ask for the price of bananas to calculate the total price for 1 kg of apples and 2 kg of bananas.\n\nAction: ask_fruit_unit_price: banana\nPAUSE\n&nbsp;-- running ask_fruit_unit_price banana\nObservation: Banana unit price is 6/kg\nThought: I now have the prices for both fruits. The price of apples is 10/kg and the price of bananas is 6/kg. I can calculate the total price for 1 kg of apples and 2 kg of bananas.\n\nAction: calculate: 1 * 10 + 2 * 6\nPAUSE\n&nbsp;-- running calculate 1 * 10 + 2 * 6\nObservation: 22\nAnswer: The total price of 1 kg of apples and 2 kg of bananas is 22.\n</code></pre><p>æˆ‘ä»¬çœ‹ä¸€ä¸‹è¾“å‡ºçš„è¿‡ç¨‹ï¼š</p><ul>\n<li>\n<p>ç¬¬ä¸€æ­¥çš„æ€è€ƒæ˜¯è¦è®¡ç®—æ€»ä»·ï¼Œé‚£ä¹ˆå°±éœ€è¦å…ˆçŸ¥é“å•ä»·ã€‚æ‰€ä»¥ï¼Œç¬¬ä¸€ä¸ªåŠ¨ä½œæ˜¯è¯¢é—®è‹¹æœçš„ä»·æ ¼ã€‚</p>\n</li>\n<li>\n<p>æˆ‘ä»¬æ‰§è¡Œ <code>ask_fruit_unit_price</code> è¿™ä¸ªåŠ¨ä½œï¼Œå…¶å‚æ•°æ˜¯ appleã€‚æˆ‘ä»¬å¾—åˆ°è‹¹æœå•ä»·ä¹‹åï¼Œå†æŠŠå®ƒä½œä¸ºè§‚å¯Ÿç»“æœï¼Œå‘é€ç»™å¤§æ¨¡å‹ã€‚</p>\n</li>\n<li>\n<p>ç¬¬äºŒæ­¥çš„æ€è€ƒæ˜¯ï¼Œå·²çŸ¥è‹¹æœä»·æ ¼ï¼Œè¦è®¡ç®—æ€»ä»·è¿˜è¦å¾—åˆ°é¦™è•‰ä»·æ ¼ã€‚</p>\n</li>\n<li>\n<p>æˆ‘ä»¬æ‰§è¡Œ <code>ask_fruit_unit_price</code> è¿™ä¸ªåŠ¨ä½œï¼Œå…¶å‚æ•°æ˜¯ bananaï¼ŒåŒæ ·ï¼ŒæŠŠå•ä»·ä½œä¸ºè§‚å¯Ÿç»“æœè¿”å›ç»™å¤§æ¨¡å‹ã€‚</p>\n</li>\n<li>\n<p>ç¬¬ä¸‰æ­¥çš„æ€è€ƒæ˜¯ï¼Œä¸¤ä¸ªå•ä»·éƒ½æœ‰äº†ï¼Œå°±å¯ä»¥è®¡ç®—æ€»ä»·äº†ï¼Œè°ƒç”¨ <code>calculate</code> è¿™ä¸ªåŠ¨ä½œï¼Œå‚æ•°æ˜¯ä¸€ä¸ªè¡¨è¾¾å¼ï¼š1 * 10 + 2 * 6ã€‚</p>\n</li>\n<li>\n<p>æˆ‘ä»¬æ‰§è¡Œè¿™ä¸ªè®¡ç®—ï¼Œå¾—åˆ°ç»“æœæ˜¯ 22ï¼ŒæŠŠå®ƒè¿”å›ç»™å¤§æ¨¡å‹ã€‚</p>\n</li>\n<li>\n<p>æœ€åçš„æ€è€ƒæ˜¯ï¼Œå·²ç»å¾—åˆ°ç­”æ¡ˆï¼Œæ— éœ€ç»§ç»­æ‰§è¡Œäº†ï¼ŒæŠŠç»“æœè¿”å›å›æ¥ã€‚</p>\n</li>\n</ul><p>ç»è¿‡å››è½®çš„è¯¢é—®ï¼Œæˆ‘ä»¬æœ€ç»ˆå¾—åˆ°äº†ä¸€ä¸ªç­”æ¡ˆã€‚å¯ä»¥çœ‹åˆ°åœ¨è¿™ä¸ªè¿‡ç¨‹ä¸­ï¼Œæˆ‘ä»¬å®Œå…¨æ²¡æœ‰å‚ä¸ï¼Œéƒ½æ˜¯å¤§æ¨¡å‹è‡ªå·±æ€è€ƒè¯¥å¹²ä»€ä¹ˆï¼Œç„¶åæ‰§è¡Œç›¸åº”çš„åŠ¨ä½œï¼Œè¿™å°±æ˜¯å¾ˆå¤šäººæ‰€è¯´çš„â€œè‡ªä¸»â€ï¼ˆAutonomousï¼‰ã€‚</p><p>å½“ç„¶ï¼Œè¿™æ˜¯ä¸€ä¸ªæ¯”è¾ƒç®€å•çš„é—®é¢˜ï¼Œå¦‚æœé—®é¢˜å¤æ‚ï¼Œå¯èƒ½è½®æ•°ä¼šå¤§å¹…åº¦å¢åŠ ï¼Œæç«¯æƒ…å†µä¸‹ï¼Œç”šè‡³ä¼šå‡ºç°æ— æ³•æ”¶æ•›çš„æƒ…å†µï¼Œä¹Ÿå°±æ˜¯ä¸€è½®ä¸€è½®åœ°ä¸æ–­é—®ä¸‹å»ï¼Œè¿™ä¼šé€ æˆæå¤§çš„æˆæœ¬æ¶ˆè€—ã€‚æ‰€ä»¥ï¼Œåœ¨è®¾è®¡ Agent çš„æ—¶å€™ä¼šé™åˆ¶æœ€å¤§è¯¢é—®æ¬¡æ•°ï¼Œ <code>query</code> å‡½æ•°çš„ <code>max_turns</code>  å‚æ•°å°±æ˜¯åšè¿™ä¸ªé™åˆ¶çš„ã€‚</p><p>å¥½äº†ï¼Œåˆ°è¿™é‡Œï¼Œä½ åº”è¯¥å¯¹å¦‚ä½•å®ç°ä¸€ä¸ª Agent æœ‰äº†ä¸€ä¸ªåˆæ­¥çš„äº†è§£ã€‚ä¸Šé¢çš„ä»£ç å¯¹äºä»»ä½•ä¸€ä¸ªç¨‹åºå‘˜æ¥è¯´éƒ½å¯ä»¥è½»æ¾ç†è§£ã€‚æˆ‘ä»¬çš„é‡ç‚¹æ˜¯äº†è§£åœ¨è¿™ä¸ªè¿‡ç¨‹ä¸­ï¼Œä»£ç æ˜¯å¦‚ä½•ä¸å¤§æ¨¡å‹é…åˆçš„ï¼Œæ¯”å¦‚ï¼Œæˆ‘ä»¬ä¹‹æ‰€ä»¥èƒ½æ‰¾åˆ°æ‰§è¡Œçš„åŠ¨ä½œåŠå…¶å‚æ•°ï¼Œæ˜¯å› ä¸ºæˆ‘ä»¬ç»™å¤§æ¨¡å‹çš„æç¤ºè¯é‡Œå¯¹è¾“å‡ºæäº†è¦æ±‚ã€‚å†æ¯”å¦‚ï¼Œå¤§æ¨¡å‹ä¹‹æ‰€ä»¥èƒ½å¤Ÿä¸æ–­åœ°æ€è€ƒï¼Œæ˜¯å› ä¸ºæˆ‘ä»¬æŠŠèŠå¤©å†å²ä¼ ç»™äº†å¤§æ¨¡å‹ï¼Œè®©å®ƒå¯¹å½“å‰çš„ä¸Šä¸‹æ–‡æœ‰äº†ç†è§£ã€‚</p><p>å¸Œæœ›ä½ å¯ä»¥èŠ±æ—¶é—´æ…¢æ…¢ä½“ä¼šå¤§æ¨¡å‹ä¸ä»£ç ä¹‹é—´çš„è¿™äº›äº’åŠ¨ã€‚è™½ç„¶è¿™ä¸ªä¾‹å­å¾ˆç®€å•ï¼Œä½†å®ƒå¾ˆé€‚åˆä½œä¸ºæˆ‘ä»¬ç†è§£å¤§æ¨¡å‹ç¼–ç¨‹çš„åŸºç¡€ã€‚</p><p>æœ‰äº†è¿™ä¸ªç®€å•çš„ä¾‹å­ä½œä¸ºåŸºç¡€ï¼Œå½“æˆ‘ä»¬å†å»çœ‹æ›´å¤æ‚çš„ Agent æ—¶ï¼Œå°±æ›´èƒ½ç†è§£èƒŒåçš„è¿ä½œæœºåˆ¶ï¼Œè€Œä¸è‡´äºè¿·å¤±å…¶ä¸­äº†ã€‚</p><h2>æ€»ç»“æ—¶åˆ»</h2><p>è¿™ä¸€è®²ï¼Œæˆ‘ä»¬æŠ›å¼€äº† LangChainï¼Œç”¨æ›´åº•å±‚çš„æ–¹å¼å®ç°äº†ä¸€ä¸ªåŸºäº ReAct æ¡†æ¶çš„ Agentã€‚æˆ‘ä»¬çœ‹åˆ°äº†å¦‚ä½•ç¼–å†™ä¸€ä¸ª ReAct æç¤ºè¯ï¼Œè®©å¤§æ¨¡å‹é€šè¿‡æ€è€ƒï¼ˆThoughtï¼‰ã€è¡ŒåŠ¨ï¼ˆActionï¼‰ã€è§‚å¯Ÿï¼ˆObservationï¼‰æ¥å®Œæˆæ›´å¤šçš„å·¥ä½œã€‚</p><p>åœ¨æˆ‘ä»¬è¿™ä¸ªä¾‹å­é‡Œï¼Œè§„åˆ’æ˜¯é€šè¿‡ ReAct æç¤ºè¯å®Œæˆçš„ï¼Œè®°å¿†æ˜¯é€šè¿‡èŠå¤©å†å²å®ç°çš„ï¼Œè€ŒåŠ¨ä½œåˆ™æ˜¯é€šè¿‡ä¸€ä¸ªä¸€ä¸ªçš„å‡½æ•°å®ç°çš„ã€‚</p><p>å¦‚æœä»Šå¤©çš„å†…å®¹ä½ åªèƒ½è®°ä½ä¸€ä»¶äº‹ï¼Œé‚£è¯·è®°ä½ï¼Œ<strong>Agent çš„æ‰§è¡Œè¿‡ç¨‹æœ¬è´¨ä¸Šå°±æ˜¯ä¸€ä¸ªå¾ªç¯ï¼Œç”±å¤§æ¨¡å‹å¼•å¯¼ç€ä¸€æ¬¡æ¬¡åœ°åšç€å„ç§åŠ¨ä½œï¼Œä»¥è¾¾æˆæˆ‘ä»¬çš„ç›®æ ‡</strong>ã€‚</p><h2>ç»ƒä¹ é¢˜</h2><p>å°è¯•ä¿®æ”¹æˆ‘æä¾›çš„ä¾‹å­ï¼Œç»™å®ƒå¢åŠ ä¸€äº›åŠ¨ä½œï¼Œè®©è¿™ä¸ª Agent å®ç°æ›´å¤šçš„èƒ½åŠ›ã€‚æ¬¢è¿åœ¨ç•™è¨€åŒºåˆ†äº«ä½ çš„æ”¹é€ å¿ƒå¾—ã€‚</p>","neighbors":{"left":{"article_title":"12ï½œAgentï¼šä»èŠå¤©åˆ°å·¥ä½œ","id":828105},"right":{"article_title":"14ï½œç”¨LangChainå®ç°ä¸€ä¸ªAgent","id":829302}},"comments":[{"had_liked":false,"id":396049,"user_name":"hellotong","can_delete":false,"product_type":"c1","uid":1214401,"ip_address":"åŒ—äº¬","ucode":"7393E125EA520E","user_header":"https://static001.geekbang.org/account/avatar/00/12/87/c1/e9e688c2.jpg","comment_is_top":false,"comment_ctime":1732840857,"is_pvip":false,"replies":[{"id":143953,"content":"å¯ä»¥åˆ†äº«ç»™ä½ çš„æœ‹å‹","user_name":"ä½œè€…å›å¤","user_name_real":"ç¼–è¾‘","uid":1258861,"ctime":1734960451,"ip_address":"é™•è¥¿","comment_id":396049,"utype":1}],"discussion_count":1,"race_medal":0,"score":2,"product_id":100839101,"comment_content":"æ·±å…¥æµ…å‡ºğŸ‘","like_count":1,"discussions":[{"author":{"id":1258861,"avatar":"https://static001.geekbang.org/account/avatar/00/13/35/6d/07a42f81.jpg","nickname":"éƒ‘æ™”","note":"","ucode":"1EBD5AA5D4FC89","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":655454,"discussion_content":"å¯ä»¥åˆ†äº«ç»™ä½ çš„æœ‹å‹","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1734960451,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"é™•è¥¿","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2,\"source\":0}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":396081,"user_name":"grok","can_delete":false,"product_type":"c1","uid":1341502,"ip_address":"ç¾å›½","ucode":"4744AB3FA28FE2","user_header":"https://static001.geekbang.org/account/avatar/00/14/78/3e/f60ea472.jpg","comment_is_top":false,"comment_ctime":1732988711,"is_pvip":false,"replies":null,"discussion_count":0,"race_medal":0,"score":2,"product_id":100839101,"comment_content":"æŒºå¥½ç©çš„ï¼š\n```\nquery(&quot;ä¸‰å…¬æ–¤è‹¹æœå’Œä¸¤å…¬æ–¤é¦™è•‰çš„æ€»ä»·ï¼Ÿ&quot;)\n---\nThought: To calculate the total price of three kilograms of apples and two kilograms of bananas, I first need to know the unit price of each fruit.\n\nAction: ask_fruit_unit_price: apple\nPAUSE\n -- running ask_fruit_unit_price apple\nObservation: Apple unit price is 10&#47;kg\nThought: Now that I have the price of apples, I need to ask for the price of bananas to proceed with the calculation.\n\nAction: ask_fruit_unit_price: banana\nPAUSE\n -- running ask_fruit_unit_price banana\nObservation: Banana unit price is 6&#47;kg\nThought: I now have the unit prices for both apples and bananas. I can calculate the total price by multiplying the quantity of each fruit by its unit price and then summing these amounts.\n\nAction: calculate: 3 * 10 + 2 * 6\nPAUSE\n -- running calculate 3 * 10 + 2 * 6\nObservation: 42\nAnswer: ä¸‰å…¬æ–¤è‹¹æœå’Œä¸¤å…¬æ–¤é¦™è•‰çš„æ€»ä»·æ˜¯42å…ƒã€‚\n```\n\næœ¬èŠ‚ä»£ç åœ¨æ­¤ï¼šhttps:&#47;&#47;github.com&#47;groklab&#47;misc&#47;blob&#47;main&#47;geektime-llm-zhengye-column&#47;lec13.ipynb","like_count":2},{"had_liked":false,"id":396056,"user_name":"willmyc","can_delete":false,"product_type":"c1","uid":1016703,"ip_address":"å¹¿ä¸œ","ucode":"486B28F89DFBEA","user_header":"https://static001.geekbang.org/account/avatar/00/0f/83/7f/7b1f3f68.jpg","comment_is_top":false,"comment_ctime":1732851480,"is_pvip":false,"replies":null,"discussion_count":0,"race_medal":0,"score":2,"product_id":100839101,"comment_content":"è€å¸ˆï¼Œæ‚¨å¥½æœ‰å‡ ä¸ªé—®é¢˜ 1.query(&quot;What is the total price of 3kg of apple and 2kg of banana?&quot;)è¿™ä¸ªpromptå’Œè¾“å‡ºçš„ä¸åŒ¹é… 2.re.compile éœ€è¦å¯¼å…¥åŒ…ï¼Œimport re 3.ä¸ºäº†æ–¹ä¾¿ç†è§£ï¼Œè€å¸ˆåç»­çš„ä»£ç æ˜¯å¦å¯ä»¥å¢åŠ ä¸€ç‚¹æ³¨é‡Šï¼Œè°¢è°¢æ‚¨ï¼","like_count":1}]}