{"id":476643,"title":"32ï½œå¹¶å‘ï¼šèŠèŠGoroutineè°ƒåº¦å™¨çš„åŸç†","content":"<p>ä½ å¥½ï¼Œæˆ‘æ˜¯Tony Baiã€‚</p><p>ä¸Šä¸€è®²æˆ‘ä»¬å­¦ä¹ äº†å¹¶å‘çš„åŸºæœ¬æ¦‚å¿µå’ŒGoçš„å¹¶å‘æ–¹æ¡ˆï¼Œä¹Ÿå°±æ˜¯Goroutineçš„ä¸€äº›åŸºæœ¬ä½¿ç”¨å’Œæ³¨æ„äº‹é¡¹ã€‚å¯¹äºå¤§å¤šæ•°Gopheræ¥è¯´ï¼Œè¿™äº›å†…å®¹ä½œä¸ºGoå¹¶å‘å…¥é—¨å·²ç»æ˜¯è¶³å¤Ÿäº†ã€‚</p><p>ä½†æ¯•ç«ŸGoæ²¡æœ‰é‡‡ç”¨åŸºäºçº¿ç¨‹çš„å¹¶å‘æ¨¡å‹ï¼Œå¯èƒ½å¾ˆå¤šGopheréƒ½å¥½å¥‡Goè¿è¡Œæ—¶ç©¶ç«Ÿæ˜¯å¦‚ä½•å°†ä¸€ä¸ªä¸ªGoroutineè°ƒåº¦åˆ°CPUä¸Šæ‰§è¡Œçš„ã€‚å½“ç„¶ï¼ŒGoroutineçš„è°ƒåº¦æœ¬æ¥æ˜¯Goè¯­è¨€æ ¸å¿ƒå¼€å‘å›¢é˜Ÿæ‰åº”è¯¥å…³æ³¨çš„äº‹æƒ…ï¼Œå¤§å¤šæ•°Gopherä»¬æ— éœ€å…³å¿ƒã€‚ä½†å°±æˆ‘ä¸ªäººçš„å­¦ä¹ å’Œå®è·µç»éªŒè€Œè¨€ï¼Œæˆ‘è§‰å¾—äº†è§£Goroutineçš„è°ƒåº¦æ¨¡å‹å’ŒåŸç†ï¼Œèƒ½å¤Ÿå¸®åŠ©æˆ‘ä»¬ç¼–å†™å‡ºæ›´é«˜è´¨é‡çš„Goä»£ç ã€‚</p><p>å› æ­¤ï¼Œåœ¨è¿™ä¸€è®²ä¸­ï¼Œæˆ‘æƒ³å’Œä½ ä¸€èµ·ç®€å•æ¢ç©¶ä¸€ä¸‹Goroutineè°ƒåº¦å™¨çš„åŸç†å’Œæ¼”åŒ–å†å²ã€‚</p><h2>Goroutineè°ƒåº¦å™¨</h2><p>æåˆ°â€œè°ƒåº¦â€ï¼Œæˆ‘ä»¬é¦–å…ˆæƒ³åˆ°çš„å°±æ˜¯æ“ä½œç³»ç»Ÿå¯¹è¿›ç¨‹ã€çº¿ç¨‹çš„è°ƒåº¦ã€‚æ“ä½œç³»ç»Ÿè°ƒåº¦å™¨ä¼šå°†ç³»ç»Ÿä¸­çš„å¤šä¸ªçº¿ç¨‹æŒ‰ç…§ä¸€å®šç®—æ³•è°ƒåº¦åˆ°ç‰©ç†CPUä¸Šå»è¿è¡Œã€‚</p><p>å‰é¢æˆ‘ä»¬ä¹Ÿæåˆ°ï¼Œä¼ ç»Ÿçš„ç¼–ç¨‹è¯­è¨€ï¼Œæ¯”å¦‚Cã€C++ç­‰çš„å¹¶å‘å®ç°ï¼Œå¤šæ˜¯åŸºäºçº¿ç¨‹æ¨¡å‹çš„ï¼Œä¹Ÿå°±æ˜¯åº”ç”¨ç¨‹åºè´Ÿè´£åˆ›å»ºçº¿ç¨‹ï¼ˆä¸€èˆ¬é€šè¿‡libpthreadç­‰åº“å‡½æ•°è°ƒç”¨å®ç°ï¼‰ï¼Œæ“ä½œç³»ç»Ÿè´Ÿè´£è°ƒåº¦çº¿ç¨‹ã€‚å½“ç„¶ï¼Œæˆ‘ä»¬ä¹Ÿè¯´è¿‡ï¼Œè¿™ç§ä¼ ç»Ÿæ”¯æŒå¹¶å‘çš„æ–¹å¼æœ‰å¾ˆå¤šä¸è¶³ã€‚ä¸ºäº†è§£å†³è¿™äº›é—®é¢˜ï¼ŒGoè¯­è¨€ä¸­çš„å¹¶å‘å®ç°ï¼Œä½¿ç”¨äº†Goroutineï¼Œä»£æ›¿äº†æ“ä½œç³»ç»Ÿçš„çº¿ç¨‹ï¼Œä¹Ÿä¸å†ä¾é æ“ä½œç³»ç»Ÿè°ƒåº¦ã€‚</p><!-- [[[read_end]]] --><p>Goroutineå ç”¨çš„èµ„æºéå¸¸å°ï¼Œä¸ŠèŠ‚è¯¾æˆ‘ä»¬ä¹Ÿè¯´è¿‡ï¼Œæ¯ä¸ªGoroutineæ ˆçš„å¤§å°é»˜è®¤æ˜¯2KBã€‚è€Œä¸”ï¼ŒGoroutineè°ƒåº¦çš„åˆ‡æ¢ä¹Ÿä¸ç”¨é™·å…¥ï¼ˆtrapï¼‰æ“ä½œç³»ç»Ÿå†…æ ¸å±‚å®Œæˆï¼Œä»£ä»·å¾ˆä½ã€‚å› æ­¤ï¼Œä¸€ä¸ªGoç¨‹åºä¸­å¯ä»¥åˆ›å»ºæˆåƒä¸Šä¸‡ä¸ªå¹¶å‘çš„Goroutineã€‚è€Œå°†è¿™äº›GoroutineæŒ‰ç…§ä¸€å®šç®—æ³•æ”¾åˆ°â€œCPUâ€ä¸Šæ‰§è¡Œçš„ç¨‹åºï¼Œå°±è¢«ç§°ä¸º  <strong>Goroutineè°ƒåº¦å™¨ï¼ˆGoroutine Schedulerï¼‰</strong>ï¼Œæ³¨æ„ï¼Œè¿™é‡Œè¯´çš„â€œCPUâ€æ‰“äº†å¼•å·ã€‚</p><p>ä¸è¿‡ï¼Œä¸€ä¸ªGoç¨‹åºå¯¹äºæ“ä½œç³»ç»Ÿæ¥è¯´åªæ˜¯ä¸€ä¸ª<strong>ç”¨æˆ·å±‚ç¨‹åº</strong>ï¼Œæ“ä½œç³»ç»Ÿçœ¼ä¸­åªæœ‰çº¿ç¨‹ï¼Œå®ƒç”šè‡³ä¸çŸ¥é“æœ‰ä¸€ç§å« <strong>Goroutine</strong>çš„äº‹ç‰©å­˜åœ¨ã€‚æ‰€ä»¥ï¼ŒGoroutineçš„è°ƒåº¦å…¨è¦é Goè‡ªå·±å®Œæˆã€‚é‚£ä¹ˆï¼Œå®ç°Goç¨‹åºå†…Goroutineä¹‹é—´â€œå…¬å¹³â€ç«äº‰â€œCPUâ€èµ„æºçš„ä»»åŠ¡ï¼Œå°±è½åˆ°äº†Goè¿è¡Œæ—¶ï¼ˆruntimeï¼‰å¤´ä¸Šäº†ã€‚è¦çŸ¥é“åœ¨ä¸€ä¸ªGoç¨‹åºä¸­ï¼Œé™¤äº†ç”¨æˆ·å±‚ä»£ç ï¼Œå‰©ä¸‹çš„å°±æ˜¯Goè¿è¡Œæ—¶äº†ã€‚</p><p>äºæ˜¯ï¼ŒGoroutineçš„è°ƒåº¦é—®é¢˜å°±æ¼”å˜ä¸ºï¼ŒGoè¿è¡Œæ—¶å¦‚ä½•å°†ç¨‹åºå†…çš„ä¼—å¤šGoroutineï¼ŒæŒ‰ç…§ä¸€å®šç®—æ³•è°ƒåº¦åˆ°â€œCPUâ€èµ„æºä¸Šè¿è¡Œçš„é—®é¢˜äº†ã€‚</p><p><strong>å¯æ˜¯ï¼Œåœ¨æ“ä½œç³»ç»Ÿå±‚é¢ï¼Œçº¿ç¨‹ç«äº‰çš„â€œCPUâ€èµ„æºæ˜¯çœŸå®çš„ç‰©ç†CPUï¼Œä½†åœ¨Goç¨‹åºå±‚é¢ï¼Œå„ä¸ªGoroutineè¦ç«äº‰çš„â€œCPUâ€èµ„æºåˆæ˜¯ä»€ä¹ˆå‘¢ï¼Ÿ</strong></p><p>Goç¨‹åºæ˜¯ç”¨æˆ·å±‚ç¨‹åºï¼Œå®ƒæœ¬èº«å°±æ˜¯æ•´ä½“è¿è¡Œåœ¨ä¸€ä¸ªæˆ–å¤šä¸ªæ“ä½œç³»ç»Ÿçº¿ç¨‹ä¸Šçš„ã€‚æ‰€ä»¥è¿™ä¸ªç­”æ¡ˆå°±å‡ºæ¥äº†ï¼šGoroutineä»¬è¦ç«äº‰çš„â€œCPUâ€èµ„æºå°±æ˜¯æ“ä½œç³»ç»Ÿçº¿ç¨‹ã€‚è¿™æ ·ï¼ŒGoroutineè°ƒåº¦å™¨çš„ä»»åŠ¡ä¹Ÿå°±æ˜ç¡®äº†ï¼š<strong>å°†GoroutineæŒ‰ç…§ä¸€å®šç®—æ³•æ”¾åˆ°ä¸åŒçš„æ“ä½œç³»ç»Ÿçº¿ç¨‹ä¸­å»æ‰§è¡Œ</strong>ã€‚</p><p>é‚£ä¹ˆï¼ŒGoroutineè°ƒåº¦å™¨ç©¶ç«Ÿæ˜¯ä»¥æ€æ ·çš„ç®—æ³•æ¨¡å‹ï¼Œå°†Goroutineè°ƒåº¦åˆ°ä¸åŒçš„æ“ä½œç³»ç»Ÿçº¿ç¨‹ä¸Šå»çš„å‘¢ï¼Ÿæˆ‘ä»¬ç»§ç»­å‘ä¸‹çœ‹ã€‚</p><h2>Goroutineè°ƒåº¦å™¨æ¨¡å‹ä¸æ¼”åŒ–è¿‡ç¨‹</h2><p>Goroutineè°ƒåº¦å™¨çš„å®ç°ä¸æ˜¯ä¸€è¹´è€Œå°±çš„ï¼Œå®ƒçš„è°ƒåº¦æ¨¡å‹ä¸ç®—æ³•ä¹Ÿæ˜¯å‡ ç»æ¼”åŒ–ï¼Œä»æœ€åˆçš„G-Mæ¨¡å‹ã€åˆ°G-P-Mæ¨¡å‹ï¼Œä»ä¸æ”¯æŒæŠ¢å ï¼Œåˆ°æ”¯æŒåä½œå¼æŠ¢å ï¼Œå†åˆ°æ”¯æŒåŸºäºä¿¡å·çš„å¼‚æ­¥æŠ¢å ï¼ŒGoroutineè°ƒåº¦å™¨ç»å†äº†ä¸æ–­åœ°ä¼˜åŒ–ä¸æ‰“ç£¨ã€‚</p><p>é¦–å…ˆæˆ‘ä»¬æ¥çœ‹æœ€åˆçš„<strong>G-Mæ¨¡å‹</strong>ã€‚</p><p>2012å¹´3æœˆ28æ—¥ï¼ŒGo 1.0æ­£å¼å‘å¸ƒã€‚åœ¨è¿™ä¸ªç‰ˆæœ¬ä¸­ï¼ŒGoå¼€å‘å›¢é˜Ÿå®ç°äº†ä¸€ä¸ªç®€å•çš„Goroutineè°ƒåº¦å™¨ã€‚åœ¨è¿™ä¸ªè°ƒåº¦å™¨ä¸­ï¼Œæ¯ä¸ªGoroutineå¯¹åº”äºè¿è¡Œæ—¶ä¸­çš„ä¸€ä¸ªæŠ½è±¡ç»“æ„ï¼š<code>G(Goroutine)</code> ï¼Œ</p><p>è€Œè¢«è§†ä½œâ€œç‰©ç†CPUâ€çš„æ“ä½œç³»ç»Ÿçº¿ç¨‹ï¼Œåˆ™è¢«æŠ½è±¡ä¸ºå¦å¤–ä¸€ä¸ªç»“æ„ï¼š<code>M(machine)</code>ã€‚</p><p>è°ƒåº¦å™¨çš„å·¥ä½œå°±æ˜¯å°†Gè°ƒåº¦åˆ°Mä¸Šå»è¿è¡Œã€‚ä¸ºäº†æ›´å¥½åœ°æ§åˆ¶ç¨‹åºä¸­æ´»è·ƒçš„Mçš„æ•°é‡ï¼Œè°ƒåº¦å™¨å¼•å…¥äº†GOMAXPROCSå˜é‡æ¥è¡¨ç¤ºGoè°ƒåº¦å™¨å¯è§çš„â€œå¤„ç†å™¨â€çš„æœ€å¤§æ•°é‡ã€‚</p><p>è¿™ä¸ªæ¨¡å‹å®ç°èµ·æ¥æ¯”è¾ƒç®€å•ï¼Œä¹Ÿèƒ½æ­£å¸¸å·¥ä½œï¼Œä½†æ˜¯å´å­˜åœ¨ç€è¯¸å¤šé—®é¢˜ã€‚å‰è‹±ç‰¹å°”é»‘å¸¦çº§å·¥ç¨‹å¸ˆã€ç°è°·æ­Œå·¥ç¨‹å¸ˆ<a href=\"https://github.com/dvyukov\">å¾·ç±³ç‰¹é‡ŒÂ·ç»´å°¤ç§‘å¤«ï¼ˆDmitry Vyukov</a>ï¼‰åœ¨å…¶ã€Š<a href=\"https://docs.google.com/document/d/1TTj4T2JO42uD5ID9e89oa0sLKhJYD0Y_kqxDv3I3XMw/edit#!\">Scalable Go Scheduler Design</a>ã€‹ä¸€æ–‡ä¸­æŒ‡å‡ºäº† <strong>G-Mæ¨¡å‹</strong>çš„ä¸€ä¸ªé‡è¦ä¸è¶³ï¼šé™åˆ¶äº†Goå¹¶å‘ç¨‹åºçš„ä¼¸ç¼©æ€§ï¼Œå°¤å…¶æ˜¯å¯¹é‚£äº›æœ‰é«˜ååæˆ–å¹¶è¡Œè®¡ç®—éœ€æ±‚çš„æœåŠ¡ç¨‹åºã€‚</p><p>è¿™ä¸ªé—®é¢˜ä¸»è¦ä½“ç°åœ¨è¿™å‡ ä¸ªæ–¹é¢ï¼š</p><ul>\n<li>å•ä¸€å…¨å±€äº’æ–¥é”<code>(Sched.Lock)</code> å’Œé›†ä¸­çŠ¶æ€å­˜å‚¨çš„å­˜åœ¨ï¼Œå¯¼è‡´æ‰€æœ‰Goroutineç›¸å…³æ“ä½œï¼Œæ¯”å¦‚åˆ›å»ºã€é‡æ–°è°ƒåº¦ç­‰ï¼Œéƒ½è¦ä¸Šé”ï¼›</li>\n<li>Goroutineä¼ é€’é—®é¢˜ï¼šMç»å¸¸åœ¨Mä¹‹é—´ä¼ é€’â€œå¯è¿è¡Œâ€çš„Goroutineï¼Œè¿™å¯¼è‡´è°ƒåº¦å»¶è¿Ÿå¢å¤§ï¼Œä¹Ÿå¢åŠ äº†é¢å¤–çš„æ€§èƒ½æŸè€—ï¼›</li>\n<li>æ¯ä¸ªMéƒ½åšå†…å­˜ç¼“å­˜ï¼Œå¯¼è‡´å†…å­˜å ç”¨è¿‡é«˜ï¼Œæ•°æ®å±€éƒ¨æ€§è¾ƒå·®ï¼›</li>\n<li>ç”±äºç³»ç»Ÿè°ƒç”¨ï¼ˆsyscallï¼‰è€Œå½¢æˆçš„é¢‘ç¹çš„å·¥ä½œçº¿ç¨‹é˜»å¡å’Œè§£é™¤é˜»å¡ï¼Œå¯¼è‡´é¢å¤–çš„æ€§èƒ½æŸè€—ã€‚</li>\n</ul><p>ä¸ºäº†è§£å†³è¿™äº›é—®é¢˜ï¼Œå¾·ç±³ç‰¹é‡ŒÂ·ç»´å°¤ç§‘å¤«åˆäº²è‡ªæ“åˆ€æ”¹è¿›äº†Goè°ƒåº¦å™¨ï¼Œåœ¨Go 1.1ç‰ˆæœ¬ä¸­å®ç°äº† <strong>G-P-Mè°ƒåº¦æ¨¡å‹</strong>å’Œ<a href=\"http://supertech.csail.mit.edu/papers/steal.pdf\">work stealingç®—æ³•</a>ï¼Œè¿™ä¸ªæ¨¡å‹ä¸€ç›´æ²¿ç”¨è‡³ä»Šã€‚æ¨¡å‹å¦‚ä¸‹å›¾æ‰€ç¤ºï¼š</p><p><img src=\"https://static001.geekbang.org/resource/image/43/a8/43ffdbc6b2203d9400ac98423192caa8.png?wh=1224x1142\" alt=\"å›¾ç‰‡\"></p><p>æœ‰äººè¯´è¿‡ï¼š<strong>â€œè®¡ç®—æœºç§‘å­¦é¢†åŸŸçš„ä»»ä½•é—®é¢˜éƒ½å¯ä»¥é€šè¿‡å¢åŠ ä¸€ä¸ªé—´æ¥çš„ä¸­é—´å±‚æ¥è§£å†³â€</strong>ï¼Œå¾·ç±³ç‰¹é‡ŒÂ·ç»´å°¤ç§‘å¤«çš„ <strong>G-P-M</strong>æ¨¡å‹æ°æ˜¯è¿™ä¸€ç†è®ºçš„è·µè¡Œè€…ã€‚ä½ å¯ä»¥çœ‹åˆ°ï¼Œå¾·ç±³ç‰¹é‡ŒÂ·ç»´å°¤ç§‘å¤«é€šè¿‡å‘G-Mæ¨¡å‹ä¸­å¢åŠ äº†ä¸€ä¸ªPï¼Œè®©Goè°ƒåº¦å™¨å…·æœ‰å¾ˆå¥½çš„ä¼¸ç¼©æ€§ã€‚</p><p>Pæ˜¯ä¸€ä¸ªâ€œé€»è¾‘Proccessorâ€ï¼Œæ¯ä¸ªGï¼ˆGoroutineï¼‰è¦æƒ³çœŸæ­£è¿è¡Œèµ·æ¥ï¼Œé¦–å…ˆéœ€è¦è¢«åˆ†é…ä¸€ä¸ªPï¼Œä¹Ÿå°±æ˜¯è¿›å…¥åˆ°Pçš„æœ¬åœ°è¿è¡Œé˜Ÿåˆ—ï¼ˆlocal runqï¼‰ä¸­ã€‚å¯¹äºGæ¥è¯´ï¼ŒPå°±æ˜¯è¿è¡Œå®ƒçš„â€œCPUâ€ï¼Œå¯ä»¥è¯´ï¼š<strong>åœ¨Gçš„çœ¼é‡Œåªæœ‰P</strong>ã€‚ä½†ä»Goè°ƒåº¦å™¨çš„è§†è§’æ¥çœ‹ï¼ŒçœŸæ­£çš„â€œCPUâ€æ˜¯Mï¼Œåªæœ‰å°†På’ŒMç»‘å®šï¼Œæ‰èƒ½è®©Pçš„runqä¸­çš„GçœŸæ­£è¿è¡Œèµ·æ¥ã€‚</p><p>G-P-Mæ¨¡å‹çš„å®ç°ç®—æ˜¯<code>Goè°ƒåº¦å™¨</code>çš„ä¸€å¤§è¿›æ­¥ï¼Œä½†è°ƒåº¦å™¨ä»ç„¶æœ‰ä¸€ä¸ªä»¤äººå¤´ç–¼çš„é—®é¢˜ï¼Œé‚£å°±æ˜¯<strong>ä¸æ”¯æŒæŠ¢å å¼è°ƒåº¦</strong>ï¼Œè¿™å¯¼è‡´ä¸€æ—¦æŸä¸ªGä¸­å‡ºç°æ­»å¾ªç¯çš„ä»£ç é€»è¾‘ï¼Œé‚£ä¹ˆGå°†æ°¸ä¹…å ç”¨åˆ†é…ç»™å®ƒçš„På’ŒMï¼Œè€Œä½äºåŒä¸€ä¸ªPä¸­çš„å…¶ä»–Gå°†å¾—ä¸åˆ°è°ƒåº¦ï¼Œå‡ºç°â€œ<strong>é¥¿æ­»</strong>â€çš„æƒ…å†µã€‚</p><p>æ›´ä¸ºä¸¥é‡çš„æ˜¯ï¼Œå½“åªæœ‰ä¸€ä¸ªPï¼ˆGOMAXPROCS=1ï¼‰æ—¶ï¼Œæ•´ä¸ªGoç¨‹åºä¸­çš„å…¶ä»–Géƒ½å°†â€œé¥¿æ­»â€ã€‚äºæ˜¯å¾·ç±³ç‰¹é‡ŒÂ·ç»´å°¤ç§‘å¤«åˆæå‡ºäº†ã€Š<a href=\"https://docs.google.com/document/d/1ETuA2IOmnaQ4j81AtTGT40Y4_Jr6_IDASEKg0t0dBR8/edit#!\">Go Preemptive Scheduler Design</a>ã€‹å¹¶åœ¨<strong>Go 1.2ä¸­å®ç°äº†åŸºäºåä½œçš„â€œæŠ¢å å¼â€è°ƒåº¦</strong>ã€‚</p><p>è¿™ä¸ªæŠ¢å å¼è°ƒåº¦çš„åŸç†å°±æ˜¯ï¼ŒGoç¼–è¯‘å™¨åœ¨æ¯ä¸ªå‡½æ•°æˆ–æ–¹æ³•çš„å…¥å£å¤„åŠ ä¸Šäº†ä¸€æ®µé¢å¤–çš„ä»£ç (runtime.morestack_noctxt)ï¼Œè®©è¿è¡Œæ—¶æœ‰æœºä¼šåœ¨è¿™æ®µä»£ç ä¸­æ£€æŸ¥æ˜¯å¦éœ€è¦æ‰§è¡ŒæŠ¢å è°ƒåº¦ã€‚</p><p>è¿™ç§è§£å†³æ–¹æ¡ˆåªèƒ½è¯´å±€éƒ¨è§£å†³äº†â€œé¥¿æ­»â€é—®é¢˜ï¼Œåªåœ¨æœ‰å‡½æ•°è°ƒç”¨çš„åœ°æ–¹æ‰èƒ½æ’å…¥â€œæŠ¢å â€ä»£ç ï¼ˆåŸ‹ç‚¹ï¼‰ï¼Œå¯¹äºæ²¡æœ‰å‡½æ•°è°ƒç”¨è€Œæ˜¯çº¯ç®—æ³•å¾ªç¯è®¡ç®—çš„Gï¼ŒGoè°ƒåº¦å™¨ä¾ç„¶æ— æ³•æŠ¢å ã€‚</p><p>æ¯”å¦‚ï¼Œæ­»å¾ªç¯ç­‰å¹¶æ²¡æœ‰ç»™ç¼–è¯‘å™¨æ’å…¥æŠ¢å ä»£ç çš„æœºä¼šï¼Œè¿™å°±ä¼šå¯¼è‡´GCåœ¨ç­‰å¾…æ‰€æœ‰Goroutineåœæ­¢æ—¶çš„ç­‰å¾…æ—¶é—´è¿‡é•¿ï¼Œä»è€Œ<a href=\"https://github.com/golang/go/issues/10958\">å¯¼è‡´GCå»¶è¿Ÿ</a>ï¼Œå†…å­˜å ç”¨ç¬é—´å†²é«˜ï¼›ç”šè‡³åœ¨ä¸€äº›ç‰¹æ®Šæƒ…å†µä¸‹ï¼Œå¯¼è‡´åœ¨STWï¼ˆstop the worldï¼‰æ—¶æ­»é”ã€‚</p><p>ä¸ºäº†è§£å†³è¿™äº›é—®é¢˜ï¼ŒGoåœ¨1.14ç‰ˆæœ¬ä¸­æ¥å—äº†å¥¥æ–¯æ±€Â·å…‹è±é—¨èŒ¨ï¼ˆAustin Clementsï¼‰çš„<a href=\"https://go.googlesource.com/proposal/+/master/design/24543-non-cooperative-preemption.md\">ææ¡ˆ</a>ï¼Œå¢åŠ äº†<strong>å¯¹éåä½œçš„æŠ¢å å¼è°ƒåº¦çš„æ”¯æŒ</strong>ï¼Œè¿™ç§æŠ¢å å¼è°ƒåº¦æ˜¯åŸºäºç³»ç»Ÿä¿¡å·çš„ï¼Œä¹Ÿå°±æ˜¯é€šè¿‡å‘çº¿ç¨‹å‘é€ä¿¡å·çš„æ–¹å¼æ¥æŠ¢å æ­£åœ¨è¿è¡Œçš„Goroutineã€‚</p><p>é™¤äº†è¿™äº›å¤§çš„è¿­ä»£å¤–ï¼ŒGoroutineçš„è°ƒåº¦å™¨è¿˜æœ‰ä¸€äº›å°çš„ä¼˜åŒ–æ”¹åŠ¨ï¼Œæ¯”å¦‚<strong>é€šè¿‡æ–‡ä»¶I/O pollerå‡å°‘Mçš„é˜»å¡ç­‰</strong>ã€‚</p><p>Goè¿è¡Œæ—¶å·²ç»å®ç°äº†netpollerï¼Œè¿™ä½¿å¾—å³ä¾¿Gå‘èµ·ç½‘ç»œI/Oæ“ä½œï¼Œä¹Ÿä¸ä¼šå¯¼è‡´Mè¢«é˜»å¡ï¼ˆä»…é˜»å¡Gï¼‰ï¼Œä¹Ÿå°±ä¸ä¼šå¯¼è‡´å¤§é‡çº¿ç¨‹ï¼ˆMï¼‰è¢«åˆ›å»ºå‡ºæ¥ã€‚</p><p>ä½†æ˜¯å¯¹äºæ–‡ä»¶I/Oæ“ä½œæ¥è¯´ï¼Œä¸€æ—¦é˜»å¡ï¼Œé‚£ä¹ˆçº¿ç¨‹ï¼ˆMï¼‰å°†è¿›å…¥æŒ‚èµ·çŠ¶æ€ï¼Œç­‰å¾…I/Oè¿”å›åè¢«å”¤é†’ã€‚è¿™ç§æƒ…å†µä¸‹På°†ä¸æŒ‚èµ·çš„Måˆ†ç¦»ï¼Œå†é€‰æ‹©ä¸€ä¸ªå¤„äºç©ºé—²çŠ¶æ€ï¼ˆidleï¼‰çš„Mã€‚å¦‚æœæ­¤æ—¶æ²¡æœ‰ç©ºé—²çš„Mï¼Œå°±ä¼šæ–°åˆ›å»ºä¸€ä¸ªMï¼ˆçº¿ç¨‹ï¼‰ï¼Œæ‰€ä»¥ï¼Œè¿™ç§æƒ…å†µä¸‹ï¼Œå¤§é‡I/Oæ“ä½œä»ç„¶ä¼šå¯¼è‡´å¤§é‡çº¿ç¨‹è¢«åˆ›å»ºã€‚</p><p>ä¸ºäº†è§£å†³è¿™ä¸ªé—®é¢˜ï¼ŒGoå¼€å‘å›¢é˜Ÿçš„ä¼Šæ©Â·å…°æ–¯Â·æ³°å‹’ï¼ˆIan Lance Taylorï¼‰åœ¨Go 1.9ä¸­å¢åŠ äº†ä¸€ä¸ª<a href=\"https://groups.google.com/forum/#!topic/golang-dev/tT8SoKfHty0\">é’ˆå¯¹æ–‡ä»¶I/Oçš„Poller</a>çš„åŠŸèƒ½ï¼Œè¿™ä¸ªåŠŸèƒ½å¯ä»¥åƒnetpolleré‚£æ ·ï¼Œåœ¨Gæ“ä½œé‚£äº›æ”¯æŒç›‘å¬ï¼ˆpollableï¼‰çš„æ–‡ä»¶æè¿°ç¬¦æ—¶ï¼Œä»…ä¼šé˜»å¡Gï¼Œè€Œä¸ä¼šé˜»å¡Mã€‚ä¸è¿‡è¿™ä¸ªåŠŸèƒ½ä¾ç„¶ä¸èƒ½å¯¹å¸¸è§„æ–‡ä»¶æœ‰æ•ˆï¼Œå¸¸è§„æ–‡ä»¶æ˜¯ä¸æ”¯æŒç›‘å¬çš„ï¼ˆpollableï¼‰ã€‚ä½†å¯¹äºGoè°ƒåº¦å™¨è€Œè¨€ï¼Œè¿™ä¹Ÿç®—æ˜¯ä¸€ä¸ªä¸å°çš„è¿›æ­¥äº†ã€‚</p><p>ä»Go 1.2ä»¥åï¼ŒGoè°ƒåº¦å™¨å°±ä¸€ç›´ç¨³å®šåœ¨G-P-Mè°ƒåº¦æ¨¡å‹ä¸Šï¼Œå°½ç®¡æœ‰å„ç§ä¼˜åŒ–å’Œæ”¹è¿›ï¼Œä½†ä¹Ÿéƒ½æ˜¯åŸºäºè¿™ä¸ªæ¨¡å‹ä¹‹ä¸Šçš„ã€‚é‚£æœªæ¥çš„Goè°ƒåº¦å™¨ä¼šå¾€å“ªæ–¹é¢å‘å±•å‘¢ï¼Ÿå¾·ç±³ç‰¹é‡ŒÂ·ç»´å°¤ç§‘å¤«åœ¨2014å¹´9æœˆæå‡ºäº†ä¸€ä¸ªæ–°çš„è®¾è®¡è‰æ¡ˆæ–‡æ¡£ï¼šã€Š<a href=\"https://docs.google.com/document/u/0/d/1d3iI2QWURgDIsSR6G2275vMeQ_X7w-qxM2Vp7iGwwuM/pub\">NUMAâ€aware scheduler for Go</a>ã€‹ï¼Œä½œä¸ºå¯¹æœªæ¥Goroutineè°ƒåº¦å™¨æ¼”è¿›æ–¹å‘çš„ä¸€ä¸ªæè®®ï¼Œä¸è¿‡è‡³ä»Šä¼¼ä¹è¿™ä¸ªæè®®ä¹Ÿæ²¡æœ‰åˆ—å…¥å¼€å‘è®¡åˆ’ã€‚</p><p>é€šè¿‡å‰é¢å¯¹Goroutineè°ƒåº¦å™¨æ¼”åŒ–çš„åˆ†æï¼Œä½ å¯ä»¥çœ‹åˆ°ï¼Œç›®å‰G-Mæ¨¡å‹å·²ç»åºŸå¼ƒï¼ŒNUMAè°ƒåº¦æ¨¡å‹å°šæœªå®ç°ï¼Œé‚£ä¹ˆç°åœ¨æˆ‘ä»¬è¦ç†è§£å¦‚ä»Šçš„Goroutineè°ƒåº¦ï¼Œåªéœ€è¦å­¦ä¹ G-P-Mæ¨¡å‹å°±å¯ä»¥äº†ï¼Œæ¥ä¸‹æ¥æˆ‘ä»¬å°±æ¥çœ‹çœ‹G-P-Mæ¨¡å‹ä¸‹Goroutineçš„è°ƒåº¦åŸç†ã€‚</p><h2>æ·±å…¥G-P-Mæ¨¡å‹</h2><p>Goè¯­è¨€ä¸­Goroutineçš„è°ƒåº¦ã€GCã€å†…å­˜ç®¡ç†ç­‰æ˜¯Goè¯­è¨€åŸç†æœ€å¤æ‚ã€æœ€éš¾æ‡‚çš„åœ°æ–¹ï¼Œéšä¾¿æ‹¿å‡ºä¸€ä¸ªéƒ½å¯ä»¥è®²ä¸Šå‡ èŠ‚è¯¾ï¼Œå¹¶ä¸”è¿™ä¸‰æ–¹é¢çš„å†…å®¹éšç€Goç‰ˆæœ¬çš„æ¼”è¿›ä¹Ÿåœ¨ä¸æ–­æ›´æ–°ã€‚å› ä¸ºæˆ‘ä»¬æ˜¯å…¥é—¨è¯¾ï¼Œæ‰€ä»¥è¿™é‡Œæˆ‘å°±åªåŸºäºGo 1.12.7ç‰ˆæœ¬ï¼ˆæ”¯æŒåŸºäºåä½œçš„æŠ¢å å¼è°ƒåº¦ï¼‰ç»™ä½ ç²—ç•¥ä»‹ç»ä¸€ä¸‹åŸºäºG-P-Mæ¨¡å‹çš„è°ƒåº¦åŸç†ï¼Œå¦‚æœä½ è¿˜å¯¹è¿™æ–¹é¢æ„Ÿå…´è¶£ï¼Œå¯ä»¥åŸºäºè¿™äº›ä»‹ç»æ·±å…¥åˆ°ç›¸å…³çš„Goæºç ä¸­å»ï¼Œæ·±å…¥æŒ–æ˜ç»†èŠ‚ã€‚</p><h3>Gã€På’ŒM</h3><p>å…³äºGã€Pã€Mçš„å®šä¹‰ï¼Œæˆ‘ä»¬å¯ä»¥å‚è§<code>$GOROOT/src/runtime/runtime2.go</code> è¿™ä¸ªæºæ–‡ä»¶ã€‚ä½ å¯ä»¥çœ‹åˆ°ï¼ŒGã€Pã€Mè¿™ä¸‰ä¸ªç»“æ„ä½“å®šä¹‰éƒ½æ˜¯å¤§å—å¤´ï¼Œæ¯ä¸ªç»“æ„ä½“å®šä¹‰éƒ½åŒ…å«åå‡ ä¸ªç”šè‡³äºŒä¸‰åä¸ªå­—æ®µã€‚æ›´ä¸ç”¨è¯´ï¼Œåƒè°ƒåº¦å™¨è¿™æ ·çš„æ ¸å¿ƒä»£ç å‘æ¥å¾ˆå¤æ‚ï¼Œè€ƒè™‘çš„å› ç´ ä¹Ÿéå¸¸å¤šï¼Œä»£ç â€œè€¦åˆâ€æˆä¸€å¨ã€‚ä¸è¿‡ä»å¤æ‚çš„ä»£ç ä¸­ï¼Œæˆ‘ä»¬ä¾ç„¶å¯ä»¥çœ‹å‡ºæ¥Gã€Pã€Mçš„å„è‡ªçš„å¤§è‡´ç”¨é€”ï¼Œæˆ‘ä»¬è¿™é‡Œç®€è¦è¯´æ˜ä¸€ä¸‹ï¼š</p><ul>\n<li>G:  ä»£è¡¨Goroutineï¼Œå­˜å‚¨äº†Goroutineçš„æ‰§è¡Œæ ˆä¿¡æ¯ã€GoroutineçŠ¶æ€ä»¥åŠGoroutineçš„ä»»åŠ¡å‡½æ•°ç­‰ï¼Œè€Œä¸”Gå¯¹è±¡æ˜¯å¯ä»¥é‡ç”¨çš„ï¼›</li>\n<li>P:  ä»£è¡¨é€»è¾‘processorï¼ŒPçš„æ•°é‡å†³å®šäº†ç³»ç»Ÿå†…æœ€å¤§å¯å¹¶è¡Œçš„Gçš„æ•°é‡ï¼ŒPçš„æœ€å¤§ä½œç”¨è¿˜æ˜¯å…¶æ‹¥æœ‰çš„å„ç§Gå¯¹è±¡é˜Ÿåˆ—ã€é“¾è¡¨ã€ä¸€äº›ç¼“å­˜å’ŒçŠ¶æ€ï¼›</li>\n<li>M:  Mä»£è¡¨ç€çœŸæ­£çš„æ‰§è¡Œè®¡ç®—èµ„æºã€‚åœ¨ç»‘å®šæœ‰æ•ˆçš„Påï¼Œè¿›å…¥ä¸€ä¸ªè°ƒåº¦å¾ªç¯ï¼Œè€Œè°ƒåº¦å¾ªç¯çš„æœºåˆ¶å¤§è‡´æ˜¯<strong>ä»Pçš„æœ¬åœ°è¿è¡Œé˜Ÿåˆ—ä»¥åŠå…¨å±€é˜Ÿåˆ—ä¸­è·å–Gï¼Œåˆ‡æ¢åˆ°Gçš„æ‰§è¡Œæ ˆä¸Šå¹¶æ‰§è¡ŒGçš„å‡½æ•°ï¼Œè°ƒç”¨goexitåšæ¸…ç†å·¥ä½œå¹¶å›åˆ°Mï¼Œå¦‚æ­¤åå¤</strong>ã€‚Må¹¶ä¸ä¿ç•™GçŠ¶æ€ï¼Œè¿™æ˜¯Gå¯ä»¥è·¨Mè°ƒåº¦çš„åŸºç¡€ã€‚</li>\n</ul><p>æˆ‘è¿™é‡Œä¹Ÿç»™å‡ºäº†Gã€Pã€Må®šä¹‰çš„ä»£ç ç‰‡æ®µï¼ˆæ³¨æ„ï¼šæˆ‘ä»¬è¿™é‡Œä½¿ç”¨çš„æ˜¯Go 1.12.7ç‰ˆæœ¬ï¼Œéšç€Goæ¼”åŒ–ï¼Œç»“æ„ä½“ä¸­çš„å­—æ®µå®šä¹‰å¯èƒ½ä¼šæœ‰ä¸åŒï¼‰ï¼Œä½ ä¹Ÿå¯ä»¥çœ‹ä¸€çœ‹ï¼š</p><pre><code class=\"language-plain\">//src/runtime/runtime2.go\ntype g struct {\n    stack      stack   // offset known to runtime/cgo\n    sched      gobuf\n    goid       int64\n    gopc       uintptr // pc of go statement that created this goroutine\n    startpc    uintptr // pc of goroutine function\n    ... ...\n}\n\ntype p struct {\n    lock mutex\n\n    id          int32\n    status      uint32 // one of pidle/prunning/...\n  \n    mcache      *mcache\n    racectx     uintptr\n\n    // Queue of runnable goroutines. Accessed without lock.\n    runqhead uint32\n    runqtail uint32\n    runq     [256]guintptr\n\n    runnext guintptr\n\n    // Available G's (status == Gdead)\n    gfree    *g\n    gfreecnt int32\n\n    ... ...\n}\n\n\n\ntype m struct {\n    g0            *g     // goroutine with scheduling stack\n    mstartfn      func()\n    curg          *g     // current running goroutine\n    ... ...\n}\n</code></pre><p>è€ŒGoroutineè°ƒåº¦å™¨çš„ç›®æ ‡ï¼Œå°±æ˜¯å…¬å¹³åˆç†åœ°å°†å„ä¸ªGè°ƒåº¦åˆ°Pä¸Šâ€œè¿è¡Œâ€ï¼Œä¸‹é¢æˆ‘ä»¬é‡ç‚¹çœ‹çœ‹Gæ˜¯å¦‚ä½•è¢«è°ƒåº¦çš„ã€‚</p><h3>Gè¢«æŠ¢å è°ƒåº¦</h3><p>æˆ‘ä»¬å…ˆæ¥è¯´å¸¸è§„æƒ…å†µï¼Œä¹Ÿå°±æ˜¯å¦‚æœæŸä¸ªGæ²¡æœ‰è¿›è¡Œç³»ç»Ÿè°ƒç”¨ï¼ˆsyscallï¼‰ã€æ²¡æœ‰è¿›è¡ŒI/Oæ“ä½œã€æ²¡æœ‰é˜»å¡åœ¨ä¸€ä¸ªchannelæ“ä½œä¸Šï¼Œ<strong>è°ƒåº¦å™¨æ˜¯å¦‚ä½•è®©Gåœä¸‹æ¥å¹¶è°ƒåº¦ä¸‹ä¸€ä¸ªå¯è¿è¡Œçš„Gçš„å‘¢</strong>ï¼Ÿ</p><p>ç­”æ¡ˆå°±æ˜¯ï¼š<strong>Gæ˜¯è¢«æŠ¢å è°ƒåº¦çš„</strong>ã€‚</p><p>å‰é¢è¯´è¿‡ï¼Œé™¤éæç«¯çš„æ— é™å¾ªç¯ï¼Œå¦åˆ™åªè¦Gè°ƒç”¨å‡½æ•°ï¼ŒGoè¿è¡Œæ—¶å°±æœ‰äº†æŠ¢å Gçš„æœºä¼šã€‚Goç¨‹åºå¯åŠ¨æ—¶ï¼Œè¿è¡Œæ—¶ä¼šå»å¯åŠ¨ä¸€ä¸ªåä¸ºsysmonçš„Mï¼ˆä¸€èˆ¬ç§°ä¸ºç›‘æ§çº¿ç¨‹ï¼‰ï¼Œè¿™ä¸ªMçš„ç‰¹æ®Šä¹‹å¤„åœ¨äºå®ƒä¸éœ€è¦ç»‘å®šPå°±å¯ä»¥è¿è¡Œï¼ˆä»¥g0è¿™ä¸ªGçš„å½¢å¼ï¼‰ï¼Œè¿™ä¸ªMåœ¨æ•´ä¸ªGoç¨‹åºçš„è¿è¡Œè¿‡ç¨‹ä¸­è‡³å…³é‡è¦ï¼Œä½ å¯ä»¥çœ‹ä¸‹æˆ‘å¯¹sysmonè¢«åˆ›å»ºçš„éƒ¨åˆ†ä»£ç ä»¥åŠsysmonçš„æ‰§è¡Œé€»è¾‘æ‘˜å½•ï¼š</p><pre><code class=\"language-plain\">//$GOROOT/src/runtime/proc.go\n\n// The main goroutine.\nfunc main() {\n     ... ...\n    systemstack(func() {\n        newm(sysmon, nil)\n    })\n    .... ...\n}\n\n// Always runs without a P, so write barriers are not allowed.\n//\n//go:nowritebarrierrec\nfunc sysmon() {\n    // If a heap span goes unused for 5 minutes after a garbage collection,\n    // we hand it back to the operating system.\n    scavengelimit := int64(5 * 60 * 1e9)\n    ... ...\n\n    if  .... {\n        ... ...\n        // retake P's blocked in syscalls\n        // and preempt long running G's\n        if retake(now) != 0 {\n            idle = 0\n        } else {\n            idle++\n        }\n       ... ...\n    }\n}\n</code></pre><p>æˆ‘ä»¬çœ‹åˆ°ï¼Œsysmonæ¯20us~10mså¯åŠ¨ä¸€æ¬¡ï¼Œsysmonä¸»è¦å®Œæˆäº†è¿™äº›å·¥ä½œï¼š</p><ul>\n<li>é‡Šæ”¾é—²ç½®è¶…è¿‡5åˆ†é’Ÿçš„spanå†…å­˜ï¼›</li>\n<li>å¦‚æœè¶…è¿‡2åˆ†é’Ÿæ²¡æœ‰åƒåœ¾å›æ”¶ï¼Œå¼ºåˆ¶æ‰§è¡Œï¼›</li>\n<li>å°†é•¿æ—¶é—´æœªå¤„ç†çš„netpollç»“æœæ·»åŠ åˆ°ä»»åŠ¡é˜Ÿåˆ—ï¼›</li>\n<li>å‘é•¿æ—¶é—´è¿è¡Œçš„Gä»»åŠ¡å‘å‡ºæŠ¢å è°ƒåº¦ï¼›</li>\n<li>æ”¶å›å› syscallé•¿æ—¶é—´é˜»å¡çš„Pï¼›</li>\n</ul><p>æˆ‘ä»¬çœ‹åˆ°sysmonå°†â€œå‘é•¿æ—¶é—´è¿è¡Œçš„Gä»»åŠ¡å‘å‡ºæŠ¢å è°ƒåº¦â€ï¼Œè¿™ä¸ªäº‹æƒ…ç”±å‡½æ•° <code>retake</code> å®æ–½ï¼š</p><pre><code class=\"language-plain\">// $GOROOT/src/runtime/proc.go\n\n// forcePreemptNS is the time slice given to a G before it is\n// preempted.\nconst forcePreemptNS = 10 * 1000 * 1000 // 10ms\n\nfunc retake(now int64) uint32 {\n          ... ...\n           // Preempt G if it's running for too long.\n            t := int64(_p_.schedtick)\n            if int64(pd.schedtick) != t {\n                pd.schedtick = uint32(t)\n                pd.schedwhen = now\n                continue\n            }\n            if pd.schedwhen+forcePreemptNS &gt; now {\n                continue\n            }\n            preemptone(_p_)\n         ... ...\n}\n\nfunc preemptone(_p_ *p) bool {\n    mp := _p_.m.ptr()\n    if mp == nil || mp == getg().m {\n        return false\n    }\n    gp := mp.curg\n    if gp == nil || gp == mp.g0 {\n        return false\n    }\n\n    gp.preempt = true //è®¾ç½®è¢«æŠ¢å æ ‡å¿—\n\n    // Every call in a go routine checks for stack overflow by\n    // comparing the current stack pointer to gp-&gt;stackguard0.\n    // Setting gp-&gt;stackguard0 to StackPreempt folds\n    // preemption into the normal stack overflow check.\n    gp.stackguard0 = stackPreempt\n    return true\n}\n</code></pre><p>ä»ä¸Šé¢çš„ä»£ç ä¸­ï¼Œæˆ‘ä»¬å¯ä»¥çœ‹å‡ºï¼Œ<strong>å¦‚æœä¸€ä¸ªGä»»åŠ¡è¿è¡Œ10msï¼Œsysmonå°±ä¼šè®¤ä¸ºå®ƒçš„è¿è¡Œæ—¶é—´å¤ªä¹…è€Œå‘å‡ºæŠ¢å å¼è°ƒåº¦çš„è¯·æ±‚</strong>ã€‚ä¸€æ—¦Gçš„æŠ¢å æ ‡å¿—ä½è¢«è®¾ä¸ºtrueï¼Œé‚£ä¹ˆç­‰åˆ°è¿™ä¸ªGä¸‹ä¸€æ¬¡è°ƒç”¨å‡½æ•°æˆ–æ–¹æ³•æ—¶ï¼Œè¿è¡Œæ—¶å°±å¯ä»¥å°†GæŠ¢å å¹¶ç§»å‡ºè¿è¡ŒçŠ¶æ€ï¼Œæ”¾å…¥é˜Ÿåˆ—ä¸­ï¼Œç­‰å¾…ä¸‹ä¸€æ¬¡è¢«è°ƒåº¦ã€‚</p><p>ä¸è¿‡ï¼Œé™¤äº†è¿™ä¸ªå¸¸è§„è°ƒåº¦ä¹‹å¤–ï¼Œè¿˜æœ‰ä¸¤ä¸ªç‰¹æ®Šæƒ…å†µä¸‹Gçš„è°ƒåº¦æ–¹æ³•ã€‚</p><p><strong>ç¬¬ä¸€ç§ï¼šchannelé˜»å¡æˆ–ç½‘ç»œI/Oæƒ…å†µä¸‹çš„è°ƒåº¦ã€‚</strong></p><p>å¦‚æœGè¢«é˜»å¡åœ¨æŸä¸ªchannelæ“ä½œæˆ–ç½‘ç»œI/Oæ“ä½œä¸Šæ—¶ï¼ŒGä¼šè¢«æ”¾ç½®åˆ°æŸä¸ªç­‰å¾…ï¼ˆwaitï¼‰é˜Ÿåˆ—ä¸­ï¼Œè€ŒMä¼šå°è¯•è¿è¡ŒPçš„ä¸‹ä¸€ä¸ªå¯è¿è¡Œçš„Gã€‚å¦‚æœè¿™ä¸ªæ—¶å€™Pæ²¡æœ‰å¯è¿è¡Œçš„Gä¾›Mè¿è¡Œï¼Œé‚£ä¹ˆMå°†è§£ç»‘Pï¼Œå¹¶è¿›å…¥æŒ‚èµ·çŠ¶æ€ã€‚å½“I/Oæ“ä½œå®Œæˆæˆ–channelæ“ä½œå®Œæˆï¼Œåœ¨ç­‰å¾…é˜Ÿåˆ—ä¸­çš„Gä¼šè¢«å”¤é†’ï¼Œæ ‡è®°ä¸ºå¯è¿è¡Œï¼ˆrunnableï¼‰ï¼Œå¹¶è¢«æ”¾å…¥åˆ°æŸPçš„é˜Ÿåˆ—ä¸­ï¼Œç»‘å®šä¸€ä¸ªMåç»§ç»­æ‰§è¡Œã€‚</p><p><strong>ç¬¬äºŒç§ï¼šç³»ç»Ÿè°ƒç”¨é˜»å¡æƒ…å†µä¸‹çš„è°ƒåº¦ã€‚</strong></p><p>å¦‚æœGè¢«é˜»å¡åœ¨æŸä¸ªç³»ç»Ÿè°ƒç”¨ï¼ˆsystem callï¼‰ä¸Šï¼Œé‚£ä¹ˆä¸å…‰Gä¼šé˜»å¡ï¼Œæ‰§è¡Œè¿™ä¸ªGçš„Mä¹Ÿä¼šè§£ç»‘Pï¼Œä¸Gä¸€èµ·è¿›å…¥æŒ‚èµ·çŠ¶æ€ã€‚å¦‚æœæ­¤æ—¶æœ‰ç©ºé—²çš„Mï¼Œé‚£ä¹ˆPå°±ä¼šå’Œå®ƒç»‘å®šï¼Œå¹¶ç»§ç»­æ‰§è¡Œå…¶ä»–Gï¼›å¦‚æœæ²¡æœ‰ç©ºé—²çš„Mï¼Œä½†ä»ç„¶æœ‰å…¶ä»–Gè¦å»æ‰§è¡Œï¼Œé‚£ä¹ˆGoè¿è¡Œæ—¶å°±ä¼šåˆ›å»ºä¸€ä¸ªæ–°Mï¼ˆçº¿ç¨‹ï¼‰ã€‚</p><p>å½“ç³»ç»Ÿè°ƒç”¨è¿”å›åï¼Œé˜»å¡åœ¨è¿™ä¸ªç³»ç»Ÿè°ƒç”¨ä¸Šçš„Gä¼šå°è¯•è·å–ä¸€ä¸ªå¯ç”¨çš„Pï¼Œå¦‚æœæ²¡æœ‰å¯ç”¨çš„Pï¼Œé‚£ä¹ˆGä¼šè¢«æ ‡è®°ä¸ºrunnableï¼Œä¹‹å‰çš„é‚£ä¸ªæŒ‚èµ·çš„Må°†å†æ¬¡è¿›å…¥æŒ‚èµ·çŠ¶æ€ã€‚</p><h2>å°ç»“</h2><p>å¥½äº†ï¼Œä»Šå¤©çš„è¯¾è®²åˆ°è¿™é‡Œå°±ç»“æŸäº†ï¼Œç°åœ¨æˆ‘ä»¬ä¸€èµ·æ¥å›é¡¾ä¸€ä¸‹å§ã€‚</p><p>åŸºäºGoroutineçš„å¹¶å‘è®¾è®¡ç¦»ä¸å¼€ä¸€ä¸ªé«˜æ•ˆçš„ç”Ÿäº§çº§è°ƒåº¦å™¨ã€‚Goroutineè°ƒåº¦å™¨æ¼”è¿›äº†åä½™å¹´ï¼Œå…ˆåç»å†äº†G-Mæ¨¡å‹ã€G-P-Mæ¨¡å‹å’Œwork stealingç®—æ³•ã€åä½œå¼çš„æŠ¢å è°ƒåº¦ä»¥åŠåŸºäºä¿¡å·çš„å¼‚æ­¥æŠ¢å ç­‰æ”¹è¿›ä¸ä¼˜åŒ–ï¼Œç›®å‰Goroutineè°ƒåº¦å™¨ç›¸å¯¹ç¨³å®šå’Œæˆç†Ÿï¼Œå¯ä»¥é€‚åˆç»å¤§éƒ¨åˆ†ç”Ÿäº§åœºåˆã€‚</p><p>ç°åœ¨çš„G-P-Mæ¨¡å‹å’Œæœ€åˆçš„G-Mæ¨¡å‹ç›¸æ¯”ï¼Œé€šè¿‡å‘G-Mæ¨¡å‹ä¸­å¢åŠ äº†ä¸€ä¸ªä»£è¡¨é€»è¾‘å¤„ç†å™¨çš„Pï¼Œä½¿å¾—Goroutineè°ƒåº¦å™¨å…·æœ‰äº†æ›´å¥½çš„ä¼¸ç¼©æ€§ã€‚</p><p>Mæ˜¯Goä»£ç è¿è¡Œçš„çœŸå®è½½ä½“ï¼ŒåŒ…æ‹¬Goroutineè°ƒåº¦å™¨è‡ªèº«çš„é€»è¾‘ä¹Ÿæ˜¯åœ¨Mä¸­è¿è¡Œçš„ã€‚</p><p>Påœ¨G-P-Mæ¨¡å‹ä¸­å æ®æ ¸å¿ƒåœ°ä½ï¼Œå®ƒæ‹¥æœ‰å¾…è°ƒåº¦çš„Gçš„é˜Ÿåˆ—ï¼ŒåŒæ—¶Mè¦æƒ³è¿è¡ŒGå¿…é¡»ç»‘å®šä¸€ä¸ªPã€‚ä¸€ä¸ªGè¢«è°ƒåº¦æ‰§è¡Œçš„æ—¶é—´ä¸èƒ½è¿‡é•¿ï¼Œè¶…è¿‡ç‰¹å®šé•¿çš„æ—¶é—´åï¼ŒGä¼šè¢«è®¾ç½®ä¸º<strong>å¯æŠ¢å </strong>ï¼Œå¹¶åœ¨ä¸‹ä¸€æ¬¡æ‰§è¡Œå‡½æ•°æˆ–æ–¹æ³•æ—¶è¢«Goè¿è¡Œæ—¶ç§»å‡ºè¿è¡ŒçŠ¶æ€ã€‚</p><p>å¦‚æœGè¢«é˜»å¡åœ¨æŸä¸ªchannelæ“ä½œæˆ–ç½‘ç»œI/Oæ“ä½œä¸Šæ—¶ï¼ŒMå¯ä»¥ä¸è¢«é˜»å¡ï¼Œè¿™é¿å…äº†å¤§é‡åˆ›å»ºMå¯¼è‡´çš„å¼€é”€ã€‚ä½†å¦‚æœGå› æ…¢ç³»ç»Ÿè°ƒç”¨è€Œé˜»å¡ï¼Œé‚£ä¹ˆMä¹Ÿä¼šä¸€èµ·é˜»å¡ï¼Œä½†åœ¨é˜»å¡å‰ä¼šä¸Pè§£ç»‘ï¼ŒPä¼šå°è¯•ä¸å…¶ä»–Mç»‘å®šç»§ç»­è¿è¡Œå…¶ä»–Gã€‚ä½†è‹¥æ²¡æœ‰ç°æˆçš„Mï¼ŒGoè¿è¡Œæ—¶ä¼šå»ºç«‹æ–°çš„Mï¼Œè¿™ä¹Ÿæ˜¯ç³»ç»Ÿè°ƒç”¨å¯èƒ½å¯¼è‡´ç³»ç»Ÿçº¿ç¨‹æ•°é‡å¢åŠ çš„åŸå› ï¼Œä½ ä¸€å®šè¦æ³¨æ„è¿™ä¸€ç‚¹ã€‚</p><h2>æ€è€ƒé¢˜</h2><p>ä¸ºäº†è®©ä½ æ›´å¥½ç†è§£Goroutineè°ƒåº¦åŸç†ï¼Œæˆ‘è¿™é‡Œç•™ä¸ªæ€è€ƒé¢˜ã€‚è¯·çœ‹ä¸‹é¢ä»£ç ï¼š</p><pre><code class=\"language-plain\">func deadloop() {\n    for {\n    } \n}\n\nfunc main() {\n    go deadloop()\n    for {\n        time.Sleep(time.Second * 1)\n        fmt.Println(\"I got scheduled!\")\n    }\n}\n</code></pre><p>æˆ‘çš„é—®é¢˜æ˜¯ï¼š</p><ol>\n<li>\n<p>åœ¨ä¸€ä¸ªæ‹¥æœ‰å¤šæ ¸å¤„ç†å™¨çš„ä¸»æœºä¸Šï¼Œä½¿ç”¨Go 1.13.xç‰ˆæœ¬è¿è¡Œè¿™ä¸ªç¤ºä¾‹ä»£ç ï¼Œä½ åœ¨å‘½ä»¤è¡Œç»ˆç«¯ä¸Šæ˜¯å¦èƒ½çœ‹åˆ°â€œI got scheduled!â€è¾“å‡ºå‘¢ï¼Ÿä¹Ÿå°±æ˜¯main goroutineåœ¨åˆ›å»ºdeadloop goroutineä¹‹åæ˜¯å¦èƒ½ç»§ç»­å¾—åˆ°è°ƒåº¦å‘¢ï¼Ÿ</p>\n</li>\n<li>\n<p>æˆ‘ä»¬é€šè¿‡ä»€ä¹ˆæ–¹æ³•å¯ä»¥è®©ä¸Šé¢ç¤ºä¾‹ä¸­çš„main goroutineï¼Œåœ¨åˆ›å»ºdeadloop goroutineä¹‹åæ— æ³•ç»§ç»­å¾—åˆ°è°ƒåº¦ï¼Ÿ</p>\n</li>\n</ol><p>æ¬¢è¿ä½ æŠŠè¿™èŠ‚è¯¾åˆ†äº«ç»™æ›´å¤šå¯¹Gouroutineè°ƒåº¦åŸç†æ„Ÿå…´è¶£çš„æœ‹å‹ã€‚æˆ‘æ˜¯Tony Baiï¼Œæˆ‘ä»¬ä¸‹èŠ‚è¯¾è§ã€‚</p>","neighbors":{"left":{"article_title":"31ï½œå¹¶å‘ï¼šGoçš„å¹¶å‘æ–¹æ¡ˆå®ç°æ–¹æ¡ˆæ˜¯æ€æ ·çš„ï¼Ÿ","id":475959},"right":{"article_title":"33ï½œå¹¶å‘ï¼šå°channelä¸­è•´å«å¤§æ™ºæ…§","id":477365}},"comments":[{"had_liked":false,"id":330180,"user_name":"Geek_cca544","can_delete":false,"product_type":"c1","uid":2889777,"ip_address":"","ucode":"88CDFF5A9EE0A2","user_header":"","comment_is_top":false,"comment_ctime":1641831570,"is_pvip":false,"replies":[{"id":120537,"content":"âœ…","user_name":"ä½œè€…å›å¤","user_name_real":"ç¼–è¾‘","uid":1026224,"ctime":1642049095,"ip_address":"","comment_id":330180,"utype":1}],"discussion_count":1,"race_medal":0,"score":2,"product_id":100093501,"comment_content":"go1.13çš„è¯åŠ ä¸Šruntime.GOMAXPROCS(1) main goroutineåœ¨åˆ›å»º deadloop goroutine ä¹‹åå°±æ— æ³•ç»§ç»­å¾—åˆ°è°ƒåº¦\nä½†å¦‚æœæ˜¯go1.14ä¹‹åçš„è¯å³ä½¿åŠ ä¸Šruntime.GOMAXPROCS(1) main goroutineåœ¨åˆ›å»º deadloop goroutine ä¹‹åè¿˜æ˜¯å¯ä»¥å¾—åˆ°è°ƒåº¦ï¼Œåº”è¯¥æ˜¯å› ä¸ºå¢åŠ äº†å¯¹éåä½œçš„æŠ¢å å¼è°ƒåº¦çš„æ”¯æŒ","like_count":49},{"had_liked":false,"id":330644,"user_name":"lesserror","can_delete":false,"product_type":"c1","uid":1351076,"ip_address":"","ucode":"25A54D1165FCF6","user_header":"https://static001.geekbang.org/account/avatar/00/14/9d/a4/e481ae48.jpg","comment_is_top":false,"comment_ctime":1642082247,"is_pvip":false,"replies":[{"id":121546,"content":"1.æŒ‰ç…§Dmitry VyukovåŸæ–‡çš„æ„æ€ï¼š é›†ä¸­çŠ¶æ€(centralized state)ï¼Œæˆ‘ç†è§£å°±æ˜¯ä¸€æŠŠå…¨å±€é”è¦ä¿æŠ¤çš„æ•°æ®å¤ªå¤šã€‚è¿™æ ·æ— è®ºè®¿é—®å“ªä¸ªæ•°æ®ï¼Œéƒ½è¦é”è¿™æŠŠå…¨å±€é”ã€‚æ•°æ®å±€éƒ¨æ€§å·®æ˜¯å› ä¸ºæ¯ä¸ªméƒ½ä¼šç¼“å­˜å®ƒæ‰§è¡Œçš„ä»£ç æˆ–æ•°æ®ï¼Œä½†æ˜¯å¦‚æœåœ¨mä¹‹é—´é¢‘ç¹ä¼ é€’goroutineï¼Œé‚£ä¹ˆè¿™ç§å±€éƒ¨ç¼“å­˜çš„æ„ä¹‰å°±æ²¡æœ‰äº†ã€‚æ— æ³•å®ç°å±€éƒ¨ç¼“å­˜å¸¦æ¥çš„æ€§èƒ½æå‡ã€‚\n\n2. runtime.morestack_noctxt æ˜¯ä¸€ä¸ªå‡½æ•°ã€‚\n3. åä½œå¼ï¼šå¤§å®¶éƒ½æŒ‰äº‹å…ˆå®šä¹‰å¥½çš„è§„åˆ™æ¥ï¼Œæ¯”å¦‚ï¼šä¸€ä¸ªgoroutineæ‰§è¡Œå®Œåï¼Œé€€å‡ºï¼Œè®©å‡ºpï¼Œç„¶åä¸‹ä¸€ä¸ªgoroutineè¢«è°ƒåº¦åˆ°pä¸Šè¿è¡Œã€‚è¿™æ ·åšçš„ç¼ºç‚¹å°±åœ¨äº æ˜¯å¦è®©å‡ºpçš„å†³å®šæƒåœ¨groutineè‡ªèº«ã€‚ä¸€æ—¦æŸä¸ªgä¸ä¸»åŠ¨è®©å‡ºpæˆ–æ‰§è¡Œæ—¶é—´è¾ƒé•¿ï¼Œé‚£ä¹ˆåé¢çš„goroutineåªèƒ½ç­‰ç€ï¼Œæ²¡æœ‰æ–¹æ³•è®©å‰è€…è®©å‡ºpï¼Œå¯¼è‡´å»¶è¿Ÿç”šè‡³é¥¿æ­»ã€‚è€Œéåä½œ: å°±æ˜¯ç”±runtimeæ¥å†³å®šä¸€ä¸ªgoroutineè¿è¡Œå¤šé•¿æ—¶é—´ï¼Œå¦‚æœä½ ä¸ä¸»åŠ¨è®©å‡ºï¼Œå¯¹ä¸èµ·ï¼Œæˆ‘æœ‰æ‰‹æ®µå¯ä»¥æŠ¢å ä½ ï¼ŒæŠŠä½ è¸¢å‡ºå»ï¼Œè®©åé¢çš„goroutineè¿›æ¥è¿è¡Œã€‚\n\n4. æŒ‚èµ·è¿™é‡Œä½ å¯ä»¥ç†è§£ä¸ºæš‚åœè¿è¡Œï¼Œç­‰å¾…ä¸‹ä¸€æ¬¡è°ƒåº¦ã€‚\n5. å½“è¿›è¡Œä¸€äº›æ…¢ç³»ç»Ÿè°ƒç”¨çš„æ—¶å€™ï¼Œæ¯”å¦‚å¸¸è§„æ–‡ä»¶ioï¼Œæ‰§è¡Œç³»ç»Ÿè°ƒç”¨çš„må°±è¦å’Œgä¸€èµ·æŒ‚èµ·ï¼Œè¿™æ˜¯osçš„è¦æ±‚ï¼Œä¸æ˜¯go runtimeçš„è¦æ±‚ã€‚æ¯•ç«ŸçœŸæ­£æ‰§è¡Œä»£ç çš„è¿˜æ˜¯mã€‚\n ","user_name":"ä½œè€…å›å¤","user_name_real":"ç¼–è¾‘","uid":1026224,"ctime":1643448170,"ip_address":"","comment_id":330644,"utype":1}],"discussion_count":1,"race_medal":0,"score":2,"product_id":100093501,"comment_content":"å¤§ç™½è€å¸ˆè¿™ç¯‡ç®—æ˜¯è®©æˆ‘é‡æ–°å¯¹Goçš„Gã€Pã€Mæ¨¡å‹æœ‰äº†ä¸€ä¸ªæ–°çš„è®¤è¯†ã€‚æ„Ÿè°¢ã€‚ä¸è¿‡è¿˜æ˜¯æœ‰å‡ å¤„ç–‘æƒ‘çš„åœ°æ–¹ï¼š\n\n1. æ€ä¹ˆç†è§£æ–‡ä¸­çš„ï¼šâ€œé›†ä¸­çŠ¶æ€å­˜å‚¨â€å’Œâ€œæ•°æ®å±€éƒ¨æ€§è¾ƒå·®â€ï¼Œèƒ½å†è¿›ä¸€æ­¥è§£é‡Šä¸€ä¸‹ä¹ˆï¼Ÿ\n\n2. ç¼–è¯‘å™¨åœ¨æ¯ä¸ªå‡½æ•°æˆ–æ–¹æ³•çš„å…¥å£å¤„åŠ ä¸Šäº†ä¸€æ®µé¢å¤–çš„ä»£ç  (runtime.morestack_noctxt)ï¼Œæ‹¬å·ä¸­çš„ï¼šruntime.morestack_noctxt è¿™æ˜¯ä¸€ä¸ªæ–‡ä»¶ä¹ˆï¼Ÿ\n\n3. æ€ä¹ˆç†è§£â€œåä½œå¼â€ã€â€œéåä½œå¼â€å‘¢ï¼Ÿçœ‹äº†æ–‡ç« è¿˜æ˜¯æ²¡å¤ªæ˜ç™½ã€‚\n\n4. å…³äºæŒ‚èµ·ï¼Œç™¾åº¦çš„è¯´æ³•å¤§æ¦‚æ˜¯ï¼šâ€œæš‚æ—¶è¢«æ·˜æ±°å‡ºå†…å­˜çš„è¿›ç¨‹ã€‚â€ï¼Œè¿™é‡Œè¯¥æ€ä¹ˆç†è§£å‘¢ï¼Ÿ\n\n5. ä¸ºä»€ä¹ˆ Mæœ‰æ—¶å¿…é¡»è¦ä¸ G ä¸€èµ·æŒ‚èµ·ï¼ŸM ä¸æ˜¯å¯ä»¥ä¸ä¿å­˜ Gçš„çŠ¶æ€çš„å—ï¼ŸMä¸èƒ½ç›´æ¥å»ç»‘å®šåˆ«çš„på—ï¼Ÿä¸ºä»€ä¹ˆè¦é¢‘ç¹çš„æŒ‚èµ·å‘¢ï¼Ÿ\n\nPSï¼šè€å¸ˆçš„æ–‡æ¡£é“¾æ¥å¥½è¯„ï¼Œæœ€åŸå§‹çš„å‡ºå¤„æ ‡å‡†çš„å¾ˆæ˜ç¡®ã€‚","like_count":33,"discussions":[{"author":{"id":1026224,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/a8/b0/6f87ab08.jpg","nickname":"Tony Bai","note":"","ucode":"B6B08985F6FA89","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":545773,"discussion_content":"âœ…","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1642049095,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":338132,"user_name":"ivhong","can_delete":false,"product_type":"c1","uid":2659871,"ip_address":"","ucode":"9947B228807AC9","user_header":"https://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTJ8ic8eLTo5rnqIMJicUfpkVBrOUJAW4fANicKIbHdC54O9SOdwSoeK6o8icibaUbh7ZUXAkGF9zwHqo0Q/132","comment_is_top":false,"comment_ctime":1647314896,"is_pvip":false,"replies":[{"id":123643,"content":"ğŸ‘","user_name":"ä½œè€…å›å¤","user_name_real":"ç¼–è¾‘","uid":1026224,"ctime":1647401258,"ip_address":"","comment_id":338132,"utype":1}],"discussion_count":1,"race_medal":0,"score":2,"product_id":100093501,"comment_content":"è°¢è°¢å¤§ç™½è€å¸ˆï¼Œèƒ½æŠŠè¿™ä¹ˆæ™¦æ¶©çš„åŸç†è®²çš„è¿™ä¹ˆæ¸…æ¥šã€‚æˆ‘åå¤çœ‹äº†å¾ˆå¤šéï¼Œåšäº†å¦‚ä¸‹æ€»ç»“ï¼Œä¸çŸ¥é“æ˜¯ä¸æ˜¯åˆç†ï¼Œå¸Œæœ›è€å¸ˆé—²æš‡ä¹‹ä½™ç»™äºˆæŒ‡æ­£ï¼ŒğŸ™ã€‚\nåœ¨æ–‡ä¸­æåŠçš„GPMï¼Œä»¥åŠGPMä¹‹å‰çš„ç›¸äº’é…åˆï¼Œå®Œæˆäº†goçš„å¹¶å‘åŠŸèƒ½ã€‚\n\nGï¼šå¯ä»¥çœ‹ä½œå…³é”®å­—go åé¢è·Ÿç€çš„å¯æ‰§è¡Œä»£ç å—ï¼ˆå³goroutineï¼‰ï¼Œå½“ç„¶åŒ…å«è¿™ä¸ªä»£ç å—çš„ä¸€äº›æœ¬èº«çš„ä¿¡æ¯ï¼ˆæ¯”å¦‚æ ˆä¿¡æ¯ã€çŠ¶æ€ç­‰ç­‰ä¸€äº›å¿…è¦çš„å±æ€§ï¼‰ã€‚å¦å¤–å­˜åœ¨ä¸€ä¸ªGçš„å…¨å±€é˜Ÿåˆ—ï¼Œåªè¦æ˜¯éœ€è¦æ‰§è¡Œçš„ goroutine éƒ½ä¼šè¢«æ”¾å€’è¿™ä¸ªå…¨å±€é˜Ÿåˆ—é‡Œã€‚\n\nPï¼šå¯ä»¥çœ‹ä½œé€»è¾‘ä¸Šçš„â€œä»»åŠ¡å¤„ç†å™¨â€ï¼Œgoæœ‰å¤šä¸ªè¿™ä¸ªå¤„ç†å™¨ï¼Œå…·ä½“çš„æ•°é‡ç”±runtime.GOMAXPROCS(1)æŒ‡å®šï¼Œå®ƒæœ‰ä¸‹é¢çš„æŒ‡è´£ï¼š\n    1. å®ƒæœ‰è‡ªå·±Gé˜Ÿåˆ—ã€‚å½“ä»–å‘ç°è‡ªå·±çš„é˜Ÿåˆ—ä¸ºç©ºæ—¶ï¼Œå¯ä»¥å»å…¨å±€Gé˜Ÿåˆ—é‡Œè·å–ç­‰å¾…æ‰§è¡Œçš„goroutineï¼Œç”šè‡³å¯ä»¥å»å…¶ä»–çš„Pçš„é˜Ÿåˆ—é‡ŒæŠ¢ç”¨goroutineã€‚ä»–æŠŠæ‹¿è¿‡æ¥çš„goroutineæ”¾åˆ°è‡ªå·±çš„é˜Ÿåˆ—é‡Œ\n    2. ä»–å¯ä»¥æ‰¾åˆ°ä¸€ä¸ªç©ºé—²çš„Mä¸è‡ªå·±ç»‘å®šï¼Œç”¨æ¥è¿è¡Œè‡ªå·±é˜Ÿåˆ—ä¸­çš„goroutineï¼Œå¦‚æœæ²¡æœ‰ç©ºé—²çš„Mï¼Œåˆ™åˆ›å»ºä¸€ä¸ªMæ¥ç»‘å®š\n    3. è¢«Pç»‘å®šçš„Mï¼Œå¯ä»¥è‡ªå·±ä¸»åŠ¨çš„ä¸Pè§£ç»‘ï¼Œå½“På‘ç°è‡ªå·±çš„Mè¢«è§£ç»‘ï¼Œå°±æ‰§è¡Œ2\n    4. å¦‚æœè‡ªå·±é˜Ÿåˆ—ä¸­æ²¡æœ‰goroutineï¼Œä¹Ÿæ— æ³•ä»â€œå¤–é¢â€è·å–goroutineï¼Œåˆ™ä¸Mè§£ç»‘ï¼ˆè§£ç»‘Mæ—¶ï¼Œæ˜¯æŒ‰ä»€ä¹ˆé€»è¾‘é€‰æ‹©æŒ‚èµ·Mæˆ–è€…é‡Šæ”¾Må‘¢ï¼Ÿï¼‰\n\nMï¼šç‰©ç†çš„å¤„ç†å™¨ï¼Œå…·ä½“æ‰§è¡Œgoroutineçš„ç³»ç»Ÿçº¿ç¨‹ï¼Œæ‰€æœ‰goroutineéƒ½æ˜¯åœ¨Mä¸­æ‰§è¡Œçš„ï¼Œå®ƒè¢«Påˆ›å»ºï¼Œä¸Pç»‘å®šåå¯æ‰§è¡ŒPé˜Ÿåˆ—ä¸­çš„goroutineï¼Œåœ¨æ‰§è¡Œgoroutineä¼šå¤„ç†3ä¸­æƒ…å†µä¿è¯å¹¶å‘æ˜¯é¡ºåˆ©çš„ï¼ˆä¸ä¼šå‘ç”Ÿâ€œé¥¿æ­»â€ï¼Œèµ„æºåˆ†é…ä¸å¹³ç­‰çš„æƒ…å†µï¼‰\n    1. å½“Gé•¿æ—¶é—´è¿è¡Œæ—¶ï¼Œå¯ä»¥è¢«Goæš‚åœæ‰§è¡Œè€Œè¢«ç§»å‡ºMï¼ˆæ˜¯ä¸æ˜¯æ”¾åˆ°å…¨å±€Gé˜Ÿåˆ—å‘¢ï¼Ÿï¼‰ï¼Œç­‰å¾…ä¸‹æ¬¡è¿è¡Œï¼ˆå³æŠ¢å å¼è°ƒåº¦ï¼‰ã€‚\n    2. å¦‚æœGå‘ç”Ÿäº†channel ç­‰å¾…æˆ–è€… ç½‘ç»œI&#47;Oè¯·æ±‚ï¼Œåˆ™æŠŠGæ”¾åˆ°æŸä¸ªç­‰å¾…é˜Ÿåˆ—ä¸­ï¼ŒMç»§ç»­æ‰§è¡Œä¸‹ä¸€goroutineï¼Œå½“Gç­‰å¾…çš„ç»“æœè¿”å›æ—¶ï¼Œä¼šå”¤é†’â€œGâ€ï¼Œå¹¶æŠŠå®ƒæ”¾å…¥åˆ°å…¨å±€Gçš„é˜Ÿåˆ—ä¸­ï¼Œç­‰å¾…Pçš„è·å–ï¼ˆè¿™é‡Œä¸çŸ¥é“ç†è§£çš„å¯¹ä¸å¯¹ï¼Ÿï¼‰ã€‚\n    3. å¦‚æœGäº§ç”Ÿäº†ç³»ç»Ÿè°ƒç”¨ï¼Œåˆ™Mä¸Pè§£ç»‘ï¼Œç„¶åMå’Œå®ƒæ­£æ‰§è¡Œçš„Gè¢«æ“ä½œç³»ç»Ÿâ€œæŒ‚èµ·â€ç­‰å¾…æ“ä½œç³»ç»Ÿçš„ä¸­æ–­è¿”å›ï¼ˆå¯¹äºæ“ä½œç³»ç»Ÿè€Œè¨€ï¼ŒMå’ŒGæ˜¯ä¸€å›äº‹ï¼›è€Œå¯¹äºGOæ¥è¯´ï¼ŒGåªæœ‰èƒ½åœ¨Mä¸­è¿è¡Œï¼Œåªæœ‰è¿è¡Œæ‰è§¦å‘å‘ç³»ç»Ÿè°ƒç”¨ï¼‰ã€‚\n\n","like_count":20,"discussions":[{"author":{"id":1026224,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/a8/b0/6f87ab08.jpg","nickname":"Tony Bai","note":"","ucode":"B6B08985F6FA89","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":548927,"discussion_content":"1.æŒ‰ç…§Dmitry VyukovåŸæ–‡çš„æ„æ€ï¼š é›†ä¸­çŠ¶æ€(centralized state)ï¼Œæˆ‘ç†è§£å°±æ˜¯ä¸€æŠŠå…¨å±€é”è¦ä¿æŠ¤çš„æ•°æ®å¤ªå¤šã€‚è¿™æ ·æ— è®ºè®¿é—®å“ªä¸ªæ•°æ®ï¼Œéƒ½è¦é”è¿™æŠŠå…¨å±€é”ã€‚æ•°æ®å±€éƒ¨æ€§å·®æ˜¯å› ä¸ºæ¯ä¸ªméƒ½ä¼šç¼“å­˜å®ƒæ‰§è¡Œçš„ä»£ç æˆ–æ•°æ®ï¼Œä½†æ˜¯å¦‚æœåœ¨mä¹‹é—´é¢‘ç¹ä¼ é€’goroutineï¼Œé‚£ä¹ˆè¿™ç§å±€éƒ¨ç¼“å­˜çš„æ„ä¹‰å°±æ²¡æœ‰äº†ã€‚æ— æ³•å®ç°å±€éƒ¨ç¼“å­˜å¸¦æ¥çš„æ€§èƒ½æå‡ã€‚\n\n2. runtime.morestack_noctxt æ˜¯ä¸€ä¸ªå‡½æ•°ã€‚\n3. åä½œå¼ï¼šå¤§å®¶éƒ½æŒ‰äº‹å…ˆå®šä¹‰å¥½çš„è§„åˆ™æ¥ï¼Œæ¯”å¦‚ï¼šä¸€ä¸ªgoroutineæ‰§è¡Œå®Œåï¼Œé€€å‡ºï¼Œè®©å‡ºpï¼Œç„¶åä¸‹ä¸€ä¸ªgoroutineè¢«è°ƒåº¦åˆ°pä¸Šè¿è¡Œã€‚è¿™æ ·åšçš„ç¼ºç‚¹å°±åœ¨äº æ˜¯å¦è®©å‡ºpçš„å†³å®šæƒåœ¨groutineè‡ªèº«ã€‚ä¸€æ—¦æŸä¸ªgä¸ä¸»åŠ¨è®©å‡ºpæˆ–æ‰§è¡Œæ—¶é—´è¾ƒé•¿ï¼Œé‚£ä¹ˆåé¢çš„goroutineåªèƒ½ç­‰ç€ï¼Œæ²¡æœ‰æ–¹æ³•è®©å‰è€…è®©å‡ºpï¼Œå¯¼è‡´å»¶è¿Ÿç”šè‡³é¥¿æ­»ã€‚è€Œéåä½œ: å°±æ˜¯ç”±runtimeæ¥å†³å®šä¸€ä¸ªgoroutineè¿è¡Œå¤šé•¿æ—¶é—´ï¼Œå¦‚æœä½ ä¸ä¸»åŠ¨è®©å‡ºï¼Œå¯¹ä¸èµ·ï¼Œæˆ‘æœ‰æ‰‹æ®µå¯ä»¥æŠ¢å ä½ ï¼ŒæŠŠä½ è¸¢å‡ºå»ï¼Œè®©åé¢çš„goroutineè¿›æ¥è¿è¡Œã€‚\n\n4. æŒ‚èµ·è¿™é‡Œä½ å¯ä»¥ç†è§£ä¸ºæš‚åœè¿è¡Œï¼Œç­‰å¾…ä¸‹ä¸€æ¬¡è°ƒåº¦ã€‚\n5. å½“è¿›è¡Œä¸€äº›æ…¢ç³»ç»Ÿè°ƒç”¨çš„æ—¶å€™ï¼Œæ¯”å¦‚å¸¸è§„æ–‡ä»¶ioï¼Œæ‰§è¡Œç³»ç»Ÿè°ƒç”¨çš„må°±è¦å’Œgä¸€èµ·æŒ‚èµ·ï¼Œè¿™æ˜¯osçš„è¦æ±‚ï¼Œä¸æ˜¯go runtimeçš„è¦æ±‚ã€‚æ¯•ç«ŸçœŸæ­£æ‰§è¡Œä»£ç çš„è¿˜æ˜¯mã€‚\n ","likes_number":1,"is_delete":false,"is_hidden":false,"ctime":1643448170,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":346529,"user_name":"éº¦èŠ’æå®¢","can_delete":false,"product_type":"c1","uid":2611257,"ip_address":"","ucode":"34983809B39576","user_header":"https://static001.geekbang.org/account/avatar/00/27/d8/39/acb7e16e.jpg","comment_is_top":false,"comment_ctime":1653216030,"is_pvip":false,"replies":[{"id":126414,"content":"å¥½é—®é¢˜ï¼ä¸è¿‡å½“ç½‘ç»œI&#47;Oé˜»å¡æ—¶ï¼ŒMçœŸä¸ä¼šé˜»å¡ã€‚\n\nå› ä¸ºruntimeå±‚å®ç°äº†netpollerï¼Œnetpolleræ˜¯åŸºäºosæä¾›çš„I&#47;Oå¤šè·¯å¤ç”¨æ¨¡å‹å®ç°çš„(æ¯”å¦‚:linuxä¸Šçš„epoll)ï¼Œè¿™å…è®¸ä¸€ä¸ªçº¿ç¨‹å¤„ç†å¤šä¸ªsocketã€‚è¿™å°±ä½¿å¾—å½“æŸä¸ªgoroutineçš„socketå‘é€i&#47;oé˜»å¡æ—¶ï¼Œä»…ä¼šè®©goroutineå˜ä¸ºé˜»å¡çŠ¶æ€ï¼Œruntimeä¼šå°†å¯¹åº”çš„socketä¸goroutineåŠ å…¥åˆ°netpollerçš„ç›‘å¬ä¸­ï¼Œç„¶åMç»§ç»­æ‰§è¡Œå…¶ä»–goroutineçš„ä»»åŠ¡ã€‚ç­‰netpollerç›‘è§†åˆ°ä¹‹å‰çš„socketå¯è¯»&#47;å¯å†™æ—¶ï¼Œå†æŠŠå¯¹åº”çš„goroutineå”¤é†’ç»§ç»­æ‰§è¡Œç½‘ç»œi&#47;oã€‚\n\n","user_name":"ä½œè€…å›å¤","user_name_real":"ç¼–è¾‘","uid":1026224,"ctime":1653267795,"ip_address":"","comment_id":346529,"utype":1}],"discussion_count":1,"race_medal":0,"score":2,"product_id":100093501,"comment_content":"è€å¸ˆæ‚¨å¥½ï¼ŒGé‡åˆ°ç½‘ç»œIOé˜»å¡æ—¶ï¼ŒçœŸæ­£çš„çº¿ç¨‹å³Mä¸åº”è¯¥ä¹Ÿé˜»å¡å—ï¼Ÿ","like_count":18,"discussions":[{"author":{"id":1026224,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/a8/b0/6f87ab08.jpg","nickname":"Tony Bai","note":"","ucode":"B6B08985F6FA89","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":556493,"discussion_content":"ğŸ‘","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1647401259,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":330052,"user_name":"bearlu","can_delete":false,"product_type":"c1","uid":1030862,"ip_address":"","ucode":"14F260C8B24E27","user_header":"https://static001.geekbang.org/account/avatar/00/0f/ba/ce/fd45714f.jpg","comment_is_top":false,"comment_ctime":1641776886,"is_pvip":true,"replies":[{"id":120492,"content":"æ¬§é•¿å¤è€å¸ˆç»´æŠ¤çš„è¿™ä¸ªgo historyä¸­æœ‰å…³è°ƒåº¦å™¨çš„æ¼”åŒ–å¯ä»¥å‚è€ƒï¼šhttps:&#47;&#47;golang.design&#47;history&#47;#scheduler","user_name":"ä½œè€…å›å¤","user_name_real":"ç¼–è¾‘","uid":1026224,"ctime":1642043606,"ip_address":"","comment_id":330052,"utype":1}],"discussion_count":2,"race_medal":0,"score":2,"product_id":100093501,"comment_content":"è€å¸ˆï¼Œæƒ³å­¦ä¹ goroutineè°ƒåº¦å™¨ï¼Œæ¼”è¿›çš„å…³é”®ç‰ˆæœ¬ï¼Œä¾æ¬¡æ˜¯goçš„ä»€ä¹ˆå‘è¡Œç‰ˆï¼Ÿè¿˜æœ‰ä»€ä¹ˆç›¸å…³èµ„æ–™ä¹¦ç±ï¼Ÿè°¢è°¢è€å¸ˆ","like_count":6,"discussions":[{"author":{"id":1026224,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/a8/b0/6f87ab08.jpg","nickname":"Tony Bai","note":"","ucode":"B6B08985F6FA89","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":573203,"discussion_content":"å¥½é—®é¢˜ï¼ä¸è¿‡å½“ç½‘ç»œI/Oé˜»å¡æ—¶ï¼ŒMçœŸä¸ä¼šé˜»å¡ã€‚\n\nå› ä¸ºruntimeå±‚å®ç°äº†netpollerï¼Œnetpolleræ˜¯åŸºäºosæä¾›çš„I/Oå¤šè·¯å¤ç”¨æ¨¡å‹å®ç°çš„(æ¯”å¦‚:linuxä¸Šçš„epoll)ï¼Œè¿™å…è®¸ä¸€ä¸ªçº¿ç¨‹å¤„ç†å¤šä¸ªsocketã€‚è¿™å°±ä½¿å¾—å½“æŸä¸ªgoroutineçš„socketå‘é€i/oé˜»å¡æ—¶ï¼Œä»…ä¼šè®©goroutineå˜ä¸ºé˜»å¡çŠ¶æ€ï¼Œruntimeä¼šå°†å¯¹åº”çš„socketä¸goroutineåŠ å…¥åˆ°netpollerçš„ç›‘å¬ä¸­ï¼Œç„¶åMç»§ç»­æ‰§è¡Œå…¶ä»–goroutineçš„ä»»åŠ¡ã€‚ç­‰netpollerç›‘è§†åˆ°ä¹‹å‰çš„socketå¯è¯»/å¯å†™æ—¶ï¼Œå†æŠŠå¯¹åº”çš„goroutineå”¤é†’ç»§ç»­æ‰§è¡Œç½‘ç»œi/oã€‚\n\n","likes_number":1,"is_delete":false,"is_hidden":false,"ctime":1653267795,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":354245,"user_name":"Mr_D","can_delete":false,"product_type":"c1","uid":1127385,"ip_address":"è¾½å®","ucode":"57843FA1C1F974","user_header":"http://thirdwx.qlogo.cn/mmopen/vi_32/7hOJBKZVrJD8ayZoYnq0ECFsoWf9yx6eyq3JU8p1449A6cKEp5rSpicJRg5vH3HZgq5YwbpGicBvyARFutcPLGgw/132","comment_is_top":false,"comment_ctime":1660210621,"is_pvip":false,"replies":[{"id":128891,"content":"å¯¹ï¼Œgoroutineé€€å‡ºåï¼Œruntimeå±‚çš„Gå¯¹è±¡ä¼šè¢«æ”¾å…¥ä¸€ä¸ªFree Gå¯¹è±¡çš„æ± å­ä¸­ï¼Œåç»­æœ‰æ–°Goroutineåˆ›å»ºæ—¶ï¼Œä¼˜å…ˆä»æ± å­é‡Œgetä¸€ä¸ªã€‚å¯ä»¥çœ‹Goæºç ï¼šruntime&#47;proc.goä¸­çš„ä»£ç ã€‚","user_name":"ä½œè€…å›å¤","user_name_real":"ç¼–è¾‘","uid":1026224,"ctime":1660312275,"ip_address":"è¾½å®","comment_id":354245,"utype":1}],"discussion_count":1,"race_medal":0,"score":2,"product_id":100093501,"comment_content":"è¯·é—®Gçš„å¯é‡ç”¨å…·ä½“æŒ‡ä»€ä¹ˆå‘¢ï¼Ÿæ˜¯é’ˆå¯¹å·²ç»è¿è¡Œç»“æŸçš„Gç•™ä¸‹çš„å†…å­˜ç©ºé—´ï¼Œè¿›è¡Œç›¸å…³æ•°æ®çš„é‡å¡«ä¹ˆ","like_count":4,"discussions":[{"author":{"id":1026224,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/a8/b0/6f87ab08.jpg","nickname":"Tony Bai","note":"","ucode":"B6B08985F6FA89","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":545713,"discussion_content":"æ¬§é•¿å¤è€å¸ˆç»´æŠ¤çš„è¿™ä¸ªgo historyä¸­æœ‰å…³è°ƒåº¦å™¨çš„æ¼”åŒ–å¯ä»¥å‚è€ƒï¼šhttps://golang.design/history/#scheduler","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1642043606,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":1,"child_discussions":[{"author":{"id":1030862,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/ba/ce/fd45714f.jpg","nickname":"bearlu","note":"","ucode":"14F260C8B24E27","race_medal":0,"user_type":1,"is_pvip":true},"reply_author":{"id":1026224,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/a8/b0/6f87ab08.jpg","nickname":"Tony Bai","note":"","ucode":"B6B08985F6FA89","race_medal":0,"user_type":2,"is_pvip":false},"discussion":{"id":545716,"discussion_content":"è°¢è°¢è€å¸ˆ","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1642043973,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":545713,"ip_address":"","group_id":0},"score":545716,"extra":""}]}]},{"had_liked":false,"id":357786,"user_name":"å¾®å¾®è¶…çº§ä¸¹ğŸ’«","can_delete":false,"product_type":"c1","uid":2996016,"ip_address":"åŒ—äº¬","ucode":"ABEFC2FA673BE4","user_header":"https://static001.geekbang.org/account/avatar/00/2d/b7/30/c1e4f5b5.jpg","comment_is_top":false,"comment_ctime":1663640366,"is_pvip":false,"replies":[{"id":130250,"content":"å°±æ˜¯è¯´å¯¹å¸¸è§„æ–‡ä»¶çš„è¯»å†™æ“ä½œï¼ˆå› ä¸ºæ˜¯ç³»ç»Ÿè°ƒç”¨ï¼‰ä¾ç„¶ä¼šé˜»å¡Mã€‚","user_name":"ä½œè€…å›å¤","user_name_real":"ç¼–è¾‘","uid":1026224,"ctime":1663745625,"ip_address":"åŒ—äº¬","comment_id":357786,"utype":1}],"discussion_count":1,"race_medal":0,"score":2,"product_id":100093501,"comment_content":"è¯·é—®å¸¸è§„æ–‡ä»¶æ˜¯ä¸æ”¯æŒç›‘å¬çš„ï¼ˆpollableï¼‰æ˜¯ä»€ä¹ˆæ„æ€å‘€ï¼Ÿ","like_count":3,"discussions":[{"author":{"id":1026224,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/a8/b0/6f87ab08.jpg","nickname":"Tony Bai","note":"","ucode":"B6B08985F6FA89","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":588408,"discussion_content":"å°±æ˜¯è¯´å¯¹å¸¸è§„æ–‡ä»¶çš„è¯»å†™æ“ä½œï¼ˆå› ä¸ºæ˜¯ç³»ç»Ÿè°ƒç”¨ï¼‰ä¾ç„¶ä¼šé˜»å¡Mã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1663745626,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"åŒ—äº¬","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":347804,"user_name":"è·¯è¾¹çš„çŒª","can_delete":false,"product_type":"c1","uid":2057354,"ip_address":"","ucode":"92F7C082E44FC4","user_header":"https://static001.geekbang.org/account/avatar/00/1f/64/8a/bc8cb43c.jpg","comment_is_top":false,"comment_ctime":1654444691,"is_pvip":false,"replies":[{"id":126782,"content":"ç”±äºgoè¿è¡Œæ—¶netpollerçš„å­˜åœ¨ï¼Œæˆ‘ä»¬å¾ˆéš¾ç²¾ç¡®åŒºåˆ†ã€‚è¿™ç§â€œç½‘ç»œioâ€ä¼šè¢«runtimeè½¬æ¢ä¸ºgoroutineçš„è°ƒåº¦ç­‰ï¼Œä¸ä¸€å®šçœŸçš„å®æ–½ç½‘ç»œioã€‚","user_name":"ä½œè€…å›å¤","user_name_real":"ç¼–è¾‘","uid":1026224,"ctime":1654483307,"ip_address":"","comment_id":347804,"utype":1}],"discussion_count":1,"race_medal":0,"score":2,"product_id":100093501,"comment_content":"ç¬¬ä¸€ç§ï¼Œå› ä¸ºç½‘ç»œioå¯¼è‡´é˜»å¡çš„å¤„ç†æ–¹å¼è¿™é‡Œã€‚æˆ‘æƒ³é—®ï¼Œç½‘ç»œioåŠ¿å¿…ä¼šå¼•èµ·ç³»ç»Ÿè°ƒç”¨ï¼Œæ¯”å¦‚æœ€åŸºç¡€çš„å»ºç«‹tcpè¿æ¥è¿™äº›ï¼Œé‚£è¿™å—å„¿æ˜¯å’‹åŒºåˆ†ç³»ç»Ÿè°ƒç”¨å’Œç½‘ç»œioçš„å‘¢ï¼Ÿ","like_count":3,"discussions":[{"author":{"id":1026224,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/a8/b0/6f87ab08.jpg","nickname":"Tony Bai","note":"","ucode":"B6B08985F6FA89","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":574941,"discussion_content":"ç”±äºgoè¿è¡Œæ—¶netpollerçš„å­˜åœ¨ï¼Œæˆ‘ä»¬å¾ˆéš¾ç²¾ç¡®åŒºåˆ†ã€‚è¿™ç§â€œç½‘ç»œioâ€ä¼šè¢«runtimeè½¬æ¢ä¸ºgoroutineçš„è°ƒåº¦ç­‰ï¼Œä¸ä¸€å®šçœŸçš„å®æ–½ç½‘ç»œioã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1654483307,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":330132,"user_name":"å¥•","can_delete":false,"product_type":"c1","uid":1005391,"ip_address":"","ucode":"73CEA468CE70C3","user_header":"https://static001.geekbang.org/account/avatar/00/0f/57/4f/6fb51ff1.jpg","comment_is_top":false,"comment_ctime":1641808653,"is_pvip":false,"replies":[{"id":120493,"content":"è¯•è¯•å°†Pçš„æ•°é‡ç½®ä¸º1.","user_name":"ä½œè€…å›å¤","user_name_real":"ç¼–è¾‘","uid":1026224,"ctime":1642043655,"ip_address":"","comment_id":330132,"utype":1}],"discussion_count":2,"race_medal":0,"score":2,"product_id":100093501,"comment_content":"æ€è€ƒé¢˜ï¼š\næ˜¯ä¸æ˜¯ä¸ç®¡æ€ä¹ˆå¤„ç†ï¼Œmain goroutine  éƒ½ä¼šè¢«è°ƒåº¦ï¼Ÿ","like_count":3,"discussions":[{"author":{"id":1026224,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/a8/b0/6f87ab08.jpg","nickname":"Tony Bai","note":"","ucode":"B6B08985F6FA89","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":545714,"discussion_content":"è¯•è¯•å°†Pçš„æ•°é‡ç½®ä¸º1.","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1642043655,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":1,"child_discussions":[{"author":{"id":1005391,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/57/4f/6fb51ff1.jpg","nickname":"å¥•","note":"","ucode":"73CEA468CE70C3","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":1026224,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/a8/b0/6f87ab08.jpg","nickname":"Tony Bai","note":"","ucode":"B6B08985F6FA89","race_medal":0,"user_type":2,"is_pvip":false},"discussion":{"id":545715,"discussion_content":"å°†Pè®¾ç½®ä¸º1,ä¹Ÿä¼šè¿›è¡Œè°ƒåº¦çš„ï¼Œå°±æ˜¯é¢‘ç‡å°‘ä¸€äº›","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1642043925,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":545714,"ip_address":"","group_id":0},"score":545715,"extra":""}]}]},{"had_liked":false,"id":332676,"user_name":"å¤šé€‰å‚æ•°","can_delete":false,"product_type":"c1","uid":1248326,"ip_address":"","ucode":"B2294D80AB075F","user_header":"https://static001.geekbang.org/account/avatar/00/13/0c/46/dfe32cf4.jpg","comment_is_top":false,"comment_ctime":1643460929,"is_pvip":false,"replies":[{"id":121622,"content":"ã€ŠGoè¯­è¨€ç¬¬ä¸€è¯¾FAQã€‹ä¸­æœ‰è¿™æ–¹é¢çš„è§£ç­”ï¼Œä½ å¯ä»¥å…ˆçœ‹çœ‹ã€‚ https:&#47;&#47;tonybai.com&#47;go-course-faq ","user_name":"ä½œè€…å›å¤","user_name_real":"ç¼–è¾‘","uid":1026224,"ctime":1643544468,"ip_address":"","comment_id":332676,"utype":1}],"discussion_count":1,"race_medal":0,"score":2,"product_id":100093501,"comment_content":"æœ‰å‡ ä¸ªé—®é¢˜æƒ³é—®è€å¸ˆï¼š \n1. æ–‡ç« ä¸­æåˆ°çš„ Go è¿è¡Œæ—¶è¿™å—æ›´å¤šæ˜¯æŒ‡å“ªäº›å†…å®¹ï¼ŸGo è°ƒåº¦å™¨åº”è¯¥ä¹Ÿæ˜¯ Go è¿è¡Œæ—¶ä¸­çš„éƒ¨åˆ†å†…å®¹å§ï¼Ÿå°±æ˜¯ Go å¼€æºçš„æºä»£ç å—ï¼Ÿ\n2. æœ‰å…³ Go è¿è¡Œæ—¶æ¯”è¾ƒå¥½çš„èµ„æ–™æ¨èå—ï¼Ÿæ¯”å¦‚ Go è¿è¡Œæ—¶çš„æ¶æ„ã€Go è¿è¡Œæ—¶æ˜¯æ€ä¹ˆå’Œç”¨æˆ·ç¼–å†™çš„ä»£ç åˆåœ¨ä¸€èµ·çš„ï¼Œå› ä¸ºæˆ‘ç†è§£çš„ Go è¿è¡Œæ—¶ä¸åƒ JVM é‚£æ ·ï¼ŒGo æ˜¯ç¼–è¯‘æ€§çš„ï¼Œä¹Ÿå°±æ˜¯è¯´ä¼šå°†ç”¨æˆ·ç¼–å†™çš„ä»£ç å’Œ Go è¿è¡Œæ—¶ä»£ç ä¸€èµ·ç¼–è¯‘æˆäºŒè¿›åˆ¶ï¼Œç„¶åè¿è¡Œæ˜¯ä» Go è¿è¡Œæ—¶å¼€å§‹çš„ï¼Œç„¶ååœ¨ä»ç”¨æˆ·é€»è¾‘çš„ä»£ç å¼€å§‹ã€‚\n\nè€å¸ˆæœ‰ç©ºçš„æ—¶å€™éº»çƒ¦è§£ç­”ä¸‹ï¼Œè°¢è°¢è€å¸ˆï½","like_count":2,"discussions":[{"author":{"id":1026224,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/a8/b0/6f87ab08.jpg","nickname":"Tony Bai","note":"","ucode":"B6B08985F6FA89","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":549085,"discussion_content":"ã€ŠGoè¯­è¨€ç¬¬ä¸€è¯¾FAQã€‹ä¸­æœ‰è¿™æ–¹é¢çš„è§£ç­”ï¼Œä½ å¯ä»¥å…ˆçœ‹çœ‹ã€‚ https://tonybai.com/go-course-faq ","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1643544468,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":330180,"user_name":"Geek_cca544","can_delete":false,"product_type":"c1","uid":2889777,"ip_address":"","ucode":"88CDFF5A9EE0A2","user_header":"","comment_is_top":false,"comment_ctime":1641831570,"is_pvip":false,"replies":[{"id":120537,"content":"âœ…","user_name":"ä½œè€…å›å¤","user_name_real":"ç¼–è¾‘","uid":1026224,"ctime":1642049095,"ip_address":"","comment_id":330180,"utype":1}],"discussion_count":1,"race_medal":0,"score":2,"product_id":100093501,"comment_content":"go1.13çš„è¯åŠ ä¸Šruntime.GOMAXPROCS(1) main goroutineåœ¨åˆ›å»º deadloop goroutine ä¹‹åå°±æ— æ³•ç»§ç»­å¾—åˆ°è°ƒåº¦\nä½†å¦‚æœæ˜¯go1.14ä¹‹åçš„è¯å³ä½¿åŠ ä¸Šruntime.GOMAXPROCS(1) main goroutineåœ¨åˆ›å»º deadloop goroutine ä¹‹åè¿˜æ˜¯å¯ä»¥å¾—åˆ°è°ƒåº¦ï¼Œåº”è¯¥æ˜¯å› ä¸ºå¢åŠ äº†å¯¹éåä½œçš„æŠ¢å å¼è°ƒåº¦çš„æ”¯æŒ","like_count":49,"discussions":[{"author":{"id":1026224,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/a8/b0/6f87ab08.jpg","nickname":"Tony Bai","note":"","ucode":"B6B08985F6FA89","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":545773,"discussion_content":"âœ…","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1642049095,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":330644,"user_name":"lesserror","can_delete":false,"product_type":"c1","uid":1351076,"ip_address":"","ucode":"25A54D1165FCF6","user_header":"https://static001.geekbang.org/account/avatar/00/14/9d/a4/e481ae48.jpg","comment_is_top":false,"comment_ctime":1642082247,"is_pvip":false,"replies":[{"id":121546,"content":"1.æŒ‰ç…§Dmitry VyukovåŸæ–‡çš„æ„æ€ï¼š é›†ä¸­çŠ¶æ€(centralized state)ï¼Œæˆ‘ç†è§£å°±æ˜¯ä¸€æŠŠå…¨å±€é”è¦ä¿æŠ¤çš„æ•°æ®å¤ªå¤šã€‚è¿™æ ·æ— è®ºè®¿é—®å“ªä¸ªæ•°æ®ï¼Œéƒ½è¦é”è¿™æŠŠå…¨å±€é”ã€‚æ•°æ®å±€éƒ¨æ€§å·®æ˜¯å› ä¸ºæ¯ä¸ªméƒ½ä¼šç¼“å­˜å®ƒæ‰§è¡Œçš„ä»£ç æˆ–æ•°æ®ï¼Œä½†æ˜¯å¦‚æœåœ¨mä¹‹é—´é¢‘ç¹ä¼ é€’goroutineï¼Œé‚£ä¹ˆè¿™ç§å±€éƒ¨ç¼“å­˜çš„æ„ä¹‰å°±æ²¡æœ‰äº†ã€‚æ— æ³•å®ç°å±€éƒ¨ç¼“å­˜å¸¦æ¥çš„æ€§èƒ½æå‡ã€‚\n\n2. runtime.morestack_noctxt æ˜¯ä¸€ä¸ªå‡½æ•°ã€‚\n3. åä½œå¼ï¼šå¤§å®¶éƒ½æŒ‰äº‹å…ˆå®šä¹‰å¥½çš„è§„åˆ™æ¥ï¼Œæ¯”å¦‚ï¼šä¸€ä¸ªgoroutineæ‰§è¡Œå®Œåï¼Œé€€å‡ºï¼Œè®©å‡ºpï¼Œç„¶åä¸‹ä¸€ä¸ªgoroutineè¢«è°ƒåº¦åˆ°pä¸Šè¿è¡Œã€‚è¿™æ ·åšçš„ç¼ºç‚¹å°±åœ¨äº æ˜¯å¦è®©å‡ºpçš„å†³å®šæƒåœ¨groutineè‡ªèº«ã€‚ä¸€æ—¦æŸä¸ªgä¸ä¸»åŠ¨è®©å‡ºpæˆ–æ‰§è¡Œæ—¶é—´è¾ƒé•¿ï¼Œé‚£ä¹ˆåé¢çš„goroutineåªèƒ½ç­‰ç€ï¼Œæ²¡æœ‰æ–¹æ³•è®©å‰è€…è®©å‡ºpï¼Œå¯¼è‡´å»¶è¿Ÿç”šè‡³é¥¿æ­»ã€‚è€Œéåä½œ: å°±æ˜¯ç”±runtimeæ¥å†³å®šä¸€ä¸ªgoroutineè¿è¡Œå¤šé•¿æ—¶é—´ï¼Œå¦‚æœä½ ä¸ä¸»åŠ¨è®©å‡ºï¼Œå¯¹ä¸èµ·ï¼Œæˆ‘æœ‰æ‰‹æ®µå¯ä»¥æŠ¢å ä½ ï¼ŒæŠŠä½ è¸¢å‡ºå»ï¼Œè®©åé¢çš„goroutineè¿›æ¥è¿è¡Œã€‚\n\n4. æŒ‚èµ·è¿™é‡Œä½ å¯ä»¥ç†è§£ä¸ºæš‚åœè¿è¡Œï¼Œç­‰å¾…ä¸‹ä¸€æ¬¡è°ƒåº¦ã€‚\n5. å½“è¿›è¡Œä¸€äº›æ…¢ç³»ç»Ÿè°ƒç”¨çš„æ—¶å€™ï¼Œæ¯”å¦‚å¸¸è§„æ–‡ä»¶ioï¼Œæ‰§è¡Œç³»ç»Ÿè°ƒç”¨çš„må°±è¦å’Œgä¸€èµ·æŒ‚èµ·ï¼Œè¿™æ˜¯osçš„è¦æ±‚ï¼Œä¸æ˜¯go runtimeçš„è¦æ±‚ã€‚æ¯•ç«ŸçœŸæ­£æ‰§è¡Œä»£ç çš„è¿˜æ˜¯mã€‚\n ","user_name":"ä½œè€…å›å¤","user_name_real":"ç¼–è¾‘","uid":1026224,"ctime":1643448170,"ip_address":"","comment_id":330644,"utype":1}],"discussion_count":1,"race_medal":0,"score":2,"product_id":100093501,"comment_content":"å¤§ç™½è€å¸ˆè¿™ç¯‡ç®—æ˜¯è®©æˆ‘é‡æ–°å¯¹Goçš„Gã€Pã€Mæ¨¡å‹æœ‰äº†ä¸€ä¸ªæ–°çš„è®¤è¯†ã€‚æ„Ÿè°¢ã€‚ä¸è¿‡è¿˜æ˜¯æœ‰å‡ å¤„ç–‘æƒ‘çš„åœ°æ–¹ï¼š\n\n1. æ€ä¹ˆç†è§£æ–‡ä¸­çš„ï¼šâ€œé›†ä¸­çŠ¶æ€å­˜å‚¨â€å’Œâ€œæ•°æ®å±€éƒ¨æ€§è¾ƒå·®â€ï¼Œèƒ½å†è¿›ä¸€æ­¥è§£é‡Šä¸€ä¸‹ä¹ˆï¼Ÿ\n\n2. ç¼–è¯‘å™¨åœ¨æ¯ä¸ªå‡½æ•°æˆ–æ–¹æ³•çš„å…¥å£å¤„åŠ ä¸Šäº†ä¸€æ®µé¢å¤–çš„ä»£ç  (runtime.morestack_noctxt)ï¼Œæ‹¬å·ä¸­çš„ï¼šruntime.morestack_noctxt è¿™æ˜¯ä¸€ä¸ªæ–‡ä»¶ä¹ˆï¼Ÿ\n\n3. æ€ä¹ˆç†è§£â€œåä½œå¼â€ã€â€œéåä½œå¼â€å‘¢ï¼Ÿçœ‹äº†æ–‡ç« è¿˜æ˜¯æ²¡å¤ªæ˜ç™½ã€‚\n\n4. å…³äºæŒ‚èµ·ï¼Œç™¾åº¦çš„è¯´æ³•å¤§æ¦‚æ˜¯ï¼šâ€œæš‚æ—¶è¢«æ·˜æ±°å‡ºå†…å­˜çš„è¿›ç¨‹ã€‚â€ï¼Œè¿™é‡Œè¯¥æ€ä¹ˆç†è§£å‘¢ï¼Ÿ\n\n5. ä¸ºä»€ä¹ˆ Mæœ‰æ—¶å¿…é¡»è¦ä¸ G ä¸€èµ·æŒ‚èµ·ï¼ŸM ä¸æ˜¯å¯ä»¥ä¸ä¿å­˜ Gçš„çŠ¶æ€çš„å—ï¼ŸMä¸èƒ½ç›´æ¥å»ç»‘å®šåˆ«çš„på—ï¼Ÿä¸ºä»€ä¹ˆè¦é¢‘ç¹çš„æŒ‚èµ·å‘¢ï¼Ÿ\n\nPSï¼šè€å¸ˆçš„æ–‡æ¡£é“¾æ¥å¥½è¯„ï¼Œæœ€åŸå§‹çš„å‡ºå¤„æ ‡å‡†çš„å¾ˆæ˜ç¡®ã€‚","like_count":33,"discussions":[{"author":{"id":1026224,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/a8/b0/6f87ab08.jpg","nickname":"Tony Bai","note":"","ucode":"B6B08985F6FA89","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":548927,"discussion_content":"1.æŒ‰ç…§Dmitry VyukovåŸæ–‡çš„æ„æ€ï¼š é›†ä¸­çŠ¶æ€(centralized state)ï¼Œæˆ‘ç†è§£å°±æ˜¯ä¸€æŠŠå…¨å±€é”è¦ä¿æŠ¤çš„æ•°æ®å¤ªå¤šã€‚è¿™æ ·æ— è®ºè®¿é—®å“ªä¸ªæ•°æ®ï¼Œéƒ½è¦é”è¿™æŠŠå…¨å±€é”ã€‚æ•°æ®å±€éƒ¨æ€§å·®æ˜¯å› ä¸ºæ¯ä¸ªméƒ½ä¼šç¼“å­˜å®ƒæ‰§è¡Œçš„ä»£ç æˆ–æ•°æ®ï¼Œä½†æ˜¯å¦‚æœåœ¨mä¹‹é—´é¢‘ç¹ä¼ é€’goroutineï¼Œé‚£ä¹ˆè¿™ç§å±€éƒ¨ç¼“å­˜çš„æ„ä¹‰å°±æ²¡æœ‰äº†ã€‚æ— æ³•å®ç°å±€éƒ¨ç¼“å­˜å¸¦æ¥çš„æ€§èƒ½æå‡ã€‚\n\n2. runtime.morestack_noctxt æ˜¯ä¸€ä¸ªå‡½æ•°ã€‚\n3. åä½œå¼ï¼šå¤§å®¶éƒ½æŒ‰äº‹å…ˆå®šä¹‰å¥½çš„è§„åˆ™æ¥ï¼Œæ¯”å¦‚ï¼šä¸€ä¸ªgoroutineæ‰§è¡Œå®Œåï¼Œé€€å‡ºï¼Œè®©å‡ºpï¼Œç„¶åä¸‹ä¸€ä¸ªgoroutineè¢«è°ƒåº¦åˆ°pä¸Šè¿è¡Œã€‚è¿™æ ·åšçš„ç¼ºç‚¹å°±åœ¨äº æ˜¯å¦è®©å‡ºpçš„å†³å®šæƒåœ¨groutineè‡ªèº«ã€‚ä¸€æ—¦æŸä¸ªgä¸ä¸»åŠ¨è®©å‡ºpæˆ–æ‰§è¡Œæ—¶é—´è¾ƒé•¿ï¼Œé‚£ä¹ˆåé¢çš„goroutineåªèƒ½ç­‰ç€ï¼Œæ²¡æœ‰æ–¹æ³•è®©å‰è€…è®©å‡ºpï¼Œå¯¼è‡´å»¶è¿Ÿç”šè‡³é¥¿æ­»ã€‚è€Œéåä½œ: å°±æ˜¯ç”±runtimeæ¥å†³å®šä¸€ä¸ªgoroutineè¿è¡Œå¤šé•¿æ—¶é—´ï¼Œå¦‚æœä½ ä¸ä¸»åŠ¨è®©å‡ºï¼Œå¯¹ä¸èµ·ï¼Œæˆ‘æœ‰æ‰‹æ®µå¯ä»¥æŠ¢å ä½ ï¼ŒæŠŠä½ è¸¢å‡ºå»ï¼Œè®©åé¢çš„goroutineè¿›æ¥è¿è¡Œã€‚\n\n4. æŒ‚èµ·è¿™é‡Œä½ å¯ä»¥ç†è§£ä¸ºæš‚åœè¿è¡Œï¼Œç­‰å¾…ä¸‹ä¸€æ¬¡è°ƒåº¦ã€‚\n5. å½“è¿›è¡Œä¸€äº›æ…¢ç³»ç»Ÿè°ƒç”¨çš„æ—¶å€™ï¼Œæ¯”å¦‚å¸¸è§„æ–‡ä»¶ioï¼Œæ‰§è¡Œç³»ç»Ÿè°ƒç”¨çš„må°±è¦å’Œgä¸€èµ·æŒ‚èµ·ï¼Œè¿™æ˜¯osçš„è¦æ±‚ï¼Œä¸æ˜¯go runtimeçš„è¦æ±‚ã€‚æ¯•ç«ŸçœŸæ­£æ‰§è¡Œä»£ç çš„è¿˜æ˜¯mã€‚\n ","likes_number":1,"is_delete":false,"is_hidden":false,"ctime":1643448170,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":338132,"user_name":"ivhong","can_delete":false,"product_type":"c1","uid":2659871,"ip_address":"","ucode":"9947B228807AC9","user_header":"https://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTJ8ic8eLTo5rnqIMJicUfpkVBrOUJAW4fANicKIbHdC54O9SOdwSoeK6o8icibaUbh7ZUXAkGF9zwHqo0Q/132","comment_is_top":false,"comment_ctime":1647314896,"is_pvip":false,"replies":[{"id":123643,"content":"ğŸ‘","user_name":"ä½œè€…å›å¤","user_name_real":"ç¼–è¾‘","uid":1026224,"ctime":1647401258,"ip_address":"","comment_id":338132,"utype":1}],"discussion_count":1,"race_medal":0,"score":2,"product_id":100093501,"comment_content":"è°¢è°¢å¤§ç™½è€å¸ˆï¼Œèƒ½æŠŠè¿™ä¹ˆæ™¦æ¶©çš„åŸç†è®²çš„è¿™ä¹ˆæ¸…æ¥šã€‚æˆ‘åå¤çœ‹äº†å¾ˆå¤šéï¼Œåšäº†å¦‚ä¸‹æ€»ç»“ï¼Œä¸çŸ¥é“æ˜¯ä¸æ˜¯åˆç†ï¼Œå¸Œæœ›è€å¸ˆé—²æš‡ä¹‹ä½™ç»™äºˆæŒ‡æ­£ï¼ŒğŸ™ã€‚\nåœ¨æ–‡ä¸­æåŠçš„GPMï¼Œä»¥åŠGPMä¹‹å‰çš„ç›¸äº’é…åˆï¼Œå®Œæˆäº†goçš„å¹¶å‘åŠŸèƒ½ã€‚\n\nGï¼šå¯ä»¥çœ‹ä½œå…³é”®å­—go åé¢è·Ÿç€çš„å¯æ‰§è¡Œä»£ç å—ï¼ˆå³goroutineï¼‰ï¼Œå½“ç„¶åŒ…å«è¿™ä¸ªä»£ç å—çš„ä¸€äº›æœ¬èº«çš„ä¿¡æ¯ï¼ˆæ¯”å¦‚æ ˆä¿¡æ¯ã€çŠ¶æ€ç­‰ç­‰ä¸€äº›å¿…è¦çš„å±æ€§ï¼‰ã€‚å¦å¤–å­˜åœ¨ä¸€ä¸ªGçš„å…¨å±€é˜Ÿåˆ—ï¼Œåªè¦æ˜¯éœ€è¦æ‰§è¡Œçš„ goroutine éƒ½ä¼šè¢«æ”¾å€’è¿™ä¸ªå…¨å±€é˜Ÿåˆ—é‡Œã€‚\n\nPï¼šå¯ä»¥çœ‹ä½œé€»è¾‘ä¸Šçš„â€œä»»åŠ¡å¤„ç†å™¨â€ï¼Œgoæœ‰å¤šä¸ªè¿™ä¸ªå¤„ç†å™¨ï¼Œå…·ä½“çš„æ•°é‡ç”±runtime.GOMAXPROCS(1)æŒ‡å®šï¼Œå®ƒæœ‰ä¸‹é¢çš„æŒ‡è´£ï¼š\n    1. å®ƒæœ‰è‡ªå·±Gé˜Ÿåˆ—ã€‚å½“ä»–å‘ç°è‡ªå·±çš„é˜Ÿåˆ—ä¸ºç©ºæ—¶ï¼Œå¯ä»¥å»å…¨å±€Gé˜Ÿåˆ—é‡Œè·å–ç­‰å¾…æ‰§è¡Œçš„goroutineï¼Œç”šè‡³å¯ä»¥å»å…¶ä»–çš„Pçš„é˜Ÿåˆ—é‡ŒæŠ¢ç”¨goroutineã€‚ä»–æŠŠæ‹¿è¿‡æ¥çš„goroutineæ”¾åˆ°è‡ªå·±çš„é˜Ÿåˆ—é‡Œ\n    2. ä»–å¯ä»¥æ‰¾åˆ°ä¸€ä¸ªç©ºé—²çš„Mä¸è‡ªå·±ç»‘å®šï¼Œç”¨æ¥è¿è¡Œè‡ªå·±é˜Ÿåˆ—ä¸­çš„goroutineï¼Œå¦‚æœæ²¡æœ‰ç©ºé—²çš„Mï¼Œåˆ™åˆ›å»ºä¸€ä¸ªMæ¥ç»‘å®š\n    3. è¢«Pç»‘å®šçš„Mï¼Œå¯ä»¥è‡ªå·±ä¸»åŠ¨çš„ä¸Pè§£ç»‘ï¼Œå½“På‘ç°è‡ªå·±çš„Mè¢«è§£ç»‘ï¼Œå°±æ‰§è¡Œ2\n    4. å¦‚æœè‡ªå·±é˜Ÿåˆ—ä¸­æ²¡æœ‰goroutineï¼Œä¹Ÿæ— æ³•ä»â€œå¤–é¢â€è·å–goroutineï¼Œåˆ™ä¸Mè§£ç»‘ï¼ˆè§£ç»‘Mæ—¶ï¼Œæ˜¯æŒ‰ä»€ä¹ˆé€»è¾‘é€‰æ‹©æŒ‚èµ·Mæˆ–è€…é‡Šæ”¾Må‘¢ï¼Ÿï¼‰\n\nMï¼šç‰©ç†çš„å¤„ç†å™¨ï¼Œå…·ä½“æ‰§è¡Œgoroutineçš„ç³»ç»Ÿçº¿ç¨‹ï¼Œæ‰€æœ‰goroutineéƒ½æ˜¯åœ¨Mä¸­æ‰§è¡Œçš„ï¼Œå®ƒè¢«Påˆ›å»ºï¼Œä¸Pç»‘å®šåå¯æ‰§è¡ŒPé˜Ÿåˆ—ä¸­çš„goroutineï¼Œåœ¨æ‰§è¡Œgoroutineä¼šå¤„ç†3ä¸­æƒ…å†µä¿è¯å¹¶å‘æ˜¯é¡ºåˆ©çš„ï¼ˆä¸ä¼šå‘ç”Ÿâ€œé¥¿æ­»â€ï¼Œèµ„æºåˆ†é…ä¸å¹³ç­‰çš„æƒ…å†µï¼‰\n    1. å½“Gé•¿æ—¶é—´è¿è¡Œæ—¶ï¼Œå¯ä»¥è¢«Goæš‚åœæ‰§è¡Œè€Œè¢«ç§»å‡ºMï¼ˆæ˜¯ä¸æ˜¯æ”¾åˆ°å…¨å±€Gé˜Ÿåˆ—å‘¢ï¼Ÿï¼‰ï¼Œç­‰å¾…ä¸‹æ¬¡è¿è¡Œï¼ˆå³æŠ¢å å¼è°ƒåº¦ï¼‰ã€‚\n    2. å¦‚æœGå‘ç”Ÿäº†channel ç­‰å¾…æˆ–è€… ç½‘ç»œI&#47;Oè¯·æ±‚ï¼Œåˆ™æŠŠGæ”¾åˆ°æŸä¸ªç­‰å¾…é˜Ÿåˆ—ä¸­ï¼ŒMç»§ç»­æ‰§è¡Œä¸‹ä¸€goroutineï¼Œå½“Gç­‰å¾…çš„ç»“æœè¿”å›æ—¶ï¼Œä¼šå”¤é†’â€œGâ€ï¼Œå¹¶æŠŠå®ƒæ”¾å…¥åˆ°å…¨å±€Gçš„é˜Ÿåˆ—ä¸­ï¼Œç­‰å¾…Pçš„è·å–ï¼ˆè¿™é‡Œä¸çŸ¥é“ç†è§£çš„å¯¹ä¸å¯¹ï¼Ÿï¼‰ã€‚\n    3. å¦‚æœGäº§ç”Ÿäº†ç³»ç»Ÿè°ƒç”¨ï¼Œåˆ™Mä¸Pè§£ç»‘ï¼Œç„¶åMå’Œå®ƒæ­£æ‰§è¡Œçš„Gè¢«æ“ä½œç³»ç»Ÿâ€œæŒ‚èµ·â€ç­‰å¾…æ“ä½œç³»ç»Ÿçš„ä¸­æ–­è¿”å›ï¼ˆå¯¹äºæ“ä½œç³»ç»Ÿè€Œè¨€ï¼ŒMå’ŒGæ˜¯ä¸€å›äº‹ï¼›è€Œå¯¹äºGOæ¥è¯´ï¼ŒGåªæœ‰èƒ½åœ¨Mä¸­è¿è¡Œï¼Œåªæœ‰è¿è¡Œæ‰è§¦å‘å‘ç³»ç»Ÿè°ƒç”¨ï¼‰ã€‚\n\n","like_count":20,"discussions":[{"author":{"id":1026224,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/a8/b0/6f87ab08.jpg","nickname":"Tony Bai","note":"","ucode":"B6B08985F6FA89","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":556493,"discussion_content":"ğŸ‘","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1647401259,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":346529,"user_name":"éº¦èŠ’æå®¢","can_delete":false,"product_type":"c1","uid":2611257,"ip_address":"","ucode":"34983809B39576","user_header":"https://static001.geekbang.org/account/avatar/00/27/d8/39/acb7e16e.jpg","comment_is_top":false,"comment_ctime":1653216030,"is_pvip":false,"replies":[{"id":126414,"content":"å¥½é—®é¢˜ï¼ä¸è¿‡å½“ç½‘ç»œI&#47;Oé˜»å¡æ—¶ï¼ŒMçœŸä¸ä¼šé˜»å¡ã€‚\n\nå› ä¸ºruntimeå±‚å®ç°äº†netpollerï¼Œnetpolleræ˜¯åŸºäºosæä¾›çš„I&#47;Oå¤šè·¯å¤ç”¨æ¨¡å‹å®ç°çš„(æ¯”å¦‚:linuxä¸Šçš„epoll)ï¼Œè¿™å…è®¸ä¸€ä¸ªçº¿ç¨‹å¤„ç†å¤šä¸ªsocketã€‚è¿™å°±ä½¿å¾—å½“æŸä¸ªgoroutineçš„socketå‘é€i&#47;oé˜»å¡æ—¶ï¼Œä»…ä¼šè®©goroutineå˜ä¸ºé˜»å¡çŠ¶æ€ï¼Œruntimeä¼šå°†å¯¹åº”çš„socketä¸goroutineåŠ å…¥åˆ°netpollerçš„ç›‘å¬ä¸­ï¼Œç„¶åMç»§ç»­æ‰§è¡Œå…¶ä»–goroutineçš„ä»»åŠ¡ã€‚ç­‰netpollerç›‘è§†åˆ°ä¹‹å‰çš„socketå¯è¯»&#47;å¯å†™æ—¶ï¼Œå†æŠŠå¯¹åº”çš„goroutineå”¤é†’ç»§ç»­æ‰§è¡Œç½‘ç»œi&#47;oã€‚\n\n","user_name":"ä½œè€…å›å¤","user_name_real":"ç¼–è¾‘","uid":1026224,"ctime":1653267795,"ip_address":"","comment_id":346529,"utype":1}],"discussion_count":1,"race_medal":0,"score":2,"product_id":100093501,"comment_content":"è€å¸ˆæ‚¨å¥½ï¼ŒGé‡åˆ°ç½‘ç»œIOé˜»å¡æ—¶ï¼ŒçœŸæ­£çš„çº¿ç¨‹å³Mä¸åº”è¯¥ä¹Ÿé˜»å¡å—ï¼Ÿ","like_count":18,"discussions":[{"author":{"id":1026224,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/a8/b0/6f87ab08.jpg","nickname":"Tony Bai","note":"","ucode":"B6B08985F6FA89","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":573203,"discussion_content":"å¥½é—®é¢˜ï¼ä¸è¿‡å½“ç½‘ç»œI/Oé˜»å¡æ—¶ï¼ŒMçœŸä¸ä¼šé˜»å¡ã€‚\n\nå› ä¸ºruntimeå±‚å®ç°äº†netpollerï¼Œnetpolleræ˜¯åŸºäºosæä¾›çš„I/Oå¤šè·¯å¤ç”¨æ¨¡å‹å®ç°çš„(æ¯”å¦‚:linuxä¸Šçš„epoll)ï¼Œè¿™å…è®¸ä¸€ä¸ªçº¿ç¨‹å¤„ç†å¤šä¸ªsocketã€‚è¿™å°±ä½¿å¾—å½“æŸä¸ªgoroutineçš„socketå‘é€i/oé˜»å¡æ—¶ï¼Œä»…ä¼šè®©goroutineå˜ä¸ºé˜»å¡çŠ¶æ€ï¼Œruntimeä¼šå°†å¯¹åº”çš„socketä¸goroutineåŠ å…¥åˆ°netpollerçš„ç›‘å¬ä¸­ï¼Œç„¶åMç»§ç»­æ‰§è¡Œå…¶ä»–goroutineçš„ä»»åŠ¡ã€‚ç­‰netpollerç›‘è§†åˆ°ä¹‹å‰çš„socketå¯è¯»/å¯å†™æ—¶ï¼Œå†æŠŠå¯¹åº”çš„goroutineå”¤é†’ç»§ç»­æ‰§è¡Œç½‘ç»œi/oã€‚\n\n","likes_number":1,"is_delete":false,"is_hidden":false,"ctime":1653267795,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":330052,"user_name":"bearlu","can_delete":false,"product_type":"c1","uid":1030862,"ip_address":"","ucode":"14F260C8B24E27","user_header":"https://static001.geekbang.org/account/avatar/00/0f/ba/ce/fd45714f.jpg","comment_is_top":false,"comment_ctime":1641776886,"is_pvip":true,"replies":[{"id":120492,"content":"æ¬§é•¿å¤è€å¸ˆç»´æŠ¤çš„è¿™ä¸ªgo historyä¸­æœ‰å…³è°ƒåº¦å™¨çš„æ¼”åŒ–å¯ä»¥å‚è€ƒï¼šhttps:&#47;&#47;golang.design&#47;history&#47;#scheduler","user_name":"ä½œè€…å›å¤","user_name_real":"ç¼–è¾‘","uid":1026224,"ctime":1642043606,"ip_address":"","comment_id":330052,"utype":1}],"discussion_count":2,"race_medal":0,"score":2,"product_id":100093501,"comment_content":"è€å¸ˆï¼Œæƒ³å­¦ä¹ goroutineè°ƒåº¦å™¨ï¼Œæ¼”è¿›çš„å…³é”®ç‰ˆæœ¬ï¼Œä¾æ¬¡æ˜¯goçš„ä»€ä¹ˆå‘è¡Œç‰ˆï¼Ÿè¿˜æœ‰ä»€ä¹ˆç›¸å…³èµ„æ–™ä¹¦ç±ï¼Ÿè°¢è°¢è€å¸ˆ","like_count":6,"discussions":[{"author":{"id":1026224,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/a8/b0/6f87ab08.jpg","nickname":"Tony Bai","note":"","ucode":"B6B08985F6FA89","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":545713,"discussion_content":"æ¬§é•¿å¤è€å¸ˆç»´æŠ¤çš„è¿™ä¸ªgo historyä¸­æœ‰å…³è°ƒåº¦å™¨çš„æ¼”åŒ–å¯ä»¥å‚è€ƒï¼šhttps://golang.design/history/#scheduler","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1642043606,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":1,"child_discussions":[{"author":{"id":1030862,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/ba/ce/fd45714f.jpg","nickname":"bearlu","note":"","ucode":"14F260C8B24E27","race_medal":0,"user_type":1,"is_pvip":true},"reply_author":{"id":1026224,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/a8/b0/6f87ab08.jpg","nickname":"Tony Bai","note":"","ucode":"B6B08985F6FA89","race_medal":0,"user_type":2,"is_pvip":false},"discussion":{"id":545716,"discussion_content":"è°¢è°¢è€å¸ˆ","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1642043973,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":545713,"ip_address":"","group_id":0},"score":545716,"extra":""}]}]},{"had_liked":false,"id":354245,"user_name":"Mr_D","can_delete":false,"product_type":"c1","uid":1127385,"ip_address":"è¾½å®","ucode":"57843FA1C1F974","user_header":"http://thirdwx.qlogo.cn/mmopen/vi_32/7hOJBKZVrJD8ayZoYnq0ECFsoWf9yx6eyq3JU8p1449A6cKEp5rSpicJRg5vH3HZgq5YwbpGicBvyARFutcPLGgw/132","comment_is_top":false,"comment_ctime":1660210621,"is_pvip":false,"replies":[{"id":128891,"content":"å¯¹ï¼Œgoroutineé€€å‡ºåï¼Œruntimeå±‚çš„Gå¯¹è±¡ä¼šè¢«æ”¾å…¥ä¸€ä¸ªFree Gå¯¹è±¡çš„æ± å­ä¸­ï¼Œåç»­æœ‰æ–°Goroutineåˆ›å»ºæ—¶ï¼Œä¼˜å…ˆä»æ± å­é‡Œgetä¸€ä¸ªã€‚å¯ä»¥çœ‹Goæºç ï¼šruntime&#47;proc.goä¸­çš„ä»£ç ã€‚","user_name":"ä½œè€…å›å¤","user_name_real":"ç¼–è¾‘","uid":1026224,"ctime":1660312275,"ip_address":"è¾½å®","comment_id":354245,"utype":1}],"discussion_count":1,"race_medal":0,"score":2,"product_id":100093501,"comment_content":"è¯·é—®Gçš„å¯é‡ç”¨å…·ä½“æŒ‡ä»€ä¹ˆå‘¢ï¼Ÿæ˜¯é’ˆå¯¹å·²ç»è¿è¡Œç»“æŸçš„Gç•™ä¸‹çš„å†…å­˜ç©ºé—´ï¼Œè¿›è¡Œç›¸å…³æ•°æ®çš„é‡å¡«ä¹ˆ","like_count":4,"discussions":[{"author":{"id":1026224,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/a8/b0/6f87ab08.jpg","nickname":"Tony Bai","note":"","ucode":"B6B08985F6FA89","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":583719,"discussion_content":"å¯¹ï¼Œgoroutineé€€å‡ºåï¼Œruntimeå±‚çš„Gå¯¹è±¡ä¼šè¢«æ”¾å…¥ä¸€ä¸ªFree Gå¯¹è±¡çš„æ± å­ä¸­ï¼Œåç»­æœ‰æ–°Goroutineåˆ›å»ºæ—¶ï¼Œä¼˜å…ˆä»æ± å­é‡Œgetä¸€ä¸ªã€‚å¯ä»¥çœ‹Goæºç ï¼šruntime/proc.goä¸­çš„ä»£ç ã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1660312275,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"è¾½å®","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":357786,"user_name":"å¾®å¾®è¶…çº§ä¸¹ğŸ’«","can_delete":false,"product_type":"c1","uid":2996016,"ip_address":"åŒ—äº¬","ucode":"ABEFC2FA673BE4","user_header":"https://static001.geekbang.org/account/avatar/00/2d/b7/30/c1e4f5b5.jpg","comment_is_top":false,"comment_ctime":1663640366,"is_pvip":false,"replies":[{"id":130250,"content":"å°±æ˜¯è¯´å¯¹å¸¸è§„æ–‡ä»¶çš„è¯»å†™æ“ä½œï¼ˆå› ä¸ºæ˜¯ç³»ç»Ÿè°ƒç”¨ï¼‰ä¾ç„¶ä¼šé˜»å¡Mã€‚","user_name":"ä½œè€…å›å¤","user_name_real":"ç¼–è¾‘","uid":1026224,"ctime":1663745625,"ip_address":"åŒ—äº¬","comment_id":357786,"utype":1}],"discussion_count":1,"race_medal":0,"score":2,"product_id":100093501,"comment_content":"è¯·é—®å¸¸è§„æ–‡ä»¶æ˜¯ä¸æ”¯æŒç›‘å¬çš„ï¼ˆpollableï¼‰æ˜¯ä»€ä¹ˆæ„æ€å‘€ï¼Ÿ","like_count":3,"discussions":[{"author":{"id":1026224,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/a8/b0/6f87ab08.jpg","nickname":"Tony Bai","note":"","ucode":"B6B08985F6FA89","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":583719,"discussion_content":"å¯¹ï¼Œgoroutineé€€å‡ºåï¼Œruntimeå±‚çš„Gå¯¹è±¡ä¼šè¢«æ”¾å…¥ä¸€ä¸ªFree Gå¯¹è±¡çš„æ± å­ä¸­ï¼Œåç»­æœ‰æ–°Goroutineåˆ›å»ºæ—¶ï¼Œä¼˜å…ˆä»æ± å­é‡Œgetä¸€ä¸ªã€‚å¯ä»¥çœ‹Goæºç ï¼šruntime/proc.goä¸­çš„ä»£ç ã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1660312275,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"è¾½å®","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":347804,"user_name":"è·¯è¾¹çš„çŒª","can_delete":false,"product_type":"c1","uid":2057354,"ip_address":"","ucode":"92F7C082E44FC4","user_header":"https://static001.geekbang.org/account/avatar/00/1f/64/8a/bc8cb43c.jpg","comment_is_top":false,"comment_ctime":1654444691,"is_pvip":false,"replies":[{"id":126782,"content":"ç”±äºgoè¿è¡Œæ—¶netpollerçš„å­˜åœ¨ï¼Œæˆ‘ä»¬å¾ˆéš¾ç²¾ç¡®åŒºåˆ†ã€‚è¿™ç§â€œç½‘ç»œioâ€ä¼šè¢«runtimeè½¬æ¢ä¸ºgoroutineçš„è°ƒåº¦ç­‰ï¼Œä¸ä¸€å®šçœŸçš„å®æ–½ç½‘ç»œioã€‚","user_name":"ä½œè€…å›å¤","user_name_real":"ç¼–è¾‘","uid":1026224,"ctime":1654483307,"ip_address":"","comment_id":347804,"utype":1}],"discussion_count":1,"race_medal":0,"score":2,"product_id":100093501,"comment_content":"ç¬¬ä¸€ç§ï¼Œå› ä¸ºç½‘ç»œioå¯¼è‡´é˜»å¡çš„å¤„ç†æ–¹å¼è¿™é‡Œã€‚æˆ‘æƒ³é—®ï¼Œç½‘ç»œioåŠ¿å¿…ä¼šå¼•èµ·ç³»ç»Ÿè°ƒç”¨ï¼Œæ¯”å¦‚æœ€åŸºç¡€çš„å»ºç«‹tcpè¿æ¥è¿™äº›ï¼Œé‚£è¿™å—å„¿æ˜¯å’‹åŒºåˆ†ç³»ç»Ÿè°ƒç”¨å’Œç½‘ç»œioçš„å‘¢ï¼Ÿ","like_count":3,"discussions":[{"author":{"id":1026224,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/a8/b0/6f87ab08.jpg","nickname":"Tony Bai","note":"","ucode":"B6B08985F6FA89","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":588408,"discussion_content":"å°±æ˜¯è¯´å¯¹å¸¸è§„æ–‡ä»¶çš„è¯»å†™æ“ä½œï¼ˆå› ä¸ºæ˜¯ç³»ç»Ÿè°ƒç”¨ï¼‰ä¾ç„¶ä¼šé˜»å¡Mã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1663745626,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"åŒ—äº¬","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":330132,"user_name":"å¥•","can_delete":false,"product_type":"c1","uid":1005391,"ip_address":"","ucode":"73CEA468CE70C3","user_header":"https://static001.geekbang.org/account/avatar/00/0f/57/4f/6fb51ff1.jpg","comment_is_top":false,"comment_ctime":1641808653,"is_pvip":false,"replies":[{"id":120493,"content":"è¯•è¯•å°†Pçš„æ•°é‡ç½®ä¸º1.","user_name":"ä½œè€…å›å¤","user_name_real":"ç¼–è¾‘","uid":1026224,"ctime":1642043655,"ip_address":"","comment_id":330132,"utype":1}],"discussion_count":2,"race_medal":0,"score":2,"product_id":100093501,"comment_content":"æ€è€ƒé¢˜ï¼š\næ˜¯ä¸æ˜¯ä¸ç®¡æ€ä¹ˆå¤„ç†ï¼Œmain goroutine  éƒ½ä¼šè¢«è°ƒåº¦ï¼Ÿ","like_count":3,"discussions":[{"author":{"id":1026224,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/a8/b0/6f87ab08.jpg","nickname":"Tony Bai","note":"","ucode":"B6B08985F6FA89","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":574941,"discussion_content":"ç”±äºgoè¿è¡Œæ—¶netpollerçš„å­˜åœ¨ï¼Œæˆ‘ä»¬å¾ˆéš¾ç²¾ç¡®åŒºåˆ†ã€‚è¿™ç§â€œç½‘ç»œioâ€ä¼šè¢«runtimeè½¬æ¢ä¸ºgoroutineçš„è°ƒåº¦ç­‰ï¼Œä¸ä¸€å®šçœŸçš„å®æ–½ç½‘ç»œioã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1654483307,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":332676,"user_name":"å¤šé€‰å‚æ•°","can_delete":false,"product_type":"c1","uid":1248326,"ip_address":"","ucode":"B2294D80AB075F","user_header":"https://static001.geekbang.org/account/avatar/00/13/0c/46/dfe32cf4.jpg","comment_is_top":false,"comment_ctime":1643460929,"is_pvip":false,"replies":[{"id":121622,"content":"ã€ŠGoè¯­è¨€ç¬¬ä¸€è¯¾FAQã€‹ä¸­æœ‰è¿™æ–¹é¢çš„è§£ç­”ï¼Œä½ å¯ä»¥å…ˆçœ‹çœ‹ã€‚ https:&#47;&#47;tonybai.com&#47;go-course-faq ","user_name":"ä½œè€…å›å¤","user_name_real":"ç¼–è¾‘","uid":1026224,"ctime":1643544468,"ip_address":"","comment_id":332676,"utype":1}],"discussion_count":1,"race_medal":0,"score":2,"product_id":100093501,"comment_content":"æœ‰å‡ ä¸ªé—®é¢˜æƒ³é—®è€å¸ˆï¼š \n1. æ–‡ç« ä¸­æåˆ°çš„ Go è¿è¡Œæ—¶è¿™å—æ›´å¤šæ˜¯æŒ‡å“ªäº›å†…å®¹ï¼ŸGo è°ƒåº¦å™¨åº”è¯¥ä¹Ÿæ˜¯ Go è¿è¡Œæ—¶ä¸­çš„éƒ¨åˆ†å†…å®¹å§ï¼Ÿå°±æ˜¯ Go å¼€æºçš„æºä»£ç å—ï¼Ÿ\n2. æœ‰å…³ Go è¿è¡Œæ—¶æ¯”è¾ƒå¥½çš„èµ„æ–™æ¨èå—ï¼Ÿæ¯”å¦‚ Go è¿è¡Œæ—¶çš„æ¶æ„ã€Go è¿è¡Œæ—¶æ˜¯æ€ä¹ˆå’Œç”¨æˆ·ç¼–å†™çš„ä»£ç åˆåœ¨ä¸€èµ·çš„ï¼Œå› ä¸ºæˆ‘ç†è§£çš„ Go è¿è¡Œæ—¶ä¸åƒ JVM é‚£æ ·ï¼ŒGo æ˜¯ç¼–è¯‘æ€§çš„ï¼Œä¹Ÿå°±æ˜¯è¯´ä¼šå°†ç”¨æˆ·ç¼–å†™çš„ä»£ç å’Œ Go è¿è¡Œæ—¶ä»£ç ä¸€èµ·ç¼–è¯‘æˆäºŒè¿›åˆ¶ï¼Œç„¶åè¿è¡Œæ˜¯ä» Go è¿è¡Œæ—¶å¼€å§‹çš„ï¼Œç„¶ååœ¨ä»ç”¨æˆ·é€»è¾‘çš„ä»£ç å¼€å§‹ã€‚\n\nè€å¸ˆæœ‰ç©ºçš„æ—¶å€™éº»çƒ¦è§£ç­”ä¸‹ï¼Œè°¢è°¢è€å¸ˆï½","like_count":2,"discussions":[{"author":{"id":1026224,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/a8/b0/6f87ab08.jpg","nickname":"Tony Bai","note":"","ucode":"B6B08985F6FA89","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":545714,"discussion_content":"è¯•è¯•å°†Pçš„æ•°é‡ç½®ä¸º1.","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1642043655,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":1,"child_discussions":[{"author":{"id":1005391,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/57/4f/6fb51ff1.jpg","nickname":"å¥•","note":"","ucode":"73CEA468CE70C3","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":1026224,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/a8/b0/6f87ab08.jpg","nickname":"Tony Bai","note":"","ucode":"B6B08985F6FA89","race_medal":0,"user_type":2,"is_pvip":false},"discussion":{"id":545715,"discussion_content":"å°†Pè®¾ç½®ä¸º1,ä¹Ÿä¼šè¿›è¡Œè°ƒåº¦çš„ï¼Œå°±æ˜¯é¢‘ç‡å°‘ä¸€äº›","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1642043925,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":545714,"ip_address":"","group_id":0},"score":545715,"extra":""}]}]},{"had_liked":false,"id":330220,"user_name":"return","can_delete":false,"product_type":"c1","uid":1135528,"ip_address":"","ucode":"42B8A3380DF04B","user_header":"https://static001.geekbang.org/account/avatar/00/11/53/a8/abc96f70.jpg","comment_is_top":false,"comment_ctime":1641869142,"is_pvip":false,"replies":[{"id":120544,"content":"ğŸ‘","user_name":"ä½œè€…å›å¤","user_name_real":"ç¼–è¾‘","uid":1026224,"ctime":1642050576,"ip_address":"","comment_id":330220,"utype":1}],"discussion_count":1,"race_medal":0,"score":3,"product_id":100093501,"comment_content":"è€å¸ˆè®²çš„å¤ªå¥½äº†ï¼Œå¹²è´§æ…¢æ…¢ï¼Œè€å¸ˆå·²ç»æŠŠæµç¨‹å’ŒåŸç†è®²æ¸…æ¥šäº†ï¼Œ\nåŸç†ä¸‹çš„ æ›´åº•å±‚ç»†èŠ‚ å¾—è‡ªå·±å†ç ”ç©¶å­¦ä¹ ã€‚\n","like_count":2},{"had_liked":false,"id":368640,"user_name":"æ€ä¹ˆç¡æ‰èƒ½åšè¿™ç§æ¢¦","can_delete":false,"product_type":"c1","uid":3050745,"ip_address":"æ¹–åŒ—","ucode":"81A7B6EF124E90","user_header":"https://static001.geekbang.org/account/avatar/00/2e/8c/f9/e1dab0ca.jpg","comment_is_top":false,"comment_ctime":1676518231,"is_pvip":false,"replies":[{"id":134262,"content":"ä½ è¯´çš„çº¿ç¨‹æ± æ˜¯goroutineæ± ä¹ˆï¼Ÿå¦‚æœæ˜¯ï¼Œç¬¬35è®² å¯¹goroutineæ± çš„å¿…è¦æ€§åšäº†ä¸€äº›è¯´æ˜ï¼Œå¯ä»¥å…ˆçœ‹çœ‹ã€‚","user_name":"ä½œè€…å›å¤","user_name_real":"ç¼–è¾‘","uid":1026224,"ctime":1676544771,"ip_address":"åŒ—äº¬","comment_id":368640,"utype":1}],"discussion_count":2,"race_medal":0,"score":3,"product_id":100093501,"comment_content":"è€å¸ˆï¼Œæˆ‘æƒ³é—®ä¸€ä¸‹ï¼ŒGoè¯­è¨€æœ‰äº†GPMæ¨¡å‹ï¼Œè¿˜æœ‰çº¿ç¨‹æ± å­˜åœ¨çš„å¿…è¦å—ï¼Ÿ\nè¿˜æ˜¯è¯´å¯èƒ½å­˜åœ¨ç‰¹æ®Šæƒ…å†µï¼Œæ¯”å¦‚è¯´å½“æœ‰ç³»ç»Ÿè°ƒç”¨å‘ç”Ÿé˜»å¡çš„æƒ…å†µä¸‹ï¼Œçº¿ç¨‹æ± æ‰æœ‰ä½œç”¨ï¼Œå› ä¸ºåªæœ‰ç³»ç»Ÿè°ƒç”¨å‘ç”Ÿé˜»å¡æ‰å¯èƒ½åˆ›å»ºçº¿ç¨‹ã€‚æˆ–è€…è¯´è‡ªå®šä¹‰çš„çº¿ç¨‹æ± è¡¥å……äº†GPMæ¨¡å‹çš„å“ªäº›ç¼ºç‚¹å‘¢ï¼Ÿ","like_count":1,"discussions":[{"author":{"id":1026224,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/a8/b0/6f87ab08.jpg","nickname":"Tony Bai","note":"","ucode":"B6B08985F6FA89","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":605006,"discussion_content":"ä½ è¯´çš„çº¿ç¨‹æ± æ˜¯goroutineæ± ä¹ˆï¼Ÿå¦‚æœæ˜¯ï¼Œç¬¬35è®² å¯¹goroutineæ± çš„å¿…è¦æ€§åšäº†ä¸€äº›è¯´æ˜ï¼Œå¯ä»¥å…ˆçœ‹çœ‹ã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1676544771,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"åŒ—äº¬","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":3050745,"avatar":"https://static001.geekbang.org/account/avatar/00/2e/8c/f9/e1dab0ca.jpg","nickname":"æ€ä¹ˆç¡æ‰èƒ½åšè¿™ç§æ¢¦","note":"","ucode":"81A7B6EF124E90","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":605496,"discussion_content":"å¥½çš„å“ˆ","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1676686860,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":"æ¹–åŒ—","group_id":0},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":367775,"user_name":"è·¯è¾¹çš„çŒª","can_delete":false,"product_type":"c1","uid":2057354,"ip_address":"è¾½å®","ucode":"92F7C082E44FC4","user_header":"https://static001.geekbang.org/account/avatar/00/1f/64/8a/bc8cb43c.jpg","comment_is_top":false,"comment_ctime":1675588559,"is_pvip":false,"replies":[{"id":134045,"content":"å³ä¾¿å¦‚ä½ æ‰€è¯´çš„é‚£æ ·ï¼Œä½†å½“è¿›å…¥åˆ°for {}åï¼Œè¿˜å“ªæœ‰æœºä¼šèµ°åˆ°æ’å…¥çš„æ£€æµ‹çš„ä»£ç å‘¢ï¼Ÿ\n\nä¸‹é¢è¿™æ ·æ‰å¯ä»¥è¿›å…¥åˆ°func1çš„æ£€æµ‹ä»£ç ï¼š(Go 1.14ç‰ˆæœ¬ä¹‹å‰)\n\ngo func() {\n    for {\n       func1()\n    }\n}","user_name":"ä½œè€…å›å¤","user_name_real":"ç¼–è¾‘","uid":1026224,"ctime":1675948936,"ip_address":"å¹¿ä¸œ","comment_id":367775,"utype":1}],"discussion_count":1,"race_medal":0,"score":3,"product_id":100093501,"comment_content":"æŠ¢å å¼è°ƒåº¦è¿™é‡Œï¼Œæ¯”å¦‚ go func(){ for {}}\nè¿™ç§æƒ…å†µ åç¨‹å†…ç¡®å®æ²¡æœ‰å…¶ä»–çš„å‡½æ•°è°ƒç”¨ æ˜¯ä¸€ä¸ªæ­»å¾ªç¯ï¼Œä½†æ˜¯è¿™ä¸ªfunc() æœ¬èº«ä¸å°±æ˜¯ä¸ªå‡½æ•°å—ï¼Œä¸ºå•¥ä¸èƒ½åœ¨è¿™ä¸ªå‡½æ•°å¼€å¤´æ’å…¥æ£€æµ‹ä»£ç å‘¢ï¼Ÿ","like_count":1,"discussions":[{"author":{"id":1026224,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/a8/b0/6f87ab08.jpg","nickname":"Tony Bai","note":"","ucode":"B6B08985F6FA89","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":603113,"discussion_content":"å³ä¾¿å¦‚ä½ æ‰€è¯´çš„é‚£æ ·ï¼Œä½†å½“è¿›å…¥åˆ°for {}åï¼Œè¿˜å“ªæœ‰æœºä¼šèµ°åˆ°æ’å…¥çš„æ£€æµ‹çš„ä»£ç å‘¢ï¼Ÿ\n\nä¸‹é¢è¿™æ ·æ‰å¯ä»¥è¿›å…¥åˆ°func1çš„æ£€æµ‹ä»£ç ï¼š(Go 1.14ç‰ˆæœ¬ä¹‹å‰)\n\ngo func() {\n    for {\n       func1()\n    }\n}","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1675948937,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"å¹¿ä¸œ","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":360226,"user_name":"æäº®","can_delete":false,"product_type":"c1","uid":1079702,"ip_address":"åŒ—äº¬","ucode":"E26284C3BF7DF1","user_header":"https://static001.geekbang.org/account/avatar/00/10/79/96/fb0d8a65.jpg","comment_is_top":false,"comment_ctime":1666320419,"is_pvip":false,"replies":[{"id":131093,"content":"åŸå…ˆæ­£åœ¨è¿è¡Œçš„Gè¢«å¼ºè¡Œç»ˆæ­¢ï¼Œæ¢å¦å¤–ä¸€ä¸ªGè¿è¡Œã€‚","user_name":"ä½œè€…å›å¤","user_name_real":"ç¼–è¾‘","uid":1026224,"ctime":1666579009,"ip_address":"åŒ—äº¬","comment_id":360226,"utype":1}],"discussion_count":1,"race_medal":0,"score":3,"product_id":100093501,"comment_content":"æŠ¢å æ˜¯ä»€ä¹ˆæ„æ€ï¼ŸGè¢«æŠ¢å æ˜¯æŒ‡æœ¬æ¥åœæ­¢è¿è¡ŒGï¼Œæ¢æˆå¦å¤–ä¸€ä¸ªGå—ï¼Ÿ","like_count":1,"discussions":[{"author":{"id":1026224,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/a8/b0/6f87ab08.jpg","nickname":"Tony Bai","note":"","ucode":"B6B08985F6FA89","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":591389,"discussion_content":"åŸå…ˆæ­£åœ¨è¿è¡Œçš„Gè¢«å¼ºè¡Œç»ˆæ­¢ï¼Œæ¢å¦å¤–ä¸€ä¸ªGè¿è¡Œã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1666579009,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"åŒ—äº¬","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":359953,"user_name":"Geek_1d2661","can_delete":false,"product_type":"c1","uid":3186090,"ip_address":"åŒ—äº¬","ucode":"CC02863D939FEC","user_header":"https://thirdwx.qlogo.cn/mmopen/vi_32/DYAIOgq83eoGLuQGiaBftJglfdCicBnCWw8tZKkbEJoU3lpgI10mAzaYgS0QLicG02GMH9zSzFD2KFQ0SHc6PuMUA/132","comment_is_top":false,"comment_ctime":1666088278,"is_pvip":false,"replies":[{"id":130951,"content":"1. å¯ä»å¤šæ ¸è§’åº¦è€ƒè™‘ä¸€ä¸‹\n2. è¿˜æ˜¯ä»å¯åˆ©ç”¨çš„è°ƒåº¦èµ„æºè§’åº¦è€ƒè™‘ä¸€ä¸‹ã€‚","user_name":"ä½œè€…å›å¤","user_name_real":"ç¼–è¾‘","uid":1026224,"ctime":1666175629,"ip_address":"åŒ—äº¬","comment_id":359953,"utype":1}],"discussion_count":1,"race_medal":0,"score":3,"product_id":100093501,"comment_content":"1.ç”¨1.13æ˜¯å®ç°äº†æŠ¢å å¼è°ƒåº¦ ä½†æ˜¯é‚£ä¸ªæ˜¯é€šè¿‡å‡½æ•°åŸ‹ç‚¹çš„  è¿™é‡Œçš„ä¸æ˜¯å‡½æ•° æ‰€ä»¥ä¸ä¼šè¿è¡Œå§\n2.ä½¿ç”¨å‡½æ•°è°ƒåº¦åº”è¯¥å¯ä»¥å§","like_count":1,"discussions":[{"author":{"id":1026224,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/a8/b0/6f87ab08.jpg","nickname":"Tony Bai","note":"","ucode":"B6B08985F6FA89","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":590937,"discussion_content":"1. å¯ä»å¤šæ ¸è§’åº¦è€ƒè™‘ä¸€ä¸‹\n2. è¿˜æ˜¯ä»å¯åˆ©ç”¨çš„è°ƒåº¦èµ„æºè§’åº¦è€ƒè™‘ä¸€ä¸‹ã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1666175629,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"åŒ—äº¬","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":357442,"user_name":"æŸ’","can_delete":false,"product_type":"c1","uid":2419502,"ip_address":"ç¾å›½","ucode":"D41241629321A1","user_header":"https://static001.geekbang.org/account/avatar/00/24/eb/2e/90fea784.jpg","comment_is_top":false,"comment_ctime":1663254598,"is_pvip":false,"replies":[{"id":130118,"content":"é¦–å…ˆè¿™æ˜¯P-Mæ¨¡å‹ä¸­çš„é—®é¢˜ï¼›\nå…¶æ¬¡ï¼Œå¯è¿è¡Œæ˜¯æŒ‡runnableï¼Œå³è¯¥Gåœ¨nextGæˆ–Mçš„æœ¬åœ°é˜Ÿåˆ—ä¸­(P-Mæ¨¡å‹)ï¼Œå¹¶ä¸æ˜¯æ­£åœ¨Mä¸Šè¿è¡Œçš„Gï¼›\næœ€åï¼Œå½“åœ¨Mä¸Šè¿è¡Œçš„Gå‡ºç°æ…¢ç³»ç»Ÿè°ƒç”¨åï¼ŒMå’ŒGæŒ‚èµ·ï¼Œå…¶nextGå’Œæœ¬åœ°é˜Ÿåˆ—ä¸­çš„Gå¯èƒ½å°±è¦è¢«ä¼ é€’ç»™å…¶ä»–M(å·²æœ‰çš„idle mæˆ–æ–°å»ºM)å¤„ç†ã€‚","user_name":"ä½œè€…å›å¤","user_name_real":"ç¼–è¾‘","uid":1026224,"ctime":1663367598,"ip_address":"ç¾å›½","comment_id":357442,"utype":1}],"discussion_count":2,"race_medal":0,"score":3,"product_id":100093501,"comment_content":"Goroutine ä¼ é€’é—®é¢˜ï¼šM ç»å¸¸åœ¨ M ä¹‹é—´ä¼ é€’â€œå¯è¿è¡Œâ€çš„ Goroutineï¼Ÿä¸ºå•¥ä¼šæœ‰ä¼ é€’å‘€ï¼Ÿ å°±ç®—æ˜¯ä¸Šä¸‹æ–‡åˆ‡æ¢ï¼Œåªä¼šæŒ‚èµ·ä¸€ä¸ªGï¼ŒMåˆ‡æ¢åˆ°æ‰§è¡Œå¦ä¸€ä¸ªGï¼Œå®ƒä¸ä¼šä»ä¸€ä¸ªMä¼ é€’åˆ°å¦ä¸€ä¸ªMå˜›ã€‚","like_count":1,"discussions":[{"author":{"id":1026224,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/a8/b0/6f87ab08.jpg","nickname":"Tony Bai","note":"","ucode":"B6B08985F6FA89","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":587892,"discussion_content":"é¦–å…ˆè¿™æ˜¯P-Mæ¨¡å‹ä¸­çš„é—®é¢˜ï¼›\nå…¶æ¬¡ï¼Œå¯è¿è¡Œæ˜¯æŒ‡runnableï¼Œå³è¯¥Gåœ¨nextGæˆ–Mçš„æœ¬åœ°é˜Ÿåˆ—ä¸­(P-Mæ¨¡å‹)ï¼Œå¹¶ä¸æ˜¯æ­£åœ¨Mä¸Šè¿è¡Œçš„Gï¼›\næœ€åï¼Œå½“åœ¨Mä¸Šè¿è¡Œçš„Gå‡ºç°æ…¢ç³»ç»Ÿè°ƒç”¨åï¼ŒMå’ŒGæŒ‚èµ·ï¼Œå…¶nextGå’Œæœ¬åœ°é˜Ÿåˆ—ä¸­çš„Gå¯èƒ½å°±è¦è¢«ä¼ é€’ç»™å…¶ä»–M(å·²æœ‰çš„idle mæˆ–æ–°å»ºM)å¤„ç†ã€‚","likes_number":1,"is_delete":false,"is_hidden":false,"ctime":1663367598,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"ç¾å›½","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":1,"child_discussions":[{"author":{"id":2419502,"avatar":"https://static001.geekbang.org/account/avatar/00/24/eb/2e/90fea784.jpg","nickname":"æŸ’","note":"","ucode":"D41241629321A1","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":1026224,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/a8/b0/6f87ab08.jpg","nickname":"Tony Bai","note":"","ucode":"B6B08985F6FA89","race_medal":0,"user_type":2,"is_pvip":false},"discussion":{"id":587895,"discussion_content":"æ„Ÿè°¢è€å¸ˆï¼Œè±ç„¶å¼€æœ—","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1663377005,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":587892,"ip_address":"ä¸Šæµ·","group_id":0},"score":587895,"extra":""}]}]},{"had_liked":false,"id":356806,"user_name":"è èå¹é›ªâ€”Code","can_delete":false,"product_type":"c1","uid":1650378,"ip_address":"åŒ—äº¬","ucode":"A5B2FC661EE17D","user_header":"https://static001.geekbang.org/account/avatar/00/19/2e/ca/469f7266.jpg","comment_is_top":false,"comment_ctime":1662604446,"is_pvip":false,"replies":[{"id":129872,"content":"ğŸ‘","user_name":"ä½œè€…å›å¤","user_name_real":"ç¼–è¾‘","uid":1026224,"ctime":1662684212,"ip_address":"åŒ—äº¬","comment_id":356806,"utype":1}],"discussion_count":1,"race_medal":0,"score":3,"product_id":100093501,"comment_content":"æ‰“å¡","like_count":1,"discussions":[{"author":{"id":1026224,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/a8/b0/6f87ab08.jpg","nickname":"Tony Bai","note":"","ucode":"B6B08985F6FA89","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":587008,"discussion_content":"ğŸ‘","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1662684212,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"åŒ—äº¬","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":351841,"user_name":"æ¯å¤©æ™’ç™½ç‰™","can_delete":false,"product_type":"c1","uid":1004698,"ip_address":"","ucode":"A1B102CD933DEA","user_header":"https://static001.geekbang.org/account/avatar/00/0f/54/9a/76c0af70.jpg","comment_is_top":false,"comment_ctime":1658224257,"is_pvip":false,"replies":[{"id":128097,"content":"â€œGo æ˜¯åœ¨ 1.2 ç‰ˆæœ¬å¢åŠ çš„æŠ¢å å¼è°ƒåº¦ï¼Œ1.13.xç‰ˆæœ¬è¿˜ä¸æ”¯æŒâ€ ï¼Œ 1.2ç‰ˆæœ¬ï¼Ÿ","user_name":"ä½œè€…å›å¤","user_name_real":"ç¼–è¾‘","uid":1026224,"ctime":1658401826,"ip_address":"","comment_id":351841,"utype":1}],"discussion_count":1,"race_medal":0,"score":3,"product_id":100093501,"comment_content":"æ€è€ƒé¢˜\n1.åœ¨ä¸€ä¸ªæ‹¥æœ‰å¤šæ ¸å¤„ç†å™¨çš„ä¸»æœºä¸Šï¼Œä½¿ç”¨ Go 1.13.x ç‰ˆæœ¬è¿è¡Œè¿™ä¸ªç¤ºä¾‹ä»£ç ï¼Œä½ åœ¨å‘½ä»¤è¡Œç»ˆç«¯ä¸Šæ˜¯å¦èƒ½çœ‹åˆ°â€œI got scheduled!â€è¾“å‡ºå‘¢ï¼Ÿä¹Ÿå°±æ˜¯ main goroutine åœ¨åˆ›å»º deadloop goroutine ä¹‹åæ˜¯å¦èƒ½ç»§ç»­å¾—åˆ°è°ƒåº¦å‘¢ï¼Ÿ\nç­”ï¼šä¸ä¼šå¾—åˆ°è°ƒåº¦ï¼Œé¦–å…ˆ Go æ˜¯åœ¨ 1.2 ç‰ˆæœ¬å¢åŠ çš„æŠ¢å å¼è°ƒåº¦ï¼Œ1.13.xç‰ˆæœ¬è¿˜ä¸æ”¯æŒï¼Œå› ä¸ºdeadloop goroutine æ˜¯æ­»å¾ªç¯ï¼Œæ‰€ä»¥è¿™ä¸ªGä¼šæ°¸è¿œå ç”¨åˆ†é…çš„På’ŒM\n\n2.æˆ‘ä»¬é€šè¿‡ä»€ä¹ˆæ–¹æ³•å¯ä»¥è®©ä¸Šé¢ç¤ºä¾‹ä¸­çš„ main goroutineï¼Œåœ¨åˆ›å»º deadloop goroutine ä¹‹åæ— æ³•ç»§ç»­å¾—åˆ°è°ƒåº¦ï¼Ÿ\nä¸¤ä¸ªå¿…è¦æ¡ä»¶\nâ‘ goçš„ç‰ˆæœ¬è¦åœ¨1.2ä¹‹å‰ï¼Œå› ä¸º1.2ä¹‹å‰ä¸æ”¯æŒæŠ¢å å¼è°ƒåº¦ï¼Œå¯ä»¥ç¡®ä¿Gå¯ä»¥å ç”¨åˆ†é…ç»™å®ƒçš„På’ŒM\nâ‘¡è®¾ç½®GOMAXPROCS=1\n","like_count":1,"discussions":[{"author":{"id":1026224,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/a8/b0/6f87ab08.jpg","nickname":"Tony Bai","note":"","ucode":"B6B08985F6FA89","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":580914,"discussion_content":"â€œGo æ˜¯åœ¨ 1.2 ç‰ˆæœ¬å¢åŠ çš„æŠ¢å å¼è°ƒåº¦ï¼Œ1.13.xç‰ˆæœ¬è¿˜ä¸æ”¯æŒâ€ ï¼Œ 1.2ç‰ˆæœ¬ï¼Ÿ","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1658401826,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":343933,"user_name":"pythonbug","can_delete":false,"product_type":"c1","uid":1487274,"ip_address":"","ucode":"1A70CA92FFF8EB","user_header":"https://wx.qlogo.cn/mmopen/vi_32/wgMMrp1hvSB3E30KqZvMsj3KQdAI3T1uQM77LT7hZ65nVSjPGRg3AbUOyiahnssA6AIT5PAkyHFmlTBzUH9gdyQ/132","comment_is_top":false,"comment_ctime":1651126643,"is_pvip":false,"replies":[{"id":125662,"content":"go 1.14ç‰ˆæœ¬ä¹‹å‰ä¸æ”¯æŒç›´æ¥æŠ¢å ï¼Œè€Œæ˜¯åœ¨å‡½æ•°æˆ–æ–¹æ³•ä¸­â€œæ·»åŠ è°ƒåº¦ä»£ç â€ï¼Œæ‰€ä»¥è™½ç„¶è®¾ç½®äº†æŠ¢å æ ‡å¿—ï¼Œä½†æ˜¯åªæœ‰ä¸‹ä¸€æ¬¡è¿è¡Œâ€œæ·»åŠ çš„è°ƒåº¦ä»£ç â€æ—¶ï¼Œè¯¥Gæ‰ä¼šè®©å‡ºMã€‚","user_name":"ä½œè€…å›å¤","user_name_real":"ç¼–è¾‘","uid":1026224,"ctime":1651288980,"ip_address":"","comment_id":343933,"utype":1}],"discussion_count":1,"race_medal":0,"score":3,"product_id":100093501,"comment_content":"â€œå¦‚æœä¸€ä¸ª G ä»»åŠ¡è¿è¡Œ 10msï¼Œ...... é‚£ä¹ˆç­‰åˆ°è¿™ä¸ª G ä¸‹ä¸€æ¬¡è°ƒç”¨å‡½æ•°æˆ–æ–¹æ³•æ—¶ï¼Œ...... ç­‰å¾…ä¸‹ä¸€æ¬¡è¢«è°ƒåº¦ã€‚â€\nè€å¸ˆå¥½ï¼Œæœ‰ä¸ªé—®é¢˜ï¼ŒæŸä¸ªgoroutineè¿è¡Œè¶…è¿‡10msäº†ï¼Œä¸ºå•¥ä¸ç›´æ¥æŠ¢å ï¼Œç­‰å¾…ä¸‹ä¸€æ¬¡æ˜¯ä»€ä¹ˆæ„æ€å‘¢ï¼Ÿé‚£ä¹ˆè¿™æ¬¡æ˜¯ç›´æ¥è¿è¡Œå®Œå—ï¼Œæ—¢ç„¶è¿™æ¬¡éƒ½è¿è¡Œå®Œäº†ï¼Œåˆæ€ä¹ˆä¼šæœ‰ä¸‹ä¸€æ¬¡å‘¢ã€‚ã€‚ã€‚è¿™æ®µä¸å¤§ç†è§£ï¼Œæœ‰ç‚¹æ‡µäº†ã€‚ã€‚ã€‚","like_count":1,"discussions":[{"author":{"id":1026224,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/a8/b0/6f87ab08.jpg","nickname":"Tony Bai","note":"","ucode":"B6B08985F6FA89","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":569011,"discussion_content":"go 1.14ç‰ˆæœ¬ä¹‹å‰ä¸æ”¯æŒç›´æ¥æŠ¢å ï¼Œè€Œæ˜¯åœ¨å‡½æ•°æˆ–æ–¹æ³•ä¸­â€œæ·»åŠ è°ƒåº¦ä»£ç â€ï¼Œæ‰€ä»¥è™½ç„¶è®¾ç½®äº†æŠ¢å æ ‡å¿—ï¼Œä½†æ˜¯åªæœ‰ä¸‹ä¸€æ¬¡è¿è¡Œâ€œæ·»åŠ çš„è°ƒåº¦ä»£ç â€æ—¶ï¼Œè¯¥Gæ‰ä¼šè®©å‡ºMã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1651288980,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":338606,"user_name":"simple_å­™","can_delete":false,"product_type":"c1","uid":1873629,"ip_address":"","ucode":"A77203E242D652","user_header":"https://static001.geekbang.org/account/avatar/00/1c/96/dd/1620a744.jpg","comment_is_top":false,"comment_ctime":1647593322,"is_pvip":false,"replies":[{"id":123791,"content":"æ¯ä¸ªPåªæœ‰ä¸€ä¸ªé˜Ÿåˆ—ã€‚","user_name":"ä½œè€…å›å¤","user_name_real":"ç¼–è¾‘","uid":1026224,"ctime":1647654138,"ip_address":"","comment_id":338606,"utype":1}],"discussion_count":1,"race_medal":0,"score":3,"product_id":100093501,"comment_content":"æ¯ä¸ªPæ˜¯ä¸æ˜¯è·ŸJavaä¸­çš„çº¿ç¨‹ä¸€æ ·éƒ½æœ‰ä¸€ä¸ªå°±ç»ªé˜Ÿåˆ—å’Œç­‰å¾…é˜Ÿåˆ—å‘¢","like_count":1,"discussions":[{"author":{"id":1026224,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/a8/b0/6f87ab08.jpg","nickname":"Tony Bai","note":"","ucode":"B6B08985F6FA89","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":557078,"discussion_content":"æ¯ä¸ªPåªæœ‰ä¸€ä¸ªé˜Ÿåˆ—ã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1647654138,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":330220,"user_name":"return","can_delete":false,"product_type":"c1","uid":1135528,"ip_address":"","ucode":"42B8A3380DF04B","user_header":"https://static001.geekbang.org/account/avatar/00/11/53/a8/abc96f70.jpg","comment_is_top":false,"comment_ctime":1641869142,"is_pvip":false,"replies":[{"id":120544,"content":"ğŸ‘","user_name":"ä½œè€…å›å¤","user_name_real":"ç¼–è¾‘","uid":1026224,"ctime":1642050576,"ip_address":"","comment_id":330220,"utype":1}],"discussion_count":1,"race_medal":0,"score":3,"product_id":100093501,"comment_content":"è€å¸ˆè®²çš„å¤ªå¥½äº†ï¼Œå¹²è´§æ…¢æ…¢ï¼Œè€å¸ˆå·²ç»æŠŠæµç¨‹å’ŒåŸç†è®²æ¸…æ¥šäº†ï¼Œ\nåŸç†ä¸‹çš„ æ›´åº•å±‚ç»†èŠ‚ å¾—è‡ªå·±å†ç ”ç©¶å­¦ä¹ ã€‚\n","like_count":2,"discussions":[{"author":{"id":1026224,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/a8/b0/6f87ab08.jpg","nickname":"Tony Bai","note":"","ucode":"B6B08985F6FA89","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":545787,"discussion_content":"ğŸ‘","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1642050576,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":368640,"user_name":"æ€ä¹ˆç¡æ‰èƒ½åšè¿™ç§æ¢¦","can_delete":false,"product_type":"c1","uid":3050745,"ip_address":"æ¹–åŒ—","ucode":"81A7B6EF124E90","user_header":"https://static001.geekbang.org/account/avatar/00/2e/8c/f9/e1dab0ca.jpg","comment_is_top":false,"comment_ctime":1676518231,"is_pvip":false,"replies":[{"id":134262,"content":"ä½ è¯´çš„çº¿ç¨‹æ± æ˜¯goroutineæ± ä¹ˆï¼Ÿå¦‚æœæ˜¯ï¼Œç¬¬35è®² å¯¹goroutineæ± çš„å¿…è¦æ€§åšäº†ä¸€äº›è¯´æ˜ï¼Œå¯ä»¥å…ˆçœ‹çœ‹ã€‚","user_name":"ä½œè€…å›å¤","user_name_real":"ç¼–è¾‘","uid":1026224,"ctime":1676544771,"ip_address":"åŒ—äº¬","comment_id":368640,"utype":1}],"discussion_count":2,"race_medal":0,"score":3,"product_id":100093501,"comment_content":"è€å¸ˆï¼Œæˆ‘æƒ³é—®ä¸€ä¸‹ï¼ŒGoè¯­è¨€æœ‰äº†GPMæ¨¡å‹ï¼Œè¿˜æœ‰çº¿ç¨‹æ± å­˜åœ¨çš„å¿…è¦å—ï¼Ÿ\nè¿˜æ˜¯è¯´å¯èƒ½å­˜åœ¨ç‰¹æ®Šæƒ…å†µï¼Œæ¯”å¦‚è¯´å½“æœ‰ç³»ç»Ÿè°ƒç”¨å‘ç”Ÿé˜»å¡çš„æƒ…å†µä¸‹ï¼Œçº¿ç¨‹æ± æ‰æœ‰ä½œç”¨ï¼Œå› ä¸ºåªæœ‰ç³»ç»Ÿè°ƒç”¨å‘ç”Ÿé˜»å¡æ‰å¯èƒ½åˆ›å»ºçº¿ç¨‹ã€‚æˆ–è€…è¯´è‡ªå®šä¹‰çš„çº¿ç¨‹æ± è¡¥å……äº†GPMæ¨¡å‹çš„å“ªäº›ç¼ºç‚¹å‘¢ï¼Ÿ","like_count":1,"discussions":[{"author":{"id":1026224,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/a8/b0/6f87ab08.jpg","nickname":"Tony Bai","note":"","ucode":"B6B08985F6FA89","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":545787,"discussion_content":"ğŸ‘","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1642050576,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":367775,"user_name":"è·¯è¾¹çš„çŒª","can_delete":false,"product_type":"c1","uid":2057354,"ip_address":"è¾½å®","ucode":"92F7C082E44FC4","user_header":"https://static001.geekbang.org/account/avatar/00/1f/64/8a/bc8cb43c.jpg","comment_is_top":false,"comment_ctime":1675588559,"is_pvip":false,"replies":[{"id":134045,"content":"å³ä¾¿å¦‚ä½ æ‰€è¯´çš„é‚£æ ·ï¼Œä½†å½“è¿›å…¥åˆ°for {}åï¼Œè¿˜å“ªæœ‰æœºä¼šèµ°åˆ°æ’å…¥çš„æ£€æµ‹çš„ä»£ç å‘¢ï¼Ÿ\n\nä¸‹é¢è¿™æ ·æ‰å¯ä»¥è¿›å…¥åˆ°func1çš„æ£€æµ‹ä»£ç ï¼š(Go 1.14ç‰ˆæœ¬ä¹‹å‰)\n\ngo func() {\n    for {\n       func1()\n    }\n}","user_name":"ä½œè€…å›å¤","user_name_real":"ç¼–è¾‘","uid":1026224,"ctime":1675948936,"ip_address":"å¹¿ä¸œ","comment_id":367775,"utype":1}],"discussion_count":1,"race_medal":0,"score":3,"product_id":100093501,"comment_content":"æŠ¢å å¼è°ƒåº¦è¿™é‡Œï¼Œæ¯”å¦‚ go func(){ for {}}\nè¿™ç§æƒ…å†µ åç¨‹å†…ç¡®å®æ²¡æœ‰å…¶ä»–çš„å‡½æ•°è°ƒç”¨ æ˜¯ä¸€ä¸ªæ­»å¾ªç¯ï¼Œä½†æ˜¯è¿™ä¸ªfunc() æœ¬èº«ä¸å°±æ˜¯ä¸ªå‡½æ•°å—ï¼Œä¸ºå•¥ä¸èƒ½åœ¨è¿™ä¸ªå‡½æ•°å¼€å¤´æ’å…¥æ£€æµ‹ä»£ç å‘¢ï¼Ÿ","like_count":1,"discussions":[{"author":{"id":1026224,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/a8/b0/6f87ab08.jpg","nickname":"Tony Bai","note":"","ucode":"B6B08985F6FA89","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":605006,"discussion_content":"ä½ è¯´çš„çº¿ç¨‹æ± æ˜¯goroutineæ± ä¹ˆï¼Ÿå¦‚æœæ˜¯ï¼Œç¬¬35è®² å¯¹goroutineæ± çš„å¿…è¦æ€§åšäº†ä¸€äº›è¯´æ˜ï¼Œå¯ä»¥å…ˆçœ‹çœ‹ã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1676544771,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"åŒ—äº¬","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":3050745,"avatar":"https://static001.geekbang.org/account/avatar/00/2e/8c/f9/e1dab0ca.jpg","nickname":"æ€ä¹ˆç¡æ‰èƒ½åšè¿™ç§æ¢¦","note":"","ucode":"81A7B6EF124E90","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":605496,"discussion_content":"å¥½çš„å“ˆ","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1676686860,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":"æ¹–åŒ—","group_id":0},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":360226,"user_name":"æäº®","can_delete":false,"product_type":"c1","uid":1079702,"ip_address":"åŒ—äº¬","ucode":"E26284C3BF7DF1","user_header":"https://static001.geekbang.org/account/avatar/00/10/79/96/fb0d8a65.jpg","comment_is_top":false,"comment_ctime":1666320419,"is_pvip":false,"replies":[{"id":131093,"content":"åŸå…ˆæ­£åœ¨è¿è¡Œçš„Gè¢«å¼ºè¡Œç»ˆæ­¢ï¼Œæ¢å¦å¤–ä¸€ä¸ªGè¿è¡Œã€‚","user_name":"ä½œè€…å›å¤","user_name_real":"ç¼–è¾‘","uid":1026224,"ctime":1666579009,"ip_address":"åŒ—äº¬","comment_id":360226,"utype":1}],"discussion_count":1,"race_medal":0,"score":3,"product_id":100093501,"comment_content":"æŠ¢å æ˜¯ä»€ä¹ˆæ„æ€ï¼ŸGè¢«æŠ¢å æ˜¯æŒ‡æœ¬æ¥åœæ­¢è¿è¡ŒGï¼Œæ¢æˆå¦å¤–ä¸€ä¸ªGå—ï¼Ÿ","like_count":1,"discussions":[{"author":{"id":1026224,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/a8/b0/6f87ab08.jpg","nickname":"Tony Bai","note":"","ucode":"B6B08985F6FA89","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":603113,"discussion_content":"å³ä¾¿å¦‚ä½ æ‰€è¯´çš„é‚£æ ·ï¼Œä½†å½“è¿›å…¥åˆ°for {}åï¼Œè¿˜å“ªæœ‰æœºä¼šèµ°åˆ°æ’å…¥çš„æ£€æµ‹çš„ä»£ç å‘¢ï¼Ÿ\n\nä¸‹é¢è¿™æ ·æ‰å¯ä»¥è¿›å…¥åˆ°func1çš„æ£€æµ‹ä»£ç ï¼š(Go 1.14ç‰ˆæœ¬ä¹‹å‰)\n\ngo func() {\n    for {\n       func1()\n    }\n}","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1675948937,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"å¹¿ä¸œ","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":359953,"user_name":"Geek_1d2661","can_delete":false,"product_type":"c1","uid":3186090,"ip_address":"åŒ—äº¬","ucode":"CC02863D939FEC","user_header":"https://thirdwx.qlogo.cn/mmopen/vi_32/DYAIOgq83eoGLuQGiaBftJglfdCicBnCWw8tZKkbEJoU3lpgI10mAzaYgS0QLicG02GMH9zSzFD2KFQ0SHc6PuMUA/132","comment_is_top":false,"comment_ctime":1666088278,"is_pvip":false,"replies":[{"id":130951,"content":"1. å¯ä»å¤šæ ¸è§’åº¦è€ƒè™‘ä¸€ä¸‹\n2. è¿˜æ˜¯ä»å¯åˆ©ç”¨çš„è°ƒåº¦èµ„æºè§’åº¦è€ƒè™‘ä¸€ä¸‹ã€‚","user_name":"ä½œè€…å›å¤","user_name_real":"ç¼–è¾‘","uid":1026224,"ctime":1666175629,"ip_address":"åŒ—äº¬","comment_id":359953,"utype":1}],"discussion_count":1,"race_medal":0,"score":3,"product_id":100093501,"comment_content":"1.ç”¨1.13æ˜¯å®ç°äº†æŠ¢å å¼è°ƒåº¦ ä½†æ˜¯é‚£ä¸ªæ˜¯é€šè¿‡å‡½æ•°åŸ‹ç‚¹çš„  è¿™é‡Œçš„ä¸æ˜¯å‡½æ•° æ‰€ä»¥ä¸ä¼šè¿è¡Œå§\n2.ä½¿ç”¨å‡½æ•°è°ƒåº¦åº”è¯¥å¯ä»¥å§","like_count":1,"discussions":[{"author":{"id":1026224,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/a8/b0/6f87ab08.jpg","nickname":"Tony Bai","note":"","ucode":"B6B08985F6FA89","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":591389,"discussion_content":"åŸå…ˆæ­£åœ¨è¿è¡Œçš„Gè¢«å¼ºè¡Œç»ˆæ­¢ï¼Œæ¢å¦å¤–ä¸€ä¸ªGè¿è¡Œã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1666579009,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"åŒ—äº¬","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":357442,"user_name":"æŸ’","can_delete":false,"product_type":"c1","uid":2419502,"ip_address":"ç¾å›½","ucode":"D41241629321A1","user_header":"https://static001.geekbang.org/account/avatar/00/24/eb/2e/90fea784.jpg","comment_is_top":false,"comment_ctime":1663254598,"is_pvip":false,"replies":[{"id":130118,"content":"é¦–å…ˆè¿™æ˜¯P-Mæ¨¡å‹ä¸­çš„é—®é¢˜ï¼›\nå…¶æ¬¡ï¼Œå¯è¿è¡Œæ˜¯æŒ‡runnableï¼Œå³è¯¥Gåœ¨nextGæˆ–Mçš„æœ¬åœ°é˜Ÿåˆ—ä¸­(P-Mæ¨¡å‹)ï¼Œå¹¶ä¸æ˜¯æ­£åœ¨Mä¸Šè¿è¡Œçš„Gï¼›\næœ€åï¼Œå½“åœ¨Mä¸Šè¿è¡Œçš„Gå‡ºç°æ…¢ç³»ç»Ÿè°ƒç”¨åï¼ŒMå’ŒGæŒ‚èµ·ï¼Œå…¶nextGå’Œæœ¬åœ°é˜Ÿåˆ—ä¸­çš„Gå¯èƒ½å°±è¦è¢«ä¼ é€’ç»™å…¶ä»–M(å·²æœ‰çš„idle mæˆ–æ–°å»ºM)å¤„ç†ã€‚","user_name":"ä½œè€…å›å¤","user_name_real":"ç¼–è¾‘","uid":1026224,"ctime":1663367598,"ip_address":"ç¾å›½","comment_id":357442,"utype":1}],"discussion_count":2,"race_medal":0,"score":3,"product_id":100093501,"comment_content":"Goroutine ä¼ é€’é—®é¢˜ï¼šM ç»å¸¸åœ¨ M ä¹‹é—´ä¼ é€’â€œå¯è¿è¡Œâ€çš„ Goroutineï¼Ÿä¸ºå•¥ä¼šæœ‰ä¼ é€’å‘€ï¼Ÿ å°±ç®—æ˜¯ä¸Šä¸‹æ–‡åˆ‡æ¢ï¼Œåªä¼šæŒ‚èµ·ä¸€ä¸ªGï¼ŒMåˆ‡æ¢åˆ°æ‰§è¡Œå¦ä¸€ä¸ªGï¼Œå®ƒä¸ä¼šä»ä¸€ä¸ªMä¼ é€’åˆ°å¦ä¸€ä¸ªMå˜›ã€‚","like_count":1,"discussions":[{"author":{"id":1026224,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/a8/b0/6f87ab08.jpg","nickname":"Tony Bai","note":"","ucode":"B6B08985F6FA89","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":590937,"discussion_content":"1. å¯ä»å¤šæ ¸è§’åº¦è€ƒè™‘ä¸€ä¸‹\n2. è¿˜æ˜¯ä»å¯åˆ©ç”¨çš„è°ƒåº¦èµ„æºè§’åº¦è€ƒè™‘ä¸€ä¸‹ã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1666175629,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"åŒ—äº¬","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":356806,"user_name":"è èå¹é›ªâ€”Code","can_delete":false,"product_type":"c1","uid":1650378,"ip_address":"åŒ—äº¬","ucode":"A5B2FC661EE17D","user_header":"https://static001.geekbang.org/account/avatar/00/19/2e/ca/469f7266.jpg","comment_is_top":false,"comment_ctime":1662604446,"is_pvip":false,"replies":[{"id":129872,"content":"ğŸ‘","user_name":"ä½œè€…å›å¤","user_name_real":"ç¼–è¾‘","uid":1026224,"ctime":1662684212,"ip_address":"åŒ—äº¬","comment_id":356806,"utype":1}],"discussion_count":1,"race_medal":0,"score":3,"product_id":100093501,"comment_content":"æ‰“å¡","like_count":1,"discussions":[{"author":{"id":1026224,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/a8/b0/6f87ab08.jpg","nickname":"Tony Bai","note":"","ucode":"B6B08985F6FA89","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":587892,"discussion_content":"é¦–å…ˆè¿™æ˜¯P-Mæ¨¡å‹ä¸­çš„é—®é¢˜ï¼›\nå…¶æ¬¡ï¼Œå¯è¿è¡Œæ˜¯æŒ‡runnableï¼Œå³è¯¥Gåœ¨nextGæˆ–Mçš„æœ¬åœ°é˜Ÿåˆ—ä¸­(P-Mæ¨¡å‹)ï¼Œå¹¶ä¸æ˜¯æ­£åœ¨Mä¸Šè¿è¡Œçš„Gï¼›\næœ€åï¼Œå½“åœ¨Mä¸Šè¿è¡Œçš„Gå‡ºç°æ…¢ç³»ç»Ÿè°ƒç”¨åï¼ŒMå’ŒGæŒ‚èµ·ï¼Œå…¶nextGå’Œæœ¬åœ°é˜Ÿåˆ—ä¸­çš„Gå¯èƒ½å°±è¦è¢«ä¼ é€’ç»™å…¶ä»–M(å·²æœ‰çš„idle mæˆ–æ–°å»ºM)å¤„ç†ã€‚","likes_number":1,"is_delete":false,"is_hidden":false,"ctime":1663367598,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"ç¾å›½","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":1,"child_discussions":[{"author":{"id":2419502,"avatar":"https://static001.geekbang.org/account/avatar/00/24/eb/2e/90fea784.jpg","nickname":"æŸ’","note":"","ucode":"D41241629321A1","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":1026224,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/a8/b0/6f87ab08.jpg","nickname":"Tony Bai","note":"","ucode":"B6B08985F6FA89","race_medal":0,"user_type":2,"is_pvip":false},"discussion":{"id":587895,"discussion_content":"æ„Ÿè°¢è€å¸ˆï¼Œè±ç„¶å¼€æœ—","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1663377005,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":587892,"ip_address":"ä¸Šæµ·","group_id":0},"score":587895,"extra":""}]}]},{"had_liked":false,"id":351841,"user_name":"æ¯å¤©æ™’ç™½ç‰™","can_delete":false,"product_type":"c1","uid":1004698,"ip_address":"","ucode":"A1B102CD933DEA","user_header":"https://static001.geekbang.org/account/avatar/00/0f/54/9a/76c0af70.jpg","comment_is_top":false,"comment_ctime":1658224257,"is_pvip":false,"replies":[{"id":128097,"content":"â€œGo æ˜¯åœ¨ 1.2 ç‰ˆæœ¬å¢åŠ çš„æŠ¢å å¼è°ƒåº¦ï¼Œ1.13.xç‰ˆæœ¬è¿˜ä¸æ”¯æŒâ€ ï¼Œ 1.2ç‰ˆæœ¬ï¼Ÿ","user_name":"ä½œè€…å›å¤","user_name_real":"ç¼–è¾‘","uid":1026224,"ctime":1658401826,"ip_address":"","comment_id":351841,"utype":1}],"discussion_count":1,"race_medal":0,"score":3,"product_id":100093501,"comment_content":"æ€è€ƒé¢˜\n1.åœ¨ä¸€ä¸ªæ‹¥æœ‰å¤šæ ¸å¤„ç†å™¨çš„ä¸»æœºä¸Šï¼Œä½¿ç”¨ Go 1.13.x ç‰ˆæœ¬è¿è¡Œè¿™ä¸ªç¤ºä¾‹ä»£ç ï¼Œä½ åœ¨å‘½ä»¤è¡Œç»ˆç«¯ä¸Šæ˜¯å¦èƒ½çœ‹åˆ°â€œI got scheduled!â€è¾“å‡ºå‘¢ï¼Ÿä¹Ÿå°±æ˜¯ main goroutine åœ¨åˆ›å»º deadloop goroutine ä¹‹åæ˜¯å¦èƒ½ç»§ç»­å¾—åˆ°è°ƒåº¦å‘¢ï¼Ÿ\nç­”ï¼šä¸ä¼šå¾—åˆ°è°ƒåº¦ï¼Œé¦–å…ˆ Go æ˜¯åœ¨ 1.2 ç‰ˆæœ¬å¢åŠ çš„æŠ¢å å¼è°ƒåº¦ï¼Œ1.13.xç‰ˆæœ¬è¿˜ä¸æ”¯æŒï¼Œå› ä¸ºdeadloop goroutine æ˜¯æ­»å¾ªç¯ï¼Œæ‰€ä»¥è¿™ä¸ªGä¼šæ°¸è¿œå ç”¨åˆ†é…çš„På’ŒM\n\n2.æˆ‘ä»¬é€šè¿‡ä»€ä¹ˆæ–¹æ³•å¯ä»¥è®©ä¸Šé¢ç¤ºä¾‹ä¸­çš„ main goroutineï¼Œåœ¨åˆ›å»º deadloop goroutine ä¹‹åæ— æ³•ç»§ç»­å¾—åˆ°è°ƒåº¦ï¼Ÿ\nä¸¤ä¸ªå¿…è¦æ¡ä»¶\nâ‘ goçš„ç‰ˆæœ¬è¦åœ¨1.2ä¹‹å‰ï¼Œå› ä¸º1.2ä¹‹å‰ä¸æ”¯æŒæŠ¢å å¼è°ƒåº¦ï¼Œå¯ä»¥ç¡®ä¿Gå¯ä»¥å ç”¨åˆ†é…ç»™å®ƒçš„På’ŒM\nâ‘¡è®¾ç½®GOMAXPROCS=1\n","like_count":1,"discussions":[{"author":{"id":1026224,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/a8/b0/6f87ab08.jpg","nickname":"Tony Bai","note":"","ucode":"B6B08985F6FA89","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":587008,"discussion_content":"ğŸ‘","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1662684212,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"åŒ—äº¬","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":343933,"user_name":"pythonbug","can_delete":false,"product_type":"c1","uid":1487274,"ip_address":"","ucode":"1A70CA92FFF8EB","user_header":"https://wx.qlogo.cn/mmopen/vi_32/wgMMrp1hvSB3E30KqZvMsj3KQdAI3T1uQM77LT7hZ65nVSjPGRg3AbUOyiahnssA6AIT5PAkyHFmlTBzUH9gdyQ/132","comment_is_top":false,"comment_ctime":1651126643,"is_pvip":false,"replies":[{"id":125662,"content":"go 1.14ç‰ˆæœ¬ä¹‹å‰ä¸æ”¯æŒç›´æ¥æŠ¢å ï¼Œè€Œæ˜¯åœ¨å‡½æ•°æˆ–æ–¹æ³•ä¸­â€œæ·»åŠ è°ƒåº¦ä»£ç â€ï¼Œæ‰€ä»¥è™½ç„¶è®¾ç½®äº†æŠ¢å æ ‡å¿—ï¼Œä½†æ˜¯åªæœ‰ä¸‹ä¸€æ¬¡è¿è¡Œâ€œæ·»åŠ çš„è°ƒåº¦ä»£ç â€æ—¶ï¼Œè¯¥Gæ‰ä¼šè®©å‡ºMã€‚","user_name":"ä½œè€…å›å¤","user_name_real":"ç¼–è¾‘","uid":1026224,"ctime":1651288980,"ip_address":"","comment_id":343933,"utype":1}],"discussion_count":1,"race_medal":0,"score":3,"product_id":100093501,"comment_content":"â€œå¦‚æœä¸€ä¸ª G ä»»åŠ¡è¿è¡Œ 10msï¼Œ...... é‚£ä¹ˆç­‰åˆ°è¿™ä¸ª G ä¸‹ä¸€æ¬¡è°ƒç”¨å‡½æ•°æˆ–æ–¹æ³•æ—¶ï¼Œ...... ç­‰å¾…ä¸‹ä¸€æ¬¡è¢«è°ƒåº¦ã€‚â€\nè€å¸ˆå¥½ï¼Œæœ‰ä¸ªé—®é¢˜ï¼ŒæŸä¸ªgoroutineè¿è¡Œè¶…è¿‡10msäº†ï¼Œä¸ºå•¥ä¸ç›´æ¥æŠ¢å ï¼Œç­‰å¾…ä¸‹ä¸€æ¬¡æ˜¯ä»€ä¹ˆæ„æ€å‘¢ï¼Ÿé‚£ä¹ˆè¿™æ¬¡æ˜¯ç›´æ¥è¿è¡Œå®Œå—ï¼Œæ—¢ç„¶è¿™æ¬¡éƒ½è¿è¡Œå®Œäº†ï¼Œåˆæ€ä¹ˆä¼šæœ‰ä¸‹ä¸€æ¬¡å‘¢ã€‚ã€‚ã€‚è¿™æ®µä¸å¤§ç†è§£ï¼Œæœ‰ç‚¹æ‡µäº†ã€‚ã€‚ã€‚","like_count":1,"discussions":[{"author":{"id":1026224,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/a8/b0/6f87ab08.jpg","nickname":"Tony Bai","note":"","ucode":"B6B08985F6FA89","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":580914,"discussion_content":"â€œGo æ˜¯åœ¨ 1.2 ç‰ˆæœ¬å¢åŠ çš„æŠ¢å å¼è°ƒåº¦ï¼Œ1.13.xç‰ˆæœ¬è¿˜ä¸æ”¯æŒâ€ ï¼Œ 1.2ç‰ˆæœ¬ï¼Ÿ","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1658401826,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":338606,"user_name":"simple_å­™","can_delete":false,"product_type":"c1","uid":1873629,"ip_address":"","ucode":"A77203E242D652","user_header":"https://static001.geekbang.org/account/avatar/00/1c/96/dd/1620a744.jpg","comment_is_top":false,"comment_ctime":1647593322,"is_pvip":false,"replies":[{"id":123791,"content":"æ¯ä¸ªPåªæœ‰ä¸€ä¸ªé˜Ÿåˆ—ã€‚","user_name":"ä½œè€…å›å¤","user_name_real":"ç¼–è¾‘","uid":1026224,"ctime":1647654138,"ip_address":"","comment_id":338606,"utype":1}],"discussion_count":1,"race_medal":0,"score":3,"product_id":100093501,"comment_content":"æ¯ä¸ªPæ˜¯ä¸æ˜¯è·ŸJavaä¸­çš„çº¿ç¨‹ä¸€æ ·éƒ½æœ‰ä¸€ä¸ªå°±ç»ªé˜Ÿåˆ—å’Œç­‰å¾…é˜Ÿåˆ—å‘¢","like_count":1,"discussions":[{"author":{"id":1026224,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/a8/b0/6f87ab08.jpg","nickname":"Tony Bai","note":"","ucode":"B6B08985F6FA89","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":569011,"discussion_content":"go 1.14ç‰ˆæœ¬ä¹‹å‰ä¸æ”¯æŒç›´æ¥æŠ¢å ï¼Œè€Œæ˜¯åœ¨å‡½æ•°æˆ–æ–¹æ³•ä¸­â€œæ·»åŠ è°ƒåº¦ä»£ç â€ï¼Œæ‰€ä»¥è™½ç„¶è®¾ç½®äº†æŠ¢å æ ‡å¿—ï¼Œä½†æ˜¯åªæœ‰ä¸‹ä¸€æ¬¡è¿è¡Œâ€œæ·»åŠ çš„è°ƒåº¦ä»£ç â€æ—¶ï¼Œè¯¥Gæ‰ä¼šè®©å‡ºMã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1651288980,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":332852,"user_name":"ä¸è´Ÿé’æ˜¥ä¸è´Ÿå·±ğŸ¤˜","can_delete":false,"product_type":"c1","uid":1363671,"ip_address":"","ucode":"A6DD8E8B20EA6E","user_header":"https://static001.geekbang.org/account/avatar/00/14/ce/d7/5315f6ce.jpg","comment_is_top":false,"comment_ctime":1643732043,"is_pvip":false,"replies":[{"id":121740,"content":"ğŸ‘","user_name":"ä½œè€…å›å¤","user_name_real":"ç¼–è¾‘","uid":1026224,"ctime":1644120952,"ip_address":"","comment_id":332852,"utype":1}],"discussion_count":1,"race_medal":0,"score":4,"product_id":100093501,"comment_content":"mark","like_count":1},{"had_liked":false,"id":331777,"user_name":"Geek_0b92d9","can_delete":false,"product_type":"c1","uid":2835237,"ip_address":"","ucode":"9212443F63B64B","user_header":"","comment_is_top":false,"comment_ctime":1642756729,"is_pvip":false,"replies":[{"id":121604,"content":"æˆ‘è§‰å¾—è¿™ä¸ªä¾‹å­è¾“å‡ºé¡ºåºä¸ç”¨æ·±ç©¶ï¼Œåœ¨æˆ‘çš„macå’Œlinuxä¸Šï¼Œä½ çš„ç¬¬äºŒä¸ªç¨‹åºè¾“å‡º2 3 0 1ã€‚","user_name":"ä½œè€…å›å¤","user_name_real":"ç¼–è¾‘","uid":1026224,"ctime":1643537764,"ip_address":"","comment_id":331777,"utype":1}],"discussion_count":1,"race_medal":0,"score":4,"product_id":100093501,"comment_content":"è€å¸ˆå¥½ã€‚å…³äºè°ƒåº¦çš„é¡ºåºï¼Œæƒ³è¯·æ•™ä¸‹ã€‚\n\nfunc main() {\n\truntime.GOMAXPROCS(1)\n\n\t&#47;&#47; å¯åŠ¨ 4 ä¸ªåç¨‹\n\tvar i int\n\tfor i = 0; i &lt; 4; i++ {\n\t\tgo func(i int) {\n\t\t\tfmt.Printf(&quot;hello %d \\n&quot;, i)\n\t\t}(i)\n\t}\n\n\tfmt.Println(&quot;hello main&quot;)\n\n\ttime.Sleep(1 * time.Second)\n}\n&#47;&#47;è¾“å‡ºçš„æ˜¯ 3,0,1,2\n\nå¦‚æœæˆ‘åœ¨æ¯ä¸ªå­åç¨‹æ‰“å°å‰ï¼ŒåŠ ä¸Š time.Sleep(10 * time.Millisecond) ï¼Œå®Œæ•´ä»£ç å¦‚ä¸‹ï¼š\nfunc main() {\n\truntime.GOMAXPROCS(1)\n\n\t&#47;&#47; å¯åŠ¨ 4 ä¸ªåç¨‹\n\tvar i int\n\tfor i = 0; i &lt; 4; i++ {\n\t\tgo func(i int) {\n\t\t\ttime.Sleep(10 * time.Millisecond)\n\t\t\tfmt.Printf(&quot;hello %d \\n&quot;, i)\n\t\t}(i)\n\t}\n\n\tfmt.Println(&quot;hello main&quot;)\n\n\ttime.Sleep(1 * time.Second)\n}\n&#47;&#47;åˆè¾“å‡º 0,3,2,1\n","like_count":1,"discussions":[{"author":{"id":1026224,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/a8/b0/6f87ab08.jpg","nickname":"Tony Bai","note":"","ucode":"B6B08985F6FA89","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":549604,"discussion_content":"ğŸ‘","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1644120952,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":330204,"user_name":"DullBird","can_delete":false,"product_type":"c1","uid":1110494,"ip_address":"","ucode":"80E2FD5F9687CB","user_header":"https://static001.geekbang.org/account/avatar/00/10/f1/de/3ebcbb3f.jpg","comment_is_top":false,"comment_ctime":1641865846,"is_pvip":false,"replies":[{"id":120295,"content":"æ–‡é‡Œæœ‰è¯´ï¼Œæ˜¯åœ¨ç³»ç»Ÿè°ƒç”¨è¿”å›åï¼Œæ‰¾ä¸åˆ°idleçš„Pçš„æƒ…å†µä¸‹ï¼Œmä¼šè¿›å…¥åˆ°idle mæ± ä¸­æŒ‚èµ·ã€‚","user_name":"ä½œè€…å›å¤","user_name_real":"ç¼–è¾‘","uid":1026224,"ctime":1641868922,"ip_address":"","comment_id":330204,"utype":1}],"discussion_count":1,"race_medal":0,"score":4,"product_id":100093501,"comment_content":"å°ç»“ä¸Šé¢ä¸€å¥ï¼šä¹‹å‰çš„é‚£ä¸ªæŒ‚èµ·çš„ M å°†å†æ¬¡è¿›å…¥æŒ‚èµ·çŠ¶æ€ã€‚   æœ€åæ˜¯ä¸æ˜¯è¿è¡ŒçŠ¶æ€å§ï¼Ÿ","like_count":1,"discussions":[{"author":{"id":1026224,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/a8/b0/6f87ab08.jpg","nickname":"Tony Bai","note":"","ucode":"B6B08985F6FA89","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":545164,"discussion_content":"æ–‡é‡Œæœ‰è¯´ï¼Œæ˜¯åœ¨ç³»ç»Ÿè°ƒç”¨è¿”å›åï¼Œæ‰¾ä¸åˆ°idleçš„Pçš„æƒ…å†µä¸‹ï¼Œmä¼šè¿›å…¥åˆ°idle mæ± ä¸­æŒ‚èµ·ã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1641868922,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":392064,"user_name":"stronger","can_delete":false,"product_type":"c1","uid":2027792,"ip_address":"å¹¿ä¸œ","ucode":"539BE06C45F54A","user_header":"https://static001.geekbang.org/account/avatar/00/1e/f1/10/cdb35cd1.jpg","comment_is_top":false,"comment_ctime":1719847756,"is_pvip":false,"replies":[{"id":142523,"content":"Gæ‰€ç»‘å®šçš„Mä¼šè¿›å…¥å†…æ ¸æ€ã€‚","user_name":"ä½œè€…å›å¤","user_name_real":"ç¼–è¾‘","uid":1026224,"ctime":1719928498,"ip_address":"è¾½å®","comment_id":392064,"utype":1}],"discussion_count":1,"race_medal":0,"score":4,"product_id":100093501,"comment_content":"goroutineåœ¨è¿›è¡Œç³»ç»Ÿè°ƒç”¨çš„æ—¶å€™ï¼Œä¼šåœ¨å†…æ ¸æ€è¿è¡Œå—ï¼Ÿ","like_count":0,"discussions":[{"author":{"id":1026224,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/a8/b0/6f87ab08.jpg","nickname":"Tony Bai","note":"","ucode":"B6B08985F6FA89","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":647364,"discussion_content":"Gæ‰€ç»‘å®šçš„Mä¼šè¿›å…¥å†…æ ¸æ€ã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1719928498,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"è¾½å®","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2,\"source\":0}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":391104,"user_name":"Geek_73c432","can_delete":false,"product_type":"c1","uid":2869118,"ip_address":"å¹¿ä¸œ","ucode":"3E11EB02B14DE0","user_header":"","comment_is_top":false,"comment_ctime":1717332111,"is_pvip":false,"replies":[{"id":142278,"content":"åä½œå¼å¯ä»¥ç†è§£ä¸ºåŒæ–¹éµå®ˆå…±åŒçº¦å®šï¼Œæ¯”å¦‚ç”¨10mså°±æŠŠpè®©å‡ºæ¥ã€‚éåä½œå¼ï¼Œä¹Ÿå¯ä»¥ç†è§£ä¸ºæŠ¢å å¼ï¼Œå³runtimeå±‚é¢ä¼šåœ¨ç‰¹å®šæ¡ä»¶ä¸‹æŠŠä½ ä½¿ç”¨pçš„æƒåŠ›å‰¥å¤ºäº†ï¼Œç»™å…¶ä»–gï¼Œä¸ç®¡æ˜¯æ˜¯å¦è¿˜è¦ç»§ç»­ç”¨è¿™ä¸ªpã€‚","user_name":"ä½œè€…å›å¤","user_name_real":"ç¼–è¾‘","uid":1026224,"ctime":1717656000,"ip_address":"åŒ—äº¬","comment_id":391104,"utype":1}],"discussion_count":1,"race_medal":0,"score":4,"product_id":100093501,"comment_content":"è€å¸ˆï¼Œæ€ä¹ˆç†è§£\nåŸºäºåä½œçš„â€œæŠ¢å å¼â€è°ƒåº¦\néåä½œçš„æŠ¢å å¼è°ƒåº¦\nè¿™ä¸¤ä¸ªè¡¨è¾¾ï¼Ÿ\n\nä¸ªäººè®¤ä¸ºï¼Œåœ¨è°ƒåº¦ç­–ç•¥ä¸­ï¼Œ &quot;åä½œå¼&quot; å’Œ &quot;æŠ¢å å¼&quot; æ˜¯ä¸¤ç§æˆªç„¶ä¸åŒçš„ç­–ç•¥ã€‚ä»æ–‡ä¸­æ²¡çœ‹å‡ºæ¥å“ªé‡Œä½“ç°äº†â€åä½œâ€œå•Š","like_count":0,"discussions":[{"author":{"id":1026224,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/a8/b0/6f87ab08.jpg","nickname":"Tony Bai","note":"","ucode":"B6B08985F6FA89","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":646273,"discussion_content":"åä½œå¼å¯ä»¥ç†è§£ä¸ºåŒæ–¹éµå®ˆå…±åŒçº¦å®šï¼Œæ¯”å¦‚ç”¨10mså°±æŠŠpè®©å‡ºæ¥ã€‚éåä½œå¼ï¼Œä¹Ÿå¯ä»¥ç†è§£ä¸ºæŠ¢å å¼ï¼Œå³runtimeå±‚é¢ä¼šåœ¨ç‰¹å®šæ¡ä»¶ä¸‹æŠŠä½ ä½¿ç”¨pçš„æƒåŠ›å‰¥å¤ºäº†ï¼Œç»™å…¶ä»–gï¼Œä¸ç®¡æ˜¯æ˜¯å¦è¿˜è¦ç»§ç»­ç”¨è¿™ä¸ªpã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1717656000,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"åŒ—äº¬","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2,\"source\":0}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":330827,"user_name":"Calvin","can_delete":false,"product_type":"c1","uid":1603004,"ip_address":"","ucode":"0EEF5B207623B5","user_header":"https://static001.geekbang.org/account/avatar/00/18/75/bc/89d88775.jpg","comment_is_top":false,"comment_ctime":1642184982,"is_pvip":false,"replies":[{"id":121590,"content":"æˆ‘æ²¡çœ‹åˆ°ä½ çš„ç­”æ¡ˆä¸Geek_cca544 åŒå­¦çš„ç»“è®ºæœ‰å•¥ä¸ä¸€æ ·å•Šã€‚ä½ çš„go1.17.6 windows&#47;amd64 ç‰ˆæœ¬æµ‹è¯•ç»“æœæœ‰å•¥ä¸ä¸€æ ·ä¹ˆï¼Ÿ","user_name":"ä½œè€…å›å¤","user_name_real":"ç¼–è¾‘","uid":1026224,"ctime":1643522513,"ip_address":"","comment_id":330827,"utype":1}],"discussion_count":2,"race_medal":0,"score":4,"product_id":100093501,"comment_content":"æ€è€ƒé¢˜ï¼š\n1ã€å¯ä»¥å®šæ—¶ 1 ç§’é—´éš”åœ°ä¸æ–­çœ‹åˆ°â€œI got scheduled!â€è¾“å‡ºï¼›\n2ã€main å‡½æ•°ä¸­ï¼Œgo deadloop() è¯­å¥å‰æ·»åŠ  runtime.GOMAXPROCS(1)ï¼Œå³å¯ä½¿ main goroutine åœ¨åˆ›å»º deadloop goroutine ä¹‹åæ— æ³•ç»§ç»­å¾—åˆ°è°ƒåº¦ã€‚\n\nPSï¼šåŸºäº go1.17.6 windows&#47;amd64 ç‰ˆæœ¬æµ‹è¯•ï¼Œæˆ‘è¿™æµ‹è¯•ç»“æœä¸ç•™è¨€ä¸­ Geek_cca544 åŒå­¦çš„ç»“è®ºä¸ä¸€æ ·ï¼Œè¯·é—®è€å¸ˆé—®é¢˜ 2 å“ªä¸ªç­”æ¡ˆæ˜¯å¯¹çš„å‘¢ï¼Ÿ","like_count":0,"discussions":[{"author":{"id":1026224,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/a8/b0/6f87ab08.jpg","nickname":"Tony Bai","note":"","ucode":"B6B08985F6FA89","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":646273,"discussion_content":"åä½œå¼å¯ä»¥ç†è§£ä¸ºåŒæ–¹éµå®ˆå…±åŒçº¦å®šï¼Œæ¯”å¦‚ç”¨10mså°±æŠŠpè®©å‡ºæ¥ã€‚éåä½œå¼ï¼Œä¹Ÿå¯ä»¥ç†è§£ä¸ºæŠ¢å å¼ï¼Œå³runtimeå±‚é¢ä¼šåœ¨ç‰¹å®šæ¡ä»¶ä¸‹æŠŠä½ ä½¿ç”¨pçš„æƒåŠ›å‰¥å¤ºäº†ï¼Œç»™å…¶ä»–gï¼Œä¸ç®¡æ˜¯æ˜¯å¦è¿˜è¦ç»§ç»­ç”¨è¿™ä¸ªpã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1717656000,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"åŒ—äº¬","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2,\"source\":0}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":392065,"user_name":"stronger","can_delete":false,"product_type":"c1","uid":2027792,"ip_address":"å¹¿ä¸œ","ucode":"539BE06C45F54A","user_header":"https://static001.geekbang.org/account/avatar/00/1e/f1/10/cdb35cd1.jpg","comment_is_top":false,"comment_ctime":1719847807,"is_pvip":false,"replies":null,"discussion_count":0,"race_medal":0,"score":4,"product_id":100093501,"comment_content":"ç³»ç»Ÿè°ƒç”¨ä¸‹çš„è°ƒåº¦ï¼Œgorountine ä¼šè¿è¡Œåœ¨å†…æ ¸æ€å—ï¼Ÿ","like_count":0},{"had_liked":false,"id":391349,"user_name":"äººè¨€æœ‰åŠ›","can_delete":false,"product_type":"c1","uid":1690736,"ip_address":"æµ™æ±Ÿ","ucode":"3708FBBFB641FE","user_header":"https://static001.geekbang.org/account/avatar/00/19/cc/70/64045bc0.jpg","comment_is_top":false,"comment_ctime":1718071524,"is_pvip":false,"replies":null,"discussion_count":0,"race_medal":0,"score":4,"product_id":100093501,"comment_content":"æœ¬èŠ‚è®²è¿°äº†goè¯­è¨€å¹¶å‘è°ƒåº¦å™¨çš„åŸºæœ¬åŸç†ï¼Œä»G-Måˆ°G-P-Mæ¨¡å‹ï¼Œä»éæŠ¢å å¼åˆ°åä½œæŠ¢å åˆ°ä¿¡å·æŠ¢å çš„æ¼”è¿›ã€‚æˆ‘ä»¬ç°åœ¨ç”¨åˆ°çš„è¿˜æ˜¯G-P-Mæ¨¡å‹ï¼Œå…¶ä¸­Gæ˜¯goroutineä¿å­˜è°ƒç”¨æ ˆï¼ŒPæ˜¯é€»è¾‘å¤„ç†å™¨ï¼Œä¿å­˜ä¸€ä¸ªGçš„è¿è¡Œé˜Ÿåˆ—ï¼Œæ•°é‡ç”±GOMAXPROCSæ§åˆ¶ï¼Œè€ŒMæ˜¯çœŸå®è°ƒåº¦å™¨ï¼Œå’Œç³»ç»Ÿçº¿ç¨‹ç»‘å®šã€‚\nè°ƒåº¦è¿‡ç¨‹å°±æ˜¯å¯åŠ¨goroutineåä¼šç»‘å®šä¸€ä¸ªPé˜Ÿåˆ—ï¼ŒPé˜Ÿåˆ—å’ŒMè°ƒåº¦å™¨ç»‘å®šè¿›è¡ŒCPUæ‰§è¡Œã€‚\næŠ¢å è¿‡ç¨‹å°±æ˜¯ä¼šæœ‰ä¸€ä¸ªä¸“é—¨çš„G0ä½œä¸ºè°ƒåº¦Gï¼Œå¸¸è§„æƒ…å†µå°±æ˜¯æ‰§è¡Œå„è‡ªæ—¶é—´ç‰‡ä¹‹åï¼Œå¸¸è§„çš„Gä¼šè¢«è®¾ç½®ä¸ºå¯æŠ¢å ï¼Œä¸‹ä¸ªè°ƒåº¦è¢«ç§»é™¤é˜Ÿåˆ—é‡æ–°å…¥é˜Ÿï¼›IOæƒ…å†µä¸‹Gä¼šè¿›å…¥ç­‰å¾…ï¼Œè€ŒMä¼šå’Œè¿è¡ŒPçš„ä¸‹ä¸ªGï¼›å¦‚æœæ˜¯ç³»ç»Ÿè°ƒç”¨ï¼Œåˆ™Må’ŒGéƒ½ä¼šé˜»å¡ï¼Œç„¶åPä¼šå°è¯•ç»‘å®šç©ºé—²Mæˆ–æ–°å»ºMï¼Œå¯¼è‡´çº¿ç¨‹æ•°å¢åŠ ï¼Œéœ€è¦æ³¨æ„ã€‚\n\næ€è€ƒé¢˜ï¼šç”±äºæ˜¯å¤šæ ¸ï¼Œæ˜¯å¯ä»¥è¢«è°ƒåº¦çš„ï¼Œé™¤éGOMAXPROCS=1","like_count":0},{"had_liked":false,"id":358761,"user_name":"piboye","can_delete":false,"product_type":"c1","uid":1066752,"ip_address":"æ±Ÿè¥¿","ucode":"7CFD8712857A85","user_header":"https://static001.geekbang.org/account/avatar/00/10/47/00/3202bdf0.jpg","comment_is_top":false,"comment_ctime":1664704646,"is_pvip":true,"replies":null,"discussion_count":0,"race_medal":0,"score":4,"product_id":100093501,"comment_content":"gpmæ¨¡å‹è¿˜æ˜¯æœ‰æ€§èƒ½é—®é¢˜å§ï¼Ÿ måº”è¯¥è¦å°½é‡ç»‘æ ¸ï¼Œé˜»å¡è°ƒç”¨ï¼Œåº”è¯¥ç”¨å…¶å®ƒçº¿ç¨‹å»å¤„ç†ï¼Œå°½é‡ä¸è¦å ç”¨å½“å‰mã€‚","like_count":0,"discussions":[{"author":{"id":1026224,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/a8/b0/6f87ab08.jpg","nickname":"Tony Bai","note":"","ucode":"B6B08985F6FA89","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":549032,"discussion_content":"æˆ‘æ²¡çœ‹åˆ°ä½ çš„ç­”æ¡ˆä¸Geek_cca544 åŒå­¦çš„ç»“è®ºæœ‰å•¥ä¸ä¸€æ ·å•Šã€‚ä½ çš„go1.17.6 windows/amd64 ç‰ˆæœ¬æµ‹è¯•ç»“æœæœ‰å•¥ä¸ä¸€æ ·ä¹ˆï¼Ÿ","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1643522513,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1603004,"avatar":"https://static001.geekbang.org/account/avatar/00/18/75/bc/89d88775.jpg","nickname":"Calvin","note":"","ucode":"0EEF5B207623B5","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":547498,"discussion_content":"åŸºäºæ€è€ƒé¢˜ 2 ä¸­ä¸Šé¢æˆ‘è‡ªå·±æå‡ºçš„é—®é¢˜ï¼Œæˆ‘è‡ªå·±çˆ¬æœç´¢å¼•æ“æ‰¾åˆ°åŸå› äº†ï¼šè¿™æ˜¯å› ä¸º deadloop å‡½æ•°å†…éƒ¨é€»è¾‘æ²¡æœ‰ç»™è°ƒåº¦å™¨ä»»ä½•æŠ¢å çš„æœºä¼šï¼ˆç©ºå¾ªç¯ä½“ï¼Œæ— ä»»ä½•ç³»ç»Ÿè°ƒç”¨ï¼‰ï¼\n\nä»¥ä¸‹è¿™ä¸ªä»£ç åº”è¯¥æ¯”è¾ƒå®¹æ˜“çœ‹åˆ° 0 å’Œ 1 çš„äº¤æ›¿æ‰“å°ï¼ˆå·²ç»è®¾ç½®äº† GOMAXPROCS = 1ï¼‰ï¼š\nfunc deadLoop() {\n\tfor {\n\t\tfmt.Print(0)\n\t}\n}\nfunc TestDeadLoop(t *testing.T) {\n\t// GOMAXPROCSï¼šè¡¨ç¤º Go è°ƒåº¦å™¨å¯è§çš„â€œå¤„ç†å™¨â€çš„æœ€å¤§æ•°é‡\n\truntime.GOMAXPROCS(1)\n\tgo deadLoop()\n\tfor {\n\t\tfmt.Print(1)\n\t}\n}\n\nç™½è€å¸ˆçš„æœ¬ç¯‡æ–‡ç« ä¸­å…¶å®ä¹Ÿæœ‰æåˆ°ï¼šâ€œæ­»å¾ªç¯ç­‰å¹¶æ²¡æœ‰ç»™ç¼–è¯‘å™¨æ’å…¥æŠ¢å ä»£ç  (runtime.morestack_noctxt) çš„æœºä¼šï¼Œè¿™å°±ä¼šå¯¼è‡´ GC åœ¨ç­‰å¾…æ‰€æœ‰ Goroutine åœæ­¢æ—¶çš„ç­‰å¾…æ—¶é—´è¿‡é•¿ï¼Œä»è€Œå¯¼è‡´ GC å»¶è¿Ÿï¼Œå†…å­˜å ç”¨ç¬é—´å†²é«˜ï¼›ç”šè‡³åœ¨ä¸€äº›ç‰¹æ®Šæƒ…å†µä¸‹ï¼Œå¯¼è‡´åœ¨ STWï¼ˆstop the worldï¼‰æ—¶æ­»é”ã€‚ä¸ºäº†è§£å†³è¿™äº›é—®é¢˜ï¼ŒGo åœ¨ 1.14 ç‰ˆæœ¬ä¸­æ¥å—äº†å¥¥æ–¯æ±€ - å…‹è±é—¨èŒ¨ï¼ˆAustin Clementsï¼‰çš„ææ¡ˆï¼Œå¢åŠ äº†å¯¹éåä½œçš„æŠ¢å å¼è°ƒåº¦çš„æ”¯æŒï¼Œè¿™ç§æŠ¢å å¼è°ƒåº¦æ˜¯åŸºäºç³»ç»Ÿä¿¡å·çš„ï¼Œä¹Ÿå°±æ˜¯é€šè¿‡å‘çº¿ç¨‹å‘é€ä¿¡å·çš„æ–¹å¼æ¥æŠ¢å æ­£åœ¨è¿è¡Œçš„ Goroutineã€‚â€\n\nPSï¼šæ‰¾ç­”æ¡ˆçš„è¿‡ç¨‹ä¸­ï¼Œè¿˜çˆ¬åˆ°ç™½è€å¸ˆåœ¨ 2017 å¹´å†™è¿‡çš„ä¸€ç¯‡æ–‡ç« ï¼Œå…¶ä¸­æœ‰åˆ†æè¿™ä¸ªé—®é¢˜ï¼Œé‡Œé¢ç¬¬ä¸€ä¸ªç¤ºä¾‹ä»£ç è·Ÿæœ¬ç¯‡æ–‡ç« ä¸­çš„ä¸€æ¨¡ä¸€æ ·ï¼Œå¯ä»¥çœ‹çœ‹å¯¹æ¯”å­¦ä¹ ä¸€ä¸‹ï¼Œæ–‡ç« åœ°å€ï¼šhttps://tonybai.com/2017/11/23/the-simple-analysis-of-goroutine-schedule-examples/","likes_number":2,"is_delete":false,"is_hidden":false,"ctime":1642704115,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":332852,"user_name":"ä¸è´Ÿé’æ˜¥ä¸è´Ÿå·±ğŸ¤˜","can_delete":false,"product_type":"c1","uid":1363671,"ip_address":"","ucode":"A6DD8E8B20EA6E","user_header":"https://static001.geekbang.org/account/avatar/00/14/ce/d7/5315f6ce.jpg","comment_is_top":false,"comment_ctime":1643732043,"is_pvip":false,"replies":[{"id":121740,"content":"ğŸ‘","user_name":"ä½œè€…å›å¤","user_name_real":"ç¼–è¾‘","uid":1026224,"ctime":1644120952,"ip_address":"","comment_id":332852,"utype":1}],"discussion_count":1,"race_medal":0,"score":4,"product_id":100093501,"comment_content":"mark","like_count":1,"discussions":[{"author":{"id":1026224,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/a8/b0/6f87ab08.jpg","nickname":"Tony Bai","note":"","ucode":"B6B08985F6FA89","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":549604,"discussion_content":"ğŸ‘","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1644120952,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":331777,"user_name":"Geek_0b92d9","can_delete":false,"product_type":"c1","uid":2835237,"ip_address":"","ucode":"9212443F63B64B","user_header":"","comment_is_top":false,"comment_ctime":1642756729,"is_pvip":false,"replies":[{"id":121604,"content":"æˆ‘è§‰å¾—è¿™ä¸ªä¾‹å­è¾“å‡ºé¡ºåºä¸ç”¨æ·±ç©¶ï¼Œåœ¨æˆ‘çš„macå’Œlinuxä¸Šï¼Œä½ çš„ç¬¬äºŒä¸ªç¨‹åºè¾“å‡º2 3 0 1ã€‚","user_name":"ä½œè€…å›å¤","user_name_real":"ç¼–è¾‘","uid":1026224,"ctime":1643537764,"ip_address":"","comment_id":331777,"utype":1}],"discussion_count":1,"race_medal":0,"score":4,"product_id":100093501,"comment_content":"è€å¸ˆå¥½ã€‚å…³äºè°ƒåº¦çš„é¡ºåºï¼Œæƒ³è¯·æ•™ä¸‹ã€‚\n\nfunc main() {\n\truntime.GOMAXPROCS(1)\n\n\t&#47;&#47; å¯åŠ¨ 4 ä¸ªåç¨‹\n\tvar i int\n\tfor i = 0; i &lt; 4; i++ {\n\t\tgo func(i int) {\n\t\t\tfmt.Printf(&quot;hello %d \\n&quot;, i)\n\t\t}(i)\n\t}\n\n\tfmt.Println(&quot;hello main&quot;)\n\n\ttime.Sleep(1 * time.Second)\n}\n&#47;&#47;è¾“å‡ºçš„æ˜¯ 3,0,1,2\n\nå¦‚æœæˆ‘åœ¨æ¯ä¸ªå­åç¨‹æ‰“å°å‰ï¼ŒåŠ ä¸Š time.Sleep(10 * time.Millisecond) ï¼Œå®Œæ•´ä»£ç å¦‚ä¸‹ï¼š\nfunc main() {\n\truntime.GOMAXPROCS(1)\n\n\t&#47;&#47; å¯åŠ¨ 4 ä¸ªåç¨‹\n\tvar i int\n\tfor i = 0; i &lt; 4; i++ {\n\t\tgo func(i int) {\n\t\t\ttime.Sleep(10 * time.Millisecond)\n\t\t\tfmt.Printf(&quot;hello %d \\n&quot;, i)\n\t\t}(i)\n\t}\n\n\tfmt.Println(&quot;hello main&quot;)\n\n\ttime.Sleep(1 * time.Second)\n}\n&#47;&#47;åˆè¾“å‡º 0,3,2,1\n","like_count":1,"discussions":[{"author":{"id":1026224,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/a8/b0/6f87ab08.jpg","nickname":"Tony Bai","note":"","ucode":"B6B08985F6FA89","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":549062,"discussion_content":"æˆ‘è§‰å¾—è¿™ä¸ªä¾‹å­è¾“å‡ºé¡ºåºä¸ç”¨æ·±ç©¶ï¼Œåœ¨æˆ‘çš„macå’Œlinuxä¸Šï¼Œä½ çš„ç¬¬äºŒä¸ªç¨‹åºè¾“å‡º2 3 0 1ã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1643537764,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":330204,"user_name":"DullBird","can_delete":false,"product_type":"c1","uid":1110494,"ip_address":"","ucode":"80E2FD5F9687CB","user_header":"https://static001.geekbang.org/account/avatar/00/10/f1/de/3ebcbb3f.jpg","comment_is_top":false,"comment_ctime":1641865846,"is_pvip":false,"replies":[{"id":120295,"content":"æ–‡é‡Œæœ‰è¯´ï¼Œæ˜¯åœ¨ç³»ç»Ÿè°ƒç”¨è¿”å›åï¼Œæ‰¾ä¸åˆ°idleçš„Pçš„æƒ…å†µä¸‹ï¼Œmä¼šè¿›å…¥åˆ°idle mæ± ä¸­æŒ‚èµ·ã€‚","user_name":"ä½œè€…å›å¤","user_name_real":"ç¼–è¾‘","uid":1026224,"ctime":1641868922,"ip_address":"","comment_id":330204,"utype":1}],"discussion_count":1,"race_medal":0,"score":4,"product_id":100093501,"comment_content":"å°ç»“ä¸Šé¢ä¸€å¥ï¼šä¹‹å‰çš„é‚£ä¸ªæŒ‚èµ·çš„ M å°†å†æ¬¡è¿›å…¥æŒ‚èµ·çŠ¶æ€ã€‚   æœ€åæ˜¯ä¸æ˜¯è¿è¡ŒçŠ¶æ€å§ï¼Ÿ","like_count":1,"discussions":[{"author":{"id":1026224,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/a8/b0/6f87ab08.jpg","nickname":"Tony Bai","note":"","ucode":"B6B08985F6FA89","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":549062,"discussion_content":"æˆ‘è§‰å¾—è¿™ä¸ªä¾‹å­è¾“å‡ºé¡ºåºä¸ç”¨æ·±ç©¶ï¼Œåœ¨æˆ‘çš„macå’Œlinuxä¸Šï¼Œä½ çš„ç¬¬äºŒä¸ªç¨‹åºè¾“å‡º2 3 0 1ã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1643537764,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":392064,"user_name":"stronger","can_delete":false,"product_type":"c1","uid":2027792,"ip_address":"å¹¿ä¸œ","ucode":"539BE06C45F54A","user_header":"https://static001.geekbang.org/account/avatar/00/1e/f1/10/cdb35cd1.jpg","comment_is_top":false,"comment_ctime":1719847756,"is_pvip":false,"replies":[{"id":142523,"content":"Gæ‰€ç»‘å®šçš„Mä¼šè¿›å…¥å†…æ ¸æ€ã€‚","user_name":"ä½œè€…å›å¤","user_name_real":"ç¼–è¾‘","uid":1026224,"ctime":1719928498,"ip_address":"è¾½å®","comment_id":392064,"utype":1}],"discussion_count":1,"race_medal":0,"score":4,"product_id":100093501,"comment_content":"goroutineåœ¨è¿›è¡Œç³»ç»Ÿè°ƒç”¨çš„æ—¶å€™ï¼Œä¼šåœ¨å†…æ ¸æ€è¿è¡Œå—ï¼Ÿ","like_count":0,"discussions":[{"author":{"id":1026224,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/a8/b0/6f87ab08.jpg","nickname":"Tony Bai","note":"","ucode":"B6B08985F6FA89","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":545164,"discussion_content":"æ–‡é‡Œæœ‰è¯´ï¼Œæ˜¯åœ¨ç³»ç»Ÿè°ƒç”¨è¿”å›åï¼Œæ‰¾ä¸åˆ°idleçš„Pçš„æƒ…å†µä¸‹ï¼Œmä¼šè¿›å…¥åˆ°idle mæ± ä¸­æŒ‚èµ·ã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1641868922,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":391104,"user_name":"Geek_73c432","can_delete":false,"product_type":"c1","uid":2869118,"ip_address":"å¹¿ä¸œ","ucode":"3E11EB02B14DE0","user_header":"","comment_is_top":false,"comment_ctime":1717332111,"is_pvip":false,"replies":[{"id":142278,"content":"åä½œå¼å¯ä»¥ç†è§£ä¸ºåŒæ–¹éµå®ˆå…±åŒçº¦å®šï¼Œæ¯”å¦‚ç”¨10mså°±æŠŠpè®©å‡ºæ¥ã€‚éåä½œå¼ï¼Œä¹Ÿå¯ä»¥ç†è§£ä¸ºæŠ¢å å¼ï¼Œå³runtimeå±‚é¢ä¼šåœ¨ç‰¹å®šæ¡ä»¶ä¸‹æŠŠä½ ä½¿ç”¨pçš„æƒåŠ›å‰¥å¤ºäº†ï¼Œç»™å…¶ä»–gï¼Œä¸ç®¡æ˜¯æ˜¯å¦è¿˜è¦ç»§ç»­ç”¨è¿™ä¸ªpã€‚","user_name":"ä½œè€…å›å¤","user_name_real":"ç¼–è¾‘","uid":1026224,"ctime":1717656000,"ip_address":"åŒ—äº¬","comment_id":391104,"utype":1}],"discussion_count":1,"race_medal":0,"score":4,"product_id":100093501,"comment_content":"è€å¸ˆï¼Œæ€ä¹ˆç†è§£\nåŸºäºåä½œçš„â€œæŠ¢å å¼â€è°ƒåº¦\néåä½œçš„æŠ¢å å¼è°ƒåº¦\nè¿™ä¸¤ä¸ªè¡¨è¾¾ï¼Ÿ\n\nä¸ªäººè®¤ä¸ºï¼Œåœ¨è°ƒåº¦ç­–ç•¥ä¸­ï¼Œ &quot;åä½œå¼&quot; å’Œ &quot;æŠ¢å å¼&quot; æ˜¯ä¸¤ç§æˆªç„¶ä¸åŒçš„ç­–ç•¥ã€‚ä»æ–‡ä¸­æ²¡çœ‹å‡ºæ¥å“ªé‡Œä½“ç°äº†â€åä½œâ€œå•Š","like_count":0,"discussions":[{"author":{"id":1026224,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/a8/b0/6f87ab08.jpg","nickname":"Tony Bai","note":"","ucode":"B6B08985F6FA89","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":647364,"discussion_content":"Gæ‰€ç»‘å®šçš„Mä¼šè¿›å…¥å†…æ ¸æ€ã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1719928498,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"è¾½å®","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2,\"source\":0}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":330827,"user_name":"Calvin","can_delete":false,"product_type":"c1","uid":1603004,"ip_address":"","ucode":"0EEF5B207623B5","user_header":"https://static001.geekbang.org/account/avatar/00/18/75/bc/89d88775.jpg","comment_is_top":false,"comment_ctime":1642184982,"is_pvip":false,"replies":[{"id":121590,"content":"æˆ‘æ²¡çœ‹åˆ°ä½ çš„ç­”æ¡ˆä¸Geek_cca544 åŒå­¦çš„ç»“è®ºæœ‰å•¥ä¸ä¸€æ ·å•Šã€‚ä½ çš„go1.17.6 windows&#47;amd64 ç‰ˆæœ¬æµ‹è¯•ç»“æœæœ‰å•¥ä¸ä¸€æ ·ä¹ˆï¼Ÿ","user_name":"ä½œè€…å›å¤","user_name_real":"ç¼–è¾‘","uid":1026224,"ctime":1643522513,"ip_address":"","comment_id":330827,"utype":1}],"discussion_count":2,"race_medal":0,"score":4,"product_id":100093501,"comment_content":"æ€è€ƒé¢˜ï¼š\n1ã€å¯ä»¥å®šæ—¶ 1 ç§’é—´éš”åœ°ä¸æ–­çœ‹åˆ°â€œI got scheduled!â€è¾“å‡ºï¼›\n2ã€main å‡½æ•°ä¸­ï¼Œgo deadloop() è¯­å¥å‰æ·»åŠ  runtime.GOMAXPROCS(1)ï¼Œå³å¯ä½¿ main goroutine åœ¨åˆ›å»º deadloop goroutine ä¹‹åæ— æ³•ç»§ç»­å¾—åˆ°è°ƒåº¦ã€‚\n\nPSï¼šåŸºäº go1.17.6 windows&#47;amd64 ç‰ˆæœ¬æµ‹è¯•ï¼Œæˆ‘è¿™æµ‹è¯•ç»“æœä¸ç•™è¨€ä¸­ Geek_cca544 åŒå­¦çš„ç»“è®ºä¸ä¸€æ ·ï¼Œè¯·é—®è€å¸ˆé—®é¢˜ 2 å“ªä¸ªç­”æ¡ˆæ˜¯å¯¹çš„å‘¢ï¼Ÿ","like_count":0,"discussions":[{"author":{"id":1026224,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/a8/b0/6f87ab08.jpg","nickname":"Tony Bai","note":"","ucode":"B6B08985F6FA89","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":549032,"discussion_content":"æˆ‘æ²¡çœ‹åˆ°ä½ çš„ç­”æ¡ˆä¸Geek_cca544 åŒå­¦çš„ç»“è®ºæœ‰å•¥ä¸ä¸€æ ·å•Šã€‚ä½ çš„go1.17.6 windows/amd64 ç‰ˆæœ¬æµ‹è¯•ç»“æœæœ‰å•¥ä¸ä¸€æ ·ä¹ˆï¼Ÿ","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1643522513,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1603004,"avatar":"https://static001.geekbang.org/account/avatar/00/18/75/bc/89d88775.jpg","nickname":"Calvin","note":"","ucode":"0EEF5B207623B5","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":547498,"discussion_content":"åŸºäºæ€è€ƒé¢˜ 2 ä¸­ä¸Šé¢æˆ‘è‡ªå·±æå‡ºçš„é—®é¢˜ï¼Œæˆ‘è‡ªå·±çˆ¬æœç´¢å¼•æ“æ‰¾åˆ°åŸå› äº†ï¼šè¿™æ˜¯å› ä¸º deadloop å‡½æ•°å†…éƒ¨é€»è¾‘æ²¡æœ‰ç»™è°ƒåº¦å™¨ä»»ä½•æŠ¢å çš„æœºä¼šï¼ˆç©ºå¾ªç¯ä½“ï¼Œæ— ä»»ä½•ç³»ç»Ÿè°ƒç”¨ï¼‰ï¼\n\nä»¥ä¸‹è¿™ä¸ªä»£ç åº”è¯¥æ¯”è¾ƒå®¹æ˜“çœ‹åˆ° 0 å’Œ 1 çš„äº¤æ›¿æ‰“å°ï¼ˆå·²ç»è®¾ç½®äº† GOMAXPROCS = 1ï¼‰ï¼š\nfunc deadLoop() {\n\tfor {\n\t\tfmt.Print(0)\n\t}\n}\nfunc TestDeadLoop(t *testing.T) {\n\t// GOMAXPROCSï¼šè¡¨ç¤º Go è°ƒåº¦å™¨å¯è§çš„â€œå¤„ç†å™¨â€çš„æœ€å¤§æ•°é‡\n\truntime.GOMAXPROCS(1)\n\tgo deadLoop()\n\tfor {\n\t\tfmt.Print(1)\n\t}\n}\n\nç™½è€å¸ˆçš„æœ¬ç¯‡æ–‡ç« ä¸­å…¶å®ä¹Ÿæœ‰æåˆ°ï¼šâ€œæ­»å¾ªç¯ç­‰å¹¶æ²¡æœ‰ç»™ç¼–è¯‘å™¨æ’å…¥æŠ¢å ä»£ç  (runtime.morestack_noctxt) çš„æœºä¼šï¼Œè¿™å°±ä¼šå¯¼è‡´ GC åœ¨ç­‰å¾…æ‰€æœ‰ Goroutine åœæ­¢æ—¶çš„ç­‰å¾…æ—¶é—´è¿‡é•¿ï¼Œä»è€Œå¯¼è‡´ GC å»¶è¿Ÿï¼Œå†…å­˜å ç”¨ç¬é—´å†²é«˜ï¼›ç”šè‡³åœ¨ä¸€äº›ç‰¹æ®Šæƒ…å†µä¸‹ï¼Œå¯¼è‡´åœ¨ STWï¼ˆstop the worldï¼‰æ—¶æ­»é”ã€‚ä¸ºäº†è§£å†³è¿™äº›é—®é¢˜ï¼ŒGo åœ¨ 1.14 ç‰ˆæœ¬ä¸­æ¥å—äº†å¥¥æ–¯æ±€ - å…‹è±é—¨èŒ¨ï¼ˆAustin Clementsï¼‰çš„ææ¡ˆï¼Œå¢åŠ äº†å¯¹éåä½œçš„æŠ¢å å¼è°ƒåº¦çš„æ”¯æŒï¼Œè¿™ç§æŠ¢å å¼è°ƒåº¦æ˜¯åŸºäºç³»ç»Ÿä¿¡å·çš„ï¼Œä¹Ÿå°±æ˜¯é€šè¿‡å‘çº¿ç¨‹å‘é€ä¿¡å·çš„æ–¹å¼æ¥æŠ¢å æ­£åœ¨è¿è¡Œçš„ Goroutineã€‚â€\n\nPSï¼šæ‰¾ç­”æ¡ˆçš„è¿‡ç¨‹ä¸­ï¼Œè¿˜çˆ¬åˆ°ç™½è€å¸ˆåœ¨ 2017 å¹´å†™è¿‡çš„ä¸€ç¯‡æ–‡ç« ï¼Œå…¶ä¸­æœ‰åˆ†æè¿™ä¸ªé—®é¢˜ï¼Œé‡Œé¢ç¬¬ä¸€ä¸ªç¤ºä¾‹ä»£ç è·Ÿæœ¬ç¯‡æ–‡ç« ä¸­çš„ä¸€æ¨¡ä¸€æ ·ï¼Œå¯ä»¥çœ‹çœ‹å¯¹æ¯”å­¦ä¹ ä¸€ä¸‹ï¼Œæ–‡ç« åœ°å€ï¼šhttps://tonybai.com/2017/11/23/the-simple-analysis-of-goroutine-schedule-examples/","likes_number":2,"is_delete":false,"is_hidden":false,"ctime":1642704115,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":392065,"user_name":"stronger","can_delete":false,"product_type":"c1","uid":2027792,"ip_address":"å¹¿ä¸œ","ucode":"539BE06C45F54A","user_header":"https://static001.geekbang.org/account/avatar/00/1e/f1/10/cdb35cd1.jpg","comment_is_top":false,"comment_ctime":1719847807,"is_pvip":false,"replies":null,"discussion_count":0,"race_medal":0,"score":4,"product_id":100093501,"comment_content":"ç³»ç»Ÿè°ƒç”¨ä¸‹çš„è°ƒåº¦ï¼Œgorountine ä¼šè¿è¡Œåœ¨å†…æ ¸æ€å—ï¼Ÿ","like_count":0},{"had_liked":false,"id":391349,"user_name":"äººè¨€æœ‰åŠ›","can_delete":false,"product_type":"c1","uid":1690736,"ip_address":"æµ™æ±Ÿ","ucode":"3708FBBFB641FE","user_header":"https://static001.geekbang.org/account/avatar/00/19/cc/70/64045bc0.jpg","comment_is_top":false,"comment_ctime":1718071524,"is_pvip":false,"replies":null,"discussion_count":0,"race_medal":0,"score":4,"product_id":100093501,"comment_content":"æœ¬èŠ‚è®²è¿°äº†goè¯­è¨€å¹¶å‘è°ƒåº¦å™¨çš„åŸºæœ¬åŸç†ï¼Œä»G-Måˆ°G-P-Mæ¨¡å‹ï¼Œä»éæŠ¢å å¼åˆ°åä½œæŠ¢å åˆ°ä¿¡å·æŠ¢å çš„æ¼”è¿›ã€‚æˆ‘ä»¬ç°åœ¨ç”¨åˆ°çš„è¿˜æ˜¯G-P-Mæ¨¡å‹ï¼Œå…¶ä¸­Gæ˜¯goroutineä¿å­˜è°ƒç”¨æ ˆï¼ŒPæ˜¯é€»è¾‘å¤„ç†å™¨ï¼Œä¿å­˜ä¸€ä¸ªGçš„è¿è¡Œé˜Ÿåˆ—ï¼Œæ•°é‡ç”±GOMAXPROCSæ§åˆ¶ï¼Œè€ŒMæ˜¯çœŸå®è°ƒåº¦å™¨ï¼Œå’Œç³»ç»Ÿçº¿ç¨‹ç»‘å®šã€‚\nè°ƒåº¦è¿‡ç¨‹å°±æ˜¯å¯åŠ¨goroutineåä¼šç»‘å®šä¸€ä¸ªPé˜Ÿåˆ—ï¼ŒPé˜Ÿåˆ—å’ŒMè°ƒåº¦å™¨ç»‘å®šè¿›è¡ŒCPUæ‰§è¡Œã€‚\næŠ¢å è¿‡ç¨‹å°±æ˜¯ä¼šæœ‰ä¸€ä¸ªä¸“é—¨çš„G0ä½œä¸ºè°ƒåº¦Gï¼Œå¸¸è§„æƒ…å†µå°±æ˜¯æ‰§è¡Œå„è‡ªæ—¶é—´ç‰‡ä¹‹åï¼Œå¸¸è§„çš„Gä¼šè¢«è®¾ç½®ä¸ºå¯æŠ¢å ï¼Œä¸‹ä¸ªè°ƒåº¦è¢«ç§»é™¤é˜Ÿåˆ—é‡æ–°å…¥é˜Ÿï¼›IOæƒ…å†µä¸‹Gä¼šè¿›å…¥ç­‰å¾…ï¼Œè€ŒMä¼šå’Œè¿è¡ŒPçš„ä¸‹ä¸ªGï¼›å¦‚æœæ˜¯ç³»ç»Ÿè°ƒç”¨ï¼Œåˆ™Må’ŒGéƒ½ä¼šé˜»å¡ï¼Œç„¶åPä¼šå°è¯•ç»‘å®šç©ºé—²Mæˆ–æ–°å»ºMï¼Œå¯¼è‡´çº¿ç¨‹æ•°å¢åŠ ï¼Œéœ€è¦æ³¨æ„ã€‚\n\næ€è€ƒé¢˜ï¼šç”±äºæ˜¯å¤šæ ¸ï¼Œæ˜¯å¯ä»¥è¢«è°ƒåº¦çš„ï¼Œé™¤éGOMAXPROCS=1","like_count":0},{"had_liked":false,"id":358761,"user_name":"piboye","can_delete":false,"product_type":"c1","uid":1066752,"ip_address":"æ±Ÿè¥¿","ucode":"7CFD8712857A85","user_header":"https://static001.geekbang.org/account/avatar/00/10/47/00/3202bdf0.jpg","comment_is_top":false,"comment_ctime":1664704646,"is_pvip":true,"replies":null,"discussion_count":0,"race_medal":0,"score":4,"product_id":100093501,"comment_content":"gpmæ¨¡å‹è¿˜æ˜¯æœ‰æ€§èƒ½é—®é¢˜å§ï¼Ÿ måº”è¯¥è¦å°½é‡ç»‘æ ¸ï¼Œé˜»å¡è°ƒç”¨ï¼Œåº”è¯¥ç”¨å…¶å®ƒçº¿ç¨‹å»å¤„ç†ï¼Œå°½é‡ä¸è¦å ç”¨å½“å‰mã€‚","like_count":0}]}