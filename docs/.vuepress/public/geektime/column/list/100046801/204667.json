{"id":204667,"title":"课前加餐 | 电商系统是如何设计的？","content":"<p>你好，我是李玥。</p><p>在这个系列课程中，我们会讲电商这个行业在多年系统建设和运维过程中，总结出来的使用分布式存储系统的一些最佳实践。也会以电商系统作为例子来讲解存储相关的技术知识和问题。这都需要你对电商的业务逻辑、系统架构、核心业务流程有一个基本的认知。</p><p>虽然说，电商这个业务和你的生活息息相关，你可能对电商多少有一些了解，但是，即使是一个最小化的电商系统，它仍然非常复杂。所以，我们先花一节课的时间，一起以一个创业公司的CTO的视角，设计一个最小化的电商系统，在这个过程中帮你理清楚电商系统的架构。</p><p>这样，我们在学习后续课程的时候，就不再解释电商的业务和系统了，直接来讲具体的技术问题。</p><p>我们的故事从一个电话开始。某一天，一个曾经认识但并不太熟悉的老板突然来了一个电话：</p><p>“我有一个改变世界的想法，就差一个程序员了！你来吧！”</p><p>新公司很快就成立了，你成了新公司的CTO。关于要如何改变世界，目前唯一能确定的是，老板要做一个电商系统。具体做成什么样，还不清楚。你需要和老板讨论需求。</p><p>你：“咱们要做的业务模式是C2C、B2C还是B2B呢？”</p><p>老板：“什么B？什么C？我不懂你们那些技术的东西。”</p><p>你：“这么说吧，你要山寨，啊不对，做一个某宝网，还是某东网，还是某848网呢？”</p><!-- [[[read_end]]] --><p>老板：“不都是一样的么？有什么区别？你赶紧做一个出来我看看不就知道了？！”</p><p>有没有感觉似曾相识？作为研发谁没碰到过几个啥也不懂的需求方不是？那这种情况下，你怎么办呢？</p><p><strong>在需求还不太明确的情况下，比较可行的方式就是，先把那些不太会变化的核心系统搭建出来，尽量简单地实现出一个最小化的系统，然后再逐步迭代完善。</strong></p><h2>电商系统的核心流程是什么样的？</h2><p>接下来我带你一起来设计这个电商的核心系统。</p><p>遵照软件工程的一般规律，我们先从需求阶段开始。如何来做需求分析？理想情况下，应该由系统分析师或者是产品经理来承担这个任务。但现实很骨感，绝大多数情况下，你得到的所谓的“需求”，就是一两句话。需求分析的工作实际上就落在了开发者身上。</p><p>很多项目交付以后，还要改来改去，用户不满意，开发者很痛苦，其实就是缺失了需求分析这个步骤。所以，为了自己，每一个开发者都应该掌握一点需求分析的方法。</p><p>开发者怎么来做需求分析？这里面我们不讲那些做需求分析的方法和理论，只告诉你最重要、最关键的一个点。</p><p>不要一上来就设计功能，而是先要回答下面这两个问题：</p><ol>\n<li>这个系统（或者是功能）是给哪些人用的？</li>\n<li>这些人使用这个系统来解决什么问题？</li>\n</ol><p>这两个问题的答案，我把它们称为业务需求。在我们将要设计的这个电商系统中，它的业务需求是什么？电商的业务，每个人都熟悉，很容易回答这两个问题。</p><p>第一个问题，电商系统给哪些人用？</p><p>首先得有买东西的人，我们叫“用户”，还得有卖东西的人？我们叫“运营人员”。还有什么人会用这个系统？老板啊！你记住，你在设计任何一个系统的时候，千万不要把老板或者是领导给忘了，他们是给你钱的人，他们的意见非常重要！</p><p>然后我们一起回答第二个问题：用户、运营和老板，分别用电商系统来干什么？</p><p>这个问题也很容易回答，用户用系统来买东西，运营用系统来卖东西，老板需要在系统中看到他赚了多少钱。这两个问题的答案，或者说是业务需求，稍加细化后，可以用下面这个图来清晰的表述：</p><p><img src=\"https://static001.geekbang.org/resource/image/c7/bc/c75357b43ec89aebd88fbc2a3efcd1bc.jpg?wh=935*463\" alt=\"\"></p><p>这个图在UML（统一建模语言）中称为用例图（Use Case），是需求分析的时候你需要画的第一张图。它回答的就是，业务需求中的那两个关键的问题，这个系统给谁用？他们用这个系统解决什么问题？</p><p>一般来说，业务需求和我们要设计的系统关系不大。为什么这么说呢？你可以看一下上面这个图里面的用例，放在传统的商业企业里面，比如一个小杂货铺、一个线下实体商场商店或者一个做电视购物的公司，是不是也是适用的？所以做业务需求的主要目的，是理清楚业务场景是什么样的。</p><p>然后我们来分析电商系统的流程。显然，一个电商系统最主要的业务流程，一定是购物这个流程。你应该很容易就能把这个流程分析出来，它的流程图是这样的：</p><p><img src=\"https://static001.geekbang.org/resource/image/bd/cf/bd778c67b3971e16d3cdbd9fae800dcf.jpg?wh=1242*361\" alt=\"\"></p><p>所有的电商几乎都是这样一个流程，我和你一起来看一下这个流程。</p><p>流程从用户选购商品开始，用户先从你的App中浏览商品；找到心仪的商品之后，把商品添加到购物车里面；都选好了之后，打开购物车，下一个订单；下单结算之后，就可以支付了；支付成功后，运营人员接下来会给每个已经支付的订单发货；邮寄商品给用户之后，用户确认收货，到这里一个完整的购物流程就结束了。</p><h2>如何根据流程来划分功能模块？</h2><p>接下来，我们把这个业务流程再细化，看一下电商系统如何来实现这个流程？我把细化之后的流程，绘制成了下面这个时序图（Sequence Diagram）：</p><p><img src=\"https://static001.geekbang.org/resource/image/f5/ea/f5f3d89c31770591c5d59591a3390eea.jpg?wh=1373*736\" alt=\"\"></p><p>我们一起看下这个时序图中的每个步骤。</p><ol>\n<li>用户开始浏览商品，需要有一个<strong>商品模块</strong>来支撑，给用户展示商品的介绍、价格等等这些信息。</li>\n<li>用户把选好的商品加入购物车，这个步骤，也需要一个<strong>购物车模块</strong>来维护用户购物车中的商品。</li>\n<li>用户下单肯定需要一个<strong>订单模块</strong>来创建这个新订单。订单创建好了之后，需要把订单中的商品从购物车中删除掉。</li>\n<li>订单创建完成后，需要引导用户付款，也就是发起支付流程，这里需要有一个<strong>支付模块</strong>来实现支付功能，用户成功完成支付之后，需要把订单的状态变更为“已支付”。</li>\n<li>之后运营人员就可以发货了，在系统中，发货这个步骤，需要扣减对应商品的库存数量，这个功能需要<strong>库存模块</strong>来实现，发货完成后，还需要把订单状态变更为“已发货”。</li>\n<li>最后，用户收货之后，在系统中确认收货，系统把订单状态变更为“已收货”，流程结束。</li>\n</ol><p>这个流程涉及到的功能模块有：<strong>商品、购物车、订单、支付和库存，</strong>这几个模块就是一个电商系统中的核心功能模块。</p><p>当然，仅仅有这几个模块还是不够的，因为我们只分析了“购物”这个最主要的流程，并没有完全涵盖业务需求中的全部用例，比如：运营人员进货、老板查看报表这些用例还没有覆盖到。</p><p>相比购物这个流程，剩下的几个用例和流程都没那么复杂，用同样的方法就可以把其他功能模块分析出来。在这里我们就省略分析过程，直接给出我们电商系统的功能模块划分：</p><p><img src=\"https://static001.geekbang.org/resource/image/0b/54/0b37cfadd0e181cd9648efc9e9924354.jpg?wh=1176*400\" alt=\"\"></p><p>上面这个图，我使用的是UML中的包图(Package Diagram)来表示。整个系统按照功能，划分为十个模块，除了购物流程中涉及到的：商品、订单、购物车、支付、库存五个模块以外，还补充了促销、用户、账户、搜索推荐和报表这几个模块，这些都是构建一个电商系统必不可少的功能。我们一个一个来说每个模块需要实现的功能。</p><ul>\n<li>商品：维护和展示商品信息和价格。</li>\n<li>订单：维护订单信息和订单状态，计算订单金额。</li>\n<li>购物车：维护用户购物车中的商品。</li>\n<li>支付：负责与系统内外部的支付渠道对接，实现支付功能。</li>\n<li>库存：维护商品的库存数量和库存信息。</li>\n<li>促销：制定促销规则，计算促销优惠。</li>\n<li>用户：维护系统的用户信息，注意用户模块它是一个业务模块，一般不负责用户登录和认证，这是两个完全不同的功能。</li>\n<li>账户：负责维护用户的账户余额。</li>\n<li>搜索推荐：负责商城中，搜索商品和各种列表页和促销页的组织和展示，简单的说就是决定让用户优先看到哪些商品。</li>\n<li>报表：实现统计和分析功能，生成报表，给老板来做经营分析和决策使用。</li>\n</ul><p>这里面需要特别说一下促销模块，它是电商系统中，最复杂的一个模块。各种优惠券、满减、返现等等这些促销规则，每个都非常复杂，再加上这些规则叠加计算，常常是复杂到连制定促销规则的人都搞不清楚。</p><p>所以每个电商公司无一例外都爆出过，因为促销规则制定失误，而产生非常便宜的“羊毛单”，让精明的消费者薅了“羊毛”。不过五花八门的促销是提升销售最有效的手段，肯定不能因噎废食。</p><p>作为系统设计者，我们需要把促销的变化和复杂性封禁在促销模块内部，不能让一个促销模块把整个电商系统都搞得非常复杂，否则就很难去设计和实现。</p><p>可行的做法是，把促销模块与其他模块的接口设计的相对简单和固定，这样系统的其他模块就不会因为新的促销玩儿法而改变。</p><p>在创建订单时，订单模块把商品和价格信息传给促销模块，促销模块返回一个可以使用的促销列表，用户选择好促销和优惠，订单模块把商品、价格、促销优惠这些信息，再次传给促销模块，促销模块则返回促销价格。</p><p>最终生成的订单中，只记录订单使用了哪几种促销，以及最终的促销价就可以了。这样，不管促销这个模块的玩儿法怎么变化，订单和其他模块的业务逻辑不需要随之改变。</p><p>至此，我们就完成了一个电商系统的概要设计，你应该对电商系统也有了一个初步的了解。</p><h2>小结</h2><p>我们每节课的正文结束之后，都会安排一个小结，对课程的重点内容做一个总结。</p><p>今天我们再来回顾一下，一个电商系统的设计中，最核心的几个关键点。</p><p>首先，系统的角色是：用户、运营人员和老板。这三个角色对电商系统的需求是：用户使用系统来购物，运营人员负责销售商品，老板关注系统中经营数据。电商系统最核心的流程就是用户购物的流程，流程从用户浏览选购商品开始，加购、下单、支付、运营人员发货、用户确认收货，至此流程结束。</p><p>细化这个流程之后，我们可以分析出，支撑这个流程几个核心的功能模块：商品、订单、购物车、支付和库存。此外，还需要促销、用户、账户、搜索推荐和报表这些必备的功能模块支撑，才能构成一个完整的电商系统。</p><p>我还和你分享了作为一个开发者，你在做需求分析的时候，需要把握的一个要点：不要一上来就设计功能，而是要先理清业务需求，也就是这节课反复强调的两个问题：这个系统是给哪些人用的？他们分别用这个系统来解决什么问题？这样可以确保你做出来的系统，大体上不会偏离用户的预期。</p><p>最后，在讲解系统功能模块划分的时候，我们说了一个有效减少系统复杂度的设计经验。那就是，如果系统业务是复杂而多变的，尽量识别出这部分复杂业务的边界，将复杂封禁在一个模块的内部，避免这种复杂度扩散到整个系统中去。</p><p>这节课是我们专栏的课前加餐，目的是为了让你了解电商的组成模块。在后续的课程中，我将和你一起经历这个电商系统在从小到大的发展过程中遇到的存储技术问题，并一起解决它。</p><h2>思考题</h2><p>做完了概要设计，就可以来做技术选型了。作为公司的CTO，课后请你思考一下，这个电商系统的技术选型应该是什么样的？</p><ul>\n<li>使用什么编程语言和技术栈？</li>\n<li>需要哪些第三方的框架和云服务？</li>\n<li>我们最关心的存储系统该怎么选型？</li>\n</ul><p>欢迎你在留言区与我讨论，如果你觉得今天的内容对你有帮助，也欢迎把它分享给你的朋友。</p>","neighbors":{"left":{"article_title":"开篇词 | 从今天起，换种方式学存储","id":204665},"right":{"article_title":"01 | 创建和更新订单时，如何保证数据准确无误？","id":204673}},"comments":[{"had_liked":false,"id":182459,"user_name":"木云先森","can_delete":false,"product_type":"c1","uid":1450899,"ip_address":"","ucode":"B321F8014CD4DB","user_header":"https://static001.geekbang.org/account/avatar/00/16/23/93/dc0bbf78.jpg","comment_is_top":false,"comment_ctime":1582791395,"is_pvip":false,"replies":[{"id":"70645","content":"一看就是真正做过电商的同学👍","user_name":"作者回复","user_name_real":"李玥","uid":"1501046","ctime":1582801906,"ip_address":"","comment_id":182459,"utype":1}],"discussion_count":6,"race_medal":0,"score":"237805992675","product_id":100046801,"comment_content":"针对促销的话，还有一个点在实际运营的电商系统中，也需要经常考虑到。订单中要存储每个商品所均分的促销价。<br>比如A商品100元   B商品100元<br>用户买了一件A+一件B   激发了一个促销满200减10元<br>买个商品均摊5元<br>核心也是为了再做单件售后的时候，计算出首先对应的金额","like_count":56,"discussions":[{"author":{"id":1501046,"avatar":"https://static001.geekbang.org/account/avatar/00/16/e7/76/79c1f23a.jpg","nickname":"李玥","note":"","ucode":"B19E91EE248591","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":485345,"discussion_content":"一看就是真正做过电商的同学👍","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1582801906,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1024164,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/a0/a4/b060c723.jpg","nickname":"阿斯蒂芬","note":"","ucode":"61D5E3BDA4EBC5","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":217270,"discussion_content":"也可能是我这种促销后发生了退款行为的同学，手动狗头\n虽然我没做电商，但研究了退款价格，就知道肯定有记录「均分促销价」\n感谢科普这个专业名词","likes_number":2,"is_delete":false,"is_hidden":false,"ctime":1585535537,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1364987,"avatar":"https://static001.geekbang.org/account/avatar/00/14/d3/fb/fca51bc2.jpg","nickname":"PUG","note":"","ucode":"65B0DE7CABE0B2","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":377391,"discussion_content":"促销分摊：加权平均","likes_number":1,"is_delete":false,"is_hidden":false,"ctime":1622626497,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1635388,"avatar":"https://static001.geekbang.org/account/avatar/00/18/f4/3c/60bf7a17.jpg","nickname":"快乐的平头哥","note":"","ucode":"D7D2FA5DA6D8BF","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":292415,"discussion_content":"还要考虑退款流程 尤其是满减凑单的那些用户","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1595219435,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":1,"child_discussions":[{"author":{"id":1450899,"avatar":"https://static001.geekbang.org/account/avatar/00/16/23/93/dc0bbf78.jpg","nickname":"木云先森","note":"","ucode":"B321F8014CD4DB","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":1635388,"avatar":"https://static001.geekbang.org/account/avatar/00/18/f4/3c/60bf7a17.jpg","nickname":"快乐的平头哥","note":"","ucode":"D7D2FA5DA6D8BF","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":293167,"discussion_content":"退款只是我上面说的售后的一部分。售后的流程很长，先关于货物，后关于钱。实际业务比这复杂。有可能客户把东西弄的有点破损，不能退完所有的钱","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1595467514,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":292415,"ip_address":""},"score":293167,"extra":""}]},{"author":{"id":1306032,"avatar":"http://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTJcxSpNMqwqyicMvdOSr9ic0p1ABiauHnv7g7YQVSJuoHPoQbYDu3YzdpgmSAk2KricUBQ5yibWBWIq75w/132","nickname":"桂城老托尼","note":"","ucode":"139E4B8EE88B79","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":210984,"discussion_content":"细节，点赞","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1584796765,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":184431,"user_name":"靠人品去赢","can_delete":false,"product_type":"c1","uid":1301286,"ip_address":"","ucode":"7A20F9EBE847E1","user_header":"https://static001.geekbang.org/account/avatar/00/13/db/26/54f2c164.jpg","comment_is_top":false,"comment_ctime":1583313766,"is_pvip":false,"replies":[{"id":"71368","content":"还是我文中讲到的，促销优惠的复杂度都封禁在促销模块里面，让保持促销对外的接口简单。<br><br>像你这种情况，促销需要提供几个服务：<br><br>一是哪些促销可用：输入是一堆商品和用户ID，促销服务返回可用的促销：比如满减、优惠券之类的。<br><br>一个“算价”服务，输入是：一堆商品和使用的一堆促销，促销服务需要验证这些促销是否都可以使用，有没有冲突之类的，如果可用，返回的是计算完成的促销价。<br><br>这个促销价不仅包括使用促销之后的总价，还要包含每个商品的“实际优惠价（不显示给用户）”，保证：促销后的总价=Σ所有商品的实际优惠价。这个价格就是用完促销之后，每个商品的实际价格，后续退货、计算成本收益，都以这个价格为准。<br><br>这样对于购物车和订单来说，处理就比较简单了，不管你促销怎么玩儿，反正最终你告诉我用完促销之后每个商品什么价格就可以了。促销规则变来变去也不用去改订单服务。<br>","user_name":"作者回复","user_name_real":"李玥","uid":"1501046","ctime":1583373552,"ip_address":"","comment_id":184431,"utype":1}],"discussion_count":7,"race_medal":0,"score":"186266907494","product_id":100046801,"comment_content":"老师，总算讲到电商系统。我们小公司设计是这样，就是老板这个角色就是超级用户或者是你说的超级运营，除了查看报表什么的，还有其他上货的功能也有。<br>我觉得困惑的是，购物车这个一次性几个商品，是一个订单还是几个商品一个订单，中间掺杂拼单优惠这些怎么搞，主要问题是客户买完了，突然说这个我不要了，或者要退货退钱。<br>我们该怎么设计订单，关于购物车订单，一次好多个商品，还有就是带来的优惠折扣怎么搞，按照产品的想法这个要这样，那个要这样，感觉在给自己埋坑啊。","like_count":44,"discussions":[{"author":{"id":1501046,"avatar":"https://static001.geekbang.org/account/avatar/00/16/e7/76/79c1f23a.jpg","nickname":"李玥","note":"","ucode":"B19E91EE248591","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":486011,"discussion_content":"还是我文中讲到的，促销优惠的复杂度都封禁在促销模块里面，让保持促销对外的接口简单。\n\n像你这种情况，促销需要提供几个服务：\n\n一是哪些促销可用：输入是一堆商品和用户ID，促销服务返回可用的促销：比如满减、优惠券之类的。\n\n一个“算价”服务，输入是：一堆商品和使用的一堆促销，促销服务需要验证这些促销是否都可以使用，有没有冲突之类的，如果可用，返回的是计算完成的促销价。\n\n这个促销价不仅包括使用促销之后的总价，还要包含每个商品的“实际优惠价（不显示给用户）”，保证：促销后的总价=Σ所有商品的实际优惠价。这个价格就是用完促销之后，每个商品的实际价格，后续退货、计算成本收益，都以这个价格为准。\n\n这样对于购物车和订单来说，处理就比较简单了，不管你促销怎么玩儿，反正最终你告诉我用完促销之后每个商品什么价格就可以了。促销规则变来变去也不用去改订单服务。\n","likes_number":2,"is_delete":false,"is_hidden":false,"ctime":1583373552,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1958580,"avatar":"","nickname":"安普尚","note":"","ucode":"B587954A1722DA","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":229618,"discussion_content":"如果按照商家进行拆单，生成订单的时候就会提前把单个商品促销后的价格计算出来，既然商品单独退款，也是退款优惠券优惠后的价格","likes_number":1,"is_delete":false,"is_hidden":false,"ctime":1586674333,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":1,"child_discussions":[{"author":{"id":2297346,"avatar":"https://static001.geekbang.org/account/avatar/00/23/0e/02/41099234.jpg","nickname":"Django...","note":"","ucode":"56693F8A886FF0","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":1958580,"avatar":"","nickname":"安普尚","note":"","ucode":"B587954A1722DA","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":366916,"discussion_content":"淘宝多件商品优惠满减下单，单件商品退款就是按照这样算出单件优惠后价格来的","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1618217542,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":229618,"ip_address":""},"score":366916,"extra":""}]},{"author":{"id":1115149,"avatar":"https://static001.geekbang.org/account/avatar/00/11/04/0d/3dc5683a.jpg","nickname":"柯察金","note":"","ucode":"F722BF8FCD2C47","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":334683,"discussion_content":"那这样是不是订单也要存储原价，跟优惠价信息啊","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1607935482,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":1,"child_discussions":[{"author":{"id":2297346,"avatar":"https://static001.geekbang.org/account/avatar/00/23/0e/02/41099234.jpg","nickname":"Django...","note":"","ucode":"56693F8A886FF0","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":1115149,"avatar":"https://static001.geekbang.org/account/avatar/00/11/04/0d/3dc5683a.jpg","nickname":"柯察金","note":"","ucode":"F722BF8FCD2C47","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":366915,"discussion_content":"准确说应该是每个&#34;订单中单个商品&#34;的原价，实际优惠价","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1618217049,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":334683,"ip_address":""},"score":366915,"extra":""}]},{"author":{"id":1039544,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/dc/b8/31c7e110.jpg","nickname":"LVM_23","note":"","ucode":"5E54F9DB582E9F","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":251179,"discussion_content":"看老师回复，收获不少","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1588071946,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1046791,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/f9/07/ee1bbd42.jpg","nickname":"zzz","note":"","ucode":"091A0D95EE5E3C","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":204442,"discussion_content":"提前算好账，有备无患！","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1584174131,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":183054,"user_name":"GeekAmI","can_delete":false,"product_type":"c1","uid":1005030,"ip_address":"","ucode":"232C0B6DFB9F56","user_header":"https://static001.geekbang.org/account/avatar/00/0f/55/e6/87197b10.jpg","comment_is_top":false,"comment_ctime":1582943201,"is_pvip":false,"replies":[{"id":"71079","content":"一般来说是下单锁库存，发货减库存。","user_name":"作者回复","user_name_real":"李玥","uid":"1501046","ctime":1583114093,"ip_address":"","comment_id":183054,"utype":1}],"discussion_count":7,"race_medal":0,"score":"126136994785","product_id":100046801,"comment_content":"所以，到底是下单扣库存，还是发货扣库存呢?","like_count":30,"discussions":[{"author":{"id":1501046,"avatar":"https://static001.geekbang.org/account/avatar/00/16/e7/76/79c1f23a.jpg","nickname":"李玥","note":"","ucode":"B19E91EE248591","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":485550,"discussion_content":"一般来说是下单锁库存，发货减库存。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1583114093,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1245240,"avatar":"https://static001.geekbang.org/account/avatar/00/13/00/38/3257cfbd.jpg","nickname":"Zach","note":"","ucode":"34C18D5CACF96A","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":292630,"discussion_content":"老师，你好，不太理解锁库存的概念，能具体一些吗，如何实现锁库存的？","likes_number":2,"is_delete":false,"is_hidden":false,"ctime":1595290674,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1156592,"avatar":"https://static001.geekbang.org/account/avatar/00/11/a5/f0/8648c464.jpg","nickname":"Joker","note":"","ucode":"126AF848001A1E","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":300795,"discussion_content":"老师，一般是如何锁库存的，在表里再维护一个锁库存字段吗，锁了就累增，一发货就减？","likes_number":1,"is_delete":false,"is_hidden":false,"ctime":1598265553,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":1,"child_discussions":[{"author":{"id":1124777,"avatar":"https://static001.geekbang.org/account/avatar/00/11/29/a9/4c114382.jpg","nickname":"qpy","note":"","ucode":"4D95DDF313DDCF","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":1156592,"avatar":"https://static001.geekbang.org/account/avatar/00/11/a5/f0/8648c464.jpg","nickname":"Joker","note":"","ucode":"126AF848001A1E","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":362716,"discussion_content":"之前遇到过这样做的：设计两个字段，一个字段时可用库存，比如100件，一个字段是占用库存，初始化为0。客户A下单后锁住库存，其实就是可用库存为98，占用库存为2。不知道常规做法是不是这样。","likes_number":1,"is_delete":false,"is_hidden":false,"ctime":1617017611,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":300795,"ip_address":""},"score":362716,"extra":""}]},{"author":{"id":1032345,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/c0/99/259a412f.jpg","nickname":"Geeker","note":"","ucode":"9937127DE96D78","race_medal":0,"user_type":1,"is_pvip":true},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":539318,"discussion_content":"好像有点预占，实占的意思","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1639666300,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":2296382,"avatar":"https://static001.geekbang.org/account/avatar/00/23/0a/3e/5b1b1b75.jpg","nickname":"流年","note":"","ucode":"8B579C6E466CB4","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":322372,"discussion_content":"库存这块一般不是设计成下单减库存，或者下单先锁库存，支付的时候再真正扣减吗？还没遇到发货时减库存的做法","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1604734121,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1595817,"avatar":"https://static001.geekbang.org/account/avatar/00/18/59/a9/59cb980b.jpg","nickname":"王俊杰","note":"","ucode":"7F05838F0E36C9","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":304749,"discussion_content":"老师，一般是如何锁库存的，在表里再维护一个锁库存字段吗，锁了就累增，一发货就减","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1599656165,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":182301,"user_name":"FATMAN89","can_delete":false,"product_type":"c1","uid":1175430,"ip_address":"","ucode":"48A67FB47B3C5D","user_header":"https://static001.geekbang.org/account/avatar/00/11/ef/86/12f95d66.jpg","comment_is_top":false,"comment_ctime":1582765638,"is_pvip":false,"replies":[{"id":"70581","content":"还是看具体的业务场景吧。<br><br>一般来说，解决超卖问题的方法都是在下单的时候锁定库存，如果订单取消再释放库存。","user_name":"作者回复","user_name_real":"李玥","uid":"1501046","ctime":1582772106,"ip_address":"","comment_id":182301,"utype":1}],"discussion_count":5,"race_medal":0,"score":"61712307782","product_id":100046801,"comment_content":"我想向老师请教一下，电商系统中如何解决超卖这个问题？谢谢！","like_count":15,"discussions":[{"author":{"id":1501046,"avatar":"https://static001.geekbang.org/account/avatar/00/16/e7/76/79c1f23a.jpg","nickname":"李玥","note":"","ucode":"B19E91EE248591","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":485294,"discussion_content":"还是看具体的业务场景吧。\n\n一般来说，解决超卖问题的方法都是在下单的时候锁定库存，如果订单取消再释放库存。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1582772106,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1140037,"avatar":"https://static001.geekbang.org/account/avatar/00/11/65/45/a026b813.jpg","nickname":"a菜鸟学扑腾","note":"","ucode":"01C7743A933EBA","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":371000,"discussion_content":"最好的方式是用数据库的乐观锁更新库存。要是库存放在缓存里面，可以用lua脚本进行原子扣减","likes_number":1,"is_delete":false,"is_hidden":false,"ctime":1619604662,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1211223,"avatar":"https://static001.geekbang.org/account/avatar/00/12/7b/57/a9b04544.jpg","nickname":"QQ怪","note":"","ucode":"1A39B8433D9208","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":258095,"discussion_content":"如果有人恶意锁单怎么办？","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1588645754,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":2,"child_discussions":[{"author":{"id":2297346,"avatar":"https://static001.geekbang.org/account/avatar/00/23/0e/02/41099234.jpg","nickname":"Django...","note":"","ucode":"56693F8A886FF0","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":1211223,"avatar":"https://static001.geekbang.org/account/avatar/00/12/7b/57/a9b04544.jpg","nickname":"QQ怪","note":"","ucode":"1A39B8433D9208","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":366923,"discussion_content":"有支付时间限制，超过时间自动释放商品，重新下单就行了吧","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1618218299,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":258095,"ip_address":""},"score":366923,"extra":""},{"author":{"id":1074734,"avatar":"https://static001.geekbang.org/account/avatar/00/10/66/2e/527b73c9.jpg","nickname":"骑着🚀看银河","note":"","ucode":"8706A99A89F0CE","race_medal":0,"user_type":1,"is_pvip":true},"reply_author":{"id":1211223,"avatar":"https://static001.geekbang.org/account/avatar/00/12/7b/57/a9b04544.jpg","nickname":"QQ怪","note":"","ucode":"1A39B8433D9208","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":559537,"discussion_content":"关小黑屋","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1648810160,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":258095,"ip_address":""},"score":559537,"extra":""}]}]},{"had_liked":false,"id":182348,"user_name":"良木","can_delete":false,"product_type":"c1","uid":1067425,"ip_address":"","ucode":"2D63A277233DDA","user_header":"https://static001.geekbang.org/account/avatar/00/10/49/a1/65eb82df.jpg","comment_is_top":false,"comment_ctime":1582772051,"is_pvip":false,"replies":[{"id":"70641","content":"我们这里的用户模块主要是维护和管理C端用户信息的模块，用户数据也是业务数据，是电商的重要业务资产，所以最好不要登录认证的安全功能做在一起。","user_name":"作者回复","user_name_real":"李玥","uid":"1501046","ctime":1582800939,"ip_address":"","comment_id":182348,"utype":1}],"discussion_count":6,"race_medal":0,"score":"48827412307","product_id":100046801,"comment_content":"老师，您提到“用户模块一般不负责用户登录和认证，这是两个完全不同的功能&quot; 这该怎样理解？<br>我们在做登录认证时会从用户库查询匹配、也会有些跟用户相关的别的逻辑。<br>谢谢！","like_count":11,"discussions":[{"author":{"id":1501046,"avatar":"https://static001.geekbang.org/account/avatar/00/16/e7/76/79c1f23a.jpg","nickname":"李玥","note":"","ucode":"B19E91EE248591","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":485313,"discussion_content":"我们这里的用户模块主要是维护和管理C端用户信息的模块，用户数据也是业务数据，是电商的重要业务资产，所以最好不要登录认证的安全功能做在一起。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1582800939,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1359701,"avatar":"https://static001.geekbang.org/account/avatar/00/14/bf/55/198c6104.jpg","nickname":"小伟","note":"","ucode":"124953423491E2","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":188507,"discussion_content":"我之前在的电信行业有三户模型，用户、客户、账户。用户是站在使用者角度，维护手机号码、sim卡号等；客户是站在自然人的角度，维护年龄、职业、性别等；账户是站在金钱角度，维护余额、专款等。\n对应电商，李老师这里应该指的是客户，性别、年龄等对于消费习惯画像、深度价值挖掘的意义非常重大，是数据资产，所以不应和安全等功能性模块耦合。\n可以抽象一个用户模块，维护账号、密码等鉴权数据，专职和安全认证等对接，以后扩展如第三方登录也只会影响用户模块，不会影响客户和账户。","likes_number":29,"is_delete":false,"is_hidden":false,"ctime":1582813683,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":3,"child_discussions":[{"author":{"id":1244290,"avatar":"https://static001.geekbang.org/account/avatar/00/12/fc/82/abf28df3.jpg","nickname":"L","note":"","ucode":"9F125EAC36CBEE","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":1359701,"avatar":"https://static001.geekbang.org/account/avatar/00/14/bf/55/198c6104.jpg","nickname":"小伟","note":"","ucode":"124953423491E2","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":191885,"discussion_content":"涨姿势。👍","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1583043155,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":188507,"ip_address":""},"score":191885,"extra":""},{"author":{"id":1433535,"avatar":"https://static001.geekbang.org/account/avatar/00/15/df/bf/96b50d1e.jpg","nickname":"😚 46","note":"","ucode":"EED0EBBBF80A43","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":1359701,"avatar":"https://static001.geekbang.org/account/avatar/00/14/bf/55/198c6104.jpg","nickname":"小伟","note":"","ucode":"124953423491E2","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":244279,"discussion_content":"GET","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1587573499,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":188507,"ip_address":""},"score":244279,"extra":""},{"author":{"id":1872697,"avatar":"https://static001.geekbang.org/account/avatar/00/1c/93/39/f642023f.jpg","nickname":"Hplus","note":"","ucode":"DC32CBC3E9C11D","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":1359701,"avatar":"https://static001.geekbang.org/account/avatar/00/14/bf/55/198c6104.jpg","nickname":"小伟","note":"","ucode":"124953423491E2","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":572939,"discussion_content":"👍🏻","likes_number":1,"is_delete":false,"is_hidden":false,"ctime":1653058669,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":188507,"ip_address":""},"score":572939,"extra":""}]},{"author":{"id":1958580,"avatar":"","nickname":"安普尚","note":"","ucode":"B587954A1722DA","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":229619,"discussion_content":"用户是一个很大的范畴，可以按照用户分为几个小部分","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1586674473,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":183719,"user_name":"一个程序员的成长","can_delete":false,"product_type":"c1","uid":1008900,"ip_address":"","ucode":"168CDADD41B65F","user_header":"https://static001.geekbang.org/account/avatar/00/0f/65/04/bf12d036.jpg","comment_is_top":false,"comment_ctime":1583119974,"is_pvip":false,"replies":[{"id":"71169","content":"是的，所以你看很多抢购的订单，如果你下单后不付款，有效期都非常短，为的就是尽快释放库存，给其它人抢购。","user_name":"作者回复","user_name_real":"李玥","uid":"1501046","ctime":1583146367,"ip_address":"","comment_id":183719,"utype":1}],"discussion_count":1,"race_medal":0,"score":"35942858342","product_id":100046801,"comment_content":"你好老师，看到有同学提到库存的问题，如果用户下单之后，一直没有取消订单，是不是有一个阈值，比如说30分钟，用户还没有支付，这个订单相应的也要失效，同时释放库存。","like_count":8,"discussions":[{"author":{"id":1501046,"avatar":"https://static001.geekbang.org/account/avatar/00/16/e7/76/79c1f23a.jpg","nickname":"李玥","note":"","ucode":"B19E91EE248591","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":485760,"discussion_content":"是的，所以你看很多抢购的订单，如果你下单后不付款，有效期都非常短，为的就是尽快释放库存，给其它人抢购。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1583146367,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":182236,"user_name":"良木","can_delete":false,"product_type":"c1","uid":1067425,"ip_address":"","ucode":"2D63A277233DDA","user_header":"https://static001.geekbang.org/account/avatar/00/10/49/a1/65eb82df.jpg","comment_is_top":false,"comment_ctime":1582731356,"is_pvip":false,"replies":[{"id":"70572","content":"对小规模的团队，这是一个非常务实合理的选择。","user_name":"作者回复","user_name_real":"李玥","uid":"1501046","ctime":1582768044,"ip_address":"","comment_id":182236,"utype":1}],"discussion_count":1,"race_medal":0,"score":"35942469724","product_id":100046801,"comment_content":"开始阶段一般选java技术栈，如果团队能驾驭别技术栈也是可以的，前端可能只做小程序，数据库使用mysql或最熟悉的。图片视频存储直接购买公有云产品，还需要CDN，框架如第三方支付SDK 等，还要申请一堆东西域名、证书... ","like_count":8,"discussions":[{"author":{"id":1501046,"avatar":"https://static001.geekbang.org/account/avatar/00/16/e7/76/79c1f23a.jpg","nickname":"李玥","note":"","ucode":"B19E91EE248591","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":485263,"discussion_content":"对小规模的团队，这是一个非常务实合理的选择。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1582768044,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":183458,"user_name":"L","can_delete":false,"product_type":"c1","uid":1244290,"ip_address":"","ucode":"9F125EAC36CBEE","user_header":"https://static001.geekbang.org/account/avatar/00/12/fc/82/abf28df3.jpg","comment_is_top":false,"comment_ctime":1583045308,"is_pvip":false,"discussion_count":4,"race_medal":0,"score":"31647816380","product_id":100046801,"comment_content":"浏览了评论，其它同学有提到的，我就不赘述了。<br>云服务建议采用阿里云，阿里云的产品种类比较多，基本能满足电商系统的开发需要。<br>图片视频等文件存储采用阿里云的对象存储OSS。<br>商品搜索采用阿里云的开发搜索OpenSearch，它提供了专门针对电商的分词支持。<br>订单支付一般对接微信支付和支付宝支付。<br>总之，初创型公司要求是快速出成品，采用现成的服务比较便捷。","like_count":7,"discussions":[{"author":{"id":1302746,"avatar":"http://thirdwx.qlogo.cn/mmopen/vi_32/DYAIOgq83eoWfXendN7czHpsyaWKLPK6Na9P5czquJ7Wdre4TibZQ5SQib88edyuib3LpCVFkp0gII2wyvvR8tEIA/132","nickname":"OM","note":"","ucode":"E33C66A70802A5","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":387387,"discussion_content":"需要钱，要是真正成为技术大家需要从0开始而不是用现成的还带广告的推销的各类云","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1628147194,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1886331,"avatar":"https://static001.geekbang.org/account/avatar/00/1c/c8/7b/153181d7.jpg","nickname":"夜辉","note":"","ucode":"9421385F51FF9E","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":365645,"discussion_content":"还有存储方案\n全部用阿里云服务，这一套要不要上百W？","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1617857856,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":1,"child_discussions":[{"author":{"id":1244290,"avatar":"https://static001.geekbang.org/account/avatar/00/12/fc/82/abf28df3.jpg","nickname":"L","note":"","ucode":"9F125EAC36CBEE","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":1886331,"avatar":"https://static001.geekbang.org/account/avatar/00/1c/c8/7b/153181d7.jpg","nickname":"夜辉","note":"","ucode":"9421385F51FF9E","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":366280,"discussion_content":"看你维持时长了","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1618020505,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":365645,"ip_address":""},"score":366280,"extra":""}]},{"author":{"id":1012843,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/74/6b/a98162a1.jpg","nickname":"winner_0715","note":"","ucode":"A033A30539181F","race_medal":0,"user_type":1,"is_pvip":true},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":304566,"discussion_content":"阿里牛","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1599616465,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":183429,"user_name":"新安","can_delete":false,"product_type":"c1","uid":1876592,"ip_address":"","ucode":"CA2E1304FCAC6A","user_header":"https://static001.geekbang.org/account/avatar/00/1c/a2/70/98cfd56b.jpg","comment_is_top":false,"comment_ctime":1583038269,"is_pvip":false,"discussion_count":3,"race_medal":0,"score":"23057874749","product_id":100046801,"comment_content":"老师你好，关于库存变化这块儿，我们是有一个总库存和一个冻结库存，当前可用库存是 总库存-冻结库存，用户购买一件商品时，下单后冻结库存+1，然后在支付成功后总库存和冻结库存分别-1；订单超时未支付的话，冻结库存-1，总库存不变。","like_count":5,"discussions":[{"author":{"id":1106394,"avatar":"https://static001.geekbang.org/account/avatar/00/10/e1/da/d7f591a7.jpg","nickname":"励研冰","note":"","ucode":"FCBC8266018FA0","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":248361,"discussion_content":"你们为什么会这么做，或者说这么做解决了什么问题?我没看出来多了一个字段性能上有什么优化，因为在innodb下面颗粒度最小的就是行锁了","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1587865548,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":1,"child_discussions":[{"author":{"id":1886331,"avatar":"https://static001.geekbang.org/account/avatar/00/1c/c8/7b/153181d7.jpg","nickname":"夜辉","note":"","ucode":"9421385F51FF9E","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":1106394,"avatar":"https://static001.geekbang.org/account/avatar/00/10/e1/da/d7f591a7.jpg","nickname":"励研冰","note":"","ucode":"FCBC8266018FA0","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":365646,"discussion_content":"为了实现下单锁库存，发货减库存\n把可用库存和实际库存分开","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1617858047,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":248361,"ip_address":""},"score":365646,"extra":""}]},{"author":{"id":1433535,"avatar":"https://static001.geekbang.org/account/avatar/00/15/df/bf/96b50d1e.jpg","nickname":"😚 46","note":"","ucode":"EED0EBBBF80A43","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":244284,"discussion_content":"其实是一个意思，不过你这里是支付成功后释放库存，而老师的意思是发货后释放。个人觉得发货后释放更合适些，因为总库存就可以理解为仓库的实际库存量了。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1587574768,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":182608,"user_name":"小伟","can_delete":false,"product_type":"c1","uid":1359701,"ip_address":"","ucode":"124953423491E2","user_header":"https://static001.geekbang.org/account/avatar/00/14/bf/55/198c6104.jpg","comment_is_top":false,"comment_ctime":1582815115,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"23057651595","product_id":100046801,"comment_content":"技术选型：<br>    前端react+vue，没什么花样。后端java+Spring全家桶。数据库mysql。<br>三方框架和云服务：<br>    通信中间件rocketmq，模块通信grpc，日志中间件kafka，缓存redis，搜索elk，支付不知有何三方库，认证shiro，实时计算spark，其他的都买XX云吧，如cdn、文件服务、网关服务、高可用、集群扩容、带宽。<br>存储选型:<br>    了解不深，只会从数据存储角度分析：<br>    用户、订单等大数据量的分库分表，日志存nosql，<br>    <br>    ","like_count":5},{"had_liked":false,"id":182463,"user_name":"约书亚","can_delete":false,"product_type":"c1","uid":1046714,"ip_address":"","ucode":"81EA27ADD9EC1A","user_header":"https://static001.geekbang.org/account/avatar/00/0f/f8/ba/14e05601.jpg","comment_is_top":false,"comment_ctime":1582791642,"is_pvip":false,"discussion_count":1,"race_medal":0,"score":"23057628122","product_id":100046801,"comment_content":"使用什么编程语言和技术栈？本CTO最熟悉的编程语言和技术<br>需要哪些第三方的框架和云服务？本CTO最熟悉的框架和云服务<br>我们最关心的存储系统该怎么选型？本CTO最熟悉的存储<br><br>机智如我","like_count":5,"discussions":[{"author":{"id":1285055,"avatar":"https://static001.geekbang.org/account/avatar/00/13/9b/bf/a76eadff.jpg","nickname":"小嘟嘟","note":"","ucode":"1584DD1402502D","race_medal":0,"user_type":1,"is_pvip":true},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":574832,"discussion_content":"这才是开发者角度，减少未知风险发生，只有熟悉，才能保证稳定安全","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1654396733,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":183476,"user_name":"奔奔奔跑","can_delete":false,"product_type":"c1","uid":1210265,"ip_address":"","ucode":"F86EC205DCAACE","user_header":"http://thirdwx.qlogo.cn/mmopen/vi_32/Gswh7ibY4tubXhp0BXOmV2pXZ3XsXic1d942ZMAEgWrRSF99bDskOTsG1g172ibORXxSCWTn9HWUX5vSSUVWU5I4A/132","comment_is_top":false,"comment_ctime":1583048435,"is_pvip":false,"discussion_count":5,"race_medal":0,"score":"18762917619","product_id":100046801,"comment_content":"我选择用go作为后端开发语言，选用gin或者iris框架，考虑团队规模，预估用户规模考虑单体还是微服务架构。服务放阿里云上，数据库用mongodb","like_count":4,"discussions":[{"author":{"id":1835642,"avatar":"","nickname":"叶子","note":"","ucode":"41131155D75B09","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":222552,"discussion_content":"典型的程序员思维，脱离现实","likes_number":1,"is_delete":false,"is_hidden":false,"ctime":1586155847,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":3,"child_discussions":[{"author":{"id":1210265,"avatar":"http://thirdwx.qlogo.cn/mmopen/vi_32/Gswh7ibY4tubXhp0BXOmV2pXZ3XsXic1d942ZMAEgWrRSF99bDskOTsG1g172ibORXxSCWTn9HWUX5vSSUVWU5I4A/132","nickname":"奔奔奔跑","note":"","ucode":"F86EC205DCAACE","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":1835642,"avatar":"","nickname":"叶子","note":"","ucode":"41131155D75B09","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":226082,"discussion_content":"你说得对","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1586419738,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":222552,"ip_address":""},"score":226082,"extra":""},{"author":{"id":1886331,"avatar":"https://static001.geekbang.org/account/avatar/00/1c/c8/7b/153181d7.jpg","nickname":"夜辉","note":"","ucode":"9421385F51FF9E","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":1835642,"avatar":"","nickname":"叶子","note":"","ucode":"41131155D75B09","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":365647,"discussion_content":"为什么这么说？","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1617858193,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":222552,"ip_address":""},"score":365647,"extra":""},{"author":{"id":1676962,"avatar":"https://static001.geekbang.org/account/avatar/00/19/96/a2/c1596dd8.jpg","nickname":"🤔","note":"","ucode":"40ACB53BF3C6B1","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":1835642,"avatar":"","nickname":"叶子","note":"","ucode":"41131155D75B09","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":574708,"discussion_content":"怎么说？","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1654270681,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":222552,"ip_address":""},"score":574708,"extra":""}]},{"author":{"id":1886331,"avatar":"https://static001.geekbang.org/account/avatar/00/1c/c8/7b/153181d7.jpg","nickname":"夜辉","note":"","ucode":"9421385F51FF9E","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":365648,"discussion_content":"没有关系型数据库兜底，会不会太冒险了，感觉nosql尚未完全替代关系型数据库","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1617858253,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":183946,"user_name":"Middleware","can_delete":false,"product_type":"c1","uid":1072015,"ip_address":"","ucode":"C0028293ECDD47","user_header":"https://static001.geekbang.org/account/avatar/00/10/5b/8f/4b0ab5db.jpg","comment_is_top":false,"comment_ctime":1583166426,"is_pvip":true,"replies":[{"id":"71220","content":"PHP是世界上最好的语言😆","user_name":"作者回复","user_name_real":"李玥","uid":"1501046","ctime":1583201098,"ip_address":"","comment_id":183946,"utype":1}],"discussion_count":1,"race_medal":0,"score":"14468068314","product_id":100046801,"comment_content":"清一色 Java，我php 也可以哈，php +swoole","like_count":3,"discussions":[{"author":{"id":1501046,"avatar":"https://static001.geekbang.org/account/avatar/00/16/e7/76/79c1f23a.jpg","nickname":"李玥","note":"","ucode":"B19E91EE248591","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":485829,"discussion_content":"PHP是世界上最好的语言😆","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1583201098,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":183431,"user_name":"新安","can_delete":false,"product_type":"c1","uid":1876592,"ip_address":"","ucode":"CA2E1304FCAC6A","user_header":"https://static001.geekbang.org/account/avatar/00/1c/a2/70/98cfd56b.jpg","comment_is_top":false,"comment_ctime":1583038357,"is_pvip":false,"replies":[{"id":"71117","content":"下单的时候需要锁定库存，配合发货的时候减库存，才不会超卖。","user_name":"作者回复","user_name_real":"李玥","uid":"1501046","ctime":1583116422,"ip_address":"","comment_id":183431,"utype":1}],"discussion_count":1,"race_medal":0,"score":"14467940245","product_id":100046801,"comment_content":"但我看老师说的是在发货后再减去相应的库存，这样不会造成超卖吗？","like_count":3,"discussions":[{"author":{"id":1501046,"avatar":"https://static001.geekbang.org/account/avatar/00/16/e7/76/79c1f23a.jpg","nickname":"李玥","note":"","ucode":"B19E91EE248591","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":485685,"discussion_content":"下单的时候需要锁定库存，配合发货的时候减库存，才不会超卖。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1583116422,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":183947,"user_name":"Eclipse","can_delete":false,"product_type":"c1","uid":1589989,"ip_address":"","ucode":"E7EB0BA99FA644","user_header":"https://static001.geekbang.org/account/avatar/00/18/42/e5/61cfe267.jpg","comment_is_top":false,"comment_ctime":1583166446,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"10173101038","product_id":100046801,"comment_content":"老师，有京东的招聘信息没👍👍👍","like_count":2},{"had_liked":false,"id":183567,"user_name":"leslie","can_delete":false,"product_type":"c1","uid":1324255,"ip_address":"","ucode":"798E7C1CC98CC2","user_header":"https://static001.geekbang.org/account/avatar/00/14/34/df/64e3d533.jpg","comment_is_top":false,"comment_ctime":1583067935,"is_pvip":false,"discussion_count":1,"race_medal":0,"score":"10173002527","product_id":100046801,"comment_content":"老师此处分成三个问题似乎有欠考虑：编程语言的选择会决定服务器的操作系统，操作系统的选择特性已经大致决定了硬件配置特性，云服务器的配置早期是要自己选择的；老师之前的课程跟过来的且曾经在电商多年：可能看到的点不一样。<br>先回答老师的三个问题：<br>1.编程语言的选择：大致都是基于服务器操作系统的选择-windows或linux;windows基本上就是.net系,linux则是java系，基于这两种编程语言早期会有两系基本相关的技术栈；<br>2.第三方框架和云服务：这个就是根据编程语言所属的系去选择，云服务同样如此<br>3.存储如何选择：此处老师指的应当是数据系统的存储或中间件存储，主要看数据存在哪儿；内存还是硬盘。中间件存储的选择会决定存储的大小和比例，如redis或mongodb以及老师之前《消息队列高手》课讲的消息队列，这些都是对于内存要求偏高而硬盘要求偏低，可是如果用mysql或sql server以及oracle首选还是会上ssd。<br>故而个人觉得此处应当是总体考虑完了再分别考虑后面3个小问题更合适；谢谢老师的分享，希望能够继续和老师学完，然后再学习沟通中收获老师不一样的思路与视角。","like_count":2,"discussions":[{"author":{"id":1886331,"avatar":"https://static001.geekbang.org/account/avatar/00/1c/c8/7b/153181d7.jpg","nickname":"夜辉","note":"","ucode":"9421385F51FF9E","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":365654,"discussion_content":"服务器一般用Linux，.net还是少\nC++，java，go等都有其开发框架，感觉老师应该是java技术栈","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1617858829,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":182953,"user_name":"每天晒白牙","can_delete":false,"product_type":"c1","uid":1004698,"ip_address":"","ucode":"A1B102CD933DEA","user_header":"https://static001.geekbang.org/account/avatar/00/0f/54/9a/76c0af70.jpg","comment_is_top":false,"comment_ctime":1582895812,"is_pvip":false,"discussion_count":1,"race_medal":0,"score":"10172830404","product_id":100046801,"comment_content":"1.编程语言选Java，技术栈就是Spring吧<br><br>2.需要用的的框架如下<br>rpc调用的远dubbo，社区比较活跃，用这个的公司也比较多，有问题好去查资料<br>缓存用redis<br>mq可以用kafka或rocketmq<br>数据库用mysql<br>如果有搜索功能，可以用ES<br>如果设计到mysql到其他存储的同步可以用canal<br> <br>对于云服务来说阿里云，腾讯云等等都可以<br><br>3.存储系统语言根据业务场景来选择<br><br>因为没有做过电商，就不班门弄斧了","like_count":1,"discussions":[{"author":{"id":1165364,"avatar":"https://static001.geekbang.org/account/avatar/00/11/c8/34/fb871b2c.jpg","nickname":"海罗沃德","note":"","ucode":"8704F1D6980FA0","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":201388,"discussion_content":"既然用了spring最好就不用dubbo，dubbo這種框架太重，侵入性比較高，而spring全家桶都可以根據業務需求來進行自定義選擇，開發起來更靈活，雖然是用http來做rpc，性能上其實對於初創公司是沒差的，如果真的公司規模做到http rpc已經不夠用了，自然也會有其他的替代方案，而這個時候基於spring的微服務就很容易可以切換到其他的技術棧","likes_number":1,"is_delete":false,"is_hidden":false,"ctime":1583776526,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":182596,"user_name":"aoe","can_delete":false,"product_type":"c1","uid":1121758,"ip_address":"","ucode":"1C6201EDB4E954","user_header":"https://static001.geekbang.org/account/avatar/00/11/1d/de/62bfa83f.jpg","comment_is_top":false,"comment_ctime":1582814004,"is_pvip":false,"replies":[{"id":"70679","content":"具体你想了解哪些技术呢？","user_name":"作者回复","user_name_real":"李玥","uid":"1501046","ctime":1582859380,"ip_address":"","comment_id":182596,"utype":1}],"discussion_count":1,"race_medal":0,"score":"10172748596","product_id":100046801,"comment_content":"老师，购买成功后，关于”订单快照“的存储策略后面会介绍吗？","like_count":2,"discussions":[{"author":{"id":1501046,"avatar":"https://static001.geekbang.org/account/avatar/00/16/e7/76/79c1f23a.jpg","nickname":"李玥","note":"","ucode":"B19E91EE248591","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":485381,"discussion_content":"具体你想了解哪些技术呢？","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1582859380,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":182203,"user_name":"不记年","can_delete":false,"product_type":"c1","uid":1045945,"ip_address":"","ucode":"287E40C68356DC","user_header":"https://static001.geekbang.org/account/avatar/00/0f/f5/b9/888fe350.jpg","comment_is_top":false,"comment_ctime":1582728382,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"10172662974","product_id":100046801,"comment_content":"应用刚起步时可以全部采用mysql作为存储系统，考虑到读请求远大于写请求，可以采用读者分离或者缓存。<br>编程语言出于快速开发的目的可以选择java，框架为springboot","like_count":2},{"had_liked":false,"id":340434,"user_name":"骑着🚀看银河","can_delete":false,"product_type":"c1","uid":1074734,"ip_address":"","ucode":"8706A99A89F0CE","user_header":"https://static001.geekbang.org/account/avatar/00/10/66/2e/527b73c9.jpg","comment_is_top":false,"comment_ctime":1648811054,"is_pvip":true,"discussion_count":0,"race_medal":0,"score":"5943778350","product_id":100046801,"comment_content":"分享下目前创业的技术选型：<br>1. 前端 微信小程序原生 （后期打算用 Taro）+ App（Flutter 非必须）+ 管理端 React 全家桶<br>2. 服务端 Go技术栈，Gin + grpc-go + GORM + Redis + MySQL + etcd<br>3. Docker + K8s<br>4. 阿里云 ECS、对象存储、域名、备案、CDN等等<br>最后也是最重要的是团队对于技术栈的熟悉程度，创业公司最重要的是第一个MVP产品版本！","like_count":1},{"had_liked":false,"id":244470,"user_name":"朱朱","can_delete":false,"product_type":"c1","uid":1548814,"ip_address":"","ucode":"CE56C6773736D4","user_header":"https://static001.geekbang.org/account/avatar/00/17/a2/0e/62f10b10.jpg","comment_is_top":false,"comment_ctime":1598527301,"is_pvip":false,"discussion_count":1,"race_medal":0,"score":"5893494597","product_id":100046801,"comment_content":"支付后未发货前，部分商品退货，订单流程如果处理能介绍一下吗","like_count":1,"discussions":[{"author":{"id":2297346,"avatar":"https://static001.geekbang.org/account/avatar/00/23/0e/02/41099234.jpg","nickname":"Django...","note":"","ucode":"56693F8A886FF0","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":366928,"discussion_content":"我的理解：部分商品直接按结算价退款，同时退款商品库存要增加；剩余商品在发货减库存吧","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1618219223,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":182111,"user_name":"业余爱好者","can_delete":false,"product_type":"c1","uid":1482915,"ip_address":"","ucode":"A890935A982988","user_header":"https://static001.geekbang.org/account/avatar/00/16/a0/a3/8da99bb0.jpg","comment_is_top":false,"comment_ctime":1582710978,"is_pvip":false,"discussion_count":3,"race_medal":0,"score":"5877678274","product_id":100046801,"comment_content":"编程语言当然是java。业务开发领域，java是无疑的王者。<br><br>框架选用spring,图片，多媒体等对象存储使用七牛云。<br><br>数据库使用mysql,使用redis做缓存,elasticsearch做全文搜索，消息使用rocketmq。<br>","like_count":1,"discussions":[{"author":{"id":1064018,"avatar":"https://static001.geekbang.org/account/avatar/00/10/3c/52/5951ffb4.jpg","nickname":"Sinvi","note":"","ucode":"2A90976980CA3C","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":326180,"discussion_content":"太对了哥哥太对","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1605538707,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1121758,"avatar":"https://static001.geekbang.org/account/avatar/00/11/1d/de/62bfa83f.jpg","nickname":"aoe","note":"","ucode":"1C6201EDB4E954","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":188516,"discussion_content":"你是Go的粉丝？","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1582813925,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":1,"child_discussions":[{"author":{"id":1482915,"avatar":"https://static001.geekbang.org/account/avatar/00/16/a0/a3/8da99bb0.jpg","nickname":"业余爱好者","note":"","ucode":"A890935A982988","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":1121758,"avatar":"https://static001.geekbang.org/account/avatar/00/11/1d/de/62bfa83f.jpg","nickname":"aoe","note":"","ucode":"1C6201EDB4E954","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":188521,"discussion_content":"盗图者而已","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1582814094,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":188516,"ip_address":""},"score":188521,"extra":""}]}]},{"had_liked":false,"id":347754,"user_name":"小嘟嘟","can_delete":false,"product_type":"c1","uid":1285055,"ip_address":"","ucode":"1584DD1402502D","user_header":"https://static001.geekbang.org/account/avatar/00/13/9b/bf/a76eadff.jpg","comment_is_top":false,"comment_ctime":1654397290,"is_pvip":true,"discussion_count":0,"race_medal":0,"score":"1654397290","product_id":100046801,"comment_content":"1. 使用什么编程语言和技术栈？<br>    优先考虑java， 因为阿里靠java在电商领域深耕多年，生态圈早都建立出来了，该踩的坑也都踩过去了，后续业务规模扩大升级，都有成熟的经验可以借鉴<br>2. 需要哪些第三方的框架和云服务？<br>     对于初创小公司。尽量使用云厂商lass pass sass服务，快速上手。因为我觉得互联网领域，时间就是金钱，机会转瞬即逝，先保证产品用起来。 质量和成本基本都是后续的事情了<br>3. 我们最关心的存储系统该怎么选型？<br>    根据实际业务场景选型吧， mysql redis hive mongodb es  mq 应该都少不了","like_count":0},{"had_liked":false,"id":340852,"user_name":"摊牌","can_delete":false,"product_type":"c1","uid":1453182,"ip_address":"","ucode":"F142596BFE4594","user_header":"https://static001.geekbang.org/account/avatar/00/16/2c/7e/f1efd18b.jpg","comment_is_top":false,"comment_ctime":1649202549,"is_pvip":true,"discussion_count":0,"race_medal":0,"score":"1649202549","product_id":100046801,"comment_content":"锁定库存一般有哪些具体实现策略","like_count":0},{"had_liked":false,"id":330964,"user_name":"天天向上","can_delete":false,"product_type":"c1","uid":1282639,"ip_address":"","ucode":"D0914D4FD82272","user_header":"https://static001.geekbang.org/account/avatar/00/13/92/4f/ff04156a.jpg","comment_is_top":false,"comment_ctime":1642327457,"is_pvip":true,"discussion_count":0,"race_medal":0,"score":"1642327457","product_id":100046801,"comment_content":"加餐非常有干货，谢谢分享","like_count":0},{"had_liked":false,"id":323782,"user_name":"达叔灬","can_delete":false,"product_type":"c1","uid":2404887,"ip_address":"","ucode":"5CCBAF13548F02","user_header":"https://static001.geekbang.org/account/avatar/00/24/b2/17/3161b49c.jpg","comment_is_top":false,"comment_ctime":1638159862,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1638159862","product_id":100046801,"comment_content":"前端选择 React或者Vue，后端选择net6，利用dapr、docker、k8s实现微服务部署<br>利用 redis、kafka、es、mysql和mongodb等实现缓存、消息、搜索及存储服务。<br>云服务商可以选着阿里云<br>第三方服务 比如 极验的验证码服务、阿里云的oss、以及极光推送，尽可能选着可靠性和专业性强的第三方服务","like_count":0},{"had_liked":false,"id":318624,"user_name":"董俊俊","can_delete":false,"product_type":"c1","uid":1297887,"ip_address":"","ucode":"732300A779660B","user_header":"https://static001.geekbang.org/account/avatar/00/13/cd/df/c520d418.jpg","comment_is_top":false,"comment_ctime":1635362156,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1635362156","product_id":100046801,"comment_content":"用户模块不包括登录注册，那是不是还需要一个用户登录注册模块呢？看文章没说啊？","like_count":0},{"had_liked":false,"id":312964,"user_name":"Geek_44ba81","can_delete":false,"product_type":"c1","uid":2772055,"ip_address":"","ucode":"B0762680D208ED","user_header":"","comment_is_top":false,"comment_ctime":1632150802,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1632150802","product_id":100046801,"comment_content":"各种业务的报表是跟着业务走，还是报表统一放在一起呢","like_count":0},{"had_liked":false,"id":286737,"user_name":"建强","can_delete":false,"product_type":"c1","uid":1397126,"ip_address":"","ucode":"62B03D0E0C64EC","user_header":"https://static001.geekbang.org/account/avatar/00/15/51/86/b5fd8dd8.jpg","comment_is_top":false,"comment_ctime":1617541521,"is_pvip":false,"discussion_count":1,"race_medal":0,"score":"1617541521","product_id":100046801,"comment_content":"对电商系统没有开发经验，按我个人理解简单说一下，错误之处肯请老师指正：<br><br>编程语言：首选Java，技术栈：前后端分离，前端: vue框架，后端：Spring系列框架<br>第三方框架：Spring MVC或Spring Boot，数据持久化框架：MyBatis或Hibernate<br>存储系统：采用关系型数据库 + 非关系型数据库，对于基础业务数据、报表数据等用关系型数据，对于类似于订单、日志等大数据可以采用Mongo等非关系型数据库；为提高数据处理和查询性能，适当采用数据库集群，用Redis等内存型数据库做缓存。<br>","like_count":0,"discussions":[{"author":{"id":1302746,"avatar":"http://thirdwx.qlogo.cn/mmopen/vi_32/DYAIOgq83eoWfXendN7czHpsyaWKLPK6Na9P5czquJ7Wdre4TibZQ5SQib88edyuib3LpCVFkp0gII2wyvvR8tEIA/132","nickname":"OM","note":"","ucode":"E33C66A70802A5","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":387388,"discussion_content":"要考虑公司人力成本等方面怎么多架构投入硬件方面都已经很大的","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1628147340,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":282958,"user_name":"神经蛙","can_delete":false,"product_type":"c1","uid":2195592,"ip_address":"","ucode":"95468E310BF43E","user_header":"https://static001.geekbang.org/account/avatar/00/21/80/88/62a1a427.jpg","comment_is_top":false,"comment_ctime":1615475124,"is_pvip":false,"discussion_count":2,"race_medal":0,"score":"1615475124","product_id":100046801,"comment_content":"老师，订单关联的商品信息应该如何存储比较好。比如用户下了个订单，订单中包含了名称为A的商品，后续这个商品的名称被修改为了B，或者商品图片等等信息被修改了，但实际需求是让用户看到的订单商品信息是下单那一刻的信息，也就是名称为商品A，所以这时候应该不能直接关联现有的商品表。而且实际业务场景中可能不仅仅是这些简单的数据，可能还包含了 商品分类、商品价格信息等。所以这些数据应该如何存储比较好呢？","like_count":0,"discussions":[{"author":{"id":2297346,"avatar":"https://static001.geekbang.org/account/avatar/00/23/0e/02/41099234.jpg","nickname":"Django...","note":"","ucode":"56693F8A886FF0","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":366930,"discussion_content":"是个值得解决的问题","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1618219457,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1886331,"avatar":"https://static001.geekbang.org/account/avatar/00/1c/c8/7b/153181d7.jpg","nickname":"夜辉","note":"","ucode":"9421385F51FF9E","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":365652,"discussion_content":"感觉前一位提到的”订单快照“的存储策略相关","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1617858599,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":278265,"user_name":"flyCoder","can_delete":false,"product_type":"c1","uid":1074897,"ip_address":"","ucode":"82FB7B60775978","user_header":"https://static001.geekbang.org/account/avatar/00/10/66/d1/8664c464.jpg","comment_is_top":false,"comment_ctime":1612850895,"is_pvip":true,"discussion_count":0,"race_medal":0,"score":"1612850895","product_id":100046801,"comment_content":"买了很久了，第一次阅读过来打卡，假期间要把他学完","like_count":0},{"had_liked":false,"id":250831,"user_name":"亚林","can_delete":false,"product_type":"c1","uid":1018972,"ip_address":"","ucode":"4A5A6D24314B79","user_header":"https://static001.geekbang.org/account/avatar/00/0f/8c/5c/3f164f66.jpg","comment_is_top":false,"comment_ctime":1601256420,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1601256420","product_id":100046801,"comment_content":"人人都是产品经理的起源","like_count":0},{"had_liked":false,"id":220458,"user_name":"的苹果","can_delete":false,"product_type":"c1","uid":1531921,"ip_address":"","ucode":"9C64380548612B","user_header":"https://static001.geekbang.org/account/avatar/00/17/60/11/fbee204e.jpg","comment_is_top":false,"comment_ctime":1590246248,"is_pvip":true,"replies":[{"id":"81462","content":"希望这门课程能对你有所帮助。","user_name":"作者回复","user_name_real":"李玥","uid":"1501046","ctime":1590368727,"ip_address":"","comment_id":220458,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1590246248","product_id":100046801,"comment_content":"早就想学习电商系统是如何设计的，谢谢老师的精彩解说。","like_count":0,"discussions":[{"author":{"id":1501046,"avatar":"https://static001.geekbang.org/account/avatar/00/16/e7/76/79c1f23a.jpg","nickname":"李玥","note":"","ucode":"B19E91EE248591","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":496147,"discussion_content":"希望这门课程能对你有所帮助。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1590368727,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":208643,"user_name":"hk","can_delete":false,"product_type":"c1","uid":1057377,"ip_address":"","ucode":"92996CA0BCDD66","user_header":"https://static001.geekbang.org/account/avatar/00/10/22/61/580bb3c3.jpg","comment_is_top":false,"comment_ctime":1587395418,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1587395418","product_id":100046801,"comment_content":"老师，问下做类似促销、报价系统各种规则处理你们有没有用到规则引擎？还有状态流转相对是最复杂的，你们状态机是自研的吗？","like_count":0},{"had_liked":false,"id":188739,"user_name":"划过天空阿忠","can_delete":false,"product_type":"c1","uid":1036370,"ip_address":"","ucode":"9D9BEE73031E40","user_header":"https://static001.geekbang.org/account/avatar/00/0f/d0/52/014accaf.jpg","comment_is_top":false,"comment_ctime":1584409935,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1584409935","product_id":100046801,"comment_content":"评论也是能涨知识的，不仅本节课看完，本节课的评论也都看完！","like_count":0},{"had_liked":false,"id":182130,"user_name":"Alex_Shen","can_delete":false,"product_type":"c1","uid":1198156,"ip_address":"","ucode":"2B6AC79A2971A5","user_header":"https://static001.geekbang.org/account/avatar/00/12/48/4c/29b0d5ae.jpg","comment_is_top":false,"comment_ctime":1582715019,"is_pvip":true,"replies":[{"id":"70573","content":"分布式文件系统和对象存储我们都会涉及到，敬请期待。","user_name":"作者回复","user_name_real":"李玥","uid":"1501046","ctime":1582768174,"ip_address":"","comment_id":182130,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1582715019","product_id":100046801,"comment_content":"老师存储不应该是像NFS,ceph这种吗","like_count":0,"discussions":[{"author":{"id":1501046,"avatar":"https://static001.geekbang.org/account/avatar/00/16/e7/76/79c1f23a.jpg","nickname":"李玥","note":"","ucode":"B19E91EE248591","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":485231,"discussion_content":"分布式文件系统和对象存储我们都会涉及到，敬请期待。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1582768174,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]}]}