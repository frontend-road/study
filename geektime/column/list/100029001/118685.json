{"id":118685,"title":"35 | OpenRestyï¼šæ›´çµæ´»çš„WebæœåŠ¡å™¨","content":"<p>åœ¨ä¸Šä¸€è®²é‡Œï¼Œæˆ‘ä»¬çœ‹åˆ°äº†é«˜æ€§èƒ½çš„WebæœåŠ¡å™¨Nginxï¼Œå®ƒèµ„æºå ç”¨å°‘ï¼Œå¤„ç†èƒ½åŠ›é«˜ï¼Œæ˜¯æ­å»ºç½‘ç«™çš„é¦–é€‰ã€‚</p><p>è™½ç„¶Nginxæˆä¸ºäº†WebæœåŠ¡å™¨é¢†åŸŸæ— å¯äº‰è®®çš„â€œç‹è€…â€ï¼Œä½†å®ƒä¹Ÿå¹¶ä¸æ˜¯æ²¡æœ‰ç¼ºç‚¹çš„ï¼Œæ¯•ç«Ÿå®ƒå·²ç»15å²äº†ã€‚</p><p>â€œä¸€ä¸ªäººå¾ˆéš¾è¶…è¶Šæ—¶ä»£ï¼Œè€Œæ—¶ä»£å´å¯ä»¥è½»æ˜“è¶…è¶Šæ‰€æœ‰äººâ€ï¼ŒNginxå½“åˆè®¾è®¡æ—¶é’ˆå¯¹çš„åº”ç”¨åœºæ™¯å·²ç»å‘ç”Ÿäº†å˜åŒ–ï¼Œå®ƒçš„ä¸€äº›ç¼ºç‚¹ä¹Ÿå°±æš´éœ²å‡ºæ¥äº†ã€‚</p><p>Nginxçš„æœåŠ¡ç®¡ç†æ€è·¯å»¶ç»­äº†å½“æ—¶çš„æµè¡Œåšæ³•ï¼Œä½¿ç”¨ç£ç›˜ä¸Šçš„é™æ€é…ç½®æ–‡ä»¶ï¼Œæ‰€ä»¥æ¯æ¬¡ä¿®æ”¹åå¿…é¡»é‡å¯æ‰èƒ½ç”Ÿæ•ˆã€‚</p><p>è¿™åœ¨ä¸šåŠ¡é¢‘ç¹å˜åŠ¨çš„æ—¶å€™æ˜¯éå¸¸è‡´å‘½çš„ï¼ˆä¾‹å¦‚æµè¡Œçš„å¾®æœåŠ¡æ¶æ„ï¼‰ï¼Œç‰¹åˆ«æ˜¯å¯¹äºæ‹¥æœ‰æˆåƒä¸Šä¸‡å°æœåŠ¡å™¨çš„ç½‘ç«™æ¥è¯´ï¼Œä»…ä»…å¢åŠ æˆ–è€…åˆ é™¤ä¸€è¡Œé…ç½®å°±è¦åˆ†å‘ã€é‡å¯æ‰€æœ‰çš„æœºå™¨ï¼Œå¯¹è¿ç»´æ˜¯ä¸€ä¸ªéå¸¸å¤§çš„æŒ‘æˆ˜ï¼Œè¦è€—è´¹å¾ˆå¤šçš„æ—¶é—´å’Œç²¾åŠ›ï¼Œæˆæœ¬å¾ˆé«˜ï¼Œå¾ˆä¸çµæ´»ï¼Œéš¾ä»¥â€œéšéœ€åº”å˜â€ã€‚</p><p>é‚£ä¹ˆï¼Œæœ‰æ²¡æœ‰è¿™æ ·çš„ä¸€ä¸ªWebæœåŠ¡å™¨ï¼Œå®ƒæœ‰Nginxçš„ä¼˜ç‚¹å´æ²¡æœ‰Nginxçš„ç¼ºç‚¹ï¼Œæ—¢è½»é‡çº§ã€é«˜æ€§èƒ½ï¼Œåˆçµæ´»ã€å¯åŠ¨æ€é…ç½®å‘¢ï¼Ÿ</p><p>è¿™å°±æ˜¯æˆ‘ä»Šå¤©è¦è¯´çš„OpenRestyï¼Œå®ƒæ˜¯ä¸€ä¸ªâ€œæ›´å¥½æ›´çµæ´»çš„Nginxâ€ã€‚</p><h2>OpenRestyæ˜¯ä»€ä¹ˆï¼Ÿ</h2><p>å…¶å®ä½ å¯¹OpenRestyå¹¶ä¸é™Œç”Ÿï¼Œè¿™ä¸ªä¸“æ çš„å®éªŒç¯å¢ƒå°±æ˜¯ç”¨OpenRestyæ­å»ºçš„ï¼Œè¿™ä¹ˆå¤šèŠ‚è¯¾ç¨‹ä¸‹æ¥ï¼Œä½ åº”è¯¥æˆ–å¤šæˆ–å°‘å¯¹å®ƒæœ‰äº†ä¸€äº›å°è±¡å§ã€‚</p><!-- [[[read_end]]] --><p>OpenRestyè¯ç”Ÿäº2009å¹´ï¼Œåˆ°ç°åœ¨åˆšå¥½æ»¡10å‘¨å²ã€‚å®ƒçš„åˆ›é€ è€…æ˜¯å½“æ—¶å°±èŒäºæŸå®çš„â€œç¥çº§â€ç¨‹åºå‘˜<strong>ç« äº¦æ˜¥</strong>ï¼Œç½‘åå«â€œagentzhâ€ã€‚</p><p>OpenRestyå¹¶ä¸æ˜¯ä¸€ä¸ªå…¨æ–°çš„WebæœåŠ¡å™¨ï¼Œè€Œæ˜¯åŸºäºNginxï¼Œå®ƒåˆ©ç”¨äº†Nginxæ¨¡å—åŒ–ã€å¯æ‰©å±•çš„ç‰¹æ€§ï¼Œå¼€å‘äº†ä¸€ç³»åˆ—çš„å¢å¼ºæ¨¡å—ï¼Œå¹¶æŠŠå®ƒä»¬æ‰“åŒ…æ•´åˆï¼Œå½¢æˆäº†ä¸€ä¸ª<strong>â€œä¸€ç«™å¼â€çš„Webå¼€å‘å¹³å°</strong>ã€‚</p><p>è™½ç„¶OpenRestyçš„æ ¸å¿ƒæ˜¯Nginxï¼Œä½†å®ƒåˆè¶…è¶Šäº†Nginxï¼Œå…³é”®å°±åœ¨äºå…¶ä¸­çš„ngx_luaæ¨¡å—ï¼ŒæŠŠå°å·§çµæ´»çš„Luaè¯­è¨€åµŒå…¥äº†Nginxï¼Œå¯ä»¥ç”¨è„šæœ¬çš„æ–¹å¼æ“ä½œNginxå†…éƒ¨çš„è¿›ç¨‹ã€å¤šè·¯å¤ç”¨ã€é˜¶æ®µå¼å¤„ç†ç­‰å„ç§æ„ä»¶ã€‚</p><p>è„šæœ¬è¯­è¨€çš„å¥½å¤„ä½ ä¸€å®šçŸ¥é“ï¼Œå®ƒä¸éœ€è¦ç¼–è¯‘ï¼Œéšå†™éšæ‰§è¡Œï¼Œè¿™å°±å…å»äº†Cè¯­è¨€ç¼–å†™æ¨¡å—æ¼«é•¿çš„å¼€å‘å‘¨æœŸã€‚è€Œä¸”OpenRestyè¿˜æŠŠLuaè‡ªèº«çš„åç¨‹ä¸Nginxçš„äº‹ä»¶æœºåˆ¶å®Œç¾ç»“åˆåœ¨ä¸€èµ·ï¼Œä¼˜é›…åœ°å®ç°äº†è®¸å¤šå…¶ä»–è¯­è¨€æ‰€æ²¡æœ‰çš„â€œ<strong>åŒæ­¥éé˜»å¡</strong>â€ç¼–ç¨‹èŒƒå¼ï¼Œèƒ½å¤Ÿè½»æ¾å¼€å‘å‡ºé«˜æ€§èƒ½çš„Webåº”ç”¨ã€‚</p><p>ç›®å‰OpenRestyæœ‰ä¸¤ä¸ªåˆ†æ”¯ï¼Œåˆ†åˆ«æ˜¯å¼€æºã€å…è´¹çš„â€œOpenRestyâ€å’Œé—­æºã€å•†ä¸šäº§å“çš„â€œOpenResty+â€ï¼Œè¿ä½œæ–¹å¼æœ‰ç¤¾åŒºæ”¯æŒã€OpenRestyåŸºé‡‘ä¼šã€OpenResty.Incå…¬å¸ï¼Œè¿˜æœ‰å…¶ä»–çš„ä¸€äº›å¤–ç•ŒèµåŠ©ï¼ˆä¾‹å¦‚Kongã€CloudFlareï¼‰ï¼Œæ­£åœ¨è“¬å‹ƒå‘å±•ã€‚</p><p><img src=\"https://static001.geekbang.org/resource/image/9f/01/9f7b79c43c476890f03c2c716a20f301.png?wh=1142*481\" alt=\"unpreview\"></p><p>é¡ºä¾¿è¯´ä¸€ä¸‹OpenRestyçš„å®˜æ–¹logoï¼Œæ˜¯ä¸€åªå±•ç¿…é£ç¿”çš„æµ·é¸¥ï¼Œé€‰æ‹©æµ·é¸¥æ˜¯å› ä¸ºâ€œé¸¥â€ä¸OpenRestyçš„å‘éŸ³ç›¸åŒã€‚å¦å¤–ï¼Œè¿™ä¸ªlogoçš„å½¢çŠ¶ä¹Ÿåƒæ˜¯å·¦æ‰‹æ¯”å‡ºçš„ä¸€ä¸ªâ€œOKâ€å§¿åŠ¿ï¼Œæ­£å¥½ä¹Ÿæ˜¯ä¸€ä¸ªâ€œOâ€ã€‚</p><h2>åŠ¨æ€çš„Lua</h2><p>åˆšæ‰è¯´äº†ï¼ŒOpenRestyé‡Œçš„ä¸€ä¸ªå…³é”®æ¨¡å—æ˜¯ngx_luaï¼Œå®ƒä¸ºNginxå¼•å…¥äº†è„šæœ¬è¯­è¨€Luaã€‚</p><p>Luaæ˜¯ä¸€ä¸ªæ¯”è¾ƒâ€œå°ä¼—â€çš„è¯­è¨€ï¼Œè™½ç„¶å†å²æ¯”è¾ƒæ‚ ä¹…ï¼Œä½†åæ°”å´æ²¡æœ‰PHPã€Pythonã€JavaScriptå¤§ï¼Œè¿™ä¸»è¦ä¸å®ƒçš„è‡ªèº«å®šä½æœ‰å…³ã€‚</p><p><img src=\"https://static001.geekbang.org/resource/image/4f/d5/4f24aa3f53969b71baaf7d9c7cf68fd5.png?wh=1142*641\" alt=\"unpreview\"></p><p>Luaçš„è®¾è®¡ç›®æ ‡æ˜¯åµŒå…¥åˆ°å…¶ä»–åº”ç”¨ç¨‹åºé‡Œè¿è¡Œï¼Œä¸ºå…¶ä»–ç¼–ç¨‹è¯­è¨€å¸¦æ¥â€œè„šæœ¬åŒ–â€èƒ½åŠ›ï¼Œæ‰€ä»¥å®ƒçš„â€œä¸ªå¤´â€æ¯”è¾ƒå°ï¼ŒåŠŸèƒ½é›†æœ‰é™ï¼Œä¸è¿½æ±‚â€œå¤§è€Œå…¨â€ï¼Œè€Œæ˜¯â€œå°è€Œç¾â€ï¼Œå¤§å¤šæ•°æ—¶é—´éƒ½â€œéšåŒ¿â€åœ¨å…¶ä»–åº”ç”¨ç¨‹åºçš„åé¢ï¼Œæ˜¯â€œæ— åè‹±é›„â€ã€‚</p><p>ä½ æˆ–è®¸ç©è¿‡æˆ–è€…å¬è¯´è¿‡ã€Šé­”å…½ä¸–ç•Œã€‹ã€Šæ„¤æ€’çš„å°é¸Ÿã€‹å§ï¼Œå®ƒä»¬å°±åœ¨å†…éƒ¨åµŒå…¥äº†Luaï¼Œä½¿ç”¨Luaæ¥è°ƒç”¨åº•å±‚æ¥å£ï¼Œå……å½“â€œèƒ¶æ°´è¯­è¨€â€ï¼ˆglue languageï¼‰ï¼Œç¼–å†™æ¸¸æˆé€»è¾‘è„šæœ¬ï¼Œæé«˜å¼€å‘æ•ˆç‡ã€‚</p><p>OpenRestyé€‰æ‹©Luaä½œä¸ºâ€œå·¥ä½œè¯­è¨€â€ä¹Ÿæ˜¯åŸºäºåŒæ ·çš„è€ƒè™‘ã€‚å› ä¸ºNginx Cå¼€å‘å®åœ¨æ˜¯å¤ªéº»çƒ¦äº†ï¼Œé™åˆ¶äº†Nginxçš„çœŸæ­£å®åŠ›ã€‚è€ŒLuaä½œä¸ºâ€œæœ€å¿«çš„è„šæœ¬è¯­è¨€â€æ°å¥½å¯ä»¥æˆä¸ºNginxçš„å®Œç¾æ­æ¡£ï¼Œæ—¢å¯ä»¥ç®€åŒ–å¼€å‘ï¼Œæ€§èƒ½ä¸Šåˆä¸ä¼šæœ‰å¤ªå¤šçš„æŸè€—ã€‚</p><p>ä½œä¸ºè„šæœ¬è¯­è¨€ï¼ŒLuaè¿˜æœ‰ä¸€ä¸ªé‡è¦çš„â€œ<strong>ä»£ç çƒ­åŠ è½½</strong>â€ç‰¹æ€§ï¼Œä¸éœ€è¦é‡å¯è¿›ç¨‹ï¼Œå°±èƒ½å¤Ÿä»ç£ç›˜ã€Redisæˆ–è€…ä»»ä½•å…¶ä»–åœ°æ–¹åŠ è½½æ•°æ®ï¼Œéšæ—¶æ›¿æ¢å†…å­˜é‡Œçš„ä»£ç ç‰‡æ®µã€‚è¿™å°±å¸¦æ¥äº†â€œ<strong>åŠ¨æ€é…ç½®</strong>â€ï¼Œè®©OpenRestyèƒ½å¤Ÿæ°¸ä¸åœæœºï¼Œåœ¨å¾®ç§’ã€æ¯«ç§’çº§åˆ«å®ç°é…ç½®å’Œä¸šåŠ¡é€»è¾‘çš„å®æ—¶æ›´æ–°ï¼Œæ¯”èµ·Nginxç§’çº§çš„é‡å¯æ˜¯ä¸€ä¸ªæå¤§çš„è¿›æ­¥ã€‚</p><p>ä½ å¯ä»¥çœ‹ä¸€ä¸‹å®éªŒç¯å¢ƒçš„â€œwww/luaâ€ç›®å½•ï¼Œé‡Œé¢å­˜æ”¾äº†æˆ‘å†™çš„ä¸€äº›æµ‹è¯•HTTPç‰¹æ€§çš„Luaè„šæœ¬ï¼Œä»£ç éƒ½éå¸¸ç®€å•æ˜“æ‡‚ï¼Œå°±åƒæ˜¯æ™®é€šçš„è‹±è¯­â€œé˜…è¯»ç†è§£â€ï¼Œè¿™ä¹Ÿæ˜¯Luaçš„å¦ä¸€ä¸ªä¼˜åŠ¿ï¼šæ˜“å­¦ä¹ ã€æ˜“ä¸Šæ‰‹ã€‚</p><h2>é«˜æ•ˆç‡çš„Lua</h2><p>OpenRestyèƒ½å¤Ÿé«˜æ•ˆè¿è¡Œçš„ä¸€å¤§â€œç§˜æŠ€â€æ˜¯å®ƒçš„â€œ<strong>åŒæ­¥éé˜»å¡</strong>â€ç¼–ç¨‹èŒƒå¼ï¼Œå¦‚æœä½ è¦å¼€å‘OpenRestyåº”ç”¨å°±å¿…é¡»æ—¶åˆ»é“­è®°äºå¿ƒã€‚</p><p>â€œåŒæ­¥éé˜»å¡â€æœ¬è´¨ä¸Šè¿˜æ˜¯ä¸€ç§â€œ<strong>å¤šè·¯å¤ç”¨</strong>â€ï¼Œæˆ‘æ‹¿ä¸Šä¸€è®²çš„Nginx epollæ¥å¯¹æ¯”è§£é‡Šä¸€ä¸‹ã€‚</p><p>epollæ˜¯æ“ä½œç³»ç»Ÿçº§åˆ«çš„â€œå¤šè·¯å¤ç”¨â€ï¼Œè¿è¡Œåœ¨å†…æ ¸ç©ºé—´ã€‚è€ŒOpenRestyçš„â€œåŒæ­¥éé˜»å¡â€åˆ™æ˜¯åŸºäºLuaå†…å»ºçš„â€œ<strong>åç¨‹</strong>â€ï¼Œæ˜¯åº”ç”¨ç¨‹åºçº§åˆ«çš„â€œå¤šè·¯å¤ç”¨â€ï¼Œè¿è¡Œåœ¨ç”¨æˆ·ç©ºé—´ï¼Œæ‰€ä»¥å®ƒçš„èµ„æºæ¶ˆè€—è¦æ›´å°‘ã€‚</p><p>OpenRestyé‡Œæ¯ä¸€æ®µLuaç¨‹åºéƒ½ç”±åç¨‹æ¥è°ƒåº¦è¿è¡Œã€‚å’ŒLinuxçš„epollä¸€æ ·ï¼Œæ¯å½“å¯èƒ½å‘ç”Ÿé˜»å¡çš„æ—¶å€™â€œåç¨‹â€å°±ä¼šç«‹åˆ»åˆ‡æ¢å‡ºå»ï¼Œæ‰§è¡Œå…¶ä»–çš„ç¨‹åºã€‚è¿™æ ·å•ä¸ªå¤„ç†æµç¨‹æ˜¯â€œé˜»å¡â€çš„ï¼Œä½†æ•´ä¸ªOpenRestyå´æ˜¯â€œéé˜»å¡çš„â€ï¼Œå¤šä¸ªç¨‹åºéƒ½â€œå¤ç”¨â€åœ¨ä¸€ä¸ªLuaè™šæ‹Ÿæœºé‡Œè¿è¡Œã€‚</p><p><img src=\"https://static001.geekbang.org/resource/image/9f/c6/9fc3df52df7d6c11aa02b8013f8e9bc6.png?wh=2159*909\" alt=\"\"></p><p>ä¸‹é¢çš„ä»£ç æ˜¯ä¸€ä¸ªç®€å•çš„ä¾‹å­ï¼Œè¯»å–POSTå‘é€çš„bodyæ•°æ®ï¼Œç„¶åå†å‘å›å®¢æˆ·ç«¯ï¼š</p><pre><code>ngx.req.read_body()                  -- åŒæ­¥éé˜»å¡(1)\n\nlocal data = ngx.req.get_body_data()\nif data then\n    ngx.print(&quot;body: &quot;, data)        -- åŒæ­¥éé˜»å¡(2)\nend\n</code></pre><p>ä»£ç ä¸­çš„â€œngx.req.read_bodyâ€å’Œâ€œngx.printâ€åˆ†åˆ«æ˜¯æ•°æ®çš„æ”¶å‘åŠ¨ä½œï¼Œåªæœ‰æ”¶åˆ°æ•°æ®æ‰èƒ½å‘é€æ•°æ®ï¼Œæ‰€ä»¥æ˜¯â€œåŒæ­¥â€çš„ã€‚</p><p>ä½†å³ä½¿å› ä¸ºç½‘ç»œåŸå› æ²¡æ”¶åˆ°æˆ–è€…å‘ä¸å‡ºå»ï¼ŒOpenRestyä¹Ÿä¸ä¼šåœ¨è¿™é‡Œé˜»å¡â€œå¹²ç­‰ç€â€ï¼Œè€Œæ˜¯åšä¸ªâ€œè®°å·â€ï¼ŒæŠŠç­‰å¾…çš„è¿™æ®µCPUæ—¶é—´ç”¨æ¥å¤„ç†å…¶ä»–çš„è¯·æ±‚ï¼Œç­‰ç½‘ç»œå¯è¯»æˆ–è€…å¯å†™æ—¶å†â€œå›æ¥â€æ¥ç€è¿è¡Œã€‚</p><p>å‡è®¾æ”¶å‘æ•°æ®çš„ç­‰å¾…æ—¶é—´æ˜¯10æ¯«ç§’ï¼Œè€ŒçœŸæ­£CPUå¤„ç†çš„æ—¶é—´æ˜¯0.1æ¯«ç§’ï¼Œé‚£ä¹ˆOpenRestyå°±å¯ä»¥åœ¨è¿™10æ¯«ç§’å†…åŒæ—¶å¤„ç†100ä¸ªè¯·æ±‚ï¼Œè€Œä¸æ˜¯æŠŠè¿™100ä¸ªè¯·æ±‚é˜»å¡æ’é˜Ÿï¼Œç”¨1000æ¯«ç§’æ¥å¤„ç†ã€‚</p><p>é™¤äº†â€œåŒæ­¥éé˜»å¡â€ï¼ŒOpenRestyè¿˜é€‰ç”¨äº†<strong>LuaJIT</strong>ä½œä¸ºLuaè¯­è¨€çš„â€œè¿è¡Œæ—¶ï¼ˆRuntimeï¼‰â€ï¼Œè¿›ä¸€æ­¥â€œæŒ–æ½œå¢æ•ˆâ€ã€‚</p><p>LuaJITæ˜¯ä¸€ä¸ªé«˜æ•ˆçš„Luaè™šæ‹Ÿæœºï¼Œæ”¯æŒJITï¼ˆJust In Timeï¼‰æŠ€æœ¯ï¼Œå¯ä»¥æŠŠLuaä»£ç å³æ—¶ç¼–è¯‘æˆâ€œæœ¬åœ°æœºå™¨ç â€ï¼Œè¿™æ ·å°±æ¶ˆé™¤äº†è„šæœ¬è¯­è¨€è§£é‡Šè¿è¡Œçš„åŠ£åŠ¿ï¼Œè®©Luaè„šæœ¬è·‘å¾—å’ŒåŸç”ŸCä»£ç ä¸€æ ·å¿«ã€‚</p><p>å¦å¤–ï¼ŒLuaJITè¿˜ä¸ºLuaè¯­è¨€æ·»åŠ äº†ä¸€äº›ç‰¹åˆ«çš„å¢å¼ºï¼Œæ¯”å¦‚äºŒè¿›åˆ¶ä½è¿ç®—åº“bitï¼Œå†…å­˜ä¼˜åŒ–åº“tableï¼Œè¿˜æœ‰FFIï¼ˆForeign Function Interfaceï¼‰ï¼Œè®©Luaç›´æ¥è°ƒç”¨åº•å±‚Cå‡½æ•°ï¼Œæ¯”åŸç”Ÿçš„å‹æ ˆè°ƒç”¨å¿«å¾ˆå¤šã€‚</p><h2>é˜¶æ®µå¼å¤„ç†</h2><p>å’ŒNginxä¸€æ ·ï¼ŒOpenRestyä¹Ÿä½¿ç”¨â€œæµæ°´çº¿â€æ¥å¤„ç†HTTPè¯·æ±‚ï¼Œåº•å±‚çš„è¿è¡ŒåŸºç¡€æ˜¯Nginxçš„â€œé˜¶æ®µå¼å¤„ç†â€ï¼Œä½†å®ƒåˆæœ‰è‡ªå·±çš„ç‰¹è‰²ã€‚</p><p>Nginxçš„â€œæµæ°´çº¿â€æ˜¯ç”±ä¸€ä¸ªä¸ªCæ¨¡å—ç»„æˆçš„ï¼Œåªèƒ½åœ¨é™æ€æ–‡ä»¶é‡Œé…ç½®ï¼Œå¼€å‘å›°éš¾ï¼Œé…ç½®éº»çƒ¦ï¼ˆç›¸å¯¹è€Œè¨€ï¼‰ã€‚è€ŒOpenRestyçš„â€œæµæ°´çº¿â€åˆ™æ˜¯ç”±ä¸€ä¸ªä¸ªçš„Luaè„šæœ¬ç»„æˆçš„ï¼Œä¸ä»…å¯ä»¥ä»ç£ç›˜ä¸ŠåŠ è½½ï¼Œä¹Ÿå¯ä»¥ä»Redisã€MySQLé‡ŒåŠ è½½ï¼Œè€Œä¸”ç¼–å†™ã€è°ƒè¯•çš„è¿‡ç¨‹éå¸¸æ–¹ä¾¿å¿«æ·ã€‚</p><p>ä¸‹é¢æˆ‘ç”»äº†ä¸€å¼ å›¾ï¼Œåˆ—å‡ºäº†OpenRestyçš„é˜¶æ®µï¼Œæ¯”èµ·Nginxï¼ŒOpenRestyçš„é˜¶æ®µæ›´æ³¨é‡å¯¹HTTPè¯·æ±‚å“åº”æŠ¥æ–‡çš„åŠ å·¥å’Œå¤„ç†ã€‚</p><p><img src=\"https://static001.geekbang.org/resource/image/36/df/3689312a970bae0e949b017ad45438df.png?wh=1211*1437\" alt=\"\"></p><p>OpenRestyé‡Œæœ‰å‡ ä¸ªé˜¶æ®µä¸Nginxæ˜¯ç›¸åŒçš„ï¼Œæ¯”å¦‚rewriteã€accessã€contentã€filterï¼Œè¿™äº›éƒ½æ˜¯æ ‡å‡†çš„HTTPå¤„ç†ã€‚</p><p>åœ¨è¿™å‡ ä¸ªé˜¶æ®µé‡Œå¯ä»¥ç”¨â€œxxx_by_luaâ€æŒ‡ä»¤åµŒå…¥Luaä»£ç ï¼Œæ‰§è¡Œé‡å®šå‘è·³è½¬ã€è®¿é—®æ§åˆ¶ã€äº§ç”Ÿå“åº”ã€è´Ÿè½½å‡è¡¡ã€è¿‡æ»¤æŠ¥æ–‡ç­‰åŠŸèƒ½ã€‚å› ä¸ºLuaçš„è„šæœ¬è¯­è¨€ç‰¹æ€§ï¼Œä¸ç”¨è€ƒè™‘å†…å­˜åˆ†é…ã€èµ„æºå›æ”¶é‡Šæ”¾ç­‰åº•å±‚çš„ç»†èŠ‚é—®é¢˜ï¼Œå¯ä»¥ä¸“æ³¨äºç¼–å†™éå¸¸å¤æ‚çš„ä¸šåŠ¡é€»è¾‘ï¼Œæ¯”Cæ¨¡å—çš„å¼€å‘æ•ˆç‡é«˜å¾ˆå¤šï¼Œå³æ˜“äºæ‰©å±•åˆæ˜“äºç»´æŠ¤ã€‚</p><p>OpenRestyé‡Œè¿˜æœ‰ä¸¤ä¸ªä¸åŒäºNginxçš„ç‰¹æ®Šé˜¶æ®µã€‚</p><p>ä¸€ä¸ªæ˜¯â€œ<strong>inité˜¶æ®µ</strong>â€ï¼Œå®ƒåˆåˆ†æˆâ€œmaster initâ€å’Œâ€œworker initâ€ï¼Œåœ¨masterè¿›ç¨‹å’Œworkerè¿›ç¨‹å¯åŠ¨çš„æ—¶å€™è¿è¡Œã€‚è¿™ä¸ªé˜¶æ®µè¿˜æ²¡æœ‰å¼€å§‹æä¾›æœåŠ¡ï¼Œæ‰€ä»¥æ…¢ä¸€ç‚¹ä¹Ÿæ²¡å…³ç³»ï¼Œå¯ä»¥è°ƒç”¨ä¸€äº›é˜»å¡çš„æ¥å£åˆå§‹åŒ–æœåŠ¡å™¨ï¼Œæ¯”å¦‚è¯»å–ç£ç›˜ã€MySQLï¼ŒåŠ è½½é»‘ç™½åå•æˆ–è€…æ•°æ®æ¨¡å‹ï¼Œç„¶åæ”¾è¿›å…±äº«å†…å­˜é‡Œä¾›è¿è¡Œæ—¶ä½¿ç”¨ã€‚</p><p>å¦ä¸€ä¸ªæ˜¯â€œ<strong>sslé˜¶æ®µ</strong>â€ï¼Œè¿™ç®—å¾—ä¸Šæ˜¯OpenRestyçš„ä¸€å¤§åˆ›ä¸¾ï¼Œå¯ä»¥åœ¨TLSæ¡æ‰‹æ—¶åŠ¨æ€åŠ è½½è¯ä¹¦ï¼Œæˆ–è€…å‘é€â€œOCSP Staplingâ€ã€‚</p><p>è¿˜è®°å¾—<a href=\"https://time.geekbang.org/column/article/111940\">ç¬¬29è®²</a>é‡Œè¯´çš„â€œSNIæ‰©å±•â€å—ï¼ŸNginxå¯ä»¥ä¾æ®â€œæœåŠ¡å™¨åç§°æŒ‡ç¤ºâ€æ¥é€‰æ‹©è¯ä¹¦å®ç°HTTPSè™šæ‹Ÿä¸»æœºï¼Œä½†é™æ€é…ç½®å¾ˆä¸çµæ´»ï¼Œè¦ç¼–å†™å¾ˆå¤šé›·åŒçš„é…ç½®å—ã€‚è™½ç„¶åæ¥Nginxå¢åŠ äº†å˜é‡æ”¯æŒï¼Œä½†å®ƒæ¯æ¬¡æ¡æ‰‹éƒ½è¦è¯»ç£ç›˜ï¼Œæ•ˆç‡å¾ˆä½ã€‚</p><p>è€Œåœ¨OpenRestyé‡Œå°±å¯ä»¥ä½¿ç”¨æŒ‡ä»¤â€œssl_certificate_by_luaâ€ï¼Œç¼–å†™Luaè„šæœ¬ï¼Œè¯»å–SNIåå­—åï¼Œç›´æ¥ä»å…±äº«å†…å­˜æˆ–è€…Redisé‡Œè·å–è¯ä¹¦ã€‚ä¸ä»…æ²¡æœ‰è¯»ç›˜é˜»å¡ï¼Œè€Œä¸”è¯ä¹¦ä¹Ÿæ˜¯å®Œå…¨åŠ¨æ€å¯é…ç½®çš„ï¼Œæ— éœ€ä¿®æ”¹é…ç½®æ–‡ä»¶å°±èƒ½å¤Ÿè½»æ¾æ”¯æŒå¤§é‡çš„HTTPSè™šæ‹Ÿä¸»æœºã€‚</p><h2>å°ç»“</h2><ol>\n<li><span class=\"orange\">Nginxä¾èµ–äºç£ç›˜ä¸Šçš„é™æ€é…ç½®æ–‡ä»¶ï¼Œä¿®æ”¹åå¿…é¡»é‡å¯æ‰èƒ½ç”Ÿæ•ˆï¼Œç¼ºä¹çµæ´»æ€§ï¼›</span></li>\n<li><span class=\"orange\">OpenRestyåŸºäºNginxï¼Œæ‰“åŒ…äº†å¾ˆå¤šæœ‰ç”¨çš„æ¨¡å—å’Œåº“ï¼Œæ˜¯ä¸€ä¸ªé«˜æ€§èƒ½çš„Webå¼€å‘å¹³å°ï¼›</span></li>\n<li><span class=\"orange\">OpenRestyçš„å·¥ä½œè¯­è¨€æ˜¯Luaï¼Œå®ƒå°å·§çµæ´»ï¼Œæ‰§è¡Œæ•ˆç‡é«˜ï¼Œæ”¯æŒâ€œä»£ç çƒ­åŠ è½½â€ï¼›</span></li>\n<li><span class=\"orange\">OpenRestyçš„æ ¸å¿ƒç¼–ç¨‹èŒƒå¼æ˜¯â€œåŒæ­¥éé˜»å¡â€ï¼Œä½¿ç”¨åç¨‹ï¼Œä¸éœ€è¦å¼‚æ­¥å›è°ƒå‡½æ•°ï¼›</span></li>\n<li><span class=\"orange\">OpenRestyä¹Ÿä½¿ç”¨â€œé˜¶æ®µå¼å¤„ç†â€çš„å·¥ä½œæ¨¡å¼ï¼Œä½†å› ä¸ºåœ¨é˜¶æ®µé‡Œæ‰§è¡Œçš„éƒ½æ˜¯Luaä»£ç ï¼Œæ‰€ä»¥éå¸¸çµæ´»ï¼Œé…åˆRedisç­‰å¤–éƒ¨æ•°æ®åº“èƒ½å¤Ÿå®ç°å„ç§åŠ¨æ€é…ç½®ã€‚</span></li>\n</ol><h2>è¯¾ä¸‹ä½œä¸š</h2><ol>\n<li>è°ˆä¸€ä¸‹è¿™äº›å¤©ä½ å¯¹å®éªŒç¯å¢ƒé‡ŒOpenRestyçš„æ„Ÿæƒ³å’Œè®¤è¯†ã€‚</li>\n<li>ä½ è§‰å¾—Nginxå’ŒOpenRestyçš„â€œé˜¶æ®µå¼å¤„ç†â€æœ‰ä»€ä¹ˆå¥½å¤„ï¼Ÿå¯¹ä½ çš„å®é™…å·¥ä½œæœ‰æ²¡æœ‰å¯å‘ï¼Ÿ</li>\n</ol><p>æ¬¢è¿ä½ æŠŠè‡ªå·±çš„å­¦ä¹ ä½“ä¼šå†™åœ¨ç•™è¨€åŒºï¼Œä¸æˆ‘å’Œå…¶ä»–åŒå­¦ä¸€èµ·è®¨è®ºã€‚å¦‚æœä½ è§‰å¾—æœ‰æ‰€æ”¶è·ï¼Œä¹Ÿæ¬¢è¿æŠŠæ–‡ç« åˆ†äº«ç»™ä½ çš„æœ‹å‹ã€‚</p><p><img src=\"https://static001.geekbang.org/resource/image/c5/9f/c5b7ac40c585c800af0fe3ab98f3449f.png?wh=1769*4723\" alt=\"unpreview\"></p><p></p>","comments":[{"had_liked":false,"id":124739,"user_name":"é”¦","can_delete":false,"product_type":"c1","uid":1468298,"ip_address":"","ucode":"CB0EB4B68C468B","user_header":"https://static001.geekbang.org/account/avatar/00/16/67/8a/babd74dc.jpg","comment_is_top":false,"comment_ctime":1565957382,"is_pvip":false,"replies":[{"id":"46190","content":"è‹±æ–‡æ˜¯I&#47;O multiplexingï¼Œå°±æ˜¯æŒ‡å¤šä¸ªI&#47;Oè¯·æ±‚â€œå¤ç”¨â€åˆ°ä¸€ä¸ªè¿›ç¨‹æˆ–çº¿ç¨‹é‡Œå¤„ç†ï¼Œè€Œä¸æ˜¯å¼€å¤šä¸ªè¿›ç¨‹ã€çº¿ç¨‹å¤„ç†ã€‚<br><br>å¯ä»¥çœ‹ç¤ºæ„å›¾å†ä½“ä¼šä¸€ä¸‹ã€‚","user_name":"ä½œè€…å›å¤","user_name_real":"chrono","uid":"1181974","ctime":1566261979,"ip_address":"","comment_id":124739,"utype":1}],"discussion_count":1,"race_medal":0,"score":"100350205190","product_id":100029001,"comment_content":"è€å¸ˆå¥½ï¼Œå¤šè·¯å¤ç”¨ç†è§£èµ·æ¥æœ‰ç‚¹å›°éš¾ï¼Œä¸»è¯­æ˜¯ä»€ä¹ˆå‘¢ï¼Ÿ å¤šè·¯  å¤ç”¨åˆ†åˆ«æ€ä¹ˆç†è§£å‘¢ï¼Ÿ","like_count":24,"discussions":[{"author":{"id":1181974,"avatar":"https://static001.geekbang.org/account/avatar/00/12/09/16/1161017c.jpg","nickname":"ç½—å‰‘é”‹","note":"","ucode":"95678C988F24AB","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":463302,"discussion_content":"è‹±æ–‡æ˜¯I/O multiplexingï¼Œå°±æ˜¯æŒ‡å¤šä¸ªI/Oè¯·æ±‚â€œå¤ç”¨â€åˆ°ä¸€ä¸ªè¿›ç¨‹æˆ–çº¿ç¨‹é‡Œå¤„ç†ï¼Œè€Œä¸æ˜¯å¼€å¤šä¸ªè¿›ç¨‹ã€çº¿ç¨‹å¤„ç†ã€‚\n\nå¯ä»¥çœ‹ç¤ºæ„å›¾å†ä½“ä¼šä¸€ä¸‹ã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1566261979,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":124974,"user_name":"é˜¿é”‹","can_delete":false,"product_type":"c1","uid":1127761,"ip_address":"","ucode":"7AF449ABA89242","user_header":"https://static001.geekbang.org/account/avatar/00/11/35/51/c616f95a.jpg","comment_is_top":false,"comment_ctime":1566031156,"is_pvip":false,"replies":[{"id":"46185","content":"wwwæ˜¯â€œä¸»æœºåâ€ï¼Œä¹Ÿå°±æ˜¯è¡¨ç¤ºè¿™å°ä¸»æœºç”¨äºæä¾›ä¸‡ç»´ç½‘æœåŠ¡ã€‚<br><br>ä½†ç°åœ¨å¤§éƒ¨åˆ†äº’è”ç½‘ä¸Šçš„ä¸»æœºéƒ½æ˜¯httpæœåŠ¡å™¨ï¼Œæ‰€ä»¥wwwç°åœ¨åªæ˜¯ä¸€ä¸ªâ€œå†å²ä¹ æƒ¯â€äº†ï¼Œæ¯”å¦‚æå®¢æ—¶é—´çš„ç½‘ç«™â€œtime.geekbang.orgâ€ï¼Œè™½ç„¶ä¸æ˜¯wwwï¼Œä½†ä¹Ÿæ˜¯httpæœåŠ¡ã€‚<br><br>ä¸å¸¦wwwæ˜¯åŸŸåçš„ä¸€ç§ç®€åŒ–ï¼Œé€šå¸¸ä¼šä½¿ç”¨é‡å®šå‘è·³è½¬åˆ°å…¶ä»–çš„åŸŸåã€‚","user_name":"ä½œè€…å›å¤","user_name_real":"chrono","uid":"1181974","ctime":1566261593,"ip_address":"","comment_id":124974,"utype":1}],"discussion_count":1,"race_medal":0,"score":"53105638708","product_id":100029001,"comment_content":"åŸŸåä¸€èˆ¬éƒ½æ˜¯å¸¦wwwï¼Œä¹Ÿå¯ä»¥ä¸å¸¦wwwï¼Œè¿™ä¸¤è€…æœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿwwwçš„ä½œç”¨æ˜¯ä»€ä¹ˆï¼Ÿ","like_count":12,"discussions":[{"author":{"id":1181974,"avatar":"https://static001.geekbang.org/account/avatar/00/12/09/16/1161017c.jpg","nickname":"ç½—å‰‘é”‹","note":"","ucode":"95678C988F24AB","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":463386,"discussion_content":"wwwæ˜¯â€œä¸»æœºåâ€ï¼Œä¹Ÿå°±æ˜¯è¡¨ç¤ºè¿™å°ä¸»æœºç”¨äºæä¾›ä¸‡ç»´ç½‘æœåŠ¡ã€‚\n\nä½†ç°åœ¨å¤§éƒ¨åˆ†äº’è”ç½‘ä¸Šçš„ä¸»æœºéƒ½æ˜¯httpæœåŠ¡å™¨ï¼Œæ‰€ä»¥wwwç°åœ¨åªæ˜¯ä¸€ä¸ªâ€œå†å²ä¹ æƒ¯â€äº†ï¼Œæ¯”å¦‚æå®¢æ—¶é—´çš„ç½‘ç«™â€œtime.geekbang.orgâ€ï¼Œè™½ç„¶ä¸æ˜¯wwwï¼Œä½†ä¹Ÿæ˜¯httpæœåŠ¡ã€‚\n\nä¸å¸¦wwwæ˜¯åŸŸåçš„ä¸€ç§ç®€åŒ–ï¼Œé€šå¸¸ä¼šä½¿ç”¨é‡å®šå‘è·³è½¬åˆ°å…¶ä»–çš„åŸŸåã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1566261593,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":125357,"user_name":"é—«é£","can_delete":false,"product_type":"c1","uid":1013162,"ip_address":"","ucode":"30C782D30108D4","user_header":"https://static001.geekbang.org/account/avatar/00/0f/75/aa/21275b9d.jpg","comment_is_top":false,"comment_ctime":1566173694,"is_pvip":false,"replies":[{"id":"46167","content":"å¯¹ã€‚","user_name":"ä½œè€…å›å¤","user_name_real":"chrono","uid":"1181974","ctime":1566260258,"ip_address":"","comment_id":125357,"utype":1}],"discussion_count":1,"race_medal":0,"score":"48810813950","product_id":100029001,"comment_content":"çœ‹èµ·æ¥OpenRestyçš„æ ¸å¿ƒæ­¦å™¨æ˜¯åç¨‹æ¨¡å‹å’ŒLuaè¯­è¨€åµŒå…¥èåˆï¼Œåˆç†ç…§é¡¾åˆ°äº†å¼€å‘æ•ˆç‡å’Œç¨‹åºæ‰§è¡Œæ•ˆç‡ä¹‹é—´çš„å¹³è¡¡ã€‚","like_count":11,"discussions":[{"author":{"id":1181974,"avatar":"https://static001.geekbang.org/account/avatar/00/12/09/16/1161017c.jpg","nickname":"ç½—å‰‘é”‹","note":"","ucode":"95678C988F24AB","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":463542,"discussion_content":"å¯¹ã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1566260258,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":124575,"user_name":"-W.LI-","can_delete":false,"product_type":"c1","uid":1210699,"ip_address":"","ucode":"3556786538664F","user_header":"https://static001.geekbang.org/account/avatar/00/12/79/4b/740f91ca.jpg","comment_is_top":false,"comment_ctime":1565922806,"is_pvip":false,"replies":[{"id":"45756","content":"<br>1.åŸºæœ¬æ­£ç¡®ï¼Œä½†åŒæ­¥é˜»å¡çš„æ—¶å€™æ˜¯è¿™ä¸ªçº¿ç¨‹è¢«é˜»å¡äº†ï¼Œæ“ä½œç³»ç»Ÿä¼šæŠŠè¿™ä¸ªçº¿ç¨‹åˆ‡æ¢å‡ºå»å¹²åˆ«çš„ï¼Œä¸ä¼šè€—cpuï¼Œç›¸å½“äºè¿™ä¸ªçº¿ç¨‹æ²¡æœ‰å……åˆ†åˆ©ç”¨cpuç»™å®ƒçš„èµ„æºã€‚<br><br>2.åŒæ­¥éé˜»å¡ï¼Œæ˜¯çº¿ç¨‹è‡ªå·±ä¸»åŠ¨åˆ‡æ¢cpuç»™å…¶ä»–ä»»åŠ¡ï¼Œä½†å¹¶æ²¡æœ‰è®©å‡ºcpuç»™å…¶ä»–çº¿ç¨‹æˆ–è¿›ç¨‹ï¼Œå› ä¸ºåœ¨ç”¨æˆ·æ€ï¼Œæ‰€ä»¥æˆæœ¬ä½ï¼Œåº•å±‚æ˜¯epollå’ŒNginxçš„äº‹ä»¶æœºåˆ¶ã€‚<br><br>3.æœ‰è¶…æ—¶æœºåˆ¶ï¼Œè¶…æ—¶å°±ä¼šä»»åŠ¡æ‰§è¡Œå¤±è´¥ï¼Œä¸ä¼šæ­»é”ã€‚<br><br>4.OpenRestyçš„ä»£ç éƒ½æ˜¯åŒæ­¥éé˜»å¡çš„ã€‚","user_name":"ä½œè€…å›å¤","user_name_real":"chrono","uid":"1181974","ctime":1565926046,"ip_address":"","comment_id":124575,"utype":1}],"discussion_count":1,"race_medal":0,"score":"27335726582","product_id":100029001,"comment_content":"è€å¸ˆå¥½!<br>åŒæ­¥é˜»å¡:ä»£ç åŒæ­¥é¡ºåºæ‰§è¡Œï¼Œç­‰å¾…é˜»å¡æ“ä½œå®Œæˆç»§ç»­å¾€ä¸‹èµ°ã€‚<br>åŒæ­¥éé˜»å¡:ä»£ç é¡ºåºæ‰§è¡Œï¼Œé‡è§é˜»å¡æ“ä½œæ—¶ï¼ŒCPUæ‰§è¡Œä¸–é—´ä¼šè®©å‡ºå»ï¼Œå¾—åˆ°ç»“æœæ—¶é€šè¿‡callBackç»§ç»­å›åˆ°ä¹‹å‰é˜»å¡çš„åœ°æ–¹ã€‚<br>å¤§æ¦‚æ˜¯è¿™æ ·ä¹ˆ?<br>ç„¶åå°±æ˜¯åŒæ­¥é˜»å¡çš„è¯ï¼Œåœ¨é˜»å¡çš„æ—¶å€™ä¼šå ç”¨CPUæ‰§è¡Œæ—¶é—´ä¹ˆ?<br>åŒæ­¥éé˜»å¡çš„è¯ï¼Œé‡åˆ°é˜»å¡æ“ä½œï¼Œä¸»çº¿ç¨‹ç›´æ¥è®©å‡ºCPUæ‰§è¡Œæ—¶é—´ï¼Œä¸Šä¸‹æ–‡ä¼šåˆ‡æ¢ä¹ˆ?ä¸Šä¸‹æ–‡åˆ‡æ¢å¼€é”€ä¼šå¾ˆå¤§å§ï¼Œå¦‚æœåªæ˜¯è®©å‡ºæ€ä¹ˆå®ç°é˜»å¡æ•°æ®æ²¡å°±ç»ªæ—¶ä¸è¢«åˆ†é…cpuï¼Œå¦‚æœä¸€ç›´æ²¡å›è°ƒè¿™ä¸ªçº¿ç¨‹ä¼šæ­»é”ä¹ˆ?<br>ä»£ç ä¸­è¯·æ±‚ï¼Œredisï¼Œæ•°æ®åº“è¿™äº›æ“ä½œæ˜¯åŒæ­¥é˜»å¡ï¼Œè¿˜æ˜¯åŒæ­¥éé˜»å¡?<br><br>","like_count":7,"discussions":[{"author":{"id":1181974,"avatar":"https://static001.geekbang.org/account/avatar/00/12/09/16/1161017c.jpg","nickname":"ç½—å‰‘é”‹","note":"","ucode":"95678C988F24AB","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":463231,"discussion_content":"\n1.åŸºæœ¬æ­£ç¡®ï¼Œä½†åŒæ­¥é˜»å¡çš„æ—¶å€™æ˜¯è¿™ä¸ªçº¿ç¨‹è¢«é˜»å¡äº†ï¼Œæ“ä½œç³»ç»Ÿä¼šæŠŠè¿™ä¸ªçº¿ç¨‹åˆ‡æ¢å‡ºå»å¹²åˆ«çš„ï¼Œä¸ä¼šè€—cpuï¼Œç›¸å½“äºè¿™ä¸ªçº¿ç¨‹æ²¡æœ‰å……åˆ†åˆ©ç”¨cpuç»™å®ƒçš„èµ„æºã€‚\n\n2.åŒæ­¥éé˜»å¡ï¼Œæ˜¯çº¿ç¨‹è‡ªå·±ä¸»åŠ¨åˆ‡æ¢cpuç»™å…¶ä»–ä»»åŠ¡ï¼Œä½†å¹¶æ²¡æœ‰è®©å‡ºcpuç»™å…¶ä»–çº¿ç¨‹æˆ–è¿›ç¨‹ï¼Œå› ä¸ºåœ¨ç”¨æˆ·æ€ï¼Œæ‰€ä»¥æˆæœ¬ä½ï¼Œåº•å±‚æ˜¯epollå’ŒNginxçš„äº‹ä»¶æœºåˆ¶ã€‚\n\n3.æœ‰è¶…æ—¶æœºåˆ¶ï¼Œè¶…æ—¶å°±ä¼šä»»åŠ¡æ‰§è¡Œå¤±è´¥ï¼Œä¸ä¼šæ­»é”ã€‚\n\n4.OpenRestyçš„ä»£ç éƒ½æ˜¯åŒæ­¥éé˜»å¡çš„ã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1565926046,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":126920,"user_name":"ä¸šä½™è‰","can_delete":false,"product_type":"c1","uid":1126538,"ip_address":"","ucode":"99BDC1E629049D","user_header":"https://static001.geekbang.org/account/avatar/00/11/30/8a/b5ca7286.jpg","comment_is_top":false,"comment_ctime":1566521722,"is_pvip":false,"replies":[{"id":"46954","content":"å¯ä»¥çœ‹å®ä½“ä¹¦ã€ŠOpenRestyå®Œå…¨å¼€å‘æŒ‡å—ã€‹ã€‚","user_name":"ä½œè€…å›å¤","user_name_real":"chrono","uid":"1181974","ctime":1566524897,"ip_address":"","comment_id":126920,"utype":1}],"discussion_count":1,"race_medal":0,"score":"23041358202","product_id":100029001,"comment_content":"è€å¸ˆä¸å†™OpenRestyä¸“æ äºæ‰äº†","like_count":6,"discussions":[{"author":{"id":1181974,"avatar":"https://static001.geekbang.org/account/avatar/00/12/09/16/1161017c.jpg","nickname":"ç½—å‰‘é”‹","note":"","ucode":"95678C988F24AB","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":464243,"discussion_content":"å¯ä»¥çœ‹å®ä½“ä¹¦ã€ŠOpenRestyå®Œå…¨å¼€å‘æŒ‡å—ã€‹ã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1566524897,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":124718,"user_name":"djfhchdh","can_delete":false,"product_type":"c1","uid":1484184,"ip_address":"","ucode":"E71D75328CE398","user_header":"https://static001.geekbang.org/account/avatar/00/16/a5/98/a65ff31a.jpg","comment_is_top":false,"comment_ctime":1565950750,"is_pvip":false,"replies":[{"id":"46174","content":"good","user_name":"ä½œè€…å›å¤","user_name_real":"chrono","uid":"1181974","ctime":1566260591,"ip_address":"","comment_id":124718,"utype":1}],"discussion_count":1,"race_medal":0,"score":"18745819934","product_id":100029001,"comment_content":"2ã€â€œé˜¶æ®µå¼å¤„ç†â€ï¼Œæˆ‘çš„ç†è§£è¿™ä¸ªä¸â€œæµæ°´çº¿â€å¾ˆåƒï¼Œè®¸å¤šçš„ä¸šåŠ¡æµç¨‹æ¨¡å‹å…¶å®éƒ½å¯ä»¥æŠ½è±¡ä¸ºæµæ°´çº¿ï¼Œé€šè¿‡é…ç½®åŒ–çš„æ–¹æ³•ï¼Œå¯ä»¥å®šåˆ¶åŒ–åœ°æŠŠå„ä¸ªæ¨¡å—ç»„æˆä¸šåŠ¡æµæ°´çº¿","like_count":4,"discussions":[{"author":{"id":1181974,"avatar":"https://static001.geekbang.org/account/avatar/00/12/09/16/1161017c.jpg","nickname":"ç½—å‰‘é”‹","note":"","ucode":"95678C988F24AB","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":463295,"discussion_content":"good","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1566260591,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":282717,"user_name":"Aemon","can_delete":false,"product_type":"c1","uid":1547049,"ip_address":"","ucode":"E868D0F50BA484","user_header":"","comment_is_top":false,"comment_ctime":1615374539,"is_pvip":false,"replies":[{"id":"102625","content":"æˆ‘æ›¾ç»è§è¿‡ä¸€ä¸ªNginxå®ä¾‹é‡å¯ï¼Œè¦åŠ è½½å‡ ç™¾å‡ åƒä¸ªé…ç½®æ–‡ä»¶ï¼Œé‚£é€Ÿåº¦â€¦â€¦","user_name":"ä½œè€…å›å¤","user_name_real":"ç½—å‰‘é”‹","uid":"1181974","ctime":1615422095,"ip_address":"","comment_id":282717,"utype":1}],"discussion_count":1,"race_medal":0,"score":"14500276427","product_id":100029001,"comment_content":"nginx reloadä¸å½±å“åº”ç”¨å§ï¼Ÿç§’çº§æ˜¯è®¤çœŸçš„å—ï¼Ÿ","like_count":3,"discussions":[{"author":{"id":1181974,"avatar":"https://static001.geekbang.org/account/avatar/00/12/09/16/1161017c.jpg","nickname":"ç½—å‰‘é”‹","note":"","ucode":"95678C988F24AB","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":516819,"discussion_content":"æˆ‘æ›¾ç»è§è¿‡ä¸€ä¸ªNginxå®ä¾‹é‡å¯ï¼Œè¦åŠ è½½å‡ ç™¾å‡ åƒä¸ªé…ç½®æ–‡ä»¶ï¼Œé‚£é€Ÿåº¦â€¦â€¦","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1615422095,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":246501,"user_name":"dahai","can_delete":false,"product_type":"c1","uid":1762705,"ip_address":"","ucode":"9F866FC42DF9A8","user_header":"https://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTIVR2wY9icec2CGzZ4VKPdwK2icytM5k1tHm08qSEysFOgl1y7lk2ccDqSCvzibHufo2Cb9c2hjr0LIg/132","comment_is_top":false,"comment_ctime":1599379916,"is_pvip":false,"replies":[{"id":"90614","content":"reloadè¦è¯»å–ç£ç›˜æ–‡ä»¶ï¼Œè€Œé…ç½®æ–‡ä»¶å¤æ‚çš„è¯è¿™å°±æœ‰ä¸€å®šçš„æˆæœ¬ï¼Œè€Œä¸”é‡å¯è¿›ç¨‹çš„æ¶ˆè€—ä¹Ÿæ˜¯ä¸å®¹å¿½è§†çš„ã€‚","user_name":"ä½œè€…å›å¤","user_name_real":"ç½—å‰‘é”‹","uid":"1181974","ctime":1599440934,"ip_address":"","comment_id":246501,"utype":1}],"discussion_count":1,"race_medal":3,"score":"10189314508","product_id":100029001,"comment_content":"Nginx çš„æœåŠ¡ç®¡ç†æ€è·¯å»¶ç»­äº†å½“æ—¶çš„æµè¡Œåšæ³•ï¼Œä½¿ç”¨ç£ç›˜ä¸Šçš„é™æ€é…ç½®æ–‡ä»¶ï¼Œæ‰€ä»¥æ¯æ¬¡ä¿®æ”¹åå¿…é¡»é‡å¯æ‰èƒ½ç”Ÿæ•ˆã€‚<br>Nginx æœ‰reload å‘½ä»¤ï¼Œåªæ˜¯ä¸æ˜¯è‡ªåŠ¨reloadã€‚","like_count":2,"discussions":[{"author":{"id":1181974,"avatar":"https://static001.geekbang.org/account/avatar/00/12/09/16/1161017c.jpg","nickname":"ç½—å‰‘é”‹","note":"","ucode":"95678C988F24AB","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":505165,"discussion_content":"reloadè¦è¯»å–ç£ç›˜æ–‡ä»¶ï¼Œè€Œé…ç½®æ–‡ä»¶å¤æ‚çš„è¯è¿™å°±æœ‰ä¸€å®šçš„æˆæœ¬ï¼Œè€Œä¸”é‡å¯è¿›ç¨‹çš„æ¶ˆè€—ä¹Ÿæ˜¯ä¸å®¹å¿½è§†çš„ã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1599440934,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":202707,"user_name":"é’±","can_delete":false,"product_type":"c1","uid":1009652,"ip_address":"","ucode":"2C92A243A463D4","user_header":"https://static001.geekbang.org/account/avatar/00/0f/67/f4/9a1feb59.jpg","comment_is_top":false,"comment_ctime":1586055651,"is_pvip":false,"replies":[{"id":"76043","content":"<br>1.åç¨‹åªæ˜¯åŒæ­¥éé˜»å¡çš„ä¸€ç§å®ç°æ–¹å¼ï¼Œä¸¤è€…ä¸å®Œå…¨ç­‰åŒã€‚<br><br>2.OpenRestyé‡Œçš„çº¿ç¨‹å…¶å®æ˜¯åç¨‹ï¼Œå†…éƒ¨æœ‰è°ƒåº¦å™¨ï¼Œå½“æœ‰é˜»å¡çš„æ—¶å€™å°±åˆ‡æ¢åˆ°å…¶ä»–çš„åç¨‹ï¼ˆä»»åŠ¡ï¼‰å»æ‰§è¡Œã€‚<br><br>3.åç¨‹ä¸»åŠ¨yieldåå°±å‡ºäºæš‚åœçŠ¶æ€ï¼Œå¯ä»¥éšæ—¶åˆ‡æ¢å›æ¥ç»§ç»­æ‰§è¡Œï¼Œæ‰€ä»¥å®ƒè‡ªå·±æ˜¯é˜»å¡çš„ï¼Œä½†æ•´ä¸ªç¨‹åºä¸ä¼šå› ä¸ºä¸€ä¸ªåç¨‹è€Œè¢«é˜»å¡ã€‚<br><br>4.å¯ä»¥å‚è€ƒå…¶ä»–è¯­è¨€é‡Œçš„åç¨‹æ¦‚å¿µæ¥ç†è§£ã€‚è®°ä½åç¨‹æ˜¯ç”¨æˆ·æ€çš„çº¿ç¨‹ï¼Œè€Œåœ¨æ“ä½œç³»ç»Ÿæ¥çœ‹å®é™…ä¸Šåªè¦ä¸€ä¸ªçº¿ç¨‹ï¼Œæ‰€ä»¥å¦‚æœæœ‰å¤§é‡çš„ç£ç›˜ioé‚£ä¹ˆå¿…ç„¶ä¼šé˜»å¡ã€‚","user_name":"ä½œè€…å›å¤","user_name_real":"chrono","uid":"1181974","ctime":1586222476,"ip_address":"","comment_id":202707,"utype":1}],"discussion_count":1,"race_medal":0,"score":"10175990243","product_id":100029001,"comment_content":"åŒæ­¥éé˜»å¡ï¼Œæ˜¯çº¿ç¨‹è‡ªå·±ä¸»åŠ¨åˆ‡æ¢cpuç»™å…¶ä»–ä»»åŠ¡ï¼Œä½†å¹¶æ²¡æœ‰è®©å‡ºcpuç»™å…¶ä»–çº¿ç¨‹æˆ–è¿›ç¨‹ï¼Œå› ä¸ºåœ¨ç”¨æˆ·æ€ï¼Œæ‰€ä»¥æˆæœ¬ä½ï¼Œåº•å±‚æ˜¯epollå’ŒNginxçš„äº‹ä»¶æœºåˆ¶ã€‚<br><br>è€å¸ˆï¼Œè¿™å—æ²¡å¤ªæ˜ç™½ï¼ŒåŒæ­¥å’Œéé˜»å¡åŸæœ¬æ˜¯çŸ›ç›¾çš„ï¼Œä¸€ä¸ªå¤§åŠ¨ä½œç”±å¤šä¸ªå°åŠ¨ä½œç»„æˆï¼Œå¦‚æœå…¶ä¸­ä¸€ä¸ªå°åŠ¨ä½œæ˜¯ä¸€ä¸ªæ…¢åŠ¨ä½œï¼Œè€Œä¸”æ˜¯åŒæ­¥æ¨¡å¼ï¼Œä¸‹é¢çš„åŠ¨ä½œå¿…ç„¶ä¼šè¢«é˜»å¡ä½å§ï¼Ÿ<br>ä½ ä¸Šé¢è§£é‡Šè¯´â€œçº¿ç¨‹è‡ªå·±ä¸»åŠ¨åˆ‡æ¢CPUç»™å…¶ä»–ä»»åŠ¡â€ï¼Œ<br>1ï¼šé‚£çº¿ç¨‹ä»€ä¹ˆæ—¶å€™ä¸»åŠ¨åˆ‡æ¢CPUç»™å…¶ä»–ä»»åŠ¡ï¼Ÿ<br>2ï¼šè¿™é‡Œçš„å…¶ä»–ä»»åŠ¡æŒ‡ä»€ä¹ˆï¼Ÿ<br>3ï¼šçº¿ç¨‹ä¸»åŠ¨åˆ‡æ¢CPUç»™å…¶ä»–ä»»åŠ¡åå¤„äºä»€ä¹ˆçŠ¶æ€ï¼Ÿä¸ºä»€ä¹ˆï¼Ÿ<br>5ï¼šè¿˜æœ‰æˆ‘çš„å‡è®¾ä¸­æ…¢åŠ¨ä½œåé¢çš„åŠ¨ä½œä¸æ˜¯è¢«é˜»å¡äº†å—ï¼Ÿ<br>6ï¼šè¿˜æ˜¯è¯´ç»´åº¦ä¸å±‚æ¬¡ä¸åŒï¼ŒåŒæ­¥éé˜»å¡çš„ä¸»ä½“æ˜¯çº¿ç¨‹ï¼Œè€Œä¸æ˜¯çº¿ç¨‹ä¸­çš„ä¸€ç³»åˆ—åŠ¨ä½œï¼Ÿ","like_count":2,"discussions":[{"author":{"id":1181974,"avatar":"https://static001.geekbang.org/account/avatar/00/12/09/16/1161017c.jpg","nickname":"ç½—å‰‘é”‹","note":"","ucode":"95678C988F24AB","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":490658,"discussion_content":"\n1.åç¨‹åªæ˜¯åŒæ­¥éé˜»å¡çš„ä¸€ç§å®ç°æ–¹å¼ï¼Œä¸¤è€…ä¸å®Œå…¨ç­‰åŒã€‚\n\n2.OpenRestyé‡Œçš„çº¿ç¨‹å…¶å®æ˜¯åç¨‹ï¼Œå†…éƒ¨æœ‰è°ƒåº¦å™¨ï¼Œå½“æœ‰é˜»å¡çš„æ—¶å€™å°±åˆ‡æ¢åˆ°å…¶ä»–çš„åç¨‹ï¼ˆä»»åŠ¡ï¼‰å»æ‰§è¡Œã€‚\n\n3.åç¨‹ä¸»åŠ¨yieldåå°±å‡ºäºæš‚åœçŠ¶æ€ï¼Œå¯ä»¥éšæ—¶åˆ‡æ¢å›æ¥ç»§ç»­æ‰§è¡Œï¼Œæ‰€ä»¥å®ƒè‡ªå·±æ˜¯é˜»å¡çš„ï¼Œä½†æ•´ä¸ªç¨‹åºä¸ä¼šå› ä¸ºä¸€ä¸ªåç¨‹è€Œè¢«é˜»å¡ã€‚\n\n4.å¯ä»¥å‚è€ƒå…¶ä»–è¯­è¨€é‡Œçš„åç¨‹æ¦‚å¿µæ¥ç†è§£ã€‚è®°ä½åç¨‹æ˜¯ç”¨æˆ·æ€çš„çº¿ç¨‹ï¼Œè€Œåœ¨æ“ä½œç³»ç»Ÿæ¥çœ‹å®é™…ä¸Šåªè¦ä¸€ä¸ªçº¿ç¨‹ï¼Œæ‰€ä»¥å¦‚æœæœ‰å¤§é‡çš„ç£ç›˜ioé‚£ä¹ˆå¿…ç„¶ä¼šé˜»å¡ã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1586222476,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":124711,"user_name":"-W.LI-","can_delete":false,"product_type":"c1","uid":1210699,"ip_address":"","ucode":"3556786538664F","user_header":"https://static001.geekbang.org/account/avatar/00/12/79/4b/740f91ca.jpg","comment_is_top":false,"comment_ctime":1565949580,"is_pvip":false,"replies":[{"id":"46540","content":"åŸºæœ¬æ­£ç¡®ã€‚ä¸è¿‡Nginxé‡Œæ²¡æœ‰ä½¿ç”¨åç¨‹ï¼Œå®ƒä½¿ç”¨çš„æ˜¯epollçš„äº‹ä»¶æœºåˆ¶ï¼Œå‘epollæ³¨å†Œsocketçš„è¯»å†™äº‹ä»¶ï¼Œå½“socketå¯è¯»å¯å†™æ—¶è°ƒç”¨å“åº”çš„å¤„ç†å‡½æ•°ã€‚<br><br>ä½ è¯´çš„åç¨‹æ˜¯åº”ç”¨åœ¨OpenRestyçš„Luaè™šæ‹Ÿæœºé‡Œã€‚","user_name":"ä½œè€…å›å¤","user_name_real":"chrono","uid":"1181974","ctime":1566355931,"ip_address":"","comment_id":124711,"utype":1}],"discussion_count":1,"race_medal":0,"score":"10155884172","product_id":100029001,"comment_content":"è€å¸ˆå¥½!çœ‹å®Œå›å¤å¥½åƒæ˜ç™½äº†ä¸€ç‚¹<br>åŒæ­¥éé˜»å¡:nginxï¼Œæ˜¯å•çº¿ç¨‹æ¨¡å‹ï¼Œä¸»çº¿ç¨‹ç±»ä¼¼ä¸€ä¸ªå¤šè·¯å¤ç”¨å™¨(å’ŒNIOçš„IOæ¨¡å‹ç±»ä¼¼?)ï¼Œæ‰€æœ‰çš„è¯·æ±‚æ˜¯ä»¥ä»»åŠ¡å½¢å¼è¢«å—ç†ï¼Œä»»åŠ¡æ˜¯äº¤ç»™åç¨‹ç¨‹å¤„ç†ã€‚ä»»åŠ¡ç»“æŸï¼Œä¸»çº¿ç¨‹æ£€æµ‹åˆ°äº‹ä»¶è¿›è¡Œå¯¹åº”æ“ä½œã€‚ä¸»çº¿ç¨‹å’Œåç¨‹ä¸€ç›´éƒ½åœ¨å¤„ç†ä»»åŠ¡ï¼Œæ‰€ä»¥ä¸ä¼šæ¶‰åŠåˆ°çº¿ç¨‹çš„ä¸Šä¸‹æ–‡åˆ‡æ¢ã€‚ä¼ ç»Ÿçš„webæœåŠ¡å™¨ï¼ŒTomcatè¿™äº›éƒ½æ˜¯çº¿ç¨‹æ± å½¢å¼çš„ã€‚ä¸€ä¸ªè¯·æ±‚äº¤ç»™ä¸€ä¸ªçº¿ç¨‹ï¼Œè¯·æ±‚é˜»å¡äº†è¿™ä¸ªçº¿ç¨‹å°±ä¼šè¢«åˆ‡æ¢å‡ºå»å¼€é”€å¾ˆå¤§ã€‚nginxåç¨‹å¼€é”€å·²ç»å°äº†ï¼Œåˆé€šè¿‡äº‹ä»¶+å¼‚æ­¥éé˜»å¡æ¨¡å‹å‡å°‘äº†ä¸Šä¸‹æ–‡åˆ‡æ¢æ‰€ä»¥ååé‡å°±èƒ½å¾ˆå¤§ã€‚","like_count":2,"discussions":[{"author":{"id":1181974,"avatar":"https://static001.geekbang.org/account/avatar/00/12/09/16/1161017c.jpg","nickname":"ç½—å‰‘é”‹","note":"","ucode":"95678C988F24AB","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":463291,"discussion_content":"åŸºæœ¬æ­£ç¡®ã€‚ä¸è¿‡Nginxé‡Œæ²¡æœ‰ä½¿ç”¨åç¨‹ï¼Œå®ƒä½¿ç”¨çš„æ˜¯epollçš„äº‹ä»¶æœºåˆ¶ï¼Œå‘epollæ³¨å†Œsocketçš„è¯»å†™äº‹ä»¶ï¼Œå½“socketå¯è¯»å¯å†™æ—¶è°ƒç”¨å“åº”çš„å¤„ç†å‡½æ•°ã€‚\n\nä½ è¯´çš„åç¨‹æ˜¯åº”ç”¨åœ¨OpenRestyçš„Luaè™šæ‹Ÿæœºé‡Œã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1566355931,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":124612,"user_name":"è®¸ç«¥ç«¥","can_delete":false,"product_type":"c1","uid":1003005,"ip_address":"","ucode":"4B799C0C6BC678","user_header":"https://static001.geekbang.org/account/avatar/00/0f/4d/fd/0aa0e39f.jpg","comment_is_top":false,"comment_ctime":1565927557,"is_pvip":false,"replies":[{"id":"45759","content":"OpenRestyç°åœ¨å·²ç»æ˜¯ä¸€ä¸ªæˆç†Ÿçš„Webå¼€å‘ç”Ÿæ€ä½“ç³»äº†ï¼Œå·²ç»æœ‰å¾ˆå¤šå•†ä¸šå…¬å¸åŸºäºOpenRestyå¼€å‘å„ç§ä¸šåŠ¡åº”ç”¨ï¼Œåº•å±‚çš„LuaJITæ€§èƒ½å¾ˆé«˜ï¼Œä¿è¯äº†å®ƒçš„è¿è¡Œæ•ˆç‡ã€‚<br><br>njsç°åœ¨è¿˜æ˜¯å¤„äºèµ·æ­¥é˜¶æ®µï¼ŒåŠŸèƒ½æ¯”è¾ƒå¼±ï¼ŒNginxå¯¹å®ƒçš„å®šä½æ˜¯â€œå¯ç¼–ç¨‹é…ç½®è¯­è¨€â€ï¼Œå…³æ³¨ç‚¹è¿˜æ˜¯åœ¨è¾…åŠ©Nginxï¼Œè€Œä¸æ˜¯ç”¨æ¥å¼€å‘å¤æ‚çš„ä¸šåŠ¡é€»è¾‘ã€‚<br><br>è¿˜æœ‰å¾ˆé‡è¦çš„ä¸€ç‚¹æ˜¯OpenRestyé‡Œçš„LuaJITæ”¯æŒFFIï¼Œå¯ä»¥ç›´æ¥è°ƒç”¨Cæ¥å£ï¼Œæ‰©å±•æ€§æé«˜ï¼Œè€Œnjsè¿™æ–¹é¢çš„èƒ½åŠ›ä¸ºé›¶ï¼Œåªèƒ½é™åˆ¶åœ¨vmé‡Œã€‚","user_name":"ä½œè€…å›å¤","user_name_real":"chrono","uid":"1181974","ctime":1565933641,"ip_address":"","comment_id":124612,"utype":1}],"discussion_count":1,"race_medal":0,"score":"10155862149","product_id":100029001,"comment_content":"è€å¸ˆä½ å¥½ï¼Œå¯ä»¥è¯´ä¸€ä¸‹OpenResty å’Œ nginx njs æœ‰ä»€ä¹ˆåŒºåˆ«å—ï¼Ÿ","like_count":2,"discussions":[{"author":{"id":1181974,"avatar":"https://static001.geekbang.org/account/avatar/00/12/09/16/1161017c.jpg","nickname":"ç½—å‰‘é”‹","note":"","ucode":"95678C988F24AB","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":463250,"discussion_content":"OpenRestyç°åœ¨å·²ç»æ˜¯ä¸€ä¸ªæˆç†Ÿçš„Webå¼€å‘ç”Ÿæ€ä½“ç³»äº†ï¼Œå·²ç»æœ‰å¾ˆå¤šå•†ä¸šå…¬å¸åŸºäºOpenRestyå¼€å‘å„ç§ä¸šåŠ¡åº”ç”¨ï¼Œåº•å±‚çš„LuaJITæ€§èƒ½å¾ˆé«˜ï¼Œä¿è¯äº†å®ƒçš„è¿è¡Œæ•ˆç‡ã€‚\n\nnjsç°åœ¨è¿˜æ˜¯å¤„äºèµ·æ­¥é˜¶æ®µï¼ŒåŠŸèƒ½æ¯”è¾ƒå¼±ï¼ŒNginxå¯¹å®ƒçš„å®šä½æ˜¯â€œå¯ç¼–ç¨‹é…ç½®è¯­è¨€â€ï¼Œå…³æ³¨ç‚¹è¿˜æ˜¯åœ¨è¾…åŠ©Nginxï¼Œè€Œä¸æ˜¯ç”¨æ¥å¼€å‘å¤æ‚çš„ä¸šåŠ¡é€»è¾‘ã€‚\n\nè¿˜æœ‰å¾ˆé‡è¦çš„ä¸€ç‚¹æ˜¯OpenRestyé‡Œçš„LuaJITæ”¯æŒFFIï¼Œå¯ä»¥ç›´æ¥è°ƒç”¨Cæ¥å£ï¼Œæ‰©å±•æ€§æé«˜ï¼Œè€Œnjsè¿™æ–¹é¢çš„èƒ½åŠ›ä¸ºé›¶ï¼Œåªèƒ½é™åˆ¶åœ¨vmé‡Œã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1565933641,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":124610,"user_name":"è®¸ç«¥ç«¥","can_delete":false,"product_type":"c1","uid":1003005,"ip_address":"","ucode":"4B799C0C6BC678","user_header":"https://static001.geekbang.org/account/avatar/00/0f/4d/fd/0aa0e39f.jpg","comment_is_top":false,"comment_ctime":1565927514,"is_pvip":false,"replies":[{"id":"45758","content":"è¯´çš„æŒºå¥½ã€‚<br><br>å…¶å®Nginxæœ€åˆçš„æ¨¡å—è®¾è®¡å°±æ˜¯æƒ³æŠŠé…ç½®æ–‡ä»¶å¼„æˆè¯­è¨€çš„å½¢å¼ï¼Œé€šè¿‡æ¨¡å—å®ç°æŒ‡ä»¤æ¥å¢åŠ è¯­è¨€é‡Œçš„è¯æ±‡ï¼Œä½†Nginxçš„é…ç½®æ–‡ä»¶ä¿®æ”¹åå¿…é¡»é‡å¯ï¼Œè€Œä¸”Cæ¨¡å—å¼€å‘å¤ªéº»çƒ¦ã€‚<br><br>OpenRestyå¼•å…¥LuaåCæ¨¡å—å¼€å‘çš„å°±è¶Šæ¥è¶Šå°‘äº†ï¼Œå› ä¸ºè„šæœ¬è¯­è¨€æ¯”ç®€å•çš„æŒ‡ä»¤æ›´çµæ´»ï¼Œå¼€å‘çš„æˆæœ¬ä¹Ÿæ›´ä½ã€‚","user_name":"ä½œè€…å›å¤","user_name_real":"chrono","uid":"1181974","ctime":1565933380,"ip_address":"","comment_id":124610,"utype":1}],"discussion_count":1,"race_medal":0,"score":"10155862106","product_id":100029001,"comment_content":"è°ˆä¸€ä¸‹è¿™äº›å¤©ä½ å¯¹å®éªŒç¯å¢ƒé‡Œ OpenResty çš„æ„Ÿæƒ³å’Œè®¤è¯†ã€‚<br>æˆ‘æ„Ÿè§‰æœ‰äº›æ—¶å€™ï¼Œå†™ä»£ç æ¯”å†™é…ç½®æ–‡ä»¶æ›´åŠ çµæ´»ï¼ŒOpenResty é€šè¿‡Luaè„šæœ¬å°±å¯ä»¥è¾¾åˆ°è¿™ä¸ªæ•ˆæœã€‚<br><br>ä½ è§‰å¾— Nginx å’Œ OpenResty çš„â€œé˜¶æ®µå¼å¤„ç†â€æœ‰ä»€ä¹ˆå¥½å¤„ï¼Ÿå¯¹ä½ çš„å®é™…å·¥ä½œæœ‰æ²¡æœ‰å¯å‘ï¼Ÿ<br>é˜¶æ®µå¼å¤„ç†ï¼Œæœ‰ç‚¹ç±»ä¼¼ä¸€ä¸ªç±»çš„ç”Ÿå‘½å‘¨æœŸï¼Œåˆæœ‰ç‚¹ç±»ä¼¼è´£ä»»é“¾æ¨¡å¼ã€‚å®é™…å·¥ä½œä¸­ç¼–å†™å‰ç«¯ç»„ä»¶ï¼Œä¹Ÿå¯ä»¥é‡‡å–ç±»ä¼¼çš„æ–¹å¼ï¼ŒæŠŠç»„ä»¶æ¸²æŸ“åˆ†é˜¶æ®µï¼Œç”Ÿå‘½å‘¨æœŸç»†åˆ†ï¼Œä½¿ç»„ä»¶æ›´ä¸“æ³¨æ›´å†…èšã€‚","like_count":2,"discussions":[{"author":{"id":1181974,"avatar":"https://static001.geekbang.org/account/avatar/00/12/09/16/1161017c.jpg","nickname":"ç½—å‰‘é”‹","note":"","ucode":"95678C988F24AB","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":463248,"discussion_content":"è¯´çš„æŒºå¥½ã€‚\n\nå…¶å®Nginxæœ€åˆçš„æ¨¡å—è®¾è®¡å°±æ˜¯æƒ³æŠŠé…ç½®æ–‡ä»¶å¼„æˆè¯­è¨€çš„å½¢å¼ï¼Œé€šè¿‡æ¨¡å—å®ç°æŒ‡ä»¤æ¥å¢åŠ è¯­è¨€é‡Œçš„è¯æ±‡ï¼Œä½†Nginxçš„é…ç½®æ–‡ä»¶ä¿®æ”¹åå¿…é¡»é‡å¯ï¼Œè€Œä¸”Cæ¨¡å—å¼€å‘å¤ªéº»çƒ¦ã€‚\n\nOpenRestyå¼•å…¥LuaåCæ¨¡å—å¼€å‘çš„å°±è¶Šæ¥è¶Šå°‘äº†ï¼Œå› ä¸ºè„šæœ¬è¯­è¨€æ¯”ç®€å•çš„æŒ‡ä»¤æ›´çµæ´»ï¼Œå¼€å‘çš„æˆæœ¬ä¹Ÿæ›´ä½ã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1565933380,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":166312,"user_name":"lesserror","can_delete":false,"product_type":"c1","uid":1351076,"ip_address":"","ucode":"25A54D1165FCF6","user_header":"https://static001.geekbang.org/account/avatar/00/14/9d/a4/e481ae48.jpg","comment_is_top":false,"comment_ctime":1577437039,"is_pvip":false,"replies":[{"id":"64848","content":"OpenRestyå‡ºæ¥çš„æ¯”è¾ƒæ™šï¼Œè€Œä¸”åœ¨æœ€è¿‘å‡ å¹´æ‰å¼€å§‹å•†ä¸šåŒ–æ¨å¹¿ï¼Œè‡ªç„¶è¦æ¯”Nginxçš„å¸‚åœºä»½é¢è¦å°‘ä¸€äº›ï¼Œç›¸å…³çš„èµ„æ–™ä¹Ÿå°‘ï¼Œä¸è¿‡æœ€è¿‘OpenRestyçš„å¸‚åœºå æœ‰ç‡å·²ç»å¼€å§‹å¿«é€Ÿå¢é•¿äº†ã€‚<br><br>OpenRestyå…¶å®å°±æ˜¯NginxåŠ ä¸Šä¸€äº›éå¸¸æœ‰ç”¨çš„å¼€å‘ç»„ä»¶ï¼Œæœ¬è´¨ä¸Šè¿˜æ˜¯Nginxï¼Œä½†å¼€å‘èµ·æ¥æ›´æ–¹ä¾¿ã€‚ä½†å› ä¸ºå®ƒå¤šäº†Luaç­‰å…¶ä»–ä¸œè¥¿ï¼ŒåŠŸèƒ½å·²ç»ä¸å†æ˜¯å•çº¯çš„web serverï¼Œæ‰€ä»¥ç”¨èµ·æ¥è¦å¤æ‚ä¸€ç‚¹ã€‚å¦‚æœæ˜¯å•çº¯æ­å»ºç½‘ç«™ï¼Œæ²¡æœ‰äºŒæ¬¡å¼€å‘çš„éœ€æ±‚ï¼Œè‡ªç„¶å¾ˆå¤šäººä¼šå‡ºäºç®€å•çš„ç›®çš„é€‰æ‹©Nginxï¼Œä½†æˆ‘è§‰å¾—é€‰æ‹©OpenRestyä¼šæ›´å¥½ï¼Œæ›´æœ‰æ½œåŠ›ã€‚","user_name":"ä½œè€…å›å¤","user_name_real":"chrono","uid":"1181974","ctime":1577668025,"ip_address":"","comment_id":166312,"utype":1}],"discussion_count":1,"race_medal":0,"score":"5872404335","product_id":100029001,"comment_content":"è€å¸ˆï¼Œæ—¢ç„¶OpenRestyè¿™ä¹ˆå‰å®³ï¼Œä¸ºä»€ä¹ˆç°åœ¨å¤§éƒ¨åˆ†å…¬å¸è¿˜æ˜¯ç”¨çš„Nginxå•Šï¼Ÿæˆ‘å…¬å¸éƒ½æœ‰Luaç¨‹åºå‘˜ï¼Œä½†æ˜¯WebæœåŠ¡å™¨è¿˜æ˜¯ç”¨çš„Nginxã€‚æ˜¯ä¸æ˜¯å­¦ä¹ å’Œè¿ç»´æˆæœ¬éƒ½æŒºé«˜çš„å•Šï¼Ÿ","like_count":1,"discussions":[{"author":{"id":1181974,"avatar":"https://static001.geekbang.org/account/avatar/00/12/09/16/1161017c.jpg","nickname":"ç½—å‰‘é”‹","note":"","ucode":"95678C988F24AB","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":479485,"discussion_content":"OpenRestyå‡ºæ¥çš„æ¯”è¾ƒæ™šï¼Œè€Œä¸”åœ¨æœ€è¿‘å‡ å¹´æ‰å¼€å§‹å•†ä¸šåŒ–æ¨å¹¿ï¼Œè‡ªç„¶è¦æ¯”Nginxçš„å¸‚åœºä»½é¢è¦å°‘ä¸€äº›ï¼Œç›¸å…³çš„èµ„æ–™ä¹Ÿå°‘ï¼Œä¸è¿‡æœ€è¿‘OpenRestyçš„å¸‚åœºå æœ‰ç‡å·²ç»å¼€å§‹å¿«é€Ÿå¢é•¿äº†ã€‚\n\nOpenRestyå…¶å®å°±æ˜¯NginxåŠ ä¸Šä¸€äº›éå¸¸æœ‰ç”¨çš„å¼€å‘ç»„ä»¶ï¼Œæœ¬è´¨ä¸Šè¿˜æ˜¯Nginxï¼Œä½†å¼€å‘èµ·æ¥æ›´æ–¹ä¾¿ã€‚ä½†å› ä¸ºå®ƒå¤šäº†Luaç­‰å…¶ä»–ä¸œè¥¿ï¼ŒåŠŸèƒ½å·²ç»ä¸å†æ˜¯å•çº¯çš„web serverï¼Œæ‰€ä»¥ç”¨èµ·æ¥è¦å¤æ‚ä¸€ç‚¹ã€‚å¦‚æœæ˜¯å•çº¯æ­å»ºç½‘ç«™ï¼Œæ²¡æœ‰äºŒæ¬¡å¼€å‘çš„éœ€æ±‚ï¼Œè‡ªç„¶å¾ˆå¤šäººä¼šå‡ºäºç®€å•çš„ç›®çš„é€‰æ‹©Nginxï¼Œä½†æˆ‘è§‰å¾—é€‰æ‹©OpenRestyä¼šæ›´å¥½ï¼Œæ›´æœ‰æ½œåŠ›ã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1577668025,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":349622,"user_name":"å±±é’","can_delete":false,"product_type":"c1","uid":1627670,"ip_address":"","ucode":"904AE3C23D3B92","user_header":"https://static001.geekbang.org/account/avatar/00/18/d6/16/107f0d04.jpg","comment_is_top":false,"comment_ctime":1656150492,"is_pvip":true,"replies":[{"id":"127268","content":"ç°ä»£è¯­è¨€éƒ½æ˜¯äº’ç›¸å­¦ä¹ å€Ÿé‰´ã€‚","user_name":"ä½œè€…å›å¤","user_name_real":"ç¼–è¾‘","uid":"1181974","ctime":1656299945,"ip_address":"","comment_id":349622,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1656150492","product_id":100029001,"comment_content":"è¿™ä¸ªè·ŸNginx+lua æ„Ÿè§‰è·Ÿ Golangçš„æ€æƒ³æœ‰ç‚¹åƒå•Šã€","like_count":0,"discussions":[{"author":{"id":1181974,"avatar":"https://static001.geekbang.org/account/avatar/00/12/09/16/1161017c.jpg","nickname":"ç½—å‰‘é”‹","note":"","ucode":"95678C988F24AB","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":577694,"discussion_content":"ç°ä»£è¯­è¨€éƒ½æ˜¯äº’ç›¸å­¦ä¹ å€Ÿé‰´ã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1656299945,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":340436,"user_name":"å‡ºå–çµé­‚çš„æ•™ç»ƒKerry","can_delete":false,"product_type":"c1","uid":1807943,"ip_address":"","ucode":"8C64517DA556FE","user_header":"https://static001.geekbang.org/account/avatar/00/1b/96/47/93838ff7.jpg","comment_is_top":false,"comment_ctime":1648811343,"is_pvip":true,"replies":[{"id":"124554","content":"æ²¡åœ¨openrestyé‡Œç”¨è¿‡rabbitmqï¼Œæ„Ÿè§‰é—®é¢˜æ¯”è¾ƒå¤æ‚ï¼Œä¸æ˜¯åœ¨è¿™é‡Œå›å¤èƒ½å¤Ÿè§£å†³çš„ï¼ŒæŠ±æ­‰äº†ã€‚","user_name":"ä½œè€…å›å¤","user_name_real":"ç¼–è¾‘","uid":"1181974","ctime":1648989337,"ip_address":"","comment_id":340436,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1648811343","product_id":100029001,"comment_content":"è€å¸ˆï¼Œè¯·æ•™ä¸€ä¸ªopenrestyçš„é—®é¢˜ï¼Œå®ç°ä¸€ä¸ªä¸»workerå‘rabbitmqå‘é€æ¶ˆæ¯ï¼Œåœ¨å…¶ä»–workerå°†æ¶ˆæ¯å‘é€ç»™ä¸»workerï¼Œç”±ä¸»workerä¿æŒtcpè¿æ¥ã€‚åœ¨init_worker_by_lua_blocké˜¶æ®µç”¨çš„å®šæ—¶å™¨ngx.timer.at(0, handler)å¤„ç†tcpè¿æ¥ï¼ŒåŒæ—¶åœ¨è¿™é‡Œæ³¨å†Œå›è°ƒå‡½æ•°ï¼Œå›è°ƒå‡½æ•°é‡Œå‘é€æ•°æ®ï¼Œä½†æ˜¯å›è°ƒå‡½æ•°é‡Œé¢çš„è¿æ¥å´å¤±æ•ˆäº†ï¼Ÿæ€ä¹ˆå›äº‹å‘¢ï¼Ÿ","like_count":0,"discussions":[{"author":{"id":1181974,"avatar":"https://static001.geekbang.org/account/avatar/00/12/09/16/1161017c.jpg","nickname":"ç½—å‰‘é”‹","note":"","ucode":"95678C988F24AB","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":559823,"discussion_content":"æ²¡åœ¨openrestyé‡Œç”¨è¿‡rabbitmqï¼Œæ„Ÿè§‰é—®é¢˜æ¯”è¾ƒå¤æ‚ï¼Œä¸æ˜¯åœ¨è¿™é‡Œå›å¤èƒ½å¤Ÿè§£å†³çš„ï¼ŒæŠ±æ­‰äº†ã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1648989337,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":336402,"user_name":"shk1230","can_delete":false,"product_type":"c1","uid":1701572,"ip_address":"","ucode":"9E39279C23FF8F","user_header":"https://static001.geekbang.org/account/avatar/00/19/f6/c4/e14686d4.jpg","comment_is_top":false,"comment_ctime":1646128822,"is_pvip":true,"replies":[{"id":"122973","content":"æ²¡æœ‰ç›´æ¥çš„å…³ç³»ã€‚<br><br>epollæ˜¯æ“ä½œç³»ç»Ÿçš„å¤šè·¯å¤ç”¨ï¼Œè€Œåç¨‹çš„ç¼–ç¨‹è¯­è¨€é‡Œçš„èŒƒå¼ï¼Œè€ŒopenrestyæŠŠè¿™ä¸¤è€…ç»“åˆäº†èµ·æ¥ã€‚","user_name":"ä½œè€…å›å¤","user_name_real":"ç¼–è¾‘","uid":"1181974","ctime":1646186276,"ip_address":"","comment_id":336402,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1646128822","product_id":100029001,"comment_content":"epoll å’Œåç¨‹æœ‰ä»€ä¹ˆå…³ç³»ï¼Ÿ","like_count":0,"discussions":[{"author":{"id":1181974,"avatar":"https://static001.geekbang.org/account/avatar/00/12/09/16/1161017c.jpg","nickname":"ç½—å‰‘é”‹","note":"","ucode":"95678C988F24AB","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":554007,"discussion_content":"æ²¡æœ‰ç›´æ¥çš„å…³ç³»ã€‚\n\nepollæ˜¯æ“ä½œç³»ç»Ÿçš„å¤šè·¯å¤ç”¨ï¼Œè€Œåç¨‹çš„ç¼–ç¨‹è¯­è¨€é‡Œçš„èŒƒå¼ï¼Œè€ŒopenrestyæŠŠè¿™ä¸¤è€…ç»“åˆäº†èµ·æ¥ã€‚","likes_number":1,"is_delete":false,"is_hidden":false,"ctime":1646186276,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":319047,"user_name":"åŠŸå¤«ç†ŠçŒ«","can_delete":false,"product_type":"c1","uid":2732243,"ip_address":"","ucode":"D124F4FA4E816F","user_header":"https://static001.geekbang.org/account/avatar/00/29/b0/d3/200e82ff.jpg","comment_is_top":false,"comment_ctime":1635524083,"is_pvip":true,"replies":[{"id":"115654","content":"ç°åœ¨è¿™ä¸ªæ˜¯Linuxé‡Œçš„é€šç”¨åšæ³•äº†ï¼Œä¸è¿‡åœ¨20å¹´å‰å¯ä¸æ˜¯é‚£ä¹ˆå®¹æ˜“çš„ã€‚","user_name":"ä½œè€…å›å¤","user_name_real":"ç½—å‰‘é”‹","uid":"1181974","ctime":1635596626,"ip_address":"","comment_id":319047,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1635524083","product_id":100029001,"comment_content":"ioå£å¤šè·¯å¤ç”¨å’Œå¤šçº¿ç¨‹æ˜¯æˆ‘æ‹¿cå†™ç½‘ç»œç¼–ç¨‹ç”¨çš„æœ€å¤šçš„æ–¹æ³•ã€‚","like_count":0,"discussions":[{"author":{"id":1181974,"avatar":"https://static001.geekbang.org/account/avatar/00/12/09/16/1161017c.jpg","nickname":"ç½—å‰‘é”‹","note":"","ucode":"95678C988F24AB","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":529474,"discussion_content":"ç°åœ¨è¿™ä¸ªæ˜¯Linuxé‡Œçš„é€šç”¨åšæ³•äº†ï¼Œä¸è¿‡åœ¨20å¹´å‰å¯ä¸æ˜¯é‚£ä¹ˆå®¹æ˜“çš„ã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1635596626,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":173384,"user_name":"J.Smile","can_delete":false,"product_type":"c1","uid":1336475,"ip_address":"","ucode":"C4D98DFDBF7584","user_header":"https://static001.geekbang.org/account/avatar/00/14/64/9b/0b578b08.jpg","comment_is_top":false,"comment_ctime":1579518121,"is_pvip":false,"replies":[{"id":"67230","content":"openrestyåœ¨CDNç­‰é¢†åŸŸç”¨çš„è¿˜æ˜¯å¾ˆå¤šçš„ï¼Œå¾ˆå¤šå¤§å…¬å¸ä¹Ÿåœ¨ç”¨ï¼Œæ¯”å¦‚é˜¿é‡Œäº¬ä¸œã€‚","user_name":"ä½œè€…å›å¤","user_name_real":"chrono","uid":"1181974","ctime":1579531750,"ip_address":"","comment_id":173384,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1579518121","product_id":100029001,"comment_content":"ä¹Ÿå¯èƒ½æ˜¯nginxå·²ç»è§£å†³äº†å¤§éƒ¨åˆ†çš„é—®é¢˜ï¼Œopenrestyå¯¹å¾ˆå¤šå…¬å¸å¹¶æ²¡æœ‰ä½“ç°å‡ºç›¸æ¯”nginxçš„ä¼˜åŠ¿ï¼Œå¯¼è‡´ç”¨ä¸èµ·æ¥ï¼Œä¸æ˜¯å¾ˆæµè¡Œï¼Œå¤§å®¶éƒ½çŸ¥é“nginxï¼Œä½†æ˜¯æœªå¿…éƒ½çŸ¥é“openrestyã€‚","like_count":0,"discussions":[{"author":{"id":1181974,"avatar":"https://static001.geekbang.org/account/avatar/00/12/09/16/1161017c.jpg","nickname":"ç½—å‰‘é”‹","note":"","ucode":"95678C988F24AB","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":482056,"discussion_content":"openrestyåœ¨CDNç­‰é¢†åŸŸç”¨çš„è¿˜æ˜¯å¾ˆå¤šçš„ï¼Œå¾ˆå¤šå¤§å…¬å¸ä¹Ÿåœ¨ç”¨ï¼Œæ¯”å¦‚é˜¿é‡Œäº¬ä¸œã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1579531750,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":127083,"user_name":"ğŸ‘» å°äºŒ","can_delete":false,"product_type":"c1","uid":1625463,"ip_address":"","ucode":"9EEA8553163270","user_header":"https://static001.geekbang.org/account/avatar/00/18/cd/77/b2ab5d44.jpg","comment_is_top":false,"comment_ctime":1566551442,"is_pvip":false,"replies":[{"id":"47158","content":"ç›®å‰æ˜¯è¿™æ ·ï¼Œéœ€è¦æ“ä½œç³»ç»Ÿåº•å±‚æœ‰epollã€kqueueç­‰ç³»ç»Ÿè°ƒç”¨ï¼Œç„¶ååŸºäºè¿™äº›ç³»ç»Ÿè°ƒç”¨å®ç°reactorã€proactorç­‰æ¨¡å¼ï¼Œä¹Ÿå°±æ˜¯å¤šè·¯å¤ç”¨ã€‚","user_name":"ä½œè€…å›å¤","user_name_real":"chrono","uid":"1181974","ctime":1566690544,"ip_address":"","comment_id":127083,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1566551442","product_id":100029001,"comment_content":"å¤šè·¯å¤ç”¨ï¼Œ è¿™ç§æ˜¯éœ€è¦æ“ä½œç³»ç»Ÿåº•å±‚æä¾›æ”¯æŒå—ï¼Ÿæ„Ÿè§‰è‡ªå·±çš„ä»£ç å†æ€ä¹ˆå†™ï¼Œ ä¹Ÿæ˜¯å¤šå¼€ä¸€ä¸ªçº¿ç¨‹åœ¨é‚£è¾¹ç­‰ï¼Œ ","like_count":0,"discussions":[{"author":{"id":1181974,"avatar":"https://static001.geekbang.org/account/avatar/00/12/09/16/1161017c.jpg","nickname":"ç½—å‰‘é”‹","note":"","ucode":"95678C988F24AB","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":464314,"discussion_content":"ç›®å‰æ˜¯è¿™æ ·ï¼Œéœ€è¦æ“ä½œç³»ç»Ÿåº•å±‚æœ‰epollã€kqueueç­‰ç³»ç»Ÿè°ƒç”¨ï¼Œç„¶ååŸºäºè¿™äº›ç³»ç»Ÿè°ƒç”¨å®ç°reactorã€proactorç­‰æ¨¡å¼ï¼Œä¹Ÿå°±æ˜¯å¤šè·¯å¤ç”¨ã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1566690544,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":126608,"user_name":"å½©è‰²çš„æ²™æ¼ ","can_delete":false,"product_type":"c1","uid":1116183,"ip_address":"","ucode":"19A0975A5E69EA","user_header":"https://static001.geekbang.org/account/avatar/00/11/08/17/e63e50f3.jpg","comment_is_top":false,"comment_ctime":1566435760,"is_pvip":true,"replies":[{"id":"46837","content":"Androidç³»ç»Ÿä¸äº†è§£ï¼Œæ¬¢è¿è¡¥å……ã€‚","user_name":"ä½œè€…å›å¤","user_name_real":"chrono","uid":"1181974","ctime":1566440637,"ip_address":"","comment_id":126608,"utype":1}],"discussion_count":2,"race_medal":0,"score":"1566435760","product_id":100029001,"comment_content":"è€å¸ˆæ‚¨åœ¨ä¸€ä¸ªåŒå­¦å›å¤ä¸­è¯´â€œåŒæ­¥é˜»å¡çš„æ—¶å€™æ˜¯è¿™ä¸ªçº¿ç¨‹è¢«é˜»å¡äº†ï¼Œæ“ä½œç³»ç»Ÿä¼šæŠŠè¿™ä¸ªçº¿ç¨‹åˆ‡æ¢å‡ºå»å¹²åˆ«çš„ï¼Œä¸ä¼šè€—cpuï¼Œç›¸å½“äºè¿™ä¸ªçº¿ç¨‹æ²¡æœ‰å……åˆ†åˆ©ç”¨cpuèµ„æºâ€ï¼Œå®‰å“ç³»ç»Ÿç”¨çš„å•çº¿ç¨‹æ¨¡å‹ï¼Œå¦‚æœä¸»çº¿ç¨‹é˜»å¡è¶…æ—¶ï¼Œå°±ä¼šæŠ¥ANR","like_count":0,"discussions":[{"author":{"id":1181974,"avatar":"https://static001.geekbang.org/account/avatar/00/12/09/16/1161017c.jpg","nickname":"ç½—å‰‘é”‹","note":"","ucode":"95678C988F24AB","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":464082,"discussion_content":"Androidç³»ç»Ÿä¸äº†è§£ï¼Œæ¬¢è¿è¡¥å……ã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1566440637,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1099492,"avatar":"https://static001.geekbang.org/account/avatar/00/10/c6/e4/ec572f55.jpg","nickname":"æ²™äº®äº®","note":"","ucode":"E6CF0D5B1E6691","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":8337,"discussion_content":"ä½ è¿™ä¸ªåº”è¯¥æ˜¯å®‰å“uiçº¿ç¨‹æ˜¯ä¸€ä¸ªå•ç‹¬çš„ä¸»çº¿ç¨‹ï¼Œåœ¨uiçº¿ç¨‹è°ƒè¶…æ—¶æ“ä½œï¼Œç•Œé¢ä¼šæ— å“åº”ã€‚è·Ÿè¿™ä¸ªä¸¤ç äº‹","likes_number":1,"is_delete":false,"is_hidden":false,"ctime":1567929963,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]}]}