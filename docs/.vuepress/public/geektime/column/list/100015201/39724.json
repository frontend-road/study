{"id":39724,"title":"11 | 从0到1：搭建一个完整的Kubernetes集群","content":"<p>你好，我是张磊。今天我和你分享的主题是：从0到1搭建一个完整的Kubernetes集群。</p><p>不过，首先需要指出的是，本篇搭建指南是完全的手工操作，细节比较多，并且有些外部链接可能还会遇到特殊的“网络问题”。所以，对于只关心学习 Kubernetes 本身知识点、不太关注如何手工部署 Kubernetes 集群的同学，可以略过本节，直接使用 <a href=\"https://github.com/kubernetes/minikube\">MiniKube</a> 或者 <a href=\"https://github.com/kubernetes-sigs/kind\">Kind</a>，来在本地启动简单的 Kubernetes 集群进行后面的学习即可。如果是使用 MiniKube 的话，阿里云还维护了一个<a href=\"https://github.com/AliyunContainerService/minikube\">国内版的 MiniKube</a>，这对于在国内的同学来说会比较友好。</p><p>在上一篇文章中，我介绍了kubeadm这个Kubernetes半官方管理工具的工作原理。既然kubeadm的初衷是让Kubernetes集群的部署不再让人头疼，那么这篇文章，我们就来使用它部署一个完整的Kubernetes集群吧。</p><blockquote>\n<p>备注：这里所说的“完整”，指的是这个集群具备Kubernetes项目在GitHub上已经发布的所有功能，并能够模拟生产环境的所有使用需求。但并不代表这个集群是生产级别可用的：类似于高可用、授权、多租户、灾难备份等生产级别集群的功能暂时不在本篇文章的讨论范围。<br>\n目前，kubeadm的高可用部署<a href=\"https://kubernetes.io/docs/setup/independent/high-availability/\">已经有了第一个发布</a>。但是，这个特性还没有GA（生产可用），所以包括了大量的手动工作，跟我们所预期的一键部署还有一定距离。GA的日期预计是2018年底到2019年初。届时，如果有机会我会再和你分享这部分内容。</p>\n</blockquote><!-- [[[read_end]]] --><p>这次部署，我不会依赖于任何公有云或私有云的能力，而是完全在Bare-metal环境中完成。这样的部署经验会更有普适性。而在后续的讲解中，如非特殊强调，我也都会以本次搭建的这个集群为基础。</p><h2>准备工作</h2><p>首先，准备机器。最直接的办法，自然是到公有云上申请几个虚拟机。当然，如果条件允许的话，拿几台本地的物理服务器来组集群是最好不过了。这些机器只要满足如下几个条件即可：</p><ol>\n<li>\n<p>满足安装Docker项目所需的要求，比如64位的Linux操作系统、3.10及以上的内核版本；</p>\n</li>\n<li>\n<p>x86或者ARM架构均可；</p>\n</li>\n<li>\n<p>机器之间网络互通，这是将来容器之间网络互通的前提；</p>\n</li>\n<li>\n<p>有外网访问权限，因为需要拉取镜像；</p>\n</li>\n<li>\n<p>能够访问到<code>gcr.io、quay.io</code>这两个docker registry，因为有小部分镜像需要在这里拉取；</p>\n</li>\n<li>\n<p>单机可用资源建议2核CPU、8 GB内存或以上，再小的话问题也不大，但是能调度的Pod数量就比较有限了；</p>\n</li>\n<li>\n<p>30 GB或以上的可用磁盘空间，这主要是留给Docker镜像和日志文件用的。</p>\n</li>\n</ol><p>在本次部署中，我准备的机器配置如下：</p><ol>\n<li>\n<p>2核CPU、 7.5 GB内存；</p>\n</li>\n<li>\n<p>30 GB磁盘；</p>\n</li>\n<li>\n<p>Ubuntu 16.04；</p>\n</li>\n<li>\n<p>内网互通；</p>\n</li>\n<li>\n<p>外网访问权限不受限制。</p>\n</li>\n</ol><blockquote>\n<p>备注：在开始部署前，我推荐你先花几分钟时间，回忆一下Kubernetes的架构。</p>\n</blockquote><p>然后，我再和你介绍一下今天实践的目标：</p><ol>\n<li>\n<p>在所有节点上安装Docker和kubeadm；</p>\n</li>\n<li>\n<p>部署Kubernetes Master；</p>\n</li>\n<li>\n<p>部署容器网络插件；</p>\n</li>\n<li>\n<p>部署Kubernetes Worker；</p>\n</li>\n<li>\n<p>部署Dashboard可视化插件；</p>\n</li>\n<li>\n<p>部署容器存储插件。</p>\n</li>\n</ol><p>好了，现在，就来开始这次集群部署之旅吧！</p><h2>安装kubeadm和Docker</h2><p>我在上一篇文章《 Kubernetes一键部署利器：kubeadm》中，已经介绍过kubeadm的基础用法，它的一键安装非常方便，我们只需要添加kubeadm的源，然后直接使用apt-get安装即可，具体流程如下所示：</p><blockquote>\n<p>备注：为了方便讲解，我后续都会直接在root用户下进行操作。</p>\n</blockquote><pre><code>$ curl -s https://packages.cloud.google.com/apt/doc/apt-key.gpg | apt-key add -\n$ cat &lt;&lt;EOF &gt; /etc/apt/sources.list.d/kubernetes.list\ndeb http://apt.kubernetes.io/ kubernetes-xenial main\nEOF\n$ apt-get update\n$ apt-get install -y docker.io kubeadm\n</code></pre><blockquote>\n<p>提示：如果 apt.kubernetes.io 因为网络问题访问不到，可以换成中科大的 Ubuntu 镜像源deb <a href=\"http://mirrors.ustc.edu.cn/kubernetes/apt\">http://mirrors.ustc.edu.cn/kubernetes/apt</a> kubernetes-xenial main。</p>\n</blockquote><p>在上述安装kubeadm的过程中，kubeadm和kubelet、kubectl、kubernetes-cni这几个二进制文件都会被自动安装好。</p><p>另外，这里我直接使用Ubuntu的docker.io的安装源，原因是Docker公司每次发布的最新的Docker CE（社区版）产品往往还没有经过Kubernetes项目的验证，可能会有兼容性方面的问题。</p><h2>部署Kubernetes的Master节点</h2><p>在上一篇文章中，我已经介绍过kubeadm可以一键部署Master节点。不过，在本篇文章中既然要部署一个“完整”的Kubernetes集群，那我们不妨稍微提高一下难度：通过配置文件来开启一些实验性功能。</p><p>所以，这里我编写了一个给kubeadm用的YAML文件（名叫：kubeadm.yaml）：</p><pre><code>apiVersion: kubeadm.k8s.io/v1alpha1\nkind: MasterConfiguration\ncontrollerManagerExtraArgs:\n  horizontal-pod-autoscaler-use-rest-clients: &quot;true&quot;\n  horizontal-pod-autoscaler-sync-period: &quot;10s&quot;\n  node-monitor-grace-period: &quot;10s&quot;\napiServerExtraArgs:\n  runtime-config: &quot;api/all=true&quot;\nkubernetesVersion: &quot;stable-1.11&quot;\n</code></pre><p>这个配置中，我给kube-controller-manager设置了：</p><pre><code>horizontal-pod-autoscaler-use-rest-clients: &quot;true&quot;\n</code></pre><p>这意味着，将来部署的kube-controller-manager能够使用自定义资源（Custom Metrics）进行自动水平扩展。这是我后面文章中会重点介绍的一个内容。</p><p>其中，“stable-1.11”就是kubeadm帮我们部署的Kubernetes版本号，即：Kubernetes release 1.11最新的稳定版，在我的环境下，它是v1.11.1。你也可以直接指定这个版本，比如：kubernetesVersion: “v1.11.1”。</p><p>然后，我们只需要执行一句指令：</p><pre><code>$ kubeadm init --config kubeadm.yaml\n</code></pre><p>就可以完成Kubernetes Master的部署了，这个过程只需要几分钟。部署完成后，kubeadm会生成一行指令：</p><pre><code>kubeadm join 10.168.0.2:6443 --token 00bwbx.uvnaa2ewjflwu1ry --discovery-token-ca-cert-hash sha256:00eb62a2a6020f94132e3fe1ab721349bbcd3e9b94da9654cfe15f2985ebd711\n</code></pre><p>这个kubeadm join命令，就是用来给这个Master节点添加更多工作节点（Worker）的命令。我们在后面部署Worker节点的时候马上会用到它，所以找一个地方把这条命令记录下来。</p><p>此外，kubeadm还会提示我们第一次使用Kubernetes集群所需要的配置命令：</p><pre><code>mkdir -p $HOME/.kube\nsudo cp -i /etc/kubernetes/admin.conf $HOME/.kube/config\nsudo chown $(id -u):$(id -g) $HOME/.kube/config\n</code></pre><p>而需要这些配置命令的原因是：Kubernetes集群默认需要加密方式访问。所以，这几条命令，就是将刚刚部署生成的Kubernetes集群的安全配置文件，保存到当前用户的.kube目录下，kubectl默认会使用这个目录下的授权信息访问Kubernetes集群。</p><p>如果不这么做的话，我们每次都需要通过export KUBECONFIG环境变量告诉kubectl这个安全配置文件的位置。</p><p>现在，我们就可以使用kubectl get命令来查看当前唯一一个节点的状态了：</p><pre><code>$ kubectl get nodes\n\nNAME      STATUS     ROLES     AGE       VERSION\nmaster    NotReady   master    1d        v1.11.1\n</code></pre><p>可以看到，这个get指令输出的结果里，Master节点的状态是NotReady，这是为什么呢？</p><p>在调试Kubernetes集群时，最重要的手段就是用kubectl describe来查看这个节点（Node）对象的详细信息、状态和事件（Event），我们来试一下：</p><pre><code>$ kubectl describe node master\n\n...\nConditions:\n...\n\nReady   False ... KubeletNotReady  runtime network not ready: NetworkReady=false reason:NetworkPluginNotReady message:docker: network plugin is not ready: cni config uninitialized\n</code></pre><p>通过kubectl describe指令的输出，我们可以看到NodeNotReady的原因在于，我们尚未部署任何网络插件。</p><p>另外，我们还可以通过kubectl检查这个节点上各个系统Pod的状态，其中，kube-system是Kubernetes项目预留的系统Pod的工作空间（Namepsace，注意它并不是Linux Namespace，它只是Kubernetes划分不同工作空间的单位）：</p><pre><code>$ kubectl get pods -n kube-system\n\nNAME               READY   STATUS   RESTARTS  AGE\ncoredns-78fcdf6894-j9s52     0/1    Pending  0     1h\ncoredns-78fcdf6894-jm4wf     0/1    Pending  0     1h\netcd-master           1/1    Running  0     2s\nkube-apiserver-master      1/1    Running  0     1s\nkube-controller-manager-master  0/1    Pending  0     1s\nkube-proxy-xbd47         1/1    NodeLost  0     1h\nkube-scheduler-master      1/1    Running  0     1s\n</code></pre><p>可以看到，CoreDNS、kube-controller-manager等依赖于网络的Pod都处于Pending状态，即调度失败。这当然是符合预期的：因为这个Master节点的网络尚未就绪。</p><h2>部署网络插件</h2><p>在Kubernetes项目“一切皆容器”的设计理念指导下，部署网络插件非常简单，只需要执行一句kubectl apply指令，以Weave为例：</p><pre><code>$ kubectl apply -f https://git.io/weave-kube-1.6\n</code></pre><p>部署完成后，我们可以通过kubectl get重新检查Pod的状态：</p><pre><code>$ kubectl get pods -n kube-system\n\nNAME                             READY     STATUS    RESTARTS   AGE\ncoredns-78fcdf6894-j9s52         1/1       Running   0          1d\ncoredns-78fcdf6894-jm4wf         1/1       Running   0          1d\netcd-master                      1/1       Running   0          9s\nkube-apiserver-master            1/1       Running   0          9s\nkube-controller-manager-master   1/1       Running   0          9s\nkube-proxy-xbd47                 1/1       Running   0          1d\nkube-scheduler-master            1/1       Running   0          9s\nweave-net-cmk27                  2/2       Running   0          19s\n</code></pre><p>可以看到，所有的系统Pod都成功启动了，而刚刚部署的Weave网络插件则在kube-system下面新建了一个名叫weave-net-cmk27的Pod，一般来说，这些Pod就是容器网络插件在每个节点上的控制组件。</p><p>Kubernetes支持容器网络插件，使用的是一个名叫CNI的通用接口，它也是当前容器网络的事实标准，市面上的所有容器网络开源项目都可以通过CNI接入Kubernetes，比如Flannel、Calico、Canal、Romana等等，它们的部署方式也都是类似的“一键部署”。关于这些开源项目的实现细节和差异，我会在后续的网络部分详细介绍。</p><p>至此，Kubernetes的Master节点就部署完成了。如果你只需要一个单节点的Kubernetes，现在你就可以使用了。不过，在默认情况下，Kubernetes的Master节点是不能运行用户Pod的，所以还需要额外做一个小操作。在本篇的最后部分，我会介绍到它。</p><h2>部署Kubernetes的Worker节点</h2><p>Kubernetes的Worker节点跟Master节点几乎是相同的，它们运行着的都是一个kubelet组件。唯一的区别在于，在kubeadm init的过程中，kubelet启动后，Master节点上还会自动运行kube-apiserver、kube-scheduler、kube-controller-manger这三个系统Pod。</p><p>所以，相比之下，部署Worker节点反而是最简单的，只需要两步即可完成。</p><p>第一步，在所有Worker节点上执行“安装kubeadm和Docker”一节的所有步骤。</p><p>第二步，执行部署Master节点时生成的kubeadm join指令：</p><pre><code>$ kubeadm join 10.168.0.2:6443 --token 00bwbx.uvnaa2ewjflwu1ry --discovery-token-ca-cert-hash sha256:00eb62a2a6020f94132e3fe1ab721349bbcd3e9b94da9654cfe15f2985ebd711\n</code></pre><h2>通过Taint/Toleration调整Master执行Pod的策略</h2><p>我在前面提到过，默认情况下Master节点是不允许运行用户Pod的。而Kubernetes做到这一点，依靠的是Kubernetes的Taint/Toleration机制。</p><p>它的原理非常简单：一旦某个节点被加上了一个Taint，即被“打上了污点”，那么所有Pod就都不能在这个节点上运行，因为Kubernetes的Pod都有“洁癖”。</p><p>除非，有个别的Pod声明自己能“容忍”这个“污点”，即声明了Toleration，它才可以在这个节点上运行。</p><p>其中，为节点打上“污点”（Taint）的命令是：</p><pre><code>$ kubectl taint nodes node1 foo=bar:NoSchedule\n</code></pre><p>这时，该node1节点上就会增加一个键值对格式的Taint，即：foo=bar:NoSchedule。其中值里面的NoSchedule，意味着这个Taint只会在调度新Pod时产生作用，而不会影响已经在node1上运行的Pod，哪怕它们没有Toleration。</p><p>那么Pod又如何声明Toleration呢？</p><p>我们只要在Pod的.yaml文件中的spec部分，加入tolerations字段即可：</p><pre><code>apiVersion: v1\nkind: Pod\n...\nspec:\n  tolerations:\n  - key: &quot;foo&quot;\n    operator: &quot;Equal&quot;\n    value: &quot;bar&quot;\n    effect: &quot;NoSchedule&quot;\n</code></pre><p>这个Toleration的含义是，这个Pod能“容忍”所有键值对为foo=bar的Taint（ operator: “Equal”，“等于”操作）。</p><p>现在回到我们已经搭建的集群上来。这时，如果你通过kubectl describe检查一下Master节点的Taint字段，就会有所发现了：</p><pre><code>$ kubectl describe node master\n\nName:               master\nRoles:              master\nTaints:             node-role.kubernetes.io/master:NoSchedule\n</code></pre><p>可以看到，Master节点默认被加上了<code>node-role.kubernetes.io/master:NoSchedule</code>这样一个“污点”，其中“键”是<code>node-role.kubernetes.io/master</code>，而没有提供“值”。</p><p>此时，你就需要像下面这样用“Exists”操作符（operator: “Exists”，“存在”即可）来说明，该Pod能够容忍所有以foo为键的Taint，才能让这个Pod运行在该Master节点上：</p><pre><code>apiVersion: v1\nkind: Pod\n...\nspec:\n  tolerations:\n  - key: &quot;foo&quot;\n    operator: &quot;Exists&quot;\n    effect: &quot;NoSchedule&quot;\n</code></pre><p>当然，如果你就是想要一个单节点的Kubernetes，删除这个Taint才是正确的选择：</p><pre><code>$ kubectl taint nodes --all node-role.kubernetes.io/master-\n</code></pre><p>如上所示，我们在“<code>node-role.kubernetes.io/master</code>”这个键后面加上了一个短横线“-”，这个格式就意味着移除所有以“<code>node-role.kubernetes.io/master</code>”为键的Taint。</p><p>到了这一步，一个基本完整的Kubernetes集群就部署完毕了。是不是很简单呢？</p><p>有了kubeadm这样的原生管理工具，Kubernetes的部署已经被大大简化。更重要的是，像证书、授权、各个组件的配置等部署中最麻烦的操作，kubeadm都已经帮你完成了。</p><p>接下来，我们再在这个Kubernetes集群上安装一些其他的辅助插件，比如Dashboard和存储插件。</p><h2>部署Dashboard可视化插件</h2><p>在Kubernetes社区中，有一个很受欢迎的Dashboard项目，它可以给用户提供一个可视化的Web界面来查看当前集群的各种信息。毫不意外，它的部署也相当简单：</p><pre><code>$ kubectl apply -f \n$ $ kubectl apply -f https://raw.githubusercontent.com/kubernetes/dashboard/v2.0.0-rc6/aio/deploy/recommended.yaml\n</code></pre><p>部署完成之后，我们就可以查看Dashboard对应的Pod的状态了：</p><pre><code>$ kubectl get pods -n kube-system\n\nkubernetes-dashboard-6948bdb78-f67xk   1/1       Running   0          1m\n</code></pre><p>需要注意的是，由于Dashboard是一个Web Server，很多人经常会在自己的公有云上无意地暴露Dashboard的端口，从而造成安全隐患。所以，1.7版本之后的Dashboard项目部署完成后，默认只能通过Proxy的方式在本地访问。具体的操作，你可以查看Dashboard项目的<a href=\"https://github.com/kubernetes/dashboard\">官方文档</a>。</p><p>而如果你想从集群外访问这个Dashboard的话，就需要用到Ingress，我会在后面的文章中专门介绍这部分内容。</p><h2>部署容器存储插件</h2><p>接下来，让我们完成这个Kubernetes集群的最后一块拼图：容器持久化存储。</p><p>我在前面介绍容器原理时已经提到过，很多时候我们需要用数据卷（Volume）把外面宿主机上的目录或者文件挂载进容器的Mount Namespace中，从而达到容器和宿主机共享这些目录或者文件的目的。容器里的应用，也就可以在这些数据卷中新建和写入文件。</p><p>可是，如果你在某一台机器上启动的一个容器，显然无法看到其他机器上的容器在它们的数据卷里写入的文件。<strong>这是容器最典型的特征之一：无状态。</strong></p><p>而容器的持久化存储，就是用来保存容器存储状态的重要手段：存储插件会在容器里挂载一个基于网络或者其他机制的远程数据卷，使得在容器里创建的文件，实际上是保存在远程存储服务器上，或者以分布式的方式保存在多个节点上，而与当前宿主机没有任何绑定关系。这样，无论你在其他哪个宿主机上启动新的容器，都可以请求挂载指定的持久化存储卷，从而访问到数据卷里保存的内容。<strong>这就是“持久化”的含义。</strong></p><p>由于Kubernetes本身的松耦合设计，绝大多数存储项目，比如Ceph、GlusterFS、NFS等，都可以为Kubernetes提供持久化存储能力。在这次的部署实战中，我会选择部署一个很重要的Kubernetes存储插件项目：Rook。</p><p>Rook项目是一个基于Ceph的Kubernetes存储插件（它后期也在加入对更多存储实现的支持）。不过，不同于对Ceph的简单封装，Rook在自己的实现中加入了水平扩展、迁移、灾难备份、监控等大量的企业级功能，使得这个项目变成了一个完整的、生产级别可用的容器存储插件。</p><p>得益于容器化技术，用几条指令，Rook就可以把复杂的Ceph存储后端部署起来：</p><pre><code>$ kubectl apply -f https://raw.githubusercontent.com/rook/rook/master/cluster/examples/kubernetes/ceph/common.yaml\n\n$ kubectl apply -f https://raw.githubusercontent.com/rook/rook/master/cluster/examples/kubernetes/ceph/operator.yaml\n\n$ kubectl apply -f https://raw.githubusercontent.com/rook/rook/master/cluster/examples/kubernetes/ceph/cluster.yaml\n</code></pre><p>在部署完成后，你就可以看到Rook项目会将自己的Pod放置在由它自己管理的两个Namespace当中：</p><pre><code>$ kubectl get pods -n rook-ceph-system\nNAME                                  READY     STATUS    RESTARTS   AGE\nrook-ceph-agent-7cv62                 1/1       Running   0          15s\nrook-ceph-operator-78d498c68c-7fj72   1/1       Running   0          44s\nrook-discover-2ctcv                   1/1       Running   0          15s\n\n$ kubectl get pods -n rook-ceph\nNAME                   READY     STATUS    RESTARTS   AGE\nrook-ceph-mon0-kxnzh   1/1       Running   0          13s\nrook-ceph-mon1-7dn2t   1/1       Running   0          2s\n</code></pre><p>这样，一个基于Rook持久化存储集群就以容器的方式运行起来了，而接下来在Kubernetes项目上创建的所有Pod就能够通过Persistent Volume（PV）和Persistent Volume Claim（PVC）的方式，在容器里挂载由Ceph提供的数据卷了。</p><p>而Rook项目，则会负责这些数据卷的生命周期管理、灾难备份等运维工作。关于这些容器持久化存储的知识，我会在后续章节中专门讲解。</p><p>这时候，你可能会有个疑问：为什么我要选择Rook项目呢？</p><p>其实，是因为这个项目很有前途。</p><p>如果你去研究一下Rook项目的实现，就会发现它巧妙地依赖了Kubernetes提供的编排能力，合理的使用了很多诸如Operator、CRD等重要的扩展特性（这些特性我都会在后面的文章中逐一讲解到）。这使得Rook项目，成为了目前社区中基于Kubernetes API构建的最完善也最成熟的容器存储插件。我相信，这样的发展路线，很快就会得到整个社区的推崇。</p><blockquote>\n<p>备注：其实，在很多时候，大家说的所谓“云原生”，就是“Kubernetes原生”的意思。而像Rook、Istio这样的项目，正是贯彻这个思路的典范。在我们后面讲解了声明式API之后，相信你对这些项目的设计思想会有更深刻的体会。</p>\n</blockquote><h2>总结</h2><p>在本篇文章中，我们完全从0开始，在Bare-metal环境下使用kubeadm工具部署了一个完整的Kubernetes集群：这个集群有一个Master节点和多个Worker节点；使用Weave作为容器网络插件；使用Rook作为容器持久化存储插件；使用Dashboard插件提供了可视化的Web界面。</p><p>这个集群，也将会是我进行后续讲解所依赖的集群环境，并且在后面的讲解中，我还会给它安装更多的插件，添加更多的新能力。</p><p>另外，这个集群的部署过程并不像传说中那么繁琐，这主要得益于：</p><ol>\n<li>\n<p>kubeadm项目大大简化了部署Kubernetes的准备工作，尤其是配置文件、证书、二进制文件的准备和制作，以及集群版本管理等操作，都被kubeadm接管了。</p>\n</li>\n<li>\n<p>Kubernetes本身“一切皆容器”的设计思想，加上良好的可扩展机制，使得插件的部署非常简便。</p>\n</li>\n</ol><p>上述思想，也是开发和使用Kubernetes的重要指导思想，即：基于Kubernetes开展工作时，你一定要优先考虑这两个问题：</p><ol>\n<li>\n<p>我的工作是不是可以容器化？</p>\n</li>\n<li>\n<p>我的工作是不是可以借助Kubernetes API和可扩展机制来完成？</p>\n</li>\n</ol><p>而一旦这项工作能够基于Kubernetes实现容器化，就很有可能像上面的部署过程一样，大幅简化原本复杂的运维工作。对于时间宝贵的技术人员来说，这个变化的重要性是不言而喻的。</p><h2>思考题</h2><ol>\n<li>\n<p>你是否使用其他工具部署过Kubernetes项目？经历如何？</p>\n</li>\n<li>\n<p>你是否知道Kubernetes项目当前（v1.11）能够有效管理的集群规模是多少个节点？你在生产环境中希望部署或者正在部署的集群规模又是多少个节点呢？</p>\n</li>\n</ol><p>感谢你的收听，欢迎你给我留言，也欢迎分享给更多的朋友一起阅读。</p>","neighbors":{"left":{"article_title":"10 | Kubernetes一键部署利器：kubeadm","id":39712},"right":{"article_title":"12 | 牛刀小试：我的第一个容器化应用","id":40008}},"comments":[{"had_liked":false,"id":30182,"user_name":"L","can_delete":false,"product_type":"c1","uid":1194428,"ip_address":"","ucode":"5F7F68DB091A0D","user_header":"https://static001.geekbang.org/account/avatar/00/12/39/bc/2764927e.jpg","comment_is_top":false,"comment_ctime":1538715855,"is_pvip":false,"discussion_count":13,"race_medal":0,"score":"727388188879","product_id":100015201,"comment_content":"centos7 单机k8s终于在墙内搭好了，写了篇教程欢迎后来者直接享用<br>https:&#47;&#47;www.datayang.com&#47;article&#47;45","like_count":170,"discussions":[{"author":{"id":1101602,"avatar":"https://static001.geekbang.org/account/avatar/00/10/cf/22/5a483755.jpg","nickname":"小蛋壳","note":"","ucode":"8344163BF7722E","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":408704,"discussion_content":"https://www.jianshu.com/p/c18eb68942e2 本地搭建k8s集群，1主1从，kubeadm v1.17.0","likes_number":4,"is_delete":false,"is_hidden":false,"ctime":1635305041,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":2,"child_discussions":[{"author":{"id":1428489,"avatar":"https://static001.geekbang.org/account/avatar/00/15/cc/09/39ce758a.jpg","nickname":"乖，摸摸头","note":"","ucode":"246C51262E7823","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":1101602,"avatar":"https://static001.geekbang.org/account/avatar/00/10/cf/22/5a483755.jpg","nickname":"小蛋壳","note":"","ucode":"8344163BF7722E","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":409703,"discussion_content":"回头试试","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1635492760,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":408704,"ip_address":""},"score":409703,"extra":""},{"author":{"id":2077420,"avatar":"https://static001.geekbang.org/account/avatar/00/1f/b2/ec/20727753.jpg","nickname":"燚蠡","note":"","ucode":"4F1BDD86E0728E","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":1101602,"avatar":"https://static001.geekbang.org/account/avatar/00/10/cf/22/5a483755.jpg","nickname":"小蛋壳","note":"","ucode":"8344163BF7722E","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":544758,"discussion_content":"谢谢分享！","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1641698195,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":408704,"ip_address":""},"score":544758,"extra":""}]},{"author":{"id":2353990,"avatar":"","nickname":"Geek_a19411","note":"","ucode":"3E811031BBCF1A","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":332017,"discussion_content":"不能访问了","likes_number":1,"is_delete":false,"is_hidden":false,"ctime":1607046273,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1593376,"avatar":"https://static001.geekbang.org/account/avatar/00/18/50/20/34bdc8e2.jpg","nickname":"王心凌","note":"","ucode":"A51E0C56B6AC73","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":89048,"discussion_content":"楼主你blog用的什么主题","likes_number":1,"is_delete":false,"is_hidden":false,"ctime":1576747309,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1307793,"avatar":"http://thirdwx.qlogo.cn/mmopen/vi_32/DYAIOgq83eo5WaRd8ibAozKXvIGWXKDq1CdxLhkdnRyyTKcgMDYaFDAaKqg2IpETOC3RacYoggGOhFMeMGicRXxA/132","nickname":"天机老人","note":"","ucode":"B553FBBF9DD41B","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":49629,"discussion_content":"用https://raw.githubusercontent.com/kubernetes/dashboard/v1.8.3/src/deploy/recommended/kubernetes-dashboard.yaml","likes_number":1,"is_delete":false,"is_hidden":false,"ctime":1573617207,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1274787,"avatar":"https://static001.geekbang.org/account/avatar/00/13/73/a3/2b077607.jpg","nickname":"Michael","note":"","ucode":"C233DF1D224EC1","race_medal":0,"user_type":1,"is_pvip":true},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":360898,"discussion_content":"楼主，你这博客咋搭建的","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1616554298,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1397810,"avatar":"http://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTIFaRFOpI0KaegoIGYYhmxAJkZOIkLMwibEqRjLPMA4yBFkQDn2HSbg6ArfGmToU0xQfhiaAxR0XAicw/132","nickname":"Geek_463d85","note":"","ucode":"9561EFBF88790F","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":316686,"discussion_content":"不能访问404","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1603439901,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":2074105,"avatar":"","nickname":"Geek_d24856","note":"","ucode":"0F98FEDFAE7104","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":302100,"discussion_content":"感谢楼主的分享","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1598787958,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1649606,"avatar":"http://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTKv4T6QtgaIMlrZWzBtmADsTnMGjgJCDoZKDyEQNZ4Yic62Tea5xX1wCkDIc0MsUDMhSb6yNbSm8iaQ/132","nickname":"水库浪子","note":"","ucode":"C9AEFBB199C3E4","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":289466,"discussion_content":"your configuration file uses an old API spec: &#34;kubeadm.k8s.io/v1alpha1&#34;. Please use kubeadm v1.11 instead and run &#39;kubeadm config migrate --old-config old.yaml --new-config new.yaml&#39;, which will write the new, similar spec using a newer API version.","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1594110764,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1283965,"avatar":"http://thirdwx.qlogo.cn/mmopen/vi_32/TTPicMEZ5s1zKiaKYecIljicRV9dibITPM0958W3VuNHXlTQic2Dj6XYGibF7dqrG3JWr0LMx7hY9zXGzuvTDNGw8KAA/132","nickname":"阳光梦","note":"","ucode":"55BDA128D39931","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":186834,"discussion_content":"集群呢，加油！","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1582717726,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1112367,"avatar":"https://static001.geekbang.org/account/avatar/00/10/f9/2f/01b32495.jpg","nickname":"小孩","note":"","ucode":"A7F587FC641E63","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":48202,"discussion_content":"同问，怎么访问","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1573461892,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1616628,"avatar":"https://static001.geekbang.org/account/avatar/00/18/aa/f4/85abadb6.jpg","nickname":"史文杰-SRE","note":"","ucode":"3BFF5CA3CC57CD","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":7572,"discussion_content":"不能访问啊","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1567570103,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":3,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":24569,"user_name":"xxx","can_delete":false,"product_type":"c1","uid":1015388,"ip_address":"","ucode":"8EE570DD4114F0","user_header":"https://static001.geekbang.org/account/avatar/00/0f/7e/5c/06e79f14.jpg","comment_is_top":false,"comment_ctime":1537146104,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"366609366264","product_id":100015201,"comment_content":"真的是写的最好的专栏","like_count":86},{"had_liked":false,"id":76891,"user_name":"杰魁","can_delete":false,"product_type":"c1","uid":1169775,"ip_address":"","ucode":"D9E4AC416F793E","user_header":"https://static001.geekbang.org/account/avatar/00/11/d9/6f/553aeb40.jpg","comment_is_top":false,"comment_ctime":1552740213,"is_pvip":false,"discussion_count":11,"race_medal":0,"score":"293610516341","product_id":100015201,"comment_content":"用了虚拟机，科学上网的问题一个接着一个，搞了一个星期烦死了，最后直接买了美国的3台服务器，只需几分钟就完成了这个章节的所有部署。","like_count":69,"discussions":[{"author":{"id":1220312,"avatar":"https://static001.geekbang.org/account/avatar/00/12/9e/d8/2e14f21e.jpg","nickname":"EasyOps@刘劲辉","note":"","ucode":"4E31C18E1D04D9","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":281275,"discussion_content":"这些需要翻墙的镜像源，国内都有加速站点，可以先 docker pull 下来，然后使用 kubeadm 指定版本进行安装即可。","likes_number":5,"is_delete":false,"is_hidden":false,"ctime":1591704428,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":2449991,"avatar":"","nickname":"田志强","note":"","ucode":"1CE42AACA2CD94","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":352757,"discussion_content":"科学上网一直是个壁垒","likes_number":1,"is_delete":false,"is_hidden":false,"ctime":1614841280,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":2117362,"avatar":"https://static001.geekbang.org/account/avatar/00/20/4e/f2/a3314a28.jpg","nickname":"鹤无双","note":"","ucode":"785B47B34FFBDC","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":352082,"discussion_content":"用阿里云镜像就可以了","likes_number":1,"is_delete":false,"is_hidden":false,"ctime":1614597262,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":1,"child_discussions":[{"author":{"id":1068451,"avatar":"https://static001.geekbang.org/account/avatar/00/10/4d/a3/3b922cdf.jpg","nickname":"Boyka Ou","note":"","ucode":"87264DD6983580","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":2117362,"avatar":"https://static001.geekbang.org/account/avatar/00/20/4e/f2/a3314a28.jpg","nickname":"鹤无双","note":"","ucode":"785B47B34FFBDC","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":379802,"discussion_content":"是不是还需要网络好呀？我的死活超时","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1624163536,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":352082,"ip_address":""},"score":379802,"extra":""}]},{"author":{"id":2106758,"avatar":"http://thirdwx.qlogo.cn/mmopen/vi_32/XErROVgjgeLSBGdUQR7l4duM5iapX4lNCEKv3P7eoLczUzVytsVhWNuD2NjkBUj4r9icIFvNnUaPunBEzJBq2Maw/132","nickname":"Geek_wj","note":"","ucode":"824B2D5F2BFD35","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":296604,"discussion_content":"vultr可以","likes_number":1,"is_delete":false,"is_hidden":false,"ctime":1596599189,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1266698,"avatar":"https://static001.geekbang.org/account/avatar/00/13/54/0a/9a002ad5.jpg","nickname":"Adam Lau","note":"","ucode":"7E542D6E789500","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":287889,"discussion_content":"同问，哪里买的美国服务器","likes_number":1,"is_delete":false,"is_hidden":false,"ctime":1593579670,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1064133,"avatar":"https://static001.geekbang.org/account/avatar/00/10/3c/c5/92017a7b.jpg","nickname":"硕果阳光","note":"","ucode":"C59841EB675535","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":229427,"discussion_content":"您好 请问在哪里买的服务器 谢谢","likes_number":1,"is_delete":false,"is_hidden":false,"ctime":1586649913,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":1,"child_discussions":[{"author":{"id":1169775,"avatar":"https://static001.geekbang.org/account/avatar/00/11/d9/6f/553aeb40.jpg","nickname":"杰魁","note":"","ucode":"D9E4AC416F793E","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":1064133,"avatar":"https://static001.geekbang.org/account/avatar/00/10/3c/c5/92017a7b.jpg","nickname":"硕果阳光","note":"","ucode":"C59841EB675535","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":312357,"discussion_content":"vultr","likes_number":1,"is_delete":false,"is_hidden":false,"ctime":1602669145,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":229427,"ip_address":""},"score":312357,"extra":""}]},{"author":{"id":1251835,"avatar":"http://thirdwx.qlogo.cn/mmopen/vi_32/oiboHpgukqib2ASXeU0H7W1ibgRMqyrNE5KaWicicPEDy0ia8YdoneZAtvW0EFIiaqZJp2OS4dnweOgXaJ5EjJicicEqic5A/132","nickname":"覃钰栋","note":"","ucode":"19080C463658EF","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":412506,"discussion_content":"正有此意购买服务器，本地用虚拟机太麻烦了","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1636195210,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1696456,"avatar":"","nickname":"贝少芬","note":"","ucode":"5C04C7C524DCF9","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":50236,"discussion_content":"请问用的是AWS吗？","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1573694952,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":1,"child_discussions":[{"author":{"id":1169775,"avatar":"https://static001.geekbang.org/account/avatar/00/11/d9/6f/553aeb40.jpg","nickname":"杰魁","note":"","ucode":"D9E4AC416F793E","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":1696456,"avatar":"","nickname":"贝少芬","note":"","ucode":"5C04C7C524DCF9","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":312358,"discussion_content":"vultr","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1602669154,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":50236,"ip_address":""},"score":312358,"extra":""}]}]},{"had_liked":false,"id":127257,"user_name":"东方奇骥","can_delete":false,"product_type":"c1","uid":1354850,"ip_address":"","ucode":"DEE7085F7E55A4","user_header":"https://static001.geekbang.org/account/avatar/00/14/ac/62/37912d51.jpg","comment_is_top":false,"comment_ctime":1566624613,"is_pvip":true,"discussion_count":5,"race_medal":0,"score":"285034466149","product_id":100015201,"comment_content":"国内，用阿里云源安装就可以了，速度很快：<br>1. apt-get update &amp;&amp; apt-get install -y apt-transport-https<br>2. curl https:&#47;&#47;mirrors.aliyun.com&#47;kubernetes&#47;apt&#47;doc&#47;apt-key.gpg | apt-key add - <br>3. 将deb https:&#47;&#47;mirrors.aliyun.com&#47;kubernetes&#47;apt&#47; kubernetes-xenial main 加入到下面文件中，没有就创建<br>&#47;etc&#47;apt&#47;sources.list.d&#47;kubernetes.list<br>4.apt-get update<br>5.apt-get install -y kubelet kubeadm kubectl","like_count":67,"discussions":[{"author":{"id":2864768,"avatar":"https://static001.geekbang.org/account/avatar/00/2b/b6/80/2327060c.jpg","nickname":"糖炒栗子","note":"","ucode":"6A59DDE825E266","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":537682,"discussion_content":"踩坑历程 https://blog.csdn.net/csdn_tclz/article/details/121864572","likes_number":1,"is_delete":false,"is_hidden":false,"ctime":1639142779,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":1,"child_discussions":[{"author":{"id":1125834,"avatar":"https://static001.geekbang.org/account/avatar/00/11/2d/ca/02b0e397.jpg","nickname":"fomy","note":"","ucode":"CD87EA03B1F327","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":2864768,"avatar":"https://static001.geekbang.org/account/avatar/00/2b/b6/80/2327060c.jpg","nickname":"糖炒栗子","note":"","ucode":"6A59DDE825E266","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":541561,"discussion_content":"太感谢了，终于部署成功了","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1640446408,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":537682,"ip_address":""},"score":541561,"extra":""}]},{"author":{"id":2864768,"avatar":"https://static001.geekbang.org/account/avatar/00/2b/b6/80/2327060c.jpg","nickname":"糖炒栗子","note":"","ucode":"6A59DDE825E266","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":537598,"discussion_content":"感谢！","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1639112069,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":2567536,"avatar":"https://static001.geekbang.org/account/avatar/00/27/2d/70/1f942319.jpg","nickname":"萝卜","note":"","ucode":"E0627222B70145","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":414553,"discussion_content":"这个太赞了","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1636811696,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1113864,"avatar":"https://static001.geekbang.org/account/avatar/00/10/ff/08/7c18d8a4.jpg","nickname":"团","note":"","ucode":"D56ABBCE4E4D90","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":409366,"discussion_content":"Mark","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1635426663,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":320621,"user_name":"penng","can_delete":false,"product_type":"c1","uid":1033169,"ip_address":"","ucode":"6087CFCB0AC434","user_header":"https://static001.geekbang.org/account/avatar/00/0f/c3/d1/bdf895bf.jpg","comment_is_top":false,"comment_ctime":1636425870,"is_pvip":false,"discussion_count":5,"race_medal":0,"score":"242154594446","product_id":100015201,"comment_content":"我说2021年11月才开始看这个课程，这是kubuadm安装的版本已经1.22.3了。也遇到了很多问题，这里总结一下，未来的新同学供参考。<br>1. 使用yum 安装kubeadm和docker后，这俩使用的cgroup驱动不一致。需要在指定docker的cgroup驱动为system。添加如下配置文件，并重启docker服务。<br>\t vim &#47;etc&#47;docker&#47;daemon.json<br>{<br>        &quot;exec-opts&quot;: [&quot;native.cgroupdriver=systemd&quot;],<br>        &quot;log-driver&quot;: &quot;json-file&quot;,<br>        &quot;log-opts&quot;: {<br>                &quot;max-size&quot;: &quot;100m&quot;<br>        }<br>}<br>2. 在写kubeadm.yaml文件时候，老师为了让kube-controller-manager 能够使用自定义资源进行自动水平扩展。加了：horizontal-pod-autoscaler-use-rest-clients: &quot;true&quot;。其实版本1.20以上应该，已经不支持该参数，会导致kube-controller-manager怎么也启动不起来。且新版本的yaml文件的配置格式也有一些变化，我的配置文件如下：<br>vim kubeadm.yaml<br>apiVersion: kubeadm.k8s.io&#47;v1beta3  #版本信息参考kubeadm config print init-defaults命令结果<br>kind: ClusterConfiguration<br>kubernetesVersion: 1.22.3  #版本信息参考kubeadm config print init-defaults命令结果<br>imageRepository: registry.aliyuncs.com&#47;google_containers #配置国内镜像<br><br>apiServer:<br>  extraArgs:<br>    runtime-config: &quot;api&#47;all=true&quot;<br><br>#controllerManager:<br>#  extraArgs:<br>#    horizontal-pod-autoscaler-use-rest-clients: &quot;true&quot; #开启kube-controller-manager能够使用自定义资源（Custom Metrics）进行自动水平扩展,但是高版本不支持该参数需要去掉。<br>#    horizontal-pod-autoscaler-sync-period: &quot;10s&quot;<br>#    node-monitor-grace-period: &quot;10s&quot;  <br><br>etcd:<br>  local:<br>    dataDir: &#47;data&#47;k8s&#47;etcd<br><br>3. 使用kubeadm init后，能成功生成token。但是使用 kubeadm get cs命令看到kube- schedule和kube-controller-manager组件始终起不来，报错日志就是连接127.0.0.1:10251和127.0.0.1:10252超时。这时候需要在&#47;etc&#47;kubernetes&#47;manifests&#47;kube-controller-manager.yaml 和kube-scheduler.yaml文件的--port=0这一行注释掉。并重启kubelet。systemctl restart kubelet<br><br>4. 其他安装镜像或者插件网络或版本兼容问题，其他留言太精彩都留下了解决方案。可以参考，谢谢大家。<br><br>我把我遇到的问题和解决方案也分享处理，供大家参考","like_count":57,"discussions":[{"author":{"id":2948603,"avatar":"","nickname":"woJA1wCgAAQCD8Zz0w-d1Wjxc-t2eYDA","note":"","ucode":"7ADE9F6719AC2C","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":566455,"discussion_content":"为什么修改docker 的daemon时候  会报错 E212","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1650691344,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":2415188,"avatar":"https://static001.geekbang.org/account/avatar/00/24/da/54/feb32c3f.jpg","nickname":"Barry Yan","note":"","ucode":"739F505066AFE0","race_medal":5,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":565301,"discussion_content":"厉害了大佬","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1650435057,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":2075451,"avatar":"https://static001.geekbang.org/account/avatar/00/1f/ab/3b/7c933d73.jpg","nickname":"StormyNight","note":"","ucode":"C82863C5D68919","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":540030,"discussion_content":"感谢，搞了一个周末终于起来了，怀疑人生","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1639923054,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":2223826,"avatar":"https://static001.geekbang.org/account/avatar/00/21/ee/d2/2bd80849.jpg","nickname":"黄","note":"","ucode":"722937E14825E4","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":539757,"discussion_content":"你好大佬，想请问一下你网络插件怎么安装的0.0","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1639832561,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":1,"child_discussions":[{"author":{"id":1347181,"avatar":"https://static001.geekbang.org/account/avatar/00/14/8e/6d/c68e07ef.jpg","nickname":"Chino","note":"","ucode":"0240D89E5F74B4","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":2223826,"avatar":"https://static001.geekbang.org/account/avatar/00/21/ee/d2/2bd80849.jpg","nickname":"黄","note":"","ucode":"722937E14825E4","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":543592,"discussion_content":"kubectl apply -n kube-system -f &#34;https://cloud.weave.works/k8s/net?k8s-version=$(kubectl version | base64 | tr -d &#39;\\n&#39;)&#34;","likes_number":1,"is_delete":false,"is_hidden":false,"ctime":1641216727,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":539757,"ip_address":""},"score":543592,"extra":""}]}]},{"had_liked":false,"id":28948,"user_name":"Roy Liang","can_delete":false,"product_type":"c1","uid":1098898,"ip_address":"","ucode":"1DF5FC831A35DA","user_header":"https://static001.geekbang.org/account/avatar/00/10/c4/92/338b5609.jpg","comment_is_top":false,"comment_ctime":1538204602,"is_pvip":false,"replies":[{"id":"10486","content":"对对对","user_name":"作者回复","user_name_real":"Geek_6ef93d","uid":"1218095","ctime":1538278104,"ip_address":"","comment_id":28948,"utype":1}],"discussion_count":6,"race_medal":0,"score":"242056373178","product_id":100015201,"comment_content":"kubeadm最新版本已经为1.12，看到上面很多人遇到提示版本不对，重新安装低版本就好了<br>apt remove kubelet kubectl kubeadm<br>apt install kubelet=1.11.3-00<br>apt install kubectl=1.11.3-00<br>apt install kubeadm=1.11.3-00","like_count":56,"discussions":[{"author":{"id":1218095,"avatar":"https://static001.geekbang.org/account/avatar/00/12/96/2f/876085fa.jpg","nickname":"张磊 Kubernetes","note":"","ucode":"16E29BDAB1F5BC","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":425440,"discussion_content":"对对对","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1538278104,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1456256,"avatar":"","nickname":"千回百转无劫山","note":"","ucode":"2C249889C00929","race_medal":0,"user_type":1,"is_pvip":true},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":383310,"discussion_content":"哈哈，我安装的是最新版本，遇到问题才好，解决就行了。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1626055716,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":2449991,"avatar":"","nickname":"田志强","note":"","ucode":"1CE42AACA2CD94","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":352756,"discussion_content":"ubuntu用的不多，安装软件一般用apt还是apt-get，这两个安装有区别吗","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1614841201,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":2377045,"avatar":"","nickname":"Geek_ad0591","note":"","ucode":"9A224BBDCB8A09","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":336619,"discussion_content":"还要安装一个kubernetes-cni符合dependency, apt install kubernetes-cni=0.6.0-00","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1608635763,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":2366832,"avatar":"https://static001.geekbang.org/account/avatar/00/24/1d/70/5eeb0fff.jpg","nickname":"张","note":"","ucode":"10976FD42A2C02","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":334669,"discussion_content":"执行后报这个错误","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1607932535,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":2366832,"avatar":"https://static001.geekbang.org/account/avatar/00/24/1d/70/5eeb0fff.jpg","nickname":"张","note":"","ucode":"10976FD42A2C02","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":334668,"discussion_content":"E: Unable to correct problems, you have held broken packages.","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1607932520,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":161798,"user_name":"张晓辉","can_delete":false,"product_type":"c1","uid":1085046,"ip_address":"","ucode":"1CD9717DE399C5","user_header":"https://static001.geekbang.org/account/avatar/00/10/8e/76/6d55e26f.jpg","comment_is_top":false,"comment_ctime":1576333340,"is_pvip":false,"discussion_count":8,"race_medal":0,"score":"229209600028","product_id":100015201,"comment_content":"最新版本的kubeadm.yaml:<br>cat &lt;&lt;EOF &gt; kubeadm.yaml<br>apiVersion: kubeadm.k8s.io&#47;v1beta2<br>kind: ClusterConfiguration<br>controllerManager:<br>    extraArgs:<br>        horizontal-pod-autoscaler-use-rest-clients: &quot;true&quot;<br>        horizontal-pod-autoscaler-sync-period: &quot;10s&quot;<br>        node-monitor-grace-period: &quot;10s&quot;<br>apiServer:<br>    extraArgs:<br>        runtime-config: &quot;api&#47;all=true&quot;<br>kubernetesVersion: &quot;v1.17.0&quot;<br>EOF<br><br>同时，部署网络插件的命令： <br>kubectl apply -f &quot;https:&#47;&#47;cloud.weave.works&#47;k8s&#47;net?k8s-version=$(kubectl version | base64 | tr -d &#39;\\n&#39;)&quot;<br><br>&quot;kubeadm config print init-defaults&quot;这个命令可以告诉我们kubeadm.yaml版本信息。","like_count":53,"discussions":[{"author":{"id":1119133,"avatar":"https://static001.geekbang.org/account/avatar/00/11/13/9d/0ff43179.jpg","nickname":"Andy","note":"","ucode":"4BCA899B8E4E85","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":216594,"discussion_content":"太感谢亲了。用的方法解决了。我网络不通默认地址，我在yaml文件最后一行加了以下内容，顺利通过。\nimageRepository: registry.aliyuncs.com/google_containers ","likes_number":5,"is_delete":false,"is_hidden":false,"ctime":1585468698,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":2,"child_discussions":[{"author":{"id":1837697,"avatar":"https://static001.geekbang.org/account/avatar/00/1c/0a/81/69fecff9.jpg","nickname":"xiaopi3","note":"","ucode":"1C92D0CDC0B39E","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":1119133,"avatar":"https://static001.geekbang.org/account/avatar/00/11/13/9d/0ff43179.jpg","nickname":"Andy","note":"","ucode":"4BCA899B8E4E85","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":294642,"discussion_content":"这个真是大神操作，终于搞定了！开心","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1595947967,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":216594,"ip_address":""},"score":294642,"extra":""},{"author":{"id":2014285,"avatar":"https://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTKNv880TlsNuKaWcKbxiaAZTQIBWfJAddC8wfOROnwRPRwJXaEGSTBH2sic4jK7IGpxZn79tTDcREjw/132","nickname":"Geek_7482f6","note":"","ucode":"F3565F78525D30","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":1119133,"avatar":"https://static001.geekbang.org/account/avatar/00/11/13/9d/0ff43179.jpg","nickname":"Andy","note":"","ucode":"4BCA899B8E4E85","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":586159,"discussion_content":"2022-9-1,kubernetes 1.25.0版本，亲测可用","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1662011111,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":216594,"ip_address":"广东"},"score":586159,"extra":""}]},{"author":{"id":1087879,"avatar":"https://static001.geekbang.org/account/avatar/00/10/99/87/98ebb20e.jpg","nickname":"dao","note":"","ucode":"4181FB270462CF","race_medal":0,"user_type":1,"is_pvip":true},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":307773,"discussion_content":"网络插件可以参考这个 https://www.weave.works/docs/net/latest/kubernetes/kube-addon/","likes_number":1,"is_delete":false,"is_hidden":false,"ctime":1600756401,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":2357566,"avatar":"https://static001.geekbang.org/account/avatar/00/23/f9/3e/0d5f27c4.jpg","nickname":"肥猫不开心","note":"","ucode":"FA9204B84913C0","race_medal":0,"user_type":1,"is_pvip":true},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":383777,"discussion_content":"这个apiVersion: kubeadm.k8s.io/v1beta2给我整吐了 我换了好多个，还是你能用","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1626235467,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":2233415,"avatar":"https://static001.geekbang.org/account/avatar/00/22/14/47/537ebbb3.jpg","nickname":"SIG","note":"","ucode":"ADE7A829EB5796","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":314490,"discussion_content":"存储插件呢","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1603162332,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1189157,"avatar":"https://static001.geekbang.org/account/avatar/00/12/25/25/c74e31d0.jpg","nickname":"NorthernReach","note":"","ucode":"0C6F3C5B7F3043","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":295991,"discussion_content":"Ubuntu 18.04，确认可用，感谢！","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1596422306,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1325101,"avatar":"https://static001.geekbang.org/account/avatar/00/14/38/2d/9c971119.jpg","nickname":"若丶相依","note":"","ucode":"6482339C859C40","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":174509,"discussion_content":"帮了大忙 ","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1581923819,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":33728,"user_name":"龙哥","can_delete":false,"product_type":"c1","uid":1153212,"ip_address":"","ucode":"F9B5F6A8C3A9D8","user_header":"https://static001.geekbang.org/account/avatar/00/11/98/bc/e22fcc1b.jpg","comment_is_top":false,"comment_ctime":1539864926,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"186223458654","product_id":100015201,"comment_content":"对于GFW，不能直接给kubeadm上代理，而是要让docker daemon翻，正确姿势参见：<br>https:&#47;&#47;stackoverflow.com&#47;questions&#47;26550360&#47;docker-ubuntu-behind-proxy","like_count":43},{"had_liked":false,"id":81786,"user_name":"___","can_delete":false,"product_type":"c1","uid":1229519,"ip_address":"","ucode":"B0BA5A1413798C","user_header":"https://static001.geekbang.org/account/avatar/00/12/c2/cf/573a0fdc.jpg","comment_is_top":false,"comment_ctime":1554034848,"is_pvip":false,"discussion_count":2,"race_medal":0,"score":"177647693984","product_id":100015201,"comment_content":"kubeadm 1.14 配置文件<br><br>apiVersion: kubeadm.k8s.io&#47;v1beta1<br>kind: ClusterConfiguration<br>controllerManager:<br>    extraArgs:<br>        horizontal-pod-autoscaler-use-rest-clients: &quot;true&quot;<br>        horizontal-pod-autoscaler-sync-period: &quot;10s&quot;<br>        node-monitor-grace-period: &quot;10s&quot;<br>apiServer:<br>    extraArgs:<br>        runtime-config: &quot;api&#47;all=true&quot;<br>kubernetesVersion: &quot;stable-1.14&quot;<br><br>相关文档：https:&#47;&#47;godoc.org&#47;k8s.io&#47;kubernetes&#47;cmd&#47;kubeadm&#47;app&#47;apis&#47;kubeadm&#47;v1beta1<br><br>备注这个针对版本号为1.14的","like_count":41,"discussions":[{"author":{"id":1071509,"avatar":"https://static001.geekbang.org/account/avatar/00/10/59/95/a164fa5c.jpg","nickname":"soddygo","note":"","ucode":"E1D4D272C95804","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":3127,"discussion_content":"新版本的需要关闭swap交换空间,命令: swapoff -a","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1564205552,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1071509,"avatar":"https://static001.geekbang.org/account/avatar/00/10/59/95/a164fa5c.jpg","nickname":"soddygo","note":"","ucode":"E1D4D272C95804","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":3126,"discussion_content":"很赞,自己找文档,改成最新的,找了很久,尝试改也没成功","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1564205409,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":89396,"user_name":"cuikt","can_delete":false,"product_type":"c1","uid":1242702,"ip_address":"","ucode":"9A1DB426CEFEEA","user_header":"https://static001.geekbang.org/account/avatar/00/12/f6/4e/0066303c.jpg","comment_is_top":false,"comment_ctime":1556163401,"is_pvip":false,"discussion_count":8,"race_medal":0,"score":"121815247689","product_id":100015201,"comment_content":"CentOS Linux release 7.6.1810 (Core) <br>Kubernetes  v1.14.1<br>按照文档部署Rook时会报错<br>Error from server (NotFound): error when creating &quot;operator.yaml&quot;: namespaces &quot;rook-ceph&quot; not found<br><br>error: unable to recognize &quot;cluster.yaml&quot;: no matches for kind &quot;CephCluster&quot; in version &quot;ceph.rook.io&#47;v1&quot;<br><br>解决方式：先apply common.yaml  再执行后续apply<br>kubectl apply -f https:&#47;&#47;raw.githubusercontent.com&#47;rook&#47;rook&#47;master&#47;cluster&#47;examples&#47;kubernetes&#47;ceph&#47;common.yaml","like_count":28,"discussions":[{"author":{"id":1217102,"avatar":"https://static001.geekbang.org/account/avatar/00/12/92/4e/28e25c84.jpg","nickname":"Lucifer","note":"","ucode":"241B13B65F5B94","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":353717,"discussion_content":"先kubectl apply -f https://raw.githubusercontent.com/rook/rook/master/cluster/examples/kubernetes/ceph/crds.yaml，在后续的版本中crds被单独拆出来了，需要单独安装","likes_number":4,"is_delete":false,"is_hidden":false,"ctime":1615195805,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1793879,"avatar":"http://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTLJHTX1IwEl1Eh1CCO2ejL2gKe08Vxib61UZz9l5WGA81ObK0Nk5MCZ3ic6IWcW5kyX0DtwBNMEMl2Q/132","nickname":"Geek_8ed998","note":"","ucode":"1C164836354665","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":340383,"discussion_content":"no matches for kind &#34;CephCluster&#34; in version &#34;ceph.rook.io/v1&#34; 还是这样","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1609991146,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":2,"child_discussions":[{"author":{"id":1566100,"avatar":"","nickname":"Geek_0191e2","note":"","ucode":"6E505189B05339","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":1793879,"avatar":"http://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTLJHTX1IwEl1Eh1CCO2ejL2gKe08Vxib61UZz9l5WGA81ObK0Nk5MCZ3ic6IWcW5kyX0DtwBNMEMl2Q/132","nickname":"Geek_8ed998","note":"","ucode":"1C164836354665","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":345715,"discussion_content":"最后怎么解决的","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1611764652,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":340383,"ip_address":""},"score":345715,"extra":""},{"author":{"id":1394019,"avatar":"https://static001.geekbang.org/account/avatar/00/15/45/63/d3319b80.jpg","nickname":"奔跑的蜗牛","note":"","ucode":"88D855ED42F134","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":1566100,"avatar":"","nickname":"Geek_0191e2","note":"","ucode":"6E505189B05339","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":350125,"discussion_content":"估计是版本问题 你可以看下兼容的版本","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1613718595,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":345715,"ip_address":""},"score":350125,"extra":""}]},{"author":{"id":1752876,"avatar":"https://static001.geekbang.org/account/avatar/00/1a/bf/2c/de7cc672.jpg","nickname":"云芒","note":"","ucode":"88D0E856146E94","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":194553,"discussion_content":"多谢\n","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1583231241,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1260026,"avatar":"https://static001.geekbang.org/account/avatar/00/13/39/fa/a7edbc72.jpg","nickname":"安排","note":"","ucode":"F78CFA9624CAEF","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":109321,"discussion_content":"多谢","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1577683265,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1209532,"avatar":"https://static001.geekbang.org/account/avatar/00/12/74/bc/27ded226.jpg","nickname":"Dylan","note":"","ucode":"44FCD583D14404","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":87573,"discussion_content":"Thx","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1576673687,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1292206,"avatar":"https://static001.geekbang.org/account/avatar/00/13/b7/ae/a25fcb73.jpg","nickname":"colin","note":"","ucode":"7A8849B8AE33E0","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":5718,"discussion_content":"被困扰中，多谢","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1566444820,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":24781,"user_name":"JefferLiu","can_delete":false,"product_type":"c1","uid":1213125,"ip_address":"","ucode":"3186C9CCC8AEF6","user_header":"https://static001.geekbang.org/account/avatar/00/12/82/c5/4152b39e.jpg","comment_is_top":false,"comment_ctime":1537193090,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"113206342786","product_id":100015201,"comment_content":"ubuntu 换成这个源<br>deb http:&#47;&#47;mirrors.ustc.edu.cn&#47;kubernetes&#47;apt kubernetes-xenial main","like_count":26},{"had_liked":false,"id":86977,"user_name":"Andy","can_delete":false,"product_type":"c1","uid":1500888,"ip_address":"","ucode":"E895030BE6D4CB","user_header":"https://static001.geekbang.org/account/avatar/00/16/e6/d8/8939848a.jpg","comment_is_top":false,"comment_ctime":1555491187,"is_pvip":false,"replies":[{"id":"31571","content":"又更新啦，@编辑","user_name":"作者回复","user_name_real":"Geek_6ef93d","uid":"1218095","ctime":1555695544,"ip_address":"","comment_id":86977,"utype":1}],"discussion_count":6,"race_medal":0,"score":"104634706291","product_id":100015201,"comment_content":"最新的部署ceph cluster需要多一条部署命令才可以部署成功：<br>1. kubectl apply -f https:&#47;&#47;raw.githubusercontent.com&#47;rook&#47;rook&#47;master&#47;cluster&#47;examples&#47;kubernetes&#47;ceph&#47;common.yaml<br>2. kubectl apply -f https:&#47;&#47;raw.githubusercontent.com&#47;rook&#47;rook&#47;master&#47;cluster&#47;examples&#47;kubernetes&#47;ceph&#47;operator.yaml<br>3. kubectl apply -f https:&#47;&#47;raw.githubusercontent.com&#47;rook&#47;rook&#47;master&#47;cluster&#47;examples&#47;kubernetes&#47;ceph&#47;cluster.yaml","like_count":24,"discussions":[{"author":{"id":1218095,"avatar":"https://static001.geekbang.org/account/avatar/00/12/96/2f/876085fa.jpg","nickname":"张磊 Kubernetes","note":"","ucode":"16E29BDAB1F5BC","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":447268,"discussion_content":"又更新啦，@编辑","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1555695544,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1259879,"avatar":"https://static001.geekbang.org/account/avatar/00/13/39/67/743128f7.jpg","nickname":"书木子谢明","note":"","ucode":"3090C080A570BE","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":338238,"discussion_content":"2020/12/19实验时，还需要执行一条命令： \nkubectl apply -f https://raw.githubusercontent.com/rook/rook/master/cluster/examples/kubernetes/ceph/crds.yaml","likes_number":6,"is_delete":false,"is_hidden":false,"ctime":1609221151,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":1,"child_discussions":[{"author":{"id":2117362,"avatar":"https://static001.geekbang.org/account/avatar/00/20/4e/f2/a3314a28.jpg","nickname":"鹤无双","note":"","ucode":"785B47B34FFBDC","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":1259879,"avatar":"https://static001.geekbang.org/account/avatar/00/13/39/67/743128f7.jpg","nickname":"书木子谢明","note":"","ucode":"3090C080A570BE","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":352084,"discussion_content":"谢了兄弟","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1614597351,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":338238,"ip_address":""},"score":352084,"extra":""}]},{"author":{"id":1433247,"avatar":"https://static001.geekbang.org/account/avatar/00/15/de/9f/b6c59a75.jpg","nickname":"dust！","note":"","ucode":"7ADCCC7985B381","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":301261,"discussion_content":"rook-ceph-crashcollector-node1-566fd64469-sbjw6   0/1     Init:0/2  一直卡在这里，报这个错误“MountVolume.SetUp failed for volume &#34;rook-ceph-crash-collector-keyring&#34; : secret &#34;rook-ceph-crash-collector-keyring&#34; not foun”","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1598454338,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1000439,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/43/f7/abb7bfe3.jpg","nickname":"刘冲","note":"","ucode":"0C4F66921AE76C","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":6039,"discussion_content":"谢谢","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1566636025,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1132456,"avatar":"https://static001.geekbang.org/account/avatar/00/11/47/a8/ec330e70.jpg","nickname":"Doninic","note":"","ucode":"A5EF65CCF53578","race_medal":0,"user_type":1,"is_pvip":true},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":194,"discussion_content":"谢谢了，卡到这，刚看到","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1561271027,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":24582,"user_name":"Xiye","can_delete":false,"product_type":"c1","uid":1062516,"ip_address":"","ucode":"9F8E73180435AF","user_header":"http://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTIGzSM6be2xCNS00kQYHDgXO3icOoOSsvnz3FiaCov5Kgs6oaXkBicLbicuEerJjiaNPWxB0FTVmdur3kg/132","comment_is_top":false,"comment_ctime":1537153606,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"104616368710","product_id":100015201,"comment_content":"1. 使用过Minikube在自己本机装过K8S，步骤很简单。这个应该比较适合开发使用，不用花太多时间在部署上，但是因为是SingleNode，肯定是不能用于生产。<br>2. 网上查了官方，支持最多5000节点规模的集群。目前我们项目用得3个Master，3个Work Node。","like_count":24},{"had_liked":false,"id":40945,"user_name":"我还是猴子","can_delete":false,"product_type":"c1","uid":1284313,"ip_address":"","ucode":"51CB7CF694F5CC","user_header":"https://static001.geekbang.org/account/avatar/00/13/98/d9/e634ec30.jpg","comment_is_top":false,"comment_ctime":1542700307,"is_pvip":false,"discussion_count":1,"race_medal":0,"score":"100326948115","product_id":100015201,"comment_content":"kubernetes 1.12.2&#47;docker-ce 18.09  <br><br><br>老师的文档是老版本的，看了留言很多 apiversion错误的需要调整老师给的kubeadm init 的kubeadm.yaml文件<br>老版本：<br>apiVersion: kubeadm.k8s.io&#47;v1alpha1<br>kind: MasterConfiguration<br>controllerManagerExtraArgs:<br>  horizontal-pod-autoscaler-use-rest-clients: &quot;true&quot;<br>  horizontal-pod-autoscaler-sync-period: &quot;10s&quot;<br>  node-monitor-grace-period: &quot;10s&quot;<br>apiServerExtraArgs:<br>  runtime-config: &quot;api&#47;all=true&quot;<br>kubernetesVersion: &quot;stable-1.11&quot;<br><br>新版本：<br>apiVersion: kubeadm.k8s.io&#47;v1alpha2<br>kind: MasterConfiguration<br>controllerManagerExtraArgs:<br>  horizontal-pod-autoscaler-use-rest-clients: &quot;true&quot;<br>  horizontal-pod-autoscaler-sync-period: &quot;10s&quot;<br>  node-monitor-grace-period: &quot;10s&quot;<br>apiServerExtraArgs:<br>  runtime-config: &quot;api&#47;all=true&quot;<br>kubernetesVersion: &quot;stable-1.12&quot;<br>需要注意<br>v1alpha2 will be removed in Kubernetes 1.13.  1.13启用v1alpha3  后续有同学也要注意","like_count":23,"discussions":[{"author":{"id":1172029,"avatar":"https://static001.geekbang.org/account/avatar/00/11/e2/3d/9a52946b.jpg","nickname":"天若有情天亦老","note":"","ucode":"57F0B7D524C0CF","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":94863,"discussion_content":"现在1.13版本也出问题了 - - ","likes_number":1,"is_delete":false,"is_hidden":false,"ctime":1576996027,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":24579,"user_name":"微思","can_delete":false,"product_type":"c1","uid":1004349,"ip_address":"","ucode":"853C48AA183A7B","user_header":"https://static001.geekbang.org/account/avatar/00/0f/53/3d/1189e48a.jpg","comment_is_top":false,"comment_ctime":1537151922,"is_pvip":true,"discussion_count":4,"race_medal":4,"score":"100321399730","product_id":100015201,"comment_content":"老师您好！专网，不能访问互联网的情况下，离线部署kubernetes集群？有没有好的方法和建议？","like_count":23,"discussions":[{"author":{"id":2161488,"avatar":"","nickname":"Geek_e42b34","note":"","ucode":"F5F56BEF024FC7","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":304330,"discussion_content":"https://finolo.gy/2019/12/%E9%80%9A%E8%BF%87kubeadm%E7%A6%BB%E7%BA%BF%E5%AE%89%E8%A3%85k8s%E9%9B%86%E7%BE%A4v1-15/ 这篇文章应该是你需要的，我刚刚根据指导，已经完成了再生产环境的搭建（完全隔离网络）","likes_number":6,"is_delete":false,"is_hidden":false,"ctime":1599548016,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":2058106,"avatar":"https://static001.geekbang.org/account/avatar/00/1f/67/7a/94f6c178.jpg","nickname":"米唐","note":"","ucode":"B56506718181CE","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":293548,"discussion_content":"腾讯开源的tkestack，下载的tke-installer包含安装所需的所有资源，后面的步骤里也可以配置建立本地仓库。\nhttps://github.com/tkestack/tke/blob/master/docs/guide/zh-CN/installation/installation-procedures.md","likes_number":2,"is_delete":false,"is_hidden":false,"ctime":1595577343,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1910351,"avatar":"https://static001.geekbang.org/account/avatar/00/1d/26/4f/c93dd361.jpg","nickname":"骏弘兄","note":"","ucode":"6FA67F3CD583F0","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":212649,"discussion_content":"新的开源产品KubeOperator了解一下","likes_number":2,"is_delete":false,"is_hidden":false,"ctime":1584984750,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1396349,"avatar":"http://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTI0vgyzbd0JpicemW8x65j7ibEicz7CPgu05NCWKknrqQCEDDAg9JasOjbFeqFia6JUP2Sib7wkYH4nzPw/132","nickname":"jundiwang","note":"","ucode":"B27A5582250376","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":78022,"discussion_content":"可以配置本地含有k8s的yum源。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1575968958,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":296141,"user_name":"郎晓伟","can_delete":false,"product_type":"c1","uid":1960949,"ip_address":"","ucode":"AF2EA922BCF4FC","user_header":"https://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTIp6Ln5VriaBK6uVt3lEOq3UXTVfb4sv2KS3fEH1CiaCeJ69hUcmS35nibJEcRTa1KTa3W5uk60TVM1Q/132","comment_is_top":false,"comment_ctime":1622775144,"is_pvip":false,"discussion_count":3,"race_medal":0,"score":"74637219176","product_id":100015201,"comment_content":"kubeadm 1.21.1 配置文件kubeadm.yaml：<br><br>apiVersion: kubeadm.k8s.io&#47;v1beta2<br>kind: ClusterConfiguration<br>controllerManager:<br>  extraArgs:<br>    horizontal-pod-autoscaler-use-rest-clients: &quot;true&quot;<br>    horizontal-pod-autoscaler-sync-period: &quot;10s&quot;<br>    node-monitor-grace-period: &quot;10s&quot;<br>apiServer:<br>  extraArgs:<br>    runtime-config: &quot;api&#47;all=true&quot;<br>kubernetesVersion: v1.21.1<br>imageRepository: registry.aliyuncs.com&#47;google_containers<br><br>以上配置文件适用于最新版本的K8s 1.21.1，和Docker 20.10.7 截止2021-06-04。<br><br>注意：这篇文章中使用的版本已经严重落后，而且我第一次部署的时候时候k8s1.11.0和Dcoker 15，后期会遇到各种版本不符的问题，最后直接卡在存储插件Ceph的安装，所以建议不要使用旧版本了，直接上最新的，同时建议作者更新一下文章中使用的版本。","like_count":17,"discussions":[{"author":{"id":2004538,"avatar":"https://static001.geekbang.org/account/avatar/00/1e/96/3a/e06f8367.jpg","nickname":"胡小涵","note":"","ucode":"2E750C65EC282C","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":407895,"discussion_content":"真心建议作者或者助教老师更新一下文章中使用的版本。感觉这个课我们在2021年跟，有很大的困难，说实话我们花钱买了专栏，但是命令不可用，我们自己花很多时间解决问题，这个用户体验不是很好。","likes_number":8,"is_delete":false,"is_hidden":false,"ctime":1635146369,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1511579,"avatar":"https://static001.geekbang.org/account/avatar/00/17/10/9b/9b139dc8.jpg","nickname":"小朱","note":"","ucode":"8F5841AFA40E0D","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":380273,"discussion_content":"你好，我正在用最新版本部署学习，能加其他联系方式请教一下吗","likes_number":1,"is_delete":false,"is_hidden":false,"ctime":1624419946,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1226493,"avatar":"https://static001.geekbang.org/account/avatar/00/12/b6/fd/a0f60753.jpg","nickname":"牛牛肥","note":"","ucode":"4F455A76F22BB0","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":549110,"discussion_content":"k8s的确是一直在迭代，希望极客时间能及时更新这类时效很强的课程。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1643556619,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":218784,"user_name":"Ben","can_delete":false,"product_type":"c1","uid":1252353,"ip_address":"","ucode":"70351D4FAE47F7","user_header":"https://static001.geekbang.org/account/avatar/00/13/1c/01/5aaaf5b6.jpg","comment_is_top":false,"comment_ctime":1589875115,"is_pvip":false,"discussion_count":1,"race_medal":0,"score":"74604319147","product_id":100015201,"comment_content":"kubeadm 1.18配置<br><br>apiVersion: kubeadm.k8s.io&#47;v1beta2<br>kind: ClusterConfiguration<br>controllerManager:<br>    extraArgs:<br>        horizontal-pod-autoscaler-use-rest-clients: &quot;true&quot;<br>        horizontal-pod-autoscaler-sync-period: &quot;10s&quot;<br>        node-monitor-grace-period: &quot;10s&quot;<br>apiServer:<br>    extraArgs:<br>        runtime-config: &quot;api&#47;all=true&quot;<br>kubernetesVersion: &quot;stable-1.18&quot;<br><br>swap error: sudo swapoff -a","like_count":17,"discussions":[{"author":{"id":1252353,"avatar":"https://static001.geekbang.org/account/avatar/00/13/1c/01/5aaaf5b6.jpg","nickname":"Ben","note":"","ucode":"70351D4FAE47F7","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":271883,"discussion_content":"k8s version 1.18 默认禁用swap","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1590212598,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":270304,"user_name":"飞机翅膀上","can_delete":false,"product_type":"c1","uid":1515223,"ip_address":"","ucode":"D239DFFECDBF01","user_header":"https://static001.geekbang.org/account/avatar/00/17/1e/d7/7d28a531.jpg","comment_is_top":false,"comment_ctime":1609058559,"is_pvip":true,"discussion_count":3,"race_medal":0,"score":"70328535295","product_id":100015201,"comment_content":"1.20 kubeadm.yaml 最新配置<br><br>apiVersion: kubeadm.k8s.io&#47;v1beta2<br>kind: ClusterConfiguration<br>controllerManager:<br>  extraArgs:<br>    horizontal-pod-autoscaler-use-rest-clients: &quot;true&quot;<br>    horizontal-pod-autoscaler-sync-period: &quot;10s&quot;<br>    node-monitor-grace-period: &quot;10s&quot;<br>apiServer:<br>  extraArgs:<br>    runtime-config: &quot;api&#47;all=true&quot;<br>kubernetesVersion: v1.20.0<br>imageRepository: registry.aliyuncs.com&#47;google_containers","like_count":16,"discussions":[{"author":{"id":2680235,"avatar":"https://static001.geekbang.org/account/avatar/00/28/e5/ab/cece3199.jpg","nickname":"jason","note":"","ucode":"0886E1D88BB7CC","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":410319,"discussion_content":"感谢","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1635661757,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":2757674,"avatar":"","nickname":"Geek_17cd18","note":"","ucode":"7CC398F9FB6807","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":393610,"discussion_content":"谢谢您","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1631516836,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1222954,"avatar":"https://static001.geekbang.org/account/avatar/00/12/a9/2a/677d4d6e.jpg","nickname":"hh","note":"","ucode":"0561B9D8C493A6","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":391756,"discussion_content":"mark","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1630627858,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":47460,"user_name":"zeroxus","can_delete":false,"product_type":"c1","uid":1058002,"ip_address":"","ucode":"9DBB3A81F01792","user_header":"https://static001.geekbang.org/account/avatar/00/10/24/d2/40353046.jpg","comment_is_top":false,"comment_ctime":1544145758,"is_pvip":false,"discussion_count":2,"race_medal":0,"score":"65968655198","product_id":100015201,"comment_content":"使用配置文件，如果版本不一致，可以用`kubeadm config print init-defaults`查看本机上装的kubeadm的默认支持的配置，比如kubeadm v.1.13，它的apiVersion是kubeadm.k8s.io&#47;v1beta1，kubernetesVersion: v1.13.0","like_count":15,"discussions":[{"author":{"id":1085046,"avatar":"https://static001.geekbang.org/account/avatar/00/10/8e/76/6d55e26f.jpg","nickname":"张晓辉","note":"","ucode":"1CD9717DE399C5","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":82306,"discussion_content":"谢谢，非常有用。搞定了 ","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1576332749,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1629821,"avatar":"https://static001.geekbang.org/account/avatar/00/18/de/7d/d10d97df.jpg","nickname":"青争","note":"","ucode":"1FD833A61FA041","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":17278,"discussion_content":"谢谢，这条帮了小白的大忙喽！","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1568965341,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":36379,"user_name":"Terry Hu","can_delete":false,"product_type":"c1","uid":1219820,"ip_address":"","ucode":"9487EEECC051B5","user_header":"https://static001.geekbang.org/account/avatar/00/12/9c/ec/5da5c049.jpg","comment_is_top":false,"comment_ctime":1541066200,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"61670608344","product_id":100015201,"comment_content":"我也为大家提供一些comments:<br>Kubeadm的token 23小时后过期，所以如果你worker端和master 端不是在同一天做的，有可能会出现如下错误:<br>[kubelet] Downloading configuration for the kubelet from the &quot;kubelet-config-1.11&quot; ConfigMap in the kube-system namespace<br>Unauthorized<br><br>Stackoverflow上有这个解:<br>https:&#47;&#47;stackoverflow.com&#47;questions&#47;52823871&#47;unable-to-join-the-worker-node-to-k8-master-node<br><br>简单来说，在master 上重新kubeadm token create一下，替换原来的token 就好了<br><br>另外，如果出现<br>[preflight] Some fatal errors occurred:<br>        [ERROR FileAvailable--etc-kubernetes-pki-ca.crt]: &#47;etc&#47;kubernetes&#47;pki&#47;ca.crt already exists<br>        [ERROR FileAvailable--etc-kubernetes-bootstrap-kubelet.conf]: &#47;etc&#47;kubernetes&#47;bootstrap-kubelet.conf already exists<br>[preflight] If you know what you are doing, you can make a check non-fatal with `--ignore-preflight-errors=...`<br><br>把那2个文件mv挪走就好了","like_count":14},{"had_liked":false,"id":25870,"user_name":"Jeremy","can_delete":false,"product_type":"c1","uid":1022520,"ip_address":"","ucode":"50316BC226A67A","user_header":"https://static001.geekbang.org/account/avatar/00/0f/9a/38/19e5547c.jpg","comment_is_top":false,"comment_ctime":1537457223,"is_pvip":false,"discussion_count":1,"race_medal":0,"score":"61666999367","product_id":100015201,"comment_content":"如果有人遇到：<br>[ERROR KubeletVersion]: the kubelet version is higher than the control plane version. This is not a supported version skew and may lead to a malfunctional cluster. Kubelet version: &quot;1.12.0-rc.1&quot; Control plane version: &quot;1.11.3&quot;<br>这个错误，使用：<br>apt-get install kubelet=1.11.3-00<br>就可以了，发出来希望对人有用。","like_count":14,"discussions":[{"author":{"id":2053397,"avatar":"https://static001.geekbang.org/account/avatar/00/1f/55/15/54073172.jpg","nickname":"18/18/178","note":"","ucode":"4A7E8BB0D0C249","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":365910,"discussion_content":"卸载原有的kubelet，再分开install好kubeadm跟kubelet就好，这样只要两次版本一样就没问题","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1617898527,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":223990,"user_name":"Geek_49d8fa","can_delete":false,"product_type":"c1","uid":1331349,"ip_address":"","ucode":"6DC0CA7865ACC6","user_header":"http://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTJLFL6wbwD8vcib0MGwLOrqkWBia3uuianHeTkQfiaO1ic1zWD9ib0I4JiagJAFA05OEyhwIHPgibpK6vD6aw/132","comment_is_top":false,"comment_ctime":1591251667,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"53130859219","product_id":100015201,"comment_content":"整理了下步骤：<br>环境ubuntu16.04<br>--------------关闭swap----<br>vim &#47;etc&#47;fstab<br>注销swap 一行<br>保存，并重启主机<br>--------------关闭swap----<br><br>--------修改Hostnmae--------<br>vim &#47;etc&#47;hostname<br>按照dns命名规则，修改主机名，参考RFC1123<br>--------修改Hostnmae--------<br><br>----------安装指定版本的docker----------<br>sudo apt-get remove docker docker-engine docker-ce docker.io<br>sudo apt-get update<br>sudo apt-get install apt-transport-https ca-certificates curl software-properties-common<br>curl -fsSL https:&#47;&#47;download.docker.com&#47;linux&#47;ubuntu&#47;gpg | sudo apt-key add -<br>sudo add-apt-repository &quot;deb [arch=amd64] https:&#47;&#47;download.docker.com&#47;linux&#47;ubuntu xenial stable&quot;<br><br>查看可用的docker版本：<br>apt-cache madison docker-ce<br>sudo apt-get install docker-ce=17.03.0~ce-0~ubuntu-xenial<br>----------安装指定版本的docker----------<br><br>----------安装kubeadm-------------<br>apt remove kubelet kubectl kubeadm<br>wget https:&#47;&#47;mirrors.aliyun.com&#47;kubernetes&#47;apt&#47;pool&#47;kubernetes-cni_0.6.0-00_amd64_43460dd3c97073851f84b32f5e8eebdc84fadedb5d5a00d1fc6872f30a4dd42c.deb<br>sudo dpkg -i kubernetes-cni_0.6.0-00_amd64_43460dd3c97073851f84b32f5e8eebdc84fadedb5d5a00d1fc6872f30a4dd42c.deb<br>apt install kubelet=1.11.3-00<br>apt install kubectl=1.11.3-00<br>apt install kubeadm=1.11.3-00<br>----------安装kubeadm-------------","like_count":12},{"had_liked":false,"id":174461,"user_name":"Evan张志辉","can_delete":false,"product_type":"c1","uid":1814764,"ip_address":"","ucode":"F7A99572F50716","user_header":"https://static001.geekbang.org/account/avatar/00/1b/b0/ec/070392e5.jpg","comment_is_top":false,"comment_ctime":1580217711,"is_pvip":false,"discussion_count":1,"race_medal":0,"score":"48824857967","product_id":100015201,"comment_content":"张老师，您好！<br>在学习安装kubernetes时，经常遇到k8s版本升级太快，导致后续来学您的课程，有些命令或配置文件已经淘汰，导致安装很不顺利。<br>例如：<br>kubectl apply -f https:&#47;&#47;git.io&#47;weave-kube-1.6<br><br>$ kubectl apply -f https:&#47;&#47;raw.githubusercontent.com&#47;kubernetes&#47;dashboard&#47;master&#47;src&#47;deploy&#47;recommended&#47;kubernetes-dashboard.yaml<br>$ kubeadm init --config=kubeadm.yaml<br>等等。<br>有什么好的办法能够快速的跟进版本的变化，并做相应的调整。<br>","like_count":11,"discussions":[{"author":{"id":1104850,"avatar":"https://static001.geekbang.org/account/avatar/00/10/db/d2/e29f8834.jpg","nickname":"lidashuang","note":"","ucode":"560ABE8032760E","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":295725,"discussion_content":"看最新的文档","likes_number":2,"is_delete":false,"is_hidden":false,"ctime":1596299809,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":27893,"user_name":"陈华","can_delete":false,"product_type":"c1","uid":1082730,"ip_address":"","ucode":"3AF9E8EB39E507","user_header":"http://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTKtS26SJpSF7JLu9pusGsy1Qln0NdQg1eV2YKOJxpX2QXaBuuyXMqZY3fm0rhzKwsqN5aa6CVNOQQ/132","comment_is_top":false,"comment_ctime":1537962560,"is_pvip":false,"discussion_count":4,"race_medal":0,"score":"48782602816","product_id":100015201,"comment_content":"我去，今天才部署完成，对于小白来说还是挺困难的。<br>这一节应该卡住了很多人吧。<br>加油！！！，","like_count":11,"discussions":[{"author":{"id":1251835,"avatar":"http://thirdwx.qlogo.cn/mmopen/vi_32/oiboHpgukqib2ASXeU0H7W1ibgRMqyrNE5KaWicicPEDy0ia8YdoneZAtvW0EFIiaqZJp2OS4dnweOgXaJ5EjJicicEqic5A/132","nickname":"覃钰栋","note":"","ucode":"19080C463658EF","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":414706,"discussion_content":"苦呀兄弟，花了两周","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1636865773,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1121758,"avatar":"https://static001.geekbang.org/account/avatar/00/11/1d/de/62bfa83f.jpg","nickname":"aoe","note":"","ucode":"1C6201EDB4E954","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":307621,"discussion_content":"版本更新了，现在还没完全部署好","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1600699471,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":2,"child_discussions":[{"author":{"id":1251835,"avatar":"http://thirdwx.qlogo.cn/mmopen/vi_32/oiboHpgukqib2ASXeU0H7W1ibgRMqyrNE5KaWicicPEDy0ia8YdoneZAtvW0EFIiaqZJp2OS4dnweOgXaJ5EjJicicEqic5A/132","nickname":"覃钰栋","note":"","ucode":"19080C463658EF","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":1121758,"avatar":"https://static001.geekbang.org/account/avatar/00/11/1d/de/62bfa83f.jpg","nickname":"aoe","note":"","ucode":"1C6201EDB4E954","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":414707,"discussion_content":"报什么错\n","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1636865787,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":307621,"ip_address":""},"score":414707,"extra":""},{"author":{"id":1121758,"avatar":"https://static001.geekbang.org/account/avatar/00/11/1d/de/62bfa83f.jpg","nickname":"aoe","note":"","ucode":"1C6201EDB4E954","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":1251835,"avatar":"http://thirdwx.qlogo.cn/mmopen/vi_32/oiboHpgukqib2ASXeU0H7W1ibgRMqyrNE5KaWicicPEDy0ia8YdoneZAtvW0EFIiaqZJp2OS4dnweOgXaJ5EjJicicEqic5A/132","nickname":"覃钰栋","note":"","ucode":"19080C463658EF","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":414903,"discussion_content":"已经不记得了","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1636934750,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":414707,"ip_address":""},"score":414903,"extra":""}]}]},{"had_liked":false,"id":25114,"user_name":"包治结巴","can_delete":false,"product_type":"c1","uid":1219786,"ip_address":"","ucode":"50978D98813D16","user_header":"","comment_is_top":false,"comment_ctime":1537247831,"is_pvip":false,"replies":[{"id":"9174","content":"可以用kubeadm查看token","user_name":"作者回复","user_name_real":"Geek_6ef93d","uid":"1218095","ctime":1537268122,"ip_address":"","comment_id":25114,"utype":1}],"discussion_count":1,"race_medal":0,"score":"44486920791","product_id":100015201,"comment_content":"张老师，请教一个问题，master部署完成后生成指令，比如“ kubeadm join 172.19.0.7:6443 --token xw4d6t.1dmpctojkcg9yqlf --discovery-token-ca-cert-hash sha256:45168e55ad19ac6126728e86c0a4c46e98c7df5d0312aec3fdd8d437dc24a3b9”，假如当时没有记下来，有什么命令可以再次让master生成这个指令吗？","like_count":10,"discussions":[{"author":{"id":1218095,"avatar":"https://static001.geekbang.org/account/avatar/00/12/96/2f/876085fa.jpg","nickname":"张磊 Kubernetes","note":"","ucode":"16E29BDAB1F5BC","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":424194,"discussion_content":"可以用kubeadm查看token","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1537268122,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":83491,"user_name":"仓颉jk","can_delete":false,"product_type":"c1","uid":1015387,"ip_address":"","ucode":"D1C3620779B4C0","user_header":"https://static001.geekbang.org/account/avatar/00/0f/7e/5b/35005438.jpg","comment_is_top":false,"comment_ctime":1554623987,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"40209329651","product_id":100015201,"comment_content":"这一节...举步维艰","like_count":9},{"had_liked":false,"id":25873,"user_name":"同心结","can_delete":false,"product_type":"c1","uid":1248791,"ip_address":"","ucode":"84E7796FE1A602","user_header":"https://static001.geekbang.org/account/avatar/00/13/0e/17/0aa98ae7.jpg","comment_is_top":false,"comment_ctime":1537458889,"is_pvip":false,"discussion_count":2,"race_medal":0,"score":"40192164553","product_id":100015201,"comment_content":"你好，照着你的教程，我在执行kubeadm init --config kubeadm.yaml， 提示：your configuration file uses an old API spec: &quot;kubeadm.k8s.io&#47;v1alpha1&quot;. Please use kubeadm v1.11 instead and run &#39;kubeadm config migrate --old-config old.yaml --new-config new.yaml&#39;, which will write the new, similar spec using a newer API version.<br>默认安装的kubeadm和kubelet版本是1.12<br>","like_count":9,"discussions":[{"author":{"id":1068451,"avatar":"https://static001.geekbang.org/account/avatar/00/10/4d/a3/3b922cdf.jpg","nickname":"Boyka Ou","note":"","ucode":"87264DD6983580","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":379780,"discussion_content":"apps/v1","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1624154476,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1619925,"avatar":"https://static001.geekbang.org/account/avatar/00/18/b7/d5/9cd57434.jpg","nickname":"HOHO","note":"","ucode":"C34029DDAD6194","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":6577,"discussion_content":"请问最后怎么解决的","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1566982361,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":25673,"user_name":"Jeff.W","can_delete":false,"product_type":"c1","uid":1140420,"ip_address":"","ucode":"2043F83FB7B39C","user_header":"https://static001.geekbang.org/account/avatar/00/11/66/c4/038f9325.jpg","comment_is_top":false,"comment_ctime":1537408198,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"40192113862","product_id":100015201,"comment_content":"这一节的开始配图很好，预示着需要跨越障碍，除了公司代理还有Great Wall，阻碍了我前进的步伐。。。","like_count":9},{"had_liked":false,"id":25543,"user_name":"Len","can_delete":false,"product_type":"c1","uid":1022767,"ip_address":"","ucode":"53C623CE17973F","user_header":"https://static001.geekbang.org/account/avatar/00/0f/9b/2f/b7a3625e.jpg","comment_is_top":false,"comment_ctime":1537360263,"is_pvip":true,"discussion_count":0,"race_medal":0,"score":"40192065927","product_id":100015201,"comment_content":"老师，怎么让 Master 高可用，能给几个方案的关键词吗？我想根据关键词课后自己先研究一下。","like_count":9},{"had_liked":false,"id":24550,"user_name":"心情不错","can_delete":false,"product_type":"c1","uid":1218172,"ip_address":"","ucode":"A62967BE93885C","user_header":"https://static001.geekbang.org/account/avatar/00/12/96/7c/b1e6ea51.jpg","comment_is_top":false,"comment_ctime":1537141794,"is_pvip":false,"replies":[{"id":"8996","content":"开发负责docker和一部分yaml文件，下一篇会讲一个流程","user_name":"作者回复","user_name_real":"Geek_6ef93d","uid":"1218095","ctime":1537152625,"ip_address":"","comment_id":24550,"utype":1}],"discussion_count":1,"race_medal":0,"score":"40191847458","product_id":100015201,"comment_content":"以后是不是开发负责部署单个docker， 运维负责宏观kubernetes?","like_count":9,"discussions":[{"author":{"id":1218095,"avatar":"https://static001.geekbang.org/account/avatar/00/12/96/2f/876085fa.jpg","nickname":"张磊 Kubernetes","note":"","ucode":"16E29BDAB1F5BC","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":424031,"discussion_content":"开发负责docker和一部分yaml文件，下一篇会讲一个流程","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1537152625,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":78126,"user_name":"飞向云端","can_delete":false,"product_type":"c1","uid":1419516,"ip_address":"","ucode":"54B3D9B1B0368B","user_header":"https://static001.geekbang.org/account/avatar/00/15/a8/fc/6c00e036.jpg","comment_is_top":false,"comment_ctime":1553075017,"is_pvip":false,"discussion_count":2,"race_medal":0,"score":"35912813385","product_id":100015201,"comment_content":"$ kubectl apply -f https:&#47;&#47;raw.githubusercontent.com&#47;kubernetes&#47;dashboard&#47;master&#47;src&#47;deploy&#47;recommended&#47;kubernetes-dashboard.yaml<br>路径404找不到了，怎么解？","like_count":8,"discussions":[{"author":{"id":1264316,"avatar":"https://static001.geekbang.org/account/avatar/00/13/4a/bc/a12efcd8.jpg","nickname":"koko","note":"","ucode":"996C982A8336D4","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":99940,"discussion_content":"试试\nkubectl apply -f https://raw.githubusercontent.com/kubernetes/dashboard/v2.0.0-beta8/aio/deploy/recommended.yaml","likes_number":1,"is_delete":false,"is_hidden":false,"ctime":1577228850,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1311629,"avatar":"https://static001.geekbang.org/account/avatar/00/14/03/8d/38a98dc6.jpg","nickname":"牧野静风","note":"","ucode":"FB5963F97C23AA","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":46465,"discussion_content":"被墙了，访问不到资源","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1573173650,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":76187,"user_name":"kevinsu","can_delete":false,"product_type":"c1","uid":1078506,"ip_address":"","ucode":"BAD46B815D6A5C","user_header":"https://static001.geekbang.org/account/avatar/00/10/74/ea/10661bdc.jpg","comment_is_top":false,"comment_ctime":1552546672,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"35912285040","product_id":100015201,"comment_content":"写了一篇kubeadm墙内快速搭建集群的文章，欢迎大家查看https:&#47;&#47;www.jianshu.com&#47;p&#47;b77635125524","like_count":8},{"had_liked":false,"id":58862,"user_name":"Jax","can_delete":false,"product_type":"c1","uid":1220215,"ip_address":"","ucode":"F32F8E996BD662","user_header":"https://static001.geekbang.org/account/avatar/00/12/9e/77/f9f1b47d.jpg","comment_is_top":false,"comment_ctime":1547216250,"is_pvip":true,"discussion_count":2,"race_medal":0,"score":"35906954618","product_id":100015201,"comment_content":"1.13版本的kubeadm.yaml应该这么写，大家可以尝试下，我也是卡在这里稍微折腾了一下~<br>apiVersion: kubeadm.k8s.io&#47;v1beta1<br>kind: InitConfiguration<br>controllerManager:<br>  horizontal-pod-autoscaler-use-rest-clients: &quot;true&quot;<br>  horizontal-pod-autoscaler-sync-period: &quot;10s&quot;<br>  node-monitor-grace-period: &quot;10s&quot;<br>apiServer:<br>  runtime-config: &quot;api&#47;all=true&quot;<br>kubernetesVersion: &quot;v1.13.0&quot;","like_count":8,"discussions":[{"author":{"id":2053397,"avatar":"https://static001.geekbang.org/account/avatar/00/1f/55/15/54073172.jpg","nickname":"18/18/178","note":"","ucode":"4A7E8BB0D0C249","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":365912,"discussion_content":"插眼，同1.13","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1617898615,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1085046,"avatar":"https://static001.geekbang.org/account/avatar/00/10/8e/76/6d55e26f.jpg","nickname":"张晓辉","note":"","ucode":"1CD9717DE399C5","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":81914,"discussion_content":"可以Work，谢谢 ","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1576294516,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":40072,"user_name":"司马忑","can_delete":false,"product_type":"c1","uid":1063658,"ip_address":"","ucode":"3A48085AA604EC","user_header":"https://static001.geekbang.org/account/avatar/00/10/3a/ea/ff744c48.jpg","comment_is_top":false,"comment_ctime":1542463807,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"35902202175","product_id":100015201,"comment_content":"有人提到科学上网以及centos系列安装的问题，在这里分享一下一下解决方案：<br>第一是相关工具通过阿里云安装，地址 http:&#47;&#47;opsx.alibaba.com&#47;mirror ，这是阿里的开源镜像站，有各种镜像，找到k8s这一行，点行尾的帮助，写有apt&#47;yum两个版本的命令；<br>第二是gcr.io的镜像问题，有人在github同步了一份，请看 http:&#47;&#47;github.com&#47;anjia0532&#47;gcr.io_mirror","like_count":8},{"had_liked":false,"id":24580,"user_name":"暮雨","can_delete":false,"product_type":"c1","uid":1176426,"ip_address":"","ucode":"4B7F4932446EF7","user_header":"https://static001.geekbang.org/account/avatar/00/11/f3/6a/6d82e7a3.jpg","comment_is_top":false,"comment_ctime":1537152826,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"35896891194","product_id":100015201,"comment_content":"没有外网的环境，安装这个有没什么好的方法，在阿里云上开了两台香港节点的主机","like_count":8},{"had_liked":false,"id":151436,"user_name":"Quo fata ferunt","can_delete":false,"product_type":"c1","uid":1232575,"ip_address":"","ucode":"79ED660DD54B9D","user_header":"https://static001.geekbang.org/account/avatar/00/12/ce/bf/0756c980.jpg","comment_is_top":false,"comment_ctime":1573719061,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"31638490133","product_id":100015201,"comment_content":"kubenetes v1.16配置文件<br>apiVersion: kubeadm.k8s.io&#47;v1beta2<br>kind: ClusterConfiguration<br>controllerManager:<br>        ExtraArgs:<br>                 horizontal-pod-autoscaler-use-rest-clients: &quot;true&quot;<br>                 horizontal-pod-autoscaler-sync-period: &quot;10s&quot;<br>                 node-monitor-grace-period: &quot;10s&quot;<br>apiServer: <br>        ExtraArgs: <br>                runtime-config: &quot;api&#47;all=true&quot;<br>kubernetesVersion: &quot;stable-1.16&quot;<br><br>","like_count":7},{"had_liked":false,"id":36952,"user_name":"Terry Hu","can_delete":false,"product_type":"c1","uid":1219820,"ip_address":"","ucode":"9487EEECC051B5","user_header":"https://static001.geekbang.org/account/avatar/00/12/9c/ec/5da5c049.jpg","comment_is_top":false,"comment_ctime":1541402932,"is_pvip":false,"discussion_count":1,"race_medal":0,"score":"31606174004","product_id":100015201,"comment_content":"其实关于<br>root@kube-worker1:~# kubectl get pods<br>The connection to the server localhost:8080 was refused - did you specify the right host or port?<br>还有一个问题，我这是在worker节点上无法get pods，当然我知道是由于.kube&#47;config文件在worker 节点上不存在，查看journalctl -l -u kubelet也能得到相同的信息，于是我把kube-master上的文件scp到worker上，就成功了，但我的问题是:这样做合适么？为什么kubeadm join的时候不在worker节点上生成安全配置文件？我这样做实际上和在master上权限相同，有潜在安全隐患，如何配置专属每个node自身的安全配置文件？比如我在worker1上只能get到它自己的pod，看不到其他的pod","like_count":7,"discussions":[{"author":{"id":1347181,"avatar":"https://static001.geekbang.org/account/avatar/00/14/8e/6d/c68e07ef.jpg","nickname":"Chino","note":"","ucode":"0240D89E5F74B4","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":543594,"discussion_content":"我也碰到这个问题了，还以为join的时候会自动从master获取配置。 结果从节点的去/etc/kubernetes看了下并没有admin.conf, 自己从master拷了过去","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1641218195,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":27980,"user_name":"选择","can_delete":false,"product_type":"c1","uid":1179623,"ip_address":"","ucode":"C9CB138CF05459","user_header":"https://static001.geekbang.org/account/avatar/00/11/ff/e7/7eda8d7e.jpg","comment_is_top":false,"comment_ctime":1537972810,"is_pvip":false,"replies":[{"id":"10124","content":"解决方法你自己都贴出来了……","user_name":"作者回复","user_name_real":"Geek_6ef93d","uid":"1218095","ctime":1538018356,"ip_address":"","comment_id":27980,"utype":1}],"discussion_count":1,"race_medal":0,"score":"31602743882","product_id":100015201,"comment_content":"你好，照着你的教程，我在执行kubeadm init --config kubeadm.yaml， 提示：your configuration file uses an old API spec: &quot;kubeadm.k8s.io&#47;v1alpha1&quot;. Please use kubeadm v1.11 instead and run &#39;kubeadm config migrate --old-config old.yaml --new-config new.yaml&#39;, which will write the new, similar spec using a newer API version.用全新的虚拟机安装的 该怎么解决呢？ 谢谢了","like_count":7,"discussions":[{"author":{"id":1218095,"avatar":"https://static001.geekbang.org/account/avatar/00/12/96/2f/876085fa.jpg","nickname":"张磊 Kubernetes","note":"","ucode":"16E29BDAB1F5BC","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":425105,"discussion_content":"解决方法你自己都贴出来了……","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1538018356,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":27287,"user_name":"John","can_delete":false,"product_type":"c1","uid":1104765,"ip_address":"","ucode":"4CBECD3CA7FCFC","user_header":"https://static001.geekbang.org/account/avatar/00/10/db/7d/1fbad49b.jpg","comment_is_top":false,"comment_ctime":1537866307,"is_pvip":true,"replies":[{"id":"9873","content":"journalctl -l -u kubelet ","user_name":"作者回复","user_name_real":"Geek_6ef93d","uid":"1218095","ctime":1537887690,"ip_address":"","comment_id":27287,"utype":1}],"discussion_count":2,"race_medal":0,"score":"31602637379","product_id":100015201,"comment_content":"非常强的挫败感。第一，打败墙，花了几天。然后，应用了网络插件，但是仍然是 not ready，提示还是 network plugin  is not ready cni config uninitiated。请问怎么看日志呢？","like_count":7,"discussions":[{"author":{"id":1218095,"avatar":"https://static001.geekbang.org/account/avatar/00/12/96/2f/876085fa.jpg","nickname":"张磊 Kubernetes","note":"","ucode":"16E29BDAB1F5BC","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":424864,"discussion_content":"journalctl -l -u kubelet ","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1537887690,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":2394694,"avatar":"https://static001.geekbang.org/account/avatar/00/24/8a/46/a75684ea.jpg","nickname":"弗拉基米尔·伊里奇·乌里扬诺夫","note":"","ucode":"9C6725A91BC06C","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":349467,"discussion_content":"journalctl -xefu kubelet :-)","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1613224773,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":270230,"user_name":"爱学习的猿","can_delete":false,"product_type":"c1","uid":1224602,"ip_address":"","ucode":"0F0082B7267914","user_header":"https://static001.geekbang.org/account/avatar/00/12/af/9a/e081ee66.jpg","comment_is_top":false,"comment_ctime":1608996664,"is_pvip":false,"discussion_count":5,"race_medal":0,"score":"27378800440","product_id":100015201,"comment_content":"5.部署容器存储插件(Rook)<br>$ kubectl apply -f https:&#47;&#47;raw.githubusercontent.com&#47;rook&#47;rook&#47;master&#47;cluster&#47;examples&#47;kubernetes&#47;ceph&#47;common.yaml<br>$ kubectl apply -f https:&#47;&#47;raw.githubusercontent.com&#47;rook&#47;rook&#47;master&#47;cluster&#47;examples&#47;kubernetes&#47;ceph&#47;operator.yaml<br>$ kubectl apply -f https:&#47;&#47;raw.githubusercontent.com&#47;rook&#47;rook&#47;master&#47;cluster&#47;examples&#47;kubernetes&#47;ceph&#47;crds.yaml<br>$ kubectl apply -f https:&#47;&#47;raw.githubusercontent.com&#47;rook&#47;rook&#47;master&#47;cluster&#47;examples&#47;kubernetes&#47;ceph&#47;cluster.yaml","like_count":6,"discussions":[{"author":{"id":2864768,"avatar":"https://static001.geekbang.org/account/avatar/00/2b/b6/80/2327060c.jpg","nickname":"糖炒栗子","note":"","ucode":"6A59DDE825E266","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":537647,"discussion_content":"这几个yaml文件更新了吗？现在用命令下报404","likes_number":2,"is_delete":false,"is_hidden":false,"ctime":1639128763,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":1,"child_discussions":[{"author":{"id":2730544,"avatar":"https://thirdwx.qlogo.cn/mmopen/vi_32/DYAIOgq83er3buhru0LAs0WQZh9vdDk8P6duwdEIxvTwLTviasadOcP5nlKOjKlKJicNV2QHa9qSIxwUQoYhhYBg/132","nickname":"Geek_74baaf","note":"","ucode":"C881699AAF8D0E","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":2864768,"avatar":"https://static001.geekbang.org/account/avatar/00/2b/b6/80/2327060c.jpg","nickname":"糖炒栗子","note":"","ucode":"6A59DDE825E266","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":553781,"discussion_content":"找到解决的方法了吗，我也是","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1646081422,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":537647,"ip_address":""},"score":553781,"extra":""}]},{"author":{"id":2155490,"avatar":"https://static001.geekbang.org/account/avatar/00/20/e3/e2/476563d5.jpg","nickname":"飘叶","note":"","ucode":"8BA994FE15EBBD","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":343853,"discussion_content":"请问这个是最新的部署方式吗","likes_number":1,"is_delete":false,"is_hidden":false,"ctime":1611196779,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":1,"child_discussions":[{"author":{"id":1311001,"avatar":"https://static001.geekbang.org/account/avatar/00/14/01/19/f4da2829.jpg","nickname":"一秒","note":"","ucode":"F149B7F60620BD","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":2155490,"avatar":"https://static001.geekbang.org/account/avatar/00/20/e3/e2/476563d5.jpg","nickname":"飘叶","note":"","ucode":"8BA994FE15EBBD","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":347204,"discussion_content":"我成功了，不执行crds.yaml,会报错“unable to recognize &#34;cluster.yaml&#34;: no matches for kind &#34;CephCluster&#34; in version &#34;ceph.rook.io/v1&#34;”","likes_number":2,"is_delete":false,"is_hidden":false,"ctime":1612172454,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":343853,"ip_address":""},"score":347204,"extra":""}]},{"author":{"id":1354151,"avatar":"https://static001.geekbang.org/account/avatar/00/14/a9/a7/de3ee890.jpg","nickname":"拉我吃","note":"","ucode":"8BC9C44FE00097","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":376899,"discussion_content":"救星\n","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1622407061,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":250910,"user_name":"InfoQ_9c8a605d5c96","can_delete":false,"product_type":"c1","uid":1800951,"ip_address":"","ucode":"9AB97E4E4FE4E9","user_header":"http://thirdwx.qlogo.cn/mmopen/vi_32/A2ZckFLHLGee4FhmhFYIWkoXMMV5UTj3Mdj3Ps7FJM1YvaIicVnKibqIHchbYllPOicwDs0frHxHVEiaYuV2K5vVqw/132","comment_is_top":false,"comment_ctime":1601278992,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"27371082768","product_id":100015201,"comment_content":"给使用vagrant部署k8s的同学一些提示，vagrant会自己创建一个网卡10.0.2.15，如果你发现你的api一直在连接这个网卡那么肯定是连不上，请在vagrantfile里面添加一个private_network比如IP是&quot;192.168.33.10&quot;，然后编辑kubeadm的配置文件的时候给api设置这个私有ip，如下：<br><br>apiVersion: kubeadm.k8s.io&#47;v1beta2<br>kind: ClusterConfiguration<br>controllerManager:<br>  extraArgs:<br>    horizontal-pod-autoscaler-use-rest-clients: &quot;true&quot;<br>    horizontal-pod-autoscaler-sync-period: &quot;10s&quot;<br>    node-monitor-grace-period: &quot;10s&quot;<br>apiServer:<br>  extraArgs:<br>    runtime-config: &quot;api&#47;all=true&quot;<br>  advertiseAddress: 192.168.33.10<br>  bindPort: 6443<br>imageRepository: registry.cn-hangzhou.aliyuncs.com&#47;google_containers<br>kubernetesVersion: &quot;v1.19.2&quot;<br><br>这样就能正常启动vagrant配置的kubeadm了，但是最好还是在裸机上配置，这个问题耗了我一天的时间，如果有裸机早就搞好了。","like_count":6},{"had_liked":false,"id":80765,"user_name":"橙汁","can_delete":false,"product_type":"c1","uid":1332257,"ip_address":"","ucode":"EC3FF10D708C9D","user_header":"https://static001.geekbang.org/account/avatar/00/14/54/21/0bac2254.jpg","comment_is_top":false,"comment_ctime":1553732414,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"27323536190","product_id":100015201,"comment_content":"各位搭建出现问题可以参照我前几天搭建写的文章，使用的centos7镜像问题也完美解决  http:&#47;&#47;www.iexhaustion.com&#47;2019&#47;03&#47;13&#47;kubeadm&#47;","like_count":6},{"had_liked":false,"id":72546,"user_name":"Ignacio","can_delete":false,"product_type":"c1","uid":1130334,"ip_address":"","ucode":"AEAA24A58B6D29","user_header":"https://static001.geekbang.org/account/avatar/00/11/3f/5e/2fa1377d.jpg","comment_is_top":false,"comment_ctime":1551666877,"is_pvip":false,"discussion_count":2,"race_medal":0,"score":"27321470653","product_id":100015201,"comment_content":"『centos7 单机k8s终于在墙内搭好了，写了篇教程欢迎后来者直接享用<br>https:&#47;&#47;www.datayang.com&#47;article&#47;45』<br>想哭，搞了块一天，都是版本问题，按照楼主这个可以。需要注意的是：kubernetes-dashboard.yaml不要选择默认的，我用的是https:&#47;&#47;raw.githubusercontent.com&#47;kubernetes&#47;dashboard&#47;v1.8.3&#47;src&#47;deploy&#47;recommended&#47;kubernetes-dashboard.yaml","like_count":6,"discussions":[{"author":{"id":1336169,"avatar":"http://thirdwx.qlogo.cn/mmopen/vi_32/dLSTGibVPxf3hZv0jDFGv83jK95VlagHZoia9DBcpkl0SEoFD19TjdGw7VDvP5qhK9ZNJ9cfpgT7PRtFtKBPaq3g/132","nickname":"麦颗斯","note":"","ucode":"21D545C9DCC7EF","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":338336,"discussion_content":"已经解决了么?","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1609241883,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1107066,"avatar":"http://thirdwx.qlogo.cn/mmopen/vi_32/DYAIOgq83epRVT3U6UOpRAoOOYMm0flMeX4P1VJpSnZBlaBvdW4KhWKr0BunLFlCxibdHc9s6VArA124FpwzRiaw/132","nickname":"guoqp","note":"","ucode":"B12A5757215D0E","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":233607,"discussion_content":"kubernetes-dashboard.yaml文件访问不到，能否提供一个","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1586934390,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":58044,"user_name":"孙仲谋","can_delete":false,"product_type":"c1","uid":1173166,"ip_address":"","ucode":"F0268004B25A3C","user_header":"https://static001.geekbang.org/account/avatar/00/11/e6/ae/83bc09b1.jpg","comment_is_top":false,"comment_ctime":1546966757,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"27316770533","product_id":100015201,"comment_content":"kubelet 更新到v1.13 即 v1&#47;1alpha3后需要修改kind 值为 InitConfiguration","like_count":6},{"had_liked":false,"id":26346,"user_name":"hpfish","can_delete":false,"product_type":"c1","uid":1217377,"ip_address":"","ucode":"86DB066E5B6D89","user_header":"https://static001.geekbang.org/account/avatar/00/12/93/61/3e4607c7.jpg","comment_is_top":false,"comment_ctime":1537568227,"is_pvip":false,"replies":[{"id":"9594","content":"kubeadm存在的意义就是要让你第一次部署就这么顺，要不然这个项目就太失败了。至于GFW的问题，肯定要自己想办法解决。","user_name":"作者回复","user_name_real":"Geek_6ef93d","uid":"1218095","ctime":1537604681,"ip_address":"","comment_id":26346,"utype":1}],"discussion_count":1,"race_medal":0,"score":"27307372003","product_id":100015201,"comment_content":"为什么不解释一些常见的问题呢？第一次部哪有那么顺啊","like_count":6,"discussions":[{"author":{"id":1218095,"avatar":"https://static001.geekbang.org/account/avatar/00/12/96/2f/876085fa.jpg","nickname":"张磊 Kubernetes","note":"","ucode":"16E29BDAB1F5BC","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":424601,"discussion_content":"kubeadm存在的意义就是要让你第一次部署就这么顺，要不然这个项目就太失败了。至于GFW的问题，肯定要自己想办法解决。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1537604681,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":25753,"user_name":"Jeff.W","can_delete":false,"product_type":"c1","uid":1140420,"ip_address":"","ucode":"2043F83FB7B39C","user_header":"https://static001.geekbang.org/account/avatar/00/11/66/c4/038f9325.jpg","comment_is_top":false,"comment_ctime":1537435399,"is_pvip":false,"replies":[{"id":"9403","content":"Ansible等工具适合部署大规模集群，做实验环境得不偿失，不建议分散精力。","user_name":"作者回复","user_name_real":"Geek_6ef93d","uid":"1218095","ctime":1537458977,"ip_address":"","comment_id":25753,"utype":1}],"discussion_count":1,"race_medal":0,"score":"27307239175","product_id":100015201,"comment_content":"网络受限的话觉得可以参考一下这个，使用Ansible脚本安装K8S集群，介绍组件交互原理，方便直接，不受国内网络环境影响 https:&#47;&#47;github.com&#47;gjmzj&#47;kubeasz。机器资源有限就弄个AllInOne？或者单主多从？老师怎么看？","like_count":6,"discussions":[{"author":{"id":1218095,"avatar":"https://static001.geekbang.org/account/avatar/00/12/96/2f/876085fa.jpg","nickname":"张磊 Kubernetes","note":"","ucode":"16E29BDAB1F5BC","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":424410,"discussion_content":"Ansible等工具适合部署大规模集群，做实验环境得不偿失，不建议分散精力。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1537458977,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":24591,"user_name":"huan","can_delete":false,"product_type":"c1","uid":1012286,"ip_address":"","ucode":"46CB95F6E4E5FF","user_header":"https://static001.geekbang.org/account/avatar/00/0f/72/3e/534db55d.jpg","comment_is_top":false,"comment_ctime":1537157302,"is_pvip":false,"replies":[{"id":"9050","content":"rook.io真的是个好东西","user_name":"作者回复","user_name_real":"Geek_6ef93d","uid":"1218095","ctime":1537187572,"ip_address":"","comment_id":24591,"utype":1}],"discussion_count":1,"race_medal":0,"score":"27306961078","product_id":100015201,"comment_content":"分享一下这篇实践的小插曲，我是使用DigitalOcean的机器做的，没有墙的问题。<br>在使用weave-net的时候，怎么都通不过，报错是 weave-net的状态是 CrashLoopBackOff，看了container的log，也不懂啥意思，找了下k8s的troubleshoot页面的说明 （https:&#47;&#47;kubernetes.io&#47;docs&#47;setup&#47;independent&#47;troubleshooting-kubeadm&#47;#pods-in-runcontainererror-crashloopbackoff-or-error-state），说是版本问题，不知道怎么解决。<br>然后随便找了另一个实现 Romana，替换weavenet<br>`kubectl apply -f https:&#47;&#47;raw.githubusercontent.com&#47;romana&#47;romana&#47;master&#47;containerize&#47;specs&#47;romana-kubeadm.yml` 终于成功了，然后体验到了以前想都不敢想的Ceph，超赞","like_count":6,"discussions":[{"author":{"id":1218095,"avatar":"https://static001.geekbang.org/account/avatar/00/12/96/2f/876085fa.jpg","nickname":"张磊 Kubernetes","note":"","ucode":"16E29BDAB1F5BC","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":424048,"discussion_content":"rook.io真的是个好东西","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1537187572,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":207117,"user_name":"Cybertrunk","can_delete":false,"product_type":"c1","uid":1011174,"ip_address":"","ucode":"D557A710E1835F","user_header":"https://static001.geekbang.org/account/avatar/00/0f/6d/e6/57bfae83.jpg","comment_is_top":false,"comment_ctime":1587008526,"is_pvip":false,"discussion_count":2,"race_medal":0,"score":"23061845006","product_id":100015201,"comment_content":"update 4 Ceph deployment:<br>kubectl apply -f https:&#47;&#47;raw.githubusercontent.com&#47;rook&#47;rook&#47;release-1.3&#47;cluster&#47;examples&#47;kubernetes&#47;ceph&#47;common.yaml<br>kubectl apply -f https:&#47;&#47;raw.githubusercontent.com&#47;rook&#47;rook&#47;release-1.3&#47;cluster&#47;examples&#47;kubernetes&#47;ceph&#47;operator.yaml<br>kubectl apply -f https:&#47;&#47;raw.githubusercontent.com&#47;rook&#47;rook&#47;release-1.3&#47;cluster&#47;examples&#47;kubernetes&#47;ceph&#47;cluster.yaml","like_count":5,"discussions":[{"author":{"id":1320487,"avatar":"https://static001.geekbang.org/account/avatar/00/14/26/27/eba94899.jpg","nickname":"罗杰","note":"","ucode":"96BAFAA147341F","race_medal":2,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":362844,"discussion_content":"用这个部署感觉是正确的，但是和文章的输出不太相同，我在 Ubuntu20.4 上只要多了一个命名空间 rook-ceph，这个是正常吗？","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1617058046,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1284775,"avatar":"https://static001.geekbang.org/account/avatar/00/13/9a/a7/51cf1a9e.jpg","nickname":"💖李京潼💖","note":"","ucode":"8337BC784D9674","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":333324,"discussion_content":"正搞不定呢，看到了你的更新，太棒了","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1607501710,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":81203,"user_name":"一个有梦想的狗子","can_delete":false,"product_type":"c1","uid":1464325,"ip_address":"","ucode":"D69F3A1AAE30F4","user_header":"https://static001.geekbang.org/account/avatar/00/16/58/05/f818529a.jpg","comment_is_top":false,"comment_ctime":1553829229,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"23028665709","product_id":100015201,"comment_content":"老师  ，在搭建rook的时候 ， <br>kubectl apply -f https:&#47;&#47;raw.githubusercontent.com&#47;rook&#47;rook&#47;master&#47;cluster&#47;examples&#47;kubernetes&#47;ceph&#47;cluster.yaml<br>这个有时无时报<br>Error from server (NotFound): error when creating &quot;https:&#47;&#47;raw.githubusercontent.com&#47;rook&#47;rook&#47;master&#47;cluster&#47;examples&#47;kubernetes&#47;ceph&#47;cluster.yaml&quot;: the server could not find the requested resource (post cephclusters.ceph.rook.io)<br>我重新搭建了几次 有时成功了  有时就报这个错<br>","like_count":5},{"had_liked":false,"id":28632,"user_name":"Casper","can_delete":false,"product_type":"c1","uid":1022129,"ip_address":"","ucode":"69282EB175B48E","user_header":"https://static001.geekbang.org/account/avatar/00/0f/98/b1/f89a84d0.jpg","comment_is_top":false,"comment_ctime":1538117060,"is_pvip":true,"replies":[{"id":"10336","content":"呃，提示都说了让你装kubeadm 1.11然后执行格式转换呢……为啥不操作呢","user_name":"作者回复","user_name_real":"Geek_6ef93d","uid":"1218095","ctime":1538129717,"ip_address":"","comment_id":28632,"utype":1}],"discussion_count":1,"race_medal":5,"score":"23012953540","product_id":100015201,"comment_content":"在执行kubeadm init config kubeadm.yaml时报如下错误：<br>your configuration file uses an old API spec: &quot;kubeadm.k8s.io&#47;v1alpha1&quot;. Please use kubeadm v1.11 instead and run &#39;kubeadm config migrate --old-config old.yaml --new-config new.yaml&#39;, which will write the new, similar spec using a newer API version.<br><br>kubedadm的版本信息是:<br>kubeadm version: &amp;version.Info{Major:&quot;1&quot;, Minor:&quot;12&quot;, GitVersion:&quot;v1.12.0&quot;, GitCommit:&quot;0ed33881dc4355495f623c6f22e7dd0b7632b7c0&quot;, GitTreeState:&quot;clean&quot;, BuildDate:&quot;2018-09-27T17:02:38Z&quot;, GoVersion:&quot;go1.10.4&quot;, Compiler:&quot;gc&quot;, Platform:&quot;linux&#47;amd64&quot;}<br>系统环境是：ubuntu server 16.04<br><br>在google也搜索了，没有找到解决方法。麻烦老师解答一下解决方法。<br>今后在遇到类似的问题时，应该如何解决呢，希望张老师能提供一个解决问题的思路。或者是如何才能查看不同版本的kubernetes的参数的差异变化。<br>谢谢张老师~","like_count":5,"discussions":[{"author":{"id":1218095,"avatar":"https://static001.geekbang.org/account/avatar/00/12/96/2f/876085fa.jpg","nickname":"张磊 Kubernetes","note":"","ucode":"16E29BDAB1F5BC","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":425332,"discussion_content":"呃，提示都说了让你装kubeadm 1.11然后执行格式转换呢……为啥不操作呢","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1538129717,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":26938,"user_name":"同心结","can_delete":false,"product_type":"c1","uid":1248791,"ip_address":"","ucode":"84E7796FE1A602","user_header":"https://static001.geekbang.org/account/avatar/00/13/0e/17/0aa98ae7.jpg","comment_is_top":false,"comment_ctime":1537780338,"is_pvip":false,"replies":[{"id":"9869","content":"学习一下systemd ","user_name":"作者回复","user_name_real":"Geek_6ef93d","uid":"1218095","ctime":1537887122,"ip_address":"","comment_id":26938,"utype":1}],"discussion_count":1,"race_medal":0,"score":"23012616818","product_id":100015201,"comment_content":"你好，我搭好了节点重启之后服务没起来，我怎么让服务跑起来呀","like_count":5,"discussions":[{"author":{"id":1218095,"avatar":"https://static001.geekbang.org/account/avatar/00/12/96/2f/876085fa.jpg","nickname":"张磊 Kubernetes","note":"","ucode":"16E29BDAB1F5BC","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":424762,"discussion_content":"学习一下systemd ","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1537887122,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":25168,"user_name":"John","can_delete":false,"product_type":"c1","uid":1104765,"ip_address":"","ucode":"4CBECD3CA7FCFC","user_header":"https://static001.geekbang.org/account/avatar/00/10/db/7d/1fbad49b.jpg","comment_is_top":false,"comment_ctime":1537260824,"is_pvip":true,"replies":[{"id":"9196","content":"可以离线下好","user_name":"作者回复","user_name_real":"Geek_6ef93d","uid":"1218095","ctime":1537316050,"ip_address":"","comment_id":25168,"utype":1}],"discussion_count":1,"race_medal":0,"score":"23012097304","product_id":100015201,"comment_content":"不翻墙 有办法装 kubeadm 吗？","like_count":5,"discussions":[{"author":{"id":1218095,"avatar":"https://static001.geekbang.org/account/avatar/00/12/96/2f/876085fa.jpg","nickname":"张磊 Kubernetes","note":"","ucode":"16E29BDAB1F5BC","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":424212,"discussion_content":"可以离线下好","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1537316050,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":328029,"user_name":"深度复制","can_delete":false,"product_type":"c1","uid":2216606,"ip_address":"","ucode":"F15CE379E8205D","user_header":"https://static001.geekbang.org/account/avatar/00/21/d2/9e/92b72b13.jpg","comment_is_top":false,"comment_ctime":1640488085,"is_pvip":false,"discussion_count":1,"race_medal":0,"score":"18820357269","product_id":100015201,"comment_content":"$ git clone --single-branch --branch master https:&#47;&#47;github.com&#47;rook&#47;rook.git<br>cd rook&#47;deploy&#47;examples<br>kubectl create -f crds.yaml -f common.yaml -f operator.yaml<br>kubectl create -f cluster.yaml","like_count":4,"discussions":[{"author":{"id":1213988,"avatar":"https://static001.geekbang.org/account/avatar/00/12/86/24/c9365583.jpg","nickname":"Jane","note":"","ucode":"D6CCAA4E001F9E","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":559777,"discussion_content":"太感谢了，至少成功安装了","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1648954632,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":301112,"user_name":"高益力","can_delete":false,"product_type":"c1","uid":2587544,"ip_address":"","ucode":"FDE592D36ECB7F","user_header":"https://static001.geekbang.org/account/avatar/00/27/7b/98/692c89ff.jpg","comment_is_top":false,"comment_ctime":1625541553,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"18805410737","product_id":100015201,"comment_content":"最新的部署ceph cluster需要多一条部署命令才可以部署成功：<br>1. kubectl apply -f https:&#47;&#47;raw.githubusercontent.com&#47;rook&#47;rook&#47;release-1.1&#47;cluster&#47;examples&#47;kubernetes&#47;ceph&#47;common.yaml<br>2. kubectl apply -f https:&#47;&#47;raw.githubusercontent.com&#47;rook&#47;rook&#47;release-1.1&#47;cluster&#47;examples&#47;kubernetes&#47;ceph&#47;operator.yaml<br>3. kubectl apply -f https:&#47;&#47;raw.githubusercontent.com&#47;rook&#47;rook&#47;release-1.1&#47;cluster&#47;examples&#47;kubernetes&#47;ceph&#47;cluster.yaml","like_count":4},{"had_liked":false,"id":239869,"user_name":"涟漪","can_delete":false,"product_type":"c1","uid":1161368,"ip_address":"","ucode":"2D643A25097FF5","user_header":"https://static001.geekbang.org/account/avatar/00/11/b8/98/ce254cef.jpg","comment_is_top":false,"comment_ctime":1596681190,"is_pvip":false,"discussion_count":1,"race_medal":0,"score":"18776550374","product_id":100015201,"comment_content":"# unable to recognize no matches for kind &quot;DaemonSet&quot; in version &quot;extensions&#47;v1beta1&quot;<br>kubectl apply -f https:&#47;&#47;git.io&#47;weave-kube-1.6<br><br># use<br>kubectl apply -n kube-system -f &quot;https:&#47;&#47;cloud.weave.works&#47;k8s&#47;net?k8s-version=$(kubectl version | base64 | tr -d &#39;\\n&#39;)&quot;<br>","like_count":4,"discussions":[{"author":{"id":1161368,"avatar":"https://static001.geekbang.org/account/avatar/00/11/b8/98/ce254cef.jpg","nickname":"涟漪","note":"","ucode":"2D643A25097FF5","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":296877,"discussion_content":"自己没注意看上面已经贴了该处理方案","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1596694071,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":238801,"user_name":"Tyrone.Zhao","can_delete":false,"product_type":"c1","uid":1162774,"ip_address":"","ucode":"E630EA41C799EB","user_header":"https://static001.geekbang.org/account/avatar/00/11/be/16/9ddeb937.jpg","comment_is_top":false,"comment_ctime":1596304688,"is_pvip":true,"discussion_count":1,"race_medal":4,"score":"18776173872","product_id":100015201,"comment_content":"根据老师的配置文件，因为不可描述的原因，无法下载镜像，可以使用如下代码替换，现将镜像pull各个节点，再进行kubeadm init --config kubeadm.yaml，我已经试验成功！<br>images=(<br>kube-apiserver-amd64:v1.11.10<br>kube-controller-manager-amd64:v1.11.10<br>kube-scheduler-amd64:v1.11.10<br>kube-proxy-amd64:v1.11.10<br>pause:3.1<br>etcd-amd64:3.2.18<br>coredns:1.1.3<br>)<br>for imageName in ${images[@]} ; do<br>    docker pull registry.cn-hangzhou.aliyuncs.com&#47;google_containers&#47;$imageName<br>    docker tag registry.cn-hangzhou.aliyuncs.com&#47;google_containers&#47;$imageName k8s.gcr.io&#47;$imageName<br>done","like_count":4,"discussions":[{"author":{"id":1218761,"avatar":"https://static001.geekbang.org/account/avatar/00/12/98/c9/9b457156.jpg","nickname":"西红柿牛腩泡饼","note":"","ucode":"0B090A9D8588F0","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":352431,"discussion_content":"images=$(kubeadm config images list 2>/dev/null | awk -F &#39;/&#39; &#39;{print $2}&#39;)\nfor imageName in ${images[@]} ; do\n    docker pull registry.cn-hangzhou.aliyuncs.com/google_containers/$imageName\n    docker tag registry.cn-hangzhou.aliyuncs.com/google_containers/$imageName k8s.gcr.io/$imageName\n    docker rmi registry.cn-hangzhou.aliyuncs.com/google_containers/$imageName\ndone","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1614735775,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":57351,"user_name":"Q_小_D","can_delete":false,"product_type":"c1","uid":1055856,"ip_address":"","ucode":"6BDF3337B2EEB5","user_header":"https://static001.geekbang.org/account/avatar/00/10/1c/70/788e6dac.jpg","comment_is_top":false,"comment_ctime":1546761273,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"18726630457","product_id":100015201,"comment_content":"想着半天弄完的，结果前前后后折腾了1天半，主要卡在的基本上都是网络的问题。<br>先说结论：最后我的virtualbox上的创建了两个桥接网卡的虚机，完成了k8s集群的搭建。<br>再说问题：<br>1、获取不到gcr.io上的镜像，我参考了留言和https:&#47;&#47;blog.csdn.net&#47;nklinsirui&#47;article&#47;details&#47;80581286解决了。<br>2、卡在多网卡的问题上。<br>2.1、我的环境是virtual box上虚拟的两个ubuntu，网络设置为nat+host only，集群搭建好之后，死活无法启动dashboard、ceph的容器（好多老外也是这么弄的啊），各种查各种试，也没解决问题。在kubernetes的官网上只说了“If you have more than one network adapter, and your Kubernetes components are not reachable on the default route, we recommend you add IP route(s) so Kubernetes cluster addresses go via the appropriate adapter.”。哪位大神按照这种方式弄好的清指点下，很是困惑啊啊啊啊，谁能解救我下………………<br>2.2、放弃了2.1的nat+host only，改为了桥接的网络方式，只保留一个network interface，成功。","like_count":4},{"had_liked":false,"id":52642,"user_name":"William","can_delete":false,"product_type":"c1","uid":1241365,"ip_address":"","ucode":"4499F99B180102","user_header":"https://static001.geekbang.org/account/avatar/00/12/f1/15/8fcf8038.jpg","comment_is_top":false,"comment_ctime":1545464689,"is_pvip":true,"discussion_count":0,"race_medal":2,"score":"18725333873","product_id":100015201,"comment_content":"遇到kubeadm不支持docker ce 18.09, 只好版本回退。https:&#47;&#47;github.com&#47;kubernetes&#47;minikube&#47;issues&#47;3323<br><br>```<br>&#47;&#47;卸载新版本docker<br>$ sudo apt-get purge docker-ce<br>$ sudo rm -rf &#47;var&#47;lib&#47;docker<br>&#47;&#47;安装旧版本docker<br>$ sudo apt-get install -y docker.io<br>```","like_count":4},{"had_liked":false,"id":25957,"user_name":"Hurt","can_delete":false,"product_type":"c1","uid":1050946,"ip_address":"","ucode":"DCE7428CCF08EF","user_header":"https://static001.geekbang.org/account/avatar/00/10/09/42/1f762b72.jpg","comment_is_top":false,"comment_ctime":1537488266,"is_pvip":false,"replies":[{"id":"9426","content":"你执行了多少个kubeadm join，就有多少个工作节点","user_name":"作者回复","user_name_real":"Geek_6ef93d","uid":"1218095","ctime":1537493860,"ip_address":"","comment_id":25957,"utype":1}],"discussion_count":1,"race_medal":0,"score":"18717357450","product_id":100015201,"comment_content":"老师 我一直想问 这个集群 是在一台服务器上吗 还是多台啊","like_count":4,"discussions":[{"author":{"id":1218095,"avatar":"https://static001.geekbang.org/account/avatar/00/12/96/2f/876085fa.jpg","nickname":"张磊 Kubernetes","note":"","ucode":"16E29BDAB1F5BC","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":424473,"discussion_content":"你执行了多少个kubeadm join，就有多少个工作节点","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1537493860,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":25086,"user_name":"刘欣洲","can_delete":false,"product_type":"c1","uid":1020871,"ip_address":"","ucode":"767B7D80D01623","user_header":"https://static001.geekbang.org/account/avatar/00/0f/93/c7/1640226d.jpg","comment_is_top":false,"comment_ctime":1537244046,"is_pvip":false,"replies":[{"id":"9139","content":"都有gcp了还搞rook干啥，这些cloud都已经给kubernetes做了存储支持了","user_name":"作者回复","user_name_real":"Geek_6ef93d","uid":"1218095","ctime":1537248211,"ip_address":"","comment_id":25086,"utype":1}],"discussion_count":1,"race_medal":0,"score":"18717113230","product_id":100015201,"comment_content":"Rook 能够直接支持Google 的 GCP的persistent disk 吗？该如何实现呢？","like_count":4,"discussions":[{"author":{"id":1218095,"avatar":"https://static001.geekbang.org/account/avatar/00/12/96/2f/876085fa.jpg","nickname":"张磊 Kubernetes","note":"","ucode":"16E29BDAB1F5BC","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":424182,"discussion_content":"都有gcp了还搞rook干啥，这些cloud都已经给kubernetes做了存储支持了","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1537248211,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":24776,"user_name":"小鱼儿","can_delete":false,"product_type":"c1","uid":1053492,"ip_address":"","ucode":"989EC453936B91","user_header":"https://static001.geekbang.org/account/avatar/00/10/13/34/abb7bfe3.jpg","comment_is_top":false,"comment_ctime":1537192948,"is_pvip":false,"replies":[{"id":"9143","content":"dash","user_name":"作者回复","user_name_real":"Geek_6ef93d","uid":"1218095","ctime":1537248368,"ip_address":"","comment_id":24776,"utype":1}],"discussion_count":2,"race_medal":0,"score":"18717062132","product_id":100015201,"comment_content":"老师，请问你的“-”是怎么读的？","like_count":4,"discussions":[{"author":{"id":1218095,"avatar":"https://static001.geekbang.org/account/avatar/00/12/96/2f/876085fa.jpg","nickname":"张磊 Kubernetes","note":"","ucode":"16E29BDAB1F5BC","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":424107,"discussion_content":"dash","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1537248368,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":2930234,"avatar":"https://thirdwx.qlogo.cn/mmopen/vi_32/KqZeIjNOVQJnsIFkDBWl5wfaxWDGLpIMUdFbF7SQhXFavmxgpwQPj9FrGAV4xNrqd733qicT4IZVibELyziaLokDQ/132","nickname":"罗艺","note":"","ucode":"9D4E1A377BCF23","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":565720,"discussion_content":"这不就是杠吗  ^ _ ^  ","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1650527677,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":24676,"user_name":"巩夫建","can_delete":false,"product_type":"c1","uid":1222958,"ip_address":"","ucode":"6B06A4399D2338","user_header":"https://static001.geekbang.org/account/avatar/00/12/a9/2e/01b2839e.jpg","comment_is_top":false,"comment_ctime":1537183852,"is_pvip":false,"replies":[{"id":"9046","content":"还不行，而且也没人太愿意试","user_name":"作者回复","user_name_real":"Geek_6ef93d","uid":"1218095","ctime":1537187377,"ip_address":"","comment_id":24676,"utype":1}],"discussion_count":1,"race_medal":0,"score":"18717053036","product_id":100015201,"comment_content":"二进制部署，目前是1.11.3版本。测试环境大约50台。遇到问题是calico与ipvs知识点不足。<br>部署趟了不少坑都过来了，感觉kubernetes不管理网络开放cni这种，提升不少门槛。此外由于文件系统的问题，之前说work节点不能用pod部署，不知道现在解决了吗？","like_count":4,"discussions":[{"author":{"id":1218095,"avatar":"https://static001.geekbang.org/account/avatar/00/12/96/2f/876085fa.jpg","nickname":"张磊 Kubernetes","note":"","ucode":"16E29BDAB1F5BC","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":424083,"discussion_content":"还不行，而且也没人太愿意试","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1537187377,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":24614,"user_name":"gogo","can_delete":false,"product_type":"c1","uid":1003104,"ip_address":"","ucode":"E8F0F3B000020A","user_header":"https://static001.geekbang.org/account/avatar/00/0f/4e/60/0d5aa340.jpg","comment_is_top":false,"comment_ctime":1537165273,"is_pvip":false,"replies":[{"id":"9052","content":"对，这个也没有GA，但是也很快了。","user_name":"作者回复","user_name_real":"Geek_6ef93d","uid":"1218095","ctime":1537187662,"ip_address":"","comment_id":24614,"utype":1}],"discussion_count":1,"race_medal":0,"score":"18717034457","product_id":100015201,"comment_content":"还有个问题，现在rook ceph版本还是beta，不能用于生产环境吧？","like_count":4,"discussions":[{"author":{"id":1218095,"avatar":"https://static001.geekbang.org/account/avatar/00/12/96/2f/876085fa.jpg","nickname":"张磊 Kubernetes","note":"","ucode":"16E29BDAB1F5BC","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":424058,"discussion_content":"对，这个也没有GA，但是也很快了。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1537187662,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":24561,"user_name":"岁月～静好","can_delete":false,"product_type":"c1","uid":1218348,"ip_address":"","ucode":"A639FDFE5EEC54","user_header":"https://static001.geekbang.org/account/avatar/00/12/97/2c/28f11cd9.jpg","comment_is_top":false,"comment_ctime":1537143876,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"18717013060","product_id":100015201,"comment_content":"一定要操作试试，要不翻篇就忘了，鱼的记忆😂","like_count":4},{"had_liked":false,"id":24559,"user_name":"pytimer","can_delete":false,"product_type":"c1","uid":1014666,"ip_address":"","ucode":"A0038F6CB1F9AC","user_header":"http://thirdwx.qlogo.cn/mmopen/vi_32/DYAIOgq83ercmNryEicqDS73icpUu7W0BnZ7ZIia6jR7kdVMIzH0q1d7L8EKAYWeTJcribibGcHnJzpsjRFxAe26egQ/132","comment_is_top":false,"comment_ctime":1537143514,"is_pvip":false,"replies":[{"id":"8988","content":"小规模生产环境没问题。需要执行kubeadm upgrade","user_name":"作者回复","user_name_real":"Geek_6ef93d","uid":"1218095","ctime":1537152240,"ip_address":"","comment_id":24559,"utype":1}],"discussion_count":1,"race_medal":0,"score":"18717012698","product_id":100015201,"comment_content":"使用过ansible和纯二进制文件部署集群，证书之类的比较麻烦，而且添加节点我不方便。<br>现在Kubernetes集群官方最大节点是5000吧，我自己的环境的话就6个节点。<br><br>老师，想要问下，我现在使用kubeadm来部署生产环境的高可用可以吗？有什么风险吗？<br>另外，在使用kubeadm join添加节点的时候，token过期怎么处理？我现在都是设置ttl=0，但是感觉这种不太好","like_count":4,"discussions":[{"author":{"id":1218095,"avatar":"https://static001.geekbang.org/account/avatar/00/12/96/2f/876085fa.jpg","nickname":"张磊 Kubernetes","note":"","ucode":"16E29BDAB1F5BC","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":424034,"discussion_content":"小规模生产环境没问题。需要执行kubeadm upgrade","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1537152240,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":316817,"user_name":"Geek_fightingDC","can_delete":false,"product_type":"c1","uid":1843027,"ip_address":"","ucode":"EF7F7316ADFF49","user_header":"https://thirdwx.qlogo.cn/mmopen/vi_32/DYAIOgq83equSjO9AVmwhvyhTZzk6icNTSED9s1sUdFZSfqTHq2PmZ4MibMFX58C8qDW2a4cjiaFvAdiaRchsLz54g/132","comment_is_top":false,"comment_ctime":1634558626,"is_pvip":true,"discussion_count":0,"race_medal":1,"score":"14519460514","product_id":100015201,"comment_content":"设置阿里云的镜像源，在执行kubeadm init时，可以指定如下的参数<br> kubeadm init \\<br>&gt; --apiserver-advertise-address=192.168.56.11 \\<br>&gt; --image-repository registry.aliyuncs.com&#47;google_containers \\<br>&gt; --pod-network-cidr=10.244.0.0&#47;16","like_count":3},{"had_liked":false,"id":277659,"user_name":"木{2}","can_delete":false,"product_type":"c1","uid":1781400,"ip_address":"","ucode":"0830F806503B85","user_header":"https://static001.geekbang.org/account/avatar/00/1b/2e/98/b63dbbaf.jpg","comment_is_top":false,"comment_ctime":1612510336,"is_pvip":false,"discussion_count":1,"race_medal":0,"score":"14497412224","product_id":100015201,"comment_content":"https:&#47;&#47;blog.csdn.net&#47;lijian965644856&#47;article&#47;details&#47;112740505<br>一台笔记本  从0开始 基于kubeadm搭建的  欢迎大家来指导","like_count":3,"discussions":[{"author":{"id":2560628,"avatar":"https://static001.geekbang.org/account/avatar/00/27/12/74/091553e3.jpg","nickname":"rkmms","note":"","ucode":"AE04CA87FF6BDF","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":375474,"discussion_content":"这个比较靠谱","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1621676455,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":222806,"user_name":"君哥聊技术","can_delete":false,"product_type":"c1","uid":1325816,"ip_address":"","ucode":"2C9A22BCE4C79E","user_header":"https://static001.geekbang.org/account/avatar/00/14/3a/f8/c1a939e7.jpg","comment_is_top":false,"comment_ctime":1590916171,"is_pvip":false,"discussion_count":2,"race_medal":0,"score":"14475818059","product_id":100015201,"comment_content":"文章的指导作用很大，踩了好多坑，终于搭建起来了，分享一下搭建过程<br>https:&#47;&#47;blog.csdn.net&#47;zjj2006&#47;article&#47;details&#47;106445535","like_count":3,"discussions":[{"author":{"id":1325816,"avatar":"https://static001.geekbang.org/account/avatar/00/14/3a/f8/c1a939e7.jpg","nickname":"君哥聊技术","note":"","ucode":"2C9A22BCE4C79E","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":307665,"discussion_content":"哈哈，肯定能成功，就是坑有点多","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1600731628,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1121758,"avatar":"https://static001.geekbang.org/account/avatar/00/11/1d/de/62bfa83f.jpg","nickname":"aoe","note":"","ucode":"1C6201EDB4E954","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":307638,"discussion_content":"大佬居然搭建成功了！","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1600701767,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":109581,"user_name":"wjy","can_delete":false,"product_type":"c1","uid":1225122,"ip_address":"","ucode":"EF84E333EFD606","user_header":"http://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTLUnFj3USkK2x2ib42MRXzFzKJJGRa1AfMUvhpibZm5tHNniamy19ial2warIfIjj0pp7YnwjEic7SLvEg/132","comment_is_top":false,"comment_ctime":1562061135,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"14446963023","product_id":100015201,"comment_content":"kubeadm1.15<br>apiVersion: kubeadm.k8s.io&#47;v1beta2<br>kind:  ClusterConfiguration<br>controllerManagerExtraArgs:<br>  horizontal-pod-autoscaler-use-rest-clients: &quot;true&quot;<br>  horizontal-pod-autoscaler-sync-period: &quot;10s&quot;<br>  node-monitor-grace-period: &quot;10s&quot;<br>apiServerExtraArgs:<br>  runtime-config: &quot;api&#47;all=true&quot;<br>kubernetesVersion: &quot;stable-1.15&quot;<br><br>可以先用kubeadm config print init-defaults输出默认支持的","like_count":3},{"had_liked":false,"id":99268,"user_name":"Dem","can_delete":false,"product_type":"c1","uid":1032595,"ip_address":"","ucode":"C09FF65D904A75","user_header":"https://static001.geekbang.org/account/avatar/00/0f/c1/93/e8bfb26e.jpg","comment_is_top":false,"comment_ctime":1559183801,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"14444085689","product_id":100015201,"comment_content":"感谢之前留言的同学。搭建好了墙内环境1Master+3Worker的kubernetes集群。记录了一下搭建过程中踩过的坑。<br><br>kubeadm部署Kubernetes1.14.2集群踩坑记<br>https:&#47;&#47;galaxyyao.github.io&#47;2019&#47;05&#47;29&#47;%E5%AE%B9%E5%99%A8-5-kubeadm%E9%83%A8%E7%BD%B2Kubernetes1-14-2%E9%9B%86%E7%BE%A4%E8%B8%A9%E5%9D%91%E8%AE%B0&#47;","like_count":3},{"had_liked":false,"id":85081,"user_name":"love the way","can_delete":false,"product_type":"c1","uid":1087461,"ip_address":"","ucode":"5B077026915F63","user_header":"https://static001.geekbang.org/account/avatar/00/10/97/e5/b54f8105.jpg","comment_is_top":false,"comment_ctime":1554974165,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"14439876053","product_id":100015201,"comment_content":"kubeadm token create --print-join-command 重新生成node节点join信息","like_count":3},{"had_liked":false,"id":76617,"user_name":"咸鱼不想翻身","can_delete":false,"product_type":"c1","uid":1447584,"ip_address":"","ucode":"F662980A82DC18","user_header":"https://static001.geekbang.org/account/avatar/00/16/16/a0/88c17929.jpg","comment_is_top":false,"comment_ctime":1552644212,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"14437546100","product_id":100015201,"comment_content":"k8s相关镜像可以先在github上建一个项目, 然后给每个镜像定义一个Dockerfile, 内容为FROM ${K8S_IMGS}, 然后可以通过阿里云容器镜像服务将这个镜像构建到阿里云上, 然后pull到本地后重新打tag为k8s镜像原来得名字.","like_count":3},{"had_liked":false,"id":65506,"user_name":"樊金辉","can_delete":false,"product_type":"c1","uid":1070404,"ip_address":"","ucode":"A9E093711441A7","user_header":"https://static001.geekbang.org/account/avatar/00/10/55/44/1e8e9ec2.jpg","comment_is_top":false,"comment_ctime":1549421133,"is_pvip":false,"discussion_count":1,"race_medal":0,"score":"14434323021","product_id":100015201,"comment_content":"https:&#47;&#47;raw.githubusercontent.com&#47;kubernetes&#47;dashboard&#47;master&#47;src&#47;deploy&#47;recommended&#47;kubernetes-dashboard.yaml 已不可用。<br>用https:&#47;&#47;raw.githubusercontent.com&#47;kubernetes&#47;dashboard&#47;master&#47;aio&#47;deploy&#47;recommended&#47;kubernetes-dashboard.yaml替代，一切正常","like_count":3,"discussions":[{"author":{"id":1172029,"avatar":"https://static001.geekbang.org/account/avatar/00/11/e2/3d/9a52946b.jpg","nickname":"天若有情天亦老","note":"","ucode":"57F0B7D524C0CF","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":95647,"discussion_content":"也挂了","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1577025425,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":53425,"user_name":"小西几","can_delete":false,"product_type":"c1","uid":1286375,"ip_address":"","ucode":"ED1DDE17534508","user_header":"https://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTJjzTQ6HPGw2LWLiaiciaibfdMMlmxEwBkBjxOPxeYynZlBKCf6U1b0ezM9IZYibB6yKR7HpRuAOdtj29Q/132","comment_is_top":false,"comment_ctime":1545641473,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"14430543361","product_id":100015201,"comment_content":"版本变化太快了,按照老师一样环境的话,可以这样(cenots 7.4):<br><br>yum install -y https:&#47;&#47;mirrors.aliyun.com&#47;docker-ce&#47;linux&#47;centos&#47;7&#47;x86_64&#47;stable&#47;Packages&#47;docker-ce-selinux-17.03.0.ce-1.el7.centos.noarch.rpm<br>yum -y install docker-ce-17.03.0.ce <br>yum -y install kubelet-1.11.1 kubeadm-1.11.1  kubectl-1.11.1 kubernetes-cni","like_count":3},{"had_liked":false,"id":30376,"user_name":"Demon.Lee","can_delete":false,"product_type":"c1","uid":1052859,"ip_address":"","ucode":"7F0E5493A8E345","user_header":"https://static001.geekbang.org/account/avatar/00/10/10/bb/f1061601.jpg","comment_is_top":false,"comment_ctime":1538815071,"is_pvip":false,"replies":[{"id":"10973","content":"单节点只有master就够了","user_name":"作者回复","user_name_real":"Geek_6ef93d","uid":"1218095","ctime":1538840034,"ip_address":"","comment_id":30376,"utype":1}],"discussion_count":1,"race_medal":1,"score":"14423716959","product_id":100015201,"comment_content":"部署完master节点，再部署一个worker节点，可以在一个pc上吗，还是需要多个pc","like_count":3,"discussions":[{"author":{"id":1218095,"avatar":"https://static001.geekbang.org/account/avatar/00/12/96/2f/876085fa.jpg","nickname":"张磊 Kubernetes","note":"","ucode":"16E29BDAB1F5BC","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":425966,"discussion_content":"单节点只有master就够了","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1538840034,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":27903,"user_name":"Casper","can_delete":false,"product_type":"c1","uid":1022129,"ip_address":"","ucode":"69282EB175B48E","user_header":"https://static001.geekbang.org/account/avatar/00/0f/98/b1/f89a84d0.jpg","comment_is_top":false,"comment_ctime":1537963710,"is_pvip":true,"replies":[{"id":"10127","content":"调度失败，看events","user_name":"作者回复","user_name_real":"Geek_6ef93d","uid":"1218095","ctime":1538018535,"ip_address":"","comment_id":27903,"utype":1}],"discussion_count":1,"race_medal":5,"score":"14422865598","product_id":100015201,"comment_content":"root@kubernetes01:~# kubectl get pods -n rook-ceph-system<br>NAME                                  READY     STATUS    RESTARTS   AGE<br>rook-ceph-operator-78d498c68c-t2b7w   0&#47;1       Pending   0          21m<br><br>如何查看这个容器为什么一直是pending状态","like_count":3,"discussions":[{"author":{"id":1218095,"avatar":"https://static001.geekbang.org/account/avatar/00/12/96/2f/876085fa.jpg","nickname":"张磊 Kubernetes","note":"","ucode":"16E29BDAB1F5BC","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":425078,"discussion_content":"调度失败，看events","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1538018535,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":26494,"user_name":"在路上","can_delete":false,"product_type":"c1","uid":1143372,"ip_address":"","ucode":"335960F683C23C","user_header":"https://static001.geekbang.org/account/avatar/00/11/72/4c/4d636a23.jpg","comment_is_top":false,"comment_ctime":1537622522,"is_pvip":false,"replies":[{"id":"9625","content":"那只能单节点","user_name":"作者回复","user_name_real":"Geek_6ef93d","uid":"1218095","ctime":1537672240,"ip_address":"","comment_id":26494,"utype":1}],"discussion_count":1,"race_medal":0,"score":"14422524410","product_id":100015201,"comment_content":"老师，部署worker节点，和master是不在同一台机器吗？同一台不行吗？用自己的笔记本，集群master是部署在virtualbox的ubuntu上的，那这些worker要怎么弄呢？","like_count":3,"discussions":[{"author":{"id":1218095,"avatar":"https://static001.geekbang.org/account/avatar/00/12/96/2f/876085fa.jpg","nickname":"张磊 Kubernetes","note":"","ucode":"16E29BDAB1F5BC","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":424649,"discussion_content":"那只能单节点","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1537672240,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":25992,"user_name":"Frank","can_delete":false,"product_type":"c1","uid":1111985,"ip_address":"","ucode":"9DADD72C193296","user_header":"https://static001.geekbang.org/account/avatar/00/10/f7/b1/982ea185.jpg","comment_is_top":false,"comment_ctime":1537489678,"is_pvip":true,"replies":[{"id":"9425","content":"搜kubeadm high available ，就是第一版高可用部署的文档，不过还没有GA","user_name":"作者回复","user_name_real":"Geek_6ef93d","uid":"1218095","ctime":1537493829,"ip_address":"","comment_id":25992,"utype":1}],"discussion_count":1,"race_medal":0,"score":"14422391566","product_id":100015201,"comment_content":"老师 生产环境的部署方法。能讲一讲吗？或者推荐一下相关文档啊。","like_count":3,"discussions":[{"author":{"id":1218095,"avatar":"https://static001.geekbang.org/account/avatar/00/12/96/2f/876085fa.jpg","nickname":"张磊 Kubernetes","note":"","ucode":"16E29BDAB1F5BC","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":424487,"discussion_content":"搜kubeadm high available ，就是第一版高可用部署的文档，不过还没有GA","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1537493829,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":25724,"user_name":"blackpiglet","can_delete":false,"product_type":"c1","uid":1032928,"ip_address":"","ucode":"58AA8329C91767","user_header":"https://static001.geekbang.org/account/avatar/00/0f/c2/e0/7188aa0a.jpg","comment_is_top":false,"comment_ctime":1537425119,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"14422327007","product_id":100015201,"comment_content":"1.  目前主要使用 Kubeadm 部署环境，试用时曾用过 Minikube，也曾经用过 Kubernetes 官方的 Ansible  playbook 部署过，想尝试 kubespray 和 TerraFrom。Minikube 我理解是用虚拟机作为单节点跑 k8s 集群，具体的流程不了解，总之没有梯子是搞不定的。Kubernetes Ansible playbook 是好长时间以前用的了，感觉效果还不错，至少比我自己写的 playbook 靠谱多了...<br>2. Kubernetes 集群的规模限制在官方文档里说的很清楚：<br>No more than 5000 nodes<br>No more than 150000 total pods<br>No more than 300000 total containers<br>No more than 100 pods per node<br>现在环境也就是五台物理机。","like_count":3},{"had_liked":false,"id":314192,"user_name":"Geek_xiong","can_delete":false,"product_type":"c1","uid":2779970,"ip_address":"","ucode":"1A92DD9B35AC4E","user_header":"","comment_is_top":false,"comment_ctime":1632893210,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"10222827802","product_id":100015201,"comment_content":"2021&#47;9，安装kubernetes V1.22.2版本，呕心沥血吸取前人所有教训后搭建成功，全是干货，分享给大家；<br>https:&#47;&#47;zhuanlan.zhihu.com&#47;p&#47;415297992","like_count":2},{"had_liked":false,"id":310463,"user_name":"🙃骚军","can_delete":false,"product_type":"c1","uid":1691067,"ip_address":"","ucode":"12FEACE3515FE7","user_header":"https://static001.geekbang.org/account/avatar/00/19/cd/bb/77c92649.jpg","comment_is_top":false,"comment_ctime":1630661779,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"10220596371","product_id":100015201,"comment_content":"问题1<br>kubectl apply -f https:&#47;&#47;git.io&#47;weave-kube-1.6<br>网络原因失败<br>解决：<br>kubectl apply -f &quot;https:&#47;&#47;cloud.weave.works&#47;k8s&#47;net?k8s-version=$(kubectl version | base64 | tr -d &#39;\\n&#39;)&quot;<br><br>问题2：<br>weave-net 第二个pod一直拉不起来<br>解决：<br>查看日志<br>kubectl -n kube-system logs -f weave-net-7rnfn weave<br>发现<br>Network 10.32.0.0&#47;12 overlaps with existing route 10.0.0.0&#47;8 on host.<br>route 发现有一条 10.0.0.0&#47;8 的路由，删掉即可解决<br><br>原因：要创建的路由与本机已有的路由重叠了，为什么要创建路由呢？不懂<br><br>","like_count":2},{"had_liked":false,"id":302061,"user_name":"千回百转无劫山","can_delete":false,"product_type":"c1","uid":1456256,"ip_address":"","ucode":"2C249889C00929","user_header":"","comment_is_top":false,"comment_ctime":1626058985,"is_pvip":true,"discussion_count":1,"race_medal":0,"score":"10215993577","product_id":100015201,"comment_content":"rook安装的问题，我k8s的版本是v1.21.2。<br>1、问题：error: unable to recognize &quot;https:&#47;&#47;raw.githubusercontent.com&#47;rook&#47;rook&#47;master&#47;cluster&#47;examples&#47;kubernetes&#47;ceph&#47;cluster.yaml&quot;: no matches for kind &quot;CephCluster&quot; in version &quot;ceph.rook.io&#47;v1&quot;<br>解决方法：安装cluster.yaml之前先安装crds：<br>kubectl apply -f https:&#47;&#47;raw.githubusercontent.com&#47;rook&#47;rook&#47;master&#47;cluster&#47;examples&#47;kubernetes&#47;ceph&#47;crds.yaml<br><br>2、问题：镜像下载问题（通过describe pod 可以知道哪些image下载报错，我这边是5个），解决方法如下：<br>a、下载阿里的镜像：<br>docker pull registry.aliyuncs.com&#47;google_containers&#47;csi-attacher:v3.2.1<br>docker pull registry.aliyuncs.com&#47;google_containers&#47;csi-snapshotter:v4.1.1<br>docker pull registry.aliyuncs.com&#47;google_containers&#47;csi-resizer:v1.2.0<br>docker pull registry.aliyuncs.com&#47;google_containers&#47;csi-provisioner:v2.2.2<br>docker pull registry.aliyuncs.com&#47;google_containers&#47;csi-node-driver-registrar:v2.2.0<br>b、重新打tag：<br>docker tag registry.aliyuncs.com&#47;google_containers&#47;csi-attacher:v3.2.1 k8s.gcr.io&#47;sig-storage&#47;csi-attacher:v3.2.1<br>docker tag registry.aliyuncs.com&#47;google_containers&#47;csi-snapshotter:v4.1.1 k8s.gcr.io&#47;sig-storage&#47;csi-snapshotter:v4.1.1<br>docker tag registry.aliyuncs.com&#47;google_containers&#47;csi-resizer:v1.2.0 k8s.gcr.io&#47;sig-storage&#47;csi-resizer:v1.2.0<br>docker tag registry.aliyuncs.com&#47;google_containers&#47;csi-provisioner:v2.2.2 k8s.gcr.io&#47;sig-storage&#47;csi-provisioner:v2.2.2<br>docker tag registry.aliyuncs.com&#47;google_containers&#47;csi-node-driver-registrar:v2.2.0 k8s.gcr.io&#47;sig-storage&#47;csi-node-driver-registrar:v2.2.0","like_count":2,"discussions":[{"author":{"id":1592298,"avatar":"https://static001.geekbang.org/account/avatar/00/18/4b/ea/a9e7bc50.jpg","nickname":"℡人见人爱浩然君゜","note":"","ucode":"D042A622533C72","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":562027,"discussion_content":"好使","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1649765568,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":280055,"user_name":"lumence","can_delete":false,"product_type":"c1","uid":1144080,"ip_address":"","ucode":"00BA0ECFA6F002","user_header":"http://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTJtl3p4gcguAZy580SyoQAic79Z7QAvTcibnicV9K8x2Yzbxa8BlknwhquzTPPklaWPDDbrECQG3uurg/132","comment_is_top":false,"comment_ctime":1614066430,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"10204001022","product_id":100015201,"comment_content":"关于在ubuntu 20.04上安装最新版 kubeadm 搭建集群的教材在这里https:&#47;&#47;lixueduan.com&#47;post&#47;kubernetes&#47;01-install&#47; 灰常详细","like_count":2},{"had_liked":false,"id":279845,"user_name":"意琦行","can_delete":false,"product_type":"c1","uid":1637619,"ip_address":"","ucode":"B940AA60B5CCEE","user_header":"https://static001.geekbang.org/account/avatar/00/18/fc/f3/28fe16cf.jpg","comment_is_top":false,"comment_ctime":1613981554,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"10203916146","product_id":100015201,"comment_content":"v1.19.4 搭建成功，分享一下搭建过程 https:&#47;&#47;lixueduan.com&#47;post&#47;kubernetes&#47;01-install&#47;","like_count":2},{"had_liked":false,"id":273287,"user_name":"闪电瘸子","can_delete":false,"product_type":"c1","uid":1654090,"ip_address":"","ucode":"7C6723D14693AB","user_header":"https://static001.geekbang.org/account/avatar/00/19/3d/4a/7e488810.jpg","comment_is_top":false,"comment_ctime":1610525028,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"10200459620","product_id":100015201,"comment_content":"遇到了一个问题:<br>weave-net-hg6tz                        1&#47;2     Error     7          10m<br><br>Logs如下:<br> kubectl -n kube-system logs -f weave-net-hg6tz  weave<br>Network 10.32.0.0&#47;12 overlaps with existing route 10.41.112.0&#47;22 on host<br><br>解决办法:<br>kubectl apply -f &quot;https:&#47;&#47;cloud.weave.works&#47;k8s&#47;net?k8s-version=$(kubectl version | base64 | tr -d &#39;\\n&#39;)&amp;env.IPALLOC_RANGE=10.32.0.0&#47;16&quot;<br><br>摘自如下文章:<br>https:&#47;&#47;github.com&#47;weaveworks&#47;weave&#47;issues&#47;2736","like_count":2},{"had_liked":false,"id":249769,"user_name":"aoe","can_delete":false,"product_type":"c1","uid":1121758,"ip_address":"","ucode":"1C6201EDB4E954","user_header":"https://static001.geekbang.org/account/avatar/00/11/1d/de/62bfa83f.jpg","comment_is_top":false,"comment_ctime":1600784996,"is_pvip":false,"discussion_count":1,"race_medal":0,"score":"10190719588","product_id":100015201,"comment_content":"经过2天终于完成了老师的实验。非常感谢老师！如果自己摸索还不知道什么时候能完成。<br>一台物理机<br>Ubuntu 20.04.1 LTS<br>K8S v1.19.1<br>详细采坑过程：https:&#47;&#47;github.com&#47;wyyl1&#47;study&#47;blob&#47;master&#47;Kubernetes&#47;Kubernetes%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0.md","like_count":2,"discussions":[{"author":{"id":1281460,"avatar":"https://static001.geekbang.org/account/avatar/00/13/8d/b4/ff82483d.jpg","nickname":"邵俊达","note":"","ucode":"4B7DACE6DBCF95","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":531411,"discussion_content":"你好，我执行完 kubectl apply -f &#34;https://cloud.weave.works/k8s/net?k8s-version=$(kubectl version | base64 | tr -d &#39;\\n&#39;)&#34;  之后 pod 里没有 weave 相关的 pod 请问你遇到过么？","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1637306673,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"user_type\":1}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":242529,"user_name":"ch_ort","can_delete":false,"product_type":"c1","uid":1580926,"ip_address":"","ucode":"B79746E687F29E","user_header":"","comment_is_top":false,"comment_ctime":1597752099,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"10187686691","product_id":100015201,"comment_content":"使用kubeadm安装Kuberentes的顺序：<br><br>（1）在每台机器上安装docker、kubelet和kubeadm<br><br>（2）在master节点上使用kubeadm init拉起Master容器<br><br>（3）在node节点上使用kubeadm join加入集群<br>","like_count":2},{"had_liked":false,"id":198911,"user_name":"Joy Rick","can_delete":false,"product_type":"c1","uid":1905946,"ip_address":"","ucode":"EA42BD15FAF9BA","user_header":"https://static001.geekbang.org/account/avatar/00/1d/15/1a/fce31315.jpg","comment_is_top":false,"comment_ctime":1585473171,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"10175407763","product_id":100015201,"comment_content":"执行：kubectl apply -f https:&#47;&#47;git.io&#47;weave-kube-1.6 <br>报错：unable to recognize no matches for kind &quot;DaemonSet&quot; in version &quot;extensions&#47;v1beta1<br>修正：kubectl apply -f &quot;https:&#47;&#47;cloud.weave.works&#47;k8s&#47;net?k8s-version=$(kubectl version | base64 | tr -d &#39;\\n&#39;)&quot;","like_count":2},{"had_liked":false,"id":179586,"user_name":"小梅子","can_delete":false,"product_type":"c1","uid":1252585,"ip_address":"","ucode":"B9797DE06232D1","user_header":"https://static001.geekbang.org/account/avatar/00/13/1c/e9/48cc8f57.jpg","comment_is_top":false,"comment_ctime":1582034839,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"10171969431","product_id":100015201,"comment_content":"最新安装dashboard：https:&#47;&#47;github.com&#47;kubernetes&#47;dashboard&#47;blob&#47;master&#47;README.md<br>https:&#47;&#47;github.com&#47;kubernetes&#47;dashboard&#47;blob&#47;master&#47;README.md","like_count":2},{"had_liked":false,"id":168212,"user_name":"jacky","can_delete":false,"product_type":"c1","uid":1049177,"ip_address":"","ucode":"A0BD06E2ABF520","user_header":"https://static001.geekbang.org/account/avatar/00/10/02/59/989f65c8.jpg","comment_is_top":false,"comment_ctime":1578033602,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"10167968194","product_id":100015201,"comment_content":"请问张老师，现在kubeadm可以用于部署生产环境了吗？","like_count":2},{"had_liked":false,"id":101942,"user_name":"礼服黑面侠","can_delete":false,"product_type":"c1","uid":1219085,"ip_address":"","ucode":"445887C59B7CEC","user_header":"https://static001.geekbang.org/account/avatar/00/12/9a/0d/87501dab.jpg","comment_is_top":false,"comment_ctime":1560064396,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"10149998988","product_id":100015201,"comment_content":"dashboard d登录问题可以参考以下：<br>kubectl (replace&#47;apply) -f https:&#47;&#47;raw.githubusercontent.com&#47;kubernetes&#47;dashboard&#47;v1.10.1&#47;src&#47;deploy&#47;recommended&#47;kubernetes-dashboard.yaml<br>nohup kubectl proxy --address=&#39;0.0.0.0&#39; --port=8888 --accept-hosts=&#39;^*$&#39; &amp;<br>http:&#47;&#47;localhost:8888&#47;api&#47;v1&#47;namespaces&#47;kube-system&#47;services&#47;https:kubernetes-dashboard:&#47;proxy&#47;<br>","like_count":2},{"had_liked":false,"id":75615,"user_name":"Wesley","can_delete":false,"product_type":"c1","uid":1447393,"ip_address":"","ucode":"C7CBB2ADDA38AA","user_header":"https://static001.geekbang.org/account/avatar/00/16/15/e1/d199f33f.jpg","comment_is_top":false,"comment_ctime":1552439874,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"10142374466","product_id":100015201,"comment_content":"k8s v1.11.1，仅支持docker-ce 17.03版本（ubuntu18.04可安装最低版本为18.03,切记使用ubuntu16.04）<br>分享一个阿里云镜像脚本<br>cat &gt; pullimages.sh &lt;&lt; EOF<br>#!&#47;bin&#47;bash<br>K8S_VERSION=&quot;v1.11.1&quot;<br>images=(kube-proxy-amd64:${K8S_VERSION} kube-scheduler-amd64:${K8S_VERSION} kube-controller-manager-amd64:${K8S_VERSION}<br>kube-apiserver-amd64:${K8S_VERSION} etcd-amd64:3.2.18 coredns:1.1.3 pause:3.1 )<br>for imageName in ${images[@]} ; do<br>  docker pull registry.aliyuncs.com&#47;google_containers&#47;$imageName<br>  docker tag registry.aliyuncs.com&#47;google_containers&#47;$imageName k8s.gcr.io&#47;$imageName<br>  docker rmi registry.aliyuncs.com&#47;google_containers&#47;$imageName<br>done<br>EOF","like_count":2},{"had_liked":false,"id":60177,"user_name":"陈先生。","can_delete":false,"product_type":"c1","uid":1218783,"ip_address":"","ucode":"5D7B4768F3892B","user_header":"https://static001.geekbang.org/account/avatar/00/12/98/df/c88a4306.jpg","comment_is_top":false,"comment_ctime":1547446858,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"10137381450","product_id":100015201,"comment_content":"内网同学，写了一篇二进制部署文档，大家可以参考一下。https:&#47;&#47;www.jianshu.com&#47;p&#47;dab89bddd748","like_count":2},{"had_liked":false,"id":47152,"user_name":"木白","can_delete":false,"product_type":"c1","uid":1328068,"ip_address":"","ucode":"CEB80FA18A6F4D","user_header":"https://static001.geekbang.org/account/avatar/00/14/43/c4/3739e0a6.jpg","comment_is_top":false,"comment_ctime":1544064354,"is_pvip":false,"discussion_count":1,"race_medal":0,"score":"10133998946","product_id":100015201,"comment_content":"你好老师，我得worker节点在join后总是notready得状态，请问是为什么","like_count":2,"discussions":[{"author":{"id":1031901,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/be/dd/c96dda01.jpg","nickname":"zzxwill","note":"","ucode":"C594BDE2F0E481","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":7840,"discussion_content":"describe node 的结果是什么？","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1567689088,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":38631,"user_name":"每一段路都是一种领悟","can_delete":false,"product_type":"c1","uid":1123452,"ip_address":"","ucode":"B23F0D4B02197B","user_header":"https://static001.geekbang.org/account/avatar/00/11/24/7c/b76ad65d.jpg","comment_is_top":false,"comment_ctime":1542090575,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"10132025167","product_id":100015201,"comment_content":"老师。对于centos的overlay2存储引擎，怎么查看rootfs啊","like_count":2},{"had_liked":false,"id":33914,"user_name":"V V","can_delete":false,"product_type":"c1","uid":1220390,"ip_address":"","ucode":"9494330A6AA770","user_header":"https://static001.geekbang.org/account/avatar/00/12/9f/26/89eda2c8.jpg","comment_is_top":false,"comment_ctime":1539917968,"is_pvip":false,"replies":[{"id":"12140","content":"简单，这里有完整流程：https:&#47;&#47;github.com&#47;kubernetes&#47;kubeadm&#47;issues&#47;338 这就是为啥再三强调社区的重要性 :-)","user_name":"作者回复","user_name_real":"Geek_6ef93d","uid":"1218095","ctime":1539924292,"ip_address":"","comment_id":33914,"utype":1}],"discussion_count":1,"race_medal":0,"score":"10129852560","product_id":100015201,"comment_content":"请问ip地址改变后如何快速恢复cluster。我组了一个子网，使用kubeadm部署了cluster，之后运行了一些应用。之后路由器坏了，这些节点换到了更高一级的路由器下面，ip地址变了。kubectl get nodes的时候提示Unable to connect to the server: dial tcp 192.168.2.3:6443: i&#47;o timeout。请问如何快速恢复这个cluster?<br>","like_count":2,"discussions":[{"author":{"id":1218095,"avatar":"https://static001.geekbang.org/account/avatar/00/12/96/2f/876085fa.jpg","nickname":"张磊 Kubernetes","note":"","ucode":"16E29BDAB1F5BC","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":427073,"discussion_content":"简单，这里有完整流程：https://github.com/kubernetes/kubeadm/issues/338 这就是为啥再三强调社区的重要性 :-)","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1539924292,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":32675,"user_name":"jssfy","can_delete":false,"product_type":"c1","uid":1137238,"ip_address":"","ucode":"F16353CFE607B7","user_header":"https://static001.geekbang.org/account/avatar/00/11/5a/56/115c6433.jpg","comment_is_top":false,"comment_ctime":1539661549,"is_pvip":false,"replies":[{"id":"11911","content":"取决于你期望的隔离程度。kubernetes不支持强多租户。","user_name":"作者回复","user_name_real":"Geek_6ef93d","uid":"1218095","ctime":1539665039,"ip_address":"","comment_id":32675,"utype":1}],"discussion_count":1,"race_medal":0,"score":"10129596141","product_id":100015201,"comment_content":"请问多个租户可以考虑用同一套k8s来管理不？生产环境上","like_count":2,"discussions":[{"author":{"id":1218095,"avatar":"https://static001.geekbang.org/account/avatar/00/12/96/2f/876085fa.jpg","nickname":"张磊 Kubernetes","note":"","ucode":"16E29BDAB1F5BC","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":426854,"discussion_content":"取决于你期望的隔离程度。kubernetes不支持强多租户。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1539665039,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":29426,"user_name":"在路上","can_delete":false,"product_type":"c1","uid":1143372,"ip_address":"","ucode":"335960F683C23C","user_header":"https://static001.geekbang.org/account/avatar/00/11/72/4c/4d636a23.jpg","comment_is_top":false,"comment_ctime":1538367986,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"10128302578","product_id":100015201,"comment_content":"参考老师的讲解和网上的一些内容，自己整理的搭建k8s集群脚本，如需要，请自行下载使用，脚本仅供参考<br>https:&#47;&#47;download.csdn.net&#47;download&#47;hxd198&#47;10698951","like_count":2},{"had_liked":false,"id":28296,"user_name":"旺旺","can_delete":false,"product_type":"c1","uid":1159196,"ip_address":"","ucode":"FE2CF90F446BFB","user_header":"https://static001.geekbang.org/account/avatar/00/11/b0/1c/2e30eeb8.jpg","comment_is_top":false,"comment_ctime":1538045384,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"10127979976","product_id":100015201,"comment_content":"[ERROR Swap]: running with swap on is not supported. Please disable swap<br>出现这种错误的，需要你把swap给关掉，就可以了。","like_count":2},{"had_liked":false,"id":27332,"user_name":"龙坤","can_delete":false,"product_type":"c1","uid":1233455,"ip_address":"","ucode":"D1724E68D6304D","user_header":"https://static001.geekbang.org/account/avatar/00/12/d2/2f/04882ff8.jpg","comment_is_top":false,"comment_ctime":1537873082,"is_pvip":false,"replies":[{"id":"9850","content":"正常","user_name":"作者回复","user_name_real":"Geek_6ef93d","uid":"1218095","ctime":1537886626,"ip_address":"","comment_id":27332,"utype":1}],"discussion_count":1,"race_medal":1,"score":"10127807674","product_id":100015201,"comment_content":"root@master:~# kubectl get node<br>NAME      STATUS     ROLES     AGE       VERSION<br>master    Ready         master    1h        v1.11.3<br>worker1   Ready       &lt;none&gt;    37m       v1.11.3<br>worker2   Ready       &lt;none&gt;    31m       v1.11.3<br><br>所有pod都成功启动了。但是worker节点的ROLES为&lt;none&gt;，正常吗？","like_count":2,"discussions":[{"author":{"id":1218095,"avatar":"https://static001.geekbang.org/account/avatar/00/12/96/2f/876085fa.jpg","nickname":"张磊 Kubernetes","note":"","ucode":"16E29BDAB1F5BC","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":424882,"discussion_content":"正常","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1537886626,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":27270,"user_name":"王旭","can_delete":false,"product_type":"c1","uid":1225165,"ip_address":"","ucode":"891A1AFD82D566","user_header":"https://static001.geekbang.org/account/avatar/00/12/b1/cd/30b8a0f8.jpg","comment_is_top":false,"comment_ctime":1537862375,"is_pvip":false,"replies":[{"id":"9856","content":"注意敏感词","user_name":"作者回复","user_name_real":"Geek_6ef93d","uid":"1218095","ctime":1537886726,"ip_address":"","comment_id":27270,"utype":1}],"discussion_count":1,"race_medal":0,"score":"10127796967","product_id":100015201,"comment_content":"你好 我问下这整个环境的安装是不是只能翻墙了 才行.谢谢","like_count":2,"discussions":[{"author":{"id":1218095,"avatar":"https://static001.geekbang.org/account/avatar/00/12/96/2f/876085fa.jpg","nickname":"张磊 Kubernetes","note":"","ucode":"16E29BDAB1F5BC","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":424857,"discussion_content":"注意敏感词","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1537886726,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":26616,"user_name":"L","can_delete":false,"product_type":"c1","uid":1194428,"ip_address":"","ucode":"5F7F68DB091A0D","user_header":"https://static001.geekbang.org/account/avatar/00/12/39/bc/2764927e.jpg","comment_is_top":false,"comment_ctime":1537698505,"is_pvip":false,"replies":[{"id":"9682","content":"用你自己的node名字啊","user_name":"作者回复","user_name_real":"Geek_6ef93d","uid":"1218095","ctime":1537706848,"ip_address":"","comment_id":26616,"utype":1}],"discussion_count":1,"race_medal":0,"score":"10127633097","product_id":100015201,"comment_content":"老师，node1 这个节点在什么时候建的啊，我执行的时候直接<br>Error from server (NotFound): nodes &quot;node1&quot; not found","like_count":2,"discussions":[{"author":{"id":1218095,"avatar":"https://static001.geekbang.org/account/avatar/00/12/96/2f/876085fa.jpg","nickname":"张磊 Kubernetes","note":"","ucode":"16E29BDAB1F5BC","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":424686,"discussion_content":"用你自己的node名字啊","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1537706848,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":25808,"user_name":"Bain","can_delete":false,"product_type":"c1","uid":1046289,"ip_address":"","ucode":"8B1190319A60C9","user_header":"https://static001.geekbang.org/account/avatar/00/0f/f7/11/6d50e385.jpg","comment_is_top":false,"comment_ctime":1537443008,"is_pvip":false,"replies":[{"id":"9387","content":"ingress","user_name":"作者回复","user_name_real":"Geek_6ef93d","uid":"1218095","ctime":1537447516,"ip_address":"","comment_id":25808,"utype":1}],"discussion_count":1,"race_medal":1,"score":"10127377600","product_id":100015201,"comment_content":"你好，我现在遇到一个问题。部署集群的时候用的是内网IP，但是我想用公网IP访问搭好的集群里的built in services，比如heapster，但是kubectl cluster-info之后发现proxy都是的bind ip是内网IP，有没有办法改掉这个bind ip？","like_count":2,"discussions":[{"author":{"id":1218095,"avatar":"https://static001.geekbang.org/account/avatar/00/12/96/2f/876085fa.jpg","nickname":"张磊 Kubernetes","note":"","ucode":"16E29BDAB1F5BC","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":424422,"discussion_content":"ingress","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1537447516,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":25582,"user_name":"在路上","can_delete":false,"product_type":"c1","uid":1143372,"ip_address":"","ucode":"335960F683C23C","user_header":"https://static001.geekbang.org/account/avatar/00/11/72/4c/4d636a23.jpg","comment_is_top":false,"comment_ctime":1537368331,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"10127302923","product_id":100015201,"comment_content":"root@ubuntu-vitualbox:~# kubeadm init --config kubeadm.yaml --ignore-preflight-errors &#39;Swap&#39;<br>[init] using Kubernetes version: v1.11.3<br>[preflight] running pre-flight checks<br>\t[WARNING Swap]: running with swap on is not supported. Please disable swap<br>I0919 22:29:26.503206   22490 kernel_validator.go:81] Validating kernel version<br>I0919 22:29:26.504039   22490 kernel_validator.go:96] Validating kernel config<br>[preflight&#47;images] Pulling images required for setting up a Kubernetes cluster<br>[preflight&#47;images] This might take a minute or two, depending on the speed of your internet connection<br>[preflight&#47;images] You can also perform this action in beforehand using &#39;kubeadm config images pull&#39;<br>[preflight] Some fatal errors occurred:<br>\t[ERROR ImagePull]: failed to pull image [k8s.gcr.io&#47;kube-apiserver-amd64:v1.11.3]: exit status 1<br>\t[ERROR ImagePull]: failed to pull image [k8s.gcr.io&#47;kube-controller-manager-amd64:v1.11.3]: exit status 1<br>\t[ERROR ImagePull]: failed to pull image [k8s.gcr.io&#47;kube-scheduler-amd64:v1.11.3]: exit status 1<br>\t[ERROR ImagePull]: failed to pull image [k8s.gcr.io&#47;kube-proxy-amd64:v1.11.3]: exit status 1<br>\t[ERROR ImagePull]: failed to pull image [k8s.gcr.io&#47;pause:3.1]: exit status 1<br>\t[ERROR ImagePull]: failed to pull image [k8s.gcr.io&#47;etcd-amd64:3.2.18]: exit status 1<br>\t[ERROR ImagePull]: failed to pull image [k8s.gcr.io&#47;coredns:1.1.3]: exit status 1<br>[preflight] If you know what you are doing, you can make a check non-fatal with `--ignore-preflight-errors=...`<br><br>老师，这里报的错误，要怎么解决？为什么拉取不了k8s的镜像？","like_count":2},{"had_liked":false,"id":25205,"user_name":"or0or1","can_delete":false,"product_type":"c1","uid":1218147,"ip_address":"","ucode":"E7B63C666302C8","user_header":"https://static001.geekbang.org/account/avatar/00/12/96/63/64f62020.jpg","comment_is_top":false,"comment_ctime":1537267235,"is_pvip":false,"replies":[{"id":"9173","content":"因为ingress后面会专门讲","user_name":"作者回复","user_name_real":"Geek_6ef93d","uid":"1218095","ctime":1537268095,"ip_address":"","comment_id":25205,"utype":1}],"discussion_count":1,"race_medal":0,"score":"10127201827","product_id":100015201,"comment_content":"为什么不搭建ingress？这个作为应用入口，也很重要吧？","like_count":2,"discussions":[{"author":{"id":1218095,"avatar":"https://static001.geekbang.org/account/avatar/00/12/96/2f/876085fa.jpg","nickname":"张磊 Kubernetes","note":"","ucode":"16E29BDAB1F5BC","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":424224,"discussion_content":"因为ingress后面会专门讲","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1537268095,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":24719,"user_name":"余小坝","can_delete":false,"product_type":"c1","uid":1210388,"ip_address":"","ucode":"7C1ECFB5B0E00D","user_header":"http://thirdwx.qlogo.cn/mmopen/vi_32/2CaTGljhcSJpSuc5UMrEwaBLjdnZic5vpseFicr1EnwpYzgzkzamkWQCUaZjWRt12kUVEkEBaoWiaIBiaA9YxCsaAA/132","comment_is_top":false,"comment_ctime":1537188823,"is_pvip":false,"replies":[{"id":"9144","content":"多网卡能通就行，注意端口监听的是哪个网卡","user_name":"作者回复","user_name_real":"Geek_6ef93d","uid":"1218095","ctime":1537248410,"ip_address":"","comment_id":24719,"utype":1}],"discussion_count":1,"race_medal":0,"score":"10127123415","product_id":100015201,"comment_content":"常用ansible部署kubernetes集群，感觉也挺快的。<br><br>老师，请问如果master节点的网段是：192.168.……，新的节点的网段是172.18.……，那这个节点能否加入到master的集群中啊？要如何做呢","like_count":2,"discussions":[{"author":{"id":1218095,"avatar":"https://static001.geekbang.org/account/avatar/00/12/96/2f/876085fa.jpg","nickname":"张磊 Kubernetes","note":"","ucode":"16E29BDAB1F5BC","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":424092,"discussion_content":"多网卡能通就行，注意端口监听的是哪个网卡","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1537248410,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":24694,"user_name":"undifined","can_delete":false,"product_type":"c1","uid":1068920,"ip_address":"","ucode":"449CB4CD2DC089","user_header":"https://static001.geekbang.org/account/avatar/00/10/4f/78/c3d8ecb0.jpg","comment_is_top":false,"comment_ctime":1537186446,"is_pvip":false,"replies":[{"id":"9045","content":"自己编写的运维脚本，相当复杂，必须专门团队维护","user_name":"作者回复","user_name_real":"Geek_6ef93d","uid":"1218095","ctime":1537187344,"ip_address":"","comment_id":24694,"utype":1}],"discussion_count":1,"race_medal":0,"score":"10127121038","product_id":100015201,"comment_content":"老师 像阿里云 AWS GCP 这些平台的一键部署是用什么实现的呢","like_count":2,"discussions":[{"author":{"id":1218095,"avatar":"https://static001.geekbang.org/account/avatar/00/12/96/2f/876085fa.jpg","nickname":"张磊 Kubernetes","note":"","ucode":"16E29BDAB1F5BC","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":424088,"discussion_content":"自己编写的运维脚本，相当复杂，必须专门团队维护","likes_number":1,"is_delete":false,"is_hidden":false,"ctime":1537187344,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":24647,"user_name":"风轨","can_delete":false,"product_type":"c1","uid":1185844,"ip_address":"","ucode":"7B8A5233B61EB0","user_header":"https://static001.geekbang.org/account/avatar/00/12/18/34/c082419c.jpg","comment_is_top":false,"comment_ctime":1537179701,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"10127114293","product_id":100015201,"comment_content":"最近一次部署成功kubernetes是:<br>1. VPN确保网络畅通;<br>2. 安装最新版docker;<br>3. 在设置页面勾上kubernetes功能;<br>4. 等待足够长的时间;<br>win10环境。<br><br>之前试了minikube，CoreOS都没有成功，看了今天的文章似乎知道我CoreOS部署方式为啥失败了，找时间再试试~","like_count":2},{"had_liked":false,"id":24621,"user_name":"死后的天空","can_delete":false,"product_type":"c1","uid":1045293,"ip_address":"","ucode":"1652F8C8FE12F5","user_header":"https://static001.geekbang.org/account/avatar/00/0f/f3/2d/4b7f12b6.jpg","comment_is_top":false,"comment_ctime":1537170493,"is_pvip":true,"replies":[{"id":"9053","content":"这个得手动运维了","user_name":"作者回复","user_name_real":"Geek_6ef93d","uid":"1218095","ctime":1537187685,"ip_address":"","comment_id":24621,"utype":1}],"discussion_count":1,"race_medal":0,"score":"10127105085","product_id":100015201,"comment_content":"老师最近遇到一个问题，由于我在集群中部署了不少数据库，当有大量的读写的时候宿主机的buff&#47;cache上升很快，会几倍于应用占用的内存，遇到这类情况，该怎么处理呢，Kubernetes有没有类似的缓存释放机制。","like_count":2,"discussions":[{"author":{"id":1218095,"avatar":"https://static001.geekbang.org/account/avatar/00/12/96/2f/876085fa.jpg","nickname":"张磊 Kubernetes","note":"","ucode":"16E29BDAB1F5BC","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":424063,"discussion_content":"这个得手动运维了","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1537187685,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":24612,"user_name":"gogo","can_delete":false,"product_type":"c1","uid":1003104,"ip_address":"","ucode":"E8F0F3B000020A","user_header":"https://static001.geekbang.org/account/avatar/00/0f/4e/60/0d5aa340.jpg","comment_is_top":false,"comment_ctime":1537164651,"is_pvip":false,"replies":[{"id":"9049","content":"exec进去","user_name":"作者回复","user_name_real":"Geek_6ef93d","uid":"1218095","ctime":1537187527,"ip_address":"","comment_id":24612,"utype":1}],"discussion_count":1,"race_medal":0,"score":"10127099243","product_id":100015201,"comment_content":"老师，pod挂载rook ceph存储之后，要怎么查看挂载的内容呢","like_count":2,"discussions":[{"author":{"id":1218095,"avatar":"https://static001.geekbang.org/account/avatar/00/12/96/2f/876085fa.jpg","nickname":"张磊 Kubernetes","note":"","ucode":"16E29BDAB1F5BC","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":424057,"discussion_content":"exec进去","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1537187527,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":24581,"user_name":"虎虎❤️","can_delete":false,"product_type":"c1","uid":1086535,"ip_address":"","ucode":"157F261E80291A","user_header":"https://static001.geekbang.org/account/avatar/00/10/94/47/75875257.jpg","comment_is_top":false,"comment_ctime":1537153555,"is_pvip":false,"replies":[{"id":"9051","content":"1.对 2.存储的时候讲","user_name":"作者回复","user_name_real":"Geek_6ef93d","uid":"1218095","ctime":1537187611,"ip_address":"","comment_id":24581,"utype":1}],"discussion_count":1,"race_medal":0,"score":"10127088147","product_id":100015201,"comment_content":"我们用bosh部署的CFCR，配置文件写好之后，也能做到一键部署。<br><br>我有几个问题<br>1. 用rook部署ceph cluster，数据的路径只能选择在node上的dataDirHostPath吗？如果我想有几台专用的storage server，组成cluster应该怎么做？我能想到的是把这几台server加入k8s cluster，然后用label&#47;node affinity 把ceph pod调度到这几个专用节点？<br>2. 我看到NFS cluster的 exports.persistentVolumeClaim 参数可以是any pvc allowed。但是我看了一下nfs的controller是创建了一个sts。如果使用的pvc是不支持readwritemany，比如host path 或者我正在用的vsphere storage。那么sts的replica设置成大于1的话，可能会创建不成功吧，除非pod都调度到同一个node上。<br>","like_count":2,"discussions":[{"author":{"id":1218095,"avatar":"https://static001.geekbang.org/account/avatar/00/12/96/2f/876085fa.jpg","nickname":"张磊 Kubernetes","note":"","ucode":"16E29BDAB1F5BC","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":424044,"discussion_content":"1.对 2.存储的时候讲","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1537187611,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":24572,"user_name":"gogo","can_delete":false,"product_type":"c1","uid":1003104,"ip_address":"","ucode":"E8F0F3B000020A","user_header":"https://static001.geekbang.org/account/avatar/00/0f/4e/60/0d5aa340.jpg","comment_is_top":false,"comment_ctime":1537147959,"is_pvip":false,"replies":[{"id":"8986","content":"是的","user_name":"作者回复","user_name_real":"Geek_6ef93d","uid":"1218095","ctime":1537152168,"ip_address":"","comment_id":24572,"utype":1}],"discussion_count":1,"race_medal":0,"score":"10127082551","product_id":100015201,"comment_content":"老师您好， 请教一下，springboot项目避暑在k8s中 项目的日志要怎么处理呢 要使用pv吗","like_count":2,"discussions":[{"author":{"id":1218095,"avatar":"https://static001.geekbang.org/account/avatar/00/12/96/2f/876085fa.jpg","nickname":"张磊 Kubernetes","note":"","ucode":"16E29BDAB1F5BC","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":424040,"discussion_content":"是的","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1537152168,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":24567,"user_name":"Vincen","can_delete":false,"product_type":"c1","uid":1218185,"ip_address":"","ucode":"1029A901EC7BA0","user_header":"https://static001.geekbang.org/account/avatar/00/12/96/89/9312b3a2.jpg","comment_is_top":false,"comment_ctime":1537145690,"is_pvip":false,"replies":[{"id":"8987","content":"跟etcd没关系，master也高可用啊","user_name":"作者回复","user_name_real":"Geek_6ef93d","uid":"1218095","ctime":1537152196,"ip_address":"","comment_id":24567,"utype":1}],"discussion_count":1,"race_medal":0,"score":"10127080282","product_id":100015201,"comment_content":"为什么前一篇文章说kubeadm不能用于生产环境？ 如果将etcd集群单独部署呢？","like_count":2,"discussions":[{"author":{"id":1218095,"avatar":"https://static001.geekbang.org/account/avatar/00/12/96/2f/876085fa.jpg","nickname":"张磊 Kubernetes","note":"","ucode":"16E29BDAB1F5BC","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":424038,"discussion_content":"跟etcd没关系，master也高可用啊","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1537152196,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":24553,"user_name":"Jim","can_delete":false,"product_type":"c1","uid":1111338,"ip_address":"","ucode":"3EE973F31656B0","user_header":"https://static001.geekbang.org/account/avatar/00/10/f5/2a/74d1da42.jpg","comment_is_top":false,"comment_ctime":1537142649,"is_pvip":false,"replies":[{"id":"8989","content":"都是些yaml文件，命令行执行即可","user_name":"作者回复","user_name_real":"Geek_6ef93d","uid":"1218095","ctime":1537152294,"ip_address":"","comment_id":24553,"utype":1}],"discussion_count":1,"race_medal":0,"score":"10127077241","product_id":100015201,"comment_content":"存储插件是在单独一台机器上安装吗？那两个命令是否也应该支持分布式？存储设备都隐藏了，如何指定呢？<br><br>网络插件应该只在Master上安装吧？","like_count":2,"discussions":[{"author":{"id":1218095,"avatar":"https://static001.geekbang.org/account/avatar/00/12/96/2f/876085fa.jpg","nickname":"张磊 Kubernetes","note":"","ucode":"16E29BDAB1F5BC","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":424033,"discussion_content":"都是些yaml文件，命令行执行即可","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1537152294,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":24539,"user_name":"咕噜男爵-Tony","can_delete":false,"product_type":"c1","uid":1219258,"ip_address":"","ucode":"8C841851AC767F","user_header":"https://static001.geekbang.org/account/avatar/00/12/9a/ba/f5eb2a66.jpg","comment_is_top":false,"comment_ctime":1537113990,"is_pvip":false,"replies":[{"id":"8992","content":"5000","user_name":"作者回复","user_name_real":"Geek_6ef93d","uid":"1218095","ctime":1537152414,"ip_address":"","comment_id":24539,"utype":1}],"discussion_count":1,"race_medal":0,"score":"10127048582","product_id":100015201,"comment_content":"目前生产二十多个节点，k8s能有效管理的节点还没注意到这个知识点。开始接触容器用的比较多的是rancher ，使用rancher 自己的编排工具cattle ，用着还不错。确如老师所讲rancher 确实把很多细节都封装了。","like_count":2,"discussions":[{"author":{"id":1218095,"avatar":"https://static001.geekbang.org/account/avatar/00/12/96/2f/876085fa.jpg","nickname":"张磊 Kubernetes","note":"","ucode":"16E29BDAB1F5BC","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":424025,"discussion_content":"5000","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1537152414,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":340410,"user_name":"Pinkman","can_delete":false,"product_type":"c1","uid":2608602,"ip_address":"","ucode":"B2207261E57A84","user_header":"https://static001.geekbang.org/account/avatar/00/27/cd/da/cee971b2.jpg","comment_is_top":false,"comment_ctime":1648802819,"is_pvip":false,"discussion_count":1,"race_medal":0,"score":"5943770115","product_id":100015201,"comment_content":"kubectl apply -f https:&#47;&#47;raw.githubusercontent.com&#47;rook&#47;rook&#47;release-1.7&#47;cluster&#47;examples&#47;kubernetes&#47;ceph&#47;common.yaml<br>kubectl apply -f https:&#47;&#47;raw.githubusercontent.com&#47;rook&#47;rook&#47;release-1.7&#47;cluster&#47;examples&#47;kubernetes&#47;ceph&#47;operator.yaml<br>kubectl apply -f https:&#47;&#47;raw.githubusercontent.com&#47;rook&#47;rook&#47;release-1.7&#47;cluster&#47;examples&#47;kubernetes&#47;ceph&#47;crds.yaml<br>kubectl apply -f https:&#47;&#47;raw.githubusercontent.com&#47;rook&#47;rook&#47;release-1.7&#47;cluster&#47;examples&#47;kubernetes&#47;ceph&#47;cluster.yaml","like_count":2,"discussions":[{"author":{"id":1073156,"avatar":"http://thirdwx.qlogo.cn/mmopen/vi_32/DYAIOgq83eqibj1G9GJGMXkNAia83ESAqbCTgcIA5UyqUJN27yvXhAgpIeL9UyEkwY1jwsQlnqcv4iasoLdZkBbeA/132","nickname":"ss","note":"","ucode":"C1926C165FB8C5","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":574023,"discussion_content":"非常感谢！","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1653797863,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":332359,"user_name":"NulI","can_delete":false,"product_type":"c1","uid":1491276,"ip_address":"","ucode":"BF8C3B18FE2D2A","user_header":"https://static001.geekbang.org/account/avatar/00/16/c1/4c/e72d3360.jpg","comment_is_top":false,"comment_ctime":1643185813,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"5938153109","product_id":100015201,"comment_content":"给大家推荐一个一键部署k8s集群的工具，可以部署包括最新的各种k8s版本，支持集群和单机，还有web界面安装  https:&#47;&#47;github.com&#47;cloudnativer&#47;kube-install&#47;blob&#47;master&#47;README0.8-zh.md","like_count":1},{"had_liked":false,"id":330298,"user_name":"lliill","can_delete":false,"product_type":"c1","uid":1179412,"ip_address":"","ucode":"E01B1377D3EE57","user_header":"https://static001.geekbang.org/account/avatar/00/11/ff/14/4d5dfbfb.jpg","comment_is_top":false,"comment_ctime":1641897020,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"5936864316","product_id":100015201,"comment_content":"2022-01-11<br><br>安装 kubeadm<br><br>更新 `apt` 包索引并安装使用 Kubernetes `apt` 仓库所需要的包：<br><br>```shell<br>sudo apt-get update<br>sudo apt-get install -y apt-transport-https ca-certificates curl<br>```<br><br>下载 阿里云 公开签名秘钥：<br><br>```shell<br>sudo curl -fsSLo &#47;usr&#47;share&#47;keyrings&#47;kubernetes-archive-keyring.gpg https:&#47;&#47;mirrors.aliyun.com&#47;kubernetes&#47;apt&#47;doc&#47;apt-key.gpg<br>```<br><br>添加 Kubernetes `apt` 仓库：<br><br>```shell<br>echo &quot;deb [signed-by=&#47;usr&#47;share&#47;keyrings&#47;kubernetes-archive-keyring.gpg] https:&#47;&#47;mirrors.aliyun.com&#47;kubernetes&#47;apt&#47; kubernetes-xenial main&quot; | sudo tee &#47;etc&#47;apt&#47;sources.list.d&#47;kubernetes.list<br>```<br><br>更新 `apt` 包索引，安装 kubelet、kubeadm 和 kubectl，并锁定其版本：<br><br>```shell<br>sudo apt-get update<br>sudo apt-get install -y kubelet kubeadm kubectl<br>sudo apt-mark hold kubelet kubeadm kubectl<br>```<br><br>```<br># 下载成功版本号<br>Setting up kubectl (1.23.1-00) ...<br>Setting up kubelet (1.23.1-00) ...<br>Setting up kubeadm (1.23.1-00) ...<br>```<br><br>在上述安装 kubeadm 的过程中，kubeadm 和 kubelet、kubectl、kubernetes-cni 这几个二进制文件都会被自动安装好。","like_count":1},{"had_liked":false,"id":328107,"user_name":"fomy","can_delete":false,"product_type":"c1","uid":1125834,"ip_address":"","ucode":"CD87EA03B1F327","user_header":"https://static001.geekbang.org/account/avatar/00/11/2d/ca/02b0e397.jpg","comment_is_top":false,"comment_ctime":1640532527,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"5935499823","product_id":100015201,"comment_content":"2021-12-26  k8s已经更新到 v1.23.1，踩了很多坑。花了2天时间，终于实现了在虚拟机上部署一个集群了。为了避免大家重复踩坑，我也整理到我的博客了：https:&#47;&#47;blog.csdn.net&#47;fomeiherz&#47;article&#47;details&#47;122154738<br>","like_count":1},{"had_liked":false,"id":325806,"user_name":"糖炒栗子","can_delete":false,"product_type":"c1","uid":2864768,"ip_address":"","ucode":"6A59DDE825E266","user_header":"https://static001.geekbang.org/account/avatar/00/2b/b6/80/2327060c.jpg","comment_is_top":false,"comment_ctime":1639142745,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"5934110041","product_id":100015201,"comment_content":"阿里云三个ecs实例上做的实验. 感谢评论区各位大佬的指点! 写了篇博客记录<br>https:&#47;&#47;blog.csdn.net&#47;csdn_tclz&#47;article&#47;details&#47;121864572","like_count":1},{"had_liked":false,"id":318131,"user_name":"胡小涵","can_delete":false,"product_type":"c1","uid":2004538,"ip_address":"","ucode":"2E750C65EC282C","user_header":"https://static001.geekbang.org/account/avatar/00/1e/96/3a/e06f8367.jpg","comment_is_top":false,"comment_ctime":1635158907,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"5930126203","product_id":100015201,"comment_content":"centos 7.x 的同学可以看过来，<br>如果用yum install -y kubelet kubeadm kubectl安装默认版本的，老师给的kubeadm.yaml肯定是用不了的。<br><br>这时候kubeadm config print init-defaults看下这个版本支持的字段该怎么写，<br>主要是：apiVersion，kind，kubernetesVersion，另外带extraArgs字段全都需要调整。<br><br>下面附上可以成功启动的kubeadm.yaml：<br>apiVersion: kubeadm.k8s.io&#47;v1beta3<br>kind: InitConfiguration<br>localAPIEndpoint:<br>  advertiseAddress: 0.0.0.0<br>  bindPort: 6443<br>nodeRegistration:<br>  criSocket: &#47;var&#47;run&#47;dockershim.sock<br>  imagePullPolicy: IfNotPresent<br>  name: node<br>  taints: null<br>---<br>apiVersion: kubeadm.k8s.io&#47;v1beta3<br>clusterName: kubernetes01<br>kind: ClusterConfiguration<br>controllerManager:<br>  extraArgs:<br>    horizontal-pod-autoscaler-use-rest-clients: &quot;true&quot;<br>    horizontal-pod-autoscaler-sync-period: &quot;10s&quot;<br>    node-monitor-grace-period: &quot;10s&quot;<br>apiServer:<br>  extraArgs:<br>    runtime-config: &quot;api&#47;all=true&quot;<br>imageRepository: registry.aliyuncs.com&#47;google_containers<br>kubernetesVersion: v1.22.0<br>======================<br>老师可能平时比较忙，不怎么维护，所以建议一下助教，文中的安装命令没有指定版本，如果不指定版本，后面的命令很多是用不了的或者和文中不一致的，学员花了很长时间才自己弄出来，我觉得这种用户体验不是很好。希望文中的命令是与时俱进的，或者写死要用1.11，不过说实话，现在公司要用k8s，再去用1.11不太现实，希望相关内容尽量与时俱进。<br>","like_count":1},{"had_liked":false,"id":317942,"user_name":"2014bduck","can_delete":false,"product_type":"c1","uid":1444202,"ip_address":"","ucode":"763159B1B4DEA8","user_header":"https://static001.geekbang.org/account/avatar/00/16/09/6a/1f2ef718.jpg","comment_is_top":false,"comment_ctime":1635066358,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"5930033654","product_id":100015201,"comment_content":"https:&#47;&#47;rook.github.io&#47;docs&#47;rook&#47;latest&#47;pre-reqs.html#ceph-prerequisites<br><br>这里ceph的硬件要求说得很清楚...很好奇没有达到硬件要求的同学真的能跑起来吗..？还是只是看到命令执行之后没错就直接跳过了<br><br>这里在不达标的机器上执行之后会缺少很多pod没有运行。。应该是失败了<br><br><br>root@iZj6c4av1f9xlo01lri9d1Z:~&#47;rook&#47;cluster&#47;examples&#47;kubernetes&#47;ceph# kubectl get pods -n rook-ceph<br>NAME                                           READY   STATUS            RESTARTS   AGE<br>csi-cephfsplugin-j7n82                         3&#47;3     Running           0          12s<br>csi-cephfsplugin-provisioner-689686b44-cjs44   0&#47;6     Pending           0          12s<br>csi-cephfsplugin-provisioner-689686b44-xlw5r   6&#47;6     Running           0          12s<br>csi-rbdplugin-provisioner-5775fb866b-jtb7g     0&#47;6     Pending           0          12s<br>csi-rbdplugin-provisioner-5775fb866b-wgj2f     6&#47;6     Running           0          12s<br>csi-rbdplugin-wj54m                            3&#47;3     Running           0          12s<br>rook-ceph-detect-version--1-7v9z9              0&#47;1     PodInitializing   0          14s<br>rook-ceph-operator-76dc868c4b-4nskq            1&#47;1     Running           0          2m8s","like_count":1},{"had_liked":false,"id":304185,"user_name":"小鱼儿","can_delete":false,"product_type":"c1","uid":1977516,"ip_address":"","ucode":"30EB95B7844556","user_header":"https://static001.geekbang.org/account/avatar/00/1e/2c/ac/247288f5.jpg","comment_is_top":false,"comment_ctime":1627288988,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"5922256284","product_id":100015201,"comment_content":"kubeadm.yml使用的是：<br><br>apiVersion: kubeadm.k8s.io&#47;v1alpha2<br>kind: MasterConfiguration<br>controllerManagerExtraArgs:<br>  horizontal-pod-autoscaler-use-rest-clients: &quot;true&quot;<br>  horizontal-pod-autoscaler-sync-period: &quot;10s&quot;<br>  node-monitor-grace-period: &quot;10s&quot;<br>apiServerExtraArgs:<br>  runtime-config: &quot;api&#47;all=true&quot;<br>kubernetesVersion: &quot;stable-1.12&quot;<br><br>kubeadm init --config kubeadm.yaml 报错：<br>FileContent--proc-sys-net-ipv4-ip_forward]: &#47;proc&#47;sys&#47;net&#47;ipv4&#47;ip_forward contents are not set to 1<br><br>解决办法：sysctl -w net.ipv4.ip_forward=1<br>后面此kubeadm init --config kubeadm.yaml 运行成功","like_count":1},{"had_liked":false,"id":301174,"user_name":"znz","can_delete":false,"product_type":"c1","uid":2545284,"ip_address":"","ucode":"C8F83E70BD0A2B","user_header":"https://static001.geekbang.org/account/avatar/00/26/d6/84/e7750e4b.jpg","comment_is_top":false,"comment_ctime":1625563103,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"5920530399","product_id":100015201,"comment_content":"本地 AMC 上已安装成功 分享一下安装方式：<br>https:&#47;&#47;developer.aliyun.com&#47;article&#47;221687","like_count":1},{"had_liked":false,"id":301075,"user_name":"周靖峰","can_delete":false,"product_type":"c1","uid":1830939,"ip_address":"","ucode":"997B9776F923F3","user_header":"http://thirdwx.qlogo.cn/mmopen/vi_32/DYAIOgq83eriaoouNOT0uLbN3fondbSTTfWjDJibVuFubGWDvzsgCtYmBpaTwvRMQbS0uXoIsUz6aPf7I1S75Rkg/132","comment_is_top":false,"comment_ctime":1625529518,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"5920496814","product_id":100015201,"comment_content":"为什么存储要使用复杂的Rook，而不是使用简单的nfs呢？害得我Rook压根装不好，实验也进行不下去，学习的兴趣完全没了","like_count":1},{"had_liked":false,"id":278717,"user_name":"弗拉基米尔·伊里奇·乌里扬诺夫","can_delete":false,"product_type":"c1","uid":2394694,"ip_address":"","ucode":"9C6725A91BC06C","user_header":"https://static001.geekbang.org/account/avatar/00/24/8a/46/a75684ea.jpg","comment_is_top":false,"comment_ctime":1613224643,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"5908191939","product_id":100015201,"comment_content":"https:&#47;&#47;rook.github.io&#47;docs&#47;rook&#47;master&#47;ceph-quickstart.html<br><br><br>kubernetes v1.11.10-00 ubuntu<br><br>If you are using kubernetes v1.15 or older you need to create CRDs found here &#47;cluster&#47;examples&#47;kubernetes&#47;ceph&#47;pre-k8s-1.16&#47;crd.yaml. The apiextension v1beta1 version of<br><br>需要先执行 `kubectl apply -f &#47;cluster&#47;examples&#47;kubernetes&#47;ceph&#47;pre-k8s-1.16&#47;crd.yaml` ，然后再执行后续的 yaml 文件","like_count":1},{"had_liked":false,"id":278293,"user_name":"stefen","can_delete":false,"product_type":"c1","uid":1202047,"ip_address":"","ucode":"7C9AAE829E7802","user_header":"http://thirdwx.qlogo.cn/mmopen/vi_32/oib0a89lqtOhJL1UvfUp4uTsRLrDbhoGk9jLiciazxMu0COibJsFCZDypK1ZFcHEJc9d9qgbjvgR41ImL6FNPoVlWA/132","comment_is_top":false,"comment_ctime":1612859518,"is_pvip":false,"discussion_count":1,"race_medal":1,"score":"5907826814","product_id":100015201,"comment_content":"worker节点执行kubeadm join 后报错 不能连上master节点，也执行了systemctl stop firewalld<br>I0209 16:22:40.105282   23069 token.go:83] [discovery] Failed to request cluster info, will try again: [Get https:&#47;&#47;10.0.2.15:6443&#47;api&#47;v1&#47;namespaces&#47;kube-public&#47;configmaps&#47;cluster-info: dial tcp 10.0.2.15:6443: connect: connection refused]<br>I0209 16:22:45.105291   23069 token.go:83] [discovery] Failed to request cluster info, will try again: [Get https:&#47;&#47;10.0.2.15:6443&#47;api&#47;v1&#47;namespaces&#47;kube-public&#47;configmaps&#47;cluster-info: dial tcp 10.0.2.15:6443: connect: connection refused]<br>I0209 16:22:50.085993   23069 token.go:83] [discovery] Failed to request cluster info, will try again: [Get https:&#47;&#47;10.0.2.15:6443&#47;api&#47;v1&#47;namespaces&#47;kube-public&#47;configmaps&#47;cluster-info: dial tcp 10.0.2.15:6443: connect: connection refused]<br>","like_count":1,"discussions":[{"author":{"id":1251835,"avatar":"http://thirdwx.qlogo.cn/mmopen/vi_32/oiboHpgukqib2ASXeU0H7W1ibgRMqyrNE5KaWicicPEDy0ia8YdoneZAtvW0EFIiaqZJp2OS4dnweOgXaJ5EjJicicEqic5A/132","nickname":"覃钰栋","note":"","ucode":"19080C463658EF","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":414495,"discussion_content":"遇上同样的问题，请问解决了么","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1636790580,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":275500,"user_name":"Geek_neo","can_delete":false,"product_type":"c1","uid":1568248,"ip_address":"","ucode":"147211A6624E01","user_header":"https://static001.geekbang.org/account/avatar/00/17/ed/f8/3a7499f9.jpg","comment_is_top":false,"comment_ctime":1611563721,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"5906531017","product_id":100015201,"comment_content":"# 用中科大源安装kubernetes，提示GPG error<br>W: GPG error: http:&#47;&#47;mirrors.ustc.edu.cn&#47;kubernetes&#47;apt kubernetes-xenial InRelease: The following signatures couldn&#39;t be verified because the public key is not available: NO_PUBKEY 6A030B21BA07F4FB NO_PUBKEY 8B57C5C2836F4BEB<br>E: The repository &#39;http:&#47;&#47;mirrors.ustc.edu.cn&#47;kubernetes&#47;apt kubernetes-xenial InRelease&#39; is not signed.<br># 添加数字签名后，再执行安装<br>$ sudo apt-key adv --keyserver keyserver.ubuntu.com --recv-keys 6A030B21BA07F4FB<br>$ sudo apt-key adv --keyserver keyserver.ubuntu.com --recv-keys 8B57C5C2836F4BEB","like_count":1},{"had_liked":false,"id":249614,"user_name":"aoe","can_delete":false,"product_type":"c1","uid":1121758,"ip_address":"","ucode":"1C6201EDB4E954","user_header":"https://static001.geekbang.org/account/avatar/00/11/1d/de/62bfa83f.jpg","comment_is_top":false,"comment_ctime":1600707055,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"5895674351","product_id":100015201,"comment_content":"经过多次失败，发现一个好用的命令：kubeadm 重置<br>$ kubeadm reset<br>https:&#47;&#47;k8smeetup.github.io&#47;docs&#47;reference&#47;setup-tools&#47;kubeadm&#47;kubeadm-reset&#47;<br><br>我的版本<br>$ kubectl version<br><br>Client Version: version.Info{Major:&quot;1&quot;, Minor:&quot;19&quot;, GitVersion:&quot;v1.19.1&quot;, GitCommit:&quot;206bcadf021e76c27513500ca24182692aabd17e&quot;, GitTreeState:&quot;clean&quot;, BuildDate:&quot;2020-09-09T11:26:42Z&quot;, GoVersion:&quot;go1.15&quot;, Compiler:&quot;gc&quot;, Platform:&quot;linux&#47;amd64&quot;}","like_count":1},{"had_liked":false,"id":211125,"user_name":"正直的葡萄","can_delete":false,"product_type":"c1","uid":1888609,"ip_address":"","ucode":"21DE94A017D1D7","user_header":"https://static001.geekbang.org/account/avatar/00/1c/d1/61/a4f210a3.jpg","comment_is_top":false,"comment_ctime":1587898612,"is_pvip":false,"discussion_count":3,"race_medal":0,"score":"5882865908","product_id":100015201,"comment_content":"解决 [ERROR ImagePull]: failed to pull image 的方法：<br>在 kubeadm.yaml 中加上 imageRepository 字段，使用阿里的源<br><br>apiVersion: kubeadm.k8s.io&#47;v1beta2<br>kind: ClusterConfiguration<br>controllerManager:<br>    extraArgs:<br>        horizontal-pod-autoscaler-use-rest-clients: &quot;true&quot;<br>        horizontal-pod-autoscaler-sync-period: &quot;10s&quot;<br>        node-monitor-grace-period: &quot;10s&quot;<br>apiServer:<br>    extraArgs:<br>        runtime-config: &quot;api&#47;all=true&quot;<br>imageRepository: registry.cn-hangzhou.aliyuncs.com&#47;google_containers<br>kubernetesVersion: &quot;v1.17.3&quot;<br><br>然后执行 kubeadm init --config kubeadm.yaml<br>","like_count":1,"discussions":[{"author":{"id":2001638,"avatar":"https://static001.geekbang.org/account/avatar/00/1e/8a/e6/007da70b.jpg","nickname":"贝壳","note":"","ucode":"920D8BB636269A","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":267875,"discussion_content":"还是报错了","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1589703503,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":2001638,"avatar":"https://static001.geekbang.org/account/avatar/00/1e/8a/e6/007da70b.jpg","nickname":"贝壳","note":"","ucode":"920D8BB636269A","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":267874,"discussion_content":"[ERROR ImagePull]: failed to pull image registry.cn-hangzhou.aliyuncs.com/google_containers/etcd:3.4.3-0: output: Error response from daemon: Get https://registry.cn-hangzhou.aliyuncs.com/v2/: proxyconnect tcp: dial tcp: address [proxy-addr]:[proxy-port]:443: too many colons in address\n, error: exit status ","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1589703484,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1361556,"avatar":"https://static001.geekbang.org/account/avatar/00/14/c6/94/48ca3281.jpg","nickname":"奔跑","note":"","ucode":"A64A0DCA50D9FA","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":259847,"discussion_content":"咱这专栏有群吗？找不到组织啊","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1588824475,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":199628,"user_name":"余向华","can_delete":false,"product_type":"c1","uid":1119778,"ip_address":"","ucode":"263773616D2C83","user_header":"https://static001.geekbang.org/account/avatar/00/11/16/22/2205cf0a.jpg","comment_is_top":false,"comment_ctime":1585492781,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"5880460077","product_id":100015201,"comment_content":"https:&#47;&#47;www.kubernetes.org.cn&#47;5462.html<br>可以参考这个","like_count":1},{"had_liked":false,"id":198397,"user_name":"瑞文","can_delete":false,"product_type":"c1","uid":1335519,"ip_address":"","ucode":"CD79DC8C04ED16","user_header":"https://static001.geekbang.org/account/avatar/00/14/60/df/57ad85c0.jpg","comment_is_top":false,"comment_ctime":1585449554,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"5880416850","product_id":100015201,"comment_content":"源可以换一下，避免在无法科学上网的情况下装不了。<br>deb https:&#47;&#47;mirrors.aliyun.com&#47;kubernetes&#47;apt&#47; kubernetes-xenial main<br>","like_count":1},{"had_liked":false,"id":196534,"user_name":"nullptr","can_delete":false,"product_type":"c1","uid":1283847,"ip_address":"","ucode":"D309EABB70F0BF","user_header":"https://static001.geekbang.org/account/avatar/00/13/97/07/7406fe30.jpg","comment_is_top":false,"comment_ctime":1585290711,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"5880258007","product_id":100015201,"comment_content":"一键安装真香，分享给和我一样一看就会，一配就废的小伙伴<br>https:&#47;&#47;www.kubernetes.org.cn&#47;5846.html","like_count":1},{"had_liked":false,"id":194039,"user_name":"叶志平","can_delete":false,"product_type":"c1","uid":1908672,"ip_address":"","ucode":"BFC9311CB38969","user_header":"","comment_is_top":false,"comment_ctime":1585017437,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"5879984733","product_id":100015201,"comment_content":"检测到“cgroupfs”作为Docker cgroup驱动程序。 推荐的驱动程序是“systemd”，<br>这个驱动以docker为准还是以k8s的为准","like_count":1},{"had_liked":false,"id":185088,"user_name":"Shuttle","can_delete":false,"product_type":"c1","uid":1118235,"ip_address":"","ucode":"3837AA626997B8","user_header":"https://static001.geekbang.org/account/avatar/00/11/10/1b/d17ea26b.jpg","comment_is_top":false,"comment_ctime":1583480281,"is_pvip":false,"replies":[{"id":"72834","content":"前面证书生成的步骤是不是有问题了？","user_name":"作者回复","user_name_real":"Geek_6ef93d","uid":"1218095","ctime":1584423195,"ip_address":"","comment_id":185088,"utype":1}],"discussion_count":1,"race_medal":0,"score":"5878447577","product_id":100015201,"comment_content":"老师，你好<br>我node节点join的时候提示forbidden呢？版本都是一样的<br>CGROUPS_MEMORY: enabled<br>\t[WARNING SystemVerification]: unsupported docker version: 18.09.9<br>[discovery] Trying to connect to API Server &quot;10.1.126.33:6443&quot;<br>[discovery] Created cluster-info discovery client, requesting info from &quot;https:&#47;&#47;10.1.126.33:6443&quot;<br>[discovery] Requesting info from &quot;https:&#47;&#47;10.1.126.33:6443&quot; again to validate TLS against the pinned public key<br>[discovery] Cluster info signature and contents are valid and TLS certificate validates against pinned roots, will use API Server &quot;10.1.126.33:6443&quot;<br>[discovery] Successfully established connection with API Server &quot;10.1.126.33:6443&quot;<br>[kubelet] Downloading configuration for the kubelet from the &quot;kubelet-config-1.11&quot; ConfigMap in the kube-system namespace<br>configmaps &quot;kubelet-config-1.11&quot; is forbidden: User &quot;system:bootstrap:lu5nla&quot; cannot get resource &quot;configmaps&quot; in API group &quot;&quot; in the namespace &quot;kube-system&quot;<br><br><br>","like_count":1,"discussions":[{"author":{"id":1218095,"avatar":"https://static001.geekbang.org/account/avatar/00/12/96/2f/876085fa.jpg","nickname":"张磊 Kubernetes","note":"","ucode":"16E29BDAB1F5BC","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":486247,"discussion_content":"前面证书生成的步骤是不是有问题了？","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1584423195,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":173587,"user_name":"崔建星","can_delete":false,"product_type":"c1","uid":1136126,"ip_address":"","ucode":"57FB577C8CA938","user_header":"https://static001.geekbang.org/account/avatar/00/11/55/fe/66d6b8cd.jpg","comment_is_top":false,"comment_ctime":1579602161,"is_pvip":false,"discussion_count":1,"race_medal":0,"score":"5874569457","product_id":100015201,"comment_content":"为什么我按照上面的步骤安装完成后worker node的状态还是NotReady，通过describe查看节点信息提示：runtime network not ready: NetworkReady=false reason:NetworkPluginNotReady message:docker: network plugin is not ready: cni config uninitialized。我在这个worker node上面apply weave plugin提示已经configured。这是怎么回事？","like_count":1,"discussions":[{"author":{"id":1281460,"avatar":"https://static001.geekbang.org/account/avatar/00/13/8d/b4/ff82483d.jpg","nickname":"邵俊达","note":"","ucode":"4B7DACE6DBCF95","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":531413,"discussion_content":"我也遇到了类似的问题，请问你解决了么？","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1637306891,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"user_type\":1}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":170963,"user_name":"AliFYB","can_delete":false,"product_type":"c1","uid":1521904,"ip_address":"","ucode":"F988FCDBE30957","user_header":"","comment_is_top":false,"comment_ctime":1578801875,"is_pvip":true,"discussion_count":0,"race_medal":0,"score":"5873769171","product_id":100015201,"comment_content":"使用高版本k8s 经常会出现描述字段不匹配的问题，如：<br>unable to recognize no matches for kind &quot;DaemonSet&quot; in version &quot;extensions&#47;v1beta1&quot;。<br>安装网络插件命令建议改为：<br>kubectl apply -f &quot;https:&#47;&#47;cloud.weave.works&#47;k8s&#47;net?k8s-version=$(kubectl version | base64 | tr -d &#39;\\n&#39;)&quot;","like_count":1},{"had_liked":false,"id":135906,"user_name":"expert-link","can_delete":false,"product_type":"c1","uid":1116883,"ip_address":"","ucode":"4B8E53DF0B1A36","user_header":"https://static001.geekbang.org/account/avatar/00/11/0a/d3/291b48c8.jpg","comment_is_top":false,"comment_ctime":1569297002,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"5864264298","product_id":100015201,"comment_content":"v1.16.0已经没有这个配置了，是被其它的替换掉了吗？<br>horizontal-pod-autoscaler-use-rest-clients: &quot;true&quot;<br>https:&#47;&#47;kubernetes.io&#47;docs&#47;reference&#47;command-line-tools-reference&#47;kube-controller-manager&#47;","like_count":1},{"had_liked":false,"id":101109,"user_name":"鹅鹅鹅","can_delete":false,"product_type":"c1","uid":1487050,"ip_address":"","ucode":"2820B6C86C0423","user_header":"https://static001.geekbang.org/account/avatar/00/16/b0/ca/599d3907.jpg","comment_is_top":false,"comment_ctime":1559719344,"is_pvip":false,"discussion_count":2,"race_medal":0,"score":"5854686640","product_id":100015201,"comment_content":"老师你好，我执行kubeadm init ... 之后，并且apply了weave 1.6，但是coredns并没有ready,只是running,我查看了pod的events,其中报错信息是 :<br>Warning  Unhealthy         5m29s (x10 over 7m39s)  kubelet, zya-virtualbox  Readiness probe failed: HTTP probe failed with statuscode: 503<br>请问是什么原因啊，环境是k8s 1.14.2<br>","like_count":1,"discussions":[{"author":{"id":1134895,"avatar":"https://static001.geekbang.org/account/avatar/00/11/51/2f/7b04140c.jpg","nickname":"孫やさん","note":"","ucode":"C60877C1C71685","race_medal":0,"user_type":1,"is_pvip":true},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":78406,"discussion_content":"我也是这个问题，希望老师帮忙看看，多谢了","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1575989232,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":1,"child_discussions":[{"author":{"id":1487050,"avatar":"https://static001.geekbang.org/account/avatar/00/16/b0/ca/599d3907.jpg","nickname":"鹅鹅鹅","note":"","ucode":"2820B6C86C0423","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":1134895,"avatar":"https://static001.geekbang.org/account/avatar/00/11/51/2f/7b04140c.jpg","nickname":"孫やさん","note":"","ucode":"C60877C1C71685","race_medal":0,"user_type":1,"is_pvip":true},"discussion":{"id":82858,"discussion_content":"这个是因为master节点还不能部署pod，执行一下命令，删除master节点的污点就行了","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1576392080,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":78406,"ip_address":""},"score":82858,"extra":""}]}]},{"had_liked":false,"id":94139,"user_name":"Geek_d65d45","can_delete":false,"product_type":"c1","uid":1523885,"ip_address":"","ucode":"41FDCD7B3B6C7A","user_header":"http://thirdwx.qlogo.cn/mmopen/vi_32/zFOVquVttt7aTLtyHhPvH0J4q9uOGgsDQ4p6CbDiaZvn9NcYAuTEjOswnMlvibHmIH2doJx1IF9jlld6NxeYLiakw/132","comment_is_top":false,"comment_ctime":1557729913,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"5852697209","product_id":100015201,"comment_content":"我在部署dashboard和rook的时候都遇到了问题，<br>dashboard最后使用了<br>kubectl apply -f https:&#47;&#47;raw.githubusercontent.com&#47;kubernetes&#47;dashboard&#47;v1.10.1&#47;src&#47;deploy&#47;recommended&#47;kubernetes-dashboard.yaml<br><br>rook去<br>https:&#47;&#47;github.com&#47;rook&#47;rook&#47;tree&#47;release-1.0&#47;cluster&#47;examples&#47;kubernetes&#47;ceph<br>clone了代码后去对应目录执行了<br>kubectl create -f common.yaml<br>kubectl create -f operator.yaml<br>kubectl create -f cluster.yaml<br><br>最后部署成功，希望对大家有帮助","like_count":1},{"had_liked":false,"id":93710,"user_name":"logic","can_delete":false,"product_type":"c1","uid":1018357,"ip_address":"","ucode":"ECCD036742A245","user_header":"https://static001.geekbang.org/account/avatar/00/0f/89/f5/6ca81802.jpg","comment_is_top":false,"comment_ctime":1557565995,"is_pvip":false,"discussion_count":1,"race_medal":0,"score":"5852533291","product_id":100015201,"comment_content":"curl -s https:&#47;&#47;mirrors.aliyun.com&#47;kubernetes&#47;apt&#47;doc&#47;apt-key.gpg | apt-key add - <br>cat &lt;&lt;EOF &gt; &#47;etc&#47;apt&#47;sources.list.d&#47;kubernetes.list<br>deb http:&#47;&#47;mirrors.ustc.edu.cn&#47;kubernetes&#47;apt kubernetes-xenial main<br>EOF<br>apt-get update<br>apt-get install -y docker.io kubeadm","like_count":1,"discussions":[{"author":{"id":1584671,"avatar":"https://static001.geekbang.org/account/avatar/00/18/2e/1f/c515fba5.jpg","nickname":"磊","note":"","ucode":"05EEAF999BF1E1","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":4269,"discussion_content":"还是不行 E: Unable to locate package kubeadm  我也是无语了 都用了阿里云的镜像了","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1565264263,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":93651,"user_name":"rice5","can_delete":false,"product_type":"c1","uid":1342243,"ip_address":"","ucode":"663E9A25D187F8","user_header":"http://thirdwx.qlogo.cn/mmopen/vi_32/K9ppk2d23Xw3ntNZEEaX9UYrCrR8KG4sdJejX5pXSoQILdiaFdXicdW1yYicHibJ5Vzxak3NcxO8GbH2x16XQvM7Dg/132","comment_is_top":false,"comment_ctime":1557545733,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"5852513029","product_id":100015201,"comment_content":"老师好，文档大部分都是基于Ubuntu的，但生产CentOS为主；冒昧问个问题，一般安装K8S是推荐用Ubuntu还是CentOS呢？新手是推荐用Ubuntu来部署实验环境吗？谢谢！","like_count":1},{"had_liked":false,"id":93159,"user_name":"Rodinian","can_delete":false,"product_type":"c1","uid":1096181,"ip_address":"","ucode":"10A4E6138B838A","user_header":"https://static001.geekbang.org/account/avatar/00/10/b9/f5/ffc2bb23.jpg","comment_is_top":false,"comment_ctime":1557410167,"is_pvip":false,"discussion_count":1,"race_medal":0,"score":"5852377463","product_id":100015201,"comment_content":"如何在kubeadm init --config kubeadm.yaml 的同时，指定 --pod-network-cidr=10.244.0.0&#47;16。因为有的网络组建，需要在一开始指定pod-network-cidr但是 config文件里面 似乎没有完全一致的字段。networking:<br>  podSubnet: 10.244.0.0&#47;16<br>似乎不够。","like_count":1,"discussions":[{"author":{"id":1500601,"avatar":"http://thirdwx.qlogo.cn/mmopen/vi_32/kAH6ZItDMBuCcr1xffR6GCPm2qwpf3y3EKW87eX9jzeJchtPkB9EOO9WcwvSMlWs9s8Y9zZFEQjPVqicRLDsCpw/132","nickname":"Geek_f8ac5e","note":"","ucode":"6ED54C5C37EEB1","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":4387,"discussion_content":"我本机就是10网段的，然后安装网络插件老是失败，我用这个方法：\nkubectl apply -f &#34;https://cloud.weave.works/k8s/net?k8s-version=$(kubectl version | base64 | tr -d &#39;\\n&#39;)&amp;env.IPALLOC_RANGE=10.150.109.0/24&#34;指定网络的","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1565344872,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":87693,"user_name":"海洋迷彩","can_delete":false,"product_type":"c1","uid":1501751,"ip_address":"","ucode":"8E8862BCBADE9A","user_header":"https://static001.geekbang.org/account/avatar/00/16/ea/37/3721eec0.jpg","comment_is_top":false,"comment_ctime":1555661890,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"5850629186","product_id":100015201,"comment_content":"搭建ceph存储插件时，先执行kubectl create -f https:&#47;&#47;raw.githubusercontent.com&#47;rook&#47;rook&#47;master&#47;cluster&#47;examples&#47;kubernetes&#47;ceph&#47;common.yaml","like_count":1},{"had_liked":false,"id":85792,"user_name":"dfx","can_delete":false,"product_type":"c1","uid":1158614,"ip_address":"","ucode":"A04D121FA8531B","user_header":"https://static001.geekbang.org/account/avatar/00/11/ad/d6/7e4e558c.jpg","comment_is_top":false,"comment_ctime":1555235813,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"5850203109","product_id":100015201,"comment_content":"版本指定<br>apt install docker.io=18.06.1-0ubuntu1.2~16.04.1 kubelet=1.11.3-00 kubectl=1.11.3-00 kubeadm=1.11.3-00 kubernetes-cni=0.6.0-00","like_count":1},{"had_liked":false,"id":84743,"user_name":"love the way","can_delete":false,"product_type":"c1","uid":1087461,"ip_address":"","ucode":"5B077026915F63","user_header":"https://static001.geekbang.org/account/avatar/00/10/97/e5/b54f8105.jpg","comment_is_top":false,"comment_ctime":1554901127,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"5849868423","product_id":100015201,"comment_content":"github dashboard项目地址：https:&#47;&#47;github.com&#47;kubernetes&#47;dashboard，原文中的地址已经not found了","like_count":1},{"had_liked":false,"id":67872,"user_name":"无法言喻.","can_delete":false,"product_type":"c1","uid":1322328,"ip_address":"","ucode":"7F375BE388D4FC","user_header":"https://static001.geekbang.org/account/avatar/00/14/2d/58/aa35c402.jpg","comment_is_top":false,"comment_ctime":1550304514,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"5845271810","product_id":100015201,"comment_content":"https:&#47;&#47;github.com&#47;autonomy&#47;talos <br>这个是发行版吗？","like_count":1},{"had_liked":false,"id":61306,"user_name":"德古拉","can_delete":false,"product_type":"c1","uid":1026624,"ip_address":"","ucode":"9A55538551EF0F","user_header":"https://static001.geekbang.org/account/avatar/00/0f/aa/40/abb7bfe3.jpg","comment_is_top":false,"comment_ctime":1547655921,"is_pvip":false,"replies":[{"id":"22065","content":"etcd到control panel上的问题居多","user_name":"作者回复","user_name_real":"Geek_6ef93d","uid":"1218095","ctime":1548053766,"ip_address":"","comment_id":61306,"utype":1}],"discussion_count":1,"race_medal":0,"score":"5842623217","product_id":100015201,"comment_content":"为什么Kubernetes可以管理的节点有瓶颈呢？问题出在什么地方呢？求指点","like_count":1,"discussions":[{"author":{"id":1218095,"avatar":"https://static001.geekbang.org/account/avatar/00/12/96/2f/876085fa.jpg","nickname":"张磊 Kubernetes","note":"","ucode":"16E29BDAB1F5BC","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":436827,"discussion_content":"etcd到control panel上的问题居多","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1548053766,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":57402,"user_name":"凌","can_delete":false,"product_type":"c1","uid":1257995,"ip_address":"","ucode":"41369B360C794F","user_header":"https://static001.geekbang.org/account/avatar/00/13/32/0b/81ae214b.jpg","comment_is_top":false,"comment_ctime":1546781635,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"5841748931","product_id":100015201,"comment_content":"浏览器导入证书访问dashboard成功，但是进去后提示forbidden错误啥也看不到","like_count":1},{"had_liked":false,"id":54212,"user_name":"C.R7","can_delete":false,"product_type":"c1","uid":1201627,"ip_address":"","ucode":"54A0A1CD050B1B","user_header":"https://static001.geekbang.org/account/avatar/00/12/55/db/9fd0a48d.jpg","comment_is_top":false,"comment_ctime":1545807772,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"5840775068","product_id":100015201,"comment_content":"https:&#47;&#47;raw.githubusercontent.com&#47;kubernetes&#47;dashboard&#47;master&#47;src&#47;deploy&#47;recommended&#47;kubernetes-dashboard.yaml<br>这个网址是不能用了吗？<br>","like_count":1},{"had_liked":false,"id":39055,"user_name":"勤劳的小胖子-libo","can_delete":false,"product_type":"c1","uid":1158344,"ip_address":"","ucode":"5BB20CD5A56568","user_header":"https://static001.geekbang.org/account/avatar/00/11/ac/c8/4b1c0d40.jpg","comment_is_top":false,"comment_ctime":1542179742,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"5837147038","product_id":100015201,"comment_content":"终于成功搭建好了。花了半天工夫，动手实操一翻才会有所收获。<br>基于vagrant: ubuntu + flannel. <br>使用flannel参考https:&#47;&#47;kubernetes.io&#47;docs&#47;setup&#47;independent&#47;create-cluster-kubeadm&#47;#pod-network ， 要加上--pod-network-cidr=10.244.0.0&#47;16<br>","like_count":1},{"had_liked":false,"id":38906,"user_name":"东东宝","can_delete":false,"product_type":"c1","uid":1280988,"ip_address":"","ucode":"51C107079AA1F3","user_header":"http://thirdwx.qlogo.cn/mmopen/vi_32/DYAIOgq83eo8rz97dFZTzBQK3xVY8NBfP6faZhvYCoDj8unSZIIhftpGWvJFYB6CEdf6bUu2rBNrabR3umc7jw/132","comment_is_top":false,"comment_ctime":1542158826,"is_pvip":false,"replies":[{"id":"13928","content":"直接重启机器即可","user_name":"作者回复","user_name_real":"Geek_6ef93d","uid":"1218095","ctime":1542181013,"ip_address":"","comment_id":38906,"utype":1}],"discussion_count":1,"race_medal":0,"score":"5837126122","product_id":100015201,"comment_content":"老师，利用kebeadm安装的master宕机了，有什么方法可以重启嘛？","like_count":1,"discussions":[{"author":{"id":1218095,"avatar":"https://static001.geekbang.org/account/avatar/00/12/96/2f/876085fa.jpg","nickname":"张磊 Kubernetes","note":"","ucode":"16E29BDAB1F5BC","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":428847,"discussion_content":"直接重启机器即可","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1542181013,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":36934,"user_name":"Terry Hu","can_delete":false,"product_type":"c1","uid":1219820,"ip_address":"","ucode":"9487EEECC051B5","user_header":"https://static001.geekbang.org/account/avatar/00/12/9c/ec/5da5c049.jpg","comment_is_top":false,"comment_ctime":1541394735,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"5836362031","product_id":100015201,"comment_content":"今天早上重启了master 节点，然后一直连不上api server<br>root@kube-master:~# kubectl cluster-info<br>Kubernetes master is running at https:&#47;&#47;xxxx:6443<br><br>To further debug and diagnose cluster problems, use &#39;kubectl cluster-info dump&#39;.<br><br>重启docker 也没用，无法get pods,最终解决方案是:再次disable swap<br>swapoff -a<br>为了不让这个问题再次出现，在&#47;etc&#47;fstab注释掉swap重启解决<br>看日志发现的，要学会查日志<br>journalctl -l -u kubelet","like_count":1},{"had_liked":false,"id":36215,"user_name":"💦","can_delete":false,"product_type":"c1","uid":1163844,"ip_address":"","ucode":"E9E342A9E767C2","user_header":"https://static001.geekbang.org/account/avatar/00/11/c2/44/d1b135d1.jpg","comment_is_top":false,"comment_ctime":1540982083,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"5835949379","product_id":100015201,"comment_content":"用vm搭建的，node  join后提示成功但是master上一直查询不到，最后定位到是hostname必须不同，修改再加入就好了，参考https:&#47;&#47;github.com&#47;kubernetes&#47;kubernetes&#47;issues&#47;61224#issuecomment-387283739，","like_count":1},{"had_liked":false,"id":35670,"user_name":"慕一","can_delete":false,"product_type":"c1","uid":1267534,"ip_address":"","ucode":"FF8E3D626B0953","user_header":"https://static001.geekbang.org/account/avatar/00/13/57/4e/fe8d3346.jpg","comment_is_top":false,"comment_ctime":1540735118,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"5835702414","product_id":100015201,"comment_content":"kubeadm init --config kubeadm.yaml ，报错，信息为，no kind MasterConfiguration is registered for version kubeadm.k8s.io&#47;v1.12.2 in scheme.......，求解答","like_count":1},{"had_liked":false,"id":35184,"user_name":"jimmy","can_delete":false,"product_type":"c1","uid":1018298,"ip_address":"","ucode":"852C5476842A58","user_header":"https://static001.geekbang.org/account/avatar/00/0f/89/ba/e1d6ce24.jpg","comment_is_top":false,"comment_ctime":1540450015,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"5835417311","product_id":100015201,"comment_content":"kubeadm 安装的master节点，是虚拟机节点，重启后，如何再次启动master的各个组件<br>","like_count":1},{"had_liked":false,"id":35144,"user_name":"jimmy","can_delete":false,"product_type":"c1","uid":1018298,"ip_address":"","ucode":"852C5476842A58","user_header":"https://static001.geekbang.org/account/avatar/00/0f/89/ba/e1d6ce24.jpg","comment_is_top":false,"comment_ctime":1540436265,"is_pvip":false,"replies":[{"id":"12531","content":"你看到的错误不是真正的错误，往上面翻翻","user_name":"作者回复","user_name_real":"Geek_6ef93d","uid":"1218095","ctime":1540439725,"ip_address":"","comment_id":35144,"utype":1}],"discussion_count":1,"race_medal":0,"score":"5835403561","product_id":100015201,"comment_content":"node 执行join后，显示成功，有如下日志：<br>This node has joined the cluster:<br>* Certificate signing request was sent to master and a response<br>  was received.<br>* The Kubelet was informed of the new secure connection details.<br><br>Run &#39;kubectl get nodes&#39; on the master to see this node join the cluster.<br>但是master上 执行 kubectl get nodes&#39; 就是看不到加进来的节点，<br>查询journalctl -xefu kubelet<br>12272 docker_sandbox.go:372] failed to read pod IP from plugin&#47;docker: NetworkPlugin cni failed on the status hook for pod &quot;coredns-99b9bb8bd-7vj5x_kube-system&quot;: CNI failed to retrieve network namespace path: cannot find network namespace for the terminated container &quot;0ca846c77523f26cc2ed9ea1224adb59c635c529d741f8480cdd826034c15c8f&quot;<br>看到如错误<br><br>是否是这个原因？怎么处理","like_count":1,"discussions":[{"author":{"id":1218095,"avatar":"https://static001.geekbang.org/account/avatar/00/12/96/2f/876085fa.jpg","nickname":"张磊 Kubernetes","note":"","ucode":"16E29BDAB1F5BC","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":427461,"discussion_content":"你看到的错误不是真正的错误，往上面翻翻","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1540439725,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":35056,"user_name":"leo","can_delete":false,"product_type":"c1","uid":1022306,"ip_address":"","ucode":"EE84F30C6617C7","user_header":"https://static001.geekbang.org/account/avatar/00/0f/99/62/18b04db7.jpg","comment_is_top":false,"comment_ctime":1540390977,"is_pvip":false,"replies":[{"id":"12533","content":"你网络插件装了没？","user_name":"作者回复","user_name_real":"Geek_6ef93d","uid":"1218095","ctime":1540439774,"ip_address":"","comment_id":35056,"utype":1}],"discussion_count":1,"race_medal":0,"score":"5835358273","product_id":100015201,"comment_content":"老师，请教个问题：<br>对于node结点的安装和注册,我执行了下指令，所有指令正常完成:<br>...<br>apt install -y kubelet=1.11.3-00<br>apt install -y kubectl=1.11.3-00<br>apt install -y kubeadm=1.11.3-00<br>kubeadm join ...<br>不过在master上执行kubectl get nodes后<br>加入的node显示 NotReady, 这是什么原因导制的呢？","like_count":1,"discussions":[{"author":{"id":1218095,"avatar":"https://static001.geekbang.org/account/avatar/00/12/96/2f/876085fa.jpg","nickname":"张磊 Kubernetes","note":"","ucode":"16E29BDAB1F5BC","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":427428,"discussion_content":"你网络插件装了没？","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1540439774,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":34574,"user_name":"Tylar","can_delete":false,"product_type":"c1","uid":1219676,"ip_address":"","ucode":"682412C5E7540D","user_header":"https://static001.geekbang.org/account/avatar/00/12/9c/5c/69ca7575.jpg","comment_is_top":false,"comment_ctime":1540210702,"is_pvip":false,"replies":[{"id":"12351","content":"你前面rook没成功部署吧？","user_name":"作者回复","user_name_real":"Geek_6ef93d","uid":"1218095","ctime":1540259745,"ip_address":"","comment_id":34574,"utype":1}],"discussion_count":1,"race_medal":0,"score":"5835177998","product_id":100015201,"comment_content":"提示error: unable to recognize &quot;https:&#47;&#47;raw.githubusercontent.com&#47;rook&#47;rook&#47;master&#47;cluster&#47;examples&#47;kubernetes&#47;ceph&#47;cluster.yaml&quot;: no matches for kind &quot;Cluster&quot; in version &quot;ceph.rook.io&#47;v1beta1&quot;。  没有这个APIversion怎么弄","like_count":1,"discussions":[{"author":{"id":1218095,"avatar":"https://static001.geekbang.org/account/avatar/00/12/96/2f/876085fa.jpg","nickname":"张磊 Kubernetes","note":"","ucode":"16E29BDAB1F5BC","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":427255,"discussion_content":"你前面rook没成功部署吧？","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1540259745,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":33982,"user_name":"Mr.Yang","can_delete":false,"product_type":"c1","uid":1267639,"ip_address":"","ucode":"C2F6A361F3FFD8","user_header":"https://static001.geekbang.org/account/avatar/00/13/57/b7/a37f1bc5.jpg","comment_is_top":false,"comment_ctime":1539937666,"is_pvip":false,"replies":[{"id":"12154","content":"kubeadm GA只是时间问题，其它原因我在文章末尾也说明了。","user_name":"作者回复","user_name_real":"Geek_6ef93d","uid":"1218095","ctime":1539940596,"ip_address":"","comment_id":33982,"utype":1}],"discussion_count":1,"race_medal":0,"score":"5834904962","product_id":100015201,"comment_content":"张老师，您好，您在上一节介绍kubeadm的结尾说kubeadm还不适合用在生产环境，而在这一节说下面将以kubeadm部署的环境为基础展开，请问为啥不使用能在生产环境使用的部署方式展开，把kubeadm部署的方式作为了解呢？(个人只是好奇，请各位大佬勿喷，谢谢！)","like_count":1,"discussions":[{"author":{"id":1218095,"avatar":"https://static001.geekbang.org/account/avatar/00/12/96/2f/876085fa.jpg","nickname":"张磊 Kubernetes","note":"","ucode":"16E29BDAB1F5BC","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":427092,"discussion_content":"kubeadm GA只是时间问题，其它原因我在文章末尾也说明了。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1539940596,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":33464,"user_name":"贾大众","can_delete":false,"product_type":"c1","uid":1261403,"ip_address":"","ucode":"CEEB32447A57CB","user_header":"https://static001.geekbang.org/account/avatar/00/13/3f/5b/6af46a5d.jpg","comment_is_top":false,"comment_ctime":1539789012,"is_pvip":false,"replies":[{"id":"12061","content":"你宿主机的网卡，网络 是不是不太常规？","user_name":"作者回复","user_name_real":"Geek_6ef93d","uid":"1218095","ctime":1539822074,"ip_address":"","comment_id":33464,"utype":1}],"discussion_count":1,"race_medal":0,"score":"5834756308","product_id":100015201,"comment_content":"worker节点加入不成功！<br>在master上执行get nodes只看到一个master节点。<br>还有一个奇怪的问题，用describe  node看到的internalip 竟然是另外一台主机的IP。","like_count":1,"discussions":[{"author":{"id":1218095,"avatar":"https://static001.geekbang.org/account/avatar/00/12/96/2f/876085fa.jpg","nickname":"张磊 Kubernetes","note":"","ucode":"16E29BDAB1F5BC","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":426970,"discussion_content":"你宿主机的网卡，网络 是不是不太常规？","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1539822074,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":32332,"user_name":"flyflypeng","can_delete":false,"product_type":"c1","uid":1224113,"ip_address":"","ucode":"7A40FC08D8ACC0","user_header":"https://static001.geekbang.org/account/avatar/00/12/ad/b1/2e96794c.jpg","comment_is_top":false,"comment_ctime":1539534176,"is_pvip":true,"replies":[{"id":"11832","content":"现在只能这么干……","user_name":"作者回复","user_name_real":"Geek_6ef93d","uid":"1218095","ctime":1539581575,"ip_address":"","comment_id":32332,"utype":1}],"discussion_count":1,"race_medal":0,"score":"5834501472","product_id":100015201,"comment_content":"老师你好，我看了一下大家的留言，发现大家在部署k8s过程中遇到的最大困难就是 “qiang”！<br>我也遇到了类似的问题，我想请教一下老师我该如何配置代理，可以使得 master 和 worker 节点上需要 pull 镜像时（例如 k8s.gcr.io上面的k8s基础组件的镜像），可以顺利地下载下来镜像。<br><br>我曾经尝试过如下的代理方式，但是还是失败：设置 http_proxy 和 https_proxy 这种策略会导致 k8s 发送自己的一些 https 请求时会走代理，从而找不到 apiserver 的地址。<br><br>我现在手动部署成功 k8s 的方法就是将 k8s 所需要的 docker images 从 docker hub 上下载下来，然后通过 docker tag 的方式重命令成 k8s 指定的镜像名称格式。但是这样真的好麻烦啊，好像有种顺畅地一键部署，而不是还要自己根据 yaml 文件中的 image 去事先现在好镜像。<br>","like_count":1,"discussions":[{"author":{"id":1218095,"avatar":"https://static001.geekbang.org/account/avatar/00/12/96/2f/876085fa.jpg","nickname":"张磊 Kubernetes","note":"","ucode":"16E29BDAB1F5BC","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":426733,"discussion_content":"现在只能这么干……","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1539581575,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":31693,"user_name":"G1","can_delete":false,"product_type":"c1","uid":1179568,"ip_address":"","ucode":"94630965EE7AFD","user_header":"https://static001.geekbang.org/account/avatar/00/11/ff/b0/dca98a0d.jpg","comment_is_top":false,"comment_ctime":1539266183,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"5834233479","product_id":100015201,"comment_content":"在执行kubectl apply的时候，如果serviceaccount&#47;weave-net unchanged，是因为Weave net 需要升级，执行kubectl rollout status ds&#47;weave-net -n kube-system即可","like_count":1},{"had_liked":false,"id":31554,"user_name":"爱学习","can_delete":false,"product_type":"c1","uid":1150431,"ip_address":"","ucode":"6CE61910D64428","user_header":"https://static001.geekbang.org/account/avatar/00/11/8d/df/1d1dbd57.jpg","comment_is_top":false,"comment_ctime":1539227335,"is_pvip":false,"replies":[{"id":"11340","content":"没有harbor ，会有calico","user_name":"作者回复","user_name_real":"Geek_6ef93d","uid":"1218095","ctime":1539244263,"ip_address":"","comment_id":31554,"utype":1}],"discussion_count":1,"race_medal":0,"score":"5834194631","product_id":100015201,"comment_content":"您好老师：<br>1、harbor的使用和安装后续会讲到吗？<br>2、在二进制安装的时候遇到calico的安装问题，一直没有搞清楚实现的原理和方式，这个后续会详细讲解吗？","like_count":1,"discussions":[{"author":{"id":1218095,"avatar":"https://static001.geekbang.org/account/avatar/00/12/96/2f/876085fa.jpg","nickname":"张磊 Kubernetes","note":"","ucode":"16E29BDAB1F5BC","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":426397,"discussion_content":"没有harbor ，会有calico","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1539244263,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":30937,"user_name":"Vincent","can_delete":false,"product_type":"c1","uid":1223046,"ip_address":"","ucode":"61CFE863E8E6D1","user_header":"https://static001.geekbang.org/account/avatar/00/12/a9/86/8211935c.jpg","comment_is_top":false,"comment_ctime":1539050097,"is_pvip":false,"replies":[{"id":"11135","content":"说明本来没有这个taint，不要怕","user_name":"作者回复","user_name_real":"Geek_6ef93d","uid":"1218095","ctime":1539053930,"ip_address":"","comment_id":30937,"utype":1}],"discussion_count":1,"race_medal":0,"score":"5834017393","product_id":100015201,"comment_content":"kubectl taint node node1.hash.loc node-role.kubernetes.io&#47;master-<br>error: taint &quot;node-role.kubernetes.io&#47;master:&quot; not found<br><br>删除master节点上的污点时报错<br><br>[root@node1 ~]# kubectl describe node <br>Name:               node1.hash.loc<br>Roles:              master<br>Labels:             beta.kubernetes.io&#47;arch=amd64<br>                    beta.kubernetes.io&#47;os=linux<br>                    kubernetes.io&#47;hostname=node1.hash.loc<br>                    node-role.kubernetes.io&#47;master=<br>Annotations:        kubeadm.alpha.kubernetes.io&#47;cri-socket=&#47;var&#47;run&#47;dockershim.sock<br>                    node.alpha.kubernetes.io&#47;ttl=0<br>","like_count":1,"discussions":[{"author":{"id":1218095,"avatar":"https://static001.geekbang.org/account/avatar/00/12/96/2f/876085fa.jpg","nickname":"张磊 Kubernetes","note":"","ucode":"16E29BDAB1F5BC","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":426153,"discussion_content":"说明本来没有这个taint，不要怕","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1539053930,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":30664,"user_name":"看不穿","can_delete":false,"product_type":"c1","uid":1259769,"ip_address":"","ucode":"8D35C36C7A35F0","user_header":"https://static001.geekbang.org/account/avatar/00/13/38/f9/2b4755b5.jpg","comment_is_top":false,"comment_ctime":1538967530,"is_pvip":false,"replies":[{"id":"11619","content":"网络部分会细讲","user_name":"作者回复","user_name_real":"Geek_6ef93d","uid":"1218095","ctime":1539423911,"ip_address":"","comment_id":30664,"utype":1}],"discussion_count":1,"race_medal":0,"score":"5833934826","product_id":100015201,"comment_content":"我看马哥教育的视频里面用的是flannel提供网络连接，用calico提供网络策略。<br>不过，本文说用weave插件提供网络策略，请问这两种方案孰优孰劣","like_count":1,"discussions":[{"author":{"id":1218095,"avatar":"https://static001.geekbang.org/account/avatar/00/12/96/2f/876085fa.jpg","nickname":"张磊 Kubernetes","note":"","ucode":"16E29BDAB1F5BC","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":426063,"discussion_content":"网络部分会细讲","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1539423911,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":30413,"user_name":"Jamie","can_delete":false,"product_type":"c1","uid":1135648,"ip_address":"","ucode":"E6D890D5EE2905","user_header":"https://static001.geekbang.org/account/avatar/00/11/54/20/7ad02632.jpg","comment_is_top":false,"comment_ctime":1538832746,"is_pvip":false,"replies":[{"id":"10994","content":"reset重新来。按这个步骤部署1.12也没有问题。","user_name":"作者回复","user_name_real":"Geek_6ef93d","uid":"1218095","ctime":1538873501,"ip_address":"","comment_id":30413,"utype":1}],"discussion_count":1,"race_medal":0,"score":"5833800042","product_id":100015201,"comment_content":"老师，我按照步骤安装kubeadm出错了，即使我指定版本(1.11.0-00,1.11.1-00,etc.)安装还是有这个问题,怎么破？<br>root@ip-172-31-21-209:~# apt-get install -y kubelet kubeadm kubectl<br>Reading package lists... Done<br>Building dependency tree<br>Reading state information... Done<br>kubectl is already the newest version (1.12.1-02).<br>Some packages could not be installed. This may mean that you have<br>requested an impossible situation or if you are using the unstable<br>distribution that some required packages have not yet been created<br>or been moved out of Incoming.<br>The following information may help to resolve the situation:<br><br>The following packages have unmet dependencies:<br> kubeadm : Depends: kubernetes-cni (= 0.6.0) but 0.6.0-02 is to be installed<br> kubelet : Depends: kubernetes-cni (= 0.6.0) but 0.6.0-02 is to be installed<br>E: Unable to correct problems, you have held broken packages.<br>","like_count":1,"discussions":[{"author":{"id":1218095,"avatar":"https://static001.geekbang.org/account/avatar/00/12/96/2f/876085fa.jpg","nickname":"张磊 Kubernetes","note":"","ucode":"16E29BDAB1F5BC","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":425986,"discussion_content":"reset重新来。按这个步骤部署1.12也没有问题。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1538873501,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":30190,"user_name":"看不穿","can_delete":false,"product_type":"c1","uid":1259769,"ip_address":"","ucode":"8D35C36C7A35F0","user_header":"https://static001.geekbang.org/account/avatar/00/13/38/f9/2b4755b5.jpg","comment_is_top":false,"comment_ctime":1538719101,"is_pvip":false,"replies":[{"id":"10996","content":"kubeadm可以部署多master，见官方文档","user_name":"作者回复","user_name_real":"Geek_6ef93d","uid":"1218095","ctime":1538873604,"ip_address":"","comment_id":30190,"utype":1}],"discussion_count":1,"race_medal":0,"score":"5833686397","product_id":100015201,"comment_content":"老师，请问maste节点是单节点，万一master坏了，怎么办，怎么给master做高可用","like_count":1,"discussions":[{"author":{"id":1218095,"avatar":"https://static001.geekbang.org/account/avatar/00/12/96/2f/876085fa.jpg","nickname":"张磊 Kubernetes","note":"","ucode":"16E29BDAB1F5BC","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":425888,"discussion_content":"kubeadm可以部署多master，见官方文档","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1538873604,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":28195,"user_name":"星尘_StarDust","can_delete":false,"product_type":"c1","uid":1226876,"ip_address":"","ucode":"78A2B0B0745429","user_header":"https://static001.geekbang.org/account/avatar/00/12/b8/7c/dc6c1242.jpg","comment_is_top":false,"comment_ctime":1538019470,"is_pvip":false,"replies":[{"id":"10140","content":"不是已经说明了？故意不要最新的。","user_name":"作者回复","user_name_real":"Geek_6ef93d","uid":"1218095","ctime":1538023488,"ip_address":"","comment_id":28195,"utype":1}],"discussion_count":1,"race_medal":0,"score":"5832986766","product_id":100015201,"comment_content":"docker.io? 这个是老版本的docker安装方式吧","like_count":1,"discussions":[{"author":{"id":1218095,"avatar":"https://static001.geekbang.org/account/avatar/00/12/96/2f/876085fa.jpg","nickname":"张磊 Kubernetes","note":"","ucode":"16E29BDAB1F5BC","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":425172,"discussion_content":"不是已经说明了？故意不要最新的。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1538023488,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":27307,"user_name":"龙坤","can_delete":false,"product_type":"c1","uid":1233455,"ip_address":"","ucode":"D1724E68D6304D","user_header":"https://static001.geekbang.org/account/avatar/00/12/d2/2f/04882ff8.jpg","comment_is_top":false,"comment_ctime":1537869361,"is_pvip":false,"replies":[{"id":"9853","content":"查看events看看吧","user_name":"作者回复","user_name_real":"Geek_6ef93d","uid":"1218095","ctime":1537886684,"ip_address":"","comment_id":27307,"utype":1}],"discussion_count":1,"race_medal":1,"score":"5832836657","product_id":100015201,"comment_content":"问题提示：<br>root@master:&#47;opt# kubectl get pods -n kube-system<br>NAME                                                    READY     STATUS              RESTARTS   AGE<br>coredns-78fcdf6894-rn569               1&#47;1       Running             0          46m<br>coredns-78fcdf6894-vcj4v                1&#47;1       Running             0          46m<br>etcd-master                                         1&#47;1       Running             0          45m<br>kube-apiserver-master                       1&#47;1       Running             0          45m<br>kube-controller-manager-master     1&#47;1       Running             0          45m<br>kube-proxy-bl92p                                1&#47;1       Running             0          46m<br>kube-proxy-wh278                                              0&#47;1       ContainerCreating   0          10m<br>kube-scheduler-master                                       1&#47;1       Running             0          45m<br>kubernetes-dashboard-767dc7d4d-gtqpr     1&#47;1       Running             0          24m<br>weave-net-4zlbw                                                  2&#47;2       Running             0          45m<br>weave-net-8n456                                                  0&#47;2       ContainerCreating   0          10m<br><br>我在worker上执行了kubeadm join之后，在master节点就出现了两个pod状态都是&quot;ContainerCreating&quot;，请问什么原因造成的？","like_count":1,"discussions":[{"author":{"id":1218095,"avatar":"https://static001.geekbang.org/account/avatar/00/12/96/2f/876085fa.jpg","nickname":"张磊 Kubernetes","note":"","ucode":"16E29BDAB1F5BC","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":424870,"discussion_content":"查看events看看吧","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1537886684,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":26502,"user_name":"leo","can_delete":false,"product_type":"c1","uid":1156643,"ip_address":"","ucode":"73E8917E5156FC","user_header":"https://static001.geekbang.org/account/avatar/00/11/a6/23/91e74c43.jpg","comment_is_top":false,"comment_ctime":1537624901,"is_pvip":true,"replies":[{"id":"9663","content":"可以的，参考单节点的文档，要对master进行设置","user_name":"作者回复","user_name_real":"Geek_6ef93d","uid":"1218095","ctime":1537688449,"ip_address":"","comment_id":26502,"utype":1}],"discussion_count":1,"race_medal":0,"score":"5832592197","product_id":100015201,"comment_content":"请问张磊老师，我只部署了单节点master，是不是不能部署rook？我运行了kubectl apply -f https:&#47;&#47;raw.githubusercontent.com&#47;rook&#47;rook&#47;master&#47;cluster&#47;examples&#47;kubernetes&#47;ceph&#47;operator.yaml<br>之后没报错，但是rook-ceph-operator-xxx的status一直是pending，看日志无任何信息。<br>部署就卡在这步了，求帮助，谢谢！<br>","like_count":1,"discussions":[{"author":{"id":1218095,"avatar":"https://static001.geekbang.org/account/avatar/00/12/96/2f/876085fa.jpg","nickname":"张磊 Kubernetes","note":"","ucode":"16E29BDAB1F5BC","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":424652,"discussion_content":"可以的，参考单节点的文档，要对master进行设置","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1537688449,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":26218,"user_name":"陈华","can_delete":false,"product_type":"c1","uid":1082730,"ip_address":"","ucode":"3AF9E8EB39E507","user_header":"http://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTKtS26SJpSF7JLu9pusGsy1Qln0NdQg1eV2YKOJxpX2QXaBuuyXMqZY3fm0rhzKwsqN5aa6CVNOQQ/132","comment_is_top":false,"comment_ctime":1537521058,"is_pvip":false,"replies":[{"id":"9574","content":"不是。","user_name":"作者回复","user_name_real":"Geek_6ef93d","uid":"1218095","ctime":1537545544,"ip_address":"","comment_id":26218,"utype":1}],"discussion_count":1,"race_medal":0,"score":"5832488354","product_id":100015201,"comment_content":"Flannel、Calico、Canal、Romana请问老师这些和 Istio （http:&#47;&#47;www.infoq.com&#47;cn&#47;news&#47;2017&#47;05&#47;istio<br>）是一个类型的东西吗，","like_count":1,"discussions":[{"author":{"id":1218095,"avatar":"https://static001.geekbang.org/account/avatar/00/12/96/2f/876085fa.jpg","nickname":"张磊 Kubernetes","note":"","ucode":"16E29BDAB1F5BC","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":424572,"discussion_content":"不是。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1537545544,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":25495,"user_name":"Vincent","can_delete":false,"product_type":"c1","uid":1223046,"ip_address":"","ucode":"61CFE863E8E6D1","user_header":"https://static001.geekbang.org/account/avatar/00/12/a9/86/8211935c.jpg","comment_is_top":false,"comment_ctime":1537344188,"is_pvip":false,"replies":[{"id":"9280","content":"那就科学一下……","user_name":"作者回复","user_name_real":"Geek_6ef93d","uid":"1218095","ctime":1537363604,"ip_address":"","comment_id":25495,"utype":1}],"discussion_count":1,"race_medal":0,"score":"5832311484","product_id":100015201,"comment_content":"不能科学上网好像就部署不了啊，老师~~","like_count":1,"discussions":[{"author":{"id":1218095,"avatar":"https://static001.geekbang.org/account/avatar/00/12/96/2f/876085fa.jpg","nickname":"张磊 Kubernetes","note":"","ucode":"16E29BDAB1F5BC","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":424324,"discussion_content":"那就科学一下……","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1537363604,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":25422,"user_name":"Alery","can_delete":false,"product_type":"c1","uid":1156557,"ip_address":"","ucode":"08F3F49181E67B","user_header":"https://static001.geekbang.org/account/avatar/00/11/a5/cd/3aff5d57.jpg","comment_is_top":false,"comment_ctime":1537325901,"is_pvip":false,"replies":[{"id":"9238","content":"存储节点，也就是你部署了ceph的机器","user_name":"作者回复","user_name_real":"Geek_6ef93d","uid":"1218095","ctime":1537334480,"ip_address":"","comment_id":25422,"utype":1}],"discussion_count":1,"race_medal":0,"score":"5832293197","product_id":100015201,"comment_content":"请教一个问题，容器里挂在由Ceph提供的数据卷，那这个数据卷实际的数据存储再什么地方呢？","like_count":1,"discussions":[{"author":{"id":1218095,"avatar":"https://static001.geekbang.org/account/avatar/00/12/96/2f/876085fa.jpg","nickname":"张磊 Kubernetes","note":"","ucode":"16E29BDAB1F5BC","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":424299,"discussion_content":"存储节点，也就是你部署了ceph的机器","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1537334480,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":25077,"user_name":"Switch","can_delete":false,"product_type":"c1","uid":1049360,"ip_address":"","ucode":"D8A7F7F6A0BEA9","user_header":"https://static001.geekbang.org/account/avatar/00/10/03/10/26f9f762.jpg","comment_is_top":false,"comment_ctime":1537242591,"is_pvip":false,"replies":[{"id":"9175","content":"这是gfw吧","user_name":"作者回复","user_name_real":"Geek_6ef93d","uid":"1218095","ctime":1537268145,"ip_address":"","comment_id":25077,"utype":1}],"discussion_count":1,"race_medal":0,"score":"5832209887","product_id":100015201,"comment_content":"使用kubernetesVersion: &quot;stable-1.11&quot;报错&quot;unable to get URL &quot;https:&#47;&#47;dl.k8s.io&#47;release&#47;stable-1.11.1.txt&quot;: Get https:&#47;&#47;storage.googleapis.com&#47;kubernetes-release&#47;release&#47;stable-1.11.1.txt: dial tcp 172.217.161.144:443: i&#47;o timeout&quot;，使用版本&quot;v1.11.1&quot;没问题，建议更改版本号","like_count":1,"discussions":[{"author":{"id":1218095,"avatar":"https://static001.geekbang.org/account/avatar/00/12/96/2f/876085fa.jpg","nickname":"张磊 Kubernetes","note":"","ucode":"16E29BDAB1F5BC","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":424179,"discussion_content":"这是gfw吧","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1537268145,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":24999,"user_name":"他说风雨中","can_delete":false,"product_type":"c1","uid":1048012,"ip_address":"","ucode":"3175063755F1FD","user_header":"https://static001.geekbang.org/account/avatar/00/0f/fd/cc/b13b71f9.jpg","comment_is_top":false,"comment_ctime":1537235223,"is_pvip":false,"replies":[{"id":"9141","content":"后面专门有一篇讲资源管理的","user_name":"作者回复","user_name_real":"Geek_6ef93d","uid":"1218095","ctime":1537248274,"ip_address":"","comment_id":24999,"utype":1}],"discussion_count":1,"race_medal":0,"score":"5832202519","product_id":100015201,"comment_content":"老师您好，想问一下您kubernetes1.10是怎么支持cpuset，cpushare的，是在deployment的yaml文件里面吗？并且问一下k8s是回自动进行cpu管理还是手动去管理？由于网上材料很少，只能在这里问您，希望您能指点一下","like_count":1,"discussions":[{"author":{"id":1218095,"avatar":"https://static001.geekbang.org/account/avatar/00/12/96/2f/876085fa.jpg","nickname":"张磊 Kubernetes","note":"","ucode":"16E29BDAB1F5BC","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":424159,"discussion_content":"后面专门有一篇讲资源管理的","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1537248274,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":24787,"user_name":"jssfy","can_delete":false,"product_type":"c1","uid":1137238,"ip_address":"","ucode":"F16353CFE607B7","user_header":"https://static001.geekbang.org/account/avatar/00/11/5a/56/115c6433.jpg","comment_is_top":false,"comment_ctime":1537193913,"is_pvip":false,"replies":[{"id":"9142","content":"其他支持已经陆续添加了。有必要，因为要用PVC PV。隔离问题非常大。公有云上只能虚拟机。","user_name":"作者回复","user_name_real":"Geek_6ef93d","uid":"1218095","ctime":1537248363,"ip_address":"","comment_id":24787,"utype":1}],"discussion_count":2,"race_medal":0,"score":"5832161209","product_id":100015201,"comment_content":"1. rook 目前只提供cepg支持？<br>2. 如果我集群中每台机器都已经挂载nfs，那么nfs存储插件对我来说是否就没有必要了？<br>3. 目前的公有云是否有采用k8s方案？如果有，不同用户的pod如果调度到同一台物理机上，是否会有隔离问题，如之前一节有类似提到，还是有些隔离问题存在的？<br>4. 部署k8s到公有云或者私有云，会分别建议部署在虚拟机或者裸金属机上吗？<br>多谢多谢！","like_count":1,"discussions":[{"author":{"id":1218095,"avatar":"https://static001.geekbang.org/account/avatar/00/12/96/2f/876085fa.jpg","nickname":"张磊 Kubernetes","note":"","ucode":"16E29BDAB1F5BC","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":424110,"discussion_content":"其他支持已经陆续添加了。有必要，因为要用PVC PV。隔离问题非常大。公有云上只能虚拟机。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1537248363,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1311001,"avatar":"https://static001.geekbang.org/account/avatar/00/14/01/19/f4da2829.jpg","nickname":"一秒","note":"","ucode":"F149B7F60620BD","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":347167,"discussion_content":"公有云还可以裸金属，就是成本有点高，哈哈","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1612170344,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":24615,"user_name":"张龙是个大骗子","can_delete":false,"product_type":"c1","uid":1049129,"ip_address":"","ucode":"ADB6BFB873509C","user_header":"https://static001.geekbang.org/account/avatar/00/10/02/29/5c28f68e.jpg","comment_is_top":false,"comment_ctime":1537165350,"is_pvip":false,"replies":[{"id":"9048","content":"不会啊","user_name":"作者回复","user_name_real":"Geek_6ef93d","uid":"1218095","ctime":1537187517,"ip_address":"","comment_id":24615,"utype":1}],"discussion_count":1,"race_medal":0,"score":"5832132646","product_id":100015201,"comment_content":"centos上安装与Ubuntu上安装差别是不是挺大的","like_count":1,"discussions":[{"author":{"id":1218095,"avatar":"https://static001.geekbang.org/account/avatar/00/12/96/2f/876085fa.jpg","nickname":"张磊 Kubernetes","note":"","ucode":"16E29BDAB1F5BC","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":424059,"discussion_content":"不会啊","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1537187517,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":357451,"user_name":"白墨","can_delete":false,"product_type":"c1","uid":1576225,"ip_address":"北京","ucode":"53975A9EF6ED25","user_header":"https://static001.geekbang.org/account/avatar/00/18/0d/21/5f23fc7b.jpg","comment_is_top":false,"comment_ctime":1663280961,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1663280961","product_id":100015201,"comment_content":"嗯实操果然困难重重","like_count":0},{"had_liked":false,"id":356933,"user_name":"ezreal","can_delete":false,"product_type":"c1","uid":1292142,"ip_address":"浙江","ucode":"E2FA034B3F9BBF","user_header":"https://static001.geekbang.org/account/avatar/00/13/b7/6e/e426bffe.jpg","comment_is_top":false,"comment_ctime":1662709400,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1662709400","product_id":100015201,"comment_content":"我用虚拟机部署了一个kubernetes 1.19.0版本的，具体教程可以查看我博客：https:&#47;&#47;ezreal_rao.gitee.io&#47;6e06a0d5d03a&#47;ubuntu20-04-%E5%AE%89%E8%A3%85-kubernetes&#47;","like_count":0},{"had_liked":false,"id":354534,"user_name":"@%初%@","can_delete":false,"product_type":"c1","uid":1053509,"ip_address":"北京","ucode":"2B8A6134675ED7","user_header":"https://static001.geekbang.org/account/avatar/00/10/13/45/16c60da2.jpg","comment_is_top":false,"comment_ctime":1660492046,"is_pvip":true,"discussion_count":0,"race_medal":0,"score":"1660492046","product_id":100015201,"comment_content":"安装完k8s的网络插件weave-net，但是节点还是一直NotReady状态，查看pod，发现weave-net没起来，如下:<br>weave-net-96jdv                 0&#47;2     Init:0&#47;1            0          35m<br><br>查看 kubectl describe node k8s02，发现一直报这个：KubeletNotReady              container runtime network not ready: NetworkReady=false reason:NetworkPluginNotReady message:docker: network plugin is not ready: cni config uninitialized<br><br>查看有问题的节点的kubelet：Unable to read config path，一直报错: no valid networks found in &#47;etc&#47;cni&#47;net.d<br>请问这是什么原因呢？该怎么解决呢？","like_count":0},{"had_liked":false,"id":352251,"user_name":"Brilliant","can_delete":false,"product_type":"c1","uid":1522168,"ip_address":"","ucode":"CFF4F5BCAF21EE","user_header":"https://static001.geekbang.org/account/avatar/00/17/39/f8/b5a1b669.jpg","comment_is_top":false,"comment_ctime":1658481272,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1658481272","product_id":100015201,"comment_content":"kubeadm join....指令执行失败，查看发现work机上kubelet启动失败：<br> Jul 22 08:40:47 ubuntu kubelet[21580]: W0722 08:40:47.756242   21580 clientconn.go:1331] [core] grpc: addrConn.createTransport failed to connect to {  &lt;nil&gt; 0 &lt;nil&gt;}. Err: connection error: desc = &quot;transport: Error while dialing dial unix: missing address&quot;. Reconnecting...<br>Jul 22 08:40:47 ubuntu kubelet[21580]: Error: failed to run Kubelet: unable to determine runtime API version: rpc error: code = Unavailable desc = connection error: desc = &quot;transport: Error while dialing dial unix: missing address&quot;<br>","like_count":0},{"had_liked":false,"id":351546,"user_name":"进击的巨人","can_delete":false,"product_type":"c1","uid":1167120,"ip_address":"","ucode":"DB62D77D460BF1","user_header":"https://static001.geekbang.org/account/avatar/00/11/cf/10/9fa2e5ba.jpg","comment_is_top":false,"comment_ctime":1657881356,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1657881356","product_id":100015201,"comment_content":"一台机器是否有办法即跑master也跑node 呢","like_count":0},{"had_liked":false,"id":348362,"user_name":"码小呆","can_delete":false,"product_type":"c1","uid":2055809,"ip_address":"","ucode":"44532D6ABF9340","user_header":"https://static001.geekbang.org/account/avatar/00/1f/5e/81/82709d6e.jpg","comment_is_top":false,"comment_ctime":1655020057,"is_pvip":true,"discussion_count":0,"race_medal":0,"score":"1655020057","product_id":100015201,"comment_content":"搭建成功案例教程,希望有用 https:&#47;&#47;blog.csdn.net&#47;qq_41971087&#47;article&#47;details&#47;120598374?spm=1001.2014.3001.5501","like_count":0},{"had_liked":false,"id":344406,"user_name":"半缘君","can_delete":false,"product_type":"c1","uid":1140265,"ip_address":"","ucode":"1266C4E35180A2","user_header":"https://static001.geekbang.org/account/avatar/00/11/66/29/8b471f9d.jpg","comment_is_top":false,"comment_ctime":1651511397,"is_pvip":true,"discussion_count":1,"race_medal":0,"score":"1651511397","product_id":100015201,"comment_content":"老师能提供一下最新版本的kubeadm 对应的config文件吗？ v1.23.6","like_count":0,"discussions":[{"author":{"id":2930234,"avatar":"https://thirdwx.qlogo.cn/mmopen/vi_32/KqZeIjNOVQJnsIFkDBWl5wfaxWDGLpIMUdFbF7SQhXFavmxgpwQPj9FrGAV4xNrqd733qicT4IZVibELyziaLokDQ/132","nickname":"罗艺","note":"","ucode":"9D4E1A377BCF23","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":570350,"discussion_content":" vim kubeadm.yaml\napiVersion: kubeadm.k8s.io/v1beta3  #版本信息参考kubeadm config print init-defaults命令结果\nkind: ClusterConfiguration\nkubernetesVersion: 1.23.6  #版本信息参考kubeadm config print init-defaults命令结果\nimageRepository: registry.aliyuncs.com/google_containers #配置国内镜像\n\napiServer:\n  extraArgs:\n    runtime-config: &#34;api/all=true&#34;\n\n#controllerManager:\n#  extraArgs:\n#    horizontal-pod-autoscaler-use-rest-clients: &#34;true&#34; #开启kube-controller-manager能够使用自定义资源（Custom Metrics）进行自动水平扩展,但是高版本不支持该参数需要去掉。\n#    horizontal-pod-autoscaler-sync-period: &#34;10s&#34;\n#    node-monitor-grace-period: &#34;10s&#34;  \n\netcd:\n  local:\n    dataDir: /data/k8s/etcd\n","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1651740398,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":344098,"user_name":"Gocifer","can_delete":false,"product_type":"c1","uid":1905564,"ip_address":"","ucode":"9F3C63FE09FA32","user_header":"https://static001.geekbang.org/account/avatar/00/1d/13/9c/75189b63.jpg","comment_is_top":false,"comment_ctime":1651238036,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1651238036","product_id":100015201,"comment_content":"&gt; 距作者发布文章时间有段时间，按下面的指令可以还原作者的版本，此外解决很多人会卡的网络问题<br><br>本机环境与网络：VMware中运行 ubuntu16.04，网卡运行在 host_only 模式，因此所有外网访问都通过代理。代理地址就是宿主机虚拟网卡，当然也是虚拟网段的网关<br><br>1. 设置系统代理<br><br>&gt; no_proxy 一定要把添加进代理位置，否则会影响最后 api-server 启动<br><br>```shell<br>cat &lt;&lt;EOF &gt; &#47;etc&#47;profile.d&#47;netproxy.sh<br>export http_proxy=http:&#47;&#47;192.168.164.1:7890<br>export https_proxy=http:&#47;&#47;192.168.164.1:7890<br>export no_proxy=&#39;192.168.164.1&#47;24,127.0.0.0&#47;8&#39;<br>EOF<br><br>source &#47;etc&#47;profile.d&#47;netproxy.sh<br>```<br><br>2. 添加软件仓库<br><br>```shell<br>curl -fsSL https:&#47;&#47;download.docker.com&#47;linux&#47;ubuntu&#47;gpg | sudo gpg --dearmor -o &#47;usr&#47;share&#47;keyrings&#47;docker-archive-keyring.gpg<br><br>echo   &quot;deb [arch=$(dpkg --print-architecture)  signed-by=&#47;usr&#47;share&#47;keyrings&#47;docker-archive-keyring.gpg] https:&#47;&#47;download.docker.com&#47;linux&#47;ubuntu   $(lsb_release -cs) stable&quot; | sudo tee &#47;etc&#47;apt&#47;sources.list.d&#47;docker.list &gt; &#47;dev&#47;null<br><br>curl -s https:&#47;&#47;packages.cloud.google.com&#47;apt&#47;doc&#47;apt-key.gpg | apt-key add -<br><br>cat &lt;&lt;EOF &gt; &#47;etc&#47;apt&#47;sources.list.d&#47;kubernetes.list<br>deb http:&#47;&#47;apt.kubernetes.io&#47; kubernetes-xenial main<br>EOF<br>```<br><br>3. 安装软件<br><br>```shell<br>apt update<br><br>apt install kubeadm=1.11.10-00 kubelet=1.11.10-00 kubectl=1.11.10-00 kubernetes-cni=0.7.5-00<br><br>apt install docker-ce=17.03.3~ce-0~ubuntu-xenial<br>```<br><br>4. 设置容器代理<br><br>```shell<br>mkdir -p &#47;etc&#47;systemd&#47;system&#47;docker.service.d<br><br>cat &lt;&lt;EOF &gt; &#47;etc&#47;systemd&#47;system&#47;docker.service.d&#47;http-proxy.conf <br>[Service]<br>Environment=&quot;HTTP_PROXY=http:&#47;&#47;192.168.164.1:7890&quot;<br>Environment=&quot;HTTPS_PROXY=http:&#47;&#47;192.168.164.1:7890&quot;<br>Environment=&quot;NO_PROXY=192.168.164.1,localhost,127.0.0.1,localaddress,.localdomain.com&quot;<br>EOF<br><br>systemctl daemon-reload<br>systemctl restart docker<br>```<br><br>5. kubeadm init <br><br>&gt; vim 的 kubeadm.yaml 和作者文中一样，不用改动（或者 `kubernetesVersion: &quot;v1.11.10&quot;`也可以）<br><br>```shell<br>vim kubeadm.yaml<br><br>ip route add default via 192.168.164.1 dev ens33<br><br>swapoff -a<br>vim &#47;etc&#47;fstab<br><br>kubeadm config images pull<br>kubeadm init --config kubeadm.yaml <br>```<br>","like_count":0},{"had_liked":false,"id":343227,"user_name":"soddygo","can_delete":false,"product_type":"c1","uid":1071509,"ip_address":"","ucode":"E1D4D272C95804","user_header":"https://static001.geekbang.org/account/avatar/00/10/59/95/a164fa5c.jpg","comment_is_top":false,"comment_ctime":1650719996,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1650719996","product_id":100015201,"comment_content":"我是参考官方部署单节点操作,debian 10 虚拟机里,在kubeadm init 启动报错,最终解决设置cgroup,参考命令:<br>sed -i &quot;s&#47;cgroupDriver: systemd&#47;cgroupDriver: cgroupfs&#47;g&quot; &#47;var&#47;lib&#47;kubelet&#47;config.yaml<br>systemctl daemon-reload<br>systemctl restart kubelet<br>供后来人参考","like_count":0},{"had_liked":false,"id":343183,"user_name":"其异果吖","can_delete":false,"product_type":"c1","uid":2984482,"ip_address":"","ucode":"B8B8ABF98A0B61","user_header":"https://static001.geekbang.org/account/avatar/00/2d/8a/22/b206469a.jpg","comment_is_top":false,"comment_ctime":1650694970,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1650694970","product_id":100015201,"comment_content":"如果有3个master节点，3个工作节点，3个master节点直接是如何通信的呀？ 组成集群是不是3个工作节点都分别join 到3个master","like_count":0},{"had_liked":false,"id":342809,"user_name":"Nio","can_delete":false,"product_type":"c1","uid":1529642,"ip_address":"","ucode":"A1B8D3C01FB937","user_header":"https://static001.geekbang.org/account/avatar/00/17/57/2a/c6c95f37.jpg","comment_is_top":false,"comment_ctime":1650469745,"is_pvip":true,"discussion_count":0,"race_medal":4,"score":"1650469745","product_id":100015201,"comment_content":"要深入学习 第一步就是环境搭建 然后进入实操","like_count":0},{"had_liked":false,"id":339053,"user_name":"Geek_6b751f","can_delete":false,"product_type":"c1","uid":2853626,"ip_address":"","ucode":"C55454D94729C9","user_header":"","comment_is_top":false,"comment_ctime":1647874454,"is_pvip":true,"discussion_count":0,"race_medal":0,"score":"1647874454","product_id":100015201,"comment_content":"不可以在Windows机器上安装LINUX虚拟机来不熟kubernets吗","like_count":0},{"had_liked":false,"id":339029,"user_name":"Mars","can_delete":false,"product_type":"c1","uid":1300378,"ip_address":"","ucode":"84E7821DF19382","user_header":"https://static001.geekbang.org/account/avatar/00/13/d7/9a/38d14e5f.jpg","comment_is_top":false,"comment_ctime":1647865226,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1647865226","product_id":100015201,"comment_content":"kubelet启动，然后kirqd&#47;2占用cpu飙升，有同学遇到过吗","like_count":0},{"had_liked":false,"id":338654,"user_name":"ck271","can_delete":false,"product_type":"c1","uid":1535826,"ip_address":"","ucode":"826255E2741CA3","user_header":"https://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTKnrBD6ZSPYZy2I1LfTlE6HU4Jlyh8YNCGRhVE1CRXYaMSic4hh5Um2eBHve1pSaxNNQqsd8u7ib0hQ/132","comment_is_top":false,"comment_ctime":1647648107,"is_pvip":true,"discussion_count":0,"race_medal":0,"score":"1647648107","product_id":100015201,"comment_content":"要是专栏可以保持更新就好了，过时的方式，会让人不知所措","like_count":0},{"had_liked":false,"id":334841,"user_name":"the outsider","can_delete":false,"product_type":"c1","uid":1665646,"ip_address":"","ucode":"3209715E5AD7A4","user_header":"https://static001.geekbang.org/account/avatar/00/19/6a/6e/38738a57.jpg","comment_is_top":false,"comment_ctime":1645153304,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1645153304","product_id":100015201,"comment_content":"老师，请教个问题，kubeadm部署k8s集群，在不使用配置文件，直接命令行初始化集群的时候，怎么设置kubeproxy的mode为ipvs啊？？？或者有其他同学帮忙看看嘛？谢谢，有点急。","like_count":0},{"had_liked":false,"id":334078,"user_name":"Jane","can_delete":false,"product_type":"c1","uid":1213988,"ip_address":"","ucode":"D6CCAA4E001F9E","user_header":"https://static001.geekbang.org/account/avatar/00/12/86/24/c9365583.jpg","comment_is_top":false,"comment_ctime":1644731755,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1644731755","product_id":100015201,"comment_content":"执行到部署网络插件这一块就会出错：<br>kubectl apply -f https:&#47;&#47;git.io&#47;weave-kube-1.6<br>出错信息：<br>Unable to connect to the server: dial tcp 104.23.124.189:443: i&#47;o timeout<br>应该怎么办","like_count":0},{"had_liked":false,"id":323598,"user_name":"solu","can_delete":false,"product_type":"c1","uid":1195100,"ip_address":"","ucode":"C4EBFC53B511F0","user_header":"https://static001.geekbang.org/account/avatar/00/12/3c/5c/5dee2ab3.jpg","comment_is_top":false,"comment_ctime":1638013012,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1638013012","product_id":100015201,"comment_content":"Waiting for the kubelet to boot up the control plane as static Pods from directory &quot;&#47;etc&#47;kubernetes&#47;manifests&quot;. This can take up to 4m0s<br>[kubelet-check] Initial timeout of 40s passed.<br>[kubelet-check] It seems like the kubelet isn&#39;t running or healthy.<br><br> 实际部署过程中上述boot up the control plane as static Pods为啥总是失败。这个不知道大家有木有遇到过，一直没有解决。","like_count":0},{"had_liked":false,"id":320663,"user_name":"Geek_5227ac","can_delete":false,"product_type":"c1","uid":1607208,"ip_address":"","ucode":"8C468F5C45696E","user_header":"http://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTKiay65IMyD82E59Xnbp370ChMG3N9XQuXoKwfhZJ19zotzKMlJhwzBDxE61bp26jdkf54NY9L41yg/132","comment_is_top":false,"comment_ctime":1636444068,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1636444068","product_id":100015201,"comment_content":"这节手动安装k8s课里的许多链接以及配置文件版本貌似已经过时了，能否更新下里面的内容呢","like_count":0},{"had_liked":false,"id":310462,"user_name":"🙃骚军","can_delete":false,"product_type":"c1","uid":1691067,"ip_address":"","ucode":"12FEACE3515FE7","user_header":"https://static001.geekbang.org/account/avatar/00/19/cd/bb/77c92649.jpg","comment_is_top":false,"comment_ctime":1630661519,"is_pvip":false,"discussion_count":1,"race_medal":0,"score":"1630661519","product_id":100015201,"comment_content":"问题1:<br>kubectl apply -f https:&#47;&#47;git.io&#47;weave-kube-1.6","like_count":0,"discussions":[{"author":{"id":2779970,"avatar":"","nickname":"Geek_xiong","note":"","ucode":"1A92DD9B35AC4E","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":398594,"discussion_content":"kubectl apply -n kube-system -f &#34;https://cloud.weave.works/k8s/net?k8s-version=$(kubectl version | base64 | tr -d &#39;\\n&#39;)&#34;","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1632818950,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":310089,"user_name":"LeoDuan","can_delete":false,"product_type":"c1","uid":1591129,"ip_address":"","ucode":"BEF6DFBAECACA9","user_header":"https://static001.geekbang.org/account/avatar/00/18/47/59/a77a9af4.jpg","comment_is_top":false,"comment_ctime":1630482035,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1630482035","product_id":100015201,"comment_content":"老师您好，想问一下负载均衡怎么做的？必须使用metallb吗？可是metallb使用的speaker和controller镜像怎么搜不到呢？","like_count":0},{"had_liked":false,"id":306895,"user_name":"IT小马","can_delete":false,"product_type":"c1","uid":2718841,"ip_address":"","ucode":"0CE0CF34647266","user_header":"","comment_is_top":false,"comment_ctime":1628766104,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1628766104","product_id":100015201,"comment_content":"apiVersion: kubeadm.k8s.io&#47;v1beta3<br>kind: MasterConfiguration<br>controllerManagerExtraArgs:<br>  horizontal-pod-autoscaler-use-rest-clients: &quot;true&quot;<br>  horizontal-pod-autoscaler-sync-period: &quot;10s&quot;<br>  node-monitor-grace-period: &quot;10s&quot;<br>apiServerExtraArgs:<br>  runtime-config: &quot;api&#47;all=true&quot;<br>kubernetesVersion: &quot;v1.22.0&quot;","like_count":0},{"had_liked":false,"id":305763,"user_name":"Hale","can_delete":false,"product_type":"c1","uid":1129731,"ip_address":"","ucode":"1925955343FE94","user_header":"https://static001.geekbang.org/account/avatar/00/11/3d/03/b2d9a084.jpg","comment_is_top":false,"comment_ctime":1628151851,"is_pvip":true,"discussion_count":0,"race_medal":0,"score":"1628151851","product_id":100015201,"comment_content":"master主机下为什么会有2个coredns？","like_count":0},{"had_liked":false,"id":305007,"user_name":"马成","can_delete":false,"product_type":"c1","uid":1486895,"ip_address":"","ucode":"664F2BAA2E0F0B","user_header":"https://static001.geekbang.org/account/avatar/00/16/b0/2f/e2096905.jpg","comment_is_top":false,"comment_ctime":1627746200,"is_pvip":true,"discussion_count":0,"race_medal":0,"score":"1627746200","product_id":100015201,"comment_content":"基于百度云BCC（Ubuntu16）搭建k8s当前最新版<br>```bash<br># 把k8s的key添加到本地trusted数据库中<br>$ curl https:&#47;&#47;mirrors.aliyun.com&#47;kubernetes&#47;apt&#47;doc&#47;apt-key.gpg | apt-key add -<br># 设置Ubuntu镜像源<br>$ cat &lt;&lt;EOF &gt; &#47;etc&#47;apt&#47;sources.list.d&#47;kubernetes.list<br>deb https:&#47;&#47;mirrors.aliyun.com&#47;kubernetes&#47;apt&#47; kubernetes-xenial main<br>EOF<br># 安装docker kubeadm（kubectl、kubelet等）<br>$ apt-get update &amp;&amp; apt-get install -y docker.io kubeadm<br><br><br># 查看kubeadm需要的镜像<br>$ kubeadm config images list<br># 查看kubeadm init的默认配置文件<br>$ kubeadm config print init-defaults<br><br># 解决coredns下载失败问题<br>$ docker pull coredns&#47;coredns:v1.8.0<br>$ docker tag coredns&#47;coredns:1.8.0 registry.aliyuncs.com&#47;google_containers&#47;coredns:v1.8.0<br>$ docker rmi coredns&#47;coredns:1.8.0<br># 使用阿里云镜像初始化<br>$ kubeadm init \\<br>    --image-repository registry.aliyuncs.com&#47;google_containers \\<br>    --kubernetes-version v1.21.0 \\<br>    --pod-network-cidr=10.244.0.0&#47;16<br><br># 安装weave-net网络<br>$ kubectl apply -f &quot;https:&#47;&#47;cloud.weave.works&#47;k8s&#47;net?k8s-version=$(kubectl version | base64 | tr -d &#39;\\n&#39;)&quot;<br>```","like_count":0},{"had_liked":false,"id":304193,"user_name":"小鱼儿","can_delete":false,"product_type":"c1","uid":1977516,"ip_address":"","ucode":"30EB95B7844556","user_header":"https://static001.geekbang.org/account/avatar/00/1e/2c/ac/247288f5.jpg","comment_is_top":false,"comment_ctime":1627290818,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1627290818","product_id":100015201,"comment_content":"kubeadm join 命令加入node节点：<br>kubeadm join 192.168.242.134:6443 --token if4xxg.atqhb2nhm10lecmv --discovery-token-ca-cert-hash sha256:db0b42ada8c529051a6c64ac2b0191e84985ae6408b9611cd6fad41475bd0635<br>出错：<br>configmaps &quot;kubeadm-config&quot; is forbidden: User &quot;system:bootstrap:if4xxg&quot; cannot get resource &quot;configmaps&quot; in API group &quot;&quot; in the namespace &quot;kube-system&quot;<br>failed to get config map<br>请问什么原因呢？<br>","like_count":0},{"had_liked":false,"id":303135,"user_name":"kelley·胡","can_delete":false,"product_type":"c1","uid":2520185,"ip_address":"","ucode":"D36AD16A41777A","user_header":"https://static001.geekbang.org/account/avatar/00/26/74/79/131f08b8.jpg","comment_is_top":false,"comment_ctime":1626606471,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1626606471","product_id":100015201,"comment_content":"kubeadm init --apiserver-advertise-address=192.168.245.129 --image-repository registry.aliyuncs.com&#47;google_containers --kubernetes-version v1.21.3 --service-cidr=10.1.0.0&#47;16 --pod-network-cidr=10.244.0.0&#47;16 --v=5<br>master  这样也可以启动成功, 环境为ubuntu <br>需要提前下载镜像：<br>kubeadm config images list<br><br>docker pull coredns&#47;coredns:latest <br>docker tag coredns&#47;coredns:latest registry.aliyuncs.com&#47;google_containers&#47;coredns:v1.8.0 <br>","like_count":0},{"had_liked":false,"id":299976,"user_name":"Geek_29ea79","can_delete":false,"product_type":"c1","uid":2666141,"ip_address":"","ucode":"CB3A5E18068E2D","user_header":"","comment_is_top":false,"comment_ctime":1624944658,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1624944658","product_id":100015201,"comment_content":"请教老师，我用的是1.21版本，在创建k8s集群时出现如下报错，如何处理呢？谢谢🙏<br>kubeadm init --config kubeadm_new.yaml <br>[init] Using Kubernetes version: v1.21.0<br>[preflight] Running pre-flight checks<br>[preflight] Pulling images required for setting up a Kubernetes cluster<br>[preflight] This might take a minute or two, depending on the speed of your internet connection<br>[preflight] You can also perform this action in beforehand using &#39;kubeadm config images pull&#39;<br>error execution phase preflight: [preflight] Some fatal errors occurred:<br>        [ERROR ImagePull]: failed to pull image registry.aliyuncs.com&#47;google_containers&#47;coredns:v1.8.0: output: Trying to pull repository registry.aliyuncs.com&#47;google_containers&#47;coredns ... <br>Pulling repository registry.aliyuncs.com&#47;google_containers&#47;coredns<br>Error: image google_containers&#47;coredns:v1.8.0 not found<br>, error: exit status 1<br>[preflight] If you know what you are doing, you can make a check non-fatal with `--ignore-preflight-errors=...`<br>To see the stack trace of this error execute with --v=5 or higher","like_count":0},{"had_liked":false,"id":295732,"user_name":"dobby","can_delete":false,"product_type":"c1","uid":2549097,"ip_address":"","ucode":"9C1992C4DD28F5","user_header":"https://thirdwx.qlogo.cn/mmopen/vi_32/DYAIOgq83eoib6BjEV4KPEaIdlLEfoVFRCxCSlL2XaIVDiaakvjhWEibibym323ZeHXAY46JMO3nSHmjiaWtAY47eww/132","comment_is_top":false,"comment_ctime":1622563469,"is_pvip":true,"discussion_count":0,"race_medal":0,"score":"1622563469","product_id":100015201,"comment_content":"请问老师单机可以部署master 和 node么，如果可以的话需要什么配置","like_count":0},{"had_liked":false,"id":292998,"user_name":"终结之谷瀑布","can_delete":false,"product_type":"c1","uid":2620630,"ip_address":"","ucode":"8D65D3C9E3A08F","user_header":"https://static001.geekbang.org/account/avatar/00/27/fc/d6/66ddf75f.jpg","comment_is_top":false,"comment_ctime":1621149730,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1621149730","product_id":100015201,"comment_content":"老师，我在本地创建了两个虚拟机，而后通过在路由器内写入v2ray来访问国外网站，实现了网络内所有设备无需额外设置都能连接外网，google没问题.quay也没问题，就是gcr还是连不通，请问gcr.io是有什么特殊之处吗？需要特别的dns？","like_count":0},{"had_liked":false,"id":290999,"user_name":"曾子良","can_delete":false,"product_type":"c1","uid":1856182,"ip_address":"","ucode":"3C2F7234E40451","user_header":"https://static001.geekbang.org/account/avatar/00/1c/52/b6/202076f0.jpg","comment_is_top":false,"comment_ctime":1619927280,"is_pvip":false,"discussion_count":1,"race_medal":0,"score":"1619927280","product_id":100015201,"comment_content":"我在CentOS8上搭建环境是执行初始化命令<br> kubeadm init --kubernetes-version=1.21.0 --apiserver-advertise-address=192.168.153.130  --image-repository registry.aliyuncs.com&#47;google_containers<br><br><br>报错<br>error execution phase preflight: [preflight] Some fatal errors occurred:<br>        [ERROR ImagePull]: failed to pull image registry.aliyuncs.com&#47;google_containers&#47;coredns&#47;coredns:v1.8.0: output: Error response from daemon: pull access denied for registry.aliyuncs.com&#47;google_containers&#47;coredns&#47;coredns, repository does not exist or may require &#39;docker login&#39;: denied: requested access to the resource is denied<br>, error: exit status 1<br>[preflight] If you know what you are doing, you can make a check non-fatal with `--ignore-preflight-errors=...`<br>To see the stack trace of this error execute with --v=5 or higher<br><br><br>安装的 docker 、kubectl 、kubelet、kubeadm 都是v1.21.0 的，有谁遇到过同样的问题？求解决方案，网上查了很多资料都不行","like_count":0,"discussions":[{"author":{"id":2560628,"avatar":"https://static001.geekbang.org/account/avatar/00/27/12/74/091553e3.jpg","nickname":"rkmms","note":"","ucode":"AE04CA87FF6BDF","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":375471,"discussion_content":"1.参见阿里云官网说明：https://help.aliyun.com/document_detail/60750.html?spm=a2c4g.11186623.6.560.6b5a1e96yNj9eG\n2. 目前最新版本是V1.21.X,阿里云镜像搞不定，安装V1.20.x就解决该问题了","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1621676152,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":290095,"user_name":"谨兮谨兮","can_delete":false,"product_type":"c1","uid":1376885,"ip_address":"","ucode":"55712DD3852169","user_header":"https://static001.geekbang.org/account/avatar/00/15/02/75/2839c0bb.jpg","comment_is_top":false,"comment_ctime":1619359190,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1619359190","product_id":100015201,"comment_content":"网络pod起来了  coredns居然还是pending","like_count":0},{"had_liked":false,"id":290082,"user_name":"谨兮谨兮","can_delete":false,"product_type":"c1","uid":1376885,"ip_address":"","ucode":"55712DD3852169","user_header":"https://static001.geekbang.org/account/avatar/00/15/02/75/2839c0bb.jpg","comment_is_top":false,"comment_ctime":1619351520,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1619351520","product_id":100015201,"comment_content":"部署了weave  master节点起来了  coredns没起来","like_count":0},{"had_liked":false,"id":287510,"user_name":"毕殿卿","can_delete":false,"product_type":"c1","uid":1370170,"ip_address":"","ucode":"C556AE72FF44F0","user_header":"https://static001.geekbang.org/account/avatar/00/14/e8/3a/252741d6.jpg","comment_is_top":false,"comment_ctime":1617983455,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1617983455","product_id":100015201,"comment_content":"我成功搭建了三个matser实例的高可用集群，当我破坏掉其中一个master节点时（还剩两个master节点）此时整个集群还是可以正常工作的，当我破坏掉两个master节点时（只有一个master正常），整个集群瘫痪，并且&quot;LOAD_BALANCER_DNS:LOAD_BALANCER_PORT&quot;无法访问，我没有办法恢复这个集群，请问怎么处理？","like_count":0},{"had_liked":false,"id":285635,"user_name":"Cey","can_delete":false,"product_type":"c1","uid":1238574,"ip_address":"","ucode":"E59932DED6FDBD","user_header":"https://static001.geekbang.org/account/avatar/00/12/e6/2e/da37f125.jpg","comment_is_top":false,"comment_ctime":1616931148,"is_pvip":true,"discussion_count":0,"race_medal":0,"score":"1616931148","product_id":100015201,"comment_content":"建议参考这个文章（https:&#47;&#47;www.orchome.com&#47;9900）搭建","like_count":0},{"had_liked":false,"id":284229,"user_name":"林志国","can_delete":false,"product_type":"c1","uid":2205986,"ip_address":"","ucode":"911DD43D625048","user_header":"https://static001.geekbang.org/account/avatar/00/21/a9/22/1c16950e.jpg","comment_is_top":false,"comment_ctime":1616128166,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1616128166","product_id":100015201,"comment_content":"看作者的笔记，安装kubernetes，根本就安装不上，对我这种小白来讲太痛苦了。各种报错，虽然这也是一种学习过程，但这大大阻碍了学习的乐趣。有没有完整的安装教程可以提供呢。自己解决问题效率有点低","like_count":0},{"had_liked":false,"id":280806,"user_name":"天天向上卡索","can_delete":false,"product_type":"c1","uid":1009850,"ip_address":"","ucode":"E3724C3B39BD3F","user_header":"https://static001.geekbang.org/account/avatar/00/0f/68/ba/c0cf8bf3.jpg","comment_is_top":false,"comment_ctime":1614399436,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1614399436","product_id":100015201,"comment_content":"使用 kind 部署 k8s 集群也很香","like_count":0},{"had_liked":false,"id":280069,"user_name":"lumence","can_delete":false,"product_type":"c1","uid":1144080,"ip_address":"","ucode":"00BA0ECFA6F002","user_header":"http://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTJtl3p4gcguAZy580SyoQAic79Z7QAvTcibnicV9K8x2Yzbxa8BlknwhquzTPPklaWPDDbrECQG3uurg/132","comment_is_top":false,"comment_ctime":1614069529,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1614069529","product_id":100015201,"comment_content":"kubectl apply -f https:&#47;&#47;git.io&#47;weave-kube-1.6<br>这个命令报 404 了<br>kubectl apply -f https:&#47;&#47;git.io&#47;weave-kube也报 404<br>只能使用这个<br>kubectl apply -n kube-system -f &quot;https:&#47;&#47;cloud.weave.works&#47;k8s&#47;net?k8s-version=$(kubectl version | base64 | tr -d &#39;\\n&#39;)&quot;","like_count":0},{"had_liked":false,"id":279726,"user_name":"Saka666","can_delete":false,"product_type":"c1","uid":2116699,"ip_address":"","ucode":"FC8644D9E90E49","user_header":"https://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTKIxTSS3SDJDODVhia8JUicSMuJTcicPqicnKctVkoO1g9a84b292j0Dqk7PZtic4eA9KhLdfaAT7knu4w/132","comment_is_top":false,"comment_ctime":1613928516,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1613928516","product_id":100015201,"comment_content":"使用dashboard recommended.yaml和rook github上的yaml时会造成抢占443端口，dashboar和rook-ceph-operator会crashloopbackoff","like_count":0},{"had_liked":false,"id":272211,"user_name":"Geek_8ed998","can_delete":false,"product_type":"c1","uid":1793879,"ip_address":"","ucode":"1C164836354665","user_header":"http://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTLJHTX1IwEl1Eh1CCO2ejL2gKe08Vxib61UZz9l5WGA81ObK0Nk5MCZ3ic6IWcW5kyX0DtwBNMEMl2Q/132","comment_is_top":false,"comment_ctime":1609991170,"is_pvip":false,"discussion_count":1,"race_medal":0,"score":"1609991170","product_id":100015201,"comment_content":"no matches for kind &quot;CephCluster&quot; in version &quot;ceph.rook.io&#47;v1&quot;  这个有那个大神帮忙解决一下","like_count":0,"discussions":[{"author":{"id":1311001,"avatar":"https://static001.geekbang.org/account/avatar/00/14/01/19/f4da2829.jpg","nickname":"一秒","note":"","ucode":"F149B7F60620BD","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":347203,"discussion_content":"kubectl apply -f https://raw.githubusercontent.com/rook/rook/master/cluster/examples/kubernetes/ceph/crds.yaml\n在cluster.yaml 之前还要执行下这步","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1612172358,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":269828,"user_name":"Geek_ad0591","can_delete":false,"product_type":"c1","uid":2377045,"ip_address":"","ucode":"9A224BBDCB8A09","user_header":"","comment_is_top":false,"comment_ctime":1608801126,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1608801126","product_id":100015201,"comment_content":"2020年12月24日更新<br><br>piVersion: kubeadm.k8s.io&#47;v1beta2<br>kind: ClusterConfiguration<br>controllerManagerExtraArgs:<br>  horizontal-pod-autoscaler-use-rest-clients: &quot;true&quot;<br>  horizontal-pod-autoscaler-sync-period: &quot;10s&quot;<br>  node-monitor-grace-period: &quot;10s&quot;<br>apiServerExtraArgs:<br>  runtime-config: &quot;api&#47;all=true&quot;<br>kubernetesVersion: &quot;stable-1.20&quot;","like_count":0},{"had_liked":false,"id":268679,"user_name":"njleon007","can_delete":false,"product_type":"c1","uid":2026567,"ip_address":"","ucode":"54F38C1C834598","user_header":"https://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTLvfic0yoAJYvT08jxcrExhr4xJ6twJv18q0ka2QmDUr4R6dXszjQJgQib7HPLAykMefBkO1AWqWhQQ/132","comment_is_top":false,"comment_ctime":1608291105,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1608291105","product_id":100015201,"comment_content":"ubuntu自带的snap安装了mircok8s，直接在公司内部完成CI&#47;CD的容器化构建，发现也有8个节点了，安装很方便。","like_count":0},{"had_liked":false,"id":268417,"user_name":"starty156","can_delete":false,"product_type":"c1","uid":1268547,"ip_address":"","ucode":"C26FCEB8E8228E","user_header":"","comment_is_top":false,"comment_ctime":1608187615,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1608187615","product_id":100015201,"comment_content":"我试了很多次，始终也无法部署成功，报错如下：<br>                Unfortunately, an error has occurred:<br>                        timed out waiting for the condition<br><br>                This error is likely caused by:<br>                        - The kubelet is not running<br>                        - The kubelet is unhealthy due to a misconfiguration of the node in some way (required cgroups disabled)<br>                        - No internet connection is available so the kubelet cannot pull or find the following control plane images:<br>                                - registry.aliyuncs.com&#47;google_containers&#47;kube-apiserver-amd64:v1.11.1<br>                                - registry.aliyuncs.com&#47;google_containers&#47;kube-controller-manager-amd64:v1.11.1<br>                                - registry.aliyuncs.com&#47;google_containers&#47;kube-scheduler-amd64:v1.11.1<br>                                - registry.aliyuncs.com&#47;google_containers&#47;etcd-amd64:3.2.18<br>                                - You can check or miligate this in beforehand with &quot;kubeadm config images pull&quot; to make sure the images<br>                                  are downloaded locally and cached.<br><br>                If you are on a systemd-powered system, you can try to troubleshoot the error with the following commands:<br>                        - &#39;systemctl status kubelet&#39;<br>                        - &#39;journalctl -xeu kubelet&#39;<br><br>                Additionally, a control plane component may have crashed or exited when started by the container runtime.<br>                To troubleshoot, list all containers using your preferred container runtimes CLI, e.g. docker.<br>                Here is one example how you may list all Kubernetes containers running in docker:<br>                        - &#39;docker ps -a | grep kube | grep -v pause&#39;<br>                        Once you have found the failing container, you can inspect its logs with:<br>                        - &#39;docker logs CONTAINERID&#39;<br>couldn&#39;t initialize a Kubernetes cluster","like_count":0},{"had_liked":false,"id":266599,"user_name":"陈念念","can_delete":false,"product_type":"c1","uid":1179137,"ip_address":"","ucode":"6B1C104F48499F","user_header":"https://static001.geekbang.org/account/avatar/00/11/fe/01/dedbf09a.jpg","comment_is_top":false,"comment_ctime":1607411400,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1607411400","product_id":100015201,"comment_content":"centos7 单机k8s终于在墙内搭好了，写了篇教程欢迎后来者直接享用 <br> https:&#47;&#47;www.yuque.com&#47;chenniannian&#47;kb&#47;pnidwn","like_count":0},{"had_liked":false,"id":266033,"user_name":"姚树标","can_delete":false,"product_type":"c1","uid":1648886,"ip_address":"","ucode":"ABC568658E2694","user_header":"https://static001.geekbang.org/account/avatar/00/19/28/f6/fa6a5658.jpg","comment_is_top":false,"comment_ctime":1607138061,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1607138061","product_id":100015201,"comment_content":"版本问题和翻墙问题 卡的我过不去了 求指导","like_count":0},{"had_liked":false,"id":261761,"user_name":"Mr、小露","can_delete":false,"product_type":"c1","uid":2033111,"ip_address":"","ucode":"90CEEC4AFBA4CA","user_header":"https://static001.geekbang.org/account/avatar/00/1f/05/d7/4ba3be13.jpg","comment_is_top":false,"comment_ctime":1605515576,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1605515576","product_id":100015201,"comment_content":"老师有liunx安装过程吗","like_count":0},{"had_liked":false,"id":257470,"user_name":"朱雯","can_delete":false,"product_type":"c1","uid":1035744,"ip_address":"","ucode":"064C45FBF6B51F","user_header":"https://static001.geekbang.org/account/avatar/00/0f/cd/e0/c85bb948.jpg","comment_is_top":false,"comment_ctime":1603981286,"is_pvip":true,"discussion_count":0,"race_medal":0,"score":"1603981286","product_id":100015201,"comment_content":"我的容器是从通过其他课程视频学到的，但是这节课依旧学了一些东西，总结一下：<br>1.无状态，我的理解是，如果容器处于不同的mount namespace，相互变化看不到，也就是无状态变化，所以叫无状态，想改变这种情况就必须安装存储服务。<br>2. rook是一种存储方式<br>3. 污点系统的存在，为什么master分之不能分布pod<br>","like_count":0},{"had_liked":false,"id":256469,"user_name":"好运来","can_delete":false,"product_type":"c1","uid":1113937,"ip_address":"","ucode":"F469ED6CEFEF30","user_header":"https://static001.geekbang.org/account/avatar/00/10/ff/51/9d5cfadd.jpg","comment_is_top":false,"comment_ctime":1603631335,"is_pvip":true,"discussion_count":0,"race_medal":1,"score":"1603631335","product_id":100015201,"comment_content":"基于kubeadm搭建原生k8s集群(1主2从)，踩了很多坑，用博客记录了搭建过程，感兴趣点击下面链接:<br>https:&#47;&#47;hancaihaoyun.gitee.io&#47;blog&#47;2020&#47;10&#47;18&#47;%E4%BD%BF%E7%94%A8kubeadm%E5%AE%89%E8%A3%85kubernetes%E9%9B%86%E7%BE%A4&#47;","like_count":0},{"had_liked":false,"id":247149,"user_name":"M1racle","can_delete":false,"product_type":"c1","uid":1057144,"ip_address":"","ucode":"CFA981F34AFDA8","user_header":"https://static001.geekbang.org/account/avatar/00/10/21/78/732a2e33.jpg","comment_is_top":false,"comment_ctime":1599618631,"is_pvip":true,"discussion_count":0,"race_medal":0,"score":"1599618631","product_id":100015201,"comment_content":"1.18 可用的配置文件<br>apiVersion: kubeadm.k8s.io&#47;v1beta2<br>kind: ClusterConfiguration<br>controllerManager:<br>  extraArgs:<br>    horizontal-pod-autoscaler-use-rest-clients: &quot;true&quot;<br>    horizontal-pod-autoscaler-sync-period: &quot;10s&quot;<br>    node-monitor-grace-period: &quot;10s&quot;<br>apiServer:<br>    extraArgs:<br>        runtime-config: &quot;api&#47;all=true&quot;<br>kubernetesVersion: &quot;stable-1.18&quot;","like_count":0},{"had_liked":false,"id":245895,"user_name":"Heaven","can_delete":false,"product_type":"c1","uid":1694207,"ip_address":"","ucode":"FA33FBCC66C911","user_header":"https://static001.geekbang.org/account/avatar/00/19/d9/ff/b23018a6.jpg","comment_is_top":false,"comment_ctime":1599103603,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1599103603","product_id":100015201,"comment_content":"公司正好有闲置的国外AWS节点,就简单的部署了下<br>2.对于集群来说,我们将整个集群认为是一个大型的工作节点,那么集群内的可以分为多少个节点首先取决于集群的性能之和,比如我们的性能之和是32个CPU,128G内存,那么可以分为8个 4核16G的节点","like_count":0},{"had_liked":false,"id":243179,"user_name":"stefen","can_delete":false,"product_type":"c1","uid":1202047,"ip_address":"","ucode":"7C9AAE829E7802","user_header":"http://thirdwx.qlogo.cn/mmopen/vi_32/oib0a89lqtOhJL1UvfUp4uTsRLrDbhoGk9jLiciazxMu0COibJsFCZDypK1ZFcHEJc9d9qgbjvgR41ImL6FNPoVlWA/132","comment_is_top":false,"comment_ctime":1597983303,"is_pvip":false,"discussion_count":0,"race_medal":1,"score":"1597983303","product_id":100015201,"comment_content":"parallels@parallels-Parallels-Virtual-Platform:~&#47;Documents&#47;Kubernetes$ kubeadm init --config kubeadm.yaml <br>your configuration file uses an old API spec: &quot;kubeadm.k8s.io&#47;v1alpha1&quot;. Please use kubeadm v1.11 instead and run &#39;kubeadm config migrate --old-config old.yaml --new-config new.yaml&#39;, which will write the new, similar spec using a newer API version.<br>To see the stack trace of this error execute with --v=5 or higher<br><br>把API版本太旧，什么意思哦<br>","like_count":0},{"had_liked":false,"id":239067,"user_name":"supakito","can_delete":false,"product_type":"c1","uid":1387156,"ip_address":"","ucode":"3060AB5E0D4E24","user_header":"http://thirdwx.qlogo.cn/mmopen/vi_32/gKnIR8mga02s9xdQoxyJBibmuxHGhfQ8WZicia3Ie4wBQKg4Zc1oVoS03mvaCD46je9xCza25qXc3w6KMckpS0BqQ/132","comment_is_top":false,"comment_ctime":1596425559,"is_pvip":false,"discussion_count":2,"race_medal":0,"score":"1596425559","product_id":100015201,"comment_content":"有没有人遇到过安装weave后，coredns报错：CrashLoopBackOff","like_count":0,"discussions":[{"author":{"id":1121758,"avatar":"https://static001.geekbang.org/account/avatar/00/11/1d/de/62bfa83f.jpg","nickname":"aoe","note":"","ucode":"1C6201EDB4E954","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":307635,"discussion_content":"遇到了，重启服务器，在重新安装一次，主要看报错日志。就算这个成功了，后面的路还很长。现在在评论中找灵感。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1600701658,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1161368,"avatar":"https://static001.geekbang.org/account/avatar/00/11/b8/98/ce254cef.jpg","nickname":"涟漪","note":"","ucode":"2D643A25097FF5","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":296878,"discussion_content":"没有遇到嗯","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1596694089,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":238794,"user_name":"lidashuang","can_delete":false,"product_type":"c1","uid":1104850,"ip_address":"","ucode":"560ABE8032760E","user_header":"https://static001.geekbang.org/account/avatar/00/10/db/d2/e29f8834.jpg","comment_is_top":false,"comment_ctime":1596300131,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1596300131","product_id":100015201,"comment_content":"安装wave 最新文档<br>https:&#47;&#47;www.weave.works&#47;docs&#47;net&#47;latest&#47;kubernetes&#47;kube-addon&#47;","like_count":0},{"had_liked":false,"id":236732,"user_name":"黄伟洪","can_delete":false,"product_type":"c1","uid":1369165,"ip_address":"","ucode":"97331040A49EAD","user_header":"https://static001.geekbang.org/account/avatar/00/14/e4/4d/c7b5f20a.jpg","comment_is_top":false,"comment_ctime":1595513921,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1595513921","product_id":100015201,"comment_content":"战斗了好久，平时没什么时间，但最后还是成功了。经历过科学上网失败，最后还是改了aliyun-cn。提供yaml文件供大家分享。<br>apiVersion: kubeadm.k8s.io&#47;v1beta2<br>kind: ClusterConfiguration<br>controllerManager:<br>  extraArgs:<br>    horizontal-pod-autoscaler-use-rest-clients: &quot;true&quot;<br>    horizontal-pod-autoscaler-sync-period: &quot;10s&quot;<br>    node-monitor-grace-period: &quot;10s&quot;<br>apiServer:<br>  extraArgs: <br>    runtime-config: &quot;api&#47;all=true&quot;<br>imageRepository: registry.cn-hangzhou.aliyuncs.com&#47;google_containers<br>kubernetesVersion: &quot;v1.18.0&quot;<br><br>","like_count":0},{"had_liked":false,"id":235794,"user_name":"友志","can_delete":false,"product_type":"c1","uid":1310564,"ip_address":"","ucode":"913344CDF17620","user_header":"https://static001.geekbang.org/account/avatar/00/13/ff/64/76b0dac8.jpg","comment_is_top":false,"comment_ctime":1595205374,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1595205374","product_id":100015201,"comment_content":"你好，请问下直接搭建集群内网络规划老师建议使用B类还是C类网络呢？","like_count":0},{"had_liked":false,"id":235522,"user_name":"君哥聊技术","can_delete":false,"product_type":"c1","uid":1325816,"ip_address":"","ucode":"2C9A22BCE4C79E","user_header":"https://static001.geekbang.org/account/avatar/00/14/3a/f8/c1a939e7.jpg","comment_is_top":false,"comment_ctime":1595072946,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1595072946","product_id":100015201,"comment_content":"老师，部署Rook时失败，看了日志，是因为我用vmware的原因吗？<br><br>Message:&quot;customresourcedefinitions.apiextensions.k8s.io is forbidden: User \\&quot;system:serviceaccount:rook-ceph:rook-csi-rbd-provisioner-sa\\&quot; cannot create resource \\&quot;customresourcedefinitions\\&quot; in API group \\&quot;apiextensions.k8s.io\\&quot; at the cluster scope&quot;, Reason:&quot;Forbidden&quot;, Details:(*v1.StatusDetails)(0xc0003cc780), Code:403}}","like_count":0},{"had_liked":false,"id":226579,"user_name":"晞月520","can_delete":false,"product_type":"c1","uid":1845394,"ip_address":"","ucode":"4F05E02A5C1608","user_header":"https://static001.geekbang.org/account/avatar/00/1c/28/92/436735f5.jpg","comment_is_top":false,"comment_ctime":1592144791,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1592144791","product_id":100015201,"comment_content":"二进制部署 部署了一个多星期算好了","like_count":0},{"had_liked":false,"id":225176,"user_name":"Geek_cf2028","can_delete":false,"product_type":"c1","uid":1582653,"ip_address":"","ucode":"8C4417E024A817","user_header":"http://thirdwx.qlogo.cn/mmopen/vi_32/DYAIOgq83ep8bWkhQUsZRYaoWhWpTKsoSSx7avG2GlvGXYGrfiaiaur9LkTFWeHnuTvyqQN1W1ibJ5pnamB2a92lQ/132","comment_is_top":false,"comment_ctime":1591673995,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1591673995","product_id":100015201,"comment_content":"kubeadm+dashboard+rook ceph完成","like_count":0},{"had_liked":false,"id":224114,"user_name":"励研冰","can_delete":false,"product_type":"c1","uid":1106394,"ip_address":"","ucode":"FCBC8266018FA0","user_header":"https://static001.geekbang.org/account/avatar/00/10/e1/da/d7f591a7.jpg","comment_is_top":false,"comment_ctime":1591277554,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1591277554","product_id":100015201,"comment_content":"大家这一节的rook-ceph有装成功吗？我用最新的release1.3安装之后没有生成ceph-osd***容器，在后续实战mysql集群的时候一直有问题，回过头来问下，其他我经过重重困难都完成了","like_count":0},{"had_liked":false,"id":224074,"user_name":"曹顺详","can_delete":false,"product_type":"c1","uid":2012814,"ip_address":"","ucode":"FAF35A88EB207D","user_header":"https://static001.geekbang.org/account/avatar/00/1e/b6/8e/bc83bcae.jpg","comment_is_top":false,"comment_ctime":1591266783,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1591266783","product_id":100015201,"comment_content":"老师好，请教个问题，kube-proxy的IPVS模式的配置我的是这样的<br>apiVersion: kubeproxy.config.k8s.io&#47;v1alpha1<br>kind: KubeProxyConfiguration<br>address: 172.18.70.72<br>metricsBindAddress: 172.18.70.72:10249<br>clientConnection:<br>  kubeconfig: &#47;usr&#47;local&#47;kubernetes&#47;cfg&#47;kube-proxy.kubeconfig<br>hostnameOverride: 172.18.70.72<br>clusterCIDR: 10.240.0.0&#47;16<br>mode: ipvs<br>ipvs:<br>  scheduler: &quot;rr&quot;<br>iptables:<br>  masqueradeAll: false<br><br>想问下，clusterCIDR: 10.240.0.0&#47;16和iptables:<br>  masqueradeAll: false这两个配置是不是应该去掉，不去掉的话，是不是降级为了iptables了？","like_count":0},{"had_liked":false,"id":223815,"user_name":"qazwsx","can_delete":false,"product_type":"c1","uid":1366505,"ip_address":"","ucode":"E8F6D7FD26C34F","user_header":"https://static001.geekbang.org/account/avatar/00/14/d9/e9/eaa1222d.jpg","comment_is_top":false,"comment_ctime":1591187297,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1591187297","product_id":100015201,"comment_content":"安装weave时,不同k8s版本能使用的weave版本不一样我的k8s 1.17.6 无法装weave-1.6。<br>使用<br> kubectl apply -f &quot;https:&#47;&#47;cloud.weave.works&#47;k8s&#47;net?k8s-version=$(kubectl version | base64 | tr -d &#39;\\n&#39;)&quot;<br>可以安装成功k8s适配的版本。","like_count":0},{"had_liked":false,"id":223799,"user_name":"励研冰","can_delete":false,"product_type":"c1","uid":1106394,"ip_address":"","ucode":"FCBC8266018FA0","user_header":"https://static001.geekbang.org/account/avatar/00/10/e1/da/d7f591a7.jpg","comment_is_top":false,"comment_ctime":1591183220,"is_pvip":false,"discussion_count":1,"race_medal":0,"score":"1591183220","product_id":100015201,"comment_content":"在部署ceph时有一个pod rook-ceph-crashcollector-xxxxx 一直是 0&#47;1     Init:0&#47;2 状态；通过kubectl describe 查看发现 <br>MountVolume.SetUp failed for volume &quot;rook-ceph-crash-collector-keyring&quot; : secret &quot;rook-ceph-crash-collector-keyring&quot; not found<br>Unable to attach or mount volumes: unmounted volumes=[rook-ceph-crash-collector-keyring], unattached volumes=[rook-ceph-crash-collector-keyring rook-config-override rook-ceph-log rook-ceph-crash default-token-65q7n]: timed out waiting for the condition<br>没找到怎么解决问题，有谁遇到过这个问题吗？","like_count":0,"discussions":[{"author":{"id":1106394,"avatar":"https://static001.geekbang.org/account/avatar/00/10/e1/da/d7f591a7.jpg","nickname":"励研冰","note":"","ucode":"FCBC8266018FA0","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":278894,"discussion_content":"通过Google找到了解决方案 kubectl -n rook-ceph create secret generic rook-ceph-crash-collector-keyring\n顺便贴下链接：https://github.com/rook/rook/issues/4553","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1591253029,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":220837,"user_name":"lasdaybg","can_delete":false,"product_type":"c1","uid":1053818,"ip_address":"","ucode":"C292CF7263ED81","user_header":"https://static001.geekbang.org/account/avatar/00/10/14/7a/7b8dd310.jpg","comment_is_top":false,"comment_ctime":1590328486,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1590328486","product_id":100015201,"comment_content":"看评论，发现问题最多的就是关于版本号的问题，这个问题有什么更通用的解决方法吗？还是每次k8s更新了，都要重新寻找合适的版本？","like_count":0},{"had_liked":false,"id":219569,"user_name":"励研冰","can_delete":false,"product_type":"c1","uid":1106394,"ip_address":"","ucode":"FCBC8266018FA0","user_header":"https://static001.geekbang.org/account/avatar/00/10/e1/da/d7f591a7.jpg","comment_is_top":false,"comment_ctime":1590044250,"is_pvip":false,"discussion_count":4,"race_medal":0,"score":"1590044250","product_id":100015201,"comment_content":"这一节搞了好几天，到处查资料，终于全部搞定！本机搭建三台centos7虚拟机，整个集群为了练手反复搭建了三次！！！我的mac只有8G内存，有点吃不住","like_count":0,"discussions":[{"author":{"id":1129976,"avatar":"https://static001.geekbang.org/account/avatar/00/11/3d/f8/b13674e6.jpg","nickname":"LiYanbin","note":"","ucode":"2F50493F818909","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":272424,"discussion_content":"同学，搭建成功了吗，可否分享下搭建过程，谢谢🙏","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1590304382,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":3,"child_discussions":[{"author":{"id":1106394,"avatar":"https://static001.geekbang.org/account/avatar/00/10/e1/da/d7f591a7.jpg","nickname":"励研冰","note":"","ucode":"FCBC8266018FA0","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":1129976,"avatar":"https://static001.geekbang.org/account/avatar/00/11/3d/f8/b13674e6.jpg","nickname":"LiYanbin","note":"","ucode":"2F50493F818909","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":272873,"discussion_content":"我这边除了最后的存储插件因为我mac内存太小了，调度不成功而且超级卡我就删掉了！其他的全部成功！我整理下流程发给你","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1590370133,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":272424,"ip_address":""},"score":272873,"extra":""},{"author":{"id":1106394,"avatar":"https://static001.geekbang.org/account/avatar/00/10/e1/da/d7f591a7.jpg","nickname":"励研冰","note":"","ucode":"FCBC8266018FA0","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":1129976,"avatar":"https://static001.geekbang.org/account/avatar/00/11/3d/f8/b13674e6.jpg","nickname":"LiYanbin","note":"","ucode":"2F50493F818909","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":273744,"discussion_content":"整理了下放在简书上了 https://www.jianshu.com/p/a30e323fe04d","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1590496178,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":272424,"ip_address":""},"score":273744,"extra":""},{"author":{"id":1129976,"avatar":"https://static001.geekbang.org/account/avatar/00/11/3d/f8/b13674e6.jpg","nickname":"LiYanbin","note":"","ucode":"2F50493F818909","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":1106394,"avatar":"https://static001.geekbang.org/account/avatar/00/10/e1/da/d7f591a7.jpg","nickname":"励研冰","note":"","ucode":"FCBC8266018FA0","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":274026,"discussion_content":"好，谢谢哈～","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1590537711,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":273744,"ip_address":""},"score":274026,"extra":""}]}]},{"had_liked":false,"id":217786,"user_name":"天堂中人","can_delete":false,"product_type":"c1","uid":1742153,"ip_address":"","ucode":"02F11C403873D5","user_header":"http://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTIGFiaPwXdawaw33pJlIQLGvxsly9GGYHPkjicX4Pdz2fiaPnd27C2elcmC6bIiaxmjbsV3AicT3c4Zbyw/132","comment_is_top":false,"comment_ctime":1589613926,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1589613926","product_id":100015201,"comment_content":"老师 我想问一下 用 kubeadm 安装k8s 为什么在&#47;usr&#47;lib&#47;systemd&#47;system 目录下为什么没有生成任何有关于服务地方文件 比如说 kube-proxy.service之类的","like_count":0},{"had_liked":false,"id":215979,"user_name":"辉晖","can_delete":false,"product_type":"c1","uid":1574062,"ip_address":"","ucode":"E5EC033EE4952B","user_header":"https://static001.geekbang.org/account/avatar/00/18/04/ae/0118c132.jpg","comment_is_top":false,"comment_ctime":1589162380,"is_pvip":false,"discussion_count":1,"race_medal":0,"score":"1589162380","product_id":100015201,"comment_content":"老师，存储插件rook-ceph rook-ceph-mon开头的容器一直重启，提示0&#47;2 nodes are available: 2 node(s) didn&#39;t match pod affinity&#47;anti-affinity, 2 node(s) didn&#39;t satisfy existing pods anti-affinity rules。可是我查nodes状态都是ready啊。要怎么处理呢？","like_count":0,"discussions":[{"author":{"id":1106394,"avatar":"https://static001.geekbang.org/account/avatar/00/10/e1/da/d7f591a7.jpg","nickname":"励研冰","note":"","ucode":"FCBC8266018FA0","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":278263,"discussion_content":"我也遇到这个问题；各种找资料；目前也没解决？你那边解决了没？","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1591165865,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":213961,"user_name":"奔跑","can_delete":false,"product_type":"c1","uid":1361556,"ip_address":"","ucode":"A64A0DCA50D9FA","user_header":"https://static001.geekbang.org/account/avatar/00/14/c6/94/48ca3281.jpg","comment_is_top":false,"comment_ctime":1588600792,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1588600792","product_id":100015201,"comment_content":"老师，我用的kubernetes1.12.8版本。我直接kebuadm init --kubernetes-version=***，可以正常启动；但是，kubeadm config print-default 》init.yaml生成默认配置文件再改里面的版本号，kubeadm init --config ***启动，为什么就报错呢？配置文件还有哪里需要改动？","like_count":0},{"had_liked":false,"id":213896,"user_name":"极客土豆","can_delete":false,"product_type":"c1","uid":1179126,"ip_address":"","ucode":"CE48C42B8CBE17","user_header":"https://thirdwx.qlogo.cn/mmopen/vi_32/DYAIOgq83eoOFQ3PxxaIRbdp5o3pNxwyrBl2lyK4Il08cF4ZvXpeAhP5WJA0Rw482WibqweYBnviaX8SdO5Bak8g/132","comment_is_top":false,"comment_ctime":1588586437,"is_pvip":true,"discussion_count":0,"race_medal":0,"score":"1588586437","product_id":100015201,"comment_content":"非常棒的课程，感谢作者。<br>分享两年前接触Kubernetes时看过的一篇文章辅助理解K8S的master组件关系：<br>https:&#47;&#47;www.ulam.io&#47;blog&#47;kubernetes-scratch&#47;","like_count":0},{"had_liked":false,"id":213258,"user_name":"lasdaybg","can_delete":false,"product_type":"c1","uid":1053818,"ip_address":"","ucode":"C292CF7263ED81","user_header":"https://static001.geekbang.org/account/avatar/00/10/14/7a/7b8dd310.jpg","comment_is_top":false,"comment_ctime":1588341904,"is_pvip":false,"discussion_count":1,"race_medal":0,"score":"1588341904","product_id":100015201,"comment_content":"gcr.io的镜像拉不下来，这个是怎么解决的？","like_count":0,"discussions":[{"author":{"id":1195100,"avatar":"https://static001.geekbang.org/account/avatar/00/12/3c/5c/5dee2ab3.jpg","nickname":"solu","note":"","ucode":"C4EBFC53B511F0","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":534058,"discussion_content":"替换为阿里云的: registry.aliyuncs.com/google_containers","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1638081811,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":212384,"user_name":"张三","can_delete":false,"product_type":"c1","uid":1004092,"ip_address":"","ucode":"1155528FAE1546","user_header":"https://static001.geekbang.org/account/avatar/00/0f/52/3c/d6fcb93a.jpg","comment_is_top":false,"comment_ctime":1588107339,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1588107339","product_id":100015201,"comment_content":"看第二遍更爽！谢谢老师","like_count":0},{"had_liked":false,"id":207492,"user_name":"Cybertrunk","can_delete":false,"product_type":"c1","uid":1011174,"ip_address":"","ucode":"D557A710E1835F","user_header":"https://static001.geekbang.org/account/avatar/00/0f/6d/e6/57bfae83.jpg","comment_is_top":false,"comment_ctime":1587092745,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1587092745","product_id":100015201,"comment_content":"weave pod遇到问题：求指点<br>NAME                                          READY   STATUS             RESTARTS   AGE<br>weave-net-dw4sj                            2&#47;2     Running                   0          39h<br>weave-net-gh4zx                            1&#47;2     CrashLoopBackOff   427        39h<br>weave-net-vbw6h                           1&#47;2     CrashLoopBackOff   426        39h<br>weave-net-vgw5n                           1&#47;2     CrashLoopBackOff   426        39h<br>。。。。。。<br>Events:<br>  Type     Reason     Age                     From                         Message<br>  ----     ------     ----                    ----                         -------<br>  Warning  BackOff    10m (x9932 over 39h)    kubelet, eckaction-node1-48  Back-off restarting failed container<br>  Warning  Unhealthy  5m43s (x1276 over 39h)  kubelet, eckaction-node1-48  Readiness probe failed: Get http:&#47;&#47;127.0.0.1:6784&#47;status: dial tcp 127.0.0.1:6784: connect: connection refused<br>。。。。。。<br>","like_count":0},{"had_liked":false,"id":207490,"user_name":"Cybertrunk","can_delete":false,"product_type":"c1","uid":1011174,"ip_address":"","ucode":"D557A710E1835F","user_header":"https://static001.geekbang.org/account/avatar/00/0f/6d/e6/57bfae83.jpg","comment_is_top":false,"comment_ctime":1587092154,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1587092154","product_id":100015201,"comment_content":"1. worker 节点是否也要安装weave 网络插件？<br>2. 如果需要进行这个实验的化，哪些节点要被Taint？<br>3. 文字修改的一个pod 的yaml文件是哪儿来的？这些实验需要进行下去的化需要做那些针对Tolerations的修改吗？","like_count":0},{"had_liked":false,"id":207100,"user_name":"Cybertrunk","can_delete":false,"product_type":"c1","uid":1011174,"ip_address":"","ucode":"D557A710E1835F","user_header":"https://static001.geekbang.org/account/avatar/00/0f/6d/e6/57bfae83.jpg","comment_is_top":false,"comment_ctime":1587006548,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1587006548","product_id":100015201,"comment_content":"## 给自己加了些难度<br>- 4台物理机<br>- 每台物理机上用vagrant跑virtualbox虚机作为node<br>- k8s Cluster全部用vagrant up拉起来<br>## check up<br>https:&#47;&#47;github.com&#47;leiwng&#47;eckAction<br>## issue fixed<br> - node: error execution phase preflight: couldn&#39;t validate the identity of the API Server: Get https:&#47;&#47;10.0.2.15:6443&#47;api&#47;v1&#47;namespaces&#47;kube-public&#47;configmaps&#47;cluster-info?timeout=10s: dial tcp 10.0.2.15:6443: connect: connection refused<br> - There was an error while executing `VBoxManage`, a CLI used by Vagrant<br>for controlling VirtualBox. The command and stderr is shown below.<br>Command: [&quot;startvm&quot;, &quot;cd99bd67-48e4-4a45-bf27-e9a45f0528ef&quot;, &quot;--type&quot;, &quot;headless&quot;]<br>Stderr: VBoxManage: error: VT-x is disabled in the BIOS for all CPU modes (VERR_VMX_MSR_ALL_VMX_DISABLED)<br>VBoxManage: error: Details: code NS_ERROR_FAILURE (0x80004005), component ConsoleWrap, interface IConsole<br> - network plugin deployment issue<br>  kubectl apply -f &quot;https:&#47;&#47;frontend.dev.weave.works&#47;k8s&#47;net?k8s-version=$(kubectl version | base64 | tr -d &#39;\\n&#39;)&quot;<br>Error 1:<br>unable to recognize &quot;kube-flannel.yml&quot;: no matches for kind &quot;DaemonSet&quot; in version &quot;extensions&#47;v1beta1&quot;<br>Solution Source:<br>https:&#47;&#47;stackoverflow.com&#47;questions&#47;58971938&#47;unable-to-recognize-kube-flannel-yml-no-matches-for-kind-daemonset-in-versi<br>Fixed:<br>https:&#47;&#47;raw.githubusercontent.com&#47;coreos&#47;flannel&#47;v0.9.1&#47;Documentation&#47;kube-flannel.yml<br>=&gt;chg to:<br>https:&#47;&#47;raw.githubusercontent.com&#47;coreos&#47;flannel&#47;master&#47;Documentation&#47;kube-flannel.yml<br>Error 2:<br>dpkg-preconfigure: unable to re-open stdin: No such file or directory<br>- chg ubuntu&#47;xenial64 box url to https:&#47;&#47;mirrors.tuna.tsinghua.edu.cn&#47;ubuntu-cloud-images&#47;xenial&#47;current&#47;xenial-server-cloudimg-amd64-vagrant.box<br>- there  ","like_count":0},{"had_liked":false,"id":206917,"user_name":"X中倪","can_delete":false,"product_type":"c1","uid":1418862,"ip_address":"","ucode":"F28FAFF2FEDD1A","user_header":"https://static001.geekbang.org/account/avatar/00/15/a6/6e/21907ff9.jpg","comment_is_top":false,"comment_ctime":1586956624,"is_pvip":false,"discussion_count":1,"race_medal":0,"score":"1586956624","product_id":100015201,"comment_content":"我内网不互通咋个办。一台京东云 一台百度云。jd作为master 。baidu做为slave。部署calico的时候 卡住了。当slave 加入的时候  slave节点 中的calico 容器就会出错。搞了几天了","like_count":0,"discussions":[{"author":{"id":1251835,"avatar":"http://thirdwx.qlogo.cn/mmopen/vi_32/oiboHpgukqib2ASXeU0H7W1ibgRMqyrNE5KaWicicPEDy0ia8YdoneZAtvW0EFIiaqZJp2OS4dnweOgXaJ5EjJicicEqic5A/132","nickname":"覃钰栋","note":"","ucode":"19080C463658EF","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":414525,"discussion_content":"遇到同一个问题\n","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1636803803,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":204512,"user_name":"无赖。","can_delete":false,"product_type":"c1","uid":1618336,"ip_address":"","ucode":"3AB543E52F8077","user_header":"https://static001.geekbang.org/account/avatar/00/18/b1/a0/50fc6a23.jpg","comment_is_top":false,"comment_ctime":1586413424,"is_pvip":false,"discussion_count":1,"race_medal":0,"score":"1586413424","product_id":100015201,"comment_content":"部署worker节点的过程中  是不是没有kubeadm init这一步骤","like_count":0,"discussions":[{"author":{"id":1251835,"avatar":"http://thirdwx.qlogo.cn/mmopen/vi_32/oiboHpgukqib2ASXeU0H7W1ibgRMqyrNE5KaWicicPEDy0ia8YdoneZAtvW0EFIiaqZJp2OS4dnweOgXaJ5EjJicicEqic5A/132","nickname":"覃钰栋","note":"","ucode":"19080C463658EF","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":414527,"discussion_content":"是的，没有\n","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1636803950,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":200870,"user_name":"Sean","can_delete":false,"product_type":"c1","uid":1118697,"ip_address":"","ucode":"D24A03CD491F23","user_header":"https://static001.geekbang.org/account/avatar/00/11/11/e9/acd1654c.jpg","comment_is_top":false,"comment_ctime":1585664440,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1585664440","product_id":100015201,"comment_content":"v1.18.0版本，官网提供了很多网络插件，我选择的kube-router安装，最后查看状态时候，发现crash了","like_count":0},{"had_liked":false,"id":197215,"user_name":"瑞文","can_delete":false,"product_type":"c1","uid":1335519,"ip_address":"","ucode":"CD79DC8C04ED16","user_header":"https://static001.geekbang.org/account/avatar/00/14/60/df/57ad85c0.jpg","comment_is_top":false,"comment_ctime":1585363480,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1585363480","product_id":100015201,"comment_content":"内容讲解的真好","like_count":0},{"had_liked":false,"id":195475,"user_name":"LindaWang","can_delete":false,"product_type":"c1","uid":1800128,"ip_address":"","ucode":"45368868C3980B","user_header":"https://static001.geekbang.org/account/avatar/00/1b/77/c0/22872965.jpg","comment_is_top":false,"comment_ctime":1585190420,"is_pvip":false,"discussion_count":1,"race_medal":0,"score":"1585190420","product_id":100015201,"comment_content":"张老师，为什么在部署master和worker节点的时候，需要disable swap分区呢？ [ERROR Swap]: running with swap on is not supported. Please disable swap","like_count":0,"discussions":[{"author":{"id":2930234,"avatar":"https://thirdwx.qlogo.cn/mmopen/vi_32/KqZeIjNOVQJnsIFkDBWl5wfaxWDGLpIMUdFbF7SQhXFavmxgpwQPj9FrGAV4xNrqd733qicT4IZVibELyziaLokDQ/132","nickname":"罗艺","note":"","ucode":"9D4E1A377BCF23","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":570353,"discussion_content":"swap &amp; kubelet\n进一步了解一下，为什么 swap 打开对 kubelet 来说会是一个需要直接退出进程的错误呢？？\n\n参考 Why disable swap on kubernetes 和 Kubelet needs to allow configuration of container memory-swap #7294, 得出基本的知识总结:\n\n一开始大家在讨论的是，如果容许 Pod 使用 Swap，应该怎么去衡量默认的 Swap 设置，以及调度器应该如何根据 Swap 来进行调度？\n讨论了一段时间后，发现支持 Swap 很复杂。。。总之就是很复杂。一位大佬站出来说，真的有需要用到 Swap 的场景么？\n然后大家就开始批判起 Swap 来了，Swap 带来各种性能上的不确定性啦，而且也找不到哪些场景一定要用 Swap 啦，经过大家高兴地一致决定，Swap 这个东西真的是有害而无利，而且要用起来还复杂，就是不用它好了(K8S 1.5版本)。\n然后如果有人想用？一开始还是支持通过参数配置使用的，后来发现一个不推荐的用法，有人非得用，代码上各种坑，还不如大家一起坚决不用好了。\n然后到了1.8后就是默认不用了，除非你强制打开，官方强烈不推荐，踩坑自己负责。\n看 Issue 主要是觉得这个过程实在是一个很典型的，功能要不要的讨论，说来说去，没有明确的用户场景，就不要把一个事情搞复杂的哲学很重要。\n\n更新--fail-swap-on flag含义\n这个flag表示为：Makes the Kubelet fail to start if swap is enabled on the node.\n\n也就是说如果为true（默认值）就要求必须要关闭swap，false是表示即使宿主开启了swap，kubelet也是可以成功启动，但是pod是允许使用swap了，这部分代码因为经常出问题，所以直接swap在宿主上禁用会比较好。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1651741007,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":192363,"user_name":"leo","can_delete":false,"product_type":"c1","uid":1154091,"ip_address":"","ucode":"0E2D4D779D8DC9","user_header":"http://thirdwx.qlogo.cn/mmopen/vi_32/DYAIOgq83erxJYxzce3mZpuZFJNyTAvCibzLUTYbZepaBPNd7ichZgkMeibkQLmNzeb63zda1iaKJ6aIewUTA517hQ/132","comment_is_top":false,"comment_ctime":1584847689,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1584847689","product_id":100015201,"comment_content":"在搭建集群分时候，从节点加入主节点，一直pending状态，是因为从节点下东西下不下来么，我手动吧需要的docker镜像下载下来，还是这个状态<br>我用的是mac，使用虚拟机搭建的测试集群，使用的是Ubuntu","like_count":0},{"had_liked":false,"id":188996,"user_name":"xiaoyao","can_delete":false,"product_type":"c1","uid":1166008,"ip_address":"","ucode":"8623B9E45FC90D","user_header":"https://static001.geekbang.org/account/avatar/00/11/ca/b8/bcfb6e4a.jpg","comment_is_top":false,"comment_ctime":1584443513,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1584443513","product_id":100015201,"comment_content":"可以使用flannel做网络配置","like_count":0},{"had_liked":false,"id":175175,"user_name":"zhang peter","can_delete":false,"product_type":"c1","uid":1144694,"ip_address":"","ucode":"8072990EB97820","user_header":"https://static001.geekbang.org/account/avatar/00/11/77/76/535edf1a.jpg","comment_is_top":false,"comment_ctime":1580603713,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1580603713","product_id":100015201,"comment_content":"墙内在ubuntu上部署k8s集群: https:&#47;&#47;zhang0peter.com&#47;2020&#47;01&#47;30&#47;k8s-install-and-use-and-fix-bug&#47;","like_count":0},{"had_liked":false,"id":170194,"user_name":"王心凌","can_delete":false,"product_type":"c1","uid":1593376,"ip_address":"","ucode":"A51E0C56B6AC73","user_header":"https://static001.geekbang.org/account/avatar/00/18/50/20/34bdc8e2.jpg","comment_is_top":false,"comment_ctime":1578547293,"is_pvip":false,"discussion_count":1,"race_medal":0,"score":"1578547293","product_id":100015201,"comment_content":"[root@2020 ~]# kubectl get nodes<br>NAME       STATUS   ROLES    AGE    VERSION<br>2020       Ready    master   13h    v1.17.0<br>worker-1   Ready    &lt;none&gt;   141m   v1.17.0<br><br>请问ROLES为none正常么，两个不同的虚拟机","like_count":0,"discussions":[{"author":{"id":1593376,"avatar":"https://static001.geekbang.org/account/avatar/00/18/50/20/34bdc8e2.jpg","nickname":"王心凌","note":"","ucode":"A51E0C56B6AC73","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":127002,"discussion_content":"可以手动设置一个ROLE吧","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1578558759,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":166704,"user_name":"耀","can_delete":false,"product_type":"c1","uid":1634462,"ip_address":"","ucode":"3692BEC242A399","user_header":"https://static001.geekbang.org/account/avatar/00/18/f0/9e/cf6570f7.jpg","comment_is_top":false,"comment_ctime":1577548607,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1577548607","product_id":100015201,"comment_content":"单个节点的kubernetes,已经安装好了，为了让kubernete 高可用，要配置HA，配置了过程中遇到很多坑，要是能添加些这些内容就好了。","like_count":0},{"had_liked":false,"id":162377,"user_name":"李雪","can_delete":false,"product_type":"c1","uid":1216060,"ip_address":"","ucode":"7C0DC2105020B1","user_header":"","comment_is_top":false,"comment_ctime":1576506607,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1576506607","product_id":100015201,"comment_content":"老师建议一键部署，还是二进制部署好点","like_count":0},{"had_liked":false,"id":161499,"user_name":"Jasper","can_delete":false,"product_type":"c1","uid":1202174,"ip_address":"","ucode":"A07ABF45D39089","user_header":"https://static001.geekbang.org/account/avatar/00/12/57/fe/beab006d.jpg","comment_is_top":false,"comment_ctime":1576218414,"is_pvip":true,"discussion_count":0,"race_medal":0,"score":"1576218414","product_id":100015201,"comment_content":"（2019.12）仍采用v1.11.1，worker join提示已加入集群，但查看master没有worker信息。<br>查看master日志，提示很多组件out of date错误，估计就是版本问题吧，最终没能成功，记录过程<br>https:&#47;&#47;learnku.com&#47;articles&#47;38022，欢迎批评指正。","like_count":0},{"had_liked":false,"id":158376,"user_name":"小孩","can_delete":false,"product_type":"c1","uid":1112367,"ip_address":"","ucode":"A7F587FC641E63","user_header":"https://static001.geekbang.org/account/avatar/00/10/f9/2f/01b32495.jpg","comment_is_top":false,"comment_ctime":1575361834,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1575361834","product_id":100015201,"comment_content":"一切皆容器什么意思","like_count":0},{"had_liked":false,"id":156904,"user_name":"may_huang","can_delete":false,"product_type":"c1","uid":1451623,"ip_address":"","ucode":"EAF989F18FC109","user_header":"https://static001.geekbang.org/account/avatar/00/16/26/67/c3d90f46.jpg","comment_is_top":false,"comment_ctime":1574994099,"is_pvip":true,"discussion_count":0,"race_medal":0,"score":"1574994099","product_id":100015201,"comment_content":"部署ROOK时报错，不知道是什么原因？<br>[node1 ~]$ kubectl apply -f https:&#47;&#47;github.com&#47;rook&#47;rook&#47;blob&#47;master&#47;cluster&#47;examples&#47;kubernetes&#47;ceph&#47;operator.yaml<br>error: error parsing https:&#47;&#47;github.com&#47;rook&#47;rook&#47;blob&#47;master&#47;cluster&#47;examples&#47;kubernetes&#47;ceph&#47;operator.yaml: error converting YAML to JSON: yaml: line 117: mapping values are not allowed in this context","like_count":0},{"had_liked":false,"id":155520,"user_name":"xiong","can_delete":false,"product_type":"c1","uid":1099375,"ip_address":"","ucode":"C1BFD9EF96372F","user_header":"https://static001.geekbang.org/account/avatar/00/10/c6/6f/ac3003fa.jpg","comment_is_top":false,"comment_ctime":1574695301,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1574695301","product_id":100015201,"comment_content":"感觉好费资源额，一般机器真带不动，是我配置姿势不对吗~","like_count":0},{"had_liked":false,"id":152847,"user_name":"Tao","can_delete":false,"product_type":"c1","uid":1466809,"ip_address":"","ucode":"75FBDF49C601F4","user_header":"https://static001.geekbang.org/account/avatar/00/16/61/b9/dbf629c0.jpg","comment_is_top":false,"comment_ctime":1574089081,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1574089081","product_id":100015201,"comment_content":"搭建了一天，找了各种文档才搭建出来，这篇文章感觉需要更新更新，要不然现在不可能搭建出来","like_count":0},{"had_liked":false,"id":152756,"user_name":"ChrisTan","can_delete":false,"product_type":"c1","uid":1633619,"ip_address":"","ucode":"E07B49B638AA8F","user_header":"https://static001.geekbang.org/account/avatar/00/18/ed/53/6eb6601b.jpg","comment_is_top":false,"comment_ctime":1574075784,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1574075784","product_id":100015201,"comment_content":"为分享的朋友点赞","like_count":0},{"had_liked":false,"id":152753,"user_name":"ChrisTan","can_delete":false,"product_type":"c1","uid":1633619,"ip_address":"","ucode":"E07B49B638AA8F","user_header":"https://static001.geekbang.org/account/avatar/00/18/ed/53/6eb6601b.jpg","comment_is_top":false,"comment_ctime":1574075699,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1574075699","product_id":100015201,"comment_content":"老师，centos&#47;redhat怎么命令行安装","like_count":0},{"had_liked":false,"id":139932,"user_name":"小太阳","can_delete":false,"product_type":"c1","uid":1566413,"ip_address":"","ucode":"80FD4A871ABFAD","user_header":"https://static001.geekbang.org/account/avatar/00/17/e6/cd/bf5e928c.jpg","comment_is_top":false,"comment_ctime":1570769743,"is_pvip":true,"discussion_count":0,"race_medal":0,"score":"1570769743","product_id":100015201,"comment_content":"kubeadm.yaml文件，github或者官网上没找到实例也没找到说明呢？","like_count":0},{"had_liked":false,"id":134981,"user_name":"青争","can_delete":false,"product_type":"c1","uid":1629821,"ip_address":"","ucode":"1FD833A61FA041","user_header":"https://static001.geekbang.org/account/avatar/00/18/de/7d/d10d97df.jpg","comment_is_top":false,"comment_ctime":1568968316,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1568968316","product_id":100015201,"comment_content":"小白求教：<br>root@ubuntu:~# kubeadm init --config kubeadm.yaml <br>W0920 08:42:49.117573   33823 strict.go:47] unknown configuration schema.GroupVersionKind{Group:&quot;kubeadm.k8s.io&quot;, Version:&quot;v1beta2&quot;, Kind:&quot;MasterConfiguration&quot;} for scheme definitions in &quot;k8s.io&#47;kubernetes&#47;cmd&#47;kubeadm&#47;app&#47;apis&#47;kubeadm&#47;scheme&#47;scheme.go:31&quot; and &quot;k8s.io&#47;kubernetes&#47;cmd&#47;kubeadm&#47;app&#47;componentconfigs&#47;scheme.go:28&quot;<br>[config] WARNING: Ignored YAML document with GroupVersionKind kubeadm.k8s.io&#47;v1beta2, Kind=MasterConfiguration<br>no InitConfiguration or ClusterConfiguration kind was found in the YAML file<br>To see the stack trace of this error execute with --v=5 or higher<br>","like_count":0},{"had_liked":false,"id":132683,"user_name":"随意门","can_delete":false,"product_type":"c1","uid":1316502,"ip_address":"","ucode":"6AADD9C133AFCB","user_header":"https://static001.geekbang.org/account/avatar/00/14/16/96/1538f36c.jpg","comment_is_top":false,"comment_ctime":1568191380,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1568191380","product_id":100015201,"comment_content":"老师，您好，因为最近在调研rabbitmq-operator，所以找到了这里https:&#47;&#47;github.com&#47;indeedeng&#47;rabbitmq-operator<br>没想到它的scripts&#47;deploy-operator.sh 里有一条命令“kubectl delete pv -n rabbitmqs --all”；苍天啊，它把我集群中的pv都给删除了，现在所有的pv都是&quot;Terminating&quot;状态，我如何能将pv恢复成正常状态啊？","like_count":0},{"had_liked":false,"id":130275,"user_name":"myriad","can_delete":false,"product_type":"c1","uid":1137781,"ip_address":"","ucode":"9FBBCDE0E13B6B","user_header":"https://static001.geekbang.org/account/avatar/00/11/5c/75/e1ceedf2.jpg","comment_is_top":false,"comment_ctime":1567416466,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1567416466","product_id":100015201,"comment_content":"我新部署的K8s集群环境，1台master + 1台work。 没有跑其他任务。 刚开始内存使用率很低，然后放在那里4天没管， 再次查看的时候master节点已经用了6G内存了，我检查了下系统的内存使用情况，主要是cephcsi消耗了内存。<br>请问为什么我没使用，ceph还会一直消耗内存，并且没有释放。 有没什么方法限制ceph的内存使用。<br>8G内存的云主机感觉完全不够用，用不了几天内存就被耗光了。","like_count":0},{"had_liked":false,"id":130248,"user_name":"随意门","can_delete":false,"product_type":"c1","uid":1316502,"ip_address":"","ucode":"6AADD9C133AFCB","user_header":"https://static001.geekbang.org/account/avatar/00/14/16/96/1538f36c.jpg","comment_is_top":false,"comment_ctime":1567412742,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1567412742","product_id":100015201,"comment_content":"请问：当我在某一个命名空间下部署好了一套微服务，比如在dev命名空间下有web-ui、api、db，然后如何将这一套微服务快速的移植到另外一个test命名空间下？","like_count":0},{"had_liked":false,"id":128883,"user_name":"HOHO","can_delete":false,"product_type":"c1","uid":1619925,"ip_address":"","ucode":"C34029DDAD6194","user_header":"https://static001.geekbang.org/account/avatar/00/18/b7/d5/9cd57434.jpg","comment_is_top":false,"comment_ctime":1566979965,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1566979965","product_id":100015201,"comment_content":"虚拟机已经去墙外了，执行install kubeadm还是一直报E: Unable to locate package kubeadm<br>","like_count":0},{"had_liked":false,"id":123524,"user_name":"普罗米修斯","can_delete":false,"product_type":"c1","uid":1394030,"ip_address":"","ucode":"DDA7DE4DE371FC","user_header":"https://static001.geekbang.org/account/avatar/00/15/45/6e/11cf22de.jpg","comment_is_top":false,"comment_ctime":1565692991,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1565692991","product_id":100015201,"comment_content":"老师，难道这个k8s 还能在非root用户下安装吗","like_count":0},{"had_liked":false,"id":122166,"user_name":"普罗米修斯","can_delete":false,"product_type":"c1","uid":1394030,"ip_address":"","ucode":"DDA7DE4DE371FC","user_header":"https://static001.geekbang.org/account/avatar/00/15/45/6e/11cf22de.jpg","comment_is_top":false,"comment_ctime":1565312723,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1565312723","product_id":100015201,"comment_content":"老师，这个k8s可以用非root用户来部署吗","like_count":0},{"had_liked":false,"id":121618,"user_name":"朱文浩","can_delete":false,"product_type":"c1","uid":1198449,"ip_address":"","ucode":"EE4A8AC0B7833C","user_header":"https://static001.geekbang.org/account/avatar/00/12/49/71/3f3ac809.jpg","comment_is_top":false,"comment_ctime":1565168435,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1565168435","product_id":100015201,"comment_content":"kubectl apply -f https:&#47;&#47;raw.githubusercontent.com&#47;kubernetes&#47;dashboard&#47;master&#47;src&#47;deploy&#47;recommended&#47;kubernetes-dashboard.yaml<br>现在执行下来找不到文件，404了怎么整","like_count":0},{"had_liked":false,"id":119577,"user_name":"Geek_53fe7f","can_delete":false,"product_type":"c1","uid":1617925,"ip_address":"","ucode":"C38EE8F458E141","user_header":"","comment_is_top":false,"comment_ctime":1564628814,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1564628814","product_id":100015201,"comment_content":"kubectl apply -f https:&#47;&#47;raw.githubusercontent.com&#47;kubernetes&#47;dashboard&#47;master&#47;src&#47;deploy&#47;recommended&#47;kubernetes-dashboard.yaml<br>报错 error: unable to read URL &quot;https:&#47;&#47;raw.githubusercontent.com&#47;kubernetes&#47;dashboard&#47;master&#47;src&#47;deploy&#47;recommended&#47;kubernetes-dashboard.yaml&quot;, server reported 404 Not Found, status code=404<br>环境是国外云服务器 cenos7<br>","like_count":0},{"had_liked":false,"id":117802,"user_name":"antcodex","can_delete":false,"product_type":"c1","uid":1247870,"ip_address":"","ucode":"E0637AE4B1CE54","user_header":"https://static001.geekbang.org/account/avatar/00/13/0a/7e/d08bbf07.jpg","comment_is_top":false,"comment_ctime":1564133289,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1564133289","product_id":100015201,"comment_content":"no InitConfiguration or ClusterConfiguration kind was found in the YAML file<br><br>我初始化的时候显示这个问题，大佬求解","like_count":0},{"had_liked":false,"id":116170,"user_name":"君莫惜","can_delete":false,"product_type":"c1","uid":1101408,"ip_address":"","ucode":"FD570371148000","user_header":"https://static001.geekbang.org/account/avatar/00/10/ce/60/7d17522d.jpg","comment_is_top":false,"comment_ctime":1563797101,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1563797101","product_id":100015201,"comment_content":"join显示成功，但是在master中，通过get nodes看不到新的节点","like_count":0},{"had_liked":false,"id":113904,"user_name":"🌊","can_delete":false,"product_type":"c1","uid":1262190,"ip_address":"","ucode":"397CF0AC56AC57","user_header":"https://static001.geekbang.org/account/avatar/00/13/42/6e/4afba229.jpg","comment_is_top":false,"comment_ctime":1563183487,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1563183487","product_id":100015201,"comment_content":"etcd pod部署，数据这方面有丢失的风险吗？","like_count":0},{"had_liked":false,"id":113875,"user_name":"王聪 Claire","can_delete":false,"product_type":"c1","uid":1090310,"ip_address":"","ucode":"0D9CC82C9F44D4","user_header":"https://static001.geekbang.org/account/avatar/00/10/a3/06/9fa93074.jpg","comment_is_top":false,"comment_ctime":1563177430,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1563177430","product_id":100015201,"comment_content":"你好，想问下如果实在1.15版本下，kubeadm。yaml的配置文件apiversion应该怎么查呢，在官网查是kubeadm.k8s.io&#47;v1beta2,但是运行kubeadm init -config kubeadm.yaml后报错W0715 15:51:01.389999  130445 strict.go:47] unknown configuration schema.GroupVersionKind{Group:&quot;kubeadm.k8s.io&quot;, Version:&quot;v1beta2&quot;, Kind:&quot;MasterConfiguration&quot;} for scheme definitions in &quot;k8s.io&#47;kubernetes&#47;cmd&#47;kubeadm&#47;app&#47;apis&#47;kubeadm&#47;scheme&#47;scheme.go:31&quot; and &quot;k8s.io&#47;kubernetes&#47;cmd&#47;kubeadm&#47;app&#47;componentconfigs&#47;scheme.go:28&quot;<br>[config] WARNING: Ignored YAML document with GroupVersionKind kubeadm.k8s.io&#47;v1beta2, Kind=MasterConfiguration<br>no InitConfiguration or ClusterConfiguration kind was found in the YAML file。<br>有什么比较明确地方法查看apiversion吗","like_count":0},{"had_liked":false,"id":109590,"user_name":"wjy","can_delete":false,"product_type":"c1","uid":1225122,"ip_address":"","ucode":"EF84E333EFD606","user_header":"http://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTLUnFj3USkK2x2ib42MRXzFzKJJGRa1AfMUvhpibZm5tHNniamy19ial2warIfIjj0pp7YnwjEic7SLvEg/132","comment_is_top":false,"comment_ctime":1562062769,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1562062769","product_id":100015201,"comment_content":"dashboard<br>kubectl apply -f http:&#47;&#47;mirror.faasx.com&#47;kubernetes&#47;dashboard&#47;master&#47;src&#47;deploy&#47;recommended&#47;kubernetes-dashboard.yaml","like_count":0},{"had_liked":false,"id":107889,"user_name":"Quintin","can_delete":false,"product_type":"c1","uid":1315961,"ip_address":"","ucode":"5CE8C31831BB18","user_header":"http://thirdwx.qlogo.cn/mmopen/vi_32/DYAIOgq83eoX5UwDDk3YOVJnibFb8kHJh34fTqp6Ru0l7nNssQQrpZIUS33Zro70Fwg98HWNFJgUWX3rTFTOJAg/132","comment_is_top":false,"comment_ctime":1561629509,"is_pvip":false,"discussion_count":2,"race_medal":0,"score":"1561629509","product_id":100015201,"comment_content":"kubeadm 1.15版本<br>根据v1beta2的格式改写了yaml,但是有一个参数 horizontal-pod-autoscaler-sync-period 还是不对,不知道改成什么.<br>yaml内容:<br>apiVersion: kubeadm.k8s.io&#47;v1beta2<br>kind: ClusterConfiguration<br>imageRepository: registry.aliyuncs.com&#47;google_containers<br>controllerManager:<br>  horizontal-pod-autoscaler-use-rest-clients: &quot;true&quot;<br>  horizontal-pod-autoscaler-sync-period: &quot;10s&quot;<br>  node-monitor-grace-period: &quot;10s&quot;<br>apiServer:<br>  extraArgs:<br>    runtime-config: &quot;api&#47;all=true&quot;<br>kubernetesVersion: &quot;v1.15.0&quot;<br><br><br>报错:<br>error unmarshaling configuration schema.GroupVersionKind{Group:&quot;kubeadm.k8s.io&quot;, Version:&quot;v1beta2&quot;, Kind:&quot;ClusterConfiguration&quot;}: error unmarshaling JSON: while decoding JSON: json: unknown field &quot;horizontal-pod-autoscaler-sync-period&quot;","like_count":0,"discussions":[{"author":{"id":1225122,"avatar":"http://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTLUnFj3USkK2x2ib42MRXzFzKJJGRa1AfMUvhpibZm5tHNniamy19ial2warIfIjj0pp7YnwjEic7SLvEg/132","nickname":"wjy","note":"","ucode":"EF84E333EFD606","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":794,"discussion_content":"apiVersion: kubeadm.k8s.io/v1beta2\nkind:  ClusterConfiguration\ncontrollerManagerExtraArgs:\n  horizontal-pod-autoscaler-use-rest-clients: &#34;true&#34;\n  horizontal-pod-autoscaler-sync-period: &#34;10s&#34;\n  node-monitor-grace-period: &#34;10s&#34;\napiServerExtraArgs:\n  runtime-config: &#34;api/all=true&#34;\nkubernetesVersion: &#34;stable-1.15&#34;","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1562061096,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1225122,"avatar":"http://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTLUnFj3USkK2x2ib42MRXzFzKJJGRa1AfMUvhpibZm5tHNniamy19ial2warIfIjj0pp7YnwjEic7SLvEg/132","nickname":"wjy","note":"","ucode":"EF84E333EFD606","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":792,"discussion_content":"用kubeadm config print init-defaults 输出默认支持的","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1562061067,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":105799,"user_name":"GLADIATOR","can_delete":false,"product_type":"c1","uid":1448564,"ip_address":"","ucode":"6FE14E0BCD6240","user_header":"https://static001.geekbang.org/account/avatar/00/16/1a/74/8f7f8786.jpg","comment_is_top":false,"comment_ctime":1561085311,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1561085311","product_id":100015201,"comment_content":"老师，我在按照您的方法部署root时提示：namespaces &quot;rook-ceph&quot; not found","like_count":0},{"had_liked":false,"id":104634,"user_name":"Jess","can_delete":false,"product_type":"c1","uid":1503183,"ip_address":"","ucode":"41DE3E042FBF8A","user_header":"https://static001.geekbang.org/account/avatar/00/16/ef/cf/9bda71c8.jpg","comment_is_top":false,"comment_ctime":1560795194,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1560795194","product_id":100015201,"comment_content":"老師 我在安裝kubeadm時就報錯了<br><br>The following packages have unmet dependencies:<br> kubeadm : Depends: kubelet (&gt;= 1.6.0) but it is not going to be installed<br><br>請問是什麼原因呢？使用的鏡像是ubuntu16.04","like_count":0},{"had_liked":false,"id":103244,"user_name":"mckee","can_delete":false,"product_type":"c1","uid":1066511,"ip_address":"","ucode":"E4DEBB462B93A1","user_header":"https://static001.geekbang.org/account/avatar/00/10/46/0f/f6cfc659.jpg","comment_is_top":false,"comment_ctime":1560403348,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1560403348","product_id":100015201,"comment_content":"一般生产环境应该用什么方式部署  组件是systemd方式还是在容器里？","like_count":0},{"had_liked":false,"id":102535,"user_name":"毛毛","can_delete":false,"product_type":"c1","uid":1124809,"ip_address":"","ucode":"066F4A6CE901C5","user_header":"https://static001.geekbang.org/account/avatar/00/11/29/c9/15710344.jpg","comment_is_top":false,"comment_ctime":1560245469,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1560245469","product_id":100015201,"comment_content":"国内网络，第一步就过不去<br>curl -s https:&#47;&#47;packages.cloud.google.com&#47;apt&#47;doc&#47;apt-key.gpg | apt-key add -<br><br>有什么办法解决么？","like_count":0},{"had_liked":false,"id":94099,"user_name":"坤","can_delete":false,"product_type":"c1","uid":1010922,"ip_address":"","ucode":"74E6838226A405","user_header":"https://static001.geekbang.org/account/avatar/00/0f/6c/ea/ce9854a5.jpg","comment_is_top":false,"comment_ctime":1557719105,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1557719105","product_id":100015201,"comment_content":"rook的安装建议参考： https:&#47;&#47;rook.io&#47;docs&#47;rook&#47;v1.0&#47;ceph-quickstart.html","like_count":0},{"had_liked":false,"id":94090,"user_name":"坤","can_delete":false,"product_type":"c1","uid":1010922,"ip_address":"","ucode":"74E6838226A405","user_header":"https://static001.geekbang.org/account/avatar/00/0f/6c/ea/ce9854a5.jpg","comment_is_top":false,"comment_ctime":1557717484,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1557717484","product_id":100015201,"comment_content":"root@iZj6cgh94e90cjdj4mg6gmZ:~# kubectl apply -f https:&#47;&#47;raw.githubusercontent.com&#47;rook&#47;rook&#47;master&#47;cluster&#47;examples&#47;kubernetes&#47;ceph&#47;operator.yaml<br>Error from server (NotFound): error when creating &quot;https:&#47;&#47;raw.githubusercontent.com&#47;rook&#47;rook&#47;master&#47;cluster&#47;examples&#47;kubernetes&#47;ceph&#47;operator.yaml&quot;: namespaces &quot;rook-ceph&quot; not found<br>root@iZj6cgh94e90cjdj4mg6gmZ:~# ","like_count":0},{"had_liked":false,"id":93650,"user_name":"厶车","can_delete":false,"product_type":"c1","uid":1506510,"ip_address":"","ucode":"E559CFF4F7125A","user_header":"https://static001.geekbang.org/account/avatar/00/16/fc/ce/185a7af5.jpg","comment_is_top":false,"comment_ctime":1557545002,"is_pvip":false,"discussion_count":1,"race_medal":0,"score":"1557545002","product_id":100015201,"comment_content":"配置rook的命令显示404，如果不装的话会影响后续的学习吗？需要的话，有什么备选方案呢？","like_count":0,"discussions":[{"author":{"id":1082097,"avatar":"https://static001.geekbang.org/account/avatar/00/10/82/f1/c2cfbd2e.jpg","nickname":"积红","note":"","ucode":"A8ED0D66E7E723","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":3636,"discussion_content":"https://rook.io/docs/rook/v1.0/ceph-quickstart.htm, 参考这个安装， 我在1.12.3上安装成功。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1564650132,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":90969,"user_name":"yan","can_delete":false,"product_type":"c1","uid":1147723,"ip_address":"","ucode":"714BFDF884DC4C","user_header":"https://static001.geekbang.org/account/avatar/00/11/83/4b/76d0f033.jpg","comment_is_top":false,"comment_ctime":1556762933,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1556762933","product_id":100015201,"comment_content":"张老师，您好！ 我在部署rook-operator的时候提示如下，应该怎么解决？<br>failed to run operator. Error starting agent daemonset: error starting agent daemonset: failed to create rook-ceph-agent daemon set.<br><br> daemonsets.extensions is forbidden: User &quot;system:serviceaccount:rook-ceph:rook-ceph-system&quot; cannot create resource &quot;daemonsets&quot; in API group &quot;extensions&quot; in the namespace &quot;rook-ceph&quot;","like_count":0},{"had_liked":false,"id":90085,"user_name":"link","can_delete":false,"product_type":"c1","uid":1449334,"ip_address":"","ucode":"2A5C2D8987F958","user_header":"https://static001.geekbang.org/account/avatar/00/16/1d/76/62c8df21.jpg","comment_is_top":false,"comment_ctime":1556412654,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1556412654","product_id":100015201,"comment_content":"老师你好，说下我遇到的问题，worker节点加入的时候只是警告一下cgroupfs不一致，如何就一直一直不动了，也不报错，因为同一虚拟机下的两台Linux不一致么？还是不能使用仅主机模式？","like_count":0},{"had_liked":false,"id":89952,"user_name":"wjzhu","can_delete":false,"product_type":"c1","uid":1012929,"ip_address":"","ucode":"E306154887D907","user_header":"https://static001.geekbang.org/account/avatar/00/0f/74/c1/163c0220.jpg","comment_is_top":false,"comment_ctime":1556346569,"is_pvip":true,"discussion_count":0,"race_medal":0,"score":"1556346569","product_id":100015201,"comment_content":"我自己用conjure up部署过，傻瓜型的，大家可以去试试。但是生产级还没试过，因为用不到😂😅","like_count":0},{"had_liked":false,"id":89146,"user_name":"不经意间","can_delete":false,"product_type":"c1","uid":1261493,"ip_address":"","ucode":"C39D98697ACB8B","user_header":"https://static001.geekbang.org/account/avatar/00/13/3f/b5/5fe77e16.jpg","comment_is_top":false,"comment_ctime":1556090917,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1556090917","product_id":100015201,"comment_content":"docker pull googlecontainer&#47;xxx:v1.14.1   亲测可用！","like_count":0},{"had_liked":false,"id":88520,"user_name":"堵车","can_delete":false,"product_type":"c1","uid":1145404,"ip_address":"","ucode":"7BC1E50A4F8D3D","user_header":"https://static001.geekbang.org/account/avatar/00/11/7a/3c/87e015f8.jpg","comment_is_top":false,"comment_ctime":1555935020,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1555935020","product_id":100015201,"comment_content":"执行kubeadm init --config kubeadm.yaml 报出一下错误。不知道怎么办<br>name: Invalid value: &quot;vm_0_12_centos&quot;: a DNS-1123 subdomain must consist of lower case alphanumeric characters, &#39;-&#39; or &#39;.&#39;, and must start and end with an alphanumeric character (e.g. &#39;example.com&#39;, regex used for validation is &#39;[a-z0-9]([-a-z0-9]*[a-z0-9])?(\\.[a-z0-9]([-a-z0-9]*[a-z0-9])?)*&#39;)","like_count":0},{"had_liked":false,"id":82488,"user_name":"山","can_delete":false,"product_type":"c1","uid":1462964,"ip_address":"","ucode":"E837ADCC6F5514","user_header":"https://static001.geekbang.org/account/avatar/00/16/52/b4/7aff7a71.jpg","comment_is_top":false,"comment_ctime":1554222008,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1554222008","product_id":100015201,"comment_content":"在centos7上的worker节点运行join命令之后， worker节点显示not ready<br><br>KubeletNotReady              runtime network not ready: NetworkReady=false reason:NetworkPluginNotReady message:docker: network plugin is not ready: cni config uninitialized<br><br><br>运行journalctl -xefu kubelet 命令之后发现下面的error log在刷<br>Apr 03 00:19:36 10-9-167-158 kubelet[13916]: E0403 00:19:36.403112   13916 summary_sys_containers.go:47] Failed to get system container stats for &quot;&#47;system.slice&#47;docker.service&quot;: failed to get cgroup stats for &quot;&#47;system.slice&#47;docker.service&quot;: failed to get container info for &quot;&#47;system.slice&#47;docker.service&quot;: unknown container &quot;&#47;system.slice&#47;docker.service&quot;","like_count":0},{"had_liked":false,"id":80995,"user_name":"光","can_delete":false,"product_type":"c1","uid":1284618,"ip_address":"","ucode":"BDA7F41566E4FE","user_header":"https://static001.geekbang.org/account/avatar/00/13/9a/0a/6c74e932.jpg","comment_is_top":false,"comment_ctime":1553771246,"is_pvip":true,"discussion_count":0,"race_medal":0,"score":"1553771246","product_id":100015201,"comment_content":"问下这个apiVersion 有点乱。官方文档也不是很清楚，有什么标准么。我看文章中master 是alpha1，后面是v1。","like_count":0},{"had_liked":false,"id":80724,"user_name":"山","can_delete":false,"product_type":"c1","uid":1462964,"ip_address":"","ucode":"E837ADCC6F5514","user_header":"https://static001.geekbang.org/account/avatar/00/16/52/b4/7aff7a71.jpg","comment_is_top":false,"comment_ctime":1553702719,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1553702719","product_id":100015201,"comment_content":"在已经使用上一节课的方式在单机上部署了K8s了，现在怎样继续呢？直接通过配置文件运行init吗","like_count":0},{"had_liked":false,"id":79705,"user_name":"Kevin","can_delete":false,"product_type":"c1","uid":1315530,"ip_address":"","ucode":"12A4BB3BA40157","user_header":"https://static001.geekbang.org/account/avatar/00/14/12/ca/69454e06.jpg","comment_is_top":false,"comment_ctime":1553523683,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1553523683","product_id":100015201,"comment_content":"rook 部署不成功：<br>[root@k8s-master ~]# kubectl get pods -n rook-ceph-system                       NAME                                 READY   STATUS             RESTARTS   AGE<br>rook-ceph-operator-b996864dd-65mfr   0&#47;1     ImagePullBackOff   0          2d<br>","like_count":0},{"had_liked":false,"id":78781,"user_name":"飞向云端","can_delete":false,"product_type":"c1","uid":1419516,"ip_address":"","ucode":"54B3D9B1B0368B","user_header":"https://static001.geekbang.org/account/avatar/00/15/a8/fc/6c00e036.jpg","comment_is_top":false,"comment_ctime":1553240163,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1553240163","product_id":100015201,"comment_content":" Error while initializing connection to Kubernetes apiserver. This most likely means that the cluster is misconfigured (e.g., it has invalid apiserver certificates or service accounts configuration) or the --apiserver-host param points to a server that does not exist.<br>安装dashboard可视化，报错，什么情跪求解决方案","like_count":0},{"had_liked":false,"id":77848,"user_name":"Geek_804034","can_delete":false,"product_type":"c1","uid":1097666,"ip_address":"","ucode":"4360F26E9F2555","user_header":"https://static001.geekbang.org/account/avatar/00/10/bf/c2/c3ebb876.jpg","comment_is_top":false,"comment_ctime":1553007555,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1553007555","product_id":100015201,"comment_content":"能帮我@Q小D？也许你的解决方案是route add 10.96.0.1 gw 10.0.0.10我是这么做的<br>https:&#47;&#47;stackoverflow.com&#47;questions&#47;39872332&#47;how-to-fix-weave-net-crashloopbackoff-for-the-second-node","like_count":0},{"had_liked":false,"id":76245,"user_name":"Hank","can_delete":false,"product_type":"c1","uid":1460347,"ip_address":"","ucode":"3BE6B86218F957","user_header":"https://static001.geekbang.org/account/avatar/00/16/48/7b/bc7fcac2.jpg","comment_is_top":false,"comment_ctime":1552556618,"is_pvip":false,"discussion_count":1,"race_medal":0,"score":"1552556618","product_id":100015201,"comment_content":"虽然每一个地方都解释得很清楚，但是     镜像阿里云是有的，可以在阿里云拉取镜像，然后进行重新tag，或者直接修改yaml文件 改成阿里云的。<br>我在centos安装二进制，然后ubuntu，装不上。最后也是用kubeadm，然后一脸懵逼就装上了。现在好了，有了解释了，才知道发生了什么。运维最害怕的事情，就是不知道发生了什么事情。","like_count":0,"discussions":[{"author":{"id":1584671,"avatar":"https://static001.geekbang.org/account/avatar/00/18/2e/1f/c515fba5.jpg","nickname":"磊","note":"","ucode":"05EEAF999BF1E1","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":4270,"discussion_content":"我用了阿里云的镜像还是不行  安装的时候还是报错 E: Unable to locate package kubeadm  ","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1565264372,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":75717,"user_name":"果子","can_delete":false,"product_type":"c1","uid":1448953,"ip_address":"","ucode":"3788EFA88BCD87","user_header":"https://static001.geekbang.org/account/avatar/00/16/1b/f9/73cb2591.jpg","comment_is_top":false,"comment_ctime":1552455862,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1552455862","product_id":100015201,"comment_content":"老师好，想请教个问题，我在master上部署插件的时候，比如rook，使用上面你提供的apply命令，master上能够正常的拉取镜像并成功启动，但是worker节点上并不能自己拉取镜像，当我把master上的镜像save然后发送到worker上load之后，就能正常上线，是不是我哪里设置有缺漏呢？","like_count":0},{"had_liked":false,"id":73159,"user_name":"橙汁","can_delete":false,"product_type":"c1","uid":1332257,"ip_address":"","ucode":"EC3FF10D708C9D","user_header":"https://static001.geekbang.org/account/avatar/00/14/54/21/0bac2254.jpg","comment_is_top":false,"comment_ctime":1551832999,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1551832999","product_id":100015201,"comment_content":"老师，我是在部署存储插件这部出现问题一直显示pending还有另一个是查询不到，是由于源的原因吗","like_count":0},{"had_liked":false,"id":69918,"user_name":"mccrms","can_delete":false,"product_type":"c1","uid":1232528,"ip_address":"","ucode":"EE65C5B2012A0F","user_header":"https://static001.geekbang.org/account/avatar/00/12/ce/90/fafbbe0b.jpg","comment_is_top":false,"comment_ctime":1550904847,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1550904847","product_id":100015201,"comment_content":"是否可以尝试把实验所需镜像导出放到云盘上，这样就可以下载导入了","like_count":0},{"had_liked":false,"id":69169,"user_name":"李慕淳@Leo","can_delete":false,"product_type":"c1","uid":1266381,"ip_address":"","ucode":"353F3BC30A8BF8","user_header":"https://static001.geekbang.org/account/avatar/00/13/52/cd/b144b05a.jpg","comment_is_top":false,"comment_ctime":1550672494,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1550672494","product_id":100015201,"comment_content":"root@leo:&#47;media&#47;leo&#47;fecdc20c-1882-4709-a4a8-bbda83bab203&#47;docker_project&#47;k8s# kubectl get nodes<br>Unable to connect to the server: net&#47;http: TLS handshake timeout<br>已经kubeadm init成功了，但是kubectl get nodes。会出现超时。<br>系统：Ubuntu16.04<br>docker:18.06<br>kubectl、kubeadm:v1.11.3","like_count":0},{"had_liked":false,"id":68271,"user_name":"心灵捕手","can_delete":false,"product_type":"c1","uid":1232527,"ip_address":"","ucode":"6D0BC463A000C8","user_header":"https://static001.geekbang.org/account/avatar/00/12/ce/8f/6daf02db.jpg","comment_is_top":false,"comment_ctime":1550474293,"is_pvip":false,"discussion_count":1,"race_medal":0,"score":"1550474293","product_id":100015201,"comment_content":"单节点：在执行kubectl get pods -n kube-system ,kubectl get nodes正常后，过会就不行了<br>The connection to the server xxx.xxx.xx.xx:6443 was refused - did you specify the right host or port?<br>网上也查过，试了都还是不行，需要老师帮忙","like_count":0,"discussions":[{"author":{"id":1800951,"avatar":"http://thirdwx.qlogo.cn/mmopen/vi_32/A2ZckFLHLGee4FhmhFYIWkoXMMV5UTj3Mdj3Ps7FJM1YvaIicVnKibqIHchbYllPOicwDs0frHxHVEiaYuV2K5vVqw/132","nickname":"InfoQ_9c8a605d5c96","note":"","ucode":"9AB97E4E4FE4E9","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":309329,"discussion_content":"兄弟你最后怎么解决的这个问题？","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1601259724,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":67698,"user_name":"随遇而安","can_delete":false,"product_type":"c1","uid":1074650,"ip_address":"","ucode":"2AF8A8FC453E36","user_header":"https://static001.geekbang.org/account/avatar/00/10/65/da/5147078e.jpg","comment_is_top":false,"comment_ctime":1550224171,"is_pvip":true,"discussion_count":0,"race_medal":0,"score":"1550224171","product_id":100015201,"comment_content":"老师，请教下，我的环境是 centos 7.5 docker-18.09 k8s-v1.13.1，参考网上一些文档用 kubeadm init --kubernetes-version=v1.13.1 --pod-network-cidr=10.244.0.0&#47;16 初始化集群后，执行 kubectl apply -f https:&#47;&#47;raw.githubusercontent.com&#47;coreos&#47;flannel&#47;master&#47;Documentation&#47;kube-flannel.yml报错：<br>unable to recognize &quot;https:&#47;&#47;raw.githubusercontent.com&#47;coreos&#47;flannel&#47;master&#47;Documentation&#47;kube-flannel.yml&quot;: Get http:&#47;&#47;localhost:8080&#47;api?timeout=32s: dial tcp [::1]:8080: connect: connection refused<br>unable to recognize &quot;https:&#47;&#47;raw.githubusercontent.com&#47;coreos&#47;flannel&#47;master&#47;Documentation&#47;kube-flannel.yml&quot;: Get http:&#47;&#47;localhost:8080&#47;api?timeout=32s: dial tcp [::1]:8080: connect: connection refused<br>unable to recognize &quot;https:&#47;&#47;raw.githubusercontent.com&#47;coreos&#47;flannel&#47;master&#47;Documentation&#47;kube-flannel.yml&quot;: Get http:&#47;&#47;localhost:8080&#47;api?timeout=32s: dial tcp [::1]:8080: connect: connection refused<br>unable to recognize &quot;https:&#47;&#47;raw.githubusercontent.com&#47;coreos&#47;flannel&#47;master&#47;Documentation&#47;kube-flannel.yml&quot;: Get http:&#47;&#47;localhost:8080&#47;api?timeout=32s: dial tcp [::1]:8080: connect: connection refused<br>unable to recognize &quot;https:&#47;&#47;raw.githubusercontent.com&#47;coreos&#47;flannel&#47;master&#47;Documentation&#47;kube-flannel.yml&quot;: Get http:&#47;&#47;localhost:8080&#47;api?timeout=32s: dial tcp [::1]:8080: connect: connection refused<br>这个错误卡一天了，需要启动哪个服务才能解决，谢谢。","like_count":0},{"had_liked":false,"id":64958,"user_name":"Geek_c8eabe","can_delete":false,"product_type":"c1","uid":1342430,"ip_address":"","ucode":"D3100A2DD591E0","user_header":"http://thirdwx.qlogo.cn/mmopen/vi_32/HADZgeqSxRPnv7HMHu61QsyeEFUDPoVQx0ZEmAI3zwv8OT5NbfSB6ImcM2cXybPgIStqK96Yn7P6tdAmciaVKUg/132","comment_is_top":false,"comment_ctime":1548985343,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1548985343","product_id":100015201,"comment_content":"mac os怎么装kubeadm？","like_count":0},{"had_liked":false,"id":64350,"user_name":"Walt365","can_delete":false,"product_type":"c1","uid":1360368,"ip_address":"","ucode":"E6FFC11509904B","user_header":"https://static001.geekbang.org/account/avatar/00/14/c1/f0/2b4fe55f.jpg","comment_is_top":false,"comment_ctime":1548750975,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1548750975","product_id":100015201,"comment_content":"这个链接已经失效https:&#47;&#47;raw.githubusercontent.com&#47;kubernetes&#47;dashboard&#47;master&#47;src&#47;deploy&#47;recommended&#47;kubernetes-dashboard.yaml<br>","like_count":0},{"had_liked":false,"id":63028,"user_name":"行癫-BLCloud","can_delete":false,"product_type":"c1","uid":1270213,"ip_address":"","ucode":"DCAE13D5A23AD1","user_header":"https://static001.geekbang.org/account/avatar/00/13/61/c5/5be5bb1a.jpg","comment_is_top":false,"comment_ctime":1548232259,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1548232259","product_id":100015201,"comment_content":"kubeadm部署kubernetes的集群是不是在生产环境中使用？  在生产环境中使用什么方式部署最好呢？张老师","like_count":0},{"had_liked":false,"id":62431,"user_name":"knull","can_delete":false,"product_type":"c1","uid":1043484,"ip_address":"","ucode":"3BFECF3D29F40C","user_header":"https://static001.geekbang.org/account/avatar/00/0f/ec/1c/d323b066.jpg","comment_is_top":false,"comment_ctime":1548056723,"is_pvip":false,"discussion_count":1,"race_medal":0,"score":"1548056723","product_id":100015201,"comment_content":"rook-ceph安装cluster失败，用get pods -n rook-ceph显示如下：<br>NAME                               READY     STATUS                  RESTARTS   AGE<br>rook-ceph-mon-a-65f66475b4-9qcrm   0&#47;1       Pending                 0          20m<br>rook-ceph-mon-d-85bf66f6b5-52d2x   0&#47;1       Pending                 0          19m<br>rook-ceph-mon-f-8558898c44-m9rhz   0&#47;1       Init:CrashLoopBackOff   8          17m<br>但是，用kubectl logs rook-ceph-mon-f-8558898c44-m9rhz 会报错：pods not found。<br>请教：1、这种问题怎么定位、解决？2、get pods明明是存在的，为啥在logs中有显示pods not found？","like_count":0,"discussions":[{"author":{"id":1911661,"avatar":"https://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTLDOKcx20Xxmu5j8WxiafoYvo3bIAFDg8OeicRic1icD597QuMC9O8FyV2Al9RxNfVZXK0gkGUx6M3CVQ/132","nickname":"多年以后","note":"","ucode":"D70E7A1ABE0F39","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":303375,"discussion_content":"请问你解决了吗？我也遇到这个问题了 不知道怎么解决和定位","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1599219549,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":62420,"user_name":"knull","can_delete":false,"product_type":"c1","uid":1043484,"ip_address":"","ucode":"3BFECF3D29F40C","user_header":"https://static001.geekbang.org/account/avatar/00/0f/ec/1c/d323b066.jpg","comment_is_top":false,"comment_ctime":1548053207,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1548053207","product_id":100015201,"comment_content":"这里补充一个kubernetes-dashboard：<br>这个docker镜像是需要翻墙的。这里可以将镜像源稍微设置下，<br>docker pull anjia0532&#47;google-containers.kubernetes-dashboard-amd64:v1.10.0<br>docker tag  anjia0532&#47;google-containers.kubernetes-dashboard-amd64:v1.10.0   k8s.gcr.io&#47;kubernetes-dashboard-amd64:v1.10.0<br>docker rmi  anjia0532&#47;google-containers.kubernetes-dashboard-amd64:v1.10.0 <br><br>然后，用wget将https:&#47;&#47;raw.githubusercontent.com&#47;kubernetes&#47;dashboard&#47;v1.10.1&#47;src&#47;deploy&#47;recommended&#47;kubernetes-dashboard.yaml拉到本地。将dashboard的image的版本改为v1.10.0 。<br>最后用kubectl apply -f kubernetes-dashboard.yaml就可以启动成功了。<br>问题描述：<br>一般情况下，直接执行apply之后，status是ContainerCreating。在过一段时间之后，status变为ImagePullBackOff。<br>我猜测：是进行中状态，就是creating。镜像pull失败，就转为失败。所以这里需要重新设置下镜像源<br>","like_count":0},{"had_liked":false,"id":61051,"user_name":"holen","can_delete":false,"product_type":"c1","uid":1104199,"ip_address":"","ucode":"2C7D342AFE4DF0","user_header":"https://static001.geekbang.org/account/avatar/00/10/d9/47/247fd305.jpg","comment_is_top":false,"comment_ctime":1547608989,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1547608989","product_id":100015201,"comment_content":"老师 代理是怎么弄的，我的 ubuntu 上已经有代理了， 测试可以翻了，但是执行 kubeadm init --config kubeadm.yaml 的时候，还是会报 unable to get URL &quot;https:&#47;&#47;dl.k8s.io&#47;release&#47;stable-1.11.txt&quot;: Get https:&#47;&#47;dl.k8s.io&#47;release&#47;stable-1.11.txt: proxyconnect tcp: net&#47;http: TLS handshake timeout 走不出去，docker 也设置了代理了， 服务器也有，就是不明白为什么还是过不去！","like_count":0},{"had_liked":false,"id":58002,"user_name":"nie","can_delete":false,"product_type":"c1","uid":1185929,"ip_address":"","ucode":"F4A0050E55F8BF","user_header":"http://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTJHL8tRiaiaEubdos6Ib6nlPg5KTjslyhfZKYL8xozzEbc7euvrvgr5P1yMLpMUNnIjrn1tSOj6l9PA/132","comment_is_top":false,"comment_ctime":1546958905,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1546958905","product_id":100015201,"comment_content":"[root@k8s-m1 ~]# kubectl get nodes<br>NAME     STATUS     ROLES    AGE     VERSION<br>k8s-m1   Ready      master   9m13s   v1.13.1<br>k8s-m2   NotReady   &lt;none&gt;   5m37s   v1.13.1<br>老师你好，k8s-m2工作节点上kubeadm join后，还是NotReady状态，runtime network not ready: NetworkReady=false reason:NetworkPluginNotReady message:docker: network plugin is not ready: cni config uninitialized，请问还需要做什么操作才能使k8s-m2状态为Ready？","like_count":0},{"had_liked":false,"id":56601,"user_name":"小猪","can_delete":false,"product_type":"c1","uid":1201662,"ip_address":"","ucode":"EAD6A4876CEF3B","user_header":"https://static001.geekbang.org/account/avatar/00/12/55/fe/ab541300.jpg","comment_is_top":false,"comment_ctime":1546504012,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1546504012","product_id":100015201,"comment_content":"我如果想安装kubeadm最新版本1.13，那么如何设置kubeadm.yaml的apiVersion配置项呢？","like_count":0},{"had_liked":false,"id":56330,"user_name":"左弈","can_delete":false,"product_type":"c1","uid":1018449,"ip_address":"","ucode":"8E080299B69C42","user_header":"https://static001.geekbang.org/account/avatar/00/0f/8a/51/91efec48.jpg","comment_is_top":false,"comment_ctime":1546422770,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1546422770","product_id":100015201,"comment_content":"无需翻墙，使用kubeadm和vagrnat部署可用于研发、测试、学习等用途的非生产环境Kubernetes集群, 支持Windows和Linux系统. 支持版本v1.10.2，还没时间升级到最新版本。欢迎拍砖。<br>https:&#47;&#47;github.com&#47;xuwenbao&#47;kubeadm-vagrant","like_count":0},{"had_liked":false,"id":56285,"user_name":"小猪","can_delete":false,"product_type":"c1","uid":1201662,"ip_address":"","ucode":"EAD6A4876CEF3B","user_header":"https://static001.geekbang.org/account/avatar/00/12/55/fe/ab541300.jpg","comment_is_top":false,"comment_ctime":1546416070,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1546416070","product_id":100015201,"comment_content":"如果做整套微服务的运行，是否使用k8s就可以了呢？","like_count":0},{"had_liked":false,"id":54739,"user_name":"jacky","can_delete":false,"product_type":"c1","uid":1049177,"ip_address":"","ucode":"A0BD06E2ABF520","user_header":"https://static001.geekbang.org/account/avatar/00/10/02/59/989f65c8.jpg","comment_is_top":false,"comment_ctime":1545958449,"is_pvip":false,"discussion_count":2,"race_medal":0,"score":"1545958449","product_id":100015201,"comment_content":"老师，请问你通常用什么软件翻墙？是免费的还是收费的？","like_count":0,"discussions":[{"author":{"id":2930234,"avatar":"https://thirdwx.qlogo.cn/mmopen/vi_32/KqZeIjNOVQJnsIFkDBWl5wfaxWDGLpIMUdFbF7SQhXFavmxgpwQPj9FrGAV4xNrqd733qicT4IZVibELyziaLokDQ/132","nickname":"罗艺","note":"","ucode":"9D4E1A377BCF23","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":570354,"discussion_content":"老师是科学上网，哈哈哈\n","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1651741240,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1249652,"avatar":"https://static001.geekbang.org/account/avatar/00/13/11/74/72ffa6d6.jpg","nickname":"StayLet","note":"","ucode":"6B748CA3AF3C5B","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":364882,"discussion_content":"哈哈哈哈🤣","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1617634485,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":54737,"user_name":"柯察金","can_delete":false,"product_type":"c1","uid":1115149,"ip_address":"","ucode":"F722BF8FCD2C47","user_header":"https://static001.geekbang.org/account/avatar/00/11/04/0d/3dc5683a.jpg","comment_is_top":false,"comment_ctime":1545958384,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1545958384","product_id":100015201,"comment_content":"我集群搭建起来了，状态都是正常的。但就是无法在主节点上面查看运行在非主节点上面的日志，也无法 exec 进入。。。如果按照老师提供的那个步骤，都会碰到吧","like_count":0},{"had_liked":false,"id":54605,"user_name":"龙须面","can_delete":false,"product_type":"c1","uid":1303391,"ip_address":"","ucode":"6D091EDFD72F5C","user_header":"https://static001.geekbang.org/account/avatar/00/13/e3/5f/49276cd3.jpg","comment_is_top":false,"comment_ctime":1545912656,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1545912656","product_id":100015201,"comment_content":"老师，我是用二进制手工安装的 了，按照网上的教程，在安装完kubelet后，node节点 kubectl get nodes报错the connection to server localhost：8080 was refused did you specify the right host or port？日志里也有连不到apiserver的报错，没有配置认证。master get node只能看到自己，折腾了好久，也不知道从何排查，能否给一些思路","like_count":0},{"had_liked":false,"id":54436,"user_name":"秋风扫落叶","can_delete":false,"product_type":"c1","uid":1358233,"ip_address":"","ucode":"7E71F42B50800B","user_header":"https://static001.geekbang.org/account/avatar/00/14/b9/99/ef60d90f.jpg","comment_is_top":false,"comment_ctime":1545870484,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1545870484","product_id":100015201,"comment_content":"关于镜像获取，可以将docker hub和github关联起来，自定义构建dockerfile，gfw也不能阻挡你获取镜像😲。","like_count":0},{"had_liked":false,"id":54260,"user_name":"C.R7","can_delete":false,"product_type":"c1","uid":1201627,"ip_address":"","ucode":"54A0A1CD050B1B","user_header":"https://static001.geekbang.org/account/avatar/00/12/55/db/9fd0a48d.jpg","comment_is_top":false,"comment_ctime":1545817629,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1545817629","product_id":100015201,"comment_content":"在部署可视化插件时候遇到一个问题，<br>[root@localhost 11]# kubectl get pods -n kube-system<br>NAME                                            READY     STATUS             RESTARTS   AGE<br>coredns-78fcdf6894-fxrw9                        1&#47;1       Running            0          7h<br>coredns-78fcdf6894-wqlgx                        1&#47;1       Running            1          7h<br>etcd-localhost.localdomain                      1&#47;1       Running            0          7h<br>kube-apiserver-localhost.localdomain            1&#47;1       Running            1          7h<br>kube-controller-manager-localhost.localdomain   1&#47;1       Running            0          7h<br>kube-proxy-t2rcc                                1&#47;1       Running            0          7h<br>kube-scheduler-localhost.localdomain            1&#47;1       Running            0          7h<br>kubernetes-dashboard-6c89fd7ddb-w75qq           0&#47;1       CrashLoopBackOff   1          7s<br>weave-net-kkjsn                                 2&#47;2       Running            0          6h<br><br>执行完命令后，有一个pod的出于异常状态，就想把他删除，所以执行了<br>kubectl get pods -n kube-system |grep CrashLoopBackOff | awk &#39;{print $1}&#39;|xargs kubectl delete pod  -n kube-system<br>然后删除之后，再次查询发现自动生成了一个kubernetes-dashboard-....的pod，状态也是出于异常，<br>这种情况，能讲解一下吗","like_count":0},{"had_liked":false,"id":53903,"user_name":"柯察金","can_delete":false,"product_type":"c1","uid":1115149,"ip_address":"","ucode":"F722BF8FCD2C47","user_header":"https://static001.geekbang.org/account/avatar/00/11/04/0d/3dc5683a.jpg","comment_is_top":false,"comment_ctime":1545752021,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1545752021","product_id":100015201,"comment_content":"使用 kubeadm join 的时候，一直加不进去！6443 端口连不同，但是我已经把防火墙关了，master 上面页起来了。。。","like_count":0},{"had_liked":false,"id":50922,"user_name":"JadeG","can_delete":false,"product_type":"c1","uid":1350450,"ip_address":"","ucode":"B3A928A275B2C7","user_header":"https://static001.geekbang.org/account/avatar/00/14/9b/32/afe3734e.jpg","comment_is_top":false,"comment_ctime":1545075871,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1545075871","product_id":100015201,"comment_content":"error logs in k8s_kube-apiserver: <br>open &#47;etc&#47;kubernetes&#47;pki&#47;apiserver.crt: permission denied<br><br>pls do &quot;setenforce 0&quot; ","like_count":0},{"had_liked":false,"id":50666,"user_name":"Chenl07","can_delete":false,"product_type":"c1","uid":1089132,"ip_address":"","ucode":"0A0A086168A8F7","user_header":"http://thirdwx.qlogo.cn/mmopen/vi_32/0FI2bUjegtznv7XPC9DB9RJaqiaMiamWkibibPOibuUC3DCvI7XMvBANr6sDjRNbc1jwPic9pIaFxrdaib88VqUJKXSTQ/132","comment_is_top":false,"comment_ctime":1545026745,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1545026745","product_id":100015201,"comment_content":"老师，我的node节点是多IP的，一个网卡上绑定了多个IP，其中有个node在使用describe node命令中查看到的IP跟masterIP不在一个网段，所有很多地方会报错。<br>有办法强行指定node使用某个IP么？<br><br>Addresses:<br>  InternalIP:  192.168.3.13<br>  Hostname:    node2<br>Capacity:<br> cpu:                2<br> ephemeral-storage:  38770180Ki","like_count":0},{"had_liked":false,"id":49936,"user_name":"LiBin","can_delete":false,"product_type":"c1","uid":1350207,"ip_address":"","ucode":"0877E98FF47803","user_header":"http://thirdwx.qlogo.cn/mmopen/vi_32/DYAIOgq83eqks5UGahZtWN7VNAAkDKWic2yZdDqhj9wItkjTDx5gpqbtur80ibuv5NosiaaVUn3S778iaibUhHmTjcw/132","comment_is_top":false,"comment_ctime":1544793250,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1544793250","product_id":100015201,"comment_content":"这个部署可以用于企业生产环境吗？听说企业都是用二进制文件的方式部署k8s集群，还有一系列的证书。","like_count":0},{"had_liked":false,"id":48984,"user_name":"平方","can_delete":false,"product_type":"c1","uid":1200755,"ip_address":"","ucode":"72D407F25FCA37","user_header":"https://static001.geekbang.org/account/avatar/00/12/52/73/5aed1da6.jpg","comment_is_top":false,"comment_ctime":1544585233,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1544585233","product_id":100015201,"comment_content":" 污点那有点不懂，文中写的是为了让master可以运行POD，在pod的。yaml文件里加入了foo的键就行，但是foo不是加在node1上的么，想要让master可以运行POD，在pod的。yaml文件不是应该加入node-role.kubernetes.io&#47;master的键么<br>","like_count":0},{"had_liked":false,"id":48617,"user_name":"锋","can_delete":false,"product_type":"c1","uid":1247421,"ip_address":"","ucode":"76839165B11E72","user_header":"https://static001.geekbang.org/account/avatar/00/13/08/bd/a2a70bdc.jpg","comment_is_top":false,"comment_ctime":1544497677,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1544497677","product_id":100015201,"comment_content":"非常感谢张磊老师的分享，目前个人想用几台闲置的机器搭建一个实验性质的深度学习平台，张磊老师有这方面的资源分享吗","like_count":0},{"had_liked":false,"id":48577,"user_name":"王由华","can_delete":false,"product_type":"c1","uid":1080681,"ip_address":"","ucode":"355CC4668A4921","user_header":"https://static001.geekbang.org/account/avatar/00/10/7d/69/21b4b5cb.jpg","comment_is_top":false,"comment_ctime":1544490827,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1544490827","product_id":100015201,"comment_content":"仔细浏览了下评论，不明白其中的  pv，pvc 是什么单词、意思？","like_count":0},{"had_liked":false,"id":48077,"user_name":"Vinsec","can_delete":false,"product_type":"c1","uid":1227766,"ip_address":"","ucode":"BFD541E05D3AD7","user_header":"https://static001.geekbang.org/account/avatar/00/12/bb/f6/af833125.jpg","comment_is_top":false,"comment_ctime":1544343721,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1544343721","product_id":100015201,"comment_content":"Node节点在 kubeadm join ... 之后<br>运行 kubectl get nodes 等kubectl命令之后会报错：<br>【The connection to the server localhost:8080 was refused - did you specify the right host or port?】<br><br>同Master节点类似，我也将&#47;etc&#47;kubernetes下的kubelet.conf 复制到 ~&#47;.kube&#47;config 下。<br><br>再次运行 kubectl get nodes则正常显示。<br><br>那么请问要能使得kubectl能够有权限访问集群，是否只需要在~&#47;.kube&#47;config 中手动写入[certificate-authority-data]就可以。即对于kubectl 访问权限真正有效的，是不是就是&#47;etc&#47;kubernetes&#47;*.config 任一config文件中的[certificate-authority-data]字段","like_count":0},{"had_liked":false,"id":47035,"user_name":"盖盖","can_delete":false,"product_type":"c1","uid":1317683,"ip_address":"","ucode":"8DB43A59BAD623","user_header":"","comment_is_top":false,"comment_ctime":1544023063,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1544023063","product_id":100015201,"comment_content":"k8s集群怎么指定外部的etcd集群","like_count":0},{"had_liked":false,"id":46436,"user_name":"海","can_delete":false,"product_type":"c1","uid":1226625,"ip_address":"","ucode":"356EABFD394513","user_header":"https://static001.geekbang.org/account/avatar/00/12/b7/81/ac11be3b.jpg","comment_is_top":false,"comment_ctime":1543925957,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1543925957","product_id":100015201,"comment_content":"刚接触k8s的新手的话还是用二进制安装集群的好，这样能很好理解和熟悉k8s的架构。","like_count":0},{"had_liked":false,"id":46431,"user_name":"王天神","can_delete":false,"product_type":"c1","uid":1311149,"ip_address":"","ucode":"16384EF0E19E2A","user_header":"http://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTI3jUBQJMfLRQiaKpghicMot32AE70icSn1EsP7vX9t1V2qkp5oM0uXtnp5qmWlZgnXKk2mac0XdgVUQ/132","comment_is_top":false,"comment_ctime":1543924783,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1543924783","product_id":100015201,"comment_content":"很多人还不能访问外网，能分享下怎么有限网络 部署？","like_count":0},{"had_liked":false,"id":46008,"user_name":"Zzde丶","can_delete":false,"product_type":"c1","uid":1313360,"ip_address":"","ucode":"6DC9D9E91BF16D","user_header":"https://static001.geekbang.org/account/avatar/00/14/0a/50/97aaa1cd.jpg","comment_is_top":false,"comment_ctime":1543832193,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1543832193","product_id":100015201,"comment_content":"如果我需要更改其中一个的节点名字，该如何操作","like_count":0},{"had_liked":false,"id":45859,"user_name":"豆沙包","can_delete":false,"product_type":"c1","uid":1262727,"ip_address":"","ucode":"D4F2908B4A1FE2","user_header":"","comment_is_top":false,"comment_ctime":1543804194,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1543804194","product_id":100015201,"comment_content":"老师，master节点上生成的kubelet.conf里certificate-authority-data对应的是ca.crt的内容，请问您client-certificate-data字段有对应的文件吗？之前以为是对应&#47;var&#47;lib&#47;kubelet&#47;pki里的kubelet-client-current.pem，但是发现不是。","like_count":0},{"had_liked":false,"id":45487,"user_name":"꧁༺宏杰༻꧂","can_delete":false,"product_type":"c1","uid":1332663,"ip_address":"","ucode":"EF114337913A9D","user_header":"https://static001.geekbang.org/account/avatar/00/14/55/b7/a8148556.jpg","comment_is_top":false,"comment_ctime":1543653115,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1543653115","product_id":100015201,"comment_content":"执行了dashboard和存储 为什么都不是running呢。","like_count":0},{"had_liked":false,"id":43691,"user_name":"刘岚乔月","can_delete":false,"product_type":"c1","uid":1095289,"ip_address":"","ucode":"99A9AB4E4E1111","user_header":"https://static001.geekbang.org/account/avatar/00/10/b6/79/22e582a5.jpg","comment_is_top":false,"comment_ctime":1543281497,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1543281497","product_id":100015201,"comment_content":"用docker for mac 安装k8s 与这个有什么区别嘛","like_count":0},{"had_liked":false,"id":43591,"user_name":"sotey","can_delete":false,"product_type":"c1","uid":1221689,"ip_address":"","ucode":"7D3B7E45FC18BA","user_header":"https://static001.geekbang.org/account/avatar/00/12/a4/39/6a5cd1d8.jpg","comment_is_top":false,"comment_ctime":1543243193,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1543243193","product_id":100015201,"comment_content":"生命不息，折腾不止！由于公司所有服务器都用的redhat或者CentOS，我在CentOS上折腾了一个月还是没把双节点、三节点折腾出来，今天换成Ubuntu一波就搞定了~！！正在思考怎么说服老板让同事们学学Ubuntu，我对Ubuntu也不熟- _ -！老师有没有CentOS上折腾k8s的教程啊？还是不甘心啊，还想折腾。","like_count":0},{"had_liked":false,"id":43030,"user_name":"石头剪刀布","can_delete":false,"product_type":"c1","uid":1080353,"ip_address":"","ucode":"7659B10D189153","user_header":"http://thirdwx.qlogo.cn/mmopen/vi_32/DYAIOgq83eq6tsM65SmllxicEqqbaHcnqOw6O541JJ8ib75qyZ0zAGLxFOpV9L5kwr1dLCvgeL1V52cOu3yZLN2g/132","comment_is_top":false,"comment_ctime":1543144383,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1543144383","product_id":100015201,"comment_content":"2018&#47;11&#47;25 11:08:23 [2018-11-25T11:08:23Z] Incoming HTTP&#47;2.0 GET &#47;api&#47;v1&#47;csrftoken&#47;login request from 10.244.0.0:50800: { contents hidden }<br>2018&#47;11&#47;25 11:08:23 [2018-11-25T11:08:23Z] Outcoming response to 10.244.0.0:50800 with 200 status code<br>2018&#47;11&#47;25 11:08:23 [2018-11-25T11:08:23Z] Incoming HTTP&#47;2.0 POST &#47;api&#47;v1&#47;login request from 10.244.0.0:50800: { contents hidden }<br>2018&#47;11&#47;25 11:08:23 [2018-11-25T11:08:23Z] Outcoming response to 10.244.0.0:50800 with 200 status code<br>2018&#47;11&#47;25 11:08:23 [2018-11-25T11:08:23Z] Incoming HTTP&#47;2.0 GET &#47;api&#47;v1&#47;login&#47;status request from 10.244.0.0:50800: {}2018&#47;11&#47;25 11:08:23 [2018-11-25T11:08:23Z] Incoming HTTP&#47;2.0 GET &#47;api&#47;v1&#47;csrftoken&#47;login request from 10.244.0.0:50800: { contents hidden }<br>2018&#47;11&#47;25 11:08:23 [2018-11-25T11:08:23Z] Outcoming response to 10.244.0.0:50800 with 200 status code<br>2018&#47;11&#47;25 11:08:23 [2018-11-25T11:08:23Z] Incoming HTTP&#47;2.0 POST &#47;api&#47;v1&#47;login request from 10.244.0.0:50800: { contents hidden }<br>2018&#47;11&#47;25 11:08:23 [2018-11-25T11:08:23Z] Outcoming response to 10.244.0.0:50800 with 200 status code<br>2018&#47;11&#47;25 11:08:23 [2018-11-25T11:08:23Z] Incoming HTTP&#47;2.0 GET &#47;api&#47;v1&#47;login&#47;status request from 10.244.0.0:50800: {}<br>2018&#47;11&#47;25 11:08:23 [2018-11-25T11:08:23Z] Outcoming response to 10.244.0.0:50800 with 200 status code<br>2018&#47;11&#47;25 11:08:46 Metric client health check failed: the server could not find the requested resource (get services heapster). Retrying in 30 seconds.<br><br><br>token 方式登录， 点击&quot;登录&quot;， 毫无反应。<br>执行 kubectl logs -f kubernetes-dashboard-69dcdb65fd-clxrq --namespace=kube-system<br>一直报上述错误。 <br>希望老师帮忙一下原因，谢谢。","like_count":0},{"had_liked":false,"id":42509,"user_name":"test","can_delete":false,"product_type":"c1","uid":1065849,"ip_address":"","ucode":"9A4973E591DD12","user_header":"https://static001.geekbang.org/account/avatar/00/10/43/79/18073134.jpg","comment_is_top":false,"comment_ctime":1542963441,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1542963441","product_id":100015201,"comment_content":"千万级别，但是到十万还是百万的时候网络已经损耗过大","like_count":0},{"had_liked":false,"id":42181,"user_name":"牛逼但","can_delete":false,"product_type":"c1","uid":1318525,"ip_address":"","ucode":"82408296E3F47E","user_header":"","comment_is_top":false,"comment_ctime":1542933149,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1542933149","product_id":100015201,"comment_content":"老师好 存储插件，网络插件，dashboard都是安装在master节点的吗？","like_count":0},{"had_liked":false,"id":41912,"user_name":"mutexlock","can_delete":false,"product_type":"c1","uid":1258434,"ip_address":"","ucode":"FCE8B3AD122CEB","user_header":"https://static001.geekbang.org/account/avatar/00/13/33/c2/e135113a.jpg","comment_is_top":false,"comment_ctime":1542871612,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1542871612","product_id":100015201,"comment_content":"通过describe 我发现etcd也挂了 不知道什么原因导致<br>root@ubuntu:&#47;data&#47;k8s# kubectl describe pod etcd-ubuntu   -n kube-system<br>之后event也没有什么<br>QoS Class:         BestEffort<br>Node-Selectors:    &lt;none&gt;<br>Tolerations:       :NoExecute<br>Events:            &lt;none&gt;<br>把worker节点执行kubeadm reset后，master节点就好了","like_count":0},{"had_liked":false,"id":41910,"user_name":"mutexlock","can_delete":false,"product_type":"c1","uid":1258434,"ip_address":"","ucode":"FCE8B3AD122CEB","user_header":"https://static001.geekbang.org/account/avatar/00/13/33/c2/e135113a.jpg","comment_is_top":false,"comment_ctime":1542871369,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1542871369","product_id":100015201,"comment_content":"老师，请教个问题，我创建好了master节点，之后我用另一个机器执行join操作，提示加入成功了。<br>这时候我们执行 <br>root@ubuntu:&#47;data&#47;k8s# kubectl get nodes<br>NAME      STATUS    ROLES     AGE       VERSION<br>ubuntu    Ready     master    18h       v1.11.3<br>发现还是只有master，我看了下pod的状态，发现kube-apiserver-ubuntu和kube-scheduler-ubunt变成了Pending, <br>root@ubuntu:&#47;data&#47;k8s# kubectl get pods -n kube-system<br>NAME                       READY     STATUS    RESTARTS   AGE<br>coredns-78fcdf6894-5lrr8   1&#47;1       Running   0          18h<br>coredns-78fcdf6894-stcsc   1&#47;1       Running   0          18h<br>kube-apiserver-ubuntu      0&#47;1       Pending   0          1s<br>kube-proxy-67z6t           1&#47;1       Running   0          18h<br>kube-scheduler-ubuntu      0&#47;1       Pending   0          0s<br>weave-net-t4mv8            2&#47;2       Running   0          18h<br>我把worker节点的执行 kubeadm reset后，上面的状态就好了，我是个初学者，不知道如何入手。我想知道这个如何定位问题出在什么地方？ ","like_count":0},{"had_liked":false,"id":40936,"user_name":"每日都想上班","can_delete":false,"product_type":"c1","uid":1060466,"ip_address":"","ucode":"1DE64120C8B14A","user_header":"https://static001.geekbang.org/account/avatar/00/10/2e/72/145c10db.jpg","comment_is_top":false,"comment_ctime":1542698036,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1542698036","product_id":100015201,"comment_content":"我的rook执行了两行apply后怎么没出现rook-ceph-mgr-dashboard呢？","like_count":0},{"had_liked":false,"id":39773,"user_name":"arlose","can_delete":false,"product_type":"c1","uid":1154358,"ip_address":"","ucode":"C58C16EC025AE6","user_header":"https://static001.geekbang.org/account/avatar/00/11/9d/36/2f36e1a8.jpg","comment_is_top":false,"comment_ctime":1542354144,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1542354144","product_id":100015201,"comment_content":"请问老师，我这边有三台机器不在同一个局域网的话，需要怎么加入kubernetes集群？","like_count":0},{"had_liked":false,"id":38902,"user_name":"东东宝","can_delete":false,"product_type":"c1","uid":1280988,"ip_address":"","ucode":"51C107079AA1F3","user_header":"http://thirdwx.qlogo.cn/mmopen/vi_32/DYAIOgq83eo8rz97dFZTzBQK3xVY8NBfP6faZhvYCoDj8unSZIIhftpGWvJFYB6CEdf6bUu2rBNrabR3umc7jw/132","comment_is_top":false,"comment_ctime":1542158764,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1542158764","product_id":100015201,"comment_content":"张老师，利用kubeadm安装的k8s  master宕机了，有什么方法可以重启啊？","like_count":0},{"had_liked":false,"id":38008,"user_name":"涛","can_delete":false,"product_type":"c1","uid":1202964,"ip_address":"","ucode":"E2DE6CF556C2B6","user_header":"https://static001.geekbang.org/account/avatar/00/12/5b/14/a1567454.jpg","comment_is_top":false,"comment_ctime":1541856507,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1541856507","product_id":100015201,"comment_content":"[ERROR KubeletVersion]: the kubelet version is higher than the control plane version. This is not a supported version skew and may lead to a malfunctional cluster. Kubelet version: &quot;1.12.2&quot; Control plane version: &quot;1.11.1&quot;<br>[preflight] If you know what you are doing, you can make a check non-fatal with `--ignore-preflight-errors=...`<br>这个错误怎么弄啊，系统是centos，不知到为什么装的kubeadm 1.11.1自动把kubelet1.12.2就安装上啦而不是1.11.1，如果升级kubeadm1.12后面kubeadm init ...会报拉取镜像失败，有没有详细一点centos操作k8s文档，包括在那个文件下创建什么东西？<br><br>centos使用yum不是用apt-get,这个第一部分怎么改？<br>$ curl -s https:&#47;&#47;packages.cloud.google.com&#47;apt&#47;doc&#47;apt-key.gpg | apt-key add -<br>$ cat &lt;&lt;EOF &gt; &#47;etc&#47;apt&#47;sources.list.d&#47;kubernetes.list<br>deb http:&#47;&#47;apt.kubernetes.io&#47; kubernetes-xenial main<br>EOF<br>$ apt-get update<br>$ apt-get install -y docker.io kubeadm<br>谢谢！<br>","like_count":0},{"had_liked":false,"id":37706,"user_name":"涛","can_delete":false,"product_type":"c1","uid":1202964,"ip_address":"","ucode":"E2DE6CF556C2B6","user_header":"https://static001.geekbang.org/account/avatar/00/12/5b/14/a1567454.jpg","comment_is_top":false,"comment_ctime":1541688132,"is_pvip":false,"replies":[{"id":"13572","content":"几乎没区别","user_name":"作者回复","user_name_real":"Geek_6ef93d","uid":"1218095","ctime":1541719143,"ip_address":"","comment_id":37706,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1541688132","product_id":100015201,"comment_content":"有没有centos操作文档呀","like_count":0,"discussions":[{"author":{"id":1218095,"avatar":"https://static001.geekbang.org/account/avatar/00/12/96/2f/876085fa.jpg","nickname":"张磊 Kubernetes","note":"","ucode":"16E29BDAB1F5BC","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":428458,"discussion_content":"几乎没区别","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1541719143,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":36195,"user_name":"每日都想上班","can_delete":false,"product_type":"c1","uid":1060466,"ip_address":"","ucode":"1DE64120C8B14A","user_header":"https://static001.geekbang.org/account/avatar/00/10/2e/72/145c10db.jpg","comment_is_top":false,"comment_ctime":1540972838,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1540972838","product_id":100015201,"comment_content":"weave和flannel两个都部署在容器中是不是可以的，发现我们之前部署都两个都在里面运行着","like_count":0},{"had_liked":false,"id":34759,"user_name":"何文强在江湖","can_delete":false,"product_type":"c1","uid":1064361,"ip_address":"","ucode":"F25DC6D571A4B3","user_header":"https://static001.geekbang.org/account/avatar/00/10/3d/a9/0d2c7138.jpg","comment_is_top":false,"comment_ctime":1540285847,"is_pvip":false,"replies":[{"id":"12433","content":"你这地址语言安全组吗？","user_name":"作者回复","user_name_real":"Geek_6ef93d","uid":"1218095","ctime":1540316798,"ip_address":"","comment_id":34759,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1540285847","product_id":100015201,"comment_content":"AWS服务器进行worker部署的时候报这个错，这个ip ping不通啊<br>[discovery] Failed to request cluster info, will try again: [Get https:&#47;&#47;172.31.1.235:6443&#47;api&#47;v1&#47;namespaces&#47;kube-public&#47;configmaps&#47;cluster-info: dial tcp 172.31.1.235:6443: i&#47;o timeout]","like_count":0,"discussions":[{"author":{"id":1218095,"avatar":"https://static001.geekbang.org/account/avatar/00/12/96/2f/876085fa.jpg","nickname":"张磊 Kubernetes","note":"","ucode":"16E29BDAB1F5BC","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":427325,"discussion_content":"你这地址语言安全组吗？","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1540316798,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":34695,"user_name":"Tylar","can_delete":false,"product_type":"c1","uid":1219676,"ip_address":"","ucode":"682412C5E7540D","user_header":"https://static001.geekbang.org/account/avatar/00/12/9c/5c/69ca7575.jpg","comment_is_top":false,"comment_ctime":1540260195,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1540260195","product_id":100015201,"comment_content":"[root@localhost ~]# kubectl get pods --namespace rook-ceph-system\rNAME                                  READY   STATUS    RESTARTS   AGE\rrook-ceph-agent-mwrbm                 1&#47;1     Running   0          14h\rrook-ceph-operator-5bfbf654db-mwnqs   1&#47;1     Running   0          14h\rrook-discover-4xn2l                   1&#47;1     Running   0          14h<br><br>之前的是成功的","like_count":0},{"had_liked":false,"id":34467,"user_name":"kkgo","can_delete":false,"product_type":"c1","uid":1199356,"ip_address":"","ucode":"AFCCBFD96CFA21","user_header":"https://static001.geekbang.org/account/avatar/00/12/4c/fc/0e887697.jpg","comment_is_top":false,"comment_ctime":1540181314,"is_pvip":false,"discussion_count":0,"race_medal":1,"score":"1540181314","product_id":100015201,"comment_content":"no kind &quot;MasterConfiguration&quot; is registered for version &quot;kubeadm.k8s.io&#47;v1.11&quot; in scheme &quot;k8s.io&#47;kubernetes&#47;cmd&#47;kubeadm&#47;app&#47;apis&#47;kubeadm&#47;scheme&#47;scheme.go:31&quot;<br> <br> centos7  国内你们配置什么镜像地址下载","like_count":0},{"had_liked":false,"id":34238,"user_name":"帅","can_delete":false,"product_type":"c1","uid":1207367,"ip_address":"","ucode":"DB792F56C26429","user_header":"https://static001.geekbang.org/account/avatar/00/12/6c/47/57b6c4e8.jpg","comment_is_top":false,"comment_ctime":1540045833,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1540045833","product_id":100015201,"comment_content":"老师好，文中说kube-controller-manager依赖网络，可是为什么我实践到这一步的时候，没有部署weave，controller的pod也是running状态呢？此处的信息是不是有误？下面是我实践后输出的结果<br>我的环境是windows 下vritualbox+ubuntu16.04，刚执行完kubeadm init。希望得到老师专业的指导。谢谢！<br>root@qianshuai-VirtualBox:~# kubectl get pods -n kube-system<br>NAME                                           READY     STATUS    RESTARTS   AGE<br>coredns-78fcdf6894-75r7h                       0&#47;1       Pending   0          5m<br>coredns-78fcdf6894-tqvkc                       0&#47;1       Pending   0          5m<br>etcd-qianshuai-virtualbox                      1&#47;1       Running   1          7m<br>kube-apiserver-qianshuai-virtualbox            1&#47;1       Running   0          5m<br>kube-controller-manager-qianshuai-virtualbox   1&#47;1       Running   0          5m<br>kube-proxy-lgxw4                               1&#47;1       Running   0          5m<br>kube-scheduler-qianshuai-virtualbox            1&#47;1       Running   1          8m<br><br>安装完weave后的输出如下：<br>root@qianshuai-VirtualBox:~# kubectl get pods -n kube-system<br>NAME                                           READY     STATUS    RESTARTS   AGE<br>coredns-78fcdf6894-75r7h                       1&#47;1       Running   0          16m<br>coredns-78fcdf6894-tqvkc                       1&#47;1       Running   0          16m<br>etcd-qianshuai-virtualbox                      1&#47;1       Running   1          19m<br>kube-apiserver-qianshuai-virtualbox            1&#47;1       Running   0          17m<br>kube-controller-manager-qianshuai-virtualbox   1&#47;1       Running   0          17m<br>kube-proxy-lgxw4                               1&#47;1       Running   0          16m<br>kube-scheduler-qianshuai-virtualbox            1&#47;1       Running   1          20m<br>weave-net-jlbhw                                2&#47;2       Running   0          1m<br><br>","like_count":0},{"had_liked":false,"id":33929,"user_name":"kkgo","can_delete":false,"product_type":"c1","uid":1199356,"ip_address":"","ucode":"AFCCBFD96CFA21","user_header":"https://static001.geekbang.org/account/avatar/00/12/4c/fc/0e887697.jpg","comment_is_top":false,"comment_ctime":1539919934,"is_pvip":false,"replies":[{"id":"12149","content":"……没有区别","user_name":"作者回复","user_name_real":"Geek_6ef93d","uid":"1218095","ctime":1539935040,"ip_address":"","comment_id":33929,"utype":1}],"discussion_count":1,"race_medal":1,"score":"1539919934","product_id":100015201,"comment_content":"线上都是centos版本系统，老师能不能照顾下centos","like_count":0,"discussions":[{"author":{"id":1218095,"avatar":"https://static001.geekbang.org/account/avatar/00/12/96/2f/876085fa.jpg","nickname":"张磊 Kubernetes","note":"","ucode":"16E29BDAB1F5BC","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":427075,"discussion_content":"……没有区别","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1539935040,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":32596,"user_name":"Will","can_delete":false,"product_type":"c1","uid":1256770,"ip_address":"","ucode":"671FFBDF1A3E69","user_header":"https://static001.geekbang.org/account/avatar/00/13/2d/42/6e3be953.jpg","comment_is_top":false,"comment_ctime":1539618544,"is_pvip":false,"replies":[{"id":"11900","content":"会给出","user_name":"作者回复","user_name_real":"Geek_6ef93d","uid":"1218095","ctime":1539652805,"ip_address":"","comment_id":32596,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1539618544","product_id":100015201,"comment_content":"每节课后的思考题有参考 答 案吗？最好能在每期把上一期的参 考答 案发出来。谢谢","like_count":0,"discussions":[{"author":{"id":1218095,"avatar":"https://static001.geekbang.org/account/avatar/00/12/96/2f/876085fa.jpg","nickname":"张磊 Kubernetes","note":"","ucode":"16E29BDAB1F5BC","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":426830,"discussion_content":"会给出","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1539652805,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":31974,"user_name":"shaobo","can_delete":false,"product_type":"c1","uid":1087931,"ip_address":"","ucode":"E47B99769A9EAF","user_header":"https://static001.geekbang.org/account/avatar/00/10/99/bb/90d97247.jpg","comment_is_top":false,"comment_ctime":1539346404,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1539346404","product_id":100015201,"comment_content":"请问，使用flannel做网络 calico做不同namespace间的隔离，这种方案稳定性如何","like_count":0},{"had_liked":false,"id":30189,"user_name":"看不穿","can_delete":false,"product_type":"c1","uid":1259769,"ip_address":"","ucode":"8D35C36C7A35F0","user_header":"https://static001.geekbang.org/account/avatar/00/13/38/f9/2b4755b5.jpg","comment_is_top":false,"comment_ctime":1538719100,"is_pvip":false,"replies":[{"id":"10867","content":"kubeadm已经有有高可用master的部署文档了","user_name":"作者回复","user_name_real":"Geek_6ef93d","uid":"1218095","ctime":1538739334,"ip_address":"","comment_id":30189,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1538719100","product_id":100015201,"comment_content":"老师，请问maste节点是单节点，万一master坏了，怎么办，怎么给master做高可用","like_count":0,"discussions":[{"author":{"id":1218095,"avatar":"https://static001.geekbang.org/account/avatar/00/12/96/2f/876085fa.jpg","nickname":"张磊 Kubernetes","note":"","ucode":"16E29BDAB1F5BC","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":425887,"discussion_content":"kubeadm已经有有高可用master的部署文档了","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1538739334,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":29201,"user_name":"Genius","can_delete":false,"product_type":"c1","uid":1042240,"ip_address":"","ucode":"425F2925BB1C27","user_header":"https://static001.geekbang.org/account/avatar/00/0f/e7/40/e592d386.jpg","comment_is_top":false,"comment_ctime":1538287501,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1538287501","product_id":100015201,"comment_content":"This error is likely caused by:<br>\t\t\t- The kubelet is not running<br>\t\t\t- The kubelet is unhealthy due to a misconfiguration of the node in some way (required cgroups disabled)<br>\t\t\t- No internet connection is available so the kubelet cannot pull or find the following control plane images:<br>\t\t\t\t- k8s.gcr.io&#47;kube-apiserver-amd64:v1.11.3<br>\t\t\t\t- k8s.gcr.io&#47;kube-controller-manager-amd64:v1.11.3<br>\t\t\t\t- k8s.gcr.io&#47;kube-scheduler-amd64:v1.11.3<br>\t\t\t\t- k8s.gcr.io&#47;etcd-amd64:3.2.18<br>\t\t\t\t- You can check or miligate this in beforehand with &quot;kubeadm config images pull&quot; to make sure the images<br>\t\t\t\t  are downloaded locally and cached.<br><br>\t\tIf you are on a systemd-powered system, you can try to troubleshoot the error with the following commands:<br>\t\t\t- &#39;systemctl status kubelet&#39;<br>\t\t\t- &#39;journalctl -xeu kubelet&#39;<br><br>root@ubuntu:~# journalctl -f -u kubelet.service <br>-- Logs begin at Sun 2018-09-30 10:06:54 CST. --<br>Sep 30 14:03:49 ubuntu kubelet[22077]: W0930 14:03:49.066086   22077 cni.go:172] Unable to update cni config: No networks found in &#47;etc&#47;cni&#47;net.d<br>Sep 30 14:03:49 ubuntu kubelet[22077]: E0930 14:03:49.066332   22077 kubelet.go:2110] Container runtime network not ready: NetworkReady=false reason:NetworkPluginNotReady message:docker: network plugin is not ready: cni config uninitialized<br>Sep 30 14:03:54 ubuntu kubelet[22077]: W0930 14:03:54.067145   22077 cni.go:172] Unable to update cni config: No networks found in &#47;etc&#47;cni&#47;net.d<br><br><br><br>老师，这个kubelet有问题吗，为啥一直报这个cni初始化失败呢<br>","like_count":0},{"had_liked":false,"id":28957,"user_name":"asdf100","can_delete":false,"product_type":"c1","uid":1043738,"ip_address":"","ucode":"39D8D71453E575","user_header":"https://static001.geekbang.org/account/avatar/00/0f/ed/1a/ce7f7d54.jpg","comment_is_top":false,"comment_ctime":1538207242,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1538207242","product_id":100015201,"comment_content":"root@ubuntu:~&#47;k8s# kubectl get pods -n rook-ceph-system<br>NAME                                  READY     STATUS                 RESTARTS   AGE<br>rook-ceph-operator-78d498c68c-rfph5   0&#47;1       CreateContainerError   0          5m<br><br>root@ubuntu:~&#47;k8s# kubectl describe pods rook-ceph-operator-78d498c68c-rfph5 -n rook-ceph-system<br>Node:               ubuntu&#47;10.0.2.15<br>Labels:             app=rook-ceph-operator<br>                    pod-template-hash=3480547247<br>Annotations:        &lt;none&gt;<br>Status:             Pending<br>IP:                 10.32.0.4<br>Controlled By:      ReplicaSet&#47;rook-ceph-operator-78d498c68c<br>Containers:<br>  rook-ceph-operator:<br>    Container ID:<br>  .....<br>    Args:<br>      ceph<br>      operator<br>    State:          Waiting<br>      Reason:       CreateContainerError<br>    Ready:          False<br>    Restart Count:  0<br>    Environment:<br>      ROOK_ALLOW_MULTIPLE_FILESYSTEMS:    false<br>      ROOK_LOG_LEVEL:                     INFO<br>      ROOK_MON_HEALTHCHECK_INTERVAL:      45s<br>      ROOK_MON_OUT_TIMEOUT:               300s<br>      ROOK_HOSTPATH_REQUIRES_PRIVILEGED:  false<br>      NODE_NAME:                           (v1:spec.nodeName)<br>      POD_NAME:                           rook-ceph-operator-78d498c68c-rfph5 (v1:metadata.name)<br>      POD_NAMESPACE:                      rook-ceph-system (v1:metadata.namespace)<br>    Mounts:<br>      &#47;etc&#47;ceph from default-config-dir (rw)<br>      &#47;var&#47;lib&#47;rook from rook-config (rw)<br>.......<br>  Type     Reason     Age                From               Message<br>  ----     ------     ----               ----               -------<br>  Normal   Scheduled  2m                 default-scheduler  Successfully assigned rook-ceph-system&#47;rook-ceph-operator-78d498c68c-rfph5 to ubuntu<br>  Warning  Failed     2m                 kubelet, ubuntu    Error: Error response from daemon: error creating aufs mount to &#47;var&#47;lib&#47;docker&#47;aufs&#47;mnt&#47;35cf1227e66382a4fc04012401bd73a12cd73499613f09be3b488b56692c11e5-init: invalid argument<br><br>Master和Worker在同一台机器上，从0重度了10多次了，什么原因？","like_count":0},{"had_liked":false,"id":28249,"user_name":"V V","can_delete":false,"product_type":"c1","uid":1220390,"ip_address":"","ucode":"9494330A6AA770","user_header":"https://static001.geekbang.org/account/avatar/00/12/9f/26/89eda2c8.jpg","comment_is_top":false,"comment_ctime":1538032799,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1538032799","product_id":100015201,"comment_content":"kubelet起不起来，按照这个方法增加了参数echo &#39;Environment=&quot;KUBELET_EXTRA_ARGS=--fail-swap-on=false&quot;&#39; &gt;&gt; &#47;etc&#47;systemd&#47;system&#47;kubelet.service.d&#47;10-kubeadm.conf，并且执行了swapoff -a &amp;&amp; sed -i &#39;&#47;swap&#47;d&#39; &#47;etc&#47;fstab。还是提示没有禁用swap。<br>failed to run Kubelet: Running with swap on is not supported, pljbe disable swap! or set --fail-swap-on flag to false. &#47;proc&#47;sw<br>9月 27 15:15:17 master systemd[1]: kubelet.service: Main process exited, code=exited, status=255&#47;n&#47;a","like_count":0},{"had_liked":false,"id":26611,"user_name":"vx:jiancheng_goon","can_delete":false,"product_type":"c1","uid":1218615,"ip_address":"","ucode":"FD34901B061825","user_header":"https://static001.geekbang.org/account/avatar/00/12/98/37/7f575aec.jpg","comment_is_top":false,"comment_ctime":1537696157,"is_pvip":false,"replies":[{"id":"9681","content":"不了解","user_name":"作者回复","user_name_real":"Geek_6ef93d","uid":"1218095","ctime":1537706781,"ip_address":"","comment_id":26611,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1537696157","product_id":100015201,"comment_content":"请教一个问题，我通过rancher部署的k8s，在各个节点看都有kubelet的容器，但是宿主机上也有kubelet的进程。真正干活的是kubelet的话，那么对应的容器又是做什么的呢？","like_count":0,"discussions":[{"author":{"id":1218095,"avatar":"https://static001.geekbang.org/account/avatar/00/12/96/2f/876085fa.jpg","nickname":"张磊 Kubernetes","note":"","ucode":"16E29BDAB1F5BC","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":424684,"discussion_content":"不了解","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1537706781,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":26564,"user_name":"一叶","can_delete":false,"product_type":"c1","uid":1115608,"ip_address":"","ucode":"EB018BDA606A33","user_header":"https://static001.geekbang.org/account/avatar/00/11/05/d8/cd269378.jpg","comment_is_top":false,"comment_ctime":1537672797,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1537672797","product_id":100015201,"comment_content":"分享一个二进制安装脚本：<br>https:&#47;&#47;github.com&#47;SongCF&#47;kubesh","like_count":0},{"had_liked":false,"id":26380,"user_name":"同心结","can_delete":false,"product_type":"c1","uid":1248791,"ip_address":"","ucode":"84E7796FE1A602","user_header":"https://static001.geekbang.org/account/avatar/00/13/0e/17/0aa98ae7.jpg","comment_is_top":false,"comment_ctime":1537582596,"is_pvip":false,"replies":[{"id":"9593","content":"节点沟通有问题？","user_name":"作者回复","user_name_real":"Geek_6ef93d","uid":"1218095","ctime":1537604450,"ip_address":"","comment_id":26380,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1537582596","product_id":100015201,"comment_content":"你好，我按照你的教程只用一个单节点是没有问题的。但是加入node节点之后，创建deployment，pod状态显示Successfully assigned default&#47;myweb1-6cb867d96-mntzs to node1，然后node1一直没反应，最后会超时报错","like_count":0,"discussions":[{"author":{"id":1218095,"avatar":"https://static001.geekbang.org/account/avatar/00/12/96/2f/876085fa.jpg","nickname":"张磊 Kubernetes","note":"","ucode":"16E29BDAB1F5BC","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":424611,"discussion_content":"节点沟通有问题？","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1537604450,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":26231,"user_name":"ninvfeng","can_delete":false,"product_type":"c1","uid":1215595,"ip_address":"","ucode":"4BE329DD12EF78","user_header":"https://static001.geekbang.org/account/avatar/00/12/8c/6b/d2672f70.jpg","comment_is_top":false,"comment_ctime":1537523786,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1537523786","product_id":100015201,"comment_content":"开了代理提示这个: <br>➜  kubeadm kubeadm init --config kubeadm.yaml<br>I0921 08:41:04.409154    1333 feature_gate.go:230] feature gates: &amp;{map[]}<br>[init] using Kubernetes version: v1.11.3<br>[preflight] running pre-flight checks<br>\t[WARNING HTTPProxy]: Connection to &quot;https:&#47;&#47;10.0.2.15&quot; uses proxy &quot;http:&#47;&#47;192.168.33.11:1080&quot;. If that is not intended, adjust your proxy settings<br>\t[WARNING HTTPProxyCIDR]: connection to &quot;10.96.0.0&#47;12&quot; uses proxy &quot;http:&#47;&#47;192.168.33.1:1080&quot;. This may lead to malfunctional cluster setup. Make sure that Pod and Services IP ranges specified correctly as exceptions in proxy configuration<br>I0921 08:41:04.435667    1333 kernel_validator.go:81] Validating kernel version<br>I0921 08:41:04.435709    1333 kernel_validator.go:96] Validating kernel config<br>\t[WARNING SystemVerification]: docker version is greater than the most recently validated version. Docker version: 18.06.1-ce. Max validated version: 17.03<br>[preflight] Some fatal errors occurred:<br>\t[ERROR Swap]: running with swap on is not supported. Please disable swap<br>[preflight] If you know what you are doing, you can make a check non-fatal with `--ignore-preflight-errors=...`<br><br>没开代理提示: <br>➜  kubeadm kubeadm init --config kubeadm.yaml<br>unable to get URL &quot;https:&#47;&#47;dl.k8s.io&#47;release&#47;stable-1.11.txt&quot;: Get https:&#47;&#47;storage.googleapis.com&#47;kubernetes-release&#47;release&#47;stable-1.11.txt: dial tcp 172.217.31.240:443: i&#47;o timeout<br>","like_count":0}]}