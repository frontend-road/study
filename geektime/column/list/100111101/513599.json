{"id":513599,"title":"09 | ä»£ç ç°ä»£åŒ–ï¼šå¦‚ä½•å°†ä¸€ä¸ª300è¡Œçš„æ–¹æ³•é‡æ„ä¸º3è¡Œï¼Ÿ","content":"<p>ä½ å¥½ï¼Œæˆ‘æ˜¯å§šçªç³ã€‚</p><p>åœ¨ä¸ŠèŠ‚è¯¾é‡Œï¼Œæˆ‘ä»¬å­¦ä¹ äº†å¦‚ä½•å¯¹é—ç•™ä»£ç åšå¯æµ‹è¯•åŒ–é‡æ„ï¼Œå¹¶æ·»åŠ æµ‹è¯•ã€‚æœ‰äº†æµ‹è¯•çš„ä¿éšœï¼Œæ¥ä¸‹æ¥å°±å¯ä»¥å¤§èƒ†åœ°å¼€å§‹é‡æ„â€œçƒ‚ä»£ç â€äº†ã€‚</p><p>åœ¨é‡æ„äº†å¤§é‡é—ç•™ä»£ç åï¼Œæˆ‘ç»ˆäºæ‰¾åˆ°äº†ä¸¤ä¸ªæœ€å®ç”¨çš„æ–¹æ³•ï¼Œè¿™èŠ‚è¯¾æˆ‘å°±å¸¦ä½ è®¤è¯†è¿™ä¸¤ç§é‡æ„é—ç•™ä»£ç çš„åˆ©å™¨ï¼Œæˆ‘æŠŠå®ƒä»¬ç§°ä¸ºâ€œå€šå¤©å‰‘â€å’Œâ€œå± é¾™åˆ€â€ï¼Œå¯ä»¥å¸®ä½ åŠˆå¼€ä¸€å›¢ä¹±éº»å¼çš„ä»£ç ã€‚</p><p>æˆ‘æ›¾ç»ç”¨è¿™ä¸¤ç§æ¨¡å¼å°†ä¸€ä¸ª300è¡Œä»£ç é‡æ„ä¸º3è¡Œã€‚æ˜¯ä¸æ˜¯æ„Ÿè§‰å¾ˆç¥å¥‡ï¼Ÿ</p><h2>åŸºäºåå‘³é“çš„é‡æ„</h2><p>åœ¨æ­¤ä¹‹å‰ï¼Œæˆ‘å…ˆæ¥ç®€å•çµ®å¨ä¸¤å¥æˆ‘ä»¬é‡æ„ä»£ç çš„åŸåˆ™ï¼Œå°±æ˜¯<strong>åŸºäºåå‘³é“æ¥é‡æ„</strong>ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œæˆ‘ä»¬åœ¨é‡æ„æ—¶ï¼Œè¦å°½é‡å…ˆå»è¯†åˆ«ã€Šé‡æ„ã€‹ä¸­æ€»ç»“çš„äºŒåå‡ ç§åå‘³é“ï¼Œå†ç”¨ä¹¦ä¸­å¯¹åº”çš„é‡æ„æ‰‹æ³•å»é‡æ„ã€‚</p><p>ä½ å¯èƒ½ä¼šè´¨ç–‘ï¼Œè¦ä¸è¦è¿™ä¹ˆæ•™æ¡å•Šï¼Ÿè¿™å…¶å®å¹¶ä¸æ˜¯æ•™æ¡ã€‚Martin Fowlerå·²ç»â€œé˜…ç æ— æ•°â€ï¼Œç”šè‡³å¯èƒ½æ¯”æˆ‘åƒçš„é¥­éƒ½å¤šã€‚ä»–æ€»ç»“å‡ºæ¥çš„åå‘³é“å·²ç»è¶³å¤Ÿå…¸å‹ï¼Œå¯¹åº”çš„é‡æ„æ‰‹æ³•ä¹Ÿè¶³å¤Ÿå¥½ç”¨ã€‚æˆ‘ä¹Ÿæ‰¿è®¤æˆ‘çš„æ™ºå•†è¿œä¸å¦‚ä»–ï¼Œé‚£ä¸ºä»€ä¹ˆä¸èƒ½æ‹¿æ¥ä¸»ä¹‰å‘¢ï¼Ÿ</p><p>å’Œç¬¬å…­èŠ‚è¯¾å­¦ä¹ ä»£ç å¢é‡æ¼”è¿›æ—¶ä¸€æ ·ï¼Œåœ¨é‡æ„ä»£ç ä¹‹å‰ï¼Œæˆ‘è¿˜æ˜¯å…ˆå¸¦ä½ è¯†åˆ«åå‘³é“ï¼Œç„¶åå†é‡æ„ã€‚é—ç•™ç³»ç»Ÿçš„ä»£ç ï¼Œç®€ç›´æ˜¯æœ€å…·ä»£è¡¨æ€§çš„â€œä»£ç åå‘³é“å¤§è§‚å›­â€ã€‚</p><p>å°½ç®¡é‡æ„èµ·æ¥æŒ‘æˆ˜é‡é‡ï¼Œä½†æ”»å…‹å®ƒä»¬åˆä»¤äººä¸Šç˜¾ã€ç€è¿·ã€æ¬²ç½¢ä¸èƒ½ã€‚æˆ‘è¿™æ ·å®‰æ’ï¼Œæ˜¯ä¸ºäº†æˆä¹‹ä»¥æ¸”ï¼ˆå³é‡æ„çš„æ–¹æ³•ï¼‰ï¼Œè€Œä¸å…‰æ˜¯æˆä¹‹ä»¥é±¼ï¼ˆå³é‡æ„å¥½çš„æ–¹æ³•ï¼‰ã€‚</p><!-- [[[read_end]]] --><p>å‡†å¤‡å¥½äº†å—ï¼Ÿæˆ‘ä»¬å¼€å§‹ã€‚</p><h2>å€šå¤©å‰‘ï¼šæ‹†åˆ†é˜¶æ®µ</h2><p>æˆ‘ä»¬å…ˆæ¥è§è¯†è§è¯†é‡æ„é—ç•™ä»£ç çš„å€šå¤©å‰‘ï¼Œ<strong>æ‹†åˆ†é˜¶æ®µï¼ˆSplit Phaseï¼‰</strong>ã€‚è¿™æ˜¯Martin Fowleråœ¨ã€Šé‡æ„ï¼ˆç¬¬2ç‰ˆï¼‰ã€‹ä¸­æ–°æå‡ºçš„ä¸€ç§é‡æ„æ‰‹æ³•ã€‚å½“æˆ‘ç¬¬ä¸€æ¬¡çœ‹åˆ°è¿™ä¸ªæ‰‹æ³•çš„ä»‹ç»æ—¶ï¼Œç®€ç›´èŒ…å¡é¡¿å¼€ï¼ˆå½“ç„¶ï¼Œæˆ‘ç¬¬ä¸€æ¬¡çœ‹åˆ°ã€Šé‡æ„ã€‹ä¸­çš„å¾ˆå¤šå†…å®¹æ—¶ï¼Œéƒ½æ˜¯è¿™ä¸ªçŠ¶æ€ï¼‰ã€‚å®ƒè§£å†³äº†æˆ‘åœ¨é¢ä¸´é—ç•™ä»£ç æ—¶æœ€å¤´ç–¼çš„é—®é¢˜ã€‚</p><p><img src=\"https://static001.geekbang.org/resource/image/03/76/034d1bcaef664422de2971ed7af8a076.png?wh=1920x1088\" alt=\"å›¾ç‰‡\"></p><p>é—ç•™ä»£ç æœ€å¤§çš„é—®é¢˜å°±æ˜¯æ–¹æ³•è¿‡é•¿ã€‚æ–¹æ³•é•¿äº†ä¹‹åï¼Œå‰åå‡ ä»£å¼€å‘äººå‘˜ä¸åœå¾€é‡Œå¡ä¸œè¥¿ï¼Œæœ‰çš„åŠ åœ¨è¿™é‡Œï¼Œæœ‰çš„åŠ åœ¨é‚£é‡Œï¼Œå¯¼è‡´æœ€åè°éƒ½æ— æ³•åˆ†æ¸…åˆ°åº•æ–¹æ³•åšäº†å‡ ä»¶äº‹æƒ…ã€‚æˆ‘ä»¬éƒ½è¯´ï¼Œæ–¹æ³•é•¿äº†å°±ä¸æ˜¯<strong>å•ä¸€èŒè´£ï¼ˆSRPï¼‰</strong>äº†ï¼Œä½†æ›´è¦å‘½çš„æ˜¯ï¼Œç”±äºä»£ç è¿‡äºæ··ä¹±ï¼Œä½ ç”šè‡³è¯´ä¸æ¸…æ¥šåˆ°åº•æœ‰å“ªäº›èŒè´£ã€‚</p><p>æ‹†åˆ†é˜¶æ®µå°±åƒå€šå¤©å‰‘ä¸€æ ·ï¼Œè½»å·§åœ°æŠŠæ–¹æ³•åˆ°åº•åšäº†å‡ ä»¶äº‹æƒ…ç»™æ‹æ¸…æ¥šï¼ŒæŠŠç›¸å…³çš„ä»£ç ç»„ç»‡åˆ°ä¸€èµ·ã€‚</p><p>æ¯”å¦‚ï¼Œå¤§å¤šæ•°æƒ…å†µä¸‹ï¼Œä¸€ä¸ªæ–¹æ³•éƒ½åœ¨å¤„ç†è¿™æ ·çš„ä¸‰ä¸ªé˜¶æ®µï¼šç¬¬ä¸€ï¼Œæ ¡éªŒã€è½¬æ¢ä¼ å…¥çš„æ•°æ®ï¼›ç¬¬äºŒï¼Œæ ¹æ®ä¼ å…¥æˆ–è½¬æ¢åçš„æ•°æ®ï¼Œå®Œæˆä¸šåŠ¡å¤„ç†ï¼›ç¬¬ä¸‰ï¼Œå‡†å¤‡è¦è¿”å›çš„æ•°æ®å¹¶è¿”å›ã€‚å…¶ä¸­ç¬¬äºŒä¸ªé˜¶æ®µå¦‚æœè¿‡äºå¤æ‚ï¼Œè¿˜å¯ä»¥æ‹†åˆ†æˆæ›´å¤šçš„å°æ­¥éª¤ã€‚</p><p>ç°åœ¨æˆ‘ä»¬æ¥ä¸¾ä¸€ä¸ªä¾‹å­ã€‚ä»¥ä¸‹ä»£ç æ¥è‡ªä¸€ä¸ªæ‹†åˆ†é˜¶æ®µçš„é‡æ„Kataï¼Œå®ƒå‡ºè‡ªã€Šé‡æ„ï¼ˆç¬¬2ç‰ˆï¼‰ã€‹çš„ç¬¬1ç« ï¼Œä½œè€…å¯¹åŸæ¥çš„ä»£ç åšäº†ä¸€äº›ç®€åŒ–ï¼Œä½¿ä¹‹æ›´é€‚åˆæ‹†åˆ†é˜¶æ®µçš„é‡æ„ç»ƒä¹ ã€‚ä½ å¯ä»¥åœ¨<a href=\"https://github.com/gregorriegler/refactoring-split-phase\">GitHub</a>ä¸Šæ‰¾åˆ°å®Œæ•´çš„ä»£ç ã€‚</p><pre><code class=\"language-java\">public class TheatricalPlayers {\n   public String print(Invoice invoice) {\n       var totalAmount = 0;\n       var volumeCredits = 0;\n       var result = String.format(\"Statement for %s\\n\", invoice.customer);\n\n       NumberFormat format = NumberFormat.getCurrencyInstance(Locale.US);\n\n       for (var perf : invoice.performances) {\n           var play = perf.play;\n           var thisAmount = 40000;\n           if (perf.audience &gt; 30) {\n               thisAmount += 1000 * (perf.audience - 30);\n           }\n\n           var thisCredits = Math.max(perf.audience - 30, 0);\n           if (\"comedy\".equals(play.type)) thisCredits += Math.floor((double) perf.audience / 5);\n\n           totalAmount += thisAmount;\n           volumeCredits += thisCredits;\n       }\n       \n       result += String.format(\"Amount owed is %s\\n\", format.format(totalAmount / 100));\n       result += String.format(\"You earned %s credits\\n\", volumeCredits);\n       return result;\n   }\n}\n</code></pre><p>æˆ‘ä»¬ä¸€èµ·æ¥çœ‹çœ‹å®ƒæœ‰å“ªäº›åå‘³é“ã€‚</p><p>å®ƒè®¡ç®—äº†æ¼”å‡ºçš„æ€»è´¹ç”¨ä»¥åŠè§‚ä¼—é‡ç§¯åˆ†ï¼ˆvolume creditsï¼Œæ ¹æ®åˆ°åœºçš„è§‚ä¼—æ•°é‡æ¥è®¡ç®—çš„ç§¯åˆ†ï¼Œä¸‹æ¬¡å®¢æˆ·å†è¯·å‰§å›¢æ¼”å‡ºçš„æ—¶å€™ï¼Œå¯ä»¥ç”¨è¿™ä¸ªç§¯åˆ†è·å¾—æŠ˜æ‰£ï¼‰ï¼Œå¹¶ä¸”å¯¹è¿™ä¸¤é¡¹æ•°æ®è¿›è¡Œæ ¼å¼åŒ–å¹¶è¿”å›ã€‚</p><p>çœ‹åˆ°è¿™æ ·çš„æè¿°ï¼Œä¼°è®¡ä½ çš„ç¬¬ä¸€ååº”å°±æ˜¯ï¼Œå®ƒè¿åäº†<strong>å•ä¸€èŒè´£åŸåˆ™ï¼ˆSRPï¼‰</strong>ã€‚æ²¡é”™ï¼Œä¸€ä¸ªæ–¹æ³•æ‰¿æ‹…äº†è®¡ç®—æ€»è´¹ç”¨ã€è®¡ç®—è§‚ä¼—é‡ç§¯åˆ†å’Œæ ¼å¼åŒ–ä¿¡æ¯è¿™ä¸‰ä¸ªèŒè´£ã€‚ç„¶è€Œæˆ‘æ›´å–œæ¬¢ç”¨ã€Šé‡æ„ã€‹ä¸­ä»‹ç»çš„åå‘³é“<strong>å‘æ•£å¼å˜åŒ–ï¼ˆdivergent changeï¼‰</strong>æ¥è¯„ä»·å®ƒã€‚</p><p><strong>ä¸€ä¸ªç±»æˆ–æ–¹æ³•åº”è¯¥åªæœ‰ä¸€ä¸ªå¼•èµ·å®ƒå˜åŒ–çš„åŸå› </strong>ï¼Œè€Œå¯¹äºè¿™ä¸ªæ–¹æ³•æ¥è¯´ï¼Œæ˜¾ç„¶æœ‰ä¸‰ä¸ªã€‚å¦‚æœè®¡ç®—è´¹ç”¨çš„é€»è¾‘å‘ç”Ÿå˜åŒ–ï¼Œæ¯”å¦‚è§‚ä¼—çš„åŸºæ•°ä»30æ”¹æˆäº†50ï¼›å¦‚æœè®¡ç®—ç§¯åˆ†çš„é€»è¾‘å‘ç”Ÿå˜åŒ–ï¼Œæ¯”å¦‚æ¼”å‡ºæ‚²å‰§ä¹Ÿæœ‰ç›¸åº”çš„ç§¯åˆ†ï¼›å¦‚æœæ ¼å¼åŒ–çš„é€»è¾‘å‘ç”Ÿå˜åŒ–ï¼Œæ¯”å¦‚ç”¨HTMLæ¥è¾“å‡ºæ¸…å•ï¼Œä½ éƒ½éœ€è¦ä¿®æ”¹è¿™ä¸ªæ–¹æ³•ã€‚å¼•èµ·å®ƒå˜åŒ–çš„åŸå› ï¼Œä¸æ˜¯ä¸€ä¸ªï¼Œè€Œæ˜¯ä¸‰ä¸ªã€‚</p><p>å¯¹äºè¿™ä¸ªåå‘³é“ï¼Œã€Šé‡æ„ã€‹çš„å»ºè®®æ˜¯ï¼Œå¦‚æœä¸åŒçš„å˜åŒ–æ–¹å‘å½¢æˆäº†å…ˆåé¡ºåºï¼Œå°±ç”¨<strong>æ‹†åˆ†é˜¶æ®µ</strong>æ‰‹æ³•å°†å®ƒä»¬åˆ†å¼€ã€‚æˆ‘ä»¬æ¥çœ‹çœ‹è¯¥æ€ä¹ˆæ“ä½œã€‚</p><p>é¦–å…ˆï¼Œåœ¨å¼€å§‹æ­£å¼é‡æ„ä¹‹å‰ï¼Œæˆ‘å»ºè®®ä½ å…ˆè¿è¡Œä¸€ä¸‹æ‰€æœ‰çš„æµ‹è¯•ï¼Œç¡®ä¿é€šè¿‡ã€‚</p><p>å†ä»”ç»†è§‚å¯Ÿè¿™æ®µä»£ç ï¼Œä½ ä¼šå‘ç°ï¼Œå¾ˆå¤šå˜é‡çš„å£°æ˜å’Œä½¿ç”¨çš„ä½ç½®ç¦»å¾—éå¸¸è¿œã€‚è¿™æ˜¯é—ç•™ä»£ç çš„å…¸å‹ç‰¹ç‚¹ã€‚ä¸€æ–¹é¢ï¼Œä¸€äº›å¤è€çš„ç¼–ç¨‹è¯­è¨€æˆ–ç¼–ç¨‹é£æ ¼ï¼Œä»¥åŠæŸäº›å¤§å­¦è¯¾ç¨‹ï¼Œè¦æ±‚ä½ æŠŠæ–¹æ³•å†…çš„æ‰€æœ‰å˜é‡éƒ½å£°æ˜åœ¨æ–¹æ³•å¼€å¤´ã€‚å¦ä¸€æ–¹é¢ï¼Œç”±äºä»£ç ç»æ‰‹çš„äººå¤ªå¤šï¼Œå¾ˆå¤šäººä¼šæœ‰æ„æ— æ„å°†è‡ªå·±çš„ä»£ç æ’å…¥åˆ°å˜é‡çš„å£°æ˜å’Œä½¿ç”¨ä¹‹é—´ã€‚</p><p>ä½†ä½ åº”è¯¥æ¸…æ¥šçš„æ˜¯ï¼Œæˆ‘ä»¬æ›´å€¾å‘äº<strong>ç»™å±€éƒ¨å˜é‡æ›´å°çš„ä½œç”¨åŸŸ</strong>ï¼Œä¹Ÿå°±æ˜¯åœ¨ä½¿ç”¨å®ƒä¹‹å‰å†å£°æ˜ã€‚</p><p>æˆ‘ä»¬å…ˆæŠŠresultå’Œformatä¸¤ä¸ªå˜é‡çš„å£°æ˜å¾€ä¸‹æŒªï¼ŒæŒªåˆ°resultä½¿ç”¨ä¹‹å‰ã€‚ä»…æ­¤ä¸€æ­¥ï¼Œä½ å…¶å®å·²ç»å®Œæˆäº†æ‹†åˆ†é˜¶æ®µçš„éƒ¨åˆ†å†…å®¹ï¼ŒæŠŠæ ¼å¼åŒ–éƒ¨åˆ†çš„é€»è¾‘æ‹©äº†å‡ºæ¥ã€‚</p><p>åˆ«å¿˜äº†è¿è¡Œæµ‹è¯•ã€‚è™½ç„¶åªæœ‰è¿™ä¸€æ­¥ï¼Œä½ å‡ ä¹å¯ä»¥100%ç¡®è®¤æ²¡æœ‰é—®é¢˜ï¼Œä½†ä½ ä»ç„¶éœ€è¦è¿è¡Œä¸€ä¸‹æµ‹è¯•ï¼Œå…»æˆå¥½ä¹ æƒ¯ã€‚</p><pre><code class=\"language-java\">public class TheatricalPlayers {\n   public String print(Invoice invoice) {\n       var totalAmount = 0;\n       var volumeCredits = 0;\n       \n       for (var perf : invoice.performances) {\n           var play = perf.play;\n           var thisAmount = 40000;\n           if (perf.audience &gt; 30) {\n               thisAmount += 1000 * (perf.audience - 30);\n           }\n\n           var thisCredits = Math.max(perf.audience - 30, 0);\n           if (\"comedy\".equals(play.type)) thisCredits += Math.floor((double) perf.audience / 5);\n\n           totalAmount += thisAmount;\n           volumeCredits += thisCredits;\n       }\n       \n       var result = String.format(\"Statement for %s\\n\", invoice.customer);\n       NumberFormat format = NumberFormat.getCurrencyInstance(Locale.US);\n       result += String.format(\"Amount owed is %s\\n\", format.format(totalAmount / 100));\n       result += String.format(\"You earned %s credits\\n\", volumeCredits);\n       return result;\n   }\n}\n</code></pre><p>ç¬¬äºŒæ­¥ï¼Œæ¥çœ‹çœ‹forå¾ªç¯é‡Œé¢å§ã€‚playå˜é‡ä¹Ÿå’Œä½¿ç”¨å®ƒçš„åœ°æ–¹å·®äº†6è¡Œçš„è·ç¦»ï¼Œä½ ä¸€å®šäºŒè¯ä¸è¯´ï¼Œä¹Ÿå¾€ä¸‹ç§»ã€‚ä½†æ˜¯ç­‰ç­‰ï¼Œå†ä»”ç»†è§‚å¯Ÿä¸€ä¸‹ï¼Œå…¶å®åªæœ‰ä¸€ä¸ªåœ°æ–¹åœ¨ä½¿ç”¨è¿™ä¸ªplayï¼Œå¹²è„†ä¸ç”¨ç§»åŠ¨äº†ï¼Œç›´æ¥å†…è”ï¼ˆinlineï¼‰å§ã€‚</p><p>æ³¨æ„ï¼Œæˆ‘è¯´çš„ç§»åŠ¨ä¸€è¡Œä»£ç å’Œå†…è”ï¼ŒåŒ…æ‹¬åé¢çš„æå–æ–¹æ³•å’Œç§»åŠ¨æ–¹æ³•ï¼Œåœ¨å¤§å¤šæ•°IDEä¸­éƒ½æ˜¯æœ‰å¿«æ·é”®çš„ã€‚æˆ‘å¼ºçƒˆå»ºè®®ä½ <strong>è®°ä½å¹¶ç†Ÿç»ƒè¿ç”¨è¿™äº›å¿«æ·é”®</strong>ï¼Œå®ƒä»¬å¯ä»¥ä½¿ä½ äº‹åŠåŠŸå€ã€‚åé¢è®²è§£â€œå± é¾™åˆ€â€æ—¶ä¼šä¸“é—¨è¯´è¯´å¿«æ·é”®ã€‚</p><p>ç¬¬ä¸‰æ­¥ï¼Œè®¡ç®—thisAmountçš„ä»£ç å·²ç»é›†ä¸­åœ¨äº†ä¸€èµ·ï¼Œè¿™ä¹Ÿæ˜¯æ‹†åˆ†é˜¶æ®µçš„é˜¶æ®µæ€§æˆæœã€‚ä¸è¦è¿Ÿç–‘ï¼ŒæŠŠå®ƒä»¬æå–æˆä¸€ä¸ªæ–¹æ³•ï¼Œå½»åº•å’Œä¸‹é¢çš„ä»£ç åˆ’æ¸…ç•Œé™ã€‚æˆ‘ä»¬æ¥çœ‹çœ‹ï¼Œç°åœ¨çš„ä»£ç å˜æˆäº†ä»€ä¹ˆæ ·å­ï¼š</p><pre><code class=\"language-java\">public String print(Invoice invoice) {\n    var totalAmount = 0;\n    var volumeCredits = 0;\n\n    for (var perf : invoice.performances) {\n        int thisAmount = getThisAmount(perf);\n        \n        var thisCredits = Math.max(perf.audience - 30, 0);\n        if (\"comedy\".equals(perf.play.type)) thisCredits += Math.floor((double) perf.audience / 5);\n        \n        totalAmount += thisAmount;\n        volumeCredits += thisCredits;\n    }\n    \n    // formatä»£ç \n}\n</code></pre><p>ç¬¬å››æ­¥ï¼ŒæŠŠtotalAmountçš„ç´¯åŠ ä»£ç ä¸Šç§»ï¼Œè®©ä½¿ç”¨thisAmountå’Œå£°æ˜thisAmountçš„ä»£ç æŒ¨åœ¨ä¸€èµ·ã€‚è¿™æ—¶ä½ ä¼šå‘ç°ï¼ŒthisAmountä¹Ÿåªæœ‰è¿™ä¸€å¤„è°ƒç”¨ï¼Œå®Œå…¨å¯ä»¥å†…è”ã€‚ä½ å¯èƒ½æ­£å‘æ„è¿™ä¸ªå˜é‡åä¸çŸ¥é“æ€ä¹ˆæ”¹å¥½ï¼Œè¿™æ ·ä¸€å†…è”ï¼Œå®ƒå°±ä¸è§äº†ï¼ŒçœŸæ˜¯ä¸€äº†ç™¾äº†ã€‚</p><p>ç¬¬äº”æ­¥ï¼Œé‡å¤ä¸Šé¢çš„ç¬¬ä¸‰ã€å››æ­¥ï¼ŒæŠŠè®¡ç®—thisCreditsçš„æ–¹æ³•æå–å‡ºæ¥ï¼Œå¹¶å†…è”thisCreditsã€‚è¿™æ—¶forå¾ªç¯å†…éƒ¨ï¼Œåªå‰©çŸ­çŸ­çš„ä¸¤è¡Œä»£ç äº†ã€‚</p><pre><code class=\"language-java\">for (var perf : invoice.performances) {\n    totalAmount += getThisAmount(perf);\n    volumeCredits += getThisCredits(perf);\n}\n</code></pre><p>æ˜¯ä¸æ˜¯å·²ç»å¾ˆæ¸…çˆ½äº†ï¼Ÿä½†å…¶å®è¿˜æœ‰æ”¹è¿›ç©ºé—´ï¼Œä¸è¦åœæ­¢è„šæ­¥ï¼Œæˆ‘ä»¬ç»§ç»­ã€‚å˜é‡totalAmountå’ŒvalumeCreditsçš„å£°æ˜å’Œä½¿ç”¨è¿˜æ˜¯åˆ†ç¦»çš„ï¼Œè€Œä¸”å®ƒä»¬åœ¨å¾ªç¯å†…éƒ¨èµ‹å€¼ï¼Œåœ¨å¾ªç¯åé¢ä½¿ç”¨ï¼Œè¿™æ ·çš„å˜é‡ä¼¼ä¹åªèƒ½åœ¨å¾ªç¯å‰é¢å£°æ˜ã€‚</p><p>ç¬¬å…­æ­¥ï¼Œå¤åˆ¶ä¸€ä¸‹è¿™ä¸ªforå¾ªç¯ï¼Œåˆ†åˆ«åˆ æ‰ä¸¤ä¸ªforä¸­çš„volumeCreditså’ŒtotalAmountçš„èµ‹å€¼è¯­å¥ï¼Œç”¨ä¸¤ä¸ªforå¾ªç¯åˆ†åˆ«è®¡ç®—totalAmountå’ŒvolumeCreditsã€‚å¯¹è¿™ä¸€æ­¥ä½ å¯èƒ½æœ‰å¼‚è®®ï¼Œæœ¬æ¥ä¸€ä¸ªå¾ªç¯å˜ä¸ºäº†ä¸¤ä¸ªï¼Œæ€§èƒ½å˜å·®äº†å‘€ã€‚çš„ç¡®ï¼Œæ€§èƒ½æ˜¯å˜å·®äº†é‚£ä¹ˆä¸€ç‚¹ç‚¹ï¼Œä½†è¿™ä¸€ç‚¹ç‚¹æ€§èƒ½æŸå¤±ä¸å®ƒæ‰€å¸¦æ¥çš„å¯è¯»æ€§æå‡ç›¸æ¯”ï¼Œæ ¹æœ¬ä¸å€¼ä¸€æã€‚</p><p>ç¬¬ä¸ƒæ­¥ï¼ŒæŠŠtotalAmountå’ŒvolumeCreditsçš„å£°æ˜å’Œå„è‡ªçš„forå¾ªç¯ç§»åˆ°ä¸€èµ·ï¼Œå½¢æˆä¸‹é¢è¿™æ ·çš„å½¢å¼ï¼š</p><pre><code class=\"language-java\">public String print(Invoice invoice) {\n    var totalAmount = 0;\n    for (var perf : invoice.performances) {\n        totalAmount += getThisAmount(perf);\n    }\n    \n    var volumeCredits = 0;\n    for (var perf : invoice.performances) {\n        volumeCredits += getThisCredits(perf);\n    }\n    \n    var result = String.format(\"Statement for %s\\n\", invoice.customer);\n    var format = NumberFormat.getCurrencyInstance(Locale.US);\n    result += String.format(\"Amount owed is %s\\n\", format.format(totalAmount / 100));\n    result += String.format(\"You earned %s credits\\n\", volumeCredits);\n    return result;\n}\n</code></pre><p>åˆ°è¿™ä¸€æ­¥ï¼Œæˆ‘ä»¬åŸºæœ¬å®Œæˆäº†æ‹†åˆ†é˜¶æ®µçš„é‡æ„ã€‚ä»£ç æœ¬æ¥æ˜¯ä¸€å›¢ä¹±éº»ï¼Œè¢«å€šå¤©å‰‘åŠˆæˆäº†ä¸‰æ®µï¼Œåˆ†åˆ«è´Ÿè´£è®¡ç®—totalAmountã€è®¡ç®—volumeCreditså’Œæ ¼å¼åŒ–è¾“å‡ºç»“æœã€‚ä»£ç å·²ç»ç›¸å½“æ¸…çˆ½äº†ã€‚</p><p>è®²åˆ°è¿™ï¼Œå…¶å®ä½ ä¼šå‘ç°ï¼Œæ‹†åˆ†é˜¶æ®µä¸è¿‡å°±æ˜¯é‡æ–°ç»„ç»‡ä»£ç ï¼ŒæŠŠè·ŸæŸä¸ªé€»è¾‘ç›¸å…³çš„è¯­å¥ï¼Œä»åŸå…ˆåˆ†æ•£çš„å„å¤„æ‹å‡ºæ¥ï¼Œç»Ÿç»Ÿåˆå¹¶åœ¨ä¸€èµ·ã€‚ä½ å¯ä»¥ç”¨ç©ºè¡Œéš”å¼€ä¸åŒé˜¶æ®µï¼Œä¹Ÿå¯ä»¥æŠ½å–å‡ºæ–¹æ³•ï¼Œè¿™æ ·å°±èƒ½è®©åŸæ–¹æ³•æ˜¾å¾—æ›´ç®€æ´ä¸€äº›ã€‚</p><p>å› æ­¤ï¼Œç¬¬å…«æ­¥ï¼ŒæŠŠå„ä¸ªé˜¶æ®µæå–æˆå•ç‹¬çš„æ–¹æ³•ï¼Œå½»åº•å®Œæˆé‡æ„ã€‚</p><pre><code class=\"language-java\">public String print(Invoice invoice) {\n    int totalAmount = getTotalAmount(invoice);\n    int volumeCredits = getVolumeCredits(invoice);\n    return getResult(invoice, totalAmount, volumeCredits);\n}\n</code></pre><p>æ€»ç»“ä¸€ä¸‹æˆ‘ä»¬é‡æ„è¿™æ®µä»£ç çš„å…«ä¸ªæ­¥éª¤ï¼Œå¦‚ä¸‹å›¾ï¼š</p><p><img src=\"https://static001.geekbang.org/resource/image/ef/5a/efa27a11abf8f6112c5cfc130841765a.jpg?wh=6580x4220\" alt=\"\" title=\"æ‹†åˆ†é˜¶æ®µ\"></p><p>æŠŠä¸€ä¸ªé•¿æ–¹æ³•æ‹†åˆ†æˆå¤šä¸ªé˜¶æ®µï¼Œå¹¶æŠ½å–æˆå°çš„æ–¹æ³•ï¼Œè¿™æ ·åšä¸ä½†èƒ½ä½¿ä»£ç å¼‚å¸¸æ•´æ´ï¼Œè€Œä¸”åœ¨ä½ éœ€è¦ä¿®æ”¹çš„æ—¶å€™ï¼Œåªéœ€æ‰¾åˆ°ç›¸å…³çš„å°æ–¹æ³•ï¼Œè€Œå®Œå…¨ä¸éœ€è¦å»å…³å¿ƒå…¶ä»–å°æ–¹æ³•å†…çš„ç»†èŠ‚ï¼Œä»è€Œé™ä½äº†<strong>è®¤çŸ¥è´Ÿè½½</strong>ã€‚</p><p>æ‹†åˆ†é˜¶æ®µä¸ä»…é€‚ç”¨äºä»£ç æ‹†åˆ†ï¼Œè€Œä¸”ä¹Ÿå¯ä»¥ç”¨äºå­˜å‚¨è¿‡ç¨‹å’Œå‡½æ•°çš„æ‹†åˆ†ï¼Œæˆ‘ä»¬åé¢åœ¨å®æˆ˜ç¯‡é‡Œè¿˜ä¼šçœ‹åˆ°è¿™ä¸ªæ¨¡å¼ã€‚</p><p>å±•ç¤ºäº†å€šå¤©å‰‘ï¼Œæ˜¯æ—¶å€™æå‡ºå± é¾™åˆ€äº†ï¼Œå®ƒå¯ä»¥å°†èŒè´£ä¸ç›¸å…³çš„ä»£ç å½»åº•æ–©æ–­å…³ç³»ã€‚</p><h2>å± é¾™åˆ€ï¼šæ–¹æ³•å¯¹è±¡</h2><p><strong>æ–¹æ³•å¯¹è±¡ï¼ˆMethod Objectï¼‰</strong>æ˜¯æé™ç¼–ç¨‹å’ŒTDDä¹‹çˆ¶Kent Beckåœ¨ã€Šå®ç°æ¨¡å¼ã€‹ä¸­æå‡ºçš„ä¸€ç§æ¨¡å¼ã€‚Kent Beckç”šè‡³ç›´è¨€ï¼Œè¿™æ˜¯ä»–æœ€å–œçˆ±çš„æ¨¡å¼ä¹‹ä¸€ã€‚</p><p>æ‰€è°“æ–¹æ³•å¯¹è±¡ï¼Œå°±æ˜¯æŒ‡<strong>åªåŒ…å«ä¸€ä¸ªæ–¹æ³•çš„å¯¹è±¡</strong>ï¼Œè¿™ä¸ªæ–¹æ³•å°±æ˜¯è¯¥å¯¹è±¡ä¸»è¦çš„ä¸šåŠ¡é€»è¾‘ã€‚å¦‚æœä½ ä¸çŸ¥é“å¦‚ä½•éš”ç¦»ä¸åŒçš„èŒè´£ï¼Œå°±å¯ä»¥â€œæ— è„‘â€åœ°ä½¿ç”¨æ–¹æ³•å¯¹è±¡æ¨¡å¼ï¼Œå°†ä¸åŒèŒè´£éƒ½æå–åˆ°ä¸åŒçš„æ–¹æ³•å¯¹è±¡ä¸­ã€‚</p><p>æˆ‘ä»¬ä»ç„¶ä»¥ä¸Šé¢ä»‹ç»çš„ä»£ç ä¸ºä¾‹æ¥ä»‹ç»æ–¹æ³•å¯¹è±¡ã€‚æ‹†åˆ†é˜¶æ®µå®Œæˆä¹‹åçš„å®Œæ•´ä»£ç å¦‚ä¸‹ï¼š</p><pre><code class=\"language-java\">public class TheatricalPlayers {\n    public String print(Invoice invoice) {\n        int totalAmount = getTotalAmount(invoice);\n        int volumeCredits = getVolumeCredits(invoice);\n        return getResult(invoice, totalAmount, volumeCredits);\n    }\n    \n    private int getTotalAmount(Invoice invoice) {\n        var totalAmount = 0;\n        for (var perf : invoice.performances) {\n            totalAmount += getThisAmount(perf);\n        }\n        return totalAmount;\n    }\n    \n    private int getThisAmount(Performance perf) {\n        var thisAmount = 40000;\n        if (perf.audience &gt; 30) {\n            thisAmount += 1000 * (perf.audience - 30);\n        }\n        return thisAmount;\n    }\n    private int getVolumeCredits(Invoice invoice) {\n        var volumeCredits = 0;\n        for (var perf : invoice.performances) {\n            volumeCredits += getThisCredits(perf);\n        }\n        return volumeCredits;\n    }\n    \n    private int getThisCredits(Performance perf) {\n        var thisCredits = Math.max(perf.audience - 30, 0);\n        if (\"comedy\".equals(perf.play.type)) thisCredits += Math.floor((double) perf.audience / 5);\n        return thisCredits;\n    }\n    \n    private String getResult(Invoice invoice, int totalAmount, int volumeCredits) {\n        var result = String.format(\"Statement for %s\\n\", invoice.customer);\n        var format = NumberFormat.getCurrencyInstance(Locale.US);\n        result += String.format(\"Amount owed is %s\\n\", format.format(totalAmount / 100));\n        result += String.format(\"You earned %s credits\\n\", volumeCredits);\n        return result;\n    }\n}\n</code></pre><p>ä»£ç çš„åå‘³é“ä»ç„¶æ˜¯<strong>å‘æ•£å¼å˜åŒ–</strong>ï¼Œåªä¸è¿‡ä»æ–¹æ³•çº§åˆ«å˜æˆäº†ç±»çº§åˆ«ï¼Œå½“ä¸‰ä¸ªé˜¶æ®µçš„ä»»ä½•ä¸€ä¸ªé€»è¾‘å‘ç”Ÿå˜åŒ–çš„æ—¶å€™ï¼Œä½ éƒ½éœ€è¦ä¿®æ”¹è¿™ä¸ªç±»ã€‚</p><p>æˆ‘ä»¬è¦åšçš„å°±æ˜¯æŠŠgetTotalAmountã€getVolumeCreditså’ŒgetResultä¸‰ä¸ªæ–¹æ³•éƒ½ç§»åŠ¨åˆ°ä¸åŒçš„æ–¹æ³•å¯¹è±¡ä¸­ã€‚</p><p>ä½ å¯èƒ½ä¼šè¯´ï¼Œè¿™æœ‰ä½•éš¾ï¼Ÿæˆ‘æœ€æ“…é•¿çš„å°±æ˜¯Copy&amp;Pasteäº†ã€‚å…ˆåˆ«æ€¥ç€æŒ‰Ctrlï¼ˆCmdï¼‰+ Cï¼ŒIDEæ™®éæä¾›äº†å¼ºå¤§çš„é‡æ„å·¥å…·æ”¯æŒï¼Œå¦‚æœä¸èƒ½ç‰©å°½å…¶ç”¨ï¼Œç®€ç›´å°±æ˜¯æš´æ®„å¤©ç‰©äº†ã€‚ä½ å®Œå…¨å¯ä»¥å…¨éƒ½ä½¿ç”¨é‡æ„å·¥å…·æ¥è‡ªåŠ¨å®Œæˆè¿™äº›é‡æ„ï¼Œç”šè‡³éƒ½ä¸éœ€è¦ç¢°é¼ æ ‡ã€‚</p><p>æˆ‘åœ¨è¿™é‡Œå°±ä»¥Macç‰ˆçš„IntelliJ IDEAæ¥æ¼”ç¤ºä¸€ä¸‹ï¼Œå¦‚ä½•åªç”¨é”®ç›˜å°±å®‰å…¨åœ°å®ç°ç§»åŠ¨æ–¹æ³•çš„é‡æ„ã€‚ä»”ç»†çœ‹å¥½ï¼Œä¸è¦çœ¨çœ¼ã€‚</p><p>æˆ‘ä»¬å…ˆæ¥ç§»åŠ¨getTotalAmountè¿™ä¸ªæ–¹æ³•ã€‚ç”±äºå®ƒè¿˜è°ƒç”¨äº†getThisAmountï¼Œæ‰€ä»¥å¿…é¡»è¿å¸¦ç€æŠŠå®ƒä¹Ÿç§»èµ°ã€‚ä¸ºäº†é¿å…è¿™ä¸ªéº»çƒ¦ï¼Œä½ å¯ä»¥é€‰æ‹©å…ˆæŠŠgetThisAmountå†…è”ï¼Œè¿™æ ·å°±åªéœ€è¦ç§»åŠ¨ä¸€ä¸ªæ–¹æ³•äº†ã€‚</p><p>ä½ å¯ä»¥æŠŠå…‰æ ‡æ”¾åˆ°getThisAmountçš„æ–¹æ³•å®šä¹‰å¤„æˆ–è€…è°ƒç”¨å¤„ï¼Œç„¶åæŒ‰Cmd+Opt+Nï¼Œåœ¨å¼¹å‡ºçš„å¯¹è¯æ¡†ä¸­é€‰æ‹©â€œInline all and remove the methodâ€ã€‚</p><p>ä¸‹ä¸€æ­¥ï¼ŒæŒ‰ä¸‹Opt+F1ï¼Œå”¤å‡ºé€‰æ‹©è§†å›¾çš„èœå•ï¼Œå†æŒ‰å›è½¦é€‰æ‹©ç¬¬ä¸€ä¸ªProject Viewï¼Œè¿™æ—¶ç„¦ç‚¹æ­£å¥½åœ¨TheatricalPlayersç±»ä¸Šã€‚ä½ å¯ä»¥æŒ‰Cmd+Nåœ¨ç›¸åŒçš„åŒ…å†…åˆ›å»ºä¸€ä¸ªæ–°ç±»ï¼Œåå­—å°±å«TotalAmountCalculatorå§ã€‚</p><p>Kent Beckåœ¨ä¹¦ä¸­ä»‹ç»æ–¹æ³•å¯¹è±¡æ—¶è¯´ï¼Œ<strong>å¯ä»¥ç”¨æ–¹æ³•åçš„å˜å½¢ä½œä¸ºç±»å</strong>ã€‚å¦‚æœæ–¹æ³•åå«complexCalculationï¼Œé‚£ä¹ˆç±»åå°±å¯ä»¥å«ComplexCalculatorã€‚æˆ‘ä»¬è¿™é‡Œçš„æ–¹æ³•å«åšgetTotalAmountï¼ŒæŒ‰åŒæ ·çš„æ€è·¯åº”è¯¥å«TotalAmountGetterï¼Œä½†è¿™ä¸ªåå­—å¹¶ä¸å¥½ï¼Œå› ä¸ºgetTotalAmountè¿™ä¸ªåå­—æœ¬èº«å°±ä¸å¥½ï¼Œå…¶å®åº”è¯¥å«calculateTotalAmountã€‚</p><p>åˆ›å»ºå®Œç±»ä¹‹åï¼ŒIDEä¼šå¸®æˆ‘ä»¬æ‰“å¼€è¿™ä¸ªç±»ï¼Œç„¶è€Œæˆ‘ç°åœ¨å¹¶ä¸æ‰“ç®—å¯¹è¿™ä¸ªç±»åšä¿®æ”¹ã€‚ä½ å¯ä»¥æŒ‰Ctrl+Tabè·³å›åˆ°TheatricalPlayersç±»ä¸­ï¼ŒæŠŠå…‰æ ‡æ”¾åˆ°getTotalAmountæ–¹æ³•ç­¾åä¸Šï¼ŒæŒ‰Cmd+F6æ¥ä¿®æ”¹å®ƒçš„ç­¾åï¼Œå°†åˆšåˆšåˆ›å»ºçš„TotalAmountCalculatorä½œä¸ºæ–¹æ³•çš„å‚æ•°ï¼Œåœ¨å‚æ•°é»˜è®¤å€¼çš„æ–‡æœ¬æ¡†ä¸­ï¼Œå¯ä»¥å¡«new TotalAmountCalculator()ã€‚</p><p>æŒ‰ä¸‹å›è½¦ï¼Œæ–¹æ³•çš„ç­¾åå°±æ”¹å¥½äº†ã€‚ä½ å¯èƒ½ä¼šé—®ï¼Œä¸ºä»€ä¹ˆè¦æŠŠæ–°å»ºçš„ç±»ä½œä¸ºæ–¹æ³•å‚æ•°å‘¢ï¼Ÿæ–¹æ³•å†…åˆæ²¡æœ‰ç”¨åˆ°ï¼Œè¿™ä¸æ˜¯å¤šæ­¤ä¸€ä¸¾å—ï¼Ÿä¸ç”¨æ€¥ï¼Œä½ å¾ˆå¿«å°±ä¼šå‘ç°åŸå› äº†ã€‚</p><p>æ¥ä¸‹æ¥å°±æ˜¯è§è¯å¥‡è¿¹çš„æ—¶åˆ»ã€‚æŠŠå…‰æ ‡æ”¾åˆ°getTotalAmountçš„æ–¹æ³•åä¸Šï¼ŒæŒ‰ä¸‹F6ï¼Œä¼šå¼¹å‡ºç§»åŠ¨æ–¹æ³•çš„å¯¹è¯æ¡†ï¼Œä½ è¦é€‰æ‹©ä¸€ä¸ªå¯¹è±¡æ¥ç§»åŠ¨ä½ çš„æ–¹æ³•ã€‚ç”±äºæˆ‘ä»¬æƒ³æŠŠæ–¹æ³•ç§»åŠ¨åˆ°æ–°å»ºçš„TotalAmountCalculatorä¸­ï¼Œæ‰€ä»¥å½“ç„¶è¦é€‰è¿™ä¸ªã€‚æŒ‰ä¸‹å›è½¦ï¼ŒgetTotalAmountæ–¹æ³•å°±è¢«ç¥å¥‡åœ°ç§»åŠ¨åˆ°äº†TotalAmountCalculatorä¸­ã€‚</p><p>ç°åœ¨ä½ åº”è¯¥æ˜ç™½äº†ä¸ºä»€ä¹ˆè¦æŠŠTotalAmountCalculatoræ”¾åˆ°æ–¹æ³•å‚æ•°ä¸­äº†å§ï¼Ÿå› ä¸ºè¦ç§»åŠ¨æ–¹æ³•æ—¶ï¼Œéœ€è¦é€‰æ‹©ä¸€ä¸ªä½ç½®ï¼Œè¿™ä¸ªä½ç½®å°±æ˜¯è¿™ä¸ªæ–¹æ³•æ‰€ä¾èµ–çš„ç±»ã€‚æ”¾åˆ°æ–¹æ³•å‚æ•°ä¸­å°±ç›¸å½“äºè®©å®ƒä¾èµ–äº†TotalAmountCalculatorï¼Œè¿™æ ·ä½ æ‰èƒ½åœ¨åç»­ç§»åŠ¨æ–¹æ³•æ—¶ï¼Œé€‰æ‹©TotalAmountCalculatorä½œä¸ºç§»åŠ¨çš„ç›®æ ‡ã€‚</p><p>æ¥ä¸‹æ¥ï¼Œä½ å¯ä»¥ç”¨åŒæ ·çš„æ–¹å¼æ¥ç§»åŠ¨getVolumeCreditså’ŒgetResultæ–¹æ³•ï¼Œè¿™é‡Œå°±ä¸ä¸€ä¸€æ¼”ç¤ºäº†ã€‚å®Œæˆä¹‹åçš„ä»£ç å¦‚ä¸‹ï¼š</p><pre><code class=\"language-java\">public String print(Invoice invoice) {\n    int totalAmount = new TotalAmountCalculator().getTotalAmount(invoice);\n    int volumeCredits = new VolumeCreditsCalculator().getVolumeCredits(invoice);\n    return new ResultFormatter().getResult(invoice, totalAmount, volumeCredits);\n}\n</code></pre><p>ç”±äºæˆ‘ä»¬æ˜¯åœ¨æ–¹æ³•ä¸­ç›´æ¥æ„é€ çš„è¿™äº›DOCï¼Œä½ å¯ä»¥æŠŠå®ƒä»¬<strong>æå–æˆæ¥ç¼</strong>ï¼Œé€šè¿‡æ„é€ å‡½æ•°è¿›è¡Œæ³¨å…¥ã€‚æˆ‘ä»¬å†åšä¸€äº›é‡å‘½åï¼ŒæŠŠçœ‹ç€ä¸çˆ½çš„æ–¹æ³•åé€šé€šæ”¹æ‰ã€‚</p><pre><code class=\"language-java\">public class TheatricalPlayers {\n    private TotalAmountCalculator totalAmountCalculator;\n    private VolumeCreditsCalculator volumeCreditsCalculator;\n    private ResultFormatter resultFormatter;\n    \n    public TheatricalPlayers(TotalAmountCalculator totalAmountCalculator, VolumeCreditsCalculator volumeCreditsCalculator, ResultFormatter resultFormatter) {\n        this.totalAmountCalculator = totalAmountCalculator;\n        this.volumeCreditsCalculator = volumeCreditsCalculator;\n        this.resultFormatter = resultFormatter;\n    }\n    \n    public String print(Invoice invoice) {\n        int totalAmount = totalAmountCalculator.calculate(invoice);\n        int volumeCredits = volumeCreditsCalculator.calculate(invoice);\n        return resultFormatter.format(invoice, totalAmount, volumeCredits);\n    }\n}\n\n</code></pre><p>åˆ°è¿™é‡Œï¼Œæ–¹æ³•å¯¹è±¡çš„é‡æ„å°±å…¨éƒ¨å®Œæˆäº†ã€‚å®ƒå°±åƒå± é¾™åˆ€ä¸€æ ·ï¼Œå½»åº•åŠˆå¼€äº†ä¸åŒèŒè´£ä¹‹é—´çš„è”ç³»ï¼Œè®©å®ƒä»¬å„è‡ªä½äºè‡ªå·±çš„æ–¹æ³•å¯¹è±¡é‡Œã€‚</p><p>æˆ‘åœ¨é‡æ„äº†å¤§é‡é—ç•™ä»£ç ä¹‹åå‘ç°ï¼Œè™½ç„¶ä¸åŒä»£ç æœ€ç»ˆçš„æ ·å­ä¸å°½ç›¸åŒï¼Œä½†è¿‡ç¨‹ä¸­ä¼¼ä¹éƒ½åŒ…å«äº†æ–¹æ³•å¯¹è±¡ã€‚æœ‰äº›å¯èƒ½ä¼šè¿›ä¸€æ­¥é‡æ„æˆè¡Œä¸ºå‹çš„è®¾è®¡æ¨¡å¼ï¼Œæœ‰äº›å°±å¹²è„†ä»¥æ–¹æ³•å¯¹è±¡ä¸ºç»ˆç‚¹ã€‚å¯ä»¥è¯´ï¼Œæ–¹æ³•å¯¹è±¡ï¼Œæ˜¯è®¾è®¡æ¨¡å¼çš„ä¸­é—´æ­¥éª¤ã€‚</p><p><img src=\"https://static001.geekbang.org/resource/image/1a/51/1a49223e13ac1e0b399216d7110d4451.jpg?wh=7369x4737\" alt=\"\" title=\"æ–¹æ³•å¯¹è±¡\"></p><p>æˆ‘ä»¬ç”¨å¿«æ·é”®ç§€æ“ä½œçš„è¿‡ç¨‹å°±åˆ°æ­¤ä¸ºæ­¢äº†ã€‚æˆ‘å¼ºçƒˆå»ºè®®ä½ è·Ÿç€æ–‡ç¨¿ï¼Œå®é™…æ“ç»ƒä¸€éï¼Œä½“ä¼šå¿«æ·é”®ç¼–ç¨‹å¸¦æ¥çš„å¿«æ„Ÿã€‚</p><p><img src=\"https://static001.geekbang.org/resource/image/19/11/198f254a1bd8537bedf2f5347b0fb311.jpg?wh=1920x1178\" alt=\"å›¾ç‰‡\" title=\"IntelliJ IDEAå¸¸ç”¨å¿«æ·é”®é€Ÿè®°è¡¨\"></p><p>æˆ‘åˆ›å»ºäº†ä¸¤ä¸ªå…³äºå¿«æ·é”®çš„å°æµ‹éªŒï¼Œä¸€ä¸ªæ˜¯<a href=\"https://jinshuju.net/f/RD0T8r\">Macç‰ˆ</a>ï¼Œä¸€ä¸ªæ˜¯<a href=\"https://jinshuju.net/f/KHJfng\">Windowsç‰ˆ</a>ï¼Œä½ å¯ä»¥åˆ»æ„ç»ƒä¹ ä¸€ä¸‹ã€‚</p><p>è¿™æ ·åšçš„å¥½å¤„æ˜¯ï¼Œæ¯ä¸€ä¸ªæ­¥éª¤éƒ½æ˜¯IDEè‡ªåŠ¨å®Œæˆçš„ï¼Œæ˜¯æ¯”è¾ƒå®‰å…¨çš„ã€‚å³ä½¿åœ¨æ²¡æœ‰æµ‹è¯•çš„æƒ…å†µä¸‹ï¼Œä¹Ÿèƒ½ç›¸å¯¹å®‰å…¨åœ°å®Œæˆé‡æ„ã€‚å½“ç„¶ï¼Œæˆ‘è¿™å¯ä¸æ˜¯é¼“åŠ±ä½ åœ¨æ²¡æœ‰æµ‹è¯•çš„æƒ…å†µä¸‹å°±å»é‡æ„ï¼Œè¿™åªæ˜¯ä¸‡ä¸å¾—å·²çš„æƒ…å†µã€‚</p><p>ç”¨å¿«æ·é”®æ¥æ“ä½œï¼Œä¹Ÿæ˜¯IntelliJ IDEAçš„æ­£ç¡®æ‰“å¼€æ–¹å¼ï¼Œå®ƒå¯ä»¥å¤§å¤§æé«˜ä½ çš„å¼€å‘æ•ˆç‡ï¼Œè®©ä½ çš„æ‰‹é€Ÿèƒ½å¤Ÿè·Ÿä¸Šä½ çš„æ€ç»´ã€‚å¦‚æœä½ ç†Ÿç»ƒçš„è¯ï¼Œæ•´ä¸ªé‡æ„è¿‡ç¨‹ä¸è¶…è¿‡1åˆ†é’Ÿå°±èƒ½å®Œæˆï¼Œçœå»äº†å„ç§ä¸Šä¸‹æ–‡åˆ‡æ¢çš„æˆæœ¬ï¼Œæ¯”å¦‚é”®é¼ åˆ‡æ¢ã€Tabé¡µåˆ‡æ¢ç­‰ã€‚</p><h2>é‡æ„ç»“æŸäº†å—ï¼Ÿ</h2><p>æœ‰äººå¯èƒ½è®¤ä¸ºé‡æ„å·²ç»ç»“æŸäº†ï¼Œä½†å¦‚æœä½ å¯¹ä»£ç æœ‰æ´ç™–ï¼Œå°±ä¸èƒ½å®¹å¿åå‘³é“çš„å­˜åœ¨ã€‚æˆ‘ä»¬è™½ç„¶æå–å‡ºäº†ä¸‰ä¸ªæ–¹æ³•å¯¹è±¡ï¼Œä½†ä»£ç ä»ç„¶æœ‰é—®é¢˜ã€‚</p><p>ä¸‹é¢æˆ‘å†æä¾›ä¸¤ç§ä¸åŒçš„é‡æ„æ–¹å‘ã€‚ä½ å¯ä»¥æ¥æ¯”è¾ƒä¸€ä¸‹ã€‚</p><h3>é‡æ„åˆ°ç­–ç•¥æ¨¡å¼</h3><p>ä»”ç»†è§‚å¯ŸTotalAmountCalculatorå’ŒVolumeCreditsCalculatorï¼Œä½ ä¼šå‘ç°ï¼Œå®ƒä»¬çš„æ–¹æ³•ç­¾åéå¸¸ç±»ä¼¼ï¼Œéƒ½æ˜¯æ¥å—ä¸€ä¸ªInvoiceå‚æ•°ï¼Œè¿”å›ä¸€ä¸ªintã€‚è¿™ç§åå‘³é“å«åš<strong>å¼‚æ›²åŒå·¥çš„ç±»ï¼ˆAlternative Classes with Different Interfacesï¼‰</strong>ï¼Œæˆ‘ä»¬å¯ä»¥æå–æ¥å£ï¼Œè®©è¿™ä¸¤ä¸ªç±»å®ç°åŒä¸€ä¸ªæ¥å£ï¼š</p><pre><code class=\"language-java\">public interface InvoiceCalculator {\n    int calculate(Invoice invoice);\n}\n</code></pre><p>TheatricalPlayerså°†å˜æˆï¼š</p><pre><code class=\"language-java\">public class TheatricalPlayers {\n    private InvoiceCalculator totalAmountCalculator;\n    private InvoiceCalculator volumeCreditsCalculator;\n    private ResultFormatter resultFormatter;\n    \n    public TheatricalPlayers(InvoiceCalculator totalAmountCalculator, InvoiceCalculator volumeCreditsCalculator, ResultFormatter resultFormatter) {\n        this.totalAmountCalculator = totalAmountCalculator;\n        this.volumeCreditsCalculator = volumeCreditsCalculator;\n        this.resultFormatter = resultFormatter;\n    }\n    \n    // printæ–¹æ³•\n}\n\n</code></pre><p>ç°åœ¨ï¼Œä¸åŒçš„calculatoréƒ½å®ç°äº†åŒä¸€ä¸ªæ¥å£ï¼Œæˆ‘ä»¬è²Œä¼¼é‡æ„åˆ°äº†ç­–ç•¥æ¨¡å¼ã€‚çœ‹è¿‡ã€Šé‡æ„ä¸æ¨¡å¼ã€‹çš„äººå¯èƒ½ä¼šæš—å–œï¼Œé‡æ„åˆ°è®¾è®¡æ¨¡å¼å¯æ˜¯é‡æ„çš„æœ€é«˜å¢ƒç•Œå•Šï¼Œæˆ‘çš„ä»£ç è²Œä¼¼å‘ç€â€œæ•´æ´â€çš„æ–¹å‘åˆè¿ˆè¿›äº†ä¸€å¤§æ­¥ã€‚ç„¶è€ŒçœŸçš„æ˜¯è¿™æ ·å—ï¼Ÿæˆ‘ä»¬å…ˆæ¥çœ‹çœ‹å¦ä¸€ç§é‡æ„æ€è·¯ã€‚</p><h3>é‡æ„åˆ°é¢†åŸŸæ¨¡å‹</h3><p>æˆ‘ä»¬çœ‹çœ‹TotalAmountCalculatorè¿™ä¸ªæ–¹æ³•å¯¹è±¡ï¼Œå®ƒåªä¾èµ–Invoiceç±»ï¼Œå¹¶ä¸”æœ¬èº«æ²¡æœ‰ä»»ä½•æ•°æ®ã€‚è¿™ç§å¤§é‡ä¾èµ–å¤–éƒ¨æ•°æ®ï¼Œè€Œä¸ä¾èµ–è‡ªå·±å†…éƒ¨æ•°æ®çš„åå‘³é“ï¼Œå«åš<strong>ä¾æ‹æƒ…ç»“ï¼ˆFeature Envyï¼‰</strong>ã€‚æˆ‘ä»¬å¯ä»¥ç›´æ¥å°†æ–¹æ³•ç§»åŠ¨åˆ°Invoiceå†…éƒ¨ã€‚ç”¨ä¸Šé¢å­¦åˆ°çš„å¿«æ·é”®ï¼ŒæŒ‰ä¸€ä¸‹F6å°±å¯ä»¥æå®šã€‚</p><p>ç§»åŠ¨ä¹‹åçš„Invoiceç±»å¦‚ä¸‹æ‰€ç¤ºï¼š</p><pre><code class=\"language-java\">public class Invoice {\n    // å…¶ä»–ä»£ç \n    \n    int calculate() {\n        var totalAmount = 0;\n        for (var perf : performances) {\n            var thisAmount = 40000;\n            if (perf.audience &gt; 30) {\n                thisAmount += 1000 * (perf.audience - 30);\n            }\n            totalAmount += thisAmount;\n        }\n        return totalAmount;\n    }\n}\n</code></pre><p>è¿™æ—¶è¿™ä¸ªæ–¹æ³•å†å«calculateå°±ä¸åˆé€‚äº†ï¼Œæˆ‘ä»¬æŠŠå®ƒæ”¹å›getTotalAmountï¼Œå¦‚æœä½ ä¸å–œæ¬¢getä¸ºå‰ç¼€çš„åå­—ï¼Œä¹Ÿå¯ä»¥å«calculateTotalAmountã€‚</p><p>ä½ è¿˜ä¼šå‘ç°ï¼Œç§»åŠ¨åˆ°Invoiceä¸­æ¥ä¹‹åï¼Œè¿™ä¸ªæ–¹æ³•å°±åªä¾èµ–Performanceäº†ï¼ŒInvoiceä¸è¿‡æ˜¯éå†äº†å¤šä¸ªPerformanceè€Œå·²ã€‚ä½ å¯ä»¥æå–è®¡ç®—å•ä¸ªPerformanceçš„Amountçš„æ–¹æ³•ï¼Œçœ‹çœ‹ä¼šå‘ç”Ÿä»€ä¹ˆã€‚</p><pre><code class=\"language-java\">int calculateTotalAmount() {\n    var totalAmount = 0;\n    for (var perf : performances) {\n        int thisAmount = getThisAmount(perf);\n        totalAmount += thisAmount;\n    }\n    return totalAmount;\n}\nprivate int getThisAmount(Performance perf) {\n    var thisAmount = 40000;\n    if (perf.audience &gt; 30) {\n        thisAmount += 1000 * (perf.audience - 30);\n    }\n    return thisAmount;\n}\n</code></pre><p>ä½ ä¼šå‘ç°getThisAmountæ–¹æ³•åªä¾èµ–Performanceï¼Œè¿™åˆæ˜¯<strong>ä¾æ‹æƒ…ç»“</strong>åå‘³é“ã€‚åŒæ ·çš„ï¼Œå¯ä»¥æŠŠæ–¹æ³•ç§»åŠ¨åˆ°Performanceå†…æ¥æ¶ˆé™¤ã€‚ç§»åŠ¨å®Œä¹‹åï¼ŒcalculateTotalAmountå˜ä¸ºï¼š</p><pre><code class=\"language-java\">int calculateTotalAmount() {\n    var totalAmount = 0;\n    for (var perf : performances) {\n        int thisAmount = perf.calculateAmount();\n        totalAmount += thisAmount;\n    }\n    return totalAmount;\n}\n</code></pre><p>è¿™æ—¶ä½ è¿˜å¯ä»¥å……åˆ†å‘æŒ¥Java streamçš„è¯­æ³•ç‰¹æ€§ï¼Œå°†forå¾ªç¯ä¹Ÿæ¶ˆé™¤æ‰ï¼š</p><pre><code class=\"language-java\">int calculateTotalAmount() {\n    return performances.stream().mapToInt(Performance::calculateAmount).sum();\n}\n</code></pre><p>åŒæ ·çš„ï¼ŒVolumeCreditsCalculatoræ–¹æ³•ä¹Ÿå­˜åœ¨ä¾æ‹æƒ…ç»“åå‘³é“ï¼Œå¯ä»¥ç”¨åŒæ ·çš„æ–¹å¼æ¥é‡æ„ã€‚éƒ½å®Œæˆåï¼ŒTheatricalPlayersç±»çš„printæ–¹æ³•å°†å¦‚ä¸‹æ‰€ç¤ºï¼š</p><pre><code class=\"language-java\">public String print(Invoice invoice) {\n    int totalAmount = invoice.calculateTotalAmount();\n    int volumeCredits = invoice.calculateVolumeCredits();\n    return resultFormatter.getResult(invoice, totalAmount, volumeCredits);\n}\n</code></pre><p>è¿™æ—¶ï¼Œä½ å¯ä»¥å°†totalAmountå’ŒvolumeCreditså†…è”ï¼Œè¿™æ ·æ–¹æ³•å°±å‰©ä¸‹äº†ä¸€è¡Œã€‚å®ƒçš„èŒè´£å°±åªå‰©ä¸‹äº†æ ¼å¼åŒ–ç»“æœï¼Œå› ä¸ºè®¡ç®—totalAmountå’ŒvolumeCreditsçš„é€»è¾‘å·²ç»è¢«éš”ç¦»åœ¨äº†Invoiceä¸­ã€‚é‚£ä¹ˆå½“å‰æ–¹æ³•å’ŒResultFormatterçš„èŒè´£ä¹Ÿé‡å äº†ï¼Œæˆ‘ä»¬å¯ä»¥æŠŠè¿™ä¸ªgetResultæ–¹æ³•ä¹Ÿå†…è”æ‰ã€‚</p><pre><code class=\"language-java\">public String print(Invoice invoice) {\n    var format = NumberFormat.getCurrencyInstance(Locale.US);\n    var result = String.format(\"Statement for %s\\n\", invoice.customer);\n    result += String.format(\"Amount owed is %s\\n\", format.format(invoice.calculateTotalAmount() / 100));\n    result += String.format(\"You earned %s credits\\n\", invoice.calculateVolumeCredits());\n    return result;\n}\n</code></pre><p>æˆ‘ä»¬æŠŠé‡æ„å‡ºæ¥çš„ä¸‰ä¸ªæ–¹æ³•å¯¹è±¡ï¼Œå±…ç„¶åˆå…¨éƒ¨æ¶ˆé™¤æ‰äº†ï¼</p><p>ä¸ºä»€ä¹ˆäº§ç”Ÿäº†â€œæ¶ˆæ¶ˆä¹â€ä¸€æ ·çš„æ•ˆæœå‘¢ï¼Ÿè¿™æ˜¯å› ä¸ºæˆ‘ä»¬æŠŠè®¡ç®—çš„é€»è¾‘éƒ½æ”¾åˆ°äº†Invoiceå’ŒPerformanceå¯¹è±¡ä¸­ï¼Œå°±æ²¡æœ‰å¿…è¦å¼•å…¥å…¶ä»–çš„ç®—æ³•ç±»ï¼ˆæ–¹æ³•å¯¹è±¡ï¼‰äº†ã€‚è¿™ç§<strong>æŠŠæ•°æ®è¡Œä¸ºéƒ½æ”¾åœ¨å¯¹è±¡ä¸­</strong>çš„æ¨¡å¼ï¼Œå«åš<strong>é¢†åŸŸæ¨¡å‹æ¨¡å¼</strong>ã€‚æˆ‘ä»¬å°†åœ¨ä¸‹èŠ‚è¯¾è¯¦ç»†ä»‹ç»ã€‚</p><p>æ¯”è¾ƒä¸€ä¸‹ä¸Šé¢æåˆ°çš„ä¸¤ç§é‡æ„æ–¹å‘ï¼Œä½ è§‰å¾—å“ªç§æ›´é€‚åˆå½“å‰çš„ä»£ç å‘¢ï¼Ÿæˆ‘çš„ç­”æ¡ˆæ˜¯ç¬¬äºŒç§ã€‚</p><p>ç¬¬ä¸€ç§é‡æ„è™½ç„¶çœ‹ä¸Šå»åƒæ˜¯â€œç­–ç•¥æ¨¡å¼â€ï¼Œä½†å®é™…ä¸Šç­–ç•¥æ¥å£çš„ä¸¤ä¸ªå®ç°ç±»å¹¶ä¸æ˜¯ç›¸äº’æ›¿æ¢çš„å…³ç³»ï¼Œè€Œæ˜¯â€œæ¯«æ— å…³ç³»â€ã€‚æ‰€æœ‰è¡Œä¸ºå‹æ¨¡å¼çš„å…±åŒç‰¹ç‚¹æ˜¯ï¼Œä¸åŒçš„è¡Œä¸ºå¯ä»¥æ ¹æ®æŸäº›æ¡ä»¶ç›¸äº’æ›¿æ¢ï¼Œç›´ç™½ç‚¹è¯´å°±æ˜¯ï¼Œè¦æœ‰if/elseï¼Œæ‰èƒ½ä½“ç°å‡ºè¿™äº›æ›¿æ¢ã€‚è€Œä»£ç ä¸­çš„TotalAmountCalculatorå’ŒVolumeCreditsCalculatorè™½ç„¶éƒ½å«calculatorï¼Œä½†æ²¡æœ‰if/elseï¼Œå®ƒä»¬åœ¨åŸæ–¹æ³•ä¸­æ˜¯é¡ºåºæ‰§è¡Œçš„ï¼Œä¸èƒ½ç›¸äº’æ›¿æ¢ã€‚</p><p>ä½ å¿…é¡»å¯¹æ‰€æœ‰ä»£ç åå‘³é“å’Œæ¨¡å¼éå¸¸ç†Ÿæ‚‰ï¼Œæ‰èƒ½æ‰¾åˆ°æ­£ç¡®çš„é‡æ„æ–¹å‘ã€‚é‡æ„åˆ°è®¾è®¡æ¨¡å¼å›ºç„¶ç¾å¥½ï¼Œä½†å¹¶ä¸ä¸€å®šå°±æ˜¯æœ€ç»ˆç›®æ ‡ï¼Œæœ‰æ—¶å€™ä½ å¯èƒ½ä¼šç”¨é”™è®¾è®¡æ¨¡å¼ï¼Œæœ‰æ—¶å€™ä¼šè¿‡åº¦è®¾è®¡ã€‚é‡æ„åˆ°ä¸€ä¸ªåˆšåˆšå¥½çš„çŠ¶æ€ï¼Œæ²¡æœ‰æ˜æ˜¾çš„åå‘³é“ï¼Œå°±è¶³å¤Ÿäº†ã€‚</p><h2>å°ç»“</h2><p>ç»ˆäºå­¦å®Œäº†ä»Šå¤©çš„è¯¾ç¨‹ï¼Œå¸Œæœ›ä½ å­¦å®Œçš„æ„Ÿå—æ˜¯â€œå¤§å‘¼è¿‡ç˜¾â€ã€‚æœ‰æ—¶å€™é‡æ„çš„æ„Ÿè§‰å°±æ˜¯è¿™æ ·ï¼Œæ¯”å®é™…å†™ä»£ç æ›´è®©äººèº«å¿ƒæ„‰æ‚¦ã€‚</p><p>æˆ‘ä»Šå¤©ä¸ºä½ å±•ç¤ºäº†é‡æ„é—ç•™ä»£ç çš„å€šå¤©å‰‘å’Œå± é¾™åˆ€ï¼Œå¸Œæœ›å®ƒä»¬èƒ½åŠ©ä½ åœ¨é—ç•™ç³»ç»Ÿçš„è†æ£˜ä¹‹ä¸­ï¼Œæ€å‡ºä¸€æ¡è¡€è·¯ã€‚å…¶å®é‡æ„æ‰‹æ³•å’Œæ¨¡å¼è¿˜æœ‰å¾ˆå¤šå¾ˆå¤šï¼Œæˆ‘ä¹‹æ‰€ä»¥è®¤ä¸ºè¿™ä¸¤ä¸ªç‰¹åˆ«å®ç”¨ï¼Œæ˜¯å› ä¸ºåœ¨é‡æ„äº†å¤§é‡é—ç•™ä»£ç åï¼Œæˆ‘å‘ç°<strong>æ‹†åˆ†é˜¶æ®µ</strong>å’Œ<strong>æ–¹æ³•å¯¹è±¡</strong>æ˜¯å¿…ä¸å¯å°‘çš„ä¸­é—´æ­¥éª¤ã€‚</p><p>å½“ä½ é€šè¿‡è¿™ä¸¤ç§æ–¹å¼å®Œæˆäº†åˆæ­¥é‡æ„ä¹‹åï¼Œè¿˜è¦å®¡è§†ä¸€ä¸‹ä»£ç ï¼Œæ ¹æ®åå‘³é“å®ç°ä¸‹ä¸€æ­¥çš„é‡æ„ã€‚</p><p>æˆ‘è¿˜åœ¨ä»‹ç»æ–¹æ³•å¯¹è±¡çš„æ—¶å€™ï¼Œç©¿æ’äº†å¦‚ä½•ä½¿ç”¨å¿«æ·é”®æ¥å®Œæˆé‡æ„ã€‚ä½ å¯èƒ½ä¼šè§‰å¾—è®°ä½é¢å¤–çš„å¿«æ·é”®å±äºå¤–åœ¨è®¤çŸ¥è´Ÿè½½ï¼Œå…¶å®ä¸ç„¶ã€‚å®ƒä»¬èƒ½å¤Ÿæé«˜ä½ çš„å·¥ä½œæ•ˆç‡ï¼Œè€Œä¸”ä¸€æ—¦è®°ä½å¹¶ä¸”ç†Ÿç»ƒæŒæ¡ï¼Œå°±èƒ½ä¸€åŠ³æ°¸é€¸ã€‚è¿™ç§çŸ¥è¯†å±äºå†…åœ¨è®¤çŸ¥è´Ÿè½½ï¼Œæ˜¯æˆ‘ä»¬å®Œæˆå·¥ä½œå¿…é¡»å…·å¤‡çš„æŠ€èƒ½ã€‚</p><p>é‡æ„æ‰‹æ³•ä¹Ÿå¥½ï¼Œå¿«æ·é”®ä¹Ÿç½¢ï¼Œéƒ½ä¸æ˜¯ä»€ä¹ˆå¥‡æŠ€æ·«å·§ï¼Œè€Œæ˜¯åƒç„é“é‡å‰‘ä¸€æ ·ï¼Œé‡å‰‘æ— é”‹ï¼Œå¤§å·§ä¸å·¥ã€‚å®ƒä»¬åº”è¯¥èåŒ–åœ¨æ¯ä¸€ä¸ªå¼€å‘äººå‘˜çš„è¡€æ¶²é‡Œã€‚å¦‚æœä½ è¿˜ä¸ç†Ÿæ‚‰ï¼Œå°±æŠ“ç´§ç»ƒèµ·æ¥å§ã€‚</p><p>æ— ä»–ï¼Œå”¯æ‰‹ç†Ÿå°”ã€‚</p><h2>æ€è€ƒé¢˜</h2><p>æ„Ÿè°¢ä½ å­¦å®Œäº†ä»Šå¤©çš„å†…å®¹ï¼Œå¸Œæœ›ä½ èƒ½é€šè¿‡ä¹¦ç±å’Œåšå®¢å»å­¦ä¹ ä¸€ä¸‹å…¶ä»–çš„é‡æ„æ‰‹æ³•å’Œæ¨¡å¼ã€‚ä»Šå¤©çš„è¯¾åä½œä¸šï¼Œè¿˜æ˜¯è¯·ä½ æ¥è´´ä¸€æ®µé¡¹ç›®ä¸­çš„å®é™…ä»£ç ï¼Œæˆ‘ä»¬ä¸€èµ·æ¥åˆ†æä¸€ä¸‹å…¶ä¸­çš„åå‘³é“ï¼Œå¹¶é€šè¿‡åå‘³é“æ¥é©±åŠ¨æˆ‘ä»¬é‡æ„ã€‚</p><p>å¦‚æœä½ è§‰å¾—ä»Šå¤©çš„è¯¾ç¨‹å¯¹ä½ æœ‰å¸®åŠ©ï¼Œè¯·æŠŠå®ƒåˆ†äº«ç»™ä½ çš„åŒäº‹å’Œæœ‹å‹ï¼Œæˆ‘ä»¬ä¸€èµ·æ¥é‡æ„å§ã€‚ä¸‹èŠ‚è¯¾ï¼Œæˆ‘ä»¬ç»§ç»­æŒ‘æˆ˜ä»£ç çš„åˆ†å±‚é‡æ„ï¼Œæ•¬è¯·æœŸå¾…ã€‚</p>","comments":[{"had_liked":false,"id":344614,"user_name":"aoe","can_delete":false,"product_type":"c1","uid":1121758,"ip_address":"","ucode":"1C6201EDB4E954","user_header":"https://static001.geekbang.org/account/avatar/00/11/1d/de/62bfa83f.jpg","comment_is_top":false,"comment_ctime":1651671939,"is_pvip":false,"replies":[{"id":125769,"content":"åŠ æ²¹ğŸ’ª","user_name":"ä½œè€…å›å¤","user_name_real":"ç¼–è¾‘","uid":1009237,"ctime":1651709076,"ip_address":"","comment_id":344614,"utype":1}],"discussion_count":2,"race_medal":0,"score":2,"product_id":100111101,"comment_content":"åŸæ¥ã€Šé‡æ„ã€‹ç¬¬äºŒç‰ˆä¸­ä»‹ç»äº†è¿™ä¹ˆå¤šä»£ç çš„åå‘³é“ï¼Œè¿˜æ²¡çœ‹è¿‡ï¼Œç«‹é©¬ä¹°äº†ä¸€æœ¬ã€‚\nç›®å‰æŒæ¡çš„å‘ç°åå‘³é“çš„çŸ¥è¯†å¤§éƒ¨åˆ†æ¥è‡ªéƒ‘çƒ¨è€å¸ˆçš„ä¸“æ ã€Šè½¯ä»¶è®¾è®¡ä¹‹ç¾ã€‹ã€ã€Šä»£ç æ•´æ´ä¹‹é“ã€‹ã€ã€Šä¿®æ”¹ä»£ç çš„è‰ºæœ¯ã€‹\nç°åœ¨åˆå¤šäº†ä¸€ä¸ªæ¥æºï¼šè·Ÿç€å§šçªç³è€å¸ˆå­¦ä¹ å‘ç°ä»£ç çš„åå‘³é“\nå¦‚æœçœ‹è¿‡ä¸“æ ã€Šå¾æ˜Š Â· TDDé¡¹ç›®å®æˆ˜70è®²ã€‹çš„1~4è¯¾åï¼Œå†çœ‹æœ¬ç¯‡æ–‡ç« ä¼šæœ‰ä¸€ç§é£ç”Ÿæ°´èµ·çš„æ„Ÿè§‰ï¼\nä¹‹å‰ä¸€ç›´çœ‹å¾æ˜Šè€å¸ˆ inlineï¼Œä¸æ‡‚å…¶å¥¥ä¹‰ï¼Œä»Šå¤©æ‰æ˜ç™½ï¼šåŸæ¥åœ¨é‡æ„çš„æ—¶å€™ç»è¿‡ inline çš„ä»£ç å¯ä»¥æ‘†è„±è°ƒç”¨æ–¹æ³•çš„é™åˆ¶ï¼Œæƒ³ç§»åŠ¨åˆ°å“ªéƒ½å¯ä»¥","like_count":9,"discussions":[{"author":{"id":2949650,"avatar":"https://static001.geekbang.org/account/avatar/00/2d/02/12/fb772114.jpg","nickname":"è§æ³‰å½¬","note":"","ucode":"96B966C42BCD06","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":591310,"discussion_content":"æ„Ÿè§‰å’ŒTDDä¸€æ ·ï¼ŒTDDæ˜¯å®Œæ•´çš„å¼€å‘æµç¨‹ï¼Œè€Œæœ¬è¯¾å¼ºè°ƒæ¶ˆé™¤åå‘³é“ã€‚","likes_number":1,"is_delete":false,"is_hidden":false,"ctime":1666488474,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":"ä¸Šæµ·","group_id":0},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1009237,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/66/55/098b3396.jpg","nickname":"å§šçªç³","note":"","ucode":"68EB7FFC9B8A6F","race_medal":0,"user_type":2,"is_pvip":true},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":570202,"discussion_content":"åŠ æ²¹ğŸ’ª","likes_number":1,"is_delete":false,"is_hidden":false,"ctime":1651709076,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":345096,"user_name":"äº‘å²­ç‰§å°‘æ­Œ","can_delete":false,"product_type":"c1","uid":1697306,"ip_address":"","ucode":"269FED77D3B482","user_header":"https://static001.geekbang.org/account/avatar/00/19/e6/1a/4f52130c.jpg","comment_is_top":false,"comment_ctime":1652019396,"is_pvip":false,"replies":[{"id":125937,"content":"å¥½é—®é¢˜ï¼\nä½ å¯ä»¥ç†è§£ä¸ºï¼ŒPerformanceæä¾›çš„è¿™ä¸¤ä¸ªèƒ½åŠ›ï¼Œéƒ½æ˜¯åŒä¸€ä¸ªæŠ½è±¡çº§åˆ«çš„ã€‚Bobå¤§å”åœ¨Clean Architectureé‡Œè¯´çš„ï¼Œå•ä¸€èŒè´£çš„å•ä¸€æŒ‡çš„æ˜¯å•ä¸ªæŠ½è±¡çº§åˆ«ã€‚\nä½†ä¸ºä»€ä¹ˆè¿™ä¸¤ä¸ªæ–¹æ³•åœ¨TheatricalPlayersç±»é‡Œå°±ä¸æ˜¯åŒä¸€ä¸ªæŠ½è±¡çº§åˆ«å‘¢ï¼Ÿå› ä¸ºè¿™ä¸ªç±»ä¸»è¦ä½¿ç”¨æ¥æ‰“å°ï¼Œè¿™äº›è®¡ç®—è·Ÿæ‰“å°å°±å±äºä¸åŒçš„æŠ½è±¡çº§åˆ«äº†ã€‚","user_name":"ä½œè€…å›å¤","user_name_real":"ç¼–è¾‘","uid":1009237,"ctime":1652055848,"ip_address":"","comment_id":345096,"utype":1}],"discussion_count":1,"race_medal":0,"score":2,"product_id":100111101,"comment_content":"è€å¸ˆï¼Œæˆ‘æœ‰ä¸€ä¸ªç–‘é—®ï¼Œæœ€ç»ˆé‡æ„åPerformanceç±»çœ‹èµ·æ¥ä¹Ÿä¸æ˜¯å•ä¸€çš„å§ï¼ŒcalculateAmountå’ŒcalculateCreditså„æœ‰ä¸€ä¸ªä¿®æ”¹çš„åŸå› ï¼Œä½†æ„Ÿè§‰amountå’Œcreditsçš„è®¡ç®—åˆåº”è¯¥æ”¾åˆ°Performanceç±»é‡Œï¼Œå¾ˆçŸ›ç›¾ï¼Œé‚£æ€ä¹ˆç†è§£å‘¢ï¼Ÿ\npublic class Performance {\n    private int audience;\n    private Play play;\n\n    public int calculateAmount() {\n        int thisAmount = 40000;\n        if (audience &gt; 30) {\n            thisAmount += 1000 * (audience - 30);\n        }\n        return thisAmount;\n    }\n\n    public int calculateCredits() {\n        int thisCredits = Math.max(audience - 30, 0);\n        if (&quot;comedy&quot;.equals(play.type)) thisCredits += Math.floor((double) audience &#47; 5);\n        return thisCredits;\n    }\n}","like_count":5,"discussions":[{"author":{"id":1009237,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/66/55/098b3396.jpg","nickname":"å§šçªç³","note":"","ucode":"68EB7FFC9B8A6F","race_medal":0,"user_type":2,"is_pvip":true},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":571021,"discussion_content":"å¥½é—®é¢˜ï¼\nä½ å¯ä»¥ç†è§£ä¸ºï¼ŒPerformanceæä¾›çš„è¿™ä¸¤ä¸ªèƒ½åŠ›ï¼Œéƒ½æ˜¯åŒä¸€ä¸ªæŠ½è±¡çº§åˆ«çš„ã€‚Bobå¤§å”åœ¨Clean Architectureé‡Œè¯´çš„ï¼Œå•ä¸€èŒè´£çš„å•ä¸€æŒ‡çš„æ˜¯å•ä¸ªæŠ½è±¡çº§åˆ«ã€‚\nä½†ä¸ºä»€ä¹ˆè¿™ä¸¤ä¸ªæ–¹æ³•åœ¨TheatricalPlayersç±»é‡Œå°±ä¸æ˜¯åŒä¸€ä¸ªæŠ½è±¡çº§åˆ«å‘¢ï¼Ÿå› ä¸ºè¿™ä¸ªç±»ä¸»è¦ä½¿ç”¨æ¥æ‰“å°ï¼Œè¿™äº›è®¡ç®—è·Ÿæ‰“å°å°±å±äºä¸åŒçš„æŠ½è±¡çº§åˆ«äº†ã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1652055849,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":380032,"user_name":"zcc","can_delete":false,"product_type":"c1","uid":1046664,"ip_address":"ä¸Šæµ·","ucode":"58FB42400517A9","user_header":"https://static001.geekbang.org/account/avatar/00/0f/f8/88/96b870fd.jpg","comment_is_top":false,"comment_ctime":1692867769,"is_pvip":false,"replies":[{"id":138479,"content":"æ²¡é”™ï¼ŒResultFormatterä¹Ÿåªä¾èµ–äº†Invoiceï¼Œä½†æˆ‘è¿™é‡Œå¹¶æ²¡æœ‰æŠŠæ ¼å¼åŒ–çš„é€»è¾‘ä¹Ÿæ”¾åˆ°Invoiceé‡Œï¼Œè¿™æ˜¯å› ä¸ºæ ¼å¼åŒ–ç»“æœæœ¬èº«ä¸åº”è¯¥æ˜¯Invoiceé¢†åŸŸæ¨¡å‹çš„ä¸€éƒ¨åˆ†ï¼ˆå½“ç„¶ï¼Œå…³äºæŸä¸ªé€»è¾‘æ˜¯å¦å±äºæŸä¸ªé¢†åŸŸæ¨¡å‹ï¼Œéœ€è¦å›¢é˜Ÿè®¨è®ºè¾¾æˆå…±è¯†ï¼‰ï¼ŒInvoiceæ‰€åŒ…å«çš„åº”è¯¥æ˜¯å„ç§é‡‘é¢æ•°æ®ã€è®¡ç®—æ€»é¢ä»¥åŠä¼˜æƒ ï¼Œæ ¼å¼åŒ–å±äºä¸€ä¸ªæ¨ªåˆ‡çš„éœ€æ±‚ã€‚è€Œä¸”ï¼Œå½“æ ¼å¼åŒ–çš„é€»è¾‘ä¹Ÿä¼šå‘ç”Ÿå˜åŒ–çš„æ—¶å€™ï¼Œæ”¾åˆ°Invoiceé‡Œé¢å°±ä¼šæ›´åŠ åƒµåŒ–ã€‚","user_name":"ä½œè€…å›å¤","user_name_real":"ç¼–è¾‘","uid":1009237,"ctime":1693284390,"ip_address":"åŒ—äº¬","comment_id":380032,"utype":1}],"discussion_count":2,"race_medal":0,"score":2,"product_id":100111101,"comment_content":"ç¡®å®æŒºè¿‡ç˜¾çš„ï¼Œæˆ‘ä¸çŸ¥é“è‡ªå·±çœ‹äº†å¤šå°‘éäº†ï¼Œæ¯æ¬¡çœ‹å®Œéƒ½èº«å¿ƒæ„‰æ‚¦ï¼Œå¤ªå€¼äº†ï¼å“ªæ€•åµæ¶äº†å¿ƒæƒ…ä¸å¥½äº†ï¼Œä¹Ÿå¯ä»¥çœ‹ï¼ŒO(âˆ©_âˆ©)Oå“ˆå“ˆ~\n\npublic String print(Invoice invoice) {\n    int totalAmount = invoice.calculateTotalAmount();\n    int volumeCredits = invoice.calculateVolumeCredits();\n    return resultFormatter.getResult(invoice, totalAmount, volumeCredits);\n}\nåˆ°è¿™ä¸€æ­¥ï¼ŒResultFormatterå¯¹è±¡çš„getResultæ–¹æ³•å¯¹Invoiceå¯¹è±¡ä¹Ÿæœ‰ä¾æ‹æƒ…ç»“ï¼ŒåŒæ ·æŒ‰ä¸‹F6å°±ç§»åŠ¨Invoiceäº†ã€‚çœ‹èµ·æ¥å°±æ›´æ¸…çˆ½ï¼Œä¸‰ä¸ªæ­¥éª¤å®Œæˆï¼š\npublic String print(Invoice invoice) {\n    int totalAmount = invoice.calculateTotalAmount();\n    int volumeCredits = invoice.calculateVolumeCredits();\n    return invoice.format(totalAmount, volumeCredits);\n}","like_count":2,"discussions":[{"author":{"id":1009237,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/66/55/098b3396.jpg","nickname":"å§šçªç³","note":"","ucode":"68EB7FFC9B8A6F","race_medal":0,"user_type":2,"is_pvip":true},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":626693,"discussion_content":"æ²¡é”™ï¼ŒResultFormatterä¹Ÿåªä¾èµ–äº†Invoiceï¼Œä½†æˆ‘è¿™é‡Œå¹¶æ²¡æœ‰æŠŠæ ¼å¼åŒ–çš„é€»è¾‘ä¹Ÿæ”¾åˆ°Invoiceé‡Œï¼Œè¿™æ˜¯å› ä¸ºæ ¼å¼åŒ–ç»“æœæœ¬èº«ä¸åº”è¯¥æ˜¯Invoiceé¢†åŸŸæ¨¡å‹çš„ä¸€éƒ¨åˆ†ï¼ˆå½“ç„¶ï¼Œå…³äºæŸä¸ªé€»è¾‘æ˜¯å¦å±äºæŸä¸ªé¢†åŸŸæ¨¡å‹ï¼Œéœ€è¦å›¢é˜Ÿè®¨è®ºè¾¾æˆå…±è¯†ï¼‰ï¼ŒInvoiceæ‰€åŒ…å«çš„åº”è¯¥æ˜¯å„ç§é‡‘é¢æ•°æ®ã€è®¡ç®—æ€»é¢ä»¥åŠä¼˜æƒ ï¼Œæ ¼å¼åŒ–å±äºä¸€ä¸ªæ¨ªåˆ‡çš„éœ€æ±‚ã€‚è€Œä¸”ï¼Œå½“æ ¼å¼åŒ–çš„é€»è¾‘ä¹Ÿä¼šå‘ç”Ÿå˜åŒ–çš„æ—¶å€™ï¼Œæ”¾åˆ°Invoiceé‡Œé¢å°±ä¼šæ›´åŠ åƒµåŒ–ã€‚","likes_number":1,"is_delete":false,"is_hidden":false,"ctime":1693284391,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"åŒ—äº¬","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":1,"child_discussions":[{"author":{"id":1046664,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/f8/88/96b870fd.jpg","nickname":"zcc","note":"","ucode":"58FB42400517A9","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":1009237,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/66/55/098b3396.jpg","nickname":"å§šçªç³","note":"","ucode":"68EB7FFC9B8A6F","race_medal":0,"user_type":2,"is_pvip":true},"discussion":{"id":626952,"discussion_content":"å¤šè°¢è€å¸ˆè§£æƒ‘ç­”ç–‘ï¼šï¼‰","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1693499643,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":626693,"ip_address":"ä¸Šæµ·","group_id":0},"score":626952,"extra":""}]}]},{"had_liked":false,"id":346444,"user_name":"zahi","can_delete":false,"product_type":"c1","uid":1447887,"ip_address":"","ucode":"F64ABEB63C6D1F","user_header":"http://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTIofiaCAziajdQnbvrfpEkpCKVFgO62y6zicamhjF1BAWZSRcCVaTBXLIerLsGeZCic7XS7KOEkTN4fRg/132","comment_is_top":false,"comment_ctime":1653141421,"is_pvip":true,"replies":null,"discussion_count":0,"race_medal":0,"score":2,"product_id":100111101,"comment_content":"è€å¸ˆèƒ½ä¸èƒ½ä¹Ÿææéé¢å‘å¯¹è±¡çš„å®ç°æ–¹å¼ã€‚","like_count":1},{"had_liked":false,"id":380035,"user_name":"zcc","can_delete":false,"product_type":"c1","uid":1046664,"ip_address":"ä¸Šæµ·","ucode":"58FB42400517A9","user_header":"https://static001.geekbang.org/account/avatar/00/0f/f8/88/96b870fd.jpg","comment_is_top":false,"comment_ctime":1692868447,"is_pvip":false,"replies":null,"discussion_count":0,"race_medal":0,"score":2,"product_id":100111101,"comment_content":"è€å¸ˆä»æ‹†åˆ†é˜¶æ®µï¼Œåˆ°å¼•å…¥æ–¹æ³•å¯¹è±¡ï¼Œç„¶ååˆ°æ¶ˆæ¶ˆä¹æ¶ˆé™¤äº†ä¸‰ä¸ªæ–¹æ³•å¯¹è±¡ï¼ˆæ–¹æ³•éƒ½åˆ°Performanceå’ŒInvoiceå¯¹è±¡ä¸Šäº†ï¼‰ï¼Œç»™æˆ‘ä»¬å±•ç¤ºäº†æ•´ä¸ªé‡æ„è¿‡ç¨‹ã€‚å°±æœ¬ä¾‹ä»£ç è€Œè¨€ï¼Œæ‹†åˆ†é˜¶æ®µå®Œæˆåï¼Œå°±å¯ä»¥æŒ‰F6ç”¨IDEAçš„Move Instance Methodé‡æ„æ‰‹æ³•ï¼Œå°†ä»å‘æ•£åœ¨TheatricalPlayersç±»é‡Œçš„ç§æœ‰æ–¹æ³•åˆ†åˆ«ç§»åŠ¨åˆ°Performanceå’ŒInvoiceå¯¹è±¡ä¸Šã€‚","like_count":0},{"had_liked":false,"id":370250,"user_name":"Spoon","can_delete":false,"product_type":"c1","uid":1959822,"ip_address":"æµ™æ±Ÿ","ucode":"2FF9193AD482C2","user_header":"https://static001.geekbang.org/account/avatar/00/1d/e7/8e/318cfde0.jpg","comment_is_top":false,"comment_ctime":1678607159,"is_pvip":false,"replies":null,"discussion_count":0,"race_medal":0,"score":2,"product_id":100111101,"comment_content":"æ–¹æ³•å¯¹è±¡&amp;é‡æ„å‘åˆ°é¢†åŸŸæ¨¡å‹ï¼Œå—ç›ŠåŒªæµ…~","like_count":0},{"had_liked":false,"id":367865,"user_name":"fliyu","can_delete":false,"product_type":"c1","uid":1588873,"ip_address":"å¹¿ä¸œ","ucode":"E80D318348CA47","user_header":"https://static001.geekbang.org/account/avatar/00/18/3e/89/77829168.jpg","comment_is_top":false,"comment_ctime":1675687981,"is_pvip":false,"replies":null,"discussion_count":0,"race_medal":0,"score":2,"product_id":100111101,"comment_content":"è®©æˆ‘æ˜å¤©å†çœ‹çœ‹ä¸€é","like_count":0},{"had_liked":false,"id":358887,"user_name":"èŠ±èŠ±å¤§è„¸çŒ«","can_delete":false,"product_type":"c1","uid":1117318,"ip_address":"æ±Ÿè‹","ucode":"8ABDB3F7F4FB0F","user_header":"https://static001.geekbang.org/account/avatar/00/11/0c/86/8e52afb8.jpg","comment_is_top":false,"comment_ctime":1664970726,"is_pvip":true,"replies":null,"discussion_count":0,"race_medal":0,"score":2,"product_id":100111101,"comment_content":"è¿™ä¸€ç¯‡å…¶å®æ²¡æœ‰ä»€ä¹ˆæ ‡å‡†çš„æ¨¡å¼ï¼Œåœ¨ä¸åŒçš„é¡¹ç›®ä¸‹ï¼Œå…¶ å¤„ç†çš„æ­¥éª¤å¯èƒ½å®Œå…¨ä¸ä¸€æ ·ï¼Œä¸€æ ·çš„æ˜¯å¤„ç†é—®é¢˜çš„æ€è·¯ï¼Œè€å¸ˆæä¾›äº†è¿™æ ·ä¸€ä¸ªå¥‘æœºå±•ç°è‡ªå·±å¤„ç†é—®é¢˜çš„æƒ³æ³•ï¼Œä½†æ˜¯å¯èƒ½æ¯ä¸ªäººçš„æƒ³æ³•åœ¨è¿™ä¸ªå¥‘æœºä¸Šå¹¶ä¸æ˜¯ä¸€æ ·çš„ã€‚å…¶å®è€å¸ˆè¯´çš„è¿™äº›å¤§éƒ¨åˆ†äººéƒ½ä¼šæ¥è§¦è¿‡ï¼Œä½†æ˜¯ç¼ºä¹ä¸€ä¸ªç†è®ºæ€§çš„æ€»ç»“è¿‡ç¨‹ï¼Œåœ¨çœŸå®é¢å¯¹çš„æ—¶å€™ï¼Œæ€»æ˜¯è§‰å¾—ä¸å¤Ÿè‡ªä¿¡é¢å¯¹ï¼Œæ„Ÿè§‰ç¼ºå°‘äº†ä»€ä¹ˆï¼Œå…¶å®è¿™å°±æ˜¯æˆ‘ä»¬æ‰€æ¬ ç¼ºä»¥åŠéœ€è¦ç§¯ç´¯çš„ã€‚","like_count":0}]}