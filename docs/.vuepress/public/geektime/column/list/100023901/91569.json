{"id":91569,"title":"24 | CompletableFutureï¼šå¼‚æ­¥ç¼–ç¨‹æ²¡é‚£ä¹ˆéš¾","content":"<p>å‰é¢æˆ‘ä»¬ä¸æ­¢ä¸€æ¬¡æåˆ°ï¼Œç”¨å¤šçº¿ç¨‹ä¼˜åŒ–æ€§èƒ½ï¼Œå…¶å®ä¸è¿‡å°±æ˜¯å°†ä¸²è¡Œæ“ä½œå˜æˆå¹¶è¡Œæ“ä½œã€‚å¦‚æœä»”ç»†è§‚å¯Ÿï¼Œä½ è¿˜ä¼šå‘ç°åœ¨ä¸²è¡Œè½¬æ¢æˆå¹¶è¡Œçš„è¿‡ç¨‹ä¸­ï¼Œä¸€å®šä¼šæ¶‰åŠåˆ°å¼‚æ­¥åŒ–ï¼Œä¾‹å¦‚ä¸‹é¢çš„ç¤ºä¾‹ä»£ç ï¼Œç°åœ¨æ˜¯ä¸²è¡Œçš„ï¼Œä¸ºäº†æå‡æ€§èƒ½ï¼Œæˆ‘ä»¬å¾—æŠŠå®ƒä»¬å¹¶è¡ŒåŒ–ï¼Œé‚£å…·ä½“å®æ–½èµ·æ¥è¯¥æ€ä¹ˆåšå‘¢ï¼Ÿ</p><pre><code>//ä»¥ä¸‹ä¸¤ä¸ªæ–¹æ³•éƒ½æ˜¯è€—æ—¶æ“ä½œ\ndoBizA();\ndoBizB();\n</code></pre><p>è¿˜æ˜¯æŒºç®€å•çš„ï¼Œå°±åƒä¸‹é¢ä»£ç ä¸­è¿™æ ·ï¼Œåˆ›å»ºä¸¤ä¸ªå­çº¿ç¨‹å»æ‰§è¡Œå°±å¯ä»¥äº†ã€‚ä½ ä¼šå‘ç°ä¸‹é¢çš„å¹¶è¡Œæ–¹æ¡ˆï¼Œä¸»çº¿ç¨‹æ— éœ€ç­‰å¾…doBizA()å’ŒdoBizB()çš„æ‰§è¡Œç»“æœï¼Œä¹Ÿå°±æ˜¯è¯´doBizA()å’ŒdoBizB()ä¸¤ä¸ªæ“ä½œå·²ç»è¢«å¼‚æ­¥åŒ–äº†ã€‚</p><pre><code>new Thread(()-&gt;doBizA())\n  .start();\nnew Thread(()-&gt;doBizB())\n  .start();  \n</code></pre><p><strong>å¼‚æ­¥åŒ–</strong>ï¼Œæ˜¯å¹¶è¡Œæ–¹æ¡ˆå¾—ä»¥å®æ–½çš„åŸºç¡€ï¼Œæ›´æ·±å…¥åœ°è®²å…¶å®å°±æ˜¯ï¼š<strong>åˆ©ç”¨å¤šçº¿ç¨‹ä¼˜åŒ–æ€§èƒ½è¿™ä¸ªæ ¸å¿ƒæ–¹æ¡ˆå¾—ä»¥å®æ–½çš„åŸºç¡€</strong>ã€‚çœ‹åˆ°è¿™é‡Œï¼Œç›¸ä¿¡ä½ åº”è¯¥å°±èƒ½ç†è§£å¼‚æ­¥ç¼–ç¨‹æœ€è¿‘å‡ å¹´ä¸ºä»€ä¹ˆä¼šå¤§ç«äº†ï¼Œå› ä¸ºä¼˜åŒ–æ€§èƒ½æ˜¯äº’è”ç½‘å¤§å‚çš„ä¸€ä¸ªæ ¸å¿ƒéœ€æ±‚å•Šã€‚Javaåœ¨1.8ç‰ˆæœ¬æä¾›äº†CompletableFutureæ¥æ”¯æŒå¼‚æ­¥ç¼–ç¨‹ï¼ŒCompletableFutureæœ‰å¯èƒ½æ˜¯ä½ è§è¿‡çš„æœ€å¤æ‚çš„å·¥å…·ç±»äº†ï¼Œä¸è¿‡åŠŸèƒ½ä¹Ÿç€å®è®©äººæ„Ÿåˆ°éœ‡æ’¼ã€‚</p><h2>CompletableFutureçš„æ ¸å¿ƒä¼˜åŠ¿</h2><p>ä¸ºäº†é¢†ç•¥CompletableFutureå¼‚æ­¥ç¼–ç¨‹çš„ä¼˜åŠ¿ï¼Œè¿™é‡Œæˆ‘ä»¬ç”¨CompletableFutureé‡æ–°å®ç°å‰é¢æ›¾æåŠçš„çƒ§æ°´æ³¡èŒ¶ç¨‹åºã€‚é¦–å…ˆè¿˜æ˜¯éœ€è¦å…ˆå®Œæˆåˆ†å·¥æ–¹æ¡ˆï¼Œåœ¨ä¸‹é¢çš„ç¨‹åºä¸­ï¼Œæˆ‘ä»¬åˆ†äº†3ä¸ªä»»åŠ¡ï¼šä»»åŠ¡1è´Ÿè´£æ´—æ°´å£¶ã€çƒ§å¼€æ°´ï¼Œä»»åŠ¡2è´Ÿè´£æ´—èŒ¶å£¶ã€æ´—èŒ¶æ¯å’Œæ‹¿èŒ¶å¶ï¼Œä»»åŠ¡3è´Ÿè´£æ³¡èŒ¶ã€‚å…¶ä¸­ä»»åŠ¡3è¦ç­‰å¾…ä»»åŠ¡1å’Œä»»åŠ¡2éƒ½å®Œæˆåæ‰èƒ½å¼€å§‹ã€‚è¿™ä¸ªåˆ†å·¥å¦‚ä¸‹å›¾æ‰€ç¤ºã€‚</p><!-- [[[read_end]]] --><p><img src=\"https://static001.geekbang.org/resource/image/b3/78/b33f823a4124c1220d8bd6d91b877e78.png?wh=1142*623\" alt=\"\"></p><center><span class=\"reference\">çƒ§æ°´æ³¡èŒ¶åˆ†å·¥æ–¹æ¡ˆ</span></center><p>ä¸‹é¢æ˜¯ä»£ç å®ç°ï¼Œä½ å…ˆç•¥è¿‡runAsync()ã€supplyAsync()ã€thenCombine()è¿™äº›ä¸å¤ªç†Ÿæ‚‰çš„æ–¹æ³•ï¼Œä»å¤§å±€ä¸Šçœ‹ï¼Œä½ ä¼šå‘ç°ï¼š</p><ol>\n<li>æ— éœ€æ‰‹å·¥ç»´æŠ¤çº¿ç¨‹ï¼Œæ²¡æœ‰ç¹ççš„æ‰‹å·¥ç»´æŠ¤çº¿ç¨‹çš„å·¥ä½œï¼Œç»™ä»»åŠ¡åˆ†é…çº¿ç¨‹çš„å·¥ä½œä¹Ÿä¸éœ€è¦æˆ‘ä»¬å…³æ³¨ï¼›</li>\n<li>è¯­ä¹‰æ›´æ¸…æ™°ï¼Œä¾‹å¦‚ <code>f3 = f1.thenCombine(f2, ()-&gt;{})</code> èƒ½å¤Ÿæ¸…æ™°åœ°è¡¨è¿°â€œä»»åŠ¡3è¦ç­‰å¾…ä»»åŠ¡1å’Œä»»åŠ¡2éƒ½å®Œæˆåæ‰èƒ½å¼€å§‹â€ï¼›</li>\n<li>ä»£ç æ›´ç®€ç»ƒå¹¶ä¸”ä¸“æ³¨äºä¸šåŠ¡é€»è¾‘ï¼Œå‡ ä¹æ‰€æœ‰ä»£ç éƒ½æ˜¯ä¸šåŠ¡é€»è¾‘ç›¸å…³çš„ã€‚</li>\n</ol><pre><code>//ä»»åŠ¡1ï¼šæ´—æ°´å£¶-&gt;çƒ§å¼€æ°´\nCompletableFuture&lt;Void&gt; f1 = \n  CompletableFuture.runAsync(()-&gt;{\n  System.out.println(&quot;T1:æ´—æ°´å£¶...&quot;);\n  sleep(1, TimeUnit.SECONDS);\n\n  System.out.println(&quot;T1:çƒ§å¼€æ°´...&quot;);\n  sleep(15, TimeUnit.SECONDS);\n});\n//ä»»åŠ¡2ï¼šæ´—èŒ¶å£¶-&gt;æ´—èŒ¶æ¯-&gt;æ‹¿èŒ¶å¶\nCompletableFuture&lt;String&gt; f2 = \n  CompletableFuture.supplyAsync(()-&gt;{\n  System.out.println(&quot;T2:æ´—èŒ¶å£¶...&quot;);\n  sleep(1, TimeUnit.SECONDS);\n\n  System.out.println(&quot;T2:æ´—èŒ¶æ¯...&quot;);\n  sleep(2, TimeUnit.SECONDS);\n\n  System.out.println(&quot;T2:æ‹¿èŒ¶å¶...&quot;);\n  sleep(1, TimeUnit.SECONDS);\n  return &quot;é¾™äº•&quot;;\n});\n//ä»»åŠ¡3ï¼šä»»åŠ¡1å’Œä»»åŠ¡2å®Œæˆåæ‰§è¡Œï¼šæ³¡èŒ¶\nCompletableFuture&lt;String&gt; f3 = \n  f1.thenCombine(f2, (__, tf)-&gt;{\n    System.out.println(&quot;T1:æ‹¿åˆ°èŒ¶å¶:&quot; + tf);\n    System.out.println(&quot;T1:æ³¡èŒ¶...&quot;);\n    return &quot;ä¸ŠèŒ¶:&quot; + tf;\n  });\n//ç­‰å¾…ä»»åŠ¡3æ‰§è¡Œç»“æœ\nSystem.out.println(f3.join());\n\nvoid sleep(int t, TimeUnit u) {\n  try {\n    u.sleep(t);\n  }catch(InterruptedException e){}\n}\n// ä¸€æ¬¡æ‰§è¡Œç»“æœï¼š\nT1:æ´—æ°´å£¶...\nT2:æ´—èŒ¶å£¶...\nT1:çƒ§å¼€æ°´...\nT2:æ´—èŒ¶æ¯...\nT2:æ‹¿èŒ¶å¶...\nT1:æ‹¿åˆ°èŒ¶å¶:é¾™äº•\nT1:æ³¡èŒ¶...\nä¸ŠèŒ¶:é¾™äº•\n</code></pre><p>é¢†ç•¥CompletableFutureå¼‚æ­¥ç¼–ç¨‹çš„ä¼˜åŠ¿ä¹‹åï¼Œä¸‹é¢æˆ‘ä»¬è¯¦ç»†ä»‹ç»CompletableFutureçš„ä½¿ç”¨ï¼Œé¦–å…ˆæ˜¯å¦‚ä½•åˆ›å»ºCompletableFutureå¯¹è±¡ã€‚</p><h2>åˆ›å»ºCompletableFutureå¯¹è±¡</h2><p>åˆ›å»ºCompletableFutureå¯¹è±¡ä¸»è¦é ä¸‹é¢ä»£ç ä¸­å±•ç¤ºçš„è¿™4ä¸ªé™æ€æ–¹æ³•ï¼Œæˆ‘ä»¬å…ˆçœ‹å‰ä¸¤ä¸ªã€‚åœ¨çƒ§æ°´æ³¡èŒ¶çš„ä¾‹å­ä¸­ï¼Œæˆ‘ä»¬å·²ç»ä½¿ç”¨äº†<code>runAsync(Runnable runnable)</code>å’Œ<code>supplyAsync(Supplier&lt;U&gt; supplier)</code>ï¼Œå®ƒä»¬ä¹‹é—´çš„åŒºåˆ«æ˜¯ï¼šRunnable æ¥å£çš„run()æ–¹æ³•æ²¡æœ‰è¿”å›å€¼ï¼Œè€ŒSupplieræ¥å£çš„get()æ–¹æ³•æ˜¯æœ‰è¿”å›å€¼çš„ã€‚</p><p>å‰ä¸¤ä¸ªæ–¹æ³•å’Œåä¸¤ä¸ªæ–¹æ³•çš„åŒºåˆ«åœ¨äºï¼šåä¸¤ä¸ªæ–¹æ³•å¯ä»¥æŒ‡å®šçº¿ç¨‹æ± å‚æ•°ã€‚</p><p>é»˜è®¤æƒ…å†µä¸‹CompletableFutureä¼šä½¿ç”¨å…¬å…±çš„ForkJoinPoolçº¿ç¨‹æ± ï¼Œè¿™ä¸ªçº¿ç¨‹æ± é»˜è®¤åˆ›å»ºçš„çº¿ç¨‹æ•°æ˜¯CPUçš„æ ¸æ•°ï¼ˆä¹Ÿå¯ä»¥é€šè¿‡JVM option:-Djava.util.concurrent.ForkJoinPool.common.parallelismæ¥è®¾ç½®ForkJoinPoolçº¿ç¨‹æ± çš„çº¿ç¨‹æ•°ï¼‰ã€‚å¦‚æœæ‰€æœ‰CompletableFutureå…±äº«ä¸€ä¸ªçº¿ç¨‹æ± ï¼Œé‚£ä¹ˆä¸€æ—¦æœ‰ä»»åŠ¡æ‰§è¡Œä¸€äº›å¾ˆæ…¢çš„I/Oæ“ä½œï¼Œå°±ä¼šå¯¼è‡´çº¿ç¨‹æ± ä¸­æ‰€æœ‰çº¿ç¨‹éƒ½é˜»å¡åœ¨I/Oæ“ä½œä¸Šï¼Œä»è€Œé€ æˆçº¿ç¨‹é¥¥é¥¿ï¼Œè¿›è€Œå½±å“æ•´ä¸ªç³»ç»Ÿçš„æ€§èƒ½ã€‚æ‰€ä»¥ï¼Œå¼ºçƒˆå»ºè®®ä½ è¦<strong>æ ¹æ®ä¸åŒçš„ä¸šåŠ¡ç±»å‹åˆ›å»ºä¸åŒçš„çº¿ç¨‹æ± ï¼Œä»¥é¿å…äº’ç›¸å¹²æ‰°</strong>ã€‚</p><pre><code>//ä½¿ç”¨é»˜è®¤çº¿ç¨‹æ± \nstatic CompletableFuture&lt;Void&gt; \n  runAsync(Runnable runnable)\nstatic &lt;U&gt; CompletableFuture&lt;U&gt; \n  supplyAsync(Supplier&lt;U&gt; supplier)\n//å¯ä»¥æŒ‡å®šçº¿ç¨‹æ±   \nstatic CompletableFuture&lt;Void&gt; \n  runAsync(Runnable runnable, Executor executor)\nstatic &lt;U&gt; CompletableFuture&lt;U&gt; \n  supplyAsync(Supplier&lt;U&gt; supplier, Executor executor)  \n</code></pre><p>åˆ›å»ºå®ŒCompletableFutureå¯¹è±¡ä¹‹åï¼Œä¼šè‡ªåŠ¨åœ°å¼‚æ­¥æ‰§è¡Œrunnable.run()æ–¹æ³•æˆ–è€…supplier.get()æ–¹æ³•ï¼Œå¯¹äºä¸€ä¸ªå¼‚æ­¥æ“ä½œï¼Œä½ éœ€è¦å…³æ³¨ä¸¤ä¸ªé—®é¢˜ï¼šä¸€ä¸ªæ˜¯å¼‚æ­¥æ“ä½œä»€ä¹ˆæ—¶å€™ç»“æŸï¼Œå¦ä¸€ä¸ªæ˜¯å¦‚ä½•è·å–å¼‚æ­¥æ“ä½œçš„æ‰§è¡Œç»“æœã€‚å› ä¸ºCompletableFutureç±»å®ç°äº†Futureæ¥å£ï¼Œæ‰€ä»¥è¿™ä¸¤ä¸ªé—®é¢˜ä½ éƒ½å¯ä»¥é€šè¿‡Futureæ¥å£æ¥è§£å†³ã€‚å¦å¤–ï¼ŒCompletableFutureç±»è¿˜å®ç°äº†CompletionStageæ¥å£ï¼Œè¿™ä¸ªæ¥å£å†…å®¹å®åœ¨æ˜¯å¤ªä¸°å¯Œäº†ï¼Œåœ¨1.8ç‰ˆæœ¬é‡Œæœ‰40ä¸ªæ–¹æ³•ï¼Œè¿™äº›æ–¹æ³•æˆ‘ä»¬è¯¥å¦‚ä½•ç†è§£å‘¢ï¼Ÿ</p><h2>å¦‚ä½•ç†è§£CompletionStageæ¥å£</h2><p>æˆ‘è§‰å¾—ï¼Œä½ å¯ä»¥ç«™åœ¨åˆ†å·¥çš„è§’åº¦ç±»æ¯”ä¸€ä¸‹å·¥ä½œæµã€‚ä»»åŠ¡æ˜¯æœ‰æ—¶åºå…³ç³»çš„ï¼Œæ¯”å¦‚æœ‰<strong>ä¸²è¡Œå…³ç³»ã€å¹¶è¡Œå…³ç³»ã€æ±‡èšå…³ç³»</strong>ç­‰ã€‚è¿™æ ·è¯´å¯èƒ½æœ‰ç‚¹æŠ½è±¡ï¼Œè¿™é‡Œè¿˜ä¸¾å‰é¢çƒ§æ°´æ³¡èŒ¶çš„ä¾‹å­ï¼Œå…¶ä¸­æ´—æ°´å£¶å’Œçƒ§å¼€æ°´å°±æ˜¯ä¸²è¡Œå…³ç³»ï¼Œæ´—æ°´å£¶ã€çƒ§å¼€æ°´å’Œæ´—èŒ¶å£¶ã€æ´—èŒ¶æ¯è¿™ä¸¤ç»„ä»»åŠ¡ä¹‹é—´å°±æ˜¯å¹¶è¡Œå…³ç³»ï¼Œè€Œçƒ§å¼€æ°´ã€æ‹¿èŒ¶å¶å’Œæ³¡èŒ¶å°±æ˜¯æ±‡èšå…³ç³»ã€‚</p><p><img src=\"https://static001.geekbang.org/resource/image/e1/9f/e18181998b82718da811ce5807f0ad9f.png?wh=1142*153\" alt=\"\"></p><center><span class=\"reference\">ä¸²è¡Œå…³ç³»</span></center><p><img src=\"https://static001.geekbang.org/resource/image/ea/d2/ea8e1a41a02b0104b421c58b25343bd2.png?wh=1142*313\" alt=\"\"></p><center><span class=\"reference\">å¹¶è¡Œå…³ç³»</span></center><p><img src=\"https://static001.geekbang.org/resource/image/3f/3b/3f1a5421333dd6d5c278ffd5299dc33b.png?wh=1142*272\" alt=\"\"></p><center><span class=\"reference\">æ±‡èšå…³ç³»</span></center><p>CompletionStageæ¥å£å¯ä»¥æ¸…æ™°åœ°æè¿°ä»»åŠ¡ä¹‹é—´çš„è¿™ç§æ—¶åºå…³ç³»ï¼Œä¾‹å¦‚å‰é¢æåˆ°çš„ <code>f3 = f1.thenCombine(f2, ()-&gt;{})</code> æè¿°çš„å°±æ˜¯ä¸€ç§æ±‡èšå…³ç³»ã€‚çƒ§æ°´æ³¡èŒ¶ç¨‹åºä¸­çš„æ±‡èšå…³ç³»æ˜¯ä¸€ç§ AND èšåˆå…³ç³»ï¼Œè¿™é‡Œçš„ANDæŒ‡çš„æ˜¯æ‰€æœ‰ä¾èµ–çš„ä»»åŠ¡ï¼ˆçƒ§å¼€æ°´å’Œæ‹¿èŒ¶å¶ï¼‰éƒ½å®Œæˆåæ‰å¼€å§‹æ‰§è¡Œå½“å‰ä»»åŠ¡ï¼ˆæ³¡èŒ¶ï¼‰ã€‚æ—¢ç„¶æœ‰ANDèšåˆå…³ç³»ï¼Œé‚£å°±ä¸€å®šè¿˜æœ‰ORèšåˆå…³ç³»ï¼Œæ‰€è°“ORæŒ‡çš„æ˜¯ä¾èµ–çš„ä»»åŠ¡åªè¦æœ‰ä¸€ä¸ªå®Œæˆå°±å¯ä»¥æ‰§è¡Œå½“å‰ä»»åŠ¡ã€‚</p><p>åœ¨ç¼–ç¨‹é¢†åŸŸï¼Œè¿˜æœ‰ä¸€ä¸ªç»•ä¸è¿‡å»çš„å±±å¤´ï¼Œé‚£å°±æ˜¯å¼‚å¸¸å¤„ç†ï¼ŒCompletionStageæ¥å£ä¹Ÿå¯ä»¥æ–¹ä¾¿åœ°æè¿°å¼‚å¸¸å¤„ç†ã€‚</p><p>ä¸‹é¢æˆ‘ä»¬å°±æ¥ä¸€ä¸€ä»‹ç»ï¼ŒCompletionStageæ¥å£å¦‚ä½•æè¿°ä¸²è¡Œå…³ç³»ã€ANDèšåˆå…³ç³»ã€ORèšåˆå…³ç³»ä»¥åŠå¼‚å¸¸å¤„ç†ã€‚</p><h3>1. æè¿°ä¸²è¡Œå…³ç³»</h3><p>CompletionStageæ¥å£é‡Œé¢æè¿°ä¸²è¡Œå…³ç³»ï¼Œä¸»è¦æ˜¯thenApplyã€thenAcceptã€thenRunå’ŒthenComposeè¿™å››ä¸ªç³»åˆ—çš„æ¥å£ã€‚</p><p>thenApplyç³»åˆ—å‡½æ•°é‡Œå‚æ•°fnçš„ç±»å‹æ˜¯æ¥å£Function&lt;T, R&gt;ï¼Œè¿™ä¸ªæ¥å£é‡Œä¸CompletionStageç›¸å…³çš„æ–¹æ³•æ˜¯ <code>R apply(T t)</code>ï¼Œè¿™ä¸ªæ–¹æ³•æ—¢èƒ½æ¥æ”¶å‚æ•°ä¹Ÿæ”¯æŒè¿”å›å€¼ï¼Œæ‰€ä»¥thenApplyç³»åˆ—æ–¹æ³•è¿”å›çš„æ˜¯<code>CompletionStage&lt;R&gt;</code>ã€‚</p><p>è€ŒthenAcceptç³»åˆ—æ–¹æ³•é‡Œå‚æ•°consumerçš„ç±»å‹æ˜¯æ¥å£<code>Consumer&lt;T&gt;</code>ï¼Œè¿™ä¸ªæ¥å£é‡Œä¸CompletionStageç›¸å…³çš„æ–¹æ³•æ˜¯ <code>void accept(T t)</code>ï¼Œè¿™ä¸ªæ–¹æ³•è™½ç„¶æ”¯æŒå‚æ•°ï¼Œä½†å´ä¸æ”¯æŒå›å€¼ï¼Œæ‰€ä»¥thenAcceptç³»åˆ—æ–¹æ³•è¿”å›çš„æ˜¯<code>CompletionStage&lt;Void&gt;</code>ã€‚</p><p>thenRunç³»åˆ—æ–¹æ³•é‡Œactionçš„å‚æ•°æ˜¯Runnableï¼Œæ‰€ä»¥actionæ—¢ä¸èƒ½æ¥æ”¶å‚æ•°ä¹Ÿä¸æ”¯æŒè¿”å›å€¼ï¼Œæ‰€ä»¥thenRunç³»åˆ—æ–¹æ³•è¿”å›çš„ä¹Ÿæ˜¯<code>CompletionStage&lt;Void&gt;</code>ã€‚</p><p>è¿™äº›æ–¹æ³•é‡Œé¢Asyncä»£è¡¨çš„æ˜¯å¼‚æ­¥æ‰§è¡Œfnã€consumeræˆ–è€…actionã€‚å…¶ä¸­ï¼Œéœ€è¦ä½ æ³¨æ„çš„æ˜¯thenComposeç³»åˆ—æ–¹æ³•ï¼Œè¿™ä¸ªç³»åˆ—çš„æ–¹æ³•ä¼šæ–°åˆ›å»ºå‡ºä¸€ä¸ªå­æµç¨‹ï¼Œæœ€ç»ˆç»“æœå’ŒthenApplyç³»åˆ—æ˜¯ç›¸åŒçš„ã€‚</p><pre><code>CompletionStage&lt;R&gt; thenApply(fn);\nCompletionStage&lt;R&gt; thenApplyAsync(fn);\nCompletionStage&lt;Void&gt; thenAccept(consumer);\nCompletionStage&lt;Void&gt; thenAcceptAsync(consumer);\nCompletionStage&lt;Void&gt; thenRun(action);\nCompletionStage&lt;Void&gt; thenRunAsync(action);\nCompletionStage&lt;R&gt; thenCompose(fn);\nCompletionStage&lt;R&gt; thenComposeAsync(fn);\n</code></pre><p>é€šè¿‡ä¸‹é¢çš„ç¤ºä¾‹ä»£ç ï¼Œä½ å¯ä»¥çœ‹ä¸€ä¸‹thenApply()æ–¹æ³•æ˜¯å¦‚ä½•ä½¿ç”¨çš„ã€‚é¦–å…ˆé€šè¿‡supplyAsync()å¯åŠ¨ä¸€ä¸ªå¼‚æ­¥æµç¨‹ï¼Œä¹‹åæ˜¯ä¸¤ä¸ªä¸²è¡Œæ“ä½œï¼Œæ•´ä½“çœ‹èµ·æ¥è¿˜æ˜¯æŒºç®€å•çš„ã€‚ä¸è¿‡ï¼Œè™½ç„¶è¿™æ˜¯ä¸€ä¸ªå¼‚æ­¥æµç¨‹ï¼Œä½†ä»»åŠ¡â‘ â‘¡â‘¢å´æ˜¯ä¸²è¡Œæ‰§è¡Œçš„ï¼Œâ‘¡ä¾èµ–â‘ çš„æ‰§è¡Œç»“æœï¼Œâ‘¢ä¾èµ–â‘¡çš„æ‰§è¡Œç»“æœã€‚</p><pre><code>CompletableFuture&lt;String&gt; f0 = \n  CompletableFuture.supplyAsync(\n    () -&gt; &quot;Hello World&quot;)      //â‘ \n  .thenApply(s -&gt; s + &quot; QQ&quot;)  //â‘¡\n  .thenApply(String::toUpperCase);//â‘¢\n\nSystem.out.println(f0.join());\n//è¾“å‡ºç»“æœ\nHELLO WORLD QQ\n</code></pre><h3>2. æè¿°ANDæ±‡èšå…³ç³»</h3><p>CompletionStageæ¥å£é‡Œé¢æè¿°ANDæ±‡èšå…³ç³»ï¼Œä¸»è¦æ˜¯thenCombineã€thenAcceptBothå’ŒrunAfterBothç³»åˆ—çš„æ¥å£ï¼Œè¿™äº›æ¥å£çš„åŒºåˆ«ä¹Ÿæ˜¯æºè‡ªfnã€consumerã€actionè¿™ä¸‰ä¸ªæ ¸å¿ƒå‚æ•°ä¸åŒã€‚å®ƒä»¬çš„ä½¿ç”¨ä½ å¯ä»¥å‚è€ƒä¸Šé¢çƒ§æ°´æ³¡èŒ¶çš„å®ç°ç¨‹åºï¼Œè¿™é‡Œå°±ä¸èµ˜è¿°äº†ã€‚</p><pre><code>CompletionStage&lt;R&gt; thenCombine(other, fn);\nCompletionStage&lt;R&gt; thenCombineAsync(other, fn);\nCompletionStage&lt;Void&gt; thenAcceptBoth(other, consumer);\nCompletionStage&lt;Void&gt; thenAcceptBothAsync(other, consumer);\nCompletionStage&lt;Void&gt; runAfterBoth(other, action);\nCompletionStage&lt;Void&gt; runAfterBothAsync(other, action);\n</code></pre><h3>3. æè¿°ORæ±‡èšå…³ç³»</h3><p>CompletionStageæ¥å£é‡Œé¢æè¿°ORæ±‡èšå…³ç³»ï¼Œä¸»è¦æ˜¯applyToEitherã€acceptEitherå’ŒrunAfterEitherç³»åˆ—çš„æ¥å£ï¼Œè¿™äº›æ¥å£çš„åŒºåˆ«ä¹Ÿæ˜¯æºè‡ªfnã€consumerã€actionè¿™ä¸‰ä¸ªæ ¸å¿ƒå‚æ•°ä¸åŒã€‚</p><pre><code>CompletionStage applyToEither(other, fn);\nCompletionStage applyToEitherAsync(other, fn);\nCompletionStage acceptEither(other, consumer);\nCompletionStage acceptEitherAsync(other, consumer);\nCompletionStage runAfterEither(other, action);\nCompletionStage runAfterEitherAsync(other, action);\n</code></pre><p>ä¸‹é¢çš„ç¤ºä¾‹ä»£ç å±•ç¤ºäº†å¦‚ä½•ä½¿ç”¨applyToEither()æ–¹æ³•æ¥æè¿°ä¸€ä¸ªORæ±‡èšå…³ç³»ã€‚</p><pre><code>CompletableFuture&lt;String&gt; f1 = \n  CompletableFuture.supplyAsync(()-&gt;{\n    int t = getRandom(5, 10);\n    sleep(t, TimeUnit.SECONDS);\n    return String.valueOf(t);\n});\n\nCompletableFuture&lt;String&gt; f2 = \n  CompletableFuture.supplyAsync(()-&gt;{\n    int t = getRandom(5, 10);\n    sleep(t, TimeUnit.SECONDS);\n    return String.valueOf(t);\n});\n\nCompletableFuture&lt;String&gt; f3 = \n  f1.applyToEither(f2,s -&gt; s);\n\nSystem.out.println(f3.join());\n</code></pre><h3>4. å¼‚å¸¸å¤„ç†</h3><p>è™½ç„¶ä¸Šé¢æˆ‘ä»¬æåˆ°çš„fnã€consumerã€actionå®ƒä»¬çš„æ ¸å¿ƒæ–¹æ³•éƒ½<strong>ä¸å…è®¸æŠ›å‡ºå¯æ£€æŸ¥å¼‚å¸¸ï¼Œä½†æ˜¯å´æ— æ³•é™åˆ¶å®ƒä»¬æŠ›å‡ºè¿è¡Œæ—¶å¼‚å¸¸</strong>ï¼Œä¾‹å¦‚ä¸‹é¢çš„ä»£ç ï¼Œæ‰§è¡Œ <code>7/0</code> å°±ä¼šå‡ºç°é™¤é›¶é”™è¯¯è¿™ä¸ªè¿è¡Œæ—¶å¼‚å¸¸ã€‚éå¼‚æ­¥ç¼–ç¨‹é‡Œé¢ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨try{}catch{}æ¥æ•è·å¹¶å¤„ç†å¼‚å¸¸ï¼Œé‚£åœ¨å¼‚æ­¥ç¼–ç¨‹é‡Œé¢ï¼Œå¼‚å¸¸è¯¥å¦‚ä½•å¤„ç†å‘¢ï¼Ÿ</p><pre><code>CompletableFuture&lt;Integer&gt; \n  f0 = CompletableFuture.\n    .supplyAsync(()-&gt;(7/0))\n    .thenApply(r-&gt;r*10);\nSystem.out.println(f0.join());\n</code></pre><p>CompletionStageæ¥å£ç»™æˆ‘ä»¬æä¾›çš„æ–¹æ¡ˆéå¸¸ç®€å•ï¼Œæ¯”try{}catch{}è¿˜è¦ç®€å•ï¼Œä¸‹é¢æ˜¯ç›¸å…³çš„æ–¹æ³•ï¼Œä½¿ç”¨è¿™äº›æ–¹æ³•è¿›è¡Œå¼‚å¸¸å¤„ç†å’Œä¸²è¡Œæ“ä½œæ˜¯ä¸€æ ·çš„ï¼Œéƒ½æ”¯æŒé“¾å¼ç¼–ç¨‹æ–¹å¼ã€‚</p><pre><code>CompletionStage exceptionally(fn);\nCompletionStage&lt;R&gt; whenComplete(consumer);\nCompletionStage&lt;R&gt; whenCompleteAsync(consumer);\nCompletionStage&lt;R&gt; handle(fn);\nCompletionStage&lt;R&gt; handleAsync(fn);\n</code></pre><p>ä¸‹é¢çš„ç¤ºä¾‹ä»£ç å±•ç¤ºäº†å¦‚ä½•ä½¿ç”¨exceptionally()æ–¹æ³•æ¥å¤„ç†å¼‚å¸¸ï¼Œexceptionally()çš„ä½¿ç”¨éå¸¸ç±»ä¼¼äºtry{}catch{}ä¸­çš„catch{}ï¼Œä½†æ˜¯ç”±äºæ”¯æŒé“¾å¼ç¼–ç¨‹æ–¹å¼ï¼Œæ‰€ä»¥ç›¸å¯¹æ›´ç®€å•ã€‚æ—¢ç„¶æœ‰try{}catch{}ï¼Œé‚£å°±ä¸€å®šè¿˜æœ‰try{}finally{}ï¼ŒwhenComplete()å’Œhandle()ç³»åˆ—æ–¹æ³•å°±ç±»ä¼¼äºtry{}finally{}ä¸­çš„finally{}ï¼Œæ— è®ºæ˜¯å¦å‘ç”Ÿå¼‚å¸¸éƒ½ä¼šæ‰§è¡ŒwhenComplete()ä¸­çš„å›è°ƒå‡½æ•°consumerå’Œhandle()ä¸­çš„å›è°ƒå‡½æ•°fnã€‚whenComplete()å’Œhandle()çš„åŒºåˆ«åœ¨äºwhenComplete()ä¸æ”¯æŒè¿”å›ç»“æœï¼Œè€Œhandle()æ˜¯æ”¯æŒè¿”å›ç»“æœçš„ã€‚</p><pre><code>CompletableFuture&lt;Integer&gt; \n  f0 = CompletableFuture\n    .supplyAsync(()-&gt;(7/0))\n    .thenApply(r-&gt;r*10)\n    .exceptionally(e-&gt;0);\nSystem.out.println(f0.join());\n</code></pre><h2>æ€»ç»“</h2><p>æ›¾ç»ä¸€æåˆ°å¼‚æ­¥ç¼–ç¨‹ï¼Œå¤§å®¶è„‘æµ·é‡Œéƒ½ä¼šéšä¹‹æµ®ç°å›è°ƒå‡½æ•°ï¼Œä¾‹å¦‚åœ¨JavaScripté‡Œé¢å¼‚æ­¥é—®é¢˜åŸºæœ¬ä¸Šéƒ½æ˜¯é å›è°ƒå‡½æ•°æ¥è§£å†³çš„ï¼Œå›è°ƒå‡½æ•°åœ¨å¤„ç†å¼‚å¸¸ä»¥åŠå¤æ‚çš„å¼‚æ­¥ä»»åŠ¡å…³ç³»æ—¶å¾€å¾€åŠ›ä¸ä»å¿ƒï¼Œå¯¹æ­¤ä¸šç•Œè¿˜å‘æ˜äº†ä¸ªåè¯ï¼š<strong>å›è°ƒåœ°ç‹±</strong>ï¼ˆCallback Hellï¼‰ã€‚åº”è¯¥è¯´åœ¨å‰äº›å¹´ï¼Œå¼‚æ­¥ç¼–ç¨‹è¿˜æ˜¯å£°åç‹¼è—‰çš„ã€‚</p><p>ä¸è¿‡æœ€è¿‘å‡ å¹´ï¼Œä¼´éšç€<a href=\"http://reactivex.io/intro.html\">ReactiveX</a>çš„å‘å±•ï¼ˆJavaè¯­è¨€çš„å®ç°ç‰ˆæœ¬æ˜¯RxJavaï¼‰ï¼Œå›è°ƒåœ°ç‹±å·²ç»è¢«å®Œç¾è§£å†³äº†ï¼Œå¼‚æ­¥ç¼–ç¨‹å·²ç»æ…¢æ…¢å¼€å§‹æˆç†Ÿï¼ŒJavaè¯­è¨€ä¹Ÿå¼€å§‹å®˜æ–¹æ”¯æŒå¼‚æ­¥ç¼–ç¨‹ï¼šåœ¨1.8ç‰ˆæœ¬æä¾›äº†CompletableFutureï¼Œåœ¨Java 9ç‰ˆæœ¬åˆ™æä¾›äº†æ›´åŠ å®Œå¤‡çš„Flow APIï¼Œå¼‚æ­¥ç¼–ç¨‹ç›®å‰å·²ç»å®Œå…¨å·¥ä¸šåŒ–ã€‚å› æ­¤ï¼Œå­¦å¥½å¼‚æ­¥ç¼–ç¨‹è¿˜æ˜¯å¾ˆæœ‰å¿…è¦çš„ã€‚</p><p>CompletableFutureå·²ç»èƒ½å¤Ÿæ»¡è¶³ç®€å•çš„å¼‚æ­¥ç¼–ç¨‹éœ€æ±‚ï¼Œå¦‚æœä½ å¯¹å¼‚æ­¥ç¼–ç¨‹æ„Ÿå…´è¶£ï¼Œå¯ä»¥é‡ç‚¹å…³æ³¨RxJavaè¿™ä¸ªé¡¹ç›®ï¼Œåˆ©ç”¨RxJavaï¼Œå³ä¾¿åœ¨Java 1.6ç‰ˆæœ¬ä¹Ÿèƒ½äº«å—å¼‚æ­¥ç¼–ç¨‹çš„ä¹è¶£ã€‚</p><h2>è¯¾åæ€è€ƒ</h2><p>åˆ›å»ºé‡‡è´­è®¢å•çš„æ—¶å€™ï¼Œéœ€è¦æ ¡éªŒä¸€äº›è§„åˆ™ï¼Œä¾‹å¦‚æœ€å¤§é‡‘é¢æ˜¯å’Œé‡‡è´­å‘˜çº§åˆ«ç›¸å…³çš„ã€‚æœ‰åŒå­¦åˆ©ç”¨CompletableFutureå®ç°äº†è¿™ä¸ªæ ¡éªŒçš„åŠŸèƒ½ï¼Œé€»è¾‘å¾ˆç®€å•ï¼Œé¦–å…ˆæ˜¯ä»æ•°æ®åº“ä¸­æŠŠç›¸å…³è§„åˆ™æŸ¥å‡ºæ¥ï¼Œç„¶åæ‰§è¡Œè§„åˆ™æ ¡éªŒã€‚ä½ è§‰å¾—ä»–çš„å®ç°æ˜¯å¦æœ‰é—®é¢˜å‘¢ï¼Ÿ</p><pre><code>//é‡‡è´­è®¢å•\nPurchersOrder po;\nCompletableFuture&lt;Boolean&gt; cf = \n  CompletableFuture.supplyAsync(()-&gt;{\n    //åœ¨æ•°æ®åº“ä¸­æŸ¥è¯¢è§„åˆ™\n    return findRuleByJdbc();\n  }).thenApply(r -&gt; {\n    //è§„åˆ™æ ¡éªŒ\n    return check(po, r);\n});\nBoolean isOk = cf.join();\n</code></pre><p>æ¬¢è¿åœ¨ç•™è¨€åŒºä¸æˆ‘åˆ†äº«ä½ çš„æƒ³æ³•ï¼Œä¹Ÿæ¬¢è¿ä½ åœ¨ç•™è¨€åŒºè®°å½•ä½ çš„æ€è€ƒè¿‡ç¨‹ã€‚æ„Ÿè°¢é˜…è¯»ï¼Œå¦‚æœä½ è§‰å¾—è¿™ç¯‡æ–‡ç« å¯¹ä½ æœ‰å¸®åŠ©çš„è¯ï¼Œä¹Ÿæ¬¢è¿æŠŠå®ƒåˆ†äº«ç»™æ›´å¤šçš„æœ‹å‹ã€‚</p>","neighbors":{"left":{"article_title":"23 | Futureï¼šå¦‚ä½•ç”¨å¤šçº¿ç¨‹å®ç°æœ€ä¼˜çš„â€œçƒ§æ°´æ³¡èŒ¶â€ç¨‹åºï¼Ÿ","id":91292},"right":{"article_title":"25 | CompletionServiceï¼šå¦‚ä½•æ‰¹é‡æ‰§è¡Œå¼‚æ­¥ä»»åŠ¡ï¼Ÿ","id":92245}},"comments":[{"had_liked":false,"id":88816,"user_name":"J.M.Liu","can_delete":false,"product_type":"c1","uid":1200037,"ip_address":"","ucode":"B2CB84B8E923A6","user_header":"https://static001.geekbang.org/account/avatar/00/12/4f/a5/71358d7b.jpg","comment_is_top":false,"comment_ctime":1556007566,"is_pvip":false,"replies":[{"id":"31821","content":"æ€è€ƒé¢˜è€ƒè™‘çš„å¾ˆå…¨é¢ğŸ‘<br>","user_name":"ä½œè€…å›å¤","user_name_real":"ç‹å®ä»¤","uid":"1269969","ctime":1556028627,"ip_address":"","comment_id":88816,"utype":1}],"discussion_count":1,"race_medal":0,"score":"555606788750","product_id":100023901,"comment_content":"æ€è€ƒé¢˜ï¼š<br>1.æ²¡æœ‰è¿›è¡Œå¼‚å¸¸å¤„ç†ï¼Œ<br>2.è¦æŒ‡å®šä¸“é—¨çš„çº¿ç¨‹æ± åšæ•°æ®åº“æŸ¥è¯¢<br>3.å¦‚æœæ£€æŸ¥å’ŒæŸ¥è¯¢éƒ½æ¯”è¾ƒè€—æ—¶ï¼Œé‚£ä¹ˆåº”è¯¥åƒä¹‹å‰çš„å¯¹è´¦ç³»ç»Ÿä¸€æ ·ï¼Œé‡‡ç”¨ç”Ÿäº§è€…å’Œæ¶ˆè´¹è€…æ¨¡å¼ï¼Œè®©ä¸Šä¸€æ¬¡çš„æ£€æŸ¥å’Œä¸‹ä¸€æ¬¡çš„æŸ¥è¯¢å¹¶è¡Œèµ·æ¥ã€‚<br><br>å¦å¤–ï¼Œè€å¸ˆæŠŠjavadocé‡Œé‚£ä¸€å †é‚£ä¸€å †æ–¹æ³•è¿›è¡Œäº†åˆ†ç±»ï¼Œåˆ†æˆä¸²è¡Œã€å¹¶è¡Œã€ANDèšåˆã€ORèšåˆï¼Œç®€ç›´å¤ªæ£’äº†ï¼Œä¸€ä¸‹å­å°±æŠŠè¿™äº›æ–¹æ³•çº³å…¥åˆ°ä¸€ä¸ªå®Œæ•´çš„ç»“æ„ä½“ç³»é‡Œäº†ã€‚ç®€ç›´æ£’","like_count":130,"discussions":[{"author":{"id":1269969,"avatar":"https://static001.geekbang.org/account/avatar/00/13/60/d1/8efa89ab.jpg","nickname":"ç‹å®ä»¤","note":"","ucode":"4FE19F5BC32FCA","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":447910,"discussion_content":"æ€è€ƒé¢˜è€ƒè™‘çš„å¾ˆå…¨é¢ğŸ‘\n","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1556028627,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":88761,"user_name":"è¢é˜³","can_delete":false,"product_type":"c1","uid":1329594,"ip_address":"","ucode":"B397F760CDC53A","user_header":"https://static001.geekbang.org/account/avatar/00/14/49/ba/02742d56.jpg","comment_is_top":false,"comment_ctime":1555994471,"is_pvip":false,"replies":[{"id":"31822","content":"ğŸ‘ğŸ‘<br>","user_name":"ä½œè€…å›å¤","user_name_real":"ç‹å®ä»¤","uid":"1269969","ctime":1556028704,"ip_address":"","comment_id":88761,"utype":1}],"discussion_count":7,"race_medal":0,"score":"474002397031","product_id":100023901,"comment_content":"æ€è€ƒé¢˜:<br>1ï¼Œè¯»æ•°æ®åº“å±äºioæ“ä½œï¼Œåº”è¯¥æ”¾åœ¨å•ç‹¬çº¿ç¨‹æ± ï¼Œé¿å…çº¿ç¨‹é¥¥é¥¿<br>2ï¼Œå¼‚å¸¸æœªå¤„ç†","like_count":111,"discussions":[{"author":{"id":1269969,"avatar":"https://static001.geekbang.org/account/avatar/00/13/60/d1/8efa89ab.jpg","nickname":"ç‹å®ä»¤","note":"","ucode":"4FE19F5BC32FCA","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":447891,"discussion_content":"ğŸ‘ğŸ‘\n","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1556028704,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1181650,"avatar":"https://static001.geekbang.org/account/avatar/00/12/07/d2/0d7ee298.jpg","nickname":"æƒ˜ é—»","note":"","ucode":"C5909F034BF072","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":296814,"discussion_content":"ä¸ºä»€ä¹ˆioæ“ä½œè¦ç”¨çº¿ç¨‹æ± å•Šï¼Ÿæ™®é€šå¤šçº¿ç¨‹ä¸å¯ä»¥å—","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1596673295,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":5,"child_discussions":[{"author":{"id":1306315,"avatar":"https://static001.geekbang.org/account/avatar/00/13/ee/cb/4bd24e0f.jpg","nickname":"å®˜äºº","note":"","ucode":"ECEF55B08E252B","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":1181650,"avatar":"https://static001.geekbang.org/account/avatar/00/12/07/d2/0d7ee298.jpg","nickname":"æƒ˜ é—»","note":"","ucode":"C5909F034BF072","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":384381,"discussion_content":"å› ä¸ºä¸æŒ‡å®šçº¿ç¨‹æ±  ä¼šä½¿ç”¨forkjoinçº¿ç¨‹ ioæ“ä½œå¯èƒ½ä¼šé•¿æ—¶é˜»å¡ ","likes_number":1,"is_delete":false,"is_hidden":false,"ctime":1626531845,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":296814,"ip_address":""},"score":384381,"extra":""},{"author":{"id":1134574,"avatar":"https://static001.geekbang.org/account/avatar/00/11/4f/ee/bd08cfab.jpg","nickname":"ä¸€é­„","note":"","ucode":"71541125D4AA5A","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":1306315,"avatar":"https://static001.geekbang.org/account/avatar/00/13/ee/cb/4bd24e0f.jpg","nickname":"å®˜äºº","note":"","ucode":"ECEF55B08E252B","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":391569,"discussion_content":"ç­”éæ‰€é—®","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1630515921,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":384381,"ip_address":""},"score":391569,"extra":""},{"author":{"id":2029015,"avatar":"","nickname":"å°é’¢ç‚®","note":"","ucode":"676C4CCF3CCD0D","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":1134574,"avatar":"https://static001.geekbang.org/account/avatar/00/11/4f/ee/bd08cfab.jpg","nickname":"ä¸€é­„","note":"","ucode":"71541125D4AA5A","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":405420,"discussion_content":"æˆ‘è§‰å¾—äººå®¶è¯´çš„å¾ˆå¥½å•Šã€‚CompletableFutureé»˜è®¤ä¼šä½¿ç”¨å…¬å…±çš„ForkJoinPoolï¼Œç”±äºIOæ“ä½œå¯èƒ½ä¼šé•¿æ—¶é—´é˜»å¡ï¼Œå¦‚æœå…¶ä»–ä¸šåŠ¡ä¹Ÿä½¿ç”¨å…¬å…±çš„ForkJoinPoolï¼Œä¸å°±æœ‰å¯èƒ½çº¿ç¨‹éƒ½åœ¨å¿™ç€IOä¹ˆã€‚å»ºè®®ä¸è¦ä½¿ç”¨å…¬å…±çš„ï¼Œè¦æŒ‡å®šçº¿ç¨‹æ± ï¼šstatic CompletableFuture supplyAsync(Supplier supplier, Executor executor)","likes_number":5,"is_delete":false,"is_hidden":false,"ctime":1634564634,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":391569,"ip_address":""},"score":405420,"extra":""}]}]},{"had_liked":false,"id":88642,"user_name":"å¯†ç 123456","can_delete":false,"product_type":"c1","uid":1126593,"ip_address":"","ucode":"9889463CC0EA71","user_header":"https://static001.geekbang.org/account/avatar/00/11/30/c1/2dde6700.jpg","comment_is_top":false,"comment_ctime":1555978491,"is_pvip":false,"replies":[{"id":"31817","content":"è¿™ä¸ªç®€å•åœºæ™¯æ²¡å¿…è¦ç”¨","user_name":"ä½œè€…å›å¤","user_name_real":"ç‹å®ä»¤","uid":"1269969","ctime":1556028348,"ip_address":"","comment_id":88642,"utype":1}],"discussion_count":5,"race_medal":0,"score":"186239572219","product_id":100023901,"comment_content":"æˆ‘åœ¨æƒ³ä¸€ä¸ªé—®é¢˜ï¼Œæ˜æ˜æ˜¯ä¸²è¡Œè¿‡ç¨‹ï¼Œç›´æ¥å†™å°±å¯ä»¥äº†ã€‚ä¸ºä»€ä¹ˆè¿˜è¦ç”¨å¼‚æ­¥å»å®ç°ä¸²è¡Œï¼Ÿ","like_count":44,"discussions":[{"author":{"id":1269969,"avatar":"https://static001.geekbang.org/account/avatar/00/13/60/d1/8efa89ab.jpg","nickname":"ç‹å®ä»¤","note":"","ucode":"4FE19F5BC32FCA","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":447853,"discussion_content":"è¿™ä¸ªç®€å•åœºæ™¯æ²¡å¿…è¦ç”¨","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1556028348,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1493907,"avatar":"https://static001.geekbang.org/account/avatar/00/16/cb/93/4adea49a.jpg","nickname":"åŠªåŠ›åŠªåŠ›å†åŠªåŠ›","note":"","ucode":"0C6EEA28FCE8C7","race_medal":0,"user_type":1,"is_pvip":true},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":572977,"discussion_content":"å¼‚æ­¥ä¸²è¡Œçš„çœŸæ­£åœºæ™¯ï¼Œæˆ‘è®¤ä¸ºæ˜¯æ‰§è¡Œåˆ†æ”¯é€»è¾‘æ—¶ï¼Œéœ€è¦å¹¶è¡Œï¼Œæ¯ä¸ªå¹¶è¡Œå†…åˆæ˜¯ä¸²è¡Œ","likes_number":2,"is_delete":false,"is_hidden":false,"ctime":1653111874,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1937062,"avatar":"https://static001.geekbang.org/account/avatar/00/1d/8e/a6/c3286b61.jpg","nickname":"Javaå’å¢™å·¥ç¨‹å¸ˆ","note":"","ucode":"E76AE44A9C76AE","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":299253,"discussion_content":"åŒæ„Ÿ","likes_number":2,"is_delete":false,"is_hidden":false,"ctime":1597629606,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1186089,"avatar":"https://static001.geekbang.org/account/avatar/00/12/19/29/4a8214b7.jpg","nickname":"Bug Killer","note":"","ucode":"2741A206F504E1","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":392184,"discussion_content":"åŒæ„Ÿï¼Œè§‰å¾—æ²¡å¿…è¦","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1630893088,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1066928,"avatar":"https://static001.geekbang.org/account/avatar/00/10/47/b0/a9b77a1e.jpg","nickname":"å†¬é£å‘å·¦å¹","note":"","ucode":"376C45C5134F93","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":218816,"discussion_content":"å“ˆå“ˆå“ˆå“ˆ","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1585703578,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":89223,"user_name":"å‘æ¡æ©™å­ ã€‚","can_delete":false,"product_type":"c1","uid":1259218,"ip_address":"","ucode":"ED076F4534FFED","user_header":"https://static001.geekbang.org/account/avatar/00/13/36/d2/c7357723.jpg","comment_is_top":false,"comment_ctime":1556111306,"is_pvip":false,"replies":[{"id":"31968","content":"æˆ‘è§‰å¾—å¯ä»¥ä¼˜å…ˆä½¿ç”¨CompletableFutureï¼Œå½“ç„¶å‰ææ˜¯ä½ çš„jdkæ˜¯1.8","user_name":"ä½œè€…å›å¤","user_name_real":"ç‹å®ä»¤","uid":"1269969","ctime":1556117606,"ip_address":"","comment_id":89223,"utype":1}],"discussion_count":2,"race_medal":0,"score":"181944737738","product_id":100023901,"comment_content":"è€å¸ˆ ï¼Œæˆ‘æœ‰ä¸ªç–‘é—®ã€‚ completableFuture ä¸­å„ç§å…³ç³»ï¼ˆå¹¶è¡Œã€ä¸²è¡Œã€èšåˆï¼‰ï¼Œå®é™…ä¸Šå°±è¦†ç›–äº†å„ç§éœ€æ±‚åœºæ™¯ã€‚ ä¾‹å¦‚ ï¼š çº¿ç¨‹A ç­‰å¾… çº¿ç¨‹B æˆ–è€… çº¿ç¨‹C ç­‰å¾… çº¿ç¨‹Aå’ŒB ã€‚<br><br>æˆ‘ä»¬ä¹‹å‰è®²çš„å¹¶å‘åŒ…é‡Œé¢ countdownLatch , æˆ–è€… threadPoolExecutor å’Œfuture  å°±æ˜¯æ¥è§£å†³è¿™äº›å…³ç³»åœºæ™¯çš„ ï¼Œ é‚£æœ‰äº† completableFuture è¿™ä¸ªç±» ï¼Œæ˜¯ä¸æ˜¯ä»¥åæœ‰éœ€æ±‚éƒ½ä¼˜å…ˆè€ƒè™‘ç”¨ completableFuture ï¼Ÿæ„Ÿè§‰è¿™ä¸ªç±»å°±å¯ä»¥è§£å†³å‰é¢æ‰€è®²çš„ç±»çš„é—®é¢˜äº†","like_count":43,"discussions":[{"author":{"id":1269969,"avatar":"https://static001.geekbang.org/account/avatar/00/13/60/d1/8efa89ab.jpg","nickname":"ç‹å®ä»¤","note":"","ucode":"4FE19F5BC32FCA","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":448062,"discussion_content":"æˆ‘è§‰å¾—å¯ä»¥ä¼˜å…ˆä½¿ç”¨CompletableFutureï¼Œå½“ç„¶å‰ææ˜¯ä½ çš„jdkæ˜¯1.8","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1556117606,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":2649276,"avatar":"https://static001.geekbang.org/account/avatar/00/28/6c/bc/f751786b.jpg","nickname":"Leo","note":"","ucode":"CEBAD9CDCFC2A3","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":580355,"discussion_content":"countdownLatchæ˜¯JUCä¸‹é’ˆå¯¹å¹¶å‘ä¸‹çš„æƒ…å†µä½¿ç”¨çš„æŸç§å·¥å…·ï¼Œè·ŸCompletableFutureç”¨å¤„å…¶å®ä¸ä¸€è‡´ï¼›threadPoolExecutor åº•å±‚å…¶å®ä¹Ÿå°±æ˜¯å¤šçº¿ç¨‹å’ŒCompletableFutureç”¨å¤„å¾ˆåƒï¼›","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1658126022,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":88927,"user_name":"é’è²","can_delete":false,"product_type":"c1","uid":1181787,"ip_address":"","ucode":"6BA5D5D47DE38E","user_header":"https://static001.geekbang.org/account/avatar/00/12/08/5b/2a342424.jpg","comment_is_top":false,"comment_ctime":1556028220,"is_pvip":true,"replies":[{"id":"31838","content":"ğŸ‘ğŸ‘<br>","user_name":"ä½œè€…å›å¤","user_name_real":"ç‹å®ä»¤","uid":"1269969","ctime":1556031150,"ip_address":"","comment_id":88927,"utype":1}],"discussion_count":1,"race_medal":0,"score":"96045308732","product_id":100023901,"comment_content":"1.æŸ¥æ•°æ®åº“å±äºioæ“ä½œï¼Œç”¨å®šåˆ¶çº¿ç¨‹æ± <br>2.æŸ¥å‡ºæ¥çš„ç»“æœåšä¸ºä¸‹ä¸€æ­¥å¤„ç†çš„æ¡ä»¶ï¼Œè‹¥ç»“æœä¸ºç©ºå‘¢ï¼Œæ²¡æœ‰å¯¹åº”å¤„ç†<br>3.ç¼ºå°‘å¼‚å¸¸å¤„ç†æœºåˆ¶","like_count":22,"discussions":[{"author":{"id":1269969,"avatar":"https://static001.geekbang.org/account/avatar/00/13/60/d1/8efa89ab.jpg","nickname":"ç‹å®ä»¤","note":"","ucode":"4FE19F5BC32FCA","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":447949,"discussion_content":"ğŸ‘ğŸ‘\n","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1556031150,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":90371,"user_name":"ç¬ƒè¡Œä¹‹","can_delete":false,"product_type":"c1","uid":1140311,"ip_address":"","ucode":"F76B5C6D17765E","user_header":"https://static001.geekbang.org/account/avatar/00/11/66/57/e3bd54bd.jpg","comment_is_top":false,"comment_ctime":1556501880,"is_pvip":false,"replies":[{"id":"32401","content":"æœ‰å…³ç³»ï¼Œå¦‚æœç³»ç»Ÿå°±ä¸€ä¸ªçº¿ç¨‹æ± ï¼Œé‡Œé¢çš„çº¿ç¨‹éƒ½é˜»å¡åœ¨ioä¸Šï¼Œé‚£ä¹ˆç³»ç»Ÿå…¶ä»–çš„ä»»åŠ¡éƒ½éœ€è¦ç­‰å¾…ã€‚å¦‚æœå…¶ä»–ä»»åŠ¡æœ‰è‡ªå·±çš„çº¿ç¨‹æ± ï¼Œå°±æ²¡æœ‰é—®é¢˜ã€‚","user_name":"ä½œè€…å›å¤","user_name_real":"ç‹å®ä»¤","uid":"1269969","ctime":1556519490,"ip_address":"","comment_id":90371,"utype":1}],"discussion_count":2,"race_medal":0,"score":"70275978616","product_id":100023901,"comment_content":"â€å¦‚æœæ‰€æœ‰ CompletableFuture å…±äº«ä¸€ä¸ªçº¿ç¨‹æ± ï¼Œé‚£ä¹ˆä¸€æ—¦æœ‰ä»»åŠ¡æ‰§è¡Œä¸€äº›å¾ˆæ…¢çš„ I&#47;O æ“ä½œï¼Œå°±ä¼šå¯¼è‡´çº¿ç¨‹æ± ä¸­æ‰€æœ‰çº¿ç¨‹éƒ½é˜»å¡åœ¨ I&#47;O æ“ä½œä¸Šï¼Œä»è€Œé€ æˆçº¿ç¨‹é¥¥é¥¿ï¼Œè¿›è€Œå½±å“æ•´ä¸ªç³»ç»Ÿçš„æ€§èƒ½ã€‚â€è€å¸ˆï¼Œé˜»å¡åœ¨ioä¸Šå’Œæ˜¯ä¸æ˜¯åœ¨ä¸€ä¸ªçº¿ç¨‹æ± æ²¡å…³ç³»å§ï¼Ÿ","like_count":16,"discussions":[{"author":{"id":1269969,"avatar":"https://static001.geekbang.org/account/avatar/00/13/60/d1/8efa89ab.jpg","nickname":"ç‹å®ä»¤","note":"","ucode":"4FE19F5BC32FCA","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":448497,"discussion_content":"æœ‰å…³ç³»ï¼Œå¦‚æœç³»ç»Ÿå°±ä¸€ä¸ªçº¿ç¨‹æ± ï¼Œé‡Œé¢çš„çº¿ç¨‹éƒ½é˜»å¡åœ¨ioä¸Šï¼Œé‚£ä¹ˆç³»ç»Ÿå…¶ä»–çš„ä»»åŠ¡éƒ½éœ€è¦ç­‰å¾…ã€‚å¦‚æœå…¶ä»–ä»»åŠ¡æœ‰è‡ªå·±çš„çº¿ç¨‹æ± ï¼Œå°±æ²¡æœ‰é—®é¢˜ã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1556519490,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1095857,"avatar":"http://thirdwx.qlogo.cn/mmopen/vi_32/bvj76PmeUvW8kokyu91IZWuRATKmabibDWbzAj2TajeEic7WvKCJOLaOh6jibEmdQ36EO3sBUZ0HibAiapsrZo64U8w/132","nickname":"æ¢¦å€šæ æ†","note":"","ucode":"BDEB97F2822445","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":77694,"discussion_content":"æ‰€ä»¥ç†è§£èµ·æ¥è¿™æ˜¯ä¸€ä¸ªæ¦‚ç‡é—®é¢˜ï¼Œ\næ–¹æ¡ˆ1:å¤§å®¶å…±äº«ä¸€ä¸ªæ± å­ï¼Œåœ¨ä¸€ä¸ªæ± å­é‡Œæ’é˜Ÿï¼Œç­‰å¾…å¤„ç†ã€‚\næ–¹æ¡ˆ2:å¤§å®¶æ ¹æ®è‡ªå·±çš„æƒ…å†µç»„å›¢ï¼Œæ¯ä¸ªå›¢é˜Ÿåˆ›å»ºä¸€ä¸ªçº¿ç¨‹æ± ï¼Œæ¯ä¸ªå›¢é˜Ÿé‡Œå„è‡ªæ’é˜Ÿã€‚\næ–¹æ¡ˆ1å’Œæ–¹æ¡ˆ2çš„åŒºåˆ«å°±æ˜¯æ–¹æ¡ˆ1é‡ŒæŠ¢åˆ°çº¿ç¨‹çš„ä»»åŠ¡å„ç§å„æ ·ï¼Œå¾ˆæœ‰å¯èƒ½å¾ˆä¸å¹¸å…¨éƒ¨æ˜¯è€—æ—¶çš„ï¼Œæ–¹æ¡ˆ2æ˜¯æ¯ä¸ªå›¢é˜Ÿéƒ½ä¼šæœ‰ä¸€ä¸ªä»»åŠ¡æŠ¢åˆ°æ‰§è¡Œçº¿ç¨‹ï¼Œ æ›´å°æ¦‚ç‡æŠ¢åˆ°çº¿ç¨‹çš„ä»»åŠ¡å…¨éƒ¨éƒ½æ˜¯è€—æ—¶çš„\nä½†æ˜¯æ–¹æ¡ˆ2æ²¡æœ‰ä¸€ä¸ªå…¨å±€çš„è§†è§’æ¥æŠŠæ§çº¿ç¨‹çš„ä¸ªæ•°ï¼Œå¯èƒ½ä¼šå¯¼è‡´é¢‘ç¹ä¸Šä¸‹æ–‡åˆ‡æ¢ï¼Œå¯èƒ½ä¹Ÿä¼šæ…¢","likes_number":8,"is_delete":false,"is_hidden":false,"ctime":1575934483,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":88825,"user_name":"J.M.Liu","can_delete":false,"product_type":"c1","uid":1200037,"ip_address":"","ucode":"B2CB84B8E923A6","user_header":"https://static001.geekbang.org/account/avatar/00/12/4f/a5/71358d7b.jpg","comment_is_top":false,"comment_ctime":1556008668,"is_pvip":false,"replies":[{"id":"31819","content":"åé¢æœ‰ä»‹ç»<br>","user_name":"ä½œè€…å›å¤","user_name_real":"ç‹å®ä»¤","uid":"1269969","ctime":1556028539,"ip_address":"","comment_id":88825,"utype":1}],"discussion_count":1,"race_medal":0,"score":"53095616220","product_id":100023901,"comment_content":"æˆ‘è§‰å¾—æ—¢ç„¶éƒ½è®²åˆ°CompletableFutureäº†ï¼Œè€å¸ˆæ˜¯ä¸æ˜¯æœ‰å¿…è¦ä¸ä¸€ç« ForkJoinPoolå‘€ï¼Ÿæ¯•ç«Ÿï¼ŒForkJoinPoolå’ŒThreadPoolExecutorè¿˜æ˜¯æœ‰å¾ˆå¤šä¸ä¸€æ ·çš„ã€‚è°¢è°¢è€å¸ˆ","like_count":12,"discussions":[{"author":{"id":1269969,"avatar":"https://static001.geekbang.org/account/avatar/00/13/60/d1/8efa89ab.jpg","nickname":"ç‹å®ä»¤","note":"","ucode":"4FE19F5BC32FCA","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":447913,"discussion_content":"åé¢æœ‰ä»‹ç»\n","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1556028539,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":89141,"user_name":"henry","can_delete":false,"product_type":"c1","uid":1075941,"ip_address":"","ucode":"0ACD12F363F8DE","user_header":"http://thirdqq.qlogo.cn/qqapp/101418266/D6DD8CB1004D442B48914656340277F3/100","comment_is_top":false,"comment_ctime":1556090322,"is_pvip":false,"replies":[{"id":"31965","content":"æœ‰ä¸ªåœ°æ–¹éœ€è¦æ³¨æ„ï¼šrunAsyncå’ŒsupplyAsyncéƒ½æ˜¯é™æ€æ–¹æ³•ã€‚<br>çº¿ç¨‹æ± è®¾ç½®çš„å¤ªå°äº†ï¼Œè¿™æ˜¯ä¸ªIOå¯†é›†å‹çš„ä»»åŠ¡<br>thenApplyé‡Œé¢çš„runAsyncæˆ‘è§‰å¾—å¥½åƒæ˜¯æ²¡æœ‰å¿…è¦ï¼Œå¢åŠ äº†å¤æ‚çš„äº†ã€‚<br><br>å¦‚æœthenApplyé‡Œé¢éœ€è¦å¼‚æ­¥ï¼Œå¯ä»¥ç”¨thenApplyAsync","user_name":"ä½œè€…å›å¤","user_name_real":"ç‹å®ä»¤","uid":"1269969","ctime":1556117495,"ip_address":"","comment_id":89141,"utype":1}],"discussion_count":4,"race_medal":0,"score":"44505763282","product_id":100023901,"comment_content":"è€å¸ˆæˆ‘ç°åœ¨æœ‰ä¸ªä»»åŠ¡ï¼Œå’Œæ‚¨çš„ä¾‹å­æœ‰ç›¸ä¼¼çš„åœ°æ–¹ï¼Œæ˜¯ä»ä¸€ä¸ªåº“é‡ŒæŸ¥è¯¢å¤šå¼ è¡¨çš„æ•°æ®åŒæ­¥åˆ°å¦å¤–ä¸€ä¸ªåº“ï¼Œå°±æœ‰åŒé‡forå¾ªç¯ï¼Œæœ€å¤–å±‚ç”¨ä¸å¤šå¼ è¡¨çš„éå†ï¼Œå†…å±‚çš„forå¾ªç¯ç”¨äºæ‰¹é‡è¯»å–æŸä¸€å¼ è¡¨çš„æ•°æ®ï¼Œå› ä¸ºæ•°æ®é‡å¯èƒ½åœ¨å‡ ä¸‡æ¡ï¼Œæˆ‘æƒ³åˆ†æ‰¹æ¬¡è¯»å‡ºæ¥å†åŒæ­¥åˆ°å¦ä¸€ä¸ªæ•°æ®åº“ï¼Œæ˜¨å¤©å†™çš„æ—¶å€™ç”¨çš„æ˜¯futuretask,ä»Šå¤©æ­£å¥½çœ‹åˆ°è€å¸ˆçš„æ–‡ç« å°±æ”¹æˆäº†CompletableFutureï¼Œè¿˜æ²¡æœ‰ç”¨å¼‚å¸¸å¤„ç†çš„ï¼Œåé¢æˆ‘è¿˜è¦çœ‹çœ‹æ€ä¹ˆåŠ ä¸Šå¼‚å¸¸å¤„ç†çš„ã€‚å…¶å®ƒçš„ä¸çŸ¥é“æˆ‘ç”¨çš„å¯¹ä¸å¯¹ï¼Œè¯·è€å¸ˆçœ‹çœ‹ï¼š<br>   &#47;&#47; åˆå§‹åŒ–å¼‚æ­¥å·¥å…·ç±»ï¼Œåˆ†åˆ«å¼‚æ­¥æ‰§è¡Œ2ä¸ªä»»åŠ¡<br>        CompletableFuture&lt;List&lt;PBSEnergyData&gt;&gt; asyncAquirePBSEnergyData = new CompletableFuture();<br>        CompletableFuture&lt;List&lt;AXEEnergyData&gt;&gt; asyncSaveAxeEnergyData = new CompletableFuture();<br>        &#47;&#47; åˆå§‹åŒ–ä¸¤ä¸ªçº¿ç¨‹æ± ï¼Œ åˆ†åˆ«ç”¨äº2ä¸ªä»»åŠ¡ ï¼Œ1ä¸ªä»»åŠ¡ä¸€ä¸ªçº¿ç¨‹æ± ï¼Œäº’ä¸å¹²æ‰°<br>        Executor aquirePBSEnergyDataExecutor = Executors.newFixedThreadPool(Runtime.getRuntime().availableProcessors());<br>        Executor saveAxeEnergyDataExecutor = Executors.newFixedThreadPool(Runtime.getRuntime().availableProcessors());<br>        queryUtils.getTableNames().forEach(tableName -&gt; {<br>            int pageSize = queryUtils.getPageSize();<br>            &#47;&#47;æŸ¥è¯¢è¯¥è¡¨æœ‰å¤šå°‘æ¡æ•°æ®ï¼Œæ¯${pageSize}æ¡ä¸€æ¬¡<br>            int count = pbsEnergyService.getCount(tableName);<br>            &#47;&#47;æ€»é¡µæ•°<br>            int pages = count &#47; pageSize;<br>            int pageNum = 0;<br>            final int pageNo = pageNum;<br>            for(pageNum = 0; pageNum &lt;= pages; pageNum++){<br>                &#47;&#47; å¼‚æ­¥è·å–PBSæ•°æ®åº“çš„æ•°æ®å¹¶è¿”å›ç»“æœ<br>                asyncAquirePBSEnergyData<br>                        .supplyAsync(() -&gt; {<br>                    æŸ¥è¯¢æ•°æ®åº“<br>                    return pbsEnergyDatas;<br>                },aquirePBSEnergyDataExecutor)<br>                        &#47;&#47; ä»»åŠ¡2ä»»åŠ¡1ï¼Œä»»åŠ¡1è¿”å›çš„ç»“æœ<br>                        .thenApply(pbsEnergyDatas -&gt; asyncSaveAxeEnergyData.runAsync(()-&gt;{<br>                    List&lt;AXEEnergyData&gt; axeEnergyDatas = pbsEnergyDatas.stream().map(pbsEnergyData -&gt; {<br>                   \t &#47;&#47;è¿›è¡Œç±»å‹è½¬æ¢<br>                    }).collect(Collectors.toList());<br>                    &#47;&#47;æ‰¹é‡ä¿å­˜<br>                },saveAxeEnergyDataExecutor));<br>            }<br>        });<br>å…¨éƒ¨è´´ä¸Šå»ï¼Œè¶…è¿‡å­—ç¬¦æ•°äº†ï¼Œåªèƒ½è¯·è€å¸ˆå‡‘åˆçœ‹äº† :(","like_count":10,"discussions":[{"author":{"id":1269969,"avatar":"https://static001.geekbang.org/account/avatar/00/13/60/d1/8efa89ab.jpg","nickname":"ç‹å®ä»¤","note":"","ucode":"4FE19F5BC32FCA","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":448033,"discussion_content":"æœ‰ä¸ªåœ°æ–¹éœ€è¦æ³¨æ„ï¼šrunAsyncå’ŒsupplyAsyncéƒ½æ˜¯é™æ€æ–¹æ³•ã€‚\nçº¿ç¨‹æ± è®¾ç½®çš„å¤ªå°äº†ï¼Œè¿™æ˜¯ä¸ªIOå¯†é›†å‹çš„ä»»åŠ¡\nthenApplyé‡Œé¢çš„runAsyncæˆ‘è§‰å¾—å¥½åƒæ˜¯æ²¡æœ‰å¿…è¦ï¼Œå¢åŠ äº†å¤æ‚çš„äº†ã€‚\n\nå¦‚æœthenApplyé‡Œé¢éœ€è¦å¼‚æ­¥ï¼Œå¯ä»¥ç”¨thenApplyAsync","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1556117495,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1049017,"avatar":"https://static001.geekbang.org/account/avatar/00/10/01/b9/73435279.jpg","nickname":"å­¦ä¹ å­¦ä¸ªå±","note":"","ucode":"DF2D61E6FB2FCE","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":572338,"discussion_content":"è¿™ä¸ªåœºæ™¯å°±æ²¡å¿…è¦ç”¨  CompletableFuture è¿™ä¸ªäº†å§ï¼Œçº¿ç¨‹æ± å°±å¯ä»¥ï¼Œä¸€é¡µæ•°æ®ä¸€ä¸ªçº¿ç¨‹ï¼Œå¦å¤–æ§åˆ¶å¥½å¼‚å¸¸ä»¥åŠäº‹åŠ¡ã€‚","likes_number":1,"is_delete":false,"is_hidden":false,"ctime":1652711645,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":2,"child_discussions":[{"author":{"id":1878896,"avatar":"https://static001.geekbang.org/account/avatar/00/1c/ab/70/336b8ec1.jpg","nickname":"æ€å…¥ç¦åŒºçš„å‹’å¸ƒæœ—","note":"","ucode":"AF89E123F075DC","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":1049017,"avatar":"https://static001.geekbang.org/account/avatar/00/10/01/b9/73435279.jpg","nickname":"å­¦ä¹ å­¦ä¸ªå±","note":"","ucode":"DF2D61E6FB2FCE","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":575776,"discussion_content":"CompletableFutureä¹Ÿæ˜¯çº¿ç¨‹æ± ï¼Œæˆ‘è§‰å¾—ç”¨è¿™ä¸ªæŒºå¥½çš„","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1655104776,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":572338,"ip_address":""},"score":575776,"extra":""},{"author":{"id":1049017,"avatar":"https://static001.geekbang.org/account/avatar/00/10/01/b9/73435279.jpg","nickname":"å­¦ä¹ å­¦ä¸ªå±","note":"","ucode":"DF2D61E6FB2FCE","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":1878896,"avatar":"https://static001.geekbang.org/account/avatar/00/1c/ab/70/336b8ec1.jpg","nickname":"æ€å…¥ç¦åŒºçš„å‹’å¸ƒæœ—","note":"","ucode":"AF89E123F075DC","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":576341,"discussion_content":"è¿™ä¸ªåº•å±‚ä¹Ÿæ˜¯çº¿ç¨‹æ± ï¼Œè¿™ä¸ªé€‚åˆå¼‚æ­¥+è·å–ç»“æœå†è¿›è¡Œå…¶ä»–å¼‚æ­¥é€»è¾‘å¤„ç†è¿™ç§åœºæ™¯ï¼Œåˆ†é¡µä½¿ç”¨è¿™ä¸ªæ„Ÿè§‰ä¸æ˜¯å¾ˆé€‚åˆã€‚ä½†ä¹Ÿèƒ½ç”¨ã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1655451277,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":575776,"ip_address":""},"score":576341,"extra":""}]}]},{"had_liked":false,"id":88856,"user_name":"Chocolate","can_delete":false,"product_type":"c1","uid":1013822,"ip_address":"","ucode":"242CF0E3C10E97","user_header":"https://static001.geekbang.org/account/avatar/00/0f/78/3e/c39d86f1.jpg","comment_is_top":false,"comment_ctime":1556013894,"is_pvip":false,"replies":[{"id":"31818","content":"æ˜¯çš„ï¼Œå¤æ‚åœºæ™¯å°±èƒ½ä½“ç°å‡ºä¼˜åŠ¿äº†<br>","user_name":"ä½œè€…å›å¤","user_name_real":"ç‹å®ä»¤","uid":"1269969","ctime":1556028511,"ip_address":"","comment_id":88856,"utype":1}],"discussion_count":4,"race_medal":0,"score":"40210719558","product_id":100023901,"comment_content":"å›ç­”ã€Œå¯†ç 123456ã€ï¼šCompletableFuture åœ¨æ‰§è¡Œçš„è¿‡ç¨‹ä¸­å¯ä»¥ä¸é˜»å¡ä¸»çº¿ç¨‹ï¼Œæ”¯æŒ runAsyncã€anyOfã€allOf ç­‰æ“ä½œï¼Œç­‰æŸä¸ªæ—¶é—´ç‚¹éœ€è¦å¼‚æ­¥æ‰§è¡Œçš„ç»“æœæ—¶å†é˜»å¡è·å–ã€‚","like_count":9,"discussions":[{"author":{"id":1269969,"avatar":"https://static001.geekbang.org/account/avatar/00/13/60/d1/8efa89ab.jpg","nickname":"ç‹å®ä»¤","note":"","ucode":"4FE19F5BC32FCA","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":447927,"discussion_content":"æ˜¯çš„ï¼Œå¤æ‚åœºæ™¯å°±èƒ½ä½“ç°å‡ºä¼˜åŠ¿äº†\n","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1556028511,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1878896,"avatar":"https://static001.geekbang.org/account/avatar/00/1c/ab/70/336b8ec1.jpg","nickname":"æ€å…¥ç¦åŒºçš„å‹’å¸ƒæœ—","note":"","ucode":"AF89E123F075DC","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":575777,"discussion_content":"ä½¿ç”¨FutureTaskï¼Œä¸è°ƒç”¨getæ–¹æ³•ä¹Ÿä¸ä¼šé˜»å¡ä¸»çº¿ç¨‹ï¼Œæ¯æ¡ç†è§£è¿™ä¸ªç‚¹æ˜¯æŒ‡çš„ä»€ä¹ˆä¼˜åŠ¿","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1655104933,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1135912,"avatar":"https://static001.geekbang.org/account/avatar/00/11/55/28/31b0cf2f.jpg","nickname":"é»‘è‰²æ¯›è¡£","note":"","ucode":"FF7E235F91BA5C","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":53021,"discussion_content":"æ–¹æ³•å¦‚æœåœ¨ä¸»çº¿ç¨‹è°ƒç”¨ï¼Œä¸å°±é˜»å¡äº†å—ï¼Ÿ","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1574124698,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":1,"child_discussions":[{"author":{"id":1217874,"avatar":"https://static001.geekbang.org/account/avatar/00/12/95/52/ad190682.jpg","nickname":"Mr wind","note":"","ucode":"484F02D1962239","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":1135912,"avatar":"https://static001.geekbang.org/account/avatar/00/11/55/28/31b0cf2f.jpg","nickname":"é»‘è‰²æ¯›è¡£","note":"","ucode":"FF7E235F91BA5C","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":138144,"discussion_content":"è°ƒç”¨joinçš„æ—¶å€™æ‰ä¼šé˜»å¡ï¼Œä½ éœ€è¦è¿”å›ç»“æœçš„æ—¶å€™ï¼Œå°±å»è°ƒç”¨joinï¼Œå¦‚æœä»»åŠ¡æ²¡æ‰§è¡Œå®Œï¼Œé˜»å¡ç­‰å¾…ç»“æœï¼Œæ‰§è¡Œå®Œçš„è¯ä¼šç›´æ¥è·å¾—ç»“æœã€‚å¯ä»¥ç¿»ç¿»å‰é¢è€å¸ˆè®²çš„ç¬¬ä¸€éƒ¨åˆ†","likes_number":1,"is_delete":false,"is_hidden":false,"ctime":1579225821,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":53021,"ip_address":""},"score":138144,"extra":""}]}]},{"had_liked":false,"id":164948,"user_name":"Monday","can_delete":false,"product_type":"c1","uid":1250907,"ip_address":"","ucode":"77B9BACC783598","user_header":"https://static001.geekbang.org/account/avatar/00/13/16/5b/83a35681.jpg","comment_is_top":false,"comment_ctime":1577115403,"is_pvip":false,"replies":[{"id":"62982","content":"ç”¨è¿‡ï¼Œé…åˆlambdaæ•ˆæœå¾ˆå¥½","user_name":"ä½œè€…å›å¤","user_name_real":"ç‹å®ä»¤","uid":"1269969","ctime":1577189217,"ip_address":"","comment_id":164948,"utype":1}],"discussion_count":1,"race_medal":0,"score":"31641886475","product_id":100023901,"comment_content":"CompletableFutureä»æ¥æ²¡ç©è¿‡ï¼Œè€å¸ˆåœ¨å·¥ä½œ&#47;å®è·µä¸­æœ‰ä½¿ç”¨è¿‡è¿™ä¸ªç±»å—ï¼Ÿ","like_count":7,"discussions":[{"author":{"id":1269969,"avatar":"https://static001.geekbang.org/account/avatar/00/13/60/d1/8efa89ab.jpg","nickname":"ç‹å®ä»¤","note":"","ucode":"4FE19F5BC32FCA","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":478964,"discussion_content":"ç”¨è¿‡ï¼Œé…åˆlambdaæ•ˆæœå¾ˆå¥½","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1577189217,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":93491,"user_name":"ä½‘å„¿","can_delete":false,"product_type":"c1","uid":1226196,"ip_address":"","ucode":"0629888E7A5E16","user_header":"https://static001.geekbang.org/account/avatar/00/12/b5/d4/3bd5b77b.jpg","comment_is_top":false,"comment_ctime":1557480211,"is_pvip":false,"replies":[{"id":"33506","content":"ä¸æ˜¯åœ¨è°ƒç”¨æ–¹æ³•çš„çº¿ç¨‹ä¸­æ‰§è¡Œçš„ï¼Œè¿™æ ·æ˜¯ä¸æ˜¯æ›´å®¹æ˜“ç†è§£","user_name":"ä½œè€…å›å¤","user_name_real":"ç‹å®ä»¤","uid":"1269969","ctime":1557643774,"ip_address":"","comment_id":93491,"utype":1}],"discussion_count":2,"race_medal":0,"score":"31622251283","product_id":100023901,"comment_content":"å¸¦æœ‰asynçš„æ–¹æ³•æ˜¯å¼‚æ­¥æ‰§è¡Œï¼Œè¿™é‡Œçš„å¼‚æ­¥æ˜¯ä¸åœ¨å½“å‰çº¿ç¨‹ä¸­æ‰§è¡Œï¼Ÿ  æ¯”è¾ƒå›°æƒ‘","like_count":7,"discussions":[{"author":{"id":1269969,"avatar":"https://static001.geekbang.org/account/avatar/00/13/60/d1/8efa89ab.jpg","nickname":"ç‹å®ä»¤","note":"","ucode":"4FE19F5BC32FCA","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":449656,"discussion_content":"ä¸æ˜¯åœ¨è°ƒç”¨æ–¹æ³•çš„çº¿ç¨‹ä¸­æ‰§è¡Œçš„ï¼Œè¿™æ ·æ˜¯ä¸æ˜¯æ›´å®¹æ˜“ç†è§£","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1557643774,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1579698,"avatar":"","nickname":"wangwe","note":"","ucode":"24F9574044565D","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":213854,"discussion_content":"åœ¨å¦ä¸€ä¸ªæ–°çš„çº¿ç¨‹æ‰§è¡Œï¼Œå¯ä»¥é€šè¿‡æ—¥å¿—ä¸­çš„çº¿ç¨‹IDçœ‹å‡ºæ¥","likes_number":1,"is_delete":false,"is_hidden":false,"ctime":1585127856,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":159715,"user_name":"åœ†æ»šæ»š","can_delete":false,"product_type":"c1","uid":1351012,"ip_address":"","ucode":"E4D81822A87D50","user_header":"https://static001.geekbang.org/account/avatar/00/14/9d/64/272dc1b7.jpg","comment_is_top":false,"comment_ctime":1575735537,"is_pvip":false,"discussion_count":1,"race_medal":0,"score":"27345539313","product_id":100023901,"comment_content":"è€å¸ˆï¼Œæˆ‘çœ‹demoéƒ½æ˜¯combine2ä¸ªçš„ï¼Œèšåˆå¤šä¸ªçš„è¯æ€ä¹ˆå¤„ç†","like_count":6,"discussions":[{"author":{"id":1361746,"avatar":"https://static001.geekbang.org/account/avatar/00/14/c7/52/c5adf218.jpg","nickname":"å–œæ¬¢åœ°çƒçš„é˜¿åŸ¹åŒå­¦","note":"","ucode":"5F97037585F857","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":119350,"discussion_content":"allOf()ï¼Œæˆ–è€…anyOf()","likes_number":3,"is_delete":false,"is_hidden":false,"ctime":1578227569,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":89126,"user_name":"LW","can_delete":false,"product_type":"c1","uid":1325297,"ip_address":"","ucode":"89820332658E98","user_header":"https://static001.geekbang.org/account/avatar/00/14/38/f1/996a070d.jpg","comment_is_top":false,"comment_ctime":1556085049,"is_pvip":false,"replies":[{"id":"31952","content":"è¿™ä¸ªçº¿ç¨‹æ± åœ¨é«˜å¹¶å‘åœºæ™¯é‡Œæ€§èƒ½æ›´é«˜ä¸€äº›ï¼Œåé¢ä¼šæœ‰ä»‹ç»<br>","user_name":"ä½œè€…å›å¤","user_name_real":"ç‹å®ä»¤","uid":"1269969","ctime":1556113286,"ip_address":"","comment_id":89126,"utype":1}],"discussion_count":1,"race_medal":0,"score":"23030921529","product_id":100023901,"comment_content":"è€å¸ˆï¼Œä¸ºä»€ä¹ˆCompletableFutureä¸­é»˜è®¤ä½¿ç”¨ForkJoinPoolè¿™ä¸ªçº¿ç¨‹æ± å‘¢ï¼Ÿå®ƒä¸ºä»€ä¹ˆä¸ç”¨å…¶ä»–çº¿ç¨‹æ± ï¼Ÿ","like_count":5,"discussions":[{"author":{"id":1269969,"avatar":"https://static001.geekbang.org/account/avatar/00/13/60/d1/8efa89ab.jpg","nickname":"ç‹å®ä»¤","note":"","ucode":"4FE19F5BC32FCA","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":448027,"discussion_content":"è¿™ä¸ªçº¿ç¨‹æ± åœ¨é«˜å¹¶å‘åœºæ™¯é‡Œæ€§èƒ½æ›´é«˜ä¸€äº›ï¼Œåé¢ä¼šæœ‰ä»‹ç»\n","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1556113286,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":88911,"user_name":"æ˜“å„¿æ˜“","can_delete":false,"product_type":"c1","uid":1242864,"ip_address":"","ucode":"B15D1031CA841E","user_header":"https://wx.qlogo.cn/mmopen/vi_32/DYAIOgq83eqLcWH3mSPmhjrs1aGL4b3TqI7xDqWWibM4nYFrRlp0z7FNSWaJz0mqovrgIA7ibmrPt8zRScSfRaqQ/132","comment_is_top":false,"comment_ctime":1556026358,"is_pvip":false,"replies":[{"id":"31972","content":"ä½ ä¹Ÿå¯ä»¥ç†è§£æˆç»™ç¬¬ä¸€ä¸ªå­ä»»åŠ¡è¿½åŠ äº†ä¸€ä¸ªç±»ä¼¼â€œå›è°ƒæ–¹æ³•â€ã€‚å›è°ƒä¸ä¹Ÿæ˜¯åœ¨ç¬¬ä¸€ä¸ªä»»åŠ¡æ‰§è¡Œå®Œæ‰å›è°ƒå—ï¼Ÿæ‰€ä»¥ä¹Ÿæ˜¯ä¸²è¡Œçš„ã€‚éƒ½æ˜¯ä¸€å›äº‹ï¼Œä½ æ€ä¹ˆç†è§£èµ·æ¥é¡ºæ‰‹å°±æ€ä¹ˆç†è§£å°±å¯ä»¥äº†ã€‚","user_name":"ä½œè€…å›å¤","user_name_real":"ç‹å®ä»¤","uid":"1269969","ctime":1556117807,"ip_address":"","comment_id":88911,"utype":1}],"discussion_count":1,"race_medal":0,"score":"23030862838","product_id":100023901,"comment_content":"è€å¸ˆæˆ‘æœ‰ä¸€ä¸ªé—®é¢˜ï¼šåœ¨æè¿°ä¸²è¡Œå…³ç³»æ—¶ï¼Œä¸ºä»€ä¹ˆå‚æ•°æ²¡æœ‰otherï¼Ÿè¿™è®©æˆ‘è§‰å¾—å¹¶ä¸æ˜¯åœ¨æè¿°ä¸¤ä¸ªå­ä»»åŠ¡çš„ä¸²è¡Œå…³ç³»ï¼Œè€Œæ˜¯ç»™ç¬¬ä¸€ä¸ªå­ä»»åŠ¡è¿½åŠ äº†ä¸€ä¸ªç±»ä¼¼â€œå›è°ƒæ–¹æ³•â€fnç­‰â€¦â€¦è€Œå¹¶è¡Œå…³ç³»å’Œæ±‡èšå…³ç³»åˆ™å¾ˆæ˜ç¡®çš„å‡ºç°äº†otherâ€¦â€¦","like_count":5,"discussions":[{"author":{"id":1269969,"avatar":"https://static001.geekbang.org/account/avatar/00/13/60/d1/8efa89ab.jpg","nickname":"ç‹å®ä»¤","note":"","ucode":"4FE19F5BC32FCA","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":447941,"discussion_content":"ä½ ä¹Ÿå¯ä»¥ç†è§£æˆç»™ç¬¬ä¸€ä¸ªå­ä»»åŠ¡è¿½åŠ äº†ä¸€ä¸ªç±»ä¼¼â€œå›è°ƒæ–¹æ³•â€ã€‚å›è°ƒä¸ä¹Ÿæ˜¯åœ¨ç¬¬ä¸€ä¸ªä»»åŠ¡æ‰§è¡Œå®Œæ‰å›è°ƒå—ï¼Ÿæ‰€ä»¥ä¹Ÿæ˜¯ä¸²è¡Œçš„ã€‚éƒ½æ˜¯ä¸€å›äº‹ï¼Œä½ æ€ä¹ˆç†è§£èµ·æ¥é¡ºæ‰‹å°±æ€ä¹ˆç†è§£å°±å¯ä»¥äº†ã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1556117807,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":208852,"user_name":"Geek_0359eb","can_delete":false,"product_type":"c1","uid":1583272,"ip_address":"","ucode":"BED4E390D5972B","user_header":"https://static001.geekbang.org/account/avatar/00/18/28/a8/eaa810af.jpg","comment_is_top":false,"comment_ctime":1587451428,"is_pvip":false,"replies":[{"id":"78101","content":"å¤šçº¿ç¨‹å¹¶è¡Œï¼Œæ²¡åŠæ³•æŠ›å‡ºå¼‚å¸¸","user_name":"ä½œè€…å›å¤","user_name_real":"ç‹å®ä»¤","uid":"1269969","ctime":1587476955,"ip_address":"","comment_id":208852,"utype":1}],"discussion_count":1,"race_medal":0,"score":"14472353316","product_id":100023901,"comment_content":"è€å¸ˆæ‚¨å¥½ï¼Œæƒ³é—®ä¸‹ä¸»çº¿ç¨‹æ€ä¹ˆæ•è·åˆ°å¤šçº¿ç¨‹ä¸­æŠ›å‡ºçš„å¼‚å¸¸ï¼Œæ•è·åå†æŠ›å‡ºè‡ªå®šä¹‰å¼‚å¸¸å‘¢ï¼Ÿ","like_count":4,"discussions":[{"author":{"id":1269969,"avatar":"https://static001.geekbang.org/account/avatar/00/13/60/d1/8efa89ab.jpg","nickname":"ç‹å®ä»¤","note":"","ucode":"4FE19F5BC32FCA","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":492647,"discussion_content":"å¤šçº¿ç¨‹å¹¶è¡Œï¼Œæ²¡åŠæ³•æŠ›å‡ºå¼‚å¸¸","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1587476955,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":88657,"user_name":"ç½—æ´²","can_delete":false,"product_type":"c1","uid":1263417,"ip_address":"","ucode":"68133E38A25C17","user_header":"https://static001.geekbang.org/account/avatar/00/13/47/39/0ce1aa62.jpg","comment_is_top":false,"comment_ctime":1555980064,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"14440881952","product_id":100023901,"comment_content":"æˆ‘è§‰å¾—è¯¾åæ€è€ƒé¢˜ä¸­ï¼Œæ—¢ç„¶æ˜¯å…ˆæŸ¥è§„åˆ™å†æ ¡éªŒï¼Œè¿™æœ¬æ¥å°±æ˜¯ä¸€ä¸ªä¸²è¡ŒåŒ–çš„åŠ¨ä½œï¼Œä¸ºä»€ä¹ˆè¦å¼‚æ­¥å‘¢ï¼Ÿç”¨å¼‚æ­¥çš„æ„ä¹‰åœ¨å“ªï¼Ÿ","like_count":3},{"had_liked":false,"id":291885,"user_name":"_ç«‹æ–Œ","can_delete":false,"product_type":"c1","uid":1562851,"ip_address":"","ucode":"D081ED845C25C2","user_header":"https://static001.geekbang.org/account/avatar/00/17/d8/e3/99f330b8.jpg","comment_is_top":false,"comment_ctime":1620571009,"is_pvip":false,"replies":[{"id":"106835","content":"è¿™ç§åœºæ™¯ï¼Œè¿˜æ˜¯ææˆåŒæ­¥å§ï¼Œè¦ä¸å°±æŠŠä»»åŠ¡ææˆçº¯è®¡ç®—çš„ï¼Œç›®å‰æˆ‘æ²¡è§åˆ°å…¼é¡¾æ€§èƒ½å’Œæ˜“ç”¨æ€§çš„æ–¹æ¡ˆ","user_name":"ä½œè€…å›å¤","user_name_real":"ç‹å®ä»¤","uid":"1269969","ctime":1621942577,"ip_address":"","comment_id":291885,"utype":1}],"discussion_count":2,"race_medal":0,"score":"10210505601","product_id":100023901,"comment_content":"è€å¸ˆå¥½ï¼Œæƒ³è¯·é—®ä¸€ä¸‹ï¼Œå¦‚æœä¸€ä¸ªäº‹åŠ¡é‡Œå¼€äº†å¤šä¸ªå¼‚æ­¥ä»»åŠ¡ï¼Œå¦‚æœå…¶ä¸­ä¸€ä¸ªä»»åŠ¡æŠ›å‡ºå¼‚å¸¸äº†ï¼Œå…¶ä»–ä»»åŠ¡åº”è¯¥å…¨éƒ¨å›æ»šï¼Œè¿™æ ·çš„å¼‚å¸¸å¦‚ä½•æ•è·å¹¶å¤„ç†å‘¢ï¼Ÿä¸šç•Œæœ‰æœ€ä½³å®è·µå—ï¼Ÿè°¢è°¢è€å¸ˆ","like_count":2,"discussions":[{"author":{"id":1269969,"avatar":"https://static001.geekbang.org/account/avatar/00/13/60/d1/8efa89ab.jpg","nickname":"ç‹å®ä»¤","note":"","ucode":"4FE19F5BC32FCA","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":519593,"discussion_content":"è¿™ç§åœºæ™¯ï¼Œè¿˜æ˜¯ææˆåŒæ­¥å§ï¼Œè¦ä¸å°±æŠŠä»»åŠ¡ææˆçº¯è®¡ç®—çš„ï¼Œç›®å‰æˆ‘æ²¡è§åˆ°å…¼é¡¾æ€§èƒ½å’Œæ˜“ç”¨æ€§çš„æ–¹æ¡ˆ","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1621942577,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1562851,"avatar":"https://static001.geekbang.org/account/avatar/00/17/d8/e3/99f330b8.jpg","nickname":"_ç«‹æ–Œ","note":"","ucode":"D081ED845C25C2","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":376053,"discussion_content":"æ˜ç™½äº†ï¼Œè°¢è°¢è€å¸ˆ","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1621943924,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":183442,"user_name":"æ¥¼ä¸‹å°é»‘å“¥","can_delete":false,"product_type":"c1","uid":1014680,"ip_address":"","ucode":"453B099B0EE52E","user_header":"https://static001.geekbang.org/account/avatar/00/0f/7b/98/8f1aecf4.jpg","comment_is_top":false,"comment_ctime":1583040248,"is_pvip":false,"replies":[{"id":"71262","content":"éƒ½æ˜¯è¿™ä¹ˆè¿‡æ¥çš„ğŸ˜‚","user_name":"ä½œè€…å›å¤","user_name_real":"ç‹å®ä»¤","uid":"1269969","ctime":1583234780,"ip_address":"","comment_id":183442,"utype":1}],"discussion_count":1,"race_medal":0,"score":"10172974840","product_id":100023901,"comment_content":"çœ‹äº†å‡ ç¯‡ CompletableFuture çš„æ–‡ç« ï¼Œä¹Ÿå†™è¿‡æµ‹è¯• dmeoã€‚ä¸è¿‡ CompletableFuture API å¤ªå¤šäº†ï¼Œçœ‹çš„è¿·è¿·ç³Šç³Šçš„ã€‚è€å¸ˆè¿™ä¹ˆåˆ†ç±»ï¼Œç¬é—´æ¸…é™¤äº†ï¼Œæ„Ÿè°¢ï¼<br>å˜¿å˜¿ï¼Œå­¦åˆ°ä¸€æ‹›ï¼Œåˆ†ç±»å½’çº³ã€‚","like_count":2,"discussions":[{"author":{"id":1269969,"avatar":"https://static001.geekbang.org/account/avatar/00/13/60/d1/8efa89ab.jpg","nickname":"ç‹å®ä»¤","note":"","ucode":"4FE19F5BC32FCA","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":485690,"discussion_content":"éƒ½æ˜¯è¿™ä¹ˆè¿‡æ¥çš„ğŸ˜‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1583234780,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":153674,"user_name":"é»‘è‰²æ¯›è¡£","can_delete":false,"product_type":"c1","uid":1135912,"ip_address":"","ucode":"FF7E235F91BA5C","user_header":"https://static001.geekbang.org/account/avatar/00/11/55/28/31b0cf2f.jpg","comment_is_top":false,"comment_ctime":1574296066,"is_pvip":false,"replies":[{"id":"59052","content":"å¯ä»¥ï¼Œå®é™…æƒ…å†µä¸ä¼šåªæäº¤ä¸€ä¸ªæ…¢çš„ä»»åŠ¡","user_name":"ä½œè€…å›å¤","user_name_real":"ç‹å®ä»¤","uid":"1269969","ctime":1574300841,"ip_address":"","comment_id":153674,"utype":1}],"discussion_count":2,"race_medal":0,"score":"10164230658","product_id":100023901,"comment_content":"å¦‚æœæ‰€æœ‰ CompletableFuture å…±äº«ä¸€ä¸ªçº¿ç¨‹æ± ï¼Œé‚£ä¹ˆä¸€æ—¦æœ‰ä»»åŠ¡æ‰§è¡Œä¸€äº›å¾ˆæ…¢çš„ I&#47;O æ“ä½œï¼Œå°±ä¼šå¯¼è‡´çº¿ç¨‹æ± ä¸­æ‰€æœ‰çº¿ç¨‹éƒ½é˜»å¡åœ¨ I&#47;O æ“ä½œä¸Š<br><br><br>è¿™ä¸ªæ˜¯ä¸æ˜¯æœ‰é—®é¢˜ï¼Ÿå› ä¸ºçº¿ç¨‹æ± æœ‰å¤šä¸ªçº¿ç¨‹ï¼Œå¦‚æœåªæœ‰ä¸€ä¸ªé˜»å¡ï¼Œé‚£ä¹ˆå…¶ä»–çš„çº¿ç¨‹ä¹Ÿæ˜¯å¯ä»¥çš„å§","like_count":2,"discussions":[{"author":{"id":1269969,"avatar":"https://static001.geekbang.org/account/avatar/00/13/60/d1/8efa89ab.jpg","nickname":"ç‹å®ä»¤","note":"","ucode":"4FE19F5BC32FCA","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":475244,"discussion_content":"å¯ä»¥ï¼Œå®é™…æƒ…å†µä¸ä¼šåªæäº¤ä¸€ä¸ªæ…¢çš„ä»»åŠ¡","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1574300841,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1135912,"avatar":"https://static001.geekbang.org/account/avatar/00/11/55/28/31b0cf2f.jpg","nickname":"é»‘è‰²æ¯›è¡£","note":"","ucode":"FF7E235F91BA5C","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":55940,"discussion_content":"æ˜ç™½äº†ï¼Œè€å¸ˆ","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1574415083,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":124053,"user_name":"null","can_delete":false,"product_type":"c1","uid":1024294,"ip_address":"","ucode":"F9039EFED6B55D","user_header":"http://thirdwx.qlogo.cn/mmopen/vi_32/PiajxSqBRaELZPnUAiajaR5C25EDLWeJURggyiaOP5GGPe2qlwpQcm5e3ybib8OsP4tvddFDLVRSNNGL5I3SFPJHsA/132","comment_is_top":false,"comment_ctime":1565797644,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"10155732236","product_id":100023901,"comment_content":"é—®é¢˜ï¼šä¸ºä»€ä¹ˆåœ¨ CompletableFuture.supplyAsync() æ–¹æ³•ä¸­è¿”å› Supplier å¯¹è±¡æ—¶ï¼Œæ‰“å°å½“å‰çº¿ç¨‹çš„åç§°æ˜¯ main çº¿ç¨‹ï¼Ÿï¼ˆåŒæ­¥æ‰§è¡Œï¼Ÿï¼‰<br><br>å‘ç°ä¸€ä¸ªâ€œæœ‰è¶£â€çš„ç°è±¡ï¼š<br>å¦‚æœåœ¨ supplyAsync() æ–¹æ³•ä¸­è°ƒç”¨çš„ lazySupplier() æ–¹æ³•è¿”å› Supplierï¼Œæƒ°æ€§æ±‚å€¼ï¼Œåœ¨ thenApply() æ–¹æ³•ä¸­è°ƒç”¨ Supplier.get() æ–¹æ³•è§¦å‘çœŸæ­£çš„è€—æ—¶æ“ä½œã€‚<br>æ¯æ¬¡æ‰§è¡Œï¼Œæ€»æœ‰ CompletableFuture.supplyAsync() æ˜¯åœ¨ main çº¿ç¨‹ä¸­æ‰§è¡Œçš„ã€‚<br>è‡ªå·±çš„è§‚å¯Ÿï¼Œæ€»æ˜¯å‰é¢ 2 ä¸ªåœ¨ main çº¿ç¨‹ä¸­æ‰§è¡Œã€‚<br><br>å¦‚æœ lazySupplier() æ–¹æ³•è¿”å› Stringï¼Œåœ¨ supplyAsync() å°±è§¦å‘çœŸæ­£è€—æ—¶æ“ä½œï¼Œè¿™æ—¶ç»“æœè·ŸæœŸæœ›ä¸€æ ·ï¼Œéƒ½æ˜¯å¼‚æ­¥æ‰§è¡Œã€‚<br>æƒ³ä¸æ˜ç™½ä¸ºä»€ä¹ˆ supplyAsync + Supplier æƒ°æ€§æ±‚å€¼ï¼Œå°±é€€åŒ–æˆåŒæ­¥æ‰§è¡Œäº†ã€‚<br><br>è°¢è°¢è€å¸ˆï¼ï¼<br><br><br>ä»£ç å’Œæ‰§è¡Œç»“æœå¦‚ä¸‹æ‰€ç¤ºï¼š<br>public static void main(String[] args) {<br>  ExecutorService executor = Executors.newFixedThreadPool(3);<br>  List&lt;CompletableFuture&lt;String&gt;&gt; list = new ArrayList&lt;&gt;(3);<br>  for (int i = 0; i &lt; 3; i++) {<br>    CompletableFuture&lt;String&gt; future = CompletableFuture.supplyAsync(() -&gt; lazySupplier(), executor)<br>      .thenApply(stringSupplier -&gt; {<br>        System.out.println(&quot;+++ thenApply:&quot; + Thread.currentThread().getName() + &quot; +++&quot;);<br>        String s = stringSupplier.get();<br>        return s + &quot;, hi&quot;;<br>      });<br>    System.out.println(&quot;+++ list.add(future:&quot; + i + &quot;); +++&quot;);<br>    list.add(future);<br>  }<br><br>  for (CompletableFuture&lt;String&gt; future : list) {<br>    String exportList = future.join();<br>    System.out.println(exportList);<br>  }<br><br>  executor.shutdown();<br>}<br><br>private static Supplier&lt;String&gt; lazySupplier() {<br>  return () -&gt; {<br>    long l = System.currentTimeMillis()&#47;1000;<br>    String name = Thread.currentThread().getName();<br>    System.out.println(name + &quot;ï¼Œæ‰§è¡Œæƒ°æ€§æ±‚å€¼ï¼Œå¼€å§‹ï¼š&quot; + l);<br>    try {<br>      Thread.sleep(10000);<br>    } catch (InterruptedException ignored) {<br>    }<br>    System.out.println(name + &quot;ï¼Œæ‰§è¡Œæƒ°æ€§æ±‚å€¼ï¼Œç»“æŸï¼š&quot; + System.currentTimeMillis()&#47;1000);<br>    return l + &quot;&quot;;<br>  };<br>}<br><br>æ‰§è¡Œç»“æœï¼š<br>+++ thenApply:main +++<br>main, æ‰§è¡Œæƒ°æ€§æ±‚å€¼ï¼Œå¼€å§‹ï¼š1565796415<br>main, æ‰§è¡Œæƒ°æ€§æ±‚å€¼ï¼Œç»“æŸï¼š1565796425<br>+++ list.add(future:0); +++<br>+++ thenApply:main +++<br>main, æ‰§è¡Œæƒ°æ€§æ±‚å€¼ï¼Œå¼€å§‹ï¼š1565796425<br>main, æ‰§è¡Œæƒ°æ€§æ±‚å€¼ï¼Œç»“æŸï¼š1565796435<br>+++ list.add(future:1); +++<br>+++ list.add(future:2); +++<br>1565796415, hi<br>1565796425, hi<br>+++ thenApply:pool-1-thread-3 +++<br>pool-1-thread-3, æ‰§è¡Œæƒ°æ€§æ±‚å€¼ï¼Œå¼€å§‹ï¼š1565796435<br>pool-1-thread-3, æ‰§è¡Œæƒ°æ€§æ±‚å€¼ï¼Œç»“æŸï¼š1565796445<br>1565796435, hi","like_count":2},{"had_liked":false,"id":89323,"user_name":"å¤šè¥„ä¸¸","can_delete":false,"product_type":"c1","uid":1074310,"ip_address":"","ucode":"1AA1497C5A293C","user_header":"https://static001.geekbang.org/account/avatar/00/10/64/86/f5a9403a.jpg","comment_is_top":false,"comment_ctime":1556154445,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"10146089037","product_id":100023901,"comment_content":"1.æˆ‘åªæ˜¯æ„Ÿè§‰åˆ°å¼‚å¸¸æ²¡å¤„ç†<br><br>2.æ²¡è€ƒè™‘åˆ°ioåŠ¨ä½œéœ€è¦å®šåˆ¶çº¿ç¨‹å»å¤„ç†<br><br>javaå¼‚æ­¥ç¼–ç¨‹çœ‹èµ·æ¥å¾ˆæœ‰æ„æ€â€¦â€¦","like_count":2},{"had_liked":false,"id":309869,"user_name":"å­¦ä¹ ","can_delete":false,"product_type":"c1","uid":1437425,"ip_address":"","ucode":"CDFB71E0D1508B","user_header":"https://static001.geekbang.org/account/avatar/00/15/ee/f1/16545faf.jpg","comment_is_top":false,"comment_ctime":1630377284,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"5925344580","product_id":100023901,"comment_content":"ä½¿ç”¨äº†CFè¿™ä¸ªå¼‚æ­¥ç¼–ç¨‹ï¼Œä½†æ˜¯å´æ˜¯æŠ¥é”™ï¼Œè¿™ä¸ªå¦‚ä½•å¤„ç†å•Š<br>java.lang.IllegalStateException: No thread-bound request found: Are you referring to request attributes outside of an actual web request, or processing a request outside of the originally receiving thread? If you are actually operating within a web request and still receive this message, your code is probably running outside of DispatcherServlet: In this case, use RequestContextListener or RequestContextFilter to expose the current request.","like_count":1},{"had_liked":false,"id":228213,"user_name":"å­è±ªsirius","can_delete":false,"product_type":"c1","uid":1117023,"ip_address":"","ucode":"E8D08D2D33E785","user_header":"https://static001.geekbang.org/account/avatar/00/11/0b/5f/2cc4060c.jpg","comment_is_top":false,"comment_ctime":1592614943,"is_pvip":true,"replies":[{"id":"84698","content":"äº’ç›¸å€Ÿé‰´ğŸ˜„","user_name":"ä½œè€…å›å¤","user_name_real":"ç‹å®ä»¤","uid":"1269969","ctime":1593003243,"ip_address":"","comment_id":228213,"utype":1}],"discussion_count":1,"race_medal":0,"score":"5887582239","product_id":100023901,"comment_content":"æˆ‘æ˜¯å…ˆå­¦äº†javascriptçš„ES6çš„ï¼Œå‘ç°CompletableFutureçš„ä½¿ç”¨æ–¹æ³•è·ŸPromiseå¾ˆç›¸ä¼¼ï¼Œåº”è¯¥æ˜¯ä¸åŒè¯­è¨€çš„ç›¸äº’å½±å“å§","like_count":1,"discussions":[{"author":{"id":1269969,"avatar":"https://static001.geekbang.org/account/avatar/00/13/60/d1/8efa89ab.jpg","nickname":"ç‹å®ä»¤","note":"","ucode":"4FE19F5BC32FCA","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":498958,"discussion_content":"äº’ç›¸å€Ÿé‰´ğŸ˜„","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1593003243,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":88675,"user_name":"linqw","can_delete":false,"product_type":"c1","uid":1134138,"ip_address":"","ucode":"09DCFE98C54DD8","user_header":"https://static001.geekbang.org/account/avatar/00/11/4e/3a/86196508.jpg","comment_is_top":false,"comment_ctime":1555981642,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"5850948938","product_id":100023901,"comment_content":"è¯¾åä¹ é¢˜ï¼Œè§„åˆ™æ ¡éªŒä¾èµ–äºæ•°æ®åº“ä¸­çš„è§„åˆ™ï¼Œå¦‚æœè§„åˆ™ä¸æ˜¯å…±ç”¨çš„ï¼Œç›´æ¥æ”¾åœ¨ä¸€ä¸ªå†…éƒ¨ï¼Œå¦‚æœè§„åˆ™æ˜¯å…±ç”¨ï¼Œå¯ä»¥åœ¨ä¸»çº¿ç¨‹è¿›è¡Œè§„åˆ™è·å–ï¼Œå¼‚æ­¥æ ¡éªŒè§„åˆ™ã€‚thenApplyä¼šé‡æ–°åˆ›å»ºä¸€ä¸ªCompletableFuture<br>PurchersOrder po;<br>CompletableFuture&lt;Boolean&gt; cf = <br>  CompletableFuture.supplyAsync(()-&gt;{<br>    &#47;&#47; åœ¨æ•°æ®åº“ä¸­æŸ¥è¯¢è§„åˆ™<br>    r = findRuleByJdbc();<br>    &#47;&#47; è§„åˆ™æ ¡éªŒ<br>    return check(po, r);<br>  });<br>Boolean isOk = cf.join();<br>CompletableFutureçš„å†™æ³•å’Œrxjavaçš„ä½¿ç”¨å¾ˆç±»ä¼¼ï¼Œä¸€ä¸ªç»“æœä½œä¸ºä¸‹ä¸€ä¸ªçš„å‚æ•°ï¼Œé“¾å¼æ“ä½œç­‰","like_count":1},{"had_liked":false,"id":88665,"user_name":"zhangtnty","can_delete":false,"product_type":"c1","uid":1180553,"ip_address":"","ucode":"3C9A14BD7CF432","user_header":"https://static001.geekbang.org/account/avatar/00/12/03/89/e1621a01.jpg","comment_is_top":false,"comment_ctime":1555980683,"is_pvip":false,"replies":[{"id":"31824","content":"ä»£ç ä¹Ÿæœ‰é—®é¢˜<br>","user_name":"ä½œè€…å›å¤","user_name_real":"ç‹å®ä»¤","uid":"1269969","ctime":1556028844,"ip_address":"","comment_id":88665,"utype":1}],"discussion_count":1,"race_medal":0,"score":"5850947979","product_id":100023901,"comment_content":"ç‹è€å¸ˆå¥½ï¼Œå•çœ‹æ–‡ä¸­é¢˜ç›®çš„ä»£ç æ˜¯æ²¡é—®é¢˜çš„ï¼Œè¯»æ•°å’Œæ ¡éªŒä¸²è¡ŒåŒ–äº†, ä¸è€ƒè™‘æ•ˆç‡æ˜¯æ²¡é—®é¢˜çš„ã€‚å¦‚æœè¦æå‡æ•ˆç‡æœ€å¥½å¹¶è¡ŒåŒ–, è¯»æ•°å’Œæ ¡éªŒåˆ©ç”¨é˜Ÿåˆ—æ–¹å¼æ•ˆç‡æ›´é«˜ã€‚","like_count":1,"discussions":[{"author":{"id":1269969,"avatar":"https://static001.geekbang.org/account/avatar/00/13/60/d1/8efa89ab.jpg","nickname":"ç‹å®ä»¤","note":"","ucode":"4FE19F5BC32FCA","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":447859,"discussion_content":"ä»£ç ä¹Ÿæœ‰é—®é¢˜\n","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1556028844,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":351300,"user_name":"æ—è¾‰","can_delete":false,"product_type":"c1","uid":1134926,"ip_address":"","ucode":"8DE10DE620F0D2","user_header":"https://static001.geekbang.org/account/avatar/00/11/51/4e/4baa613c.jpg","comment_is_top":false,"comment_ctime":1657683210,"is_pvip":true,"discussion_count":0,"race_medal":0,"score":"1657683210","product_id":100023901,"comment_content":"å¦‚æœå¼€å§‹å¹¶ä¸çŸ¥é“å‡ ä¸ªä»»åŠ¡ï¼Œéœ€è¦æ¯æ¬¡æ ¹æ®æ•°æ®åŠ¨æ€åˆ†é…Nä¸ªå¼‚æ­¥ä»»åŠ¡ï¼Œè¿™ç§è¯¥å¦‚ä½•å†™äº†ï¼Ÿ","like_count":0},{"had_liked":false,"id":349829,"user_name":"freesocean","can_delete":false,"product_type":"c1","uid":1529210,"ip_address":"","ucode":"CAD4C80CF569D3","user_header":"https://static001.geekbang.org/account/avatar/00/17/55/7a/d44df1d6.jpg","comment_is_top":false,"comment_ctime":1656375417,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1656375417","product_id":100023901,"comment_content":"ä¸¤ä¸ªä¸‹åˆ’çº¿é‚£ä¸ªæ˜¯ä»€ä¹ˆè¯­æ³•? è¯·æ•™ä¸‹","like_count":0},{"had_liked":false,"id":349491,"user_name":"æµ®çŸ³æ²‰æœ¨","can_delete":false,"product_type":"c1","uid":2223167,"ip_address":"","ucode":"D585768321B84A","user_header":"https://thirdwx.qlogo.cn/mmopen/vi_32/mQddXC7nRiaKHTwdficicTB3bH0q5ic5UoSab51Omic7eyLBz0SNcvbLpQnNib7zP1yJFm7xxx4ia81iahfibRVnbTwHmhw/132","comment_is_top":false,"comment_ctime":1655994689,"is_pvip":true,"discussion_count":0,"race_medal":0,"score":"1655994689","product_id":100023901,"comment_content":"å¦‚æœæ‰€æœ‰ CompletableFuture å…±äº«ä¸€ä¸ªçº¿ç¨‹æ± ï¼Œé‚£ä¹ˆä¸€æ—¦æœ‰ä»»åŠ¡æ‰§è¡Œä¸€äº›å¾ˆæ…¢çš„ I&#47;O æ“ä½œï¼Œå°±ä¼šå¯¼è‡´çº¿ç¨‹æ± ä¸­æ‰€æœ‰çº¿ç¨‹éƒ½é˜»å¡åœ¨ I&#47;O æ“ä½œä¸Šï¼Œä»è€Œé€ æˆçº¿ç¨‹é¥¥é¥¿ï¼Œè¿›è€Œå½±å“æ•´ä¸ªç³»ç»Ÿçš„æ€§èƒ½ã€‚è€å¸ˆè¿™å¥è¯æˆ‘è¿˜æ˜¯ç†è§£ä¸äº†ï¼Œå¦‚æœIOæˆ‘ç”¨å¦å¤–çš„çº¿ç¨‹æ± å»åšï¼Œé‡Œè¾¹æœ‰è‹¥å¹²çº¿ç¨‹ï¼Œæ­¤æ—¶ä¸€ä¸ªçº¿ç¨‹é˜»å¡äº†ï¼Œå…¶ä»–çš„æ­£å¸¸å·¥ä½œçš„IOçº¿ç¨‹ä¹Ÿä¼šå—å…¶å½±å“å—ï¼Œè¿™ä¸ªå½±å“ä¼šä¸ä¼šå¤ªå¤§äº†ï¼Ÿ","like_count":0},{"had_liked":false,"id":345952,"user_name":"å­¦ä¹ å­¦ä¸ªå±","can_delete":false,"product_type":"c1","uid":1049017,"ip_address":"","ucode":"DF2D61E6FB2FCE","user_header":"https://static001.geekbang.org/account/avatar/00/10/01/b9/73435279.jpg","comment_is_top":false,"comment_ctime":1652711869,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1652711869","product_id":100023901,"comment_content":"é—®é¢˜ç­”æ¡ˆï¼š<br>1 å¼‚å¸¸å¤„ç†<br>2 æŸ¥è¯¢å¤–é¢çº¿ç¨‹å»åš<br>3 æŒ‡å®šä¸“é—¨çš„çº¿ç¨‹æ± ï¼Œä»¥åŠçº¿ç¨‹åï¼Œåé¢ä¾¿äºæŸ¥è¯¢é—®é¢˜<br><br>CompletableFuture è¿™ä¸ªä½¿ç”¨åœºæ™¯æœ€å¥½æ˜¯ä¸€ä¸ªä»»åŠ¡éœ€è¦ä¸Šä¸€ä¸ªä»»åŠ¡çš„ç»“æœï¼Œè¿™ç§åœºæ™¯æœ€é€‚åˆã€‚<br>å…¶ä»–å¼‚æ­¥æ“ä½œè¿˜æ˜¯ç”¨Futureï¼Œç”¨CompletableFutureæœ‰ç‚¹å¤§æ‰æ•ˆç”¨äº†ã€‚","like_count":0},{"had_liked":false,"id":335393,"user_name":"î”¶æœ¨å­æî”¶","can_delete":false,"product_type":"c1","uid":1694965,"ip_address":"","ucode":"815BAC4C950949","user_header":"https://static001.geekbang.org/account/avatar/00/19/dc/f5/806bd1ff.jpg","comment_is_top":false,"comment_ctime":1645501559,"is_pvip":false,"discussion_count":1,"race_medal":0,"score":"1645501559","product_id":100023901,"comment_content":"é¡¹ç›®ä¸Šæœ‰ä¸ªä¿å­˜åŠŸèƒ½ï¼Œæˆ‘æƒ³ç”¨CompletableFutureæ”¹æˆå¤šçº¿ç¨‹ï¼Œå…·ä½“éœ€æ±‚æ˜¯çº¿ç¨‹Aï¼šæ ¡éªŒæ•°æ®ï¼Œçº¿ç¨‹Bï¼šæ ¡éªŒåˆåŒæ¨¡æ¿ï¼šçº¿ç¨‹Cï¼šæ‰§è¡Œä¿å­˜ã€‚å…·ä½“ä»£ç å¦‚ä¸‹ï¼š<br>User user = UserUtil.getUser();<br>ExecutorService executorService = Executors.newFixedThreadPool(3);<br>CompletableFuture&lt;Rest&gt; checkRest = CompletableFuture.supplyAsync(() -&gt; this.checkSoHeadInfo(soHeadFormDTO), executorService);<br>CompletableFuture&lt;Rest&gt; checkSceneRest = CompletableFuture.supplyAsync(() -&gt; this.checkSceneInfo(soHeadFormDTO), executorService);<br>CompletableFuture&lt;Rest&gt; saveRest = checkRest.thenCombine(checkSceneRest, (s1, s2) -&gt; {<br>    &#47;&#47; æ ¡éªŒå¤±è´¥ï¼Œè¿”å›é”™è¯¯ä¿¡æ¯<br>    if (s1.getReturnCode() != 0) {<br>        return s1;<br>    }<br>    &#47;&#47; æ ¡éªŒå¤±è´¥ï¼Œè¿”å›é”™è¯¯ä¿¡æ¯<br>    if (s2.getReturnCode() != 0) {<br>        return s2;<br>    }<br>    &#47;&#47; æ‰§è¡Œä¿å­˜<br>    save();<br>}<br>ç°åœ¨å­˜åœ¨ä¸€ä¸ªé—®é¢˜ï¼Œä¸»çº¿ç¨‹èƒ½æ ¹æ®å·¥å…·ç±» UserUtil.getUser(); è·å–åˆ° userï¼Œä½†æ˜¯åœ¨å­çº¿ç¨‹ä¸­ï¼Œå´è·å–ä¸åˆ°ï¼Œä¼šæŠ›å‡ºç©ºæŒ‡é’ˆã€‚<br>è¯·é—®è€å¸ˆè¿˜æœ‰å„ä½å¤§ä½¬ï¼Œèƒ½å¸®å¿™åˆ†æä¸‹ä»€ä¹ˆåŸå› å—ï¼Œè°¢è°¢<br>","like_count":0,"discussions":[{"author":{"id":1600341,"avatar":"https://static001.geekbang.org/account/avatar/00/18/6b/55/2b0f219b.jpg","nickname":"Geek_42f729","note":"","ucode":"76CFFF9DEDDF96","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":556383,"discussion_content":"çŒœæƒ³ï¼šUserUtilå¦‚æœæ˜¯ä½¿ç”¨ThreadLocalå­˜å‚¨userï¼Œé‚£ä¹ˆå­çº¿ç¨‹è·å–çš„å€¼å°±ä¸ºnullï¼›","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1647336224,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":305682,"user_name":"Geek_Black","can_delete":false,"product_type":"c1","uid":2583432,"ip_address":"","ucode":"8CFB324D281FC5","user_header":"https://static001.geekbang.org/account/avatar/00/27/6b/88/6315d04c.jpg","comment_is_top":false,"comment_ctime":1628118022,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1628118022","product_id":100023901,"comment_content":"çƒ§æ°´æ³¡èŒ¶ 3ä¸ªçº¿ç¨‹æ±   éœ€è¦ä¿è¯é‡Œé¢çº¿ç¨‹å®‰å…¨å—","like_count":0},{"had_liked":false,"id":297343,"user_name":"jiaobuchongà¸ˆà¸¸à¹Šà¸š","can_delete":false,"product_type":"c1","uid":1118938,"ip_address":"","ucode":"0AEE4E579DC3A2","user_header":"https://static001.geekbang.org/account/avatar/00/11/12/da/a3ea305f.jpg","comment_is_top":false,"comment_ctime":1623470039,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1623470039","product_id":100023901,"comment_content":"å¼‚æ­¥ç¼–ç¨‹ï¼Œè¿˜æœ‰ä¸€ä¸ª reactor core","like_count":0},{"had_liked":false,"id":295333,"user_name":"xieyue","can_delete":false,"product_type":"c1","uid":1831599,"ip_address":"","ucode":"D792F5C5F3F2EA","user_header":"https://static001.geekbang.org/account/avatar/00/1b/f2/af/4f5f6d1e.jpg","comment_is_top":false,"comment_ctime":1622372146,"is_pvip":false,"replies":[{"id":"107965","content":"<br>PPT","user_name":"ä½œè€…å›å¤","user_name_real":"ç‹å®ä»¤","uid":"1269969","ctime":1623409871,"ip_address":"","comment_id":295333,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1622372146","product_id":100023901,"comment_content":"æ–‡ç« ä¸­ä½¿ç”¨çš„ç»˜å›¾å·¥å…·æ˜¯ä»€ä¹ˆå‘€ï¼Œæ„Ÿè§‰æŒºå¥½çš„ï¼Œæƒ³å­¦ä¹ ä¸€ä¸‹","like_count":0,"discussions":[{"author":{"id":1269969,"avatar":"https://static001.geekbang.org/account/avatar/00/13/60/d1/8efa89ab.jpg","nickname":"ç‹å®ä»¤","note":"","ucode":"4FE19F5BC32FCA","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":521038,"discussion_content":"\nPPT","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1623409871,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":292205,"user_name":"è½å¶é£é€çš„æ‹","can_delete":false,"product_type":"c1","uid":1046429,"ip_address":"","ucode":"F9A95DB28BCF1E","user_header":"https://static001.geekbang.org/account/avatar/00/0f/f7/9d/be04b331.jpg","comment_is_top":false,"comment_ctime":1620720999,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1620720999","product_id":100023901,"comment_content":"DBé“¾æ¥èµ„æºå®è´µï¼Œä¸å»ºè®®ä½¿ç”¨å¤šçº¿ç¨‹é“¾æ¥DBæŸ¥è¯¢ã€‚åº”è¯¥å•ç‹¬ä¸€ä¸ªçº¿ç¨‹æŸ¥è¯¢å‡ºæ¥ï¼Œç„¶åèµ„æºå…±äº«","like_count":0},{"had_liked":false,"id":287300,"user_name":"24","can_delete":false,"product_type":"c1","uid":1189580,"ip_address":"","ucode":"F09DF49B6254E8","user_header":"https://static001.geekbang.org/account/avatar/00/12/26/cc/719aec6d.jpg","comment_is_top":false,"comment_ctime":1617872450,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1617872450","product_id":100023901,"comment_content":"&#47;&#47;ä»»åŠ¡3ï¼šä»»åŠ¡1å’Œä»»åŠ¡2å®Œæˆåæ‰§è¡Œï¼šæ³¡èŒ¶<br>CompletableFuture f3 = f1.thenCombine(f2, (__, tf)-&gt;{ <br>System.out.println(&quot;T1:æ‹¿åˆ°èŒ¶å¶:&quot; + tf); <br>System.out.println(&quot;T1:æ³¡èŒ¶...&quot;); <br>return &quot;ä¸ŠèŒ¶:&quot; + tf; });<br>(__, tf)è¿™é‡Œ __ æ˜¯ T1 çš„ç»“æœï¼Œ tf åº”è¯¥æ˜¯ T2 çš„ç»“æœï¼Œsout ä¸­åº”è¯¥æ˜¯ T2 æ‹¿åˆ°èŒ¶å¶å§","like_count":0},{"had_liked":false,"id":283998,"user_name":"å¼ ç”³å‚²","can_delete":false,"product_type":"c1","uid":1182372,"ip_address":"","ucode":"22D46BC529BA8A","user_header":"https://static001.geekbang.org/account/avatar/00/12/0a/a4/828a431f.jpg","comment_is_top":false,"comment_ctime":1616033702,"is_pvip":true,"discussion_count":0,"race_medal":2,"score":"1616033702","product_id":100023901,"comment_content":"å…¬å¸çš„é¡¹ç›®ä¸­ï¼Œç»å¸¸åˆ©ç”¨ CompletableFuture è¿›è¡Œå¤§è§„æ¨¡æ‰¹é‡æŸ¥è¯¢ï¼Œé¦–å…ˆå°†å…¥å‚è¿›è¡Œ partitionï¼Œç„¶åä½¿ç”¨ CompletableFuture è¿›è¡Œå¼‚æ­¥å¹¶å‘æŸ¥è¯¢ï¼Œæœ€åç”¨ join èšåˆæŸ¥è¯¢ç»“æœï¼Œæœ¬è´¨ä¸Šå°±æ˜¯ fork-join æ¨¡å¼ã€‚","like_count":0},{"had_liked":false,"id":283574,"user_name":"KK","can_delete":false,"product_type":"c1","uid":1096397,"ip_address":"","ucode":"14C0858C413E00","user_header":"https://static001.geekbang.org/account/avatar/00/10/ba/cd/1f91aa44.jpg","comment_is_top":false,"comment_ctime":1615821783,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1615821783","product_id":100023901,"comment_content":"CompletableFutureæ˜¯å¦å¯ä»¥å®ç°å·¥ä½œæµç±»ä¼¼åŠŸèƒ½ï¼Œæ ¹æ®å‰ä¸€ä¸ªä»»åŠ¡ç»“æœï¼Œåˆ¤æ–­æ˜¯å¦ç»§ç»­ä¸‹ä¸€ä¸ªä»»åŠ¡","like_count":0},{"had_liked":false,"id":278182,"user_name":"æ—…é€”","can_delete":false,"product_type":"c1","uid":1212902,"ip_address":"","ucode":"5022477E8E9441","user_header":"https://static001.geekbang.org/account/avatar/00/12/81/e6/6cafed37.jpg","comment_is_top":false,"comment_ctime":1612791731,"is_pvip":false,"replies":[{"id":"101056","content":"æ²¡æœ‰é—®é¢˜ï¼Œåªæ˜¯å†™å¤šäº†éš¾ä»¥ç†è§£ã€‚å°±åƒéç»“æ„åŒ–ç¨‹åºè®¾è®¡ä¹Ÿæ²¡é—®é¢˜ä¸€æ ·ï¼Œè¿™æ˜¯ä¸ªå·¥ç¨‹é—®é¢˜","user_name":"ä½œè€…å›å¤","user_name_real":"ç‹å®ä»¤","uid":"1269969","ctime":1612868639,"ip_address":"","comment_id":278182,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1612791731","product_id":100023901,"comment_content":"è€å¸ˆ é—®ä¸€ä¸‹å…³äºå›è°ƒåœ°ç‹±çš„é—®é¢˜ ,å›è°ƒå’Œæ­£å¸¸é¢å‘è¿‡ç¨‹è°ƒç”¨ä¸éƒ½æ˜¯åµŒå¥—æ–¹æ³•å—ï¼Œä¸ºä»€ä¹ˆå›è°ƒä¼šæœ‰é—®é¢˜","like_count":0,"discussions":[{"author":{"id":1269969,"avatar":"https://static001.geekbang.org/account/avatar/00/13/60/d1/8efa89ab.jpg","nickname":"ç‹å®ä»¤","note":"","ucode":"4FE19F5BC32FCA","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":515306,"discussion_content":"æ²¡æœ‰é—®é¢˜ï¼Œåªæ˜¯å†™å¤šäº†éš¾ä»¥ç†è§£ã€‚å°±åƒéç»“æ„åŒ–ç¨‹åºè®¾è®¡ä¹Ÿæ²¡é—®é¢˜ä¸€æ ·ï¼Œè¿™æ˜¯ä¸ªå·¥ç¨‹é—®é¢˜","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1612868639,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":278041,"user_name":"å¤ç›®ğŸ³","can_delete":false,"product_type":"c1","uid":1101227,"ip_address":"","ucode":"4ED932E1F66F76","user_header":"https://static001.geekbang.org/account/avatar/00/10/cd/ab/1c3dc64b.jpg","comment_is_top":false,"comment_ctime":1612714826,"is_pvip":false,"replies":[{"id":"100949","content":"æˆ‘ä¹Ÿæä¸å®šğŸ˜‚","user_name":"ä½œè€…å›å¤","user_name_real":"ç‹å®ä»¤","uid":"1269969","ctime":1612780972,"ip_address":"","comment_id":278041,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1612714826","product_id":100023901,"comment_content":"è€å¸ˆå¯ä»¥è®²ä¸‹flowAPIå—ï¼Œå·¥ä½œä¸­ä»»åŠ¡è°ƒåº¦ç”¨çš„æ¯”è¾ƒå¤šï½","like_count":0,"discussions":[{"author":{"id":1269969,"avatar":"https://static001.geekbang.org/account/avatar/00/13/60/d1/8efa89ab.jpg","nickname":"ç‹å®ä»¤","note":"","ucode":"4FE19F5BC32FCA","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":515262,"discussion_content":"æˆ‘ä¹Ÿæä¸å®šğŸ˜‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1612780972,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":275225,"user_name":"å–ƒå¯»","can_delete":false,"product_type":"c1","uid":1565085,"ip_address":"","ucode":"E31B3660726671","user_header":"https://static001.geekbang.org/account/avatar/00/17/e1/9d/3ec0adec.jpg","comment_is_top":false,"comment_ctime":1611397764,"is_pvip":false,"discussion_count":0,"race_medal":1,"score":"1611397764","product_id":100023901,"comment_content":"1.æ²¡æœ‰å¤„ç†å¼‚å¸¸<br>2.è¿™éƒ¨åˆ†æ•°æ®åº“æŸ¥è¯¢éœ€è¦æŒ‡å®šçº¿ç¨‹æ± ","like_count":0},{"had_liked":false,"id":274919,"user_name":"æ²«é","can_delete":false,"product_type":"c1","uid":1237305,"ip_address":"","ucode":"2D95C7FDCBEFD5","user_header":"https://static001.geekbang.org/account/avatar/00/12/e1/39/86b611b8.jpg","comment_is_top":false,"comment_ctime":1611218093,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1611218093","product_id":100023901,"comment_content":"å­¦å®Œè¿™ä¸ªæ‰æ„Ÿè§‰å­¦ä¹ RxJavaçš„é‡è¦æ€§ï¼Œä¹‹å‰çœ‹çš„äº‘é‡Œé›¾é‡Œå°±æ”¾å¼ƒäº†ä½¿ç”¨ï¼Œè¦æ‹¿èµ·æ¥äº†","like_count":0},{"had_liked":false,"id":272366,"user_name":"prepared","can_delete":false,"product_type":"c1","uid":1194853,"ip_address":"","ucode":"00E54A5C7CDCBE","user_header":"https://static001.geekbang.org/account/avatar/00/12/3b/65/3a4fc8cf.jpg","comment_is_top":false,"comment_ctime":1610069793,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1610069793","product_id":100023901,"comment_content":"çº¿ç¨‹æ•°=cpuæ ¸æ•°ï¼Œè¿™é‡Œä¸å¯¹ï¼Œåº”è¯¥æ˜¯ï¼ˆcpuæ ¸æ•°-1ï¼‰<br>æŸ¥çœ‹ ForkJoinPoolæºç  makeCommonPool æ–¹æ³•<br>parallelism = Runtime.getRuntime().availableProcessors() - 1<br><br>","like_count":0},{"had_liked":false,"id":265464,"user_name":"Monday","can_delete":false,"product_type":"c1","uid":1250907,"ip_address":"","ucode":"77B9BACC783598","user_header":"https://static001.geekbang.org/account/avatar/00/13/16/5b/83a35681.jpg","comment_is_top":false,"comment_ctime":1606905613,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1606905613","product_id":100023901,"comment_content":"ä»Šå¤©åœ¨å…¬å¸çš„åº“é‡Œçœ‹åˆ°äº†ä½¿ç”¨competablefutureè¿˜æ˜¯æœ‰ç‚¹å°æ¿€åŠ¨çš„","like_count":0},{"had_liked":false,"id":238892,"user_name":"æ¨æ˜¥é¹","can_delete":false,"product_type":"c1","uid":1172056,"ip_address":"","ucode":"518F38232F97B5","user_header":"https://static001.geekbang.org/account/avatar/00/11/e2/58/8c8897c8.jpg","comment_is_top":false,"comment_ctime":1596358245,"is_pvip":false,"discussion_count":1,"race_medal":0,"score":"1596358245","product_id":100023901,"comment_content":"è€å¸ˆï¼Œæˆ‘ç°åœ¨çš„åœºæ™¯æ˜¯3ä¸ªäººä»»åŠ¡æ˜¯å¹¶è¡Œå¤„ç†ï¼Œç­‰å¾…3ä¸ªä»»åŠ¡éƒ½æ‰§è¡ŒæˆåŠŸï¼Œç„¶åæ‰§è¡Œç¬¬4ä¸ªä»»åŠ¡ï¼Œè¿™ä¸ªå¦‚ä½•ä½¿ç”¨ä¸²è¡Œå’Œæ±‡èšæ¥å®ç°å‘¢ã€‚æ±‡èšè²Œä¼¼åªé€‚ç”¨2ä¸ªä»»åŠ¡å¹¶è¡Œå¤„ç†","like_count":0,"discussions":[{"author":{"id":1282819,"avatar":"","nickname":"å°¼ç³¯ç±³","note":"","ucode":"04D1B63F3801AE","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":308391,"discussion_content":"CompletableFuture cf1 = CompletableFuture.runAsync(action, executor);\nCompletableFuture cf2 = CompletableFuture.runAsync(action, executor);\nCompletableFuture cf3 = CompletableFuture.runAsync(action, executor);\nCompletableFuture.allOf(cf1, cf2, cf3).thenRun(action)","likes_number":3,"is_delete":false,"is_hidden":false,"ctime":1600936673,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":227937,"user_name":"Chenj847","can_delete":false,"product_type":"c1","uid":1178468,"ip_address":"","ucode":"9F0FAF9E2CB8EB","user_header":"https://static001.geekbang.org/account/avatar/00/11/fb/64/53f68bdb.jpg","comment_is_top":false,"comment_ctime":1592528609,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1592528609","product_id":100023901,"comment_content":"è€å¸ˆæ‚¨å¥½ï¼Œå¦‚æœæ˜¯jdk1.8å¼‚æ­¥è°ƒç”¨ä½¿ç”¨è‡ªå®šä¹‰çº¿ç¨‹æ± ï¼Œä½†æ˜¯åˆéœ€è¦å¾—åˆ°è¿”å›ç»“æœï¼Œå¦‚æœä½¿ç”¨getç›¸å½“äºåˆé˜»å¡äº†ï¼Œæœ‰æ²¡æœ‰åˆé€‚çš„è§£å†³æ–¹æ¡ˆ","like_count":0},{"had_liked":false,"id":202997,"user_name":"å¥³å·«åœ¨å¯’æ±Ÿ","can_delete":false,"product_type":"c1","uid":1013180,"ip_address":"","ucode":"B3707072224C1C","user_header":"https://static001.geekbang.org/account/avatar/00/0f/75/bc/664bbdf7.jpg","comment_is_top":false,"comment_ctime":1586100144,"is_pvip":true,"discussion_count":0,"race_medal":0,"score":"1586100144","product_id":100023901,"comment_content":"ä»æœ¬è¯¾æåˆ°çš„å†…å®¹æ¥æ£€æŸ¥é—®é¢˜ï¼š<br>1. æ²¡æœ‰å¯¹ä»»åŠ¡è¿›è¡Œåˆ†ç±» å»æŸ¥è¯¢æ•°æ®åº“æ˜¯ä¸ªIOæ¯”è¾ƒæ…¢çš„æ“ä½œï¼Œå¯èƒ½é˜»å¡çº¿ç¨‹æ± <br>2. æ²¡æœ‰è¿›è¡Œå¼‚å¸¸å¤„ç†<br>3.æŸ¥å‡ºæ¥çš„è§„åˆ™ä¸ºç©ºæ—¶ï¼Œæ²¡æœ‰ç›¸åº”å¤„ç†","like_count":0},{"had_liked":false,"id":199497,"user_name":"å­Ÿä»¤è¶…","can_delete":false,"product_type":"c1","uid":1433609,"ip_address":"","ucode":"37916911C0F9D9","user_header":"https://static001.geekbang.org/account/avatar/00/15/e0/09/eb3da11d.jpg","comment_is_top":false,"comment_ctime":1585490226,"is_pvip":false,"replies":[{"id":"76114","content":"å»ºè®®è‡ªå·±æ’¸ä¸€éï¼Œè¿™æ ·çš„æ”¶è·æ˜¯ä¸ä¸€æ ·çš„","user_name":"ä½œè€…å›å¤","user_name_real":"ç‹å®ä»¤","uid":"1269969","ctime":1586257504,"ip_address":"","comment_id":199497,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1585490226","product_id":100023901,"comment_content":"è€å¸ˆè¯¾ç¨‹ä»£ç èƒ½å…¬å¼€ä¸‹å—","like_count":0,"discussions":[{"author":{"id":1269969,"avatar":"https://static001.geekbang.org/account/avatar/00/13/60/d1/8efa89ab.jpg","nickname":"ç‹å®ä»¤","note":"","ucode":"4FE19F5BC32FCA","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":489840,"discussion_content":"å»ºè®®è‡ªå·±æ’¸ä¸€éï¼Œè¿™æ ·çš„æ”¶è·æ˜¯ä¸ä¸€æ ·çš„","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1586257504,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":190983,"user_name":"å—å±±","can_delete":false,"product_type":"c1","uid":1119593,"ip_address":"","ucode":"94656FE4A6C378","user_header":"https://static001.geekbang.org/account/avatar/00/11/15/69/187b9968.jpg","comment_is_top":false,"comment_ctime":1584715765,"is_pvip":true,"discussion_count":0,"race_medal":0,"score":"1584715765","product_id":100023901,"comment_content":"æ¸©æ•…è€ŒçŸ¥æ–°ï¼Œæ¯æ¬¡çœ‹éƒ½è§‰å¾—æ¯”ä¸Šä¸€æ¬¡æ¸…æ™°å¾ˆå¤š","like_count":0},{"had_liked":false,"id":187644,"user_name":"wking","can_delete":false,"product_type":"c1","uid":1294634,"ip_address":"","ucode":"47D52E4280D1E6","user_header":"https://static001.geekbang.org/account/avatar/00/13/c1/2a/e7102065.jpg","comment_is_top":false,"comment_ctime":1584180693,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1584180693","product_id":100023901,"comment_content":"è€å¸ˆï¼Œè¯·é—®ä¸€ä¸‹ï¼Œè¯»æ•°æ®åº“æ“ä½œä¸ºä»€ä¹ˆè¦æ”¾åœ¨çº¿ç¨‹æ± é‡Œé¢ï¼Ÿ","like_count":0},{"had_liked":false,"id":182724,"user_name":"é˜¿æ‹‰ä¸ç¯","can_delete":false,"product_type":"c1","uid":1277094,"ip_address":"","ucode":"59664187E74917","user_header":"https://static001.geekbang.org/account/avatar/00/13/7c/a6/93a0f6f8.jpg","comment_is_top":false,"comment_ctime":1582856089,"is_pvip":false,"discussion_count":4,"race_medal":0,"score":"1582856089","product_id":100023901,"comment_content":"&#47;&#47;ä»»åŠ¡3ï¼šä»»åŠ¡1å’Œä»»åŠ¡2å®Œæˆåæ‰§è¡Œï¼šæ³¡èŒ¶CompletableFuture f3 = f1.thenCombine(f2, (__, tf)-&gt;{ System.out.println(&quot;T1:æ‹¿åˆ°èŒ¶å¶:&quot; + tf); System.out.println(&quot;T1:æ³¡èŒ¶...&quot;); return &quot;ä¸ŠèŒ¶:&quot; + tf; });<br>è¯·é—®f2çš„è¿”å›å€¼â€˜é¾™äº•â€™ä¸ºå•¥ä¼ ç»™äº†tfï¼Œè€Œä¸æ˜¯__è¿™ä¸ªå˜é‡å‘¢ï¼Ÿ","like_count":0,"discussions":[{"author":{"id":1189580,"avatar":"https://static001.geekbang.org/account/avatar/00/12/26/cc/719aec6d.jpg","nickname":"24","note":"","ucode":"F09DF49B6254E8","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":365736,"discussion_content":"æˆ‘è§‰å¾—æ˜¯è€å¸ˆå†™é”™äº†","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1617872514,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1613123,"avatar":"https://static001.geekbang.org/account/avatar/00/18/9d/43/bf628743.jpg","nickname":"Cyber","note":"","ucode":"A7842494F57D0C","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":296008,"discussion_content":"CompletableFuture<String> f3 = f1.thenCombine(f2, (t1, tf)->{      t1:f1çš„è¿”å›å€¼ï¼Œtf:f2çš„è¿”å›å€¼","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1596425716,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1613123,"avatar":"https://static001.geekbang.org/account/avatar/00/18/9d/43/bf628743.jpg","nickname":"Cyber","note":"","ucode":"A7842494F57D0C","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":296007,"discussion_content":"public class CompletableFutureDemo {\n\t\n\tpublic static void main(String[] args) {\n//\t\t// ä»»åŠ¡1ï¼šæ´—æ°´å£¶->çƒ§å¼€æ°´\n//\t\tCompletableFuture<Void> f1 = CompletableFuture.runAsync(() -> {\n//\t\t\tSystem.out.println(&#34;T1:æ´—æ°´å£¶...&#34;);\n//\t\t\tsleep(1, TimeUnit.SECONDS);\n//\n//\t\t\tSystem.out.println(&#34;T1:çƒ§å¼€æ°´...&#34;);\n//\t\t\tsleep(15, TimeUnit.SECONDS);\n//\t\t});\n\t\t\n\t\tCompletableFuture<String> f1 = CompletableFuture.supplyAsync(() -> {\n\t\t\tSystem.out.println(&#34;T1:æ´—æ°´å£¶...&#34;);\n\t\t\tsleep(1, TimeUnit.SECONDS);\n\n\t\t\tSystem.out.println(&#34;T1:çƒ§å¼€æ°´...&#34;);\n\t\t\tsleep(10, TimeUnit.SECONDS);\n\t\t\t\n\t\t\treturn &#34;fsds&#34;;\n\t\t});\n\n\t\t// ä»»åŠ¡2ï¼šæ´—èŒ¶å£¶->æ´—èŒ¶æ¯->æ‹¿èŒ¶å¶\n\t\tCompletableFuture<String> f2 = CompletableFuture.supplyAsync(() -> {\n\t\t\tSystem.out.println(&#34;T2:æ´—èŒ¶å£¶...&#34;);\n\t\t\tsleep(1, TimeUnit.SECONDS);\n\n\t\t\tSystem.out.println(&#34;T2:æ´—èŒ¶æ¯...&#34;);\n\t\t\tsleep(2, TimeUnit.SECONDS);\n\n\t\t\tSystem.out.println(&#34;T2:æ‹¿èŒ¶å¶...&#34;);\n\t\t\tsleep(1, TimeUnit.SECONDS);\n\t\t\treturn &#34;é¾™äº•&#34;;\n\t\t});\n\t\t\n\t\t//ä»»åŠ¡3ï¼šä»»åŠ¡1å’Œä»»åŠ¡2å®Œæˆåæ‰§è¡Œï¼šæ³¡èŒ¶    ç”¨ä¸‹åˆ’çº¿è¡¨ç¤ºä¸ç”¨çš„å‚æ•°  t1:f1çš„è¿”å›å€¼ï¼Œtfä»£è¡¨f2çš„è¿”å›å€¼\n\t\tCompletableFuture<String> f3 = f1.thenCombine(f2, (t1, tf)->{\n\t\t\t\n\t\t\tSystem.out.println(&#34;t1:&#34; + t1);\n\t\t    System.out.println(&#34;T1:æ‹¿åˆ°èŒ¶å¶:&#34; + tf);\n\t\t    System.out.println(&#34;T1:æ³¡èŒ¶...&#34;);\n\t\t    return &#34;ä¸ŠèŒ¶:&#34; + tf;\n\t\t  });\n\t\t\n\t\t//ç­‰å¾…ä»»åŠ¡3æ‰§è¡Œç»“æœ\n\t\tSystem.out.println(f3.join());\n\t}\n\n\t\n\t\n\t\n\t\n\t\n\n\tstatic void sleep(int t, TimeUnit u) {\n\t\ttry {\n\t\t\tu.sleep(t);\n\t\t} catch (InterruptedException e) {\n\t\t}\n\t}\n\n}\n\n\nT1:æ´—æ°´å£¶...\nT2:æ´—èŒ¶å£¶...\nT2:æ´—èŒ¶æ¯...\nT1:çƒ§å¼€æ°´...\nT2:æ‹¿èŒ¶å¶...\nt1:fsds\nT1:æ‹¿åˆ°èŒ¶å¶:é¾™äº•\nT1:æ³¡èŒ¶...\nä¸ŠèŒ¶:é¾™äº•","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1596425673,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1613123,"avatar":"https://static001.geekbang.org/account/avatar/00/18/9d/43/bf628743.jpg","nickname":"Cyber","note":"","ucode":"A7842494F57D0C","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":296005,"discussion_content":"åŒé—®","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1596424989,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":162677,"user_name":"æ±Ÿæ¥ å¤§ç›—","can_delete":false,"product_type":"c1","uid":1241197,"ip_address":"","ucode":"D242C5EF70C176","user_header":"http://thirdwx.qlogo.cn/mmopen/vi_32/DYAIOgq83eo5vic8QksE4b8ricXxKrEWJyOX9pwiadhk3kvHYoLXoKRTWvbFCxibFTbExNQWDG4nvNfpic9t1umibKww/132","comment_is_top":false,"comment_ctime":1576576718,"is_pvip":true,"replies":[{"id":"62404","content":"ç›®å‰çš„ä¸Šä¸‹æ–‡ï¼Œæˆ‘ä¹Ÿç†è§£ä¸äº†ğŸ˜‚","user_name":"ä½œè€…å›å¤","user_name_real":"ç‹å®ä»¤","uid":"1269969","ctime":1576910658,"ip_address":"","comment_id":162677,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1576576718","product_id":100023901,"comment_content":"ç‹è€å¸ˆå¥½ï¼Œå…¶ä»–åœ°æ–¹çœ‹åˆ°è¯´å¼‚æ­¥ IO ä¸»è¦æ˜¯ä¸ºäº†æ§åˆ¶çº¿ç¨‹æ•°é‡ï¼Œè¯·é—®æ€ä¹ˆç†è§£ï¼Ÿ","like_count":0,"discussions":[{"author":{"id":1269969,"avatar":"https://static001.geekbang.org/account/avatar/00/13/60/d1/8efa89ab.jpg","nickname":"ç‹å®ä»¤","note":"","ucode":"4FE19F5BC32FCA","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":478123,"discussion_content":"ç›®å‰çš„ä¸Šä¸‹æ–‡ï¼Œæˆ‘ä¹Ÿç†è§£ä¸äº†ğŸ˜‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1576910658,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":135877,"user_name":"Sharry","can_delete":false,"product_type":"c1","uid":1239293,"ip_address":"","ucode":"045DDB864659F6","user_header":"https://static001.geekbang.org/account/avatar/00/12/e8/fd/035f4c94.jpg","comment_is_top":false,"comment_ctime":1569291768,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1569291768","product_id":100023901,"comment_content":"æ˜¯çš„, RxJava å·²ç»æ˜¯ Android å¼€å‘è€…å¿…ä¸å¯å°‘çš„ä¸€ä¸ªåº“äº†","like_count":0},{"had_liked":false,"id":133468,"user_name":"é™æ°´æµæ·±","can_delete":false,"product_type":"c1","uid":1339724,"ip_address":"","ucode":"644F05EFBD2E7B","user_header":"https://static001.geekbang.org/account/avatar/00/14/71/4c/2cefec07.jpg","comment_is_top":false,"comment_ctime":1568589511,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1568589511","product_id":100023901,"comment_content":"both-&gt;and,either-&gt;or","like_count":0},{"had_liked":false,"id":131338,"user_name":"éšå¿ƒè€Œè‡³","can_delete":false,"product_type":"c1","uid":1097836,"ip_address":"","ucode":"31866865255101","user_header":"https://static001.geekbang.org/account/avatar/00/10/c0/6c/29be1864.jpg","comment_is_top":false,"comment_ctime":1567727977,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1567727977","product_id":100023901,"comment_content":"æƒ³è¦ç”¨å¥½è¿˜æ˜¯è¦çœ‹çœ‹æºç å®ç°","like_count":0},{"had_liked":false,"id":129323,"user_name":"Mr.zhang","can_delete":false,"product_type":"c1","uid":1503968,"ip_address":"","ucode":"52BEF6493C3444","user_header":"https://static001.geekbang.org/account/avatar/00/16/f2/e0/9577744e.jpg","comment_is_top":false,"comment_ctime":1567088345,"is_pvip":false,"replies":[{"id":"48175","content":"Javaé‡Œçš„lambdaè¡¨è¾¾å¼","user_name":"ä½œè€…å›å¤","user_name_real":"ç‹å®ä»¤","uid":"1269969","ctime":1567127748,"ip_address":"","comment_id":129323,"utype":1}],"discussion_count":6,"race_medal":0,"score":"1567088345","product_id":100023901,"comment_content":"è€å¸ˆæ‚¨å¥½ï¼Œæˆ‘æƒ³è¯·é—®ä¸€ä¸‹ï¼š(__, tf)-&gt;{ }ï¼Œè¿™æ˜¯ä¸€ç§ä»€ä¹ˆç”¨æ³•å‘¢ï¼Ÿæ‹¬å·ä¸­çš„__æ˜¯ä»€ä¹ˆæ„æ€å‘¢ï¼Ÿ","like_count":0,"discussions":[{"author":{"id":1269969,"avatar":"https://static001.geekbang.org/account/avatar/00/13/60/d1/8efa89ab.jpg","nickname":"ç‹å®ä»¤","note":"","ucode":"4FE19F5BC32FCA","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":465400,"discussion_content":"Javaé‡Œçš„lambdaè¡¨è¾¾å¼","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1567127748,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1503968,"avatar":"https://static001.geekbang.org/account/avatar/00/16/f2/e0/9577744e.jpg","nickname":"Mr.zhang","note":"","ucode":"52BEF6493C3444","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":6817,"discussion_content":"æ•´ä½“æˆ‘çŸ¥é“æ˜¯ä¸€ä¸ªlambdaè¡¨è¾¾å¼ï¼Œæˆ‘å¯¹å…¶ä¸­çš„åŒä¸‹åˆ’çº¿å‚æ•°æ¯”è¾ƒå¥½å¥‡ï¼Œæˆ‘debugå‡ºæ¥ä¹‹åæ˜¯ä¸ªç©ºå­—ç¬¦ä¸²ï¼Œæˆ‘æŠŠåŒä¸‹åˆ’çº¿æ›¿æ¢æˆï¼šaaï¼Œbbä¹‹ç±»çš„ï¼Œè¿è¡Œæ˜¯å¹¶æ²¡æœ‰ä»€ä¹ˆåŒºåˆ«ã€‚é‚£æˆ‘åº”è¯¥æ€ä¹ˆç†è§£è¿™ä¸ªåŒä¸‹åˆ’çº¿å‚æ•°å‘¢ï¼Ÿæ˜¯æŠŠå®ƒå½“åšä¸aa,bbæ­¤ç±»åŒæ ·çš„å‚æ•°å˜é‡åå—ï¼Ÿè°¢è°¢è€å¸ˆ","likes_number":1,"is_delete":false,"is_hidden":false,"ctime":1567128966,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":3,"child_discussions":[{"author":{"id":1217874,"avatar":"https://static001.geekbang.org/account/avatar/00/12/95/52/ad190682.jpg","nickname":"Mr wind","note":"","ucode":"484F02D1962239","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":1503968,"avatar":"https://static001.geekbang.org/account/avatar/00/16/f2/e0/9577744e.jpg","nickname":"Mr.zhang","note":"","ucode":"52BEF6493C3444","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":138156,"discussion_content":"å¯ä»¥å½“æˆä¸€æ ·çš„ï¼Œå› ä¸ºå®ƒåªæ˜¯ä½ èµ·çš„ä¸€ä¸ªå˜é‡åï¼Œjvmä¼šè‡ªå·±åšç±»å‹æ¨æ–­","likes_number":1,"is_delete":false,"is_hidden":false,"ctime":1579226182,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":6817,"ip_address":""},"score":138156,"extra":""},{"author":{"id":1579698,"avatar":"","nickname":"wangwe","note":"","ucode":"24F9574044565D","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":1503968,"avatar":"https://static001.geekbang.org/account/avatar/00/16/f2/e0/9577744e.jpg","nickname":"Mr.zhang","note":"","ucode":"52BEF6493C3444","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":213850,"discussion_content":"æˆ‘çŒœæ˜¯å› ä¸ºè¿™ä¸ªå˜é‡æ²¡æœ‰ç”¨åˆ°ï¼Œä¸çŸ¥é“èµ·ä»€ä¹ˆåå­—åˆé€‚ï¼Œæ‰€ä»¥å†™äº†ä¸¤ä¸ªä¸‹åˆ’çº¿ã€‚","likes_number":3,"is_delete":false,"is_hidden":false,"ctime":1585127744,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":6817,"ip_address":""},"score":213850,"extra":""},{"author":{"id":1189580,"avatar":"https://static001.geekbang.org/account/avatar/00/12/26/cc/719aec6d.jpg","nickname":"24","note":"","ucode":"F09DF49B6254E8","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":1579698,"avatar":"","nickname":"wangwe","note":"","ucode":"24F9574044565D","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":365737,"discussion_content":"æˆ‘è§‰å¾—æ˜¯ T1 çš„è¿”å›æ˜¯ Void ç±»å‹ï¼Œè¿™ä¸ªå˜é‡ç”¨ __ è¡¨ç¤ºæ¯”è¾ƒæ˜¾è‘—","likes_number":1,"is_delete":false,"is_hidden":false,"ctime":1617872756,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":213850,"ip_address":""},"score":365737,"extra":""}]},{"author":{"id":1529210,"avatar":"https://static001.geekbang.org/account/avatar/00/17/55/7a/d44df1d6.jpg","nickname":"freesocean","note":"","ucode":"CAD4C80CF569D3","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":577823,"discussion_content":"è¯•äº†ä¸‹ï¼Œjavaå˜é‡å‘½åå…è®¸ä»¥ä¸‹åˆ’çº¿ï¼Œå­—æ¯ï¼Œ$å¼€å¤´ï¼Œè¿™é‡Œå…¶å®å°±æ˜¯ä¸ªå˜é‡åï¼Œåªæ˜¯å˜é‡è¿”å›å€¼ä¸ºç©ºï¼Œç”¨__è¡¨ç¤ºä¸å¯ç”¨å‚æ•°ï¼Œå¯è¯»æ€§å¥½","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1656375938,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":123928,"user_name":"null","can_delete":false,"product_type":"c1","uid":1024294,"ip_address":"","ucode":"F9039EFED6B55D","user_header":"http://thirdwx.qlogo.cn/mmopen/vi_32/PiajxSqBRaELZPnUAiajaR5C25EDLWeJURggyiaOP5GGPe2qlwpQcm5e3ybib8OsP4tvddFDLVRSNNGL5I3SFPJHsA/132","comment_is_top":false,"comment_ctime":1565782296,"is_pvip":false,"discussion_count":2,"race_medal":0,"score":"1565782296","product_id":100023901,"comment_content":"è€å¸ˆï¼Œæ‚¨å¥½ï¼<br>è¯·æ•™ä¸€ä¸‹ï¼Œå¦‚ä½• combine å¤šä¸ª CompletableFutureï¼Œå¹¶ä¸”è·å–åˆå¹¶ä¹‹åçš„ç»“æœå‘€ï¼Ÿ<br>é™¤äº†ä¸‹é¢çš„å®ç°ï¼Œä¸çŸ¥é“è¿˜æœ‰æ²¡æœ‰æ›´ä¼˜é›…çš„å®ç°æ–¹å¼å‘¢ï¼Ÿ<br>è°¢è°¢è€å¸ˆï¼<br><br>----<br><br>public static void main(String[] args) {<br>  CompletableFuture&lt;String&gt; future1 = CompletableFuture.supplyAsync(() -&gt; {<br>    sleep(5000);<br>    return &quot;Hello&quot;;<br>  });<br>  CompletableFuture&lt;String&gt; future2 = CompletableFuture.supplyAsync(() -&gt; {<br>    sleep(8000);<br>    return &quot;Beautiful&quot;;<br>  });<br>  CompletableFuture&lt;String&gt; future3 = CompletableFuture.supplyAsync(() -&gt; {<br>    sleep(1000);<br>    return &quot;World&quot;;<br>  });<br><br>  &#47;&#47; CompletableFuture&lt;Void&gt; combinedFuture = CompletableFuture.allOf(future1, future2, future3);<br><br>  &#47;&#47; æ–¹å¼ä¸€<br>  String combine = future1.thenCombine(future2, (s1, s2) -&gt; s1 + &quot;,&quot; + s2)<br>                          .thenCombine(future3, (s1, s2) -&gt; s1 + &quot;,&quot; + s2)<br>                          .exceptionally(throwable -&gt; &quot;&quot;)<br>                          .join();<br>  System.out.println(combine);<br><br>  &#47;&#47; æ–¹å¼äºŒ<br>  List&lt;CompletableFuture&lt;String&gt;&gt; list = new ArrayList&lt;&gt;(3);<br>  list.add(future1);<br>  list.add(future2);<br>  list.add(future3);<br><br>  StringBuilder sb = new StringBuilder();<br>  for (CompletableFuture&lt;String&gt; future : list) {<br>    if (sb.length() &gt; 0) {<br>      sb.append(&quot;,&quot;);<br>    }<br>    sb.append(future.join());<br>  }<br>  System.out.println(sb.toString());<br>}","like_count":0,"discussions":[{"author":{"id":1351012,"avatar":"https://static001.geekbang.org/account/avatar/00/14/9d/64/272dc1b7.jpg","nickname":"åœ†æ»šæ»š","note":"","ucode":"E4D81822A87D50","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":75625,"discussion_content":"è¿™ä¸ªæµç¨‹å’Œæƒ³è¦è¾¾åˆ°çš„è¿˜æ˜¯ä¸ä¸€è‡´","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1575735444,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1351012,"avatar":"https://static001.geekbang.org/account/avatar/00/14/9d/64/272dc1b7.jpg","nickname":"åœ†æ»šæ»š","note":"","ucode":"E4D81822A87D50","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":75624,"discussion_content":"æƒ³çŸ¥é“","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1575735408,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":115021,"user_name":"null","can_delete":false,"product_type":"c1","uid":1024294,"ip_address":"","ucode":"F9039EFED6B55D","user_header":"http://thirdwx.qlogo.cn/mmopen/vi_32/PiajxSqBRaELZPnUAiajaR5C25EDLWeJURggyiaOP5GGPe2qlwpQcm5e3ybib8OsP4tvddFDLVRSNNGL5I3SFPJHsA/132","comment_is_top":false,"comment_ctime":1563454861,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1563454861","product_id":100023901,"comment_content":"è€å¸ˆï¼Œæ‚¨å¥½ï¼<br>æ–‡ä¸­æåˆ°ï¼šthenCompose ç³»åˆ—æ–¹æ³•ä¼šæ–°åˆ›å»ºå‡ºä¸€ä¸ªå­æµç¨‹ï¼Œæœ€ç»ˆç»“æœå’Œ thenApply ç³»åˆ—æ˜¯ç›¸åŒçš„ã€‚<br><br>thenCompose å’Œ thenApply æœ€ç»ˆæ‰§è¡Œæ•ˆæœä¸€æ ·ï¼Œåœ¨å®é™…ä½¿ç”¨ä¸­æœ‰ä»€ä¹ˆåŒºåˆ«ï¼Œæˆ–è€…è¯´åˆ›å»ºå­æµç¨‹ï¼Œè¿™ä¹ˆè®¾è®¡çš„ç›®çš„æ˜¯å•¥ï¼Ÿ<br><br>è°¢è°¢è€å¸ˆï¼ï¼","like_count":0},{"had_liked":false,"id":95859,"user_name":"å¤§å«","can_delete":false,"product_type":"c1","uid":1019127,"ip_address":"","ucode":"D861709E483793","user_header":"https://static001.geekbang.org/account/avatar/00/0f/8c/f7/a4de6f64.jpg","comment_is_top":false,"comment_ctime":1558234615,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1558234615","product_id":100023901,"comment_content":"ç‹è€å¸ˆï¼Œæ‚¨å¥½ã€‚<br>ç›®å‰ä¸šåŠ¡åœºæ™¯æˆ‘è§‰å¾—é€‚åˆç”¨completablefutureï¼Œä¸€ä¸ªè¯¦æƒ…é¡µï¼ŒåŠ¨æ€æ¥å£ï¼Œä¼šè°ƒç”¨å¤šä¸ªä¸Šæ¸¸æ¥å£åšèšåˆï¼Œéƒ¨åˆ†æ¥å£ä¹‹é—´æœ‰ä¾èµ–ã€‚<br>è¿™äº›ä¸Šæ¸¸åˆ†åˆ«æ˜¯ä¸åŒä¸šåŠ¡çº¿çš„ï¼Œæ¯”å¦‚æœç´¢ã€æ¨èã€ä¼šå‘˜ã€ç”¨æˆ·ã€å…¶ä»–ç­‰ã€‚<br>é—®é¢˜1:æ‚¨å»ºè®®æ˜¯æ¯ä¸ªä¸šåŠ¡çº¿éƒ½æ˜¯è¦å»ºç«‹ç‹¬ç«‹çš„çº¿ç¨‹æ± ï¼Ÿè¿˜æ˜¯è¯´å‡ ä¸ªä¸šåŠ¡çº¿ä¸€ä¸ªçº¿ç¨‹æ± ?  <br>é—®é¢˜2:è¿™ç§ä¸€èˆ¬æ˜¯è¦æŒ‰ioå¯†é›†å‹è®¾ç½®cpuå¤§å°å§ï¼Œcpuæ ¸æ•° *ï¼ˆ1-0.9ï¼‰ï¼Œå‚è€ƒç½‘ä¸Šçš„0.9é˜»å¡ç³»æ•°ï¼Œåˆé€‚ä¹ˆ? <br>é—®é¢˜3:æ¯ä¸ªä¸šåŠ¡ç‹¬ç«‹çº¿ç¨‹æ± ï¼ŒåŒä¸€ä¸ªjvmä¸­ä¼šä¸ä¼šçº¿ç¨‹æ•°é‡å¤ªå¤§äº†ï¼Œæœ‰ä»€ä¹ˆé¢å¤–å½±å“å—?<br><br>è°¢è°¢","like_count":0},{"had_liked":false,"id":94688,"user_name":"xuery","can_delete":false,"product_type":"c1","uid":1027584,"ip_address":"","ucode":"F461B61BE06131","user_header":"https://static001.geekbang.org/account/avatar/00/0f/ae/00/025f37e7.jpg","comment_is_top":false,"comment_ctime":1557882344,"is_pvip":true,"discussion_count":0,"race_medal":0,"score":"1557882344","product_id":100023901,"comment_content":"Completableä½¿ç”¨æ³¨æ„äº‹é¡¹ï¼š1.ä¸åŒçš„ä¸šåŠ¡åœºæ™¯æœ€å¥½æŒ‡å®šå•ç‹¬çš„çº¿ç¨‹æ± ï¼Œé¿å…ç›¸äº’å½±å“<br>2.è®°å¾—è€ƒè™‘å¼‚å¸¸å¤„ç†<br>","like_count":0},{"had_liked":false,"id":90664,"user_name":"Sunqc","can_delete":false,"product_type":"c1","uid":1473717,"ip_address":"","ucode":"2C54659635403F","user_header":"https://static001.geekbang.org/account/avatar/00/16/7c/b5/4a7a2bd4.jpg","comment_is_top":false,"comment_ctime":1556604226,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1556604226","product_id":100023901,"comment_content":"è¯„è®ºåŒºé‚£ä¸ªä»å¤šå¼ è¡¨æŸ¥æ•°æ®ç„¶åéªŒè¯ä¿å­˜åˆ°ä¸€å¼ è¡¨ã€‚åˆ†é¡µæ¯æ¬¡æ¬¡è¯»1000æ¡æ•°æ®çš„è¯<br>1.é‡‡ç”¨çº¿ç¨‹æ± +futureï¼Œæ¯æ¬¡æäº¤çš„ä»»åŠ¡ç»“æœä¿å­˜åˆ°ä¸€ä¸ªé˜Ÿåˆ—é‡Œï¼Œç„¶åæ‰§è¡Œä»»åŠ¡å–é˜Ÿåˆ—ç»“æœæ‰§è¡Œä¿å­˜ï¼›æˆ–è€…ä¸é‡‡ç”¨é˜Ÿåˆ—<br>2.é‡‡ç”¨completionservice<br>3.å°±æ˜¯è¿™èŠ‚çš„ä¸»é¢˜completionfuture<br><br>è€å¸ˆï¼Œæ‚¨çœ‹é‡ç‚¹å‰ä¸¤ä¸ªæ–¹æ¡ˆå¯è¡Œå—ï¼Œcompelerionå¤„ç†æ‰¹é‡æ“ä½œï¼Œä¼šä¸ä¼šå¤§æå°ç”¨çš„æ„Ÿè§‰å•Šå“ˆå“ˆ<br>è¿™ä¸ªçº¿ç¨‹æ± é‡Œçº¿ç¨‹æ•°å¤šå¤§æ‰åˆé€‚å‘¢","like_count":0},{"had_liked":false,"id":90290,"user_name":"aroll","can_delete":false,"product_type":"c1","uid":1023524,"ip_address":"","ucode":"3A1A1267C88CC3","user_header":"https://static001.geekbang.org/account/avatar/00/0f/9e/24/0d6a7987.jpg","comment_is_top":false,"comment_ctime":1556467267,"is_pvip":false,"replies":[{"id":"32350","content":"æ‰¾åˆ°åŸå› å°±å¥½","user_name":"ä½œè€…å›å¤","user_name_real":"ç‹å®ä»¤","uid":"1269969","ctime":1556498572,"ip_address":"","comment_id":90290,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1556467267","product_id":100023901,"comment_content":"å—¯å¯¹ï¼Œæˆ‘ä»¥logçš„æ‰“å°ä¸ºå‡†äº†ï¼Œlogæ‰“å°ç»“æŸå¹¶ä¸ä»£è¡¨ä¸»çº¿ç¨‹å·²ç»ç»“æŸäº†ï¼Œè¿˜æ˜¯æœ‰ä¸ªæ—¶é—´å·®ï¼Œè¿™ä¸ªæ—¶å€™å­çº¿ç¨‹è¿˜ä¼šè¿è¡Œä¸€æ®µæ—¶é—´ï¼Œæ„Ÿè°¢è€å¸ˆ","like_count":0,"discussions":[{"author":{"id":1269969,"avatar":"https://static001.geekbang.org/account/avatar/00/13/60/d1/8efa89ab.jpg","nickname":"ç‹å®ä»¤","note":"","ucode":"4FE19F5BC32FCA","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":448455,"discussion_content":"æ‰¾åˆ°åŸå› å°±å¥½","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1556498572,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":89963,"user_name":"aroll","can_delete":false,"product_type":"c1","uid":1023524,"ip_address":"","ucode":"3A1A1267C88CC3","user_header":"https://static001.geekbang.org/account/avatar/00/0f/9e/24/0d6a7987.jpg","comment_is_top":false,"comment_ctime":1556350136,"is_pvip":false,"replies":[{"id":"32330","content":"æˆ‘æŠŠsleepéƒ¨åˆ†å»æ‰ï¼Œforæ”¹æˆwhile trueï¼Œä¸»çº¿ç¨‹ç»“æŸï¼Œå­çº¿ç¨‹è¿˜æ˜¯èƒ½ç»“æŸçš„ã€‚æ˜¯ä¸æ˜¯logçš„é”…ï¼Ÿ","user_name":"ä½œè€…å›å¤","user_name_real":"ç‹å®ä»¤","uid":"1269969","ctime":1556463208,"ip_address":"","comment_id":89963,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1556350136","product_id":100023901,"comment_content":"æ˜¯çš„ï¼Œå¯åŠ¨å‰è®¾ç½®æˆå®ˆæŠ¤çº¿ç¨‹äº†ï¼Œå°±åƒè¿™æ ·<br>public static void main(String[] args){<br>    Thread thread = new Thread(new Runnable() {<br>        @Override<br>        public void run() {<br>             for(int i=0;i&lt;10;i++){<br>                 try {<br>                     Thread.sleep(1);<br>                 } catch (InterruptedException e) {<br>                     e.printStackTrace();<br>                 }<br>                 log.info(&quot;å­çº¿ç¨‹æ‰§è¡Œä»»åŠ¡&quot;+i);<br>             }<br>        }<br>    });<br>    thread.setDaemon(true);<br>    thread.start();<br>    for (int j=0;j&lt;3;j++){<br>        log.info(&quot;ä¸»çº¿ç¨‹æ‰§è¡Œä»»åŠ¡&quot;+j);<br>    }<br>    log.info(&quot;è¿è¡Œç»“æŸ&quot;);<br>}<br>    å¦‚æœæŠŠsleepéƒ¨åˆ†å»æ‰ï¼Œå³ä½¿è®¾æˆå®ˆæŠ¤çº¿ç¨‹ï¼Œä¸»çº¿ç¨‹ç»“æŸåå­çº¿ç¨‹ä»ä¸ä¼šç»“æŸ","like_count":0,"discussions":[{"author":{"id":1269969,"avatar":"https://static001.geekbang.org/account/avatar/00/13/60/d1/8efa89ab.jpg","nickname":"ç‹å®ä»¤","note":"","ucode":"4FE19F5BC32FCA","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":448339,"discussion_content":"æˆ‘æŠŠsleepéƒ¨åˆ†å»æ‰ï¼Œforæ”¹æˆwhile trueï¼Œä¸»çº¿ç¨‹ç»“æŸï¼Œå­çº¿ç¨‹è¿˜æ˜¯èƒ½ç»“æŸçš„ã€‚æ˜¯ä¸æ˜¯logçš„é”…ï¼Ÿ","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1556463208,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":89731,"user_name":"aroll","can_delete":false,"product_type":"c1","uid":1023524,"ip_address":"","ucode":"3A1A1267C88CC3","user_header":"https://static001.geekbang.org/account/avatar/00/0f/9e/24/0d6a7987.jpg","comment_is_top":false,"comment_ctime":1556251168,"is_pvip":false,"replies":[{"id":"32183","content":"å¯åŠ¨ä¹‹å‰è®¾ç½®æˆå®ˆæŠ¤çº¿ç¨‹äº†ï¼Ÿ","user_name":"ä½œè€…å›å¤","user_name_real":"ç‹å®ä»¤","uid":"1269969","ctime":1556280844,"ip_address":"","comment_id":89731,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1556251168","product_id":100023901,"comment_content":"è€å¸ˆæƒ³è¯·æ•™æ‚¨ä¸€ä¸ªé—®é¢˜ï¼Œæˆ‘åˆ›å»ºäº†ä¸€ä¸ªç”¨æˆ·çº¿ç¨‹ç„¶åå°†å®ƒè®¾ç½®ä¸ºå®ˆæŠ¤çº¿ç¨‹ï¼Œä¸ºä»€ä¹ˆä¸»çº¿ç¨‹ç»“æŸæ—¶ï¼Œå®ƒæ²¡æœ‰ç»“æŸï¼Œéœ€è¦åœ¨å®ƒçš„æ‰§è¡Œé€»è¾‘é‡Œè°ƒç”¨sleepæ‰ä¼šå½“ä¸»çº¿ç¨‹ç»“æŸæ—¶ç»“æŸã€‚","like_count":0,"discussions":[{"author":{"id":1269969,"avatar":"https://static001.geekbang.org/account/avatar/00/13/60/d1/8efa89ab.jpg","nickname":"ç‹å®ä»¤","note":"","ucode":"4FE19F5BC32FCA","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":448240,"discussion_content":"å¯åŠ¨ä¹‹å‰è®¾ç½®æˆå®ˆæŠ¤çº¿ç¨‹äº†ï¼Ÿ","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1556280844,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":89324,"user_name":"å¤šè¥„ä¸¸","can_delete":false,"product_type":"c1","uid":1074310,"ip_address":"","ucode":"1AA1497C5A293C","user_header":"https://static001.geekbang.org/account/avatar/00/10/64/86/f5a9403a.jpg","comment_is_top":false,"comment_ctime":1556154697,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1556154697","product_id":100023901,"comment_content":"å¾ˆå–œæ¬¢è¿™ä¸ªä¸“æ !<br><br>ä½†æ˜¯ï¼Œè€å¸ˆè¯´ æ•™å¥½å­¦ç”Ÿï¼Œé¥¿æ­»å¸ˆå‚…ã€‚ æˆ‘â€¦â€¦ğŸ˜­ğŸ˜­ğŸ˜­","like_count":0},{"had_liked":false,"id":88922,"user_name":"å¼ ä¸‰","can_delete":false,"product_type":"c1","uid":1004092,"ip_address":"","ucode":"1155528FAE1546","user_header":"https://static001.geekbang.org/account/avatar/00/0f/52/3c/d6fcb93a.jpg","comment_is_top":false,"comment_ctime":1556027286,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1556027286","product_id":100023901,"comment_content":"æˆ‘è®¤ä¸ºæ€è€ƒé¢˜çš„é—®é¢˜æ˜¯è¿”å›å€¼ä¸ç»Ÿä¸€ï¼Œç»“æœæ˜¯å¸ƒå°”å€¼ï¼Œä½†ä¸²è¡Œçš„ç¬¬ä¸€æ­¥è¿”å›å€¼ä¸ç¡®å®šã€‚","like_count":0},{"had_liked":false,"id":88897,"user_name":"æ›¾è½¼éºŸ","can_delete":false,"product_type":"c1","uid":1451391,"ip_address":"","ucode":"D418371AC11270","user_header":"https://static001.geekbang.org/account/avatar/00/16/25/7f/473d5a77.jpg","comment_is_top":false,"comment_ctime":1556023190,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1556023190","product_id":100023901,"comment_content":"checkå’Œfindruleåº”è¯¥è¦å¹¶è¡Œæ‰§è¡Œæ‰å¯¹","like_count":0},{"had_liked":false,"id":88743,"user_name":"ZOUå¿—ä¼Ÿ","can_delete":false,"product_type":"c1","uid":1029179,"ip_address":"","ucode":"439779871CC992","user_header":"https://static001.geekbang.org/account/avatar/00/0f/b4/3b/a1f7e3a4.jpg","comment_is_top":false,"comment_ctime":1555989055,"is_pvip":false,"replies":[{"id":"31823","content":"java8 lambda","user_name":"ä½œè€…å›å¤","user_name_real":"ç‹å®ä»¤","uid":"1269969","ctime":1556028752,"ip_address":"","comment_id":88743,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1555989055","product_id":100023901,"comment_content":"æƒ³çŸ¥é“()-&gt;æ˜¯ä»€ä¹ˆç”¨æ³•ï¼Ÿå“ªé‡Œæœ‰ä»‹ç»","like_count":0,"discussions":[{"author":{"id":1269969,"avatar":"https://static001.geekbang.org/account/avatar/00/13/60/d1/8efa89ab.jpg","nickname":"ç‹å®ä»¤","note":"","ucode":"4FE19F5BC32FCA","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":447888,"discussion_content":"java8 lambda","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1556028752,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":88691,"user_name":"walkingonair","can_delete":false,"product_type":"c1","uid":1444748,"ip_address":"","ucode":"0C8BEE064ABF8B","user_header":"https://static001.geekbang.org/account/avatar/00/16/0b/8c/db1ee0a2.jpg","comment_is_top":false,"comment_ctime":1555982969,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1555982969","product_id":100023901,"comment_content":"ä¹‹å‰è®²ç†è®ºç†è§£çš„ä¸å¤Ÿé€å½»ï¼Œå°è±¡ä¹Ÿä¸æ·±åˆ»ï¼Œç°åœ¨è®²åˆ°å…·ä½“å®ç°ï¼Œæ¸å…¥ä½³å¢ƒï¼Œæ„Ÿè°¢è€å¸ˆï¼","like_count":0},{"had_liked":false,"id":88676,"user_name":"undifined","can_delete":false,"product_type":"c1","uid":1068920,"ip_address":"","ucode":"449CB4CD2DC089","user_header":"https://static001.geekbang.org/account/avatar/00/10/4f/78/c3d8ecb0.jpg","comment_is_top":false,"comment_ctime":1555981658,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1555981658","product_id":100023901,"comment_content":"è¯¾åé¢˜åªæ‰¾åˆ°ä¸€ä¸ªé—®é¢˜ï¼šPurchersOrder poæ²¡æœ‰åˆå§‹åŒ–ï¼Œè€Œè¿™ä¸ªå¯¹è±¡åœ¨å¼‚æ­¥çº¿ç¨‹ä¸­æ˜¯ final çš„ï¼Œè€å¸ˆè¿˜æœ‰å…¶ä»–çš„é—®é¢˜å—","like_count":0},{"had_liked":false,"id":88674,"user_name":"å‘¨æ²»æ…§","can_delete":false,"product_type":"c1","uid":1335293,"ip_address":"","ucode":"7D56C4E66BEE17","user_header":"https://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTKR3ibELhjgVicCNShZCBwvaDxibnzibggG4wUzVkS2mkDxUBZyIs87nDEdJ7PiahJBVoZcuhQ84RxAziag/132","comment_is_top":false,"comment_ctime":1555981423,"is_pvip":false,"replies":[{"id":"31992","content":"ç«çœ¼é‡‘ç›ğŸ‘","user_name":"ä½œè€…å›å¤","user_name_real":"ç‹å®ä»¤","uid":"1269969","ctime":1556156614,"ip_address":"","comment_id":88674,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1555981423","product_id":100023901,"comment_content":"åœ¨ç¬¬3å¿«æè¿°orèšåˆçš„æ—¶å€™ï¼Œç¬¬äºŒä¸ªf1åº”è¯¥æ˜¯f2ã€‚å…³äºæ€è€ƒé¢˜ï¼Œåœ¨è¿›è¡Œæ•°æ®æ ¡éªŒæ—¶ä¾èµ–æŸ¥è¯¢è§„åˆ™çš„æŸ¥è¯¢ç»“æœæ˜¯ä¸ªä¸²è¡Œæ“ä½œï¼Œä½†æ˜¯éœ€è¦å¯¹å¼‚å¸¸è¿›è¡Œå¤„ç†","like_count":0,"discussions":[{"author":{"id":1269969,"avatar":"https://static001.geekbang.org/account/avatar/00/13/60/d1/8efa89ab.jpg","nickname":"ç‹å®ä»¤","note":"","ucode":"4FE19F5BC32FCA","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":447862,"discussion_content":"ç«çœ¼é‡‘ç›ğŸ‘","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1556156614,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":88664,"user_name":"æ°¸è”","can_delete":false,"product_type":"c1","uid":1255535,"ip_address":"","ucode":"6E3A0598ECBB09","user_header":"https://static001.geekbang.org/account/avatar/00/13/28/6f/8d12534a.jpg","comment_is_top":false,"comment_ctime":1555980640,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1555980640","product_id":100023901,"comment_content":"æ—¢ç„¶æ˜¯å¼‚æ­¥æ‰§è¡Œï¼Œä¹Ÿå°±æ˜¯è¢«åˆ«çš„çº¿ç¨‹æ‰§è¡Œï¼Œè®¢å•po çš„å¯è§†æ€§ä¸èƒ½ä¿è¯ã€‚","like_count":0},{"had_liked":false,"id":88646,"user_name":"å¼ ä¸‰","can_delete":false,"product_type":"c1","uid":1004092,"ip_address":"","ucode":"1155528FAE1546","user_header":"https://static001.geekbang.org/account/avatar/00/0f/52/3c/d6fcb93a.jpg","comment_is_top":false,"comment_ctime":1555978588,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1555978588","product_id":100023901,"comment_content":"æ‰“å¡ï¼","like_count":0},{"had_liked":false,"id":88644,"user_name":"Alvin","can_delete":false,"product_type":"c1","uid":1310234,"ip_address":"","ucode":"DB22A2AD2D4F40","user_header":"","comment_is_top":false,"comment_ctime":1555978567,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1555978567","product_id":100023901,"comment_content":"æ²¡å¤„ç†å¼‚å¸¸","like_count":0},{"had_liked":false,"id":88633,"user_name":"ack","can_delete":false,"product_type":"c1","uid":1440912,"ip_address":"","ucode":"69CA1233EEA8E2","user_header":"https://static001.geekbang.org/account/avatar/00/15/fc/90/c9df0459.jpg","comment_is_top":false,"comment_ctime":1555977179,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1555977179","product_id":100023901,"comment_content":"åœ¨æ•°æ®åº“ä¸­æŸ¥è¯¢è§„åˆ™ å’Œ  è§„åˆ™æ ¡éªŒæ˜¯ä¸²è¡Œå…³ç³»ã€‚è€Œè§„åˆ™æŸ¥è¯¢æ²¡æœ‰<br>ä¼ å…¥å‚æ•°è¯´æ˜è¿™ä¸ªè§„åˆ™æ˜¯é€šç”¨çš„ï¼Œä¸Šé¢çš„æ–¹æ³•é‡‡ç”¨çš„æ˜¯ä¸²è¡ŒæŸ¥è¯¢çš„<br>æ–¹å¼ï¼Œé‚£ä¹ˆæ¯æ¬¡éƒ½è¦æŸ¥è¯¢ä¸€æ¬¡è¿™ä¸ªé€šç”¨çš„è§„åˆ™ï¼Œæˆ‘çš„ç†è§£æ˜¯æ”¹æˆå¦‚ä¸‹ï¼š<br><br>PurchersOrder po;<br><br>CompletableFuture&lt;Rule&gt; f1 = <br>\tCompletableFuture.supplyAsync(()-&gt;{<br>\t\t&#47;&#47; åœ¨æ•°æ®åº“ä¸­æŸ¥è¯¢è§„åˆ™<br>\t\treturn findRuleByJdbc();<br>\t });<br> <br>CompletableFuture&lt;Boolean&gt; f2 = <br>\tCompletableFuture.supplyAsync(()-&gt;{<br>\t\t&#47;&#47; åœ¨æ•°æ®åº“ä¸­æŸ¥è¯¢è§„åˆ™<br>\t\treturn check(po, f1.join());<br>\t });<br> <br>Boolean isOk = f2.join();<br>","like_count":0},{"had_liked":false,"id":88612,"user_name":"SMTCode","can_delete":false,"product_type":"c1","uid":1109038,"ip_address":"","ucode":"0D837A753E4FAB","user_header":"https://static001.geekbang.org/account/avatar/00/10/ec/2e/49d13bd2.jpg","comment_is_top":false,"comment_ctime":1555961609,"is_pvip":true,"discussion_count":0,"race_medal":0,"score":"1555961609","product_id":100023901,"comment_content":"è¿™ä¸ªä¾‹å­ä¸­ä¸åº”è¯¥ä½¿ç”¨ä¸²è¡Œå…³ç³»çš„thenApplyï¼Œåº”è¯¥ä½¿ç”¨ANDæ±‡èšå…³ç³»çš„thenCombineå§ï¼Ÿ","like_count":0}]}