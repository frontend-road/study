{"id":578111,"title":"17ï½œåº”ç”¨çŠ¶æ€ç®¡ç†ï¼ˆä¸‹ï¼‰ï¼šè¯¥ç”¨Reactç»„ä»¶çŠ¶æ€è¿˜æ˜¯Reduxï¼Ÿ","content":"<p>ä½ å¥½ï¼Œæˆ‘æ˜¯å®‹ä¸€ç®ï¼Œæ¬¢è¿å›åˆ°Reactåº”ç”¨å¼€å‘çš„å­¦ä¹ ã€‚</p><p>ä¸ŠèŠ‚è¯¾æˆ‘ä»¬å­¦ä¹ äº†åº”ç”¨çŠ¶æ€å¯¹äºJSå‰ç«¯åº”ç”¨çš„é‡è¦æ„ä¹‰ï¼Œä¹Ÿå­¦ä¹ äº†ä»¥Reduxä¸ºä»£è¡¨çš„åº”ç”¨çŠ¶æ€ç®¡ç†æ¡†æ¶ï¼Œä»‹ç»äº†Reduxçš„æ ¸å¿ƒæ¦‚å¿µ <code>action</code> ã€ <code>reducer</code> ã€ <code>store</code> ï¼Œä»¥åŠå®ƒå•å‘æ•°æ®æµçš„æœ¬è´¨ã€‚ä»ä½¿ç”¨è§’åº¦ï¼Œæˆ‘ä»¬ä»‹ç»äº†Reduxå°è£…åº“Redux Toolkitçš„ç”¨æ³•ï¼Œå¼ºè°ƒäº†å®ƒå¯¹Reduxå¼€å‘çš„ç®€åŒ–ã€‚</p><p>ä¸çŸ¥ä½ å‘ç°æ²¡æœ‰ï¼Œä¸ŠèŠ‚è¯¾é™¤äº†ä½œä¸ºæ‰©å±•å†…å®¹çš„MobXå’ŒXStateï¼Œæˆ‘ä»¬å®Œå…¨æ²¡æœ‰ç”¨åˆ°Reactã€‚è¯·ä½ æ”¾å¿ƒï¼Œå½“ç„¶ä¸æ˜¯æˆ‘å¿˜äº†è¿™ä¸ªä¸“æ çš„ä¸»é¢˜ï¼Œè€Œæ˜¯æˆ‘å¸Œæœ›ä½ èƒ½ä»¥æ›´çº¯ç²¹çš„è§†è§’ï¼Œå»äº†è§£åº”ç”¨çŠ¶æ€ç®¡ç†è¿™ä¸ªé¢†åŸŸçŸ¥è¯†ï¼Œä¸ä¼šå› ä¸ºReactçš„æ¦‚å¿µå¯¼è‡´å…ˆå…¥ä¸ºä¸»ã€‚</p><p>è¿™èŠ‚è¯¾ï¼Œæˆ‘ä»¬ä¼šæŠŠReduxä¸Reactç»“åˆèµ·æ¥ä½¿ç”¨ï¼Œçœ‹çœ‹å®ƒèƒ½ä¸ºReactçš„çŠ¶æ€ç®¡ç†å¸¦æ¥ä»€ä¹ˆå¥½å¤„ï¼ŒåŒæ—¶ä¹Ÿè¦æ¢è®¨ä»€ä¹ˆæ—¶å€™è¯¥ç”¨Reduxï¼Œä»€ä¹ˆæ—¶å€™ç”¨Reactå†…å»ºçš„stateï¼Œæ›´æˆ–è€…ï¼Œæ˜¯å¦å¯ä»¥æ··ç”¨ä¸¤ç§çŠ¶æ€ç®¡ç†ã€‚</p><h2>Reactåº”ç”¨ä¸­æœ‰å“ªäº›çŠ¶æ€ï¼Ÿ</h2><p>æˆ‘ä»¬åœ¨å¼€å‘Reactåº”ç”¨æ—¶ï¼Œä¼šç”¨åˆ°å„ç§çŠ¶æ€ï¼Œå¤§è‡´å¯ä»¥åˆ†ç±»æˆä¸‰ç§ï¼šä¸šåŠ¡çŠ¶æ€ã€äº¤äº’çŠ¶æ€ä»¥åŠå¤–éƒ¨çŠ¶æ€ã€‚</p><p><strong>ä¸šåŠ¡çŠ¶æ€æ˜¯æŒ‡ä¸ä¸šåŠ¡ç›´æ¥ç›¸å…³çš„çŠ¶æ€ï¼Œè¿™äº›çŠ¶æ€ç†è®ºä¸Šå‰¥ç¦»UIä¹Ÿå¯ä»¥ä½¿ç”¨</strong>ï¼Œæ¯”å¦‚åœ¨å•å…ƒæµ‹è¯•ä¸­ã€Node.jsç¯å¢ƒä¸­ç­‰ç­‰ã€‚</p><!-- [[[read_end]]] --><p>ä¸¾ä¸ªå…·ä½“çš„ä¾‹å­ï¼šoh-my-kanbanä¸­çš„todoListã€ongoingListã€doneListï¼Œç”¨äºä¿å­˜çœ‹æ¿å¡ç‰‡çš„åˆ—è¡¨ï¼Œéƒ½å¯ä»¥å¢åˆ ï¼Œè¿™äº›éƒ½æ˜¯oh-my-kanbançš„æ ¸å¿ƒä¸šåŠ¡ï¼Œé‚£ä¹ˆå®ƒä»¬å°±å±äºä¸šåŠ¡çŠ¶æ€ã€‚</p><p>å‡è®¾æˆ‘ä»¬éè¦ä¸ºoh-my-kanbanæä¾›ä¸€å¥—å‘½ä»¤è¡Œä¸‹çš„ç®¡ç†å·¥å…·ï¼Œé‚£ä¹ˆè¿™äº›çŠ¶æ€å’Œå®ƒä»¬ç›¸å…³çš„é€»è¾‘æ˜¯å¯ä»¥å¤ç”¨çš„ï¼Œæ¯”å¦‚ä¸‹é¢è¿™å‡ è¡Œå‘½ä»¤ï¼š</p><pre><code class=\"language-javascript\">ohmykanban list --column=ongoing\nohmykanban add --column=todo 'å¼€å‘ä»»åŠ¡-5'\nohmykanban remove --column=done 'æµ‹è¯•ä»»åŠ¡-2'\n</code></pre><p>å¦å¤–ï¼Œåœ¨å¤§ä¸­å‹Reacté¡¹ç›®ä¸­çš„ç”¨æˆ·æƒé™ä¿¡æ¯ï¼Œä¹Ÿç»å¸¸è¢«å­˜å…¥å‰ç«¯çŠ¶æ€ä¸­ï¼Œæ–¹ä¾¿å‰ç«¯é€»è¾‘åˆ¤æ–­æŸä¸ªåŠŸèƒ½æ¨¡å—æ˜¯å¦å¯ä»¥å¯¹å½“å‰ç”¨æˆ·å¼€æ”¾ï¼Œæˆ–æ˜¯å¯è§ä½†åªè¯»ï¼Œå†æˆ–è€…ï¼Œç›´æ¥éšè—èµ·æ¥ã€‚</p><p>å½“ç„¶ï¼Œè€ƒè™‘åˆ°ç³»ç»Ÿæ•´ä½“å®‰å…¨æ€§ï¼Œå½“æœåŠ¡å™¨ç«¯æ¥æ”¶åˆ°ç”¨æˆ·ä»æµè§ˆå™¨ç«¯å‘èµ·çš„è¯·æ±‚æ—¶ï¼Œä»ç„¶è¦éªŒè¯ç”¨æˆ·æƒé™ï¼Œè¿™ç±»ç”¨æˆ·æƒé™çŠ¶æ€ä¹Ÿå±äºä¸šåŠ¡çŠ¶æ€ã€‚</p><p><strong>äº¤äº’çŠ¶æ€</strong>ï¼ˆä¹Ÿç§°ä½œUIçŠ¶æ€ï¼‰ï¼Œ<strong>æ˜¯ä¸ç”¨æˆ·äº¤äº’ç›¸å…³çš„çŠ¶æ€ï¼Œä¸»è¦æ§åˆ¶ç€ç”¨æˆ·ä¸åº”ç”¨çš„äº¤äº’è¿‡ç¨‹ï¼Œç”¨äºæå‡ç”¨æˆ·ä½“éªŒ</strong>ã€‚</p><p>æ¯”å¦‚oh-my-kanbanä¸­çš„isLoadingã€showAddï¼Œåˆ†åˆ«æ§åˆ¶ç€æ˜¯å¦æ˜¾ç¤ºâ€œè¯»å–ä¸­â€å ä½æç¤ºï¼Œå’Œæ˜¯å¦æ˜¾ç¤ºâ€œåˆ›å»ºæ–°å¡ç‰‡â€çš„å¡ç‰‡ï¼Œå®ƒä»¬å°±å±äºäº¤äº’çŠ¶æ€ã€‚</p><p>è¿˜æœ‰ï¼Œå½“å¤§ä¸­å‹Reacté¡¹ç›®ä¸­åŠŸèƒ½æ¯”è¾ƒå¤šæ—¶ï¼Œå¸¸ç”¨åˆ°çš„Tabæ ‡ç­¾é¡µï¼Œä¹Ÿå¸¸ç”¨è¯¸å¦‚currentTabè¿™æ ·çš„äº¤äº’çŠ¶æ€æ¥è®°å½•å“ªä¸ªæ˜¯å½“å‰Tabã€‚</p><p>ä¸ºä»€ä¹ˆè¯´äº¤äº’çŠ¶æ€ç”¨äºæå‡ç”¨æˆ·ä½“éªŒå‘¢ï¼Ÿè¯·ä½ æƒ³è±¡ä¸€ä¸ªæç«¯çš„è®¾è®¡ï¼Œä»ä¸€ä¸ªReactåº”ç”¨ä¸­åˆ é™¤æ‰€æœ‰äº¤äº’çŠ¶æ€ï¼ŒåŒ…æ‹¬ï¼š</p><ul>\n<li>isLoadingä¸è¦äº†ï¼Œåˆ—è¡¨æ‹¿åˆ°æ•°æ®æ—¶ä¼šè·³ä¸€ä¸‹ï¼Œè¿˜å¥½å§ï¼›</li>\n<li>showAddä¸è¦äº†ï¼Œé‚£â€œæ·»åŠ æ–°å¡ç‰‡â€é»˜è®¤å°±ä¸€ç›´å±•ç¤ºå§ï¼Œä¹Ÿä¸æ˜¯ä¸èƒ½ç”¨ï¼›</li>\n<li>currentTabä¸è¦äº†ï¼Œæ‰€æœ‰Tabä¸‹çš„é¡µé¢å†…å®¹éƒ½ä¸€æ¬¡æ€§å±•ç¤ºå‡ºæ¥ï¼Œé‚£â€¦â€¦è¿™è¿˜èƒ½ç§°ä½œæ˜¯ç°ä»£å‰ç«¯åº”ç”¨å—ï¼Ÿ</li>\n</ul><p>ä½œä¸ºä¸€ä¸ª<strong>ä¼˜ç§€çš„å‰ç«¯å·¥ç¨‹å¸ˆï¼Œå¼€å‘å‡ºä¼˜ç§€çš„ç”¨æˆ·ä½“éªŒæ˜¯ä½ çš„èŒè´£ï¼Œä¹Ÿæ˜¯ä½ çš„éª„å‚²</strong>ï¼Œæˆ‘ç”±è¡·å¸Œæœ›ä½ åœ¨è¿™ä¸€ç‚¹ä¸Šä¸è¦å¦¥åã€‚</p><p>å†æ¥è®¨è®ºä¸€ä¸ªå¤æ‚çš„é—®é¢˜ï¼Œ<a href=\"https://time.geekbang.org/column/article/568107?\">ç¬¬11èŠ‚è¯¾</a>æˆ‘ä»¬å­¦ä¹ è¿‡å—æ§ç»„ä»¶å’Œè¡¨å•ï¼Œé‚£ä¹ˆè¡¨å•çŠ¶æ€ç®—æ˜¯ä¸šåŠ¡çŠ¶æ€è¿˜æ˜¯äº¤äº’çŠ¶æ€å‘¢ï¼Ÿæˆ‘è®¤ä¸ºéœ€è¦åˆ†æƒ…å†µè®¨è®ºï¼Œæˆ‘ä»¬ä¸€èµ·æ¥çœ‹çœ‹ã€‚</p><p><strong>è¡¨å•çŠ¶æ€å±äºäº¤äº’çŠ¶æ€ï¼š</strong></p><ul>\n<li>è¡¨å•çŠ¶æ€ç”±è‹¥å¹²å—æ§ç»„ä»¶çŠ¶æ€ç»„æˆï¼Œç”¨æˆ·åœ¨ä½¿ç”¨è¿™äº›å—æ§ç»„ä»¶è¾“å…¥æ–‡æœ¬ã€é€‰å–ä¸‹æ‹‰æ¡†æ—¶ï¼Œäº§ç”Ÿçš„çŠ¶æ€å˜æ›´ä¸»è¦è¿˜æ˜¯äº¤äº’è¡Œä¸ºï¼Œæš‚æ—¶è¿˜ä¸å…·æœ‰ä¸šåŠ¡æ„ä¹‰ï¼›</li>\n<li>åœ¨ç”¨æˆ·å½•å…¥è¡¨å•è¿‡ç¨‹ä¸­ï¼Œå¦‚æœæœ‰é’ˆå¯¹è¡¨å•é¡¹çš„éªŒè¯é€»è¾‘ï¼Œæ¯”å¦‚â€œæ ‡é¢˜ä¸èƒ½ä¸ºç©ºâ€â€œå¯†ç è‡³å°‘éœ€è¦åŒ…å«ä¸€ä¸ªæ•°å­—â€ï¼ŒéªŒè¯è¿‡ç¨‹ä¼šä½¿ç”¨è¡¨å•çŠ¶æ€ï¼ŒéªŒè¯ç»“æœä¹Ÿä¼šæ›´æ–°åˆ°è¡¨å•çŠ¶æ€ä¸­ã€‚è¿™ä¸ªæ—¶å€™éªŒè¯ç»“æœå·²ç»å…·æœ‰ä¸šåŠ¡æ„ä¹‰äº†ï¼Œä½†æ•´ä½“è¿˜æ˜¯å¯ä»¥çœ‹ä½œæ˜¯äº¤äº’çŠ¶æ€ã€‚</li>\n</ul><p><strong>è¡¨å•çŠ¶æ€å±äºä¸šåŠ¡çŠ¶æ€ï¼š</strong></p><ul>\n<li>å¦‚æœè¡¨å•æä¾›äº†ä¸€ä¸ªè‡ªåŠ¨æç¤ºçš„ä¸‹æ‹‰æ¡†ï¼Œæ ¹æ®è¾“å…¥çš„æ–‡æœ¬å†…å®¹å»æœåŠ¡å™¨ç«¯è·å–ä¸‹æ‹‰æ¡†çš„åˆ—è¡¨ï¼Œè¿™ä¸ªåˆ—è¡¨å°±å¾ˆéš¾è¯´å®ƒä¸æ˜¯ä¸šåŠ¡çŠ¶æ€äº†ï¼›</li>\n<li>æäº¤è¡¨å•æ—¶ä¼šä½¿ç”¨å…¶ä¸­å„ä¸ªå—æ§ç»„ä»¶çš„æœ€ç»ˆçŠ¶æ€ï¼Œè¿™æ—¶å¯ä»¥è®¤ä¸ºå®ƒä»¬æ˜¯ä¸šåŠ¡çŠ¶æ€ï¼›</li>\n<li>å¦‚æœè¿™ä¸ªè¡¨å•å¹¶ä¸æ˜¯åœ¨æ–°å»ºä¸€æ¡è®°å½•ï¼Œè€Œæ˜¯åœ¨ä¿®æ”¹ä¸€æ¡å·²æœ‰è®°å½•ï¼Œé‚£ä¹ˆæ¥è‡ªæœåŠ¡å™¨ç«¯ï¼Œä¸ºå„ä¸ªè¡¨å•é¡¹æä¾›çš„åˆå§‹å€¼ä¹Ÿåº”è¯¥ç®—ä½œä¸šåŠ¡çŠ¶æ€ã€‚</li>\n</ul><p>è¿˜æœ‰ä¸€ä¸ªåœºæ™¯ï¼Œæ¯”å¦‚ä¸€ä¸ªåä¸ºnumçš„çŠ¶æ€æ•°æ®ï¼Œåœ¨æŸä¸ªç»„ä»¶ä¸Šéœ€è¦åšä¸€ç³»åˆ—æ¯”è¾ƒé‡çš„è®¡ç®—æ‰èƒ½ä½¿ç”¨ï¼Œæ¯”å¦‚fibonacci(num)ï¼Œæœ‰äº›å¼€å‘è€…ä¸ºäº†é¿å…åå¤è®¡ç®—å½±å“æ€§èƒ½ï¼ŒæŠŠè®¡ç®—ç»“æœä¿å­˜åœ¨äº†å¦ä¸€ä¸ªåä¸ºresultçš„stateé‡Œã€‚</p><p>å…ˆä¸ç”¨è®¨è®ºè¿™ä¸ªè®¡ç®—ç»“æœresultæ˜¯å“ªç§çŠ¶æ€ï¼Œé¦–å…ˆæˆ‘ä»¬éœ€è¦è®¤è¯†åˆ°ï¼Œè¿™æ˜¯ä¸€ä¸ªè®¡ç®—å€¼ï¼Œä¹Ÿå¯ä»¥è¯´æ˜¯æ´¾ç”Ÿå€¼ã€‚æ— è®ºæ˜¯å¦ä½¿ç”¨Reduxï¼Œæˆ‘ä»¬éƒ½å€¼å¾—ç”¨å•ä¸€äº‹å®æ¥æºåŸåˆ™æ¥å®¡è§†è¿™ä¸ªè®¡ç®—å€¼ï¼šå½“åŸå€¼numå’Œè®¡ç®—å€¼resultéƒ½æ”¾åœ¨çŠ¶æ€é‡Œï¼Œå•ä»çŠ¶æ€å±‚é¢çœ‹ï¼Œæ˜¯çœ‹ä¸å‡ºå®ƒä»¬çš„å› æœå…³ç³»çš„ã€‚</p><p>æ›´åˆé€‚çš„åšæ³•æ˜¯ï¼Œåœ¨çŠ¶æ€é‡Œåªä¿ç•™åŸå€¼numï¼Œç»„ä»¶é‡Œä»å§‹è‡³ç»ˆéƒ½åŸºäºnumåšè®¡ç®—ã€‚é‚£æ€§èƒ½æ€ä¹ˆä¿è¯å‘¢ï¼Ÿæˆ‘ä»¬åœ¨<a href=\"https://time.geekbang.org/column/article/566856\">ç¬¬10èŠ‚è¯¾</a>å­¦ä¹ è¿‡çš„useMemoå°±æ˜¯å¹²è¿™äº‹çš„ï¼š</p><pre><code class=\"language-javascript\">const memoizedResult = useMemo(() =&gt; fibonacci(num), [num]);\n</code></pre><p>ä¸Šé¢è®¨è®ºäº†ä¸šåŠ¡çŠ¶æ€å’Œäº¤äº’çŠ¶æ€ï¼Œé‚£<strong>å¤–éƒ¨çŠ¶æ€</strong>æ˜¯æ€ä¹ˆå›äº‹ï¼Ÿåœ¨å¤–éƒ¨ä¸å°±æ„å‘³ç€ä¸Reactæ— å…³äº†å—ï¼Ÿæˆ‘ä¸¾ä¸ªä¾‹å­ä½ å¯èƒ½å°±ç†è§£äº†ï¼šwindow.locationã€‚</p><p>åœ¨Reactç”Ÿæ€ä¸­ï¼Œæœ€å¸¸ç”¨çš„å‰ç«¯è·¯ç”±æ¡†æ¶å°±æ˜¯React-Routeräº†ã€‚React-Routeråœ¨å‰ç«¯åšè·¯ç”±æ—¶ï¼Œä¼šè¯»å–window.locationçš„ä¿¡æ¯ï¼Œä¹Ÿä¼šé€šè¿‡æµè§ˆå™¨History APIï¼Œä¿®æ”¹locationçš„URLã€‚è¿™ä»å®é™…ä¸Šæ¥çœ‹ï¼Œå°±æˆä¸ºäº†Reactåº”ç”¨çŠ¶æ€çš„ä¸€éƒ¨åˆ†ã€‚</p><p>å…¶å®ä¸ä»…Reactï¼Œä¸šåŠ¡çŠ¶æ€ã€äº¤äº’çŠ¶æ€ã€å¤–éƒ¨çŠ¶æ€çš„åˆ†ç±»å¯¹å¾ˆå¤šå…¶ä»–å‰ç«¯æ¡†æ¶ä¹Ÿé€‚ç”¨ã€‚</p><p>ä½ è¿™æ—¶å¯èƒ½å°±ä¼šæœ‰ç–‘é—®äº†ï¼šâ€œç»™çŠ¶æ€åˆ†ç±»æ˜¯å¾ˆå¥½ï¼Œä½†æœ‰ä»€ä¹ˆç”¨ï¼Ÿâ€åˆ«æ€¥ï¼Œæ¥ä¸‹æ¥ä¼šç”¨åˆ°ã€‚</p><h2>å…¨å±€çŠ¶æ€ä¸å±€éƒ¨çŠ¶æ€</h2><p>å•çœ‹APIï¼Œstateå¯¹å•ä¸ªReactç»„ä»¶æ˜¯ç§æœ‰çš„ï¼Œä½†ä»å•å‘æ•°æ®æµçš„è§’åº¦çœ‹ï¼Œä¸€ä¸ªç»„ä»¶çš„stateè¿˜å¯ä»¥è¦†ç›–åˆ°å®ƒçš„æ‰€æœ‰åä»£ç»„ä»¶ã€‚ä½ å¯ä»¥èŠ±ä¸€åˆ†é’Ÿç ”ç©¶ä¸€ä¸‹ä¸‹é¢è¿™å¼ å›¾ï¼Œæˆ‘ä»¬å†ç»§ç»­å¾€ä¸‹åˆ†æã€‚</p><p><img src=\"https://static001.geekbang.org/resource/image/d8/yy/d8ec523a9b830d2401ea3ee99ca8c9yy.png?wh=1920x1129\" alt=\"å›¾ç‰‡\"></p><p><code>ParentComponent</code> çš„state  <code>A</code> ï¼š</p><ul>\n<li>å¯ä»¥è‡ªç”¨ï¼›</li>\n<li>å¯ä»¥é€šè¿‡propsä¼ ç»™ç›´æ¥å­ç»„ä»¶ <code>MyComponent</code> ï¼›</li>\n<li>ä¹Ÿå¯ä»¥é€šè¿‡propså‘ä¸‹é’»å–ï¼Œä¼ ç»™ç¬¬äºŒå±‚å’Œç¬¬ä¸‰å±‚çš„åä»£ç»„ä»¶ <code>MyChildComponent</code> ã€ <code>MyGrandchildComponent</code> ï¼›</li>\n<li>æ›´å¯ä»¥é€šè¿‡contextï¼Œä¼ ç»™æ‰€æœ‰çš„åä»£ç»„ä»¶ã€‚</li>\n</ul><p>è€Œ <code>MyChildComponent</code> çš„state  <code>B</code> çš„èŒƒå›´è™½ç„¶è¦å°å¾ˆå¤šï¼Œä½†è·Ÿstate  <code>A</code> ä¼šæœ‰ä¸€å®šé‡åˆï¼Œå³<code>MyChildComponent</code> ã€ <code>MyGrandchildComponent</code> å¯ä»¥åŒæ—¶ä½¿ç”¨ state  <code>A</code> å’Œ <code>B</code> çš„å€¼ã€‚</p><p>å¦‚æœ <code>ParentComponent</code> å·²ç»æ˜¯åº”ç”¨çš„æ ¹ç»„ä»¶ï¼Œé‚£ä¹ˆå¯ä»¥è®¤ä¸ºstate  <code>A</code> å°±æ˜¯å…¨å±€çŠ¶æ€ï¼Œè€Œstate  <code>B</code> å°±æ˜¯å±€éƒ¨çŠ¶æ€ã€‚</p><p>å½“ç„¶ï¼Œå…¨å±€çŠ¶æ€å’Œå±€éƒ¨çŠ¶æ€æ˜¯ç›¸å¯¹è€Œè¨€çš„ã€‚å¦‚æœä½ çš„æ ¹ç»„ä»¶å¹¶æœªæä¾›çŠ¶æ€ï¼Œè€Œå®ƒçš„å”¯ä¸€å­ç»„ä»¶æä¾›äº†çŠ¶æ€ï¼Œé‚£ä¹ˆè¿™ä¸ªçŠ¶æ€ä¹Ÿæ˜¯å…¨å±€çŠ¶æ€ã€‚</p><p>å±€éƒ¨çŠ¶æ€ä¹Ÿå¯ä»¥é€šè¿‡<a href=\"https://time.geekbang.org/column/article/574161\">ç¬¬13èŠ‚è¯¾</a>è®²åˆ°çš„<strong>çŠ¶æ€æå‡</strong>è¿™æ ·çš„å¼€å‘æŠ€å·§ï¼Œæ ¹æ®éœ€è¦æ”¹å†™ä¸ºå…¨å±€çŠ¶æ€ã€‚</p><p>è¿™ä¸ªæ—¶å€™ä½ å¯èƒ½ä¼šæœ‰æ–°çš„ç–‘é—®ï¼šâ€œåŒºåˆ†å…¨å±€ä¸å±€éƒ¨çŠ¶æ€æ˜¯å¾ˆå¥½ï¼Œä½†æœ‰ä»€ä¹ˆç”¨ï¼Ÿâ€æˆ‘ä»¬æ¥ç€å¾€ä¸‹è®²ã€‚</p><h2>ä»€ä¹ˆæ—¶å€™ä½¿ç”¨Reduxï¼Ÿ</h2><p>ä¸€èˆ¬æƒ…å†µä¸‹ï¼Œå½“ä½ çš„Reacté¡¹ç›®è¶³å¤Ÿå°ï¼Œå¼•å…¥Reduxçš„æˆæœ¬è¦å¤§äºæ”¶ç›Šã€‚åªæœ‰ä½ <strong>é¢„æœŸé¡¹ç›®è§„æ¨¡ä¼šé€æ¸å¢å¤§ï¼Œæˆ–è€…é¡¹ç›®å·²ç»æ˜¯å¤§ä¸­å‹çš„ä½“é‡äº†</strong>ï¼Œè¿™æ—¶å¯ä»¥è€ƒè™‘å¼•å…¥Reduxã€‚Reduxé¼“åŠ±å…¨å±€åªæœ‰å•ä¸€storeï¼Œæ‰€ä»¥æ¯”è¾ƒé€‚åˆç®¡ç†å…¨å±€çŠ¶æ€ã€‚</p><p>å°¤å…¶æœ‰ä¸€ç§æƒ…å†µï¼Œå½“ä½ å‘ç°ï¼Œä½ ä¸å¾—ä¸æŠŠé¡¹ç›®ä¸­å¤§éƒ¨åˆ†ç»„ä»¶çš„stateéƒ½æå‡åˆ°æ ¹ç»„ä»¶ä¸Šæ—¶ï¼Œå…¨å±€çŠ¶æ€ä¼šä¸æ–­è†¨èƒ€ï¼Œé‚£ä½ å°±æœ‰å¯èƒ½äºŸéœ€å¼•å…¥Reduxäº†ã€‚</p><p>è™½ç„¶ä¸äº‹å®ä¸ç¬¦ï¼Œä½†è¿™é‡Œå§‘ä¸”å¯ä»¥è®¤ä¸ºReduxæ˜¯Reactå•å‘æ•°æ®æµçš„ä¸€å±‚<strong>æŠ½è±¡</strong>ã€‚Reduxå¯ä»¥ç‹¬ç«‹äºReactå­˜åœ¨ï¼Œåœ¨å¼€å‘Reactåº”ç”¨æ—¶ç¼–å†™çš„Reduxä»£ç ï¼Œä¸Reactçš„è€¦åˆåº¦æ¯”è¾ƒä½ï¼Œå¯ä»¥ç‹¬ç«‹å¼€å‘ã€æµ‹è¯•ã€‚</p><p>ç»™ä½ çˆ†ä¸ªæ–™ï¼Œåœ¨ä¸ŠèŠ‚è¯¾ï¼ŒReduxå’ŒRedux Toolkitçš„ä¸¤æ®µæ ·ä¾‹ä»£ç ï¼Œæˆ‘å°±æ˜¯ç”¨Nodeç›´æ¥è·‘çš„ï¼š</p><pre><code class=\"language-bash\">npm install redux # æˆ– npm install @reduxjs/toolkit\nnode index.js\n</code></pre><p>å°†è¿™éƒ¨åˆ†æ•°æ®æµæŠ½è±¡å‡ºæ¥åï¼Œä¼šé™ä½æ ¹ç»„ä»¶stateçš„å¤æ‚åº¦ï¼Œåœ¨ç¼–å†™Reduxæ•°æ®æµé€»è¾‘æ—¶ï¼Œä¹Ÿå¯ä»¥åšåˆ°ä¸Reactç»„ä»¶çš„<strong>å…³æ³¨ç‚¹åˆ†ç¦»ï¼ˆSeparation Of Concernsï¼‰</strong>ã€‚</p><p>å¦å¤–ï¼Œ<strong>Reduxå¯¹çŠ¶æ€çš„å˜æ›´å’Œè¯»å–ä¹Ÿæ˜¯è§£è€¦çš„</strong>ã€‚æ¯”å¦‚ç”¨createSliceæ¥å£åˆ›å»ºäº†2ä¸ªsliceï¼Œå…±åŒç»„æˆstoreï¼Œreduceråˆ†åˆ«æ›´æ”¹å¯¹åº”çš„stateèŠ‚ç‚¹ï¼ŒåŒæ—¶å¼€å‘è€…ä¹Ÿå¯ä»¥è·¨sliceåˆ›å»ºselectoræ¥ç»„åˆä½¿ç”¨å¤šä¸ªstateèŠ‚ç‚¹é‡Œçš„æ•°æ®ã€‚</p><p>å…¶ä¸­createSelector APIå…¶å®å°±æ˜¯reselectåº“ï¼ˆ<a href=\"https://github.com/reduxjs/reselect\">å®˜ç½‘</a>ï¼‰ï¼Œç”¨äºåˆ›å»ºè®°å¿†åŒ–çš„é€‰æ‹©å™¨å‡½æ•°ï¼š</p><pre><code class=\"language-javascript\">import { createSelector } from \"@reduxjs/toolkit\";\n// ...\nconst selectBooks = (state) =&gt; state.books.allBooks;\nconst selectFavIds = (state) =&gt; state.user.favIds;\n\nexport const selectFavBooks = createSelector(\n&nbsp; selectBooks,\n&nbsp; selectFavIds,\n&nbsp; (books, ids) =&gt; {\n&nbsp; &nbsp; return books.filter(book =&gt; ids.includes(book.id));\n&nbsp; },\n);\n</code></pre><p>ä¸‹é¢çœ‹çœ‹å¦‚ä½•åœ¨Reactä¸­ä½¿ç”¨Reduxã€‚</p><h3>React Redux</h3><p>æˆ‘ä»¬åœ¨Reactä¸­ä½¿ç”¨Reduxï¼Œä¸€èˆ¬ä¼šå€ŸåŠ©Reduxå®˜æ–¹çš„<strong>Reactè¿æ¥å™¨React Reduxï¼š</strong></p><pre><code class=\"language-javascript\">npm install @reduxjs/toolkit react-redux\n</code></pre><p>ç”¨Providerç»„ä»¶åŒ…ä½æ•´ä¸ªåº”ç”¨ï¼Œä¼ å…¥ä¸ŠèŠ‚è¯¾Redux Toolkitæ ·ä¾‹ä»£ç ä¸­åˆ›å»ºçš„storeå¯¹è±¡ï¼š</p><pre><code class=\"language-javascript\">import React from 'react';\nimport ReactDOM from 'react-dom/client';\n// ...\nimport { Provider } from 'react-redux';\nimport store from './store';\n\nconst root = ReactDOM.createRoot(document.getElementById('root'));\nroot.render(\n  &lt;Provider store={store}&gt;\n    &lt;App /&gt;\n  &lt;/Provider&gt;\n);\n</code></pre><p>ç„¶ååœ¨ç»„ä»¶ä¸­å°±å¯ä»¥ä½¿ç”¨è¿™ä¸ªstoreäº†ï¼š</p><pre><code class=\"language-javascript\">import React from 'react';\nimport { useSelector, useDispatch } from 'react-redux';\nimport { addCard, removeCard } from './cardListSlice';\n\nexport function CardList() {\n&nbsp; const cardList = useSelector(state =&gt; state);\n&nbsp; const dispatch = useDispatch();\n\n&nbsp; return (\n&nbsp; &nbsp; &lt;div&gt;\n&nbsp; &nbsp; &nbsp; &lt;button onClick={() =&gt; {\n        const payload = { newCard: { title: 'å¼€å‘ä»»åŠ¡-1' } };\n        dispatch(addCard(payload));\n      }}&gt;æ·»åŠ &lt;/button&gt;\n&nbsp; &nbsp; &nbsp; &lt;ul&gt;\n        {\n          cardList.map(card =&gt; (\n            &lt;li key={card.title}&gt;\n              {card.title}\n              &lt;button onClick={() =&gt; {\n                dispatch(removeCard({ title: 'å¼€å‘ä»»åŠ¡-1' }));\n              }}&gt;åˆ é™¤&lt;/button&gt;\n            &lt;/li&gt;\n          ))\n        }\n      &lt;/ul&gt;\n&nbsp; &nbsp; &lt;/div&gt;\n&nbsp; );\n}\n</code></pre><p>ç›¸ä¿¡ä½ ç”¨CRAå¾ˆå¿«å°±èƒ½å®ç°è¿™ä¸ªå°Demoï¼š</p><p><img src=\"https://static001.geekbang.org/resource/image/40/49/401ef797d75c6db9972c3e329bf27f49.png?wh=1920x1030\" alt=\"å›¾ç‰‡\"></p><p>è¿™é‡Œåªæ˜¯ä¸€æ®µä¸´æ—¶çš„ä¾‹å­ä»£ç ï¼Œå¹¶ä¸ä»£è¡¨æˆ‘ä»¬éœ€è¦ç”¨Reduxæ¥æ”¹å†™oh-my-kanbané¡¹ç›®æˆ–è€…ä½ çš„yeah-my-kanbané¡¹ç›®ã€‚æ ¹æ®å‰é¢çš„ä»€ä¹ˆæ—¶å€™ç”¨Reduxçš„æ¡ä»¶ï¼Œè¿™ä¸¤ä¸ªé¡¹ç›®ç›®å‰è¿˜ä¸é€‚åˆå¼•å…¥Reduxã€‚</p><p>æ„Ÿè°¢â€œå­¦ä¹ å‰ç«¯-reactâ€åŒå­¦åœ¨<a href=\"https://time.geekbang.org/column/article/571276\">ç¬¬12èŠ‚è¯¾</a>ç•™è¨€åŒºçš„æé—®ï¼Œæˆ‘åœ¨è¿™é‡Œä¹Ÿç¨å¾®æä¸€ä¸‹React Reduxçš„åŸç†ã€‚</p><p>è¿™ä¸ªåº“æŠŠReduxçš„ <code>store</code> æ”¾åˆ°äº†contexté‡Œï¼Œä½†å¹¶<strong>æ²¡æœ‰å€ŸåŠ©Reactçš„contextæ›´æ–°æœºåˆ¶</strong>æ¥å“åº”storeå†…éƒ¨çš„æ›´æ–°ã€‚åœ¨æ—©æœŸç‰ˆæœ¬ä¸­ï¼ŒReact Reduxæä¾›çš„é«˜é˜¶ç»„ä»¶è®¢é˜…storeå˜åŒ–ï¼Œå½“æœ‰å˜åŒ–æ—¶è°ƒç”¨ç»„ä»¶çš„ <code>forceUpdate()</code> æ–¹æ³•ã€‚</p><p>è€Œåœ¨æ–°ç‰ˆï¼ˆv8.0ï¼‰ä¸­ï¼Œé«˜é˜¶ç»„ä»¶ä½¿ç”¨äº†Reactçš„æ–°Hooks APIï¼š <code>useSyncExternalStore</code> ï¼Œç”¨è¿™ä¸ªHookè¿”å›çš„propsæ¥æ›´æ–°è¢«ä¿®é¥°çš„ç»„ä»¶ã€‚å¦‚æœä½ æ„Ÿå…´è¶£ï¼Œä¹Ÿå¯ä»¥è¯»ä¸€è¯»React Reduxçš„<a href=\"https://blog.isquaredsoftware.com/2018/11/react-redux-history-implementation/\">å‘å±•å²</a>ã€‚</p><h3>Redux DevToolsæµè§ˆå™¨æ‰©å±•</h3><p>ç»è¿‡å¤šå¹´çš„ç§¯ç´¯ï¼ŒReduxå¼€å‘çš„ç”Ÿæ€åœˆéå¸¸ä¸°å¯Œï¼Œå…¶ä¸­æˆ‘é¦–å…ˆæ¨èçš„æ˜¯Reduxå®˜æ–¹æ¨å‡ºçš„Redux DevToolsæµè§ˆå™¨æ‰©å±•ï¼ˆ<a href=\"https://chrome.google.com/webstore/detail/redux-devtools/lmhkpmbekcpmknklioeibfkpmmfibljd?hl=en\">Chromeæ‰©å±•é“¾æ¥</a>ã€<a href=\"https://addons.mozilla.org/en-US/firefox/addon/reduxdevtools/\">Firefoxæ‰©å±•é“¾æ¥</a>ï¼‰ï¼Œå¯ä»¥ç”¨æ¥è·Ÿè¸ªè°ƒè¯•stateå’ŒactionåŒ…å«çš„æ•°æ®ï¼Œè¿˜æä¾›äº†ä¸€ä¸ªå¾ˆé…·çš„<strong>æ—¶é—´æ—…è¡ŒåŠŸèƒ½</strong>ã€‚</p><p><img src=\"https://static001.geekbang.org/resource/image/76/a7/766a704b7b1e35a18ce733c7130529a7.gif?wh=1200x580\" alt=\"å›¾ç‰‡\"></p><p>ä¸Šé¢çš„ä»‹ç»å¯èƒ½å¼•èµ·äº†ä½ å¯¹Reduxçš„ä¸€äº›å…´è¶£ï¼Œä½†å­¦ä¹ å½’å­¦ä¹ ï¼Œå®é™…é¡¹ç›®ä¸­è¿˜æ˜¯è¦è®¤çœŸè€ƒè™‘æ˜¯å¦è¯¥å¼•å…¥Reduxã€‚</p><p>äº†è§£äº†ä»€ä¹ˆæ—¶å€™ä½¿ç”¨Reduxï¼Œé‚£ä¹ˆä»€ä¹ˆæ—¶å€™ä½¿ç”¨Reactå†…å»ºstateå‘¢ï¼Ÿå¦‚æœä½ æœ¬æ¥å°±ä¸æ‰“ç®—å¼•å…¥Reduxï¼Œä»»ä½•æ—¶å€™éƒ½å¯ä»¥ä½¿ç”¨Reactå†…å»ºstateã€‚</p><h2>å¯å¦æ··ç”¨Reactå†…å»ºstateå’ŒReduxï¼Ÿ</h2><p>æˆ‘ä»¬è¿›å…¥ä»Šå¤©è¿™èŠ‚è¯¾çš„æœ€åä¸€ä¸ªé—®é¢˜ï¼šâ€œå¯å¦æ··ç”¨Reactå†…å»ºstateå’ŒReduxï¼Ÿâ€å½“ç„¶å¯ä»¥ã€‚å½“ä½ å†³å®šäº†ä¸ºé¡¹ç›®å¼•å…¥Reduxï¼Œå¹¶ä¸æ„å‘³ç€ä½ å°±ä¸useStateè¯´å†è§äº†ã€‚å®ƒä»¬<strong>å¯ä»¥å…±å­˜ï¼Œè€Œä¸”å¯ä»¥é…åˆå¾—å¾ˆå¥½</strong>ã€‚</p><p>ä¸€èˆ¬æƒ…å†µä¸‹å¯ä»¥è¿™æ ·åˆ†å·¥ï¼š</p><ul>\n<li>å…¨å±€çŠ¶æ€å€¾å‘äºæ”¾åˆ°Redux storeé‡Œï¼›</li>\n<li>å±€éƒ¨çŠ¶æ€å€¾å‘äºæ”¾åˆ°React stateé‡Œï¼›</li>\n<li>ä¸šåŠ¡çŠ¶æ€å€¾å‘äºæ”¾åˆ°Redux storeé‡Œï¼›</li>\n<li>äº¤äº’çŠ¶æ€å€¾å‘äºæ”¾åˆ°React stateé‡Œï¼›</li>\n<li>å¿…è¦æ—¶ï¼Œå¯ä»¥æŠŠå¤–éƒ¨çŠ¶æ€åŒæ­¥åˆ°Redux storeé‡Œã€‚</li>\n</ul><p>è¿™é‡Œæˆ‘æ’ä¸€ä¸ªç»æµå­¦å’Œç¤¾ä¼šå­¦æ¦‚å¿µï¼š<strong>è·¯å¾„ä¾èµ–ï¼ˆPath Dependenceï¼‰ï¼Œè¯´çš„æ˜¯äººä»¬åœ¨å½“å‰åšçš„å†³ç­–é€‰æ‹©å¾€å¾€å—åˆ¶äºä»–è¿‡å»çš„å†³ç­–ï¼Œå“ªæ€•æ‰€å¤„ç¯å¢ƒå·²ç»å‘ç”Ÿå˜åŒ–</strong>ã€‚æœ€è‘—åçš„ä¾‹å­æ˜¯QWERTYé”®ç›˜çš„å†å²ï¼Œæ„Ÿå…´è¶£çš„è¯ä½ å¯ä»¥ä¸Šç½‘æœä¸€ä¸‹ï¼Œè¿™ä¸ªæ¦‚å¿µæœ¬æ¥ä¸å…·æœ‰è´¬ä¹‰æˆ–è€…è¤’ä¹‰ã€‚</p><p>æˆ‘æ›¾è§è¿‡ä¸å°‘å¼€å‘è€…ï¼Œåœ¨Reactä¸­å¼•å…¥Reduxåï¼Œæ— è®ºå¤§å¤§å°å°çš„çŠ¶æ€éƒ½ä¹ æƒ¯æ€§åœ°å¾€Redux storeé‡Œæ”¾ï¼Œè¿™å°±æ˜¯ä¸€ç§è·¯å¾„ä¾èµ–äº†ã€‚è¿™æ ·åšçš„åæœä¹Ÿå¾ˆå®¹æ˜“æƒ³è±¡å¾—åˆ°ï¼š<strong>Redux storeä¸å ªé‡è´Ÿï¼ŒReactåè€Œå¤´é‡è„šè½»</strong>ã€‚</p><h2>å°ç»“</h2><p>è¿™èŠ‚è¯¾æˆ‘ä»¬ç»§ç»­ä¸ŠèŠ‚è¯¾åº”ç”¨çŠ¶æ€ç®¡ç†çš„å†…å®¹ï¼Œä»‹ç»äº†Reactåº”ç”¨ä¸­çš„ä¸‰ç§çŠ¶æ€ï¼šä¸šåŠ¡çŠ¶æ€ã€äº¤äº’çŠ¶æ€å’Œå¤–éƒ¨çŠ¶æ€ï¼Œå¹¶ä¸”å­¦ä¹ äº†ä»æ•°æ®æµå±‚é¢åŒºåˆ†çš„å…¨å±€çŠ¶æ€å’Œå±€éƒ¨çŠ¶æ€ã€‚</p><p>ç´§æ¥ç€æˆ‘ä»¬å­¦ä¹ äº†ä»€ä¹ˆæ—¶å€™ä¸ºReacté¡¹ç›®å¼•å…¥Reduxã€å¦‚ä½•ç”¨React Reduxè¿æ¥å™¨ï¼Œæœ€åæ€»ç»“äº†æ··ç”¨Reactå†…å»ºstateå’ŒRedux storeçš„ä¸€äº›åˆ†å·¥å»ºè®®ã€‚</p><p>è¿™èŠ‚è¯¾è®²äº†è¿™ä¹ˆå¤šåº”ç”¨çŠ¶æ€ï¼Œé‚£ä¹ˆåº”ç”¨çŠ¶æ€ç®—ä¸ç®—æ˜¯Reactåº”ç”¨çš„æ•°æ®æ¨¡å‹å‘¢ï¼Ÿå¦‚æœæ˜¯çš„è¯ï¼Œè¯¥å¦‚ä½•ä¿è¯æ¨¡å‹çš„schemaï¼ˆæ¨¡å¼ï¼‰å‘¢ï¼Ÿä¸‹èŠ‚è¯¾æˆ‘ä»¬ä¼šå­¦ä¹ å¦‚ä½•æ´»ç”¨PropTypeså’ŒTypeScriptï¼Œåœ¨Reactåº”ç”¨ä¸­åŠ å…¥æ•°æ®ç±»å‹éªŒè¯ã€‚</p><h2>æ€è€ƒé¢˜</h2><p>è¿™èŠ‚è¯¾è™½ç„¶å†™äº†ä¸€ä¸ªå¾ˆå°çš„React Redux Demoï¼Œä½†å¹¶ä¸æ‰“ç®—ç”¨Reduxæ¥æ”¹å†™oh-my-kanbanæˆ–è€…yeah-my-kanbané¡¹ç›®ã€‚</p><p>ä½ æ„¿æ„æ¥å—è¿™ä¸ªæŒ‘æˆ˜å—ï¼Ÿå¦‚æœæ„¿æ„çš„è¯ï¼Œè¯·å»ºä¸€ä¸ªforkæˆ–è€…åˆ†æ”¯ï¼ŒæŠŠæœ€æ–°çš„ä»£ç ç”¨Reduxæ”¹å†™ä¸€éï¼Œç„¶ååœ¨ç•™è¨€åŒºç•™ä¸‹ä½ çš„ä»£ç ä»“åº“é“¾æ¥ä¸å¤§å®¶åˆ†äº«ï¼Œæˆ–è€…ç•™ä¸€ä¸ªâ€œMâ€å­—æ ·ä»£è¡¨ä½ å¾ˆæ»¡æ„è‡ªå·±çš„æˆæœã€‚</p><p>ä½ å°†é‡åˆ°çš„å…·ä½“æŒ‘æˆ˜åŒ…æ‹¬ï¼š</p><ol>\n<li>åœ¨è¯¾ç¨‹ä¸­å¹¶æ²¡æœ‰æŠŠRedux Toolkitå’ŒReact Reduxçš„æ‰€æœ‰APIéƒ½å±•ç¤ºå‡ºæ¥ï¼Œä½ éœ€è¦å‚è€ƒå®˜æ–¹æ–‡æ¡£ï¼›</li>\n<li>ä¸‰ä¸ªçœ‹æ¿åˆ—çŠ¶æ€æ•°æ®ç»“æ„å’Œæ“ä½œéƒ½ç›¸åŒï¼Œä½ ä¼šæ€ä¹ˆè®¾è®¡sliceã€reducerï¼Ÿå½“ç„¶ï¼Œç›´æ¥åˆ›å»ºä¸‰ä¸ªç›¸ä¼¼çš„sliceä¹Ÿæ˜¯å®Œå…¨okçš„ï¼›</li>\n<li>å“ªäº›çŠ¶æ€ä¼šæ”¾åœ¨Redux storeä¸­ï¼Œå“ªäº›ä¼šæ”¾åœ¨React stateä¸­ã€‚</li>\n</ol><p>è¿™èŠ‚è¯¾å†…å®¹å°±åˆ°è¿™é‡Œã€‚æˆ‘ä»¬ä¸‹èŠ‚è¯¾å†è§ã€‚</p>","neighbors":{"left":{"article_title":"16ï½œåº”ç”¨çŠ¶æ€ç®¡ç†ï¼ˆä¸Šï¼‰ï¼šåº”ç”¨çŠ¶æ€ç®¡ç†æ¡†æ¶Redux","id":578084},"right":{"article_title":"18ï½œæ•°æ®ç±»å‹ï¼šæ´»ç”¨TypeScriptåšç±»å‹æ£€æŸ¥","id":579568}},"comments":[{"had_liked":false,"id":359053,"user_name":"ğŸ‘","can_delete":false,"product_type":"c1","uid":2189689,"ip_address":"åŒ—äº¬","ucode":"DE34B3B14287D1","user_header":"https://static001.geekbang.org/account/avatar/00/21/69/79/b4132042.jpg","comment_is_top":false,"comment_ctime":1665208273,"is_pvip":false,"replies":[{"id":130588,"content":"ä½ å¥½ï¼Œè¾°æ´‹ï¼Œå¾ˆé«˜å…´ä½ æ³¨æ„åˆ°äº†â€œè·¯å¾„ä¾èµ–â€æ¦‚å¿µã€‚\n\næˆ‘è®¤ä¸ºå„è¡Œå„ä¸šå„ä¸ªé¢†åŸŸå…¶å®å…·æœ‰ç›¸é€šæ€§ï¼Œæ—¶ä¸æ—¶åœ°æ‰¾äº›æœºä¼šæ‹“å®½è‡ªå·±çš„è§†é‡ï¼Œå¯¹è‡ªå·±çš„æŠ€æœ¯ç”Ÿæ¶¯å’ŒèŒä¸šç”Ÿæ¶¯ä¸€å®šä¼šæœ‰å¸®åŠ©ã€‚å°±æ¯”å¦‚æˆ‘èº«è¾¹ä¸€äº›ç‚’è‚¡çš„åŒäº‹ï¼Œåº”è¯¥æ˜¯ä»è‚¡å¸‚ä¸­å­¦åˆ°äº†æŸäº›å¾ˆå‰å®³çš„çŸ¥è¯†æŠ€èƒ½ï¼Œæœ€è¿‘åœ¨æœ¬èŒå·¥ä½œä¸Šéå¸¸ç§¯æä¸Šè¿›ï¼Œæˆ‘å¾ˆä½©æœä»–ä»¬ã€‚","user_name":"ä½œè€…å›å¤","user_name_real":"ç¼–è¾‘","uid":1033973,"ctime":1665242649,"ip_address":"åŒ—äº¬","comment_id":359053,"utype":1}],"discussion_count":1,"race_medal":0,"score":2,"product_id":100119601,"comment_content":"è€å¸ˆæåˆ°äº†è·¯å¾„ä¾èµ–è¿™ä¸ªæ¦‚å¿µï¼Œè¯´æ˜è€å¸ˆå¹³æ—¶çš„çŸ¥è¯†å‚¨å¤‡æ˜¯ä¸å±€é™äºæŠ€æœ¯é¢†åŸŸçš„ã€‚å­¦ä¹ äº†ï¼Œå‘è€å¸ˆçœ‹é½ï½","like_count":10,"discussions":[{"author":{"id":1033973,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/c6/f5/dae613e0.jpg","nickname":"å®‹ä¸€ç®","note":"","ucode":"55E5B710556C1E","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":589695,"discussion_content":"ä½ å¥½ï¼Œè¾°æ´‹ï¼Œå¾ˆé«˜å…´ä½ æ³¨æ„åˆ°äº†â€œè·¯å¾„ä¾èµ–â€æ¦‚å¿µã€‚\n\næˆ‘è®¤ä¸ºå„è¡Œå„ä¸šå„ä¸ªé¢†åŸŸå…¶å®å…·æœ‰ç›¸é€šæ€§ï¼Œæ—¶ä¸æ—¶åœ°æ‰¾äº›æœºä¼šæ‹“å®½è‡ªå·±çš„è§†é‡ï¼Œå¯¹è‡ªå·±çš„æŠ€æœ¯ç”Ÿæ¶¯å’ŒèŒä¸šç”Ÿæ¶¯ä¸€å®šä¼šæœ‰å¸®åŠ©ã€‚å°±æ¯”å¦‚æˆ‘èº«è¾¹ä¸€äº›ç‚’è‚¡çš„åŒäº‹ï¼Œåº”è¯¥æ˜¯ä»è‚¡å¸‚ä¸­å­¦åˆ°äº†æŸäº›å¾ˆå‰å®³çš„çŸ¥è¯†æŠ€èƒ½ï¼Œæœ€è¿‘åœ¨æœ¬èŒå·¥ä½œä¸Šéå¸¸ç§¯æä¸Šè¿›ï¼Œæˆ‘å¾ˆä½©æœä»–ä»¬ã€‚","likes_number":1,"is_delete":false,"is_hidden":false,"ctime":1665242649,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"åŒ—äº¬","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":360719,"user_name":"yihang","can_delete":false,"product_type":"c1","uid":1012361,"ip_address":"åŒ—äº¬","ucode":"A5506F085D1793","user_header":"https://static001.geekbang.org/account/avatar/00/0f/72/89/1a83120a.jpg","comment_is_top":false,"comment_ctime":1666779346,"is_pvip":false,"replies":[{"id":131289,"content":"ä½ å¥½ï¼Œyihangï¼Œè¿™æ˜¯React 18æ–°API useTransitionçš„å…¸å‹ç”¨ä¾‹ï¼Œä¸è¿‡ç›´åˆ°ç›®å‰ï¼ˆ2022å¹´10æœˆåº•ï¼‰ä¸ºæ­¢react-router 6.xè¿˜æ²¡æœ‰æ­£å¼é‡‡ç”¨è¿™ä¸ªæ–°APIï¼Œéœ€è¦è‡ªå·±workaroundï¼Œè¯·å‚è€ƒï¼š https:&#47;&#47;github.com&#47;remix-run&#47;react-router&#47;issues&#47;8860#issuecomment-1249914724 ã€‚","user_name":"ä½œè€…å›å¤","user_name_real":"ç¼–è¾‘","uid":1033973,"ctime":1666955213,"ip_address":"åŒ—äº¬","comment_id":360719,"utype":1}],"discussion_count":2,"race_medal":0,"score":2,"product_id":100119601,"comment_content":"è¿˜æœ‰ä¸ªé—®é¢˜æˆ‘æƒ³æå‰é—®ä¸€ä¸‹è€å¸ˆï¼šæœ€è¿‘ä½¿ç”¨äº†react router browserrouteræ¨¡å¼ï¼ŒåŒæ—¶ç”¨æ‡’åŠ è½½å®ç°åŠ¨æ€è·¯ç”±ï¼Œä½†é¡µé¢è·³è½¬ä¹‹é—´ä¼šæœ‰æ˜æ˜¾çš„é—ªçƒã€‚æ¢æˆhashrouterèƒ½å¥½ä¸€äº›ï¼Œä½†åŒæ ·æœ‰è‚‰çœ¼å¯è§çš„é—ªçƒï¼Œä¸çŸ¥è¿™ä¸ªé—®é¢˜æœ‰æ²¡æœ‰è¾ƒå¥½çš„è§£å†³æ–¹æ¡ˆï¼Ÿ","like_count":1,"discussions":[{"author":{"id":1033973,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/c6/f5/dae613e0.jpg","nickname":"å®‹ä¸€ç®","note":"","ucode":"55E5B710556C1E","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":591959,"discussion_content":"ä½ å¥½ï¼Œyihangï¼Œè¿™æ˜¯React 18æ–°API useTransitionçš„å…¸å‹ç”¨ä¾‹ï¼Œä¸è¿‡ç›´åˆ°ç›®å‰ï¼ˆ2022å¹´10æœˆåº•ï¼‰ä¸ºæ­¢react-router 6.xè¿˜æ²¡æœ‰æ­£å¼é‡‡ç”¨è¿™ä¸ªæ–°APIï¼Œéœ€è¦è‡ªå·±workaroundï¼Œè¯·å‚è€ƒï¼š https://github.com/remix-run/react-router/issues/8860#issuecomment-1249914724 ã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1666955213,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"åŒ—äº¬","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":1,"child_discussions":[{"author":{"id":1012361,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/72/89/1a83120a.jpg","nickname":"yihang","note":"","ucode":"A5506F085D1793","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":1033973,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/c6/f5/dae613e0.jpg","nickname":"å®‹ä¸€ç®","note":"","ucode":"55E5B710556C1E","race_medal":0,"user_type":2,"is_pvip":false},"discussion":{"id":592076,"discussion_content":"è°¢è°¢ï¼Œæˆ‘å­¦ä¹ ä¸€ä¸‹","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1667091886,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":591959,"ip_address":"å®å¤","group_id":0},"score":592076,"extra":""}]}]},{"had_liked":false,"id":360575,"user_name":"yihang","can_delete":false,"product_type":"c1","uid":1012361,"ip_address":"å®å¤","ucode":"A5506F085D1793","user_header":"https://static001.geekbang.org/account/avatar/00/0f/72/89/1a83120a.jpg","comment_is_top":false,"comment_ctime":1666667886,"is_pvip":false,"replies":null,"discussion_count":0,"race_medal":0,"score":2,"product_id":100119601,"comment_content":"å¸Œæœ›è®²è®²reduxå¼‚æ­¥æ•°æ®çš„å¤„ç†ã€‚ä¸ºä»€ä¹ˆå®ƒçš„apiè®¾è®¡çš„å¦‚æ­¤å¤æ‚ï¼Œæ„Ÿè§‰mobxå°±ç®€å•ç›´ç™½å¾ˆå¤š","like_count":4},{"had_liked":false,"id":367508,"user_name":"é˜¿é˜³","can_delete":false,"product_type":"c1","uid":1165817,"ip_address":"æ±Ÿè‹","ucode":"20A35FB86B1C5C","user_header":"https://static001.geekbang.org/account/avatar/00/11/c9/f9/39492855.jpg","comment_is_top":false,"comment_ctime":1675295460,"is_pvip":false,"replies":null,"discussion_count":0,"race_medal":0,"score":2,"product_id":100119601,"comment_content":"è€å¸ˆï¼Œå¯¹äºå¤–éƒ¨çŠ¶æ€ï¼Œæ„Ÿè§‰è¿˜ä¸å¤ªæ‡‚ï¼Œèƒ½å¤šä¸¾å‡ ä¸ªä¾‹å­å—","like_count":1}]}