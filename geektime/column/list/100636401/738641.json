{"id":738641,"title":"09ï½œæœ‰çŠ¶æ€çš„Responseï¼šå®ç°Sessionä¼ é€’ä¸Keep-alive","content":"<p>ä½ å¥½ï¼Œæˆ‘æ˜¯éƒ­å±¹ã€‚ä»Šå¤©æˆ‘ä»¬ç»§ç»­æ‰‹å†™MiniTomcatã€‚</p><p>ä¸ŠèŠ‚è¯¾æˆ‘ä»¬å·²ç»å®ç°å¯¹URIé‡Œè·¯å¾„çš„è§£æï¼Œç”¨äºé€‚é…GETè¯·æ±‚æ—¶ï¼Œå°†å‚æ•°ä»£å…¥è¯·æ±‚åœ°å€çš„æƒ…å†µï¼Œè€Œä¸”åœ¨è¯·æ±‚å‚æ•°ä¸­å¼•å…¥äº†Cookieä¸Sessionï¼Œä¸ºHTTPå¼•å…¥çŠ¶æ€ï¼Œå­˜å‚¨ç”¨æˆ·çš„ç›¸å…³ä¿¡æ¯ã€‚ä½†æˆ‘ä¹Ÿæåˆ°äº†ï¼Œæˆ‘ä»¬æš‚æœªåœ¨Responseè¿”å›å‚æ•°ä¸­å›å†™Sessionä¿¡æ¯ï¼Œæ‰€ä»¥å®¢æˆ·ç«¯ç¨‹åºæ²¡åŠæ³•æ¥å—è¿™ä¸ªä¿¡æ¯ï¼Œè‡ªç„¶ä¹Ÿæ— æ³•å†å›ä¼ ç»™Serverï¼Œè¿™æ˜¯æˆ‘ä»¬æ¥ä¸‹æ¥è¦æ”¹é€ çš„æ–¹å‘ã€‚</p><p>æ­¤å¤–ï¼Œç°åœ¨æˆ‘ä»¬å¯¹ä¸€ä¸ªSocketçš„ç®¡ç†æ˜¯è¿™æ ·çš„ï¼šå»ºç«‹ä¸€ä¸ªSocketï¼Œäº¤ç»™Processorå¤„ç†ï¼Œå½“Processorå¤„ç†å®Œæ¯•åéšå³æŠŠè¿™ä¸ªSocketå…³é—­ã€‚è¿™æ ·ä¹Ÿå¼•å‡ºä¸€ä¸ªé—®é¢˜ï¼šä¸€ä¸ªç½‘é¡µçš„é¡µé¢ä¸Šå¯èƒ½æœ‰å¾ˆå¤šæ¨¡å—ï¼Œæ¯æ¬¡éƒ½éœ€è¦è®¿é—®æœåŠ¡å™¨æ‹¿åˆ°ç›¸åº”èµ„æºï¼Œå¯¼è‡´æœ¬å¯ä»¥ä½¿ç”¨åŒä¸€ä¸ªSocketè§£å†³çš„é—®é¢˜ï¼Œå´éœ€è¦åˆ›å»ºå¤šä¸ªSocketï¼Œè¿™æ˜¯å¯¹èµ„æºçš„æµªè´¹ï¼Œæ‰€ä»¥è¿™èŠ‚è¯¾æˆ‘ä»¬ä¹Ÿæ¥æ¢è®¨ä¸€ä¸‹ç”¨ä»€ä¹ˆæŠ€æœ¯æ¥è§£å†³è¿™ä¸ªé—®é¢˜ã€‚</p><p>æ¥ä¸‹æ¥æˆ‘ä»¬ä¸€èµ·æ¥åŠ¨æ‰‹å®ç°ã€‚</p><h2>é¡¹ç›®ç»“æ„</h2><p>è¿™èŠ‚è¯¾æˆ‘ä»¬å…ˆåªå¼•å…¥äº†ä¸€ä¸ªå·¥å…·ç±»CookieToolsï¼Œç”¨æ¥å¤„ç†Cookieï¼Œå…¶ä½™é¡¹ç›®ç»“æ„å¹¶æ²¡æœ‰å‘ç”Ÿæ”¹å˜ï¼Œä½ å¯ä»¥å‚è€ƒæˆ‘ç»™å‡ºçš„ç›®å½•ã€‚</p><pre><code class=\"language-plain\">MiniTomcat\nâ”œâ”€ src\nâ”‚  â”œâ”€ main\nâ”‚  â”‚  â”œâ”€ java\nâ”‚  â”‚  â”‚  â”œâ”€ server\nâ”‚  â”‚  â”‚  â”‚  â”œâ”€ CookieTools.java\nâ”‚  â”‚  â”‚  â”‚  â”œâ”€ DefaultHeaders.java\nâ”‚  â”‚  â”‚  â”‚  â”œâ”€ HttpConnector.java\nâ”‚  â”‚  â”‚  â”‚  â”œâ”€ HttpHeader.java\nâ”‚  â”‚  â”‚  â”‚  â”œâ”€ HttpProcessor.java\nâ”‚  â”‚  â”‚  â”‚  â”œâ”€ HttpRequest.java\nâ”‚  â”‚  â”‚  â”‚  â”œâ”€ HttpRequestFacade.java\nâ”‚  â”‚  â”‚  â”‚  â”œâ”€ HttpRequestLine.java\nâ”‚  â”‚  â”‚  â”‚  â”œâ”€ HttpResponse.java\nâ”‚  â”‚  â”‚  â”‚  â”œâ”€ HttpResponseFacade.java\nâ”‚  â”‚  â”‚  â”‚  â”œâ”€ HttpServer.java\nâ”‚  â”‚  â”‚  â”‚  â”œâ”€ Request.java\nâ”‚  â”‚  â”‚  â”‚  â”œâ”€ Response.java\nâ”‚  â”‚  â”‚  â”‚  â”œâ”€ ServletProcessor.java\nâ”‚  â”‚  â”‚  â”‚  â”œâ”€ Session.java\nâ”‚  â”‚  â”‚  â”‚  â”œâ”€ SessionFacade.java\nâ”‚  â”‚  â”‚  â”‚  â”œâ”€ SocketInputStream.java\nâ”‚  â”‚  â”‚  â”‚  â”œâ”€ StatisResourceProcessor.java\nâ”‚  â”‚  â”œâ”€ resources\nâ”‚  â”œâ”€ test\nâ”‚  â”‚  â”œâ”€ java\nâ”‚  â”‚  â”‚  â”œâ”€ test\nâ”‚  â”‚  â”‚  â”‚  â”œâ”€ HelloServlet.java\nâ”‚  â”‚  â”‚  â”‚  â”œâ”€ TestServlet.java\nâ”‚  â”‚  â”œâ”€ resources\nâ”œâ”€ webroot\nâ”‚  â”œâ”€ test\nâ”‚  â”‚  â”œâ”€ HelloServlet.class\nâ”‚  â”‚  â”œâ”€ TestServlet.class\nâ”‚  â”œâ”€ hello.txt\nâ”œâ”€ pom.xml\n</code></pre><!-- [[[read_end]]] --><h2>æœ‰çŠ¶æ€çš„Response</h2><p>ä¸ŠèŠ‚è¯¾æˆ‘ä»¬å·²ç»æ„é€ äº†Sessionï¼Œä½†æˆ‘ä»¬æ²¡æŠŠå®ƒå­˜æ”¾åˆ°Responseè¿”å›å‚æ•°é‡Œã€‚æ‰€ä»¥å®¢æˆ·ç«¯è·å–ä¸åˆ°è¿™ä¸ªä¿¡æ¯ï¼Œä¹Ÿå°±æ²¡æ³•å†å›ä¼ ç»™Serverã€‚æ¥ä¸‹æ¥æˆ‘ä»¬å¼€å§‹ä¸€æ­¥æ­¥æ”¹é€ ï¼Œè®©Responseä¹Ÿæ‹¥æœ‰çŠ¶æ€ã€‚</p><p>é¦–å…ˆæ˜¯æ·»åŠ CookieTools.javaç±»ï¼Œè¿™ä¸ªç±»ä¸»è¦ç”¨äºæä¾›Cookieå¤„ç†å·¥å…·ç±»ã€‚ä½ å¯ä»¥çœ‹ä¸€ä¸‹ç¤ºä¾‹ä»£ç ã€‚</p><pre><code class=\"language-java\">public class CookieTools {\n    public static String getCookieHeaderName(Cookie cookie) {\n        return \"Set-Cookie\";\n    }\n    public static void getCookieHeaderValue(Cookie cookie, StringBuffer buf) {\n        String name = cookie.getName();\n        if (name == null)\n            name = \"\";\n        String value = cookie.getValue();\n        if (value == null)\n            value = \"\";\n        buf.append(name);\n        buf.append(\"=\");\n        buf.append(value);\n    }\n    static void maybeQuote (int version, StringBuffer buf,String value){\n        if (version == 0 || isToken (value))\n            buf.append (value);\n        else {\n            buf.append ('\"');\n            buf.append (value);\n            buf.append ('\"');\n        }\n    }\n    private static final String tspecials = \"()&lt;&gt;@,;:\\\\\\\"/[]?={} \\t\";\n    private static boolean isToken (String value) {\n        int len = value.length ();\n        for (int i = 0; i &lt; len; i++) {\n            char c = value.charAt (i);\n            if (c &lt; 0x20 || c &gt;= 0x7f || tspecials.indexOf (c) != -1)\n                return false;\n        }\n        return true;\n    }\n}\n</code></pre><p>é€šè¿‡ä»£ç å¯ä»¥çŸ¥é“ï¼Œè¿™ä¸ªå·¥å…·ç±»ä¸»è¦æ˜¯ç”¨æ¥å¿«é€Ÿè·å–Cookieå¯¹åº”çš„å–å€¼ï¼Œè¿™é‡Œæˆ‘å°±ä¸å¤šè¯´äº†ã€‚</p><p>ä¸ºäº†æ›´å¥½åœ°é€‚é…å¯¹HTTPåè®®çš„è§£æï¼ŒDefaultHeadersç±»å’ŒHttpRequestç±»ä¸­çš„ä»£ç ä¹Ÿè¦ä¸€å¹¶è°ƒæ•´ã€‚é¦–å…ˆæ˜¯è°ƒæ•´DefaultHeadersç±»ä¸­ï¼ŒCOOKIE_NAMEä¸JSESSIONID_NAMEçš„å€¼ã€‚</p><pre><code class=\"language-java\">package server;\npublic class DefaultHeaders {\n    static final String COOKIE_NAME = \"cookie\";\n    static final String JSESSIONID_NAME = \"jsessionid\";\n}\n</code></pre><p>å¯¹åº”HttpRequestç±»ä¸­parseRequestLineæ–¹æ³•ä¹Ÿè¦è¿›è¡Œè°ƒæ•´ã€‚</p><pre><code class=\"language-java\">package server;\npublic class HttpRequest implements HttpServletRequest {\n    private void parseRequestLine() {\n        int question = requestLine.indexOf(\"?\");\n        if (question &gt;= 0) {\n            queryString = new String(requestLine.uri, question + 1, requestLine.uriEnd - question - 1);\n            uri = new String(requestLine.uri, 0, question);\n            String tmp = \";\" + DefaultHeaders.JSESSIONID_NAME + \"=\";\n            int semicolon = uri.indexOf(tmp);\n            if (semicolon &gt;= 0) {\n                sessionid = uri.substring(semicolon+tmp.length());\n                uri = uri.substring(0, semicolon);\n            }\n        } else {\n            queryString = null;\n            uri = new String(requestLine.uri, 0, requestLine.uriEnd);\n            String tmp = \";\" + DefaultHeaders.JSESSIONID_NAME + \"=\";\n            int semicolon = uri.indexOf(tmp);\n            if (semicolon &gt;= 0) {\n                sessionid = uri.substring(semicolon+tmp.length());\n                uri = uri.substring(0, semicolon);\n            }\n        }\n    }\n}\n</code></pre><p>ç›¸æ¯”ä¹‹å‰ï¼Œä¸»è¦è°ƒæ•´äº†ä¸‹é¢è¿™æ®µè§£æã€‚</p><pre><code class=\"language-java\">  uri = new String(requestLine.uri, 0, requestLine.uriEnd);\n  String tmp = \";\" + DefaultHeaders.JSESSIONID_NAME + \"=\";\n  int semicolon = uri.indexOf(tmp);\n  if (semicolon &gt;= 0) {\n    sessionid = uri.substring(semicolon+tmp.length());\n    uri = uri.substring(0, semicolon);\n  }\n</code></pre><p>è¿˜æœ‰åœ¨parseHeadersæ–¹æ³•ä¸­ï¼Œè·å–åˆ°headerçš„nameä¹‹åï¼Œå¢åŠ ä¸¤è¡Œè½¬æ¢ä»£ç ï¼Œç¡®ä¿headeréƒ½ä»¥å°å†™å­—æ¯è¿›è¡Œæ¯”è¾ƒå¤„ç†ã€‚</p><pre><code class=\"language-java\">String name = new String(header.name,0,header.nameEnd);\nString value = new String(header.value, 0, header.valueEnd);\nname = name.toLowerCase();\n</code></pre><p>ä¸Šè¿°æ˜¯æˆ‘ä»¬è¦åšçš„äº›è®¸å‰ç½®å‡†å¤‡å·¥ä½œï¼Œæ¥ä¸‹æ¥è®©æˆ‘ä»¬æŠŠç›®å…‰æŠ•å‘HttpResponseç±»ï¼Œçœ‹çœ‹å¦‚ä½•å°†Requestè¯·æ±‚å†…è·å–çš„Cookieä¸Serverç”Ÿæˆçš„Sessionä¼ å…¥Responseè¿”å›å‚æ•°å†…ï¼Œè®©Clientä¹Ÿèƒ½è·å–åˆ°ã€‚</p><p>HttpResposeè¿”å›ç±»ä¸­éœ€è¦è°ƒæ•´çš„æ ¸å¿ƒæ–¹æ³•æ˜¯sendHeadersï¼Œé€šè¿‡è¿™ä¸ªæ–¹æ³•æŠŠå‚æ•°è®¾ç½®åˆ°Responseè¿”å›å¤´å†…ï¼Œä½ å¯ä»¥çœ‹ä¸€ä¸‹è°ƒæ•´åçš„ä»£ç ï¼Œæœªæ”¹å˜çš„éƒ¨åˆ†æ²¡æœ‰åœ¨è¿™é‡Œåˆ—ä¸¾å‡ºæ¥ã€‚</p><pre><code class=\"language-java\">package server;\npublic class HttpResponse implements HttpServletResponse {\n    ArrayList&lt;Cookie&gt; cookies = new ArrayList&lt;&gt;();\n    \n    public void sendHeaders() throws IOException {\n        PrintWriter outputWriter = getWriter();\n        outputWriter.print(this.getProtocol());\n        outputWriter.print(\" \");\n        outputWriter.print(status);\n        if (message != null) {\n            outputWriter.print(\" \");\n            outputWriter.print(message);\n        }\n        outputWriter.print(\"\\r\\n\");\n        if (getContentType() != null) {\n            outputWriter.print(\"Content-Type: \" + getContentType() + \"\\r\\n\");\n        }\n        if (getContentLength() &gt;= 0) {\n            outputWriter.print(\"Content-Length: \" + getContentLength() + \"\\r\\n\");\n        }\n        Iterator&lt;String&gt; names = headers.keySet().iterator();\n        while (names.hasNext()) {\n            String name = names.next();\n            String value = headers.get(name);\n            outputWriter.print(name);\n            outputWriter.print(\": \");\n            outputWriter.print(value);\n            outputWriter.print(\"\\r\\n\");\n        }\n        HttpSession session = this.request.getSession(false);\n        if (session != null) {\n            Cookie cookie = new Cookie(DefaultHeaders.JSESSIONID_NAME, session.getId());\n            cookie.setMaxAge(-1);\n            addCookie(cookie);\n        }\n        synchronized (cookies) {\n            Iterator&lt;Cookie&gt; items = cookies.iterator();\n            while (items.hasNext()) {\n                Cookie cookie = (Cookie) items.next();\n                outputWriter.print(CookieTools.getCookieHeaderName(cookie));\n                outputWriter.print(\": \");\n                StringBuffer sbValue = new StringBuffer();\n                CookieTools.getCookieHeaderValue(cookie, sbValue);\n                System.out.println(\"set cookie jsessionid string : \"+sbValue.toString());\n                outputWriter.print(sbValue.toString());\n                outputWriter.print(\"\\r\\n\");\n            }\n        }\n        outputWriter.print(\"\\r\\n\");\n        outputWriter.flush();\n   }\n   \n    @Override\n    public void addCookie(Cookie cookie) {\n      synchronized (cookies) {\n          cookies.add(cookie);\n      }\n}\n   // çœç•¥å…¶ä»– getter å’Œ setter æ–¹æ³•\n</code></pre><p>æ ¹æ®Servletè§„èŒƒï¼ŒResponseçš„Headerä¸­ Set-Cookieéœ€è¦æ»¡è¶³ä¸‹é¢çš„æ ¼å¼ï¼Œä»»é€‰ä¸€ç§å³å¯ã€‚</p><ul>\n<li><code>Set-Cookie: &lt;cookie-name&gt;=&lt;cookie-value&gt;</code></li>\n<li><code>Set-Cookie: &lt;cookie-name&gt;=&lt;cookie-value&gt;; Expires=&lt;date&gt;</code></li>\n<li><code>Set-Cookie: &lt;cookie-name&gt;=&lt;cookie-value&gt;; Max-Age=&lt;number&gt;</code></li>\n<li><code>Set-Cookie: &lt;cookie-name&gt;=&lt;cookie-value&gt;; Domain=&lt;domain-value&gt;</code></li>\n<li><code>Set-Cookie: &lt;cookie-name&gt;=&lt;cookie-value&gt;; Path=&lt;path-value&gt;</code></li>\n<li><code>Set-Cookie: &lt;cookie-name&gt;=&lt;cookie-value&gt;; Secure</code></li>\n</ul><p>åœ¨å½“å‰çš„Serverä¸­ï¼Œæˆ‘ä»¬å°±ä½¿ç”¨äº†æœ€åŸºæœ¬çš„æ ¼å¼ï¼š<code>Set-Cookie: &lt;cookie-name&gt;=&lt;cookie-value&gt;</code>ã€‚å‚è€ƒè®¾ç½®å¦‚ä¸‹ï¼š</p><pre><code class=\"language-plain\">Set-Cookie: jsessionid=FA73014B317A489994D0B394F4EBF4EA\n</code></pre><p>å°±åƒä¸Šè¿°sendHeadersæ–¹æ³•é‡Œä»£ç å±•ç¤ºçš„ï¼Œæˆ‘ä»¬å¢åŠ äº†ä¸€æ®µä»£ç ï¼Œåœ¨Set-Cookieä¸­æŠŠSessionä¿¡æ¯å¸¦å…¥è¿›å»ã€‚</p><pre><code class=\"language-java\">HttpSession session = this.request.getSession(false);\nif (session != null) {\n    Cookie cookie = new Cookie(DefaultHeaders.JSESSIONID_NAME, session.getId());\n    cookie.setMaxAge(-1);\n    addCookie(cookie);\n}\nsynchronized (cookies) {\n    Iterator&lt;Cookie&gt; items = cookies.iterator();\n    while (items.hasNext()) {\n        Cookie cookie = (Cookie) items.next();\n        outputWriter.print(CookieTools.getCookieHeaderName(cookie));\n        outputWriter.print(\": \");\n        StringBuffer sbValue = new StringBuffer();\n        CookieTools.getCookieHeaderValue(cookie, sbValue);\n        System.out.println(\"set cookie jsessionid string : \"+sbValue.toString());\n        outputWriter.print(sbValue.toString());\n        outputWriter.print(\"\\r\\n\");\n    }\n}\n</code></pre><p>è¿™æ ·ï¼Œæˆ‘ä»¬å°±åšåˆ°äº†<strong>åœ¨è¿”å›ç»™å®¢æˆ·ç«¯çš„ä¿¡æ¯ä¸­å¸¦æœ‰ç”¨æˆ·ç›¸å…³ä¿¡æ¯</strong>ï¼Œä¹‹åå¦‚æœå®¢æˆ·ç«¯å†å‘è¯·æ±‚ï¼Œå°±å¯ä»¥æŠŠè¿™äº›ç”¨æˆ·ä¿¡æ¯å†å›ä¼ ï¼Œåç«¯å¤„ç†çš„æ—¶å€™å°±ä¸å†éœ€è¦é‡æ–°è·å–ç”¨æˆ·ç›¸å…³ä¿¡æ¯ï¼Œè€Œæ˜¯å¯ä»¥ç›´æ¥æ‹¿åˆ°ï¼Œè¿™æ ·å°±å¯ä»¥æŠŠå¤šæ¬¡æ²¡æœ‰ä¸Šä¸‹æ–‡å…³è”çš„HTTPè®¿é—®æ‰“åŒ…æˆåŒä¸€ä¸ªç”¨æˆ·è®¿é—®ã€‚</p><h2>Socketé‡å¤ä½¿ç”¨</h2><p>æ¥ä¸‹æ¥æˆ‘ä»¬å†ç²—æµ…åœ°æ¢è®¨ä¸€ä¸‹å¦å¤–ä¸€ä¸ªé—®é¢˜ï¼Œå°±åƒå‰é¢æåˆ°çš„ï¼Œæˆ‘ä»¬ç›®å‰å¯¹Socketçš„ä½¿ç”¨æ¯”è¾ƒç®€å•ï¼ŒProcessorå¤„ç†å®Œæ¯•åéšå³å°±å…³é—­ï¼Œè¿™æ ·åœ¨é¡µé¢è¯·æ±‚èµ„æºæ¯”è¾ƒå¤šçš„æ—¶å€™ï¼Œå°±ä¼šæˆä¸ºç³»ç»Ÿçš„æ€§èƒ½ç“¶é¢ˆã€‚å› ä¸ºè¿™éœ€è¦æ¯æ¬¡è®¿é—®ä¸­æ‰“å¼€è¿æ¥å’Œå…³é—­è¿æ¥ã€‚</p><p>åœ¨HTTPåè®®1.1ç‰ˆæœ¬ä¸­æ”¯æŒäº†å¯æŒç»­çš„è¿æ¥ï¼Œè€Œä¸”æ˜¯é»˜è®¤çš„æ–¹å¼ï¼Œåœ¨Requestè¯·æ±‚å¤´ä¸­å¯ä»¥å±•ç°ã€‚</p><pre><code class=\"language-java\">connection: keep-alive\n</code></pre><p>åœ¨æŒç»­çš„è¿æ¥ä¸­ï¼ŒæœåŠ¡å™¨ä¸ä¼šå…³é—­Socketï¼Œè¿™æ ·ä¸€ä¸ªç½‘é¡µçš„ç›¸å…³èµ„æºåœ¨å‘è¯·æ±‚æ—¶å¯ä»¥å…±ç”¨ä¸€ä¸ªSocketã€‚æ‰€ä»¥åœ¨å®¢æˆ·ç«¯å’ŒæœåŠ¡å™¨ç«¯ä¹‹é—´ä¼šæœ‰å¤šæ¬¡çš„è¯·æ±‚æµå’Œè¿”å›æµçš„äº¤äº’ï¼Œè¿™æ ·åˆä¼šäº§ç”Ÿä¸€ä¸ªæ–°çš„é—®é¢˜ï¼Œå°±æ˜¯æˆ‘ä»¬æ€ä¹ˆçŸ¥é“ä»€ä¹ˆæ—¶å€™åº”è¯¥å…³é—­å®ƒå‘¢ï¼Ÿç­”æ¡ˆæ˜¯ä¼ è¾“å®Œæ¯•åï¼Œé€šè¿‡ä¸€ä¸ªå¤´ä¿¡æ¯å‘ŠçŸ¥å¯¹æ–¹å¯ä»¥å…³é—­äº†ã€‚</p><pre><code class=\"language-plain\">connection: close\n</code></pre><p>è¿˜æœ‰ï¼Œå¯¹ä¸€æ¬¡è¯·æ±‚å’Œè¿”å›çš„äº¤äº’ï¼Œå¯¹äºåŠ¨æ€ç”Ÿæˆçš„å†…å®¹æˆ‘ä»¬ä¹Ÿæ— æ³•è·å–Content-Lengthçš„æ•°å€¼ï¼Œå®¢æˆ·ç«¯æ€ä¹ˆçŸ¥é“æœåŠ¡å™¨è¿”å›çš„æ•°æ®ä¼ å®Œäº†å‘¢ï¼Ÿä¹‹å‰æŠŠè¿™ä¸ªå€¼å›ºå®šå†™æ­»åªé€‚ç”¨äºç®€å•çš„è¿”å›å›ºå®šå†…å®¹çš„åœºæ™¯ã€‚</p><p>HTTPåè®®ä¹Ÿè€ƒè™‘åˆ°äº†è¿™ä¸€ç‚¹ï¼Œåœ¨1.1ç‰ˆæœ¬ä¸­ï¼Œé‡‡ç”¨äº†ä¸€ä¸ªç‰¹æ®Šçš„å¤´éƒ¨ä¿¡æ¯transfer-encodingï¼Œæ¥è¡¨æ˜æ•°æ®æµé‡‡ç”¨åˆ†å—ï¼ˆchunkï¼‰çš„æ–¹å¼è¿›è¡Œå‘é€ä¼ è¾“ã€‚</p><pre><code class=\"language-plain\">Transfer-Encoding: chunked\n</code></pre><p>ä½ å¯ä»¥çœ‹ä¸€ä¸‹ä¼ è¾“çš„æ•°æ®æ ¼å¼çš„å®šä¹‰ã€‚</p><pre><code class=\"language-plain\">[chunk size][\\r\\n][chunk data][\\r\\n][chunk size][\\r\\n][chunk data][\\r\\n] â€¦â€¦ [chunk size = 0][\\r\\n][\\r\\n]\n</code></pre><p>è¿™ç§æ ¼å¼æˆ‘ä»¬åœ¨è¿™é‡Œç®€å•è§£é‡Šä¸€ä¸‹ã€‚</p><ol>\n<li>ç¼–ç æ˜¯ç”±è‹¥å¹²ä¸ªå—ç»„æˆï¼Œç”±ä¸€ä¸ªæ ‡æ˜é•¿åº¦ä¸º0çš„å—ç»“æŸï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œæ£€æµ‹åˆ° <code>chunk size = 0</code> è¡¨ç¤ºæ•°æ®æµå·²ä¼ è¾“å®Œæ¯•ã€‚</li>\n<li>æ¯ä¸ªchunkæœ‰ä¸¤éƒ¨åˆ†ç»„æˆï¼Œç¬¬ä¸€éƒ¨åˆ†æ˜¯è¿™ä¸ªåˆ†å—çš„é•¿åº¦ï¼Œç¬¬äºŒéƒ¨åˆ†åˆ™æ˜¯å‰ä¸€éƒ¨åˆ†æŒ‡å®šé•¿åº¦å¯¹åº”çš„å†…å®¹ï¼Œæ¯ä¸ªéƒ¨åˆ†ç”¨CRLFæ¢è¡Œç¬¦éš”å¼€ã€‚</li>\n<li>ç»“æŸæ—¶åªæ ‡è¯†CRLFã€‚</li>\n</ol><p>æˆ‘ä»¬ç”¨ä¸‹é¢è¿™ä¸ªç¤ºæ„å›¾å¯ä»¥æ›´å¥½åœ°å±•ç¤ºæ•°æ®ä¼ è¾“çš„æ ¼å¼ã€‚</p><pre><code class=\"language-plain\">åˆ†å—çš„é•¿åº¦ â€”â€” chunk size ï½œ CRLF\nåˆ†å—çš„æ•°æ® â€”â€” chunk data ï½œ CRLF\nåˆ†å—çš„é•¿åº¦ â€”â€” chunk size ï½œ CRLF\nåˆ†å—çš„æ•°æ® â€”â€” chunk data ï½œ CRLF\n       â€¦â€¦  // æ­¤å¤„çœç•¥\nåˆ†å—çš„é•¿åº¦ â€”â€” chunk size ï½œ CRLF\nåˆ†å—çš„æ•°æ® â€”â€” chunk data ï½œ CRLF\nåˆ†å—çš„é•¿åº¦ â€”â€” 0 ï½œ CRLF\nç»“æŸæ ‡è¯†ç¬¦ â€”â€” CRLF\n</code></pre><p>æœ‰äº†å›ºå®šæ ¼å¼ä¹‹åï¼Œå°±å¯ä»¥æŒ‰ç…§è§„å®šï¼Œä¸€éƒ¨åˆ†ä¸€éƒ¨åˆ†åœ°å‘é€æ•°æ®äº†ã€‚ä¹Ÿå› ä¸ºåˆ†å—çš„å­˜åœ¨ï¼Œæˆ‘ä»¬ä»Šåå°±ä¸éœ€è¦è€ƒè™‘content lengthè¿™ä¸ªå€¼äº†ã€‚</p><p>è¿™é‡Œæˆ‘ç»™å‡ºäº†ä¸€ä¸ªå“åº”åŒ…çš„å‚è€ƒç¤ºä¾‹ï¼Œä½ å¯ä»¥çœ‹ä¸€ä¸‹ã€‚</p><pre><code class=\"language-plain\">HTTP/1.1 200 OK\nContent-Type: text/plain\nTransfer-Encoding: chunked\n\n35\nThis is the data in the first chunk\n26\nand this is the second one\n3\ncon\n8\nsequence\n0\n</code></pre><p>å…¶ä¸­çš„é“ç†æˆ‘ä»¬ç†è§£äº†ä¹‹åï¼Œæ¥ä¸‹æ¥æˆ‘ä»¬å°±å¯ä»¥å¼€å§‹ç€æ‰‹æ”¹é€ ä»£ç äº†ã€‚åœ¨ä»£ç é‡Œé¢ï¼Œæˆ‘ä»¬åªæ˜¯åœ¨Processorä¸­åŠ ä¸ŠKeep-aliveçš„åˆ¤æ–­ï¼Œå†³å®šæ˜¯å¦å…³é—­Socketã€‚å› ä¸ºæ˜¯ä¸€ä¸ªç²—æµ…çš„æ¢è®¨ï¼Œæ‰€ä»¥æˆ‘ä»¬æ²¡æœ‰çœŸçš„æŒ‰ç…§chunkçš„æ¨¡å¼å›é€responseã€‚åé¢æˆ‘ä»¬ä¹Ÿæ²¡æœ‰å®ç°ï¼Œæ¢è®¨è¿™ä¸€éƒ¨åˆ†å†…å®¹ä¸»è¦æ˜¯ä¸ºäº†äº†è§£åŸç†ã€‚</p><p>ä½ å¯ä»¥çœ‹ä¸€ä¸‹éœ€è¦è°ƒæ•´çš„ä»£ç ã€‚</p><pre><code class=\"language-java\">package server;\npublic class HttpProcessor implements Runnable{\n    private Socket socket;\n    private boolean available = false;\n    private HttpConnector connector;\n    private int serverPort = 0;\n    private boolean keepAlive = false;\n    private boolean http11 = true;\n\n    public void process(Socket socket) {\n        InputStream input = null;\n        OutputStream output = null;\n        try {\n            input = socket.getInputStream();\n            output = socket.getOutputStream();\n            keepAlive = true;\n            while (keepAlive) {\n                // create Request object and parse\n                HttpRequest request = new HttpRequest(input);\n                request.parse(socket);\n                // handle session\n                if (request.getSessionId() == null || request.getSessionId().equals(\"\")) {\n                    request.getSession(true);\n                }\n                // create Response object\n                HttpResponse response = new HttpResponse(output);\n                response.setRequest(request);\n//               response.sendStaticResource();\n                request.setResponse(response);\n                try {\n                    response.sendHeaders();\n                } catch (IOException e1) {\n                    e1.printStackTrace();\n                }\n                // check if this is a request for a servlet or a static resource\n                // a request for a servlet begins with \"/servlet/\"\n                if (request.getUri().startsWith(\"/servlet/\")) {\n                    ServletProcessor processor = new ServletProcessor();\n                    processor.process(request, response);\n                }\n                else {\n                    StaticResourceProcessor processor = new StaticResourceProcessor();\n                    processor.process(request, response);\n                }\n                finishResponse(response);\n                System.out.println(\"response header connection------\"+response.getHeader(\"Connection\"));\n                if (\"close\".equals(response.getHeader(\"Connection\"))) {\n                    keepAlive = false;\n                }\n            }\n            // Close the socket\n            socket.close();\n            socket = null;\n        } catch (Exception e) {\n            e.printStackTrace();\n        }\n    }\n    private void finishResponse(HttpResponse response) {\n        response.finishResponse();\n    }\n}\n</code></pre><p>æˆ‘ä»¬æ¥åˆ†æä¸€ä¸‹è¿™æ®µä»£ç ï¼Œä¸€ä¸ªå°å˜åŠ¨åœ¨äºæ–°å¢äº†serverPortã€keepAliveä¸http11ä¸‰ä¸ªåŸŸï¼Œè€Œä¸”ä¸ºäº†æ›´å¥½çš„å®‰å…¨æ€§ï¼Œéƒ½ç”¨privateå…³é”®å­—ä¿®é¥°ã€‚è€Œæ ¸å¿ƒæ”¹åŠ¨åœ¨äº<strong>processæ–¹æ³•</strong>ï¼ŒæŠŠé‡Œé¢çš„å¤šæ•°æ–¹æ³•æ”¾ç½®åœ¨whileå¾ªç¯ä¹‹ä¸­ï¼Œä½¿ç”¨keepAliveå˜é‡æ§åˆ¶ï¼Œå¦‚æœæ£€æµ‹åˆ°responseçš„å¤´éƒ¨ä¿¡æ¯æ˜¯closeï¼Œé‚£ä¹ˆå°±æŠŠkeepAliveè®¾ç½®æˆfalseï¼Œé€€å‡ºå¾ªç¯ï¼Œå…³é—­Socketã€‚</p><p>è€Œå®¢æˆ·ç«¯ä¹Ÿå¯ä»¥åœ¨è¯·æ±‚å¤´ä¸­åŠ ä¸ŠConnection: closeæŒ‡å®šè¦å…³é—­è¿æ¥ï¼Œå› æ­¤HttpRequestçš„parseHeadersæ–¹æ³•å†…ä¹Ÿå¯ä»¥è¿›è¡Œè°ƒæ•´ï¼Œç°åœ¨HttpRequestä¸­å°†parseHeadersæ–¹æ³•è°ƒæ•´æˆä¸‹é¢è¿™ä¸ªæ ·å­äº†ã€‚</p><pre><code class=\"language-java\">else if (name.equals(DefaultHeaders.CONNECTION_NAME)) {\n    headers.put(name, value);\n    if (value.equals(\"close\")) {\n        response.setHeader(\"Connection\", \"close\");\n    }\n</code></pre><p>å¢åŠ äº†æ˜¯å¦ä¸ºcloseçš„åˆ¤æ–­ï¼Œç”¨æ¥è®¾ç½®è¯·æ±‚å¤´ã€‚<br>\nHttpRequestè¿˜æœ‰å…¶ä»–è°ƒæ•´ï¼šæ–°å¢åŸŸå’Œsetteræ–¹æ³•ï¼Œå…¶ä»–æœªæ”¹åŠ¨çš„éƒ¨åˆ†æˆ‘å°±ä¸åœ¨è¿™é‡Œåˆ—å‡ºäº†ã€‚</p><pre><code class=\"language-java\">package serverï¼›\npublic class HttpRequest implements HttpServletRequest {\n    private HttpResponse response;\n    public HttpRequest() {\n    }\n    public void setStream(InputStream input) {\n        this.input = input;\n        this.sis = new SocketInputStream(this.input, 2048);\n    }\n    public void setResponse(HttpResponse response) {\n        this.response = response;\n    }&nbsp; &nbsp;\n} &nbsp; &nbsp; &nbsp;\n</code></pre><p>å†çœ‹HttpResponseç±»çš„è°ƒæ•´ã€‚</p><pre><code class=\"language-java\">package serverï¼›\npublic class HttpResponse implements HttpServletResponse {\n    String characterEncoding = \"UTF-8\";\n    public HttpResponse() {\n    }\n    public void setStream(OutputStream output) {\n        this.output = output;\n    }\n    //æä¾›è¿™ä¸ªæ–¹æ³•å®Œæˆè¾“å‡º\n    public void finishResponse() {\n      try {\n          this.getWriter().flush();\n      } catch (IOException e) {\n          e.printStackTrace();\n      }\n   }\n}\n</code></pre><p>è€ŒHttpProcessorç±»ï¼Œå°±è¦è°ƒç”¨HttpResponseä¸­çš„finishResponseæ–¹æ³•ï¼Œè¿™æ˜¯å› ä¸ºæˆ‘ä»¬ä¿®æ”¹äº†ä¸€ä¸‹æ—¶åºï¼Œåœ¨ServletProcessorä¸­ä¸ç®¡headerå¤´å¤„ç†äº†ï¼Œåªè°ƒç”¨ <code>servlet.service(requestFacade, responseFacade)</code> è¿™ä¸€æ–¹æ³•ã€‚</p><p>è¿‡å»æˆ‘ä»¬åœ¨ServletProcessorä¸­åˆå§‹åŒ–ClassLoaderï¼Œç°åœ¨æŠŠç±»åŠ è½½å™¨æ”¹å†™æˆå…¨å±€å¯ç”¨çš„ï¼ŒæŠŠåˆå§‹åŒ–æ”¾åœ¨HttpConnectoré‡Œã€‚</p><p>æ‰€ä»¥æ¥ä¸‹æ¥æˆ‘ä»¬è¦æ”¹å†™ServletProcessorã€HttpConnectorä¸¤ä¸ªç±»ã€‚</p><p>HttpConnectorä¸»è¦ä¿®æ”¹å¦‚ä¸‹ï¼š</p><pre><code class=\"language-java\">package server;\npublic class HttpConnector implements Runnable {\n    int minProcessors = 3;\n    int maxProcessors = 10;\n    int curProcessors = 0;\n    Deque&lt;HttpProcessor&gt; processors = new ArrayDeque&lt;&gt;();\n    public static Map&lt;String, HttpSession&gt; sessions = new ConcurrentHashMap&lt;&gt;();\n    //ä¸€ä¸ªå…¨å±€çš„class loader\n    public static URLClassLoader loader = null;\n    public void run() {\n        ServerSocket serverSocket = null;\n        int port = 8080;\n        try {\n            serverSocket = new ServerSocket(port, 1, InetAddress.getByName(\"127.0.0.1\"));\n        } catch (IOException e) {\n            e.printStackTrace();\n            System.exit(1);\n        }\n        try {\n            //class loaderåˆå§‹åŒ–\n            URL[] urls = new URL[1];\n            URLStreamHandler streamHandler = null;\n            File classPath = new File(HttpServer.WEB_ROOT);\n            String repository = (new URL(\"file\", null, classPath.getCanonicalPath() + File.separator)).toString() ;\n            urls[0] = new URL(null, repository, streamHandler);\n            loader = new URLClassLoader(urls);\n        }\n        catch (IOException e) {\n            System.out.println(e.toString() );\n        }\n        // initialize processors pool\n        for (int i = 0; i &lt; minProcessors; i++) {\n            HttpProcessor initprocessor = new HttpProcessor(this);\n            initprocessor.start();\n            processors.push(initprocessor);\n        }\n        curProcessors = minProcessors;\n        while (true) {\n            Socket socket = null;\n            try {\n                socket = serverSocket.accept();\n                HttpProcessor processor = createProcessor();\n                if (processor == null) {\n                    socket.close();\n                    continue;\n                }\n                processor.assign(socket);\n                // Close the socket\n//                socket.close();\n            } catch (Exception e) {\n                e.printStackTrace();\n            }\n        }\n    }\n}\n</code></pre><p>HttpConnectoræ–°å¢äº†loaderå˜é‡ï¼Œè¿˜å°†ä¸‹é¢è¿™æ®µä»£ç ä»ServletProcessorä¸­ç§»é™¤äº†ã€‚</p><pre><code class=\"language-java\">        try {\n            URL[] urls = new URL[1];\n            URLStreamHandler streamHandler = null;\n            File classPath = new File(HttpServer.WEB_ROOT);\n            String repository = (new URL(\"file\", null, classPath.getCanonicalPath() + File.separator)).toString() ;\n            urls[0] = new URL(null, repository, streamHandler);\n            loader = new URLClassLoader(urls);\n        }\n        catch (IOException e) {\n            System.out.println(e.toString());\n        }\n</code></pre><p>å› æ­¤ServletProcessorçš„è°ƒæ•´å°±æ¯”è¾ƒç®€å•äº†ï¼Œå°†servletClasså˜é‡çš„èµ‹å€¼ï¼Œç›´æ¥äº¤ç”±HttpConnectorå¤„ç†ï¼Œè€Œä¸”ä¸å†éœ€è¦è°ƒç”¨ <code>response.sendHeaders</code> æ–¹æ³•ï¼Œä½ å¯ä»¥çœ‹ä¸€ä¸‹å½“å‰ServletProcessorçš„ä»£ç ã€‚</p><pre><code class=\"language-java\">package server;\npublic class ServletProcessor {\n    public void process(HttpRequest request, HttpResponse response) {\n        String uri = request.getUri();\n        String servletName = uri.substring(uri.lastIndexOf(\"/\") + 1);\n        response.setCharacterEncoding(\"UTF-8\");\n        Class&lt;?&gt; servletClass = null;\n        try {\n            servletClass = HttpConnector.loader.loadClass(servletName);\n        }\n        catch (ClassNotFoundException e) {\n            System.out.println(e.toString());\n        }\n        Servlet servlet = null;\n        try {\n            servlet = (Servlet) servletClass.newInstance();\n            HttpRequestFacade requestFacade = new HttpRequestFacade(request);\n            HttpResponseFacade responseFacade = new HttpResponseFacade(response);\n            System.out.println(\"Call Service()\");\n            servlet.service(requestFacade, responseFacade);\n        }\n        catch (Exception e) {\n            System.out.println(e.toString());\n        }\n        catch (Throwable e) {\n            System.out.println(e.toString());\n        }\n    }\n}\n</code></pre><p>å¯ä»¥çœ‹åˆ°ï¼Œè¿™ä¸ªç±»å˜ç®€å•äº†ã€‚</p><h2>æµ‹è¯•</h2><p>è¿™èŠ‚è¯¾æˆ‘ä»¬è¿˜æ˜¯åœ¨ <code>src/test/java/test</code> ç›®å½•ä¸‹ä½¿ç”¨TestServletè¿›è¡Œæµ‹è¯•ï¼Œè¿™ä¸€æ¬¡æˆ‘ä»¬æ”¹å†™doGetæ–¹æ³•ã€‚</p><pre><code class=\"language-java\">package test;\npublic class TestServlet extends HttpServlet{\n    static int count = 0;\n    private static final long serialVersionUID = 1L;\n    @Override\n    public void doGet(HttpServletRequest request, HttpServletResponse response)throws ServletException, IOException {\n        System.out.println(\"Enter doGet()\");\n        System.out.println(\"parameter name : \"+request.getParameter(\"name\"));\n        TestServlet.count++;\n        System.out.println(\"::::::::call count ::::::::: \" + TestServlet.count);\n        if (TestServlet.count &gt; 2) {\n            response.addHeader(\"Connection\", \"close\");\n        }\n        HttpSession session = request.getSession(true);\n        String user = (String) session.getAttribute(\"user\");\n        System.out.println(\"get user from session : \" + user);\n        if (user == null || user.equals(\"\")) {\n            session.setAttribute(\"user\", \"yale\");\n        }\n        response.setCharacterEncoding(\"UTF-8\");\n        String doc = \"&lt;!DOCTYPE html&gt; \\n\" +\n                \"&lt;html&gt;\\n\" +\n                \"&lt;head&gt;&lt;meta charset=\\\"utf-8\\\"&gt;&lt;title&gt;Test&lt;/title&gt;&lt;/head&gt;\\n\"+\n                \"&lt;body bgcolor=\\\"#f0f0f0\\\"&gt;\\n\" +\n                \"&lt;h1 align=\\\"center\\\"&gt;\" + \"Test ä½ å¥½\" + \"&lt;/h1&gt;\\n\";\n        System.out.println(doc);\n        response.getWriter().println(doc);\n    }\n    public void doPost(HttpServletRequest request, HttpServletResponse response)throws ServletException, IOException {\n        System.out.println(\"Enter doGet()\");\n        System.out.println(\"parameter name : \"+request.getParameter(\"name\"));\n        response.setCharacterEncoding(\"UTF-8\");\n        String doc = \"&lt;!DOCTYPE html&gt; \\n\" +\n                \"&lt;html&gt;\\n\" +\n                \"&lt;head&gt;&lt;meta charset=\\\"utf-8\\\"&gt;&lt;title&gt;Test&lt;/title&gt;&lt;/head&gt;\\n\"+\n                \"&lt;body bgcolor=\\\"#f0f0f0\\\"&gt;\\n\" +\n                \"&lt;h1 align=\\\"center\\\"&gt;\" + \"Test ä½ å¥½\" + \"&lt;/h1&gt;\\n\";\n        System.out.println(doc);\n        response.getWriter().println(doc);\n    }\n}\n</code></pre><p>æˆ‘ä»¬åœ¨TestServleté‡Œé¢ç”¨ä¸€ä¸ªé™æ€å…¨å±€è®¡æ•°å™¨ï¼Œå¦‚æœæ˜¯ç¬¬ä¸‰æ¬¡ä»¥ä¸Šï¼Œå°±æŠŠå¤´éƒ¨ä¿¡æ¯è®¾ç½®ä¸º <code>Connection:close</code> ã€‚è¿™æ ·ä»æµè§ˆå™¨é‡Œå¯ä»¥çœ‹åˆ°ï¼Œç¬¬ä¸€æ¬¡ç¬¬äºŒæ¬¡è®¿é—®ä¹‹åï¼Œæ•°æ®è¿”å›ä½†æ˜¯æµè§ˆå™¨è¿æ¥æ²¡æœ‰åœï¼Œç¬¬ä¸‰æ¬¡åæ‰åœä¸‹æ¥ã€‚è¿™è¯´æ˜keepAliveå‚æ•°ç”Ÿæ•ˆäº†ã€‚ä½†æ˜¯æˆ‘ä»¬è¦çŸ¥é“è¿™äº›æ¢è®¨éƒ½æ˜¯ç²—æµ…çš„ï¼Œä»£ç åªæ˜¯æ¼”ç¤ºäº†è¿™ä¸ªæ¦‚å¿µï¼Œæˆ‘ä»¬æ²¡æœ‰å®Œæ•´å®ç°Keep-aliveä»¥åŠChunkedã€‚</p><h2>å°ç»“</h2><p>è¿™èŠ‚è¯¾æˆ‘ä»¬å°†æ— çŠ¶æ€çš„HTTPè¿æ¥æ”¹é€ æˆäº†æœ‰çŠ¶æ€çš„è¿æ¥ï¼Œè¿™æ˜¯é€šè¿‡Cookieå’ŒSessionæ¥å®ç°çš„ã€‚å…·ä½“æ¥è®²ï¼Œé¦–æ¬¡è®¿é—®åï¼Œåœ¨Responseè¿”å›å¤´ä¿¡æ¯ä¸­å°±å¸¦ä¸Šjsessionidå’ŒCookieä¿¡æ¯ï¼Œä¼ åˆ°å®¢æˆ·æµè§ˆå™¨ç«¯åï¼Œå†æ¬¡æäº¤çš„æ—¶å€™ï¼Œæµè§ˆå™¨å¸¦ä¸Šjsessionidä¼ å›ç»™æœåŠ¡å™¨ï¼Œç”¨åŒä¸€ä¸ªjsessionidä»£è¡¨äº†åŒä¸€ä¸ªä¼šè¯ã€‚è¿™æ ·ï¼Œä»ç”¨æˆ·æ¥çœ‹ï¼Œæµè§ˆå™¨æœåŠ¡å™¨å¤šæ¬¡å¾€è¿”äº¤äº’å°±æ˜¯åœ¨ä¸€ä¸ªä¼šè¯ä¸­ï¼Œä»æ•ˆæœä¸Šå°±æ˜¯æŠŠæ— çŠ¶æ€è¿æ¥å˜æˆæœ‰çŠ¶æ€è¿æ¥ã€‚</p><p>ç„¶åæˆ‘ä»¬ç®€å•æ¢è®¨äº†ä¸€ä¸‹Keep-aliveå’Œchunkedæ¨¡å¼ï¼Œè®©åŒä¸€ä¸ªSocketå¯ä»¥ç”¨äºå¤šæ¬¡è®¿é—®ï¼Œå‡å°‘äº†Socketçš„è¿æ¥å’Œå…³é—­ã€‚ä½†æ˜¯æˆ‘ä»¬å®é™…å®ç°ä¸­å¯¹è¿™ä¸ªçš„æ”¯æŒå¹¶ä¸å……åˆ†ï¼Œåé¢ä¹Ÿæ²¡æœ‰ç”¨åˆ°ã€‚</p><p>æœ¬èŠ‚è¯¾å®Œæ•´ä»£ç å‚è§ï¼š<a href=\"https://gitee.com/yaleguo1/minit-learning-demo/tree/geek_chapter09\">https://gitee.com/yaleguo1/minit-learning-demo/tree/geek_chapter09</a></p><h2>æ€è€ƒé¢˜</h2><p>å­¦å®Œäº†è¿™èŠ‚è¯¾çš„å†…å®¹ï¼Œæˆ‘ä»¬å¯ä»¥è¯•ç€ç»ƒä¹ ä¸€ä¸‹ï¼šå†™ä¸€æ®µä»£ç ï¼ŒæŒ‰ç…§chunkedæ¨¡å¼è¿”å›å“åº”å†…å®¹ã€‚</p><p>æ¬¢è¿ä½ æŠŠä½ å†™çš„ä»£ç åˆ†äº«åˆ°è¯„è®ºåŒºï¼Œä¹Ÿæ¬¢è¿ä½ æŠŠè¿™èŠ‚è¯¾çš„å†…å®¹åˆ†äº«ç»™å…¶ä»–æœ‹å‹ï¼Œæˆ‘ä»¬ä¸‹èŠ‚è¯¾å†è§ï¼</p>","comments":[{"had_liked":false,"id":386007,"user_name":"HHğŸ·ğŸ ","can_delete":false,"product_type":"c1","uid":1133678,"ip_address":"å¹¿ä¸œ","ucode":"C50172BDA604D5","user_header":"https://static001.geekbang.org/account/avatar/00/11/4c/6e/5435e214.jpg","comment_is_top":false,"comment_ctime":1703833563,"is_pvip":false,"replies":[{"id":140707,"content":"ä½ å¯èƒ½æœ‰ç‚¹çº ç»“äº†ï¼Œæˆ‘æ˜¯è®²TomcatåŸç†ï¼Œæ‰€ä»¥ä¼šæåˆ°keep-aliveï¼Œå…¶å®ï¼Œä½ ç°åœ¨å¯ä»¥ä¸ç”¨æ·±ç©¶è¿™ä¸ªï¼ŒçŸ¥é“å°±è¡Œï¼Œå› ä¸ºç°åœ¨å…¨éƒ¨éƒ½æ˜¯keep-aliveã€‚æƒ³äº†è§£httpåè®®ï¼Œçœ‹çœ‹ã€Šå›¾è§£httpã€‹å°±æŒºå¥½ï¼Œè¦ç ”ç©¶å®ƒï¼Œçœ‹çœ‹ã€Šhttpæƒå¨æŒ‡å—ã€‹","user_name":"ä½œè€…å›å¤","user_name_real":"ç¼–è¾‘","uid":1864890,"ctime":1704027046,"ip_address":"æ¹–å—","comment_id":386007,"utype":1}],"discussion_count":2,"race_medal":0,"score":2,"product_id":100636401,"comment_content":"åœ¨è¡¥å……ä¸€ç‚¹\n3ã€while (keepAlive) ä¸ºäº†ä¿æŒ socket å­˜æ´»ï¼Œ ä¼šå½±å“é keep-alive çš„è¯·æ±‚ï¼Œ å¯¼è‡´æ­»å¾ªç¯ã€‚ è¿™å—å†…å®¹è€å¸ˆæ˜¯å¦æœ‰å¥½çš„ä¹¦ç±æ¨èæˆ–è€…ä»¥åæœ‰åŠ é¤ï¼Œ è¿™æ ·æˆ‘ä»¬å¯ä»¥è¿›è¡Œæ·±ä¸€å±‚æ¬¡çš„æ¢ç´¢ã€‚","like_count":0,"discussions":[{"author":{"id":1864890,"avatar":"https://thirdwx.qlogo.cn/mmopen/vi_32/cojb2AA3eM620kb7hj7YoOpq8XI0iaPyfajnQLO6icAhuSoYWR1vrdOZB2nmSuETxmuheo3sxec698SD6RhTFxgQ/132","nickname":"Yale Guo","note":"","ucode":"6736810620B3F0","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":634823,"discussion_content":"ä½ å¯èƒ½æœ‰ç‚¹çº ç»“äº†ï¼Œæˆ‘æ˜¯è®²TomcatåŸç†ï¼Œæ‰€ä»¥ä¼šæåˆ°keep-aliveï¼Œå…¶å®ï¼Œä½ ç°åœ¨å¯ä»¥ä¸ç”¨æ·±ç©¶è¿™ä¸ªï¼ŒçŸ¥é“å°±è¡Œï¼Œå› ä¸ºç°åœ¨å…¨éƒ¨éƒ½æ˜¯keep-aliveã€‚æƒ³äº†è§£httpåè®®ï¼Œçœ‹çœ‹ã€Šå›¾è§£httpã€‹å°±æŒºå¥½ï¼Œè¦ç ”ç©¶å®ƒï¼Œçœ‹çœ‹ã€Šhttpæƒå¨æŒ‡å—ã€‹","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1704027046,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"æ¹–å—","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2,\"source\":0}","child_discussion_number":1,"child_discussions":[{"author":{"id":1133678,"avatar":"https://static001.geekbang.org/account/avatar/00/11/4c/6e/5435e214.jpg","nickname":"HHğŸ·ğŸ ","note":"","ucode":"C50172BDA604D5","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":1864890,"avatar":"https://thirdwx.qlogo.cn/mmopen/vi_32/cojb2AA3eM620kb7hj7YoOpq8XI0iaPyfajnQLO6icAhuSoYWR1vrdOZB2nmSuETxmuheo3sxec698SD6RhTFxgQ/132","nickname":"Yale Guo","note":"","ucode":"6736810620B3F0","race_medal":0,"user_type":2,"is_pvip":false},"discussion":{"id":634835,"discussion_content":"å¥½çš„","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1704065112,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":634823,"ip_address":"å¹¿ä¸œ","group_id":0},"score":634835,"extra":""}]}]},{"had_liked":false,"id":386005,"user_name":"HHğŸ·ğŸ ","can_delete":false,"product_type":"c1","uid":1133678,"ip_address":"å¹¿ä¸œ","ucode":"C50172BDA604D5","user_header":"https://static001.geekbang.org/account/avatar/00/11/4c/6e/5435e214.jpg","comment_is_top":false,"comment_ctime":1703832102,"is_pvip":false,"replies":[{"id":140706,"content":"1ï¼ŒåŒæ–¹éƒ½å¯ä»¥æ§åˆ¶\n2ï¼Œchunkedç°åœ¨æ˜¯å¸¸ç”¨çš„ï¼Œhttp1.1é»˜è®¤å°±æ˜¯keep-aliveï¼Œè¦è¡¨ç¤ºhttpå®Œæ¯•æˆ–è€…æŒ‡å®šé•¿åº¦æˆ–è€…ç”¨chunkedã€‚ä½ æ³¨æ„çœ‹ä¸€ä¸‹æµè§ˆå™¨networkè¿”å›ï¼Œåº”è¯¥éƒ½æ˜¯chunkedï¼Œè¿™ä¸ªå¹¶ä¸æ˜¯å¯¹åº”äºä»€ä¹ˆç‰¹å®šåœºåˆã€‚","user_name":"ä½œè€…å›å¤","user_name_real":"ç¼–è¾‘","uid":1864890,"ctime":1704026791,"ip_address":"æ¹–å—","comment_id":386005,"utype":1}],"discussion_count":2,"race_medal":0,"score":2,"product_id":100636401,"comment_content":"è€å¸ˆï¼Œ æˆ‘æœ‰å‡ ä¸ªé—®é¢˜\n1ã€æœåŠ¡å™¨ç«¯å’Œå®¢æˆ·ç«¯åŒæ–¹æ˜¯å¦éƒ½å¯ä»¥æ§åˆ¶ close Connection å’Œä½¿ç”¨ chunked ä¼ è¾“ï¼Ÿ\n2ã€chunked åº”ç”¨åœºæ™¯æœ‰å“ªäº›ï¼Ÿ  ç›®å‰æƒ³åˆ°å¤§æ–‡ä»¶ä¼ è¾“ï¼Œ åœ¨ç°æœ‰ä»£ç åŸºç¡€ä¸Šï¼Œ è‡ªå·±åŠ¨æ‰‹å°è¯•äº†å®¢æˆ·ç«¯ä¼ è¾“å°é‡æ–‡æœ¬æ•°æ®ï¼Œ å®¢æˆ·ç«¯å¤šæ¬¡ä½¿ç”¨socket è¯·æ±‚æœåŠ¡ç«¯ï¼Œ ä½†æœåŠ¡ç«¯å¹¶éæ”¶åˆ°ä¸€æ¬¡è¯·æ±‚å°±è¿”å›ä¸€æ¬¡ç»“æœï¼Œ finishResponse ä¹‹åä¹Ÿæ˜¯æ— æ³•æ”¶åˆ°æœåŠ¡ç«¯è¿”å›çš„ç»“æœï¼Œ å¿…é¡» close Connection æ‰èƒ½æ”¶åˆ°æœåŠ¡ç«¯çš„è¯·æ±‚ï¼Œå¹¶ä¸”æ˜¯å¤šæ¬¡è¯·æ±‚åˆå¹¶è¿”å›çš„ç»“æœï¼› è¿™è·Ÿæˆ‘æƒ³çš„æœ‰ç‚¹ä¸ä¸€æ ·ï¼Œ æˆ‘æƒ³çš„æ˜¯è¿™ä¸ªå¤ç”¨çš„ socket ç„¶åè¯·æ±‚ä¸€æ¬¡å°±è¿”å›ä¸€æ¬¡ç»“æœï¼Œ ç„¶åå®¢æˆ·ç«¯è¿›è¡Œå¤„ç†ï¼Œ æ¯”å¦‚å®¢æˆ·ç«¯è¯·æ±‚ä¸€ä¸ªjsã€ä¸€ä¸ª cssã€ä¸€ä¸ª htmlï¼Œ æ˜¯éœ€è¦  close Connection ä¹‹åæ‰èƒ½è¿”å›å—ï¼Ÿ ä¸çŸ¥é“æ˜¯å“ªæ–¹é¢æƒ³çš„ä¸å¯¹ï¼Œ è¿˜å¾—è€å¸ˆæŒ‡ç‚¹ã€‚ ","like_count":0,"discussions":[{"author":{"id":1864890,"avatar":"https://thirdwx.qlogo.cn/mmopen/vi_32/cojb2AA3eM620kb7hj7YoOpq8XI0iaPyfajnQLO6icAhuSoYWR1vrdOZB2nmSuETxmuheo3sxec698SD6RhTFxgQ/132","nickname":"Yale Guo","note":"","ucode":"6736810620B3F0","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":634822,"discussion_content":"1ï¼ŒåŒæ–¹éƒ½å¯ä»¥æ§åˆ¶\n2ï¼Œchunkedç°åœ¨æ˜¯å¸¸ç”¨çš„ï¼Œhttp1.1é»˜è®¤å°±æ˜¯keep-aliveï¼Œè¦è¡¨ç¤ºhttpå®Œæ¯•æˆ–è€…æŒ‡å®šé•¿åº¦æˆ–è€…ç”¨chunkedã€‚ä½ æ³¨æ„çœ‹ä¸€ä¸‹æµè§ˆå™¨networkè¿”å›ï¼Œåº”è¯¥éƒ½æ˜¯chunkedï¼Œè¿™ä¸ªå¹¶ä¸æ˜¯å¯¹åº”äºä»€ä¹ˆç‰¹å®šåœºåˆã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1704026791,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"æ¹–å—","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2,\"source\":0}","child_discussion_number":1,"child_discussions":[{"author":{"id":1133678,"avatar":"https://static001.geekbang.org/account/avatar/00/11/4c/6e/5435e214.jpg","nickname":"HHğŸ·ğŸ ","note":"","ucode":"C50172BDA604D5","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":1864890,"avatar":"https://thirdwx.qlogo.cn/mmopen/vi_32/cojb2AA3eM620kb7hj7YoOpq8XI0iaPyfajnQLO6icAhuSoYWR1vrdOZB2nmSuETxmuheo3sxec698SD6RhTFxgQ/132","nickname":"Yale Guo","note":"","ucode":"6736810620B3F0","race_medal":0,"user_type":2,"is_pvip":false},"discussion":{"id":634836,"discussion_content":"æ˜ç™½äº†ï¼Œè°¢è°¢è€å¸ˆ","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1704065429,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":634822,"ip_address":"å¹¿ä¸œ","group_id":0},"score":634836,"extra":""}]}]},{"had_liked":false,"id":385935,"user_name":"peter","can_delete":false,"product_type":"c1","uid":1058183,"ip_address":"åŒ—äº¬","ucode":"261C3FC001DE2D","user_header":"https://static001.geekbang.org/account/avatar/00/10/25/87/f3a69d1b.jpg","comment_is_top":false,"comment_ctime":1703686814,"is_pvip":false,"replies":[{"id":140710,"content":"keep-aliveæ˜¯æµè§ˆå™¨ç»™å®šçš„ï¼Œç°åœ¨å·²ç»æ˜¯é»˜è®¤çš„äº†ã€‚\ntestæ˜¯åŒ…åï¼Œä½ çœ‹çœ‹ä½ çš„javaé‡Œé¢çš„packageã€‚ä¸šåŠ¡ç¨‹åºæ–¹é¢çš„é—®é¢˜ï¼Œåªæœ‰é ä½ è‡ªå·±æ…¢æ…¢è°ƒè¯•äº†ã€‚\n","user_name":"ä½œè€…å›å¤","user_name_real":"ç¼–è¾‘","uid":1864890,"ctime":1704027458,"ip_address":"æ¹–å—","comment_id":385935,"utype":1}],"discussion_count":1,"race_medal":0,"score":2,"product_id":100636401,"comment_content":"è¯·æ•™è€å¸ˆå‡ ä¸ªé—®é¢˜ï¼š\nQ1ï¼šHttpè¯·æ±‚å¤´ä¸­çš„â€œconnection: keep-aliveâ€æ˜¯è°æ§åˆ¶çš„ï¼Ÿ\nè¯¥éƒ¨åˆ†æ˜¯æµè§ˆå™¨å¡«çš„ï¼Œæµè§ˆå™¨æ˜¯è‡ªåŠ¨å¡«çš„å—ï¼Ÿåœ¨å¡«çš„æ—¶å€™æ˜¯å¦å—åˆ°äº†æœåŠ¡å™¨çš„æ§åˆ¶ï¼Ÿ\nQ2ï¼šé™æ€è®¿é—®ä¸èƒ½è¿”å›å†…å®¹\næœ¬è¯¾ç¨‹ä»£ç ï¼Œè¿è¡Œååœ¨æµè§ˆå™¨ä¸­è¾“å…¥ï¼šhttp:&#47;&#47;localhost:8080&#47;hello.txt\næµè§ˆå™¨ä¸Šæ²¡æœ‰ä»»ä½•è¾“å‡ºï¼Œç©ºç™½ï¼Œä¸ºä»€ä¹ˆï¼Ÿ\n\nQ3ï¼šé”™è¯¯çš„servletç½‘å€ä¹Ÿèƒ½è¿”å›\nè®¿é—®åœ°å€ï¼šhttp:&#47;&#47;localhost:8080&#47;servlet&#47;test.HelloServletï¼Œæ­¤ç½‘å€æ˜¯ä¸å°å¿ƒæ•²é”™äº†ï¼Œåœ¨ServletProcessor.javaä¸­æ‰“å°å‡ºæ¥çš„servletNameå°±æ˜¯test.HelloServletï¼Œæ¥ä¸‹æ¥çš„ä»£ç â€œservletClass = HttpConnector.loader.loadClass(servletName);â€ç«Ÿç„¶æ²¡æœ‰æŠ¥é”™ï¼Œä»£ç ä¸­åªæœ‰HelloServletå’ŒTestServletï¼Œå¹¶æ²¡æœ‰test.HelloServletï¼Œä¸ºä»€ä¹ˆloadClassè¿˜èƒ½æˆåŠŸï¼Ÿ\n\næµè§ˆå™¨ä¸Šæ˜¾ç¤ºçš„å†…å®¹æ˜¯â€œHello World ä½ å¥½â€ï¼Œæ ¹æ®æ­¤å†…å®¹æ¨æµ‹ï¼Œåº”è¯¥æ˜¯ç”¨äº†HelloServletã€‚ä½†æˆ‘åœ¨HelloServletçš„è¾“å‡ºä¸­ï¼Œéšä¾¿å¢åŠ å­—ç¬¦ï¼š&quot;Hello World 111ä½ å¥½123&quot; ï¼Œé‡æ–°ç¼–è¯‘è¿è¡Œï¼Œ\nä½†æµè§ˆå™¨ä¸Šæ˜¾ç¤ºçš„è¿˜æ˜¯â€œHello World ä½ å¥½â€ï¼Œä¸ºä»€ä¹ˆï¼Ÿ\n\nQ4ï¼šå°é—®é¢˜ï¼šHelloServlet.javaä¸­ä¹Ÿå¤šäº†ä¸€ä¸ªå¯¼åŒ…è¯­å¥ã€‚\nâ€œimport jdk.internal.util.xml.impl.Pair;â€\nä¼°è®¡å’Œä¸ŠèŠ‚è¯¾çš„ä¸€æ ·ï¼Œä¹Ÿæ˜¯IDEè‡ªåŠ¨å¯¼å…¥çš„ï¼Œæˆ‘å·²æ³¨é‡Šæ‰è¯¥ä»£ç ã€‚","like_count":0,"discussions":[{"author":{"id":1864890,"avatar":"https://thirdwx.qlogo.cn/mmopen/vi_32/cojb2AA3eM620kb7hj7YoOpq8XI0iaPyfajnQLO6icAhuSoYWR1vrdOZB2nmSuETxmuheo3sxec698SD6RhTFxgQ/132","nickname":"Yale Guo","note":"","ucode":"6736810620B3F0","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":634827,"discussion_content":"keep-aliveæ˜¯æµè§ˆå™¨ç»™å®šçš„ï¼Œç°åœ¨å·²ç»æ˜¯é»˜è®¤çš„äº†ã€‚\ntestæ˜¯åŒ…åï¼Œä½ çœ‹çœ‹ä½ çš„javaé‡Œé¢çš„packageã€‚ä¸šåŠ¡ç¨‹åºæ–¹é¢çš„é—®é¢˜ï¼Œåªæœ‰é ä½ è‡ªå·±æ…¢æ…¢è°ƒè¯•äº†ã€‚\n","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1704027458,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"æ¹–å—","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2,\"source\":0}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":385909,"user_name":"topå•¦å®ƒ","can_delete":false,"product_type":"c1","uid":2568744,"ip_address":"ä¸Šæµ·","ucode":"1F2656293D1B9F","user_header":"https://static001.geekbang.org/account/avatar/00/27/32/28/078ec46c.jpg","comment_is_top":false,"comment_ctime":1703650205,"is_pvip":false,"replies":[{"id":140671,"content":"å¬ä¸€ä¸‹ä½ çš„å»ºè®®","user_name":"ä½œè€…å›å¤","user_name_real":"ç¼–è¾‘","uid":1864890,"ctime":1703821397,"ip_address":"æ¹–å—","comment_id":385909,"utype":1}],"discussion_count":3,"race_medal":0,"score":2,"product_id":100636401,"comment_content":"åé¢è¦æ‰‹å†™ä»€ä¹ˆï¼Ÿ","like_count":0,"discussions":[{"author":{"id":1864890,"avatar":"https://thirdwx.qlogo.cn/mmopen/vi_32/cojb2AA3eM620kb7hj7YoOpq8XI0iaPyfajnQLO6icAhuSoYWR1vrdOZB2nmSuETxmuheo3sxec698SD6RhTFxgQ/132","nickname":"Yale Guo","note":"","ucode":"6736810620B3F0","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":634699,"discussion_content":"å¬ä¸€ä¸‹ä½ çš„å»ºè®®","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1703821397,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"æ¹–å—","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2,\"source\":0}","child_discussion_number":1,"child_discussions":[{"author":{"id":2568744,"avatar":"https://static001.geekbang.org/account/avatar/00/27/32/28/078ec46c.jpg","nickname":"topå•¦å®ƒ","note":"","ucode":"1F2656293D1B9F","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":1864890,"avatar":"https://thirdwx.qlogo.cn/mmopen/vi_32/cojb2AA3eM620kb7hj7YoOpq8XI0iaPyfajnQLO6icAhuSoYWR1vrdOZB2nmSuETxmuheo3sxec698SD6RhTFxgQ/132","nickname":"Yale Guo","note":"","ucode":"6736810620B3F0","race_medal":0,"user_type":2,"is_pvip":false},"discussion":{"id":634706,"discussion_content":"mq","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1703824060,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":634699,"ip_address":"ä¸Šæµ·","group_id":0},"score":634706,"extra":""}]},{"author":{"id":1786951,"avatar":"","nickname":"Geek_50a5cc","note":"","ucode":"0F6C1C2552261F","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":635133,"discussion_content":"redis","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1704437331,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":"åŒ—äº¬","group_id":0},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":394005,"user_name":"wild wings.Luv","can_delete":false,"product_type":"c1","uid":3790749,"ip_address":"ä¸Šæµ·","ucode":"D76D40B24B4998","user_header":"https://static001.geekbang.org/account/avatar/00/39/d7/9d/73390cc0.jpg","comment_is_top":false,"comment_ctime":1725526327,"is_pvip":false,"replies":null,"discussion_count":0,"race_medal":0,"score":2,"product_id":100636401,"comment_content":"socketæ²¡æœ‰å…³é—­ã€‚ä½†æ˜¯åŒä¸€ä¸ªç”¨æˆ·çš„ä¸‹ä¸€ä¸ªhttpè¯·æ±‚ï¼Œéœ€è¦æ‰¾åˆ°å¯¹åº”çš„socketå—ï¼Œè¿˜æ˜¯ä¸éœ€è¦ï¼Ÿ","like_count":0},{"had_liked":false,"id":389712,"user_name":"Geek_320730","can_delete":false,"product_type":"c1","uid":3035552,"ip_address":"åŒ—äº¬","ucode":"CF7E6C8E91D2C4","user_header":"https://thirdwx.qlogo.cn/mmopen/vi_32/XWv3mvIFORNgRk9wF8QLb9aXfh1Uz1hADtUmlFwQJVxIzhBf8HWc4QqU7iaTzj8wB5p5QJLRAvlQNrOqXtrg1Og/132","comment_is_top":false,"comment_ctime":1713292382,"is_pvip":false,"replies":null,"discussion_count":0,"race_medal":0,"score":2,"product_id":100636401,"comment_content":"æŒ‰ç…§ chunked æ¨¡å¼è¿”å›å“åº”å†…å®¹: https:&#47;&#47;github.com&#47;kuifir&#47;MiniTomcat&#47;tree&#47;test-chunk","like_count":0}]}