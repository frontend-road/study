{"id":98987,"title":"05 | [视频]opm项目导读","content":"<p><video poster=\"https://static001.geekbang.org/resource/image/b8/a2/b8e479499551550984792f338043a8a2.jpg\" preload=\"none\" controls=\"\"><source src=\"https://media001.geekbang.org/customerTrans/fe4a99b62946f2c31c2095c167b26f9c/32bb5df8-16d13f123cf-0000-0000-01d-dbacd.mp4\" type=\"video/mp4\"><source src=\"https://media001.geekbang.org/71f11392644a4bd19a04901804f3faa2/b54cb30cb2b648d1a3e6392ecc351626-e6d62449b88ad07255d04f874d679181-sd.m3u8\" type=\"application/x-mpegURL\"><source src=\"https://media001.geekbang.org/71f11392644a4bd19a04901804f3faa2/b54cb30cb2b648d1a3e6392ecc351626-32e46e96bebe336fa79a9419934ca38a-hd.m3u8\" type=\"application/x-mpegURL\"></video></p><p>你好，我是温铭。</p><p>今天的内容，我特意安排成了视频的形式来讲解。不过，在你看视频之前，我想先问你这么几个问题：</p><ul>\n<li>在真实的项目中，你会配置 nginx.conf，以便和 Lua 代码联动吗？</li>\n<li>你清楚 OpenResty 的代码结构该如何组织吗？</li>\n</ul><p>这两个问题，也是今天视频课要解决的核心内容，希望你可以先自己思考一下，并带着问题来学习今天的视频内容。</p><p>同时，我会给出相应的文字介绍，方便你在听完视频内容后，及时总结与复习。下面是今天这节课的文字介绍部分。</p><h2>今日核心</h2><p><a href=\"https://github.com/openresty/opm/\">opm</a> 是 OpenResty 中为数不多的网站类项目，而里面的代码，基本上是由 OpenResty 的作者亲自操刀完成的。</p><p>很多 OpenResty 的使用者并不清楚，如何在真实的项目中去配置 nginx.conf， 以及如何组织 Lua 的代码结构。确实，在这方面可以参考的开源项目并不多，给学习使用带了不小的阻力。</p><p>不过，借助今天的这个项目，你就可以克服这一点了。你将会熟悉一个OpenResty 项目的结构和开发流程，还能看到 OpenResty 的作者是如何编写业务类 Lua 代码的。</p><p>opm 还涉及到数据库的操作，它后台数据的储存，使用的是PostgreSQL ，你可以顺便了解下 OpenResty 和数据库是如何交互的。</p><!-- [[[read_end]]] --><p>除此之外，这个项目还涉及到一些简单的性能优化，也是为了后面专门设立的性能优化内容做个铺垫。</p><p>最后，浏览完 opm 这个项目后，你可以自行看下另外一个类似的项目，那就是 OpenResty 的官方网站：<a href=\"https://github.com/openresty/openresty.org\">https://github.com/openresty/openresty.org</a>。</p><h2>课件参考</h2><p>今天的课件已经上传到了我的GitHub上，你可以自己下载学习。</p><p>链接如下：<a href=\"https://github.com/iresty/geektime-slides\">https://github.com/iresty/geektime-slides</a></p><p>如果有不清楚的地方，你可以在留言区提问，另也可以在留言区分享你的学习心得。期待与你的对话，也欢迎你把这篇文章分享给你的同事、朋友，我们一起交流、一起进步。</p>","neighbors":{"left":{"article_title":"04 | 如何管理第三方包？从包管理工具luarocks和opm说起","id":98660},"right":{"article_title":"06 | OpenResty 中用到的 NGINX 知识","id":99522}},"comments":[{"had_liked":false,"id":101399,"user_name":"业余草","can_delete":false,"product_type":"c1","uid":1126538,"ip_address":"","ucode":"99BDC1E629049D","user_header":"https://static001.geekbang.org/account/avatar/00/11/30/8a/b5ca7286.jpg","comment_is_top":false,"comment_ctime":1559801287,"is_pvip":false,"replies":[{"id":"36657","content":"：）","user_name":"作者回复","comment_id":101399,"uid":"1017955","ip_address":"","utype":1,"ctime":1559957812,"user_name_real":"温铭@OpenResty"}],"discussion_count":1,"race_medal":0,"score":"18739670471","product_id":100028301,"comment_content":"讲师是在秀发际线😊","like_count":4,"discussions":[{"author":{"id":1017955,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/88/63/88cf886d.jpg","nickname":"温铭@APISIX","note":"","ucode":"343567571DA16A","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":452945,"discussion_content":"：）","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1559957812,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":101089,"user_name":"洁","can_delete":false,"product_type":"c1","uid":1510376,"ip_address":"","ucode":"154C10D830FB70","user_header":"https://static001.geekbang.org/account/avatar/00/17/0b/e8/1deb2efc.jpg","comment_is_top":false,"comment_ctime":1559714722,"is_pvip":false,"replies":[{"id":"36599","content":"$prefix 就是 nginx 启动时候 -p 后面的路径。比如：nginx -p &#47;usr&#47;local&#47;openresty, 那么 $prefix 的值就是  &#47;usr&#47;local&#47;openresty","user_name":"作者回复","comment_id":101089,"uid":"1017955","ip_address":"","utype":1,"ctime":1559863930,"user_name_real":"温铭@OpenResty"}],"discussion_count":1,"race_medal":0,"score":"10149649314","product_id":100028301,"comment_content":"lua_package_path &quot;$prefix&#47;lua&#47;?.lua;$prefix&#47;lua&#47;vendor&#47;?.lua;;&quot;;对于这个路径的$prefix还是有一点不太理解，可以在具体一点吗？","like_count":3,"discussions":[{"author":{"id":1017955,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/88/63/88cf886d.jpg","nickname":"温铭@APISIX","note":"","ucode":"343567571DA16A","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":452799,"discussion_content":"$prefix 就是 nginx 启动时候 -p 后面的路径。比如：nginx -p /usr/local/openresty, 那么 $prefix 的值就是  /usr/local/openresty","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1559863930,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":100945,"user_name":"一步","can_delete":false,"product_type":"c1","uid":1005391,"ip_address":"","ucode":"73CEA468CE70C3","user_header":"https://static001.geekbang.org/account/avatar/00/0f/57/4f/6fb51ff1.jpg","comment_is_top":false,"comment_ctime":1559693869,"is_pvip":true,"replies":[{"id":"36596","content":"两个分号的意思是默认的查找路径","user_name":"作者回复","comment_id":100945,"uid":"1017955","ip_address":"","utype":1,"ctime":1559863825,"user_name_real":"温铭@OpenResty"}],"discussion_count":1,"race_medal":0,"score":"10149628461","product_id":100028301,"comment_content":"lua_package_path &quot;$prefix&#47;lua&#47;?.lua;$prefix&#47;lua&#47;vendor&#47;?.lua;;&quot;;<br><br>这个后面为什么有两个 分号呢 ？","like_count":3,"discussions":[{"author":{"id":1017955,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/88/63/88cf886d.jpg","nickname":"温铭@APISIX","note":"","ucode":"343567571DA16A","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":452749,"discussion_content":"两个分号的意思是默认的查找路径","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1559863825,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":152161,"user_name":"北冥Master","can_delete":false,"product_type":"c1","uid":1014142,"ip_address":"","ucode":"EBCCEC79AFC5DF","user_header":"https://static001.geekbang.org/account/avatar/00/0f/79/7e/c38ac02f.jpg","comment_is_top":false,"comment_ctime":1573895118,"is_pvip":false,"discussion_count":1,"race_medal":0,"score":"5868862414","product_id":100028301,"comment_content":"变量前面要加local，函数前面是不是也应该加：local function _M.do_upload() end","like_count":1,"discussions":[{"author":{"id":1255432,"avatar":"","nickname":"周杨","note":"","ucode":"CE0F1D03554A2C","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":394585,"discussion_content":"加上更好点","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1631949552,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":104607,"user_name":"wusiration","can_delete":false,"product_type":"c1","uid":1104438,"ip_address":"","ucode":"A9403377054F1E","user_header":"https://static001.geekbang.org/account/avatar/00/10/da/36/ac0ff6a7.jpg","comment_is_top":false,"comment_ctime":1560783705,"is_pvip":false,"replies":[{"id":"37917","content":"后面有 nginx 的基础知识章节介绍，对于 nginx 能看懂配置，知道它的大概原理就行了","user_name":"作者回复","comment_id":104607,"uid":"1017955","ip_address":"","utype":1,"ctime":1560840548,"user_name_real":"温铭@OpenResty"}],"discussion_count":1,"race_medal":0,"score":"5855751001","product_id":100028301,"comment_content":"1.需要在lua_package_path中配置lua的源码路径<br>2.参照opm和openresty.org，源码结构均为util&#47;,conf&#47;,templates&#47;,lua&#47;<br><br>老师，学习openresty需要对nginx了解到什么程度啊","like_count":1,"discussions":[{"author":{"id":1017955,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/88/63/88cf886d.jpg","nickname":"温铭@APISIX","note":"","ucode":"343567571DA16A","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":454340,"discussion_content":"后面有 nginx 的基础知识章节介绍，对于 nginx 能看懂配置，知道它的大概原理就行了","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1560840548,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":169376,"user_name":"qinsi","can_delete":false,"product_type":"c1","uid":1667175,"ip_address":"","ucode":"090D9C4068FF12","user_header":"https://static001.geekbang.org/account/avatar/00/19/70/67/0c1359c2.jpg","comment_is_top":false,"comment_ctime":1578323857,"is_pvip":true,"discussion_count":0,"race_medal":0,"score":"1578323857","product_id":100028301,"comment_content":"luarocks.org是通过Lapis框架用MoonScript写的：https:&#47;&#47;luarocks.org&#47;about","like_count":0},{"had_liked":false,"id":114618,"user_name":"X.","can_delete":false,"product_type":"c1","uid":1606024,"ip_address":"","ucode":"2B35AC0A4A1F17","user_header":"https://static001.geekbang.org/account/avatar/00/18/81/88/1dc092cf.jpg","comment_is_top":false,"comment_ctime":1563351544,"is_pvip":false,"replies":[{"id":"42832","content":"orange 我不太清楚，建议最好到 orange 的 issue 里面提问。","user_name":"作者回复","comment_id":114618,"uid":"1017955","ip_address":"","utype":1,"ctime":1563973595,"user_name_real":"温铭@OpenResty"}],"discussion_count":2,"race_medal":0,"score":"1563351544","product_id":100028301,"comment_content":"大佬好，我用OR学习部署orangeAPI网关碰见点问题。<br>我搭建的实验环境是CentOS 7.6.1810，听你的在官网用yum安装的最新版OR没用编译安装（编译安装之前问题更多，，）然后nginx -v resty -v 都可以查看到信息，nginx也起来了，浏览网页也能看到OpenResty<br>启动orange的时候最后一步提示：<br>[INFO] ORANGE_CONF=&#47;usr&#47;local&#47;orange&#47;conf&#47;orange.conf nginx -p &#47;usr&#47;local&#47;orange -c &#47;usr&#47;local&#47;orange&#47;conf&#47;nginx.conf <br>nginx: [error] init_by_lua error: init_by_lua:2: module &#39;orange.orange&#39; not found:<br>1：我的lua_package_path &quot;$prefix&#47;usr&#47;local&#47;lor&#47;?.lua;;$prefix&#47;usr&#47;local&#47;orange&#47;?.lua;;&quot;; 是这么配置的，我看orange需要lor的支持，这个路径是只需要配置lor的lua路径，还是要把orange lua的路径也写上，就是说以后用的lua不止一个，是一起写在这么。<br>2：我看他意思是init_by_lua找不到orange.orange，我的是这样的<br> init_by_lua_block {<br>        local orange = require(&quot;orange.orange&quot;)<br>        local env_orange_conf = os.getenv(&quot;ORANGE_CONF&quot;)<br>        print(string.char(27) .. &quot;[34m&quot; .. &quot;[INFO]&quot; .. string.char(27).. &quot;[0m&quot;, [[the env[ORANGE_CONF] is ]], env_orange_conf)<br><br>        -- Here, you can also use the absolute path, eg: local confige_file = &quot;&#47;home&#47;openresty&#47;orange&#47;conf&#47;orange.conf&quot;<br>        local config_file = env_orange_conf or ngx.config.prefix().. &quot;&#47;conf&#47;orange.conf&quot;<br>        local config, store = orange.init({<br>            config = config_file<br>        })<br>我看你视频里说nginx.conf尽量少配置，我基本没动只改了lua_package_path ，但是orange默认的init_by_lua_block {<br>        local orange = require(&quot;orange.orange&quot;) 这里面不是一个文件，是orange.orange，他有lua的文件在orange的文件夹下还有个orange文件夹 这里面才有Lua文件 应该是启动文件吧，起不来跟这个 . 有关么。 <br>万分感谢","like_count":0,"discussions":[{"author":{"id":1017955,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/88/63/88cf886d.jpg","nickname":"温铭@APISIX","note":"","ucode":"343567571DA16A","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":458747,"discussion_content":"orange 我不太清楚，建议最好到 orange 的 issue 里面提问。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1563973595,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1606024,"avatar":"https://static001.geekbang.org/account/avatar/00/18/81/88/1dc092cf.jpg","nickname":"X.","note":"","ucode":"2B35AC0A4A1F17","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":2208,"discussion_content":"2019/07/17 03:55:44 [error] 8919#8919: init_by_lua error: init_by_lua:2: module &#39;orange.orange&#39; not found:\n\tno field package.preload[&#39;orange.orange&#39;]\n\tno file &#39;/usr/local/orange//usr/local/lor/orange/orange.lua&#39;\n\tno file &#39;/usr/local/openresty/site/lualib/orange/orange.ljbc&#39;\n\tno file &#39;/usr/local/openresty/site/lualib/orange/orange/init.ljbc&#39;\n\tno file &#39;/usr/local/openresty/lualib/orange/orange.ljbc&#39;\n\tno file &#39;/usr/local/openresty/lualib/orange/orange/init.ljbc&#39;\n\tno file &#39;/usr/local/openresty/site/lualib/orange/orange.lua&#39;\n\tno file &#39;/usr/local/openresty/site/lualib/orange/orange/init.lua&#39;\n\tno file &#39;/usr/local/openresty/lualib/orange/orange.lua&#39;\n\tno file &#39;/usr/local/openresty/lualib/orange/orange/init.lua&#39;\n\tno file &#39;./orange/orange.lua&#39;\n\tno file &#39;/usr/local/openresty/luajit/share/luajit-2.1.0-beta3/orange/orange.lua&#39;\n\tno file &#39;/usr/local/share/lua/5.1/orange/orange.lua&#39;\n\tno file &#39;/usr/local/share/lua/5.1/orange/orange/init.lua&#39;\n\tno file &#39;/usr/local/openresty/luajit/share/lua/5.1/orange/orange.lua&#39;\n\tno file &#39;/usr/local/openresty/luajit/share/lua/5.1/orange/orange/init.lua&#39;\n\tno file &#39;/usr/local/orange//usr/local/orange/orange/orange.lua&#39;\n\tno file &#39;/usr/local/openresty/site/lualib/orange/orange.ljbc&#39;\n\tno file &#39;/usr/local/openresty/site/lualib/orange/orange/init.ljbc&#39;\n\tno file &#39;/usr/local/openresty/lualib/orange/orange.ljbc&#39;\n\tno file &#39;/usr/local/openresty/lualib/orange/orange/init.ljbc&#39;\n\tno file &#39;/usr/local/openresty/site/lualib/orange/orange.lua&#39;\n\tno file &#39;/usr/local/openresty/site/lualib/orange/orange/init.lua&#39;\n\tno file &#39;/usr/local/openresty/lualib/orange/orange.lua&#39;\n\tno file &#39;/usr/local/openresty/lualib/orange/orange/init.lua&#39;\n\tno file &#39;./orange/orange.lua&#39;\n\tno file &#39;/usr/local/openresty/luajit/share/luajit-2.1.0-beta3/orange/orange.lua&#39;\n\t.\n        .\n","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1563354214,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":112864,"user_name":"小鱼👍","can_delete":false,"product_type":"c1","uid":1584972,"ip_address":"","ucode":"E04E6A7660AE78","user_header":"https://static001.geekbang.org/account/avatar/00/18/2f/4c/04441552.jpg","comment_is_top":false,"comment_ctime":1562833713,"is_pvip":false,"replies":[{"id":"41174","content":"怎么安装的呢？这个是少了 perl 的库，需要用 cpanm 这样的包管理器安装下","user_name":"作者回复","comment_id":112864,"uid":"1017955","ip_address":"","utype":1,"ctime":1562904482,"user_name_real":"温铭@OpenResty"}],"discussion_count":2,"race_medal":0,"score":"1562833713","product_id":100028301,"comment_content":"opm命令报错<br>Can&#39;t locate Digest&#47;MD5.pm in @INC (@INC contains: &#47;usr&#47;local&#47;lib64&#47;perl5 &#47;usr&#47;local&#47;share&#47;perl5 &#47;usr&#47;lib64&#47;perl5&#47;vendor_perl &#47;usr&#47;share&#47;perl5&#47;vendor_perl &#47;usr&#47;lib64&#47;perl5 &#47;usr&#47;share&#47;perl5 .) at &#47;usr&#47;bin&#47;opm line 16.<br>BEGIN failed--compilation aborted at &#47;usr&#47;bin&#47;opm line 16","like_count":0,"discussions":[{"author":{"id":1017955,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/88/63/88cf886d.jpg","nickname":"温铭@APISIX","note":"","ucode":"343567571DA16A","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":457935,"discussion_content":"怎么安装的呢？这个是少了 perl 的库，需要用 cpanm 这样的包管理器安装下","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1562904482,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1162734,"avatar":"https://static001.geekbang.org/account/avatar/00/11/bd/ee/87679555.jpg","nickname":"卫中","note":"","ucode":"1B9759D9D42B06","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":590828,"discussion_content":"可以尝试：yum install -y perl-Digest-MD5","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1666092601,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":"广东"},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":101689,"user_name":"小羊","can_delete":false,"product_type":"c1","uid":1000877,"ip_address":"","ucode":"50239B7052BFD2","user_header":"http://thirdwx.qlogo.cn/mmopen/vi_32/DYAIOgq83epgKOrnIOAjzXJgb0f0ljTZLeqrMXYaHic1MKQnPbAzxSKgYxd7K2DlqRW8SibTkwV2MAUZ4OlgRnNw/132","comment_is_top":false,"comment_ctime":1559916659,"is_pvip":false,"replies":[{"id":"36658","content":"大概的原因是跳过了 Lua 层面的字符串拼接，print 函数不仅接受字符串作为参数，也接受数组作为参数。后面性能优化章节还会继续这个话题。","user_name":"作者回复","comment_id":101689,"uid":"1017955","ip_address":"","utype":1,"ctime":1559957902,"user_name_real":"温铭@OpenResty"}],"discussion_count":1,"race_medal":0,"score":"1559916659","product_id":100028301,"comment_content":"i = i+1 下标计算 ， 最后的 print 没有听懂。。。  为什么有性能优化？","like_count":0,"discussions":[{"author":{"id":1017955,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/88/63/88cf886d.jpg","nickname":"温铭@APISIX","note":"","ucode":"343567571DA16A","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":453071,"discussion_content":"大概的原因是跳过了 Lua 层面的字符串拼接，print 函数不仅接受字符串作为参数，也接受数组作为参数。后面性能优化章节还会继续这个话题。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1559957902,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":101083,"user_name":"亞","can_delete":false,"product_type":"c1","uid":1548143,"ip_address":"","ucode":"2AF0771F869F59","user_header":"https://static001.geekbang.org/account/avatar/00/17/9f/6f/0e341408.jpg","comment_is_top":false,"comment_ctime":1559712034,"is_pvip":false,"replies":[{"id":"36597","content":"慢慢来，先有一个大概的印象","user_name":"作者回复","comment_id":101083,"uid":"1017955","ip_address":"","utype":1,"ctime":1559863853,"user_name_real":"温铭@OpenResty"}],"discussion_count":2,"race_medal":0,"score":"1559712034","product_id":100028301,"comment_content":"老师，作为一个刚接触的菜鸟。感觉都不是太理解。","like_count":0,"discussions":[{"author":{"id":1017955,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/88/63/88cf886d.jpg","nickname":"温铭@APISIX","note":"","ucode":"343567571DA16A","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":452796,"discussion_content":"慢慢来，先有一个大概的印象","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1559863853,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1255432,"avatar":"","nickname":"周杨","note":"","ucode":"CE0F1D03554A2C","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":394586,"discussion_content":"多看两遍就好了，由于项目要用，我这周才开始看openresty，现在看第二遍感觉理解好多了","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1631949634,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":100930,"user_name":"nanyun","can_delete":false,"product_type":"c1","uid":1067105,"ip_address":"","ucode":"FF029071ACB041","user_header":"https://static001.geekbang.org/account/avatar/00/10/48/61/803d5bbf.jpg","comment_is_top":false,"comment_ctime":1559691912,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1559691912","product_id":100028301,"comment_content":"视频的效果好很多，赞。","like_count":0}]}