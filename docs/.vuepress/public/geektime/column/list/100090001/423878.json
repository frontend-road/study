{"id":423878,"title":"10 | å¹¿æ’­å˜é‡ & ç´¯åŠ å™¨ï¼šå…±äº«å˜é‡æ˜¯ç”¨æ¥åšä»€ä¹ˆçš„ï¼Ÿ","content":"<p>ä½ å¥½ï¼Œæˆ‘æ˜¯å´ç£Šã€‚</p><p>ä»Šå¤©æ˜¯å›½åº†ç¬¬ä¸€å¤©ï¼Œé¦–å…ˆç¥ä½ èŠ‚æ—¥å¿«ä¹ã€‚ä¸“æ ä¸Šçº¿ä»¥æ¥ï¼Œæœ‰ä¸å°‘åŒå­¦ç•™è¨€è¯´æœŸå¾…åç»­å†…å®¹ï¼Œæ‰€ä»¥å›½åº†æœŸé—´æˆ‘ä»¬ä»æ—§æ›´æ–°æ­£æ–‡å†…å®¹ï¼Œè®©æˆ‘ä»¬ä¸€èµ·æŠŠåŸºç¡€çŸ¥è¯†æ¨¡å—æ”¶ä¸ªå°¾ã€‚</p><p>å­¦ä¹ è¿‡RDDå¸¸ç”¨ç®—å­ä¹‹åï¼Œå›é¡¾è¿™äº›ç®—å­ï¼Œä½ ä¼šå‘ç°å®ƒä»¬éƒ½æ˜¯ä½œç”¨ï¼ˆApplyï¼‰åœ¨RDDä¹‹ä¸Šçš„ã€‚RDDçš„è®¡ç®—ä»¥æ•°æ®åˆ†åŒºä¸ºç²’åº¦ï¼Œä¾ç…§ç®—å­çš„é€»è¾‘ï¼ŒExecutorsä»¥ç›¸äº’ç‹¬ç«‹çš„æ–¹å¼ï¼Œå®Œæˆä¸åŒæ•°æ®åˆ†åŒºçš„è®¡ç®—ä¸è½¬æ¢ã€‚</p><p>ä¸éš¾å‘ç°ï¼Œå¯¹äºExecutorsæ¥è¯´ï¼Œåˆ†åŒºä¸­çš„æ•°æ®éƒ½æ˜¯å±€éƒ¨æ•°æ®ã€‚æ¢å¥è¯è¯´ï¼Œåœ¨åŒä¸€æ—¶åˆ»ï¼Œéš¶å±äºæŸä¸ªExecutorçš„æ•°æ®åˆ†åŒºï¼Œå¯¹äºå…¶ä»–Executorsæ¥è¯´æ˜¯ä¸å¯è§çš„ã€‚</p><p>ä¸è¿‡ï¼Œåœ¨åšåº”ç”¨å¼€å‘çš„æ—¶å€™ï¼Œæ€»ä¼šæœ‰ä¸€äº›è®¡ç®—é€»è¾‘éœ€è¦è®¿é—®â€œå…¨å±€å˜é‡â€ï¼Œæ¯”å¦‚è¯´å…¨å±€è®¡æ•°å™¨ï¼Œè€Œè¿™äº›å…¨å±€å˜é‡åœ¨ä»»æ„æ—¶åˆ»å¯¹æ‰€æœ‰çš„Executorséƒ½æ˜¯å¯è§çš„ã€å…±äº«çš„ã€‚é‚£ä¹ˆé—®é¢˜æ¥äº†ï¼Œåƒè¿™æ ·çš„å…¨å±€å˜é‡ï¼Œæˆ–è€…è¯´å…±äº«å˜é‡ï¼ŒSparkåˆæ˜¯å¦‚ä½•æ”¯æŒçš„å‘¢ï¼Ÿ</p><p>ä»Šå¤©è¿™ä¸€è®²ï¼Œæˆ‘å°±æ¥å’Œä½ èŠèŠSparkå…±äº«å˜é‡ã€‚æŒ‰ç…§åˆ›å»ºä¸ä½¿ç”¨æ–¹å¼çš„ä¸åŒï¼ŒSparkæä¾›äº†ä¸¤ç±»å…±äº«å˜é‡ï¼Œåˆ†åˆ«æ˜¯å¹¿æ’­å˜é‡ï¼ˆBroadcast variablesï¼‰å’Œç´¯åŠ å™¨ï¼ˆAccumulatorsï¼‰ã€‚æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬å°±æ­£å¼è¿›å…¥ä»Šå¤©çš„å­¦ä¹ ï¼Œå»æ·±å…¥äº†è§£è¿™ä¸¤ç§å…±äº«å˜é‡çš„ç”¨æ³•ã€ä»¥åŠå®ƒä»¬å„è‡ªçš„é€‚ç”¨åœºæ™¯ã€‚</p><!-- [[[read_end]]] --><h2>å¹¿æ’­å˜é‡ï¼ˆBroadcast variablesï¼‰</h2><p>æˆ‘ä»¬å…ˆæ¥è¯´è¯´å¹¿æ’­å˜é‡ã€‚å¹¿æ’­å˜é‡çš„ç”¨æ³•å¾ˆç®€å•ï¼Œç»™å®šæ™®é€šå˜é‡xï¼Œé€šè¿‡è°ƒç”¨SparkContextä¸‹çš„broadcast APIå³å¯å®Œæˆå¹¿æ’­å˜é‡çš„åˆ›å»ºï¼Œæˆ‘ä»¬ç»“åˆä»£ç ä¾‹å­çœ‹ä¸€ä¸‹ã€‚</p><pre><code class=\"language-scala\">val list: List[String] = List(\"Apache\", \"Spark\")\n&nbsp;\n// scä¸ºSparkContextå®ä¾‹\nval bc = sc.broadcast(list)\n</code></pre><p>åœ¨ä¸Šé¢çš„ä»£ç ç¤ºä¾‹ä¸­ï¼Œæˆ‘ä»¬å…ˆæ˜¯å®šä¹‰äº†ä¸€ä¸ªå­—ç¬¦ä¸²åˆ—è¡¨listï¼Œå®ƒåŒ…å«â€œApacheâ€å’Œâ€œSparkâ€è¿™ä¸¤ä¸ªå•è¯ã€‚ç„¶åï¼Œæˆ‘ä»¬ä½¿ç”¨broadcastå‡½æ•°æ¥åˆ›å»ºå¹¿æ’­å˜é‡bcï¼Œbcå°è£…çš„å†…å®¹å°±æ˜¯liståˆ—è¡¨ã€‚</p><pre><code class=\"language-scala\">// è¯»å–å¹¿æ’­å˜é‡å†…å®¹\nbc.value\n// List[String] = List(Apache, Spark)\n&nbsp;\n// ç›´æ¥è¯»å–åˆ—è¡¨å†…å®¹\nlist\n// List[String] = List(Apache, Spark)\n</code></pre><p>ä½¿ç”¨broadcast APIåˆ›å»ºå¹¿æ’­å˜é‡</p><p>å¹¿æ’­å˜é‡åˆ›å»ºå¥½ä¹‹åï¼Œé€šè¿‡è°ƒç”¨å®ƒçš„valueå‡½æ•°ï¼Œæˆ‘ä»¬å°±å¯ä»¥è®¿é—®å®ƒæ‰€å°è£…çš„æ•°æ®å†…å®¹ã€‚å¯ä»¥çœ‹åˆ°è°ƒç”¨bc.valueçš„æ•ˆæœï¼Œè¿™ä¸ç›´æ¥è®¿é—®å­—ç¬¦ä¸²åˆ—è¡¨listçš„æ•ˆæœæ˜¯å®Œå…¨ä¸€è‡´çš„ã€‚</p><p>çœ‹åˆ°è¿™é‡Œï¼Œä½ å¯èƒ½ä¼šé—®ï¼šâ€œæ˜æ˜é€šè¿‡è®¿é—®listå˜é‡å°±å¯ä»¥ç›´æ¥è·å–å­—ç¬¦ä¸²åˆ—è¡¨ï¼Œä¸ºä»€ä¹ˆè¿˜è¦ç»•ä¸ªå¤§å¼¯å„¿ï¼Œå…ˆå»å°è£…å¹¿æ’­å˜é‡ï¼Œç„¶ååˆé€šè¿‡å®ƒçš„valueå‡½æ•°æ¥è·å–åŒæ ·çš„æ•°æ®å†…å®¹å‘¢ï¼Ÿâ€å®é™…ä¸Šï¼Œè¿™æ˜¯ä¸ªéå¸¸å¥½çš„é—®é¢˜ï¼Œè¦å›ç­”è¿™ä¸ªé—®é¢˜ï¼Œå’±ä»¬éœ€è¦åšä¸ªæ¨æ¼”ï¼Œçœ‹çœ‹ç›´æ¥è®¿é—®listå˜é‡ä¼šäº§ç”Ÿå“ªäº›å¼Šç«¯ã€‚</p><p>åœ¨å‰é¢çš„å‡ è®²ä¸­ï¼Œæˆ‘ä»¬æ¢ç€èŠ±æ ·åœ°å˜æ›´Word Countçš„è®¡ç®—é€»è¾‘ã€‚å°½ç®¡Word Countéƒ½å¿«è¢«æˆ‘ä»¬â€œç©åäº†â€ï¼Œä¸è¿‡ï¼Œä¸€ä»¥è´¯ä¹‹åœ°æ²¿ç”¨åŒä¸€ä¸ªå®ä¾‹ï¼Œæœ‰åŠ©äºæˆ‘ä»¬é€šè¿‡å¯¹æ¯”è¿…é€ŸæŒæ¡æ–°çš„çŸ¥è¯†ç‚¹ã€æŠ€èƒ½ç‚¹ã€‚å› æ­¤ï¼Œä¸ºäº†è®©ä½ è¿…é€ŸæŒæ¡å¹¿æ’­å˜é‡çš„â€œç²¾é«“â€ï¼Œå’±ä»¬ä¸å¦¨â€œæ•…æŠ€é‡æ–½â€ï¼Œç»§ç»­åœ¨Word Countè¿™ä¸ªå®ä¾‹ä¸Šåšæ–‡ç« ã€‚</p><h3>æ™®é€šå˜é‡çš„ç—›ç‚¹</h3><p>è¿™ä¸€æ¬¡ï¼Œä¸ºäº†å¯¹æ¯”ä½¿ç”¨å¹¿æ’­å˜é‡å‰åçš„å·®å¼‚ï¼Œæˆ‘ä»¬æŠŠWord Countå˜æ›´ä¸ºâ€œå®šå‘è®¡æ•°â€ã€‚</p><p>æ‰€è°“å®šå‘è®¡æ•°ï¼Œå®ƒæŒ‡çš„æ˜¯åªå¯¹æŸäº›å•è¯è¿›è¡Œè®¡æ•°ï¼Œä¾‹å¦‚ï¼Œç»™å®šå•è¯åˆ—è¡¨listï¼Œæˆ‘ä»¬åªå¯¹æ–‡ä»¶wikiOfSpark.txtå½“ä¸­çš„â€œApacheâ€å’Œâ€œSparkâ€è¿™ä¸¤ä¸ªå•è¯åšè®¡æ•°ï¼Œå…¶ä»–å•è¯æˆ‘ä»¬å¯ä»¥å¿½ç•¥ã€‚ç»“åˆ<a href=\"https://time.geekbang.org/column/article/415209\">ç¬¬1è®²</a>Word Countçš„å®Œæ•´ä»£ç ï¼Œè¿™æ ·çš„è®¡ç®—é€»è¾‘å¾ˆå®¹æ˜“å®ç°ï¼Œå¦‚ä¸‹è¡¨æ‰€ç¤ºã€‚</p><pre><code class=\"language-scala\">import org.apache.spark.rdd.RDD\nval rootPath: String = _\nval file: String = s\"${rootPath}/wikiOfSpark.txt\"\n// è¯»å–æ–‡ä»¶å†…å®¹\nval lineRDD: RDD[String] = spark.sparkContext.textFile(file)\n// ä»¥è¡Œä¸ºå•ä½åšåˆ†è¯\nval wordRDD: RDD[String] = lineRDD.flatMap(line =&gt; line.split(\" \"))\n&nbsp;\n// åˆ›å»ºå•è¯åˆ—è¡¨list\nval list: List[String] = List(\"Apache\", \"Spark\")\n// ä½¿ç”¨liståˆ—è¡¨å¯¹RDDè¿›è¡Œè¿‡æ»¤\nval cleanWordRDD: RDD[String] = wordRDD.filter(word =&gt; list.contains(word))\n// æŠŠRDDå…ƒç´ è½¬æ¢ä¸ºï¼ˆKeyï¼ŒValueï¼‰çš„å½¢å¼\nval kvRDD: RDD[(String, Int)] = cleanWordRDD.map(word =&gt; (word, 1))\n// æŒ‰ç…§å•è¯åšåˆ†ç»„è®¡æ•°\nval wordCounts: RDD[(String, Int)] = kvRDD.reduceByKey((x, y) =&gt; x + y)\n// è·å–è®¡ç®—ç»“æœ\nwordCounts.collect\n// Array[(String, Int)] = Array((Apache,34), (Spark,63))\n</code></pre><p>å°†ä¸Šè¿°ä»£ç ä¸¢è¿›spark-shellï¼Œæˆ‘ä»¬å¾ˆå¿«å°±èƒ½ç®—å‡ºï¼Œåœ¨wikiOfSpark.txtæ–‡ä»¶ä¸­ï¼Œâ€œApacheâ€è¿™ä¸ªå•è¯å‡ºç°äº†34æ¬¡ï¼Œè€Œâ€œSparkâ€åˆ™å‡ºç°äº†63æ¬¡ã€‚è™½è¯´å¾—å‡ºè®¡ç®—ç»“æœæŒºå®¹æ˜“çš„ï¼Œä¸è¿‡çŸ¥å…¶ç„¶ï¼Œè¿˜è¦çŸ¥å…¶æ‰€ä»¥ç„¶ï¼Œæ¥ä¸‹æ¥ï¼Œå’±ä»¬ä¸€èµ·æ¥åˆ†æä¸€ä¸‹ï¼Œè¿™æ®µä»£ç åœ¨è¿è¡Œæ—¶æ˜¯å¦‚ä½•å·¥ä½œçš„ã€‚</p><p><img src=\"https://static001.geekbang.org/resource/image/8d/49/8dd52d329d74d212cfa6b188cfea2b49.jpg?wh=1920x1140\" alt=\"å›¾ç‰‡\" title=\"å®šå‘è®¡æ•°ä¸­listå˜é‡çš„å…¨ç½‘åˆ†å‘\"></p><p>å¦‚ä¸Šå›¾æ‰€ç¤ºï¼Œlistå˜é‡æœ¬èº«æ˜¯åœ¨Driverç«¯åˆ›å»ºçš„ï¼Œå®ƒå¹¶ä¸æ˜¯åˆ†å¸ƒå¼æ•°æ®é›†ï¼ˆå¦‚lineRDDã€wordRDDï¼‰çš„ä¸€éƒ¨åˆ†ã€‚å› æ­¤ï¼Œåœ¨åˆ†å¸ƒå¼è®¡ç®—çš„è¿‡ç¨‹ä¸­ï¼ŒSparkéœ€è¦æŠŠlistå˜é‡åˆ†å‘ç»™æ¯ä¸€ä¸ªåˆ†å¸ƒå¼ä»»åŠ¡ï¼ˆTaskï¼‰ï¼Œä»è€Œå¯¹ä¸åŒæ•°æ®åˆ†åŒºçš„å†…å®¹è¿›è¡Œè¿‡æ»¤ã€‚</p><p>åœ¨è¿™ç§å·¥ä½œæœºåˆ¶ä¸‹ï¼Œå¦‚æœRDDå¹¶è¡Œåº¦è¾ƒé«˜ã€æˆ–æ˜¯å˜é‡çš„å°ºå¯¸è¾ƒå¤§ï¼Œé‚£ä¹ˆé‡å¤çš„å†…å®¹åˆ†å‘å°±ä¼šå¼•å…¥å¤§é‡çš„ç½‘ç»œå¼€é”€ä¸å­˜å‚¨å¼€é”€ï¼Œè€Œè¿™äº›å¼€é”€ä¼šå¤§å¹…å‰Šå¼±ä½œä¸šçš„æ‰§è¡Œæ€§èƒ½ã€‚ä¸ºä»€ä¹ˆè¿™ä¹ˆè¯´å‘¢ï¼Ÿ</p><p>è¦çŸ¥é“ï¼Œ<strong>Driverç«¯å˜é‡çš„åˆ†å‘æ˜¯ä»¥Taskä¸ºç²’åº¦çš„ï¼Œç³»ç»Ÿä¸­æœ‰å¤šå°‘ä¸ªTaskï¼Œå˜é‡å°±éœ€è¦åœ¨ç½‘ç»œä¸­åˆ†å‘å¤šå°‘æ¬¡</strong>ã€‚æ›´è¦å‘½çš„æ˜¯ï¼Œæ¯ä¸ªTaskæ¥æ”¶åˆ°å˜é‡ä¹‹åï¼Œéƒ½éœ€è¦æŠŠå®ƒæš‚å­˜åˆ°å†…å­˜ï¼Œä»¥å¤‡åç»­è¿‡æ»¤ä¹‹ç”¨ã€‚æ¢å¥è¯è¯´ï¼Œåœ¨åŒä¸€ä¸ªExecutorå†…éƒ¨ï¼Œå¤šä¸ªä¸åŒçš„Taskå¤šæ¬¡é‡å¤åœ°ç¼“å­˜äº†åŒæ ·çš„å†…å®¹æ‹·è´ï¼Œæ¯«æ— ç–‘é—®ï¼Œè¿™å¯¹å®è´µçš„å†…å­˜èµ„æºæ˜¯ä¸€ç§å·¨å¤§çš„æµªè´¹ã€‚</p><p>RDDå¹¶è¡Œåº¦è¾ƒé«˜ï¼Œæ„å‘³ç€RDDçš„æ•°æ®åˆ†åŒºæ•°é‡è¾ƒå¤šï¼Œè€ŒTaskæ•°é‡ä¸åˆ†åŒºæ•°ç›¸ä¸€è‡´ï¼Œè¿™å°±ä»£è¡¨ç³»ç»Ÿä¸­æœ‰å¤§é‡çš„åˆ†å¸ƒå¼ä»»åŠ¡éœ€è¦æ‰§è¡Œã€‚å¦‚æœå˜é‡æœ¬èº«å°ºå¯¸è¾ƒå¤§ï¼Œå¤§é‡åˆ†å¸ƒå¼ä»»åŠ¡å¼•å…¥çš„ç½‘ç»œå¼€é”€ä¸å†…å­˜å¼€é”€ä¼šè¿›ä¸€æ­¥å‡çº§ã€‚<strong>åœ¨å·¥ä¸šçº§åº”ç”¨ä¸­ï¼ŒRDDçš„å¹¶è¡Œåº¦å¾€å¾€åœ¨åƒã€ä¸‡è¿™ä¸ªé‡çº§ï¼Œåœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œè¯¸å¦‚listè¿™æ ·çš„å˜é‡ä¼šåœ¨ç½‘ç»œä¸­åˆ†å‘æˆåƒä¸Šä¸‡æ¬¡ï¼Œä½œä¸šæ•´ä½“çš„æ‰§è¡Œæ•ˆç‡è‡ªç„¶ä¼šå¾ˆå·® </strong>ã€‚</p><p>é¢å¯¹è¿™æ ·çš„çª˜å¢ƒï¼Œæˆ‘ä»¬æœ‰æ²¡æœ‰ä»€ä¹ˆåŠæ³•ï¼Œèƒ½å¤Ÿé¿å…åŒä¸€ä¸ªå˜é‡çš„é‡å¤åˆ†å‘ä¸å­˜å‚¨å‘¢ï¼Ÿç­”æ¡ˆå½“ç„¶æ˜¯è‚¯å®šçš„ï¼Œè¿™ä¸ªæ—¶å€™ï¼Œæˆ‘ä»¬å°±å¯ä»¥ç¥­å‡ºå¹¿æ’­å˜é‡è¿™ä¸ªâ€œæ€æ‰‹é”â€ã€‚</p><h3>å¹¿æ’­å˜é‡çš„ä¼˜åŠ¿</h3><p>æƒ³è¦çŸ¥é“å¹¿æ’­å˜é‡åˆ°åº•æœ‰å•¥ä¼˜åŠ¿ï¼Œæˆ‘ä»¬å¯ä»¥å…ˆç”¨å¹¿æ’­å˜é‡é‡å†™ä¸€ä¸‹å‰é¢çš„ä»£ç å®ç°ï¼Œç„¶åå†åšä¸ªå¯¹æ¯”ï¼Œå¾ˆå®¹æ˜“å°±èƒ½å‘ç°å¹¿æ’­å˜é‡ä¸ºä»€ä¹ˆèƒ½è§£å†³æ™®é€šå˜é‡çš„ç—›ç‚¹ã€‚</p><pre><code class=\"language-scala\">import org.apache.spark.rdd.RDD\nval rootPath: String = _\nval file: String = s\"${rootPath}/wikiOfSpark.txt\"\n// è¯»å–æ–‡ä»¶å†…å®¹\nval lineRDD: RDD[String] = spark.sparkContext.textFile(file)\n// ä»¥è¡Œä¸ºå•ä½åšåˆ†è¯\nval wordRDD: RDD[String] = lineRDD.flatMap(line =&gt; line.split(\" \"))\n&nbsp;\n// åˆ›å»ºå•è¯åˆ—è¡¨list\nval list: List[String] = List(\"Apache\", \"Spark\")\n// åˆ›å»ºå¹¿æ’­å˜é‡bc\nval bc = sc.broadcast(list)\n// ä½¿ç”¨bc.valueå¯¹RDDè¿›è¡Œè¿‡æ»¤\nval cleanWordRDD: RDD[String] = wordRDD.filter(word =&gt; bc.value.contains(word))\n// æŠŠRDDå…ƒç´ è½¬æ¢ä¸ºï¼ˆKeyï¼ŒValueï¼‰çš„å½¢å¼\nval kvRDD: RDD[(String, Int)] = cleanWordRDD.map(word =&gt; (word, 1))\n// æŒ‰ç…§å•è¯åšåˆ†ç»„è®¡æ•°\nval wordCounts: RDD[(String, Int)] = kvRDD.reduceByKey((x, y) =&gt; x + y)\n// è·å–è®¡ç®—ç»“æœ\nwordCounts.collect\n// Array[(String, Int)] = Array((Apache,34), (Spark,63))\n</code></pre><p>å¯ä»¥çœ‹åˆ°ï¼Œä»£ç çš„ä¿®æ”¹éå¸¸ç®€å•ï¼Œæˆ‘ä»¬å…ˆæ˜¯ä½¿ç”¨broadcastå‡½æ•°æ¥å°è£…listå˜é‡ï¼Œç„¶ååœ¨RDDè¿‡æ»¤çš„æ—¶å€™è°ƒç”¨bc.valueæ¥è®¿é—®listå˜é‡å†…å®¹ã€‚<strong>ä½ å¯ä¸è¦å°çœ‹è¿™ä¸ªæ”¹å†™ï¼Œå°½ç®¡ä»£ç çš„æ”¹åŠ¨å¾®ä¹å…¶å¾®ï¼Œå‡ ä¹å¯ä»¥å¿½ç•¥ä¸è®¡ï¼Œä½†åœ¨è¿è¡Œæ—¶ï¼Œæ•´ä¸ªè®¡ç®—è¿‡ç¨‹å´å‘ç”Ÿäº†ç¿»å¤©è¦†åœ°çš„å˜åŒ–</strong>ã€‚</p><p><img src=\"https://static001.geekbang.org/resource/image/90/12/9050f159749465d0c9d3394f3335ee12.jpg?wh=1920x969\" alt=\"å›¾ç‰‡\" title=\"å¹¿æ’­å˜é‡å·¥ä½œåŸç†\"></p><p>åœ¨ä½¿ç”¨å¹¿æ’­å˜é‡ä¹‹å‰ï¼Œlistå˜é‡çš„åˆ†å‘æ˜¯ä»¥Taskä¸ºç²’åº¦çš„ï¼Œè€Œåœ¨ä½¿ç”¨å¹¿æ’­å˜é‡ä¹‹åï¼Œå˜é‡åˆ†å‘çš„ç²’åº¦å˜æˆäº†ä»¥Executorsä¸ºå•ä½ï¼ŒåŒä¸€ä¸ªExecutorå†…å¤šä¸ªä¸åŒçš„Tasksåªéœ€è®¿é—®åŒä¸€ä»½æ•°æ®æ‹·è´å³å¯ã€‚æ¢å¥è¯è¯´ï¼Œå˜é‡åœ¨ç½‘ç»œä¸­åˆ†å‘ä¸å­˜å‚¨çš„æ¬¡æ•°ï¼Œä»RDDçš„åˆ†åŒºæ•°é‡ï¼Œé”å‡åˆ°äº†é›†ç¾¤ä¸­Executorsçš„ä¸ªæ•°ã€‚</p><p>è¦çŸ¥é“ï¼Œåœ¨å·¥ä¸šçº§ç³»ç»Ÿä¸­ï¼ŒExecutorsä¸ªæ•°ä¸RDDå¹¶è¡Œåº¦ç›¸æ¯”ï¼ŒäºŒè€…ä¹‹é—´é€šå¸¸ä¼šç›¸å·®è‡³å°‘ä¸¤ä¸ªæ•°é‡çº§ã€‚åœ¨è¿™æ ·çš„é‡çº§ä¸‹ï¼Œå¹¿æ’­å˜é‡èŠ‚çœçš„ç½‘ç»œä¸å†…å­˜å¼€é”€ä¼šå˜å¾—éå¸¸å¯è§‚ï¼Œçœå»äº†è¿™äº›å¼€é”€ï¼Œå¯¹ä½œä¸šçš„æ‰§è¡Œæ€§èƒ½è‡ªç„¶å¤§æœ‰è£¨ç›Šã€‚</p><p>å¥½å•¦ï¼Œåˆ°ç°åœ¨ä¸ºæ­¢ï¼Œæˆ‘ä»¬è®²è§£äº†å¹¿æ’­å˜é‡çš„ç”¨æ³•ã€å·¥ä½œåŸç†ï¼Œä»¥åŠå®ƒçš„ä¼˜åŠ¿æ‰€åœ¨ã€‚åœ¨æ—¥å¸¸çš„å¼€å‘å·¥ä½œä¸­ï¼Œ<strong>å½“ä½ é‡åˆ°éœ€è¦å¤šä¸ªTaskå…±äº«åŒä¸€ä¸ªå¤§å‹å˜é‡ï¼ˆå¦‚åˆ—è¡¨ã€æ•°ç»„ã€æ˜ å°„ç­‰æ•°æ®ç»“æ„ï¼‰çš„æ—¶å€™ï¼Œå°±å¯ä»¥è€ƒè™‘ä½¿ç”¨å¹¿æ’­å˜é‡æ¥ä¼˜åŒ–ä½ çš„Sparkä½œä¸š</strong>ã€‚æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬ç»§ç»­æ¥è¯´è¯´Sparkæ”¯æŒçš„ç¬¬äºŒç§å…±äº«å˜é‡ï¼šç´¯åŠ å™¨ã€‚</p><h2>ç´¯åŠ å™¨ï¼ˆAccumulatorsï¼‰</h2><p>ç´¯åŠ å™¨ï¼Œé¡¾åæ€ä¹‰ï¼Œå®ƒçš„ä¸»è¦ä½œç”¨æ˜¯å…¨å±€è®¡æ•°ï¼ˆGlobal counterï¼‰ã€‚ä¸å•æœºç³»ç»Ÿä¸åŒï¼Œåœ¨åˆ†å¸ƒå¼ç³»ç»Ÿä¸­ï¼Œæˆ‘ä»¬ä¸èƒ½ä¾èµ–ç®€å•çš„æ™®é€šå˜é‡æ¥å®Œæˆå…¨å±€è®¡æ•°ï¼Œè€Œæ˜¯å¿…é¡»ä¾èµ–åƒç´¯åŠ å™¨è¿™ç§ç‰¹æ®Šçš„æ•°æ®ç»“æ„æ‰èƒ½è¾¾åˆ°ç›®çš„ã€‚</p><p>ä¸å¹¿æ’­å˜é‡ç±»ä¼¼ï¼Œç´¯åŠ å™¨ä¹Ÿæ˜¯åœ¨Driverç«¯å®šä¹‰çš„ï¼Œä½†å®ƒçš„æ›´æ–°æ˜¯é€šè¿‡åœ¨RDDç®—å­ä¸­è°ƒç”¨addå‡½æ•°å®Œæˆçš„ã€‚åœ¨åº”ç”¨æ‰§è¡Œå®Œæ¯•ä¹‹åï¼Œå¼€å‘è€…åœ¨Driverç«¯è°ƒç”¨ç´¯åŠ å™¨çš„valueå‡½æ•°ï¼Œå°±èƒ½è·å–å…¨å±€è®¡æ•°ç»“æœã€‚æŒ‰ç…§æƒ¯ä¾‹ï¼Œå’±ä»¬è¿˜æ˜¯é€šè¿‡ä»£ç æ¥ç†Ÿæ‚‰ç´¯åŠ å™¨çš„ç”¨æ³•ã€‚</p><p>èªæ˜çš„ä½ å¯èƒ½å·²ç»çŒœåˆ°äº†ï¼Œæˆ‘ä»¬åˆè¦å¯¹Word Countâ€œåŠ¨æ‰‹è„šâ€äº†ã€‚åœ¨ç¬¬1è®²çš„Word Countä¸­ï¼Œæˆ‘ä»¬è¿‡æ»¤æ‰äº†ç©ºå­—ç¬¦ä¸²ï¼Œç„¶åå¯¹æ–‡ä»¶wikiOfSpark.txtä¸­æ‰€æœ‰çš„å•è¯åšç»Ÿè®¡è®¡æ•°ã€‚</p><p>ä¸è¿‡è¿™ä¸€æ¬¡ï¼Œæˆ‘ä»¬åœ¨è¿‡æ»¤æ‰ç©ºå­—ç¬¦çš„åŒæ—¶ï¼Œè¿˜æƒ³çŸ¥é“æ–‡ä»¶ä¸­åˆ°åº•æœ‰å¤šå°‘ä¸ªç©ºå­—ç¬¦ä¸²ï¼Œè¿™æ ·æˆ‘ä»¬å¯¹æ–‡ä»¶ä¸­çš„â€œè„æ•°æ®â€å°±èƒ½åšåˆ°å¿ƒä¸­æœ‰æ•°äº†ã€‚</p><p>æ³¨æ„ï¼Œ<strong>è¿™é‡Œå¯¹äºç©ºå­—ç¬¦ä¸²çš„è®¡æ•°ï¼Œä¸æ˜¯ä¸»ä»£ç é€»è¾‘ï¼Œå®ƒçš„è®¡ç®—ç»“æœä¸ä¼šå†™å…¥åˆ°Word Countæœ€ç»ˆçš„ç»Ÿè®¡ç»“æœ</strong>ã€‚æ‰€ä»¥ï¼Œåªæ˜¯ç®€å•åœ°å»æ‰filterç¯èŠ‚ï¼Œæ˜¯æ— æ³•å®ç°ç©ºå­—ç¬¦è®¡æ•°çš„ã€‚</p><p>é‚£ä¹ˆï¼Œä½ è‡ªç„¶ä¼šé—®ï¼šâ€œä¸æŠŠfilterç¯èŠ‚å»æ‰ï¼Œæ€ä¹ˆå¯¹ç©ºå­—ç¬¦ä¸²åšç»Ÿè®¡å‘¢ï¼Ÿâ€åˆ«ç€æ€¥ï¼Œè¿™æ ·çš„è®¡ç®—éœ€æ±‚ï¼Œæ­£æ˜¯ç´¯åŠ å™¨å¯ä»¥æ–½å±•æ‹³è„šçš„åœ°æ–¹ã€‚ä½ å¯ä»¥å…ˆæ‰«ä¸€çœ¼ä¸‹è¡¨çš„ä»£ç å®ç°ï¼Œç„¶åæˆ‘ä»¬å†ä¸€èµ·æ¥ç†Ÿæ‚‰ç´¯åŠ å™¨çš„ç”¨æ³•ã€‚</p><pre><code class=\"language-scala\">import org.apache.spark.rdd.RDD\nval rootPath: String = _\nval file: String = s\"${rootPath}/wikiOfSpark.txt\"\n// è¯»å–æ–‡ä»¶å†…å®¹\nval lineRDD: RDD[String] = spark.sparkContext.textFile(file)\n// ä»¥è¡Œä¸ºå•ä½åšåˆ†è¯\nval wordRDD: RDD[String] = lineRDD.flatMap(line =&gt; line.split(\" \"))\n&nbsp;\n// å®šä¹‰Longç±»å‹çš„ç´¯åŠ å™¨\nval ac = sc.longAccumulator(\"Empty string\")\n&nbsp;\n// å®šä¹‰filterç®—å­çš„åˆ¤å®šå‡½æ•°fï¼Œæ³¨æ„ï¼Œfçš„è¿”å›ç±»å‹å¿…é¡»æ˜¯Boolean\ndef f(x: String): Boolean = {\nif(x.equals(\"\")) {\n// å½“é‡åˆ°ç©ºå­—ç¬¦ä¸²æ—¶ï¼Œç´¯åŠ å™¨åŠ 1\nac.add(1)\nreturn false\n} else {\nreturn true\n}\n}\n&nbsp;\n// ä½¿ç”¨få¯¹RDDè¿›è¡Œè¿‡æ»¤\nval cleanWordRDD: RDD[String] = wordRDD.filter(f)\n// æŠŠRDDå…ƒç´ è½¬æ¢ä¸ºï¼ˆKeyï¼ŒValueï¼‰çš„å½¢å¼\nval kvRDD: RDD[(String, Int)] = cleanWordRDD.map(word =&gt; (word, 1))\n// æŒ‰ç…§å•è¯åšåˆ†ç»„è®¡æ•°\nval wordCounts: RDD[(String, Int)] = kvRDD.reduceByKey((x, y) =&gt; x + y)\n// æ”¶é›†è®¡æ•°ç»“æœ\nwordCounts.collect\n&nbsp;\n// ä½œä¸šæ‰§è¡Œå®Œæ¯•ï¼Œé€šè¿‡è°ƒç”¨valueè·å–ç´¯åŠ å™¨ç»“æœ\nac.value\n// Long = 79\n</code></pre><p>ä¸ç¬¬1è®²çš„Word Countç›¸æ¯”ï¼Œè¿™é‡Œçš„ä»£ç ä¸»è¦æœ‰4å¤„æ”¹åŠ¨ï¼š</p><ul>\n<li>ä½¿ç”¨SparkContextä¸‹çš„longAccumulatoræ¥å®šä¹‰Longç±»å‹çš„ç´¯åŠ å™¨ï¼›</li>\n<li>å®šä¹‰filterç®—å­çš„åˆ¤å®šå‡½æ•°fï¼Œå½“é‡åˆ°ç©ºå­—ç¬¦ä¸²æ—¶ï¼Œè°ƒç”¨addå‡½æ•°ä¸ºç´¯åŠ å™¨è®¡æ•°ï¼›</li>\n<li>ä»¥å‡½æ•°fä¸ºå‚æ•°ï¼Œè°ƒç”¨filterç®—å­å¯¹RDDè¿›è¡Œè¿‡æ»¤ï¼›</li>\n<li>ä½œä¸šå®Œæˆåï¼Œè°ƒç”¨ç´¯åŠ å™¨çš„valueå‡½æ•°ï¼Œè·å–å…¨å±€è®¡æ•°ç»“æœã€‚</li>\n</ul><p>ä½ ä¸å¦¨æŠŠä¸Šé¢çš„ä»£ç æ•²å…¥åˆ°spark-shellé‡Œï¼Œç›´è§‚ä½“éªŒä¸‹ç´¯åŠ å™¨çš„ç”¨æ³•ä¸æ•ˆæœï¼Œac.valueç»™å‡ºçš„ç»“æœæ˜¯79ï¼Œè¿™è¯´æ˜ä»¥ç©ºæ ¼ä½œä¸ºåˆ†éš”ç¬¦åˆ‡å‰²æºæ–‡ä»¶wikiOfSpark.txtä¹‹åï¼Œå°±ä¼šç•™ä¸‹79ä¸ªç©ºå­—ç¬¦ä¸²ã€‚</p><p>å¦å¤–ï¼Œä½ è¿˜å¯ä»¥éªŒè¯wordCountsè¿™ä¸ªRDDï¼Œå®ƒåŒ…å«æ‰€æœ‰å•è¯çš„è®¡æ•°ç»“æœï¼Œä¸è¿‡ï¼Œä½ ä¼šå‘ç°å®ƒçš„å…ƒç´ å¹¶ä¸åŒ…å«ç©ºå­—ç¬¦ä¸²ï¼Œè¿™ä¸æˆ‘ä»¬é¢„æœŸçš„è®¡ç®—é€»è¾‘æ˜¯ä¸€è‡´çš„ã€‚</p><p>é™¤äº†ä¸Šé¢ä»£ç ä¸­ç”¨åˆ°çš„longAccumulatorï¼ŒSparkContextè¿˜æä¾›äº†doubleAccumulatorå’ŒcollectionAccumulatorè¿™ä¸¤ç§ä¸åŒç±»å‹çš„ç´¯åŠ å™¨ï¼Œç”¨äºæ»¡è¶³ä¸åŒåœºæ™¯ä¸‹çš„è®¡ç®—éœ€è¦ï¼Œæ„Ÿå…´è¶£çš„è¯ä½ ä¸å¦¨è‡ªå·±åŠ¨æ‰‹äº²è‡ªå°è¯•ä¸€ä¸‹ã€‚</p><p>å…¶ä¸­ï¼ŒdoubleAccumulatorç”¨äºå¯¹Doubleç±»å‹çš„æ•°å€¼åšå…¨å±€è®¡æ•°ï¼›è€ŒcollectionAccumulatorå…è®¸å¼€å‘è€…å®šä¹‰é›†åˆç±»å‹çš„ç´¯åŠ å™¨ï¼Œç›¸æ¯”æ•°å€¼ç±»å‹ï¼Œé›†åˆç±»å‹å¯ä»¥ä¸ºä¸šåŠ¡é€»è¾‘çš„å®ç°ï¼Œæä¾›æ›´å¤šçš„çµæ´»æ€§å’Œæ›´å¤§çš„è‡ªç”±åº¦ã€‚</p><p>ä¸è¿‡ï¼Œå°±è¿™3ç§ç´¯åŠ å™¨æ¥è¯´ï¼Œå°½ç®¡ç±»å‹ä¸åŒï¼Œä½†å®ƒä»¬çš„ç”¨æ³•æ˜¯å®Œå…¨ä¸€è‡´çš„ã€‚éƒ½æ˜¯<strong>å…ˆå®šä¹‰ç´¯åŠ å™¨å˜é‡ï¼Œç„¶ååœ¨RDDç®—å­ä¸­è°ƒç”¨addå‡½æ•°ï¼Œä»è€Œæ›´æ–°ç´¯åŠ å™¨çŠ¶æ€ï¼Œæœ€åé€šè¿‡è°ƒç”¨valueå‡½æ•°æ¥è·å–ç´¯åŠ å™¨çš„æœ€ç»ˆç»“æœ</strong>ã€‚</p><p>å¥½å•¦ï¼Œåˆ°è¿™é‡Œï¼Œå…³äºç´¯åŠ å™¨çš„ç”¨æ³•ï¼Œæˆ‘ä»¬å°±è®²å®Œäº†ã€‚åœ¨æ—¥å¸¸çš„å¼€å‘ä¸­ï¼Œå½“ä½ é‡åˆ°éœ€è¦åšå…¨å±€è®¡æ•°çš„åœºæ™¯æ—¶ï¼Œåˆ«å¿˜äº†ç”¨ä¸Šç´¯åŠ å™¨è¿™ä¸ªå®ç”¨å·¥å…·ã€‚</p><h2>é‡ç‚¹å›é¡¾</h2><p>ä»Šå¤©çš„å†…å®¹è®²å®Œäº†ï¼Œæˆ‘ä»¬ä¸€èµ·æ¥åšä¸ªæ€»ç»“ã€‚ä»Šå¤©è¿™ä¸€è®²ï¼Œæˆ‘ä»¬é‡ç‚¹è®²è§£äº†å¹¿æ’­å˜é‡ä¸ç´¯åŠ å™¨çš„ç”¨æ³•ä¸é€‚ç”¨åœºæ™¯ã€‚</p><p>å¹¿æ’­å˜é‡ç”±Driverç«¯å®šä¹‰å¹¶åˆå§‹åŒ–ï¼Œå„ä¸ªExecutorsä»¥åªè¯»ï¼ˆRead onlyï¼‰çš„æ–¹å¼è®¿é—®å¹¿æ’­å˜é‡æºå¸¦çš„æ•°æ®å†…å®¹ã€‚ç´¯åŠ å™¨ä¹Ÿæ˜¯ç”±Driverå®šä¹‰çš„ï¼Œä½†Driverå¹¶ä¸ä¼šå‘ç´¯åŠ å™¨ä¸­å†™å…¥ä»»ä½•æ•°æ®å†…å®¹ï¼Œç´¯åŠ å™¨çš„å†…å®¹æ›´æ–°ï¼Œå®Œå…¨æ˜¯ç”±å„ä¸ªExecutorsä»¥åªå†™ï¼ˆWrite onlyï¼‰çš„æ–¹å¼æ¥å®Œæˆï¼Œè€ŒDriverä»…ä»¥åªè¯»çš„æ–¹å¼å¯¹æ›´æ–°åçš„å†…å®¹è¿›è¡Œè®¿é—®ã€‚</p><p>å…³äºå¹¿æ’­å˜é‡ï¼Œä½ é¦–å…ˆéœ€è¦æŒæ¡å®ƒçš„åŸºæœ¬ç”¨æ³•ã€‚ç»™å®šä»»æ„ç±»å‹çš„æ™®é€šå˜é‡ï¼Œä½ éƒ½å¯ä»¥ä½¿ç”¨SparkContextä¸‹é¢çš„broadcast APIæ¥åˆ›å»ºå¹¿æ’­å˜é‡ã€‚æ¥ä¸‹æ¥ï¼Œåœ¨RDDçš„è½¬æ¢ä¸è®¡ç®—è¿‡ç¨‹ä¸­ï¼Œä½ å¯ä»¥é€šè¿‡è°ƒç”¨å¹¿æ’­å˜é‡çš„valueå‡½æ•°ï¼Œæ¥è®¿é—®å°è£…çš„æ•°æ®å†…å®¹ï¼Œä»è€Œè¾…åŠ©RDDçš„æ•°æ®å¤„ç†ã€‚</p><p>éœ€è¦é¢å¤–æ³¨æ„çš„æ˜¯ï¼Œ<strong>åœ¨Driverä¸Executorsä¹‹é—´ï¼Œæ™®é€šå˜é‡çš„åˆ†å‘ä¸å­˜å‚¨ï¼Œæ˜¯ä»¥Taskä¸ºç²’åº¦çš„ï¼Œå› æ­¤ï¼Œå®ƒæ‰€å¼•å…¥çš„ç½‘ç»œä¸å†…å­˜å¼€é”€ï¼Œä¼šæˆä¸ºä½œä¸šæ‰§è¡Œæ€§èƒ½çš„ä¸€å¤§éšæ‚£</strong>ã€‚åœ¨ä½¿ç”¨å¹¿æ’­å˜é‡çš„æƒ…å†µä¸‹ï¼Œæ•°æ®å†…å®¹çš„åˆ†å‘ç²’åº¦å˜ä¸ºä»¥Executorsä¸ºå•ä½ã€‚ç›¸æ¯”å‰è€…ï¼Œå¹¿æ’­å˜é‡çš„ä¼˜åŠ¿é«˜ä¸‹ç«‹åˆ¤ï¼Œå®ƒå¯ä»¥å¤§å¹…åº¦æ¶ˆé™¤å‰è€…å¼•å…¥çš„ç½‘ç»œä¸å†…å­˜å¼€é”€ï¼Œè¿›è€Œåœ¨æ•´ä½“ä¸Šæå‡ä½œä¸šçš„æ‰§è¡Œæ•ˆç‡ã€‚</p><p>å…³äºç´¯åŠ å™¨ï¼Œé¦–å…ˆä½ è¦æ¸…æ¥šå®ƒçš„é€‚ç”¨åœºæ™¯ï¼Œå½“ä½ éœ€è¦åšå…¨å±€è®¡æ•°çš„æ—¶å€™ï¼Œç´¯åŠ å™¨ä¼šæ˜¯ä¸ªå¾ˆå¥½çš„å¸®æ‰‹ã€‚å…¶æ¬¡ï¼Œä½ éœ€è¦æŒæ¡ç´¯åŠ å™¨çš„å…·ä½“ç”¨æ³•ï¼Œå¯ä»¥åˆ†ä¸ºè¿™æ ·3æ­¥ï¼š</p><ol>\n<li>ä½¿ç”¨SparkContextä¸‹çš„[long | double | collection]Accumulatoræ¥å®šä¹‰ç´¯åŠ å™¨ï¼›</li>\n<li>åœ¨RDDçš„è½¬æ¢è¿‡ç¨‹ä¸­ï¼Œè°ƒç”¨addå‡½æ•°æ›´æ–°ç´¯åŠ å™¨çŠ¶æ€ï¼›</li>\n<li>åœ¨ä½œä¸šå®Œæˆåï¼Œè°ƒç”¨valueå‡½æ•°ï¼Œè·å–ç´¯åŠ å™¨çš„å…¨å±€ç»“æœã€‚</li>\n</ol><h2>æ¯è¯¾ä¸€ç»ƒ</h2><ol>\n<li>åœ¨ä½¿ç”¨ç´¯åŠ å™¨å¯¹ç©ºå­—ç¬¦ä¸²åšå…¨å±€è®¡æ•°çš„ä»£ç ä¸­ï¼Œè¯·ä½ ç”¨æ™®é€šå˜é‡å»æ›¿æ¢ç´¯åŠ å™¨ï¼Œè¯•ä¸€è¯•ï¼Œåœ¨ä¸ä½¿ç”¨ç´¯åŠ å™¨çš„æƒ…å†µï¼Œèƒ½å¦å¾—åˆ°é¢„æœŸçš„è®¡ç®—ç»“æœï¼Ÿ</li>\n<li>ç´¯åŠ å™¨æä¾›äº†Longã€Doubleå’ŒCollectionä¸‰ç§ç±»å‹çš„æ”¯æŒï¼Œé‚£ä¹ˆå¹¿æ’­å˜é‡åœ¨ç±»å‹æ”¯æŒä¸Šæœ‰é™åˆ¶å—ï¼Ÿé™¤äº†æ™®é€šç±»å‹ã€é›†åˆç±»å‹ä¹‹å¤–ï¼Œå¹¿æ’­å˜é‡è¿˜æ”¯æŒå…¶ä»–ç±»å‹å—ï¼Ÿæ¯”å¦‚ï¼ŒSparkæ”¯æŒåœ¨RDDä¹‹ä¸Šåˆ›å»ºå¹¿æ’­å˜é‡å—ï¼Ÿ</li>\n</ol><p>æ¬¢è¿ä½ åœ¨ç•™è¨€åŒºè·Ÿæˆ‘äº¤æµäº’åŠ¨ï¼Œä¹Ÿæ¨èä½ æŠŠè¿™ä¸€è®²çš„å†…å®¹åˆ†äº«ç»™ä½ èº«è¾¹çš„æœ‹å‹ï¼Œè¯´ä¸å®šå°±èƒ½å¸®ä»–è§£å†³ä¸€ä¸ªéš¾é¢˜ã€‚</p>","comments":[{"had_liked":false,"id":314607,"user_name":"Geek_2dfa9a","can_delete":false,"product_type":"c1","uid":1435535,"ip_address":"","ucode":"B5FE7971F5E773","user_header":"http://thirdwx.qlogo.cn/mmopen/vi_32/DYAIOgq83epGTSTvn7r4ibk1PuaUrSvvLdviaLcne50jbvvfiaxKkM5SLibeP6jibA2bCCQBqETibvIvcsOhAZlwS8kQ/132","comment_is_top":true,"comment_ctime":1633255639,"is_pvip":false,"replies":[{"id":"114053","content":"å®éªŒåšçš„éå¸¸ç»†è‡´ï¼Œæœ‰è§‚å¯Ÿã€æœ‰æ€è€ƒã€æ€è€ƒå¾ˆæ·±å…¥ï¼ŒèµğŸ‘ï¼Œç½®é¡¶ğŸ”<br><br>å…ˆè¯´Taskä¸²è¡Œã€å¹¶è¡Œçš„é—®é¢˜ï¼ŒTaskä¸Taskä¹‹é—´ï¼Œæ˜¯å¹¶è¡Œçš„ï¼ŒTaskå†…éƒ¨ï¼Œæ˜¯ä¸²è¡Œã€‚è¿™ä¸ªå…¶å®å¥½ç†è§£ï¼Œæ¯•ç«Ÿï¼Œä¸€ä¸ªTaskå ç”¨ä¸€ä¸ªCPU coreï¼Œä¸å­˜åœ¨å¹¶å‘ä¸Šçš„ç‰©ç†æ¡ä»¶~ <br><br>å†è€…ï¼Œç‰¹åˆ«åŒæ„ä½ è¯´çš„FAASå’Œæ‰“å¼€è§†é‡ï¼Œæˆ‘å¯¹æ­¤æ·±æœ‰åŒæ„Ÿ~ ç”¨ä½ çš„è¯è¯´ï¼Œæ˜¯Sparkå¯¹äºåºåˆ—åŒ–å’Œååºåˆ—åŒ–çš„æ”¯æŒã€‚å¯¹æˆ‘æ¥è¯´ï¼ŒSparkçš„è°ƒåº¦ç³»ç»Ÿï¼Œå¯¹æˆ‘ä¸ªäººå½±å“å·¨å¤§ï¼Œè®©æˆ‘çœŸæ­£è®¤è¯†åˆ°åˆ†å¸ƒå¼ç³»ç»Ÿçš„ç©æ³•ã€ç‰¹è‰²å’Œæ ¸å¿ƒã€‚åœ¨æˆ‘çœ‹æ¥ï¼Œè°ƒåº¦ç³»ç»Ÿæ˜¯å­¦ä¹ Sparkæœ€åº”è¯¥å­¦çš„éƒ¨åˆ†ï¼Œæ²¡æœ‰ä¹‹ä¸€~ å½“ç„¶ï¼Œä»è€…è§ä»ï¼Œå¤§å®¶çš„å–œå¥½å’Œåå¥½éƒ½ä¸åŒ~ å°±æ‰“å¼€è§†é‡è¿™æ–¹é¢ï¼Œç¡®å®è°ƒåº¦ç³»ç»Ÿå¯¹äºæˆ‘ä¸ªäººçš„æå‡ï¼Œæˆ–è€…è¯´ç»™æˆ‘ä¸ªäººç•™ä¸‹çš„å°è±¡ï¼Œéå¸¸éå¸¸çš„æ·±åˆ»ã€‚<br><br>å¹¿æ’­å˜é‡ç­”çš„ä¹Ÿå¾ˆå¥½~ RDDéœ€è¦å…ˆcollectï¼Œè¿™ä¸€ç‚¹å…¶å®æƒ³åæ§½ç¤¾åŒºï¼Œå®Œå…¨å¯ä»¥åšå¾—è·ŸDataFrameä¸€æ ·ï¼Œç›´æ¥å°è£…å°±å¥½äº†ï¼Œéè¦å¼€å‘è€…è‡ªè¡Œcollectä¸€æ³¢ï¼Œç„¶åå†å°è£…ï¼Œéº»çƒ¦ï¼DataFrameå°±æ¯”è¾ƒç›´æ¥ï¼ŒSparkåœ¨èƒŒåå¸®å¼€å‘è€…åšäº†collectè¿™ä¸€æ­¥ï¼Œå°±å¼€å‘è€…ä½¿ç”¨ä½“éªŒæ¥è¯´ï¼Œè¿˜æ˜¯è¦å¥½äº›~","user_name":"ä½œè€…å›å¤","user_name_real":"å´ç£Š","uid":"1043100","ctime":1633613103,"ip_address":"","comment_id":314607,"utype":1}],"discussion_count":1,"race_medal":0,"score":"9.2233721200923996e+18","product_id":100090001,"comment_content":"1.ä½¿ç”¨æ™®é€šå˜é‡æ˜¯æ— æ³•å¾—åˆ°é¢„æœŸç»“æœçš„ï¼Œå› ä¸ºlambdaé‡Œçš„å¿…é¡»æ˜¯finalå‹çš„å˜é‡ï¼Œé‚£è¿™é‡Œæˆ‘ç”¨ä¸¤ç§æ–¹æ³•åšä¸ªæµ‹è¯•ï¼š<br>é¦–å…ˆæ˜¯åŸå­ç±»ï¼Œå› å­—æ•°é™åˆ¶ï¼Œåªæ”¾å…³é”®ä»£ç ï¼š<br>    var normal = new AtomicInteger(0)<br>    val  preRdd = wordRdd.filter(f =&gt;<br>      if(f.contains(&quot;scala&quot;)) {<br>        println(normal.incrementAndGet())<br>        false<br>      } else {<br>        true<br>      }<br>    )<br>    println(normal.get())<br>å¯ä»¥çœ‹åˆ°Executorè¿è¡Œè¿‡ç¨‹ä¸­normalæ˜¯ä¼šæ­£å¸¸ç´¯åŠ çš„ï¼Œä½†æ˜¯æœ€åprintln(normal.get())æ‰“å°å‡ºæ¥æ˜¯0ï¼Œè¿™é‡Œç®€å•åˆ†æä¸‹ï¼Œsparkä¼šæŠŠé—­åŒ…åºåˆ—åŒ–å<br>ä¼ é€’ç»™Executorï¼Œç„¶åExecutorå†æŠŠé—­åŒ…ååºåˆ—åŒ–åä½œç”¨åœ¨RDDä¸Šã€‚å› æ­¤Driveré‡Œçš„normalå˜é‡å’ŒExecutoré‡Œçš„normalå˜é‡æ˜¯å¤šä¸ªè¿›ç¨‹é‡Œçš„å¤šä¸ªå˜é‡ã€‚<br>ç„¶åä½¿ç”¨è‡ªå®šä¹‰ç±»å¯¹è±¡<br>class IntHolder(var value: Int) {}<br>æµ‹è¯•ï¼ŒæŠ¥äº†ä¸€ä¸ªException in thread &quot;main&quot; org.apache.spark.SparkException: Task not serializable<br>ä»ä¾§é¢ä¹Ÿè¯æ˜ï¼Œé—­åŒ…é‡Œçš„å¯¹è±¡æ˜¯è¦å®ç°åºåˆ—åŒ–çš„ã€‚å˜é‡æ˜¯å¤šä¸ªè¿›ç¨‹é‡Œçš„å¤šä¸ªå˜é‡æ”¹è¿›ä¸‹å†è¯•ï¼Œ<br>class IntHolder(var value: Int) extends Serializable {}<br>å‘ç°æ¯ä¸ªTaskéƒ½æ˜¯ä»0å¼€å§‹è®¡æ•°ï¼Œæ›´è¯´æ˜æ¯ä¸ªTaské‡Œçš„å¯¹è±¡æ˜¯Driverä¸¢è¿‡æ¥çš„å‰¯æœ¬ã€‚è¿™é‡Œæˆ‘å¤šæƒ³äº†ä¸‹Taské‡Œçš„å‡½æ•°æ˜¯ä¸²è¡Œæ‰§è¡Œè¿˜æ˜¯å¹¶è¡Œæ‰§è¡Œçš„ï¼Œå¦‚æœæˆ‘çš„IntHolderå¯¹è±¡<br>ä¸æ˜¯çº¿ç¨‹å®‰å…¨çš„ï¼Œé‚£åœ¨Taské‡Œæœ‰æ— æ•°æ®ç«äº‰ï¼Ÿä»æˆ‘çš„ä¾‹å­çœ‹æ˜¯ä¸²è¡Œè¿è¡Œçš„ï¼Œä½†æ˜¯ä¸€æ—¶æ‰¾ä¸åˆ°çœ‹å“ªäº›ä»£ç ï¼Œè¯·è€å¸ˆæŒ‡æ­£ã€‚<br>å¤šè®²ä¸¤å¥ï¼ŒSparké—­åŒ…åºåˆ—åŒ–å’Œååºåˆ—åŒ–çœŸçš„æ˜¯å¾ˆé‡è¦çš„çŸ¥è¯†ï¼Œæ‰“å¼€äº†æˆ‘çš„è§†é‡ï¼Œæˆ‘æ„Ÿè§‰Sparkæ˜¯Faasä¸€ç§éå¸¸å·§å¦™çš„åœºæ™¯ï¼Œå‡½æ•°å¼ç¼–ç¨‹çœŸçš„ä¹Ÿå¾ˆç¬¦åˆSpark<br>æŠŠå‡½æ•°ä½œç”¨åœ¨RDDä¸Šï¼Œå­˜ç®—åˆ†ç¦»çš„æ€è·¯ï¼ŒUCBå‡ºå“çœŸçš„åä¸è™šä¼ ã€‚<br><br>2.SparkåŸºæœ¬æ”¯æŒä»»ä½•ç±»å‹çš„å¹¿æ’­å˜é‡ï¼Œä½†æ˜¯ä¸æ”¯æŒRDDç±»å‹çš„å¹¿æ’­å˜é‡ï¼Œä»ä»£ç ä¸­å¯ä»¥çœ‹åˆ°ï¼Œæœ‰ä¸€ä¸ªéªŒè¯ä¼šåˆ¤æ–­å˜é‡æ˜¯å¦ä¸ºRDDç±»å‹ï¼Œå¦‚æœæƒ³è¦å¹¿æ’­RDDç±»å‹çš„è¯ï¼Œå¯ä»¥å…ˆ<br>collectæ”¶é›†åˆ°driverï¼Œå†ä½œä¸ºæ™®é€šé›†åˆå¹¿æ’­ã€‚<br>  def broadcast[T: ClassTag](value: T): Broadcast[T] = {<br>    assertNotStopped()<br>    require(!classOf[RDD[_]].isAssignableFrom(classTag[T].runtimeClass),<br>      &quot;Can not directly broadcast RDDs; instead, call collect() and broadcast the result.&quot;)<br>    val bc = env.broadcastManager.newBroadcast[T](value, isLocal)<br>    val callSite = getCallSite<br>    logInfo(&quot;Created broadcast &quot; + bc.id + &quot; from &quot; + callSite.shortForm)<br>    cleaner.foreach(_.registerBroadcastForCleanup(bc))<br>    bc<br>  }","like_count":20,"discussions":[{"author":{"id":1043100,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/ea/9c/230061e7.jpg","nickname":"å´ç£Š","note":"","ucode":"136DC8CF1B10DC","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":527735,"discussion_content":"å®éªŒåšçš„éå¸¸ç»†è‡´ï¼Œæœ‰è§‚å¯Ÿã€æœ‰æ€è€ƒã€æ€è€ƒå¾ˆæ·±å…¥ï¼ŒèµğŸ‘ï¼Œç½®é¡¶ğŸ”\n\nå…ˆè¯´Taskä¸²è¡Œã€å¹¶è¡Œçš„é—®é¢˜ï¼ŒTaskä¸Taskä¹‹é—´ï¼Œæ˜¯å¹¶è¡Œçš„ï¼ŒTaskå†…éƒ¨ï¼Œæ˜¯ä¸²è¡Œã€‚è¿™ä¸ªå…¶å®å¥½ç†è§£ï¼Œæ¯•ç«Ÿï¼Œä¸€ä¸ªTaskå ç”¨ä¸€ä¸ªCPU coreï¼Œä¸å­˜åœ¨å¹¶å‘ä¸Šçš„ç‰©ç†æ¡ä»¶~ \n\nå†è€…ï¼Œç‰¹åˆ«åŒæ„ä½ è¯´çš„FAASå’Œæ‰“å¼€è§†é‡ï¼Œæˆ‘å¯¹æ­¤æ·±æœ‰åŒæ„Ÿ~ ç”¨ä½ çš„è¯è¯´ï¼Œæ˜¯Sparkå¯¹äºåºåˆ—åŒ–å’Œååºåˆ—åŒ–çš„æ”¯æŒã€‚å¯¹æˆ‘æ¥è¯´ï¼ŒSparkçš„è°ƒåº¦ç³»ç»Ÿï¼Œå¯¹æˆ‘ä¸ªäººå½±å“å·¨å¤§ï¼Œè®©æˆ‘çœŸæ­£è®¤è¯†åˆ°åˆ†å¸ƒå¼ç³»ç»Ÿçš„ç©æ³•ã€ç‰¹è‰²å’Œæ ¸å¿ƒã€‚åœ¨æˆ‘çœ‹æ¥ï¼Œè°ƒåº¦ç³»ç»Ÿæ˜¯å­¦ä¹ Sparkæœ€åº”è¯¥å­¦çš„éƒ¨åˆ†ï¼Œæ²¡æœ‰ä¹‹ä¸€~ å½“ç„¶ï¼Œä»è€…è§ä»ï¼Œå¤§å®¶çš„å–œå¥½å’Œåå¥½éƒ½ä¸åŒ~ å°±æ‰“å¼€è§†é‡è¿™æ–¹é¢ï¼Œç¡®å®è°ƒåº¦ç³»ç»Ÿå¯¹äºæˆ‘ä¸ªäººçš„æå‡ï¼Œæˆ–è€…è¯´ç»™æˆ‘ä¸ªäººç•™ä¸‹çš„å°è±¡ï¼Œéå¸¸éå¸¸çš„æ·±åˆ»ã€‚\n\nå¹¿æ’­å˜é‡ç­”çš„ä¹Ÿå¾ˆå¥½~ RDDéœ€è¦å…ˆcollectï¼Œè¿™ä¸€ç‚¹å…¶å®æƒ³åæ§½ç¤¾åŒºï¼Œå®Œå…¨å¯ä»¥åšå¾—è·ŸDataFrameä¸€æ ·ï¼Œç›´æ¥å°è£…å°±å¥½äº†ï¼Œéè¦å¼€å‘è€…è‡ªè¡Œcollectä¸€æ³¢ï¼Œç„¶åå†å°è£…ï¼Œéº»çƒ¦ï¼DataFrameå°±æ¯”è¾ƒç›´æ¥ï¼ŒSparkåœ¨èƒŒåå¸®å¼€å‘è€…åšäº†collectè¿™ä¸€æ­¥ï¼Œå°±å¼€å‘è€…ä½¿ç”¨ä½“éªŒæ¥è¯´ï¼Œè¿˜æ˜¯è¦å¥½äº›~","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1633613103,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":314572,"user_name":"Geek_f39659","can_delete":false,"product_type":"c1","uid":1636568,"ip_address":"","ucode":"2206A8C590423C","user_header":"https://thirdwx.qlogo.cn/mmopen/vi_32/Q3auHgzwzM6iagw7ct4ca3niaSEFNicu2wy2KuCibO6eiaRzoRGJb50WTrbkKQib9mTArnTr8jJUazO9O2ibLZNfjjl35cfCHkBPs7N/132","comment_is_top":false,"comment_ctime":1633234571,"is_pvip":false,"replies":[{"id":"114052","content":"æ²¡é”™ï¼Œæ»¡åˆ†ğŸ’¯~","user_name":"ä½œè€…å›å¤","user_name_real":"å´ç£Š","uid":"1043100","ctime":1633610866,"ip_address":"","comment_id":314572,"utype":1}],"discussion_count":1,"race_medal":0,"score":"35992972939","product_id":100090001,"comment_content":"ç¬¬ä¸€é¢˜ï¼š driverä¸­å£°æ˜çš„éå¹¿æ’­å˜é‡ï¼Œå¦‚æœexecutoréœ€è¦ç”¨çš„è¯ï¼Œä¼šç»™æ¯ä¸€ä¸ªåˆ†åŒºæ‹·è´ä¸€ä¸ªå‰¯æœ¬ï¼Œæ‰€ä»¥æ¯ä¸ªåˆ†åŒºéƒ½ä¼šç»™è‡ªå·±çš„è¿™ä»½å‰¯æœ¬åŠ ä¸€åŠ ä¸€ã€‚æœ€åè¿™äº›å‰¯æœ¬éšç€executor è¿›ç¨‹çš„ç»“æŸå°±éƒ½ä¸¢å¤±äº†ã€‚æ‰€ä»¥driver ä¸­çš„è¿™ä¸ªå˜é‡ä»ç„¶è¿˜æ˜¯0.","like_count":9,"discussions":[{"author":{"id":1043100,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/ea/9c/230061e7.jpg","nickname":"å´ç£Š","note":"","ucode":"136DC8CF1B10DC","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":527723,"discussion_content":"æ²¡é”™ï¼Œæ»¡åˆ†ğŸ’¯~","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1633610866,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":342693,"user_name":"Sun","can_delete":false,"product_type":"c1","uid":1111374,"ip_address":"","ucode":"5F3708EAFA3E1F","user_header":"https://static001.geekbang.org/account/avatar/00/10/f5/4e/c890155f.jpg","comment_is_top":false,"comment_ctime":1650421996,"is_pvip":false,"discussion_count":1,"race_medal":0,"score":"5945389292","product_id":100090001,"comment_content":"è€å¸ˆæ‚¨å¥½ã€‚å…³äºç¬¬ä¸€é¢˜çš„å®éªŒï¼Œæˆ‘ä½¿ç”¨è‡ªå®šä¹‰ç±»ï¼Œå¦‚ä¸‹ï¼š<br>class MyCount implements Serializable{<br>    int num;<br>    public MyCount(){<br>        this.num = 0;<br>    }<br>    public void add(){<br>        this.num++;<br>    }<br>}<br>å°†å®ƒç”¨äºä»£æ›¿å¹¿æ’­å˜é‡ï¼Œæ˜¯ä¸è¡Œçš„ï¼Œå› ä¸ºexecutoræœ€åé”€æ¯äº†è¿™äº›å¯¹è±¡ã€‚<br>ä½†æ˜¯æˆ‘å°†è¿™ä¸ªå¯¹è±¡ç½®ä¸ºé™æ€å¯¹è±¡ï¼Œæ”¾åœ¨Driverä¸­å†è¿è¡Œåï¼Œè¿™ä¸ªå¯¹è±¡æˆåŠŸå¾—åˆ°äº†æœ€åçš„ç»“æœã€‚<br>è¯·é—®è€å¸ˆï¼Œä¸ºä»€ä¹ˆè®¾ç½®ä¸ºé™æ€å¯¹è±¡å°±å¯ä»¥è·å–ç»“æœå‘¢ï¼Ÿé™æ€å¯¹è±¡åœ¨Driverå’ŒExecutoræ˜¯æ€ä¹ˆä¸€ä¸ªå·¥ä½œæœºåˆ¶ï¼Ÿ","like_count":1,"discussions":[{"author":{"id":1591216,"avatar":"https://static001.geekbang.org/account/avatar/00/18/47/b0/cf5529a0.jpg","nickname":"ThomasG","note":"","ucode":"C05D94E0A10662","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":584346,"discussion_content":"æœ¬åœ°è·‘çš„è¿˜æ˜¯é›†ç¾¤è·‘çš„å•Š","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1660783496,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":"åŒ—äº¬"},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":319198,"user_name":"welldo","can_delete":false,"product_type":"c1","uid":1598796,"ip_address":"","ucode":"D38E75364CD2E3","user_header":"https://static001.geekbang.org/account/avatar/00/18/65/4c/f7f86496.jpg","comment_is_top":false,"comment_ctime":1635667782,"is_pvip":false,"replies":[{"id":"115719","content":"å“ˆå“ˆï¼Œå…ˆèµğŸ‘ä¸€ä¸‹è€å¼Ÿçˆ±é’»ç ”çš„ç²¾ç¥ï¼ï¼ï¼<br><br>ä¸è¿‡å‘¢ï¼Œæ‰€è°“çš„æ¼æ´è¯´æ³•æœ‰é—®é¢˜ï¼Œè¯æ˜æ›´æœ‰é—®é¢˜ï¼Œå“ˆå“ˆã€‚æ ¹æœ¬åŸå› è¿˜æ˜¯ï¼Œä½ çš„ç¯å¢ƒæ˜¯å•æœºã€localï¼Œæ‰€ä»¥ä½ æ€ä¹ˆç©å„¿ï¼Œéƒ½æ˜¯å•æœºçš„ç©å„¿æ³•ã€‚ä½ æ¯”å¦‚è¿™å¥ï¼š<br><br>bufferBroad.value.append(&quot;test&quot;)<br><br>æ¨å¹¿åˆ°åˆ†å¸ƒå¼çš„ç¯å¢ƒï¼Œè‚¯å®šä¼šæŠ¥é”™çš„ã€‚æ‰€ä»¥è¯´åšå®éªŒçš„è¯ï¼Œå»ºè®®è¿˜æ˜¯åœ¨åˆ†å¸ƒå¼ä¸‹å»åšï¼Œè¿™æ ·å¾ˆå¤šç»“è®ºï¼Œæ‰ç«™å¾—ä½è„š~","user_name":"ä½œè€…å›å¤","user_name_real":"å´ç£Š","uid":"1043100","ctime":1635684591,"ip_address":"","comment_id":319198,"utype":1}],"discussion_count":1,"race_medal":0,"score":"5930635078","product_id":100090001,"comment_content":"è€å¸ˆï¼Œå¹¿æ’­å˜é‡æœ‰&quot;åªè¯»&quot; &#47; &quot;ä¸å¯å˜&quot;ç‰¹æ€§ï¼Œ<br>ä½†å¹¿æ’­å¼•ç”¨æ•°æ®ç±»å‹æ—¶, å¹¿æ’­çš„å®é™…ä¸Šæ˜¯åœ°å€å€¼ï¼Œé‚£ä¹ˆåœ°å€å€¼è‚¯å®šä¸å¯å˜ï¼Œè€Œåœ°å€å€¼æŒ‡å‘çš„å†…å®¹æ˜¯å¯å˜çš„;<br><br>æˆ‘ä»Šå¤©åœ¨ideaå’Œshellé‡Œåšäº†ä¸€ä¸ªæµ‹è¯•ï¼Œè¯æ˜äº†è¿™ä¸ªè¯´æ³•æ˜¯å¯¹çš„,<br>ä»£ç å¦‚ä¸‹:<br>(scala-Listæ˜¯ä¸å¯å˜çš„ï¼Œæ‰€ä»¥ä»£ç é‡Œæˆ‘ç”¨äº†å¯å˜çš„scala-ListBuffer)<br><br>var buffer: ListBuffer[String] = ListBuffer()<br>var bufferBroad = spark.sparkContext.broadcast(buffer)<br>val cleanWordRDD2: RDD[String] = wordRDD.filter(word =&gt; {<br>  if (bc.value.contains(word)) {\t\t&#47;&#47;bcæ˜¯æ–‡ç« é‡Œçš„å¹¿æ’­å˜é‡<br>\tbufferBroad.value.append(&quot;test&quot;)\t&#47;&#47;å…³é”®çš„ä¸€è¡Œ<br>\ttrue<br>  } else {<br>\tfalse<br>  }<br>})<br><br>println(cleanWordRDD2.count())&#47;&#47;è§¦å‘è¿™æ¡dag<br>println(buffer)\t\t\t\t&#47;&#47;97(34+63)ä¸ªtest<br>println(bufferBroad.value)\t&#47;&#47;97(34+63)ä¸ªtest<br><br>è€å¸ˆï¼Œè¿™ä¸ªè¯´æ³•å’Œæˆ‘çš„è¯æ˜æ²¡æœ‰é—®é¢˜å§ï¼Ÿ<br>è¿™ä¸ªç®—ä¸ç®—â€œä¸å¯å˜â€ç‰¹æ€§çš„æ¼æ´ å‘¢ï¼Ÿ","like_count":1,"discussions":[{"author":{"id":1043100,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/ea/9c/230061e7.jpg","nickname":"å´ç£Š","note":"","ucode":"136DC8CF1B10DC","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":529541,"discussion_content":"å“ˆå“ˆï¼Œå…ˆèµğŸ‘ä¸€ä¸‹è€å¼Ÿçˆ±é’»ç ”çš„ç²¾ç¥ï¼ï¼ï¼\n\nä¸è¿‡å‘¢ï¼Œæ‰€è°“çš„æ¼æ´è¯´æ³•æœ‰é—®é¢˜ï¼Œè¯æ˜æ›´æœ‰é—®é¢˜ï¼Œå“ˆå“ˆã€‚æ ¹æœ¬åŸå› è¿˜æ˜¯ï¼Œä½ çš„ç¯å¢ƒæ˜¯å•æœºã€localï¼Œæ‰€ä»¥ä½ æ€ä¹ˆç©å„¿ï¼Œéƒ½æ˜¯å•æœºçš„ç©å„¿æ³•ã€‚ä½ æ¯”å¦‚è¿™å¥ï¼š\n\nbufferBroad.value.append(&amp;quot;test&amp;quot;)\n\næ¨å¹¿åˆ°åˆ†å¸ƒå¼çš„ç¯å¢ƒï¼Œè‚¯å®šä¼šæŠ¥é”™çš„ã€‚æ‰€ä»¥è¯´åšå®éªŒçš„è¯ï¼Œå»ºè®®è¿˜æ˜¯åœ¨åˆ†å¸ƒå¼ä¸‹å»åšï¼Œè¿™æ ·å¾ˆå¤šç»“è®ºï¼Œæ‰ç«™å¾—ä½è„š~","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1635684591,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":319021,"user_name":"welldo","can_delete":false,"product_type":"c1","uid":1598796,"ip_address":"","ucode":"D38E75364CD2E3","user_header":"https://static001.geekbang.org/account/avatar/00/18/65/4c/f7f86496.jpg","comment_is_top":false,"comment_ctime":1635512167,"is_pvip":false,"replies":[{"id":"115674","content":"ç»§æ‰¿AccumulatorV2ä¹Ÿæ˜¯ä¸ªæ–¹æ³•ï¼Œå…¶å®è¿˜è›®é«˜çº§çš„~","user_name":"ä½œè€…å›å¤","user_name_real":"å´ç£Š","uid":"1043100","ctime":1635608492,"ip_address":"","comment_id":319021,"utype":1}],"discussion_count":1,"race_medal":0,"score":"5930479463","product_id":100090001,"comment_content":"ä»¥å‰æˆ‘å†™ç´¯åŠ å™¨ï¼Œéƒ½æ˜¯æ‰‹åŠ¨ç»§æ‰¿AccumulatorV2ï¼Œç°åœ¨æ‰¾åˆ°æ›´ç®€å•çš„æ–¹æ³•äº†ğŸ˜","like_count":2,"discussions":[{"author":{"id":1043100,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/ea/9c/230061e7.jpg","nickname":"å´ç£Š","note":"","ucode":"136DC8CF1B10DC","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":529460,"discussion_content":"ç»§æ‰¿AccumulatorV2ä¹Ÿæ˜¯ä¸ªæ–¹æ³•ï¼Œå…¶å®è¿˜è›®é«˜çº§çš„~","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1635608492,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":315785,"user_name":"ç«ç‚ç„±ç‡š","can_delete":false,"product_type":"c1","uid":2767491,"ip_address":"","ucode":"DB11784DD94059","user_header":"https://static001.geekbang.org/account/avatar/00/2a/3a/83/74e3fabd.jpg","comment_is_top":false,"comment_ctime":1634000526,"is_pvip":false,"replies":[{"id":"114518","content":"èµğŸ‘ï¼Œæ»¡åˆ†ğŸ’¯ï¼Œåˆæ”¶è·ä¸€ä»½Pythonä»£ç ï¼Œæ„Ÿè°¢è€å¼Ÿï¼åç»­æˆ‘ä»¬ä¸€èµ·æŠŠä»£ç æ•´ç†åˆ°Github~","user_name":"ä½œè€…å›å¤","user_name_real":"å´ç£Š","uid":"1043100","ctime":1634136526,"ip_address":"","comment_id":315785,"utype":1}],"discussion_count":1,"race_medal":0,"score":"5928967822","product_id":100090001,"comment_content":"python ç‰ˆçš„ä»£ç å¯¹ç´¯åŠ å™¨è¿™å„¿æœ‰äº›ä¸ä¸€æ ·ï¼Œè²Œä¼¼æ²¡æœ‰longAccumulatorï¼Œdoubleä¹‹åˆ†ï¼Œæˆ‘è¿™å„¿æ˜¯è¿™æ ·çš„ï¼š<br><br>file=&#39;~~~~&#47;chapter01&#47;wikiOfSpark.txt&#39;<br>lineRDD=sc.textFile(file)<br>lineRDD.first() # ä¼šæ‰“å°å‡ºlineRDDçš„ç¬¬ä¸€è¡Œï¼š u&#39;Apache Spark&#39;ï¼Œå¦‚æœæ²¡æœ‰æ‰“å°å‡ºæ¥ï¼Œåˆ™æŠ¥é”™<br>wordRDD=lineRDD.flatMap(lambda line: line.split(&quot; &quot;))<br><br># å®šä¹‰ç´¯åŠ å™¨<br>ac = sc.accumulator(0) # è¿™å„¿çš„å®šä¹‰æ–¹å¼ä¸ä¸€æ ·<br># å®šä¹‰filterç®—å­çš„åˆ¤å®šå‡½æ•°fï¼Œæ³¨æ„ï¼Œfçš„è¿”å›ç±»å‹å¿…é¡»æ˜¯Boolean<br>def f(x):<br>    if x==&#39;&#39;:<br>        ac.add(1)<br>        return False<br>    else:<br>        return True<br>    <br># ä½¿ç”¨få¯¹RDDè¿›è¡Œè¿‡æ»¤<br>cleanWordRDD = wordRDD.filter(f)<br>kvRDD=cleanWordRDD.map(lambda word:(word,1))<br>wordCounts=kvRDD.reduceByKey(lambda x,y:x+y)<br># è·å–è®¡ç®—ç»“æœ<br>wordCounts.collect()<br># ç»“æœï¼š[(&#39;Spark&#39;, 63), (&#39;Apache&#39;, 34)]<br># wordCounts.map(lambda (k,v):(v,k)).sortByKey(False).take(5)<br><br># ä½œä¸šæ‰§è¡Œå®Œæ¯•ï¼Œé€šè¿‡è°ƒç”¨valueè·å–ç´¯åŠ å™¨ç»“æœ<br>ac.value<br># 79","like_count":1,"discussions":[{"author":{"id":1043100,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/ea/9c/230061e7.jpg","nickname":"å´ç£Š","note":"","ucode":"136DC8CF1B10DC","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":528166,"discussion_content":"èµğŸ‘ï¼Œæ»¡åˆ†ğŸ’¯ï¼Œåˆæ”¶è·ä¸€ä»½Pythonä»£ç ï¼Œæ„Ÿè°¢è€å¼Ÿï¼åç»­æˆ‘ä»¬ä¸€èµ·æŠŠä»£ç æ•´ç†åˆ°Github~","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1634136526,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":314531,"user_name":"GACÂ·DU","can_delete":false,"product_type":"c1","uid":1385403,"ip_address":"","ucode":"7847FBE1C13740","user_header":"https://static001.geekbang.org/account/avatar/00/15/23/bb/a1a61f7c.jpg","comment_is_top":false,"comment_ctime":1633179602,"is_pvip":true,"replies":[{"id":"114048","content":"éå¸¸èµ~ å®Œç¾åœ°å¤ç°äº†é—®é¢˜~ è¿™æ­£æ˜¯æˆ‘æƒ³è¦çš„ï¼Œå“ˆå“ˆ~<br><br>å…³äºç¬¬ä¸€é¢˜ï¼Œä»£ç å†™çš„æ²¡æœ‰ä»»ä½•é—®é¢˜ï¼Œå°±æ˜¯æƒ³è®©å¤§å®¶å¯¹æ¯”è¿™é‡Œçš„  var n: Long = _ &#47;&#47; å…¨å±€å˜é‡ï¼Œä¸ç´¯åŠ å™¨çš„åŒºåˆ«æ‰€åœ¨ã€‚ä½ çš„æ‰§è¡Œç»“æœï¼Œå®Œå…¨ç¬¦åˆé¢„æœŸï¼Œå³æœ¬æœºè·‘ï¼Œå®Œå…¨OKï¼Œä½†æ˜¯ï¼Œåˆ†å¸ƒå¼ç¯å¢ƒå°±ä¸è¡Œã€‚è¿™é‡Œæˆ‘å…ˆä¸ç»™è€å¼Ÿå›å¤ï¼Œè€å¼Ÿä¸å¦¨èŠ±æ—¶é—´æƒ³æƒ³ï¼Œæ²¡æƒ³æ˜ç™½çš„è¯ï¼Œè¯´æ˜è¿™ä¸€è®²ç´¯åŠ å™¨æ²¡æœ‰åƒé€ï¼Œå†æƒ³æƒ³å“ˆ~ æƒ³ä¸æ¸…æ¥šä¹Ÿä¸è¦ç´§ï¼Œæˆ‘ä»¬ç•™è¨€åŒºç»§ç»­è®¨è®º~<br><br>ç¬¬äºŒä¸ªé—®é¢˜çš„è¯ï¼Œå¹¿æ’­å˜é‡æ˜¯read-onlyçš„ï¼Œåªèƒ½è¯»ï¼Œä¸èƒ½å†™ï¼Œå…¶å®è¿™é‡Œçš„é—®é¢˜ï¼Œä¸æ˜¯æƒ³é—®å®ƒå’Œç´¯åŠ å™¨çš„åŒºåˆ«ï¼Œè€Œæ˜¯æƒ³é—®ï¼Œå¹¿æ’­å˜é‡èƒ½ä¸èƒ½å°è£…RDDã€DataFrameè¿™ç§åˆ†å¸ƒå¼æ•°æ®é›†ï¼Œç­”æ¡ˆæ˜¯è‚¯å®šçš„å“ˆ~ é™¤äº†æ™®é€šå˜é‡ï¼Œåˆ†å¸ƒå¼æ•°æ®é›†ä¹‹ä¸Šï¼Œä¹Ÿå¯ä»¥åˆ›å»ºå¹¿æ’­å˜é‡~","user_name":"ä½œè€…å›å¤","user_name_real":"å´ç£Š","uid":"1043100","ctime":1633601985,"ip_address":"","comment_id":314531,"utype":1}],"discussion_count":4,"race_medal":0,"score":"5928146898","product_id":100090001,"comment_content":"å†™ç¨‹åºæµ‹è¯•äº†ä¸€ä¸‹è€å¸ˆçš„ç¬¬ä¸€ä¸ªæ€è€ƒé¢˜ï¼Œåœ¨æœ¬æœºçš„ideaä¸­å¯ä»¥å¾—åˆ°æ­£ç¡®çš„ç»“æœ79ï¼Œä½†æ˜¯åœ¨spark- shellæˆ–è€…æäº¤åˆ°yarné›†ç¾¤ä¸Šç»“æœå´æ˜¯0ï¼Œå¥½çº ç»“ï¼Œè¯·è€å¸ˆè§£æƒ‘ï¼Œä»£ç å¦‚ä¸‹ã€‚<br>ç¬¬äºŒä¸ªæ€è€ƒé¢˜ï¼Œæˆ‘è®¤ä¸ºå¹¿æ’­å˜é‡æ˜¯åªè¯»æ•°æ®ï¼Œå‚åŠ è®¡ç®—æ—¶ä¸èƒ½éšç€RDDä¸€èµ·å˜æ¢å½¢æ€ç ´åæ•°æ®çš„ä¸€è‡´æ€§ã€‚<br><br>import org.apache.spark.sql.SparkSession<br><br>object BcAcOpt {<br><br>  var n: Long = _ &#47;&#47; å…¨å±€å˜é‡<br><br>  def main(args: Array[String]): Unit = {<br><br>    val spark = SparkSession.builder.master(&quot;local[*]&quot;).appName(&quot;board&quot;).getOrCreate()<br><br>    val lineRDD = spark.sparkContext.textFile(&quot;wikiOfSpark.txt&quot;)<br><br>    println(lineRDD.partitions.length)<br><br>    val wordRDD = lineRDD.flatMap(word =&gt; word.split(&quot; &quot;))<br><br>    val filterRDD = wordRDD.filter(acf)<br><br>    val kvRDD = filterRDD.map(word =&gt; (word, 1))<br><br>    val wordCount = kvRDD.reduceByKey((x, y) =&gt; x + y)<br><br>    wordCount.take(10)<br><br>    println(n)<br><br>    spark.stop()<br><br>  }<br><br>  def acf(word: String): Boolean = {<br>    if (&quot;&quot;.equals(word)) {<br>      n += 1<br>      false<br>    } else {<br>      true<br>    }<br>  }<br>}<br>","like_count":1,"discussions":[{"author":{"id":1043100,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/ea/9c/230061e7.jpg","nickname":"å´ç£Š","note":"","ucode":"136DC8CF1B10DC","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":527713,"discussion_content":"éå¸¸èµ~ å®Œç¾åœ°å¤ç°äº†é—®é¢˜~ è¿™æ­£æ˜¯æˆ‘æƒ³è¦çš„ï¼Œå“ˆå“ˆ~\n\nå…³äºç¬¬ä¸€é¢˜ï¼Œä»£ç å†™çš„æ²¡æœ‰ä»»ä½•é—®é¢˜ï¼Œå°±æ˜¯æƒ³è®©å¤§å®¶å¯¹æ¯”è¿™é‡Œçš„  var n: Long = _ // å…¨å±€å˜é‡ï¼Œä¸ç´¯åŠ å™¨çš„åŒºåˆ«æ‰€åœ¨ã€‚ä½ çš„æ‰§è¡Œç»“æœï¼Œå®Œå…¨ç¬¦åˆé¢„æœŸï¼Œå³æœ¬æœºè·‘ï¼Œå®Œå…¨OKï¼Œä½†æ˜¯ï¼Œåˆ†å¸ƒå¼ç¯å¢ƒå°±ä¸è¡Œã€‚è¿™é‡Œæˆ‘å…ˆä¸ç»™è€å¼Ÿå›å¤ï¼Œè€å¼Ÿä¸å¦¨èŠ±æ—¶é—´æƒ³æƒ³ï¼Œæ²¡æƒ³æ˜ç™½çš„è¯ï¼Œè¯´æ˜è¿™ä¸€è®²ç´¯åŠ å™¨æ²¡æœ‰åƒé€ï¼Œå†æƒ³æƒ³å“ˆ~ æƒ³ä¸æ¸…æ¥šä¹Ÿä¸è¦ç´§ï¼Œæˆ‘ä»¬ç•™è¨€åŒºç»§ç»­è®¨è®º~\n\nç¬¬äºŒä¸ªé—®é¢˜çš„è¯ï¼Œå¹¿æ’­å˜é‡æ˜¯read-onlyçš„ï¼Œåªèƒ½è¯»ï¼Œä¸èƒ½å†™ï¼Œå…¶å®è¿™é‡Œçš„é—®é¢˜ï¼Œä¸æ˜¯æƒ³é—®å®ƒå’Œç´¯åŠ å™¨çš„åŒºåˆ«ï¼Œè€Œæ˜¯æƒ³é—®ï¼Œå¹¿æ’­å˜é‡èƒ½ä¸èƒ½å°è£…RDDã€DataFrameè¿™ç§åˆ†å¸ƒå¼æ•°æ®é›†ï¼Œç­”æ¡ˆæ˜¯è‚¯å®šçš„å“ˆ~ é™¤äº†æ™®é€šå˜é‡ï¼Œåˆ†å¸ƒå¼æ•°æ®é›†ä¹‹ä¸Šï¼Œä¹Ÿå¯ä»¥åˆ›å»ºå¹¿æ’­å˜é‡~","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1633601985,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1396945,"avatar":"https://thirdwx.qlogo.cn/mmopen/vi_32/DYAIOgq83epaH1gHotWQukHnF2QtT2oK9hGvyLfSaKSzuC9XKH5aSWZj2KNrxYGJeNeVzIeAibzypibsmeicppGvA/132","nickname":"é­‚æ–—ç½—ä¸¶","note":"","ucode":"6BEA5CD3CCC2B7","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":535241,"discussion_content":"localæ¨¡å¼ä¸‹æ˜¯driverï¼Œexcutoråœ¨åŒä¸€ä¸ªè¿›ç¨‹é‡Œé¢çš„ï¼Œdriverå˜é‡nåœ¨ä¸åŒçš„excutoræ²¡æœ‰éšç€taskä»£ç åˆ†å‘äº§ç”Ÿæ–°çš„å˜é‡ï¼Œæ˜¯ä¸æ˜¯éƒ½ä¸éœ€è¦æœ‰taskçš„ä»£ç åˆ†å‘ã€‚è¿™ä¸ªè¿˜éœ€è¦çœ‹çœ‹","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1638372040,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":2518863,"avatar":"https://static001.geekbang.org/account/avatar/00/26/6f/4f/3cf1e9c4.jpg","nickname":"é’±é¹ Allen","note":"","ucode":"7E95E82C0717DA","race_medal":0,"user_type":1,"is_pvip":true},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":400855,"discussion_content":"    val lineRDD = spark.sparkContext.textFile(&#34;wikiOfSpark.txt&#34;) //å¯èƒ½hdfsä¸Šçš„æ–‡ä»¶è·¯å¾„æ²¡å†™å®Œå…¨ï¼Œæˆ–è€…æ²¡æœ‰æ­¤æ–‡ä»¶","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1633446695,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":1,"child_discussions":[{"author":{"id":1385403,"avatar":"https://static001.geekbang.org/account/avatar/00/15/23/bb/a1a61f7c.jpg","nickname":"GACÂ·DU","note":"","ucode":"7847FBE1C13740","race_medal":0,"user_type":1,"is_pvip":true},"reply_author":{"id":2518863,"avatar":"https://static001.geekbang.org/account/avatar/00/26/6f/4f/3cf1e9c4.jpg","nickname":"é’±é¹ Allen","note":"","ucode":"7E95E82C0717DA","race_medal":0,"user_type":1,"is_pvip":true},"discussion":{"id":400898,"discussion_content":"æ–‡ä»¶å°±åœ¨æ ¹ç›®å½•ä¸‹","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1633479566,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":400855,"ip_address":""},"score":400898,"extra":""}]}]},{"had_liked":false,"id":354300,"user_name":"å”æ–¹åˆš","can_delete":false,"product_type":"c1","uid":3046392,"ip_address":"å¹¿ä¸œ","ucode":"93DA58C3DCCF1B","user_header":"https://thirdwx.qlogo.cn/mmopen/vi_32/ugib9sF9icd9dhibQoAA025hibbD5zgZTiaddLoeEH457hrkBBhtQK6qknTWt270rHCtBZqeqsbibtHghgjdkPx3DyIw/132","comment_is_top":false,"comment_ctime":1660270179,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1660270179","product_id":100090001,"comment_content":"å¹¿æ’­å˜é‡æ˜¯ä»¥executorä¸ºç²’åº¦åˆ†å‘çš„ï¼Œé‚£ä¹ˆç´¯åŠ å™¨æ˜¯æ€ä¹ˆåˆ†å‘çš„ï¼Ÿæœ€ç»ˆçš„ç»“æœåˆæ˜¯æ€ä¹ˆç®—å‡ºæ¥çš„ï¼Ÿ","like_count":0},{"had_liked":false,"id":348878,"user_name":"æ¨å¸…","can_delete":false,"product_type":"c1","uid":1684811,"ip_address":"","ucode":"0A558B1BA62E44","user_header":"","comment_is_top":false,"comment_ctime":1655481809,"is_pvip":true,"discussion_count":0,"race_medal":0,"score":"1655481809","product_id":100090001,"comment_content":"è€å¸ˆï¼Œæˆ‘æœ‰ä¸€ä¸ªé—®é¢˜ï¼šä¸€ä¸ªworkerä¸Šå¯ä»¥æœ‰å¤šä¸ªexecutorå—ï¼Ÿåœ¨è¯»å–æ–‡ä»¶é˜¶æ®µï¼Œä¸€ä¸ªexecutorï¼ˆä¸€ä¸ªè¿›ç¨‹ï¼‰é‡Œå¯ä»¥æœ‰å¤šä¸ªtaskï¼ˆå¤šä¸ªçº¿ç¨‹ï¼‰è¯»å–ä¸åŒåˆ†åŒºï¼ˆRDDçš„åˆ†åŒºï¼‰çš„æ•°æ®å—ï¼Ÿé‚£RDDçš„åˆ†åŒºçš„å®šä¹‰æ˜¯ä»€ä¹ˆå‘¢ï¼Œæ˜¯ä¸åŒæœºå™¨ä¸Šçš„æ•°æ®ï¼Œè¿˜æ˜¯ï¼Ÿ","like_count":0},{"had_liked":false,"id":340694,"user_name":"Spoon","can_delete":false,"product_type":"c1","uid":1959822,"ip_address":"","ucode":"2FF9193AD482C2","user_header":"https://static001.geekbang.org/account/avatar/00/1d/e7/8e/318cfde0.jpg","comment_is_top":false,"comment_ctime":1649051846,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1649051846","product_id":100090001,"comment_content":"å…±äº«å˜é‡Javaç‰ˆæœ¬<br>https:&#47;&#47;github.com&#47;Spoon94&#47;spark-practice&#47;blob&#47;master&#47;src&#47;main&#47;java&#47;com&#47;spoon&#47;spark&#47;core&#47;SharedVariableJob.java","like_count":0},{"had_liked":false,"id":319020,"user_name":"welldo","can_delete":false,"product_type":"c1","uid":1598796,"ip_address":"","ucode":"D38E75364CD2E3","user_header":"https://static001.geekbang.org/account/avatar/00/18/65/4c/f7f86496.jpg","comment_is_top":false,"comment_ctime":1635511851,"is_pvip":false,"replies":[{"id":"115675","content":"ideaå…¶å®å°±æ˜¯å•æœºï¼Œå•æœºä¸Šï¼Œç”¨æ™®é€šå˜é‡ï¼Œå’Œç”¨ç´¯åŠ å™¨ï¼Œæ•ˆæœæ˜¯ä¸€æ ·çš„ã€‚ä½†æ˜¯åœ¨åˆ†å¸ƒå¼çš„ç¯å¢ƒä¸‹ï¼Œé«˜ä¸‹ç«‹ç°","user_name":"ä½œè€…å›å¤","user_name_real":"å´ç£Š","uid":"1043100","ctime":1635608617,"ip_address":"","comment_id":319020,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1635511851","product_id":100090001,"comment_content":"è€å¸ˆï¼Œå…³äºç¬¬ä¸€é¢˜ï¼Œ<br>æˆ‘çš„ç­”æ¡ˆï¼šdriverå’Œexecutoræ˜¯ä¸ä¸€æ ·çš„è¿›ç¨‹ï¼Œæ™®é€šå˜é‡ä¼šæ‹·è´å‰¯æœ¬åˆ°executorä¸Šï¼Œ<br>â€œåŸæœ¬â€å’Œâ€œå‰¯æœ¬â€æ²¡æœ‰ä»»ä½•å…³ç³»ï¼Œ<br>spark-shellæ‰“å°å‡ºæ¥çš„æ˜¯â€œåŸæœ¬â€ï¼Œæ•°å€¼æ˜¯åˆå§‹åŒ–æ—¶çš„å€¼.<br><br>æˆ‘çš„é—®é¢˜ï¼šä¸ºä½•ideaèƒ½è®¡ç®—æ­£ç¡®å‘¢ï¼Ÿ","like_count":1,"discussions":[{"author":{"id":1043100,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/ea/9c/230061e7.jpg","nickname":"å´ç£Š","note":"","ucode":"136DC8CF1B10DC","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":529459,"discussion_content":"ideaå…¶å®å°±æ˜¯å•æœºï¼Œå•æœºä¸Šï¼Œç”¨æ™®é€šå˜é‡ï¼Œå’Œç”¨ç´¯åŠ å™¨ï¼Œæ•ˆæœæ˜¯ä¸€æ ·çš„ã€‚ä½†æ˜¯åœ¨åˆ†å¸ƒå¼çš„ç¯å¢ƒä¸‹ï¼Œé«˜ä¸‹ç«‹ç°","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1635608617,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]}]}