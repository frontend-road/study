{"id":105486,"title":"11丨SQL99是如何使用连接的，与SQL92的区别是什么？","content":"<p>上节课我们讲解了SQL92标准，在它之后又提出了SQL99标准。现在各大DBMS中对SQL99标准的支持度更好。你一定听说过LEFT JOIN、RIGHT JOIN这样的操作符，这实际上就是SQL99的标准，在SQL92中它们是用（+）代替的。SQL92和SQL99标准原理类似，只是SQL99标准的可读性更强。</p><p>今天我就来讲解一下SQL99标准中的连接查询，在今天的课程中你需要重点掌握以下几方面的内容：</p><ol>\n<li>SQL99标准下的连接查询是如何操作的？</li>\n<li>SQL99与SQL92的区别是什么？</li>\n<li>在不同的DBMS中，使用连接需要注意什么？</li>\n</ol><h2>SQL99标准中的连接查询</h2><p>上一篇文章中，我用NBA球员的数据表进行了举例，包括了三张数据表player、team和height_grades。</p><p>其中player表为球员表，一共有37个球员，如下所示：</p><p><img src=\"https://static001.geekbang.org/resource/image/ee/99/ee9b554ecbc296e1a5865b52d4bb3c99.png?wh=896*401\" alt=\"\"><br>\nteam表为球队表，一共有3支球队，如下所示：</p><p><img src=\"https://static001.geekbang.org/resource/image/aa/75/aa73203c43672b6d3be44748b1556075.png?wh=836*239\" alt=\"\"><br>\nheight_grades表为身高等级表，如下所示：</p><p><img src=\"https://static001.geekbang.org/resource/image/4b/37/4b5b2c666705364b793329b728a1ed37.png?wh=870*298\" alt=\"\"><br>\n接下来我们看下在SQL99标准中，是如何进行连接查询的？</p><h3>交叉连接</h3><p>交叉连接实际上就是SQL92中的笛卡尔乘积，只是这里我们采用的是CROSS JOIN。</p><p>我们可以通过下面这行代码得到player和team这两张表的笛卡尔积的结果：</p><!-- [[[read_end]]] --><pre><code>SQL: SELECT * FROM player CROSS JOIN team\n</code></pre><p>运行结果（一共37*3=111条记录）：</p><p><img src=\"https://static001.geekbang.org/resource/image/95/d2/95c97414eca15373f26ae2b4192880d2.png?wh=964*301\" alt=\"\"><br>\n如果多张表进行交叉连接，比如表t1，表t2，表t3进行交叉连接，可以写成下面这样：</p><pre><code>SQL: SELECT * FROM t1 CROSS JOIN t2 CROSS JOIN t3\n</code></pre><h3>自然连接</h3><p>你可以把自然连接理解为SQL92中的等值连接。它会帮你自动查询两张连接表中所有相同的字段，然后进行等值连接。</p><p>如果我们想把player表和team表进行等值连接，相同的字段是team_id。还记得在SQL92标准中，是如何编写的么？</p><pre><code>SELECT player_id, a.team_id, player_name, height, team_name FROM player as a, team as b WHERE a.team_id = b.team_id\n</code></pre><p>在SQL99中你可以写成：</p><pre><code>SELECT player_id, team_id, player_name, height, team_name FROM player NATURAL JOIN team \n</code></pre><p>实际上，在SQL99中用NATURAL JOIN替代了 <code>WHERE player.team_id = team.team_id</code>。</p><h3>ON连接</h3><p>ON连接用来指定我们想要的连接条件，针对上面的例子，它同样可以帮助我们实现自然连接的功能：</p><pre><code>SELECT player_id, player.team_id, player_name, height, team_name FROM player JOIN team ON player.team_id = team.team_id\n</code></pre><p>这里我们指定了连接条件是<code>ON player.team_id = team.team_id</code>，相当于是用ON进行了team_id字段的等值连接。</p><p>当然你也可以ON连接进行非等值连接，比如我们想要查询球员的身高等级，需要用player和height_grades两张表：</p><pre><code>SQL99：SELECT p.player_name, p.height, h.height_level\nFROM player as p JOIN height_grades as h\nON height BETWEEN h.height_lowest AND h.height_highest\n\n</code></pre><p>这个语句的运行结果和我们之前采用SQL92标准的查询结果一样。</p><pre><code>SQL92：SELECT p.player_name, p.height, h.height_level\nFROM player AS p, height_grades AS h\nWHERE p.height BETWEEN h.height_lowest AND h.height_highest\n</code></pre><p>一般来说在SQL99中，我们需要连接的表会采用JOIN进行连接，ON指定了连接条件，后面可以是等值连接，也可以采用非等值连接。</p><h3>USING连接</h3><p>当我们进行连接的时候，可以用USING指定数据表里的同名字段进行等值连接。比如：</p><pre><code>SELECT player_id, team_id, player_name, height, team_name FROM player JOIN team USING(team_id)\n</code></pre><p>你能看出与自然连接NATURAL JOIN不同的是，USING指定了具体的相同的字段名称，你需要在USING的括号()中填入要指定的同名字段。同时使用JOIN USING可以简化JOIN ON的等值连接，它与下面的SQL查询结果是相同的：</p><pre><code>SELECT player_id, player.team_id, player_name, height, team_name FROM player JOIN team ON player.team_id = team.team_id\n</code></pre><h3>外连接</h3><p>SQL99的外连接包括了三种形式：</p><ol>\n<li>左外连接：LEFT JOIN 或 LEFT OUTER JOIN</li>\n<li>右外连接：RIGHT JOIN 或 RIGHT OUTER JOIN</li>\n<li>全外连接：FULL JOIN 或 FULL OUTER JOIN</li>\n</ol><p>我们在SQL92中讲解了左外连接、右外连接，在SQL99中还有全外连接。全外连接实际上就是左外连接和右外连接的结合。在这三种外连接中，我们一般省略OUTER不写。</p><p>1.左外连接</p><p><strong>SQL92</strong></p><pre><code>SELECT * FROM player, team where player.team_id = team.team_id(+)\n</code></pre><p><strong>SQL99</strong></p><pre><code>SELECT * FROM player LEFT JOIN team ON player.team_id = team.team_id\n</code></pre><p>2.右外连接</p><p><strong>SQL92</strong></p><pre><code>SELECT * FROM player, team where player.team_id(+) = team.team_id\n</code></pre><p><strong>SQL99</strong></p><pre><code>SELECT * FROM player RIGHT JOIN team ON player.team_id = team.team_id\n</code></pre><p>3.全外连接</p><p><strong>SQL99</strong></p><pre><code>SELECT * FROM player FULL JOIN team ON player.team_id = team.team_id\n</code></pre><p>需要注意的是MySQL不支持全外连接，否则的话全外连接会返回左表和右表中的所有行。当表之间有匹配的行，会显示内连接的结果。当某行在另一个表中没有匹配时，那么会把另一个表中选择的列显示为空值。</p><p>也就是说，全外连接的结果=左右表匹配的数据+左表没有匹配到的数据+右表没有匹配到的数据。</p><h3>自连接</h3><p>自连接的原理在SQL92和SQL99中都是一样的，只是表述方式不同。</p><p>比如我们想要查看比布雷克·格里芬身高高的球员都有哪些，在两个SQL标准下的查询如下。</p><p><strong>SQL92</strong></p><pre><code>SELECT b.player_name, b.height FROM player as a , player as b WHERE a.player_name = '布雷克-格里芬' and a.height &lt; b.height\n</code></pre><p><strong>SQL99</strong></p><pre><code>SELECT b.player_name, b.height FROM player as a JOIN player as b ON a.player_name = '布雷克-格里芬' and a.height &lt; b.height\n</code></pre><p>运行结果（6条记录）：</p><p><img src=\"https://static001.geekbang.org/resource/image/c7/e0/c79ecee3e5368ee73bfe7edb8a80a6e0.png?wh=841*413\" alt=\"\"></p><h2>SQL99和SQL92的区别</h2><p>至此我们讲解完了SQL92和SQL99标准下的连接查询，它们都对连接进行了定义，只是操作的方式略有不同。我们再来回顾下，这些连接操作基本上可以分成三种情况：</p><ol>\n<li>内连接：将多个表之间满足连接条件的数据行查询出来。它包括了等值连接、非等值连接和自连接。</li>\n<li>外连接：会返回一个表中的所有记录，以及另一个表中匹配的行。它包括了左外连接、右外连接和全连接。</li>\n<li>交叉连接：也称为笛卡尔积，返回左表中每一行与右表中每一行的组合。在SQL99中使用的CROSS JOIN。</li>\n</ol><p>不过SQL92在这三种连接操作中，和SQL99还存在着明显的区别。</p><p>首先我们看下SQL92中的WHERE和SQL99中的JOIN。</p><p>你能看出在SQL92中进行查询时，会把所有需要连接的表都放到FROM之后，然后在WHERE中写明连接的条件。而SQL99在这方面更灵活，它不需要一次性把所有需要连接的表都放到FROM之后，而是采用JOIN的方式，每次连接一张表，可以多次使用JOIN进行连接。</p><p>另外，我建议多表连接使用SQL99标准，因为层次性更强，可读性更强，比如：</p><pre><code>SELECT ...\nFROM table1\n    JOIN table2 ON table1和table2的连接条件\n        JOIN table3 ON table2和table3的连接条件\n</code></pre><p>它的嵌套逻辑类似我们使用的FOR循环：</p><pre><code>for t1 in table1:\n    for t2 in table2:\n       if condition1:\n           for t3 in table3:\n              if condition2:\n                  output t1 + t2 + t3\n</code></pre><p>SQL99采用的这种嵌套结构非常清爽，即使再多的表进行连接也都清晰可见。如果你采用SQL92，可读性就会大打折扣。</p><p>最后一点就是，SQL99在SQL92的基础上提供了一些特殊语法，比如NATURAL JOIN和JOIN USING。它们在实际中是比较常用的，省略了ON后面的等值条件判断，让SQL语句更加简洁。</p><h2>不同DBMS中使用连接需要注意的地方</h2><p>SQL连接具有通用性，但是不同的DBMS在使用规范上会存在差异，在标准支持上也存在不同。在实际工作中，你需要参考你正在使用的DBMS文档，这里我整理了一些需要注意的常见的问题。</p><p><strong>1.不是所有的DBMS都支持全外连接</strong></p><p>虽然SQL99标准提供了全外连接，但不是所有的DBMS都支持。不仅MySQL不支持，Access、SQLite、MariaDB等数据库软件也不支持。不过在Oracle、DB2、SQL Server中是支持的。</p><p><strong>2.Oracle没有表别名AS</strong></p><p>为了让SQL查询语句更简洁，我们经常会使用表别名AS，不过在Oracle中是不存在AS的，使用表别名的时候，直接在表名后面写上表别名即可，比如player p，而不是player AS p。</p><p><strong>3.SQLite的外连接只有左连接</strong></p><p>SQLite是一款轻量级的数据库软件，在外连接上只支持左连接，不支持右连接，不过如果你想使用右连接的方式，比如<code>table1 RIGHT JOIN table2</code>，在SQLite你可以写成<code>table2 LEFT JOIN table1</code>，这样就可以得到相同的效果。</p><p>除了一些常见的语法问题，还有一些关于连接的性能问题需要你注意：</p><p><strong>1.控制连接表的数量</strong></p><p>多表连接就相当于嵌套for循环一样，非常消耗资源，会让SQL查询性能下降得很严重，因此不要连接不必要的表。在许多DBMS中，也都会有最大连接表的限制。</p><p><strong>2.在连接时不要忘记WHERE语句</strong></p><p>多表连接的目的不是为了做笛卡尔积，而是筛选符合条件的数据行，因此在多表连接的时候不要忘记了WHERE语句，这样可以过滤掉不必要的数据行返回。</p><p><strong>3.使用自连接而不是子查询</strong></p><p>我们在查看比布雷克·格里芬高的球员都有谁的时候，可以使用子查询，也可以使用自连接。一般情况建议你使用自连接，因为在许多DBMS的处理过程中，对于自连接的处理速度要比子查询快得多。你可以这样理解：子查询实际上是通过未知表进行查询后的条件判断，而自连接是通过已知的自身数据表进行条件判断，因此在大部分DBMS中都对自连接处理进行了优化。</p><h2>总结</h2><p>连接可以说是SQL中的核心操作，通过两篇文章的学习，你已经从多个维度对连接进行了了解。同时，我们对SQL的两个重要标准SQL92和SQL99进行了学习，在我们需要进行外连接的时候，建议采用SQL99标准，这样更适合阅读。</p><p>此外我还想强调一下，我们在进行连接的时候，使用的关系型数据库管理系统，之所以存在关系是因为各种数据表之间存在关联，它们并不是孤立存在的。在实际工作中，尤其是做业务报表的时候，我们会用到SQL中的连接操作（JOIN），因此我们需要理解和熟练掌握SQL标准中连接的使用，以及不同DBMS中对连接的语法规范。剩下要做的，就是通过做练习和实战来增强你的经验了，做的练习多了，也就自然有感觉了。</p><p><img src=\"https://static001.geekbang.org/resource/image/44/5b/443181aea770ba5844efac6b02e02c5b.jpg?wh=3341*1819\" alt=\"\"><br>\n我今天讲解了SQL99的连接操作，不妨请你做一个小练习。请你编写SQL查询语句，查询不同身高级别（对应height_grades表）对应的球员数量（对应player表）。</p><p>欢迎你在评论区写下你的答案，我会在评论区与你一起讨论。也欢迎把这篇文章分享给你的朋友或者同事。</p>","comments":[{"had_liked":false,"id":110493,"user_name":"一步","can_delete":false,"product_type":"c1","uid":1005391,"ip_address":"","ucode":"73CEA468CE70C3","user_header":"https://static001.geekbang.org/account/avatar/00/0f/57/4f/6fb51ff1.jpg","comment_is_top":false,"comment_ctime":1562287811,"is_pvip":true,"replies":[{"id":"40179","content":"完整的SELECT语句内部执行顺序是：<br>1、FROM子句组装数据（包括通过ON进行连接）<br>2、WHERE子句进行条件筛选<br>3、GROUP BY分组 <br>4、使用聚集函数进行计算； <br>5、HAVING筛选分组； <br>6、计算所有的表达式； <br>7、SELECT 的字段；<br>8、ORDER BY排序<br>9、LIMIT筛选","user_name":"作者回复","user_name_real":"cy","uid":"1306094","ctime":1562292173,"ip_address":"","comment_id":110493,"utype":1}],"discussion_count":3,"race_medal":1,"score":"267850260163","product_id":100029501,"comment_content":"所有的连接类型，是不是都先对连接的表做笛卡尔，然后在根据条件进行数据筛选的？<br><br>对于上一个问题，可能没有表达清楚，我想问的是，各种连接的内部执行步骤，比如先根据连接生成中间表数据，然后在连接类型，on,where进行数据筛选得到数据的步骤","like_count":63,"discussions":[{"author":{"id":1306094,"avatar":"https://static001.geekbang.org/account/avatar/00/13/ed/ee/c4779b67.jpg","nickname":"cy","note":"","ucode":"50D653399A31F6","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":456908,"discussion_content":"完整的SELECT语句内部执行顺序是：\n1、FROM子句组装数据（包括通过ON进行连接）\n2、WHERE子句进行条件筛选\n3、GROUP BY分组 \n4、使用聚集函数进行计算； \n5、HAVING筛选分组； \n6、计算所有的表达式； \n7、SELECT 的字段；\n8、ORDER BY排序\n9、LIMIT筛选","likes_number":2,"is_delete":false,"is_hidden":false,"ctime":1562292173,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1012325,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/72/65/68bd8177.jpg","nickname":"雪飞鸿","note":"","ucode":"65D7B030828809","race_medal":0,"user_type":1,"is_pvip":true},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":2484,"discussion_content":"这个是MySQL的执行顺序吧，SQL Server略有差异","likes_number":2,"is_delete":false,"is_hidden":false,"ctime":1563703868,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1155463,"avatar":"https://static001.geekbang.org/account/avatar/00/11/a1/87/259ab5a3.jpg","nickname":"桂冠远航","note":"","ucode":"5959E1A1DAA05D","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":226383,"discussion_content":"终于搞清楚了不同链接写法的原因原来是标准不同，学习了。","likes_number":1,"is_delete":false,"is_hidden":false,"ctime":1586433049,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":110522,"user_name":"墨禾","can_delete":false,"product_type":"c1","uid":1216590,"ip_address":"","ucode":"81BA44231AABE8","user_header":"https://static001.geekbang.org/account/avatar/00/12/90/4e/efaea936.jpg","comment_is_top":false,"comment_ctime":1562289561,"is_pvip":false,"replies":[{"id":"40172","content":"多谢支持，不同企业使用的DBMS会有不同，所以在竞争激烈的环境下掌握不同的RDBMS的使用有时候会是一种优势。<br>我们知道数据库都有自己的“方言”，同时也都遵循一定的规范标准，所以对规范标准的掌握有时候更重要，“方言”在实际使用中查阅相应的RDBMS文档，当然日常积累也很重要<br>专栏里不同人所处的阶段不同，所以需要先交付基础，当然即使是基础篇也需要了解底层原理，这样对后续的SQL优化很有必要。<br>赞下总结笔记的习惯，我接触很多同学，一般来说经常写总结笔记的同学收获更大，在实际工作中也会游刃有余。","user_name":"作者回复","user_name_real":"cy","uid":"1306094","ctime":1562290908,"ip_address":"","comment_id":110522,"utype":1}],"discussion_count":5,"race_medal":0,"score":"156181112217","product_id":100029501,"comment_content":"    跟踪到第四个星期的专栏学习，这里对前面的知识点做个阶段性的总结。首先我自己是个用过mssql、mysql做过项目开发的人，所以我学习这几节课的专栏比较轻松，除了对过去的项目做个复盘提醒之外，还有些新的收获——从纵向广度、横向深度了解sql语言的特点。<br>-----------------------------------------------------------------------------------------------------<br>1、纵向广度<br>几乎每节专栏都会对 mysql 和 oracle 的知识点做对比，让我从不同之中寻找练习，迁移默化之中加强知识迁移的能力，让我在技术不断迭代更新的时代减少一些焦虑感。<br>-------------------------------------------------------------------------------------------------------<br>2、横向深度<br>-- 熟悉了更多的专业术语（如DML、DDL、DQL、TCL、SQL92、SQL99）：之前在实操的时候，只管用，而不管知识属于哪个体系，这样的方法有些粗暴而低效，因为有时候出错的时候，在不理解知识整体结构和专业术语的情况下，难以定位具体的出错点，也就难以检索到对应的解决办法。<br><br>-- 理清楚mysql的知识脉络结构，学习一种思维模式：每一节专栏都有对应的思维导图，看完文字听完语音，掌握了知识要点后，可能忽略了知识之间的联系，思维导图可以很清晰地展现知识之间的联系。其实看老师的专栏的结构组织，也就是一种学习【思维模式】，让我逐渐地转变学生思维，一年后，以更为优秀的姿态走向社会。<br><br>-- 摆正心态：大步迈进，小步迭代。看到知识点都是自己学过的，有时候会觉得有些亏。 但反过来想，老师这么厉害的人，尚且与我们一起学习基础知识，我有什么理由好高骛远？ 所以我要做到每节课不落地认真做笔记，最重要的还是要多实践，实践方能出真知。","like_count":36,"discussions":[{"author":{"id":1306094,"avatar":"https://static001.geekbang.org/account/avatar/00/13/ed/ee/c4779b67.jpg","nickname":"cy","note":"","ucode":"50D653399A31F6","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":456921,"discussion_content":"多谢支持，不同企业使用的DBMS会有不同，所以在竞争激烈的环境下掌握不同的RDBMS的使用有时候会是一种优势。\n我们知道数据库都有自己的“方言”，同时也都遵循一定的规范标准，所以对规范标准的掌握有时候更重要，“方言”在实际使用中查阅相应的RDBMS文档，当然日常积累也很重要\n专栏里不同人所处的阶段不同，所以需要先交付基础，当然即使是基础篇也需要了解底层原理，这样对后续的SQL优化很有必要。\n赞下总结笔记的习惯，我接触很多同学，一般来说经常写总结笔记的同学收获更大，在实际工作中也会游刃有余。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1562290908,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1394726,"avatar":"https://static001.geekbang.org/account/avatar/00/15/48/26/93fd21d5.jpg","nickname":"书痕","note":"","ucode":"8367371EF89D61","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":35760,"discussion_content":"我感觉到目前为止收获最大的是理解了查询执行的顺序，之前不理解某条查询SQL为什么可以达到那个效果，现在按照查询执行顺序再“自己执行一下”那条SQL就豁然开朗了。","likes_number":1,"is_delete":false,"is_hidden":false,"ctime":1571303604,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":2597449,"avatar":"https://static001.geekbang.org/account/avatar/00/27/a2/49/7e749be2.jpg","nickname":"Nick","note":"","ucode":"37E60C08183617","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":389245,"discussion_content":"所以说精华都在评论区！","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1629189976,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1919541,"avatar":"https://static001.geekbang.org/account/avatar/00/1d/4a/35/66caeed9.jpg","nickname":"完美坚持","note":"","ucode":"AE0261D8DDEF64","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":375897,"discussion_content":"理清楚mysql的知识脉络结构，学习一种思维模式：每一节专栏都有对应的思维导图，看完文字听完语音，掌握了知识要点后，可能忽略了知识之间的联系，思维导图可以很清晰地展现知识之间的联系\n\n这一段提醒我重视后面的思维导图，我原来都是直接略过思维导图的，你这么一说，我觉得确实这个思维导图是有作用的，他帮我能够建立一个更加体系化的。思维框架啊，更好的去记忆。形成自己的知识网络。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1621861504,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1588752,"avatar":"https://static001.geekbang.org/account/avatar/00/18/3e/10/6fbed067.jpg","nickname":"Eva","note":"","ucode":"562975BA95D762","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":5347,"discussion_content":"我觉得你的笔记很不错，点赞！","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1566198170,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":114845,"user_name":"mickey","can_delete":false,"product_type":"c1","uid":1051663,"ip_address":"","ucode":"8B490C2DDE4010","user_header":"https://static001.geekbang.org/account/avatar/00/10/0c/0f/93d1c8eb.jpg","comment_is_top":false,"comment_ctime":1563415697,"is_pvip":false,"replies":[{"id":"63686","content":"正确","user_name":"作者回复","user_name_real":"cy","uid":"1306094","ctime":1577528207,"ip_address":"","comment_id":114845,"utype":1}],"discussion_count":7,"race_medal":0,"score":"126117467281","product_id":100029501,"comment_content":"# 编写 SQL 查询语句，查询不同身高级别（对应 height_grades 表）对应的球员数量（对应 player 表）<br>SELECT h.height_level AS &#39;身高级别&#39;, COUNT(player_id) AS &#39;球员数量&#39;<br>FROM height_grades as h LEFT JOIN player as p ON height BETWEEN h.height_lowest AND h.height_highest <br>GROUP BY height_level;<br><br>身高级别    球员数量<br>---------------------------<br>A\t18<br>B\t14<br>C\t5<br>D\t0","like_count":29,"discussions":[{"author":{"id":1306094,"avatar":"https://static001.geekbang.org/account/avatar/00/13/ed/ee/c4779b67.jpg","nickname":"cy","note":"","ucode":"50D653399A31F6","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":458840,"discussion_content":"正确","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1577528207,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1001661,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/48/bd/6c7d4230.jpg","nickname":"Tony Du","note":"","ucode":"F5FCC400E615EA","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":384619,"discussion_content":"不用左外连接只用内连接可以吗？","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1626680654,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":2251534,"avatar":"https://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTLia4qBUs5bFs5tU3yVCcBapIcnVftM60nrJ73eu30YDMbDNvjhvnibct3pMYlj62G1c7nH8jSBaiaLw/132","nickname":"李文彬","note":"","ucode":"4CD326DC443028","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":351764,"discussion_content":"我一直禁锢在等值连接里，非等值连接不能一下子蹦出来，要多加练习","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1614430150,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1986708,"avatar":"http://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTKT9Tk01eiaQ9aAhszthzGm6lwruRWPXia1YYFozctrdRvKg0Usp8NbwuKBApwD0D6Fty2tib3RdtFJg/132","nickname":"欧阳洲","note":"","ucode":"94606A6315F2BA","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":298485,"discussion_content":"between是不是包含两个边界，\n那刚好在边界上的数据\n会不会被重复统计到呢？","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1597309566,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":1,"child_discussions":[{"author":{"id":1234919,"avatar":"","nickname":"奥佛铎","note":"","ucode":"A1D544E5F22B7F","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":1986708,"avatar":"http://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTKT9Tk01eiaQ9aAhszthzGm6lwruRWPXia1YYFozctrdRvKg0Usp8NbwuKBApwD0D6Fty2tib3RdtFJg/132","nickname":"欧阳洲","note":"","ucode":"94606A6315F2BA","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":298492,"discussion_content":"除非height_grade给的区间有重复，但是数据库里可以看到并没有","likes_number":1,"is_delete":false,"is_hidden":false,"ctime":1597311188,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":298485,"ip_address":""},"score":298492,"extra":""}]},{"author":{"id":1619995,"avatar":"","nickname":"TT","note":"","ucode":"967014787E919C","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":293602,"discussion_content":"请问给player取别名的意图是什么？","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1595595020,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":1,"child_discussions":[{"author":{"id":1051663,"avatar":"https://static001.geekbang.org/account/avatar/00/10/0c/0f/93d1c8eb.jpg","nickname":"mickey","note":"","ucode":"8B490C2DDE4010","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":1619995,"avatar":"","nickname":"TT","note":"","ucode":"967014787E919C","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":293874,"discussion_content":"强迫症+偷懒预备","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1595693533,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":293602,"ip_address":""},"score":293874,"extra":""}]}]},{"had_liked":true,"id":110485,"user_name":"lmingzhi","can_delete":false,"product_type":"c1","uid":1014489,"ip_address":"","ucode":"72DBAF4FD184AF","user_header":"https://static001.geekbang.org/account/avatar/00/0f/7a/d9/4feb4006.jpg","comment_is_top":false,"comment_ctime":1562287250,"is_pvip":false,"replies":[{"id":"40178","content":"对的 就是讲解下如果支持全外连接的数据库是怎样的结果。Oracle支持全外连接 FULL JOIN，而MySQL不支持，不过想要写全外连接的话，可以用 左外连接 UNION 右外连接，比如：<br>SELECT * FROM player LEFT JOIN team ON player.team_id = team.team_id<br>UNION<br>SELECT * FROM player RIGHT JOIN team ON player.team_id = team.team_id","user_name":"作者回复","user_name_real":"cy","uid":"1306094","ctime":1562292046,"ip_address":"","comment_id":110485,"utype":1}],"discussion_count":1,"race_medal":0,"score":"65986796690","product_id":100029501,"comment_content":"&quot;需要注意的是 MySQL 不支持全外连接，否则的话全外连接会返回左表和右表中的所有行。当表之间有匹配的行，会显示内连接的结果。当某行在另一个表中没有匹配时，那么会把另一个表中选择的列显示为空值。&quot;<br><br>请问一下，这里的否则，指的是支持全外连接的数据库吗？","like_count":15,"discussions":[{"author":{"id":1306094,"avatar":"https://static001.geekbang.org/account/avatar/00/13/ed/ee/c4779b67.jpg","nickname":"cy","note":"","ucode":"50D653399A31F6","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":456904,"discussion_content":"对的 就是讲解下如果支持全外连接的数据库是怎样的结果。Oracle支持全外连接 FULL JOIN，而MySQL不支持，不过想要写全外连接的话，可以用 左外连接 UNION 右外连接，比如：\nSELECT * FROM player LEFT JOIN team ON player.team_id = team.team_id\nUNION\nSELECT * FROM player RIGHT JOIN team ON player.team_id = team.team_id","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1562292046,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":110441,"user_name":"Geek_635558","can_delete":false,"product_type":"c1","uid":1576202,"ip_address":"","ucode":"E5E27CB38EF114","user_header":"http://thirdwx.qlogo.cn/mmopen/vi_32/DYAIOgq83epdVawX0B67QUvLhyBAF3criaeVIibGE4E6610KQPbrwZRianEnynlewdhib8JS8zpn8seMULzho6o9gw/132","comment_is_top":false,"comment_ctime":1562260763,"is_pvip":false,"replies":[{"id":"40136","content":"对的，我们需要先了解都有哪些写法，然后在正确性的基础上提升SQL优化的能力，这部分会在后面陆续讲到。<br>SQL优化有很多维度，最常用的考虑可以从两方面入手：如何建立有效的索引策略（包括主键），以及不要在WHERE的字段中做函数运算。<br>在此基础上，我们还会了解事务处理，锁的机制，不同RDBMS的特点和使用等等。","user_name":"作者回复","user_name_real":"cy","uid":"1306094","ctime":1562283362,"ip_address":"","comment_id":110441,"utype":1}],"discussion_count":1,"race_medal":0,"score":"61691802907","product_id":100029501,"comment_content":"结果相同可以有N种写法，其实很多时候更应该关注查询的效率如何。希望可以详解","like_count":14,"discussions":[{"author":{"id":1306094,"avatar":"https://static001.geekbang.org/account/avatar/00/13/ed/ee/c4779b67.jpg","nickname":"cy","note":"","ucode":"50D653399A31F6","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":456882,"discussion_content":"对的，我们需要先了解都有哪些写法，然后在正确性的基础上提升SQL优化的能力，这部分会在后面陆续讲到。\nSQL优化有很多维度，最常用的考虑可以从两方面入手：如何建立有效的索引策略（包括主键），以及不要在WHERE的字段中做函数运算。\n在此基础上，我们还会了解事务处理，锁的机制，不同RDBMS的特点和使用等等。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1562283362,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":129952,"user_name":"rike","can_delete":false,"product_type":"c1","uid":1583833,"ip_address":"","ucode":"920AAD0BD9245C","user_header":"http://thirdwx.qlogo.cn/mmopen/vi_32/E3XKbwTv6WTssolgqZjZCkiazHgl2IdBYfwVfAcB7Ff3krsIQeBIBFQLQE1Kw91LFbl3lic2EzgdfNiciaYDlJlELA/132","comment_is_top":false,"comment_ctime":1567336736,"is_pvip":false,"replies":[{"id":"63510","content":"JOIN 就是默认的 INNER JOIN，LEFT JOIN是左连接<br>左连接：以左表为主，关联上右表<br>内连接：左表和右表的交集","user_name":"作者回复","user_name_real":"cy","uid":"1306094","ctime":1577515602,"ip_address":"","comment_id":129952,"utype":1}],"discussion_count":2,"race_medal":0,"score":"35927075104","product_id":100029501,"comment_content":"我有一个疑问，在例子上写的很多sql连接查询时，只有join...on关键字，但是没有其他的，但是这种join...on和left join...on的区别是什么？","like_count":8,"discussions":[{"author":{"id":1306094,"avatar":"https://static001.geekbang.org/account/avatar/00/13/ed/ee/c4779b67.jpg","nickname":"cy","note":"","ucode":"50D653399A31F6","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":465731,"discussion_content":"JOIN 就是默认的 INNER JOIN，LEFT JOIN是左连接\n左连接：以左表为主，关联上右表\n内连接：左表和右表的交集","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1577515602,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":2962599,"avatar":"https://static001.geekbang.org/account/avatar/00/2d/34/a7/52c4ea60.jpg","nickname":"年少挽滑稽世无双","note":"","ucode":"793DCBDE25A07B","race_medal":0,"user_type":1,"is_pvip":true},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":586732,"discussion_content":"mark","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1662467157,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":"四川"},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":110468,"user_name":"一步","can_delete":false,"product_type":"c1","uid":1005391,"ip_address":"","ucode":"73CEA468CE70C3","user_header":"https://static001.geekbang.org/account/avatar/00/0f/57/4f/6fb51ff1.jpg","comment_is_top":false,"comment_ctime":1562284576,"is_pvip":true,"discussion_count":0,"race_medal":1,"score":"31627055648","product_id":100029501,"comment_content":"对于连接执行的顺序，有点不太确定，希望老师讲解下各种连接及相关的关键字 执行的顺序？","like_count":7},{"had_liked":false,"id":110613,"user_name":"夜路破晓","can_delete":false,"product_type":"c1","uid":1353577,"ip_address":"","ucode":"9B875F94B759B9","user_header":"http://thirdwx.qlogo.cn/mmopen/vi_32/3hZfficKPGCq2kjFBu9SgaMjibJTEl7iaW1ta6pZNyiaWP8XEsNpunlnsiaOtBpWTXfT5BvRP3qNByml6p9rtBvqewg/132","comment_is_top":false,"comment_ctime":1562302491,"is_pvip":false,"replies":[{"id":"63755","content":"加油~","user_name":"作者回复","user_name_real":"cy","uid":"1306094","ctime":1577531170,"ip_address":"","comment_id":110613,"utype":1}],"discussion_count":1,"race_medal":0,"score":"18742171675","product_id":100029501,"comment_content":"建议多表连接使用SQL99标准.好了本章结束,继续!","like_count":4,"discussions":[{"author":{"id":1306094,"avatar":"https://static001.geekbang.org/account/avatar/00/13/ed/ee/c4779b67.jpg","nickname":"cy","note":"","ucode":"50D653399A31F6","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":456967,"discussion_content":"加油~","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1577531170,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":111186,"user_name":"Oliver","can_delete":false,"product_type":"c1","uid":1520443,"ip_address":"","ucode":"BE14CA3742D063","user_header":"https://static001.geekbang.org/account/avatar/00/17/33/3b/60c30775.jpg","comment_is_top":false,"comment_ctime":1562502603,"is_pvip":false,"replies":[{"id":"40480","content":"SQL查询语句是面向集合的思维方式，你需要思考你想提取的数据是什么？不论是一对多，一对一，还是多对多的关系，关注的都应该是你想提取的数据是什么。<br>不过在建数据表的时候，你需要考虑到这些关系的特性，比如一张数据表是一对多的关系，可以将1端设置为主键，这样在查询的时候效率更高。<br>","user_name":"作者回复","user_name_real":"cy","uid":"1306094","ctime":1562540680,"ip_address":"","comment_id":111186,"utype":1}],"discussion_count":1,"race_medal":0,"score":"14447404491","product_id":100029501,"comment_content":"老师好，问个问题，在一对多的关系中，怎么写sql语句？初学者一枚","like_count":3,"discussions":[{"author":{"id":1306094,"avatar":"https://static001.geekbang.org/account/avatar/00/13/ed/ee/c4779b67.jpg","nickname":"cy","note":"","ucode":"50D653399A31F6","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":457272,"discussion_content":"SQL查询语句是面向集合的思维方式，你需要思考你想提取的数据是什么？不论是一对多，一对一，还是多对多的关系，关注的都应该是你想提取的数据是什么。\n不过在建数据表的时候，你需要考虑到这些关系的特性，比如一张数据表是一对多的关系，可以将1端设置为主键，这样在查询的时候效率更高。\n","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1562540680,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":110695,"user_name":"一叶知秋","can_delete":false,"product_type":"c1","uid":1445189,"ip_address":"","ucode":"15A95FA86B7AE4","user_header":"https://static001.geekbang.org/account/avatar/00/16/0d/45/b88a1794.jpg","comment_is_top":false,"comment_ctime":1562315835,"is_pvip":false,"discussion_count":2,"race_medal":0,"score":"10152250427","product_id":100029501,"comment_content":"SELECT g.height_level, count(*) <br>FROM height_grades as g, player as p <br>WHERE p.height <br>BETWEEN g.height_lowest AND g.height_highest <br>GROUP BY g.height_level;<br>执行结果：<br>+--------------+----------+<br>| height_level | count(*) |<br>+--------------+----------+<br>| A            |       18 |<br>| B            |       14 |<br>| C            |        5 |<br>+--------------+----------+<br>3 rows in set (0.01 sec)<br><br>一下午真正追完了~~~~","like_count":2,"discussions":[{"author":{"id":1542987,"avatar":"https://static001.geekbang.org/account/avatar/00/17/8b/4b/fa52d222.jpg","nickname":"行则将至","note":"","ucode":"DB972F2DF059C4","race_medal":1,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":112487,"discussion_content":"你没有D这种情况的height_level","likes_number":3,"is_delete":false,"is_hidden":false,"ctime":1577867579,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1445189,"avatar":"https://static001.geekbang.org/account/avatar/00/16/0d/45/b88a1794.jpg","nickname":"一叶知秋","note":"","ucode":"15A95FA86B7AE4","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":1091,"discussion_content":"啊。 表头忘记as了，不完美。 然后给自己点个赞 哈哈哈哈","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1562316924,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":110553,"user_name":"圆子蛋","can_delete":false,"product_type":"c1","uid":1585794,"ip_address":"","ucode":"9E8FE5D4DAC79E","user_header":"https://static001.geekbang.org/account/avatar/00/18/32/82/273a44cd.jpg","comment_is_top":false,"comment_ctime":1562293567,"is_pvip":false,"discussion_count":2,"race_medal":0,"score":"10152228159","product_id":100029501,"comment_content":"SELECT h.height_level,COUNT(*) AS num FROM height_grades AS h JOIN player AS p ON p.player_height BETWEEN h.height_lowest AND h.height_highest GROUP BY h.height_level ORDER BY h.height_level ASC","like_count":2,"discussions":[{"author":{"id":1024601,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/a2/59/4813ca43.jpg","nickname":"小二","note":"","ucode":"C68C600D03E9F1","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":256578,"discussion_content":"p.player_height => p.height","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1588498432,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1524154,"avatar":"https://static001.geekbang.org/account/avatar/00/17/41/ba/ae028565.jpg","nickname":"YqY","note":"","ucode":"73FB936045DCB9","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":203746,"discussion_content":"报错  Unknown column &#39;p.player_height&#39; in &#39;on clause&#39;","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1584075535,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":110531,"user_name":"柯察金","can_delete":false,"product_type":"c1","uid":1115149,"ip_address":"","ucode":"F722BF8FCD2C47","user_header":"https://static001.geekbang.org/account/avatar/00/11/04/0d/3dc5683a.jpg","comment_is_top":false,"comment_ctime":1562290634,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"10152225226","product_id":100029501,"comment_content":"把链接条件写在 join 里面跟写在 where 会有什么不同吗。老师能不能讲一下，工作的时候常常遇到，发现有时候筛选条件放的位置没有影响，有时候又是有两者差别又很大","like_count":2},{"had_liked":false,"id":287213,"user_name":"你的代码有灵魂吗？","can_delete":false,"product_type":"c1","uid":1688372,"ip_address":"","ucode":"0A276F30307965","user_header":"","comment_is_top":false,"comment_ctime":1617843248,"is_pvip":true,"discussion_count":0,"race_medal":0,"score":"5912810544","product_id":100029501,"comment_content":"“子查询实际上是通过未知表进行查询后的条件判断，而自连接是通过已知的自身数据表进行条件判断，因此在大部分 DBMS 中都对自连接处理进行了优化。” 这句听起来有点抽象难理解，老师能举个具体一点的例子吗？","like_count":1},{"had_liked":false,"id":224925,"user_name":"唐龙","can_delete":false,"product_type":"c1","uid":1471657,"ip_address":"","ucode":"87A10AE04F2037","user_header":"https://static001.geekbang.org/account/avatar/00/16/74/a9/5eb3ebc6.jpg","comment_is_top":false,"comment_ctime":1591594183,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"5886561479","product_id":100029501,"comment_content":"我现在才知道，我以前一直是混用92和99的","like_count":1},{"had_liked":false,"id":173781,"user_name":"爬行的蜗牛","can_delete":false,"product_type":"c1","uid":1033956,"ip_address":"","ucode":"6623B62DE63CE9","user_header":"http://thirdwx.qlogo.cn/mmopen/vi_32/QD6bf8hkS5dHrabdW7M7Oo9An1Oo3QSxqoySJMDh7GTraxFRX77VZ2HZ13x3R4EVYddIGXicRRDAc7V9z5cLDlA/132","comment_is_top":false,"comment_ctime":1579684669,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"5874651965","product_id":100029501,"comment_content":"mysql&gt; SELECT h.height_level AS &#39;身高等级&#39;, COUNT(player_id) as &#39;球员数量&#39;<br>    -&gt; FROM  height_grades as h LEFT JOIN  player ON height<br>    -&gt; BETWEEN h.height_lowest AND h.height_highest<br>    -&gt; GROUP BY  h.height_level;<br>+--------------+--------------+<br>| 身高等级     | 球员数量     |<br>+--------------+--------------+<br>| A            |           18 |<br>| B            |           14 |<br>| C            |            5 |<br>| D            |            0 |<br>+--------------+--------------+<br>4 rows in set (0.00 sec)<br>","like_count":1},{"had_liked":false,"id":110636,"user_name":"白了少年头","can_delete":false,"product_type":"c1","uid":1053084,"ip_address":"","ucode":"A65E00E05B23BA","user_header":"https://static001.geekbang.org/account/avatar/00/10/11/9c/4fd6ebe0.jpg","comment_is_top":false,"comment_ctime":1562308252,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"5857275548","product_id":100029501,"comment_content":"select height_level, count(player_name) as player_num from player as p left join height_grades as h on p.height between h.height_lowest and h.height_highest group by height_level;<br>+--------------+------------+<br>| height_level | player_num |<br>+--------------+------------+<br>| A            |         18 |<br>| B            |         14 |<br>| C            |          5 |<br>+--------------+------------+<br>3 rows in set (0.00 sec)","like_count":1},{"had_liked":false,"id":110618,"user_name":"郡鸿","can_delete":false,"product_type":"c1","uid":1241201,"ip_address":"","ucode":"7A6298D288E078","user_header":"https://static001.geekbang.org/account/avatar/00/12/f0/71/c7b0a1f8.jpg","comment_is_top":false,"comment_ctime":1562303039,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"5857270335","product_id":100029501,"comment_content":"select h.height_level,count(*) as num from player p join height_grades h on p.height between h.height_lowest and h.height_highest group by h.height_level;","like_count":1},{"had_liked":false,"id":357690,"user_name":"张兴","can_delete":false,"product_type":"c1","uid":3175551,"ip_address":"上海","ucode":"6BE80A3C026E36","user_header":"","comment_is_top":false,"comment_ctime":1663560950,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1663560950","product_id":100029501,"comment_content":"SELECT h.height_level AS &#39;身高级别&#39;, COUNT(p.player_id) AS &#39;数量&#39;<br>FROM height_grades h LEFT JOIN player p<br>ON height BETWEEN h.height_lowest AND h.height_highest<br>GROUP BY h.height_level<br><br>建议先写from, 完了on筛选，用等级划分，最后select","like_count":0},{"had_liked":false,"id":356645,"user_name":"年少挽滑稽世无双","can_delete":false,"product_type":"c1","uid":2962599,"ip_address":"四川","ucode":"793DCBDE25A07B","user_header":"https://static001.geekbang.org/account/avatar/00/2d/34/a7/52c4ea60.jpg","comment_is_top":false,"comment_ctime":1662467458,"is_pvip":true,"discussion_count":0,"race_medal":0,"score":"1662467458","product_id":100029501,"comment_content":"# 查询不同身高级别（对应 height_grades 表）对应的球员数量（对应 player 表）。<br>SELECT h.height_level,COUNT(player_id) num FROM height_grades h LEFT JOIN player p ON height BETWEEN h.height_lowest AND h.height_highest GROUP BY h.height_level ORDER BY num DESC","like_count":0},{"had_liked":false,"id":350118,"user_name":"唐龙","can_delete":false,"product_type":"c1","uid":1471657,"ip_address":"","ucode":"87A10AE04F2037","user_header":"https://static001.geekbang.org/account/avatar/00/16/74/a9/5eb3ebc6.jpg","comment_is_top":false,"comment_ctime":1656580717,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1656580717","product_id":100029501,"comment_content":"我在MariaDB中，使用了全外连接报错了：<br>```<br>MariaDB [geektime]&gt; SELECT * FROM player FULL JOIN team ON player.team_id = team.team_id;<br>ERROR 1054 (42S22): Unknown column &#39;player.team_id&#39; in &#39;on clause<br>```<br>但是换成下面的又可以了：<br>`SELECT * FROM player FULL JOIN team USING(team_id);`<br><br>这个时候它属于USING连接还是全连接。","like_count":0},{"had_liked":false,"id":317433,"user_name":"Geek_28670d","can_delete":false,"product_type":"c1","uid":2814926,"ip_address":"","ucode":"7BA10C23E56F1E","user_header":"","comment_is_top":false,"comment_ctime":1634796929,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1634796929","product_id":100029501,"comment_content":"这两章主要讲了SQL92和SQL99标准中连接查询的区别、主流数据库中连接需要注意的地方、连接性能三个方面。<br>一.SQL99支持全外连接，在92基础增加 join,Using语法，推荐使用可读性更高的SQL99标准<br>二.1.oracle不支持as,2.mysql不支持全外连接，3.sqlite外连接只有左外连接<br>","like_count":0},{"had_liked":false,"id":317103,"user_name":"Wry","can_delete":false,"product_type":"c1","uid":2740574,"ip_address":"","ucode":"D1B1F21907E067","user_header":"https://static001.geekbang.org/account/avatar/00/29/d1/5e/2b7e685a.jpg","comment_is_top":false,"comment_ctime":1634689090,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1634689090","product_id":100029501,"comment_content":"在工作中如何判断是使用innerjoin还是left join","like_count":0},{"had_liked":false,"id":314510,"user_name":"蝴蝶","can_delete":false,"product_type":"c1","uid":1193167,"ip_address":"","ucode":"8019924D99182F","user_header":"https://static001.geekbang.org/account/avatar/00/12/34/cf/0a316b48.jpg","comment_is_top":false,"comment_ctime":1633162867,"is_pvip":true,"discussion_count":1,"race_medal":0,"score":"1633162867","product_id":100029501,"comment_content":"SELECT count(player.height) as &#39;数量&#39;, height_level as &#39;级别&#39;<br>from player,<br>     height_grades<br>WHERE player.height between height_grades.height_lowest and height_grades.height_highest<br>GROUP BY height_grades.height_level;<br><br>奇怪的是 D 这个级别没有搜索出来","like_count":0,"discussions":[{"author":{"id":1448387,"avatar":"https://static001.geekbang.org/account/avatar/00/16/19/c3/23ed13f8.jpg","nickname":"兴奋","note":"","ucode":"9ADFE1E4EE936B","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":537574,"discussion_content":"默认是LEFT JOIN，左表没有对应的，要用RIGHT JOIN才能出来。","likes_number":1,"is_delete":false,"is_hidden":false,"ctime":1639106625,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":314080,"user_name":"Rebirth°","can_delete":false,"product_type":"c1","uid":2500861,"ip_address":"","ucode":"0EE239A83BC307","user_header":"https://static001.geekbang.org/account/avatar/00/26/28/fd/26435d41.jpg","comment_is_top":false,"comment_ctime":1632829145,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1632829145","product_id":100029501,"comment_content":"SELECT b.height_level AS 身高等级 , COUNT(player_id) AS 球员数量<br>FROM player AS a JOIN height_grades AS b <br>ON a.height BETWEEN height_lowest AND height_highest<br>GROUP BY b.height_level","like_count":0},{"had_liked":false,"id":305603,"user_name":"刘洪林","can_delete":false,"product_type":"c1","uid":1535242,"ip_address":"","ucode":"1FDBB425191CA8","user_header":"https://static001.geekbang.org/account/avatar/00/17/6d/0a/8e7f0f04.jpg","comment_is_top":false,"comment_ctime":1628067126,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1628067126","product_id":100029501,"comment_content":"SELECT height_level AS &#39;身高级别&#39;, COUNT(*) AS &#39;球员数量&#39; FROM height_grades AS a LEFT JOIN player ON player.height BETWEEN a.height_lowest AND a.height_highest GROUP BY a.height_level;<br>","like_count":0},{"had_liked":false,"id":305260,"user_name":"Mzdora","can_delete":false,"product_type":"c1","uid":1951931,"ip_address":"","ucode":"813C4EF68CD747","user_header":"https://static001.geekbang.org/account/avatar/00/1d/c8/bb/fd3cea97.jpg","comment_is_top":false,"comment_ctime":1627894253,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1627894253","product_id":100029501,"comment_content":"SELECT height_grades.height_level,COUNT(player_id) AS num FROM height_grades LEFT JOIN player ON player.height &gt; height_grades.height_lowest AND player.height &lt; height_grades.height_highest GROUP BY height_grades.height_level;","like_count":0},{"had_liked":false,"id":301693,"user_name":"Cy23","can_delete":false,"product_type":"c1","uid":1591293,"ip_address":"","ucode":"8DC561C5151758","user_header":"https://static001.geekbang.org/account/avatar/00/18/47/fd/895f0c27.jpg","comment_is_top":false,"comment_ctime":1625814531,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1625814531","product_id":100029501,"comment_content":"SELECT a.height_level AS &#39;身高级别&#39;, COUNT(b.player_id) AS &#39;球员数量&#39; <br>FROM height_grades AS a LEFT JOIN player AS b<br>ON b.height BETWEEN a.height_lowest AND a.height_highest<br>GROUP BY height_level;","like_count":0},{"had_liked":false,"id":292749,"user_name":"明","can_delete":false,"product_type":"c1","uid":1730839,"ip_address":"","ucode":"4289A963ABCF19","user_header":"https://static001.geekbang.org/account/avatar/00/1a/69/17/0eb06ceb.jpg","comment_is_top":false,"comment_ctime":1620960358,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1620960358","product_id":100029501,"comment_content":"mysql&gt; SELECT height_level AS &#39;身高等级&#39;, COUNT(player_id) AS &#39;数量&#39; FROM height_grades AS h  LEFT JOIN player AS p ON p.height BETWEEN h.height_lowest AND h.height_highest GROUP BY height_level;<br>+----------+------+<br>| 身高等级 | 数量 |<br>+----------+------+<br>| A        |   18 |<br>| B        |   14 |<br>| C        |    5 |<br>| D        |    0 |<br>+----------+------+","like_count":0},{"had_liked":false,"id":289571,"user_name":"@mj 🍭","can_delete":false,"product_type":"c1","uid":2048101,"ip_address":"","ucode":"ED1CEE8F2C3A64","user_header":"https://static001.geekbang.org/account/avatar/00/1f/40/65/49b923aa.jpg","comment_is_top":false,"comment_ctime":1619084614,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1619084614","product_id":100029501,"comment_content":"关于NATURAL JOIN的用法，自动查询两张连接表中所有相同的字段进行等值连接。<br>如果两张表中存在多个相同的字段，这里会有问题吗？<br>比如每张表都会有CREATE_TIME类似的字段。","like_count":0},{"had_liked":false,"id":278634,"user_name":"Believer(入陣)","can_delete":false,"product_type":"c1","uid":1127667,"ip_address":"","ucode":"A57EFA4E534019","user_header":"https://static001.geekbang.org/account/avatar/00/11/34/f3/465e90d0.jpg","comment_is_top":false,"comment_ctime":1613142228,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1613142228","product_id":100029501,"comment_content":"SELECT h.height_level, COUNT(p.player_name) AS player_num FROM height_grades AS h JOIN player AS p ON p.height BETWEEN h.height_lowest AND h.height_highest GROUP BY h.height_level ORDER BY h.height_level;","like_count":0},{"had_liked":false,"id":275709,"user_name":"皓昊","can_delete":false,"product_type":"c1","uid":2288986,"ip_address":"","ucode":"8CCCF3700DAC3E","user_header":"https://static001.geekbang.org/account/avatar/00/22/ed/5a/a7687583.jpg","comment_is_top":false,"comment_ctime":1611650675,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1611650675","product_id":100029501,"comment_content":"select hg.height_level ,count(p.player_id)<br>from player p<br>join height_grades as hg<br>where p.height between hg.height_lowest and hg.height_highest<br>group by hg.height_level ","like_count":0},{"had_liked":false,"id":274518,"user_name":"Flychen","can_delete":false,"product_type":"c1","uid":1880782,"ip_address":"","ucode":"4029A8F1D3C361","user_header":"https://static001.geekbang.org/account/avatar/00/1c/b2/ce/5638be2b.jpg","comment_is_top":false,"comment_ctime":1611045134,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1611045134","product_id":100029501,"comment_content":"<br> -- 编写 SQL 查询语句，查询不同身高级别（对应 height_grades 表）对应的球员数量（对应 player 表）<br><br><br>select h.height_level ,COUNT( p.player_name) from player p, height_grades h where p.height BETWEEN h.height_lowest and h.height_highest<br><br>GROUP BY h.height_level<br>","like_count":0},{"had_liked":false,"id":267071,"user_name":"Geek_de86a1","can_delete":false,"product_type":"c1","uid":2336319,"ip_address":"","ucode":"9839779336375C","user_header":"","comment_is_top":false,"comment_ctime":1607588428,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1607588428","product_id":100029501,"comment_content":"# 做一个小练习。请你编写 SQL 查询语句，查询不同身高级别（对应 height_grades 表）对应的球员数量（对应 player 表）。<br># 先尝试打印出player表中每个球员对应的不同身高的等级<br>SELECT<br>\tplayer_name,<br>\theight,<br>\theight_level <br>FROM<br>\tplayer<br>\tJOIN height_grades ON player.height BETWEEN height_grades.height_lowest AND height_grades.height_highest;<br><br># 加上分组求和聚集函数得到结果：<br>SELECT<br>\tCOUNT(*) AS &#39;数量&#39;,<br>\theight_level AS &#39;身高等级&#39; <br>FROM<br>\tplayer<br>\tJOIN height_grades ON player.height BETWEEN height_grades.height_lowest AND height_grades.height_highest <br>GROUP BY<br>\theight_level <br>ORDER BY<br>\theight_level;","like_count":0},{"had_liked":false,"id":253040,"user_name":"盛艳明","can_delete":false,"product_type":"c1","uid":1132347,"ip_address":"","ucode":"E4C1C699572C44","user_header":"https://static001.geekbang.org/account/avatar/00/11/47/3b/15e4490f.jpg","comment_is_top":false,"comment_ctime":1602575448,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1602575448","product_id":100029501,"comment_content":"SELECT height_level,count(height_level) FROM height_grades JOIN player WHERE player.height BETWEEN height_lowest AND height_highest GROUP BY height_level ;","like_count":0},{"had_liked":false,"id":242045,"user_name":"夏天呀","can_delete":false,"product_type":"c1","uid":1673679,"ip_address":"","ucode":"1C5C060C05923B","user_header":"https://static001.geekbang.org/account/avatar/00/19/89/cf/1c7703b1.jpg","comment_is_top":false,"comment_ctime":1597573409,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1597573409","product_id":100029501,"comment_content":"#小白成长路漫漫，今天也是为了数据分析师努力的一天~开始慢慢有了感觉......道阻且长，FIGHTING!<br><br>刚开始没有加上GROUP BY 分组，导致老是无法输出结果。<br><br>然后是输出的结果没有按照顺序，翻了下评论区作业，突然就更加理解了左连接，有种“原来如此”的感觉。<br><br>mysql&gt; SELECT h.height_level,COUNT(p.player_name) FROM height_grades as h LEFT JOIN player as p  ON p.height BETWEEN h.height_lowest AND h.height_highest<br>    -&gt; GROUP BY height_level;<br>+--------------+----------------------+<br>| height_level | COUNT(p.player_name) |<br>+--------------+----------------------+<br>| A            |                   18 |<br>| B            |                   14 |<br>| C            |                    5 |<br>| D            |                    0 |<br>+--------------+----------------------+<br>4 rows in set (0.00 sec)","like_count":0},{"had_liked":false,"id":239362,"user_name":"Geek_gong1zu","can_delete":false,"product_type":"c1","uid":2086659,"ip_address":"","ucode":"D629A6652AB8E2","user_header":"https://static001.geekbang.org/account/avatar/00/1f/d7/03/db060811.jpg","comment_is_top":false,"comment_ctime":1596511589,"is_pvip":true,"discussion_count":0,"race_medal":0,"score":"1596511589","product_id":100029501,"comment_content":"SELECT,h.height_level, COUNT(player_id）as num<br>FROM height_grades as h ,player as  p LEFT JOIN on height BETWEEN h.height_lowest AND h.height_highest<br>GROUP BY height_level;<br>","like_count":0},{"had_liked":false,"id":239088,"user_name":"pan","can_delete":false,"product_type":"c1","uid":1439228,"ip_address":"","ucode":"7C95D66C95E1BA","user_header":"http://thirdwx.qlogo.cn/mmopen/vi_32/1iaykDMsDvUbd13DxewFGibSExGyNyzmHK8cciam9EH9RRWbhfSgMDPIbGP5hfe9hX0uTEkybhmic3fdpYVHXmRpJg/132","comment_is_top":false,"comment_ctime":1596432224,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1596432224","product_id":100029501,"comment_content":"select height_level,count(*) num from player left join height_grades on player.height &lt; height_highest and player.height &gt; height_lowest group by height_level order by num;","like_count":0},{"had_liked":false,"id":232829,"user_name":"℡ㄨ和尚ふ","can_delete":false,"product_type":"c1","uid":2027690,"ip_address":"","ucode":"E26B2BC7D8E4FC","user_header":"https://static001.geekbang.org/account/avatar/00/1e/f0/aa/6ba4a1ab.jpg","comment_is_top":false,"comment_ctime":1594125628,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1594125628","product_id":100029501,"comment_content":"SELECT<br>\theight_level,<br>\tCOUNT(player_id)<br>FROM<br>\theight_grades<br>\tLEFT JOIN player <br>\tON player.height <br>\tBETWEEN height_lowest AND height_highest<br>GROUP BY<br>\theight_level","like_count":0},{"had_liked":false,"id":232529,"user_name":"👽","can_delete":false,"product_type":"c1","uid":1274117,"ip_address":"","ucode":"D313AF941B412D","user_header":"https://static001.geekbang.org/account/avatar/00/13/71/05/db554eba.jpg","comment_is_top":false,"comment_ctime":1594028385,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1594028385","product_id":100029501,"comment_content":"尽量不要嵌套过多的链接。<br>但是假设有某需求，需要查询10+以上的表，除了链接查询，是否还有更好的解决方式？<br>最近的工作中经常面临这样复杂的查询，我常用Left join连接查询。<br>有的同事，则选用了Sql子查询的方式来处理。SQL可读性，连接查询要强很多，比起无数嵌套的子查询。。。但是不知道是否有什么隐患。","like_count":0},{"had_liked":false,"id":230043,"user_name":"宁悦","can_delete":false,"product_type":"c1","uid":1901403,"ip_address":"","ucode":"68844C314FEEF8","user_header":"https://static001.geekbang.org/account/avatar/00/1d/03/5b/3cdbc9fa.jpg","comment_is_top":false,"comment_ctime":1593246808,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1593246808","product_id":100029501,"comment_content":"SELECT COUNT(h.height_level),h.height_level FROM player AS p,height_grades AS h WHERE p.height BETWEEN h.height_lowest AND h.height_highest GROUP BY height_level;","like_count":0},{"had_liked":false,"id":229694,"user_name":"Vincent","can_delete":false,"product_type":"c1","uid":2015982,"ip_address":"","ucode":"F2CDC708F30997","user_header":"http://thirdwx.qlogo.cn/mmopen/vi_32/DYAIOgq83ep8YUnk8Z9LAaLINgWWnt8HXu8ZlyD7vLpHrJaExGeZ5YyWIrI4SYcX3joOpibAWIyuqGibqVNwq8XQ/132","comment_is_top":false,"comment_ctime":1593100254,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1593100254","product_id":100029501,"comment_content":"SELECT height_level,COUNT(*) FROM player<br>join height_grades<br>on height between height_lowest and height_highest<br>group by height_level;","like_count":0},{"had_liked":false,"id":227368,"user_name":"海林Lin","can_delete":false,"product_type":"c1","uid":1917715,"ip_address":"","ucode":"26333AE3DFAF9D","user_header":"https://static001.geekbang.org/account/avatar/00/1d/43/13/649ccaa9.jpg","comment_is_top":false,"comment_ctime":1592364664,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1592364664","product_id":100029501,"comment_content":"# 查询不同身高级别对应的球员数量<br><br>SELECT h.height_level AS 身高级别, COUNT(P.player_id) AS 球员数量<br>FROM player AS p RIGHT JOIN height_grades AS h<br>ON p.height BETWEEN h.height_lowest AND h.height_highest<br>GROUP BY h.height_level<br>ORDER BY h.height_level;","like_count":0},{"had_liked":false,"id":225016,"user_name":"骑行的掌柜J","can_delete":false,"product_type":"c1","uid":1474214,"ip_address":"","ucode":"3163102651C653","user_header":"https://static001.geekbang.org/account/avatar/00/16/7e/a6/4e331ef4.jpg","comment_is_top":false,"comment_ctime":1591617702,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1591617702","product_id":100029501,"comment_content":"https:&#47;&#47;blog.csdn.net&#47;weixin_41013322&#47;article&#47;details&#47;106620217 <br>之前对老师这里SQL99的标准和SQL92的标准理解不是很深刻 今天做了一道力扣题后仔细思考才领悟到其中的差别 于是写了这篇博客希望也有助于各位的理解","like_count":0},{"had_liked":false,"id":224351,"user_name":"Fan","can_delete":false,"product_type":"c1","uid":1168774,"ip_address":"","ucode":"9A5B148A7E453A","user_header":"https://static001.geekbang.org/account/avatar/00/11/d5/86/5b1ff7d9.jpg","comment_is_top":false,"comment_ctime":1591351194,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1591351194","product_id":100029501,"comment_content":"#请你编写 SQL 查询语句，查询不同身高级别（对应 height_grades 表）对应的球员数量（对应 player 表）<br>SELECT h.height_level AS &quot;身高等级&quot;, COUNT(p.player_id) AS &quot;人数&quot; <br>FROM height_grades AS h LEFT JOIN player AS p ON p.height BETWEEN h.height_lowest AND h.height_highest<br>GROUP BY h.height_level;","like_count":0},{"had_liked":false,"id":221503,"user_name":"跨域刀","can_delete":false,"product_type":"c1","uid":1914002,"ip_address":"","ucode":"236752722BA026","user_header":"http://thirdwx.qlogo.cn/mmopen/vi_32/jlNyhkIrVagxxnLT3Znm0Rwia2CiapODiaibJ1LGjicbV6QqRFfb3vTI4G58nKNNg9PACBAz52jKhzZhs3Kbj9sZ45g/132","comment_is_top":false,"comment_ctime":1590510299,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1590510299","product_id":100029501,"comment_content":"个人理解有两种方法：<br>1、92方法：<br>SELECT  COUNT(1),k.height_level FROM <br>(SELECT t.player_id,p.height_level FROM PLAYER t,HEIGHT_GRADES p WHERE t.height BETWEEN p.height_lowest AND p.height_highest) k <br>GROUP BY <br>k.height_level;<br>2、99方法：<br>SELECT COUNT(1),h.height_level FROM player p<br>JOIN<br>height_grades h <br>ON p.height BETWEEN h.height_lowest AND h.height_highest <br>GROUP BY <br>h.height_level;","like_count":0},{"had_liked":false,"id":207717,"user_name":"Joker","can_delete":false,"product_type":"c1","uid":1156592,"ip_address":"","ucode":"126AF848001A1E","user_header":"https://static001.geekbang.org/account/avatar/00/11/a5/f0/8648c464.jpg","comment_is_top":false,"comment_ctime":1587164302,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1587164302","product_id":100029501,"comment_content":"<br>SELECT count(*) nums, g.height_level<br>FROM player p JOIN height_grades g <br>\t\ton (p.height BETWEEN g.height_lowest AND g.height_highest)<br>GROUP BY g.height_level<br><br>","like_count":0},{"had_liked":false,"id":201119,"user_name":"彭纪程","can_delete":false,"product_type":"c1","uid":1682468,"ip_address":"","ucode":"F9222D72E791C8","user_header":"https://static001.geekbang.org/account/avatar/00/19/ac/24/0684a141.jpg","comment_is_top":false,"comment_ctime":1585719820,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1585719820","product_id":100029501,"comment_content":"SELECT COUNT(*) AS height FROM player AS a JOIN height_grades AS b <br>ON a.height BETWEEN b.height_lowest AND b.height_highest GROUP BY height_level;","like_count":0},{"had_liked":false,"id":197966,"user_name":"zipppp","can_delete":false,"product_type":"c1","uid":1406395,"ip_address":"","ucode":"72F14F7ACFDEAD","user_header":"https://static001.geekbang.org/account/avatar/00/15/75/bb/9f4f807f.jpg","comment_is_top":false,"comment_ctime":1585405442,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1585405442","product_id":100029501,"comment_content":"select a.height_level, count(b.player_id)<br>from height_grades as a<br>       left join player as b on b.height between a.height_lowest and a.height_highest<br>group by a.height_level;","like_count":0},{"had_liked":false,"id":195692,"user_name":"江边一支笔","can_delete":false,"product_type":"c1","uid":1712413,"ip_address":"","ucode":"BB3DCA1678B0C7","user_header":"https://static001.geekbang.org/account/avatar/00/1a/21/1d/59ab61b1.jpg","comment_is_top":false,"comment_ctime":1585212227,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1585212227","product_id":100029501,"comment_content":"SELECT h.height_level AS 身高级别, count(p.player_id) AS 球员数量     <br>FROM height_grades AS h LEFT JOIN player AS p <br>ON p.height BETWEEN h.height_lowest AND h.height_highest<br>GROUP BY height_level","like_count":0},{"had_liked":false,"id":194736,"user_name":"track6688","can_delete":false,"product_type":"c1","uid":1088040,"ip_address":"","ucode":"0A9E893F8FD379","user_header":"https://static001.geekbang.org/account/avatar/00/10/9a/28/03613c22.jpg","comment_is_top":false,"comment_ctime":1585100818,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1585100818","product_id":100029501,"comment_content":"不知道是不是我太年轻的原因，我从学习到现在，没有学过SQL92标准，就算遇到SQL92标准的写法，我也觉得SQL支持这种写法。看完文章后，原来如此。不过，我还是喜欢SQL92的风格，清晰明了。<br>作业：<br>SELECT<br>\thg.height_level,<br>\tCOUNT(p.player_id) AS playerCount<br>FROM<br>\theight_grades hg<br>JOIN player p ON<br>\tp.height BETWEEN hg.height_lowest AND hg.height_highest<br>GROUP BY<br>\thg.height_level;","like_count":0},{"had_liked":false,"id":194484,"user_name":"小风","can_delete":false,"product_type":"c1","uid":1144353,"ip_address":"","ucode":"89E593EA464D2B","user_header":"https://static001.geekbang.org/account/avatar/00/11/76/21/a8345640.jpg","comment_is_top":false,"comment_ctime":1585061880,"is_pvip":true,"discussion_count":0,"race_medal":1,"score":"1585061880","product_id":100029501,"comment_content":"SELECT <br>h.height_level,<br>count(p.player_id) AS count<br>FROM height_grades AS h<br>LEFT JOIN player AS p ON h.height_lowest &lt;= p.height AND h.height_highest &gt;= p.height <br>GROUP BY h.height_level","like_count":0},{"had_liked":false,"id":183396,"user_name":"grey927","can_delete":false,"product_type":"c1","uid":1202782,"ip_address":"","ucode":"833E02ED835B4A","user_header":"https://static001.geekbang.org/account/avatar/00/12/5a/5e/a897cb0d.jpg","comment_is_top":false,"comment_ctime":1583032726,"is_pvip":false,"discussion_count":1,"race_medal":0,"score":"1583032726","product_id":100029501,"comment_content":"实际上，在 SQL99 中用 NATURAL JOIN 替代了 WHERE player.team_id = team.team_id。<br>&gt; 陈老师，这里我有一个问题，用NATURAL JOIN是不是意味着会找两个表字段名称一样的做连接？如果有两个字段名称一样的呢？","like_count":0,"discussions":[{"author":{"id":1075072,"avatar":"https://static001.geekbang.org/account/avatar/00/10/67/80/4e52c16f.jpg","nickname":"演","note":"","ucode":"8685926BDA0A66","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":215096,"discussion_content":"并不是找名字一样，而是选择你在where中需要进行 = 关联的字段进行，比如team表中并不是team_id而是 teamid，或者tid，","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1585283794,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":181719,"user_name":"尔冬橙","can_delete":false,"product_type":"c1","uid":1225224,"ip_address":"","ucode":"0B013A49BC18DA","user_header":"https://static001.geekbang.org/account/avatar/00/12/b2/08/92f42622.jpg","comment_is_top":false,"comment_ctime":1582624130,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1582624130","product_id":100029501,"comment_content":"join 的话，对于sql92和99都可以省略么","like_count":0},{"had_liked":false,"id":172254,"user_name":"，","can_delete":false,"product_type":"c1","uid":1177230,"ip_address":"","ucode":"6D07D6DB27DC95","user_header":"https://static001.geekbang.org/account/avatar/00/11/f6/8e/a42d1aef.jpg","comment_is_top":false,"comment_ctime":1579141239,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1579141239","product_id":100029501,"comment_content":"老师，请问 SQL 标准规范是由什么组织机构负责维护和更新的呢？网上没有找到相对权威的“官网”和 SQL 标准规范的资料（某些网站上的 SQL 标准需要积分才能下载 -_-）。老师能否分享下 SQL92&#47;SQL99 的标准文档或“官方”链接？ ","like_count":0},{"had_liked":false,"id":167580,"user_name":"行则将至","can_delete":false,"product_type":"c1","uid":1542987,"ip_address":"","ucode":"DB972F2DF059C4","user_header":"https://static001.geekbang.org/account/avatar/00/17/8b/4b/fa52d222.jpg","comment_is_top":false,"comment_ctime":1577867994,"is_pvip":false,"discussion_count":0,"race_medal":1,"score":"1577867994","product_id":100029501,"comment_content":"老师，评论上能不能加一个编号。因为评论是懒加载的。有的时候因为网络不好，会导致已经拖不动了，但实际上，评论并没有看完。目前，在屏幕的右上角已经统计了当前文章所有的评论数量，再对比一下当前的评论编号，就知道是不是翻到底了。以免错过好的评论","like_count":0},{"had_liked":false,"id":156277,"user_name":"Krison","can_delete":false,"product_type":"c1","uid":1481198,"ip_address":"","ucode":"F2800118EEF3C9","user_header":"https://static001.geekbang.org/account/avatar/00/16/99/ee/5204b281.jpg","comment_is_top":false,"comment_ctime":1574847751,"is_pvip":false,"replies":[{"id":"62617","content":"加油Krison，SQL写的不错","user_name":"作者回复","user_name_real":"cy","uid":"1306094","ctime":1577077962,"ip_address":"","comment_id":156277,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1574847751","product_id":100029501,"comment_content":"我SQL很差，之前订了课程一直没时间学。今天捡起来。这个sql想了很久，总算是想出来了。加油!<br>SELECT<br>\tCONCAT( &#39;身高级别&#39;, &#39; - &#39;, b.height_level ),<br>\tCONCAT( &#39;球员数量&#39;, &#39; - &#39;, count( b.height_level ) ) <br>FROM<br>\t`player` AS a<br>\tLEFT JOIN height_grades AS b ON a.height BETWEEN b.height_lowest <br>\tAND b.height_highest <br>GROUP BY<br>\tb.height_level;<br>------结果如下------------<br>身高级别 - A\t球员数量 - 18<br>身高级别 - B\t球员数量 - 14<br>身高级别 - C\t球员数量 - 5","like_count":0,"discussions":[{"author":{"id":1306094,"avatar":"https://static001.geekbang.org/account/avatar/00/13/ed/ee/c4779b67.jpg","nickname":"cy","note":"","ucode":"50D653399A31F6","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":476055,"discussion_content":"加油Krison，SQL写的不错","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1577077962,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":155531,"user_name":"爬行的蜗牛","can_delete":false,"product_type":"c1","uid":1033956,"ip_address":"","ucode":"6623B62DE63CE9","user_header":"http://thirdwx.qlogo.cn/mmopen/vi_32/QD6bf8hkS5dHrabdW7M7Oo9An1Oo3QSxqoySJMDh7GTraxFRX77VZ2HZ13x3R4EVYddIGXicRRDAc7V9z5cLDlA/132","comment_is_top":false,"comment_ctime":1574695896,"is_pvip":false,"replies":[{"id":"62619","content":"正确","user_name":"作者回复","user_name_real":"cy","uid":"1306094","ctime":1577078042,"ip_address":"","comment_id":155531,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1574695896","product_id":100029501,"comment_content":"SELECT COUNT(*), h.height_level<br>   FROM player as p JOIN height_grades as h<br>   ON p.height BETWEEN h.height_lowest AND h.height_highest<br>   GROUP BY h.height_level;","like_count":0,"discussions":[{"author":{"id":1306094,"avatar":"https://static001.geekbang.org/account/avatar/00/13/ed/ee/c4779b67.jpg","nickname":"cy","note":"","ucode":"50D653399A31F6","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":475786,"discussion_content":"正确","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1577078042,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":149985,"user_name":"Victor.","can_delete":false,"product_type":"c1","uid":1274680,"ip_address":"","ucode":"E841D981ABEE09","user_header":"https://static001.geekbang.org/account/avatar/00/13/73/38/7ef1bd5d.jpg","comment_is_top":false,"comment_ctime":1573441391,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1573441391","product_id":100029501,"comment_content":"SELECT DISTINCT h.height_level,count(*) AS num FROM player AS p LEFT JOIN height_grades AS h ON height BETWEEN h.height_lowest AND h.height_highest GROUP BY h.height_level<br>","like_count":0},{"had_liked":false,"id":144062,"user_name":"半瓶醋","can_delete":false,"product_type":"c1","uid":1282746,"ip_address":"","ucode":"8C898E244D0417","user_header":"https://static001.geekbang.org/account/avatar/00/13/92/ba/9833f06f.jpg","comment_is_top":false,"comment_ctime":1571836615,"is_pvip":true,"replies":[{"id":"62697","content":"正确","user_name":"作者回复","user_name_real":"cy","uid":"1306094","ctime":1577084834,"ip_address":"","comment_id":144062,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1571836615","product_id":100029501,"comment_content":"# 查询不同身高级别对应的球员数量<br>SELECT<br>    h.height_level,<br>    COUNT(*) AS &#39;球员数量&#39;<br>FROM player AS p <br>JOIN height_grades AS h <br>ON height BETWEEN h.height_lowest AND h.height_highest<br>GROUP BY h.height_level","like_count":0,"discussions":[{"author":{"id":1306094,"avatar":"https://static001.geekbang.org/account/avatar/00/13/ed/ee/c4779b67.jpg","nickname":"cy","note":"","ucode":"50D653399A31F6","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":471801,"discussion_content":"正确","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1577084834,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":143174,"user_name":"Coool","can_delete":false,"product_type":"c1","uid":1701702,"ip_address":"","ucode":"1D1AB3270B02B9","user_header":"https://static001.geekbang.org/account/avatar/00/19/f7/46/209ca424.jpg","comment_is_top":false,"comment_ctime":1571642816,"is_pvip":false,"replies":[{"id":"62777","content":"正确","user_name":"作者回复","user_name_real":"cy","uid":"1306094","ctime":1577091063,"ip_address":"","comment_id":143174,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1571642816","product_id":100029501,"comment_content":"练习：<br>SELECT <br>    h.height_level, COUNT(*) AS player_num<br>FROM<br>    player AS p<br>        LEFT JOIN<br>    height_grades AS h ON p.height BETWEEN h.height_lowest AND h.height_highest<br>GROUP BY h.height_level;","like_count":0,"discussions":[{"author":{"id":1306094,"avatar":"https://static001.geekbang.org/account/avatar/00/13/ed/ee/c4779b67.jpg","nickname":"cy","note":"","ucode":"50D653399A31F6","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":471408,"discussion_content":"正确","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1577091063,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":141819,"user_name":"爱思考的仙人球","can_delete":false,"product_type":"c1","uid":1576177,"ip_address":"","ucode":"77E31190A5B5AF","user_header":"https://thirdwx.qlogo.cn/mmopen/vi_32/ic8KF0sfxicsx4F25HZrtZwP2fQEibicfibFeYIQBibxnVlHIiaqkfictJuvLCKia0p7liaQvbTzCYWLibjJK6B8kc8e194ng/132","comment_is_top":false,"comment_ctime":1571230962,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1571230962","product_id":100029501,"comment_content":"我记得还有一个inner join 内连接，和问中的ON 连接很像","like_count":0},{"had_liked":false,"id":133635,"user_name":"chenysh38","can_delete":false,"product_type":"c1","uid":1583394,"ip_address":"","ucode":"149758B919B0C2","user_header":"https://thirdwx.qlogo.cn/mmopen/vi_32/NFpgmsqvyPs8ibTrrrJ24OqoISOVW2aaYESotwl5r5PqhyLuECj6gvJN9SibECg142eyW5S9mebZGdyGzMWS1VtQ/132","comment_is_top":false,"comment_ctime":1568625243,"is_pvip":false,"replies":[{"id":"63498","content":"Good Job","user_name":"作者回复","user_name_real":"cy","uid":"1306094","ctime":1577514732,"ip_address":"","comment_id":133635,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1568625243","product_id":100029501,"comment_content":"mysql&gt; select count(*), height_level<br>    -&gt; from player as p, height_grades as h<br>    -&gt; where p.height between h.height_lowest and h.height_highest<br>    -&gt; group by height_level<br>    -&gt; order by height_level;<br>+----------+--------------+<br>| count(*) | height_level |<br>+----------+--------------+<br>|       18 | A            |<br>|       14 | B            |<br>|        5 | C            |<br>+----------+--------------+<br>3 rows in set (0.13 sec)","like_count":0,"discussions":[{"author":{"id":1306094,"avatar":"https://static001.geekbang.org/account/avatar/00/13/ed/ee/c4779b67.jpg","nickname":"cy","note":"","ucode":"50D653399A31F6","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":467457,"discussion_content":"Good Job","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1577514732,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":131824,"user_name":"森鱼","can_delete":false,"product_type":"c1","uid":1638587,"ip_address":"","ucode":"6AF86EB05088F4","user_header":"https://static001.geekbang.org/account/avatar/00/19/00/bb/25a29311.jpg","comment_is_top":false,"comment_ctime":1567921984,"is_pvip":false,"replies":[{"id":"62788","content":"SELECT h.height_level AS &#39;身高级别&#39;, COUNT(p.player_id) AS &#39;球员数量&#39; FROM height_grades AS h <br>LEFT JOIN player AS p ON p.height BETWEEN h.height_lowest AND h.height_highest GROUP BY h.height_level","user_name":"作者回复","user_name_real":"cy","uid":"1306094","ctime":1577092615,"ip_address":"","comment_id":131824,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1567921984","product_id":100029501,"comment_content":"SELECT h.height AS &#39;身高级别&#39;, COUNT(p.player_id) AS ‘球员数量’ FROM height_grades AS h LEFT JOIN player AS p ON p.height BETWEEN h.height_lowest AND h.height_highest GROUP BY h.height_level","like_count":0,"discussions":[{"author":{"id":1306094,"avatar":"https://static001.geekbang.org/account/avatar/00/13/ed/ee/c4779b67.jpg","nickname":"cy","note":"","ucode":"50D653399A31F6","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":466634,"discussion_content":"SELECT h.height_level AS &amp;#39;身高级别&amp;#39;, COUNT(p.player_id) AS &amp;#39;球员数量&amp;#39; FROM height_grades AS h \nLEFT JOIN player AS p ON p.height BETWEEN h.height_lowest AND h.height_highest GROUP BY h.height_level","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1577092615,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":131034,"user_name":"峻铭","can_delete":false,"product_type":"c1","uid":1106202,"ip_address":"","ucode":"63AB23BADACA88","user_header":"https://static001.geekbang.org/account/avatar/00/10/e1/1a/20977779.jpg","comment_is_top":false,"comment_ctime":1567605824,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1567605824","product_id":100029501,"comment_content":"select count(a.player_id),b.height_level from player as a right JOIN height_grades as b on a.height between b.height_lowest and b.height_highest group by b.height_level;","like_count":0},{"had_liked":false,"id":127458,"user_name":"星光","can_delete":false,"product_type":"c1","uid":1272719,"ip_address":"","ucode":"A62AB938CA622A","user_header":"https://static001.geekbang.org/account/avatar/00/13/6b/8f/eba34b86.jpg","comment_is_top":false,"comment_ctime":1566722370,"is_pvip":false,"replies":[{"id":"62753","content":"最简单的三表连接方式，SELECT * FROM player, player_score, team<br>一般尽量避免过多表连接","user_name":"作者回复","user_name_real":"cy","uid":"1306094","ctime":1577089323,"ip_address":"","comment_id":127458,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1566722370","product_id":100029501,"comment_content":"三个及三个以上的表连接，没有demo吗","like_count":0,"discussions":[{"author":{"id":1306094,"avatar":"https://static001.geekbang.org/account/avatar/00/13/ed/ee/c4779b67.jpg","nickname":"cy","note":"","ucode":"50D653399A31F6","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":464502,"discussion_content":"最简单的三表连接方式，SELECT * FROM player, player_score, team\n一般尽量避免过多表连接","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1577089323,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":121312,"user_name":"未来的胡先森","can_delete":false,"product_type":"c1","uid":1234682,"ip_address":"","ucode":"AFF193AC0E2E6C","user_header":"https://static001.geekbang.org/account/avatar/00/12/d6/fa/1f5bf642.jpg","comment_is_top":false,"comment_ctime":1565097626,"is_pvip":false,"replies":[{"id":"63575","content":"Good Job","user_name":"作者回复","user_name_real":"cy","uid":"1306094","ctime":1577518872,"ip_address":"","comment_id":121312,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1565097626","product_id":100029501,"comment_content":"补上作业<br>select height_level as &#39;身高级别&#39;,count( p.`player_id`) as &#39;球员数量&#39;<br>from height_grades h<br>left join player p on p.`height` between h.`height_lowest` and h.`height_highest`<br>group by h.`height_level`;","like_count":0,"discussions":[{"author":{"id":1306094,"avatar":"https://static001.geekbang.org/account/avatar/00/13/ed/ee/c4779b67.jpg","nickname":"cy","note":"","ucode":"50D653399A31F6","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":461735,"discussion_content":"Good Job","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1577518872,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":121167,"user_name":"Reiser","can_delete":false,"product_type":"c1","uid":1078669,"ip_address":"","ucode":"E5DBBBA2F86FCE","user_header":"https://static001.geekbang.org/account/avatar/00/10/75/8d/c6a2a048.jpg","comment_is_top":false,"comment_ctime":1565069569,"is_pvip":true,"discussion_count":0,"race_medal":0,"score":"1565069569","product_id":100029501,"comment_content":"SELECT  COUNT(h.height_level) as count, h.height_level<br>FROM player as p  JOIN height_grades as h<br>ON height BETWEEN h.height_lowest AND h.height_highest GROUP BY h.height_level ORDER BY count DESC;","like_count":0},{"had_liked":false,"id":118992,"user_name":"脸红因为风太烫","can_delete":false,"product_type":"c1","uid":1439542,"ip_address":"","ucode":"ABF7DA0CE126B0","user_header":"https://static001.geekbang.org/account/avatar/00/15/f7/36/7a6a6b6e.jpg","comment_is_top":false,"comment_ctime":1564481092,"is_pvip":false,"replies":[{"id":"63604","content":"Good Job","user_name":"作者回复","user_name_real":"cy","uid":"1306094","ctime":1577520739,"ip_address":"","comment_id":118992,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1564481092","product_id":100029501,"comment_content":"SELECT COUNT(*) AS &#39;人数&#39;, h.height_level<br>FROM height_grades AS h, player AS a<br>WHERE a.height BETWEEN h.height_lowest AND h.height_highest<br>GROUP BY h.height_level","like_count":0,"discussions":[{"author":{"id":1306094,"avatar":"https://static001.geekbang.org/account/avatar/00/13/ed/ee/c4779b67.jpg","nickname":"cy","note":"","ucode":"50D653399A31F6","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":460701,"discussion_content":"Good Job","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1577520739,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":116722,"user_name":"xy","can_delete":false,"product_type":"c1","uid":1432681,"ip_address":"","ucode":"3A4D0B7AB0FAF9","user_header":"http://thirdwx.qlogo.cn/mmopen/vi_32/OrfXQWvE0jIuibibw0dnicPM0iaRPXyyGTPicFfmvykUNiaVT7E8PQeqhzct4HhtdnSZvZdPzHmknIv56icPtYOD6Fibsw/132","comment_is_top":false,"comment_ctime":1563895339,"is_pvip":false,"replies":[{"id":"63638","content":"在MySQL Client端实验即可","user_name":"作者回复","user_name_real":"cy","uid":"1306094","ctime":1577525916,"ip_address":"","comment_id":116722,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1563895339","product_id":100029501,"comment_content":"课程里面的例子，怎么在单机版上实验？能不能讲下？","like_count":0,"discussions":[{"author":{"id":1306094,"avatar":"https://static001.geekbang.org/account/avatar/00/13/ed/ee/c4779b67.jpg","nickname":"cy","note":"","ucode":"50D653399A31F6","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":459659,"discussion_content":"在MySQL Client端实验即可","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1577525916,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":116626,"user_name":"18923814485","can_delete":false,"product_type":"c1","uid":1367070,"ip_address":"","ucode":"12C6A79B360EB5","user_header":"","comment_is_top":false,"comment_ctime":1563883176,"is_pvip":false,"replies":[{"id":"63641","content":"count(1)会统计NULL值","user_name":"作者回复","user_name_real":"cy","uid":"1306094","ctime":1577526245,"ip_address":"","comment_id":116626,"utype":1}],"discussion_count":2,"race_medal":0,"score":"1563883176","product_id":100029501,"comment_content":"请问下，为什么这个不对，会多出一条数据来？？<br>SELECT h.height_level, count(1) num from height_grades h<br>\tLEFT JOIN player p  ON p.height BETWEEN h.height_lowest and h.height_highest<br>\tGROUP BY h.height_level ORDER BY height_level ;","like_count":0,"discussions":[{"author":{"id":1306094,"avatar":"https://static001.geekbang.org/account/avatar/00/13/ed/ee/c4779b67.jpg","nickname":"cy","note":"","ucode":"50D653399A31F6","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":459619,"discussion_content":"count(1)会统计NULL值","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1577526245,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1585660,"avatar":"","nickname":"Geek_02c443","note":"","ucode":"A718936C6AF617","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":2824,"discussion_content":"因为使用了LEFT JOIN ，身高级别D虽然没有符合ON条件的球员，还是会生成一条数据，不过球员数据为空罢了，使用count(1)统计会包括NULL值。可以把count(1)修改为count(p.player_name)，这样会去除NULL值统计。或者不使用LEFT JOIN ON，使用CROSS JOIN WHERE，这样可以筛除身高级别D对应的空数据，就可以使用count(1)统计了。我自己开始也写错了，看到你的留言才发现检索结果有问题 :)","likes_number":4,"is_delete":false,"is_hidden":false,"ctime":1563957822,"is_liked":true,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":114836,"user_name":"mickey","can_delete":false,"product_type":"c1","uid":1051663,"ip_address":"","ucode":"8B490C2DDE4010","user_header":"https://static001.geekbang.org/account/avatar/00/10/0c/0f/93d1c8eb.jpg","comment_is_top":false,"comment_ctime":1563414669,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1563414669","product_id":100029501,"comment_content":"# 编写 SQL 查询语句，查询不同身高级别（对应 height_grades 表）对应的球员数量（对应 player 表）<br>SELECT h.height_level AS &#39;身高级别&#39;, COUNT(*) AS &#39;球员数量&#39;<br>FROM player as p JOIN height_grades as h ON height BETWEEN h.height_lowest AND h.height_highest <br>GROUP BY height_level;<br><br>身高级别    球员数量<br>----------------<br>A\t18<br>B\t14<br>C\t5","like_count":0},{"had_liked":false,"id":114591,"user_name":"蓝影闪电","can_delete":false,"product_type":"c1","uid":1276629,"ip_address":"","ucode":"0B7A42D79558E7","user_header":"https://static001.geekbang.org/account/avatar/00/13/7a/d5/dbcaadf0.jpg","comment_is_top":false,"comment_ctime":1563346583,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1563346583","product_id":100029501,"comment_content":"SELECT height_level 身高级别,count(1) 球员数量 FROM height_grades a<br>INNER JOIN player b<br>WHERE b.height&lt;a.height_highest and b.height&gt;height_lowest<br>GROUP BY height_level<br>ORDER BY height_level","like_count":0},{"had_liked":false,"id":113868,"user_name":"假装自己不胖","can_delete":false,"product_type":"c1","uid":1412994,"ip_address":"","ucode":"308F1BAA96CDA5","user_header":"https://static001.geekbang.org/account/avatar/00/15/8f/82/374f43a1.jpg","comment_is_top":false,"comment_ctime":1563175789,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1563175789","product_id":100029501,"comment_content":"select a.等级,count(b.id) from height_grades a join player b on a.id = b.height_id","like_count":0},{"had_liked":false,"id":112879,"user_name":"Geek_70747e","can_delete":false,"product_type":"c1","uid":1309814,"ip_address":"","ucode":"A832E20E951A00","user_header":"http://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTKdzXiawss5gGmlPicx9IiblxOTf4oSW16MWd696fue60zDA9NJTrGWenuLxS0COZZSzekV8QZGicyJOQ/132","comment_is_top":false,"comment_ctime":1562836707,"is_pvip":true,"discussion_count":0,"race_medal":0,"score":"1562836707","product_id":100029501,"comment_content":"SELECT<br>b.height_level,<br>\tcount(*) as num<br>FROM<br>\tplayer as a<br>LEFT JOIN height_grades as b ON a.height BETWEEN b.height_lowest<br>AND b.height_highest<br>GROUP BY<br>\tb.height_level","like_count":0},{"had_liked":false,"id":112597,"user_name":"linus","can_delete":false,"product_type":"c1","uid":1246600,"ip_address":"","ucode":"910606671D1706","user_header":"https://static001.geekbang.org/account/avatar/00/13/05/88/0a1f1b1d.jpg","comment_is_top":false,"comment_ctime":1562768531,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1562768531","product_id":100029501,"comment_content":"sql中的谓词下推中，where好像在join on 之前执行吧","like_count":0},{"had_liked":false,"id":112522,"user_name":"2525","can_delete":false,"product_type":"c1","uid":1180247,"ip_address":"","ucode":"2426488C258203","user_header":"https://static001.geekbang.org/account/avatar/00/12/02/57/9b235866.jpg","comment_is_top":false,"comment_ctime":1562750899,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1562750899","product_id":100029501,"comment_content":"SELECT<br>\theight_grades.height_level,<br>\tcount(*)<br>FROM<br>\tplayer<br>LEFT JOIN height_grades ON player.height BETWEEN height_grades.height_lowest<br>AND height_grades.height_highest<br>GROUP BY<br>\theight_grades.height_level","like_count":0},{"had_liked":false,"id":112387,"user_name":"江南皮革厂研发中心保安队长","can_delete":false,"product_type":"c1","uid":1099584,"ip_address":"","ucode":"231419643A5CC5","user_header":"https://static001.geekbang.org/account/avatar/00/10/c7/40/66a203cd.jpg","comment_is_top":false,"comment_ctime":1562727643,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1562727643","product_id":100029501,"comment_content":"交作业：select h.h_level,count(h.h_level)  from player as p  join h_grades as h on p.height between h.h_lowest and h.h_highest group by h.h_level;<br>老师还请帮忙看看是否还可以优化。","like_count":0},{"had_liked":false,"id":111645,"user_name":"闵强 MinQiang","can_delete":false,"product_type":"c1","uid":1240302,"ip_address":"","ucode":"1BF979D2752115","user_header":"https://static001.geekbang.org/account/avatar/00/12/ec/ee/c3333ef4.jpg","comment_is_top":false,"comment_ctime":1562577494,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1562577494","product_id":100029501,"comment_content":"SELECT a.height_level,COUNT(b.height) AS player_num<br>FROM height_grades AS a LEFT JOIN player AS b<br>ON b.height BETWEEN a.height_lowest AND a.height_highest<br>GROUP BY a.height_level<br>ORDER BY a.height_level<br>;<br><br>height_level\tplayer_num<br>A\t18<br>B\t14<br>C\t5<br>D\t0","like_count":0},{"had_liked":false,"id":111425,"user_name":"黄涵宇看起来很好吃","can_delete":false,"product_type":"c1","uid":1172802,"ip_address":"","ucode":"553DC4FFBDFC96","user_header":"https://static001.geekbang.org/account/avatar/00/11/e5/42/a994666a.jpg","comment_is_top":false,"comment_ctime":1562556605,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1562556605","product_id":100029501,"comment_content":"有个疑问NATURAL JOIN 与sql 92 的等值连接完全等价吗？ NATURAL JOIN 是要求两张表同时有的字段都相等才连接， 等值连接有这个要求吗？ 比如 a.teamid = b.teamid ，但是除了teamid以外两表还同时拥有一个字段 比如 key， 这时候 a.key &lt;&gt; b.key NATURAL JOIN无法连接两条记录吧？等值连接如何设定a.teamid = b.teamid 时候两表可以连接吗","like_count":0},{"had_liked":false,"id":111308,"user_name":"wang","can_delete":false,"product_type":"c1","uid":1270262,"ip_address":"","ucode":"C1A3BCACCB188E","user_header":"https://static001.geekbang.org/account/avatar/00/13/61/f6/1d6b548a.jpg","comment_is_top":false,"comment_ctime":1562544292,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1562544292","product_id":100029501,"comment_content":"作业：select h.height_level, p.player_name from height_grades as h, player as p where p.height BETWEEN h.height_lowest and h.height_highest","like_count":0},{"had_liked":false,"id":111139,"user_name":"往事随风，顺其自然","can_delete":false,"product_type":"c1","uid":1235692,"ip_address":"","ucode":"F266EC6B143E38","user_header":"https://static001.geekbang.org/account/avatar/00/12/da/ec/779c1a78.jpg","comment_is_top":false,"comment_ctime":1562486982,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1562486982","product_id":100029501,"comment_content":"太多了，实际上常用就那几种","like_count":0},{"had_liked":false,"id":111114,"user_name":"Fred","can_delete":false,"product_type":"c1","uid":1585721,"ip_address":"","ucode":"DBA8999FE43E4F","user_header":"","comment_is_top":false,"comment_ctime":1562478957,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1562478957","product_id":100029501,"comment_content":"SELCET  COUNT(*) AS num, b.height_level FROM <br>player AS a <br>LEFT JOIN height_grades AS b <br>WHERE a.height BETWEEN b.heigt_lowest AND b.height_highest<br>GROUP BY b.height_level","like_count":0},{"had_liked":false,"id":111106,"user_name":"supermouse","can_delete":false,"product_type":"c1","uid":1321860,"ip_address":"","ucode":"88072D5F881827","user_header":"https://static001.geekbang.org/account/avatar/00/14/2b/84/07f0c0d6.jpg","comment_is_top":false,"comment_ctime":1562474644,"is_pvip":false,"replies":[{"id":"40485","content":"正确","user_name":"作者回复","user_name_real":"cy","uid":"1306094","ctime":1562541182,"ip_address":"","comment_id":111106,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1562474644","product_id":100029501,"comment_content":"SELECT <br>    COUNT(*), h.height_level<br>FROM<br>    player AS p,<br>    height_grades AS h<br>WHERE<br>    p.height BETWEEN h.height_lowest AND h.height_highest<br>GROUP BY h.height_level","like_count":0,"discussions":[{"author":{"id":1306094,"avatar":"https://static001.geekbang.org/account/avatar/00/13/ed/ee/c4779b67.jpg","nickname":"cy","note":"","ucode":"50D653399A31F6","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":457232,"discussion_content":"正确","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1562541182,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":111050,"user_name":"Yt","can_delete":false,"product_type":"c1","uid":1508210,"ip_address":"","ucode":"E094E3666A1440","user_header":"http://thirdwx.qlogo.cn/mmopen/vi_32/Pk7HVX99cBlSOicLoa8KN8yCKx1pWIyYuy7zxL2ibXicYRFq2ic7LMYiaXMajuQNRZzL4QyuJX6ToRoficsBPlT3Meog/132","comment_is_top":false,"comment_ctime":1562433395,"is_pvip":false,"replies":[{"id":"40487","content":"正确","user_name":"作者回复","user_name_real":"cy","uid":"1306094","ctime":1562541326,"ip_address":"","comment_id":111050,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1562433395","product_id":100029501,"comment_content":"SELECT height_level,COUNT(height_level)<br>FROM player JOIN height_grades<br>ON player.height BETWEEN  height_grades.height_lowest AND height_grades.height_highest<br> GROUP BY height_level<br>ORDER BY height_level;","like_count":0,"discussions":[{"author":{"id":1306094,"avatar":"https://static001.geekbang.org/account/avatar/00/13/ed/ee/c4779b67.jpg","nickname":"cy","note":"","ucode":"50D653399A31F6","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":457199,"discussion_content":"正确","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1562541326,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":110980,"user_name":"ABC","can_delete":false,"product_type":"c1","uid":1054958,"ip_address":"","ucode":"7501AD9C0C4A70","user_header":"https://static001.geekbang.org/account/avatar/00/10/18/ee/a1ed60d1.jpg","comment_is_top":false,"comment_ctime":1562408765,"is_pvip":false,"replies":[{"id":"78661","content":"客气 加油ABC同学<br>你没有D这种情况的height_level","user_name":"作者回复","user_name_real":"cy","uid":"1306094","ctime":1587995967,"ip_address":"","comment_id":110980,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1562408765","product_id":100029501,"comment_content":"总结了三点:<br><br>1. 我之前在使用join on 的时候有一些误区,一直以为on后面必须是=号连接,学了这两节懂了很多。<br>2. 同时，以前总是热衷于from player a,height_grades b where a.id=b.playerid 这样连表查询.<br>3. 在之前也从来没用过自连接。。一直都是子查询，后面我会用自连接替换到子查询,谢谢这个课程，，让我学到了这么多。谢谢老师。<br><br>作业答案：<br><br>select B.height_level,COUNT(*) from player  a join height_grades b on a.height between b.height_lowest and b.height_highest group by b.height_level<br><br>另外老师,啥时候会讲union呢?","like_count":0,"discussions":[{"author":{"id":1306094,"avatar":"https://static001.geekbang.org/account/avatar/00/13/ed/ee/c4779b67.jpg","nickname":"cy","note":"","ucode":"50D653399A31F6","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":457156,"discussion_content":"客气 加油ABC同学\n你没有D这种情况的height_level","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1587995967,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":110917,"user_name":"林彦","can_delete":false,"product_type":"c1","uid":1032615,"ip_address":"","ucode":"5094CC6ED7B40C","user_header":"https://static001.geekbang.org/account/avatar/00/0f/c1/a7/5e66d331.jpg","comment_is_top":false,"comment_ctime":1562393818,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1562393818","product_id":100029501,"comment_content":"SELECT<br>\th.height_level,<br>\tCOUNT( DISTINCT player_id ) AS num <br>FROM<br>\theight_grades AS h<br>\tLEFT JOIN player AS p ON p.height BETWEEN h.height_lowest <br>\tAND h.height_highest <br>GROUP BY<br>\th.height_level <br>ORDER BY<br>\th.height_level ASC<br><br>height_level\tnum<br>A\t18<br>B\t14<br>C\t5<br>D\t0","like_count":0},{"had_liked":false,"id":110873,"user_name":"Ye","can_delete":false,"product_type":"c1","uid":1235520,"ip_address":"","ucode":"3FED98D61A7B4F","user_header":"https://static001.geekbang.org/account/avatar/00/12/da/40/5f8f72fa.jpg","comment_is_top":false,"comment_ctime":1562381986,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1562381986","product_id":100029501,"comment_content":"老师能否讲解一下，用JOIN ON和不写JOIN只用WHERE来查询，有什么区别？","like_count":0},{"had_liked":false,"id":110736,"user_name":"时间是最真的答案","can_delete":false,"product_type":"c1","uid":1183601,"ip_address":"","ucode":"B90F3EF769F865","user_header":"https://static001.geekbang.org/account/avatar/00/12/0f/71/9273e8a4.jpg","comment_is_top":false,"comment_ctime":1562321320,"is_pvip":false,"replies":[{"id":"63745","content":"后面有SQL优化的部分","user_name":"作者回复","user_name_real":"cy","uid":"1306094","ctime":1577530980,"ip_address":"","comment_id":110736,"utype":1}],"discussion_count":2,"race_medal":0,"score":"1562321320","product_id":100029501,"comment_content":"SELECT h.height_level,COUNT(p.player_id) AS num FROM height_grades AS h JOIN player AS p ON p.height BETWEEN h.height_lowest AND h.height_highest GROUP BY h.height_level ;<br><br>看到现在，感觉这些都是比较基础的，期待后面优化篇能讲的更深入","like_count":0,"discussions":[{"author":{"id":1306094,"avatar":"https://static001.geekbang.org/account/avatar/00/13/ed/ee/c4779b67.jpg","nickname":"cy","note":"","ucode":"50D653399A31F6","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":457031,"discussion_content":"后面有SQL优化的部分","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1577530980,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1585504,"avatar":"","nickname":"Geek_5d805b","note":"","ucode":"23A0EAC120EA9C","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":1881,"discussion_content":"我想在这基础上再统计level-A、B、C里的人分别叫什么名，请问怎么写呢","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1563027449,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":110732,"user_name":"Fortune","can_delete":false,"product_type":"c1","uid":1508654,"ip_address":"","ucode":"6B9465AC996523","user_header":"https://static001.geekbang.org/account/avatar/00/17/05/2e/5a6b6b6e.jpg","comment_is_top":false,"comment_ctime":1562320770,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1562320770","product_id":100029501,"comment_content":"多表链接时，用where语句过滤数据，请问老师能举一些例子吗？","like_count":0},{"had_liked":false,"id":110699,"user_name":"大斌","can_delete":false,"product_type":"c1","uid":1002183,"ip_address":"","ucode":"1434C2B0A29135","user_header":"https://static001.geekbang.org/account/avatar/00/0f/4a/c7/ec18673b.jpg","comment_is_top":false,"comment_ctime":1562316226,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1562316226","product_id":100029501,"comment_content":"select count(*) as num,h.height_level from height_grades as h join player as p on p.height between h.height_lowest and h.height_highest group by h.height_level order by h.height_level desc;","like_count":0},{"had_liked":false,"id":110698,"user_name":"小美猴77","can_delete":false,"product_type":"c1","uid":1572790,"ip_address":"","ucode":"6275071FD0C832","user_header":"https://static001.geekbang.org/account/avatar/00/17/ff/b6/f84cf419.jpg","comment_is_top":false,"comment_ctime":1562316023,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1562316023","product_id":100029501,"comment_content":"SELECT h.height_level,count(player_id) From player AS p JOIN height_grades AS h ON p.height BETWEEN h.height_lowest AND h.height_highest GROUP BY  h.height_level","like_count":0},{"had_liked":false,"id":110691,"user_name":"陈洁","can_delete":false,"product_type":"c1","uid":1570514,"ip_address":"","ucode":"8DBDF7A85DB4BC","user_header":"https://static001.geekbang.org/account/avatar/00/17/f6/d2/dcf628d3.jpg","comment_is_top":false,"comment_ctime":1562315349,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1562315349","product_id":100029501,"comment_content":"SELECT height_level,COUNT(height_level)<br>FROM height_grades AS h RIGHT JOIN player AS p<br>ON height BETWEEN height_lowest AND height_highest<br>GROUP BY height_level;","like_count":0},{"had_liked":false,"id":110681,"user_name":"Goal","can_delete":false,"product_type":"c1","uid":1307012,"ip_address":"","ucode":"C337CD4C7E07B0","user_header":"https://static001.geekbang.org/account/avatar/00/13/f1/84/7d21bd9e.jpg","comment_is_top":false,"comment_ctime":1562313892,"is_pvip":false,"replies":[{"id":"63747","content":"Good Job","user_name":"作者回复","user_name_real":"cy","uid":"1306094","ctime":1577531024,"ip_address":"","comment_id":110681,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1562313892","product_id":100029501,"comment_content":"# 查询身高比格里芬高的球员姓名，匹配中文姓名，最好用模糊匹配<br># 子查询<br>SELECT player_name, height FROM player WHERE height &gt; (SELECT height from player WHERE player_name LIKE &quot;%格里芬%&quot; )<br># SQL92<br>SELECT b.player_name, b.height FROM player as a , player as b WHERE a.player_name LIKE &#39;%格里芬%&#39;  and a.height &lt; b.height<br># SQL99<br>SELECT b.player_name, b.height FROM player as a JOIN player as b WHERE a.player_name LIKE &#39;%格里芬%&#39; and a.height &lt; b.height <br><br># 如果对上述过程不太理解：可以分开执行，然后，查看每次执行的返回结果：比如<br>1. SELECT a.player_name, a.height, b.player_name, b.height FROM player as a JOIN player as b<br>2. SELECT a.player_name, a.height, b.player_name, b.height FROM player as a JOIN player as b WHERE a.player_name LIKE &#39;%格里芬%&#39;<br>3. SELECT a.player_name, a.height, b.player_name, b.height FROM player as a JOIN player as b WHERE a.player_name LIKE &#39;%格里芬%&#39; and a.height &lt; b.height <br><br><br># 思考题：<br>SELECT h.height_level,COUNT(*) AS height_num FROM height_grades as h JOIN player AS p ON p.height BETWEEN h.height_lowest AND h.height_highest GROUP BY h.height_level","like_count":0,"discussions":[{"author":{"id":1306094,"avatar":"https://static001.geekbang.org/account/avatar/00/13/ed/ee/c4779b67.jpg","nickname":"cy","note":"","ucode":"50D653399A31F6","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":457004,"discussion_content":"Good Job","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1577531024,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":110678,"user_name":"Geek_1c165d","can_delete":false,"product_type":"c1","uid":1584176,"ip_address":"","ucode":"3E1B70DCF3DF13","user_header":"https://wx.qlogo.cn/mmopen/vi_32/aianFlNnvpUaPUbYG9EjVbibgOgOCJYqgiapCbsbIhWHJG8BBm4fzo1ALNI8vqsL4mrGB9vWPWyUCct5yLp0neQDg/132","comment_is_top":false,"comment_ctime":1562313276,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1562313276","product_id":100029501,"comment_content":"SELECT<br>    t1.HEIGHT_LEVEL,<br>    COUNT(t2.PLAYER_ID) cnt<br>FROM<br>    HEIGHT_GRADES t1<br>LEFT JOIN<br>    player t2 on t2.HEIGHT &gt;= t1.HEIGHT_LOWEST<br>AND t2.HEIGHT&lt;= t1.HEIGHT_HIGHEST<br>GROUP BY t1.HEIGHT_LEVEL order by t1.HEIGHT_LEVEL <br><br>HEIGHT_LEVEL                CNT<br>-------------------- ----------<br>A                            18<br>B                            14<br>C                             5<br>D                             0","like_count":0},{"had_liked":false,"id":110670,"user_name":"星期三。","can_delete":false,"product_type":"c1","uid":1203078,"ip_address":"","ucode":"EF3C461AB5399D","user_header":"https://static001.geekbang.org/account/avatar/00/12/5b/86/dba8214e.jpg","comment_is_top":false,"comment_ctime":1562312274,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1562312274","product_id":100029501,"comment_content":"老师可以帮我解惑一下嘛。前面有说到sql关键字的执行顺序是：from&gt;where&gt;group by &gt; having &gt; select。但是我在本地测试时发现，where不能使用别名(因为执行顺序在select之前，不能使用很好理解)，但是group by 却可以使用，表示不理解。mysql的版本是5.6.16。","like_count":0},{"had_liked":false,"id":110641,"user_name":"TKbook","can_delete":false,"product_type":"c1","uid":1073829,"ip_address":"","ucode":"F6E0E99CC79059","user_header":"https://static001.geekbang.org/account/avatar/00/10/62/a5/43aa0c27.jpg","comment_is_top":false,"comment_ctime":1562309033,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1562309033","product_id":100029501,"comment_content":"select height_level, count(*) from player join height_grades on height between height_lowest and height_highest group by height_level;","like_count":0},{"had_liked":false,"id":110638,"user_name":"JustDoDT","can_delete":false,"product_type":"c1","uid":1127175,"ip_address":"","ucode":"6AF0B80F00EAEF","user_header":"https://static001.geekbang.org/account/avatar/00/11/33/07/8f351609.jpg","comment_is_top":false,"comment_ctime":1562308805,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1562308805","product_id":100029501,"comment_content":"SELECT height_grades.height_level, COUNT(*) AS player_nums <br>FROM player <br>\tLEFT JOIN height_grades ON player.height BETWEEN height_grades.height_lowest AND height_grades.height_highest <br>GROUP BY height_grades.height_level;","like_count":0},{"had_liked":false,"id":110605,"user_name":"cricket1981","can_delete":false,"product_type":"c1","uid":1001715,"ip_address":"","ucode":"758262F5958DA4","user_header":"https://static001.geekbang.org/account/avatar/00/0f/48/f3/f1034ffd.jpg","comment_is_top":false,"comment_ctime":1562301008,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1562301008","product_id":100029501,"comment_content":"mysql&gt; SELECT h.height_level, count(player_id) AS player_count FROM player AS p LEFT JOIN height_grades h ON height BETWEEN h.height_lowest AND h.height_highest GROUP BY h.height_level;<br>+--------------+--------------+<br>| height_level | player_count |<br>+--------------+--------------+<br>| A            |           18 |<br>| B            |           14 |<br>| C            |            5 |<br>+--------------+--------------+<br>3 rows in set (0.00 sec)","like_count":0},{"had_liked":false,"id":110596,"user_name":"飞机","can_delete":false,"product_type":"c1","uid":1585659,"ip_address":"","ucode":"D0CA3AE2B50686","user_header":"https://static001.geekbang.org/account/avatar/00/18/31/fb/e5918d39.jpg","comment_is_top":false,"comment_ctime":1562298173,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1562298173","product_id":100029501,"comment_content":"SELECT h.height_level, COUNT(player_id) AS `count` FROM nba.player AS p<br>JOIN nba.height_grades AS h<br>ON p.height BETWEEN h.height_lowest AND h.height_highest<br>GROUP BY h.height_level;","like_count":0},{"had_liked":false,"id":110586,"user_name":"马以","can_delete":false,"product_type":"c1","uid":1344431,"ip_address":"","ucode":"3FEA06CA14DE28","user_header":"https://static001.geekbang.org/account/avatar/00/14/83/af/1cb42cd3.jpg","comment_is_top":false,"comment_ctime":1562296982,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1562296982","product_id":100029501,"comment_content":"做笛卡尔积，不需要指定字段","like_count":0},{"had_liked":false,"id":110571,"user_name":"zjajxzg","can_delete":false,"product_type":"c1","uid":1441304,"ip_address":"","ucode":"EF2FBD463F266B","user_header":"http://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTKuLsA1AAjUSO7oPHIqbA8f8slVIUw7nhdiaOI4nBYH6RxlyxXyFNe2Bc0g7yMoMHxnlh2mf43aVXw/132","comment_is_top":false,"comment_ctime":1562295211,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1562295211","product_id":100029501,"comment_content":"SELECT hg.height_level, COUNT(*)<br>  FROM player p<br>\tJOIN height_grades hg<br>\t  ON p.height BETWEEN hg.height_lowest AND hg.height_highest<br> GROUP BY hg.height_level","like_count":0},{"had_liked":false,"id":110530,"user_name":"华夏","can_delete":false,"product_type":"c1","uid":1449474,"ip_address":"","ucode":"4D627CFA5A4B82","user_header":"https://static001.geekbang.org/account/avatar/00/16/1e/02/2864e0f2.jpg","comment_is_top":false,"comment_ctime":1562290521,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1562290521","product_id":100029501,"comment_content":" SELECT height_level, COUNT(player_name) FROM player JOIN height_grades ON height BETWEEN height_lowest AND height_highest GROUP BY height_level; <br>+--------------+--------------------+<br>| height_level | COUNT(player_name) |<br>+--------------+--------------------+<br>| B            |                 14 |<br>| A            |                 18 |<br>| C            |                  5 |<br>+--------------+--------------------+<br>3 rows in set (0.00 sec)<br>","like_count":0},{"had_liked":false,"id":110526,"user_name":"太精","can_delete":false,"product_type":"c1","uid":1419939,"ip_address":"","ucode":"7B0F1B090ECF0F","user_header":"https://static001.geekbang.org/account/avatar/00/15/aa/a3/0b7f0334.jpg","comment_is_top":false,"comment_ctime":1562290029,"is_pvip":false,"replies":[{"id":"63916","content":"Good Job","user_name":"作者回复","user_name_real":"cy","uid":"1306094","ctime":1577604764,"ip_address":"","comment_id":110526,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1562290029","product_id":100029501,"comment_content":"SELECT p.height_level, COUNT(*) AS level_counts FROM player AS a JOIN height_grades  AS p ON height BETWEEN p.height_lowest AND p.height_highest GROUP BY p.height_level;<br>+--------------+--------------+<br>| height_level | level_counts |<br>+--------------+--------------+<br>| A                |                18 |<br>| B                |                14 |<br>| C                |                 5 |<br>+--------------+--------------+<br>","like_count":0,"discussions":[{"author":{"id":1306094,"avatar":"https://static001.geekbang.org/account/avatar/00/13/ed/ee/c4779b67.jpg","nickname":"cy","note":"","ucode":"50D653399A31F6","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":456924,"discussion_content":"Good Job","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1577604764,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":110475,"user_name":"ack","can_delete":false,"product_type":"c1","uid":1440912,"ip_address":"","ucode":"69CA1233EEA8E2","user_header":"https://static001.geekbang.org/account/avatar/00/15/fc/90/c9df0459.jpg","comment_is_top":false,"comment_ctime":1562286139,"is_pvip":false,"replies":[{"id":"63917","content":"Good Job","user_name":"作者回复","user_name_real":"cy","uid":"1306094","ctime":1577604772,"ip_address":"","comment_id":110475,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1562286139","product_id":100029501,"comment_content":"练习：<br>SELECT height_level,COUNT(*) FROM height_grades as h JOIN player as p ON p.height BETWEEN h.height_lowest AND h.height_highest GROUP BY height_level;","like_count":0,"discussions":[{"author":{"id":1306094,"avatar":"https://static001.geekbang.org/account/avatar/00/13/ed/ee/c4779b67.jpg","nickname":"cy","note":"","ucode":"50D653399A31F6","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":456899,"discussion_content":"Good Job","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1577604772,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":110469,"user_name":"Liam","can_delete":false,"product_type":"c1","uid":1094597,"ip_address":"","ucode":"1D15D3B64F2606","user_header":"https://static001.geekbang.org/account/avatar/00/10/b3/c5/7fc124e2.jpg","comment_is_top":false,"comment_ctime":1562284777,"is_pvip":false,"discussion_count":1,"race_medal":0,"score":"1562284777","product_id":100029501,"comment_content":"natural join 怎么知道应该根据哪个字段进行等值连接","like_count":0,"discussions":[{"author":{"id":1084596,"avatar":"http://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTKvNozkiaiao1IyibicprL6EWZ1teCh4TDUNDjNbwdxL0XFJ5lSmnnrZHuDIJelL0bVAEORLabdHmZDAg/132","nickname":"jdxj","note":"","ucode":"E8A89819FECE4C","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":12580,"discussion_content":"名字和类型吧","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1568549629,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]}]}