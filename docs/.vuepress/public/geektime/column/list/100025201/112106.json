{"id":112106,"title":"30  | å®æˆ˜ï¼ˆäº”ï¼‰ï¼šæ€ä¹ˆè®¾è®¡ä¸€ä¸ªâ€œç”»å›¾â€ç¨‹åºï¼Ÿ","content":"<p>ä½ å¥½ï¼Œæˆ‘æ˜¯ä¸ƒç‰›äº‘è®¸å¼ä¼Ÿã€‚</p><p>æˆ‘ä»¬ç»§ç»­èŠæˆ‘ä»¬çš„è¯é¢˜ã€‚è¿™æ˜¯ç”»å›¾ç¨‹åºçš„æœ€åä¸€è®²äº†ã€‚å½“ç„¶æˆ‘ä»¬åç»­è¿˜ä¼šç»“åˆè¿™ä¸ªå®æˆ˜ç¨‹åºå±•å¼€è®¨è®ºæœ‰å…³äºæ¶æ„çš„æ–¹æ–¹é¢é¢ã€‚</p><h2>å®è§‚çš„ç³»ç»Ÿæ¶æ„</h2><p>ä¸Šä¸€è®²å¼€å§‹ï¼Œæˆ‘ä»¬çš„ç”»å›¾ç¨‹åºæœ‰äº†è·¨å›¢é˜Ÿåä½œï¼šå› ä¸ºæˆ‘ä»¬å¼€å§‹æœ‰äº† paintdom å’Œ paintweb ä¸¤å¤§è½¯ä»¶ã€‚paintdom ç›‘å¬çš„åœ°å€æ˜¯ localhost:9999ï¼Œè€Œ paintweb ç›‘å¬çš„åœ°å€æ˜¯ localhost:8888ã€‚</p><p>åº”å½“æ³¨æ„ï¼Œåœ¨å®é™…ä¸šåŠ¡ä¸­å®ƒä»¬æ˜¯ä¸åŒçš„è½¯ä»¶ï¼Œäº‹å®ä¸Šæˆ‘ä»¬ paintweb ç¨‹åºä¹Ÿå®Œå…¨æ˜¯ä»¥è¿›ç¨‹é—´åä½œçš„æ–¹å¼ï¼Œé€šè¿‡åå‘ä»£ç†æœºåˆ¶æ¥è°ƒç”¨ paintdom çš„åŠŸèƒ½ã€‚ä½†æ˜¯åœ¨æˆ‘ä»¬è¿™ä¸ªç”»å›¾ DEMO ç¨‹åºä¸­ï¼Œå®ƒä»¬åŒå±ä¸€ä¸ªè¿›ç¨‹ï¼Œpaintdom ä½œä¸º paintweb çš„ä¸€ä¸ª goroutine åœ¨è·‘ã€‚è¿™çº¯ç²¹æ˜¯å› ä¸ºæˆ‘ä»¬æƒ³è®©è¿™ä¸¤ä¸ªç¨‹åº â€œåŒç”Ÿå…±æ­»â€ï¼Œæ–¹ä¾¿è°ƒè¯•çš„æ—¶å€™èµ·åœè¿›ç¨‹ã€‚</p><p>paintdom å’Œ paintweb ä¹‹é—´ç›¸äº’åä½œçš„åŸºç¡€ï¼Œæ˜¯å®ƒä»¬ä¹‹é—´æ‰€é‡‡ç”¨çš„ç½‘ç»œåè®®ã€‚</p><p>å½“æˆ‘ä»¬è¯´èµ·ç½‘ç»œåè®®ï¼Œå®ƒå…¶å®é€šå¸¸åŒ…å«ä¸¤ä¸ªå±‚é¢çš„æ„æ€ï¼šå…¶ä¸€æ˜¯æˆ‘ä»¬ç½‘ç»œåè®®çš„è½½ä½“ï¼Œä¹Ÿå°±æ˜¯åè®®æ ˆï¼ˆæˆ‘ä»¬è¿™é‡Œé‡‡çº³çš„æ˜¯ HTTP åè®®ï¼Œè€Œ HTTP åè®®åˆåŸºäº TCP/IP åè®®ï¼‰ï¼›å…¶äºŒæ˜¯æˆ‘ä»¬ç½‘ç»œåè®®æ‰¿è½½çš„ä¸šåŠ¡é€»è¾‘ã€‚</p><p>å½“æˆ‘ä»¬è°ˆæ¶æ„çš„æ—¶å€™ï¼Œä¹Ÿä¼šåŒæ—¶èŠè¿™ä¸¤ä¸ªå±‚é¢ï¼Œåªæ˜¯å®ƒä»¬åœ¨ä¸åŒçš„ç»´åº¦ã€‚æˆ‘ä»¬ä¼šå…³å¿ƒç½‘ç»œåè®®çš„åè®®æ ˆé€‰æ‹©ä»€ä¹ˆï¼Œæ˜¯åŸºäº HTTP è¿˜æ˜¯åŸºäºè‡ªå®šä¹‰çš„äºŒè¿›åˆ¶åè®®ï¼Œè¿™ä¸ªæ˜¯å±äºåŸºç¡€æ¶æ„çš„ç»´åº¦ã€‚æˆ‘ä»¬ä¹Ÿä¼šå…³å¿ƒç½‘ç»œåè®®çš„ä¸šåŠ¡é€»è¾‘ï¼Œåˆ¤æ–­å®ƒæ˜¯å¦è‡ªç„¶ä½“ç°ä¸šåŠ¡éœ€æ±‚ï¼Œè¿™æ˜¯å±äºåº”ç”¨æ¶æ„çš„ç»´åº¦ã€‚</p><!-- [[[read_end]]] --><p>æ˜ç¡®äº†ç½‘ç»œåè®®åï¼Œæˆ‘ä»¬å®ç°äº† Mock ç‰ˆæœ¬çš„æœåŠ¡ç«¯ç¨‹åº paintdomã€‚åœ¨å®é™…é¡¹ç›®ä¸­ï¼ŒMock ç¨‹åºå¾€å¾€ä¼šå¤§å¹…æé€Ÿå›¢é˜Ÿçš„å¼€å‘æ•ˆç‡ã€‚è¿™æ˜¯å› ä¸ºå®ƒèƒ½å¤Ÿè¾¾åˆ°å¦‚ä¸‹ä¸¤ä¸ªå¤§çš„æ ¸å¿ƒç›®æ ‡ï¼š</p><ul>\n<li>è®©å›¢é˜Ÿçš„ç ”å‘è¿­ä»£å¹¶è¡Œï¼Œå½¼æ­¤å¯ä»¥ç‹¬ç«‹æ¼”è¿›ã€‚</li>\n<li>åŠæ—©éªŒè¯ç½‘ç»œåè®®çš„åˆç†æ€§ï¼Œåœ¨å®æˆ˜ä¸­è¾¾åˆ°ç”¨æœ€çŸ­æ—¶é—´ç¨³å®šåè®®çš„ç›®çš„ã€‚</li>\n</ul><p>ä¸Šä¸€è®²æˆ‘ä»¬çš„ paintdom å’Œ paintweb ä¹‹é—´è™½ç„¶å®šä¹‰äº†ç½‘ç»œåè®®ï¼Œå¹¶ä¸”å®ç°äº†ç¬¬ä¸€ç‰ˆï¼Œä½†æ˜¯å¹¶æ²¡æœ‰å»åšä¸¤è€…çš„å¯¹æ¥ã€‚</p><p>ä»Šå¤©æˆ‘ä»¬å°±æ¥å¯¹æ¥å®ƒä»¬ã€‚</p><p>è™½ç„¶ paintweb æ²¡æœ‰å¯¹æ¥æœåŠ¡ç«¯ï¼Œä½†ä»æ–‡æ¡£ç¼–è¾‘çš„è§’åº¦æ¥è¯´ï¼Œå®ƒçš„åŠŸèƒ½æ˜¯éå¸¸å®Œæ•´çš„ã€‚æˆ‘ä»¬å¯¹æ¥ paintdom å’Œ paintweb çš„ç›®çš„ä¸æ˜¯åŠ ç¼–è¾‘åŠŸèƒ½ï¼Œè€Œæ˜¯è®©æ–‡æ¡£å¯ä»¥å­˜å‚¨åˆ°æœåŠ¡ç«¯ï¼Œä»¥ä¾¿äºäººä»¬åœ¨ä¸–ç•Œä»»ä½•å¯ä»¥è”ç½‘çš„è§’è½éƒ½å¯ä»¥æ‰“å¼€å®ƒã€‚</p><p>å½“ç„¶ä¸¥è°¨æ¥è¯´ï¼Œè¯´ paintweb æ²¡æœ‰æœåŠ¡ç«¯æ˜¯ä¸æ­£ç¡®çš„ï¼Œpaintweb æœ¬èº«æ˜¯ä¸€ä¸ª B/S ç»“æ„ï¼Œå®ƒæœ‰å®ƒè‡ªå·±çš„æœåŠ¡ç«¯ã€‚å¦‚ä¸‹ï¼š</p><pre><code>var wwwServer = http.FileServer(http.Dir(&quot;www&quot;))\n\nfunc handleDefault(w http.ResponseWriter, req *http.Request) {\n  if req.URL.Path == &quot;/&quot; {\n    http.ServeFile(w, req, &quot;www/index.htm&quot;)\n\treturn\n  }\n  req.URL.RawQuery = &quot;&quot; // skip &quot;?params&quot;\n  wwwServer.ServeHTTP(w, req)\n}\n\nfunc main() {\n  http.HandleFunc(&quot;/&quot;, handleDefault)\n  http.ListenAndServe(&quot;:8888&quot;, nil)\n}\n</code></pre><p>å¯ä»¥çœ‹å‡ºï¼Œpaintweb è‡ªå·±çš„æœåŠ¡ç«¯åŸºæœ¬ä¸Šæ²¡å¹²ä»€ä¹ˆäº‹æƒ…ï¼Œå°±æ˜¯ä¸€ä¸ªéå¸¸æ™®é€šçš„é™æ€æ–‡ä»¶ä¸‹è½½æœåŠ¡å™¨ï¼Œæä¾›ç»™æµè§ˆå™¨ç«¯ä¸‹è½½ HTML + CSS + JavaScript ç­‰å†…å®¹ã€‚</p><p>æ‰€ä»¥ paintweb çš„æœåŠ¡ç«¯å®Œå…¨æ˜¯â€œå¹³åº¸â€çš„ï¼Œä¸ä¸šåŠ¡æ— å…³ã€‚å…·ä½“çš„ä¸šåŠ¡ï¼Œéƒ½æ˜¯é€šè¿‡ www ç›®å½•é‡Œé¢çš„æ–‡ä»¶æ¥åšåˆ°çš„ã€‚è¿™äº›æ–‡ä»¶éƒ½æ˜¯å‰ç«¯çš„æµè§ˆå™¨ç«¯æ‰€ä¾èµ–çš„ï¼Œåªä¸è¿‡è¢« â€œæ‰˜ç®¡â€ åˆ° paintweb æœåŠ¡ç«¯è€Œå·²ã€‚</p><p>é‚£ä¹ˆ paintweb æ€ä¹ˆå¯¹æ¥ paintdom å‘¢ï¼Ÿ</p><p>ç‰©ç†ä¸Šçš„å¯¹æ¥æ¯”è¾ƒç®€å•ï¼Œåªæ˜¯ä¸ªåå‘ä»£ç†æœåŠ¡å™¨è€Œå·²ï¼Œä»£ç å¦‚ä¸‹ï¼š</p><pre><code>func newReverseProxy(baseURL string) *httputil.ReverseProxy {\n  rpURL, _ := url.Parse(baseURL)\n  return httputil.NewSingleHostReverseProxy(rpURL)\n}\n\nvar apiReverseProxy = newReverseProxy(&quot;http://localhost:9999&quot;)\n\nfunc main() {\n  http.Handle(&quot;/api/&quot;, http.StripPrefix(&quot;/api/&quot;, apiReverseProxy))\n}\n</code></pre><p>å¯ä»¥çœ‹å‡ºï¼Œpaintweb çš„æœåŠ¡ç«¯å¹²çš„äº‹æƒ…ä»ç„¶æ˜¯ â€œå¹³åº¸â€ çš„ï¼Œåªæ˜¯æŠŠå‘å¾€ <a href=\"http://localhost:8888/api/xxx\">http://localhost:8888/api/xxx</a> çš„è¯·æ±‚ï¼ŒåŸå°ä¸åŠ¨åœ°å‘å¾€ <a href=\"http://localhost:9999/xxx\">http://localhost:9999/xxx</a> è€Œå·²ã€‚</p><p>åœ¨ç°å®ä¸­ï¼Œpaintweb çš„æœåŠ¡ç«¯å¹²çš„äº‹æƒ…ç¨å¾®å¤æ‚ä¸€äº›ã€‚å®ƒèƒŒåä¸åªæ˜¯æœ‰ä¸šåŠ¡æœåŠ¡å™¨ paintdomï¼Œè¿˜æœ‰å¿…ä¸å¯å°‘çš„å¸å·æœåŠ¡å™¨ï¼ˆAccount Serviceï¼‰ï¼Œç”¨æ¥æ”¯æŒç”¨æˆ·ç™»å½•/ç™»å‡ºã€‚</p><p>å¸å·æœåŠ¡å™¨æ˜¯ä¸€ä¸ªåŸºç¡€æ¶æ„ç±»çš„æœåŠ¡ï¼Œä¸ä¸šåŠ¡æ— å…³ã€‚å…¬å¸å¾ˆå¯èƒ½ä¸åªæœ‰ QPaint è¿™æ ·ä¸€ä¸ªä¸šåŠ¡ï¼Œè¿˜ä¼šæœ‰åˆ«çš„ï¼Œä½†è¿™äº›ä¸šåŠ¡å¯ä»¥å…±äº«ç›¸åŒçš„å¸å·æœåŠ¡ã€‚æ›´å‡†ç¡®åœ°è¯´ï¼Œæ˜¯å¿…é¡»å…±äº«ç›¸åŒçš„å¸å·æœåŠ¡ï¼Œå¦åˆ™ä¸€ä¸ªå…¬å¸å¼„å‡ºå¥½å¤šå¥—ç‹¬ç«‹çš„å¸å·ä½“ç³»æ¥ï¼Œç”¨æˆ·ä¹Ÿä¼šæœ‰æ‰€è¯Ÿç—…ã€‚</p><p>åœ¨éœ€è¦å¯¹æ¥å¸å·æœåŠ¡å™¨çš„æƒ…å†µä¸‹ï¼Œå®é™…ä¸Š paintweb çš„æœåŠ¡ç«¯å¹¶ä¸æ˜¯åŸå°ä¸åŠ¨åœ°è½¬å‘ä¸šåŠ¡è¯·æ±‚ï¼Œè€Œæ˜¯ä¼šå¯¹åè®®è¿›è¡Œè½¬ä¹‰ã€‚</p><p>åœ¨ â€œ<a href=\"https://time.geekbang.org/column/article/107128\">24 | è·¨å¹³å°ä¸ Web å¼€å‘çš„å»ºè®®</a>â€è¿™ä¸€è®²ä¸­æˆ‘ä»¬æåˆ°è¿‡ï¼š</p><blockquote>\n<p><span class=\"reference\">åˆ°äº† Web å¼€å‘ï¼Œæˆ‘ä»¬åŒæ ·éœ€è¦äºŒæ¬¡å¼€å‘æ¥å£ï¼Œåªä¸è¿‡è¿™ä¸ªäºŒæ¬¡å¼€å‘æ¥å£ä¸å†æ˜¯åœ¨ Client ç«¯å®Œæˆçš„ï¼Œè€Œæ˜¯åœ¨ Server ç«¯å®Œæˆã€‚Server ç«¯æ”¯æŒç›´æ¥çš„ API è°ƒç”¨ï¼Œä»¥æ”¯æŒè‡ªåŠ¨åŒ–ï¼ˆAutomationï¼‰æ–¹é¢çš„éœ€æ±‚ã€‚</span></p>\n<blockquote></blockquote>\n<p><span class=\"reference\">æ‰€ä»¥ï¼Œå¯¹ Server ç«¯æ¥è¯´ï¼Œæœ€åº•å±‚çš„æ˜¯ä¸€ä¸ªå¤šç§Ÿæˆ·çš„ Model å±‚ï¼ˆMulti-User Modelï¼‰ï¼Œå®ƒå®ç°äº†è‡ªåŠ¨åŒ–ï¼ˆAutomationï¼‰æ‰€éœ€çš„ APIã€‚</span></p>\n<blockquote></blockquote>\n<p><span class=\"reference\">åœ¨ Multi-User Model å±‚ä¹‹ä¸Šï¼Œæœ‰ä¸€ä¸ª Web å±‚ã€‚Web å±‚å’Œ Model å±‚çš„å‡è®¾ä¸åŒï¼ŒWeb å±‚æ˜¯åŸºäºä¼šè¯çš„ï¼ˆSession-basedï¼‰ï¼Œå› ä¸ºå®ƒè´Ÿè´£ç”¨æˆ·çš„æ¥å…¥ï¼Œæ¯ä¸ªç”¨æˆ·ç™»å½•åï¼Œä¼šå½¢æˆä¸€ä¸ªä¸ªä¼šè¯ï¼ˆSessionï¼‰ã€‚</span></p>\n<blockquote></blockquote>\n<p><span class=\"reference\">å¦‚æœæˆ‘ä»¬å¯¹Web å±‚ç»†ç©¶çš„è¯ï¼Œåˆåˆ†ä¸º Model å±‚å’Œ ViewModel å±‚ã€‚ä¸ºäº†åŒºåˆ†ï¼ŒWeb è¿™è¾¹çš„ Model å±‚æˆ‘ä»¬å«å®ƒ Session-based Modelã€‚ç›¸åº”åœ°ï¼ŒViewModel å±‚æˆ‘ä»¬å«å®ƒ Session-based ViewModelã€‚</span></p>\n<blockquote></blockquote>\n<p><span class=\"reference\"> åœ¨æœåŠ¡ç«¯ï¼ŒSession-based Model å’Œ Session-based ViewModel å¹¶ä¸å‘ç”Ÿç›´æ¥å…³è”ï¼Œå®ƒä»¬é€šè¿‡è‡ªå·±ç½‘ç»œé¥æ§æµè§ˆå™¨è¿™ä¸€ä¾§çš„ Model å’Œ ViewModelï¼Œä»è€Œå“åº”ç”¨æˆ·çš„äº¤äº’ã€‚</span></p>\n<blockquote></blockquote>\n<p><span class=\"reference\">Session-based Model æ˜¯ä»€ä¹ˆæ ·çš„å‘¢ï¼Ÿå®ƒå…¶å®æ˜¯ Multi-User Model å±‚çš„è½¬è¯‘ã€‚æŠŠå¤šç§Ÿæˆ·çš„ API è½¬è¯‘æˆå•ç§Ÿæˆ·çš„åœºæ™¯ã€‚æ‰€ä»¥è¿™ä¸€å±‚å¹¶ä¸éœ€è¦å¤ªå¤šçš„ä»£ç ï¼Œç”šè‡³ç†è®ºä¸Šè‡ªåŠ¨å®ç°ä¹Ÿæ˜¯æœ‰å¯èƒ½çš„ã€‚</span></p>\n<blockquote></blockquote>\n<p><span class=\"reference\">Session-based ViewModel æ˜¯ä¸€äº› HTML+JavaScript+CSS æ–‡ä»¶ã€‚å®ƒæ˜¯çœŸæ­£çš„ Web ä¸šåŠ¡å…¥å£ã€‚å®ƒé€šè¿‡äº’è”ç½‘æŠŠè‡ªå·±çš„æ•°æ®è¿”å›ç»™æµè§ˆå™¨ï¼Œæµè§ˆå™¨åŸºäº ViewModel æ¸²æŸ“å‡ºViewï¼Œè¿™æ ·æ•´ä¸ªç³»ç»Ÿå°±è¿è½¬èµ·æ¥äº†ã€‚</span></p>\n</blockquote><p>è¿™æ®µè¯è¯´çš„æ¯”è¾ƒæŠ½è±¡ï¼Œä½†ç»“åˆ QPaint è¿™ä¸ªå®é™…çš„ä¾‹å­ï¼Œå°±éå¸¸æ˜æœ—äº†ï¼š</p><ul>\n<li>paintdom å°±æ˜¯è¿™é‡Œè¯´çš„ Multi-User Model å±‚ï¼Œè´Ÿè´£å¤šç§Ÿæˆ·çš„ä¸šåŠ¡æœåŠ¡å™¨ã€‚</li>\n<li>paintweb æœåŠ¡ç«¯å®ç° Session-based Model å±‚ï¼Œè´Ÿè´£ Session-based åˆ° Multi-User çš„è½¬è¯‘ã€‚ç”±äºæˆ‘ä»¬å½“å‰è¿™ä¸ªä¾‹å­è¿˜ä¸æ”¯æŒå¤šç§Ÿæˆ·ï¼Œè½¬è¯‘å°±å˜æˆäº†ç®€å•çš„è½¬å‘ã€‚åé¢æˆ‘ä»¬åœ¨ â€œæœåŠ¡ç«¯å¼€å‘â€ ä¸€èŠ‚ä¸­ä¼šç»™å¤§å®¶çœ‹å®é™…çš„è½¬è¯‘å±‚æ˜¯æ€ä¹ˆåšçš„ã€‚</li>\n</ul><p>æ‰€ä»¥ä½ å¯ä»¥çœ‹åˆ°ï¼Œå…¶å® paintweb è‡ªèº«çš„æœåŠ¡ç«¯æ˜¯ä¸šåŠ¡æ— å…³çš„ã€‚å®ƒåšè¿™æ ·ä¸€äº›äº‹æƒ…ï¼š</p><ul>\n<li>Web å‰ç«¯æ–‡ä»¶çš„æ‰˜ç®¡ï¼ˆä½œä¸ºé™æ€æ–‡ä»¶ä¸‹è½½æœåŠ¡å™¨ï¼‰ï¼›</li>\n<li>æ”¯æŒå¸å·æœåŠ¡ï¼Œå®ç° Web çš„ç”¨æˆ·ç™»å½•ï¼›</li>\n<li>åšä¸šåŠ¡åè®®çš„è½¬è¯‘ï¼Œå°† Session-based çš„ API è¯·æ±‚è½¬ä¸º Multi-User çš„ API è¯·æ±‚ã€‚</li>\n</ul><p>å½“ç„¶ï¼Œæˆ‘ä»¬è¿™é‡Œå‡è®¾ Web è‡ªèº«çš„ä¸šåŠ¡é€»è¾‘éƒ½æ˜¯é€šè¿‡ JavaScript æ¥å®ç°çš„ã€‚è¿™æ„å‘³ç€æˆ‘ä»¬æ˜¯åŸºäº â€œèƒ–å‰ç«¯â€ æ¨¡å¼çš„ã€‚</p><p>ä½†è¿™å¹¶ä¸ä¸€å®šç¬¦åˆäº‹å®ï¼Œæœ‰äº›å…¬å¸ä¼šåŸºäº â€œèƒ–åç«¯â€ æ¨¡å¼ã€‚è¿™æ„å‘³ç€å¤§éƒ¨åˆ†çš„å‰ç«¯ç”¨æˆ·è¡Œä¸ºï¼Œéƒ½æ˜¯ç”±åç«¯æ”¯æŒçš„ï¼Œæ¯”å¦‚æˆ‘ä»¬ç”¨ PHP æ¥å®ç° Web åç«¯çš„ä¸šåŠ¡ä»£ç ã€‚</p><p>èƒ–åç«¯æ¨¡å¼çš„å¥½å¤„æ˜¯ Web ä»£ç æ¯”è¾ƒå®‰å…¨ã€‚è¿™é‡Œçš„ â€œå®‰å…¨â€ æ˜¯æŒ‡ IT èµ„äº§ä¿å…¨æ–¹é¢çš„å®‰å…¨ï¼Œä¸æ˜¯æŒ‡ä¸šåŠ¡å­˜åœ¨å®‰å…¨é—®é¢˜ï¼Œå› ä¸ºåˆ«äººçœ‹ä¸åˆ°å®Œæ•´çš„ Web ä¸šåŠ¡é€»è¾‘ä»£ç ã€‚</p><p>ä½†æ˜¯èƒ–åç«¯æ¨¡å¼çš„\bç¼ºç‚¹æ˜¯æ²¡åŠæ³•æ”¯æŒç¦»çº¿ã€‚å¤§éƒ¨åˆ†çš„ç”¨æˆ·äº¤äº’éƒ½éœ€è¦ Web åç«¯æ¥å“åº”ï¼Œä¸€æ—¦æ–­äº†ç½‘å°±ä»€ä¹ˆéƒ½å¹²ä¸äº†äº†ã€‚</p><p>åœ¨ â€œèƒ–åç«¯â€ æ¨¡å¼ä¸‹ï¼Œæˆ‘ä¸ªäººä¼šå€¾å‘äºåŸºäºç±»ä¼¼ PHP è¿™ç§èƒ¶æ°´è¯­è¨€æ¥å®ç° Web åç«¯çš„ä¸šåŠ¡ä»£ç ã€‚è€Œä¸€æ—¦æˆ‘ä»¬è¿™ä¹ˆåšï¼Œpaintweb çš„ä¸šåŠ¡é€»è¾‘å°±è¢«å‰¥ç¦»äº†ï¼Œpaintweb è‡ªèº«çš„åç«¯ä»ç„¶æ˜¯ä¸šåŠ¡æ— å…³çš„ï¼Œåªæ˜¯å¤šäº†ä¸€ä¸ªèŒè´£ï¼šæ”¯æŒ PHP è„šæœ¬è¯­è¨€ã€‚</p><p>çœŸæ­£ Web åç«¯ä¸šåŠ¡é€»è¾‘ï¼Œè¿˜æ˜¯æ”¾åœ¨äº† www ç›®å½•ä¸­ï¼Œä»¥ PHP æ–‡ä»¶å­˜åœ¨ï¼Œè¿™äº›æ–‡ä»¶å°±ä¸æ˜¯ç®€å•çš„é™æ€èµ„æºï¼Œè€Œæ˜¯ â€œèƒ–åç«¯â€ çš„ä¸šåŠ¡ä»£ç ã€‚</p><p>æ—¢ç„¶ paintweb åç«¯æ˜¯ â€œå¹³åº¸â€ çš„ï¼Œä¸ä¸šåŠ¡æ— å…³ï¼Œé‚£ä¹ˆæ•´ä¸ªä¸šåŠ¡é€»è¾‘çš„ä¸²è”ï¼Œé çš„å°±æ˜¯ www é‡Œé¢çš„ js æ–‡ä»¶ï¼Œå’Œ paintdom æä¾›çš„ API æ¥å£ã€‚</p><p>ä¸Šé¢æˆ‘ä»¬è¯´è¿‡ï¼Œåœ¨è¿æ¥ paintdom ä¹‹å‰ï¼Œpaintweb ç¨‹åºç‹¬ç«‹çœ‹æ˜¯å®Œæ•´çš„ï¼Œå®ƒæ”¯æŒç¦»çº¿åˆ›å»ºã€ç¼–è¾‘ä»¥åŠå­˜å‚¨æ–‡æ¡£åˆ°æµè§ˆå™¨æœ¬åœ°çš„ localStorage ä¸Šã€‚</p><p>å¯¹æ¥ paintdom ä¸ paintweb åæˆ‘ä»¬å¹¶ä¸ä¼šæ”¾å¼ƒç¦»çº¿ç¼–è¾‘çš„èƒ½åŠ›ï¼Œè€Œæ˜¯è¦èƒ½å¤Ÿåšåˆ°ï¼š</p><ul>\n<li>åœ¨æ–­ç½‘æƒ…å†µä¸‹ï¼Œè¡¨ç°ä¸ºä¸Šä¸€è®²æˆ‘ä»¬è¾¾åˆ°çš„æ•ˆæœï¼Œå¯ä»¥ç»§ç»­ç¦»çº¿ç¼–è¾‘å’Œä¿å­˜ï¼›</li>\n<li>ä¸€æ—¦è”ç½‘ï¼Œæ‰€æœ‰ç¦»çº¿ç¼–è¾‘çš„å†…å®¹å¯ä»¥è‡ªåŠ¨ä¿å­˜åˆ° paintdom æœåŠ¡å™¨ã€‚</li>\n</ul><h2>è®¡ç®—å˜æ›´</h2><p>å¬èµ·æ¥æŒºç®€å•ä¸€ä»¶äº‹æƒ…ï¼Ÿ</p><p>å…¶å®å¾ˆå¤æ‚ã€‚ç¬¬ä¸€ä»¶è¦åšçš„äº‹æƒ…æ˜¯ï¼šæ€ä¹ˆçŸ¥é“æ–­ç½‘åç¦»çº¿ç¼–è¾‘è¿‡çš„å†…å®¹æœ‰å“ªäº›ï¼Ÿ</p><p>æ€è·¯ä¸€æ˜¯ä¸ç®¡ä¸‰ä¸ƒäºŒåä¸€ï¼Œæ¯æ¬¡éƒ½å®Œæ•´ä¿å­˜æ•´ç¯‡æ–‡æ¡£ã€‚è¿™å¾ˆæµªè´¹ï¼Œå› ä¸ºä¸å•å•åˆšæ¢å¤è”ç½‘çš„æ—¶å€™æˆ‘ä»¬éœ€è¦ä¿å­˜æ–‡æ¡£ï¼Œå¹³å¸¸æ¯ä¸€æ¬¡ç¼–è¾‘æ“ä½œæˆ‘ä»¬ä¹Ÿéƒ½ä¼šè‡ªåŠ¨ä¿å­˜ä¿®æ”¹çš„å†…å®¹ã€‚</p><p>æ€è·¯äºŒæ˜¯è®°å½•å®Œæ•´çš„ç¼–è¾‘æ“ä½œå†å²ï¼Œæ¯åšä¸€ä¸ªç¼–è¾‘æ“ä½œéƒ½å°†å…¶è®°å½•åˆ° localStorageã€‚è¿™ä¸ªæ€è·¯çœ‹ä¼¼ä¼šæ›´èŠ‚çº¦ï¼Œä½†æ˜¯å®é™…ä¸Šåœ¨å¾ˆå¤šæƒ…å†µä¸‹ä¼šæ›´æµªè´¹ã€‚åŸå› åœ¨äºï¼š</p><ul>\n<li>ä¸€ä¸ªå¯¹è±¡ç¼–è¾‘å¤šæ¬¡ï¼Œä¼šæœ‰å¾ˆå¤šæ¡ç¼–è¾‘æ“ä½œçš„æŒ‡ä»¤è¦ä¿å­˜ï¼›</li>\n<li>æ–­ç½‘ä¹…äº†ï¼Œç¼–è¾‘æ“ä½œç´¯è®¡ä¸‹æ¥ï¼Œå…¶å­˜å‚¨ç©ºé—´ç”šè‡³å¯èƒ½è¶…è¿‡æ–‡æ¡£å¤§å°ã€‚</li>\n</ul><p>æ‰€ä»¥è¿™ç§æ–¹æ¡ˆç¼ºä¹å¾ˆå¥½çš„é²æ£’æ€§ï¼Œåœ¨ badcase æƒ…å†µä¸‹è®©äººéš¾ä»¥æ¥å—ã€‚</p><p>æ€è·¯ä¸‰æ˜¯ç»™å¯¹è±¡å¢åŠ ç‰ˆæœ¬å·ã€‚é€šè¿‡å¯¹æ¯”æ•´ä¸ªæ–‡æ¡£çš„åŸºç‰ˆæœ¬ï¼ˆbaseVerï¼Œå³ä¸Šä¸€æ¬¡åŒæ­¥å®Œæˆæ—¶çš„ç‰ˆæœ¬ï¼‰ï¼Œä¸æŸä¸ªå¯¹è±¡çš„ç‰ˆæœ¬ verã€‚å¦‚æœ ver &gt; baseVerï¼Œè¯´æ˜ä¸Šä¸€æ¬¡åŒæ­¥å®Œæˆåï¼Œè¯¥å¯¹è±¡å‘ç”Ÿäº†å˜æ›´ã€‚å®Œæ•´çš„å˜æ›´ä¿¡æ¯çš„è®¡ç®—é€»è¾‘å¦‚ä¸‹ï¼š</p><pre><code>prepareSync(baseVer) {\n  let shapeIDs = []\n  let changes = []\n  let shapes = this._shapes\n  for (let i in shapes) {\n    let shape = shapes[i]\n    if (shape.ver &gt; baseVer) {\n      changes.push(shape)\n    }\n    shapeIDs.push(shape.id)\n  }\n  let result = {\n    shapes: shapeIDs,\n    changes: changes,\n    ver: this.ver\n  }\n  this.ver++\n  return result\n}\n</code></pre><h2>åŒæ­¥å˜æ›´</h2><p>æœ‰äº†å˜æ›´çš„ä¿¡æ¯ï¼Œæ€ä¹ˆåŒæ­¥ç»™æœåŠ¡ç«¯ï¼Ÿ</p><p>ä¸€ä¸ªå¯èƒ½çš„æ€è·¯æ˜¯æŠŠå˜æ›´è¿˜åŸä¸ºä¸€æ¡æ¡ç¼–è¾‘æ“ä½œå‘ç»™æœåŠ¡ç«¯ã€‚ä½†æ˜¯ï¼Œè¿™æ ·åšé—®é¢˜ä¼šå¾ˆå¤æ‚ï¼Œå› ä¸ºè¿™äº›ç¼–è¾‘æ“ä½œä¸€éƒ¨åˆ†å‘é€æˆåŠŸï¼Œä¸€éƒ¨åˆ†å‘é€å¤±è´¥æ€ä¹ˆåŠï¼Ÿ</p><p>è¿™ç§éƒ¨åˆ†æˆåŠŸçš„ä¸­é—´æ€æ˜¯æœ€æŒ‘æˆ˜æˆ‘ä»¬ç¨‹åºå‘˜çš„ç¼–ç¨‹æ°´å¹³çš„ï¼Œå¾ˆçƒ§è„‘ã€‚</p><p>æˆ‘ä¸ªäººä¸€è´¯åšæŒçš„æ¶æ„å‡†åˆ™æ˜¯ä¸è¦çƒ§è„‘ã€‚å°¤å…¶å¯¹å¤§éƒ¨åˆ†éæ€§èƒ½æ•æ„Ÿçš„ä¸šåŠ¡ä»£ç ï¼Œç®€å•æ˜“äºå®æ–½ä¸ºç¬¬ä¸€åŸåˆ™ã€‚</p><p>æ‰€ä»¥æˆ‘ä»¬é€‰æ‹©äº†ä¿®æ”¹ç½‘ç»œåè®®ã€‚å¢åŠ äº†åŒæ­¥æ¥å£ï¼š</p><p><img src=\"https://static001.geekbang.org/resource/image/15/13/15b65c55fae904ca16ec6192ed81b613.png?wh=559*334\" alt=\"\"></p><p>è¿™å¾ˆæœ‰è¶£ã€‚åœ¨æˆ‘ä»¬è®¨è®ºç›¸äº’é…åˆçš„æ¥å£æ—¶ï¼Œæˆ‘ä»¬éå¸¸å°Šé‡ä¸šåŠ¡é€»è¾‘ï¼ŒæŒ‰ç…§æˆ‘ä»¬å¯¹ä¸šåŠ¡çš„ç†è§£ï¼Œå®šä¹‰äº†ä¸€ç³»åˆ—çš„ç¼–è¾‘æ“ä½œã€‚ä½†æ˜¯ï¼Œåˆ°æœ€åæˆ‘ä»¬å´å‘ç°ï¼Œå®ƒä»¬ç»Ÿç»Ÿä¸ç®¡ç”¨ï¼Œæˆ‘ä»¬è¦çš„æ˜¯ä¸€ä¸ªåŒæ­¥åè®®ã€‚</p><p>æ˜¯æœ€åˆæˆ‘ä»¬é”™äº†å—ï¼Ÿ</p><p>ä¹Ÿä¸èƒ½è¿™ä¹ˆè¯´ã€‚æœ€åˆæˆ‘ä»¬å®šä¹‰åè®®çš„é€»è¾‘å¹¶æ²¡æœ‰é”™ï¼Œåªæ˜¯æ²¡æœ‰è€ƒè™‘åˆ°æ”¯æŒç¦»çº¿ç¼–è¾‘è¿™æ ·çš„éœ€æ±‚è€Œå·²ã€‚</p><p>å¤ç›˜è¿™ä»¶äº‹æƒ…ï¼Œæˆ‘ä»¬å¯ä»¥è¿™ä¹ˆè¯´ï¼š</p><ul>\n<li>éœ€æ±‚çš„é¢„è§æ€§éå¸¸é‡è¦ã€‚å¦‚æœæˆ‘ä»¬æ²¡æœ‰å……åˆ†é¢„è§åˆ°éœ€æ±‚ï¼Œå¤§éƒ¨åˆ†æƒ…å†µä¸‹å°±ä¼šå› ä¸ºæˆ‘ä»¬ç¼ºä¹å¸‚åœºæ´å¯Ÿè€Œä¹°å•ï¼›</li>\n<li>è¿›ä¸€æ­¥è¯´æ˜ï¼ŒåŠæ—©æ¨å‡º Mockï¼Œè®©å‰ç«¯å¯ä»¥å¿«é€Ÿè¿­ä»£ï¼Œè¿›è€ŒåŠæ—©å»å‘ç°åŸå…ˆå®šä¹‰ç½‘ç»œåè®®çš„ä¸è¶³æ˜¯å¾ˆæœ‰å¿…è¦çš„ã€‚è¶Šæ™šåšå‡ºåè®®è°ƒæ•´ï¼Œäº‹æƒ…å°±è¶Šéš¾ï¼Œä¹Ÿè¶Šä½æ•ˆã€‚</li>\n</ul><p>æœ‰äº†åŒæ­¥åè®®ï¼Œæˆ‘ä»¬å°±å¯ä»¥æŠŠå˜æ›´ä¿¡æ¯åŒæ­¥ç»™æœåŠ¡ç«¯äº†ã€‚è¿™ä¸ªäº‹æƒ…æˆ‘ä»¬äº¤ç»™äº† QSynchronizer ç±»æ¥å®Œæˆï¼ˆè¯¦ç»†è¯·çœ‹ <a href=\"https://github.com/qiniu/qpaint/blob/v30/paintweb/www/dom.js#L204\">dom.js#L204</a>ï¼‰ã€‚</p><h2>åŠ è½½æ–‡æ¡£</h2><p>æŠŠå˜æ›´è¯¦ç»†æ¨é€ç»™æœåŠ¡ç«¯åï¼Œç†è®ºä¸Šæˆ‘ä»¬å°±å¯ä»¥åœ¨ä¸–ç•Œå„åœ°çœ‹åˆ°è¿™ç¯‡æ–‡æ¡£ã€‚</p><p>æ€ä¹ˆåšåˆ°ï¼Ÿ</p><p>æˆ‘ä»¬æ¥ä¸‹æ¥å°±è°ˆè°ˆæ€ä¹ˆæ¥åŠ è½½æ–‡æ¡£ã€‚è¿™ä¸ªè¿‡ç¨‹çš„éš¾ç‚¹åœ¨äºæ€ä¹ˆæ ¹æ®æœåŠ¡ç«¯è¿”å›çš„ json æ•°æ®é‡å»ºæ•´ä¸ªæ–‡æ¡£ã€‚</p><p>ä¸Šä¸€è®²æˆ‘ä»¬å·²ç»è¯´è¿‡ï¼Œæˆ‘ä»¬å›¾å½¢ï¼ˆShapeï¼‰çš„ç½‘ç»œåè®®ä¸­çš„æ•°æ®æ ¼å¼ï¼Œå’Œ localStorage ä¸­æ˜¯ä¸åŒçš„ã€‚è¿™æ„å‘³ç€æˆ‘ä»¬éœ€è¦åšä¸¤å¥—å›¾å½¢æ•°æ®çš„åŠ è½½å·¥ä½œã€‚</p><p>è¿™æŒºæ²¡æœ‰å¿…è¦ã€‚</p><p>è€Œä¸”ï¼Œä»é¢„æµ‹å˜æ›´çš„è§’åº¦ï¼Œæˆ‘ä»¬å¾ˆå®¹æ˜“é¢„æœŸçš„ä¸€ä¸ªå˜åŒ–ï¼Œå°±æ˜¯ç”»å›¾ç¨‹åºæ”¯æŒçš„å›¾å½¢ï¼ˆShapeï¼‰çš„ç§ç±»ä¼šè¶Šæ¥è¶Šå¤šã€‚</p><p>è¿™ä¸¤ä¸ªäº‹æƒ…æˆ‘ä»¬ä¸€èµ·çœ‹ã€‚ä¸ºæ­¤æˆ‘ä»¬åšäº†ä¸€æ¬¡é‡æ„ã€‚é‡æ„ç›®æ ‡æ˜¯ï¼š</p><ul>\n<li>ç»Ÿä¸€ localStorage å’Œç½‘ç»œåè®®ä¸­çš„å›¾å½¢è¡¨ç¤ºï¼›</li>\n<li>å¢åŠ æ–°çš„å›¾å½¢ç§ç±»è¦å¾ˆå®¹æ˜“ï¼Œä»£ç éå¸¸å†…èšï¼Œä¸å¿…åˆ°å¤„ä¿®æ”¹ä»£ç ã€‚</li>\n</ul><p>ä¸ºæ­¤æˆ‘ä»¬å¢åŠ  qshapes: QSerializer å…¨å±€å˜é‡ï¼Œå…è®¸å„ç§å›¾å½¢ç±»å‹æ³¨å†Œè‡ªå·±çš„åˆ›å»ºæ–¹æ³•ï¼ˆcreatorï¼‰è¿›å»ã€‚ç¤ºæ„ä»£ç å¦‚ä¸‹ï¼š</p><pre><code>qshapes.register(&quot;rect&quot;, function(json) {\n  return new QRect(json)\n})\n</code></pre><p>ä¸ºäº†æ”¯æŒ QSerializer ç±»ï¼ˆä»£ç å‚è§ <a href=\"https://github.com/qiniu/qpaint/blob/v30/paintweb/www/dom.js#L89\">dom.js#L89</a>ï¼‰ï¼Œæ¯ä¸ªå›¾å½¢éœ€è¦å¢åŠ ä¸¤ä¸ªæ–¹æ³•ï¼š</p><pre><code>interface Shape {\n  constructor(json: Object)\n  toJSON(): Object\n}\n</code></pre><p>è¿™æ ·æˆ‘ä»¬å°±å¯ä»¥è°ƒç”¨ qshapes.create(json) æ¥åˆ›å»ºä¸€ä¸ªå›¾å½¢å®ä¾‹ã€‚</p><p>æœ‰äº†è¿™ä¸ªèƒ½åŠ›ï¼Œæˆ‘ä»¬åŠ è½½æ–‡æ¡£å°±æ°´åˆ°æ¸ æˆäº†ï¼Œå…·ä½“ä»£ç è¯·å‚è€ƒ QPaintDoc ç±»çš„ _loadRemote(displayID) æ–¹æ³•ï¼ˆå‚è§ <a href=\"https://github.com/qiniu/qpaint/blob/v30/paintweb/www/dom.js#L690\">dom.js#L690</a>ï¼‰ã€‚</p><p>å®Œæ•´æ¥è¯´ï¼ŒåŠ è½½æ–‡æ¡£çš„åœºæ™¯åˆ†ä¸ºè¿™æ ·ä¸‰ç±»ï¼š</p><ul>\n<li>_loadBlankï¼Œå³åŠ è½½æ–°æ–‡æ¡£ã€‚åœ¨è”ç½‘æƒ…å†µä¸‹ï¼Œä¼šåœ¨æœåŠ¡ç«¯åˆ›å»ºä¸€ä¸ªæ–° drawingã€‚åœ¨éè”ç½‘æƒ…å†µä¸‹ï¼Œä¼šæœ¬åœ°åˆ›å»ºä¸€ä¸ªä¸´æ—¶æ–‡æ¡£ï¼ˆdisplayID ä»¥ t å¼€å¤´ï¼‰ã€‚</li>\n<li>_loadTempDocï¼Œå³åŠ è½½ä¸€ä¸ªä¸´æ—¶æ–‡æ¡£ã€‚å³è¯¥æ–‡æ¡£ä»åˆ›å»ºä¹‹åˆåˆ°ç›®å‰ï¼Œä¸€ç›´éƒ½å¤„äºç¦»çº¿ç¼–è¾‘çš„çŠ¶æ€ã€‚åŒæ ·å®ƒä¹Ÿåˆ†ä¸¤ä¸ªæƒ…å†µï¼Œå¦‚æœå½“å‰å¤„äºè”ç½‘çŠ¶æ€ä¸‹ï¼Œä¼šåœ¨æœåŠ¡ç«¯åˆ›å»ºä¸€ä¸ªæ–° drawingï¼Œå¹¶æŠŠå½“å‰çš„ç¦»çº¿ç¼–è¾‘çš„æ•°æ®åŒæ­¥è¿‡å»ã€‚å¦‚æœåœ¨éè”ç½‘çš„æƒ…å†µä¸‹ï¼Œä¼šåŠ è½½ç¦»çº¿ç¼–è¾‘çš„æ•°æ®ï¼Œå¹¶å¯ç»§ç»­ç¦»çº¿ç¼–è¾‘ã€‚</li>\n<li>_loadRemoteï¼Œå³åŠ è½½ä¸€ä¸ªè¿œç¨‹æ–‡æ¡£ã€‚è¯¥æ–‡æ¡£åœ¨æœ¬åœ°æœ‰å¯èƒ½ç¼–è¾‘è¿‡ï¼Œé‚£ä¹ˆä¼šå…ˆåŠ è½½æœ¬åœ°ç¼“å­˜çš„ç¦»çº¿ç¼–è¾‘çš„æ•°æ®ã€‚å¦‚æœå½“å‰å¤„äºè”ç½‘çŠ¶æ€ï¼Œä¼šå¼‚æ­¥åŠ è½½è¿œç¨‹æ–‡æ¡£ï¼ŒæˆåŠŸåæœ¬åœ°ç¦»çº¿ç¼–è¾‘çš„å†…å®¹ä¼šè¢«æ”¾å¼ƒã€‚</li>\n</ul><p>å¦å¤–ï¼ŒåŠ è½½æ–‡æ¡£ç»“æŸåï¼ŒQPaintDoc ä¼šå‘å‡º onload æ¶ˆæ¯ã€‚è¿™ä¸ªæ¶ˆæ¯å½“å‰ä¼šè¢« QPaintView å“åº”ï¼Œç”¨æ¥åˆ·æ–°ç•Œé¢ï¼Œä»£ç å¦‚ä¸‹ï¼š</p><pre><code>class QPaintView {\n  constructor() {\n    ...\n    let view = this\n    this.doc.onload = function() {\n      view.invalidateRect(null)\n    }\n    ...\n  }\n}\n</code></pre><p>ä¹‹æ‰€ä»¥ä¼šæœ‰ onload æ¶ˆæ¯ï¼Œæ˜¯å› ä¸ºå‘æœåŠ¡å™¨çš„ ajax è¯·æ±‚ï¼Œä»€ä¹ˆæ—¶å€™å®Œæˆæ˜¯æ¯”è¾ƒéš¾é¢„æœŸçš„ï¼Œæˆ‘ä»¬åŠ è½½æ–‡æ¡£æ˜¯åœ¨å¼‚æ­¥ ajax å®Œæˆä¹‹åã€‚è¿™æ ·æ¥çœ‹ï¼Œå®Œæˆæ–‡æ¡£åŠ è½½åå‘å‡º onload äº‹ä»¶ï¼Œå°±å¯ä»¥é¿å… Model å±‚éœ€è¦å»ç†è§£ View å±‚çš„ä¸šåŠ¡é€»è¾‘ã€‚</p><h2>Model å±‚çš„åšåº¦</h2><p>ä»‹ç»åˆ°è¿™é‡Œï¼Œæˆ‘ä»¬åŸºæœ¬ä¸ŠæŠŠæœ¬æ¬¡è¿­ä»£çš„ä¸»ä½“å†…å®¹ä»‹ç»æ¸…æ¥šäº†ã€‚å…¶ä»–æœ‰äº›å°ç»†èŠ‚çš„å˜åŠ¨ï¼Œæˆ‘ä»¬ä¸å†èµ˜è¿°ã€‚è¯¦ç»†çš„ä»£ç å˜æ›´è¯·å‚é˜…ï¼š</p><ul>\n<li><a href=\"https://github.com/qiniu/qpaint/compare/v29...v30\">https://github.com/qiniu/qpaint/compare/v29...v30</a></li>\n</ul><p>ä¸‹é¢æˆ‘æƒ³èŠçš„è¯é¢˜æ˜¯å…³äº Model å±‚çš„åšåº¦é—®é¢˜ã€‚æˆ‘ä»¬åœ¨ â€œ<a href=\"https://time.geekbang.org/column/article/105356\">22 | æ¡Œé¢ç¨‹åºçš„æ¶æ„å»ºè®®</a>â€ ä¸­æåˆ°ï¼š</p><blockquote>\n<p><span class=\"reference\">ä»ç•Œé¢ç¼–ç¨‹è§’åº¦çœ‹ï¼ŒModel å±‚è¶Šåšè¶Šå¥½ã€‚ä¸ºä»€ä¹ˆè¿™ä¹ˆè¯´ï¼Ÿå› ä¸ºè¿™æ˜¯å’Œæ“ä½œç³»ç»Ÿçš„ç•Œé¢ç¨‹åºæ¡†æ¶æœ€ä¸ºæ— å…³çš„éƒ¨åˆ†ï¼Œæ˜¯æœ€å®¹æ˜“æµ‹è¯•çš„éƒ¨åˆ†ï¼Œä¹ŸåŒæ—¶æ˜¯è·¨å¹³å°æœ€å®¹æ˜“çš„éƒ¨åˆ†ã€‚æˆ‘ä»¬æŠŠé€»è¾‘æ›´å¤šå‘ Model å±‚å€¾æ–œï¼Œé‚£ä¹ˆ Controller å±‚å°±ç®€æ´å¾ˆå¤šï¼Œè¿™å¯¹è·¨å¹³å°å¼€å‘å°†æå…¶æœ‰åˆ©ã€‚</span></p>\n</blockquote><p>æˆ‘ä»¬ç§‰æ‰¿çš„ç†å¿µæ˜¯ Model å±‚è¶Šåšè¶Šå¥½ã€‚äº‹å®ä¸Šåœ¨è¿™æ¬¡ â€œç”»å›¾â€ ç¨‹åºå®æˆ˜ä¸­ï¼Œæˆ‘ä»¬åœ¨ä¸€ç›´åšæŒè¿™ä¸€ç‚¹ã€‚è®©æˆ‘ä»¬æ¥è§‚æµ‹ä¸¤ç»„æ•°æ®ã€‚</p><p>å…¶ä¸€ï¼Œä¸åŒç‰ˆæœ¬ï¼ˆv26..v30ï¼‰çš„ Model å±‚ï¼ˆdom.jsï¼‰å¯¹æ¯”ï¼š</p><ul>\n<li>MVP ç‰ˆæœ¬ï¼ˆv26 ç‰ˆï¼‰çš„ <a href=\"https://github.com/qiniu/qpaint/blob/v26/paintweb/www/dom.js\">dom.js</a> ï¼Œçº¦ 120 è¡Œã€‚</li>\n<li>æœ€æ–°ç‰ˆæœ¬ï¼ˆv30 ç‰ˆï¼‰çš„ <a href=\"https://github.com/qiniu/qpaint/blob/v30/paintweb/www/dom.js\">dom.js</a> ï¼Œçº¦ 860 è¡Œã€‚</li>\n</ul><p>Model å±‚çš„ä»£ç è¡Œç¿»äº†å¤šå°‘å€ï¼Ÿ7.x å€ã€‚</p><p>å…¶äºŒï¼Œä¸åŒç‰ˆæœ¬ï¼ˆv26..v30ï¼‰çš„å˜æ›´å†å²ï¼š</p><p>v27ï¼š<a href=\"https://github.com/qiniu/qpaint/compare/v26...v27\">https://github.com/qiniu/qpaint/compare/v26...v27</a></p><p><img src=\"https://static001.geekbang.org/resource/image/23/6f/23a102e16f26d278ef10a4938066fd6f.png?wh=1010*327\" alt=\"\"></p><p>v28ï¼š<a href=\"https://github.com/qiniu/qpaint/compare/v27...v28\">https://github.com/qiniu/qpaint/compare/v27...v28</a></p><p><img src=\"https://static001.geekbang.org/resource/image/1a/4d/1ab61e11c153a2b3b38bc90bf1006c4d.png?wh=1007*210\" alt=\"\"></p><p>v29ï¼š<a href=\"https://github.com/qiniu/qpaint/compare/v28...v29\">https://github.com/qiniu/qpaint/compare/v28...v29</a></p><p><img src=\"https://static001.geekbang.org/resource/image/74/ab/74032dc7ab390189f3be591c13dad2ab.png?wh=1003*316\" alt=\"\"></p><p>v30ï¼š<a href=\"https://github.com/qiniu/qpaint/compare/v29...v30\">https://github.com/qiniu/qpaint/compare/v29...v30</a></p><p><img src=\"https://static001.geekbang.org/resource/image/f4/b7/f4715e1055c75bbdf1b9d21bb89496b7.png?wh=998*279\" alt=\"\"></p><p>ä¸çŸ¥é“ä½ çœ‹å‡ºä»€ä¹ˆæ¥äº†å—ï¼Ÿ</p><p>ä¸€ä¸ªæœ‰è¶£çš„äº‹å®æ˜¯ï¼Œå¤šä¸ªç‰ˆæœ¬çš„è¿­ä»£ï¼ŒåŸºæœ¬ä¸Šéƒ½æ˜¯ä»¥å˜æ›´ Model å±‚ä¸ºå¤šã€‚v29 ç‰ˆæœ¬çš„å˜æ›´çœ‹ä¼¼æ¯”è¾ƒä¾‹å¤–ï¼Œæ²¡æœ‰ä¿®æ”¹ dom.jsã€‚ä½†æ˜¯å®é™…ä¸Š v29 æ•´ä¸ªå˜æ›´éƒ½æ˜¯ Model å±‚çš„å˜æ›´ï¼Œå› ä¸ºæ˜¯å¢åŠ äº†æœåŠ¡ç«¯çš„ Modelï¼ˆæˆ‘ä»¬å‰é¢æŠŠå®ƒå«åš Multi-User Modelï¼‰ã€‚</p><p>æˆ‘ä»¬æ·±åˆ»æ€è€ƒè¿™ä¸ªé—®é¢˜çš„è¯ï¼Œæˆ‘ä»¬ä¼šæœ‰è¿™æ ·ä¸€ä¸ªæ¨è®ºï¼š</p><ul>\n<li>å¦‚æœæˆ‘ä»¬ä¸æ˜¯è®© Model å±‚ä»£ç ä»¥å†…èšçš„æ–¹å¼æ”¾åœ¨ä¸€èµ·ï¼Œè€Œæ˜¯è®©å®ƒè‡ªç”±çš„æ•£è½äºå„å¤„ï¼Œé‚£ä¹ˆæˆ‘ä»¬çš„ä»£ç å˜æ›´è´¨é‡ä¼šéå¸¸ä¸å—æ§ã€‚</li>\n</ul><p>ä¸ºä»€ä¹ˆï¼ŸModel å±‚æ€»ä½“æ¥è¯´æ˜¯æœ€å®¹æ˜“æµ‹è¯•çš„ï¼Œå› ä¸ºå®ƒçš„ç¯å¢ƒä¾èµ–æœ€å°ã€‚å¦‚æœè¿™äº›ä»£ç è¢«åˆ†æ•£åˆ° Viewã€Controller å±‚ä¸­ï¼Œä»£ç çš„é˜…è¯»éš¾åº¦ã€ç»´æŠ¤éš¾åº¦ã€æµ‹è¯•çš„éš¾åº¦éƒ½ä¼šå¤§å¹…å¢åŠ ã€‚</p><p>é€šè¿‡å‡ è½®çš„åŠŸèƒ½è¿­ä»£ï¼Œæˆ‘ä»¬å¯¹ Model å±‚çš„è®¤çŸ¥åœ¨ä¸æ–­çš„åŠ æ·±ã€‚æˆ‘ä»¬æ€»ç»“ä¸€ä¸‹å®ƒçš„èŒè´£ï¼Œå¦‚ä¸‹ï¼š</p><ul>\n<li>ä¸šåŠ¡é€»è¾‘ï¼Œå¯¹å¤–æš´éœ²ä¸šåŠ¡æ¥å£ã€‚å®ƒä¹Ÿæ˜¯ Model çš„æœ€æœ¬èŒçš„å·¥ä½œã€‚</li>\n<li>å®ç° View å±‚å§”æ‰˜çš„ onpaint äº‹ä»¶ï¼Œå®Œæˆç»˜åˆ¶åŠŸèƒ½ã€‚</li>\n<li>å®ç° Controller å±‚çš„ hitTest æ¥å£ï¼Œç”¨æ¥å®ç° selection æ”¯æŒã€‚</li>\n<li>å®ç°ä¸æœåŠ¡ç«¯ Multi-User Model å±‚çš„é€šè®¯ï¼ŒViewã€Controllers ç»„ä»¶éƒ½ä¸éœ€è¦æ„ŸçŸ¥æœåŠ¡ç«¯ã€‚</li>\n<li>å®ç°ç¦»çº¿ç¼–è¾‘ localStorage çš„å­˜å–ã€‚</li>\n</ul><p>é™¤äº†å°‘é‡ Viewï¼ˆonpaintï¼‰ã€Controllersï¼ˆhitTestï¼‰çš„éœ€æ±‚ï¼Œå¤§éƒ¨åˆ†éƒ½æ˜¯ Model å±‚çš„æ­£å¸¸ä¸šåŠ¡èŒƒç•´ã€‚</p><p>è¿™äº›èŒè´£å·²ç»å¾ˆå¤šï¼Œæ‰€ä»¥ Model å±‚è‡ªç„¶ä¼šèƒ–ã€‚</p><h2>ç»“è¯­</h2><p>ä»Šå¤©æˆ‘ä»¬å®Œæˆäº†ç”»å›¾ç¨‹åºå‰åç«¯ paintdomã€paintweb çš„å¯¹æ¥ã€‚ç”±äºè€ƒè™‘æ”¯æŒç¦»çº¿ç¼–è¾‘ï¼Œå¯¹æ¥å·¥ä½œæœ‰è¾ƒå¤§çš„å¤æ‚æ€§ï¼Œä½ å¦‚æœä¸èƒ½ç†è§£ï¼Œå»ºè®®ä»”ç»†å¯¹ä»£ç è¿›è¡Œç ”è¯»ã€‚å½“ç„¶åé¢æˆ‘ä»¬è¿˜ä¼šæ°å¼€æ¥ç»†è°ˆè¿™ä¸ªæ¡ˆä¾‹ã€‚</p><p>è¿™æ˜¯æœ€æ–°ç‰ˆæœ¬çš„æºä»£ç ï¼š</p><ul>\n<li><a href=\"https://github.com/qiniu/qpaint/tree/v30\">https://github.com/qiniu/qpaint/tree/v30</a></li>\n</ul><p>åˆ°è¿™é‡Œæˆ‘ä»¬çš„å®æˆ˜è¿‡ç¨‹å°±å…ˆå‘Šä¸€æ®µè½äº†ã€‚</p><p>å¦‚æœä½ å¯¹ä»Šå¤©çš„å†…å®¹æœ‰ä»€ä¹ˆæ€è€ƒä¸è§£è¯»ï¼Œæ¬¢è¿ç»™æˆ‘ç•™è¨€ï¼Œæˆ‘ä»¬ä¸€èµ·è®¨è®ºã€‚åˆ°ç°åœ¨ä¸ºæ­¢ï¼Œæˆ‘ä»¬æ¢è®¨çš„éƒ½æ˜¯ä¸€ä¸ªå®Œæ•´çš„æ¡Œé¢åº”ç”¨ç¨‹åºï¼ˆå¯èƒ½æ˜¯å•æœºçš„ï¼Œä¹Ÿå¯èƒ½æ˜¯ B/S ç»“æ„çš„ï¼‰çš„ä¸šåŠ¡æ¶æ„ã€‚</p><p>ä¸‹ä¸€è®²æˆ‘ä»¬ä¼šè°ˆè°ˆè¾…åŠ©ç•Œé¢å…ƒç´ ï¼ˆè‡ªå®šä¹‰æ§ä»¶ï¼‰çš„æ¶æ„è®¾è®¡ï¼Œå®ƒå’Œåº”ç”¨ç¨‹åºçš„ä¸šåŠ¡æ¶æ„è€ƒè™‘çš„é—®é¢˜é¢‡æœ‰ä¸åŒã€‚</p><p>è¯å¤–ï¼šæŒ‰ç…§å¤§çº²ï¼Œå½“å‰è¿›åº¦è¿˜åªæœ‰ 1/3 çš„å†…å®¹ã€‚çœ‹èµ·æ¥æˆ‘ä»¬æœ€ç»ˆä¼šæ¯”åŸè®¡åˆ’çš„ 58 è®²è¶…å‡ºä¸å°‘ï¼Œå¯èƒ½è¦å¾€ 90 è®²å»äº†ã€‚å…³äºè¿™ä¸€ç‚¹ï¼Œæˆ‘æ€»ä½“è¿˜æ˜¯ä»¥è¯´æ¸…æ¥šäº‹æƒ…ä¸ºç›®æ ‡ï¼Œåœ¨èŠçš„è¿‡ç¨‹ä¼šæ ¹æ®åé¦ˆä½œå‡ºé€‚å½“çš„è°ƒæ•´ã€‚</p><p>å¦‚æœä½ è§‰å¾—æœ‰æ‰€æ”¶è·ï¼Œä¹Ÿæ¬¢è¿æŠŠæ–‡ç« åˆ†äº«ç»™ä½ çš„æœ‹å‹ã€‚æ„Ÿè°¢ä½ çš„æ”¶å¬ï¼Œæˆ‘ä»¬ä¸‹æœŸå†è§ã€‚</p>","neighbors":{"left":{"article_title":"29 | å®æˆ˜ï¼ˆå››ï¼‰ï¼šæ€ä¹ˆè®¾è®¡ä¸€ä¸ªâ€œç”»å›¾â€ç¨‹åºï¼Ÿ","id":111289},"right":{"article_title":"31 | è¾…åŠ©ç•Œé¢å…ƒç´ çš„æ¶æ„è®¾è®¡","id":113569}},"comments":[{"had_liked":false,"id":119870,"user_name":"fy","can_delete":false,"product_type":"c1","uid":1152186,"ip_address":"","ucode":"EDB661C3A05910","user_header":"http://thirdwx.qlogo.cn/mmopen/vi_32/jsMMDDzhbsTzhicsGZiaeV0PWSnAS0fBlb1r6CsuB32vr3hRwV9UubmfHQx45v7jtaXajPlQ8kQ17b3zpQzHmqVw/132","comment_is_top":false,"comment_ctime":1564715628,"is_pvip":false,"discussion_count":1,"race_medal":0,"score":"259262753388","product_id":100025201,"comment_content":"çœ‹åˆ°æœ€åä¸€å¥è¯´æ¸…æ¥šäº‹æƒ…ä¸ºç›®æ ‡ï¼Œè€Œä¸æ˜¯é™åˆ¶åœ¨å‡ è®²ï¼Œå¤§å¤§ç‚¹ä¸ªèµï¼ï¼ï¼ï¼ï¼ï¼<br>","like_count":61,"discussions":[{"author":{"id":1142377,"avatar":"https://static001.geekbang.org/account/avatar/00/11/6e/69/8ed686c7.jpg","nickname":"æ‘©ç¾¯è¡Œåƒ§","note":"","ucode":"4B481F8B1ED7B6","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":3753,"discussion_content":"æ˜¯å‘€ï¼Œå¿…é¡»ç‚¹èµã€‚æœ¬æ¥æ‹…å¿ƒè¿™æ ·è®²ä¸‹å»æŒ‰ç…§å¤§çº²åé¢æ˜¯ä¸æ˜¯è®²ä¸å®Œäº†ï¼Œç°åœ¨å¿§è™‘ç¬é—´æ‰“æ¶ˆ","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1564760754,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":119972,"user_name":"Peiel","can_delete":false,"product_type":"c1","uid":1013762,"ip_address":"","ucode":"B10301B05B8507","user_header":"https://static001.geekbang.org/account/avatar/00/0f/78/02/abb7bfe3.jpg","comment_is_top":false,"comment_ctime":1564742080,"is_pvip":false,"replies":[{"id":"44054","content":"å­¦ä¹ ä¸€ä¸‹ä¼šå¥½ä¸€ç‚¹ã€‚goå…¥é—¨ä¸éš¾ï¼Œä¸€å‘¨å°±å¤Ÿäº†ã€‚","user_name":"ä½œè€…å›å¤","user_name_real":"è®¸å¼ä¼Ÿ-ä¸ƒç‰›äº‘(å·²æ»¡)","uid":"1228022","ctime":1564747901,"ip_address":"","comment_id":119972,"utype":1}],"discussion_count":2,"race_medal":0,"score":"35924480448","product_id":100025201,"comment_content":"è€å¸ˆï¼Œæˆ‘è‡ªå·±å¹³æ—¶æ¥è§¦çš„æ¯”è¾ƒå¤šçš„è¯­è¨€æ˜¯Javaã€Pythonã€Cã€JSä¸€ç±»çš„ï¼Œçœ‹åˆ°è¯¾ç¨‹ç”¨åˆ°Goè¯­è¨€è¶Šæ¥è¶Šå¤šï¼Œæˆ‘æ˜¯ä¸æ˜¯éœ€è¦å­¦ä¹ ä¸‹Goçš„ä¸€äº›åŸºæœ¬è¯­æ³•å’ŒåŸºç¡€æ‰æœ‰åˆ©äºåç»­çŸ¥è¯†çš„å¸æ”¶ï¼Ÿ","like_count":9,"discussions":[{"author":{"id":1228022,"avatar":"https://static001.geekbang.org/account/avatar/00/12/bc/f6/e61d4b8f.jpg","nickname":"è®¸å¼ä¼Ÿ-ä¸ƒç‰›äº‘(å·²æ»¡)","note":"","ucode":"1A2F8AA6F6DB54","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":461156,"discussion_content":"å­¦ä¹ ä¸€ä¸‹ä¼šå¥½ä¸€ç‚¹ã€‚goå…¥é—¨ä¸éš¾ï¼Œä¸€å‘¨å°±å¤Ÿäº†ã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1564747901,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1023040,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/9c/40/6323850e.jpg","nickname":"Jian","note":"","ucode":"358133EC2AFEB0","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":3844,"discussion_content":"æˆ‘å¼€å§‹å›å¤´çœ‹æ‚¨çš„â€œç”»å›¾â€ç¨‹åºï¼Œæ„Ÿè§‰å®ƒçš„æœ€ç»ˆå¿ƒæ€ç±»ä¼¼äºgoogle docæˆ–æ˜¯çŸ³å¢¨æ–‡æ¡£ï¼ˆå½“ç„¶viewæ˜¯ä¸ä¸€æ ·çš„ï¼Œå†…éƒ¨æœºåˆ¶ä¹Ÿå·®åˆ«å¾ˆå¤§ï¼‰ã€‚å¦‚æœä¸€ä¸Šæ¥å°±ç»™å‡ºè¿™ä¸ªç¨‹åºæœ€ç»ˆå½¢æ€çš„ä¸€ä¸ªè®¾æƒ³ï¼Œé‚£ä¹ˆè¯»è¿™ç³»åˆ—æ–‡ç« æ—¶ï¼Œå­¦ç”Ÿå°±ä¼šæ›´æœ‰çš„æ”¾çŸ¢ï¼Œä¹Ÿå¯ä»¥è¯„ä¼°ä¸‹è‡ªå·±é¢„æƒ³çš„mvpç‰ˆï¼Œmockç‰ˆï¼Œä»¥åŠåŠŸèƒ½æ¨¡å—åˆ’åˆ†æ˜¯å¦å’Œè€å¸ˆçš„æš—åˆã€‚è¿™æ˜¯æˆ‘ç°åœ¨çš„æƒ³æ³•ã€‚å› ä¸ºæˆ‘åœ¨çœ‹å‰é¢æ–‡ç« æ—¶å€™ï¼Œæ€»æœ‰ç§åªè§æ ‘æœ¨ä¸è§æ£®æ—çš„æ„Ÿè§‰ï¼ˆå½“ç„¶ï¼Œä¹Ÿå¯èƒ½æ˜¯æˆ‘æ¯”è¾ƒlow ï¼šï¼‰ï¼‰","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1564877136,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":119853,"user_name":"æœ‰é“­","can_delete":false,"product_type":"c1","uid":1046302,"ip_address":"","ucode":"2C7CB36CA5C04C","user_header":"http://thirdwx.qlogo.cn/mmopen/vi_32/3XbCueYYVWTiclv8T5tFpwiblOxLphvSZxL4ujMdqVMibZnOiaFK2C5nKRGv407iaAsrI0CDICYVQJtiaITzkjfjbvrQ/132","comment_is_top":false,"comment_ctime":1564713183,"is_pvip":false,"replies":[{"id":"44021","content":"åé¢åœ¨å¸¸è§æ¶æ„èŒƒå¼ä¸­ä¼šè®¨è®ºundo&#47;redo","user_name":"ä½œè€…å›å¤","user_name_real":"è®¸å¼ä¼Ÿ-ä¸ƒç‰›äº‘(å·²æ»¡)","uid":"1228022","ctime":1564722546,"ip_address":"","comment_id":119853,"utype":1}],"discussion_count":1,"race_medal":0,"score":"14449615071","product_id":100025201,"comment_content":"è€å¸ˆï¼Œè®¡ç®—å˜æ›´é‡Œï¼Œå¦‚æœæŒ‰æ–¹æ¡ˆ3ï¼Œç‰ˆæœ¬å¯¹æ¯”ï¼Œä¸è®°å½•ç¼–è¾‘æ“ä½œå†å²ï¼Œæ€ä¹ˆå®ç°(ç¦»çº¿ä¸‹çš„)å›æ’¤åŠŸèƒ½å‘¢","like_count":4,"discussions":[{"author":{"id":1228022,"avatar":"https://static001.geekbang.org/account/avatar/00/12/bc/f6/e61d4b8f.jpg","nickname":"è®¸å¼ä¼Ÿ-ä¸ƒç‰›äº‘(å·²æ»¡)","note":"","ucode":"1A2F8AA6F6DB54","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":461098,"discussion_content":"åé¢åœ¨å¸¸è§æ¶æ„èŒƒå¼ä¸­ä¼šè®¨è®ºundo/redo","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1564722546,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":156623,"user_name":"Lrwin","can_delete":false,"product_type":"c1","uid":1180503,"ip_address":"","ucode":"5E394E36419C56","user_header":"https://static001.geekbang.org/account/avatar/00/12/03/57/31595f22.jpg","comment_is_top":false,"comment_ctime":1574926145,"is_pvip":false,"replies":[{"id":"60134","content":"ğŸ‘","user_name":"ä½œè€…å›å¤","user_name_real":"è®¸å¼ä¼Ÿ-ä¸ƒç‰›äº‘(å·²æ»¡)","uid":"1228022","ctime":1574936272,"ip_address":"","comment_id":156623,"utype":1}],"discussion_count":1,"race_medal":0,"score":"10164860737","product_id":100025201,"comment_content":"Modelä»£è¡¨ä¸šåŠ¡æ ¸å¿ƒé€»è¾‘ï¼Œå¦‚æœä¸æ˜¯ä¸šåŠ¡å‘ç”Ÿé¢ è¦†æ€§å˜åŒ–ï¼ŒModelå±‚åº”è¯¥æ˜¯å¾ˆç¨³å®šçš„<br>è‡³äºè°ƒç”¨Modelå±‚çš„è°ƒç”¨è€…æ¥è¯´ï¼Œéƒ½æ˜¯åœ¨ç”¨ä¸åŒçš„æ–¹å¼ä½“ç°éœ€æ±‚(æ¯”å¦‚Rest&#47;controlleræˆ–è€…view)<br>è¿˜æœ‰ä¸€äº›æŠ€æœ¯ç”¨äºæ”¯æŒModelï¼Œæ¯”å¦‚Modelè¦ç”¨åˆ°çš„åŸºç¡€ç»„ä»¶(å¯ä»¥è¿›è¡Œä¾èµ–å¯¼è‡´DIï¼Œè®©ä¾èµ–ç¿»è½¬)<br><br>ä½¿ç”¨ä¸Šè¿°ä¸¤ä¸ªæ­¥éª¤ï¼Œåˆ™å°±å°†Modelå±‚è®¾è®¡ä¸ºæœ€ç¨³å®šçš„æ ¸å¿ƒå±‚äº†ã€‚","like_count":3,"discussions":[{"author":{"id":1228022,"avatar":"https://static001.geekbang.org/account/avatar/00/12/bc/f6/e61d4b8f.jpg","nickname":"è®¸å¼ä¼Ÿ-ä¸ƒç‰›äº‘(å·²æ»¡)","note":"","ucode":"1A2F8AA6F6DB54","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":476174,"discussion_content":"ğŸ‘","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1574936272,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":125244,"user_name":"Geek_88604f","can_delete":false,"product_type":"c1","uid":1501234,"ip_address":"","ucode":"33DD1318E53814","user_header":"","comment_is_top":false,"comment_ctime":1566130124,"is_pvip":false,"replies":[{"id":"46006","content":"ğŸ‘","user_name":"ä½œè€…å›å¤","user_name_real":"è®¸å¼ä¼Ÿ-ä¸ƒç‰›äº‘(å·²æ»¡)","uid":"1228022","ctime":1566172070,"ip_address":"","comment_id":125244,"utype":1}],"discussion_count":1,"race_medal":0,"score":"10156064716","product_id":100025201,"comment_content":"ç›¸å¯¹äºjavaæŠ€æœ¯æ ˆå®ç°çš„äº‘æœåŠ¡æ¥è¯´ï¼Œmulti-userç›¸å½“äºäº‘æœåŠ¡çš„åå°ï¼ˆservice managerï¼‰ï¼›session-based modelç›¸å½“äºäº‘æœåŠ¡çš„å‰å°ï¼ˆconsoleï¼‰ï¼Œå‰å°æœ‰å‰å°çš„é€»è¾‘å¤„ç†ï¼Œé€šå¸¸ä¹Ÿä¼šè°ƒç”¨åå°æä¾›çš„APIï¼›session-based view modelç›¸å½“äºé™æ€æœåŠ¡å™¨ä¸Šçš„èµ„æºã€‚ä¸çŸ¥é“è¿™æ ·ç†è§£å¯¹ä¸å¯¹ï¼Œè®¸è€å¸ˆï¼Ÿ","like_count":3,"discussions":[{"author":{"id":1228022,"avatar":"https://static001.geekbang.org/account/avatar/00/12/bc/f6/e61d4b8f.jpg","nickname":"è®¸å¼ä¼Ÿ-ä¸ƒç‰›äº‘(å·²æ»¡)","note":"","ucode":"1A2F8AA6F6DB54","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":463493,"discussion_content":"ğŸ‘","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1566172070,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":120390,"user_name":"Jian","can_delete":false,"product_type":"c1","uid":1023040,"ip_address":"","ucode":"358133EC2AFEB0","user_header":"https://static001.geekbang.org/account/avatar/00/0f/9c/40/6323850e.jpg","comment_is_top":false,"comment_ctime":1564877848,"is_pvip":false,"replies":[{"id":"44186","content":"ç°åœ¨ä¸åŒç‰ˆæœ¬æ˜¯ä¸åŒçš„åˆ†æ”¯ï¼ˆbranchï¼‰","user_name":"ä½œè€…å›å¤","user_name_real":"è®¸å¼ä¼Ÿ-ä¸ƒç‰›äº‘(å·²æ»¡)","uid":"1228022","ctime":1564897165,"ip_address":"","comment_id":120390,"utype":1}],"discussion_count":1,"race_medal":0,"score":"5859845144","product_id":100025201,"comment_content":"ä¸€ä¸ªé—ªå¿µï¼šå³å¦‚æœæ‚¨åœ¨å°†æ¥çš„è¯¾ç¨‹ä¸­ï¼Œä¸ºä¸åŒçš„ç‰ˆæœ¬æ‰“ä¸Šç›¸åº”çš„tagï¼Œè¿™æ ·æ˜¯å¦æ›´æ˜“æ‡‚ï¼Ÿæ€»ä¹‹ï¼Œæ‚¨çœŸçš„æ˜¯è¾›è‹¦å•¦ï¼æˆ‘ä»¬ä¹Ÿä¸å¥½å¤ªå¤šè¦æ±‚ç»™æ‚¨ã€‚","like_count":1,"discussions":[{"author":{"id":1228022,"avatar":"https://static001.geekbang.org/account/avatar/00/12/bc/f6/e61d4b8f.jpg","nickname":"è®¸å¼ä¼Ÿ-ä¸ƒç‰›äº‘(å·²æ»¡)","note":"","ucode":"1A2F8AA6F6DB54","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":461314,"discussion_content":"ç°åœ¨ä¸åŒç‰ˆæœ¬æ˜¯ä¸åŒçš„åˆ†æ”¯ï¼ˆbranchï¼‰","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1564897165,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":120262,"user_name":"å…«å“¥","can_delete":false,"product_type":"c1","uid":1012205,"ip_address":"","ucode":"ED2E09CBBFC060","user_header":"https://static001.geekbang.org/account/avatar/00/0f/71/ed/45ab9f03.jpg","comment_is_top":false,"comment_ctime":1564816510,"is_pvip":false,"discussion_count":0,"race_medal":1,"score":"5859783806","product_id":100025201,"comment_content":"å¤§å¤šæ•°ç¨‹åºå‘˜å’Œäº§å“ç»ç†å¯¹å•ç‚¹ç™»å½•ç†è§£ä¸æ¸…æ¥šï¼Œè¿™ä¸ªå¯ä»¥åŠ ä¸€è®²ã€‚","like_count":1},{"had_liked":false,"id":120028,"user_name":"Charles","can_delete":false,"product_type":"c1","uid":1001410,"ip_address":"","ucode":"32646D78CC0389","user_header":"https://static001.geekbang.org/account/avatar/00/0f/47/c2/e9fa4cf6.jpg","comment_is_top":false,"comment_ctime":1564758040,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"5859725336","product_id":100025201,"comment_content":"æœ€è¿‘ä¸€ç›´ç”¨PHPçš„Laravelæ¡†æ¶å†™åº”ç”¨ï¼Œå› ä¸ºå®ƒçš„ORMå°è£…çš„å¤Ÿç®€å•ï¼Œæ‰€ä»¥ä¹‹å‰åŸºæœ¬æŠŠæ‰€æœ‰ä¸šåŠ¡é€»è¾‘å’Œæ•°æ®åº“æ“ä½œéƒ½æ”¾åœ¨controllerä¸­ï¼Œæœ€è¿‘ç”¨äº†ä»“åº“æ¨¡å¼æ‹†å¼€äº†ä¸šåŠ¡é€»è¾‘ï¼Œæ”¾åˆ°äº†modelä¸€ä¾§ã€‚<br><br>è¿™ä¸€èŠ‚è®¸è€å¸ˆæ€»ç»“modelåšåº¦çš„é—®é¢˜ï¼Œå‘ç°å¦‚å‡ºä¸€è¾™ï¼ŒçœŸå‘ç°å¤ç”¨é€»è¾‘å’Œæµ‹è¯•è¿™ä¸¤ä»¶äº‹æƒ…å˜çš„ç®€å•è®¸å¤šã€‚ä¹‹å‰å¥½å‡ ç« å®æˆ˜ç†è§£ç€æœ‰ç‚¹è´¹åŠ²ï¼Œå¥½åƒçªç„¶å˜çš„ç•¥æ‡‚äº†ï¼Œå›å¤´è¯»ä¸€è¯»ä»£ç ç†è§£ä¸‹å†å¤šç‚¹æ”¶è·ã€‚<br><br>å¦å¤–æœ€åçš„æ€»ç»“é‡Œâ€œä»¥è¯´æ¸…æ¥šäº‹æƒ…ä¸ºç›®æ ‡â€ï¼Œæ„Ÿè°¢è®¸è€å¸ˆçš„æå®¢ç²¾ç¥ã€‚","like_count":1},{"had_liked":false,"id":119816,"user_name":"xl000","can_delete":false,"product_type":"c1","uid":1117935,"ip_address":"","ucode":"6FEABE7F7D0DC0","user_header":"https://static001.geekbang.org/account/avatar/00/11/0e/ef/030e6d27.jpg","comment_is_top":false,"comment_ctime":1564707584,"is_pvip":false,"replies":[{"id":"43989","content":"model æ˜¯ä¸€ä¸ªæ•´ä½“ï¼Œå†…éƒ¨æ€ä¹ˆè®¾è®¡æ˜¯è¯¦ç»†è®¾è®¡é˜¶æ®µçš„äº‹æƒ…ï¼Œè¿™ä¸€ç« å…³æ³¨ç‚¹æš‚æ—¶è¿˜åªåœ¨å­ç³»ç»Ÿ&#47;æ¨¡å—è¾¹ç•Œä¸Šã€‚","user_name":"ä½œè€…å›å¤","user_name_real":"è®¸å¼ä¼Ÿ-ä¸ƒç‰›äº‘(å·²æ»¡)","uid":"1228022","ctime":1564709222,"ip_address":"","comment_id":119816,"utype":1}],"discussion_count":1,"race_medal":5,"score":"5859674880","product_id":100025201,"comment_content":"è€å¸ˆï¼Œæ‚¨ä¸€ç›´è¯´è¦èƒ–modelå±‚ï¼Œé‚£ä¹ˆmodelä¹‹é—´å¯ä»¥æœ‰ä¾èµ–å—ï¼Ÿæˆ‘æ˜¯åšæ¸¸æˆæœåŠ¡å™¨å¼€å‘çš„ï¼Œç°åœ¨çš„è®¾è®¡æ˜¯åœ¨modelå®ä¾‹é‡Œå¼±å¼•ç”¨ç€userå®ä¾‹ï¼Œé€šè¿‡userå®ä¾‹å¯ä»¥è·å–åˆ°å…¶ä»–modelï¼Œæ€»è§‰ç€ä¸å¤ªå¥½ï¼Œå¤ªèƒ–äº†ï¼Œæ‰€ä»¥æ”¹åå«moduleäº†ã€‚è€å¸ˆæœ‰ä»€ä¹ˆå¥½å»ºè®®å—ï¼Ÿ","like_count":1,"discussions":[{"author":{"id":1228022,"avatar":"https://static001.geekbang.org/account/avatar/00/12/bc/f6/e61d4b8f.jpg","nickname":"è®¸å¼ä¼Ÿ-ä¸ƒç‰›äº‘(å·²æ»¡)","note":"","ucode":"1A2F8AA6F6DB54","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":461084,"discussion_content":"model æ˜¯ä¸€ä¸ªæ•´ä½“ï¼Œå†…éƒ¨æ€ä¹ˆè®¾è®¡æ˜¯è¯¦ç»†è®¾è®¡é˜¶æ®µçš„äº‹æƒ…ï¼Œè¿™ä¸€ç« å…³æ³¨ç‚¹æš‚æ—¶è¿˜åªåœ¨å­ç³»ç»Ÿ/æ¨¡å—è¾¹ç•Œä¸Šã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1564709222,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":288519,"user_name":"ä¸æ¸©æš–å•Šä¸çº¯è‰¯","can_delete":false,"product_type":"c1","uid":2079117,"ip_address":"","ucode":"204474A214E00C","user_header":"https://static001.geekbang.org/account/avatar/00/1f/b9/8d/00bded19.jpg","comment_is_top":false,"comment_ctime":1618501516,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1618501516","product_id":100025201,"comment_content":"èƒ–åç«¯å’Œèƒ–å‰ç«¯å„è‡ªçš„ä¼˜ç¼ºç‚¹ã€‚<br>èƒ–åç«¯çš„ä¼˜ç‚¹å°±æ˜¯ï¼Œç›¸å¯¹æ›´ä¸ºå®‰å…¨ä¸€ç‚¹ï¼Œå› ä¸ºä»–çš„ä¸šåŠ¡æ•°æ®éƒ½åœ¨åç«¯ï¼Œåªæœ‰åœ¨è”ç½‘çš„æƒ…å†µä¸‹ï¼Œæ‰èƒ½å¤Ÿå¯¹æ•°æ®è¿›è¡Œè®¿é—®ï¼Œä¸”æˆ‘ä»¬å¯ä»¥åœ¨è®¿é—®ä¸Šåšé™åˆ¶ï¼Œæ¯”å¦‚é™åˆ¶è®¿é—®IPå’Œè®¿é—®æ¬¡æ•°ã€‚å› ä¸ºä¸»è¦çš„ä¸šåŠ¡å¤„ç†éƒ½åœ¨åç«¯è¿›è¡Œï¼Œåªè¦æä¾›ç»Ÿä¸€çš„æ•°æ®è®¿é—®æ¥å£ï¼Œå°±èƒ½æ¯”è¾ƒå®¹æ˜“çš„è·¨å¹³å°ã€‚ç¼ºç‚¹æ˜¯å¯¹ç¦»çº¿æ¨¡å¼ä¸å‹å¥½ã€‚<br><br>èƒ–å‰ç«¯ï¼Œç¬¬1ä¸ªä¼˜ç‚¹å°±æ˜¯å¤§å¤§å‡å°‘äº†å¯¹æœåŠ¡ç«¯çš„ä¾èµ–ï¼Œèƒ½å¤Ÿåœ¨ä¸è”ç½‘çš„æƒ…å†µä¸‹æ­£å¸¸ä½¿ç”¨ï¼Œç¼ºç‚¹å°±æ˜¯ä¸å¤Ÿå®‰å…¨ï¼Œç†è®ºä¸Šä»»ä½•èƒ½æ‰“å¼€æµè§ˆå™¨çš„äººï¼Œéƒ½èƒ½è·å–çœ‹åˆ°æˆ‘ä»¬çš„ä¸šåŠ¡ä»£ç ã€‚","like_count":0},{"had_liked":false,"id":223459,"user_name":"å¿†æ°‘","can_delete":false,"product_type":"c1","uid":1497815,"ip_address":"","ucode":"E66CEAD1E910C5","user_header":"http://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTJBHLqk9ofIib9pgboMKZhVCia28M3FTf45C1bPrvH5ctCDhfAqS6ia13fQtBWGafADFIQsttJ7rgXwg/132","comment_is_top":false,"comment_ctime":1591094913,"is_pvip":false,"replies":[{"id":"82383","content":"goé¡¹ç›®å¯åŠ¨åªéœ€è¦ go run *.go å°±è¡Œ","user_name":"ä½œè€…å›å¤","user_name_real":"è®¸å¼ä¼Ÿ-ä¸ƒç‰›äº‘(å·²æ»¡)","uid":"1228022","ctime":1591159640,"ip_address":"","comment_id":223459,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1591094913","product_id":100025201,"comment_content":"è€å¸ˆï¼Œè¿™é¡¹ç›®å¦‚ä½•è¿è¡Œèµ·æ¥ï¼Œèƒ½å¤Ÿç»™è¯´æ˜ä¸€ä¸‹å—ï¼Ÿè¿™ä¸ªé¡¹ç›®goæœåŠ¡å™¨å¦‚ä½•å¯åŠ¨ï¼Œè¿›è¡Œé¡¹ç›®çš„è°ƒè¯•ï¼Ÿè°¢è°¢","like_count":0,"discussions":[{"author":{"id":1228022,"avatar":"https://static001.geekbang.org/account/avatar/00/12/bc/f6/e61d4b8f.jpg","nickname":"è®¸å¼ä¼Ÿ-ä¸ƒç‰›äº‘(å·²æ»¡)","note":"","ucode":"1A2F8AA6F6DB54","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":497134,"discussion_content":"goé¡¹ç›®å¯åŠ¨åªéœ€è¦ go run *.go å°±è¡Œ","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1591159640,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":149680,"user_name":"milley","can_delete":false,"product_type":"c1","uid":1001175,"ip_address":"","ucode":"8C95F693644CDE","user_header":"https://static001.geekbang.org/account/avatar/00/0f/46/d7/00e99ebb.jpg","comment_is_top":false,"comment_ctime":1573316516,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1573316516","product_id":100025201,"comment_content":"çœ‹äº†å‡ éæ„Ÿè§‰è¶Šæ¥è¶Šæœ‰è¶£ï¼Œè¿˜å¾—å¤šçœ‹å‡ éæ¢³ç†ä¸‹è‡ªå·±çš„æ€è·¯ï¼ŒğŸ˜„","like_count":0},{"had_liked":false,"id":130000,"user_name":"é™ˆå››ä¸°","can_delete":false,"product_type":"c1","uid":1610789,"ip_address":"","ucode":"A4463BFD52FB4F","user_header":"https://static001.geekbang.org/account/avatar/00/18/94/25/3bf277e5.jpg","comment_is_top":false,"comment_ctime":1567349453,"is_pvip":true,"discussion_count":0,"race_medal":0,"score":"1567349453","product_id":100025201,"comment_content":"ä¸ªäººä½“ä¼šï¼Œå®æˆ˜â€œç”»å›¾â€ç¨‹åºè¿™å‡ è®²çš„æœ€å¤§é—®é¢˜æ˜¯é‡‡ç”¨äº†â€œéŸ³é¢‘â€ï¼Œè€Œä¸æ˜¯â€œè§†é¢‘â€ã€‚æ‰€ä»¥ï¼Œç†è§£èµ·æ¥éš¾åº¦å¾ˆå¤§ã€‚","like_count":0},{"had_liked":false,"id":127526,"user_name":"ç¬¨ç¬¨","can_delete":false,"product_type":"c1","uid":1005351,"ip_address":"","ucode":"6DA6DCAF6A7DCB","user_header":"https://static001.geekbang.org/account/avatar/00/0f/57/27/805786be.jpg","comment_is_top":false,"comment_ctime":1566733904,"is_pvip":true,"discussion_count":0,"race_medal":0,"score":"1566733904","product_id":100025201,"comment_content":"å¯¹è®¸è€å¸ˆçš„è®¤çœŸè´Ÿè´£ç‚¹èµï¼ï¼ï¼ç›¸ä¿¡å¾ˆå¤šåŒå­¦æ²¡æœ‰åŠæ—¶åé¦ˆåº”è¯¥è¿˜éƒ½åœ¨æ¶ˆåŒ–ä¸­ï¼Œåå¤ç ”ä¹ å","like_count":0},{"had_liked":false,"id":121105,"user_name":"ç¨‹åºå‘˜å°è·ƒ","can_delete":false,"product_type":"c1","uid":1015483,"ip_address":"","ucode":"25BB96E0791A60","user_header":"https://static001.geekbang.org/account/avatar/00/0f/7e/bb/947c329a.jpg","comment_is_top":false,"comment_ctime":1565059319,"is_pvip":true,"discussion_count":0,"race_medal":0,"score":"1565059319","product_id":100025201,"comment_content":"ç­‰åˆ°è€å¸ˆå…¨éƒ¨æ›´æ–°å®Œäº†ï¼Œæ‰æ¥çœ‹è¿™ä¸ªç”»å›¾ç¨‹åºï¼Œå…³é”®æ˜¯ä¸€éè¿˜ä¸å¤Ÿ","like_count":0},{"had_liked":false,"id":120743,"user_name":"å¼ ç™½æ°´","can_delete":false,"product_type":"c1","uid":1072821,"ip_address":"","ucode":"4F0057BFB5A7B3","user_header":"https://static001.geekbang.org/account/avatar/00/10/5e/b5/88d0754b.jpg","comment_is_top":false,"comment_ctime":1564987904,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1564987904","product_id":100025201,"comment_content":"çœ‹å¾—äº‘é‡Œé›¾é‡Œï¼Œä¸å¾—ä¸è¯´è®¸å¤§çš„ç¼–ç èƒ½åŠ›å’Œè®¾è®¡èƒ½åŠ›ç¡®å®ååˆ†ç¡¬æ ¸","like_count":0},{"had_liked":false,"id":120363,"user_name":"Jian","can_delete":false,"product_type":"c1","uid":1023040,"ip_address":"","ucode":"358133EC2AFEB0","user_header":"https://static001.geekbang.org/account/avatar/00/0f/9c/40/6323850e.jpg","comment_is_top":false,"comment_ctime":1564843804,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1564843804","product_id":100025201,"comment_content":"å…³äºæ‚¨æåˆ°çš„modelå±‚å˜åšï¼Œæˆ‘çš„ç†è§£ï¼šè¿™æ˜¯ç³»ç»Ÿè¿›åŒ–çš„å¿…ç„¶ã€‚æ˜¯å¦å¯ä»¥æƒ³è±¡ç³»ç»Ÿä¸­æ‰€æœ‰çš„æ“ä½œèµ·åˆéƒ½å…·å¤‡ä¸å¯åˆ†çš„åŸå­æ€§è´¨ï¼Œå…·å¤‡åŒæ ·å±æ€§ï¼ˆç½‘ç»œï¼Œæ“ä½œï¼Œç³»ç»Ÿï¼‰çš„æ“ä½œæ±‡é›†åˆ°ä¸€èµ·å½¢æˆä¸€ä¸ªç‹¬ç«‹çš„æ¨¡å—ã€‚åœ¨åŒä¸€æ¨¡å—å†…å¯èƒ½æ ¹æ®åŠŸèƒ½å†è¿›è¡Œåˆ’åˆ†ã€‚è¿™æ˜¯æˆ‘ç¬¬ä¸€æ¬¡å¬æ”¹è¯¾çš„æ„Ÿå—ã€‚æ‚¨çš„è¯¾ä¸å¬ä¸ªä¸‰éå·¦å³ï¼Œæ€»æœ‰ç†è§£ä¸åˆ°ä½çš„åœ°æ–¹ï¼Œä¸”è¿˜æ²¡æœ‰è¿›å…¥ä»£ç é˜¶æ®µï¼Œæ‰€ä»¥å¯èƒ½ç†è§£çš„æœ‰ç‚¹ä¸æˆç†Ÿã€‚<br>å¯¹äºæ‚¨æœ€åæåˆ°çš„è¯¾ç¨‹ä¼šå˜é•¿ï¼Œä½œä¸ºä¸€åå­¦ç”Ÿå¿…é¡»ç‚¹èµâ€”â€”æœ‰å¹¸é‡åˆ°æ‚¨è¿™æ ·è¿½æ±‚ç»†èŠ‚çš„è€å¸ˆã€‚å¦‚æœå°†è¿™é—¨è¯¾æ¯”åšå¼€å‘ä¸€å¥—ç³»ç»Ÿçš„è¯ï¼Œæ•´å¥—ç³»ç»Ÿåœ¨å¼€å‘æ¨è¿›çš„è¿‡ç¨‹ä¸­ï¼Œåœ¨ä¸æ–­è¿­ä»£å’Œå‡çº§ã€‚è°¢è°¢","like_count":0},{"had_liked":false,"id":119997,"user_name":"Aaron Cheung","can_delete":false,"product_type":"c1","uid":1079816,"ip_address":"","ucode":"03972759C53667","user_header":"https://static001.geekbang.org/account/avatar/00/10/7a/08/4d3e47dd.jpg","comment_is_top":false,"comment_ctime":1564748894,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1564748894","product_id":100025201,"comment_content":"è·ç›Šè‰¯å¤š æ‰“å¡30","like_count":0}]}