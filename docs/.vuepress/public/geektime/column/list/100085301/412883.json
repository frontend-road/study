{"id":412883,"title":"04｜get hands dirty：来写个实用的CLI小工具","content":"<p>你好，我是陈天。</p><p>在上一讲里，我们已经接触了 Rust 的基本语法。你是不是已经按捺不住自己的洪荒之力，想马上用 Rust 写点什么练练手，但是又发现自己好像有点“拔剑四顾心茫然”呢？</p><p>那这周我们就来玩个新花样，<strong>做一周“learning by example”的挑战</strong>，来尝试用 Rust 写三个非常有实际价值的小应用，感受下 Rust 的魅力在哪里，解决真实问题的能力到底如何。</p><p>你是不是有点担心，我才刚学了最基本语法，还啥都不知道呢，这就能开始写小应用了？那我碰到不理解的知识怎么办？</p><p>不要担心，因为你肯定会碰到不太懂的语法，但是，<strong>先不要强求自己理解，当成文言文抄写就可以了</strong>，哪怕这会不明白，只要你跟着课程节奏，通过撰写、编译和运行，你也能直观感受到 Rust 的魅力，就像小时候背唐诗一样。</p><p>好，我们开始今天的挑战。</p><h2>HTTPie</h2><p>为了覆盖绝大多数同学的需求，这次挑选的例子是工作中普遍会遇到的：写一个 CLI 工具，辅助我们处理各种任务。</p><p>我们就以实现 <a href=\"https://httpie.io/\">HTTPie</a> 为例，看看用 Rust 怎么做 CLI。HTTPie 是用 Python 开发的，一个类似 cURL 但对用户更加友善的命令行工具，它可以帮助我们更好地诊断 HTTP 服务。</p><p>下图是用 HTTPie 发送了一个 post 请求的界面，你可以看到，相比 cURL，它在可用性上做了很多工作，包括对不同信息的语法高亮显示：</p><!-- [[[read_end]]] --><p><img src=\"https://static001.geekbang.org/resource/image/e0/b7/e0f1238d1efe338a33f4bec5318a48b7.png?wh=1762x1130\" alt=\"图片\"></p><p>你可以先想一想，如果用你最熟悉的语言实现 HTTPie ，要怎么设计、需要用到些什么库、大概用多少行代码？如果用 Rust 的话，又大概会要多少行代码？</p><p>带着你自己的这些想法，开始动手用 Rust 构建这个工具吧！我们的目标是，<strong>用大约 200 行代码</strong>实现这个需求。</p><h3>功能分析</h3><p>要做一个 HTTPie 这样的工具，我们先梳理一下要实现哪些主要功能：</p><ul>\n<li>首先是做命令行解析，处理子命令和各种参数，验证用户的输入，并且将这些输入转换成我们内部能理解的参数；</li>\n<li>之后根据解析好的参数，发送一个 HTTP 请求，获得响应；</li>\n<li>最后用对用户友好的方式输出响应。</li>\n</ul><p>这个流程你可以再看下图：</p><p><img src=\"https://static001.geekbang.org/resource/image/8f/8c/8fa48ae6e8bd3de42cdf67be4ffb298c.jpg?wh=1920x1106\" alt=\"图片\"></p><p>我们来看要实现这些功能对应需要用到的库：</p><ul>\n<li>对于命令行解析，Rust 有很多库可以满足这个需求，我们今天使用官方比较推荐的 <a href=\"https://github.com/clap-rs/clap\">clap</a>。</li>\n<li>对于 HTTP 客户端，在上一讲我们已经接触过 <a href=\"https://github.com/seanmonstar/reqwest\">reqwest</a>，我们就继续使用它，只不过我们这次尝个鲜，使用它的异步接口。</li>\n<li>对于格式化输出，为了让输出像 Python 版本的 HTTPie 那样显得生动可读，我们可以引入一个命令终端多彩显示的库，这里我们选择比较简单的 <a href=\"https://github.com/mackwic/colored\">colored</a>。</li>\n<li>除此之外，我们还需要一些额外的库：用 anyhow 做错误处理、用 jsonxf 格式化 JSON 响应、用 mime 处理 mime 类型，以及引入 tokio 做异步处理。</li>\n</ul><h3>CLI 处理</h3><p>好，有了基本的思路，我们来创建一个项目，名字就叫 <code>httpie</code>：</p><pre><code class=\"language-bash\">cargo new httpie\ncd httpie\n</code></pre><p>然后，用 VSCode 打开项目所在的目录，编辑 Cargo.toml 文件，添加所需要的依赖（<strong>注意：以下代码用到了 beta 版本的 crate，可能未来会有破坏性更新，如果在本地无法编译，请参考 <a href=\"https://github.com/tyrchen/geektime-rust/tree/master/04_httpie\">GitHub repo</a> 中的代码</strong>）：</p><pre><code class=\"language-rust\">[package]\nname = \"httpie\"\nversion = \"0.1.0\"\nedition = \"2018\"\n\n[dependencies]\nanyhow = \"1\" # 错误处理\nclap = \"3.0.0-beta.4\" # 命令行解析\ncolored = \"2\" # 命令终端多彩显示\njsonxf = \"1.1\" # JSON pretty print 格式化\nmime = \"0.3\" # 处理 mime 类型\nreqwest = { version = \"0.11\", features = [\"json\"] } # HTTP 客户端\ntokio = { version = \"1\", features = [\"full\"] } # 异步处理库\n</code></pre><p>我们先在 main.rs 添加处理 CLI 相关的代码：</p><pre><code class=\"language-rust\">use clap::{AppSettings, Clap};\n\n// 定义 HTTPie 的 CLI 的主入口，它包含若干个子命令\n// 下面 /// 的注释是文档，clap 会将其作为 CLI 的帮助\n\n/// A naive httpie implementation with Rust, can you imagine how easy it is?\n#[derive(Clap, Debug)]\n#[clap(version = \"1.0\", author = \"Tyr Chen &lt;tyr@chen.com&gt;\")]\n#[clap(setting = AppSettings::ColoredHelp)]\nstruct Opts {\n    #[clap(subcommand)]\n    subcmd: SubCommand,\n}\n\n// 子命令分别对应不同的 HTTP 方法，目前只支持 get / post\n#[derive(Clap, Debug)]\nenum SubCommand {\n    Get(Get),\n    Post(Post),\n    // 我们暂且不支持其它 HTTP 方法\n}\n\n// get 子命令\n\n/// feed get with an url and we will retrieve the response for you\n#[derive(Clap, Debug)]\nstruct Get {\n    /// HTTP 请求的 URL\n    url: String,\n}\n\n// post 子命令。需要输入一个 URL，和若干个可选的 key=value，用于提供 json body\n\n/// feed post with an url and optional key=value pairs. We will post the data\n/// as JSON, and retrieve the response for you\n#[derive(Clap, Debug)]\nstruct Post {\n    /// HTTP 请求的 URL\n    url: String,\n    /// HTTP 请求的 body\n    body: Vec&lt;String&gt;,\n}\n\nfn main() {\n    let opts: Opts = Opts::parse();\n    println!(\"{:?}\", opts);\n} \n</code></pre><p>代码中用到了 clap 提供的宏来让 CLI 的定义变得简单，这个宏能够生成一些额外的代码帮我们处理 CLI 的解析。通过 clap ，我们只需要<strong>先用一个数据结构 T 描述 CLI 都会捕获什么数据，之后通过 T::parse() 就可以解析出各种命令行参数了</strong>。parse() 函数我们并没有定义，它是 #[derive(Clap)] 自动生成的。</p><p>目前我们定义了两个子命令，在 Rust 中子命令可以通过 enum 定义，每个子命令的参数又由它们各自的数据结构 Get 和 Post 来定义。</p><p>我们运行一下：</p><pre><code class=\"language-bash\">❯ cargo build --quiet &amp;&amp; target/debug/httpie post httpbin.org/post a=1 b=2\nOpts { subcmd: Post(Post { url: \"httpbin.org/post\", body: [\"a=1\", \"b=2\"] }) }\n\n</code></pre><p>默认情况下，cargo build 编译出来的二进制，在项目根目录的 target/debug 下。可以看到，命令行解析成功，达到了我们想要的功能。</p><h3>加入验证</h3><p>然而，现在我们还没对用户输入做任何检验，如果有这样的输入，URL 就完全解析错误了：</p><pre><code class=\"language-bash\">❯ cargo build --quiet &amp;&amp; target/debug/httpie post a=1 b=2\nOpts { subcmd: Post(Post { url: \"a=1\", body: [\"b=2\"] }) }\n</code></pre><p>所以，我们需要加入验证。输入有两项，<strong>就要做两个验证，一是验证 URL，另一个是验证body</strong>。</p><p>首先来验证 URL 是合法的：</p><pre><code class=\"language-rust\">use anyhow::Result;\nuse reqwest::Url;\n\n#[derive(Clap, Debug)]\nstruct Get {\n    /// HTTP 请求的 URL\n    #[clap(parse(try_from_str = parse_url))]\n    url: String,\n}\n\nfn parse_url(s: &amp;str) -&gt; Result&lt;String&gt; {\n    // 这里我们仅仅检查一下 URL 是否合法\n    let _url: Url = s.parse()?;\n\n    Ok(s.into())\n}\n</code></pre><p>clap 允许你为每个解析出来的值添加自定义的解析函数，我们这里定义了个 parse_url 检查一下。</p><p>然后，我们要确保 body 里每一项都是 key=value 的格式。可以定义一个数据结构 KvPair 来存储这个信息，并且也自定义一个解析函数把解析的结果放入 KvPair：</p><pre><code class=\"language-rust\">use std::str::FromStr;\nuse anyhow::{anyhow, Result};\n\n#[derive(Clap, Debug)]\nstruct Post {\n    /// HTTP 请求的 URL\n    #[clap(parse(try_from_str = parse_url))]\n    url: String,\n    /// HTTP 请求的 body\n    #[clap(parse(try_from_str=parse_kv_pair))]\n    body: Vec&lt;KvPair&gt;,\n}\n\n/// 命令行中的 key=value 可以通过 parse_kv_pair 解析成 KvPair 结构\n#[derive(Debug)]\nstruct KvPair {\n    k: String,\n    v: String,\n}\n\n/// 当我们实现 FromStr trait 后，可以用 str.parse() 方法将字符串解析成 KvPair\nimpl FromStr for KvPair {\n    type Err = anyhow::Error;\n\n    fn from_str(s: &amp;str) -&gt; Result&lt;Self, Self::Err&gt; {\n        // 使用 = 进行 split，这会得到一个迭代器\n        let mut split = s.split(\"=\");\n        let err = || anyhow!(format!(\"Failed to parse {}\", s));\n        Ok(Self {\n            // 从迭代器中取第一个结果作为 key，迭代器返回 Some(T)/None\n            // 我们将其转换成 Ok(T)/Err(E)，然后用 ? 处理错误\n            k: (split.next().ok_or_else(err)?).to_string(),\n            // 从迭代器中取第二个结果作为 value\n            v: (split.next().ok_or_else(err)?).to_string(),\n        })\n    }\n}\n\n/// 因为我们为 KvPair 实现了 FromStr，这里可以直接 s.parse() 得到 KvPair\nfn parse_kv_pair(s: &amp;str) -&gt; Result&lt;KvPair&gt; {\n    Ok(s.parse()?)\n}\n</code></pre><p>这里我们实现了一个 <a href=\"https://doc.rust-lang.org/std/str/trait.FromStr.html\">FromStr trait</a>，可以把满足条件的字符串转换成 KvPair。FromStr 是 Rust 标准库定义的 trait，实现它之后，就可以调用字符串的 parse() 泛型函数，很方便地处理字符串到某个类型的转换了。</p><p>这样修改完成后，我们的 CLI 就比较健壮了，可以再测试一下：</p><pre><code class=\"language-rust\">❯ cargo build --quiet\n❯ target/debug/httpie post https://httpbin.org/post a=1 b\nerror: Invalid value for '&lt;BODY&gt;...': Failed to parse b\n\nFor more information try --help\n❯ target/debug/httpie post abc a=1\nerror: Invalid value for '&lt;URL&gt;': relative URL without a base\n\nFor more information try --help\n\ntarget/debug/httpie post https://httpbin.org/post a=1 b=2\nOpts { subcmd: Post(Post { url: \"https://httpbin.org/post\", body: [KvPair { k: \"a\", v: \"1\" }, KvPair { k: \"b\", v: \"2\" }] }) }\n</code></pre><p>Cool，我们完成了基本的验证，不过很明显可以看到，我们并没有把各种验证代码一股脑塞在主流程中，而是<strong>通过实现额外的验证函数和 trait 来完成的</strong>，这些新添加的代码，高度可复用且彼此独立，并不用修改主流程。</p><p>这非常符合软件开发的开闭原则（<a href=\"https://en.wikipedia.org/wiki/Open%E2%80%93closed_principle\">Open-Closed Principle</a>）：Rust 可以通过宏、trait、泛型函数、trait object 等工具，帮助我们更容易写出结构良好、容易维护的代码。</p><p><strong>目前你也许还不太明白这些代码的细节，但是不要担心，继续写，今天先把代码跑起来就行了</strong>，不需要你搞懂每个知识点，之后我们都会慢慢讲到的。</p><h3>HTTP 请求</h3><p>好，接下来我们就继续进行 HTTPie 的核心功能：HTTP 的请求处理了。我们在 main() 函数里添加处理子命令的流程：</p><pre><code class=\"language-rust\">use reqwest::{header, Client, Response, Url};\n\n#[tokio::main]\nasync fn main() -&gt; Result&lt;()&gt; {\n    let opts: Opts = Opts::parse();\n    // 生成一个 HTTP 客户端\n    let client = Client::new();\n    let result = match opts.subcmd {\n        SubCommand::Get(ref args) =&gt; get(client, args).await?,\n        SubCommand::Post(ref args) =&gt; post(client, args).await?,\n    };\n\n    Ok(result)\n}\n</code></pre><p>注意看我们把 main 函数变成了 async fn，它代表异步函数。对于 async main，我们需要使用 #[tokio::main] 宏来自动添加处理异步的运行时。</p><p>然后在 main 函数内部，我们根据子命令的类型，我们分别调用 get 和 post 函数做具体处理，这两个函数实现如下：</p><pre><code class=\"language-rust\">use std::{collections::HashMap, str::FromStr};\n\nasync fn get(client: Client, args: &amp;Get) -&gt; Result&lt;()&gt; {\n    let resp = client.get(&amp;args.url).send().await?;\n    println!(\"{:?}\", resp.text().await?);\n    Ok(())\n}\n\nasync fn post(client: Client, args: &amp;Post) -&gt; Result&lt;()&gt; {\n    let mut body = HashMap::new();\n    for pair in args.body.iter() {\n        body.insert(&amp;pair.k, &amp;pair.v);\n    }\n    let resp = client.post(&amp;args.url).json(&amp;body).send().await?;\n    println!(\"{:?}\", resp.text().await?);\n    Ok(())\n}\n</code></pre><p>其中，我们解析出来的 KvPair 列表，需要装入一个 HashMap，然后传给 HTTP client 的 JSON 方法。这样，我们的 HTTPie 的基本功能就完成了。</p><p>不过现在打印出来的数据对用户非常不友好，我们需要进一步用不同的颜色打印 HTTP header 和 HTTP body，就像 Python 版本的 HTTPie 那样，这部分代码比较简单，我们就不详细介绍了。</p><p>最后，来看完整的代码：</p><pre><code class=\"language-rust\">use anyhow::{anyhow, Result};\nuse clap::{AppSettings, Clap};\nuse colored::*;\nuse mime::Mime;\nuse reqwest::{header, Client, Response, Url};\nuse std::{collections::HashMap, str::FromStr};\n\n// 以下部分用于处理 CLI\n\n// 定义 HTTPie 的 CLI 的主入口，它包含若干个子命令\n// 下面 /// 的注释是文档，clap 会将其作为 CLI 的帮助\n\n/// A naive httpie implementation with Rust, can you imagine how easy it is?\n#[derive(Clap, Debug)]\n#[clap(version = \"1.0\", author = \"Tyr Chen &lt;tyr@chen.com&gt;\")]\n#[clap(setting = AppSettings::ColoredHelp)]\nstruct Opts {\n    #[clap(subcommand)]\n    subcmd: SubCommand,\n}\n\n// 子命令分别对应不同的 HTTP 方法，目前只支持 get / post\n#[derive(Clap, Debug)]\nenum SubCommand {\n    Get(Get),\n    Post(Post),\n    // 我们暂且不支持其它 HTTP 方法\n}\n\n// get 子命令\n\n/// feed get with an url and we will retrieve the response for you\n#[derive(Clap, Debug)]\nstruct Get {\n    /// HTTP 请求的 URL\n    #[clap(parse(try_from_str = parse_url))]\n    url: String,\n}\n\n// post 子命令。需要输入一个 URL，和若干个可选的 key=value，用于提供 json body\n\n/// feed post with an url and optional key=value pairs. We will post the data\n/// as JSON, and retrieve the response for you\n#[derive(Clap, Debug)]\nstruct Post {\n    /// HTTP 请求的 URL\n    #[clap(parse(try_from_str = parse_url))]\n    url: String,\n    /// HTTP 请求的 body\n    #[clap(parse(try_from_str=parse_kv_pair))]\n    body: Vec&lt;KvPair&gt;,\n}\n\n/// 命令行中的 key=value 可以通过 parse_kv_pair 解析成 KvPair 结构\n#[derive(Debug, PartialEq)]\nstruct KvPair {\n    k: String,\n    v: String,\n}\n\n/// 当我们实现 FromStr trait 后，可以用 str.parse() 方法将字符串解析成 KvPair\nimpl FromStr for KvPair {\n    type Err = anyhow::Error;\n\n    fn from_str(s: &amp;str) -&gt; Result&lt;Self, Self::Err&gt; {\n        // 使用 = 进行 split，这会得到一个迭代器\n        let mut split = s.split(\"=\");\n        let err = || anyhow!(format!(\"Failed to parse {}\", s));\n        Ok(Self {\n            // 从迭代器中取第一个结果作为 key，迭代器返回 Some(T)/None\n            // 我们将其转换成 Ok(T)/Err(E)，然后用 ? 处理错误\n            k: (split.next().ok_or_else(err)?).to_string(),\n            // 从迭代器中取第二个结果作为 value\n            v: (split.next().ok_or_else(err)?).to_string(),\n        })\n    }\n}\n\n/// 因为我们为 KvPair 实现了 FromStr，这里可以直接 s.parse() 得到 KvPair\nfn parse_kv_pair(s: &amp;str) -&gt; Result&lt;KvPair&gt; {\n    Ok(s.parse()?)\n}\n\nfn parse_url(s: &amp;str) -&gt; Result&lt;String&gt; {\n    // 这里我们仅仅检查一下 URL 是否合法\n    let _url: Url = s.parse()?;\n\n    Ok(s.into())\n}\n\n/// 处理 get 子命令\nasync fn get(client: Client, args: &amp;Get) -&gt; Result&lt;()&gt; {\n    let resp = client.get(&amp;args.url).send().await?;\n    Ok(print_resp(resp).await?)\n}\n\n/// 处理 post 子命令\nasync fn post(client: Client, args: &amp;Post) -&gt; Result&lt;()&gt; {\n    let mut body = HashMap::new();\n    for pair in args.body.iter() {\n        body.insert(&amp;pair.k, &amp;pair.v);\n    }\n    let resp = client.post(&amp;args.url).json(&amp;body).send().await?;\n    Ok(print_resp(resp).await?)\n}\n\n// 打印服务器版本号 + 状态码\nfn print_status(resp: &amp;Response) {\n    let status = format!(\"{:?} {}\", resp.version(), resp.status()).blue();\n    println!(\"{}\\n\", status);\n}\n\n// 打印服务器返回的 HTTP header\nfn print_headers(resp: &amp;Response) {\n    for (name, value) in resp.headers() {\n        println!(\"{}: {:?}\", name.to_string().green(), value);\n    }\n\n    print!(\"\\n\");\n}\n\n/// 打印服务器返回的 HTTP body\nfn print_body(m: Option&lt;Mime&gt;, body: &amp;String) {\n    match m {\n        // 对于 \"application/json\" 我们 pretty print\n        Some(v) if v == mime::APPLICATION_JSON =&gt; {\n            println!(\"{}\", jsonxf::pretty_print(body).unwrap().cyan())\n        }\n        // 其它 mime type，我们就直接输出\n        _ =&gt; println!(\"{}\", body),\n    }\n}\n\n/// 打印整个响应\nasync fn print_resp(resp: Response) -&gt; Result&lt;()&gt; {\n    print_status(&amp;resp);\n    print_headers(&amp;resp);\n    let mime = get_content_type(&amp;resp);\n    let body = resp.text().await?;\n    print_body(mime, &amp;body);\n    Ok(())\n}\n\n/// 将服务器返回的 content-type 解析成 Mime 类型\nfn get_content_type(resp: &amp;Response) -&gt; Option&lt;Mime&gt; {\n    resp.headers()\n        .get(header::CONTENT_TYPE)\n        .map(|v| v.to_str().unwrap().parse().unwrap())\n}\n\n/// 程序的入口函数，因为在 HTTP 请求时我们使用了异步处理，所以这里引入 tokio\n#[tokio::main]\nasync fn main() -&gt; Result&lt;()&gt; {\n    let opts: Opts = Opts::parse();\n    let mut headers = header::HeaderMap::new();\n    // 为我们的 HTTP 客户端添加一些缺省的 HTTP 头\n    headers.insert(\"X-POWERED-BY\", \"Rust\".parse()?);\n    headers.insert(header::USER_AGENT, \"Rust Httpie\".parse()?);\n    let client = reqwest::Client::builder()\n        .default_headers(headers)\n        .build()?;\n    let result = match opts.subcmd {\n        SubCommand::Get(ref args) =&gt; get(client, args).await?,\n        SubCommand::Post(ref args) =&gt; post(client, args).await?,\n    };\n\n    Ok(result)\n}\n\n// 仅在 cargo test 时才编译\n#[cfg(test)]\nmod tests {\n    use super::*;\n\n    #[test]\n    fn parse_url_works() {\n        assert!(parse_url(\"abc\").is_err());\n        assert!(parse_url(\"http://abc.xyz\").is_ok());\n        assert!(parse_url(\"https://httpbin.org/post\").is_ok());\n    }\n\n    #[test]\n    fn parse_kv_pair_works() {\n        assert!(parse_kv_pair(\"a\").is_err());\n        assert_eq!(\n            parse_kv_pair(\"a=1\").unwrap(),\n            KvPair {\n                k: \"a\".into(),\n                v: \"1\".into()\n            }\n        );\n\n        assert_eq!(\n            parse_kv_pair(\"b=\").unwrap(),\n            KvPair {\n                k: \"b\".into(),\n                v: \"\".into()\n            }\n        );\n    }\n}\n\n</code></pre><p>在这个完整代码的最后，我还撰写了几个单元测试，你可以用 cargo test 运行。Rust 支持条件编译，这里 #[cfg(test)] 表明整个 mod tests 都只在 cargo test 时才编译。</p><p>使用<a href=\"https://github.com/XAMPPRocky/tokei\">代码行数统计工具 tokei</a> 可以看到，我们总共使用了 139 行代码，就实现了这个功能，其中还包含了约 30 行的单元测试代码：</p><pre><code class=\"language-bash\">❯ tokei src/main.rs\n-------------------------------------------------------------------------------\n Language            Files        Lines         Code     Comments       Blanks\n-------------------------------------------------------------------------------\n Rust                    1          200          139           33           28\n-------------------------------------------------------------------------------\n Total                   1          200          139           33           28\n-------------------------------------------------------------------------------\n\n</code></pre><p>你可以使用 cargo build --release，编译出 release 版本，并将其拷贝到某个在 <code>$PATH</code>下的目录，然后体验一下：</p><p><img src=\"https://static001.geekbang.org/resource/image/e7/3b/e7183429311fa05yy3bf6c7d4ffce73b.png?wh=1920x813\" alt=\"图片\"></p><p>到这里一个带有完整帮助的 HTTPie 就可以投入使用了。</p><p>我们测试一下效果：</p><p><img src=\"https://static001.geekbang.org/resource/image/b2/09/b2747b65d63987c555281d2361dd8b09.png?wh=1746x1166\" alt=\"图片\"></p><p>这和官方的 HTTPie 效果几乎一样。今天的源代码可以在<a href=\"https://github.com/tyrchen/geektime-rust/tree/master/04_httpie\">这里</a>找到.</p><p>哈，这个例子我们大获成功。我们只用了 100 行代码出头，就实现了 HTTPie 的核心功能，远低于预期的 200 行。不知道你能否从中隐约感受到 Rust 解决实际问题的能力，以今天实现的 HTTPie 为例，</p><ul>\n<li>要把<strong>命令行解析成数据结构</strong>，我们只需要在数据结构上，添加一些简单的标注就能搞定。</li>\n<li><strong>数据的验证</strong>，又可以由单独的、和主流程没有任何耦合关系的函数完成。</li>\n<li>作为 <strong>CLI 解析库</strong>，clap 的整体体验和 Python 的 <a href=\"https://click.palletsprojects.com/en/8.0.x/\">click</a> 非常类似，但比 Golang 的 <a href=\"https://github.com/spf13/cobra\">cobra</a> 要更简单。</li>\n</ul><p>这就是 Rust 语言的能力体现，明明是面向系统级开发，却能够做出类似 Python 的抽象和体验，所以一旦你适应了 Rust ，用起来就会感觉非常美妙。</p><h2>小结</h2><p>现在你应该有点明白，为什么我会在开篇词中会说，Rust 拥有强大的表现力。</p><p>或许你还是有点疑惑，这么学，我也太懵了，跟盲人摸象似的。其实初学者都会以为，必须要先搞明白所有的语法知识，才能动手写代码，不是的。</p><p>我们这周写三个实用例子的挑战，就是<strong>为了让你，在懵懂地撰写代码的过程中，直观感受 Rust 处理问题、解决问题的方式</strong>，同时可以跟你熟悉的语言去类比，无论是 Golang / Java，还是 Python / JavaScript，如果我用自己熟悉的语言怎么解决、Rust 给了我什么样的支持、我感觉它还缺什么。</p><p>在这个过程中，你脑子里会产生各种深度的思考，这些思考又必然会引发越来越多的问号，这是好事，带着这些问号，在未来的课程中才能更有目的地学习，也一定会学得深刻而有效。</p><p>今天的小挑战并不太难，你可能还意犹未尽。别急，下一讲我们会再写个难度大一点的、工作中都会用到的 Web 服务，继续体验 Rust 的魅力。</p><h2>思考题</h2><p>我们只是实现了 HTTP header 和 body 的高亮区分，但是 HTTP body 还是有些不太美观，可以进一步做语法高亮，如果你完成了今天的代码，觉得自己学有余力可以再挑战一下，你不妨试一试用 <a href=\"https://github.com/trishume/syntect\">syntect</a> 继续完善我们的 HTTPie。syntect 是 Rust 的一个语法高亮库，非常强大。</p><p>欢迎在留言区分享你的思考。你的 Rust 学习第四次打卡成功，我们下一讲见！</p><h3>特别说明</h3><p>注意：本篇文章中依赖用到了 beta 版本的 crate，可能未来会有破坏性更新，如果在本地无法编译，请参考 <a href=\"https://github.com/tyrchen/geektime-rust/tree/master/04_httpie\">GitHub repo</a> 中的代码。后续文章中，如果出现类似问题，同样参考GitHub上的最新代码。学习愉快～</p>","comments":[{"had_liked":false,"id":309675,"user_name":"Tyr","can_delete":false,"product_type":"c1","uid":1079375,"ip_address":"","ucode":"EAAFC8063202E0","user_header":"https://static001.geekbang.org/account/avatar/00/10/78/4f/e74f870c.jpg","comment_is_top":true,"comment_ctime":1630298103,"is_pvip":false,"replies":[{"id":"112148","content":"有同学反应不能编译通过，问题出在 clap 上。请升级到 Rust 1.54 重新编译。<br><br>另外，reqwest 默认的 TLS 使用的是系统的 openssl，对于某些 linux 用户如果没有安装好 openssl，可能会导致编译不过，对此，你可以修改 Cargo.toml:<br><br>```toml<br>reqwest = { version = &quot;0.11&quot;, default-features = false, features = [&quot;json&quot;, &quot;rustls-tls&quot;] } # HTTP 客户端<br>```<br><br>让 reqwest 使用 rustls。<br><br>","user_name":"作者回复","user_name_real":"Tyr","uid":"1079375","ctime":1630301576,"ip_address":"","comment_id":309675,"utype":1}],"discussion_count":10,"race_medal":0,"score":"9.2233721072045998e+18","product_id":100085301,"comment_content":"这堂课的源代码可以在这里找到：https:&#47;&#47;github.com&#47;tyrchen&#47;geektime-rust&#47;tree&#47;master&#47;04_httpie","like_count":16,"discussions":[{"author":{"id":1079375,"avatar":"https://static001.geekbang.org/account/avatar/00/10/78/4f/e74f870c.jpg","nickname":"Tyr","note":"","ucode":"EAAFC8063202E0","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":525960,"discussion_content":"有同学反应不能编译通过，问题出在 clap 上。请升级到 Rust 1.54 重新编译。\n\n另外，reqwest 默认的 TLS 使用的是系统的 openssl，对于某些 linux 用户如果没有安装好 openssl，可能会导致编译不过，对此，你可以修改 Cargo.toml:\n\n```toml\nreqwest = { version = &amp;quot;0.11&amp;quot;, default-features = false, features = [&amp;quot;json&amp;quot;, &amp;quot;rustls-tls&amp;quot;] } # HTTP 客户端\n```\n\n让 reqwest 使用 rustls。\n\n","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1630301576,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1093658,"avatar":"https://static001.geekbang.org/account/avatar/00/10/b0/1a/427c854c.jpg","nickname":"lemon","note":"","ucode":"360693FCFC8E8D","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":411384,"discussion_content":"使用 1.56.0 也没编译过，找不到 clap","likes_number":4,"is_delete":false,"is_hidden":false,"ctime":1635915103,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":2680235,"avatar":"https://static001.geekbang.org/account/avatar/00/28/e5/ab/cece3199.jpg","nickname":"jason","note":"","ucode":"0886E1D88BB7CC","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":545034,"discussion_content":"1.57.0 死在这里了。","likes_number":1,"is_delete":false,"is_hidden":false,"ctime":1641810098,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":3,"child_discussions":[{"author":{"id":1337030,"avatar":"https://static001.geekbang.org/account/avatar/00/14/66/c6/d779dfb6.jpg","nickname":"松松","note":"","ucode":"EB2A80CF7BCA4B","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":2680235,"avatar":"https://static001.geekbang.org/account/avatar/00/28/e5/ab/cece3199.jpg","nickname":"jason","note":"","ucode":"0886E1D88BB7CC","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":545730,"discussion_content":"在Cargo.toml里加一条clap_derive，版本和clap一致，然后在main.rs里把use的clap::AppSettings去掉，clap::Clap改成clap::Parser和clap_derive::Parser两条，后续所有宏（#[]）里的Clap全改成Parser，里的AppSettings全去掉。\n这应该是 Clap 3.0 还不是稳定版，后来把宏的部分单独拆出来了，命名空间也调整了。","likes_number":1,"is_delete":false,"is_hidden":false,"ctime":1642045951,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":545034,"ip_address":""},"score":545730,"extra":""},{"author":{"id":2890330,"avatar":"https://static001.geekbang.org/account/avatar/00/2c/1a/5a/c3a553dd.jpg","nickname":"少年 🎨","note":"","ucode":"6445B6FE7B767F","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":1337030,"avatar":"https://static001.geekbang.org/account/avatar/00/14/66/c6/d779dfb6.jpg","nickname":"松松","note":"","ucode":"EB2A80CF7BCA4B","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":545889,"discussion_content":"main.rs 文件贴个完整的代码吧，我的还是有报错，谢谢松松。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1642072732,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":545730,"ip_address":""},"score":545889,"extra":""},{"author":{"id":2991652,"avatar":"https://static001.geekbang.org/account/avatar/00/2d/a6/24/961129f1.jpg","nickname":"forever 蒙","note":"","ucode":"472EB8946A3F96","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":1337030,"avatar":"https://static001.geekbang.org/account/avatar/00/14/66/c6/d779dfb6.jpg","nickname":"松松","note":"","ucode":"EB2A80CF7BCA4B","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":574980,"discussion_content":"同求代码。。感激不尽","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1654507251,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":545730,"ip_address":""},"score":574980,"extra":""}]},{"author":{"id":2991652,"avatar":"https://static001.geekbang.org/account/avatar/00/2d/a6/24/961129f1.jpg","nickname":"forever 蒙","note":"","ucode":"472EB8946A3F96","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":574978,"discussion_content":"error: process didn&#39;t exit successfully: `target\\debug\\httpie.exe` (exit code: 2)求助\n","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1654506714,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1251709,"avatar":"https://static001.geekbang.org/account/avatar/00/13/19/7d/04945ae8.jpg","nickname":"找那谁","note":"","ucode":"B65B97E5486E6B","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":539488,"discussion_content":"1.57.0也编译不通过","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1639728325,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":2764665,"avatar":"","nickname":"小志","note":"","ucode":"E7F5831BE53940","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":401933,"discussion_content":"Linux 用户 ubuntu系统 openssl的问题，执行了下面命令解决了：\n$ sudo apt-get install pkg-config libssl-dev","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1633768263,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1027167,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/ac/5f/894761f8.jpg","nickname":"十八哥","note":"","ucode":"C0130252F97814","race_medal":0,"user_type":1,"is_pvip":true},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":391336,"discussion_content":"1.50.0 死在这里了。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1630403379,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":309928,"user_name":"Custer","can_delete":false,"product_type":"c1","uid":1020822,"ip_address":"","ucode":"8AEA5544C94D57","user_header":"https://static001.geekbang.org/account/avatar/00/0f/93/96/575d42c3.jpg","comment_is_top":true,"comment_ctime":1630398347,"is_pvip":true,"replies":[{"id":"112295","content":"非常棒！你似乎是第一个贴出来思考题答案的！我也更新了一下代码库，和你的代码基本一样你可以对比一下。两个点：1. print_syntect 可以再加一个参数 ext，这样灵活性更高；2. 打印时用 print! 效果更好一些。","user_name":"作者回复","user_name_real":"Tyr","uid":"1079375","ctime":1630425915,"ip_address":"","comment_id":309928,"utype":1}],"discussion_count":1,"race_medal":0,"score":"9.2233720900248003e+18","product_id":100085301,"comment_content":"&#47;&#47;&#47; 打印服务器返回的 HTTP body<br>fn print_body(m: Option&lt;Mime&gt;, body: &amp;String) {<br>    match m {<br>        &#47;&#47; 对于 &quot;application&#47;json&quot; 我们 pretty print<br>        Some(v) if v == mime::APPLICATION_JSON =&gt; {<br>            &#47;&#47; println!(&quot;{}&quot;, jsonxf::pretty_print(body).unwrap().cyan())<br>            print_syntect(body);<br>        }<br>        &#47;&#47; 其他 mime type，我们就直接输出<br>        _ =&gt; println!(&quot;{}&quot;, body),<br>    }<br>}<br><br>fn print_syntect(s: &amp;str) {<br>    &#47;&#47; Load these once at the start of your program<br>    let ps = SyntaxSet::load_defaults_newlines();<br>    let ts = ThemeSet::load_defaults();<br>    let syntax = ps.find_syntax_by_extension(&quot;json&quot;).unwrap();<br>    let mut h = HighlightLines::new(syntax, &amp;ts.themes[&quot;base16-ocean.dark&quot;]);<br>    for line in LinesWithEndings::from(s) {<br>        let ranges: Vec&lt;(Style, &amp;str)&gt; = h.highlight(line, &amp;ps);<br>        let escaped = as_24_bit_terminal_escaped(&amp;ranges[..], true);<br>        println!(&quot;{}&quot;, escaped);<br>    }<br>}","like_count":12,"discussions":[{"author":{"id":1079375,"avatar":"https://static001.geekbang.org/account/avatar/00/10/78/4f/e74f870c.jpg","nickname":"Tyr","note":"","ucode":"EAAFC8063202E0","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":526067,"discussion_content":"非常棒！你似乎是第一个贴出来思考题答案的！我也更新了一下代码库，和你的代码基本一样你可以对比一下。两个点：1. print_syntect 可以再加一个参数 ext，这样灵活性更高；2. 打印时用 print! 效果更好一些。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1630425915,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":309702,"user_name":"王槐铤","can_delete":false,"product_type":"c1","uid":1073782,"ip_address":"","ucode":"D01A18E5025391","user_header":"https://static001.geekbang.org/account/avatar/00/10/62/76/0564a5ee.jpg","comment_is_top":true,"comment_ctime":1630308200,"is_pvip":false,"replies":[{"id":"112236","content":"👍","user_name":"作者回复","user_name_real":"Tyr","uid":"1079375","ctime":1630379285,"ip_address":"","comment_id":309702,"utype":1}],"discussion_count":2,"race_medal":0,"score":"9.2233720728448e+18","product_id":100085301,"comment_content":"环境 <br>cargo --version<br>cargo 1.52.0 (69767412a 2021-04-21)<br><br>rustc --version<br>rustc 1.52.1 (9bc8c42bb 2021-05-09)<br><br>编译程序代码 clap 库部分报<br><br>8 | #![doc = include_str!(&quot;..&#47;README.md&quot;)]<br>  |          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^<br><br>把 Cargo.toml 里 clap 依赖 <br>clap = &quot;=3.0.0-beta.4&quot;<br>改为 <br>clap = &quot;=3.0.0-beta.2&quot; <br>clap_derive = &quot;=3.0.0-beta.2&quot;<br>即可通过 <br><br>具体原因 详见 https:&#47;&#47;github.com&#47;dfinity&#47;agent-rs&#47;pull&#47;260","like_count":8,"discussions":[{"author":{"id":1079375,"avatar":"https://static001.geekbang.org/account/avatar/00/10/78/4f/e74f870c.jpg","nickname":"Tyr","note":"","ucode":"EAAFC8063202E0","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":525974,"discussion_content":"👍","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1630379285,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1075443,"avatar":"https://static001.geekbang.org/account/avatar/00/10/68/f3/22481a37.jpg","nickname":"小样","note":"","ucode":"0D05E1D31150F1","race_medal":0,"user_type":1,"is_pvip":true},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":391254,"discussion_content":"从这也可以看出生态还不稳定","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1630372977,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":328431,"user_name":"linuxfish","can_delete":false,"product_type":"c1","uid":1078927,"ip_address":"","ucode":"557F21A1CC7EAD","user_header":"","comment_is_top":true,"comment_ctime":1640738321,"is_pvip":false,"replies":[{"id":"120777","content":"谢谢！github 上的已经更新到 clap 3 正式版本了","user_name":"作者回复","user_name_real":"编辑","uid":"1079375","ctime":1642309494,"ip_address":"","comment_id":328431,"utype":1}],"discussion_count":2,"race_medal":0,"score":"9.2233720470854001e+18","product_id":100085301,"comment_content":"遇到一个问题，提醒下刚开始学的同学：<br><br>老师使用了 clap 包的 Pre-releases 版本，Pre-releases 版本并不保证 API 的稳定。<br><br>cargo 在安装依赖的时候会自动使用【最新】的 Pre-releases 版本（尽管你在 Cargo.toml 中指定了一个老版本）<br><br>当前 clap 包的最新版本是 v3.0.0-beta.5，若按照课程（get hands dirty：来写个实用的CLI小工具）里步骤操作，会编译不过。 不过老师在 Github 上的代码已经更新成依赖 v3.0.0-beta.5，可以照着那个写。<br><br>当然，还是建议把课程里的代码也更新下，或者用红字提示下【代码已过期，请参考 Github 上的最新代码】，不然新手会比较懵逼<br><br>参考：https:&#47;&#47;doc.rust-lang.org&#47;cargo&#47;reference&#47;resolver.html#pre-releases","like_count":2,"discussions":[{"author":{"id":1079375,"avatar":"https://static001.geekbang.org/account/avatar/00/10/78/4f/e74f870c.jpg","nickname":"Tyr","note":"","ucode":"EAAFC8063202E0","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":546416,"discussion_content":"谢谢！github 上的已经更新到 clap 3 正式版本了","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1642309494,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1445422,"avatar":"http://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTK64FvuN8licm0ECjicice6aN7dyhFzKImmHxDKsnNPUlhkvrINBoJRUBicQPe5c5GCTy5pTFEeMria86g/132","nickname":"跳足巫师","note":"","ucode":"3C64591AE23CDC","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":554532,"discussion_content":"文稿能更新一下吗？","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1646451516,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":351890,"user_name":"Faith信","can_delete":false,"product_type":"c1","uid":1795456,"ip_address":"","ucode":"036367598C46BE","user_header":"https://static001.geekbang.org/account/avatar/00/1b/65/80/52161b2f.jpg","comment_is_top":true,"comment_ctime":1658280368,"is_pvip":true,"replies":[{"id":"127958","content":"👍","user_name":"编辑回复","user_name_real":"编辑","uid":"2547771","ctime":1658300063,"ip_address":"","comment_id":351890,"utype":2}],"discussion_count":1,"race_medal":0,"score":"9.2233720385131008e+18","product_id":100085301,"comment_content":"rustc 1.58.1 <br>不能编译的参考老师github代码依赖修改","like_count":0,"discussions":[{"author":{"id":2547771,"avatar":"https://static001.geekbang.org/account/avatar/00/26/e0/3b/8ec916b2.jpg","nickname":"多少","note":"","ucode":"0A6EF7AA6E4BB7","race_medal":0,"user_type":4,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":580629,"discussion_content":"👍","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1658300064,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":4}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":309728,"user_name":"qinsi","can_delete":false,"product_type":"c1","uid":1667175,"ip_address":"","ucode":"090D9C4068FF12","user_header":"https://static001.geekbang.org/account/avatar/00/19/70/67/0c1359c2.jpg","comment_is_top":false,"comment_ctime":1630314741,"is_pvip":true,"replies":[{"id":"112239","content":"好建议！","user_name":"作者回复","user_name_real":"Tyr","uid":"1079375","ctime":1630379556,"ip_address":"","comment_id":309728,"utype":1}],"discussion_count":3,"race_medal":0,"score":"199198810357","product_id":100085301,"comment_content":"习惯了 npm install 的可以试试 cargo-edit:<br><br>$ cargo install cargo-edit<br>$ cargo add anyhow colored jsonxf mime<br>$ cargo add clap --allow-prerelease<br>$ cargo add reqwest --features json<br>$ cargo add tokio --features full","like_count":46,"discussions":[{"author":{"id":1079375,"avatar":"https://static001.geekbang.org/account/avatar/00/10/78/4f/e74f870c.jpg","nickname":"Tyr","note":"","ucode":"EAAFC8063202E0","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":525985,"discussion_content":"好建议！","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1630379556,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1460980,"avatar":"https://static001.geekbang.org/account/avatar/00/16/4a/f4/513d26e8.jpg","nickname":"zoomdong","note":"","ucode":"AA0B8F945D9935","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":543861,"discussion_content":"哇，感谢答主，找这个找好久了","likes_number":1,"is_delete":false,"is_hidden":false,"ctime":1641316627,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":1,"child_discussions":[{"author":{"id":1202089,"avatar":"https://static001.geekbang.org/account/avatar/00/12/57/a9/9abbe7a4.jpg","nickname":"神三元","note":"","ucode":"0FB2E7C0683599","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":1460980,"avatar":"https://static001.geekbang.org/account/avatar/00/16/4a/f4/513d26e8.jpg","nickname":"zoomdong","note":"","ucode":"AA0B8F945D9935","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":576430,"discussion_content":"+1","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1655542220,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":543861,"ip_address":""},"score":576430,"extra":""}]}]},{"had_liked":false,"id":310899,"user_name":"Marvichov","can_delete":false,"product_type":"c1","uid":1111835,"ip_address":"","ucode":"7482099415C41C","user_header":"https://static001.geekbang.org/account/avatar/00/10/f7/1b/db7a0edc.jpg","comment_is_top":false,"comment_ctime":1630977068,"is_pvip":false,"replies":[{"id":"112676","content":"注意看 Colorize trait 的定义，它的方法 consume 的都是 self，而非 &amp;self。所以当 impl Colorize for &amp;str 时，self = &amp;str。<br><br>在调用方法时，编译器会先看数据结构是否有对应的方法，如果有，按照方法的 signature，传 self &#47; &amp;self &#47; &amp;mut self。如果没有，再看引入的 trait 是否有对应的方法，必要时会根据 self 的类型做 auto Deref。所以这里编译器可以找到 blue()，因为它第一个参数 self = &amp;str，String 可以 Deref 到 &amp;str，所以可以调用。但如果 Colorize 的方法使用 &amp;self，此时 &amp;self = &amp;&amp;str，String 无法 Deref 到 &amp;&amp;str，所以编译器报错。<br><br>你可以看这个小例子：<br><br>https:&#47;&#47;play.rust-lang.org&#47;?version=stable&amp;mode=debug&amp;edition=2018&amp;gist=dbd526df998fc8701ea9855c9e7de73c<br><br>```rust<br>pub trait Foo {<br>    fn foo(self);<br>}<br><br>pub trait Bar {<br>    fn bar(&amp;self);<br>}<br><br>pub trait Baz {<br>    fn baz(&amp;self);<br>}<br><br>impl Foo for &amp;str {<br>    fn foo(self) {<br>        println!(&quot;Foo: {}&quot;, self);<br>    }<br>}<br><br>impl Bar for &amp;str {<br>    fn bar(&amp;self) {<br>        println!(&quot;Bar: {}&quot;, self);<br>    }<br>}<br><br>impl Baz for str {<br>    fn baz(&amp;self) {<br>        println!(&quot;Baz: {}&quot;, self);<br>    }<br>}<br><br>fn main() {<br>    let s = String::from(&quot;Tyr&quot;);<br>    &#47;&#47; foo 第一个参数是 self = &amp;str，String 可以 auto Deref 到 &amp;str，所以可以调用<br>    s.foo();<br>    &#47;&#47; bar 第一个参数是 &amp;self = &amp;&amp;str，String 无法 auto Deref 到 &amp;&amp;str<br>    &#47;&#47; s.bar();<br>    &#47;&#47; baz 第一个参数是 &amp;self，但因为 impl Baz for str {}, 所以 &amp;self = &amp;str<br>    &#47;&#47; 和 foo 类似，可以调用<br>    s.baz();<br>}<br>```","user_name":"作者回复","user_name_real":"Tyr","uid":"1079375","ctime":1630988165,"ip_address":"","comment_id":310899,"utype":1}],"discussion_count":2,"race_medal":0,"score":"53170584620","product_id":100085301,"comment_content":"查了下colorize trait的doc (https:&#47;&#47;docs.rs&#47;colored&#47;2.0.0&#47;colored&#47;trait.Colorize.html), 没看到这个trait impl for String啊, 为啥可以call blue on String type呢?<br>```<br>format!(&quot;{:?} {}&quot;, resp.version(), resp.status()).blue();<br>```<br>老师知道这里面发生了什么转换么?","like_count":12,"discussions":[{"author":{"id":1079375,"avatar":"https://static001.geekbang.org/account/avatar/00/10/78/4f/e74f870c.jpg","nickname":"Tyr","note":"","ucode":"EAAFC8063202E0","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":526392,"discussion_content":"注意看 Colorize trait 的定义，它的方法 consume 的都是 self，而非 &amp;amp;self。所以当 impl Colorize for &amp;amp;str 时，self = &amp;amp;str。\n\n在调用方法时，编译器会先看数据结构是否有对应的方法，如果有，按照方法的 signature，传 self / &amp;amp;self / &amp;amp;mut self。如果没有，再看引入的 trait 是否有对应的方法，必要时会根据 self 的类型做 auto Deref。所以这里编译器可以找到 blue()，因为它第一个参数 self = &amp;amp;str，String 可以 Deref 到 &amp;amp;str，所以可以调用。但如果 Colorize 的方法使用 &amp;amp;self，此时 &amp;amp;self = &amp;amp;&amp;amp;str，String 无法 Deref 到 &amp;amp;&amp;amp;str，所以编译器报错。\n\n你可以看这个小例子：\n\nhttps://play.rust-lang.org/?version=stable&amp;amp;mode=debug&amp;amp;edition=2018&amp;amp;gist=dbd526df998fc8701ea9855c9e7de73c\n\n```rust\npub trait Foo {\n    fn foo(self);\n}\n\npub trait Bar {\n    fn bar(&amp;amp;self);\n}\n\npub trait Baz {\n    fn baz(&amp;amp;self);\n}\n\nimpl Foo for &amp;amp;str {\n    fn foo(self) {\n        println!(&amp;quot;Foo: {}&amp;quot;, self);\n    }\n}\n\nimpl Bar for &amp;amp;str {\n    fn bar(&amp;amp;self) {\n        println!(&amp;quot;Bar: {}&amp;quot;, self);\n    }\n}\n\nimpl Baz for str {\n    fn baz(&amp;amp;self) {\n        println!(&amp;quot;Baz: {}&amp;quot;, self);\n    }\n}\n\nfn main() {\n    let s = String::from(&amp;quot;Tyr&amp;quot;);\n    // foo 第一个参数是 self = &amp;amp;str，String 可以 auto Deref 到 &amp;amp;str，所以可以调用\n    s.foo();\n    // bar 第一个参数是 &amp;amp;self = &amp;amp;&amp;amp;str，String 无法 auto Deref 到 &amp;amp;&amp;amp;str\n    // s.bar();\n    // baz 第一个参数是 &amp;amp;self，但因为 impl Baz for str {}, 所以 &amp;amp;self = &amp;amp;str\n    // 和 foo 类似，可以调用\n    s.baz();\n}\n```","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1630988165,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1014800,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/7c/10/165cb374.jpg","nickname":"Scott","note":"","ucode":"7E57FDCB5E5D49","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":393297,"discussion_content":"原来是impl<&#39;a> Colorize for &amp;&#39;a str","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1631346458,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":309617,"user_name":"逸风","can_delete":false,"product_type":"c1","uid":2674968,"ip_address":"","ucode":"E4AF619DCD869C","user_header":"https://static001.geekbang.org/account/avatar/00/28/d1/18/2221fb85.jpg","comment_is_top":false,"comment_ctime":1630279149,"is_pvip":false,"replies":[{"id":"112139","content":"谢谢！","user_name":"作者回复","user_name_real":"Tyr","uid":"1079375","ctime":1630297570,"ip_address":"","comment_id":309617,"utype":1}],"discussion_count":1,"race_medal":0,"score":"53169886701","product_id":100085301,"comment_content":"喜欢这样的教学方式！","like_count":12,"discussions":[{"author":{"id":1079375,"avatar":"https://static001.geekbang.org/account/avatar/00/10/78/4f/e74f870c.jpg","nickname":"Tyr","note":"","ucode":"EAAFC8063202E0","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":525934,"discussion_content":"谢谢！","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1630297570,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":310613,"user_name":"Arthur","can_delete":false,"product_type":"c1","uid":1784009,"ip_address":"","ucode":"1C064405490769","user_header":"https://static001.geekbang.org/account/avatar/00/1b/38/c9/63ea8fe6.jpg","comment_is_top":false,"comment_ctime":1630773513,"is_pvip":true,"replies":[{"id":"112556","content":"继承的概念，在 Rust 里是没有的。而且我们要避免使用这样的思维去建模。很多时候我们提到继承，其实并不是想用继承，而是想通过继承使用多态。在 Rust 下我们可以通过泛型，trait，trait object 实现面向对象语言中主要的多态手段。<br><br>封装在任何编程语言中都或多或少存在，它本质上是一种对复杂性的控制。Rust 下 struct &#47; enum &#47; mod 都提供了封装的能力。把若干数据放在某个结构下，若干函数放在摸个模块下，只暴露该暴露的信息出去，这就是封装。<br><br>方法可以理解为第一个参数为 self&#47;this 这样的指向调用者自己的特殊函数，在 Python、Javascript 都有类似的概念。Rust 下可以为数据结构 impl 方法，或者 impl trait 来实现接口的方法。注意 Rust 下的方法可以消费 self（第一个参数是 self 而非 &amp;self），其它大多数语言只能消费 &amp;self。","user_name":"作者回复","user_name_real":"Tyr","uid":"1079375","ctime":1630860711,"ip_address":"","comment_id":310613,"utype":1}],"discussion_count":1,"race_medal":0,"score":"44580446473","product_id":100085301,"comment_content":"对Rust里的derive, impl, trait等概念，和Java&#47;C++中面向对象编程概念里的封装、继承、方法等概念，有怎样的类比和不同，一直模糊不清，希望老师后面能讲到","like_count":10,"discussions":[{"author":{"id":1079375,"avatar":"https://static001.geekbang.org/account/avatar/00/10/78/4f/e74f870c.jpg","nickname":"Tyr","note":"","ucode":"EAAFC8063202E0","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":526290,"discussion_content":"继承的概念，在 Rust 里是没有的。而且我们要避免使用这样的思维去建模。很多时候我们提到继承，其实并不是想用继承，而是想通过继承使用多态。在 Rust 下我们可以通过泛型，trait，trait object 实现面向对象语言中主要的多态手段。\n\n封装在任何编程语言中都或多或少存在，它本质上是一种对复杂性的控制。Rust 下 struct / enum / mod 都提供了封装的能力。把若干数据放在某个结构下，若干函数放在摸个模块下，只暴露该暴露的信息出去，这就是封装。\n\n方法可以理解为第一个参数为 self/this 这样的指向调用者自己的特殊函数，在 Python、Javascript 都有类似的概念。Rust 下可以为数据结构 impl 方法，或者 impl trait 来实现接口的方法。注意 Rust 下的方法可以消费 self（第一个参数是 self 而非 &amp;amp;self），其它大多数语言只能消费 &amp;amp;self。","likes_number":1,"is_delete":false,"is_hidden":false,"ctime":1630860711,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":309737,"user_name":"qinsi","can_delete":false,"product_type":"c1","uid":1667175,"ip_address":"","ucode":"090D9C4068FF12","user_header":"https://static001.geekbang.org/account/avatar/00/19/70/67/0c1359c2.jpg","comment_is_top":false,"comment_ctime":1630316127,"is_pvip":true,"replies":[{"id":"112240","content":"如果想用 async-std，可以用 surf。我建议不要在 async-std 下花时间了。tokio 生态已经占据了绝对优势。","user_name":"作者回复","user_name_real":"Tyr","uid":"1079375","ctime":1630379663,"ip_address":"","comment_id":309737,"utype":1}],"discussion_count":1,"race_medal":0,"score":"44579989087","product_id":100085301,"comment_content":"疑问：查了下reqwest似乎是依赖tokio运行时的，是否意味着用了reqwest就必须用tokio而不能用其他的运行时比如async-std？","like_count":10,"discussions":[{"author":{"id":1079375,"avatar":"https://static001.geekbang.org/account/avatar/00/10/78/4f/e74f870c.jpg","nickname":"Tyr","note":"","ucode":"EAAFC8063202E0","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":525989,"discussion_content":"如果想用 async-std，可以用 surf。我建议不要在 async-std 下花时间了。tokio 生态已经占据了绝对优势。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1630379663,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":309967,"user_name":"Kerry","can_delete":false,"product_type":"c1","uid":2061524,"ip_address":"","ucode":"92F809EC998FC6","user_header":"https://static001.geekbang.org/account/avatar/00/1f/74/d4/38d813f0.jpg","comment_is_top":false,"comment_ctime":1630417111,"is_pvip":false,"replies":[{"id":"112297","content":"👍 是啊，这么底层的语言可以做出来这么强大的抽象。","user_name":"作者回复","user_name_real":"Tyr","uid":"1079375","ctime":1630426064,"ip_address":"","comment_id":309967,"utype":1}],"discussion_count":3,"race_medal":0,"score":"35990155479","product_id":100085301,"comment_content":"简洁的背后意味着大量的抽象。<br><br>而初学者见到这么简洁的代码，会迷惑：”我复制了啥，怎么这么短就跑出这么多功能来？？？“<br><br>假以时日，就不禁感叹Rust语言表达力的强大。","like_count":8,"discussions":[{"author":{"id":1079375,"avatar":"https://static001.geekbang.org/account/avatar/00/10/78/4f/e74f870c.jpg","nickname":"Tyr","note":"","ucode":"EAAFC8063202E0","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":526077,"discussion_content":"👍 是啊，这么底层的语言可以做出来这么强大的抽象。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1630426064,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1926134,"avatar":"https://static001.geekbang.org/account/avatar/00/1d/63/f6/225df928.jpg","nickname":"Alice","note":"","ucode":"6D8F901229B182","race_medal":0,"user_type":8,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":550324,"discussion_content":"@alexd 语言的&#34;表现力&#34;实际上取决于语言构造如何清晰地&#34;表达&#34;开发人员的意图, 这里有一篇不错的科普文章可以读一下：\n 编程语言的表现力是什么意思？  https://www.codenong.com/2427496/","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1644484909,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":2708009,"avatar":"https://static001.geekbang.org/account/avatar/00/29/52/29/51b5ca75.jpg","nickname":"alexd","note":"","ucode":"7815D35C4CFA0A","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":392069,"discussion_content":"这么理解表达能力就是调用各种库？","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1630811008,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":311787,"user_name":"gzgywh","can_delete":false,"product_type":"c1","uid":1198174,"ip_address":"","ucode":"4A7978EB4049A9","user_header":"https://static001.geekbang.org/account/avatar/00/12/48/5e/ccab5336.jpg","comment_is_top":false,"comment_ctime":1631459291,"is_pvip":false,"replies":[{"id":"112989","content":"宏可以操作并修改代码的 AST，装饰器只能对代码简单包装，无法改动 AST。","user_name":"作者回复","user_name_real":"Tyr","uid":"1079375","ctime":1631514901,"ip_address":"","comment_id":311787,"utype":1}],"discussion_count":1,"race_medal":0,"score":"27401263067","product_id":100085301,"comment_content":"Rust里面的宏感觉跟Python里面的装饰器作用差不多嘛？","like_count":6,"discussions":[{"author":{"id":1079375,"avatar":"https://static001.geekbang.org/account/avatar/00/10/78/4f/e74f870c.jpg","nickname":"Tyr","note":"","ucode":"EAAFC8063202E0","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":526744,"discussion_content":"宏可以操作并修改代码的 AST，装饰器只能对代码简单包装，无法改动 AST。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1631514901,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":310401,"user_name":"CR","can_delete":false,"product_type":"c1","uid":2186767,"ip_address":"","ucode":"CE78F51366077F","user_header":"https://static001.geekbang.org/account/avatar/00/21/5e/0f/1a204ef7.jpg","comment_is_top":false,"comment_ctime":1630639927,"is_pvip":false,"replies":[{"id":"112454","content":"excalidraw","user_name":"编辑回复","user_name_real":"叶如芊","uid":"2547771","ctime":1630645413,"ip_address":"","comment_id":310401,"utype":2}],"discussion_count":1,"race_medal":0,"score":"27400443703","product_id":100085301,"comment_content":"很想知道老师的画图工具都有哪些🤔","like_count":6,"discussions":[{"author":{"id":2547771,"avatar":"https://static001.geekbang.org/account/avatar/00/26/e0/3b/8ec916b2.jpg","nickname":"多少","note":"","ucode":"0A6EF7AA6E4BB7","race_medal":0,"user_type":4,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":526221,"discussion_content":"excalidraw","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1630645413,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":4}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":312740,"user_name":"chinandy","can_delete":false,"product_type":"c1","uid":2737221,"ip_address":"","ucode":"396E8478BB0393","user_header":"https://static001.geekbang.org/account/avatar/00/29/c4/45/88287ede.jpg","comment_is_top":false,"comment_ctime":1631958619,"is_pvip":false,"replies":[{"id":"113314","content":"👍","user_name":"作者回复","user_name_real":"Tyr","uid":"1079375","ctime":1631981968,"ip_address":"","comment_id":312740,"utype":1}],"discussion_count":1,"race_medal":0,"score":"23106795099","product_id":100085301,"comment_content":"大家参考老师写的代码的时候，如果是网页不能正常的美化显示，有可能是网页是UTF8的原因，print_body函数match分支加一个TEXT_HTML_UTF_8判断，        Some(v) if v == mime::TEXT_HTML_UTF_8 || v == mime::TEXT_HTML =&gt; print_syntect(body, &quot;html&quot;),即可。<br>","like_count":5,"discussions":[{"author":{"id":1079375,"avatar":"https://static001.geekbang.org/account/avatar/00/10/78/4f/e74f870c.jpg","nickname":"Tyr","note":"","ucode":"EAAFC8063202E0","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":527097,"discussion_content":"👍","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1631981968,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":310694,"user_name":"老实人Honey","can_delete":false,"product_type":"c1","uid":1080653,"ip_address":"","ucode":"EA4AB5C0C33090","user_header":"https://static001.geekbang.org/account/avatar/00/10/7d/4d/d98865b2.jpg","comment_is_top":false,"comment_ctime":1630845570,"is_pvip":true,"replies":[{"id":"112555","content":"对","user_name":"作者回复","user_name_real":"Tyr","uid":"1079375","ctime":1630859294,"ip_address":"","comment_id":310694,"utype":1}],"discussion_count":1,"race_medal":0,"score":"23105682050","product_id":100085301,"comment_content":"另外一种运行工程的命令是，cargo run -- post httpbin.org&#47;post a=1 b=2<br>-- 就相当于 target&#47;debug&#47;httpie","like_count":5,"discussions":[{"author":{"id":1079375,"avatar":"https://static001.geekbang.org/account/avatar/00/10/78/4f/e74f870c.jpg","nickname":"Tyr","note":"","ucode":"EAAFC8063202E0","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":526310,"discussion_content":"对","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1630859294,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":330850,"user_name":"Geek_2924d7","can_delete":false,"product_type":"c1","uid":2890859,"ip_address":"","ucode":"7D01473BD71838","user_header":"","comment_is_top":false,"comment_ctime":1642223329,"is_pvip":false,"replies":[{"id":"120752","content":"👍","user_name":"作者回复","user_name_real":"编辑","uid":"1079375","ctime":1642308073,"ip_address":"","comment_id":330850,"utype":1}],"discussion_count":2,"race_medal":0,"score":"18822092513","product_id":100085301,"comment_content":"```toml<br>clap = { version = &quot;3.0.7&quot;, features = [&quot;derive&quot;] } # 修改成这样<br>```<br>use clap::{Parser, Subcommand};<br><br>#[derive(Debug, Parser)]<br>#[clap(version = &quot;1.0&quot;, author = &quot;Tyr Chen &quot;)]<br>&#47;&#47; #[clap(setting( AppSettings::ColoredHelp))]<br>struct Opts {<br>    #[clap(subcommand)]<br>    subcmd: Subcmd,<br>}<br><br>#[derive(Subcommand, Debug)]<br>enum Subcmd {<br>    Get(Get),<br>    Post(Post),<br>}<br><br>#[derive(Parser, Debug)]<br>struct Get {<br>    url: String,<br>}<br><br>#[derive(Parser, Debug)]<br>struct Post {<br>    url: String,<br>    body: Vec&lt;String&gt;,<br>}<br>fn main() {<br>    let opts: Opts = Opts::parse();<br>    println!(&quot;{:?}&quot;, opts);<br>}<br>```rust<br><br>```","like_count":4,"discussions":[{"author":{"id":1079375,"avatar":"https://static001.geekbang.org/account/avatar/00/10/78/4f/e74f870c.jpg","nickname":"Tyr","note":"","ucode":"EAAFC8063202E0","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":546390,"discussion_content":"👍","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1642308073,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":2636670,"avatar":"https://static001.geekbang.org/account/avatar/00/28/3b/7e/2b192332.jpg","nickname":"Levin","note":"","ucode":"C3ACBF3DD34C81","race_medal":0,"user_type":1,"is_pvip":true},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":548028,"discussion_content":"总算能用跑通了...","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1643002741,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":319182,"user_name":"tider","can_delete":false,"product_type":"c1","uid":2822424,"ip_address":"","ucode":"95AC44CBE68A72","user_header":"https://static001.geekbang.org/account/avatar/00/2b/11/18/c6b3965c.jpg","comment_is_top":false,"comment_ctime":1635661767,"is_pvip":false,"replies":[{"id":"116391","content":"嗯，最新代码参考：https:&#47;&#47;github.com&#47;tyrchen&#47;geektime-rust&#47;tree&#47;master&#47;04_httpie","user_name":"作者回复","user_name_real":"Tyr","uid":"1079375","ctime":1636556484,"ip_address":"","comment_id":319182,"utype":1}],"discussion_count":4,"race_medal":0,"score":"18815530951","product_id":100085301,"comment_content":"rust 1.56 按教程的代码编译不通过<br><br>将Cargo.toml改了下就可以了<br><br>[package]<br>name = &quot;httpie&quot;<br>version = &quot;0.1.0&quot;<br>edition = &quot;2021&quot;<br><br># See more keys and their definitions at https:&#47;&#47;doc.rust-lang.org&#47;cargo&#47;reference&#47;manifest.html<br><br>[dependencies]<br>anyhow = &quot;1&quot; # 错误处理<br>clap = &quot;=3.0.0-beta.4&quot; #命令行解释<br>clap_derive = &quot;=3.0.0-beta.4&quot;<br>colored = &quot;2&quot; # 命令终端多彩显示<br>jsonxf = &quot;1.1&quot; # JSON pretty print 格式化<br>mime = &quot;0.3&quot; # 处理 mime 类型<br>reqwest = { verson = &quot;0.11&quot;, features = [&quot;json&quot;]} # HTTP 客户端<br>tokio = { version = &quot;1&quot;, features = [&quot;full&quot;]} # 异步处理库","like_count":4,"discussions":[{"author":{"id":1079375,"avatar":"https://static001.geekbang.org/account/avatar/00/10/78/4f/e74f870c.jpg","nickname":"Tyr","note":"","ucode":"EAAFC8063202E0","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":529537,"discussion_content":"嗯，最新代码参考：https://github.com/tyrchen/geektime-rust/tree/master/04_httpie","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1636556484,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1564463,"avatar":"http://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTJZCkGPSOcvucpfLqRP3aqp3qRpwJKyzjNms4jMwibIkxpjiaszqiazSItCeo3IxqQSFvMDh66XaJ2zw/132","nickname":"JoeyLi666","note":"","ucode":"734864661E4BE0","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":538955,"discussion_content":"当年学C语言也没这么废劲啊","likes_number":1,"is_delete":false,"is_hidden":false,"ctime":1639562720,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1445744,"avatar":"https://static001.geekbang.org/account/avatar/00/16/0f/70/f59db672.jpg","nickname":"槑·先生","note":"","ucode":"897F0475592E3A","race_medal":2,"user_type":1,"is_pvip":true},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":539326,"discussion_content":"为啥我的机器上提示clap最高只能用2.33.3，3.x的都下载不了","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1639667569,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1093658,"avatar":"https://static001.geekbang.org/account/avatar/00/10/b0/1a/427c854c.jpg","nickname":"lemon","note":"","ucode":"360693FCFC8E8D","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":411387,"discussion_content":"You save my day! Thanks","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1635915309,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":325792,"user_name":"上弦の月","can_delete":false,"product_type":"c1","uid":2829059,"ip_address":"","ucode":"52B3AD3C22ABEA","user_header":"https://static001.geekbang.org/account/avatar/00/2b/2b/03/55a85ec1.jpg","comment_is_top":false,"comment_ctime":1639131044,"is_pvip":false,"replies":[{"id":"118816","content":"这是因为 3.0.0-rc.5 把宏放在 derive 下了。看 github 的更新","user_name":"作者回复","user_name_real":"编辑","uid":"1079375","ctime":1639804721,"ip_address":"","comment_id":325792,"utype":1}],"discussion_count":2,"race_medal":0,"score":"14524032932","product_id":100085301,"comment_content":"2021年12月10日<br><br>rustc --version<br>rustc 1.56.0 (09c42c458 2021-10-18)<br><br>cargo --version<br>cargo 1.56.0 (4ed5d137b 2021-10-04)<br><br>note: `Parser` is imported here, but it is only a trait, without a derive macro<br><br>使用了老师 GitHub 上面的最新代码还是报以下错误的同学，直接吧 Cargo.toml 中的 clap，加上 features = [ &quot;derive&quot; ]，来激活其派生宏能力：<br><br>clap = { version = &quot;3.0.0-beta.5&quot;, features = [&quot;derive&quot;]} # 命令行解析<br>","like_count":3,"discussions":[{"author":{"id":1079375,"avatar":"https://static001.geekbang.org/account/avatar/00/10/78/4f/e74f870c.jpg","nickname":"Tyr","note":"","ucode":"EAAFC8063202E0","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":539689,"discussion_content":"这是因为 3.0.0-rc.5 把宏放在 derive 下了。看 github 的更新","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1639804721,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":1,"child_discussions":[{"author":{"id":2829059,"avatar":"https://static001.geekbang.org/account/avatar/00/2b/2b/03/55a85ec1.jpg","nickname":"上弦の月","note":"","ucode":"52B3AD3C22ABEA","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":1079375,"avatar":"https://static001.geekbang.org/account/avatar/00/10/78/4f/e74f870c.jpg","nickname":"Tyr","note":"","ucode":"EAAFC8063202E0","race_medal":0,"user_type":2,"is_pvip":false},"discussion":{"id":539695,"discussion_content":"好的！","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1639805403,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":539689,"ip_address":""},"score":539695,"extra":""}]}]},{"had_liked":false,"id":312584,"user_name":"徐洲更","can_delete":false,"product_type":"c1","uid":1314643,"ip_address":"","ucode":"F8A323CB732D05","user_header":"https://static001.geekbang.org/account/avatar/00/14/0f/53/92a50f01.jpg","comment_is_top":false,"comment_ctime":1631877155,"is_pvip":true,"replies":[{"id":"113262","content":"clap 合并了 structopt （https:&#47;&#47;docs.rs&#47;structopt）的思路，我之前熟悉 structopt，所以了解。另外，看 clap 3.0 的文档需要访问：https:&#47;&#47;docs.rs&#47;clap&#47;3.0.0-beta.4&#47;clap&#47;index.html。注意由于它还是 beta，所以很多链接一不小心会跳到 2.33 的文档。","user_name":"作者回复","user_name_real":"Tyr","uid":"1079375","ctime":1631926527,"ip_address":"","comment_id":312584,"utype":1}],"discussion_count":2,"race_medal":0,"score":"14516779043","product_id":100085301,"comment_content":"这节课使用了clap进行命令行解析，我在看clap 的GitHub文档的时候，发现这种derive macros的参数写法应该是3.0.0版本后引进的，相关资料只看到一个exmaple。想知道老师是如何指导clap那么多用法的呢？","like_count":3,"discussions":[{"author":{"id":1079375,"avatar":"https://static001.geekbang.org/account/avatar/00/10/78/4f/e74f870c.jpg","nickname":"Tyr","note":"","ucode":"EAAFC8063202E0","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":527036,"discussion_content":"clap 合并了 structopt （https://docs.rs/structopt）的思路，我之前熟悉 structopt，所以了解。另外，看 clap 3.0 的文档需要访问：https://docs.rs/clap/3.0.0-beta.4/clap/index.html。注意由于它还是 beta，所以很多链接一不小心会跳到 2.33 的文档。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1631926527,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1314643,"avatar":"https://static001.geekbang.org/account/avatar/00/14/0f/53/92a50f01.jpg","nickname":"徐洲更","note":"","ucode":"F8A323CB732D05","race_medal":0,"user_type":1,"is_pvip":true},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":394568,"discussion_content":"还以为没有beta的文档呢，原来是一不小心都跳到2.33了 谢谢陈老师的解答 ","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1631942445,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":310880,"user_name":"麋鹿在泛舟","can_delete":false,"product_type":"c1","uid":1121975,"ip_address":"","ucode":"1379CADA08688E","user_header":"https://static001.geekbang.org/account/avatar/00/11/1e/b7/b20ab184.jpg","comment_is_top":false,"comment_ctime":1630945022,"is_pvip":true,"replies":[{"id":"112677","content":"嗯，现代编程语言的依赖基本上都会从网络上直接拿。python，golang，nodejs 都是如此。不过 Rust 的 cargo  是用起来最方便的（毕竟有后发优势）。<br><br>C++ 也有 template &#47; interface 等类似的功能。从这个角度讲，大家旗鼓相当。不过 Rust 标准库和整个生态花了大力气做零成本抽象，把一些复杂的表述用编译器优雅地抽象掉了，比如 async&#47;await 的实现，再比如 Rust 里大量的函数式编程方法。此外，Rust 还可以通过功能强大的过程宏，来自动完成很多复杂 trait 的定义，所以，从抽象的角度，Rust 更强大，在几乎不牺牲性能的情况下，可以写出更简洁的代码。","user_name":"作者回复","user_name_real":"Tyr","uid":"1079375","ctime":1630988491,"ip_address":"","comment_id":310880,"utype":1}],"discussion_count":1,"race_medal":0,"score":"14515846910","product_id":100085301,"comment_content":"通过这节课介绍初识rust，对比c++感觉有如下区别:<br>1. 看起来rust程序编译依赖网络，会编实时编译依赖的库，相应的引入三方包非常方便； 而不像c++要到三方库的网页上去找编译和引用的方式，要适配到自己的平台上。<br>2. 通过rust、宏和trait等机制把非核心的诸如校验等逻辑隔离在各自的函数中, 大幅度降低了耦合。<br><br>所以理论上rust可以写出更加简洁的代码吗？","like_count":3,"discussions":[{"author":{"id":1079375,"avatar":"https://static001.geekbang.org/account/avatar/00/10/78/4f/e74f870c.jpg","nickname":"Tyr","note":"","ucode":"EAAFC8063202E0","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":526387,"discussion_content":"嗯，现代编程语言的依赖基本上都会从网络上直接拿。python，golang，nodejs 都是如此。不过 Rust 的 cargo  是用起来最方便的（毕竟有后发优势）。\n\nC++ 也有 template / interface 等类似的功能。从这个角度讲，大家旗鼓相当。不过 Rust 标准库和整个生态花了大力气做零成本抽象，把一些复杂的表述用编译器优雅地抽象掉了，比如 async/await 的实现，再比如 Rust 里大量的函数式编程方法。此外，Rust 还可以通过功能强大的过程宏，来自动完成很多复杂 trait 的定义，所以，从抽象的角度，Rust 更强大，在几乎不牺牲性能的情况下，可以写出更简洁的代码。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1630988491,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":310452,"user_name":"罗杰","can_delete":false,"product_type":"c1","uid":1320487,"ip_address":"","ucode":"96BAFAA147341F","user_header":"https://static001.geekbang.org/account/avatar/00/14/26/27/eba94899.jpg","comment_is_top":false,"comment_ctime":1630659156,"is_pvip":false,"replies":[{"id":"112483","content":"👍","user_name":"作者回复","user_name_real":"Tyr","uid":"1079375","ctime":1630684193,"ip_address":"","comment_id":310452,"utype":1}],"discussion_count":3,"race_medal":2,"score":"14515561044","product_id":100085301,"comment_content":"fn print_body(m: Option&lt;Mime&gt;, body: &amp;String) {<br>    match m {<br>        Some(v) if v.to_string().contains(&quot;application&#47;json&quot;) =&gt; {<br>            println!(&quot;{}&quot;, jsonxf::pretty_print(body).unwrap().cyan())<br>        }<br>        _ =&gt; println!(&quot;{}&quot;, body),<br>    }<br>}<br>优化了一下程序。","like_count":3,"discussions":[{"author":{"id":1079375,"avatar":"https://static001.geekbang.org/account/avatar/00/10/78/4f/e74f870c.jpg","nickname":"Tyr","note":"","ucode":"EAAFC8063202E0","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":526240,"discussion_content":"👍","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1630684193,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":2,"child_discussions":[{"author":{"id":1243961,"avatar":"http://thirdwx.qlogo.cn/mmopen/vi_32/VLB1WPGVDnicKaMGUcFZdtDQOXSib3LhFv6YqCZA16qfy2KHUAGL0ichSEE6rSu8HXSibGdg8vzIQ7qWlk9BZOeJjQ/132","nickname":"Curricane","note":"","ucode":"3778B96444874E","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":1079375,"avatar":"https://static001.geekbang.org/account/avatar/00/10/78/4f/e74f870c.jpg","nickname":"Tyr","note":"","ucode":"EAAFC8063202E0","race_medal":0,"user_type":2,"is_pvip":false},"discussion":{"id":537549,"discussion_content":"这么写，有什么好处么？","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1639101639,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":526240,"ip_address":""},"score":537549,"extra":""},{"author":{"id":1046714,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/f8/ba/14e05601.jpg","nickname":"约书亚","note":"","ucode":"81EA27ADD9EC1A","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":1243961,"avatar":"http://thirdwx.qlogo.cn/mmopen/vi_32/VLB1WPGVDnicKaMGUcFZdtDQOXSib3LhFv6YqCZA16qfy2KHUAGL0ichSEE6rSu8HXSibGdg8vzIQ7qWlk9BZOeJjQ/132","nickname":"Curricane","note":"","ucode":"3778B96444874E","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":574780,"discussion_content":"application/json;charset=utf-8","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1654331747,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":537549,"ip_address":""},"score":574780,"extra":""}]}]},{"had_liked":false,"id":309648,"user_name":"pedro","can_delete":false,"product_type":"c1","uid":1200704,"ip_address":"","ucode":"F40C839DDFD599","user_header":"https://static001.geekbang.org/account/avatar/00/12/52/40/e57a736e.jpg","comment_is_top":false,"comment_ctime":1630289426,"is_pvip":false,"replies":[{"id":"112137","content":"1. 不需要。为什么要 nightly 版本呢？<br>2. 谢谢纠正。这个地方似乎是我从 notion 把稿件拷过来是自动给我加上的，我让编辑修更新一下。完整代码可以在：https:&#47;&#47;github.com&#47;tyrchen&#47;geektime-rust&#47;tree&#47;master&#47;04_httpie 上访问。<br>3. 和 2 是同一个问题，格式有误。<br>4. syntect 支持几乎所有语言和文本格式。","user_name":"作者回复","user_name_real":"Tyr","uid":"1079375","ctime":1630297537,"ip_address":"","comment_id":309648,"utype":1}],"discussion_count":3,"race_medal":0,"score":"14515191314","product_id":100085301,"comment_content":"四个点：<br>1. rust 要使用 nightly 版；<br>2. Url 解析，不能有&lt;&gt;，应该是：parse_url(&quot;http:&#47;&#47;abc.xyz&quot;)；<br>3. print 或者 println 输出换行时，应该是 \\n 而不是 \\\\n；<br>4. syntect 对于 json 支持是很方便的，参考：https:&#47;&#47;github.com&#47;trishume&#47;syntect&#47;blob&#47;master&#47;examples&#47;syncat.rs。<br><br>","like_count":3,"discussions":[{"author":{"id":1079375,"avatar":"https://static001.geekbang.org/account/avatar/00/10/78/4f/e74f870c.jpg","nickname":"Tyr","note":"","ucode":"EAAFC8063202E0","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":525946,"discussion_content":"1. 不需要。为什么要 nightly 版本呢？\n2. 谢谢纠正。这个地方似乎是我从 notion 把稿件拷过来是自动给我加上的，我让编辑修更新一下。完整代码可以在：https://github.com/tyrchen/geektime-rust/tree/master/04_httpie 上访问。\n3. 和 2 是同一个问题，格式有误。\n4. syntect 支持几乎所有语言和文本格式。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1630297537,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":2750034,"avatar":"https://static001.geekbang.org/account/avatar/00/29/f6/52/41b2da51.jpg","nickname":"黑夜路人","note":"","ucode":"328B74E78EFACC","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":583854,"discussion_content":"你是中国编程界的未来","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1660447045,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":"上海"},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1200704,"avatar":"https://static001.geekbang.org/account/avatar/00/12/52/40/e57a736e.jpg","nickname":"pedro","note":"","ucode":"F40C839DDFD599","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":391110,"discussion_content":"error[E0658]: arbitrary expressions in key-value attributes are unstable\n --> .../github.com-1ecc6299db9ec823/clap-3.0.0-beta.4/src/lib.rs:8:10\n  |\n8 | #![doc = include_str!(&#34;../README.md&#34;)]\n  |          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  |\n  = note: see issue #78835 <https://github.com/rust-lang/rust/issues/78835> for more information\n\nclap-3.0.0-beta.4 中的使用了 unstable 特性","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1630298066,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":309635,"user_name":"阿海","can_delete":false,"product_type":"c1","uid":1281585,"ip_address":"","ucode":"2589431F840C42","user_header":"https://static001.geekbang.org/account/avatar/00/13/8e/31/28972804.jpg","comment_is_top":false,"comment_ctime":1630284888,"is_pvip":true,"replies":[{"id":"112138","content":"嗯，这需要一定时间的学习和历练。","user_name":"作者回复","user_name_real":"Tyr","uid":"1079375","ctime":1630297562,"ip_address":"","comment_id":309635,"utype":1}],"discussion_count":1,"race_medal":0,"score":"14515186776","product_id":100085301,"comment_content":"这一期小程序挺好的。上上周刚看完rust官网上的非官方文档，基本能看懂代码，但是要自己写出来就难了。期待下一期","like_count":3,"discussions":[{"author":{"id":1079375,"avatar":"https://static001.geekbang.org/account/avatar/00/10/78/4f/e74f870c.jpg","nickname":"Tyr","note":"","ucode":"EAAFC8063202E0","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":525940,"discussion_content":"嗯，这需要一定时间的学习和历练。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1630297562,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":349771,"user_name":"亮亮","can_delete":false,"product_type":"c1","uid":2879190,"ip_address":"","ucode":"61C14F0E8AD8F7","user_header":"https://static001.geekbang.org/account/avatar/00/2b/ee/d6/d04e56db.jpg","comment_is_top":false,"comment_ctime":1656319543,"is_pvip":false,"discussion_count":1,"race_medal":3,"score":"10246254135","product_id":100085301,"comment_content":"windows下 使用 cargo run post https:&#47;&#47;httpbin.org&#47;post greeting=hola name=Tyr，显示正常，cargo build --release后，单独使用httpie，显示乱码...怎么解决啊？？","like_count":2,"discussions":[{"author":{"id":2013251,"avatar":"https://static001.geekbang.org/account/avatar/00/1e/b8/43/015e2cc0.jpg","nickname":"Silwings","note":"","ucode":"9737DB3230B797","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":587971,"discussion_content":"我也是哎,不知道怎么解决","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1663412639,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":"上海"},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":342904,"user_name":"Geek_3b4ddd","can_delete":false,"product_type":"c1","uid":2979203,"ip_address":"","ucode":"64D5425C76FE53","user_header":"","comment_is_top":false,"comment_ctime":1650528975,"is_pvip":false,"discussion_count":1,"race_medal":0,"score":"10240463567","product_id":100085301,"comment_content":"httpie 1.0<br>Tyr Chen &lt;tyr@chen.com&gt;<br>A naive httpie implementation with Rust, can you imagine how easy it is?<br><br>USAGE:<br>    httpie.exe &lt;SUBCOMMAND&gt;<br><br>OPTIONS:<br>    -h, --help       Print help information<br>    -V, --version    Print version information<br><br>SUBCOMMANDS:<br>    get     feed get with an url and we will retrieve the response for you<br>    help    Print this message or the help of the given subcommand(s)<br>    post    feed post with an url and optional key=value pairs. We will post the data as JSON,<br>                and retrieve the response for you<br>error: process didn&#39;t exit successfully: `target\\debug\\httpie.exe` (exit code: 2)<br>这是为啥，编译通过了，运行不通过","like_count":2,"discussions":[{"author":{"id":2991652,"avatar":"https://static001.geekbang.org/account/avatar/00/2d/a6/24/961129f1.jpg","nickname":"forever 蒙","note":"","ucode":"472EB8946A3F96","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":575332,"discussion_content":"同问\n","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1654755288,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":312802,"user_name":"Zilr","can_delete":false,"product_type":"c1","uid":1159437,"ip_address":"","ucode":"A38FD050DB316B","user_header":"https://thirdwx.qlogo.cn/mmopen/vi_32/tNAmMmIN8MMCd1Leto5gtH2XhIzVRgAeqe6RJOsibEZtPpQH81MBvxu6xY5pL2fgkqNzgerQwYrmO9U3UYU2Tmw/132","comment_is_top":false,"comment_ctime":1632030854,"is_pvip":false,"replies":[{"id":"113404","content":"colored 应该可以在 windows 下的 powershell 工作。你可以试试在 main 函数最开始加一句：<br><br>control::set_virtual_terminal(false).unwrap();<br><br>来源：https:&#47;&#47;github.com&#47;mackwic&#47;colored&#47;blob&#47;015f2a58bfac8da6f0db8518c6813c79ec063f7f&#47;src&#47;control.rs#L7","user_name":"作者回复","user_name_real":"Tyr","uid":"1079375","ctime":1632240338,"ip_address":"","comment_id":312802,"utype":1}],"discussion_count":1,"race_medal":0,"score":"10221965446","product_id":100085301,"comment_content":"陈老师， 为啥我用win10 powershell 和 cmd 运行的话， 都是乱码？","like_count":2,"discussions":[{"author":{"id":1079375,"avatar":"https://static001.geekbang.org/account/avatar/00/10/78/4f/e74f870c.jpg","nickname":"Tyr","note":"","ucode":"EAAFC8063202E0","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":527117,"discussion_content":"colored 应该可以在 windows 下的 powershell 工作。你可以试试在 main 函数最开始加一句：\n\ncontrol::set_virtual_terminal(false).unwrap();\n\n来源：https://github.com/mackwic/colored/blob/015f2a58bfac8da6f0db8518c6813c79ec063f7f/src/control.rs#L7","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1632240338,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":310376,"user_name":"GengTeng","can_delete":false,"product_type":"c1","uid":1224623,"ip_address":"","ucode":"3F926F5EF1D075","user_header":"https://static001.geekbang.org/account/avatar/00/12/af/af/8b03ce2c.jpg","comment_is_top":false,"comment_ctime":1630634981,"is_pvip":false,"replies":[{"id":"112459","content":"嗯。可以直接用 Url，但在传给 reqwest 时需要 to_string 或者 clone 一下。","user_name":"作者回复","user_name_real":"Tyr","uid":"1079375","ctime":1630651444,"ip_address":"","comment_id":310376,"utype":1}],"discussion_count":2,"race_medal":0,"score":"10220569573","product_id":100085301,"comment_content":"结构体里的url直接用url库里的Url类型就行了，用String还得自己检查一遍。","like_count":2,"discussions":[{"author":{"id":1079375,"avatar":"https://static001.geekbang.org/account/avatar/00/10/78/4f/e74f870c.jpg","nickname":"Tyr","note":"","ucode":"EAAFC8063202E0","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":526210,"discussion_content":"嗯。可以直接用 Url，但在传给 reqwest 时需要 to_string 或者 clone 一下。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1630651444,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1224623,"avatar":"https://static001.geekbang.org/account/avatar/00/12/af/af/8b03ce2c.jpg","nickname":"GengTeng","note":"","ucode":"3F926F5EF1D075","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":392405,"discussion_content":"&amp;str或者&amp;String本身也是每次parse成一个新的Url，所以新分配空间的开销省不了，我选择减少parse的开销 ；而且Url提供了编译期保证安全的结构，String经过检查仍然是个String的话，只有我知道它是检查过的，编译器不知道，围绕它设计的接口应该比围绕Url设计的接口更容易误用。:P","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1630996522,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":309674,"user_name":"springXu","can_delete":false,"product_type":"c1","uid":2064750,"ip_address":"","ucode":"F5DB0B963C894F","user_header":"","comment_is_top":false,"comment_ctime":1630298056,"is_pvip":true,"replies":[{"id":"112144","content":"reqwest 直接支持 HTTPS，我的例子用的就是 HTTPS。Rust 对于 TLS 的支持除了 Openssl 外，还有用 Rust 撰写的 Rustls 库，其内部使用 ring 这个加解密库。其它还有 https:&#47;&#47;github.com&#47;dalek-cryptography 推出的一系列加密库。","user_name":"作者回复","user_name_real":"Tyr","uid":"1079375","ctime":1630299633,"ip_address":"","comment_id":309674,"utype":1}],"discussion_count":2,"race_medal":0,"score":"10220232648","product_id":100085301,"comment_content":"能否支持HTTPS，rust有什么加解密的库？","like_count":2,"discussions":[{"author":{"id":1079375,"avatar":"https://static001.geekbang.org/account/avatar/00/10/78/4f/e74f870c.jpg","nickname":"Tyr","note":"","ucode":"EAAFC8063202E0","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":525959,"discussion_content":"reqwest 直接支持 HTTPS，我的例子用的就是 HTTPS。Rust 对于 TLS 的支持除了 Openssl 外，还有用 Rust 撰写的 Rustls 库，其内部使用 ring 这个加解密库。其它还有 https://github.com/dalek-cryptography 推出的一系列加密库。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1630299633,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":2064750,"avatar":"","nickname":"springXu","note":"","ucode":"F5DB0B963C894F","race_medal":0,"user_type":1,"is_pvip":true},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":391229,"discussion_content":"谢谢陈老师的回复。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1630342449,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":344054,"user_name":"好叶啊","can_delete":false,"product_type":"c1","uid":2774260,"ip_address":"","ucode":"81DDBFE7893EA7","user_header":"https://static001.geekbang.org/account/avatar/00/2a/54/f4/adcde69f.jpg","comment_is_top":false,"comment_ctime":1651214095,"is_pvip":false,"discussion_count":1,"race_medal":0,"score":"5946181391","product_id":100085301,"comment_content":"代码是抄完了，但是不知道怎么编译出来。cargo build --release后没有看到东西<br>","like_count":1,"discussions":[{"author":{"id":2853200,"avatar":"https://static001.geekbang.org/account/avatar/00/2b/89/50/aee9fdab.jpg","nickname":"小杰","note":"","ucode":"BBDF8E9F348F65","race_medal":0,"user_type":1,"is_pvip":true},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":575460,"discussion_content":"你构建完成release后，在你的httpie项目目录下，有一个和src在一个目录下的target目录，进入此目录，会有一个release和debug目录，然后进入release目录，你就会看到有可执行文件httpie了","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1654848967,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":326849,"user_name":"王彦霖","can_delete":false,"product_type":"c1","uid":2868952,"ip_address":"","ucode":"F9BFDD0C3657AB","user_header":"https://static001.geekbang.org/account/avatar/00/2b/c6/d8/672f1838.jpg","comment_is_top":false,"comment_ctime":1639720575,"is_pvip":true,"replies":[{"id":"118773","content":"使用了 anyhow::Result","user_name":"作者回复","user_name_real":"编辑","uid":"1079375","ctime":1639791957,"ip_address":"","comment_id":326849,"utype":1}],"discussion_count":3,"race_medal":0,"score":"5934687871","product_id":100085301,"comment_content":"Result&lt;String&gt;，这种写法编译器不会出错吗","like_count":1,"discussions":[{"author":{"id":1079375,"avatar":"https://static001.geekbang.org/account/avatar/00/10/78/4f/e74f870c.jpg","nickname":"Tyr","note":"","ucode":"EAAFC8063202E0","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":539622,"discussion_content":"使用了 anyhow::Result","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1639791957,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":2,"child_discussions":[{"author":{"id":2868952,"avatar":"https://static001.geekbang.org/account/avatar/00/2b/c6/d8/672f1838.jpg","nickname":"王彦霖","note":"","ucode":"F9BFDD0C3657AB","race_medal":0,"user_type":1,"is_pvip":true},"reply_author":{"id":1079375,"avatar":"https://static001.geekbang.org/account/avatar/00/10/78/4f/e74f870c.jpg","nickname":"Tyr","note":"","ucode":"EAAFC8063202E0","race_medal":0,"user_type":2,"is_pvip":false},"discussion":{"id":539633,"discussion_content":"啊，，恕我愚钝了😰","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1639792948,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":539622,"ip_address":""},"score":539633,"extra":""},{"author":{"id":2955905,"avatar":"","nickname":"Geek_7c6db9","note":"","ucode":"02FE056416BEB1","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":1079375,"avatar":"https://static001.geekbang.org/account/avatar/00/10/78/4f/e74f870c.jpg","nickname":"Tyr","note":"","ucode":"EAAFC8063202E0","race_medal":0,"user_type":2,"is_pvip":false},"discussion":{"id":559376,"discussion_content":"不用anyhow::Result的话, 直接用原生的Result怎么弄呢? ","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1648724100,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":539622,"ip_address":""},"score":559376,"extra":""}]}]},{"had_liked":false,"id":326713,"user_name":"JoeyLi666","can_delete":false,"product_type":"c1","uid":1564463,"ip_address":"","ucode":"734864661E4BE0","user_header":"http://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTJZCkGPSOcvucpfLqRP3aqp3qRpwJKyzjNms4jMwibIkxpjiaszqiazSItCeo3IxqQSFvMDh66XaJ2zw/132","comment_is_top":false,"comment_ctime":1639641858,"is_pvip":false,"replies":[{"id":"118778","content":"这并不是 Rust 不稳定，只是我用的 clap 版本的问题。你可以看 github repo 中的更新。课程 50 多讲，只有两讲我用了 clap 的 beta 版本而已。我可以选择 structopt 作为例子，但我希望 clap 3 稳定版出来之后大家已经熟悉，毕竟这是官方的版本。","user_name":"作者回复","user_name_real":"编辑","uid":"1079375","ctime":1639792449,"ip_address":"","comment_id":326713,"utype":1}],"discussion_count":3,"race_medal":0,"score":"5934609154","product_id":100085301,"comment_content":"就觉得这个rust真的不稳定，作者的代码没几个月就不能直接运行了，做教学的，不应该拿稳定的代码做讲解吗？","like_count":1,"discussions":[{"author":{"id":1079375,"avatar":"https://static001.geekbang.org/account/avatar/00/10/78/4f/e74f870c.jpg","nickname":"Tyr","note":"","ucode":"EAAFC8063202E0","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":539629,"discussion_content":"这并不是 Rust 不稳定，只是我用的 clap 版本的问题。你可以看 github repo 中的更新。课程 50 多讲，只有两讲我用了 clap 的 beta 版本而已。我可以选择 structopt 作为例子，但我希望 clap 3 稳定版出来之后大家已经熟悉，毕竟这是官方的版本。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1639792449,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":2890330,"avatar":"https://static001.geekbang.org/account/avatar/00/2c/1a/5a/c3a553dd.jpg","nickname":"少年 🎨","note":"","ucode":"6445B6FE7B767F","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":545994,"discussion_content":"快学不动了，代码跑不起来，评论区的我都看完了，也没解决clap 哎，老师救救孩子吧","likes_number":1,"is_delete":false,"is_hidden":false,"ctime":1642124336,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":548720,"discussion_content":"老师好，github上是完整的代码，能把每一步骤的代码修正下吗？","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1643340554,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":324163,"user_name":"懒蝈蝈","can_delete":false,"product_type":"c1","uid":1024788,"ip_address":"","ucode":"574F2CF1A705F0","user_header":"https://static001.geekbang.org/account/avatar/00/0f/a3/14/1f03f07d.jpg","comment_is_top":false,"comment_ctime":1638324227,"is_pvip":false,"replies":[{"id":"118871","content":"rust 版本更新快没关系，它是向后兼容的。这里主要是我并没有锁定 clap 的版本，使用了 beta 版本。","user_name":"作者回复","user_name_real":"编辑","uid":"1079375","ctime":1639849364,"ip_address":"","comment_id":324163,"utype":1}],"discussion_count":1,"race_medal":0,"score":"5933291523","product_id":100085301,"comment_content":"rust 版本 和库版本更新都太快。。。原文章片段验证输入命令行的代码要如下更新<br>cargo.toml 中：<br>[package]<br>name = &quot;httpie&quot;<br>version = &quot;0.1.0&quot;<br>edition = &quot;2021&quot;<br>[dependencies]<br>clap =&quot;3.0.0-beta.5&quot; #命令行解析<br><br>main.rs<br>use clap::Parser;<br><br>&#47;&#47; 定义 HTTPie 的 CLI 的主入口，它包含若干个子命令<br>&#47;&#47; 下面 &#47;&#47;&#47; 的注释是文档，clap 会将其作为 CLI 的帮助<br><br>&#47;&#47;&#47; A naive httpie implementation with Rust, can you imagine how easy it is?<br>#[derive(Parser, Debug)]<br>#[clap(version = &quot;1.0&quot;, author = &quot;lazyguoguo &lt;lazyguoguo@gmail.com&gt;&quot;)]<br>struct Opts {<br>    #[clap(subcommand)]<br>    subcmd: SubCommand,<br>}<br><br>&#47;&#47; 子命令分别对应不同的 HTTP 方法，目前只支持 get &#47; post<br>#[derive(Parser, Debug)]<br>enum SubCommand {<br>    Get(Get),<br>    Post(Post),<br>    &#47;&#47; 我们暂且不支持其它 HTTP 方法<br>}<br><br>&#47;&#47; get 子命令<br><br>&#47;&#47;&#47; feed get with an url and we will retrieve the response for you<br>#[derive(Parser, Debug)]<br>struct Get {<br>    &#47;&#47;&#47; HTTP 请求的 URL<br>    url: String,<br>}<br><br>&#47;&#47; post 子命令。需要输入一个 URL，和若干个可选的 key=value，用于提供 json body<br><br>&#47;&#47;&#47; feed post with an url and optional key=value pairs. We will post the data<br>&#47;&#47;&#47; as JSON, and retrieve the response for you<br>#[derive(Parser, Debug)]<br>struct Post {<br>    &#47;&#47;&#47; HTTP 请求的 URL<br>    url: String,<br>    &#47;&#47;&#47; HTTP 请求的 body<br>    body: Vec&lt;String&gt;,<br>}<br><br>fn main() {<br>    let opts: Opts = Opts::parse();<br>    println!(&quot;{:?}&quot;, opts);<br>} ","like_count":1,"discussions":[{"author":{"id":1079375,"avatar":"https://static001.geekbang.org/account/avatar/00/10/78/4f/e74f870c.jpg","nickname":"Tyr","note":"","ucode":"EAAFC8063202E0","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":539832,"discussion_content":"rust 版本更新快没关系，它是向后兼容的。这里主要是我并没有锁定 clap 的版本，使用了 beta 版本。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1639849364,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":322465,"user_name":"luckychacha","can_delete":false,"product_type":"c1","uid":1015118,"ip_address":"","ucode":"B85DBDDA83424F","user_header":"http://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTJajmDoTcvibPcGQ0VvLwF7ssiaKFygrtq1c3PydDR7F5mbFOAnMGTfOEU6EoSsAlZgJ3oFGY91Jgyw/132","comment_is_top":false,"comment_ctime":1637402049,"is_pvip":false,"replies":[{"id":"118904","content":"看 github repo 里的代码。","user_name":"作者回复","user_name_real":"编辑","uid":"1079375","ctime":1639851875,"ip_address":"","comment_id":322465,"utype":1}],"discussion_count":1,"race_medal":0,"score":"5932369345","product_id":100085301,"comment_content":"找不到 Clap的原因可能是v3.0.0-beta.5 (2021-10-18) 有更新：<br>Renamed Traits<br>clap::Clap =&gt; clap::Parser","like_count":1,"discussions":[{"author":{"id":1079375,"avatar":"https://static001.geekbang.org/account/avatar/00/10/78/4f/e74f870c.jpg","nickname":"Tyr","note":"","ucode":"EAAFC8063202E0","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":539865,"discussion_content":"看 github repo 里的代码。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1639851875,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":319796,"user_name":"pz","can_delete":false,"product_type":"c1","uid":2820198,"ip_address":"","ucode":"4860CE76AF0DA3","user_header":"https://static001.geekbang.org/account/avatar/00/2b/08/66/097cb2a1.jpg","comment_is_top":false,"comment_ctime":1635944624,"is_pvip":false,"replies":[{"id":"116376","content":"不要按 cargo.toml 提示修改，它只是告诉如果代码编译有问题。因为 clap 是 beta，有破坏性更新，如果编译不过，请参考 https:&#47;&#47;github.com&#47;tyrchen&#47;geektime-rust&#47;tree&#47;master&#47;04_httpie 上的代码。","user_name":"作者回复","user_name_real":"Tyr","uid":"1079375","ctime":1636555560,"ip_address":"","comment_id":319796,"utype":1}],"discussion_count":1,"race_medal":0,"score":"5930911920","product_id":100085301,"comment_content":"@陈老师，我编译遇到问题:<br><br>win10环境，编译器版本: rustc 1.56.0 (09c42c458 2021-10-18)<br><br>Cargo.toml 报错 clap = &quot;3.0.0-beta.4&quot;   X 2.33.3<br><br>按提示将版本改为 2.33.3 后<br>main.rs 报错:<br>3 | use clap::{AppSettings, Clap};<br>  |                                   ^^^^ no `Clap` in the root<br><br>查看 clap 文档: https:&#47;&#47;crates.io&#47;crates&#47;clap<br>有2种CLI命令参数配置方式: api &#47; yaml<br><br>是不是已经不支持 HTTPie 中使用的这种方式了呢？<br>","like_count":1,"discussions":[{"author":{"id":1079375,"avatar":"https://static001.geekbang.org/account/avatar/00/10/78/4f/e74f870c.jpg","nickname":"Tyr","note":"","ucode":"EAAFC8063202E0","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":529772,"discussion_content":"不要按 cargo.toml 提示修改，它只是告诉如果代码编译有问题。因为 clap 是 beta，有破坏性更新，如果编译不过，请参考 https://github.com/tyrchen/geektime-rust/tree/master/04_httpie 上的代码。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1636555560,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":316969,"user_name":"Junmax","can_delete":false,"product_type":"c1","uid":1556036,"ip_address":"","ucode":"25720F144F6DF1","user_header":"https://static001.geekbang.org/account/avatar/00/17/be/44/004aea70.jpg","comment_is_top":false,"comment_ctime":1634630377,"is_pvip":false,"replies":[{"id":"115271","content":"可以。你可以看看：https:&#47;&#47;github.com&#47;johnthagen&#47;min-sized-rust","user_name":"作者回复","user_name_real":"Tyr","uid":"1079375","ctime":1635131036,"ip_address":"","comment_id":316969,"utype":1}],"discussion_count":1,"race_medal":0,"score":"5929597673","product_id":100085301,"comment_content":"终于编译通过了，HTTPie...ye~ye~ye~<br>文件大小5.6M，感觉有点大了, 这方面还可以优化吗?","like_count":1,"discussions":[{"author":{"id":1079375,"avatar":"https://static001.geekbang.org/account/avatar/00/10/78/4f/e74f870c.jpg","nickname":"Tyr","note":"","ucode":"EAAFC8063202E0","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":528592,"discussion_content":"可以。你可以看看：https://github.com/johnthagen/min-sized-rust","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1635131036,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":310501,"user_name":"锋利","can_delete":false,"product_type":"c1","uid":2738653,"ip_address":"","ucode":"87387E845CB86F","user_header":"https://static001.geekbang.org/account/avatar/00/29/c9/dd/cd74393e.jpg","comment_is_top":false,"comment_ctime":1630683719,"is_pvip":false,"replies":[{"id":"112486","content":"嗯，谢谢纠正！我自己用的是 bash&#47;zsh&#47;fish，所以以后写命令行例子的时候会注意一下 windows 端。","user_name":"作者回复","user_name_real":"Tyr","uid":"1079375","ctime":1630687087,"ip_address":"","comment_id":310501,"utype":1}],"discussion_count":1,"race_medal":0,"score":"5925651015","product_id":100085301,"comment_content":"window 平台 powershell 应该用这个命令：<br>cargo build --quiet | target&#47;debug&#47;httpie post httpbin.org&#47;post a=1 b=2  <br>用 &amp;&amp; 会提示 ： 标记“&amp;&amp;”不是此版本中的有效语句分隔符。","like_count":1,"discussions":[{"author":{"id":1079375,"avatar":"https://static001.geekbang.org/account/avatar/00/10/78/4f/e74f870c.jpg","nickname":"Tyr","note":"","ucode":"EAAFC8063202E0","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":526253,"discussion_content":"嗯，谢谢纠正！我自己用的是 bash/zsh/fish，所以以后写命令行例子的时候会注意一下 windows 端。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1630687087,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":309726,"user_name":"伦胖胖不胖","can_delete":false,"product_type":"c1","uid":1146045,"ip_address":"","ucode":"24CEEB5B2B8BEA","user_header":"https://static001.geekbang.org/account/avatar/00/11/7c/bd/70232c22.jpg","comment_is_top":false,"comment_ctime":1630314406,"is_pvip":true,"replies":[{"id":"112237","content":"对，这里专门少些了 url，所以如果我们不对用户输入进行校验的话，会解析到错误的结果。这里为了引出下面 parse_url 的代码故意输入错误。","user_name":"作者回复","user_name_real":"Tyr","uid":"1079375","ctime":1630379365,"ip_address":"","comment_id":309726,"utype":1}],"discussion_count":1,"race_medal":0,"score":"5925281702","product_id":100085301,"comment_content":"❯ cargo build --quiet &amp;&amp; target&#47;debug&#47;httpie post a=1 b=2<br>Opts { subcmd: Post(Post { url: &quot;a=1&quot;, body: [&quot;b=2&quot;] }) }<br><br>这个地方post后面少了 url吧。","like_count":1,"discussions":[{"author":{"id":1079375,"avatar":"https://static001.geekbang.org/account/avatar/00/10/78/4f/e74f870c.jpg","nickname":"Tyr","note":"","ucode":"EAAFC8063202E0","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":525983,"discussion_content":"对，这里专门少些了 url，所以如果我们不对用户输入进行校验的话，会解析到错误的结果。这里为了引出下面 parse_url 的代码故意输入错误。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1630379365,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":360918,"user_name":"sniper","can_delete":false,"product_type":"c1","uid":1323390,"ip_address":"山东","ucode":"54D4667EF16043","user_header":"https://static001.geekbang.org/account/avatar/00/14/31/7e/4b9736c5.jpg","comment_is_top":false,"comment_ctime":1666974497,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1666974497","product_id":100085301,"comment_content":"老师，新学啊。老报错。这章过不去了，现在的cargo 1.64.0 (387270bc7 2022-09-16)<br>rustc 1.64.0 (a55dd71d5 2022-09-19)<br>运行那个第一个命令后报错：zsh: parse error near `}&#39;","like_count":0},{"had_liked":false,"id":359755,"user_name":"拾一维","can_delete":false,"product_type":"c1","uid":3193929,"ip_address":"广东","ucode":"31656163586B4C","user_header":"https://static001.geekbang.org/account/avatar/00/30/bc/49/d96fcd85.jpg","comment_is_top":false,"comment_ctime":1665839135,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1665839135","product_id":100085301,"comment_content":"#[derive(Debug, Parser)]<br>struct Get {<br>    &#47;&#47; #[(parse(try_from_str = parse_url))]<br>    url: String,<br>}<br><br>#[derive(Debug, Parser)]<br>struct Post {<br>    &#47;&#47; #[clap(parse(try_from_str = parse_url))]<br>    url: String,<br>    &#47;&#47; #[clap(parse(try_from_str = parse_kv_pair))]<br>    body: Vec&lt;KvPair&gt;,<br>}，朋友们，老师代码库中这边有两个实现，现在已经不用这种写法啦（代码注掉的内容），只要类型实现了Parser trait，在解析时，会自动匹配相应的方法。更多内容请参考https:&#47;&#47;github.com&#47;clap-rs&#47;clap&#47;pull&#47;2298&#47;commits&#47;7bf392885629e2c4eda25894933a69f0d4fcad22","like_count":0},{"had_liked":false,"id":359602,"user_name":"Geek_410063","can_delete":false,"product_type":"c1","uid":3199951,"ip_address":"北京","ucode":"7242AFEB13858B","user_header":"","comment_is_top":false,"comment_ctime":1665671569,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1665671569","product_id":100085301,"comment_content":"rust 这一个小项目编译完 target目录 2、3G占用，堪比npm黑洞，心疼硬盘一秒。","like_count":0},{"had_liked":false,"id":359204,"user_name":"都市夜归人","can_delete":false,"product_type":"c1","uid":1071909,"ip_address":"北京","ucode":"DFF59BE3D80B42","user_header":"https://static001.geekbang.org/account/avatar/00/10/5b/25/d78cc1fe.jpg","comment_is_top":false,"comment_ctime":1665323388,"is_pvip":true,"discussion_count":0,"race_medal":0,"score":"1665323388","product_id":100085301,"comment_content":"希望能将代码更新到最新版本的rust环境，否则根本跑不通。严重影响进一步学习。","like_count":0},{"had_liked":false,"id":358829,"user_name":"salt","can_delete":false,"product_type":"c1","uid":1056332,"ip_address":"湖南","ucode":"A7D8D09E12353B","user_header":"https://static001.geekbang.org/account/avatar/00/10/1e/4c/d6416f57.jpg","comment_is_top":false,"comment_ctime":1664865667,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1664865667","product_id":100085301,"comment_content":"最新的clap  &quot;4.0.9&quot;<br>toml:<br>```<br>clap =  { version = &quot;4.0.9&quot;, features = [&quot;derive&quot;] } <br>```<br><br>src:<br><br>```<br>use clap::{Parser, Subcommand, Args};<br><br>#[derive(Parser, Debug)]<br>#[command(version = &quot;1.0&quot;, author = &quot;Tyr Chen &lt;tyr@chen.com&gt;&quot;, about, long_about = None)]<br>struct Opts {<br>    #[command(subcommand)]<br>    subcmd: MySubCommand,<br>}<br><br>&#47;&#47; 子命令分别对应不同的 HTTP 方法，目前只支持 get &#47; post<br>#[derive(Subcommand, Debug)]<br>enum MySubCommand {<br>    Get(Get),<br>    Post(Post),<br>    &#47;&#47; 我们暂且不支持其它 HTTP 方法<br>}<br><br>&#47;&#47; get 子命令<br><br>&#47;&#47;&#47; feed get with an url and we will retrieve the response for you<br>#[derive(Args, Debug)]<br>struct Get {<br>    &#47;&#47;&#47; HTTP 请求的 URL<br>    #[arg(value_parser=parse_url)]<br>    url: String,<br>}<br><br>&#47;&#47; post 子命令。需要输入一个 URL，和若干个可选的 key=value，用于提供 json body<br><br>&#47;&#47;&#47; feed post with an url and optional key=value pairs. We will post the data<br>&#47;&#47;&#47; as JSON, and retrieve the response for you<br>#[derive(Args, Debug)]<br>struct Post {<br>    &#47;&#47;&#47; HTTP 请求的 URL<br>    #[arg(value_parser=parse_url)]<br>    url: String,<br>    &#47;&#47;&#47; HTTP 请求的 body<br>    #[arg(value_parser=parse_kv_pair)]<br>    body: Vec&lt;KvPair&gt;,<br>}<br><br>&#47;&#47;&#47; 命令行中的 key=value 可以通过 parse_kv_pair 解析成 KvPair 结构<br>#[derive(Debug, Clone, PartialEq)]<br>struct KvPair {<br>    k: String,<br>    v: String,<br>}<br>```<br>","like_count":0},{"had_liked":false,"id":358810,"user_name":"此间的少年","can_delete":false,"product_type":"c1","uid":3191018,"ip_address":"广东","ucode":"DFC944190ACB79","user_header":"https://static001.geekbang.org/account/avatar/00/30/b0/ea/98986b75.jpg","comment_is_top":false,"comment_ctime":1664808451,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1664808451","product_id":100085301,"comment_content":"我想问下#[derive(Parser, Debug)] 为什么Debug要放在后面","like_count":0},{"had_liked":false,"id":358619,"user_name":"都市夜归人","can_delete":false,"product_type":"c1","uid":1071909,"ip_address":"北京","ucode":"DFF59BE3D80B42","user_header":"https://static001.geekbang.org/account/avatar/00/10/5b/25/d78cc1fe.jpg","comment_is_top":false,"comment_ctime":1664499430,"is_pvip":true,"discussion_count":0,"race_medal":0,"score":"1664499430","product_id":100085301,"comment_content":"PS F:\\rust\\httpie&gt; cargo -V<br>cargo 1.64.0 (387270bc7 2022-09-16)<br>PS F:\\rust\\httpie&gt; rustc -V<br>rustc 1.64.0 (a55dd71d5 2022-09-19)<br>======<br>[dependencies]<br>anyhow = &quot;1&quot;<br>clap = &quot;4.0.4&quot;<br>colored = &quot;2&quot;<br>jsonxf = &quot;1.1&quot;<br>mime = &quot;0.3&quot;<br>reqwest = {version = &quot;0.11.12&quot;, features = [&quot;blocking&quot;]} # http客户端<br>tokio = {version = &quot;1&quot;, features=[&quot;full&quot;]} # 异步处理库<br>=======<br>按上面的依赖，下面的引用报错了<br>use clap::{AppSettings, Clap};<br>错误信息：unresolved imports `clap::AppSettings`, `clap::Clap` no `AppSettings` in the root","like_count":0},{"had_liked":false,"id":355981,"user_name":"机智帅气的小雨","can_delete":false,"product_type":"c1","uid":1608963,"ip_address":"北京","ucode":"E2CDEB9D7F43F5","user_header":"https://static001.geekbang.org/account/avatar/00/18/8d/03/2cfad860.jpg","comment_is_top":false,"comment_ctime":1661907003,"is_pvip":false,"discussion_count":1,"race_medal":0,"score":"1661907003","product_id":100085301,"comment_content":"小白请教一下，在当前 cargo 项目下可以直接执行 target&#47;release&#47;httpie, 下级目录下执行 release&#47;httpie， 都是可以的，为啥跑到 httpie 下直接执行 httpie 会zsh 没有配置呢；是因为单个字段就必须要在 zsh 上先配置命令嘛","like_count":0,"discussions":[{"author":{"id":2422120,"avatar":"https://static001.geekbang.org/account/avatar/00/24/f5/68/66ce1b44.jpg","nickname":"名","note":"","ucode":"B68EF9B692C02C","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":586239,"discussion_content":"没有./","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1662050854,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":"广东"},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":354819,"user_name":"Geek_a6c6ce","can_delete":false,"product_type":"c1","uid":3074996,"ip_address":"荷兰","ucode":"21DC76D3225403","user_header":"https://thirdwx.qlogo.cn/mmopen/vi_32/TusRVU51UggZGpicXMgH64Cb8jek0wyTOpagtUHNAj0EPbhbEv0FJpFU2K3glbtOdJXiaQ9o6QoEfv5PiaIu7rwng/132","comment_is_top":false,"comment_ctime":1660804879,"is_pvip":false,"discussion_count":1,"race_medal":0,"score":"1660804879","product_id":100085301,"comment_content":"[dependencies]<br>anyhow = &quot;1.0&quot; # 错误处理<br>clap = &quot;3.2.17&quot; # 命令行解析<br>colored = &quot;2.0.0&quot; # 命令终端多彩显示<br>jsonxf = &quot;1.1.1&quot; # JSON pretty print 格式化<br>mime = &quot;0.3.16&quot; # 处理 mime 类型<br>reqwest = { version = &quot;0.11.11&quot;, features = [&quot;json&quot;] } # HTTP 客户端<br>tokio = { version = &quot;1.20.1&quot;, features = [&quot;full&quot;] } # 异步处理库","like_count":0,"discussions":[{"author":{"id":2422120,"avatar":"https://static001.geekbang.org/account/avatar/00/24/f5/68/66ce1b44.jpg","nickname":"名","note":"","ucode":"B68EF9B692C02C","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":586238,"discussion_content":"你知道怎么写吗，用原来的代码编译不过的","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1662050789,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":"广东"},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":350312,"user_name":"沈畅","can_delete":false,"product_type":"c1","uid":1077953,"ip_address":"","ucode":"7404E41356B36B","user_header":"https://static001.geekbang.org/account/avatar/00/10/72/c1/59509397.jpg","comment_is_top":false,"comment_ctime":1656778067,"is_pvip":true,"discussion_count":0,"race_medal":0,"score":"1656778067","product_id":100085301,"comment_content":"有人遇到这个问题吗？<br>rust-analyzer failed to load workspace: &quot;cargo&quot; &quot;--version&quot; failed, exit code: 1<br>stderr:<br>error: command failed: &#39;cargo&#39;: 拒绝访问。 (os error 5)<br><br>","like_count":0},{"had_liked":false,"id":349062,"user_name":"GKNick","can_delete":false,"product_type":"c1","uid":1347231,"ip_address":"","ucode":"AE6D7674CE9D4B","user_header":"https://static001.geekbang.org/account/avatar/00/14/8e/9f/26b7e89b.jpg","comment_is_top":false,"comment_ctime":1655706837,"is_pvip":true,"discussion_count":0,"race_medal":0,"score":"1655706837","product_id":100085301,"comment_content":"老师，我目前版本是1.61.0，报错，是不是不建议使用这个版本","like_count":0},{"had_liked":false,"id":348854,"user_name":"IF!","can_delete":false,"product_type":"c1","uid":1197779,"ip_address":"","ucode":"F81E266463B9E6","user_header":"https://static001.geekbang.org/account/avatar/00/12/46/d3/cbdd17bd.jpg","comment_is_top":false,"comment_ctime":1655464663,"is_pvip":true,"discussion_count":0,"race_medal":0,"score":"1655464663","product_id":100085301,"comment_content":"vscode 会报这个错误 ：proc macro `clap` not expanded: proc macro not foundrust-analyzerunresolved-proc-macro<br>但是编译是可以通过的，这个怎么解决呢","like_count":0},{"had_liked":false,"id":348210,"user_name":"小杰","can_delete":false,"product_type":"c1","uid":2853200,"ip_address":"","ucode":"BBDF8E9F348F65","user_header":"https://static001.geekbang.org/account/avatar/00/2b/89/50/aee9fdab.jpg","comment_is_top":false,"comment_ctime":1654848095,"is_pvip":true,"discussion_count":0,"race_medal":0,"score":"1654848095","product_id":100085301,"comment_content":"syntect的仓库有一个Example Code，按照那个直接写一个print_syntect<br>fn print_syntect(s: &amp;str){<br>    &#47;&#47; Loa<br>    d these once at the start of your program<br>    let ps = SyntaxSet::load_defaults_newlines();<br>    let ts = ThemeSet::load_defaults();<br>    <br>    let syntax = ps.find_syntax_by_extension(&quot;rs&quot;).unwrap();<br>    let mut h = HighlightLines::new(syntax, &amp;ts.themes[&quot;base16-ocean.dark&quot;]);<br>    let s = s;<br>    for line in LinesWithEndings::from(s) {<br><br>        let ranges: Vec&lt;(Style, &amp;str)&gt; = h.highlight_line(line, &amp;ps).unwrap();<br>        let escaped = as_24_bit_terminal_escaped(&amp;ranges[..], true);<br>        print!(&quot;{}&quot;, escaped);<br><br>        }<br>}<br><br>然后把body里面的打印换一下就可以了<br>fn print_body(m: Option&lt;Mime&gt;, body: &amp;String) {<br>    match m {<br>        &#47;&#47; 对于 &quot;application&#47;json&quot; 我们 pretty print<br>        Some(v) if v == mime::APPLICATION_JSON =&gt; {<br>            print_syntect(body);<br>            &#47;&#47; println!(&quot;{}&quot;, jsonxf::pretty_print(body).unwrap().cyan())<br>        }<br>        &#47;&#47; 其它 mime type，我们就直接输出<br>        _ =&gt; println!(&quot;{}&quot;, body),<br>    }<br>}","like_count":0},{"had_liked":false,"id":347848,"user_name":"forever 蒙","can_delete":false,"product_type":"c1","uid":2991652,"ip_address":"","ucode":"472EB8946A3F96","user_header":"https://static001.geekbang.org/account/avatar/00/2d/a6/24/961129f1.jpg","comment_is_top":false,"comment_ctime":1654511210,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1654511210","product_id":100085301,"comment_content":"error: process didn&#39;t exit successfully: `target\\debug\\httpie.exe` (exit code: 2)求老师帮助解决，总是打出这个","like_count":0},{"had_liked":false,"id":346121,"user_name":"108度","can_delete":false,"product_type":"c1","uid":1015008,"ip_address":"","ucode":"085C8A8278C7D5","user_header":"https://static001.geekbang.org/account/avatar/00/0f/7c/e0/acbca24e.jpg","comment_is_top":false,"comment_ctime":1652846954,"is_pvip":true,"discussion_count":0,"race_medal":0,"score":"1652846954","product_id":100085301,"comment_content":"重新看了一遍，实践一遍，收获还是很大，还是得多看，多练","like_count":0},{"had_liked":false,"id":345648,"user_name":"gavin","can_delete":false,"product_type":"c1","uid":1171879,"ip_address":"","ucode":"8DAC42D1A564D1","user_header":"http://thirdwx.qlogo.cn/mmopen/KFgDEHIEpnT0EXnh02VHqCETJickQpyszbSo5uFBG1ZwdhnzpM2ibFP3v658Pj1ojOHTygibeXMhyFdl0AzSmZuVO4iacUnal8RV/132","comment_is_top":false,"comment_ctime":1652456034,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1652456034","product_id":100085301,"comment_content":"看到#标记的宏，总以为是注释","like_count":0},{"had_liked":false,"id":342107,"user_name":"xiong","can_delete":false,"product_type":"c1","uid":1099375,"ip_address":"","ucode":"C1BFD9EF96372F","user_header":"https://static001.geekbang.org/account/avatar/00/10/c6/6f/ac3003fa.jpg","comment_is_top":false,"comment_ctime":1650015364,"is_pvip":false,"replies":[{"id":"125092","content":"哈哈哈好玩吧先感受一下rust的风格，如果实在学习压力大可以去学学基础，学完再回来看。加油💪","user_name":"编辑回复","user_name_real":"编辑","uid":"2547771","ctime":1650262088,"ip_address":"","comment_id":342107,"utype":2}],"discussion_count":1,"race_medal":0,"score":"1650015364","product_id":100085301,"comment_content":"这一上来就放大招啊","like_count":0,"discussions":[{"author":{"id":2547771,"avatar":"https://static001.geekbang.org/account/avatar/00/26/e0/3b/8ec916b2.jpg","nickname":"多少","note":"","ucode":"0A6EF7AA6E4BB7","race_medal":0,"user_type":4,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":564506,"discussion_content":"哈哈哈好玩吧先感受一下rust的风格，如果实在学习压力大可以去学学基础，学完再回来看。加油💪","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1650262089,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":4}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":341169,"user_name":"CR","can_delete":false,"product_type":"c1","uid":2186767,"ip_address":"","ucode":"CE78F51366077F","user_header":"https://static001.geekbang.org/account/avatar/00/21/5e/0f/1a204ef7.jpg","comment_is_top":false,"comment_ctime":1649401667,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1649401667","product_id":100085301,"comment_content":"cargo build --quiet &amp;&amp; target&#47;debug&#47;httpie post a=1 b=2<br>想请教下post为啥是小写？","like_count":0},{"had_liked":false,"id":340742,"user_name":"群书","can_delete":false,"product_type":"c1","uid":1437036,"ip_address":"","ucode":"BA9EE71D2D818A","user_header":"https://static001.geekbang.org/account/avatar/00/15/ed/6c/6fb35017.jpg","comment_is_top":false,"comment_ctime":1649091398,"is_pvip":true,"replies":[{"id":"125094","content":"看到特别说明了吗？用GitHub上的最新代码，结合留言区的经验再试试💪","user_name":"编辑回复","user_name_real":"编辑","uid":"2547771","ctime":1650262401,"ip_address":"","comment_id":340742,"utype":2}],"discussion_count":1,"race_medal":0,"score":"1649091398","product_id":100085301,"comment_content":"CLI部分的代码，编译不过啊 ，直接复制老师的代码。<br>unresolved import `clap::Clap`","like_count":0,"discussions":[{"author":{"id":2547771,"avatar":"https://static001.geekbang.org/account/avatar/00/26/e0/3b/8ec916b2.jpg","nickname":"多少","note":"","ucode":"0A6EF7AA6E4BB7","race_medal":0,"user_type":4,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":564508,"discussion_content":"看到特别说明了吗？用GitHub上的最新代码，结合留言区的经验再试试💪","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1650262401,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":4}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":340294,"user_name":"Geek_7c6db9","can_delete":false,"product_type":"c1","uid":2955905,"ip_address":"","ucode":"02FE056416BEB1","user_header":"","comment_is_top":false,"comment_ctime":1648724258,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1648724258","product_id":100085301,"comment_content":"求更新一版, 照着例子做难度有点大了","like_count":0},{"had_liked":false,"id":337476,"user_name":"笨鸟先飞","can_delete":false,"product_type":"c1","uid":1258517,"ip_address":"","ucode":"BE2BE8D41D8111","user_header":"https://static001.geekbang.org/account/avatar/00/13/34/15/ec523036.jpg","comment_is_top":false,"comment_ctime":1646838737,"is_pvip":false,"discussion_count":1,"race_medal":0,"score":"1646838737","product_id":100085301,"comment_content":"第一段代码运行就失败了<br><br>cargo run -- post httpbin.org&#47;post a=1 b=2 --<br>   Compiling httpie v0.1.0 (&#47;Users&#47;sh00008ml&#47;rust-demo&#47;httppie)<br>error[E0432]: unresolved import `clap::Clap`<br> --&gt; src&#47;main.rs:2:25<br>  |<br>2 | use clap::{AppSettings, Clap};<br>  |                         ^^^^ no `Clap` in the root<br><br>error: cannot determine resolution for the derive macro `Clap`<br> --&gt; src&#47;main.rs:8:10<br>  |<br>8 | #[derive(Clap, Debug)]<br>  |          ^^^^<br>  |<br>  = note: import resolution is stuck, try simplifying macro imports<br><br>error: cannot find attribute `clap` in this scope<br> --&gt; src&#47;main.rs:9:3<br>  |<br>9 | #[clap(version = &quot;1.0&quot;, author = &quot;Tyr Chen &lt;tyr@chen.com&gt;&quot;)]<br>  |   ^^^^<br>  |<br>  = note: `clap` is in scope, but it is a crate, not an attribute<br><br>error: cannot find attribute `clap` in this scope<br>  --&gt; src&#47;main.rs:10:3<br>   |<br>10 | #[clap(setting = AppSettings::ColoredHelp)]<br>   |   ^^^^<br>   |<br>   = note: `clap` is in scope, but it is a crate, not an attribute<br><br>error: cannot find attribute `clap` in this scope<br>  --&gt; src&#47;main.rs:12:7<br>   |<br>12 |     #[clap(subcommand)]<br>   |       ^^^^<br>   |<br>   = note: `clap` is in scope, but it is a crate, not an attribute<br><br>error: cannot determine resolution for the derive macro `Clap`<br>  --&gt; src&#47;main.rs:17:10<br>   |<br>17 | #[derive(Clap, Debug)]<br>   |          ^^^^<br>   |<br>   = note: import resolution is stuck, try simplifying macro imports<br><br>error: cannot determine resolution for the derive macro `Clap`<br>  --&gt; src&#47;main.rs:27:10<br>   |<br>27 | #[derive(Clap, Debug)]<br>   |          ^^^^<br>   |<br>   = note: import resolution is stuck, try simplifying macro imports<br><br>error: cannot determine resolution for the derive macro `Clap`<br>  --&gt; src&#47;main.rs:37:10<br>   |<br>37 | #[derive(Clap, Debug)]<br>   |          ^^^^<br>   |<br>   = note: import resolution is stuck, try simplifying macro imports<br><br>warning: unused import: `AppSettings`<br> --&gt; src&#47;main.rs:2:12<br>  |<br>2 | use clap::{AppSettings, Clap};<br>  |            ^^^^^^^^^^^<br>  ","like_count":0,"discussions":[{"author":{"id":2853200,"avatar":"https://static001.geekbang.org/account/avatar/00/2b/89/50/aee9fdab.jpg","nickname":"小杰","note":"","ucode":"BBDF8E9F348F65","race_medal":0,"user_type":1,"is_pvip":true},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":575462,"discussion_content":"calp版本的问题，你换一下。老师提供的版本，然后换一种方式写，别用clap提供的parser，直接用parser。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1654849859,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":334716,"user_name":"Poikilotherm","can_delete":false,"product_type":"c1","uid":2440370,"ip_address":"","ucode":"C9809ED39E5C43","user_header":"https://static001.geekbang.org/account/avatar/00/25/3c/b2/538c02a5.jpg","comment_is_top":false,"comment_ctime":1645088857,"is_pvip":true,"discussion_count":1,"race_medal":0,"score":"1645088857","product_id":100085301,"comment_content":"老师请问一下，为什么我运行cargo build --quiet &amp;&amp; target&#47;debug&#47;httpie post httpbin.org&#47;post a=1 b=2Opts { subcmd: Post(Post { url: &quot;httpbin.org&#47;post&quot;, body: [&quot;a=1&quot;, &quot;b=2&quot;] }) } 这个会给我提示我多了个括号呢，很不解zsh: parse error near `}&#39;","like_count":0,"discussions":[{"author":{"id":2927617,"avatar":"https://thirdwx.qlogo.cn/mmopen/vi_32/wFFLMkicZicdsG0H4oETYokjdZvg9kzhbU31KGRDBNDc1cDZPa8tnOz0D9TNAibia4wLkLObnAGhvhksKsRibZnSKXA/132","nickname":"有原","note":"","ucode":"BA2B4911E66EDB","race_medal":0,"user_type":1,"is_pvip":true},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":554036,"discussion_content":"你输入的命令错了，只需要输入cargo build --quiet &amp;&amp; target/debug/httpie post httpbin.org/post a=1 b=2","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1646192186,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":332613,"user_name":"Microwood","can_delete":false,"product_type":"c1","uid":2086315,"ip_address":"","ucode":"B55201CCDB32A2","user_header":"https://static001.geekbang.org/account/avatar/00/1f/d5/ab/ee8f9a78.jpg","comment_is_top":false,"comment_ctime":1643369945,"is_pvip":false,"discussion_count":1,"race_medal":0,"score":"1643369945","product_id":100085301,"comment_content":"#[clap(parse(try_from_str=parse_kv_pair))]<br>找了半天源码，也没有找到clap 和 parse的定义在哪，求帮助","like_count":0,"discussions":[{"author":{"id":1926134,"avatar":"https://static001.geekbang.org/account/avatar/00/1d/63/f6/225df928.jpg","nickname":"Alice","note":"","ucode":"6D8F901229B182","race_medal":0,"user_type":8,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":550329,"discussion_content":"是需要看 parse 如何使用的嘛？还是在代码引用的位置？ \nClap Parser Trait 的文档：https://docs.rs/clap/3.0.14/clap/trait.Parser.html","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1644485521,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":331710,"user_name":"zoomdong","can_delete":false,"product_type":"c1","uid":1460980,"ip_address":"","ucode":"AA0B8F945D9935","user_header":"https://static001.geekbang.org/account/avatar/00/16/4a/f4/513d26e8.jpg","comment_is_top":false,"comment_ctime":1642733316,"is_pvip":false,"discussion_count":1,"race_medal":0,"score":"1642733316","product_id":100085301,"comment_content":"如果是 cargo build --release 之后要把 httpie 添加到 $PATH 下面去，应该怎么样操作呢？- - 这一步有点没太理解..","like_count":0,"discussions":[{"author":{"id":1926134,"avatar":"https://static001.geekbang.org/account/avatar/00/1d/63/f6/225df928.jpg","nickname":"Alice","note":"","ucode":"6D8F901229B182","race_medal":0,"user_type":8,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":550333,"discussion_content":"release 模式下 build 生成的可执行的二进制文件在 target/release 目录下面，如果你想在你的机器上全局运行，可以把这个目录加入到你的环境变量，如何增加可以搜索了解一下。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1644486012,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":331490,"user_name":"大螃蟹","can_delete":false,"product_type":"c1","uid":1341240,"ip_address":"","ucode":"E07E5AC3933435","user_header":"https://static001.geekbang.org/account/avatar/00/14/77/38/73c7902b.jpg","comment_is_top":false,"comment_ctime":1642600670,"is_pvip":true,"discussion_count":1,"race_medal":0,"score":"1642600670","product_id":100085301,"comment_content":"你好，我是新手，有一点我一直不明白<br>例如上面代码main函数头顶的#[tokio::main]是什么东西，类似的还有#[clap(subcommand)],放上面有什么用<br>这种语法我们可以自己定义出来供别人使用？","like_count":0,"discussions":[{"author":{"id":1926134,"avatar":"https://static001.geekbang.org/account/avatar/00/1d/63/f6/225df928.jpg","nickname":"Alice","note":"","ucode":"6D8F901229B182","race_medal":0,"user_type":8,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":550337,"discussion_content":"这些都是宏，不理解也不需要着急，后面会讲解到，先把代码跑起来","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1644486233,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":330524,"user_name":"chyuwei","can_delete":false,"product_type":"c1","uid":1361377,"ip_address":"","ucode":"19687765E6DE5D","user_header":"","comment_is_top":false,"comment_ctime":1642013407,"is_pvip":false,"replies":[{"id":"120697","content":"请参考 github 上的代码，那个是最新的","user_name":"作者回复","user_name_real":"编辑","uid":"1079375","ctime":1642293376,"ip_address":"","comment_id":330524,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1642013407","product_id":100085301,"comment_content":"clap3稳定了，需要改一下代码，看一下文档即可","like_count":0,"discussions":[{"author":{"id":1079375,"avatar":"https://static001.geekbang.org/account/avatar/00/10/78/4f/e74f870c.jpg","nickname":"Tyr","note":"","ucode":"EAAFC8063202E0","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":546306,"discussion_content":"请参考 github 上的代码，那个是最新的","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1642293376,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":330287,"user_name":"Lets Start From Here","can_delete":false,"product_type":"c1","uid":2890011,"ip_address":"","ucode":"FB690D9AD4C152","user_header":"https://static001.geekbang.org/account/avatar/00/2c/19/1b/17068569.jpg","comment_is_top":false,"comment_ctime":1641893740,"is_pvip":false,"replies":[{"id":"120706","content":"我试了一下，并没有错误。不过 examples 下的代码可以不用在 cargo.toml 里声明，你可以把他们都删掉试一下。","user_name":"作者回复","user_name_real":"编辑","uid":"1079375","ctime":1642297658,"ip_address":"","comment_id":330287,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1641893740","product_id":100085301,"comment_content":"用github上的代码执行cargo build后，提示如下错误，这个example写在toml下的作用可以解释一下吗？<br>Caused by:<br>  can&#39;t find `cli` example, specify example.path<br>","like_count":0,"discussions":[{"author":{"id":1079375,"avatar":"https://static001.geekbang.org/account/avatar/00/10/78/4f/e74f870c.jpg","nickname":"Tyr","note":"","ucode":"EAAFC8063202E0","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":546322,"discussion_content":"我试了一下，并没有错误。不过 examples 下的代码可以不用在 cargo.toml 里声明，你可以把他们都删掉试一下。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1642297658,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":329849,"user_name":"老实人Honey","can_delete":false,"product_type":"c1","uid":1080653,"ip_address":"","ucode":"EA4AB5C0C33090","user_header":"https://static001.geekbang.org/account/avatar/00/10/7d/4d/d98865b2.jpg","comment_is_top":false,"comment_ctime":1641583693,"is_pvip":true,"replies":[{"id":"120704","content":"👍","user_name":"作者回复","user_name_real":"编辑","uid":"1079375","ctime":1642293701,"ip_address":"","comment_id":329849,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1641583693","product_id":100085301,"comment_content":"clap = { version = &quot;3.0.4&quot;, features = [&quot;derive&quot;] } # 命令行解析<br>syntect = &quot;4.6.0&quot;<br>调整了这两个依赖的版本，代码稍微有调整<br>#[derive(Parser, Debug)]<br>#[clap(about, version, author)]<br>struct Opts {<br>    #[clap(subcommand)]<br>    subcmd: SubCommand,<br>}<br>","like_count":0,"discussions":[{"author":{"id":1079375,"avatar":"https://static001.geekbang.org/account/avatar/00/10/78/4f/e74f870c.jpg","nickname":"Tyr","note":"","ucode":"EAAFC8063202E0","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":546313,"discussion_content":"👍","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1642293701,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":329676,"user_name":"焉知非鱼","can_delete":false,"product_type":"c1","uid":1153932,"ip_address":"","ucode":"F32612733D3D4A","user_header":"https://static001.geekbang.org/account/avatar/00/11/9b/8c/a3ca2f3d.jpg","comment_is_top":false,"comment_ctime":1641465317,"is_pvip":false,"replies":[{"id":"120739","content":"👍","user_name":"作者回复","user_name_real":"编辑","uid":"1079375","ctime":1642307599,"ip_address":"","comment_id":329676,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1641465317","product_id":100085301,"comment_content":"在评论中又学到很多新知识。","like_count":0,"discussions":[{"author":{"id":1079375,"avatar":"https://static001.geekbang.org/account/avatar/00/10/78/4f/e74f870c.jpg","nickname":"Tyr","note":"","ucode":"EAAFC8063202E0","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":546376,"discussion_content":"👍","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1642307599,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":326607,"user_name":"🎶浮生若梦🎵📶","can_delete":false,"product_type":"c1","uid":2616895,"ip_address":"","ucode":"F9A957E26676BA","user_header":"https://static001.geekbang.org/account/avatar/00/27/ee/3f/b7d765d8.jpg","comment_is_top":false,"comment_ctime":1639580924,"is_pvip":false,"replies":[{"id":"118780","content":"嗯，你可以看 github 上的更新","user_name":"作者回复","user_name_real":"编辑","uid":"1079375","ctime":1639792549,"ip_address":"","comment_id":326607,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1639580924","product_id":100085301,"comment_content":"clap 3.0.0-rc.4 需要手动打开  derive feature:<br><br>```toml<br>[dependencies]<br>anyhow = &quot;1&quot;<br>clap = { version = &quot;3.0.0-rc.4&quot;, features = [&quot;derive&quot;] }<br>colored = &quot;2&quot;<br>jsonxf = &quot;1.1&quot; # JSON pretty print<br>mime = &quot;0.3&quot;<br>reqwest = { version = &quot;0.11&quot;, features = [&quot;json&quot;] }<br>tokio = { version = &quot;1&quot;, features = [&quot;full&quot;] }<br>syntect = &quot;4.6.0&quot;<br>```","like_count":0,"discussions":[{"author":{"id":1079375,"avatar":"https://static001.geekbang.org/account/avatar/00/10/78/4f/e74f870c.jpg","nickname":"Tyr","note":"","ucode":"EAAFC8063202E0","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":539631,"discussion_content":"嗯，你可以看 github 上的更新","likes_number":1,"is_delete":false,"is_hidden":false,"ctime":1639792549,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":325984,"user_name":"alexd","can_delete":false,"product_type":"c1","uid":2708009,"ip_address":"","ucode":"7815D35C4CFA0A","user_header":"https://static001.geekbang.org/account/avatar/00/29/52/29/51b5ca75.jpg","comment_is_top":false,"comment_ctime":1639294351,"is_pvip":false,"replies":[{"id":"118811","content":"看 github repo 里的更新，现在是 3.0.0-rc.5，离正式 release 不远了。","user_name":"作者回复","user_name_real":"编辑","uid":"1079375","ctime":1639804560,"ip_address":"","comment_id":325984,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1639294351","product_id":100085301,"comment_content":"由于库改动比较大，可能编译不过去了<br>1.clap::Clap引用不到了，需要使用 use clap::Parser;<br>2. 重要的是需要开启derive特性 clap = { version = &quot;3.0.0-beta.5&quot;, features = [&quot;derive&quot;] } ","like_count":0,"discussions":[{"author":{"id":1079375,"avatar":"https://static001.geekbang.org/account/avatar/00/10/78/4f/e74f870c.jpg","nickname":"Tyr","note":"","ucode":"EAAFC8063202E0","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":539684,"discussion_content":"看 github repo 里的更新，现在是 3.0.0-rc.5，离正式 release 不远了。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1639804560,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":324783,"user_name":"任伟","can_delete":false,"product_type":"c1","uid":1138060,"ip_address":"","ucode":"2F1CDEC69B3D8F","user_header":"https://static001.geekbang.org/account/avatar/00/11/5d/8c/767f9aa8.jpg","comment_is_top":false,"comment_ctime":1638623067,"is_pvip":false,"replies":[{"id":"118862","content":"👍","user_name":"作者回复","user_name_real":"编辑","uid":"1079375","ctime":1639848615,"ip_address":"","comment_id":324783,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1638623067","product_id":100085301,"comment_content":"评论和正文精彩程度不相上下！","like_count":0,"discussions":[{"author":{"id":1079375,"avatar":"https://static001.geekbang.org/account/avatar/00/10/78/4f/e74f870c.jpg","nickname":"Tyr","note":"","ucode":"EAAFC8063202E0","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":539822,"discussion_content":"👍","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1639848615,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":324665,"user_name":"xiong","can_delete":false,"product_type":"c1","uid":1099375,"ip_address":"","ucode":"C1BFD9EF96372F","user_header":"https://static001.geekbang.org/account/avatar/00/10/c6/6f/ac3003fa.jpg","comment_is_top":false,"comment_ctime":1638531903,"is_pvip":false,"replies":[{"id":"118863","content":"和版本无关，和依赖有关。","user_name":"作者回复","user_name_real":"编辑","uid":"1079375","ctime":1639848653,"ip_address":"","comment_id":324665,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1638531903","product_id":100085301,"comment_content":"想问下版本兼容性这么差吗？","like_count":0,"discussions":[{"author":{"id":1079375,"avatar":"https://static001.geekbang.org/account/avatar/00/10/78/4f/e74f870c.jpg","nickname":"Tyr","note":"","ucode":"EAAFC8063202E0","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":539823,"discussion_content":"和版本无关，和依赖有关。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1639848653,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":323683,"user_name":"于飞","can_delete":false,"product_type":"c1","uid":2856095,"ip_address":"","ucode":"F3423D6FF9FCCA","user_header":"https://static001.geekbang.org/account/avatar/00/2b/94/9f/8d433d7c.jpg","comment_is_top":false,"comment_ctime":1638093567,"is_pvip":false,"replies":[{"id":"118885","content":"对","user_name":"作者回复","user_name_real":"编辑","uid":"1079375","ctime":1639850214,"ip_address":"","comment_id":323683,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1638093567","product_id":100085301,"comment_content":"实现 FromStr 之后，parse_kv_pair 似乎就没必要了呀。","like_count":0,"discussions":[{"author":{"id":1079375,"avatar":"https://static001.geekbang.org/account/avatar/00/10/78/4f/e74f870c.jpg","nickname":"Tyr","note":"","ucode":"EAAFC8063202E0","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":539846,"discussion_content":"对","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1639850214,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":321401,"user_name":"Arthur","can_delete":false,"product_type":"c1","uid":1334905,"ip_address":"","ucode":"A66B904766C443","user_header":"https://static001.geekbang.org/account/avatar/00/14/5e/79/0b56b7bd.jpg","comment_is_top":false,"comment_ctime":1636854001,"is_pvip":false,"replies":[{"id":"118926","content":"你确定尝试了我 github repo 上的代码？这个代码在 CI 上编译通过的","user_name":"作者回复","user_name_real":"编辑","uid":"1079375","ctime":1639853419,"ip_address":"","comment_id":321401,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1636854001","product_id":100085301,"comment_content":"老师您好：<br>       关于clap库的问题，使用的是3.0.0-beta.5的版本。我参考了留言，对clap做了修改，我的代码是： #[clap(setting = AppSettings::HelpRequired)]， 但是编译的时候依然报这个错：  #![doc = include_str!(&quot;..&#47;README.md&quot;)]。 也尝试了用您git上的最新代码跑一边，依然编译不过。<br>        我的cargo版本是： cargo 1.53.0 (4369396ce 2021-04-27)<br><br>        请问一下这个是什么原因呢。","like_count":0,"discussions":[{"author":{"id":1079375,"avatar":"https://static001.geekbang.org/account/avatar/00/10/78/4f/e74f870c.jpg","nickname":"Tyr","note":"","ucode":"EAAFC8063202E0","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":539887,"discussion_content":"你确定尝试了我 github repo 上的代码？这个代码在 CI 上编译通过的","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1639853419,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":320972,"user_name":"zhuzq229","can_delete":false,"product_type":"c1","uid":2540617,"ip_address":"","ucode":"8ED87B74DEFAB2","user_header":"https://static001.geekbang.org/account/avatar/00/26/c4/49/c3d67b3b.jpg","comment_is_top":false,"comment_ctime":1636601356,"is_pvip":false,"replies":[{"id":"116570","content":"Rust 有非常多设计良好的优秀的 crate。这堂课后面有一讲介绍 Rust 的生态系统，你可以看看。建议在 github 上看到不错的的 Rust 应用或者库的时候，可以看看它们的 cargo.toml，了解一下都用了哪些依赖，进一步再了解一些这些依赖是干什么的。这样可以很快对大家都常用的 crates 有一个感觉。","user_name":"作者回复","user_name_real":"Tyr","uid":"1079375","ctime":1636641369,"ip_address":"","comment_id":320972,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1636601356","product_id":100085301,"comment_content":"不但只用几个库就写出如此简洁强大的代码，代码之美观、结构之清晰更让人看了头皮发麻，命令解析、错误处理、代码解耦一切都是恰到好处，可谓现代软件工程的集大成者，个人认为Rust统治编程语言王座只是时间问题了。。。<br><br>刚开始学习Rust，请问天哥，Rust的crates都像clap、anyhow这样优秀吗？日常开发时如何从众多的crate中挑选最合适的crate呢？","like_count":0,"discussions":[{"author":{"id":1079375,"avatar":"https://static001.geekbang.org/account/avatar/00/10/78/4f/e74f870c.jpg","nickname":"Tyr","note":"","ucode":"EAAFC8063202E0","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":530174,"discussion_content":"Rust 有非常多设计良好的优秀的 crate。这堂课后面有一讲介绍 Rust 的生态系统，你可以看看。建议在 github 上看到不错的的 Rust 应用或者库的时候，可以看看它们的 cargo.toml，了解一下都用了哪些依赖，进一步再了解一些这些依赖是干什么的。这样可以很快对大家都常用的 crates 有一个感觉。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1636641369,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":320561,"user_name":"天吴","can_delete":false,"product_type":"c1","uid":2103870,"ip_address":"","ucode":"5BB89CF4DBD079","user_header":"https://static001.geekbang.org/account/avatar/00/20/1a/3e/1b215b07.jpg","comment_is_top":false,"comment_ctime":1636379923,"is_pvip":false,"replies":[{"id":"116306","content":"对，以 github repo 中的代码为准","user_name":"作者回复","user_name_real":"Tyr","uid":"1079375","ctime":1636478726,"ip_address":"","comment_id":320561,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1636379923","product_id":100085301,"comment_content":"clap 升级beta-5版本后修改了很多api","like_count":0,"discussions":[{"author":{"id":1079375,"avatar":"https://static001.geekbang.org/account/avatar/00/10/78/4f/e74f870c.jpg","nickname":"Tyr","note":"","ucode":"EAAFC8063202E0","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":530048,"discussion_content":"对，以 github repo 中的代码为准","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1636478726,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":319725,"user_name":"Geek_4df987","can_delete":false,"product_type":"c1","uid":2809254,"ip_address":"","ucode":"E47161161027E8","user_header":"","comment_is_top":false,"comment_ctime":1635923707,"is_pvip":false,"replies":[{"id":"116377","content":"请参考 github 上的代码：https:&#47;&#47;github.com&#47;tyrchen&#47;geektime-rust&#47;tree&#47;master&#47;04_httpie。vscode 中 cargo.toml 中的提示只是提示你最新的稳定版本。这里我们用了 beta 版本。","user_name":"作者回复","user_name_real":"Tyr","uid":"1079375","ctime":1636555639,"ip_address":"","comment_id":319725,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1635923707","product_id":100085301,"comment_content":"clap最新版本是2.33.3<br>clap = &quot;3.0.0-beta.4&quot; # 命令行解析<br>这个依赖无法下载","like_count":0,"discussions":[{"author":{"id":1079375,"avatar":"https://static001.geekbang.org/account/avatar/00/10/78/4f/e74f870c.jpg","nickname":"Tyr","note":"","ucode":"EAAFC8063202E0","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":529741,"discussion_content":"请参考 github 上的代码：https://github.com/tyrchen/geektime-rust/tree/master/04_httpie。vscode 中 cargo.toml 中的提示只是提示你最新的稳定版本。这里我们用了 beta 版本。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1636555639,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":315777,"user_name":"小样","can_delete":false,"product_type":"c1","uid":1075443,"ip_address":"","ucode":"0D05E1D31150F1","user_header":"https://static001.geekbang.org/account/avatar/00/10/68/f3/22481a37.jpg","comment_is_top":false,"comment_ctime":1633996239,"is_pvip":true,"replies":[{"id":"115289","content":"嗯，可以的","user_name":"作者回复","user_name_real":"Tyr","uid":"1079375","ctime":1635132857,"ip_address":"","comment_id":315777,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1633996239","product_id":100085301,"comment_content":"我们完全可以使用`--`隔开后接参数的形式来使用cargo run给运行程序传递参数。<br>比如：<br>cargo run -- post a=1 b=2","like_count":0,"discussions":[{"author":{"id":1079375,"avatar":"https://static001.geekbang.org/account/avatar/00/10/78/4f/e74f870c.jpg","nickname":"Tyr","note":"","ucode":"EAAFC8063202E0","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":528164,"discussion_content":"嗯，可以的","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1635132857,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":314964,"user_name":"技巅","can_delete":false,"product_type":"c1","uid":2290370,"ip_address":"","ucode":"56A5F002885975","user_header":"https://static001.geekbang.org/account/avatar/00/22/f2/c2/51e2c22f.jpg","comment_is_top":false,"comment_ctime":1633614655,"is_pvip":false,"replies":[{"id":"114165","content":"请把你的 rust 升级到最新版本","user_name":"作者回复","user_name_real":"Tyr","uid":"1079375","ctime":1633813156,"ip_address":"","comment_id":314964,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1633614655","product_id":100085301,"comment_content":"error: unexpected token: `include_str`<br> --&gt; &#47;Users&#47;wuyouqiang&#47;.cargo&#47;registry&#47;src&#47;github.com-1ecc6299db9ec823&#47;clap-3.0.0-beta.4&#47;src&#47;lib.rs:8:10<br>  |<br>8 | #![doc = include_str!(&quot;..&#47;README.md&quot;)]<br>  |          ^^^^^^^^^^^<br><br>error: aborting due to previous error<br><br>error: could not compile `clap`.","like_count":0,"discussions":[{"author":{"id":1079375,"avatar":"https://static001.geekbang.org/account/avatar/00/10/78/4f/e74f870c.jpg","nickname":"Tyr","note":"","ucode":"EAAFC8063202E0","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":527841,"discussion_content":"请把你的 rust 升级到最新版本","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1633813156,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":313609,"user_name":"xqz","can_delete":false,"product_type":"c1","uid":1736517,"ip_address":"","ucode":"51BF7C3113EB75","user_header":"https://static001.geekbang.org/account/avatar/00/1a/7f/45/f7e99824.jpg","comment_is_top":false,"comment_ctime":1632556005,"is_pvip":false,"replies":[{"id":"113747","content":"看上去跟你的 gcc 有关系，这个回答虽然不直接相关，但它也是在 windows  下试图编译C 代码出错：https:&#47;&#47;stackoverflow.com&#47;questions&#47;39863157&#47;cgo-sorry-unimplemented-64-bit-mode-not-compiled-in","user_name":"作者回复","user_name_real":"Tyr","uid":"1079375","ctime":1632798970,"ip_address":"","comment_id":313609,"utype":1}],"discussion_count":3,"race_medal":0,"score":"1632556005","product_id":100085301,"comment_content":"请问一下大家，在 Windows 平台，有遇到 syntect 安装出错问题吗？<br><br>```powershell<br>PS G:\\Workspace\\rust\\httpie&gt; cargo run <br>   Compiling onig_sys v69.7.0<br>The following warnings were emitted during compilation:<br><br>warning: cc1.exe: sorry, unimplemented: 64-bit mode not compiled in<br><br>error: failed to run custom build command for `onig_sys v69.7.0`<br><br>Caused by:<br>  process didn&#39;t exit successfully: `G:\\Workspace\\rust\\httpie\\target\\debug\\build\\onig_sys-71fae3c26d4b45db\\build-script-build` (exit code: 1)<br>  --- stdout<br>  TARGET = Some(&quot;x86_64-pc-windows-gnu&quot;)<br>  OPT_LEVEL = Some(&quot;0&quot;)<br>  HOST = Some(&quot;x86_64-pc-windows-gnu&quot;)<br>  CC_x86_64-pc-windows-gnu = None<br>  CC_x86_64_pc_windows_gnu = None<br>  HOST_CC = None<br>  CC = None<br>  CFLAGS_x86_64-pc-windows-gnu = None<br>  CFLAGS_x86_64_pc_windows_gnu = None<br>  HOST_CFLAGS = None<br>  CFLAGS = None<br>  CRATE_CC_NO_DEFAULTS = None<br>  DEBUG = Some(&quot;true&quot;)<br>  CARGO_CFG_TARGET_FEATURE = Some(&quot;fxsr,sse,sse2&quot;)<br>  running: &quot;gcc.exe&quot; &quot;-O0&quot; &quot;-ffunction-sections&quot; &quot;-fdata-sections&quot; &quot;-g&quot; &quot;-fno-omit-frame-pointer&quot; &quot;-m64&quot; &quot;-I&quot; &quot;G:\\\\Workspace\\\\rust\\\\httpie\\\\target\\\\debug\\\\build\\\\onig_sys-59a5b9fafbb634fe\\\\out&quot; &quot;-I&quot; &quot;oniguruma\\\\src&quot; &quot;-o&quot; &quot;G:\\\\Workspace\\\\rust\\\\httpie\\\\target\\\\debug\\\\build\\\\onig_sys-59a5b9fafbb634fe\\\\out\\\\oniguruma\\\\src\\\\regexec.o&quot; &quot;-c&quot; &quot;oniguruma\\\\src\\\\regexec.c&quot;<br>  cargo:warning=cc1.exe: sorry, unimplemented: 64-bit mode not compiled in<br>  exit code: 1<br><br>  --- stderr<br><br><br>  error occurred: Command &quot;gcc.exe&quot; &quot;-O0&quot; &quot;-ffunction-sections&quot; &quot;-fdata-sections&quot; &quot;-g&quot; &quot;-fno-omit-frame-pointer&quot; &quot;-m64&quot; &quot;-I&quot; &quot;G:\\\\Workspace\\\\rust\\\\httpie\\\\target\\\\debug\\\\build\\\\onig_sys-59a5b9fafbb634fe\\\\out&quot; &quot;-I&quot; &quot;oniguruma\\\\src&quot; &quot;-o&quot; &quot;G:\\\\Workspace\\\\rust\\\\httpie\\\\target\\\\debug\\\\build\\\\onig_sys-59a5b9fafbb634fe\\\\out\\\\oniguruma\\\\src\\\\regexec.o&quot; &quot;-c&quot; &quot;oniguruma\\\\src\\\\regexec.c&quot; with args &quot;gcc.exe&quot; did not execute successfully (status code exit <br>code: 1).<br><br>```","like_count":0,"discussions":[{"author":{"id":1079375,"avatar":"https://static001.geekbang.org/account/avatar/00/10/78/4f/e74f870c.jpg","nickname":"Tyr","note":"","ucode":"EAAFC8063202E0","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":527408,"discussion_content":"看上去跟你的 gcc 有关系，这个回答虽然不直接相关，但它也是在 windows  下试图编译C 代码出错：https://stackoverflow.com/questions/39863157/cgo-sorry-unimplemented-64-bit-mode-not-compiled-in","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1632798970,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1080653,"avatar":"https://static001.geekbang.org/account/avatar/00/10/7d/4d/d98865b2.jpg","nickname":"老实人Honey","note":"","ucode":"EA4AB5C0C33090","race_medal":0,"user_type":1,"is_pvip":true},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":544597,"discussion_content":"这个问题我解决；\n使用scoop install mingw，这一步安装mingw，然后scoop会自动配置好PATH\n然后新开一个终端就可以执行cargo run了","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1641583115,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1886468,"avatar":"https://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTJjzOFKRWQ1iagtXTAYsPUfdtbPKnYnwXc3ahSjLJrxXib4bq76Z9r39aRa4eMib59YR9ibicI2IRP1fnw/132","nickname":"Geek_1240ce","note":"","ucode":"29ECE58F80A793","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":410679,"discussion_content":"在 Windows 中最好不要使用 x86_64-pc-windows-gnu，推荐使用 x86_64-pc-windows-msvc。在 x86_64-pc-windows-msvc 中编译通过","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1635756761,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":312872,"user_name":"qgaye","can_delete":false,"product_type":"c1","uid":1702112,"ip_address":"","ucode":"E817609D4ED2D6","user_header":"https://static001.geekbang.org/account/avatar/00/19/f8/e0/d6e3cc8f.jpg","comment_is_top":false,"comment_ctime":1632071356,"is_pvip":false,"replies":[{"id":"113369","content":"我没用过 Clion。不过插件对宏的支持的确非常有限。比如你用 tokio 的 select! 宏时，内部的代码都无法很好地进行提示，也无法自动补全：<br><br>```rust<br>#[tokio::main]<br>async fn main() {<br>    tokio::select! {<br>        _ = do_stuff_async() =&gt; {<br>            println!(&quot;do_stuff_async() completed first&quot;)<br>        }<br>        _ = more_async_work() =&gt; {<br>            println!(&quot;more_async_work() completed first&quot;)<br>        }<br>    };<br>}<br>```","user_name":"作者回复","user_name_real":"Tyr","uid":"1079375","ctime":1632154412,"ip_address":"","comment_id":312872,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1632071356","product_id":100085301,"comment_content":"为什么用CLion + Rust插件，但clap相关的宏都无法智能提示呢，连use clap都得手动导入，请教老师这是IDE的问题还是宏确实无法只能提示呢","like_count":0,"discussions":[{"author":{"id":1079375,"avatar":"https://static001.geekbang.org/account/avatar/00/10/78/4f/e74f870c.jpg","nickname":"Tyr","note":"","ucode":"EAAFC8063202E0","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":527141,"discussion_content":"我没用过 Clion。不过插件对宏的支持的确非常有限。比如你用 tokio 的 select! 宏时，内部的代码都无法很好地进行提示，也无法自动补全：\n\n```rust\n#[tokio::main]\nasync fn main() {\n    tokio::select! {\n        _ = do_stuff_async() =&amp;gt; {\n            println!(&amp;quot;do_stuff_async() completed first&amp;quot;)\n        }\n        _ = more_async_work() =&amp;gt; {\n            println!(&amp;quot;more_async_work() completed first&amp;quot;)\n        }\n    };\n}\n```","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1632154412,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":311829,"user_name":"潘壮","can_delete":false,"product_type":"c1","uid":1588825,"ip_address":"","ucode":"A441B08369F5AB","user_header":"https://static001.geekbang.org/account/avatar/00/18/3e/59/f362ac48.jpg","comment_is_top":false,"comment_ctime":1631496371,"is_pvip":false,"replies":[{"id":"112985","content":"因为后续我并不需要再使用 resp 了，所以可以直接将其使用掉。","user_name":"作者回复","user_name_real":"Tyr","uid":"1079375","ctime":1631514483,"ip_address":"","comment_id":311829,"utype":1}],"discussion_count":3,"race_medal":0,"score":"1631496371","product_id":100085301,"comment_content":"async fn print_resp(resp: Response) -&gt; Result&lt;()&gt; {<br>    print_status(&amp;resp);<br>    print_headers(&amp;resp);<br>    let mime = get_content_type(&amp;resp);<br>    let body = resp.text().await?;<br>    print_body(mime, &amp;body);<br>    Ok(())<br>}<br><br>这个函数这里Response直接把所有权传到了函数里面，没有传引用的原因是什么","like_count":0,"discussions":[{"author":{"id":1079375,"avatar":"https://static001.geekbang.org/account/avatar/00/10/78/4f/e74f870c.jpg","nickname":"Tyr","note":"","ucode":"EAAFC8063202E0","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":526761,"discussion_content":"因为后续我并不需要再使用 resp 了，所以可以直接将其使用掉。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1631514483,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1089000,"avatar":"https://static001.geekbang.org/account/avatar/00/10/9d/e8/39433235.jpg","nickname":"Christian","note":"","ucode":"D84F866015BA07","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":394923,"discussion_content":"因为，resp.text() 方法需要接收 response 的所有权版本。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1632129666,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1759641,"avatar":"https://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTLruKArGrtM9L3qOlgTvzbk1uleqDqTPWyZhO2ClKPy5SlEeb28ojWVzAHuwuVSh3PsnhunsbibpjQ/132","nickname":"LeoYoung","note":"","ucode":"ADAC8B02A85EE3","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":393789,"discussion_content":"改成传引用，`let body = resp.text().await?;` 这里会报 `cannot move out of `*resp` which is behind a shared reference`，有点奇怪","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1631601413,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":311197,"user_name":"朝如青丝暮成雪","can_delete":false,"product_type":"c1","uid":1164201,"ip_address":"","ucode":"95C98ECFBC1662","user_header":"https://static001.geekbang.org/account/avatar/00/11/c3/a9/aa5a5d8b.jpg","comment_is_top":false,"comment_ctime":1631099928,"is_pvip":false,"replies":[{"id":"112794","content":"你看看我 github 上的代码，确保你的 Cargo.toml 引用了正确的 clap 版本。","user_name":"作者回复","user_name_real":"Tyr","uid":"1079375","ctime":1631151025,"ip_address":"","comment_id":311197,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1631099928","product_id":100085301,"comment_content":"rust版本1.53 或者1.54 都会报这个错：<br>error[E0432]: unresolved import `clap::Clap`<br> --&gt; src&#47;main.rs:2:25<br>  |<br>2 | use clap::{AppSettings, Clap};<br>  |                         ^^^^ no `Clap` in the root<br><br>尝试解决方法：<br>https:&#47;&#47;stackoverflow.com&#47;questions&#47;60319273&#47;how-to-resolve-unresolved-import-in-rust-when-using-vs-code<br>https:&#47;&#47;github.com&#47;rust-analyzer&#47;rust-analyzer&#47;issues&#47;6053<br><br>都没有解决，实在没办法了🤷‍♀️","like_count":0,"discussions":[{"author":{"id":1079375,"avatar":"https://static001.geekbang.org/account/avatar/00/10/78/4f/e74f870c.jpg","nickname":"Tyr","note":"","ucode":"EAAFC8063202E0","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":526518,"discussion_content":"你看看我 github 上的代码，确保你的 Cargo.toml 引用了正确的 clap 版本。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1631151025,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":310631,"user_name":"alexd","can_delete":false,"product_type":"c1","uid":2708009,"ip_address":"","ucode":"7815D35C4CFA0A","user_header":"https://static001.geekbang.org/account/avatar/00/29/52/29/51b5ca75.jpg","comment_is_top":false,"comment_ctime":1630811267,"is_pvip":false,"replies":[{"id":"112557","content":"golang 对 err 做条件判断也不简洁啊","user_name":"作者回复","user_name_real":"Tyr","uid":"1079375","ctime":1630860765,"ip_address":"","comment_id":310631,"utype":1}],"discussion_count":2,"race_medal":0,"score":"1630811267","product_id":100085301,"comment_content":"还是golang简洁，rust各种unwrap，问号","like_count":0,"discussions":[{"author":{"id":1079375,"avatar":"https://static001.geekbang.org/account/avatar/00/10/78/4f/e74f870c.jpg","nickname":"Tyr","note":"","ucode":"EAAFC8063202E0","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":526295,"discussion_content":"golang 对 err 做条件判断也不简洁啊","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1630860765,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":2738637,"avatar":"https://static001.geekbang.org/account/avatar/00/29/c9/cd/4ce2f5fb.jpg","nickname":"lin","note":"","ucode":"42FB7B3FB8EE3D","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":540314,"discussion_content":"感觉你这问的压根不知道unwrap的意义啊。Rust中各种Wrapper(无论是enum还是smart pointer)的引入，都是为了从type system角度出发保证程序的正确性，例如Option解决了go的nil runtime error, Rc/RefCell/Arc等解决了data race","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1640014213,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":310175,"user_name":"Chloroplast","can_delete":false,"product_type":"c1","uid":2156365,"ip_address":"","ucode":"4193D54349255D","user_header":"https://static001.geekbang.org/account/avatar/00/20/e7/4d/07d7c828.jpg","comment_is_top":false,"comment_ctime":1630513060,"is_pvip":false,"replies":[{"id":"112425","content":"没见过这个错误。你mac 上装 build-tools 和 xcode 了么？","user_name":"作者回复","user_name_real":"Tyr","uid":"1079375","ctime":1630594713,"ip_address":"","comment_id":310175,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1630513060","product_id":100085301,"comment_content":"mac系统编译时出现错误：<br>error: linking with `cc` failed: exit status: 1<br><br>查找资料后在 ~&#47;.cargo&#47;config 文件中添加以下代码可以解决问题：<br>[target.x86_64-apple-darwin]<br>rustflags = [<br>  &quot;-C&quot;, &quot;link-arg=-undefined&quot;,<br>  &quot;-C&quot;, &quot;link-arg=dynamic_lookup&quot;,<br>]<br><br>[target.aarch64-apple-darwin]<br>rustflags = [<br>  &quot;-C&quot;, &quot;link-arg=-undefined&quot;,<br>  &quot;-C&quot;, &quot;link-arg=dynamic_lookup&quot;,<br>]","like_count":0,"discussions":[{"author":{"id":1079375,"avatar":"https://static001.geekbang.org/account/avatar/00/10/78/4f/e74f870c.jpg","nickname":"Tyr","note":"","ucode":"EAAFC8063202E0","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":526153,"discussion_content":"没见过这个错误。你mac 上装 build-tools 和 xcode 了么？","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1630594713,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":310111,"user_name":"thomas-fan","can_delete":false,"product_type":"c1","uid":1258997,"ip_address":"","ucode":"CCFB55E1CC0C26","user_header":"https://static001.geekbang.org/account/avatar/00/13/35/f5/5283d5a2.jpg","comment_is_top":false,"comment_ctime":1630488431,"is_pvip":true,"replies":[{"id":"112364","content":"这是两行，命令是：<br><br>cargo build --quiet &amp;&amp; target&#47;debug&#47;httpie post a=1 b=2<br><br>不过原文中少加了个 url，应该是：<br>cargo build --quiet &amp;&amp; target&#47;debug&#47;httpie post httpbin.org&#47;post a=1 b=2","user_name":"作者回复","user_name_real":"Tyr","uid":"1079375","ctime":1630506349,"ip_address":"","comment_id":310111,"utype":1}],"discussion_count":2,"race_medal":0,"score":"1630488431","product_id":100085301,"comment_content":"zsh 命令行下, 花括号要转义,不然会报解析错误的错.<br>cargo build --quiet &amp;&amp; target&#47;debug&#47;httpie post a=1 b=2 Opts \\{ subcmd: Post(Post \\{ url: &quot;httpbin.org&#47;post&quot;, body: [&quot;a=1&quot;, &quot;b=2&quot;] \\})\\}<br>加上转义就可以了","like_count":0,"discussions":[{"author":{"id":1079375,"avatar":"https://static001.geekbang.org/account/avatar/00/10/78/4f/e74f870c.jpg","nickname":"Tyr","note":"","ucode":"EAAFC8063202E0","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":526129,"discussion_content":"这是两行，命令是：\n\ncargo build --quiet &amp;amp;&amp;amp; target/debug/httpie post a=1 b=2\n\n不过原文中少加了个 url，应该是：\ncargo build --quiet &amp;amp;&amp;amp; target/debug/httpie post httpbin.org/post a=1 b=2","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1630506349,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1176417,"avatar":"https://static001.geekbang.org/account/avatar/00/11/f3/61/8f7fca5b.jpg","nickname":"芥末小龙","note":"","ucode":"387D01880867AC","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":391856,"discussion_content":"我就猜到有人跟我一样把命令和结果都copy了！！！","likes_number":1,"is_delete":false,"is_hidden":false,"ctime":1630660532,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":310097,"user_name":"鱼龙帅","can_delete":false,"product_type":"c1","uid":1022367,"ip_address":"","ucode":"4BC94037750AF2","user_header":"http://thirdwx.qlogo.cn/mmopen/vi_32/PiajxSqBRaEKBM3Q8ibgwVibREUulIsuRymSqLWQqexMSCOx9aYngDlra5swsvc9IgUkIwibvMX0IerWSwKFcuSzuw/132","comment_is_top":false,"comment_ctime":1630484270,"is_pvip":false,"replies":[{"id":"112361","content":"ring 加密库包含了 C 代码，所以你 Linux 上需要有能编译 C 的工具链。<br><br>你可以看看具体的输出，看它找不到什么 build command，比如：<br><br>thread &#39;main&#39; panicked at &#39;failed to execute [&quot;musl-gcc&quot; ..<br><br>如果是这样，你的 linux 需要安装 musl-gcc。如果是其它 command 找不到，你需要安装对应的工具链。","user_name":"作者回复","user_name_real":"Tyr","uid":"1079375","ctime":1630505905,"ip_address":"","comment_id":310097,"utype":1}],"discussion_count":2,"race_medal":0,"score":"1630484270","product_id":100085301,"comment_content":"windows下编译可以，在linux下编译报error: failed to run custom build command for `ring v0.16.20`，windows跨平台编译也报一样的错误，不知道哪里出问题了","like_count":0,"discussions":[{"author":{"id":1079375,"avatar":"https://static001.geekbang.org/account/avatar/00/10/78/4f/e74f870c.jpg","nickname":"Tyr","note":"","ucode":"EAAFC8063202E0","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":526125,"discussion_content":"ring 加密库包含了 C 代码，所以你 Linux 上需要有能编译 C 的工具链。\n\n你可以看看具体的输出，看它找不到什么 build command，比如：\n\nthread &amp;#39;main&amp;#39; panicked at &amp;#39;failed to execute [&amp;quot;musl-gcc&amp;quot; ..\n\n如果是这样，你的 linux 需要安装 musl-gcc。如果是其它 command 找不到，你需要安装对应的工具链。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1630505905,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1022367,"avatar":"http://thirdwx.qlogo.cn/mmopen/vi_32/PiajxSqBRaEKBM3Q8ibgwVibREUulIsuRymSqLWQqexMSCOx9aYngDlra5swsvc9IgUkIwibvMX0IerWSwKFcuSzuw/132","nickname":"鱼龙帅","note":"","ucode":"4BC94037750AF2","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":391690,"discussion_content":"linux上的我更新了binutils的版本解决了","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1630577138,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":310055,"user_name":"太子长琴","can_delete":false,"product_type":"c1","uid":1090266,"ip_address":"","ucode":"0627D0FA370AD4","user_header":"https://static001.geekbang.org/account/avatar/00/10/a2/da/a8a32113.jpg","comment_is_top":false,"comment_ctime":1630472773,"is_pvip":false,"replies":[{"id":"112365","content":"这里少加了个 url，应该是：<br><br>cargo build --quiet &amp;&amp; target&#47;debug&#47;httpie httpbin.org&#47;post post a=1 b=2<br><br>原文已修改","user_name":"作者回复","user_name_real":"Tyr","uid":"1079375","ctime":1630506390,"ip_address":"","comment_id":310055,"utype":1}],"discussion_count":2,"race_medal":0,"score":"1630472773","product_id":100085301,"comment_content":"cargo build --quiet &amp;&amp; target&#47;debug&#47;httpie post a=1 b=2","like_count":0,"discussions":[{"author":{"id":1079375,"avatar":"https://static001.geekbang.org/account/avatar/00/10/78/4f/e74f870c.jpg","nickname":"Tyr","note":"","ucode":"EAAFC8063202E0","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":526114,"discussion_content":"这里少加了个 url，应该是：\n\ncargo build --quiet &amp;amp;&amp;amp; target/debug/httpie httpbin.org/post post a=1 b=2\n\n原文已修改","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1630506390,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1090266,"avatar":"https://static001.geekbang.org/account/avatar/00/10/a2/da/a8a32113.jpg","nickname":"太子长琴","note":"","ucode":"0627D0FA370AD4","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":391822,"discussion_content":"嗯嗯，本来还有一些留言的，结果回车时不小心按了下 ctrl 就发出去了，还一下看不到没法删……","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1630645752,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":310043,"user_name":"Geek_e2201d","can_delete":false,"product_type":"c1","uid":2744438,"ip_address":"","ucode":"0602920032AD1E","user_header":"https://thirdwx.qlogo.cn/mmopen/vi_32/PiajxSqBRaEIVblkHYeYrgys7iaARHkicbYCZoibE1tJO0C6NEgw1f13RDgVABBgXDSFBzabLIUPNEPdxib1Ep5aYZg/132","comment_is_top":false,"comment_ctime":1630466191,"is_pvip":false,"replies":[{"id":"112335","content":"我在 github repo 中更新了代码，你可以看一下。<br><br>对于你的编译错误，其实编译器已经给出了答案。你可以这样：<br>```rust<br>let prettified = jsonxf::pretty_print(body).unwrap();<br>prettified.as_str()<br>```","user_name":"作者回复","user_name_real":"Tyr","uid":"1079375","ctime":1630472200,"ip_address":"","comment_id":310043,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1630466191","product_id":100085301,"comment_content":"&#47;&#47; 使用syntect 语法高亮print，支持多种语法。<br>fn print_body(m: Option&lt;Mime&gt;, body: &amp;String) {<br>    match m {<br>        Some(v) =&gt; {<br>            let ps = SyntaxSet::load_defaults_newlines();<br>            match ps.find_syntax_by_token(v.subtype().as_str()){<br>                Some(s) =&gt; {<br>                    if v == mime::APPLICATION_JSON {<br>                        print_highlight(jsonxf::pretty_print(body).unwrap().as_str(), &amp;ps, s);<br>                    } else {<br>                        print_highlight(body, &amp;ps, s);<br>                    }<br>                }<br>                _ =&gt; println!(&quot;{}&quot;, body)<br>            }<br>        }<br>        _ =&gt; println!(&quot;{}&quot;, body)<br>    }<br>}<br><br>fn print_highlight(body: &amp;str, ss: &amp;SyntaxSet, s: &amp;SyntaxReference) {<br>    let ts = ThemeSet::load_defaults();<br>    let mut h = HighlightLines::new(s, &amp;ts.themes[&quot;base16-ocean.dark&quot;]);<br>    for line in LinesWithEndings::from(body) {<br>        let ranges: Vec&lt;(Style, &amp;str)&gt; = h.highlight(line, &amp;ss);<br>        print!(&quot;{}&quot;, as_24_bit_terminal_escaped(&amp;ranges[..], true));<br>    }<br>}<br><br>问题请教：最初打算写成这样：<br>if v == mime::APPLICATION_JSON {<br>    body = jsonxf::pretty_print(body).unwrap().as_str();<br>}<br>print_highlight(body, &amp;ps, s);<br>因为body是immute的，所以改为如下：<br>let prettied_body = if v == mime::APPLICATION_JSON {<br>    jsonxf::pretty_print(body).unwrap().as_str()<br>} else {<br>    body<br>};<br>print_highlight(prettied_body, &amp;ps, s);<br><br>报错如下：<br>error[E0716]: temporary value dropped while borrowed<br>   --&gt; src&#47;main.rs:136:25<br>    |<br>135 |           let prettied_body = if v == mime::APPLICATION_JSON {<br>    |                 ------------- borrow later stored here<br>136                 jsonxf::pretty_print(body).unwrap().as_str()<br>    |                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ creates a temporary which is freed while still in use<br>137 |           } else {<br>    |            - temporary value is freed at the end of this statement<br>    |<br>    = note: consider using a `let` binding to create a longer lived value<br><br>求教该如何依照这个思路解决这个问题？<br><br><br>                    <br>...<br><br>","like_count":0,"discussions":[{"author":{"id":1079375,"avatar":"https://static001.geekbang.org/account/avatar/00/10/78/4f/e74f870c.jpg","nickname":"Tyr","note":"","ucode":"EAAFC8063202E0","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":526111,"discussion_content":"我在 github repo 中更新了代码，你可以看一下。\n\n对于你的编译错误，其实编译器已经给出了答案。你可以这样：\n```rust\nlet prettified = jsonxf::pretty_print(body).unwrap();\nprettified.as_str()\n```","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1630472200,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":309960,"user_name":"乌龙猹","can_delete":false,"product_type":"c1","uid":2739949,"ip_address":"","ucode":"43F94A0DEC54BE","user_header":"https://static001.geekbang.org/account/avatar/00/29/ce/ed/3dbe915b.jpg","comment_is_top":false,"comment_ctime":1630414492,"is_pvip":false,"replies":[{"id":"112296","content":"如果你卡在拉依赖，建议换国内的源。之前有同学留言中提到。对于编译速度，目前就只能：忍。","user_name":"作者回复","user_name_real":"Tyr","uid":"1079375","ctime":1630426018,"ip_address":"","comment_id":309960,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1630414492","product_id":100085301,"comment_content":"How to speed up the Rust build ?","like_count":0,"discussions":[{"author":{"id":1079375,"avatar":"https://static001.geekbang.org/account/avatar/00/10/78/4f/e74f870c.jpg","nickname":"Tyr","note":"","ucode":"EAAFC8063202E0","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":526074,"discussion_content":"如果你卡在拉依赖，建议换国内的源。之前有同学留言中提到。对于编译速度，目前就只能：忍。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1630426018,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":309814,"user_name":"Bruce","can_delete":false,"product_type":"c1","uid":2365229,"ip_address":"","ucode":"2A48A313481754","user_header":"https://static001.geekbang.org/account/avatar/00/24/17/2d/b7614553.jpg","comment_is_top":false,"comment_ctime":1630339139,"is_pvip":false,"replies":[{"id":"112243","content":"你可以看看你的 Cargo.toml 的 tokio 的依赖，感觉你依赖没有带 full 或者 macros feature。完整的代码我已经放在 github 上了，你可以参考。","user_name":"作者回复","user_name_real":"Tyr","uid":"1079375","ctime":1630380055,"ip_address":"","comment_id":309814,"utype":1}],"discussion_count":2,"race_medal":0,"score":"1630339139","product_id":100085301,"comment_content":"windows上 runst -v 1.54并不能编译通过<br>```<br>error[E0433]: failed to resolve: could not find `main` in `tokio`<br>   --&gt; src\\main.rs:152:10<br>    |<br>152 | #[tokio::main]<br>    |          ^^^^ could not find `main` in `tokio`<br><br>error[E0752]: `main` function is not allowed to be `async`<br>   --&gt; src\\main.rs:153:1<br>    |<br>153 | async fn main() -&gt; Result&lt;()&gt; {<br>    | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ `main` function is not allowed to be `async`<br><br>error: aborting due to 2 previous errors<br><br>Some errors have detailed explanations: E0433, E0752.<br>For more information about an error, try `rustc --explain E0433`.<br>error: could not compile `httpie`<br>```","like_count":0,"discussions":[{"author":{"id":1079375,"avatar":"https://static001.geekbang.org/account/avatar/00/10/78/4f/e74f870c.jpg","nickname":"Tyr","note":"","ucode":"EAAFC8063202E0","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":526027,"discussion_content":"你可以看看你的 Cargo.toml 的 tokio 的依赖，感觉你依赖没有带 full 或者 macros feature。完整的代码我已经放在 github 上了，你可以参考。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1630380055,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":2365229,"avatar":"https://static001.geekbang.org/account/avatar/00/24/17/2d/b7614553.jpg","nickname":"Bruce","note":"","ucode":"2A48A313481754","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":391354,"discussion_content":"嗯嗯，是的，不好意思😣","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1630416029,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":309725,"user_name":"伦胖胖不胖","can_delete":false,"product_type":"c1","uid":1146045,"ip_address":"","ucode":"24CEEB5B2B8BEA","user_header":"https://static001.geekbang.org/account/avatar/00/11/7c/bd/70232c22.jpg","comment_is_top":false,"comment_ctime":1630314324,"is_pvip":true,"discussion_count":1,"race_medal":0,"score":"1630314324","product_id":100085301,"comment_content":"❯ cargo build --quiet &amp;&amp; target&#47;debug&#47;httpie post a=1 b=2<br>Opts { subcmd: Post(Post { url: &quot;a=1&quot;, body: [&quot;b=2&quot;] }) }","like_count":0,"discussions":[{"author":{"id":2738552,"avatar":"","nickname":"大哉乾元","note":"","ucode":"1FE07EB60046ED","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":391584,"discussion_content":"这里应该是命令里漏了url，试试target/debug/httpie post httpbin.org/post  a=1 b=2","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1630543385,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":309724,"user_name":"葡萄","can_delete":false,"product_type":"c1","uid":1018673,"ip_address":"","ucode":"6E8597D1B09807","user_header":"http://thirdwx.qlogo.cn/mmopen/ajNVdqHZLLDoDeeNST87MZEdfT8n7yEWp06KsFCTs2ssFh2tbHu413nibrRObOia1Zn9pqiaHgIicVkSHRZM3LHOEA/132","comment_is_top":false,"comment_ctime":1630314246,"is_pvip":false,"replies":[{"id":"112238","content":"注意看括号的位置。status() 后有一个括号。这里是把整个 format! 后的字符串统一加上 blue()：<br><br>```<br>let status = format!(&quot;{:?} {}&quot;, resp.version(), resp.status()).blue();<br>```","user_name":"作者回复","user_name_real":"Tyr","uid":"1079375","ctime":1630379543,"ip_address":"","comment_id":309724,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1630314246","product_id":100085301,"comment_content":"109行: resp.status().blue()<br>method not found in `StatusCode`<br>转换成 String 正常通过编译","like_count":0,"discussions":[{"author":{"id":1079375,"avatar":"https://static001.geekbang.org/account/avatar/00/10/78/4f/e74f870c.jpg","nickname":"Tyr","note":"","ucode":"EAAFC8063202E0","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":525982,"discussion_content":"注意看括号的位置。status() 后有一个括号。这里是把整个 format! 后的字符串统一加上 blue()：\n\n```\nlet status = format!(&amp;quot;{:?} {}&amp;quot;, resp.version(), resp.status()).blue();\n```","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1630379543,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":309687,"user_name":"土土人","can_delete":false,"product_type":"c1","uid":1045486,"ip_address":"","ucode":"6501B7D4F63E95","user_header":"https://static001.geekbang.org/account/avatar/00/0f/f3/ee/33ef689b.jpg","comment_is_top":false,"comment_ctime":1630303428,"is_pvip":true,"replies":[{"id":"112244","content":"在 windows 下我没有调试过，你也许可以试试想 clion 这样的全功能 IDE。如果你有 *nix 环境，可以用 gdb。不过我建议平时开发可以就用 dbg!() 或者在代码里放合适的 log。","user_name":"作者回复","user_name_real":"Tyr","uid":"1079375","ctime":1630380218,"ip_address":"","comment_id":309687,"utype":1}],"discussion_count":2,"race_medal":0,"score":"1630303428","product_id":100085301,"comment_content":"请问，windows环境下，选择vs的C、C++编译器，vscode开发rust如何调试？","like_count":0,"discussions":[{"author":{"id":1079375,"avatar":"https://static001.geekbang.org/account/avatar/00/10/78/4f/e74f870c.jpg","nickname":"Tyr","note":"","ucode":"EAAFC8063202E0","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":525967,"discussion_content":"在 windows 下我没有调试过，你也许可以试试想 clion 这样的全功能 IDE。如果你有 *nix 环境，可以用 gdb。不过我建议平时开发可以就用 dbg!() 或者在代码里放合适的 log。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1630380218,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1075443,"avatar":"https://static001.geekbang.org/account/avatar/00/10/68/f3/22481a37.jpg","nickname":"小样","note":"","ucode":"0D05E1D31150F1","race_medal":0,"user_type":1,"is_pvip":true},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":391252,"discussion_content":"微软vscode官网文档有教程，https://docs.microsoft.com/en-us/windows/dev-environment/rust/setup","likes_number":1,"is_delete":false,"is_hidden":false,"ctime":1630372557,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":309660,"user_name":"Devil","can_delete":false,"product_type":"c1","uid":1305932,"ip_address":"","ucode":"F88406A2629522","user_header":"https://static001.geekbang.org/account/avatar/00/13/ed/4c/5f34f8d7.jpg","comment_is_top":false,"comment_ctime":1630293382,"is_pvip":false,"replies":[{"id":"112147","content":"你用的是 Rust 1.54 么？<br><br>```bash<br>❯ rustc --version<br>rustc 1.54.0 (a178d0322 2021-07-26)<br>```","user_name":"作者回复","user_name_real":"Tyr","uid":"1079375","ctime":1630301200,"ip_address":"","comment_id":309660,"utype":1}],"discussion_count":3,"race_medal":0,"score":"1630293382","product_id":100085301,"comment_content":"第一个例子就运行不起来了,windows平台来的 目前没找到问题arbitrary expressions in key-value attributes are unstable","like_count":0,"discussions":[{"author":{"id":1079375,"avatar":"https://static001.geekbang.org/account/avatar/00/10/78/4f/e74f870c.jpg","nickname":"Tyr","note":"","ucode":"EAAFC8063202E0","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":525953,"discussion_content":"你用的是 Rust 1.54 么？\n\n```bash\n❯ rustc --version\nrustc 1.54.0 (a178d0322 2021-07-26)\n```","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1630301200,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1814574,"avatar":"https://static001.geekbang.org/account/avatar/00/1b/b0/2e/de90dc40.jpg","nickname":"Eric Wong","note":"","ucode":"47B9D98DD02E5E","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":392584,"discussion_content":"rustup update","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1631065527,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1068813,"avatar":"https://static001.geekbang.org/account/avatar/00/10/4f/0d/92ab32bd.jpg","nickname":"山海","note":"","ucode":"8FB6A60EB7FA25","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":391145,"discussion_content":"https://github.com/clap-rs/clap/issues/2741","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1630314812,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]}]}