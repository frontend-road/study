{"id":12709,"title":"76 |【实验】CAT 埋点案例","content":"无","comments":[{"had_liked":false,"id":57854,"user_name":"棒棒的","can_delete":false,"product_type":"c3","uid":1219225,"ip_address":"","ucode":"3CE636201A2919","user_header":"https://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTJ1VMxuA95ia4tvm1Wyxiat3paAxib2lb8lnicrKUdXLLniaqiap1B5AhmVeXsDJGJ65TvxO3uRV6n2jsww/132","comment_is_top":false,"comment_ctime":1546929646,"is_pvip":false,"replies":[{"id":20886,"content":"应该是CAT没配好，建议看CAT启动日志是否正常启动，客户端是否配置正确，如还有问题，可微信（bulldog2015）交流","user_name":"作者回复","user_name_real":"杨波","uid":1030344,"ctime":1546951935,"ip_address":"","comment_id":57854,"utype":1}],"discussion_count":2,"race_medal":0,"score":2,"product_id":100007001,"comment_content":"按照教程，取下代码，把几个服务都跑起来之后，postman调用http:&#47;&#47;localhost:8081&#47;start可以返回Hello from Acme Financial&#39;s Backend service. Calling Acme Financial&#39;s Account Service [Hello from Acme Financial&#39;s Account Microservice] and then Customer Service [Hello from Acme&#39;s Customer Microservice]但是在cat监控里面看不到新加进来的服务，还是只有一个cat是什么情况，是配置cat没配置对么","like_count":2,"discussions":[{"author":{"id":1030344,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/b8/c8/c94d38a7.jpg","nickname":"杨波","note":"","ucode":"FA3418BB703BCA","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":435794,"discussion_content":"应该是CAT没配好，建议看CAT启动日志是否正常启动，客户端是否配置正确，如还有问题，可微信（bulldog2015）交流","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1546951935,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1051663,"avatar":"https://static001.geekbang.org/account/avatar/00/10/0c/0f/93d1c8eb.jpg","nickname":"mickey","note":"","ucode":"8B490C2DDE4010","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":333580,"discussion_content":"我也遇到了这个情况。解决方案：应用配的ip应该和cat配置的客户端ip保持一致。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1607568641,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":267007,"user_name":"mickey","can_delete":false,"product_type":"c3","uid":1051663,"ip_address":"","ucode":"8B490C2DDE4010","user_header":"https://static001.geekbang.org/account/avatar/00/10/0c/0f/93d1c8eb.jpg","comment_is_top":false,"comment_ctime":1607568355,"is_pvip":false,"replies":[{"id":97201,"content":"如果你只是做本机测试，客户端和服务器端都部署在本机上，那么127.0.0.1或者本机IP应该都可以，如果本机IP有问题，就换127.0.0.1尝试。\n\n如果是生产环境，全部用生产环境真实IP地址。","user_name":"作者回复","user_name_real":"杨波","uid":1030344,"ctime":1607866368,"ip_address":"","comment_id":267007,"utype":1}],"discussion_count":1,"race_medal":0,"score":2,"product_id":100007001,"comment_content":"老师，请教一个问题，cat配置和springboot应用的配置中，有的地方配的是ip，有的地方配的是127.0.0.1，请问是不是都配成127.0.0.1或本机IP都可以呢？谢谢。","like_count":0,"discussions":[{"author":{"id":1030344,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/b8/c8/c94d38a7.jpg","nickname":"杨波","note":"","ucode":"FA3418BB703BCA","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":511481,"discussion_content":"如果你只是做本机测试，客户端和服务器端都部署在本机上，那么127.0.0.1或者本机IP应该都可以，如果本机IP有问题，就换127.0.0.1尝试。\n\n如果是生产环境，全部用生产环境真实IP地址。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1607866368,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":120778,"user_name":"DZ","can_delete":false,"product_type":"c3","uid":1047376,"ip_address":"","ucode":"58BF0042E31449","user_header":"https://static001.geekbang.org/account/avatar/00/0f/fb/50/04071be6.jpg","comment_is_top":false,"comment_ctime":1564994451,"is_pvip":true,"replies":[{"id":44352,"content":"你好，CAT的logview是采样的。CAT和ELK不同，ELK可以查询任意一条日志，CAT关注总体统计性能，具体调用链它只是给出一些采样，它不关心某个具体的数据点。但是CAT把所有的调用链都存起来了，原始数据都在，如果需要，你可以进一步开发工具挖掘这些数据。","user_name":"作者回复","user_name_real":"杨波","uid":1030344,"ctime":1565005024,"ip_address":"","comment_id":120778,"utype":1}],"discussion_count":1,"race_medal":0,"score":2,"product_id":100007001,"comment_content":"老师，请教下，试验中同一个url下总共两个请求，logview中只能看到最新的一个？如果想看到第一个的调用链怎么处理？","like_count":0,"discussions":[{"author":{"id":1030344,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/b8/c8/c94d38a7.jpg","nickname":"杨波","note":"","ucode":"FA3418BB703BCA","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":461474,"discussion_content":"你好，CAT的logview是采样的。CAT和ELK不同，ELK可以查询任意一条日志，CAT关注总体统计性能，具体调用链它只是给出一些采样，它不关心某个具体的数据点。但是CAT把所有的调用链都存起来了，原始数据都在，如果需要，你可以进一步开发工具挖掘这些数据。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1565005024,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":101158,"user_name":"力成","can_delete":false,"product_type":"c3","uid":1451020,"ip_address":"","ucode":"F88F335E13E30E","user_header":"https://static001.geekbang.org/account/avatar/00/16/24/0c/8b9e2c6b.jpg","comment_is_top":false,"comment_ctime":1559729567,"is_pvip":false,"replies":[{"id":36634,"content":"CAT3.0升级后，客户端的配置方式有调整，我在lab02的README头上有更新说明，你尝试一下。","user_name":"作者回复","user_name_real":"杨波","uid":1030344,"ctime":1559913802,"ip_address":"","comment_id":101158,"utype":1}],"discussion_count":1,"race_medal":0,"score":2,"product_id":100007001,"comment_content":"四个服务都跑起来了，cat 服务也跑起来了，跟楼上一样，就是看不到四个服务的显示","like_count":0,"discussions":[{"author":{"id":1030344,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/b8/c8/c94d38a7.jpg","nickname":"杨波","note":"","ucode":"FA3418BB703BCA","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":452827,"discussion_content":"CAT3.0升级后，客户端的配置方式有调整，我在lab02的README头上有更新说明，你尝试一下。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1559913802,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":73465,"user_name":"我已经设置了昵称","can_delete":false,"product_type":"c3","uid":1364034,"ip_address":"","ucode":"ED672C5EBDBDC4","user_header":"https://static001.geekbang.org/account/avatar/00/14/d0/42/6fd01fb9.jpg","comment_is_top":false,"comment_ctime":1551893008,"is_pvip":false,"replies":[{"id":27278,"content":"注意cat3.0客户端配置app名称方式和之前2.0不同，看这里：https:&#47;&#47;github.com&#47;dianping&#47;cat&#47;tree&#47;master&#47;lib&#47;java。如果还不出来，建议看log甚至debug一下cat客户端，看看是否正常启动，还是在哪一步初始化出错了？cat客户端的代码其实不多的，初始化部分也不难看懂。","user_name":"作者回复","user_name_real":"杨波","uid":1030344,"ctime":1552308572,"ip_address":"","comment_id":73465,"utype":1}],"discussion_count":4,"race_medal":0,"score":2,"product_id":100007001,"comment_content":"github上已经更新到3.0，遇到了跟楼上的同学一样的问题，cat dashboard显示正常，4个客户端服务pom文件全改成了3.0.0，因为2.0.0在maven仓库已经找不到，改完后正常运行。调用接口也是和老师一样的返回。但在cat transaction页面仍然只有两个default和一个cat。怀疑是否跟2.0.0改成了3.0.0有关","like_count":0,"discussions":[{"author":{"id":1030344,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/b8/c8/c94d38a7.jpg","nickname":"杨波","note":"","ucode":"FA3418BB703BCA","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":442101,"discussion_content":"注意cat3.0客户端配置app名称方式和之前2.0不同，看这里：https://github.com/dianping/cat/tree/master/lib/java。如果还不出来，建议看log甚至debug一下cat客户端，看看是否正常启动，还是在哪一步初始化出错了？cat客户端的代码其实不多的，初始化部分也不难看懂。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1552308572,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1435046,"avatar":"https://static001.geekbang.org/account/avatar/00/15/e5/a6/50866022.jpg","nickname":"doudoufly","note":"","ucode":"FF8907D9EFAAF9","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":613244,"discussion_content":"大家有没有遇到这个问题：点击log view 所有的都提示Sorry, the message is not there. It could be missing or archived.  使用的是最新版本。","likes_number":1,"is_delete":false,"is_hidden":false,"ctime":1681211400,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":"湖北","group_id":0},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1253652,"avatar":"https://static001.geekbang.org/account/avatar/00/13/21/14/423a821f.jpg","nickname":"Steven","note":"","ucode":"3FE64459842015","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":391032,"discussion_content":"我的也是改成 3.0了，除了 app.properties，还把 account 和 customer 两个服务里面的 sleep 的时长改短，要不然一直 time out。\n现在都好用了。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1630236815,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1066678,"avatar":"https://static001.geekbang.org/account/avatar/00/10/46/b6/edfe7ce8.jpg","nickname":"夜里吃西瓜","note":"","ucode":"362817AF375E38","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":386257,"discussion_content":"在项目中创建 src/main/resources/META-INF/app.properties 文件, 并添加如下内容：app.name={appkey}\n便可以了","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1627484195,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":372504,"user_name":"doudoufly","can_delete":false,"product_type":"c3","uid":1435046,"ip_address":"湖北","ucode":"FF8907D9EFAAF9","user_header":"https://static001.geekbang.org/account/avatar/00/15/e5/a6/50866022.jpg","comment_is_top":false,"comment_ctime":1681211490,"is_pvip":false,"replies":null,"discussion_count":1,"race_medal":0,"score":2,"product_id":100007001,"comment_content":"大家有没有遇到这个问题：点击log view 所有的都提示Sorry, the message is not there. It could be missing or archived.  使用的是最新版本。","like_count":0,"discussions":[{"author":{"id":1253652,"avatar":"https://static001.geekbang.org/account/avatar/00/13/21/14/423a821f.jpg","nickname":"Steven","note":"","ucode":"3FE64459842015","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":637819,"discussion_content":"我的也是，下载的最新的3.1版本，所有 log view 都显示这个提示。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1709000801,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":"辽宁","group_id":0},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]}]}