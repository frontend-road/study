{"id":86448,"title":"10 | 理解虚拟DOM及key属性的作用","content":"<h1>源代码及课件地址</h1><p><a href=\"https://gitee.com/geektime-geekbang/geektime-vue-1\">https://gitee.com/geektime-geekbang/geektime-vue-1</a></p>","comments":[{"had_liked":false,"id":80530,"user_name":"吴银春","can_delete":false,"product_type":"c3","uid":1457438,"ip_address":"","ucode":"1F0433FED5FE88","user_header":"https://static001.geekbang.org/account/avatar/00/16/3d/1e/1d5ce537.jpg","comment_is_top":false,"comment_ctime":1553677106,"is_pvip":false,"replies":[{"id":29287,"content":"👍","user_name":"作者回复","user_name_real":"唐","uid":1316874,"ctime":1553684168,"ip_address":"","comment_id":80530,"utype":1}],"discussion_count":6,"race_medal":0,"score":2,"product_id":100024601,"comment_content":"测试发现，最好不要用index作为key，用index作为key有时候还会导致bug，尤其是item是具有某种状态的时候。。举个简单的例子，如果有ABC三个item，其中第一个A是选中的，这个时候如果我在A前面添加D，如果用index作为key就会变成D是选中的了，建议用唯一id来作为key\n","like_count":47,"discussions":[{"author":{"id":1316874,"avatar":"https://static001.geekbang.org/account/avatar/00/14/18/0a/28206510.jpg","nickname":"唐金州","note":"","ucode":"563B97D87C66AC","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":444893,"discussion_content":"👍","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1553684168,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":2704026,"avatar":"https://static001.geekbang.org/account/avatar/00/29/42/9a/d719f883.jpg","nickname":"潇湘夜雨","note":"","ucode":"2597816B07903D","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":384349,"discussion_content":"其实之前在做一个考试项目的时候我就遇到过这个bug，用index做唯一标识的时候，你选中一个，其他三个也会选中，但是用id来做唯一标识就没有上述情况了。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1626511779,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1382358,"avatar":"https://static001.geekbang.org/account/avatar/00/15/17/d6/f225456c.jpg","nickname":"萱","note":"","ucode":"CE7A24818F0929","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":279905,"discussion_content":"请问这个场景是怎么实现的呢？我能想到的选中状态也是跟着item里的一个属性走的，这样删除以后选中状态也不会改变😂","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1591448983,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"","child_discussion_number":1,"child_discussions":[{"author":{"id":1994991,"avatar":"https://static001.geekbang.org/account/avatar/00/1e/70/ef/3717a2c6.jpg","nickname":"Tommy","note":"","ucode":"336E7703EAD0A0","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":1382358,"avatar":"https://static001.geekbang.org/account/avatar/00/15/17/d6/f225456c.jpg","nickname":"萱","note":"","ucode":"CE7A24818F0929","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":321964,"discussion_content":"按上面的例子意思是默认第0个选中吧，如果在A前面添加D，由于v-for的原因D的index就变成0了，所以选中的是D","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1604654328,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":279905,"ip_address":"","group_id":0},"score":321964,"extra":""}]},{"author":{"id":1589315,"avatar":"https://static001.geekbang.org/account/avatar/00/18/40/43/9439fb1a.jpg","nickname":"你怎么是个🐷","note":"","ucode":"0CF21CDAEC150D","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":232350,"discussion_content":"大佬牛掰，今天刚刚好遇到这样子的问题👍","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1586867248,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1177005,"avatar":"https://static001.geekbang.org/account/avatar/00/11/f5/ad/2f7d5e50.jpg","nickname":"小玲子ida","note":"","ucode":"A447EF847D375E","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":206242,"discussion_content":"我也遇到过这种问题，可以使用name+index，以防name或者其他属性值重复","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1584372461,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":79074,"user_name":"leslee","can_delete":false,"product_type":"c3","uid":1384326,"ip_address":"","ucode":"DB1CBF9F8D16BF","user_header":"https://static001.geekbang.org/account/avatar/00/15/1f/86/3a7eeac4.jpg","comment_is_top":false,"comment_ctime":1553343828,"is_pvip":false,"replies":[{"id":28867,"content":"应该是子组件有自己的状态的时候，就是data。\n他们和key本身没关系，但是如果你用了index作为key，当出现删除，排序后，状态就和你的预期不一样了，如 A1 A2 内部分别有自己的状态message 1和2  如果拿index做为key，逆序后变成A2 A1  但A2的message就变成了1 A1的message变成了2","user_name":"作者回复","user_name_real":"唐","uid":1316874,"ctime":1553395358,"ip_address":"","comment_id":79074,"utype":1}],"discussion_count":1,"race_medal":0,"score":2,"product_id":100024601,"comment_content":"老师你好, 看了评论知道子组件有状态的时候不能用index做key , 那么组件的状态是指data, props 这些数据吗,  什么是无状态组件呢, 他们跟key有什么关联?","like_count":7,"discussions":[{"author":{"id":1316874,"avatar":"https://static001.geekbang.org/account/avatar/00/14/18/0a/28206510.jpg","nickname":"唐金州","note":"","ucode":"563B97D87C66AC","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":444347,"discussion_content":"应该是子组件有自己的状态的时候，就是data。\n他们和key本身没关系，但是如果你用了index作为key，当出现删除，排序后，状态就和你的预期不一样了，如 A1 A2 内部分别有自己的状态message 1和2  如果拿index做为key，逆序后变成A2 A1  但A2的message就变成了1 A1的message变成了2","likes_number":1,"is_delete":false,"is_hidden":false,"ctime":1553395358,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":77449,"user_name":"darren","can_delete":false,"product_type":"c3","uid":1151837,"ip_address":"","ucode":"4726076845920B","user_header":"https://static001.geekbang.org/account/avatar/00/11/93/5d/91f1d849.jpg","comment_is_top":false,"comment_ctime":1552927524,"is_pvip":false,"replies":[{"id":28276,"content":"场景1 bcd 是不同类型的节点，如 分别是span div p 三种类型   场景4是三个同类型节点，只是传递的属性不一致 ","user_name":"作者回复","user_name_real":"唐","uid":1316874,"ctime":1552952073,"ip_address":"","comment_id":77449,"utype":1}],"discussion_count":1,"race_medal":0,"score":2,"product_id":100024601,"comment_content":"场景一和场景四怎么区分的哦？","like_count":7,"discussions":[{"author":{"id":1316874,"avatar":"https://static001.geekbang.org/account/avatar/00/14/18/0a/28206510.jpg","nickname":"唐金州","note":"","ucode":"563B97D87C66AC","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":443728,"discussion_content":"场景1 bcd 是不同类型的节点，如 分别是span div p 三种类型   场景4是三个同类型节点，只是传递的属性不一致 ","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1552952073,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":93099,"user_name":"jacky","can_delete":false,"product_type":"c3","uid":1049177,"ip_address":"","ucode":"A0BD06E2ABF520","user_header":"https://static001.geekbang.org/account/avatar/00/10/02/59/989f65c8.jpg","comment_is_top":false,"comment_ctime":1557397874,"is_pvip":false,"replies":[{"id":33754,"content":"对，的确要差一些，最终都是要操作dom的，当然也分场景，但是框架是在性能和开发效率之间找到一个平衡点   ","user_name":"作者回复","user_name_real":"唐","uid":1316874,"ctime":1557809619,"ip_address":"","comment_id":93099,"utype":1}],"discussion_count":2,"race_medal":0,"score":2,"product_id":100024601,"comment_content":"vue这种间接操作Dom原理，性能方面比jquery的直接操作Dom性能更差一些？","like_count":5,"discussions":[{"author":{"id":1316874,"avatar":"https://static001.geekbang.org/account/avatar/00/14/18/0a/28206510.jpg","nickname":"唐金州","note":"","ucode":"563B97D87C66AC","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":449487,"discussion_content":"对，的确要差一些，最终都是要操作dom的，当然也分场景，但是框架是在性能和开发效率之间找到一个平衡点   ","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1557809619,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1272789,"avatar":"https://static001.geekbang.org/account/avatar/00/13/6b/d5/0e4b70a2.jpg","nickname":"Sean","note":"","ucode":"BC0715BF423613","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":186437,"discussion_content":"单次操作来看，肯定是jq直接操作来的快一点；但是对于多次的批量操作；应该还是间接操作好一点，因为中间做了合并和复用。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1582681222,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":210701,"user_name":"Yu","can_delete":false,"product_type":"c3","uid":1248283,"ip_address":"","ucode":"2500EEBA5A8ABC","user_header":"https://static001.geekbang.org/account/avatar/00/13/0c/1b/bf7d6626.jpg","comment_is_top":false,"comment_ctime":1587810700,"is_pvip":false,"replies":[{"id":78481,"content":"如果没有唯一值，可以维护自增的id 只要保证静态唯一","user_name":"作者回复","user_name_real":"唐","uid":1316874,"ctime":1587876438,"ip_address":"","comment_id":210701,"utype":1}],"discussion_count":4,"race_medal":0,"score":2,"product_id":100024601,"comment_content":"如果没有数据id，怎样生成key更符合规范呢？","like_count":4,"discussions":[{"author":{"id":1316874,"avatar":"https://static001.geekbang.org/account/avatar/00/14/18/0a/28206510.jpg","nickname":"唐金州","note":"","ucode":"563B97D87C66AC","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":493088,"discussion_content":"如果没有唯一值，可以维护自增的id 只要保证静态唯一","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1587876438,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1043023,"avatar":"https://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTK2pb17ofgknNGwKg6HT9Jlf88s6ibpkmibzEv3FO7E3HmVfaynh5TNqw1je29q2q4ohRa0SkWv4reg/132","nickname":"掌柜的","note":"","ucode":"F3AB62ADBFA0D9","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":327096,"discussion_content":"可能还是index方便一点,  要不就? :key=&#34;index + Math.random().toString(36).slice(-8)&#34;","likes_number":1,"is_delete":false,"is_hidden":false,"ctime":1605747674,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":2136898,"avatar":"https://static001.geekbang.org/account/avatar/00/20/9b/42/c324a7de.jpg","nickname":"周勇","note":"","ucode":"AD9F593C2565F0","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":584723,"discussion_content":"可以在拿到数据的时候自己创建key值，或者在绑定key的时候，使用多个值，保证是唯一不变的","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1661065779,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":"四川","group_id":0},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1248283,"avatar":"https://static001.geekbang.org/account/avatar/00/13/0c/1b/bf7d6626.jpg","nickname":"Yu","note":"","ucode":"2500EEBA5A8ABC","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":251237,"discussion_content":"谢谢老师","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1588076039,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":89537,"user_name":"jacky","can_delete":false,"product_type":"c3","uid":1049177,"ip_address":"","ucode":"A0BD06E2ABF520","user_header":"https://static001.geekbang.org/account/avatar/00/10/02/59/989f65c8.jpg","comment_is_top":false,"comment_ctime":1556199616,"is_pvip":false,"replies":[{"id":32116,"content":"仅支持ie9及以上 ","user_name":"作者回复","user_name_real":"唐","uid":1316874,"ctime":1556238218,"ip_address":"","comment_id":89537,"utype":1}],"discussion_count":1,"race_medal":0,"score":2,"product_id":100024601,"comment_content":"请问老师vue开发网站，浏览器兼容性这块是不是有所限制？","like_count":4,"discussions":[{"author":{"id":1316874,"avatar":"https://static001.geekbang.org/account/avatar/00/14/18/0a/28206510.jpg","nickname":"唐金州","note":"","ucode":"563B97D87C66AC","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":448166,"discussion_content":"仅支持ie9及以上 ","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1556238218,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":112145,"user_name":"都市夜归人","can_delete":false,"product_type":"c3","uid":1071909,"ip_address":"","ucode":"DFF59BE3D80B42","user_header":"https://static001.geekbang.org/account/avatar/00/10/5b/25/d78cc1fe.jpg","comment_is_top":false,"comment_ctime":1562674335,"is_pvip":false,"replies":[{"id":42423,"content":"并不可以， key需要的是一个静态唯一值   如果没有静态唯一值，可以自己生成","user_name":"作者回复","user_name_real":"唐","uid":1316874,"ctime":1563781100,"ip_address":"","comment_id":112145,"utype":1}],"discussion_count":4,"race_medal":0,"score":2,"product_id":100024601,"comment_content":"当使用v-for时，由于后台返回的数据有时候没有唯一的主键，请问是否可以使用数据中的某个属性+index作为:key的值？谢谢！","like_count":3,"discussions":[{"author":{"id":1316874,"avatar":"https://static001.geekbang.org/account/avatar/00/14/18/0a/28206510.jpg","nickname":"唐金州","note":"","ucode":"563B97D87C66AC","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":457598,"discussion_content":"并不可以， key需要的是一个静态唯一值   如果没有静态唯一值，可以自己生成","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1563781100,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1382913,"avatar":"https://static001.geekbang.org/account/avatar/00/15/1a/01/938ab37d.jpg","nickname":"寒夜","note":"","ucode":"45771EAA805409","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":242858,"discussion_content":"关于key的生成有没有什么好的方案？","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1587485893,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1382865,"avatar":"https://static001.geekbang.org/account/avatar/00/15/19/d1/34431e3d.jpg","nickname":"你都如何回忆我","note":"","ucode":"87D3C0D60CDF4A","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":48211,"discussion_content":"随意随机数一个可以吗","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1573464222,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"","child_discussion_number":1,"child_discussions":[{"author":{"id":1475528,"avatar":"https://static001.geekbang.org/account/avatar/00/16/83/c8/5ce842f6.jpg","nickname":"maybe","note":"","ucode":"93D160F617E750","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":1382865,"avatar":"https://static001.geekbang.org/account/avatar/00/15/19/d1/34431e3d.jpg","nickname":"你都如何回忆我","note":"","ucode":"87D3C0D60CDF4A","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":406344,"discussion_content":"容易重复","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1634740984,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":48211,"ip_address":"","group_id":0},"score":406344,"extra":""}]}]},{"had_liked":false,"id":206117,"user_name":"希言自然","can_delete":false,"product_type":"c3","uid":1736720,"ip_address":"","ucode":"8D99A82B05636B","user_header":"https://static001.geekbang.org/account/avatar/00/1a/80/10/2406a662.jpg","comment_is_top":false,"comment_ctime":1586789364,"is_pvip":false,"replies":[{"id":77540,"content":"不对  写几个bug加深理解","user_name":"作者回复","user_name_real":"唐","uid":1316874,"ctime":1587130458,"ip_address":"","comment_id":206117,"utype":1}],"discussion_count":1,"race_medal":0,"score":2,"product_id":100024601,"comment_content":"课后作业：不使用index，是因为老师说的场景是排序或者数据list变化操作。key是为了辅助vue做dom操作的，一旦排序，list内容发生变化，很可能出现相同index的但内容不同的标记被渲染到页面，这样理解对吗？","like_count":2,"discussions":[{"author":{"id":1316874,"avatar":"https://static001.geekbang.org/account/avatar/00/14/18/0a/28206510.jpg","nickname":"唐金州","note":"","ucode":"563B97D87C66AC","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":491677,"discussion_content":"不对  写几个bug加深理解","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1587130458,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":157916,"user_name":"你的一哥","can_delete":false,"product_type":"c3","uid":1446003,"ip_address":"","ucode":"7942BA29B7A54E","user_header":"https://static001.geekbang.org/account/avatar/00/16/10/73/c64bc26d.jpg","comment_is_top":false,"comment_ctime":1575282563,"is_pvip":false,"replies":[{"id":61864,"content":"是的","user_name":"作者回复","user_name_real":"唐","uid":1316874,"ctime":1576581558,"ip_address":"","comment_id":157916,"utype":1}],"discussion_count":1,"race_medal":0,"score":2,"product_id":100024601,"comment_content":"同级节点没有相同类型的？是指同层不能出现相同的html标签吗？","like_count":2,"discussions":[{"author":{"id":1316874,"avatar":"https://static001.geekbang.org/account/avatar/00/14/18/0a/28206510.jpg","nickname":"唐金州","note":"","ucode":"563B97D87C66AC","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":476576,"discussion_content":"是的","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1576581558,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":81359,"user_name":"danea.w","can_delete":false,"product_type":"c3","uid":1482081,"ip_address":"","ucode":"ECAB254B5EE6B6","user_header":"http://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTIp4EpK6ZiaSFkBBPR6zlcqUIqYdOHMicSMlabnAeLQMyQoQKAuQ8OvMj4c6DkRyHCPuOJ33eicEY5xw/132","comment_is_top":false,"comment_ctime":1553870938,"is_pvip":false,"replies":[{"id":30835,"content":"理解vue的更新机制，提升组件的渲染性能，尤其是key的作用，除了性能，还有避免因为key的不稳定导致的bug","user_name":"作者回复","user_name_real":"唐","uid":1316874,"ctime":1555234802,"ip_address":"","comment_id":81359,"utype":1}],"discussion_count":1,"race_medal":0,"score":2,"product_id":100024601,"comment_content":"老师，讲这些场景的意义在哪里🧐","like_count":2,"discussions":[{"author":{"id":1316874,"avatar":"https://static001.geekbang.org/account/avatar/00/14/18/0a/28206510.jpg","nickname":"唐金州","note":"","ucode":"563B97D87C66AC","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":445164,"discussion_content":"理解vue的更新机制，提升组件的渲染性能，尤其是key的作用，除了性能，还有避免因为key的不稳定导致的bug","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1555234802,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":77786,"user_name":"CCCCJH","can_delete":false,"product_type":"c3","uid":1440171,"ip_address":"","ucode":"4006A70122AB71","user_header":"https://static001.geekbang.org/account/avatar/00/15/f9/ab/958a4646.jpg","comment_is_top":false,"comment_ctime":1552998198,"is_pvip":false,"replies":[{"id":28409,"content":"删除多个倒不会，只是真正被删除的那个却不是我们想要删除的那个  对于普通元素倒还好，因为都是纯显示的，但如果是自定义组件，而组件内还维护着自己的状态，那么状态就乱了 ","user_name":"作者回复","user_name_real":"唐","uid":1316874,"ctime":1553004967,"ip_address":"","comment_id":77786,"utype":1}],"discussion_count":1,"race_medal":0,"score":3,"product_id":100024601,"comment_content":"当index作为key时，要删除数组某个元素时，删除的元素后面一个元素的index会变成刚删除的那个元素的index，出现删除多个元素的bug","like_count":2,"discussions":[{"author":{"id":1316874,"avatar":"https://static001.geekbang.org/account/avatar/00/14/18/0a/28206510.jpg","nickname":"唐金州","note":"","ucode":"563B97D87C66AC","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":443852,"discussion_content":"删除多个倒不会，只是真正被删除的那个却不是我们想要删除的那个  对于普通元素倒还好，因为都是纯显示的，但如果是自定义组件，而组件内还维护着自己的状态，那么状态就乱了 ","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1553004967,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":147869,"user_name":"Kite","can_delete":false,"product_type":"c3","uid":1374421,"ip_address":"","ucode":"9DACE8E0EC84A6","user_header":"https://static001.geekbang.org/account/avatar/00/14/f8/d5/fd04fcbc.jpg","comment_is_top":false,"comment_ctime":1572915691,"is_pvip":false,"replies":[{"id":57128,"content":"你所谓的树形结构的移动之所以高是在查找上，但虚拟dom只做同级比对，移动也只存在同级移动，所以并不高，第二点，的确是先对比的类型","user_name":"作者回复","user_name_real":"唐","uid":1316874,"ctime":1573007255,"ip_address":"","comment_id":147869,"utype":1}],"discussion_count":1,"race_medal":0,"score":3,"product_id":100024601,"comment_content":"老师，在树型结构中，移动操作的代价应该比删除&#47;新增的高吧?所以在做节点移动的时候，应该是在旧位置删除节点，在新的位置新增节点，不知道这样的理解对不对。\n另外，key 作为节点的唯一标识这里，还是有点懵，意思是diff在做新旧比对的时候，先比对的是节点的类型吗？","like_count":1,"discussions":[{"author":{"id":1316874,"avatar":"https://static001.geekbang.org/account/avatar/00/14/18/0a/28206510.jpg","nickname":"唐金州","note":"","ucode":"563B97D87C66AC","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":473326,"discussion_content":"你所谓的树形结构的移动之所以高是在查找上，但虚拟dom只做同级比对，移动也只存在同级移动，所以并不高，第二点，的确是先对比的类型","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1573007255,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":108237,"user_name":"Roy Liang","can_delete":false,"product_type":"c3","uid":1098898,"ip_address":"","ucode":"1DF5FC831A35DA","user_header":"https://static001.geekbang.org/account/avatar/00/10/c4/92/338b5609.jpg","comment_is_top":false,"comment_ctime":1561703504,"is_pvip":false,"replies":[{"id":39533,"content":"建议查看下输出日志实际体会下，使用场景就是只要节点是动态的(有时有，有时无，有时顺序会变)，这种情况下都要用key 反之可以不用","user_name":"作者回复","user_name_real":"唐","uid":1316874,"ctime":1561982538,"ip_address":"","comment_id":108237,"utype":1}],"discussion_count":1,"race_medal":0,"score":3,"product_id":100024601,"comment_content":"看README.md之后可以跑起来了，但是还是非常疑惑本节的样例都做了什么演示？有key和无key的区别是什么？什么情况下更新插入？什么情况下更新新建？什么情况下删除新建？各自的使用场景是什么？","like_count":1,"discussions":[{"author":{"id":1316874,"avatar":"https://static001.geekbang.org/account/avatar/00/14/18/0a/28206510.jpg","nickname":"唐金州","note":"","ucode":"563B97D87C66AC","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":455880,"discussion_content":"建议查看下输出日志实际体会下，使用场景就是只要节点是动态的(有时有，有时无，有时顺序会变)，这种情况下都要用key 反之可以不用","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1561982538,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":78328,"user_name":"盆栽","can_delete":false,"product_type":"c3","uid":1374045,"ip_address":"","ucode":"C5B02C4E5C9B75","user_header":"https://static001.geekbang.org/account/avatar/00/14/f7/5d/3fd98765.jpg","comment_is_top":false,"comment_ctime":1553131058,"is_pvip":false,"replies":[{"id":28562,"content":"对，不止删除，添加、排序，都会出现不符合预期的情况，主要是子组件有自己的状态的时候","user_name":"作者回复","user_name_real":"唐","uid":1316874,"ctime":1553162557,"ip_address":"","comment_id":78328,"utype":1}],"discussion_count":1,"race_medal":0,"score":3,"product_id":100024601,"comment_content":"index只能做为一个key的一个备选，毕竟顺序并不能唯一确定一个值。\n\n\n至于bug，想到的就是，比如删除数组的一个元素，始终是删除最后一项？","like_count":1,"discussions":[{"author":{"id":1316874,"avatar":"https://static001.geekbang.org/account/avatar/00/14/18/0a/28206510.jpg","nickname":"唐金州","note":"","ucode":"563B97D87C66AC","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":444049,"discussion_content":"对，不止删除，添加、排序，都会出现不符合预期的情况，主要是子组件有自己的状态的时候","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1553162557,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":77596,"user_name":"泡泡","can_delete":false,"product_type":"c3","uid":1450772,"ip_address":"","ucode":"8142CAE464D2FB","user_header":"http://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTKS4a1IwJOrnOGqCVAQSPWQeW6KTAPPGichBa53tyD3aJ3MmMIq8oueVSFLlkSTp2MHStseAkCDtBw/132","comment_is_top":false,"comment_ctime":1552967397,"is_pvip":false,"replies":[{"id":28418,"content":"1. 简单列表不用key没问题，但“就地复用”并不是最高效的模式，而且有一定限制（只适用于不依赖子组件状态或临时 DOM 状态的列表渲染输出），所以推荐能用key的还是用key，但如果真的没有key，可以不用\n2. 这是一方面，但即便没有多个数据项循环，依然也是有问题的  如前面提到的，依赖子组件状态的情况下，如果用了index作为key，会发生什么\n","user_name":"作者回复","user_name_real":"唐","uid":1316874,"ctime":1553007421,"ip_address":"","comment_id":77596,"utype":1}],"discussion_count":1,"race_medal":0,"score":3,"product_id":100024601,"comment_content":"1.首先考虑是否需要key？官方文档指出，当没有key时，会默认“就地复用”，如果只是数据项的顺序改变，vue不会移动DOM元素来匹配数据项的顺序，而是简单复用此处每个元素。当然这种情况只适用于简单的下来列表，而工作中恰恰都是简单的循环输出，所以说使用了key，大部分情况会绕开“就地复用”策略。\n2.如果要使用，是否可以用index？不能，如果页面中有多个数据项循环，index便不能唯一。","like_count":1,"discussions":[{"author":{"id":1316874,"avatar":"https://static001.geekbang.org/account/avatar/00/14/18/0a/28206510.jpg","nickname":"唐金州","note":"","ucode":"563B97D87C66AC","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":443793,"discussion_content":"1. 简单列表不用key没问题，但“就地复用”并不是最高效的模式，而且有一定限制（只适用于不依赖子组件状态或临时 DOM 状态的列表渲染输出），所以推荐能用key的还是用key，但如果真的没有key，可以不用\n2. 这是一方面，但即便没有多个数据项循环，依然也是有问题的  如前面提到的，依赖子组件状态的情况下，如果用了index作为key，会发生什么\n","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1553007421,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":222099,"user_name":"刘员外","can_delete":false,"product_type":"c3","uid":1734909,"ip_address":"","ucode":"0B97EF3222F5FC","user_header":"https://static001.geekbang.org/account/avatar/00/1a/78/fd/e9b17162.jpg","comment_is_top":false,"comment_ctime":1590676801,"is_pvip":false,"replies":[{"id":84908,"content":"也没毛病  最好自己造个有bug的场景 加深理解","user_name":"作者回复","user_name_real":"唐","uid":1316874,"ctime":1593261611,"ip_address":"","comment_id":222099,"utype":1}],"discussion_count":1,"race_medal":0,"score":3,"product_id":100024601,"comment_content":"key用 index的话，数据发生变化的时候，除了会有一些bug，之前渲染好的dom也得不到足够的复用。因为数据变了，index也会跟着变，之前渲染好的dom，就会再重新渲染一次。我的理解对吗？","like_count":0,"discussions":[{"author":{"id":1316874,"avatar":"https://static001.geekbang.org/account/avatar/00/14/18/0a/28206510.jpg","nickname":"唐金州","note":"","ucode":"563B97D87C66AC","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":496666,"discussion_content":"也没毛病  最好自己造个有bug的场景 加深理解","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1593261611,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":215663,"user_name":"Geek_115bc8","can_delete":false,"product_type":"c3","uid":1673843,"ip_address":"","ucode":"71FBC9F02AFE1B","user_header":"http://thirdwx.qlogo.cn/mmopen/vi_32/DYAIOgq83erXRaa98A3zjLDkOibUJV1254aQ4EYFTbSLJuEvD0nXicMNA8pLoxOfHf5kPTbGLXNicg8CPFH3Tn0mA/132","comment_is_top":false,"comment_ctime":1589070041,"is_pvip":false,"replies":[{"id":80643,"content":"比较的是虚拟dom 具体看不看完并不一定，也并不重要，不同的算法不同的策略","user_name":"作者回复","user_name_real":"唐","uid":1316874,"ctime":1589710412,"ip_address":"","comment_id":215663,"utype":1}],"discussion_count":1,"race_medal":0,"score":3,"product_id":100024601,"comment_content":"老师，每一层的html标签都不一样，dom比较的时候是将一层的HTML标签都看完么   就像案例一，还是只比较各自的位置的html发现不一样就更新重建","like_count":0,"discussions":[{"author":{"id":1316874,"avatar":"https://static001.geekbang.org/account/avatar/00/14/18/0a/28206510.jpg","nickname":"唐金州","note":"","ucode":"563B97D87C66AC","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":494516,"discussion_content":"比较的是虚拟dom 具体看不看完并不一定，也并不重要，不同的算法不同的策略","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1589710412,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":126740,"user_name":"Geek_587003","can_delete":false,"product_type":"c3","uid":1602312,"ip_address":"","ucode":"0109ED6E27C6AD","user_header":"http://thirdwx.qlogo.cn/mmopen/vi_32/kE30Q64dia7425Svq031VibOnFMEwAASKHzRTic4hOw4vicdfAxGFyUBdicjtSxvsJibR1pTia5uose8E07py8UKOk6fA/132","comment_is_top":false,"comment_ctime":1566461312,"is_pvip":false,"replies":[{"id":51521,"content":"脑补不出来你的问题 😓","user_name":"作者回复","user_name_real":"唐","uid":1316874,"ctime":1568819341,"ip_address":"","comment_id":126740,"utype":1}],"discussion_count":1,"race_medal":0,"score":3,"product_id":100024601,"comment_content":"老师，有个问题dialog里加载谷歌地图，谷歌地图对象已经初始化成功了就是不显示","like_count":0,"discussions":[{"author":{"id":1316874,"avatar":"https://static001.geekbang.org/account/avatar/00/14/18/0a/28206510.jpg","nickname":"唐金州","note":"","ucode":"563B97D87C66AC","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":464142,"discussion_content":"脑补不出来你的问题 😓","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1568819341,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":100036,"user_name":"水木年华","can_delete":false,"product_type":"c3","uid":1446205,"ip_address":"","ucode":"84B925B21F0381","user_header":"https://static001.geekbang.org/account/avatar/00/16/11/3d/58ac17a0.jpg","comment_is_top":false,"comment_ctime":1559398471,"is_pvip":false,"replies":[{"id":35972,"content":"还有很多好玩的  😄 感谢支持","user_name":"作者回复","user_name_real":"唐","uid":1316874,"ctime":1559451775,"ip_address":"","comment_id":100036,"utype":1}],"discussion_count":1,"race_medal":0,"score":3,"product_id":100024601,"comment_content":"老师讲的很透彻，原来是这么玩的。","like_count":0,"discussions":[{"author":{"id":1316874,"avatar":"https://static001.geekbang.org/account/avatar/00/14/18/0a/28206510.jpg","nickname":"唐金州","note":"","ucode":"563B97D87C66AC","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":452384,"discussion_content":"还有很多好玩的  😄 感谢支持","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1559451775,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":99110,"user_name":"遇見","can_delete":false,"product_type":"c3","uid":1332624,"ip_address":"","ucode":"E67A3F88C24528","user_header":"https://static001.geekbang.org/account/avatar/00/14/55/90/8df24b78.jpg","comment_is_top":false,"comment_ctime":1559143672,"is_pvip":false,"replies":[{"id":35643,"content":"对  仅限于同层比较","user_name":"作者回复","user_name_real":"唐","uid":1316874,"ctime":1559183557,"ip_address":"","comment_id":99110,"utype":1}],"discussion_count":1,"race_medal":0,"score":3,"product_id":100024601,"comment_content":"场景一是否也分有key和无key的状况，有key的情况下，就只是单纯的移动。无key的情况下B被更新成C ,C被更新成D,D被更新成B.是否可以这样理解？ 所以可以理解为key在虚拟DOM和真实的DOM进行同层比较中起着关键性的作用。","like_count":0,"discussions":[{"author":{"id":1316874,"avatar":"https://static001.geekbang.org/account/avatar/00/14/18/0a/28206510.jpg","nickname":"唐金州","note":"","ucode":"563B97D87C66AC","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":451973,"discussion_content":"对  仅限于同层比较","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1559183557,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":80047,"user_name":"Cander","can_delete":false,"product_type":"c3","uid":1381524,"ip_address":"","ucode":"838B8F877C7080","user_header":"https://static001.geekbang.org/account/avatar/00/15/14/94/7fcd4c89.jpg","comment_is_top":false,"comment_ctime":1553600247,"is_pvip":false,"replies":[{"id":29173,"content":"如果说就是你给出的div li而言，用index作为key,并不会引入bug。但如果是自定义组件，就不要这么用了。还有你这个两层key没有任何意义，虚拟dom只会同层比对  ","user_name":"作者回复","user_name_real":"唐","uid":1316874,"ctime":1553601807,"ip_address":"","comment_id":80047,"utype":1}],"discussion_count":1,"race_medal":0,"score":4,"product_id":100024601,"comment_content":"如果key使用index, 多重循环时, 使用两个循环的index的组合作为key可以吗?比如:\n\n&lt;li v-for=&quot;(item, index) in list&quot; :key=&quot;index&quot;&gt;\n     &lt;div v-for=&quot;(child, cIndex) in item.child&quot; :key=&quot;index + &#39;-&#39; + cIndex&quot;&gt;&lt;&#47;div&gt;\n&lt;&#47;li&gt;","like_count":0,"discussions":[{"author":{"id":1316874,"avatar":"https://static001.geekbang.org/account/avatar/00/14/18/0a/28206510.jpg","nickname":"唐金州","note":"","ucode":"563B97D87C66AC","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":444737,"discussion_content":"如果说就是你给出的div li而言，用index作为key,并不会引入bug。但如果是自定义组件，就不要这么用了。还有你这个两层key没有任何意义，虚拟dom只会同层比对  ","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1553601807,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":85117,"user_name":"琪","can_delete":false,"product_type":"c3","uid":1466358,"ip_address":"","ucode":"92F1FB88E9172D","user_header":"https://static001.geekbang.org/account/avatar/00/16/5f/f6/626cbbaf.jpg","comment_is_top":false,"comment_ctime":1554983857,"is_pvip":false,"replies":null,"discussion_count":2,"race_medal":0,"score":4,"product_id":100024601,"comment_content":"感觉挺好，这种讲法，不懂的自己私底下找各种资料，这样更深刻","like_count":14,"discussions":[{"author":{"id":1913586,"avatar":"","nickname":"严杰","note":"","ucode":"2B798364E2AC52","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":277105,"discussion_content":"舔狗，讲的好不好你心里没点比数么","likes_number":2,"is_delete":false,"is_hidden":false,"ctime":1591000714,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":2563329,"avatar":"https://static001.geekbang.org/account/avatar/00/27/1d/01/3ef22893.jpg","nickname":"且行","note":"","ucode":"A6693B31BABF4C","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":379415,"discussion_content":"我喜欢自己私底下找资料，买这课干嘛？都私底下找资料学不就行了","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1623893272,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":259948,"user_name":"风琴飞行员","can_delete":false,"product_type":"c3","uid":2283048,"ip_address":"","ucode":"8CCFD110A9A85A","user_header":"","comment_is_top":false,"comment_ctime":1604894002,"is_pvip":false,"replies":null,"discussion_count":0,"race_medal":0,"score":4,"product_id":100024601,"comment_content":"1、vue 中template模板会编译为渲染函数render，然后对比虚拟DOM，再更新到真实DOM上。\n2、有key：通过移动节点复用节点来更新DOM\n3、无key：会通过删除新建节点来更新DOM\n4、使用下标index作为Key：数组的操作删除新增排序，会造成BUG","like_count":9},{"had_liked":false,"id":304760,"user_name":"giteebravo","can_delete":false,"product_type":"c3","uid":1005290,"ip_address":"","ucode":"C087E8D6B5A98B","user_header":"https://static001.geekbang.org/account/avatar/00/0f/56/ea/32608c44.jpg","comment_is_top":false,"comment_ctime":1627605377,"is_pvip":false,"replies":null,"discussion_count":0,"race_medal":0,"score":4,"product_id":100024601,"comment_content":"\n云里雾里","like_count":3},{"had_liked":false,"id":238595,"user_name":"J.Smile","can_delete":false,"product_type":"c3","uid":1336475,"ip_address":"","ucode":"C4D98DFDBF7584","user_header":"https://static001.geekbang.org/account/avatar/00/14/64/9b/d1ab239e.jpg","comment_is_top":false,"comment_ctime":1596208767,"is_pvip":false,"replies":null,"discussion_count":1,"race_medal":0,"score":4,"product_id":100024601,"comment_content":"main.js作为程序的入口，其中引用了第一个单文件组件App.Vue，那到底是谁引用的main.js呢？还是说最终的http:&#47;&#47;localhost:8080首页面就是浏览器加载main.js生成的呢？","like_count":3,"discussions":[{"author":{"id":1043023,"avatar":"https://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTK2pb17ofgknNGwKg6HT9Jlf88s6ibpkmibzEv3FO7E3HmVfaynh5TNqw1je29q2q4ohRa0SkWv4reg/132","nickname":"掌柜的","note":"","ucode":"F3AB62ADBFA0D9","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":327107,"discussion_content":"main.js 是webpack的打包入口, 最后用来生成app.js的","likes_number":1,"is_delete":false,"is_hidden":false,"ctime":1605748852,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":293052,"user_name":"sy616","can_delete":false,"product_type":"c3","uid":2409051,"ip_address":"","ucode":"5C9D5616AC7F80","user_header":"","comment_is_top":false,"comment_ctime":1621174344,"is_pvip":false,"replies":null,"discussion_count":0,"race_medal":0,"score":4,"product_id":100024601,"comment_content":"vue 借鉴了 snabbdom的 diff 算法，在到达双边对比之前，也是经过很多的对比，比如节点类型相关的","like_count":1},{"had_liked":false,"id":195364,"user_name":"Breidt","can_delete":false,"product_type":"c3","uid":1358326,"ip_address":"","ucode":"EA7CAE7291DB5C","user_header":"https://static001.geekbang.org/account/avatar/00/14/b9/f6/4684806f.jpg","comment_is_top":false,"comment_ctime":1585183817,"is_pvip":false,"replies":null,"discussion_count":0,"race_medal":0,"score":4,"product_id":100024601,"comment_content":"如果用index作为key绑定的话，在排序或者移动的时候会出现bug，循环出来三个是一样的div,这时候排序的时候把索引就是变化，导致bug。在项目期间要求后端返回id是最好的。","like_count":1},{"had_liked":false,"id":169482,"user_name":"Geek_41b9d9","can_delete":false,"product_type":"c3","uid":1779597,"ip_address":"","ucode":"8899666C1AE18C","user_header":"http://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTK3TH1I8hJVRFw3vaSMPExYheb8mSTh9yjvGV6X5u3gnz9EqERUylib4ADa9ydDCPLp8icFg5oAniaug/132","comment_is_top":false,"comment_ctime":1578363076,"is_pvip":false,"replies":null,"discussion_count":0,"race_medal":0,"score":4,"product_id":100024601,"comment_content":"有哪位大佬在项目中升级过element呢，求经验","like_count":1},{"had_liked":false,"id":320861,"user_name":"阿飞","can_delete":false,"product_type":"c3","uid":2679130,"ip_address":"","ucode":"E06F9C65562476","user_header":"https://static001.geekbang.org/account/avatar/00/28/e1/5a/ea93e57d.jpg","comment_is_top":false,"comment_ctime":1636533564,"is_pvip":false,"replies":null,"discussion_count":0,"race_medal":0,"score":4,"product_id":100024601,"comment_content":"一直都听说key是影响性能的，大概有个迷迷糊糊的认知，可就是不知道具体是怎么回事。一看这个视频，就有种茅塞顿开的感觉，好棒！给作者点个赞！","like_count":0},{"had_liked":false,"id":290044,"user_name":"chris","can_delete":false,"product_type":"c3","uid":2549659,"ip_address":"","ucode":"E1F3CB9A4E13A2","user_header":"https://static001.geekbang.org/account/avatar/00/26/e7/9b/e8930453.jpg","comment_is_top":false,"comment_ctime":1619336380,"is_pvip":false,"replies":null,"discussion_count":1,"race_medal":0,"score":4,"product_id":100024601,"comment_content":"正常的旧算法，为什么是O（n3）的时间复杂度呢？这里没听懂，是n的三次方吗？","like_count":0,"discussions":[{"author":{"id":1706954,"avatar":"https://static001.geekbang.org/account/avatar/00/1a/0b/ca/19c46a77.jpg","nickname":"奉壹","note":"","ucode":"59965271745D22","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":383706,"discussion_content":"对的，O(n³)。遍历第一层节点，然后再遍历第二层节点，最后遍历第三层节点，所以时间复杂度为O(n³)。关于时间复杂度可以看下算法书","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1626195717,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":247519,"user_name":"shiTou","can_delete":false,"product_type":"c3","uid":2172227,"ip_address":"","ucode":"4AE4FB3D15EE42","user_header":"https://thirdwx.qlogo.cn/mmopen/vi_32/SibkSPyDCsQiakamkO2KO3nVPWAVRsOibLtn0EYPCH5XoeGm5bXER9lYI9sUQtpxgx4CmDqxrZpARlKeFKboha7XZnkuwrrMHyDpm8hhxFUqsQ/132","comment_is_top":false,"comment_ctime":1599730937,"is_pvip":false,"replies":null,"discussion_count":0,"race_medal":0,"score":5,"product_id":100024601,"comment_content":"教师节快乐\n","like_count":0},{"had_liked":false,"id":191690,"user_name":"刘凯","can_delete":false,"product_type":"c3","uid":1350608,"ip_address":"","ucode":"EFDC932CAE61A6","user_header":"https://static001.geekbang.org/account/avatar/00/14/9b/d0/86aee34c.jpg","comment_is_top":false,"comment_ctime":1584790773,"is_pvip":false,"replies":null,"discussion_count":0,"race_medal":0,"score":5,"product_id":100024601,"comment_content":"中午知道Key用处了","like_count":0},{"had_liked":false,"id":191386,"user_name":"Geek.S.","can_delete":false,"product_type":"c3","uid":1899087,"ip_address":"","ucode":"FC8A9FE3300B94","user_header":"https://static001.geekbang.org/account/avatar/00/1c/fa/4f/4252911a.jpg","comment_is_top":false,"comment_ctime":1584769438,"is_pvip":false,"replies":null,"discussion_count":0,"race_medal":0,"score":5,"product_id":100024601,"comment_content":"原来不是仅加入key就可以了，还需要静态唯一，否则在新增，删除，排序等场景中会出现与预期不一样的情景。\n\n这里有几个疑问，请问:\n1. vue单文件组件中，只能有一个根节点是为了降低虚拟DOM比对算法复杂度么？\n2. 为什么说key在原生html标签(如div, li等)里，用index就一定不会出现bug？key不是和数据有关么？怎么和标签有关？key是用来标识虚拟DOM节点，应该和html标签无关吧？如果可以, 希望有具体的案例.\n\n望释疑，谢谢！","like_count":0},{"had_liked":false,"id":190159,"user_name":"韩侠","can_delete":false,"product_type":"c3","uid":1555166,"ip_address":"","ucode":"A4C3D950C29B08","user_header":"https://static001.geekbang.org/account/avatar/00/17/ba/de/14158922.jpg","comment_is_top":false,"comment_ctime":1584608263,"is_pvip":false,"replies":null,"discussion_count":0,"race_medal":0,"score":5,"product_id":100024601,"comment_content":"以前只知道vue的key很必要, 基本都是用的index, 今天才发现index也会导致BUG, 学习了.","like_count":0},{"had_liked":false,"id":185520,"user_name":"洛奇","can_delete":false,"product_type":"c3","uid":1624355,"ip_address":"","ucode":"662B4005721119","user_header":"https://static001.geekbang.org/account/avatar/00/18/c9/23/76511858.jpg","comment_is_top":false,"comment_ctime":1583597817,"is_pvip":false,"replies":null,"discussion_count":1,"race_medal":0,"score":5,"product_id":100024601,"comment_content":"还是没明白什么是虚拟DOM，为什么要比对新旧DOM树，而不是直接将新的DOM树全部替换掉老的？\n场景2和场景3 都是同级节点没有相同类型的节点，为什么没有复用，而都是删除新建？","like_count":0,"discussions":[{"author":{"id":1736720,"avatar":"https://static001.geekbang.org/account/avatar/00/1a/80/10/2406a662.jpg","nickname":"希言自然","note":"","ucode":"8D99A82B05636B","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":231229,"discussion_content":"逐层比较，先理解这个","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1586789451,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":173196,"user_name":"困到清醒","can_delete":false,"product_type":"c3","uid":1384381,"ip_address":"","ucode":"1CD20C408C0BC9","user_header":"https://static001.geekbang.org/account/avatar/00/15/1f/bd/04100cb4.jpg","comment_is_top":false,"comment_ctime":1579452707,"is_pvip":false,"replies":null,"discussion_count":0,"race_medal":0,"score":5,"product_id":100024601,"comment_content":"如果极客时间也有弹幕，会不会有不一样的感jio","like_count":0}]}