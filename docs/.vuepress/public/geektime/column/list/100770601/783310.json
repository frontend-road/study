{"id":783310,"title":"07ï½œå¤§æ¨¡å‹APIå°è£…ï¼šè‡ªå»ºå¤§æ¨¡å‹å¦‚ä½•å¯¹å¤–æœåŠ¡ï¼Ÿ","content":"<p>ä½ å¥½ï¼Œæˆ‘æ˜¯ç‹¬è¡Œã€‚</p><p>ä¸Šä¸€èŠ‚è¯¾æˆ‘ä»¬è¯¦ç»†è®²è§£äº†åŸºäºChatGLM3-6B + LangChain + å‘é‡æ•°æ®åº“çš„ä¼ä¸šå†…éƒ¨çŸ¥è¯†ç³»ç»Ÿï¼Œåœ¨è¿™ä¸ªæ¼”ç¤ºé¡¹ç›®ä¸­ï¼Œå…¶å®å·²ç»ç”¨åˆ°äº†APIçš„å°è£…ï¼Œæˆ‘ä»¬ä»WebUIç•Œé¢æé—®ï¼Œé€šè¿‡æ¥å£å°†æ•°æ®ä¼ åˆ°åç«¯æœåŠ¡ï¼Œä»è€Œè·å¾—å“åº”ã€‚å¤§æ¨¡å‹æ˜¯æ²¡æœ‰Web APIçš„ï¼Œæ‰€ä»¥éœ€è¦æˆ‘ä»¬è¿›è¡Œä¸€æ¬¡å°è£…ï¼Œå°†å¤§æ¨¡å‹çš„æ ¸å¿ƒæ¥å£å°è£…æˆWeb APIæ¥ä¸ºç”¨æˆ·æä¾›æœåŠ¡ï¼Œè¿™æ˜¯ä¼ä¸šè‡ªå»ºå¤§æ¨¡å‹çš„å¿…ç»ä¹‹è·¯ã€‚</p><p>åœ¨è¿™é‡Œæˆ‘ä»¬éœ€è¦å¼•å…¥ä¸€ä¸ªç±»ä¼¼äºSpringBootçš„æ¡†æ¶ï¼Œç”¨æ¥åšæ¥å£æœåŠ¡åŒ–ï¼Œåœ¨PythonæŠ€æœ¯ä½“ç³»é‡Œï¼Œæœ‰ä¸€ä¸ªæ¡†æ¶å« <strong>FastAPI</strong>ï¼Œå¯ä»¥å¾ˆæ–¹ä¾¿åœ°å®ç°æ¥å£æ³¨å†Œï¼Œæ‰€ä»¥æˆ‘ä»¬è¿™èŠ‚è¯¾ä¼šåŸºäºFastAPIå¯¹å¤§æ¨¡å‹çš„æ¥å£è¿›è¡Œå°è£…ã€‚å®é™…ä¸Šå…‰å†™ä¸€ä¸ªDemoä¸ç®—éš¾ï¼Œä½†æ˜¯å¦‚æœè¦å®Œæ•´åœ°ç”¨äºå·¥ç¨‹åŒ–é¡¹ç›®ï¼Œè¿˜æ˜¯æœ‰ä¸å°‘äº‹æƒ…è¦æ³¨æ„ï¼Œæ‰€ä»¥è¿™èŠ‚è¯¾æˆ‘ä¼šæŠŠå„ç§å„æ ·å’ŒAPIç›¸å…³çš„ç»†èŠ‚æ¢³ç†å‡ºæ¥ï¼Œå­¦å®Œè¿™èŠ‚è¯¾çš„å†…å®¹ï¼Œå†ç»“åˆå‰é¢å­¦ä¹ çš„å¤§æ¨¡å‹éƒ¨ç½²ï¼Œä½ æœ¬åœ°æ­å»ºçš„å¤§æ¨¡å‹åŸºæœ¬å¯ä»¥å¯¹å¤–æä¾›æœåŠ¡äº†ã€‚</p><h2>æ¥å£å°è£…</h2><p>æä¾›Web APIæœåŠ¡éœ€è¦ä¸¤ä¸ªæŠ€æœ¯ç»„ä»¶ï¼šUvicornå’ŒFastAPIã€‚</p><p>Uvicornä½œä¸ºWebæœåŠ¡å™¨ï¼Œç±»ä¼¼Tomcatï¼Œä½†æ˜¯æ¯”Tomcatè½»å¾ˆå¤šã€‚å…è®¸å¼‚æ­¥å¤„ç† HTTP è¯·æ±‚ï¼Œæ‰€ä»¥éå¸¸é€‚åˆå¤„ç†å¹¶å‘è¯·æ±‚ã€‚åŸºäºuvloopå’Œhttptoolsï¼Œæ‰€ä»¥å…·å¤‡éå¸¸é«˜çš„æ€§èƒ½ï¼Œé€‚åˆé«˜å¹¶å‘è¯·æ±‚çš„ç°ä»£Webåº”ç”¨ã€‚</p><!-- [[[read_end]]] --><p>FastAPIä½œä¸ºAPIæ¡†æ¶ï¼Œå’ŒSpringBootå·®ä¸å¤šï¼ŒåŒæ ·æ¯”SpringBootè½»å¾ˆå¤šï¼Œåªæ˜¯å½¢å¼ä¸Šç±»ä¼¼äºSpringBootçš„è§’è‰²ã€‚ç»“åˆä½¿ç”¨Uvicornå’ŒFastAPIï¼Œä½ å¯ä»¥æ„å»ºä¸€ä¸ªé«˜æ€§èƒ½ã€æ˜“äºæ‰©å±•çš„å¼‚æ­¥Webåº”ç”¨ç¨‹åºæˆ–APIã€‚Uvicornä½œä¸ºæœåŠ¡å™¨è¿è¡Œä½ çš„FastAPIåº”ç”¨ï¼Œå¯ä»¥æä¾›ä¼˜å¼‚çš„å¹¶å‘å¤„ç†èƒ½åŠ›ï¼Œè€ŒFastAPIåˆ™è®©ä½ çš„åº”ç”¨å¼€å‘å¾—æ›´å¿«ã€æ›´ç®€å•ã€æ›´å®‰å…¨ã€‚</p><p>æ¥ä¸‹æ¥æˆ‘ä»¬ä¸€æ­¥ä¸€æ­¥è®²è§£ã€‚é¦–å…ˆï¼Œå®‰è£…æ‰€éœ€è¦çš„ä¾èµ–åŒ…ã€‚</p><h4>å®‰è£…ä¾èµ–</h4><pre><code class=\"language-plain\">pip install fastapi\npip install uvicorn\n</code></pre><h4>ä»£ç åˆ†å±‚</h4><p>ç®€å•æ¥çœ‹ï¼Œåˆ›å»ºapi.pyï¼Œå†™å…¥ä»¥ä¸‹ä»£ç ï¼Œå°±å¯ä»¥å®šä¹‰ä¸€ä¸ªæ¥å£ã€‚</p><pre><code class=\"language-python\">import uvicorn\nfrom fastapi import FastAPI\n\n# åˆ›å»ºAPIåº”ç”¨\napp = FastAPI()\n\n@app.get(\"/\")\nasync def root():\n  return {\"message\": \"Hello World\"}\n\nif __name__ == '__main__':\n  uvicorn.run(app, host='0.0.0.0', port=6006, log_level=\"info\", workers=1)\n</code></pre><pre><code class=\"language-python\">python api.py\n</code></pre><p><img src=\"https://static001.geekbang.org/resource/image/0e/bb/0e2ee439501432e968dc8fe827747ebb.png?wh=1042x370\" alt=\"å›¾ç‰‡\"></p><p>å®é™…å¼€å‘è¿‡ç¨‹ä¸­ï¼Œæ¥å£è¾“å…¥å¯èƒ½æ˜¯å¤šä¸ªå­—æ®µï¼Œå’ŒJavaæ¥å£ä¸€æ ·ï¼Œéœ€è¦å®šä¹‰ä¸€ä¸ªRequestå®ä½“ç±»æ¥æ‰¿æ¥HTTPè¯·æ±‚å‚æ•°ï¼ŒPythoné‡Œä½¿ç”¨Pydanticæ¨¡å‹æ¥å®šä¹‰æ•°æ®ç»“æ„ï¼ŒPydanticæ˜¯ä¸€ä¸ªæ•°æ®éªŒè¯å’Œè®¾ç½®ç®¡ç†çš„åº“ï¼Œå®ƒåˆ©ç”¨Pythonç±»å‹æç¤ºæ¥è¿›è¡Œæ•°æ®éªŒè¯ã€‚ç±»ä¼¼Javaé‡Œçš„Validationï¼Œä¸‹é¢è¿™æ®µä»£ç ä½ åº”è¯¥å¹¶ä¸é™Œç”Ÿã€‚</p><pre><code class=\"language-java\">import javax.validation.constraints.Min;\nimport javax.validation.constraints.NotNull;\nimport javax.validation.constraints.Size;\n\npublic class Product {\n\n&nbsp; &nbsp; @NotNull\n&nbsp; &nbsp; @Size(min = 2, max = 30)\n&nbsp; &nbsp; private String name;\n\n&nbsp; &nbsp; @NotNull\n&nbsp; &nbsp; @Min(0)\n&nbsp; &nbsp; private Float price;\n\n&nbsp; &nbsp; // æ„é€ å™¨ã€getter å’Œ setter çœç•¥\n}\n</code></pre><p>å¯¹åº”çš„Pythonå®ç°å°±æ˜¯è¿™æ ·çš„ï¼š</p><pre><code class=\"language-python\">from fastapi import FastAPI\nfrom pydantic import BaseModel, Field\nfrom typing import Optional, List\n\napp = FastAPI()\n\nclass Message(BaseModel):\n    role: str\n    content: str\n\nclass ChatMessage(BaseModel):\n    history: List[Message]\n    prompt: str\n    max_tokens: int\n    temperature: float\n    top_p: float = Field(default=1.0)\n\n@app.post(\"/v1/chat/completions\")\nasync def create_chat_response(message: ChatMessage):\n    return {\"message\": \"Hello World\"}\n\nif __name__ == '__main__':\n  uvicorn.run(app, host='0.0.0.0', port=6006, log_level=\"info\", workers=1)\n\n</code></pre><p>è¿™é‡Œå¼•å…¥äº†ä¸€ä¸ªBaseModelç±»ï¼Œç±»ä¼¼äºJavaé‡Œçš„Objectç±»ï¼Œä½†æ˜¯åˆä¸å®Œå…¨æ˜¯Objectï¼ŒObjectæ˜¯æ‰€æœ‰Javaç±»çš„åŸºç±»ï¼ŒJavaä¸­æ‰€æœ‰ç±»ä¼šé»˜è®¤é›†æˆObjectç±»çš„å…¬å…±æ–¹æ³•ï¼Œæ¯”å¦‚toString()ã€equals()ã€hashcode()ç­‰ï¼Œè€ŒBaseModel æ˜¯ä¸ºäº†æ•°æ®éªŒè¯å’Œç®¡ç†è€Œè®¾è®¡çš„ã€‚å½“ä½ åˆ›å»ºä¸€ä¸ªç»§æ‰¿è‡ªBaseModelçš„ç±»æ—¶ï¼Œæ¯”å¦‚ä¸Šé¢çš„ChatSessionå’ŒMessageç±»ï¼Œå°†è‡ªåŠ¨è·å¾—æ•°æ®éªŒè¯ã€åºåˆ—åŒ–å’Œååºåˆ—åŒ–çš„åŠŸèƒ½ã€‚</p><p>å¦å¤–ï¼Œæˆ‘ä»¬å®é™…å¼€å‘è¿‡ç¨‹ä¸­ï¼Œä¹Ÿä¸å¯èƒ½æŠŠæ‰€æœ‰APIçš„å®šä¹‰å’ŒPydanticç±»æ”¾åœ¨æœ€å¤–å±‚ï¼ŒæŒ‰ç…§Javaå·¥ç¨‹åŒ–çš„æœ€ä½³å®è·µï¼ŒWebåº”ç”¨æˆ‘ä»¬ä¸€èˆ¬ä¼šè¿›è¡Œåˆ†å±‚ï¼Œæ¯”å¦‚controllerã€serviceã€modelã€toolç­‰ï¼ŒPythonå·¥ç¨‹åŒ–çš„æ—¶å€™ï¼Œä¸ºäº†æ–¹ä¾¿ç®¡ç†ä»£ç ï¼Œä¹Ÿä¼šè¿›è¡Œåˆ†å±‚ï¼Œä¸€ä¸ªå…¸å‹çš„ä»£ç ç»“æ„å¦‚ä¸‹ï¼š</p><pre><code class=\"language-python\">project_name/\nâ”‚\nâ”œâ”€â”€ app/&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;# ä¸»åº”ç”¨ç›®å½•\nâ”‚&nbsp; &nbsp;â”œâ”€â”€ main.py&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; # FastAPI åº”ç”¨å…¥å£\nâ”‚&nbsp; &nbsp;â””â”€â”€ controller/&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; # API ç‰¹å®šé€»è¾‘\nâ”‚&nbsp; &nbsp; &nbsp;  â””â”€â”€ chat.py\nâ”‚&nbsp;  â””â”€â”€ common/&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;     # é€šç”¨APIç»„ä»¶\nâ”‚&nbsp; &nbsp; &nbsp; &nbsp;â””â”€â”€ errors.py&nbsp; &nbsp; &nbsp; &nbsp;     # é”™è¯¯å¤„ç†å’Œè‡ªå®šä¹‰å¼‚å¸¸\nâ”‚\nâ”œâ”€â”€ services/&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; # æœåŠ¡å±‚ç›®å½•\nâ”‚&nbsp; &nbsp;â”œâ”€â”€ chat_service.py&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; # èŠå¤©æœåŠ¡ç›¸å…³é€»è¾‘\nâ”‚\nâ”œâ”€â”€ schemas/&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;# Pydantic æ¨¡å‹ï¼ˆè¯·æ±‚å’Œå“åº”æ¨¡å¼ï¼‰\nâ”‚&nbsp; &nbsp;â”œâ”€â”€ chat_schema.py&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;# èŠå¤©æ•°æ®æ¨¡å¼\nâ”‚\nâ”œâ”€â”€ database/&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; # æ•°æ®åº“è¿æ¥å’Œä¼šè¯ç®¡ç†\nâ”‚&nbsp; &nbsp;â”œâ”€â”€ session.py&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;# æ•°æ®åº“ä¼šè¯é…ç½®\nâ”‚&nbsp; &nbsp;â””â”€â”€ engine.py&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; # æ•°æ®åº“å¼•æ“é…ç½®\nâ”‚\nâ”œâ”€â”€ tools/&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;# å·¥å…·å’Œå®ç”¨ç¨‹åºç›®å½•\nâ”‚&nbsp; &nbsp;â”œâ”€â”€ data_migration.py&nbsp; &nbsp; &nbsp; &nbsp; # æ•°æ®è¿ç§»å·¥å…·\nâ”‚\nâ”œâ”€â”€ tests/&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;# æµ‹è¯•ç›®å½•\nâ”‚&nbsp; &nbsp;â”œâ”€â”€ conftest.py&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; # æµ‹è¯•é…ç½®å’Œå¤¹å…·\nâ”‚&nbsp; &nbsp;â”œâ”€â”€ test_services/&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;# æœåŠ¡å±‚æµ‹è¯•\nâ”‚&nbsp; &nbsp;â”‚&nbsp; &nbsp;â”œâ”€â”€ test_chat_service.py\nâ”‚&nbsp; &nbsp;â””â”€â”€ test_controller/&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; \nâ”‚&nbsp; &nbsp; &nbsp; &nbsp;â”œâ”€â”€ test_chat_controller.py\nâ”‚\nâ”œâ”€â”€ requirements.txt&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;# é¡¹ç›®ä¾èµ–æ–‡ä»¶\nâ””â”€â”€ setup.py&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;# å®‰è£…ã€æ‰“åŒ…ã€åˆ†å‘é…ç½®æ–‡ä»¶\n\n</code></pre><p>FastAPIçš„include_routeræ–¹æ³•å°±æ˜¯ç”¨æ¥å°†ä¸åŒçš„è·¯ç”±é›†æˆåˆ°ä¸»åº”ç”¨ä¸­çš„ï¼Œæœ‰åŠ©äºç»„ç»‡å’Œåˆ†ç¦»ä»£ç ï¼Œç‰¹åˆ«æ˜¯åœ¨æ„å»ºå¤§å‹å·¥ç¨‹åŒ–åº”ç”¨æ—¶ï¼Œéå¸¸å¥½ç”¨ã€‚ä½ å¯ä»¥çœ‹ä¸€ä¸‹ä¿®æ”¹åçš„ä»£ç ã€‚</p><p>åº”ç”¨å…¥å£main.py</p><pre><code class=\"language-python\">import uvicorn as uvicorn\nfrom fastapi import FastAPI\nfrom controller.chat_controller import chat_router as chat_router\napp = FastAPI()\napp.include_router(chat_router, prefix=\"/chat\", tags=[\"chat\"])\nif __name__ == '__main__':\n    uvicorn.run(app, host='0.0.0.0', port=6006, log_level=\"info\", workers=1)\n\n</code></pre><p>chat_controller.py</p><pre><code class=\"language-python\">from fastapi import APIRouter\nfrom service.chat_service import ChatService\nfrom schema.chat_schema import ChatMessage, MessageDisplay\nchat_router = APIRouter()\nchat_service = ChatService()\n\n@chat_router.post(\"/new/message/\")\ndef post_message(message: ChatMessage):\n    return chat_service.post_message(message)\n\n@chat_router.get(\"/get/messages/\")\ndef get_messages():\n    return chat_service.get_messages()\n\n</code></pre><p>chat_service.py</p><pre><code class=\"language-python\">from schema.chat_schema import ChatMessage\n\nclass ChatService:\n    def post_message(self, message: ChatMessage) :\n        print(message.prompt)\n        return {\"message\": \"post message\"}\n    def get_messages(self):\n        return {\"message\": \"get message\"}\n\n</code></pre><p>å‚æ•°ç±»å®šä¹‰å¦‚ä¸‹ï¼š</p><pre><code class=\"language-python\">from pydantic import BaseModel, Field\n\nclass Message(BaseModel):\n    role: str\n    content: str\n\nclass ChatMessage(BaseModel):\n    prompt: str\n    max_tokens: int\n    temperature: float = Field(default=1.0)\n    top_p: float = Field(default=1.0)\n    \n</code></pre><p>æˆ‘ä»¬å¯ä»¥åœ¨chat_serviceé‡Œè¿›è¡Œè¯¦ç»†åœ°ä¸šåŠ¡é€»è¾‘å¤„ç†ï¼Œåˆ°è¿™é‡ŒåŸºæœ¬å°±å’ŒJavaé‡Œä¸€æ ·äº†ã€‚ä¸‹é¢æ˜¯ä¸€æ®µç®€å•çš„æµ‹è¯•ä»£ç ï¼š</p><pre><code class=\"language-python\">import json\nimport requests\n\nurl = 'http://localhost:6006/chat/new/message/'\ndata = {\n    'prompt': 'hello',\n    'max_tokens': 1000\n}\n\nresponse = requests.post(url, data=json.dumps(data))\nprint(response.text)\n\nurl2 = 'http://localhost:6006/chat/get/messages/'\nresponse = requests.get(url2)\nprint(response.text)\n\n</code></pre><pre><code class=\"language-python\">{\"message\":\"post message\"}\n{\"message\":\"get message\"}\n</code></pre><p>å…³äºFastAPIçš„ä½¿ç”¨ï¼Œä½ å¯ä»¥å‚è€ƒè¿™ä¸ª<a href=\"https://fastapi.tiangolo.com/zh/tutorial/\">æ•™ç¨‹</a>ã€‚å·¥ç¨‹åŒ–ä»£ç ç»“æ„æå®šï¼Œæˆ‘ä»¬å°±å¯ä»¥å°è£…å¤§æ¨¡å‹çš„æ¥å£äº†ã€‚</p><h4>å¤§æ¨¡å‹æ¥å£å°è£…</h4><p>ä¸åŒçš„å¤§æ¨¡å‹å¯¹åº”çš„å¯¹è¯æ¥å£ä¸ä¸€æ ·ï¼Œä¸‹é¢çš„ç¤ºä¾‹ä»£ç åŸºäºChatGLM3-6Bã€‚æˆ‘ä»¬åœ¨serviceå±‚è¿›è¡Œæ¨¡å‹å¯¹è¯çš„å°è£…ã€‚ä½ å¯ä»¥çœ‹ä¸€ä¸‹ç¤ºä¾‹ä»£ç ã€‚</p><pre><code class=\"language-python\">from datetime import datetime\nimport model_manager\nfrom schema.chat_schema import ChatMessage\n\nclass ChatService:\n    def post_message(self, message: ChatMessage):\n        print(message.prompt)\n        model = model_manager.ModelManager.get_model()\n        tokenizer = model_manager.ModelManager.get_tokenizer()\n        response, history = model.chat(\n            tokenizer,\n            message.prompt,\n            history=message.histroy,\n            max_length=message.max_tokens,\n            top_p=message.top_p,\n            temperature=message.temperature\n        )\n        now = datetime.datetime.now()  # è·å–å½“å‰æ—¶é—´\n        time = now.strftime(\"%Y-%m-%d %H:%M:%S\")  # æ ¼å¼åŒ–æ—¶é—´ä¸ºå­—ç¬¦ä¸²\n        answer = {\n            \"response\": response,\n            \"history\": history,\n            \"status\": 200,\n            \"time\": time\n        }\n        log = \"[\" + time + \"] \" + '\", prompt:\"' + message.prompt + '\", response:\"' + repr(response) + '\"'\n        print(log)\n        return answer\n    def get_messages(self):\n        return {\"message\": \"get message\"}\n</code></pre><p>å®šä¹‰ä¸€ä¸ªModelManagerç±»è¿›è¡Œå¤§æ¨¡å‹çš„æ‡’åŠ è½½ã€‚</p><pre><code class=\"language-python\">from transformers import AutoTokenizer, AutoModelForCausalLM\n\nclass ModelManager:\n    _model = None\n    _tokenizer = None\n    \n    @classmethod\n    def get_model(cls):\n        if cls._model is None:\n            _model = AutoModelForCausalLM.from_pretrained(\"chatglm3-6b\", trust_remote_code=True).half().cuda().eval()\n        return _model\n\n        @classmethod\n    def get_tokenizer(cls):\n        if cls._tokenizer is None:\n            _tokenizer = AutoTokenizer.from_pretrained(\"chatglm3-6b\", trust_remote_code=True)\n        return _tokenizer\n</code></pre><p>model.chat()æ˜¯6Bæš´éœ²çš„å¯¹è¯æ¥å£ï¼Œé€šè¿‡å¯¹model.chat()çš„å°è£…å°±å¯ä»¥å®ç°åŸºæœ¬çš„å¯¹è¯æ¥å£äº†ï¼Œè¿™ä¸ªæ¥å£ä¸€æ¬¡æ€§è¾“å‡ºå¤§æ¨¡å‹è¿”å›çš„å†…å®¹ï¼Œè€Œæˆ‘ä»¬åœ¨ä½¿ç”¨å¤§æ¨¡å‹äº§å“çš„æ—¶å€™ï¼Œæ¯”å¦‚ChatGPTæˆ–è€…æ–‡å¿ƒä¸€è¨€ï¼Œä¼šå‘ç°å¤§æ¨¡å‹æ˜¯ä¸€ä¸ªå­—ä¸€ä¸ªå­—è¿”å›çš„ï¼Œé‚£æ˜¯ä»€ä¹ˆåŸå› å‘¢ï¼Ÿé‚£ç§æ¨¡å¼å«<strong>æµå¼è¾“å‡º</strong>ã€‚</p><h2>æµå¼è¾“å‡º</h2><p>æµå¼è¾“å‡ºä½¿ç”¨å¦ä¸€ä¸ªæ¥å£ï¼šmodel.stream_chatï¼Œæœ‰å‡ ç§æ¨¡å¼ï¼Œåƒä¸€ä¸ªå­—ä¸€ä¸ªå­—è¾“å‡ºï¼Œæ¯”å¦‚ï¼š</p><pre><code class=\"language-plain\">æˆ‘\næ˜¯\nä¸­\nå›½\näºº\n</code></pre><p>æˆ–è€…æ¯æ¬¡è¾“å‡ºå½“å‰å·²ç»è¾“å‡ºçš„å…¨éƒ¨ï¼Œæ¯”å¦‚ï¼š</p><pre><code class=\"language-plain\">æˆ‘\næˆ‘æ˜¯\næˆ‘æ˜¯ä¸­\næˆ‘æ˜¯ä¸­å›½\næˆ‘æ˜¯ä¸­å›½äºº\n</code></pre><p>å½“ç„¶ä¹Ÿæœ‰æ¯æ¬¡åå‡º2ä¸ªå­—çš„ï¼Œå®é™…ç”Ÿäº§è¿‡ç¨‹ä¸­å¯ä»¥æ ¹æ®äº§å“äº¤äº’è®¾è®¡è‡ªè¡Œä¿®æ”¹é€»è¾‘ã€‚æˆ‘ä»¬çœ‹ä¸€ä¸ªç®€å•çš„ä»£ç ç‰‡æ®µï¼Œé€šè¿‡streamå˜é‡æ¥æ§åˆ¶æ˜¯å¦æ˜¯æµå¼è¾“å‡ºã€‚</p><pre><code class=\"language-python\">if stream:\n    async for token in callback.aiter():\n        # Use server-sent-events to stream the response\n        yield json.dumps(\n            {\"text\": token, \"message_id\": message_id},\n            ensure_ascii=False)\nelse:\n    answer = \"\"\n    async for token in callback.aiter():\n        answer += token\n    yield json.dumps(\n        {\"text\": answer, \"message_id\": message_id},\n        ensure_ascii=False)\nawait task\n</code></pre><p>æˆ‘ä»¬è¾“å…¥â€œä½ å¥½â€ï¼Œå½“stream=trueæ—¶ï¼Œæ¥å£è¾“å‡ºæ˜¯è¿™æ ·çš„ï¼š</p><pre><code class=\"language-python\">data: {\"text\": \"ä½ \", \"message_id\": \"80b2af55c5b7440eaca6b9d510677a75\"}\ndata: {\"text\": \"å¥½\", \"message_id\": \"80b2af55c5b7440eaca6b9d510677a75\"}\ndata: {\"text\": \"ğŸ‘‹\", \"message_id\": \"80b2af55c5b7440eaca6b9d510677a75\"}\ndata: {\"text\": \"ï¼\", \"message_id\": \"80b2af55c5b7440eaca6b9d510677a75\"}\ndata: {\"text\": \"æˆ‘æ˜¯\", \"message_id\": \"80b2af55c5b7440eaca6b9d510677a75\"}\ndata: {\"text\": \"äººå·¥æ™ºèƒ½\", \"message_id\": \"80b2af55c5b7440eaca6b9d510677a75\"}\ndata: {\"text\": \"åŠ©æ‰‹\", \"message_id\": \"80b2af55c5b7440eaca6b9d510677a75\"}\ndata: {\"text\": \" Chat\", \"message_id\": \"80b2af55c5b7440eaca6b9d510677a75\"}\ndata: {\"text\": \"GL\", \"message_id\": \"80b2af55c5b7440eaca6b9d510677a75\"}\ndata: {\"text\": \"M\", \"message_id\": \"80b2af55c5b7440eaca6b9d510677a75\"}\ndata: {\"text\": \"3\", \"message_id\": \"80b2af55c5b7440eaca6b9d510677a75\"}\ndata: {\"text\": \"-\", \"message_id\": \"80b2af55c5b7440eaca6b9d510677a75\"}\ndata: {\"text\": \"6\", \"message_id\": \"80b2af55c5b7440eaca6b9d510677a75\"}\ndata: {\"text\": \"B\", \"message_id\": \"80b2af55c5b7440eaca6b9d510677a75\"}\ndata: {\"text\": \"ï¼Œ\", \"message_id\": \"80b2af55c5b7440eaca6b9d510677a75\"}\ndata: {\"text\": \"å¾ˆé«˜å…´\", \"message_id\": \"80b2af55c5b7440eaca6b9d510677a75\"}\ndata: {\"text\": \"è§åˆ°\", \"message_id\": \"80b2af55c5b7440eaca6b9d510677a75\"}\ndata: {\"text\": \"ä½ \", \"message_id\": \"80b2af55c5b7440eaca6b9d510677a75\"}\ndata: {\"text\": \"ï¼Œ\", \"message_id\": \"80b2af55c5b7440eaca6b9d510677a75\"}\ndata: {\"text\": \"æ¬¢è¿\", \"message_id\": \"80b2af55c5b7440eaca6b9d510677a75\"}\ndata: {\"text\": \"é—®æˆ‘\", \"message_id\": \"80b2af55c5b7440eaca6b9d510677a75\"}\ndata: {\"text\": \"ä»»ä½•\", \"message_id\": \"80b2af55c5b7440eaca6b9d510677a75\"}\ndata: {\"text\": \"é—®é¢˜\", \"message_id\": \"80b2af55c5b7440eaca6b9d510677a75\"}\ndata: {\"text\": \"ã€‚\", \"message_id\": \"80b2af55c5b7440eaca6b9d510677a75\"}\n</code></pre><p>å½“stream=falseæ—¶ï¼Œæ¥å£è¿”å›å¦‚ä¸‹ï¼š</p><pre><code class=\"language-python\">data: {\"text\": \"ä½ å¥½ï¼æˆ‘æ˜¯äººå·¥æ™ºèƒ½åŠ©æ‰‹ï¼Œå¾ˆé«˜å…´ä¸ºæ‚¨æœåŠ¡ã€‚è¯·é—®æœ‰ä»€ä¹ˆé—®é¢˜æˆ‘å¯ä»¥å¸®æ‚¨è§£ç­”å—ï¼Ÿ\", \"message_id\": \"741a630ac3d64fd5b1832cc0bae6bb68\"}\n</code></pre><p>åˆ°è¿™é‡Œï¼Œå¤§æ¨¡å‹çš„APIåŸºæœ¬å°±å°è£…å¥½äº†ï¼Œæ¥ä¸‹æ¥æˆ‘ä»¬çœ‹ä¸‹å¦‚ä½•è°ƒç”¨ã€‚</p><h2>æ¥å£è°ƒç”¨</h2><p>åœ¨å®é™…å·¥ç¨‹åŒ–è¿‡ç¨‹ä¸­ï¼Œæˆ‘ä»¬ä¸€èˆ¬ä¼šæŠŠAIç›¸å…³çš„é€»è¾‘ï¼ŒåŒ…æ‹¬å¤§æ¨¡å‹APIçš„å°è£…æ”¾åœ¨Pythonåº”ç”¨ä¸­ï¼Œä¸Šå±‚åº”ç”¨ä¸€èˆ¬é€šè¿‡å…¶ä»–è¯­è¨€å®ç°ï¼Œæ¯”å¦‚Javaã€C#ã€Goç­‰ï¼Œè¿™é‡Œæˆ‘ç®€å•ä¸¾ä¸€ä¸ªJavaç‰ˆæœ¬çš„è°ƒç”¨ä¾‹å­ã€‚éæµå¼è¾“å‡ºå°±æ˜¯æ™®é€šçš„HTTPè¯·æ±‚ï¼Œæˆ‘ä»¬å°±ä¸å±•ç¤ºäº†ï¼Œé‡ç‚¹çœ‹ä¸‹æµå¼è¾“å‡ºæ€ä¹ˆè¿›è¡Œè°ƒç”¨ï¼Œä¸»è¦åˆ†ä¸¤æ­¥ï¼Œéƒ½æ˜¯æµå¼çš„ã€‚</p><ol>\n<li><strong>Javaè°ƒç”¨Pythonæ¥å£ï¼š</strong>ä¸»è¦ç”¨åˆ°äº†okhttp3æ¡†æ¶ï¼Œéœ€è¦ç»„è£…å‚æ•°ã€å‘èµ·æµå¼è¯·æ±‚ï¼Œäº‹ä»¶ç›‘å¬å¤„ç†ä¸‰æ­¥ã€‚</li>\n</ol><pre><code class=\"language-java\">\n@ApiOperation(value = \"æµå¼å‘é€å¯¹è¯æ¶ˆæ¯\")\n@PostMapping(value = \"sendMessage\")\npublic void sendMessage(@RequestBody ChatRequest request, HttpServletResponse response) {\n\ttry {\n\t\tJSONObject body = new JSONObject();\n\t\tbody.put(\"model\", request.getModel());\n\t\tbody.put(\"stream\", true);\n\t\tJSONArray messages = new JSONArray();\n\t\tJSONObject query = new JSONObject();\n\t\tquery.put(\"role\", \"user\");\n\t\tquery.put(\"content\", request.getQuery());\n\t\tmessages.add(query);\n\t\tbody.put(\"messages\", messages);\n\t\tEsListener eventSourceListener = new EsListener(request, response);\n\n\n\n\t\tRequestBody formBody = RequestBody.create(body, MediaType.parse(\"application/json\"));\n\t\tRequest.Builder requestBuilder = new Request.Builder();\n\n\t\tRequest request2 = requestBuilder.url(URL).post(formBody).build();\n\t\tEventSource.Factory factory = EventSources.createFactory(OkHttpUtil.getInstance());\n\n\t\tfactory.newEventSource(request2, eventSourceListener);\n\t\teventSourceListener.getCountDownLatch().await();\n\t} catch (Exception e) {\n\t\tlog.error(\"æµå¼è°ƒç”¨å¼‚å¸¸\", e);\n\t}\n}\n</code></pre><p>EsListenerç»§æ‰¿è‡ªEventSourceListenerï¼Œåœ¨Requestè¯·æ±‚çš„è¿‡ç¨‹ä¸­ä¸æ–­è§¦å‘EsListenerçš„onEventæ–¹æ³•ï¼Œç„¶åå°†æ•°æ®å†™å›å‰ç«¯ã€‚</p><pre><code class=\"language-java\">@Override\npublic void onEvent(EventSource eventSource, String id, String type, String data) {\n\ttry {\n\t\toutput.append(data);\n\t\tif (\"finish\".equals(type)) {\n\t\t}\n\t\tif (\"error\".equals(type)) {\n\t\t}\n\n\t\t// å¼€å§‹å¤„ç†dataï¼Œæ­¤å¤„åªå±•ç¤ºåŸºæœ¬æ“ä½œ\n\t\t// å¼€å‘è¿‡ç¨‹ä¸­å…·ä½“é€»è¾‘å¯è‡ªè¡Œæ‰©å±•\n\t\tif (response != null) {\n\t\t\tresponse.getWriter().write(data);\n\t\t\tresponse.getWriter().flush();\n\t\t}\n\t} catch (Exception e) {\n\t\tlog.error(\"äº‹ä»¶å¤„ç†å¼‚å¸¸\", e);\n\t}\n}\n</code></pre><ol start=\"2\">\n<li><strong>å‰ç«¯è°ƒç”¨Javaæ¥å£ï¼š</strong>ä½¿ç”¨JSåŸç”ŸEventSourceçš„APIå°±å¯ä»¥ã€‚</li>\n</ol><pre><code class=\"language-java\">&lt;script&gt;\n&nbsp; &nbsp; let eventData = '';\n&nbsp; &nbsp; const eventSource = new EventSource('http://localhost:8888/sendMessage');\n&nbsp; &nbsp; eventSource.onmessage = function(event) {\n&nbsp; &nbsp; &nbsp; &nbsp; // ç´¯åŠ æ¥æ”¶åˆ°çš„äº‹ä»¶æ•°æ®\n&nbsp; &nbsp; &nbsp; &nbsp; eventData += event.data;\n&nbsp; &nbsp; };\n&lt;/script&gt;\n</code></pre><p>åˆ°è¿™ä¸€æ­¥ï¼Œå¤§æ¨¡å‹APIä»å°è£…åˆ°è°ƒç”¨å°±åŸºæœ¬å®Œæˆäº†ï¼Œä½ å¯ä»¥æŠŠæ•´ä¸ªé“¾è·¯éƒ½ä¸²èµ·æ¥è·‘ä¸€è·‘ï¼Œä½“éªŒä¸‹æ•ˆæœã€‚å®é™…å·¥ç¨‹åŒ–çš„è¿‡ç¨‹ä¸­ï¼Œè¿˜ä¼šé‡åˆ°å…¶ä»–é—®é¢˜ï¼Œæ¯”å¦‚APIçš„é‰´æƒï¼ˆæŒ‡Java-&gt;Pythonï¼‰ã€è·¨åŸŸé—®é¢˜ã€APIé™æµé—®é¢˜ï¼ˆå¤§æ¨¡å‹çš„ååé‡æœ‰é™ï¼‰ï¼Œæˆ‘ä»¬ä¼šåœ¨åé¢çš„è¯¾ç¨‹ä¸­è®²è§£ã€‚</p><h2>å°ç»“</h2><p>æˆ‘ä»¬è¿™èŠ‚è¯¾å­¦çš„å†…å®¹æ˜¯è‡ªå»ºå¤§æ¨¡å‹æœåŠ¡ä¸å¯ç¼ºå°‘çš„ä¸€æ­¥ï¼Œæ•´ä½“æ¥è¯´ä¸ç®—éš¾ï¼Œå”¯ä¸€å¯èƒ½éš¾ä¸€ç‚¹çš„å°±æ˜¯è¦ä½¿ç”¨Pythonè¯­è¨€ï¼Œå› ä¸ºåœ¨ä½¿ç”¨FastAPIçš„è¿‡ç¨‹ä¸­ï¼Œä¼šæœ‰å¤§é‡çš„å¼‚æ­¥æ“ä½œï¼Œå’ŒJavaçš„å¤„ç†æ–¹å¼æœ‰ç‚¹å·®å¼‚ï¼Œéœ€è¦æ³¨æ„ä¸‹ã€‚</p><p>è¿™èŠ‚è¯¾å­¦å®Œï¼Œæˆ‘ä»¬åŸºæœ¬ä¸ŠæŠŠä¼ä¸šå†…éƒ¨æ„å»ºå¤§æ¨¡å‹çš„è¿‡ç¨‹å…¨éƒ¨è®²å®Œäº†ï¼Œä½ è‡ªå·±æ„å»ºçš„å¤§æ¨¡å‹åŸºæœ¬å¯ä»¥å¯¹å¤–æä¾›æœåŠ¡äº†ã€‚å¦‚æœåœ¨ç”Ÿäº§ç¯å¢ƒä½¿ç”¨ï¼Œä¸€å®šè¦æ³¨æ„åšå¥½é™çº§å‡†å¤‡ï¼Œå› ä¸ºæœ‰å¾ˆå¤šä¸ç¡®å®šæ€§ï¼Œæ¯”å¦‚æ¨¡å‹çš„ååé‡ï¼ˆTPSï¼‰è¯„ä¼°æ˜¯å¦å‡†ç¡®ï¼Œæ¨¡å‹ä¼šä¸ä¼šå‡ºç°æ„æƒ³ä¸åˆ°çš„è¾“å‡ºç­‰ç­‰ï¼Œä¸€æ—¦å‡ºç°é—®é¢˜éšæ—¶é™çº§ã€‚</p><h2>æ€è€ƒé¢˜</h2><p>å‰é¢æˆ‘ä»¬æåˆ°ï¼Œå¤§æ¨¡å‹ç›¸å…³çš„APIå°è£…åœ¨Pythonåº”ç”¨ä¸­ï¼Œå¯¹ç”¨æˆ·æä¾›æœåŠ¡çš„æ—¶å€™ï¼Œä¼šå†å¥—ä¸€å±‚Javaåº”ç”¨ï¼Œä½ å¯ä»¥æƒ³ä¸€ä¸‹ä¸ºä»€ä¹ˆè¦è¿™ä¹ˆè®¾è®¡ï¼Œæ¬¢è¿ä½ æŠŠä½ çš„æƒ³æ³•åˆ†äº«åˆ°è¯„è®ºåŒºï¼Œæˆ‘ä»¬ä¸€èµ·è®¨è®ºï¼Œå¦‚æœä½ è§‰å¾—è¿™èŠ‚è¯¾çš„å†…å®¹å¯¹ä½ æœ‰å¸®åŠ©çš„è¯ï¼Œä¹Ÿæ¬¢è¿ä½ åˆ†äº«ç»™å…¶ä»–æœ‹å‹ï¼Œæˆ‘ä»¬ä¸‹èŠ‚è¯¾å†è§ï¼</p>","neighbors":{"left":{"article_title":"06ï½œRAGå®æˆ˜ï¼šåŸºäºChatGLM3-6B+LangChain+Faissæ­å»ºä¼ä¸šå†…éƒ¨çŸ¥è¯†åº“","id":782736},"right":{"article_title":"08ï½œå…³äºæœºå™¨å­¦ä¹ ï¼Œä½ éœ€è¦äº†è§£çš„åŸºæœ¬æ¦‚å¿µï¼ˆä¸€ï¼‰","id":783348}},"comments":[{"had_liked":false,"id":391579,"user_name":"å¼ ç”³å‚²","can_delete":false,"product_type":"c1","uid":1182372,"ip_address":"åŒ—äº¬","ucode":"22D46BC529BA8A","user_header":"https://static001.geekbang.org/account/avatar/00/12/0a/a4/828a431f.jpg","comment_is_top":false,"comment_ctime":1718594070,"is_pvip":false,"replies":[{"id":142390,"content":"æ²¡é”™ğŸ‘","user_name":"ä½œè€…å›å¤","user_name_real":"ç¼–è¾‘","uid":2083554,"ctime":1718609550,"ip_address":"æµ™æ±Ÿ","comment_id":391579,"utype":1}],"discussion_count":3,"race_medal":2,"score":2,"product_id":100770601,"comment_content":"ç¬¬7è®²æ‰“å¡~\næ€è€ƒé¢˜ï¼šè¿™é‡Œåº”è¯¥ä¸»è¦è€ƒè™‘çš„æ˜¯ä¸åŒè¯­è¨€çš„ä¼˜åŠ¿å’Œé€‚ç”¨åœºæ™¯ã€‚ä½¿ç”¨Pythonå®ç°å¤§æ¨¡å‹çš„æ ¸å¿ƒAPIï¼Œåº”è¯¥æ˜¯å› ä¸ºPythonæ˜¯æœºå™¨å­¦ä¹ é¢†åŸŸæœ€ä¸»æµçš„è¯­è¨€ï¼ŒåŒ…æ‹¬äº†åƒpytorchã€TensorFlowç­‰ä¸»æµçš„æ¡†æ¶ï¼Œè€Œä¸”ä¸€äº›ä¸»æµçš„å¤§æ¨¡å‹åƒChatGPTä¹Ÿæä¾›äº†å®Œå–„çš„Python SDKï¼Œä½¿ç”¨èµ·æ¥æ¯”è¾ƒæ–¹ä¾¿ã€‚è€Œåœ¨å¤–é¢åˆå¥—äº†ä¸€å±‚Javaåº”ç”¨ï¼Œåº”è¯¥æ˜¯è€ƒè™‘è¿™ä¹ˆå¤šå¹´æ¥Javaåœ¨WebæœåŠ¡ç«¯é¢†åŸŸç§¯ç´¯ä¸‹æ¥çš„å®Œå–„çš„ç”Ÿæ€ï¼Œé’ˆå¯¹ç”¨æˆ·ç«¯çš„åº”ç”¨ï¼Œå¯ä»¥å¿«é€Ÿæ„å»ºèµ·æœåŠ¡é‰´æƒã€è·¯ç”±ã€ç†”æ–­ã€é™çº§ã€é™æµã€å¯è§‚æµ‹ç­‰ç­‰èƒ½åŠ›ã€‚","like_count":11,"discussions":[{"author":{"id":2083554,"avatar":"http://thirdwx.qlogo.cn/mmopen/vi_32/DYAIOgq83erZP8e2vqiaACFaDxruOzUTPbPv2uRUTp9UuEg98Ib9aYddjZK2kastqf0B14Ec7uXx7CCSXr0fhAA/132","nickname":"Geek_cf2545","note":"","ucode":"B69DF1E734FBA2","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":646722,"discussion_content":"æ²¡é”™ğŸ‘","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1718609550,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"æµ™æ±Ÿ","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2,\"source\":0}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1181055,"avatar":"https://static001.geekbang.org/account/avatar/00/12/05/7f/a7df049a.jpg","nickname":"Standly","note":"","ucode":"805CC5784D3F76","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":647350,"discussion_content":"ä½†æ˜¯å¤§æ¨¡å‹ä¸æ˜¯ä¹Ÿæœ‰httpæ¥å£ä¹ˆï¼Œç›´æ¥ç”¨Javaå°è£…ä¸€ä¸‹ä¸ä¹Ÿè¡Œä¹ˆ","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1719909481,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":"æ±Ÿè‹","group_id":0},"score":2,"extra":"","child_discussion_number":1,"child_discussions":[{"author":{"id":1182372,"avatar":"https://static001.geekbang.org/account/avatar/00/12/0a/a4/828a431f.jpg","nickname":"å¼ ç”³å‚²","note":"","ucode":"22D46BC529BA8A","race_medal":2,"user_type":1,"is_pvip":false},"reply_author":{"id":1181055,"avatar":"https://static001.geekbang.org/account/avatar/00/12/05/7f/a7df049a.jpg","nickname":"Standly","note":"","ucode":"805CC5784D3F76","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":647355,"discussion_content":"ç†è®ºä¸Šæ˜¯çš„ï¼Œä½†æ˜¯LLMåº”ç”¨çš„å¾ˆå¤šæ‰©å±•åŠŸèƒ½ï¼Œä¾‹å¦‚å¤šæ¨¡å‹åˆ‡æ¢ã€æµå¼è¾“å‡ºã€è®°å¿†ã€RAGç­‰ç­‰è¿™äº›ï¼Œç›´æ¥ç”¨Javaå°è£…çš„è¯å·¥ä½œé‡ä¼šå¾ˆå¤§ï¼Œè€Œç”¨LangChainè¿™ç§æ¡†æ¶å¼€å‘å°±ä¼šç®€åŒ–å¾ˆå¤š","likes_number":3,"is_delete":false,"is_hidden":false,"ctime":1719915393,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":647350,"ip_address":"åŒ—äº¬","group_id":0},"score":647355,"extra":""}]}]},{"had_liked":false,"id":391575,"user_name":"Lee","can_delete":false,"product_type":"c1","uid":1060230,"ip_address":"ç¦å»º","ucode":"357C3D2F33B325","user_header":"https://static001.geekbang.org/account/avatar/00/10/2d/86/07a10be2.jpg","comment_is_top":false,"comment_ctime":1718587301,"is_pvip":false,"replies":[{"id":142386,"content":"é©¬ä¸Šå•¦","user_name":"ä½œè€…å›å¤","user_name_real":"ç¼–è¾‘","uid":2083554,"ctime":1718595462,"ip_address":"æµ™æ±Ÿ","comment_id":391575,"utype":1}],"discussion_count":1,"race_medal":0,"score":2,"product_id":100770601,"comment_content":"è€å¸ˆ æˆ‘ç­‰ä¸åŠäº†  ä¸Šç˜¾äº†  å‚¬æ›´å‚¬æ›´","like_count":3,"discussions":[{"author":{"id":2083554,"avatar":"http://thirdwx.qlogo.cn/mmopen/vi_32/DYAIOgq83erZP8e2vqiaACFaDxruOzUTPbPv2uRUTp9UuEg98Ib9aYddjZK2kastqf0B14Ec7uXx7CCSXr0fhAA/132","nickname":"Geek_cf2545","note":"","ucode":"B69DF1E734FBA2","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":646714,"discussion_content":"é©¬ä¸Šå•¦","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1718595462,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"æµ™æ±Ÿ","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2,\"source\":0}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":396111,"user_name":"ç‹’ç‹’","can_delete":false,"product_type":"c1","uid":1242295,"ip_address":"å¹¿ä¸œ","ucode":"10A320ECEBF074","user_header":"https://static001.geekbang.org/account/avatar/00/12/f4/b7/5c775af5.jpg","comment_is_top":false,"comment_ctime":1733146874,"is_pvip":false,"replies":[{"id":143833,"content":"ç¨å¾®è°ƒä¸€ä¸‹ï¼Œæ­£å¥½ç»ƒä¸€ä¸‹pythonåŠŸåº•ï¼Œå¦åˆ™åé¢ä¹Ÿæ²¡æ³•æ·±å…¥ï¼Œæaiä¸»è¦æ˜¯pythonå‘€","user_name":"ä½œè€…å›å¤","user_name_real":"ç¼–è¾‘","uid":2083554,"ctime":1733536926,"ip_address":"æµ™æ±Ÿ","comment_id":396111,"utype":1}],"discussion_count":1,"race_medal":0,"score":2,"product_id":100770601,"comment_content":"pythonåŸºç¡€ä¸æ˜¯å¤ªå¥½ï¼Œæœ‰å¯ç”¨çš„å®Œæ•´ä»£ç å—ï¼Œæ–‡ä¸­çš„ä»£ç ä¼¼ä¹ä¸èƒ½ç›´æ¥ä½¿ç”¨ï¼Œæ¯”å¦‚ç»“æ„ç‰ˆæœ¬ä¸å®é™…æ¡ˆä¾‹ä¸ä¸€è‡´ï¼Œåœ¨controllerä¸­å¼•å…¥serveiceæ—¶æ— æ³•ç›´æ¥å¼•å…¥","like_count":0,"discussions":[{"author":{"id":2083554,"avatar":"http://thirdwx.qlogo.cn/mmopen/vi_32/DYAIOgq83erZP8e2vqiaACFaDxruOzUTPbPv2uRUTp9UuEg98Ib9aYddjZK2kastqf0B14Ec7uXx7CCSXr0fhAA/132","nickname":"Geek_cf2545","note":"","ucode":"B69DF1E734FBA2","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":654815,"discussion_content":"ç¨å¾®è°ƒä¸€ä¸‹ï¼Œæ­£å¥½ç»ƒä¸€ä¸‹pythonåŠŸåº•ï¼Œå¦åˆ™åé¢ä¹Ÿæ²¡æ³•æ·±å…¥ï¼Œæaiä¸»è¦æ˜¯pythonå‘€","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1733536926,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"æµ™æ±Ÿ","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2,\"source\":0}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":395435,"user_name":"ç¥ç»è›™","can_delete":false,"product_type":"c1","uid":3963624,"ip_address":"ä¸Šæµ·","ucode":"A2D470E345195D","user_header":"https://static001.geekbang.org/account/avatar/00/3c/7a/e8/c86468e8.jpg","comment_is_top":false,"comment_ctime":1730793960,"is_pvip":false,"replies":[{"id":143646,"content":"é¦–å…ˆï¼Œæ¨¡å‹è¦å……åˆ†æµ‹è¯•ï¼›å…¶æ¬¡ï¼Œè¦æœ‰ä¸€äº›å‰ç½®ã€åç½®çš„å†…å®¹æ£€æµ‹æœºåˆ¶ï¼Œæœ‰é—®é¢˜ç›´æ¥å±è”½ï¼›æœºå™¨è´Ÿè½½è¾¾ä¸Šé™å°±é™æµï¼Œå¤§å®¶éƒ½æ˜¯è¿™ä¹ˆåšçš„ï¼ŒåŒ…æ‹¬ChatGPT","user_name":"ä½œè€…å›å¤","user_name_real":"ç¼–è¾‘","uid":2083554,"ctime":1731470401,"ip_address":"æµ™æ±Ÿ","comment_id":395435,"utype":1}],"discussion_count":1,"race_medal":0,"score":2,"product_id":100770601,"comment_content":"å¤§æ¨¡å‹çš„è¾“å‡ºé™çº§æ–¹æ¡ˆæœ‰å“ªäº›è€ƒè™‘æ–¹æ¡ˆï¼Ÿæ¯”å¦‚å¦‚æœè¢«å¼•å¯¼è¾“å‡ºä¸å½“è¨€è®ºï¼Œå¦‚ä½•å¿«é€Ÿå°æ‰è¿™ä¸ªæ¼æ´ï¼Ÿæœºå™¨è´Ÿè½½è¾¾åˆ°ä¸Šé™ååˆè¯¥å¦‚ä½•å¤„ç†ï¼Ÿ","like_count":0,"discussions":[{"author":{"id":2083554,"avatar":"http://thirdwx.qlogo.cn/mmopen/vi_32/DYAIOgq83erZP8e2vqiaACFaDxruOzUTPbPv2uRUTp9UuEg98Ib9aYddjZK2kastqf0B14Ec7uXx7CCSXr0fhAA/132","nickname":"Geek_cf2545","note":"","ucode":"B69DF1E734FBA2","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":653811,"discussion_content":"é¦–å…ˆï¼Œæ¨¡å‹è¦å……åˆ†æµ‹è¯•ï¼›å…¶æ¬¡ï¼Œè¦æœ‰ä¸€äº›å‰ç½®ã€åç½®çš„å†…å®¹æ£€æµ‹æœºåˆ¶ï¼Œæœ‰é—®é¢˜ç›´æ¥å±è”½ï¼›æœºå™¨è´Ÿè½½è¾¾ä¸Šé™å°±é™æµï¼Œå¤§å®¶éƒ½æ˜¯è¿™ä¹ˆåšçš„ï¼ŒåŒ…æ‹¬ChatGPT","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1731470401,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"æµ™æ±Ÿ","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2,\"source\":0}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":393394,"user_name":"cricket1981","can_delete":false,"product_type":"c1","uid":1001715,"ip_address":"ä¸Šæµ·","ucode":"758262F5958DA4","user_header":"https://static001.geekbang.org/account/avatar/00/0f/48/f3/65c7e3ef.jpg","comment_is_top":false,"comment_ctime":1723684849,"is_pvip":false,"replies":[{"id":142936,"content":"ç¿»å¢™æˆ–è€…ä½¿ç”¨æ›¿ä»£äº§å“é­”æ­","user_name":"ä½œè€…å›å¤","user_name_real":"ç¼–è¾‘","uid":2083554,"ctime":1724424722,"ip_address":"æµ™æ±Ÿ","comment_id":393394,"utype":1}],"discussion_count":1,"race_medal":0,"score":2,"product_id":100770601,"comment_content":"è¯·é—®å›½å†…å¦‚ä½•ä½¿ç”¨huggingface? å¾ˆå¤šå›½å¤–å¤§æ¨¡å‹ç½‘ç«™è¢«å¢™äº†ï¼Œæœ‰ä»€ä¹ˆæ›¿ä»£æ–¹æ¡ˆæˆ–work aroundæ–¹æ³•å—ï¼Ÿ","like_count":0,"discussions":[{"author":{"id":2083554,"avatar":"http://thirdwx.qlogo.cn/mmopen/vi_32/DYAIOgq83erZP8e2vqiaACFaDxruOzUTPbPv2uRUTp9UuEg98Ib9aYddjZK2kastqf0B14Ec7uXx7CCSXr0fhAA/132","nickname":"Geek_cf2545","note":"","ucode":"B69DF1E734FBA2","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":650138,"discussion_content":"ç¿»å¢™æˆ–è€…ä½¿ç”¨æ›¿ä»£äº§å“é­”æ­","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1724424723,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"æµ™æ±Ÿ","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2,\"source\":0}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":392421,"user_name":"å¤§å®½","can_delete":false,"product_type":"c1","uid":1071011,"ip_address":"åŒ—äº¬","ucode":"12970A21E939EA","user_header":"https://static001.geekbang.org/account/avatar/00/10/57/a3/4bcf1b59.jpg","comment_is_top":false,"comment_ctime":1720875350,"is_pvip":false,"replies":[{"id":142654,"content":"ç¤ºä¾‹ç”¨çš„æ˜¯pytorchï¼Œå…¶ä»–æ¡†æ¶ä½ å¯ä»¥è‡ªå·±è¯•ä¸€è¯•","user_name":"ä½œè€…å›å¤","user_name_real":"ç¼–è¾‘","uid":2083554,"ctime":1721109997,"ip_address":"æµ™æ±Ÿ","comment_id":392421,"utype":1}],"discussion_count":1,"race_medal":0,"score":2,"product_id":100770601,"comment_content":"è€å¸ˆ ï¼Œç¤ºä¾‹ç¤ºä¾‹ä¸­çš„å¤§æ¨¡å‹æ¨ç†æ¡†æ¶ç”¨çš„æ˜¯å“ªä¸ªå‘¢ï¼Œå¯å¦å¼•å…¥ VLLM","like_count":0,"discussions":[{"author":{"id":2083554,"avatar":"http://thirdwx.qlogo.cn/mmopen/vi_32/DYAIOgq83erZP8e2vqiaACFaDxruOzUTPbPv2uRUTp9UuEg98Ib9aYddjZK2kastqf0B14Ec7uXx7CCSXr0fhAA/132","nickname":"Geek_cf2545","note":"","ucode":"B69DF1E734FBA2","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":648121,"discussion_content":"ç¤ºä¾‹ç”¨çš„æ˜¯pytorchï¼Œå…¶ä»–æ¡†æ¶ä½ å¯ä»¥è‡ªå·±è¯•ä¸€è¯•","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1721109997,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"æµ™æ±Ÿ","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2,\"source\":0}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":392307,"user_name":"Geek_frank","can_delete":false,"product_type":"c1","uid":1685433,"ip_address":"ä¸Šæµ·","ucode":"534D46C2D1EFF5","user_header":"https://thirdwx.qlogo.cn/mmopen/vi_32/DYAIOgq83erG6I79WlHDjs51JOff9GBibD4Fh2PhITQMvmh2aTUVzH2BKia1tFLLoQr7VFeZddywwRoZlVUyhDDQ/132","comment_is_top":false,"comment_ctime":1720572665,"is_pvip":false,"replies":[{"id":142592,"content":"æ²¡é”™","user_name":"ä½œè€…å›å¤","user_name_real":"ç¼–è¾‘","uid":2083554,"ctime":1720604376,"ip_address":"æµ™æ±Ÿ","comment_id":392307,"utype":1}],"discussion_count":1,"race_medal":0,"score":2,"product_id":100770601,"comment_content":"æ‰“å¡ç¬¬å…­è¯¾ï¼špythonå°è£…å¤§æ¨¡å‹å€Ÿå£æä¾›AIæœåŠ¡æœ‰å¤©ç„¶çš„ä¼˜åŠ¿ï¼ŒåŸºæœ¬ä¸Šå¤§æ¨¡å‹éƒ½æ˜¯ç”¨pythonå¼€å‘çš„ï¼Œå¼€æºçš„ä¹Ÿéƒ½æœ‰pythonçš„libã€‚ä½¿ç”¨pythonè¿›è¡ŒAPIå°è£…æˆ–è€…æ¨¡å‹å¾®è°ƒéƒ½ç‰¹åˆ«æ–¹ä¾¿ã€‚ åœ¨AIæœåŠ¡ä¹‹ä¸Šçš„ä¸€äº›æ”¿å¢å€¼æœåŠ¡å¯èƒ½javaæ¥æä¾›æ›´å¥½ä¸€äº›ï¼Œå› ä¸ºjavaé€‚åˆä¸šåŠ¡çš„å°è£…ã€‚ä½†ä¹Ÿä¸æ˜¯éjavaä¸å¯ï¼Œpythonä¹Ÿå¯ä»¥å®ç°ä¸åšçš„ä¸šåŠ¡æœåŠ¡ã€‚æˆ‘ç°åœ¨åšçš„ä¸€ä¸ªè¿ç»´ä¸€ä½“åŒ–å¹³å°å¾ˆå¤šä¸šåŠ¡å®ç°éƒ½æ˜¯pythonæ¥åšçš„ã€‚æ¯”å¦‚è®¤è¯é‰´æƒï¼Œé…ç½®ä»“åº“ï¼Œåœ¨çº¿ä½œä¸šç®¡ç†ç­‰ç­‰","like_count":0,"discussions":[{"author":{"id":2083554,"avatar":"http://thirdwx.qlogo.cn/mmopen/vi_32/DYAIOgq83erZP8e2vqiaACFaDxruOzUTPbPv2uRUTp9UuEg98Ib9aYddjZK2kastqf0B14Ec7uXx7CCSXr0fhAA/132","nickname":"Geek_cf2545","note":"","ucode":"B69DF1E734FBA2","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":647782,"discussion_content":"æ²¡é”™","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1720604376,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"æµ™æ±Ÿ","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2,\"source\":0}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":391774,"user_name":"season","can_delete":false,"product_type":"c1","uid":2894734,"ip_address":"æ–°åŠ å¡","ucode":"1CBBFCC58A245E","user_header":"https://static001.geekbang.org/account/avatar/00/2c/2b/8e/4d24c872.jpg","comment_is_top":false,"comment_ctime":1719054337,"is_pvip":false,"replies":[{"id":142452,"content":"æ²¡æœ‰æ”¾åœ¨ä»“åº“ä¸Š","user_name":"ä½œè€…å›å¤","user_name_real":"ç¼–è¾‘","uid":2083554,"ctime":1719195524,"ip_address":"æµ™æ±Ÿ","comment_id":391774,"utype":1}],"discussion_count":3,"race_medal":0,"score":2,"product_id":100770601,"comment_content":"è¯¾ç¨‹é‡Œé¢çš„ä»£ç ï¼Œæœ‰ä»£ç ä»“åº“å—ï¼Ÿ","like_count":0,"discussions":[{"author":{"id":2083554,"avatar":"http://thirdwx.qlogo.cn/mmopen/vi_32/DYAIOgq83erZP8e2vqiaACFaDxruOzUTPbPv2uRUTp9UuEg98Ib9aYddjZK2kastqf0B14Ec7uXx7CCSXr0fhAA/132","nickname":"Geek_cf2545","note":"","ucode":"B69DF1E734FBA2","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":646971,"discussion_content":"æ²¡æœ‰æ”¾åœ¨ä»“åº“ä¸Š","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1719195525,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"æµ™æ±Ÿ","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2,\"source\":0}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":3199773,"avatar":"https://thirdwx.qlogo.cn/mmopen/vi_32/EC0Xp12qA9thF8IIeVu6lJFttDxrocOe40HYSSFjzLJnEacGlBs0kTanvPfchOj3t2RR29gBnBWjGAvMH3JH7w/132","nickname":"Geek_f7b82c","note":"","ucode":"FF2C8610B7BDDB","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":653267,"discussion_content":"å¦‚ä½•è·å–ç¤ºä¾‹ä»£ç ","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1730536607,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":"é™•è¥¿","group_id":0},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1253161,"avatar":"https://static001.geekbang.org/account/avatar/00/13/1f/29/8c55ccaf.jpg","nickname":"æœ±å‡Œå³°","note":"","ucode":"96C33BE610B060","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":647704,"discussion_content":"æœ‰è®¡åˆ’æ”¾åˆ°gitä»“åº“å—","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1720484259,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":"æµ™æ±Ÿ","group_id":0},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":391676,"user_name":"é£è½»æ‰¬","can_delete":false,"product_type":"c1","uid":1542987,"ip_address":"åŒ—äº¬","ucode":"DB972F2DF059C4","user_header":"https://static001.geekbang.org/account/avatar/00/17/8b/4b/15ab499a.jpg","comment_is_top":false,"comment_ctime":1718798555,"is_pvip":false,"replies":[{"id":142424,"content":"ç‚¹èµï¼Œæ„Ÿè°¢ï¼","user_name":"ä½œè€…å›å¤","user_name_real":"ç¼–è¾‘","uid":2083554,"ctime":1718856730,"ip_address":"æµ™æ±Ÿ","comment_id":391676,"utype":1}],"discussion_count":1,"race_medal":0,"score":2,"product_id":100770601,"comment_content":"å¦‚æœå¤§å®¶åœ¨è·‘demoçš„æ—¶å€™é‡åˆ°è¿™ä¸ªé”™è¯¯ã€‚TypeError: ChatGLMForConditionalGeneration.chat() missing 1 required positional argument: &#39;query&#39;ï¼Œå¯ä»¥å°è¯•å°†chat_service.pyæ–‡ä»¶ä¸­ï¼Œmodel.chatæ–¹æ³•çš„ç¬¬äºŒä¸ªå…¥å‚å»æ‰&quot;prompt=&quot;ï¼Œåªä¿ç•™message.promptå³å¯","like_count":0,"discussions":[{"author":{"id":2083554,"avatar":"http://thirdwx.qlogo.cn/mmopen/vi_32/DYAIOgq83erZP8e2vqiaACFaDxruOzUTPbPv2uRUTp9UuEg98Ib9aYddjZK2kastqf0B14Ec7uXx7CCSXr0fhAA/132","nickname":"Geek_cf2545","note":"","ucode":"B69DF1E734FBA2","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":646847,"discussion_content":"ç‚¹èµï¼Œæ„Ÿè°¢ï¼","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1718856730,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"æµ™æ±Ÿ","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2,\"source\":0}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":391669,"user_name":"0.0","can_delete":false,"product_type":"c1","uid":2246077,"ip_address":"å¹¿ä¸œ","ucode":"9080F7DD748B29","user_header":"https://static001.geekbang.org/account/avatar/00/22/45/bd/df16cf9d.jpg","comment_is_top":false,"comment_ctime":1718781005,"is_pvip":false,"replies":[{"id":142416,"content":"åªèƒ½è¯´difyç•Œé¢æ›´åŠ å‹å¥½ï¼Œå„æœ‰ä¼˜åŠ¿ï¼Œå›½å†…ä½¿ç”¨ï¼Œä¼˜å…ˆæ¨èdify","user_name":"ä½œè€…å›å¤","user_name_real":"ç¼–è¾‘","uid":2083554,"ctime":1718796115,"ip_address":"æµ™æ±Ÿ","comment_id":391669,"utype":1}],"discussion_count":2,"race_medal":0,"score":2,"product_id":100770601,"comment_content":"dify æ˜¯å¦æ›´ä¼˜é›…","like_count":0,"discussions":[{"author":{"id":2083554,"avatar":"http://thirdwx.qlogo.cn/mmopen/vi_32/DYAIOgq83erZP8e2vqiaACFaDxruOzUTPbPv2uRUTp9UuEg98Ib9aYddjZK2kastqf0B14Ec7uXx7CCSXr0fhAA/132","nickname":"Geek_cf2545","note":"","ucode":"B69DF1E734FBA2","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":646822,"discussion_content":"åªèƒ½è¯´difyç•Œé¢æ›´åŠ å‹å¥½ï¼Œå„æœ‰ä¼˜åŠ¿ï¼Œå›½å†…ä½¿ç”¨ï¼Œä¼˜å…ˆæ¨èdify","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1718796115,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"æµ™æ±Ÿ","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2,\"source\":0}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":2944137,"avatar":"","nickname":"Geek_162656","note":"","ucode":"71AC5B3AA640D8","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":651031,"discussion_content":"dify æ˜¯å•¥ï¼Ÿ","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1726098976,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":"æ±Ÿè‹","group_id":0},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":391666,"user_name":"é£è½»æ‰¬","can_delete":false,"product_type":"c1","uid":1542987,"ip_address":"åŒ—äº¬","ucode":"DB972F2DF059C4","user_header":"https://static001.geekbang.org/account/avatar/00/17/8b/4b/15ab499a.jpg","comment_is_top":false,"comment_ctime":1718778063,"is_pvip":false,"replies":[{"id":142417,"content":"å‚è€ƒå¾®ä¿¡ç¾¤çš„è§£ç­”ï¼Œè°ƒæ•´ä¸‹model.chat()çš„å…¥å‚ï¼Œæˆ‘æ€€ç–‘å®˜æ–¹å…¥å‚æ›´æ–°äº†","user_name":"ä½œè€…å›å¤","user_name_real":"ç¼–è¾‘","uid":2083554,"ctime":1718796223,"ip_address":"æµ™æ±Ÿ","comment_id":391666,"utype":1}],"discussion_count":1,"race_medal":0,"score":3,"product_id":100770601,"comment_content":"è€å¸ˆï¼ŒModelManagerç±»ä¸­ï¼Œä¸¤ä¸ªfrom_pretrainedæ–¹æ³•çš„ç¬¬ä¸€ä¸ªå…¥å‚éƒ½æ˜¯æ¨¡å‹çš„è·¯å¾„å§ï¼Ÿæˆ‘æŒ‰ç…§æ–‡ä¸­çš„ä»£ç å®ç°äº†ä¸€ä¸‹ï¼Œåœ¨ä¸€å¼ 3090 gpuä¸Šè·‘ï¼Œpythonç‰ˆæœ¬3.11ï¼Œä¸€ç›´æŠ¥ï¼šTypeError: ChatGLMForConditionalGeneration.chat() missing 1 required positional argument: &#39;query&#39;ï¼ŒæŸ¥äº†æŸ¥ChatGLMForConditionalGenerationï¼Œå¹¶æ²¡æœ‰chatæ–¹æ³•ï¼Œä¸çŸ¥é“å’‹æ’æŸ¥äº†ã€‚ã€‚ã€‚ã€‚","like_count":0,"discussions":[{"author":{"id":2083554,"avatar":"http://thirdwx.qlogo.cn/mmopen/vi_32/DYAIOgq83erZP8e2vqiaACFaDxruOzUTPbPv2uRUTp9UuEg98Ib9aYddjZK2kastqf0B14Ec7uXx7CCSXr0fhAA/132","nickname":"Geek_cf2545","note":"","ucode":"B69DF1E734FBA2","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":646824,"discussion_content":"å‚è€ƒå¾®ä¿¡ç¾¤çš„è§£ç­”ï¼Œè°ƒæ•´ä¸‹model.chat()çš„å…¥å‚ï¼Œæˆ‘æ€€ç–‘å®˜æ–¹å…¥å‚æ›´æ–°äº†","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1718796223,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"æµ™æ±Ÿ","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2,\"source\":0}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":391640,"user_name":"é£è½»æ‰¬","can_delete":false,"product_type":"c1","uid":1542987,"ip_address":"åŒ—äº¬","ucode":"DB972F2DF059C4","user_header":"https://static001.geekbang.org/account/avatar/00/17/8b/4b/15ab499a.jpg","comment_is_top":false,"comment_ctime":1718711408,"is_pvip":false,"replies":[{"id":142408,"content":"è¿™æ˜¯ä¸€æ–¹é¢ï¼Œä¸»è¦è¿˜æ˜¯è€ƒè™‘ä¸šåŠ¡åº”ç”¨ä¸å¤§æ¨¡å‹åˆ†å¼€ï¼Œèµ·åˆ°ä¿æŠ¤çš„ä½œç”¨","user_name":"ä½œè€…å›å¤","user_name_real":"ç¼–è¾‘","uid":2083554,"ctime":1718716592,"ip_address":"æµ™æ±Ÿ","comment_id":391640,"utype":1}],"discussion_count":1,"race_medal":0,"score":3,"product_id":100770601,"comment_content":"æ€è€ƒé¢˜ï¼Œæ˜¯ä¸ºäº†è§£è€¦ï¼Ÿå·¥ç¨‹ç±»çš„ä»£ç ä¿®æ”¹ï¼Œä¸å¤ªåº”è¯¥è®©æ¨¡å‹è·Ÿç€ä¸€èµ·å‘å¸ƒã€‚","like_count":0,"discussions":[{"author":{"id":2083554,"avatar":"http://thirdwx.qlogo.cn/mmopen/vi_32/DYAIOgq83erZP8e2vqiaACFaDxruOzUTPbPv2uRUTp9UuEg98Ib9aYddjZK2kastqf0B14Ec7uXx7CCSXr0fhAA/132","nickname":"Geek_cf2545","note":"","ucode":"B69DF1E734FBA2","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":646782,"discussion_content":"è¿™æ˜¯ä¸€æ–¹é¢ï¼Œä¸»è¦è¿˜æ˜¯è€ƒè™‘ä¸šåŠ¡åº”ç”¨ä¸å¤§æ¨¡å‹åˆ†å¼€ï¼Œèµ·åˆ°ä¿æŠ¤çš„ä½œç”¨","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1718716592,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"æµ™æ±Ÿ","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2,\"source\":0}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":391606,"user_name":"Eleven","can_delete":false,"product_type":"c1","uid":1168452,"ip_address":"æ¹–å—","ucode":"FB4A0C8CA732BE","user_header":"https://static001.geekbang.org/account/avatar/00/11/d4/44/0ec958f4.jpg","comment_is_top":false,"comment_ctime":1718630659,"is_pvip":false,"replies":[{"id":142400,"content":"å¤šè¯•ä¸€ä¸‹ï¼Œæ”¹å˜ä¸€ä¸‹è®­ç»ƒç´ æå’Œè®­ç»ƒé…ç½®ï¼Œæ¯”å¦‚è½®æ•°ç­‰","user_name":"ä½œè€…å›å¤","user_name_real":"ç¼–è¾‘","uid":2083554,"ctime":1718690900,"ip_address":"æµ™æ±Ÿ","comment_id":391606,"utype":1}],"discussion_count":2,"race_medal":0,"score":3,"product_id":100770601,"comment_content":"æˆ‘å¾®è°ƒå®Œæˆåå†å»composite_demoå¯åŠ¨ï¼Œå¯¹è¯å¥½åƒæ²¡æœ‰æ•ˆæœå‘€\n","like_count":0,"discussions":[{"author":{"id":2083554,"avatar":"http://thirdwx.qlogo.cn/mmopen/vi_32/DYAIOgq83erZP8e2vqiaACFaDxruOzUTPbPv2uRUTp9UuEg98Ib9aYddjZK2kastqf0B14Ec7uXx7CCSXr0fhAA/132","nickname":"Geek_cf2545","note":"","ucode":"B69DF1E734FBA2","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":646759,"discussion_content":"å¤šè¯•ä¸€ä¸‹ï¼Œæ”¹å˜ä¸€ä¸‹è®­ç»ƒç´ æå’Œè®­ç»ƒé…ç½®ï¼Œæ¯”å¦‚è½®æ•°ç­‰","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1718690900,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"æµ™æ±Ÿ","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2,\"source\":0}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":2083554,"avatar":"http://thirdwx.qlogo.cn/mmopen/vi_32/DYAIOgq83erZP8e2vqiaACFaDxruOzUTPbPv2uRUTp9UuEg98Ib9aYddjZK2kastqf0B14Ec7uXx7CCSXr0fhAA/132","nickname":"Geek_cf2545","note":"","ucode":"B69DF1E734FBA2","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":646758,"discussion_content":"å¤šè¯•ä¸€ä¸‹ï¼Œæ”¹å˜ä¸€ä¸‹è®­ç»ƒç´ æå’Œè®­ç»ƒé…ç½®ï¼Œæ¯”å¦‚è½®æ•°ç­‰","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1718690738,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"æµ™æ±Ÿ","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2,\"source\":0}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":391587,"user_name":"å¾çŸ³å¤´","can_delete":false,"product_type":"c1","uid":1035885,"ip_address":"æ¹–å—","ucode":"D8FA8A64FB7E33","user_header":"https://static001.geekbang.org/account/avatar/00/0f/ce/6d/530df0dd.jpg","comment_is_top":false,"comment_ctime":1718601218,"is_pvip":true,"replies":[{"id":142389,"content":"æ²¡é”™ğŸ‘","user_name":"ä½œè€…å›å¤","user_name_real":"ç¼–è¾‘","uid":2083554,"ctime":1718609461,"ip_address":"æµ™æ±Ÿ","comment_id":391587,"utype":1}],"discussion_count":1,"race_medal":0,"score":3,"product_id":100770601,"comment_content":"ä¸ºä»€ä¹ˆè¿™ä¹ˆè®¾è®¡ï¼Ÿ\né«˜å†…èšï¼Œä½è€¦åˆã€‚æŠŠå¤§æ¨¡å‹ API å°è£…åœ¨ python ä¸­ä½œä¸ºä¸€ä¸ªå¾®æœåŠ¡ä»æ•´ä¸ªæ¶æ„ä¸­ç‹¬ç«‹å‡ºæ¥ï¼Œå®ƒåªå¤„ç†å’Œå¤§æ¨¡å‹ç›¸å…³çš„ï¼Œä¸å’Œå…¶ä»–ä¸šåŠ¡æ¥å£æ”¾ä¸€èµ·ã€‚å®ƒå°±å¯ä»¥å•ç‹¬éƒ¨ç½²ï¼Œæ‰©å®¹ï¼Œéš”ç¦»ï¼Œè€Œä¸”ç”±å•ç‹¬çš„äººç»´æŠ¤ï¼Œä¹Ÿæ˜¯å¾®æœåŠ¡çš„ä¼˜åŠ¿ã€‚\nå¦‚æœæˆ‘æ¥åšï¼Œæˆ‘è¿˜ä¼šå¢åŠ  rpcæ¥å£ï¼Œæ³¨å†Œåˆ°æ³¨å†Œä¸­å¿ƒã€‚","like_count":0,"discussions":[{"author":{"id":2083554,"avatar":"http://thirdwx.qlogo.cn/mmopen/vi_32/DYAIOgq83erZP8e2vqiaACFaDxruOzUTPbPv2uRUTp9UuEg98Ib9aYddjZK2kastqf0B14Ec7uXx7CCSXr0fhAA/132","nickname":"Geek_cf2545","note":"","ucode":"B69DF1E734FBA2","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":646721,"discussion_content":"æ²¡é”™ğŸ‘","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1718609461,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"æµ™æ±Ÿ","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2,\"source\":0}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":391583,"user_name":"roman","can_delete":false,"product_type":"c1","uid":1017679,"ip_address":"åŒ—äº¬","ucode":"6E147F09D6EC32","user_header":"http://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTJZO3Xkicd9Cy8tAian8JnxqVianHNggKcMtdx6sKrQygxnCUKib3ERXIxiaFqkFyhPibkCGzpbdTOiaGvSA/132","comment_is_top":false,"comment_ctime":1718597534,"is_pvip":false,"replies":[{"id":142387,"content":"è¯´çš„å¾ˆå¥½ğŸ‘ å¤§æ¨¡å‹æ˜¯å·¥å…·ï¼Œä¸Šå±‚aiåº”ç”¨å¯èƒ½æ˜¯å¤šä¸ªå·¥å…·çš„é›†åˆ","user_name":"ä½œè€…å›å¤","user_name_real":"ç¼–è¾‘","uid":2083554,"ctime":1718609401,"ip_address":"æµ™æ±Ÿ","comment_id":391583,"utype":1}],"discussion_count":1,"race_medal":0,"score":3,"product_id":100770601,"comment_content":"è€å¸ˆ å¥½ï¼Œå†å¥—ä¸€å±‚åº”ç”¨æˆ‘çš„æƒ³æ³•æ˜¯è¿™æ ·çš„ï¼Œä¸çŸ¥é“æ˜¯å¦æ­£ç¡® \n1.ä¿æŠ¤åº•å±‚å¤§æ¨¡å‹åº”ç”¨ï¼šå¥—ä¸€å±‚ç±»ä¼¼Javaåº”ç”¨å±‚çš„åº”ç”¨å¯ä»¥åšåˆ°å°†å¤§æ¨¡å‹çš„åº•å±‚æœåŠ¡å’Œå®¢æˆ·ç«¯çš„è®¿é—®è¿›è¡Œéš”ç¦»ï¼Œé¿å…ä¸€äº›å®¢æˆ·ç«¯æ³¨å…¥æ”»å‡»ç±»å‹çš„åœºæ™¯\n2.ç»™åº”ç”¨å±‚æä¾›æ›´å¤šå¯æ‰©å±•çš„åœºæ™¯ï¼Œåº•å±‚å¤§æ¨¡å‹åªæ˜¯ä¸€ä¸ªå·¥å…·ï¼Œä½†æ˜¯å¦‚ä½•è®©å·¥å…·æ›´å¥½çš„æ»¡è¶³ä¸åŒçš„ä¸šåŠ¡åœºæ™¯ï¼Œå¯èƒ½å°±éœ€è¦åœ¨åº”ç”¨å±‚åšä¸€äº›æ‰©å±•ï¼Œæ¯”å¦‚åº”ç”¨å±‚å¯ä»¥é’ˆå¯¹åŒä¸€ä¸ªé—®é¢˜è°ƒç”¨å¤šä¸ªå¤§æ¨¡å‹ï¼ˆé¿å…å‡ºç°å¤§æ¨¡å‹å•ç‚¹æ•…éšœé—®é¢˜ï¼‰ç­‰åœºæ™¯çš„æ‰©å±•","like_count":0,"discussions":[{"author":{"id":2083554,"avatar":"http://thirdwx.qlogo.cn/mmopen/vi_32/DYAIOgq83erZP8e2vqiaACFaDxruOzUTPbPv2uRUTp9UuEg98Ib9aYddjZK2kastqf0B14Ec7uXx7CCSXr0fhAA/132","nickname":"Geek_cf2545","note":"","ucode":"B69DF1E734FBA2","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":646719,"discussion_content":"è¯´çš„å¾ˆå¥½ğŸ‘ å¤§æ¨¡å‹æ˜¯å·¥å…·ï¼Œä¸Šå±‚aiåº”ç”¨å¯èƒ½æ˜¯å¤šä¸ªå·¥å…·çš„é›†åˆ","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1718609401,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"æµ™æ±Ÿ","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2,\"source\":0}","child_discussion_number":0,"child_discussions":[]}]}]}