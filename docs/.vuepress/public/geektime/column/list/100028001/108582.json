{"id":108582,"title":"25 | å†…å­˜æŒç»­ä¸Šå‡ï¼Œæˆ‘è¯¥å¦‚ä½•æ’æŸ¥é—®é¢˜ï¼Ÿ","content":"<p>ä½ å¥½ï¼Œæˆ‘æ˜¯åˆ˜è¶…ã€‚</p><p>æˆ‘æƒ³ä½ è‚¯å®šé‡åˆ°è¿‡å†…å­˜æº¢å‡ºï¼Œæˆ–æ˜¯å†…å­˜ä½¿ç”¨ç‡è¿‡é«˜çš„é—®é¢˜ã€‚ç¢°åˆ°å†…å­˜æŒç»­ä¸Šå‡çš„æƒ…å†µï¼Œå…¶å®æˆ‘ä»¬å¾ˆéš¾ä»ä¸šåŠ¡æ—¥å¿—ä¸­æŸ¥çœ‹åˆ°å…·ä½“çš„é—®é¢˜ï¼Œ<span class=\"orange\">é‚£ä¹ˆé¢å¯¹å¤šä¸ªè¿›ç¨‹ä»¥åŠå¤§é‡ä¸šåŠ¡çº¿ç¨‹ï¼Œæˆ‘ä»¬è¯¥å¦‚ä½•ç²¾å‡†åœ°æ‰¾åˆ°èƒŒåçš„åŸå› å‘¢ï¼Ÿ</span></p><h2>å¸¸ç”¨çš„ç›‘æ§å’Œè¯Šæ–­å†…å­˜å·¥å…·</h2><p>å·¥æ¬²å–„å…¶äº‹ï¼Œå¿…å…ˆåˆ©å…¶å™¨ã€‚å¹³æ—¶æ’æŸ¥å†…å­˜æ€§èƒ½ç“¶é¢ˆæ—¶ï¼Œæˆ‘ä»¬å¾€å¾€éœ€è¦ç”¨åˆ°ä¸€äº›Linuxå‘½ä»¤è¡Œæˆ–è€…JDKå·¥å…·æ¥è¾…åŠ©æˆ‘ä»¬ç›‘æµ‹ç³»ç»Ÿæˆ–è€…è™šæ‹Ÿæœºå†…å­˜çš„ä½¿ç”¨æƒ…å†µï¼Œä¸‹é¢æˆ‘å°±æ¥ä»‹ç»å‡ ç§å¥½ç”¨ä¸”å¸¸ç”¨çš„å·¥å…·ã€‚</p><h3>Linuxå‘½ä»¤è¡Œå·¥å…·ä¹‹topå‘½ä»¤</h3><p>topå‘½ä»¤æ˜¯æˆ‘ä»¬åœ¨Linuxä¸‹æœ€å¸¸ç”¨çš„å‘½ä»¤ä¹‹ä¸€ï¼Œå®ƒå¯ä»¥å®æ—¶æ˜¾ç¤ºæ­£åœ¨æ‰§è¡Œè¿›ç¨‹çš„CPUä½¿ç”¨ç‡ã€å†…å­˜ä½¿ç”¨ç‡ä»¥åŠç³»ç»Ÿè´Ÿè½½ç­‰ä¿¡æ¯ã€‚å…¶ä¸­ä¸ŠåŠéƒ¨åˆ†æ˜¾ç¤ºçš„æ˜¯ç³»ç»Ÿçš„ç»Ÿè®¡ä¿¡æ¯ï¼Œä¸‹åŠéƒ¨åˆ†æ˜¾ç¤ºçš„æ˜¯è¿›ç¨‹çš„ä½¿ç”¨ç‡ç»Ÿè®¡ä¿¡æ¯ã€‚</p><p><img src=\"https://static001.geekbang.org/resource/image/36/49/3633095ed54d1ef22fc08310497d6b49.jpg?wh=1778*660\" alt=\"\"></p><p>é™¤äº†ç®€å•çš„topä¹‹å¤–ï¼Œæˆ‘ä»¬è¿˜å¯ä»¥é€šè¿‡top -Hp pidæŸ¥çœ‹å…·ä½“çº¿ç¨‹ä½¿ç”¨ç³»ç»Ÿèµ„æºæƒ…å†µï¼š</p><p><img src=\"https://static001.geekbang.org/resource/image/1e/47/1e4429a9785ae4e6c0884655ee8b5747.jpg?wh=1630*780\" alt=\"\"></p><h3>Linuxå‘½ä»¤è¡Œå·¥å…·ä¹‹vmstatå‘½ä»¤</h3><p>vmstatæ˜¯ä¸€æ¬¾æŒ‡å®šé‡‡æ ·å‘¨æœŸå’Œæ¬¡æ•°çš„åŠŸèƒ½æ€§ç›‘æµ‹å·¥å…·ï¼Œæˆ‘ä»¬å¯ä»¥çœ‹åˆ°ï¼Œå®ƒä¸ä»…å¯ä»¥ç»Ÿè®¡å†…å­˜çš„ä½¿ç”¨æƒ…å†µï¼Œè¿˜å¯ä»¥è§‚æµ‹åˆ°CPUçš„ä½¿ç”¨ç‡ã€swapçš„ä½¿ç”¨æƒ…å†µã€‚ä½†vmstatä¸€èˆ¬å¾ˆå°‘ç”¨æ¥æŸ¥çœ‹å†…å­˜çš„ä½¿ç”¨æƒ…å†µï¼Œè€Œæ˜¯ç»å¸¸è¢«ç”¨æ¥è§‚å¯Ÿè¿›ç¨‹çš„ä¸Šä¸‹æ–‡åˆ‡æ¢ã€‚</p><p><img src=\"https://static001.geekbang.org/resource/image/31/62/31a79622cdcadda4e9003b075378dc62.jpg?wh=1488*178\" alt=\"\"></p><ul>\n<li>rï¼šç­‰å¾…è¿è¡Œçš„è¿›ç¨‹æ•°ï¼›</li>\n<li>bï¼šå¤„äºéä¸­æ–­ç¡çœ çŠ¶æ€çš„è¿›ç¨‹æ•°ï¼›</li>\n<li>swpdï¼šè™šæ‹Ÿå†…å­˜ä½¿ç”¨æƒ…å†µï¼›</li>\n<li>freeï¼šç©ºé—²çš„å†…å­˜ï¼›</li>\n<li>buffï¼šç”¨æ¥ä½œä¸ºç¼“å†²çš„å†…å­˜æ•°ï¼›</li>\n<li>siï¼šä»ç£ç›˜äº¤æ¢åˆ°å†…å­˜çš„äº¤æ¢é¡µæ•°é‡ï¼›</li>\n<li>soï¼šä»å†…å­˜äº¤æ¢åˆ°ç£ç›˜çš„äº¤æ¢é¡µæ•°é‡ï¼›</li>\n<li>biï¼šå‘é€åˆ°å—è®¾å¤‡çš„å—æ•°ï¼›</li>\n<li>boï¼šä»å—è®¾å¤‡æ¥æ”¶åˆ°çš„å—æ•°ï¼›</li>\n<li>inï¼šæ¯ç§’ä¸­æ–­æ•°ï¼›</li>\n<li>csï¼šæ¯ç§’ä¸Šä¸‹æ–‡åˆ‡æ¢æ¬¡æ•°ï¼›</li>\n<li>usï¼šç”¨æˆ·CPUä½¿ç”¨æ—¶é—´ï¼›</li>\n<li>syï¼šå†…æ ¸CPUç³»ç»Ÿä½¿ç”¨æ—¶é—´ï¼›</li>\n<li>idï¼šç©ºé—²æ—¶é—´ï¼›</li>\n<li>waï¼šç­‰å¾…I/Oæ—¶é—´ï¼›</li>\n<li>stï¼šè¿è¡Œè™šæ‹Ÿæœºçªƒå–çš„æ—¶é—´ã€‚</li>\n</ul><!-- [[[read_end]]] --><h3>Linuxå‘½ä»¤è¡Œå·¥å…·ä¹‹pidstatå‘½ä»¤</h3><p>pidstatæ˜¯Sysstatä¸­çš„ä¸€ä¸ªç»„ä»¶ï¼Œä¹Ÿæ˜¯ä¸€æ¬¾åŠŸèƒ½å¼ºå¤§çš„æ€§èƒ½ç›‘æµ‹å·¥å…·ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡å‘½ä»¤ï¼šyum install sysstatå®‰è£…è¯¥ç›‘æ§ç»„ä»¶ã€‚ä¹‹å‰çš„topå’Œvmstatä¸¤ä¸ªå‘½ä»¤éƒ½æ˜¯ç›‘æµ‹è¿›ç¨‹çš„å†…å­˜ã€CPUä»¥åŠI/Oä½¿ç”¨æƒ…å†µï¼Œè€Œpidstatå‘½ä»¤åˆ™æ˜¯æ·±å…¥åˆ°çº¿ç¨‹çº§åˆ«ã€‚</p><p>é€šè¿‡pidstat -helpå‘½ä»¤ï¼Œæˆ‘ä»¬å¯ä»¥æŸ¥çœ‹åˆ°æœ‰ä»¥ä¸‹å‡ ä¸ªå¸¸ç”¨çš„å‚æ•°æ¥ç›‘æµ‹çº¿ç¨‹çš„æ€§èƒ½ï¼š</p><p><img src=\"https://static001.geekbang.org/resource/image/90/46/90d26ef49ad94510062ac3f36727a346.jpg?wh=1440*178\" alt=\"\"></p><p>å¸¸ç”¨å‚æ•°ï¼š</p><ul>\n<li>-uï¼šé»˜è®¤çš„å‚æ•°ï¼Œæ˜¾ç¤ºå„ä¸ªè¿›ç¨‹çš„cpuä½¿ç”¨æƒ…å†µï¼›</li>\n<li>-rï¼šæ˜¾ç¤ºå„ä¸ªè¿›ç¨‹çš„å†…å­˜ä½¿ç”¨æƒ…å†µï¼›</li>\n<li>-dï¼šæ˜¾ç¤ºå„ä¸ªè¿›ç¨‹çš„I/Oä½¿ç”¨æƒ…å†µï¼›</li>\n<li>-wï¼šæ˜¾ç¤ºæ¯ä¸ªè¿›ç¨‹çš„ä¸Šä¸‹æ–‡åˆ‡æ¢æƒ…å†µï¼›</li>\n<li>-pï¼šæŒ‡å®šè¿›ç¨‹å·ï¼›</li>\n<li>-tï¼šæ˜¾ç¤ºè¿›ç¨‹ä¸­çº¿ç¨‹çš„ç»Ÿè®¡ä¿¡æ¯ã€‚</li>\n</ul><p>æˆ‘ä»¬å¯ä»¥é€šè¿‡ç›¸å…³å‘½ä»¤ï¼ˆä¾‹å¦‚psæˆ–jpsï¼‰æŸ¥è¯¢åˆ°ç›¸å…³è¿›ç¨‹IDï¼Œå†è¿è¡Œä»¥ä¸‹å‘½ä»¤æ¥ç›‘æµ‹è¯¥è¿›ç¨‹çš„å†…å­˜ä½¿ç”¨æƒ…å†µï¼š</p><p><img src=\"https://static001.geekbang.org/resource/image/18/61/184df3ee5ab0a920f506b3daa6250a61.jpg?wh=1562*460\" alt=\"\"></p><p>å…¶ä¸­pidstatçš„å‚æ•°-pç”¨äºæŒ‡å®šè¿›ç¨‹IDï¼Œ-rè¡¨ç¤ºç›‘æ§å†…å­˜çš„ä½¿ç”¨æƒ…å†µï¼Œ1è¡¨ç¤ºæ¯ç§’çš„æ„æ€ï¼Œ3åˆ™è¡¨ç¤ºé‡‡æ ·æ¬¡æ•°ã€‚</p><p>å…¶ä¸­æ˜¾ç¤ºçš„å‡ ä¸ªå…³é”®æŒ‡æ ‡çš„å«ä¹‰æ˜¯ï¼š</p><ul>\n<li>Minflt/sï¼šä»»åŠ¡æ¯ç§’å‘ç”Ÿçš„æ¬¡è¦é”™è¯¯ï¼Œä¸éœ€è¦ä»ç£ç›˜ä¸­åŠ è½½é¡µï¼›</li>\n<li>Majflt/sï¼šä»»åŠ¡æ¯ç§’å‘ç”Ÿçš„ä¸»è¦é”™è¯¯ï¼Œéœ€è¦ä»ç£ç›˜ä¸­åŠ è½½é¡µï¼›</li>\n<li>VSZï¼šè™šæ‹Ÿåœ°å€å¤§å°ï¼Œè™šæ‹Ÿå†…å­˜ä½¿ç”¨KBï¼›</li>\n<li>RSSï¼šå¸¸é©»é›†åˆå¤§å°ï¼Œéäº¤æ¢åŒºå†…å­˜ä½¿ç”¨KBã€‚</li>\n</ul><p>å¦‚æœæˆ‘ä»¬éœ€è¦ç»§ç»­æŸ¥çœ‹è¯¥è¿›ç¨‹ä¸‹çš„çº¿ç¨‹å†…å­˜ä½¿ç”¨ç‡ï¼Œåˆ™åœ¨åé¢æ·»åŠ -tæŒ‡ä»¤å³å¯ï¼š</p><p><img src=\"https://static001.geekbang.org/resource/image/3c/72/3c9072c659a91b5f83cbc1a112ddcc72.jpg?wh=1574*694\" alt=\"\"></p><p>æˆ‘ä»¬çŸ¥é“ï¼ŒJavaæ˜¯åŸºäºJVMä¸Šè¿è¡Œçš„ï¼Œå¤§éƒ¨åˆ†å†…å­˜éƒ½æ˜¯åœ¨JVMçš„ç”¨æˆ·å†…å­˜ä¸­åˆ›å»ºçš„ï¼Œæ‰€ä»¥é™¤äº†é€šè¿‡ä»¥ä¸ŠLinuxå‘½ä»¤æ¥ç›‘æ§æ•´ä¸ªæœåŠ¡å™¨å†…å­˜çš„ä½¿ç”¨æƒ…å†µä¹‹å¤–ï¼Œæˆ‘ä»¬æ›´éœ€è¦çŸ¥é“JVMä¸­çš„å†…å­˜ä½¿ç”¨æƒ…å†µã€‚JDKä¸­å°±è‡ªå¸¦äº†å¾ˆå¤šå‘½ä»¤å·¥å…·å¯ä»¥ç›‘æµ‹åˆ°JVMçš„å†…å­˜åˆ†é…ä»¥åŠä½¿ç”¨æƒ…å†µã€‚</p><h3>JDKå·¥å…·ä¹‹jstatå‘½ä»¤</h3><p>jstatå¯ä»¥ç›‘æµ‹Javaåº”ç”¨ç¨‹åºçš„å®æ—¶è¿è¡Œæƒ…å†µï¼ŒåŒ…æ‹¬å †å†…å­˜ä¿¡æ¯ä»¥åŠåƒåœ¾å›æ”¶ä¿¡æ¯ã€‚æˆ‘ä»¬å¯ä»¥è¿è¡Œjstat -helpæŸ¥çœ‹ä¸€äº›å…³é”®å‚æ•°ä¿¡æ¯ï¼š</p><p><img src=\"https://static001.geekbang.org/resource/image/42/e8/42880a93eb63ae6854a7920e73a751e8.jpg?wh=1550*610\" alt=\"\"></p><p>å†é€šè¿‡jstat -optionæŸ¥çœ‹jstatæœ‰å“ªäº›æ“ä½œï¼š</p><p><img src=\"https://static001.geekbang.org/resource/image/7a/7d/7af697d9cfd6002a49063ab2464d5f7d.jpg?wh=1506*386\" alt=\"\"></p><ul>\n<li>-classï¼šæ˜¾ç¤ºClassLoadçš„ç›¸å…³ä¿¡æ¯ï¼›</li>\n<li>-compilerï¼šæ˜¾ç¤ºJITç¼–è¯‘çš„ç›¸å…³ä¿¡æ¯ï¼›</li>\n<li>-gcï¼šæ˜¾ç¤ºå’Œgcç›¸å…³çš„å †ä¿¡æ¯ï¼›</li>\n<li>-gccapacityï¼šæ˜¾ç¤ºå„ä¸ªä»£çš„å®¹é‡ä»¥åŠä½¿ç”¨æƒ…å†µï¼›</li>\n<li>-gcmetacapacityï¼šæ˜¾ç¤ºMetaspaceçš„å¤§å°ï¼›</li>\n<li>-gcnewï¼šæ˜¾ç¤ºæ–°ç”Ÿä»£ä¿¡æ¯ï¼›</li>\n<li>-gcnewcapacityï¼šæ˜¾ç¤ºæ–°ç”Ÿä»£å¤§å°å’Œä½¿ç”¨æƒ…å†µï¼›</li>\n<li>-gcoldï¼šæ˜¾ç¤ºè€å¹´ä»£å’Œæ°¸ä¹…ä»£çš„ä¿¡æ¯ï¼›</li>\n<li>-gcoldcapacity ï¼šæ˜¾ç¤ºè€å¹´ä»£çš„å¤§å°ï¼›</li>\n<li>-gcutilï¼šæ˜¾ç¤ºåƒåœ¾æ”¶é›†ä¿¡æ¯ï¼›</li>\n<li>-gccauseï¼šæ˜¾ç¤ºåƒåœ¾å›æ”¶çš„ç›¸å…³ä¿¡æ¯ï¼ˆé€š-gcutilï¼‰ï¼ŒåŒæ—¶æ˜¾ç¤ºæœ€åä¸€æ¬¡æˆ–å½“å‰æ­£åœ¨å‘ç”Ÿçš„åƒåœ¾å›æ”¶çš„è¯±å› ï¼›</li>\n<li>-printcompilationï¼šè¾“å‡ºJITç¼–è¯‘çš„æ–¹æ³•ä¿¡æ¯ã€‚</li>\n</ul><p>å®ƒçš„åŠŸèƒ½æ¯”è¾ƒå¤šï¼Œåœ¨è¿™é‡Œæˆ‘ä¾‹ä¸¾ä¸€ä¸ªå¸¸ç”¨åŠŸèƒ½ï¼Œå¦‚ä½•ä½¿ç”¨jstatæŸ¥çœ‹å †å†…å­˜çš„ä½¿ç”¨æƒ…å†µã€‚æˆ‘ä»¬å¯ä»¥ç”¨jstat -gc pidæŸ¥çœ‹ï¼š</p><p><img src=\"https://static001.geekbang.org/resource/image/e5/68/e59188982cf5b75243a8c333bfead068.jpg?wh=2464*128\" alt=\"\"></p><ul>\n<li>S0Cï¼šå¹´è½»ä»£ä¸­To Survivorçš„å®¹é‡ï¼ˆå•ä½KBï¼‰ï¼›</li>\n<li>S1Cï¼šå¹´è½»ä»£ä¸­From Survivorçš„å®¹é‡ï¼ˆå•ä½KBï¼‰ï¼›</li>\n<li>S0Uï¼šå¹´è½»ä»£ä¸­To Survivorç›®å‰å·²ä½¿ç”¨ç©ºé—´ï¼ˆå•ä½KBï¼‰ï¼›</li>\n<li>S1Uï¼šå¹´è½»ä»£ä¸­From Survivorç›®å‰å·²ä½¿ç”¨ç©ºé—´ï¼ˆå•ä½KBï¼‰ï¼›</li>\n<li>ECï¼šå¹´è½»ä»£ä¸­Edençš„å®¹é‡ï¼ˆå•ä½KBï¼‰ï¼›</li>\n<li>EUï¼šå¹´è½»ä»£ä¸­Edenç›®å‰å·²ä½¿ç”¨ç©ºé—´ï¼ˆå•ä½KBï¼‰ï¼›</li>\n<li>OCï¼šOldä»£çš„å®¹é‡ï¼ˆå•ä½KBï¼‰ï¼›</li>\n<li>OUï¼šOldä»£ç›®å‰å·²ä½¿ç”¨ç©ºé—´ï¼ˆå•ä½KBï¼‰ï¼›</li>\n<li>MCï¼šMetaspaceçš„å®¹é‡ï¼ˆå•ä½KBï¼‰ï¼›</li>\n<li>MUï¼šMetaspaceç›®å‰å·²ä½¿ç”¨ç©ºé—´ï¼ˆå•ä½KBï¼‰ï¼›</li>\n<li>YGCï¼šä»åº”ç”¨ç¨‹åºå¯åŠ¨åˆ°é‡‡æ ·æ—¶å¹´è½»ä»£ä¸­gcæ¬¡æ•°ï¼›</li>\n<li>YGCTï¼šä»åº”ç”¨ç¨‹åºå¯åŠ¨åˆ°é‡‡æ ·æ—¶å¹´è½»ä»£ä¸­gcæ‰€ç”¨æ—¶é—´(s)ï¼›</li>\n<li>FGCï¼šä»åº”ç”¨ç¨‹åºå¯åŠ¨åˆ°é‡‡æ ·æ—¶oldä»£ï¼ˆå…¨gcï¼‰gcæ¬¡æ•°ï¼›</li>\n<li>FGCTï¼šä»åº”ç”¨ç¨‹åºå¯åŠ¨åˆ°é‡‡æ ·æ—¶oldä»£ï¼ˆå…¨gcï¼‰gcæ‰€ç”¨æ—¶é—´(s)ï¼›</li>\n<li>GCTï¼šä»åº”ç”¨ç¨‹åºå¯åŠ¨åˆ°é‡‡æ ·æ—¶gcç”¨çš„æ€»æ—¶é—´(s)ã€‚</li>\n</ul><h3>JDKå·¥å…·ä¹‹jstackå‘½ä»¤</h3><p>è¿™ä¸ªå·¥å…·åœ¨æ¨¡å—ä¸‰çš„<a href=\"https://time.geekbang.org/column/article/105234\">ç­”ç–‘è¯¾å ‚</a>ä¸­ä»‹ç»è¿‡ï¼Œå®ƒæ˜¯ä¸€ç§çº¿ç¨‹å †æ ˆåˆ†æå·¥å…·ï¼Œæœ€å¸¸ç”¨çš„åŠŸèƒ½å°±æ˜¯ä½¿ç”¨ jstack pid å‘½ä»¤æŸ¥çœ‹çº¿ç¨‹çš„å †æ ˆä¿¡æ¯ï¼Œé€šå¸¸ä¼šç»“åˆtop -Hp pid æˆ– pidstat -p pid -tä¸€èµ·æŸ¥çœ‹å…·ä½“çº¿ç¨‹çš„çŠ¶æ€ï¼Œä¹Ÿç»å¸¸ç”¨æ¥æ’æŸ¥ä¸€äº›æ­»é”çš„å¼‚å¸¸ã€‚</p><p><img src=\"https://static001.geekbang.org/resource/image/28/88/2869503e8d5460e36b3fd3e1a52a8888.jpg?wh=2328*414\" alt=\"\"></p><p>æ¯ä¸ªçº¿ç¨‹å †æ ˆçš„ä¿¡æ¯ä¸­ï¼Œéƒ½å¯ä»¥æŸ¥çœ‹åˆ°çº¿ç¨‹IDã€çº¿ç¨‹çš„çŠ¶æ€ï¼ˆwaitã€sleepã€running ç­‰çŠ¶æ€ï¼‰ä»¥åŠæ˜¯å¦æŒæœ‰é”ç­‰ã€‚</p><h3>JDKå·¥å…·ä¹‹jmapå‘½ä»¤</h3><p>åœ¨<a href=\"https://time.geekbang.org/column/article/108139\">ç¬¬23è®²</a>ä¸­æˆ‘ä»¬ä½¿ç”¨è¿‡jmapæŸ¥çœ‹å †å†…å­˜åˆå§‹åŒ–é…ç½®ä¿¡æ¯ä»¥åŠå †å†…å­˜çš„ä½¿ç”¨æƒ…å†µã€‚é‚£ä¹ˆé™¤äº†è¿™ä¸ªåŠŸèƒ½ï¼Œæˆ‘ä»¬å…¶å®è¿˜å¯ä»¥ä½¿ç”¨jmapè¾“å‡ºå †å†…å­˜ä¸­çš„å¯¹è±¡ä¿¡æ¯ï¼ŒåŒ…æ‹¬äº§ç”Ÿäº†å“ªäº›å¯¹è±¡ï¼Œå¯¹è±¡æ•°é‡å¤šå°‘ç­‰ã€‚</p><p>æˆ‘ä»¬å¯ä»¥ç”¨jmapæ¥æŸ¥çœ‹å †å†…å­˜åˆå§‹åŒ–é…ç½®ä¿¡æ¯ä»¥åŠå †å†…å­˜çš„ä½¿ç”¨æƒ…å†µï¼š</p><p><img src=\"https://static001.geekbang.org/resource/image/80/3f/808870b42f5f6525d79f70fd287a293f.jpg?wh=1206*1304\" alt=\"\"></p><p>æˆ‘ä»¬å¯ä»¥ä½¿ç”¨jmap -histo[:live] pidæŸ¥çœ‹å †å†…å­˜ä¸­çš„å¯¹è±¡æ•°ç›®ã€å¤§å°ç»Ÿè®¡ç›´æ–¹å›¾ï¼Œå¦‚æœå¸¦ä¸Šliveåˆ™åªç»Ÿè®¡æ´»å¯¹è±¡ï¼š</p><p><img src=\"https://static001.geekbang.org/resource/image/74/7b/74f42fa2b48ceaff869472f6061c1c7b.jpg?wh=1516*1028\" alt=\"\"></p><p>æˆ‘ä»¬å¯ä»¥é€šè¿‡jmapå‘½ä»¤æŠŠå †å†…å­˜çš„ä½¿ç”¨æƒ…å†µdumpåˆ°æ–‡ä»¶ä¸­ï¼š</p><p><img src=\"https://static001.geekbang.org/resource/image/f3/17/f3c17fd9bb436599fb48cf151ee7ba17.jpg?wh=1310*144\" alt=\"\"></p><p>æˆ‘ä»¬å¯ä»¥å°†æ–‡ä»¶ä¸‹è½½ä¸‹æ¥ï¼Œä½¿ç”¨ <a href=\"http://www.eclipse.org/mat/\">MAT</a> å·¥å…·æ‰“å¼€æ–‡ä»¶è¿›è¡Œåˆ†æï¼š</p><p><img src=\"https://static001.geekbang.org/resource/image/3c/43/3cc14844625cebcc1cdb836e5ccbfc43.jpg?wh=1492*1384\" alt=\"\"></p><p>ä¸‹é¢æˆ‘ä»¬ç”¨ä¸€ä¸ªå®æˆ˜æ¡ˆä¾‹æ¥ç»¼åˆä½¿ç”¨ä¸‹åˆšåˆšä»‹ç»çš„å‡ ç§å·¥å…·ï¼Œå…·ä½“æ“ä½œä¸€ä¸‹å¦‚ä½•åˆ†æä¸€ä¸ªå†…å­˜æ³„æ¼é—®é¢˜ã€‚</p><h2>å®æˆ˜æ¼”ç»ƒ</h2><p>æˆ‘ä»¬å¹³æ—¶é‡åˆ°çš„å†…å­˜æº¢å‡ºé—®é¢˜ä¸€èˆ¬åˆ†ä¸ºä¸¤ç§ï¼Œä¸€ç§æ˜¯ç”±äºå¤§å³°å€¼ä¸‹æ²¡æœ‰é™æµï¼Œç¬é—´åˆ›å»ºå¤§é‡å¯¹è±¡è€Œå¯¼è‡´çš„å†…å­˜æº¢å‡ºï¼›å¦ä¸€ç§åˆ™æ˜¯ç”±äºå†…å­˜æ³„æ¼è€Œå¯¼è‡´çš„å†…å­˜æº¢å‡ºã€‚</p><p>ä½¿ç”¨é™æµï¼Œæˆ‘ä»¬ä¸€èˆ¬å°±å¯ä»¥è§£å†³ç¬¬ä¸€ç§å†…å­˜æº¢å‡ºé—®é¢˜ï¼Œä½†å…¶å®å¾ˆå¤šæ—¶å€™ï¼Œå†…å­˜æº¢å‡ºå¾€å¾€æ˜¯å†…å­˜æ³„æ¼å¯¼è‡´çš„ï¼Œè¿™ç§é—®é¢˜å°±æ˜¯ç¨‹åºçš„BUGï¼Œæˆ‘ä»¬éœ€è¦åŠæ—¶æ‰¾åˆ°é—®é¢˜ä»£ç ã€‚</p><p><strong>ä¸‹é¢æˆ‘æ¨¡æ‹Ÿäº†ä¸€ä¸ªå†…å­˜æ³„æ¼å¯¼è‡´çš„å†…å­˜æº¢å‡ºæ¡ˆä¾‹ï¼Œæˆ‘ä»¬æ¥å®è·µä¸€ä¸‹ã€‚</strong></p><p>æˆ‘ä»¬çŸ¥é“ï¼ŒThreadLocalçš„ä½œç”¨æ˜¯æä¾›çº¿ç¨‹çš„ç§æœ‰å˜é‡ï¼Œè¿™ç§å˜é‡å¯ä»¥åœ¨ä¸€ä¸ªçº¿ç¨‹çš„æ•´ä¸ªç”Ÿå‘½å‘¨æœŸä¸­ä¼ é€’ï¼Œå¯ä»¥å‡å°‘ä¸€ä¸ªçº¿ç¨‹åœ¨å¤šä¸ªå‡½æ•°æˆ–ç±»ä¸­åˆ›å»ºå…¬å…±å˜é‡æ¥ä¼ é€’ä¿¡æ¯ï¼Œé¿å…äº†å¤æ‚åº¦ã€‚ä½†åœ¨ä½¿ç”¨æ—¶ï¼Œå¦‚æœThreadLocalä½¿ç”¨ä¸æ°å½“ï¼Œå°±å¯èƒ½å¯¼è‡´å†…å­˜æ³„æ¼ã€‚</p><p>è¿™ä¸ªæ¡ˆä¾‹çš„åœºæ™¯å°±æ˜¯ThreadLocalï¼Œä¸‹é¢æˆ‘ä»¬æ¨¡æ‹Ÿå¯¹æ¯ä¸ªçº¿ç¨‹è®¾ç½®ä¸€ä¸ªæœ¬åœ°å˜é‡ã€‚è¿è¡Œä»¥ä¸‹ä»£ç ï¼Œç³»ç»Ÿä¸€ä¼šå„¿å°±å‘é€äº†å†…å­˜æº¢å‡ºå¼‚å¸¸ï¼š</p><pre><code>    @RequestMapping(value = &quot;/test0&quot;)\n    public String test0(HttpServletRequest request) {\n        ThreadLocal&lt;Byte[]&gt; localVariable = new ThreadLocal&lt;Byte[]&gt;();\n        localVariable.set(new Byte[4096*1024]);// ä¸ºçº¿ç¨‹æ·»åŠ å˜é‡\n        return &quot;success&quot;;\n    }\n</code></pre><p>åœ¨å¯åŠ¨åº”ç”¨ç¨‹åºä¹‹å‰ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡HeapDumpOnOutOfMemoryErrorå’ŒHeapDumpPathè¿™ä¸¤ä¸ªå‚æ•°å¼€å¯å †å†…å­˜å¼‚å¸¸æ—¥å¿—ï¼Œé€šè¿‡ä»¥ä¸‹å‘½ä»¤å¯åŠ¨åº”ç”¨ç¨‹åºï¼š</p><pre><code>java -jar -Xms1000m -Xmx4000m -XX:+HeapDumpOnOutOfMemoryError -XX:HeapDumpPath=/tmp/heapdump.hprof  -XX:+PrintGCTimeStamps -XX:+PrintGCDetails -Xloggc:/tmp/heapTest.log heapTest-0.0.1-SNAPSHOT.jar\n</code></pre><p>é¦–å…ˆï¼Œè¯·æ±‚test0é“¾æ¥10000æ¬¡ï¼Œè¿™ä¸ªæ—¶å€™æˆ‘ä»¬è¯·æ±‚test0çš„æ¥å£æŠ¥å¼‚å¸¸äº†ã€‚</p><p><img src=\"https://static001.geekbang.org/resource/image/60/dc/60ab8d7847a55a9bcf84d17ecd11ebdc.jpg?wh=2350*574\" alt=\"\"></p><p>é€šè¿‡æ—¥å¿—ï¼Œæˆ‘ä»¬å¾ˆå¥½åˆ†è¾¨è¿™æ˜¯ä¸€ä¸ªå†…å­˜æº¢å‡ºå¼‚å¸¸ã€‚æˆ‘ä»¬é¦–å…ˆé€šè¿‡Linuxç³»ç»Ÿå‘½ä»¤æŸ¥çœ‹è¿›ç¨‹åœ¨æ•´ä¸ªç³»ç»Ÿä¸­å†…å­˜çš„ä½¿ç”¨ç‡æ˜¯å¤šå°‘ï¼Œæœ€ç®€å•å°±æ˜¯topå‘½ä»¤äº†ã€‚</p><p><img src=\"https://static001.geekbang.org/resource/image/d2/37/d2ad570e1fff2a64a1924c2852f93e37.jpg?wh=1494*886\" alt=\"\"></p><p>ä»topå‘½ä»¤æŸ¥çœ‹è¿›ç¨‹çš„å†…å­˜ä½¿ç”¨æƒ…å†µï¼Œå¯ä»¥å‘ç°åœ¨æœºå™¨åªæœ‰8Gå†…å­˜ä¸”åªåˆ†é…äº†4Gå†…å­˜ç»™Javaè¿›ç¨‹çš„æƒ…å†µä¸‹ï¼ŒJavaè¿›ç¨‹å†…å­˜ä½¿ç”¨ç‡å·²ç»è¾¾åˆ°äº†55%ï¼Œå†é€šè¿‡top -Hp pidæŸ¥çœ‹å…·ä½“çº¿ç¨‹å ç”¨ç³»ç»Ÿèµ„æºæƒ…å†µã€‚</p><p><img src=\"https://static001.geekbang.org/resource/image/6f/a7/6fdea40b5ff4f2f0744e019c3bef79a7.jpg?wh=1614*924\" alt=\"\"></p><p>å†é€šè¿‡jstack pidæŸ¥çœ‹å…·ä½“çº¿ç¨‹çš„å †æ ˆä¿¡æ¯ï¼Œå¯ä»¥å‘ç°è¯¥çº¿ç¨‹ä¸€ç›´å¤„äº TIMED_WAITING çŠ¶æ€ï¼Œæ­¤æ—¶CPUä½¿ç”¨ç‡å’Œè´Ÿè½½å¹¶æ²¡æœ‰å‡ºç°å¼‚å¸¸ï¼Œæˆ‘ä»¬å¯ä»¥æ’é™¤æ­»é”æˆ–I/Oé˜»å¡çš„å¼‚å¸¸é—®é¢˜äº†ã€‚</p><p><img src=\"https://static001.geekbang.org/resource/image/4b/87/4bfb58d626f988260e016a2bdf0e8687.jpg?wh=2330*386\" alt=\"\"></p><p>æˆ‘ä»¬å†é€šè¿‡jmapæŸ¥çœ‹å †å†…å­˜çš„ä½¿ç”¨æƒ…å†µï¼Œå¯ä»¥å‘ç°ï¼Œè€å¹´ä»£çš„ä½¿ç”¨ç‡å‡ ä¹å¿«å æ»¡äº†ï¼Œè€Œä¸”å†…å­˜ä¸€ç›´å¾—ä¸åˆ°é‡Šæ”¾ï¼š</p><p><img src=\"https://static001.geekbang.org/resource/image/fe/71/feb358259ea8b3ed2b67e868c101d271.jpg?wh=1350*1304\" alt=\"\"></p><p>é€šè¿‡ä»¥ä¸Šå †å†…å­˜çš„æƒ…å†µï¼Œæˆ‘ä»¬åŸºæœ¬å¯ä»¥åˆ¤æ–­ç³»ç»Ÿå‘ç”Ÿäº†å†…å­˜æ³„æ¼ã€‚ä¸‹é¢æˆ‘ä»¬å°±éœ€è¦æ‰¾åˆ°å…·ä½“æ˜¯ä»€ä¹ˆå¯¹è±¡ä¸€ç›´æ— æ³•å›æ”¶ï¼Œä»€ä¹ˆåŸå› å¯¼è‡´äº†å†…å­˜æ³„æ¼ã€‚</p><p>æˆ‘ä»¬éœ€è¦æŸ¥çœ‹å…·ä½“çš„å †å†…å­˜å¯¹è±¡ï¼Œçœ‹çœ‹æ˜¯å“ªä¸ªå¯¹è±¡å ç”¨äº†å †å†…å­˜ï¼Œå¯ä»¥é€šè¿‡jmapæŸ¥çœ‹å­˜æ´»å¯¹è±¡çš„æ•°é‡ï¼š</p><p><img src=\"https://static001.geekbang.org/resource/image/c5/d9/c5b89deb306a2c470e606fa9c49dd0d9.jpg?wh=1634*776\" alt=\"\"></p><p>Byteå¯¹è±¡å ç”¨å†…å­˜æ˜æ˜¾å¼‚å¸¸ï¼Œè¯´æ˜ä»£ç ä¸­Byteå¯¹è±¡å­˜åœ¨å†…å­˜æ³„æ¼ï¼Œæˆ‘ä»¬åœ¨å¯åŠ¨æ—¶ï¼Œå·²ç»è®¾ç½®äº†dumpæ–‡ä»¶ï¼Œé€šè¿‡MATæ‰“å¼€dumpçš„å†…å­˜æ—¥å¿—æ–‡ä»¶ï¼Œæˆ‘ä»¬å¯ä»¥å‘ç°MATå·²ç»æç¤ºäº†byteå†…å­˜å¼‚å¸¸ï¼š</p><p><img src=\"https://static001.geekbang.org/resource/image/4c/63/4ceb91714afa77b54d1112a0e1f0c863.jpg?wh=1492*1376\" alt=\"\"></p><p>å†ç‚¹å‡»è¿›å…¥åˆ°Histogramé¡µé¢ï¼Œå¯ä»¥æŸ¥çœ‹åˆ°å¯¹è±¡æ•°é‡æ’åºï¼Œæˆ‘ä»¬å¯ä»¥çœ‹åˆ°Byte[]æ•°ç»„æ’åœ¨äº†ç¬¬ä¸€ä½ï¼Œé€‰ä¸­å¯¹è±¡åå³å‡»é€‰æ‹©with incomming referenceåŠŸèƒ½ï¼Œå¯ä»¥æŸ¥çœ‹åˆ°å…·ä½“å“ªä¸ªå¯¹è±¡å¼•ç”¨äº†è¿™ä¸ªå¯¹è±¡ã€‚</p><p><img src=\"https://static001.geekbang.org/resource/image/5a/91/5a651a2f52dfed72712543f7680de091.jpg?wh=1486*1380\" alt=\"\"></p><p>åœ¨è¿™é‡Œæˆ‘ä»¬å°±å¯ä»¥å¾ˆæ˜æ˜¾åœ°æŸ¥çœ‹åˆ°æ˜¯ThreadLocalè¿™å—çš„ä»£ç å‡ºç°äº†é—®é¢˜ã€‚</p><p><img src=\"https://static001.geekbang.org/resource/image/2b/a2/2bed3871097249d64ccf4c79d68109a2.jpg?wh=1498*1380\" alt=\"\"></p><h2>æ€»ç»“</h2><p>åœ¨ä¸€äº›æ¯”è¾ƒç®€å•çš„ä¸šåŠ¡åœºæ™¯ä¸‹ï¼Œæ’æŸ¥ç³»ç»Ÿæ€§èƒ½é—®é¢˜ç›¸å¯¹æ¥è¯´ç®€å•ï¼Œä¸”å®¹æ˜“æ‰¾åˆ°å…·ä½“åŸå› ã€‚ä½†åœ¨ä¸€äº›å¤æ‚çš„ä¸šåŠ¡åœºæ™¯ä¸‹ï¼Œæˆ–æ˜¯ä¸€äº›å¼€æºæ¡†æ¶ä¸‹çš„æºç é—®é¢˜ï¼Œç›¸å¯¹æ¥è¯´å°±å¾ˆéš¾æ’æŸ¥äº†ï¼Œ<span class=\"orange\">æœ‰æ—¶å€™é€šè¿‡å·¥å…·åªèƒ½çŒœæµ‹åˆ°å¯èƒ½æ˜¯æŸäº›åœ°æ–¹å‡ºç°äº†é—®é¢˜ï¼Œè€Œå®é™…æ’æŸ¥åˆ™è¦ç»“åˆæºç åšå…·ä½“åˆ†æã€‚</span></p><p>å¯ä»¥è¯´æ²¡æœ‰æ·å¾„ï¼Œæ’æŸ¥çº¿ä¸Šçš„æ€§èƒ½é—®é¢˜æœ¬èº«å°±ä¸æ˜¯ä¸€ä»¶å¾ˆç®€å•çš„äº‹æƒ…ï¼Œé™¤äº†å°†ä»Šå¤©ä»‹ç»çš„è¿™äº›å·¥å…·èä¼šè´¯é€šï¼Œè¿˜éœ€è¦æˆ‘ä»¬ä¸æ–­åœ°å»ç´¯ç§¯ç»éªŒï¼ŒçœŸæ­£åšåˆ°æ€§èƒ½è°ƒä¼˜ã€‚</p><h2>æ€è€ƒé¢˜</h2><p>é™¤äº†ä»¥ä¸Šæˆ‘è®²åˆ°çš„é‚£äº›æ’æŸ¥å†…å­˜æ€§èƒ½ç“¶é¢ˆçš„å·¥å…·ä¹‹å¤–ï¼Œä½ çŸ¥é“è¦åœ¨ä»£ç ä¸­å¯¹JVMçš„å†…å­˜è¿›è¡Œç›‘æ§ï¼Œå¸¸ç”¨çš„æ–¹æ³•æ˜¯ä»€ä¹ˆï¼Ÿ</p><p>æœŸå¾…åœ¨ç•™è¨€åŒºçœ‹åˆ°ä½ çš„åˆ†äº«ã€‚ä¹Ÿæ¬¢è¿ä½ ç‚¹å‡»â€œè¯·æœ‹å‹è¯»â€ï¼ŒæŠŠä»Šå¤©çš„å†…å®¹åˆ†äº«ç»™èº«è¾¹çš„æœ‹å‹ï¼Œé‚€è¯·ä»–ä¸€èµ·è®¨è®ºã€‚</p><p></p>","neighbors":{"left":{"article_title":"24 | å¦‚ä½•ä¼˜åŒ–JVMå†…å­˜åˆ†é…ï¼Ÿ","id":108139},"right":{"article_title":"26 | ç­”ç–‘è¯¾å ‚ï¼šæ¨¡å—å››çƒ­ç‚¹é—®é¢˜è§£ç­”","id":109201}},"comments":[{"had_liked":false,"id":114989,"user_name":"æ¯å¤©æ™’ç™½ç‰™","can_delete":false,"product_type":"c1","uid":1004698,"ip_address":"","ucode":"A1B102CD933DEA","user_header":"https://static001.geekbang.org/account/avatar/00/0f/54/9a/76c0af70.jpg","comment_is_top":false,"comment_ctime":1563444388,"is_pvip":false,"replies":[{"id":"42351","content":"èµï¼","user_name":"ä½œè€…å›å¤","user_name_real":"åˆ˜è¶…","uid":"1228576","ctime":1563760025,"ip_address":"","comment_id":114989,"utype":1}],"discussion_count":10,"race_medal":1,"score":"383815533732","product_id":100028001,"comment_content":"æ”¾ä¸¤ç¯‡è‡ªå·±åœ¨å·¥ä½œä¸­æ’æŸ¥JVMé—®é¢˜çš„ä¸¤ç¯‡æ–‡ç« ã€éå¹¿å‘Šï¼Œçº¯æŠ€æœ¯æ–‡ã€‘<br>https:&#47;&#47;mp.weixin.qq.com&#47;s&#47;ji_8NhN4NnEHrfAlA9X_ag<br><br>https:&#47;&#47;mp.weixin.qq.com&#47;s&#47;IPi3xiordGh-zcSSRie6nA","like_count":90,"discussions":[{"author":{"id":1228576,"avatar":"https://static001.geekbang.org/account/avatar/00/12/bf/20/19d42715.jpg","nickname":"åˆ˜è¶…","note":"","ucode":"CD56F93596E818","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":458917,"discussion_content":"èµï¼","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1563760025,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1308783,"avatar":"https://static001.geekbang.org/account/avatar/00/13/f8/6f/080973cf.jpg","nickname":"Edward","note":"","ucode":"10FAADF92D05F4","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":335391,"discussion_content":"mark","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1608181315,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":2157237,"avatar":"https://static001.geekbang.org/account/avatar/00/20/ea/b5/f99c1ad3.jpg","nickname":"å®¸è¡","note":"","ucode":"8F6B15B3070963","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":306775,"discussion_content":"æ„Ÿè°¢","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1600387693,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1937062,"avatar":"https://static001.geekbang.org/account/avatar/00/1d/8e/a6/c3286b61.jpg","nickname":"Javaå’å¢™å·¥ç¨‹å¸ˆ","note":"","ucode":"E76AE44A9C76AE","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":302826,"discussion_content":"å›¾å…¨éƒ¨çœ‹ä¸æ¸…ï¼Œå¹²å˜›å†™åœ¨å¾®ä¿¡é‡Œ","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1599039465,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1131531,"avatar":"https://static001.geekbang.org/account/avatar/00/11/44/0b/642c6f7b.jpg","nickname":"å‘¨èè","note":"","ucode":"393A904F5A0A3B","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":114606,"discussion_content":"åº”ç”¨åœ¨dockerä¸­ï¼Œæ€ä¹ˆæ’æŸ¥å‘¢ï¼Ÿ","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1577975089,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1274220,"avatar":"http://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTKyyEahkmw06SxQDbpST6m5TcbBlnJMVP4zXFQjIRvyfIrT80RRiaHoBiaBq2bddUUEiaXIz8hkooCIw/132","nickname":"13524265609","note":"","ucode":"441F3A2A4D6146","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":37635,"discussion_content":"å¦‚æœdumpæ–‡ä»¶å¤ªå¤§ï¼ŒåŠ è½½ä¸äº†ï¼Œè¯¥å¦‚ä½•åˆ†æå‘¢ï¼Ÿ","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1571649524,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":2,"child_discussions":[{"author":{"id":1004698,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/54/9a/76c0af70.jpg","nickname":"æ¯å¤©æ™’ç™½ç‰™","note":"","ucode":"A1B102CD933DEA","race_medal":1,"user_type":1,"is_pvip":false},"reply_author":{"id":1274220,"avatar":"http://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTKyyEahkmw06SxQDbpST6m5TcbBlnJMVP4zXFQjIRvyfIrT80RRiaHoBiaBq2bddUUEiaXIz8hkooCIw/132","nickname":"13524265609","note":"","ucode":"441F3A2A4D6146","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":37918,"discussion_content":"ä½ æ˜¯è¯´å·²ç»æŠŠdumpä¸‹è½½äº†ï¼Œä½†å› ä¸ºå¤ªå¤§åŠ è½½ä¸äº†å—ï¼Ÿè¿™ç§æˆ‘ä¸€èˆ¬é‡å¯ç”µè„‘ï¼ŒæŠŠå…¶ä»–åº”ç”¨éƒ½å…³äº†ã€‚ç»™åˆ†ædumpæ–‡ä»¶çš„è½¯ä»¶ç•™å‡ºè¶³å¤Ÿçš„å†…å­˜ï¼Œå¦‚æœè¿˜ä¸è¡Œï¼Œæˆ‘è¿˜æ²¡æœ‰å¥½åŠæ³•","likes_number":3,"is_delete":false,"is_hidden":false,"ctime":1571700914,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":37635,"ip_address":""},"score":37918,"extra":""},{"author":{"id":2664121,"avatar":"https://static001.geekbang.org/account/avatar/00/28/a6/b9/6bdaf8ce.jpg","nickname":"rich_li","note":"","ucode":"B82495DDC942DC","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":1274220,"avatar":"http://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTKyyEahkmw06SxQDbpST6m5TcbBlnJMVP4zXFQjIRvyfIrT80RRiaHoBiaBq2bddUUEiaXIz8hkooCIw/132","nickname":"13524265609","note":"","ucode":"441F3A2A4D6146","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":408085,"discussion_content":"åŠ è½½ä¸æ¥ï¼Œé‚£ä¸å°±æ˜¯å†…å­˜ä¸å¤Ÿäº†ï¼ŒæŠŠå…¶ä»–åº”ç”¨å å†…å­˜å…³äº†ï¼Œå®åœ¨ä¸è¡Œå°±åŠ å†…å­˜æ¡ï¼Œç›®å‰å¼€å‘æœºåŸºæœ¬éƒ½æ˜¯16èµ·æ­¥äº†ã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1635173629,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":37635,"ip_address":""},"score":408085,"extra":""}]},{"author":{"id":1198816,"avatar":"https://static001.geekbang.org/account/avatar/00/12/4a/e0/eff34583.jpg","nickname":"é©¬è¶…","note":"","ucode":"FAFF55DC5DD15C","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":4509,"discussion_content":"è²Œä¼¼ç”¨çš„xflush","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1565504240,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1259218,"avatar":"https://static001.geekbang.org/account/avatar/00/13/36/d2/c7357723.jpg","nickname":"å‘æ¡æ©™å­ ã€‚","note":"","ucode":"ED076F4534FFED","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":3107,"discussion_content":"Markäº†","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1564193275,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":115062,"user_name":"æˆ‘å·²ç»è®¾ç½®äº†æ˜µç§°","can_delete":false,"product_type":"c1","uid":1364034,"ip_address":"","ucode":"ED672C5EBDBDC4","user_header":"https://static001.geekbang.org/account/avatar/00/14/d0/42/6fd01fb9.jpg","comment_is_top":false,"comment_ctime":1563464378,"is_pvip":false,"replies":[{"id":"42077","content":"æˆ‘ä»¬çŸ¥é“ï¼ŒThreadLocalæ˜¯åŸºäºThreadLocalMapå®ç°çš„ï¼Œè¿™ä¸ªMapçš„Entryç»§æ‰¿äº†WeakReferenceï¼Œè€ŒEntryå¯¹è±¡ä¸­çš„keyä½¿ç”¨äº†WeakReferenceå°è£…ï¼Œä¹Ÿå°±æ˜¯è¯´Entryä¸­çš„keyæ˜¯ä¸€ä¸ªå¼±å¼•ç”¨ç±»å‹ï¼Œè€Œå¼±å¼•ç”¨ç±»å‹åªèƒ½å­˜æ´»åœ¨ä¸‹æ¬¡GCä¹‹å‰ã€‚<br><br>å¦‚æœä¸€ä¸ªçº¿ç¨‹è°ƒç”¨ThreadLocalçš„setè®¾ç½®å˜é‡ï¼Œå½“å‰ThreadLocalMapåˆ™æ–°å¢ä¸€æ¡è®°å½•ï¼Œæ­¤æ—¶ThreadLocalå®ä¾‹æ²¡æœ‰å¤–éƒ¨å¼ºå¼•ç”¨ï¼Œå½“å‘ç”Ÿä¸€æ¬¡åƒåœ¾å›æ”¶ï¼Œæ­¤æ—¶keyå€¼è¢«å›æ”¶ï¼Œè€Œvalueå€¼ä¾ç„¶å­˜åœ¨å†…å­˜ä¸­ï¼Œç”±äºå½“å‰çº¿ç¨‹ä¸€ç›´å­˜åœ¨ï¼Œæ‰€ä»¥valueå€¼å°†ä¸€ç›´è¢«å¼•ç”¨ã€‚.<br><br>è¿™äº›è¢«åƒåœ¾å›æ”¶æ‰çš„keyå°±å­˜åœ¨ä¸€æ¡å¼•ç”¨é“¾çš„å…³ç³»ä¸€ç›´å­˜åœ¨ï¼šThread --&gt; ThreadLocalMap--&gt;Entry--&gt;Valueï¼Œè¿™æ¡å¼•ç”¨é“¾ä¼šå¯¼è‡´Entryä¸ä¼šå›æ”¶ï¼ŒValueä¹Ÿä¸ä¼šå›æ”¶ï¼Œä½†Entryä¸­çš„Keyå´å·²ç»è¢«å›æ”¶çš„æƒ…å†µï¼Œé€ æˆå†…å­˜æ³„æ¼ã€‚<br><br>æˆ‘ä»¬åªéœ€è¦åœ¨ä½¿ç”¨å®Œè¯¥keyå€¼ä¹‹åï¼Œé€šè¿‡removeæ–¹æ³•removeæ‰ï¼Œå°±å¯ä»¥é˜²æ­¢å†…å­˜æ³„æ¼äº†ã€‚","user_name":"ä½œè€…å›å¤","user_name_real":"åˆ˜è¶…","uid":"1228576","ctime":1563513651,"ip_address":"","comment_id":115062,"utype":1}],"discussion_count":11,"race_medal":0,"score":"302211175098","product_id":100028001,"comment_content":"è€å¸ˆæ˜¯å¦å¯ä»¥è®²ä¸‹å¦‚ä½•é¿å…threadLocalå†…å­˜æ³„æ¼å‘¢","like_count":71,"discussions":[{"author":{"id":1228576,"avatar":"https://static001.geekbang.org/account/avatar/00/12/bf/20/19d42715.jpg","nickname":"åˆ˜è¶…","note":"","ucode":"CD56F93596E818","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":458951,"discussion_content":"æˆ‘ä»¬çŸ¥é“ï¼ŒThreadLocalæ˜¯åŸºäºThreadLocalMapå®ç°çš„ï¼Œè¿™ä¸ªMapçš„Entryç»§æ‰¿äº†WeakReferenceï¼Œè€ŒEntryå¯¹è±¡ä¸­çš„keyä½¿ç”¨äº†WeakReferenceå°è£…ï¼Œä¹Ÿå°±æ˜¯è¯´Entryä¸­çš„keyæ˜¯ä¸€ä¸ªå¼±å¼•ç”¨ç±»å‹ï¼Œè€Œå¼±å¼•ç”¨ç±»å‹åªèƒ½å­˜æ´»åœ¨ä¸‹æ¬¡GCä¹‹å‰ã€‚\n\nå¦‚æœä¸€ä¸ªçº¿ç¨‹è°ƒç”¨ThreadLocalçš„setè®¾ç½®å˜é‡ï¼Œå½“å‰ThreadLocalMapåˆ™æ–°å¢ä¸€æ¡è®°å½•ï¼Œæ­¤æ—¶ThreadLocalå®ä¾‹æ²¡æœ‰å¤–éƒ¨å¼ºå¼•ç”¨ï¼Œå½“å‘ç”Ÿä¸€æ¬¡åƒåœ¾å›æ”¶ï¼Œæ­¤æ—¶keyå€¼è¢«å›æ”¶ï¼Œè€Œvalueå€¼ä¾ç„¶å­˜åœ¨å†…å­˜ä¸­ï¼Œç”±äºå½“å‰çº¿ç¨‹ä¸€ç›´å­˜åœ¨ï¼Œæ‰€ä»¥valueå€¼å°†ä¸€ç›´è¢«å¼•ç”¨ã€‚.\n\nè¿™äº›è¢«åƒåœ¾å›æ”¶æ‰çš„keyå°±å­˜åœ¨ä¸€æ¡å¼•ç”¨é“¾çš„å…³ç³»ä¸€ç›´å­˜åœ¨ï¼šThread --&amp;gt; ThreadLocalMap--&amp;gt;Entry--&amp;gt;Valueï¼Œè¿™æ¡å¼•ç”¨é“¾ä¼šå¯¼è‡´Entryä¸ä¼šå›æ”¶ï¼ŒValueä¹Ÿä¸ä¼šå›æ”¶ï¼Œä½†Entryä¸­çš„Keyå´å·²ç»è¢«å›æ”¶çš„æƒ…å†µï¼Œé€ æˆå†…å­˜æ³„æ¼ã€‚\n\næˆ‘ä»¬åªéœ€è¦åœ¨ä½¿ç”¨å®Œè¯¥keyå€¼ä¹‹åï¼Œé€šè¿‡removeæ–¹æ³•removeæ‰ï¼Œå°±å¯ä»¥é˜²æ­¢å†…å­˜æ³„æ¼äº†ã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1563513651,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1369447,"avatar":"https://static001.geekbang.org/account/avatar/00/14/e5/67/16322a5d.jpg","nickname":"cky.å®‡","note":"","ucode":"93A3EAD9D50A5F","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":51561,"discussion_content":"ä¸€èˆ¬æ˜¯åœ¨ç”¨çº¿ç¨‹æ± çš„æƒ…å†µä¸‹ï¼Œä¼šé‡å¤ä½¿ç”¨åŒä¸€ä¸ªçº¿ç¨‹ï¼Œçº¿ç¨‹çš„keyè¢«å›æ”¶äº†ï¼Œvalueç”±äºçº¿ç¨‹æ²¡ç»“æŸé€ æˆvalueä¸€ç›´è¢«å¼•ç”¨é€ æˆå†…å­˜æ³„æ¼ã€‚","likes_number":6,"is_delete":false,"is_hidden":false,"ctime":1573898950,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1676060,"avatar":"https://static001.geekbang.org/account/avatar/00/19/93/1c/206b3d9f.jpg","nickname":"å°æ™º","note":"","ucode":"3B6AE5E0E12D6A","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":311407,"discussion_content":"ä½¿ç”¨å±€éƒ¨å˜é‡äº†ï¼Œå°±æ²¡å¿…è¦ä½¿ç”¨threadlocaläº†","likes_number":1,"is_delete":false,"is_hidden":false,"ctime":1602330595,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1125511,"avatar":"https://static001.geekbang.org/account/avatar/00/11/2c/87/9a3d80dc.jpg","nickname":"æ˜¨å¤œçš„æŸ æª¬","note":"","ucode":"C5829C29FB3E34","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":40310,"discussion_content":"è€å¸ˆï¼Œæ­£å¸¸æƒ…å†µThreadLocaléƒ½åº”è¯¥ä¼šæœ‰å¤–éƒ¨å¼ºå¼•ç”¨å•Šï¼Œä¸ä¼šè¢«å›æ”¶ï¼Œä»€ä¹ˆæƒ…å†µä¸‹æ‰ä¼šå‡ºç°nullè¢«å›æ”¶ï¼Ÿ","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1572158927,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":2,"child_discussions":[{"author":{"id":1228576,"avatar":"https://static001.geekbang.org/account/avatar/00/12/bf/20/19d42715.jpg","nickname":"åˆ˜è¶…","note":"","ucode":"CD56F93596E818","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":1125511,"avatar":"https://static001.geekbang.org/account/avatar/00/11/2c/87/9a3d80dc.jpg","nickname":"æ˜¨å¤œçš„æŸ æª¬","note":"","ucode":"C5829C29FB3E34","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":73959,"discussion_content":"å¦‚æœThreadLocalæ˜¯å…¨å±€çš„ï¼Œæœ‰å¤–éƒ¨å¼ºå¼•ç”¨ï¼Œæ˜¯ä¸ä¼šå›æ”¶çš„ï¼›è€Œå¦‚æœThreadLocalå®ä¾‹ä½œä¸ºä¸€ä¸ªå±€éƒ¨å˜é‡ï¼Œæ–¹æ³•ç»“æŸäº†ï¼Œå°±ä¼šè¢«å›æ”¶","likes_number":5,"is_delete":false,"is_hidden":false,"ctime":1575617366,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":40310,"ip_address":""},"score":73959,"extra":""},{"author":{"id":1181650,"avatar":"https://static001.geekbang.org/account/avatar/00/12/07/d2/0d7ee298.jpg","nickname":"æƒ˜ é—»","note":"","ucode":"C5909F034BF072","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":1228576,"avatar":"https://static001.geekbang.org/account/avatar/00/12/bf/20/19d42715.jpg","nickname":"åˆ˜è¶…","note":"","ucode":"CD56F93596E818","race_medal":0,"user_type":2,"is_pvip":false},"discussion":{"id":338274,"discussion_content":"è€å¸ˆè¯´çš„è¿™ä¸ªå…¨å±€æ˜¯ä»€ä¹ˆæ„æ€å‘€ï¼Œåœ¨ç±»ä¸­ä½œä¸ºæˆå‘˜å˜é‡å—ï¼Ÿ","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1609229642,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":73959,"ip_address":""},"score":338274,"extra":""}]},{"author":{"id":1009652,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/67/f4/9a1feb59.jpg","nickname":"é’±","note":"","ucode":"2C92A243A463D4","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":9898,"discussion_content":"æˆ‘ä»¬çš„é¡¹ç›®ä¸­ç”¨çš„å¤šï¼Œä¸è¿‡åˆ°ç›®å‰ä¸ºæ­¢è¿˜æœªæ›¾é‡è§å› å…¶å¯¼è‡´çš„å†…å­˜æ³„éœ²é—®é¢˜ã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1568240482,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":4,"child_discussions":[{"author":{"id":1228576,"avatar":"https://static001.geekbang.org/account/avatar/00/12/bf/20/19d42715.jpg","nickname":"åˆ˜è¶…","note":"","ucode":"CD56F93596E818","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":1009652,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/67/f4/9a1feb59.jpg","nickname":"é’±","note":"","ucode":"2C92A243A463D4","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":73965,"discussion_content":"åªæœ‰ThreadLocalå®ä¾‹åœ¨ä½¿ç”¨å®Œåç«‹å³è¢«ç½®ä¸ºnullæˆ–è€…å›æ”¶æ‰çš„æƒ…å†µä¸‹ï¼ˆä¸€èˆ¬ThreadLocalå®ä¾‹éƒ½æ˜¯å…¨å±€çš„ï¼Œä¸ä¼šå‡ºç°è¿™ç§æƒ…å†µï¼‰ï¼Œä¸”ä½¿ç”¨äº†çº¿ç¨‹æ± ï¼Œä¼šå‡ºç°å†…å­˜æ³„æ¼é—®é¢˜ã€‚","likes_number":3,"is_delete":false,"is_hidden":false,"ctime":1575617732,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":9898,"ip_address":""},"score":73965,"extra":""},{"author":{"id":1108761,"avatar":"https://static001.geekbang.org/account/avatar/00/10/eb/19/76b0b98c.jpg","nickname":"torres","note":"","ucode":"34DABCFC7B74EA","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":1228576,"avatar":"https://static001.geekbang.org/account/avatar/00/12/bf/20/19d42715.jpg","nickname":"åˆ˜è¶…","note":"","ucode":"CD56F93596E818","race_medal":0,"user_type":2,"is_pvip":false},"discussion":{"id":359887,"discussion_content":"è€å¸ˆï¼Œè¯·é—®ä¸€ä¸‹ï¼Œå‰é¢åŠå¥æˆ‘ç†è§£ï¼Œä¸ºä»€ä¹ˆä¸”ä½¿ç”¨çº¿ç¨‹æ± æ‰ä¼šæœ‰å†…å­˜æ³„éœ²çš„é—®é¢˜ï¼Ÿ","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1616317984,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":73965,"ip_address":""},"score":359887,"extra":""},{"author":{"id":1053772,"avatar":"https://static001.geekbang.org/account/avatar/00/10/14/4c/c581813b.jpg","nickname":"ä¸­å­¦ç”Ÿ","note":"","ucode":"C9B9FB6DBFC628","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":1108761,"avatar":"https://static001.geekbang.org/account/avatar/00/10/eb/19/76b0b98c.jpg","nickname":"torres","note":"","ucode":"34DABCFC7B74EA","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":380850,"discussion_content":"çº¿ç¨‹è¢«å¤ç”¨ï¼ŒThreadLocalMapä¹Ÿå°±ä¸ä¼šè¢«å›æ”¶ã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1624726933,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":359887,"ip_address":""},"score":380850,"extra":""}]}]},{"had_liked":false,"id":115020,"user_name":"WL","can_delete":false,"product_type":"c1","uid":1173771,"ip_address":"","ucode":"6277DCD776B87E","user_header":"https://static001.geekbang.org/account/avatar/00/11/e9/0b/1171ac71.jpg","comment_is_top":false,"comment_ctime":1563454751,"is_pvip":false,"replies":[{"id":"42079","content":"å†…å­˜æ³„æ¼æ˜¯æŒ‡ä¸å†ä½¿ç”¨çš„å¯¹è±¡æ— æ³•å¾—åˆ°åŠæ—¶çš„å›æ”¶ï¼ŒæŒç»­å ç”¨å†…å­˜ç©ºé—´ï¼Œä»è€Œé€ æˆå†…å­˜ç©ºé—´çš„æµªè´¹ã€‚ä¾‹å¦‚ï¼Œæˆ‘ä»¬ä¹‹å‰åœ¨ç¬¬3è®²ä¸­èŠåˆ°çš„åœ¨Java6ä¸­substringæ–¹æ³•å¯èƒ½ä¼šå¯¼è‡´å†…å­˜æ³„æ¼æƒ…å†µå‘ç”Ÿã€‚å½“è°ƒç”¨substringæ–¹æ³•æ—¶ä¼šè°ƒç”¨new stringæ„é€ å‡½æ•°ï¼Œæ­¤æ—¶ä¼šå¤ç”¨åŸæ¥å­—ç¬¦ä¸²çš„charæ•°ç»„ï¼Œè€Œå¦‚æœæˆ‘ä»¬ä»…ä»…æ˜¯ç”¨substringè·å–ä¸€å°æ®µå­—ç¬¦ï¼Œè€ŒåŸæœ¬stringå­—ç¬¦ä¸²éå¸¸å¤§çš„æƒ…å†µä¸‹ï¼Œsubstringçš„å¯¹è±¡å¦‚æœä¸€ç›´è¢«å¼•ç”¨ï¼Œç”±äºsubstringçš„é‡Œé¢çš„charæ•°ç»„ä»ç„¶æŒ‡å‘åŸå­—ç¬¦ä¸²ï¼Œæ­¤æ—¶stringå­—ç¬¦ä¸²ä¹Ÿæ— æ³•å›æ”¶ï¼Œä»è€Œå¯¼è‡´å†…å­˜æ³„éœ²ã€‚<br><br>å†…å­˜æº¢å‡ºåˆ™æ˜¯å‘ç”Ÿäº†OutOfMemoryExceptionï¼Œå†…å­˜æº¢å‡ºçš„æƒ…å†µæœ‰å¾ˆå¤šï¼Œä¾‹å¦‚å †å†…å­˜ç©ºé—´ä¸è¶³ï¼Œæ ˆç©ºé—´ä¸è¶³ï¼Œä»¥åŠæ–¹æ³•åŒºç©ºé—´ä¸è¶³éƒ½ä¼šå‘ç”Ÿå†…å­˜æº¢å‡ºå¼‚å¸¸ã€‚<br><br>å†…å­˜æ³„æ¼ä¸å†…å­˜æº¢å‡ºçš„å…³ç³»ï¼šå†…å­˜æ³„æ¼å¾ˆå®¹æ˜“å¯¼è‡´å†…å­˜æº¢å‡ºï¼Œä½†å†…å­˜æº¢å‡ºä¸ä¸€å®šæ˜¯å†…å­˜æ³„æ¼å¯¼è‡´çš„ã€‚","user_name":"ä½œè€…å›å¤","user_name_real":"åˆ˜è¶…","uid":"1228576","ctime":1563513720,"ip_address":"","comment_id":115020,"utype":1}],"discussion_count":2,"race_medal":0,"score":"139002408223","product_id":100028001,"comment_content":"è¯·é—®ä¸€ä¸‹è€å¸ˆå†…å­˜æ³„éœ²å’Œå†…å­˜æº¢å‡ºå…·ä½“æœ‰å•¥åŒºåˆ«ï¼Œæœ‰ç‚¹ä¸å¤ªç†è§£å†…å­˜æ³„éœ²çš„æ¦‚å¿µã€‚","like_count":33,"discussions":[{"author":{"id":1228576,"avatar":"https://static001.geekbang.org/account/avatar/00/12/bf/20/19d42715.jpg","nickname":"åˆ˜è¶…","note":"","ucode":"CD56F93596E818","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":458931,"discussion_content":"å†…å­˜æ³„æ¼æ˜¯æŒ‡ä¸å†ä½¿ç”¨çš„å¯¹è±¡æ— æ³•å¾—åˆ°åŠæ—¶çš„å›æ”¶ï¼ŒæŒç»­å ç”¨å†…å­˜ç©ºé—´ï¼Œä»è€Œé€ æˆå†…å­˜ç©ºé—´çš„æµªè´¹ã€‚ä¾‹å¦‚ï¼Œæˆ‘ä»¬ä¹‹å‰åœ¨ç¬¬3è®²ä¸­èŠåˆ°çš„åœ¨Java6ä¸­substringæ–¹æ³•å¯èƒ½ä¼šå¯¼è‡´å†…å­˜æ³„æ¼æƒ…å†µå‘ç”Ÿã€‚å½“è°ƒç”¨substringæ–¹æ³•æ—¶ä¼šè°ƒç”¨new stringæ„é€ å‡½æ•°ï¼Œæ­¤æ—¶ä¼šå¤ç”¨åŸæ¥å­—ç¬¦ä¸²çš„charæ•°ç»„ï¼Œè€Œå¦‚æœæˆ‘ä»¬ä»…ä»…æ˜¯ç”¨substringè·å–ä¸€å°æ®µå­—ç¬¦ï¼Œè€ŒåŸæœ¬stringå­—ç¬¦ä¸²éå¸¸å¤§çš„æƒ…å†µä¸‹ï¼Œsubstringçš„å¯¹è±¡å¦‚æœä¸€ç›´è¢«å¼•ç”¨ï¼Œç”±äºsubstringçš„é‡Œé¢çš„charæ•°ç»„ä»ç„¶æŒ‡å‘åŸå­—ç¬¦ä¸²ï¼Œæ­¤æ—¶stringå­—ç¬¦ä¸²ä¹Ÿæ— æ³•å›æ”¶ï¼Œä»è€Œå¯¼è‡´å†…å­˜æ³„éœ²ã€‚\n\nå†…å­˜æº¢å‡ºåˆ™æ˜¯å‘ç”Ÿäº†OutOfMemoryExceptionï¼Œå†…å­˜æº¢å‡ºçš„æƒ…å†µæœ‰å¾ˆå¤šï¼Œä¾‹å¦‚å †å†…å­˜ç©ºé—´ä¸è¶³ï¼Œæ ˆç©ºé—´ä¸è¶³ï¼Œä»¥åŠæ–¹æ³•åŒºç©ºé—´ä¸è¶³éƒ½ä¼šå‘ç”Ÿå†…å­˜æº¢å‡ºå¼‚å¸¸ã€‚\n\nå†…å­˜æ³„æ¼ä¸å†…å­˜æº¢å‡ºçš„å…³ç³»ï¼šå†…å­˜æ³„æ¼å¾ˆå®¹æ˜“å¯¼è‡´å†…å­˜æº¢å‡ºï¼Œä½†å†…å­˜æº¢å‡ºä¸ä¸€å®šæ˜¯å†…å­˜æ³„æ¼å¯¼è‡´çš„ã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1563513720,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1669273,"avatar":"https://static001.geekbang.org/account/avatar/00/19/78/99/6060eb2d.jpg","nickname":"å¹³å‡¡ä¹‹è·¯","note":"","ucode":"96CE12339BD5FD","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":63920,"discussion_content":"è€å¸ˆè§£å¼€å¤šå¹´çš„ç–‘æƒ‘ï¼Œèµ","likes_number":1,"is_delete":false,"is_hidden":false,"ctime":1574922056,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":135248,"user_name":"æ€ªç›—ã‚­ãƒƒãƒ‰","can_delete":false,"product_type":"c1","uid":1048065,"ip_address":"","ucode":"D96BC268F5FB6C","user_header":"https://static001.geekbang.org/account/avatar/00/0f/fe/01/3f3ae95e.jpg","comment_is_top":false,"comment_ctime":1569084077,"is_pvip":false,"replies":[{"id":"53069","content":"ğŸ‘","user_name":"ä½œè€…å›å¤","user_name_real":"åˆ˜è¶…","uid":"1228576","ctime":1569981184,"ip_address":"","comment_id":135248,"utype":1}],"discussion_count":2,"race_medal":0,"score":"74583528109","product_id":100028001,"comment_content":"æˆ‘å¼€æºäº†ä¸€ä¸ª Java æ€§èƒ½ç›‘æ§å·¥å…·ï¼Œå°±æ˜¯ç”¨ JDK è‡ªå¸¦çš„æ¥å£å®ç°çš„ã€‚<br>GitHub åœ°å€ï¼šhttps:&#47;&#47;github.com&#47;LinShunKang&#47;MyPerf4J","like_count":18,"discussions":[{"author":{"id":1228576,"avatar":"https://static001.geekbang.org/account/avatar/00/12/bf/20/19d42715.jpg","nickname":"åˆ˜è¶…","note":"","ucode":"CD56F93596E818","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":468111,"discussion_content":"ğŸ‘","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1569981184,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":2060756,"avatar":"","nickname":"åœ¨ä¸‹èŸ‘è‚ç‹","note":"","ucode":"E66A65A327095A","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":331563,"discussion_content":"Mark","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1606901585,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":120469,"user_name":"åˆ˜å¤©è‹¥Warner","can_delete":false,"product_type":"c1","uid":1216848,"ip_address":"","ucode":"032639CD670DA3","user_header":"https://static001.geekbang.org/account/avatar/00/12/91/50/e576a068.jpg","comment_is_top":false,"comment_ctime":1564909163,"is_pvip":false,"replies":[{"id":"44503","content":"æ­£å¸¸æƒ…å†µä¸‹ï¼Œå¦‚æœä¸€ä¸ªçº¿ç¨‹setä¹‹åï¼Œè¯¥çº¿ç¨‹é”€æ¯äº†ï¼Œç„¶åkeyå€¼ç”±äºå¼±å¼•ç”¨åˆšå¥½é‡åˆ°ä¸€æ¬¡GCï¼Œè¢«å›æ”¶äº†ï¼Œæ­¤æ—¶valueå·²ç»å‡ºç°å†…å­˜æ³„æ¼ã€‚è€Œthreadlocalä¸ºäº†è§£å†³è¿™ä¸ªé—®é¢˜ï¼Œåœ¨åé¢çš„çº¿ç¨‹è¿›è¡Œsetæ—¶ï¼Œä¼šæŠŠä¹‹å‰keyå€¼ä¸ºnullçš„valueæ¸…ç©ºæ‰ï¼Œæ‰€ä»¥å°±ä¸ä¼šå‡ºç°å¤§é‡å†…å­˜æ³„æ¼äº†ã€‚<br><br>æ‰€ä»¥æˆ‘ä»¬è¦æ¨¡æ‹Ÿçš„å°±æ˜¯ï¼Œåœ¨åé¢è¿›æ¥çš„çº¿ç¨‹setä¹‹å‰ï¼Œä¿è¯ä¹‹å‰çš„çº¿ç¨‹è¿˜æ²¡æœ‰é”€æ¯ï¼Œä¹‹å‰çš„key valueå°±ä¼šä¿æŒï¼Œè¿™æ ·æˆ‘ä»¬èƒ½æ¨¡æ‹Ÿå‡ºå¤§é‡valueå†…å­˜æ³„æ¼çš„æƒ…å†µå‡ºç°ã€‚","user_name":"ä½œè€…å›å¤","user_name_real":"åˆ˜è¶…","uid":"1228576","ctime":1565059926,"ip_address":"","comment_id":120469,"utype":1}],"discussion_count":3,"race_medal":0,"score":"48809549419","product_id":100028001,"comment_content":"è€å¸ˆï¼Œä¸ºä»€ä¹ˆçº¿ç¨‹è¦sleepä¸€ä¸‹ï¼Œçœ‹äº†æ³¨é‡Šè¿˜æ˜¯ä¸ç†è§£ï¼Œæ±‚å‘ŠçŸ¥","like_count":12,"discussions":[{"author":{"id":1228576,"avatar":"https://static001.geekbang.org/account/avatar/00/12/bf/20/19d42715.jpg","nickname":"åˆ˜è¶…","note":"","ucode":"CD56F93596E818","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":461347,"discussion_content":"æ­£å¸¸æƒ…å†µä¸‹ï¼Œå¦‚æœä¸€ä¸ªçº¿ç¨‹setä¹‹åï¼Œè¯¥çº¿ç¨‹é”€æ¯äº†ï¼Œç„¶åkeyå€¼ç”±äºå¼±å¼•ç”¨åˆšå¥½é‡åˆ°ä¸€æ¬¡GCï¼Œè¢«å›æ”¶äº†ï¼Œæ­¤æ—¶valueå·²ç»å‡ºç°å†…å­˜æ³„æ¼ã€‚è€Œthreadlocalä¸ºäº†è§£å†³è¿™ä¸ªé—®é¢˜ï¼Œåœ¨åé¢çš„çº¿ç¨‹è¿›è¡Œsetæ—¶ï¼Œä¼šæŠŠä¹‹å‰keyå€¼ä¸ºnullçš„valueæ¸…ç©ºæ‰ï¼Œæ‰€ä»¥å°±ä¸ä¼šå‡ºç°å¤§é‡å†…å­˜æ³„æ¼äº†ã€‚\n\næ‰€ä»¥æˆ‘ä»¬è¦æ¨¡æ‹Ÿçš„å°±æ˜¯ï¼Œåœ¨åé¢è¿›æ¥çš„çº¿ç¨‹setä¹‹å‰ï¼Œä¿è¯ä¹‹å‰çš„çº¿ç¨‹è¿˜æ²¡æœ‰é”€æ¯ï¼Œä¹‹å‰çš„key valueå°±ä¼šä¿æŒï¼Œè¿™æ ·æˆ‘ä»¬èƒ½æ¨¡æ‹Ÿå‡ºå¤§é‡valueå†…å­˜æ³„æ¼çš„æƒ…å†µå‡ºç°ã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1565059926,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":2548016,"avatar":"https://static001.geekbang.org/account/avatar/00/26/e1/30/56151c95.jpg","nickname":"å¾å¤§é›·","note":"","ucode":"4D6F0D4C58CE93","race_medal":1,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":411061,"discussion_content":"æ²¡çœ‹åˆ°","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1635840342,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1024294,"avatar":"http://thirdwx.qlogo.cn/mmopen/vi_32/PiajxSqBRaELZPnUAiajaR5C25EDLWeJURggyiaOP5GGPe2qlwpQcm5e3ybib8OsP4tvddFDLVRSNNGL5I3SFPJHsA/132","nickname":"null","note":"","ucode":"F9039EFED6B55D","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":371220,"discussion_content":"åœ¨å“ª sleepï¼Ÿæ–‡ç« å¥½åƒæ²¡çœ‹åˆ°","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1619686576,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":119227,"user_name":"CRann","can_delete":false,"product_type":"c1","uid":1542500,"ip_address":"","ucode":"45D569C9778BDA","user_header":"http://thirdwx.qlogo.cn/mmopen/vi_32/DYAIOgq83eqWicx6gYmNqGYC8V9xo31w9hjsJrZB1fogG6ibBc0KObo2q3n1xndl6BcriahzHKnGvWy3sgCxVlH1w/132","comment_is_top":false,"comment_ctime":1564539584,"is_pvip":false,"replies":[{"id":"44003","content":"æˆªå›¾æˆªé”™äº†ï¼Œè‡ªå·±æ“ä½œçš„æ—¶å€™è®°å¾—è¾“å…¥æ­£ç¡®çš„pidå°±å¥½äº†ã€‚","user_name":"ä½œè€…å›å¤","user_name_real":"åˆ˜è¶…","uid":"1228576","ctime":1564713345,"ip_address":"","comment_id":119227,"utype":1}],"discussion_count":1,"race_medal":0,"score":"40219245248","product_id":100028001,"comment_content":"è€å¸ˆï¼Œåˆšçœ‹æ¡ˆä¾‹topå‘½ä»¤åjavaçš„pidæ˜¯1444ï¼Œå¯æ˜¯ä¸ºä»€ä¹ˆåæ¥æŸ¥çº¿ç¨‹ä¿¡æ¯å˜æˆtop -Hd 1593äº†ï¼Ÿ","like_count":10,"discussions":[{"author":{"id":1228576,"avatar":"https://static001.geekbang.org/account/avatar/00/12/bf/20/19d42715.jpg","nickname":"åˆ˜è¶…","note":"","ucode":"CD56F93596E818","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":460793,"discussion_content":"æˆªå›¾æˆªé”™äº†ï¼Œè‡ªå·±æ“ä½œçš„æ—¶å€™è®°å¾—è¾“å…¥æ­£ç¡®çš„pidå°±å¥½äº†ã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1564713345,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":145005,"user_name":"æ˜¨å¤œçš„æŸ æª¬","can_delete":false,"product_type":"c1","uid":1125511,"ip_address":"","ucode":"C5829C29FB3E34","user_header":"https://static001.geekbang.org/account/avatar/00/11/2c/87/9a3d80dc.jpg","comment_is_top":false,"comment_ctime":1572158307,"is_pvip":false,"replies":[{"id":"56518","content":"æ­£ç¡®çš„å†™æ³•æ˜¯åœ¨setä¹‹åï¼Œè®°å¾—åœ¨finallyé‡Œé¢removeæ‰ã€‚<br><br>try{<br>  localthread.set(&quot;test&quot;);<br>}finally{<br>   localthread.remove(&quot;test&quot;);<br>}","user_name":"ä½œè€…å›å¤","user_name_real":"åˆ˜è¶…","uid":"1228576","ctime":1572519072,"ip_address":"","comment_id":145005,"utype":1}],"discussion_count":1,"race_medal":0,"score":"31636929379","product_id":100028001,"comment_content":"å®é™…é¡¹ç›®ä¸­å¾ˆå¤šéƒ½æ˜¯è¿™æ ·çš„ï¼Œè€å¸ˆæ­£ç¡®çš„å†™æ³•åº”è¯¥æ˜¯æ€æ ·çš„ï¼Ÿ","like_count":8,"discussions":[{"author":{"id":1228576,"avatar":"https://static001.geekbang.org/account/avatar/00/12/bf/20/19d42715.jpg","nickname":"åˆ˜è¶…","note":"","ucode":"CD56F93596E818","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":472208,"discussion_content":"æ­£ç¡®çš„å†™æ³•æ˜¯åœ¨setä¹‹åï¼Œè®°å¾—åœ¨finallyé‡Œé¢removeæ‰ã€‚\n\ntry{\n  localthread.set(&amp;quot;test&amp;quot;);\n}finally{\n   localthread.remove(&amp;quot;test&amp;quot;);\n}","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1572519072,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":158396,"user_name":"æ®¿å°äºŒ","can_delete":false,"product_type":"c1","uid":1284986,"ip_address":"","ucode":"E979673B257C24","user_header":"https://static001.geekbang.org/account/avatar/00/13/9b/7a/58327b6d.jpg","comment_is_top":false,"comment_ctime":1575363940,"is_pvip":false,"replies":[{"id":"60867","content":"æ˜¯çš„ï¼Œåé¢çº¿ç¨‹çš„setåªæ˜¯åœ¨å½“å‰çº¿ç¨‹çš„ThreadLocalMapä¸Šè¿›è¡Œæ“ä½œï¼Œä¸èƒ½æ¸…ç©ºå…¶ä»–çº¿ç¨‹ThreadLocalMapä¸Šå·²ç»æ³„æ¼çš„valueå€¼ã€‚è¿™é‡ŒæŒ‡çš„æ˜¯åŒä¸€ä¸ªçº¿ç¨‹ï¼ŒThreadLocalå®ä¾‹æ²¡æœ‰å¤–éƒ¨å¼ºå¼•ç”¨çš„æƒ…å†µä¸‹è¢«å›æ”¶äº†ï¼Œæ­¤æ—¶keyå€¼ä¼šè¢«å›æ”¶ï¼Œä¸‹ä¸€æ¬¡åœ¨ç›¸åŒçº¿ç¨‹ä¸‹setï¼Œvalueå€¼ä¼šè¢«æ¸…æ‰ã€‚","user_name":"ä½œè€…å›å¤","user_name_real":"åˆ˜è¶…","uid":"1228576","ctime":1575547704,"ip_address":"","comment_id":158396,"utype":1}],"discussion_count":1,"race_medal":0,"score":"23050200420","product_id":100028001,"comment_content":"è€å¸ˆ &quot;è€Œthreadlocalä¸ºäº†è§£å†³è¿™ä¸ªé—®é¢˜ï¼Œåœ¨åé¢çš„çº¿ç¨‹è¿›è¡Œsetæ—¶ï¼Œä¼šæŠŠä¹‹å‰keyå€¼ä¸ºnullçš„valueæ¸…ç©ºæ‰ï¼Œæ‰€ä»¥å°±ä¸ä¼šå‡ºç°å¤§é‡å†…å­˜æ³„æ¼äº†ã€‚&quot;  åé¢çš„çº¿ç¨‹setçš„æ—¶å€™ä¹Ÿåªä¼šåœ¨è‡ªå·±æŒæœ‰çš„ThreadLocalMapä¸Šè¿›è¡Œæ“ä½œå§,æ²¡æœ‰æ‰€è°“çš„æ¸…ç©º keyä¸ºnullçš„valueçš„å€¼å§","like_count":6,"discussions":[{"author":{"id":1228576,"avatar":"https://static001.geekbang.org/account/avatar/00/12/bf/20/19d42715.jpg","nickname":"åˆ˜è¶…","note":"","ucode":"CD56F93596E818","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":476705,"discussion_content":"æ˜¯çš„ï¼Œåé¢çº¿ç¨‹çš„setåªæ˜¯åœ¨å½“å‰çº¿ç¨‹çš„ThreadLocalMapä¸Šè¿›è¡Œæ“ä½œï¼Œä¸èƒ½æ¸…ç©ºå…¶ä»–çº¿ç¨‹ThreadLocalMapä¸Šå·²ç»æ³„æ¼çš„valueå€¼ã€‚è¿™é‡ŒæŒ‡çš„æ˜¯åŒä¸€ä¸ªçº¿ç¨‹ï¼ŒThreadLocalå®ä¾‹æ²¡æœ‰å¤–éƒ¨å¼ºå¼•ç”¨çš„æƒ…å†µä¸‹è¢«å›æ”¶äº†ï¼Œæ­¤æ—¶keyå€¼ä¼šè¢«å›æ”¶ï¼Œä¸‹ä¸€æ¬¡åœ¨ç›¸åŒçº¿ç¨‹ä¸‹setï¼Œvalueå€¼ä¼šè¢«æ¸…æ‰ã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1575547704,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":153901,"user_name":"ååå–œæ¬¢ä½ ","can_delete":false,"product_type":"c1","uid":1101985,"ip_address":"","ucode":"76D9E22B263D6B","user_header":"https://static001.geekbang.org/account/avatar/00/10/d0/a1/07027529.jpg","comment_is_top":false,"comment_ctime":1574328285,"is_pvip":false,"replies":[{"id":"59446","content":"è¿™ä¸¤ä¸ªéƒ½æ˜¯åŸºç¡€æ•°æ®ç±»å‹æ•°ç»„ï¼Œä¾‹å¦‚char[]æ˜¯Stringçš„åŸºç¡€æ•°æ®ç±»å‹ï¼Œbyte[]åˆ™æ˜¯æ•°æ®ä¼ è¾“å­—èŠ‚æµçš„åŸºç¡€æ•°æ®ç±»å‹ï¼Œæ’åœ¨ç¬¬ä¸€äºŒæ˜¯æ¯”è¾ƒå¸¸è§çš„ï¼Œæˆ‘ä»¬éœ€è¦å†çœ‹çœ‹å¤§å°ï¼Œå¦‚æœå¼‚å¸¸å¤§ï¼Œé‚£å°±æ˜¯è¯¥åŸºç¡€æ•°æ®ç±»å‹ä¹‹ä¸Šçš„æŸä¸ªå¼•ç”¨ç±»å‹çš„é—®é¢˜ã€‚å¯ä»¥é€šè¿‡å·¥å…·å†å±•å¼€æ ‘çœ‹çœ‹å°è£…åŸºç¡€æ•°æ®ç±»å‹çš„å¼•ç”¨ç±»å‹æ˜¯ä»€ä¹ˆã€‚","user_name":"ä½œè€…å›å¤","user_name_real":"åˆ˜è¶…","uid":"1228576","ctime":1574579648,"ip_address":"","comment_id":153901,"utype":1}],"discussion_count":1,"race_medal":0,"score":"18754197469","product_id":100028001,"comment_content":"è€æ˜¯æ‚¨å¥½æœ€è¿‘çœ‹åˆ°é¡¹ç›®æœ‰æŠ¥å†…å­˜æº¢å‡ºï¼Œå‘ç°æ˜¯byte[]çš„é—®é¢˜ï¼Œä½†æ˜¯åœ¨Histogram ä¸‹çœ‹åˆ°æ’åœ¨ç¬¬ä¸€ä½çš„æ˜¯char[]æ•°ç»„ï¼Œæ’ç¬¬äºŒçš„æ˜¯byte[]<br>æˆ‘æ˜¯å»æ’æŸ¥char[]å‘¢è¿˜æ˜¯byte[]","like_count":5,"discussions":[{"author":{"id":1228576,"avatar":"https://static001.geekbang.org/account/avatar/00/12/bf/20/19d42715.jpg","nickname":"åˆ˜è¶…","note":"","ucode":"CD56F93596E818","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":475314,"discussion_content":"è¿™ä¸¤ä¸ªéƒ½æ˜¯åŸºç¡€æ•°æ®ç±»å‹æ•°ç»„ï¼Œä¾‹å¦‚char[]æ˜¯Stringçš„åŸºç¡€æ•°æ®ç±»å‹ï¼Œbyte[]åˆ™æ˜¯æ•°æ®ä¼ è¾“å­—èŠ‚æµçš„åŸºç¡€æ•°æ®ç±»å‹ï¼Œæ’åœ¨ç¬¬ä¸€äºŒæ˜¯æ¯”è¾ƒå¸¸è§çš„ï¼Œæˆ‘ä»¬éœ€è¦å†çœ‹çœ‹å¤§å°ï¼Œå¦‚æœå¼‚å¸¸å¤§ï¼Œé‚£å°±æ˜¯è¯¥åŸºç¡€æ•°æ®ç±»å‹ä¹‹ä¸Šçš„æŸä¸ªå¼•ç”¨ç±»å‹çš„é—®é¢˜ã€‚å¯ä»¥é€šè¿‡å·¥å…·å†å±•å¼€æ ‘çœ‹çœ‹å°è£…åŸºç¡€æ•°æ®ç±»å‹çš„å¼•ç”¨ç±»å‹æ˜¯ä»€ä¹ˆã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1574579648,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":216810,"user_name":"Bruce","can_delete":false,"product_type":"c1","uid":1106929,"ip_address":"","ucode":"B2F562F717BD3C","user_header":"https://static001.geekbang.org/account/avatar/00/10/e3/f1/346bd356.jpg","comment_is_top":false,"comment_ctime":1589347765,"is_pvip":false,"replies":[{"id":"80536","content":"åªèƒ½æŸ¥çœ‹è¿è¡Œæ—¶çš„æ•°æ®ï¼Œå¦‚æœéœ€è¦å†å²æ•°æ®ï¼Œå¯ä»¥åœ¨JVMå¯åŠ¨å‚æ•°ä¸­åŠ å…¥dumpæ—¥å¿—å‚æ•°ï¼Œå¯åŠ¨é•¿æ—¶é—´JVMæ—¥å¿—ç›‘æ§ï¼š<br>å¯åŠ¨OOMç›‘æ§æ—¥å¿—ï¼š-XX:+HeapDumpOnOutOfMemoryError -XX:HeapDumpPath=&#47;tmp&#47;heapdump.hprof <br>å¯åŠ¨GCæ—¥å¿—ï¼š-XX:+PrintGCTimeStamps -XX:+PrintGCDetails -Xloggc:&#47;tmp&#47;heapTest.log","user_name":"ä½œè€…å›å¤","user_name_real":"åˆ˜è¶…","uid":"1228576","ctime":1589616697,"ip_address":"","comment_id":216810,"utype":1}],"discussion_count":1,"race_medal":0,"score":"14474249653","product_id":100028001,"comment_content":"é—®ä¸‹è€å¸ˆï¼Œjmapå’Œjstackå‘½ä»¤èƒ½æŸ¥å†å²çš„æ•°æ®ï¼Œè­¬å¦‚æƒ³æŸ¥æ˜¨å¤©çš„ï¼Ÿ","like_count":4,"discussions":[{"author":{"id":1228576,"avatar":"https://static001.geekbang.org/account/avatar/00/12/bf/20/19d42715.jpg","nickname":"åˆ˜è¶…","note":"","ucode":"CD56F93596E818","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":494953,"discussion_content":"åªèƒ½æŸ¥çœ‹è¿è¡Œæ—¶çš„æ•°æ®ï¼Œå¦‚æœéœ€è¦å†å²æ•°æ®ï¼Œå¯ä»¥åœ¨JVMå¯åŠ¨å‚æ•°ä¸­åŠ å…¥dumpæ—¥å¿—å‚æ•°ï¼Œå¯åŠ¨é•¿æ—¶é—´JVMæ—¥å¿—ç›‘æ§ï¼š\nå¯åŠ¨OOMç›‘æ§æ—¥å¿—ï¼š-XX:+HeapDumpOnOutOfMemoryError -XX:HeapDumpPath=/tmp/heapdump.hprof \nå¯åŠ¨GCæ—¥å¿—ï¼š-XX:+PrintGCTimeStamps -XX:+PrintGCDetails -Xloggc:/tmp/heapTest.log","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1589616697,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":174495,"user_name":"Alex","can_delete":false,"product_type":"c1","uid":1102045,"ip_address":"","ucode":"37E663FC4B85E2","user_header":"https://static001.geekbang.org/account/avatar/00/10/d0/dd/a4df05d4.jpg","comment_is_top":false,"comment_ctime":1580233119,"is_pvip":false,"replies":[{"id":"69018","content":"ç”±äºä»£ç æ¯”è¾ƒå°‘ï¼Œè¿™ç¯‡æ²¡æœ‰æäº¤åˆ°githubä¸Šï¼Œéº»çƒ¦è‡ªå·±å»ºä¸ªé¡¹ç›®ï¼Œæ‹·è´ä¸‹æ–‡ç« ä¸­çš„ä»£ç ä¸Šå»å°±å¥½äº†ã€‚","user_name":"ä½œè€…å›å¤","user_name_real":"åˆ˜è¶…","uid":"1228576","ctime":1581507546,"ip_address":"","comment_id":174495,"utype":1}],"discussion_count":1,"race_medal":0,"score":"14465135007","product_id":100028001,"comment_content":"è€å¸ˆå¥½ï¼Œä¸å¥½æ„æ€ï¼Œæƒ³é—®ä¸€ä¸‹ï¼Œæœ¬é—¨è¯¾ç¨‹æ¡ˆä¾‹ä»£ç çš„gitåœ°å€åœ¨å“ªé‡Œï¼Ÿæˆ‘æ²¡æœ‰æ‰¾åˆ°","like_count":3,"discussions":[{"author":{"id":1228576,"avatar":"https://static001.geekbang.org/account/avatar/00/12/bf/20/19d42715.jpg","nickname":"åˆ˜è¶…","note":"","ucode":"CD56F93596E818","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":482417,"discussion_content":"ç”±äºä»£ç æ¯”è¾ƒå°‘ï¼Œè¿™ç¯‡æ²¡æœ‰æäº¤åˆ°githubä¸Šï¼Œéº»çƒ¦è‡ªå·±å»ºä¸ªé¡¹ç›®ï¼Œæ‹·è´ä¸‹æ–‡ç« ä¸­çš„ä»£ç ä¸Šå»å°±å¥½äº†ã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1581507546,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":120807,"user_name":"æ˜Ÿæ˜Ÿæ»´è“å¤©","can_delete":false,"product_type":"c1","uid":1465990,"ip_address":"","ucode":"2F2F56F93AD828","user_header":"https://static001.geekbang.org/account/avatar/00/16/5e/86/40877404.jpg","comment_is_top":false,"comment_ctime":1564998722,"is_pvip":false,"replies":[{"id":"51396","content":"å¯ä»¥é€šè¿‡ManagementFactoryä¸­çš„RuntimeMXBeanå®æ—¶è·å–JVMå¯¹åº”çš„å€¼","user_name":"ä½œè€…å›å¤","user_name_real":"åˆ˜è¶…","uid":"1228576","ctime":1568725413,"ip_address":"","comment_id":120807,"utype":1}],"discussion_count":1,"race_medal":0,"score":"14449900610","product_id":100028001,"comment_content":"ä»£ç ä¸­å¯¹jvmç›‘æ§å¸¸ç”¨æ–¹æ³•æ˜¯å•¥ï¼Ÿæˆ‘ç¿»äº†ç¿»ç•™è¨€ï¼Œæ²¡æœ‰äººé—®è¿™ä¸ªé—®é¢˜çš„","like_count":4,"discussions":[{"author":{"id":1228576,"avatar":"https://static001.geekbang.org/account/avatar/00/12/bf/20/19d42715.jpg","nickname":"åˆ˜è¶…","note":"","ucode":"CD56F93596E818","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":461489,"discussion_content":"å¯ä»¥é€šè¿‡ManagementFactoryä¸­çš„RuntimeMXBeanå®æ—¶è·å–JVMå¯¹åº”çš„å€¼","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1568725413,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":200437,"user_name":"vvip","can_delete":false,"product_type":"c1","uid":1094047,"ip_address":"","ucode":"A027AA12766B0F","user_header":"https://wx.qlogo.cn/mmopen/vi_32/DYAIOgq83eqk1XbuxMP8OPv1QUEOg1IR2bCWaBcr19Z8KiaSg2fnHs7PicmJRtD7ibdEK4As692g3xtTdajjWWdXw/132","comment_is_top":false,"comment_ctime":1585583696,"is_pvip":false,"replies":[{"id":"75243","content":"æœ‰æ€§èƒ½æŸè€—","user_name":"ä½œè€…å›å¤","user_name_real":"åˆ˜è¶…","uid":"1228576","ctime":1585741454,"ip_address":"","comment_id":200437,"utype":1}],"discussion_count":1,"race_medal":0,"score":"10175518288","product_id":100028001,"comment_content":"è€å¸ˆï¼Œè¯·é—®JVMä¸Šå§‹ç»ˆå¼€å¯HeapDumpOnOutOfMemoryErrorè¿™ä¸ªå‚æ•°ï¼Œä¼šå½±å“æ€§èƒ½å—ï¼Ÿ","like_count":2,"discussions":[{"author":{"id":1228576,"avatar":"https://static001.geekbang.org/account/avatar/00/12/bf/20/19d42715.jpg","nickname":"åˆ˜è¶…","note":"","ucode":"CD56F93596E818","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":490027,"discussion_content":"æœ‰æ€§èƒ½æŸè€—","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1585741454,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":149533,"user_name":"ä¸å¥‡è€å¸ˆçš„ç²‰ä¸","can_delete":false,"product_type":"c1","uid":1208265,"ip_address":"","ucode":"6341E0D78CF998","user_header":"https://static001.geekbang.org/account/avatar/00/12/6f/c9/22022094.jpg","comment_is_top":false,"comment_ctime":1573268317,"is_pvip":false,"replies":[{"id":"57604","content":"å¦‚æœæ²¡æœ‰è®¾ç½®å¹´è½»ä»£ä¸è€å¹´ä»£çš„æ¯”ä¾‹ï¼Œé»˜è®¤åˆ†é…ç»™å¹´è½»ä»£æœ€å¤§æ¯”ä¾‹ä¸º60%ï¼Œè€Œä¸”é»˜è®¤ä¼šå…ˆè§¦å‘young gcï¼Œæ‰€ä»¥ä½ è¯´çš„è¿™ç§æƒ…å†µæ¯”è¾ƒå°‘è§ï¼Œæ£€æŸ¥æ˜¯å¦é•¿æ—¶é—´å­˜æ´»çš„å¯¹è±¡å¤ªå¤šå¯¼è‡´çš„ã€‚<br><br>è¿™ç§æƒ…å†µä¼˜åŒ–è®¾ç½®å‚æ•°å·²ç»æ²¡æœ‰å¾ˆæ˜æ˜¾çš„ä½œç”¨äº†ï¼Œå»ºè®®å…ˆæŸ¥æ‰¾å†…å­˜çˆ†æ»¡çš„åŸå› ã€‚","user_name":"ä½œè€…å›å¤","user_name_real":"åˆ˜è¶…","uid":"1228576","ctime":1573381099,"ip_address":"","comment_id":149533,"utype":1}],"discussion_count":1,"race_medal":0,"score":"10163202909","product_id":100028001,"comment_content":"è€å¸ˆæ‚¨å¥½ï¼Œçœ‹äº†æ‚¨çš„è¯¾ç¨‹æ”¶è´§é¢‡ä¸°ï¼è°¢è°¢<br>ç°åœ¨æœ‰ä¸ªé—®é¢˜æƒ³å’¨è¯¢ä¸‹<br><br>å‰æï¼šjdk7u24  xms8g xmx8g g1åƒåœ¾å›æ”¶<br>ç°è±¡ï¼š<br>å †å†…å­˜ä½¿ç”¨é‡ä»2Gä¸€ç›´åˆ°6.3Géƒ½æ²¡æœ‰young gc  å’Œ full gc<br><br>å½“å †å†…å­˜ä½¿ç”¨é‡åˆ°äº†7Gçš„æ—¶å€™ç›´æ¥è¿›è¡Œäº†full gc<br>å¹¶ä¸”å‘¨æœŸæ€§é‡å¤ä¸Šé¢çš„full gc<br>æŸ¥çœ‹GCæ—¥å¿—  edenåŒºå›æ”¶å‰é«˜è¾¾6.3G<br><br>è¯·é—®è€å¸ˆã€‚ç°åœ¨è¯¥å¦‚ä½•è°ƒä¼˜å‘¢","like_count":2,"discussions":[{"author":{"id":1228576,"avatar":"https://static001.geekbang.org/account/avatar/00/12/bf/20/19d42715.jpg","nickname":"åˆ˜è¶…","note":"","ucode":"CD56F93596E818","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":473893,"discussion_content":"å¦‚æœæ²¡æœ‰è®¾ç½®å¹´è½»ä»£ä¸è€å¹´ä»£çš„æ¯”ä¾‹ï¼Œé»˜è®¤åˆ†é…ç»™å¹´è½»ä»£æœ€å¤§æ¯”ä¾‹ä¸º60%ï¼Œè€Œä¸”é»˜è®¤ä¼šå…ˆè§¦å‘young gcï¼Œæ‰€ä»¥ä½ è¯´çš„è¿™ç§æƒ…å†µæ¯”è¾ƒå°‘è§ï¼Œæ£€æŸ¥æ˜¯å¦é•¿æ—¶é—´å­˜æ´»çš„å¯¹è±¡å¤ªå¤šå¯¼è‡´çš„ã€‚\n\nè¿™ç§æƒ…å†µä¼˜åŒ–è®¾ç½®å‚æ•°å·²ç»æ²¡æœ‰å¾ˆæ˜æ˜¾çš„ä½œç”¨äº†ï¼Œå»ºè®®å…ˆæŸ¥æ‰¾å†…å­˜çˆ†æ»¡çš„åŸå› ã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1573381099,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":290686,"user_name":"null","can_delete":false,"product_type":"c1","uid":1024294,"ip_address":"","ucode":"F9039EFED6B55D","user_header":"http://thirdwx.qlogo.cn/mmopen/vi_32/PiajxSqBRaELZPnUAiajaR5C25EDLWeJURggyiaOP5GGPe2qlwpQcm5e3ybib8OsP4tvddFDLVRSNNGL5I3SFPJHsA/132","comment_is_top":false,"comment_ctime":1619686961,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"5914654257","product_id":100028001,"comment_content":"è€å¸ˆï¼Œè¯·é—®ä¸€ä¸‹ï¼Œæ–‡ç« æ˜¯äºŒæ¬¡ä¿®æ”¹è¿‡ä¹ˆï¼Ÿè¯„è®ºåŒºæœ‰äº›å…³é”®å­—å¦‚ï¼šsleepï¼Œtest0ï¼Œtest1ã€‚<br>æˆ‘åœ¨æ–‡ç« åªçœ‹åˆ° test0 æ–¹æ³•ã€‚å¦ä¸¤ä¸ªéƒ½æ²¡æ‰¾åˆ°ã€‚<br>è°¢è°¢ï¼","like_count":1},{"had_liked":false,"id":267107,"user_name":"é™é™è†å¬","can_delete":false,"product_type":"c1","uid":1263932,"ip_address":"","ucode":"0A8600CB928EFE","user_header":"https://static001.geekbang.org/account/avatar/00/13/49/3c/5d54c510.jpg","comment_is_top":false,"comment_ctime":1607598879,"is_pvip":false,"discussion_count":1,"race_medal":0,"score":"5902566175","product_id":100028001,"comment_content":"treadLocalä¼šéšç€çº¿ç¨‹è¢«å›æ”¶è€Œæ¶ˆå¤±çš„ï¼Œä¸ä¼šä¸€ç›´å­˜åœ¨ï¼Œæç«¯æƒ…å†µæ‰ä¼šå†…å­˜æ³„æ¼","like_count":2,"discussions":[{"author":{"id":2324073,"avatar":"https://thirdwx.qlogo.cn/mmopen/vi_32/ziaicqaAJT18CS3xlPgGmLyicMkYiarDhSR9I79DnIjxpnETjOoHe9DM7wmC0icdw1XzwPDKF4TEFuqRicqSgyFtTtBQ/132","nickname":"Geek_c57a51","note":"","ucode":"843AE20C5610BD","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":338103,"discussion_content":"ä½¿ç”¨çº¿ç¨‹æ± çš„æƒ…å†µä¸‹ï¼Œçº¿ç¨‹ä¸€èˆ¬éƒ½ä¸ä¼šå›æ”¶","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1609171929,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":129681,"user_name":"Feng","can_delete":false,"product_type":"c1","uid":1015205,"ip_address":"","ucode":"42DB60B7BF69D0","user_header":"https://static001.geekbang.org/account/avatar/00/0f/7d/a5/930c9103.jpg","comment_is_top":false,"comment_ctime":1567218636,"is_pvip":false,"replies":[{"id":"48620","content":"ä¹‹å‰çš„ä»£ç å·²ç»ä¼˜åŒ–äº†ï¼Œæ‰€ä»¥å»æ‰äº†test1ï¼Œé‡å†™å†™äº†test0æ–¹æ³•ï¼Œä¸¤ä¸ªæ–¹æ³•å¯¹äºå¤§å®¶æ¥è¯´ä¸æ˜¯å¾ˆå¥½ç†è§£","user_name":"ä½œè€…å›å¤","user_name_real":"åˆ˜è¶…","uid":"1228576","ctime":1567425145,"ip_address":"","comment_id":129681,"utype":1}],"discussion_count":1,"race_medal":4,"score":"5862185932","product_id":100028001,"comment_content":"æ²¡çœ‹åˆ°æœ‰test1å•Šã€‚ã€‚ã€‚","like_count":1,"discussions":[{"author":{"id":1228576,"avatar":"https://static001.geekbang.org/account/avatar/00/12/bf/20/19d42715.jpg","nickname":"åˆ˜è¶…","note":"","ucode":"CD56F93596E818","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":465600,"discussion_content":"ä¹‹å‰çš„ä»£ç å·²ç»ä¼˜åŒ–äº†ï¼Œæ‰€ä»¥å»æ‰äº†test1ï¼Œé‡å†™å†™äº†test0æ–¹æ³•ï¼Œä¸¤ä¸ªæ–¹æ³•å¯¹äºå¤§å®¶æ¥è¯´ä¸æ˜¯å¾ˆå¥½ç†è§£","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1567425145,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":126338,"user_name":"WolvesLeader","can_delete":false,"product_type":"c1","uid":1103839,"ip_address":"","ucode":"33610E19CA2E96","user_header":"https://static001.geekbang.org/account/avatar/00/10/d7/df/fc0a6709.jpg","comment_is_top":false,"comment_ctime":1566367548,"is_pvip":false,"replies":[{"id":"46829","content":"ä¸€ä¸ªå°±å¤Ÿäº†ï¼Œå·²ä¿®æ­£","user_name":"ä½œè€…å›å¤","user_name_real":"åˆ˜è¶…","uid":"1228576","ctime":1566437097,"ip_address":"","comment_id":126338,"utype":1}],"discussion_count":1,"race_medal":0,"score":"5861334844","product_id":100028001,"comment_content":"java -jar -Xms1000m -Xmx4000m -XX:+HeapDumpOnOutOfMemoryError -XX:HeapDumpPath=&#47;tmp&#47;heapdump.hprof -Xms1g -Xmx1g -XX:+PrintGCTimeStamps -XX:+PrintGCDetails -Xloggc:&#47;tmp&#47;heapTest.log heapTest-0.0.1-SNAPSHOT.jar<br>é…ç½®äº†2ä¸ª-Xmså’Œ-Xmxï¼Œä¸ºå•¥è¦é…ç½®2ä¸ª","like_count":1,"discussions":[{"author":{"id":1228576,"avatar":"https://static001.geekbang.org/account/avatar/00/12/bf/20/19d42715.jpg","nickname":"åˆ˜è¶…","note":"","ucode":"CD56F93596E818","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":463944,"discussion_content":"ä¸€ä¸ªå°±å¤Ÿäº†ï¼Œå·²ä¿®æ­£","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1566437097,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":114903,"user_name":"æ‹’ç»","can_delete":false,"product_type":"c1","uid":1335155,"ip_address":"","ucode":"CB0264C4D3FE17","user_header":"https://static001.geekbang.org/account/avatar/00/14/5f/73/bb3dc468.jpg","comment_is_top":false,"comment_ctime":1563429847,"is_pvip":false,"replies":[{"id":"42038","content":"å†…å­˜æ³„éœ²å¯¼è‡´æœ‰å¤§é‡å¯¹è±¡æ— æ³•å›æ”¶ï¼Œå æ»¡äº†å †å†…å­˜æƒ…å†µä¸‹ï¼Œå°±ä¼šå¯¼è‡´å†…å­˜æº¢å‡ºã€‚æˆ‘åœ¨è¿™é‡ŒåŠ äº†ä¸€ä¸ªtest1åªæ˜¯ä¸ºäº†åˆ›å»ºæ›´å¤šçš„å¯¹è±¡ï¼Œä»è€Œæ›´å®¹æ˜“å‘ç”Ÿå†…å­˜æº¢å‡ºã€‚","user_name":"ä½œè€…å›å¤","user_name_real":"åˆ˜è¶…","uid":"1228576","ctime":1563493365,"ip_address":"","comment_id":114903,"utype":1}],"discussion_count":1,"race_medal":0,"score":"5858397143","product_id":100028001,"comment_content":"æˆ‘ç”¨abæµ‹è¯•ï¼Œè®¾ç½®è¯·æ±‚æ•°é‡ä¸€ä¸‡ï¼Œè¯·æ±‚test0ï¼Œå†…å­˜å°±æº¢å‡ºï¼Œï¼›è¿˜æ²¡è¯·æ±‚åˆ°test1,ï¼Ÿ","like_count":1,"discussions":[{"author":{"id":1228576,"avatar":"https://static001.geekbang.org/account/avatar/00/12/bf/20/19d42715.jpg","nickname":"åˆ˜è¶…","note":"","ucode":"CD56F93596E818","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":458876,"discussion_content":"å†…å­˜æ³„éœ²å¯¼è‡´æœ‰å¤§é‡å¯¹è±¡æ— æ³•å›æ”¶ï¼Œå æ»¡äº†å †å†…å­˜æƒ…å†µä¸‹ï¼Œå°±ä¼šå¯¼è‡´å†…å­˜æº¢å‡ºã€‚æˆ‘åœ¨è¿™é‡ŒåŠ äº†ä¸€ä¸ªtest1åªæ˜¯ä¸ºäº†åˆ›å»ºæ›´å¤šçš„å¯¹è±¡ï¼Œä»è€Œæ›´å®¹æ˜“å‘ç”Ÿå†…å­˜æº¢å‡ºã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1563493365,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":114788,"user_name":"æ°é¥­å“’","can_delete":false,"product_type":"c1","uid":1014023,"ip_address":"","ucode":"0395069A050057","user_header":"https://static001.geekbang.org/account/avatar/00/0f/79/07/2f418316.jpg","comment_is_top":false,"comment_ctime":1563408273,"is_pvip":true,"discussion_count":0,"race_medal":0,"score":"5858375569","product_id":100028001,"comment_content":"è€å¸ˆå¤ªæ£’äº†ï¼Œæ˜¯æˆ‘ä¸€ç›´æƒ³æ€»ç»“è€Œä¸çŸ¥é“æ€ä¹ˆæ€»ç»“çš„ä¸€ç¯‡æ–‡ç« ","like_count":1},{"had_liked":false,"id":114787,"user_name":"Liam","can_delete":false,"product_type":"c1","uid":1094597,"ip_address":"","ucode":"1D15D3B64F2606","user_header":"https://static001.geekbang.org/account/avatar/00/10/b3/c5/7fc124e2.jpg","comment_is_top":false,"comment_ctime":1563408220,"is_pvip":false,"replies":[{"id":"41929","content":"å¹³æ—¶ä»…ä»…æŸäº›å†…å­˜æ³„æ¼ï¼Œä¸€èˆ¬ä¸ä¼šå¯¼è‡´å†…å­˜æº¢å‡ºã€‚<br>æ‰€ä»¥åœ¨è¿™é‡Œï¼Œtest0è¯·æ±‚æ–¹æ³•ä¸­ThreadLocalä¸ºå†…å­˜æ³„æ¼ï¼Œè€Œtest1æ˜¯ä¸€ä¸ªè§¦å‘å†…å­˜æº¢å‡ºçš„æ¡ä»¶ï¼Œå°è¯·æ±‚é‡æ—¶æ²¡æœ‰é—®é¢˜ï¼Œå½“è¯·æ±‚é‡æ¯”è¾ƒå¤§æ—¶ï¼Œå°±å‡ºç°å†…å­˜æº¢å‡ºæƒ…å†µäº†ã€‚<br><br>","user_name":"ä½œè€…å›å¤","user_name_real":"åˆ˜è¶…","uid":"1228576","ctime":1563421488,"ip_address":"","comment_id":114787,"utype":1}],"discussion_count":1,"race_medal":0,"score":"5858375516","product_id":100028001,"comment_content":"èƒ½å¦è®²ä¸‹è¿™ä¸ªæµ‹è¯•ç”¨ä¾‹æ˜¯æ€ä¹ˆè®¾è®¡çš„ï¼Œä¸ºä»€ä¹ˆè·‘1wæ¬¡ABä¸¤ä¸ªæ–¹æ³•ï¼Œåœ¨1Gçš„å †å†…å­˜ä¸‹ä¼šå‘ç”ŸOOM","like_count":1,"discussions":[{"author":{"id":1228576,"avatar":"https://static001.geekbang.org/account/avatar/00/12/bf/20/19d42715.jpg","nickname":"åˆ˜è¶…","note":"","ucode":"CD56F93596E818","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":458814,"discussion_content":"å¹³æ—¶ä»…ä»…æŸäº›å†…å­˜æ³„æ¼ï¼Œä¸€èˆ¬ä¸ä¼šå¯¼è‡´å†…å­˜æº¢å‡ºã€‚\næ‰€ä»¥åœ¨è¿™é‡Œï¼Œtest0è¯·æ±‚æ–¹æ³•ä¸­ThreadLocalä¸ºå†…å­˜æ³„æ¼ï¼Œè€Œtest1æ˜¯ä¸€ä¸ªè§¦å‘å†…å­˜æº¢å‡ºçš„æ¡ä»¶ï¼Œå°è¯·æ±‚é‡æ—¶æ²¡æœ‰é—®é¢˜ï¼Œå½“è¯·æ±‚é‡æ¯”è¾ƒå¤§æ—¶ï¼Œå°±å‡ºç°å†…å­˜æº¢å‡ºæƒ…å†µäº†ã€‚\n\n","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1563421488,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":330376,"user_name":"Lî‘‹","can_delete":false,"product_type":"c1","uid":2890361,"ip_address":"","ucode":"C519F89E4A5F67","user_header":"https://static001.geekbang.org/account/avatar/00/2c/1a/79/ebdabcd4.jpg","comment_is_top":false,"comment_ctime":1641957906,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1641957906","product_id":100028001,"comment_content":"è€å¸ˆç”Ÿäº§ç¯å¢ƒä¸‹ï¼Œéƒ½æ˜¯è¿ç»´æŒæ¡ç€æœåŠ¡å™¨ï¼Œä¹Ÿä¸ä¼šç»™æˆ‘æ“ä½œï¼Œæ›´ä¸ä¼šç»™æˆ‘dumpï¼Œå› ä¸ºä¸€ä¸ªå †æ—¥å¿—æ–‡ä»¶å¾ˆå¤§ï¼Œå¯¼å‡ºè¦å¥½åŠå¤©ï¼Œè¿ç»´ä¸ä¼šå¹²è¿™ä¸ªäº‹æƒ…çš„ã€‚æ‰€ä»¥æœ‰ä»€ä¹ˆæ›´å¥½çš„æ–¹å¼æ¥è§£å†³ç”Ÿäº§çš„å†…å­˜æº¢å‡ºé—®é¢˜å—ã€‚å…¬å¸ç»™çš„ä¸­é—´ä»¶ç›‘æ§ä»…ä»…åªèƒ½çœ‹åˆ°å†…å­˜å˜åŒ–æ›²çº¿ï¼Œæ²¡æœ‰ä»»ä½•çº¿ç¨‹å †æ ˆä¿¡æ¯","like_count":0},{"had_liked":false,"id":322329,"user_name":"å°éº¦","can_delete":false,"product_type":"c1","uid":1618709,"ip_address":"","ucode":"2C800B598A2CDE","user_header":"https://static001.geekbang.org/account/avatar/00/18/b3/15/30822e33.jpg","comment_is_top":false,"comment_ctime":1637304654,"is_pvip":true,"discussion_count":0,"race_medal":0,"score":"1637304654","product_id":100028001,"comment_content":"Linuxæ€§èƒ½å·¥å…·çš„è¿™éƒ¨åˆ†å†…å®¹å’Œã€Šå®æˆ˜ JAVA è™šæ‹Ÿæœºã€‹çš„ 6.1 èŠ‚å®Œå…¨ä¸€æ ·","like_count":0},{"had_liked":false,"id":297747,"user_name":"éº¦å¾·æ¼‚","can_delete":false,"product_type":"c1","uid":2088674,"ip_address":"","ucode":"18CF51FAF94949","user_header":"https://static001.geekbang.org/account/avatar/00/1f/de/e2/b42256d2.jpg","comment_is_top":false,"comment_ctime":1623758477,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1623758477","product_id":100028001,"comment_content":"threadlocalç”¨å®Œå¿…é¡»é‡Šæ”¾ï¼Œå…¶å®å¾ˆå¤šå¯¹è±¡å¼•ç”¨å°±æ˜¯å› ä¸ºæ²¡æœ‰åŠæ—¶é‡Šæ”¾ï¼Œå¯¼è‡´å†…å­˜æ³„æ¼ï¼Œæ•°æ®å¼‚å¸¸ã€‚","like_count":0},{"had_liked":false,"id":294318,"user_name":"è¡¥å¿ƒ","can_delete":false,"product_type":"c1","uid":1124789,"ip_address":"","ucode":"9DB51E8A6C4B62","user_header":"https://static001.geekbang.org/account/avatar/00/11/29/b5/2b477ed4.jpg","comment_is_top":false,"comment_ctime":1621897117,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1621897117","product_id":100028001,"comment_content":"è€å¸ˆé—®ä¸€ä¸‹ï¼Œthreadlocalæ“ä½œï¼Œå¯¹äºtomcatè¿™ç§åº”ç”¨æœåŠ¡å™¨æ¥è¯´ï¼Œå¼€å§‹çš„çº¿ç¨‹æ•°æ˜¯æœ‰é™çš„ï¼Œæˆ‘ä»¬ç”¨threadlocal å­˜å‚¨å¯¹è±¡å°±ç®—ä¸removeæ˜¯ä¸æ˜¯å¯ä»¥ç†è§£ï¼Œç¬¬äºŒä¸ªç›¸åŒçº¿ç¨‹æ¥çš„æ—¶å€™ï¼Œä¼šæŠŠä¸Šä¸€ä¸ªçº¿ç¨‹å˜é‡çš„ä¸€ä¸ªæ¸…ç©ºå‘¢ï¼Œè¿™æ ·çš„è¯threadlocalé‡Œé¢å­˜å‚¨çš„æœ€å¤§æ•°å…¶å®å°±æ˜¯æˆ‘ä»¬åº”ç”¨æœåŠ¡å™¨å¼€å¯çš„çº¿ç¨‹æ•°ï¼Œæ˜¯ä¸æ˜¯å¯ä»¥è¿™æ ·ç†è§£","like_count":0},{"had_liked":false,"id":288264,"user_name":"å…”å­","can_delete":false,"product_type":"c1","uid":1022286,"ip_address":"","ucode":"327C5142FD0940","user_header":"https://static001.geekbang.org/account/avatar/00/0f/99/4e/0146807f.jpg","comment_is_top":false,"comment_ctime":1618384766,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1618384766","product_id":100028001,"comment_content":"è€å¸ˆï¼Œæˆ‘è¿™è¾¹æœ‰ä¸ªé—®é¢˜ï¼Œé€šè¿‡jvisualvmå’ŒjmcæŸ¥çœ‹ç¨‹åºå†…å­˜éƒ½åœ¨æ§åˆ¶èŒƒå›´å†…ï¼Œä½†æ˜¯é€šè¿‡ç³»ç»Ÿèµ„æºç®¡ç†å™¨æŸ¥çœ‹å†…å­˜ä»æœ€å¼€å§‹çš„500Mæ…¢æ…¢å¢é•¿åˆ°1.5Gï¼ŒéæŒç»­çº¿æ€§å¢é•¿ï¼Œé€šè¿‡jvisualvmæŸ¥çœ‹å †å†…å­˜å¤§å°ä»æœªè¶…è¿‡750Mï¼Œä½¿ç”¨çš„å †å¤§å°ä¹Ÿåœ¨250Måˆ°450Mä¹‹é—´ï¼Œmetaspaceä¹Ÿç¨³å®šåœ¨100Mï¼Œç°åœ¨ä¸çŸ¥é“å¦‚ä½•å®šä½é‚£éƒ¨åˆ†è¢«æ¶ˆè€—çš„å†…å­˜åœ¨ä»€ä¹ˆåœ°æ–¹ï¼Ÿ<br>å…·ä½“ç¨‹åºæƒ…å†µå¦‚ä¸‹ï¼š<br>1ã€ç¨‹åºä¸­æœ‰è°ƒç”¨opencvçš„åº“è¿›è¡Œå›¾ç‰‡å¤„ç†<br>2ã€ç¨‹åºé€šè¿‡exe4jè¿›è¡ŒæœåŠ¡æ‰“åŒ…å¤„ç†<br>3ã€JDKç‰ˆæœ¬1.8<br>4ã€ä¸‹é¢æ˜¯ç¨‹åºå¯åŠ¨å‚æ•°é…ç½®<br>-Xms512m<br>-Xmx750m<br>-XX:PermSize=128m<br>-XX:MaxPermSize=200m","like_count":0},{"had_liked":false,"id":273242,"user_name":"falseâ„ƒ","can_delete":false,"product_type":"c1","uid":1307277,"ip_address":"","ucode":"17E987C05CA2D0","user_header":"https://static001.geekbang.org/account/avatar/00/13/f2/8d/2a9764e3.jpg","comment_is_top":false,"comment_ctime":1610506447,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1610506447","product_id":100028001,"comment_content":"åœ¨ç”Ÿäº§ä¸Šæœ‰è¿™æ ·ä¸€ä¸ªé—®é¢˜ï¼Œé€šè¿‡topæŸ¥çœ‹Linuxç³»ç»Ÿä½¿ç”¨,å‘ç°Javaè¿›ç¨‹å æ¯”è¾¾åˆ°äº†ç™¾åˆ†ä¸ƒå…«åï¼ŒæŸ¥çœ‹gcæ—¥å¿—ï¼Œå †å†…å­˜å ç”¨ä¸å¤Ÿå¤§å‡ ç™¾mï¼Œé‚£å‰©ä¸‹çš„å†…å­˜ç”¨åˆ°å“ªäº†å‘¢","like_count":0},{"had_liked":false,"id":228476,"user_name":"wkq2786130","can_delete":false,"product_type":"c1","uid":1256821,"ip_address":"","ucode":"0F3A9DF9928C67","user_header":"https://static001.geekbang.org/account/avatar/00/13/2d/75/e7c29de4.jpg","comment_is_top":false,"comment_ctime":1592707184,"is_pvip":false,"discussion_count":1,"race_medal":0,"score":"1592707184","product_id":100028001,"comment_content":"1. ç³»ç»Ÿç›‘æ§ï¼Œç›‘æ§å®¹å™¨çš„CPU å†…å­˜ IO æƒ…å†µ<br>2. JVMç›‘æ§ï¼Œç›‘æ§JVM CPU å †å†…å­˜ éå †å†…å­˜ çº¿ç¨‹æ•°<br>3. æ–¹æ³•ç›‘æ§ï¼Œæ–¹æ³•ä½¿ç”¨çš„å†…å­˜è¿‡å¤šæŠ¥è­¦","like_count":0,"discussions":[{"author":{"id":1537865,"avatar":"https://static001.geekbang.org/account/avatar/00/17/77/49/445eea2d.jpg","nickname":"SochiLee","note":"","ucode":"47596594EDF4D7","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":352951,"discussion_content":"è¯·æ•™ï¼Œâ€œ3.æ–¹æ³•ç›‘æ§ï¼Œæ–¹æ³•ä½¿ç”¨çš„å†…å­˜è¿‡å¤šæŠ¥è­¦â€ï¼Œå¦‚ä½•å®ç°å‘€ï¼Ÿæ€è·¯æ˜¯ä»€ä¹ˆï¼Ÿ","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1614922041,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":161265,"user_name":"John","can_delete":false,"product_type":"c1","uid":1123654,"ip_address":"","ucode":"D113AD2F837A92","user_header":"https://static001.geekbang.org/account/avatar/00/11/25/46/7a9ede98.jpg","comment_is_top":false,"comment_ctime":1576159921,"is_pvip":false,"replies":[{"id":"61976","content":"é€šè¿‡jampå°†å†…å­˜ä½¿ç”¨æƒ…å†µdumpå‡ºæ¥ï¼Œåˆ†æä¸‹å†…å­˜ä¸­çš„å¯¹è±¡åˆ†å¸ƒæƒ…å†µï¼Œä¸€èˆ¬MATä¼šç›´æ¥ç»™å‡ºé—®é¢˜å¯¹è±¡çš„ã€‚","user_name":"ä½œè€…å›å¤","user_name_real":"åˆ˜è¶…","uid":"1228576","ctime":1576669282,"ip_address":"","comment_id":161265,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1576159921","product_id":100028001,"comment_content":"è€å¸ˆè¯·æ•™ä¸€ä¸‹ï¼Œåœ¨jmapåˆ†æåï¼Œç¡®è®¤ä¸å­˜åœ¨å †å†…å­˜æ³„éœ²çš„å‰æä¸‹ï¼Œtopæ˜¾ç¤ºçš„memä¾ç„¶ä¸€ç›´ç«™åœ¨é«˜ä½ï¼Œä»jstackä¹Ÿæ²¡æœ‰çœ‹å‡ºæœ‰å¼‚å¸¸çš„çº¿ç¨‹é—®é¢˜ï¼Œè¿™ç§æƒ…å†µä¸‹èƒ½æ€ä¹ˆè¿›è¡Œé—®é¢˜å®šä½ï¼Ÿ","like_count":0,"discussions":[{"author":{"id":1228576,"avatar":"https://static001.geekbang.org/account/avatar/00/12/bf/20/19d42715.jpg","nickname":"åˆ˜è¶…","note":"","ucode":"CD56F93596E818","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":477670,"discussion_content":"é€šè¿‡jampå°†å†…å­˜ä½¿ç”¨æƒ…å†µdumpå‡ºæ¥ï¼Œåˆ†æä¸‹å†…å­˜ä¸­çš„å¯¹è±¡åˆ†å¸ƒæƒ…å†µï¼Œä¸€èˆ¬MATä¼šç›´æ¥ç»™å‡ºé—®é¢˜å¯¹è±¡çš„ã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1576669282,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":132798,"user_name":"é’±","can_delete":false,"product_type":"c1","uid":1009652,"ip_address":"","ucode":"2C92A243A463D4","user_header":"https://static001.geekbang.org/account/avatar/00/0f/67/f4/9a1feb59.jpg","comment_is_top":false,"comment_ctime":1568241111,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1568241111","product_id":100028001,"comment_content":"è€å¸ˆè¯·é—®OSæ˜¯æ€ä¹ˆç›‘æ§æ¯ä¸ªè¿›ç¨‹çš„èµ„æºä½¿ç”¨æƒ…å†µçš„ï¼Ÿç›´æ¥åœ¨å†…å­˜ä¸­æ”¶é›†åˆ°ç›¸å…³çš„æ•°æ®ï¼Ÿ<br>å…¶ä»–ç›‘æ§å·¥å…·çš„å·¥ä½œåŸç†æ˜¯æ˜¯ä»€ä¹ˆï¼Ÿæ˜¯å€ŸåŠ©OSçš„APIè·å–ç›¸å…³ç›‘æ§ä¿¡æ¯è¿˜æ˜¯è‡ªå·±æœ‰åšäº†ä»€ä¹ˆæ‹¿åˆ°äº†ç›‘æ§è¿›ç¨‹çš„è¿è¡Œæ•°æ®ï¼Ÿ","like_count":0},{"had_liked":false,"id":115061,"user_name":"æˆ‘å·²ç»è®¾ç½®äº†æ˜µç§°","can_delete":false,"product_type":"c1","uid":1364034,"ip_address":"","ucode":"ED672C5EBDBDC4","user_header":"https://static001.geekbang.org/account/avatar/00/14/d0/42/6fd01fb9.jpg","comment_is_top":false,"comment_ctime":1563464251,"is_pvip":false,"replies":[{"id":"42037","content":"tesr0æ˜¯å†…å­˜æ³„éœ²ï¼Œtest1åˆ™æ˜¯æ­£å¸¸çš„åˆ†é…å †å†…å­˜ï¼Œè¿™é‡Œtest1åªæ˜¯æ¨¡æ‹Ÿåœ¨å†…å­˜æº¢å‡ºçš„æƒ…å†µä¸‹ï¼Œå¦‚æœæœ‰å¤§é‡å¯¹è±¡åˆ›å»ºçš„æƒ…å†µä¸‹ï¼Œå¾ˆå®¹æ˜“å¯¼è‡´å†…å­˜æº¢å‡ºã€‚","user_name":"ä½œè€…å›å¤","user_name_real":"åˆ˜è¶…","uid":"1228576","ctime":1563493101,"ip_address":"","comment_id":115061,"utype":1}],"discussion_count":2,"race_medal":0,"score":"1563464251","product_id":100028001,"comment_content":"åŒç†ä¸æ˜ç™½ä¸ºä»€ä¹ˆè¿™é‡Œtest0ï¼Œtest1æ–¹æ³•ä¼šå†…å­˜æ³„æ¼ï¼Œè¯·è€å¸ˆè‡ªå·±è®²ä¸‹","like_count":0,"discussions":[{"author":{"id":1228576,"avatar":"https://static001.geekbang.org/account/avatar/00/12/bf/20/19d42715.jpg","nickname":"åˆ˜è¶…","note":"","ucode":"CD56F93596E818","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":458950,"discussion_content":"tesr0æ˜¯å†…å­˜æ³„éœ²ï¼Œtest1åˆ™æ˜¯æ­£å¸¸çš„åˆ†é…å †å†…å­˜ï¼Œè¿™é‡Œtest1åªæ˜¯æ¨¡æ‹Ÿåœ¨å†…å­˜æº¢å‡ºçš„æƒ…å†µä¸‹ï¼Œå¦‚æœæœ‰å¤§é‡å¯¹è±¡åˆ›å»ºçš„æƒ…å†µä¸‹ï¼Œå¾ˆå®¹æ˜“å¯¼è‡´å†…å­˜æº¢å‡ºã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1563493101,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1364034,"avatar":"https://static001.geekbang.org/account/avatar/00/14/d0/42/6fd01fb9.jpg","nickname":"æˆ‘å·²ç»è®¾ç½®äº†æ˜µç§°","note":"","ucode":"ED672C5EBDBDC4","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":2366,"discussion_content":"æ˜ç™½","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1563519797,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":115036,"user_name":"QQæ€ª","can_delete":false,"product_type":"c1","uid":1211223,"ip_address":"","ucode":"1A39B8433D9208","user_header":"https://static001.geekbang.org/account/avatar/00/12/7b/57/a9b04544.jpg","comment_is_top":false,"comment_ctime":1563458824,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1563458824","product_id":100028001,"comment_content":"å­¦åˆ°äº†å¾ˆå¤šï¼Œæ„Ÿè°¢æ„Ÿè°¢","like_count":0},{"had_liked":false,"id":114798,"user_name":"æ’’æ—¦çš„å •è½","can_delete":false,"product_type":"c1","uid":1116864,"ip_address":"","ucode":"15F6AA41EE556F","user_header":"https://static001.geekbang.org/account/avatar/00/11/0a/c0/401c240e.jpg","comment_is_top":false,"comment_ctime":1563410191,"is_pvip":false,"replies":[{"id":"42078","content":"å¦‚æœå‘ç”ŸGCçš„æƒ…å†µä¸‹ï¼Œthreadlocalmapäº§ç”Ÿçš„å ç”¨å†…å­˜å¯¹è±¡å°±ä¸æ­¢400mï¼Œä¹Ÿå°±æ˜¯è¯´å‘ç”Ÿå†…å­˜æº¢å‡ºçš„æƒ…å†µä¸‹ã€‚","user_name":"ä½œè€…å›å¤","user_name_real":"åˆ˜è¶…","uid":"1228576","ctime":1563513702,"ip_address":"","comment_id":114798,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1563410191","product_id":100028001,"comment_content":"è€å¸ˆ  è¿™æ®µä»£ç æœ‰ç‚¹ä¸è§£çš„åœ°æ–¹ test0ä½¿ç”¨çº¿ç¨‹æ±  æ‰€ä»¥çº¿ç¨‹ä¸€ç›´å­˜æ´»  è€Œæ¯ä¸ªçº¿ç¨‹çš„threadlocalmapä¸­ å«æœ‰4mçš„å†…å­˜ æ²¡æ³•é‡Šæ”¾ 100ä¸ªçº¿ç¨‹ æ‰400mè¢«å ç”¨ è€Œtest1æ–¹æ³•ä½¿ç”¨çš„æ˜¯å±€éƒ¨å˜é‡ æ–¹æ³•æ‰§è¡Œåå†…å­˜å°±ä¼šè¢«å›æ”¶  4gçš„å†…å­˜ä¸ºå•¥å°±æº¢å‡ºäº†","like_count":0,"discussions":[{"author":{"id":1228576,"avatar":"https://static001.geekbang.org/account/avatar/00/12/bf/20/19d42715.jpg","nickname":"åˆ˜è¶…","note":"","ucode":"CD56F93596E818","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":458818,"discussion_content":"å¦‚æœå‘ç”ŸGCçš„æƒ…å†µä¸‹ï¼Œthreadlocalmapäº§ç”Ÿçš„å ç”¨å†…å­˜å¯¹è±¡å°±ä¸æ­¢400mï¼Œä¹Ÿå°±æ˜¯è¯´å‘ç”Ÿå†…å­˜æº¢å‡ºçš„æƒ…å†µä¸‹ã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1563513702,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":114785,"user_name":"csyangchsh","can_delete":false,"product_type":"c1","uid":1002939,"ip_address":"","ucode":"8604F5C839710B","user_header":"https://static001.geekbang.org/account/avatar/00/0f/4d/bb/abb7bfe3.jpg","comment_is_top":false,"comment_ctime":1563407578,"is_pvip":false,"replies":[{"id":"42041","content":"å¯¹çš„ï¼Œä¹Ÿè¦å…³æ³¨string byteç±»å‹çš„å¯¹è±¡å¤§å°æ˜¯ä¸æ˜¯å¼‚å¸¸ã€‚","user_name":"ä½œè€…å›å¤","user_name_real":"åˆ˜è¶…","uid":"1228576","ctime":1563493597,"ip_address":"","comment_id":114785,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1563407578","product_id":100028001,"comment_content":"åˆ†æåƒåœ¾å›æ”¶æ—¥å¿—ï¼Œå†…å­˜å ç”¨å‘ˆä¸Šæ¶¨è¶‹åŠ¿ã€‚å¦å¤–å¯¹è±¡å¹´é¾„åˆ†å¸ƒä¹Ÿæ˜¯ä¸€ä¸ªæŒ‡å¾ï¼Œå¦‚æœä½¿ç”¨visualvmï¼Œå¯ä»¥æŸ¥çœ‹generation countã€‚æˆ–è€…å–åƒåœ¾å›æ”¶å‰åçš„class histogramè¿›è¡Œæ¯”è¾ƒï¼Œçœ‹å“ªä¸ªç±»çš„å®ä¾‹å¢å¤šäº†ï¼Œä¸è¿‡è¦æ³¨æ„stringï¼Œbyteæ•°ç»„ç­‰é€šå¸¸æ’åœ¨æœ€å‰é¢ã€‚æ‰€ä»¥è¦å…³æ³¨è‡ªå·±å†™çš„ç±»ï¼Œæ˜¯ä¸æ˜¯æ’åœ¨å‰10å‡ ä½ã€‚","like_count":0,"discussions":[{"author":{"id":1228576,"avatar":"https://static001.geekbang.org/account/avatar/00/12/bf/20/19d42715.jpg","nickname":"åˆ˜è¶…","note":"","ucode":"CD56F93596E818","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":458813,"discussion_content":"å¯¹çš„ï¼Œä¹Ÿè¦å…³æ³¨string byteç±»å‹çš„å¯¹è±¡å¤§å°æ˜¯ä¸æ˜¯å¼‚å¸¸ã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1563493597,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":114778,"user_name":"yihang","can_delete":false,"product_type":"c1","uid":1012361,"ip_address":"","ucode":"A5506F085D1793","user_header":"https://static001.geekbang.org/account/avatar/00/0f/72/89/1a83120a.jpg","comment_is_top":false,"comment_ctime":1563406567,"is_pvip":false,"replies":[{"id":"41928","content":"test1åªæ˜¯ä¸€ä¸ªæ·»åŠ å†…å­˜å¯¹è±¡çš„æ–¹æ³•ï¼Œä»…ä»…æ˜¯ä½œä¸ºè§¦å‘æ¡ä»¶ï¼Œå¦‚æœthreadLocalçš„å¯¹è±¡ä¸åŠæ—¶å›æ”¶ï¼Œtest1è¯·æ±‚é‡å¤§äº†ï¼Œå°±ä¼šå¯¼è‡´å†…å­˜æº¢å‡ºã€‚","user_name":"ä½œè€…å›å¤","user_name_real":"åˆ˜è¶…","uid":"1228576","ctime":1563421169,"ip_address":"","comment_id":114778,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1563406567","product_id":100028001,"comment_content":"æ²¡å¤ªçœ‹æ‡‚test1æ–¹æ³•ï¼Œè¯¥æ–¹æ³•å†…å¹¶æ²¡æœ‰ä½¿ç”¨ä¹‹å‰çš„çº¿ç¨‹æ± å’Œthreadlocalå¯¹è±¡å•Šï¼Ÿå¦å¤–å…¶ä¸­çš„åˆ›å»ºçš„å¯¹è±¡ï¼ˆéƒ½æ˜¯å±€éƒ¨çš„ï¼‰<br>åº”è¯¥åœ¨æ–¹æ³•æ‰§è¡Œå®Œæ¯•å¯ä»¥æ ‡è®°ä¸ºå›æ”¶å•Šï¼Ÿæ€ä¹ˆè°ƒç”¨å®ƒä¼šå‡ºé—®é¢˜å‘¢","like_count":0,"discussions":[{"author":{"id":1228576,"avatar":"https://static001.geekbang.org/account/avatar/00/12/bf/20/19d42715.jpg","nickname":"åˆ˜è¶…","note":"","ucode":"CD56F93596E818","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":458811,"discussion_content":"test1åªæ˜¯ä¸€ä¸ªæ·»åŠ å†…å­˜å¯¹è±¡çš„æ–¹æ³•ï¼Œä»…ä»…æ˜¯ä½œä¸ºè§¦å‘æ¡ä»¶ï¼Œå¦‚æœthreadLocalçš„å¯¹è±¡ä¸åŠæ—¶å›æ”¶ï¼Œtest1è¯·æ±‚é‡å¤§äº†ï¼Œå°±ä¼šå¯¼è‡´å†…å­˜æº¢å‡ºã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1563421169,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]}]}