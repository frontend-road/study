{"id":236921,"title":"08 | äº‹ä»¶é©±åŠ¨ï¼šC10Mæ˜¯å¦‚ä½•å®ç°çš„ï¼Ÿ","content":"<p>ä½ å¥½ï¼Œæˆ‘æ˜¯é™¶è¾‰ã€‚</p><p>ä¸Šä¸€è®²ä»‹ç»äº†å¹¿æ’­ä¸ç»„æ’­è¿™ç§ä¸€å¯¹å¤šé€šè®¯æ–¹å¼ï¼Œä»è¿™ä¸€è®²å¼€å§‹ï¼Œæˆ‘ä»¬å›åˆ°ä¸»æµçš„ä¸€å¯¹ä¸€é€šè®¯æ–¹å¼ã€‚</p><p>æ—©äº›å¹´æˆ‘ä»¬è°ˆåˆ°é«˜å¹¶å‘ï¼Œæ€»æ˜¯ä¼šæåˆ°C10Kï¼Œè¿™æ˜¯æŒ‡æœåŠ¡å™¨åŒæ—¶å¤„ç†1ä¸‡ä¸ªTCPè¿æ¥ã€‚éšç€æœåŠ¡å™¨æ€§èƒ½çš„æå‡ï¼Œè¿‘æ¥æˆ‘ä»¬æ›´å¸Œæœ›å•å°æœåŠ¡å™¨çš„å¹¶å‘èƒ½åŠ›å¯ä»¥è¾¾åˆ°C10Mï¼Œä¹Ÿå°±æ˜¯åŒæ—¶å¯ä»¥å¤„ç†1åƒä¸‡ä¸ªTCPè¿æ¥ã€‚ä»C10Kåˆ°C10Mï¼Œå®ç°æŠ€æœ¯å¹¶æ²¡æœ‰æœ¬è´¨å˜åŒ–ï¼Œéƒ½æ˜¯ç”¨äº‹ä»¶é©±åŠ¨å’Œå¼‚æ­¥å¼€å‘å®ç°çš„ã€‚<a href=\"https://time.geekbang.org/column/article/233629\">[ç¬¬5è®²]</a> ä»‹ç»è¿‡çš„åç¨‹ï¼Œä¹Ÿæ˜¯ä¾èµ–è¿™äºŒè€…å®ç°é«˜å¹¶å‘çš„ã€‚</p><p>åšè¿‡å¼‚æ­¥å¼€å‘çš„åŒå­¦éƒ½çŸ¥é“ï¼Œå¤„ç†åŸºäºTCPçš„åº”ç”¨å±‚åè®®æ—¶ï¼Œä¸€ä¸ªè¯·æ±‚çš„å¤„ç†ä»£ç å¿…é¡»è¢«æ‹†åˆ†åˆ°å¤šä¸ªå›è°ƒå‡½æ•°ä¸­ï¼Œç”±å¼‚æ­¥æ¡†æ¶åœ¨ç›¸åº”çš„äº‹ä»¶ç”Ÿæˆæ—¶è°ƒç”¨å®ƒä»¬ã€‚è¿™å°±æ˜¯äº‹ä»¶é©±åŠ¨æ–¹å¼ï¼Œå®ƒé€šè¿‡å‡å°‘ä¸Šä¸‹æ–‡åˆ‡æ¢æ¬¡æ•°ï¼Œå®ç°äº†C10Mçº§åˆ«çš„é«˜å¹¶å‘ã€‚</p><p>ä¸è¿‡ï¼Œåšåº”ç”¨å¼€å‘çš„åŒå­¦å¾€å¾€ä¸æ¸…æ¥šä»€ä¹ˆå«åšâ€œäº‹ä»¶â€ï¼Œä¸äº†è§£å¤„ç†HTTPè¯·æ±‚çš„å›è°ƒå‡½æ•°ä¸äº‹ä»¶é—´çš„å…³ç³»ã€‚è¿™æ ·ï¼Œåœ¨é«˜å¹¶å‘ä¸‹ï¼Œå½“å¤šä¸ªHTTPè¯·æ±‚äº‰æŠ¢æ‰§è¡Œæ—¶ï¼Œæ¶‰åŠèµ„æºåˆ†é…ã€é‡Šæ”¾ç­‰é‡è¦å·¥ä½œçš„å›è°ƒå‡½æ•°ï¼Œå°±å¯èƒ½åœ¨é”™è¯¯çš„æ—¶é—´è¢«è°ƒç”¨ï¼Œè¿›è€Œå¼•å‘ä¸€ç³»åˆ—é—®é¢˜ã€‚æ¯”å¦‚ï¼Œä¸åŒçš„å›è°ƒå‡½æ•°å¯¹åº”ä¸åŒçš„äº‹ä»¶ï¼Œå¦‚æœæŸä¸ªå‡½æ•°æ‰§è¡Œæ—¶é—´è¿‡é•¿ï¼Œå°±ä¼šå½±å“å…¶ä»–è¯·æ±‚ï¼Œå¯èƒ½å¯¼è‡´å¤§é‡è¯·æ±‚å‡ºç°è¶…æ—¶è€Œå¤„ç†å¤±è´¥ã€‚</p><p>è¿™ä¸€è®²æˆ‘ä»¬å°±æ¥ä»‹ç»ä¸€ä¸‹ï¼Œäº‹ä»¶æ˜¯æ€æ ·äº§ç”Ÿçš„ï¼Ÿå®ƒæ˜¯å¦‚ä½•é©±åŠ¨è¯·æ±‚æ‰§è¡Œçš„ï¼Ÿå¤šè·¯å¤ç”¨æŠ€æœ¯æ˜¯æ€æ ·ååŠ©å®ç°å¼‚æ­¥å¼€å‘çš„ï¼Ÿç†è§£äº†è¿™äº›ï¼Œä½ ä¹Ÿå°±æ˜ç™½äº†è¿™ç§äº‹ä»¶é©±åŠ¨çš„è§£å†³æ–¹æ¡ˆï¼ŒçŸ¥é“äº†æ€ä¹ˆæ ·å®ç°C10Mã€‚</p><!-- [[[read_end]]] --><h2>äº‹ä»¶æ˜¯æ€ä¹ˆäº§ç”Ÿçš„ï¼Ÿ</h2><p>è¦äº†è§£â€œäº‹ä»¶é©±åŠ¨â€çš„è¿ä½œæœºåˆ¶ï¼Œé¦–å…ˆå°±è¦ææ¸…æ¥šåˆ°åº•ä»€ä¹ˆæ˜¯äº‹ä»¶ã€‚è¿™å°±éœ€è¦ä½ å¯¹ç½‘ç»œåŸç†æœ‰æ·±å…¥çš„ç†è§£äº†ã€‚</p><p>ç®€å•æ¥è¯´ï¼Œä»ç½‘ç»œä¸­æ¥æ”¶åˆ°ä¸€ä¸ªæŠ¥æ–‡ï¼Œå°±å¯èƒ½äº§ç”Ÿä¸€ä¸ªäº‹ä»¶ã€‚å¦‚ä¸Šä¸€è®²ä»‹ç»è¿‡çš„UDPè¯·æ±‚å°±æ˜¯æœ€ç®€å•çš„ä¾‹å­ï¼Œä¸€ä¸ªUDPè¯·æ±‚é€šå¸¸ä»…ç”±ä¸€ä¸ªç½‘ç»œæŠ¥æ–‡ç»„æˆï¼Œæ‰€ä»¥ï¼Œå½“æ”¶åˆ°ä¸€ä¸ªUDPæŠ¥æ–‡ï¼Œå°±æ„å‘³ç€æ”¶åˆ°ä¸€ä¸ªè¯·æ±‚ï¼Œå®ƒä¼šç”Ÿæˆä¸€ä¸ªäº‹ä»¶ï¼Œè¿›è€Œè§¦å‘å›è°ƒå‡½æ•°æ‰§è¡Œã€‚</p><p>ä¸è¿‡ï¼Œå¸¸è§çš„HTTPç­‰åè®®éƒ½æ˜¯åŸºäºTCPå®ç°çš„ã€‚ç”±äºTCPæ˜¯ä¸€ç§é¢å‘å­—èŠ‚æµçš„åè®®ï¼ŒHTTPè¯·æ±‚çš„å¤§å°å¹¶ä¸å—é™åˆ¶ï¼Œå½“ä¸€ä¸ªHTTPè¯·æ±‚çš„å¤§å°è¶…è¿‡TCPæŠ¥æ–‡çš„æœ€å¤§é•¿åº¦æ—¶ï¼Œè¯·æ±‚ä¼šè¢«æ‹†åˆ†åˆ°å¤šä¸ªæŠ¥æ–‡ä¸­è¿è¾“ï¼Œåœ¨æ¥æ”¶ç«¯çš„ç¼“å†²åŒºä¸­é‡ç»„ã€æ’åºã€‚å› æ­¤ï¼Œå¹¶ä¸æ˜¯æ¯ä¸ªåˆ°è¾¾çš„TCPæŠ¥æ–‡éƒ½èƒ½ç”Ÿæˆäº‹ä»¶çš„ã€‚</p><p>å¦‚æœä¸ç†è§£äº‹ä»¶å’ŒTCPæŠ¥æ–‡çš„å…³ç³»ï¼Œå°±æ²¡æ³•å‡†ç¡®åœ°æŒæ¡å¤„ç†HTTPè¯·æ±‚çš„å‡½æ•°ä½•æ—¶è¢«è°ƒç”¨ã€‚å½“ç„¶ï¼Œä½œä¸ºåº”ç”¨å¼€å‘å·¥ç¨‹å¸ˆï¼Œæˆ‘ä»¬æ— é¡»åœ¨æ„å®ç°ç»†èŠ‚ï¼Œåªè¦äº†è§£TCPè¿æ¥å»ºç«‹ã€å…³é—­ï¼Œä»¥åŠæ¶ˆæ¯çš„å‘é€å’Œæ¥æ”¶è¿™å››ä¸ªåœºæ™¯ä¸­ï¼ŒæŠ¥æ–‡ä¸äº‹ä»¶é—´çš„å…³ç³»å°±å¯ä»¥äº†ã€‚</p><p>äº‹ä»¶å¹¶æ²¡æœ‰ä½ æƒ³è±¡ä¸­é‚£ä¹ˆå¤æ‚ï¼Œå®ƒåªæœ‰ä¸¤ç§ç±»å‹ï¼šè¯»äº‹ä»¶ä¸å†™äº‹ä»¶ï¼Œå…¶ä¸­ï¼Œè¯»äº‹ä»¶è¡¨ç¤ºæœ‰åˆ°è¾¾çš„æ¶ˆæ¯éœ€è¦å¤„ç†ï¼Œè€Œå†™äº‹ä»¶è¡¨ç¤ºå¯ä»¥å‘é€æ¶ˆæ¯ï¼ˆTCPè¿æ¥çš„å†™ç¼“å†²åŒºä¸­æœ‰å¯ç”¨ç©ºé—´ï¼‰ã€‚æˆ‘ä»¬å…ˆä»ä¸‰æ¬¡æ¡æ‰‹å»ºç«‹è¿æ¥è¯´èµ·ï¼Œè¿™ä¸€è¿‡ç¨‹ä¼šäº§ç”Ÿä¸€è¯»ã€ä¸€å†™ä¸¤ä¸ªäº‹ä»¶ã€‚</p><p>ç”±äºTCPå…è®¸åŒå‘ä¼ è¾“ï¼Œæ‰€ä»¥<strong>å»ºç«‹è¿æ¥æ—¶ï¼Œä¼šä¾æ¬¡åœ¨è¿æ¥çš„ä¸¤ä¸ªæ–¹å‘ä¸Šå»ºç«‹é€šé“ã€‚</strong>ä¸»åŠ¨å‘èµ·è¿æ¥çš„ä¸€æ–¹å«åšå®¢æˆ·ç«¯ï¼Œè¢«åŠ¨ç›‘å¬ç«¯å£ç­‰å¾…è¿æ¥çš„ä¸€æ–¹å«åšæœåŠ¡å™¨ã€‚</p><p>å®¢æˆ·ç«¯é¦–å…ˆå‘é€SYNæŠ¥æ–‡ç»™æœåŠ¡å™¨ï¼Œè€ŒæœåŠ¡å™¨æ”¶åˆ°åå›å¤ACKå’ŒSYNï¼ˆè¿™é‡Œæˆ‘ä»¬åªéœ€è¦çŸ¥é“äº§ç”Ÿäº‹ä»¶çš„è¿‡ç¨‹å³å¯ï¼Œä¸‹ä¸€è®²ä¼šè¯¦ç»†ä»‹ç»è¿™ä¸¤ä¸ªæŠ¥æ–‡çš„å«ä¹‰ï¼‰ï¼Œ<strong>å½“å®ƒä»¬åˆ°è¾¾å®¢æˆ·ç«¯æ—¶ï¼ŒåŒå‘è¿æ¥ä¸­ç”±å®¢æˆ·ç«¯åˆ°æœåŠ¡å™¨çš„é€šé“å°±å»ºç«‹å¥½äº†ï¼Œæ­¤æ—¶å®¢æˆ·ç«¯å°±å·²ç»å¯ä»¥å‘é€è¯·æ±‚äº†ï¼Œå› æ­¤å®¢æˆ·ç«¯ä¼šäº§ç”Ÿå†™äº‹ä»¶ã€‚</strong>æ¥ç€ï¼Œ<strong>å®¢æˆ·ç«¯å‘é€ACKæŠ¥æ–‡ï¼Œåˆ°è¾¾æœåŠ¡å™¨åï¼ŒæœåŠ¡å™¨ä¸Šä¼šäº§ç”Ÿè¯»äº‹ä»¶</strong>ï¼Œå› ä¸ºè¿›ç¨‹åŸæœ¬åœ¨ç›‘å¬80ç­‰ç«¯å£ï¼Œæ­¤æ—¶æœ‰æ–°è¿æ¥å»ºç«‹æˆåŠŸï¼Œåº”å½“è°ƒç”¨acceptå‡½æ•°è¯»å–è¿™ä¸ªè¿æ¥ï¼Œæ‰€ä»¥è¿™æ˜¯ä¸€ä¸ªè¯»äº‹ä»¶ã€‚</p><p><img src=\"https://static001.geekbang.org/resource/image/73/98/73b9d890c7087531b51180ada6e65f98.png?wh=909*628\" alt=\"\"></p><p>åœ¨å»ºç«‹å¥½çš„TCPè¿æ¥ä¸Šæ”¶å‘æ¶ˆæ¯æ—¶ï¼Œè¯»äº‹ä»¶å¯¹åº”ç€æ¥æ”¶åˆ°å¯¹æ–¹çš„æ¶ˆæ¯ï¼Œè¿™å¾ˆå¥½ç†è§£ã€‚å†™äº‹ä»¶åˆ™ç¨å¾®å¤æ‚äº›ï¼Œæˆ‘ä»¬ä¸¾ä¸ªä¾‹å­åŠ ä»¥è¯´æ˜ã€‚å‡è®¾è¦å‘é€ä¸€ä¸ª2MBçš„è¯·æ±‚ï¼Œ<strong>å½“è°ƒç”¨writeå‡½æ•°å‘é€æ—¶ï¼Œä¼šå…ˆæŠŠå†…å­˜ä¸­çš„æ•°æ®æ‹·è´åˆ°å†™ç¼“å†²åŒºä¸­åï¼Œå†å‘é€åˆ°ç½‘å¡ä¸Šã€‚</strong></p><p>ä¸ºä½•è¦å¤šæ­¤ä¸€ä¸¾å‘¢ï¼Ÿè¿™æ˜¯å› ä¸ºåœ¨å¯¹æ–¹æ²¡æœ‰æ˜ç¡®è¡¨ç¤ºæ”¶åˆ°å‰ï¼ŒTCPä¼šé€šè¿‡å®šæ—¶å™¨é‡å‘å†™ç¼“å†²åŒºä¸­çš„æ•°æ®ï¼Œä¿è¯æ¶ˆæ¯èƒ½å¤Ÿåˆ°è¾¾å¯¹æ–¹ã€‚å†™ç¼“å†²åŒºæ˜¯æœ‰å¤§å°é™åˆ¶çš„ï¼Œæˆ‘åœ¨[ç¬¬10è®²]ä¸­ä¼šè¯¦ç»†ä»‹ç»ã€‚è¿™é‡Œå‡è®¾å†™ç¼“å†²åŒºåªæœ‰1MBï¼Œæ‰€ä»¥è°ƒç”¨writeå‘é€2MBæ•°æ®æ—¶ï¼Œwriteå‡½æ•°çš„è¿”å›å€¼åªæœ‰1MBï¼Œè¡¨ç¤ºå†™ç¼“å†²åŒºå·²ç”¨å°½ã€‚å½“æ”¶åˆ°å¯¹æ–¹å‘æ¥çš„ACKæŠ¥æ–‡åï¼Œç¼“å†²åŒºä¸­çš„æ•°æ®æ‰èƒ½é‡Šæ”¾ï¼Œå°±ä¼šäº§ç”Ÿå†™äº‹ä»¶é€šçŸ¥è¿›ç¨‹å‘é€å‰©ä½™çš„é‚£1MBæ•°æ®ã€‚</p><p><img src=\"https://static001.geekbang.org/resource/image/c5/7a/c524965bee6407bd716c7dc33bdd437a.png?wh=903*477\" alt=\"\"></p><p>å¦‚åŒå»ºç«‹è¿æ¥éœ€è¦åŒå‘å»ºç«‹ä¸€æ ·ï¼Œå…³é—­è¿æ¥ä¹Ÿéœ€è¦åŒæ–¹å„è‡ªå…³é—­æ¯ä¸ªæ–¹å‘çš„é€šé“ã€‚ä¸»åŠ¨å…³é—­çš„ä¸€æ–¹å‘é€FINæŠ¥æ–‡ï¼Œåˆ°è¾¾è¢«åŠ¨æ–¹åï¼Œå†…æ ¸è‡ªåŠ¨å›å¤ACKæŠ¥æ–‡ï¼Œè¿™è¡¨ç¤ºä»ä¸»åŠ¨æ–¹åˆ°è¢«åŠ¨æ–¹çš„é€šé“å·²ç»å…³é—­ã€‚<strong>ä½†è¢«åŠ¨æ–¹åˆ°ä¸»åŠ¨æ–¹çš„é€šé“ä¹Ÿéœ€è¦å…³é—­ï¼Œæ‰€ä»¥æ­¤æ—¶è¢«åŠ¨æ–¹ä¼šäº§ç”Ÿè¯»äº‹ä»¶ï¼Œæé†’è¢«åŠ¨æ–¹è°ƒç”¨closeå‡½æ•°å…³é—­è¿æ¥ã€‚</strong></p><p><img src=\"https://static001.geekbang.org/resource/image/b7/96/b73164fd504cc2574066f526ebee7596.png?wh=893*627\" alt=\"\"></p><p>è¿™æ ·ï¼Œæˆ‘ä»¬å°±æ¸…æ¥šäº†TCPæŠ¥æ–‡å¦‚ä½•äº§ç”Ÿäº‹ä»¶ï¼Œä¹Ÿæ˜ç™½å›è°ƒå‡½æ•°ä½•æ—¶æ‰§è¡Œäº†ã€‚ç„¶è€Œï¼ŒåŒæ­¥ä»£ç æ‹†åˆ†æˆå¤šä¸ªå¼‚æ­¥å‡½æ•°æˆæœ¬å¹¶ä¸ä½ï¼Œå’±ä»¬æ‰‹é‡Œæ‹¿ç€äº‹ä»¶é©±åŠ¨è¿™ä¸ªé”¤å­ï¼Œå¯ä¸èƒ½çœ‹åˆ°ä»€ä¹ˆéƒ½åƒæ˜¯é’‰å­ã€‚</p><p>ä»€ä¹ˆæ ·çš„ä»£ç å€¼å¾—åŸºäºäº‹ä»¶æ¥åšæ‹†åˆ†å‘¢ï¼Ÿè¿˜å¾—å›åˆ°é«˜æ€§èƒ½è¿™ä¸ªæœ€ç»ˆç›®æ ‡ä¸Šæ¥ã€‚æˆ‘ä»¬çŸ¥é“ï¼Œåšæ€§èƒ½ä¼˜åŒ–ä¸€å®šè¦æ‰¾å‡ºæ€§èƒ½ç“¶é¢ˆï¼Œé’ˆå¯¹ç“¶é¢ˆåšä¼˜åŒ–æ€§ä»·æ¯”æ‰æœ€é«˜ã€‚å¯¹äºæœåŠ¡å™¨æ¥è¯´ï¼Œå¯¹æœ€æ…¢çš„æ“ä½œåšå¼‚æ­¥åŒ–æ”¹é€ ï¼Œæ‰èƒ½å€¼å›å¼€å‘æ•ˆç‡çš„æŸå¤±ã€‚è€ŒæœåŠ¡é‡Œå¯¹èµ„æºçš„æ“ä½œé€Ÿåº¦ç”±å¿«åˆ°æ…¢ï¼Œä¾æ¬¡æ˜¯CPUã€å†…å­˜ã€ç£ç›˜å’Œç½‘ç»œã€‚CPUå’Œå†…å­˜çš„æ‰§è¡Œé€Ÿåº¦éƒ½æ˜¯çº³ç§’çº§çš„ï¼Œæ— é¡»è€ƒè™‘äº‹ä»¶é©±åŠ¨ï¼Œè€Œç£ç›˜å’Œç½‘ç»œéƒ½å¯ä»¥é‡‡ç”¨äº‹ä»¶é©±åŠ¨çš„å¼‚æ­¥æ–¹å¼å¤„ç†ã€‚</p><p>ç›¸å¯¹è€Œè¨€ï¼Œç½‘ç»œä¸åªé€Ÿåº¦æ…¢ï¼Œè€Œä¸”æ³¢åŠ¨å¾ˆå¤§ï¼Œæ—¢å—åˆ¶äºè¿æ¥å¯¹ç«¯çš„æ€§èƒ½ï¼Œä¹Ÿå—åˆ¶äºç½‘ç»œä¼ è¾“è·¯å¾„ã€‚æŠŠæ“ä½œç½‘ç»œçš„åŒæ­¥APIæ”¹ä¸ºäº‹ä»¶é©±åŠ¨çš„å¼‚æ­¥APIæ”¶ç›Šæœ€å¤§ã€‚è€Œç£ç›˜ï¼ˆç‰¹åˆ«æ˜¯æœºæ¢°ç¡¬ç›˜ï¼‰è®¿é—®é€Ÿåº¦è™½ç„¶ä¸å¿«ï¼Œä½†å®ƒæœ€æ…¢æ—¶ä¹Ÿä¸è¿‡å‡ åæ¯«ç§’ï¼Œæ˜¯å¯æ§çš„ã€‚è€Œä¸”ç›®å‰ç£ç›˜å¼‚æ­¥IOæŠ€æœ¯ï¼ˆå‚è§<a href=\"https://time.geekbang.org/column/article/232676\">[ç¬¬4è®²]</a>ï¼‰è¿˜ä¸æˆç†Ÿï¼Œå®ƒç»•è¿‡äº†PageCacheæ€§èƒ½æŸå¤±å¾ˆå¤§ã€‚æ‰€ä»¥å½“ä¸‹çš„äº‹ä»¶é©±åŠ¨ï¼Œä¸»è¦å°±æ˜¯æŒ‡ç½‘ç»œäº‹ä»¶ã€‚</p><h2>è¯¥æ€æ ·å¤„ç†ç½‘ç»œäº‹ä»¶ï¼Ÿ</h2><p>æœ‰äº†ç½‘ç»œäº‹ä»¶çš„æ¦‚å¿µåï¼Œæˆ‘ä»¬å†æ¥çœ‹ç”¨æˆ·æ€ä»£ç å¦‚ä½•å¤„ç†äº‹ä»¶ã€‚</p><p>ç½‘ç»œäº‹ä»¶æ˜¯ç”±å†…æ ¸äº§ç”Ÿçš„ï¼Œè¿›ç¨‹è¯¥æ€æ ·è·å–åˆ°å®ƒä»¬å‘¢ï¼Ÿå¦‚epollè¿™æ ·çš„å¤šè·¯å¤ç”¨æŠ€æœ¯å¯ä»¥å¸®æˆ‘ä»¬åšåˆ°ã€‚å¤šè·¯å¤ç”¨æ˜¯é€šè®¯é¢†åŸŸçš„è¯æ±‡ï¼Œæœ‰äº›æŠ½è±¡ä½†åŸç†ç¡®å¾ˆç®€å•ã€‚</p><p>æ¯”å¦‚ï¼Œä¸€æ¡é«˜é€Ÿçš„å…‰çº¤ä¸Šï¼Œå…è®¸å¤šä¸ªç”¨æˆ·ç”¨è¾ƒä½çš„ç½‘é€ŸåŒæ—¶é€šè®¯ï¼Œè¿™å°±æ˜¯å¤šè·¯å¤ç”¨ã€‚åŒæ ·é“ç†ï¼Œä¸€ä¸ªè¿›ç¨‹è™½ç„¶ä»»ä¸€æ—¶åˆ»åªèƒ½å¤„ç†ä¸€ä¸ªè¯·æ±‚ï¼Œä½†å¤„ç†æ¯ä¸ªè¯·æ±‚äº§ç”Ÿçš„äº‹ä»¶æ—¶ï¼Œè‹¥è€—æ—¶æ§åˆ¶åœ¨1æ¯«ç§’ä»¥å†…ï¼Œè¿™æ ·1ç§’é’Ÿå°±å¯ä»¥å¤„ç†æ•°åƒä¸ªè¯·æ±‚ï¼Œä»æ›´é•¿çš„æ—¶é—´ç»´åº¦ä¸Šçœ‹ï¼Œå¤šä¸ªè¯·æ±‚å¤ç”¨äº†ä¸€ä¸ªè¿›ç¨‹ï¼Œä¹Ÿå«åšå¤šè·¯å¤ç”¨ï¼ˆæˆ–è€…å«åšæ—¶åˆ†å¤šè·¯å¤ç”¨ï¼‰ã€‚æˆ‘ä»¬ç†ŸçŸ¥çš„epollï¼Œå°±æ˜¯å†…æ ¸æä¾›ç»™ç”¨æˆ·æ€çš„å¤šè·¯å¤ç”¨æ¥å£ï¼Œè¿›ç¨‹å¯ä»¥é€šè¿‡å®ƒä»å†…æ ¸ä¸­è·å–äº‹ä»¶ã€‚</p><p>epollæ˜¯å¦‚ä½•è·å–ç½‘ç»œäº‹ä»¶çš„å‘¢ï¼Ÿæœ€ç®€å•çš„æ–¹æ³•ï¼Œå°±æ˜¯åœ¨è·å–äº‹ä»¶æ—¶ï¼ŒæŠŠæ‰€æœ‰å¹¶å‘è¿æ¥ä¼ ç»™å†…æ ¸ï¼Œå†ç”±å†…æ ¸è¿”å›äº§ç”Ÿäº†äº‹ä»¶çš„è¿æ¥ï¼Œå†å¤„ç†è¿™äº›è¿æ¥å¯¹åº”çš„è¯·æ±‚å³å¯ã€‚epollå‰çš„selectç­‰å¤šè·¯å¤ç”¨å‡½æ•°å°±æ˜¯è¿™ä¹ˆå¹²çš„ã€‚</p><p>ç„¶è€Œï¼ŒC10Mæ„å‘³ç€æœ‰ä¸€åƒä¸‡ä¸ªè¿æ¥ï¼Œè‹¥æ¯ä¸ªsocketæ˜¯4å­—èŠ‚ï¼Œé‚£ä¹ˆ1åƒä¸‡è¿æ¥å°±æ˜¯40Må­—èŠ‚ã€‚è¿™æ ·ï¼Œæ¯æ”¶é›†ä¸€æ¬¡äº‹ä»¶ï¼Œå°±éœ€è¦ä»ç”¨æˆ·æ€å¤åˆ¶40Må­—èŠ‚åˆ°å†…æ ¸æ€ã€‚è€Œä¸”ï¼Œé«˜æ€§èƒ½Serverå¿…é¡»åŠæ—¶åœ°å¤„ç†ç½‘ç»œäº‹ä»¶ï¼Œæ‰€ä»¥æ¯éš”å‡ åæ¯«ç§’å°±è¦æ”¶é›†ä¸€æ¬¡äº‹ä»¶ï¼Œæ€§èƒ½æ¶ˆè€—å·¨å¤§ã€‚</p><p>epollä¸ºäº†é™ä½æ€§èƒ½æ¶ˆè€—ï¼ŒæŠŠè·å–äº‹ä»¶æ‹†åˆ†æˆä¸¤æ­¥ã€‚</p><ul>\n<li>ç¬¬ä¸€æ­¥æŠŠéœ€è¦ç›‘æ§çš„socketä¼ ç»™å†…æ ¸ï¼ˆepoll_ctlå‡½æ•°ï¼‰ï¼Œå®ƒä»…åœ¨è¿æ¥å»ºç«‹ç­‰æœ‰é™çš„æ—¶æœºè°ƒç”¨ï¼›</li>\n<li>ç¬¬äºŒæ­¥æ”¶é›†äº‹ä»¶ï¼ˆepoll_waitå‡½æ•°ï¼‰ä¾¿ä¸ç”¨ä¼ é€’socketäº†ï¼Œè¿™æ ·å°±æŠŠsocketçš„é‡å¤ä¼ é€’æ”¹ä¸ºäº†ä¸€æ¬¡ä¼ é€’ï¼Œé™ä½äº†æ€§èƒ½æŸè€—ã€‚</li>\n</ul><p>ç”±äºç½‘å¡çš„å¤„ç†èƒ½åŠ›æœ‰é™ï¼Œåƒå…†ç½‘å¡ä¸‹ï¼Œæ¯ç§’åªèƒ½æ¥æ”¶100MBå·¦å³çš„æ•°æ®ï¼Œå¦‚æœæ¯ä¸ªè¯·æ±‚çº¦10KBï¼Œé‚£ä¹ˆæ¯ç§’å¤§æ¦‚æœ‰1ä¸‡ä¸ªè¯·æ±‚åˆ°è¾¾ã€10ä¸‡ä¸ªäº‹ä»¶éœ€è¦å¤„ç†ã€‚è¿™æ ·ï¼Œå³ä½¿æ¯éš”100æ¯«ç§’æ”¶é›†ä¸€æ¬¡äº‹ä»¶ï¼ˆè°ƒç”¨epoll_waitï¼‰ï¼Œæ¯æ¬¡ä¹Ÿä¸è¿‡åªæœ‰1ä¸‡ä¸ªäº‹ä»¶ï¼ˆ100000 Event/s * 0.1s = 10000 Event/sï¼‰éœ€è¦å¤„ç†ï¼Œåªè¦ä¿è¯å¤„ç†ä¸€ä¸ªäº‹ä»¶çš„å¹³å‡æ—¶é—´å°äº10å¾®ç§’ï¼ˆå¤šæ ¸å¤„ç†å™¨å¯ä»¥åšåˆ°ï¼‰ï¼Œ100æ¯«ç§’å†…å°±å¯ä»¥å¤„ç†å®Œè¿™äº›äº‹ä»¶ï¼ˆ100ms = 10us * 10000ï¼‰ã€‚ å› æ­¤ï¼Œå“ªæ€•æœ‰1åƒä¸‡å¹¶å‘è¿æ¥ï¼Œä¹Ÿèƒ½ä¿è¯1ä¸‡RPSçš„å¤„ç†èƒ½åŠ›ï¼Œè¿™å°±æ˜¯epollèƒ½åœ¨C10Mä¸‹å®ç°é«˜ååé‡çš„åŸå› ã€‚</p><p>è¿›ç¨‹è·å–åˆ°äº§ç”Ÿäº‹ä»¶çš„socketåï¼Œåˆè¯¥å¦‚ä½•å¤„ç†å®ƒå‘¢ï¼Ÿè¿™é‡Œçš„æ ¸å¿ƒçº¦æŸæ˜¯ï¼Œå¤„ç†ä»»ä½•ä¸€ä¸ªäº‹ä»¶çš„è€—æ—¶éƒ½åº”è¯¥æ˜¯å¾®ç§’çº§æˆ–è€…æ¯«ç§’çº§ï¼Œå¦åˆ™å°±ä¼šå»¶è¯¯å…¶ä»–äº‹ä»¶çš„å¤„ç†ï¼Œä¸åªé™ä½äº†ç”¨æˆ·çš„ä½“éªŒï¼Œè€Œä¸”ä¼šå½¢æˆæ¶æ€§å¾ªç¯ã€‚</p><p>æˆ‘ä»¬çŸ¥é“ï¼Œä¸ºäº†åº”å¯¹ç½‘ç»œçš„ä¸ç¡®å®šæ€§ï¼Œæ¯ä¸ªå‚ä¸ç½‘ç»œé€šè®¯çš„è¿›ç¨‹éƒ½ä¼šä¸ºè¯·æ±‚è®¾ç½®è¶…æ—¶æ—¶é—´ã€‚ä¸€æ—¦æŸä¸ªsocketä¸Šçš„äº‹ä»¶è¿Ÿè¿Ÿä¸è¢«å¤„ç†ï¼Œå½“å®¢æˆ·ç«¯çš„è¶…æ—¶å®šæ—¶å™¨è§¦å‘æ—¶ï¼Œå®¢æˆ·ç«¯å¾€å¾€ä¼šå…³é—­è¿æ¥å¹¶é‡å‘è¯·æ±‚ï¼Œè¿™ä¼šè®©æœåŠ¡å™¨é›ªä¸ŠåŠ éœœã€‚</p><p>æ€æ ·ä¿è¯å¤„ç†ä¸€ä¸ªäº‹ä»¶çš„æ—¶é—´ä¸ä¼šå¤ªé•¿å‘¢ï¼Ÿ  æˆ‘ä»¬æŠŠå¤„ç†äº‹ä»¶çš„ä»£ç åˆ†ä¸ºä¸‰ç±»æ¥çœ‹ã€‚</p><p>ç¬¬ä¸€ç±»æ˜¯è®¡ç®—ä»»åŠ¡ï¼Œè™½ç„¶å†…å­˜ã€CPUçš„é€Ÿåº¦å¾ˆå¿«ï¼Œç„¶è€Œå¾ªç¯æ‰§è¡Œä¹Ÿå¯èƒ½è€—æ—¶è¾¾åˆ°ç§’çº§ã€‚æ‰€ä»¥ï¼Œå¦‚æœä¸€å®šè¦å¼•å…¥éœ€è¦å¯†é›†è®¡ç®—æ‰èƒ½å®Œæˆçš„è¯·æ±‚ï¼Œä¸ºäº†ä¸é˜»ç¢å…¶ä»–äº‹ä»¶çš„å¤„ç†ï¼Œè¦ä¹ˆæŠŠè¿™æ ·çš„è¯·æ±‚æ”¾åœ¨ç‹¬ç«‹çš„çº¿ç¨‹ä¸­å®Œæˆï¼Œè¦ä¹ˆæŠŠè¯·æ±‚çš„å¤„ç†è¿‡ç¨‹æ‹†åˆ†æˆå¤šæ®µï¼Œç¡®ä¿æ¯æ®µèƒ½å¤Ÿå¿«é€Ÿæ‰§è¡Œå®Œï¼ŒåŒæ—¶æ¯æ®µæ‰§è¡Œå®Œéƒ½è¦å‡ç­‰åœ°å¤„ç†å…¶ä»–äº‹ä»¶ï¼Œè¿™æ ·é€šè¿‡æ”¾æ…¢è¯¥è¯·æ±‚çš„å¤„ç†æ—¶é—´ï¼Œå°±ä¿éšœäº†å…¶ä»–è¯·æ±‚çš„åŠæ—¶å¤„ç†ã€‚</p><p>ç¬¬äºŒç±»ä¼šè¯»å†™ç£ç›˜ï¼Œç”±äºç£ç›˜çš„å†™å…¥æ“ä½œä½¿ç”¨äº†PageCacheçš„å»¶è¿Ÿå†™ç‰¹æ€§ï¼Œå½“writeå‡½æ•°è¿”å›æ—¶åªæ˜¯å¤åˆ¶åˆ°äº†å†…å­˜ä¸­ï¼Œæ‰€ä»¥å†™å…¥æ“ä½œå¾ˆå¿«ã€‚ç£ç›˜çš„è¯»å–æ“ä½œå°±æ¯”è¾ƒæ…¢äº†ï¼Œè¿™æ—¶ï¼Œé€šå¸¸è¦æŠŠå¤§æ–‡ä»¶çš„è¯»å–ï¼Œæ‹†åˆ†æˆè®¸å¤šä»½ï¼Œæ¯ä»½ä»…æœ‰å‡ åKBï¼Œé™ä½å•æ¬¡æ“ä½œçš„è€—æ—¶ã€‚</p><p>ç¬¬ä¸‰ç±»æ˜¯é€šè¿‡ç½‘ç»œè®¿é—®ä¸Šæ¸¸æœåŠ¡ã€‚ä¸å¤„ç†å®¢æˆ·ç«¯è¯·æ±‚ç›¸ä¼¼ï¼Œæˆ‘ä»¬å¿…é¡»ä½¿ç”¨éé˜»å¡socketï¼Œç”¨äº‹ä»¶é©±åŠ¨æ–¹å¼å¤„ç†è¯·æ±‚ã€‚éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œè®¸å¤šç½‘ç»œæœåŠ¡æä¾›çš„SDKï¼Œéƒ½æ˜¯åŸºäºé˜»å¡socketå®ç°çš„ï¼Œä½¿ç”¨å‰å¿…é¡»å…ˆåšå®Œéé˜»å¡æ”¹é€ ã€‚æ¯”å¦‚Memcachedçš„å®˜æ–¹SDKæ˜¯ç”¨é˜»å¡socketå®ç°çš„ï¼ŒNginxå¦‚æœç›´æ¥ä½¿ç”¨è¯¥SDKè®¿é—®å®ƒï¼Œæ€§èƒ½å°±ä¼šä¸€è½åƒä¸ˆã€‚æ­£ç¡®çš„è®¿é—®æ–¹å¼ï¼Œæ˜¯ä½¿ç”¨ç¬¬ä¸‰æ–¹æä¾›çš„ngx_http_memcached_moduleæ¨¡å—ï¼Œå®ƒç”¨éé˜»å¡socketé‡æ–°å°è£…äº†SDKã€‚</p><p>æ€»ä¹‹ï¼Œç½‘ç»œæŠ¥æ–‡åˆ°è¾¾åï¼Œå†…æ ¸å°±äº§ç”Ÿäº†è¯»ã€å†™äº‹ä»¶ï¼Œè€Œepollå‡½æ•°ä½¿å¾—è¿›ç¨‹å¯ä»¥é«˜æ•ˆåœ°æ”¶é›†åˆ°è¿™äº›äº‹ä»¶ã€‚æ¥ä¸‹æ¥ï¼Œè¦ç¡®ä¿åœ¨è¿›ç¨‹ä¸­å¤„ç†æ¯ä¸ªäº‹ä»¶çš„æ—¶é—´è¶³å¤ŸçŸ­ï¼Œæ‰èƒ½åŠæ—¶åœ°å¤„ç†æ‰€æœ‰è¯·æ±‚ï¼Œè¿™ä¸ªè¿‡ç¨‹ä¸­æ—¢è¦é¿å…é˜»å¡socketçš„ä½¿ç”¨ï¼Œä¹Ÿè¦æŠŠè€—æ—¶è¿‡é•¿çš„æ“ä½œæ‹†æˆå¤šä»½æ‰§è¡Œã€‚æœ€ç»ˆï¼Œé€šè¿‡å¿«é€Ÿã€åŠæ—¶ã€å‡ç­‰åœ°æ‰§è¡Œæ‰€æœ‰äº‹ä»¶ï¼Œå¼‚æ­¥Serverå®ç°äº†é«˜å¹¶å‘ã€‚</p><h2>å°ç»“</h2><p>æœ€åæˆ‘ä»¬å¯¹è¿™ä¸€è®²åšä¸ªå°ç»“ã€‚å¼‚æ­¥æœåŠ¡æ”¹ä¸ºä»äº‹ä»¶å±‚é¢å¤„ç†è¯·æ±‚ï¼Œåœ¨epollè¿™æ ·çš„å¤šè·¯å¤ç”¨æœºåˆ¶ååŠ©ä¸‹ï¼Œæœ€ç»ˆå®ç°äº†C10Mçº§åˆ«çš„é«˜å¹¶å‘æœåŠ¡ã€‚</p><p>äº‹ä»¶æœ‰å¾ˆå¤šç§ï¼Œç½‘ç»œæ¶ˆæ¯çš„ä¼ è¾“æ—¢æ…¢åˆä¸å¯æ§ï¼Œæ‰€ä»¥ç”¨ç½‘ç»œäº‹ä»¶é©±åŠ¨è¯·æ±‚çš„æ€§ä»·æ¯”æœ€é«˜ã€‚è¿™æ ·ï¼Œå°±éœ€è¦ä½ äº†è§£TCPæŠ¥æ–‡æ˜¯å¦‚ä½•äº§ç”Ÿäº‹ä»¶çš„ã€‚</p><p>TCPè¿æ¥å»ºç«‹æ—¶ï¼Œä¼šåœ¨å®¢æˆ·ç«¯äº§ç”Ÿå†™äº‹ä»¶ï¼Œåœ¨æœåŠ¡å™¨ç«¯äº§ç”Ÿè¯»äº‹ä»¶ã€‚è¿æ¥å…³é—­æ—¶ï¼Œåˆ™ä¼šåœ¨è¢«åŠ¨å…³é—­ç«¯äº§ç”Ÿè¯»äº‹ä»¶ã€‚åœ¨è¿æ¥ä¸Šæ”¶å‘æ¶ˆæ¯æ—¶ï¼Œä¹Ÿä¼šäº§ç”Ÿäº‹ä»¶ï¼Œå…¶ä¸­å‘é€æ¶ˆæ¯å‰çš„å†™äº‹ä»¶ä¸å†…æ ¸åˆ†é…çš„ç¼“å†²åŒºæœ‰å…³ã€‚</p><p>æ¸…æ¥šäº†äº‹ä»¶ä¸TCPæŠ¥æ–‡çš„å…³ç³»åï¼Œå¯ä»¥ç”¨å¤šè·¯å¤ç”¨æŠ€æœ¯è·å–äº‹ä»¶ï¼Œå…¶ä¸­epollæ˜¯ä½¼ä½¼è€…ï¼Œå®ƒå–æ¶ˆäº†æ”¶é›†äº‹ä»¶æ—¶é‡å¤ä¼ é€’çš„å¤§é‡socketå‚æ•°ï¼Œç»™C10Mçš„å®ç°æä¾›äº†åŸºç¡€ã€‚</p><p>ä½ éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œå¤„ç†epollæ”¶é›†åˆ°çš„äº‹ä»¶æ—¶ï¼Œå¿…é¡»ä¿è¯å¤„ç†ä¸€ä¸ªäº‹ä»¶çš„å¹³å‡æ—¶é—´åœ¨æ¯«ç§’çº§ä»¥å†…ã€‚ä¼ ç»Ÿçš„é˜»å¡socketæ˜¯åšä¸åˆ°çš„ï¼Œæ‰€ä»¥å¿…é¡»ç”¨éé˜»å¡socketæ›¿æ¢é˜»å¡socketã€‚å¦‚æœäº‹ä»¶çš„å›è°ƒå‡½æ•°è€—æ—¶è¿‡é•¿ï¼Œä¹Ÿå¾—æ‹†åˆ†ä¸ºå¤šä¸ªè€—æ—¶çŸ­çš„å‡½æ•°ï¼Œç”¨å¤šæ¬¡äº‹ä»¶ï¼ˆæ¯”å¦‚å®šæ—¶å™¨äº‹ä»¶ï¼‰çš„è§¦å‘æ¥æ›¿ä»£ã€‚</p><p>è™½ç„¶æˆ‘ä»¬æœ‰äº†ä¸Šè¿°çš„äº‹ä»¶é©±åŠ¨æ–¹æ¡ˆï¼Œä½†å®ç°C10Mè¿˜éœ€è¦æ›´è°¨æ…åœ°ä½¿ç”¨ä¸è¿‡æ•°ç™¾GBçš„æœåŠ¡å™¨å†…å­˜ã€‚å…³äºå¦‚ä½•é™ä½å†…å­˜çš„æ¶ˆè€—ï¼Œå¯ä»¥å…³æ³¨<a href=\"https://time.geekbang.org/column/article/230221\">[ç¬¬2è®²]</a> æåˆ°çš„å†…å­˜æ± ï¼Œ[ç¬¬11è®²] è¿˜ä¼šä»‹ç»å¦‚ä½•å‡å°‘è¿æ¥ç¼“å†²åŒºçš„ç©ºé—´å ç”¨ã€‚</p><p>è¿™ä¸€è®²æˆ‘ä»¬ä»‹ç»äº†äº‹ä»¶é©±åŠ¨çš„æ€»ä½“æ–¹æ¡ˆï¼Œä½†C10Méœ€è¦é«˜æ•ˆçš„ç”¨å¿ƒå‡ ä¹æ‰€æœ‰æœåŠ¡å™¨èµ„æºï¼Œæ‰€ä»¥ï¼Œæˆ‘ä»¬è¿˜å¾—é€šè¿‡Linuxæ›´ç²¾ç»†åœ°æ§åˆ¶TCPçš„è¡Œä¸ºï¼Œæ¥ä¸‹æ¥çš„3è®²æˆ‘ä»¬å°†æ·±å…¥Linuxï¼Œè®¨è®ºå¦‚ä½•ä¼˜åŒ–TCPçš„æ€§èƒ½ã€‚</p><h2>æ€è€ƒé¢˜</h2><p>æœ€åï¼Œç•™ç»™ä½ ä¸€ä¸ªæ€è€ƒé¢˜ï¼Œéœ€è¦CPUåšå¯†é›†è®¡ç®—çš„è¯·æ±‚ï¼Œè¯¥å¦‚ä½•æ‹†åˆ†åˆ°äº‹ä»¶é©±åŠ¨æ¡†æ¶ä¸­å‘¢ï¼Ÿæ¬¢è¿ä½ åœ¨ç•™è¨€åŒºç•™è¨€ï¼Œä¸å¤§å®¶ä¸€èµ·æ¢è®¨ã€‚</p><p>æ„Ÿè°¢é˜…è¯»ï¼Œå¦‚æœä½ è§‰å¾—è¿™èŠ‚è¯¾å¯¹ä½ æœ‰ä¸€äº›å¯å‘ï¼Œä¹Ÿæ¬¢è¿æŠŠå®ƒåˆ†äº«ç»™ä½ çš„æœ‹å‹ã€‚</p>","neighbors":{"left":{"article_title":"07 | æ€§èƒ½å¥½ï¼Œæ•ˆç‡é«˜çš„ä¸€å¯¹å¤šé€šè®¯è¯¥å¦‚ä½•å®ç°ï¼Ÿ","id":235302},"right":{"article_title":"09 | å¦‚ä½•æå‡TCPä¸‰æ¬¡æ¡æ‰‹çš„æ€§èƒ½ï¼Ÿ","id":237612}},"comments":[{"had_liked":false,"id":220544,"user_name":"ä¸€æ­¥","can_delete":false,"product_type":"c1","uid":1005391,"ip_address":"","ucode":"73CEA468CE70C3","user_header":"https://static001.geekbang.org/account/avatar/00/0f/57/4f/6fb51ff1.jpg","comment_is_top":false,"comment_ctime":1590286439,"is_pvip":true,"replies":[{"id":"81549","content":"ä½ å¥½ä¸€æ­¥ï¼Œæˆ‘è¿™é‡Œæƒ³è¡¨è¾¾çš„æ˜¯ï¼šä¸€ä¸ªè¯·æ±‚è‹¥æ˜¯10KBï¼Œé‚£ä¹ˆMSSåœ¨1KBå·¦å³çš„è¯ï¼Œæ„å‘³ç€ä¸€ä¸ªè¯·æ±‚ä¼šæœ‰10ä¸ªå·¦å³çš„æŠ¥æ–‡ï¼Œè‹¥æ˜¯æŠ¥æ–‡ä¸æ˜¯è¿ç»­åˆ°è¾¾çš„è¯ï¼Œæ˜¯å¯ä»¥äº§ç”Ÿ10ä¸ªäº‹ä»¶çš„","user_name":"ä½œè€…å›å¤","user_name_real":"é™¶è¾‰","uid":"1283912","ctime":1590411333,"ip_address":"","comment_id":220544,"utype":1}],"discussion_count":3,"race_medal":0,"score":"117554403431","product_id":100051201,"comment_content":"å¦‚æœæ¯ä¸ªè¯·æ±‚çº¦ 10KBï¼Œé‚£ä¹ˆæ¯ç§’å¤§æ¦‚æœ‰ 1 ä¸‡ä¸ªè¯·æ±‚åˆ°è¾¾ã€10 ä¸‡ä¸ªäº‹ä»¶éœ€è¦å¤„ç†<br>-------------------------<br>è¿™é‡Œä¸ºä»€ä¹ˆ 1 ä¸‡ä¸ªè¯·æ±‚ä¼šæœ‰ 10ä¸‡ä¸ªäº‹ä»¶å‘¢ï¼Ÿ æ¯ä¸€ä¸ª TCP é“¾æ¥åœ¨æœåŠ¡ç«¯ä¸å°±æ˜¯ä¼šäº§ç”Ÿä¸€ä¸ª è¯»äº‹ä»¶ å—ï¼Ÿ","like_count":28,"discussions":[{"author":{"id":1283912,"avatar":"https://static001.geekbang.org/account/avatar/00/13/97/48/550271b0.jpg","nickname":"é™¶è¾‰","note":"","ucode":"F81A9087435953","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":496174,"discussion_content":"ä½ å¥½ä¸€æ­¥ï¼Œæˆ‘è¿™é‡Œæƒ³è¡¨è¾¾çš„æ˜¯ï¼šä¸€ä¸ªè¯·æ±‚è‹¥æ˜¯10KBï¼Œé‚£ä¹ˆMSSåœ¨1KBå·¦å³çš„è¯ï¼Œæ„å‘³ç€ä¸€ä¸ªè¯·æ±‚ä¼šæœ‰10ä¸ªå·¦å³çš„æŠ¥æ–‡ï¼Œè‹¥æ˜¯æŠ¥æ–‡ä¸æ˜¯è¿ç»­åˆ°è¾¾çš„è¯ï¼Œæ˜¯å¯ä»¥äº§ç”Ÿ10ä¸ªäº‹ä»¶çš„","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1590411333,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1607864,"avatar":"https://static001.geekbang.org/account/avatar/00/18/88/b8/7527da95.jpg","nickname":"é™ˆç¦","note":"","ucode":"48F974137EF0BE","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":320864,"discussion_content":"MSSæœ€å¤§ä¼ è¾“å¤§å°çš„ç¼©å†™ï¼ŒMSS: Maxitum Segment Size æœ€å¤§åˆ†æ®µå¤§å°,æ˜¯TCPåè®®é‡Œé¢çš„ä¸€ä¸ªæ¦‚å¿µ","likes_number":2,"is_delete":false,"is_hidden":false,"ctime":1604493381,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1110039,"avatar":"https://static001.geekbang.org/account/avatar/00/10/f0/17/796a3d20.jpg","nickname":"è¨€åå¹´","note":"","ucode":"67B8B49C3A3B17","race_medal":0,"user_type":1,"is_pvip":true},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":342732,"discussion_content":"ç†è§£äº†","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1610800355,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":217438,"user_name":"myrfy","can_delete":false,"product_type":"c1","uid":1169401,"ip_address":"","ucode":"2814BAE5D70098","user_header":"","comment_is_top":false,"comment_ctime":1589505712,"is_pvip":false,"replies":[{"id":"80601","content":"myrfyç«™åœ¨äº†æ›´é«˜çš„æ¶æ„å±‚é¢å»è®¾è®¡ï¼Œå¾ˆå¥½çš„æ–¹æ¡ˆï¼","user_name":"ä½œè€…å›å¤","user_name_real":"é™¶è¾‰","uid":"1283912","ctime":1589684685,"ip_address":"","comment_id":217438,"utype":1}],"discussion_count":1,"race_medal":0,"score":"91783818928","product_id":100051201,"comment_content":"æˆ‘è®¤ä¸ºæ¶‰åŠåˆ°CPUå¯†é›†è®¡ç®—ï¼Œå°±ä¸åº”è¯¥å†è€ƒè™‘C10Mçš„é—®é¢˜äº†ã€‚C10Mæˆ‘ä»¬å¯ä»¥æ”¾åœ¨ä¾‹å¦‚ç½‘å…³ç­‰é€»è¾‘ç®€å•çš„åœ°æ–¹ï¼Œè´Ÿè´£æ•°æ®è½¬å‘å³å¯ã€‚çœŸæ­£çš„è®¡ç®—æ”¾åœ¨æœ¬åœ°çº¿ç¨‹æ± æ˜¯ä¸€ç§æ–¹æ³•ï¼Œä½†æˆ‘æ›´å€¾å‘äºè½¬å‘åˆ°é¢å¤–çš„è®¡ç®—å¤„ç†é›†ç¾¤å»å¤„ç†ã€‚","like_count":22,"discussions":[{"author":{"id":1283912,"avatar":"https://static001.geekbang.org/account/avatar/00/13/97/48/550271b0.jpg","nickname":"é™¶è¾‰","note":"","ucode":"F81A9087435953","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":495148,"discussion_content":"myrfyç«™åœ¨äº†æ›´é«˜çš„æ¶æ„å±‚é¢å»è®¾è®¡ï¼Œå¾ˆå¥½çš„æ–¹æ¡ˆï¼","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1589684685,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":218005,"user_name":"å¿†æ°´å¯’","can_delete":false,"product_type":"c1","uid":1147453,"ip_address":"","ucode":"E3F86BD8AA8903","user_header":"https://static001.geekbang.org/account/avatar/00/11/82/3d/356fc3d6.jpg","comment_is_top":false,"comment_ctime":1589693037,"is_pvip":false,"replies":[{"id":"80630","content":"å¯¹çš„ï¼Œä¸“ç”¨çš„ç¯å¢ƒæ›´æœ‰æ•ˆç‡","user_name":"ä½œè€…å›å¤","user_name_real":"é™¶è¾‰","uid":"1283912","ctime":1589699038,"ip_address":"","comment_id":218005,"utype":1}],"discussion_count":1,"race_medal":0,"score":"87489038957","product_id":100051201,"comment_content":"æˆ‘è§‰å¾—myrfyçš„æ–¹æ¡ˆå¾ˆå¥½ï¼Œå¦‚æœè®¡ç®—å¯†é›†å‹è¾¾åˆ°ä¸€å®šæ ‡å‡†ï¼Œåˆ™å¯ä»¥ä½¿ç”¨ä¸“é—¨çš„é›†ç¾¤å»å¤„ç†ï¼Œç”šè‡³ä¸“ç”¨èŠ¯ç‰‡ã€‚<br>æˆ‘ä¹‹å‰è®¡ç®—ä½¿ç”¨å‚…ç«‹å¶å˜æ¢éœ€è¦è®¡ç®—å¤§é‡çš„åŸºå¸¦ä¿¡å·ï¼Œæˆ‘å°±æ˜¯ä½¿ç”¨ä¸“ç”¨çš„FPGAèŠ¯ç‰‡è¿›è¡Œå¤„ç†çš„ã€‚<br>å¦‚æœè®¡ç®—é‡åœ¨æœ¬æœºå¯ä»¥åšï¼Œåˆ™å¯ä»¥ç”±ä¸“é—¨çš„reactorçº¿ç¨‹æ”¶è¿›æ¥ï¼Œå…¶ä»–reactorçº¿ç¨‹æ± å»è®¡ç®—ã€‚<br>å½“ç„¶äº†ï¼Œç½‘ç»œå±‚è¿˜å¯ä»¥ä½¿ç”¨dpdkç­‰æŠ€æœ¯ä¼˜åŒ–ï¼Œè·³è¿‡åè®®æ ˆç›´æ¥å¾—åˆ°æ•°æ®ã€‚","like_count":21,"discussions":[{"author":{"id":1283912,"avatar":"https://static001.geekbang.org/account/avatar/00/13/97/48/550271b0.jpg","nickname":"é™¶è¾‰","note":"","ucode":"F81A9087435953","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":495320,"discussion_content":"å¯¹çš„ï¼Œä¸“ç”¨çš„ç¯å¢ƒæ›´æœ‰æ•ˆç‡","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1589699038,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":217529,"user_name":"åˆ†æ¸…äº‘æ·¡","can_delete":false,"product_type":"c1","uid":1269873,"ip_address":"","ucode":"7045AE6BF72D31","user_header":"https://static001.geekbang.org/account/avatar/00/13/60/71/895ee6cf.jpg","comment_is_top":false,"comment_ctime":1589526516,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"48834166772","product_id":100051201,"comment_content":"è§è¿‡çš„æœ€è¯¦ç»†ã€ç³»ç»Ÿçš„å…³äºå†™ç¼“å†²çš„åˆ†æï¼šhttps:&#47;&#47;plantegg.github.io&#47;2019&#47;09&#47;28&#47;%E5%B0%B1%E6%98%AF%E8%A6%81%E4%BD%A0%E6%87%82TCP--%E6%80%A7%E8%83%BD%E5%92%8C%E5%8F%91%E9%80%81%E6%8E%A5%E6%94%B6Buffer%E7%9A%84%E5%85%B3%E7%B3%BB&#47;","like_count":12},{"had_liked":false,"id":222690,"user_name":"é¾™é¾™","can_delete":false,"product_type":"c1","uid":1142957,"ip_address":"","ucode":"C6619820ABCE1C","user_header":"https://static001.geekbang.org/account/avatar/00/11/70/ad/cc353727.jpg","comment_is_top":false,"comment_ctime":1590893927,"is_pvip":false,"replies":[{"id":"82267","content":"ä½ å¥½é¾™é¾™ï¼Œè¿™é‡Œæœ‰2å±‚æ„æ€ï¼Œéƒ½æ˜¯æœåŠ¡äºepollçš„è®¾è®¡æ€æƒ³è¿™ä¸€ä¸ªç›®çš„ï¼š<br>1ã€è¿™æ®µè¯çš„ä¸Šä¸‹æ–‡ï¼Œæ˜¯æŒ‡å•æ¬¡è·å–ç½‘ç»œäº‹ä»¶æ—¶ï¼Œä½ å¯ä»¥ç†è§£ä¸ºè°ƒç”¨epoll_waitç³»ç»Ÿè°ƒç”¨ï¼Œå®ƒçš„é€Ÿåº¦ä¸å¹¶å‘è¿æ¥æ€»æ•°æ— å…³ï¼Œç›¸å¯¹äºä¹‹å‰çš„select&#47;pollç³»ç»Ÿè°ƒç”¨ï¼ˆå®ƒä»¬éƒ½ä¸å¹¶å‘è¿æ¥æ€»æ•°ç›¸å…³ï¼‰ï¼Œå› æ­¤epoll_waité€Ÿåº¦å¾ˆå¿«ï¼Œè¿™æ˜¯å®ç°é«˜ååé‡çš„å…³é”®ã€‚<br>2ã€æœ‰äº›åº”ç”¨ä¼šé•¿æ—¶é—´ä¿æŒTCPé•¿è¿æ¥ï¼Œä½†å¹¶æ²¡æœ‰æ¶ˆæ¯é€šè®¯ï¼ˆæ¯”å¦‚GPSç­‰IoTè®¾å¤‡ä¸æœåŠ¡å™¨ä¹‹é—´çš„é€šè®¯ï¼‰ï¼Œæ­¤æ—¶1åƒä¸‡å¹¶å‘è¿æ¥ä¸‹ï¼Œå¦‚æœèƒ½å¤Ÿç»´æŒ1ä¸‡RPSï¼Œè¿™ä¹Ÿæ˜¯åªæœ‰epollæ‰èƒ½åšåˆ°çš„ï¼Œpoll&#47;selectæ˜¯ä¸å¯èƒ½åšåˆ°çš„ã€‚","user_name":"ä½œè€…å›å¤","user_name_real":"é™¶è¾‰","uid":"1283912","ctime":1591060079,"ip_address":"","comment_id":222690,"utype":1}],"discussion_count":1,"race_medal":0,"score":"31655664999","product_id":100051201,"comment_content":"å› æ­¤ï¼Œå“ªæ€•æœ‰ 1 åƒä¸‡å¹¶å‘è¿æ¥ï¼Œä¹Ÿèƒ½ä¿è¯ 1 ä¸‡ RPS çš„å¤„ç†èƒ½åŠ›ï¼Œè¿™å°±æ˜¯ epoll èƒ½åœ¨ C10M ä¸‹å®ç°é«˜ååé‡çš„åŸå› ã€‚<br>â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”-<br>è€å¸ˆï¼Œè¿™æ®µè¯æˆ‘ä¸å¤ªç†è§£ï¼Œ1åƒä¸‡çš„å¹¶å‘è¿æ¥ï¼Œåªæœ‰1ä¸‡çš„RPS è¿™èƒ½ç®—é«˜ååé‡å—ï¼Ÿç›¸å½“äºæ¯ç§’åªæœ‰1000ä¸ªäººä¸­çš„1ä¸ªäººå¾—åˆ°å“åº”ã€‚è¿˜æ˜¯æˆ‘ç†è§£é”™äº†ï¼Œæ‚¨è¡¨è¿°çš„æ˜¯å¦ä¸€å±‚æ„æ€ï¼Ÿè¯·è€å¸ˆé‡Šç–‘ä¸‹ï¼Œè°¢è°¢","like_count":8,"discussions":[{"author":{"id":1283912,"avatar":"https://static001.geekbang.org/account/avatar/00/13/97/48/550271b0.jpg","nickname":"é™¶è¾‰","note":"","ucode":"F81A9087435953","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":496885,"discussion_content":"ä½ å¥½é¾™é¾™ï¼Œè¿™é‡Œæœ‰2å±‚æ„æ€ï¼Œéƒ½æ˜¯æœåŠ¡äºepollçš„è®¾è®¡æ€æƒ³è¿™ä¸€ä¸ªç›®çš„ï¼š\n1ã€è¿™æ®µè¯çš„ä¸Šä¸‹æ–‡ï¼Œæ˜¯æŒ‡å•æ¬¡è·å–ç½‘ç»œäº‹ä»¶æ—¶ï¼Œä½ å¯ä»¥ç†è§£ä¸ºè°ƒç”¨epoll_waitç³»ç»Ÿè°ƒç”¨ï¼Œå®ƒçš„é€Ÿåº¦ä¸å¹¶å‘è¿æ¥æ€»æ•°æ— å…³ï¼Œç›¸å¯¹äºä¹‹å‰çš„select/pollç³»ç»Ÿè°ƒç”¨ï¼ˆå®ƒä»¬éƒ½ä¸å¹¶å‘è¿æ¥æ€»æ•°ç›¸å…³ï¼‰ï¼Œå› æ­¤epoll_waité€Ÿåº¦å¾ˆå¿«ï¼Œè¿™æ˜¯å®ç°é«˜ååé‡çš„å…³é”®ã€‚\n2ã€æœ‰äº›åº”ç”¨ä¼šé•¿æ—¶é—´ä¿æŒTCPé•¿è¿æ¥ï¼Œä½†å¹¶æ²¡æœ‰æ¶ˆæ¯é€šè®¯ï¼ˆæ¯”å¦‚GPSç­‰IoTè®¾å¤‡ä¸æœåŠ¡å™¨ä¹‹é—´çš„é€šè®¯ï¼‰ï¼Œæ­¤æ—¶1åƒä¸‡å¹¶å‘è¿æ¥ä¸‹ï¼Œå¦‚æœèƒ½å¤Ÿç»´æŒ1ä¸‡RPSï¼Œè¿™ä¹Ÿæ˜¯åªæœ‰epollæ‰èƒ½åšåˆ°çš„ï¼Œpoll/selectæ˜¯ä¸å¯èƒ½åšåˆ°çš„ã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1591060079,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":217394,"user_name":"é‚£æ—¶åˆ»","can_delete":false,"product_type":"c1","uid":1150927,"ip_address":"","ucode":"B0D150856C3A4A","user_header":"https://static001.geekbang.org/account/avatar/00/11/8f/cf/890f82d6.jpg","comment_is_top":false,"comment_ctime":1589476516,"is_pvip":false,"replies":[{"id":"80418","content":"è¿™ä¸ªè¯»ã€å†™é¢å¯¹çš„å¯¹è±¡ï¼Œæ˜¯åº”ç”¨ä»£ç ã€‚SYN+ACKå¯¹äºç³»ç»Ÿå±‚æ¥è¯´ï¼Œæ˜¯åˆ°è¾¾äº†1ä¸ªæŠ¥æ–‡ï¼Œéœ€è¦å†…æ ¸å‘é€ACKå»å¤„ç†ï¼Œä½†å¯¹äºåº”ç”¨å±‚æ¥è¯´ï¼Œæ˜¯éœ€è¦å‘é€æ¶ˆæ¯äº†ï¼Œå› æ­¤æ˜¯å†™äº‹ä»¶ï¼Œè¿™æ˜¯æˆ‘çš„ç†è§£","user_name":"ä½œè€…å›å¤","user_name_real":"é™¶è¾‰","uid":"1283912","ctime":1589498827,"ip_address":"","comment_id":217394,"utype":1}],"discussion_count":1,"race_medal":0,"score":"27359280292","product_id":100051201,"comment_content":"è€å¸ˆï¼Œå…³äºè¯»äº‹ä»¶å’Œå†™äº‹ä»¶æœ‰ä¸ªç–‘é—®çš„åœ°æ–¹ï¼ŒåŸºäºå®šä¹‰ï¼šè¯»äº‹ä»¶è¡¨ç¤ºæœ‰åˆ°è¾¾çš„æ¶ˆæ¯éœ€è¦å¤„ç†ï¼Œè€Œå†™äº‹ä»¶è¡¨ç¤ºå¯ä»¥å‘é€æ¶ˆæ¯ã€‚åœ¨ä¸‰æ¬¡æ¡æ‰‹é‡Œçš„SYN+ACKï¼Œå®¢æˆ·ç«¯äº§ç”Ÿå†™äº‹ä»¶ï¼Œä¸ºä»€ä¹ˆä¸æ˜¯è¯»äº‹ä»¶å‘¢ï¼Ÿå…ˆè¯»åˆ°SYN+ACKç„¶åè§¦å‘å†™äº‹ä»¶æ¢å¤ACKåˆ°æœåŠ¡ç«¯","like_count":7,"discussions":[{"author":{"id":1283912,"avatar":"https://static001.geekbang.org/account/avatar/00/13/97/48/550271b0.jpg","nickname":"é™¶è¾‰","note":"","ucode":"F81A9087435953","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":495133,"discussion_content":"è¿™ä¸ªè¯»ã€å†™é¢å¯¹çš„å¯¹è±¡ï¼Œæ˜¯åº”ç”¨ä»£ç ã€‚SYN+ACKå¯¹äºç³»ç»Ÿå±‚æ¥è¯´ï¼Œæ˜¯åˆ°è¾¾äº†1ä¸ªæŠ¥æ–‡ï¼Œéœ€è¦å†…æ ¸å‘é€ACKå»å¤„ç†ï¼Œä½†å¯¹äºåº”ç”¨å±‚æ¥è¯´ï¼Œæ˜¯éœ€è¦å‘é€æ¶ˆæ¯äº†ï¼Œå› æ­¤æ˜¯å†™äº‹ä»¶ï¼Œè¿™æ˜¯æˆ‘çš„ç†è§£","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1589498827,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":235663,"user_name":"Douglas","can_delete":false,"product_type":"c1","uid":1073027,"ip_address":"","ucode":"CFDE3D76B9DAE6","user_header":"https://static001.geekbang.org/account/avatar/00/10/5f/83/bb728e53.jpg","comment_is_top":false,"comment_ctime":1595140472,"is_pvip":false,"replies":[{"id":"87100","content":"ä¸¾ä¸ªä¾‹å­ï¼Œå¦‚æœæŠ¥æ–‡1æœªæ”¶åˆ°ï¼Œä¸è¿ç»­çš„æŠ¥æ–‡2çš„åˆ°è¾¾ä¸ä¼šäº§ç”Ÿepollinäº‹ä»¶ã€‚ä¹‹åå½“æŠ¥æ–‡1åˆ°è¾¾åï¼Œè¿™ä¸¤ä¸ªæŠ¥æ–‡åªä¼šè§¦å‘1ä¸ªepoll inäº‹ä»¶ã€‚","user_name":"ä½œè€…å›å¤","user_name_real":"é™¶è¾‰","uid":"1283912","ctime":1595226843,"ip_address":"","comment_id":235663,"utype":1}],"discussion_count":1,"race_medal":0,"score":"14480042360","product_id":100051201,"comment_content":"å‰åçŸ›ç›¾ï¼šã€ç½‘ç»œæŠ¥æ–‡åˆ°è¾¾åï¼Œå†…æ ¸å°±äº§ç”Ÿäº†è¯»ã€å†™äº‹ä»¶ã€‘ ã€å½“ä¸€ä¸ª HTTP è¯·æ±‚çš„å¤§å°è¶…è¿‡ TCP æŠ¥æ–‡çš„æœ€å¤§é•¿åº¦æ—¶ï¼Œè¯·æ±‚ä¼šè¢«æ‹†åˆ†åˆ°å¤šä¸ªæŠ¥æ–‡ä¸­è¿è¾“ï¼Œåœ¨æ¥æ”¶ç«¯çš„ç¼“å†²åŒºä¸­é‡ç»„ã€æ’åºã€‚å› æ­¤ï¼Œå¹¶ä¸æ˜¯æ¯ä¸ªåˆ°è¾¾çš„ TCP æŠ¥æ–‡éƒ½èƒ½ç”Ÿæˆäº‹ä»¶çš„ã€‘ï¼Œ æ‰€ä»¥ï¼Œ è€å¸ˆ  ç”Ÿæˆäº‹ä»¶çš„æ¡ä»¶æ˜¯ä»€ä¹ˆï¼Ÿ","like_count":4,"discussions":[{"author":{"id":1283912,"avatar":"https://static001.geekbang.org/account/avatar/00/13/97/48/550271b0.jpg","nickname":"é™¶è¾‰","note":"","ucode":"F81A9087435953","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":501798,"discussion_content":"ä¸¾ä¸ªä¾‹å­ï¼Œå¦‚æœæŠ¥æ–‡1æœªæ”¶åˆ°ï¼Œä¸è¿ç»­çš„æŠ¥æ–‡2çš„åˆ°è¾¾ä¸ä¼šäº§ç”Ÿepollinäº‹ä»¶ã€‚ä¹‹åå½“æŠ¥æ–‡1åˆ°è¾¾åï¼Œè¿™ä¸¤ä¸ªæŠ¥æ–‡åªä¼šè§¦å‘1ä¸ªepoll inäº‹ä»¶ã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1595226843,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":221162,"user_name":"æ¥å¯","can_delete":false,"product_type":"c1","uid":1302774,"ip_address":"","ucode":"645B21220E8676","user_header":"","comment_is_top":false,"comment_ctime":1590419071,"is_pvip":false,"replies":[{"id":"81567","content":"ä¸¾ä¸ªä¾‹å­ï¼Œæ¯”å¦‚ä¸€æ¬¡æ‰§è¡Œ1ç§’è®¡ç®—çš„ä»»åŠ¡ï¼Œå¦‚æœæœ‰100ä¸ªå¹¶å‘è¯·æ±‚ï¼Œå°±ä¼šå¯¼è‡´å¤§é‡è¯·æ±‚å‡ºç°è¶…æ—¶é‡è¯•ã€‚æ¯”å¦‚ï¼Œé€šå¸¸å®¢æˆ·ç«¯é…ç½®çš„æ˜¯60ç§’è¶…æ—¶ï¼Œé‚£ä¹ˆ60ä¸ªå¹¶å‘è¯·æ±‚ï¼Œå°†æŒç»­å¯¼è‡´ä¸€é¢—CPUåœ¨1åˆ†é’Ÿå†…ä¸èƒ½å¤„ç†å…¶ä»–ä»»ä½•è¯·æ±‚ï¼Œè¿™æ ·ç¬¬61åŠä¹‹åçš„è¯·æ±‚éƒ½ä¼šå› ä¸ºè¶…æ—¶ï¼Œè¢«å®¢æˆ·ç«¯å…³é—­ã€‚<br>åä¹‹ï¼Œæ‹†æˆ100ä¸ª10msçš„å°ä»»åŠ¡ï¼Œå³ä½¿æ¯ä¸ªè¯·æ±‚å¤„ç†çš„æ…¢äº†ä¸€äº›ï¼Œä½†ä¸ä¼šå¯¼è‡´å¤§é‡å®¢æˆ·ç«¯è¯·æ±‚è¶…æ—¶ã€‚","user_name":"ä½œè€…å›å¤","user_name_real":"é™¶è¾‰","uid":"1283912","ctime":1590452332,"ip_address":"","comment_id":221162,"utype":1}],"discussion_count":3,"race_medal":0,"score":"14475320959","product_id":100051201,"comment_content":"æ‚¨å¥½ï¼Œçœ‹äº†æ‚¨çš„å…¶ä»–å›å¤ï¼Œæˆ‘æ²¡å¤ªæ˜ç™½æ‹†æˆå°ä»»åŠ¡å¤šæ¬¡æ‰§è¡Œçš„åŸå› ï¼Œè¿™æ ·åšçš„å¥½å¤„æ˜¯ä»€ä¹ˆå‘¢ï¼Ÿ","like_count":3,"discussions":[{"author":{"id":1283912,"avatar":"https://static001.geekbang.org/account/avatar/00/13/97/48/550271b0.jpg","nickname":"é™¶è¾‰","note":"","ucode":"F81A9087435953","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":496361,"discussion_content":"ä¸¾ä¸ªä¾‹å­ï¼Œæ¯”å¦‚ä¸€æ¬¡æ‰§è¡Œ1ç§’è®¡ç®—çš„ä»»åŠ¡ï¼Œå¦‚æœæœ‰100ä¸ªå¹¶å‘è¯·æ±‚ï¼Œå°±ä¼šå¯¼è‡´å¤§é‡è¯·æ±‚å‡ºç°è¶…æ—¶é‡è¯•ã€‚æ¯”å¦‚ï¼Œé€šå¸¸å®¢æˆ·ç«¯é…ç½®çš„æ˜¯60ç§’è¶…æ—¶ï¼Œé‚£ä¹ˆ60ä¸ªå¹¶å‘è¯·æ±‚ï¼Œå°†æŒç»­å¯¼è‡´ä¸€é¢—CPUåœ¨1åˆ†é’Ÿå†…ä¸èƒ½å¤„ç†å…¶ä»–ä»»ä½•è¯·æ±‚ï¼Œè¿™æ ·ç¬¬61åŠä¹‹åçš„è¯·æ±‚éƒ½ä¼šå› ä¸ºè¶…æ—¶ï¼Œè¢«å®¢æˆ·ç«¯å…³é—­ã€‚\nåä¹‹ï¼Œæ‹†æˆ100ä¸ª10msçš„å°ä»»åŠ¡ï¼Œå³ä½¿æ¯ä¸ªè¯·æ±‚å¤„ç†çš„æ…¢äº†ä¸€äº›ï¼Œä½†ä¸ä¼šå¯¼è‡´å¤§é‡å®¢æˆ·ç«¯è¯·æ±‚è¶…æ—¶ã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1590452332,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1010018,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/69/62/b874af21.jpg","nickname":"é¢›é¡¼","note":"","ucode":"4A6139389C62EA","race_medal":0,"user_type":1,"is_pvip":true},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":290558,"discussion_content":"è¿™ä¸ª1sæ‰§è¡Œä¸€ä¸ªä»»åŠ¡ï¼Œé‚£60sæœ€å¤šä¹Ÿæ˜¯60ä¸ªä»»åŠ¡ï¼Œä¸ç®¡æ€ä¹ˆæ‹†ï¼Œä¸ä¹Ÿæ˜¯60så¤„ç†60ä¸ªï¼Œç¬¬61ä¸ªè¿˜æ˜¯ä¼šè¶…æ—¶çš„ï¼Ÿ","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1594531979,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1100690,"avatar":"https://static001.geekbang.org/account/avatar/00/10/cb/92/cfc1cfd3.jpg","nickname":"è´æ°å€­ç‹çŒ´","note":"","ucode":"0A89A70C48629C","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":278866,"discussion_content":"å¦‚æœæ¯1så¤§å¤§ä»»åŠ¡æ‹†æˆ100ä¸ª10msçš„å°ä»»åŠ¡ï¼Œé‚£ä¹ˆå®¢æˆ·ç«¯æ˜¯ä¸æ˜¯ä¹Ÿéœ€è¦å¤„ç†100ä¸ª10msçš„å°ä»»åŠ¡å‘¢ï¼Ÿ","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1591246678,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":218300,"user_name":"RISE","can_delete":false,"product_type":"c1","uid":1201956,"ip_address":"","ucode":"00E99CCA142E83","user_header":"https://static001.geekbang.org/account/avatar/00/12/57/24/909bb6ef.jpg","comment_is_top":false,"comment_ctime":1589773833,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"14474675721","product_id":100051201,"comment_content":"CPUå¯†é›†è®¡ç®—çš„æ‹†åˆ†ä¸ªäººè®¤ä¸ºå¯ä»¥ä½¿ç”¨åç¨‹æˆ–å¤šçº¿ç¨‹å…ˆåˆ†è€Œæ²»ä¹‹ç¼©çŸ­æ‰§è¡Œæ—¶é—´ï¼Œå¦‚æœè¿˜ä¸èƒ½æ»¡è¶³è¦æ±‚çš„è¯å¯ä»¥è€ƒè™‘åˆ†å‘åˆ°é›†ç¾¤ä¸­ï¼Œæˆ–è€…å¹²è„†å°†è®¡ç®—ä»»åŠ¡è¿›è¡Œæœ‰æ•ˆçš„æ‹†åˆ†ï¼Œä¸è¦ä¸€æ¬¡å ç”¨è¿‡å¤šçš„CPUæ—¶é—´","like_count":3},{"had_liked":false,"id":218108,"user_name":"Bitstream","can_delete":false,"product_type":"c1","uid":1434089,"ip_address":"","ucode":"51FB631A70B52C","user_header":"https://static001.geekbang.org/account/avatar/00/15/e1/e9/29b62c57.jpg","comment_is_top":false,"comment_ctime":1589716513,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"14474618401","product_id":100051201,"comment_content":"å…³äºæ€è€ƒé¢˜çš„ä¸€äº›æƒ³æ³•ï¼š<br>ï¼ˆ1ï¼‰å¦‚æœçœŸçš„å°†ä¸€ä¸ªä»»åŠ¡å®šæ€§ä¸ºâ€è®¡ç®—å¯†é›†å‹â€œï¼Œä¸ªäººè®¤ä¸ºå°†ä»»åŠ¡æ”¾åˆ°ç‹¬ç«‹çš„è®¡ç®—çº¿ç¨‹ï¼ˆæˆ–çº¿ç¨‹æ± ï¼‰å¤„ç†ï¼Œå¯ä»¥å……åˆ†åˆ©ç”¨å¤šæ ¸cpuï¼ˆå•æ ¸cpuå¦è¯´ï¼Œç°åœ¨å¸¸è§äºä½ç«¯åµŒå…¥å¼å¹³å°ï¼‰çš„å¹¶è¡Œè®¡ç®—èƒ½åŠ›ï¼Œå¹¶ä¸”å¯ä»¥å°†çº¿ç¨‹ç»‘å®šäºç‰¹å®šcpuæ ¸ï¼ŒåŒæ—¶é€šè¿‡ä¼˜åŒ–ç®—æ³•å®ç°ï¼Œå……åˆ†åˆ©ç”¨cpuç¼“å­˜ä»¥è¿›ä¸€æ­¥æå‡æ€§èƒ½ã€‚è‡³äºç¼–ç¨‹æ•ˆç‡æ–¹é¢çš„å¼€é”€ï¼Œç°åœ¨å¾ˆå¤šå¼‚æ­¥æ¡†æ¶åº”è¯¥å¯ä»¥å°†ç±»ä¼¼çš„å¤šçº¿ç¨‹è®¡ç®—å®Œæˆäº‹ä»¶â€æ— ç¼â€œçš„èå…¥åˆ°ä¸»äº‹ä»¶å¾ªç¯ä¸­ï¼Œæ‰€ä»¥ç¼–ç¨‹åº”è¯¥ä¸ä¼šç‰¹åˆ«ç—›è‹¦ï¼Œä¸è¿‡è°ƒè¯•ä¾ç„¶æ˜¯ä¸ªé—®é¢˜ã€‚<br>ï¼ˆ2ï¼‰ä»æ‰©å±•è§’åº¦è€ƒè™‘ï¼Œå°†â€è®¡ç®—å¯†é›†å‹â€œä»»åŠ¡ç‹¬ç«‹å‡ºæ¥ï¼Œä»¥åæ ¹æ®éœ€è¦å¯ä»¥å®¹æ˜“çš„ä¿®æ”¹ä¸ºâ€å¼‚æ„â€œè®¡ç®—æ¶æ„ï¼Œæ¯”å¦‚å°†è®¡ç®—ä»»åŠ¡åˆ†å‘åˆ°GPUã€FPGAã€é›†ç¾¤ä¸­å¤„ç†ï¼Œè€Œå¯¹äºåˆ†å‘å‡ºå»çš„ä»»åŠ¡ï¼Œä¸»çº¿&#47;è¿›ç¨‹ä»ç„¶æ˜¯ç›‘å¬å¹¶å¤„ç†è®¡ç®—å®Œæˆäº‹ä»¶å°±å¯ä»¥äº†ï¼Œç¨‹åºçš„æ¶æ„ä¸Šæ²¡æœ‰å¤ªå¤§å˜åŒ–ã€‚<br>ï¼ˆ3ï¼‰åœ¨åŒä¸€çº¿ç¨‹ä¸­æ‹†åˆ†ä¸ºè‹¥å¹²ç‰‡æ®µçš„æ–¹æ¡ˆï¼Œé‡åº¦ä¾èµ–äºè®¡ç®—ä»»åŠ¡çš„ä¸šåŠ¡ç‰¹ç‚¹ã€‚æ¯”å¦‚å‡Œæ™¨åŒå­¦çš„è®¡ç®—sha256çš„è®¡ç®—ä»»åŠ¡ï¼Œç”±äºhashç®—æ³•å¤©ç„¶çš„å¯ä»¥åå¤ä»¥ä»»æ„é•¿åº¦updateçš„ç‰¹ç‚¹ï¼Œè¿™ç§æ‹†åˆ†ç›¸å¯¹å®¹æ˜“ã€‚é—®é¢˜æ˜¯ï¼Œä¸ºäº†ä¿è¯å•æ¬¡è®¡ç®—çš„æ—¶é—´å¼€é”€å¤ŸçŸ­ï¼Œæ¯æ¬¡updateçš„æ•°æ®å—å¯èƒ½å¾ˆå°ï¼Œåœ¨è¯·æ±‚å¯†é›†æ—¶æˆ–è€…å•æ¬¡ä¸Šä¼ æ–‡ä»¶è¾ƒå¤§æ—¶ï¼Œéœ€è¦æœ‰è¾ƒå¤§çš„æ¥æ”¶ç¼“å†²åŒºã€‚å¦å¤–ï¼Œå¯¹äºhashè¿™ç§è¿ç®—æ•°æ®å‰åç›¸å…³çš„ç®—æ³•ï¼Œå¦‚æœæ‹†åˆ†çš„ä¸åˆé€‚ï¼Œå¯èƒ½cpuç¼“å­˜æ— æ³•é«˜æ•ˆçš„ä½¿ç”¨ï¼ˆè¿™ä¸ªä¸ç¡®å®šï¼Œå¾—çœ‹ä¸€ä¸‹sha256çš„å…·ä½“å®ç°ï¼‰ã€‚","like_count":4},{"had_liked":false,"id":217458,"user_name":"å‡Œæ™¨","can_delete":false,"product_type":"c1","uid":1178741,"ip_address":"","ucode":"B97A142834F7DE","user_header":"https://static001.geekbang.org/account/avatar/00/11/fc/75/d2f821b8.jpg","comment_is_top":false,"comment_ctime":1589508513,"is_pvip":false,"replies":[{"id":"80571","content":"ä½ å¥½å‡Œæ™¨ï¼Œæˆ‘æ¨èç”¨ç¬¬3ç§æ–¹å¼ï¼Œè¿™æ ·çš„å¼€å‘å¤æ‚åº¦æœ€å°ï¼Œä¹Ÿæœ€å¯æ§ï¼","user_name":"ä½œè€…å›å¤","user_name_real":"é™¶è¾‰","uid":"1283912","ctime":1589681090,"ip_address":"","comment_id":217458,"utype":1}],"discussion_count":1,"race_medal":0,"score":"14474410401","product_id":100051201,"comment_content":"æ€è€ƒé¢˜æ­£æ˜¯æˆ‘ä»¬ç›®å‰é¡¹ç›®é‡åˆ°çš„é—®é¢˜ï¼Œè¯·è€å¸ˆæŒ‡ç‚¹ä¸€ä¸‹ï¼š<br><br>ç®€å•æè¿°ä¸‹é—®é¢˜ï¼šæˆ‘ä»¬åœ¨nginxä¸­å®ç°ä¸€ä¸ªä¸Šä¼ æ–‡ä»¶æ—¶åŒæ—¶è®¡ç®—æ–‡ä»¶sha256çš„åŠŸèƒ½ï¼Œå®¢æˆ·ç«¯ä¼šæºå¸¦sha256å€¼ç”¨äºæ ¡éªŒå®Œæ•´æ€§ï¼ˆè¿™ä¸ªéœ€æ±‚æ˜¯æ­»çš„ï¼Œå®¢æˆ·ç«¯ä¸å¯èƒ½æ”¹ï¼‰ã€‚è®¡ç®—sha256æ˜¯CPUå¯†é›†å‹æ“ä½œï¼Œä¸€å®šè¦è€ƒè™‘å¼‚æ­¥åŒ–ï¼Œå¦åˆ™ngx workerè¿›ç¨‹ä¼š&quot;åœé¡¿&quot;ï¼Œå‡ºç°å¤§é‡æ¯›åˆºã€‚<br><br>é‚£ä¹ˆï¼Œå¼‚æ­¥åŒ–éœ€è¦ç”¨çº¿ç¨‹æ± æ¥æ‰¿è½½ï¼Œè¿™é‡Œé¢ä¸´å‡ ä¸ªæ€è€ƒï¼š<br>1. è€ƒè™‘åœ¨workerè¿›ç¨‹ä¸­èµ·çº¿ç¨‹æ± ï¼Œé‚£ä¹ˆè¯¥èµ·å¤šå°‘ä¸ªçº¿ç¨‹ï¼Ÿ å¯¹äºnginxè¿™ç§å¤šè¿›ç¨‹æ¶æ„æ¥è®²ï¼Œä¸€ä¸ªworkerèµ·nä¸ªçº¿ç¨‹æ„å‘³ç€æ€»å…±ä¼šèµ· m * n ä¸ªçº¿ç¨‹ï¼Œmæ˜¯workerä¸ªæ•°ã€‚å¯¹CPUæ¥è®²èµ·å¤ªå¤šçº¿ç¨‹ä¹Ÿä¸æ˜¯ä¸€ä¸ªå‹å¥½çš„æ–¹å¼ã€‚æ‰€ä»¥è€ƒè™‘æ˜¯ä¸æ˜¯ä¸€ä¸ªworkerè¿›ç¨‹èµ·1ä¸ªçº¿ç¨‹è¶³ä»¥ï¼Œæ‰€æœ‰è®¡ç®—ä»»åŠ¡éƒ½å§”æ‰˜ç»™è¿™ä¸ªçº¿ç¨‹æ¥æ‰§è¡Œï¼Œä»»åŠ¡çš„æŠ•é€’ã€å“åº”éƒ½å¾€workerçš„epollä¸Šæ¨¡æ‹Ÿäº‹ä»¶æ¥å®Œæˆã€‚<br><br>2. è€ƒè™‘åœ¨workerä¸­é€‰æ‹©ä¸€ä¸ªç‰¹æ®Šçš„workerè¿›ç¨‹æ¥ä¸“é—¨è¿›è¡Œå¯†é›†å‹è®¡ç®—ä»»åŠ¡ï¼Œç±»ä¼¼nginxä¸­æœ‰å•ç‹¬çš„cache managerè¿›ç¨‹ä¸€æ ·ï¼Œç„¶ååœ¨è¿™ä¸ªworkerè¿›ç¨‹ä¸­èµ·çº¿ç¨‹æ± ï¼Œçº¿ç¨‹æ•°ç­‰äºCPUæ ¸æ•°ã€‚ä½†æ˜¯è¿™æ ·çš„è¯æ„å‘³ç€æˆ‘è¦é€šè¿‡å…±äº«å†…å­˜åœ¨workerä¹‹é—´å…±äº«æ•°æ®ï¼Œå¼•æ¥ä¸€äº›é¢å¤–çš„å¤æ‚åº¦ï¼ˆå®é™…ä¸Šç›®å‰æˆ‘ä»¬å·²ç»å®ç°äº†workeré—´çš„å…±äº«å†…å­˜ï¼Œæœ‰å…¶ä»–ä½œç”¨ï¼‰<br><br>3. ä¸èµ·çº¿ç¨‹äº†ï¼Œè€Œæ˜¯å°†ä¸€ä¸ªè®¡ç®—ä»»åŠ¡æ‹†è§£ä¸º n ä¸ªå­ä»»åŠ¡ä¸²è¡Œè®¡ç®—ï¼Œæ¯”å¦‚åŸæ¥æˆ‘è¦è®¡ç®—ä¸€ä¸ª 1Mb çš„æ•°æ®çš„sha256ï¼Œæ”¹ä¸ºæ¯æ¬¡åªè®¡ç®—4kbï¼Œè®¡ç®—å®Œ4kbä¹‹åå°è£…ä¸€ä¸ªepolläº‹ä»¶ç­‰å¾…å†æ¬¡é‡å…¥ã€‚è¿™æ ·ä¼šå¸¦æ¥å•ä¸ªè¯·æ±‚çš„æ—¶å»¶å¢å¤§ï¼Œä½†æ•´ç³»ç»Ÿçš„ååé‡åº”è¯¥å¯ä»¥æå‡ã€‚<br><br>æƒ³çŸ¥é“è€å¸ˆæ„è§æ˜¯ä»€ä¹ˆï¼Œæœ‰æ²¡æœ‰æ›´æ¨èçš„æ–¹å¼ï¼Ÿ è°¢è°¢ï¼","like_count":4,"discussions":[{"author":{"id":1283912,"avatar":"https://static001.geekbang.org/account/avatar/00/13/97/48/550271b0.jpg","nickname":"é™¶è¾‰","note":"","ucode":"F81A9087435953","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":495153,"discussion_content":"ä½ å¥½å‡Œæ™¨ï¼Œæˆ‘æ¨èç”¨ç¬¬3ç§æ–¹å¼ï¼Œè¿™æ ·çš„å¼€å‘å¤æ‚åº¦æœ€å°ï¼Œä¹Ÿæœ€å¯æ§ï¼","likes_number":1,"is_delete":false,"is_hidden":false,"ctime":1589681090,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":223970,"user_name":"è´æ°å€­ç‹çŒ´","can_delete":false,"product_type":"c1","uid":1100690,"ip_address":"","ucode":"0A89A70C48629C","user_header":"https://static001.geekbang.org/account/avatar/00/10/cb/92/cfc1cfd3.jpg","comment_is_top":false,"comment_ctime":1591247224,"is_pvip":false,"replies":[{"id":"90800","content":"ä½ å¥½è´æ°å€­ç‹çŒ´ï¼Œè¿™2ä¸ªæ„æ€éƒ½ä¸æ˜¯ã€‚<br>å®¢æˆ·ç«¯è¦è¯»å–100MBæ–‡ä»¶ï¼ŒæœåŠ¡å™¨æ˜¯ä¸èƒ½ä¸ºäº†è¿™ä¸ªè¯·æ±‚ç”³è¯·100MBçš„å†…å­˜ï¼Œä¸€æ¬¡æ€§å°†æ–‡ä»¶è¯»å–åˆ°å†…å­˜ä¸­ï¼Œå¤„ç†åï¼ˆæ¯”å¦‚åšå‹ç¼©ï¼‰å†å‘é€ç»™å®¢æˆ·ç«¯çš„ï¼Œè¿™æ ·ä¼šæ¯äº†æœåŠ¡å™¨çš„é«˜å¹¶å‘ç‰¹æ€§ï¼Œç”šè‡³ä¼šå‡ºç°OOMç›´æ¥coredumpã€‚é€šå¸¸ä¼šåˆ†é…32KBä¹‹ç±»çš„å†…å­˜ï¼Œä»æ–‡ä»¶å¤´é¡ºåºå‘åï¼Œæ¯æ¬¡åªè¯»å–32KBï¼Œå¤„ç†åå†å‘é€ç»™å®¢æˆ·ç«¯ã€‚<br>ä¸çŸ¥é“æˆ‘è¡¨è¾¾æ¸…æ¥šäº†æ²¡ï¼Ÿ","user_name":"ä½œè€…å›å¤","user_name_real":"é™¶è¾‰","uid":"1283912","ctime":1599643788,"ip_address":"","comment_id":223970,"utype":1}],"discussion_count":2,"race_medal":0,"score":"10181181816","product_id":100051201,"comment_content":"è€å¸ˆæœ‰ä¸ªé—®é¢˜â€œé€šå¸¸è¦æŠŠå¤§æ–‡ä»¶çš„è¯»å–ï¼Œæ‹†åˆ†æˆè®¸å¤šä»½ï¼Œæ¯ä»½ä»…æœ‰å‡ å KBï¼Œé™ä½å•æ¬¡æ“ä½œçš„è€—æ—¶â€œã€‚èƒ½å…·ä½“è¯´ä¸‹ä»€ä¹ˆæ„æ€ä¹ˆï¼Ÿæ˜¯1ï¼‰è¿˜æ˜¯2ï¼‰ï¼Ÿ<br>1ï¼‰å®¢æˆ·ç«¯å¦‚æœè¦è¯»ä¸€ä¸ª100MBå¤§å°çš„æ–‡ä»¶çš„1MBã€‚åˆ™éœ€è¦æŠŠ100MBæ–‡ä»¶åœ¨å­˜å‚¨æ—¶æ‹†åˆ†æˆ10ä¸ª10MBçš„å°æ–‡ä»¶ï¼Œç›´æ¥æ‰¾åˆ°1MBå¯¹åº”çš„é‚£ä¸ªå°æ–‡ä»¶è¯»å–ï¼Ÿ<br>2ï¼‰å®¢æˆ·ç«¯å¦‚æœè¦è¯»ä¸€ä¸ª100MBå¤§å°çš„æ–‡ä»¶çš„1MBã€‚åˆ™éœ€è¦æŠŠ1MBç›®æ ‡æ‹†åˆ†æˆ10ä¸ª100KBçš„å°ç›®æ ‡ï¼Œå¹¶å‘è¯»å–10ä¸ª100KBä¸ªå°ç›®æ ‡","like_count":2,"discussions":[{"author":{"id":1283912,"avatar":"https://static001.geekbang.org/account/avatar/00/13/97/48/550271b0.jpg","nickname":"é™¶è¾‰","note":"","ucode":"F81A9087435953","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":497317,"discussion_content":"ä½ å¥½è´æ°å€­ç‹çŒ´ï¼Œè¿™2ä¸ªæ„æ€éƒ½ä¸æ˜¯ã€‚\nå®¢æˆ·ç«¯è¦è¯»å–100MBæ–‡ä»¶ï¼ŒæœåŠ¡å™¨æ˜¯ä¸èƒ½ä¸ºäº†è¿™ä¸ªè¯·æ±‚ç”³è¯·100MBçš„å†…å­˜ï¼Œä¸€æ¬¡æ€§å°†æ–‡ä»¶è¯»å–åˆ°å†…å­˜ä¸­ï¼Œå¤„ç†åï¼ˆæ¯”å¦‚åšå‹ç¼©ï¼‰å†å‘é€ç»™å®¢æˆ·ç«¯çš„ï¼Œè¿™æ ·ä¼šæ¯äº†æœåŠ¡å™¨çš„é«˜å¹¶å‘ç‰¹æ€§ï¼Œç”šè‡³ä¼šå‡ºç°OOMç›´æ¥coredumpã€‚é€šå¸¸ä¼šåˆ†é…32KBä¹‹ç±»çš„å†…å­˜ï¼Œä»æ–‡ä»¶å¤´é¡ºåºå‘åï¼Œæ¯æ¬¡åªè¯»å–32KBï¼Œå¤„ç†åå†å‘é€ç»™å®¢æˆ·ç«¯ã€‚\nä¸çŸ¥é“æˆ‘è¡¨è¾¾æ¸…æ¥šäº†æ²¡ï¼Ÿ","likes_number":1,"is_delete":false,"is_hidden":false,"ctime":1599643788,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1100690,"avatar":"https://static001.geekbang.org/account/avatar/00/10/cb/92/cfc1cfd3.jpg","nickname":"è´æ°å€­ç‹çŒ´","note":"","ucode":"0A89A70C48629C","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":304846,"discussion_content":"æ˜ç™½äº†ï¼Œå¤šè°¢ğŸ™ã€‚æ•™å¸ˆèŠ‚å¿«ä¹ï¼","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1599697523,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":217439,"user_name":"å‡‰äººã€‚","can_delete":false,"product_type":"c1","uid":1659177,"ip_address":"","ucode":"4DB16004A62015","user_header":"https://static001.geekbang.org/account/avatar/00/19/51/29/24739c58.jpg","comment_is_top":false,"comment_ctime":1589505935,"is_pvip":false,"replies":[{"id":"80600","content":"æ˜¯çš„","user_name":"ä½œè€…å›å¤","user_name_real":"é™¶è¾‰","uid":"1283912","ctime":1589684505,"ip_address":"","comment_id":217439,"utype":1}],"discussion_count":1,"race_medal":0,"score":"10179440527","product_id":100051201,"comment_content":"æ„Ÿè§‰c10kæå‡ï¼Œç»å¤§éƒ¨åˆ†æ˜¯åœ¨å‹æ¦¨æ€§èƒ½ä¸Šçš„æå‡ã€‚<br>å•ä½æ—¶é—´å¤„ç†æ•°ã€‚<br>å†…å­˜æ± ã€‚<br>éé˜»å¡ã€‚<br>å¼‚æ­¥äº‹ä»¶é©±åŠ¨ã€‚<br>éƒ½æ˜¯ç²¾ç›Šæ±‚ç²¾ã€‚","like_count":3,"discussions":[{"author":{"id":1283912,"avatar":"https://static001.geekbang.org/account/avatar/00/13/97/48/550271b0.jpg","nickname":"é™¶è¾‰","note":"","ucode":"F81A9087435953","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":495149,"discussion_content":"æ˜¯çš„","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1589684505,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":217410,"user_name":"é‚£æ—¶åˆ»","can_delete":false,"product_type":"c1","uid":1150927,"ip_address":"","ucode":"B0D150856C3A4A","user_header":"https://static001.geekbang.org/account/avatar/00/11/8f/cf/890f82d6.jpg","comment_is_top":false,"comment_ctime":1589498836,"is_pvip":false,"replies":[{"id":"80605","content":"ä½ å¥½é‚£æ—¶åˆ»ï¼Œå½“å¤„ç†è¯·æ±‚çš„è¿‡ç¨‹æ— æ³•æ‹†åˆ†æ—¶ï¼ˆæ¯”å¦‚ç¬¬ä¸‰æ–¹æ— æ³•æ‹†åˆ†çš„SDKï¼‰ï¼Œç”¨ç‹¬ç«‹çš„çº¿ç¨‹æ± å¤„ç†æ˜¯ä¸ªå¥½æ–¹æ¡ˆï¼å¦‚æœèƒ½å¤Ÿæ‹†åˆ†çš„è¯ï¼Œç›´æ¥æ‹†æˆå°ä»»åŠ¡å¤šæ¬¡æ‰§è¡Œå°±ä¸é”™ï¼Œæ— é¡»é’ˆå¯¹å¤šçº¿ç¨‹åŒæ­¥ä»˜å‡ºé¢å¤–çš„æˆæœ¬ï¼Œä½ å¯ä»¥å‚è€ƒä¸‹å‡Œæ™¨åŒå­¦çš„ç­”æ¡ˆã€‚","user_name":"ä½œè€…å›å¤","user_name_real":"é™¶è¾‰","uid":"1283912","ctime":1589684928,"ip_address":"","comment_id":217410,"utype":1}],"discussion_count":1,"race_medal":0,"score":"10179433428","product_id":100051201,"comment_content":"æˆ‘çš„æƒ³æ³•æ˜¯é‡‡ç”¨çº¿ç¨‹æ± å’Œé˜Ÿåˆ—åŠ å…¥åˆ°äº‹ä»¶é©±åŠ¨æ¡†æ¶é‡Œæ¥å¤„ç†CPUå¯†é›†è®¡ç®—çš„è¯·æ±‚ã€‚è¯»äº‹ä»¶æ˜¯è¯·æ±‚çš„è¯»å–ï¼ŒæŠŠè¯»å–çš„è¯·æ±‚æ”¾åˆ°é˜Ÿåˆ—é‡Œï¼Œç„¶åäº‹ä»¶å¤„ç†çº¿ç¨‹æ± ä»é˜Ÿåˆ—é‡Œå–äº‹ä»¶å¤„ç†ï¼Œå¤„ç†å®Œä¹‹åè§¦å‘å†™äº‹ä»¶ï¼ˆå†™ç½‘ç»œæˆ–è€…å†™æ–‡ä»¶ç­‰ï¼‰ã€‚å› ä¸ºæ˜¯CPUå¯†é›†è®¡ç®—ï¼Œçº¿ç¨‹æ•°é‡ä¸èƒ½è¿‡å¤šï¼Œä¸€èˆ¬ä¸ºCPUæ ¸æ•°çš„2å€ã€‚é˜Ÿåˆ—çš„é•¿åº¦å¯ä»¥ç¨å¾®é•¿ç‚¹ï¼Œæ¥å®¹çº³ä¸èƒ½åŠæ—¶å¤„ç†çš„äº‹ä»¶ã€‚","like_count":2,"discussions":[{"author":{"id":1283912,"avatar":"https://static001.geekbang.org/account/avatar/00/13/97/48/550271b0.jpg","nickname":"é™¶è¾‰","note":"","ucode":"F81A9087435953","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":495140,"discussion_content":"ä½ å¥½é‚£æ—¶åˆ»ï¼Œå½“å¤„ç†è¯·æ±‚çš„è¿‡ç¨‹æ— æ³•æ‹†åˆ†æ—¶ï¼ˆæ¯”å¦‚ç¬¬ä¸‰æ–¹æ— æ³•æ‹†åˆ†çš„SDKï¼‰ï¼Œç”¨ç‹¬ç«‹çš„çº¿ç¨‹æ± å¤„ç†æ˜¯ä¸ªå¥½æ–¹æ¡ˆï¼å¦‚æœèƒ½å¤Ÿæ‹†åˆ†çš„è¯ï¼Œç›´æ¥æ‹†æˆå°ä»»åŠ¡å¤šæ¬¡æ‰§è¡Œå°±ä¸é”™ï¼Œæ— é¡»é’ˆå¯¹å¤šçº¿ç¨‹åŒæ­¥ä»˜å‡ºé¢å¤–çš„æˆæœ¬ï¼Œä½ å¯ä»¥å‚è€ƒä¸‹å‡Œæ™¨åŒå­¦çš„ç­”æ¡ˆã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1589684928,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":303555,"user_name":"OM","can_delete":false,"product_type":"c1","uid":1302746,"ip_address":"","ucode":"E33C66A70802A5","user_header":"http://thirdwx.qlogo.cn/mmopen/vi_32/DYAIOgq83eoWfXendN7czHpsyaWKLPK6Na9P5czquJ7Wdre4TibZQ5SQib88edyuib3LpCVFkp0gII2wyvvR8tEIA/132","comment_is_top":false,"comment_ctime":1626853967,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1626853967","product_id":100051201,"comment_content":"æ–‡ç« ä¸­æåŠ:ç›®å‰ç£ç›˜å¼‚æ­¥ IO æŠ€æœ¯ï¼ˆå‚è§[ç¬¬ 4 è®²]ï¼‰è¿˜ä¸æˆç†Ÿï¼Œå®ƒç»•è¿‡äº† PageCache æ€§èƒ½æŸå¤±å¾ˆå¤§ã€‚ä½†å®é™…ç”Ÿäº§ä¸­å¦‚oracleæœ‰å…³IOæ–¹é¢æ˜¯é‡‡ç”¨å¼‚æ­¥IOçš„ï¼Œå…¶ä»–æ•°æ®åº“æœ‰äº›ä¹Ÿé‡‡ç”¨å¼‚æ­¥IOï¼Œæ­¤å¼‚æ­¥IOä¸DBå±‚çš„å¼‚æ­¥IOä¸åŒå—ï¼Ÿéº»çƒ¦é™¶è€å¸ˆè§£ç­”ä¸‹ï¼Œæ„Ÿè°¢ï¼","like_count":0},{"had_liked":false,"id":274050,"user_name":"è¨€åå¹´","can_delete":false,"product_type":"c1","uid":1110039,"ip_address":"","ucode":"67B8B49C3A3B17","user_header":"https://static001.geekbang.org/account/avatar/00/10/f0/17/796a3d20.jpg","comment_is_top":false,"comment_ctime":1610800051,"is_pvip":true,"discussion_count":0,"race_medal":0,"score":"1610800051","product_id":100051201,"comment_content":"é­è¾Ÿå…¥é‡Œ","like_count":0},{"had_liked":false,"id":229852,"user_name":"J.Smile","can_delete":false,"product_type":"c1","uid":1336475,"ip_address":"","ucode":"C4D98DFDBF7584","user_header":"https://static001.geekbang.org/account/avatar/00/14/64/9b/0b578b08.jpg","comment_is_top":false,"comment_ctime":1593163746,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1593163746","product_id":100051201,"comment_content":"çœŸçš„æŒºå—ç›Šçš„ï¼Œååéƒ½ä¸²è”äº†è‡ªå·±çš„çŸ¥è¯†ç½‘ç»œï¼Œæ„Ÿè°¢è€å¸ˆï¼Œç»§ç»­å¹²è´§ï¼","like_count":0},{"had_liked":false,"id":217574,"user_name":"æµæµªåœ°çƒ","can_delete":false,"product_type":"c1","uid":1498137,"ip_address":"","ucode":"25210DCD353F97","user_header":"https://static001.geekbang.org/account/avatar/00/16/dc/19/c058bcbf.jpg","comment_is_top":false,"comment_ctime":1589535890,"is_pvip":false,"replies":[{"id":"80570","content":"äº§ç”Ÿè¯»äº‹ä»¶ï¼Œæé†’åº”ç”¨ç¨‹åºéœ€è¦å¤„ç†å¯¹æ–¹çš„FINæŠ¥æ–‡ã€‚æ­¤æ—¶æœªå¿…éœ€è¦è°ƒç”¨closeå‡½æ•°ï¼Œå½“ä¸»åŠ¨æ–¹ä½¿ç”¨shutdownå‡½æ•°å‘é€FINæŠ¥æ–‡æ—¶ï¼Œè¢«åŠ¨æ–¹å¯ä»¥é•¿æ—¶é—´ä¿æŒåŠå…³é—­è¿æ¥çŠ¶æ€ï¼Œå•å‘ä¼ è¾“æ•°æ®","user_name":"ä½œè€…å›å¤","user_name_real":"é™¶è¾‰","uid":"1283912","ctime":1589680855,"ip_address":"","comment_id":217574,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1589535890","product_id":100051201,"comment_content":"è€å¸ˆæ‚¨å¥½ï¼Œå…³äºè¿™æ®µæè¿°ç†è§£ä¸æ˜¯å¾ˆæ¸…æ¥šï¼š<br>ä½†è¢«åŠ¨æ–¹åˆ°ä¸»åŠ¨æ–¹çš„é€šé“ä¹Ÿéœ€è¦å…³é—­ï¼Œæ‰€ä»¥æ­¤æ—¶è¢«åŠ¨æ–¹ä¼šäº§ç”Ÿè¯»äº‹ä»¶ï¼Œæé†’è¢«åŠ¨æ–¹è°ƒç”¨ close å‡½æ•°å…³é—­è¿æ¥ã€‚<br>æ­¤æ—¶ï¼Œè¢«åŠ¨æ–¹æ­¤æ—¶åº”è¯¥ä¸ä¼šå†æ”¶åˆ°ä¸»åŠ¨æ–¹çš„æ¶ˆæ¯äº†ï¼Œä¸ºä»€ä¹ˆäº§ç”Ÿçš„æ˜¯è¯»äº‹ä»¶ï¼Œè€Œä¸æ˜¯åº”è¯¥æ˜¯å†™äº‹ä»¶ã€‚<br>æˆ‘ç†è§£æ˜¯äº§ç”Ÿå†™äº‹ä»¶ï¼Œè°ƒç”¨closeå‡½æ•°è¿”é€finåŒ…ã€‚<br>æ±‚è§£æƒ‘ï¼Œè°¢è°¢ã€‚<br>","like_count":0,"discussions":[{"author":{"id":1283912,"avatar":"https://static001.geekbang.org/account/avatar/00/13/97/48/550271b0.jpg","nickname":"é™¶è¾‰","note":"","ucode":"F81A9087435953","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":495186,"discussion_content":"äº§ç”Ÿè¯»äº‹ä»¶ï¼Œæé†’åº”ç”¨ç¨‹åºéœ€è¦å¤„ç†å¯¹æ–¹çš„FINæŠ¥æ–‡ã€‚æ­¤æ—¶æœªå¿…éœ€è¦è°ƒç”¨closeå‡½æ•°ï¼Œå½“ä¸»åŠ¨æ–¹ä½¿ç”¨shutdownå‡½æ•°å‘é€FINæŠ¥æ–‡æ—¶ï¼Œè¢«åŠ¨æ–¹å¯ä»¥é•¿æ—¶é—´ä¿æŒåŠå…³é—­è¿æ¥çŠ¶æ€ï¼Œå•å‘ä¼ è¾“æ•°æ®","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1589680855,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":217448,"user_name":"å”æœé¦–éƒ½","can_delete":false,"product_type":"c1","uid":1081233,"ip_address":"","ucode":"F72655AE0AE4CA","user_header":"https://static001.geekbang.org/account/avatar/00/10/7f/91/962eba1a.jpg","comment_is_top":false,"comment_ctime":1589506449,"is_pvip":true,"discussion_count":0,"race_medal":0,"score":"1589506449","product_id":100051201,"comment_content":"æ–‡ä¸­åœ¨å•çº¿ç¨‹10uså¤„ç†äº‹ä»¶ï¼Œèƒ½å¤Ÿæ”¯æŒC10Mçš„ååé‡ï¼Œä½†æ˜¯åœ¨å®é™…é¡¹ç›®çš„è¿è¡Œä¸­äº‹ä»¶æ²¡æœ‰è¿™ä¹ˆå¿«çš„å¤„ç†èƒ½åŠ›ï¼Œæˆ‘äº†è§£çš„å¤„ç†æ–¹å¼æœ‰Reactor Patternï¼Œä¸»çº¿ç¨‹ä¸æ–­å¾ªç¯è½®è®­äº‹ä»¶ï¼Œå°†å°±ç»ªçš„äº‹ä»¶ä¸¢åˆ°Workerçº¿ç¨‹æ± ä¸­è¿›è¡Œå¤„ç†ã€‚","like_count":0},{"had_liked":false,"id":217398,"user_name":"å®‰æ’","can_delete":false,"product_type":"c1","uid":1260026,"ip_address":"","ucode":"F78CFA9624CAEF","user_header":"https://static001.geekbang.org/account/avatar/00/13/39/fa/a7edbc72.jpg","comment_is_top":false,"comment_ctime":1589481352,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1589481352","product_id":100051201,"comment_content":"æ€è€ƒé¢˜ï¼šå¯ä»¥å¼„ä¸€ä¸ªè®¡ç®—çº¿ç¨‹æ± ï¼Œå¤šè·¯å¤ç”¨åªè´Ÿè´£å°†ç½‘ç»œäº‹ä»¶æ”¶ä¸Šæ¥ï¼Œç„¶åäº¤ç»™çº¿ç¨‹æ± è®¡ç®—ï¼Œè¿™æ ·å¤šè·¯å¤ç”¨çš„å›è°ƒå¯ä»¥ç«‹åˆ»è¿”å›å¹¶å¤„ç†ä¸‹ä¸€ä¸ªäº‹ä»¶å›è°ƒã€‚è®¡ç®—çº¿ç¨‹æ± å¼„ä¸€ä¸ªeventfdï¼Œå¤šè·¯å¤ç”¨ä¹Ÿç›‘å¬è¿™ä¸ªeventfdï¼Œçº¿ç¨‹æ± ç®—å®Œäº†ä¹‹åï¼Œé€šè¿‡eventfdé€šçŸ¥å¤šè·¯å¤ç”¨ã€‚å¤šè·¯å¤ç”¨å°†è®¡ç®—ç»“æœå†™åˆ°socketç¼“å†²åŒº.","like_count":0}]}