{"id":646363,"title":"11ï½œçœä¸‹é’±ä¹°æ˜¾å¡ï¼Œå¦‚ä½•åˆ©ç”¨å¼€æºæ¨¡å‹èŠ‚çº¦æˆæœ¬ï¼Ÿ","content":"<p>ä½ å¥½ï¼Œæˆ‘æ˜¯å¾æ–‡æµ©ã€‚</p><p>ä¸çŸ¥é“è¯¾ç¨‹ä¸Šåˆ°è¿™é‡Œï¼Œä½ è´¦æˆ·é‡Œå…è´¹çš„5ç¾å…ƒçš„é¢åº¦è¿˜å‰©ä¸‹å¤šå°‘äº†ï¼Ÿå¦‚æœä½ å°è¯•ç€å®Œæˆæˆ‘ç»™çš„å‡ ä¸ªæ•°æ®é›†é‡Œçš„æ€è€ƒé¢˜ï¼Œç›¸ä¿¡è¿™ä¸ªé¢åº¦åº”è¯¥æ˜¯ä¸å¤ªå¤Ÿç”¨çš„ã€‚è€ŒChatCompletionçš„æ¥å£ï¼Œåˆéœ€è¦ä¼ å…¥å¤§é‡çš„ä¸Šä¸‹æ–‡ä¿¡æ¯ï¼Œå®é™…æ¶ˆè€—çš„Tokenæ•°é‡å…¶å®æ¯”æˆ‘ä»¬æ„Ÿè§‰çš„è¦å¤šã€‚</p><p>è€Œä¸”ï¼Œé™¤äº†è´¹ç”¨ä¹‹å¤–ï¼Œè¿˜æœ‰ä¸€ä¸ªé—®é¢˜æ˜¯æ•°æ®å®‰å…¨ã€‚å› ä¸ºæ¯ä¸ªå›½å®¶çš„æ•°æ®ç›‘ç®¡è¦æ±‚ä¸åŒï¼Œå¹¶ä¸æ˜¯æ‰€æœ‰çš„æ•°æ®ï¼Œéƒ½é€‚åˆé€šè¿‡OpenAIçš„APIæ¥å¤„ç†çš„ã€‚æ‰€ä»¥ï¼Œä»è¿™ä¸¤ä¸ªè§’åº¦å‡ºå‘ï¼Œæˆ‘ä»¬éœ€è¦ä¸€ä¸ªOpenAIä»¥å¤–çš„è§£å†³æ–¹æ¡ˆã€‚é‚£å¯¹äºæ²¡æœ‰è¶³å¤ŸæŠ€æœ¯å‚¨å¤‡çš„ä¸­å°å‹å…¬å¸æ¥è¯´ï¼Œæœ€å¯è¡Œçš„ä¸€ä¸ªæ€è·¯å°±æ˜¯åˆ©ç”¨å¥½å¼€æºçš„å¤§è¯­è¨€æ¨¡å‹ã€‚</p><h2>åœ¨Colabé‡Œä½¿ç”¨GPU</h2><p>å› ä¸ºè¿™ä¸€è®²æˆ‘ä»¬è¦ä½¿ç”¨ä¸€äº›å¼€æºæ¨¡å‹ï¼Œä½†ä¸æ˜¯æ‰€æœ‰äººçš„ç”µè„‘é‡Œéƒ½æœ‰ä¸€ä¸ªå¼ºåŠ²çš„NVidia GPUçš„ã€‚æ‰€ä»¥ï¼Œæˆ‘å»ºè®®ä½ é€šè¿‡Colabæ¥è¿è¡Œå¯¹åº”çš„Notebookï¼Œå¹¶ä¸”æ³¨æ„ï¼Œè¦æŠŠå¯¹åº”çš„è¿è¡Œç¯å¢ƒè®¾ç½®æˆGPUã€‚</p><p><img src=\"https://static001.geekbang.org/resource/image/1c/21/1c0791bd5c1e088eeb527f2acb81a021.png?wh=1255x584\" alt=\"å›¾ç‰‡\"></p><ol>\n<li>ä½ å…ˆé€‰æ‹©èœå•æ é‡Œçš„Runtimeï¼Œç„¶åç‚¹å‡»Change runtime typeã€‚</li>\n</ol><p><img src=\"https://static001.geekbang.org/resource/image/50/23/502a4baceab267e949957c6477bc5823.png?wh=1257x489\" alt=\"å›¾ç‰‡\"></p><ol start=\"2\">\n<li>ç„¶ååœ¨å¼¹å‡ºçš„å¯¹è¯æ¡†é‡Œï¼ŒæŠŠHardware acceleratoræ¢æˆGPUï¼Œç„¶åç‚¹å‡»Saveå°±å¯ä»¥äº†ã€‚</li>\n</ol><p>åªè¦ç”¨å¾—ä¸æ˜¯å¤ªå¤šï¼ŒColabçš„GPUæ˜¯å¯ä»¥å…è´¹ä½¿ç”¨çš„ã€‚</p><h2>HuggingfaceEmbeddingï¼Œä½ çš„å¼€æºä¼™ä¼´</h2><!-- [[[read_end]]] --><p>å…¶å®æˆ‘ä»¬ä¹‹å‰åœ¨ <a href=\"https://time.geekbang.org/column/article/642224\">ç¬¬ 4 è®²</a>å¯¹æ¯”é›¶æ ·æœ¬åˆ†ç±»æ•ˆæœçš„æ—¶å€™ï¼Œå°±å·²ç»ä½¿ç”¨è¿‡Googleå¼€æºçš„æ¨¡å‹T5äº†ã€‚é‚£ä¸ªæ¨¡å‹çš„æ•ˆæœï¼Œè™½ç„¶æ¯”OpenAIçš„APIè¿˜æ˜¯è¦å·®ä¸€äº›ï¼Œä½†æ˜¯å…¶å®90%çš„å‡†ç¡®ç‡ä¹Ÿè¿˜ç®—ä¸é”™äº†ã€‚é‚£ä¹ˆè”æƒ³ä¸€ä¸‹ï¼Œä¸Šä¸€è®²æˆ‘ä»¬ä½¿ç”¨çš„llama-indexå‘é‡æœç´¢éƒ¨åˆ†ï¼Œæ˜¯ä¸æ˜¯å¯ä»¥ç”¨å¼€æºæ¨¡å‹çš„Embeddingç»™æ›¿æ¢æ‰å‘¢ï¼Ÿ</p><p>å½“ç„¶æ˜¯å¯ä»¥çš„ï¼Œllama-indexæ”¯æŒä½ è‡ªå·±ç›´æ¥å®šä¹‰ä¸€ä¸ªå®šåˆ¶åŒ–çš„Embeddingï¼Œå¯¹åº”çš„ä»£ç æˆ‘æ”¾åœ¨äº†ä¸‹é¢ã€‚</p><pre><code class=\"language-python\">conda install -c conda-forge sentence-transformers\n</code></pre><p><span class=\"reference\">æ³¨ï¼šæˆ‘ä»¬éœ€è¦å…ˆå®‰è£…ä¸€ä¸‹sentence-transformersè¿™ä¸ªåº“ã€‚</span></p><pre><code class=\"language-python\">import openai, os\nimport faiss\nfrom llama_index import SimpleDirectoryReader, LangchainEmbedding, GPTFaissIndex, ServiceContext\nfrom langchain.embeddings.huggingface import HuggingFaceEmbeddings\nfrom langchain.text_splitter import CharacterTextSplitter\nfrom llama_index.node_parser import SimpleNodeParser\n\nopenai.api_key = \"\"\n\ntext_splitter = CharacterTextSplitter(separator=\"\\n\\n\", chunk_size=100, chunk_overlap=20)\nparser = SimpleNodeParser(text_splitter=text_splitter)\ndocuments = SimpleDirectoryReader('./data/faq/').load_data()\nnodes = parser.get_nodes_from_documents(documents)\n\nembed_model = LangchainEmbedding(HuggingFaceEmbeddings(\n    model_name=\"sentence-transformers/paraphrase-multilingual-mpnet-base-v2\"\n))\nservice_context = ServiceContext.from_defaults(embed_model=embed_model)\n\ndimension = 768\nfaiss_index = faiss.IndexFlatIP(dimension)\nindex = GPTFaissIndex(nodes=nodes,faiss_index=faiss_index, service_context=service_context)\n</code></pre><p>è¾“å‡ºç»“æœï¼š</p><pre><code class=\"language-python\">INFO:sentence_transformers.SentenceTransformer:Load pretrained SentenceTransformer: sentence-transformers/paraphrase-multilingual-mpnet-base-v2\nINFO:sentence_transformers.SentenceTransformer:Use pytorch device: cpu\nWARNING:root:Created a chunk of size 130, which is longer than the specified 100\nâ€¦â€¦\nINFO:llama_index.token_counter.token_counter:&gt; [build_index_from_documents] Total LLM token usage: 0 tokens\nINFO:llama_index.token_counter.token_counter:&gt; [build_index_from_documents] Total embedding token usage: 3198 tokens\n</code></pre><p>åœ¨è¿™ä¸ªä¾‹å­é‡Œé¢ï¼Œæˆ‘ä»¬ä½¿ç”¨äº†ä¸€ä¸ªé¢å‘ç”µå•†çš„FAQçš„çº¯æ–‡æœ¬æ–‡ä»¶ä½œä¸ºè¾“å…¥ã€‚é‡Œé¢æ˜¯ä¸€ç³»åˆ—é¢„è®¾å¥½çš„FAQé—®ç­”å¯¹ã€‚ä¸ºäº†ç¡®ä¿æˆ‘ä»¬æ²¡æœ‰ä½¿ç”¨OpenAIçš„APIï¼Œæˆ‘ä»¬å…ˆæŠŠopenai.api_keyç»™è®¾æˆäº†ä¸€ä¸ªç©ºå­—ç¬¦ä¸²ã€‚ç„¶åï¼Œæˆ‘ä»¬å®šä¹‰äº†ä¸€ä¸ªembeded_modelï¼Œè¿™ä¸ªembeded_modelé‡Œé¢ï¼Œæˆ‘ä»¬åŒ…è£…çš„æ˜¯ä¸€ä¸ªHuggingFaceEmbeddingsçš„ç±»ã€‚</p><p>å› ä¸ºHuggingFaceä¸ºåŸºäºtransformersçš„æ¨¡å‹å®šä¹‰äº†ä¸€ä¸ªæ ‡å‡†ï¼Œæ‰€ä»¥å¤§éƒ¨åˆ†æ¨¡å‹ä½ åªéœ€è¦ä¼ å…¥ä¸€ä¸ªæ¨¡å‹åç§°ï¼ŒHuggingFacebEmbeddingè¿™ä¸ªç±»å°±ä¼šä¸‹è½½æ¨¡å‹ã€åŠ è½½æ¨¡å‹ï¼Œå¹¶é€šè¿‡æ¨¡å‹æ¥è®¡ç®—ä½ è¾“å…¥çš„æ–‡æœ¬çš„Embeddingã€‚ä½¿ç”¨HuggingFaceçš„å¥½å¤„æ˜¯ï¼Œä½ å¯ä»¥é€šè¿‡ä¸€å¥—ä»£ç ä½¿ç”¨æ‰€æœ‰çš„transfomersç±»å‹çš„æ¨¡å‹ã€‚</p><p><a href=\"https://sbert.net/\">sentence-transformers</a> æ˜¯ç›®å‰æ•ˆæœæœ€å¥½çš„è¯­ä¹‰æœç´¢ç±»çš„æ¨¡å‹ï¼Œå®ƒåœ¨BERTçš„åŸºç¡€ä¸Šé‡‡ç”¨äº†å¯¹æ¯”å­¦ä¹ çš„æ–¹å¼ï¼Œæ¥åŒºåˆ†æ–‡æœ¬è¯­ä¹‰çš„ç›¸ä¼¼åº¦ï¼Œå®ƒåŒ…æ‹¬äº†ä¸€ç³»åˆ—çš„é¢„è®­ç»ƒæ¨¡å‹ã€‚æˆ‘ä»¬åœ¨è¿™é‡Œï¼Œé€‰ç”¨çš„æ˜¯ sentence-transformersä¸‹é¢çš„ paraphrase-multilingual-mpnet-base-v2&nbsp;æ¨¡å‹ã€‚é¡¾åæ€ä¹‰ï¼Œè¿™ä¸ªæ˜¯ä¸€ä¸ªæ”¯æŒå¤šè¯­è¨€ï¼ˆmultilingualï¼‰å¹¶ä¸”èƒ½æŠŠè¯­å¥å’Œæ®µè½ï¼ˆparaphraseï¼‰å˜æˆå‘é‡çš„ä¸€ä¸ªæ¨¡å‹ã€‚å› ä¸ºæˆ‘ä»¬ç»™çš„ç¤ºä¾‹éƒ½æ˜¯ä¸­æ–‡ï¼Œæ‰€ä»¥é€‰å–äº†è¿™ä¸ªæ¨¡å‹ã€‚ä½ å¯ä»¥æ ¹æ®ä½ è¦è§£å†³çš„å®é™…é—®é¢˜ï¼Œæ¥é€‰å–ä¸€ä¸ªé€‚åˆè‡ªå·±çš„æ¨¡å‹ã€‚</p><p>æˆ‘ä»¬è¿˜æ˜¯ä½¿ç”¨Faissè¿™ä¸ªåº“æ¥ä½œä¸ºæˆ‘ä»¬çš„å‘é‡ç´¢å¼•åº“ï¼Œæ‰€ä»¥éœ€è¦æŒ‡å®šä¸€ä¸‹å‘é‡çš„ç»´åº¦ï¼Œparaphrase-multilingual-mpnet-base-v2&nbsp;è¿™ä¸ªæ¨¡å‹çš„ç»´åº¦æ˜¯768ï¼Œæ‰€ä»¥æˆ‘ä»¬å°±æŠŠç»´åº¦å®šä¹‰æˆ768ç»´ã€‚</p><p>ç›¸åº”çš„å¯¹æ–‡æ¡£çš„åˆ‡åˆ†ï¼Œæˆ‘ä»¬ä½¿ç”¨çš„æ˜¯CharacterTextSplitterï¼Œå¹¶ä¸”åœ¨å‚æ•°ä¸Šæˆ‘ä»¬åšäº†ä¸€äº›è°ƒæ•´ã€‚</p><p>é¦–å…ˆï¼Œæˆ‘ä»¬æŠŠâ€œ\\n\\nâ€è¿™æ ·ä¸¤ä¸ªè¿ç»­çš„æ¢è¡Œç¬¦ä½œä¸ºä¸€æ®µæ®µæ–‡æœ¬çš„åˆ†éš”ç¬¦ï¼Œå› ä¸ºæˆ‘ä»¬çš„FAQæ•°æ®é‡Œï¼Œæ¯ä¸€ä¸ªé—®ç­”å¯¹éƒ½æœ‰ä¸€ä¸ªç©ºè¡Œéš”å¼€ï¼Œæ­£å¥½æ˜¯è¿ç»­ä¸¤ä¸ªæ¢è¡Œã€‚</p><p>ç„¶åï¼Œæˆ‘ä»¬æŠŠchunk_sizeè®¾ç½®å¾—æ¯”è¾ƒå°ï¼Œåªæœ‰100ã€‚è¿™æ˜¯å› ä¸ºæˆ‘ä»¬æ‰€ä½¿ç”¨çš„å¼€æºæ¨¡å‹æ˜¯ä¸ªå°æ¨¡å‹ï¼Œè¿™æ ·æˆ‘ä»¬æ‰èƒ½åœ¨å•æœºåŠ è½½èµ·æ¥ã€‚å®ƒèƒ½å¤Ÿæ”¯æŒçš„è¾“å…¥é•¿åº¦æœ‰é™ï¼Œåªæœ‰128ä¸ªTokenï¼Œè¶…å‡ºçš„éƒ¨åˆ†ä¼šè¿›è¡Œæˆªæ–­å¤„ç†ã€‚å¦‚æœæˆ‘ä»¬ä¸è®¾ç½®chunk_sizeï¼Œllama-indexä¼šè‡ªåŠ¨åˆå¹¶å¤šä¸ªchunkå˜æˆä¸€ä¸ªæ®µè½ã€‚</p><p>å…¶æ¬¡ï¼Œæˆ‘ä»¬è¿˜å¢åŠ äº†ä¸€ä¸ªå°å°çš„å‚æ•°ï¼Œå«åšchunk_overlapã€‚è¿™ä¸ªå‚æ•°ä»£è¡¨æˆ‘ä»¬è‡ªåŠ¨åˆå¹¶å°çš„æ–‡æœ¬ç‰‡æ®µçš„æ—¶å€™ï¼Œå¯ä»¥æ¥å—å¤šå¤§ç¨‹åº¦çš„é‡å ã€‚å®ƒçš„é»˜è®¤å€¼æ˜¯200ï¼Œè¶…è¿‡äº†å•æ®µæ–‡æ¡£çš„chunk_sizeï¼Œæ‰€ä»¥æˆ‘ä»¬è¿™é‡Œè¦æŠŠå®ƒè®¾å°ä¸€ç‚¹ï¼Œä¸ç„¶ç¨‹åºä¼šæŠ¥é”™ã€‚</p><p>æˆ‘ä»¬å¯ä»¥åœ¨å¯¹åº”çš„verboseæ—¥å¿—é‡Œçœ‹åˆ°ï¼Œè¿™é‡Œçš„Embeddingä½¿ç”¨äº†3198ä¸ªTokenï¼Œä¸è¿‡è¿™äº›Tokenéƒ½æ˜¯æˆ‘ä»¬é€šè¿‡sentence_transformersç±»å‹çš„å¼€æºæ¨¡å‹è®¡ç®—çš„ï¼Œä¸éœ€è¦èŠ±é’±ã€‚ä½ çš„æˆæœ¬å°±èŠ‚çº¦ä¸‹æ¥äº†ã€‚</p><p>åœ¨åˆ›å»ºå®Œæ•´ä¸ªç´¢å¼•ä¹‹åï¼Œæˆ‘ä»¬å°±å¯ä»¥æ‹¿ä¸€äº›å¸¸è§çš„ç”µå•†ç±»å‹çš„FAQé—®é¢˜è¯•ä¸€è¯•ã€‚</p><p>é—®é¢˜1ï¼š</p><pre><code class=\"language-plain\">from llama_index import QueryMode\n\nopenai.api_key = os.environ.get(\"OPENAI_API_KEY\")\n\nresponse = index.query(\n    \"è¯·é—®ä½ ä»¬æµ·å—èƒ½å‘è´§å—ï¼Ÿ\", \n    mode=QueryMode.EMBEDDING,\n    verbose=True, \n)\nprint(response)\n</code></pre><p>è¾“å‡ºç»“æœï¼š</p><pre><code class=\"language-plain\">&gt; Got node text: Q: æ”¯æŒå“ªäº›çœä»½é…é€ï¼Ÿ\nA: æˆ‘ä»¬æ”¯æŒå…¨å›½å¤§éƒ¨åˆ†çœä»½çš„é…é€ï¼ŒåŒ…æ‹¬åŒ—äº¬ã€ä¸Šæµ·ã€å¤©æ´¥ã€é‡åº†ã€æ²³åŒ—ã€å±±è¥¿ã€è¾½å®ã€å‰æ—ã€é»‘é¾™æ±Ÿã€æ±Ÿè‹ã€æµ™æ±Ÿã€å®‰å¾½ã€ç¦å»ºã€æ±Ÿè¥¿ã€å±±ä¸œã€æ²³å—ã€æ¹–åŒ—ã€æ¹–å—ã€å¹¿ä¸œã€æµ·å—ã€å››å·ã€è´µå·ã€äº‘å—ã€é™•è¥¿ã€ç”˜è‚ƒã€é’æµ·ã€å°æ¹¾ã€å†…è’™å¤ã€å¹¿è¥¿ã€è¥¿è—ã€å®å¤å’Œæ–°ç–†...\n\nINFO:llama_index.token_counter.token_counter:&gt; [query] Total LLM token usage: 341 tokens\nINFO:llama_index.token_counter.token_counter:&gt; [query] Total embedding token usage: 24 tokens\n\næ˜¯çš„ï¼Œæˆ‘ä»¬æ”¯æŒæµ·å—çœçš„é…é€ã€‚\n</code></pre><p>é—®é¢˜2ï¼š</p><pre><code class=\"language-plain\">response = index.query(\n    \"ä½ ä»¬ç”¨å“ªäº›å¿«é€’å…¬å¸é€è´§ï¼Ÿ\", \n    mode=QueryMode.EMBEDDING,\n    verbose=True, \n)\nprint(response)\n</code></pre><p>è¾“å‡ºç»“æœï¼š</p><pre><code class=\"language-plain\">&gt; Got node text: Q: æä¾›å“ªäº›å¿«é€’å…¬å¸çš„æœåŠ¡ï¼Ÿ\nA: æˆ‘ä»¬ä¸é¡ºä¸°é€Ÿè¿ã€åœ†é€šé€Ÿé€’ã€ç”³é€šå¿«é€’ã€éŸµè¾¾å¿«é€’ã€ä¸­é€šå¿«é€’ã€ç™¾ä¸–å¿«é€’ç­‰å¤šå®¶çŸ¥åå¿«é€’å…¬å¸åˆä½œã€‚...\nINFO:llama_index.token_counter.token_counter:&gt; [query] Total LLM token usage: 281 tokens\nINFO:llama_index.token_counter.token_counter:&gt; [query] Total embedding token usage: 27 tokens\n\næˆ‘ä»¬ä¸é¡ºä¸°é€Ÿè¿ã€åœ†é€šé€Ÿé€’ã€ç”³é€šå¿«é€’ã€éŸµè¾¾å¿«é€’ã€ä¸­é€šå¿«é€’ã€ç™¾ä¸–å¿«é€’ç­‰å¤šå®¶çŸ¥åå¿«é€’å…¬å¸åˆä½œï¼Œç”¨ä»–ä»¬çš„æœåŠ¡é€è´§ã€‚\n</code></pre><p>é—®é¢˜3ï¼š</p><pre><code class=\"language-plain\">response = index.query(\n    \"ä½ ä»¬çš„é€€è´§æ”¿ç­–æ˜¯æ€ä¹ˆæ ·çš„ï¼Ÿ\", \n    mode=QueryMode.EMBEDDING,\n    verbose=True, \n)\nprint(response)\n</code></pre><p>è¾“å‡ºç»“æœï¼š</p><pre><code class=\"language-plain\">&gt; Got node text: Q: é€€è´§æ”¿ç­–æ˜¯ä»€ä¹ˆï¼Ÿ\nA: è‡ªæ”¶åˆ°å•†å“ä¹‹æ—¥èµ·7å¤©å†…ï¼Œå¦‚äº§å“æœªä½¿ç”¨ã€åŒ…è£…å®Œå¥½ï¼Œæ‚¨å¯ä»¥ç”³è¯·é€€è´§ã€‚æŸäº›ç‰¹æ®Šå•†å“å¯èƒ½ä¸æ”¯æŒé€€è´§ï¼Œè¯·åœ¨è´­ä¹°å‰æŸ¥çœ‹å•†å“è¯¦æƒ…é¡µé¢çš„é€€è´§æ”¿ç­–ã€‚...\nINFO:llama_index.token_counter.token_counter:&gt; [query] Total LLM token usage: 393 tokens\nINFO:llama_index.token_counter.token_counter:&gt; [query] Total embedding token usage: 27 tokens\n\næˆ‘ä»¬çš„é€€è´§æ”¿ç­–æ˜¯è‡ªæ”¶åˆ°å•†å“ä¹‹æ—¥èµ·7å¤©å†…ï¼Œå¦‚äº§å“æœªä½¿ç”¨ã€åŒ…è£…å®Œå¥½ï¼Œæ‚¨å¯ä»¥ç”³è¯·é€€è´§ã€‚æŸäº›ç‰¹æ®Šå•†å“å¯èƒ½ä¸æ”¯æŒé€€è´§ï¼Œè¯·åœ¨è´­ä¹°å‰æŸ¥çœ‹å•†å“è¯¦æƒ…é¡µé¢çš„é€€è´§æ”¿ç­–ã€‚\n</code></pre><p>æˆ‘ä»¬åœ¨é—®é—®é¢˜çš„æ—¶å€™ï¼ŒæŒ‡å®šäº†queryçš„modeæ˜¯Embeddingã€‚é€šè¿‡ä¸‰ä¸ªå¸¸ç”¨çš„é—®é¢˜ï¼Œæˆ‘ä»¬å¯ä»¥çœ‹åˆ°ï¼ŒAIéƒ½ç»™å‡ºäº†æ­£ç¡®çš„å›ç­”ï¼Œæ•ˆæœè¿˜æ˜¯ä¸é”™çš„ã€‚</p><h2>ä½¿ç”¨ChatGLMæä¾›å¯¹è¯æ•ˆæœ</h2><p>é€šè¿‡ä¸Šé¢çš„ä»£ç ï¼Œæˆ‘ä»¬å·²ç»æŠŠç”ŸæˆEmbeddingä»¥åŠåˆ©ç”¨Embeddingçš„ç›¸ä¼¼åº¦è¿›è¡Œæœç´¢æå®šäº†ã€‚ä½†æ˜¯ï¼Œæˆ‘ä»¬åœ¨å®é™…é—®ç­”çš„è¿‡ç¨‹ä¸­ï¼Œä½¿ç”¨çš„è¿˜æ˜¯OpenAIçš„Completion APIã€‚é‚£ä¹ˆè¿™ä¸€éƒ¨åˆ†æˆ‘ä»¬æœ‰æ²¡æœ‰åŠæ³•ä¹Ÿæ›¿æ¢æ‰å‘¢ï¼Ÿ</p><p>åŒæ ·çš„ï¼Œæˆ‘ä»¬å¯»æ±‚å¼€æºæ¨¡å‹çš„å¸®åŠ©ã€‚åœ¨è¿™é‡Œï¼Œæˆ‘ä»¬å°±ä¸å¦¨æ¥è¯•ä¸€ä¸‹æ¥è‡ªæ¸…åå¤§å­¦çš„ChatGLMè¯­è¨€æ¨¡å‹ï¼Œçœ‹çœ‹ä¸­æ–‡çš„å¼€æºè¯­è¨€æ¨¡å‹ï¼Œæ˜¯ä¸æ˜¯ä¹Ÿæœ‰åŸºæœ¬çš„çŸ¥è¯†ç†è§£å’Œæ¨ç†èƒ½åŠ›ã€‚</p><p>é¦–å…ˆæˆ‘ä»¬è¿˜æ˜¯è¦å®‰è£…ä¸€äº›ä¾èµ–åŒ…ï¼Œå› ä¸ºicetkæˆ‘æ²¡æœ‰æ‰¾åˆ°Condaçš„æºï¼Œæ‰€ä»¥æˆ‘ä»¬è¿™é‡Œé€šè¿‡pipæ¥å®‰è£…ï¼Œä½†æ˜¯åœ¨Condaçš„åŒ…ç®¡ç†å™¨é‡Œä¸€æ ·èƒ½å¤Ÿçœ‹åˆ°ã€‚</p><pre><code class=\"language-python\">pip install icetk\npip install cpm_kernels\n</code></pre><p>ç„¶åï¼Œæˆ‘ä»¬è¿˜æ˜¯å…ˆé€šè¿‡transformersæ¥åŠ è½½æ¨¡å‹ã€‚<a href=\"https://github.com/THUDM/GLM-130B\">ChatGLM</a> æœ€å¤§çš„ä¸€ä¸ªæ¨¡å‹æœ‰1300äº¿ä¸ªå‚æ•°ã€‚</p><pre><code class=\"language-python\">from transformers import AutoTokenizer, AutoModel\ntokenizer = AutoTokenizer.from_pretrained(\"THUDM/chatglm-6b-int4\", trust_remote_code=True)\nmodel = AutoModel.from_pretrained(\"THUDM/chatglm-6b-int4\", trust_remote_code=True).half().cuda()\nmodel = model.eval()\n</code></pre><p>è¾“å‡ºç»“æœï¼š</p><pre><code class=\"language-python\">Explicitly passing a `revision` is encouraged when loading a model with custom code to ensure no malicious code has been contributed in a newer revision.\nExplicitly passing a `revision` is encouraged when loading a configuration with custom code to ensure no malicious code has been contributed in a newer revision.\nExplicitly passing a `revision` is encouraged when loading a model with custom code to ensure no malicious code has been contributed in a newer revision.\nNo compiled kernel found.\nCompiling kernels : /root/.cache/huggingface/modules/transformers_modules/THUDM/chatglm-6b-int4/dac03c3ac833dab2845a569a9b7f6ac4e8c5dc9b/quantization_kernels.c\nCompiling gcc -O3 -fPIC -std=c99 /root/.cache/huggingface/modules/transformers_modules/THUDM/chatglm-6b-int4/dac03c3ac833dab2845a569a9b7f6ac4e8c5dc9b/quantization_kernels.c -shared -o /root/.cache/huggingface/modules/transformers_modules/THUDM/chatglm-6b-int4/dac03c3ac833dab2845a569a9b7f6ac4e8c5dc9b/quantization_kernels.so\nKernels compiled : /root/.cache/huggingface/modules/transformers_modules/THUDM/chatglm-6b-int4/dac03c3ac833dab2845a569a9b7f6ac4e8c5dc9b/quantization_kernels.so\nLoad kernel : /root/.cache/huggingface/modules/transformers_modules/THUDM/chatglm-6b-int4/dac03c3ac833dab2845a569a9b7f6ac4e8c5dc9b/quantization_kernels.so\nUsing quantization cache\nApplying quantization to glm layers\n</code></pre><p>ä½†æ˜¯è¿™ä¹ˆå¤§çš„æ¨¡å‹ï¼Œæ— è®ºæ˜¯ä½ è‡ªå·±çš„ç”µè„‘ï¼Œè¿˜æ˜¯Colabæä¾›çš„GPUå’ŒTPUæ˜¾ç„¶éƒ½æ”¾ä¸äº†ã€‚æ‰€ä»¥æˆ‘ä»¬åªèƒ½é€‰ç”¨ä¸€ä¸ªè£å‰ªåçš„60äº¿ä¸ªå‚æ•°çš„ç‰ˆæœ¬ï¼Œå¹¶ä¸”æˆ‘ä»¬è¿˜å¿…é¡»ç”¨int-4é‡åŒ–çš„æ–¹å¼ï¼Œè€Œä¸æ˜¯ç”¨float16çš„æµ®ç‚¹æ•°ã€‚æ‰€ä»¥ï¼Œè¿™é‡Œæˆ‘ä»¬çš„æ¨¡å‹åå­—å°±å«åš chatglm-6b-int4ï¼Œä¹Ÿå°±æ˜¯ 6Bçš„å‚æ•°é‡ï¼Œé€šè¿‡int-4é‡åŒ–ã€‚ç„¶åï¼Œåœ¨è¿™é‡Œï¼Œæˆ‘ä»¬å¸Œæœ›é€šè¿‡GPUè¿›è¡Œæ¨¡å‹çš„è®¡ç®—ï¼Œæ‰€ä»¥åŠ è½½æ¨¡å‹çš„æ—¶å€™è°ƒç”¨äº†.cuda()ã€‚</p><p>è¿™é‡ŒåŠ è½½æ¨¡å‹çš„æ—¶å€™ï¼Œæˆ‘ä»¬è¿˜è®¾ç½®äº†ä¸€ä¸ª trust_remote_code = true çš„å‚æ•°ï¼Œè¿™æ˜¯å› ä¸ºChatGLMçš„æ¨¡å‹ä¸æ˜¯ä¸€ä¸ªHuggingfaceå®˜æ–¹å‘å¸ƒçš„æ¨¡å‹ï¼Œè€Œæ˜¯ç”±ç”¨æˆ·è´¡çŒ®çš„ï¼Œæ‰€ä»¥éœ€è¦ä½ æ˜¾å¼ç¡®è®¤ä½ ä¿¡ä»»è¿™ä¸ªæ¨¡å‹çš„ä»£ç ï¼Œå®ƒä¸ä¼šé€ æˆæ¶æ„çš„ç ´åã€‚æˆ‘ä»¬åæ­£æ˜¯åœ¨Colabé‡Œé¢è¿è¡Œè¿™ä¸ªä»£ç ï¼Œæ‰€ä»¥å€’æ˜¯ä¸ç”¨å¤ªæ‹…å¿ƒã€‚</p><p>å¦‚æœä½ æƒ³è¦ç”¨CPUè¿è¡Œï¼Œå¯ä»¥æŠŠæ¨¡å‹åŠ è½½çš„ä»£ç æ¢æˆä¸‹é¢è¿™æ ·ã€‚</p><pre><code class=\"language-python\">model = AutoModel.from_pretrained(\"THUDM/chatglm-6b-int4\",trust_remote_code=True).float()\n</code></pre><p>ä¸è¿‡ï¼Œæˆ‘ä¸å»ºè®®ä½ è¿™ä¹ˆåšã€‚ä½ æ²¡æœ‰GPUçš„è¯ï¼Œè¿˜æ˜¯ç›´æ¥ä½¿ç”¨Colabçš„GPUå°±å¥½äº†ã€‚å› ä¸ºCPUåœ¨è¿è¡Œå¯¹è¯çš„æ—¶å€™éå¸¸æ…¢ã€‚</p><p>åœ¨æ‹¿åˆ°æ¨¡å‹ä¹‹åæˆ‘ä»¬å°±å¯ä»¥å°è¯•ç€é€šè¿‡è¿™ä¸ªæ¨¡å‹æ¥è¿›è¡Œé—®ç­”äº†ã€‚</p><p>é—®é¢˜1ï¼š</p><pre><code class=\"language-python\">question = \"\"\"\nè‡ªæ”¶åˆ°å•†å“ä¹‹æ—¥èµ·7å¤©å†…ï¼Œå¦‚äº§å“æœªä½¿ç”¨ã€åŒ…è£…å®Œå¥½ï¼Œæ‚¨å¯ä»¥ç”³è¯·é€€è´§ã€‚æŸäº›ç‰¹æ®Šå•†å“å¯èƒ½ä¸æ”¯æŒé€€è´§ï¼Œè¯·åœ¨è´­ä¹°å‰æŸ¥çœ‹å•†å“è¯¦æƒ…é¡µé¢çš„é€€è´§æ”¿ç­–ã€‚\n\næ ¹æ®ä»¥ä¸Šä¿¡æ¯ï¼Œè¯·å›ç­”ä¸‹é¢çš„é—®é¢˜ï¼š\n\nQ: ä½ ä»¬çš„é€€è´§æ”¿ç­–æ˜¯æ€ä¹ˆæ ·çš„ï¼Ÿ\n\"\"\"\nresponse, history = model.chat(tokenizer, question, history=[])\nprint(response)\n</code></pre><p>è¾“å‡ºç»“æœï¼š</p><pre><code class=\"language-python\">æˆ‘ä»¬çš„é€€è´§æ”¿ç­–æ˜¯åœ¨äº§å“æœªä½¿ç”¨ã€åŒ…è£…å®Œå¥½çš„æƒ…å†µä¸‹ï¼Œè‡ªæ”¶åˆ°å•†å“ä¹‹æ—¥èµ·7å¤©å†…å¯ä»¥é€€è´§ã€‚è¯·æ³¨æ„ï¼ŒæŸäº›ç‰¹æ®Šå•†å“å¯èƒ½ä¸æ”¯æŒé€€è´§ï¼Œåœ¨è´­ä¹°å‰è¯·æŸ¥çœ‹å•†å“è¯¦æƒ…é¡µé¢çš„é€€è´§æ”¿ç­–ï¼Œä»¥äº†è§£å…·ä½“æƒ…å†µã€‚\n</code></pre><p>å¯ä»¥çœ‹åˆ°ï¼ŒChatGLMçš„å›ç­”ï¼Œçš„ç¡®æ˜¯æŒ‰ç…§æˆ‘ä»¬æç¤ºè¯­é‡Œé¢æœ‰çš„ä¸Šä¸‹æ–‡ç»™å‡ºçš„ã€‚æˆ‘ä»¬å¯ä»¥è¯•ç€å»æ‰æä¾›çš„FAQçš„å†…å®¹ï¼Œçœ‹çœ‹å®ƒçš„å›ç­”æ˜¯æ€æ ·çš„ã€‚</p><p>é—®é¢˜2ï¼š</p><pre><code class=\"language-python\">question = \"\"\"\nQ: ä½ ä»¬çš„é€€è´§æ”¿ç­–æ˜¯æ€ä¹ˆæ ·çš„ï¼Ÿ\nA: \n\"\"\"\nresponse, history = model.chat(tokenizer, question, history=[])\nprint(response)\n</code></pre><p>è¾“å‡ºç»“æœï¼š</p><pre><code class=\"language-python\">æˆ‘ä»¬å…¬å¸çš„æ”¿ç­–æ˜¯ï¼Œå¦‚æœæ‚¨åœ¨è´­ä¹°åçš„7å¤©å†…å‘ç°æˆ‘ä»¬çš„äº§å“ä¸ç¬¦åˆæ‚¨çš„æœŸæœ›ï¼Œå¯ä»¥ç”³è¯·é€€è´§ã€‚é€€è´§æ¡ä»¶å¦‚ä¸‹ï¼š\n1. ç¬¦åˆé€€è´§æ”¿ç­–è¦æ±‚çš„äº§å“ï¼›\n2. æœªä½¿ç”¨æˆ–æŸåçš„äº§å“ï¼›\n3. ç¬¦åˆé€€è´§åœ°ç‚¹çš„è¦æ±‚ï¼Œå³é€€è´§åœ°å€ä¸è´­ä¹°åœ°å€ç›¸åŒï¼›\n4. ç¬¦åˆé€€è´§æµç¨‹çš„è¦æ±‚ï¼Œå³æ‚¨éœ€è¦æä¾›æœ‰æ•ˆçš„é€€è´§å•å¹¶å®Œæˆé€€è´§æµç¨‹ã€‚\nå¦‚æœç¬¦åˆä¸Šè¿°é€€è´§æ”¿ç­–è¦æ±‚ï¼Œæˆ‘ä»¬å°†å°½å¿«å¤„ç†æ‚¨çš„é€€è´§ç”³è¯·ï¼Œå¹¶ä¸ºæ‚¨é€€æ¬¾ã€‚è¯·æ³¨æ„ï¼Œå¦‚æœæ‚¨å·²ç»ä½¿ç”¨äº†æˆ‘ä»¬çš„äº§å“ï¼Œæˆ–è€…äº§å“æœ‰æŸåæˆ–å˜è´¨ç­‰æƒ…å†µï¼Œæˆ‘ä»¬å°†æ— æ³•ä¸ºæ‚¨æä¾›é€€è´§æœåŠ¡ã€‚\n</code></pre><p>å¯ä»¥çœ‹åˆ°ï¼Œåœ¨æ²¡æœ‰åˆé€‚çš„ä¸Šä¸‹æ–‡ä¿¡æ¯çš„æ—¶å€™ï¼Œå®ƒç¼–é€ å‡ºäº†ä¸€äº›åŸæœ¬æ²¡æœ‰çš„è¦æ±‚ï¼Œæ¯”å¦‚â€œé€€è´§åœ°å€ä¸è´­ä¹°åœ°å€ç›¸åŒâ€ã€‚</p><p>æˆ‘ä»¬å†æ¥çœ‹ä¸€ä¸ªä¾‹å­ï¼Œçœ‹çœ‹å®ƒèƒ½ä¸èƒ½æ‹¥æœ‰ç®€å•çš„æ¨ç†èƒ½åŠ›ã€‚æˆ‘ä»¬çš„ä¸Šä¸‹æ–‡é‡Œåªè¯´äº†å¯ä»¥é€åˆ°æµ·å—ï¼Œæ²¡æœ‰è¯´æ˜¯å¦æ”¯æŒä¸‰äºšè¿™ä¸ªåŸå¸‚ï¼Œçœ‹çœ‹è¿™ä¸ªæ—¶å€™AIèƒ½ä¸èƒ½å›ç­”å¯¹è¿™ä¸ªé—®é¢˜ã€‚</p><p>é—®é¢˜3ï¼š</p><pre><code class=\"language-python\">question = \"\"\"\næˆ‘ä»¬æ”¯æŒå…¨å›½å¤§éƒ¨åˆ†çœä»½çš„é…é€ï¼ŒåŒ…æ‹¬åŒ—äº¬ã€ä¸Šæµ·ã€å¤©æ´¥ã€é‡åº†ã€æ²³åŒ—ã€å±±è¥¿ã€è¾½å®ã€å‰æ—ã€é»‘é¾™æ±Ÿã€æ±Ÿè‹ã€æµ™æ±Ÿã€å®‰å¾½ã€ç¦å»ºã€æ±Ÿè¥¿ã€å±±ä¸œã€æ²³å—ã€æ¹–åŒ—ã€æ¹–å—ã€å¹¿ä¸œã€æµ·å—ã€å››å·ã€è´µå·ã€äº‘å—ã€é™•è¥¿ã€ç”˜è‚ƒã€é’æµ·ã€å°æ¹¾ã€å†…è’™å¤ã€å¹¿è¥¿ã€è¥¿è—ã€å®å¤å’Œæ–°ç–†.\n\næ ¹æ®ä»¥ä¸Šä¿¡æ¯ï¼Œè¯·å›ç­”ä¸‹é¢çš„é—®é¢˜ï¼š\n\nQ: ä½ ä»¬èƒ½é…é€åˆ°ä¸‰äºšå—ï¼Ÿ\n\"\"\"\nresponse, history = model.chat(tokenizer, question, history=[])\nprint(response)\n</code></pre><p>è¾“å‡ºç»“æœï¼š</p><pre><code class=\"language-python\">æ˜¯çš„ï¼Œæˆ‘ä»¬æ”¯æŒå…¨å›½å¤§éƒ¨åˆ†çœä»½çš„é…é€ï¼ŒåŒ…æ‹¬ä¸‰äºšå¸‚ã€‚\n</code></pre><p>å¯ä»¥çœ‹åˆ°ï¼ŒChatGLMçŸ¥é“æ˜¯å¯ä»¥é…é€åˆ°ä¸‰äºšçš„ã€‚ä¸è¿‡ä¸‡ä¸€æ˜¯å·§åˆå‘¢ï¼Ÿæˆ‘ä»¬å†çœ‹çœ‹åœ¨ä¸Šä¸‹æ–‡é‡Œé¢ï¼Œå»æ‰äº†ä¸œä¸‰çœï¼Œç„¶åé—®é—®å®ƒèƒ½ä¸èƒ½é€åˆ°å“ˆå°”æ»¨ã€‚</p><p>é—®é¢˜4ï¼š</p><pre><code class=\"language-python\">question = \"\"\"\næˆ‘ä»¬æ”¯æŒå…¨å›½å¤§éƒ¨åˆ†çœä»½çš„é…é€ï¼ŒåŒ…æ‹¬åŒ—äº¬ã€ä¸Šæµ·ã€å¤©æ´¥ã€é‡åº†ã€æ²³åŒ—ã€å±±è¥¿ã€æ±Ÿè‹ã€æµ™æ±Ÿã€å®‰å¾½ã€ç¦å»ºã€æ±Ÿè¥¿ã€å±±ä¸œã€æ²³å—ã€æ¹–åŒ—ã€æ¹–å—ã€å¹¿ä¸œã€æµ·å—ã€å››å·ã€è´µå·ã€äº‘å—ã€é™•è¥¿ã€ç”˜è‚ƒã€é’æµ·ã€å°æ¹¾ã€å†…è’™å¤ã€å¹¿è¥¿ã€è¥¿è—ã€å®å¤å’Œæ–°ç–†.ä½†æ˜¯ä¸èƒ½é…é€åˆ°ä¸œä¸‰çœ\n\næ ¹æ®ä»¥ä¸Šä¿¡æ¯ï¼Œè¯·å›ç­”ä¸‹é¢çš„é—®é¢˜ï¼š\n\nQ: ä½ ä»¬èƒ½é…é€åˆ°å“ˆå°”æ»¨å—ï¼Ÿ\n\"\"\"\nresponse, history = model.chat(tokenizer, question, history=[])\nprint(response)\n</code></pre><p>å›ç­”ï¼š</p><pre><code class=\"language-python\">å¾ˆæŠ±æ­‰ï¼Œæˆ‘ä»¬ç›®å‰ä¸èƒ½é…é€åˆ°å“ˆå°”æ»¨ã€‚\n</code></pre><p>ç»“æœä¹Ÿæ˜¯æ­£ç¡®çš„ï¼Œè¿™ä¸ªæ—¶å€™ï¼ŒChatGLMä¼šå›ç­”æˆ‘ä»¬æ˜¯é€ä¸åˆ°å“ˆå°”æ»¨çš„ã€‚æ—¢ç„¶ChatGLMèƒ½å¤Ÿæ­£ç¡®å›ç­”è¿™ä¸ªé—®é¢˜ï¼Œé‚£æˆ‘ä»¬çš„FAQé—®ç­”å°±å¯ä»¥ç”¨ChatGLMæ¥æå®šäº†ã€‚</p><h2>å°†ChatGLMå°è£…æˆLLM</h2><p>ä¸è¿‡ä¸Šé¢çš„ä»£ç é‡Œé¢ï¼Œæˆ‘ä»¬ç”¨çš„è¿˜æ˜¯åŸå§‹çš„ChatGLMçš„æ¨¡å‹ä»£ç ï¼Œè¿˜ä¸èƒ½ç›´æ¥é€šè¿‡queryæ¥è®¿é—®llama-indexç›´æ¥å¾—åˆ°ç­”æ¡ˆã€‚è¦åšåˆ°è¿™ä¸€ç‚¹å€’ä¹Ÿä¸éš¾ï¼Œæˆ‘ä»¬æŠŠå®ƒå°è£…æˆä¸€ä¸ªLLMç±»ï¼Œè®©æˆ‘ä»¬çš„indexä½¿ç”¨è¿™ä¸ªæŒ‡å®šçš„å¤§è¯­è¨€æ¨¡å‹å°±å¥½äº†ã€‚å¯¹åº”çš„ <a href=\"https://gpt-index.readthedocs.io/en/latest/how_to/customization/custom_llms.html\">llama-index çš„æ–‡æ¡£</a>ï¼Œä½ ä¹Ÿå¯ä»¥è‡ªå·±å»çœ‹ä¸€ä¸‹ã€‚</p><pre><code class=\"language-python\">import openai, os\nimport faiss\nfrom llama_index import SimpleDirectoryReader, LangchainEmbedding, GPTFaissIndex, ServiceContext\nfrom langchain.embeddings.huggingface import HuggingFaceEmbeddings\nfrom langchain.text_splitter import CharacterTextSplitter\nfrom llama_index.node_parser import SimpleNodeParser\n\nfrom langchain.llms.base import LLM\nfrom llama_index import LLMPredictor\nfrom typing import Optional, List, Mapping, Any\n\nclass CustomLLM(LLM):\n    def _call(self, prompt: str, stop: Optional[List[str]] = None) -&gt; str:\n        response, history = model.chat(tokenizer, prompt, history=[])\n        return response\n\n    @property\n    def _identifying_params(self) -&gt; Mapping[str, Any]:\n        return {\"name_of_model\": \"chatglm-6b-int4\"}\n\n    @property\n    def _llm_type(self) -&gt; str:\n        return \"custom\"\n</code></pre><p>æˆ‘ä»¬æŠŠè¿™ä¸ªCustomLLMå¯¹è±¡ï¼Œä¼ å…¥indexçš„æ„é€ å‡½æ•°é‡Œï¼Œé‡æ–°è¿è¡Œä¸€ä¸‹æˆ‘ä»¬çš„é—®é¢˜ï¼Œçœ‹çœ‹æ•ˆæœæ˜¯æ€æ ·çš„ã€‚</p><pre><code class=\"language-python\">from langchain.text_splitter import SpacyTextSplitter\n\nllm_predictor = LLMPredictor(llm=CustomLLM())\n\ntext_splitter = CharacterTextSplitter(separator=\"\\n\\n\", chunk_size=100, chunk_overlap=20)\nparser = SimpleNodeParser(text_splitter=text_splitter)\ndocuments = SimpleDirectoryReader('./drive/MyDrive/colab_data/faq/').load_data()\nnodes = parser.get_nodes_from_documents(documents)\n\nembed_model = LangchainEmbedding(HuggingFaceEmbeddings(\n    model_name=\"sentence-transformers/paraphrase-multilingual-mpnet-base-v2\"\n))\nservice_context = ServiceContext.from_defaults(embed_model=embed_model, llm_predictor=llm_predictor)\n\ndimension = 768\nfaiss_index = faiss.IndexFlatIP(dimension)\nindex = GPTFaissIndex(nodes=nodes, faiss_index=faiss_index, service_context=service_context)\n</code></pre><pre><code class=\"language-python\">from llama_index import QuestionAnswerPrompt\nfrom llama_index import QueryMode\n\nQA_PROMPT_TMPL = (\n    \"{context_str}\"\n    \"\\n\\n\"\n    \"æ ¹æ®ä»¥ä¸Šä¿¡æ¯ï¼Œè¯·å›ç­”ä¸‹é¢çš„é—®é¢˜ï¼š\\n\"\n    \"Q: {query_str}\\n\"\n    )\nQA_PROMPT = QuestionAnswerPrompt(QA_PROMPT_TMPL)\n\nresponse = index.query(\n    \"è¯·é—®ä½ ä»¬æµ·å—èƒ½å‘è´§å—ï¼Ÿ\", \n    mode=QueryMode.EMBEDDING,\n    text_qa_template=QA_PROMPT,\n    verbose=True, \n)\nprint(response)\n</code></pre><p>è¾“å‡ºç»“æœï¼š</p><pre><code class=\"language-python\">&gt; Got node text: Q: æ”¯æŒå“ªäº›çœä»½é…é€ï¼Ÿ\nA: æˆ‘ä»¬æ”¯æŒå…¨å›½å¤§éƒ¨åˆ†çœä»½çš„é…é€ï¼ŒåŒ…æ‹¬åŒ—äº¬ã€ä¸Šæµ·ã€å¤©æ´¥ã€é‡åº†ã€æ²³åŒ—ã€å±±è¥¿ã€è¾½å®ã€å‰æ—ã€é»‘é¾™æ±Ÿã€æ±Ÿè‹ã€æµ™æ±Ÿã€å®‰å¾½ã€ç¦å»ºã€æ±Ÿè¥¿ã€å±±ä¸œã€æ²³å—ã€æ¹–åŒ—ã€æ¹–å—ã€å¹¿ä¸œã€æµ·å—ã€å››å·ã€è´µå·ã€äº‘å—ã€é™•è¥¿ã€ç”˜è‚ƒã€é’æµ·ã€å°æ¹¾ã€å†…è’™å¤ã€å¹¿è¥¿ã€è¥¿è—ã€å®å¤å’Œæ–°ç–†...\n\næµ·å—èƒ½å‘è´§ã€‚\n</code></pre><p>å¯ä»¥çœ‹åˆ°ï¼Œè¿™æ ·å¤„ç†ä¹‹åï¼Œæˆ‘ä»¬å°±å¯ä»¥ç›´æ¥ä½¿ç”¨ChatGLMçš„æ¨¡å‹ï¼Œæ¥è¿›è¡Œæˆ‘ä»¬çš„FAQçš„é—®ç­”äº†ã€‚</p><p>ç°åœ¨ï¼Œæˆ‘ä»¬æœ‰äº†ä¸€ä¸ªé€šè¿‡paraphrase-multilingual-mpnet-base-v2æ¨¡å‹æ¥è®¡ç®—Embedddingå¹¶è¿›è¡Œè¯­ä¹‰æœç´¢ï¼Œç„¶åé€šè¿‡chatglm-6b-int4çš„æ¨¡å‹æ¥è¿›è¡Œé—®ç­”çš„è§£å†³æ–¹æ¡ˆäº†ã€‚è€Œä¸”è¿™ä¸¤ä¸ªæ¨¡å‹ï¼Œå¯ä»¥è·‘åœ¨ä¸€å—å®¶ç”¨çº§åˆ«çš„æ˜¾å¡ä¸Šã€‚æ˜¯ä¸æ˜¯å¾ˆå‰å®³ï¼Ÿ</p><h2>å¼€æºæ¨¡å‹çš„ä¸è¶³ä¹‹å¤„</h2><p>çœ‹èµ·æ¥ï¼Œæˆ‘ä»¬è¿™ä¸ªæœ¬æœºå°±èƒ½è¿è¡Œçš„å°æ¨¡å‹ä¼¼ä¹å·²ç»å®Œæˆäº†ã€‚æ•°æ®å®‰å…¨ï¼Œåˆä¸ç”¨æ‹…å¿ƒèŠ±è´¹ã€‚ä½†æ˜¾ç„¶ï¼Œäº‹æƒ…æ²¡æœ‰é‚£ä¹ˆç®€å•ã€‚å› ä¸ºåˆšæ‰æˆ‘ä»¬å¤„ç†çš„ç”µå•†FAQé—®é¢˜æ¯”è¾ƒç®€å•ï¼Œæˆ‘ä»¬å†æ‹¿ä¸€ä¸ªç¨å¾®å¤æ‚ä¸€ç‚¹çš„é—®é¢˜æ¥çœ‹çœ‹æ•ˆæœã€‚</p><pre><code class=\"language-python\">text_splitter = SpacyTextSplitter(pipeline=\"zh_core_web_sm\", chunk_size = 128, chunk_overlap=32)\nparser = SimpleNodeParser(text_splitter=text_splitter)\ndocuments = SimpleDirectoryReader('./drive/MyDrive/colab_data/zhaohuaxishi/').load_data()\nnodes = parser.get_nodes_from_documents(documents)\n\nembed_model = LangchainEmbedding(HuggingFaceEmbeddings(\n    model_name=\"sentence-transformers/paraphrase-multilingual-mpnet-base-v2\"\n))\nservice_context = ServiceContext.from_defaults(embed_model=embed_model, llm_predictor=llm_predictor)\n\ndimension = 768\nfaiss_index = faiss.IndexFlatIP(dimension)\nindex = GPTFaissIndex(nodes=nodes, faiss_index=faiss_index, service_context=service_context)\n</code></pre><p>è¾“å‡ºç»“æœï¼š</p><pre><code class=\"language-python\">INFO:sentence_transformers.SentenceTransformer:Load pretrained SentenceTransformer: sentence-transformers/paraphrase-multilingual-mpnet-base-v2\nINFO:sentence_transformers.SentenceTransformer:Use pytorch device: cpu\nâ€¦â€¦\nINFO:llama_index.token_counter.token_counter:&gt; [build_index_from_documents] Total LLM token usage: 0 tokens\nINFO:llama_index.token_counter.token_counter:&gt; [build_index_from_documents] Total embedding token usage: 91882 tokens\n</code></pre><p>è¿™ä¸€æ¬¡ï¼Œæˆ‘ä»¬è¾“å…¥ç´¢å¼•èµ·æ¥çš„æ•°æ®ï¼Œæ˜¯é²è¿…å…ˆç”Ÿæ•´å¥—ã€ŠæœèŠ±å¤•æ‹¾ã€‹çš„æ•£æ–‡é›†ã€‚é€‰ç”¨è¿™ä¸ªæ˜¯å› ä¸ºå¯¹åº”ä½œå“çš„ç‰ˆæƒå·²ç»è¿‡äº†ä¿æŠ¤æœŸã€‚æˆ‘ä»¬æ¥çœ‹çœ‹ï¼Œåœ¨è¿™å¥—æ–‡é›†çš„å†…å®¹é‡Œé¢ï¼Œä½¿ç”¨æˆ‘ä»¬ä¸Šé¢çš„çº¯å¼€æºæ–¹æ¡ˆï¼Œæ•ˆæœä¼šæ˜¯æ€æ ·çš„ã€‚</p><p>å¯¹åº”çš„æ¨¡å‹å’Œç´¢å¼•åŠ è½½çš„ä»£ç åŸºæœ¬ä¸€è‡´ï¼Œåªæœ‰ä¸€ä¸ªå°å°çš„åŒºåˆ«ï¼Œå°±æ˜¯åœ¨æ–‡æœ¬åˆ†å‰²çš„æ—¶å€™ï¼Œæˆ‘ä»¬ç”¨äº†ä¸Šä¸€è®²ä»‹ç»è¿‡çš„SpacyTextSplitterï¼Œå› ä¸ºè¿™é‡Œéƒ½æ˜¯æ•£æ–‡çš„å†…å®¹ï¼Œè€Œä¸æ˜¯ç¡®å®šå¥½æ ¼å¼çš„QAå¯¹ã€‚æ‰€ä»¥é€šè¿‡SpacyTextSplitteræ¥åˆ†å¥ï¼Œå¹¶åœ¨å…è®¸çš„æ—¶å€™åˆå¹¶å°çš„ç‰‡æ®µæ˜¯æœ‰æ„ä¹‰çš„ã€‚</p><p>ç„¶åï¼Œæˆ‘ä»¬è¯•ç€é—®ä¸€ä¸‹ä¸Šä¸€è®²æˆ‘ä»¬é—®è¿‡çš„é—®é¢˜ï¼Œçœ‹çœ‹æ•ˆæœæ€ä¹ˆæ ·ã€‚</p><p>é—®é¢˜1ï¼š</p><pre><code class=\"language-python\"># query will use the same embed_model\nfrom llama_index import QueryMode\nfrom llama_index import QuestionAnswerPrompt\n\nopenai.api_key = os.environ.get(\"OPENAI_API_KEY\")\n\nQA_PROMPT_TMPL = (\n    \"ä¸‹é¢çš„å†…å®¹æ¥è‡ªé²è¿…å…ˆç”Ÿçš„æ•£æ–‡é›†ã€ŠæœèŠ±å¤•æ‹¾ã€‹ï¼Œå¾ˆå¤šå†…å®¹æ˜¯ä»¥ç¬¬ä¸€äººç§°å†™çš„ \\n\"\n    \"---------------------\\n\"\n    \"{context_str}\"\n    \"\\n---------------------\\n\"\n    \"æ ¹æ®è¿™äº›ä¿¡æ¯ï¼Œè¯·å›ç­”é—®é¢˜: {query_str}\\n\"\n    \"å¦‚æœæ‚¨ä¸çŸ¥é“çš„è¯ï¼Œè¯·å›ç­”ä¸çŸ¥é“\\n\"\n)\nQA_PROMPT = QuestionAnswerPrompt(QA_PROMPT_TMPL)\n\nresponse = index.query(\n    \"é²è¿…å…ˆç”Ÿåœ¨æ—¥æœ¬å­¦ä¹ åŒ»å­¦çš„è€å¸ˆæ˜¯è°ï¼Ÿ\", \n    mode=QueryMode.EMBEDDING,\n    similarity_top_k = 1,\n    text_qa_template=QA_PROMPT,\n    verbose=True, \n)\nprint(response)\n</code></pre><p>è¾“å‡ºç»“æœï¼š</p><pre><code class=\"language-python\">&gt; Got node text: ä¸€å°†ä¹¦æ”¾åœ¨è®²å°ä¸Šï¼Œä¾¿ç”¨äº†ç¼“æ…¢è€Œå¾ˆæœ‰é¡¿æŒ«çš„å£°è°ƒï¼Œå‘å­¦ç”Ÿä»‹ç»è‡ªå·±é“ï¼šâ€”â€” \n    â€œæˆ‘å°±æ˜¯å«ä½œè—¤é‡ä¸¥ä¹éƒçš„â€¦â€¦ã€‚â€\n\n    \nåé¢æœ‰å‡ ä¸ªäººç¬‘èµ·æ¥äº†ã€‚\nä»–æ¥ç€ä¾¿è®²è¿°è§£å‰–å­¦åœ¨æ—¥æœ¬å‘è¾¾çš„å†å²ï¼Œé‚£äº›å¤§å¤§å°å°çš„ä¹¦ï¼Œä¾¿æ˜¯ä»æœ€åˆåˆ°ç°ä»Šå…³äºè¿™ä¸€é—¨å­¦é—®çš„è‘—ä½œã€‚...\n\né²è¿…å…ˆç”Ÿåœ¨æ—¥æœ¬å­¦ä¹ åŒ»å­¦çš„è€å¸ˆæ˜¯è—¤é‡ä¸¥ä¹éƒã€‚\n</code></pre><p>é—®é¢˜2ï¼š</p><pre><code class=\"language-python\">response = index.query(\n    \"é²è¿…å…ˆç”Ÿæ˜¯åœ¨æ—¥æœ¬çš„å“ªä¸ªåŸå¸‚å­¦ä¹ åŒ»å­¦çš„ï¼Ÿ\", \n    mode=QueryMode.EMBEDDING, \n    similarity_top_k = 1,   \n    text_qa_template=QA_PROMPT,\n    verbose=True, \n)\nprint(response)\n</code></pre><p>è¾“å‡ºç»“æœï¼š</p><pre><code class=\"language-python\">&gt; Got node text: æœ‰æ—¶æˆ‘å¸¸å¸¸æƒ³ï¼šä»–çš„å¯¹äºæˆ‘çš„çƒ­å¿ƒçš„å¸Œæœ›ï¼Œä¸å€¦çš„æ•™è¯²ï¼Œå°è€Œè¨€ä¹‹ï¼Œæ˜¯ä¸ºä¸­å›½ï¼Œå°±æ˜¯å¸Œæœ›ä¸­å›½æœ‰æ–°çš„åŒ»å­¦ï¼›å¤§è€Œè¨€ä¹‹ï¼Œæ˜¯ä¸ºå­¦æœ¯ï¼Œå°±æ˜¯å¸Œæœ›æ–°çš„åŒ»å­¦ä¼ åˆ°ä¸­å›½å»ã€‚...\n\næ ¹æ®è¿™äº›ä¿¡æ¯ï¼Œæ— æ³•å¾—å‡ºé²è¿…å…ˆç”Ÿæ˜¯åœ¨æ—¥æœ¬çš„å“ªä¸ªåŸå¸‚å­¦ä¹ åŒ»å­¦çš„ç­”æ¡ˆã€‚\n</code></pre><p>å¯ä»¥çœ‹åˆ°ï¼Œæœ‰äº›é—®é¢˜åœ¨è¿™ä¸ªæ¨¡å¼ä¸‹ï¼Œå®šä½åˆ°çš„æ–‡æœ¬ç‰‡æ®µæ˜¯æ­£ç¡®çš„ã€‚ä½†æ˜¯æœ‰äº›é—®é¢˜ï¼Œè™½ç„¶å®šä½çš„è¿˜ç®—æ˜¯ä¸€ä¸ªç›¸å…³çš„ç‰‡æ®µï¼Œä½†æ˜¯çš„ç¡®æ— æ³•å¾—å‡ºç­”æ¡ˆã€‚</p><p>åœ¨è¿™ä¸ªè¿‡ç¨‹ä¸­ï¼Œæˆ‘ä»¬å¯ä»¥è§‚å¯Ÿåˆ°è¿™æ ·ä¸€ä¸ªé—®é¢˜ï¼š é‚£å°±æ˜¯å•æœºçš„å¼€æºå°æ¨¡å‹èƒ½å¤Ÿæ‰¿è½½çš„æ–‡æœ¬è¾“å…¥çš„é•¿åº¦é—®é¢˜ã€‚åœ¨æˆ‘ä»¬ä½¿ç”¨OpenAIçš„gpt-3.5-turboæ¨¡å‹çš„æ—¶å€™ï¼Œæˆ‘ä»¬æœ€é•¿æ”¯æŒ4096ä¸ªTokenï¼Œä¹Ÿå°±æ˜¯ä¸€ä¸ªæ–‡æœ¬ç‰‡æ®µå¯ä»¥æ”¾ä¸Šä¸Šåƒå­—åœ¨é‡Œé¢ã€‚ä½†æ˜¯æˆ‘ä»¬è¿™é‡Œå•æœºç”¨çš„paraphrase-multilingual-mpnet-base-v2æ¨¡å‹ï¼Œåªèƒ½æ”¯æŒ128ä¸ªTokençš„è¾“å…¥ï¼Œè™½ç„¶å¯¹åº”çš„Tokenizerä¸ä¸€æ ·ï¼Œä½†æ˜¯å°±ç®—ä¸€ä¸ªå­—ä¸€ä¸ªTokenï¼Œä¹Ÿå°±100ä¸ªå­—è€Œå·²ã€‚è¿™ä½¿å¾—æˆ‘ä»¬æ£€ç´¢å‡ºæ¥çš„å†…å®¹çš„ä¸Šä¸‹æ–‡å¤ªå°‘äº†ï¼Œå¾ˆå¤šæ—¶å€™æ²¡æœ‰è¶³å¤Ÿçš„ä¿¡æ¯ï¼Œè®©è¯­è¨€æ¨¡å‹å»å›ç­”ã€‚</p><p>å½“ç„¶ï¼Œè¿™ä¸ªé—®é¢˜å¹¶ä¸æ˜¯æ— æ³•å¼¥è¡¥çš„ã€‚æˆ‘ä»¬å¯ä»¥é€šè¿‡æŠŠæ›´å¤§è§„æ¨¡çš„æ¨¡å‹ï¼Œéƒ¨ç½²åˆ°äº‘ç«¯æ¥è§£å†³ã€‚è¿™ä¸ªå†…å®¹ï¼Œæˆ‘ä»¬è¯¾ç¨‹çš„ç¬¬ä¸‰éƒ¨åˆ†ä¸“é—¨æœ‰ä¸€è®²ä¼šè®²è§£ã€‚</p><p>ä¸è¿‡ï¼Œæœ‰ä¸€ä¸ªæ›´éš¾è§£å†³çš„é—®é¢˜ï¼Œå°±æ˜¯æ¨¡å‹çš„æ¨ç†èƒ½åŠ›é—®é¢˜ã€‚æ¯”å¦‚ï¼Œæˆ‘ä»¬å¯ä»¥å†è¯•è¯•<a href=\"https://time.geekbang.org/column/article/641742\">ç¬¬ 1 è®²</a>é‡Œç»™å•†å“æ€»ç»“è‹±æ–‡åç§°å’Œå–ç‚¹çš„ä¾‹å­ã€‚</p><pre><code class=\"language-python\">question = \"\"\"Consideration proudct : å·¥å‚ç°è´§PVCå……æ°”é’è›™å¤œå¸‚åœ°æ‘Šçƒ­å–å……æ°”ç©å…·å‘å…‰è›™å„¿ç«¥æ°´ä¸Šç©å…·\n\n1. Compose human readale product title used on Amazon in english within 20 words.\n2. Write 5 selling points for the products in Amazon.\n3. Evaluate a price range for this product in U.S.\n\nOutput the result in json format with three properties called title, selling_points and price_range\"\"\"\nresponse, history = model.chat(tokenizer, question, history=[])\nprint(response)\n</code></pre><p>è¾“å‡ºç»“æœï¼š</p><pre><code class=\"language-python\">1. title: å……æ°”ç©å…·é’è›™å¤œå¸‚åœ°æ‘Šå–\n2. selling_points:\n    - å·¥å‚ç°è´§ï¼šä¿è¯äº§å“è´¨é‡\n    - PVCå……æ°”ï¼šç¯ä¿è€ç”¨\n    - å¤œå¸‚åœ°æ‘Šï¼šæ–¹ä¾¿é”€å”®\n    - çƒ­å–ï¼šæœ€å—æ¬¢è¿äº§å“\n    - å„¿ç«¥æ°´ä¸Šç©å…·ï¼šé€‚åˆå„ç§å¹´é¾„æ®µå„¿ç«¥\n3. price_range: (in USD)\n    - low:   $1.99\n    - high:   $5.99\n</code></pre><p>å¯ä»¥çœ‹åˆ°ï¼Œè™½ç„¶è¿™ä¸ªç»“æœä¸ç®—å¤ªç¦»è°±ï¼Œå¤šå°‘å’Œé—®é¢˜è¿˜æ˜¯æœ‰äº›å…³ç³»çš„ã€‚ä½†æ˜¯æ— è®ºæ˜¯ç¿»è¯‘æˆè‹±æ–‡ï¼Œè¿˜æ˜¯ä½¿ç”¨JSONè¿”å›ï¼Œæ¨¡å‹éƒ½æ²¡æœ‰åšåˆ°ã€‚ç»™åˆ°çš„å–ç‚¹ä¹Ÿæ²¡æœ‰ä»»ä½•â€œæ¨ç†å‡ºæ¥â€çš„æ€§è´¨ï¼Œéƒ½æ˜¯ç®€å•åœ°å¯¹æ ‡é¢˜çš„é‡å¤æè¿°ã€‚å³ä½¿ä½ éƒ¨ç½²ä¸€ä¸ªæ›´å¤§ç‰ˆæœ¬çš„æ¨¡å‹åˆ°äº‘ç«¯ï¼Œä¹Ÿå¥½ä¸åˆ°å“ªé‡Œå»ã€‚</p><p>è¿™ä¹Ÿæ˜¯ChatGPTè®©äººéœ‡æ’¼çš„åŸå› ï¼Œçš„ç¡®ç›®å‰å®ƒçš„æ•ˆæœè¿˜æ˜¯è¦è¿œè¿œè¶…å‡ºä»»ä½•ä¸€ä¸ªç«äº‰å¯¹æ‰‹å’Œå¼€æºé¡¹ç›®çš„ã€‚</p><h2>å°ç»“</h2><p>å¥½äº†ï¼Œæœ€åæˆ‘ä»¬æ¥å›é¡¾ä¸€ä¸‹ã€‚è¿™ä¸€è®²é‡Œï¼Œæˆ‘ä»¬ä¸€èµ·å°è¯•ç”¨å¼€æºæ¨¡å‹æ¥ä»£æ›¿ChatGPTã€‚æˆ‘ä»¬é€šè¿‡sentence_transfomersç±»å‹çš„æ¨¡å‹ï¼Œç”Ÿæˆäº†æ–‡æœ¬åˆ†ç‰‡çš„Embeddingï¼Œå¹¶ä¸”åŸºäºè¿™ä¸ªEmbeddingæ¥è¿›è¡Œè¯­ä¹‰æ£€ç´¢ã€‚æˆ‘ä»¬é€šè¿‡ ChatGLM è¿™ä¸ªå¼€æºæ¨¡å‹ï¼Œå®ç°äº†åŸºäºä¸Šä¸‹æ–‡æç¤ºè¯­çš„é—®ç­”ã€‚åœ¨ç®€å•çš„ç”µå•†QAè¿™æ ·çš„åœºæ™¯é‡Œï¼Œæ•ˆæœä¹Ÿè¿˜æ˜¯ä¸é”™çš„ã€‚å³ä½¿æˆ‘ä»¬ä½¿ç”¨çš„éƒ½æ˜¯å•æœºå°æ¨¡å‹ï¼Œå®ƒä¹Ÿèƒ½æ­£ç¡®å›ç­”å‡ºæ¥ã€‚è¿™äº›æ–¹æ³•ï¼Œä¹Ÿèƒ½èŠ‚çº¦æˆ‘ä»¬çš„æˆæœ¬ã€‚ä¸ç”¨æŠŠé’±éƒ½äº¤ç»™OpenAIï¼Œå¯ä»¥æ”’ç€ä¹°æ˜¾å¡æ¥è®­ç»ƒè‡ªå·±çš„æ¨¡å‹ã€‚</p><p>ä½†æ˜¯ï¼Œå½“æˆ‘ä»¬éœ€è¦è§£å†³æ›´åŠ å¤æ‚çš„é—®é¢˜æ—¶ï¼Œæ¯”å¦‚éœ€è¦æ›´é•¿çš„ä¸Šä¸‹æ–‡ä¿¡æ¯ï¼Œæˆ–è€…éœ€è¦æ¨¡å‹æœ¬èº«æ›´å¼ºçš„æ¨ç†èƒ½åŠ›çš„æ—¶å€™ï¼Œè¿™æ ·çš„å°æ¨¡å‹å°±è¿œè¿œä¸å¤Ÿç”¨äº†ã€‚æ›´é•¿çš„ä¸Šä¸‹æ–‡ä¿¡æ¯æ£€ç´¢ï¼Œæˆ‘ä»¬è¿˜èƒ½å¤Ÿé€šè¿‡åœ¨äº‘ç«¯éƒ¨ç½²æ›´å¤§è§„æ¨¡çš„æ¨¡å‹ï¼Œè§£å†³éƒ¨åˆ†é—®é¢˜ã€‚ä½†æ˜¯æ¨¡å‹çš„æ¨ç†èƒ½åŠ›ï¼Œç›®å‰çš„ç¡®æ²¡æœ‰å¥½çš„è§£å†³æ–¹æ¡ˆã€‚</p><p>æ‰€ä»¥ä¸å¾—ä¸ä½©æœï¼ŒOpenAIçš„åœ¨AGIè¿™ä¸ªç›®æ ‡ä¸Šè€•è€˜å¤šå¹´åéœ‡æƒŠä¸–äººçš„æ•ˆæœã€‚</p><h2>æ€è€ƒé¢˜</h2><p>æœ€åï¼Œç»™ä½ ç•™ä¸€ä¸ªæ€è€ƒé¢˜ã€‚ChatGLMå¹¶ä¸æ˜¯å”¯ä¸€çš„ä¸­æ–‡å¤§è¯­è¨€æ¨¡å‹ï¼Œå¼€æºç¤¾åŒºç›®å‰åœ¨å¿«é€Ÿæ¨è¿›ï¼Œå°è¯•ç”¨å„ç§æ–¹å¼æä¾›æ›´å¥½çš„å¼€æºå¤§æ¨¡å‹ã€‚æ¯”å¦‚åŸºäºæ–¯å¦ç¦çš„Alpacaæ•°æ®é›†è¿›è¡Œå¾®è°ƒçš„ <a href=\"https://github.com/ymcui/Chinese-LLaMA-Alpaca\">Chinese-LLaMA-Alpaca</a>ï¼Œé“¾å®¶ç§‘æŠ€å¼€æºçš„ <a href=\"https://github.com/LianjiaTech/BELLE\">BELLE</a>ã€‚ä½ å¯ä»¥æŒ‘é€‰ä¸€ä¸ªæ¨¡å‹è¯•ä¸€è¯•ï¼Œçœ‹çœ‹å®ƒä»¬çš„æ•ˆæœå’ŒChatGLMæ¯”èµ·æ¥æ€ä¹ˆæ ·ã€‚æ¬¢è¿ä½ æŠŠä½ çš„è¯„æµ‹ç»“æœåˆ†äº«å‡ºæ¥ï¼Œä¹Ÿæ¬¢è¿ä½ æŠŠè¿™èŠ‚è¯¾åˆ†äº«ç»™éœ€è¦çš„æœ‹å‹ï¼Œå…±åŒå‚è°‹ï¼Œä¸€èµ·è¿›æ­¥ã€‚æˆ‘ä»¬ä¸‹èŠ‚è¯¾å†è§ã€‚</p><h2>æ¨èé˜…è¯»</h2><p>åŸºäºå¼€æºæ¨¡å‹æ¥è§£å†³é—®é¢˜çš„æ€è·¯å¹¶éæˆ‘çš„åŸåˆ›ï¼Œç½‘ä¸Šä¹Ÿæœ‰ä¸å°‘å…¶ä»–æœ‹å‹ç”¨ç±»ä¼¼çš„æ–¹å¼è§£å†³äº†è‡ªå·±çš„é—®é¢˜ã€‚æ¯”å¦‚<a href=\"https://mp.weixin.qq.com/s/iplUoK_JYeL_9EC7Ttt3tw\">ã€Šè®© LLM å›ç­”é—®é¢˜æ›´é è°±ã€‹è¿™ç¯‡æ–‡ç« </a>å°±ç»„åˆäº†ä¸‰ä¸ªæ¨¡å‹æ¥å®Œæˆäº†åŒ»å­¦é¢†åŸŸçš„è¯­ä¹‰æœç´¢ã€è¯­ä¹‰åŒ¹é…æ’åºï¼Œä»¥åŠæœ€ç»ˆçš„é—®ç­”è¯­å¥ç”Ÿæˆã€‚ä½ å¯ä»¥è¯»ä¸€ä¸‹ã€‚</p>","neighbors":{"left":{"article_title":"10ï½œAIè¿æ¥å¤–éƒ¨èµ„æ–™åº“ï¼Œè®©Llama Indexå¸¦ä½ é˜…è¯»ä¸€æœ¬ä¹¦","id":645305},"right":{"article_title":"12ï½œè®©AIå¸®ä½ å†™ä¸ªå°æ’ä»¶ï¼Œè½»æ¾å¤„ç†Excelæ–‡ä»¶","id":646801}},"comments":[{"had_liked":false,"id":373394,"user_name":"zhihai.tu","can_delete":false,"product_type":"c1","uid":1045888,"ip_address":"ä¸Šæµ·","ucode":"61371EA3EF6988","user_header":"https://static001.geekbang.org/account/avatar/00/0f/f5/80/baddf03b.jpg","comment_is_top":false,"comment_ctime":1682471310,"is_pvip":true,"replies":[{"id":136482,"content":"https:&#47;&#47;ayoolafelix.hashnode.dev&#47;how-to-permanently-install-a-module-on-google-colab-ckixqrvs40su044s187y274tc\n\nå¯ä»¥æŠŠå®‰è£…è·¯å¾„éƒ½è®¾ç½®åˆ° mountçš„google driveé‡Œï¼Œè¿™æ ·ä»¥åæ¯æ¬¡éƒ½åªéœ€è¦é…ç½®ä¸€ä¸‹è·¯å¾„ï¼Œä¸éœ€è¦å†é‡æ–°å®‰è£…äº†ã€‚","user_name":"ä½œè€…å›å¤","user_name_real":"ç¼–è¾‘","uid":1053568,"ctime":1683086482,"ip_address":"ä¸Šæµ·","comment_id":373394,"utype":1}],"discussion_count":1,"race_medal":0,"score":2,"product_id":100541001,"comment_content":"è€å¸ˆï¼Œæƒ³è¯·æ•™ä¸€ä¸‹ï¼Œæˆ‘å‘ç°æˆ‘ç”¨colabè·‘äº†ç¨‹åºï¼Œå¦‚æœç¬¬äºŒå¤©å†æ‰“å¼€è¿™ä¸ªç¨‹åºï¼Œç›¸åº”çš„å·²ç»è·‘è¿‡å¾—è„šæœ¬ï¼Œæ•ˆæœéƒ½å¤±æ•ˆäº†ï¼Œæ¯”å¦‚pipå®‰è£…è¿‡çš„éƒ½è¿˜åŸäº†ï¼Œå¦å¤–ç£ç›˜ç›®å½•ä¸Šç”Ÿæˆçš„æ–‡ä»¶å¤¹å’Œæ–‡ä»¶ä¹Ÿæ²¡äº†ã€‚æƒ³è¯·é—®ä¸‹å¦‚ä½•è§£å†³è¿™ä¸ªé—®é¢˜å‘¢ï¼Ÿä¸ç„¶ç›¸å½“çš„éº»çƒ¦ã€‚è°¢è°¢ã€‚","like_count":5,"discussions":[{"author":{"id":1053568,"avatar":"https://static001.geekbang.org/account/avatar/00/10/13/80/8de66543.jpg","nickname":"å¾æ–‡æµ©","note":"","ucode":"1D39AC564172E9","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":616718,"discussion_content":"https://ayoolafelix.hashnode.dev/how-to-permanently-install-a-module-on-google-colab-ckixqrvs40su044s187y274tc\n\nå¯ä»¥æŠŠå®‰è£…è·¯å¾„éƒ½è®¾ç½®åˆ° mountçš„google driveé‡Œï¼Œè¿™æ ·ä»¥åæ¯æ¬¡éƒ½åªéœ€è¦é…ç½®ä¸€ä¸‹è·¯å¾„ï¼Œä¸éœ€è¦å†é‡æ–°å®‰è£…äº†ã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1683086482,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"ä¸Šæµ·","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":372448,"user_name":"Toni","can_delete":false,"product_type":"c1","uid":3206957,"ip_address":"ç‘å£«","ucode":"E6B2FACCC1E000","user_header":"https://static001.geekbang.org/account/avatar/00/30/ef/2d/757bb0d3.jpg","comment_is_top":false,"comment_ctime":1681157365,"is_pvip":false,"replies":[{"id":135955,"content":"ğŸ‘","user_name":"ä½œè€…å›å¤","user_name_real":"ç¼–è¾‘","uid":1053568,"ctime":1681181911,"ip_address":"ä¸Šæµ·","comment_id":372448,"utype":1}],"discussion_count":1,"race_medal":0,"score":2,"product_id":100541001,"comment_content":"åœ¨ç¬¬äºŒè®²ä¸­ï¼Œç”¨äºšé©¬é€Šæä¾›çš„ç”¨æˆ·å¯¹ä¸€äº›é£Ÿç‰©è¯„ä»·çš„çœŸå®æ•°æ®é›†è¿›è¡Œäº†æƒ…æ„Ÿåˆ†æã€‚å½“æ—¶ä¸ºäº†é¿å…é‡æ–°è°ƒç”¨ OpenAI çš„ API æµªè´¹é’±ï¼Œè€å¸ˆæ¨èä½¿ç”¨å·²ç»è®¡ç®—å¥½çš„å«æœ‰ Embedding çš„æ•°æ®ã€‚ç”¨openai.embeddings_utils ä¸­çš„ get_embedding (EMBEDDING_MODEL = &quot;text-embedding-ada-002&quot;)ä¸ä»…è´¹é’±è¿˜è€—æ—¶ã€‚æˆ‘è¯•ç€è·‘è¿‡100ä¸ªæ•°æ®ï¼Œå¥½åƒç”¨äº†20åˆ†é’Ÿï¼ŒèŠ±è´¹ä¹Ÿä¸å°‘ã€‚\n\næœ¬èŠ‚è¯¾ä¸­è€å¸ˆä»‹ç»äº†å…è´¹çš„ sentence_transformers æ­£å¥½å¯ä»¥æ‹¿æ¥ç”¨åœ¨æƒ…æ„Ÿæ•°æ®åˆ†æä¸Šï¼Œ\né€‰ç”¨ model = SentenceTransformer(&#39;paraphrase-multilingual-mpnet-base-v2&#39;)ã€‚åŒæ ·è®¡ç®—1000ä¸ªæ•°æ®çš„ embeddingï¼Œé€Ÿåº¦å¾ˆå¿«ï¼Œä¸”æ— è´¹ç”¨ï¼Œé€‚åˆç»ƒæ‰‹ã€‚\n\næµ‹è¯•ç»“æœå¦‚ä¸‹:\n                     precision    recall  f1-score   support\n        negative      0.77      0.78      0.77       148\n         positive      0.96      0.95      0.96       773\n       accuracy                               0.93       921\n    macro avg       0.86      0.87      0.86       921\nweighted avg       0.93      0.93      0.93       921\n\nä¸ºäº†å¯¹æ¯”ï¼Œå°†ç¬¬äºŒè®²ä¸­è€å¸ˆç”¨ OpenAI çš„æ–¹æ³•å¾—åˆ°çš„ç»“æœæ”¾åœ¨äº†è¿™é‡Œ:\n\n                    precision    recall  f1-score   support\n        negative      0.98      0.73      0.84       136\n         positive      0.96      1.00      0.98       789\n       accuracy                               0.96       925\n    macro avg       0.97      0.86      0.91       925\nweighted avg       0.96      0.96      0.96       925\n\nä½¿ç”¨çš„æ–¹æ³•ä¸ç”¨ï¼Œç»“æœä¹Ÿä¸åŒã€‚OpenAI çš„å‡†ç¡®ç‡æ›´é«˜ã€‚","like_count":5,"discussions":[{"author":{"id":1053568,"avatar":"https://static001.geekbang.org/account/avatar/00/10/13/80/8de66543.jpg","nickname":"å¾æ–‡æµ©","note":"","ucode":"1D39AC564172E9","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":613194,"discussion_content":"ğŸ‘","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1681181911,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"ä¸Šæµ·","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":372236,"user_name":"ä¸œæ–¹å¥‡éª¥","can_delete":false,"product_type":"c1","uid":1354850,"ip_address":"å››å·","ucode":"DEE7085F7E55A4","user_header":"https://static001.geekbang.org/account/avatar/00/14/ac/62/37912d51.jpg","comment_is_top":false,"comment_ctime":1680863901,"is_pvip":false,"replies":[{"id":135860,"content":"æ˜¾å­˜éœ€è¦æ¯”è¾ƒå¤§ï¼Œå»ºè®®åœ¨colabä¸‹è¿è¡Œï¼Œæˆ‘ç»™äº†ä¸€ä¸ªå¯ä»¥åœ¨Colabä¸‹å•ç‹¬è¿è¡Œçš„Notebookã€‚\n\nhttps:&#47;&#47;github.com&#47;xuwenhao&#47;geektime-ai-course&#47;blob&#47;main&#47;11_colab_chatglm_opensource.ipynb","user_name":"ä½œè€…å›å¤","user_name_real":"ç¼–è¾‘","uid":1053568,"ctime":1680972376,"ip_address":"ä¸­å›½é¦™æ¸¯","comment_id":372236,"utype":1}],"discussion_count":3,"race_medal":0,"score":2,"product_id":100541001,"comment_content":"è€å¸ˆï¼Œæ˜¯ä¸æ˜¯è¦4080æ˜¾å¡æ‰è·‘å¾—åŠ¨ï¼Ÿå•æœºèƒ½è·‘å¾—åŠ¨å—","like_count":4,"discussions":[{"author":{"id":1053568,"avatar":"https://static001.geekbang.org/account/avatar/00/10/13/80/8de66543.jpg","nickname":"å¾æ–‡æµ©","note":"","ucode":"1D39AC564172E9","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":612855,"discussion_content":"æ˜¾å­˜éœ€è¦æ¯”è¾ƒå¤§ï¼Œå»ºè®®åœ¨colabä¸‹è¿è¡Œï¼Œæˆ‘ç»™äº†ä¸€ä¸ªå¯ä»¥åœ¨Colabä¸‹å•ç‹¬è¿è¡Œçš„Notebookã€‚\n\nhttps://github.com/xuwenhao/geektime-ai-course/blob/main/11_colab_chatglm_opensource.ipynb","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1680972376,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"ä¸­å›½é¦™æ¸¯","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":1,"child_discussions":[{"author":{"id":1049690,"avatar":"https://static001.geekbang.org/account/avatar/00/10/04/5a/abe070ba.jpg","nickname":"é˜¿ç™½","note":"","ucode":"382614F906D30A","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":1053568,"avatar":"https://static001.geekbang.org/account/avatar/00/10/13/80/8de66543.jpg","nickname":"å¾æ–‡æµ©","note":"","ucode":"1D39AC564172E9","race_medal":0,"user_type":2,"is_pvip":false},"discussion":{"id":623997,"discussion_content":"å¾è€å¸ˆèƒ½ä¸èƒ½æ ‡æ³¨ä¸‹å„ä¸ªä¾èµ–çš„ç‰ˆæœ¬ï¼Œè¿™ä¸ªNotebook å„ç§ä¾èµ–æŠ¥é”™ï¼Œç°åœ¨è·‘ä¸èµ·æ¥","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1690107803,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":612855,"ip_address":"ç«‹é™¶å®›","group_id":0},"score":623997,"extra":""}]},{"author":{"id":1941114,"avatar":"https://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTK84c6OjMQM8qCibsCVlytMgQsh1u9FN2CAyNwSLIEfwHN7psOCzt7Wyic0mMF7cR2H7avJyCicIl01w/132","nickname":"ZJSå¼ å®¶ä¹¦","note":"","ucode":"824D6B964DDEFA","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":624207,"discussion_content":"æŸ¥äº†ä¸€ä¸‹æ¨èæ˜¾å­˜\né‡åŒ–ç­‰çº§\tæœ€ä½ GPU æ˜¾å­˜\nFP16ï¼ˆæ— é‡åŒ–ï¼‰\t13 GB\nINT8\t10 GB\nINT4\t6 GB\n4080æœ‰16gï¼Œåº”è¯¥æ˜¯æ²¡é—®é¢˜çš„","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1690298024,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":"ä¸Šæµ·","group_id":0},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":373147,"user_name":"èƒ–å­","can_delete":false,"product_type":"c1","uid":2408754,"ip_address":"ä¸­å›½é¦™æ¸¯","ucode":"2C80824B0D9278","user_header":"https://static001.geekbang.org/account/avatar/00/24/c1/32/778f18b9.jpg","comment_is_top":false,"comment_ctime":1682137742,"is_pvip":true,"replies":[{"id":136513,"content":"æ„Ÿè§‰æ˜¯ protobuf ç‰ˆæœ¬çš„é—®é¢˜ï¼Œè¯•è¯•çœ‹æ›´æ–°ä¸€ä¸‹protobufç‰ˆæœ¬ï¼Ÿ\n\npip install --upgrade protobuf\n","user_name":"ä½œè€…å›å¤","user_name_real":"ç¼–è¾‘","uid":1053568,"ctime":1683091694,"ip_address":"ä¸Šæµ·","comment_id":373147,"utype":1}],"discussion_count":5,"race_medal":0,"score":2,"product_id":100541001,"comment_content":"AttributeError                            Traceback (most recent call last)\n&lt;ipython-input-54-086bfff09511&gt; in &lt;cell line: 8&gt;()\n      6 Q: ä½ ä»¬çš„é€€è´§æ”¿ç­–æ˜¯æ€ä¹ˆæ ·çš„ï¼Ÿ\n      7 &quot;&quot;&quot;\n----&gt; 8 response, history = model.chat(tokenizer, question, history=[])\n      9 print(response)\n\n21 frames\n&#47;usr&#47;local&#47;lib&#47;python3.9&#47;dist-packages&#47;google&#47;protobuf&#47;unknown_fields.py in &lt;module&gt;\n     42 from google.protobuf.internal import api_implementation\n     43 \n---&gt; 44 if api_implementation._c_module is not None:  # pylint: disable=protected-access\n     45   UnknownFieldSet = api_implementation._c_module.UnknownFieldSet  # pylint: disable=protected-access\n     46 else:\n\nAttributeError: module &#39;google.protobuf.internal.api_implementation&#39; has no attribute &#39;_c_module&#39;\n\n\næä¸å®š","like_count":2,"discussions":[{"author":{"id":1053568,"avatar":"https://static001.geekbang.org/account/avatar/00/10/13/80/8de66543.jpg","nickname":"å¾æ–‡æµ©","note":"","ucode":"1D39AC564172E9","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":616754,"discussion_content":"æ„Ÿè§‰æ˜¯ protobuf ç‰ˆæœ¬çš„é—®é¢˜ï¼Œè¯•è¯•çœ‹æ›´æ–°ä¸€ä¸‹protobufç‰ˆæœ¬ï¼Ÿ\n\npip install --upgrade protobuf\n","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1683091694,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"ä¸Šæµ·","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":2238528,"avatar":"https://static001.geekbang.org/account/avatar/00/22/28/40/82d748e6.jpg","nickname":"å°ç†æƒ³ã€‚","note":"","ucode":"EDC35A907570DB","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":625166,"discussion_content":"æˆ‘ä¹Ÿæ˜¯è¿™ä¸ªé”™ï¼Œæ›´æ–°ä¸å¥½ä½¿","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1691414652,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":"åŒ—äº¬","group_id":0},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1812201,"avatar":"https://wx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTLm8skz4F7FGGBTXWUMia6qVEc00BddeXapicv5FkAx62GmOnUNEcE4scSR60AmappQoNdIQhccKsBA/132","nickname":"æœ«æ—¥ï¼Œæˆæ¬¢","note":"","ucode":"BBAEBB9C93558A","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":615957,"discussion_content":"!pip install protobuf==4.21","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1682516092,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":"ç¾å›½","group_id":0},"score":2,"extra":"","child_discussion_number":1,"child_discussions":[{"author":{"id":2238528,"avatar":"https://static001.geekbang.org/account/avatar/00/22/28/40/82d748e6.jpg","nickname":"å°ç†æƒ³ã€‚","note":"","ucode":"EDC35A907570DB","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":1812201,"avatar":"https://wx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTLm8skz4F7FGGBTXWUMia6qVEc00BddeXapicv5FkAx62GmOnUNEcE4scSR60AmappQoNdIQhccKsBA/132","nickname":"æœ«æ—¥ï¼Œæˆæ¬¢","note":"","ucode":"BBAEBB9C93558A","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":625167,"discussion_content":"æ„Ÿè°¢ï¼Œå¯ä»¥äº†","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1691414740,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":615957,"ip_address":"åŒ—äº¬","group_id":0},"score":625167,"extra":""}]},{"author":{"id":1194643,"avatar":"https://static001.geekbang.org/account/avatar/00/12/3a/93/d7be8a1a.jpg","nickname":"æ™“å°ä¸œ","note":"","ucode":"93F9462EAAA63C","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":615700,"discussion_content":"ä¹Ÿæ˜¯è¿™ä¸ªé”™","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1682402317,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":"å¹¿ä¸œ","group_id":0},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":372213,"user_name":"å·æœˆ","can_delete":false,"product_type":"c1","uid":3579438,"ip_address":"å››å·","ucode":"CAB1218259CFC5","user_header":"https://static001.geekbang.org/account/avatar/00/36/9e/2e/e46ab171.jpg","comment_is_top":false,"comment_ctime":1680851066,"is_pvip":false,"replies":[{"id":135896,"content":"embeddingå¯ä»¥å­˜å‚¨åˆ°å‘é‡æ•°æ®åº“ï¼Œæ¯”å¦‚ pgvector, milvus, pinecone ç­‰ç­‰\nç´¢å¼•å¯ä»¥saveä¸‹æ¥å˜æˆjsonæ–‡ä»¶\n\næ›´è¯¦ç»†çš„æ‰‹å·¥ç®¡ç†ç´¢å¼•çš„æ–¹å¼ï¼Œå¯ä»¥çœ‹ä¸€ä¸‹ llama-index çš„å®˜æ–¹æ–‡æ¡£ https:&#47;&#47;gpt-index.readthedocs.io&#47;en&#47;latest&#47;\n","user_name":"ä½œè€…å›å¤","user_name_real":"ç¼–è¾‘","uid":1053568,"ctime":1680974839,"ip_address":"æ—¥æœ¬","comment_id":372213,"utype":1}],"discussion_count":2,"race_medal":0,"score":2,"product_id":100541001,"comment_content":"ä½¿ç”¨è¿™ä¸ªå¼€æºæ¨¡å‹è·å–çš„indexæ€ä¹ˆä¿å­˜å•Šï¼Œä½¿ç”¨ä¹‹å‰çš„æ–¹æ³•å¹¶ä¸è¡Œï¼Œè¿˜æœ‰ç”Ÿæˆçš„indexå¯ä»¥è¿½åŠ å—ï¼Œä¸ç„¶æ¯æ¬¡æœ‰æ–°æ•°æ®çš„æ—¶å€™éƒ½è¦é‡æ–°è·‘ä¸€è¾¹ï¼Œæˆ–è€…å¯ä»¥ä½¿ç”¨æ•°æ®åº“å­˜å‚¨å—ï¼Œå¸Œæœ›è€å¸ˆè®²è§£ä¸€ä¸‹","like_count":2,"discussions":[{"author":{"id":1053568,"avatar":"https://static001.geekbang.org/account/avatar/00/10/13/80/8de66543.jpg","nickname":"å¾æ–‡æµ©","note":"","ucode":"1D39AC564172E9","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":612892,"discussion_content":"embeddingå¯ä»¥å­˜å‚¨åˆ°å‘é‡æ•°æ®åº“ï¼Œæ¯”å¦‚ pgvector, milvus, pinecone ç­‰ç­‰\nç´¢å¼•å¯ä»¥saveä¸‹æ¥å˜æˆjsonæ–‡ä»¶\n\næ›´è¯¦ç»†çš„æ‰‹å·¥ç®¡ç†ç´¢å¼•çš„æ–¹å¼ï¼Œå¯ä»¥çœ‹ä¸€ä¸‹ llama-index çš„å®˜æ–¹æ–‡æ¡£ https://gpt-index.readthedocs.io/en/latest/\n","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1680974839,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"æ—¥æœ¬","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1018079,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/88/df/e7bf1bdb.jpg","nickname":"é“¶æ²³ç³»","note":"","ucode":"3BC7FFEDC9F94A","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":613162,"discussion_content":"æµ©å“¥ï¼Œfaissä¿å­˜ç„¶ååŠ è½½ä¸€ç›´æŠ¥é”™ï¼å› ä¸ºä½¿ç”¨è‡ªå®šä¹‰çš„llmå’Œembedingï¼Œå¯ä»¥ç»™ä¸ªä¾‹å­å‘¢ï¼Ÿ","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1681139408,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":"å¹¿ä¸œ","group_id":0},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":373915,"user_name":"à¼ºáƒ¦å¤©å£Â²ÂºÂ²Â²áƒ¦à¼»","can_delete":false,"product_type":"c1","uid":3009561,"ip_address":"ä¸Šæµ·","ucode":"8052C0A58FFB4C","user_header":"https://static001.geekbang.org/account/avatar/00/2d/ec/19/38511eaf.jpg","comment_is_top":false,"comment_ctime":1683341996,"is_pvip":false,"replies":[{"id":136840,"content":"https:&#47;&#47;github.com&#47;xuwenhao&#47;geektime-ai-course çš„ data ç›®å½•ä¸‹","user_name":"ä½œè€…å›å¤","user_name_real":"ç¼–è¾‘","uid":1053568,"ctime":1684746697,"ip_address":"ä¸Šæµ·","comment_id":373915,"utype":1}],"discussion_count":1,"race_medal":0,"score":2,"product_id":100541001,"comment_content":"è€å¸ˆï¼ŒFAQæ•°æ®åœ¨å“ªé‡Œï¼Ÿ","like_count":1,"discussions":[{"author":{"id":1053568,"avatar":"https://static001.geekbang.org/account/avatar/00/10/13/80/8de66543.jpg","nickname":"å¾æ–‡æµ©","note":"","ucode":"1D39AC564172E9","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":619014,"discussion_content":"https://github.com/xuwenhao/geektime-ai-course çš„ data ç›®å½•ä¸‹","likes_number":1,"is_delete":false,"is_hidden":false,"ctime":1684746697,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"ä¸Šæµ·","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":372100,"user_name":"å­Ÿå¥","can_delete":false,"product_type":"c1","uid":1373593,"ip_address":"å¹¿ä¸œ","ucode":"E20ECD1823E877","user_header":"https://static001.geekbang.org/account/avatar/00/14/f5/99/5bf198e3.jpg","comment_is_top":false,"comment_ctime":1680731433,"is_pvip":false,"replies":[{"id":135890,"content":"ç›®å‰ llama æ²¡æœ‰å…¬å¼€æ¸ é“å¯ä»¥ç›´æ¥è·å¾—æ¨¡å‹ï¼Œæ‰€ä»¥ä¸é€‚åˆä½œä¸ºè¯¾ç¨‹çš„ä¸€éƒ¨åˆ†\nç›®å‰ä»æœ‰é™ä½“éªŒæ¥çœ‹ï¼Œè£å‰ªåˆ°å•æœºå¯ä»¥åŠ è½½çš„æƒ…å†µä¸‹ï¼Œæ²¡æœ‰è§‰å¾—åœ¨ä¸­æ–‡ä¸Šæ¯” ChatGLM å¥½","user_name":"ä½œè€…å›å¤","user_name_real":"ç¼–è¾‘","uid":1053568,"ctime":1680974543,"ip_address":"æ—¥æœ¬","comment_id":372100,"utype":1}],"discussion_count":1,"race_medal":0,"score":2,"product_id":100541001,"comment_content":"Metaæœ€è¿‘ä¹Ÿå¼€æºäº†å¤§è¯­è¨€æ¨¡å‹ï¼Œå¥½åƒæ›´å¥½ä¸€äº›ï¼Ÿ","like_count":1,"discussions":[{"author":{"id":1053568,"avatar":"https://static001.geekbang.org/account/avatar/00/10/13/80/8de66543.jpg","nickname":"å¾æ–‡æµ©","note":"","ucode":"1D39AC564172E9","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":612886,"discussion_content":"ç›®å‰ llama æ²¡æœ‰å…¬å¼€æ¸ é“å¯ä»¥ç›´æ¥è·å¾—æ¨¡å‹ï¼Œæ‰€ä»¥ä¸é€‚åˆä½œä¸ºè¯¾ç¨‹çš„ä¸€éƒ¨åˆ†\nç›®å‰ä»æœ‰é™ä½“éªŒæ¥çœ‹ï¼Œè£å‰ªåˆ°å•æœºå¯ä»¥åŠ è½½çš„æƒ…å†µä¸‹ï¼Œæ²¡æœ‰è§‰å¾—åœ¨ä¸­æ–‡ä¸Šæ¯” ChatGLM å¥½","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1680974543,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"æ—¥æœ¬","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":374769,"user_name":"åœ°å¹³çº¿","can_delete":false,"product_type":"c1","uid":1482026,"ip_address":"ç¾å›½","ucode":"F50717D6244867","user_header":"https://static001.geekbang.org/account/avatar/00/16/9d/2a/3e57b54a.jpg","comment_is_top":false,"comment_ctime":1684402593,"is_pvip":false,"replies":[{"id":136788,"content":"llama index æœ€è¿‘åˆæ›´æ–°äº†å¤§ç‰ˆæœ¬ï¼Œæ¥å£åˆæ”¹äº†ä¸€éã€‚å¦‚æœè¦ç«‹åˆ»å¯ä»¥è¿è¡Œï¼Œå¯ä»¥å…ˆ pip install --force-reinstall -v &quot;llama-index==0.5.27&quot; é€€å›åˆ° 0.5 ç³»åˆ—çš„ç‰ˆæœ¬\n\næ™šç‚¹æˆ‘çœ‹ä¸€ä¸‹æ›´æ–°ä»£ç åˆ°0.6.x ç‰ˆæœ¬","user_name":"ä½œè€…å›å¤","user_name_real":"ç¼–è¾‘","uid":1053568,"ctime":1684720467,"ip_address":"æ–°åŠ å¡","comment_id":374769,"utype":1}],"discussion_count":2,"race_medal":0,"score":2,"product_id":100541001,"comment_content":"ç”±äºllama-index å‡çº§ï¼Œæˆ‘ä½¿ç”¨çš„ç‰ˆæœ¬æ˜¯0.6.8ï¼Œä¿®æ”¹äº†llama-indexä»£ç ï¼Œç¨‹åºè¿è¡Œæ²¡æœ‰æŠ¥é”™ï¼Œä½†æ˜¯æ²¡æœ‰è¾“å‡ºå†…å®¹\n\nfrom langchain.text_splitter import SpacyTextSplitter\n\nllm_predictor = LLMPredictor(llm=CustomLLM())\n\ntext_splitter = CharacterTextSplitter(separator=&quot;\\n\\n&quot;, chunk_size=100, chunk_overlap=20)\nparser = SimpleNodeParser(text_splitter=text_splitter)\ndocuments = SimpleDirectoryReader(&#39;.&#47;drive&#47;MyDrive&#47;colab_data&#47;faq&#47;&#39;).load_data()\nnodes = parser.get_nodes_from_documents(documents)\n\nembed_model = LangchainEmbedding(HuggingFaceEmbeddings(\n    model_name=&quot;sentence-transformers&#47;paraphrase-multilingual-mpnet-base-v2&quot;\n))\nservice_context = ServiceContext.from_defaults(embed_model=embed_model, llm_predictor=llm_predictor)\n\ndimension = 768\nfaiss_index = faiss.IndexFlatIP(dimension)\n\n# index = GPTListIndex(nodes=nodes, faiss_index=faiss_index, service_context=service_context)\nindex = GPTListIndex(nodes=nodes, service_context=service_context)\n\nfrom llama_index import QuestionAnswerPrompt\n\nQA_PROMPT_TMPL = (\n    &quot;{context_str}&quot;\n    &quot;\\n\\n&quot;\n    &quot;æ ¹æ®ä»¥ä¸Šä¿¡æ¯ï¼Œè¯·å›ç­”ä¸‹é¢çš„é—®é¢˜ï¼š\\n&quot;\n    &quot;Q: {query_str}\\n&quot;\n    )\nQA_PROMPT = QuestionAnswerPrompt(QA_PROMPT_TMPL)\n\nquery_engine = index.as_query_engine(\n    retriever_mode=&quot;embedding&quot;, \n    verbose=True, \n    text_qa_template=QA_PROMPT,\n)\nresponse = query_engine.query(&quot;è¯·é—®ä½ ä»¬æµ·å—èƒ½å‘è´§å—ï¼Ÿ&quot;)\nprint(response)","like_count":0,"discussions":[{"author":{"id":1053568,"avatar":"https://static001.geekbang.org/account/avatar/00/10/13/80/8de66543.jpg","nickname":"å¾æ–‡æµ©","note":"","ucode":"1D39AC564172E9","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":618920,"discussion_content":"llama index æœ€è¿‘åˆæ›´æ–°äº†å¤§ç‰ˆæœ¬ï¼Œæ¥å£åˆæ”¹äº†ä¸€éã€‚å¦‚æœè¦ç«‹åˆ»å¯ä»¥è¿è¡Œï¼Œå¯ä»¥å…ˆ pip install --force-reinstall -v &#34;llama-index==0.5.27&#34; é€€å›åˆ° 0.5 ç³»åˆ—çš„ç‰ˆæœ¬\n\næ™šç‚¹æˆ‘çœ‹ä¸€ä¸‹æ›´æ–°ä»£ç åˆ°0.6.x ç‰ˆæœ¬","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1684720467,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"æ–°åŠ å¡","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":2559238,"avatar":"https://static001.geekbang.org/account/avatar/00/27/0d/06/970cc957.jpg","nickname":"Charles","note":"","ucode":"8ACBA423B5A505","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":621807,"discussion_content":"è€å¸ˆï¼Œllama-index 0.6ç‰ˆæœ¬æ€ä¹ˆå†™å‘¢","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1687664671,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":"ä¸Šæµ·","group_id":0},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":374729,"user_name":"èŒ¶æ¡","can_delete":false,"product_type":"c1","uid":2254242,"ip_address":"ä¸Šæµ·","ucode":"3EC3D9C6BF9091","user_header":"https://static001.geekbang.org/account/avatar/00/22/65/a2/88aca8f7.jpg","comment_is_top":false,"comment_ctime":1684370980,"is_pvip":false,"replies":[{"id":136793,"content":"llama index æœ€è¿‘åˆæ›´æ–°äº†å¤§ç‰ˆæœ¬ï¼Œæ¥å£åˆæ”¹äº†ä¸€éã€‚å¦‚æœè¦ç«‹åˆ»å¯ä»¥è¿è¡Œï¼Œå¯ä»¥å…ˆ pip install --force-reinstall -v &quot;llama-index==0.5.27&quot; é€€å›åˆ° 0.5 ç³»åˆ—çš„ç‰ˆæœ¬\n\næ™šç‚¹æˆ‘çœ‹ä¸€ä¸‹æ›´æ–°ä»£ç åˆ°0.6.x ç‰ˆæœ¬","user_name":"ä½œè€…å›å¤","user_name_real":"ç¼–è¾‘","uid":1053568,"ctime":1684720693,"ip_address":"æ–°åŠ å¡","comment_id":374729,"utype":1}],"discussion_count":1,"race_medal":0,"score":2,"product_id":100541001,"comment_content":"è€å¸ˆï¼Œâ€œGPTFaissIndexâ€è¿™ä¸ªæ–¹æ³•ä¼¼ä¹æ²¡æœ‰äº†ï¼Œæ›¿æ¢çš„å…¶ä»–æ–¹æ³•ä¸çŸ¥é“æ˜¯ä»€ä¹ˆï¼Œæ€ä¹ˆç”¨ã€‚","like_count":0,"discussions":[{"author":{"id":1053568,"avatar":"https://static001.geekbang.org/account/avatar/00/10/13/80/8de66543.jpg","nickname":"å¾æ–‡æµ©","note":"","ucode":"1D39AC564172E9","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":618925,"discussion_content":"llama index æœ€è¿‘åˆæ›´æ–°äº†å¤§ç‰ˆæœ¬ï¼Œæ¥å£åˆæ”¹äº†ä¸€éã€‚å¦‚æœè¦ç«‹åˆ»å¯ä»¥è¿è¡Œï¼Œå¯ä»¥å…ˆ pip install --force-reinstall -v &#34;llama-index==0.5.27&#34; é€€å›åˆ° 0.5 ç³»åˆ—çš„ç‰ˆæœ¬\n\næ™šç‚¹æˆ‘çœ‹ä¸€ä¸‹æ›´æ–°ä»£ç åˆ°0.6.x ç‰ˆæœ¬","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1684720693,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"æ–°åŠ å¡","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":374415,"user_name":"horn","can_delete":false,"product_type":"c1","uid":3621427,"ip_address":"åŒ—äº¬","ucode":"3EB5C0EAC060A4","user_header":"https://static001.geekbang.org/account/avatar/00/37/42/33/13b19797.jpg","comment_is_top":false,"comment_ctime":1684120268,"is_pvip":false,"replies":[{"id":136806,"content":"llama index æœ€è¿‘åˆæ›´æ–°äº†å¤§ç‰ˆæœ¬ï¼Œæ¥å£åˆæ”¹äº†ä¸€éã€‚å¦‚æœè¦ç«‹åˆ»å¯ä»¥è¿è¡Œï¼Œå¯ä»¥å…ˆ pip install --force-reinstall -v &quot;llama-index==0.5.27&quot; é€€å›åˆ° 0.5 ç³»åˆ—çš„ç‰ˆæœ¬\n\næ™šç‚¹æˆ‘çœ‹ä¸€ä¸‹æ›´æ–°ä»£ç åˆ°0.6.x ç‰ˆæœ¬","user_name":"ä½œè€…å›å¤","user_name_real":"ç¼–è¾‘","uid":1053568,"ctime":1684725367,"ip_address":"æ–°åŠ å¡","comment_id":374415,"utype":1}],"discussion_count":1,"race_medal":0,"score":2,"product_id":100541001,"comment_content":"ColabæŠ¥é”™æ€ä¹ˆå›äº‹å‘¢\nImportError: cannot import name &#39;GPTFaissIndex&#39; from &#39;llama_index&#39; (&#47;usr&#47;local&#47;lib&#47;python3.10&#47;dist-packages&#47;llama_index&#47;__init__.py)","like_count":0,"discussions":[{"author":{"id":1053568,"avatar":"https://static001.geekbang.org/account/avatar/00/10/13/80/8de66543.jpg","nickname":"å¾æ–‡æµ©","note":"","ucode":"1D39AC564172E9","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":618951,"discussion_content":"llama index æœ€è¿‘åˆæ›´æ–°äº†å¤§ç‰ˆæœ¬ï¼Œæ¥å£åˆæ”¹äº†ä¸€éã€‚å¦‚æœè¦ç«‹åˆ»å¯ä»¥è¿è¡Œï¼Œå¯ä»¥å…ˆ pip install --force-reinstall -v &#34;llama-index==0.5.27&#34; é€€å›åˆ° 0.5 ç³»åˆ—çš„ç‰ˆæœ¬\n\næ™šç‚¹æˆ‘çœ‹ä¸€ä¸‹æ›´æ–°ä»£ç åˆ°0.6.x ç‰ˆæœ¬","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1684725367,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"æ–°åŠ å¡","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":374250,"user_name":"haha","can_delete":false,"product_type":"c1","uid":1041547,"ip_address":"å¹¿ä¸œ","ucode":"F4F3EAB4A15989","user_header":"https://static001.geekbang.org/account/avatar/00/0f/e4/8b/8a0a6c86.jpg","comment_is_top":false,"comment_ctime":1683783883,"is_pvip":false,"replies":[{"id":136814,"content":"PaLM2æ²¡æœ‰å¼€æºï¼Œåªèƒ½è°ƒç”¨Googleçš„APIå‘€ï¼Œè¿™æ ·å’ŒOpenAIå¯¹æ¯”å°±æ˜¾å¾—æ²¡å•¥ä¼˜åŠ¿ã€‚","user_name":"ä½œè€…å›å¤","user_name_real":"ç¼–è¾‘","uid":1053568,"ctime":1684726406,"ip_address":"æ–°åŠ å¡","comment_id":374250,"utype":1}],"discussion_count":1,"race_medal":0,"score":3,"product_id":100541001,"comment_content":"PaLM2å‘¢ï¼Œä»Šå¤©è¢«å…¬ä¼—å·åˆ·å±äº†","like_count":0,"discussions":[{"author":{"id":1053568,"avatar":"https://static001.geekbang.org/account/avatar/00/10/13/80/8de66543.jpg","nickname":"å¾æ–‡æµ©","note":"","ucode":"1D39AC564172E9","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":618960,"discussion_content":"PaLM2æ²¡æœ‰å¼€æºï¼Œåªèƒ½è°ƒç”¨Googleçš„APIå‘€ï¼Œè¿™æ ·å’ŒOpenAIå¯¹æ¯”å°±æ˜¾å¾—æ²¡å•¥ä¼˜åŠ¿ã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1684726406,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"æ–°åŠ å¡","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":374213,"user_name":"Geek_9znsx3","can_delete":false,"product_type":"c1","uid":2005535,"ip_address":"å¹¿ä¸œ","ucode":"BBCD62B306BF23","user_header":"","comment_is_top":false,"comment_ctime":1683712718,"is_pvip":true,"replies":[{"id":136875,"content":"åº”è¯¥æ˜¯ä¸éœ€è¦ä¾èµ–tensorflowçš„å‘€ï¼Ÿä½ æ‰¾ä¸€ä¸ªä½ä¸€ç‚¹ç‰ˆæœ¬çš„tensorflowèƒ½å¤Ÿå…¼å®¹ protobuf-3.18 çš„è¯•è¯•ï¼Ÿ","user_name":"ä½œè€…å›å¤","user_name_real":"ç¼–è¾‘","uid":1053568,"ctime":1684754051,"ip_address":"ä¸Šæµ·","comment_id":374213,"utype":1}],"discussion_count":1,"race_medal":0,"score":3,"product_id":100541001,"comment_content":"åœ¨colabè¿è¡Œ11_colab_chatglm_opensource.ipynbï¼Œå®‰è£…pythonåŒ…æ—¶æŠ¥é”™ï¼ŒprotobufåŒ…ç‰ˆæœ¬å†²çªï¼Œè¯·é—®è¿™ä¸ªæ€ä¹ˆè§£å†³ï¼Ÿä»æŠ¥é”™ä¿¡æ¯çœ‹æ˜¯ç”±äºtensorflow-2.12.0ä¾èµ–protobuf3.20.3ï¼Œä½†æ˜¯icetk-0.0.7ä¾èµ– protobuf-3.18.3\nInstalling collected packages: protobuf, icetk\n  Attempting uninstall: protobuf\n    Found existing installation: protobuf 3.20.3\n    Uninstalling protobuf-3.20.3:\n      Successfully uninstalled protobuf-3.20.3\nERROR: pip&#39;s dependency resolver does not currently take into account all the packages that are installed. This behaviour is the source of the following dependency conflicts.\n........\ntensorflow 2.12.0 requires protobuf!=4.21.0,!=4.21.1,!=4.21.2,!=4.21.3,!=4.21.4,!=4.21.5,&lt;5.0.0dev,&gt;=3.20.3, but you have protobuf 3.18.3 which is incompatible.\ntensorflow-datasets 4.9.2 requires protobuf&gt;=3.20, but you have protobuf 3.18.3 which is incompatible.\ntensorflow-hub 0.13.0 requires protobuf&gt;=3.19.6, but you have protobuf 3.18.3 which is incompatible.\ntensorflow-metadata 1.13.1 requires protobuf&lt;5,&gt;=3.20.3, but you have protobuf 3.18.3 which is incompatible.\nSuccessfully installed icetk-0.0.7 protobuf-3.18.3","like_count":0,"discussions":[{"author":{"id":1053568,"avatar":"https://static001.geekbang.org/account/avatar/00/10/13/80/8de66543.jpg","nickname":"å¾æ–‡æµ©","note":"","ucode":"1D39AC564172E9","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":619064,"discussion_content":"åº”è¯¥æ˜¯ä¸éœ€è¦ä¾èµ–tensorflowçš„å‘€ï¼Ÿä½ æ‰¾ä¸€ä¸ªä½ä¸€ç‚¹ç‰ˆæœ¬çš„tensorflowèƒ½å¤Ÿå…¼å®¹ protobuf-3.18 çš„è¯•è¯•ï¼Ÿ","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1684754051,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"ä¸Šæµ·","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":373887,"user_name":"ææ–‡é¾™","can_delete":false,"product_type":"c1","uid":1006210,"ip_address":"åŒ—äº¬","ucode":"F809A671D72D2E","user_header":"https://static001.geekbang.org/account/avatar/00/0f/5a/82/4d55f0b7.jpg","comment_is_top":false,"comment_ctime":1683290450,"is_pvip":false,"replies":[{"id":136827,"content":"llama index æœ€è¿‘åˆæ›´æ–°äº†å¤§ç‰ˆæœ¬ï¼Œæ¥å£åˆæ”¹äº†ä¸€éã€‚å¦‚æœè¦ç«‹åˆ»å¯ä»¥è¿è¡Œï¼Œå¯ä»¥å…ˆ pip install --force-reinstall -v &quot;llama-index==0.5.27&quot; é€€å›åˆ° 0.5 ç³»åˆ—çš„ç‰ˆæœ¬\n\næ™šç‚¹æˆ‘çœ‹ä¸€ä¸‹æ›´æ–°ä»£ç åˆ°0.6.x ç‰ˆæœ¬","user_name":"ä½œè€…å›å¤","user_name_real":"ç¼–è¾‘","uid":1053568,"ctime":1684741733,"ip_address":"ä¸Šæµ·","comment_id":373887,"utype":1}],"discussion_count":3,"race_medal":0,"score":3,"product_id":100541001,"comment_content":"è¯·é—®ä½¿ç”¨ llama_index 0.6.1 ç‰ˆæœ¬ï¼Œä½¿ç”¨ Faissï¼Œä»£ç å¦‚ä¸‹ï¼Œæœ‰æŠ¥é”™ã€‚\nimport faiss\nfrom llama_index.vector_stores import FaissVectorStore\nfrom llama_index import GPTVectorStoreIndex, StorageContext\n\ndimension = 768\nfaiss_index = faiss.IndexFlatIP(dimension)\nstorage_context = StorageContext.from_defaults(\n    vector_store=FaissVectorStore(faiss_index)\n)\nprint(len(nodes))\nindex = GPTVectorStoreIndex(nodes, storage_context=storage_context)\n\nquery_engine = index.as_query_engine(\n    retriever_mode=&quot;embedding&quot;,\n    verbose=True,\n    service_context = service_context,\n)\n\næŠ¥é”™ï¼š\n&#47;usr&#47;local&#47;lib&#47;python3.10&#47;dist-packages&#47;faiss&#47;__init__.py in replacement_add(self, x)\n    212 \n    213         n, d = x.shape\n--&gt; 214         assert d == self.d\n    215         self.add_c(n, swig_ptr(x))\n    216 ","like_count":0,"discussions":[{"author":{"id":1053568,"avatar":"https://static001.geekbang.org/account/avatar/00/10/13/80/8de66543.jpg","nickname":"å¾æ–‡æµ©","note":"","ucode":"1D39AC564172E9","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":618994,"discussion_content":"llama index æœ€è¿‘åˆæ›´æ–°äº†å¤§ç‰ˆæœ¬ï¼Œæ¥å£åˆæ”¹äº†ä¸€éã€‚å¦‚æœè¦ç«‹åˆ»å¯ä»¥è¿è¡Œï¼Œå¯ä»¥å…ˆ pip install --force-reinstall -v &#34;llama-index==0.5.27&#34; é€€å›åˆ° 0.5 ç³»åˆ—çš„ç‰ˆæœ¬\n\næ™šç‚¹æˆ‘çœ‹ä¸€ä¸‹æ›´æ–°ä»£ç åˆ°0.6.x ç‰ˆæœ¬","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1684741733,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"ä¸Šæµ·","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":2559238,"avatar":"https://static001.geekbang.org/account/avatar/00/27/0d/06/970cc957.jpg","nickname":"Charles","note":"","ucode":"8ACBA423B5A505","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":621806,"discussion_content":"åŒé—®0.6ç‰ˆæœ¬çš„ä»£ç æ€ä¹ˆå†™","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1687664567,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":"ä¸Šæµ·","group_id":0},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":3619482,"avatar":"https://static001.geekbang.org/account/avatar/00/37/3a/9a/58a5ebfa.jpg","nickname":"å¦‚ä»Šæ— å¿ƒå¿ƒè‡ªå®½","note":"","ucode":"9CFBC78A3EEB12","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":619267,"discussion_content":"è¯·é—®è§£å†³äº†å—","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1684919732,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":"ä¸­å›½é¦™æ¸¯","group_id":0},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":373084,"user_name":"Santiago","can_delete":false,"product_type":"c1","uid":3572315,"ip_address":"å±±è¥¿","ucode":"E7301F6A5076DC","user_header":"https://static001.geekbang.org/account/avatar/00/36/82/5b/df97e03c.jpg","comment_is_top":false,"comment_ctime":1682002042,"is_pvip":false,"replies":[{"id":136493,"content":"ChatGLM 6Gä¸å¤ªå¤Ÿï¼ŒColabæŠ¥é”™å…·ä½“æ˜¯åœ¨å“ªä¸€è¡Œä»£ç æŠ¥é”™ï¼Ÿ","user_name":"ä½œè€…å›å¤","user_name_real":"ç¼–è¾‘","uid":1053568,"ctime":1683087329,"ip_address":"ä¸Šæµ·","comment_id":373084,"utype":1}],"discussion_count":4,"race_medal":0,"score":3,"product_id":100541001,"comment_content":"è€å¸ˆæˆ‘æƒ³é—®ä¸€ä¸‹ æˆ‘ç”¨colabæŠ¥é”™ \nKeyError: &#39;-1&#39;\nè¿™æ˜¯å’‹å›äº‹å‘€ï¼Œè¿˜æœ‰å°±æ˜¯æˆ‘ç”¨3060çš„æ˜¾å¡6Gï¼Œç›´æ¥çˆ†æ˜¾å­˜äº†","like_count":0,"discussions":[{"author":{"id":1053568,"avatar":"https://static001.geekbang.org/account/avatar/00/10/13/80/8de66543.jpg","nickname":"å¾æ–‡æµ©","note":"","ucode":"1D39AC564172E9","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":616730,"discussion_content":"ChatGLM 6Gä¸å¤ªå¤Ÿï¼ŒColabæŠ¥é”™å…·ä½“æ˜¯åœ¨å“ªä¸€è¡Œä»£ç æŠ¥é”™ï¼Ÿ","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1683087329,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"ä¸Šæµ·","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1029016,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/b3/98/2ad8b465.jpg","nickname":"Hugh","note":"","ucode":"126A56632CB09A","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":621695,"discussion_content":"è¿™ä¸ªé”™è¯¯åº”è¯¥æ˜¯æ–‡æœ¬æ•°æ®æ²¡æœ‰åŠ è½½åˆ°","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1687510122,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":"ä¸Šæµ·","group_id":0},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1707839,"avatar":"https://static001.geekbang.org/account/avatar/00/1a/0f/3f/8b96cd8a.jpg","nickname":"åŒ…å­å…ˆç”Ÿ","note":"","ucode":"4332DB98492EE2","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":621120,"discussion_content":"llama_index/indices/vector_store/base_query.py&#34;, line 86,node_ids = [self._index_struct.nodes_dict[idx] for idx in query_result.ids]\nKeyError: &#39;-1&#39;","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1686830061,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":"å¹¿ä¸œ","group_id":0},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1707839,"avatar":"https://static001.geekbang.org/account/avatar/00/1a/0f/3f/8b96cd8a.jpg","nickname":"åŒ…å­å…ˆç”Ÿ","note":"","ucode":"4332DB98492EE2","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":621119,"discussion_content":"æˆ‘ä¹Ÿé‡åˆ°åŒæ ·çš„æŠ¥é”™KeyError  ","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1686830049,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":"å¹¿ä¸œ","group_id":0},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":372985,"user_name":"Santiago","can_delete":false,"product_type":"c1","uid":3572315,"ip_address":"å±±è¥¿","ucode":"E7301F6A5076DC","user_header":"https://static001.geekbang.org/account/avatar/00/36/82/5b/df97e03c.jpg","comment_is_top":false,"comment_ctime":1681892230,"is_pvip":false,"replies":[{"id":136472,"content":"è¯•ç€pipé‡æ–°å®‰è£…ä¸€ä¸‹pillow\n\npip install -U pillow","user_name":"ä½œè€…å›å¤","user_name_real":"ç¼–è¾‘","uid":1053568,"ctime":1683085215,"ip_address":"ä¸Šæµ·","comment_id":372985,"utype":1}],"discussion_count":1,"race_medal":0,"score":3,"product_id":100541001,"comment_content":"RuntimeError: Failed to import transformers.models.t5.configuration_t5 because of the following error (look up to see its traceback):\nFailed to import transformers.onnx.config because of the following error (look up to see its traceback):\nDLL load failed while importing _imaging: æ‰¾ä¸åˆ°æŒ‡å®šçš„æ¨¡å—ã€‚","like_count":0,"discussions":[{"author":{"id":1053568,"avatar":"https://static001.geekbang.org/account/avatar/00/10/13/80/8de66543.jpg","nickname":"å¾æ–‡æµ©","note":"","ucode":"1D39AC564172E9","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":616702,"discussion_content":"è¯•ç€pipé‡æ–°å®‰è£…ä¸€ä¸‹pillow\n\npip install -U pillow","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1683085215,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"ä¸Šæµ·","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":372929,"user_name":"è‰¯è¾°ç¾æ™¯","can_delete":false,"product_type":"c1","uid":1074803,"ip_address":"ä¸Šæµ·","ucode":"B36E6955A2872D","user_header":"https://static001.geekbang.org/account/avatar/00/10/66/73/fd1e37a2.jpg","comment_is_top":false,"comment_ctime":1681808578,"is_pvip":false,"replies":[{"id":136466,"content":"1. äº‘å¹³å°å¯ä»¥ç›´æ¥è´­ä¹°å®‰è£…äº†GPUçš„æœåŠ¡å™¨\n2. å•æœºå¤šå¡çš„æƒ…å†µä¸‹ï¼Œä¸€å°æœºå™¨å¯ä»¥å¤šå—GPUã€‚å¹¶ä¸”NVLinkå¯ä»¥æŠŠ8å—å¡ä¸²è”åˆ°ä¸€èµ·\n3. è°ƒåº¦é—®é¢˜ï¼Œæœ‰kubeflowè¿™æ ·çš„æ–¹æ¡ˆé€šè¿‡ kubernetes\n\nMLOpsç‰¹åˆ«æ˜¯å¤§æ¨¡å‹é¢†åŸŸè¿˜æ˜¯ä¸€ä¸ªæ¯”è¾ƒæ–°çš„æ–¹å‘ï¼Œä¸šç•Œæœ‰å„ç§è§£å†³æ–¹æ¡ˆï¼Œä½†æ˜¯ç›®å‰è¿˜è°ˆä¸ä¸Šå½¢æˆæ ‡å‡†ã€‚","user_name":"ä½œè€…å›å¤","user_name_real":"ç¼–è¾‘","uid":1053568,"ctime":1683084054,"ip_address":"ä¸Šæµ·","comment_id":372929,"utype":1}],"discussion_count":1,"race_medal":0,"score":3,"product_id":100541001,"comment_content":"è€å¸ˆï¼Œ é—®ä¸€ä¸ªå·¥ç¨‹ä¸Šçš„é—®é¢˜ï¼Œ åƒè¿™ç§è¦æ±‚å¤§é‡è®¡ç®—èµ„æºAIç³»ç»Ÿï¼Œ åœ¨å·¥ç¨‹ä¸Šå¦‚ä½•èƒ½åšåˆ°å¯ç”¨å‘¢ï¼Œ éœ€è¦è´­ä¹°å¤§é‡çš„GPUè¿™ä¸ªå¯ä»¥æƒ³åˆ°ã€‚ è´­ä¹°çš„è¿™äº›èŠ¯ç‰‡å¦‚ä½•èƒ½å¤Ÿä¸²è”å½¢æˆç±»ä¼¼â€œäº‘â€çš„èƒ½åŠ›ï¼Ÿ è¿™ä¸ªæ˜¯å„ä¸ªå…¬å¸éœ€è¦æœ‰è‡ªå·±çš„è§£å†³æ–¹æ¡ˆè¿˜æ˜¯ä¸šç•Œå·²ç»æœ‰æˆç†Ÿçš„è§£å†³æ–¹æ¡ˆäº†ï¼Ÿ ","like_count":0,"discussions":[{"author":{"id":1053568,"avatar":"https://static001.geekbang.org/account/avatar/00/10/13/80/8de66543.jpg","nickname":"å¾æ–‡æµ©","note":"","ucode":"1D39AC564172E9","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":616692,"discussion_content":"1. äº‘å¹³å°å¯ä»¥ç›´æ¥è´­ä¹°å®‰è£…äº†GPUçš„æœåŠ¡å™¨\n2. å•æœºå¤šå¡çš„æƒ…å†µä¸‹ï¼Œä¸€å°æœºå™¨å¯ä»¥å¤šå—GPUã€‚å¹¶ä¸”NVLinkå¯ä»¥æŠŠ8å—å¡ä¸²è”åˆ°ä¸€èµ·\n3. è°ƒåº¦é—®é¢˜ï¼Œæœ‰kubeflowè¿™æ ·çš„æ–¹æ¡ˆé€šè¿‡ kubernetes\n\nMLOpsç‰¹åˆ«æ˜¯å¤§æ¨¡å‹é¢†åŸŸè¿˜æ˜¯ä¸€ä¸ªæ¯”è¾ƒæ–°çš„æ–¹å‘ï¼Œä¸šç•Œæœ‰å„ç§è§£å†³æ–¹æ¡ˆï¼Œä½†æ˜¯ç›®å‰è¿˜è°ˆä¸ä¸Šå½¢æˆæ ‡å‡†ã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1683084054,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"ä¸Šæµ·","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":372850,"user_name":"Geek_3d7708","can_delete":false,"product_type":"c1","uid":2601970,"ip_address":"ä¸­å›½é¦™æ¸¯","ucode":"9F707F39739109","user_header":"https://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTISHN4HwTsOicDUzB1jyzlxzriaI3S7tAfoPzicSfuTbxLxRjkCic2eBwRWxJTrwTpiaYP8Hg8vqWgNE2w/132","comment_is_top":false,"comment_ctime":1681721792,"is_pvip":false,"replies":[{"id":136251,"content":"https:&#47;&#47;github.com&#47;jerryjliu&#47;llama_index&#47;blob&#47;main&#47;examples&#47;vector_indices&#47;FaissIndexDemo.ipynb\n\nè°ƒç”¨ index çš„ save_to_disk æ–¹æ³•å°±å¯ä»¥äº†å‘€\n","user_name":"ä½œè€…å›å¤","user_name_real":"ç¼–è¾‘","uid":1053568,"ctime":1681794027,"ip_address":"ä¸Šæµ·","comment_id":372850,"utype":1}],"discussion_count":1,"race_medal":0,"score":3,"product_id":100541001,"comment_content":"dimension = 768faiss_index = faiss.IndexFlatIP(dimension)index = index=GPTFaissIndex(nodes=nodes,faiss_index=faiss_index, service_context=service_context)\n\nè¿™ä¸ª index  ç»“æœæ€ä¹ˆä¿å­˜ï¼Ÿ æˆ‘æŠ˜è…¾2å¤©äº†éƒ½ä¸è¡Œï¼Œæ²¡æœ‰saveï¼Œæ²¡index , è€å¸ˆèƒ½å‘Šè¯‰æˆ‘æ€ä¹ˆä¿å­˜å—ï¼Ÿ","like_count":0,"discussions":[{"author":{"id":1053568,"avatar":"https://static001.geekbang.org/account/avatar/00/10/13/80/8de66543.jpg","nickname":"å¾æ–‡æµ©","note":"","ucode":"1D39AC564172E9","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":614453,"discussion_content":"https://github.com/jerryjliu/llama_index/blob/main/examples/vector_indices/FaissIndexDemo.ipynb\n\nè°ƒç”¨ index çš„ save_to_disk æ–¹æ³•å°±å¯ä»¥äº†å‘€\n","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1681794027,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"ä¸Šæµ·","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":372425,"user_name":"é“¶æ²³ç³»","can_delete":false,"product_type":"c1","uid":1018079,"ip_address":"å¹¿ä¸œ","ucode":"3BC7FFEDC9F94A","user_header":"https://static001.geekbang.org/account/avatar/00/0f/88/df/e7bf1bdb.jpg","comment_is_top":false,"comment_ctime":1681124707,"is_pvip":false,"replies":[{"id":135949,"content":"æŠ¥ä»€ä¹ˆé”™å‘¢ï¼Ÿ\n\n","user_name":"ä½œè€…å›å¤","user_name_real":"ç¼–è¾‘","uid":1053568,"ctime":1681142409,"ip_address":"ä¸Šæµ·","comment_id":372425,"utype":1}],"discussion_count":3,"race_medal":0,"score":3,"product_id":100541001,"comment_content":"openai.api_key = os.environ.get(&quot;OPENAI_API_KEY&quot;)\n\nlogging.basicConfig(stream=sys.stdout, level=logging.INFO)\nlogging.getLogger().addHandler(logging.StreamHandler(stream=sys.stdout))\n\n# dimensions of text-ada-embedding-002\nd = 768\nfaiss_index = faiss.IndexFlatL2(d)\ntext_splitter = CharacterTextSplitter(separator=&quot;\\n\\n&quot;, chunk_size=100, chunk_overlap=20)\nparser = SimpleNodeParser(text_splitter=text_splitter)\ndocuments = SimpleDirectoryReader(&#39;.&#47;data&#47;test&#39;).load_data()\nnodes = parser.get_nodes_from_documents(documents)\nllm_predictor = LLMPredictor(llm=ChatOpenAI(temperature=0, model_name=&quot;gpt-3.5-turbo&quot;, max_tokens=1024))\nembed_model = LangchainEmbedding(HuggingFaceEmbeddings(\n        model_name=&quot;sentence-transformers&#47;paraphrase-multilingual-mpnet-base-v2&quot;\n    ))\nservice_context = ServiceContext.from_defaults(llm_predictor=llm_predictor, embed_model=embed_model)\nindex = GPTFaissIndex(nodes=nodes, faiss_index=faiss_index, service_context=service_context)\n# save index to diskIM5æœ€æœ‰ç‰¹è‰²çš„ä½¿ç”¨åœºæ™¯\nindex.save_to_disk(\n    &#39;index_faiss.json&#39;,\n    faiss_index_save_path=&quot;index_faiss_core.index&quot;\n)\n\n# load index from disk\nindex = GPTFaissIndex.load_from_disk(&#39;index_faiss.json&#39;,faiss_index_save_path=&quot;index_faiss_core.index&quot;)\nresponse = index.query(&quot;xxxxx&quot;,mode=QueryMode.EMBEDDING,verbose=True)\nprint(response)\nè¿™ä¸ªä»£ç æŠ¥é”™å‘¢","like_count":0,"discussions":[{"author":{"id":1053568,"avatar":"https://static001.geekbang.org/account/avatar/00/10/13/80/8de66543.jpg","nickname":"å¾æ–‡æµ©","note":"","ucode":"1D39AC564172E9","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":613169,"discussion_content":"æŠ¥ä»€ä¹ˆé”™å‘¢ï¼Ÿ\n\n","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1681142409,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"ä¸Šæµ·","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":1,"child_discussions":[{"author":{"id":1018079,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/88/df/e7bf1bdb.jpg","nickname":"é“¶æ²³ç³»","note":"","ucode":"3BC7FFEDC9F94A","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":1053568,"avatar":"https://static001.geekbang.org/account/avatar/00/10/13/80/8de66543.jpg","nickname":"å¾æ–‡æµ©","note":"","ucode":"1D39AC564172E9","race_medal":0,"user_type":2,"is_pvip":false},"discussion":{"id":613542,"discussion_content":"æµ‹è¯•è¿‡äº†ä»£ç ï¼Œåªè¦è‡ªå®šä¹‰embdingï¼Œä¿å­˜å¥½äº†ï¼Œé‡æ–°åŠ è½½ï¼Œå°±ä¼šæŠ¥é”™","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1681384268,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":613169,"ip_address":"å¹¿ä¸œ","group_id":0},"score":613542,"extra":""}]},{"author":{"id":1018079,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/88/df/e7bf1bdb.jpg","nickname":"é“¶æ²³ç³»","note":"","ucode":"3BC7FFEDC9F94A","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":613192,"discussion_content":"æ„Ÿè°¢æµ©å“¥ç™¾å¿™å›å¤ï¼Œæˆ‘è´´å‡ºæœ€åä¸‰è¡Œå§ã€‚\n\n  File &#34;/Users/xxxx/miniconda3/envs/chatbot/lib/python3.8/site-packages/llama_index/indices/vector_store/base_query.py&#34;, line 57, in _retrieve\n    query_result = self._vector_store.query(\n  File &#34;/Users/xxxx/miniconda3/envs/chatbot/lib/python3.8/site-packages/llama_index/vector_stores/faiss.py&#34;, line 137, in query\n    dists, indices = self._faiss_index.search(query_embedding_np, similarity_top_k)\n  File &#34;/Users/xxxx/miniconda3/envs/chatbot/lib/python3.8/site-packages/faiss/__init__.py&#34;, line 308, in replacement_search\n    assert d == self.d\nAssertionError","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1681181605,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":"å¹¿ä¸œ","group_id":0},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":372424,"user_name":"é“¶æ²³ç³»","can_delete":false,"product_type":"c1","uid":1018079,"ip_address":"å¹¿ä¸œ","ucode":"3BC7FFEDC9F94A","user_header":"https://static001.geekbang.org/account/avatar/00/0f/88/df/e7bf1bdb.jpg","comment_is_top":false,"comment_ctime":1681124095,"is_pvip":false,"replies":[{"id":135952,"content":"è¿™ä¸€è®²çš„Demoé‡Œï¼Œembeddingå°±æ˜¯ç”¨è‡ªå·±çš„ï¼Œä¹Ÿæ˜¯åœ¨æœ¬åœ°çš„ï¼Œå¹¶æ²¡æœ‰ä½¿ç”¨äº‘æœåŠ¡å‘€ï¼Ÿ\n\nè¿˜æ˜¯æˆ‘ç†è§£é”™äº†ä½ çš„é—®é¢˜ï¼Ÿ","user_name":"ä½œè€…å›å¤","user_name_real":"ç¼–è¾‘","uid":1053568,"ctime":1681143216,"ip_address":"ä¸Šæµ·","comment_id":372424,"utype":1}],"discussion_count":1,"race_medal":0,"score":3,"product_id":100541001,"comment_content":"faissä¿å­˜åœ¨æœ¬åœ°è€Œä¸”ä½¿ç”¨è‡ªå·±çš„embeddingçš„å¯å¦ç»™ä¸ªdemoï¼Ÿ","like_count":0,"discussions":[{"author":{"id":1053568,"avatar":"https://static001.geekbang.org/account/avatar/00/10/13/80/8de66543.jpg","nickname":"å¾æ–‡æµ©","note":"","ucode":"1D39AC564172E9","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":613172,"discussion_content":"è¿™ä¸€è®²çš„Demoé‡Œï¼Œembeddingå°±æ˜¯ç”¨è‡ªå·±çš„ï¼Œä¹Ÿæ˜¯åœ¨æœ¬åœ°çš„ï¼Œå¹¶æ²¡æœ‰ä½¿ç”¨äº‘æœåŠ¡å‘€ï¼Ÿ\n\nè¿˜æ˜¯æˆ‘ç†è§£é”™äº†ä½ çš„é—®é¢˜ï¼Ÿ","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1681143216,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"ä¸Šæµ·","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":372234,"user_name":"xbc","can_delete":false,"product_type":"c1","uid":2187437,"ip_address":"æµ·å—","ucode":"03F1FD7B8CA32F","user_header":"https://static001.geekbang.org/account/avatar/00/21/60/ad/03351e6e.jpg","comment_is_top":false,"comment_ctime":1680862811,"is_pvip":false,"replies":[{"id":135901,"content":"æˆ‘æ™šç‚¹è¯•ä¸€ä¸‹ï¼Œæˆ‘æµ‹è¯•è¿‡åº”è¯¥æ˜¯è®¾ç½®äº† \nopenai.api_key = &quot;&quot;\nå»queryè§¦å‘è°ƒç”¨OpenAIæ˜¯ä¼šæŠ¥é”™çš„\n\nä¸è¿‡è¿™ä¸ªä¸å½±å“å®é™…çš„embeddingæ˜¯è°ƒç”¨äº†æˆ‘ä»¬æŒ‡å®šçš„sentence_transfomersçš„embedding","user_name":"ä½œè€…å›å¤","user_name_real":"ç¼–è¾‘","uid":1053568,"ctime":1680975371,"ip_address":"æ—¥æœ¬","comment_id":372234,"utype":1}],"discussion_count":4,"race_medal":0,"score":3,"product_id":100541001,"comment_content":"```\n\nimport openai, os\nimport faiss\nfrom llama_index import SimpleDirectoryReader, LangchainEmbedding, GPTFaissIndex, ServiceContext\nfrom langchain.embeddings.huggingface import HuggingFaceEmbeddings\nfrom langchain.text_splitter import CharacterTextSplitter\nfrom llama_index.node_parser import SimpleNodeParser\n\nopenai.api_key = &quot;&quot;\n\ntext_splitter = CharacterTextSplitter(separator=&quot;\\n\\n&quot;, chunk_size=100, chunk_overlap=20)\nparser = SimpleNodeParser(text_splitter=text_splitter)\ndocuments = SimpleDirectoryReader(&#39;.&#47;data&#47;faq&#47;&#39;).load_data()\nnodes = parser.get_nodes_from_documents(documents)\n\nembed_model = LangchainEmbedding(HuggingFaceEmbeddings(\n    model_name=&quot;sentence-transformers&#47;paraphrase-multilingual-mpnet-base-v2&quot;\n))\nservice_context = ServiceContext.from_defaults(embed_model=embed_model)\n\ndimension = 768\nfaiss_index = faiss.IndexFlatIP(dimension)\nindex = GPTFaissIndex(nodes=nodes,faiss_index=faiss_index, service_context=service_context)\n```\n\nè¿™æ®µä»£ç ä¼šæŠ¥é”™ï¼Œè€å¸ˆçš„ç¯å¢ƒé‡Œé¢å¯èƒ½æœ‰äº† env OPENAI_API_KEY.\n\næˆ‘è¿™é‡Œæ”¾çš„pyæ–‡ä»¶æ‰§è¡Œï¼š\n  Did not find openai_api_key, please add an environment variable `OPENAI_API_KEY` which contains it, or pass  `openai_api_key` as a named parameter. (type=value_error)\n\n","like_count":0,"discussions":[{"author":{"id":1053568,"avatar":"https://static001.geekbang.org/account/avatar/00/10/13/80/8de66543.jpg","nickname":"å¾æ–‡æµ©","note":"","ucode":"1D39AC564172E9","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":612898,"discussion_content":"æˆ‘æ™šç‚¹è¯•ä¸€ä¸‹ï¼Œæˆ‘æµ‹è¯•è¿‡åº”è¯¥æ˜¯è®¾ç½®äº† \nopenai.api_key = &#34;&#34;\nå»queryè§¦å‘è°ƒç”¨OpenAIæ˜¯ä¼šæŠ¥é”™çš„\n\nä¸è¿‡è¿™ä¸ªä¸å½±å“å®é™…çš„embeddingæ˜¯è°ƒç”¨äº†æˆ‘ä»¬æŒ‡å®šçš„sentence_transfomersçš„embedding","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1680975371,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"æ—¥æœ¬","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":2147220,"avatar":"https://static001.geekbang.org/account/avatar/00/20/c3/94/e89ebc50.jpg","nickname":"ç¥æ¯“é€é¥","note":"","ucode":"83351CB18B190E","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":622074,"discussion_content":"æ²¡åŠæ³•è§£å†³ä¹ˆï¼Ÿæˆ‘çœ‹æ³¨é‡Šäº† openai è¿˜æ˜¯ä¼šæŠ¥é”™","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1687880668,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":"ä¸Šæµ·","group_id":0},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1707839,"avatar":"https://static001.geekbang.org/account/avatar/00/1a/0f/3f/8b96cd8a.jpg","nickname":"åŒ…å­å…ˆç”Ÿ","note":"","ucode":"4332DB98492EE2","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":614737,"discussion_content":"Traceback (most recent call last):\n  File &#34;/Users/jianbinchen/PycharmProjects/clound/embedding.py&#34;, line 22, in &lt;module&gt;\n    service_context = ServiceContext.from_defaults(embed_model=embed_model)\n  File &#34;/Users/jianbinchen/.local/lib/python3.9/site-packages/llama_index/indices/service_context.py&#34;, line 69, in from_defaults\n    llm_predictor = llm_predictor or LLMPredictor()\n  File &#34;/Users/jianbinchen/.local/lib/python3.9/site-packages/llama_index/llm_predictor/base.py&#34;, line 164, in __init__\n    self._llm = llm or OpenAI(temperature=0, model_name=&#34;text-davinci-003&#34;)\n  File &#34;pydantic/main.py&#34;, line 341, in pydantic.main.BaseModel.__init__\npydantic.error_wrappers.ValidationError: 1 validation error for OpenAI\n__root__\n  Did not find openai_api_key, please add an environment variable `OPENAI_API_KEY` which contains it, or pass  `openai_api_key` as a named parameter. (type=value_error)\n","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1681891264,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":"å¹¿ä¸œ","group_id":0},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1707839,"avatar":"https://static001.geekbang.org/account/avatar/00/1a/0f/3f/8b96cd8a.jpg","nickname":"åŒ…å­å…ˆç”Ÿ","note":"","ucode":"4332DB98492EE2","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":614736,"discussion_content":"è¯·é—®è¿™ä¸ªæ˜¯æ€ä¹ˆè§£å†³çš„ï¼Œæˆ‘è¿™è¾¹ä¸€ç›´è¿è¡Œä¸äº†","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1681891231,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":"å¹¿ä¸œ","group_id":0},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":372164,"user_name":"Toni","can_delete":false,"product_type":"c1","uid":3206957,"ip_address":"ç‘å£«","ucode":"E6B2FACCC1E000","user_header":"https://static001.geekbang.org/account/avatar/00/30/ef/2d/757bb0d3.jpg","comment_is_top":false,"comment_ctime":1680793255,"is_pvip":false,"replies":[{"id":135862,"content":"ğŸ‘ å•ç‹¬å¥å­æ–‡æœ¬çš„ sentence_transformerçš„æ•ˆæœè¿˜æ˜¯ä¸é”™çš„ã€‚å¯ä»¥è¯•ç€åœ¨æ•´ä¸ªæ•°æ®é›†ä¸Šè·‘ä¸€ä¸‹çœ‹çœ‹æ•ˆæœåˆ†äº«ä¸€ä¸‹ç»™å¤§å®¶ã€‚","user_name":"ä½œè€…å›å¤","user_name_real":"ç¼–è¾‘","uid":1053568,"ctime":1680972488,"ip_address":"ä¸­å›½é¦™æ¸¯","comment_id":372164,"utype":1}],"discussion_count":2,"race_medal":0,"score":4,"product_id":100541001,"comment_content":"å°†ç¬¬äºŒè®²æƒ…æ„Ÿåˆ†æä¸­çš„è¿™æ®µä»£ç \n\ngood_restraurant = get_embedding(&quot;è¿™å®¶é¤é¦†å¤ªå¥½åƒäº†ï¼Œä¸€ç‚¹éƒ½ä¸ç³Ÿç³•&quot;)\nbad_restraurant = get_embedding(&quot;è¿™å®¶é¤é¦†å¤ªç³Ÿç³•äº†ï¼Œä¸€ç‚¹éƒ½ä¸å¥½åƒ&quot;)\ngood_score = get_score(good_restraurant)\nbad_score = get_score(bad_restraurant)\nprint(&quot;å¥½è¯„é¤é¦†çš„è¯„åˆ† : %f&quot; % (good_score))\nprint(&quot;å·®è¯„é¤é¦†çš„è¯„åˆ† : %f&quot; % (bad_score))\n\nç”¨sentence_transformers æ›¿ä»£openai.embeddings_utils åˆè·‘äº†ä¸€ä¸‹\nåœ¨é€‰ç”¨ model = SentenceTransformer(&#39;paraphrase-multilingual-mpnet-base-v2&#39;) çš„æƒ…å†µä¸‹\nå¾—åˆ°çš„å¦‚ä¸‹ç»“æœ\nå¥½è¯„ä¾‹å­çš„è¯„åˆ† : 0.215761\nå·®è¯„ä¾‹å­çš„è¯„åˆ† : -0.361450\næ¯” openai.embeddings_utils import cosine_similarity, get_embedding\nEMBEDDING_MODEL = &quot;text-embedding-ada-002&quot; çš„ç»“æœæ›´å¥½äº›\nå¥½è¯„ä¾‹å­çš„è¯„åˆ† : 0.062719\nå·®è¯„ä¾‹å­çš„è¯„åˆ† : -0.074591","like_count":0,"discussions":[{"author":{"id":1053568,"avatar":"https://static001.geekbang.org/account/avatar/00/10/13/80/8de66543.jpg","nickname":"å¾æ–‡æµ©","note":"","ucode":"1D39AC564172E9","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":612857,"discussion_content":"ğŸ‘ å•ç‹¬å¥å­æ–‡æœ¬çš„ sentence_transformerçš„æ•ˆæœè¿˜æ˜¯ä¸é”™çš„ã€‚å¯ä»¥è¯•ç€åœ¨æ•´ä¸ªæ•°æ®é›†ä¸Šè·‘ä¸€ä¸‹çœ‹çœ‹æ•ˆæœåˆ†äº«ä¸€ä¸‹ç»™å¤§å®¶ã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1680972488,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"ä¸­å›½é¦™æ¸¯","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":3206957,"avatar":"https://static001.geekbang.org/account/avatar/00/30/ef/2d/757bb0d3.jpg","nickname":"Toni","note":"","ucode":"E6B2FACCC1E000","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":612998,"discussion_content":"æ˜å¤©åœ¨å¤§æ•°æ®é›†ä¸Šè¯•è¯•","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1681073898,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":"ç‘å£«","group_id":0},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":372162,"user_name":"xbc","can_delete":false,"product_type":"c1","uid":2187437,"ip_address":"æµ·å—","ucode":"03F1FD7B8CA32F","user_header":"https://static001.geekbang.org/account/avatar/00/21/60/ad/03351e6e.jpg","comment_is_top":false,"comment_ctime":1680792861,"is_pvip":false,"replies":[{"id":135878,"content":"sentence_transfomersä¼šæˆªæ–­é•¿æ–‡æœ¬ï¼Œè®¾2048ä¼šä¸¢å¾ˆå¤šä¿¡æ¯ï¼Œwarningåªæ˜¯å‘Šè¯‰ä½ éƒ¨åˆ†å®ƒæ²¡æ³•åˆ‡åˆ°100ä»¥å†…ï¼Œæ²¡å…³ç³»çš„ã€‚","user_name":"ä½œè€…å›å¤","user_name_real":"ç¼–è¾‘","uid":1053568,"ctime":1680973818,"ip_address":"æ—¥æœ¬","comment_id":372162,"utype":1}],"discussion_count":1,"race_medal":0,"score":4,"product_id":100541001,"comment_content":"WARNING:root:Created a chunk of size 130, which is longer than the specified 100\n\nä¸€å¤§å †è¿™äº›ï¼Œä¸è¿‡å¯ä»¥å¿½ç•¥ã€‚\n\næœ€å¥½æ”¹ç”¨ï¼š text_splitter = SpacyTextSplitter(pipeline=&quot;zh_core_web_sm&quot;, chunk_size = 2048)","like_count":0,"discussions":[{"author":{"id":1053568,"avatar":"https://static001.geekbang.org/account/avatar/00/10/13/80/8de66543.jpg","nickname":"å¾æ–‡æµ©","note":"","ucode":"1D39AC564172E9","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":612873,"discussion_content":"sentence_transfomersä¼šæˆªæ–­é•¿æ–‡æœ¬ï¼Œè®¾2048ä¼šä¸¢å¾ˆå¤šä¿¡æ¯ï¼Œwarningåªæ˜¯å‘Šè¯‰ä½ éƒ¨åˆ†å®ƒæ²¡æ³•åˆ‡åˆ°100ä»¥å†…ï¼Œæ²¡å…³ç³»çš„ã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1680973818,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"æ—¥æœ¬","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":372112,"user_name":"mao","can_delete":false,"product_type":"c1","uid":1114652,"ip_address":"åŒ—äº¬","ucode":"C8E0700E9A108A","user_header":"https://static001.geekbang.org/account/avatar/00/11/02/1c/a0aba121.jpg","comment_is_top":false,"comment_ctime":1680749678,"is_pvip":false,"replies":[{"id":135891,"content":"åº”è¯¥æ˜¯å¯ä»¥çš„ï¼Œæˆ‘è¿˜æ²¡è¯•è¿‡","user_name":"ä½œè€…å›å¤","user_name_real":"ç¼–è¾‘","uid":1053568,"ctime":1680974569,"ip_address":"æ—¥æœ¬","comment_id":372112,"utype":1}],"discussion_count":1,"race_medal":0,"score":4,"product_id":100541001,"comment_content":"ChatGLM æ˜¯ä¸æ˜¯å¯ä»¥é€šè¿‡å¯¹QAæ•°æ®é›†è¿›è¡Œå¾®è°ƒï¼Œå¾—åˆ°ä¸€ä¸ªä¸“ç”¨çš„é—®ç­”æ¨¡å‹ã€‚","like_count":0,"discussions":[{"author":{"id":1053568,"avatar":"https://static001.geekbang.org/account/avatar/00/10/13/80/8de66543.jpg","nickname":"å¾æ–‡æµ©","note":"","ucode":"1D39AC564172E9","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":612887,"discussion_content":"åº”è¯¥æ˜¯å¯ä»¥çš„ï¼Œæˆ‘è¿˜æ²¡è¯•è¿‡","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1680974569,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"æ—¥æœ¬","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":372106,"user_name":"BashBIGBANG","can_delete":false,"product_type":"c1","uid":1032818,"ip_address":"å¹¿ä¸œ","ucode":"FDC25B00489500","user_header":"https://static001.geekbang.org/account/avatar/00/0f/c2/72/fb00cd31.jpg","comment_is_top":false,"comment_ctime":1680743380,"is_pvip":false,"replies":[{"id":135880,"content":"æ„Ÿè°¢æŒ‡å‡ºï¼Œä¸è¿‡åº”è¯¥æš‚æ—¶ä¸ä¼šé‡å½•ä¸€éäº†ï¼Œé‡å½•ä¸€éå¤ªè´¹æ—¶é—´äº†ã€‚","user_name":"ä½œè€…å›å¤","user_name_real":"ç¼–è¾‘","uid":1053568,"ctime":1680973902,"ip_address":"æ—¥æœ¬","comment_id":372106,"utype":1}],"discussion_count":1,"race_medal":0,"score":4,"product_id":100541001,"comment_content":"llama ä¸¤ä¸ª l åªè¯»ä¸€ä¸ªl çš„éŸ³","like_count":0,"discussions":[{"author":{"id":1053568,"avatar":"https://static001.geekbang.org/account/avatar/00/10/13/80/8de66543.jpg","nickname":"å¾æ–‡æµ©","note":"","ucode":"1D39AC564172E9","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":612875,"discussion_content":"æ„Ÿè°¢æŒ‡å‡ºï¼Œä¸è¿‡åº”è¯¥æš‚æ—¶ä¸ä¼šé‡å½•ä¸€éäº†ï¼Œé‡å½•ä¸€éå¤ªè´¹æ—¶é—´äº†ã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1680973902,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"æ—¥æœ¬","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":376222,"user_name":"Geek_6bdac7","can_delete":false,"product_type":"c1","uid":1503717,"ip_address":"ä¸Šæµ·","ucode":"E4AAB2DD740050","user_header":"https://thirdwx.qlogo.cn/mmopen/vi_32/DYAIOgq83eoWZh2ibhHevq5ndQFMK0Z28fO0bFVd3WxslfkHUlX5YPMPhSq0dqyn4F1ozeLcf8wHGfwG6EiaV5Qw/132","comment_is_top":false,"comment_ctime":1686557202,"is_pvip":false,"replies":null,"discussion_count":0,"race_medal":0,"score":4,"product_id":100541001,"comment_content":"ã€è§£å†³ã€‘colabè¿è¡Œæ¨¡å¼æ”¹ä¸ºgpuï¼Œå¯ä»¥pipå®‰è£… pip install faiss-gpu  \n\n\nè€å¸ˆè¯·é—®ä¸‹colabä¸Šfaissæ€ä¹ˆå®‰è£…ï¼Œè¯•äº†ä¸åŒæ–¹æ³•è¿˜æ˜¯åœ¨import faissæ—¶å¯¼å…¥æŠ¥é”™ï¼Œæ— faissæ¨¡å— \n!wget  https:&#47;&#47;anaconda.org&#47;pytorch&#47;faiss-gpu&#47;1.2.1&#47;download&#47;linux-64&#47;faiss-gpu-1.2.1-py36_cuda9.0.176_1.tar.bz2\n!tar xvjf faiss-gpu-1.2.1-py36_cuda9.0.176_1.tar.bz2\n!cp -r lib&#47;python3.6&#47;site-packages&#47;* &#47;usr&#47;local&#47;lib&#47;python3.6&#47;dist-packages&#47;\n!pip install mkl","like_count":1},{"had_liked":false,"id":373595,"user_name":"aoe","can_delete":false,"product_type":"c1","uid":1121758,"ip_address":"æµ™æ±Ÿ","ucode":"1C6201EDB4E954","user_header":"https://static001.geekbang.org/account/avatar/00/11/1d/de/62bfa83f.jpg","comment_is_top":false,"comment_ctime":1682733836,"is_pvip":false,"replies":null,"discussion_count":0,"race_medal":0,"score":4,"product_id":100541001,"comment_content":"çœ‹å®Œåæˆ‘è¿˜æ˜¯ç”¨æ˜¾å¡ç©æ¸¸æˆå§","like_count":1},{"had_liked":false,"id":394475,"user_name":"Geek_78a551","can_delete":false,"product_type":"c1","uid":3784461,"ip_address":"åŒ—äº¬","ucode":"CCADD2F766E193","user_header":"","comment_is_top":false,"comment_ctime":1726907434,"is_pvip":false,"replies":null,"discussion_count":0,"race_medal":0,"score":4,"product_id":100541001,"comment_content":"æˆ‘æŠŠä½ githubä¸Šçš„ä»£ç ä¸‹è½½ä¸‹æ¥æ‰§è¡Œå, ä¼šè¯·æ±‚gpt, è·Ÿä½ è¯´çš„ä¸ç¬¦åˆ, æŠ¥é”™ä¿¡æ¯æ˜¯api_keyé”™è¯¯","like_count":0},{"had_liked":false,"id":394461,"user_name":"Geek_78a551","can_delete":false,"product_type":"c1","uid":3784461,"ip_address":"åŒ—äº¬","ucode":"CCADD2F766E193","user_header":"","comment_is_top":false,"comment_ctime":1726847596,"is_pvip":false,"replies":null,"discussion_count":0,"race_medal":0,"score":4,"product_id":100541001,"comment_content":"æ›´æ–°åˆ°llma-index 0.11äº†, ä»£ç å…¨ä¸èƒ½è¿è¡Œ","like_count":0},{"had_liked":false,"id":390726,"user_name":"å­¦ä¹ ä¸­çš„å®‰è€å¸ˆ","can_delete":false,"product_type":"c1","uid":2838153,"ip_address":"å¹¿ä¸œ","ucode":"67DF9E4EC02E03","user_header":"https://thirdwx.qlogo.cn/mmopen/vi_32/4EspenNOwzy5VI6PiaT5nDbibhGa3utic5UTTv42ib8MCj0lFv83WHtcCfxxiadbp95XpdiafazhmHfYVstmUGKvVBgQ/132","comment_is_top":false,"comment_ctime":1716107030,"is_pvip":false,"replies":null,"discussion_count":0,"race_medal":0,"score":4,"product_id":100541001,"comment_content":"å†™çš„ä»£ç ä¸€ç‚¹æ³¨é‡Šéƒ½ä¸å†™ï¼Œè®©äººæ€ä¹ˆçœ‹","like_count":0},{"had_liked":false,"id":389564,"user_name":"Geek_a38da8","can_delete":false,"product_type":"c1","uid":2437521,"ip_address":"åŒ—äº¬","ucode":"E03AB3067312B0","user_header":"","comment_is_top":false,"comment_ctime":1712891217,"is_pvip":false,"replies":null,"discussion_count":0,"race_medal":0,"score":4,"product_id":100541001,"comment_content":"from transformers import AutoTokenizer, AutoModel\ntokenizer = AutoTokenizer.from_pretrained(&quot;THUDM&#47;chatglm-6b-int4&quot;, trust_remote_code=True)\nmodel = AutoModel.from_pretrained(&quot;THUDM&#47;chatglm-6b-int4&quot;,trust_remote_code=True).float()\nmodel = model.eval()ç›´æ¥pip install transformersï¼Œä¸‹è½½å½“å‰æœ€æ–°ç‰ˆæœ¬æŠ¥AttributeError: &#39;ChatGLMTokenizer&#39; object has no attribute &#39;sp_tokenizer&#39;ï¼Œé‡æ–°å®‰è£…transformers 4.33.1å³å¯","like_count":0},{"had_liked":false,"id":389563,"user_name":"Geek_a38da8","can_delete":false,"product_type":"c1","uid":2437521,"ip_address":"åŒ—äº¬","ucode":"E03AB3067312B0","user_header":"","comment_is_top":false,"comment_ctime":1712891111,"is_pvip":false,"replies":null,"discussion_count":0,"race_medal":0,"score":5,"product_id":100541001,"comment_content":"from transformers import AutoTokenizer, AutoModel\ntokenizer = AutoTokenizer.from_pretrained(&quot;THUDM&#47;chatglm-6b-int4&quot;, trust_remote_code=True)\nmodel = AutoModel.from_pretrained(&quot;THUDM&#47;chatglm-6b-int4&quot;,trust_remote_code=True).float()\nmodel = model.eval()","like_count":0},{"had_liked":false,"id":388860,"user_name":"èŒ‚æ¾","can_delete":false,"product_type":"c1","uid":1052375,"ip_address":"å¹¿ä¸œ","ucode":"458A6FBC49C48E","user_header":"https://static001.geekbang.org/account/avatar/00/10/0e/d7/7d7579c1.jpg","comment_is_top":false,"comment_ctime":1711013534,"is_pvip":false,"replies":null,"discussion_count":0,"race_medal":0,"score":5,"product_id":100541001,"comment_content":"è¿è¡Œä¸‹é¢è¿™æ®µä»£ç æ—¶æŠ¥é”™  AttributeError: module &#39;openai&#39; has no attribute &#39;error&#39;\n\nfrom llama_index import QuestionAnswerPrompt\nfrom llama_index import QueryMode\nQA_PROMPT_TMPL = ( &quot;{context_str}&quot; &quot;\\n\\n&quot; &quot;æ ¹æ®ä»¥ä¸Šä¿¡æ¯ï¼Œè¯·å›ç­”ä¸‹é¢çš„é—®é¢˜ï¼š\\n&quot; &quot;Q: {query_str}\\n&quot; )QA_PROMPT = QuestionAnswerPrompt(QA_PROMPT_TMPL)response = index.query( &quot;è¯·é—®ä½ ä»¬æµ·å—èƒ½å‘è´§å—ï¼Ÿ&quot;, mode=QueryMode.EMBEDDING, text_qa_template=QA_PROMPT, verbose=True, )print(response)","like_count":0},{"had_liked":false,"id":380552,"user_name":"Geek_731528","can_delete":false,"product_type":"c1","uid":3179207,"ip_address":"æµ™æ±Ÿ","ucode":"75F5EF7EBB7BFB","user_header":"","comment_is_top":false,"comment_ctime":1693812385,"is_pvip":false,"replies":null,"discussion_count":0,"race_medal":0,"score":5,"product_id":100541001,"comment_content":"KeyError                                  Traceback (most recent call last)\nCell In[13], line 12\n      4 QA_PROMPT_TMPL = (\n      5     &quot;{context_str}&quot;\n      6     &quot;\\n\\n&quot;\n      7     &quot;æ ¹æ®ä»¥ä¸Šä¿¡æ¯ï¼Œè¯·å›ç­”ä¸‹é¢çš„é—®é¢˜ï¼š\\n&quot;\n      8     &quot;Q: {query_str}\\n&quot;\n      9     )\n     10 QA_PROMPT = QuestionAnswerPrompt(QA_PROMPT_TMPL)\n---&gt; 12 response = index.query(\n     13     &quot;è¯·é—®ä½ ä»¬æµ·å—èƒ½å‘è´§å—ï¼Ÿ&quot;, \n     14     mode=QueryMode.EMBEDDING,\n     15     text_qa_template=QA_PROMPT,\n     16     verbose=True, \n     17 )\n\nKeyError: &#39;-1&#39;\n\nè¯·é—®è€è¿™ä¸ªé”™è¯¯æ˜¯ä»€ä¹ˆæ„æ€","like_count":0},{"had_liked":false,"id":379139,"user_name":"å°ç†æƒ³ã€‚","can_delete":false,"product_type":"c1","uid":2238528,"ip_address":"åŒ—äº¬","ucode":"EDC35A907570DB","user_header":"https://static001.geekbang.org/account/avatar/00/22/28/40/82d748e6.jpg","comment_is_top":false,"comment_ctime":1691402914,"is_pvip":false,"replies":null,"discussion_count":0,"race_medal":0,"score":5,"product_id":100541001,"comment_content":"è€å¸ˆæƒ³é—®ä¸€ä¸‹ï¼Œæ‰§è¡Œå’±ä»¬è¿™ä¸ªè¯¾ç¨‹ç¬¬ä¸€ä¸ªç¤ºä¾‹ï¼Œè¿˜æ˜¯è¦äº†openaiçš„keyï¼Œä¸å¡«ä¸Šä¸€ç›´æŠ¥é”™ï¼Œå¡«ä¸Škeyå°±æ²¡é—®é¢˜äº†ï¼Œæ‰§è¡Œå®Œäº†ï¼Œè¿™æ˜¯æ€ä¹ˆå›äº‹ï¼Œå°±æ˜¯å¦‚ä¸‹ä»£ç ï¼Ÿ\nimport openai, os\nimport faiss\nfrom llama_index import SimpleDirectoryReader, LangchainEmbedding, GPTFaissIndex, ServiceContext\nfrom langchain.embeddings.huggingface import HuggingFaceEmbeddings\nfrom langchain.text_splitter import CharacterTextSplitter\nfrom llama_index.node_parser import SimpleNodeParser\n\nopenai.api_key = &quot;&quot;\n\ntext_splitter = CharacterTextSplitter(separator=&quot;\\n\\n&quot;, chunk_size=100, chunk_overlap=20)\nparser = SimpleNodeParser(text_splitter=text_splitter)\ndocuments = SimpleDirectoryReader(&#39;.&#47;data&#47;faq&#47;&#39;).load_data()\nnodes = parser.get_nodes_from_documents(documents)\n\nembed_model = LangchainEmbedding(HuggingFaceEmbeddings(\n    model_name=&quot;sentence-transformers&#47;paraphrase-multilingual-mpnet-base-v2&quot;\n))\nservice_context = ServiceContext.from_defaults(embed_model=embed_model)\n\ndimension = 768\nfaiss_index = faiss.IndexFlatIP(dimension)\nindex = GPTFaissIndex(nodes=nodes,faiss_index=faiss_index, service_context=service_context)\næŠ¥é”™å¦‚ä¸‹ï¼šè¿˜æ˜¯è¦äº†openaiçš„keyï¼Œä¸å¡«ä¸Šä¸€ç›´æŠ¥é”™\n__root__\n  Did not find openai_api_key, please add an environment variable `OPENAI_API_KEY` which contains it, or pass  `openai_api_key` as a named parameter. (type=value_error)","like_count":0},{"had_liked":false,"id":378241,"user_name":"BIN","can_delete":false,"product_type":"c1","uid":1105397,"ip_address":"ä¸Šæµ·","ucode":"0ACB97396577B9","user_header":"https://static001.geekbang.org/account/avatar/00/10/dd/f5/7c88efce.jpg","comment_is_top":false,"comment_ctime":1689931492,"is_pvip":false,"replies":null,"discussion_count":0,"race_medal":0,"score":5,"product_id":100541001,"comment_content":"å¦‚ä½•è®¡ç®—æ¨¡å‹çš„FLOPså€¼","like_count":0},{"had_liked":false,"id":378240,"user_name":"BIN","can_delete":false,"product_type":"c1","uid":1105397,"ip_address":"ä¸Šæµ·","ucode":"0ACB97396577B9","user_header":"https://static001.geekbang.org/account/avatar/00/10/dd/f5/7c88efce.jpg","comment_is_top":false,"comment_ctime":1689931259,"is_pvip":false,"replies":null,"discussion_count":0,"race_medal":0,"score":5,"product_id":100541001,"comment_content":"è¯·æ•™ä¸€ä¸ªé—®é¢˜ï¼šç®—åŠ›çš„æˆæœ¬å¦‚ä½•è®¡ç®—ï¼Ÿå½±å“çš„å› ç´ æœ‰å“ªäº›ï¼Ÿç›®å‰èƒ½æƒ³åˆ°å¯èƒ½çš„å› ç´ æ˜¯æ¨¡å‹çš„å‚æ•°é‡ã€æ¨ç†è¯·æ±‚çš„å¹¶å‘æ•°ã€æ¨ç†å“åº”æ—¶é—´ã€è¾“å…¥å’Œè¾“å‡ºé•¿åº¦ï¼›å…·ä½“åº”è¯¥å¦‚ä½•è¯„ä¼°è´­ä¹°ä»€ä¹ˆé…ç½®çš„GPUå‘¢ï¼Ÿæœ›è€å¸ˆæŒ‡ç‚¹ä¸‹ï¼Œè°¢è°¢","like_count":0},{"had_liked":false,"id":377435,"user_name":"RCPatton","can_delete":false,"product_type":"c1","uid":2267708,"ip_address":"å±±è¥¿","ucode":"F6D9D39516D841","user_header":"https://static001.geekbang.org/account/avatar/00/22/9a/3c/ab32ff62.jpg","comment_is_top":false,"comment_ctime":1688484881,"is_pvip":false,"replies":null,"discussion_count":0,"race_medal":0,"score":5,"product_id":100541001,"comment_content":"å¥½æ¶ˆæ¯ï¼Œchatglmå¯ä»¥ç›´æ¥é€šè¿‡APIè°ƒç”¨äº†ï¼ï¼","like_count":0},{"had_liked":false,"id":376986,"user_name":"ç¥æ¯“é€é¥","can_delete":false,"product_type":"c1","uid":2147220,"ip_address":"ä¸Šæµ·","ucode":"83351CB18B190E","user_header":"https://static001.geekbang.org/account/avatar/00/20/c3/94/e89ebc50.jpg","comment_is_top":false,"comment_ctime":1687791159,"is_pvip":false,"replies":null,"discussion_count":0,"race_medal":0,"score":5,"product_id":100541001,"comment_content":"å¤§èµ","like_count":0},{"had_liked":false,"id":376693,"user_name":"å‘¼å‘¼","can_delete":false,"product_type":"c1","uid":1038798,"ip_address":"å››å·","ucode":"5D7B57C05B5D8C","user_header":"https://static001.geekbang.org/account/avatar/00/0f/d9/ce/4528cb4b.jpg","comment_is_top":false,"comment_ctime":1687233561,"is_pvip":false,"replies":null,"discussion_count":0,"race_medal":0,"score":5,"product_id":100541001,"comment_content":"åŒæ ·çš„ä»£ç ï¼Œchatglmï¼Œé—®é¢˜4ï¼Œå›ç­”æˆ‘ï¼šæ ¹æ®æä¾›çš„ä¿¡æ¯ï¼Œå¯ä»¥é…é€åˆ°å“ˆå°”æ»¨ã€‚","like_count":0},{"had_liked":false,"id":376472,"user_name":"Penguin Shi","can_delete":false,"product_type":"c1","uid":3646806,"ip_address":"å¹¿ä¸œ","ucode":"477A24D7ECE09A","user_header":"https://static001.geekbang.org/account/avatar/00/37/a5/56/b3cf71a9.jpg","comment_is_top":false,"comment_ctime":1686834046,"is_pvip":false,"replies":null,"discussion_count":0,"race_medal":0,"score":5,"product_id":100541001,"comment_content":"å¾è€å¸ˆï¼Œæˆ‘ç°åœ¨æƒ³ç”¨AIæˆ–è€…å¼€æºæ¨¡å‹ï¼Œå®ç°è‡ªæœ‰æ–‡æœ¬æ•°æ®çš„æŒ–æ˜ã€‚æƒ³è¯·æ•™ä¸€ä¸‹ï¼Œæˆ‘åº”è¯¥ç”¨å“ªä¸ªæ¨¡å‹å’Œå…·ä½“çš„å“ªä¸ªåº“ã€‚æˆ‘ä»¬å…¬å¸æ•°æ®åº“é‡Œæœ‰å¾ˆå¤šé”€å”®å’Œå®¢æˆ·çš„èŠå¤©æ–‡æœ¬ï¼Œæ˜¯å®¢æˆ·æ¯æ¬¡åˆ°åº—çš„èŠå¤©è®°å½•ã€‚æˆ‘æƒ³é€šè¿‡è¿™äº›æ–‡æœ¬ï¼Œæå–å…³é”®è¯ï¼Œæˆ–è€…ç»Ÿè®¡è¯é¢‘ï¼Œæ‰¾å‡ºæ•´ä¸ªå…¬å¸å®¢æˆ·çš„å®¢æˆ·ç”»åƒï¼ˆæ‚¨çœ‹æ˜¯ç”¨è¯é¢‘å¥½ï¼Œè¿˜æ˜¯å…³é”®è¯å¥½ï¼‰ã€‚è€Œé’ˆå¯¹æ¯ä¸ªå®¢æˆ·ï¼Œæˆ‘æƒ³æŠŠå¥¹è¿‡å¾€çš„èŠå¤©è®°å½•ï¼Œæå–æ‘˜è¦æˆ–è€…å…³é”®è¯ï¼Œæ–¹ä¾¿é”€å”®å¿«é€Ÿå›å¿†èµ·å®¢æˆ·çš„ç‰¹ç‚¹ã€‚æˆ‘ç°åœ¨ç”¨jiabaç»Ÿè®¡äº†è¯é¢‘å’Œå…³é”®è¯ï¼Œè·Ÿç”¨chatGPT3.5èŠå¤©æå–çš„å…³é”®è¯ï¼Œå·®åˆ«è¿˜æ˜¯å¾ˆå¤§ã€‚æˆ‘ç”¨openAIçš„APIï¼Œè°ƒç”¨003,ç»“æœæ²¡æœ‰æå–å‡ºå…³é”®è¯å’Œæ‘˜è¦ï¼Œä¸çŸ¥é“æ˜¯ä¸æ˜¯è¿™ä¸ªåº“ä¸é€‚ç”¨äºä¸­æ–‡ã€‚æˆ‘åˆšå¼€å§‹æ¥è§¦pythonå’ŒAIï¼Œè¯·è€å¸ˆèµæ•™ã€‚","like_count":0},{"had_liked":false,"id":372165,"user_name":"Ethan New","can_delete":false,"product_type":"c1","uid":2063962,"ip_address":"æµ™æ±Ÿ","ucode":"9CA2EF39E58030","user_header":"https://static001.geekbang.org/account/avatar/00/1f/7e/5a/da39f489.jpg","comment_is_top":false,"comment_ctime":1680793331,"is_pvip":true,"replies":null,"discussion_count":0,"race_medal":4,"score":6,"product_id":100541001,"comment_content":"å­¦ä¹ æ‰“å¡","like_count":0},{"had_liked":false,"id":372128,"user_name":"John","can_delete":false,"product_type":"c1","uid":1020861,"ip_address":"åŠ æ‹¿å¤§","ucode":"E4ADF8488953FB","user_header":"https://static001.geekbang.org/account/avatar/00/0f/93/bd/f3977ebb.jpg","comment_is_top":false,"comment_ctime":1680768066,"is_pvip":false,"replies":null,"discussion_count":0,"race_medal":0,"score":6,"product_id":100541001,"comment_content":"é‚£ä¿©æ¨¡å‹æ²¡çœ‹åˆ°è¯´tokenæ•°é‡å‘€? æƒ³ä¸€æƒ³GPT4-32K ä¸ç¦å”å˜˜","like_count":0},{"had_liked":false,"id":372108,"user_name":"Viktor","can_delete":false,"product_type":"c1","uid":1520703,"ip_address":"å››å·","ucode":"DCAFD1DD5C6A0C","user_header":"https://static001.geekbang.org/account/avatar/00/17/34/3f/4b6cd370.jpg","comment_is_top":false,"comment_ctime":1680743675,"is_pvip":false,"replies":null,"discussion_count":2,"race_medal":0,"score":6,"product_id":100541001,"comment_content":"å¯¹äºæˆ‘ä»¬è¿™äº›éç®—æ³•å·¥ç¨‹å¸ˆçš„åŒå­¦æ¥è¯´ï¼Œä½¿ç”¨ç¬¬ä¸‰æ–¹å¼€æºæ¨¡å‹å¾ˆéš¾åšå‡ºä¸€ä¸ªè¾ƒå¥½çš„æ•ˆæœã€‚è€Œä¸”é‡åˆ°æ¨¡å‹é—®é¢˜ï¼Œä¹Ÿæ²¡æœ‰åŠæ³•è¿›è¡Œè°ƒä¼˜ã€‚æ‰€ä»¥è¿˜æ˜¯æ¯”è¾ƒå€¾å‘äºåƒChatGPTè¿™æ ·çš„äº§ç‰©ã€‚","like_count":0,"discussions":[{"author":{"id":1338098,"avatar":"https://static001.geekbang.org/account/avatar/00/14/6a/f2/db90fa96.jpg","nickname":"Oliå¼ å¸†","note":"","ucode":"6E60A370C3C14A","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":612581,"discussion_content":"å¯¹çš„å¯¹çš„ï¼Œä¸è¿‡çŸ¥é“æœ‰å…¶ä»–é€‰æ‹©ï¼Œè¿˜æ˜¯ä¸é”™ã€‚ä¸è¿‡æˆ‘ä¼°è®¡OpenAIçš„æˆæœ¬ä¸‹é™é€Ÿåº¦åº”è¯¥ä¹Ÿä¼šéµå¾ªæ‘©å°”å®šå¾‹å§ã€‚","likes_number":1,"is_delete":false,"is_hidden":false,"ctime":1680790823,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":"åŒ—äº¬","group_id":0},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1222233,"avatar":"https://static001.geekbang.org/account/avatar/00/12/a6/59/1689ea0c.jpg","nickname":"é‡‘hb.Ryan å†·ç©ºæ°£é§•åˆ°","note":"","ucode":"CAD363576696E4","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":618861,"discussion_content":"å¯¹å“¦ï¼Œè§„æ¨¡åŒ–ä¹‹å‰æ²¡å¿…è¦ä¸Šä¸‰æ–¹ï¼Œæˆ–è€…å°±æœ¬åœ°ç©ç©","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1684657726,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":"ä¸Šæµ·","group_id":0},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]}]}