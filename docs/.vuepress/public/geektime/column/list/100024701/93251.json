{"id":93251,"title":"15 | è°ƒåº¦ï¼ˆä¸Šï¼‰ï¼šå¦‚ä½•åˆ¶å®šé¡¹ç›®ç®¡ç†æµç¨‹ï¼Ÿ","content":"<p>å‰å‡ èŠ‚ï¼Œæˆ‘ä»¬ä»‹ç»äº†task_structæ•°æ®ç»“æ„ã€‚å®ƒå°±åƒé¡¹ç›®ç®¡ç†ç³»ç»Ÿä¸€æ ·ï¼Œå¯ä»¥å¸®é¡¹ç›®ç»ç†ç»´æŠ¤é¡¹ç›®è¿è¡Œè¿‡ç¨‹ä¸­çš„å„ç±»ä¿¡æ¯ï¼Œä½†è¿™å¹¶ä¸æ„å‘³ç€é¡¹ç›®ç®¡ç†å·¥ä½œå°±å®Œäº‹å¤§å‰äº†ã€‚task_structä»…ä»…èƒ½å¤Ÿè§£å†³â€œ<strong>çœ‹åˆ°</strong>â€çš„é—®é¢˜ï¼Œå’±ä»¬è¿˜è¦è§£å†³å¦‚ä½•åˆ¶å®šæµç¨‹ï¼Œè¿›è¡Œé¡¹ç›®è°ƒåº¦çš„é—®é¢˜ï¼Œä¹Ÿå°±æ˜¯â€œ<strong>åšåˆ°</strong>â€çš„é—®é¢˜ã€‚</p><p>å…¬å¸çš„äººå‘˜æ€»æ˜¯æœ‰é™çš„ã€‚æ— è®ºæ¥äº†å¤šå°‘é¡¹ç›®ï¼Œå…¬å¸ä¸å¯èƒ½çŸ­æ—¶é—´å¢åŠ å¾ˆå¤šäººæ‰‹ã€‚æœ‰çš„é¡¹ç›®æ¯”è¾ƒç´§æ€¥ï¼Œåº”è¯¥å…ˆè¿›è¡Œæ’æœŸï¼›æœ‰çš„é¡¹ç›®å¯ä»¥ç¼“ç¼“ï¼Œä½†æ˜¯ä¹Ÿä¸èƒ½è®©å®¢æˆ·ç­‰å¤ªä¹…ã€‚æ‰€ä»¥è¿™ä¸ªè¿‡ç¨‹éå¸¸å¤æ‚ï¼Œéœ€è¦å¹³è¡¡ã€‚</p><p>å¯¹äºæ“ä½œç³»ç»Ÿæ¥è®²ï¼Œå®ƒé¢å¯¹çš„CPUçš„æ•°é‡æ˜¯æœ‰é™çš„ï¼Œå¹²æ´»å„¿éƒ½æ˜¯å®ƒä»¬ï¼Œä½†æ˜¯è¿›ç¨‹æ•°ç›®è¿œè¿œè¶…è¿‡CPUçš„æ•°ç›®ï¼Œå› è€Œå°±éœ€è¦è¿›è¡Œè¿›ç¨‹çš„è°ƒåº¦ï¼Œæœ‰æ•ˆåœ°åˆ†é…CPUçš„æ—¶é—´ï¼Œæ—¢è¦ä¿è¯è¿›ç¨‹çš„æœ€å¿«å“åº”ï¼Œä¹Ÿè¦ä¿è¯è¿›ç¨‹ä¹‹é—´çš„å…¬å¹³ã€‚è¿™ä¹Ÿæ˜¯ä¸€ä¸ªéå¸¸å¤æ‚çš„ã€éœ€è¦å¹³è¡¡çš„äº‹æƒ…ã€‚</p><h2>è°ƒåº¦ç­–ç•¥ä¸è°ƒåº¦ç±»</h2><p>åœ¨Linuxé‡Œé¢ï¼Œè¿›ç¨‹å¤§æ¦‚å¯ä»¥åˆ†æˆä¸¤ç§ã€‚</p><p>ä¸€ç§ç§°ä¸º<strong>å®æ—¶è¿›ç¨‹</strong>ï¼Œä¹Ÿå°±æ˜¯éœ€è¦å°½å¿«æ‰§è¡Œè¿”å›ç»“æœçš„é‚£ç§ã€‚è¿™å°±å¥½æ¯”æˆ‘ä»¬æ˜¯ä¸€å®¶å…¬å¸ï¼Œæ¥åˆ°çš„å®¢æˆ·é¡¹ç›®éœ€æ±‚å°±ä¼šæœ‰å¾ˆå¤šç§ã€‚æœ‰äº›å®¢æˆ·çš„é¡¹ç›®éœ€æ±‚æ¯”è¾ƒæ€¥ï¼Œæ¯”å¦‚ä¸€å®šè¦åœ¨ä¸€ä¸¤ä¸ªæœˆå†…å®Œæˆçš„è¿™ç§ï¼Œå®¢æˆ·ä¼šåŠ æ€¥åŠ é’±ï¼Œé‚£è¿™ç§å®¢æˆ·çš„ä¼˜å…ˆçº§å°±ä¼šæ¯”è¾ƒé«˜ã€‚</p><p>å¦ä¸€ç§æ˜¯<strong>æ™®é€šè¿›ç¨‹</strong>ï¼Œå¤§éƒ¨åˆ†çš„è¿›ç¨‹å…¶å®éƒ½æ˜¯è¿™ç§ã€‚è¿™å°±å¥½æ¯”ï¼Œå¤§éƒ¨åˆ†å®¢æˆ·çš„é¡¹ç›®éƒ½æ˜¯æ™®é€šçš„éœ€æ±‚ï¼Œå¯ä»¥æŒ‰ç…§æ­£å¸¸æµç¨‹å®Œæˆï¼Œä¼˜å…ˆçº§å°±æ²¡å®æ—¶è¿›ç¨‹è¿™ä¹ˆé«˜ï¼Œä½†æ˜¯äººå®¶è‚¯å®šä¹Ÿæœ‰ç¡®å®šçš„äº¤ä»˜æ—¥æœŸã€‚</p><!-- [[[read_end]]] --><p>é‚£å¾ˆæ˜¾ç„¶ï¼Œå¯¹äºè¿™ä¸¤ç§è¿›ç¨‹ï¼Œæˆ‘ä»¬çš„è°ƒåº¦ç­–ç•¥è‚¯å®šæ˜¯ä¸åŒçš„ã€‚</p><p>åœ¨task_structä¸­ï¼Œæœ‰ä¸€ä¸ªæˆå‘˜å˜é‡ï¼Œæˆ‘ä»¬å«<strong>è°ƒåº¦ç­–ç•¥</strong>ã€‚</p><pre><code>unsigned int policy;\n</code></pre><p>å®ƒæœ‰ä»¥ä¸‹å‡ ä¸ªå®šä¹‰ï¼š</p><pre><code>#define SCHED_NORMAL\t\t0\n#define SCHED_FIFO\t\t1\n#define SCHED_RR\t\t2\n#define SCHED_BATCH\t\t3\n#define SCHED_IDLE\t\t5\n#define SCHED_DEADLINE\t\t6\n</code></pre><p>é…åˆè°ƒåº¦ç­–ç•¥çš„ï¼Œè¿˜æœ‰æˆ‘ä»¬åˆšæ‰è¯´çš„<strong>ä¼˜å…ˆçº§</strong>ï¼Œä¹Ÿåœ¨task_structä¸­ã€‚</p><pre><code>int prio, static_prio, normal_prio;\nunsigned int rt_priority;\n</code></pre><p>ä¼˜å…ˆçº§å…¶å®å°±æ˜¯ä¸€ä¸ªæ•°å€¼ï¼Œå¯¹äºå®æ—¶è¿›ç¨‹ï¼Œä¼˜å…ˆçº§çš„èŒƒå›´æ˜¯0ï½99ï¼›å¯¹äºæ™®é€šè¿›ç¨‹ï¼Œä¼˜å…ˆçº§çš„èŒƒå›´æ˜¯100ï½139ã€‚æ•°å€¼è¶Šå°ï¼Œä¼˜å…ˆçº§è¶Šé«˜ã€‚ä»è¿™é‡Œå¯ä»¥çœ‹å‡ºï¼Œæ‰€æœ‰çš„å®æ—¶è¿›ç¨‹éƒ½æ¯”æ™®é€šè¿›ç¨‹ä¼˜å…ˆçº§è¦é«˜ã€‚æ¯•ç«Ÿï¼Œè°è®©äººå®¶åŠ é’±äº†å‘¢ã€‚</p><h3>å®æ—¶è°ƒåº¦ç­–ç•¥</h3><p>å¯¹äºè°ƒåº¦ç­–ç•¥ï¼Œå…¶ä¸­SCHED_FIFOã€SCHED_RRã€SCHED_DEADLINEæ˜¯å®æ—¶è¿›ç¨‹çš„è°ƒåº¦ç­–ç•¥ã€‚</p><p>è™½ç„¶å¤§å®¶éƒ½æ˜¯åŠ é’±åŠ æ€¥çš„é¡¹ç›®ï¼Œä½†æ˜¯ä¹Ÿä¸èƒ½ä¹±æ¥ï¼Œè¿˜æ˜¯éœ€è¦æœ‰ä¸ªåŠäº‹æµç¨‹æ‰è¡Œã€‚</p><p>ä¾‹å¦‚ï¼Œ<strong>SCHED_FIFO</strong>å°±æ˜¯äº¤äº†ç›¸åŒé’±çš„ï¼Œå…ˆæ¥å…ˆæœåŠ¡ï¼Œä½†æ˜¯æœ‰çš„åŠ é’±å¤šï¼Œå¯ä»¥åˆ†é…æ›´é«˜çš„ä¼˜å…ˆçº§ï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œé«˜ä¼˜å…ˆçº§çš„è¿›ç¨‹å¯ä»¥æŠ¢å ä½ä¼˜å…ˆçº§çš„è¿›ç¨‹ï¼Œè€Œç›¸åŒä¼˜å…ˆçº§çš„è¿›ç¨‹ï¼Œæˆ‘ä»¬éµå¾ªå…ˆæ¥å…ˆå¾—ã€‚</p><p>å¦å¤–ä¸€ç§ç­–ç•¥æ˜¯ï¼Œäº¤äº†ç›¸åŒé’±çš„ï¼Œè½®æ¢ç€æ¥ï¼Œè¿™å°±æ˜¯<strong>SCHED_RRè½®æµè°ƒåº¦ç®—æ³•</strong>ï¼Œé‡‡ç”¨æ—¶é—´ç‰‡ï¼Œç›¸åŒä¼˜å…ˆçº§çš„ä»»åŠ¡å½“ç”¨å®Œæ—¶é—´ç‰‡ä¼šè¢«æ”¾åˆ°é˜Ÿåˆ—å°¾éƒ¨ï¼Œä»¥ä¿è¯å…¬å¹³æ€§ï¼Œè€Œé«˜ä¼˜å…ˆçº§çš„ä»»åŠ¡ä¹Ÿæ˜¯å¯ä»¥æŠ¢å ä½ä¼˜å…ˆçº§çš„ä»»åŠ¡ã€‚</p><p>è¿˜æœ‰ä¸€ç§æ–°çš„ç­–ç•¥æ˜¯<strong>SCHED_DEADLINE</strong>ï¼Œæ˜¯æŒ‰ç…§ä»»åŠ¡çš„deadlineè¿›è¡Œè°ƒåº¦çš„ã€‚å½“äº§ç”Ÿä¸€ä¸ªè°ƒåº¦ç‚¹çš„æ—¶å€™ï¼ŒDLè°ƒåº¦å™¨æ€»æ˜¯é€‰æ‹©å…¶deadlineè·ç¦»å½“å‰æ—¶é—´ç‚¹æœ€è¿‘çš„é‚£ä¸ªä»»åŠ¡ï¼Œå¹¶è°ƒåº¦å®ƒæ‰§è¡Œã€‚</p><h3>æ™®é€šè°ƒåº¦ç­–ç•¥</h3><p>å¯¹äºæ™®é€šè¿›ç¨‹çš„è°ƒåº¦ç­–ç•¥æœ‰ï¼ŒSCHED_NORMALã€SCHED_BATCHã€SCHED_IDLEã€‚</p><p>æ—¢ç„¶å¤§å®¶çš„é¡¹ç›®éƒ½æ²¡æœ‰é‚£ä¹ˆç´§æ€¥ï¼Œå°±åº”è¯¥æŒ‰ç…§æ™®é€šçš„é¡¹ç›®æµç¨‹ï¼Œå…¬å¹³åœ°åˆ†é…äººå‘˜ã€‚</p><p>SCHED_NORMALæ˜¯æ™®é€šçš„è¿›ç¨‹ï¼Œå°±ç›¸å½“äºå’±ä»¬å…¬å¸æ¥çš„æ™®é€šé¡¹ç›®ã€‚</p><p>SCHED_BATCHæ˜¯åå°è¿›ç¨‹ï¼Œå‡ ä¹ä¸éœ€è¦å’Œå‰ç«¯è¿›è¡Œäº¤äº’ã€‚è¿™æœ‰ç‚¹åƒå…¬å¸åœ¨æ¥é¡¹ç›®åŒæ—¶ï¼Œå¼€å‘ä¸€äº›å¯ä»¥å¤ç”¨çš„æ¨¡å—ï¼Œä½œä¸ºå…¬å¸çš„æŠ€æœ¯ç§¯ç´¯ï¼Œä»è€Œä½¿å¾—åœ¨ä¹‹åæ¥æ–°é¡¹ç›®çš„æ—¶å€™ï¼Œèƒ½å¤Ÿå‡å°‘å·¥ä½œé‡ã€‚è¿™ç±»é¡¹ç›®å¯ä»¥é»˜é»˜æ‰§è¡Œï¼Œä¸è¦å½±å“éœ€è¦äº¤äº’çš„è¿›ç¨‹ï¼Œå¯ä»¥é™ä½å®ƒçš„ä¼˜å…ˆçº§ã€‚</p><p>SCHED_IDLEæ˜¯ç‰¹åˆ«ç©ºé—²çš„æ—¶å€™æ‰è·‘çš„è¿›ç¨‹ï¼Œç›¸å½“äºå’±ä»¬å­¦ä¹ è®­ç»ƒç±»çš„é¡¹ç›®ï¼Œæ¯”å¦‚å’±ä»¬å…¬å¸å¾ˆé•¿æ—¶é—´æ²¡æœ‰æ¥åˆ°å¤–åœ¨é¡¹ç›®äº†ï¼Œå¯ä»¥å¼„å‡ ä¸ªè¿™æ ·çš„é¡¹ç›®ç»ƒç»ƒæ‰‹ã€‚</p><p>ä¸Šé¢æ— è®ºæ˜¯policyè¿˜æ˜¯priorityï¼Œéƒ½è®¾ç½®äº†ä¸€ä¸ªå˜é‡ï¼Œå˜é‡ä»…ä»…è¡¨ç¤ºäº†åº”è¯¥è¿™æ ·è¿™æ ·å¹²ï¼Œä½†äº‹æƒ…æ€»è¦æœ‰äººå»å¹²ï¼Œè°å‘¢ï¼Ÿåœ¨task_structé‡Œé¢ï¼Œè¿˜æœ‰è¿™æ ·çš„æˆå‘˜å˜é‡ï¼š</p><pre><code>const struct sched_class *sched_class;\n</code></pre><p>è°ƒåº¦ç­–ç•¥çš„æ‰§è¡Œé€»è¾‘ï¼Œå°±å°è£…åœ¨è¿™é‡Œé¢ï¼Œå®ƒæ˜¯çœŸæ­£å¹²æ´»çš„é‚£ä¸ªã€‚</p><p>sched_classæœ‰å‡ ç§å®ç°ï¼š</p><ul>\n<li>\n<p>stop_sched_classä¼˜å…ˆçº§æœ€é«˜çš„ä»»åŠ¡ä¼šä½¿ç”¨è¿™ç§ç­–ç•¥ï¼Œä¼šä¸­æ–­æ‰€æœ‰å…¶ä»–çº¿ç¨‹ï¼Œä¸”ä¸ä¼šè¢«å…¶ä»–ä»»åŠ¡æ‰“æ–­ï¼›</p>\n</li>\n<li>\n<p>dl_sched_classå°±å¯¹åº”ä¸Šé¢çš„deadlineè°ƒåº¦ç­–ç•¥ï¼›</p>\n</li>\n<li>\n<p>rt_sched_classå°±å¯¹åº”RRç®—æ³•æˆ–è€…FIFOç®—æ³•çš„è°ƒåº¦ç­–ç•¥ï¼Œå…·ä½“è°ƒåº¦ç­–ç•¥ç”±è¿›ç¨‹çš„task_struct-&gt;policyæŒ‡å®šï¼›</p>\n</li>\n<li>\n<p>fair_sched_classå°±æ˜¯æ™®é€šè¿›ç¨‹çš„è°ƒåº¦ç­–ç•¥ï¼›</p>\n</li>\n<li>\n<p>idle_sched_classå°±æ˜¯ç©ºé—²è¿›ç¨‹çš„è°ƒåº¦ç­–ç•¥ã€‚</p>\n</li>\n</ul><p>è¿™é‡Œå®æ—¶è¿›ç¨‹çš„è°ƒåº¦ç­–ç•¥RRå’ŒFIFOç›¸å¯¹ç®€å•ä¸€äº›ï¼Œè€Œä¸”ç”±äºå’±ä»¬å¹³æ—¶å¸¸é‡åˆ°çš„éƒ½æ˜¯æ™®é€šè¿›ç¨‹ï¼Œåœ¨è¿™é‡Œï¼Œå’±ä»¬å°±é‡ç‚¹åˆ†ææ™®é€šè¿›ç¨‹çš„è°ƒåº¦é—®é¢˜ã€‚æ™®é€šè¿›ç¨‹ä½¿ç”¨çš„è°ƒåº¦ç­–ç•¥æ˜¯fair_sched_classï¼Œé¡¾åæ€ä¹‰ï¼Œå¯¹äºæ™®é€šè¿›ç¨‹æ¥è®²ï¼Œå…¬å¹³æ˜¯æœ€é‡è¦çš„ã€‚</p><h2>å®Œå…¨å…¬å¹³è°ƒåº¦ç®—æ³•</h2><p>åœ¨Linuxé‡Œé¢ï¼Œå®ç°äº†ä¸€ä¸ªåŸºäºCFSçš„è°ƒåº¦ç®—æ³•ã€‚CFSå…¨ç§°Completely Fair Schedulingï¼Œå«å®Œå…¨å…¬å¹³è°ƒåº¦ã€‚å¬èµ·æ¥å¾ˆâ€œå…¬å¹³â€ã€‚é‚£è¿™ä¸ªç®—æ³•çš„åŸç†æ˜¯ä»€ä¹ˆå‘¢ï¼Ÿæˆ‘ä»¬æ¥çœ‹çœ‹ã€‚</p><p>é¦–å…ˆï¼Œä½ éœ€è¦è®°å½•ä¸‹è¿›ç¨‹çš„è¿è¡Œæ—¶é—´ã€‚CPUä¼šæä¾›ä¸€ä¸ªæ—¶é’Ÿï¼Œè¿‡ä¸€æ®µæ—¶é—´å°±è§¦å‘ä¸€ä¸ªæ—¶é’Ÿä¸­æ–­ã€‚å°±åƒå’±ä»¬çš„è¡¨æ»´ç­”ä¸€ä¸‹ï¼Œè¿™ä¸ªæˆ‘ä»¬å«Tickã€‚CFSä¼šä¸ºæ¯ä¸€ä¸ªè¿›ç¨‹å®‰æ’ä¸€ä¸ªè™šæ‹Ÿè¿è¡Œæ—¶é—´vruntimeã€‚å¦‚æœä¸€ä¸ªè¿›ç¨‹åœ¨è¿è¡Œï¼Œéšç€æ—¶é—´çš„å¢é•¿ï¼Œä¹Ÿå°±æ˜¯ä¸€ä¸ªä¸ªtickçš„åˆ°æ¥ï¼Œè¿›ç¨‹çš„vruntimeå°†ä¸æ–­å¢å¤§ã€‚æ²¡æœ‰å¾—åˆ°æ‰§è¡Œçš„è¿›ç¨‹vruntimeä¸å˜ã€‚</p><p>æ˜¾ç„¶ï¼Œé‚£äº›vruntimeå°‘çš„ï¼ŒåŸæ¥å—åˆ°äº†ä¸å…¬å¹³çš„å¯¹å¾…ï¼Œéœ€è¦ç»™å®ƒè¡¥ä¸Šï¼Œæ‰€ä»¥ä¼šä¼˜å…ˆè¿è¡Œè¿™æ ·çš„è¿›ç¨‹ã€‚</p><p>è¿™æœ‰ç‚¹åƒè®©ä½ æŠŠä¸€ç­çƒå¹³å‡åˆ†åˆ°Nä¸ªå£è¢‹é‡Œé¢ï¼Œä½ çœ‹ç€å“ªä¸ªå°‘ï¼Œå°±å¤šæ”¾ä¸€äº›ï¼›å“ªä¸ªå¤šäº†ï¼Œå°±å…ˆä¸æ”¾ã€‚è¿™æ ·ç»è¿‡å¤šè½®ï¼Œè™½ç„¶ä¸èƒ½ä¿è¯çƒå®Œå…¨ä¸€æ ·å¤šï¼Œä½†æ˜¯ä¹Ÿå·®ä¸å¤šå…¬å¹³ã€‚</p><p>ä½ å¯èƒ½ä¼šè¯´ï¼Œä¸è¿˜æœ‰ä¼˜å…ˆçº§å‘¢ï¼Ÿå¦‚ä½•ç»™ä¼˜å…ˆçº§é«˜çš„è¿›ç¨‹å¤šåˆ†æ—¶é—´å‘¢ï¼Ÿ</p><p>è¿™ä¸ªç®€å•ï¼Œå°±ç›¸å½“äºNä¸ªå£è¢‹ï¼Œä¼˜å…ˆçº§é«˜çš„è¢‹å­å¤§ï¼Œä¼˜å…ˆçº§ä½çš„è¢‹å­å°ã€‚è¿™æ ·çƒå°±ä¸èƒ½æŒ‰ç…§ä¸ªæ•°åˆ†é…äº†ï¼Œè¦æŒ‰ç…§æ¯”ä¾‹æ¥ï¼Œå¤§å£è¢‹çš„æ”¾äº†ä¸€åŠå’Œå°å£è¢‹æ”¾äº†ä¸€åŠï¼Œé‡Œé¢çš„çƒæ•°ç›®è™½ç„¶å·®å¾ˆå¤šï¼Œä¹Ÿè®¤ä¸ºæ˜¯å…¬å¹³çš„ã€‚</p><p>åœ¨æ›´æ–°è¿›ç¨‹è¿è¡Œçš„ç»Ÿè®¡é‡çš„æ—¶å€™ï¼Œæˆ‘ä»¬å…¶å®å°±å¯ä»¥çœ‹å‡ºè¿™ä¸ªé€»è¾‘ã€‚</p><pre><code>/*\n * Update the current task's runtime statistics.\n */\nstatic void update_curr(struct cfs_rq *cfs_rq)\n{\n\tstruct sched_entity *curr = cfs_rq-&gt;curr;\n\tu64 now = rq_clock_task(rq_of(cfs_rq));\n\tu64 delta_exec;\n......\n\tdelta_exec = now - curr-&gt;exec_start;\n......\n\tcurr-&gt;exec_start = now;\n......\n\tcurr-&gt;sum_exec_runtime += delta_exec;\n......\n\tcurr-&gt;vruntime += calc_delta_fair(delta_exec, curr);\n\tupdate_min_vruntime(cfs_rq);\n......\n}\n\n\n/*\n * delta /= w\n */\nstatic inline u64 calc_delta_fair(u64 delta, struct sched_entity *se)\n{\n\tif (unlikely(se-&gt;load.weight != NICE_0_LOAD))\n        /* delta_exec * weight / lw.weight */\n\t\tdelta = __calc_delta(delta, NICE_0_LOAD, &amp;se-&gt;load);\n\treturn delta;\n}\n</code></pre><p>åœ¨è¿™é‡Œå¾—åˆ°å½“å‰çš„æ—¶é—´ï¼Œä»¥åŠè¿™æ¬¡çš„æ—¶é—´ç‰‡å¼€å§‹çš„æ—¶é—´ï¼Œä¸¤è€…ç›¸å‡å°±æ˜¯è¿™æ¬¡è¿è¡Œçš„æ—¶é—´delta_exec ï¼Œä½†æ˜¯å¾—åˆ°çš„è¿™ä¸ªæ—¶é—´å…¶å®æ˜¯å®é™…è¿è¡Œçš„æ—¶é—´ï¼Œéœ€è¦åšä¸€å®šçš„è½¬åŒ–æ‰ä½œä¸ºè™šæ‹Ÿè¿è¡Œæ—¶é—´vruntimeã€‚è½¬åŒ–æ–¹æ³•å¦‚ä¸‹ï¼š</p><center>è™šæ‹Ÿè¿è¡Œæ—¶é—´vruntime += å®é™…è¿è¡Œæ—¶é—´delta_exec * NICE_0_LOAD/æƒé‡</center><p>è¿™å°±æ˜¯è¯´ï¼ŒåŒæ ·çš„å®é™…è¿è¡Œæ—¶é—´ï¼Œç»™é«˜æƒé‡çš„ç®—å°‘äº†ï¼Œä½æƒé‡çš„ç®—å¤šäº†ï¼Œä½†æ˜¯å½“é€‰å–ä¸‹ä¸€ä¸ªè¿è¡Œè¿›ç¨‹çš„æ—¶å€™ï¼Œè¿˜æ˜¯æŒ‰ç…§æœ€å°çš„vruntimeæ¥çš„ï¼Œè¿™æ ·é«˜æƒé‡çš„è·å¾—çš„å®é™…è¿è¡Œæ—¶é—´è‡ªç„¶å°±å¤šäº†ã€‚è¿™å°±ç›¸å½“äºç»™ä¸€ä¸ªä½“é‡(æƒé‡)200æ–¤çš„èƒ–å­åƒä¸¤ä¸ªé¦’å¤´ï¼Œå’Œç»™ä¸€ä¸ªä½“é‡100æ–¤çš„ç˜¦å­åƒä¸€ä¸ªé¦’å¤´ï¼Œç„¶åè¯´ï¼Œä½ ä»¬ä¸¤ä¸ªåƒçš„æ˜¯ä¸€æ ·å¤šã€‚è¿™æ ·è™½ç„¶æ€»ä½“èƒ–å­æ¯”ç˜¦å­å¤šåƒäº†ä¸€å€ï¼Œä½†æ˜¯è¿˜æ˜¯å…¬å¹³çš„ã€‚</p><h2>è°ƒåº¦é˜Ÿåˆ—ä¸è°ƒåº¦å®ä½“</h2><p>çœ‹æ¥CFSéœ€è¦ä¸€ä¸ªæ•°æ®ç»“æ„æ¥å¯¹vruntimeè¿›è¡Œæ’åºï¼Œæ‰¾å‡ºæœ€å°çš„é‚£ä¸ªã€‚è¿™ä¸ªèƒ½å¤Ÿæ’åºçš„æ•°æ®ç»“æ„ä¸ä½†éœ€è¦æŸ¥è¯¢çš„æ—¶å€™ï¼Œèƒ½å¤Ÿå¿«é€Ÿæ‰¾åˆ°æœ€å°çš„ï¼Œæ›´æ–°çš„æ—¶å€™ä¹Ÿéœ€è¦èƒ½å¤Ÿå¿«é€Ÿåœ°è°ƒæ•´æ’åºï¼Œè¦çŸ¥é“vruntimeå¯æ˜¯ç»å¸¸åœ¨å˜çš„ï¼Œå˜äº†å†æ’å…¥è¿™ä¸ªæ•°æ®ç»“æ„ï¼Œå°±éœ€è¦é‡æ–°æ’åºã€‚</p><p>èƒ½å¤Ÿå¹³è¡¡æŸ¥è¯¢å’Œæ›´æ–°é€Ÿåº¦çš„æ˜¯æ ‘ï¼Œåœ¨è¿™é‡Œä½¿ç”¨çš„æ˜¯çº¢é»‘æ ‘ã€‚</p><p>çº¢é»‘æ ‘çš„çš„èŠ‚ç‚¹æ˜¯åº”è¯¥åŒ…æ‹¬vruntimeçš„ï¼Œç§°ä¸ºè°ƒåº¦å®ä½“ã€‚</p><p>åœ¨task_structä¸­æœ‰è¿™æ ·çš„æˆå‘˜å˜é‡ï¼š</p><p>struct sched_entity se;<br>\nstruct sched_rt_entity rt;<br>\nstruct sched_dl_entity dl;</p><p>è¿™é‡Œæœ‰å®æ—¶è°ƒåº¦å®ä½“sched_rt_entityï¼ŒDeadlineè°ƒåº¦å®ä½“sched_dl_entityï¼Œä»¥åŠå®Œå…¨å…¬å¹³ç®—æ³•è°ƒåº¦å®ä½“sched_entityã€‚</p><p>çœ‹æ¥ä¸å…‰CFSè°ƒåº¦ç­–ç•¥éœ€è¦æœ‰è¿™æ ·ä¸€ä¸ªæ•°æ®ç»“æ„è¿›è¡Œæ’åºï¼Œå…¶ä»–çš„è°ƒåº¦ç­–ç•¥ä¹ŸåŒæ ·æœ‰è‡ªå·±çš„æ•°æ®ç»“æ„è¿›è¡Œæ’åºï¼Œå› ä¸ºä»»ä½•ä¸€ä¸ªç­–ç•¥åšè°ƒåº¦çš„æ—¶å€™ï¼Œéƒ½æ˜¯è¦åŒºåˆ†è°å…ˆè¿è¡Œè°åè¿è¡Œã€‚</p><p>è€Œè¿›ç¨‹æ ¹æ®è‡ªå·±æ˜¯å®æ—¶çš„ï¼Œè¿˜æ˜¯æ™®é€šçš„ç±»å‹ï¼Œé€šè¿‡è¿™ä¸ªæˆå‘˜å˜é‡ï¼Œå°†è‡ªå·±æŒ‚åœ¨æŸä¸€ä¸ªæ•°æ®ç»“æ„é‡Œé¢ï¼Œå’Œå…¶ä»–çš„è¿›ç¨‹æ’åºï¼Œç­‰å¾…è¢«è°ƒåº¦ã€‚å¦‚æœè¿™ä¸ªè¿›ç¨‹æ˜¯ä¸ªæ™®é€šè¿›ç¨‹ï¼Œåˆ™é€šè¿‡sched_entityï¼Œå°†è‡ªå·±æŒ‚åœ¨è¿™æ£µçº¢é»‘æ ‘ä¸Šã€‚</p><p>å¯¹äºæ™®é€šè¿›ç¨‹çš„è°ƒåº¦å®ä½“å®šä¹‰å¦‚ä¸‹ï¼Œè¿™é‡Œé¢åŒ…å«äº†vruntimeå’Œæƒé‡load_weightï¼Œä»¥åŠå¯¹äºè¿è¡Œæ—¶é—´çš„ç»Ÿè®¡ã€‚</p><pre><code>struct sched_entity {\n\tstruct load_weight\t\tload;\n\tstruct rb_node\t\t\trun_node;\n\tstruct list_head\t\tgroup_node;\n\tunsigned int\t\t\ton_rq;\n\tu64\t\t\t\texec_start;\n\tu64\t\t\t\tsum_exec_runtime;\n\tu64\t\t\t\tvruntime;\n\tu64\t\t\t\tprev_sum_exec_runtime;\n\tu64\t\t\t\tnr_migrations;\n\tstruct sched_statistics\t\tstatistics;\n......\n};\n</code></pre><p>ä¸‹å›¾æ˜¯ä¸€ä¸ªçº¢é»‘æ ‘çš„ä¾‹å­ã€‚</p><p><img src=\"https://static001.geekbang.org/resource/image/c2/93/c2b86e79f19d811ce10774688fc0c093.jpeg?wh=2849*1814\" alt=\"\"></p><p>æ‰€æœ‰å¯è¿è¡Œçš„è¿›ç¨‹é€šè¿‡ä¸æ–­åœ°æ’å…¥æ“ä½œæœ€ç»ˆéƒ½å­˜å‚¨åœ¨ä»¥æ—¶é—´ä¸ºé¡ºåºçš„çº¢é»‘æ ‘ä¸­ï¼Œvruntimeæœ€å°çš„åœ¨æ ‘çš„å·¦ä¾§ï¼Œvruntimeæœ€å¤šçš„åœ¨æ ‘çš„å³ä¾§ã€‚ CFSè°ƒåº¦ç­–ç•¥ä¼šé€‰æ‹©çº¢é»‘æ ‘æœ€å·¦è¾¹çš„å¶å­èŠ‚ç‚¹ä½œä¸ºä¸‹ä¸€ä¸ªå°†è·å¾—CPUçš„ä»»åŠ¡ã€‚</p><p>è¿™æ£µçº¢é»‘æ ‘æ”¾åœ¨å“ªé‡Œå‘¢ï¼Ÿå°±åƒæ¯ä¸ªè½¯ä»¶å·¥ç¨‹å¸ˆå†™ä»£ç çš„æ—¶å€™ï¼Œä¼šå°†ä»»åŠ¡æ’æˆé˜Ÿåˆ—ï¼Œåšå®Œä¸€ä¸ªåšä¸‹ä¸€ä¸ªã€‚</p><p>CPUä¹Ÿæ˜¯è¿™æ ·çš„ï¼Œæ¯ä¸ªCPUéƒ½æœ‰è‡ªå·±çš„ struct rq ç»“æ„ï¼Œå…¶ç”¨äºæè¿°åœ¨æ­¤CPUä¸Šæ‰€è¿è¡Œçš„æ‰€æœ‰è¿›ç¨‹ï¼Œå…¶åŒ…æ‹¬ä¸€ä¸ªå®æ—¶è¿›ç¨‹é˜Ÿåˆ—rt_rqå’Œä¸€ä¸ªCFSè¿è¡Œé˜Ÿåˆ—cfs_rqï¼Œåœ¨è°ƒåº¦æ—¶ï¼Œè°ƒåº¦å™¨é¦–å…ˆä¼šå…ˆå»å®æ—¶è¿›ç¨‹é˜Ÿåˆ—æ‰¾æ˜¯å¦æœ‰å®æ—¶è¿›ç¨‹éœ€è¦è¿è¡Œï¼Œå¦‚æœæ²¡æœ‰æ‰ä¼šå»CFSè¿è¡Œé˜Ÿåˆ—æ‰¾æ˜¯å¦æœ‰è¿›ç¨‹éœ€è¦è¿è¡Œã€‚</p><pre><code>struct rq {\n\t/* runqueue lock: */\n\traw_spinlock_t lock;\n\tunsigned int nr_running;\n\tunsigned long cpu_load[CPU_LOAD_IDX_MAX];\n......\n\tstruct load_weight load;\n\tunsigned long nr_load_updates;\n\tu64 nr_switches;\n\n\n\tstruct cfs_rq cfs;\n\tstruct rt_rq rt;\n\tstruct dl_rq dl;\n......\n\tstruct task_struct *curr, *idle, *stop;\n......\n};\n</code></pre><p>å¯¹äºæ™®é€šè¿›ç¨‹å…¬å¹³é˜Ÿåˆ—cfs_rqï¼Œå®šä¹‰å¦‚ä¸‹ï¼š</p><pre><code>/* CFS-related fields in a runqueue */\nstruct cfs_rq {\n\tstruct load_weight load;\n\tunsigned int nr_running, h_nr_running;\n\n\n\tu64 exec_clock;\n\tu64 min_vruntime;\n#ifndef CONFIG_64BIT\n\tu64 min_vruntime_copy;\n#endif\n\tstruct rb_root tasks_timeline;\n\tstruct rb_node *rb_leftmost;\n\n\n\tstruct sched_entity *curr, *next, *last, *skip;\n......\n};\n</code></pre><p>è¿™é‡Œé¢rb_rootæŒ‡å‘çš„å°±æ˜¯çº¢é»‘æ ‘çš„æ ¹èŠ‚ç‚¹ï¼Œè¿™ä¸ªçº¢é»‘æ ‘åœ¨CPUçœ‹èµ·æ¥å°±æ˜¯ä¸€ä¸ªé˜Ÿåˆ—ï¼Œä¸æ–­åœ°å–ä¸‹ä¸€ä¸ªåº”è¯¥è¿è¡Œçš„è¿›ç¨‹ã€‚rb_leftmostæŒ‡å‘çš„æ˜¯æœ€å·¦é¢çš„èŠ‚ç‚¹ã€‚</p><p>åˆ°è¿™é‡Œç»ˆäºå‡‘å¤Ÿæ•°æ®ç»“æ„äº†ï¼Œä¸Šé¢è¿™äº›æ•°æ®ç»“æ„çš„å…³ç³»å¦‚ä¸‹å›¾ï¼š</p><p><img src=\"https://static001.geekbang.org/resource/image/ac/fd/ac043a08627b40b85e624477d937f3fd.jpeg?wh=3722*1727\" alt=\"\"></p><h2>è°ƒåº¦ç±»æ˜¯å¦‚ä½•å·¥ä½œçš„ï¼Ÿ</h2><p>å‡‘å¤Ÿäº†æ•°æ®ç»“æ„ï¼Œæ¥ä¸‹æ¥æˆ‘ä»¬æ¥çœ‹è°ƒåº¦ç±»æ˜¯å¦‚ä½•å·¥ä½œçš„ã€‚</p><p>è°ƒåº¦ç±»çš„å®šä¹‰å¦‚ä¸‹ï¼š</p><pre><code>struct sched_class {\n\tconst struct sched_class *next;\n\n\n\tvoid (*enqueue_task) (struct rq *rq, struct task_struct *p, int flags);\n\tvoid (*dequeue_task) (struct rq *rq, struct task_struct *p, int flags);\n\tvoid (*yield_task) (struct rq *rq);\n\tbool (*yield_to_task) (struct rq *rq, struct task_struct *p, bool preempt);\n\n\n\tvoid (*check_preempt_curr) (struct rq *rq, struct task_struct *p, int flags);\n\n\n\tstruct task_struct * (*pick_next_task) (struct rq *rq,\n\t\t\t\t\t\tstruct task_struct *prev,\n\t\t\t\t\t\tstruct rq_flags *rf);\n\tvoid (*put_prev_task) (struct rq *rq, struct task_struct *p);\n\n\n\tvoid (*set_curr_task) (struct rq *rq);\n\tvoid (*task_tick) (struct rq *rq, struct task_struct *p, int queued);\n\tvoid (*task_fork) (struct task_struct *p);\n\tvoid (*task_dead) (struct task_struct *p);\n\n\n\tvoid (*switched_from) (struct rq *this_rq, struct task_struct *task);\n\tvoid (*switched_to) (struct rq *this_rq, struct task_struct *task);\n\tvoid (*prio_changed) (struct rq *this_rq, struct task_struct *task, int oldprio);\n\tunsigned int (*get_rr_interval) (struct rq *rq,\n\t\t\t\t\t struct task_struct *task);\n\tvoid (*update_curr) (struct rq *rq)\n</code></pre><p>è¿™ä¸ªç»“æ„å®šä¹‰äº†å¾ˆå¤šç§æ–¹æ³•ï¼Œç”¨äºåœ¨é˜Ÿåˆ—ä¸Šæ“ä½œä»»åŠ¡ã€‚è¿™é‡Œè¯·å¤§å®¶æ³¨æ„ç¬¬ä¸€ä¸ªæˆå‘˜å˜é‡ï¼Œæ˜¯ä¸€ä¸ªæŒ‡é’ˆï¼ŒæŒ‡å‘ä¸‹ä¸€ä¸ªè°ƒåº¦ç±»ã€‚</p><p>ä¸Šé¢æˆ‘ä»¬è®²äº†ï¼Œè°ƒåº¦ç±»åˆ†ä¸ºä¸‹é¢è¿™å‡ ç§ï¼š</p><pre><code>extern const struct sched_class stop_sched_class;\nextern const struct sched_class dl_sched_class;\nextern const struct sched_class rt_sched_class;\nextern const struct sched_class fair_sched_class;\nextern const struct sched_class idle_sched_class;\n</code></pre><p>å®ƒä»¬å…¶å®æ˜¯æ”¾åœ¨ä¸€ä¸ªé“¾è¡¨ä¸Šçš„ã€‚è¿™é‡Œæˆ‘ä»¬ä»¥è°ƒåº¦æœ€å¸¸è§çš„æ“ä½œï¼Œ<strong>å–ä¸‹ä¸€ä¸ªä»»åŠ¡</strong>ä¸ºä¾‹ï¼Œæ¥è§£æä¸€ä¸‹ã€‚å¯ä»¥çœ‹åˆ°ï¼Œè¿™é‡Œé¢æœ‰ä¸€ä¸ªfor_each_classå¾ªç¯ï¼Œæ²¿ç€ä¸Šé¢çš„é¡ºåºï¼Œä¾æ¬¡è°ƒç”¨æ¯ä¸ªè°ƒåº¦ç±»çš„æ–¹æ³•ã€‚</p><pre><code>/*\n * Pick up the highest-prio task:\n */\nstatic inline struct task_struct *\npick_next_task(struct rq *rq, struct task_struct *prev, struct rq_flags *rf)\n{\n\tconst struct sched_class *class;\n\tstruct task_struct *p;\n......\n\tfor_each_class(class) {\n\t\tp = class-&gt;pick_next_task(rq, prev, rf);\n\t\tif (p) {\n\t\t\tif (unlikely(p == RETRY_TASK))\n\t\t\t\tgoto again;\n\t\t\treturn p;\n\t\t}\n\t}\n}\n</code></pre><p>è¿™å°±è¯´æ˜ï¼Œè°ƒåº¦çš„æ—¶å€™æ˜¯ä»ä¼˜å…ˆçº§æœ€é«˜çš„è°ƒåº¦ç±»åˆ°ä¼˜å…ˆçº§ä½çš„è°ƒåº¦ç±»ï¼Œä¾æ¬¡æ‰§è¡Œã€‚è€Œå¯¹äºæ¯ç§è°ƒåº¦ç±»ï¼Œæœ‰è‡ªå·±çš„å®ç°ï¼Œä¾‹å¦‚ï¼ŒCFSå°±æœ‰fair_sched_classã€‚</p><pre><code>const struct sched_class fair_sched_class = {\n\t.next\t\t\t= &amp;idle_sched_class,\n\t.enqueue_task\t\t= enqueue_task_fair,\n\t.dequeue_task\t\t= dequeue_task_fair,\n\t.yield_task\t\t= yield_task_fair,\n\t.yield_to_task\t\t= yield_to_task_fair,\n\t.check_preempt_curr\t= check_preempt_wakeup,\n\t.pick_next_task\t\t= pick_next_task_fair,\n\t.put_prev_task\t\t= put_prev_task_fair,\n\t.set_curr_task          = set_curr_task_fair,\n\t.task_tick\t\t= task_tick_fair,\n\t.task_fork\t\t= task_fork_fair,\n\t.prio_changed\t\t= prio_changed_fair,\n\t.switched_from\t\t= switched_from_fair,\n\t.switched_to\t\t= switched_to_fair,\n\t.get_rr_interval\t= get_rr_interval_fair,\n\t.update_curr\t\t= update_curr_fair,\n};\n</code></pre><p>å¯¹äºåŒæ ·çš„pick_next_taské€‰å–ä¸‹ä¸€ä¸ªè¦è¿è¡Œçš„ä»»åŠ¡è¿™ä¸ªåŠ¨ä½œï¼Œä¸åŒçš„è°ƒåº¦ç±»æœ‰è‡ªå·±çš„å®ç°ã€‚fair_sched_classçš„å®ç°æ˜¯pick_next_task_fairï¼Œrt_sched_classçš„å®ç°æ˜¯pick_next_task_rtã€‚</p><p>æˆ‘ä»¬ä¼šå‘ç°è¿™ä¸¤ä¸ªå‡½æ•°æ˜¯æ“ä½œä¸åŒçš„é˜Ÿåˆ—ï¼Œpick_next_task_rtæ“ä½œçš„æ˜¯rt_rqï¼Œpick_next_task_fairæ“ä½œçš„æ˜¯cfs_rqã€‚</p><pre><code>static struct task_struct *\npick_next_task_rt(struct rq *rq, struct task_struct *prev, struct rq_flags *rf)\n{\n\tstruct task_struct *p;\n\tstruct rt_rq *rt_rq = &amp;rq-&gt;rt;\n......\n}\n\n\nstatic struct task_struct *\npick_next_task_fair(struct rq *rq, struct task_struct *prev, struct rq_flags *rf)\n{\n\tstruct cfs_rq *cfs_rq = &amp;rq-&gt;cfs;\n\tstruct sched_entity *se;\n\tstruct task_struct *p;\n......\n}\n</code></pre><p>è¿™æ ·æ•´ä¸ªè¿è¡Œçš„åœºæ™¯å°±ä¸²èµ·æ¥äº†ï¼Œåœ¨æ¯ä¸ªCPUä¸Šéƒ½æœ‰ä¸€ä¸ªé˜Ÿåˆ—rqï¼Œè¿™ä¸ªé˜Ÿåˆ—é‡Œé¢åŒ…å«å¤šä¸ªå­é˜Ÿåˆ—ï¼Œä¾‹å¦‚rt_rqå’Œcfs_rqï¼Œä¸åŒçš„é˜Ÿåˆ—æœ‰ä¸åŒçš„å®ç°æ–¹å¼ï¼Œcfs_rqå°±æ˜¯ç”¨çº¢é»‘æ ‘å®ç°çš„ã€‚</p><p>å½“æœ‰ä¸€å¤©ï¼ŒæŸä¸ªCPUéœ€è¦æ‰¾ä¸‹ä¸€ä¸ªä»»åŠ¡æ‰§è¡Œçš„æ—¶å€™ï¼Œä¼šæŒ‰ç…§ä¼˜å…ˆçº§ä¾æ¬¡è°ƒç”¨è°ƒåº¦ç±»ï¼Œä¸åŒçš„è°ƒåº¦ç±»æ“ä½œä¸åŒçš„é˜Ÿåˆ—ã€‚å½“ç„¶rt_sched_classå…ˆè¢«è°ƒç”¨ï¼Œå®ƒä¼šåœ¨rt_rqä¸Šæ‰¾ä¸‹ä¸€ä¸ªä»»åŠ¡ï¼Œåªæœ‰æ‰¾ä¸åˆ°çš„æ—¶å€™ï¼Œæ‰è½®åˆ°fair_sched_classè¢«è°ƒç”¨ï¼Œå®ƒä¼šåœ¨cfs_rqä¸Šæ‰¾ä¸‹ä¸€ä¸ªä»»åŠ¡ã€‚è¿™æ ·ä¿è¯äº†å®æ—¶ä»»åŠ¡çš„ä¼˜å…ˆçº§æ°¸è¿œå¤§äºæ™®é€šä»»åŠ¡ã€‚</p><p>ä¸‹é¢æˆ‘ä»¬ä»”ç»†çœ‹ä¸€ä¸‹sched_classå®šä¹‰çš„ä¸è°ƒåº¦æœ‰å…³çš„å‡½æ•°ã€‚</p><ul>\n<li>\n<p>enqueue_taskå‘å°±ç»ªé˜Ÿåˆ—ä¸­æ·»åŠ ä¸€ä¸ªè¿›ç¨‹ï¼Œå½“æŸä¸ªè¿›ç¨‹è¿›å…¥å¯è¿è¡ŒçŠ¶æ€æ—¶ï¼Œè°ƒç”¨è¿™ä¸ªå‡½æ•°ï¼›</p>\n</li>\n<li>\n<p>dequeue_task å°†ä¸€ä¸ªè¿›ç¨‹ä»å°±ç»ªé˜Ÿåˆ—ä¸­åˆ é™¤ï¼›</p>\n</li>\n<li>\n<p>pick_next_task é€‰æ‹©æ¥ä¸‹æ¥è¦è¿è¡Œçš„è¿›ç¨‹ï¼›</p>\n</li>\n<li>\n<p>put_prev_task ç”¨å¦ä¸€ä¸ªè¿›ç¨‹ä»£æ›¿å½“å‰è¿è¡Œçš„è¿›ç¨‹ï¼›</p>\n</li>\n<li>\n<p>set_curr_task ç”¨äºä¿®æ”¹è°ƒåº¦ç­–ç•¥ï¼›</p>\n</li>\n<li>\n<p>task_tick æ¯æ¬¡å‘¨æœŸæ€§æ—¶é’Ÿåˆ°çš„æ—¶å€™ï¼Œè¿™ä¸ªå‡½æ•°è¢«è°ƒç”¨ï¼Œå¯èƒ½è§¦å‘è°ƒåº¦ã€‚</p>\n</li>\n</ul><p>åœ¨è¿™é‡Œé¢ï¼Œæˆ‘ä»¬é‡ç‚¹çœ‹fair_sched_classå¯¹äºpick_next_taskçš„å®ç°pick_next_task_fairï¼Œè·å–ä¸‹ä¸€ä¸ªè¿›ç¨‹ã€‚è°ƒç”¨è·¯å¾„å¦‚ä¸‹ï¼špick_next_task_fair-&gt;pick_next_entity-&gt;__pick_first_entityã€‚</p><pre><code>struct sched_entity *__pick_first_entity(struct cfs_rq *cfs_rq)\n{\n\tstruct rb_node *left = rb_first_cached(&amp;cfs_rq-&gt;tasks_timeline);\n\n\n\tif (!left)\n\t\treturn NULL;\n\n\n\treturn rb_entry(left, struct sched_entity, run_node);\n</code></pre><p>ä»è¿™ä¸ªå‡½æ•°çš„å®ç°å¯ä»¥çœ‹å‡ºï¼Œå°±æ˜¯ä»çº¢é»‘æ ‘é‡Œé¢å–æœ€å·¦é¢çš„èŠ‚ç‚¹ã€‚</p><h2>æ€»ç»“æ—¶åˆ»</h2><p>å¥½äº†ï¼Œè¿™ä¸€èŠ‚æˆ‘ä»¬è®²äº†è°ƒåº¦ç›¸å…³çš„æ•°æ®ç»“æ„ï¼Œè¿˜æ˜¯æ¯”è¾ƒå¤æ‚çš„ã€‚ä¸€ä¸ªCPUä¸Šæœ‰ä¸€ä¸ªé˜Ÿåˆ—ï¼ŒCFSçš„é˜Ÿåˆ—æ˜¯ä¸€æ£µçº¢é»‘æ ‘ï¼Œæ ‘çš„æ¯ä¸€ä¸ªèŠ‚ç‚¹éƒ½æ˜¯ä¸€ä¸ªsched_entityï¼Œæ¯ä¸ªsched_entityéƒ½å±äºä¸€ä¸ªtask_structï¼Œtask_structé‡Œé¢æœ‰æŒ‡é’ˆæŒ‡å‘è¿™ä¸ªè¿›ç¨‹å±äºå“ªä¸ªè°ƒåº¦ç±»ã€‚</p><p><img src=\"https://static001.geekbang.org/resource/image/10/af/10381dbafe0f78d80beb87560a9506af.jpeg?wh=2519*2072\" alt=\"\"></p><p>åœ¨è°ƒåº¦çš„æ—¶å€™ï¼Œä¾æ¬¡è°ƒç”¨è°ƒåº¦ç±»çš„å‡½æ•°ï¼Œä»CPUçš„é˜Ÿåˆ—ä¸­å–å‡ºä¸‹ä¸€ä¸ªè¿›ç¨‹ã€‚ä¸Šé¢å›¾ä¸­çš„è°ƒåº¦å™¨ã€ä¸Šä¸‹æ–‡åˆ‡æ¢è¿™ä¸€èŠ‚æˆ‘ä»¬æ²¡æœ‰è®²ï¼Œä¸‹ä¸€èŠ‚æˆ‘ä»¬è®²è®²åŸºäºè¿™äº›æ•°æ®ç»“æ„ï¼Œå¦‚ä½•å®ç°è°ƒåº¦ã€‚</p><h2>è¯¾å ‚ç»ƒä¹ </h2><p>è¿™é‡Œè®²äº†è¿›ç¨‹è°ƒåº¦çš„ç­–ç•¥å’Œç®—æ³•ï¼Œä½ çŸ¥é“å¦‚ä½•é€šè¿‡APIè®¾ç½®è¿›ç¨‹å’Œçº¿ç¨‹çš„è°ƒåº¦ç­–ç•¥å—ï¼Ÿä½ å¯ä»¥å†™ä¸ªç¨‹åºå°è¯•ä¸€ä¸‹ã€‚</p><p>æ¬¢è¿ç•™è¨€å’Œæˆ‘åˆ†äº«ä½ çš„ç–‘æƒ‘å’Œè§è§£ï¼Œä¹Ÿæ¬¢è¿ä½ æ”¶è—æœ¬èŠ‚å†…å®¹ï¼Œ<span class=\"orange\">åå¤ç ”è¯»</span>ã€‚ä½ ä¹Ÿå¯ä»¥æŠŠä»Šå¤©çš„å†…å®¹åˆ†äº«ç»™ä½ çš„æœ‹å‹ï¼Œå’Œä»–ä¸€èµ·å­¦ä¹ ã€è¿›æ­¥ã€‚</p><p><img src=\"https://static001.geekbang.org/resource/image/8c/37/8c0a95fa07a8b9a1abfd394479bdd637.jpg?wh=1110*659\" alt=\"\"></p>","comments":[{"had_liked":false,"id":90881,"user_name":"why","can_delete":false,"product_type":"c1","uid":1012937,"ip_address":"","ucode":"C9E796E53F6F5E","user_header":"https://static001.geekbang.org/account/avatar/00/0f/74/c9/d3439ca4.jpg","comment_is_top":false,"comment_ctime":1556706942,"is_pvip":false,"discussion_count":2,"race_medal":0,"score":"400988665470","product_id":100024701,"comment_content":"- è°ƒåº¦ç­–ç•¥ä¸è°ƒåº¦ç±»<br>\t- è¿›ç¨‹åŒ…æ‹¬ä¸¤ç±»: å®æ—¶è¿›ç¨‹(ä¼˜å…ˆçº§é«˜); æ™®é€šè¿›ç¨‹<br>\t- ä¸¤ç§è¿›ç¨‹è°ƒåº¦ç­–ç•¥ä¸åŒ: task_struct-&gt;policy æŒ‡æ˜é‡‡ç”¨å“ªç§è°ƒåº¦ç­–ç•¥(æœ‰6ç§ç­–ç•¥)<br>\t- ä¼˜å…ˆçº§é…åˆè°ƒåº¦ç­–ç•¥, å®æ—¶è¿›ç¨‹(0-99); æ™®é€šè¿›ç¨‹(100-139)<br>\t- å®æ—¶è°ƒåº¦ç­–ç•¥, é«˜ä¼˜å…ˆçº§å¯æŠ¢å ä½ä¼˜å…ˆçº§è¿›ç¨‹<br>\t\t- FIFO: ç›¸åŒä¼˜å…ˆçº§è¿›ç¨‹å…ˆæ¥å…ˆå¾—<br>\t\t- RR: è½®æµè°ƒåº¦ç­–ç•¥, é‡‡ç”¨æ—¶é—´ç‰‡è½®æµè°ƒåº¦ç›¸åŒä¼˜å…ˆçº§è¿›ç¨‹<br>\t\t- Deadline: åœ¨è°ƒåº¦æ—¶, é€‰æ‹© deadline æœ€è¿‘çš„è¿›ç¨‹<br>\t- æ™®é€šè°ƒåº¦ç­–ç•¥<br>\t\t- normal: æ™®é€šè¿›ç¨‹<br>\t\t- batch: åå°è¿›ç¨‹, å¯ä»¥é™ä½ä¼˜å…ˆçº§<br>\t\t- idle: ç©ºé—²æ—¶æ‰è¿è¡Œ<br>\t- è°ƒåº¦ç±»: task_struct ä¸­ * sched_class æŒ‡å‘å°è£…äº†è°ƒåº¦ç­–ç•¥æ‰§è¡Œé€»è¾‘çš„ç±»(æœ‰5ç§)<br>\t\t- stop: ä¼˜å…ˆçº§æœ€é«˜. å°†ä¸­æ–­å…¶ä»–æ‰€æœ‰è¿›ç¨‹, ä¸”ä¸èƒ½è¢«æ‰“æ–­<br>\t\t- dl: å®ç° deadline è°ƒåº¦ç­–ç•¥<br>\t\t- rt: RR æˆ– FIFO, å…·ä½“ç­–ç•¥ç”± task_struct-&gt;policy æŒ‡å®š<br>\t\t- fair: æ™®é€šè¿›ç¨‹è°ƒåº¦<br>\t\t- idle: ç©ºé—²è¿›ç¨‹è°ƒåº¦<br>- æ™®é€šè¿›ç¨‹çš„ fair å®Œå…¨å…¬å¹³è°ƒåº¦ç®—æ³• CFS(Linux å®ç°)<br>\t- è®°å½•è¿›ç¨‹è¿è¡Œæ—¶é—´( vruntime è™šæ‹Ÿè¿è¡Œæ—¶é—´)<br>\t- ä¼˜å…ˆè°ƒåº¦ vruntime å°çš„è¿›ç¨‹<br>\t- æŒ‰ç…§æ¯”ä¾‹ç´¯è®¡ vruntime, ä½¿ä¹‹è€ƒè™‘è¿›ä¼˜å…ˆçº§å…³ç³»<br>- è°ƒåº¦é˜Ÿåˆ—å’Œè°ƒåº¦å®ä½“<br>\t- CFS ä¸­éœ€è¦å¯¹ vruntime æ’åºæ‰¾æœ€å°, ä¸æ–­æŸ¥è¯¢æ›´æ–°, å› æ­¤åˆ©ç”¨çº¢é»‘æ ‘å®ç°è°ƒåº¦é˜Ÿåˆ—<br>\t- task_struct ä¸­æœ‰ å®æ—¶, deadline å’Œ cfs ä¸‰ä¸ªè°ƒåº¦å®ä½“, cfs è°ƒåº¦å®ä½“å³çº¢é»‘æ ‘èŠ‚ç‚¹<br>\t- æ¯ä¸ª CPU éƒ½æœ‰ rq ç»“æ„ä½“, é‡Œé¢æœ‰ dl_rq, rt_rq å’Œ cfs_rq ä¸‰ä¸ªè°ƒåº¦é˜Ÿåˆ—ä»¥åŠå…¶ä»–ä¿¡æ¯; é˜Ÿåˆ—æè¿°è¯¥ CPU æ‰€è¿è¡Œçš„æ‰€æœ‰è¿›ç¨‹<br>\t- å…ˆåœ¨ rt_rq ä¸­æ‰¾è¿›ç¨‹è¿è¡Œ, è‹¥æ²¡æœ‰å†åˆ° cfs_rq ä¸­æ‰¾; cfs_rq ä¸­ rb_root æŒ‡å‘çº¢é»‘æ ‘æ ¹èŠ‚ç‚¹, rb_leftmostæŒ‡å‘æœ€å·¦èŠ‚ç‚¹<br>- è°ƒåº¦ç±»å¦‚ä½•å·¥ä½œ<br>\t- è°ƒåº¦ç±»ä¸­æœ‰ä¸€ä¸ªæˆå‘˜æŒ‡å‘ä¸‹ä¸€ä¸ªè°ƒåº¦ç±»(æŒ‰ä¼˜å…ˆçº§é¡ºåºä¸²èµ·æ¥)<br>\t- æ‰¾ä¸‹ä¸€ä¸ªè¿è¡Œä»»åŠ¡æ—¶, æŒ‰ stop-dl-rt-fair-idle ä¾æ¬¡è°ƒç”¨è°ƒåº¦ç±», ä¸åŒè°ƒåº¦ç±»æ“ä½œä¸åŒè°ƒåº¦é˜Ÿåˆ—<br>","like_count":94,"discussions":[{"author":{"id":1968013,"avatar":"https://static001.geekbang.org/account/avatar/00/1e/07/8d/3e76560f.jpg","nickname":"ç‹å»ºå³°","note":"","ucode":"8BF1AEFFA7EA5F","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":374465,"discussion_content":"ç‰¹åˆ«æ£’","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1621206029,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1116317,"avatar":"https://static001.geekbang.org/account/avatar/00/11/08/9d/9dd3257c.jpg","nickname":"å¤§è„¸çŒ«","note":"","ucode":"B63DA3852CF9EB","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":315408,"discussion_content":"ç¬”è®°å°±é ä½ äº†å“¥ä»¬","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1603271176,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":93896,"user_name":"æ‹¾è´å£³çš„å­©å­","can_delete":false,"product_type":"c1","uid":1054038,"ip_address":"","ucode":"63118ECB55F758","user_header":"https://static001.geekbang.org/account/avatar/00/10/15/56/a969e60b.jpg","comment_is_top":false,"comment_ctime":1557656138,"is_pvip":false,"replies":[{"id":"33889","content":"å¯¹çš„ï¼Œé¥¿æ­»ï¼Œcpuä¸€ç›´è½¬ï¼Œä½ä¼˜å…ˆçº§çš„æ²¡å“åº”","user_name":"ä½œè€…å›å¤","comment_id":93896,"uid":"1001590","ip_address":"","utype":1,"ctime":1557899877,"user_name_real":"åˆ˜è¶…@ç½‘æ˜“äº‘"}],"discussion_count":2,"race_medal":0,"score":"233485890122","product_id":100024701,"comment_content":"å¦‚æœä¼˜å…ˆé˜Ÿåˆ—ä¸€ç›´æœ‰ä»»åŠ¡,æ™®é€šé˜Ÿåˆ—çš„taskä¸€ç›´å¾—ä¸åˆ°å¤„ç†ï¼Œæ“ä½œç³»ç»Ÿä¼šæ€ä¹ˆåšå‘¢ï¼Ÿ<br>-------------------------------------------------------------------------------------<br>æˆ‘ç°åœ¨çŸ¥é“è¿™ä¸ªé—®é¢˜çš„ç­”æ¡ˆäº†ã€‚è¿™ç§ç°è±¡å«åšé¥¿æ­»ã€‚æˆ‘å½“æ—¶æƒ³åˆ°è¿™ä¸ªé—®é¢˜æ—¶å…¶å®ä¸çŸ¥é“è¿™ä¸ªæ¦‚å¿µã€‚<br>ä¸ºäº†é˜²æ­¢è¿™ç§ç°è±¡çš„å‘ç”Ÿï¼Œæ“ä½œç³»ç»Ÿåœ¨ä¸€å®šçš„æ—¶é—´å‘¨æœŸä¼šé‡ç½®æ‰€æœ‰taskçš„ä¼˜å…ˆçº§ï¼Œè¿™æ ·å°±ä¿è¯<br>äº†ä½ä¼˜å…ˆçº§çš„taskå¾—ä»¥æ‰§è¡Œ,è€Œä¸è¢«é¥¿æ­»ã€‚ä½†æ˜¯è¿™ä¸ªæ—¶é—´è®¾ç½®ä¸ºå¤šå°‘åˆé€‚ï¼Ÿè®¾ç½®çš„çŸ­äº†ä¼šå¯¼è‡´ç³»ç»Ÿçš„é¢‘ç¹é‡ç½®ã€‚è®¾ç½®çš„é•¿äº†ï¼Œåˆä¼šä½¿æ™®é€šä¼˜å…ˆçº§çš„taskåˆ‡æ¢å¤ªæ…¢ã€‚è¿™ä¸ªæ—¶é—´ä¸€èˆ¬æ˜¯ç³»ç»Ÿç ”ç©¶äººå‘˜ç ”ç©¶å¾—åˆ°çš„ï¼Œæˆ‘è§‰å¾—å¯èƒ½å¯ä»¥é€šè¿‡ä¸€äº›ç»Ÿè®¡å­¦ä¸Šçš„æ–¹å¼æ¥åšã€‚<br>ä¸ºäº†è§£å†³taskå“åº”æ—¶é—´å’Œå®Œæˆæ—¶é—´çš„å¹³è¡¡ï¼Œç°ä»£æ“ä½œç³»ç»Ÿå¦‚Windowså’ŒLinuxéƒ½ä¾èµ–äºMulti-Level Feedback Queue, å’Œæ–‡ç« è®²çš„æ­£å¥½å¯¹åº”èµ·æ¥äº†ã€‚é¦–å…ˆé¢å¯¹çš„æƒ…å†µæ˜¯ï¼š<br>1. æ“ä½œç³»ç»Ÿæ— æ³•çŸ¥é“æ¯ä¸ªtaskä½•æ—¶åˆ°æ¥ ï¼Ÿ<br>2. æ“ä½œç³»ç»Ÿæ— æ³•çŸ¥é“æ¯ä¸ªtaskè¿è¡Œå®Œæˆå®é™…éœ€è¦å¤šå°‘æ—¶é—´ ï¼Ÿ<br>é‚£ä¹ˆFIFO ShortJobFirstæˆ–è€…Short Time Completed First ç®—æ³•ï¼Œé¢å¯¹è¿™ä¸¤ç§åœºæ™¯å°†æ— ä»ä¸‹æ‰‹ã€‚<br>é¢å¯¹è¿™æ ·çš„é—®é¢˜ï¼Œä¸ºäº†ä½¿äº¤äº’æ€§çš„TASKèƒ½å¤Ÿå¾—åˆ°å¿«é€Ÿçš„å“åº”ï¼Œæå‡ç”¨æˆ·çš„çš„ä½“éªŒï¼ŒåŒæ—¶ç¼©çŸ­task çš„å®Œæˆæ—¶é—´ã€‚è®¡ç®—æœºç§‘å­¦å®¶æå‡ºäº†Multi-Level Feedback Queueçš„è§£å†³æ–¹æ¡ˆã€‚åŸºæœ¬æ€æƒ³æ˜¯é€šè¿‡ä¼˜å…ˆçº§ä¿è¯äº¤äº’æ€§çš„taskï¼Œèƒ½å¤Ÿå¿«é€Ÿå“åº”ï¼ŒåŒæ—¶é€šè¿‡ç»Ÿè®¡task å¯¹CPUçš„ä½¿ç”¨æ—¶é—´ä»¥æœŸå¯¹TASKåˆ¤æ–­ï¼Œæœ‰ç‚¹ç±»ä¼¼äºæœºå™¨å­¦ä¹ ã€‚<br>å¦‚æœæŸä¸ªtask åœ¨å…¶æ—¶é—´ç‰‡é‡Œç”¨å®Œå‰é‡Šæ”¾CPUï¼Œ å¯ä»¥è®¤ä¸ºè¿™æ˜¯ç§äº¤äº’å¼çš„task, ä¼˜å…ˆçº§ä¿ç•™ã€‚åä¹‹è®¤ä¸ºæŸä¸ªtaskæ˜¯éœ€è¦è¿è¡Œæ—¶é—´é•¿çš„ã€‚åŒæ—¶åŸºäºå¯¹task å¯¹cpu æ—¶é—´ä½¿ç”¨çš„ç»Ÿè®¡ä½œä¸ºåˆ¤æ–­ä¾æ®ã€‚è¿™æ ·ç»è¿‡ä¸€æ®µæ—¶é—´è¿è¡Œåï¼Œé•¿æ—¶é—´è¿è¡Œçš„é˜Ÿåˆ—ä¼šè¢«é€æ¸é™ä½ä¼˜å…ˆçº§ã€‚<br>è€Œå¿«é€Ÿå“åº”çš„task èƒ½å¤Ÿä¼˜å…ˆä½¿ç”¨CPUã€‚ä½†æ˜¯è¿™é‡Œé¢è¿˜æœ‰ä¸¤ä¸ªé—®é¢˜: é¦–å…ˆï¼Œå¦‚æœä¼˜å…ˆçº§ä½çš„ä¸€ç›´å¾—ä¸åˆ°cpu, å¯èƒ½ä¼šå‡ºç°é¥¿æ­»ã€‚å…¶æ¬¡ï¼Œæœ‰äººå¯èƒ½ä¼šåˆ©ç”¨è¿™ä¸ªæ¼æ´ç¼–ç¨‹çš„æ–¹å¼åœ¨ä½¿ç”¨å®ŒCPUæ—¶é—´ç‰‡åé‡Šæ”¾CPUï¼Œä»è€Œæ§åˆ¶CPUã€‚ åŸºäºæ­¤ï¼ŒMulti-feedback-queueæœ‰ä»¥ä¸‹5æ¡è§„åˆ™ï¼š<br>1. å¦‚æœAçš„ä¼˜å…ˆçº§å¤§äºBï¼Œ åˆ™Aå…ˆè¿è¡Œã€‚<br>2. å¦‚æœAçš„ä¼˜å…ˆçº§ç­‰äºBï¼Œ åˆ™ä»¥RRç®—æ³•äº¤äº’è¿è¡Œã€‚<br>3. æ–°æ¥çš„ Task ä¼šè¢«ç½®äºæœ€é«˜çš„ä¼˜å…ˆçº§ã€‚<br>4. å¦‚æœä¸€ä¸ªtask åœ¨å…¶å½“å‰ä¼˜å…ˆçº§è¿è¡Œå®Œè¢«åˆ†é…çš„æ—¶é—´ç‰‡åï¼Œä¼šé™ä½å…¶ä¼˜å…ˆçº§ï¼Œé‡ç½®å…¶æ”¾å¼ƒä½¿ç”¨CPUçš„æ¬¡æ•°ã€‚ï¼ˆè¿™æ¡è§„åˆ™ä¿®æ”¹è¿‡ï¼Œæ˜¯ä¸ºäº†é˜²æ­¢æœ‰äººåˆ©äºåŸæœ‰è§„åˆ™çš„æ¼æ´æ§åˆ¶CPU, åŸæ¥çš„è§„åˆ™æ˜¯å¦‚æœä¸€ä¸ªtask åœ¨å…¶æ—¶é—´ç‰‡ç”¨å®Œå‰é‡Šæ”¾cpu, åˆ™å…¶ä¼˜å…ˆçº§ä¿æŒä¸å˜ï¼Œ è¿™ä¸ªä¿®æ­£å¢åŠ äº†å¯¹task å®é™…ä½¿ç”¨cpu æ—¶é—´ç»Ÿè®¡ä½œä¸ºåˆ¤æ–­ä¾æ®ï¼‰ã€‚<br>5. ç³»ç»Ÿæ¯è¿‡æ—¶é’Ÿå‘¨æœŸçš„å€æ•°ï¼Œä¼šé‡ç½®æ‰€æœ‰task çš„ä¼˜å…ˆçº§ã€‚ï¼ˆè¿™æ¡è§„åˆ™æ˜¯ä¸ºäº†é˜²æ­¢taskè¢«é¥¿æ­»çš„ï¼Œä¹Ÿæ˜¯æˆ‘ä¹‹å‰æ‰€ç–‘æƒ‘çš„ï¼‰ã€‚","like_count":55,"discussions":[{"author":{"id":1001590,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/48/76/0c7d4d23.jpg","nickname":"åˆ˜è¶…","note":"","ucode":"196BF3F499E8FE","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":449818,"discussion_content":"å¯¹çš„ï¼Œé¥¿æ­»ï¼Œcpuä¸€ç›´è½¬ï¼Œä½ä¼˜å…ˆçº§çš„æ²¡å“åº”","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1557899877,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1798979,"avatar":"https://static001.geekbang.org/account/avatar/00/1b/73/43/ae139b1f.jpg","nickname":"åš","note":"","ucode":"F7CA69FF5D09BA","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":231504,"discussion_content":"é‚£ä¹ˆé‡ç½®çš„è§„åˆ™èƒ½å¦è¯´è¯´","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1586821593,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":192435,"user_name":"OOK","can_delete":false,"product_type":"c1","uid":1342712,"ip_address":"","ucode":"BE6220D4E922E9","user_header":"https://static001.geekbang.org/account/avatar/00/14/7c/f8/1183f1ac.jpg","comment_is_top":false,"comment_ctime":1584850580,"is_pvip":false,"discussion_count":3,"race_medal":0,"score":"143318771348","product_id":100024701,"comment_content":"è¿™é‡Œç»™å¤§å®¶åˆ†äº«å‡ ä¸ªæ–‡ç« ï¼Œå¤§å®¶å¯¹èƒŒåçš„æœºåˆ¶æ˜ç™½åï¼Œè¿™äº›ä»£ç å°±å¾ˆå¥½ç†è§£äº†ï¼Œè¿™äº›æ–‡ç« æ¶‰åŠlinuxè°ƒåº¦å™¨çš„å‘å±•å†å²ï¼ŒO(n), O(1)è°ƒåº¦å™¨ï¼Œåˆ°cfsã€‚<br><br>1. http:&#47;&#47;www.wowotech.net&#47;process_management&#47;scheduler-history.html<br><br>2. https:&#47;&#47;www.ibm.com&#47;developerworks&#47;cn&#47;linux&#47;l-cn-scheduler&#47;index.html<br><br>3. https:&#47;&#47;www.jianshu.com&#47;p&#47;673c9e4817a8<br><br>","like_count":34,"discussions":[{"author":{"id":2004350,"avatar":"https://static001.geekbang.org/account/avatar/00/1e/95/7e/1057f77a.jpg","nickname":"å››æœ‰é’å¹´","note":"","ucode":"121A7C613E6C32","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":541175,"discussion_content":"ç¬¬ä¸€ç¯‡æ–‡ç« è®²å¾—éå¸¸æ£’ï¼ŒèŠ±äº†ä¸¤ä¸ªå·¥ä½œæ—¥æ™šä¸Šç»†ç»†çœ‹å®Œäº†ï¼Œæ”¶è·é¢‡ä¸°ï¼ä»O(n)-&gt;O(1)-&gt;CFSè°ƒåº¦å™¨ï¼Œå¯ä»¥ç†è§£å†…æ ¸åœ¨æ­¤æ¼”å˜è¿‡ç¨‹ä¸­çš„æ€è€ƒï¼Œç‰¹æ­¤å›æ¥è¯„ä»·ï¼ï¼ï¼","likes_number":1,"is_delete":false,"is_hidden":false,"ctime":1640272751,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1782139,"avatar":"https://static001.geekbang.org/account/avatar/00/1b/31/7b/5914f8eb.jpg","nickname":"å°éª†é©¼ğŸª","note":"","ucode":"C62F685903F2F0","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":380921,"discussion_content":"ï¼’ï¼Œï¼“é“¾æ¥éƒ½æ‰“ä¸å¼€äº†","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1624795983,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":2046179,"avatar":"http://thirdwx.qlogo.cn/mmopen/vi_32/ajNVdqHZLLAsbPRKgaVw8kKp5pKGUE4JdDZaW16RoRTItTI3wJ3pPGNoFIjYQm8FKa3xLlNwRicziclmWKsmp7kA/132","nickname":"æ¸…æ²³","note":"","ucode":"AB44CB37FCB026","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":301449,"discussion_content":"å¤ªæ£’äº†","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1598529947,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":91416,"user_name":"é’çŸ³","can_delete":false,"product_type":"c1","uid":1215531,"ip_address":"","ucode":"B0056AD6453322","user_header":"https://static001.geekbang.org/account/avatar/00/12/8c/2b/3ab96998.jpg","comment_is_top":false,"comment_ctime":1557032828,"is_pvip":false,"discussion_count":2,"race_medal":0,"score":"117521149820","product_id":100024701,"comment_content":"# æŸ¥çœ‹å½“å‰è¿›ç¨‹çš„è°ƒåº¦ç­–ç•¥ <br>$ chrt  -p 31636<br>pid 31636 çš„å½“å‰è°ƒåº¦ç­–ç•¥ï¼šSCHED_OTHER<br>pid 31636 çš„å½“å‰è°ƒåº¦ä¼˜å…ˆçº§ï¼š0<br><br># ä¿®æ”¹31636è¿›ç¨‹çš„è°ƒåº¦ç­–ç•¥ä¸ºSCHED_FIFOï¼Œä¼˜å…ˆçº§ä¸º10<br>$ chrt  -f -p 10 31636<br>$ chrt  -p 31636<br>pid 31636 çš„å½“å‰è°ƒåº¦ç­–ç•¥ï¼šSCHED_FIFO<br>pid 31636 çš„å½“å‰è°ƒåº¦ä¼˜å…ˆçº§ï¼š10","like_count":28,"discussions":[{"author":{"id":1221532,"avatar":"https://static001.geekbang.org/account/avatar/00/12/a3/9c/8a14b7db.jpg","nickname":"kå…ˆç”Ÿ","note":"","ucode":"76D292DC62B52D","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":3013,"discussion_content":"sched_other æ˜¯å±äºå“ªç§è°ƒåº¦ç­–ç•¥ï¼Ÿå…¶å®ƒè°ƒåº¦ç­–ç•¥ï¼Ÿ","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1564112911,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":1,"child_discussions":[{"author":{"id":1466033,"avatar":"https://static001.geekbang.org/account/avatar/00/16/5e/b1/09b9f4e6.jpg","nickname":"é©¬å…‹","note":"","ucode":"66F2991470A20E","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":1221532,"avatar":"https://static001.geekbang.org/account/avatar/00/12/a3/9c/8a14b7db.jpg","nickname":"kå…ˆç”Ÿ","note":"","ucode":"76D292DC62B52D","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":286726,"discussion_content":"SCHED_NORMAL (traditionally called SCHED_OTHER) å°±æ˜¯SCHED_NORMAL","likes_number":3,"is_delete":false,"is_hidden":false,"ctime":1593268607,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":3013,"ip_address":""},"score":286726,"extra":""}]}]},{"had_liked":false,"id":90798,"user_name":"Keep-Moving","can_delete":false,"product_type":"c1","uid":1182631,"ip_address":"","ucode":"76F33C06E07A27","user_header":"https://static001.geekbang.org/account/avatar/00/12/0b/a7/6ef32187.jpg","comment_is_top":false,"comment_ctime":1556661916,"is_pvip":false,"replies":[{"id":"32632","content":"è¿›ç¨‹å’Œçº¿ç¨‹éƒ½æ˜¯taskï¼Œä¸€èµ·è°ƒåº¦","user_name":"ä½œè€…å›å¤","comment_id":90798,"uid":"1001590","ip_address":"","utype":1,"ctime":1556811948,"user_name_real":"åˆ˜è¶…@ç½‘æ˜“äº‘"}],"discussion_count":2,"race_medal":0,"score":"83161040540","product_id":100024701,"comment_content":"æœ¬èŠ‚è®²çš„æ˜¯è¿›ç¨‹çš„è°ƒåº¦ï¼Œé‚£çº¿ç¨‹çš„è°ƒåº¦æ˜¯ä»€ä¹ˆæ ·çš„å‘¢ï¼ŸLinuxè°ƒåº¦çš„åŸºæœ¬å•ä½æ˜¯è¿›ç¨‹è¿˜æ˜¯çº¿ç¨‹å‘¢ï¼Ÿ","like_count":19,"discussions":[{"author":{"id":1001590,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/48/76/0c7d4d23.jpg","nickname":"åˆ˜è¶…","note":"","ucode":"196BF3F499E8FE","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":448660,"discussion_content":"è¿›ç¨‹å’Œçº¿ç¨‹éƒ½æ˜¯taskï¼Œä¸€èµ·è°ƒåº¦","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1556811948,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":2028811,"avatar":"https://static001.geekbang.org/account/avatar/00/1e/f5/0b/73628618.jpg","nickname":"å…”å˜Ÿå˜Ÿ","note":"","ucode":"5A9042B4C7670C","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":390324,"discussion_content":"å†…æ ¸ä¸­éƒ½æ˜¯taskï¼Œæ„Ÿè§‰ä¸€ä¼šå„¿è¿›ç¨‹ä¸€ä¼šå„¿çº¿ç¨‹æŒºæ··ä¹±çš„ï¼Œä½†æ¯•ç«Ÿè¿›ç¨‹è°ƒåº¦æ˜¯ä¹ æƒ¯ç”¨è¯­äº†","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1629778696,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":90926,"user_name":"åˆ˜å¼·","can_delete":false,"product_type":"c1","uid":1035612,"ip_address":"","ucode":"B2E41BB894A727","user_header":"https://static001.geekbang.org/account/avatar/00/0f/cd/5c/e09eac13.jpg","comment_is_top":false,"comment_ctime":1556728935,"is_pvip":false,"replies":[{"id":"32630","content":"æ˜¯çš„","user_name":"ä½œè€…å›å¤","comment_id":90926,"uid":"1001590","ip_address":"","utype":1,"ctime":1556811804,"user_name_real":"åˆ˜è¶…@ç½‘æ˜“äº‘"}],"discussion_count":1,"race_medal":0,"score":"48801369191","product_id":100024701,"comment_content":"æ„Ÿè§‰è¿™ä¸ªsched_classç»“æ„ä½“ç±»ä¼¼é¢å‘å¯¹è±¡ä¸­çš„åŸºç±»å•Š,é€šè¿‡å‡½æ•°æŒ‡é’ˆç±»å‹çš„æˆå‘˜æŒ‡å‘ä¸åŒçš„å‡½æ•°ï¼Œå®ç°äº†å¤šæ€ã€‚","like_count":12,"discussions":[{"author":{"id":1001590,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/48/76/0c7d4d23.jpg","nickname":"åˆ˜è¶…","note":"","ucode":"196BF3F499E8FE","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":448728,"discussion_content":"æ˜¯çš„","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1556811804,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":117962,"user_name":"kdb_reboot","can_delete":false,"product_type":"c1","uid":1003594,"ip_address":"","ucode":"4C56FCA563FCA3","user_header":"https://static001.geekbang.org/account/avatar/00/0f/50/4a/04fef27f.jpg","comment_is_top":false,"comment_ctime":1564199294,"is_pvip":false,"replies":[{"id":"46402","content":"èµ","user_name":"ä½œè€…å›å¤","comment_id":117962,"uid":"1001590","ip_address":"","utype":1,"ctime":1566298928,"user_name_real":"åˆ˜è¶…@ç½‘æ˜“äº‘"}],"discussion_count":1,"race_medal":0,"score":"40218904958","product_id":100024701,"comment_content":"å¯ä»¥é€šè¿‡sched_setschedulerå’Œpthread_setschedparamè®¾ç½®è¿›ç¨‹å’Œçº¿ç¨‹çš„API","like_count":9,"discussions":[{"author":{"id":1001590,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/48/76/0c7d4d23.jpg","nickname":"åˆ˜è¶…","note":"","ucode":"196BF3F499E8FE","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":460199,"discussion_content":"èµ","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1566298928,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":90879,"user_name":"why","can_delete":false,"product_type":"c1","uid":1012937,"ip_address":"","ucode":"C9E796E53F6F5E","user_header":"https://static001.geekbang.org/account/avatar/00/0f/74/c9/d3439ca4.jpg","comment_is_top":false,"comment_ctime":1556705062,"is_pvip":false,"replies":[{"id":"32631","content":"æ¯æ¬¡æ–°è¿›ç¨‹åˆ›å»ºå®Œæ¯•åï¼Œéƒ½ä¼šè¯•å›¾å…ˆè®©æ–°çš„æŠ¢å ä¸€æ¬¡","user_name":"ä½œè€…å›å¤","comment_id":90879,"uid":"1001590","ip_address":"","utype":1,"ctime":1556811870,"user_name_real":"åˆ˜è¶…@ç½‘æ˜“äº‘"}],"discussion_count":1,"race_medal":0,"score":"40211410726","product_id":100024701,"comment_content":"å¦‚æœæ˜¯æ–°å»ºçš„è¿›ç¨‹å¦‚ä½•å¤„ç†, å®ƒ vruntime æ€»æ˜¯æœ€å°çš„, æ€»è¢«è°ƒåº¦ç›´åˆ°ä¸å…¶ä»–è¿›ç¨‹ç›¸å½“.","like_count":9,"discussions":[{"author":{"id":1001590,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/48/76/0c7d4d23.jpg","nickname":"åˆ˜è¶…","note":"","ucode":"196BF3F499E8FE","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":448706,"discussion_content":"æ¯æ¬¡æ–°è¿›ç¨‹åˆ›å»ºå®Œæ¯•åï¼Œéƒ½ä¼šè¯•å›¾å…ˆè®©æ–°çš„æŠ¢å ä¸€æ¬¡","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1556811870,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":116844,"user_name":"æ±Ÿå±±æœª","can_delete":false,"product_type":"c1","uid":1090196,"ip_address":"","ucode":"5293DD9482717F","user_header":"https://static001.geekbang.org/account/avatar/00/10/a2/94/ae0a60d8.jpg","comment_is_top":false,"comment_ctime":1563931288,"is_pvip":false,"replies":[{"id":"46423","content":"åˆ°äº†å†…æ ¸é‡Œé¢ï¼Œå°±æ²¡æœ‰æ‰€è°“è¿›ç¨‹ä¸è¿›ç¨‹äº†ï¼Œå¯¹äºæ“ä½œç³»ç»Ÿå†…æ ¸çš„ä»£ç ï¼Œéƒ½æ˜¯æ•°æ®ç»“æ„ï¼Œéšå†…æ ¸æ€ä¹ˆæ“ä½œéƒ½è¡Œã€‚åœ°å€æ˜¯åˆå§‹åŒ–çš„æ—¶å€™ï¼Œé‡è¦æ•°æ®ç»“æ„çš„èµ·å§‹åœ°å€éƒ½æ˜¯èƒ½å¤Ÿæ‰¾åˆ°çš„ã€‚","user_name":"ä½œè€…å›å¤","comment_id":116844,"uid":"1001590","ip_address":"","utype":1,"ctime":1566299842,"user_name_real":"åˆ˜è¶…@ç½‘æ˜“äº‘"}],"discussion_count":4,"race_medal":0,"score":"27333735064","product_id":100024701,"comment_content":"æœ‰ä¸ªç–‘é—®ï¼Œsched_classå’Œrqè¿™äº›ç»“æ„ï¼Œéƒ½å­˜åœ¨å†…æ ¸æ€çš„å“ªé‡Œå•Šï¼Œä¹Ÿæœ‰ä¸€ä¸ªè¿›ç¨‹è´Ÿè´£ç»´æŠ¤ä»–ä»¬å—ï¼ŒCPUæ€ä¹ˆæœ‰ä»–ä»¬çš„åœ°å€çš„ã€‚ã€‚æŠ±æ­‰é—®é¢˜æ¯”è¾ƒå¤š","like_count":7,"discussions":[{"author":{"id":1001590,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/48/76/0c7d4d23.jpg","nickname":"åˆ˜è¶…","note":"","ucode":"196BF3F499E8FE","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":459706,"discussion_content":"åˆ°äº†å†…æ ¸é‡Œé¢ï¼Œå°±æ²¡æœ‰æ‰€è°“è¿›ç¨‹ä¸è¿›ç¨‹äº†ï¼Œå¯¹äºæ“ä½œç³»ç»Ÿå†…æ ¸çš„ä»£ç ï¼Œéƒ½æ˜¯æ•°æ®ç»“æ„ï¼Œéšå†…æ ¸æ€ä¹ˆæ“ä½œéƒ½è¡Œã€‚åœ°å€æ˜¯åˆå§‹åŒ–çš„æ—¶å€™ï¼Œé‡è¦æ•°æ®ç»“æ„çš„èµ·å§‹åœ°å€éƒ½æ˜¯èƒ½å¤Ÿæ‰¾åˆ°çš„ã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1566299842,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1116508,"avatar":"https://static001.geekbang.org/account/avatar/00/11/09/5c/b5d79d20.jpg","nickname":"æäº®äº®","note":"","ucode":"290907F930B261","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":26443,"discussion_content":"æ‰€è°“å†…æ ¸æ€è·Ÿç”¨æˆ·æ€ï¼Œå¯ä»¥ç†è§£ä¸ºä¸¤ç§ç¯å¢ƒã€‚è¿™ä¸¤ç§ç¯å¢ƒçš„ç‰¹æƒçº§åˆ«ä¸ä¸€æ ·ï¼Œå¯¹äºç¡¬ä»¶æ¥è¯´ä¹Ÿæœ‰ç›¸å…³çš„ç‰¹æƒçº§åˆ«ï¼Œæ¯”å¦‚CPU çš„ç‰¹æƒç”¨ ring0-ring4æ¥åˆ’åˆ†ï¼Œä¸åŒçš„ç‰¹æƒçº§åˆ«å¯ä»¥åšçš„äº‹ä¹Ÿå°±ä¸ä¸€æ ·äº†ã€‚é‚£ä¹ˆå¦‚ä½•åˆ©ç”¨ç¡¬ä»¶è¿™ç§ç‰¹æƒèƒ½åŠ›ï¼Œå½“ç„¶å°±æ˜¯ä»è½¯ä»¶ä¸Šä¹Ÿåšç›¸åº”çš„ç‰¹æƒç¯å¢ƒï¼Œæ‰€ä»¥å¯¹äºLinuxæ¥è¯´ï¼Œå†…æ ¸æ€å°±å¯¹åº”äº†CUPçš„ring0ï¼Œç”¨æˆ·æ€å¯¹åº”äº† ring3ï¼Œring1å’Œring2æ²¡æœ‰ä½¿ç”¨ã€‚å¯¹äºCPUæ¥è¯´ï¼Œä¸€æ¡æŒ‡ä»¤æ‰§è¡Œå‰ä¼šæ£€æŸ¥å…¶ç‰¹æƒå…ä¸å…è®¸ï¼Œé‚£ä¹ˆå¯¹äºè½¯ä»¶æ¥è¯´ä¹Ÿæ˜¯ä¸€æ ·ã€‚æ¯”å¦‚å½“éœ€è¦è¯»å–æœ¬åœ°ä¸€ä¸ªæ–‡ä»¶ï¼Œè¿™ä¹Ÿæ˜¯éœ€è¦ä¸€å®šæƒé™çš„ï¼Œè€Œè¿™ä¸ªæƒé™åªèƒ½åœ¨å†…æ ¸æ€ä½¿ç”¨ã€‚æ‰€ä»¥é€šè¿‡ç³»ç»Ÿè°ƒç”¨é™·å…¥äº†å†…æ ¸æ€ã€‚å¯¹äºè¿›ç¨‹æˆ–è€…çº¿ç¨‹æ¥è¯´ï¼Œé™·å…¥å†…æ ¸æ€çš„æ—¶å€™è¿˜æ˜¯é‚£ä¸ªè¿›ç¨‹è·Ÿçº¿ç¨‹ï¼Œä½†æ˜¯ä¼šä¿å­˜å½“å‰çš„æ‰§è¡Œç¯å¢ƒï¼ˆç”¨æˆ·æ€çš„ç¯å¢ƒï¼‰ï¼Œç­‰å†…æ ¸æ€æ‰§è¡Œå®Œå°±å¿…é¡»æ¢å¤ï¼Œä¹Ÿå°±æ˜¯å‰é¢ä¸¤ç« æåˆ°çš„ã€‚æ‰€ä»¥ç³»ç»Ÿè°ƒç”¨å¤šäº†ä¹Ÿä¼šå½±å“æ€§èƒ½ã€‚","likes_number":4,"is_delete":false,"is_hidden":false,"ctime":1570602407,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1203671,"avatar":"","nickname":"é£é€æ®‹å¶_c","note":"","ucode":"9BB90C99B09691","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":363362,"discussion_content":"å•Šï¼Œçœ‹å®Œäº†åé¢ä¸¤ç¯‡è¿™ä¸ªé—®é¢˜å°±çŸ¥é“äº†ã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1617179255,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1203671,"avatar":"","nickname":"é£é€æ®‹å¶_c","note":"","ucode":"9BB90C99B09691","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":363343,"discussion_content":"è®²åˆå§‹åŒ–çš„æ—¶å€™ä¸æ˜¯æœ‰ä¸€ä¸ªå†…æ ¸çŠ¶æ€çš„1å·è¿›ç¨‹å—ï¼Œç„¶åpså‘½ä»¤ä¹Ÿèƒ½çœ‹åˆ°[]æ‹¬èµ·æ¥çš„ç‰¹æ®Šè¿›ç¨‹ã€‚è™½ç„¶ä½œè€…å›å¤è¯´æ˜¯æ— æ‰€è°“è¿›ç¨‹ä¸è¿›ç¨‹ï¼Œä½†æ˜¯è¿™äº›è°ƒåº¦çš„ä»£ç æ€»è¦æœ‰ä¸€ä¸ªæ—¶é—´è¢«CPUæ‰§è¡Œèµ·æ¥ï¼ŒæŠŠå†…æ ¸é‡Œé¢çš„è¿™äº›æ•°æ®ç»“æ„çš„çŠ¶æ€åˆ·æ–°äº†ï¼Œæ‰ç®—æ˜¯å®Œæˆè¿›ç¨‹ä¹‹é—´çš„åˆ‡æ¢ã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1617173737,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":91019,"user_name":"ç„°ç«","can_delete":false,"product_type":"c1","uid":1244606,"ip_address":"","ucode":"D3353B386DE3B5","user_header":"https://static001.geekbang.org/account/avatar/00/12/fd/be/079c78c7.jpg","comment_is_top":false,"comment_ctime":1556792731,"is_pvip":true,"replies":[{"id":"32628","content":"æ˜¯çš„ï¼ŒåŒä¸€ä¸ªæ—¶åˆ»åŒä¸€ä¸ªcpuåªèƒ½ç»™ä¸€ä¸ªè¿›ç¨‹ç”¨","user_name":"ä½œè€…å›å¤","comment_id":91019,"uid":"1001590","ip_address":"","utype":1,"ctime":1556811749,"user_name_real":"åˆ˜è¶…@ç½‘æ˜“äº‘"}],"discussion_count":1,"race_medal":0,"score":"27326596507","product_id":100024701,"comment_content":"ä¸€ä¸ªtask åˆ†é…ç»™ä¸€ä¸ªcpuæ‰§è¡Œåï¼Œå°±ä¸ä¼šå†è¢«å…¶ä»–cpu æ‰§è¡Œäº†å§ï¼Ÿ  ","like_count":7,"discussions":[{"author":{"id":1001590,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/48/76/0c7d4d23.jpg","nickname":"åˆ˜è¶…","note":"","ucode":"196BF3F499E8FE","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":448766,"discussion_content":"æ˜¯çš„ï¼ŒåŒä¸€ä¸ªæ—¶åˆ»åŒä¸€ä¸ªcpuåªèƒ½ç»™ä¸€ä¸ªè¿›ç¨‹ç”¨","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1556811749,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":115398,"user_name":"garlic","can_delete":false,"product_type":"c1","uid":1019579,"ip_address":"","ucode":"FEB147EDB5774E","user_header":"https://static001.geekbang.org/account/avatar/00/0f/8e/bb/c039dc11.jpg","comment_is_top":false,"comment_ctime":1563572910,"is_pvip":true,"replies":[{"id":"46562","content":"èµ","user_name":"ä½œè€…å›å¤","comment_id":115398,"uid":"1001590","ip_address":"","utype":1,"ctime":1566357717,"user_name_real":"åˆ˜è¶…@ç½‘æ˜“äº‘"}],"discussion_count":1,"race_medal":1,"score":"23038409390","product_id":100024701,"comment_content":"è¿›ç¨‹çº¿ç¨‹çš„API ï¼š http:&#47;&#47;man7.org&#47;linux&#47;man-pages&#47;man7&#47;sched.7.html, Posix Threads API  http:&#47;&#47;man7.org&#47;linux&#47;man-pages&#47;man7&#47;pthreads.7.html , å®æ—¶è°ƒåº¦ç­–ç•¥å¯ä»¥è®¾ç½®ä¼˜å…ˆçº§æ™®é€šè°ƒåº¦ç­–ç•¥è®¾ç½®niceå€¼ã€‚ çº¿ç¨‹è¦è®¾ç½®æŒ‡å®šçš„è°ƒåº¦ç­–ç•¥ï¼Œ ä¸»çº¿ç¨‹ PTHREAD_EXPLICIT_SCHED å¦åˆ™é»˜è®¤é›†æˆä¸»çº¿ç¨‹è°ƒåº¦ç­–ç•¥ã€‚ ç½‘ä¸Šæ‰¾äº†ä¸ªä¾‹å­éªŒè¯äº†ä¸€ä¸‹ï¼š https:&#47;&#47;garlicspace.com&#47;2019&#47;07&#47;16&#47;linux-%e8%bf%9b%e7%a8%8b%ef%bc%8c%e7%ba%bf%e7%a8%8b%e7%9a%84%e8%b0%83%e5%ba%a6%e7%ad%96%e7%95%a5api&#47;","like_count":5,"discussions":[{"author":{"id":1001590,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/48/76/0c7d4d23.jpg","nickname":"åˆ˜è¶…","note":"","ucode":"196BF3F499E8FE","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":459088,"discussion_content":"èµ","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1566357717,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":127743,"user_name":"å¥”è·‘çš„ç ä»”","can_delete":false,"product_type":"c1","uid":1609871,"ip_address":"","ucode":"AB3B02B07B8B8C","user_header":"https://static001.geekbang.org/account/avatar/00/18/90/8f/9c691a5f.jpg","comment_is_top":false,"comment_ctime":1566787151,"is_pvip":false,"replies":[{"id":"48774","content":"æ˜¯çš„","user_name":"ä½œè€…å›å¤","comment_id":127743,"uid":"1001590","ip_address":"","utype":1,"ctime":1567495633,"user_name_real":"åˆ˜è¶…@ç½‘æ˜“äº‘"}],"discussion_count":1,"race_medal":0,"score":"18746656335","product_id":100024701,"comment_content":"å¯¹äºCFSçš„è¿™ä¸ªæ¯”å–»å¾ˆè´´åˆ‡ï¼Œä¹‹å‰çœ‹è¿‡CFSç›¸å…³çš„å†…å®¹ï¼Œä¸€ç›´æ‰¾ä¸åˆ°å¦‚ä½•ç”¨ä¸€ä¸ªç°å®ä¸­çš„è¿‡ç¨‹ç±»æ¯”ä¸€ä¸‹ã€‚å¤§å£è¢‹å’Œå°å£è¢‹æ‰€æ”¾å…¥çš„çƒçš„æ¯”ä¾‹ä¸€æ ·ï¼Œå¯¹åº”åˆ°CFSï¼Œä¹Ÿå°±æ˜¯vruntimeä¸€æ ·ï¼Œä»è¿™ä¸ªè§’åº¦æ¥çœ‹ï¼Œä¹Ÿå°±æ˜¯åšåˆ°äº†å®Œå…¨çš„å…¬å¹³ï¼","like_count":4,"discussions":[{"author":{"id":1001590,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/48/76/0c7d4d23.jpg","nickname":"åˆ˜è¶…","note":"","ucode":"196BF3F499E8FE","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":464633,"discussion_content":"æ˜¯çš„","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1567495633,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":284710,"user_name":"å±±ä¸­æ— è€è™ ğŸ˜ª","can_delete":false,"product_type":"c1","uid":1180460,"ip_address":"","ucode":"594247C3A976DE","user_header":"https://static001.geekbang.org/account/avatar/00/12/03/2c/33ba4d12.jpg","comment_is_top":false,"comment_ctime":1616425055,"is_pvip":false,"discussion_count":2,"race_medal":0,"score":"14501326943","product_id":100024701,"comment_content":"æ±‚å¸®å¿™ï¼Œåªæƒ³çŸ¥é“ï¼Œå¦‚ä½•é€šè¿‡entityåå‘æ‹¿åˆ°task_struct","like_count":4,"discussions":[{"author":{"id":1180460,"avatar":"https://static001.geekbang.org/account/avatar/00/12/03/2c/33ba4d12.jpg","nickname":"å±±ä¸­æ— è€è™ ğŸ˜ª","note":"","ucode":"594247C3A976DE","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":360399,"discussion_content":"è‡ªå·±å›ç­”äº†ï¼Œåœ¨pick_next_task_fairé‡Œé¢è°ƒç”¨äº† task_of -ã€‹container_of() ï¼Œcontainer_ofæ˜¯ä¸€ä¸ªå®é€šè¿‡ç»“æ„ä½“çš„æŸä¸ªæˆå‘˜å˜é‡æ‰¾åˆ°è¿™ä¸ªç»“æ„ä½“çš„åœ°å€ï¼Œå…·ä½“å¤§å®¶è‡ªå·±æœç´¢ä¸‹","likes_number":1,"is_delete":false,"is_hidden":false,"ctime":1616427144,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1679661,"avatar":"https://static001.geekbang.org/account/avatar/00/19/a1/2d/599e9051.jpg","nickname":"CycleGAN","note":"","ucode":"9FD04813911A02","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":401882,"discussion_content":"èµï¼Œè§£å†³äº†æˆ‘çš„é—®é¢˜","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1633757487,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":109631,"user_name":"ä½ å¥½å‘€","can_delete":false,"product_type":"c1","uid":1049361,"ip_address":"","ucode":"2E97656410BACA","user_header":"https://static001.geekbang.org/account/avatar/00/10/03/11/f58c6278.jpg","comment_is_top":false,"comment_ctime":1562069024,"is_pvip":false,"replies":[{"id":"48809","content":"å¦‚æœåˆ›å»ºä¸€ä¸ªrtçš„ï¼Œæ˜¯èƒ½å¤Ÿçœ‹åˆ°è¿™ä¸ªç°è±¡çš„","user_name":"ä½œè€…å›å¤","comment_id":109631,"uid":"1001590","ip_address":"","utype":1,"ctime":1567498176,"user_name_real":"åˆ˜è¶…@ç½‘æ˜“äº‘"}],"discussion_count":1,"race_medal":0,"score":"14446970912","product_id":100024701,"comment_content":"æƒ³è¦cpuä½¿ç”¨ç‡ä¸€ç›´100 % è¿›ç¨‹çš„ä¼˜å…ˆçº§æ˜¯ä¸æ˜¯è¦æœ€é«˜  å¥½ä¸€ç›´å ç”¨æ—¶é—´ç‰‡ï¼Ÿ","like_count":3,"discussions":[{"author":{"id":1001590,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/48/76/0c7d4d23.jpg","nickname":"åˆ˜è¶…","note":"","ucode":"196BF3F499E8FE","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":456489,"discussion_content":"å¦‚æœåˆ›å»ºä¸€ä¸ªrtçš„ï¼Œæ˜¯èƒ½å¤Ÿçœ‹åˆ°è¿™ä¸ªç°è±¡çš„","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1567498176,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":90822,"user_name":"å«å•¥å¥½æ","can_delete":false,"product_type":"c1","uid":1478749,"ip_address":"","ucode":"BBD685AACAE059","user_header":"https://static001.geekbang.org/account/avatar/00/16/90/5d/08f28cb0.jpg","comment_is_top":false,"comment_ctime":1556677024,"is_pvip":false,"replies":[{"id":"49501","content":"å†™çš„æœŸé—´ï¼Œå°±æ²¡ä¼‘æ¯è¿‡å‘€","user_name":"ä½œè€…å›å¤","comment_id":90822,"uid":"1001590","ip_address":"","utype":1,"ctime":1567676798,"user_name_real":"åˆ˜è¶…@ç½‘æ˜“äº‘"}],"discussion_count":1,"race_medal":0,"score":"14441578912","product_id":100024701,"comment_content":"å¤§ä½¬å‡æœŸä¹Ÿä¸ä¼‘æ¯ä¹ˆ","like_count":3,"discussions":[{"author":{"id":1001590,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/48/76/0c7d4d23.jpg","nickname":"åˆ˜è¶…","note":"","ucode":"196BF3F499E8FE","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":448674,"discussion_content":"å†™çš„æœŸé—´ï¼Œå°±æ²¡ä¼‘æ¯è¿‡å‘€","likes_number":1,"is_delete":false,"is_hidden":false,"ctime":1567676798,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":127680,"user_name":"å¤©ç‹","can_delete":false,"product_type":"c1","uid":1239337,"ip_address":"","ucode":"C074B2F9A5F007","user_header":"https://static001.geekbang.org/account/avatar/00/12/e9/29/629d9bb0.jpg","comment_is_top":false,"comment_ctime":1566778985,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"10156713577","product_id":100024701,"comment_content":"è°ƒåº¦ï¼Œ1 task_struct é‡Œé¢æœ‰policyå’Œpriorityï¼Œä»»åŠ¡è°ƒåº¦çš„ç­–ç•¥å’Œä¼˜å…ˆçº§ï¼Œé¡¹ç›®å³è¿›ç¨‹å¤šäº†ï¼Œå¹²æ´»çš„äººå³CPUä¸ªæ•°æ˜¯æœ‰é™çš„ï¼Œéœ€è¦è¿›è¡Œè¿›ç¨‹çš„è°ƒåº¦ï¼Œåˆ†é…CPUçš„æ—¶é—´ï¼Œæ—¢ä¿è¯çº¿ç¨‹çš„å¿«é€Ÿå“åº”ï¼Œä¹Ÿä¿è¯å…¬å¹³ã€‚2 è°ƒåº¦ç­–ç•¥ 2.1 linuxé‡Œé¢è¿›ç¨‹åˆ†æˆ2ç§ï¼Œä¸€ç§æ˜¯å®æ—¶è¿›ç¨‹ï¼Œä¸€ç§æ˜¯æ™®é€šè¿›ç¨‹ï¼Œæ­£å¸¸æ—¶é—´æ’ è°ƒåº¦ç­–ç•¥ï¼Œtask_structé‡Œé¢æœ‰ä¸ªpolicyï¼Œé‡Œé¢æœ‰ä¸€äº›æšä¸¾å€¼ï¼ŒSCHED_normal 0ï¼Œsched_fifo 1ï¼Œsched_rr 2ï¼Œsched_batch 3ï¼Œsched_idle 5ï¼Œsched_deadline 6ã€‚é…åˆè°ƒåº¦ç­–ç•¥çš„è¿˜æœ‰priorityï¼Œtask_structé‡Œé¢æœ‰prioï¼Œstatic_prioï¼Œnormal_prioï¼Œå®æ—¶è¿›ç¨‹çš„ä¼˜å…ˆçº§æ˜¯0åˆ°99ï¼Œæ™®é€šè¿›ç¨‹æ˜¯100åˆ°139ï¼Œä¼˜å…ˆçº§è¶Šå°ï¼Œä¼˜å…ˆçº§è¶Šé«˜ã€‚2.2 è°ƒåº¦ç­–ç•¥åˆ†å®æ—¶è°ƒåº¦ç­–ç•¥å’Œæ™®é€šè°ƒåº¦ç­–ç•¥ 2.21å®æ—¶è°ƒåº¦ç­–ç•¥æœ‰sched_rrï¼Œsched_fifoï¼Œsched_deadlineï¼Œsched_fifo æ˜¯é«˜ä¼˜å…ˆçº§çš„æŠ¢å ä½ä¼˜å…ˆçº§çš„è¿›ç¨‹ï¼Œç›¸åŒä¼˜å…ˆçº§çš„å…ˆè¿›çš„å…ˆå¤„ç†ï¼Œsched_rr æ˜¯è½®æµç€æ¥ï¼Œæ¯ä¸ªè°ƒåº¦æ‰§è¡Œä¸ªæ—¶é—´ç‰‡ï¼Œæ‰§è¡Œå®Œæ”¾åˆ°é˜Ÿåˆ—åé¢ï¼Œsched_deadlineï¼Œæ˜¯å“ªä¸ªå¿«åˆ°æ—¶é—´äº†ï¼Œæ‰§è¡Œå“ªä¸ªã€‚2.22 æ™®é€šè°ƒåº¦ç­–ç•¥ sched_normalï¼Œsched_batchï¼Œsched_idleï¼Œsched_normal æ™®é€šè¿›ç¨‹ï¼Œsched_batch åå°è¿›ç¨‹ï¼Œsched_idleç©ºé—²çš„æ—¶å€™æ‰è·‘çš„åå°è¿›ç¨‹ï¼Œ3 policyå’Œpriorityéƒ½æ˜¯å®šä¹‰äº†ä¸€ç§ç­–ç•¥ï¼Œå…·ä½“çš„è°ƒåº¦ç±» sched_classï¼Œsched_classå®šä¹‰äº†å‡ ç§å®ç°ï¼Œstop_sched_class è¿™ä¸ªä»»åŠ¡ä¼˜å…ˆçº§æœ€é«˜ï¼Œå¯ä»¥ä¸­æ–­å…¶ä»–çº¿ç¨‹ï¼Œä¸èƒ½è¢«å…¶ä»–çº¿ç¨‹ä¸­æ–­ï¼Œdl_sched_classå¯¹åº”sched_deadlineçš„è°ƒåº¦ç­–ç•¥ï¼Œrt_sched_classå¯¹åº”rrç®—æ³•å’Œfifoçš„è°ƒåº¦ç­–ç•¥ï¼Œfair_sched_classå¯¹åº”å°±æ˜¯å®Œå…¨å…¬å¹³çš„è°ƒåº¦ç­–ç•¥ï¼Œidle_sched_classå¯¹åº”ç©ºé—²çš„è°ƒåº¦ç­–ç•¥ã€‚4 æ™®é€šè¿›ç¨‹çš„å®Œå…¨å…¬å¹³è°ƒåº¦ç®—æ³• CFS å…¨ç§°completely fair schedue CFSçš„åŸç†4.1é¦–å…ˆè®°å½•ä¸€ä¸ªè¿›ç¨‹çš„è¿è¡Œæ—¶é—´ CPUä¼šæä¾›ä¸€ä¸ªæ—¶é’Ÿï¼Œæ¯éš”ä¸€æ®µæ—¶é—´è§¦å‘ä¸€ä¸ªä¸­æ–­ï¼Œå«tickï¼ŒCFSä¼šä¸ºæ¯ä¸ªè¿›ç¨‹æä¾›ä¸€ä¸ªè™šæ‹Ÿè¿è¡Œæ—¶é—´virtualruntimeï¼Œéšç€è¿›ç¨‹çš„è¿è¡Œï¼Œtickçš„åˆ°æ¥virtualruntimeä¼šå¢å¤§ï¼Œæ²¡æœ‰å¾—åˆ°æ‰§è¡Œçš„virtualruntimeä¿æŒä¸å˜ï¼Œvirtualruntimeå°‘çš„ä¼šè¡¥ä¸Šï¼Œä¸‹æ¬¡ä¼šä¼˜å…ˆåˆ†ï¼Œä¼˜å…ˆçº§é«˜çš„ç»™ä¸€ä¸ªå¤§æ¡¶ï¼ŒæŒ‰æ¯”ä¾‹åˆ†ï¼Œè¿™æ ·å°±èƒ½ç»™ä¼˜å…ˆçº§é«˜çš„ä¼˜å…ˆåˆ†é…ï¼ŒåŒæ ·çš„è¿è¡Œæ—¶é—´ï¼Œç»™ä¼˜å…ˆçº§é«˜çš„ç®—çš„å°‘ï¼Œè¿™æ ·ï¼Œä¸‹æ¬¡åˆ†é…çš„æ—¶å€™ï¼ŒæŒ‰ç…§virtualruntimeå°çš„åˆ†é…ï¼Œä¼˜å…ˆçº§é«˜çš„å°±è¢«æ‰§è¡Œåˆ°äº†ã€‚5 è°ƒåº¦é˜Ÿåˆ—å’Œè°ƒåº¦å®ä½“ å¹³è¡¡å¿«é€ŸæŸ¥è¯¢å’Œæ›´æ–°çš„æ•°æ®ç»“æ„æ˜¯çº¢é»‘æ ‘ï¼Œçº¢é»‘æ ‘çš„èŠ‚ç‚¹æ˜¯åŒ…å«virtualruntimeçš„ï¼Œç§°ä¸ºè°ƒåº¦å®ä½“ï¼Œæœ‰å‡ ç§sched_entity å®Œå…¨å…¬å¹³è°ƒåº¦å®ä½“ï¼Œsched_rt_entity å®æ—¶è°ƒåº¦å®ä½“ï¼Œsched_dl_entity deadlineè°ƒåº¦å®ä½“ï¼Œè¿›ç¨‹æ ¹æ®è‡ªå·±çš„çŠ¶å†µé€‰æ‹©æŸä¸€ä¸ªå®ä½“ï¼Œå¦‚æœæ˜¯æ™®é€šè¿›ç¨‹ï¼Œåˆ™é€šè¿‡sched_entityå°†è‡ªå·±æŒ‚åœ¨çº¢é»‘æ ‘ä¸Šï¼Œsched_entityé‡Œé¢åŒ…å«äº†vruntimeå’Œload_weightï¼Œè¿˜æœ‰ç»Ÿè®¡ä¿¡æ¯ï¼Œæ‰€æœ‰å¯è¿è¡Œçš„è¿›ç¨‹é€šè¿‡ä¸æ–­çš„æ’å…¥æ›´æ–°æ“ä½œï¼Œéƒ½å­˜å‚¨åœ¨ä»¥æ—¶é—´ä¸ºé¡ºåºçš„çº¢é»‘æ ‘ä¸­ï¼Œvirtualruntimeæœ€å°çš„çš„åœ¨æ ‘çš„å·¦ä¾§ï¼Œæœ€å¤§çš„åœ¨æ ‘çš„å³ä¾§ï¼ŒCFSç­–ç•¥ä¼šé€‰æ‹©å·¦ä¾§æœ€å°çš„ä½œä¸ºä¸‹ä¸€ä¸ªè¦æ‰§è¡Œçš„ä»»åŠ¡ã€‚çº¢é»‘æ ‘çš„ä½ç½®ï¼Œæ¯ä¸ªCPUæœ‰è‡ªå·±çš„struct rqç»“æ„ï¼Œç”¨äºæè¿°æ‰€æœ‰åœ¨æ­¤CPUä¸Šè¿è¡Œçš„æ‰€æœ‰è¿›ç¨‹ï¼ŒåŒ…æ‹¬å®æ—¶é˜Ÿåˆ—rt_mqå’ŒCFSè¿è¡Œé˜Ÿåˆ—cfs_mqï¼Œè°ƒåº¦å™¨é¦–å…ˆä¼šå»å®æ—¶é˜Ÿåˆ—rt_mqä¸Šæœ‰æ²¡æœ‰è¦è¿è¡Œçš„è¿›ç¨‹ï¼Œæ²¡æœ‰å»cfs_mqå»çœ‹ä¸‹æ˜¯å¦æœ‰è¿›ç¨‹éœ€è¦æ‰§è¡Œï¼Œcfs_mqé‡Œé¢æœ‰ä¸ªrb_rootæŒ‡å‘çš„æ˜¯çº¢é»‘æ ‘çš„æ ¹èŠ‚ç‚¹ï¼Œè¿™ä¸ªçº¢é»‘æ ‘å°±åƒä¸€ä¸ªé˜Ÿåˆ—ï¼Œä¸æ–­å–ä¸‹ä¸€ä¸ªè¦è¿è¡Œçš„è¿›ç¨‹ï¼Œrb_leftmostæŒ‡å‘æœ€å·¦è¾¹çš„èŠ‚ç‚¹ã€‚6 è°ƒåº¦ç±»å¦‚ä½•å·¥ä½œ 6.1 sched_class ç»“æ„ sched_class nextç”¨äºæŒ‡å‘ä¸‹ä¸€ä¸ªè°ƒåº¦ç±»ï¼Œenqueue_taskç”¨äºå°†å°±ç»ªçš„è¿›ç¨‹åŠ å…¥åˆ°è°ƒåº¦åˆ—è¡¨ï¼Œdequeueç”¨äºå°†è¿›ç¨‹ä»è°ƒåº¦åˆ—è¡¨åˆ é™¤ï¼Œpick_next_task ç”¨äºæŸ¥æ‰¾ä¸‹ä¸€ä¸ªä»»åŠ¡ï¼Œ6.2 æ¯ä¸ªCPUä¸Šéƒ½æœ‰ä¸€ä¸ªå¤§é˜Ÿåˆ—rqï¼Œè¿™ä¸ªé˜Ÿåˆ—åŒ…å«å¤šä¸ªå­é˜Ÿåˆ—ï¼Œrt_rqï¼Œcfs_rqï¼ŒCPUæ‰¾ä»»åŠ¡è¦æ‰§è¡Œçš„æ—¶å€™ï¼ŒæŒ‰ç…§ä¼˜å…ˆçº§ä¾æ¬¡è°ƒåº¦sched_classï¼Œä¸åŒçš„sched_classæ“ä½œä¸åŒçš„é˜Ÿåˆ—ï¼Œï¼Œä¼˜å…ˆrt_mqæ˜¯å¦è¿˜æœ‰taskï¼Œæ²¡æœ‰çš„è¯ï¼Œè°ƒç”¨fair_sched_classå»cfs_","like_count":2},{"had_liked":false,"id":98261,"user_name":"Geek__WMK","can_delete":false,"product_type":"c1","uid":1450350,"ip_address":"","ucode":"BD402525A0E3DD","user_header":"http://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTI6J3aB8SFk2p54J1NtwZ4fXfxMNlWC4mGH1NAvZicKwCTXbiaRRClb6IicMF2X3VHfnE5mZZiaQhLj2w/132","comment_is_top":false,"comment_ctime":1558944210,"is_pvip":false,"replies":[{"id":"49248","content":"ç½‘å‹è§é¢","user_name":"ä½œè€…å›å¤","comment_id":98261,"uid":"1001590","ip_address":"","utype":1,"ctime":1567605814,"user_name_real":"åˆ˜è¶…@ç½‘æ˜“äº‘"}],"discussion_count":1,"race_medal":0,"score":"10148878802","product_id":100024701,"comment_content":"@whyæ˜¯å°ç°å§","like_count":2,"discussions":[{"author":{"id":1001590,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/48/76/0c7d4d23.jpg","nickname":"åˆ˜è¶…","note":"","ucode":"196BF3F499E8FE","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":451621,"discussion_content":"ç½‘å‹è§é¢","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1567605814,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":95506,"user_name":"nora","can_delete":false,"product_type":"c1","uid":1206539,"ip_address":"","ucode":"3A3EABF27D0261","user_header":"https://static001.geekbang.org/account/avatar/00/12/69/0b/780b0aac.jpg","comment_is_top":false,"comment_ctime":1558068322,"is_pvip":false,"replies":[{"id":"49339","content":"niceæ˜¯å¯ä»¥è°ƒæ•´ä¼˜å…ˆçº§çš„ã€‚NICE_0_LOADæ˜¯NICEå€¼ä¸º0çš„æƒé‡ï¼Œæ˜¯ä¸€ä¸ªåŸºå‡†å€¼ã€‚","user_name":"ä½œè€…å›å¤","comment_id":95506,"uid":"1001590","ip_address":"","utype":1,"ctime":1567650246,"user_name_real":"åˆ˜è¶…@ç½‘æ˜“äº‘"}],"discussion_count":1,"race_medal":0,"score":"10148002914","product_id":100024701,"comment_content":"è€å¸ˆï¼Œè¯·æ•™ä¸€ä¸‹ è™šæ‹Ÿè¿è¡Œæ—¶é—´ vruntime += å®é™…è¿è¡Œæ—¶é—´ delta_exec * NICE_0_LOAD&#47; æƒé‡ä¸­NICE_0_LOADæ˜¯ä»€ä¹ˆæ„æ€å‘¢ï¼Ÿcfsè°ƒåº¦å®ä½“æ˜¯çº¢é»‘æ ‘ï¼Œé‚£å®æ—¶è¿›ç¨‹å‘¢ï¼Œæ˜¯æ™®é€šé˜Ÿåˆ—å˜›ï¼Ÿ","like_count":2,"discussions":[{"author":{"id":1001590,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/48/76/0c7d4d23.jpg","nickname":"åˆ˜è¶…","note":"","ucode":"196BF3F499E8FE","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":450487,"discussion_content":"niceæ˜¯å¯ä»¥è°ƒæ•´ä¼˜å…ˆçº§çš„ã€‚NICE_0_LOADæ˜¯NICEå€¼ä¸º0çš„æƒé‡ï¼Œæ˜¯ä¸€ä¸ªåŸºå‡†å€¼ã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1567650246,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":306031,"user_name":"Geek_63bb29","can_delete":false,"product_type":"c1","uid":2017041,"ip_address":"","ucode":"65C27FA7531722","user_header":"http://thirdwx.qlogo.cn/mmopen/vi_32/5kv7IqibneNnMLqtWZQR5f1et8lJmoxiaU43Ttzz3zqW7QzBqMkib8GCtImKsms7PPbWmTB51xRnZQAnRPfA1wVaw/132","comment_is_top":false,"comment_ctime":1628307784,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"5923275080","product_id":100024701,"comment_content":"è€å¸ˆï¼Œè¯·é—®é€šè¿‡çº¢é»‘æ ‘æ‰¾åˆ°æœ€å·¦è¾¹çš„rb_nodeåï¼Œå¦‚ä½•å®šä½åˆ°å¯¹åº”task_structè¿›ç¨‹å‘€ï¼Ÿ","like_count":1},{"had_liked":false,"id":225875,"user_name":"è¹¦å“’","can_delete":false,"product_type":"c1","uid":1458931,"ip_address":"","ucode":"56591A657DE7C7","user_header":"http://thirdwx.qlogo.cn/mmopen/vi_32/DYAIOgq83epcs6PibsP9vEXv4EibUw3bhQPUK04zRTOvfrvF08TwM67xPb1LBh2uRENHQwo2VqYfC5GhJmM7icxHA/132","comment_is_top":false,"comment_ctime":1591880231,"is_pvip":false,"replies":[{"id":"83464","content":"èµ","user_name":"ä½œè€…å›å¤","comment_id":225875,"uid":"1001590","ip_address":"","utype":1,"ctime":1592186076,"user_name_real":"åˆ˜è¶…@ç½‘æ˜“äº‘"}],"discussion_count":1,"race_medal":0,"score":"5886847527","product_id":100024701,"comment_content":"çœ‹åˆ°SCHED_DEADLINEï¼Œæƒ³åˆ°äº†Reactä¸­çš„Fiberè°ƒåº¦ç­–ç•¥ï¼Œä¼˜å…ˆå®Œæˆè·ç¦»è¶…æ—¶æ—¶é—´æœ€å°çš„ä»»åŠ¡","like_count":1,"discussions":[{"author":{"id":1001590,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/48/76/0c7d4d23.jpg","nickname":"åˆ˜è¶…","note":"","ucode":"196BF3F499E8FE","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":498025,"discussion_content":"èµ","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1592186076,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":163339,"user_name":"Paul Shan","can_delete":false,"product_type":"c1","uid":1593140,"ip_address":"","ucode":"32D99989028284","user_header":"","comment_is_top":false,"comment_ctime":1576701191,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"5871668487","product_id":100024701,"comment_content":"è¯·é—®è€å¸ˆï¼Œæ™®é€šè¿›ç¨‹çš„è°ƒåº¦ï¼Œåªæ˜¯é€‰æ‹©ä¸€ä¸ªä¼˜å…ˆçº§æœ€é«˜çš„ï¼Œæ„Ÿè§‰å †çš„æ•°æ®ç»“æ„æ›´åˆé€‚ï¼Œè¿™é‡Œé€‰æ‹©çº¢é»‘æ ‘æ˜¯ä¸æ˜¯æœ‰å…¶ä»–è€ƒé‡?","like_count":1},{"had_liked":false,"id":96906,"user_name":"æ¨é¢†well","can_delete":false,"product_type":"c1","uid":1145650,"ip_address":"","ucode":"3974A03855168C","user_header":"https://static001.geekbang.org/account/avatar/00/11/7b/32/60089a62.jpg","comment_is_top":false,"comment_ctime":1558533328,"is_pvip":false,"replies":[{"id":"49263","content":"æºç å¾ˆå¤šåœ°æ–¹æ˜¯æ··åˆçš„ï¼Œé‡ç‚¹çœ‹é€»è¾‘è¿‡ç¨‹å“ˆ","user_name":"ä½œè€…å›å¤","user_name_real":"åˆ˜è¶…@ç½‘æ˜“äº‘","uid":"1001590","ctime":1567608451,"ip_address":"","comment_id":96906,"utype":1}],"discussion_count":1,"race_medal":0,"score":"5853500624","product_id":100024701,"comment_content":"å»ºè®®ï¼š<br>1ã€æºç åœ¨ç¬¬ä¸€è¡Œæ ‡è®°å‡ºå…·ä½“å‡ºå¤„ï¼ˆæŸæŸæ–‡ä»¶æŸæŸè¡Œï¼‰<br>2ã€æ–‡ä¸­å‡ºç°çš„æºç å°½é‡å°†å…¶æ ‡ç­¾ï¼ˆå¦‚ï¼šagainï¼‰çš„ä½ç½®æ ‡è®°å‡ºæ¥ã€‚","like_count":1,"discussions":[{"author":{"id":1001590,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/48/76/0c7d4d23.jpg","nickname":"åˆ˜è¶…","note":"","ucode":"196BF3F499E8FE","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":451057,"discussion_content":"æºç å¾ˆå¤šåœ°æ–¹æ˜¯æ··åˆçš„ï¼Œé‡ç‚¹çœ‹é€»è¾‘è¿‡ç¨‹å“ˆ","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1567608451,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":92111,"user_name":"æ‹¾è´å£³çš„å­©å­","can_delete":false,"product_type":"c1","uid":1054038,"ip_address":"","ucode":"63118ECB55F758","user_header":"https://static001.geekbang.org/account/avatar/00/10/15/56/a969e60b.jpg","comment_is_top":false,"comment_ctime":1557189609,"is_pvip":false,"replies":[{"id":"49462","content":"æ˜¯çš„ï¼Œå¦‚æœä½ åˆ›å»ºä¸€ä¸ªrtçš„è¿›ç¨‹ï¼Œä¼šå ç”¨100%cpuï¼Œç„¶åå°±å‘ç°ç³»ç»Ÿä¸èƒ½ç”¨äº†","user_name":"ä½œè€…å›å¤","user_name_real":"åˆ˜è¶…@ç½‘æ˜“äº‘","uid":"1001590","ctime":1567671416,"ip_address":"","comment_id":92111,"utype":1}],"discussion_count":1,"race_medal":0,"score":"5852156905","product_id":100024701,"comment_content":"å¦‚æœä¼˜å…ˆé˜Ÿåˆ—ä¸€ç›´æœ‰ä»»åŠ¡,æ™®é€šé˜Ÿåˆ—çš„taskä¸€ç›´å¾—ä¸åˆ°å¤„ç†ï¼Œæ“ä½œç³»ç»Ÿä¼šæ€ä¹ˆåšå‘¢ï¼Ÿ","like_count":1,"discussions":[{"author":{"id":1001590,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/48/76/0c7d4d23.jpg","nickname":"åˆ˜è¶…","note":"","ucode":"196BF3F499E8FE","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":449150,"discussion_content":"æ˜¯çš„ï¼Œå¦‚æœä½ åˆ›å»ºä¸€ä¸ªrtçš„è¿›ç¨‹ï¼Œä¼šå ç”¨100%cpuï¼Œç„¶åå°±å‘ç°ç³»ç»Ÿä¸èƒ½ç”¨äº†","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1567671416,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":90801,"user_name":"å®‰æ’","can_delete":false,"product_type":"c1","uid":1260026,"ip_address":"","ucode":"F78CFA9624CAEF","user_header":"https://static001.geekbang.org/account/avatar/00/13/39/fa/a7edbc72.jpg","comment_is_top":false,"comment_ctime":1556665798,"is_pvip":false,"replies":[{"id":"49502","content":"è°ƒåº¦çš„æ—¶å€™è¦å‘€","user_name":"ä½œè€…å›å¤","user_name_real":"åˆ˜è¶…@ç½‘æ˜“äº‘","uid":"1001590","ctime":1567676816,"ip_address":"","comment_id":90801,"utype":1}],"discussion_count":3,"race_medal":0,"score":"5851633094","product_id":100024701,"comment_content":"è®²çš„æ¸…æ™°æ˜äº†ï¼Œä½†æ˜¯æœ‰ä¸ªç–‘é—®ï¼Œtask_structä¸­ä¸ºä»€ä¹ˆéœ€è¦æŒ‡å‘sched_classçš„æŒ‡é’ˆå‘¢ï¼Ÿæ²¡æƒ³åˆ°æœ‰å•¥ä½œç”¨ï¼Ÿ","like_count":1,"discussions":[{"author":{"id":1001590,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/48/76/0c7d4d23.jpg","nickname":"åˆ˜è¶…","note":"","ucode":"196BF3F499E8FE","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":448663,"discussion_content":"è°ƒåº¦çš„æ—¶å€™è¦å‘€","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1567676816,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1609871,"avatar":"https://static001.geekbang.org/account/avatar/00/18/90/8f/9c691a5f.jpg","nickname":"å¥”è·‘çš„ç ä»”","note":"","ucode":"AB3B02B07B8B8C","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":6216,"discussion_content":"è¿›ç¨‹åˆ‡æ¢åˆ°è¿è¡ŒçŠ¶æ€æ—¶ï¼Œéœ€è¦å°†å…¶æ·»åŠ åˆ°è°ƒåº¦é˜Ÿåˆ—ä¸­ï¼Œè¿™æ—¶å€™å°±éœ€è¦é€šè¿‡è¯¥å˜é‡æ‰€æŒ‡å‘çš„sched_classçš„enqueue_taskå°†è¿›ç¨‹æ·»åŠ åˆ°è°ƒåº¦é˜Ÿåˆ—ä¸­","likes_number":8,"is_delete":false,"is_hidden":false,"ctime":1566790852,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":1,"child_discussions":[{"author":{"id":2096666,"avatar":"https://static001.geekbang.org/account/avatar/00/1f/fe/1a/39d34ba2.jpg","nickname":"Lancerå¹¸è¿E","note":"","ucode":"2ADA1468601C05","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":1609871,"avatar":"https://static001.geekbang.org/account/avatar/00/18/90/8f/9c691a5f.jpg","nickname":"å¥”è·‘çš„ç ä»”","note":"","ucode":"AB3B02B07B8B8C","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":579361,"discussion_content":"æ¸…æ™°","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1657371939,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":6216,"ip_address":""},"score":579361,"extra":""}]}]},{"had_liked":false,"id":352335,"user_name":"| ~æµ‘è›‹~","can_delete":false,"product_type":"c1","uid":3024820,"ip_address":"","ucode":"B6904B44DFA805","user_header":"https://static001.geekbang.org/account/avatar/00/2e/27/b4/df65c0f7.jpg","comment_is_top":false,"comment_ctime":1658562771,"is_pvip":true,"discussion_count":0,"race_medal":3,"score":"1658562771","product_id":100024701,"comment_content":"æ—¢ç„¶éƒ½æ˜¯taskï¼Œæ€ä¹ˆæŸ¥çœ‹Javaé‡Œé¢çš„è¿è¡Œæ—¶çº¿ç¨‹ä¿¡æ¯","like_count":0},{"had_liked":false,"id":322567,"user_name":"Kino","can_delete":false,"product_type":"c1","uid":1255270,"ip_address":"","ucode":"CBE8588F3C302C","user_header":"https://static001.geekbang.org/account/avatar/00/13/27/66/afa629d6.jpg","comment_is_top":false,"comment_ctime":1637484797,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1637484797","product_id":100024701,"comment_content":"æœ‰ä¸ªå°ç–‘é—®ï¼Œè¯·å„ä½å¤§ç¥è§£ç­”ä¸‹ï¼Œå¯¹äºcfsï¼Œä¼˜å…ˆè°ƒåº¦vruntimeå°çš„ï¼Œé‚£ä¹ˆå¯¹äºæ–°å»ºçš„è¿›ç¨‹ï¼Œæ˜¯å¦æ€»æ˜¯vruntimeæœ€å°è€Œè·å–åˆ°å¤§éƒ¨åˆ†è°ƒåº¦æœºä¼šï¼Ÿ","like_count":0},{"had_liked":false,"id":318667,"user_name":"Jia Tiancai","can_delete":false,"product_type":"c1","uid":2548102,"ip_address":"","ucode":"EF2F5FE8A0DF3E","user_header":"","comment_is_top":false,"comment_ctime":1635385611,"is_pvip":false,"discussion_count":0,"race_medal":3,"score":"1635385611","product_id":100024701,"comment_content":"æœ‰ä¸¤ä¸ªç–‘é—®ï¼Œéº»çƒ¦è€å¸ˆæˆ–åŒå­¦å¸®å¿™è§£ç­”ä¸€ä¸‹å‘¢ï¼Œéå¸¸æ„Ÿè°¢ï¼<br>1. å‘å°±ç»ªé˜Ÿåˆ—ä¸­å¢åŠ ä¸€ä¸ªè¿›ç¨‹ï¼Œä¸Šé¢æåˆ°æ¯ä¸ªCPUéƒ½æœ‰å¯¹åº”çš„é˜Ÿåˆ—ï¼Œæ˜¯å¾€å“ªä¸ªCPUä¸­å¢åŠ è¿™ä¸ªè¿›ç¨‹å‘¢ï¼Ÿ<br>2. æ¯ä¸ªCPUéƒ½æœ‰rt_rqå’Œcfs_rqï¼Œå¦‚æœæŸä¸ªCPUçš„rt_rqä¸ºç©ºï¼Œè€Œå¦å¤–çš„CPUçš„rt_rqåˆæœ‰å¾ˆå¤šï¼Œæ€ä¹ˆä¿è¯æ•´ä¸ªç³»ç»Ÿçš„å®æ—¶è¿›ç¨‹ä¼˜å…ˆè¿è¡Œçš„å‘¢ï¼ŒCFSåˆæ€ä¹ˆä¿è¯æ•´ä¸ªç³»ç»Ÿè¿›ç¨‹è°ƒåº¦çš„å…¬å¹³æ€§çš„å‘¢?","like_count":0},{"had_liked":false,"id":311370,"user_name":"ä¸€ä¸ªè¿·è·¯çš„é‡æŒ‡é’ˆ","can_delete":false,"product_type":"c1","uid":2634743,"ip_address":"","ucode":"0FCE200DAD0CF8","user_header":"https://static001.geekbang.org/account/avatar/00/28/33/f7/542be086.jpg","comment_is_top":false,"comment_ctime":1631190659,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1631190659","product_id":100024701,"comment_content":"æœ‰ä¸ªç–‘é—®ï¼šä¸ºå•¥è¦æŠŠå®é™…è¿è¡Œæ—¶é—´è½¬æ¢ä¸ºè™šæ‹Ÿæ—¶é—´","like_count":0},{"had_liked":false,"id":308737,"user_name":"å…”å˜Ÿå˜Ÿ","can_delete":false,"product_type":"c1","uid":2028811,"ip_address":"","ucode":"5A9042B4C7670C","user_header":"https://static001.geekbang.org/account/avatar/00/1e/f5/0b/73628618.jpg","comment_is_top":false,"comment_ctime":1629776715,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1629776715","product_id":100024701,"comment_content":"è¯·é—®è€å¸ˆï¼ŒæŒ‰ç…§â€å–æœ€å°å€¼ï¼Œé¢‘ç¹æ›´æ–°ï¼Œæ”¯æŒåˆ é™¤æ’å…¥â€œçš„è¿™å‡ ä¸ªæ ‡å‡†ï¼Œé™¤äº†çº¢é»‘æ ‘ï¼Œæ˜¯ä¸æ˜¯å †å’Œè·³è¡¨ä¹Ÿç¬¦åˆï¼Œè¿™é‡Œåˆä¸ºä»€ä¹ˆä¸ä½¿ç”¨å‘¢ï¼Ÿ","like_count":0},{"had_liked":false,"id":306034,"user_name":"Geek_63bb29","can_delete":false,"product_type":"c1","uid":2017041,"ip_address":"","ucode":"65C27FA7531722","user_header":"http://thirdwx.qlogo.cn/mmopen/vi_32/5kv7IqibneNnMLqtWZQR5f1et8lJmoxiaU43Ttzz3zqW7QzBqMkib8GCtImKsms7PPbWmTB51xRnZQAnRPfA1wVaw/132","comment_is_top":false,"comment_ctime":1628309283,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1628309283","product_id":100024701,"comment_content":"è€å¸ˆï¼Œä»¥ä¸‹ä»£ç ï¼Œrb_entryæ˜¯å’‹ä»rb_nodeè·å¾—sched_entityçš„å‘¢<br>struct sched_entity *se;<br>se = rb_entry(leftmost, struct sched_entity, run_node);<br><br><br>","like_count":0},{"had_liked":false,"id":302962,"user_name":"é•¿é’","can_delete":false,"product_type":"c1","uid":1360825,"ip_address":"","ucode":"035E147C097C09","user_header":"https://static001.geekbang.org/account/avatar/00/14/c3/b9/5cd84471.jpg","comment_is_top":false,"comment_ctime":1626485804,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1626485804","product_id":100024701,"comment_content":"è€å¸ˆèƒ½ä¸¾ä¾‹è¯´æ˜ä¸€ä¸‹ï¼Œlinuxä¸Šå“ªäº›è¿›ç¨‹æ˜¯å®æ—¶è¿›ç¨‹æˆ–æ™®é€šè¿›ç¨‹å—ï¼Ÿ","like_count":0},{"had_liked":false,"id":293035,"user_name":"ç‹å»ºå³°","can_delete":false,"product_type":"c1","uid":1968013,"ip_address":"","ucode":"8BF1AEFFA7EA5F","user_header":"https://static001.geekbang.org/account/avatar/00/1e/07/8d/3e76560f.jpg","comment_is_top":false,"comment_ctime":1621164260,"is_pvip":false,"discussion_count":4,"race_medal":0,"score":"1621164260","product_id":100024701,"comment_content":"è¶…å“¥ï¼Œç°åœ¨æé—®é¢˜è¿˜æœ‰æœºä¼šèƒ½å¾—åˆ°ä½ å›å¤ä¹ˆ?","like_count":0,"discussions":[{"author":{"id":1299347,"avatar":"https://static001.geekbang.org/account/avatar/00/13/d3/93/c3fb8566.jpg","nickname":"ProcessIsTheKey","note":"","ucode":"BE02EFD75F7D98","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":375915,"discussion_content":"å“ˆå“ˆï¼Œæ²¡äº†ï¼Œæˆ‘ä¹Ÿæ˜¯æœ€è¿‘æ‰å¼€å§‹å­¦ä¹ ï¼Œ5å¹´javaå¼€å‘ç»éªŒï¼Œä½†æ˜¯ä¸€è„¸æ‡µé€¼...","likes_number":1,"is_delete":false,"is_hidden":false,"ctime":1621867148,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":1,"child_discussions":[{"author":{"id":1968013,"avatar":"https://static001.geekbang.org/account/avatar/00/1e/07/8d/3e76560f.jpg","nickname":"ç‹å»ºå³°","note":"","ucode":"8BF1AEFFA7EA5F","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":1299347,"avatar":"https://static001.geekbang.org/account/avatar/00/13/d3/93/c3fb8566.jpg","nickname":"ProcessIsTheKey","note":"","ucode":"BE02EFD75F7D98","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":377021,"discussion_content":"åŒæ„Ÿ","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1622467219,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":375915,"ip_address":""},"score":377021,"extra":""}]},{"author":{"id":1547763,"avatar":"https://static001.geekbang.org/account/avatar/00/17/9d/f3/3f6dd32b.jpg","nickname":"å¶ç´«çœŸ","note":"","ucode":"9CD7567FDB7F1F","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":375032,"discussion_content":"åº”è¯¥ä¸å¾—è¡Œäº†","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1621438965,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":1,"child_discussions":[{"author":{"id":1968013,"avatar":"https://static001.geekbang.org/account/avatar/00/1e/07/8d/3e76560f.jpg","nickname":"ç‹å»ºå³°","note":"","ucode":"8BF1AEFFA7EA5F","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":1547763,"avatar":"https://static001.geekbang.org/account/avatar/00/17/9d/f3/3f6dd32b.jpg","nickname":"å¶ç´«çœŸ","note":"","ucode":"9CD7567FDB7F1F","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":375047,"discussion_content":"ğŸ¤£","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1621468472,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":375032,"ip_address":""},"score":375047,"extra":""}]}]},{"had_liked":false,"id":287083,"user_name":"æ˜å¤©","can_delete":false,"product_type":"c1","uid":2458966,"ip_address":"","ucode":"3E8070C4C8FCD0","user_header":"https://static001.geekbang.org/account/avatar/00/25/85/56/6fe64e92.jpg","comment_is_top":false,"comment_ctime":1617768574,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1617768574","product_id":100024701,"comment_content":"è€å¸ˆ å†…æ ¸æ€é€‰æ‹©äº†ä¸€ä¸ªä»»åŠ¡åå¦‚ä½•è¿”å›ç”¨æˆ·æ€çš„ï¼Ÿ","like_count":0},{"had_liked":false,"id":278052,"user_name":"ben","can_delete":false,"product_type":"c1","uid":2097533,"ip_address":"","ucode":"3287431472A90C","user_header":"https://static001.geekbang.org/account/avatar/00/20/01/7d/36a82725.jpg","comment_is_top":false,"comment_ctime":1612741723,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1612741723","product_id":100024701,"comment_content":"è°çš„vruntimeå€¼è¾ƒå°å°±è¯´æ˜å®ƒä»¥å‰å ç”¨cpuçš„æ—¶é—´è¾ƒçŸ­ï¼Œå—åˆ°äº†â€œä¸å…¬å¹³â€å¯¹å¾…ï¼Œå› æ­¤ä¸‹ä¸€ä¸ªè¿è¡Œè¿›ç¨‹å°±æ˜¯å®ƒã€‚è¿™æ ·æ—¢èƒ½å…¬å¹³é€‰æ‹©è¿›ç¨‹ï¼Œåˆèƒ½ä¿è¯é«˜ä¼˜å…ˆçº§è¿›ç¨‹è·å¾—è¾ƒå¤šçš„è¿è¡Œæ—¶é—´ã€‚è¿™å°±æ˜¯CFSçš„ä¸»è¦æ€æƒ³äº†ã€‚","like_count":0},{"had_liked":false,"id":237283,"user_name":"ä½³ä½³å¤§é­”ç‹","can_delete":false,"product_type":"c1","uid":1235320,"ip_address":"","ucode":"D5214903D85A0F","user_header":"https://static001.geekbang.org/account/avatar/00/12/d9/78/8a328299.jpg","comment_is_top":false,"comment_ctime":1595768586,"is_pvip":false,"discussion_count":2,"race_medal":0,"score":"1595768586","product_id":100024701,"comment_content":"æœ¬æ–‡ä¸­â€œä¼˜å…ˆçº§å…¶å®å°±æ˜¯ä¸€ä¸ªæ•°å€¼ï¼Œå¯¹äºå®æ—¶è¿›ç¨‹ï¼Œä¼˜å…ˆçº§çš„èŒƒå›´æ˜¯ 0ï½99ï¼›å¯¹äºæ™®é€šè¿›ç¨‹ï¼Œä¼˜å…ˆçº§çš„èŒƒå›´æ˜¯ 100ï½139ã€‚æ•°å€¼è¶Šå°ï¼Œä¼˜å…ˆçº§è¶Šé«˜ã€‚â€<br>è€Œã€ŠLinuxå†…æ ¸è®¾è®¡ä¸å®ç°ã€‹ä¸­ï¼ˆåŸä¹¦ç¬¬3ç‰ˆç¬¬37é¡µï¼‰ï¼ŒLinuxé‡‡ç”¨äº†ä¸¤ç§ä¸åŒçš„ä¼˜å…ˆçº§èŒƒå›´ã€‚ç¬¬ä¸€ç§æ˜¯niceå€¼ï¼Œå®ƒçš„èŒƒå›´æ˜¯ä»-20åˆ°19ï¼Œé»˜è®¤å€¼ä¸º0ï¼›è¶Šå¤§çš„niceå€¼æ„å‘³ç€æ›´ä½çš„ä¼˜å…ˆçº§ï¼›ç¬¬äºŒç§èŒƒå›´æ˜¯å®æ—¶ä¼˜å…ˆçº§ï¼Œå…¶å€¼æ˜¯å¯é…ç½®çš„ï¼Œé»˜è®¤æƒ…å†µä¸‹å®ƒçš„å˜åŒ–èŒƒå›´æ˜¯ä»0åˆ°99.ä¸niceå€¼ç›¸åï¼Œè¶Šé«˜çš„å®æ—¶ä¼˜å…ˆçº§æ•°å€¼æ„å‘³ç€è¿›ç¨‹ä¼˜å…ˆçº§è¶Šé«˜ã€‚<br>è¿™ä¸¤ç§è§‚ç‚¹çŸ›ç›¾äº†å•Šï¼Œæä¸æ‡‚äº†ï¼Œè°æ¥å›ç­”æˆ‘ä¸€ä¸‹ã€‚","like_count":0,"discussions":[{"author":{"id":1399058,"avatar":"https://static001.geekbang.org/account/avatar/00/15/59/12/49458cb3.jpg","nickname":"ğŸ™„","note":"","ucode":"294786B5F39F8E","race_medal":0,"user_type":1,"is_pvip":true},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":373284,"discussion_content":"100-PRI  è¿™ä¸ªå…¬å¼è½¬æ¢ã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1620690881,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1946744,"avatar":"https://static001.geekbang.org/account/avatar/00/1d/b4/78/47011c75.jpg","nickname":"xavier","note":"","ucode":"E3C38864D3C8E4","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":310209,"discussion_content":"æœ‰å›ç­”äº†å—","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1601689323,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":235322,"user_name":"æµ·å†›ä¸Šæ ¡","can_delete":false,"product_type":"c1","uid":1104290,"ip_address":"","ucode":"7B0D9EC01A3F36","user_header":"https://static001.geekbang.org/account/avatar/00/10/d9/a2/afbc447c.jpg","comment_is_top":false,"comment_ctime":1594973635,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1594973635","product_id":100024701,"comment_content":"è€å¸ˆ~ è°ƒåº¦å™¨çš„ä¹Ÿéœ€è¦cpuæ‰§è¡Œå§ï¼Ÿ å®ƒæ˜¯ä»€ä¹ˆæœºåˆ¶","like_count":0},{"had_liked":false,"id":233224,"user_name":"åšä¸€ä¸ªç§¯æçš„è·³èš¤","can_delete":false,"product_type":"c1","uid":2035956,"ip_address":"","ucode":"BBE367BBCB6C28","user_header":"http://thirdwx.qlogo.cn/mmopen/vi_32/ecruTrMgzvqIs5iaWVibZw4Rxic42ZXGTflvOFHiaZEkf32Su01gDCWT8tdIcEoybg0ibAYU2Q8f9bleL7Q37fKguxQ/132","comment_is_top":false,"comment_ctime":1594264158,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1594264158","product_id":100024701,"comment_content":"è¯·é—®è€å¸ˆï¼Œåˆ©ç”¨cpuäº²å’Œæ€§æ¥å£pthread_setaffinity_np è®©çº¿ç¨‹ç‹¬å cpuæ˜¯ä»€ä¹ˆåŸç†å‘¢ï¼Ÿ","like_count":0},{"had_liked":false,"id":232679,"user_name":"æ¢¦æƒ³çš„ä¼˜æƒ åˆ¸","can_delete":false,"product_type":"c1","uid":1257418,"ip_address":"","ucode":"D3B44F6C618CA7","user_header":"https://static001.geekbang.org/account/avatar/00/13/2f/ca/cbce6e94.jpg","comment_is_top":false,"comment_ctime":1594087289,"is_pvip":false,"discussion_count":0,"race_medal":4,"score":"1594087289","product_id":100024701,"comment_content":"æ¯ä¸ªCPUä¸Šéƒ½æœ‰ä¸€ä¸ªé˜Ÿåˆ—ï¼Œé‚£æœ‰æ²¡æœ‰å¯èƒ½ï¼Œå½“æœ‰å¤šä¸ªCPUçš„æ—¶å€™ï¼Œé˜Ÿåˆ—ä¸­å‡ºç°ç›¸åŒçš„ä»»åŠ¡ï¼Ÿå¦‚ï¼šCPU1å’ŒCPU2çš„é˜Ÿåˆ—ä¸­ï¼Œéƒ½æœ‰ä»»åŠ¡task1ï¼Œç„¶ååœ¨åŒä¸€æ—¶åˆ»ï¼Œtask1è¢«CPU1å’ŒCPU2åŒæ—¶æ‰§è¡Œï¼Ÿ","like_count":0},{"had_liked":false,"id":220196,"user_name":"ç é—ªé—ª","can_delete":false,"product_type":"c1","uid":1300447,"ip_address":"","ucode":"45BE0D586A3839","user_header":"http://thirdwx.qlogo.cn/mmopen/vi_32/DYAIOgq83eov38ZkwCyNoBdr5drgX0cp2eOGCv7ibkhUIqCvcnFk8FyUIS6K4gHXIXh0fu7TB67jaictdDlic4OwQ/132","comment_is_top":false,"comment_ctime":1590202297,"is_pvip":false,"replies":[{"id":"83074","content":"å¯åŠ¨çš„æ—¶å€™ï¼Œå…¶å®åªè¦åˆå§‹åŒ–ä¸€ä¸ªå¤´å°±å¥½äº†","user_name":"ä½œè€…å›å¤","user_name_real":"åˆ˜è¶…@ç½‘æ˜“äº‘","uid":"1001590","ctime":1591785476,"ip_address":"","comment_id":220196,"utype":1}],"discussion_count":2,"race_medal":0,"score":"1590202297","product_id":100024701,"comment_content":"åˆ˜è¶…è€å¸ˆï¼Œæ¯ä¸ªCPUä¸Šçš„ä»»åŠ¡é˜Ÿåˆ—æ˜¯è°åˆ†é…çš„ï¼Ÿä»€ä¹ˆæ—¶å€™åˆ†é…çš„ï¼Ÿ","like_count":0,"discussions":[{"author":{"id":1001590,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/48/76/0c7d4d23.jpg","nickname":"åˆ˜è¶…","note":"","ucode":"196BF3F499E8FE","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":496080,"discussion_content":"å¯åŠ¨çš„æ—¶å€™ï¼Œå…¶å®åªè¦åˆå§‹åŒ–ä¸€ä¸ªå¤´å°±å¥½äº†","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1591785476,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1104290,"avatar":"https://static001.geekbang.org/account/avatar/00/10/d9/a2/afbc447c.jpg","nickname":"æµ·å†›ä¸Šæ ¡","note":"","ucode":"7B0D9EC01A3F36","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":291848,"discussion_content":"è€å¸ˆ~ å°±æ˜¯å“ªä¸ªtaskè¯¥è¿›å…¥å“ªä¸ªcpué˜Ÿåˆ—æ˜¯æ€ä¹ˆå†³å®šçš„ï¼Ÿ","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1594973291,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":191063,"user_name":"æœ‰ç±³","can_delete":false,"product_type":"c1","uid":1005042,"ip_address":"","ucode":"C9A10B7A67BC12","user_header":"https://static001.geekbang.org/account/avatar/00/0f/55/f2/ba68d931.jpg","comment_is_top":false,"comment_ctime":1584721213,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1584721213","product_id":100024701,"comment_content":"æ„Ÿè§‰è·Ÿåˆ†å¸ƒå¼ç³»ç»Ÿçš„è´Ÿè½½å‡è¡¡ç­–ç•¥å¤§åŒå°å¼‚ï¼Œè®¾è®¡æ¨¡å¼å°±æ˜¯ï¼šç­–ç•¥æ¨¡å¼","like_count":0},{"had_liked":false,"id":182148,"user_name":"monchickey","can_delete":false,"product_type":"c1","uid":1513948,"ip_address":"","ucode":"D7B670444F62B3","user_header":"https://static001.geekbang.org/account/avatar/00/17/19/dc/9d3ed421.jpg","comment_is_top":false,"comment_ctime":1582721013,"is_pvip":false,"discussion_count":1,"race_medal":0,"score":"1582721013","product_id":100024701,"comment_content":"è€å¸ˆä½ å¥½ï¼Œæˆ‘æƒ³é—®ä¸€ä¸‹å‡å¦‚ä¸¤ä¸ªè¿›ç¨‹ä¼˜å…ˆçº§ç›¸åŒï¼Œ1ä¸ªè¿›ç¨‹æ˜¯çº¯è®¡ç®—ä¼šä¸€ç›´å ç”¨cpuï¼Œè€Œå¦ä¸€ä¸ªè¿›ç¨‹æ˜¯é¢‘ç¹ioæ“ä½œï¼Œè¿™ä¸ªè¿›ç¨‹ç¨å¾®å ç”¨ä¸€ç‚¹vruntimeå°±é©¬ä¸Šè¿›å…¥é˜»å¡äº†ï¼Œå°±ä¼šè¢«å‰è€…æŠ¢å ï¼Œè€Œå‰è€…åªèƒ½æ˜¯è¢«åŠ¨è¢«è°ƒåº¦ï¼Œè¿™æ ·å²‚ä¸æ˜¯ä¸¤ä¸ªè¿›ç¨‹çš„vruntimeä¼šè¶Šå·®è¶Šå¤§ï¼Œå’Œcfsæœ‰äº›çŸ›ç›¾äº†ï¼Œè¿™é‡Œä¸€ç›´æƒ³ä¸é€šï¼Œè¯·é—®å®é™…æ˜¯å•¥æƒ…å†µå‘¢ï¼Ÿ","like_count":0,"discussions":[{"author":{"id":1478179,"avatar":"https://static001.geekbang.org/account/avatar/00/16/8e/23/7d2e4f70.jpg","nickname":"ç³å½±","note":"","ucode":"1A01E5CB41EDA9","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":282032,"discussion_content":"å¯ä»¥çœ‹ä¸€ä¸‹è¿™ä¸ªï¼šhttps://www.jianshu.com/p/673c9e4817a8ï¼Œé‡Œé¢ min_vruntime çš„æè¿°","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1591864815,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":170510,"user_name":"sun","can_delete":false,"product_type":"c1","uid":1136181,"ip_address":"","ucode":"948FD34662AFB0","user_header":"https://static001.geekbang.org/account/avatar/00/11/56/35/eeee9309.jpg","comment_is_top":false,"comment_ctime":1578623415,"is_pvip":false,"replies":[{"id":"66276","content":"ä¸ä¼šçš„","user_name":"ä½œè€…å›å¤","user_name_real":"åˆ˜è¶…@ç½‘æ˜“äº‘","uid":"1001590","ctime":1578823882,"ip_address":"","comment_id":170510,"utype":1}],"discussion_count":2,"race_medal":0,"score":"1578623415","product_id":100024701,"comment_content":"è€å¸ˆï¼Œè¯·é—®åŒä¸€ä¸ªtaskä¼šå‡ºç°åœ¨æ‰€æœ‰cpuçš„é˜Ÿåˆ—ä¸­å—","like_count":0,"discussions":[{"author":{"id":1001590,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/48/76/0c7d4d23.jpg","nickname":"åˆ˜è¶…","note":"","ucode":"196BF3F499E8FE","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":481002,"discussion_content":"ä¸ä¼šçš„","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1578823882,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1798979,"avatar":"https://static001.geekbang.org/account/avatar/00/1b/73/43/ae139b1f.jpg","nickname":"åš","note":"","ucode":"F7CA69FF5D09BA","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":231516,"discussion_content":"é‚£ä¸€ä¸ªè¿›ç¨‹å¼€äº†ä¸‰ä¸ªçº¿ç¨‹ï¼Œä¸‰ä¸ªçº¿ç¨‹è¿è¡Œåœ¨ä¸‰ä¸ªCPUæ‰§è¡Œï¼Œä½†æ˜¯ä»–ä»¬æ˜¯å±äºåŒä¸€ä¸ªè¿›åŸå§ï¼Œå°±å’ŒåŒä¸€ä¸ªtaskå‡ºç°åœ¨æ‰€æœ‰CPUçš„é˜Ÿåˆ—ä¸Šå§ï¼Œå‡è®¾ä¸‰ä¸ªCPUã€‚ã€‚è€Œä¸”è¿™é‡Œçš„æ‰€æœ‰CPUè¿˜æ˜¯CPUçš„æ‰€æœ‰é˜Ÿåˆ—è¯´çš„ä¸æ˜¯å¾ˆæ¸…æ¥šå§","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1586822181,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":168641,"user_name":"Roger","can_delete":false,"product_type":"c1","uid":1106324,"ip_address":"","ucode":"59E190F8F14281","user_header":"https://static001.geekbang.org/account/avatar/00/10/e1/94/de3f0409.jpg","comment_is_top":false,"comment_ctime":1578130057,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1578130057","product_id":100024701,"comment_content":"è™½ç„¶å†…æ ¸ä¸‹æ˜¯ä¼˜å…ˆçº§è¶Šä½æ˜¯è¶Šé«˜ï¼Œ å®æ—¶è¿›ç¨‹(0-99),è¿™é‡Œåº”è¯¥æ˜¯æ•°å€¼è¶Šé«˜ä¼˜å…ˆçº§è¶Šé«˜ï¼Œåº”è¯¥æ˜¯å†…æ ¸ä¼šåšè½¬æ¢ã€‚è¯·è€å¸ˆç¡®è®¤ä¸€ä¸‹ã€‚","like_count":0},{"had_liked":false,"id":155305,"user_name":"czh","can_delete":false,"product_type":"c1","uid":1159078,"ip_address":"","ucode":"649FE5C9269D69","user_header":"https://static001.geekbang.org/account/avatar/00/11/af/a6/3f15ba2f.jpg","comment_is_top":false,"comment_ctime":1574676664,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1574676664","product_id":100024701,"comment_content":"1.è¦äº†è§£æœ‰å“ªäº›éƒ¨åˆ†ï¼Œè¿™äº›éƒ¨åˆ†ä¹‹é—´çš„å‰åå…³ç³»æ˜¯å•¥ï¼ˆæµç¨‹å›¾ï¼‰ã€‚<br>2.æ‘˜æŠ„ï¼šä¸€ä¸ª CPU ä¸Šæœ‰ä¸€ä¸ªé˜Ÿåˆ—ï¼ŒCFS çš„é˜Ÿåˆ—æ˜¯ä¸€æ£µçº¢é»‘æ ‘ï¼Œæ ‘çš„æ¯ä¸€ä¸ªèŠ‚ç‚¹éƒ½æ˜¯ä¸€ä¸ª sched_entityï¼Œæ¯ä¸ª sched_entity éƒ½å±äºä¸€ä¸ª task_structï¼Œtask_struct é‡Œé¢æœ‰æŒ‡é’ˆæŒ‡å‘è¿™ä¸ªè¿›ç¨‹å±äºå“ªä¸ªè°ƒåº¦ç±»ã€‚<br>3.è¿™å¥è¯å°±è®²è§£äº†æµç¨‹å›¾ä¹‹é—´å„ä¸ªéƒ¨åˆ†ä¹‹é—´çš„å…³ç³»ã€‚<br>4.å‰å‡ éå­¦ä¹ æ³¨é‡æµç¨‹ä»¥åŠå…¶ä¸­çš„å…³ç³»ï¼","like_count":0},{"had_liked":false,"id":146474,"user_name":"æŸ³é•¿é’","can_delete":false,"product_type":"c1","uid":1716747,"ip_address":"","ucode":"3EA2B7BD5DBCAF","user_header":"http://thirdwx.qlogo.cn/mmopen/vi_32/1pMbwZrAl5gVy4FictX9HiaDicYOjRI2E6flxrXLhLTcneF74TowWK6rJW6oKs9iakPl0dqHsWjav0TjK6vyEZTlJA/132","comment_is_top":false,"comment_ctime":1572532563,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1572532563","product_id":100024701,"comment_content":"æˆ‘å¯ä»¥è¿™ä¹ˆç†è§£å—ï¼šå°±æ˜¯æ‰€æœ‰çš„è°ƒåº¦ç­–ç•¥éƒ½æ˜¯ç³»ç»Ÿé»˜è®¤è®¾ç½®å¥½äº†ï¼Œå¹¶ä¸èƒ½å•ç‹¬è®¾ç½®ä¸ªåˆ«è¿›ç¨‹çš„è°ƒåº¦ç­–ç•¥ï¼Œå¦‚æœè¦æ›´æ”¹ç³»ç»Ÿçš„è°ƒåº¦ç­–ç•¥æ€ä¹ˆåŠï¼Ÿ","like_count":0},{"had_liked":false,"id":127759,"user_name":"å¥”è·‘çš„ç ä»”","can_delete":false,"product_type":"c1","uid":1609871,"ip_address":"","ucode":"AB3B02B07B8B8C","user_header":"https://static001.geekbang.org/account/avatar/00/18/90/8f/9c691a5f.jpg","comment_is_top":false,"comment_ctime":1566788610,"is_pvip":false,"replies":[{"id":"48773","content":"è¿›ç¨‹ã€‚<br><br>å“ˆå“ˆå“ˆ","user_name":"ä½œè€…å›å¤","user_name_real":"åˆ˜è¶…@ç½‘æ˜“äº‘","uid":"1001590","ctime":1567495623,"ip_address":"","comment_id":127759,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1566788610","product_id":100024701,"comment_content":"â€œå¦‚æœæ²¡æœ‰æ‰ä¼šå» CFS è¿è¡Œé˜Ÿåˆ—æ‰¾æ˜¯å¦æœ‰è¿›è¡Œéœ€è¦è¿è¡Œâ€","like_count":0,"discussions":[{"author":{"id":1001590,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/48/76/0c7d4d23.jpg","nickname":"åˆ˜è¶…","note":"","ucode":"196BF3F499E8FE","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":464641,"discussion_content":"è¿›ç¨‹ã€‚\n\nå“ˆå“ˆå“ˆ","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1567495623,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":115553,"user_name":"å”è£è½©","can_delete":false,"product_type":"c1","uid":1268732,"ip_address":"","ucode":"D225DC43E94D23","user_header":"http://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTJ8a5dg6aBRohA4bQ5KcHdDt6nCnrk0PiarfnVZ3zsgrBbjayAG1bhuAEfyZaNpplnXYDytZlWpfkA/132","comment_is_top":false,"comment_ctime":1563621048,"is_pvip":false,"replies":[{"id":"46558","content":"å“ˆå“ˆï¼Œæ­§è§†èƒ–å­","user_name":"ä½œè€…å›å¤","user_name_real":"åˆ˜è¶…@ç½‘æ˜“äº‘","uid":"1001590","ctime":1566356937,"ip_address":"","comment_id":115553,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1563621048","product_id":100024701,"comment_content":"èƒ–å­åƒé¦’å¤´è¿™ä¸ªä¾‹å­ï¼Œæ”¹æˆæ¬ç –åƒé¦’å¤´å¯èƒ½æ›´åˆé€‚ã€‚é«˜çº§æ¬ç –å·¥åƒä¸¤ä¸ªï¼Œä¸€èˆ¬æ¬ç –å·¥åƒ1ä¸ª","like_count":0,"discussions":[{"author":{"id":1001590,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/48/76/0c7d4d23.jpg","nickname":"åˆ˜è¶…","note":"","ucode":"196BF3F499E8FE","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":459157,"discussion_content":"å“ˆå“ˆï¼Œæ­§è§†èƒ–å­","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1566356937,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":115298,"user_name":"Regina","can_delete":false,"product_type":"c1","uid":1135151,"ip_address":"","ucode":"2256559FB9A8D7","user_header":"http://thirdwx.qlogo.cn/mmopen/vi_32/vTku9cFYPh2T8DSImQoPRLxgSibcVgCRYqMcEYibexxLkfn9IKhUSAasZ7QoB72SDWym31niah2y00ibRWdHibibib1wQ/132","comment_is_top":false,"comment_ctime":1563526689,"is_pvip":false,"replies":[{"id":"46565","content":"ä¸æ˜¯è½®æµï¼Œæ˜¯æŒ‰vruntimeé€‰æ‹©æœ€å°çš„è¿è¡Œ","user_name":"ä½œè€…å›å¤","user_name_real":"åˆ˜è¶…@ç½‘æ˜“äº‘","uid":"1001590","ctime":1566357832,"ip_address":"","comment_id":115298,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1563526689","product_id":100024701,"comment_content":"æ¯ä¸ª CPU éƒ½æœ‰ rq ç»“æ„ä½“ï¼Œæ˜¯è½®æµæ‰§è¡Œtaské˜Ÿåˆ—é‡Œé¢çš„taskå—","like_count":0,"discussions":[{"author":{"id":1001590,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/48/76/0c7d4d23.jpg","nickname":"åˆ˜è¶…","note":"","ucode":"196BF3F499E8FE","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":459045,"discussion_content":"ä¸æ˜¯è½®æµï¼Œæ˜¯æŒ‰vruntimeé€‰æ‹©æœ€å°çš„è¿è¡Œ","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1566357832,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":114363,"user_name":"Marshall","can_delete":false,"product_type":"c1","uid":1476507,"ip_address":"","ucode":"0FB004E8163F44","user_header":"https://static001.geekbang.org/account/avatar/00/16/87/9b/8bebc8b6.jpg","comment_is_top":false,"comment_ctime":1563282785,"is_pvip":false,"replies":[{"id":"46611","content":"å¯ä»¥__migrate_task","user_name":"ä½œè€…å›å¤","user_name_real":"åˆ˜è¶…@ç½‘æ˜“äº‘","uid":"1001590","ctime":1566366796,"ip_address":"","comment_id":114363,"utype":1}],"discussion_count":2,"race_medal":0,"score":"1563282785","product_id":100024701,"comment_content":"è€å¸ˆä¸€ä¸ªtaskç»‘å®šå®Œä¸€ä¸ªcpuä»¥å è¿˜ä¼šè§£ç»‘å»ç„¶åäº¤ç»™å…¶ä»–cpuå—","like_count":0,"discussions":[{"author":{"id":1001590,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/48/76/0c7d4d23.jpg","nickname":"åˆ˜è¶…","note":"","ucode":"196BF3F499E8FE","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":458625,"discussion_content":"å¯ä»¥__migrate_task","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1566366796,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1135151,"avatar":"http://thirdwx.qlogo.cn/mmopen/vi_32/vTku9cFYPh2T8DSImQoPRLxgSibcVgCRYqMcEYibexxLkfn9IKhUSAasZ7QoB72SDWym31niah2y00ibRWdHibibib1wQ/132","nickname":"Regina","note":"","ucode":"2256559FB9A8D7","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":3106,"discussion_content":"æˆ‘ä¹Ÿæƒ³é—®è¿™ä¸ªé—®é¢˜ï¼Œä½ çŸ¥é“äº†ä¹ˆ","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1564191032,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":108180,"user_name":"Amark","can_delete":false,"product_type":"c1","uid":1121326,"ip_address":"","ucode":"E5F48633654002","user_header":"https://static001.geekbang.org/account/avatar/00/11/1c/2e/93812642.jpg","comment_is_top":false,"comment_ctime":1561691370,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1561691370","product_id":100024701,"comment_content":"è¯·é—®åˆ˜è€å¸ˆï¼Œå°±ç»ªé˜Ÿåˆ—ï¼Œè¿˜æœ‰é˜»å¡é˜Ÿåˆ—åœ¨å“ªé‡Œ","like_count":0},{"had_liked":false,"id":102600,"user_name":"youyui","can_delete":false,"product_type":"c1","uid":1501890,"ip_address":"","ucode":"4CBD130E31CAEA","user_header":"https://static001.geekbang.org/account/avatar/00/16/ea/c2/445977ea.jpg","comment_is_top":false,"comment_ctime":1560260791,"is_pvip":false,"replies":[{"id":"49134","content":"ä¼šè°ƒåº¦åˆ°å…¶ä»–cpuçš„ï¼Œä½†æ˜¯å½“å‰çš„æ—¶é—´ç‰‡æ²¡å¿…è¦","user_name":"ä½œè€…å›å¤","user_name_real":"åˆ˜è¶…@ç½‘æ˜“äº‘","uid":"1001590","ctime":1567596338,"ip_address":"","comment_id":102600,"utype":1}],"discussion_count":2,"race_medal":0,"score":"1560260791","product_id":100024701,"comment_content":"ä¸€ä¸ªtaskæ˜¯ä¸æ˜¯æ°¸è¿œåªèƒ½ç»‘å®šåœ¨ä¸€ä¸ªCPUçš„rqä¸Šï¼Œä¸ä¼šåœ¨å…¶ä»–CPUä¸Šè¿è¡Œäº†ï¼Ÿæœ‰æ²¡æœ‰ ä¸€ä¸ªCPUæ¯”è¾ƒé—²ï¼Œå»å…¶ä»–æ¯”è¾ƒå¿™çš„CPUé‚£çªƒå–ç‚¹ä»»åŠ¡çš„æœºåˆ¶ï¼Ÿ","like_count":0,"discussions":[{"author":{"id":1001590,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/48/76/0c7d4d23.jpg","nickname":"åˆ˜è¶…","note":"","ucode":"196BF3F499E8FE","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":453494,"discussion_content":"ä¼šè°ƒåº¦åˆ°å…¶ä»–cpuçš„ï¼Œä½†æ˜¯å½“å‰çš„æ—¶é—´ç‰‡æ²¡å¿…è¦","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1567596338,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1122150,"avatar":"https://static001.geekbang.org/account/avatar/00/11/1f/66/59e0647a.jpg","nickname":"ä¸‡å†åäº”å¹´","note":"","ucode":"3D8CF5DF847AE8","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":288437,"discussion_content":"åœ¨å¤šå¤„ç†å™¨ç¯å¢ƒä¸‹ï¼Œæœ‰ä¸ªè´Ÿè½½å‡è¡¡å™¨ï¼ŒåŸºäºå„cpuçš„ç®—åŠ›å’Œå„cpuä¸Šschedule entityæ¥è®¡ç®—è´Ÿè½½ï¼Œå½“ä¸€ä¸ªtaskè¢«åˆ†é…åˆ°æŸä¸ªcpuä¹‹åï¼Œå› ä¸ºcacheçš„å­˜åœ¨ï¼Œé€šå¸¸ä¼šä¸€ç›´åœ¨è¿™ä¸ªäº²å’Œåº¦æ¯”è¾ƒé«˜çš„cpuä¸Šè¿è¡Œï¼Œç›´åˆ°è´Ÿè½½å‡è¡¡å™¨å†æ¬¡è´Ÿè½½å‡è¡¡","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1593750181,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":93615,"user_name":"ä¸€æ­¥","can_delete":false,"product_type":"c1","uid":1005391,"ip_address":"","ucode":"73CEA468CE70C3","user_header":"https://static001.geekbang.org/account/avatar/00/0f/57/4f/6fb51ff1.jpg","comment_is_top":false,"comment_ctime":1557536478,"is_pvip":true,"replies":[{"id":"49396","content":"ä¼˜å…ˆçº§é«˜çš„åº”è¯¥å¤šåˆ†æ—¶é—´","user_name":"ä½œè€…å›å¤","user_name_real":"åˆ˜è¶…@ç½‘æ˜“äº‘","uid":"1001590","ctime":1567654634,"ip_address":"","comment_id":93615,"utype":1}],"discussion_count":1,"race_medal":1,"score":"1557536478","product_id":100024701,"comment_content":"è™šæ‹Ÿè¿è¡Œæ—¶é—´ vruntime += å®é™…è¿è¡Œæ—¶é—´ delta_exec * NICE_0_LOAD&#47; æƒé‡<br>åŒæ ·çš„å®é™…è¿è¡Œæ—¶é—´ï¼Œç»™é«˜æƒé‡çš„ç®—å°‘äº†ï¼Œä½æƒé‡çš„ç®—å¤šäº†<br><br>è¿™é‡Œçš„æƒé‡ä¸æ˜¯ä¼˜å…ˆçº§å§ï¼Œé‚£ä¹ˆæƒé‡å’Œä¼˜å…ˆçº§æ˜¯æ€ä¹ˆä¸ªå¯¹åº”å…³ç³»å‘¢ï¼Ÿ<br><br>","like_count":0,"discussions":[{"author":{"id":1001590,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/48/76/0c7d4d23.jpg","nickname":"åˆ˜è¶…","note":"","ucode":"196BF3F499E8FE","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":449700,"discussion_content":"ä¼˜å…ˆçº§é«˜çš„åº”è¯¥å¤šåˆ†æ—¶é—´","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1567654634,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":93450,"user_name":"éƒ‘æ™¨Cc","can_delete":false,"product_type":"c1","uid":1324942,"ip_address":"","ucode":"57146E444D6329","user_header":"https://static001.geekbang.org/account/avatar/00/14/37/8e/cf0b4575.jpg","comment_is_top":false,"comment_ctime":1557473729,"is_pvip":false,"replies":[{"id":"49398","content":"æŸ¥æ‰¾å¿«ï¼Œä¹Ÿä¸éœ€è¦é¢‘ç¹è°ƒæ•´ã€‚","user_name":"ä½œè€…å›å¤","user_name_real":"åˆ˜è¶…@ç½‘æ˜“äº‘","uid":"1001590","ctime":1567654856,"ip_address":"","comment_id":93450,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1557473729","product_id":100024701,"comment_content":"CFSå¯¹vruntime çš„æ’åºä¸ºå•¥è¦ç”¨å¤æ‚çš„çº¢é»‘æ ‘å‘¢ï¼Ÿä»–åªéœ€è¦çŸ¥é“æœ€å°çš„vruntimeå’Œæ’å…¥æ–°çš„vruntime ï¼Œä¹Ÿä¸éœ€è¦éšæœºçš„æŸ¥è¯¢ï¼ŒæŒ‰ç†è¯´ç”¨å°é¡¶å †æ›´åˆé€‚çš„å•Š ","like_count":0,"discussions":[{"author":{"id":1001590,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/48/76/0c7d4d23.jpg","nickname":"åˆ˜è¶…","note":"","ucode":"196BF3F499E8FE","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":449638,"discussion_content":"æŸ¥æ‰¾å¿«ï¼Œä¹Ÿä¸éœ€è¦é¢‘ç¹è°ƒæ•´ã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1567654856,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":93251,"user_name":"ä¸€æ­¥","can_delete":false,"product_type":"c1","uid":1005391,"ip_address":"","ucode":"73CEA468CE70C3","user_header":"https://static001.geekbang.org/account/avatar/00/0f/57/4f/6fb51ff1.jpg","comment_is_top":false,"comment_ctime":1557448053,"is_pvip":true,"replies":[{"id":"49402","content":"ç”¨ä¸äº†è¿™ä¹ˆå¤šçº§åˆ«","user_name":"ä½œè€…å›å¤","user_name_real":"åˆ˜è¶…@ç½‘æ˜“äº‘","uid":"1001590","ctime":1567656542,"ip_address":"","comment_id":93251,"utype":1}],"discussion_count":1,"race_medal":1,"score":"1557448053","product_id":100024701,"comment_content":"å¯¹äºå®æ—¶è¿›ç¨‹ï¼Œä¼˜å…ˆçº§çš„èŒƒå›´æ˜¯ 0ï½99ï¼›å¯¹äºæ™®é€šè¿›ç¨‹ï¼Œä¼˜å…ˆçº§çš„èŒƒå›´æ˜¯ 100~139<br>è¿™é‡Œä¸ºä»€ä¹ˆ å®æ—¶è¿›ç¨‹ çš„èŒƒå›´æ˜¯100ï¼Œè€Œæ™®é€šè¿›ç¨‹çš„ä¼˜å…ˆçº§èŒƒå›´æ‰æ˜¯40 ï¼Ÿ<br>","like_count":0,"discussions":[{"author":{"id":1001590,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/48/76/0c7d4d23.jpg","nickname":"åˆ˜è¶…","note":"","ucode":"196BF3F499E8FE","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":449545,"discussion_content":"ç”¨ä¸äº†è¿™ä¹ˆå¤šçº§åˆ«","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1567656542,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":92530,"user_name":"nora","can_delete":false,"product_type":"c1","uid":1206539,"ip_address":"","ucode":"3A3EABF27D0261","user_header":"https://static001.geekbang.org/account/avatar/00/12/69/0b/780b0aac.jpg","comment_is_top":false,"comment_ctime":1557293292,"is_pvip":false,"replies":[{"id":"49426","content":"é‚£ä¸æ˜¯ï¼Œçœ‹çº¿ç¨‹åˆ›å»ºé‚£ä¸€èŠ‚","user_name":"ä½œè€…å›å¤","user_name_real":"åˆ˜è¶…@ç½‘æ˜“äº‘","uid":"1001590","ctime":1567663138,"ip_address":"","comment_id":92530,"utype":1}],"discussion_count":3,"race_medal":0,"score":"1557293292","product_id":100024701,"comment_content":"æ‰€ä»¥Linuxä¸‹å…¶å®è¿›ç¨‹å’Œçº¿ç¨‹ä¸€æ ·çš„ï¼Œéƒ½ä¼šå ç”¨taskï¼Œæ•…Linuxä¸‹çº¿ç¨‹å¹¶ä¸ä¼šæ¯”è¿›ç¨‹è½»é‡çº§ï¼Ÿ","like_count":0,"discussions":[{"author":{"id":1001590,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/48/76/0c7d4d23.jpg","nickname":"åˆ˜è¶…","note":"","ucode":"196BF3F499E8FE","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":449304,"discussion_content":"é‚£ä¸æ˜¯ï¼Œçœ‹çº¿ç¨‹åˆ›å»ºé‚£ä¸€èŠ‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1567663138,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1122150,"avatar":"https://static001.geekbang.org/account/avatar/00/11/1f/66/59e0647a.jpg","nickname":"ä¸‡å†åäº”å¹´","note":"","ucode":"3D8CF5DF847AE8","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":288445,"discussion_content":"è¿›ç¨‹æ˜¯èµ„æºåˆ†é…å•ä½ï¼Œçº¿ç¨‹æ˜¯è°ƒåº¦å•ä½ã€‚è¿›ç¨‹ä¹Ÿæ˜¯é€šè¿‡çº¿ç¨‹æ¥å®ç°è¿è¡Œçš„ï¼Œæ‰€ä»¥å¯¹äºlinuxå†…æ ¸è°ƒåº¦æ¥è¯´ï¼Œçœ¼ç›é‡Œåªæœ‰taskã€‚åœ¨è°ƒåº¦çš„æ—¶å€™ï¼ŒåŒä¸€è¿›ç¨‹å†…çš„å¤šçº¿ç¨‹ä¹‹é—´çš„è°ƒåº¦æˆæœ¬è¦å°äºä¸åŒè¿›ç¨‹ä¹‹é—´çš„åˆ‡æ¢ï¼›è€Œä¸”çº¿ç¨‹çš„åˆ›å»ºå’Œé”€æ¯æˆæœ¬ä¹Ÿå°äºè¿›ç¨‹ï¼Œæ‰€ä»¥çº¿ç¨‹è¿˜æ˜¯æ¯”è¿›ç¨‹è½»ã€‚","likes_number":1,"is_delete":false,"is_hidden":false,"ctime":1593750788,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1315006,"avatar":"https://static001.geekbang.org/account/avatar/00/14/10/be/2920e011.jpg","nickname":"æ¸…è’¸","note":"","ucode":"4AFB34F84F49A8","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":1411,"discussion_content":"è¿˜æ˜¯è¦è½»é‡çº§çš„ã€‚è¿›ç¨‹åˆ›å»ºéœ€è¦çš„èµ„æºæ¯”è¾ƒå¤šï¼Œé”€æ¯ä¹Ÿç›¸å¯¹éº»çƒ¦ã€‚çº¿ç¨‹èµ„æºå…±äº«ï¼Œè¦è½»é‡ä¸€äº›","likes_number":1,"is_delete":false,"is_hidden":false,"ctime":1562603356,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":92147,"user_name":"Helios","can_delete":false,"product_type":"c1","uid":1380758,"ip_address":"","ucode":"BE6B98EE8F0D09","user_header":"http://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTKJrOl63enWXCRxN0SoucliclBme0qrRb19ATrWIOIvibKIz8UAuVgicBMibIVUznerHnjotI4dm6ibODA/132","comment_is_top":false,"comment_ctime":1557191985,"is_pvip":false,"replies":[{"id":"49461","content":"åˆä¸æ˜¯é©¬ä¸Šç»“æŸï¼Œå…ˆæ‰“ä¸€ä¸ªflagï¼Œéœ€è¦è¢«è°ƒåº¦ã€‚è¿˜æ˜¯ä¼šå½“å‰æ—¶é—´ç‰‡ç»“æŸçš„ã€‚è‡³äºä¸‹ä¸ªæ—¶é—´ç‰‡ï¼Œæœ¬æ¥å°±ä¸ä¸€å®šæ˜¯ä»–å‘€ã€‚","user_name":"ä½œè€…å›å¤","user_name_real":"åˆ˜è¶…@ç½‘æ˜“äº‘","uid":"1001590","ctime":1567671138,"ip_address":"","comment_id":92147,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1557191985","product_id":100024701,"comment_content":"â€œæ¯æ¬¡æ–°è¿›ç¨‹åˆ›å»ºå®Œæ¯•åï¼Œéƒ½ä¼šè¯•å›¾å…ˆè®©æ–°çš„æŠ¢å ä¸€æ¬¡â€ã€‚<br><br>é‚£å¦‚æœä¸æ–­æœ‰æ–°çš„ä»»åŠ¡è¿›æ¥ï¼Œé‚£å²‚ä¸æ˜¯å¯¹ä»¥å‰çš„ä»»åŠ¡ä¸å…¬å¹³äº†å‘¢ï¼Œå°¤å…¶æ˜¯é‚£äº›å¿«è¿è¡Œå®Œï¼ˆå¯èƒ½å°±å·®å‡ ä¸ªæ—¶é—´ç‰‡äº†ï¼‰çš„ä»»åŠ¡ã€‚","like_count":0,"discussions":[{"author":{"id":1001590,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/48/76/0c7d4d23.jpg","nickname":"åˆ˜è¶…","note":"","ucode":"196BF3F499E8FE","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":449159,"discussion_content":"åˆä¸æ˜¯é©¬ä¸Šç»“æŸï¼Œå…ˆæ‰“ä¸€ä¸ªflagï¼Œéœ€è¦è¢«è°ƒåº¦ã€‚è¿˜æ˜¯ä¼šå½“å‰æ—¶é—´ç‰‡ç»“æŸçš„ã€‚è‡³äºä¸‹ä¸ªæ—¶é—´ç‰‡ï¼Œæœ¬æ¥å°±ä¸ä¸€å®šæ˜¯ä»–å‘€ã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1567671138,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":92141,"user_name":"Helios","can_delete":false,"product_type":"c1","uid":1380758,"ip_address":"","ucode":"BE6B98EE8F0D09","user_header":"http://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTKJrOl63enWXCRxN0SoucliclBme0qrRb19ATrWIOIvibKIz8UAuVgicBMibIVUznerHnjotI4dm6ibODA/132","comment_is_top":false,"comment_ctime":1557191878,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1557191878","product_id":100024701,"comment_content":"â€œæ¯æ¬¡æ–°è¿›ç¨‹åˆ›å»ºå®Œæ¯•åï¼Œéƒ½ä¼šè¯•å›¾å…ˆè®©æ–°çš„æŠ¢å ä¸€æ¬¡â€ã€‚å› ä¸ºvruntimeæ¯”è¾ƒå°ï¼Œé‚£å¦‚æœä¸€ç›´æœ‰æ–°çš„ä»»åŠ¡è¿›æ¥ï¼Œæ˜¯ä¸æ˜¯å¯¹","like_count":0},{"had_liked":false,"id":91230,"user_name":"leon","can_delete":false,"product_type":"c1","uid":1260247,"ip_address":"","ucode":"2A6F8A10330A81","user_header":"https://static001.geekbang.org/account/avatar/00/13/3a/d7/454a1b90.jpg","comment_is_top":false,"comment_ctime":1556938236,"is_pvip":false,"replies":[{"id":"32858","content":"æ˜¯çš„ï¼Œå«ä»»åŠ¡è°ƒåº¦å§","user_name":"ä½œè€…å›å¤","user_name_real":"åˆ˜è¶…@ç½‘æ˜“äº‘","uid":"1001590","ctime":1557155020,"ip_address":"","comment_id":91230,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1556938236","product_id":100024701,"comment_content":"Linuxçš„æœ€å°è°ƒåº¦å•ä½æ˜¯çº¿ç¨‹ï¼Œæ¯ä¸ªè¿›ç¨‹åˆè‡³å°‘éƒ½æœ‰ä¸€ä¸ªçº¿ç¨‹ï¼Œå½“æˆ‘ä»¬åœ¨è°ˆLinuxè°ƒåº¦çš„æ—¶å€™ä¸ºå•¥ä¸è¯´æ˜¯çº¿ç¨‹è°ƒåº¦ï¼Ÿæ‰€è°“çš„è¿›ç¨‹è°ƒåº¦æ˜¯è¯´çš„ä¹Ÿæ˜¯è°ƒåº¦çš„é‡Œé¢çš„çº¿ç¨‹å—ï¼Ÿé‚£æ˜¯ä¸æ˜¯å°±æ²¡æœ‰æ‰€è°“çš„è¿›ç¨‹è°ƒåº¦äº†å‘¢ï¼Ÿ","like_count":0,"discussions":[{"author":{"id":1001590,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/48/76/0c7d4d23.jpg","nickname":"åˆ˜è¶…","note":"","ucode":"196BF3F499E8FE","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":448851,"discussion_content":"æ˜¯çš„ï¼Œå«ä»»åŠ¡è°ƒåº¦å§","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1557155020,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":91195,"user_name":"å°é¾™çš„åŸå ¡","can_delete":false,"product_type":"c1","uid":1005727,"ip_address":"","ucode":"7F1F9704548E2D","user_header":"https://static001.geekbang.org/account/avatar/00/0f/58/9f/abb7bfe3.jpg","comment_is_top":false,"comment_ctime":1556901329,"is_pvip":false,"replies":[{"id":"49489","content":"çº¢é»‘æ ‘å€’è…¾çš„å°‘ã€‚å¯¹çš„ã€‚","user_name":"ä½œè€…å›å¤","user_name_real":"åˆ˜è¶…@ç½‘æ˜“äº‘","uid":"1001590","ctime":1567675332,"ip_address":"","comment_id":91195,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1556901329","product_id":100024701,"comment_content":"è€å¸ˆï¼Œæœ‰ä¸¤ä¸ªç–‘é—®ï¼š1.cfsæ¨¡å¼ä¸‹ï¼Œåœ¨é€‰å–ä¸‹ä¸€ä¸ªè¦æ‰§è¡Œçš„ä»»åŠ¡ä¸ºä»€ä¹ˆä¸ç”¨ä¼˜å…ˆçº§é˜Ÿåˆ—ï¼Œè€Œç”¨çº¢é»‘æ ‘ï¼Œæˆ‘è§‰å¾—æ— éå°±æ˜¯å–ä¸‹ä¸€ä¸ªè¿è¡Œæ—¶é—´æœ€å°‘çš„ä»»åŠ¡ï¼Œæ²¡æœ‰æŸ¥è¯¢çš„éœ€æ±‚ï¼›2.è¯¾åä¹ é¢˜æ˜¯ä¸æ˜¯è¦ç”¨åˆ°æœ‰å…³è®¾ç½®è¿›åŸç±»å‹çš„ç³»ç»Ÿè°ƒç”¨æ‰èƒ½å®Œæˆï¼Œæ¯•ç«Ÿè°ƒåº¦å‘ç”Ÿåœ¨å†…æ ¸æ€ã€‚å¤šè°¢è€å¸ˆï¼","like_count":0,"discussions":[{"author":{"id":1001590,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/48/76/0c7d4d23.jpg","nickname":"åˆ˜è¶…","note":"","ucode":"196BF3F499E8FE","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":448840,"discussion_content":"çº¢é»‘æ ‘å€’è…¾çš„å°‘ã€‚å¯¹çš„ã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1567675332,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]}]}