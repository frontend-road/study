{"id":803829,"title":"02ï½œä»0åˆ°1å¿«é€Ÿæ­å»ºRAGåº”ç”¨","content":"<blockquote>\n<p><span class=\"reference\">æœ¬é—¨è¯¾ç¨‹ä¸ºç²¾å“å°è¯¾ï¼Œä¸æ ‡é…éŸ³é¢‘</span></p>\n</blockquote><p>ä½ å¥½ï¼Œæˆ‘æ˜¯å¸¸æ‰¬ã€‚</p><p>ä¸ŠèŠ‚è¯¾æˆ‘ä»¬è¯¦ç»†æ¢è®¨äº†RAGï¼ˆRetrieval-Augmented Generation, æ£€ç´¢å¢å¼ºç”Ÿæˆï¼‰çš„æŠ€æœ¯èƒŒæ™¯ã€åº”ç”¨åœºæ™¯ä»¥åŠæŠ€æœ¯æµç¨‹ã€‚è¿™èŠ‚è¯¾æˆ‘ä»¬å°†è¿›å…¥ä»£ç å®æˆ˜ï¼Œ<strong>ä»0åˆ°1å¿«é€Ÿæ­å»ºRAGåº”ç”¨</strong>ã€‚æˆ‘ä»¬ä¼šä½¿ç”¨å¹¿æ³›æµè¡Œçš„å¼€æºåº“æ­å»ºæ ¸å¿ƒæ¡†æ¶ï¼Œå®ŒæˆRAGæµç¨‹çš„ä»£ç æ„å»ºã€‚åç»­è¯¾ç¨‹å°†åŸºäºè¿™èŠ‚è¯¾çš„å®æˆ˜é¡¹ç›®ï¼Œè¿›ä¸€æ­¥æ·±å…¥åˆ†æå„æµç¨‹çš„æ ¸å¿ƒæŠ€æœ¯ç»†èŠ‚åŠåº”ç”¨ä¼˜åŒ–ï¼Œæä¾›æ›´å¤šæŠ€æœ¯é€‰å‹çš„å»ºè®®å’Œå®æˆ˜ä»£ç ã€‚</p><p>è¿™èŠ‚è¯¾ä»£ç å®æˆ˜å†…å®¹åŒ…æ‹¬æŠ€æœ¯æ¡†æ¶çš„ä»‹ç»ä¸é€‰å‹ã€å¼€å‘ç¯å¢ƒæ­å»ºä¸æŠ€æœ¯åº“å®‰è£…ã€RAGæµç¨‹çš„ä»£ç å®ç°ã€‚æ‰€æœ‰ç›¸å…³ä»£ç æˆ‘éƒ½ä¼šå…¬å¼€åœ¨Giteeå¹³å°ä¸Šï¼Œä¾›ä½ å‚è€ƒå’Œä½¿ç”¨ã€‚</p><h2>æŠ€æœ¯æ¡†æ¶ä¸é€‰å‹</h2><p>æˆ‘ä»¬å…ˆæ¥æ¢è®¨RAGæŠ€æœ¯çš„æ¡†æ¶ä¸é€‰å‹é—®é¢˜ã€‚æˆ‘ä»¬è¯¾ç¨‹ä¸­çš„é€‰å‹å¹¶éé€‚ç”¨äºæ‰€æœ‰åœºæ™¯çš„æœ€ä½³æ–¹æ¡ˆï¼Œè€Œæ˜¯åŸºäºå½“å‰å¹¿æ³›åº”ç”¨å’Œæµè¡Œçš„æŠ€æœ¯æ¨¡å—ã€‚å…³äºè¿™äº›æ¨¡å—çš„å…·ä½“ç‰¹ç‚¹ä»¥åŠå¯èƒ½çš„æ›¿ä»£é€‰å‹ï¼Œæˆ‘ä»¬ä¼šåœ¨åç»­è¯¾ç¨‹ä¸­è¿›è¡Œè¯¦ç»†åˆ†æä¸è§£è¯»ã€‚</p><p><strong>RAGæŠ€æœ¯æ¡†æ¶ï¼šLangChain</strong></p><p>LangChainæ˜¯ä¸“ä¸ºå¼€å‘åŸºäºå¤§å‹è¯­è¨€æ¨¡å‹ï¼ˆLLMï¼‰åº”ç”¨è€Œè®¾è®¡çš„å…¨é¢æ¡†æ¶ï¼Œå…¶æ ¸å¿ƒç›®æ ‡æ˜¯ç®€åŒ–å¼€å‘è€…çš„æ„å»ºæµç¨‹ï¼Œä½¿å…¶èƒ½å¤Ÿé«˜æ•ˆåˆ›å»ºLLMé©±åŠ¨çš„åº”ç”¨ã€‚</p><p><strong>ç´¢å¼•æµç¨‹ - æ–‡æ¡£è§£ææ¨¡å—ï¼špypdf</strong></p><p>pypdfæ˜¯ä¸€ä¸ªå¼€æºçš„Pythonåº“ï¼Œä¸“é—¨ç”¨äºå¤„ç†PDFæ–‡æ¡£ã€‚pypdfæ”¯æŒPDFæ–‡æ¡£çš„åˆ›å»ºã€è¯»å–ã€ç¼–è¾‘å’Œè½¬æ¢æ“ä½œï¼Œèƒ½å¤Ÿæœ‰æ•ˆæå–å’Œå¤„ç†æ–‡æœ¬ã€å›¾åƒåŠé¡µé¢å†…å®¹ã€‚</p><!-- [[[read_end]]] --><p><strong>ç´¢å¼•æµç¨‹ - æ–‡æ¡£åˆ†å—æ¨¡å—ï¼šRecursiveCharacterTextSplitter</strong></p><p>é‡‡ç”¨LangChainé»˜è®¤çš„æ–‡æœ¬åˆ†å‰²å™¨-RecursiveCharacterTextSplitterã€‚è¯¥åˆ†å‰²å™¨é€šè¿‡å±‚æ¬¡åŒ–çš„åˆ†éš”ç¬¦ï¼ˆä»åŒæ¢è¡Œç¬¦åˆ°å•å­—ç¬¦ï¼‰æ‹†åˆ†æ–‡æœ¬ï¼Œæ—¨åœ¨ä¿æŒæ–‡æœ¬çš„ç»“æ„å’Œè¿è´¯æ€§ï¼Œä¼˜å…ˆè€ƒè™‘è‡ªç„¶è¾¹ç•Œå¦‚æ®µè½å’Œå¥å­ã€‚</p><p><strong>ç´¢å¼•/æ£€ç´¢æµç¨‹ - å‘é‡åŒ–æ¨¡å‹ï¼šbge-small-zh-v1.5</strong></p><p>bge-small-zh-v1.5æ˜¯ç”±åŒ—äº¬äººå·¥æ™ºèƒ½ç ”ç©¶é™¢ï¼ˆBAAIï¼Œæ™ºæºï¼‰å¼€å‘çš„å¼€æºå‘é‡æ¨¡å‹ã€‚è™½ç„¶æ¨¡å‹ä½“ç§¯è¾ƒå°ï¼Œä½†ä»ç„¶èƒ½å¤Ÿæä¾›é«˜ç²¾åº¦å’Œé«˜æ•ˆçš„ä¸­æ–‡å‘é‡æ£€ç´¢ã€‚è¯¥æ¨¡å‹çš„å‘é‡ç»´åº¦ä¸º512ï¼Œæœ€å¤§è¾“å…¥é•¿åº¦åŒæ ·ä¸º512ã€‚</p><p><strong>ç´¢å¼•/æ£€ç´¢æµç¨‹ - å‘é‡åº“ï¼šFaiss</strong></p><p>Faisså…¨ç§°Facebook AI Similarity Searchï¼Œç”±Facebook AI Researchå›¢é˜Ÿå¼€æºçš„å‘é‡åº“ï¼Œå› å…¶ç¨³å®šæ€§å’Œé«˜æ•ˆæ€§åœ¨å‘é‡æ£€ç´¢é¢†åŸŸå¹¿å—æ¬¢è¿ã€‚</p><p><strong>ç”Ÿæˆæµç¨‹ - å¤§è¯­è¨€æ¨¡å‹ï¼šé€šä¹‰åƒé—® Qwen</strong></p><p>é€šä¹‰åƒé—®Qwenæ˜¯é˜¿é‡Œäº‘æ¨å‡ºçš„ä¸€æ¬¾è¶…å¤§è§„æ¨¡è¯­è¨€æ¨¡å‹ï¼Œæ”¯æŒå¤šè½®å¯¹è¯ã€æ–‡æ¡ˆåˆ›ä½œã€é€»è¾‘æ¨ç†ã€å¤šæ¨¡æ€ç†è§£ä»¥åŠå¤šè¯­è¨€å¤„ç†ï¼Œåœ¨æ¨¡å‹æ€§èƒ½å’Œå·¥ç¨‹åº”ç”¨ä¸­è¡¨ç°å‡ºè‰²ã€‚é‡‡ç”¨äº‘ç«¯APIæœåŠ¡ï¼Œæ³¨å†Œæœ‰1,000,000 tokençš„å…è´¹é¢åº¦ã€‚</p><p>ä¸Šè¿°é€‰å‹åœ¨RAGæµç¨‹å›¾ä¸­çš„åº”ç”¨å¦‚ä¸‹æ‰€ç¤ºï¼š</p><p><img src=\"https://static001.geekbang.org/resource/image/65/c0/65a9694a63bdb6108504f9586c0a05c0.jpg?wh=1920x866\" alt=\"å›¾ç‰‡\"></p><ul>\n<li><strong>LangChainï¼š</strong>æä¾›ç”¨äºæ„å»ºLLM RAGçš„åº”ç”¨ç¨‹åºæ¡†æ¶ã€‚</li>\n<li><strong>ç´¢å¼•æµç¨‹ï¼š</strong>ä½¿ç”¨ <strong>pypdf</strong> å¯¹æ–‡æ¡£è¿›è¡Œè§£æå¹¶æå–ä¿¡æ¯ï¼›éšåï¼Œé‡‡ç”¨ <strong>RecursiveCharacterTextSplitter</strong> å¯¹æ–‡æ¡£å†…å®¹è¿›è¡Œåˆ†å—ï¼ˆchunksï¼‰ï¼›æœ€åï¼Œåˆ©ç”¨ <strong>bge-small-zh-v1.5</strong> å°†åˆ†å—å†…å®¹è¿›è¡Œå‘é‡åŒ–å¤„ç†ï¼Œå¹¶å°†ç”Ÿæˆçš„å‘é‡å­˜å‚¨åœ¨ <strong>Faiss</strong> å‘é‡åº“ä¸­ã€‚</li>\n<li><strong>æ£€ç´¢æµç¨‹ï¼š</strong>ä½¿ç”¨ <strong>bge-small-zh-v1.5</strong> å¯¹ç”¨æˆ·çš„æŸ¥è¯¢ï¼ˆQueryï¼‰è¿›è¡Œå‘é‡åŒ–å¤„ç†ï¼›ç„¶åï¼Œé€šè¿‡ <strong>Faiss</strong> å‘é‡åº“å¯¹æŸ¥è¯¢å‘é‡å’Œæ–‡æœ¬å—å‘é‡è¿›è¡Œç›¸ä¼¼åº¦åŒ¹é…ï¼Œä»è€Œæ£€ç´¢å‡ºä¸ç”¨æˆ·æŸ¥è¯¢æœ€ç›¸ä¼¼çš„å‰ <strong>top-k</strong> ä¸ªæ–‡æœ¬å—ï¼ˆchunkï¼‰ã€‚</li>\n<li><strong>ç”Ÿæˆæµç¨‹ï¼š</strong>é€šè¿‡è®¾å®šæç¤ºæ¨¡æ¿ï¼ˆPromptï¼‰ï¼Œå°†ç”¨æˆ·çš„æŸ¥è¯¢ä¸æ£€ç´¢åˆ°çš„å‚è€ƒæ–‡æœ¬å—ç»„åˆè¾“å…¥åˆ° <strong>Qwen</strong> å¤§æ¨¡å‹ä¸­ï¼Œç”Ÿæˆæœ€ç»ˆçš„ RAG å›ç­”ã€‚</li>\n</ul><h2>å¼€å‘ç¯å¢ƒä¸æŠ€æœ¯åº“</h2><p>æˆ‘ä»¬é‡‡ç”¨Pythonç¼–ç¨‹è¯­è¨€ï¼ŒPythonç‰ˆæœ¬3.8åŠä»¥ä¸Šï¼Œè¿è¡ŒäºLinuxæ“ä½œç³»ç»Ÿä¸‹ã€‚ç»“åˆä¸Šè¿°çš„æŠ€æœ¯æ¡†æ¶ä¸é€‰å‹ï¼Œæˆ‘ä»¬çš„å¼€å‘ç¯å¢ƒéœ€è¦æŒ‰ç…§ä»¥ä¸‹æ­¥éª¤è¿›è¡Œå‡†å¤‡ï¼š</p><ol>\n<li><strong>åˆ›å»ºå¹¶æ¿€æ´»è™šæ‹Ÿç¯å¢ƒ</strong>ï¼šç›®çš„æ˜¯éš”ç¦»é¡¹ç›®ä¾èµ–ï¼Œé¿å…é¡¹ç›®ä¹‹é—´å†²çªã€‚å…ˆåœ¨å‘½ä»¤è¡Œçª—å£ä¸­æ‰§è¡ŒæŒ‡ä»¤å®šä½åˆ°å…·ä½“çš„RAGé¡¹ç›®æ–‡ä»¶å¤¹ï¼Œç„¶ååœ¨å‘½ä»¤è¡Œä¸­æ‰§è¡Œä»¥ä¸‹æŒ‡ä»¤ï¼š</li>\n</ol><pre><code class=\"language-plain\">python3 -m venv rag_env  # åˆ›å»ºåä¸ºrag_envçš„è™šæ‹Ÿç¯å¢ƒ\nsource rag_env/bin/activate  # æ¿€æ´»è™šæ‹Ÿç¯å¢ƒ\n</code></pre><ol start=\"2\">\n<li><strong>å®‰è£…æŠ€æœ¯ä¾èµ–åº“</strong>ï¼šåŒ…æ‹¬langchainã€langchain_community LLM RAGçš„æŠ€æœ¯æ¡†æ¶åŠå…¶æ‰©å±•ï¼Œpypdf å¤„ç†PDFæ–‡æ¡£çš„è§£æåº“ï¼Œsentence-transformers è¿è¡ŒæŒ‡å®šæ–‡æœ¬åµŒå…¥æ¨¡å‹ bge-small-zh-v1.5 çš„æ¨¡å‹åº“ï¼Œfaiss-cpu é«˜æ•ˆç›¸ä¼¼åº¦æœç´¢çš„ Faiss å‘é‡åº“ï¼Œdashscope ä¸é˜¿é‡Œäº‘Qwenå¤§æ¨¡å‹APIçš„é›†æˆåº“ã€‚</li>\n</ol><p>é¦–å…ˆï¼Œå‡çº§pipç‰ˆæœ¬ï¼Œä»¥ç¡®ä¿å…¼å®¹æ€§ï¼Œåœ¨å‘½ä»¤è¡Œä¸­æ‰§è¡Œä»¥ä¸‹æŒ‡ä»¤ï¼š</p><pre><code class=\"language-plain\">pip install --upgrade pip  # å‡çº§pipç‰ˆæœ¬ä»¥ç¡®ä¿å…¼å®¹æ€§\n</code></pre><p>ç„¶åï¼Œå®‰è£…ä¸Šè¿°æŠ€æœ¯ä¾èµ–åº“ï¼Œåœ¨å‘½ä»¤è¡Œä¸­æ‰§è¡Œä»¥ä¸‹æŒ‡ä»¤ï¼š</p><pre><code class=\"language-plain\">pip install langchain langchain_community pypdf sentence-transformers faiss-cpu dashscope\n</code></pre><p>å¦‚æœæ— æ³•è¿æ¥ï¼Œå¯ä»¥ä½¿ç”¨å›½å†…é•œåƒç«™ç‚¹ï¼Œåœ¨å‘½ä»¤è¡Œä¸­æ‰§è¡Œä»¥ä¸‹æŒ‡ä»¤ï¼š</p><pre><code class=\"language-plain\">pip install langchain langchain_community pypdf sentence-transformers faiss-cpu dashscope -i https://pypi.tuna.tsinghua.edu.cn/simple&nbsp;\n</code></pre><ol start=\"3\">\n<li><strong>ä¸‹è½½bge-small-zh-v1.5æ¨¡å‹</strong>ï¼šè¯¥æ¨¡å‹çš„æ–‡ä»¶å·²åŒ…å«åœ¨ Gitee ä¸Šæ‰˜ç®¡çš„é¡¹ç›®ä¸­çš„ <strong>bge-small-zh-v1.5</strong> æ–‡ä»¶å¤¹å†…ï¼Œä½ å¯ä»¥ç›´æ¥ä¸‹è½½åˆ°RAGé¡¹ç›®çš„æ ¹ç›®å½•ä¸­ï¼Œæ¨¡å‹å¤§å°95.8Mï¼Œåœ¨å‘½ä»¤è¡Œä¸­æ‰§è¡Œä»¥ä¸‹æŒ‡ä»¤ï¼š</li>\n</ol><pre><code class=\"language-plain\">git clone https://gitee.com/techleadcy/rag_app.git\n</code></pre><p>ä¸‹è½½è¿‡ç¨‹éœ€è¦ä¸€äº›æ—¶é—´ï¼Œä¸è¦å…³é—­å‘½ä»¤è¡Œçª—å£ã€‚ä¸‹è½½å®Œæˆåï¼Œæ£€æŸ¥ rag_app é¡¹ç›®ä¸­ bge-small-zh-v1.5 æ–‡ä»¶å¤¹ä¸­æ˜¯å¦åŒ…å«pytorch_model.binæ–‡ä»¶ã€‚è¯¥åº“ä¸­åŒæ—¶åŒ…å«äº†æœ¬è®²çš„RAGæ ¸å¿ƒæµç¨‹ä»£ç rag_app_lesson2.pyåŠæµ‹è¯•PDFæ–‡æ¡£test_lesson2.pdfã€‚</p><ol>\n<li><strong>å‡†å¤‡æµ‹è¯• PDF æ–‡æ¡£</strong>ï¼šGitee ä¸Šæ‰˜ç®¡çš„é¡¹ç›®ä¸­åŒ…å«ä¸€ä»½åä¸º test_lesson2.pdf çš„æ•°å­—åŒ–è½¬å‹æŠ¥å‘Šã€‚è¿™ä¸ªæŠ¥å‘Šæ¶µç›–äº†æ•°å­—åŒ–è½¬å‹çš„èƒŒæ™¯å’Œæ„ä¹‰ã€æ¡ˆä¾‹åˆ†æï¼Œä»¥åŠåˆ¶é€ ä¸šã€é›¶å”®ä¸šã€é‡‘èä¸šçš„æ•°å­—åŒ–è½¬å‹ç­‰ç« èŠ‚ã€‚ä½ ä¹Ÿå¯ä»¥æ›¿æ¢æˆè‡ªå·±çš„ PDF æ–‡ä»¶ï¼Œå¹¶æ›´æ”¹æŸ¥è¯¢é—®é¢˜ï¼Œä½“éªŒ RAG åº”ç”¨çš„æ•ˆæœã€‚</li>\n</ol><p>å®Œæˆä»¥ä¸Šæ­¥éª¤åï¼ŒRAGåº”ç”¨å¼€å‘æ‰€éœ€çš„ç¯å¢ƒåŠæŠ€æœ¯ä¾èµ–åº“å°±å·²å‡†å¤‡å°±ç»ªã€‚</p><h2>RAGæ ¸å¿ƒæµç¨‹ä»£ç </h2><p>åœ¨å®æˆ˜è¿‡ç¨‹ä¸­ï¼Œä½ ä¸ä»…å¯ä»¥å¿«é€Ÿæ„å»ºRAGåº”ç”¨ï¼Œè¿˜èƒ½å¤Ÿåœ¨ç ”å‘è¿‡ç¨‹ä¸­æ·±å…¥ç†è§£å…¶èƒŒåçš„æŠ€æœ¯é€»è¾‘ä¸æ ¸å¿ƒåŸç†ã€‚ä¸ºæ­¤ï¼Œæˆ‘åœ¨ä»£ç çš„æ¯ä¸€è¡Œæ·»åŠ äº†å¿…è¦çš„æ³¨é‡Šï¼Œå¹¶å¯¹æ¯æ®µæµç¨‹ä»£ç è¿›è¡Œäº†å½’çº³å’Œè§£é‡Šï¼Œæ—¨åœ¨é€šè¿‡å®æˆ˜ä»£ç å¢å¼ºä½ å¯¹RAGæŠ€æœ¯çš„ç†è§£ã€‚</p><p>æ•´ä¸ªæµç¨‹ä»£ç åˆ†ä¸ºæ¨¡å—åº“çš„å¼•å…¥ã€ç´¢å¼•æµç¨‹ã€æ£€ç´¢æµç¨‹ã€ç”Ÿæˆæµç¨‹ä»¥åŠæµ‹è¯•ä»£ç å‡ éƒ¨åˆ†è¿›è¡Œç²¾ç»†è®²è§£ï¼Œå…·ä½“çš„ä»£ç ä½äºGiteeé¡¹ç›®åº“ä¸­çš„rag_app_lesson2.pyæ–‡ä»¶ä¸­ã€‚</p><p><strong>æ¨¡å—åº“çš„å¼•å…¥</strong></p><pre><code class=\"language-plain\">from langchain_community.document_loaders import PyPDFLoader # PDFæ–‡æ¡£æå–\nfrom langchain_text_splitters import RecursiveCharacterTextSplitter # æ–‡æ¡£æ‹†åˆ†chunk\nfrom sentence_transformers import SentenceTransformer # åŠ è½½å’Œä½¿ç”¨Embeddingæ¨¡å‹\nimport faiss # Faisså‘é‡åº“\nimport numpy as np # å¤„ç†åµŒå…¥å‘é‡æ•°æ®ï¼Œç”¨äºFaisså‘é‡æ£€ç´¢\nimport dashscope #è°ƒç”¨Qwenå¤§æ¨¡å‹\nfrom http import HTTPStatus #æ£€æŸ¥ä¸Qwenæ¨¡å‹HTTPè¯·æ±‚çŠ¶æ€\n\nimport os # å¼•å…¥æ“ä½œç³»ç»Ÿåº“ï¼Œåç»­é…ç½®ç¯å¢ƒå˜é‡ä¸è·å¾—å½“å‰æ–‡ä»¶è·¯å¾„ä½¿ç”¨\nos.environ[\"TOKENIZERS_PARALLELISM\"] = \"false\" # ä¸ä½¿ç”¨åˆ†è¯å¹¶è¡ŒåŒ–æ“ä½œ, é¿å…å¤šçº¿ç¨‹æˆ–å¤šè¿›ç¨‹ç¯å¢ƒä¸­è¿è¡Œå¤šä¸ªæ¨¡å‹å¼•å‘å†²çªæˆ–æ­»é”\n\n# è®¾ç½®Qwenç³»åˆ—å…·ä½“æ¨¡å‹åŠå¯¹åº”çš„è°ƒç”¨APIå¯†é’¥ï¼Œä»é˜¿é‡Œäº‘ç™¾ç‚¼å¤§æ¨¡å‹æœåŠ¡å¹³å°è·å¾—\nqwen_model = \"qwen-turbo\"\nqwen_api_key = \"your_api_key\"\n</code></pre><p>é˜¿é‡Œäº‘ç™¾ç‚¼å¤§æ¨¡å‹æœåŠ¡å¹³å°è·å–çš„<strong>Qwenå¤§æ¨¡å‹</strong>çš„APIå¯†é’¥æµç¨‹å¦‚ä¸‹ï¼š</p><ol>\n<li>æ‰“å¼€<a href=\"https://www.aliyun.com/product/bailian\">é˜¿é‡Œäº‘ç™¾ç‚¼å¤§æ¨¡å‹æœåŠ¡å¹³å°</a> ï¼Œç‚¹å‡»ç«‹å³å¼€é€šï¼Œç™»é™†é˜¿é‡Œäº‘/æ”¯ä»˜å®/é’‰é’‰è´¦å·ï¼›</li>\n<li>ç‚¹å‡»æ¨¡å‹å¹¿åœºï¼Œæœç´¢ é€šä¹‰åƒé—®-Turboï¼Œç‚¹å‡»API è°ƒç”¨ç¤ºä¾‹ï¼›</li>\n<li>ç‚¹å‡»æŸ¥çœ‹æˆ‘çš„API-KEYï¼Œç»§ç»­ç‚¹å‡»å¼¹å‡ºæ¡†ä¸­çš„æŸ¥çœ‹ï¼Œå¤åˆ¶API-KEYï¼Œå°†API-KEYæ›¿æ¢ä»£ç ä¸­qwen_api_key = â€œyour_api_keyâ€ï¼›</li>\n<li>ç‚¹å‡»æ¨¡å‹è¯¦æƒ…ï¼Œå¯ä»¥çœ‹åˆ°æ¨¡å‹Modelè‹±æ–‡åç§°ï¼Œèµ‹å€¼qwen_modelå‚æ•°ã€‚å¯ä»¥çœ‹åˆ°å‰©ä½™é¢åº¦ï¼Œå½“å‰é˜¿é‡Œäº‘æä¾›1,000,000æ¬¡çš„å…è´¹æ¨¡å‹é¢åº¦ï¼›</li>\n<li>å¦‚æœéœ€è¦å°è¯•å…¶ä»–æ¨¡å‹ï¼Œå¯ä»¥å¯¹åº”èµ‹å€¼ä¸Šè¿°ä»£ç ä¸­qwen_modelå‚æ•°åŠqwen_api_keyå‚æ•°ã€‚</li>\n</ol><p>ä»¥ä¸Šä»£ç å¯¼å…¥äº†æˆ‘ä»¬åœ¨RAGæµç¨‹ä¸­éœ€è¦ä½¿ç”¨çš„æ ¸å¿ƒæ¨¡å—åŠå¤§æ¨¡å‹å‚æ•°ç­‰é…ç½®ï¼Œè¿™äº›æ¨¡å—å’Œé…ç½®å°†åœ¨åç»­çš„ç´¢å¼•ã€æ£€ç´¢å’Œç”Ÿæˆæµç¨‹ä¸­è°ƒç”¨ä½¿ç”¨ã€‚</p><p><strong>ç´¢å¼•æµç¨‹</strong></p><pre><code class=\"language-plain\">def load_embedding_model():\n    \"\"\"\n    åŠ è½½bge-small-zh-v1.5æ¨¡å‹\n    :return: è¿”å›åŠ è½½çš„bge-small-zh-v1.5æ¨¡å‹\n    \"\"\"\n    print(f\"åŠ è½½Embeddingæ¨¡å‹ä¸­\")\n    # SentenceTransformerè¯»å–ç»å¯¹è·¯å¾„ä¸‹çš„bge-small-zh-v1.5æ¨¡å‹ï¼Œéä¸‹è½½\n    embedding_model = SentenceTransformer(os.path.abspath('rag_app/bge-small-zh-v1.5'))\n    print(f\"bge-small-zh-v1.5æ¨¡å‹æœ€å¤§è¾“å…¥é•¿åº¦: {embedding_model.max_seq_length}\") \n    return embedding_model\n\n\ndef indexing_process(pdf_file, embedding_model):\n    \"\"\"\n    ç´¢å¼•æµç¨‹ï¼šåŠ è½½PDFæ–‡ä»¶ï¼Œå¹¶å°†å…¶å†…å®¹åˆ†å‰²æˆå°å—ï¼Œè®¡ç®—è¿™äº›å°å—çš„åµŒå…¥å‘é‡å¹¶å°†å…¶å­˜å‚¨åœ¨FAISSå‘é‡æ•°æ®åº“ä¸­ã€‚\n    :param pdf_file: PDFæ–‡ä»¶è·¯å¾„\n    :param embedding_model: é¢„åŠ è½½çš„åµŒå…¥æ¨¡å‹\n    :return: è¿”å›FaissåµŒå…¥å‘é‡ç´¢å¼•å’Œåˆ†å‰²åçš„æ–‡æœ¬å—åŸå§‹å†…å®¹åˆ—è¡¨\n    \"\"\"\n    # PyPDFLoaderåŠ è½½PDFæ–‡ä»¶ï¼Œå¿½ç•¥å›¾ç‰‡æå–\n    pdf_loader = PyPDFLoader(pdf_file, extract_images=False)\n    # é…ç½®RecursiveCharacterTextSplitteråˆ†å‰²æ–‡æœ¬å—åº“å‚æ•°ï¼Œæ¯ä¸ªæ–‡æœ¬å—çš„å¤§å°ä¸º512å­—ç¬¦ï¼ˆétokenï¼‰ï¼Œç›¸é‚»æ–‡æœ¬å—ä¹‹é—´çš„é‡å 128å­—ç¬¦ï¼ˆétokenï¼‰\n    text_splitter = RecursiveCharacterTextSplitter(\n        chunk_size=512, chunk_overlap=128\n    )\n    # åŠ è½½PDFæ–‡æ¡£,æå–æ‰€æœ‰é¡µçš„æ–‡æœ¬å†…å®¹\n    pdf_content_list = pdf_loader.load()\n    # å°†æ¯é¡µçš„æ–‡æœ¬å†…å®¹ç”¨æ¢è¡Œç¬¦è¿æ¥ï¼Œåˆå¹¶ä¸ºPDFæ–‡æ¡£çš„å®Œæ•´æ–‡æœ¬\n    pdf_text = \"\\n\".join([page.page_content for page in pdf_content_list])\n    print(f\"PDFæ–‡æ¡£çš„æ€»å­—ç¬¦æ•°: {len(pdf_text)}\") \n\n    # å°†PDFæ–‡æ¡£æ–‡æœ¬åˆ†å‰²æˆæ–‡æœ¬å—Chunk\n    chunks = text_splitter.split_text(pdf_text)\n    print(f\"åˆ†å‰²çš„æ–‡æœ¬Chunkæ•°é‡: {len(chunks)}\") \n\n    # æ–‡æœ¬å—è½¬åŒ–ä¸ºåµŒå…¥å‘é‡åˆ—è¡¨ï¼Œnormalize_embeddingsè¡¨ç¤ºå¯¹åµŒå…¥å‘é‡è¿›è¡Œå½’ä¸€åŒ–ï¼Œç”¨äºå‡†ç¡®è®¡ç®—ç›¸ä¼¼åº¦\n    embeddings = []\n    for chunk in chunks:\n        embedding = embedding_model.encode(chunk, normalize_embeddings=True)\n        embeddings.append(embedding)\n\n    print(\"æ–‡æœ¬å—Chunkè½¬åŒ–ä¸ºåµŒå…¥å‘é‡å®Œæˆ\")\n\n    # å°†åµŒå…¥å‘é‡åˆ—è¡¨è½¬åŒ–ä¸ºnumpyæ•°ç»„ï¼ŒFaisså‘é‡åº“æ“ä½œéœ€è¦numpyæ•°ç»„è¾“å…¥\n    embeddings_np = np.array(embeddings)\n\n    # è·å–åµŒå…¥å‘é‡çš„ç»´åº¦ï¼ˆæ¯ä¸ªå‘é‡çš„é•¿åº¦ï¼‰\n    dimension = embeddings_np.shape[1]\n\n    # ä½¿ç”¨ä½™å¼¦ç›¸ä¼¼åº¦åˆ›å»ºFAISSç´¢å¼•\n    index = faiss.IndexFlatIP(dimension)\n    # å°†æ‰€æœ‰çš„åµŒå…¥å‘é‡æ·»åŠ åˆ°FAISSç´¢å¼•ä¸­ï¼Œåç»­å¯ä»¥ç”¨æ¥è¿›è¡Œç›¸ä¼¼æ€§æ£€ç´¢\n    index.add(embeddings_np)\n\n    print(\"ç´¢å¼•è¿‡ç¨‹å®Œæˆ.\")\n\n    return index, chunks\n</code></pre><p>ä¸Šè¿°ä»£ç å®ç°äº†RAGæŠ€æœ¯ä¸­çš„ç´¢å¼•æµç¨‹ï¼Œé¦–å…ˆä½¿ç”¨ <strong>PyPDFLoader</strong> åŠ è½½å¹¶é¢„å¤„ç†PDFæ–‡æ¡£ï¼Œå°†å…¶å†…å®¹æå–å¹¶åˆå¹¶ä¸ºå®Œæ•´æ–‡æœ¬ã€‚æ¥ç€ï¼Œåˆ©ç”¨ <strong>RecursiveCharacterTextSplitter</strong> å°†æ–‡æœ¬åˆ†å‰²ä¸ºæ¯å—512å­—ç¬¦ï¼ˆétokenï¼‰ã€é‡å 128å­—ç¬¦ï¼ˆétokenï¼‰çš„æ–‡æœ¬å—ï¼Œå¹¶é€šè¿‡é¢„åŠ è½½çš„ <strong>bge-small-zh-v1.5</strong> åµŒå…¥æ¨¡å‹å°†è¿™äº›æ–‡æœ¬å—è½¬åŒ–ä¸ºå½’ä¸€åŒ–çš„åµŒå…¥å‘é‡ã€‚æœ€ç»ˆï¼Œè¿™äº›åµŒå…¥å‘é‡è¢«å­˜å‚¨åœ¨åŸºäºä½™å¼¦ç›¸ä¼¼åº¦çš„ <strong>Faiss</strong> å‘é‡åº“ä¸­ï¼Œä»¥æ”¯æŒåç»­çš„ç›¸ä¼¼æ€§æ£€ç´¢å’Œç”Ÿæˆä»»åŠ¡ã€‚</p><p>ä¸ºæ›´æ¸…æ™°åœ°å±•ç¤ºRAGæµç¨‹çš„å„ä¸ªç»†èŠ‚ï¼Œå½“å‰ä»£ç æœªæ¶‰åŠå¤šæ–‡æ¡£å¤„ç†ã€åµŒå…¥æ¨¡å‹çš„æ•ˆç‡ä¼˜åŒ–ä¸å¹¶è¡Œå¤„ç†ã€‚æ­¤å¤–ï¼Œ<strong>Faiss</strong> å‘é‡ç›®å‰ä»…åœ¨å†…å­˜ä¸­å­˜å‚¨ï¼Œæœªè€ƒè™‘æŒä¹…åŒ–å­˜å‚¨é—®é¢˜ã€‚ä»¥åŠæ–‡æ¡£è§£æã€æ–‡æœ¬åˆ†å—ã€åµŒå…¥æ¨¡å‹ä¸å‘é‡åº“çš„æŠ€æœ¯é€‰å‹ï¼Œåç»­è¯¾ç¨‹å°†é€æ­¥æ·±å…¥æ¢è®¨ï¼Œå¹¶ä»¥ä¸Šè¿°ä»£ç ä½œä¸ºåŸºç¡€ï¼ŒæŒç»­ä¼˜åŒ–ã€‚</p><p><strong>æ£€ç´¢æµç¨‹</strong></p><pre><code class=\"language-plain\">def retrieval_process(query, index, chunks, embedding_model, top_k=3):\n    \"\"\"\n    æ£€ç´¢æµç¨‹ï¼šå°†ç”¨æˆ·æŸ¥è¯¢Queryè½¬åŒ–ä¸ºåµŒå…¥å‘é‡ï¼Œå¹¶åœ¨Faissç´¢å¼•ä¸­æ£€ç´¢æœ€ç›¸ä¼¼çš„å‰kä¸ªæ–‡æœ¬å—ã€‚\n    :param query: ç”¨æˆ·æŸ¥è¯¢è¯­å¥\n    :param index: å·²å»ºç«‹çš„Faisså‘é‡ç´¢å¼•\n    :param chunks: åŸå§‹æ–‡æœ¬å—å†…å®¹åˆ—è¡¨\n    :param embedding_model: é¢„åŠ è½½çš„åµŒå…¥æ¨¡å‹\n    :param top_k: è¿”å›æœ€ç›¸ä¼¼çš„å‰Kä¸ªç»“æœ\n    :return: è¿”å›æœ€ç›¸ä¼¼çš„æ–‡æœ¬å—åŠå…¶ç›¸ä¼¼åº¦å¾—åˆ†\n    \"\"\"\n    # å°†æŸ¥è¯¢è½¬åŒ–ä¸ºåµŒå…¥å‘é‡ï¼Œnormalize_embeddingsè¡¨ç¤ºå¯¹åµŒå…¥å‘é‡è¿›è¡Œå½’ä¸€åŒ–\n    query_embedding = embedding_model.encode(query, normalize_embeddings=True)\n    # å°†åµŒå…¥å‘é‡è½¬åŒ–ä¸ºnumpyæ•°ç»„ï¼ŒFaissç´¢å¼•æ“ä½œéœ€è¦numpyæ•°ç»„è¾“å…¥\n    query_embedding = np.array([query_embedding])\n\n    # åœ¨ Faiss ç´¢å¼•ä¸­ä½¿ç”¨ query_embedding è¿›è¡Œæœç´¢ï¼Œæ£€ç´¢å‡ºæœ€ç›¸ä¼¼çš„å‰ top_k ä¸ªç»“æœã€‚\n    # è¿”å›æŸ¥è¯¢å‘é‡ä¸æ¯ä¸ªè¿”å›ç»“æœä¹‹é—´çš„ç›¸ä¼¼åº¦å¾—åˆ†ï¼ˆåœ¨ä½¿ç”¨ä½™å¼¦ç›¸ä¼¼åº¦æ—¶ï¼Œå€¼è¶Šå¤§è¶Šç›¸ä¼¼ï¼‰æ’ååˆ—è¡¨distancesï¼Œæœ€ç›¸ä¼¼çš„ top_k ä¸ªæ–‡æœ¬å—åœ¨åŸå§‹ chunks åˆ—è¡¨ä¸­çš„ç´¢å¼•indicesã€‚\n    distances, indices = index.search(query_embedding, top_k)\n\n    print(f\"æŸ¥è¯¢è¯­å¥: {query}\")\n    print(f\"æœ€ç›¸ä¼¼çš„å‰{top_k}ä¸ªæ–‡æœ¬å—:\")\n\n    # è¾“å‡ºæŸ¥è¯¢å‡ºçš„top_kä¸ªæ–‡æœ¬å—åŠå…¶ç›¸ä¼¼åº¦å¾—åˆ†\n    results = []\n    for i in range(top_k):\n        # è·å–ç›¸ä¼¼æ–‡æœ¬å—çš„åŸå§‹å†…å®¹\n        result_chunk = chunks[indices[0][i]]\n        print(f\"æ–‡æœ¬å— {i}:\\n{result_chunk}\") \n\n        # è·å–ç›¸ä¼¼æ–‡æœ¬å—çš„ç›¸ä¼¼åº¦å¾—åˆ†\n        result_distance = distances[0][i]\n        print(f\"ç›¸ä¼¼åº¦å¾—åˆ†: {result_distance}\\n\")\n\n        # å°†ç›¸ä¼¼æ–‡æœ¬å—å­˜å‚¨åœ¨ç»“æœåˆ—è¡¨ä¸­\n        results.append(result_chunk)\n\n    print(\"æ£€ç´¢è¿‡ç¨‹å®Œæˆ.\")\n    return results\n</code></pre><p>ä¸Šè¿°ä»£ç å®ç°äº†RAGæŠ€æœ¯ä¸­çš„æ£€ç´¢æµç¨‹ã€‚é¦–å…ˆï¼Œç”¨æˆ·çš„æŸ¥è¯¢ï¼ˆQueryï¼‰è¢«é¢„åŠ è½½çš„ <strong>bge-small-zh-v1.5</strong> åµŒå…¥æ¨¡å‹è½¬åŒ–ä¸ºå½’ä¸€åŒ–çš„åµŒå…¥å‘é‡ï¼Œè¿›ä¸€æ­¥è½¬æ¢ä¸º <strong>numpy</strong> æ•°ç»„ä»¥é€‚é… <strong>Faiss</strong> å‘é‡åº“çš„è¾“å…¥æ ¼å¼ã€‚ç„¶åï¼Œåˆ©ç”¨ <strong>Faiss</strong> å‘é‡åº“ä¸­çš„å‘é‡æ£€ç´¢åŠŸèƒ½ï¼Œè®¡ç®—æŸ¥è¯¢å‘é‡ä¸å­˜å‚¨å‘é‡ä¹‹é—´çš„ä½™å¼¦ç›¸ä¼¼åº¦ï¼Œä»è€Œç­›é€‰å‡ºä¸æŸ¥è¯¢æœ€ç›¸ä¼¼çš„å‰ <strong>top_k</strong> ä¸ªæ–‡æœ¬å—ã€‚è¿™äº›æ–‡æœ¬å—åŠå…¶ç›¸åº”çš„ç›¸ä¼¼åº¦å¾—åˆ†è¢«é€ä¸€è¾“å‡ºï¼Œç›¸ä¼¼æ–‡æœ¬å—å­˜å‚¨åœ¨ç»“æœåˆ—è¡¨ä¸­ï¼Œæœ€ç»ˆè¿”å›ä¾›åç»­ç”Ÿæˆè¿‡ç¨‹ä½¿ç”¨ã€‚</p><p><strong>ç”Ÿæˆæµç¨‹</strong></p><pre><code class=\"language-plain\">def generate_process(query, chunks):\n    \"\"\"\n    ç”Ÿæˆæµç¨‹ï¼šè°ƒç”¨Qwenå¤§æ¨¡å‹äº‘ç«¯APIï¼Œæ ¹æ®æŸ¥è¯¢å’Œæ–‡æœ¬å—ç”Ÿæˆæœ€ç»ˆå›å¤ã€‚\n    :param query: ç”¨æˆ·æŸ¥è¯¢è¯­å¥\n    :param chunks: ä»æ£€ç´¢è¿‡ç¨‹ä¸­è·å¾—çš„ç›¸å…³æ–‡æœ¬å—ä¸Šä¸‹æ–‡chunks\n    :return: è¿”å›ç”Ÿæˆçš„å“åº”å†…å®¹\n    \"\"\"\n    # è®¾ç½®Qwenç³»åˆ—å…·ä½“æ¨¡å‹åŠå¯¹åº”çš„è°ƒç”¨APIå¯†é’¥ï¼Œä»é˜¿é‡Œäº‘å¤§æ¨¡å‹æœåŠ¡å¹³å°ç™¾ç‚¼è·å¾—\n    llm_model = qwen_model\n    dashscope.api_key = qwen_api_key\n\n    # æ„å»ºå‚è€ƒæ–‡æ¡£å†…å®¹ï¼Œæ ¼å¼ä¸ºâ€œå‚è€ƒæ–‡æ¡£1: \\n å‚è€ƒæ–‡æ¡£2: \\n ...â€ç­‰\n    context = \"\"\n    for i, chunk in enumerate(chunks):\n        context += f\"å‚è€ƒæ–‡æ¡£{i+1}: \\n{chunk}\\n\\n\"\n\n    # æ„å»ºç”Ÿæˆæ¨¡å‹æ‰€éœ€çš„Promptï¼ŒåŒ…å«ç”¨æˆ·æŸ¥è¯¢å’Œæ£€ç´¢åˆ°çš„ä¸Šä¸‹æ–‡\n    prompt = f\"æ ¹æ®å‚è€ƒæ–‡æ¡£å›ç­”é—®é¢˜ï¼š{query}\\n\\n{context}\"\n    print(f\"ç”Ÿæˆæ¨¡å‹çš„Prompt: {prompt}\")\n\n    # å‡†å¤‡è¯·æ±‚æ¶ˆæ¯ï¼Œå°†promptä½œä¸ºè¾“å…¥\n    messages = [{'role': 'user', 'content': prompt}]\n\n    # è°ƒç”¨å¤§æ¨¡å‹APIäº‘æœåŠ¡ç”Ÿæˆå“åº”\n    try:\n        responses = dashscope.Generation.call(\n            model = llm_model,\n            messages=messages,\n            result_format='message',  # è®¾ç½®è¿”å›æ ¼å¼ä¸º\"message\"\n            stream=True,              # å¯ç”¨æµå¼è¾“å‡º\n            incremental_output=True   # è·å–æµå¼å¢é‡è¾“å‡º\n        )\n        # åˆå§‹åŒ–å˜é‡ä»¥å­˜å‚¨ç”Ÿæˆçš„å“åº”å†…å®¹\n        generated_response = \"\"\n        print(\"ç”Ÿæˆè¿‡ç¨‹å¼€å§‹:\")\n        # é€æ­¥è·å–å’Œå¤„ç†æ¨¡å‹çš„å¢é‡è¾“å‡º\n        for response in responses:\n            if response.status_code == HTTPStatus.OK:\n                content = response.output.choices[0]['message']['content']\n                generated_response += content\n                print(content, end='')  # å®æ—¶è¾“å‡ºæ¨¡å‹ç”Ÿæˆçš„å†…å®¹\n            else:\n                print(f\"è¯·æ±‚å¤±è´¥: {response.status_code} - {response.message}\")\n                return None  # è¯·æ±‚å¤±è´¥æ—¶è¿”å› None\n        print(\"\\nç”Ÿæˆè¿‡ç¨‹å®Œæˆ.\")\n        return generated_response\n    except Exception as e:\n        print(f\"å¤§æ¨¡å‹ç”Ÿæˆè¿‡ç¨‹ä¸­å‘ç”Ÿé”™è¯¯: {e}\")\n        return None\n</code></pre><p>ä¸Šè¿°ä»£ç å®ç°äº†RAGæµç¨‹ä¸­çš„ç”Ÿæˆè¿‡ç¨‹ã€‚é¦–å…ˆï¼Œç»“åˆç”¨æˆ·æŸ¥è¯¢ä¸æ£€ç´¢åˆ°çš„æ–‡æœ¬å—å†…å®¹ç»„ç»‡æˆå¤§æ¨¡å‹æç¤ºè¯ï¼ˆPromptï¼‰ã€‚éšåï¼Œä»£ç é€šè¿‡è°ƒç”¨ <strong>Qwen å¤§æ¨¡å‹äº‘ç«¯ API</strong>ï¼Œå°†æ„å»ºå¥½çš„Promptå‘é€ç»™å¤§æ¨¡å‹ï¼Œå¹¶åˆ©ç”¨æµå¼è¾“å‡ºçš„æ–¹å¼é€æ­¥è·å–æ¨¡å‹ç”Ÿæˆçš„å“åº”å†…å®¹ï¼Œå®æ—¶è¾“å‡ºå¹¶æ±‡æ€»ä¸ºæœ€ç»ˆçš„ç”Ÿæˆç»“æœã€‚</p><p><strong>æµ‹è¯•è„šæœ¬</strong></p><pre><code class=\"language-plain\">def main():\n    print(\"RAGè¿‡ç¨‹å¼€å§‹.\")\n\n    query=\"ä¸‹é¢æŠ¥å‘Šä¸­æ¶‰åŠäº†å“ªå‡ ä¸ªè¡Œä¸šçš„æ¡ˆä¾‹ä»¥åŠæ€»ç»“å„è‡ªé¢ä¸´çš„æŒ‘æˆ˜ï¼Ÿ\"\n    embedding_model = load_embedding_model()\n\n    # ç´¢å¼•æµç¨‹ï¼šåŠ è½½PDFæ–‡ä»¶ï¼Œåˆ†å‰²æ–‡æœ¬å—ï¼Œè®¡ç®—åµŒå…¥å‘é‡ï¼Œå­˜å‚¨åœ¨FAISSå‘é‡åº“ä¸­ï¼ˆå†…å­˜ï¼‰\n    index, chunks = indexing_process('rag_app/test_lesson2.pdf', embedding_model)\n\n    # æ£€ç´¢æµç¨‹ï¼šå°†ç”¨æˆ·æŸ¥è¯¢è½¬åŒ–ä¸ºåµŒå…¥å‘é‡ï¼Œæ£€ç´¢æœ€ç›¸ä¼¼çš„æ–‡æœ¬å—\n    retrieval_chunks = retrieval_process(query, index, chunks, embedding_model)\n\n    # ç”Ÿæˆæµç¨‹ï¼šè°ƒç”¨Qwenå¤§æ¨¡å‹ç”Ÿæˆå“åº”\n    generate_process(query, retrieval_chunks)\n\n    print(\"RAGè¿‡ç¨‹ç»“æŸ.\")\n\nif __name__ == \"__main__\":\n    main()\n</code></pre><p>åœ¨å‘½ä»¤è¡Œçª—å£ä¸­æ‰§è¡ŒæŒ‡ä»¤å®šä½åˆ°å…·ä½“çš„RAGé¡¹ç›®æ–‡ä»¶å¤¹ï¼Œåœ¨å‘½ä»¤è¡Œä¸­æ‰§è¡Œä»¥ä¸‹æŒ‡ä»¤å³å¯å¼€å§‹RAGåº”ç”¨æµ‹è¯•ï¼š</p><pre><code class=\"language-plain\">source rag_env/bin/activate  # æ¿€æ´»è™šæ‹Ÿç¯å¢ƒ\npython rag_app/rag_app_lesson2.py # æ‰§è¡ŒRAGåº”ç”¨è„šæœ¬\n</code></pre><p>æµ‹è¯•ä»£ç é€šè¿‡ <code>main()</code> å‡½æ•°ä¸²è”å„ä¸ªæ­¥éª¤ï¼Œä»ç´¢å¼•åˆ°ç”Ÿæˆï¼Œç¡®ä¿RAGçš„å„ä¸ªç¯èŠ‚é¡ºç•…æ‰§è¡Œï¼Œå‡†ç¡®å®Œæˆâ€œä¸‹é¢æŠ¥å‘Šä¸­æ¶‰åŠäº†å“ªå‡ ä¸ªè¡Œä¸šçš„æ¡ˆä¾‹ä»¥åŠæ€»ç»“å„è‡ªé¢ä¸´çš„æŒ‘æˆ˜ï¼Ÿâ€çš„RAGé—®ç­”ä»»åŠ¡ã€‚</p><p>æ­£ç¡®è¿è¡Œç»“æœå¦‚ä¸‹æ‰€ç¤ºï¼š</p><pre><code class=\"language-plain\">RAGè¿‡ç¨‹å¼€å§‹.\nåŠ è½½Embeddingæ¨¡å‹ä¸­\nbge-small-zh-v1.5æ¨¡å‹æœ€å¤§è¾“å…¥é•¿åº¦token: 512\nPDFæ–‡æ¡£çš„æ€»å­—ç¬¦æ•°: 9135\nåˆ†å‰²çš„æ–‡æœ¬Chunkæ•°é‡: 24\næ–‡æœ¬å—Chunkè½¬åŒ–ä¸ºåµŒå…¥å‘é‡å®Œæˆ\nç´¢å¼•è¿‡ç¨‹å®Œæˆ.\n\næŸ¥è¯¢è¯­å¥: ä¸‹é¢æŠ¥å‘Šä¸­æ¶‰åŠäº†å“ªå‡ ä¸ªè¡Œä¸šçš„æ¡ˆä¾‹ä»¥åŠæ€»ç»“å„è‡ªé¢ä¸´çš„æŒ‘æˆ˜ï¼Ÿ\næœ€ç›¸ä¼¼çš„å‰3ä¸ªæ–‡æœ¬å—:\næ–‡æœ¬å— 0: é¢çš„æ•°å­—åŒ–è½¬å‹ã€‚2.3.2é¢ä¸´çš„æŒ‘æˆ˜ï¼š......ç›¸ä¼¼åº¦å¾—åˆ†: 0.5915016531944275\næ–‡æœ¬å— 1: ...... ç›¸ä¼¼åº¦å¾—åˆ†: 0.5728524327278137\næ–‡æœ¬å— 2: ...... ç›¸ä¼¼åº¦å¾—åˆ†: 0.5637902617454529\næ£€ç´¢è¿‡ç¨‹å®Œæˆ.\n\nç”Ÿæˆæ¨¡å‹çš„Prompt: æ ¹æ®å‚è€ƒæ–‡æ¡£å›ç­”é—®é¢˜ï¼šä¸‹é¢æŠ¥å‘Šä¸­æ¶‰åŠäº†å“ªå‡ ä¸ªè¡Œä¸šçš„æ¡ˆä¾‹ä»¥åŠæ€»ç»“å„è‡ªé¢ä¸´çš„æŒ‘æˆ˜ï¼Ÿ\nå‚è€ƒæ–‡æ¡£1: é¢çš„æ•°å­—åŒ–è½¬å‹ã€‚2.3.2é¢ä¸´çš„æŒ‘æˆ˜...\nå‚è€ƒæ–‡æ¡£2: ......\nå‚è€ƒæ–‡æ¡£3: ......\n\nç”Ÿæˆè¿‡ç¨‹å¼€å§‹:\nå‚è€ƒæ–‡æ¡£ä¸­æ¶‰åŠäº†ä¸‰ä¸ªè¡Œä¸šçš„æ¡ˆä¾‹åŠå…¶é¢ä¸´çš„æŒ‘æˆ˜ï¼š\n1.### åˆ¶é€ ä¸š...... 2. ### é›¶å”®ä¸š......  3. ### é‡‘èä¸š......\n### æ•°å­—åŒ–è½¬å‹è§£å†³æ–¹æ¡ˆæ¦‚è¿°\n-**åˆ¶é€ ä¸š**ï¼š...... -**é›¶å”®ä¸š**ï¼š...... -**é‡‘èä¸š**ï¼š......\nè¿™äº›æ¡ˆä¾‹å¼ºè°ƒäº†ä¸åŒè¡Œä¸šåœ¨æ•°å­—åŒ–è½¬å‹è¿‡ç¨‹ä¸­é¢ä¸´çš„ç‹¬ç‰¹æŒ‘æˆ˜......\nç”Ÿæˆè¿‡ç¨‹å®Œæˆ.\nRAGè¿‡ç¨‹ç»“æŸ.\n</code></pre><h2>æ€»ç»“</h2><p>è¿™èŠ‚è¯¾æˆ‘é€šè¿‡ä»£ç å®æˆ˜å‘ä½ å±•ç¤ºäº†RAGæŠ€æœ¯çš„å®Œæ•´å®ç°è¿‡ç¨‹ï¼Œæ¶µç›–äº†<strong>ç´¢å¼•ã€æ£€ç´¢ã€ç”Ÿæˆ</strong>ä¸‰ä¸ªæ ¸å¿ƒæµç¨‹ã€‚ä¸Šè¿°ä»£ç å·²å…¬å¼€åœ¨Giteeä»£ç ä»“åº“ä¸­ï¼Œé“¾æ¥åœ°å€ä¸ºï¼š<a href=\"https://gitee.com/techleadcy/rag_app\">https://gitee.com/techleadcy/rag_app</a>ã€‚</p><p>æŠ€æœ¯é€‰å‹æ–¹é¢ï¼Œæˆ‘ä»¬é€‰æ‹©äº† LangChain ä½œä¸ºæ ¸å¿ƒæ¡†æ¶ï¼Œç»“åˆ pypdf ç”¨äºPDFæ–‡æ¡£è§£æï¼ŒRecursiveCharacterTextSplitter ç”¨äºæ–‡æœ¬åˆ†å—ï¼Œbge-small-zh-v1.5 ä½œä¸ºåµŒå…¥æ¨¡å‹ï¼ŒFaiss ä½œä¸ºå‘é‡æ£€ç´¢åº“ï¼Œä»¥åŠé˜¿é‡Œäº‘çš„Qwenå¤§æ¨¡å‹ç”¨äºç”Ÿæˆä»»åŠ¡ã€‚</p><p>ä»£ç å®æˆ˜ä¸­ï¼Œæˆ‘ä»¬ä¾æ¬¡å®Œæˆäº†åµŒå…¥æ¨¡å‹çš„åŠ è½½ã€PDFæ–‡æ¡£çš„è§£æä¸æ–‡æœ¬åˆ†å—ã€å‘é‡åŒ–åµŒå…¥ä¸Faisså‘é‡åº“çš„æ„å»ºã€ç”¨æˆ·æŸ¥è¯¢çš„æ£€ç´¢åŒ¹é…ï¼Œä»¥åŠæœ€ç»ˆçš„ç”Ÿæˆæ¨¡å‹è°ƒç”¨ã€‚</p><p>è¿™èŠ‚è¯¾çš„å®æˆ˜å†…å®¹ä¸ºåç»­è¯¾ç¨‹å¥ å®šäº†åŸºç¡€ï¼Œåç»­è¯¾ç¨‹å°†æ·±å…¥è®²è§£æ¯ä¸ªæŠ€æœ¯æµç¨‹çš„ç»†èŠ‚ï¼Œå¹¶åœ¨æ­¤å®æˆ˜é¡¹ç›®åŸºç¡€ä¸Šå¯¹ä»£ç è¿›è¡ŒæŒç»­ä¼˜åŒ–å’Œè¿­ä»£ã€‚</p><h2>æ€è€ƒé¢˜</h2><p>æˆ‘ä»¬åŸºäºä¸Šè¿°æŠ€æœ¯ç»„ä»¶å¿«é€Ÿæ­å»ºäº†RAGåº”ç”¨ï¼Œå®ç°äº†å…¶æ ¸å¿ƒæµç¨‹ã€‚ç„¶è€Œï¼Œåœ¨çœŸå®çš„åº”ç”¨åœºæ™¯ä¸­ï¼Œå¯èƒ½è¿˜éœ€è¦è¡¥å……ä¸€äº›å…³é”®ç»„ä»¶æ‰èƒ½æ›´å¥½ã€æ›´ä¼˜åœ°æ»¡è¶³ç”¨æˆ·éœ€æ±‚ï¼Œéœ€è¦è¡¥å……å“ªäº›å…³é”®ç»„ä»¶å‘¢ï¼Ÿæ¬¢è¿ä½ åœ¨ç•™è¨€åŒºè¡¥å……ï¼Œæè¿°å®ƒä»¬çš„ä½œç”¨ï¼Œæˆ‘ä»¬å…±åŒå®Œå–„RAGåº”ç”¨æ•ˆæœï¼Œå¦‚æœä½ è§‰å¾—è¿™èŠ‚è¯¾çš„å†…å®¹å¯¹ä½ æœ‰å¸®åŠ©çš„è¯ï¼Œä¹Ÿæ¬¢è¿ä½ åˆ†äº«ç»™å…¶ä»–æœ‹å‹ï¼Œæˆ‘ä»¬ä¸‹èŠ‚è¯¾å†è§ï¼</p>","neighbors":{"left":{"article_title":"01ï½œRAGçš„åœºæ™¯åŠæŠ€æœ¯åŸç†","id":803750},"right":{"article_title":"03ï½œRAG ç´¢å¼•ï¼ˆä¸€ï¼‰ï¼šæ–‡æ¡£è§£ææŠ€æœ¯","id":804324}},"comments":[{"had_liked":false,"id":395139,"user_name":"å¼ ç”³å‚²","can_delete":false,"product_type":"c1","uid":1182372,"ip_address":"åŒ—äº¬","ucode":"22D46BC529BA8A","user_header":"https://static001.geekbang.org/account/avatar/00/12/0a/a4/828a431f.jpg","comment_is_top":false,"comment_ctime":1729579280,"is_pvip":false,"replies":[{"id":143483,"content":"ç‚¹èµğŸ‘","user_name":"ä½œè€…å›å¤","user_name_real":"ç¼–è¾‘","uid":3954065,"ctime":1729650872,"ip_address":"ä¸Šæµ·","comment_id":395139,"utype":1}],"discussion_count":1,"race_medal":2,"score":2,"product_id":100804101,"comment_content":"ç¬¬2è®²æ‰“å¡~\nå¯¹æœ¬èŠ‚è¯¾çš„ä»£ç è¿›è¡Œäº†é‡æ„ï¼šå°†æ•´ä½“æµç¨‹æ‹†åˆ†æˆäº†initiatorã€indexerã€retrieverã€generatorå’Œappæ¨¡å—ï¼Œå¹¶ä½¿ç”¨LangChainçš„BaseChatModelã€Embeddingsã€VectorStoreç»„ä»¶å¯¹ç›¸å…³åŠŸèƒ½è¿›è¡Œäº†é‡å†™ã€‚æ¬¢è¿å¤§å®¶ä¸€èµ·äº¤æµï¼šhttps:&#47;&#47;gitee.com&#47;zhangshenao&#47;happy-rag&#47;tree&#47;master&#47;RAG%E5%BF%AB%E9%80%9F%E5%BC%80%E5%8F%91%E5%AE%9E%E6%88%98&#47;1-%E5%BF%AB%E9%80%9F%E6%90%AD%E5%BB%BARAG%E5%BA%94%E7%94%A8 ","like_count":2,"discussions":[{"author":{"id":3954065,"avatar":"https://static001.geekbang.org/account/avatar/00/3c/55/91/e3c96b88.jpg","nickname":"å¸¸æ‰¬","note":"","ucode":"11B62CDABBE875","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":652800,"discussion_content":"ç‚¹èµğŸ‘","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1729650872,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"ä¸Šæµ·","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2,\"source\":0}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":394069,"user_name":"æ— å¤„ä¸åœ¨","can_delete":false,"product_type":"c1","uid":1157533,"ip_address":"åŒ—äº¬","ucode":"BB535BC6F448F4","user_header":"https://static001.geekbang.org/account/avatar/00/11/a9/9d/bdfd9e58.jpg","comment_is_top":false,"comment_ctime":1725707973,"is_pvip":false,"replies":[{"id":143081,"content":"RAGçš„æœ¬è´¨æ˜¯æ£€ç´¢ï¼Œä¸ä»…çŸ¥è¯†åº“é—®ç­”ã€‚AI Searchæ˜¯ä¸€ä¸ªå¹¿æ³›åœºæ™¯ã€‚Agentä½ è¯´çš„æ˜¯å¯¹çš„ï¼ŒRAGé™¤äº†æœ¬èº«ç‹¬ç«‹åšçŸ¥è¯†åº“é—®ç­”ã€AI searchåœºæ™¯å¤–ï¼Œå°±æ˜¯ä½œä¸ºä¸€ä¸ªåŠŸèƒ½ç»„ä»¶ï¼Œé•¶åµŒåˆ°åœºæ™¯æµç¨‹ä¸­ï¼Œå¯ä»¥åœ¨agentä¸­ï¼Œä¹Ÿå¯ä»¥åœ¨æˆ‘ä»¬ç°æœ‰ä¸šåŠ¡æµç¨‹éœ€è¦ç»“åˆç‹¬æœ‰çŸ¥è¯†ã€å®æ—¶çŸ¥è¯†åšæ™ºèƒ½æ¨ç†çš„ä¸šåŠ¡åœºæ™¯ã€‚","user_name":"ä½œè€…å›å¤","user_name_real":"ç¼–è¾‘","uid":3954065,"ctime":1726012704,"ip_address":"ä¸Šæµ·","comment_id":394069,"utype":1}],"discussion_count":1,"race_medal":0,"score":2,"product_id":100804101,"comment_content":"æ„Ÿè°¢è€å¸ˆçš„è®²è§£ï¼Œæˆ‘ç”¨æ™ºæ™®AIä¹Ÿå¯ä»¥è¿è¡Œäº†ï¼Œä»£ç å¦‚ä¸‹ï¼š\n # è°ƒç”¨å¤§æ¨¡å‹APIäº‘æœåŠ¡ç”Ÿæˆå“åº”\n    try:\n        # è°ƒç”¨æ™ºæ™®å¤§æ¨¡å‹å¤„ç†\n        client = ZhipuAI(api_key=&quot;&quot;) \n        responses = client.chat.completions.create(\n            model=&quot;glm-4-flash&quot;,  # å¡«å†™éœ€è¦è°ƒç”¨çš„æ¨¡å‹ç¼–ç \n            messages=messages,\n            stream=True\n        )\n\n        # åˆå§‹åŒ–å˜é‡ä»¥å­˜å‚¨ç”Ÿæˆçš„å“åº”å†…å®¹\n        generated_response = &quot;&quot;\n        print(&quot;ç”Ÿæˆè¿‡ç¨‹å¼€å§‹:&quot;)\n        # é€æ­¥è·å–å’Œå¤„ç†æ¨¡å‹çš„å¢é‡è¾“å‡º\n        for chunk in responses:\n            \n            content = chunk.choices[0].delta.content;\n            generated_response += content\n            print(content, end=&#39;&#39;)  # å®æ—¶è¾“å‡ºæ¨¡å‹ç”Ÿæˆçš„å†…å®¹\n          \n        print(&quot;\\nç”Ÿæˆè¿‡ç¨‹å®Œæˆ.&quot;)\n        return generated_response\n    except Exception as e:\n        print(f&quot;å¤§æ¨¡å‹ç”Ÿæˆè¿‡ç¨‹ä¸­å‘ç”Ÿé”™è¯¯: {e}&quot;)\n        return None\næˆ‘ä¸€ç›´æœ‰ä¸ªç–‘é—®ï¼Œå°±æ˜¯æ„Ÿè§‰RAGå¥½åƒå°±æ˜¯åšçŸ¥è¯†åº“ä¹‹ç±»çš„æœ‰é‡å¤§ä»·å€¼ï¼Œé™¤äº†çŸ¥è¯†åº“æˆ‘æƒ³äº†è§£ä¸‹å¯¹äºæˆ‘ä»¬åšåç«¯ç ”å‘çš„åŒå­¦ï¼Œå¦‚ä½•æŠŠè¿™ä¸ªä¸œè¥¿åœ¨ä¼ä¸šä¸­æ›´å¥½è½åœ°ï¼Œç›®å‰æˆ‘æ„Ÿè§‰ä¼ä¸šä¸­å¥½åƒå°±æ˜¯é€šè¿‡AI Agentä¹‹ç±»çš„ä½œä¸ºç»“åˆRAGçš„ä½¿ç”¨ã€‚","like_count":1,"discussions":[{"author":{"id":3954065,"avatar":"https://static001.geekbang.org/account/avatar/00/3c/55/91/e3c96b88.jpg","nickname":"å¸¸æ‰¬","note":"","ucode":"11B62CDABBE875","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":650982,"discussion_content":"RAGçš„æœ¬è´¨æ˜¯æ£€ç´¢ï¼Œä¸ä»…çŸ¥è¯†åº“é—®ç­”ã€‚AI Searchæ˜¯ä¸€ä¸ªå¹¿æ³›åœºæ™¯ã€‚Agentä½ è¯´çš„æ˜¯å¯¹çš„ï¼ŒRAGé™¤äº†æœ¬èº«ç‹¬ç«‹åšçŸ¥è¯†åº“é—®ç­”ã€AI searchåœºæ™¯å¤–ï¼Œå°±æ˜¯ä½œä¸ºä¸€ä¸ªåŠŸèƒ½ç»„ä»¶ï¼Œé•¶åµŒåˆ°åœºæ™¯æµç¨‹ä¸­ï¼Œå¯ä»¥åœ¨agentä¸­ï¼Œä¹Ÿå¯ä»¥åœ¨æˆ‘ä»¬ç°æœ‰ä¸šåŠ¡æµç¨‹éœ€è¦ç»“åˆç‹¬æœ‰çŸ¥è¯†ã€å®æ—¶çŸ¥è¯†åšæ™ºèƒ½æ¨ç†çš„ä¸šåŠ¡åœºæ™¯ã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1726012704,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"ä¸Šæµ·","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2,\"source\":0}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":393949,"user_name":"grok","can_delete":false,"product_type":"c1","uid":1341502,"ip_address":"ç¾å›½","ucode":"4744AB3FA28FE2","user_header":"https://static001.geekbang.org/account/avatar/00/14/78/3e/f60ea472.jpg","comment_is_top":false,"comment_ctime":1725418694,"is_pvip":false,"replies":[{"id":143048,"content":"æ„Ÿè°¢ï¼åˆ†äº«ç»™æ›´å¤šæµ·å¤–çš„å¼€å‘è€…ã€‚","user_name":"ä½œè€…å›å¤","user_name_real":"ç¼–è¾‘","uid":3954065,"ctime":1725626283,"ip_address":"ä¸Šæµ·","comment_id":393949,"utype":1}],"discussion_count":1,"race_medal":0,"score":2,"product_id":100804101,"comment_content":"æµ·å¤–ç”¨æˆ·ï¼Œè¯•ç€å¼€é€šäº†é˜¿é‡Œäº‘ï¼Œä½†æ˜¯æ²¡æœ‰ä»»ä½•å…è´¹é¢åº¦ã€‚ã€‚  perplexity proæ¯ä¸ªæœˆä¼šèµ é€5åˆ€çš„API credit.  æ ¸å¿ƒä»£ç å¦‚ä¸‹ (åœ¨ `generate_process()`)ï¼š\n```\n    client = OpenAI(api_key=YOUR_API_KEY, base_url=&quot;https:&#47;&#47;api.perplexity.ai&quot;)\n\n    # chat completion with streaming\n    try:\n        response_stream = client.chat.completions.create(\n            model=&quot;llama-3.1-70b-instruct&quot;,\n            messages=messages,\n            stream=True,\n        )\n\n        # Initialize variable to store the generated response content\n        generated_response = &quot;&quot;\n        print(&quot;ç”Ÿæˆè¿‡ç¨‹å¼€å§‹:&quot;)\n\n        # Process the model&#39;s incremental output\n        for chunk in response_stream:\n            if chunk.choices[0].delta.content is not None:\n                content = chunk.choices[0].delta.content\n                generated_response += content\n                print(content, end=&#39;&#39;)  # å®æ—¶è¾“å‡ºæ¨¡å‹ç”Ÿæˆçš„å†…å®¹\n\n        print(&quot;\\nç”Ÿæˆè¿‡ç¨‹å®Œæˆ.&quot;)\n        return generated_response\n```","like_count":1,"discussions":[{"author":{"id":3954065,"avatar":"https://static001.geekbang.org/account/avatar/00/3c/55/91/e3c96b88.jpg","nickname":"å¸¸æ‰¬","note":"","ucode":"11B62CDABBE875","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":650800,"discussion_content":"æ„Ÿè°¢ï¼åˆ†äº«ç»™æ›´å¤šæµ·å¤–çš„å¼€å‘è€…ã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1725626283,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"ä¸Šæµ·","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2,\"source\":0}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":393753,"user_name":"grok","can_delete":false,"product_type":"c1","uid":1341502,"ip_address":"ç¾å›½","ucode":"4744AB3FA28FE2","user_header":"https://static001.geekbang.org/account/avatar/00/14/78/3e/f60ea472.jpg","comment_is_top":false,"comment_ctime":1724797821,"is_pvip":false,"replies":null,"discussion_count":1,"race_medal":0,"score":2,"product_id":100804101,"comment_content":"è¡¥å……ä»¥ä¸‹å…³é”®ç»„ä»¶:\n\n1. å‘é‡æ•°æ®åº“æŒä¹…åŒ–å­˜å‚¨:å°†ç´¢å¼•ç»“æœæŒä¹…åŒ–å­˜å‚¨,é¿å…æ¯æ¬¡é‡æ–°æ„å»ºç´¢å¼•,æé«˜æ•ˆç‡ã€‚\n\n2. å¤šæ¨¡æ€è¾“å…¥å¤„ç†:æ”¯æŒå›¾åƒã€éŸ³é¢‘ç­‰å¤šæ¨¡æ€è¾“å…¥,æ‰©å±•åº”ç”¨åœºæ™¯ã€‚\n\n3. ä¸Šä¸‹æ–‡ç®¡ç†:ç»´æŠ¤å¯¹è¯å†å²,å®ç°å¤šè½®äº¤äº’çš„è¿è´¯æ€§ã€‚\n\n4. çŸ¥è¯†å›¾è°±é›†æˆ:ç»“åˆçŸ¥è¯†å›¾è°±,å¢å¼ºè¯­ä¹‰ç†è§£å’Œæ¨ç†èƒ½åŠ›ã€‚\n\n5. å®æ—¶æ•°æ®åŒæ­¥:ä¸å¤–éƒ¨æ•°æ®æºå®æ—¶åŒæ­¥,ä¿è¯ä¿¡æ¯æ—¶æ•ˆæ€§ã€‚\n\n6. éšç§ä¿æŠ¤æœºåˆ¶:å¯¹æ•æ„Ÿä¿¡æ¯è¿›è¡Œè„±æ•å’Œè®¿é—®æ§åˆ¶ã€‚\n\n7. å¯è§£é‡Šæ€§æ¨¡å—:æä¾›æ£€ç´¢å’Œç”Ÿæˆè¿‡ç¨‹çš„è§£é‡Š,å¢å¼ºå¯ä¿¡åº¦ã€‚\n\n8. è‡ªé€‚åº”å­¦ä¹ :æ ¹æ®ç”¨æˆ·åé¦ˆåŠ¨æ€è°ƒæ•´æ£€ç´¢ç­–ç•¥å’Œç”Ÿæˆå‚æ•°ã€‚","like_count":15,"discussions":[{"author":{"id":3954065,"avatar":"https://static001.geekbang.org/account/avatar/00/3c/55/91/e3c96b88.jpg","nickname":"å¸¸æ‰¬","note":"","ucode":"11B62CDABBE875","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":650344,"discussion_content":"ç‚¹èµï¼ŒåŸºäºä½ çš„ç»„ä»¶ï¼Œæˆ‘ä¹Ÿåšä¸€ä¸‹æµç¨‹åˆ†ç±»ï¼Œå¸®åŠ©å¤§å®¶æ›´åŠ ç†è§£RAGæµç¨‹ã€‚å‘é‡æ•°æ®åº“çš„æŒä¹…åŒ–å­˜å‚¨ã€å¤šæ¨¡æ€è¾“å…¥å¤„ç†ã€å®æ—¶æ•°æ®åŒæ­¥ã€çŸ¥è¯†å›¾è°±é›†æˆã€éšç§ä¿æŠ¤æœºåˆ¶å±äºç´¢å¼•é˜¶æ®µï¼Œæå‡äº†è¯¥é˜¶æ®µçš„ä¿¡æ¯ç®¡ç†ã€æ•°æ®æ¥æºã€å®æ—¶æ€§ã€å…³è”æ€§å’Œå®‰å…¨æ€§ï¼›å¯è§£é‡Šæ€§æ¨¡å—å’Œè‡ªé€‚åº”å­¦ä¹ å±äºæ£€ç´¢é˜¶æ®µï¼Œæ³¨é‡æå‡è¯¥é˜¶æ®µçš„å¯è§£é‡Šæ€§å’Œå¬å›ç‡ï¼›ä¸Šä¸‹æ–‡ç®¡ç†åˆ™å½’å±äºç”Ÿæˆé˜¶æ®µï¼Œå¼ºåŒ–äº†ç”Ÿæˆé˜¶æ®µçš„è®°å¿†ä¿¡æ¯æ•´åˆã€‚","likes_number":4,"is_delete":false,"is_hidden":false,"ctime":1724812729,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":"ä¸Šæµ·","group_id":0},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":393792,"user_name":"Geek_5eea3f","can_delete":false,"product_type":"c1","uid":3829785,"ip_address":"æ²³åŒ—","ucode":"0EEACB5A9BD1EA","user_header":"","comment_is_top":false,"comment_ctime":1724908210,"is_pvip":false,"replies":null,"discussion_count":1,"race_medal":0,"score":2,"product_id":100804101,"comment_content":"è¿è¡Œä»£ç æœ‰è¿™æ ·çš„é”™è¯¯è¯·é—®å¦‚ä½•è§£å†³ï¼šå¤§æ¨¡å‹ç”Ÿæˆè¿‡ç¨‹ä¸­å‘ç”Ÿé”™è¯¯: HTTPSConnectionPool(host=&#39;dashscope.aliyuncs.com&#39;, port=443): Max retries exceeded with url: &#47;api&#47;v1&#47;services&#47;aigc&#47;text-generation&#47;generation (Caused by ProxyError(&#39;Unable to connect to proxy&#39;, SSLError(SSLZeroReturnError(6, &#39;TLS&#47;SSL connection has been closed (EOF) (_ssl.c:1135)&#39;))))\n","like_count":1,"discussions":[{"author":{"id":3954065,"avatar":"https://static001.geekbang.org/account/avatar/00/3c/55/91/e3c96b88.jpg","nickname":"å¸¸æ‰¬","note":"","ucode":"11B62CDABBE875","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":650405,"discussion_content":"ä¸é˜¿é‡Œäº‘å¤§æ¨¡å‹è¿æ¥ç½‘ç»œæŠ¥é”™ï¼Œå¯èƒ½æ€§æ¯”è¾ƒå¤šï¼Œæ˜¯å¦å¼€äº†ä»£ç†/VPNï¼Œæ˜¯å¦ç½‘ç»œæœ¬èº«æœ‰é—®é¢˜ç­‰ã€‚ ping dashscope.aliyuncs.com æµ‹è¯•ä¸€ä¸‹ï¼Œå¦‚æœè¿”å› Request timeout for icmp_seqï¼Œåˆ™æ˜ç¡®æ˜¯ç½‘ç»œç›¸å…³ã€‚è°ƒæ•´ä»£ç†ã€VPNã€ç½‘ç»œç­‰ï¼Œå†è¿›è¡Œ ping dashscope.aliyuncs.com æµ‹è¯•ï¼Œå¦‚æœè¿”å› 4 bytes from 47.93.243.29: icmp_seq=0 ttl=89 time=44.247 msç±»ä¼¼æ¶ˆæ¯ï¼Œåˆ™è¡¨ç¤ºç½‘ç»œé—®é¢˜æ¢å¤ï¼Œå¯ä»¥æ­£å¸¸è°ƒç”¨ã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1724920130,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":"ä¸Šæµ·","group_id":0},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]}]}