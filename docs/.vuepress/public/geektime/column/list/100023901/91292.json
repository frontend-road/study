{"id":91292,"title":"23 | Futureï¼šå¦‚ä½•ç”¨å¤šçº¿ç¨‹å®ç°æœ€ä¼˜çš„â€œçƒ§æ°´æ³¡èŒ¶â€ç¨‹åºï¼Ÿ","content":"<p>åœ¨ä¸Šä¸€ç¯‡æ–‡ç« <a href=\"https://time.geekbang.org/column/article/90771\">ã€Š22 | Executorä¸çº¿ç¨‹æ± ï¼šå¦‚ä½•åˆ›å»ºæ­£ç¡®çš„çº¿ç¨‹æ± ï¼Ÿã€‹</a>ä¸­ï¼Œæˆ‘ä»¬è¯¦ç»†ä»‹ç»äº†å¦‚ä½•åˆ›å»ºæ­£ç¡®çš„çº¿ç¨‹æ± ï¼Œé‚£åˆ›å»ºå®Œçº¿ç¨‹æ± ï¼Œæˆ‘ä»¬è¯¥å¦‚ä½•ä½¿ç”¨å‘¢ï¼Ÿåœ¨ä¸Šä¸€ç¯‡æ–‡ç« ä¸­ï¼Œæˆ‘ä»¬ä»…ä»…ä»‹ç»äº†ThreadPoolExecutorçš„ <code>void execute(Runnable command)</code> æ–¹æ³•ï¼Œåˆ©ç”¨è¿™ä¸ªæ–¹æ³•è™½ç„¶å¯ä»¥æäº¤ä»»åŠ¡ï¼Œä½†æ˜¯å´æ²¡æœ‰åŠæ³•è·å–ä»»åŠ¡çš„æ‰§è¡Œç»“æœï¼ˆexecute()æ–¹æ³•æ²¡æœ‰è¿”å›å€¼ï¼‰ã€‚è€Œå¾ˆå¤šåœºæ™¯ä¸‹ï¼Œæˆ‘ä»¬åˆéƒ½æ˜¯éœ€è¦è·å–ä»»åŠ¡çš„æ‰§è¡Œç»“æœçš„ã€‚é‚£ThreadPoolExecutoræ˜¯å¦æä¾›äº†ç›¸å…³åŠŸèƒ½å‘¢ï¼Ÿå¿…é¡»çš„ï¼Œè¿™ä¹ˆé‡è¦çš„åŠŸèƒ½å½“ç„¶éœ€è¦æä¾›äº†ã€‚</p><p>ä¸‹é¢æˆ‘ä»¬å°±æ¥ä»‹ç»ä¸€ä¸‹ä½¿ç”¨ThreadPoolExecutorçš„æ—¶å€™ï¼Œå¦‚ä½•è·å–ä»»åŠ¡æ‰§è¡Œç»“æœã€‚</p><h2>å¦‚ä½•è·å–ä»»åŠ¡æ‰§è¡Œç»“æœ</h2><p>Javaé€šè¿‡ThreadPoolExecutoræä¾›çš„3ä¸ªsubmit()æ–¹æ³•å’Œ1ä¸ªFutureTaskå·¥å…·ç±»æ¥æ”¯æŒè·å¾—ä»»åŠ¡æ‰§è¡Œç»“æœçš„éœ€æ±‚ã€‚ä¸‹é¢æˆ‘ä»¬å…ˆæ¥ä»‹ç»è¿™3ä¸ªsubmit()æ–¹æ³•ï¼Œè¿™3ä¸ªæ–¹æ³•çš„æ–¹æ³•ç­¾åå¦‚ä¸‹ã€‚</p><pre><code>// æäº¤Runnableä»»åŠ¡\nFuture&lt;?&gt; \n  submit(Runnable task);\n// æäº¤Callableä»»åŠ¡\n&lt;T&gt; Future&lt;T&gt; \n  submit(Callable&lt;T&gt; task);\n// æäº¤Runnableä»»åŠ¡åŠç»“æœå¼•ç”¨  \n&lt;T&gt; Future&lt;T&gt; \n  submit(Runnable task, T result);\n</code></pre><p>ä½ ä¼šå‘ç°å®ƒä»¬çš„è¿”å›å€¼éƒ½æ˜¯Futureæ¥å£ï¼ŒFutureæ¥å£æœ‰5ä¸ªæ–¹æ³•ï¼Œæˆ‘éƒ½åˆ—åœ¨ä¸‹é¢äº†ï¼Œå®ƒä»¬åˆ†åˆ«æ˜¯<strong>å–æ¶ˆä»»åŠ¡çš„æ–¹æ³•cancel()ã€åˆ¤æ–­ä»»åŠ¡æ˜¯å¦å·²å–æ¶ˆçš„æ–¹æ³•isCancelled()ã€åˆ¤æ–­ä»»åŠ¡æ˜¯å¦å·²ç»“æŸçš„æ–¹æ³•isDone()<strong>ä»¥åŠ</strong>2ä¸ªè·å¾—ä»»åŠ¡æ‰§è¡Œç»“æœçš„get()å’Œget(timeout, unit)</strong>ï¼Œå…¶ä¸­æœ€åä¸€ä¸ªget(timeout, unit)æ”¯æŒè¶…æ—¶æœºåˆ¶ã€‚é€šè¿‡Futureæ¥å£çš„è¿™5ä¸ªæ–¹æ³•ä½ ä¼šå‘ç°ï¼Œæˆ‘ä»¬æäº¤çš„ä»»åŠ¡ä¸ä½†èƒ½å¤Ÿè·å–ä»»åŠ¡æ‰§è¡Œç»“æœï¼Œè¿˜å¯ä»¥å–æ¶ˆä»»åŠ¡ã€‚ä¸è¿‡éœ€è¦æ³¨æ„çš„æ˜¯ï¼šè¿™ä¸¤ä¸ªget()æ–¹æ³•éƒ½æ˜¯é˜»å¡å¼çš„ï¼Œå¦‚æœè¢«è°ƒç”¨çš„æ—¶å€™ï¼Œä»»åŠ¡è¿˜æ²¡æœ‰æ‰§è¡Œå®Œï¼Œé‚£ä¹ˆè°ƒç”¨get()æ–¹æ³•çš„çº¿ç¨‹ä¼šé˜»å¡ï¼Œç›´åˆ°ä»»åŠ¡æ‰§è¡Œå®Œæ‰ä¼šè¢«å”¤é†’ã€‚</p><!-- [[[read_end]]] --><pre><code>// å–æ¶ˆä»»åŠ¡\nboolean cancel(\n  boolean mayInterruptIfRunning);\n// åˆ¤æ–­ä»»åŠ¡æ˜¯å¦å·²å–æ¶ˆ  \nboolean isCancelled();\n// åˆ¤æ–­ä»»åŠ¡æ˜¯å¦å·²ç»“æŸ\nboolean isDone();\n// è·å¾—ä»»åŠ¡æ‰§è¡Œç»“æœ\nget();\n// è·å¾—ä»»åŠ¡æ‰§è¡Œç»“æœï¼Œæ”¯æŒè¶…æ—¶\nget(long timeout, TimeUnit unit);\n</code></pre><p>è¿™3ä¸ªsubmit()æ–¹æ³•ä¹‹é—´çš„åŒºåˆ«åœ¨äºæ–¹æ³•å‚æ•°ä¸åŒï¼Œä¸‹é¢æˆ‘ä»¬ç®€è¦ä»‹ç»ä¸€ä¸‹ã€‚</p><ol>\n<li>æäº¤Runnableä»»åŠ¡ <code>submit(Runnable task)</code> ï¼šè¿™ä¸ªæ–¹æ³•çš„å‚æ•°æ˜¯ä¸€ä¸ªRunnableæ¥å£ï¼ŒRunnableæ¥å£çš„run()æ–¹æ³•æ˜¯æ²¡æœ‰è¿”å›å€¼çš„ï¼Œæ‰€ä»¥ <code>submit(Runnable task)</code> è¿™ä¸ªæ–¹æ³•è¿”å›çš„Futureä»…å¯ä»¥ç”¨æ¥æ–­è¨€ä»»åŠ¡å·²ç»ç»“æŸäº†ï¼Œç±»ä¼¼äºThread.join()ã€‚</li>\n<li>æäº¤Callableä»»åŠ¡ <code>submit(Callable&lt;T&gt; task)</code>ï¼šè¿™ä¸ªæ–¹æ³•çš„å‚æ•°æ˜¯ä¸€ä¸ªCallableæ¥å£ï¼Œå®ƒåªæœ‰ä¸€ä¸ªcall()æ–¹æ³•ï¼Œå¹¶ä¸”è¿™ä¸ªæ–¹æ³•æ˜¯æœ‰è¿”å›å€¼çš„ï¼Œæ‰€ä»¥è¿™ä¸ªæ–¹æ³•è¿”å›çš„Futureå¯¹è±¡å¯ä»¥é€šè¿‡è°ƒç”¨å…¶get()æ–¹æ³•æ¥è·å–ä»»åŠ¡çš„æ‰§è¡Œç»“æœã€‚</li>\n<li>æäº¤Runnableä»»åŠ¡åŠç»“æœå¼•ç”¨ <code>submit(Runnable task, T result)</code>ï¼šè¿™ä¸ªæ–¹æ³•å¾ˆæœ‰æ„æ€ï¼Œå‡è®¾è¿™ä¸ªæ–¹æ³•è¿”å›çš„Futureå¯¹è±¡æ˜¯fï¼Œf.get()çš„è¿”å›å€¼å°±æ˜¯ä¼ ç»™submit()æ–¹æ³•çš„å‚æ•°resultã€‚è¿™ä¸ªæ–¹æ³•è¯¥æ€ä¹ˆç”¨å‘¢ï¼Ÿä¸‹é¢è¿™æ®µç¤ºä¾‹ä»£ç å±•ç¤ºäº†å®ƒçš„ç»å…¸ç”¨æ³•ã€‚éœ€è¦ä½ æ³¨æ„çš„æ˜¯Runnableæ¥å£çš„å®ç°ç±»Taskå£°æ˜äº†ä¸€ä¸ªæœ‰å‚æ„é€ å‡½æ•° <code>Task(Result r)</code> ï¼Œåˆ›å»ºTaskå¯¹è±¡çš„æ—¶å€™ä¼ å…¥äº†resultå¯¹è±¡ï¼Œè¿™æ ·å°±èƒ½åœ¨ç±»Taskçš„run()æ–¹æ³•ä¸­å¯¹resultè¿›è¡Œå„ç§æ“ä½œäº†ã€‚resultç›¸å½“äºä¸»çº¿ç¨‹å’Œå­çº¿ç¨‹ä¹‹é—´çš„æ¡¥æ¢ï¼Œé€šè¿‡å®ƒä¸»å­çº¿ç¨‹å¯ä»¥å…±äº«æ•°æ®ã€‚</li>\n</ol><pre><code>ExecutorService executor \n  = Executors.newFixedThreadPool(1);\n// åˆ›å»ºResultå¯¹è±¡r\nResult r = new Result();\nr.setAAA(a);\n// æäº¤ä»»åŠ¡\nFuture&lt;Result&gt; future = \n  executor.submit(new Task(r), r);  \nResult fr = future.get();\n// ä¸‹é¢ç­‰å¼æˆç«‹\nfr === r;\nfr.getAAA() === a;\nfr.getXXX() === x\n\nclass Task implements Runnable{\n  Result r;\n  //é€šè¿‡æ„é€ å‡½æ•°ä¼ å…¥result\n  Task(Result r){\n    this.r = r;\n  }\n  void run() {\n    //å¯ä»¥æ“ä½œresult\n    a = r.getAAA();\n    r.setXXX(x);\n  }\n}\n</code></pre><p>ä¸‹é¢æˆ‘ä»¬å†æ¥ä»‹ç»FutureTaskå·¥å…·ç±»ã€‚å‰é¢æˆ‘ä»¬æåˆ°çš„Futureæ˜¯ä¸€ä¸ªæ¥å£ï¼Œè€ŒFutureTaskæ˜¯ä¸€ä¸ªå®å®åœ¨åœ¨çš„å·¥å…·ç±»ï¼Œè¿™ä¸ªå·¥å…·ç±»æœ‰ä¸¤ä¸ªæ„é€ å‡½æ•°ï¼Œå®ƒä»¬çš„å‚æ•°å’Œå‰é¢ä»‹ç»çš„submit()æ–¹æ³•ç±»ä¼¼ï¼Œæ‰€ä»¥è¿™é‡Œæˆ‘å°±ä¸å†èµ˜è¿°äº†ã€‚</p><pre><code>FutureTask(Callable&lt;V&gt; callable);\nFutureTask(Runnable runnable, V result);\n</code></pre><p>é‚£å¦‚ä½•ä½¿ç”¨FutureTaskå‘¢ï¼Ÿå…¶å®å¾ˆç®€å•ï¼ŒFutureTaskå®ç°äº†Runnableå’ŒFutureæ¥å£ï¼Œç”±äºå®ç°äº†Runnableæ¥å£ï¼Œæ‰€ä»¥å¯ä»¥å°†FutureTaskå¯¹è±¡ä½œä¸ºä»»åŠ¡æäº¤ç»™ThreadPoolExecutorå»æ‰§è¡Œï¼Œä¹Ÿå¯ä»¥ç›´æ¥è¢«Threadæ‰§è¡Œï¼›åˆå› ä¸ºå®ç°äº†Futureæ¥å£ï¼Œæ‰€ä»¥ä¹Ÿèƒ½ç”¨æ¥è·å¾—ä»»åŠ¡çš„æ‰§è¡Œç»“æœã€‚ä¸‹é¢çš„ç¤ºä¾‹ä»£ç æ˜¯å°†FutureTaskå¯¹è±¡æäº¤ç»™ThreadPoolExecutorå»æ‰§è¡Œã€‚</p><pre><code>// åˆ›å»ºFutureTask\nFutureTask&lt;Integer&gt; futureTask\n  = new FutureTask&lt;&gt;(()-&gt; 1+2);\n// åˆ›å»ºçº¿ç¨‹æ± \nExecutorService es = \n  Executors.newCachedThreadPool();\n// æäº¤FutureTask \nes.submit(futureTask);\n// è·å–è®¡ç®—ç»“æœ\nInteger result = futureTask.get();\n</code></pre><p>FutureTaskå¯¹è±¡ç›´æ¥è¢«Threadæ‰§è¡Œçš„ç¤ºä¾‹ä»£ç å¦‚ä¸‹æ‰€ç¤ºã€‚ç›¸ä¿¡ä½ å·²ç»å‘ç°äº†ï¼Œåˆ©ç”¨FutureTaskå¯¹è±¡å¯ä»¥å¾ˆå®¹æ˜“è·å–å­çº¿ç¨‹çš„æ‰§è¡Œç»“æœã€‚</p><pre><code>// åˆ›å»ºFutureTask\nFutureTask&lt;Integer&gt; futureTask\n  = new FutureTask&lt;&gt;(()-&gt; 1+2);\n// åˆ›å»ºå¹¶å¯åŠ¨çº¿ç¨‹\nThread T1 = new Thread(futureTask);\nT1.start();\n// è·å–è®¡ç®—ç»“æœ\nInteger result = futureTask.get();\n</code></pre><h2>å®ç°æœ€ä¼˜çš„â€œçƒ§æ°´æ³¡èŒ¶â€ç¨‹åº</h2><p>è®°å¾—ä»¥å‰åˆä¸­è¯­æ–‡è¯¾æ–‡é‡Œæœ‰ä¸€ç¯‡è‘—åæ•°å­¦å®¶åç½—åºšå…ˆç”Ÿçš„æ–‡ç« ã€Šç»Ÿç­¹æ–¹æ³•ã€‹ï¼Œè¿™ç¯‡æ–‡ç« é‡Œä»‹ç»äº†ä¸€ä¸ªçƒ§æ°´æ³¡èŒ¶çš„ä¾‹å­ï¼Œæ–‡ä¸­æåˆ°æœ€ä¼˜çš„å·¥åºåº”è¯¥æ˜¯ä¸‹é¢è¿™æ ·ï¼š</p><p><img src=\"https://static001.geekbang.org/resource/image/86/ce/86193a2dba88dd15562118cce6d786ce.png?wh=1142*567\" alt=\"\"></p><center><span class=\"reference\">çƒ§æ°´æ³¡èŒ¶æœ€ä¼˜å·¥åº</span></center><p>ä¸‹é¢æˆ‘ä»¬ç”¨ç¨‹åºæ¥æ¨¡æ‹Ÿä¸€ä¸‹è¿™ä¸ªæœ€ä¼˜å·¥åºã€‚æˆ‘ä»¬ä¸“æ å‰é¢æ›¾ç»æåˆ°ï¼Œå¹¶å‘ç¼–ç¨‹å¯ä»¥æ€»ç»“ä¸ºä¸‰ä¸ªæ ¸å¿ƒé—®é¢˜ï¼šåˆ†å·¥ã€åŒæ­¥å’Œäº’æ–¥ã€‚ç¼–å†™å¹¶å‘ç¨‹åºï¼Œé¦–å…ˆè¦åšçš„å°±æ˜¯åˆ†å·¥ï¼Œæ‰€è°“åˆ†å·¥æŒ‡çš„æ˜¯å¦‚ä½•é«˜æ•ˆåœ°æ‹†è§£ä»»åŠ¡å¹¶åˆ†é…ç»™çº¿ç¨‹ã€‚å¯¹äºçƒ§æ°´æ³¡èŒ¶è¿™ä¸ªç¨‹åºï¼Œä¸€ç§æœ€ä¼˜çš„åˆ†å·¥æ–¹æ¡ˆå¯ä»¥æ˜¯ä¸‹å›¾æ‰€ç¤ºçš„è¿™æ ·ï¼šç”¨ä¸¤ä¸ªçº¿ç¨‹T1å’ŒT2æ¥å®Œæˆçƒ§æ°´æ³¡èŒ¶ç¨‹åºï¼ŒT1è´Ÿè´£æ´—æ°´å£¶ã€çƒ§å¼€æ°´ã€æ³¡èŒ¶è¿™ä¸‰é“å·¥åºï¼ŒT2è´Ÿè´£æ´—èŒ¶å£¶ã€æ´—èŒ¶æ¯ã€æ‹¿èŒ¶å¶ä¸‰é“å·¥åºï¼Œå…¶ä¸­T1åœ¨æ‰§è¡Œæ³¡èŒ¶è¿™é“å·¥åºæ—¶éœ€è¦ç­‰å¾…T2å®Œæˆæ‹¿èŒ¶å¶çš„å·¥åºã€‚å¯¹äºT1çš„è¿™ä¸ªç­‰å¾…åŠ¨ä½œï¼Œä½ åº”è¯¥å¯ä»¥æƒ³å‡ºå¾ˆå¤šç§åŠæ³•ï¼Œä¾‹å¦‚Thread.join()ã€CountDownLatchï¼Œç”šè‡³é˜»å¡é˜Ÿåˆ—éƒ½å¯ä»¥è§£å†³ï¼Œä¸è¿‡ä»Šå¤©æˆ‘ä»¬ç”¨Futureç‰¹æ€§æ¥å®ç°ã€‚</p><p><img src=\"https://static001.geekbang.org/resource/image/9c/8e/9cf7d188af9119a5e76788466b453d8e.png?wh=1142*617\" alt=\"\"></p><center><span class=\"reference\">çƒ§æ°´æ³¡èŒ¶æœ€ä¼˜åˆ†å·¥æ–¹æ¡ˆ</span></center><p>ä¸‹é¢çš„ç¤ºä¾‹ä»£ç å°±æ˜¯ç”¨è¿™ä¸€ç« æåˆ°çš„Futureç‰¹æ€§æ¥å®ç°çš„ã€‚é¦–å…ˆï¼Œæˆ‘ä»¬åˆ›å»ºäº†ä¸¤ä¸ªFutureTaskâ€”â€”ft1å’Œft2ï¼Œft1å®Œæˆæ´—æ°´å£¶ã€çƒ§å¼€æ°´ã€æ³¡èŒ¶çš„ä»»åŠ¡ï¼Œft2å®Œæˆæ´—èŒ¶å£¶ã€æ´—èŒ¶æ¯ã€æ‹¿èŒ¶å¶çš„ä»»åŠ¡ï¼›è¿™é‡Œéœ€è¦æ³¨æ„çš„æ˜¯ft1è¿™ä¸ªä»»åŠ¡åœ¨æ‰§è¡Œæ³¡èŒ¶ä»»åŠ¡å‰ï¼Œéœ€è¦ç­‰å¾…ft2æŠŠèŒ¶å¶æ‹¿æ¥ï¼Œæ‰€ä»¥ft1å†…éƒ¨éœ€è¦å¼•ç”¨ft2ï¼Œå¹¶åœ¨æ‰§è¡Œæ³¡èŒ¶ä¹‹å‰ï¼Œè°ƒç”¨ft2çš„get()æ–¹æ³•å®ç°ç­‰å¾…ã€‚</p><pre><code>// åˆ›å»ºä»»åŠ¡T2çš„FutureTask\nFutureTask&lt;String&gt; ft2\n  = new FutureTask&lt;&gt;(new T2Task());\n// åˆ›å»ºä»»åŠ¡T1çš„FutureTask\nFutureTask&lt;String&gt; ft1\n  = new FutureTask&lt;&gt;(new T1Task(ft2));\n// çº¿ç¨‹T1æ‰§è¡Œä»»åŠ¡ft1\nThread T1 = new Thread(ft1);\nT1.start();\n// çº¿ç¨‹T2æ‰§è¡Œä»»åŠ¡ft2\nThread T2 = new Thread(ft2);\nT2.start();\n// ç­‰å¾…çº¿ç¨‹T1æ‰§è¡Œç»“æœ\nSystem.out.println(ft1.get());\n\n// T1Taskéœ€è¦æ‰§è¡Œçš„ä»»åŠ¡ï¼š\n// æ´—æ°´å£¶ã€çƒ§å¼€æ°´ã€æ³¡èŒ¶\nclass T1Task implements Callable&lt;String&gt;{\n  FutureTask&lt;String&gt; ft2;\n  // T1ä»»åŠ¡éœ€è¦T2ä»»åŠ¡çš„FutureTask\n  T1Task(FutureTask&lt;String&gt; ft2){\n    this.ft2 = ft2;\n  }\n  @Override\n  String call() throws Exception {\n    System.out.println(&quot;T1:æ´—æ°´å£¶...&quot;);\n    TimeUnit.SECONDS.sleep(1);\n    \n    System.out.println(&quot;T1:çƒ§å¼€æ°´...&quot;);\n    TimeUnit.SECONDS.sleep(15);\n    // è·å–T2çº¿ç¨‹çš„èŒ¶å¶  \n    String tf = ft2.get();\n    System.out.println(&quot;T1:æ‹¿åˆ°èŒ¶å¶:&quot;+tf);\n\n    System.out.println(&quot;T1:æ³¡èŒ¶...&quot;);\n    return &quot;ä¸ŠèŒ¶:&quot; + tf;\n  }\n}\n// T2Taskéœ€è¦æ‰§è¡Œçš„ä»»åŠ¡:\n// æ´—èŒ¶å£¶ã€æ´—èŒ¶æ¯ã€æ‹¿èŒ¶å¶\nclass T2Task implements Callable&lt;String&gt; {\n  @Override\n  String call() throws Exception {\n    System.out.println(&quot;T2:æ´—èŒ¶å£¶...&quot;);\n    TimeUnit.SECONDS.sleep(1);\n\n    System.out.println(&quot;T2:æ´—èŒ¶æ¯...&quot;);\n    TimeUnit.SECONDS.sleep(2);\n\n    System.out.println(&quot;T2:æ‹¿èŒ¶å¶...&quot;);\n    TimeUnit.SECONDS.sleep(1);\n    return &quot;é¾™äº•&quot;;\n  }\n}\n// ä¸€æ¬¡æ‰§è¡Œç»“æœï¼š\nT1:æ´—æ°´å£¶...\nT2:æ´—èŒ¶å£¶...\nT1:çƒ§å¼€æ°´...\nT2:æ´—èŒ¶æ¯...\nT2:æ‹¿èŒ¶å¶...\nT1:æ‹¿åˆ°èŒ¶å¶:é¾™äº•\nT1:æ³¡èŒ¶...\nä¸ŠèŒ¶:é¾™äº•\n</code></pre><h2>æ€»ç»“</h2><p>åˆ©ç”¨Javaå¹¶å‘åŒ…æä¾›çš„Futureå¯ä»¥å¾ˆå®¹æ˜“è·å¾—å¼‚æ­¥ä»»åŠ¡çš„æ‰§è¡Œç»“æœï¼Œæ— è®ºå¼‚æ­¥ä»»åŠ¡æ˜¯é€šè¿‡çº¿ç¨‹æ± ThreadPoolExecutoræ‰§è¡Œçš„ï¼Œè¿˜æ˜¯é€šè¿‡æ‰‹å·¥åˆ›å»ºå­çº¿ç¨‹æ¥æ‰§è¡Œçš„ã€‚Futureå¯ä»¥ç±»æ¯”ä¸ºç°å®ä¸–ç•Œé‡Œçš„æè´§å•ï¼Œæ¯”å¦‚å»è›‹ç³•åº—è®¢ç”Ÿæ—¥è›‹ç³•ï¼Œè›‹ç³•åº—éƒ½æ˜¯å…ˆç»™ä½ ä¸€å¼ æè´§å•ï¼Œä½ æ‹¿åˆ°æè´§å•ä¹‹åï¼Œæ²¡æœ‰å¿…è¦ä¸€ç›´åœ¨åº—é‡Œç­‰ç€ï¼Œå¯ä»¥å…ˆå»å¹²ç‚¹å…¶ä»–äº‹ï¼Œæ¯”å¦‚çœ‹åœºç”µå½±ï¼›ç­‰çœ‹å®Œç”µå½±åï¼ŒåŸºæœ¬ä¸Šè›‹ç³•ä¹Ÿåšå¥½äº†ï¼Œç„¶åä½ å°±å¯ä»¥å‡­æè´§å•é¢†è›‹ç³•äº†ã€‚</p><p>åˆ©ç”¨å¤šçº¿ç¨‹å¯ä»¥å¿«é€Ÿå°†ä¸€äº›ä¸²è¡Œçš„ä»»åŠ¡å¹¶è¡ŒåŒ–ï¼Œä»è€Œæé«˜æ€§èƒ½ï¼›å¦‚æœä»»åŠ¡ä¹‹é—´æœ‰ä¾èµ–å…³ç³»ï¼Œæ¯”å¦‚å½“å‰ä»»åŠ¡ä¾èµ–å‰ä¸€ä¸ªä»»åŠ¡çš„æ‰§è¡Œç»“æœï¼Œè¿™ç§é—®é¢˜åŸºæœ¬ä¸Šéƒ½å¯ä»¥ç”¨Futureæ¥è§£å†³ã€‚åœ¨åˆ†æè¿™ç§é—®é¢˜çš„è¿‡ç¨‹ä¸­ï¼Œå»ºè®®ä½ ç”¨æœ‰å‘å›¾æè¿°ä¸€ä¸‹ä»»åŠ¡ä¹‹é—´çš„ä¾èµ–å…³ç³»ï¼ŒåŒæ—¶å°†çº¿ç¨‹çš„åˆ†å·¥ä¹Ÿåšå¥½ï¼Œç±»ä¼¼äºçƒ§æ°´æ³¡èŒ¶æœ€ä¼˜åˆ†å·¥æ–¹æ¡ˆé‚£å¹…å›¾ã€‚å¯¹ç…§å›¾æ¥å†™ä»£ç ï¼Œå¥½å¤„æ˜¯æ›´å½¢è±¡ï¼Œä¸”ä¸æ˜“å‡ºé”™ã€‚</p><h2>è¯¾åæ€è€ƒ</h2><p>ä¸ä¹…å‰å¬è¯´å°æ˜è¦åšä¸€ä¸ªè¯¢ä»·åº”ç”¨ï¼Œè¿™ä¸ªåº”ç”¨éœ€è¦ä»ä¸‰ä¸ªç”µå•†è¯¢ä»·ï¼Œç„¶åä¿å­˜åœ¨è‡ªå·±çš„æ•°æ®åº“é‡Œã€‚æ ¸å¿ƒç¤ºä¾‹ä»£ç å¦‚ä¸‹æ‰€ç¤ºï¼Œç”±äºæ˜¯ä¸²è¡Œçš„ï¼Œæ‰€ä»¥æ€§èƒ½å¾ˆæ…¢ï¼Œä½ æ¥è¯•ç€ä¼˜åŒ–ä¸€ä¸‹å§ã€‚</p><pre><code>// å‘ç”µå•†S1è¯¢ä»·ï¼Œå¹¶ä¿å­˜\nr1 = getPriceByS1();\nsave(r1);\n// å‘ç”µå•†S2è¯¢ä»·ï¼Œå¹¶ä¿å­˜\nr2 = getPriceByS2();\nsave(r2);\n// å‘ç”µå•†S3è¯¢ä»·ï¼Œå¹¶ä¿å­˜\nr3 = getPriceByS3();\nsave(r3);\n</code></pre><p>æ¬¢è¿åœ¨ç•™è¨€åŒºä¸æˆ‘åˆ†äº«ä½ çš„æƒ³æ³•ï¼Œä¹Ÿæ¬¢è¿ä½ åœ¨ç•™è¨€åŒºè®°å½•ä½ çš„æ€è€ƒè¿‡ç¨‹ã€‚æ„Ÿè°¢é˜…è¯»ï¼Œå¦‚æœä½ è§‰å¾—è¿™ç¯‡æ–‡ç« å¯¹ä½ æœ‰å¸®åŠ©çš„è¯ï¼Œä¹Ÿæ¬¢è¿æŠŠå®ƒåˆ†äº«ç»™æ›´å¤šçš„æœ‹å‹ã€‚</p><p></p>","neighbors":{"left":{"article_title":"22 | Executorä¸çº¿ç¨‹æ± ï¼šå¦‚ä½•åˆ›å»ºæ­£ç¡®çš„çº¿ç¨‹æ± ï¼Ÿ","id":90771},"right":{"article_title":"24 | CompletableFutureï¼šå¼‚æ­¥ç¼–ç¨‹æ²¡é‚£ä¹ˆéš¾","id":91569}},"comments":[{"had_liked":false,"id":87921,"user_name":"aroll","can_delete":false,"product_type":"c1","uid":1023524,"ip_address":"","ucode":"3A1A1267C88CC3","user_header":"https://static001.geekbang.org/account/avatar/00/0f/9e/24/0d6a7987.jpg","comment_is_top":false,"comment_ctime":1555754394,"is_pvip":false,"replies":[{"id":"31624","content":"å¥½å»ºè®®","user_name":"ä½œè€…å›å¤","user_name_real":"ç‹å®ä»¤","uid":"1269969","ctime":1555769223,"ip_address":"","comment_id":87921,"utype":1}],"discussion_count":13,"race_medal":0,"score":"409577647514","product_id":100023901,"comment_content":"å»ºè®®å¹¶å‘ç¼–ç¨‹è¯¾ç¨‹ä¸­çš„Demoä»£ç ï¼Œå°½é‡å°‘ä½¿ç”¨System.out.println, å› ä¸ºå…¶å®ç°æœ‰ä½¿ç”¨éšå¼é”ï¼Œä¸€äº›æƒ…å†µè¿˜ä¼šæœ‰é”ç²—åŒ–äº§ç”Ÿ","like_count":96,"discussions":[{"author":{"id":1269969,"avatar":"https://static001.geekbang.org/account/avatar/00/13/60/d1/8efa89ab.jpg","nickname":"ç‹å®ä»¤","note":"","ucode":"4FE19F5BC32FCA","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":447648,"discussion_content":"å¥½å»ºè®®","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1555769223,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1475385,"avatar":"https://static001.geekbang.org/account/avatar/00/16/83/39/f9623363.jpg","nickname":"ç«¹é©¬å½¦å››éƒçš„å¥½æœ‹å‹å½±æ³•å¸«","note":"","ucode":"A9555AEFF90CDF","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":349433,"discussion_content":"åªè¯´äº†é—®é¢˜ï¼Œæ²¡è¯´è§£å†³æ–¹å¼ï¼Ÿ","likes_number":1,"is_delete":false,"is_hidden":false,"ctime":1613203724,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1433535,"avatar":"https://static001.geekbang.org/account/avatar/00/15/df/bf/96b50d1e.jpg","nickname":"ğŸ˜š 46","note":"","ucode":"EED0EBBBF80A43","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":554740,"discussion_content":"æˆ‘çœ‹äº†ä¸‹ï¼Œæ„Ÿè§‰å…¶å®printlnå’Œprintéƒ½ä¸€æ ·ï¼Œä»–ä»¬éƒ½è°ƒç”¨äº†formaté‡Œé¢ä¸€æ ·æœ‰é”æœºåˆ¶ã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1646575784,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":2593255,"avatar":"https://thirdwx.qlogo.cn/mmopen/vi_32/2msSWvJs8A6icPvUzyRs9DEqltYh0edy699wJz9BmCRoJj1bZHhBHhp4yY9Nic9oc2q8OdsVGwtmBRhKtw00Jj6Q/132","nickname":"Geek_c139e0","note":"","ucode":"87C7E07E98354B","race_medal":0,"user_type":1,"is_pvip":true},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":548262,"discussion_content":"å¯ä»¥System.out.print(&#34;xxx&#34;) + System.out.println()","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1643103920,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1213078,"avatar":"https://static001.geekbang.org/account/avatar/00/12/82/96/aa795685.jpg","nickname":"mghio","note":"","ucode":"74883EDE4FD0DC","race_medal":0,"user_type":1,"is_pvip":true},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":389524,"discussion_content":"è¿™æ³¢æ“ä½œï¼Œå­¦ä¹ äº†ï¼","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1629301123,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1046429,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/f7/9d/be04b331.jpg","nickname":"è½å¶é£é€çš„æ‹","note":"","ucode":"F9A95DB28BCF1E","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":373394,"discussion_content":"logæ—¥å¿—è¾“å‡ºå³å¯","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1620717444,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1168504,"avatar":"https://static001.geekbang.org/account/avatar/00/11/d4/78/66b3f2a2.jpg","nickname":"æ–¯ç›–ä¸¸","note":"","ucode":"B881D14B028F14","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":348282,"discussion_content":"æ›´å¥½çš„æ–¹å¼æ˜¯ï¼Ÿ","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1612497509,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":2139604,"avatar":"","nickname":"æˆç”µå¸…æ‰","note":"","ucode":"DDE757138F41D2","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":346072,"discussion_content":"å‰å®³äº†ï¼Œç‰›å•¤","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1611849836,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1441895,"avatar":"https://static001.geekbang.org/account/avatar/00/16/00/67/e24dd940.jpg","nickname":"é‚£æœˆçœŸç¾","note":"","ucode":"CEF1AF65C6064E","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":301869,"discussion_content":"å•¥æ„æ€å•Šï¼Ÿ","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1598690918,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":1,"child_discussions":[{"author":{"id":1730576,"avatar":"","nickname":"27","note":"","ucode":"B5D7A54EA47206","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":1441895,"avatar":"https://static001.geekbang.org/account/avatar/00/16/00/67/e24dd940.jpg","nickname":"é‚£æœˆçœŸç¾","note":"","ucode":"CEF1AF65C6064E","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":304093,"discussion_content":"ä½ çœ‹ä¸‹printlnï¼ˆï¼‰æ–¹æ³•å®ç°ï¼Œæ˜¯ä¸æ˜¯å¸¦synchronized,   ç„¶åå†çœ‹ä¸‹out,æ˜¯ä¸æ˜¯static","likes_number":6,"is_delete":false,"is_hidden":false,"ctime":1599467689,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":301869,"ip_address":""},"score":304093,"extra":""}]},{"author":{"id":1533266,"avatar":"https://static001.geekbang.org/account/avatar/00/17/65/52/07c09c7f.jpg","nickname":"josancpp","note":"","ucode":"0CDC39B3E716A3","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":276426,"discussion_content":"ä¸ç”¨printlnä¸­é—´ç»“æœæ€ä¹ˆçœ‹ï¼Ÿ","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1590865851,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1052191,"avatar":"https://static001.geekbang.org/account/avatar/00/10/0e/1f/d0472177.jpg","nickname":"å‰å®³äº†æˆ‘çš„å›½","note":"","ucode":"CD0A54A1B998AA","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":209874,"discussion_content":"å­¦ä¹ äº†","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1584684074,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":3,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1121758,"avatar":"https://static001.geekbang.org/account/avatar/00/11/1d/de/62bfa83f.jpg","nickname":"aoe","note":"","ucode":"1C6201EDB4E954","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":49306,"discussion_content":"é«˜æ‰‹ï¼å­¦ä¹ äº†ï¼Œæ„Ÿè°¢ã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1573570942,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":3,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":88160,"user_name":"vector","can_delete":false,"product_type":"c1","uid":1107266,"ip_address":"","ucode":"F42E76E8966BBE","user_header":"https://static001.geekbang.org/account/avatar/00/10/e5/42/fbe890c0.jpg","comment_is_top":false,"comment_ctime":1555861035,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"242074029611","product_id":100023901,"comment_content":"æœ€è¿‘ä½¿ç”¨CompletableFutureå·¥å…·æ–¹æ³•ä»¥åŠlamdaè¡¨è¾¾å¼æ¯”è¾ƒå¤šï¼Œè¯­è¨€è¯­æ³•çš„å˜åŒ–å¸¦æ¥ç¼–ç æ•ˆç‡çš„æå‡çœŸçš„å¾ˆå¤§ã€‚","like_count":57},{"had_liked":false,"id":87806,"user_name":"undifined","can_delete":false,"product_type":"c1","uid":1068920,"ip_address":"","ucode":"449CB4CD2DC089","user_header":"https://static001.geekbang.org/account/avatar/00/10/4f/78/c3d8ecb0.jpg","comment_is_top":false,"comment_ctime":1555720930,"is_pvip":false,"discussion_count":2,"race_medal":0,"score":"169059445474","product_id":100023901,"comment_content":"è¯¾åé¢˜ï¼š<br>å¯ä»¥ç”¨ Future<br>        ExecutorService threadPoolExecutor = Executors.newFixedThreadPool(3);<br>        Future&lt;R&gt; future1 = threadPoolExecutor.submit(Test::getPriceByS1);<br>        Future&lt;R&gt; future2 = threadPoolExecutor.submit(Test::getPriceByS2);<br>        Future&lt;R&gt; future3 = threadPoolExecutor.submit(Test::getPriceByS3);<br>        R r1 = future1.get();<br>        R r2 = future2.get();<br>        R r3 = future3.get();<br><br>ä¹Ÿå¯ä»¥ç”¨ CompletableFuture<br>        CompletableFuture&lt;R&gt; completableFuture1 = CompletableFuture.supplyAsync(Test::getPriceByS1);<br>        CompletableFuture&lt;R&gt; completableFuture2 = CompletableFuture.supplyAsync(Test::getPriceByS2);<br>        CompletableFuture&lt;R&gt; completableFuture3 = CompletableFuture.supplyAsync(Test::getPriceByS3);<br>        CompletableFuture.allOf(completableFuture1, completableFuture2, completableFuture3)<br>                         .thenAccept(System.out::println);<br> è€å¸ˆè¿™æ ·ç†è§£å¯¹å— è°¢è°¢è€å¸ˆ","like_count":40,"discussions":[{"author":{"id":1533266,"avatar":"https://static001.geekbang.org/account/avatar/00/17/65/52/07c09c7f.jpg","nickname":"josancpp","note":"","ucode":"0CDC39B3E716A3","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":276579,"discussion_content":"thenAcceptæ”¹ä¸ºjoinå°±è¡Œã€‚ä¸‰è€…ä¸éœ€è¦èšåˆï¼Œå„è‡ªä¿å­˜ç»“æœ","likes_number":6,"is_delete":false,"is_hidden":false,"ctime":1590907509,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1605330,"avatar":"https://static001.geekbang.org/account/avatar/00/18/7e/d2/be993431.jpg","nickname":"æ°µåˆå¼“è™½","note":"","ucode":"A62F060B02CDD7","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":230975,"discussion_content":"æ„Ÿè§‰æ˜¯ä¸æ˜¯å¢åŠ è¶…æ—¶è®¾ç½®æ›´å¥½ç‚¹","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1586783498,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":88083,"user_name":"Asanz","can_delete":false,"product_type":"c1","uid":1005200,"ip_address":"","ucode":"430AB7ED59EE3F","user_header":"https://static001.geekbang.org/account/avatar/00/0f/56/90/be01bb8d.jpg","comment_is_top":false,"comment_ctime":1555841707,"is_pvip":false,"discussion_count":8,"race_medal":0,"score":"96045122219","product_id":100023901,"comment_content":"ä¸æ˜¯ä¸å»ºè®®ä½¿ç”¨ Executors åˆ›å»ºçº¿ç¨‹æ± äº†å—ï¼Ÿï¼Ÿï¼Ÿ<br>","like_count":23,"discussions":[{"author":{"id":1691400,"avatar":"https://static001.geekbang.org/account/avatar/00/19/cf/08/e9d68285.jpg","nickname":"wangzx","note":"","ucode":"3024F0A43B7A32","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":230392,"discussion_content":"ä¸å»ºè®®ä½¿ç”¨ï¼Œæ˜¯å› ä¸ºExecutorsä¸­ä½¿ç”¨çš„æ˜¯æ— ç•Œé˜Ÿåˆ—ï¼Œé«˜å¹¶å‘ä¼šå¯¼è‡´OOM.å·²çŸ¥çº¿ç¨‹ä¸ªæ•°è¿˜æ˜¯å¯ä»¥ä½¿ç”¨çš„","likes_number":8,"is_delete":false,"is_hidden":false,"ctime":1586742513,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1638187,"avatar":"","nickname":"Geek_94adb8","note":"","ucode":"B142F473E1A0B3","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":211558,"discussion_content":"ThreadPoolExecutor çš„æ„é€ å‡½æ•°å®åœ¨æ˜¯æœ‰äº›å¤æ‚ï¼Œæ‰€ä»¥ Java å¹¶å‘åŒ…é‡Œæä¾›äº†ä¸€ä¸ªçº¿ç¨‹æ± çš„é™æ€å·¥å‚ç±» Executorsï¼Œä¸å»ºè®®ä½¿ç”¨çš„æ˜¯Executorsï¼Œè€Œä¸æ˜¯ThreadPoolExecutorã€‚","likes_number":1,"is_delete":false,"is_hidden":false,"ctime":1584864950,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1178380,"avatar":"https://static001.geekbang.org/account/avatar/00/11/fb/0c/85d60820.jpg","nickname":"å°åå“¥","note":"","ucode":"546EF8803E101F","race_medal":1,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":579174,"discussion_content":"ä¸å»ºè®®ç”¨è¿˜æ˜¯å¯ä»¥ç”¨çš„å“ˆğŸ˜Š","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1657237323,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":2568689,"avatar":"https://static001.geekbang.org/account/avatar/00/27/31/f1/1ff57b9d.jpg","nickname":"å¾å¯ŒçŒ®","note":"","ucode":"D1E901376F8D49","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":542042,"discussion_content":"è€å¸ˆæ²¡æœ‰æ¥å—è‡ªå·±çš„å»ºè®®","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1640651253,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":2282481,"avatar":"","nickname":"Geek_157395","note":"","ucode":"D00CBA7A104FE6","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":351866,"discussion_content":"æŸ¥çœ‹è¿™ä¸ªå†…éƒ¨å®ç°ï¼Œè¿˜æ˜¯ä½¿ç”¨äº†ThreadPoolExecutor","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1614503230,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1366632,"avatar":"https://static001.geekbang.org/account/avatar/00/14/da/68/11ab05f3.jpg","nickname":"user","note":"","ucode":"D8C53679C24B61","race_medal":0,"user_type":1,"is_pvip":true},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":252447,"discussion_content":"Cachedçš„æœ€å¤§çº¿ç¨‹æ•°æ˜¯Integer.MAXVALUE æœ‰ä»»åŠ¡ä¼šæ— é™åˆ›å»ºçº¿ç¨‹ Fixed å’ŒSingleçš„å·¥ä½œé˜Ÿåˆ—æ˜¯æ— ç•Œé˜Ÿåˆ— å¹¶å‘å¤§çš„æƒ…å†µå¯èƒ½ä¼šå¯¼è‡´OOM ï¼Œä»£ç æ˜¯å’Œä¸šåŠ¡èµ°çš„ èƒ½é¢„ä¼°åˆ°å…·ä½“çš„ä¸šåŠ¡é‡ç›´æ¥åˆ›å»ºçº¿ç¨‹æ± ä¹Ÿæ— å¯åšé","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1588166381,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1133702,"avatar":"https://static001.geekbang.org/account/avatar/00/11/4c/86/3be94807.jpg","nickname":"angelğŸ˜‡txyğŸ¤“","note":"","ucode":"C0AEE0D8BAF7ED","race_medal":0,"user_type":1,"is_pvip":true},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":6188,"discussion_content":"ç®€å•å•Šï¼Œè€å¸ˆæƒ³æ•™ç»™æˆ‘ä»¬å¾—æ˜¯æ€è·¯","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1566769068,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":1,"child_discussions":[{"author":{"id":1638187,"avatar":"","nickname":"Geek_94adb8","note":"","ucode":"B142F473E1A0B3","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":1133702,"avatar":"https://static001.geekbang.org/account/avatar/00/11/4c/86/3be94807.jpg","nickname":"angelğŸ˜‡txyğŸ¤“","note":"","ucode":"C0AEE0D8BAF7ED","race_medal":0,"user_type":1,"is_pvip":true},"discussion":{"id":211560,"discussion_content":"........","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1584865027,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":6188,"ip_address":""},"score":211560,"extra":""}]}]},{"had_liked":false,"id":148599,"user_name":"Joker","can_delete":false,"product_type":"c1","uid":1156592,"ip_address":"","ucode":"126AF848001A1E","user_header":"https://static001.geekbang.org/account/avatar/00/11/a5/f0/8648c464.jpg","comment_is_top":false,"comment_ctime":1573036679,"is_pvip":false,"replies":[{"id":"57240","content":"æˆ‘è§‰å¾—æ²¡é—®é¢˜ã€‚ä¹Ÿå¯ä»¥ç”¨ä¸€ä¸ªçº¿ç¨‹æ± ï¼ŒæŠŠæŸ¥è¯¢å’Œä¿å­˜æ”¾ä¸€ä¸ªçº¿ç¨‹é‡Œã€‚","user_name":"ä½œè€…å›å¤","user_name_real":"ç‹å®ä»¤","uid":"1269969","ctime":1573047697,"ip_address":"","comment_id":148599,"utype":1}],"discussion_count":4,"race_medal":0,"score":"78882448007","product_id":100023901,"comment_content":"```\rjava<br>ExecutorService futuresPool = Executors.newFixedThreadPool(3);<br>        Future&lt;Price&gt; future1 = futuresPool.submit(this::getPriceByS1);<br>        Future&lt;Price&gt; future2 = futuresPool.submit(this::getPriceByS2);<br>        Future&lt;Price&gt; future3 = futuresPool.submit(this::getPriceByS3);<br><br>        ExecutorService saveThreadPool = Executors.newFixedThreadPool(3);<br>        saveThreadPool.execute(() -&gt; {<br>            try {<br>                Price r1= future1.get();<br>                save(r1);<br>            } catch (InterruptedException e) {<br>                e.printStackTrace();<br>            } catch (ExecutionException e) {<br>                e.printStackTrace();<br>            }<br><br>        });<br>        saveThreadPool.execute(() -&gt; {<br>            try {<br>                Price r2= future2.get();<br>                save(r2);<br>            } catch (InterruptedException e) {<br>                e.printStackTrace();<br>            } catch (ExecutionException e) {<br>                e.printStackTrace();<br>            }<br><br>        });<br>        saveThreadPool.execute(() -&gt; {<br>            try {<br>                Price r3= future3.get();<br>                save(r3);<br>            } catch (InterruptedException e) {<br>                e.printStackTrace();<br>            } catch (ExecutionException e) {<br>                e.printStackTrace();<br>            }<br>        });<br>```\r<br><br>ç”¨ä¸‰ä¸ªçº¿ç¨‹æŠŠè¿™ä¸ªå¹¶è¡Œæ‰§è¡Œï¼Œéº»çƒ¦è€å¸ˆçœ‹çœ‹ï¼Œè°¢è°¢","like_count":19,"discussions":[{"author":{"id":1269969,"avatar":"https://static001.geekbang.org/account/avatar/00/13/60/d1/8efa89ab.jpg","nickname":"ç‹å®ä»¤","note":"","ucode":"4FE19F5BC32FCA","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":473547,"discussion_content":"æˆ‘è§‰å¾—æ²¡é—®é¢˜ã€‚ä¹Ÿå¯ä»¥ç”¨ä¸€ä¸ªçº¿ç¨‹æ± ï¼ŒæŠŠæŸ¥è¯¢å’Œä¿å­˜æ”¾ä¸€ä¸ªçº¿ç¨‹é‡Œã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1573047697,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1991586,"avatar":"https://static001.geekbang.org/account/avatar/00/1e/63/a2/804f9572.jpg","nickname":"åŠ é›·é”…","note":"","ucode":"507CC13DFBB821","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":531991,"discussion_content":"æ—¢ç„¶æ˜¯é’ˆå¯¹æ•°æ®åº“ä¿å­˜ï¼Œå¦‚æœä¸‰ä¸ªæ•°å€¼éƒ½ä¿å­˜åœ¨åŒä¸€å¼ è¡¨é‡Œï¼Œæˆ‘è§‰å¾—å¹¶å‘æ‰§è¡Œè·å¾—ç»“æœåï¼ŒåŒæ—¶ä¿å­˜åˆ°æ•°æ®åº“ä¸­ï¼Œå¯ä»¥æœ‰æ•ˆå‡å°‘æ•°æ®åº“çš„ç´¢å¼•é‡å»ºç­‰é—®é¢˜ï¼Œæé«˜å†™å…¥æ€§èƒ½","likes_number":2,"is_delete":false,"is_hidden":false,"ctime":1637490700,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"user_type\":1}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1187478,"avatar":"https://static001.geekbang.org/account/avatar/00/12/1e/96/c735ad6b.jpg","nickname":"æ»©æ¶‚æ›³å°¾","note":"","ucode":"40F650F2A419D4","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":194818,"discussion_content":"è€å¸ˆè¯´çš„æ˜¯å¯¹çš„ï¼Œå› ä¸ºå¯¹äºåŒä¸€ä¸ªå•†å®¶ï¼Œè¯¢ä»·å’Œä¿å­˜è‚¯å®šæ˜¯ä¸²è¡Œçš„ï¼Œæ²¡æœ‰å¿…è¦åˆ†å‰²æˆä¸¤ä¸ªçº¿ç¨‹ã€‚","likes_number":2,"is_delete":false,"is_hidden":false,"ctime":1583243589,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":3164346,"avatar":"https://static001.geekbang.org/account/avatar/00/30/48/ba/791d0f5e.jpg","nickname":"JavaLearn","note":"","ucode":"3AAFBFD34F04A5","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":587799,"discussion_content":"æœ‰ä¸€è¯´ä¸€çœ‹çš„æˆ‘è¿·æƒ‘äº†ä¸€ä¼šå„¿ï¼Œè¿™ä¸ªæ²¡å¿…è¦ç”¨åˆ°Futureï¼Œç›´æ¥å†™åœ¨åŒä¸€çº¿ç¨‹å³å¯äº†","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1663297876,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":"å¹¿ä¸œ"},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":87799,"user_name":"å¼ å¤©å±¹","can_delete":false,"product_type":"c1","uid":1477612,"ip_address":"","ucode":"8BD6BD6DCF0F4F","user_header":"https://static001.geekbang.org/account/avatar/00/16/8b/ec/dc03f5ad.jpg","comment_is_top":false,"comment_ctime":1555717851,"is_pvip":false,"replies":[{"id":"31610","content":"ç”¨çº¿ç¨‹æ± å°±ç”¨åˆ°äº†","user_name":"ä½œè€…å›å¤","user_name_real":"ç‹å®ä»¤","uid":"1269969","ctime":1555737777,"ip_address":"","comment_id":87799,"utype":1}],"discussion_count":3,"race_medal":0,"score":"35915456219","product_id":100023901,"comment_content":"æˆ‘ä¸çŸ¥é“æ˜¯ä¸æ˜¯ç†è§£é”™è€å¸ˆæ„æ€äº†ï¼Œå…ˆåˆ†æä¾èµ–æœ‰å‘å›¾ï¼Œå¯ä»¥çœ‹åˆ°ä¸‰æ¡çº¿ï¼Œæ²¡æœ‰å…¥åº¦&gt;1çš„èŠ‚ç‚¹<br>é‚£ä¹ˆå¯åŠ¨ä¸‰ä¸ªçº¿ç¨‹å³å¯ã€‚<br>å›¾ï¼š<br>s1è¯¢ä»· -&gt; s1ä¿å­˜  <br>s2è¯¢ä»· -&gt; s2ä¿å­˜<br>s3è¯¢ä»· -&gt; s3ä¿å­˜  <br>ä»£ç ï¼š<br>        new Thread(() -&gt; {<br>        \tr1 = getPriceByS1();<br>        \tsave(r1);<br>        }).start();<br>        new Thread(() -&gt; {<br>        \tr2 = getPriceByS2();<br>        \tsave(r2);<br>        }).start();<br>        new Thread(() -&gt; {<br>        \tr3 = getPriceByS3();<br>        \tsave(r3);<br>        }).start();<br>æˆ‘è§‰å¾—è¿™é‡Œä¸éœ€è¦future,é™¤éè¯¢ä»·å’Œä¿å­˜ä¹‹é—´è¿˜æœ‰åˆ«çš„è®¡ç®—å·¥ä½œ","like_count":8,"discussions":[{"author":{"id":1269969,"avatar":"https://static001.geekbang.org/account/avatar/00/13/60/d1/8efa89ab.jpg","nickname":"ç‹å®ä»¤","note":"","ucode":"4FE19F5BC32FCA","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":447605,"discussion_content":"ç”¨çº¿ç¨‹æ± å°±ç”¨åˆ°äº†","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1555737777,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1053955,"avatar":"https://static001.geekbang.org/account/avatar/00/10/15/03/c0fe1dbf.jpg","nickname":"è€ƒä¼‘","note":"","ucode":"968DFC00D6D0CF","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":45347,"discussion_content":"å¦‚æœæ˜¯æ•°æ®åº“ä¿å­˜çš„è¯ï¼Œè¿™æ ·å¾—éœ€è¦ä¸‰æ¬¡æ•°æ®åº“è¿æ¥åˆ†åˆ«ä¿å­˜æ•°æ®ï¼Œå¦‚æœè·å–åˆ°ç»“æœåç»Ÿä¸€æ·»åŠ åˆ°æ•°æ®çš„è¯ï¼Œåˆ™ä¸€æ¬¡æ‰¹é‡æ“ä½œå°±å¯ä»¥äº†ï¼Œæ•ˆç‡æ›´é«˜ä¸€äº›","likes_number":2,"is_delete":false,"is_hidden":false,"ctime":1573026242,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1142239,"avatar":"https://static001.geekbang.org/account/avatar/00/11/6d/df/dd536ff5.jpg","nickname":"é­æ–Œæ–Œ","note":"","ucode":"E443EB0504CA37","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":1388,"discussion_content":"æˆ‘è§‰å¾—å³ä½¿ç”¨çº¿ç¨‹æ± ä¹Ÿå¯ä»¥ä¸ç”¨future,åœ¨æ¯ä¸ªrunnableé‡Œé¢ä¿å­˜è¯¢ä»·ç»“æœä¸å°±è¡Œäº†å—ï¼Ÿ","likes_number":2,"is_delete":false,"is_hidden":false,"ctime":1562594852,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":104543,"user_name":"é­æ–Œæ–Œ","can_delete":false,"product_type":"c1","uid":1142239,"ip_address":"","ucode":"E443EB0504CA37","user_header":"https://static001.geekbang.org/account/avatar/00/11/6d/df/dd536ff5.jpg","comment_is_top":false,"comment_ctime":1560774831,"is_pvip":false,"replies":[{"id":"38346","content":"å¯ä»¥çœ‹çœ‹æ“ä½œç³»ç»ŸåŸç†æœ‰å…³çº¿ç¨‹ï¼Œè¿›ç¨‹çš„é‚£éƒ¨åˆ†","user_name":"ä½œè€…å›å¤","user_name_real":"ç‹å®ä»¤","uid":"1269969","ctime":1561161094,"ip_address":"","comment_id":104543,"utype":1}],"discussion_count":3,"race_medal":0,"score":"31625545903","product_id":100023901,"comment_content":"è€å¸ˆï¼Œæˆ‘çœ‹äº†ä¸‹futrueraskçš„æºç ï¼Œå½“è°ƒç”¨futrue.get()æ–¹æ³•ï¼Œå…¶å®æœ€ç»ˆä¼šè°ƒç”¨unsafeæ–¹æ³•æ˜¯å½“å‰çº¿ç¨‹é˜»å¡ã€‚ä½†æ˜¯æˆ‘ä¸å¤ªç†è§£çº¿ç¨‹é˜»å¡åˆ°å“ªå»äº†ï¼Œä¹Ÿæ²¡çœ‹åˆ°é”ã€‚","like_count":8,"discussions":[{"author":{"id":1269969,"avatar":"https://static001.geekbang.org/account/avatar/00/13/60/d1/8efa89ab.jpg","nickname":"ç‹å®ä»¤","note":"","ucode":"4FE19F5BC32FCA","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":454317,"discussion_content":"å¯ä»¥çœ‹çœ‹æ“ä½œç³»ç»ŸåŸç†æœ‰å…³çº¿ç¨‹ï¼Œè¿›ç¨‹çš„é‚£éƒ¨åˆ†","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1561161094,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":1,"child_discussions":[{"author":{"id":2602705,"avatar":"","nickname":"Geek_d1026b","note":"","ucode":"EC5A17A4CB24C8","race_medal":0,"user_type":1,"is_pvip":true},"reply_author":{"id":1269969,"avatar":"https://static001.geekbang.org/account/avatar/00/13/60/d1/8efa89ab.jpg","nickname":"ç‹å®ä»¤","note":"","ucode":"4FE19F5BC32FCA","race_medal":0,"user_type":2,"is_pvip":false},"discussion":{"id":561963,"discussion_content":"æ“ä½œç³»ç»ŸåŸç†çš„çœ‹ä»€ä¹ˆä¹¦ è€å¸ˆ","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1649753843,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":454317,"ip_address":""},"score":561963,"extra":""}]},{"author":{"id":1343456,"avatar":"https://static001.geekbang.org/account/avatar/00/14/7f/e0/b77e176e.jpg","nickname":"å°å®","note":"","ucode":"08B34C89368649","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":581823,"discussion_content":"LockSupport.park","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1659008392,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":"é™•è¥¿"},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":95782,"user_name":"ä¸‰æœ¨ç¦¾","can_delete":false,"product_type":"c1","uid":1109458,"ip_address":"","ucode":"39C37228236860","user_header":"https://static001.geekbang.org/account/avatar/00/10/ed/d2/e3ae7ddd.jpg","comment_is_top":false,"comment_ctime":1558175137,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"23033011617","product_id":100023901,"comment_content":"è¿™ä¸ªå¯ä»¥ç”¨ç”Ÿäº§æ¶ˆè´¹è€…æ¨¡å¼å•Š","like_count":5},{"had_liked":false,"id":90566,"user_name":"Sunqc","can_delete":false,"product_type":"c1","uid":1473717,"ip_address":"","ucode":"2C54659635403F","user_header":"https://static001.geekbang.org/account/avatar/00/16/7c/b5/4a7a2bd4.jpg","comment_is_top":false,"comment_ctime":1556580862,"is_pvip":false,"replies":[{"id":"32443","content":"ç†è§£çš„å¯¹<br>","user_name":"ä½œè€…å›å¤","user_name_real":"ç‹å®ä»¤","uid":"1269969","ctime":1556590182,"ip_address":"","comment_id":90566,"utype":1}],"discussion_count":1,"race_medal":0,"score":"23031417342","product_id":100023901,"comment_content":"è€å¸ˆï¼Œä½ æ‰€è¯´çš„è®¢è›‹ç³•ï¼Œæˆ‘è¿™æ ·ç†è§£å¯¹å—ï¼ŒæŠŠä»»åŠ¡æäº¤ç»™çº¿ç¨‹æ± å°±æ˜¯è®©è›‹ç³•åº—åšè›‹ç³•ï¼›å»çœ‹ç”µå½±å°±æ˜¯ä¸»çº¿ç¨‹åšå…¶ä»–äº‹ï¼Œæè´§å•æ˜¯å¯¹åº”è°ƒç”¨futureçš„get","like_count":5,"discussions":[{"author":{"id":1269969,"avatar":"https://static001.geekbang.org/account/avatar/00/13/60/d1/8efa89ab.jpg","nickname":"ç‹å®ä»¤","note":"","ucode":"4FE19F5BC32FCA","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":448571,"discussion_content":"ç†è§£çš„å¯¹\n","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1556590182,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":90778,"user_name":"ãƒ¾(â—Â°âˆ‡Â°â—)ï¾‰ï¾","can_delete":false,"product_type":"c1","uid":1044175,"ip_address":"","ucode":"89545632BDA56E","user_header":"http://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTJOBwR7MCVqwZbPA5RQ2mjUjd571jUXUcBCE7lY5vSMibWn8D5S4PzDZMaAhRPdnRBqYbVOBTJibhJg/132","comment_is_top":false,"comment_ctime":1556637621,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"18736506805","product_id":100023901,"comment_content":"åˆ†åˆ«æäº¤ä¸‰ä¸ªfuturetaskç»™çº¿ç¨‹æ± ï¼Œç„¶åæœ€ååˆ†åˆ«getå‡ºç»“æœï¼Œç»Ÿä¸€è¿›è¡Œä¿å­˜æ•°æ®åº“","like_count":4},{"had_liked":false,"id":88589,"user_name":"linqw","can_delete":false,"product_type":"c1","uid":1134138,"ip_address":"","ucode":"09DCFE98C54DD8","user_header":"https://static001.geekbang.org/account/avatar/00/11/4e/3a/86196508.jpg","comment_is_top":false,"comment_ctime":1555948523,"is_pvip":false,"replies":[{"id":"31773","content":"æ²¡é—®é¢˜ï¼Œå°±æ˜¯æœ‰ç‚¹å¤æ‚ï¼Œä»£ç è¿˜å¯ä»¥ç²¾ç®€ä¸€ä¸‹<br>","user_name":"ä½œè€…å›å¤","user_name_real":"ç‹å®ä»¤","uid":"1269969","ctime":1555978597,"ip_address":"","comment_id":88589,"utype":1}],"discussion_count":2,"race_medal":0,"score":"14440850411","product_id":100023901,"comment_content":"è¯¾åä¹ é¢˜ï¼Œè€å¸ˆå¸®å¿™çœ‹ä¸‹å“¦<br>public class ExecutorExample {<br>private static final ExecutorService executor;<br>    static {executor = new ThreadPoolExecutor(4, 8, 1, TimeUnit.SECONDS, new ArrayBlockingQueue&lt;Runnable&gt;(1000), runnable -&gt; null, (r, executor) -&gt; {&#47;&#47;æ ¹æ®ä¸šåŠ¡é™çº§ç­–ç•¥});<br>}<br>static class S1Task implements Callable&lt;String&gt; {<br>        @Override<br>        public String call() throws Exception {return getPriceByS1();}}<br>    static class S2Task implements Callable&lt;String&gt; {<br>        @Overridepublic String call() throws Exception {return getPriceByS2();}}<br>    static class S3Task implements Callable&lt;String&gt; {@Override public String call() throws Exception {return getPriceByS3();}}<br>    static class SaveTask implements Callable&lt;Boolean&gt; {private List&lt;FutureTask&lt;String&gt;&gt; futureTasks; public SaveTask(List&lt;FutureTask&lt;String&gt;&gt; futureTasks) {this.futureTasks = futureTasks;<br>}<br>        @Override<br>        public Boolean call() throws Exception {<br>            for (FutureTask&lt;String&gt; futureTask : futureTasks) {<br>                String data = futureTask.get(10, TimeUnit.SECONDS);<br>                saveData(data);<br>            }<br>            return Boolean.TRUE;<br>        }<br>    }<br>    private static String getPriceByS1() {<br>        return &quot;fromDb1&quot;;<br>    }<br>    private static String getPriceByS2() {<br>        return &quot;fromDb2&quot;;<br>    }<br>    private static String getPriceByS3() {<br>        return &quot;fromDb3&quot;;<br>    }<br>    private static void saveData(String data) {<br>        &#47;&#47;save data to db<br>    }<br>    public static void main(String[] args) {<br>        S1Task s1Task = new S1Task();FutureTask&lt;String&gt; st1 = new FutureTask&lt;&gt;(s1Task);S2Task s2Task = new S2Task();FutureTask&lt;String&gt; st2 = new FutureTask&lt;&gt;(s2Task);S3Task s3Task = new S3Task();FutureTask&lt;String&gt; st3 = new FutureTask&lt;&gt;(s3Task);List&lt;FutureTask&lt;String&gt;&gt; futureTasks = Lists.&lt;FutureTask&lt;String&gt;&gt;newArrayList(st1, st2, st3);FutureTask&lt;Boolean&gt; saveTask = new FutureTask&lt;&gt;(new SaveTask(futureTasks));executor.submit(st1);executor.submit(st2);executor.submit(st3);executor.submit(saveTask);}}","like_count":3,"discussions":[{"author":{"id":1269969,"avatar":"https://static001.geekbang.org/account/avatar/00/13/60/d1/8efa89ab.jpg","nickname":"ç‹å®ä»¤","note":"","ucode":"4FE19F5BC32FCA","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":447839,"discussion_content":"æ²¡é—®é¢˜ï¼Œå°±æ˜¯æœ‰ç‚¹å¤æ‚ï¼Œä»£ç è¿˜å¯ä»¥ç²¾ç®€ä¸€ä¸‹\n","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1555978597,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1224708,"avatar":"http://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTLZpzZqvib4bzgfFb6Wt7fP2k4wefKYaoPwza1L19UGalddjREELPd6zAjyibdHJ7jxB2xtZmSuJjuA/132","nickname":"seele","note":"","ucode":"1824AA95FF1DF1","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":36865,"discussion_content":"æ„Ÿè§‰ä¸‰ä¸ªè¯¢ä»·ä»»åŠ¡ä¹‹é—´äº’ä¸å½±å“ï¼Œåº”è¯¥å¯ä»¥æ‹¿åˆ°è¯¢ä»·ç»“æœçš„æ—¶å€™è¿›è¡Œå…¥åº“æ“ä½œï¼Œæˆ‘çš„ç†è§£å¯¹å—ï¼Ÿ","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1571453719,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":87804,"user_name":"henry","can_delete":false,"product_type":"c1","uid":1075941,"ip_address":"","ucode":"0ACD12F363F8DE","user_header":"http://thirdqq.qlogo.cn/qqapp/101418266/D6DD8CB1004D442B48914656340277F3/100","comment_is_top":false,"comment_ctime":1555720184,"is_pvip":false,"replies":[{"id":"31609","content":"ğŸ‘<br>","user_name":"ä½œè€…å›å¤","user_name_real":"ç‹å®ä»¤","uid":"1269969","ctime":1555737716,"ip_address":"","comment_id":87804,"utype":1}],"discussion_count":1,"race_medal":0,"score":"14440622072","product_id":100023901,"comment_content":"ç°åœ¨æ˜¯åœ¨ä¸»çº¿ç¨‹ä¸²è¡Œå®Œæˆ3ä¸ªè¯¢ä»·çš„ä»»åŠ¡ï¼Œæ‰§è¡Œç¬¬ä¸€ä¸ªä»»åŠ¡ï¼Œå…¶å®ƒ2ä¸ªä»»åŠ¡åªèƒ½ç­‰å¾…æ‰§è¡Œï¼Œå¦‚æœè¦æé«˜æ•ˆç‡ï¼Œè¿™ä¸ªåœ°æ–¹éœ€è¦æ”¹è¿›ï¼Œå¯ä»¥ç”¨è€å¸ˆä»Šå¤©è®²çš„futuretaskï¼Œä¸‰ä¸ªè¯¢ä»·ä»»åŠ¡æ”¹æˆfuturetaskå¹¶è¡Œæ‰§è¡Œï¼Œæ•ˆç‡ä¼šæé«˜","like_count":3,"discussions":[{"author":{"id":1269969,"avatar":"https://static001.geekbang.org/account/avatar/00/13/60/d1/8efa89ab.jpg","nickname":"ç‹å®ä»¤","note":"","ucode":"4FE19F5BC32FCA","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":447609,"discussion_content":"ğŸ‘\n","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1555737716,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":236974,"user_name":"the only Miaâ€™s","can_delete":false,"product_type":"c1","uid":1271075,"ip_address":"","ucode":"8E2E1E71BF5B4F","user_header":"https://static001.geekbang.org/account/avatar/00/13/65/23/b42f102c.jpg","comment_is_top":false,"comment_ctime":1595634218,"is_pvip":false,"replies":[{"id":"87651","content":"å¯ä»¥","user_name":"ä½œè€…å›å¤","user_name_real":"ç‹å®ä»¤","uid":"1269969","ctime":1595761005,"ip_address":"","comment_id":236974,"utype":1}],"discussion_count":1,"race_medal":0,"score":"10185568810","product_id":100023901,"comment_content":"è€å¸ˆï¼Œjdk 8æä¾›çš„CompletableFutureï¼Œä»¥åå¼‚æ­¥å¤„ç†æ˜¯ä¸æ˜¯å¯ä»¥ç›´æ¥ç”¨æ­¤æ›¿ä»£","like_count":2,"discussions":[{"author":{"id":1269969,"avatar":"https://static001.geekbang.org/account/avatar/00/13/60/d1/8efa89ab.jpg","nickname":"ç‹å®ä»¤","note":"","ucode":"4FE19F5BC32FCA","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":502272,"discussion_content":"å¯ä»¥","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1595761005,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":146593,"user_name":"ç¨šè€…","can_delete":false,"product_type":"c1","uid":1128204,"ip_address":"","ucode":"D824C0B263B26A","user_header":"https://static001.geekbang.org/account/avatar/00/11/37/0c/c623649c.jpg","comment_is_top":false,"comment_ctime":1572577667,"is_pvip":false,"discussion_count":3,"race_medal":0,"score":"10162512259","product_id":100023901,"comment_content":"çƒ§æ°´æ³¡èŒ¶çš„Demoæœ‰ç‚¹å°é—®é¢˜ï¼ŒTask2çš„å¯åŠ¨æ—¶é—´åº”è¯¥åœ¨Task1çš„æ´—èŒ¶å£¶ä¹‹åå¼€å§‹ï¼Œç°åœ¨çš„ä»£ç æ˜¯ä¸€èµ·å¼€å§‹ã€‚","like_count":2,"discussions":[{"author":{"id":2753834,"avatar":"https://static001.geekbang.org/account/avatar/00/2a/05/2a/cfbcb0b2.jpg","nickname":"Donkey","note":"","ucode":"3DB4DFF6D99035","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":531099,"discussion_content":"è€å¸ˆçš„ä¾‹å­ç›¸å½“äºä¸¤ä¸ªäººå®Œæˆæ³¡èŒ¶ï¼Œæ•°å­¦é‡Œåº”è¯¥æ˜¯ä¸€ä¸ªäººå§","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1637229710,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"user_type\":1}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1605330,"avatar":"https://static001.geekbang.org/account/avatar/00/18/7e/d2/be993431.jpg","nickname":"æ°µåˆå¼“è™½","note":"","ucode":"A62F060B02CDD7","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":230985,"discussion_content":"ä¸€ä¸ªæ˜¯èŒ¶å£¶ï¼Œä¸€ä¸ªæ˜¯æ°´å£¶å§","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1586783881,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":1,"child_discussions":[{"author":{"id":1649057,"avatar":"https://static001.geekbang.org/account/avatar/00/19/29/a1/41607383.jpg","nickname":"hello","note":"","ucode":"4F42DAA5DB5C38","race_medal":0,"user_type":1,"is_pvip":true},"reply_author":{"id":1605330,"avatar":"https://static001.geekbang.org/account/avatar/00/18/7e/d2/be993431.jpg","nickname":"æ°µåˆå¼“è™½","note":"","ucode":"A62F060B02CDD7","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":344371,"discussion_content":"æŒ‰ç…§æµç¨‹åˆ†å·¥åº”è¯¥æ˜¯æœ‰é—®é¢˜çš„","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1611452502,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":230985,"ip_address":""},"score":344371,"extra":""}]}]},{"had_liked":false,"id":88227,"user_name":"åœ†åœœ","can_delete":false,"product_type":"c1","uid":1107716,"ip_address":"","ucode":"51A3AE18442A3D","user_header":"https://static001.geekbang.org/account/avatar/00/10/e7/04/ba949d78.jpg","comment_is_top":false,"comment_ctime":1555896285,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"10145830877","product_id":100023901,"comment_content":"ä½ è¿™ä¸ªä¸å¯¹å•Šï¼Œåº”è¯¥æ˜¯executeservice.submit t2furturetaskï¼Œä¸èƒ½ç›´æ¥æäº¤t2","like_count":2},{"had_liked":false,"id":87989,"user_name":"æé±¼çš„æ¬ç –å¥‡","can_delete":false,"product_type":"c1","uid":1021539,"ip_address":"","ucode":"2FD194C4DA26E5","user_header":"https://static001.geekbang.org/account/avatar/00/0f/96/63/7eb32c9b.jpg","comment_is_top":false,"comment_ctime":1555782269,"is_pvip":false,"discussion_count":1,"race_medal":0,"score":"10145716861","product_id":100023901,"comment_content":"Futureçš„get()æ˜¯æ‹¿åˆ°ä»»åŠ¡çš„æ‰§è¡Œç»“æœä¸å§ã€‚ä¸ºä»€ä¹ˆåˆè¯´æ˜¯æ‹¿åˆ°æ–¹æ³•çš„å…¥å‚äº†ã€‚","like_count":2,"discussions":[{"author":{"id":1225224,"avatar":"https://static001.geekbang.org/account/avatar/00/12/b2/08/92f42622.jpg","nickname":"å°”å†¬æ©™","note":"","ucode":"0B013A49BC18DA","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":574338,"discussion_content":"ç¬¬ä¸‰ä¸ªæ„é€ å‡½æ•°getçš„ç»“æœå°±æ˜¯ä¼ å…¥çš„ç¬¬äºŒä¸ªå‚æ•°ï¼Œè¿™æ ·çš„å¥½å¤„æ˜¯è®©å­çº¿ç¨‹ä¸»çº¿ç¨‹å…±äº«ä¸€ä¸ªå˜é‡","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1653982355,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":87860,"user_name":"QQæ€ª","can_delete":false,"product_type":"c1","uid":1211223,"ip_address":"","ucode":"1A39B8433D9208","user_header":"https://static001.geekbang.org/account/avatar/00/12/7b/57/a9b04544.jpg","comment_is_top":false,"comment_ctime":1555735299,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"10145669891","product_id":100023901,"comment_content":"åœ¨å®é™…é¡¹ç›®ä¸­åº”ç”¨å·²ç»åº”ç”¨åˆ°äº†Feture,ä½†æ²¡æœ‰ä½¿ç”¨çº¿ç¨‹æ± ï¼Œæ²¡æœ‰é‚£ä¹ˆä¼˜é›…ï¼Œæ‰€ä»¥ç®—æ˜¯getåˆ°äº†ğŸ‘","like_count":2},{"had_liked":false,"id":87813,"user_name":"å¼ ä¸‰","can_delete":false,"product_type":"c1","uid":1004092,"ip_address":"","ucode":"1155528FAE1546","user_header":"https://static001.geekbang.org/account/avatar/00/0f/52/3c/d6fcb93a.jpg","comment_is_top":false,"comment_ctime":1555723269,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"10145657861","product_id":100023901,"comment_content":"æ‰“å¡ã€‚æ„Ÿè§‰å¾ˆç¥å¥‡ï¼Œä¹‹å‰å®Œå…¨ä¸ä¼šç”¨ã€‚å­¦çš„çŸ¥è¯†å¤ªé™ˆæ—§äº†ï¼Œç»§ç»­å­¦ä¹ ã€‚","like_count":2},{"had_liked":false,"id":337323,"user_name":"Geek_96a4cb","can_delete":false,"product_type":"c1","uid":2369218,"ip_address":"","ucode":"29A0118BBBAEB7","user_header":"","comment_is_top":false,"comment_ctime":1646754353,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"5941721649","product_id":100023901,"comment_content":"è¯¾åæ€è€ƒé¢˜:<br>Executor executor = Executors.newFixedThreadPool(3);<br>executor.submit(()-&gt;save(getPriceByS1()));<br>executor.submit(()-&gt;save(getPriceByS2()));<br>executor.submit(()-&gt;save(getPriceByS3()));","like_count":1},{"had_liked":false,"id":270897,"user_name":"Joker","can_delete":false,"product_type":"c1","uid":1156592,"ip_address":"","ucode":"126AF848001A1E","user_header":"https://static001.geekbang.org/account/avatar/00/11/a5/f0/8648c464.jpg","comment_is_top":false,"comment_ctime":1609314364,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"5904281660","product_id":100023901,"comment_content":"å¦‚åªæœ‰ä¸€ä¸ªäººæ¥æ“ä½œçš„è¯ï¼Œé‚£ä¹ˆæ´—èŒ¶å£¶å’Œæ´—æ°´å£¶å’Œæ´—æ°´æ¯ä¸€å®šæ˜¯ä¼šæœ‰å…ˆåé¡ºåºçš„ï¼Œä¸€æ¬¡åªèƒ½ç³»ä¸€ä¸ªå£¶ï¼Œé‚£ä¹ˆâ€œæ´—èŒ¶å£¶ã€æ´—èŒ¶æ¯ã€æ‹¿èŒ¶å¶â€è¿™ä¸ªæ­¥éª¤åªèƒ½åœ¨çƒ§æ°´ä¹‹åæ‰§è¡Œï¼Œè¿™æ ·ï¼Œæ‰æ˜¯ä¸€ä¸ªäººçš„æ‰§è¡Œæ­¥éª¤å§ã€‚ä»£ç ç±»ä¼¼è¿™æ ·ï¼š<br>```java<br>public static void main(String[] args) {<br>        CountDownLatch latch = new CountDownLatch(1);<br>        FutureTask&lt;String&gt; fetchTea = new FutureTask&lt;&gt;(() -&gt; {<br>            latch.await();<br>            System.out.println(&quot;æ´—èŒ¶å£¶&quot;);<br>            Thread.sleep(100L);<br>            System.out.println(&quot;æ´—èŒ¶æ¯&quot;);<br>            Thread.sleep(200L);<br>            System.out.println(&quot;æ‹¿èŒ¶å¶&quot;);<br>            Thread.sleep(100L);<br>            return &quot;å¤§çº¢è¢&quot;;<br>        });<br><br><br>        FutureTask&lt;String&gt; boilWater = new FutureTask&lt;&gt;(() -&gt; {<br>            System.out.println(&quot;wash kettle&quot;);<br>            Thread.sleep(100L);<br>            System.out.println(&quot;boil water&quot;);<br>            latch.countDown();<br>            Thread.sleep(1500L);<br>            return &quot;æ°´å¼€äº†, today take tea: &quot;;<br>        });<br><br><br>        ThreadFactory tf = new ThreadFactoryBuilder().setNameFormat(&quot;brilliant wang make tea&quot;).build();<br><br>        int numOfProcessors = Runtime.getRuntime().availableProcessors();<br><br>        ThreadPoolExecutor tpe = new ThreadPoolExecutor(numOfProcessors,<br>                numOfProcessors * 2 + 1,<br>                10,<br>                TimeUnit.SECONDS,<br>                new ArrayBlockingQueue&lt;&gt;(100),<br>                tf);<br>        tpe.submit(fetchTea);<br>        tpe.submit(boilWater);<br>        try {<br>            String water = boilWater.get(10, TimeUnit.SECONDS);<br>            String tea = fetchTea.get(10, TimeUnit.SECONDS);<br>            System.out.println(water + tea);<br>        } catch (InterruptedException ig) {<br>        } catch (ExecutionException ig) {<br>        } catch (TimeoutException ig) {<br>        }<br>    }<br>````","like_count":1},{"had_liked":false,"id":253043,"user_name":"near","can_delete":false,"product_type":"c1","uid":1870563,"ip_address":"","ucode":"09DE24BAEA38A6","user_header":"https://static001.geekbang.org/account/avatar/00/1c/8a/e3/c967e11a.jpg","comment_is_top":false,"comment_ctime":1602576920,"is_pvip":false,"replies":[{"id":"92787","content":"T2ä¼šå›æ”¶ï¼ŒT1çŠ¶æ€æ˜¯é˜»å¡","user_name":"ä½œè€…å›å¤","user_name_real":"ç‹å®ä»¤","uid":"1269969","ctime":1603069487,"ip_address":"","comment_id":253043,"utype":1}],"discussion_count":1,"race_medal":0,"score":"5897544216","product_id":100023901,"comment_content":"è€å¸ˆï¼Œæœ‰é—®é¢˜é—®ä¸€ä¸‹ï¼š1.åœ¨æ³¡èŒ¶çš„ä¾‹å­ä¸­ï¼Œå¦‚æœä½¿ç”¨çº¿ç¨‹æ± åˆ›å»ºçº¿ç¨‹ï¼Œå‡è®¾æœ‰å¾ˆå¤šä¸ªæ³¡èŒ¶ä»»åŠ¡éƒ½è¦åå¤è°ƒç”¨çº¿ç¨‹æ± ä¸­çš„çº¿ç¨‹ï¼Œé‚£ä¹ˆåœ¨T2æå‰å®Œæˆä»»åŠ¡ï¼ŒT1è·å–T2çš„ç»“æœå‰ï¼ŒT2è¿™ä¸ªçº¿ç¨‹ä¼šä¸ä¼šè¢«çº¿ç¨‹æ± å›æ”¶ï¼Ÿ2.å‡è®¾T1åœ¨T2å‰å®Œæˆï¼Œå½“T1è¦è·å–T2ç»“æœæ—¶ï¼ŒT1ä¸­çš„ä»£ç æ˜¯é˜»å¡çš„çŠ¶æ€å—ï¼Ÿ","like_count":1,"discussions":[{"author":{"id":1269969,"avatar":"https://static001.geekbang.org/account/avatar/00/13/60/d1/8efa89ab.jpg","nickname":"ç‹å®ä»¤","note":"","ucode":"4FE19F5BC32FCA","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":506954,"discussion_content":"T2ä¼šå›æ”¶ï¼ŒT1çŠ¶æ€æ˜¯é˜»å¡","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1603069487,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":203246,"user_name":"å¥³å·«åœ¨å¯’æ±Ÿ","can_delete":false,"product_type":"c1","uid":1013180,"ip_address":"","ucode":"B3707072224C1C","user_header":"https://static001.geekbang.org/account/avatar/00/0f/75/bc/664bbdf7.jpg","comment_is_top":false,"comment_ctime":1586160239,"is_pvip":true,"discussion_count":0,"race_medal":0,"score":"5881127535","product_id":100023901,"comment_content":"\t\tExecutorService executor = Executors.newFixedThreadPool(3);<br><br>\t\texecutor.submit(new Task1());<br>\t\texecutor.submit(new Task2());<br>\t\texecutor.submit(new Task3());<br>\t\t<br>\t\tclass Task1  implement Runnable {<br>\t\t\tvoid run(){<br>\t\t\t\tr = getPriceByS1();<br>\t\t\t\tsave(r);<br>\t\t\t}<br>\t\t}<br>\t\t<br>\t\tclass Task2  implement Runnable {<br>\t\t\tvoid run(){<br>\t\t\t\tr = getPriceByS2();<br>\t\t\t\tsave(r);<br>\t\t\t}<br>\t\t}<br>\t\t<br>\t\tclass Task3  implement Runnable {<br>\t\t\tvoid run(){<br>\t\t\t\tr = getPriceByS3();<br>\t\t\t\tsave(r);<br>\t\t\t}<br>\t\t}","like_count":1},{"had_liked":false,"id":194471,"user_name":"Mr.wang","can_delete":false,"product_type":"c1","uid":1224805,"ip_address":"","ucode":"86F341A5316BBC","user_header":"https://static001.geekbang.org/account/avatar/00/12/b0/65/90387745.jpg","comment_is_top":false,"comment_ctime":1585061297,"is_pvip":false,"discussion_count":0,"race_medal":1,"score":"5880028593","product_id":100023901,"comment_content":"æŠŠä¸‰ä¸ªè¯¢é—®åˆ†åˆ«æœ‰ä¸‰ä¸ªçº¿ç¨‹è¿è¡Œï¼Œæœ€åæ‰¹é‡æ’å…¥æ•°æ®åº“ã€‚","like_count":1},{"had_liked":false,"id":89285,"user_name":"liu","can_delete":false,"product_type":"c1","uid":1109402,"ip_address":"","ucode":"041F179BB00A59","user_header":"https://static001.geekbang.org/account/avatar/00/10/ed/9a/bbeec5bb.jpg","comment_is_top":false,"comment_ctime":1556149074,"is_pvip":true,"discussion_count":0,"race_medal":0,"score":"5851116370","product_id":100023901,"comment_content":"futureæ˜¯é˜»å¡çš„ç­‰å¾…ã€‚å‘èµ·ä»»åŠ¡åï¼Œåšå…¶ä»–çš„å·¥ä½œã€‚åšå®Œåï¼Œä»futureè·å–å¤„ç†ç»“æœï¼Œç»§ç»­è¿›è¡Œåé¢çš„ä»»åŠ¡","like_count":1},{"had_liked":false,"id":87926,"user_name":"QQæ€ª","can_delete":false,"product_type":"c1","uid":1211223,"ip_address":"","ucode":"1A39B8433D9208","user_header":"https://static001.geekbang.org/account/avatar/00/12/7b/57/a9b04544.jpg","comment_is_top":false,"comment_ctime":1555755284,"is_pvip":false,"replies":[{"id":"31622","content":"ä»»æ„çš„ä¸œè¥¿ï¼Œæƒ³æˆæ•°å­—0ä¹Ÿè¡Œ","user_name":"ä½œè€…å›å¤","user_name_real":"ç‹å®ä»¤","uid":"1269969","ctime":1555768974,"ip_address":"","comment_id":87926,"utype":1}],"discussion_count":1,"race_medal":0,"score":"5850722580","product_id":100023901,"comment_content":"è€å¸ˆï¼Œåœ¨æäº¤ Runnable ä»»åŠ¡åŠç»“æœå¼•ç”¨çš„ä¾‹å­é‡Œé¢çš„xå˜é‡æ˜¯ä»€ä¹ˆ?","like_count":1,"discussions":[{"author":{"id":1269969,"avatar":"https://static001.geekbang.org/account/avatar/00/13/60/d1/8efa89ab.jpg","nickname":"ç‹å®ä»¤","note":"","ucode":"4FE19F5BC32FCA","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":447650,"discussion_content":"ä»»æ„çš„ä¸œè¥¿ï¼Œæƒ³æˆæ•°å­—0ä¹Ÿè¡Œ","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1555768974,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":349727,"user_name":"freesocean","can_delete":false,"product_type":"c1","uid":1529210,"ip_address":"","ucode":"CAD4C80CF569D3","user_header":"https://static001.geekbang.org/account/avatar/00/17/55/7a/d44df1d6.jpg","comment_is_top":false,"comment_ctime":1656289113,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1656289113","product_id":100023901,"comment_content":"&#47;&#47;taskä¸­sleep1ç§’ <br>&#47;&#47;ä¸²è¡Œå¤„ç†<br>    static void M1() throws InterruptedException {<br>        long start = System.currentTimeMillis();<br>        &#47;&#47; å‘ç”µå•†S1è¯¢ä»·ï¼Œå¹¶ä¿å­˜<br>        int r1 = getPriceByS1();<br>        save(r1);<br>        &#47;&#47; å‘ç”µå•†S2è¯¢ä»·ï¼Œå¹¶ä¿å­˜<br>        int r2 = getPriceByS2();<br>        save(r2);<br>        &#47;&#47; å‘ç”µå•†S3è¯¢ä»·ï¼Œå¹¶ä¿å­˜<br>        int r3 = getPriceByS3();<br>        save(r3);<br>        long end = System.currentTimeMillis();<br>        &#47;&#47;ç”¨æ—¶ï¼š3005<br>        System.out.println(&quot;time:&quot; + (end - start));<br>    }<br><br>    static void M2() throws ExecutionException, InterruptedException {<br>        long start = System.currentTimeMillis();<br>        &#47;&#47;ä¼˜åŒ–<br>        ExecutorService executorService = Executors.newFixedThreadPool(3);<br>        Future&lt;Integer&gt; r11 = executorService.submit(new Task1());<br>        Future&lt;Integer&gt; r12 = executorService.submit(new Task2());<br>        Future&lt;Integer&gt; r13 = executorService.submit(new Task3());<br><br>        save(r11.get());<br>        save(r12.get());<br>        save(r13.get());<br>        long end = System.currentTimeMillis();<br>        &#47;&#47;ç”¨æ—¶ï¼š1015<br>        System.out.println(&quot;time:&quot; + (end - start));<br>    }<br>","like_count":0},{"had_liked":false,"id":348061,"user_name":"è°¦è°¦","can_delete":false,"product_type":"c1","uid":1029511,"ip_address":"","ucode":"6EBF5F3A158FCA","user_header":"https://static001.geekbang.org/account/avatar/00/0f/b5/87/c8cc2659.jpg","comment_is_top":false,"comment_ctime":1654697279,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1654697279","product_id":100023901,"comment_content":"&#47;&#47;é‡‡è´­å‘˜ï¼›è´Ÿè´£è¯¢ä»·<br>public class Buyer implements Runnable {<br><br>  private CopyOnWriteArrayList&lt;Integer&gt; prices;<br>  <br>  private CyclicBarrier cyclicBarrier;<br>  <br>  public Buyer(CopyOnWriteArrayList&lt;Integer&gt; prices,CyclicBarrier cyclicBarrier) {<br>    this.prices = prices;<br>    this.cyclicBarrier = cyclicBarrier;<br>  }<br><br>  @Override<br>  public void run() {<br>    Integer price = (int)(new Random().nextDouble()*100);<br>    <br>    System.out.println(&quot;é‡‡è´­å‘˜&quot;+Thread.currentThread().getId()+&quot;çš„è¯¢ä»·ç»“æœæ˜¯ï¼š&quot;+price);<br>    <br>    prices.add(price);<br>    <br>    cyclicBarrier.await();<br><br>  }<br><br>}<br><br>&#47;&#47;éƒ¨é—¨ç»ç†ï¼Œè´Ÿè´£ä¿å­˜è¯¢ä»·å¹¶è¿”å›æŠ¥ä»·å•<br>public class Manager implements Callable&lt;String&gt;{<br><br>  private CopyOnWriteArrayList&lt;Integer&gt; prices;<br>  <br><br>  public Manager(CopyOnWriteArrayList&lt;Integer&gt; prices) {<br>    this.prices = prices;<br>  }<br><br>  @Override<br>  public String call() throws Exception {<br>    <br>    &#47;&#47;savePrice(price);<br>    <br>    &#47;&#47;è¿”å›ä¸€ä¸ªæŠ¥ä»·å•ã€‚<br>    return report(prices);<br>  }<br>  <br>}<br><br>&#47;&#47;ä¸»ç±»<br>public class PriceDemo {<br>  public static void main(String[] args) throws InterruptedException, ExecutionException {<br><br>    int buyerCounts = 3;<br><br>    ExecutorService executor= Executors.newFixedThreadPool(buyerCounts);<br>    <br>    CopyOnWriteArrayList&lt;Integer&gt; prices = new CopyOnWriteArrayList&lt;Integer&gt;();<br>    <br>    CyclicBarrier cyclicBarrier = new CyclicBarrier(buyerCounts, ()-&gt;{<br>      &#47;&#47;æ‰€æœ‰é‡‡è´­å‘˜è¯¢ä»·ç»“æŸä¹‹åï¼Œéƒ¨é—¨ç»ç†ä¿å­˜è¯¢ä»·å¹¶è¿”å›ä¸€ä»½æŠ¥ä»·å•ã€‚<br>      FutureTask&lt;String&gt; managerFutureTask = new FutureTask&lt;String&gt;(new Manager(prices));<br>      new Thread(managerFutureTask).start();<br>      <br>      try {<br>        String report = managerFutureTask.get();<br>        System.out.println(report);      <br>      } catch (InterruptedException | ExecutionException e) {<br>        e.printStackTrace();<br>      }<br>    });<br>    <br>    for(int i=0;i&lt;buyerCounts;i++) {<br>      executor.submit(new Buyer(prices,cyclicBarrier), prices);<br>    }<br>    <br>  }<br>}","like_count":0},{"had_liked":false,"id":345949,"user_name":"å­¦ä¹ å­¦ä¸ªå±","can_delete":false,"product_type":"c1","uid":1049017,"ip_address":"","ucode":"DF2D61E6FB2FCE","user_header":"https://static001.geekbang.org/account/avatar/00/10/01/b9/73435279.jpg","comment_is_top":false,"comment_ctime":1652710809,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1652710809","product_id":100023901,"comment_content":"1 ä¸‰ä¸ªå¯ä»¥å¼‚æ­¥æ‰§è¡Œ<br>2 åˆ©ç”¨countdownlact è®¡æ•° ä¸‰ä¸ªçº¿ç¨‹(orçº¿ç¨‹æ± )å»å¤„ç†<br>3 ä½¿ç”¨CompletableFutureå»å¤„ç†","like_count":1},{"had_liked":false,"id":340134,"user_name":"åŒ—æçš„å¤§ä¼é¹…","can_delete":false,"product_type":"c1","uid":1045577,"ip_address":"","ucode":"8935346D08E109","user_header":"https://static001.geekbang.org/account/avatar/00/0f/f4/49/2add4f6b.jpg","comment_is_top":false,"comment_ctime":1648621838,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1648621838","product_id":100023901,"comment_content":"åœ¨ç–«æƒ…æœŸé—´åšå…¬å¸çš„é¡¹ç›®ï¼Œæ¶‰åŠåˆ°äº†å¹¶å‘çš„ä¸‹å•å¤„ç†å’Œæ‰£å›åº“å­˜çš„å¤„ç†ï¼Œåœ¨æœ¬ç« èŠ‚æ”¶è·é¢‡å¤šï¼","like_count":0},{"had_liked":false,"id":327935,"user_name":"leo","can_delete":false,"product_type":"c1","uid":1073657,"ip_address":"","ucode":"614A2F77A6B553","user_header":"http://thirdwx.qlogo.cn/mmopen/vi_32/1mQHJjAyFjypbiaheQ9hDWRoictrVn2VggIZiaPLm50UiatHu9NqExMicScs9f7zYicbTQPliatTT18hr4csibRh4ARYbA/132","comment_is_top":false,"comment_ctime":1640400438,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1640400438","product_id":100023901,"comment_content":" ExecutorService executorService = null;<br>    try {<br>      executorService = Executors.newFixedThreadPool(3);<br>      CompletionService&lt;Integer&gt; completionService =<br>          new ExecutorCompletionService&lt;&gt;(executorService);<br>      completionService.submit(() -&gt; getPriceByS1());<br>      completionService.submit(() -&gt; getPriceByS2());<br>      completionService.submit(() -&gt; getPriceByS3());<br>      for (int i = 0; i &lt; 3; i++) {<br>        executorService.execute(<br>            () -&gt; {<br>              try {<br>                save(completionService.take().get());<br>              } catch (Exception e) {<br>                e.printStackTrace();<br>              }<br>            });<br>      }<br>    } catch (Exception e) {<br>      e.printStackTrace();<br>    } finally {<br>      if (executorService != null) {<br>        executorService.shutdown();<br>      }<br>    }","like_count":0},{"had_liked":false,"id":311074,"user_name":"Geek_31594d","can_delete":false,"product_type":"c1","uid":2030240,"ip_address":"","ucode":"9058787881CE82","user_header":"","comment_is_top":false,"comment_ctime":1631064412,"is_pvip":false,"replies":[{"id":"113113","content":"çš„ç¡®ä¸èƒ½é€‚ç”¨æ‰€æœ‰åœºæ™¯ï¼Œä¾‹å¦‚ä¸èƒ½ç”¨å®ƒå®ç°ç±»ä¼¼nettyè¿™ç§æ¡†æ¶","user_name":"ä½œè€…å›å¤","user_name_real":"ç‹å®ä»¤","uid":"1269969","ctime":1631663128,"ip_address":"","comment_id":311074,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1631064412","product_id":100023901,"comment_content":"è€å¸ˆï¼Œæœ‰ä¸ªä¸€ç›´æ¯”è¾ƒç–‘è™‘çš„åœ°æ–¹ï¼Œfuture.getè·å–è¿”å›å€¼æ˜¯å»é˜»å¡ï¼Œå¦‚æœgetä½¿ç”¨å¤ªå¤šï¼Œé‚£ä¹ˆé˜»å¡çš„åœ°æ–¹å°±ä¼šæ„Ÿè§‰æœ‰é—®é¢˜","like_count":0,"discussions":[{"author":{"id":1269969,"avatar":"https://static001.geekbang.org/account/avatar/00/13/60/d1/8efa89ab.jpg","nickname":"ç‹å®ä»¤","note":"","ucode":"4FE19F5BC32FCA","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":526462,"discussion_content":"çš„ç¡®ä¸èƒ½é€‚ç”¨æ‰€æœ‰åœºæ™¯ï¼Œä¾‹å¦‚ä¸èƒ½ç”¨å®ƒå®ç°ç±»ä¼¼nettyè¿™ç§æ¡†æ¶","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1631663128,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":292192,"user_name":"è½å¶é£é€çš„æ‹","can_delete":false,"product_type":"c1","uid":1046429,"ip_address":"","ucode":"F9A95DB28BCF1E","user_header":"https://static001.geekbang.org/account/avatar/00/0f/f7/9d/be04b331.jpg","comment_is_top":false,"comment_ctime":1620717544,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1620717544","product_id":100023901,"comment_content":"æˆ‘è§‰å¾—æœ€åä¸€é¢˜å®Œå…¨å¯ä»¥åšä¸‰ä¸ªä¸åŒåŠŸèƒ½æ¥å£ï¼Œä¸èƒ½ä¸ºäº†å¤šçº¿ç¨‹è€Œå¤šçº¿ç¨‹ã€‚å› ä¸ºä¸‰ä¸ªåˆæ²¡äº¤é›†ã€‚å„è‡ªå¤„ç†å¥½äº†ã€‚","like_count":0},{"had_liked":false,"id":275281,"user_name":"hello","can_delete":false,"product_type":"c1","uid":1649057,"ip_address":"","ucode":"4F42DAA5DB5C38","user_header":"https://static001.geekbang.org/account/avatar/00/19/29/a1/41607383.jpg","comment_is_top":false,"comment_ctime":1611423535,"is_pvip":true,"discussion_count":0,"race_medal":0,"score":"1611423535","product_id":100023901,"comment_content":"æ³¡èŒ¶çš„ä¾‹å­ï¼Œä¸Šé¢çš„è°ƒç”¨çº¿ç¨‹2çš„get() æ–¹æ³•ä¸æ˜¯åœ¨32è¡Œè°ƒç”¨çš„å—ï¼Œä¹Ÿå°±æ˜¯åœ¨â€œæ´—æ°´å£¶ï¼Œçƒ§å¼€æ°´â€ä¹‹åè°ƒç”¨çš„ï¼Œæ—¢ç„¶æ˜¯ä¸€ä¸ªé˜»å¡æ–¹æ³•ï¼Œæœ€åæ‰“å°çš„ç»“æœä¸ºä»€ä¹ˆä¸æ˜¯â€œæ´—æ°´å£¶....çƒ§å¼€æ°´...æ´—èŒ¶å£¶...â€è¿™æ ·çš„é¡ºåºå‘¢ï¼Œè€Œæ˜¯å¦‚ä¸Šçš„â€œæ´—æ°´å£¶...æ´—èŒ¶å£¶...çƒ§å¼€æ°´...â€ï¼Ÿ","like_count":0},{"had_liked":false,"id":274758,"user_name":"Bruce","can_delete":false,"product_type":"c1","uid":1106929,"ip_address":"","ucode":"B2F562F717BD3C","user_header":"https://static001.geekbang.org/account/avatar/00/10/e3/f1/346bd356.jpg","comment_is_top":false,"comment_ctime":1611149666,"is_pvip":false,"discussion_count":1,"race_medal":0,"score":"1611149666","product_id":100023901,"comment_content":"è€å¸ˆï¼Œçº¿ç¨‹æ± åŸåˆ™æ˜¯coreéƒ½åœ¨å¿™ç¢Œï¼Œç„¶åé˜Ÿåˆ—ä¹Ÿæ»¡äº†ï¼Œæ‰ä¼šæ–°å»ºçº¿ç¨‹ï¼Œç›´åˆ°maxå†æ‹’ç»ï¼Œä¸ºä»€ä¹ˆä¸æ˜¯å…ˆå»ºçº¿ç¨‹åˆ°maxåå¡é˜Ÿåˆ—ï¼Œé˜Ÿåˆ—æ»¡å†æ‹’ç»?","like_count":0,"discussions":[{"author":{"id":1439120,"avatar":"https://static001.geekbang.org/account/avatar/00/15/f5/90/e08bbe1f.jpg","nickname":"Wheres the Love?","note":"","ucode":"8851FB40976AB0","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":392917,"discussion_content":"çº¿ç¨‹æ˜¯å®è´µçš„ç³»ç»Ÿèµ„æºï¼Œèƒ½ä¸å»ºå°±ä¸å»º","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1631179063,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":269663,"user_name":"é£","can_delete":false,"product_type":"c1","uid":1077538,"ip_address":"","ucode":"104638BF19B048","user_header":"https://static001.geekbang.org/account/avatar/00/10/71/22/b8c596b6.jpg","comment_is_top":false,"comment_ctime":1608731095,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1608731095","product_id":100023901,"comment_content":"é¦–å…ˆå®šä¹‰ä¸€ä¸ªè¯¢ä»·æ¥å£ï¼Œå¦‚æœè¿™ä¸‰å®¶ä¾›åº”å•†çš„è¯¢ä»·é€»è¾‘ä¸ä¸€æ ·ï¼Œå°±åˆ†åˆ«å®ç°è¿™ä¸ªæ¥å£ï¼›æ¥ç€å®šä¹‰ä¸€ä¸ªè¯¢ä»·ç®¡ç†ç±»ï¼Œè¯¥ç±»åŒ…å«ä¸€ä¸ªç”¨æ¥æ‰§è¡Œè¯¢ä»·ä»»åŠ¡çš„çº¿ç¨‹æ± ï¼Œä¸€ä¸ªè¯¢ä»·ç»“æœé˜Ÿåˆ—ï¼Œå¦å¤–å¯åŠ¨ä¸€ä¸ªç”¨æ¥ä¿å­˜è¯¢ä»·ç»“æœï¼ˆå¯æ‰¹é‡ä¿å­˜ï¼‰çš„ç”¨æˆ·çº¿ç¨‹ï¼Œç®¡ç†ç±»æä¾›è¯¢ä»·æ–¹æ³•ï¼Œå‚æ•°å°±æ˜¯è¯¢ä»·æ¥å£çš„å®ç°å®ä¾‹ï¼Œè¯¢ä»·è¿”å›ç»“æœå…¥é˜Ÿåˆ—ï¼Œè¯¢ä»·ä¿å­˜çº¿ç¨‹ä¸€æ¬¡ä»é˜Ÿåˆ—ä¸­å–å‡ºä¸è¶…è¿‡æ‰¹é‡å¤„ç†ä¸Šé™çš„ç»“æœåšä¿å­˜","like_count":0},{"had_liked":false,"id":254621,"user_name":"ç››æƒ_vinc","can_delete":false,"product_type":"c1","uid":1459845,"ip_address":"","ucode":"4688DD06587CE2","user_header":"http://thirdwx.qlogo.cn/mmopen/vi_32/LPnuO9GleKEwso2rSbibmbEwn49hnGl9qTQDBv2xLOOWOflQsc9oVEEuZgNBt7TrqRKvk8CX7Tc8iakhEicBCCfFg/132","comment_is_top":false,"comment_ctime":1603159361,"is_pvip":false,"replies":[{"id":"92923","content":"&#47;&#47; ä¸€æ¬¡æ‰§è¡Œç»“æœè€Œå·²","user_name":"ä½œè€…å›å¤","user_name_real":"ç‹å®ä»¤","uid":"1269969","ctime":1603180206,"ip_address":"","comment_id":254621,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1603159361","product_id":100023901,"comment_content":"è€å¸ˆï¼Œä½ è¿™ä¸ªæ³¡èŒ¶ä¾‹å­ï¼Œçœ‹ä½ æœ€ç»ˆçš„æ‰§è¡Œç»“æœï¼Œæ´—æ°´å£¶å’Œæ´—èŒ¶å£¶å¹¶è¡Œäº†ï¼Œç„¶åæ‰å¼€å§‹çƒ§æ°´æ´—èŒ¶æ¯ï¼Œè¿™å¥½åƒæœ‰ç‚¹è¿èƒŒäº†æœ€ä¼˜åˆ†å·¥æ–¹æ¡ˆçš„å›¾å’Œç°å®ï¼Ÿ","like_count":0,"discussions":[{"author":{"id":1269969,"avatar":"https://static001.geekbang.org/account/avatar/00/13/60/d1/8efa89ab.jpg","nickname":"ç‹å®ä»¤","note":"","ucode":"4FE19F5BC32FCA","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":507459,"discussion_content":"// ä¸€æ¬¡æ‰§è¡Œç»“æœè€Œå·²","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1603180206,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":250945,"user_name":"PowerZZzzD","can_delete":false,"product_type":"c1","uid":1243035,"ip_address":"","ucode":"49109A6AB06EDD","user_header":"https://static001.geekbang.org/account/avatar/00/12/f7/9b/3b6e85a5.jpg","comment_is_top":false,"comment_ctime":1601287226,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1601287226","product_id":100023901,"comment_content":"æˆ‘ä¸æ˜¯å¾ˆç†è§£ t1 t2 start æ€ä¹ˆä¿è¯æ‰§è¡Œçš„é¡ºåºçš„","like_count":0},{"had_liked":false,"id":248031,"user_name":"fightingD","can_delete":false,"product_type":"c1","uid":1443637,"ip_address":"","ucode":"AD2876CED5D5AC","user_header":"http://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTKwViav94kcF50CxA0Jw7icicxociaVzut97iacy3b2ciacFqXuFWdiakVq304YcI8pt4HT5A1Yvp8EkYCpw/132","comment_is_top":false,"comment_ctime":1599987010,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1599987010","product_id":100023901,"comment_content":"åˆ›å»º3ä¸ªFutureTask ä»»åŠ¡ï¼Œåœ¨ä¸»çº¿ç¨‹ä¸­åˆ†åˆ«è°ƒç”¨get()æ–¹æ³•ï¼Œè·å–ä»»åŠ¡çš„æ‰§è¡Œç»“æœï¼Œç„¶åä¿å­˜åˆ°DBã€‚","like_count":0},{"had_liked":false,"id":238610,"user_name":"FIRE","can_delete":false,"product_type":"c1","uid":1670763,"ip_address":"","ucode":"85861D990FB3AB","user_header":"https://static001.geekbang.org/account/avatar/00/19/7e/6b/36fc4516.jpg","comment_is_top":false,"comment_ctime":1596212672,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1596212672","product_id":100023901,"comment_content":"public Future&lt;?&gt; submit(Runnable task) {<br>        if (task == null) throw new NullPointerException();<br>        RunnableFuture&lt;Void&gt; ftask = newTaskFor(task, null);<br>        execute(ftask);<br>        return ftask;<br>    }è¿™ä¸ªæœ€ç»ˆä¹Ÿæ˜¯è¿”å›äº†Future,åŒ…è£…äº†Runnableç±»åå†execute çš„","like_count":0},{"had_liked":false,"id":229550,"user_name":"M","can_delete":false,"product_type":"c1","uid":1810576,"ip_address":"","ucode":"06F26E1D62E9C9","user_header":"https://wx.qlogo.cn/mmopen/vi_32/eLNeJNaEkwGSK7xvtamMibVLMy2MpbIqX3iaEhT7JtSnTRMRTwZ2j4HX7WAapiashbiaBDVriaXKSP0Oeic6ZAEVEXag/132","comment_is_top":false,"comment_ctime":1593055923,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1593055923","product_id":100023901,"comment_content":"è¯¾åæ€è€ƒé¢˜ï¼š<br>æ€è·¯ä¸€ï¼šåˆ›å»ºä¸¤æ¡çº¿ç¨‹ï¼ŒT1çº¿ç¨‹å®Œæˆ å‘ç”µå•†S1è¯¢ä»·ã€å‘ç”µå•†S2è¯¢ä»·ã€å‘ç”µå•†S3è¯¢ä»·ï¼›T2çº¿ç¨‹å®Œæˆä¿å­˜S1ï¼Œä¿å­˜S2,ä¿å­˜S3<br>æ€è·¯äºŒï¼šåˆ›å»ºä¸‰æ¡çº¿ç¨‹ï¼ŒT1çº¿ç¨‹å®Œæˆ å‘ç”µå•†S1è¯¢ä»·ã€ä¿å­˜S1ï¼›T2çº¿ç¨‹å®Œæˆ å‘ç”µå•†S2è¯¢ä»·ã€ä¿å­˜S2ï¼›T3çº¿ç¨‹å®Œæˆ å‘ç”µå•†S3è¯¢ä»·ã€ä¿å­˜S3ã€‚<br>æ€è·¯ä¸‰ï¼šä½¿ç”¨é˜Ÿåˆ—è§£å†³ï¼Œè¿™ä¸ªä¸çŸ¥é“èƒ½ä¸èƒ½å®ç°ï¼Œæœ‰æ€è·¯çš„åŒå­¦ï¼Œå¸®å¿™æä¸ªæ€è·¯","like_count":0},{"had_liked":false,"id":221779,"user_name":"Î¾ï¼","can_delete":false,"product_type":"c1","uid":1636657,"ip_address":"","ucode":"F9797D21EBE10E","user_header":"https://static001.geekbang.org/account/avatar/00/18/f9/31/b75cc6d5.jpg","comment_is_top":false,"comment_ctime":1590590483,"is_pvip":false,"discussion_count":2,"race_medal":0,"score":"1590590483","product_id":100023901,"comment_content":"è€å¸ˆæœ‰ä¸ªé—®é¢˜æƒ³é—®æ‚¨ä¸€ä¸‹ï¼Œå¦‚æœåœ¨ä¸»çº¿ç¨‹å¼€å¯äº†ä¸€ä¸ªäº‹åŠ¡ï¼Œç„¶åä¸‹é¢æœ‰ä¸€äº›æ­¥éª¤åˆ†ç»™äº†å¾ˆå¤šçº¿ç¨‹å»åšï¼Œåœ¨ä¸»çº¿ç¨‹å¦‚æœæ‰§è¡Œå‡ºç°äº†å¼‚å¸¸æ€ä¹ˆå›æ»šå…¶ä»–æ‰€æœ‰çš„çº¿ç¨‹å•Š","like_count":1,"discussions":[{"author":{"id":2330905,"avatar":"https://static001.geekbang.org/account/avatar/00/23/91/19/6a3e7efc.jpg","nickname":"ç¨‹åºå‘˜9527","note":"","ucode":"1A1609F6BEAD84","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":381390,"discussion_content":"äº‹åŠ¡ä¸èƒ½è·¨çº¿ç¨‹çš„","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1625038581,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1636657,"avatar":"https://static001.geekbang.org/account/avatar/00/18/f9/31/b75cc6d5.jpg","nickname":"Î¾ï¼","note":"","ucode":"F9797D21EBE10E","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":275452,"discussion_content":"æˆ‘æƒ³åˆ°çš„æ–¹æ³•å°±åªæœ‰ç”¨ä¸¤ä¸ªcoutdownå’Œä¸€ä¸ªå…±äº«å˜é‡è§£å†³ï¼Œä¸çŸ¥é“è€å¸ˆæœ‰æ²¡æœ‰å·§ä¸€ç‚¹çš„æ–¹æ³•","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1590716516,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":211648,"user_name":"è§å—å±±","can_delete":false,"product_type":"c1","uid":1118111,"ip_address":"","ucode":"6A8BB82B7573CA","user_header":"https://static001.geekbang.org/account/avatar/00/11/0f/9f/f4b06bd5.jpg","comment_is_top":false,"comment_ctime":1587992401,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1587992401","product_id":100023901,"comment_content":"ç»™æœ€åé—®é¢˜å†åŠ ä¸€æ­¥ï¼Œè¯¢ä»·åï¼Œå¾—åˆ°æœ€å°çš„ä¸€å®¶ã€‚é¢˜å°±æ¯”è¾ƒå¥½äº†","like_count":0},{"had_liked":false,"id":199843,"user_name":"ğŸ˜œå“ˆå“ˆ","can_delete":false,"product_type":"c1","uid":1069001,"ip_address":"","ucode":"1FF58FB3A91135","user_header":"https://static001.geekbang.org/account/avatar/00/10/4f/c9/88837387.jpg","comment_is_top":false,"comment_ctime":1585496849,"is_pvip":true,"discussion_count":0,"race_medal":0,"score":"1585496849","product_id":100023901,"comment_content":"ç…ç…dubboæºç æ˜¯å¦‚ä½•ä½¿ç”¨futureæ¨¡å‹çš„","like_count":0},{"had_liked":false,"id":157262,"user_name":"æ˜¯æˆ‘ï¼","can_delete":false,"product_type":"c1","uid":1691331,"ip_address":"","ucode":"0B474014D620F4","user_header":"https://static001.geekbang.org/account/avatar/00/19/ce/c3/688b8bf9.jpg","comment_is_top":false,"comment_ctime":1575100245,"is_pvip":false,"replies":[{"id":"65380","content":"æˆ‘è§‰å¾—æœ‰é—®é¢˜ï¼Œsaveæ…¢ä¼šå½±å“äº†submit","user_name":"ä½œè€…å›å¤","user_name_real":"ç‹å®ä»¤","uid":"1269969","ctime":1578134041,"ip_address":"","comment_id":157262,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1575100245","product_id":100023901,"comment_content":"è€å¸ˆæ‚¨å¥½ï¼šè¯·é—®è¿™æ ·æ˜¯å¦æœ‰é—®é¢˜ï¼Ÿ  <br>public static void main(String[] args) throws Exception {<br>        FutureTask t1 = new FutureTask(new Callable() {<br>            @Override<br>            public String call() {<br>                return &quot;getPriceByS1()&quot;;<br>            }<br>        });<br>        FutureTask t2 = new FutureTask(() -&gt; &quot;getPriceByS2()&quot;);<br>        FutureTask t3 = new FutureTask(() -&gt; &quot;getPriceByS3()&quot;);<br>        BlockingQueue&lt;Runnable&gt; blockingQueue = new ArrayBlockingQueue&lt;&gt;(3);<br>        ThreadPoolExecutor poolExecutor =<br>                new ThreadPoolExecutor(10, 10, 10,<br>                        TimeUnit.SECONDS, blockingQueue);<br>        poolExecutor.submit(t1);<br>        save(t1.get().toString());<br>        poolExecutor.submit(t2);<br>        save(t2.get().toString());<br>        poolExecutor.submit(t3);<br>        save(t3.get().toString());<br>    }<br><br>    private static void save(String ss) {<br>        System.out.println(&quot;ä¿å­˜&quot; + ss);<br>    }","like_count":0,"discussions":[{"author":{"id":1269969,"avatar":"https://static001.geekbang.org/account/avatar/00/13/60/d1/8efa89ab.jpg","nickname":"ç‹å®ä»¤","note":"","ucode":"4FE19F5BC32FCA","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":476377,"discussion_content":"æˆ‘è§‰å¾—æœ‰é—®é¢˜ï¼Œsaveæ…¢ä¼šå½±å“äº†submit","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1578134041,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":147123,"user_name":"245864982","can_delete":false,"product_type":"c1","uid":1238485,"ip_address":"","ucode":"AC47075A95B759","user_header":"https://static001.geekbang.org/account/avatar/00/12/e5/d5/680402fd.jpg","comment_is_top":false,"comment_ctime":1572800068,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1572800068","product_id":100023901,"comment_content":"æ‰“å¡","like_count":0},{"had_liked":false,"id":131091,"user_name":"Demter","can_delete":false,"product_type":"c1","uid":1158439,"ip_address":"","ucode":"BE3B6F726916CE","user_header":"https://static001.geekbang.org/account/avatar/00/11/ad/27/5556ae50.jpg","comment_is_top":false,"comment_ctime":1567643332,"is_pvip":false,"discussion_count":1,"race_medal":0,"score":"1567643332","product_id":100023901,"comment_content":"æ—¢ç„¶futuretaskåªå®ç°runableæ¥å£ï¼Œé‚£ä¹ˆç”¨submitæ˜¯ä¸åº”è¯¥è·å–åˆ°è¿”å›å€¼çš„å‘€ï¼Ÿå•Š","like_count":0,"discussions":[{"author":{"id":1257422,"avatar":"https://static001.geekbang.org/account/avatar/00/13/2f/ce/c72d4c67.jpg","nickname":"movesan","note":"","ucode":"29CDF0F2B604C8","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":185381,"discussion_content":"FutureTask åªæ˜¯ä¸€ä¸ªå·¥å…·ç±»ï¼Œå…·ä½“ä»»åŠ¡æ˜¯å®ƒæ„é€ å‡½æ•°é‡Œçš„å‚æ•°ï¼Œæ˜¯å®ç°äº†Callable æ¥å£çš„ï¼›\nå¦å¤–é€šè¿‡ FutureTask å¯ä»¥ä¸ç”¨å˜é‡æ¥å— submit æ–¹æ³•ç»“æœï¼Œå¯ç›´æ¥ä» FutureTask å¯¹è±¡ä¸­è·å–ã€‚","likes_number":2,"is_delete":false,"is_hidden":false,"ctime":1582623310,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":125457,"user_name":"ç»™å¿ƒæ¥å—å†°å—","can_delete":false,"product_type":"c1","uid":1063689,"ip_address":"","ucode":"7AFB56581782A2","user_header":"https://static001.geekbang.org/account/avatar/00/10/3b/09/2cf074a7.jpg","comment_is_top":false,"comment_ctime":1566186791,"is_pvip":true,"discussion_count":2,"race_medal":0,"score":"1566186791","product_id":100023901,"comment_content":"è€å¸ˆï¼Œæˆ‘è‡ªå·±å†™äº†ä¸€ä¸ªdemoæ‰§è¡Œä¸€ç›´æ˜¯é˜»å¡çŠ¶æ€<br>package threadPoolTest;<br><br>import java.util.concurrent.*;<br><br>public class ExecutorTest {<br><br>    public static void main(String[] args) throws ExecutionException, InterruptedException, TimeoutException {<br>        &#47;&#47;è·å¾—ä¸€ä¸ªçº¿ç¨‹æ± <br>        ExecutorService service = Executors.newFixedThreadPool(1);<br>        Result result = new Result();<br>        result.setName(&quot;ç‹å&quot;);<br>        Future&lt;Result&gt; future = service.submit(new Task(result), result);<br><br>        if (future.isDone()) {<br>            Result result1 = future.get(10, TimeUnit.SECONDS);<br>            System.out.println(result == result1);<br>        }<br>    }<br>}<br>class Task implements Runnable {<br>    private Result result;<br>    public Task(Result result) {<br>        this.result = result;<br>    }<br>    &#47;&#47;TODO å¾ˆå¤šä¸šåŠ¡é€»è¾‘å¤„ç†æ–¹æ³•<br>    public void op1(String name) {<br><br>        if (&quot;ç‹å&quot;.equals(name)) {<br>            result.setAge(22);<br>        } else {<br>            result.setAge(20);<br>        }<br>    }<br>    @Override<br>    public void run() {<br>        op1(result.getName());<br>    }<br><br>    public Result getResult() {<br>        return result;<br>    }<br><br>    public void setResult(Result result) {<br>        this.result = result;<br>    }<br><br><br>}","like_count":0,"discussions":[{"author":{"id":1004342,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/53/36/2c449c71.jpg","nickname":"å¶ç‰æ—","note":"","ucode":"C72E88613DB992","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":58298,"discussion_content":"ä¹Ÿå¯ä»¥ å°† while (!future.isDone())  æ”¹ä¸º if  (!future.isDone()) ","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1574666608,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1004342,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/53/36/2c449c71.jpg","nickname":"å¶ç‰æ—","note":"","ucode":"C72E88613DB992","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":58297,"discussion_content":"ä»£ç éœ€è¦ä¿®æ”¹ä¸‹ï¼Œåœ¨åˆ¤æ–­ä»»åŠ¡æ˜¯å¦ç»“æŸï¼Œéœ€è¦å¾ªç¯ï¼Œä»£ç æˆ‘ç¨å¾®ä¿®æ”¹äº†\nwhile (!future.isDone()) {\n            Result result1 = future.get(10, TimeUnit.SECONDS);\n            System.out.println(result == result1);\n        }","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1574666538,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":118991,"user_name":"å°æ™º","can_delete":false,"product_type":"c1","uid":1191408,"ip_address":"","ucode":"2303BF533B9354","user_header":"http://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTIM05VW3moIQNWF85N5ZKjA2eld17BeMrL9sgKTb6WJZkDbfZX97pibSkRBd8UG0M3IrSFiafBsqkPw/132","comment_is_top":false,"comment_ctime":1564480985,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1564480985","product_id":100023901,"comment_content":"è€å¸ˆï¼Œæ˜¯ä¸æ˜¯ä¸¤ä¸ªçº¿ç¨‹å°±å¤Ÿäº†ï¼Œä¸€ä¸ªè¯¢ä»·ï¼Œä¸€ä¸ªä¿å­˜ã€‚","like_count":0},{"had_liked":false,"id":107325,"user_name":"çˆ±ä¸Šä¸˜æ¯”ç‰¹","can_delete":false,"product_type":"c1","uid":1235736,"ip_address":"","ucode":"399E3BF5F63515","user_header":"https://static001.geekbang.org/account/avatar/00/12/db/18/245f8558.jpg","comment_is_top":false,"comment_ctime":1561514673,"is_pvip":false,"replies":[{"id":"53898","content":"è¿™æ˜¯ä¸ªæœ€ä¼˜åŒ–é—®é¢˜ï¼Œå±äºæ•°å­¦é¢†åŸŸğŸ˜‚","user_name":"ä½œè€…å›å¤","user_name_real":"ç‹å®ä»¤","uid":"1269969","ctime":1570709480,"ip_address":"","comment_id":107325,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1561514673","product_id":100023901,"comment_content":"è€å¸ˆï¼Œæ—¢ç„¶getæ˜¯é˜»å¡æ–¹æ³•ï¼Œé‚£åº”è¯¥ä½•æ—¶è°ƒç”¨å‘¢ï¼Ÿæˆ–è€…è¯´åœ¨å“ªç§åœºæ™¯è°ƒç”¨é¿å…é˜»å¡ä¸»çº¿ç¨‹ï¼Ÿ","like_count":0,"discussions":[{"author":{"id":1269969,"avatar":"https://static001.geekbang.org/account/avatar/00/13/60/d1/8efa89ab.jpg","nickname":"ç‹å®ä»¤","note":"","ucode":"4FE19F5BC32FCA","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":455468,"discussion_content":"è¿™æ˜¯ä¸ªæœ€ä¼˜åŒ–é—®é¢˜ï¼Œå±äºæ•°å­¦é¢†åŸŸğŸ˜‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1570709480,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":100773,"user_name":"æ½­å·å¤ªå®ˆ","can_delete":false,"product_type":"c1","uid":1178824,"ip_address":"","ucode":"1DA953B8DCA3C0","user_header":"https://static001.geekbang.org/account/avatar/00/11/fc/c8/15c85ee4.jpg","comment_is_top":false,"comment_ctime":1559636022,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1559636022","product_id":100023901,"comment_content":"è€å¸ˆCompletableFuture.orTimeoutæ˜¯ä¸æ˜¯ä¸ä¼šé˜»å¡ä¸»çº¿ç¨‹","like_count":0},{"had_liked":false,"id":98687,"user_name":"xzy","can_delete":false,"product_type":"c1","uid":1002095,"ip_address":"","ucode":"1A44368083A19E","user_header":"https://static001.geekbang.org/account/avatar/00/0f/4a/6f/e36b3908.jpg","comment_is_top":false,"comment_ctime":1559057954,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1559057954","product_id":100023901,"comment_content":"public class ExecutorExample {<br><br>\tprivate static final ExecutorService executor = Executors.newFixedThreadPool(4);<br><br>\tpublic static void main(String[] args) {<br>\t\tFutureTask&lt;String&gt; st1 = new FutureTask&lt;&gt;(ExecutorExample::getPriceByS1);<br>\t\tFutureTask&lt;String&gt; st2 = new FutureTask&lt;&gt;(ExecutorExample::getPriceByS2);<br>\t\tFutureTask&lt;String&gt; st3 = new FutureTask&lt;&gt;(ExecutorExample::getPriceByS3);<br>\t\tRunnable saveTask = () -&gt; {<br>\t\t\tList&lt;FutureTask&lt;String&gt;&gt; list = new ArrayList&lt;FutureTask&lt;String&gt;&gt;() {{<br>\t\t\t\tadd(st1);<br>\t\t\t\tadd(st2);<br>\t\t\t\tadd(st3);<br>\t\t\t}};<br>\t\t\twhile (!list.isEmpty()) {<br>\t\t\t\tIterator&lt;FutureTask&lt;String&gt;&gt; it = list.iterator();<br>\t\t\t\twhile (it.hasNext()) {<br>\t\t\t\t\tFutureTask&lt;String&gt; ftask = it.next();<br>\t\t\t\t\tif (ftask.isDone()) {<br>\t\t\t\t\t\ttry {<br>\t\t\t\t\t\t\tsaveData(ftask.get());<br>\t\t\t\t\t\t\tit.remove();<br>\t\t\t\t\t\t} catch (InterruptedException e) {<br>\t\t\t\t\t\t\te.printStackTrace();<br>\t\t\t\t\t\t} catch (ExecutionException e) {<br>\t\t\t\t\t\t\te.printStackTrace();<br>\t\t\t\t\t\t}<br>\t\t\t\t\t}<br>\t\t\t\t}<br>\t\t\t}<br>\t\t};<br><br>\t\texecutor.submit(st1);<br>\t\texecutor.submit(st2);<br>\t\texecutor.submit(st3);<br>\t\texecutor.submit(saveTask);<br>\t\t<br>\t}<br><br>\tprivate static String getPriceByS1() {<br>\t\treturn &quot;fromDb1&quot;;<br>\t}<br><br>\tprivate static String getPriceByS2() {<br>\t\treturn &quot;fromDb2&quot;;<br>\t}<br><br>\tprivate static String getPriceByS3() {<br>\t\treturn &quot;fromDb3&quot;;<br>\t}<br><br>\tprivate static void saveData(String data) {<br>\t\t&#47;&#47;save data to db<br>\t\tSystem.out.println(&quot;save data &quot; + data);<br>\t}<br>}","like_count":0},{"had_liked":false,"id":89587,"user_name":"å³è€³å¬æµ·","can_delete":false,"product_type":"c1","uid":1022011,"ip_address":"","ucode":"E0B9F1083F4F98","user_header":"https://static001.geekbang.org/account/avatar/00/0f/98/3b/5af90c80.jpg","comment_is_top":false,"comment_ctime":1556228218,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1556228218","product_id":100023901,"comment_content":"å›ç­”æ€è€ƒï¼Œè¿™ä¸‰ä¸ªä»»åŠ¡å¦‚æœæ²¡æœ‰ç»“æœä¾èµ–ï¼Œç›´æ¥ç”¨çº¿ç¨‹æ± æäº¤ä¸‰ä¸ªä»»åŠ¡åº”è¯¥å°±å¯ä»¥å¹¶è¡Œäº†å§","like_count":1},{"had_liked":false,"id":89127,"user_name":"Cancer","can_delete":false,"product_type":"c1","uid":1128051,"ip_address":"","ucode":"DF44879B27760C","user_header":"https://static001.geekbang.org/account/avatar/00/11/36/73/3a652c41.jpg","comment_is_top":false,"comment_ctime":1556085272,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1556085272","product_id":100023901,"comment_content":"\tstatic class S1QueryTask implements Callable&lt;Double&gt;{<br>\t\tpublic Double call() throws Exception {<br>\t\t\tThread.sleep(1000);&#47;&#47;æ¨¡æ‹ŸæŸ¥è¯¢æ—¶é—´<br>\t\t\treturn Double.valueOf(10f);<br>\t\t}<br>\t}<br>\tstatic class S2QueryTask implements Callable&lt;Double&gt;{<br>\t\tpublic Double call() throws Exception {<br>\t\t\tThread.sleep(2000);&#47;&#47;æ¨¡æ‹ŸæŸ¥è¯¢æ—¶é—´<br>\t\t\treturn Double.valueOf(20f);<br>\t\t}<br>\t}<br>\tstatic class S3QueryTask implements Callable&lt;Double&gt;{<br>\t\tpublic Double call() throws Exception {<br>\t\t\tThread.sleep(3000);&#47;&#47;æ¨¡æ‹ŸæŸ¥è¯¢æ—¶é—´<br>\t\t\treturn Double.valueOf(30f);<br>\t\t}<br>\t}<br>\tstatic class SaveTask implements Callable&lt;Double&gt;{<br>\t\tfinal FutureTask&lt;Double&gt;[] queryfts;<br>\t\tprivate SaveTask(FutureTask&lt;Double&gt;[] queryfts) {<br>\t\t\tthis.queryfts = queryfts;<br>\t\t}<br>\t\tprivate Double save(Double combRst) throws InterruptedException{<br>\t\t\tThread.sleep(500);&#47;&#47;æ¨¡æ‹Ÿä¿å­˜æ—¶é—´<br>\t\t\treturn combRst;<br>\t\t}<br>\t\tpublic Double call() throws Exception {<br>\t\t\tDouble combRst = new Double(0f);<br>\t\t\tfor(FutureTask&lt;Double&gt; queryft : queryfts) {<br>\t\t\t\tDouble rst = queryft.get();<br>\t\t\t\tif(rst != null) {<br>\t\t\t\t\tcombRst += rst;<br>\t\t\t\t}<br>\t\t\t}<br>\t\t\treturn save(combRst);<br>\t\t}<br>\t}<br>\tpublic static void main(String[] args) {<br>\t\tFutureTask&lt;Double&gt;[] queryfts = new FutureTask[] {new FutureTask&lt;Double&gt;(new S1QueryTask()),new FutureTask&lt;Double&gt;(new S2QueryTask()),new FutureTask&lt;Double&gt;(new S3QueryTask())};<br>\t\tFutureTask&lt;Double&gt; saveft3 = new FutureTask&lt;Double&gt;(new SaveTask(queryfts));<br>\t\tExecutorService executor = Executors.newFixedThreadPool(4);<br>\t\tlong start = System.currentTimeMillis();<br>\t\tfor(FutureTask&lt;Double&gt; queryft : queryfts) {<br>\t\t\texecutor.submit(queryft);<br>\t\t}<br>\t\texecutor.submit(saveft3);<br>\t\ttry {<br>\t\t\tDouble combRst = saveft3.get();<br>\t\t\tlong end = System.currentTimeMillis();<br>\t\t\tif(combRst != null) {<br>\t\t\t\tSystem.out.println(&quot;ä¿å­˜æˆåŠŸ,åˆå¹¶ç»“æœï¼š&quot; + combRst);<br>\t\t\t}else {<br>\t\t\t\tSystem.out.println(&quot;ä¿å­˜å¤±è´¥&quot;);<br>\t\t\t}<br>\t\t\tSystem.out.println(&quot;è€—æ—¶ï¼š&quot; + (end - start) + &quot;ms&quot;);<br>\t\t} catch (InterruptedException e) {<br>\t\t\t&#47;&#47;æŒ‰éœ€å¤„ç†<br>\t\t} catch (ExecutionException e) {<br>\t\t\t&#47;&#47;æŒ‰éœ€å¤„ç†<br>\t\t} catch (TimeoutException e) {<br>\t\t\t&#47;&#47;æŒ‰éœ€å¤„ç†<br>\t\t}finally {<br>\t\t\texecutor.shutdown();<br>\t\t}<br>\t}","like_count":0},{"had_liked":false,"id":88599,"user_name":"jeeker","can_delete":false,"product_type":"c1","uid":1444583,"ip_address":"","ucode":"1E78795E7DF8E7","user_header":"http://thirdwx.qlogo.cn/mmopen/vi_32/DYAIOgq83erS45sT36oSCibh8YMF9aD0IKltrdCoEicqUeEzbC2Hlr4UiahibfLvpib3LauzQxv6X3vyfCvrgz0m3dg/132","comment_is_top":false,"comment_ctime":1555950517,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1555950517","product_id":100023901,"comment_content":"è¯¾åé—®é¢˜: S2å’ŒS3åº”è¯¥å¼•ç”¨S1çš„ç»“æœå§,S2,3é€šè¿‡s1.getæ¥åšä¸šåŠ¡é€»è¾‘.","like_count":0},{"had_liked":false,"id":88158,"user_name":"å¼ å¾·","can_delete":false,"product_type":"c1","uid":1101929,"ip_address":"","ucode":"31FE63E8725EFC","user_header":"https://static001.geekbang.org/account/avatar/00/10/d0/69/5dbdc245.jpg","comment_is_top":false,"comment_ctime":1555860433,"is_pvip":false,"replies":[{"id":"31706","content":"å¦‚æœæ¯åˆ†é’Ÿè¯¢ä»·1ä¸‡æ¬¡ï¼Œè¿˜èƒ½ç›´æ¥åˆ›å»ºçº¿ç¨‹å—ï¼Ÿè”ç³»æŒ‡çš„æ˜¯çº¿ç¨‹æ± å’Œfutureï¼Œä¸æ˜¯ä¸‰ä¸ªæŸ¥è¯¢æ“ä½œ<br>","user_name":"ä½œè€…å›å¤","user_name_real":"ç‹å®ä»¤","uid":"1269969","ctime":1555892543,"ip_address":"","comment_id":88158,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1555860433","product_id":100023901,"comment_content":"æˆ‘ä¹ŸåŒæ„å¼ å¤©å±¹åŒå­¦çš„è§‚ç‚¹   è¿™ä¸ªè¯¢ä»·æ“ä½œå¦‚æœä¹‹é—´æ²¡æœ‰è”ç³»çš„è¯  ç›´æ¥èµ·ä¸‰ä¸ªçº¿ç¨‹å°±å¯ä»¥äº† è€å¸ˆèƒ½ä¸èƒ½è®²ä¸€ä¸‹ ç”¨çº¿ç¨‹æ± æ€ä¹ˆå°±æœ‰å…³è”äº†ï¼Ÿ","like_count":1,"discussions":[{"author":{"id":1269969,"avatar":"https://static001.geekbang.org/account/avatar/00/13/60/d1/8efa89ab.jpg","nickname":"ç‹å®ä»¤","note":"","ucode":"4FE19F5BC32FCA","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":447751,"discussion_content":"å¦‚æœæ¯åˆ†é’Ÿè¯¢ä»·1ä¸‡æ¬¡ï¼Œè¿˜èƒ½ç›´æ¥åˆ›å»ºçº¿ç¨‹å—ï¼Ÿè”ç³»æŒ‡çš„æ˜¯çº¿ç¨‹æ± å’Œfutureï¼Œä¸æ˜¯ä¸‰ä¸ªæŸ¥è¯¢æ“ä½œ\n","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1555892543,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":87991,"user_name":"æé±¼çš„æ¬ç –å¥‡","can_delete":false,"product_type":"c1","uid":1021539,"ip_address":"","ucode":"2FD194C4DA26E5","user_header":"https://static001.geekbang.org/account/avatar/00/0f/96/63/7eb32c9b.jpg","comment_is_top":false,"comment_ctime":1555786098,"is_pvip":false,"discussion_count":2,"race_medal":0,"score":"1555786098","product_id":100023901,"comment_content":"è€å¸ˆä¸ºä»€ä¹ˆæˆ‘ä¸‹é¢å†™æ³•t2Task.get(); ä¸€ç›´åœ¨ç­‰å¾…<br>public class PaoCha {<br><br>    public static class T1Task implements Runnable{<br>        private Future&lt;T2Task&gt; t2Task;<br>        T1Task(Future&lt;T2Task&gt; t2Task) {<br>            this.t2Task = t2Task;<br>        }<br>        @Override<br>        public void run() {<br>            try {<br>                System.out.println( &quot;T1:æ´—æ°´å£¶&quot;);<br>                TimeUnit.SECONDS.sleep(1);<br>                System.out.println( &quot;T1:çƒ§å¼€æ°´&quot;);<br>                TimeUnit.SECONDS.sleep(15);<br>                t2Task.get();<br>                System.out.println( &quot;T1:æ‹¿åˆ°èŒ¶å¶&quot;);<br><br>                System.out.println( &quot;T1:æ³¡èŒ¶&quot;);<br>                System.out.println( &quot;ä¸ŠèŒ¶&quot;);<br>            } catch (InterruptedException e) {<br>                e.printStackTrace();<br>            } catch (ExecutionException e) {<br>                e.printStackTrace();<br>            }<br><br>        }<br>    }<br>    public static  class T2Task implements Runnable {<br><br>        @Override<br>        public void run() {<br>            try {<br>                System.out.println( &quot;T2:æ´—èŒ¶å£¶&quot;);<br>                TimeUnit.SECONDS.sleep(1);<br>                System.out.println( &quot;T2:æ´—èŒ¶æ¯&quot;);<br>                TimeUnit.SECONDS.sleep(2);<br>                System.out.println( &quot;T2:æ‹¿èŒ¶å¶&quot;);<br>                TimeUnit.SECONDS.sleep(1);<br>                System.out.println( &quot;T2:é¾™äº•&quot;);<br>            } catch (InterruptedException e) {<br>                e.printStackTrace();<br>            }<br>        }<br>    }<br><br>    public static void main(String[] args) {<br>        T2Task t2 = new T2Task();<br>        Future&lt;T2Task&gt; t2TaskFuture = new FutureTask&lt;&gt;(() -&gt;t2);<br>        ExecutorService executorService = Executors.newFixedThreadPool(1);<br>        executorService.submit(t2);<br><br>        T1Task t1 = new T1Task(t2TaskFuture);<br>        ExecutorService executorService1 = Executors.newFixedThreadPool(1);<br>        executorService1.submit(t1);<br><br>    }<br><br>}","like_count":0,"discussions":[{"author":{"id":1235692,"avatar":"https://static001.geekbang.org/account/avatar/00/12/da/ec/779c1a78.jpg","nickname":"å¾€äº‹éšé£ï¼Œé¡ºå…¶è‡ªç„¶","note":"","ucode":"F266EC6B143E38","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":41299,"discussion_content":"ä½ è¿™ä¸ªæ–¹æ³•æ²¡æœ‰è¿”å›å€¼","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1572396821,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1287860,"avatar":"http://thirdwx.qlogo.cn/mmopen/vi_32/VKUdRdM9ib6bBJ4xfKuPENHEno87IoSpxiaK3v47d3DdObnC7TuMo4AaDFhm0nDYziaicdsBShU6RSCOlLicZoxpTXw/132","nickname":"Geek_441338","note":"","ucode":"5557484E575244","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":32990,"discussion_content":"        T2Task t2 = new T2Task();\n        FutureTask<T2Task> t2TaskFuture = new FutureTask<>(t2, null);\n        ExecutorService executorService = Executors.newFixedThreadPool(1);\n        executorService.submit(t2TaskFuture);\n\n        T1Task t1 = new T1Task(t2TaskFuture);\n        FutureTask<T1Task> t1TaskFuture = new FutureTask<T1Task>(t1, null);\n        ExecutorService executorService1 = Executors.newFixedThreadPool(1);\n        executorService1.submit(t1TaskFuture);\n        \n        t1TaskFuture.get();","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1571069638,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":87827,"user_name":"zhangtnty","can_delete":false,"product_type":"c1","uid":1180553,"ip_address":"","ucode":"3C9A14BD7CF432","user_header":"https://static001.geekbang.org/account/avatar/00/12/03/89/e1621a01.jpg","comment_is_top":false,"comment_ctime":1555725689,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1555725689","product_id":100023901,"comment_content":"ç‹è€å¸ˆå¥½ï¼Œæ–‡ä¸­ä¸€é¢˜å¯ä»¥é€šè¿‡future.get()å­çº¿ç¨‹æ–¹å¼å®ç°ï¼Œè‡ªè¡Œåˆ›å»ºçº¿ç¨‹æˆ–åˆ›å»ºçº¿ç¨‹æ± éƒ½å¯ä»¥ï¼Œæ¯ä¸ªçº¿ç¨‹futureè‡ªå·±çš„ç»“æœï¼Œç„¶åä¿å­˜å³å¯ï¼Œå¦‚æœå‡ ä¸ªç»“æœæ²¡æœ‰å…³è”å¯ä»¥ä½¿ç”¨å¤šçº¿ç¨‹è·å¾—ç»“æœå¾ˆå®¹æ˜“å®ç°ã€‚<br>å¦‚æœå­˜åœ¨å…³ç³»ï¼Œæ¯”å¦‚ç«ä»·å–æœ€ä½ä»·æ ¼ï¼Œè¿™æ ·å¯èƒ½è¦å¤æ‚çš„å¤š(å°¤å…¶æ˜¯éœ€è¦é€‚æ—¶ç«ä»·è¿™ç§)ã€‚æˆ‘æƒ³åˆ°çš„æ˜¯ï¼šçº¿ç¨‹ä¸é˜»å¡ã€ç»“æœå…¥ç¼“å­˜ã€å¼‚æ­¥ä»»åŠ¡åˆ·æ–°ç¼“å­˜ç«ä»·ã€åŠ¨æ€å˜æ›´å‰æ®µå±•ç¤ºã€‚ä¹Ÿæƒ³é—®ä¸€ä¸‹ç‹è€å¸ˆï¼Œè¿˜æœ‰æ²¡æœ‰æ›´ä¼˜çš„æ–¹æ¡ˆï¼Œè°¢è°¢ï¼","like_count":0}]}