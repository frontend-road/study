{"id":84017,"title":"02 | Javaå†…å­˜æ¨¡å‹ï¼šçœ‹Javaå¦‚ä½•è§£å†³å¯è§æ€§å’Œæœ‰åºæ€§é—®é¢˜","content":"<p>ä¸Šä¸€æœŸæˆ‘ä»¬è®²åˆ°åœ¨å¹¶å‘åœºæ™¯ä¸­ï¼Œå› å¯è§æ€§ã€åŸå­æ€§ã€æœ‰åºæ€§å¯¼è‡´çš„é—®é¢˜å¸¸å¸¸ä¼šè¿èƒŒæˆ‘ä»¬çš„ç›´è§‰ï¼Œä»è€Œæˆä¸ºå¹¶å‘ç¼–ç¨‹çš„Bugä¹‹æºã€‚è¿™ä¸‰è€…åœ¨ç¼–ç¨‹é¢†åŸŸå±äºå…±æ€§é—®é¢˜ï¼Œæ‰€æœ‰çš„ç¼–ç¨‹è¯­è¨€éƒ½ä¼šé‡åˆ°ï¼ŒJavaåœ¨è¯ç”Ÿä¹‹åˆå°±æ”¯æŒå¤šçº¿ç¨‹ï¼Œè‡ªç„¶ä¹Ÿæœ‰é’ˆå¯¹è¿™ä¸‰è€…çš„æŠ€æœ¯æ–¹æ¡ˆï¼Œè€Œä¸”åœ¨ç¼–ç¨‹è¯­è¨€é¢†åŸŸå¤„äºé¢†å…ˆåœ°ä½ã€‚ç†è§£Javaè§£å†³å¹¶å‘é—®é¢˜çš„è§£å†³æ–¹æ¡ˆï¼Œå¯¹äºç†è§£å…¶ä»–è¯­è¨€çš„è§£å†³æ–¹æ¡ˆæœ‰è§¦ç±»æ—é€šçš„æ•ˆæœã€‚</p><p>é‚£æˆ‘ä»¬å°±å…ˆæ¥èŠèŠå¦‚ä½•è§£å†³å…¶ä¸­çš„å¯è§æ€§å’Œæœ‰åºæ€§å¯¼è‡´çš„é—®é¢˜ï¼Œè¿™ä¹Ÿå°±å¼•å‡ºæ¥äº†ä»Šå¤©çš„ä¸»è§’â€”â€”<strong>Javaå†…å­˜æ¨¡å‹</strong>ã€‚</p><p>Javaå†…å­˜æ¨¡å‹è¿™ä¸ªæ¦‚å¿µï¼Œåœ¨èŒåœºçš„å¾ˆå¤šé¢è¯•ä¸­éƒ½ä¼šè€ƒæ ¸åˆ°ï¼Œæ˜¯ä¸€ä¸ªçƒ­é—¨çš„è€ƒç‚¹ï¼Œä¹Ÿæ˜¯ä¸€ä¸ªäººå¹¶å‘æ°´å¹³çš„å…·ä½“ä½“ç°ã€‚åŸå› æ˜¯å½“å¹¶å‘ç¨‹åºå‡ºé—®é¢˜æ—¶ï¼Œéœ€è¦ä¸€è¡Œä¸€è¡Œåœ°æ£€æŸ¥ä»£ç ï¼Œè¿™ä¸ªæ—¶å€™ï¼Œåªæœ‰æŒæ¡Javaå†…å­˜æ¨¡å‹ï¼Œæ‰èƒ½æ…§çœ¼å¦‚ç‚¬åœ°å‘ç°é—®é¢˜ã€‚</p><h2>ä»€ä¹ˆæ˜¯Javaå†…å­˜æ¨¡å‹ï¼Ÿ</h2><p>ä½ å·²ç»çŸ¥é“ï¼Œå¯¼è‡´å¯è§æ€§çš„åŸå› æ˜¯ç¼“å­˜ï¼Œå¯¼è‡´æœ‰åºæ€§çš„åŸå› æ˜¯ç¼–è¯‘ä¼˜åŒ–ï¼Œé‚£è§£å†³å¯è§æ€§ã€æœ‰åºæ€§æœ€ç›´æ¥çš„åŠæ³•å°±æ˜¯<strong>ç¦ç”¨ç¼“å­˜å’Œç¼–è¯‘ä¼˜åŒ–</strong>ï¼Œä½†æ˜¯è¿™æ ·é—®é¢˜è™½ç„¶è§£å†³äº†ï¼Œæˆ‘ä»¬ç¨‹åºçš„æ€§èƒ½å¯å°±å ªå¿§äº†ã€‚</p><p>åˆç†çš„æ–¹æ¡ˆåº”è¯¥æ˜¯<strong>æŒ‰éœ€ç¦ç”¨ç¼“å­˜ä»¥åŠç¼–è¯‘ä¼˜åŒ–</strong>ã€‚é‚£ä¹ˆï¼Œå¦‚ä½•åšåˆ°â€œæŒ‰éœ€ç¦ç”¨â€å‘¢ï¼Ÿå¯¹äºå¹¶å‘ç¨‹åºï¼Œä½•æ—¶ç¦ç”¨ç¼“å­˜ä»¥åŠç¼–è¯‘ä¼˜åŒ–åªæœ‰ç¨‹åºå‘˜çŸ¥é“ï¼Œé‚£æ‰€è°“â€œæŒ‰éœ€ç¦ç”¨â€å…¶å®å°±æ˜¯æŒ‡æŒ‰ç…§ç¨‹åºå‘˜çš„è¦æ±‚æ¥ç¦ç”¨ã€‚æ‰€ä»¥ï¼Œä¸ºäº†è§£å†³å¯è§æ€§å’Œæœ‰åºæ€§é—®é¢˜ï¼Œåªéœ€è¦æä¾›ç»™ç¨‹åºå‘˜æŒ‰éœ€ç¦ç”¨ç¼“å­˜å’Œç¼–è¯‘ä¼˜åŒ–çš„æ–¹æ³•å³å¯ã€‚</p><!-- [[[read_end]]] --><p>Javaå†…å­˜æ¨¡å‹æ˜¯ä¸ªå¾ˆå¤æ‚çš„è§„èŒƒï¼Œå¯ä»¥ä»ä¸åŒçš„è§†è§’æ¥è§£è¯»ï¼Œç«™åœ¨æˆ‘ä»¬è¿™äº›ç¨‹åºå‘˜çš„è§†è§’ï¼Œæœ¬è´¨ä¸Šå¯ä»¥ç†è§£ä¸ºï¼ŒJavaå†…å­˜æ¨¡å‹è§„èŒƒäº†JVMå¦‚ä½•æä¾›æŒ‰éœ€ç¦ç”¨ç¼“å­˜å’Œç¼–è¯‘ä¼˜åŒ–çš„æ–¹æ³•ã€‚å…·ä½“æ¥è¯´ï¼Œè¿™äº›æ–¹æ³•åŒ…æ‹¬ <strong>volatile</strong>ã€<strong>synchronized</strong> å’Œ <strong>final </strong>ä¸‰ä¸ªå…³é”®å­—ï¼Œä»¥åŠå…­é¡¹ <strong>Happens-Before è§„åˆ™</strong>ï¼Œè¿™ä¹Ÿæ­£æ˜¯æœ¬æœŸçš„é‡ç‚¹å†…å®¹ã€‚</p><h2>ä½¿ç”¨volatileçš„å›°æƒ‘</h2><p>volatileå…³é”®å­—å¹¶ä¸æ˜¯Javaè¯­è¨€çš„ç‰¹äº§ï¼Œå¤è€çš„Cè¯­è¨€é‡Œä¹Ÿæœ‰ï¼Œå®ƒæœ€åŸå§‹çš„æ„ä¹‰å°±æ˜¯ç¦ç”¨CPUç¼“å­˜ã€‚</p><p>ä¾‹å¦‚ï¼Œæˆ‘ä»¬å£°æ˜ä¸€ä¸ªvolatileå˜é‡ <code>volatile int x = 0</code>ï¼Œå®ƒè¡¨è¾¾çš„æ˜¯ï¼šå‘Šè¯‰ç¼–è¯‘å™¨ï¼Œå¯¹è¿™ä¸ªå˜é‡çš„è¯»å†™ï¼Œä¸èƒ½ä½¿ç”¨CPUç¼“å­˜ï¼Œå¿…é¡»ä»å†…å­˜ä¸­è¯»å–æˆ–è€…å†™å…¥ã€‚è¿™ä¸ªè¯­ä¹‰çœ‹ä¸Šå»ç›¸å½“æ˜ç¡®ï¼Œä½†æ˜¯åœ¨å®é™…ä½¿ç”¨çš„æ—¶å€™å´ä¼šå¸¦æ¥å›°æƒ‘ã€‚</p><p>ä¾‹å¦‚ä¸‹é¢çš„ç¤ºä¾‹ä»£ç ï¼Œå‡è®¾çº¿ç¨‹Aæ‰§è¡Œwriter()æ–¹æ³•ï¼ŒæŒ‰ç…§ volatile è¯­ä¹‰ï¼Œä¼šæŠŠå˜é‡ â€œv=trueâ€ å†™å…¥å†…å­˜ï¼›å‡è®¾çº¿ç¨‹Bæ‰§è¡Œreader()æ–¹æ³•ï¼ŒåŒæ ·æŒ‰ç…§ volatile è¯­ä¹‰ï¼Œçº¿ç¨‹Bä¼šä»å†…å­˜ä¸­è¯»å–å˜é‡vï¼Œå¦‚æœçº¿ç¨‹Bçœ‹åˆ° â€œv == trueâ€ æ—¶ï¼Œé‚£ä¹ˆçº¿ç¨‹Bçœ‹åˆ°çš„å˜é‡xæ˜¯å¤šå°‘å‘¢ï¼Ÿ</p><p>ç›´è§‰ä¸Šçœ‹ï¼Œåº”è¯¥æ˜¯42ï¼Œé‚£å®é™…åº”è¯¥æ˜¯å¤šå°‘å‘¢ï¼Ÿè¿™ä¸ªè¦çœ‹Javaçš„ç‰ˆæœ¬ï¼Œå¦‚æœåœ¨ä½äº1.5ç‰ˆæœ¬ä¸Šè¿è¡Œï¼Œxå¯èƒ½æ˜¯42ï¼Œä¹Ÿæœ‰å¯èƒ½æ˜¯0ï¼›å¦‚æœåœ¨1.5ä»¥ä¸Šçš„ç‰ˆæœ¬ä¸Šè¿è¡Œï¼Œxå°±æ˜¯ç­‰äº42ã€‚</p><pre><code>// ä»¥ä¸‹ä»£ç æ¥æºäºã€å‚è€ƒ1ã€‘\nclass VolatileExample {\n  int x = 0;\n  volatile boolean v = false;\n  public void writer() {\n    x = 42;\n    v = true;\n  }\n  public void reader() {\n    if (v == true) {\n      // è¿™é‡Œxä¼šæ˜¯å¤šå°‘å‘¢ï¼Ÿ\n    }\n  }\n}\n</code></pre><p>åˆ†æä¸€ä¸‹ï¼Œä¸ºä»€ä¹ˆ1.5ä»¥å‰çš„ç‰ˆæœ¬ä¼šå‡ºç°x = 0çš„æƒ…å†µå‘¢ï¼Ÿæˆ‘ç›¸ä¿¡ä½ ä¸€å®šæƒ³åˆ°äº†ï¼Œå˜é‡xå¯èƒ½è¢«CPUç¼“å­˜è€Œå¯¼è‡´å¯è§æ€§é—®é¢˜ã€‚è¿™ä¸ªé—®é¢˜åœ¨1.5ç‰ˆæœ¬å·²ç»è¢«åœ†æ»¡è§£å†³äº†ã€‚Javaå†…å­˜æ¨¡å‹åœ¨1.5ç‰ˆæœ¬å¯¹volatileè¯­ä¹‰è¿›è¡Œäº†å¢å¼ºã€‚æ€ä¹ˆå¢å¼ºçš„å‘¢ï¼Ÿç­”æ¡ˆæ˜¯ä¸€é¡¹ Happens-Before è§„åˆ™ã€‚</p><h2>Happens-Before è§„åˆ™</h2><p>å¦‚ä½•ç†è§£ Happens-Before å‘¢ï¼Ÿå¦‚æœæœ›æ–‡ç”Ÿä¹‰ï¼ˆå¾ˆå¤šç½‘æ–‡ä¹Ÿéƒ½çˆ±æŒ‰å­—é¢æ„æ€ç¿»è¯‘æˆâ€œå…ˆè¡Œå‘ç”Ÿâ€ï¼‰ï¼Œé‚£å°±å—è¾•åŒ—è¾™äº†ï¼ŒHappens-Before å¹¶ä¸æ˜¯è¯´å‰é¢ä¸€ä¸ªæ“ä½œå‘ç”Ÿåœ¨åç»­æ“ä½œçš„å‰é¢ï¼Œå®ƒçœŸæ­£è¦è¡¨è¾¾çš„æ˜¯ï¼š<strong>å‰é¢ä¸€ä¸ªæ“ä½œçš„ç»“æœå¯¹åç»­æ“ä½œæ˜¯å¯è§çš„</strong>ã€‚å°±åƒæœ‰å¿ƒçµæ„Ÿåº”çš„ä¸¤ä¸ªäººï¼Œè™½ç„¶è¿œéš”åƒé‡Œï¼Œä¸€ä¸ªäººå¿ƒä¹‹æ‰€æƒ³ï¼Œå¦ä¸€ä¸ªäººéƒ½çœ‹å¾—åˆ°ã€‚Happens-Before è§„åˆ™å°±æ˜¯è¦ä¿è¯çº¿ç¨‹ä¹‹é—´çš„è¿™ç§â€œå¿ƒçµæ„Ÿåº”â€ã€‚æ‰€ä»¥æ¯”è¾ƒæ­£å¼çš„è¯´æ³•æ˜¯ï¼šHappens-Before çº¦æŸäº†ç¼–è¯‘å™¨çš„ä¼˜åŒ–è¡Œä¸ºï¼Œè™½å…è®¸ç¼–è¯‘å™¨ä¼˜åŒ–ï¼Œä½†æ˜¯è¦æ±‚ç¼–è¯‘å™¨ä¼˜åŒ–åä¸€å®šéµå®ˆ Happens-Before è§„åˆ™ã€‚</p><p>Happens-Before è§„åˆ™åº”è¯¥æ˜¯Javaå†…å­˜æ¨¡å‹é‡Œé¢æœ€æ™¦æ¶©çš„å†…å®¹äº†ï¼Œå’Œç¨‹åºå‘˜ç›¸å…³çš„è§„åˆ™ä¸€å…±æœ‰å¦‚ä¸‹å…­é¡¹ï¼Œéƒ½æ˜¯å…³äºå¯è§æ€§çš„ã€‚</p><p>æ°å¥½å‰é¢ç¤ºä¾‹ä»£ç æ¶‰åŠåˆ°è¿™å…­é¡¹è§„åˆ™ä¸­çš„å‰ä¸‰é¡¹ï¼Œä¸ºä¾¿äºä½ ç†è§£ï¼Œæˆ‘ä¹Ÿä¼šåˆ†æä¸Šé¢çš„ç¤ºä¾‹ä»£ç ï¼Œæ¥çœ‹çœ‹è§„åˆ™1ã€2å’Œ3åˆ°åº•è¯¥å¦‚ä½•ç†è§£ã€‚è‡³äºå…¶ä»–ä¸‰é¡¹ï¼Œæˆ‘ä¹Ÿä¼šç»“åˆå…¶ä»–ä¾‹å­ä½œä»¥è¯´æ˜ã€‚</p><h3>1. ç¨‹åºçš„é¡ºåºæ€§è§„åˆ™</h3><p>è¿™æ¡è§„åˆ™æ˜¯æŒ‡åœ¨ä¸€ä¸ªçº¿ç¨‹ä¸­ï¼ŒæŒ‰ç…§ç¨‹åºé¡ºåºï¼Œå‰é¢çš„æ“ä½œ Happens-Before äºåç»­çš„ä»»æ„æ“ä½œã€‚è¿™è¿˜æ˜¯æ¯”è¾ƒå®¹æ˜“ç†è§£çš„ï¼Œæ¯”å¦‚åˆšæ‰é‚£æ®µç¤ºä¾‹ä»£ç ï¼ŒæŒ‰ç…§ç¨‹åºçš„é¡ºåºï¼Œç¬¬6è¡Œä»£ç  â€œx = 42;â€ Happens-Before äºç¬¬7è¡Œä»£ç  â€œv = true;â€ï¼Œè¿™å°±æ˜¯è§„åˆ™1çš„å†…å®¹ï¼Œä¹Ÿæ¯”è¾ƒç¬¦åˆå•çº¿ç¨‹é‡Œé¢çš„æ€ç»´ï¼šç¨‹åºå‰é¢å¯¹æŸä¸ªå˜é‡çš„ä¿®æ”¹ä¸€å®šæ˜¯å¯¹åç»­æ“ä½œå¯è§çš„ã€‚</p><p><span class=\"orange\">ï¼ˆä¸ºæ–¹ä¾¿ä½ æŸ¥çœ‹ï¼Œæˆ‘å°†é‚£æ®µç¤ºä¾‹ä»£ç åœ¨è¿™å„¿å†å‘ˆç°ä¸€éï¼‰</span></p><pre><code>// ä»¥ä¸‹ä»£ç æ¥æºäºã€å‚è€ƒ1ã€‘\nclass VolatileExample {\n  int x = 0;\n  volatile boolean v = false;\n  public void writer() {\n    x = 42;\n    v = true;\n  }\n  public void reader() {\n    if (v == true) {\n      // è¿™é‡Œxä¼šæ˜¯å¤šå°‘å‘¢ï¼Ÿ\n    }\n  }\n}\n</code></pre><h3>2. volatileå˜é‡è§„åˆ™</h3><p>è¿™æ¡è§„åˆ™æ˜¯æŒ‡å¯¹ä¸€ä¸ªvolatileå˜é‡çš„å†™æ“ä½œï¼Œ Happens-Before äºåç»­å¯¹è¿™ä¸ªvolatileå˜é‡çš„è¯»æ“ä½œã€‚</p><p>è¿™ä¸ªå°±æœ‰ç‚¹è´¹è§£äº†ï¼Œå¯¹ä¸€ä¸ªvolatileå˜é‡çš„å†™æ“ä½œç›¸å¯¹äºåç»­å¯¹è¿™ä¸ªvolatileå˜é‡çš„è¯»æ“ä½œå¯è§ï¼Œè¿™æ€ä¹ˆçœ‹éƒ½æ˜¯ç¦ç”¨ç¼“å­˜çš„æ„æ€å•Šï¼Œè²Œä¼¼å’Œ1.5ç‰ˆæœ¬ä»¥å‰çš„è¯­ä¹‰æ²¡æœ‰å˜åŒ–å•Šï¼Ÿå¦‚æœå•çœ‹è¿™ä¸ªè§„åˆ™ï¼Œçš„ç¡®æ˜¯è¿™æ ·ï¼Œä½†æ˜¯å¦‚æœæˆ‘ä»¬å…³è”ä¸€ä¸‹è§„åˆ™3ï¼Œå°±æœ‰ç‚¹ä¸ä¸€æ ·çš„æ„Ÿè§‰äº†ã€‚</p><h3>3. ä¼ é€’æ€§</h3><p>è¿™æ¡è§„åˆ™æ˜¯æŒ‡å¦‚æœA Happens-Before Bï¼Œä¸”B Happens-Before Cï¼Œé‚£ä¹ˆA Happens-Before Cã€‚</p><p>æˆ‘ä»¬å°†è§„åˆ™3çš„ä¼ é€’æ€§åº”ç”¨åˆ°æˆ‘ä»¬çš„ä¾‹å­ä¸­ï¼Œä¼šå‘ç”Ÿä»€ä¹ˆå‘¢ï¼Ÿå¯ä»¥çœ‹ä¸‹é¢è¿™å¹…å›¾ï¼š</p><p><img src=\"https://static001.geekbang.org/resource/image/b1/e1/b1fa541e98c74bc2a033d9ac5ae7fbe1.png?wh=1142*640\" alt=\"\"></p><center><span class=\"reference\">ç¤ºä¾‹ä»£ç ä¸­çš„ä¼ é€’æ€§è§„åˆ™</span></center><p>ä»å›¾ä¸­ï¼Œæˆ‘ä»¬å¯ä»¥çœ‹åˆ°ï¼š</p><ol>\n<li>â€œx=42â€ Happens-Before å†™å˜é‡ â€œv=trueâ€ ï¼Œè¿™æ˜¯è§„åˆ™1çš„å†…å®¹ï¼›</li>\n<li>å†™å˜é‡â€œv=trueâ€ Happens-Before è¯»å˜é‡ â€œv=trueâ€ï¼Œè¿™æ˜¯è§„åˆ™2çš„å†…å®¹ ã€‚</li>\n</ol><p>å†æ ¹æ®è¿™ä¸ªä¼ é€’æ€§è§„åˆ™ï¼Œæˆ‘ä»¬å¾—åˆ°ç»“æœï¼šâ€œx=42â€ Happens-Before è¯»å˜é‡â€œv=trueâ€ã€‚è¿™æ„å‘³ç€ä»€ä¹ˆå‘¢ï¼Ÿ</p><p>å¦‚æœçº¿ç¨‹Bè¯»åˆ°äº†â€œv=trueâ€ï¼Œé‚£ä¹ˆçº¿ç¨‹Aè®¾ç½®çš„â€œx=42â€å¯¹çº¿ç¨‹Bæ˜¯å¯è§çš„ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œçº¿ç¨‹Bèƒ½çœ‹åˆ° â€œx == 42â€ ï¼Œæœ‰æ²¡æœ‰ä¸€ç§æç„¶å¤§æ‚Ÿçš„æ„Ÿè§‰ï¼Ÿè¿™å°±æ˜¯1.5ç‰ˆæœ¬å¯¹volatileè¯­ä¹‰çš„å¢å¼ºï¼Œè¿™ä¸ªå¢å¼ºæ„ä¹‰é‡å¤§ï¼Œ1.5ç‰ˆæœ¬çš„å¹¶å‘å·¥å…·åŒ…ï¼ˆjava.util.concurrentï¼‰å°±æ˜¯é volatileè¯­ä¹‰æ¥æå®šå¯è§æ€§çš„ï¼Œè¿™ä¸ªåœ¨åé¢çš„å†…å®¹ä¸­ä¼šè¯¦ç»†ä»‹ç»ã€‚</p><h3>4. ç®¡ç¨‹ä¸­é”çš„è§„åˆ™</h3><p>è¿™æ¡è§„åˆ™æ˜¯æŒ‡å¯¹ä¸€ä¸ªé”çš„è§£é” Happens-Before äºåç»­å¯¹è¿™ä¸ªé”çš„åŠ é”ã€‚</p><p>è¦ç†è§£è¿™ä¸ªè§„åˆ™ï¼Œå°±é¦–å…ˆè¦äº†è§£â€œç®¡ç¨‹æŒ‡çš„æ˜¯ä»€ä¹ˆâ€ã€‚<strong>ç®¡ç¨‹</strong>æ˜¯ä¸€ç§é€šç”¨çš„åŒæ­¥åŸè¯­ï¼Œåœ¨Javaä¸­æŒ‡çš„å°±æ˜¯synchronizedï¼Œsynchronizedæ˜¯Javaé‡Œå¯¹ç®¡ç¨‹çš„å®ç°ã€‚</p><p>ç®¡ç¨‹ä¸­çš„é”åœ¨Javaé‡Œæ˜¯éšå¼å®ç°çš„ï¼Œä¾‹å¦‚ä¸‹é¢çš„ä»£ç ï¼Œåœ¨è¿›å…¥åŒæ­¥å—ä¹‹å‰ï¼Œä¼šè‡ªåŠ¨åŠ é”ï¼Œè€Œåœ¨ä»£ç å—æ‰§è¡Œå®Œä¼šè‡ªåŠ¨é‡Šæ”¾é”ï¼ŒåŠ é”ä»¥åŠé‡Šæ”¾é”éƒ½æ˜¯ç¼–è¯‘å™¨å¸®æˆ‘ä»¬å®ç°çš„ã€‚</p><pre><code>synchronized (this) { //æ­¤å¤„è‡ªåŠ¨åŠ é”\n  // xæ˜¯å…±äº«å˜é‡,åˆå§‹å€¼=10\n  if (this.x &lt; 12) {\n    this.x = 12; \n  }  \n} //æ­¤å¤„è‡ªåŠ¨è§£é”\n</code></pre><p>æ‰€ä»¥ç»“åˆè§„åˆ™4â€”â€”ç®¡ç¨‹ä¸­é”çš„è§„åˆ™ï¼Œå¯ä»¥è¿™æ ·ç†è§£ï¼šå‡è®¾xçš„åˆå§‹å€¼æ˜¯10ï¼Œçº¿ç¨‹Aæ‰§è¡Œå®Œä»£ç å—åxçš„å€¼ä¼šå˜æˆ12ï¼ˆæ‰§è¡Œå®Œè‡ªåŠ¨é‡Šæ”¾é”ï¼‰ï¼Œçº¿ç¨‹Bè¿›å…¥ä»£ç å—æ—¶ï¼Œèƒ½å¤Ÿçœ‹åˆ°çº¿ç¨‹Aå¯¹xçš„å†™æ“ä½œï¼Œä¹Ÿå°±æ˜¯çº¿ç¨‹Bèƒ½å¤Ÿçœ‹åˆ°x==12ã€‚è¿™ä¸ªä¹Ÿæ˜¯ç¬¦åˆæˆ‘ä»¬ç›´è§‰çš„ï¼Œåº”è¯¥ä¸éš¾ç†è§£ã€‚</p><h3>5. çº¿ç¨‹ start() è§„åˆ™</h3><p>è¿™æ¡æ˜¯å…³äºçº¿ç¨‹å¯åŠ¨çš„ã€‚å®ƒæ˜¯æŒ‡ä¸»çº¿ç¨‹Aå¯åŠ¨å­çº¿ç¨‹Båï¼Œå­çº¿ç¨‹Bèƒ½å¤Ÿçœ‹åˆ°ä¸»çº¿ç¨‹åœ¨å¯åŠ¨å­çº¿ç¨‹Bå‰çš„æ“ä½œã€‚</p><p>æ¢å¥è¯è¯´å°±æ˜¯ï¼Œå¦‚æœçº¿ç¨‹Aè°ƒç”¨çº¿ç¨‹Bçš„ start() æ–¹æ³•ï¼ˆå³åœ¨çº¿ç¨‹Aä¸­å¯åŠ¨çº¿ç¨‹Bï¼‰ï¼Œé‚£ä¹ˆè¯¥start()æ“ä½œ Happens-Before äºçº¿ç¨‹Bä¸­çš„ä»»æ„æ“ä½œã€‚å…·ä½“å¯å‚è€ƒä¸‹é¢ç¤ºä¾‹ä»£ç ã€‚</p><pre><code>Thread B = new Thread(()-&gt;{\n  // ä¸»çº¿ç¨‹è°ƒç”¨B.start()ä¹‹å‰\n  // æ‰€æœ‰å¯¹å…±äº«å˜é‡çš„ä¿®æ”¹ï¼Œæ­¤å¤„çš†å¯è§\n  // æ­¤ä¾‹ä¸­ï¼Œvar==77\n});\n// æ­¤å¤„å¯¹å…±äº«å˜é‡varä¿®æ”¹\nvar = 77;\n// ä¸»çº¿ç¨‹å¯åŠ¨å­çº¿ç¨‹\nB.start();\n</code></pre><h3>6. çº¿ç¨‹ join() è§„åˆ™</h3><p>è¿™æ¡æ˜¯å…³äºçº¿ç¨‹ç­‰å¾…çš„ã€‚å®ƒæ˜¯æŒ‡ä¸»çº¿ç¨‹Aç­‰å¾…å­çº¿ç¨‹Bå®Œæˆï¼ˆä¸»çº¿ç¨‹Aé€šè¿‡è°ƒç”¨å­çº¿ç¨‹Bçš„join()æ–¹æ³•å®ç°ï¼‰ï¼Œå½“å­çº¿ç¨‹Bå®Œæˆåï¼ˆä¸»çº¿ç¨‹Aä¸­join()æ–¹æ³•è¿”å›ï¼‰ï¼Œä¸»çº¿ç¨‹èƒ½å¤Ÿçœ‹åˆ°å­çº¿ç¨‹çš„æ“ä½œã€‚å½“ç„¶æ‰€è°“çš„â€œçœ‹åˆ°â€ï¼ŒæŒ‡çš„æ˜¯å¯¹<strong>å…±äº«å˜é‡</strong>çš„æ“ä½œã€‚</p><p>æ¢å¥è¯è¯´å°±æ˜¯ï¼Œå¦‚æœåœ¨çº¿ç¨‹Aä¸­ï¼Œè°ƒç”¨çº¿ç¨‹Bçš„ join() å¹¶æˆåŠŸè¿”å›ï¼Œé‚£ä¹ˆçº¿ç¨‹Bä¸­çš„ä»»æ„æ“ä½œHappens-Before äºè¯¥ join() æ“ä½œçš„è¿”å›ã€‚å…·ä½“å¯å‚è€ƒä¸‹é¢ç¤ºä¾‹ä»£ç ã€‚</p><pre><code>Thread B = new Thread(()-&gt;{\n  // æ­¤å¤„å¯¹å…±äº«å˜é‡varä¿®æ”¹\n  var = 66;\n});\n// ä¾‹å¦‚æ­¤å¤„å¯¹å…±äº«å˜é‡ä¿®æ”¹ï¼Œ\n// åˆ™è¿™ä¸ªä¿®æ”¹ç»“æœå¯¹çº¿ç¨‹Bå¯è§\n// ä¸»çº¿ç¨‹å¯åŠ¨å­çº¿ç¨‹\nB.start();\nB.join()\n// å­çº¿ç¨‹æ‰€æœ‰å¯¹å…±äº«å˜é‡çš„ä¿®æ”¹\n// åœ¨ä¸»çº¿ç¨‹è°ƒç”¨B.join()ä¹‹åçš†å¯è§\n// æ­¤ä¾‹ä¸­ï¼Œvar==66\n</code></pre><h2>è¢«æˆ‘ä»¬å¿½è§†çš„final</h2><p>å‰é¢æˆ‘ä»¬è®²volatileä¸ºçš„æ˜¯ç¦ç”¨ç¼“å­˜ä»¥åŠç¼–è¯‘ä¼˜åŒ–ï¼Œæˆ‘ä»¬å†ä»å¦å¤–ä¸€ä¸ªæ–¹é¢æ¥çœ‹ï¼Œæœ‰æ²¡æœ‰åŠæ³•å‘Šè¯‰ç¼–è¯‘å™¨ä¼˜åŒ–å¾—æ›´å¥½ä¸€ç‚¹å‘¢ï¼Ÿè¿™ä¸ªå¯ä»¥æœ‰ï¼Œå°±æ˜¯<strong>finalå…³é”®å­—</strong>ã€‚</p><p><strong>finalä¿®é¥°å˜é‡æ—¶ï¼Œåˆè¡·æ˜¯å‘Šè¯‰ç¼–è¯‘å™¨ï¼šè¿™ä¸ªå˜é‡ç”Ÿè€Œä¸å˜ï¼Œå¯ä»¥å¯åŠ²å„¿ä¼˜åŒ–ã€‚</strong>Javaç¼–è¯‘å™¨åœ¨1.5ä»¥å‰çš„ç‰ˆæœ¬çš„ç¡®ä¼˜åŒ–å¾—å¾ˆåŠªåŠ›ï¼Œä»¥è‡³äºéƒ½ä¼˜åŒ–é”™äº†ã€‚</p><p>é—®é¢˜ç±»ä¼¼äºä¸Šä¸€æœŸæåˆ°çš„åˆ©ç”¨åŒé‡æ£€æŸ¥æ–¹æ³•åˆ›å»ºå•ä¾‹ï¼Œæ„é€ å‡½æ•°çš„é”™è¯¯é‡æ’å¯¼è‡´çº¿ç¨‹å¯èƒ½çœ‹åˆ°finalå˜é‡çš„å€¼ä¼šå˜åŒ–ã€‚è¯¦ç»†çš„æ¡ˆä¾‹å¯ä»¥å‚è€ƒ<a href=\"http://www.cs.umd.edu/~pugh/java/memoryModel/jsr-133-faq.html#finalWrong\">è¿™ä¸ªæ–‡æ¡£</a>ã€‚</p><p>å½“ç„¶äº†ï¼Œåœ¨1.5ä»¥åJavaå†…å­˜æ¨¡å‹å¯¹finalç±»å‹å˜é‡çš„é‡æ’è¿›è¡Œäº†çº¦æŸã€‚ç°åœ¨åªè¦æˆ‘ä»¬æä¾›æ­£ç¡®æ„é€ å‡½æ•°æ²¡æœ‰â€œé€¸å‡ºâ€ï¼Œå°±ä¸ä¼šå‡ºé—®é¢˜äº†ã€‚</p><p>â€œé€¸å‡ºâ€æœ‰ç‚¹æŠ½è±¡ï¼Œæˆ‘ä»¬è¿˜æ˜¯ä¸¾ä¸ªä¾‹å­å§ï¼Œåœ¨ä¸‹é¢ä¾‹å­ä¸­ï¼Œåœ¨æ„é€ å‡½æ•°é‡Œé¢å°†thisèµ‹å€¼ç»™äº†å…¨å±€å˜é‡global.objï¼Œè¿™å°±æ˜¯â€œé€¸å‡ºâ€ï¼Œçº¿ç¨‹é€šè¿‡global.objè¯»å–xæ˜¯æœ‰å¯èƒ½è¯»åˆ°0çš„ã€‚å› æ­¤æˆ‘ä»¬ä¸€å®šè¦é¿å…â€œé€¸å‡ºâ€ã€‚</p><pre><code>// ä»¥ä¸‹ä»£ç æ¥æºäºã€å‚è€ƒ1ã€‘\nfinal int x;\n// é”™è¯¯çš„æ„é€ å‡½æ•°\npublic FinalFieldExample() { \n  x = 3;\n  y = 4;\n  // æ­¤å¤„å°±æ˜¯è®²thisé€¸å‡ºï¼Œ\n  global.obj = this;\n}\n</code></pre><h2>æ€»ç»“</h2><p>Javaçš„å†…å­˜æ¨¡å‹æ˜¯å¹¶å‘ç¼–ç¨‹é¢†åŸŸçš„ä¸€æ¬¡é‡è¦åˆ›æ–°ï¼Œä¹‹åC++ã€C#ã€Golangç­‰é«˜çº§è¯­è¨€éƒ½å¼€å§‹æ”¯æŒå†…å­˜æ¨¡å‹ã€‚Javaå†…å­˜æ¨¡å‹é‡Œé¢ï¼Œæœ€æ™¦æ¶©çš„éƒ¨åˆ†å°±æ˜¯Happens-Beforeè§„åˆ™äº†ï¼ŒHappens-Beforeè§„åˆ™æœ€åˆæ˜¯åœ¨ä¸€ç¯‡å«åš<strong>Time, Clocks, and the Ordering of Events in a Distributed System</strong>çš„è®ºæ–‡ä¸­æå‡ºæ¥çš„ï¼Œåœ¨è¿™ç¯‡è®ºæ–‡ä¸­ï¼ŒHappens-Beforeçš„è¯­ä¹‰æ˜¯ä¸€ç§å› æœå…³ç³»ã€‚åœ¨ç°å®ä¸–ç•Œé‡Œï¼Œå¦‚æœAäº‹ä»¶æ˜¯å¯¼è‡´Bäº‹ä»¶çš„èµ·å› ï¼Œé‚£ä¹ˆAäº‹ä»¶ä¸€å®šæ˜¯å…ˆäºï¼ˆHappens-Beforeï¼‰Bäº‹ä»¶å‘ç”Ÿçš„ï¼Œè¿™ä¸ªå°±æ˜¯Happens-Beforeè¯­ä¹‰çš„ç°å®ç†è§£ã€‚</p><p>åœ¨Javaè¯­è¨€é‡Œé¢ï¼ŒHappens-Beforeçš„è¯­ä¹‰æœ¬è´¨ä¸Šæ˜¯ä¸€ç§å¯è§æ€§ï¼ŒA Happens-Before B æ„å‘³ç€Aäº‹ä»¶å¯¹Bäº‹ä»¶æ¥è¯´æ˜¯å¯è§çš„ï¼Œæ— è®ºAäº‹ä»¶å’ŒBäº‹ä»¶æ˜¯å¦å‘ç”Ÿåœ¨åŒä¸€ä¸ªçº¿ç¨‹é‡Œã€‚ä¾‹å¦‚Aäº‹ä»¶å‘ç”Ÿåœ¨çº¿ç¨‹1ä¸Šï¼ŒBäº‹ä»¶å‘ç”Ÿåœ¨çº¿ç¨‹2ä¸Šï¼ŒHappens-Beforeè§„åˆ™ä¿è¯çº¿ç¨‹2ä¸Šä¹Ÿèƒ½çœ‹åˆ°Aäº‹ä»¶çš„å‘ç”Ÿã€‚</p><p>Javaå†…å­˜æ¨¡å‹ä¸»è¦åˆ†ä¸ºä¸¤éƒ¨åˆ†ï¼Œä¸€éƒ¨åˆ†é¢å‘ä½ æˆ‘è¿™ç§ç¼–å†™å¹¶å‘ç¨‹åºçš„åº”ç”¨å¼€å‘äººå‘˜ï¼Œå¦ä¸€éƒ¨åˆ†æ˜¯é¢å‘JVMçš„å®ç°äººå‘˜çš„ï¼Œæˆ‘ä»¬å¯ä»¥é‡ç‚¹å…³æ³¨å‰è€…ï¼Œä¹Ÿå°±æ˜¯å’Œç¼–å†™å¹¶å‘ç¨‹åºç›¸å…³çš„éƒ¨åˆ†ï¼Œè¿™éƒ¨åˆ†å†…å®¹çš„æ ¸å¿ƒå°±æ˜¯Happens-Beforeè§„åˆ™ã€‚ç›¸ä¿¡ç»è¿‡æœ¬ç« çš„ä»‹ç»ï¼Œä½ åº”è¯¥å¯¹è¿™éƒ¨åˆ†å†…å®¹å·²ç»æœ‰äº†æ·±å…¥çš„è®¤è¯†ã€‚</p><h2>è¯¾åæ€è€ƒ</h2><p>æœ‰ä¸€ä¸ªå…±äº«å˜é‡ abcï¼Œåœ¨ä¸€ä¸ªçº¿ç¨‹é‡Œè®¾ç½®äº†abcçš„å€¼ <code>abc=3</code>ï¼Œä½ æ€è€ƒä¸€ä¸‹ï¼Œæœ‰å“ªäº›åŠæ³•å¯ä»¥è®©å…¶ä»–çº¿ç¨‹èƒ½å¤Ÿçœ‹åˆ°<code>abc==3</code>ï¼Ÿ</p><p>æ¬¢è¿åœ¨ç•™è¨€åŒºä¸æˆ‘åˆ†äº«ä½ çš„æƒ³æ³•ï¼Œä¹Ÿæ¬¢è¿ä½ åœ¨ç•™è¨€åŒºè®°å½•ä½ çš„æ€è€ƒè¿‡ç¨‹ã€‚æ„Ÿè°¢é˜…è¯»ï¼Œå¦‚æœä½ è§‰å¾—è¿™ç¯‡æ–‡ç« å¯¹ä½ æœ‰å¸®åŠ©çš„è¯ï¼Œä¹Ÿæ¬¢è¿æŠŠå®ƒåˆ†äº«ç»™æ›´å¤šçš„æœ‹å‹ã€‚</p><h2>å‚è€ƒ</h2><ol>\n<li><a href=\"http://www.cs.umd.edu/~pugh/java/memoryModel/jsr-133-faq.html\">JSR 133 (Java Memory Model) FAQ</a></li>\n<li><a href=\"http://ifeve.com/jmm-faq/\">Javaå†…å­˜æ¨¡å‹FAQ</a></li>\n<li><a href=\"https://www.cs.umd.edu/~pugh/java/memoryModel/jsr133.pdf\">JSR-133: Java<sup>TM</sup> Memory Model and Thread Specification</a></li>\n</ol><p></p>","comments":[{"had_liked":false,"id":72054,"user_name":"Healtheon","can_delete":false,"product_type":"c1","uid":1206751,"ip_address":"","ucode":"B564B1FC4456E8","user_header":"https://static001.geekbang.org/account/avatar/00/12/69/df/2dca1305.jpg","comment_is_top":false,"comment_ctime":1551508339,"is_pvip":false,"replies":[{"id":"26106","content":"å‰å®³å‰å®³ï¼ï¼ï¼","user_name":"ä½œè€…å›å¤","comment_id":72054,"uid":"1269969","ip_address":"","utype":1,"ctime":1551522887,"user_name_real":"ç‹å®ä»¤"}],"discussion_count":31,"race_medal":0,"score":"4086065406835","product_id":100023901,"comment_content":"è€å¸ˆï¼Œè¿˜å·®ä¸¤ä¸ªè§„åˆ™ï¼Œåˆ†åˆ«æ˜¯ï¼š<br>çº¿ç¨‹ä¸­æ–­è§„åˆ™ï¼šå¯¹çº¿ç¨‹interrupt()æ–¹æ³•çš„è°ƒç”¨å…ˆè¡Œå‘ç”Ÿäºè¢«ä¸­æ–­çº¿ç¨‹çš„ä»£ç æ£€æµ‹åˆ°ä¸­æ–­äº‹ä»¶çš„å‘ç”Ÿï¼Œå¯ä»¥é€šè¿‡Thread.interrupted()æ–¹æ³•æ£€æµ‹åˆ°æ˜¯å¦æœ‰ä¸­æ–­å‘ç”Ÿã€‚<br>å¯¹è±¡ç»ˆç»“è§„åˆ™ï¼šä¸€ä¸ªå¯¹è±¡çš„åˆå§‹åŒ–å®Œæˆ(æ„é€ å‡½æ•°æ‰§è¡Œç»“æŸ)å…ˆè¡Œå‘ç”Ÿäºå®ƒçš„finalize()æ–¹æ³•çš„å¼€å§‹ã€‚<br><br>æ‰€ä»¥ï¼Œä¸ªäººå¯¹äºJavaå†…å­˜æ¨¡å‹æ€»ç»“èµ·æ¥å°±æ˜¯ï¼š<br>1. ä¸ºä»€ä¹ˆå®šä¹‰Javaå†…å­˜æ¨¡å‹ï¼Ÿç°ä»£è®¡ç®—æœºä½“ç³»å¤§éƒ¨æ˜¯é‡‡ç”¨çš„å¯¹ç§°å¤šå¤„ç†å™¨çš„ä½“ç³»æ¶æ„ã€‚æ¯ä¸ªå¤„ç†å™¨å‡æœ‰ç‹¬ç«‹çš„å¯„å­˜å™¨ç»„å’Œç¼“å­˜ï¼Œå¤šä¸ªå¤„ç†å™¨å¯åŒæ—¶æ‰§è¡ŒåŒä¸€è¿›ç¨‹ä¸­çš„ä¸åŒçº¿ç¨‹ï¼Œè¿™é‡Œç§°ä¸ºå¤„ç†å™¨çš„ä¹±åºæ‰§è¡Œã€‚åœ¨Javaä¸­ï¼Œä¸åŒçš„çº¿ç¨‹å¯èƒ½è®¿é—®åŒä¸€ä¸ªå…±äº«æˆ–å…±äº«å˜é‡ã€‚å¦‚æœä»»ç”±ç¼–è¯‘å™¨æˆ–å¤„ç†å™¨å¯¹è¿™äº›è®¿é—®è¿›è¡Œä¼˜åŒ–çš„è¯ï¼Œå¾ˆæœ‰å¯èƒ½å‡ºç°æ— æ³•æƒ³è±¡çš„é—®é¢˜ï¼Œè¿™é‡Œç§°ä¸ºç¼–è¯‘å™¨çš„é‡æ’åºã€‚é™¤äº†å¤„ç†å™¨çš„ä¹±åºæ‰§è¡Œã€ç¼–è¯‘å™¨çš„é‡æ’åºï¼Œè¿˜æœ‰å†…å­˜ç³»ç»Ÿçš„é‡æ’åºã€‚å› æ­¤Javaè¯­è¨€è§„èŒƒå¼•å…¥äº†Javaå†…å­˜æ¨¡å‹ï¼Œé€šè¿‡å®šä¹‰å¤šé¡¹è§„åˆ™å¯¹ç¼–è¯‘å™¨å’Œå¤„ç†å™¨è¿›è¡Œé™åˆ¶ï¼Œä¸»è¦æ˜¯é’ˆå¯¹å¯è§æ€§å’Œæœ‰åºæ€§ã€‚<br>2. ä¸‰ä¸ªåŸºæœ¬åŸåˆ™ï¼šåŸå­æ€§ã€å¯è§æ€§ã€æœ‰åºæ€§ã€‚<br>3. Javaå†…å­˜æ¨¡å‹æ¶‰åŠçš„å‡ ä¸ªå…³é”®è¯ï¼šé”ã€volatileå­—æ®µã€finalä¿®é¥°ç¬¦ä¸å¯¹è±¡çš„å®‰å…¨å‘å¸ƒã€‚å…¶ä¸­ï¼šç¬¬ä¸€æ˜¯é”ï¼Œé”æ“ä½œæ˜¯å…·å¤‡happens-beforeå…³ç³»çš„ï¼Œè§£é”æ“ä½œhappens-beforeä¹‹åå¯¹åŒä¸€æŠŠé”çš„åŠ é”æ“ä½œã€‚å®é™…ä¸Šï¼Œåœ¨è§£é”çš„æ—¶å€™ï¼ŒJVMéœ€è¦å¼ºåˆ¶åˆ·æ–°ç¼“å­˜ï¼Œä½¿å¾—å½“å‰çº¿ç¨‹æ‰€ä¿®æ”¹çš„å†…å­˜å¯¹å…¶ä»–çº¿ç¨‹å¯è§ã€‚ç¬¬äºŒæ˜¯volatileå­—æ®µï¼Œvolatileå­—æ®µå¯ä»¥çœ‹æˆæ˜¯ä¸€ç§ä¸ä¿è¯åŸå­æ€§çš„åŒæ­¥ä½†ä¿è¯å¯è§æ€§çš„ç‰¹æ€§ï¼Œå…¶æ€§èƒ½å¾€å¾€æ˜¯ä¼˜äºé”æ“ä½œçš„ã€‚ä½†æ˜¯ï¼Œé¢‘ç¹åœ°è®¿é—® volatileå­—æ®µä¹Ÿä¼šå‡ºç°å› ä¸ºä¸æ–­åœ°å¼ºåˆ¶åˆ·æ–°ç¼“å­˜è€Œå½±å“ç¨‹åºçš„æ€§èƒ½çš„é—®é¢˜ã€‚ç¬¬ä¸‰æ˜¯finalä¿®é¥°ç¬¦ï¼Œfinalä¿®é¥°çš„å®ä¾‹å­—æ®µåˆ™æ˜¯æ¶‰åŠåˆ°æ–°å»ºå¯¹è±¡çš„å‘å¸ƒé—®é¢˜ã€‚å½“ä¸€ä¸ªå¯¹è±¡åŒ…å«finalä¿®é¥°çš„å®ä¾‹å­—æ®µæ—¶ï¼Œå…¶ä»–çº¿ç¨‹èƒ½å¤Ÿçœ‹åˆ°å·²ç»åˆå§‹åŒ–çš„finalå®ä¾‹å­—æ®µï¼Œè¿™æ˜¯å®‰å…¨çš„ã€‚<br>4. Happens-Beforeçš„7ä¸ªè§„åˆ™ï¼š<br>\t(1).ç¨‹åºæ¬¡åºè§„åˆ™ï¼šåœ¨ä¸€ä¸ªçº¿ç¨‹å†…ï¼ŒæŒ‰ç…§ç¨‹åºä»£ç é¡ºåºï¼Œä¹¦å†™åœ¨å‰é¢çš„æ“ä½œå…ˆè¡Œå‘ç”Ÿäºä¹¦å†™åœ¨åé¢çš„æ“ä½œã€‚å‡†ç¡®åœ°è¯´ï¼Œåº”è¯¥æ˜¯æ§åˆ¶æµé¡ºåºè€Œä¸æ˜¯ç¨‹åºä»£ç é¡ºåºï¼Œå› ä¸ºè¦è€ƒè™‘åˆ†æ”¯ã€å¾ªç¯ç­‰ç»“æ„ã€‚<br>\t(2).ç®¡ç¨‹é”å®šè§„åˆ™ï¼šä¸€ä¸ªunlockæ“ä½œå…ˆè¡Œå‘ç”Ÿäºåé¢å¯¹åŒä¸€ä¸ªé”çš„lockæ“ä½œã€‚è¿™é‡Œå¿…é¡»å¼ºè°ƒçš„æ˜¯åŒä¸€ä¸ªé”ï¼Œè€Œ&quot;åé¢&quot;æ˜¯æŒ‡æ—¶é—´ä¸Šçš„å…ˆåé¡ºåºã€‚<br>\t(3).volatileå˜é‡è§„åˆ™ï¼šå¯¹ä¸€ä¸ªvolatileå˜é‡çš„å†™æ“ä½œå…ˆè¡Œå‘ç”Ÿäºåé¢å¯¹è¿™ä¸ªå˜é‡çš„è¯»æ“ä½œï¼Œè¿™é‡Œçš„&quot;åé¢&quot;åŒæ ·æ˜¯æŒ‡æ—¶é—´ä¸Šçš„å…ˆåé¡ºåºã€‚<br>\t(4).çº¿ç¨‹å¯åŠ¨è§„åˆ™ï¼šThreadå¯¹è±¡çš„start()æ–¹æ³•å…ˆè¡Œå‘ç”Ÿäºæ­¤çº¿ç¨‹çš„æ¯ä¸€ä¸ªåŠ¨ä½œã€‚<br>\t(5).çº¿ç¨‹ç»ˆæ­¢è§„åˆ™ï¼šçº¿ç¨‹ä¸­çš„æ‰€æœ‰æ“ä½œéƒ½å…ˆè¡Œå‘ç”Ÿäºå¯¹æ­¤çº¿ç¨‹çš„ç»ˆæ­¢æ£€æµ‹ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡Thread.joinï¼ˆï¼‰æ–¹æ³•ç»“æŸã€Thread.isAliveï¼ˆï¼‰çš„è¿”å›å€¼ç­‰æ‰‹æ®µæ£€æµ‹åˆ°çº¿ç¨‹å·²ç»ç»ˆæ­¢æ‰§è¡Œã€‚<br>\t(6).çº¿ç¨‹ä¸­æ–­è§„åˆ™ï¼šå¯¹çº¿ç¨‹interrupt()æ–¹æ³•çš„è°ƒç”¨å…ˆè¡Œå‘ç”Ÿäºè¢«ä¸­æ–­çº¿ç¨‹çš„ä»£ç æ£€æµ‹åˆ°ä¸­æ–­äº‹ä»¶çš„å‘ç”Ÿï¼Œå¯ä»¥é€šè¿‡Thread.interrupted()æ–¹æ³•æ£€æµ‹åˆ°æ˜¯å¦æœ‰ä¸­æ–­å‘ç”Ÿã€‚<br>\t(7).å¯¹è±¡ç»ˆç»“è§„åˆ™ï¼šä¸€ä¸ªå¯¹è±¡çš„åˆå§‹åŒ–å®Œæˆ(æ„é€ å‡½æ•°æ‰§è¡Œç»“æŸ)å…ˆè¡Œå‘ç”Ÿäºå®ƒçš„finalize()æ–¹æ³•çš„å¼€å§‹ã€‚<br>5. Happens-Beforeçš„1ä¸ªç‰¹æ€§ï¼šä¼ é€’æ€§ã€‚<br>6. Javaå†…å­˜æ¨¡å‹åº•å±‚æ€ä¹ˆå®ç°çš„ï¼Ÿä¸»è¦æ˜¯é€šè¿‡å†…å­˜å±éšœ(memory barrier)ç¦æ­¢é‡æ’åºçš„ï¼Œå³æ—¶ç¼–è¯‘å™¨æ ¹æ®å…·ä½“çš„åº•å±‚ä½“ç³»æ¶æ„ï¼Œå°†è¿™äº›å†…å­˜å±éšœæ›¿æ¢æˆå…·ä½“çš„ CPU æŒ‡ä»¤ã€‚å¯¹äºç¼–è¯‘å™¨è€Œè¨€ï¼Œå†…å­˜å±éšœå°†é™åˆ¶å®ƒæ‰€èƒ½åšçš„é‡æ’åºä¼˜åŒ–ã€‚è€Œå¯¹äºå¤„ç†å™¨è€Œè¨€ï¼Œå†…å­˜å±éšœå°†ä¼šå¯¼è‡´ç¼“å­˜çš„åˆ·æ–°æ“ä½œã€‚æ¯”å¦‚ï¼Œå¯¹äºvolatileï¼Œç¼–è¯‘å™¨å°†åœ¨volatileå­—æ®µçš„è¯»å†™æ“ä½œå‰åå„æ’å…¥ä¸€äº›å†…å­˜å±éšœã€‚","like_count":952,"discussions":[{"author":{"id":1269969,"avatar":"https://static001.geekbang.org/account/avatar/00/13/60/d1/8efa89ab.jpg","nickname":"ç‹å®ä»¤","note":"","ucode":"4FE19F5BC32FCA","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":441440,"discussion_content":"å‰å®³å‰å®³ï¼ï¼ï¼","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1551522887,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":2286802,"avatar":"","nickname":"Geek_072f8a","note":"","ucode":"830D4594E19D45","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":320863,"discussion_content":"è¿™å¥½åƒæ˜¯æŠ„çš„æ·±å…¥javaè™šæ‹Ÿæœºé‡Œé¢çš„","likes_number":8,"is_delete":false,"is_hidden":false,"ctime":1604493196,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1581294,"avatar":"","nickname":"Geek_be4cec","note":"","ucode":"C87642D655EAC3","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":3413,"discussion_content":"è®²çš„æ²¡æœ‰è€å¸ˆè®²çš„æ¸…æ¥šã€æ˜“æ‡‚ã€‚","likes_number":5,"is_delete":false,"is_hidden":false,"ctime":1564469152,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1275497,"avatar":"http://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTKNDbT0BpwkVNAuCWeRoibnvT2xoItdPv8I1ITzpCu8JFibSXVYGDeGwScDxtOJSDib4f8kHPoJHiaOKg/132","nickname":"é²²ä¹‹å¤§","note":"","ucode":"FF99A15F644261","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":1798,"discussion_content":"interrupt() ç”¨äºä¸­æ–­å¦ä¸€ä¸ªçº¿ç¨‹\nisInterrupted()ï¼Œç”¨æ¥åˆ¤æ–­å½“å‰çº¿ç¨‹çš„ä¸­æ–­çŠ¶æ€(true or false)ã€‚\ninterrupted()æ˜¯ä¸ªThreadçš„staticæ–¹æ³•ï¼Œç”¨æ¥æ¢å¤ä¸­æ–­çŠ¶æ€ã€‚","likes_number":6,"is_delete":false,"is_hidden":false,"ctime":1562916397,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":1,"child_discussions":[{"author":{"id":1488931,"avatar":"https://static001.geekbang.org/account/avatar/00/16/b8/23/85c7911c.jpg","nickname":"å¤©æ–“æµ·ç¼","note":"","ucode":"0BD579B063C72C","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":1275497,"avatar":"http://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTKNDbT0BpwkVNAuCWeRoibnvT2xoItdPv8I1ITzpCu8JFibSXVYGDeGwScDxtOJSDib4f8kHPoJHiaOKg/132","nickname":"é²²ä¹‹å¤§","note":"","ucode":"FF99A15F644261","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":541331,"discussion_content":"ç¡®å®æ˜¯ï¼Œçœ‹äº†åº•å±‚ä»£ç æ‰çŸ¥é“çš„","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1640334230,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":1798,"ip_address":""},"score":541331,"extra":""}]},{"author":{"id":1181913,"avatar":"https://static001.geekbang.org/account/avatar/00/12/08/d9/6e0ee07f.jpg","nickname":"xiaoli","note":"","ucode":"49B5F1BD2B723A","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":311976,"discussion_content":"æ˜æ˜¾æ¯”æŸè€å¸ˆè®²çš„å¥½å¤šäº†","likes_number":2,"is_delete":false,"is_hidden":false,"ctime":1602554653,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1654600,"avatar":"","nickname":"xanxus","note":"","ucode":"FFF1EFD2ABCBAA","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":179935,"discussion_content":"å¤„ç†å™¨çš„ä¹±åºåº”è¯¥æ˜¯å¤„ç†çš„ä¸åŒæŒ‡ä»¤å¤„ç†æ—¶é—´é•¿çŸ­ä¸ä¸€æ ·ï¼Œä¸ºäº†æœ€å¤§é™åº¦æé«˜å¤„ç†å™¨æµæ°´çº¿çš„æ€§èƒ½ï¼Œå¤„ç†å™¨å¯¹æŒ‡ä»¤åšäº†ä¸€å®šç¨‹åº¦çš„æŒ‡ä»¤é‡æ’","likes_number":2,"is_delete":false,"is_hidden":false,"ctime":1582262495,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":2761427,"avatar":"","nickname":"Geek_b5b334","note":"","ucode":"AACE658AC4CBA8","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":394592,"discussion_content":"markä¸€ä¸‹","likes_number":1,"is_delete":false,"is_hidden":false,"ctime":1631951058,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1207153,"avatar":"","nickname":"liulei3","note":"","ucode":"C869F663AF4B42","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":347644,"discussion_content":"èµ æ„Ÿè§‰æ¯”ä½œè€…æ¢³ç†çš„å¥½","likes_number":1,"is_delete":false,"is_hidden":false,"ctime":1612271940,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":1,"child_discussions":[{"author":{"id":1286672,"avatar":"https://static001.geekbang.org/account/avatar/00/13/a2/10/c2efb5ac.jpg","nickname":"å¼ é‡‘å¸…","note":"","ucode":"6A2A2B0226B287","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":1207153,"avatar":"","nickname":"liulei3","note":"","ucode":"C869F663AF4B42","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":365180,"discussion_content":"åŒæ„","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1617721495,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":347644,"ip_address":""},"score":365180,"extra":""}]},{"author":{"id":2029485,"avatar":"https://static001.geekbang.org/account/avatar/00/1e/f7/ad/4fd4d867.jpg","nickname":"æ•°å­¦æ±¤å®¶å‡¤","note":"","ucode":"DE84E777C384AD","race_medal":0,"user_type":1,"is_pvip":true},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":289959,"discussion_content":"mark","likes_number":1,"is_delete":false,"is_hidden":false,"ctime":1594281576,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":1,"child_discussions":[{"author":{"id":2057627,"avatar":"http://thirdwx.qlogo.cn/mmopen/vi_32/c38aFXkgKzcaEnz56Zyib5yE88NvzKrnYpJFTe9aodn0cXR2CwA1vs1sP7luwFHeSXuoJlreBtkq3YAFPlmibdibw/132","nickname":"Geek_9ad555","note":"","ucode":"50852723A22788","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":2029485,"avatar":"https://static001.geekbang.org/account/avatar/00/1e/f7/ad/4fd4d867.jpg","nickname":"æ•°å­¦æ±¤å®¶å‡¤","note":"","ucode":"DE84E777C384AD","race_medal":0,"user_type":1,"is_pvip":true},"discussion":{"id":290640,"discussion_content":"ä½ ä¹Ÿåœ¨å•Šï¼Œæ¶æ„ç¾¤çœ‹åˆ°ä½ äº†","likes_number":1,"is_delete":false,"is_hidden":false,"ctime":1594556193,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":289959,"ip_address":""},"score":290640,"extra":""}]},{"author":{"id":1196339,"avatar":"https://static001.geekbang.org/account/avatar/00/12/41/33/d1064f9a.jpg","nickname":"Sun","note":"","ucode":"1BC2741DC07FC5","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":198832,"discussion_content":"ä½ å¥½ï¼Œè¯·é—®æ˜¯åªæœ‰volatileè¿™ç§åº•å±‚ä½¿ç”¨å†…å­˜å±éšœï¼ˆjvmå±‚çº§ï¼‰å’ŒlockæŒ‡ä»¤ï¼ˆoså±‚çº§ï¼‰ï¼Œè¿˜æ˜¯æ‰€æœ‰çš„happens-beforeè§„åˆ™éƒ½ä½¿ç”¨å†…å­˜å±éšœå’ŒlockæŒ‡ä»¤æ¥ä¿è¯å¯è§æ€§å’Œæœ‰åºæ€§ï¼Ÿ","likes_number":1,"is_delete":false,"is_hidden":false,"ctime":1583516394,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":1,"child_discussions":[{"author":{"id":1440025,"avatar":"https://static001.geekbang.org/account/avatar/00/15/f9/19/7c3b12ee.jpg","nickname":"Geek_deb968","note":"","ucode":"2305597B009AF3","race_medal":0,"user_type":1,"is_pvip":true},"reply_author":{"id":1196339,"avatar":"https://static001.geekbang.org/account/avatar/00/12/41/33/d1064f9a.jpg","nickname":"Sun","note":"","ucode":"1BC2741DC07FC5","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":302167,"discussion_content":"å±éšœè¿™ä¸ªè¯çœŸå¥½","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1598803712,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":198832,"ip_address":""},"score":302167,"extra":""}]},{"author":{"id":1096652,"avatar":"https://static001.geekbang.org/account/avatar/00/10/bb/cc/fac12364.jpg","nickname":"xxx","note":"","ucode":"E79CEA70430449","race_medal":0,"user_type":1,"is_pvip":true},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":124185,"discussion_content":"happens before è¢«ä½ è¯‘ä¸º å…ˆè¡Œå‘ç”Ÿï¼Œè€Œè€å¸ˆè¯´çš„æ˜¯è¿™æ ·ç†è§£æœ‰é—®é¢˜ï¼Œåº”ç†è§£ä¸ºå‰è€…å¯¹åè€…å¯è§ã€‚","likes_number":1,"is_delete":false,"is_hidden":false,"ctime":1578411918,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":3,"extra":"","child_discussion_number":2,"child_discussions":[{"author":{"id":1206751,"avatar":"https://static001.geekbang.org/account/avatar/00/12/69/df/2dca1305.jpg","nickname":"Healtheon","note":"","ucode":"B564B1FC4456E8","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":1096652,"avatar":"https://static001.geekbang.org/account/avatar/00/10/bb/cc/fac12364.jpg","nickname":"xxx","note":"","ucode":"E79CEA70430449","race_medal":0,"user_type":1,"is_pvip":true},"discussion":{"id":134250,"discussion_content":"ä½ å†çœ‹çœ‹æ–‡ä¸­çš„æ€»ç»“éƒ¨åˆ†ã€‚ä¸åšäº‰è®ºï¼Œè‡ªå·±æ„Ÿæ‚Ÿå³å¯ã€‚","likes_number":1,"is_delete":false,"is_hidden":false,"ctime":1579013625,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":124185,"ip_address":""},"score":134250,"extra":""},{"author":{"id":2410444,"avatar":"https://static001.geekbang.org/account/avatar/00/24/c7/cc/92a3ef15.jpg","nickname":"æ¡”æ©˜æ©™è¾£ï¼Œ","note":"","ucode":"A0E5BE7852CA09","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":1096652,"avatar":"https://static001.geekbang.org/account/avatar/00/10/bb/cc/fac12364.jpg","nickname":"xxx","note":"","ucode":"E79CEA70430449","race_medal":0,"user_type":1,"is_pvip":true},"discussion":{"id":340998,"discussion_content":"æˆ‘è§‰å¾—ä¹Ÿæ˜¯ï¼Œè€å¸ˆè®²çš„è¿™ç§ï¼Œå‰é¢çš„æ“ä½œäº§ç”Ÿçš„å½±å“å¯¹åç»­æ“ä½œæ˜¯å¯è§çš„å¾ˆå¥½ç†è§£ï¼Œè¯´æˆå…ˆè¡Œå‘ç”Ÿæ˜¯æœ‰é—®é¢˜çš„ï¼Œhappens-beforeè§£å†³çš„é—®é¢˜å°±æ˜¯æœ‰åºæ€§å’Œå¯è§æ€§ï¼Œå¹¶ä¸æ˜¯å¼ºè°ƒå‘ç”Ÿçš„å…ˆåé¡ºåºï¼Œè€Œæ˜¯æ“ä½œç»“æœçš„å½±å“","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1610255811,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":124185,"ip_address":""},"score":340998,"extra":""}]},{"author":{"id":1111870,"avatar":"http://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTK2Az5uTh9ZGVA7yQCj1BXtXuicPRkvJicA97AoN9xX3bnPcUYglTMXJeZeoVbPQeJA7ICvQhR3KQ0w/132","nickname":"æ—¥ä¸è½å¸å›½","note":"","ucode":"6A11ABBD8AC438","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":5493,"discussion_content":"æ€»ç»“çš„çœŸæ£’ï¼Œå­¦ä¹ äº†","likes_number":1,"is_delete":false,"is_hidden":false,"ctime":1566305513,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":3,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1392431,"avatar":"https://static001.geekbang.org/account/avatar/00/15/3f/2f/8513c4d3.jpg","nickname":"a(à¹‘â‰–à¸´Ù¼â‰–à¸´)âœŒ","note":"","ucode":"AEF9B5CA1605DF","race_medal":1,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":365,"discussion_content":"ä½ çš„ç¬¬å››æ¡çº¿ç¨‹å¯åŠ¨è§„åˆ™å’Œè€å¸ˆçš„çº¿ç¨‹startè§„åˆ™è®²çš„å®Œå…¨ä¸ä¸€æ ·ï¼Œè€å¸ˆçš„joinè§„åˆ™ä½ æ€»ç»“çš„é‡Œé¢æ²¡æœ‰ï¼Œä¸ºä»€ä¹ˆï¼Ÿ","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1561491175,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":3,"extra":"","child_discussion_number":1,"child_discussions":[{"author":{"id":1282575,"avatar":"https://static001.geekbang.org/account/avatar/00/13/92/0f/cff30522.jpg","nickname":"æ±Ÿæ¹–å¤œé›¨","note":"","ucode":"C64913C7000899","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":1392431,"avatar":"https://static001.geekbang.org/account/avatar/00/15/3f/2f/8513c4d3.jpg","nickname":"a(à¹‘â‰–à¸´Ù¼â‰–à¸´)âœŒ","note":"","ucode":"AEF9B5CA1605DF","race_medal":1,"user_type":1,"is_pvip":false},"discussion":{"id":2336,"discussion_content":"è¿™ä¹ˆç†è§£ï¼ŒA.startä¹‹å‰æ“ä½œåœ¨Bçº¿ç¨‹ä¸­å¯è§","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1563496612,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":365,"ip_address":""},"score":2336,"extra":""}]},{"author":{"id":2459923,"avatar":"https://static001.geekbang.org/account/avatar/00/25/89/13/0d3c5008.jpg","nickname":"æœ€å¥½ä¸è¿‡","note":"","ucode":"C7DBCD08402DF8","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":387567,"discussion_content":"å…ˆåå‘ç”Ÿé¡ºåºæœ‰é—®é¢˜ï¼Œè¿˜æ˜¯è€å¸ˆè®²çš„å‰é¢çš„æ“ä½œå¯¹åé¢å¯è§è¿™ä¸ªå‡†ç¡®","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1628256252,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":3,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":2637531,"avatar":"https://static001.geekbang.org/account/avatar/00/28/3e/db/a6478127.jpg","nickname":"æ— é—®è¥¿ä¸œ","note":"","ucode":"905A4CBF0AC944","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":379215,"discussion_content":"javaå†…å­˜æ¨¡å‹ CY","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1623757341,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":3,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1108018,"avatar":"https://static001.geekbang.org/account/avatar/00/10/e8/32/f44f163e.jpg","nickname":"æµ·æ¶›","note":"","ucode":"02B0E09EE84868","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":378534,"discussion_content":"å­¦ä¹ ","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1623279505,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":3,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1167120,"avatar":"https://static001.geekbang.org/account/avatar/00/11/cf/10/9fa2e5ba.jpg","nickname":"è¿›å‡»çš„å·¨äºº","note":"","ucode":"DB62D77D460BF1","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":345530,"discussion_content":"ç¨‹åºæ¬¡åºè§„åˆ™ï¼šåœ¨ä¸€ä¸ªçº¿ç¨‹å†…ï¼ŒæŒ‰ç…§ç¨‹åºä»£ç é¡ºåºï¼Œä¹¦å†™åœ¨å‰é¢çš„æ“ä½œå…ˆè¡Œå‘ç”Ÿäºä¹¦å†™åœ¨åé¢çš„æ“ä½œã€‚è¿™å¥è¯çš„å‡†ç¡®æ€§æœ‰å¾…å•†æ¦·","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1611735959,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":3,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1136480,"avatar":"https://static001.geekbang.org/account/avatar/00/11/57/60/65b006a6.jpg","nickname":"Chief","note":"","ucode":"CAFB24CBA215A8","race_medal":0,"user_type":1,"is_pvip":true},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":341158,"discussion_content":"mark","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1610333309,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":3,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1120997,"avatar":"https://static001.geekbang.org/account/avatar/00/11/1a/e5/6899701e.jpg","nickname":"favorlm","note":"","ucode":"CFD52127AA6E1D","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":340123,"discussion_content":"mark","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1609908409,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":3,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":2067031,"avatar":"http://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTIGGBhiaUAJpeBxmzQCVrSiboPfwUSTOzcibaokLuxtG0IuibIH8ED6nK8Heicm0L7GI1W6W7SU0S0FwOg/132","nickname":"ç‚éœ","note":"","ucode":"D77DDEF3DA68B7","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":296907,"discussion_content":"markä¸€ä¸‹","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1596702417,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":3,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1810576,"avatar":"https://wx.qlogo.cn/mmopen/vi_32/eLNeJNaEkwGSK7xvtamMibVLMy2MpbIqX3iaEhT7JtSnTRMRTwZ2j4HX7WAapiashbiaBDVriaXKSP0Oeic6ZAEVEXag/132","nickname":"M","note":"","ucode":"06F26E1D62E9C9","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":214578,"discussion_content":"ä½ å­—å¤šï¼Œå‰å®³å¤§ä½¬","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1585210384,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":4,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1125986,"avatar":"https://static001.geekbang.org/account/avatar/00/11/2e/62/ea49480e.jpg","nickname":"Zain Zhu","note":"","ucode":"5402E6FF76333A","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":211511,"discussion_content":"å‰å®³å•Šï¼è¿™äº›çŸ¥è¯†åœ¨ä»€ä¹ˆç±»å‹çš„å·¥ä½œä¸­ä¼šç»å¸¸ç”¨åˆ°å‘¢ï¼Ÿå¦‚æœä¸€èˆ¬å·¥ä½œä¸­ä¸ä¼šç›´æ¥æ¶‰åŠåˆ°ï¼Œé‚£è‡ªå·±å­¦ä¹ çš„è¯è¦ä»¥ä»€ä¹ˆæ ·çš„æ–¹å¼å»ç»ƒä¹ å·©å›ºå‘¢ï¼Ÿ","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1584859844,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":4,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1338584,"avatar":"https://static001.geekbang.org/account/avatar/00/14/6c/d8/68fec932.jpg","nickname":"èŠ±èŠ±young","note":"","ucode":"95AD30303C2B21","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":63774,"discussion_content":"66666","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1574909159,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":4,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1156592,"avatar":"https://static001.geekbang.org/account/avatar/00/11/a5/f0/8648c464.jpg","nickname":"Joker","note":"","ucode":"126AF848001A1E","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":33658,"discussion_content":"å‰å®³å‰å®³ï¼Œè°¢è°¢","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1571139729,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":4,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":71882,"user_name":"senekis","can_delete":false,"product_type":"c1","uid":1446025,"ip_address":"","ucode":"CD88681F0278FD","user_header":"http://thirdwx.qlogo.cn/mmopen/vi_32/DYAIOgq83erTlRJ6skf7iawAeqNfIT1PPgjD7swUdRIRkX1iczjj97GNrxnsnn3QuOhkVbCLgFYAm7sMZficNTSbA/132","comment_is_top":false,"comment_ctime":1551460297,"is_pvip":true,"replies":[{"id":"26082","content":"è¿™ä¸‰ç§æ–¹å¼éƒ½æ­£ç¡®ï¼Œç†è§£çš„ä¸é”™ï¼","user_name":"ä½œè€…å›å¤","comment_id":71882,"uid":"1269969","ip_address":"","utype":1,"ctime":1551519783,"user_name_real":"ç‹å®ä»¤"}],"discussion_count":10,"race_medal":0,"score":"929264396233","product_id":100023901,"comment_content":"<br>æˆ‘æ€è€ƒä¸‹è®¤ä¸ºæœ‰ä¸‰ç§æ–¹å¼å¯ä»¥å®ç°:<br>1.å£°æ˜å…±äº«å˜é‡abcï¼Œå¹¶ä½¿ç”¨volatileå…³é”®å­—ä¿®é¥°abc<br>2.å£°æ˜å…±äº«å˜é‡abcï¼Œåœ¨synchronizedå…³é”®å­—å¯¹abcçš„èµ‹å€¼ä»£ç å—åŠ é”ï¼Œç”±äºHappen-beforeç®¡ç¨‹é”çš„è§„åˆ™ï¼Œå¯ä»¥ä½¿å¾—åç»­çš„çº¿ç¨‹å¯ä»¥çœ‹åˆ°abcçš„å€¼ã€‚<br>3.Açº¿ç¨‹å¯åŠ¨åï¼Œä½¿ç”¨A.JOIN()æ–¹æ³•æ¥å®Œæˆè¿è¡Œï¼Œåç»­çº¿ç¨‹å†å¯åŠ¨ï¼Œåˆ™ä¸€å®šå¯ä»¥çœ‹åˆ°abc==3<br><br>å¦‚æœ‰é”™è¯¯ï¼Œè¯·ç»™æŒ‡å‡ºé”™è¯¯æ‰€åœ¨ï¼è°¢è°¢å¤§å®¶ï¼è°¢è°¢è€å¸ˆï¼<br><br>å¬è¯¾åæ„Ÿè§‰å¯¹æˆ‘å¸®åŠ©å¥½å¤§ï¼Œä»¥å‰é›¶ç¢çš„çŸ¥è¯†è¢«é‡æ–°ç³»ç»Ÿçš„æ•´ç†ã€‚é”™è¯¯çš„ç†è§£ä¹Ÿå¾—åˆ°ä¿®æ­£ï¼Œæ„Ÿè°¢è€å¸ˆï¼","like_count":216,"discussions":[{"author":{"id":1269969,"avatar":"https://static001.geekbang.org/account/avatar/00/13/60/d1/8efa89ab.jpg","nickname":"ç‹å®ä»¤","note":"","ucode":"4FE19F5BC32FCA","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":441376,"discussion_content":"è¿™ä¸‰ç§æ–¹å¼éƒ½æ­£ç¡®ï¼Œç†è§£çš„ä¸é”™ï¼","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1551519783,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1227252,"avatar":"https://static001.geekbang.org/account/avatar/00/12/b9/f4/cc519a9f.jpg","nickname":"ãŠé‡‘ğŸ’ª","note":"","ucode":"210C44553ABFDF","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":304914,"discussion_content":"ç¬¬äºŒç‚¹ä¸å¯¹å§ï¼Œå¯¹abcèµ‹å€¼çš„çº¿ç¨‹ä»£ç å—åŠ é”ï¼Œå…¶ä»–çº¿ç¨‹è¯»çš„æ—¶å€™è¿˜æ˜¯å¾—ä¸åˆ°æœ€æ–°å€¼ï¼Œé”è§„åˆ™åº”è¯¥é’ˆå¯¹çš„æ˜¯åŒä¸€ä¸ªä»£ç ï¼ŒåŒä¸€ä¸ªä»£ç å¤šä¸ªä¸åŒçº¿ç¨‹æ‰§è¡Œæ—¶çš„Happends-Beforeè§„åˆ™ã€‚\næ¯”å¦‚ï¼š\npublic class HappensBeforeMain {\n\n    private static int num = 0;\n\n    public static void main(String[] args) throws Exception {\n        CountDownLatch cdl = new CountDownLatch(2);\n        new Thread(() -> {\n            while (num != 3)\n                ;\n            cdl.countDown();\n        }).start();\n\n        Thread.sleep(500);\n\n        new Thread(() -> {\n            synchronized (HappensBeforeMain.class) {\n                num = 3;\n            }\n            cdl.countDown();\n        }).start();\n\n        cdl.await();\n    }\n\n}\nè¿™ç§æ–¹å¼ç¬¬ä¸€ä¸ªçº¿ç¨‹ä¾ç„¶è¯»å–ä¸åˆ°num = 3çš„æ“ä½œç»“æœã€‚\n\n\npublic class HappensBeforeMain {\n\n    private static int num = 0;\n\n    public static void main(String[] args) throws Exception {\n        CountDownLatch cdl = new CountDownLatch(2);\n        new Thread(() -> {\n            while (num != 3) {\n                synchronized (HappensBeforeMain.class) {\n                }\n            }\n            cdl.countDown();\n        }).start();\n\n        Thread.sleep(500);\n\n        new Thread(() -> {\n            num = 3;\n            cdl.countDown();\n        }).start();\n\n        cdl.await();\n    }\n\n}\n\nåªæœ‰åœ¨è¯»çš„å¾ªç¯æ“ä½œé‡ŒåŠ ä¸Šé”ï¼Œä¹‹å‰å…¶ä»–çº¿ç¨‹çš„æ“ä½œï¼Œåœ¨å¾ªç¯é‡Œé‡æ–°è·å–é”æ—¶ï¼Œæ‰æ˜¯å¯è§çš„ã€‚","likes_number":10,"is_delete":false,"is_hidden":false,"ctime":1599710197,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":1,"child_discussions":[{"author":{"id":2076251,"avatar":"https://static001.geekbang.org/account/avatar/00/1f/ae/5b/4bd42286.jpg","nickname":"å®‹è®¡æ´‹","note":"","ucode":"9A34E8F71C6CBD","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":1227252,"avatar":"https://static001.geekbang.org/account/avatar/00/12/b9/f4/cc519a9f.jpg","nickname":"ãŠé‡‘ğŸ’ª","note":"","ucode":"210C44553ABFDF","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":567274,"discussion_content":"è¿™ä¸ªç¡®å®å¥½ç¥å¥‡å‘€ï¼Œå¯ä»¥ç†è§£ä¸ºåœ¨è¯»çš„æ—¶å€™ä½¿ç”¨synchronizedä¼šåˆ·æ–°ç¼“å­˜å—ï¼Ÿæˆ‘ä½¿ç”¨System.out.println()ä¹Ÿå¯ä»¥è·å–åˆ°æ–°å€¼ï¼Œå› ä¸ºå†…éƒ¨ä¹ŸåŒ…å«synchronized","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1650873135,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":304914,"ip_address":""},"score":567274,"extra":""}]},{"author":{"id":1119991,"avatar":"https://static001.geekbang.org/account/avatar/00/11/16/f7/43253c3f.jpg","nickname":"ç§‹æ—","note":"","ucode":"22E0CBC3665AE4","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":185306,"discussion_content":"ç¬¬2ç§æ–¹å¼ï¼Œæ˜¯ä¸æ˜¯è¯»çš„ä»£ç å—ä¹Ÿè¦åŠ é”æ‰è¡Œï¼Ÿ","likes_number":10,"is_delete":false,"is_hidden":false,"ctime":1582614325,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1703832,"avatar":"https://static001.geekbang.org/account/avatar/00/19/ff/98/a9a68fc6.jpg","nickname":"NaNğŸƒ","note":"","ucode":"69D6A99871A6FE","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":54887,"discussion_content":" start()","likes_number":2,"is_delete":false,"is_hidden":false,"ctime":1574322026,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1341612,"avatar":"https://static001.geekbang.org/account/avatar/00/14/78/ac/e5e6e7f3.jpg","nickname":"å¤å¤œ","note":"","ucode":"0A82D3CFCEDF07","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":3520,"discussion_content":"åˆ©ç”¨ä¼ é€’æ€§ä¹Ÿå¯ä»¥å•Š","likes_number":2,"is_delete":false,"is_hidden":false,"ctime":1564550303,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1645430,"avatar":"http://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTKiauonyMORA2s43W7mogGDH4WYjW0gBJtYmUa9icTB6aMPGqibicEKlLoQmLKLWEctwHzthbTZkKR20w/132","nickname":"Spring4J","note":"","ucode":"06F056085A2564","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":533642,"discussion_content":"è¿™ä¹ˆå¤šäººè¯´ç¬¬äºŒç§æ–¹å¼æœ‰é—®é¢˜ï¼Œæ˜¯ä½ ä»¬æ²¡ç†è§£æ­£ç¡®å¥½å§ã€‚äººå®¶è¿™é‡Œå°±åªæœ‰èµ‹å€¼ä¸€ä¸ªä»£ç å—åŠ é”è€Œå·²ï¼Œå“ªé‡Œæ¥çš„ä»€ä¹ˆè¯»æ•°æ®çš„ä»£ç ï¼Ÿä¸Šä¸€ä¸ªçº¿ç¨‹åŠ é”ä¿®æ”¹åï¼Œä¸‹ä¸€ä¸ªçº¿ç¨‹åŠ é”è¿›æ¥å†ä¿®æ”¹ï¼Œå¯ä¸å¾—å…ˆæŠŠæ•°æ®ä»å†…å­˜ä¸­è¯»åˆ°CPUç¼“å­˜å—ï¼Ÿè¯»çš„æ—¶å€™ä¸å°±è¯»åˆ°ä¸Šä¸€ä¸ªçº¿ç¨‹è§£é”åäº§ç”Ÿçš„ç»“æœäº†å—ï¼Ÿ","likes_number":1,"is_delete":false,"is_hidden":false,"ctime":1637922246,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1980201,"avatar":"https://static001.geekbang.org/account/avatar/00/1e/37/29/b3af57a7.jpg","nickname":"å‡¯æ–‡å°çŒª","note":"","ucode":"36D8AD0229547F","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":532982,"discussion_content":"ä¸ªäººè®¤ä¸ºåŠ finalä¹Ÿæ˜¯å¯ä»¥çš„ å› ä¸ºJSR133é‡Œæ˜ç¡®è¯´äº†ä¸ªåœºæ™¯Stringçš„charæ•°ç»„å°±æ˜¯åˆ©ç”¨è¿™ä¸ªç‰¹æ€§è®©æ‰€æœ‰çº¿ç¨‹å¯è§","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1637746160,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"user_type\":1}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":2028945,"avatar":"","nickname":"Geek5198","note":"","ucode":"2BEBE6A39D9A0E","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":405948,"discussion_content":"å‰å®³ğŸ‘","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1634660391,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":2329635,"avatar":"https://static001.geekbang.org/account/avatar/00/23/8c/23/f1c5bee0.jpg","nickname":"wang.yu","note":"","ucode":"CCA775784B3EB3","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":382768,"discussion_content":"æˆ‘è®¤ä¸ºç¬¬äºŒç§æ–¹å¼éœ€è¦åœ¨è¯»çš„çº¿ç¨‹é‡Œä¹ŸåŠ é”æ‰å¯ä»¥","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1625715684,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":72204,"user_name":"å°å’Œå°šç¬¨å—åŒ—","can_delete":false,"product_type":"c1","uid":1204628,"ip_address":"","ucode":"17C9BBB6DD25D2","user_header":"https://static001.geekbang.org/account/avatar/00/12/61/94/713b38ef.jpg","comment_is_top":false,"comment_ctime":1551534140,"is_pvip":false,"replies":[{"id":"26189","content":"è¿™ä¸ªæˆ‘ç§°ä¸ºç‚«æŠ€ï¼","user_name":"ä½œè€…å›å¤","comment_id":72204,"uid":"1269969","ip_address":"","utype":1,"ctime":1551584274,"user_name_real":"ç‹å®ä»¤"}],"discussion_count":10,"race_medal":0,"score":"491177805884","product_id":100023901,"comment_content":"è¡¥å……ä¸€ä¸ªï¼š åœ¨abcèµ‹å€¼åå¯¹ä¸€ä¸ªvolatileå˜é‡Aè¿›è¡Œèµ‹å€¼æ“ä½œï¼Œç„¶ååœ¨å…¶ä»–çº¿ç¨‹è¯»å–abcä¹‹å‰è¯»å–Açš„å€¼ï¼Œé€šè¿‡volatileçš„å¯è§æ€§å’Œhappen-beforeçš„ä¼ é€’æ€§å®ç°abcä¿®æ”¹åå¯¹å…¶ä»–çº¿ç¨‹ç«‹å³å¯è§","like_count":114,"discussions":[{"author":{"id":1181055,"avatar":"https://static001.geekbang.org/account/avatar/00/12/05/7f/d35ab9a1.jpg","nickname":"z.l","note":"","ucode":"805CC5784D3F76","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":626,"discussion_content":"è¿™ä¸ªæ–¹æ¡ˆæ˜¯ä¸æ˜¯ç¼ºäº†ä¸€ä¸ªæ¡ä»¶ï¼šå…¶ä»–çº¿ç¨‹è¯»å–Açš„æ“ä½œå¿…é¡»å‘ç”Ÿåœ¨å½“å‰çº¿ç¨‹ç»™Aèµ‹å€¼çš„æ“ä½œä¹‹å","likes_number":8,"is_delete":false,"is_hidden":false,"ctime":1561822107,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":1,"child_discussions":[{"author":{"id":1920896,"avatar":"https://static001.geekbang.org/account/avatar/00/1d/4f/80/19f946ba.jpg","nickname":"Zain","note":"","ucode":"03EDF7B1BE9CF8","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":1181055,"avatar":"https://static001.geekbang.org/account/avatar/00/12/05/7f/d35ab9a1.jpg","nickname":"z.l","note":"","ucode":"805CC5784D3F76","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":374401,"discussion_content":"z.lè¯´çš„å¾ˆå¯¹ï¼Œè¿™é‡Œçœ‹ä¸åˆ°æœ‰ä¸¤ä¸ªåŸå› ï¼Œä¸€å¯èƒ½æ˜¯å› ä¸ºçº¿ç¨‹æ”¹äº†abcä½†æ˜¯æ²¡åˆ·æ–°åˆ°ç¼“å­˜ä¸­ï¼Œä½†æˆ‘æ„Ÿè§‰è¿™ä¸ªæ—¶é—´æ˜¯éå¸¸çŸ­çš„ï¼Œæˆ‘åšå®éªŒæ²¡æµ‹è¯•å‡ºæ¥ï¼ŒäºŒæ˜¯å¯èƒ½å› ä¸ºçº¿ç¨‹æœ¬èº«å°±è¿˜æ²¡è¿›è¡Œèµ‹å€¼abc=3ã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1621165311,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":626,"ip_address":""},"score":374401,"extra":""}]},{"author":{"id":1639787,"avatar":"https://static001.geekbang.org/account/avatar/00/19/05/6b/d9d6d68b.jpg","nickname":"Vettel","note":"","ucode":"FB3E71DD1E8E7C","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":35706,"discussion_content":"è¿™ä¸ªä¸å°±æ˜¯è€å¸ˆæåˆ°çš„ä¾‹å­å˜›  ä½†ä½ å¾—ä¿è¯è¯»å–Açš„æ“ä½œå‘ç”Ÿåœ¨èµ‹å€¼ä¹‹å","likes_number":3,"is_delete":false,"is_hidden":false,"ctime":1571299429,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":1,"child_discussions":[{"author":{"id":1683130,"avatar":"http://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTLWIUF31dicT1YBTxWNX0uvbMxl15UwdlwFicGhNo0DsQ7CbM6k16EQxK7bwSMcicLGMdYto4jGPTvrg/132","nickname":"ä¹¾å¤ç¬é—´","note":"","ucode":"15BDCF29CBF8EB","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":1639787,"avatar":"https://static001.geekbang.org/account/avatar/00/19/05/6b/d9d6d68b.jpg","nickname":"Vettel","note":"","ucode":"FB3E71DD1E8E7C","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":98115,"discussion_content":"æˆ‘è§‰å¾—å¯è§æ€§éšè—çš„å«ä¹‰å°±æ˜¯è¯»çš„æ—¶é—´å°±æ˜¯è¦åœ¨å†™æ—¶é—´ä¹‹å","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1577144449,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":35706,"ip_address":""},"score":98115,"extra":""}]},{"author":{"id":1269969,"avatar":"https://static001.geekbang.org/account/avatar/00/13/60/d1/8efa89ab.jpg","nickname":"ç‹å®ä»¤","note":"","ucode":"4FE19F5BC32FCA","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":441493,"discussion_content":"è¿™ä¸ªæˆ‘ç§°ä¸ºç‚«æŠ€ï¼","likes_number":2,"is_delete":false,"is_hidden":false,"ctime":1551584274,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1768332,"avatar":"https://thirdwx.qlogo.cn/mmopen/vi_32/DYAIOgq83epmeqHLQOicylub5ry45OWrmELHA9IqtFMcLE2fmI6kaOiayghg2qZ8lxmWwXPPPouNyn1Rr9KRl3OQ/132","nickname":"Geek_a06702","note":"","ucode":"F210AA49980B25","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":387681,"discussion_content":"é‚£æˆ‘ä¸ºä»€ä¹ˆä¸ç›´æ¥ä½¿ç”¨volatileå…³é”®å­—ä¿®é¥°abcå‘¢ï¼Œè¿™æ ·åšæœ‰ä»€ä¹ˆä¼˜ç‚¹å—","likes_number":1,"is_delete":false,"is_hidden":false,"ctime":1628340940,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1392431,"avatar":"https://static001.geekbang.org/account/avatar/00/15/3f/2f/8513c4d3.jpg","nickname":"a(à¹‘â‰–à¸´Ù¼â‰–à¸´)âœŒ","note":"","ucode":"AEF9B5CA1605DF","race_medal":1,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":281646,"discussion_content":"ä½ åå­—æ˜¯ä¸æ˜¯é›ªä¸­æ‚åˆ€è¡Œé‡Œæ¥çš„å•Š","likes_number":1,"is_delete":false,"is_hidden":false,"ctime":1591783179,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1386201,"avatar":"https://static001.geekbang.org/account/avatar/00/15/26/d9/f7e96590.jpg","nickname":"yes","note":"","ucode":"612BF6884ED6CC","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":2038,"discussion_content":"å°å§‘å¨˜æä¸œè¥¿","likes_number":1,"is_delete":false,"is_hidden":false,"ctime":1563194362,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":2709634,"avatar":"https://static001.geekbang.org/account/avatar/00/29/58/82/f186a477.jpg","nickname":"ä½æ™º","note":"","ucode":"493638FC1AF876","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":547722,"discussion_content":"ä¸€èˆ¬ä¸ä¼šè¿™ä¹ˆå†™å§ï¼Œè¿™ä¸ªè¿˜æ˜¯è¦ä»è®¾è®¡çº¿ç¨‹å®‰å…¨çš„ç±»çš„è§„èŒƒå‡ºå‘ï¼Œè¿™ä¸ªabcé€¸å‡ºäº†","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1642838516,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1031181,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/bc/0d/00424e81.jpg","nickname":"åˆ°é“å¯é“","note":"","ucode":"12B94B6C26BE0D","race_medal":1,"user_type":1,"is_pvip":true},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":391247,"discussion_content":"æ´»å­¦æ´»ç”¨","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1630371530,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":72456,"user_name":"Junzi","can_delete":false,"product_type":"c1","uid":1004612,"ip_address":"","ucode":"4AC663769C1873","user_header":"https://static001.geekbang.org/account/avatar/00/0f/54/44/4e541a86.jpg","comment_is_top":false,"comment_ctime":1551630896,"is_pvip":false,"discussion_count":30,"race_medal":0,"score":"366623851056","product_id":100023901,"comment_content":"å‚è€ƒ1ä¸­write()æ–¹æ³•ä»£ç ï¼š<br>x=45;  &#47;&#47; 1<br>v=true;  &#47;&#47; 2<br>è¿™ä¸¤è¡Œä¼šä¸ä¼šå¯¼è‡´æŒ‡ä»¤é‡æ’ï¼Ÿ<br><br>å› ä¸ºvolatileå…³é”®å­—åº”è¯¥åªä¿è¯äº†å˜é‡vçš„å¯è§æ€§ï¼Œhappen-beforeç¬¬ä¸€æ¡åŸåˆ™åœ¨å•çº¿ç¨‹ä¸­ï¼Œ1ä¸2é‡æ’å¹¶ä¸å½±å“ç»“æœï¼Œé‚£åº”è¯¥æœ‰å¯èƒ½å‡ºç°é‡æ’çš„æƒ…å†µï¼Œè¿™æ ·çº¿ç¨‹Bè¯»å–åˆ°read()çš„æ—¶å€™ä¹Ÿæœ‰å¯èƒ½å‡ºç°x=0ã€‚è¿˜è¯·è€å¸ˆè§£ç­”ã€‚","like_count":85,"discussions":[{"author":{"id":1004342,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/53/36/2c449c71.jpg","nickname":"å¶ç‰æ—","note":"","ucode":"C72E88613DB992","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":48013,"discussion_content":"volatileä¿®é¥°çš„å­—æ®µåœ¨æ±‡ç¼–åä¼šæœ‰ä¸€ä¸ªlockçš„æŒ‡ä»¤ï¼Œè¿™ä¸ªæŒ‡ä»¤ç®€å•æ¥è¯´åšåˆ°ä¸¤ä»¶äº‹ï¼Œ1ï¼šä¿®æ”¹åï¼Œå…¶ä»–CPUç«‹å³å¯è§ï¼Œ2ï¼šä¸å…è®¸lockä¹‹å‰çš„æŒ‡ä»¤é‡æ’åºåˆ°lockåé¢","likes_number":32,"is_delete":false,"is_hidden":false,"ctime":1573441712,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1034451,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/c8/d3/3020ae46.jpg","nickname":"fatme","note":"","ucode":"75A805D2BB2AD1","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":332293,"discussion_content":"è¯¾æ–‡å·²ç»è¯´æ¸…æ¥šäº†ï¼Œç¨‹åºé¡ºåºæ€§è§„åˆ™ã€volatile å˜é‡è§„åˆ™ã€ä¼ é€’æ€§è¿™ 3 æ¡è§„åˆ™ï¼Œå…±åŒé™å®šäº†èŒƒä¾‹ç¨‹åºé‡Œé¢ï¼Œå½“çº¿ç¨‹ B è§åˆ° v ä¸º true çš„æ—¶å€™ï¼Œå®ƒä¹Ÿè¦èƒ½è§åˆ° x æ­£ç¡®çš„å€¼(åŸæ–‡å€¼ä¸º 42, æ¥¼ä¸»å¸–å­æ˜¯ 45)ã€‚æ¥¼ä¸»çš„ç–‘é—®æ˜¯ï¼š1. èŒƒä¾‹ç¨‹åºä¼šä¸ä¼šæœ‰æŒ‡ä»¤é‡æ’çš„ç¼–è¯‘ä¼˜åŒ–?  2. å¦‚æœä¸èƒ½æœ‰æŒ‡ä»¤é‡æ’ï¼Œæ˜¯ç”±ä»€ä¹ˆè§„åˆ™å†³å®šçš„ï¼Ÿå¦‚æœæœ‰æŒ‡ä»¤é‡æ’ï¼Œçº¿ç¨‹ B ä¸ºä»€ä¹ˆèƒ½çœ‹åˆ°æ­£ç¡®çš„ x å€¼ï¼Ÿ\n\næˆ‘çš„ç†è§£å¦‚ä¸‹ï¼š\n\n1. èŒƒä¾‹ç¨‹åºä¸ä¼šæœ‰æŒ‡ä»¤é‡æ’ï¼Œè€Œä¸”è¿™å°±æ˜¯ç”± ç¨‹åºé¡ºåºæ€§è§„åˆ™ã€volatile å˜é‡è§„åˆ™ã€ä¼ é€’æ€§ è¿™ 3 æ¡è§„åˆ™å…±åŒå†³å®šçš„\n\n2. é‚£ä¹ˆå¦‚ä½•ç†è§£ä¸Šè¿° 3 æ¡ happens-before è§„åˆ™å…±åŒç¦æ­¢äº†èŒƒä¾‹ç¨‹åºçš„æŒ‡ä»¤é‡æ’å‘¢ï¼Ÿæœ‰è¿™ä¸ªç–‘é—®çš„åŒå­¦ï¼Œå¾€å¾€æ˜¯æ²¡æœ‰å®Œå…¨ç†è§£ ç¨‹åºé¡ºåºæ€§è§„åˆ™ çš„å«ä¹‰ã€‚è¿™æ¡è§„åˆ™é€šä¿—åœ°è¯´ï¼Œå°±æ˜¯åŒä¸€çº¿ç¨‹å†…ï¼Œç¼–è¯‘åæ•°æ®çš„å¯è§æ€§æ˜¯è¦ç¬¦åˆæºç¨‹åºè¦è¡¨è¾¾çš„é€»è¾‘é¡ºåºå’Œè¯­ä¹‰çš„ã€‚ä¹Ÿå°±æ˜¯ï¼Œå¯¹äºå•çº¿ç¨‹ï¼Œç¼–è¯‘åçš„ä»£ç ï¼Œè¦ä¿è¯ç¬¦åˆç¨‹åºå‘˜é¢„æœŸçš„ç»“æœã€‚åªè¦è¾¾åˆ°è¿™ä¸ªç›®æ ‡ï¼Œç¼–è¯‘å™¨å¯ä»¥åšä»»ä½•å®ƒè®¤ä¸ºå¿…è¦çš„ä¼˜åŒ–ã€‚æ‰€ä»¥ï¼Œå¦‚æœåªè€ƒè™‘å•çº¿ç¨‹ï¼ŒèŒƒä¾‹ä»£ç æ˜¯å¯ä»¥è¢«ç¼–è¯‘å™¨è¿›è¡ŒæŒ‡ä»¤é‡æ’ä¼˜åŒ–çš„ã€‚å› ä¸ºè¿™ä¸¤ä¸ªç´§é‚»çš„å˜é‡çš„èµ‹å€¼è¯­å¥ï¼Œä¸å­˜åœ¨ä¾èµ–å…³ç³»ã€‚æŠŠå®ƒä»¬çš„é¡ºåºå¯¹è°ƒï¼Œä¸å½±å“ç¨‹åºçš„è¯­ä¹‰å’Œç»“æœã€‚\n\n3. ä¸Šé¢è¯´æ˜äº†ï¼Œç¨‹åºé¡ºåºæ€§è§„åˆ™æ˜¯é’ˆå¯¹å•çº¿ç¨‹çš„ã€‚å¦‚æœåªè€ƒè™‘å•çº¿ç¨‹ï¼Œé‚£ä¹ˆç¼–è¯‘å™¨å¯ä»¥å¯¹èŒƒä¾‹ä»£ç å°±è¡ŒæŒ‡ä»¤é‡æ’ä¼˜åŒ–ã€‚ä½†æ˜¯å¯¹äºå¤šçº¿ç¨‹ï¼Œvolatile å˜é‡è§„åˆ™ã€ä¼ é€’æ€§è¿™ 2 æ¡è§„åˆ™ï¼Œå°±é™„åŠ äº†æ–°çš„é™åˆ¶ã€‚ç”±è¯¾æ–‡å¯çŸ¥é“ï¼Œå¯¹äºå¤šçº¿ç¨‹ï¼Œè¿™ 3 æ¡ happens-before è§„åˆ™è¦æ±‚ï¼Œçº¿ç¨‹ B åœ¨è¯»åˆ° v = true çš„æ—¶å€™ï¼Œä¹Ÿèƒ½è§åˆ° x = 42ã€‚å¦‚æœç¼–è¯‘å™¨ä»ç„¶æŒ‰ç…§å•çº¿ç¨‹çš„æƒ…å†µï¼Œå¯¹è¿™ä¸¤æ¡è¯­å¥è¿›è¡ŒæŒ‡ä»¤é‡æ’ï¼ŒæŠŠ v = true æ”¾åˆ° x = 42 ä¹‹å‰ã€‚é‚£ä¹ˆï¼Œçº¿ç¨‹ B å°±æœ‰å¯èƒ½çœ‹ä¸åˆ° x çš„å€¼ä¸º 42ã€‚è¿™æ˜¾ç„¶è¿èƒŒäº† happens-before çš„è§„å®šã€‚ç¼–è¯‘å™¨ä¸ºäº†ç¬¦åˆè§„åˆ™ï¼Œåªèƒ½ä¸è¿›è¡ŒæŒ‡ä»¤é‡æ’ä¼˜åŒ–äº†ã€‚\n\n4. ä¸Šé¢è¯´åˆ°ï¼Œä¸ºäº†ç¬¦åˆ happens-before è§„å®šï¼Œå¯¹äºç¤ºä¾‹ä»£ç ï¼Œç¼–è¯‘å™¨ä¸èƒ½è¿›è¡ŒæŒ‡ä»¤é‡æ’çš„ç¼–è¯‘ä¼˜åŒ–ã€‚ä½†å®é™…ä¸Šï¼Œä»…ä»…ä¸è¿›è¡ŒæŒ‡ä»¤é‡æ’ç¼–è¯‘ä¼˜åŒ–ï¼Œå¹¶ä¸èƒ½ä¿è¯ç¼–è¯‘åçš„ä»£ç çš„æ‰§è¡Œç»“æœï¼Œç¬¦åˆ happnes-before è§„å®šã€‚å› ä¸ºæŒ‡ä»¤é‡æ’è¿™ä¸€ä¼˜åŒ–æªæ–½ï¼Œå¹¶ä¸ä»…ä»…æ˜¯ç¼–è¯‘å™¨ä¼šåšã€‚ç°ä»£ cpu åœ¨æ‰§è¡Œæœºå™¨æŒ‡ä»¤çš„æ—¶å€™ï¼ŒåŒæ ·ä¼šåšæŒ‡ä»¤é‡æ’çš„ä¼˜åŒ–ã€‚æ‰€ä»¥ï¼Œå¦‚æœ cpu åœ¨æ‰§è¡Œæœºå™¨æŒ‡ä»¤æ—¶ï¼Œå‘ç”Ÿäº†æœºå™¨æŒ‡ä»¤çš„é‡æ’åºã€‚ä¸Šè¿°å®ä¾‹ä»£ç çš„ç»“æœï¼Œä»ç„¶æœ‰æœºä¼šä¸ç¬¦åˆ happens-before è§„å®š\n\n5. ä¸ºäº†ä»¤åˆ°ç¼–è¯‘åçš„ä»£ç çš„æ‰§è¡Œç»“æœï¼Œèƒ½å¤Ÿç¬¦åˆ happens-before è§„å®šã€‚ç¼–è¯‘å™¨é™¤äº†ä¸èƒ½åšæŒ‡ä»¤é‡æ’åºç¼–è¯‘ä¼˜åŒ–ä¹‹å¤–ï¼Œè¿˜è¦åœ¨ç”Ÿæˆçš„æœºå™¨ä»£ç ä¸­ã€‚åŠ å…¥ç‰¹å®š cpu æŒ‡ä»¤ï¼Œä»¤åˆ° cpu åªä¼šæ‰§è¡Œå®Œè¿™æ¡ç‰¹å®šæŒ‡ä»¤ä¹‹åï¼Œæ‰ä¼šæ‰§è¡Œåç»­çš„å…¶å®ƒæœºå™¨æŒ‡ä»¤ã€‚è€Œè¿™ç§ç‰¹å®šæŒ‡ä»¤ï¼Œæ˜¯é€šè¿‡å»ºç«‹ &#34;å†…å­˜å±éšœ&#34; æ¥ç¦æ­¢ cpu çš„æŒ‡ä»¤é‡æ’åºçš„ã€‚é‚£ä¸ºä»€ä¹ˆå« &#34;å†…å­˜å±éšœ&#34; å‘¢ï¼Ÿè¿™æ–¹é¢æˆ‘è¿˜æ²¡æœ‰å¾ˆæ·±å…¥çš„äº†è§£ã€‚ç›®å‰æˆ‘çš„ç†è§£æ˜¯ï¼Œè¿™ç§ç‰¹æ®ŠæŒ‡ä»¤ï¼Œéƒ½è¦æ±‚ cpu æŠŠç¼“å­˜æ•°æ®å†™å›åˆ°ä¸»å†…å­˜ä¸­ã€‚è¿™å°±åƒåœ¨å†…å­˜ä¸­å»ºç«‹äº†ä¸€é“å±éšœï¼Œä»¤åˆ°åé¢çš„ä»£ç ä¸èƒ½è¶Šè¿‡å±éšœï¼Œæå‰æ‰§è¡Œã€‚\n\n6. jmm æ˜¯ä¸€ä¸ªè§„èŒƒï¼Œå®ƒç”¨äºæŒ‡å¯¼ç¼–è¯‘å™¨çš„è¡Œä¸ºã€‚ä½†å®ƒæœ¬èº«ä¸ä¼šé™åˆ¶ç¼–è¯‘å™¨æ‰€ä½¿ç”¨çš„å…·ä½“ç¼–è¯‘æŠ€æœ¯ã€‚æ‰€ä»¥ï¼Œåœ¨ jmm è§„èŒƒä¸­ï¼Œä¸ä¼šæåˆ° &#34;æŒ‡ä»¤é‡æ’&#34; æˆ–è€… &#34;å†…å­˜å±éšœâ€ è¿™äº›å…·ä½“çš„å®ç°æŠ€æœ¯ã€‚è¿™æ˜¯æˆ‘ä»¬åœ¨å­¦ä¹ è§„èŒƒç±»çŸ¥è¯†çš„æ—¶å€™ï¼Œéœ€è¦æ³¨æ„çš„ã€‚","likes_number":28,"is_delete":false,"is_hidden":false,"ctime":1607151518,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":1,"child_discussions":[{"author":{"id":1133194,"avatar":"https://static001.geekbang.org/account/avatar/00/11/4a/8a/c1069412.jpg","nickname":"makermade","note":"","ucode":"03386B90CB8F20","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":1034451,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/c8/d3/3020ae46.jpg","nickname":"fatme","note":"","ucode":"75A805D2BB2AD1","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":574156,"discussion_content":"niu pi è°¢è°¢","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1653875167,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":332293,"ip_address":""},"score":574156,"extra":""}]},{"author":{"id":1508990,"avatar":"https://static001.geekbang.org/account/avatar/00/17/06/7e/735968e2.jpg","nickname":"è¥¿é—¨å¹ç‰›","note":"","ucode":"E5D3624DDE1E83","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":301421,"discussion_content":"1.5 ä¹‹å‰ï¼Œè¿™ä¿©è¡Œä»£ç ï¼Œæ˜¯å¯èƒ½ä¼šå‡ºç°é‡æ’åºçš„ï¼Œvolatile çš„å‡ºç°å°±æ˜¯ä¸ºäº†ç¦ç”¨ç¼“å­˜ï¼Œæ„æ€å°±æ˜¯ï¼Œä»£ç æ‰§è¡Œå¸¦volatile ä¿®é¥°çš„è¿™ä¸€è¡Œä»£ç ï¼Œä¼šå°†ç›®å‰ç¼“å­˜çš„åˆ·è¿›å†…å­˜ï¼ŒåŒæ—¶ï¼Œé€šè¿‡æ€»çº¿æœºåˆ¶ï¼Œè®©åˆ«çš„cpuç¼“å­˜å¤±æ•ˆï¼Œè¿™æ ·å°±ä¿è¯äº†ï¼Œvolatileè¿™ä¸ªå˜é‡çš„å†™æ“ä½œå¯¹åˆ«çš„çº¿ç¨‹ä¸€å®šæ˜¯å¯è§çš„ï¼Œè¿™æ—¶å€™åˆ«çš„çº¿ç¨‹è¯»å–Xçš„å€¼ï¼Œå¦‚æœxçš„èµ‹å€¼æ²¡æœ‰è¢«é‡æ’åºåˆ°våé¢ï¼Œé‚£ä¹ˆåˆ«çš„çº¿ç¨‹æ˜¯èƒ½è¯»åˆ°42çš„ï¼Œä½†æ˜¯å¦‚æœè¢«ç¼–è¯‘é‡æ’åºäº†ï¼Œè¿™æ—¶å€™ï¼Œè¿™è¡Œä»£ç è¿˜æ²¡æ‰§è¡Œï¼Œåˆ«çš„çº¿ç¨‹è¯»åˆ°çš„æ˜¯0ï¼Œä½†æ˜¯ä»ä»£ç çš„é¡ºåºæ¥çœ‹ï¼Œxçš„èµ‹å€¼æ“ä½œæ˜¯å‘ç”Ÿäº†ã€‚æ‰€ä»¥å°±é€ æˆäº†é”™è¯¯ï¼Œä»£ç çš„æ‰§è¡Œé¡ºåºæ²¡æœ‰æŒ‰ç…§ç¨‹åºå‘˜çš„æ„å¿—å°±è¡Œæ‰§è¡Œã€‚\n1.5ä¹‹åï¼ŒåŠ å…¥hbè§„åˆ™ï¼Œä¹Ÿå°±æ˜¯å†…å­˜æ¨¡å‹ä¸­çš„å†…å­˜å±éšœæŠ€æœ¯ï¼Œä¿è¯äº†ï¼Œvå˜é‡ä¹‹å‰çš„å†™ä¸ä¼šè¢«é‡æ’åºåˆ°vçš„å†™ä¹‹åï¼Œè¿™ä¹Ÿå°±æ˜¯é¿å…äº†ä¸Šé¢çš„é—®é¢˜","likes_number":19,"is_delete":false,"is_hidden":false,"ctime":1598521137,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":2,"child_discussions":[{"author":{"id":1400810,"avatar":"https://static001.geekbang.org/account/avatar/00/15/5f/ea/3b2b8bf9.jpg","nickname":"TYå‰¯æœ¬","note":"","ucode":"FB29711ADCEEE4","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":1508990,"avatar":"https://static001.geekbang.org/account/avatar/00/17/06/7e/735968e2.jpg","nickname":"è¥¿é—¨å¹ç‰›","note":"","ucode":"E5D3624DDE1E83","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":324972,"discussion_content":"å…·ä½“æ¥è®²ï¼Œåœ¨1.5åŠä¹‹åã€‚å¯¹äºvolatileçš„é‡æ’è§„åˆ™è¿˜åŠ äº†ä¸¤ä¸ªã€‚ä¸€ä¸ªæ˜¯å¦‚æœç¬¬ä¸€ä¸ªè¯­å¥æ˜¯å¯¹volatileçš„è¯»ï¼Œé‚£ä¹ˆä¸èƒ½ä¸å®ƒåé¢çš„è¯­å¥é‡æ’ï¼›å¦‚æœç¬¬äºŒä¸ªæ“ä½œæ˜¯å¯¹volatileå†™ï¼Œé‚£ä¹ˆä¸èƒ½ä¸å®ƒçš„å‰é¢æ“ä½œé‡æ’ã€‚åœ¨åŸæ¥çš„åªçº¦æŸvolatileå†™ä¸volatileçš„è¯»æ¥è®²ï¼Œå¢å¼ºäº†ã€‚","likes_number":5,"is_delete":false,"is_hidden":false,"ctime":1605195876,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":301421,"ip_address":""},"score":324972,"extra":""},{"author":{"id":2536451,"avatar":"https://static001.geekbang.org/account/avatar/00/26/b4/03/677fd301.jpg","nickname":"å­¤å‚²çš„è™ç‹","note":"","ucode":"FE9B90D6EEBAFB","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":1400810,"avatar":"https://static001.geekbang.org/account/avatar/00/15/5f/ea/3b2b8bf9.jpg","nickname":"TYå‰¯æœ¬","note":"","ucode":"FB29711ADCEEE4","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":369274,"discussion_content":"é€å½»","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1618994018,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":324972,"ip_address":""},"score":369274,"extra":""}]},{"author":{"id":1024565,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/a2/35/04536ff4.jpg","nickname":"éšæ¬£æ‰€é‡","note":"","ucode":"9A5F6D61DEFBD3","race_medal":1,"user_type":1,"is_pvip":true},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":251148,"discussion_content":"åœ¨æ–°çš„å†…å­˜æ¨¡å‹ä¸­ï¼Œvolatileå‘¨å›´çš„æ™®é€šå­—æ®µä¸èƒ½éšä¾¿é‡æ’ï¼›ç¼–è¯‘å™¨ç”Ÿæˆå­—èŠ‚ç æ—¶ï¼Œä¼šåœ¨volatileå†™æ“ä½œçš„å‰é¢å’Œåé¢åˆ†åˆ«æ’å…¥å†…å­˜å±éšœï¼ˆStoreStoreå±éšœï½œvolatileå†™ï½œStoreLoadå±éšœï¼‰ï¼Œå…¶ä¸­StoreStoreå±éšœï¼šç¦æ­¢ä¸Šé¢çš„æ™®é€šå†™å’Œä¸‹é¢çš„volatileå†™é‡æ’åºï¼›StoreLoadå±éšœï¼šé˜²æ­¢ä¸Šé¢çš„volatileå†™ä¸ä¸‹é¢å¯èƒ½æœ‰çš„volatileè¯»/å†™é‡æ’åºã€‚ps:å…·ä½“å¯å‚è€ƒã€Šjavaå¹¶å‘ç¼–ç¨‹çš„è‰ºæœ¯ã€‹volatileå†™æ’å…¥å†…å­˜å±éšœç¤ºæ„å›¾","likes_number":13,"is_delete":false,"is_hidden":false,"ctime":1588069542,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":2,"child_discussions":[{"author":{"id":1179898,"avatar":"https://static001.geekbang.org/account/avatar/00/12/00/fa/5863be21.jpg","nickname":"Outside","note":"","ucode":"E04CA55407FF37","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":1024565,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/a2/35/04536ff4.jpg","nickname":"éšæ¬£æ‰€é‡","note":"","ucode":"9A5F6D61DEFBD3","race_medal":1,"user_type":1,"is_pvip":true},"discussion":{"id":273140,"discussion_content":"è¿™ä¸ªè€å¸ˆå†…å®¹ â€œæŒ‰ç…§ç¨‹åºçš„é¡ºåºï¼Œç¬¬ 6 è¡Œä»£ç  â€œx = 42;â€ Happens-Before äºç¬¬ 7 è¡Œä»£ç  â€œv = true;â€ï¼Œè¿™å°±æ˜¯è§„åˆ™ 1 çš„å†…å®¹â€ è¿™å¥è¯æ˜¯æœ‰é—®é¢˜çš„å§ï¼Œå•çº¿ç¨‹ä¸­ï¼Œå¯¼è‡´è¿™ä¸¤è¡Œä»£ç \nx=45; //1\nv=true; // 2\nä¸é‡æ’åºçš„åŸå› æ˜¯volatileçš„è¯­ä¹‰ï¼Œè€Œä¸æ˜¯ç¨‹åºçš„é¡ºåºæ€§è§„åˆ™","likes_number":5,"is_delete":false,"is_hidden":false,"ctime":1590415597,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":251148,"ip_address":""},"score":273140,"extra":""},{"author":{"id":1161200,"avatar":"https://static001.geekbang.org/account/avatar/00/11/b7/f0/a570f68a.jpg","nickname":"wang","note":"","ucode":"5D569805C6A923","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":1179898,"avatar":"https://static001.geekbang.org/account/avatar/00/12/00/fa/5863be21.jpg","nickname":"Outside","note":"","ucode":"E04CA55407FF37","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":299978,"discussion_content":"å—¯ï¼Œè¿™ä¸ªå…¶å®ä¸æ˜¯ç”¨è§„åˆ™ä¸€ï¼Œæ˜¯volatileçš„è¯­ä¹‰ï¼Œé˜²æ­¢æŒ‡ä»¤é‡æ’","likes_number":2,"is_delete":false,"is_hidden":false,"ctime":1597892511,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":273140,"ip_address":""},"score":299978,"extra":""}]},{"author":{"id":1818343,"avatar":"","nickname":"åˆ˜åŒé’","note":"","ucode":"84B62DF8BC61FB","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":280161,"discussion_content":"å¤šçº¿ç¨‹å¯¹äºç¨‹åºå‘˜æ¥è¯´ï¼Œéš¾ç‚¹æ˜¯å¯è§æ€§é—®é¢˜ï¼Œå› ä¸ºjavaä¿è¯çš„å•çº¿ç¨‹as is serialæ˜¯ç‰¹åˆ«ç¬¦åˆäººç±»æ€ç»´çš„ï¼Œç¨‹åºå‘˜å¼€å‘ä¸­å¹¶ä¸éœ€è¦çŸ¥é“å¤šçº¿ç¨‹åä½œæ—¶ï¼Œä¸¤ä¸ªçº¿ç¨‹æ˜¯é¡ºåºæ‰§è¡Œè¿˜æ˜¯äº¤å‰æ‰§è¡Œï¼Œæ‰€æœ‰ä»£ç æ‰§è¡Œçš„é¡ºåºåˆæ˜¯ä»€ä¹ˆï¼Œå› ä¸ºç¨‹åºå‘˜åªéœ€è¦çŸ¥é“å¤šçº¿ç¨‹æ˜¯å¹¶å‘æ‰§è¡Œçš„ï¼Œå®é™…ä¸Šçº¿ç¨‹çš„æ‰§è¡Œæœ¬èº«å°±æ˜¯éšæœºçš„æ— åºçš„ã€‚é‚£ä¹ˆä¸ºä»€ä¹ˆè¯´ç¨‹åºå‘˜åªéœ€è¦å…³æ³¨å¯è§æ€§é—®é¢˜å‘¢ï¼Ÿè¿™æ˜¯å­˜åœ¨å…±äº«å˜é‡çš„è¯»å†™ï¼Œå¦‚æœå…¨æ˜¯å±€éƒ¨å˜é‡ï¼Œç¨‹åºå‘˜æ ¹æœ¬ä¸éœ€è¦è€ƒè™‘å¹¶å‘é—®é¢˜å¯è§æ€§é—®é¢˜ã€‚ç¨‹åºå‘˜ä¼šå‘ç°å¤šçº¿ç¨‹ä¸­ç®€å•ç›´æ¥çš„å¯¹å…±äº«å˜é‡çš„è¯»å†™çš„ç»“æœä¸ç¬¦åˆé¢„æœŸï¼Œæ‰€ä»¥Javaä¸ºäº†å¸®åŠ©ç¨‹åºå‘˜æ­£ç¡®ç¼–ç ï¼Œæ€»ç»“å‡ºhappens before è§„åˆ™ï¼Œè¿™äº›è§„åˆ™æ›´åŠ å®ç”¨ï¼Œä¸éœ€è¦ç¨‹åºå‘˜ç†è§£ä»€ä¹ˆæ˜¯ç¼–è¯‘é‡æ’åºã€å¤„ç†å™¨é‡æ’åºã€å†…å­˜é‡æ’åºè¿˜æœ‰å†…å­˜å±éšœã€‚volatile å†™ happens before è¯»ï¼Œè¿™æ¡è§„åˆ™åœ¨java 1.5ä¸­æ·»åŠ ï¼Œå¯èƒ½æœ‰äººç–‘æƒ‘çš„æ˜¯è¿™æ¡è§„åˆ™ä¸å°±æ˜¯volatile åŸæœ¬è¯­ä¹‰ä¹ˆï¼ŸåŸæœ¬å°±æ˜¯ä»èƒ½è¯»åˆ°æœ€æ–°å€¼å•Šï¼Œä¹‹æ‰€ä»¥å£°æ˜è¿™æ˜¯ä¸€æ¡happens before è§„åˆ™ï¼Œè¿™æ˜¯å› ä¸ºä¼ é€’æ€§ï¼Œä¸æ˜¯happens before è§„åˆ™ï¼Œvolatileçš„è¯­ä¹‰æ˜¯å•ä¸€çš„å­¤ç‹¬çš„ï¼Œæˆä¸ºhappens before ä¹‹åå°±å¯ä»¥å’Œå…¶ä»–è§„åˆ™ç»„åˆä½¿ç”¨äº†ã€‚\nçº¿ç¨‹A\nx=45     1\nV=true 2\nçº¿ç¨‹B\nIf v   3\nx   4\n\nå› ä¸º2 happens before 3\næ‰€ä»¥1 happens before 4\n\n\nè‡³äº1å’Œ2æ˜¯ä¸æ˜¯é‡æ’åºå¹¶ä¸éœ€è¦ç¨‹åºå‘˜è€ƒè™‘ï¼Œç¨‹åºå‘˜å…³æ³¨happens beforeè§„åˆ™å°±å¥½äº†\n\n\nå®é™…ä¸ŠJava1.5ä¹‹åä¼šé€šè¿‡æ’å…¥å†…å­˜å±éšœæ¥ç¦æ­¢è¯¥é‡æ’åº\n\n","likes_number":9,"is_delete":false,"is_hidden":false,"ctime":1591506583,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1621793,"avatar":"https://static001.geekbang.org/account/avatar/00/18/bf/21/44eb3aee.jpg","nickname":"Hou","note":"","ucode":"92BF011EF961B4","race_medal":0,"user_type":1,"is_pvip":true},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":3811,"discussion_content":"volatileä¼šç¦æ­¢æŒ‡ä»¤çš„é‡æ’åº å¹¶ä¸”åœ¨volatileå˜é‡å†™å›å†…å­˜çš„æ—¶å€™å­˜åœ¨äºå†™ç¼“å†²åŒºçš„æ™®é€šå˜é‡ä¹Ÿä¼šåˆ·å›å†…å­˜  æ‰€ä»¥çº¿ç¨‹Bè¯»åˆ°çš„xæ˜¯42","likes_number":5,"is_delete":false,"is_hidden":false,"ctime":1564832963,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":1,"child_discussions":[{"author":{"id":1533266,"avatar":"https://static001.geekbang.org/account/avatar/00/17/65/52/07c09c7f.jpg","nickname":"josancpp","note":"","ucode":"0CDC39B3E716A3","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":1621793,"avatar":"https://static001.geekbang.org/account/avatar/00/18/bf/21/44eb3aee.jpg","nickname":"Hou","note":"","ucode":"92BF011EF961B4","race_medal":0,"user_type":1,"is_pvip":true},"discussion":{"id":147743,"discussion_content":"ç­”éæ‰€é—®","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1579671508,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":3811,"ip_address":""},"score":147743,"extra":""}]},{"author":{"id":1018240,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/89/80/3666ced3.jpg","nickname":"é»„æµ©ç‰¹","note":"","ucode":"C3A4BBF4FB8519","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":32632,"discussion_content":"è€å¸ˆè¯´è¿‡å…è®¸ç¼–è¯‘ä¼˜åŒ–, ä½†æ˜¯ Happens-Before åŸåˆ™çš„åŒä¸€çº¿ç¨‹é¡ºåºæ€§å’Œä¼ é€’æ€§ è§„åˆ™ä¿è¯äº† x = 42 å¯¹ v = true æ˜¯å¯è§çš„. è¿™é‡Œåªè¦ä¿è¯å¯è§æ€§, æ²¡æœ‰ä¿è¯æ‰§è¡Œé¡ºåº, å…·ä½“å®ç°å¯è§æ€§åº”è¯¥æ˜¯è™šæ‹Ÿæœºå¼€å‘äººå‘˜åšçš„","likes_number":3,"is_delete":false,"is_hidden":false,"ctime":1571053859,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1196234,"avatar":"https://static001.geekbang.org/account/avatar/00/12/40/ca/1313a90b.jpg","nickname":"é€€å½¹çš„çƒç«¥","note":"","ucode":"CD5157830D9606","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":26723,"discussion_content":"æˆ‘è·Ÿä½ æœ‰åŒæ ·çš„ç–‘é—®ï¼Œå¸Œæœ›è€å¸ˆèƒ½å›å¤ä¸‹","likes_number":3,"is_delete":false,"is_hidden":false,"ctime":1570615324,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1693414,"avatar":"https://static001.geekbang.org/account/avatar/00/19/d6/e6/87234c32.jpg","nickname":"æœ¨å¿ƒäº‘å½±","note":"","ucode":"5F7244D779AD9F","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":51100,"discussion_content":"è¿™ä¸¤å¥æ€ä¹ˆå¯èƒ½æŒ‡ä»¤é‡æ’å‘¢ï¼Ÿåªæœ‰åƒx++è¿™ç§æ‰ä¼šå‡ºç°æŒ‡ä»¤é‡æ’å§ï¼Ÿ","likes_number":2,"is_delete":false,"is_hidden":false,"ctime":1573811104,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":1,"child_discussions":[{"author":{"id":1508990,"avatar":"https://static001.geekbang.org/account/avatar/00/17/06/7e/735968e2.jpg","nickname":"è¥¿é—¨å¹ç‰›","note":"","ucode":"E5D3624DDE1E83","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":1693414,"avatar":"https://static001.geekbang.org/account/avatar/00/19/d6/e6/87234c32.jpg","nickname":"æœ¨å¿ƒäº‘å½±","note":"","ucode":"5F7244D779AD9F","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":301422,"discussion_content":"å¦‚æœä¸åŠ volatileä¿®é¥°ï¼Œæ˜¯ä¼šå‘ç”Ÿé‡æ’åºçš„ï¼ŒcpuæŒ‡ä»¤æ‰§è¡Œæ—¶ï¼Œä¼šæ—¶åˆ†å¤ç”¨ï¼Œè¿™ä¿©è¡Œä»£ç å¯¹åº”çš„æŒ‡ä»¤ï¼Œè°å…ˆè°åï¼Œä¸åŠ volatileï¼Œè¿˜çœŸä¿è¯ä¸äº†","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1598521260,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":51100,"ip_address":""},"score":301422,"extra":""}]},{"author":{"id":1555565,"avatar":"https://static001.geekbang.org/account/avatar/00/17/bc/6d/f6f0a442.jpg","nickname":"æ±¤å°é«˜","note":"","ucode":"D4AB7766273D52","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":141177,"discussion_content":"è¿™ä¸ªæ˜¯å› ä¸ºjavaå†…å­˜æ¨¡å‹é™åˆ¶äº†volatileå†™ä¹‹å‰çš„æ“ä½œé‡æ’åºåˆ°å®ƒä¹‹åï¼Œæ‰€ä»¥ä¸ç”¨è€ƒè™‘é‡æ’åºä¼šå½±å“ä¼ é€’æ€§ã€‚å› ä¸ºè¿™ç§æƒ…å†µä¸ä¼šé‡æ’åºã€‚","likes_number":1,"is_delete":false,"is_hidden":false,"ctime":1579400459,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":2,"child_discussions":[{"author":{"id":1135604,"avatar":"https://static001.geekbang.org/account/avatar/00/11/53/f4/e277325d.jpg","nickname":"bin.chen","note":"","ucode":"5BA49358AB8A1A","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":1555565,"avatar":"https://static001.geekbang.org/account/avatar/00/17/bc/6d/f6f0a442.jpg","nickname":"æ±¤å°é«˜","note":"","ucode":"D4AB7766273D52","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":192796,"discussion_content":"è¿™ä¸ªåº”è¯¥å°±æ˜¯åœ¨ç¼–è¯‘çš„æ—¶å€™çŸ¥é“è¿™ä¸€å—æœ‰volatileå…³é”®å­—ï¼Œåœ¨å…¶å‰åæ’ä¸Šäº†å†…å­˜å±éšœï¼Œç¦æ­¢é‡æ’ä»¥åŠå¼ºåˆ¶åˆ·æ–°åˆ°ä¸»å­˜ä¸­","likes_number":2,"is_delete":false,"is_hidden":false,"ctime":1583086820,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":141177,"ip_address":""},"score":192796,"extra":""},{"author":{"id":1442230,"avatar":"https://static001.geekbang.org/account/avatar/00/16/01/b6/5b297fef.jpg","nickname":"Gray","note":"","ucode":"7725C335978662","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":1135604,"avatar":"https://static001.geekbang.org/account/avatar/00/11/53/f4/e277325d.jpg","nickname":"bin.chen","note":"","ucode":"5BA49358AB8A1A","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":206726,"discussion_content":"æ˜¯çš„ï¼Œæ’ä¸Šäº†å†…å­˜å±éšœ","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1584434759,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":192796,"ip_address":""},"score":206726,"extra":""}]},{"author":{"id":1897434,"avatar":"","nickname":"æµæ˜Ÿ","note":"","ucode":"322220E4695128","race_medal":0,"user_type":1,"is_pvip":true},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":239224,"discussion_content":"å…¶å®è€å¸ˆä¸€å¼€å§‹å°±ç»™å‡ºäº†ç»“è®ºï¼šå¯¹äºHappens-BeforeåŸåˆ™Javaå†…å­˜æ¨¡å‹å°±åªä¿è¯äº†å¯è§æ€§ï¼Œæ²¡ä¿è¯é¡ºåºæ€§ã€‚æ‰€ä»¥ç½‘ä¸Šå¾ˆå¤šæ–‡ç« è¿™ä¸ªå…³é”®ç‚¹æ²¡æœ‰ç‚¹åï¼Œè®©äººè§‰å¾—ä¸€ç›´æ˜¯äº’ç›¸çŸ›ç›¾çš„ã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1587285578,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":3,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1179952,"avatar":"https://static001.geekbang.org/account/avatar/00/12/01/30/cb3a729e.jpg","nickname":"XHH","note":"","ucode":"3EF89099982977","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":192792,"discussion_content":"å¦‚æœæ‰§è¡Œé¡ºåºæ˜¯ 1 ï¼Œ2 ï¼Œ3ï¼ˆif (v == true) ï¼‰çš„è¯ï¼Œ1å’Œ2ä¸ä¼šé‡æ’ï¼Œç”±äºç¨‹åºé¡ºåºæ€§è§„åˆ™ 1 happen-before äº 2ï¼Œç›‘è§†å™¨é”è§„åˆ™å¯çŸ¥ 2 happen-beforeäº3ï¼Œæ ¹æ®ä¼ é€’æ€§è§„åˆ™ï¼Œ1 happen-before äº 3ï¼Œè€Œç¼–è¯‘å™¨ä¼˜åŒ–éœ€è¦éµå®ˆ happen-beforeè§„åˆ™ï¼Œæ‰€ä»¥1å’Œ2ä¸ä¼šé‡æ’åºã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1583084133,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":3,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1334409,"avatar":"http://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTIjRETqRjvLESLDZkNTjIiaSibtNYBaS1o8WMUicOFn3ycF3Mgh6LRJibqSBjVBjiaO2ibW0gHkafATb21A/132","nickname":"lmdcx","note":"","ucode":"F2CDD0091ADFD7","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":2872,"discussion_content":"æŒ‰ç…§ç¨‹åºçš„é¡ºåºï¼Œç¬¬ 6 è¡Œä»£ç  â€œx = 42;â€ Happens-Before äºç¬¬ 7 è¡Œä»£ç  â€œv = true;â€ï¼Œè¿™å°±æ˜¯è§„åˆ™ 1 çš„å†…å®¹ï¼Œä¹Ÿæ¯”è¾ƒç¬¦åˆå•çº¿ç¨‹é‡Œé¢çš„æ€ç»´ï¼šç¨‹åºå‰é¢å¯¹æŸä¸ªå˜é‡çš„ä¿®æ”¹ä¸€å®šæ˜¯å¯¹åç»­æ“ä½œå¯è§çš„ã€‚\n\nç¬¬äºŒä¸ªå°±æ˜¯ä¼ é€’æ€§åœ¨å¤šçº¿ç¨‹çš„æƒ…å†µä¸‹ä¾ç„¶é€‚ç”¨ï¼ˆä¾‹å­ä¸­å·²ç»ç”¨ä¸¤ä¸ªçº¿ç¨‹ä¸¾ä¾‹å­äº†ï¼Œä¸è¨€è‡ªæ˜ï¼‰ï¼Œç»“åˆè§„åˆ™1ã€è§„åˆ™2ï¼Œå°±ä¸ä¼šå‡ºç°ä½ è¯´çš„é—®é¢˜ã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1564005331,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":3,"extra":"","child_discussion_number":2,"child_discussions":[{"author":{"id":1188517,"avatar":"http://thirdwx.qlogo.cn/mmopen/g7TWmGqjoiaSFWknFpTPAia5rPOmzEZiaGK8icd5HGEXlfaYJBoKvLn5BkqGkyTZOqDTC3NMHXUbH3tdLJzicAyickRYdP4xcM3ajia/132","nickname":"sudo","note":"","ucode":"EA0F8116999557","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":1334409,"avatar":"http://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTIjRETqRjvLESLDZkNTjIiaSibtNYBaS1o8WMUicOFn3ycF3Mgh6LRJibqSBjVBjiaO2ibW0gHkafATb21A/132","nickname":"lmdcx","note":"","ucode":"F2CDD0091ADFD7","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":6942,"discussion_content":"ä¸»è¦è¿˜æ˜¯volatile é™åˆ¶äº†ç¼–è¯‘å™¨æŒ‡ä»¤é‡æ’åºã€‚","likes_number":5,"is_delete":false,"is_hidden":false,"ctime":1567182110,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":2872,"ip_address":""},"score":6942,"extra":""},{"author":{"id":1196234,"avatar":"https://static001.geekbang.org/account/avatar/00/12/40/ca/1313a90b.jpg","nickname":"é€€å½¹çš„çƒç«¥","note":"","ucode":"CD5157830D9606","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":1334409,"avatar":"http://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTIjRETqRjvLESLDZkNTjIiaSibtNYBaS1o8WMUicOFn3ycF3Mgh6LRJibqSBjVBjiaO2ibW0gHkafATb21A/132","nickname":"lmdcx","note":"","ucode":"F2CDD0091ADFD7","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":26716,"discussion_content":"é¡ºåºæ€§è§„åˆ™æ˜¯ä¿è¯ä¸²è¡Œé€»è¾‘è¯­ä¹‰çš„ï¼Œè€Œç¤ºä¾‹ä¸­çš„ä»£ç å³ä½¿æŒ‡ä»¤é‡æ‹ä¹Ÿæ— ä»»ä½•å½±å“ã€‚ä¸€æ—¦é‡æ’ï¼Œå³v = trueå…ˆæ‰§è¡Œã€‚é‚£è§„åˆ™é€‚ç”¨çš„å¯¹è±¡éƒ½å˜äº†ã€‚åé¢çš„ä¼ é€’æ€§ä¹Ÿæ— æ³•ä¿è¯readerä¸­è¯»åˆ°çš„xä¸€å®šæ˜¯42ã€‚åªèƒ½å¾—åˆ°aå…ˆäºbï¼Œaå…ˆäºcï¼Œä½†bæ˜¯å¦å…ˆäºcå°±æ— ä»å¯çŸ¥äº†ã€‚","likes_number":1,"is_delete":false,"is_hidden":false,"ctime":1570615015,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":2872,"ip_address":""},"score":26716,"extra":""}]},{"author":{"id":1115284,"avatar":"https://static001.geekbang.org/account/avatar/00/11/04/94/c04ddcf6.jpg","nickname":"helloworld","note":"","ucode":"D412FB8BF1CEB8","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":321,"discussion_content":"ä¼ é€’æ€§","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1561447769,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":3,"extra":"","child_discussion_number":5,"child_discussions":[{"author":{"id":1196234,"avatar":"https://static001.geekbang.org/account/avatar/00/12/40/ca/1313a90b.jpg","nickname":"é€€å½¹çš„çƒç«¥","note":"","ucode":"CD5157830D9606","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":1115284,"avatar":"https://static001.geekbang.org/account/avatar/00/11/04/94/c04ddcf6.jpg","nickname":"helloworld","note":"","ucode":"D412FB8BF1CEB8","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":26717,"discussion_content":"ä½ è¿™ä¸ªä¼ é€’æ€§çš„å‰ææ˜¯æ²¡æœ‰æŒ‡ä»¤é‡æ’ã€‚ä¸€æ—¦æŒ‡ä»¤é‡æ‹ï¼Œä¼ é€’æ€§çš„é“¾æ¡ä¹Ÿå°±å˜äº†","likes_number":1,"is_delete":false,"is_hidden":false,"ctime":1570615085,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":321,"ip_address":""},"score":26717,"extra":""},{"author":{"id":1043789,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/ed/4d/1d1a1a00.jpg","nickname":"magict4","note":"","ucode":"CB6F063D881AAC","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":1196234,"avatar":"https://static001.geekbang.org/account/avatar/00/12/40/ca/1313a90b.jpg","nickname":"é€€å½¹çš„çƒç«¥","note":"","ucode":"CD5157830D9606","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":103852,"discussion_content":"æˆ‘ä»”ç»†æŸ¥äº†ä¸€ä¸‹ Oracle çš„æ–‡æ¡£ï¼Œå¼•ç”¨å¦‚ä¸‹ï¼š\n> If x and y are actions of the same thread and x comes before y in program order, then hb(x, y).\n\nè¿™é‡Œå¼ºè°ƒäº† &#34;program order&#34; è€Œé â€œexecution order&#34;ã€‚åœ¨æ¨å¯¼ happen-before  å…³ç³»æ—¶ï¼Œæˆ‘çš„ç†è§£æ˜¯æ— éœ€è€ƒè™‘æŒ‡ä»¤é‡æ’é—®é¢˜ã€‚","likes_number":4,"is_delete":false,"is_hidden":false,"ctime":1577402902,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":26717,"ip_address":""},"score":103852,"extra":""},{"author":{"id":1196339,"avatar":"https://static001.geekbang.org/account/avatar/00/12/41/33/d1064f9a.jpg","nickname":"Sun","note":"","ucode":"1BC2741DC07FC5","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":1043789,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/ed/4d/1d1a1a00.jpg","nickname":"magict4","note":"","ucode":"CB6F063D881AAC","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":198813,"discussion_content":"é‚£è¯·é—®æŒ‰è¿™ä¸ªOracleçš„æ–‡æ¡£æ¥è¯´ï¼Œå•çº¿ç¨‹æƒ…å†µä¸‹æ°¸è¿œä¸ä¼šå‘ç”ŸæŒ‡ä»¤é‡æ’åºå—ï¼Ÿé‚£æŒ‡ä»¤é‡æ’åºçš„æ„ä¹‰æ˜¯ä»€ä¹ˆå‘¢ï¼Ÿ","likes_number":1,"is_delete":false,"is_hidden":false,"ctime":1583513430,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":103852,"ip_address":""},"score":198813,"extra":""}]}]},{"had_liked":false,"id":72027,"user_name":"ç‹‚æˆ˜ä¿„æ´›ä¼Š","can_delete":false,"product_type":"c1","uid":1213269,"ip_address":"","ucode":"F6EACA321E6180","user_header":"http://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTJUzv6S9wroydkGP6m3OsQ8QuI4jAibv21tNkm7KVGPffJibj8Y29yIdKl4qkDGd3iaGJCSGVarfxoibQ/132","comment_is_top":false,"comment_ctime":1551501790,"is_pvip":false,"replies":[{"id":"26102","content":"æ„Ÿè°¢å›å¤ï¼","user_name":"ä½œè€…å›å¤","comment_id":72027,"uid":"1269969","ip_address":"","utype":1,"ctime":1551522224,"user_name_real":"ç‹å®ä»¤"}],"discussion_count":7,"race_medal":0,"score":"315084114398","product_id":100023901,"comment_content":"å›å¤tracerçš„é—®é¢˜@tracerï¼Œä½ è¯´çš„è¿™ä¸ªé—®é¢˜å…¶å®å°±æ˜¯ä¸€ä¸ªhappens-beforeåŸåˆ™ã€‚ä¾‹å¦‚æœ‰ä»¥ä¸‹ä»£ç ï¼š<br>     int a = 1;&#47;&#47;ä»£ç 1<br>     int b = 2;&#47;&#47;ä»£ç 2<br>     volatile int c = 3;&#47;&#47;ä»£ç 3<br>     int d = 4;&#47;&#47;ä»£ç 4<br>     int e = 5;&#47;&#47;ä»£ç 5<br>ç¼–è¯‘å™¨è§£é‡Šè¿™5è¡Œä»£ç çš„æ—¶å€™ï¼Œä¼šä¿è¯ä»£ç 1å’Œä»£ç 2ä¼šåœ¨ä»£ç 3ä¹‹å‰æ‰§è¡Œï¼Œè€Œä»£ç 1å’Œä»£ç 2çš„æ‰§è¡Œé¡ºåºåˆ™ä¸ä¸€å®šï¼ˆè¿™å°±æ˜¯é‡æ’åºï¼Œåœ¨ä¸å½±å“æ‰§è¡Œç»“æœçš„æƒ…å†µä¸‹ï¼Œè™šæ‹Ÿæœºå¯èƒ½ä¼šå¯¹å‘½ä»¤é‡æ’ã€‚å½“ç„¶æ‰€è°“çš„ä¸å½±å“æ‰§è¡Œç»“æœï¼Œjavaåªä¿è¯åœ¨å•çº¿ç¨‹ä¸­ä¸å½±å“æ‰§è¡Œç»“æœï¼‰ã€‚ä»£ç 4å’Œä»£ç 5ä¹Ÿä¸€å®šä¼šåœ¨ä»£ç 3ä¹‹åæ‰§è¡Œï¼ŒåŒç†ä»£ç 4å’Œä»£ç 5çš„æ‰§è¡Œé¡ºåºä¹Ÿæ˜¯ä¸ä¸€å®šçš„ã€‚<br>    æ‰€ä»¥è¿™ç¯‡æ–‡ç« ä¸­ä½ è¯´çš„é‚£æ®µä»£ç ï¼Œç”±äºvæ˜¯volatileä¿®é¥°çš„ï¼Œå¯¹vçš„èµ‹å€¼æ°¸è¿œåœ¨å¯¹xçš„èµ‹å€¼ä¹‹åã€‚æ‰€ä»¥åœ¨readerä¸­è¾“å‡ºçš„xä¸€å®šæ˜¯42","like_count":73,"discussions":[{"author":{"id":1269969,"avatar":"https://static001.geekbang.org/account/avatar/00/13/60/d1/8efa89ab.jpg","nickname":"ç‹å®ä»¤","note":"","ucode":"4FE19F5BC32FCA","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":441428,"discussion_content":"æ„Ÿè°¢å›å¤ï¼","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1551522224,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1288640,"avatar":"https://static001.geekbang.org/account/avatar/00/13/a9/c0/ed3be464.jpg","nickname":"å”ä»£æ–¯","note":"","ucode":"8F336BB3689DDA","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":199207,"discussion_content":"é‚£è¿™ä¸ªç¦æ­¢é‡æ’åºçš„èŒƒå›´æ˜¯å¤šå°‘ï¼Ÿæ¯”å¦‚å¦‚æœå‡ºç°äº†volatileä¿®é¥°çš„å˜é‡ï¼Œåœ¨å®ƒä¹‹å‰ï¼ˆä»¥åŠä¹‹åï¼‰æ‰€æœ‰çš„ä»£ç éƒ½ç¦æ­¢é‡æ’åºå—ï¼Ÿï¼ˆæ¯”å¦‚ä¸€ä¸ªæ–¹æ³•é‡Œé¢æœ‰200è¡Œä»£ç ï¼Œä¸­é—´æœ‰ä¸ªvolatileä¿®é¥°çš„å˜é‡ï¼‰","likes_number":1,"is_delete":false,"is_hidden":false,"ctime":1583570207,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":3,"child_discussions":[{"author":{"id":1484192,"avatar":"https://static001.geekbang.org/account/avatar/00/16/a5/a0/e0cccf7e.jpg","nickname":"åœ†åœ†æ»¡æ»¡","note":"","ucode":"396E7A822014D1","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":1288640,"avatar":"https://static001.geekbang.org/account/avatar/00/13/a9/c0/ed3be464.jpg","nickname":"å”ä»£æ–¯","note":"","ucode":"8F336BB3689DDA","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":289236,"discussion_content":"æˆ‘ä¹Ÿæœ‰è¿™æ ·çš„ç–‘é—®","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1594037017,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":199207,"ip_address":""},"score":289236,"extra":""},{"author":{"id":1170670,"avatar":"https://static001.geekbang.org/account/avatar/00/11/dc/ee/8fb92613.jpg","nickname":"æ™é¹","note":"","ucode":"D23BC3B61C257E","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":1288640,"avatar":"https://static001.geekbang.org/account/avatar/00/13/a9/c0/ed3be464.jpg","nickname":"å”ä»£æ–¯","note":"","ucode":"8F336BB3689DDA","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":346092,"discussion_content":"ä¸æ˜¯è¯´å‰é¢çš„ä»£ç ç¦æ­¢é‡æ’åºï¼Œè€Œæ˜¯è¯´å‰é¢çš„æ™®é€šå†™é‡æ’åºä¹‹åä¸èƒ½æ’åˆ°volatileä¹‹å","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1611872730,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":199207,"ip_address":""},"score":346092,"extra":""},{"author":{"id":2220763,"avatar":"https://static001.geekbang.org/account/avatar/00/21/e2/db/97c6f756.jpg","nickname":"_patrick","note":"","ucode":"B24C6EEBCABB94","race_medal":0,"user_type":1,"is_pvip":true},"reply_author":{"id":1288640,"avatar":"https://static001.geekbang.org/account/avatar/00/13/a9/c0/ed3be464.jpg","nickname":"å”ä»£æ–¯","note":"","ucode":"8F336BB3689DDA","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":571819,"discussion_content":"æ²¡æœ‰ä»€ä¹ˆèŒƒå›´ã€‚ ä½ å°±æŠŠvolatile é‚£ä¸€è¡Œç†è§£ä¸ºå±éšœï¼Œåœ¨å®ƒå‰åçš„å‘½ä»¤ å¯ä»¥é‡æ’åºã€‚ä½†ä¸ç®¡æ€ä¹ˆé‡æ’åºï¼Œéƒ½ä¸èƒ½è·¨è¿‡è¿™ä¸ªå±éšœã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1652421849,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":199207,"ip_address":""},"score":571819,"extra":""}]},{"author":{"id":2573722,"avatar":"","nickname":"Geek_36e4bb","note":"","ucode":"90E84F8CC8A410","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":368541,"discussion_content":"ä½ è¿™ä¸ªç»“è®ºæ˜¯æ ¹æ®ç»“æœå¾€å‰æ¨å¯¼çš„,ä½ å‡­ä»€ä¹ˆè¯æ˜ä½ æ˜¯å¯¹çš„? åœ¨ç¬¬ä¸€ç« int x=4,int y=5,ä¼šå¯èƒ½æŒ‡ä»¤é‡æ’,ä½†æ˜¯ä½ è¯´çš„ä»£ç 1,2å’Œä»£ç 3æœ‰ä»€ä¹ˆè”ç³»,ä¸ºä»€ä¹ˆå°±ä¸èƒ½æŒ‡ä»¤é‡æ’äº†?ä½ è¯´äº†è¿™ä¹ˆå¤šéƒ½æ˜¯ä½ çš„ç»“è®ºæœ‰ä»€ä¹ˆè¯´æœåŠ›å•Š","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1618746755,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1693414,"avatar":"https://static001.geekbang.org/account/avatar/00/19/d6/e6/87234c32.jpg","nickname":"æœ¨å¿ƒäº‘å½±","note":"","ucode":"5F7244D779AD9F","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":51102,"discussion_content":"é•¿çŸ¥è¯†äº†","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1573811184,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":72043,"user_name":"Jerryé“¶é“¶","can_delete":false,"product_type":"c1","uid":1008404,"ip_address":"","ucode":"80DA1172A2360A","user_header":"https://static001.geekbang.org/account/avatar/00/0f/63/14/06eff9a4.jpg","comment_is_top":false,"comment_ctime":1551504821,"is_pvip":false,"replies":[{"id":"26104","content":"å¾ˆå…¨é¢äº†!","user_name":"ä½œè€…å›å¤","comment_id":72043,"uid":"1269969","ip_address":"","utype":1,"ctime":1551522368,"user_name_real":"ç‹å®ä»¤"}],"discussion_count":17,"race_medal":0,"score":"246364640693","product_id":100023901,"comment_content":"æ€è€ƒé¢˜çš„é€šç”¨æ€§è¡¨è¿°ä¸ºï¼šå¦‚ä½•ä¿è¯ä¸€ä¸ªå…±äº«å˜é‡çš„å¯è§æ€§ï¼Ÿ<br>æœ‰ä»¥ä¸‹æ–¹æ³•ï¼š<br>1. ä¿è¯å…±äº«å˜é‡çš„å¯è§æ€§ï¼Œä½¿ç”¨volatileå…³é”®å­—ä¿®é¥°å³å¯<br>2. ä¿è¯å…±äº«å˜é‡æ˜¯privateï¼Œè®¿é—®å˜é‡ä½¿ç”¨set&#47;getæ–¹æ³•ï¼Œä½¿ç”¨synchronizedå¯¹æ–¹æ³•åŠ é”ï¼Œæ­¤ç§æ–¹æ³•ä¸ä»…ä¿è¯äº†å¯è§æ€§ï¼Œä¹Ÿä¿è¯äº†çº¿ç¨‹å®‰å…¨<br>3. ä½¿ç”¨åŸå­å˜é‡ï¼Œä¾‹å¦‚ï¼šAtomicIntegerç­‰<br>4. æœ€åä¸€ç§ä¸æ˜¯åŠæ³•çš„åŠæ³•ï¼šä¿è¯å¤šä¸ªçº¿ç¨‹æ˜¯ã€Œä¸²è¡Œæ‰§è¡Œã€^_^","like_count":57,"discussions":[{"author":{"id":1269969,"avatar":"https://static001.geekbang.org/account/avatar/00/13/60/d1/8efa89ab.jpg","nickname":"ç‹å®ä»¤","note":"","ucode":"4FE19F5BC32FCA","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":441434,"discussion_content":"å¾ˆå…¨é¢äº†!","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1551522368,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":2029333,"avatar":"http://thirdwx.qlogo.cn/mmopen/vi_32/DYAIOgq83erLujLByemCGmjp9rIicdoC59XUh99WiargBmxOMtsLlmntyEklh3LyiahtzAz3fnUu0tWwvibTqOFt5A/132","nickname":"hammer","note":"","ucode":"D98A31ACE2158F","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":291177,"discussion_content":"åªåŠ volatileå…³é”®å­—ï¼šåªèƒ½ä¿è¯Açº¿ç¨‹æˆåŠŸæ‰§è¡Œå®Œå®Œæ•´çš„CPUæŒ‡ä»¤åBçº¿ç¨‹å¯ä»¥è¯»åˆ°æ­£ç¡®çš„å€¼ï¼Œç¬¦åˆé¢˜è§£ã€‚ä½†æ˜¯æˆ‘ä»¬å®é™…ä¸Šé‡åˆ°çš„é—®é¢˜æ›´å¤šæ˜¯ï¼Œå¦‚æœä¿è¯Aæ“ä½œçš„CPUæŒ‡ä»¤è¢«ä¸­æ–­æ—¶ï¼ŒBå¦‚ä½•æ­£ç¡®çš„æ“ä½œã€‚","likes_number":2,"is_delete":false,"is_hidden":false,"ctime":1594724016,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":1,"child_discussions":[{"author":{"id":1987202,"avatar":"","nickname":"Geek_783cc7","note":"","ucode":"C43F76B1978FA9","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":2029333,"avatar":"http://thirdwx.qlogo.cn/mmopen/vi_32/DYAIOgq83erLujLByemCGmjp9rIicdoC59XUh99WiargBmxOMtsLlmntyEklh3LyiahtzAz3fnUu0tWwvibTqOFt5A/132","nickname":"hammer","note":"","ucode":"D98A31ACE2158F","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":319970,"discussion_content":"åŒæ ·ç–‘æƒ‘","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1604216880,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":291177,"ip_address":""},"score":319970,"extra":""}]},{"author":{"id":1132661,"avatar":"https://static001.geekbang.org/account/avatar/00/11/48/75/02b4366a.jpg","nickname":"ä¹˜åTornadoçš„çº¿ç¨‹é­”æ³•å¸ˆ","note":"","ucode":"C4C9915866E769","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":129762,"discussion_content":"å¦‚æœgetè¯­å¥æ²¡æœ‰synchronizedã€‚é‚£ä¹ˆåœ¨setè¯­å¥æ‹¿åˆ°é”æ‰§è¡Œçš„æ—¶å€™ï¼Œgetè¯­å¥å¯ä»¥è¯»å˜é‡ã€‚ç„¶åsetè¯­å¥é‡Šæ”¾é”ã€‚æ­¤æ—¶å¦‚æœgetè¯­å¥å†æ¬¡è¯»å˜é‡é‚£ä¹ˆè¯»åˆ°çš„å€¼ä¼šè·Ÿä¹‹å‰ä¸ä¸€æ ·ã€‚","likes_number":1,"is_delete":false,"is_hidden":false,"ctime":1578736262,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":2,"child_discussions":[{"author":{"id":1008404,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/63/14/06eff9a4.jpg","nickname":"Jerryé“¶é“¶","note":"","ucode":"80DA1172A2360A","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":1132661,"avatar":"https://static001.geekbang.org/account/avatar/00/11/48/75/02b4366a.jpg","nickname":"ä¹˜åTornadoçš„çº¿ç¨‹é­”æ³•å¸ˆ","note":"","ucode":"C4C9915866E769","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":129955,"discussion_content":"æ²¡getåˆ°ä½ è¦è¡¨è¾¾çš„ç‚¹","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1578746097,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":129762,"ip_address":""},"score":129955,"extra":""},{"author":{"id":1132661,"avatar":"https://static001.geekbang.org/account/avatar/00/11/48/75/02b4366a.jpg","nickname":"ä¹˜åTornadoçš„çº¿ç¨‹é­”æ³•å¸ˆ","note":"","ucode":"C4C9915866E769","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":1008404,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/63/14/06eff9a4.jpg","nickname":"Jerryé“¶é“¶","note":"","ucode":"80DA1172A2360A","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":130019,"discussion_content":"ç‚¹é”™äº†æŒ‰é’®ã€‚å›å¤ç»™ä¸‹é¢è¿™ä½åŒå­¦çš„ã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1578748628,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":129955,"ip_address":""},"score":130019,"extra":""}]},{"author":{"id":1448750,"avatar":"","nickname":"cloud_melon","note":"","ucode":"8C86694B9B129D","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":394949,"discussion_content":"å‰å®³","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1632143808,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1034451,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/c8/d3/3020ae46.jpg","nickname":"fatme","note":"","ucode":"75A805D2BB2AD1","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":332296,"discussion_content":"AtomicInteger è¿™ç§åŸå­ç±»å®ä¾‹ï¼Œåªèƒ½ä¿è¯æ“ä½œçš„åŸå­æ€§ã€‚å®ƒå¦‚ä½•ä¿è¯å¯è§æ€§å‘¢ï¼Ÿ","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1607151953,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":2,"child_discussions":[{"author":{"id":1758825,"avatar":"https://static001.geekbang.org/account/avatar/00/1a/d6/69/f59d4f6f.jpg","nickname":"Ryan","note":"","ucode":"387955FD53E98C","race_medal":0,"user_type":1,"is_pvip":true},"reply_author":{"id":1034451,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/c8/d3/3020ae46.jpg","nickname":"fatme","note":"","ucode":"75A805D2BB2AD1","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":553866,"discussion_content":"AtomicIntegerå¯¹è±¡é‡Œçš„ value å±æ€§ç”¨ volatile ä¿è¯å¯è§æ€§","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1646121628,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":332296,"ip_address":""},"score":553866,"extra":""},{"author":{"id":1034451,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/c8/d3/3020ae46.jpg","nickname":"fatme","note":"","ucode":"75A805D2BB2AD1","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":1758825,"avatar":"https://static001.geekbang.org/account/avatar/00/1a/d6/69/f59d4f6f.jpg","nickname":"Ryan","note":"","ucode":"387955FD53E98C","race_medal":0,"user_type":1,"is_pvip":true},"discussion":{"id":555073,"discussion_content":"è°¢è°¢ï¼","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1646733258,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":553866,"ip_address":""},"score":555073,"extra":""}]},{"author":{"id":1494880,"avatar":"https://static001.geekbang.org/account/avatar/00/16/cf/60/9100ad4f.jpg","nickname":"å‘¨æ˜Ÿå¹³","note":"","ucode":"1FDCB487392B03","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":288198,"discussion_content":"å…±äº«å˜é‡ä¸ºä»€ä¹ˆè¦è®¾ç½®æˆprivate","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1593676082,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1392431,"avatar":"https://static001.geekbang.org/account/avatar/00/15/3f/2f/8513c4d3.jpg","nickname":"a(à¹‘â‰–à¸´Ù¼â‰–à¸´)âœŒ","note":"","ucode":"AEF9B5CA1605DF","race_medal":1,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":363,"discussion_content":"set/getæ–¹æ³•ä½¿ç”¨synchronizedè¿™ä¸ªï¼Œæ˜¯ä¸æ˜¯åªè¦ç»™setåŠ synchronizedå°±è¶³å¤Ÿäº†ï¼Ÿ","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1561483749,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":5,"child_discussions":[{"author":{"id":1008404,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/63/14/06eff9a4.jpg","nickname":"Jerryé“¶é“¶","note":"","ucode":"80DA1172A2360A","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":1392431,"avatar":"https://static001.geekbang.org/account/avatar/00/15/3f/2f/8513c4d3.jpg","nickname":"a(à¹‘â‰–à¸´Ù¼â‰–à¸´)âœŒ","note":"","ucode":"AEF9B5CA1605DF","race_medal":1,"user_type":1,"is_pvip":false},"discussion":{"id":29593,"discussion_content":"ä¸è¡Œçš„ã€‚ä½ å¯ä»¥å†æƒ³æƒ³","likes_number":1,"is_delete":false,"is_hidden":false,"ctime":1570775242,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":363,"ip_address":""},"score":29593,"extra":""},{"author":{"id":1008404,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/63/14/06eff9a4.jpg","nickname":"Jerryé“¶é“¶","note":"","ucode":"80DA1172A2360A","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":1392431,"avatar":"https://static001.geekbang.org/account/avatar/00/15/3f/2f/8513c4d3.jpg","nickname":"a(à¹‘â‰–à¸´Ù¼â‰–à¸´)âœŒ","note":"","ucode":"AEF9B5CA1605DF","race_medal":1,"user_type":1,"is_pvip":false},"discussion":{"id":29615,"discussion_content":"î˜\næˆ‘å†ä»å¦ä¸€ä¸ªä¾§é¢æç¤ºä¸€ä¸‹ï¼šä¸ºä»€ä¹ˆJAVAå¹¶å‘åŒ…é‡Œä¼šæä¾›è¯»å†™é”ï¼Ÿ\n\næŒ‰ç…§ä½ çš„æƒ³æ³•ï¼Œgetæ–¹æ³•ç›¸å½“äºè¯»æ“ä½œï¼Œè€Œè¯»æ“ä½œä¸ç”¨åŠ é”çš„è¯ï¼Œé‚£JAVAå¹¶å‘åŒ…é‡Œé¢ä¸ºä»€ä¹ˆæä¾›å•ç‹¬çš„å†™é”å‘¢ï¼Ÿ\n2019-10-11\n","likes_number":1,"is_delete":false,"is_hidden":false,"ctime":1570776560,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":363,"ip_address":""},"score":29615,"extra":""},{"author":{"id":1639787,"avatar":"https://static001.geekbang.org/account/avatar/00/19/05/6b/d9d6d68b.jpg","nickname":"Vettel","note":"","ucode":"FB3E71DD1E8E7C","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":1392431,"avatar":"https://static001.geekbang.org/account/avatar/00/15/3f/2f/8513c4d3.jpg","nickname":"a(à¹‘â‰–à¸´Ù¼â‰–à¸´)âœŒ","note":"","ucode":"AEF9B5CA1605DF","race_medal":1,"user_type":1,"is_pvip":false},"discussion":{"id":35801,"discussion_content":"é™¤éåŠ ä¸Švolatile å¦åˆ™è¿˜æ˜¯ä¼šå‡ºç°è„è¯»é—®é¢˜","likes_number":4,"is_delete":false,"is_hidden":false,"ctime":1571306027,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":363,"ip_address":""},"score":35801,"extra":""}]}]},{"had_liked":false,"id":71943,"user_name":"å‘æ¡æ©™å­ ã€‚","can_delete":false,"product_type":"c1","uid":1259218,"ip_address":"","ucode":"ED076F4534FFED","user_header":"https://static001.geekbang.org/account/avatar/00/13/36/d2/c7357723.jpg","comment_is_top":false,"comment_ctime":1551490948,"is_pvip":false,"replies":[{"id":"26088","content":"ä½ åˆ†æçš„æ¯”æˆ‘è¿˜è¦å¥½ï¼","user_name":"ä½œè€…å›å¤","comment_id":71943,"uid":"1269969","ip_address":"","utype":1,"ctime":1551520447,"user_name_real":"ç‹å®ä»¤"}],"discussion_count":11,"race_medal":0,"score":"190530051972","product_id":100023901,"comment_content":"æ„Ÿæ‚Ÿ ï¼š <br>è€å¸ˆç”¨ç¬¬ä¸€ç¯‡ä»‹ç»äº†é€ æˆå¹¶å‘é—®é¢˜çš„ç”±æ¥å¼•å‡ºäº†æ­¤æ–‡å¦‚æœè§£å†³å…¶ä¸­çš„ å¯è§æ€§ã€æ’åºæ€§é—®é¢˜ ã€‚ æœ‰äº†ç¬¬ä¸€ç¯‡åšé“ºå«è®©æ­¤ç¯‡çœ‹èµ·æ¥æ›´åŠ çš„æµç•… ã€‚ <br><br>å°¤å…¶ä»¥å‰çœ‹ä¹¦ä¸­è®²è§£ happens-beforeåŸåˆ™åªæ˜¯å•å•æŠŠå…­ä¸ªè§„åˆ™ç‚¹åˆ—äº†å‡ºæ¥ï¼Œå¾ˆéš¾åƒé€ã€‚æ­¤ç¯‡æ–‡ç« ç»™å‡ºè¯¦ç»†çš„äº‹ä¾‹é€ç‚¹åˆ†æï¼Œä½¿å¾—æ›´å¥½çš„å»ç†è§£æ¯ä¸ªç‚¹ã€‚ <br><br>ä¾‹å¦‚ æˆ‘ä¹‹å‰çœ‹åˆ°çš„æ–‡ç« éƒ½è¯´ åœ¨å•çº¿ç¨‹ä¸­ä¸ä¼šå‡ºç°æœ‰åºæ€§é—®é¢˜ ï¼Œåœ¨å¤šçº¿ç¨‹ä¸­ä¼šå‡ºç°æœ‰åºæ€§é—®é¢˜ã€‚ ä¹‹å‰å¾ˆéš¾ç†è§£å•çº¿ç¨‹ä¸­æ²¡æœ‰æœ‰åºæ€§çš„é—®é¢˜æ˜¯ä»€ä¹ˆåŸå› ï¼Œ åŸæ¥æ˜¯happens-beforeç¬¬ä¸€æ¡è§„åˆ™é™åˆ¶ä½äº†ç¼–è¯‘å™¨çš„ä¼˜åŒ–<br><br>é—®é¢˜ï¼š <br>ç¬¬ä¸€ä¸ªä¾‹å­ä¸­æ·»åŠ äº† volatile å…³é”®å­—ï¼Œ å¦‚æœä¾‹å­ä¸­ ï¼Œ vå˜é‡æ²¡æœ‰ä½¿ç”¨volatile ï¼Œé‚£ä¹ˆxä¼šæ˜¯ä»€ä¹ˆå‘¢ ï¼Ÿï¼Ÿ<br>ç­”æ¡ˆï¼š 42<br><br>æˆ‘çš„æ€è€ƒæ˜¯ï¼Œ æ²¡æœ‰äº†volatileé‚£ä¹ˆè§„åˆ™äºŒå°±ä¸æ»¡è¶³ ï¼Œ ä½†æ˜¯è§„åˆ™ä¸€å’Œè§„åˆ™ä¸‰è¿˜æ˜¯æ»¡è¶³ ï¼Œè™½ç„¶ writer()æ–¹æ³•ä¿®æ”¹ vä¸èƒ½è®©å…¶ä»–ç«‹å³å¯è§ï¼Œä½†æ˜¯å¦‚æœæ˜¯å¾ªç¯è°ƒç”¨reader()æ–¹æ³• ï¼Œç­‰åˆ°å¯è§åˆ° v == trueï¼Œæ ¹æ®ç¬¬ä¸€æ¡åŸåˆ™ ï¼Œ x happens-before v ï¼Œæ‰€ä»¥èƒ½è¯»åˆ° x=42 <br><br>è€å¸ˆè¯·é—®æˆ‘çš„åˆ¤æ–­æ­£ç¡®ä¹ˆï¼Ÿ<br><br><br>æ€è€ƒé¢˜ ï¼š<br><br>ä¸€ä¸ªå…±äº«å˜é‡åœ¨ä¸€ä¸ªçº¿ç¨‹ä¸­ä¿®æ”¹è®©å¦å…¶ä»–çº¿ç¨‹å¯è§ï¼Œ é‚£å°±æ˜¯è§£å†³å¯è§æ€§ï¼ˆç¼“å­˜ï¼‰çš„é—®é¢˜ , happens-beforeçš„è§„åˆ™å°±æ˜¯ç”¨äºå¯¹å¯è§æ€§è¿›è¡Œçº¦æŸçš„<br><br>æŒ‰ç…§è€å¸ˆè¯¾ä¸­æ‰€è®² ï¼š<br>æ€è€ƒå¦‚ä¸‹ï¼š<br><br>  1. ç¬¬ä¸€æ¡è§„åˆ™åŒçº¿ç¨‹ä¸­ç¼–è¯‘ä¼šä¿è¯é¡ºåºæ€§ ï¼Œ å’Œé—®é¢˜ä¸ç¬¦åˆ <br><br> 2. ç¬¬äºŒæ¡è§„åˆ™ ï¼Œ ä½¿ç”¨volatileå…³é”®å­— ï¼Œ è¿™ä¸ªå…³é”®å­—å¯ä»¥è®©å…¶ä»–çº¿ç¨‹å†™ä¹‹å‰å…ˆè¯»æœ€æ–°çš„å€¼ï¼Œæ‰€ä»¥ä¿è¯è¯»åˆ°çš„æ˜¯æœ€æ–°çš„å€¼ ï¼Œå¯è¡Œ<br><br>3. ç¬¬ä¸‰æ¡è§„åˆ™ ï¼Œä¼ é€’æ€§ï¼Œ å’Œé—®é¢˜ä¸ç¬¦<br><br>4. ç¬¬å››æ¡è§„åˆ™ï¼Œ ä½¿ç”¨ç®¡ç¨‹ï¼Œç”±äºæ˜¯è®¿é—®å…±äº«å˜é‡ï¼Œå¦‚æœæ˜¯åœ¨synä¸­ä¿®æ”¹å€¼åªèƒ½ä¿è¯å½“å‰çº¿ç¨‹ä¸‹ä¸€æ¬¡è¿›å…¥synå¯ä»¥çœ‹è§æœ€æ–°çš„å€¼ï¼Œå…¶ä»–çº¿ç¨‹ç›´æ¥è®¿é—®è¿˜å¯èƒ½ä¸æ˜¯æœ€æ–°å€¼ ï¼Œ ä¸è¡Œ<br><br>5. ç¬¬äº”æ¡è§„åˆ™ ï¼Œ å¦‚æœå‰ææ˜¯å…¶ä»–çº¿ç¨‹éƒ½åœ¨ ä¸»çº¿ç¨‹ä¿®æ”¹abcå˜é‡å start()ï¼Œåˆ™å¯è§<br><br>6. ç¬¬å…­æ¡è§„åˆ™ ï¼Œå¦‚æœå‰ææ˜¯å…¶ä»–çº¿ç¨‹ç­‰ ä¿®æ”¹abcå˜é‡çº¿ç¨‹ join()æ‰§è¡Œï¼Œåˆ™å¯è§<br><br>  7.   Finalå…³é”®å­—ï¼Œ ç”±äºfinalå…³é”®å­—è¡¨ç¤ºå·²ç»å®šä¹‰äº†å¸¸é‡ï¼Œä»»æ„çº¿ç¨‹éƒ½ä¸å¯ä»¥ä¿®æ”¹ï¼Œ ä¸å¯ç”¨ <br><br>ç»¼ä¸Šæ€»ç»“ ï¼š <br><br>ä½¿ç”¨2 æ·»åŠ volatileå¯è¡Œ ã€‚åœ¨ç¬¦åˆæŸäº›åœºæ™¯ä¸‹æ—¶ï¼Œ56å¯è®©å…¶ä»–çº¿ç¨‹å¯è§<br><br><br>","like_count":44,"discussions":[{"author":{"id":1269969,"avatar":"https://static001.geekbang.org/account/avatar/00/13/60/d1/8efa89ab.jpg","nickname":"ç‹å®ä»¤","note":"","ucode":"4FE19F5BC32FCA","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":441406,"discussion_content":"ä½ åˆ†æçš„æ¯”æˆ‘è¿˜è¦å¥½ï¼","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1551520447,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1034451,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/c8/d3/3020ae46.jpg","nickname":"fatme","note":"","ucode":"75A805D2BB2AD1","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":332308,"discussion_content":"1. ç®€å•åœ°è¯´ï¼Œè§„åˆ™ 1 æ˜¯è¦ä¿è¯ï¼Œå•çº¿ç¨‹æ‰§è¡Œçš„æ—¶å€™ï¼Œç¨‹åºçš„ç»“æœæ˜¯è¦ç¬¦åˆæºä»£ç è¡¨è¾¾çš„æ‰§è¡Œé¡ºåºå’Œè¯­ä¹‰çš„ã€‚æ›´é€šä¿—åœ°è¯´ï¼Œå•çº¿ç¨‹æ‰§è¡Œçš„ç»“æœï¼Œæ˜¯è¦ç¬¦åˆç¨‹åºå‘˜çš„é¢„æœŸçš„ã€‚åªè¦ç¬¦åˆè¿™ä¸ªè§„åˆ™ï¼Œç¼–è¯‘å™¨å¯ä»¥è¿›è¡Œä»»ä½•ç¼–è¯‘ä¼˜åŒ–ã€‚è€Œ x=42, v=true è¿™ä¸¤ä¸ªè¯­å¥æ²¡æœ‰ä¾èµ–å…³ç³»ã€‚æ‰€ä»¥åœ¨å•çº¿ç¨‹å†…ï¼Œå¦‚æœç¼–è¯‘å™¨é€šè¿‡æŒ‡ä»¤é‡æ’åºï¼ŒæŠŠè¿™ä¸¤ä¸ªè¯­å¥çš„é¡ºåºå¯¹è°ƒæ‰§è¡Œï¼Œå¹¶ä¸ä¼šå½±å“ç¨‹åºæ‰§è¡Œçš„ç»“æœã€‚æ‰€ä»¥åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œè§„åˆ™ 1 æ˜¯å…è®¸è¿™ä¸¤ä¸ªè¯­å¥çš„ç¼–è¯‘åçš„æ‰§è¡Œé¡ºåºï¼Œä¸æºä»£ç ä¸åŒçš„ã€‚\n\n2. è§„åˆ™ 1 å¯¼è‡´çš„ä¸€ä¸ªç°è±¡æ˜¯ï¼Œåªè¦ç¼–è¯‘åçš„ä»£ç ç¬¦åˆè§„åˆ™ 1ï¼Œé‚£ä¹ˆåœ¨æ‰§è¡Œç¼–è¯‘åä»£ç çš„å•ä¸€çº¿ç¨‹å†…ï¼Œä¸€åˆ‡éƒ½åƒæ˜¯å’Œæºä»£ç è¡¨è¾¾çš„æ‰§è¡Œæµç¨‹ä¸€è‡´çš„ã€‚åœ¨å•ä¸€çº¿ç¨‹å†…ï¼Œæ˜¯æ„Ÿè§‰ä¸åˆ°ç¼–è¯‘å™¨åšçš„æŒ‡ä»¤é‡æ’åºä¼˜åŒ–çš„å½±å“çš„ã€‚\n\n3. ä½†æ˜¯æƒ³è±¡ä¸€ä¸‹å¦‚ä¸‹æƒ…å†µã€‚å¦‚æœæˆ‘ä»¬ä»å­˜åœ¨æŒ‡ä»¤é‡æ’åºçš„çº¿ç¨‹ä»¥å¤–ï¼Œå»è§‚å¯Ÿè¿™ä¸ªçº¿ç¨‹çš„æ‰§è¡Œï¼Œå´æ˜¯ä¼šæ„Ÿå—åˆ°è¢«è§‚å¯Ÿçº¿ç¨‹çš„æŒ‡ä»¤é‡æ’åºçš„ã€‚æ‰€ä»¥ï¼Œå¯¹äºå…¶å®ƒçº¿ç¨‹æ¥è¯´ï¼Œæ˜¯ä¼šå—åˆ°è¿™ä¸ªçº¿ç¨‹çš„æŒ‡ä»¤é‡æ’åºçš„å½±å“çš„ã€‚æ¥¼ä¸»è¯´å…‰æ˜¯è§„åˆ™ 1, è§„åˆ™ 3 å°±å¯ä»¥ä¿è¯ç¬¬äºŒä¸ªçº¿ç¨‹è¯»åˆ° x == 42ï¼Œè¿™æ˜¯ä¸å¯¹çš„ã€‚\n\n4. synchronized æ˜¯å¯ä»¥ä¿è¯å…±äº«å˜é‡çš„å¯è§æ€§çš„ã€‚ä¸ä½†å¦‚æ­¤ï¼Œå®ƒè¿˜å¯ä»¥ä¿è¯ åŸå­æ€§ å’Œ æœ‰åºæ€§ã€‚synchronized å¯¹å¯è§æ€§çš„ä¿è¯ï¼Œæ˜¯ç”± ç®¡ç¨‹é”è§„åˆ™, ç¨‹åºé¡ºåºæ€§è§„åˆ™ å’Œ ä¼ é€’æ€§ å…±åŒé™å®šçš„ã€‚\n\n5. ä½†æ˜¯ï¼Œåªæœ‰å½“æ‰€æœ‰è®¿é—®å…±äº«å˜é‡çš„çº¿ç¨‹ï¼Œéƒ½æ˜¯é€šè¿‡åŒä¸€ä¸ªé”çš„ synchronized ä»£ç å»è®¿é—®æ­¤å˜é‡ï¼Œæ‰èƒ½ä¿è¯å…¶å¯è§æ€§ã€‚å¦‚æœæœ‰çº¿ç¨‹ç”¨é synchronzied ä¿æŠ¤çš„ä»£ç ï¼Œæˆ–è€…å…¶å®ƒé”çš„ synchronized ä»£ç å»è®¿é—®æ­¤å˜é‡ï¼Œé‚£ä¹ˆæ‰€æœ‰çº¿ç¨‹éƒ½å¯èƒ½çœ‹ä¸åˆ°æ­¤å˜é‡çš„æœ€æ–°å€¼ã€‚","likes_number":4,"is_delete":false,"is_hidden":false,"ctime":1607155653,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1361746,"avatar":"https://static001.geekbang.org/account/avatar/00/14/c7/52/c5adf218.jpg","nickname":"å–œæ¬¢åœ°çƒçš„é˜¿åŸ¹åŒå­¦","note":"","ucode":"5F97037585F857","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":87657,"discussion_content":"ç¬¬å››ç‚¹å¥½åƒä¸å¯¹å§ï¼Œå¦‚æœæ˜¯åœ¨synä¸­ä¿®æ”¹å€¼ï¼Œé‚£ä¹ˆåœ¨synè¿‡åä¼šé‡Šæ”¾é”ï¼Œä¸”åˆ·æ–°cpuç¼“å­˜ï¼Œé‚£ä¹ˆå…¶ä»–çº¿ç¨‹å†æ¬¡è¿›å…¥synæ—¶ï¼Œå°±ä¼šä»å†…å­˜ä¸­è¯»å–æœ€æ–°çš„å€¼ã€‚","likes_number":4,"is_delete":false,"is_hidden":false,"ctime":1576676591,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1183424,"avatar":"https://static001.geekbang.org/account/avatar/00/12/0e/c0/95fa2666.jpg","nickname":"å±±æ¥‚æ ‘","note":"","ucode":"1D59FC0C560BCD","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":5524,"discussion_content":"æˆ‘æ˜¯è¿™ä¹ˆç†è§£çš„ï¼Œè§„åˆ™1çš„é¡ºåºæ€§ï¼Œæ˜¯æŒ‡çš„å•çº¿ç¨‹å†…çš„é¡ºåºæ€§ï¼Œè€Œå¤šçº¿ç¨‹ä¹‹é—´è§‚å¯Ÿåˆ™ä¸èƒ½ä¿è¯è¿™ä¸€ç‚¹ã€‚å¦‚æœvä¸ç”¨volatileä¿®é¥°ï¼Œåœ¨çº¿ç¨‹Aä¸­ï¼Œx=42 happens-before v=trueï¼Œä½†æ˜¯è¿™ä¸¤æ¡æŒ‡ä»¤å­˜åœ¨é‡æ’åºçš„å¯èƒ½æ€§ï¼Œv=trueåœ¨æ—¶é—´ä¸Šå¯èƒ½å…ˆäºx=42æ‰§è¡Œã€‚å¦‚æœæ­¤æ—¶è¿›è¡Œçº¿ç¨‹åˆ‡æ¢ï¼Œåœ¨çº¿ç¨‹Bä¸­ï¼Œv==trueï¼Œä½†æ˜¯ä¸èƒ½ä¿è¯x=42ã€‚\n","likes_number":4,"is_delete":false,"is_hidden":false,"ctime":1566344794,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1123043,"avatar":"https://static001.geekbang.org/account/avatar/00/11/22/e3/510b69f9.jpg","nickname":"benny","note":"","ucode":"E2F30AF0C808D9","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":102629,"discussion_content":"åˆ†æçš„æ˜æ˜¾æœ‰é”™è¯¯ã€‚ã€‚ã€‚","likes_number":1,"is_delete":false,"is_hidden":false,"ctime":1577357498,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1282575,"avatar":"https://static001.geekbang.org/account/avatar/00/13/92/0f/cff30522.jpg","nickname":"æ±Ÿæ¹–å¤œé›¨","note":"","ucode":"C64913C7000899","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":2335,"discussion_content":"å¦‚æœvä¸ç”¨volatileä¿®é¥°ï¼ŒBçº¿ç¨‹ä¸­xæœ‰å¯èƒ½ä¸º0æˆ–42ï¼Œå› ä¸ºæŒ‡ä»¤ä¼šä½¿å¾—å˜é‡x,vé‡æ’åº","likes_number":1,"is_delete":false,"is_hidden":false,"ctime":1563496405,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":2,"child_discussions":[{"author":{"id":1182200,"avatar":"https://static001.geekbang.org/account/avatar/00/12/09/f8/5f74ff5b.jpg","nickname":"Owen","note":"","ucode":"ADE38F8D446860","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":1282575,"avatar":"https://static001.geekbang.org/account/avatar/00/13/92/0f/cff30522.jpg","nickname":"æ±Ÿæ¹–å¤œé›¨","note":"","ucode":"C64913C7000899","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":267089,"discussion_content":"é‚£ç¬¬ä¸€æ¡è§„åˆ™ä½•åœ¨ï¼Ÿ","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1589599260,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":2335,"ip_address":""},"score":267089,"extra":""},{"author":{"id":1424609,"avatar":"https://static001.geekbang.org/account/avatar/00/15/bc/e1/cb5ffddf.jpg","nickname":"è¯å‘³","note":"","ucode":"8D894D423BBB54","race_medal":0,"user_type":1,"is_pvip":true},"reply_author":{"id":1182200,"avatar":"https://static001.geekbang.org/account/avatar/00/12/09/f8/5f74ff5b.jpg","nickname":"Owen","note":"","ucode":"ADE38F8D446860","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":559612,"discussion_content":"æ²¡æœ‰è¿åè§„åˆ™ä¸€\nä¾‹å¦‚ï¼š\n1ï¼šint a = 1;\n2ï¼šint b = 2;\n3ï¼šSystem.out.println(a);\n\nä¸€å®šä¼šä¿è¯3åœ¨1ä¹‹åæ‰§è¡Œï¼Œå³è¾“å‡º1,ã€‚ä½†ä¸èƒ½ä¿è¯2ä¸€å®šåœ¨1ä¹‹åï¼ˆé‡æ’åºåï¼‰ï¼Œå› ä¸º2æ²¡æœ‰ä¾èµ–1","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1648833393,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":267089,"ip_address":""},"score":559612,"extra":""}]},{"author":{"id":1044841,"avatar":"http://thirdwx.qlogo.cn/mmopen/vi_32/bDlEdYdNiaPq1X0tt9wO4lSzOepddjPobjLW7YWpUd8MHDicVbt5kXE0SicvkvjRCNqreAthuqlyibLuGfXUvGoFbA/132","nickname":"æ›¹ä¸½æ°","note":"","ucode":"D702455FFD2C92","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":387157,"discussion_content":"æ˜¯ä¸æ˜¯è¿™é‡Œå³ä½¿æ²¡æœ‰æŒ‡ä»¤é‡æ’åºï¼Œå½“çº¿ç¨‹B çœ‹åˆ°v=trueæ—¶ï¼Œåœ¨çº¿ç¨‹Açš„æ–¹æ³•å †æ ˆé‡Œx=42çš„å€¼å¯èƒ½è¿˜åœ¨CPUç¼“å­˜ä¸­ï¼Œè¿˜æ²¡åˆ·å…¥å†…å­˜ä¸­ï¼Œè¿™æ—¶çº¿ç¨‹Bä¹Ÿå°±çœ‹ä¸åˆ°x=42.","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1628007240,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1213058,"avatar":"https://static001.geekbang.org/account/avatar/00/12/82/82/d8e03843.jpg","nickname":"å†åšç¾½å“²","note":"","ucode":"5A081440FC3363","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":194516,"discussion_content":"æˆ‘ä¸æ˜ç™½ä¸ºä»€ä¹ˆç¬¬å››æ¡ä¸è¡Œï¼Œåœ¨synä¸­ æ¯æ¬¡åªå¯ä»¥è¿›å…¥ä¸€ä¸ªçº¿ç¨‹è¿›è¡Œå†™æ“ä½œ å½“å‰çº¿ç¨‹å†™å®Œäº†ä»¥å å…¶ä»–çº¿ç¨‹å†è¿›å…¥ å°±å¯ä»¥è¯»åˆ°æœ€æ–°çš„å€¼äº†å•Š","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1583227474,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":1,"child_discussions":[{"author":{"id":1928441,"avatar":"http://thirdwx.qlogo.cn/mmopen/vi_32/cfNtHoAbHvia1O0jIopiafYbnppEPiawgicKa8vdI2FxMMEdqORB4VLzkYTuGJGA7HibustnU0hDTOD7YSDAWuxhmrg/132","nickname":"Geek_299a34","note":"","ucode":"79AECE06F08E87","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":1213058,"avatar":"https://static001.geekbang.org/account/avatar/00/12/82/82/d8e03843.jpg","nickname":"å†åšç¾½å“²","note":"","ucode":"5A081440FC3363","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":309583,"discussion_content":"è¯»çº¿ç¨‹æ²¡åŠ äº’æ–¥é”ï¼Œè¯»åˆ°çš„å¯èƒ½å°±ä¸æ˜¯æœ€æ–°å€¼","likes_number":2,"is_delete":false,"is_hidden":false,"ctime":1601358090,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":194516,"ip_address":""},"score":309583,"extra":""}]}]},{"had_liked":false,"id":72277,"user_name":"æ","can_delete":false,"product_type":"c1","uid":1119312,"ip_address":"","ucode":"5C0FAA211F2E26","user_header":"https://static001.geekbang.org/account/avatar/00/11/14/50/c23cf47d.jpg","comment_is_top":false,"comment_ctime":1551569434,"is_pvip":true,"replies":[{"id":"26183","content":"å¯ä»¥é‡æ’ï¼Œä½†æ˜¯è¦ä¿è¯ç¬¦åˆHappens-Beforeè§„åˆ™ï¼ŒHappens-Beforeè§„åˆ™å…³æ³¨çš„æ˜¯å¯è§æ€§ï¼Œ<br>x=5;<br>y=6;<br>z=x+y;<br>ä¸Šé¢çš„ä»£ç é‡æ’æˆè¿™æ ·ï¼š<br>y=6;<br>x=5;<br>z=x+y;<br>ä¹Ÿæ˜¯å¯ä»¥çš„ã€‚<br><br>æ‰€è°“é¡ºåºï¼ŒæŒ‡çš„æ˜¯ä½ å¯ä»¥ç”¨é¡ºåºçš„æ–¹å¼æ¨æ¼”ç¨‹åºçš„æ‰§è¡Œï¼Œä½†æ˜¯ç¨‹åºçš„æ‰§è¡Œä¸ä¸€å®šæ˜¯å®Œå…¨é¡ºåºçš„ã€‚ç¼–è¯‘å™¨ä¿è¯ç»“æœä¸€å®š == é¡ºåºæ–¹å¼æ¨æ¼”çš„ç»“æœ<br><br>è¿™å‡ æ¡è§„åˆ™ï¼Œéƒ½æ˜¯å‘Šè¯‰ä½ ï¼Œå¯ä»¥æŒ‰ç…§è¿™ä¸ªè§„åˆ™æ¨æ¼”ç¨‹åºçš„æ‰§è¡Œã€‚ä½†æ˜¯ç¼–è¯‘æ€ä¹ˆä¼˜åŒ–ï¼Œé‚£å°±ç™¾èŠ±é½æ”¾äº†ã€‚","user_name":"ä½œè€…å›å¤","comment_id":72277,"uid":"1269969","ip_address":"","utype":1,"ctime":1551583339,"user_name_real":"ç‹å®ä»¤"}],"discussion_count":6,"race_medal":0,"score":"181940195866","product_id":100023901,"comment_content":"è€å¸ˆï¼Œç¬¬ä¸€ç« é‡Œæåˆ°ç¨‹åºä¸­x=5ï¼›x=6å¯èƒ½è¢«é‡æ’ã€‚å¯æ˜¯ä»Šå¤©ç¬¬ä¸€ä¸ªè§„åˆ™é‡Œæåˆ°ï¼ŒåŒä¸€ä¸ªçº¿ç¨‹é‡Œï¼Œæ˜¯é¡ºåºçš„ã€‚è¿™ä¸¤ä¸ªä¸å°±çŸ›ç›¾äº†å—ï¼Ÿ","like_count":42,"discussions":[{"author":{"id":1636795,"avatar":"https://static001.geekbang.org/account/avatar/00/18/f9/bb/25c08b00.jpg","nickname":"Jason","note":"","ucode":"D29C93256F4A37","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":90906,"discussion_content":"å…³äºè¿™ä¸ªé—®é¢˜ï¼Œä½ å¯ä»¥çœ‹çœ‹è¿™ä¸ªé—®é¢˜https://stackoverflow.com/questions/16213443/instruction-reordering-happens-before-relationship-in-javaï¼Œè¿˜æœ‰è¿™ç¯‡æ–‡ç« https://preshing.com/20130702/the-happens-before-relation/ã€‚happens-beforeä¸ä»£è¡¨æ—¶é—´ä¸Šçš„å…ˆå‘ç”Ÿï¼Œåªè¦ç¨‹åºçš„æ‰§è¡Œç»“æœèƒ½å¤Ÿä¿è¯consistencyå°±è¡Œã€‚","likes_number":6,"is_delete":false,"is_hidden":false,"ctime":1576802778,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":1,"child_discussions":[{"author":{"id":1043789,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/ed/4d/1d1a1a00.jpg","nickname":"magict4","note":"","ucode":"CB6F063D881AAC","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":1636795,"avatar":"https://static001.geekbang.org/account/avatar/00/18/f9/bb/25c08b00.jpg","nickname":"Jason","note":"","ucode":"D29C93256F4A37","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":103878,"discussion_content":"è¿™ä¸¤ä¸ªé“¾æ¥å®åœ¨å¤ªæ£’äº†ï¼Œè°¢è°¢ï¼","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1577404952,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":90906,"ip_address":""},"score":103878,"extra":""}]},{"author":{"id":1123043,"avatar":"https://static001.geekbang.org/account/avatar/00/11/22/e3/510b69f9.jpg","nickname":"benny","note":"","ucode":"E2F30AF0C808D9","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":102637,"discussion_content":"æ–‡ä¸­çš„ç¨‹åºçš„é¡ºåºæ€§è§„åˆ™ä¸å¦‚è¿™é‡Œè¯´çš„æ˜ç™½","likes_number":4,"is_delete":false,"is_hidden":false,"ctime":1577357921,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1269969,"avatar":"https://static001.geekbang.org/account/avatar/00/13/60/d1/8efa89ab.jpg","nickname":"ç‹å®ä»¤","note":"","ucode":"4FE19F5BC32FCA","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":441520,"discussion_content":"å¯ä»¥é‡æ’ï¼Œä½†æ˜¯è¦ä¿è¯ç¬¦åˆHappens-Beforeè§„åˆ™ï¼ŒHappens-Beforeè§„åˆ™å…³æ³¨çš„æ˜¯å¯è§æ€§ï¼Œ\nx=5;\ny=6;\nz=x+y;\nä¸Šé¢çš„ä»£ç é‡æ’æˆè¿™æ ·ï¼š\ny=6;\nx=5;\nz=x+y;\nä¹Ÿæ˜¯å¯ä»¥çš„ã€‚\n\næ‰€è°“é¡ºåºï¼ŒæŒ‡çš„æ˜¯ä½ å¯ä»¥ç”¨é¡ºåºçš„æ–¹å¼æ¨æ¼”ç¨‹åºçš„æ‰§è¡Œï¼Œä½†æ˜¯ç¨‹åºçš„æ‰§è¡Œä¸ä¸€å®šæ˜¯å®Œå…¨é¡ºåºçš„ã€‚ç¼–è¯‘å™¨ä¿è¯ç»“æœä¸€å®š == é¡ºåºæ–¹å¼æ¨æ¼”çš„ç»“æœ\n\nè¿™å‡ æ¡è§„åˆ™ï¼Œéƒ½æ˜¯å‘Šè¯‰ä½ ï¼Œå¯ä»¥æŒ‰ç…§è¿™ä¸ªè§„åˆ™æ¨æ¼”ç¨‹åºçš„æ‰§è¡Œã€‚ä½†æ˜¯ç¼–è¯‘æ€ä¹ˆä¼˜åŒ–ï¼Œé‚£å°±ç™¾èŠ±é½æ”¾äº†ã€‚","likes_number":1,"is_delete":false,"is_hidden":false,"ctime":1551583339,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1552006,"avatar":"https://static001.geekbang.org/account/avatar/00/17/ae/86/47c9d7f3.jpg","nickname":"ä¼¤å¿ƒçš„ç«è½¦","note":"","ucode":"9CF33A4F91C252","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":213788,"discussion_content":"å¯ä»¥çš„ï¼Œè¿™ä¸ªè§£é‡Šçš„å¾ˆæ¸…æ¥š","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1585122489,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1033240,"avatar":"https://wx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTJkwbyTYtSCx6Qc7cQPnnRWv38Jybh3etziaPmuP8gHcgS6FMxcdftrKgWiamH6fc2iciaicDKDVEwcEibQ/132","nickname":"sami","note":"","ucode":"9A66FCA00D8A37","race_medal":0,"user_type":1,"is_pvip":true},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":209955,"discussion_content":"æ²¡æœ‰ä¾èµ–çš„æƒ…å†µå¯èƒ½ä¼šé‡æ–°æ’åºï¼Œå› ä¸ºå‘½ä»¤å‘é€åˆ°å¤„ç†å™¨çš„è¯æ˜¯æ‰¹é‡å‘çš„","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1584694284,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":72017,"user_name":"tracer","can_delete":false,"product_type":"c1","uid":1124766,"ip_address":"","ucode":"AE2BC047DB7D7D","user_header":"https://static001.geekbang.org/account/avatar/00/11/29/9e/380a01ea.jpg","comment_is_top":false,"comment_ctime":1551498941,"is_pvip":false,"replies":[{"id":"26100","content":"ç»ˆäºç†è§£äº†ï¼","user_name":"ä½œè€…å›å¤","comment_id":72017,"uid":"1269969","ip_address":"","utype":1,"ctime":1551522098,"user_name_real":"ç‹å®ä»¤"}],"discussion_count":3,"race_medal":1,"score":"156170321597","product_id":100023901,"comment_content":"æˆ‘æ˜ç™½äº†ï¼Œå†™å…ˆäºè¯»æŒ‡çš„æ˜¯ä¸ä¼šå› ä¸ºcpuç¼“å­˜ï¼Œå¯¼è‡´açº¿ç¨‹å·²ç»å†™äº†ï¼Œä½†æ˜¯bçº¿ç¨‹æ²¡è¯»åˆ°çš„æƒ…å†µã€‚æˆ‘é”™è¯¯ç†è§£æˆäº†bè¦è¯»ï¼Œä¸€å®šè¦ç­‰aå†™å®Œæ‰è¡Œ","like_count":36,"discussions":[{"author":{"id":1269969,"avatar":"https://static001.geekbang.org/account/avatar/00/13/60/d1/8efa89ab.jpg","nickname":"ç‹å®ä»¤","note":"","ucode":"4FE19F5BC32FCA","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":441426,"discussion_content":"ç»ˆäºç†è§£äº†ï¼","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1551522098,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1594508,"avatar":"https://static001.geekbang.org/account/avatar/00/18/54/8c/a3b98f6c.jpg","nickname":"denofiend","note":"","ucode":"FC9A750C96E01C","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":531259,"discussion_content":"è¯»ä¹‹å‰ å…±äº«å˜é‡æ”¹ è¯»ä¹‹å åšä¸ªå®éªŒ","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1637253497,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"user_type\":1}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1503063,"avatar":"https://static001.geekbang.org/account/avatar/00/16/ef/57/0e128187.jpg","nickname":"èœé¸Ÿå•Šèœé¸Ÿ","note":"","ucode":"2F764CEBD3FDAC","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":415268,"discussion_content":"æˆ‘ç†è§£æ˜¯ï¼šçº¿ç¨‹Aå†™äº†ä¸€å®šä¼šä¼šè¢«çº¿ç¨‹Bè¯»åˆ°è¿™ä¸ªæ•°æ®ã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1637043319,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":72469,"user_name":"magict4","can_delete":false,"product_type":"c1","uid":1043789,"ip_address":"","ucode":"CB6F063D881AAC","user_header":"https://static001.geekbang.org/account/avatar/00/0f/ed/4d/1d1a1a00.jpg","comment_is_top":false,"comment_ctime":1551650070,"is_pvip":false,"replies":[{"id":"26358","content":"â€œx=42â€ Happens-Before å†™å˜é‡ â€œv=trueâ€<br>æ˜¯å› ä¸ºç¨‹åºé¡ºåºå°±æ˜¯è¿™ä¹ˆå†™çš„ï¼šx=42ï¼›v=true<br><br>è¿™ä¸ªæ¡ˆä¾‹æ˜¯ç»¼åˆäº† ç¨‹åºçš„é¡ºåºè§„åˆ™+ä¼ é€’è§„åˆ™+volatile è§„åˆ™<br><br>è¿™ä¸‰è¿™ä¸ªè§„åˆ™ç»„åˆåœ¨ä¸€èµ·å°±æ˜¯ä½ æ‰€è°“çš„ï¼šâ€œè€Œæ˜¯æœ‰ volatile å†³å®šçš„â€ã€‚ç¼–è¯‘å™¨ä¼˜åŒ–è¦éµå¾ªæ‰€æœ‰çš„HBè§„åˆ™ã€‚æ‰€æœ‰ï¼Œä¸æ˜¯ä¸€æ¡ã€‚æ‰€ä»¥åªæœ‰æŠŠä»–ä»¬ç»„åˆåœ¨ä¸€èµ·æ‰æœ‰æ„ä¹‰ã€‚<br>","user_name":"ä½œè€…å›å¤","comment_id":72469,"uid":"1269969","ip_address":"","utype":1,"ctime":1551711470,"user_name_real":"ç‹å®ä»¤"}],"discussion_count":3,"race_medal":0,"score":"104630865174","product_id":100023901,"comment_content":"è€å¸ˆä½ å¥½ï¼Œ<br><br>æˆ‘å¯¹ã€3. ä¼ é€’æ€§ã€ä¸­æ‚¨çš„è§£é‡Šï¼Œè¿˜æ˜¯æœ‰ç‚¹ç–‘æƒ‘ã€‚æ„Ÿè§‰è®¸å¤šç•™è¨€çš„å°ä¼™ä¼´ä»¬ä¹Ÿéƒ½æœ‰ç±»ä¼¼çš„ç–‘æƒ‘ï¼Œè¿˜è¯·è€å¸ˆå†è€å¿ƒå›ç­”ä¸€æ¬¡ã€‚<br><br>æ‚¨æåˆ°ï¼š<br>&gt; â€œx=42â€ Happens-Before å†™å˜é‡ â€œv=trueâ€ ï¼Œè¿™æ˜¯è§„åˆ™ 1 çš„å†…å®¹ï¼›<br>æˆ‘çš„ç–‘æƒ‘ï¼šå˜é‡ x å’Œ v æ²¡æœ‰ä»»ä½•ä¾èµ–å…³ç³»ï¼Œä¸ºä»€ä¹ˆå¯¹ x çš„èµ‹å€¼ Happens-Before å¯¹ v çš„èµ‹å€¼å‘¢ï¼Ÿ<br><br>è¿™ä¸ª Happens-Before å…³ç³»ï¼Œæ ¹æ®æˆ‘çš„ç†è§£ï¼Œä¸æ˜¯ç”±è§„åˆ™ 1 å†³å®šçš„ï¼Œè€Œæ˜¯æœ‰ volatile å†³å®šçš„ã€‚å¦‚æœ v æ²¡æœ‰è¢« volatile ä¿®é¥°ï¼Œç¼–è¯‘å™¨æ˜¯å¯ä»¥å¯¹ xã€v çš„èµ‹å€¼è¯­å¥è¿›è¡Œé‡æ’çš„ã€‚ ä¸çŸ¥é“æˆ‘çš„ç†è§£æ˜¯å¦æœ‰é—®é¢˜ï¼Ÿ","like_count":24,"discussions":[{"author":{"id":1269969,"avatar":"https://static001.geekbang.org/account/avatar/00/13/60/d1/8efa89ab.jpg","nickname":"ç‹å®ä»¤","note":"","ucode":"4FE19F5BC32FCA","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":441603,"discussion_content":"â€œx=42â€ Happens-Before å†™å˜é‡ â€œv=trueâ€\næ˜¯å› ä¸ºç¨‹åºé¡ºåºå°±æ˜¯è¿™ä¹ˆå†™çš„ï¼šx=42ï¼›v=true\n\nè¿™ä¸ªæ¡ˆä¾‹æ˜¯ç»¼åˆäº† ç¨‹åºçš„é¡ºåºè§„åˆ™+ä¼ é€’è§„åˆ™+volatile è§„åˆ™\n\nè¿™ä¸‰è¿™ä¸ªè§„åˆ™ç»„åˆåœ¨ä¸€èµ·å°±æ˜¯ä½ æ‰€è°“çš„ï¼šâ€œè€Œæ˜¯æœ‰ volatile å†³å®šçš„â€ã€‚ç¼–è¯‘å™¨ä¼˜åŒ–è¦éµå¾ªæ‰€æœ‰çš„HBè§„åˆ™ã€‚æ‰€æœ‰ï¼Œä¸æ˜¯ä¸€æ¡ã€‚æ‰€ä»¥åªæœ‰æŠŠä»–ä»¬ç»„åˆåœ¨ä¸€èµ·æ‰æœ‰æ„ä¹‰ã€‚\n","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1551711470,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1043789,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/ed/4d/1d1a1a00.jpg","nickname":"magict4","note":"","ucode":"CB6F063D881AAC","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":103896,"discussion_content":"äºŒåˆ·ä¸­â€¦â€¦ï¼Œè°¢è°¢è€å¸ˆçš„å›å¤ï¼\n\nçœ‹åˆ°å¾ˆå¤šåŒå­¦ä¸€ç›´åœ¨çº ç»“æŒ‡ä»¤é‡æ’çš„é—®é¢˜ï¼Œå¯¹äºé¡ºåºè§„åˆ™æ¥è¯´ï¼Œæ˜¯æ— éœ€è€ƒè™‘æŒ‡ä»¤é‡æ’é—®é¢˜çš„ã€‚\n\nå¼•ç”¨è‡ª Oracle æ–‡æ¡£ï¼šhttps://docs.oracle.com/javase/specs/jls/se7/html/jls-17.html#jls-17.4.5\n> If x and y are actions of the same thread and x comes before y in program order, then hb(x, y)\næ³¨æ„æ–‡ä¸­çš„ &#34;program order&#34;ï¼Œå°±æ˜¯æºä»£ç é¡ºåºçš„æ„æ€ã€‚\n\nå¦‚æœå¤§å®¶è¿˜æ˜¯å¥½å¥‡â€œæŒ‡ä»¤é‡æ’â€ä¸â€œhappen-beforeâ€ä¹‹é—´çš„åŒºåˆ«è·Ÿè”ç³»ï¼Œå¼ºçƒˆæ¨è@Jasonåœ¨è¯„è®ºåŒºè´´çš„ä¸€ç¯‡æ–‡ç« ï¼šhttps://preshing.com/20130702/the-happens-before-relation/","likes_number":1,"is_delete":false,"is_hidden":false,"ctime":1577405817,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":1,"child_discussions":[{"author":{"id":1172145,"avatar":"https://static001.geekbang.org/account/avatar/00/11/e2/b1/d00399c0.jpg","nickname":"å¿ƒæœ‰æ—å¤•","note":"","ucode":"BC6E1AE557BFF4","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":1043789,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/ed/4d/1d1a1a00.jpg","nickname":"magict4","note":"","ucode":"CB6F063D881AAC","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":113149,"discussion_content":"é‚£ä¹ˆå¦‚æœvä¸æ˜¯votatileå˜é‡ï¼Œé‚£ä¹ˆä¼šé‡æ’åºä¹ˆï¼Ÿ","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1577890509,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":103896,"ip_address":""},"score":113149,"extra":""}]}]},{"had_liked":false,"id":72001,"user_name":"WL","can_delete":false,"product_type":"c1","uid":1173771,"ip_address":"","ucode":"6277DCD776B87E","user_header":"https://static001.geekbang.org/account/avatar/00/11/e9/0b/1171ac71.jpg","comment_is_top":false,"comment_ctime":1551497136,"is_pvip":false,"replies":[{"id":"26098","content":"æœ‰å¯èƒ½é€šè¿‡global.obj å¯èƒ½è®¿é—®åˆ°è¿˜æ²¡æœ‰åˆå§‹åŒ–çš„thiså¯¹è±¡<br>å°†thisèµ‹å€¼ç»™global.objæ—¶ï¼Œthisè¿˜æ²¡æœ‰åˆå§‹åŒ–å®Œï¼Œthisè¿˜æ²¡æœ‰åˆå§‹åŒ–å®Œï¼Œthisè¿˜æ²¡æœ‰åˆå§‹åŒ–å®Œã€‚","user_name":"ä½œè€…å›å¤","comment_id":72001,"uid":"1269969","ip_address":"","utype":1,"ctime":1551521969,"user_name_real":"ç‹å®ä»¤"}],"discussion_count":3,"race_medal":0,"score":"104630712240","product_id":100023901,"comment_content":"æƒ³é—®ä¸€ä¸‹è€å¸ˆæœ€åå…³äºé€¸å‡ºçš„ä¾‹å­ï¼Œæ˜¯å› ä¸ºæœ‰å¯èƒ½é€šè¿‡global.obj å¯èƒ½è®¿é—®åˆ°è¿˜æ²¡æœ‰åˆå§‹åŒ–çš„thiså¯¹è±¡å—ï¼Œä½†æ˜¯å°†thisèµ‹å€¼ç»™global.objä¸ä¹Ÿæ˜¯åˆå§‹åŒ–æ—¶æ‰èµ‹å€¼çš„å—ï¼Œè¿™éƒ¨åˆ†ä¸å¤ªç†è§£ï¼Œè¯·è€å¸ˆæŒ‡ç‚¹ä¸€ä¸‹","like_count":24,"discussions":[{"author":{"id":1269969,"avatar":"https://static001.geekbang.org/account/avatar/00/13/60/d1/8efa89ab.jpg","nickname":"ç‹å®ä»¤","note":"","ucode":"4FE19F5BC32FCA","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":441422,"discussion_content":"æœ‰å¯èƒ½é€šè¿‡global.obj å¯èƒ½è®¿é—®åˆ°è¿˜æ²¡æœ‰åˆå§‹åŒ–çš„thiså¯¹è±¡\nå°†thisèµ‹å€¼ç»™global.objæ—¶ï¼Œthisè¿˜æ²¡æœ‰åˆå§‹åŒ–å®Œï¼Œthisè¿˜æ²¡æœ‰åˆå§‹åŒ–å®Œï¼Œthisè¿˜æ²¡æœ‰åˆå§‹åŒ–å®Œã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1551521969,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1980201,"avatar":"https://static001.geekbang.org/account/avatar/00/1e/37/29/b3af57a7.jpg","nickname":"å‡¯æ–‡å°çŒª","note":"","ucode":"36D8AD0229547F","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":532984,"discussion_content":"æ˜¯çš„ è¿™å°±æ˜¯ç»å…¸çš„thisé€ƒé€¸ è¿™äº›åœ¨kafkaçš„produceræ„é€ å‡½æ•°é‡Œè¿˜æ˜¯å­˜åœ¨çš„ã€‚ä½†æ˜¯consumeræ„é€ å‡½æ•°é‡Œè¿˜æœ‰ \næˆ‘ä¸ªäººæ„Ÿè§‰æœ€åˆä¸æ˜¯ä¸€æ‰¹äººåŒæ—¶å†™çš„","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1637746280,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"user_type\":1}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1004192,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/52/a0/d308434e.jpg","nickname":"StarKing","note":"","ucode":"EB825CFA70AC1F","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":14598,"discussion_content":"ç®€å•çš„è¯´,æ­¤é­”ç«¥åœ¨åˆ«çš„åŒºåŸŸ(åŒ»é™¢)å‡ºç”Ÿäº†,ä½†è¿™ä¸ªå—è®¿çš„åŒ»é™¢æ ¹æœ¬ä¸çŸ¥é“(å¯¹å…¶ä¸å¯è§),è€Œ global.objæŒ‡å‘äº†ä¸€ä¸ªæœªçŸ¥çš„åŒºåŸŸ(åŒ»é™¢).ä¸èƒ½ä¿è¯æ‰€æœ‰çš„åŒ»é™¢éƒ½èƒ½åŠæ—¶å¾—çŸ¥.  å¦‚æœ global.objæ˜¾ç¤ºå£°æ˜volatile åˆ™é—®é¢˜è§£å†³.æ‰€æœ‰çš„åŒ»é™¢ä»æŸä¸ªä¿¡æ¯ä¸­å¿ƒåŒæ­¥åˆ·æ–°è·å–æ¶ˆæ¯,å¾—å…³æ­¤ç«¥çš„ä¿¡æ¯.","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1568772656,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":71960,"user_name":"Nevermore","can_delete":false,"product_type":"c1","uid":1228011,"ip_address":"","ucode":"06EBD2E6A9B436","user_header":"https://static001.geekbang.org/account/avatar/00/12/bc/eb/c22ef3a5.jpg","comment_is_top":false,"comment_ctime":1551492465,"is_pvip":false,"replies":[{"id":"26092","content":"ä½ çš„ç†è§£æ˜¯å¯¹çš„ï¼Œvolatileçš„å®ç°å°±æ˜¯è¿™æ ·çš„ã€‚æŒ‡å¯¼JVMè¿™ä¹ˆå®ç°çš„è§„èŒƒå°±æ˜¯å†…å­˜æ¨¡å‹ã€‚è¿™ä¸ªä¸“æ çš„ä¾§é‡ç‚¹æ˜¯è®©å¤§å®¶å­¦ä¼šå†™å¹¶å‘ç¨‹åºï¼Œè‡³äºåº•å±‚æ˜¯æ€ä¹ˆå®ç°çš„ï¼Œæœ‰ç²¾åŠ›å’Œå…´è¶£çš„åŒå­¦ï¼Œå¯ä»¥è‡ªå·±æ¥æŠŠæ¡ã€‚","user_name":"ä½œè€…å›å¤","comment_id":71960,"uid":"1269969","ip_address":"","utype":1,"ctime":1551521149,"user_name_real":"ç‹å®ä»¤"}],"discussion_count":4,"race_medal":0,"score":"96040772977","product_id":100023901,"comment_content":"&#47;&#47; ä»¥ä¸‹ä»£ç æ¥æºäºã€å‚è€ƒ 1ã€‘<br>class VolatileExample {<br>  int x = 0;<br>  volatile boolean v = false;<br>  public void writer() {<br>    x = 42;<br>    v = true;<br>  }<br>  public void reader() {<br>    if (v == true) {<br>      &#47;&#47; è¿™é‡Œ x ä¼šæ˜¯å¤šå°‘å‘¢ï¼Ÿ<br>    }<br>  }<br>}<br><br><br>æ„Ÿè§‰è€å¸ˆå¯¹è¿™ä¸ªvolatileå˜é‡è§„åˆ™è¿™å—è®²çš„æœ‰ç‚¹è‰ç‡ï¼Œvolatileå˜é‡çš„å†™å¯¹äºè¯»æ˜¯å¯è§çš„ï¼Œå¯¹äºç¨‹åºæ¥è¯´ï¼Œä¹Ÿå°±æ˜¯çº¿ç¨‹Aæ‰§è¡Œwriteä¸­çš„v=trueå¯¹äºreaderä¸­çš„v==trueæ˜¯å¯è§çš„ ï¼Œä½†æ˜¯è¿™å¯¹äºxæœ‰ä»€ä¹ˆå…³ç³»ï¼Ÿxå¹¶æ²¡æœ‰è¢«volatileä¿®é¥°ã€‚<br>æ ¹æ®æˆ‘çš„ç†è§£ï¼Œvolatileå¼ºåˆ¶æ‰€ä¿®é¥°çš„å˜é‡åŠå®ƒå‰è¾¹çš„å˜é‡åˆ·æ–°è‡³å†…å­˜ï¼Œå¹¶ä¸”volatileç¦æ­¢äº†æŒ‡ä»¤çš„é‡æ’åºã€‚<br> <br>æœ›æŒ‡æ­£<br>","like_count":22,"discussions":[{"author":{"id":1269969,"avatar":"https://static001.geekbang.org/account/avatar/00/13/60/d1/8efa89ab.jpg","nickname":"ç‹å®ä»¤","note":"","ucode":"4FE19F5BC32FCA","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":441411,"discussion_content":"ä½ çš„ç†è§£æ˜¯å¯¹çš„ï¼Œvolatileçš„å®ç°å°±æ˜¯è¿™æ ·çš„ã€‚æŒ‡å¯¼JVMè¿™ä¹ˆå®ç°çš„è§„èŒƒå°±æ˜¯å†…å­˜æ¨¡å‹ã€‚è¿™ä¸ªä¸“æ çš„ä¾§é‡ç‚¹æ˜¯è®©å¤§å®¶å­¦ä¼šå†™å¹¶å‘ç¨‹åºï¼Œè‡³äºåº•å±‚æ˜¯æ€ä¹ˆå®ç°çš„ï¼Œæœ‰ç²¾åŠ›å’Œå…´è¶£çš„åŒå­¦ï¼Œå¯ä»¥è‡ªå·±æ¥æŠŠæ¡ã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1551521149,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1282575,"avatar":"https://static001.geekbang.org/account/avatar/00/13/92/0f/cff30522.jpg","nickname":"æ±Ÿæ¹–å¤œé›¨","note":"","ucode":"C64913C7000899","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":2334,"discussion_content":"æ˜¯çš„ï¼ŒæŒ‰ç…§è€å¸ˆçš„è¯´æ³•ï¼Œå¦‚æœvolatileä¸ä¿®é¥°å˜é‡vï¼Œæ ¹æ®1ï¼Œ3ä¹Ÿä¼šå¯¼è‡´x=42,è¿™æ ·è®©æˆ‘ä»¬ç†è§£å­˜åœ¨è¯¯åŒº","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1563496214,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":2,"child_discussions":[{"author":{"id":1407983,"avatar":"https://static001.geekbang.org/account/avatar/00/15/7b/ef/ae5458c7.jpg","nickname":"ç‹éª","note":"","ucode":"E5A88F3BA2634E","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":1282575,"avatar":"https://static001.geekbang.org/account/avatar/00/13/92/0f/cff30522.jpg","nickname":"æ±Ÿæ¹–å¤œé›¨","note":"","ucode":"C64913C7000899","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":70922,"discussion_content":"å¦‚æœvolatileä¸ä¿®é¥°å˜é‡vï¼Œxæœ‰æ—¶å€™æ˜¯0æœ‰æ—¶å€™æ˜¯42ï¼Œæ— æ³•ä¿è¯","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1575383358,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":2334,"ip_address":""},"score":70922,"extra":""},{"author":{"id":1361746,"avatar":"https://static001.geekbang.org/account/avatar/00/14/c7/52/c5adf218.jpg","nickname":"å–œæ¬¢åœ°çƒçš„é˜¿åŸ¹åŒå­¦","note":"","ucode":"5F97037585F857","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":1282575,"avatar":"https://static001.geekbang.org/account/avatar/00/13/92/0f/cff30522.jpg","nickname":"æ±Ÿæ¹–å¤œé›¨","note":"","ucode":"C64913C7000899","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":87678,"discussion_content":"x vå¯èƒ½ä¼šå‘ç”ŸæŒ‡ä»¤é‡æ’","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1576676963,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":2334,"ip_address":""},"score":87678,"extra":""}]}]},{"had_liked":false,"id":72727,"user_name":"å°éº¦","can_delete":false,"product_type":"c1","uid":1216881,"ip_address":"","ucode":"55C7199A0D5659","user_header":"https://static001.geekbang.org/account/avatar/00/12/91/71/0b16655d.jpg","comment_is_top":false,"comment_ctime":1551706437,"is_pvip":true,"discussion_count":1,"race_medal":0,"score":"83156085061","product_id":100023901,"comment_content":"@å‘æ¡æ©™å­ ... <br>æœ‰é—®é¢˜å§ï¼Œæˆ‘æ˜¯è¿™æ ·ç†è§£çš„ï¼Œç¬¬ä¸€æ¡è§„åˆ™æ˜¯ä¸²è¡Œè¯­ä¹‰ï¼Œåœ¨å•çº¿ç¨‹çš„åœºæ™¯ä¸‹ï¼Œä¼˜åŒ–åçš„ç»“æœä¼šä¸é¡ºåºæ‰§è¡Œä¸€è‡´ï¼Œä½†æ˜¯ä¸ä»£è¡¨å¯¹xçš„å†™æ“ä½œä¼šæ¯”å¯¹vçš„å†™å…ˆæ‰§è¡Œï¼Œæ‰€ä»¥å¤šçº¿ç¨‹ä¸‹ä¼šå‡ºç°é—®é¢˜ã€‚åŠ volatileå…³é”®å­—åï¼Œvolatileå˜é‡åœ¨å†™æ“ä½œä¹‹åä¼šæ’å…¥ä¸€ä¸ªstoreå±éšœï¼ˆStoreå±éšœï¼Œæ˜¯x86çš„â€sfenceâ€œæŒ‡ä»¤ï¼Œå¼ºåˆ¶æ‰€æœ‰åœ¨storeå±éšœæŒ‡ä»¤ä¹‹å‰çš„storeæŒ‡ä»¤ï¼Œéƒ½åœ¨è¯¥storeå±éšœæŒ‡ä»¤æ‰§è¡Œä¹‹å‰è¢«æ‰§è¡Œï¼Œå¹¶æŠŠstoreç¼“å†²åŒºçš„æ•°æ®éƒ½åˆ·åˆ°CPUç¼“å­˜ã€‚è¿™ä¼šä½¿å¾—ç¨‹åºçŠ¶æ€å¯¹å…¶å®ƒCPUå¯è§ï¼Œè¿™æ ·å…¶å®ƒCPUå¯ä»¥æ ¹æ®éœ€è¦ä»‹å…¥ã€‚--å¹¶å‘ç¼–ç¨‹ç½‘ï¼‰ï¼Œæ‰€ä»¥ç¦æ­¢äº†é‡æ’åºï¼Œè¿™æ‰ä¿è¯äº†å¯¹xçš„å†™æ“ä½œä¼šæ¯”å¯¹vçš„å†™å…ˆæ‰§è¡Œï¼Œç„¶åå†æ ¹æ®volatileå˜é‡è§„åˆ™è·Ÿä¼ é€’æ€§åŸåˆ™ï¼Œæ‰ä¿è¯äº†x=42å¯¹çº¿ç¨‹Bå¯è§ã€‚<br><br>","like_count":19,"discussions":[{"author":{"id":1361746,"avatar":"https://static001.geekbang.org/account/avatar/00/14/c7/52/c5adf218.jpg","nickname":"å–œæ¬¢åœ°çƒçš„é˜¿åŸ¹åŒå­¦","note":"","ucode":"5F97037585F857","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":88278,"discussion_content":"æŠŠstoreç¼“å†²åŒºçš„æ•°æ®éƒ½åˆ·åˆ°CPUç¼“å­˜ã€‚è¿™ä¼šä½¿å¾—ç¨‹åºçŠ¶æ€å¯¹å…¶å®ƒCPUå¯è§ã€‚è¿™å¥è¯æœ‰è¯¯å¯¼ï¼Œæœ€ååº”è¯¥ä¼šæŠŠæ•°æ®åˆ·åˆ°â€œå†…å­˜â€ä¸­ï¼Œè¿™æ ·æ‰ ä½¿å¾—ç¨‹åºçŠ¶æ€å¯¹å…¶å®ƒCPUå¯è§","likes_number":1,"is_delete":false,"is_hidden":false,"ctime":1576684901,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":72082,"user_name":"å¼ºå“¥","can_delete":false,"product_type":"c1","uid":1206726,"ip_address":"","ucode":"3B8DC780FE4EF9","user_header":"https://static001.geekbang.org/account/avatar/00/12/69/c6/513df085.jpg","comment_is_top":false,"comment_ctime":1551516472,"is_pvip":false,"replies":[{"id":"26109","content":"å’±ä»¬è¿™ä¸ªä¸“æ è¿˜æ˜¯ä¸“æ³¨äºå¹¶å‘ç›¸å…³çš„éƒ¨åˆ†ï¼Œæˆ‘æ€•æœ‰äººè¯´æŒ‚ç¾Šå¤´å–ç‹—è‚‰","user_name":"ä½œè€…å›å¤","comment_id":72082,"uid":"1269969","ip_address":"","utype":1,"ctime":1551523225,"user_name_real":"ç‹å®ä»¤"}],"discussion_count":3,"race_medal":0,"score":"61681058616","product_id":100023901,"comment_content":"å…³äºjavaå†…å­˜æ¨¡å‹ã€jvmå†…å­˜ç»“æ„åŠjavaå¯¹è±¡æ¨¡å‹åˆ†åˆ«æ·±å…¥è®²è§£ä¸€ä¸‹ï¼Œè¿™æ ·æ•ˆæœæ›´å¥½ä¸€äº›ã€‚","like_count":14,"discussions":[{"author":{"id":1269969,"avatar":"https://static001.geekbang.org/account/avatar/00/13/60/d1/8efa89ab.jpg","nickname":"ç‹å®ä»¤","note":"","ucode":"4FE19F5BC32FCA","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":441452,"discussion_content":"å’±ä»¬è¿™ä¸ªä¸“æ è¿˜æ˜¯ä¸“æ³¨äºå¹¶å‘ç›¸å…³çš„éƒ¨åˆ†ï¼Œæˆ‘æ€•æœ‰äººè¯´æŒ‚ç¾Šå¤´å–ç‹—è‚‰","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1551523225,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1213078,"avatar":"https://static001.geekbang.org/account/avatar/00/12/82/96/aa795685.jpg","nickname":"mghio","note":"","ucode":"74883EDE4FD0DC","race_medal":0,"user_type":1,"is_pvip":true},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":552963,"discussion_content":"Java å†…å­˜æ¨¡å‹å¯ä»¥çœ‹çœ‹ Doug Lea å¹¶å‘å¤§å¸ˆçš„è¿™ä¸ª http://www.cs.umd.edu/~pugh/java/memoryModel","likes_number":1,"is_delete":false,"is_hidden":false,"ctime":1645670466,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1252034,"avatar":"http://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTI0qUU5bc3kVeO0ZTJliau1dHMZglMib72gelIgKXew4RFDdAHsicodWgdaCwSAWetIuVaFwIzb2fFHw/132","nickname":"å¹¿å®‰é—¨ä¸‹","note":"","ucode":"553A6B40FB3C9F","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":37434,"discussion_content":"æˆ‘ä¹Ÿè§‰å¾—æ˜¯","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1571618500,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":72716,"user_name":"é¸ ç¿±","can_delete":false,"product_type":"c1","uid":1116568,"ip_address":"","ucode":"7D498AF2BC4289","user_header":"https://static001.geekbang.org/account/avatar/00/11/09/98/b11c372b.jpg","comment_is_top":false,"comment_ctime":1551701713,"is_pvip":false,"replies":[{"id":"26356","content":"æ˜¯è¿™æ ·ã€‚","user_name":"ä½œè€…å›å¤","comment_id":72716,"uid":"1269969","ip_address":"","utype":1,"ctime":1551710244,"user_name_real":"ç‹å®ä»¤"}],"discussion_count":3,"race_medal":0,"score":"57386276561","product_id":100023901,"comment_content":"å¯¹äº@Junziçš„é—®é¢˜ï¼š<br>x=45; &#47;&#47; 1<br>v=true; &#47;&#47; 2<br>è¿™ä¸¤è¡Œä¼šä¸ä¼šå¯¼è‡´æŒ‡ä»¤é‡æ’ï¼Ÿ ç­”ï¼šä¸ä¼š<br>å¦‚æœè¿™ä¸¤è¡Œé‡æ’åºäº†ï¼Œé‚£ä¹ˆçº¿ç¨‹Bè¯»å–åˆ°read()çš„æ—¶å€™ä¹Ÿæœ‰å¯èƒ½å‡ºç°x=0ï¼Œä¹Ÿå°±æ˜¯è¯´çº¿ç¨‹Bçœ‹åˆ°äº†v=trueå´æ²¡åˆçœ‹åˆ°x=45ï¼Œè¿™ä¸ç¬¦åˆç¬¬ä¸€æ¡è§„åˆ™ï¼ˆè¯·é—®è€å¸ˆ è¿™ä¹ˆç†è§£å¯¹ä¸å¯¹ï¼‰<br>æˆ‘è¯¾å¤–æŸ¥è¯¢äº†ä¸€ä¸‹ï¼Œä»å®ç°æ–¹æ³•ä¸Šï¼Œvolatileçš„è¯»å†™å‰åä¼šæ’å…¥å†…å­˜å±éšœï¼Œä¿è¯ä¸€äº›æ“ä½œæ˜¯æ— æ³•æ²¡é‡æ’åºçš„ï¼Œå…¶ä¸­å°±æœ‰å¯¹äºvolatileçš„å†™æ“ä½œä¹‹å‰çš„åŠ¨ä½œä¸ä¼šè¢«é‡æ’åºåˆ°ä¹‹å","like_count":13,"discussions":[{"author":{"id":1269969,"avatar":"https://static001.geekbang.org/account/avatar/00/13/60/d1/8efa89ab.jpg","nickname":"ç‹å®ä»¤","note":"","ucode":"4FE19F5BC32FCA","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":441706,"discussion_content":"æ˜¯è¿™æ ·ã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1551710244,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1188517,"avatar":"http://thirdwx.qlogo.cn/mmopen/g7TWmGqjoiaSFWknFpTPAia5rPOmzEZiaGK8icd5HGEXlfaYJBoKvLn5BkqGkyTZOqDTC3NMHXUbH3tdLJzicAyickRYdP4xcM3ajia/132","nickname":"sudo","note":"","ucode":"EA0F8116999557","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":6944,"discussion_content":"å…¶å®ä¸æ˜¯å› ä¸ºè§„åˆ™1,å‡è®¾é‡æ’äº†\nV=ture\nX=45\n\nçº¿ç¨‹bçœ‹åˆ°v=true x=0ä¹Ÿå»å¯èƒ½çš„ã€‚å¹¶æ²¡æœ‰æ‰“ç ´volatile hbè§„åˆ™ã€‚è§„åˆ™1è¯´çš„é¡ºåºæ€§ï¼Œæˆ‘ä¸ªäººç†è§£æ˜¯ç¼–è¯‘åçš„é¡ºåºï¼Œè€Œä¸æ˜¯æˆ‘ä»¬è‚‰çœ¼çœ‹åˆ°çš„é¡ºåºã€‚","likes_number":1,"is_delete":false,"is_hidden":false,"ctime":1567182842,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1585829,"avatar":"https://static001.geekbang.org/account/avatar/00/18/32/a5/9868cd56.jpg","nickname":"southday","note":"","ucode":"4A8FB63D35F6E1","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":2028,"discussion_content":"â€œå¯¹äºvolatileçš„å†™æ“ä½œä¹‹å‰çš„åŠ¨ä½œä¸ä¼šè¢«é‡æ’åºåˆ°ä¹‹åâ€ï¼Œè¿™å¥è¯æ€ä¹ˆç†è§£å‘¢ï¼Ÿè¿™äº›åŠ¨ä½œçš„ä½œç”¨å¯¹è±¡ä»…é™äºè¢«volatileä¿®é¥°çš„å˜é‡ï¼Œè¿˜æ˜¯åŒ…æ‹¬å…¶ä»–å†…å®¹å‘¢ï¼Ÿèƒ½ä¸èƒ½è´´ä¸€ä¸‹æ‰€æŸ¥èµ„æ–™çš„é“¾æ¥å‘€ï¼Œè°¢è°¢ :-)","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1563185273,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":87367,"user_name":"xuery","can_delete":false,"product_type":"c1","uid":1027584,"ip_address":"","ucode":"F461B61BE06131","user_header":"https://static001.geekbang.org/account/avatar/00/0f/ae/00/025f37e7.jpg","comment_is_top":false,"comment_ctime":1555578004,"is_pvip":true,"discussion_count":2,"race_medal":0,"score":"48800218260","product_id":100023901,"comment_content":"å¯¹äºhbçš„ç¬¬ä¸€æ¡è§„åˆ™ï¼šç¨‹åºçš„é¡ºåºæ€§è§„åˆ™ç†è§£äº†å¥½ä¹…ï¼Œç»ˆäºæ˜ç™½äº†ã€‚<br>åœ¨ä¸€ä¸ªçº¿ç¨‹ä¸­ï¼ŒæŒ‰ç…§ç¨‹åºé¡ºåºï¼Œå‰é¢çš„æ“ä½œhbäºåé¢çš„æ“ä½œï¼Œè¿™é‡Œçš„ç¨‹åºé¡ºåºæ˜¯æŒ‡<br>ç¨‹åºä¸€å®šæ˜¯æŒ‰ç…§é¡ºåºæ‰§è¡Œçš„ï¼ˆä¹Ÿå¯èƒ½æ˜¯æ’åºä¹‹åçš„é¡ºåºï¼‰,å¹¶ä¸æ˜¯æŒ‡ä»£ç ä¹¦å†™çš„å…ˆåé¡ºåºï¼›<br>æ¯”å¦‚ï¼šx = 42; v = true; å› ä¸ºvæ˜¯volatileä¿®é¥°çš„ï¼Œæ‰€ä»¥x=42ä¸€å®šæ˜¯å…ˆäºv=trueæ‰§è¡Œï¼Œæ‰€ä»¥x=42æ“ä½œhbäºv=true;<br>å¦‚æœvä¸æ˜¯volatileä¿®é¥°çš„ï¼Œåˆ™ç”±äºæŒ‡ä»¤é‡æ’æŒ‡å‘é¡ºåºå¯èƒ½æ˜¯ï¼šx=42;v=true;ï¼ˆ1ï¼‰æˆ–è€…v=true;x=42;ï¼ˆ2ï¼‰<br>å¦‚æœæ˜¯ç¬¬ä¸€ç§é¡ºåºåˆ™æŒ‰ç…§è§„åˆ™1ï¼Œx=42 hbäºv=true;ç¬¬äºŒç§é¡ºåºåˆ™æŒ‰ç…§è§„åˆ™1ï¼Œv=true hbäºx=42ï¼Œæ‰€ä»¥å½“v=trueæ—¶ï¼Œxä¸ä¸€å®šæ˜¯42","like_count":11,"discussions":[{"author":{"id":1050114,"avatar":"http://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTJoG7YWJ0WsYoLalnJvPmKktLlfMicFg1fEzzgDgCcBgYoiaqILD4yAGwicWVC7iberRlAqNflL67Ju1g/132","nickname":"æ— æ„","note":"","ucode":"BD1A58F6F981BD","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":345611,"discussion_content":"èµåŒè¿™ç§ç†è§£","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1611753586,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1367048,"avatar":"https://static001.geekbang.org/account/avatar/00/14/dc/08/64f5ab52.jpg","nickname":"é™ˆæ–Œ","note":"","ucode":"B639AB5F6AA03D","race_medal":0,"user_type":1,"is_pvip":true},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":342900,"discussion_content":"@ä½œè€… å¯¹ä¸å¯¹å‘¢ï¼Ÿ","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1610872353,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":82763,"user_name":"ç‹ä½åº†","can_delete":false,"product_type":"c1","uid":1180978,"ip_address":"","ucode":"D480AEA92894FE","user_header":"https://static001.geekbang.org/account/avatar/00/12/05/32/7440d47d.jpg","comment_is_top":false,"comment_ctime":1554302139,"is_pvip":false,"discussion_count":1,"race_medal":0,"score":"48798942395","product_id":100023901,"comment_content":"@Junziï¼Œæ‚¨æçš„é—®é¢˜åˆšå¼€å§‹æˆ‘ä¹Ÿå¾ˆç–‘æƒ‘ï¼Œä½†æŸ¥çœ‹äº†javaå¹¶å‘ç¼–ç¨‹çš„è‰ºæœ¯ï¼Œä¹¦ä¸Šå†™äº†jdk1.5ä¹‹åï¼Œå¢å¼ºäº†volatileçš„å†…å­˜å«ä¹‰ï¼Œé™åˆ¶äº†ç¼–è¯‘å™¨å’Œå¤„ç†å™¨å¯¹volatileå˜é‡å’Œæ™®é€šå˜é‡çš„é‡æ’åºã€‚p47é¡µ","like_count":11,"discussions":[{"author":{"id":1124766,"avatar":"https://static001.geekbang.org/account/avatar/00/11/29/9e/380a01ea.jpg","nickname":"tracer","note":"","ucode":"AE2BC047DB7D7D","race_medal":1,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":128439,"discussion_content":"åŸæ¥å¦‚æ­¤ï¼ŒJSR133ä¹‹å‰ä¼šå¯¹ä¸‹é¢ä»£ç è¿›è¡Œé‡æ’åºï¼Œä¹‹åå¢å¼ºäº†volatileçš„å†…å­˜è¯­ä¹‰ï¼Œä¸¥æ ¼é™åˆ¶ç¼–è¯‘å™¨å’Œå¤„ç†å™¨å¯¹volatileå˜é‡ä¸æ™®é€šå˜é‡çš„é‡æ’åº\nx=45; // 1\nv=true; // 2","likes_number":1,"is_delete":false,"is_hidden":false,"ctime":1578639860,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":71945,"user_name":"å³°","can_delete":false,"product_type":"c1","uid":1056019,"ip_address":"","ucode":"C53CB64E8E7D19","user_header":"https://static001.geekbang.org/account/avatar/00/10/1d/13/31ea1b0b.jpg","comment_is_top":false,"comment_ctime":1551491155,"is_pvip":true,"replies":[{"id":"26089","content":"å¤šè°¢é¼“åŠ±å•Šï¼","user_name":"ä½œè€…å›å¤","comment_id":71945,"uid":"1269969","ip_address":"","utype":1,"ctime":1551520488,"user_name_real":"ç‹å®ä»¤"}],"discussion_count":1,"race_medal":0,"score":"48796131411","product_id":100023901,"comment_content":"æˆ‘è§‰å¾—è¯¾åé¢˜å…¶å®å°±æ˜¯åˆ©ç”¨happenbeforeè§„åˆ™å»æ„å»ºabcçš„å†™å…¥happenforeäºå¦å¤–ä¸€ä¸ªçº¿ç¨‹çš„è¯»å–ã€‚è€Œ6æ¡è§„åˆ™ä¸­ä¼ é€’æ€§è§„åˆ™æ˜¯çº½å¸¦ï¼Œç„¶åé‡‡ç”¨æ¯”å¦‚è§„åˆ™4ï¼Œå°±æ˜¯æŠŠabcçš„èµ‹å€¼åŠ å…¥ä¸€åŒæ­¥å—ï¼Œå¹¶å…ˆæ‰§è¡Œï¼ŒåŒæ—¶å¦å¤–ä¸€ä¸ªçº¿ç¨‹ç”³è¯·åŒä¸€æŠŠé”å³å¯ã€‚å…¶ä»–çš„ä¹Ÿç±»ä¼¼ã€‚<br><br>javaå†…å­˜æ¨¡å‹å¯¹ç¨‹åºå‘˜æ¥è¯´æä¾›äº†æŒ‰éœ€ç¦æ­¢ç¼“å­˜ç¦æ­¢æŒ‡ä»¤é‡æ’çš„æ–¹æ³•ã€‚è¿™æ˜¯æˆ‘ç¬¬ä¸€æ¬¡çœ‹åˆ°è¿™ä¹ˆç®€å•åˆæ·±åˆ»çš„è§£é‡Šï¼Œè€å¸ˆæ£’æ£’å“’ï¼ï¼ï¼","like_count":11,"discussions":[{"author":{"id":1269969,"avatar":"https://static001.geekbang.org/account/avatar/00/13/60/d1/8efa89ab.jpg","nickname":"ç‹å®ä»¤","note":"","ucode":"4FE19F5BC32FCA","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":441407,"discussion_content":"å¤šè°¢é¼“åŠ±å•Šï¼","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1551520488,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":72118,"user_name":"wang","can_delete":false,"product_type":"c1","uid":1161200,"ip_address":"","ucode":"5D569805C6A923","user_header":"https://static001.geekbang.org/account/avatar/00/11/b7/f0/a570f68a.jpg","comment_is_top":false,"comment_ctime":1551524331,"is_pvip":false,"replies":[{"id":"26157","content":"ä¸åŠ volatileï¼Œå¤šçº¿ç¨‹ä¼šæœ‰é—®é¢˜","user_name":"ä½œè€…å›å¤","comment_id":72118,"uid":"1269969","ip_address":"","utype":1,"ctime":1551544906,"user_name_real":"ç‹å®ä»¤"}],"discussion_count":1,"race_medal":0,"score":"40206229995","product_id":100023901,"comment_content":"è€å¸ˆã€‚å¯¹å‘€ å‘æ¡æ©™å­ æåˆ°å¦‚æœä¸åŠ  volatileï¼Œå½“è¯»åˆ°vçš„æ—¶å€™ï¼Œxå°±ä¸€å®šèƒ½è¯»åˆ°42ï¼Œä½¿ç”¨çš„æ˜¯ä½¿ç”¨çš„æ˜¯è§„åˆ™1ã€‚<br>æˆ‘è®¤ä¸ºä¸å¯¹å‘€ï¼Œè§„åˆ™ä¸€ä¸æ˜¯åªé€‚ç”¨äºå•çº¿ç¨‹å—ï¼Ÿè€Œè¯»å–væ˜¯åœ¨å¦ä¸€ä¸ªçº¿ç¨‹ï¼Œæ‰€ä»¥ä¸èƒ½ä½¿ç”¨è§„åˆ™ä¸€åˆ¤æ–­å§ã€‚<br>å¸Œæœ›è€å¸ˆå¯ä»¥è§£é‡Šä¸€ä¸‹ï¼Œè°¢è°¢","like_count":9,"discussions":[{"author":{"id":1269969,"avatar":"https://static001.geekbang.org/account/avatar/00/13/60/d1/8efa89ab.jpg","nickname":"ç‹å®ä»¤","note":"","ucode":"4FE19F5BC32FCA","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":441468,"discussion_content":"ä¸åŠ volatileï¼Œå¤šçº¿ç¨‹ä¼šæœ‰é—®é¢˜","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1551544906,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":71996,"user_name":"é£ç¿”çš„èŠ±ç‹¸çŒ«","can_delete":false,"product_type":"c1","uid":1143473,"ip_address":"","ucode":"F3BA6126E02059","user_header":"https://static001.geekbang.org/account/avatar/00/11/72/b1/a8b272ef.jpg","comment_is_top":false,"comment_ctime":1551495910,"is_pvip":false,"replies":[{"id":"26097","content":"é‚£å°è¯´å¾—å†™çš„æœ‰å¤šçƒ‚ï¼","user_name":"ä½œè€…å›å¤","comment_id":71996,"uid":"1269969","ip_address":"","utype":1,"ctime":1551521883,"user_name_real":"ç‹å®ä»¤"}],"discussion_count":2,"race_medal":0,"score":"40206201574","product_id":100023901,"comment_content":"Happen-before è¿™ä¸ªçŸ¥è¯†ç‚¹ç»ˆäºç†è§£äº†ï¼Œè¿½å¹¶å‘ä¸“æ æ¯”ä»¥å‰çœ‹å°è¯´è¿˜å‹¤å¿«ï¼Œç›¼è€å¸ˆé€Ÿæ›´å•Š","like_count":9,"discussions":[{"author":{"id":1269969,"avatar":"https://static001.geekbang.org/account/avatar/00/13/60/d1/8efa89ab.jpg","nickname":"ç‹å®ä»¤","note":"","ucode":"4FE19F5BC32FCA","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":441421,"discussion_content":"é‚£å°è¯´å¾—å†™çš„æœ‰å¤šçƒ‚ï¼","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1551521883,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":1,"child_discussions":[{"author":{"id":2756739,"avatar":"https://static001.geekbang.org/account/avatar/00/2a/10/83/0facd0eb.jpg","nickname":"åˆ©å¨å°”å…µé•¿","note":"","ucode":"FDE0BD5BFB1B4A","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":1269969,"avatar":"https://static001.geekbang.org/account/avatar/00/13/60/d1/8efa89ab.jpg","nickname":"ç‹å®ä»¤","note":"","ucode":"4FE19F5BC32FCA","race_medal":0,"user_type":2,"is_pvip":false},"discussion":{"id":535921,"discussion_content":"æ˜¯è€å¸ˆæ‚¨å†™çš„å¤ªå¥½å•¦","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1638607396,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":441421,"ip_address":""},"score":535921,"extra":""}]}]},{"had_liked":false,"id":72370,"user_name":"é’å†°ç™½å¤œ","can_delete":false,"product_type":"c1","uid":1307569,"ip_address":"","ucode":"3F71F1027E8374","user_header":"https://static001.geekbang.org/account/avatar/00/13/f3/b1/0429aa3b.jpg","comment_is_top":false,"comment_ctime":1551599891,"is_pvip":false,"replies":[{"id":"26209","content":"int func() {<br>  int i=0;<br>  int j=1;<br>  return i+j;<br>} <br>å¯¹äºä¸Šé¢è¿™ä¸ªå‡½æ•°ï¼Œå‰é¢ä¸¤è¡Œçš„é¡ºåºï¼Œå¯¹äºæ‰§è¡Œç»“æœæ²¡æœ‰å½±å“ã€‚æ‰€ä»¥ç¼–è¯‘å™¨å¯ä»¥ä¼˜åŒ–ã€‚<br><br>è¿™é‡Œæ‰€æœ‰çš„happens-beforeè§„åˆ™ï¼Œåªæ˜¯è¯´ä½ å¯ä»¥åˆ©ç”¨ä»–ä»¬æ¨æ¼”ç¨‹åºè¿è¡Œçš„ç»“æœã€‚ç¼–è¯‘å™¨ä¼˜åŒ–åçš„ç»“æœä¸€å®š==ä½ æ¨æ¼”çš„ç»“æœã€‚è‡³äºä¸­é—´è¿‡ç¨‹ï¼Œç¼–è¯‘å™¨è¿˜æ˜¯å¯ä»¥ä¼˜åŒ–çš„ã€‚","user_name":"ä½œè€…å›å¤","user_name_real":"ç‹å®ä»¤","uid":"1269969","ctime":1551602996,"ip_address":"","comment_id":72370,"utype":1}],"discussion_count":1,"race_medal":0,"score":"35911338259","product_id":100023901,"comment_content":"é‚£è€å¸ˆï¼Œå°±æˆ‘çš„é‚£ä¸ªé—®é¢˜ï¼Œ<br>int i=0 ;<br>int j=1;<br>æ‚¨ä¹Ÿè¯´äº†ï¼Œå¯èƒ½é‡æ’åºæˆ<br>int j=1;<br>int i=0;<br>é‚£int i=0æ˜æ˜æ˜¯åœ¨å‰é¢ï¼Œè¿™é‡æ’åºåœ¨åé¢ï¼Œä¸å°±ä¸ç¬¦åˆhappens-beforçš„ç¨‹åºé¡ºåºæ€§è§„åˆ™äº†å—ï¼Ÿ","like_count":8,"discussions":[{"author":{"id":1269969,"avatar":"https://static001.geekbang.org/account/avatar/00/13/60/d1/8efa89ab.jpg","nickname":"ç‹å®ä»¤","note":"","ucode":"4FE19F5BC32FCA","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":441560,"discussion_content":"int func() {\n  int i=0;\n  int j=1;\n  return i+j;\n} \nå¯¹äºä¸Šé¢è¿™ä¸ªå‡½æ•°ï¼Œå‰é¢ä¸¤è¡Œçš„é¡ºåºï¼Œå¯¹äºæ‰§è¡Œç»“æœæ²¡æœ‰å½±å“ã€‚æ‰€ä»¥ç¼–è¯‘å™¨å¯ä»¥ä¼˜åŒ–ã€‚\n\nè¿™é‡Œæ‰€æœ‰çš„happens-beforeè§„åˆ™ï¼Œåªæ˜¯è¯´ä½ å¯ä»¥åˆ©ç”¨ä»–ä»¬æ¨æ¼”ç¨‹åºè¿è¡Œçš„ç»“æœã€‚ç¼–è¯‘å™¨ä¼˜åŒ–åçš„ç»“æœä¸€å®š==ä½ æ¨æ¼”çš„ç»“æœã€‚è‡³äºä¸­é—´è¿‡ç¨‹ï¼Œç¼–è¯‘å™¨è¿˜æ˜¯å¯ä»¥ä¼˜åŒ–çš„ã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1551602996,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":72536,"user_name":"æŸ³çµ®é£","can_delete":false,"product_type":"c1","uid":1443478,"ip_address":"","ucode":"FD3823B3482A1C","user_header":"https://static001.geekbang.org/account/avatar/00/16/06/96/6ae77c39.jpg","comment_is_top":false,"comment_ctime":1551666158,"is_pvip":true,"replies":[{"id":"26346","content":"å†…å­˜æ¨¡å‹çš„å«æ³•ï¼Œæ˜¯æŒ‡å®šjsrè§„èŒƒçš„äººå®šçš„ã€‚å †æ ˆå¯ä»¥å«å†…å­˜ç»“æ„","user_name":"ä½œè€…å›å¤","user_name_real":"ç‹å®ä»¤","uid":"1269969","ctime":1551709645,"ip_address":"","comment_id":72536,"utype":1}],"discussion_count":1,"race_medal":0,"score":"31616437230","product_id":100023901,"comment_content":"ç‹è€å¸ˆï¼Œè¯·æ•™ä¸€ä¸‹ï¼Œä¸ºä»€ä¹ˆè¿™äº›ç¼–è¯‘ä¼˜åŒ–è§„åˆ™å«å†…å­˜æ¨¡å‹ï¼Ÿjvmçš„å †å’Œæ ˆåº”è¯¥å«ä»€ä¹ˆï¼Ÿå¤šè°¢ï¼è¿™æ ·å«æ˜¯ä¸æ˜¯å®¹æ˜“è®©äººè¯¯è§£","like_count":7,"discussions":[{"author":{"id":1269969,"avatar":"https://static001.geekbang.org/account/avatar/00/13/60/d1/8efa89ab.jpg","nickname":"ç‹å®ä»¤","note":"","ucode":"4FE19F5BC32FCA","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":441637,"discussion_content":"å†…å­˜æ¨¡å‹çš„å«æ³•ï¼Œæ˜¯æŒ‡å®šjsrè§„èŒƒçš„äººå®šçš„ã€‚å †æ ˆå¯ä»¥å«å†…å­˜ç»“æ„","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1551709645,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":78108,"user_name":"tracer","can_delete":false,"product_type":"c1","uid":1124766,"ip_address":"","ucode":"AE2BC047DB7D7D","user_header":"https://static001.geekbang.org/account/avatar/00/11/29/9e/380a01ea.jpg","comment_is_top":false,"comment_ctime":1553071708,"is_pvip":false,"replies":[{"id":"28485","content":"å‰å®³ğŸ‘<br>","user_name":"ä½œè€…å›å¤","user_name_real":"ç‹å®ä»¤","uid":"1269969","ctime":1553081388,"ip_address":"","comment_id":78108,"utype":1}],"discussion_count":1,"race_medal":1,"score":"27322875484","product_id":100023901,"comment_content":"æµ‹è¯•é‡æ’åºå¯ä»¥ä½¿ç”¨OpenJDK CodeTools é¡¹ç›®çš„jcstress å·¥å…·, è¯¦ç»†è§æå®¢æ—¶é—´æ·±å…¥æ‹†è§£è™šæ‹Ÿæœº13è®²å’Œhttps:&#47;&#47;wiki.openjdk.java.net&#47;display&#47;CodeTools&#47;jcstress","like_count":6,"discussions":[{"author":{"id":1269969,"avatar":"https://static001.geekbang.org/account/avatar/00/13/60/d1/8efa89ab.jpg","nickname":"ç‹å®ä»¤","note":"","ucode":"4FE19F5BC32FCA","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":443969,"discussion_content":"å‰å®³ğŸ‘\n","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1553081388,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":77161,"user_name":"life is short, enjoy more.îŠ","can_delete":false,"product_type":"c1","uid":1074805,"ip_address":"","ucode":"3B5F37D30790A7","user_header":"https://static001.geekbang.org/account/avatar/00/10/66/75/54bb858e.jpg","comment_is_top":false,"comment_ctime":1552873413,"is_pvip":false,"replies":[{"id":"28134","content":"æŒ‡ä»¤å¯èƒ½ä¼šé‡æ’ï¼ŒæŠŠx=3æ’åˆ°åé¢<br>","user_name":"ä½œè€…å›å¤","user_name_real":"ç‹å®ä»¤","uid":"1269969","ctime":1552882229,"ip_address":"","comment_id":77161,"utype":1}],"discussion_count":1,"race_medal":0,"score":"23027709893","product_id":100023901,"comment_content":"æ–°å­¦ç”Ÿå¯¹æœ¬é—¨è¯¾ç¨‹çš„ç¬¬ä¸€æ¬¡ç•™è¨€~<br>&#47;&#47; ä»¥ä¸‹ä»£ç æ¥æºäºã€å‚è€ƒ 1ã€‘<br>final int x;<br>&#47;&#47; é”™è¯¯çš„æ„é€ å‡½æ•°<br>public FinalFieldExample() { <br>  x = 3;<br>  y = 4;<br>  &#47;&#47; æ­¤å¤„å°±æ˜¯è®² this é€¸å‡ºï¼Œ<br>  global.obj = this;<br>}<br><br>è€å¸ˆä½ å¥½ï¼Œè¿™ä¸ªä¾‹å­æˆ‘ä¸æ˜¯å¾ˆç†è§£ï¼Œçœ‹åˆ°ä½ ç»™å…¶ä»–åŒå­¦çš„ç­”å¤æ˜¯ï¼Œthiså¯èƒ½æ²¡æœ‰åˆå§‹åŒ–å®Œã€‚ä½†æ˜¯è¿™ä¸å°±æ˜¯ä¸€ä¸ªæ„é€ å‡½æ•°å—ï¼Œthisä½äºæ„é€ å‡½æ•°çš„æœ€åä¸€è¡Œï¼Œè€Œä¸”xå·²ç»èµ‹å€¼äº†ï¼Œä¸ºä»€ä¹ˆå¯èƒ½å­˜åœ¨å…¶ä»–çº¿ç¨‹è¯»åˆ°x==0çš„æƒ…å†µå‘¢ï¼Ÿ","like_count":5,"discussions":[{"author":{"id":1269969,"avatar":"https://static001.geekbang.org/account/avatar/00/13/60/d1/8efa89ab.jpg","nickname":"ç‹å®ä»¤","note":"","ucode":"4FE19F5BC32FCA","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":443611,"discussion_content":"æŒ‡ä»¤å¯èƒ½ä¼šé‡æ’ï¼ŒæŠŠx=3æ’åˆ°åé¢\n","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1552882229,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":73913,"user_name":"Geek_faf1c5","can_delete":false,"product_type":"c1","uid":1446395,"ip_address":"","ucode":"E297E4E3487CE4","user_header":"http://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTI9kA8IicSJFKtglFv10EHGmLgCRGET22HylnXB7pT0xibjOYtDia0cib4uuSnvOJSINeoF71LAKU1F4A/132","comment_is_top":false,"comment_ctime":1552031558,"is_pvip":true,"replies":[{"id":"27009","content":"ç½‘ä¸Šæ˜¯æœ‰è¿™ä¹ˆè¯´æ³•ï¼Œä½ å¯ä»¥ç†è§£ä¸ºcpuç¼“å­˜å’Œçº¿ç¨‹æœ¬åœ°å†…å­˜æ˜¯ä¸€å›äº‹ã€‚ä½†æ˜¯æˆ‘æ²¡æœ‰æ‰¾åˆ°çº¿ç¨‹æœ¬åœ°å†…å­˜çš„å®˜æ–¹å‡ºå¤„ã€‚ä¸æ•¢äººäº‘äº¦äº‘ï¼Œæ‰€ä»¥ä¸“æ é‡Œå°±æ²¡æœ‰ç”¨è¿™ä¸ªæ¦‚å¿µã€‚å¦‚æœä½ æ„Ÿå…´è¶£ï¼Œå¯ä»¥æ‰¾æ‰¾ã€‚","user_name":"ä½œè€…å›å¤","user_name_real":"ç‹å®ä»¤","uid":"1269969","ctime":1552059028,"ip_address":"","comment_id":73913,"utype":1}],"discussion_count":1,"race_medal":0,"score":"23026868038","product_id":100023901,"comment_content":"è€å¸ˆæ‚¨å¥½ï¼š<br>cpuç¼“å­˜å¯¼è‡´çš„å¯è§æ€§  cpuè¿è¡Œçš„å•ä½æ˜¯çº¿ç¨‹ è€Œæ¯ä¸ªçº¿ç¨‹æœ‰æœ¬åœ°å†…å­˜ å› ä¸ºæœ‰çº¿ç¨‹æœ¬åœ°å†…å­˜çš„å­˜åœ¨ ä¹Ÿä¼šå¯¼è‡´å¯è§æ€§é—®é¢˜  é‚£ä¹ˆçº¿ç¨‹çš„æœ¬åœ°å†…å­˜å’Œcpuç¼“å­˜æ˜¯ä¸€ä¼šäº‹å—  æœ‰ä»€ä¹ˆå…³è”ï¼Ÿï¼Ÿï¼Ÿï¼Ÿ","like_count":5,"discussions":[{"author":{"id":1269969,"avatar":"https://static001.geekbang.org/account/avatar/00/13/60/d1/8efa89ab.jpg","nickname":"ç‹å®ä»¤","note":"","ucode":"4FE19F5BC32FCA","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":442334,"discussion_content":"ç½‘ä¸Šæ˜¯æœ‰è¿™ä¹ˆè¯´æ³•ï¼Œä½ å¯ä»¥ç†è§£ä¸ºcpuç¼“å­˜å’Œçº¿ç¨‹æœ¬åœ°å†…å­˜æ˜¯ä¸€å›äº‹ã€‚ä½†æ˜¯æˆ‘æ²¡æœ‰æ‰¾åˆ°çº¿ç¨‹æœ¬åœ°å†…å­˜çš„å®˜æ–¹å‡ºå¤„ã€‚ä¸æ•¢äººäº‘äº¦äº‘ï¼Œæ‰€ä»¥ä¸“æ é‡Œå°±æ²¡æœ‰ç”¨è¿™ä¸ªæ¦‚å¿µã€‚å¦‚æœä½ æ„Ÿå…´è¶£ï¼Œå¯ä»¥æ‰¾æ‰¾ã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1552059028,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":72777,"user_name":"Geek_c42505","can_delete":false,"product_type":"c1","uid":1232899,"ip_address":"","ucode":"6421EB85640C44","user_header":"https://static001.geekbang.org/account/avatar/00/12/d0/03/2e632d36.jpg","comment_is_top":false,"comment_ctime":1551715519,"is_pvip":false,"replies":[{"id":"26449","content":"å¾ˆå…¨é¢äº†","user_name":"ä½œè€…å›å¤","user_name_real":"ç‹å®ä»¤","uid":"1269969","ctime":1551787425,"ip_address":"","comment_id":72777,"utype":1}],"discussion_count":1,"race_medal":0,"score":"23026551999","product_id":100023901,"comment_content":"1. ä½¿ç”¨volatileä¿®é¥°abc -ç¦æ­¢cpuç¼“å­˜ç›´æ¥ä»å†…å­˜è·å–å’Œvolatileå†™ happens before volatileè¯»ã€‚<br>2. synchronized ä»£ç å—ä¸­æ“ä½œabc è§£é”happens before åŠ é”ã€‚<br>3. çº¿ç¨‹Aæ“ä½œå…±äº«å˜é‡abcç„¶åstartæ–¹æ³•å¯åŠ¨Bçº¿ç¨‹ Bçº¿ç¨‹ä¸­å¯è§abcæ“ä½œã€‚<br>4. çº¿ç¨‹Aæ“ä½œå…±äº«å˜é‡abcï¼ŒB join A å¯¹äºBçº¿ç¨‹å¯è§ã€‚<br>ä¸çŸ¥é“å™è¿°çš„æ˜¯å¦å‡†ç¡®ï¼Œå¿˜è€å¸ˆæŒ‡æ­£","like_count":5,"discussions":[{"author":{"id":1269969,"avatar":"https://static001.geekbang.org/account/avatar/00/13/60/d1/8efa89ab.jpg","nickname":"ç‹å®ä»¤","note":"","ucode":"4FE19F5BC32FCA","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":441740,"discussion_content":"å¾ˆå…¨é¢äº†","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1551787425,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":72763,"user_name":"Yesterday","can_delete":false,"product_type":"c1","uid":1010409,"ip_address":"","ucode":"6A416B7906C1E0","user_header":"https://static001.geekbang.org/account/avatar/00/0f/6a/e9/d76511d8.jpg","comment_is_top":false,"comment_ctime":1551712578,"is_pvip":false,"replies":[{"id":"26448","content":"åˆ«æƒ³ç¦ç”¨æŒ‡ä»¤é‡æ’çš„äº‹ï¼Œå°±ç”¨é¡ºåºæ€§è§„åˆ™+ä¼ é€’è¡Œè§„åˆ™+volatileè§„åˆ™æ¥æ¨æ–­å°±å¯ä»¥äº†<br>è¾¹ç•Œå°±æ˜¯åªè¦ç»™volatileèµ‹å€¼æˆåŠŸï¼Œé‚£ä¹ˆè¿™ä¸ªèµ‹å€¼è¯­å¥ä¹‹å‰æ‰€æœ‰ä»£ç çš„æ‰§è¡Œç»“æœéƒ½å¯¹å…¶ä»–çº¿ç¨‹å¯è§<br>","user_name":"ä½œè€…å›å¤","user_name_real":"ç‹å®ä»¤","uid":"1269969","ctime":1551787373,"ip_address":"","comment_id":72763,"utype":1}],"discussion_count":2,"race_medal":0,"score":"23026549058","product_id":100023901,"comment_content":"æˆ‘æœ‰ä¸€ä¸ªé—®é¢˜ä¸€ç›´å¼„ä¸æ˜ç™½ï¼Œvolatile ç¦ç”¨æŒ‡ä»¤é‡æ’çš„è¾¹ç•Œå¦‚ä½•ç¡®å®šï¼Ÿsynchornzied åŒ…è£¹çš„ä»£ç å—æœ‰æ˜ç¡®çš„è¾¹ç•Œï¼Œä¸ç®¡æ˜¯å¦åœ¨ä¸´ç•ŒåŒºå†…çš„ä»£ç æ˜¯å¦è°ƒç”¨å…¶ä»–æ–¹æ³•ã€‚<br><br>è€Œå¯¹ volatile ç±»å‹å˜é‡å‰åçš„å˜é‡çš„æ“ä½œå¹¶æ²¡æœ‰æ˜ç¡®çš„è¯­ä¹‰ä¸Šçš„è¾¹ç•Œï¼ŸæŸ¥äº†å¾ˆå¤šèµ„æ–™ï¼Œä»ç„¶æ²¡æœ‰æ‰¾åˆ°ç­”æ¡ˆï¼Œå¸Œæœ›è€å¸ˆè§£ç­”ä¸€ä¸‹ã€‚<br>","like_count":5,"discussions":[{"author":{"id":1269969,"avatar":"https://static001.geekbang.org/account/avatar/00/13/60/d1/8efa89ab.jpg","nickname":"ç‹å®ä»¤","note":"","ucode":"4FE19F5BC32FCA","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":441731,"discussion_content":"åˆ«æƒ³ç¦ç”¨æŒ‡ä»¤é‡æ’çš„äº‹ï¼Œå°±ç”¨é¡ºåºæ€§è§„åˆ™+ä¼ é€’è¡Œè§„åˆ™+volatileè§„åˆ™æ¥æ¨æ–­å°±å¯ä»¥äº†\nè¾¹ç•Œå°±æ˜¯åªè¦ç»™volatileèµ‹å€¼æˆåŠŸï¼Œé‚£ä¹ˆè¿™ä¸ªèµ‹å€¼è¯­å¥ä¹‹å‰æ‰€æœ‰ä»£ç çš„æ‰§è¡Œç»“æœéƒ½å¯¹å…¶ä»–çº¿ç¨‹å¯è§\n","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1551787373,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1484192,"avatar":"https://static001.geekbang.org/account/avatar/00/16/a5/a0/e0cccf7e.jpg","nickname":"åœ†åœ†æ»¡æ»¡","note":"","ucode":"396E7A822014D1","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":289379,"discussion_content":"å…¶å®è¿™ä¹ˆè¯´çš„è¯åº”è¯¥ä¸å«â€œç¦æ­¢æŒ‡ä»¤é‡æ’â€ï¼›è€Œæ˜¯ä¿è¯é‡æ’åçš„æ•ˆæœèƒ½ä¿è¯èµ‹å€¼æˆåŠŸæ—¶ï¼Œå‰é¢è¯­å¥çš„æ‰§è¡Œç»“æœå¯¹å…¶ä»–çº¿ç¨‹å¯è§ã€‚é‡ä¸é‡æ’ï¼Œå¦‚ä½•å®ç°è¿™ä¸ªæ˜¯å¦å¤–çš„é—®é¢˜äº†ã€‚è€å¸ˆè®²çš„æ˜¯è§„åˆ™ã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1594083954,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":72464,"user_name":"Geek_ebda96","can_delete":false,"product_type":"c1","uid":1134862,"ip_address":"","ucode":"02912E6D95A5A6","user_header":"http://thirdwx.qlogo.cn/mmopen/vi_32/DYAIOgq83eoRiaKX0ulEibbbwM4xhjyMeza0Pyp7KO1mqvfJceiaM6ZNtGpXJibI6P2qHGwBP9GKwOt9LgHicHflBXw/132","comment_is_top":false,"comment_ctime":1551634908,"is_pvip":false,"replies":[{"id":"26338","content":"åœ¨CPUå±‚é¢ï¼Œå¯èƒ½ä¼šé”æ€»çº¿ï¼Œå°†å…¶ä»–æ ¸é‡Œçš„ç¼“å­˜ç½®å¤±æ•ˆã€‚ä½†æ˜¯åœ¨Javaé‡Œé¢volatile é™¤äº†è¿™äº›ä¹‹å¤–ï¼Œè¿˜æ¶‰åŠåˆ°H-Bè§„åˆ™ã€‚æ‰€ä»¥volatile ä¸ä»…ä»…æ˜¯ä½ ç†è§£çš„è¿™äº›ã€‚","user_name":"ä½œè€…å›å¤","user_name_real":"ç‹å®ä»¤","uid":"1269969","ctime":1551708746,"ip_address":"","comment_id":72464,"utype":1}],"discussion_count":2,"race_medal":0,"score":"23026471388","product_id":100023901,"comment_content":"æˆ‘ç†è§£çš„volatile åœ¨æ“ä½œç³»ç»Ÿå±‚é¢ï¼Œåœ¨ä¿®æ”¹å˜é‡çš„å€¼æ—¶å€™ï¼Œcpuç¼“å­˜é”è¿˜æ˜¯è¦åŠ é”ï¼Œä¿®æ”¹å®Œæˆåä»ç¼“å­˜å†™å…¥å†…å­˜ï¼Œé”æ‰é‡Šæ”¾ï¼Œé”çš„è¿‡ç¨‹ä¸­ï¼Œå…¶ä»–çº¿ç¨‹è¯»æ˜¯è¦ç­‰å¾…å†™å…¥å®Œæˆï¼Œåªä¸è¿‡è¿™ä¸ªé”çš„æ—¶é—´å¾ˆçŸ­ï¼Œæ‰€ä»¥ä¸€èˆ¬æ„Ÿå—ä¸å‡ºæ¥å§ï¼Œä¸ç„¶çº¿ç¨‹aå†™å…¥è¿˜æ²¡å®Œæˆï¼Œçº¿ç¨‹bè¯»å–å˜é‡å€¼ä¸æ˜¯æœ€æ–°çš„ï¼Œè¿™æ‰èƒ½ä¿è¯å†™å¯¹è¯»å¯è§æ€§ï¼Œæœ›æŒ‡æ­£","like_count":5,"discussions":[{"author":{"id":1269969,"avatar":"https://static001.geekbang.org/account/avatar/00/13/60/d1/8efa89ab.jpg","nickname":"ç‹å®ä»¤","note":"","ucode":"4FE19F5BC32FCA","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":441600,"discussion_content":"åœ¨CPUå±‚é¢ï¼Œå¯èƒ½ä¼šé”æ€»çº¿ï¼Œå°†å…¶ä»–æ ¸é‡Œçš„ç¼“å­˜ç½®å¤±æ•ˆã€‚ä½†æ˜¯åœ¨Javaé‡Œé¢volatile é™¤äº†è¿™äº›ä¹‹å¤–ï¼Œè¿˜æ¶‰åŠåˆ°H-Bè§„åˆ™ã€‚æ‰€ä»¥volatile ä¸ä»…ä»…æ˜¯ä½ ç†è§£çš„è¿™äº›ã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1551708746,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":2308075,"avatar":"","nickname":"Geek_89e362","note":"","ucode":"E596C2CFE1CFAF","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":326235,"discussion_content":"è€çš„cpuæ¶æ„åº”è¯¥æ˜¯é”çš„æ€»çº¿ï¼Œè€Œç°åœ¨çš„åº”è¯¥æ˜¯ä½¿ç”¨çš„è‡ªåŠ¨â€œå—…æ¢â€æŠ€æœ¯ï¼Œæ˜¯cpuå®æ—¶æ£€æµ‹æ•°æ®æ€»çº¿ï¼Œè‡ªå·±ç¼“å­˜çš„å˜é‡å€¼æ˜¯å¦å˜åŒ–ï¼Œå¦‚æœå˜äº†ï¼Œå°±æŠŠç¼“å­˜ç½®ä½æ— æ•ˆï¼Œç„¶ååœ¨è¯»ä¹¦æ—¶å°±å»ä¸»å†…å­˜ä¸­è¯»å–","likes_number":1,"is_delete":false,"is_hidden":false,"ctime":1605568616,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":149745,"user_name":"FATMAN89","can_delete":false,"product_type":"c1","uid":1175430,"ip_address":"","ucode":"48A67FB47B3C5D","user_header":"https://static001.geekbang.org/account/avatar/00/11/ef/86/12f95d66.jpg","comment_is_top":false,"comment_ctime":1573364980,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"18753234164","product_id":100023901,"comment_content":"æˆ‘åªèƒ½è¯´ç•™è¨€åŒºçš„å¤§ç¥å¤ªå¤šäº†","like_count":4},{"had_liked":false,"id":90050,"user_name":"ç‹äºŒåŒ—","can_delete":false,"product_type":"c1","uid":1100655,"ip_address":"","ucode":"D9090E28B3E1F0","user_header":"https://static001.geekbang.org/account/avatar/00/10/cb/6f/c78ef1cf.jpg","comment_is_top":false,"comment_ctime":1556379144,"is_pvip":false,"replies":[{"id":"32336","content":"ä½ è¯´çš„æ˜¯å¯¹çš„ï¼ï¼ï¼","user_name":"ä½œè€…å›å¤","user_name_real":"ç‹å®ä»¤","uid":"1269969","ctime":1556464329,"ip_address":"","comment_id":90050,"utype":1}],"discussion_count":2,"race_medal":0,"score":"18736248328","product_id":100023901,"comment_content":"&quot;åˆ†æä¸€ä¸‹ï¼Œä¸ºä»€ä¹ˆ 1.5 ä»¥å‰çš„ç‰ˆæœ¬ä¼šå‡ºç° x = 0 çš„æƒ…å†µå‘¢ï¼Ÿæˆ‘ç›¸ä¿¡ä½ ä¸€å®šæƒ³åˆ°äº†ï¼Œå˜é‡ x å¯èƒ½è¢« CPU ç¼“å­˜è€Œå¯¼è‡´å¯è§æ€§é—®é¢˜ã€‚â€ï¼Œ è¿™å¥è¯æ˜¯ä¸æ˜¯æœ‰é—®é¢˜ï¼Œçº¿ç¨‹Bè¯»å–åˆ°å˜é‡xä¸º0ï¼Œä¸æ˜¯å› ä¸ºcpuç¼“å­˜å¯¼è‡´çš„å¯è§æ€§é—®é¢˜ï¼Œè€Œåº”è¯¥æ˜¯ æŒ‡ä»¤é‡æ’å¯¼è‡´çš„ã€‚","like_count":4,"discussions":[{"author":{"id":1269969,"avatar":"https://static001.geekbang.org/account/avatar/00/13/60/d1/8efa89ab.jpg","nickname":"ç‹å®ä»¤","note":"","ucode":"4FE19F5BC32FCA","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":448369,"discussion_content":"ä½ è¯´çš„æ˜¯å¯¹çš„ï¼ï¼ï¼","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1556464329,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":2220763,"avatar":"https://static001.geekbang.org/account/avatar/00/21/e2/db/97c6f756.jpg","nickname":"_patrick","note":"","ucode":"B24C6EEBCABB94","race_medal":0,"user_type":1,"is_pvip":true},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":571823,"discussion_content":"å¦‚æœå¯¹JMM å†…å­˜æ¨¡å‹ç†è§£çš„å†æ·±å…¥ä¸€ç‚¹ï¼Œå°±ä¼šå‘ç°è€å¸ˆè¯´çš„ä¹Ÿæ˜¯å¯¹çš„ã€‚ è¯»åˆ°x=0 æ˜¯å› ä¸ºå¯è§æ€§é—®é¢˜ï¼Œè€Œé‡æ’åºåˆå¼•å‘äº†å¯è§æ€§çš„é—®é¢˜ã€‚ è¿˜æœ‰é‡æ’åº åŒ…æ‹¬ cpuæŒ‡ä»¤é‡æ’åºã€ç¼–è¯‘å™¨ç¼–è¯‘æ—¶é‡æ’ï¼Œ å†…å­˜ç³»ç»Ÿé‡æ’åºã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1652423504,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":84790,"user_name":"null","can_delete":false,"product_type":"c1","uid":1024294,"ip_address":"","ucode":"F9039EFED6B55D","user_header":"http://thirdwx.qlogo.cn/mmopen/vi_32/PiajxSqBRaELZPnUAiajaR5C25EDLWeJURggyiaOP5GGPe2qlwpQcm5e3ybib8OsP4tvddFDLVRSNNGL5I3SFPJHsA/132","comment_is_top":false,"comment_ctime":1554907885,"is_pvip":false,"replies":[{"id":"30459","content":"synchronized çš„åˆ†ææ²¡æœ‰é—®é¢˜ï¼Œå…¶ä»–çº¿ç¨‹ç›´æ¥è®¿é—®è¿˜å¯èƒ½ä¸æ˜¯æœ€æ–°å€¼ï¼Œæˆ‘ç†è§£ç›´æ¥å°±æ˜¯æ²¡æœ‰ä½¿ç”¨ä»»ä½•åŒæ­¥æ‰‹æ®µã€‚<br>å³ä¾¿ç”¨ synchronizedï¼Œç”¨æ³•ä¸å¯¹ï¼Œä¹Ÿè¾¾ä¸åˆ°æ•ˆæœã€‚<br>è¯­è¨€æœ¬æ¥å°±ä¸å‡†ç¡®ï¼Œç•™è¨€çš„åŒå­¦ï¼Œå†™çš„éƒ½å¾ˆéšæ„ï¼Œå®åœ¨ä¸å¤ªé€‚åˆä»¥æ‰¹åˆ¤çš„çœ¼å…‰æ¥çœ‹å¾…ã€‚","user_name":"ä½œè€…å›å¤","user_name_real":"ç‹å®ä»¤","uid":"1269969","ctime":1554910369,"ip_address":"","comment_id":84790,"utype":1}],"discussion_count":2,"race_medal":0,"score":"18734777069","product_id":100023901,"comment_content":"@å‘æ¡æ©™å­â€¦ çš„æ€è€ƒé¢˜åˆ†æï¼Œæœ‰äº›ä¸å¤ªå‡†ç¡®å§ï¼Œä¾‹å¦‚è¯„è®ºé‡ŒæŒ‡å‡ºçš„ç¨‹åºé¡ºåºæ€§ã€‚è¿˜æœ‰ synchronized çš„åˆ†æä¹Ÿä¸å¤ªå‡†ç¡®å§ï¼Œsynchronized(abc) å¯èƒ½ä¿è¯åç»­æ“ä½œå¯è§ã€‚<br><br>è€å¸ˆæ˜¯å¦åº”è¯¥åœ¨å›å¤è¯„è®ºæ—¶æŒ‡æ­£ï¼Œå¦åˆ™ç«¥é‹ä»¬çœ‹åˆ°â€œåˆ†æå¾—æ¯”æˆ‘å¥½â€çš„å›å¤ï¼Œå¾ˆå¤§å¯èƒ½å°±ç…§ç€åˆ†ææ¥ç†è§£äº†ã€‚","like_count":4,"discussions":[{"author":{"id":1269969,"avatar":"https://static001.geekbang.org/account/avatar/00/13/60/d1/8efa89ab.jpg","nickname":"ç‹å®ä»¤","note":"","ucode":"4FE19F5BC32FCA","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":446448,"discussion_content":"synchronized çš„åˆ†ææ²¡æœ‰é—®é¢˜ï¼Œå…¶ä»–çº¿ç¨‹ç›´æ¥è®¿é—®è¿˜å¯èƒ½ä¸æ˜¯æœ€æ–°å€¼ï¼Œæˆ‘ç†è§£ç›´æ¥å°±æ˜¯æ²¡æœ‰ä½¿ç”¨ä»»ä½•åŒæ­¥æ‰‹æ®µã€‚\nå³ä¾¿ç”¨ synchronizedï¼Œç”¨æ³•ä¸å¯¹ï¼Œä¹Ÿè¾¾ä¸åˆ°æ•ˆæœã€‚\nè¯­è¨€æœ¬æ¥å°±ä¸å‡†ç¡®ï¼Œç•™è¨€çš„åŒå­¦ï¼Œå†™çš„éƒ½å¾ˆéšæ„ï¼Œå®åœ¨ä¸å¤ªé€‚åˆä»¥æ‰¹åˆ¤çš„çœ¼å…‰æ¥çœ‹å¾…ã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1554910369,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1123043,"avatar":"https://static001.geekbang.org/account/avatar/00/11/22/e3/510b69f9.jpg","nickname":"benny","note":"","ucode":"E2F30AF0C808D9","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":102659,"discussion_content":"è¯­è¨€æœ¬æ¥å°±ä¸å‡†ç¡®ï¼Œç•™è¨€çš„åŒå­¦ï¼Œå†™çš„éƒ½å¾ˆéšæ„ -ã€‹ ä½†è€å¸ˆçš„å›å¤è¿˜æ˜¯è¦æŒ‡å‡ºé—®é¢˜ ä¸èƒ½å¤ªç®€å• ä¸ç„¶çœŸçš„æ˜¯â€œå¾ˆå¤§å¯èƒ½å°±ç…§ç€åˆ†ææ¥ç†è§£â€","likes_number":2,"is_delete":false,"is_hidden":false,"ctime":1577359042,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":74930,"user_name":"Hello,Hello,Hello Kitty","can_delete":false,"product_type":"c1","uid":1185329,"ip_address":"","ucode":"8769FB28FE6399","user_header":"https://static001.geekbang.org/account/avatar/00/12/16/31/929f811e.jpg","comment_is_top":false,"comment_ctime":1552314585,"is_pvip":false,"replies":[{"id":"27300","content":"è¿™æ–¹é¢ï¼Œæˆ‘ä¹Ÿå¾ˆéš¾é€šé€åœ°è®²æ¸…æ¥šä»Javaä»£ç åˆ°CPUæŒ‡ä»¤çš„è¿‡ç¨‹ï¼Œå•çº¿ç¨‹ä¿è¯xå¯è§å¾ˆå®¹æ˜“ï¼Œå¤šçº¿ç¨‹xè·Ÿvä¸èƒ½éƒ½åŒæ—¶åœ¨ä¸€ä¸ªå¯„å­˜å™¨é‡Œã€‚voatile våˆ·æ–°å›å†…å­˜çš„æ—¶å€™ï¼Œæ‰€æœ‰CPUç¼“å­˜é‡Œçš„å€¼éƒ½ä¼šå¤±æ•ˆã€‚ä¸‹æ¬¡è®¿é—®å°±èƒ½è®¿é—®åˆ°æ–°çš„äº†ã€‚","user_name":"ä½œè€…å›å¤","user_name_real":"ç‹å®ä»¤","uid":"1269969","ctime":1552316317,"ip_address":"","comment_id":74930,"utype":1}],"discussion_count":1,"race_medal":0,"score":"18732183769","product_id":100023901,"comment_content":"x = 42;<br>v = true;<br>è€å¸ˆ æˆ‘æƒ³è¯·å‡ä¸€ä¸‹ xå¹¶æ²¡æœ‰åŠ volatileä¿®é¥° JVMæ˜¯å¦‚ä½•ä¿è¯xçš„ç»“æœä¹Ÿæ˜¯è¢«å¯è§å‘¢ æ˜¯å› ä¸ºxè·Ÿvéƒ½åœ¨åŒä¸€ä¸ªå¯„å­˜å™¨ä¸­ voatileä¿®é¥°çš„vè¢«åˆ·æ–°å›å†…å­˜çš„æ—¶å€™ æ•´ä¸ªå¯„å­˜å™¨ä¸­çš„å€¼éƒ½è¢«åˆ·æ–°åˆ°å†…å­˜ä¸­äº†å—ï¼Ÿ<br>","like_count":4,"discussions":[{"author":{"id":1269969,"avatar":"https://static001.geekbang.org/account/avatar/00/13/60/d1/8efa89ab.jpg","nickname":"ç‹å®ä»¤","note":"","ucode":"4FE19F5BC32FCA","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":442746,"discussion_content":"è¿™æ–¹é¢ï¼Œæˆ‘ä¹Ÿå¾ˆéš¾é€šé€åœ°è®²æ¸…æ¥šä»Javaä»£ç åˆ°CPUæŒ‡ä»¤çš„è¿‡ç¨‹ï¼Œå•çº¿ç¨‹ä¿è¯xå¯è§å¾ˆå®¹æ˜“ï¼Œå¤šçº¿ç¨‹xè·Ÿvä¸èƒ½éƒ½åŒæ—¶åœ¨ä¸€ä¸ªå¯„å­˜å™¨é‡Œã€‚voatile våˆ·æ–°å›å†…å­˜çš„æ—¶å€™ï¼Œæ‰€æœ‰CPUç¼“å­˜é‡Œçš„å€¼éƒ½ä¼šå¤±æ•ˆã€‚ä¸‹æ¬¡è®¿é—®å°±èƒ½è®¿é—®åˆ°æ–°çš„äº†ã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1552316317,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":72952,"user_name":"zyl","can_delete":false,"product_type":"c1","uid":1100717,"ip_address":"","ucode":"2F872341AC8D7E","user_header":"https://thirdwx.qlogo.cn/mmopen/vi_32/DYAIOgq83eq65BWyJb39rq0Qgx1fnELVSZGGuLY6oBmYcmFj2Oqy9iauAWfbqO5U63I22Uo1POrrTp7tFWXibxvg/132","comment_is_top":false,"comment_ctime":1551758582,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"18731627766","product_id":100023901,"comment_content":"åº•å±‚éƒ½æ˜¯åŠ storeå±éšœ loadå±éšœæ¥ä¿éšœå¯è§æ€§ï¼Œç«‹å³ä»å†™ç¼“å†²åŒºåˆ·æ–°æ•°æ®åˆ°cacheæˆ–ä¸»å†…å­˜ï¼Œç«‹å³é‡æ–°readæ•°æ®ï¼Œå†™ç¼“å†²åŒºæ²¡åˆ·æ–°è§¦å‘å†™ç¼“å†²åŒºåˆ·æ–°ï¼Œæ‹‰å–æ–°æ•°æ®ã€‚<br>åŠ acquireå’Œreleaseå±éšœæ¥ç¦æ­¢é‡æ’åº","like_count":4},{"had_liked":false,"id":72302,"user_name":"å°ä¸‡é‡Œ","can_delete":false,"product_type":"c1","uid":1439905,"ip_address":"","ucode":"5DD447B5DAFA3A","user_header":"https://static001.geekbang.org/account/avatar/00/15/f8/a1/8780f900.jpg","comment_is_top":false,"comment_ctime":1551581966,"is_pvip":false,"replies":[{"id":"26201","content":"æ²¡æœ‰ç¦æ­¢æŒ‡ä»¤é‡æ’ï¼Œè¦æ±‚ç¼–è¯‘å™¨é‡æ’åçš„ç»“æœ==é¡ºåºæ‰§è¡Œçš„ç»“æœã€‚æ‰€ä»¥ä½ å¯ä»¥ç”¨é¡ºåºæ‰§è¡Œæ¥æ¨æ–­ç»“æœã€‚","user_name":"ä½œè€…å›å¤","user_name_real":"ç‹å®ä»¤","uid":"1269969","ctime":1551591260,"ip_address":"","comment_id":72302,"utype":1}],"discussion_count":1,"race_medal":0,"score":"18731451150","product_id":100023901,"comment_content":"happens-beforeçš„ç¬¬ä¸€ä¸ªè§„åˆ™å®é™…ä¸Šç¦æ­¢äº†æŒ‡ä»¤é‡æ’åºï¼Œå¯ä»¥è¿™ä¹ˆç†è§£å—ï¼Ÿå¸Œæœ›è€å¸ˆè§£ç­”ä¸€ä¸‹å‘¢","like_count":4,"discussions":[{"author":{"id":1269969,"avatar":"https://static001.geekbang.org/account/avatar/00/13/60/d1/8efa89ab.jpg","nickname":"ç‹å®ä»¤","note":"","ucode":"4FE19F5BC32FCA","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":441531,"discussion_content":"æ²¡æœ‰ç¦æ­¢æŒ‡ä»¤é‡æ’ï¼Œè¦æ±‚ç¼–è¯‘å™¨é‡æ’åçš„ç»“æœ==é¡ºåºæ‰§è¡Œçš„ç»“æœã€‚æ‰€ä»¥ä½ å¯ä»¥ç”¨é¡ºåºæ‰§è¡Œæ¥æ¨æ–­ç»“æœã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1551591260,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":71989,"user_name":"å€šæ¢¦æµ","can_delete":false,"product_type":"c1","uid":1435045,"ip_address":"","ucode":"7CB442D629534B","user_header":"https://static001.geekbang.org/account/avatar/00/15/e5/a5/fae40ac3.jpg","comment_is_top":false,"comment_ctime":1551495220,"is_pvip":false,"replies":[{"id":"26096","content":"æ˜¯è¿™æ ·çš„ï¼Œå¤šä¸ªçº¿ç¨‹æ“ä½œä¸€ä¸ªå®ä¾‹ã€‚<br>å…±äº«å˜é‡ä¸ä¸€å®šç”¨staticä¿®é¥°<br>ç»“æœéƒ½ä¸€æ ·","user_name":"ä½œè€…å›å¤","user_name_real":"ç‹å®ä»¤","uid":"1269969","ctime":1551521832,"ip_address":"","comment_id":71989,"utype":1}],"discussion_count":1,"race_medal":0,"score":"18731364404","product_id":100023901,"comment_content":"è¿™é‡Œå®ä¾‹é‡Œçš„å…±äº«å˜é‡ä¸ºä»€ä¹ˆæ²¡æœ‰ç”¨staticä¿®é¥°ï¼Ÿæ˜¯å› ä¸ºè¿™é‡Œçš„çº¿ç¨‹æ“ä½œçš„éƒ½æ˜¯åŒä¸€ä¸ªå®ä¾‹ï¼Œæ‰€ä»¥å…±äº«å˜é‡ä¸éœ€è¦ç”¨staticä¿®é¥°å—ï¼Ÿå¦‚æœç”¨äº†staticï¼Œç»“æœåº”è¯¥ä¹Ÿæ˜¯ä¸€æ ·çš„å§","like_count":4,"discussions":[{"author":{"id":1269969,"avatar":"https://static001.geekbang.org/account/avatar/00/13/60/d1/8efa89ab.jpg","nickname":"ç‹å®ä»¤","note":"","ucode":"4FE19F5BC32FCA","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":441419,"discussion_content":"æ˜¯è¿™æ ·çš„ï¼Œå¤šä¸ªçº¿ç¨‹æ“ä½œä¸€ä¸ªå®ä¾‹ã€‚\nå…±äº«å˜é‡ä¸ä¸€å®šç”¨staticä¿®é¥°\nç»“æœéƒ½ä¸€æ ·","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1551521832,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":72803,"user_name":"ä»»é¹æ–Œ","can_delete":false,"product_type":"c1","uid":1104086,"ip_address":"","ucode":"34319B05EA6E74","user_header":"https://static001.geekbang.org/account/avatar/00/10/d8/d6/47da34bf.jpg","comment_is_top":false,"comment_ctime":1551740325,"is_pvip":false,"replies":[{"id":"26467","content":"å¦‚æœä¸åŠ  volatileï¼Œåœ¨å•çº¿ç¨‹é‡Œ<br> x = 42;<br> v = true;<br> if (v==true) { <br>    &#47;&#47;è¿™é‡Œxä¸€å®š===42<br> }<br><br>å¤šçº¿ç¨‹é‡Œæ²¡åŠæ³•ç¡®å®šxæ˜¯0è¿˜æ˜¯42<br>","user_name":"ä½œè€…å›å¤","user_name_real":"ç‹å®ä»¤","uid":"1269969","ctime":1551793188,"ip_address":"","comment_id":72803,"utype":1}],"discussion_count":1,"race_medal":0,"score":"14436642213","product_id":100023901,"comment_content":"è€å¸ˆæœ‰ä¸ªé—®é¢˜æ˜¯å…³äºA happen before Bçš„åˆ¤æ–­ï¼Œåœ¨ç¬¬ä¸€ä¸ªä¾‹å­ä¸­xä¸vè™½ç„¶ä¸€ä¸ªåœ¨å‰ä¸€ä¸ªåœ¨åï¼Œä½†å¹¶æ²¡æœ‰ç›´æ¥å…³è”ï¼Œä»…ä»…æ˜¯æ ¹æ®ä»£ç çš„å‰åå°±èƒ½åˆ¤æ–­happen beforeå—ï¼Ÿå¦‚æœvä¸åŠ volatiä¿®é¥°åˆæ˜¯å¦‚ä½•å‘¢ï¼Ÿ<br>&#47;&#47; ä»¥ä¸‹ä»£ç æ¥æºäºã€å‚è€ƒ 1ã€‘<br>class VolatileExample {<br>  int x = 0;<br>  volatile boolean v = false;<br>  public void writer() {<br>    x = 42;<br>    v = true;<br>  }<br>  public void reader() {<br>    if (v == true) {<br>      &#47;&#47; è¿™é‡Œ x ä¼šæ˜¯å¤šå°‘å‘¢ï¼Ÿ<br>    }<br>  }<br>}<br>","like_count":3,"discussions":[{"author":{"id":1269969,"avatar":"https://static001.geekbang.org/account/avatar/00/13/60/d1/8efa89ab.jpg","nickname":"ç‹å®ä»¤","note":"","ucode":"4FE19F5BC32FCA","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":441757,"discussion_content":"å¦‚æœä¸åŠ  volatileï¼Œåœ¨å•çº¿ç¨‹é‡Œ\n x = 42;\n v = true;\n if (v==true) { \n    //è¿™é‡Œxä¸€å®š===42\n }\n\nå¤šçº¿ç¨‹é‡Œæ²¡åŠæ³•ç¡®å®šxæ˜¯0è¿˜æ˜¯42\n","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1551793188,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":71985,"user_name":"7","can_delete":false,"product_type":"c1","uid":1114093,"ip_address":"","ucode":"10A6E57A027D42","user_header":"https://static001.geekbang.org/account/avatar/00/10/ff/ed/b2fc0e7c.jpg","comment_is_top":false,"comment_ctime":1551494901,"is_pvip":false,"replies":[{"id":"26095","content":"å¤ªå…¨é¢äº†ï¼","user_name":"ä½œè€…å›å¤","user_name_real":"ç‹å®ä»¤","uid":"1269969","ctime":1551521686,"ip_address":"","comment_id":71985,"utype":1}],"discussion_count":2,"race_medal":0,"score":"14436396789","product_id":100023901,"comment_content":"volatileæ ‡è®°æ”¹å˜é‡ï¼Œ<br>synåŠ é”ï¼Œ<br>lockåŠ é”ï¼Œ<br>joinï¼Œ<br>å˜ä¸ºfinalçš„é™æ€å˜é‡ï¼Ÿ<br>å¿˜è€å¸ˆç‚¹è¯„ï¼Œè°¢è°¢","like_count":3,"discussions":[{"author":{"id":1269969,"avatar":"https://static001.geekbang.org/account/avatar/00/13/60/d1/8efa89ab.jpg","nickname":"ç‹å®ä»¤","note":"","ucode":"4FE19F5BC32FCA","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":441417,"discussion_content":"å¤ªå…¨é¢äº†ï¼","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1551521686,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1313164,"avatar":"https://static001.geekbang.org/account/avatar/00/14/09/8c/daaee028.jpg","nickname":"Shaozw","note":"","ucode":"E749A517A9A904","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":242045,"discussion_content":"å˜ä¸ºfinalä¿®é¥°çš„é™æ€å˜é‡ï¼Œemmmï¼Œå¦‚æœæ˜¯JavaåŸºç¡€ç±»å‹ï¼Œé‚£å°±æ²¡æ³•æ”¹å˜å€¼äº†å§","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1587460917,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":245733,"user_name":"è¥¿é—¨å¹ç‰›","can_delete":false,"product_type":"c1","uid":1508990,"ip_address":"","ucode":"E5D3624DDE1E83","user_header":"https://static001.geekbang.org/account/avatar/00/17/06/7e/735968e2.jpg","comment_is_top":false,"comment_ctime":1599036742,"is_pvip":false,"replies":[{"id":"90435","content":"ğŸ‘ğŸ»","user_name":"ä½œè€…å›å¤","user_name_real":"ç‹å®ä»¤","uid":"1269969","ctime":1599176019,"ip_address":"","comment_id":245733,"utype":1}],"discussion_count":1,"race_medal":0,"score":"10188971334","product_id":100023901,"comment_content":"é€¸å‡ºï¼š<br>åœ¨æ„é€ æ–¹æ³•ä¸­å°†this å¤åˆ¶ç»™åˆ«çš„å˜é‡ï¼Œæ„å‘³ç€ï¼Œæ„é€ æ–¹æ³•è¿˜æ²¡ç»“æŸï¼Œå¯¹è±¡this å°±ç»™åˆ«äººä½¿ç”¨äº†ã€‚å¯¹è±¡è¿˜æ²¡åˆå§‹åŒ–å®Œæˆï¼Œåˆ«äººå°±ä½¿ç”¨ï¼Œç±»ä¼¼åŒå±‚æ ¡éªŒåˆ›å»ºå•ä¾‹çš„ä¾‹å­ã€‚<br>é€¸å‡ºè¦é¿å…ï¼Œè¦é¿å…è¿™ç§å†™æ³•ã€‚<br>åŒæ—¶ï¼Œå¦‚æœåœ¨æ„é€ æ–¹æ³•ä¸­å¯¹æˆå‘˜å˜é‡èµ‹åˆå§‹å€¼ï¼Œæ¯”å¦‚this.x = xï¼Œè¿™æ ·çš„ä»£ç åœ¨ç¼–è¯‘çš„æ—¶å€™ï¼Œä¹Ÿä¼šè¢«é‡æ’åºï¼Œå°†èµ‹å€¼æ“ä½œé‡æ’åºåˆ°æ„é€ æ–¹æ³•ä¹‹å¤–ï¼Œé‚£ä¹ˆä¹Ÿå°±æ˜¯ï¼Œæ„é€ æ–¹æ³•ç»“æŸäº†ï¼Œåˆå§‹åŒ–å®Œæˆäº†ï¼Œè¿™æ—¶å€™ï¼Œåˆ«çš„çº¿ç¨‹å…ˆåå¯èƒ½ä¼šè¯»å–åˆ°ä¿©ä¸ªä¸åŒçš„å€¼ï¼Œä¸€ä¸ªæ²¡åˆå§‹åŒ–çš„ï¼Œä¸€ä¸ªåˆå§‹åŒ–åçš„å€¼ã€‚è¦é¿å…è¿™ç§æƒ…å†µçš„å‘é€ï¼Œå°±è¦ç”¨fianlï¼Œfinalä¿®é¥°çš„å˜é‡ï¼Œå¯ä»¥ä¿è¯ï¼Œä¸ä¼šè¢«æŠ½æ’åºåˆ°æ„é€ æ–¹æ³•ä¹‹å¤–ï¼Œé‚£ä¹ˆå°±ä¿è¯äº†ï¼Œåªè¦åˆ«çš„çº¿ç¨‹æ‹¿åˆ°è¯¥å¯¹è±¡çš„å¼•ç”¨ï¼Œé‚£ä¹ˆæ”¹å¯¹è±¡çš„fianlä¿®é¥°çš„å˜é‡ï¼Œåˆ«çš„çº¿ç¨‹ä¸€å®šæ˜¯èƒ½è¯»åˆ°åœ¨æ„é€ æ–¹æ³•ä¸­åˆå§‹åŒ–çš„å€¼çš„ï¼Œé¿å…äº†ä¸Šé¢åŒä¸€å˜é‡ï¼Œè¯»å–å€¼ä¿©æ¬¡ä¸ä¸€æ ·çš„é—®é¢˜ã€‚","like_count":2,"discussions":[{"author":{"id":1269969,"avatar":"https://static001.geekbang.org/account/avatar/00/13/60/d1/8efa89ab.jpg","nickname":"ç‹å®ä»¤","note":"","ucode":"4FE19F5BC32FCA","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":504972,"discussion_content":"ğŸ‘ğŸ»","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1599176019,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":149635,"user_name":"Randy","can_delete":false,"product_type":"c1","uid":1125259,"ip_address":"","ucode":"7BF52ADBFD4F5D","user_header":"https://static001.geekbang.org/account/avatar/00/11/2b/8b/dd02189a.jpg","comment_is_top":false,"comment_ctime":1573296022,"is_pvip":false,"replies":[{"id":"57606","content":"ç”¨åŒæ­¥å…³é”®å­—è§£å†³","user_name":"ä½œè€…å›å¤","user_name_real":"ç‹å®ä»¤","uid":"1269969","ctime":1573382270,"ip_address":"","comment_id":149635,"utype":1}],"discussion_count":1,"race_medal":0,"score":"10163230614","product_id":100023901,"comment_content":"å®ä»¤è€å¸ˆï¼Œæˆ‘æŸ¥äº†ä¸€ä¸‹ï¼Œvolatileåœ¨jdk1.5ä¹‹å‰å°±å­˜åœ¨äº†ï¼Œæ‚¨ä¸Šæ–‡ä¸­è¯´åˆ°çš„â€œç›´è§‰ä¸Šçœ‹ï¼Œåº”è¯¥æ˜¯ 42ï¼Œé‚£å®é™…åº”è¯¥æ˜¯å¤šå°‘å‘¢ï¼Ÿè¿™ä¸ªè¦çœ‹ Java çš„ç‰ˆæœ¬ï¼Œå¦‚æœåœ¨ä½äº 1.5 ç‰ˆæœ¬ä¸Šè¿è¡Œï¼Œx å¯èƒ½æ˜¯ 42ï¼Œä¹Ÿæœ‰å¯èƒ½æ˜¯ 0ï¼›å¦‚æœåœ¨ 1.5 ä»¥ä¸Šçš„ç‰ˆæœ¬ä¸Šè¿è¡Œï¼Œx å°±æ˜¯ç­‰äº 42ã€‚â€ï¼Œvolatile åœ¨JDK1.5ä¹‹å‰å¹¶æ²¡æœ‰å®ç°HBåŸåˆ™ï¼Œé‚£åœ¨JDK1.5ä¹‹å‰volatile çš„å­˜åœ¨æ„ä¹‰æ˜¯ä»€ä¹ˆå‘¢ï¼Œä»¥åŠJDK1.5ä¹‹å‰æ€ä¹ˆè§£å†³è¿™ç§é—®é¢˜å‘¢","like_count":2,"discussions":[{"author":{"id":1269969,"avatar":"https://static001.geekbang.org/account/avatar/00/13/60/d1/8efa89ab.jpg","nickname":"ç‹å®ä»¤","note":"","ucode":"4FE19F5BC32FCA","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":473921,"discussion_content":"ç”¨åŒæ­¥å…³é”®å­—è§£å†³","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1573382270,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":141097,"user_name":"æ— è¨€çš„çº¦å®š","can_delete":false,"product_type":"c1","uid":1128953,"ip_address":"","ucode":"5E8046EB6B7956","user_header":"https://static001.geekbang.org/account/avatar/00/11/39/f9/acfb9a48.jpg","comment_is_top":false,"comment_ctime":1571114228,"is_pvip":false,"replies":[{"id":"54604","content":"ä¹Ÿæ˜¯è¿™æ ·ï¼Œçº¿ç¨‹æ‰æ˜¯CPUæœ€å°çš„è°ƒåº¦å•å…ƒ","user_name":"ä½œè€…å›å¤","user_name_real":"ç‹å®ä»¤","uid":"1269969","ctime":1571142304,"ip_address":"","comment_id":141097,"utype":1}],"discussion_count":1,"race_medal":0,"score":"10161048820","product_id":100023901,"comment_content":"åœ¨ä¸€ä¸ªæ—¶é—´ç‰‡å†…ï¼Œå¦‚æœä¸€ä¸ªè¿›ç¨‹è¿›è¡Œä¸€ä¸ª IO æ“ä½œï¼Œä¾‹å¦‚è¯»ä¸ªæ–‡ä»¶ï¼Œè¿™ä¸ªæ—¶å€™è¯¥è¿›ç¨‹å¯ä»¥æŠŠè‡ªå·±æ ‡è®°ä¸ºâ€œä¼‘çœ çŠ¶æ€â€å¹¶å‡ºè®© CPU çš„ä½¿ç”¨æƒï¼Œå¾…æ–‡ä»¶è¯»è¿›å†…å­˜ï¼Œæ“ä½œç³»ç»Ÿä¼šæŠŠè¿™ä¸ªä¼‘çœ çš„è¿›ç¨‹å”¤é†’ï¼Œå”¤é†’åçš„è¿›ç¨‹å°±æœ‰æœºä¼šé‡æ–°è·å¾— CPU çš„ä½¿ç”¨æƒäº†ã€‚<br>ç‹è€å¸ˆï¼Œè¿™ä¸ªæ ‡è®°ä¸ºä¼‘çœ çŠ¶æ€ï¼Œå¹¶è®©å‡ºCPUæ˜¯åœ¨ä¸€ä¸ªæ—¶é—´ç‰‡ç»“æŸçš„æ—¶å€™ï¼Œè¿˜æ˜¯åœ¨ä¸€ä¸ªæ—¶é—´ç‰‡å†…å‘¢ï¼Ÿ<br>ä½œè€…å›å¤: æ—¶é—´ç‰‡å†…ä¸»åŠ¨é‡Šæ”¾CPUä½¿ç”¨æƒï¼Œæ— éœ€ç­‰åˆ°ç»“æŸ<br><br>ç‹è€å¸ˆï¼Œè¿™ä¸ªè®²çš„æ˜¯è¿›ç¨‹ï¼Œçº¿ç¨‹ä¹Ÿæ˜¯è¿™æ ·å—ï¼Ÿ","like_count":2,"discussions":[{"author":{"id":1269969,"avatar":"https://static001.geekbang.org/account/avatar/00/13/60/d1/8efa89ab.jpg","nickname":"ç‹å®ä»¤","note":"","ucode":"4FE19F5BC32FCA","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":470668,"discussion_content":"ä¹Ÿæ˜¯è¿™æ ·ï¼Œçº¿ç¨‹æ‰æ˜¯CPUæœ€å°çš„è°ƒåº¦å•å…ƒ","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1571142304,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":138059,"user_name":"delete is create","can_delete":false,"product_type":"c1","uid":1147979,"ip_address":"","ucode":"A8C751219A7746","user_header":"https://static001.geekbang.org/account/avatar/00/11/84/4b/e4738ba8.jpg","comment_is_top":false,"comment_ctime":1570004057,"is_pvip":true,"replies":[{"id":"53086","content":"åªæ˜¯javaå†™çš„ä¼ªç ï¼Œä¸ä¿è¯å¯ä»¥æ‰§è¡Œ","user_name":"ä½œè€…å›å¤","user_name_real":"ç‹å®ä»¤","uid":"1269969","ctime":1570010747,"ip_address":"","comment_id":138059,"utype":1}],"discussion_count":1,"race_medal":0,"score":"10159938649","product_id":100023901,"comment_content":"è€å¸ˆ  ä¸ºä»€ä¹ˆæœ‰çš„å®ä¾‹ä»£ç å¤åˆ¶åˆ°æˆ‘æœ¬åœ°æ˜¯æŠ¥é”™çš„ï¼Œæ¯”å¦‚æœ€åä¸€æ®µå®ä¾‹ä»£ç ï¼Œfinal int x ï¼› ä¸åˆå§‹åŒ–ä¼šæŠ¥é”™çš„ï¼Œæˆ‘æœ¬åœ°jdkæ˜¯1.8çš„","like_count":2,"discussions":[{"author":{"id":1269969,"avatar":"https://static001.geekbang.org/account/avatar/00/13/60/d1/8efa89ab.jpg","nickname":"ç‹å®ä»¤","note":"","ucode":"4FE19F5BC32FCA","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":469366,"discussion_content":"åªæ˜¯javaå†™çš„ä¼ªç ï¼Œä¸ä¿è¯å¯ä»¥æ‰§è¡Œ","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1570010747,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":129905,"user_name":"è¡Œè€…","can_delete":false,"product_type":"c1","uid":1618607,"ip_address":"","ucode":"8179D167D99CB9","user_header":"https://static001.geekbang.org/account/avatar/00/18/b2/af/81303f5a.jpg","comment_is_top":false,"comment_ctime":1567322918,"is_pvip":false,"replies":[{"id":"48630","content":"å®˜æ–¹çš„æ˜¯è¦åŠ ä¸Šè¿™ä¿©çš„ï¼Œè¿™ä¸ªä¸æ˜¯åˆ«äººçš„ä¸ªäººæ€»ç»“","user_name":"ä½œè€…å›å¤","user_name_real":"ç‹å®ä»¤","uid":"1269969","ctime":1567426567,"ip_address":"","comment_id":129905,"utype":1}],"discussion_count":1,"race_medal":0,"score":"10157257510","product_id":100023901,"comment_content":"è¯·é—®è€å¸ˆï¼Œåœ¨æœ‰çš„æ–‡ç« ä¸­çœ‹åˆ°è¿˜æœ‰ä¸¤ä¸ªè§„åˆ™ï¼š<br><br>1.çº¿ç¨‹ä¸­æ–­è§„åˆ™ï¼šå¯¹çº¿ç¨‹interrupt()æ–¹æ³•çš„è°ƒç”¨å…ˆè¡Œå‘ç”Ÿäºè¢«ä¸­æ–­çº¿ç¨‹çš„ä»£ç æ£€æµ‹åˆ°ä¸­æ–­äº‹ä»¶çš„å‘ç”Ÿ<br>2.å¯¹è±¡ç»ˆç»“è§„åˆ™ï¼šä¸€ä¸ªå¯¹è±¡çš„åˆå§‹åŒ–å®Œæˆ(æ„é€ å‡½æ•°æ‰§è¡Œç»“æŸ)å…ˆè¡Œå‘ç”Ÿäºå®ƒçš„finalize()æ–¹æ³•çš„å¼€å§‹<br><br>è¿™ä¸¤ä¸ªè§„åˆ™å¯å¦ç®—æ˜¯å¯¹è€å¸ˆæ‰€è®²çš„å…­ä¸ªè§„åˆ™çš„è¡¥å……ï¼Œè¿˜æ˜¯è¯´è¿™åªæ˜¯åˆ«äººçš„ä¸ªäººç†è§£çš„æ€»ç»“","like_count":2,"discussions":[{"author":{"id":1269969,"avatar":"https://static001.geekbang.org/account/avatar/00/13/60/d1/8efa89ab.jpg","nickname":"ç‹å®ä»¤","note":"","ucode":"4FE19F5BC32FCA","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":465708,"discussion_content":"å®˜æ–¹çš„æ˜¯è¦åŠ ä¸Šè¿™ä¿©çš„ï¼Œè¿™ä¸ªä¸æ˜¯åˆ«äººçš„ä¸ªäººæ€»ç»“","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1567426567,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":90647,"user_name":"åç«¯å­¦é•¿","can_delete":false,"product_type":"c1","uid":1178011,"ip_address":"","ucode":"7E82F2B5930CD5","user_header":"https://static001.geekbang.org/account/avatar/00/11/f9/9b/dc074a7e.jpg","comment_is_top":false,"comment_ctime":1556598111,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"10146532703","product_id":100023901,"comment_content":"è€å¸ˆæœ‰ä¸ªç–‘é—®?è¢«volatileå…³é”®å­—ä¿®é¥°çš„å˜é‡ï¼Œåšå†™æ“ä½œçš„æ—¶å€™ï¼Œæ–‡ç« ä¸­çš„æ„æ€ç›´æ¥æ“ä½œå†…å­˜ï¼Œè€Œç›¸å…³ä¹¦ç±ä¸­ä¼šè¯´æ“ä½œç¼“å­˜ï¼Œåªæ˜¯Cpuç«‹é©¬ä¼šå‘å‡ºæŒ‡ä»¤å°†ç¼“å­˜ä¸­çš„æ•°æ®åˆ·æ–°åˆ°å†…å­˜ä¸­ï¼Ÿå…·ä½“å“ªä¸€ä¸ªæ¯”è¾ƒæ­£ç¡®å‘¢ï¼Ÿ","like_count":2},{"had_liked":false,"id":86712,"user_name":"devil","can_delete":false,"product_type":"c1","uid":1259625,"ip_address":"","ucode":"BB6090411BAA23","user_header":"https://static001.geekbang.org/account/avatar/00/13/38/69/864569a4.jpg","comment_is_top":false,"comment_ctime":1555429638,"is_pvip":false,"replies":[{"id":"31309","content":"åŠ ä¸Šä¼ é€’æ€§å°±æœ‰å…³ç³»äº†<br>","user_name":"ä½œè€…å›å¤","user_name_real":"ç‹å®ä»¤","uid":"1269969","ctime":1555510895,"ip_address":"","comment_id":86712,"utype":1}],"discussion_count":1,"race_medal":0,"score":"10145364230","product_id":100023901,"comment_content":"è§„åˆ™1å’Œvolatileæœ‰ä»€ä¹ˆå…³ç³»ï¼Ÿæœ‰volatile å˜é‡æ‰ä¼šéµå¾ªè¿™ä¸ªè§„åˆ™å—ï¼Ÿå¦‚æœä¾‹å­ä¸­æ²¡æœ‰volatileæ˜¯ä¸æ˜¯å°±ä¸éµå¾ªé¡ºåºè§„åˆ™äº†","like_count":2,"discussions":[{"author":{"id":1269969,"avatar":"https://static001.geekbang.org/account/avatar/00/13/60/d1/8efa89ab.jpg","nickname":"ç‹å®ä»¤","note":"","ucode":"4FE19F5BC32FCA","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":447132,"discussion_content":"åŠ ä¸Šä¼ é€’æ€§å°±æœ‰å…³ç³»äº†\n","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1555510895,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":76623,"user_name":"sakura","can_delete":false,"product_type":"c1","uid":1449550,"ip_address":"","ucode":"D382C3325F2F59","user_header":"https://static001.geekbang.org/account/avatar/00/16/1e/4e/56a0b904.jpg","comment_is_top":false,"comment_ctime":1552647525,"is_pvip":false,"replies":[{"id":"27949","content":"ä¸æ˜¯ï¼Œæœ‰åºæ€§å’ŒæŒ‡ä»¤é‡æ’æœ‰å…³ï¼Œå³ä¾¿æ²¡æœ‰æœ‰åºæ€§é—®é¢˜ï¼Œä¹Ÿæœ‰å¯èƒ½å­˜åœ¨ç«æ€æ¡ä»¶é—®é¢˜<br>","user_name":"ä½œè€…å›å¤","user_name_real":"ç‹å®ä»¤","uid":"1269969","ctime":1552653230,"ip_address":"","comment_id":76623,"utype":1}],"discussion_count":1,"race_medal":0,"score":"10142582117","product_id":100023901,"comment_content":"è€å¸ˆ æ‚¨å¥½<br>æˆ‘çœ‹Javaå¹¶å‘ç¼–ç¨‹å®è·µä¸­çš„ç«æ€æ¡ä»¶å’Œæœ‰åºæ€§çš„æè¿°å¾ˆåƒ è¯·é—®å…¶ä¸­ç«æ€æ¡ä»¶å°±æ˜¯æœ‰åºæ€§å—ï¼Ÿ","like_count":2,"discussions":[{"author":{"id":1269969,"avatar":"https://static001.geekbang.org/account/avatar/00/13/60/d1/8efa89ab.jpg","nickname":"ç‹å®ä»¤","note":"","ucode":"4FE19F5BC32FCA","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":443381,"discussion_content":"ä¸æ˜¯ï¼Œæœ‰åºæ€§å’ŒæŒ‡ä»¤é‡æ’æœ‰å…³ï¼Œå³ä¾¿æ²¡æœ‰æœ‰åºæ€§é—®é¢˜ï¼Œä¹Ÿæœ‰å¯èƒ½å­˜åœ¨ç«æ€æ¡ä»¶é—®é¢˜\n","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1552653230,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":73699,"user_name":"ç½—æ´²","can_delete":false,"product_type":"c1","uid":1263417,"ip_address":"","ucode":"68133E38A25C17","user_header":"https://static001.geekbang.org/account/avatar/00/13/47/39/0ce1aa62.jpg","comment_is_top":false,"comment_ctime":1551960692,"is_pvip":false,"replies":[{"id":"26905","content":"å¯¹äºåˆå­¦è€…ï¼Œä½ çš„è¿™ä¸ªè§£é‡Šè™½ç„¶æ­£ç¡®ï¼Œä½†æ˜¯ä¸å¥½ç†è§£ã€‚volatileåœ¨1.5ä»¥åä¸ä»…ä»…æ˜¯ç¦ç”¨ç¼“å­˜<br>","user_name":"ä½œè€…å›å¤","user_name_real":"ç‹å®ä»¤","uid":"1269969","ctime":1551962163,"ip_address":"","comment_id":73699,"utype":1}],"discussion_count":1,"race_medal":0,"score":"10141895284","product_id":100023901,"comment_content":"æ–‡ä¸­è¯´åˆ°volatile ä¸ºçš„æ˜¯ç¦ç”¨ç¼“å­˜ï¼Œè¿™é‡Œæˆ‘ä¸ªäººè§‰å¾—è¯´æ³•æ¬ å¦¥ï¼Œvolatile ä¸»è¦çš„ä½œç”¨åº”è¯¥æ˜¯å½“ä¿®é¥°çš„å˜é‡è¢«ä¿®æ”¹äº†ï¼Œä¼šç«‹å³åˆ·å›ä¸»ç¼“å­˜ï¼ŒåŒæ—¶å…¶ä»–cpuç¼“å­˜æ”¹å˜é‡ä¼šå¤±æ•ˆï¼Œéœ€è¦é‡æ–°ä»ä¸»ç¼“å­˜åˆ·æ–°å˜é‡çš„å€¼ã€‚æ‰€ä»¥ä»è¿™å±‚é¢ä¸Šè¯´volatile å…¶å®è¿˜æ˜¯æœ‰ç”¨ç¼“å­˜ï¼Œåªæ˜¯æ•ˆæœå’Œç¦ç”¨ç¼“å­˜ä¸€æ ·ã€‚ä¸ªäººç†è§£ã€‚","like_count":2,"discussions":[{"author":{"id":1269969,"avatar":"https://static001.geekbang.org/account/avatar/00/13/60/d1/8efa89ab.jpg","nickname":"ç‹å®ä»¤","note":"","ucode":"4FE19F5BC32FCA","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":442233,"discussion_content":"å¯¹äºåˆå­¦è€…ï¼Œä½ çš„è¿™ä¸ªè§£é‡Šè™½ç„¶æ­£ç¡®ï¼Œä½†æ˜¯ä¸å¥½ç†è§£ã€‚volatileåœ¨1.5ä»¥åä¸ä»…ä»…æ˜¯ç¦ç”¨ç¼“å­˜\n","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1551962163,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":73362,"user_name":"ä¹”å®‡ä½³","can_delete":false,"product_type":"c1","uid":1449240,"ip_address":"","ucode":"2EFFBDD4EC5907","user_header":"http://thirdwx.qlogo.cn/mmopen/vi_32/DYAIOgq83epUXpvIbKKeXWGL2l0CQo3Jwo6UUX0Jcia7I80Nd3RJs3aGiczXe81Ea534szRxLKhyAeZOiclzib8f2Q/132","comment_is_top":false,"comment_ctime":1551868386,"is_pvip":false,"replies":[{"id":"26726","content":"æ˜¯çš„ï¼Œæˆ‘ä¹Ÿè§‰å¾—å®é™…ä¸Šä¸ä¼šé‡æ’ã€‚è¿™ä¸ªä¾‹å­åªæ˜¯è¯´ç†è®ºä¸Šä¼šå‡ºé—®é¢˜ã€‚ä½ å›ç­”çš„æ¯”æˆ‘è¦å¥½ã€‚","user_name":"ä½œè€…å›å¤","user_name_real":"ç‹å®ä»¤","uid":"1269969","ctime":1551882285,"ip_address":"","comment_id":73362,"utype":1}],"discussion_count":1,"race_medal":0,"score":"10141802978","product_id":100023901,"comment_content":"å…³äºJunziçš„é—®é¢˜ï¼Œä½ åœ¨è‡ªå·±è¯´çš„æ—¶å€™å·²ç»å›ç­”äº†ï¼Œå› ä¸ºé‡æ’åä¼šå½±å“ç»“æœï¼Œå¦‚æœé‡æ’ä¹‹ååœ¨è¯»çš„æ—¶å€™å¯èƒ½ä¼šè¯»åˆ°0<br>å¦‚æœvä¹‹å‰æœ‰å¤šæ¡æŒ‡ä»¤ï¼Œé‚£ä¹ˆä¹‹å‰çš„é‚£å¤šæ¡æŒ‡ä»¤ä¼šé‡æ’å› ä¸ºé‚£ä¸ä¼šå½±å“ç»“æœï¼Œå¦‚æœåªæœ‰è¿™ä¸¤æ¡ï¼Œæ˜¯ä¸ä¼šé‡æ’çš„ã€‚<br><br>ç¬¬ä¸€æ¬¡å›ç•™è¨€ï¼Œè¯­è¨€ç»„ç»‡çš„ä¸å¤ªå¥½ï¼Œæœ›è€å¸ˆæŒ‡æ­£ï¼","like_count":2,"discussions":[{"author":{"id":1269969,"avatar":"https://static001.geekbang.org/account/avatar/00/13/60/d1/8efa89ab.jpg","nickname":"ç‹å®ä»¤","note":"","ucode":"4FE19F5BC32FCA","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":442042,"discussion_content":"æ˜¯çš„ï¼Œæˆ‘ä¹Ÿè§‰å¾—å®é™…ä¸Šä¸ä¼šé‡æ’ã€‚è¿™ä¸ªä¾‹å­åªæ˜¯è¯´ç†è®ºä¸Šä¼šå‡ºé—®é¢˜ã€‚ä½ å›ç­”çš„æ¯”æˆ‘è¦å¥½ã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1551882285,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":73038,"user_name":"1620","can_delete":false,"product_type":"c1","uid":1104310,"ip_address":"","ucode":"C9222A5CE4723C","user_header":"https://static001.geekbang.org/account/avatar/00/10/d9/b6/4c498c17.jpg","comment_is_top":false,"comment_ctime":1551782453,"is_pvip":false,"replies":[{"id":"26511","content":"æ—©çŸ¥é“æˆ‘å»å†™å°è¯´äº†","user_name":"ä½œè€…å›å¤","user_name_real":"ç‹å®ä»¤","uid":"1269969","ctime":1551797327,"ip_address":"","comment_id":73038,"utype":1}],"discussion_count":1,"race_medal":0,"score":"10141717045","product_id":100023901,"comment_content":"x=42 è¿™ä¸ªä¾‹å­éå¸¸å¥½ å¾ˆç‚«  æœ‰ä¸€ç§è¿½å°è¯´çš„æ„Ÿè§‰äº† ğŸ˜„","like_count":2,"discussions":[{"author":{"id":1269969,"avatar":"https://static001.geekbang.org/account/avatar/00/13/60/d1/8efa89ab.jpg","nickname":"ç‹å®ä»¤","note":"","ucode":"4FE19F5BC32FCA","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":441885,"discussion_content":"æ—©çŸ¥é“æˆ‘å»å†™å°è¯´äº†","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1551797327,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":72949,"user_name":"èƒ¡æ¡¥","can_delete":false,"product_type":"c1","uid":1055874,"ip_address":"","ucode":"673C3207614010","user_header":"https://static001.geekbang.org/account/avatar/00/10/1c/82/74ab79df.jpg","comment_is_top":false,"comment_ctime":1551758493,"is_pvip":false,"replies":[{"id":"26494","content":"å¹¶å‘é—®é¢˜ï¼Œéƒ½æ˜¯æ¦‚ç‡æ€§çš„é—®é¢˜ã€‚çº¿ç¨‹ä¸å®‰å…¨ï¼Œä¹Ÿä¸æ˜¯è¯´æ¯æ¬¡éƒ½èƒ½é‡ç°ã€‚å°¤å…¶æ˜¯è¿™ç§é‡æ’çš„ã€‚æˆ‘ä¹Ÿæ²¡èƒ½é‡ç°å‡ºæ¥ã€‚","user_name":"ä½œè€…å›å¤","user_name_real":"ç‹å®ä»¤","uid":"1269969","ctime":1551795431,"ip_address":"","comment_id":72949,"utype":1}],"discussion_count":1,"race_medal":0,"score":"10141693085","product_id":100023901,"comment_content":"æœŸå¾…è§£ç­”~<br>å¯¹volatileæœ‰ä¸ªç–‘æƒ‘ï¼šæˆ‘å¯¹æ‚¨å…³äºvolatileçš„ä»£ç è¿›è¡Œäº†ä¿®æ”¹ï¼Œå»æ‰äº†volatileï¼š<br>public class VolatileExample {<br>\tprivate int x;<br>\tprivate boolean changed = false; <br>\tpublic void set(int x){<br>\t\tthis.x = x;<br>\t\tthis.changed = true;<br>\t}<br>\tpublic int get(){<br>\t\treturn x;<br>\t}<br>\tpublic boolean changed(){<br>\t\treturn changed;<br>\t}<br>}<br>ç„¶åæˆ‘ç”¨ä¸€ä¸ªçº¿ç¨‹Aæ¥å†™ï¼Œå¦å¤–ä¸€ä¸ªçº¿ç¨‹Bå»è¯»ï¼Œçº¿ç¨‹Bä¸­å¦‚æœå‘ç°æ²¡æœ‰æ²¡æœ‰changeå°±sleepä¸€ç§’ã€‚æˆ‘å‘ç°å³ä½¿ä¸ç”¨volatileï¼Œä¸¤ä¸ªçº¿ç¨‹ä¹Ÿèƒ½(é€šè¿‡whileç­‰å¾…)åè°ƒå¾—å¾ˆå¥½ã€‚ä¸ºä»€ä¹ˆï¼Ÿ<br>è¿™æ˜¯æˆ‘çš„æµ‹è¯•ä»£ç ï¼š<br>public class TestVolatileExample {<br><br>\tstatic int pairCount = 1000;<br>\tstatic VolatileExample[] exps = new VolatileExample[pairCount];<br>\tstatic{<br>\t\tfor(int i = 0;i&lt;pairCount;i++){<br>\t\t\texps[i] = new VolatileExample();<br>\t\t}<br>\t}<br>\t<br>\t@Test<br>\tpublic void test() throws InterruptedException{<br>\t\tfinal int valuePair[][] = new int[pairCount][2];<br>\t\tThread[] threads = new Thread[pairCount*2];<br>\t\tfor(int i = 0;i&lt;pairCount;i++){<br>\t\t\tfinal int index = i;<br>\t\t\t&#47;&#47;final VolatileExample exp = new VolatileExample();<br>\t\t\t&#47;&#47;writer<br>\t\t\tThread writer = new Thread(new Runnable(){<br>\t\t\t\t@Override<br>\t\t\t\tpublic void run() {<br>\t\t\t\t\tVolatileExample exp = exps[index];<br>\t\t\t\t\tint val = new Random().nextInt(100);<br>\t\t\t\t\tvaluePair[index][0] = val;<br>\t\t\t\t\texp.set(val);<br>\t\t\t\t}<br>\t\t\t});<br>\t\t\twriter.start();<br>\t\t\tthreads[i*2] = writer;<br>\t\t\t&#47;&#47;reader<br>\t\t\tThread reader = new Thread(new Runnable(){<br>\t\t\t\t@Override<br>\t\t\t\tpublic void run() {<br>\t\t\t\t\tVolatileExample exp = exps[index];<br>\t\t\t\t\twhile(!exp.changed()){<br>\t\t\t\t\t\ttry {<br>\t\t\t\t\t\t\tThread.sleep(1);<br>\t\t\t\t\t\t} catch (InterruptedException e) {<br>\t\t\t\t\t\t\te.printStackTrace();<br>\t\t\t\t\t\t}<br>\t\t\t\t\t}<br>\t\t\t\t\tint val = exp.get();<br>\t\t\t\t\tvaluePair[index][1] = val;<br>\t\t\t\t}<br>\t\t\t\t<br>\t\t\t});<br>\t\t\treader.start();<br>\t\t\tthreads[i*2+1] = reader;<br>\t\t}<br>\t\tfor(Thread t : threads){<br>\t\t\tt.join();<br>\t\t}<br>\t\tfor(int i = 0;i&lt;pairCount;i++){<br>\t\t\tint write = valuePair[i][0];<br>\t\t\tint read =  valuePair[i][1];<br>\t\t\tSystem.out.println(write+&quot;,&quot; + read);<br>\t\t\tAssert.assertEquals(write,read);<br>\t\t}<br>\t}<br>}<br>","like_count":2,"discussions":[{"author":{"id":1269969,"avatar":"https://static001.geekbang.org/account/avatar/00/13/60/d1/8efa89ab.jpg","nickname":"ç‹å®ä»¤","note":"","ucode":"4FE19F5BC32FCA","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":441841,"discussion_content":"å¹¶å‘é—®é¢˜ï¼Œéƒ½æ˜¯æ¦‚ç‡æ€§çš„é—®é¢˜ã€‚çº¿ç¨‹ä¸å®‰å…¨ï¼Œä¹Ÿä¸æ˜¯è¯´æ¯æ¬¡éƒ½èƒ½é‡ç°ã€‚å°¤å…¶æ˜¯è¿™ç§é‡æ’çš„ã€‚æˆ‘ä¹Ÿæ²¡èƒ½é‡ç°å‡ºæ¥ã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1551795431,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":72180,"user_name":"Alpha","can_delete":false,"product_type":"c1","uid":1001861,"ip_address":"","ucode":"60CA15A25EC796","user_header":"https://static001.geekbang.org/account/avatar/00/0f/49/85/3f161d95.jpg","comment_is_top":false,"comment_ctime":1551531751,"is_pvip":false,"replies":[{"id":"26159","content":"ç¼–è¯‘å™¨å¯ä»¥è°ƒæ•´é¡ºåºï¼Œä½†æ˜¯è¦æ»¡è¶³æ‰€æœ‰çš„happens beforeè§„åˆ™ï¼Œå¦‚æœå†²çªäº†ï¼Œå°±æ˜¯ç¼–è¯‘å™¨ä¼˜åŒ–é”™äº†ã€‚<br>","user_name":"ä½œè€…å›å¤","user_name_real":"ç‹å®ä»¤","uid":"1269969","ctime":1551545291,"ip_address":"","comment_id":72180,"utype":1}],"discussion_count":1,"race_medal":0,"score":"10141466343","product_id":100023901,"comment_content":"è€å¸ˆï¼Œç¬¬ä¸€æ¡ç¨‹åºçš„é¡ºåºæ€§è§„åˆ™ ä¸ ä¹±åºæ‰§è¡Œæ˜¯ä»€ä¹ˆå…³ç³»å‘¢ï¼Ÿ<br>æ¯”å¦‚ä¾‹å­ä¸­ç¬¬6è¡Œ `x = 42` happens-before ç¬¬7è¡Œ `v = true`ï¼Œä½†æ˜¯ç¼–è¯‘å™¨æœ‰å¯èƒ½è°ƒæ•´è¿™ä¸¤è¡Œè¯­å¥çš„æ‰§è¡Œé¡ºåºçš„å‘€ï¼Œè¿™çœ‹èµ·æ¥æ˜¯å’Œè¿™æ¡happens-beforeè§„åˆ™å†²çªå‘¢ï¼Ÿå¸Œæœ›è€å¸ˆèƒ½è§£ç­”æˆ‘çš„ç–‘æƒ‘ã€‚<br>","like_count":2,"discussions":[{"author":{"id":1269969,"avatar":"https://static001.geekbang.org/account/avatar/00/13/60/d1/8efa89ab.jpg","nickname":"ç‹å®ä»¤","note":"","ucode":"4FE19F5BC32FCA","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":441490,"discussion_content":"ç¼–è¯‘å™¨å¯ä»¥è°ƒæ•´é¡ºåºï¼Œä½†æ˜¯è¦æ»¡è¶³æ‰€æœ‰çš„happens beforeè§„åˆ™ï¼Œå¦‚æœå†²çªäº†ï¼Œå°±æ˜¯ç¼–è¯‘å™¨ä¼˜åŒ–é”™äº†ã€‚\n","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1551545291,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":72060,"user_name":"Tony Du","can_delete":false,"product_type":"c1","uid":1001661,"ip_address":"","ucode":"F5FCC400E615EA","user_header":"https://static001.geekbang.org/account/avatar/00/0f/48/bd/6c7d4230.jpg","comment_is_top":false,"comment_ctime":1551509471,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"10141444063","product_id":100023901,"comment_content":"è¿™ç¯‡è®©æˆ‘å¯¹volatileçš„ç†è§£èŒ…å¡é¡¿å¼€ï¼Œæ„Ÿè°¢ï¼","like_count":2},{"had_liked":false,"id":71976,"user_name":"tracer","can_delete":false,"product_type":"c1","uid":1124766,"ip_address":"","ucode":"AE2BC047DB7D7D","user_header":"https://static001.geekbang.org/account/avatar/00/11/29/9e/380a01ea.jpg","comment_is_top":false,"comment_ctime":1551493857,"is_pvip":false,"replies":[{"id":"26094","content":"ä»£ç å—ä¸­æœ‰volatileï¼Œä¹ŸæŒ¡ä¸ä½è¢«é‡æ’ã€‚ä½†æ˜¯é‡æ’åçš„ç»“æœä¸€å®šç¬¦åˆhappens-beforeè§„åˆ™ã€‚<br>bå…ˆè¯»vå¯ä»¥å•Šï¼Œåªæ˜¯è¿™ä¸ªæ—¶å€™v==false","user_name":"ä½œè€…å›å¤","user_name_real":"ç‹å®ä»¤","uid":"1269969","ctime":1551521667,"ip_address":"","comment_id":71976,"utype":1}],"discussion_count":1,"race_medal":1,"score":"10141428449","product_id":100023901,"comment_content":"æä¸€ä¸ªå¯èƒ½æ¯”è¾ƒå¹¼ç¨šçš„é—®é¢˜ï¼Œå‚è€ƒ1ä¸­çš„ä»£ç ï¼Œvolatileèƒ½ä¿è¯ä¸è¢«é‡æ’åºï¼Œä½†æ˜¯volatileåªä¿®é¥°äº†vï¼Œæ„æ€æ˜¯ä»£ç å—ä¸­åªè¦æœ‰ä¸€ä¸ªvolatileï¼Œä»£ç å—ä¸­éƒ½ä¸ä¼šè¢«é‡æ’åºï¼Ÿ<br>volatileå˜é‡è§„åˆ™è¯´å†™æ“ä½œå¯¹è¯»æ“ä½œå¯è§ï¼Œvæ˜¯æœ‰åˆå§‹å€¼çš„ï¼Œçº¿ç¨‹bå…ˆè¯»vä¸å¯ä»¥å—ï¼Ÿé‚£å¦‚æœçº¿ç¨‹aä¸­å¤šæ¬¡ä¿®æ”¹äº†vçš„å€¼å‘¢ï¼Ÿ","like_count":2,"discussions":[{"author":{"id":1269969,"avatar":"https://static001.geekbang.org/account/avatar/00/13/60/d1/8efa89ab.jpg","nickname":"ç‹å®ä»¤","note":"","ucode":"4FE19F5BC32FCA","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":441415,"discussion_content":"ä»£ç å—ä¸­æœ‰volatileï¼Œä¹ŸæŒ¡ä¸ä½è¢«é‡æ’ã€‚ä½†æ˜¯é‡æ’åçš„ç»“æœä¸€å®šç¬¦åˆhappens-beforeè§„åˆ™ã€‚\nbå…ˆè¯»vå¯ä»¥å•Šï¼Œåªæ˜¯è¿™ä¸ªæ—¶å€™v==false","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1551521667,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":71946,"user_name":"Jialin","can_delete":false,"product_type":"c1","uid":1112955,"ip_address":"","ucode":"12583269732A75","user_header":"https://static001.geekbang.org/account/avatar/00/10/fb/7b/2d4b38fb.jpg","comment_is_top":false,"comment_ctime":1551491230,"is_pvip":false,"replies":[{"id":"26090","content":"æ˜¯è¿™æ ·!","user_name":"ä½œè€…å›å¤","user_name_real":"ç‹å®ä»¤","uid":"1269969","ctime":1551520528,"ip_address":"","comment_id":71946,"utype":1}],"discussion_count":1,"race_medal":0,"score":"10141425822","product_id":100023901,"comment_content":"æˆ‘ä¸»è¦ä»å…±äº«å˜é‡çš„çŠ¶æ€(æ˜¯å¦å¯ä»¥è¢«ä¿®æ”¹)è¿›è¡Œæ€è€ƒå®ƒåœ¨å¤šçº¿ç¨‹ç¯å¢ƒä¸‹çš„å¯è§æ€§é—®é¢˜ï¼Œå¦‚æœä¸€ä¸ªå˜é‡ä»…ä»…åªæ˜¯å¯è¯»ï¼Œé‚£ä¹ˆå®ƒæœ¬èº«ä¸ä¼šå­˜åœ¨çº¿ç¨‹ä¸å®‰å…¨é—®é¢˜ï¼Œä½¿ç”¨finalè¿›è¡Œä¿®é¥°ï¼›å¦‚æœä¸€ä¸ªå…±äº«å˜é‡å¯è¯»å¯å†™ï¼Œé‚£ä¹ˆå°±ä½¿ç”¨synchronizedå’Œvolatileæ¥ä¿è¯å®ƒåœ¨å¤šçº¿ç¨‹ç¯å¢ƒä¸‹çš„å¯è§æ€§ã€‚","like_count":2,"discussions":[{"author":{"id":1269969,"avatar":"https://static001.geekbang.org/account/avatar/00/13/60/d1/8efa89ab.jpg","nickname":"ç‹å®ä»¤","note":"","ucode":"4FE19F5BC32FCA","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":441408,"discussion_content":"æ˜¯è¿™æ ·!","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1551520528,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":71932,"user_name":"æ‹¨äº‘è§å¤©","can_delete":false,"product_type":"c1","uid":1388409,"ip_address":"","ucode":"125FEE7AC7C2FF","user_header":"https://static001.geekbang.org/account/avatar/00/15/2f/79/61794fe2.jpg","comment_is_top":false,"comment_ctime":1551489441,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"10141424033","product_id":100023901,"comment_content":"@ä½•æ–¹å¦–å­½<br>ä½ æçš„è¿™ä¸ªé—®é¢˜æ˜¯java8çš„æ–°ç‰¹æ€§ä¹‹lambdaè¡¨è¾¾å¼ï¼Œå¯ä»¥å­¦ä¹ ä¸‹è¿™ä¸ªæ–°ç‰¹æ€§ï¼Œç®€åŒ–ä»£ç å¿…å¤‡è‰¯è¯å“¦ï¼","like_count":2},{"had_liked":false,"id":71924,"user_name":"LW","can_delete":false,"product_type":"c1","uid":1325297,"ip_address":"","ucode":"89820332658E98","user_header":"https://static001.geekbang.org/account/avatar/00/14/38/f1/996a070d.jpg","comment_is_top":false,"comment_ctime":1551487012,"is_pvip":false,"replies":[{"id":"26086","content":"çœ‹ä½ è¿™ä¹ˆè¯´ï¼Œæˆ‘å¿ƒæƒ…å¤§å¥½ã€‚","user_name":"ä½œè€…å›å¤","user_name_real":"ç‹å®ä»¤","uid":"1269969","ctime":1551519957,"ip_address":"","comment_id":71924,"utype":1}],"discussion_count":1,"race_medal":0,"score":"10141421604","product_id":100023901,"comment_content":"ä¼ é€’æ€§è§„åˆ™æ˜¯è®²è§£è®©æˆ‘èŒ…å¡é¡¿å¼€","like_count":2,"discussions":[{"author":{"id":1269969,"avatar":"https://static001.geekbang.org/account/avatar/00/13/60/d1/8efa89ab.jpg","nickname":"ç‹å®ä»¤","note":"","ucode":"4FE19F5BC32FCA","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":441397,"discussion_content":"çœ‹ä½ è¿™ä¹ˆè¯´ï¼Œæˆ‘å¿ƒæƒ…å¤§å¥½ã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1551519957,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":277406,"user_name":"silence","can_delete":false,"product_type":"c1","uid":1326790,"ip_address":"","ucode":"407F847726B5E7","user_header":"https://static001.geekbang.org/account/avatar/00/14/3e/c6/e19b1008.jpg","comment_is_top":false,"comment_ctime":1612406902,"is_pvip":false,"replies":[{"id":"100815","content":"é—®é¢˜ä¸æ˜¯å‡ºåœ¨å¯è§æ€§ï¼Œè€Œæ˜¯å‡ºåœ¨åŸå­æ€§ä¸Šã€‚volatileä¸èƒ½ä¿è¯writer()å’Œreader()æ–¹æ³•çš„åŸå­æ€§ã€‚ä¾‹å¦‚å†™çº¿ç¨‹å†™å®Œx=iä¹‹åï¼Œç¡äº†1ä¸‡å¹´ï¼›åœ¨è¿™1ä¸‡å¹´ä¹‹å†…ï¼Œè¯»çº¿ç¨‹è¯»åˆ°çš„vä¸€å®šä¸ç­‰äºxã€‚åŒæ—¶reader() ä¹Ÿæ²¡æœ‰åŸå­æ€§ï¼Œè¯»çº¿ç¨‹è¯»å®Œvä¹‹åï¼Œä¹Ÿå¯èƒ½ç¡äº†10ä¸‡å¹´ï¼Œæ­¤æ—¶vä¹Ÿä¸€å®šä¸ç­‰äºxã€‚è¿™é‡Œçš„ç¡ï¼Œå°±æ˜¯çº¿ç¨‹ä¸Šä¸‹æ–‡åˆ‡æ¢çš„æ—¶é—´ï¼Œè¿™ä¸ªæ—¶é—´çš„é•¿çŸ­æ˜¯ä¸ä¸€å®šçš„ã€‚<br><br>ä½ è¦æƒ³éªŒè¯å¯è§æ€§ï¼Œå¯ä»¥æŠŠreader()ä»£ç æ”¹æˆä¸‹é¢è¿™æ ·ï¼š<br>    public void reader() {<br>        int vv = v;<br>        int xx = x;<br>        &#47;&#47; volatileèƒ½ä¿è¯ vv&lt;=xx<br>        if (vv &gt; xx) {<br>            System.out.println(&quot;x: &quot; + xx + &quot; v: &quot; + vv);<br>        }<br>    }","user_name":"ä½œè€…å›å¤","user_name_real":"ç‹å®ä»¤","uid":"1269969","ctime":1612599120,"ip_address":"","comment_id":277406,"utype":1}],"discussion_count":1,"race_medal":0,"score":"5907374198","product_id":100023901,"comment_content":"ä½œè€…ä½ å¥½ï¼Œè¯•çœ‹äº†ä¸¤èŠ‚ï¼Œå®é™…è¿è¡Œä»£ç ä¸æ–‡ä¸­æè¿°ä¸ç¬¦ï¼Œå…·ä½“ä»£ç å¦‚ä¸‹ï¼š<br>public class Main {<br>    int x = 0;<br>    volatile int v = 0;<br><br>    public static void main(String[] args) {<br>        Main m = new Main();<br>        new Thread(() -&gt; {<br>            int i = 0;<br>            while (true){<br>                m.writer(i);<br>                i++;<br>            }<br>        }).start();<br>        new Thread(() -&gt; {<br>            while (true) {<br>                m.reader();<br>            }<br>        }).start();<br>    }<br><br>    public void writer(int i) {<br>        x = i;<br>        v = i;<br>    }<br><br>    public void reader() {<br>        if (v != x) {<br>            System.out.println(&quot;x: &quot; + x + &quot; v: &quot; + v);<br>        }<br>    }<br>}<br>ä»¥ä¸Šä»£ç è¿˜æ˜¯ä¼šè¾“å‡ºxä¸vä¸ç›¸ç­‰ï¼Œè¿™ä¸æ–‡ä¸­æåˆ°çš„å‰ä¸‰æ¡happen-beforeåŸåˆ™ä¸ç¬¦åˆï¼Œè¯·è€å¸ˆç™¾å¿™ä¹‹ä½™è§£ç­”","like_count":1,"discussions":[{"author":{"id":1269969,"avatar":"https://static001.geekbang.org/account/avatar/00/13/60/d1/8efa89ab.jpg","nickname":"ç‹å®ä»¤","note":"","ucode":"4FE19F5BC32FCA","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":515040,"discussion_content":"é—®é¢˜ä¸æ˜¯å‡ºåœ¨å¯è§æ€§ï¼Œè€Œæ˜¯å‡ºåœ¨åŸå­æ€§ä¸Šã€‚volatileä¸èƒ½ä¿è¯writer()å’Œreader()æ–¹æ³•çš„åŸå­æ€§ã€‚ä¾‹å¦‚å†™çº¿ç¨‹å†™å®Œx=iä¹‹åï¼Œç¡äº†1ä¸‡å¹´ï¼›åœ¨è¿™1ä¸‡å¹´ä¹‹å†…ï¼Œè¯»çº¿ç¨‹è¯»åˆ°çš„vä¸€å®šä¸ç­‰äºxã€‚åŒæ—¶reader() ä¹Ÿæ²¡æœ‰åŸå­æ€§ï¼Œè¯»çº¿ç¨‹è¯»å®Œvä¹‹åï¼Œä¹Ÿå¯èƒ½ç¡äº†10ä¸‡å¹´ï¼Œæ­¤æ—¶vä¹Ÿä¸€å®šä¸ç­‰äºxã€‚è¿™é‡Œçš„ç¡ï¼Œå°±æ˜¯çº¿ç¨‹ä¸Šä¸‹æ–‡åˆ‡æ¢çš„æ—¶é—´ï¼Œè¿™ä¸ªæ—¶é—´çš„é•¿çŸ­æ˜¯ä¸ä¸€å®šçš„ã€‚\n\nä½ è¦æƒ³éªŒè¯å¯è§æ€§ï¼Œå¯ä»¥æŠŠreader()ä»£ç æ”¹æˆä¸‹é¢è¿™æ ·ï¼š\n    public void reader() {\n        int vv = v;\n        int xx = x;\n        // volatileèƒ½ä¿è¯ vv&amp;lt;=xx\n        if (vv &amp;gt; xx) {\n            System.out.println(&amp;quot;x: &amp;quot; + xx + &amp;quot; v: &amp;quot; + vv);\n        }\n    }","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1612599120,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":169974,"user_name":"åœ¨è·¯ä¸Š","can_delete":false,"product_type":"c1","uid":1641319,"ip_address":"","ucode":"E1184E76B14431","user_header":"https://static001.geekbang.org/account/avatar/00/19/0b/67/dc49a1a8.jpg","comment_is_top":false,"comment_ctime":1578486260,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"5873453556","product_id":100023901,"comment_content":"æˆ‘å°è¯•è§£é‡Šä¸€ä¸‹Junziçš„é—®é¢˜<br>é¦–å…ˆvolatileå®ƒå¯ä»¥ä¿è¯å¯è§æ€§å’Œé¡ºåºæ€§ï¼Œè€Œä½ è¿™é‡Œçš„é—®é¢˜å°±æ˜¯volatileä¿è¯çš„é¡ºåºæ€§é—®é¢˜ã€‚<br>volatileå¯ä»¥ä¿è¯çš„é¡ºåºæ€§æ˜¯æŒ‡ï¼šå¯¹volatileä¿®çš„æ˜¯å˜é‡è¿›è¡Œçš„ä¿®æ”¹æ“ä½œçš„è¯­å¥ï¼Œä¸€å®šåœ¨è¿™ä¸ªè¯­å¥å‰é¢çš„è¯­å¥æ‰§è¡Œåå‘ç”Ÿã€‚æ‰€ä»¥x=45;ä¸€å®šå‘ç”Ÿäºv=true;ä¹‹å‰ã€‚è€Œä¸”è¿™é‡Œåªæœ‰x=45;å’Œv=true;ï¼Œæ‰€ä»¥è¿™ä¸¤æ¡è¯­å¥ä¸å­˜åœ¨é‡æ’é—®é¢˜ã€‚<br>ä¸çŸ¥è§£é‡Šçš„æ˜¯å¦æ­£ç¡®ï¼Œè¯·è€å¸ˆçœ‹çœ‹ã€‚","like_count":1},{"had_liked":false,"id":163097,"user_name":"Eleven","can_delete":false,"product_type":"c1","uid":1168452,"ip_address":"","ucode":"FB4A0C8CA732BE","user_header":"https://static001.geekbang.org/account/avatar/00/11/d4/44/0ec958f4.jpg","comment_is_top":false,"comment_ctime":1576656225,"is_pvip":false,"replies":[{"id":"62025","content":"i++&lt;10000ä¸æ˜¯åŸå­æ“ä½œï¼Œä¸æ˜¯è¯´è§£å†³äº†å¯è§æ€§å°±æ²¡æœ‰å¹¶å‘é—®é¢˜äº†","user_name":"ä½œè€…å›å¤","user_name_real":"ç‹å®ä»¤","uid":"1269969","ctime":1576677267,"ip_address":"","comment_id":163097,"utype":1}],"discussion_count":2,"race_medal":0,"score":"5871623521","product_id":100023901,"comment_content":"è€å¸ˆï¼Œæˆ‘æœ‰ä¸ªç–‘é—®ï¼Œéº»çƒ¦å¸®æˆ‘è§£ç­”ä¸‹ï¼Œæˆ‘å…ˆæ‘†ä»¥ä¸‹ä»£ç :<br>&#47;**<br> * è®¡ç®—å™¨<br> * @author eleven<br> * @see<br> * @since<br> *&#47;<br><br>public class Calculator {<br><br>    private volatile long count = 0;<br><br>    public long getCount() {<br>        return count;<br>    }<br><br>    public void add10K() {<br>        int idx = 0;<br>        while(idx++ &lt; 100000) {<br>            count += 1;<br>        }<br>    }<br>}<br><br>&#47;**<br> * è®¡ç®—å™¨çº¿ç¨‹<br> * @author eleven<br> * @see<br> * @since<br> *&#47;<br><br>public class CalculatorThread extends Thread {<br><br>    private Calculator calculator;<br><br>    public CalculatorThread(Calculator calculator) {<br>        this.calculator = calculator;<br>    }<br><br>    @Override<br>    public void run() {<br>        calculator.add10K();<br>    }<br>}<br><br>&#47;**<br> * å¯è§æ€§æµ‹è¯•<br> * @author eleven<br> * @see<br> * @since<br> *&#47;<br>public class Test {<br><br>    public static void main(String[] args) {<br>        Calculator calculator = new Calculator();<br>        &#47;&#47; åˆ›å»ºä¸¤ä¸ªçº¿ç¨‹ï¼Œæ‰§è¡Œadd()æ“ä½œ<br>        Thread t1 = new CalculatorThread(calculator);<br>        Thread t2 = new CalculatorThread(calculator);<br>        &#47;&#47; å¯åŠ¨ä¸¤ä¸ªçº¿ç¨‹<br>        t1.start();<br>        t2.start();<br>        &#47;&#47; ç­‰å¾…ä¸¤ä¸ªçº¿ç¨‹æ‰§è¡Œç»“æŸ<br>        try {<br>            t1.join();<br>            t2.join();<br>        } catch (InterruptedException e) {<br>            e.printStackTrace();<br>        }<br>        System.out.println(&quot;count:&quot; + calculator.getCount());<br>    }<br>}<br><br>è¿™æ˜¯æ‚¨ç¬¬ä¸€ç¯‡æ–‡ç« ä¸­å¯è§æ€§ä¾‹å­çš„æ”¹é€ ç‰ˆï¼Œæˆ‘åœ¨Calculatorç±»çš„æˆå‘˜å˜é‡countå‰é¢åŠ äº†volatileå…³é”®å­—ï¼ŒæŒ‰é“ç†æ¥è¯´ä¸ç®¡åœ¨å¤šæ ¸CPUè¿˜æ˜¯å•æ ¸CPUä¸Šè¿è¡Œè¿™æ®µä»£ç ï¼Œç­”æ¡ˆåº”è¯¥éƒ½æ˜¯20000å•Šï¼Œå¯æ˜¯æœ€åçš„æµ‹è¯•ç»“æœå¹¶ä¸æ˜¯è¿™æ ·ï¼Œéº»çƒ¦è€å¸ˆæŒ‡æ•™ä¸‹ï¼Œé—®é¢˜åœ¨å“ªé‡Œï¼Ÿ","like_count":1,"discussions":[{"author":{"id":1269969,"avatar":"https://static001.geekbang.org/account/avatar/00/13/60/d1/8efa89ab.jpg","nickname":"ç‹å®ä»¤","note":"","ucode":"4FE19F5BC32FCA","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":478246,"discussion_content":"i++&amp;lt;10000ä¸æ˜¯åŸå­æ“ä½œï¼Œä¸æ˜¯è¯´è§£å†³äº†å¯è§æ€§å°±æ²¡æœ‰å¹¶å‘é—®é¢˜äº†","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1576677267,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1168452,"avatar":"https://static001.geekbang.org/account/avatar/00/11/d4/44/0ec958f4.jpg","nickname":"Eleven","note":"","ucode":"FB4A0C8CA732BE","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":88466,"discussion_content":"é‚£åˆšå¥½å°±å†è¯·æ•™ä¸‹ï¼Œæ‚¨åœ¨åŸå­æ€§é‚£æ ç”»äº†ä¸ªéåŸå­æ“ä½œç¤ºæ„å›¾ï¼Œä¸€ç›´ä¸æ˜¯å¾ˆç†è§£ã€‚åŸå­æ“ä½œåº”è¯¥æ˜¯å’‹æ ·çš„ï¼Œæˆ–è€…å€Ÿè¿™ä¸ªæ¡ˆä¾‹å¸®æˆ‘è§£ç­”ä¸‹ç–‘æƒ‘","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1576715826,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":107536,"user_name":"å°æ–‡åŒå­¦","can_delete":false,"product_type":"c1","uid":1001893,"ip_address":"","ucode":"48F2AEB989C12A","user_header":"https://static001.geekbang.org/account/avatar/00/0f/49/a5/e4c1c2d4.jpg","comment_is_top":false,"comment_ctime":1561553554,"is_pvip":false,"replies":[{"id":"38924","content":"ğŸ‘","user_name":"ä½œè€…å›å¤","user_name_real":"ç‹å®ä»¤","uid":"1269969","ctime":1561595275,"ip_address":"","comment_id":107536,"utype":1}],"discussion_count":1,"race_medal":0,"score":"5856520850","product_id":100023901,"comment_content":"å­¦ä¹ å¹¶å‘æœ€å¥½çš„åŠæ³•æ˜¯ä¸æ–­æå‡ºåˆé€‚çš„é—®é¢˜ã€‚è€å¸ˆåœ¨ä¸Šä¸€èŠ‚æå‡ºäº†å¥½é—®é¢˜ã€‚å­¦å¾—éå¸¸æœ‰ç›®çš„æ€§ï¼","like_count":1,"discussions":[{"author":{"id":1269969,"avatar":"https://static001.geekbang.org/account/avatar/00/13/60/d1/8efa89ab.jpg","nickname":"ç‹å®ä»¤","note":"","ucode":"4FE19F5BC32FCA","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":455551,"discussion_content":"ğŸ‘","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1561595275,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":107161,"user_name":"æ¨é¹ç¨‹baci","can_delete":false,"product_type":"c1","uid":1205949,"ip_address":"","ucode":"3D22F6B74340A8","user_header":"https://static001.geekbang.org/account/avatar/00/12/66/bd/bd5d503e.jpg","comment_is_top":false,"comment_ctime":1561471054,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"5856438350","product_id":100023901,"comment_content":"è€å¸ˆè®²å¾—å¾ˆå¥½ï¼Œæˆ‘æƒ³é—®ä¸€ä¸ªé—®é¢˜ï¼Œè·å–å•ä¾‹å¯¹è±¡çš„åŒæ£€æµ‹æ–¹æ³•ï¼Œæ˜¯ä¸æ˜¯éœ€è¦å¯¹instanceåŠ ä¸€ä¸ªvolatileå…³é”®å­—å°±æ²¡é—®é¢˜äº†ï¼Ÿ","like_count":1},{"had_liked":false,"id":82051,"user_name":"ä½‘å„¿","can_delete":false,"product_type":"c1","uid":1226196,"ip_address":"","ucode":"0629888E7A5E16","user_header":"https://static001.geekbang.org/account/avatar/00/12/b5/d4/3bd5b77b.jpg","comment_is_top":false,"comment_ctime":1554110243,"is_pvip":false,"replies":[{"id":"29693","content":"å·¥ä½œå†…å­˜ä¸æ˜¯ç‰©ç†å­˜åœ¨çš„ï¼Œåˆ«æŠŠå®ƒå½“å›äº‹<br>","user_name":"ä½œè€…å›å¤","user_name_real":"ç‹å®ä»¤","uid":"1269969","ctime":1554126805,"ip_address":"","comment_id":82051,"utype":1}],"discussion_count":1,"race_medal":0,"score":"5849077539","product_id":100023901,"comment_content":"è€å¸ˆï¼Œä½ å¥½ï¼Œé‡è¯»æœ¬ç« æœ‰ä¸€ä¸ªç–‘é—®ï¼Œçœ‹è¿‡ä¸€ç¯‡jmmçš„æ–‡ç« ï¼Œå†™åˆ°jmmå®šä¹‰äº†çº¿ç¨‹å’Œä¸»å†…å­˜ä¹‹é—´çš„æŠ½è±¡å…³ç³»ï¼Œå…·ä½“å¦‚ä¸‹ï¼šå…±äº«å˜é‡å­˜å‚¨äºä¸»å†…å­˜ä¸­ï¼Œçº¿ç¨‹å…±äº«ï¼›æ¯ä¸ªçº¿ç¨‹éƒ½æœ‰ç§æœ‰çš„å·¥ä½œå†…å­˜ï¼›å·¥ä½œå†…å­˜åªå­˜å‚¨è¯¥çº¿ç¨‹å¯¹å…±äº«å˜é‡çš„å‰¯æœ¬ï¼Œçº¿ç¨‹ä¸èƒ½ç›´æ¥æ“ä½œä¸»å†…å­˜ï¼Œæˆ‘çš„ç–‘é—®æ˜¯æ—¢ç„¶æ¯ä¸ªçº¿ç¨‹éƒ½æœ‰ç§æœ‰çš„æœ¬åœ°å†…å­˜ï¼Œé‚£ä¸ºä»€ä¹ˆå‰é¢ä¸€ç« æè¿°å•æ ¸cpuä¸å­˜åœ¨å¯è§æ€§é—®é¢˜å‘¢ï¼Ÿ ","like_count":1,"discussions":[{"author":{"id":1269969,"avatar":"https://static001.geekbang.org/account/avatar/00/13/60/d1/8efa89ab.jpg","nickname":"ç‹å®ä»¤","note":"","ucode":"4FE19F5BC32FCA","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":445447,"discussion_content":"å·¥ä½œå†…å­˜ä¸æ˜¯ç‰©ç†å­˜åœ¨çš„ï¼Œåˆ«æŠŠå®ƒå½“å›äº‹\n","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1554126805,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":79932,"user_name":"wâ€†w","can_delete":false,"product_type":"c1","uid":1100651,"ip_address":"","ucode":"5EA3550C18F28F","user_header":"https://static001.geekbang.org/account/avatar/00/10/cb/6b/acaa5d89.jpg","comment_is_top":false,"comment_ctime":1553576332,"is_pvip":false,"replies":[{"id":"29234","content":"è¯´æ˜æµ‹è¯•æ°´å¹³ä¹Ÿä¸ä½ğŸ˜„<br>","user_name":"ä½œè€…å›å¤","user_name_real":"ç‹å®ä»¤","uid":"1269969","ctime":1553647204,"ip_address":"","comment_id":79932,"utype":1}],"discussion_count":1,"race_medal":0,"score":"5848543628","product_id":100023901,"comment_content":"è¿™ä¸ªè¯¾ç¨‹å¾ˆå¥½ï¼ŒæŠŠä»¥å‰åªèƒ½çœ‹æ‡‚å­—è¯»ä¸æ‡‚çš„çŸ¥è¯†éƒ½ä¸²èµ·æ¥äº†ï¼Œå½¢æˆä½“ç³»åŒ–ï¼Œè¿æµ‹è¯•éƒ½è¯»æ‡‚äº†ï¼Œèµå•Š","like_count":1,"discussions":[{"author":{"id":1269969,"avatar":"https://static001.geekbang.org/account/avatar/00/13/60/d1/8efa89ab.jpg","nickname":"ç‹å®ä»¤","note":"","ucode":"4FE19F5BC32FCA","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":444694,"discussion_content":"è¯´æ˜æµ‹è¯•æ°´å¹³ä¹Ÿä¸ä½ğŸ˜„\n","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1553647204,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":79473,"user_name":"Vincent","can_delete":false,"product_type":"c1","uid":1135159,"ip_address":"","ucode":"CD8B84A57A6A0C","user_header":"https://static001.geekbang.org/account/avatar/00/11/52/37/13b4c8aa.jpg","comment_is_top":false,"comment_ctime":1553492401,"is_pvip":false,"replies":[{"id":"29001","content":"æ˜¯","user_name":"ä½œè€…å›å¤","user_name_real":"ç‹å®ä»¤","uid":"1269969","ctime":1553516094,"ip_address":"","comment_id":79473,"utype":1}],"discussion_count":1,"race_medal":0,"score":"5848459697","product_id":100023901,"comment_content":"ç®¡ç¨‹ä¸­çš„é”è§„åˆ™åªå¯¹synchronized è¿™ä¸ªé”æœ‰æ•ˆï¼Ÿ","like_count":1,"discussions":[{"author":{"id":1269969,"avatar":"https://static001.geekbang.org/account/avatar/00/13/60/d1/8efa89ab.jpg","nickname":"ç‹å®ä»¤","note":"","ucode":"4FE19F5BC32FCA","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":444510,"discussion_content":"æ˜¯","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1553516094,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":78771,"user_name":"shawn","can_delete":false,"product_type":"c1","uid":1101483,"ip_address":"","ucode":"9AF400BBF2E264","user_header":"https://static001.geekbang.org/account/avatar/00/10/ce/ab/e9d7811f.jpg","comment_is_top":false,"comment_ctime":1553238548,"is_pvip":true,"discussion_count":0,"race_medal":0,"score":"5848205844","product_id":100023901,"comment_content":"å®åœ¨å¿ä¸ä½è¦æ¥è®²å‡ å¥ï¼Œè€å¸ˆçš„è¯¾ç¨‹è®²å¾—çœŸçš„å¾ˆç²¾å½©ï¼Œå—ç›ŠåŒªæµ…ã€‚","like_count":1},{"had_liked":false,"id":78757,"user_name":"å…”2ğŸ°ğŸƒ","can_delete":false,"product_type":"c1","uid":1096984,"ip_address":"","ucode":"1FEDA044BB6CBD","user_header":"https://static001.geekbang.org/account/avatar/00/10/bd/18/2af6bf4b.jpg","comment_is_top":false,"comment_ctime":1553232928,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"5848200224","product_id":100023901,"comment_content":"ä¸€æ¥¼æ‰€è¯´çš„&quot;ï¼ˆ6ï¼‰.çº¿ç¨‹ä¸­æ–­è§„åˆ™ï¼šå¯¹çº¿ç¨‹<br>interrupt()æ–¹æ³•çš„è°ƒç”¨å…ˆè¡Œå‘ç”Ÿäºè¢«ä¸­<br>æ–­çº¿ç¨‹çš„ä»£ç æ£€æµ‹åˆ°ä¸­æ–­äº‹ä»¶çš„å‘ç”Ÿï¼Œ<br>å¯ä»¥é€šè¿‡Thread.interrupted(ï¼‰æ–¹æ³•æ£€æµ‹<br>åˆ°æ˜¯å¦æœ‰ä¸­æ–­å‘ç”Ÿã€‚&quot;<br>å¯¹äºè¿™ä¸ªä¸æ˜¯å¾ˆå¥½ç†è§£ï¼Œå¯ä»¥ä¸¾ä¸ªä¾‹å­è¯´æ˜ä¸‹ä¹ˆï¼Œè°¢è°¢","like_count":1},{"had_liked":false,"id":78577,"user_name":"æ±Ÿå—è±†æ²™åŒ…","can_delete":false,"product_type":"c1","uid":1061596,"ip_address":"","ucode":"4B7833260F9F2F","user_header":"https://static001.geekbang.org/account/avatar/00/10/32/dc/d3e3847f.jpg","comment_is_top":false,"comment_ctime":1553177868,"is_pvip":false,"replies":[{"id":"28661","content":"åé¢çš„ä¼šè¦†ç›–å‰é¢çš„","user_name":"ä½œè€…å›å¤","user_name_real":"ç‹å®ä»¤","uid":"1269969","ctime":1553263451,"ip_address":"","comment_id":78577,"utype":1}],"discussion_count":1,"race_medal":0,"score":"5848145164","product_id":100023901,"comment_content":"è€å¸ˆï¼Œæœ‰ä¸ªç–‘é—®ï¼Œæœ‰æ²¡æœ‰å¯èƒ½å¤šä¸ªçº¿ç¨‹åœ¨åŒä¸€æ—¶é—´ç»™volatileä¿®é¥°çš„å˜é‡èµ‹å€¼ï¼Œé‚£æ ·æœ€ç»ˆçš„å€¼æ˜¯ä¸æ˜¯å°±ä¸ç¡®å®šäº†ï¼Ÿ","like_count":1,"discussions":[{"author":{"id":1269969,"avatar":"https://static001.geekbang.org/account/avatar/00/13/60/d1/8efa89ab.jpg","nickname":"ç‹å®ä»¤","note":"","ucode":"4FE19F5BC32FCA","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":444149,"discussion_content":"åé¢çš„ä¼šè¦†ç›–å‰é¢çš„","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1553263451,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":77468,"user_name":"WP","can_delete":false,"product_type":"c1","uid":1105956,"ip_address":"","ucode":"4A24C6CAA70220","user_header":"https://static001.geekbang.org/account/avatar/00/10/e0/24/4529f2a4.jpg","comment_is_top":false,"comment_ctime":1552952523,"is_pvip":false,"replies":[{"id":"28281","content":"çœ‹å®Œä½ ä¹Ÿä¼˜ç§€ğŸ‘","user_name":"ä½œè€…å›å¤","user_name_real":"ç‹å®ä»¤","uid":"1269969","ctime":1552953325,"ip_address":"","comment_id":77468,"utype":1}],"discussion_count":1,"race_medal":0,"score":"5847919819","product_id":100023901,"comment_content":"ä¼˜ç§€ï¼Œå¾ˆå¢é•¿çŸ¥è¯†","like_count":1,"discussions":[{"author":{"id":1269969,"avatar":"https://static001.geekbang.org/account/avatar/00/13/60/d1/8efa89ab.jpg","nickname":"ç‹å®ä»¤","note":"","ucode":"4FE19F5BC32FCA","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":443736,"discussion_content":"çœ‹å®Œä½ ä¹Ÿä¼˜ç§€ğŸ‘","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1552953325,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":76391,"user_name":"math","can_delete":false,"product_type":"c1","uid":1432973,"ip_address":"","ucode":"7EE57777F86058","user_header":"https://static001.geekbang.org/account/avatar/00/15/dd/8d/0396fabe.jpg","comment_is_top":false,"comment_ctime":1552582180,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"5847549476","product_id":100023901,"comment_content":"@junzi:æˆ‘çš„ç†è§£æ˜¯ï¼Œå…³äºç¬¬ä¸€æ¡ç¨‹åºé¡ºåºæ‰§è¡Œç¡®å®å‘ç”Ÿåœ¨å•çº¿ç¨‹ä¸­ï¼Œç¼–è¯‘å™¨ç¡®å®æœ‰å¯èƒ½å¯¹å…¶è¿›è¡Œé‡æ’ï¼Œä½†æ˜¯è€å¸ˆè¯´1.5åŠä»¥åå¼•å…¥happen-beforeè§„åˆ™å¯ä»¥ç¡®å®šå¯¹volitoleå˜é‡çš„å†™å¯¹åé¢è¯¥å˜é‡çš„è¯»å¯è§ã€‚æ‰€ä»¥è¿™æ—¶å€™è¦æ»¡è¶³ä¼ é€’æ€§ã€‚å°±ä¸èƒ½å‘ç”Ÿé‡æ’","like_count":1},{"had_liked":false,"id":75798,"user_name":"ç™½äº†å°‘å¹´å¤´","can_delete":false,"product_type":"c1","uid":1053084,"ip_address":"","ucode":"A65E00E05B23BA","user_header":"https://static001.geekbang.org/account/avatar/00/10/11/9c/4fd6ebe0.jpg","comment_is_top":false,"comment_ctime":1552470387,"is_pvip":false,"replies":[{"id":"27647","content":"è¯»å†™éƒ½è¦åŠ åŒæ­¥å—<br>","user_name":"ä½œè€…å›å¤","user_name_real":"ç‹å®ä»¤","uid":"1269969","ctime":1552480664,"ip_address":"","comment_id":75798,"utype":1}],"discussion_count":1,"race_medal":0,"score":"5847437683","product_id":100023901,"comment_content":"è€å¸ˆæˆ‘å¯¹æ€è€ƒé¢˜æœ‰ä¸ªç–‘é—®å•Šï¼Œå‰é¢æœ‰ä¸ªåŒå­¦å›ç­”æœ‰ä¸‰ç§åŠæ³•ï¼Œå…¶ä¸­ç¬¬äºŒç§æ˜¯ï¼šâ€œå£°æ˜å…±äº«å˜é‡abcï¼Œåœ¨synchronizedå…³é”®å­—å¯¹abcçš„èµ‹å€¼ä»£ç å—åŠ é”ï¼Œç”±äºHappen-beforeç®¡ç¨‹é”çš„è§„åˆ™ï¼Œå¯ä»¥ä½¿å¾—åç»­çš„çº¿ç¨‹å¯ä»¥çœ‹åˆ°abcçš„å€¼â€ï¼Œè€å¸ˆå›å¤æ˜¯ä¸‰ç§æ–¹å¼éƒ½æ­£ç¡®ã€‚æˆ‘çš„ç–‘é—®å°±æ˜¯ï¼Œå¦‚æœåªå¯¹abcçš„èµ‹å€¼ä»£ç å—åŒæ­¥çš„è¯ï¼Œå¦‚æœæœ‰ä¸€ä¸ªgetabc()æ–¹æ³•ï¼Œè¯¥æ–¹æ³•å¹¶æ²¡æœ‰ç”¨synchronizedä¿®é¥°ï¼Œå…¶ä»–çº¿ç¨‹åœ¨è°ƒç”¨è¯¥æ–¹æ³•è·å–çš„abcçš„å€¼ï¼Œæ˜¯ä¸æ˜¯æœ‰å¯èƒ½ä¸ç­‰äº3å‘¢ï¼Ÿ","like_count":1,"discussions":[{"author":{"id":1269969,"avatar":"https://static001.geekbang.org/account/avatar/00/13/60/d1/8efa89ab.jpg","nickname":"ç‹å®ä»¤","note":"","ucode":"4FE19F5BC32FCA","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":443039,"discussion_content":"è¯»å†™éƒ½è¦åŠ åŒæ­¥å—\n","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1552480664,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":75777,"user_name":"ä½ åªæ˜¯çœ‹èµ·æ¥å¾ˆåŠªåŠ›","can_delete":false,"product_type":"c1","uid":1449173,"ip_address":"","ucode":"F9340A560D347C","user_header":"https://static001.geekbang.org/account/avatar/00/16/1c/d5/248a9c38.jpg","comment_is_top":false,"comment_ctime":1552467572,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"5847434868","product_id":100023901,"comment_content":"è€å¸ˆï¼Œçœ‹å®Œä½ ç»™WLåŒå­¦è§£ç­”é€¸å‡ºï¼Œç»ˆäºæ˜ç™½äº†ä¸ºä»€ä¹ˆé™æ€æ–¹æ³•ä¸­ä¸èƒ½ä½¿ç”¨thisäº†ï¼Œæ²¡æœ‰åˆå§‹åŒ–ï¼Œä¹Ÿå°±æ²¡æœ‰è¿™ä¸ªå¯¹è±¡ã€‚","like_count":1},{"had_liked":false,"id":75528,"user_name":"è™è™â¤ï¸","can_delete":false,"product_type":"c1","uid":1086535,"ip_address":"","ucode":"157F261E80291A","user_header":"https://static001.geekbang.org/account/avatar/00/10/94/47/75875257.jpg","comment_is_top":false,"comment_ctime":1552409038,"is_pvip":false,"replies":[{"id":"27632","content":"è§„åˆ™ä¸€åœ¨å•çº¿ç¨‹æ°¸è¿œæˆï¼Œä¸éœ€è¦è§¦å‘<br>","user_name":"ä½œè€…å›å¤","user_name_real":"ç‹å®ä»¤","uid":"1269969","ctime":1552478667,"ip_address":"","comment_id":75528,"utype":1}],"discussion_count":1,"race_medal":0,"score":"5847376334","product_id":100023901,"comment_content":"è§„åˆ™4 æ˜¯éœ€è¦ ç»“åˆè§„åˆ™1ï¼Œ3 æ¥ç†è§£çš„ã€‚<br>å› ä¸ºè§„åˆ™1 å¯¹xçš„æ“ä½œçš„happens-before è§£é”ï¼Œ<br>å› ä¸ºè§„åˆ™4 è§£é”happens-beforeå…¶ä»–ç®¡ç¨‹çš„åŠ é”ã€‚<br>å› ä¸ºè§„åˆ™3 å¯¹xçš„æ“ä½œ happens-before å…¶ä»–ç®¡ç¨‹çš„åŠ é”ã€‚<br><br>é‚£ä¹ˆé—®é¢˜æ¥äº†ï¼Œä»€ä¹ˆæƒ…å†µä¸‹è§¦å‘è§„åˆ™1å‘¢ï¼Ÿç»“åˆè¯¾ç¨‹æ‰€è®²ï¼Œåº”è¯¥æ˜¯æŒ‰éœ€çš„é™åˆ¶ç¼“å­˜å’Œç¼–è¯‘ä¼˜åŒ–ã€‚æ‰€ä»¥æ˜¯åœ¨æœ‰volatile æˆ–è€… synchronized å…³é”®å­—çš„æ—¶å€™è§¦å‘è§„åˆ™1å—ï¼Ÿè¿˜æœ‰æ²¡æœ‰å…¶ä»–çš„æƒ…å†µï¼Ÿ","like_count":1,"discussions":[{"author":{"id":1269969,"avatar":"https://static001.geekbang.org/account/avatar/00/13/60/d1/8efa89ab.jpg","nickname":"ç‹å®ä»¤","note":"","ucode":"4FE19F5BC32FCA","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":442928,"discussion_content":"è§„åˆ™ä¸€åœ¨å•çº¿ç¨‹æ°¸è¿œæˆï¼Œä¸éœ€è¦è§¦å‘\n","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1552478667,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":75475,"user_name":"ä½ è¯´çš„ç°","can_delete":false,"product_type":"c1","uid":1158981,"ip_address":"","ucode":"650FA935A7741F","user_header":"https://static001.geekbang.org/account/avatar/00/11/af/45/8bacada2.jpg","comment_is_top":false,"comment_ctime":1552402705,"is_pvip":false,"replies":[{"id":"27638","content":"çº¿ç¨‹1é‡Œæ‰§è¡Œè¿™ä¸¤è¡Œï¼Œçº¿ç¨‹2é‡Œæ‰§è¡Œè¯»ã€‚<br>çº¿ç¨‹1ç”¨è§„åˆ™1ï¼Œçº¿ç¨‹ 2ç”¨voè§„åˆ™ï¼Œå†åŠ ä¸Šä¼ é€’æ€§ã€‚<br><br>å°±æœ‰ç»“æœäº†ï¼Œjvmä¸€å®šè¦ä¿è¯éµå®ˆè§„åˆ™ï¼Œæ‰€ä»¥ä¸ä¼šå‡ºç°ä½ æƒ³çš„é—®é¢˜ã€‚","user_name":"ä½œè€…å›å¤","user_name_real":"ç‹å®ä»¤","uid":"1269969","ctime":1552479495,"ip_address":"","comment_id":75475,"utype":1}],"discussion_count":1,"race_medal":0,"score":"5847370001","product_id":100023901,"comment_content":"å‚è€ƒ1ä¸­write()æ–¹æ³•ä»£ç ï¼š<br>x=45; &#47;&#47; 1<br>v=true; &#47;&#47; 2<br>è¿™ä¸¤è¡Œä¼šä¸ä¼šå¯¼è‡´æŒ‡ä»¤é‡æ’ï¼Ÿ<br><br>å› ä¸ºvolatileå…³é”®å­—åº”è¯¥åªä¿è¯äº†å˜é‡vçš„å¯è§æ€§ï¼Œhappen-beforeç¬¬ä¸€æ¡åŸåˆ™åœ¨å•çº¿ç¨‹ä¸­ï¼Œ1ä¸2é‡æ’å¹¶ä¸å½±å“ç»“æœï¼Œé‚£åº”è¯¥æœ‰å¯èƒ½å‡ºç°é‡æ’çš„æƒ…å†µï¼Œè¿™æ ·çº¿ç¨‹Bè¯»å–åˆ°read()çš„æ—¶å€™ä¹Ÿæœ‰å¯èƒ½å‡ºç°x=0ã€‚è¿˜è¯·è€å¸ˆè§£ç­”ã€‚<br><br>åŒé—®ï¼Œæœ›è§£ç­”","like_count":1,"discussions":[{"author":{"id":1269969,"avatar":"https://static001.geekbang.org/account/avatar/00/13/60/d1/8efa89ab.jpg","nickname":"ç‹å®ä»¤","note":"","ucode":"4FE19F5BC32FCA","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":442907,"discussion_content":"çº¿ç¨‹1é‡Œæ‰§è¡Œè¿™ä¸¤è¡Œï¼Œçº¿ç¨‹2é‡Œæ‰§è¡Œè¯»ã€‚\nçº¿ç¨‹1ç”¨è§„åˆ™1ï¼Œçº¿ç¨‹ 2ç”¨voè§„åˆ™ï¼Œå†åŠ ä¸Šä¼ é€’æ€§ã€‚\n\nå°±æœ‰ç»“æœäº†ï¼Œjvmä¸€å®šè¦ä¿è¯éµå®ˆè§„åˆ™ï¼Œæ‰€ä»¥ä¸ä¼šå‡ºç°ä½ æƒ³çš„é—®é¢˜ã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1552479495,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":74952,"user_name":"æé±¼çš„æ¬ç –å¥‡","can_delete":false,"product_type":"c1","uid":1021539,"ip_address":"","ucode":"2FD194C4DA26E5","user_header":"https://static001.geekbang.org/account/avatar/00/0f/96/63/7eb32c9b.jpg","comment_is_top":false,"comment_ctime":1552320489,"is_pvip":false,"replies":[{"id":"27338","content":"å°±æ˜¯ä¸€æ—¦èµ‹å€¼ï¼Œå°±ä¸å†å˜åŒ–ï¼Œçº¿ç¨‹å®‰å…¨ã€‚","user_name":"ä½œè€…å›å¤","user_name_real":"ç‹å®ä»¤","uid":"1269969","ctime":1552349929,"ip_address":"","comment_id":74952,"utype":1}],"discussion_count":1,"race_medal":0,"score":"5847287785","product_id":100023901,"comment_content":"è¿™é‡Œå…³äºfinalçš„ä¸æ˜¯å¾ˆæ‡‚ï¼Œèƒ½ä¸èƒ½å†è¯´æ˜ç¡®ç‚¹ã€‚","like_count":1,"discussions":[{"author":{"id":1269969,"avatar":"https://static001.geekbang.org/account/avatar/00/13/60/d1/8efa89ab.jpg","nickname":"ç‹å®ä»¤","note":"","ucode":"4FE19F5BC32FCA","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":442754,"discussion_content":"å°±æ˜¯ä¸€æ—¦èµ‹å€¼ï¼Œå°±ä¸å†å˜åŒ–ï¼Œçº¿ç¨‹å®‰å…¨ã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1552349929,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":74607,"user_name":"è€é†‹","can_delete":false,"product_type":"c1","uid":1308401,"ip_address":"","ucode":"D6DF921AAB9E7A","user_header":"https://static001.geekbang.org/account/avatar/00/13/f6/f1/5ccbe3fe.jpg","comment_is_top":false,"comment_ctime":1552266079,"is_pvip":false,"replies":[{"id":"27237","content":"é«˜æ‰‹ï¼","user_name":"ä½œè€…å›å¤","user_name_real":"ç‹å®ä»¤","uid":"1269969","ctime":1552277504,"ip_address":"","comment_id":74607,"utype":1}],"discussion_count":1,"race_medal":0,"score":"5847233375","product_id":100023901,"comment_content":"è¿˜æœ‰ä½¿ç”¨åŸå­å˜é‡casæ¥ä¿éšœ","like_count":1,"discussions":[{"author":{"id":1269969,"avatar":"https://static001.geekbang.org/account/avatar/00/13/60/d1/8efa89ab.jpg","nickname":"ç‹å®ä»¤","note":"","ucode":"4FE19F5BC32FCA","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":442615,"discussion_content":"é«˜æ‰‹ï¼","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1552277504,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":74427,"user_name":"é¾™å“¥","can_delete":false,"product_type":"c1","uid":1451669,"ip_address":"","ucode":"E7ED2E7DF759A1","user_header":"https://static001.geekbang.org/account/avatar/00/16/26/95/a4e0f7ab.jpg","comment_is_top":false,"comment_ctime":1552223737,"is_pvip":false,"replies":[{"id":"27235","content":"æ„Ÿè°¢ç››èµ<br>","user_name":"ä½œè€…å›å¤","user_name_real":"ç‹å®ä»¤","uid":"1269969","ctime":1552277388,"ip_address":"","comment_id":74427,"utype":1}],"discussion_count":1,"race_medal":0,"score":"5847191033","product_id":100023901,"comment_content":"å…³äºè¯¾ç¨‹<br>è™½è¯´æ˜¯éŸ³é¢‘ï¼Œæ„Ÿè§‰æ¯”è§†é¢‘æ›´æœ‰ç”»é¢æ„Ÿã€‚ç›¸å…³çš„è§†é¢‘ä¹Ÿçœ‹è¿‡ï¼Œåªæ˜¯äº¤å¦‚ä½•ä½¿ç”¨ï¼Œä½†æ˜¯æ²¡è®²åŸç†ï¼Œè®²å®Œå°±å¿˜ã€‚è¿™ä¸ªè¯¾ç¨‹ä»åŸç†ç»™å¤§å®¶æ¢³ç†çŸ¥è¯†ï¼Œæ„Ÿè§‰è¯¾ç¨‹ç‰¹åˆ«èµ<br><br>å…³äºæ€è€ƒé¢˜<br>1.å¯ä»¥è®¾ç½®abcå˜é‡ä¸ºvolatile,é‚£ä¹ˆçº¿ç¨‹Aå¯¹abcçš„å†™æ“ä½œéƒ½ä¼šHappens-beforeåç»­çº¿ç¨‹<br>2.ä½¿ç”¨synchronized,æ¯æ¬¡æ“ä½œæ—¶éƒ½ä¼šåŠ é”ï¼Œä¿è¯æ¯æ¬¡åªæœ‰ä¸€ä¸ªçº¿ç¨‹å¯¹abcè¿›è¡Œæ”¹å˜ï¼Œä½¿å¾—å…¶ä»–çº¿ç¨‹éƒ½èƒ½æ­£ç¡®è¯»åˆ°è¯¥å€¼<br>3.ä½¿ç”¨joinï¼Œçº¿ç¨‹Aæ”¹å˜äº†abcåï¼Œbçº¿ç¨‹ç­‰å¾…Açº¿ç¨‹å®Œæˆï¼ŒAçº¿ç¨‹å¯¹å…±äº«å˜é‡abcçš„æ“ä½œéƒ½happens-beforeåç»­çº¿ç¨‹<br>","like_count":1,"discussions":[{"author":{"id":1269969,"avatar":"https://static001.geekbang.org/account/avatar/00/13/60/d1/8efa89ab.jpg","nickname":"ç‹å®ä»¤","note":"","ucode":"4FE19F5BC32FCA","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":442574,"discussion_content":"æ„Ÿè°¢ç››èµ\n","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1552277388,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":74180,"user_name":"QQæ€ª","can_delete":false,"product_type":"c1","uid":1211223,"ip_address":"","ucode":"1A39B8433D9208","user_header":"https://static001.geekbang.org/account/avatar/00/12/7b/57/a9b04544.jpg","comment_is_top":false,"comment_ctime":1552135826,"is_pvip":false,"replies":[{"id":"27132","content":"æ˜¯è¿™æ ·ï¼ŒæŠ˜è…¾åŠå¤©å…¶å®å°±æ˜¯è§£å†³è¿™ä¹ˆä¸ªé—®é¢˜ã€‚ä½ æ€»ç»“çš„å¤ªåˆ°ä½äº†ï¼","user_name":"ä½œè€…å›å¤","user_name_real":"ç‹å®ä»¤","uid":"1269969","ctime":1552142652,"ip_address":"","comment_id":74180,"utype":1}],"discussion_count":1,"race_medal":0,"score":"5847103122","product_id":100023901,"comment_content":"æˆ‘æ˜¯ä¸æ˜¯å¯ä»¥é€šè¿‡happen-beforeé‚£å‡ ä¸ªè§„åˆ™èƒ½å¤Ÿæ¨ç®—å‡ºå‰é¢ä¸€ä¸ªæ“ä½œçš„ç»“æœå¯¹åç»­æ“ä½œæ˜¯å¯è§æ€§?","like_count":1,"discussions":[{"author":{"id":1269969,"avatar":"https://static001.geekbang.org/account/avatar/00/13/60/d1/8efa89ab.jpg","nickname":"ç‹å®ä»¤","note":"","ucode":"4FE19F5BC32FCA","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":442483,"discussion_content":"æ˜¯è¿™æ ·ï¼ŒæŠ˜è…¾åŠå¤©å…¶å®å°±æ˜¯è§£å†³è¿™ä¹ˆä¸ªé—®é¢˜ã€‚ä½ æ€»ç»“çš„å¤ªåˆ°ä½äº†ï¼","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1552142652,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":73713,"user_name":"é‚£å°±è¿™æ ·å§","can_delete":false,"product_type":"c1","uid":1327343,"ip_address":"","ucode":"A1315C5EAF2917","user_header":"https://static001.geekbang.org/account/avatar/00/14/40/ef/52bbadb9.jpg","comment_is_top":false,"comment_ctime":1551962565,"is_pvip":false,"replies":[{"id":"26920","content":"æˆ‘æ›¾ç»è·Ÿä½ ä¸€æ ·","user_name":"ä½œè€…å›å¤","user_name_real":"ç‹å®ä»¤","uid":"1269969","ctime":1551967189,"ip_address":"","comment_id":73713,"utype":1}],"discussion_count":1,"race_medal":0,"score":"5846929861","product_id":100023901,"comment_content":"æœ‰ç§æç„¶å¤§æ‚Ÿçš„æ„Ÿè§‰ï¼Œä¹‹å‰ä¹Ÿçœ‹è¿‡å…³äºhappen-before,ä½†ä¸€ç›´æ²¡èƒ½ç†è§£ã€‚","like_count":1,"discussions":[{"author":{"id":1269969,"avatar":"https://static001.geekbang.org/account/avatar/00/13/60/d1/8efa89ab.jpg","nickname":"ç‹å®ä»¤","note":"","ucode":"4FE19F5BC32FCA","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":442239,"discussion_content":"æˆ‘æ›¾ç»è·Ÿä½ ä¸€æ ·","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1551967189,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":73599,"user_name":"ä¼ è‘±","can_delete":false,"product_type":"c1","uid":1178023,"ip_address":"","ucode":"18C3641F35003B","user_header":"https://static001.geekbang.org/account/avatar/00/11/f9/a7/1e69b9a1.jpg","comment_is_top":false,"comment_ctime":1551936719,"is_pvip":false,"replies":[{"id":"26916","content":"å¤ªå…¨é¢äº†ï¼","user_name":"ä½œè€…å›å¤","user_name_real":"ç‹å®ä»¤","uid":"1269969","ctime":1551964745,"ip_address":"","comment_id":73599,"utype":1}],"discussion_count":1,"race_medal":0,"score":"5846904015","product_id":100023901,"comment_content":"æ ¹æ®è€å¸ˆä¸Šé¢è®²çš„è§„åˆ™ï¼Œåº”è¯¥æ˜¯å­˜åœ¨6ç§æƒ…å†µçš„ï¼Œhappend-beforeé™¤äº†ç¬¬ä¸€ç§æƒ…å†µç”¨äºåŒä¸€ä¸ªçº¿ç¨‹ä¹‹å¤–ã€‚åé¢éƒ½å¯ä»¥å¤„ç†å¤šçº¿ç¨‹ä¹‹é—´çš„å¯è§æ€§é—®é¢˜ã€‚ç¬¬ä¸€ä¸ªå…±äº«å˜é‡åŠ ä¸Švolatileã€‚ç¬¬äºŒä¸ªä¼ é€’æ€§ï¼Œé™¤äº†è¿™ä¸ªå…±äº«å˜é‡abcä¹‹å¤–ï¼Œæ–°å»ºä¸€ä¸ªvolitileå˜é‡cccï¼Œåœ¨abcèµ‹å€¼ä¹‹åå†™å…¥cccï¼Œå¦å¤–ä¸€ä¸ªçº¿ç¨‹åœ¨è¯»å–abcä¹‹å‰è¯»å–cccã€‚ç¬¬ä¸‰ä¸ªï¼ŒåŠ é”ï¼Œsynchronizedã€‚ç¬¬å››ä¸ªï¼Œstartæ–¹æ³•ï¼Œä¸€ä¸ªçº¿ç¨‹å¿…ç„¶æ˜¯åœ¨startï¼ˆï¼‰ä¹‹åæ‰ä¼šrunçš„ï¼Œstartåœ¨ä¸»çº¿ç¨‹ä¸­åˆå¯ä»¥ä½¿ç”¨ç¬¬ä¸€æ¡é¡ºåºæ€§è§„åˆ™ã€‚ç¬¬äº”ä¸ªï¼Œjoinï¼Œç­‰å¾…å¼‚æ­¥çº¿ç¨‹ç»“æŸï¼Œå…¶å®å’Œstartå·®ä¸å¯¹ï¼ŒåŸç†åŸºæœ¬ç›¸åŒã€‚æœ€åä½¿ç”¨finalï¼Œåªèƒ½èµ‹å€¼ä¸€æ¬¡ï¼Œå¿…ç„¶æ˜¯ä¸å˜çš„ï¼Œå£°æ˜ä¸ºå…±äº«å˜é‡ï¼Œæ§åˆ¶ä¸€ä¸‹èµ‹å€¼æ—¶é—´å°±è¡Œï¼Œè¿™ä¸ªä½“ç°çš„ä¸æ˜æ˜¾ã€‚","like_count":1,"discussions":[{"author":{"id":1269969,"avatar":"https://static001.geekbang.org/account/avatar/00/13/60/d1/8efa89ab.jpg","nickname":"ç‹å®ä»¤","note":"","ucode":"4FE19F5BC32FCA","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":442176,"discussion_content":"å¤ªå…¨é¢äº†ï¼","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1551964745,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":73448,"user_name":"Jaswine","can_delete":false,"product_type":"c1","uid":1243370,"ip_address":"","ucode":"EE39D9629204DB","user_header":"https://static001.geekbang.org/account/avatar/00/12/f8/ea/98738420.jpg","comment_is_top":false,"comment_ctime":1551885876,"is_pvip":false,"replies":[{"id":"26857","content":"è¦æ˜¯å†å¤šè½¬å‘å°±æ›´å¥½äº†","user_name":"ä½œè€…å›å¤","user_name_real":"ç‹å®ä»¤","uid":"1269969","ctime":1551957100,"ip_address":"","comment_id":73448,"utype":1}],"discussion_count":1,"race_medal":0,"score":"5846853172","product_id":100023901,"comment_content":"è†ç›–æ”¶ä¸‹ï¼ï¼ï¼","like_count":1,"discussions":[{"author":{"id":1269969,"avatar":"https://static001.geekbang.org/account/avatar/00/13/60/d1/8efa89ab.jpg","nickname":"ç‹å®ä»¤","note":"","ucode":"4FE19F5BC32FCA","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":442092,"discussion_content":"è¦æ˜¯å†å¤šè½¬å‘å°±æ›´å¥½äº†","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1551957100,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":73289,"user_name":"Geek_ebda96","can_delete":false,"product_type":"c1","uid":1134862,"ip_address":"","ucode":"02912E6D95A5A6","user_header":"http://thirdwx.qlogo.cn/mmopen/vi_32/DYAIOgq83eoRiaKX0ulEibbbwM4xhjyMeza0Pyp7KO1mqvfJceiaM6ZNtGpXJibI6P2qHGwBP9GKwOt9LgHicHflBXw/132","comment_is_top":false,"comment_ctime":1551852056,"is_pvip":false,"replies":[{"id":"26723","content":"è¿™ä¸ªåªæ˜¯å‘Šè¯‰ä½ ç†è®ºä¸Šä¼šå‡ºé—®é¢˜ã€‚å®é™…ä¸Šä¹Ÿè®¸ä¸ä¼šå‡ºã€‚è¿™ä¸ªä¾‹å­åªæ˜¯å‘Šè¯‰ä½ å¦‚ä½•æ·±å…¥ç†è§£volatile","user_name":"ä½œè€…å›å¤","user_name_real":"ç‹å®ä»¤","uid":"1269969","ctime":1551882173,"ip_address":"","comment_id":73289,"utype":1}],"discussion_count":2,"race_medal":0,"score":"5846819352","product_id":100023901,"comment_content":"è€å¸ˆï¼Œä½ è¿™ä¸ªä¾‹å­<br>&#47;&#47; ä»¥ä¸‹ä»£ç æ¥æºäºã€å‚è€ƒ 1ã€‘<br>class VolatileExample {<br>  int x = 0;<br>  volatile boolean v = false;<br>  public void writer() {<br>    x = 42;<br>    v = true;<br>  }<br>  public void reader() {<br>    if (v == true) {<br>      &#47;&#47; è¿™é‡Œ x ä¼šæ˜¯å¤šå°‘å‘¢ï¼Ÿ<br>    }<br>  }<br>}<br>å°±ç®—ä¸åŠ volatileï¼Œå¯åŠ¨ä¸¤ä¸ªçº¿ç¨‹ï¼Œç¬¬ä¸€ä¸ªçº¿ç¨‹writer(),ç¬¬äºŒä¸ªçº¿ç¨‹reader(),è¿˜æ˜¯ä¸ä¼šå‡ºç°x=0çš„æƒ…å†µå‘€","like_count":1,"discussions":[{"author":{"id":1269969,"avatar":"https://static001.geekbang.org/account/avatar/00/13/60/d1/8efa89ab.jpg","nickname":"ç‹å®ä»¤","note":"","ucode":"4FE19F5BC32FCA","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":442005,"discussion_content":"è¿™ä¸ªåªæ˜¯å‘Šè¯‰ä½ ç†è®ºä¸Šä¼šå‡ºé—®é¢˜ã€‚å®é™…ä¸Šä¹Ÿè®¸ä¸ä¼šå‡ºã€‚è¿™ä¸ªä¾‹å­åªæ˜¯å‘Šè¯‰ä½ å¦‚ä½•æ·±å…¥ç†è§£volatile","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1551882173,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1402570,"avatar":"https://static001.geekbang.org/account/avatar/00/15/66/ca/fb5c3a30.jpg","nickname":"tungSing","note":"","ucode":"F7147EA351BE44","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":167417,"discussion_content":"æˆ‘è·‘äº†ä»£ç ä¹Ÿæ˜¯è¿™ä¸ªæƒ…å†µï¼Œæ²¡ç†è§£ä¸ºä»€ä¹ˆï¼Œä½†æ˜¯å•ä¸ªå˜é‡ï¼Œæ¯”å¦‚ä¸åŠ volatileä¿®é¥°åªæ“ä½œvï¼ŒAçº¿ç¨‹æ”¹å˜äº†vçš„å€¼Bçº¿ç¨‹æ˜¯çœ‹ä¸åˆ°çš„ï¼ŒåŠ ä¸Švolatileä¿®é¥°ï¼ŒAçº¿ç¨‹æ”¹å˜äº†vçš„å€¼Bçº¿ç¨‹æ˜¯å¯ä»¥çœ‹åˆ°çš„","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1581492066,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":73276,"user_name":"è½»æ­Œèµ‹","can_delete":false,"product_type":"c1","uid":1251574,"ip_address":"","ucode":"22F62446208805","user_header":"https://static001.geekbang.org/account/avatar/00/13/18/f6/2ff7bc7a.jpg","comment_is_top":false,"comment_ctime":1551848115,"is_pvip":false,"replies":[{"id":"26721","content":"æ˜¯çš„","user_name":"ä½œè€…å›å¤","user_name_real":"ç‹å®ä»¤","uid":"1269969","ctime":1551882025,"ip_address":"","comment_id":73276,"utype":1}],"discussion_count":1,"race_medal":0,"score":"5846815411","product_id":100023901,"comment_content":"è¿™é‡Œè€ƒè™‘çš„åº”è¯¥æ˜¯è¯»åœ¨å†™åé¢å‘ç”Ÿçš„æƒ…å†µä¸‹æ˜¯å¦æ­£ç¡®è¯»åˆ°äº†abcçš„å€¼ï¼Œæ‰€ä»¥ç›´æ¥<br>final int abc = 123åˆå§‹åŒ–æ˜¯æœ€ç®€å•çš„","like_count":1,"discussions":[{"author":{"id":1269969,"avatar":"https://static001.geekbang.org/account/avatar/00/13/60/d1/8efa89ab.jpg","nickname":"ç‹å®ä»¤","note":"","ucode":"4FE19F5BC32FCA","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":441999,"discussion_content":"æ˜¯çš„","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1551882025,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":73191,"user_name":"Smallfly","can_delete":false,"product_type":"c1","uid":1013841,"ip_address":"","ucode":"D388D5E0249A69","user_header":"https://static001.geekbang.org/account/avatar/00/0f/78/51/4790e13e.jpg","comment_is_top":false,"comment_ctime":1551836707,"is_pvip":false,"replies":[{"id":"26739","content":"å•çº¿ç¨‹é‡Œåªæœ‰è§„åˆ™ä¸€æ˜¯å¯ä»¥çš„ã€‚æ–‡ä¸­çš„ä¾‹å­å¤šçº¿ç¨‹çš„åœºæ™¯ã€‚è¯»å†™æ˜¯ä¸¤ä¸ªçº¿ç¨‹çš„æ—¶å€™ï¼Œæ²¡åŠæ³•ä¿è¯æ­£ç¡®æ€§ã€‚<br><br>å³ä½¿æ²¡æœ‰ CPU ç¼“å­˜ï¼Œä¹Ÿä¼šæœ‰é—®é¢˜ã€‚è¿™ä¸ªä¸å±äºå¯è§æ€§çš„é—®é¢˜ï¼Œå±äºåŸå­æ€§çš„é—®é¢˜ã€‚","user_name":"ä½œè€…å›å¤","user_name_real":"ç‹å®ä»¤","uid":"1269969","ctime":1551883004,"ip_address":"","comment_id":73191,"utype":1}],"discussion_count":1,"race_medal":0,"score":"5846804003","product_id":100023901,"comment_content":"ä»¤å“¥ï¼Œæˆ‘ä¸æ˜¯ Java ç¨‹åºå‘˜ï¼Œä½†æ˜¯å¯¹æ–‡ä¸­çš„å¯è§æ€§é—®é¢˜æœ‰äº›ç–‘æƒ‘ã€‚<br><br>ä¸Šä¸€è®²è¯´å¯è§æ€§é—®é¢˜æ˜¯ç¼“å­˜å¯¼è‡´çš„ï¼Œæˆ‘ä¸ç¡®å®šå¯è§æ€§é—®é¢˜ï¼Œæ˜¯ä¸æ˜¯æŒ‡å¯¼è‡´ 10000 + 10000 &lt; 20000 çš„é—®é¢˜ã€‚<br><br>å› ä¸ºå³ä½¿æ²¡æœ‰ CPU ç¼“å­˜ï¼Œè¿™ä¸ªé—®é¢˜åœ¨å¤šæ ¸ä¸­è¿˜æ˜¯ä¼šå­˜åœ¨çš„ï¼Œæ¯”å¦‚çº¿ç¨‹ A ä»å†…å­˜è¯»å–å˜é‡ x = 0ï¼Œè¿›è¡Œ +1 æ“ä½œï¼Œåœ¨å†™å…¥å†…å­˜å‰ï¼Œçº¿ç¨‹ B ä¹Ÿè¯»å– xï¼Œå¹¶åš +1 æ“ä½œï¼Œå½“ä¸¤ä¸ªçº¿ç¨‹éƒ½å†™å…¥æ—¶ï¼Œx çš„å€¼åªæœ‰ 1ã€‚<br><br>è¿™ä¸ªæ˜¯å¦å±äºå¯è§æ€§é—®é¢˜å‘¢ï¼Ÿå¦‚æœä¸æ˜¯ï¼Œå‡ºç°éé¢„æœŸç»“æœå°±è·Ÿå¯è§æ€§é—®é¢˜æ²¡å…³ç³»ï¼›ä½†å¦‚æœæ˜¯ï¼Œè¿™åˆè·Ÿ CPU ç¼“å­˜æ²¡ä»€ä¹ˆå…³ç³»ã€‚<br><br><br>è¿˜æœ‰è¿™ä¸€è®²ä¸­è¯´ 1.5 ç‰ˆæœ¬å volatile ä¸­åŠ å…¥ Happens-Before è§„åˆ™ï¼Œé˜²æ­¢æŒ‡ä»¤è¢«ç¼–è¯‘å™¨ä¼˜åŒ–ã€‚ä¸ªäººè§‰å¾—åªè¦æ»¡è¶³ç¬¬ä¸€æ¡â€œç¨‹åºçš„é¡ºåºæ€§è§„åˆ™â€ï¼Œå³ x = 42 å…ˆäº v = true æ‰§è¡Œï¼Œå°±ä¸ä¼šå‡ºç° x = 0 çš„ç»“æœã€‚è§„åˆ™ 2 å’Œè§„åˆ™ 3 å¯¹è¿™æ®µä»£ç æ¥è¯´æ²¡ä»€ä¹ˆå¸®åŠ©ï¼Œæˆ‘ä¸ç¡®å®šæ˜¯ä¸æ˜¯ä¼šåœ¨å…¶å®ƒåœºæ™¯æœ‰æ•ˆã€‚<br><br>æŒ‡æœ›è€å¸ˆèƒ½æŒ‡ç‚¹ä¸€äºŒï¼Œæ„Ÿè°¢ã€‚<br>","like_count":1,"discussions":[{"author":{"id":1269969,"avatar":"https://static001.geekbang.org/account/avatar/00/13/60/d1/8efa89ab.jpg","nickname":"ç‹å®ä»¤","note":"","ucode":"4FE19F5BC32FCA","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":441961,"discussion_content":"å•çº¿ç¨‹é‡Œåªæœ‰è§„åˆ™ä¸€æ˜¯å¯ä»¥çš„ã€‚æ–‡ä¸­çš„ä¾‹å­å¤šçº¿ç¨‹çš„åœºæ™¯ã€‚è¯»å†™æ˜¯ä¸¤ä¸ªçº¿ç¨‹çš„æ—¶å€™ï¼Œæ²¡åŠæ³•ä¿è¯æ­£ç¡®æ€§ã€‚\n\nå³ä½¿æ²¡æœ‰ CPU ç¼“å­˜ï¼Œä¹Ÿä¼šæœ‰é—®é¢˜ã€‚è¿™ä¸ªä¸å±äºå¯è§æ€§çš„é—®é¢˜ï¼Œå±äºåŸå­æ€§çš„é—®é¢˜ã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1551883004,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":73186,"user_name":"è°¢ç‰¹","can_delete":false,"product_type":"c1","uid":1248684,"ip_address":"","ucode":"9C30DBFECFE649","user_header":"https://static001.geekbang.org/account/avatar/00/13/0d/ac/09678490.jpg","comment_is_top":false,"comment_ctime":1551836229,"is_pvip":false,"replies":[{"id":"26628","content":"å†™å®Œåï¼Œåˆ«çš„çº¿ç¨‹èƒ½æ­£ç¡®è¯»å‡ºæ¥","user_name":"ä½œè€…å›å¤","user_name_real":"ç‹å®ä»¤","uid":"1269969","ctime":1551846672,"ip_address":"","comment_id":73186,"utype":1}],"discussion_count":1,"race_medal":0,"score":"5846803525","product_id":100023901,"comment_content":"å¯è§æ€§æ€ä¹ˆå®šä¹‰çš„","like_count":1,"discussions":[{"author":{"id":1269969,"avatar":"https://static001.geekbang.org/account/avatar/00/13/60/d1/8efa89ab.jpg","nickname":"ç‹å®ä»¤","note":"","ucode":"4FE19F5BC32FCA","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":441957,"discussion_content":"å†™å®Œåï¼Œåˆ«çš„çº¿ç¨‹èƒ½æ­£ç¡®è¯»å‡ºæ¥","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1551846672,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":73119,"user_name":"æé±¼çš„æ¬ç –å¥‡","can_delete":false,"product_type":"c1","uid":1021539,"ip_address":"","ucode":"2FD194C4DA26E5","user_header":"https://static001.geekbang.org/account/avatar/00/0f/96/63/7eb32c9b.jpg","comment_is_top":false,"comment_ctime":1551802714,"is_pvip":false,"replies":[{"id":"26581","content":"æ²¡å¤ªæ˜ç™½ä½ çš„é—®é¢˜ã€‚åªæ˜¯åœ¨è¯´hbçš„äº‹æƒ…ã€‚volatileä¸ä»…æ˜¯ç¦ç”¨ç¼“å­˜ï¼Œè¦ç»¼åˆhbè§„åˆ™æ¥çœ‹<br>","user_name":"ä½œè€…å›å¤","user_name_real":"ç‹å®ä»¤","uid":"1269969","ctime":1551832190,"ip_address":"","comment_id":73119,"utype":1}],"discussion_count":1,"race_medal":0,"score":"5846770010","product_id":100023901,"comment_content":"VolatileExampleçš„æ„æ€æ˜¯å› ä¸ºvæ˜¯volatileçš„ï¼Œæ‰€ä»¥è¯»å–çš„æ—¶å€™è¦ä»ä¸»å†…å­˜æ‹¿ï¼Œè¿™ä¸ªæ—¶å€™CPUç¼“å­˜ä¸ä¼šæœ‰å…¶ä»–å˜é‡äº†å—","like_count":1,"discussions":[{"author":{"id":1269969,"avatar":"https://static001.geekbang.org/account/avatar/00/13/60/d1/8efa89ab.jpg","nickname":"ç‹å®ä»¤","note":"","ucode":"4FE19F5BC32FCA","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":441923,"discussion_content":"æ²¡å¤ªæ˜ç™½ä½ çš„é—®é¢˜ã€‚åªæ˜¯åœ¨è¯´hbçš„äº‹æƒ…ã€‚volatileä¸ä»…æ˜¯ç¦ç”¨ç¼“å­˜ï¼Œè¦ç»¼åˆhbè§„åˆ™æ¥çœ‹\n","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1551832190,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":72986,"user_name":"é™ˆåº·åº·","can_delete":false,"product_type":"c1","uid":1192741,"ip_address":"","ucode":"A34A0DC88D6E77","user_header":"https://static001.geekbang.org/account/avatar/00/12/33/25/eac79a47.jpg","comment_is_top":false,"comment_ctime":1551770726,"is_pvip":false,"replies":[{"id":"26500","content":"final class A{}<br>A x = new A();<br><br>å®ƒä¸Šé¢è¿™æ®µçš„æ„æ€ï¼Œåº”è¯¥æ˜¯è¯´xçš„äº‹æƒ…ã€‚xä¸æ˜¯finalçš„ï¼Œæ‰€ä»¥éœ€è¦åŒæ­¥ã€‚","user_name":"ä½œè€…å›å¤","user_name_real":"ç‹å®ä»¤","uid":"1269969","ctime":1551796708,"ip_address":"","comment_id":72986,"utype":1}],"discussion_count":1,"race_medal":0,"score":"5846738022","product_id":100023901,"comment_content":"ä¸çŸ¥é“ä¸‹é¢è¿™æ®µè¯æ€ä¹ˆç†è§£å‘¢ï¼Œä¸å¯å˜å¯¹è±¡å¤šçº¿ç¨‹ä¹‹é—´è¿˜è¦ä½¿ç”¨åŒæ­¥ï¼ˆé”ï¼‰ï¼Œè¿™ä¸ªæ²¡æœ‰ç†è§£ï¼Œæœ›å›å¤<br>Now, having said all of this, if, after a thread constructs an immutable object (that is, an object that only contains final fields), you want to ensure that it is seen correctly by all of the other thread, you still typically need to use synchronization. There is no other way to ensure, for example, that the reference to the immutable object will be seen by the second thread.<br><br>","like_count":1,"discussions":[{"author":{"id":1269969,"avatar":"https://static001.geekbang.org/account/avatar/00/13/60/d1/8efa89ab.jpg","nickname":"ç‹å®ä»¤","note":"","ucode":"4FE19F5BC32FCA","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":441863,"discussion_content":"final class A{}\nA x = new A();\n\nå®ƒä¸Šé¢è¿™æ®µçš„æ„æ€ï¼Œåº”è¯¥æ˜¯è¯´xçš„äº‹æƒ…ã€‚xä¸æ˜¯finalçš„ï¼Œæ‰€ä»¥éœ€è¦åŒæ­¥ã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1551796708,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":72907,"user_name":"é äººå“å»èµ¢","can_delete":false,"product_type":"c1","uid":1301286,"ip_address":"","ucode":"7A20F9EBE847E1","user_header":"https://static001.geekbang.org/account/avatar/00/13/db/26/54f2c164.jpg","comment_is_top":false,"comment_ctime":1551753727,"is_pvip":false,"replies":[{"id":"26487","content":"é«˜æ‰‹åœ¨æ°‘é—´","user_name":"ä½œè€…å›å¤","user_name_real":"ç‹å®ä»¤","uid":"1269969","ctime":1551794694,"ip_address":"","comment_id":72907,"utype":1}],"discussion_count":1,"race_medal":0,"score":"5846721023","product_id":100023901,"comment_content":"æ€è€ƒé¢˜çº¿ç¨‹ä¿®æ”¹åå¯¹åç»­çº¿ç¨‹å¯è§ï¼Œæˆ‘åªæƒ³åˆ°äº†synchronizedå…³é”®å­—ï¼ŒThreadçš„start( )å’Œjoin( )ä½¿ç”¨ï¼Œæ²¡æƒ³åˆ°è¯„è®ºåŒºäººæ‰è¿™ä¹ˆå¤šï¼Œæ–¹æ³•å¯ä»¥è¿™ä¹ˆå¤šã€‚<br>çœ‹å®Œæ–‡ç« æ„Ÿè§‰å¯¹volatileï¼Œsynchronizedå’Œfinalå…³é”®å­—æœ‰äº†æ–°çš„äº†è§£ï¼Œ<br>é¦–å…ˆvolatileå…³é”®å­—æ˜¯ç¦ç”¨ç¼“å­˜ï¼ˆCPUé‡Œé¢é‚£ä¸ªï¼‰ï¼Œä¿è¯çš„æ˜¯ä»å†…å­˜è¯»å–ï¼Œè¦æ³¨æ„æ—§ç‰ˆæœ¬çš„çº¿ç¨‹å¯è§æ€§å¯¼è‡´è¯»å–ç»“æœä¸æ­£ç¡®ã€‚<br>synchronizedå…³é”®å­—æ˜¯å…³äºé”ï¼Œç›¸å½“äºç”¨ä¸Šå°±åŠ é”å¯¹åº”çš„ä»£ç å—ç»“æŸå°±è§£é”ï¼Œè§£é”åï¼Œåé¢çš„çš„çº¿ç¨‹å°±å¯ä»¥çœ‹åˆ°ä¹‹å‰çš„å†…å®¹ã€‚<br>finalæ˜¯è¦æ³¨æ„ç¼–è¯‘ä¼˜åŒ–åŒé‡æ£€æŸ¥å¸¦æ¥çš„é—®é¢˜ï¼ˆçœ‹æ–‡æ¡£ï¼Œè·Ÿæ‡’æ±‰æ¨¡å¼æœ‰å…³ï¼‰ï¼Œä¸è¦æƒ³æ–°ä»–çœŸçš„â€œç”Ÿè€Œä¸å˜â€ã€‚","like_count":1,"discussions":[{"author":{"id":1269969,"avatar":"https://static001.geekbang.org/account/avatar/00/13/60/d1/8efa89ab.jpg","nickname":"ç‹å®ä»¤","note":"","ucode":"4FE19F5BC32FCA","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":441820,"discussion_content":"é«˜æ‰‹åœ¨æ°‘é—´","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1551794694,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":72633,"user_name":"Lyre","can_delete":false,"product_type":"c1","uid":1275759,"ip_address":"","ucode":"61AB16508AFFDA","user_header":"https://static001.geekbang.org/account/avatar/00/13/77/6f/454951d2.jpg","comment_is_top":false,"comment_ctime":1551683105,"is_pvip":false,"replies":[{"id":"26349","content":"è¿™ç®—ä¸ç®—é¥¥é¥¿è¥é”€?","user_name":"ä½œè€…å›å¤","user_name_real":"ç‹å®ä»¤","uid":"1269969","ctime":1551709796,"ip_address":"","comment_id":72633,"utype":1}],"discussion_count":1,"race_medal":0,"score":"5846650401","product_id":100023901,"comment_content":"è€å¸ˆ æ›´æ–°çš„æœ‰ç‚¹æ…¢ å“ˆå“ˆå“ˆ","like_count":1,"discussions":[{"author":{"id":1269969,"avatar":"https://static001.geekbang.org/account/avatar/00/13/60/d1/8efa89ab.jpg","nickname":"ç‹å®ä»¤","note":"","ucode":"4FE19F5BC32FCA","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":441668,"discussion_content":"è¿™ç®—ä¸ç®—é¥¥é¥¿è¥é”€?","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1551709796,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":72509,"user_name":"æ²™æ¼ é‡Œçš„éª†é©¼","can_delete":false,"product_type":"c1","uid":1012559,"ip_address":"","ucode":"5EC18A71B3A594","user_header":"https://static001.geekbang.org/account/avatar/00/0f/73/4f/abb7bfe3.jpg","comment_is_top":false,"comment_ctime":1551662449,"is_pvip":true,"replies":[{"id":"26357","content":"èƒ½è§£å†³ã€‚<br>å½“ä½ ç”¨happens-beforeè§„åˆ™æ¥æ¨ç®—ç¨‹åºè¿è¡Œç»“æœæ—¶ï¼Œæ˜¯ç«™åœ¨Javaè¯­è¨€çš„è§’åº¦çš„ã€‚é‡Œé¢çš„è¯­å¥å’Œèµ‹å€¼è¯­å¥æ˜¯ é¡ºåºè§„åˆ™ä¿è¯ï¼Œé¡ºåºè§„åˆ™+ä¼ é€’+volatile å°±èƒ½æ¨ç®—å‡ºæ¥ï¼šèƒ½å¤Ÿè§£å†³ã€‚","user_name":"ä½œè€…å›å¤","user_name_real":"ç‹å®ä»¤","uid":"1269969","ctime":1551710644,"ip_address":"","comment_id":72509,"utype":1}],"discussion_count":1,"race_medal":0,"score":"5846629745","product_id":100023901,"comment_content":"è¯·æ•™ä¸€ä¸ªé—®é¢˜ï¼Œä½¿ç”¨volatileå…³é”®å­—èƒ½è§£å†³ä¸Šä¸€èŠ‚è¯¾ä¸­çš„åŒé‡æ£€æŸ¥é—®é¢˜å—ï¼Ÿ<br>æˆ‘çš„ç†è§£æ˜¯: volatile æœ¬èº«çš„è¯­ä¹‰æ˜¯ç¦ç”¨ç¼“å­˜ï¼Œåªæœ‰ç»“åˆhappens-beforeè§„æ•´æ‰æœ‰ç¦ç”¨é‡æ’åºçš„æ„ä¹‰ã€‚è€Œå¯¹äºåŒé‡æ£€æŸ¥çš„é—®é¢˜ï¼Œå¯¹äºå˜é‡æœ¬èº«çš„åˆå§‹åŒ–ï¼Œé‡Œé¢çš„è¯­å¥çš„é‡æ’åºæ˜¯ä¸ä¼šç¦ç”¨çš„ï¼Œå› æ­¤è§£å†³ä¸äº†åŒé‡æ£€æŸ¥çš„é—®é¢˜ã€‚<br>ä¸è¿‡æˆ‘çœ‹è€å¸ˆç»™çš„é“¾æ¥èµ„æ–™(http:&#47;&#47;ifeve.com&#47;jmm-faq-dcl&#47;)é‡Œé¢è¯´æ˜¯å¯ä»¥è§£å†³çš„ï¼Œå¸Œæœ›è€å¸ˆèƒ½å¤Ÿåˆ†æä¸‹ï¼›<br>","like_count":1,"discussions":[{"author":{"id":1269969,"avatar":"https://static001.geekbang.org/account/avatar/00/13/60/d1/8efa89ab.jpg","nickname":"ç‹å®ä»¤","note":"","ucode":"4FE19F5BC32FCA","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":441622,"discussion_content":"èƒ½è§£å†³ã€‚\nå½“ä½ ç”¨happens-beforeè§„åˆ™æ¥æ¨ç®—ç¨‹åºè¿è¡Œç»“æœæ—¶ï¼Œæ˜¯ç«™åœ¨Javaè¯­è¨€çš„è§’åº¦çš„ã€‚é‡Œé¢çš„è¯­å¥å’Œèµ‹å€¼è¯­å¥æ˜¯ é¡ºåºè§„åˆ™ä¿è¯ï¼Œé¡ºåºè§„åˆ™+ä¼ é€’+volatile å°±èƒ½æ¨ç®—å‡ºæ¥ï¼šèƒ½å¤Ÿè§£å†³ã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1551710644,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":72344,"user_name":"Geek_961eed","can_delete":false,"product_type":"c1","uid":1444566,"ip_address":"","ucode":"A62198D96379F5","user_header":"http://thirdwx.qlogo.cn/mmopen/vi_32/DYAIOgq83erWxMXolPylQk8Z6V6yt2LtibksrksC4bHtmxkuCC4Wzw7trl6CfwmsSFMyHFItFnvl21RvQ8fyOBQ/132","comment_is_top":false,"comment_ctime":1551592406,"is_pvip":false,"replies":[{"id":"26208","content":"è¿™éƒ¨åˆ†finalå’Œæˆ‘ä»¬æ­£å¸¸çš„ç†è§£æ˜¯ä¸€è‡´çš„ï¼Œåªè¦ä¿è¯ä¸è¦â€œé€¸å‡ºâ€ï¼Œå°±æ²¡é—®é¢˜ã€‚æ²¡å‘ï¼Œæ‰€ä»¥å°±æ²¡æœ‰è¯¦ç»†ä»‹ç»ã€‚","user_name":"ä½œè€…å›å¤","user_name_real":"ç‹å®ä»¤","uid":"1269969","ctime":1551602598,"ip_address":"","comment_id":72344,"utype":1}],"discussion_count":1,"race_medal":0,"score":"5846559702","product_id":100023901,"comment_content":"å¸Œæœ›ä½œè€…ï¼Œèƒ½å¤Ÿæ·±å…¥çš„è®²è§£ä¸‹finalåœ¨å¹¶å‘ç¯å¢ƒä¸‹çš„åº”ç”¨ï¼Œfinalè¿™éƒ¨åˆ†è¯»èµ·æ¥æ„Ÿè§‰ä¸æ˜¯å¤ªé€šé€ï¼Œè°¢è°¢ï¼","like_count":1,"discussions":[{"author":{"id":1269969,"avatar":"https://static001.geekbang.org/account/avatar/00/13/60/d1/8efa89ab.jpg","nickname":"ç‹å®ä»¤","note":"","ucode":"4FE19F5BC32FCA","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":441551,"discussion_content":"è¿™éƒ¨åˆ†finalå’Œæˆ‘ä»¬æ­£å¸¸çš„ç†è§£æ˜¯ä¸€è‡´çš„ï¼Œåªè¦ä¿è¯ä¸è¦â€œé€¸å‡ºâ€ï¼Œå°±æ²¡é—®é¢˜ã€‚æ²¡å‘ï¼Œæ‰€ä»¥å°±æ²¡æœ‰è¯¦ç»†ä»‹ç»ã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1551602598,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":72276,"user_name":"é’å†°ç™½å¤œ","can_delete":false,"product_type":"c1","uid":1307569,"ip_address":"","ucode":"3F71F1027E8374","user_header":"https://static001.geekbang.org/account/avatar/00/13/f3/b1/0429aa3b.jpg","comment_is_top":false,"comment_ctime":1551569215,"is_pvip":false,"replies":[{"id":"26182","content":"å¯ä»¥é‡æ’ï¼Œä½†æ˜¯é‡æ’çš„ç»“æœè¦ä¿è¯Happens-Beforeè§„åˆ™<br>int i=0;<br>int j=1;<br>int k = i+j;<br>å¦‚æœä½ çš„ä»£ç æ˜¯ä¸Šé¢è¿™æ ·ï¼Œé‚£ä¹ˆç¼–è¯‘å™¨é‡æ’æˆï¼š<br>int j=1;<br>int i=0;<br>int k = i+j;<br>ä¹Ÿæ˜¯å¯ä»¥çš„ã€‚","user_name":"ä½œè€…å›å¤","user_name_real":"ç‹å®ä»¤","uid":"1269969","ctime":1551582718,"ip_address":"","comment_id":72276,"utype":1}],"discussion_count":2,"race_medal":0,"score":"5846536511","product_id":100023901,"comment_content":"è€å¸ˆé—®ä¸€ä¸ªçº ç»“çš„é—®é¢˜<br>å¦‚ä¸‹äº‹ä¾‹ä»£ç å‡è®¾æ˜¯åœ¨å•çº¿ç¨‹æ‰§è¡Œã€‚<br>int i=0ï¼›&#47;&#47;è¯­å¥1<br>int j=0ï¼› &#47;&#47;è¯­å¥2<br>è¿™é‡Œæ ¹æ®Happens-Beforeè§„åˆ™ï¼Œå•çº¿ç¨‹ä¸­è¯­å¥1ä¸€å®šæ˜¯æ¯”è¯­å¥2å…ˆæ‰§è¡Œã€‚ä½†æ˜¯æˆ‘çœ‹ä¹¦ä¸Šè¯´ï¼Œè¿™é‡Œå¯èƒ½ä¼šå‘ç”ŸæŒ‡ä»¤é‡æ’åºï¼Œä¹Ÿå°±æ˜¯è¯´è¯­å¥1ä¸ä¸€å®šæ¯”è¯­å¥2å…ˆæ‰§è¡Œã€‚æ€ä¹ˆæ„Ÿè§‰å’Œhappens-beforeè§„åˆ™æœ‰ç‚¹çŸ›ç›¾å•Šï¼Ÿæˆ‘çŸ¥é“æˆ‘å¯èƒ½å—å“ªå„¿ç†è§£æœ‰è¯¯åŒºï¼Œå¸Œæœ›è€å¸ˆç»™æˆ‘ç­”ç–‘ä¸‹ã€‚","like_count":1,"discussions":[{"author":{"id":1269969,"avatar":"https://static001.geekbang.org/account/avatar/00/13/60/d1/8efa89ab.jpg","nickname":"ç‹å®ä»¤","note":"","ucode":"4FE19F5BC32FCA","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":441519,"discussion_content":"å¯ä»¥é‡æ’ï¼Œä½†æ˜¯é‡æ’çš„ç»“æœè¦ä¿è¯Happens-Beforeè§„åˆ™\nint i=0;\nint j=1;\nint k = i+j;\nå¦‚æœä½ çš„ä»£ç æ˜¯ä¸Šé¢è¿™æ ·ï¼Œé‚£ä¹ˆç¼–è¯‘å™¨é‡æ’æˆï¼š\nint j=1;\nint i=0;\nint k = i+j;\nä¹Ÿæ˜¯å¯ä»¥çš„ã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1551582718,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1361746,"avatar":"https://static001.geekbang.org/account/avatar/00/14/c7/52/c5adf218.jpg","nickname":"å–œæ¬¢åœ°çƒçš„é˜¿åŸ¹åŒå­¦","note":"","ucode":"5F97037585F857","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":89038,"discussion_content":"int i=0;\nint j=1;\nint k = i+j;\nè¯´æ˜ i å¯¹ jæ˜¯å¯è§çš„\nint j=1;\nint i=0;\nint k = i+j;\nè¯´æ˜ j å¯¹ iæ˜¯å¯è§çš„\nè¿™é‡Œçš„happens-beforeè§„åˆ™ ä¸æ˜¯æŒ‡çš„ä»£ç çš„ä¹¦å†™é¡ºåºï¼Œè€Œæ˜¯åœ¨äºCPUæ‰§è¡ŒæŒ‡ä»¤æ—¶ã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1576747038,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":72049,"user_name":"crazypokerk","can_delete":false,"product_type":"c1","uid":1158383,"ip_address":"","ucode":"9AAD5D9726E503","user_header":"https://static001.geekbang.org/account/avatar/00/11/ac/ef/494f56c3.jpg","comment_is_top":false,"comment_ctime":1551506805,"is_pvip":false,"replies":[{"id":"26105","content":"å¯ä»¥è¿™ä¹ˆç†è§£ï¼Œä¸è¿‡å’ŒJVMçš„ä¼˜åŒ–æ²¡å…³ç³»","user_name":"ä½œè€…å›å¤","user_name_real":"ç‹å®ä»¤","uid":"1269969","ctime":1551522604,"ip_address":"","comment_id":72049,"utype":1}],"discussion_count":1,"race_medal":0,"score":"5846474101","product_id":100023901,"comment_content":"è¯·é—®è€å¸ˆï¼Œé€¸å‡ºæŒ‡çš„æ˜¯å¯¹è±¡é€ƒé€¸å—ï¼Ÿ","like_count":1,"discussions":[{"author":{"id":1269969,"avatar":"https://static001.geekbang.org/account/avatar/00/13/60/d1/8efa89ab.jpg","nickname":"ç‹å®ä»¤","note":"","ucode":"4FE19F5BC32FCA","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":441437,"discussion_content":"å¯ä»¥è¿™ä¹ˆç†è§£ï¼Œä¸è¿‡å’ŒJVMçš„ä¼˜åŒ–æ²¡å…³ç³»","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1551522604,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":71929,"user_name":"ç›¸æ°‘","can_delete":false,"product_type":"c1","uid":1288248,"ip_address":"","ucode":"1911950763FE3C","user_header":"https://static001.geekbang.org/account/avatar/00/13/a8/38/6a714398.jpg","comment_is_top":false,"comment_ctime":1551488364,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"5846455660","product_id":100023901,"comment_content":"@ä½•æ–¹å¦–å­½ JAVA8å¼•å…¥çš„Lambdaè¯­æ³•","like_count":1},{"had_liked":false,"id":358104,"user_name":"Sammy","can_delete":false,"product_type":"c1","uid":1200058,"ip_address":"ä¸Šæµ·","ucode":"75F16A25E72598","user_header":"https://static001.geekbang.org/account/avatar/00/12/4f/ba/520f2725.jpg","comment_is_top":false,"comment_ctime":1663912670,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1663912670","product_id":100023901,"comment_content":"æ€è€ƒé¢˜ï¼šä½¿ç”¨volatileå…³é”®è¯","like_count":0},{"had_liked":false,"id":356656,"user_name":"åœ¨è·¯ä¸Š","can_delete":false,"product_type":"c1","uid":1476245,"ip_address":"é‡åº†","ucode":"2668A965FA79F2","user_header":"https://static001.geekbang.org/account/avatar/00/16/86/95/b9d960d9.jpg","comment_is_top":false,"comment_ctime":1662474770,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1662474770","product_id":100023901,"comment_content":"1.ç»™abcåŠ ä¸Švolatileå…³é”®å­—<br>2.ä½¿ç”¨ä¼ é€’æ€§è§„åˆ™<br>3.ä½¿ç”¨abcçš„ä»£ç æ®µåŠ ä¸Šç®¡ç¨‹<br>4.åœ¨çˆ¶å­çº¿ç¨‹ä¸­ï¼Œåœ¨startæ–¹æ³•å‰ä½¿ç”¨abc<br>5.åœ¨çˆ¶å­çº¿ç¨‹ä¸­ï¼Œåœ¨çˆ¶çº¿ç¨‹è°ƒç”¨å­çº¿ç¨‹çš„joinæ–¹æ³•åä½¿ç”¨abc","like_count":0},{"had_liked":false,"id":355913,"user_name":"å–ç»çš„ğŸ’","can_delete":false,"product_type":"c1","uid":2215442,"ip_address":"åŒ—äº¬","ucode":"428BE0D6E6084C","user_header":"https://static001.geekbang.org/account/avatar/00/21/ce/12/7de69c30.jpg","comment_is_top":false,"comment_ctime":1661848552,"is_pvip":true,"replies":[{"id":"129674","content":"å·¥ä½œå†…å­˜ç®—æ˜¯ä¸ªé€»è¾‘æ¦‚å¿µå§ï¼Œjvmå®ç°å±‚é¢æ²¡è¿™ä¸œè¥¿","user_name":"ä½œè€…å›å¤","user_name_real":"ç¼–è¾‘","uid":"1269969","ctime":1662094226,"ip_address":"åŒ—äº¬","comment_id":355913,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1661848552","product_id":100023901,"comment_content":"ç½‘ä¸Šæœ‰äººè¯´ï¼Œjavaæ¯ä¸ªçº¿ç¨‹éƒ½æœ‰è‡ªå·±çš„å·¥ä½œå†…å­˜ï¼Œé‡Œé¢å­˜å‚¨çš„æ˜¯ä¸»å†…å­˜é‡Œæ•°æ®çš„å‰¯æœ¬ã€‚ä½†æˆ‘è®°å¾—jvmçº¿ç¨‹å…±äº«å †ï¼Œç§äº«æ ˆï¼Œæ‰€ä»¥æ˜¯å…±äº«å†…å­˜æ‰å¯¹å§ï¼Œæ²¡æœ‰æ‰€è°“çš„å·¥ä½œå†…å­˜","like_count":0,"discussions":[{"author":{"id":1269969,"avatar":"https://static001.geekbang.org/account/avatar/00/13/60/d1/8efa89ab.jpg","nickname":"ç‹å®ä»¤","note":"","ucode":"4FE19F5BC32FCA","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":586295,"discussion_content":"å·¥ä½œå†…å­˜ç®—æ˜¯ä¸ªé€»è¾‘æ¦‚å¿µå§ï¼Œjvmå®ç°å±‚é¢æ²¡è¿™ä¸œè¥¿","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1662094226,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"åŒ—äº¬"},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":351910,"user_name":"æ¼‚æ³Šè€…åŠå…¶å½±å­","can_delete":false,"product_type":"c1","uid":1119979,"ip_address":"","ucode":"13FE760FE8B111","user_header":"https://static001.geekbang.org/account/avatar/00/11/16/eb/30864e40.jpg","comment_is_top":false,"comment_ctime":1658286613,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1658286613","product_id":100023901,"comment_content":"synchronizedä»£ç å—æ˜¯å¦å¯ä»¥ä¿è¯ä»£ç å—çš„å˜é‡éƒ½æ˜¯å¯è§çš„ï¼Œå¦ä¸€ä¸ªçº¿ç¨‹ä¸é€šè¿‡ä»£ç å—æ›´æ”¹äº†å…±äº«å˜é‡ï¼Œsynchronizedä»£ç å—æ˜¯å¦ä¸€å®šèƒ½æ„ŸçŸ¥åˆ°å˜é‡çš„å˜æ›´ã€‚","like_count":0},{"had_liked":false,"id":351258,"user_name":"Geek_e1fa7e","can_delete":false,"product_type":"c1","uid":2937592,"ip_address":"åŒ—äº¬","ucode":"A4F760ECA6BC90","user_header":"https://thirdwx.qlogo.cn/mmopen/vi_32/mYWcQohmLrSmYTneYuRD7FCibkTj9JicVwYRO2qMUeiauUOtBIDyz1G1F4bVLrcXELs9Zz9Orh4JDg5C8jz1GhNug/132","comment_is_top":false,"comment_ctime":1657640046,"is_pvip":false,"replies":[{"id":"130865","content":"æ˜¯è¿™æ ·çš„ï¼ŒJVMå¼€å‘äººå‘˜è¦æ ¹æ®ä¸åŒçš„ç¡¬ä»¶æ¶æ„å†™ä¸åŒçš„å®ç°ï¼Œæˆ‘ä»¬ä¼šç”¨å°±å¯ä»¥äº†ã€‚","user_name":"ä½œè€…å›å¤","user_name_real":"ç¼–è¾‘","uid":"1269969","ctime":1665838283,"ip_address":"åŒ—äº¬","comment_id":351258,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1657640046","product_id":100023901,"comment_content":"è€å¸ˆï¼Œå¯¹äºjvmçš„å¼€å‘äººå‘˜æ¥è¯´ï¼Œæ˜¯ä¸æ˜¯ä¸»è¦æ˜¯åº”è¯¥å¦‚ä½•ç”¨å†…å­˜å±éšœå»å®ç°happens beforeè§„åˆ™ï¼Œä»¥åŠvolatileï¼Œfinalï¼Œsynchronizedå…³é”®å­—ã€‚è€Œå¯¹äºæˆ‘ä»¬ç¼–ç¨‹äººå‘˜æ¥è¯´ä¸»è¦æ˜¯å¦‚ä½•åœ¨ç¼–ç¨‹ä¸­ä½¿ç”¨è¿™äº›è§„åˆ™","like_count":0,"discussions":[{"author":{"id":1269969,"avatar":"https://static001.geekbang.org/account/avatar/00/13/60/d1/8efa89ab.jpg","nickname":"ç‹å®ä»¤","note":"","ucode":"4FE19F5BC32FCA","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":590529,"discussion_content":"æ˜¯è¿™æ ·çš„ï¼ŒJVMå¼€å‘äººå‘˜è¦æ ¹æ®ä¸åŒçš„ç¡¬ä»¶æ¶æ„å†™ä¸åŒçš„å®ç°ï¼Œæˆ‘ä»¬ä¼šç”¨å°±å¯ä»¥äº†ã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1665838283,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"åŒ—äº¬"},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":351142,"user_name":"Geek_a88f85","can_delete":false,"product_type":"c1","uid":2904239,"ip_address":"","ucode":"26A1F21EC9D02C","user_header":"https://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTIwxVNotictocRFbU74R724jC8IHibAwap8TL5aialwLJDY0RyXlZkfeUVdBzTntTzOpFuozaaeGHwYg/132","comment_is_top":false,"comment_ctime":1657545624,"is_pvip":true,"discussion_count":0,"race_medal":0,"score":"1657545624","product_id":100023901,"comment_content":"1. volatile å…³é”®å­—  <br>2. thread.startä¹‹å‰ä¿®æ”¹<br>3. scynéšå¼é”<br>4. joinæ–¹æ³•ä¹‹å","like_count":0},{"had_liked":false,"id":347954,"user_name":"çš®æ˜å¼º","can_delete":false,"product_type":"c1","uid":2810671,"ip_address":"","ucode":"A643459C69026A","user_header":"","comment_is_top":false,"comment_ctime":1654606433,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1654606433","product_id":100023901,"comment_content":"è€å¸ˆæ‚¨å¥½ï¼Œæˆ‘æµ‹è¯•äº†ä¸€ä¸‹ï¼Œä¸ç®¡ä¸»çº¿ç¨‹åœ¨å“ªé‡Œä¿®æ”¹ä»£ç ï¼Œæ„Ÿè§‰åªè¦æ¯”å­çº¿ç¨‹ä¿®æ”¹çš„å¿«ï¼Œå°±åœ¨å­çº¿ç¨‹ä¸­å¯è§ã€‚æ˜¯è¿™æ ·å—ï¼Ÿ","like_count":0},{"had_liked":false,"id":345735,"user_name":"å­¦ä¹ å­¦ä¸ªå±","can_delete":false,"product_type":"c1","uid":1049017,"ip_address":"","ucode":"DF2D61E6FB2FCE","user_header":"https://static001.geekbang.org/account/avatar/00/10/01/b9/73435279.jpg","comment_is_top":false,"comment_ctime":1652534313,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1652534313","product_id":100023901,"comment_content":"é—®é¢˜ç­”æ¡ˆï¼š<br>1 volatile å…³é”®å­—<br>2 happen-befor åŸåˆ™ï¼Œæ¯”å¦‚ açº¿ç¨‹ä¸­å®šä¹‰ ï¼Œå¯åŠ¨å…¶ä»–çº¿ç¨‹ï¼Œa happen-befor å…¶ä»–çº¿ç¨‹<br>3 åŠ é”<br>4 join å…ˆæ‰§è¡Œèµ‹å€¼çš„çº¿ç¨‹ï¼Œå…¶ä»–çº¿ç¨‹å†join<br><br><br>å†…å­˜å±éšœ","like_count":0},{"had_liked":false,"id":341150,"user_name":"å¯ä¹è¦åŠ å†°","can_delete":false,"product_type":"c1","uid":1546857,"ip_address":"","ucode":"DD5FE1A5BB35EB","user_header":"https://static001.geekbang.org/account/avatar/00/17/9a/69/af90f0c0.jpg","comment_is_top":false,"comment_ctime":1649390648,"is_pvip":false,"replies":[{"id":"124750","content":"æ˜¯è¿™æ ·","user_name":"ä½œè€…å›å¤","user_name_real":"ç¼–è¾‘","uid":"1269969","ctime":1649515400,"ip_address":"","comment_id":341150,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1649390648","product_id":100023901,"comment_content":"æº¢å‡ºé‚£é‡Œï¼Œæ˜¯å› ä¸ºæŒ‡ä»¤é‡æ’åºå¯¼è‡´xåœ¨global.objä¹‹ååˆå§‹åŒ–ï¼Œæ‰€ä»¥ä½¿ç”¨global.objçš„æ—¶å€™å¯èƒ½xè¿˜æ²¡æœ‰åˆå§‹åŒ–ï¼Œä»è€Œå‡ºç°ä½¿ç”¨global.objè¯»åˆ°çš„xæ˜¯æœªåˆå§‹åŒ–çš„0ã€‚æ˜¯è¿™æ ·å˜›","like_count":0,"discussions":[{"author":{"id":1269969,"avatar":"https://static001.geekbang.org/account/avatar/00/13/60/d1/8efa89ab.jpg","nickname":"ç‹å®ä»¤","note":"","ucode":"4FE19F5BC32FCA","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":561024,"discussion_content":"æ˜¯è¿™æ ·","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1649515400,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":340949,"user_name":"Geek_94fa0e","can_delete":false,"product_type":"c1","uid":2963434,"ip_address":"","ucode":"15BC7D4E130E80","user_header":"","comment_is_top":false,"comment_ctime":1649241293,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1649241293","product_id":100023901,"comment_content":"ä½†æ˜¯ final ä¸€èˆ¬æ€ä¹ˆç”¨å°¼","like_count":0},{"had_liked":false,"id":340636,"user_name":"ç™½ä¸åƒ","can_delete":false,"product_type":"c1","uid":1033578,"ip_address":"","ucode":"F019914D8819C2","user_header":"https://static001.geekbang.org/account/avatar/00/0f/c5/6a/7f858f1f.jpg","comment_is_top":false,"comment_ctime":1648983369,"is_pvip":true,"discussion_count":0,"race_medal":4,"score":"1648983369","product_id":100023901,"comment_content":"é‚£è¿™é‡Œçš„ x=42 å’Œ v=trueï¼Œæœ‰æ²¡æœ‰å¯èƒ½è¢«cpué‡æ–°æ’åºå‘¢ï¼Œå¦‚æœé‡æ–°æ’åºäº†ï¼Œé‚£ä¹ˆæ˜¯ä¸æ˜¯å°±å­˜åœ¨ï¼Œè¯»å–å‘ç”Ÿåœ¨èµ‹å€¼ä¹‹å‰ï¼Ÿ","like_count":0},{"had_liked":false,"id":340302,"user_name":"å°åœŸ","can_delete":false,"product_type":"c1","uid":1798467,"ip_address":"","ucode":"2B56E3FF91F732","user_header":"","comment_is_top":false,"comment_ctime":1648732122,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1648732122","product_id":100023901,"comment_content":"è¿™èŠ‚è®²çš„è¿˜æ˜¯æœ‰äº›æ™¦æ¶©ï¼Œç‰¹åˆ«æ˜¯happens-beforeéƒ¨åˆ†","like_count":0},{"had_liked":false,"id":340045,"user_name":"äº‘æ™´","can_delete":false,"product_type":"c1","uid":1398845,"ip_address":"","ucode":"43A7E9071E50E0","user_header":"https://static001.geekbang.org/account/avatar/00/15/58/3d/ad2bfebf.jpg","comment_is_top":false,"comment_ctime":1648554036,"is_pvip":true,"discussion_count":0,"race_medal":0,"score":"1648554036","product_id":100023901,"comment_content":"volatile int abc = 3;<br>&#47;&#47; or<br>int AtomicInteger abc = new AtomicInteger(3);","like_count":0},{"had_liked":false,"id":331626,"user_name":"äº‘éŸµ","can_delete":false,"product_type":"c1","uid":1025622,"ip_address":"","ucode":"3DE26DBAAAEDE6","user_header":"https://static001.geekbang.org/account/avatar/00/0f/a6/56/abb7bfe3.jpg","comment_is_top":false,"comment_ctime":1642674726,"is_pvip":true,"replies":[{"id":"122155","content":"åªæ˜¯è¯´æ˜ä¸€ä¸ªå…¨å±€å˜é‡è€Œå·²ï¼Œæ²¡æœ‰è¿™ç§è¯­æ³•","user_name":"ä½œè€…å›å¤","user_name_real":"ç¼–è¾‘","uid":"1269969","ctime":1644922852,"ip_address":"","comment_id":331626,"utype":1}],"discussion_count":1,"race_medal":1,"score":"1642674726","product_id":100023901,"comment_content":"ç‹è€å¸ˆï¼Œjava ä¸­è¿˜æœ‰è¿™ç§è¯­æ³•ï¼Ÿglobal.obj = this;<br>å¯ä»¥è§£é‡Šä¸€ä¸‹global è¿™ç§ç”¨æ³•å—","like_count":0,"discussions":[{"author":{"id":1269969,"avatar":"https://static001.geekbang.org/account/avatar/00/13/60/d1/8efa89ab.jpg","nickname":"ç‹å®ä»¤","note":"","ucode":"4FE19F5BC32FCA","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":551197,"discussion_content":"åªæ˜¯è¯´æ˜ä¸€ä¸ªå…¨å±€å˜é‡è€Œå·²ï¼Œæ²¡æœ‰è¿™ç§è¯­æ³•","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1644922852,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":328873,"user_name":"Insomnia","can_delete":false,"product_type":"c1","uid":1751214,"ip_address":"","ucode":"5986A48988D6E3","user_header":"https://static001.geekbang.org/account/avatar/00/1a/b8/ae/085484e7.jpg","comment_is_top":false,"comment_ctime":1640922446,"is_pvip":false,"replies":[{"id":"119891","content":"ä¸ç¡®å®šï¼Œæœ‰å¯èƒ½æ˜¯0ï¼Œä¹Ÿæœ‰å¯èƒ½æ˜¯42","user_name":"ä½œè€…å›å¤","user_name_real":"ç¼–è¾‘","uid":"1269969","ctime":1641193855,"ip_address":"","comment_id":328873,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1640922446","product_id":100023901,"comment_content":"<br>&#47;&#47; ä»¥ä¸‹ä»£ç æ¥æºäºã€å‚è€ƒ1ã€‘<br>class VolatileExample {<br>  int x = 0;<br>  boolean v = false;<br>  public void writer() {<br>    x = 42;<br>    v = true;<br>  }<br>  public void reader() {<br>    if (v == true) {<br>      &#47;&#47; è¿™é‡Œxä¼šæ˜¯å¤šå°‘å‘¢ï¼Ÿ<br>    }<br>  }<br>}<br>è€å¸ˆï¼ŒäºŒåˆ·è¿™ä¸ªæ•™ç¨‹ï¼Œæœ‰äº›æƒ³æ³•ï¼Œä¸Šé¢è¿™ä¸ªä¾‹å­ï¼Œå¦‚æœå˜é‡ v ä¸æ˜¯volatile çš„ï¼Œé‚£ä¹ˆå¹¶å‘ä¸‹ï¼Œxçš„å€¼æ˜¯ä¸æ˜¯è¿˜æ˜¯ä¸ç¡®å®šçš„ï¼Ÿ","like_count":0,"discussions":[{"author":{"id":1269969,"avatar":"https://static001.geekbang.org/account/avatar/00/13/60/d1/8efa89ab.jpg","nickname":"ç‹å®ä»¤","note":"","ucode":"4FE19F5BC32FCA","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":543521,"discussion_content":"ä¸ç¡®å®šï¼Œæœ‰å¯èƒ½æ˜¯0ï¼Œä¹Ÿæœ‰å¯èƒ½æ˜¯42","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1641193855,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":310815,"user_name":"ç‹è€…çˆ±å­¦ä¹ ","can_delete":false,"product_type":"c1","uid":1249643,"ip_address":"","ucode":"0397A4AB7FE83A","user_header":"https://static001.geekbang.org/account/avatar/00/13/11/6b/0a56da99.jpg","comment_is_top":false,"comment_ctime":1630921487,"is_pvip":false,"replies":[{"id":"113115","content":"ç†è®ºä¸Šå¯ä»¥é‡æ’ï¼Œä½†æ˜¯è¦ä¿è¯åŒä¸€çº¿ç¨‹ä¸­ç¬¬6è¡Œçš„æ‰§è¡Œç»“æœå¯¹ç¬¬7è¡Œå¯è§ï¼Œä¾‹å¦‚æœ‰å¯èƒ½åœ¨ä»–ä»¬ä¹‹é—´å¢åŠ ä¸€äº›éå†…å­˜æ“ä½œçš„æŒ‡ä»¤","user_name":"ä½œè€…å›å¤","user_name_real":"ç‹å®ä»¤","uid":"1269969","ctime":1631663556,"ip_address":"","comment_id":310815,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1630921487","product_id":100023901,"comment_content":"ç¬¬ 6 è¡Œä»£ç  â€œx = 42;â€ Happens-Before äºç¬¬ 7 è¡Œä»£ç  â€œv = true;â€ï¼Œè¿™å°±æ˜¯è§„åˆ™ 1 çš„å†…å®¹ï¼Œä¹Ÿæ¯”è¾ƒç¬¦åˆå•çº¿ç¨‹é‡Œé¢çš„æ€ç»´ï¼šç¨‹åºå‰é¢å¯¹æŸä¸ªå˜é‡çš„ä¿®æ”¹ä¸€å®šæ˜¯å¯¹åç»­æ“ä½œå¯è§çš„ã€‚<br><br>è€å¸ˆæ‚¨è¿™é‡Œè¯´çš„ç¬¬ä¸€æ¡è§„åˆ™ï¼Œæ˜¯å…ˆæ‰§è¡Œx=42 å†æ‰§è¡Œv = true  è¯·é—®è¿™ä¸¤ä¸ªæ“ä½œä¸ä¼šå‘ç”ŸæŒ‡ä»¤é‡æ‹å—ï¼Ÿ","like_count":0,"discussions":[{"author":{"id":1269969,"avatar":"https://static001.geekbang.org/account/avatar/00/13/60/d1/8efa89ab.jpg","nickname":"ç‹å®ä»¤","note":"","ucode":"4FE19F5BC32FCA","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":526366,"discussion_content":"ç†è®ºä¸Šå¯ä»¥é‡æ’ï¼Œä½†æ˜¯è¦ä¿è¯åŒä¸€çº¿ç¨‹ä¸­ç¬¬6è¡Œçš„æ‰§è¡Œç»“æœå¯¹ç¬¬7è¡Œå¯è§ï¼Œä¾‹å¦‚æœ‰å¯èƒ½åœ¨ä»–ä»¬ä¹‹é—´å¢åŠ ä¸€äº›éå†…å­˜æ“ä½œçš„æŒ‡ä»¤","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1631663556,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":305912,"user_name":"ğŸŒ","can_delete":false,"product_type":"c1","uid":2208565,"ip_address":"","ucode":"EDE31C3E82A4AD","user_header":"https://static001.geekbang.org/account/avatar/00/21/b3/35/64ccd5b0.jpg","comment_is_top":false,"comment_ctime":1628228442,"is_pvip":false,"replies":[{"id":"111202","content":"ä¸åŒçš„cpuæ¶æ„ï¼Œæ–¹å¼ä¸åŒï¼Œè¿™ä¸¤ç§æ–¹å¼éƒ½æœ‰","user_name":"ä½œè€…å›å¤","user_name_real":"ç‹å®ä»¤","uid":"1269969","ctime":1628857975,"ip_address":"","comment_id":305912,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1628228442","product_id":100023901,"comment_content":"è€å¸ˆæ‚¨å¥½ï¼Œè¿™ä¸ªé—®é¢˜æ‚¨çœ‹åˆ°ååŠ¡å¿…è§£ç­”ä¸€ä¸‹ï¼Œå›°æ‰°æˆ‘å¾ˆä¹…æ²¡æœ‰è§£å†³ï¼š<br><br>åœ¨å¤šæ ¸CPUä¿è¯å¯è§æ€§çš„é—®é¢˜ä¸­ï¼Œå‡è®¾CPU1ã€CPU2ã€CPU3ä¸­æœ‰ä¸€ä¸ªç¼“å­˜è¡Œï¼ˆåŒ…å«å˜é‡xï¼‰ï¼Œæ­¤æ—¶CPU1è¦å¯¹å˜é‡xè¿›è¡Œå†™æ“ä½œï¼š<br>1ã€åˆ°åº•æ˜¯CPU1å¹¿æ’­çš„å½¢å¼ï¼Œå°†æ— æ•ˆï¼ˆInvalidï¼‰å¹¿æ’­å‘é€ç»™å…¶ä»–CPUï¼Œå…¶ä»–CPUååº”åå°†ç¼“å­˜è¡Œè®¾ç½®ä¸ºæ— æ•ˆã€‚ã€åé¢ä¼˜åŒ–å¼•å…¥store bufferå’Œqueueï¼Œä½†æ˜¯å°±æ˜¯è¿™ä¸ªæ€æƒ³ã€‘<br>2ã€è¿˜æ˜¯CPU1åœ¨å¾€å†…å­˜å†™çš„æ—¶å€™ï¼Œå…¶ä»–CPUé€šè¿‡æ€»çº¿å—…æ¢æœºåˆ¶æ„ŸçŸ¥åˆ°çš„ã€‚<br><br>å„ç§åšå®¢éƒ½è¯´çš„ä¸æ˜¯å¾ˆæ¸…æ¥š","like_count":0,"discussions":[{"author":{"id":1269969,"avatar":"https://static001.geekbang.org/account/avatar/00/13/60/d1/8efa89ab.jpg","nickname":"ç‹å®ä»¤","note":"","ucode":"4FE19F5BC32FCA","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":524559,"discussion_content":"ä¸åŒçš„cpuæ¶æ„ï¼Œæ–¹å¼ä¸åŒï¼Œè¿™ä¸¤ç§æ–¹å¼éƒ½æœ‰","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1628857975,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":302110,"user_name":"æœºè½¦","can_delete":false,"product_type":"c1","uid":1881786,"ip_address":"","ucode":"CD32A645AE310A","user_header":"https://static001.geekbang.org/account/avatar/00/1c/b6/ba/f76d996b.jpg","comment_is_top":false,"comment_ctime":1626085346,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1626085346","product_id":100023901,"comment_content":"è€å¸ˆè¯·æ•™ä¸€ä¸ªé—®é¢˜ï¼ŒConcurrentHashMapä¸­ volatailä¿®é¥° çš„ Nodeæ•°ç»„ï¼Œè·å–æ—¶ä¸ºä½•ç”¨unsafeè·å–ï¼Ÿè€Œä¸æ˜¯ç”¨ä¸‹æ ‡å‘¢ï¼Ÿ","like_count":0},{"had_liked":false,"id":294406,"user_name":"é‡‘é‘«","can_delete":false,"product_type":"c1","uid":1116257,"ip_address":"","ucode":"8AA30E8DD736FB","user_header":"https://static001.geekbang.org/account/avatar/00/11/08/61/9e0f8b8d.jpg","comment_is_top":false,"comment_ctime":1621931260,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1621931260","product_id":100023901,"comment_content":"çˆ†ç²—ï¼Œè¿™ç¯‡å¤ªå¥½äº†ï¼Œå¼€å¯äº†ä¸€ä¸ªæ–°çš„è§†è§’ã€‚","like_count":0},{"had_liked":false,"id":293863,"user_name":"Bumblebee","can_delete":false,"product_type":"c1","uid":2051293,"ip_address":"","ucode":"B879C8A511D08D","user_header":"https://static001.geekbang.org/account/avatar/00/1f/4c/dd/c6035349.jpg","comment_is_top":false,"comment_ctime":1621580780,"is_pvip":true,"discussion_count":0,"race_medal":0,"score":"1621580780","product_id":100023901,"comment_content":"æ€»ç»“ä¸€ä¸‹æœ¬ç¯‡å†…å®¹çš„å…³é”®è¯ï¼šâ€œå…ˆåâ€","like_count":0},{"had_liked":false,"id":293718,"user_name":"Bumblebee","can_delete":false,"product_type":"c1","uid":2051293,"ip_address":"","ucode":"B879C8A511D08D","user_header":"https://static001.geekbang.org/account/avatar/00/1f/4c/dd/c6035349.jpg","comment_is_top":false,"comment_ctime":1621504457,"is_pvip":true,"replies":[{"id":"106776","content":"ä½ çš„è§£é‡Šç›´å‡»è¦å®³ï¼Œç›¸å½“æ­£ç¡®","user_name":"ä½œè€…å›å¤","user_name_real":"ç‹å®ä»¤","uid":"1269969","ctime":1621900622,"ip_address":"","comment_id":293718,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1621504457","product_id":100023901,"comment_content":"è€å¸ˆè¿™ä¸ªç¨‹åºè¾“å‡ºçš„ç»“æœä¸æ˜¯10000 ï¼Œæ˜¯ä¸æ˜¯å¯ä»¥è¿™ä¹ˆè§£é‡Švolatileä¿®é¥°äº†å…±äº«å˜é‡ä¿è¯äº†å˜é‡çš„ä¿®æ”¹å¯¹å„ä¸ªçº¿ç¨‹æ˜¯å¯è§çš„ä½†æ˜¯ count++ä¸æ˜¯åŸå­æ“ä½œ<br>public class Demo {<br><br>    private static volatile int count = 0;<br><br>    public static void main(String[] args) throws InterruptedException {<br>        Thread thread1 = new Thread(new MyThread());<br>        Thread thread2 = new Thread(new MyThread());<br>        Thread thread3 = new Thread(new MyThread());<br>        Thread thread4 = new Thread(new MyThread());<br>        Thread thread5 = new Thread(new MyThread());<br>        Thread thread6 = new Thread(new MyThread());<br>        Thread thread7 = new Thread(new MyThread());<br>        Thread thread8 = new Thread(new MyThread());<br>        Thread thread9 = new Thread(new MyThread());<br>        Thread thread10 = new Thread(new MyThread());<br><br>        thread1.start();<br>        thread2.start();<br>        thread3.start();<br>        thread4.start();<br>        thread5.start();<br>        thread6.start();<br>        thread7.start();<br>        thread8.start();<br>        thread9.start();<br>        thread10.start();<br><br><br>        thread1.join();<br>        thread2.join();<br>        thread3.join();<br>        thread4.join();<br>        thread5.join();<br>        thread6.join();<br>        thread7.join();<br>        thread8.join();<br>        thread9.join();<br>        thread10.join();<br><br>        System.out.println(count);<br><br>    }<br><br><br><br>    private static void test() {<br>        for (int i = 0; i &lt; 1000; i++) {<br>            count ++;<br>        }<br>    }<br><br><br>    static class  MyThread implements Runnable {<br>        @Override<br>        public void run() {<br>            test();<br>        }<br>    }<br><br>}","like_count":0,"discussions":[{"author":{"id":1269969,"avatar":"https://static001.geekbang.org/account/avatar/00/13/60/d1/8efa89ab.jpg","nickname":"ç‹å®ä»¤","note":"","ucode":"4FE19F5BC32FCA","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":520327,"discussion_content":"ä½ çš„è§£é‡Šç›´å‡»è¦å®³ï¼Œç›¸å½“æ­£ç¡®","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1621900622,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":289948,"user_name":"é›¨é£Vee","can_delete":false,"product_type":"c1","uid":1199975,"ip_address":"","ucode":"8AC07868C30E24","user_header":"https://static001.geekbang.org/account/avatar/00/12/4f/67/6a7a7534.jpg","comment_is_top":false,"comment_ctime":1619274972,"is_pvip":true,"discussion_count":0,"race_medal":0,"score":"1619274972","product_id":100023901,"comment_content":"å‡¡äº‹æœ‰å› å¹¶æœ‰æœï¼Œåƒç”µå½±ã€Šä¿¡æ¡ã€‹","like_count":0},{"had_liked":false,"id":288346,"user_name":"Focus","can_delete":false,"product_type":"c1","uid":1252104,"ip_address":"","ucode":"AEC14ED09E7D45","user_header":"https://static001.geekbang.org/account/avatar/00/13/1b/08/150b6a51.jpg","comment_is_top":false,"comment_ctime":1618415915,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1618415915","product_id":100023901,"comment_content":"ä½œä¸šï¼š<br>1ã€æ ¹æ®ç¬¬äºŒæ¡volatileå˜é‡è§„åˆ™ï¼Œå¯¹ä¸€ä¸ªvolatileå˜é‡çš„å†™æ“ä½œï¼Œhappen-beforeäºåç»­å¯¹è¿™ä¸ªå˜é‡çš„è¯»æ“ä½œï¼šæŠŠabcè®¾ç½®æˆå…¨å±€å˜é‡ï¼Œä¸”ç”¨volatileä¿®é¥°ï¼›<br>2ã€ç®¡ç¨‹ä¸­é”è§„åˆ™ï¼Œå¯¹ä¸€ä¸ªé”çš„è§£é”ï¼Œhanppen-beforäºåç»­å¯¹è¿™ä¸ªé”çš„åŠ é”ï¼šæŠŠabcèµ‹å€¼æ“ä½œæ”¾åˆ°å¸¦æœ‰synchronizedçš„ä»£ç å—ä¸­ï¼›<br>3ã€çº¿ç¨‹joinï¼ˆï¼‰è§„åˆ™ï¼šåœ¨çº¿ç¨‹ä¸­å®Œæˆabcèµ‹å€¼æ“ä½œåï¼Œè°ƒç”¨çº¿ç¨‹çš„joinï¼ˆï¼‰æ–¹æ³•ï¼Œå…¶ä»–çº¿ç¨‹å°±èƒ½å¤Ÿâ€œçœ‹â€åˆ°äº†ã€‚","like_count":0},{"had_liked":false,"id":288344,"user_name":"Focus","can_delete":false,"product_type":"c1","uid":1252104,"ip_address":"","ucode":"AEC14ED09E7D45","user_header":"https://static001.geekbang.org/account/avatar/00/13/1b/08/150b6a51.jpg","comment_is_top":false,"comment_ctime":1618415440,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1618415440","product_id":100023901,"comment_content":"è€å¸ˆï¼Œè¿™å¥â€œfinal ä¿®é¥°å˜é‡æ—¶ï¼Œåˆè¡·æ˜¯å‘Šè¯‰ç¼–è¯‘å™¨ï¼šè¿™ä¸ªå˜é‡ç”Ÿè€Œä¸å˜ï¼Œå¯ä»¥å¯åŠ²å„¿ä¼˜åŒ–â€œï¼Œè¿™å¥è¯æˆ‘ä¸å¤ªç†è§£ï¼Œè¿™å¥è¯æƒ³è¡¨è¾¾çš„æ„æ€æ˜¯ä¸€ä½†å˜é‡è¢«finalä¿®é¥°äº†ï¼Œå¹¶ä¸”è¿™ä¸ªå˜é‡æ˜¯åŸºç¡€æ•°æ®ç±»å‹çš„è¯ï¼Œå°±ä¸èƒ½æ”¹å˜äº†ï¼Œå…¶ä»–çº¿ç¨‹è¯»åˆ°çš„éƒ½ä¸å˜ï¼Ÿ","like_count":0},{"had_liked":false,"id":284864,"user_name":"æ´›å¥‡","can_delete":false,"product_type":"c1","uid":1624355,"ip_address":"","ucode":"662B4005721119","user_header":"https://static001.geekbang.org/account/avatar/00/18/c9/23/76511858.jpg","comment_is_top":false,"comment_ctime":1616502370,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1616502370","product_id":100023901,"comment_content":"å•ä¾‹ç±»ä»£ç ä¹‹æ‰€ä»¥è¦ç”¨volatileä¿®é¥°instanceï¼Œæ˜¯èƒ½è¿™æ ·è§£é‡Šå—ï¼Ÿnewå¯¹è±¡åœ¨è¢«èµ‹å€¼å‰å°±æ‰§è¡Œå¥½äº†ï¼Œé‚£å°±æ˜¯åœ¨volatileå˜é‡çš„å†™æ“ä½œä¹‹å‰å°±æ‰§è¡Œäº†ï¼Œæ‰€ä»¥åœ¨å†™æ“ä½œåçš„volatileå˜é‡çš„è¯»æ“ä½œå°±èƒ½happens-beforeã€‚ç”¨åˆ°äº†ä¼ é€’æ€§å’Œvolatileè¿™ä¸¤ä¸ªhappens-beforeè§„åˆ™ï¼Œæ˜¯å—ï¼Ÿ","like_count":0},{"had_liked":false,"id":284686,"user_name":"æ°´é“¶æ¹–","can_delete":false,"product_type":"c1","uid":1179011,"ip_address":"","ucode":"28BB2E47D8C30A","user_header":"https://static001.geekbang.org/account/avatar/00/11/fd/83/48cc0d83.jpg","comment_is_top":false,"comment_ctime":1616416715,"is_pvip":false,"discussion_count":1,"race_medal":0,"score":"1616416715","product_id":100023901,"comment_content":"ç¨‹åºçš„é¡ºåºæ€§è§„åˆ™çš„æè¿°ï¼Œä¸åº”è¯¥æ˜¯å•çº¿ç¨‹é‡Œï¼ŒæŒ‡ä»¤é‡æ‹åçš„ç»“æœä¸é¡ºåºæ‰§è¡Œç»“æœä¸€è‡´ä¹ˆ","like_count":0,"discussions":[{"author":{"id":2330905,"avatar":"https://static001.geekbang.org/account/avatar/00/23/91/19/6a3e7efc.jpg","nickname":"ç¨‹åºå‘˜9527","note":"","ucode":"1A1609F6BEAD84","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":378805,"discussion_content":"å°±æ˜¯å•çº¿ç¨‹ä¸‹çš„","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1623407735,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":284524,"user_name":"æ´›å¥‡","can_delete":false,"product_type":"c1","uid":1624355,"ip_address":"","ucode":"662B4005721119","user_header":"https://static001.geekbang.org/account/avatar/00/18/c9/23/76511858.jpg","comment_is_top":false,"comment_ctime":1616316027,"is_pvip":false,"replies":[{"id":"103332","content":"A a=new A()ï¼Œçœ‹ä¸Šå»å®ƒåœ¨è¯´açš„äº‹æƒ…ï¼Œä¸æ˜¯è¯´Aé‡Œé¢å±æ€§çš„å¯è§æ€§","user_name":"ä½œè€…å›å¤","user_name_real":"ç‹å®ä»¤","uid":"1269969","ctime":1616499875,"ip_address":"","comment_id":284524,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1616316027","product_id":100023901,"comment_content":"è‹±æ–‡æ–‡æ¡£çœ‹ä¸å¤§æ‡‚ã€‚&quot;Now, having said all of this, if, after a thread constructs an immutable object (that is, an object that only contains final fields), you want to ensure that it is seen correctly by all of the other thread, you still typically need to use synchronization. There is no other way to ensure, for example, that the reference to the immutable object will be seen by the second thread. &quot; ä¸çŸ¥é“è¿™å¥æ˜¯ä»€ä¹ˆæ„æ€ï¼Ÿè€å¸ˆè¿™èŠ‚è®²çš„çŸ¥è¯†ç‚¹ï¼Œèƒ½è§£é‡Šä¸Šä¸€èŠ‚è®²çš„åŒé‡æ£€æŸ¥æ³•å­˜åœ¨çš„é‚£ä¸ªnewå¯¹è±¡æ—¶æŒ‡ä»¤é‡æ’åºçš„é—®é¢˜å—ï¼Ÿ","like_count":0,"discussions":[{"author":{"id":1269969,"avatar":"https://static001.geekbang.org/account/avatar/00/13/60/d1/8efa89ab.jpg","nickname":"ç‹å®ä»¤","note":"","ucode":"4FE19F5BC32FCA","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":517377,"discussion_content":"A a=new A()ï¼Œçœ‹ä¸Šå»å®ƒåœ¨è¯´açš„äº‹æƒ…ï¼Œä¸æ˜¯è¯´Aé‡Œé¢å±æ€§çš„å¯è§æ€§","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1616499875,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":281604,"user_name":"é©¬ä»¥","can_delete":false,"product_type":"c1","uid":1344431,"ip_address":"","ucode":"3FEA06CA14DE28","user_header":"https://static001.geekbang.org/account/avatar/00/14/83/af/1cb42cd3.jpg","comment_is_top":false,"comment_ctime":1614824182,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1614824182","product_id":100023901,"comment_content":"è¯¾åæ€è€ƒé¢˜ï¼š<br>1:æŠŠabcç”¨volatileå…³é”®å­—ä¿®é¥°<br>2:æŠŠä¿®æ”¹abcå˜é‡çš„ä»£ç ç”¨synchronizedåŒ…è£¹<br>3:æŠŠä¿®æ”¹abcå˜é‡æ”¾åˆ°å­çº¿ç¨‹ä¸­ï¼Œç„¶åä½¿ç”¨join()æ–¹æ³•ä¿è¯å¯è§æ€§","like_count":0},{"had_liked":false,"id":280630,"user_name":"åˆ«å›å¤´","can_delete":false,"product_type":"c1","uid":2456052,"ip_address":"","ucode":"84DBC3A3F6B4B6","user_header":"https://static001.geekbang.org/account/avatar/00/25/79/f4/e48d897e.jpg","comment_is_top":false,"comment_ctime":1614299538,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1614299538","product_id":100023901,"comment_content":"è€å¸ˆï¼Œæˆ‘æœ‰ä¸€ä¸ªé—®é¢˜ï¼Œå¦‚æœä¸¤ä¸ªçº¿ç¨‹aå’Œbï¼Œaåœ¨æ‰§è¡Œxçš„èµ‹å€¼çš„æ—¶å€™ã€‚bå·²ç»æ‰§è¡Œåˆ°ifé‚£ä¸€è¡Œäº†ï¼Œé‚£åº”è¯¥è¾“å‡ºç»“æœå°±æ˜¯0å§","like_count":0},{"had_liked":false,"id":280583,"user_name":"å¦™æ‰‹ç©ºç©º","can_delete":false,"product_type":"c1","uid":1107573,"ip_address":"","ucode":"D295481D9BDA75","user_header":"https://static001.geekbang.org/account/avatar/00/10/e6/75/86c2a008.jpg","comment_is_top":false,"comment_ctime":1614253517,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1614253517","product_id":100023901,"comment_content":"Java volatile è§£é‡Šä¸ºç¦ç”¨ç¼“å­˜æ˜¯ä¸æ˜¯å¤ªç²—æš´äº†ï¼Ÿ","like_count":0},{"had_liked":false,"id":280517,"user_name":"gaozf","can_delete":false,"product_type":"c1","uid":1256951,"ip_address":"","ucode":"29B879542F24ED","user_header":"https://static001.geekbang.org/account/avatar/00/13/2d/f7/36abba57.jpg","comment_is_top":false,"comment_ctime":1614239619,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1614239619","product_id":100023901,"comment_content":"fina  aï¼›volatile aï¼›ç»“åˆ å¤§äº1.5ç‰ˆæœ¬çš„jdk","like_count":0},{"had_liked":false,"id":278803,"user_name":"Daniel","can_delete":false,"product_type":"c1","uid":1479124,"ip_address":"","ucode":"73EBE735898072","user_header":"https://static001.geekbang.org/account/avatar/00/16/91/d4/4a047e41.jpg","comment_is_top":false,"comment_ctime":1613355824,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1613355824","product_id":100023901,"comment_content":"è€å¸ˆï¼Œæˆ‘æƒ³è¯·æ•™ä¸€ä¸ªé—®é¢˜ã€‚<br>æ–‡ç« ä¸­æåˆ°volatileçš„ä½œç”¨æ˜¯ç¦æ­¢ç”¨CPUç¼“å­˜ï¼Œä¹Ÿå°±æ˜¯è¯´èµ·åˆ°å¯è§æ€§ä½œç”¨ï¼Œä½†æ˜¯ä¸èƒ½ä¿è¯åŸå­æ€§ï¼›<br><br>æˆ‘çœ‹tomcatä»£ç ä¸­å¾ˆå¤šåœ°æ–¹éƒ½ç”¨åˆ°äº†volatileï¼Œæ¯”å¦‚ï¼š<br>private volatile int keepAliveLeft = 100;<br>--keepAliveLeft;<br>ä¸ºä»€ä¹ˆè¿™é‡Œé€‰æ‹©volatileè€Œä¸é€‰æ‹©åŸå­ç±»ï¼Ÿvolatileè¿˜èƒ½å¤Ÿèµ·åˆ°å…¶ä»–ä»€ä¹ˆä½œç”¨å—ï¼Ÿ<br><br>ä»£ç åœ¨tomcatçš„SocketWrapperBaseä¸­ã€‚","like_count":0},{"had_liked":false,"id":275699,"user_name":"å•Šè‰¯æ¢“æ˜¯æˆ‘","can_delete":false,"product_type":"c1","uid":1655117,"ip_address":"","ucode":"E42FC1A60D331C","user_header":"https://static001.geekbang.org/account/avatar/00/19/41/4d/f6d6d13a.jpg","comment_is_top":false,"comment_ctime":1611648947,"is_pvip":true,"discussion_count":0,"race_medal":1,"score":"1611648947","product_id":100023901,"comment_content":"ä½¿ç”¨happens-before åŸåˆ™è¿›è¡Œä½œç­”ï¼›<br>1ï¼Œé¡ºåºæ€§åŸåˆ™+ä¼ é€’æ€§åŸåˆ™ï¼šåœ¨abcåé¢ æ·»åŠ ä¸€ä¸ªvolatile å˜é‡ ç„¶åå¦ä¸€ä¸ªçº¿ç¨‹ ä½¿ç”¨è€…è¿™ä¸ªå˜é‡ï¼Œå¯ä»¥æ‹¿åˆ° abc æœ€æ–°å˜é‡<br>2ï¼Œvolatileå˜é‡è§„åˆ™ï¼šç›´æ¥è®¾ç½®abc ä¸º volatile <br>3ï¼Œå…±äº«å˜é‡+çº¿ç¨‹startåŸåˆ™ï¼šå¦ä¸€ä¸ªçº¿ç¨‹åœ¨abc=3 ä¹‹å.start(é‡Œé¢è¯»abc)ï¼›<br>4ï¼Œå…±äº«å˜é‡+çº¿ç¨‹joinåŸåˆ™ï¼šå¦ä¸€ä¸ªçº¿ç¨‹ åœ¨ a.join ä¹‹åå†è¯»abc","like_count":0},{"had_liked":false,"id":275452,"user_name":"æ´›ä¹¦","can_delete":false,"product_type":"c1","uid":2421848,"ip_address":"","ucode":"4F1C41E4679879","user_header":"https://static001.geekbang.org/account/avatar/00/24/f4/58/383cd3a0.jpg","comment_is_top":false,"comment_ctime":1611547824,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1611547824","product_id":100023901,"comment_content":"æˆ‘è§‰å¾—å°±volatileæ˜¯åˆé€‚çš„ï¼Œå‰©ä¸‹ä¸¤ç§ï¼Œjoin,synchronizedå±äºè„‘ç­‹æ€¥è½¬å¼¯","like_count":0},{"had_liked":false,"id":275192,"user_name":"å¼ æ»”","can_delete":false,"product_type":"c1","uid":1322636,"ip_address":"","ucode":"87ABAFF0E861E0","user_header":"https://static001.geekbang.org/account/avatar/00/14/2e/8c/b261e15a.jpg","comment_is_top":false,"comment_ctime":1611380297,"is_pvip":false,"replies":[{"id":"99878","content":"ä¸ä¼šï¼Œfinalæ˜¯ä¸å¯å˜å˜é‡ï¼Œå¯ä»¥ä¼˜åŒ–æ€§èƒ½ï¼Œæ‰€ä»¥ä¸ä¼šç¦ç”¨ç¼“å­˜","user_name":"ä½œè€…å›å¤","user_name_real":"ç‹å®ä»¤","uid":"1269969","ctime":1611411475,"ip_address":"","comment_id":275192,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1611380297","product_id":100023901,"comment_content":"volatileä¼šç¦ç”¨CPUç¼“å­˜ï¼Œfinalä¼šå—ï¼Ÿ","like_count":0,"discussions":[{"author":{"id":1269969,"avatar":"https://static001.geekbang.org/account/avatar/00/13/60/d1/8efa89ab.jpg","nickname":"ç‹å®ä»¤","note":"","ucode":"4FE19F5BC32FCA","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":514253,"discussion_content":"ä¸ä¼šï¼Œfinalæ˜¯ä¸å¯å˜å˜é‡ï¼Œå¯ä»¥ä¼˜åŒ–æ€§èƒ½ï¼Œæ‰€ä»¥ä¸ä¼šç¦ç”¨ç¼“å­˜","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1611411475,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":263319,"user_name":"æ˜Ÿå¤œ","can_delete":false,"product_type":"c1","uid":1128491,"ip_address":"","ucode":"3B46C09D994CEB","user_header":"https://static001.geekbang.org/account/avatar/00/11/38/2b/9db9406b.jpg","comment_is_top":false,"comment_ctime":1606100570,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1606100570","product_id":100023901,"comment_content":"è¯¾åæ€è€ƒï¼šå‡è®¾çº¿ç¨‹Aä¸­æ‰§è¡Œabcèµ‹å€¼æ“ä½œï¼Œçº¿ç¨‹Bä¸­å¯¹abcè¯»å–<br>1.çº¿ç¨‹Aå‘ç”Ÿåœ¨çº¿ç¨‹Bä¹‹å‰ï¼Œè§„åˆ™2ï¼›<br>2.åœ¨çº¿ç¨‹Aä¸­èµ‹å€¼åå¯åŠ¨çº¿ç¨‹Bï¼›<br>3.åœ¨çº¿ç¨‹Bä¸­è°ƒç”¨çº¿ç¨‹Açš„joinï¼Œä¸”joinåè¿›è¡Œè¯»å–æ“ä½œï¼›<br>æ€»ä¹‹å°±æ˜¯ä¿è¯çº¿ç¨‹Aèµ‹å€¼æ“ä½œ happens-before çº¿ç¨‹Bçš„è¯»å–æ“ä½œã€‚","like_count":0},{"had_liked":false,"id":260972,"user_name":"è¶…çº§è›‹è›‹é¥­","can_delete":false,"product_type":"c1","uid":1249616,"ip_address":"","ucode":"AD2BECE789B365","user_header":"http://thirdwx.qlogo.cn/mmopen/vi_32/wiaQmkQdIh84RibSLrDkIA3HtibAR4IibpnP3VEmiaLzvpiaibXJQEb2LLUrCD4dM7DjvOFD65IbdZm2Mn68O71FxiaAow/132","comment_is_top":false,"comment_ctime":1605164430,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1605164430","product_id":100023901,"comment_content":"ä½¿ç”¨volatileä¿®é¥°å…±äº«å˜é‡ abcï¼Œå¹¶ä¸èƒ½ä¿è¯è¯»åˆ°çš„æ˜¯3ï¼Œè¿˜éœ€è¦ä¿è¯å†™æ“ä½œåœ¨è¯»æ“ä½œä¹‹å‰æ‰§è¡Œ","like_count":0},{"had_liked":false,"id":260945,"user_name":"Geek_c75d82","can_delete":false,"product_type":"c1","uid":2286012,"ip_address":"","ucode":"81202A016FC5D2","user_header":"","comment_is_top":false,"comment_ctime":1605159478,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1605159478","product_id":100023901,"comment_content":"ç¦ç”¨CPUç¼“å­˜å’Œç¦ç”¨ç¼–è¯‘å™¨ä¼˜åŒ–ï¼Œæ¥è§£å†³å¯è§æ€§å’Œæœ‰åºæ€§é—®é¢˜ã€‚volatile è§£å†³å¯è§æ€§ ,synchronized,final,éƒ½æ˜¯jdkè§£å†³æœ‰åºæ€§é—®é¢˜ï¼Œä¸ºäº†ä¿è¯æœ‰åºï¼Œç¼–è¯‘å™¨åšçš„ä¼˜åŒ–ï¼Œéœ€è¦éµå¾ªhappens-beforeåŸåˆ™ï¼Œå³ä¹‹å‰å‘ç”Ÿçš„å¯¹ä¹‹åå‘ç”Ÿçš„æ˜¯å¯è§çš„ã€‚","like_count":0},{"had_liked":false,"id":260911,"user_name":"Geek_c75d82","can_delete":false,"product_type":"c1","uid":2286012,"ip_address":"","ucode":"81202A016FC5D2","user_header":"","comment_is_top":false,"comment_ctime":1605150979,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1605150979","product_id":100023901,"comment_content":"1 è®¾ç½®å˜é‡valotile 2 æ§åˆ¶çº¿ç¨‹çš„æ‰§è¡Œé¡ºåºï¼Œå…ˆæ‰§è¡Œè®¾ç½®çº¿ç¨‹ï¼Œå†æ‰§è¡Œè¯»å–çº¿ç¨‹","like_count":0},{"had_liked":false,"id":253455,"user_name":"Wheres the Love?","can_delete":false,"product_type":"c1","uid":1439120,"ip_address":"","ucode":"8851FB40976AB0","user_header":"https://static001.geekbang.org/account/avatar/00/15/f5/90/e08bbe1f.jpg","comment_is_top":false,"comment_ctime":1602743661,"is_pvip":false,"replies":[{"id":"92657","content":"åç»­æ˜¯æ—¶é—´ä¸Šçš„ï¼Œæ—¶é—´ç‚¹å‰é¢çš„æ“ä½œå®Œæˆï¼Œæ—¶é—´ç‚¹åé¢çš„èƒ½çœ‹åˆ°ç»“æœ","user_name":"ä½œè€…å›å¤","user_name_real":"ç‹å®ä»¤","uid":"1269969","ctime":1602845731,"ip_address":"","comment_id":253455,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1602743661","product_id":100023901,"comment_content":"volatileè§„åˆ™ä¸­çš„â€œåç»­â€æ˜¯æŒ‡ä»€ä¹ˆå‘¢ï¼Œæ¯”å¦‚å…ˆè¯»v==trueï¼Œåå†™v=trueæ—¶ï¼Œå¦‚æœè¯»æ“ä½œè€—æ—¶æ¯”è¾ƒé•¿ï¼Œå…ˆå‘ç”Ÿçš„è¯»å¯èƒ½è§‚å¯Ÿåˆ°v==trueå—ï¼Ÿ","like_count":0,"discussions":[{"author":{"id":1269969,"avatar":"https://static001.geekbang.org/account/avatar/00/13/60/d1/8efa89ab.jpg","nickname":"ç‹å®ä»¤","note":"","ucode":"4FE19F5BC32FCA","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":507075,"discussion_content":"åç»­æ˜¯æ—¶é—´ä¸Šçš„ï¼Œæ—¶é—´ç‚¹å‰é¢çš„æ“ä½œå®Œæˆï¼Œæ—¶é—´ç‚¹åé¢çš„èƒ½çœ‹åˆ°ç»“æœ","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1602845731,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":253035,"user_name":"å¹³å‡¡çš„äºº","can_delete":false,"product_type":"c1","uid":1222818,"ip_address":"","ucode":"16F95555B92D0B","user_header":"https://static001.geekbang.org/account/avatar/00/12/a8/a2/cf7dd443.jpg","comment_is_top":false,"comment_ctime":1602573017,"is_pvip":false,"replies":[{"id":"92591","content":"ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½","user_name":"ä½œè€…å›å¤","user_name_real":"ç‹å®ä»¤","uid":"1269969","ctime":1602804217,"ip_address":"","comment_id":253035,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1602573017","product_id":100023901,"comment_content":"Synchronizedçš„ä½œç”¨ä¸»è¦æœ‰ä¸‰ä¸ªï¼š<br><br>åŸå­æ€§ï¼šç¡®ä¿çº¿ç¨‹äº’æ–¥çš„è®¿é—®åŒæ­¥ä»£ç ï¼›<br>å¯è§æ€§ï¼šä¿è¯å…±äº«å˜é‡çš„ä¿®æ”¹èƒ½å¤ŸåŠæ—¶å¯è§ï¼Œå…¶å®æ˜¯é€šè¿‡Javaå†…å­˜æ¨¡å‹ä¸­çš„ â€œå¯¹ä¸€ä¸ªå˜é‡unlockæ“ä½œä¹‹å‰ï¼Œå¿…é¡»è¦åŒæ­¥åˆ°ä¸»å†…å­˜ä¸­ï¼›å¦‚æœå¯¹ä¸€ä¸ªå˜é‡è¿›è¡Œlockæ“ä½œï¼Œåˆ™å°†ä¼šæ¸…ç©ºå·¥ä½œå†…å­˜ä¸­æ­¤å˜é‡çš„å€¼ï¼Œåœ¨æ‰§è¡Œå¼•æ“ä½¿ç”¨æ­¤å˜é‡å‰ï¼Œéœ€è¦é‡æ–°ä»ä¸»å†…å­˜ä¸­loadæ“ä½œæˆ–assignæ“ä½œåˆå§‹åŒ–å˜é‡å€¼â€ æ¥ä¿è¯çš„ï¼›<br>æœ‰åºæ€§ï¼šæœ‰æ•ˆè§£å†³é‡æ’åºé—®é¢˜ï¼Œå³ â€œä¸€ä¸ªunlockæ“ä½œå…ˆè¡Œå‘ç”Ÿ(happen-before)äºåé¢å¯¹åŒä¸€ä¸ªé”çš„lockæ“ä½œâ€ï¼›<br>ä»è¯­æ³•ä¸Šè®²ï¼ŒSynchronizedå¯ä»¥æŠŠä»»ä½•ä¸€ä¸ªénullå¯¹è±¡ä½œä¸º&quot;é”&quot;ï¼Œåœ¨HotSpot JVMå®ç°ä¸­ï¼Œé”æœ‰ä¸ªä¸“é—¨çš„åå­—ï¼šå¯¹è±¡ç›‘è§†å™¨ï¼ˆObject Monitorï¼‰ã€‚<br><br>Synchronizedæ€»å…±æœ‰ä¸‰ç§ç”¨æ³•ï¼š<br><br>å½“synchronizedä½œç”¨åœ¨å®ä¾‹æ–¹æ³•æ—¶ï¼Œç›‘è§†å™¨é”ï¼ˆmonitorï¼‰ä¾¿æ˜¯å¯¹è±¡å®ä¾‹ï¼ˆthisï¼‰ï¼›<br>å½“synchronizedä½œç”¨åœ¨é™æ€æ–¹æ³•æ—¶ï¼Œç›‘è§†å™¨é”ï¼ˆmonitorï¼‰ä¾¿æ˜¯å¯¹è±¡çš„Classå®ä¾‹ï¼Œå› ä¸ºClassæ•°æ®å­˜åœ¨äºæ°¸ä¹…ä»£ï¼Œå› æ­¤é™æ€æ–¹æ³•é”ç›¸å½“äºè¯¥ç±»çš„ä¸€ä¸ªå…¨å±€é”ï¼›<br>å½“synchronizedä½œç”¨åœ¨æŸä¸€ä¸ªå¯¹è±¡å®ä¾‹æ—¶ï¼Œç›‘è§†å™¨é”ï¼ˆmonitorï¼‰ä¾¿æ˜¯æ‹¬å·æ‹¬èµ·æ¥çš„å¯¹è±¡å®ä¾‹ï¼›<br>æ³¨æ„ï¼Œsynchronized å†…ç½®é” æ˜¯ä¸€ç§ å¯¹è±¡é”ï¼ˆé”çš„æ˜¯å¯¹è±¡è€Œéå¼•ç”¨å˜é‡ï¼‰ï¼Œä½œç”¨ç²’åº¦æ˜¯å¯¹è±¡ ï¼Œå¯ä»¥ç”¨æ¥å®ç°å¯¹ ä¸´ç•Œèµ„æºçš„åŒæ­¥äº’æ–¥è®¿é—® ï¼Œæ˜¯ å¯é‡å…¥ çš„ã€‚å…¶å¯é‡å…¥æœ€å¤§çš„ä½œç”¨æ˜¯é¿å…æ­»é”ï¼Œå¦‚ï¼š<br><br>å­ç±»åŒæ­¥æ–¹æ³•è°ƒç”¨äº†çˆ¶ç±»åŒæ­¥æ–¹æ³•ï¼Œå¦‚æ²¡æœ‰å¯é‡å…¥çš„ç‰¹æ€§ï¼Œåˆ™ä¼šå‘ç”Ÿæ­»é”ï¼›<br><br>","like_count":0,"discussions":[{"author":{"id":1269969,"avatar":"https://static001.geekbang.org/account/avatar/00/13/60/d1/8efa89ab.jpg","nickname":"ç‹å®ä»¤","note":"","ucode":"4FE19F5BC32FCA","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":506950,"discussion_content":"ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1602804217,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":249254,"user_name":"å¹³é£é€ é›¨","can_delete":false,"product_type":"c1","uid":1014349,"ip_address":"","ucode":"F9EE4704F31E22","user_header":"https://static001.geekbang.org/account/avatar/00/0f/7a/4d/b0228a1a.jpg","comment_is_top":false,"comment_ctime":1600526222,"is_pvip":true,"discussion_count":0,"race_medal":0,"score":"1600526222","product_id":100023901,"comment_content":"å…±äº«å˜é‡çš„æ–¹å¼å·®ä¸å¤šæœ‰è¿™äº›<br>1. volatile, è®¾ç½®abcä¸ºvolatileï¼Œæˆ–è€…å†™å…¥abcçš„å€¼åœ¨å¦å¤–ä¸€ä¸ªvolatileå˜é‡å†™å…¥å€¼ä¹‹å‰ã€‚<br>2. synchronized<br>3. è‡ªè¡Œæ˜¾ç¤ºåˆ›å»ºçš„è¯»å†™é”<br>4. åŸå­å˜é‡","like_count":0},{"had_liked":false,"id":247622,"user_name":"èšä¸é±¿é±¼","can_delete":false,"product_type":"c1","uid":1428043,"ip_address":"","ucode":"5DB98E406F1D3E","user_header":"https://static001.geekbang.org/account/avatar/00/15/ca/4b/c1ace3aa.jpg","comment_is_top":false,"comment_ctime":1599781639,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1599781639","product_id":100023901,"comment_content":"é«˜æ‰‹åœ¨æ°‘é—´","like_count":0},{"had_liked":false,"id":247217,"user_name":"è¥¿é—¨å¹ç‰›","can_delete":false,"product_type":"c1","uid":1508990,"ip_address":"","ucode":"E5D3624DDE1E83","user_header":"https://static001.geekbang.org/account/avatar/00/17/06/7e/735968e2.jpg","comment_is_top":false,"comment_ctime":1599635638,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1599635638","product_id":100023901,"comment_content":"ä¾‹å­ä¸­ï¼Œåœ¨jdk1.5ä¹‹å‰ï¼Œä¼šå‡ºç° x=0 çš„æƒ…å†µï¼Œæ˜¯å› ä¸ºï¼Œ1.5ä¹‹å‰ï¼Œæ²¡æœ‰çº¦æŸvolatile å˜é‡ çš„Happens-Before è§„åˆ™ï¼Œå¯¼è‡´x=42 ä¼šè¢«é‡æ’åºåˆ° v=true ä¹‹åï¼Œåœ¨1,5ä¹‹åï¼Œä¼šåœ¨v=true ä¹‹å‰æ’å…¥å†…å­˜å±éšœï¼Œä¿è¯x=42ä¸ä¼šè¢«é‡æ’åºåˆ°v=trueä¹‹åï¼Œè¿™æ ·ä¹Ÿå°±ä¿è¯äº†ï¼Œåªè¦è¯»åˆ°v=trueï¼Œé‚£ä¹ˆx=42çš„èµ‹å€¼å·²ç»å®Œæˆäº†ï¼Œå¹¶ä¸”å› ä¸ºvolatileçš„ä½œç”¨ï¼Œx=42ä¼šåŒæ­¥åˆ°å†…å­˜ï¼Œåˆ«çš„çº¿ç¨‹ä¹Ÿå°±èƒ½è¯»åˆ°x=42äº†","like_count":0},{"had_liked":false,"id":246712,"user_name":"å†¬å¤©é‡Œçš„æ‡’çŒ«","can_delete":false,"product_type":"c1","uid":1042458,"ip_address":"","ucode":"970E5CEF502828","user_header":"https://static001.geekbang.org/account/avatar/00/0f/e8/1a/cea701bb.jpg","comment_is_top":false,"comment_ctime":1599460009,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1599460009","product_id":100023901,"comment_content":"public class VolatileExample {<br><br>\tstatic  int x = 0;<br>\tstatic volatile boolean v = false;<br><br>\tpublic static void main(String[] args) {<br>\t\tThread t1 = new Thread(() -&gt; {<br>\t\t\tx = 42;<br>\t\t\tv = true;<br>\t\t});<br><br>\t\tThread t2 = new Thread(() -&gt; {<br>\t\t\tif(v == true){<br>\t\t\t\tSystem.out.println(x);<br>\t\t\t}else {<br>\t\t\t\tSystem.out.println(x);<br>\t\t\t}<br>\t\t});<br><br>\t\tt1.start();<br>\t\tt2.start();<br>\t\ttry {<br>\t\t\tt1.join();<br>\t\t\tt2.join();<br>\t\t} catch (InterruptedException e) {<br>\t\t\te.printStackTrace();<br>\t\t}<br>\t}<br>}<br>æˆ‘è¿™ä¸ªä»£ç ï¼Œè¿˜æ˜¯æœ‰å¯èƒ½è¾“å‡ºä¸º0å•Š","like_count":0},{"had_liked":false,"id":244747,"user_name":"é±¼ä¸¸ç²—é¢","can_delete":false,"product_type":"c1","uid":1785016,"ip_address":"","ucode":"B2F3F75B0D1422","user_header":"https://static001.geekbang.org/account/avatar/00/1b/3c/b8/9489387c.jpg","comment_is_top":false,"comment_ctime":1598664388,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1598664388","product_id":100023901,"comment_content":"1ã€ä½¿ç”¨volatileä¿®é¥° abc<br>2ã€å¯¹volatileçš„èµ‹å€¼åŠ ä¸Š synchronized<br>","like_count":0},{"had_liked":false,"id":244663,"user_name":"è¥¿é—¨å¹ç‰›","can_delete":false,"product_type":"c1","uid":1508990,"ip_address":"","ucode":"E5D3624DDE1E83","user_header":"https://static001.geekbang.org/account/avatar/00/17/06/7e/735968e2.jpg","comment_is_top":false,"comment_ctime":1598606506,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1598606506","product_id":100023901,"comment_content":"è¯¾åçš„é—®é¢˜ï¼Œä¸»è¦æ–¹æ³•ä»¥åŠæœ€å¸¸è§çš„æ–¹æ³•ï¼Œvolatile å’Œ final ä¿®é¥°å°±å¯","like_count":0},{"had_liked":false,"id":242060,"user_name":"fightingD","can_delete":false,"product_type":"c1","uid":1443637,"ip_address":"","ucode":"AD2876CED5D5AC","user_header":"http://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTKwViav94kcF50CxA0Jw7icicxociaVzut97iacy3b2ciacFqXuFWdiakVq304YcI8pt4HT5A1Yvp8EkYCpw/132","comment_is_top":false,"comment_ctime":1597579833,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1597579833","product_id":100023901,"comment_content":"1:ç”¨volatileå…³é”®å­—ä¿®é¥°<br>2:å¯¹å˜é‡èµ‹å€¼çš„ä»£ç å—ç”¨synchronizedæ‹¬èµ·æ¥<br>3ï¼šåœ¨èµ‹å€¼çº¿ç¨‹ä¸­è°ƒç”¨å¦å¤–çº¿ç¨‹çš„start()æ–¹æ³•<br>4ï¼šåœ¨çº¿ç¨‹ä¸­è°ƒç”¨èµ‹å€¼çº¿ç¨‹çš„join()æ–¹æ³•","like_count":0},{"had_liked":false,"id":240348,"user_name":"Geek5198","can_delete":false,"product_type":"c1","uid":2028945,"ip_address":"","ucode":"2BEBE6A39D9A0E","user_header":"","comment_is_top":false,"comment_ctime":1596873843,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1596873843","product_id":100023901,"comment_content":"ç¬¬5åˆ™çš„ä»£ç å»ºè®®è¿™æ ·<br>package base.newlive.lzm.currentThread;<br><br>import lombok.Data;<br><br>&#47;**<br> * @author lizeming02<br> * @date 2020&#47;8&#47;8<br> *&#47;<br>public class TestStart {<br><br>    public static void main(String[] args) {<br><br>        final Node a = new Node();<br><br>        Thread B = new Thread(() -&gt; {<br>            &#47;&#47; ä¸»çº¿ç¨‹è°ƒç”¨B.start()ä¹‹å‰<br>            &#47;&#47; æ‰€æœ‰å¯¹å…±äº«å˜é‡çš„ä¿®æ”¹ï¼Œæ­¤å¤„çš†å¯è§<br>            &#47;&#47; æ­¤ä¾‹ä¸­ï¼Œa==77<br>            System.out.println(a.getKey());<br>            System.out.println(a.getValue());<br>        });<br>        &#47;&#47; æ­¤å¤„å¯¹å…±äº«å˜é‡varä¿®æ”¹<br>        a.setKey(123);<br>        a.setValue(321);<br>        &#47;&#47; ä¸»çº¿ç¨‹å¯åŠ¨å­çº¿ç¨‹<br>        B.start();<br>    }<br>}<br>@Data<br>class Node{<br>    private int value;<br>    private int key;<br>}","like_count":0},{"had_liked":false,"id":239344,"user_name":"æ—","can_delete":false,"product_type":"c1","uid":1543907,"ip_address":"","ucode":"E1D26D1AB1B14D","user_header":"https://static001.geekbang.org/account/avatar/00/17/8e/e3/a9f4ed7f.jpg","comment_is_top":false,"comment_ctime":1596507526,"is_pvip":false,"replies":[{"id":"88468","content":"å¯è§æ€§æ˜¯æ”¹å®Œå˜é‡åï¼Œå…¶ä»–çº¿ç¨‹èƒ½ç«‹åˆ»çœ‹åˆ°ï¼Œä½ è¿™ä¸ªç¨‹åºå³ä¾¿è¾“å‡º1ï¼Œä¹Ÿä¸èƒ½è¯´æ˜å¯è§äº†","user_name":"ä½œè€…å›å¤","user_name_real":"ç‹å®ä»¤","uid":"1269969","ctime":1596546390,"ip_address":"","comment_id":239344,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1596507526","product_id":100023901,"comment_content":"è€å¸ˆå¥½ æœ€è¿‘åœ¨ä½¿ç”¨volatileæ—¶é‡åˆ°ä¸€äº›é—®é¢˜å¾ˆå›°æƒ‘<br>public class VolatileTest {<br>      static boolean flag = true;<br><br>        public static void main(String[] args) throws InterruptedException {<br>            new VolatileTest().test2();<br>            new VolatileTest().test();<br>    }<br><br>    private void test() throws InterruptedException {<br>        Thread t1 = new Thread(() -&gt; {<br>            while(flag){<br>            }<br>            System.out.println(1);<br>        });<br>        t1.start();<br>    }<br>    public void test2(){<br>        Thread t2 = new Thread(() -&gt; {<br>            flag = false;<br>        });<br>        t2.start();<br>    }<br>}<br>ä¸ºä»€ä¹ˆåœ¨å¤šä¸ªå¯¹è±¡ä¸­ åªç”¨staticå£°æ˜ä¹Ÿèƒ½è¾“å‡º1 ä¸ç”¨volatileå¥½åƒä¹Ÿä¿è¯äº†å¯è§æ€§","like_count":0,"discussions":[{"author":{"id":1269969,"avatar":"https://static001.geekbang.org/account/avatar/00/13/60/d1/8efa89ab.jpg","nickname":"ç‹å®ä»¤","note":"","ucode":"4FE19F5BC32FCA","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":503073,"discussion_content":"å¯è§æ€§æ˜¯æ”¹å®Œå˜é‡åï¼Œå…¶ä»–çº¿ç¨‹èƒ½ç«‹åˆ»çœ‹åˆ°ï¼Œä½ è¿™ä¸ªç¨‹åºå³ä¾¿è¾“å‡º1ï¼Œä¹Ÿä¸èƒ½è¯´æ˜å¯è§äº†","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1596546390,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":235515,"user_name":"å¢","can_delete":false,"product_type":"c1","uid":1542037,"ip_address":"","ucode":"B6A9F41AEE348C","user_header":"https://static001.geekbang.org/account/avatar/00/17/87/95/cba0a896.jpg","comment_is_top":false,"comment_ctime":1595070209,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1595070209","product_id":100023901,"comment_content":"è¯„è®ºåŒºè®©æˆ‘æ„è¯†åˆ°è‡ªå·±çš„æ¸ºå°ä¸ä¸è¶³","like_count":0},{"had_liked":false,"id":233308,"user_name":"Geek_2f3efa","can_delete":false,"product_type":"c1","uid":2059571,"ip_address":"","ucode":"A5F2BB67C94E60","user_header":"","comment_is_top":false,"comment_ctime":1594283853,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1594283853","product_id":100023901,"comment_content":"æŠŠè¿™ä¸ªä¸“æ ææ˜ç™½ï¼Œçœ‹ã€Šjava concurrency in practiceã€‹æ˜¯ä¸æ˜¯ä¼šå¥½å—ç‚¹äº†ï¼Ÿ","like_count":0},{"had_liked":false,"id":231813,"user_name":"sibyl","can_delete":false,"product_type":"c1","uid":1323652,"ip_address":"","ucode":"0D142011860D69","user_header":"","comment_is_top":false,"comment_ctime":1593775779,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1593775779","product_id":100023901,"comment_content":"æ›¾ç»ä¸€ç›´çº ç»“volatileçš„ç¦æ­¢é‡æ’åºçš„3æ¡è§„åˆ™:<br>volatileå†™å‰çš„ä»£ç ä¸èƒ½é‡æ’åº<br>volatileè¯»åçš„ä»£ç ä¸èƒ½é‡æ’åº<br>volatileå†™åvolatileè¯»ä¸èƒ½é‡æ’åº<br>å§‹ç»ˆåœ¨æ€è€ƒä¸ºä»€ä¹ˆä¼šæœ‰è¿™äº›è§„åˆ™ï¼Ÿæ²¡æœ‰è¿™äº›è§„åˆ™ä¼šæœ‰ä»€ä¹ˆé—®é¢˜ï¼Ÿå´ä¸€ç›´ä¸å¾—å…¶è§£ğŸ˜‚<br>å…¶å®è¿™ä¹ˆæ€è€ƒæ˜¯æœ¬æœ«å€’ç½®çš„ï¼Œè¯•å›¾ä»å®ç°æ¨åˆ°åŸå› ï¼Œå¦‚æœä»æ–‡ä¸­xçš„å€¼æ˜¯ä»€ä¹ˆï¼Ÿè¿™ä¸ªé—®é¢˜å‡ºå‘ï¼Œç„¶å<br>ç»“åˆhappens-beforeè§„åˆ™ï¼Œæœ€åå°±ä¼šæ˜ç™½volatileçš„æœ¬è´¨å°±æ˜¯è§£å†³xä¸ç¡®å®šçš„æ–¹æ³•ä¹‹ä¸€ï¼ï¼ï¼æˆ‘ä»¬ä¸éœ€è¦æ—¶åˆ»å»åˆ†æå“ªå¥ä»£ç å’Œå“ªå¥ä»£ç æ˜¯å¦èƒ½é‡æ’åºï¼Œ<br>è€Œæ˜¯é«˜å±‹å»ºç“´çš„æ ¹æ®happens-beforeè§„åˆ™å»æ€è€ƒå¤šçº¿ç¨‹çš„äº¤äº’æ˜¯å¦å…·æœ‰å¯è§æ€§ï¼Œæ¯”å¦‚æ–‡ä¸­ä»£ç æˆ‘ä»¬å¸Œæœ›å½“åˆ¤æ–­ä¸ºçœŸæ—¶ï¼Œå¯ä»¥ä½¿ç”¨å…¶ä»–çº¿ç¨‹è®¾ç½®çš„xå€¼è¿›è¡Œæ“ä½œï¼Œå¦‚æœä¸æ˜¯çœŸå°±å¿½ç•¥ç„¶åç»§ç»­å¾ªç¯ã€‚å› ä¸ºéœ€è¦ä½¿ç”¨xå€¼ï¼Œè€Œä¸”æ˜¯å…¶ä»–çº¿ç¨‹è®¾ç½®çš„xå€¼ï¼Œè¿™å°±å­˜åœ¨äº¤äº’äº†ï¼Œæ‰€ä»¥æˆ‘ä»¬éœ€è¦ç¡®è®¤è¿™ä¸ªçº¿ç¨‹è¿è¡Œåˆ°è¯»xçš„æ—¶å€™èƒ½ä¸èƒ½è§åˆ°å…¶ä»–çº¿ç¨‹è®¾ç½®çš„xå€¼ï¼Œæˆ–è€…å¦‚ä½•ä¿è¯èƒ½è§åˆ°ï¼Œä½¿ç”¨volatileå…³é”®å­—åˆ™æ˜¯ä¸€ä¸ªä¸é”™çš„é€‰æ‹©ã€‚<br><br>å†æ¯”å¦‚è¯´å¦‚æœreadä»£ç å¦‚ä¸‹<br>read(){<br><br>if(v)<br>  sout(&quot;hahahaha&quot;)<br>}<br><br><br>ç„¶ååœ¨å¤šçº¿ç¨‹ä¸­æ‰§è¡Œï¼Œæ‚¨è¯´è¿˜éœ€è¦ç»™vå¢åŠ volatileä¹ˆï¼Ÿç­”æ¡ˆæ˜¯æ˜¾è€Œæ˜“è§çš„ï¼Œæ‚¨è¯´è¿™æ—¶å€™å†çº ç»“è°å¯¹è°å¯è§è¿˜æœ‰æ„ä¹‰ä¹ˆï¼Ÿ<br><br><br>å…¶å®æ‰€æœ‰çš„happens  beforeè§„åˆ™éƒ½æ˜¯å¦‚æ­¤","like_count":0},{"had_liked":false,"id":229110,"user_name":"æœæ€»","can_delete":false,"product_type":"c1","uid":2046055,"ip_address":"","ucode":"C6600875A265E7","user_header":"","comment_is_top":false,"comment_ctime":1592899031,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1592899031","product_id":100023901,"comment_content":"happens-beforeè§„åˆ™ä¸­volatileåº•å±‚å®ç°æ„Ÿè§‰æ²¡è®²æ·±å…¥ï¼Œè¿˜æœ‰jmmè™½ç„¶æ˜¯è™šæ‹Ÿæ¨¡å‹ï¼Œåº•å±‚ä¹Ÿæ¶‰åŠåˆ°åº•å±‚å®ç°ï¼Œæ¯”å¦‚ç¼“å­˜ä¸€è‡´æ€§åè®®ï¼Œä¹Ÿæ²¡æœ‰æ·±å…¥","like_count":0},{"had_liked":false,"id":226679,"user_name":"ä½•å¦¨","can_delete":false,"product_type":"c1","uid":1385377,"ip_address":"","ucode":"EC3983BFF7992A","user_header":"https://static001.geekbang.org/account/avatar/00/15/23/a1/b08f3ee7.jpg","comment_is_top":false,"comment_ctime":1592184317,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1592184317","product_id":100023901,"comment_content":"<br>&#47;&#47; ä»¥ä¸‹ä»£ç æ¥æºäºã€å‚è€ƒ1ã€‘<br>class VolatileExample {<br>  int x = 0;<br>  volatile boolean v = false;<br>  public void writer() {<br>    x = 42;<br>    v = true;<br>  }<br>  public void reader() {<br>    if (v == true) {<br>      &#47;&#47; è¿™é‡Œxä¼šæ˜¯å¤šå°‘å‘¢ï¼Ÿ<br>    }<br>  }<br>}<br><br>è€å¸ˆæœ‰ä¸ªé—®é¢˜ï¼Œå…³äºæ–‡ä¸­è¿™ä¸ªäº‹ä¾‹ä»£ç ï¼Œwriter ä¸­æ ¹æ®é¡ºåºæ€§è§„åˆ™ï¼Œv=true ä¸€å®šå‘ç”Ÿäº x=42 ä¹‹åï¼Œé‚£ä¹ˆ reader ä¸­çš„ if è¯­å¥é‡Œä¸€å®šåˆ°çš„æ˜¯ 42 å§ï¼Ÿå¥½åƒè·Ÿ volatile å…³é”®å­—æ²¡ä»€ä¹ˆå…³ç³»å‘¢ï¼Ÿæˆ‘è¿™è¾¹å°è¯•è¿è¡Œäº†ä¸€ä¸‹æ„Ÿåˆ°æœ‰äº›ç–‘æƒ‘â€¦â€¦","like_count":0},{"had_liked":false,"id":226408,"user_name":"Today","can_delete":false,"product_type":"c1","uid":1236653,"ip_address":"","ucode":"E4ED6A78715512","user_header":"https://static001.geekbang.org/account/avatar/00/12/de/ad/7d8c568e.jpg","comment_is_top":false,"comment_ctime":1592065637,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1592065637","product_id":100023901,"comment_content":"è€å¸ˆè®²çš„å¥½æ£’ï¼Œé€šä¿—æ˜“æ‡‚","like_count":0},{"had_liked":false,"id":222514,"user_name":"å°å°ä»£ç ","can_delete":false,"product_type":"c1","uid":1290642,"ip_address":"","ucode":"F3D4E2C23FC9BD","user_header":"https://static001.geekbang.org/account/avatar/00/13/b1/92/f3dabcb1.jpg","comment_is_top":false,"comment_ctime":1590825514,"is_pvip":false,"replies":[{"id":"94098","content":"ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½","user_name":"ä½œè€…å›å¤","user_name_real":"ç‹å®ä»¤","uid":"1269969","ctime":1604407192,"ip_address":"","comment_id":222514,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1590825514","product_id":100023901,"comment_content":"æ€è€ƒé¢˜æƒ³åˆ°äº†ä»¥ä¸‹ä¸‰ç§æ–¹æ³•ï¼š<br>1.ä½¿ç”¨volatileä¿®é¥°ï¼Œç¦æ­¢CPUç¼“å­˜ï¼›<br>class Test {<br>    private volatile int abc;<br><br>    public void write() {<br>        abc = 3;<br>    }<br><br>    public int read() {<br>        return abc;<br>    }<br>}<br>2.ä½¿ç”¨synchronizedï¼ŒåŠ é”ï¼›<br>class Test1 {<br>    private int abc;<br><br>    public synchronized void write() {<br>        abc = 3;<br>    }<br><br>    public synchronized int read() {<br>        return abc;<br>    }<br>}<br>3.Happens-Beforeçš„ä¼ é€’æ€§è§„åˆ™ï¼›<br>class Test2 {<br>    private int abc;<br>    private volatile boolean x;<br><br>    public synchronized void write() {<br>        abc = 3;<br>        x = true;<br>    }<br><br>    public synchronized int read() {<br>        if (x == true) {<br><br>        }<br>        return abc;<br>    }<br>}","like_count":0,"discussions":[{"author":{"id":1269969,"avatar":"https://static001.geekbang.org/account/avatar/00/13/60/d1/8efa89ab.jpg","nickname":"ç‹å®ä»¤","note":"","ucode":"4FE19F5BC32FCA","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":496824,"discussion_content":"ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1604407192,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":220990,"user_name":"sky","can_delete":false,"product_type":"c1","uid":1008071,"ip_address":"","ucode":"9FE5F43055D3AB","user_header":"https://static001.geekbang.org/account/avatar/00/0f/61/c7/b64ac05e.jpg","comment_is_top":false,"comment_ctime":1590373217,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1590373217","product_id":100023901,"comment_content":"å¹³æ—¶æˆ‘ä»¬å†™ä»£ç çš„æ—¶å€™ x è¦ä¸è¦ä¹ŸåŠ ä¸Švolatileå‘¢ï¼Ÿè¿˜æ˜¯ä¾èµ–hapen before","like_count":0},{"had_liked":false,"id":213148,"user_name":"è§å—å±±","can_delete":false,"product_type":"c1","uid":1118111,"ip_address":"","ucode":"6A8BB82B7573CA","user_header":"https://static001.geekbang.org/account/avatar/00/11/0f/9f/f4b06bd5.jpg","comment_is_top":false,"comment_ctime":1588314656,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1588314656","product_id":100023901,"comment_content":"happens-beforeåŸåˆ™é’ˆå¯¹æ•°æ®åº”è¯¥æ˜¯å¼ºåˆ·ç¼“å­˜ï¼Œä¸å¯èƒ½åªé’ˆå¯¹æŸä¸ªå˜é‡ä»å†…å­˜è¯»ï¼Œå…¶ä»–å˜é‡åœ¨ç¼“å­˜ä¸­è¯»å–ã€‚åŒæ ·ç¦æ­¢æœ‰åºæ€§ï¼Œæ¯”å¦‚volatileå‰çš„å˜é‡ä¸å¯èƒ½æ’åºåˆ°åå»æ‰§è¡Œã€‚è¿™æ ·å¯¹äºcpuå†…å­˜æ¥è¯´æ˜¯æ²¡åŠæ³•æ“ä½œçš„ã€‚","like_count":0},{"had_liked":false,"id":213146,"user_name":"è§å—å±±","can_delete":false,"product_type":"c1","uid":1118111,"ip_address":"","ucode":"6A8BB82B7573CA","user_header":"https://static001.geekbang.org/account/avatar/00/11/0f/9f/f4b06bd5.jpg","comment_is_top":false,"comment_ctime":1588314389,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1588314389","product_id":100023901,"comment_content":"å¯è§æ€§æ˜¯ç”±äºç¼“å­˜å¼•å…¥çš„ï¼Œæœ‰åºæ€§æ˜¯ç¼–è¯‘ä¼˜åŒ–é€ æˆçš„ã€‚<br>è§£å†³å¯¹åº”çš„é—®é¢˜è‡ªç„¶æ˜¯æŒ‰éœ€ç¦æ­¢ç¼“å­˜å’Œä¼˜åŒ–ã€‚æä¾›ç»™ç¨‹åºå‘˜çš„è‡ªç„¶æ˜¯javaå†…å­˜æ¨¡å‹çš„è§„èŒƒã€‚å…·ä½“å°±æ˜¯synchronize volatile finalä»¥åŠhappens-beforeåŸåˆ™ï¼Œå³å…ˆå‘ç”Ÿå¯¹åå‘ç”Ÿå…±äº«å˜é‡çš„å¯è§æ€§ã€‚volatile synchronize start join ç¨‹åºæœ‰åºæ€§  æ„é€ å‡½æ•°å¯¹ææ„å‡½æ•° ä¸­æ–­å¯è§æ€§ç­‰happens-beforeåŸåˆ™","like_count":0},{"had_liked":false,"id":210207,"user_name":"M","can_delete":false,"product_type":"c1","uid":1810576,"ip_address":"","ucode":"06F26E1D62E9C9","user_header":"https://wx.qlogo.cn/mmopen/vi_32/eLNeJNaEkwGSK7xvtamMibVLMy2MpbIqX3iaEhT7JtSnTRMRTwZ2j4HX7WAapiashbiaBDVriaXKSP0Oeic6ZAEVEXag/132","comment_is_top":false,"comment_ctime":1587697480,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1587697480","product_id":100023901,"comment_content":"å½“æˆ‘çœ‹å®Œç¬¬ä¸€å¤§æ¨¡å—æ—¶ï¼Œæ‰æ˜ç™½happens-beforeä¸­çš„çº¿ç¨‹join()è§„åˆ™ã€‚å¾ˆå¤šçŸ¥è¯†åˆæ¬¡è®¤è¯†æ—¶å¯èƒ½æ¯”è¾ƒé™Œç”Ÿã€ä¸å¥½ç†è§£ï¼Œç­‰ä½ æŠŠæ•´å—ç†è§£å·®ä¸å¤šæ—¶ï¼Œå†å›å¤´çœ‹ï¼Œä¼šå‘ç°å…¶ä¸­çš„é“ç†ï¼Œå“‡ï¼ŒåŸæ¥æ˜¯è¿™æ ·ã€‚<br>å°±å½“ç”Ÿæ´»ä¸­é‡åˆ°äº†é—®é¢˜ï¼Œæš‚æ—¶è¿·å¤±è‡ªå·±ï¼Œéœ€è¦å‡ºå»èµ°èµ°ï¼Œæ•£æ•£å¿ƒï¼Œå›å¤´å°±ä¼šé‡æ–°è®¤è¯†è‡ªå·±ï¼","like_count":0},{"had_liked":false,"id":209527,"user_name":"NLand","can_delete":false,"product_type":"c1","uid":1172759,"ip_address":"","ucode":"07F7AE58EC68C3","user_header":"https://static001.geekbang.org/account/avatar/00/11/e5/17/084dc246.jpg","comment_is_top":false,"comment_ctime":1587563821,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1587563821","product_id":100023901,"comment_content":"èƒ½å¦åƒè€å¸ˆä¸¾çš„æ —å­ä¸€æ ·ï¼Œä½¿ç”¨è§„åˆ™ä¸€ã€äºŒã€ä¸‰ç»„åˆï¼Œä½¿å¾—å…±äº«å˜é‡ abcï¼Œåœ¨writeçº¿ç¨‹é‡Œè®¾ç½®äº† abc çš„å€¼ abc=3ï¼Œreadçº¿ç¨‹èƒ½å¤Ÿçœ‹åˆ°abc=3?è¿™æ ·åº”è¯¥ä¹Ÿå¯ä»¥å§ï¼Ÿ","like_count":0},{"had_liked":false,"id":209517,"user_name":"è§å—å±±","can_delete":false,"product_type":"c1","uid":1118111,"ip_address":"","ucode":"6A8BB82B7573CA","user_header":"https://static001.geekbang.org/account/avatar/00/11/0f/9f/f4b06bd5.jpg","comment_is_top":false,"comment_ctime":1587562343,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1587562343","product_id":100023901,"comment_content":"åˆ©ç”¨volatileçš„å¯è§æ€§é€‰æ‹©ï¼Œvolatile int abcï¼Œå¯¹volatileçš„å˜é‡ä¿®æ”¹èƒ½å¤Ÿä¿è¯åç»­çº¿ç¨‹è®¿é—®å˜é‡æ—¶è¯»å–åˆ°abcçš„å€¼ï¼Œåˆ©ç”¨synchronizeçš„å¯è§æ€§åŸåˆ™ï¼Œå¯¹abcçš„ä¿®æ”¹å’Œè¯»å–åŠ é”ã€‚<br>æ–‡ä¸­å¯¹volatileéƒ¨åˆ†çš„ä¾‹å­æ„Ÿè§‰æœ‰ç‚¹å¥‡æ€ªï¼Œåˆ©ç”¨ä¼ é€’æ€§å’Œvolatileçš„å¯è§æ€§éƒ¨åˆ†ï¼Œåº”è¯¥æ˜¯volatileå†™ä¹‹å‰çš„æ‰€æœ‰æ•°æ®å¯¹volatileçš„è¯»çš„æ‰€æœ‰æ•°æ®éƒ½å¯è§ã€‚åˆ©ç”¨ä¼ é€’æ€§æ„Ÿè§‰ä¸æ˜¯å¾ˆå¯¹ï¼ŒæŒ‡çš„æ˜¯volatileå†™å’Œå®ƒä¹‹å‰çš„å˜é‡æ“ä½œ  ä¸  volatileè¯»ä¸å®ƒåç»­çš„æ“ä½œçš„å¯è§æ€§ï¼Œä½†æ˜¯åœ¨volatileä¹‹å‰æ˜¯å¯ä»¥ä¼˜åŒ–æ’åºçš„ã€‚ç¨‹åºçš„æœ‰åºæ€§æŒ‡çš„æ˜¯å˜é‡é—´æœ‰ä¾èµ–å…³ç³»æ—¶æœ‰è¿™ç§ç¨‹åºæœ‰åºä¸èƒ½é‡æ’ã€‚","like_count":0},{"had_liked":false,"id":208966,"user_name":"THROW","can_delete":false,"product_type":"c1","uid":1112141,"ip_address":"","ucode":"A3C089A8F5F941","user_header":"https://static001.geekbang.org/account/avatar/00/10/f8/4d/4b748ff1.jpg","comment_is_top":false,"comment_ctime":1587474912,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1587474912","product_id":100023901,"comment_content":"è€å¸ˆæ‚¨å¥½ï¼Œè¯·æ•™æ‚¨ä¸‹æˆ‘çš„ç†è§£å¯¹ä¸å¯¹ï¼Ÿï¼šåœ¨å•æ ¸CPUæœºå™¨ä¿è¯åŸå­æ€§å°±å¯ä»¥ä¿è¯çº¿ç¨‹å®‰å…¨ï¼Œåœ¨å¤šæ ¸CPUæœºå™¨å› ä¸ºCPUç¼“å­˜çš„åŸå› éœ€è¦åŒæ—¶ä¿è¯åŸå­æ€§å’Œå¯è§æ€§æ‰èƒ½ä¿è¯çº¿ç¨‹å®‰å…¨","like_count":0},{"had_liked":false,"id":207182,"user_name":"looper","can_delete":false,"product_type":"c1","uid":1238396,"ip_address":"","ucode":"DA4BCE83836C04","user_header":"https://static001.geekbang.org/account/avatar/00/12/e5/7c/2a5a418b.jpg","comment_is_top":false,"comment_ctime":1587021372,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1587021372","product_id":100023901,"comment_content":"ä½¿ç”¨volatileå…³é”®å­—ï¼Œä¿è¯å¯è§æ€§","like_count":0},{"had_liked":false,"id":202265,"user_name":"Siping","can_delete":false,"product_type":"c1","uid":1487971,"ip_address":"","ucode":"48E685333C663D","user_header":"https://static001.geekbang.org/account/avatar/00/16/b4/63/21902253.jpg","comment_is_top":false,"comment_ctime":1585949928,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1585949928","product_id":100023901,"comment_content":"ä»¥å‰åšæ•°æ®åº“çš„ï¼Œä½†æœ€è¿‘å¤©å¤© CRUDï¼Œå¥½ä¹…æ²¡çœ‹åŸºç¡€ç†è®ºäº†ã€‚å’‹æ„Ÿè§‰è¿˜æœ‰ç‚¹æ¨¡å¼äº†","like_count":0},{"had_liked":false,"id":201950,"user_name":"ä¸¹è¯š","can_delete":false,"product_type":"c1","uid":1520747,"ip_address":"","ucode":"001E93D6619F81","user_header":"https://static001.geekbang.org/account/avatar/00/17/34/6b/9119192e.jpg","comment_is_top":false,"comment_ctime":1585880801,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1585880801","product_id":100023901,"comment_content":"è¿™æ— éå®ç°å…±äº«å˜é‡çš„å¯è§æ€§ï¼Œåªè¦æˆ‘è®¾ç½®cpu ç¼“å­˜å¤±æ•ˆï¼Œè®©å…¶ä»–çº¿ç¨‹å»åŠ è½½ä¸»å†…å­˜çš„æ•°æ®å°±å¥½ã€‚é‚£ä¹ˆæˆ‘å¯ä»¥åˆ©ç”¨volatileï¼Œsynchronizedï¼Œä»¥åŠå·§å¦™åˆ©ç”¨Happens-Before è§„åˆ™é‡Œçš„A.JOIN()ã€‚","like_count":0},{"had_liked":false,"id":201567,"user_name":"M","can_delete":false,"product_type":"c1","uid":1810576,"ip_address":"","ucode":"06F26E1D62E9C9","user_header":"https://wx.qlogo.cn/mmopen/vi_32/eLNeJNaEkwGSK7xvtamMibVLMy2MpbIqX3iaEhT7JtSnTRMRTwZ2j4HX7WAapiashbiaBDVriaXKSP0Oeic6ZAEVEXag/132","comment_is_top":false,"comment_ctime":1585804575,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1585804575","product_id":100023901,"comment_content":"è€å¸ˆï¼Œæƒ³è¯·æ•™ä¸ªé—®é¢˜ï¼Œ<br>1.mintor GCæ˜¯ä½œç”¨æ˜¯æ•´ä¸ªæ–°ç”Ÿä»£è¿˜æ˜¯ä»…ä¼Šç”¸å›­åŒºå‘¢ï¼Ÿ<br>2.synchronizedå†™åœ¨æ–¹æ³•ä¸Šæ˜¯å¯¹è±¡çº§åˆ«çš„é”ä¹ˆï¼Ÿ","like_count":0},{"had_liked":false,"id":198705,"user_name":"Geek_c22199","can_delete":false,"product_type":"c1","uid":1441876,"ip_address":"","ucode":"1CE5B65513E360","user_header":"http://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTI2vn8hyjICTCletGs0omz28lhriaZKX2XX9icYzAEon2IEoRnlXqyOia2bEPP0j7T6xexTnr77JJic8w/132","comment_is_top":false,"comment_ctime":1585464925,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1585464925","product_id":100023901,"comment_content":"æ¥ç€ä¸Šä¸ªï¼Œå¤šçº¿ç¨‹å‚æ•°ä¼šåŠ finally å­—æ®µä¿®é¥°ä¿è¯å¼•ç”¨ä¸å¯å˜ã€‚å¼•ç”¨å¯¹è±¡çš„å±æ€§å¦‚æœæ˜¯å¼•ç”¨å¯¹è±¡ä½†æ²¡æœ‰åŠ volatile å­—æ®µè‡ªç„¶æ˜¯ä¸èƒ½ä¿è¯ä¿®æ”¹å¯è§çš„","like_count":0},{"had_liked":false,"id":198695,"user_name":"Geek_c22199","can_delete":false,"product_type":"c1","uid":1441876,"ip_address":"","ucode":"1CE5B65513E360","user_header":"http://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTI2vn8hyjICTCletGs0omz28lhriaZKX2XX9icYzAEon2IEoRnlXqyOia2bEPP0j7T6xexTnr77JJic8w/132","comment_is_top":false,"comment_ctime":1585464383,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1585464383","product_id":100023901,"comment_content":"å¼•ç”¨ç±»å‹å˜é‡ä¸ŠåŠ volatile å­—æ®µæ˜¯åªæœ‰è¯¥å¼•ç”¨è¢«æ”¹å˜çš„æ—¶å€™æ‰æœ‰æ•ˆå—ï¼Ÿå¦‚æœä»…æ”¹å˜å¯¹è±¡å±æ€§ï¼Œåº”è¯¥æ˜¯ä¸å¯è§çš„ï¼Œæ¯•ç«Ÿå¦‚æœå¯¹è±¡å±æ€§ä¸Šæ²¡æœ‰åŠ çš„è¯ï¼Œæ˜¯ä¸èƒ½ä¿è¯å¯è§æ€§çš„","like_count":0},{"had_liked":false,"id":196839,"user_name":"å­¦ä¸ªçƒ","can_delete":false,"product_type":"c1","uid":1019725,"ip_address":"","ucode":"7343F3C0CA981D","user_header":"https://static001.geekbang.org/account/avatar/00/0f/8f/4d/65fb45e6.jpg","comment_is_top":false,"comment_ctime":1585316864,"is_pvip":false,"replies":[{"id":"75068","content":"ä½ å¯ä»¥ç®€å•ç†è§£ä¸ºæ²¡æœ‰ä¸­é—´ç¼“å­˜ï¼Œæ‰€ä»¥è°æœ€åå†™å°±è®¤è°","user_name":"ä½œè€…å›å¤","user_name_real":"ç‹å®ä»¤","uid":"1269969","ctime":1585631293,"ip_address":"","comment_id":196839,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1585316864","product_id":100023901,"comment_content":"ç‹è€å¸ˆæ‚¨å¥½ï¼Œå¯¹äº volatile å˜é‡çš„ä½¿ç”¨æˆ‘ä¸€ç›´æœ‰ä¸€ä¸ªç–‘æƒ‘ã€‚<br><br>æ¯”å¦‚ volatile ä¸€ä¸ªå˜é‡ xã€‚ç„¶ååŒæ—¶æœ‰ä¸¤ä¸ªçº¿ç¨‹ A å’Œ B åœ¨åŒæ—¶å†™ x çš„å€¼ï¼ŒA å’Œ B éƒ½è¿˜æ²¡æ¥å¾—åŠæŠŠç»“æœå†™å›ä¸»å­˜ã€‚<br><br>æˆ‘çš„ç–‘æƒ‘æ˜¯ï¼šåœ¨ A å’Œ B éƒ½æ“ä½œå®Œï¼ŒåŒæ—¶å†™å›ä¸»å­˜çš„æ—¶å€™ï¼Ÿä¼šè®¤å“ªä¸ªå€¼å‘¢ï¼Ÿè¿˜æ˜¯è¯´åŒæ—¶åªèƒ½æœ‰ä¸€ä¸ªçº¿ç¨‹åœ¨å†™ volatile å˜é‡ï¼Ÿé‚£è¿™ä¸æ˜¯é”çš„æ¦‚å¿µå—ï¼Ÿï¼ˆæˆ‘è¿™é‡Œæ˜¯å¯¹å•ä¸ª volatile å˜é‡è¿›è¡Œå†™æ“ä½œï¼Œå¹¶ä¸æ˜¯å¤åˆæ“ä½œã€‚ï¼‰","like_count":0,"discussions":[{"author":{"id":1269969,"avatar":"https://static001.geekbang.org/account/avatar/00/13/60/d1/8efa89ab.jpg","nickname":"ç‹å®ä»¤","note":"","ucode":"4FE19F5BC32FCA","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":489402,"discussion_content":"ä½ å¯ä»¥ç®€å•ç†è§£ä¸ºæ²¡æœ‰ä¸­é—´ç¼“å­˜ï¼Œæ‰€ä»¥è°æœ€åå†™å°±è®¤è°","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1585631293,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":196518,"user_name":"è‹æš®æ²‰è§","can_delete":false,"product_type":"c1","uid":1577580,"ip_address":"","ucode":"532B816D4EF47B","user_header":"https://static001.geekbang.org/account/avatar/00/18/12/6c/61a598e9.jpg","comment_is_top":false,"comment_ctime":1585289161,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1585289161","product_id":100023901,"comment_content":"å…±äº«å˜é‡ï¼Œå› ä¸ºåœ¨ä¸€ä¸ªçº¿ç¨‹ä¸­èƒ½è®¾ç½®ä¸º3ï¼Œè¯´æ˜ä¸æ˜¯finalçš„ã€‚è¦æƒ³è®©å…¶ä»–çº¿ç¨‹çœ‹åˆ°ï¼Œå¯ä»¥æœ‰ä»¥ä¸‹å‡ ç§æ–¹å¼ï¼š<br>1ã€ä½¿ç”¨volatileä¿®é¥°è¿™ä¸ªå˜é‡ã€‚<br>2ã€åœ¨å†™è¿™ä¸ªå˜é‡çš„å‰ååŠ é”ã€‚<br>3ã€çº¿ç¨‹ä¿®æ”¹å®Œåï¼Œä½¿ç”¨join()","like_count":0},{"had_liked":false,"id":194885,"user_name":"bin.chen","can_delete":false,"product_type":"c1","uid":1135604,"ip_address":"","ucode":"5BA49358AB8A1A","user_header":"https://static001.geekbang.org/account/avatar/00/11/53/f4/e277325d.jpg","comment_is_top":false,"comment_ctime":1585116028,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1585116028","product_id":100023901,"comment_content":"æº¢å‡ºåº”è¯¥æ˜¯å¯¹è±¡è¿˜æ²¡æœ‰æ„é€ å®Œæˆå°±è®©ä½¿ç”¨è€…ä½¿ç”¨äº†è¯¥å¯¹è±¡é€ æˆçš„ï¼›è§£å†³æ–¹æ¡ˆå°±æ˜¯é¿å…åœ¨æ„é€ å‡½æ•°å†…è®©å¤–éƒ¨å¯¹è±¡ä½¿ç”¨é¿å…æ³„æ¼","like_count":0},{"had_liked":false,"id":190893,"user_name":"å¤§é¥¶Raysir","can_delete":false,"product_type":"c1","uid":1589208,"ip_address":"","ucode":"0AFA191420A30D","user_header":"http://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTITcwicqBDYzXtLibUtian172tPs7rJpqG1Vab4oGjnguA9ziaYjDCILSGaS6qRiakvRdUEhdmSG0BGPKw/132","comment_is_top":false,"comment_ctime":1584706161,"is_pvip":false,"replies":[{"id":"73434","content":"ç»å…¸ä¹¦é€šä¿—çš„ä¸å¤šğŸ˜„","user_name":"ä½œè€…å›å¤","user_name_real":"ç‹å®ä»¤","uid":"1269969","ctime":1584792559,"ip_address":"","comment_id":190893,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1584706161","product_id":100023901,"comment_content":"ä¸&lt;javaå¹¶å‘ç¼–ç¨‹å®æˆ˜&gt;ä¸€ä¹¦ç›¸å¾—ç›Šå½°ï¼Œä¹¦çš„è¯‘æœ¬è¯»èµ·æ¥å¤ªç”Ÿç¡¬ç”Ÿæ¶©ï¼Œè€å¸ˆè®²çš„å°±é€šä¿—æ˜“æ‡‚çš„å¤šäº†","like_count":0,"discussions":[{"author":{"id":1269969,"avatar":"https://static001.geekbang.org/account/avatar/00/13/60/d1/8efa89ab.jpg","nickname":"ç‹å®ä»¤","note":"","ucode":"4FE19F5BC32FCA","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":488074,"discussion_content":"ç»å…¸ä¹¦é€šä¿—çš„ä¸å¤šğŸ˜„","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1584792559,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":186469,"user_name":"cysğŸ˜","can_delete":false,"product_type":"c1","uid":1179742,"ip_address":"","ucode":"01A0097B8C4876","user_header":"https://static001.geekbang.org/account/avatar/00/12/00/5e/39db0db9.jpg","comment_is_top":false,"comment_ctime":1583849204,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1583849204","product_id":100023901,"comment_content":"è€å¸ˆï¼Œçº¿ç¨‹ä¸­æ–­è§„åˆ™æ€ä¹ˆç†è§£ï¼Œå¯ä»¥è¯¦ç»†ä¸¾ä¸ªä¾‹å­å—","like_count":0},{"had_liked":false,"id":185515,"user_name":"Daiver","can_delete":false,"product_type":"c1","uid":1466447,"ip_address":"","ucode":"9B1A03AFBC79BC","user_header":"https://static001.geekbang.org/account/avatar/00/16/60/4f/db0e62b3.jpg","comment_is_top":false,"comment_ctime":1583597451,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1583597451","product_id":100023901,"comment_content":"è€å¸ˆï¼Œä¸ºä»€ä¹ˆé€ƒé€¸äº†ï¼Œglobal.objè¯»å–åˆ°xçš„å€¼ä¼šæ˜¯0å‘¢ï¼Ÿ","like_count":0},{"had_liked":false,"id":183841,"user_name":"Airsaid","can_delete":false,"product_type":"c1","uid":1115302,"ip_address":"","ucode":"5B90BC0044F376","user_header":"https://static001.geekbang.org/account/avatar/00/11/04/a6/18c4f73c.jpg","comment_is_top":false,"comment_ctime":1583144430,"is_pvip":false,"replies":[{"id":"71259","content":"è¿‡å¥–äº†ğŸ˜„","user_name":"ä½œè€…å›å¤","user_name_real":"ç‹å®ä»¤","uid":"1269969","ctime":1583234661,"ip_address":"","comment_id":183841,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1583144430","product_id":100023901,"comment_content":"è€å¸ˆè®²çš„æ˜¯çœŸçš„å¥½ï¼Œä»åº•å±‚å¼€å§‹è®²èµ·ï¼Œå¾ªåºæ¸è¿›ï¼Œç»“åˆä¸€äº›å°ä¾‹å­å¾ˆå®¹æ˜“ç†è§£ã€‚ä¹‹å‰çœ‹ã€ŠJava å¹¶å‘ç¼–ç¨‹å®æˆ˜ã€‹ä¸€ä¹¦ï¼ŒJava å†…å­˜æ¨¡å‹æ˜¯æœ€åä¸€ç« æ‰è®²ï¼Œçœ‹å®Œæœ‰äº›çç¢ï¼Œå†ç»“åˆè€å¸ˆçš„ä¸“æ çœ‹ï¼Œæ„Ÿè§‰çŸ¥è¯†ç‚¹éƒ½ä¸²è”èµ·æ¥äº†ã€‚","like_count":0,"discussions":[{"author":{"id":1269969,"avatar":"https://static001.geekbang.org/account/avatar/00/13/60/d1/8efa89ab.jpg","nickname":"ç‹å®ä»¤","note":"","ucode":"4FE19F5BC32FCA","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":485795,"discussion_content":"è¿‡å¥–äº†ğŸ˜„","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1583234661,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":183796,"user_name":"Airsaid","can_delete":false,"product_type":"c1","uid":1115302,"ip_address":"","ucode":"5B90BC0044F376","user_header":"https://static001.geekbang.org/account/avatar/00/11/04/a6/18c4f73c.jpg","comment_is_top":false,"comment_ctime":1583136558,"is_pvip":false,"replies":[{"id":"71261","content":"æ˜¯çš„ï¼Œä¸åŒ…æ‹¬jvmçš„å®ç°äººå‘˜","user_name":"ä½œè€…å›å¤","user_name_real":"ç‹å®ä»¤","uid":"1269969","ctime":1583234714,"ip_address":"","comment_id":183796,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1583136558","product_id":100023901,"comment_content":"ã€ŒHappens-Before è§„åˆ™åº”è¯¥æ˜¯ Java å†…å­˜æ¨¡å‹é‡Œé¢æœ€æ™¦æ¶©çš„å†…å®¹äº†ï¼Œå’Œç¨‹åºå‘˜ç›¸å…³çš„è§„åˆ™ä¸€å…±æœ‰å¦‚ä¸‹å…­é¡¹ï¼Œéƒ½æ˜¯å…³äºå¯è§æ€§çš„ã€‚ã€<br><br>æ‚¨å¥½è€å¸ˆï¼Œè¿™é‡Œçš„ç¨‹åºå‘˜æŒ‡çš„æ˜¯å¹¶å‘ç¨‹åºçš„å¼€å‘äººå‘˜æ˜¯å—ï¼Ÿä¸åŒ…æ‹¬ JVM çš„å®ç°äººå‘˜ï¼Ÿ","like_count":0,"discussions":[{"author":{"id":1269969,"avatar":"https://static001.geekbang.org/account/avatar/00/13/60/d1/8efa89ab.jpg","nickname":"ç‹å®ä»¤","note":"","ucode":"4FE19F5BC32FCA","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":485781,"discussion_content":"æ˜¯çš„ï¼Œä¸åŒ…æ‹¬jvmçš„å®ç°äººå‘˜","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1583234714,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":179599,"user_name":"Geek_bb89c3","can_delete":false,"product_type":"c1","uid":1331828,"ip_address":"","ucode":"0F97B5B0F2DDD6","user_header":"http://thirdwx.qlogo.cn/mmopen/vi_32/IZKGetBZDuMEa2VwwtesTELvLORIyV749ItgfAqNPv30n4zEv71wuGNr1aNVIVltG0icvH53DHDuqPuzNpiauWAg/132","comment_is_top":false,"comment_ctime":1582037192,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1582037192","product_id":100023901,"comment_content":"javaå†…å­˜æ¨¡å‹ï¼šå¼•èµ·å¤šçº¿ç¨‹å˜åŒ–çš„åŸå› æœ‰ä¸‰ä¸ªã€‚å†…å­˜å¯è§æ€§ï¼ŒåŸå­æ€§ï¼Œé¡ºåºæ€§ã€‚å…¶ä¸­åŸå­æ€§æ˜¯é«˜çº§è¯­è¨€å’Œä½çº§è¯­è¨€ä¹‹é—´çš„è½¬æ¢ã€‚<br>å†…å­˜å¯è§æ€§å’Œé¡ºåºæ€§å¯ä»¥é€šè¿‡happen-beforeæ¥è§£å†³ã€‚happen-beforeä¸»è¦è¡¨ç¤ºåŸå› ä¸€å®šåœ¨ç»“æœä¹‹å‰ã€‚ä¸»è¦è¡¨ç°æ˜¯ï¼š<br>      1.åœ¨ç¨‹åºä¸­å…±æœ‰å‰åä¾èµ–å…³ç³»çš„é¡ºåºä¸å˜ã€‚<br>      2.volatileä¿®é¥°çš„å˜é‡ç¦ç”¨ç¼“å­˜ã€‚å°±æ˜¯æ‰€æœ‰åœ¨cpuè¯»å†™éƒ½ç›´æ¥åœ¨å†…å­˜ä¸­ã€‚<br>      3.volatileä¾èµ–çš„ä¼ é€’æ€§ï¼Œå°±æ˜¯å¦‚æœåœ¨volitaleä¿®æ”¹ä¸ºæŸä¸€ä¸ªçŠ¶æ€ä¹‹å‰ï¼Œçš„çŠ¶æ€ã€‚å¦‚æœå¦å¤–ä¸€ä¸ªçº¿ç¨‹è¯»åˆ°äº†voltaleçŠ¶æ€ï¼Œè¿™ä¸ªæ—¶å€™ä¹Ÿåº”è¯¥è¯»å–åˆ°å‰é¢çš„é‚£äº›çŠ¶æ€ã€‚<br>      4.å¦‚æœä¸»çº¿ç¨‹ è°ƒç”¨çš„Bçº¿ç¨‹çš„start()æ–¹æ³•ï¼Œå…¶ä¸­Bçº¿ç¨‹å¯åŠ¨åèƒ½å¤Ÿçœ‹è§ä¸»çº¿ç¨‹ä¸­æ‰€æœ‰çš„æ“ä½œç»“æœ<br>     5. synchronizeä¸­ï¼Œè§£é”åœ¨åŠ é”ä¹‹åã€‚<br>     6.join()æ–¹æ³•ï¼Œåœ¨ä¸»çº¿ç¨‹ä¸­è°ƒç”¨äº†join()æ–¹æ³•ã€‚å¾…join()æ–¹æ³•ç»“æŸåï¼Œä¸»çº¿ç¨‹èƒ½å¤Ÿçœ‹è§ joinçº¿ç¨‹ä¸­æ‰§è¡Œçš„ç»“æœã€‚<br>","like_count":0},{"had_liked":false,"id":177848,"user_name":"æ—","can_delete":false,"product_type":"c1","uid":1543907,"ip_address":"","ucode":"E1D26D1AB1B14D","user_header":"https://static001.geekbang.org/account/avatar/00/17/8e/e3/a9f4ed7f.jpg","comment_is_top":false,"comment_ctime":1581514630,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1581514630","product_id":100023901,"comment_content":"final çš„è¿™ä¸ªæº¢å‡ºæ²¡å¤ªæ˜ç™½ æœ‰æ²¡æœ‰å¤§ä½¬ç»™è§£é‡Šä¸‹","like_count":0},{"had_liked":false,"id":171550,"user_name":"Gary","can_delete":false,"product_type":"c1","uid":1208111,"ip_address":"","ucode":"72D438C0EC020A","user_header":"https://static001.geekbang.org/account/avatar/00/12/6f/2f/122d41e4.jpg","comment_is_top":false,"comment_ctime":1578965730,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1578965730","product_id":100023901,"comment_content":"æ–‡ç« èƒ½çœ‹æ‡‚ï¼Œä½†æ˜¯å¯è§æ€§å’Œæœ‰åºæ€§ä¸javaçš„å†…å­˜æ¨¡å‹æœ‰ä»€ä¹ˆå…³ç³»å‘¢","like_count":0},{"had_liked":false,"id":170054,"user_name":"èŠ±å­ç¿","can_delete":false,"product_type":"c1","uid":1073674,"ip_address":"","ucode":"A687441DC6894F","user_header":"https://static001.geekbang.org/account/avatar/00/10/62/0a/26d00cb9.jpg","comment_is_top":false,"comment_ctime":1578498482,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1578498482","product_id":100023901,"comment_content":"1 åŠ volatileä¿®é¥°ç¬¦<br>2  åˆ©ç”¨ç®¡ç¨‹çš„é”ï¼Œå³ç”¨synchronized<br>3 åˆ©ç”¨start()å’Œjoin()æ–¹æ³•,å®ç°çº¿ç¨‹é—´è°ƒç”¨çš„æ¥å…³è”è¿™ä¸¤ä¸ªçº¿ç¨‹å®ç°å¯è§æ€§","like_count":0},{"had_liked":false,"id":169940,"user_name":"åœ¨è·¯ä¸Š","can_delete":false,"product_type":"c1","uid":1641319,"ip_address":"","ucode":"E1184E76B14431","user_header":"https://static001.geekbang.org/account/avatar/00/19/0b/67/dc49a1a8.jpg","comment_is_top":false,"comment_ctime":1578478857,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1578478857","product_id":100023901,"comment_content":"æ²¡æœ‰æ˜ç™½å•ä¾‹æ¨¡å¼åŒé‡æ£€æŸ¥ä¸­ä¸ºä»€ä¹ˆç”¨finalæ¥ä»£æ›¿volatileä¼šå‡ºç°:å¯èƒ½çœ‹åˆ° final å˜é‡çš„å€¼ä¼šå˜åŒ–è¿™ç§æƒ…å†µ è¯·è€å¸ˆè§£æƒ‘ä¸€ä¸‹","like_count":0},{"had_liked":false,"id":169896,"user_name":"å µè½¦","can_delete":false,"product_type":"c1","uid":1145404,"ip_address":"","ucode":"7BC1E50A4F8D3D","user_header":"https://static001.geekbang.org/account/avatar/00/11/7a/3c/87e015f8.jpg","comment_is_top":false,"comment_ctime":1578469190,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1578469190","product_id":100023901,"comment_content":"å¦‚æœçº¿ç¨‹ B è¯»åˆ°äº†â€œv=trueâ€ï¼Œé‚£ä¹ˆçº¿ç¨‹ A è®¾ç½®çš„â€œx=42â€å¯¹çº¿ç¨‹ B æ˜¯å¯è§çš„ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œçº¿ç¨‹ B èƒ½çœ‹åˆ° â€œx == 42â€ ï¼Œè¿™å¥è¯çš„æ„æ€æ˜¯x=42ä¹Ÿè¢«ç¦ç”¨ç¼“å­˜äº†ï¼Ÿ","like_count":0},{"had_liked":false,"id":168122,"user_name":"Eleven","can_delete":false,"product_type":"c1","uid":1168452,"ip_address":"","ucode":"FB4A0C8CA732BE","user_header":"https://static001.geekbang.org/account/avatar/00/11/d4/44/0ec958f4.jpg","comment_is_top":false,"comment_ctime":1578016250,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1578016250","product_id":100023901,"comment_content":"é’ˆå¯¹æœ¬ç¯‡çš„Happens-Beforeè§„åˆ™ï¼š<br>1.ç¨‹åºçš„é¡ºåºæ€§(ä¸é€‚åˆï¼Œè¿™æ˜¯å•çº¿ç¨‹æ“ä½œ)<br>2.volatileå˜é‡å’Œä¼ é€’æ€§ï¼Œå°†å…±äº«å˜é‡abcåœ¨ç¬¬ä¸€ä¸ªçº¿ç¨‹å†™å…¥ï¼ŒHappens-Beforeå¯¹ä¸€ä¸ªvolatileå˜é‡çš„å†™ï¼Œç„¶ååœ¨ç¬¬äºŒä¸ªçº¿ç¨‹ä¸­è¯»volatileå˜é‡ï¼Œç„¶åè¯»å…±äº«å˜é‡abcã€‚<br>3.ç®¡ç¨‹ä¸­é”çš„è§„åˆ™ï¼Œå¯¹å…±äº«å˜é‡çš„å†™æ“ä½œæ”¾åœ¨ç®¡ç¨‹ä¸­ï¼Œç¬¬ä¸€ä¸ªçº¿ç¨‹å…ˆå†™å…¥å…±äº«å˜é‡abcï¼Œç„¶åç¬¬äºŒä¸ªçº¿ç¨‹è¯»å…±äº«å˜é‡abcã€‚<br>4.çº¿ç¨‹start()è§„åˆ™ï¼Œåœ¨ç¬¬ä¸€ä¸ªçº¿ç¨‹ä¸­start()ç¬¬äºŒä¸ªçº¿ç¨‹ï¼Œåœ¨start()ä¹‹å‰å¯¹å…±äº«å˜é‡abcçš„å†™åœ¨ç¬¬äºŒä¸ªçº¿ç¨‹ä¸­åº”è¯¥ä¹Ÿæ˜¯å¯è§çš„ã€‚<br>5.çº¿ç¨‹join()è§„åˆ™ï¼Œåœ¨ç¬¬äºŒä¸ªçº¿ç¨‹ä¸­joinç¬¬ä¸€ä¸ªçº¿ç¨‹ï¼Œåœ¨ç¬¬ä¸€ä¸ªçº¿ç¨‹ä¸­å¯¹å…±äº«å˜é‡abcçš„å†™æ“ä½œå¯¹äºç¬¬äºŒä¸ªçº¿ç¨‹æ˜¯å¯è§çš„ã€‚","like_count":0},{"had_liked":false,"id":167662,"user_name":"ååˆš","can_delete":false,"product_type":"c1","uid":1206409,"ip_address":"","ucode":"19998032377B0B","user_header":"https://static001.geekbang.org/account/avatar/00/12/68/89/f57cbd87.jpg","comment_is_top":false,"comment_ctime":1577888630,"is_pvip":false,"replies":[{"id":"65465","content":"hbè§„åˆ™æ˜¯è¦å¸®åŠ©æˆ‘ä»¬ä¸ç”¨æŠ˜è…¾å†…å­˜ï¼Œç¼“å­˜ï¼Œå¯„å­˜å™¨ï¼Œä¹Ÿèƒ½æ¨å¯¼å‡ºå¯è§æ€§ã€‚æ‰€ä»¥æ²¡å¿…è¦å¾€å›æŠ˜è…¾ï¼Œé‚£æ˜¯jvmçš„å¼€å‘äººå‘˜è¦è€ƒè™‘çš„","user_name":"ä½œè€…å›å¤","user_name_real":"ç‹å®ä»¤","uid":"1269969","ctime":1578208408,"ip_address":"","comment_id":167662,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1577888630","product_id":100023901,"comment_content":"Happen-beforeçš„è§„åˆ™1æ˜¯å¦å¯ä»¥è¿™ä¹ˆç†è§£<br>çº¿ç¨‹1æ‰§è¡Œv=trueåï¼Œä¸åªæ˜¯å°†vçš„å€¼åˆ·æ–°å†…å­˜ï¼Œè€Œæ˜¯å°†v=trueä¹‹å‰çš„æ‰€æœ‰å…±äº«å˜é‡æ“ä½œéƒ½åˆ·æ–°åˆ°å†…å­˜","like_count":0,"discussions":[{"author":{"id":1269969,"avatar":"https://static001.geekbang.org/account/avatar/00/13/60/d1/8efa89ab.jpg","nickname":"ç‹å®ä»¤","note":"","ucode":"4FE19F5BC32FCA","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":479935,"discussion_content":"hbè§„åˆ™æ˜¯è¦å¸®åŠ©æˆ‘ä»¬ä¸ç”¨æŠ˜è…¾å†…å­˜ï¼Œç¼“å­˜ï¼Œå¯„å­˜å™¨ï¼Œä¹Ÿèƒ½æ¨å¯¼å‡ºå¯è§æ€§ã€‚æ‰€ä»¥æ²¡å¿…è¦å¾€å›æŠ˜è…¾ï¼Œé‚£æ˜¯jvmçš„å¼€å‘äººå‘˜è¦è€ƒè™‘çš„","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1578208408,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":166049,"user_name":"a(à¹‘â‰–à¸´Ù¼â‰–à¸´)âœŒ","can_delete":false,"product_type":"c1","uid":1392431,"ip_address":"","ucode":"AEF9B5CA1605DF","user_header":"https://static001.geekbang.org/account/avatar/00/15/3f/2f/8513c4d3.jpg","comment_is_top":false,"comment_ctime":1577370599,"is_pvip":false,"replies":[{"id":"63412","content":"æ€»ç»“çš„åˆ°ä½ğŸ‘","user_name":"ä½œè€…å›å¤","user_name_real":"ç‹å®ä»¤","uid":"1269969","ctime":1577444984,"ip_address":"","comment_id":166049,"utype":1}],"discussion_count":1,"race_medal":1,"score":"1577370599","product_id":100023901,"comment_content":"çœ‹å®Œè¿™ç¯‡çš„ç†è§£ï¼ŒHappens-BeforeåŸåˆ™å°±æ˜¯å¦‚æœä¸€ä¸ªçº¿ç¨‹â€çœ‹åˆ°â€œå¦ä¸€ä¸ªçº¿ç¨‹å‘ç”Ÿçš„äº‹ï¼Œé‚£é‚£ä¸ªçº¿ç¨‹é‚£ä¸ªäº‹å‘ç”Ÿä¹‹å‰çš„äº‹è¿™ä¸ªçº¿ç¨‹ä¹Ÿä¸€å®šå¯ä»¥çœ‹åˆ°","like_count":0,"discussions":[{"author":{"id":1269969,"avatar":"https://static001.geekbang.org/account/avatar/00/13/60/d1/8efa89ab.jpg","nickname":"ç‹å®ä»¤","note":"","ucode":"4FE19F5BC32FCA","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":479374,"discussion_content":"æ€»ç»“çš„åˆ°ä½ğŸ‘","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1577444984,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":164994,"user_name":"ä¹¾å¤ç¬é—´","can_delete":false,"product_type":"c1","uid":1683130,"ip_address":"","ucode":"15BDCF29CBF8EB","user_header":"http://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTLWIUF31dicT1YBTxWNX0uvbMxl15UwdlwFicGhNo0DsQ7CbM6k16EQxK7bwSMcicLGMdYto4jGPTvrg/132","comment_is_top":false,"comment_ctime":1577144523,"is_pvip":false,"replies":[{"id":"62980","content":"æˆ‘åªèƒ½è¯´ï¼Œå¦‚æœå†™æ“ä½œå®Œæˆåï¼Œèƒ½è¯»åˆ°æœ€æ–°å€¼ï¼Œå°±è¯´æ˜æœ‰å¯è§æ€§ã€‚å‰æè¿™ä¸ªè¯å¤§å®¶çš„ç†è§£åå·®å¾ˆå¤§ã€‚","user_name":"ä½œè€…å›å¤","user_name_real":"ç‹å®ä»¤","uid":"1269969","ctime":1577189031,"ip_address":"","comment_id":164994,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1577144523","product_id":100023901,"comment_content":"è€å¸ˆé—®ä¸‹ï¼Œå¯è§æ€§çš„å‰ææ˜¯ä¸æ˜¯æ„å‘³ç€å†™æ“ä½œçš„æ—¶é—´åœ¨è¯»æ“ä½œæ—¶é—´ä¹‹å‰ï¼Ÿ<br>","like_count":0,"discussions":[{"author":{"id":1269969,"avatar":"https://static001.geekbang.org/account/avatar/00/13/60/d1/8efa89ab.jpg","nickname":"ç‹å®ä»¤","note":"","ucode":"4FE19F5BC32FCA","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":478977,"discussion_content":"æˆ‘åªèƒ½è¯´ï¼Œå¦‚æœå†™æ“ä½œå®Œæˆåï¼Œèƒ½è¯»åˆ°æœ€æ–°å€¼ï¼Œå°±è¯´æ˜æœ‰å¯è§æ€§ã€‚å‰æè¿™ä¸ªè¯å¤§å®¶çš„ç†è§£åå·®å¾ˆå¤§ã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1577189031,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":164779,"user_name":"æ²","can_delete":false,"product_type":"c1","uid":1326537,"ip_address":"","ucode":"678F6A0C778CDD","user_header":"https://static001.geekbang.org/account/avatar/00/14/3d/c9/a1e6a307.jpg","comment_is_top":false,"comment_ctime":1577090044,"is_pvip":false,"discussion_count":0,"race_medal":3,"score":"1577090044","product_id":100023901,"comment_content":"ç¨‹åºé¡ºåºæ€§åŸåˆ™æŒ‡çš„æ˜¯è¿è¡Œæ—¶å®é™…æ‰§è¡Œçš„é¡ºåºã€‚<br>ç”±äºæŒ‡ä»¤é‡æ’åºï¼Œå®é™…æ‰§è¡Œçš„é¡ºåºå¯èƒ½è·Ÿä»£ç ä¸­å†™çš„é¡ºåºä¸ä¸€è‡´ã€‚<br>è€Œvolatileç¦æ­¢äº†æŒ‡ä»¤é‡æ’åºã€‚å¯ä»¥ä¿è¯é¡ºåºæ‰§è¡Œã€‚","like_count":0},{"had_liked":false,"id":164074,"user_name":"é¥é¥æ— å¦»","can_delete":false,"product_type":"c1","uid":1251243,"ip_address":"","ucode":"30A765B411D059","user_header":"https://static001.geekbang.org/account/avatar/00/13/17/ab/c0235b70.jpg","comment_is_top":false,"comment_ctime":1576854572,"is_pvip":false,"replies":[{"id":"62403","content":"è¿™ä¸ªæ—¶å€™v==falseï¼Œä¸ä¼šè¯»x","user_name":"ä½œè€…å›å¤","user_name_real":"ç‹å®ä»¤","uid":"1269969","ctime":1576910593,"ip_address":"","comment_id":164074,"utype":1}],"discussion_count":2,"race_medal":0,"score":"1576854572","product_id":100023901,"comment_content":"è€å¸ˆé—®ä½ ä¸‹ï¼Œç¨‹åºå°±æ˜¯æ–‡ä¸­çš„å‚è€ƒ1ç¤ºä¾‹ä»£ç ï¼Œæœ‰æ²¡æœ‰è¿™ç§æƒ…å†µï¼Œç¨‹åºæ‰§è¡Œwriteræ–¹æ³•ï¼ŒæŒ‰ç…§ç¬¬ä¸€è¯¾çš„ç§’æ•°ï¼Œçº¿ç¨‹åˆ‡æ¢å¯èƒ½å‘ç”Ÿåœ¨ä»»ä½•ä¸€æ¡cpuæŒ‡ä»¤æ‰§è¡Œå®Œæ¯•ï¼Œè¿™é‡Œæœ‰å¯èƒ½åˆšè¿›å…¥writeræ–¹æ³•å°±å‘ç”Ÿäº†çº¿ç¨‹åˆ‡æ¢ï¼Œä»¥è‡³äºreaderè¯»å‡ºx=0çš„æƒ…å†µæ˜¯å¦ä¼šå‘ç”Ÿã€‚<br><br>&#47;&#47; ä»¥ä¸‹ä»£ç æ¥æºäºã€å‚è€ƒ1ã€‘<br>class VolatileExample {<br>  int x = 0;<br>  volatile boolean v = false;<br>  public void writer() {<br>    x = 42;<br>    v = true;<br>  }<br>  public void reader() {<br>    if (v == true) {<br>      &#47;&#47; è¿™é‡Œxä¼šæ˜¯å¤šå°‘å‘¢ï¼Ÿ<br>    }<br>  }<br>}","like_count":0,"discussions":[{"author":{"id":1269969,"avatar":"https://static001.geekbang.org/account/avatar/00/13/60/d1/8efa89ab.jpg","nickname":"ç‹å®ä»¤","note":"","ucode":"4FE19F5BC32FCA","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":478634,"discussion_content":"è¿™ä¸ªæ—¶å€™v==falseï¼Œä¸ä¼šè¯»x","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1576910593,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1251243,"avatar":"https://static001.geekbang.org/account/avatar/00/13/17/ab/c0235b70.jpg","nickname":"é¥é¥æ— å¦»","note":"","ucode":"30A765B411D059","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":93675,"discussion_content":"åˆšå¼€å§‹ç†è§£é”™äº†ï¼Œå…¶å®æ˜¯æœ‰å¯èƒ½çº¿ç¨‹åˆ‡æ¢çš„ï¼Œåªæ˜¯è¯´ä¸€æ—¦çº¿ç¨‹Aæ”¹äº†å€¼çº¿ç¨‹bä¸€å®šçœ‹å¾—åˆ°ï¼Œä¸æ˜¯è¯´ä¸ä¼šå‘ç”Ÿçº¿ç¨‹åˆ‡æ¢","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1576934743,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":151747,"user_name":"Eleven","can_delete":false,"product_type":"c1","uid":1168452,"ip_address":"","ucode":"FB4A0C8CA732BE","user_header":"https://static001.geekbang.org/account/avatar/00/11/d4/44/0ec958f4.jpg","comment_is_top":false,"comment_ctime":1573784725,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1573784725","product_id":100023901,"comment_content":"åˆ©ç”¨Happens-Beforeè§„åˆ™ çº¿ç¨‹ start() è§„åˆ™ å’Œ çº¿ç¨‹ join() è§„åˆ™ï¼Œåœ¨è®¾ç½® abc=3çš„çº¿ç¨‹é‡Œé¢startå…¶å®ƒçº¿ç¨‹ï¼Œæˆ–è€…åœ¨å…¶å®ƒçº¿ç¨‹é‡Œé¢joinè®¾ç½®abc=3çš„çº¿ç¨‹éƒ½å¯ä»¥å®ç°","like_count":0},{"had_liked":false,"id":149504,"user_name":"æ¢¦å€šæ æ†","can_delete":false,"product_type":"c1","uid":1095857,"ip_address":"","ucode":"BDEB97F2822445","user_header":"http://thirdwx.qlogo.cn/mmopen/vi_32/bvj76PmeUvW8kokyu91IZWuRATKmabibDWbzAj2TajeEic7WvKCJOLaOh6jibEmdQ36EO3sBUZ0HibAiapsrZo64U8w/132","comment_is_top":false,"comment_ctime":1573259994,"is_pvip":false,"replies":[{"id":"67119","content":"ä¼ªä»£ç ","user_name":"ä½œè€…å›å¤","user_name_real":"ç‹å®ä»¤","uid":"1269969","ctime":1579439183,"ip_address":"","comment_id":149504,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1573259994","product_id":100023901,"comment_content":"è€å¸ˆï¼Œç¡®è®¤ä¸€ä¸‹ï¼šé‡Œé¢çš„var,global.objæ˜¯ä¼ªä»£ç ï¼Œä¸ºäº†è¡¨è¾¾è¿™ä¸ªæ„æ€ï¼Œè¿˜æ˜¯è¯´è¿™æ˜¯å¾ˆå¤šè¯­è¨€é€šç”¨çš„ï¼Œä½ ç”¨çš„å…¶ä»–å‡½æ•°å¼è¯­è¨€ç­‰å†™çš„","like_count":0,"discussions":[{"author":{"id":1269969,"avatar":"https://static001.geekbang.org/account/avatar/00/13/60/d1/8efa89ab.jpg","nickname":"ç‹å®ä»¤","note":"","ucode":"4FE19F5BC32FCA","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":473886,"discussion_content":"ä¼ªä»£ç ","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1579439183,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":147497,"user_name":"è€ƒä¼‘","can_delete":false,"product_type":"c1","uid":1053955,"ip_address":"","ucode":"968DFC00D6D0CF","user_header":"https://static001.geekbang.org/account/avatar/00/10/15/03/c0fe1dbf.jpg","comment_is_top":false,"comment_ctime":1572867021,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1572867021","product_id":100023901,"comment_content":"å¹¶å‘ç¼–ç¨‹ä»å…¨å±€æ¥çœ‹ï¼Œæœ‰åˆ†å·¥ã€åŒæ­¥ã€äº’æ–¥ä¸‰ä¸ªæ¨¡å—ç»„æˆï¼›<br>è€Œå¹¶å‘ç¼–ç¨‹éœ€è¦æ»¡è¶³çš„ä¸‰ä¸ªç‰¹æ€§ï¼šå¯è§æ€§ã€åŸå­æ€§ã€æœ‰åºæ€§ã€‚<br>å¯è§æ€§æŒ‡ä¸€ä¸ªçº¿ç¨‹å¯¹å…±äº«æ•°æ®çš„æ›´æ”¹ï¼Œå¯¹å¦ä¸€ä¸ªçº¿ç¨‹æ˜¯å¯è§çš„ã€‚<br>åŸå­æ€§æŒ‡ä¸€ä¸ªæˆ–å¤šä¸ªåœ¨CPUçš„æ“ä½œæ˜¯ä¸å¯ä¸­æ–­çš„<br>æœ‰åºæ€§æŒ‡åœ¨ç¼–è¯‘ä¼˜åŒ–åï¼Œå°½ç®¡æŒ‡ä»¤çš„æ‰§è¡Œé¡ºåºè¢«æ›´æ”¹ï¼Œä¾ç„¶ä¸å½±å“ç›¸åº”çš„æ•°æ®<br><br>ä¸ºäº†è§£å†³å¹¶å‘ç¼–ç¨‹ä¸­å‡ºç°çš„ä»¥ä¸Šå‡ ä¸ªé—®é¢˜ï¼Œåœ¨Javaä¸­å¼•å…¥äº†å†…å­˜æ¨¡å‹çš„æ¦‚å¿µã€‚<br><br>ç”±äºåœ¨æ—¥å¸¸å¼€å‘ä¸­å¯èƒ½å¯¹å†…å­˜æ¨¡å‹æ¥è§¦çš„ä¸å¤šï¼Œå¤§å¤šæ•°çš„å¼€å‘äººå‘˜å¹¶ä¸ç†Ÿæ‚‰è¿™ä¸ªæ¦‚å¿µï¼ˆåŒ…æ‹¬æˆ‘ï¼‰ã€‚<br><br>Javaå†…å­˜æ¨¡å‹éœ€è¦æŒæ¡çš„æ˜¯Happen-beforeè§„åˆ™ã€‚","like_count":0},{"had_liked":false,"id":144480,"user_name":"å½’é›¶","can_delete":false,"product_type":"c1","uid":1103208,"ip_address":"","ucode":"C99B8E93009A46","user_header":"https://static001.geekbang.org/account/avatar/00/10/d5/68/2201b6b9.jpg","comment_is_top":false,"comment_ctime":1571934250,"is_pvip":true,"replies":[{"id":"55723","content":"ä¹¦å†™é¡ºåºæ˜¯BAï¼Œæ— è®ºå¦‚ä½•éƒ½ä¸ä¼šA hb Bçš„ï¼Œè¿™äº›è§„åˆ™ï¼Œæœ¬è´¨ä¸Šæ˜¯çº¦æŸç¼–è¯‘ä¼˜åŒ–ï¼Œå°½é‡æŒ‰ç…§ç¨‹åºçš„ä¹¦å†™é¡ºåºæ‰§è¡Œã€‚","user_name":"ä½œè€…å›å¤","user_name_real":"ç‹å®ä»¤","uid":"1269969","ctime":1571976785,"ip_address":"","comment_id":144480,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1571934250","product_id":100023901,"comment_content":"æœ‰ä¸€ç‚¹ä¸å¤ªç†è§£ï¼Œæ‰€è°“çš„A happens-before Bï¼Œé‚£ä¹ˆAå¯¹äºBæ˜¯å¯è§çš„ï¼Œæ­¤æ—¶çš„Aå’ŒBå¯èƒ½ç”±äºé‡æ’åºï¼ŒAçš„ä»£ç åœ¨åBçš„ä»£ç åœ¨å‰ï¼ˆä¹¦å†™é¡ºåºï¼‰ï¼Œä½†æ˜¯æ‰§è¡ŒAåœ¨å‰Båœ¨åï¼Œé‚£ä¹ˆä¹Ÿå°±ç¬¦åˆäº†Aå¯¹Bå¯è§å—ï¼Ÿè°¢è°¢è€å¸ˆ","like_count":0,"discussions":[{"author":{"id":1269969,"avatar":"https://static001.geekbang.org/account/avatar/00/13/60/d1/8efa89ab.jpg","nickname":"ç‹å®ä»¤","note":"","ucode":"4FE19F5BC32FCA","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":471965,"discussion_content":"ä¹¦å†™é¡ºåºæ˜¯BAï¼Œæ— è®ºå¦‚ä½•éƒ½ä¸ä¼šA hb Bçš„ï¼Œè¿™äº›è§„åˆ™ï¼Œæœ¬è´¨ä¸Šæ˜¯çº¦æŸç¼–è¯‘ä¼˜åŒ–ï¼Œå°½é‡æŒ‰ç…§ç¨‹åºçš„ä¹¦å†™é¡ºåºæ‰§è¡Œã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1571976785,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":142062,"user_name":"ç§‹å¤©","can_delete":false,"product_type":"c1","uid":1057056,"ip_address":"","ucode":"A7E1D953EF7E17","user_header":"https://static001.geekbang.org/account/avatar/00/10/21/20/1299e137.jpg","comment_is_top":false,"comment_ctime":1571286343,"is_pvip":true,"discussion_count":0,"race_medal":0,"score":"1571286343","product_id":100023901,"comment_content":"Java å†…å­˜æ¨¡å‹è§„èŒƒäº† JVM å¦‚ä½•æä¾›æŒ‰éœ€ç¦ç”¨ç¼“å­˜å’Œç¼–è¯‘...<br><br>","like_count":0},{"had_liked":false,"id":138173,"user_name":"å“ˆçš®å®","can_delete":false,"product_type":"c1","uid":1056059,"ip_address":"","ucode":"8C4DB072758817","user_header":"https://static001.geekbang.org/account/avatar/00/10/1d/3b/022773c9.jpg","comment_is_top":false,"comment_ctime":1570075252,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1570075252","product_id":100023901,"comment_content":"ä¸€ã€Javaå†…å­˜æ¨¡å‹<br><br>Javaå†…å­˜æ¨¡å‹è§„èŒƒäº†JVMå¦‚ä½•æä¾›æŒ‰éœ€ç¦ç”¨ç¼“å­˜å’Œç¼–è¯‘ä¼˜åŒ–çš„æ–¹æ³•<br><br>äºŒã€Happens BeforeåŸåˆ™ï¼š<br><br>å‰é¢ä¸€ä¸ªæ“ä½œçš„ç»“æœå¯¹åç»­æ“ä½œæ˜¯å¯è§çš„<br><br>Happens-Beforeçº¦æŸäº†ç¼–è¯‘å™¨çš„ä¼˜åŒ–è¡Œä¸ºï¼Œè™½å…è®¸ç¼–è¯‘å™¨ä¼˜åŒ–ï¼Œä½†è¦æ±‚ç¼–è¯‘å™¨ä¼˜åŒ–åä¸€å®šéµå®ˆHappens-Beforeè§„åˆ™ã€‚<br><br>1.ç¨‹åºçš„é¡ºåºæ€§è§„åˆ™<br><br>åœ¨ä¸€ä¸ªçº¿ç¨‹ä¸­ï¼ŒæŒ‰ç…§ç¨‹åºé¡ºåºï¼Œå‰é¢çš„æ“ä½œHappens-Beforeäºåç»­çš„ä»»æ„æ“ä½œã€‚<br><br>2.volatileå˜é‡è§„åˆ™<br><br>å¯¹ä¸€ä¸ªvolatileå˜é‡çš„å†™è§„åˆ™ï¼ŒHappens-Beforeäºåç»­å¯¹è¿™ä¸ªvolatileå˜é‡çš„è¯»æ“ä½œã€‚<br><br>3.ä¼ é€’æ€§<br><br>å¦‚æœA Happens-Before Bï¼ŒB Happens-Before Cï¼Œé‚£ä¹ˆA Happens-Before C<br><br>4.ç®¡ç¨‹ä¸­é”çš„è§„åˆ™<br><br>å¯¹ä¸€ä¸ªé”çš„è§£é”Happens-Beforeäºåç»­å¯¹è¿™ä¸ªé”çš„åŠ é”ã€‚<br><br>ç®¡ç¨‹æ˜¯ä»€ä¹ˆï¼Ÿ---ç®¡ç¨‹æ˜¯ä¸€ç§é€šç”¨çš„åŒæ­¥åŸè¯­ï¼Œåœ¨Javaä¸­æŒ‡çš„å°±æ˜¯synchronizedï¼Œsynchronizedæ˜¯Javaé‡Œå¯¹ç®¡ç¨‹çš„å®ç°ã€‚<br><br>5.çº¿ç¨‹start()è§„åˆ™<br><br>è¿™æ¡æ˜¯å…³äºçº¿ç¨‹å¯åŠ¨çš„ã€‚å®ƒæ˜¯æŒ‡ä¸»çº¿ç¨‹ A å¯åŠ¨å­çº¿ç¨‹ B åï¼Œå­çº¿ç¨‹ B èƒ½å¤Ÿçœ‹åˆ°ä¸»çº¿ç¨‹åœ¨å¯åŠ¨å­çº¿ç¨‹ B å‰çš„æ“ä½œã€‚<br><br>6.çº¿ç¨‹join()è§„åˆ™<br><br>ä¸»çº¿ç¨‹ A ç­‰å¾…å­çº¿ç¨‹ B å®Œæˆï¼ˆä¸»çº¿ç¨‹ A é€šè¿‡è°ƒç”¨å­çº¿ç¨‹B çš„ join() æ–¹æ³•å®ç°ï¼‰ï¼Œå½“å­çº¿ç¨‹ B å®Œæˆåï¼ˆä¸»çº¿ç¨‹ A ä¸­ join() æ–¹æ³•è¿”å›ï¼‰ï¼Œä¸»çº¿ç¨‹èƒ½å¤Ÿçœ‹åˆ°å­çº¿ç¨‹çš„æ“ä½œã€‚","like_count":0},{"had_liked":false,"id":137277,"user_name":"å°æ°˜","can_delete":false,"product_type":"c1","uid":1622109,"ip_address":"","ucode":"DA55B9A02D9EE0","user_header":"http://thirdwx.qlogo.cn/mmopen/vi_32/DYAIOgq83erPMtAfnQdpx1yOZQ2ic7icqUs3tvibEjUXQMUXKiaakyuIho6k6vmdl46nrdWjXIjPIRg9Pmco00tR5w/132","comment_is_top":false,"comment_ctime":1569675216,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1569675216","product_id":100023901,"comment_content":"å…³äºè¯¾åæ€è€ƒé¢˜æˆ‘åªæƒ³å‡ºä¸€ä¸ªè§£ã€‚ç”¨volatileä¿®é¥°å˜é‡ï¼Œæ ¹æ®è§„åˆ™volatileä¿®é¥°å˜é‡çš„å†™æ“ä½œhappens-beforeè¯¥å˜é‡çš„è¯»æ“ä½œï¼Œå› æ­¤å…¶ä»–çº¿ç¨‹å¯ä»¥çœ‹åˆ°abcå˜é‡==3ã€‚","like_count":0},{"had_liked":false,"id":134413,"user_name":"æ¦´èŠ’ç§‘æŠ€","can_delete":false,"product_type":"c1","uid":1312485,"ip_address":"","ucode":"EC297012B1B942","user_header":"http://thirdwx.qlogo.cn/mmopen/vi_32/DwZUsQhia0wIWNEfeGZ2srQWzVC04JjLFDwgmicpnNF3mUPdRJD6U6vviceJqMxGYUGtxaiaZWltyNtQ5fZhia7YN3w/132","comment_is_top":false,"comment_ctime":1568820495,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1568820495","product_id":100023901,"comment_content":"æ¶ˆæ¯æ€»çº¿çš„æ–¹å¼ é€šçŸ¥åˆ·æ–°ç¼“å­˜","like_count":0},{"had_liked":false,"id":133771,"user_name":"é“¿ç„¶","can_delete":false,"product_type":"c1","uid":1162461,"ip_address":"","ucode":"D529242EC2E2EA","user_header":"https://static001.geekbang.org/account/avatar/00/11/bc/dd/c9413f59.jpg","comment_is_top":false,"comment_ctime":1568649307,"is_pvip":true,"discussion_count":0,"race_medal":0,"score":"1568649307","product_id":100023901,"comment_content":"@å°å’Œå°šç¬¨å—åŒ—  çš„ç­”æ¡ˆä¸å®Œå…¨æ­£ç¡®ï¼Œä¼šè¯¯å¯¼çš„ã€‚<br><br>è¡¥å……ä¸€ä¸ªï¼š åœ¨abcèµ‹å€¼åå¯¹ä¸€ä¸ªvolatileå˜é‡Aè¿›è¡Œèµ‹å€¼æ“ä½œï¼Œç„¶ååœ¨å…¶ä»–çº¿ç¨‹è¯»å–abcä¹‹å‰è¯»å–Açš„å€¼ï¼Œé€šè¿‡volatileçš„å¯è§æ€§å’Œhappen-beforeçš„ä¼ é€’æ€§å®ç°abcä¿®æ”¹åå¯¹å…¶ä»–çº¿ç¨‹ç«‹å³å¯è§<br><br>è¿™é‡Œå…¶ä»–çº¿ç¨‹åªæ˜¯è¯»å–Açš„å€¼æ²¡æœ‰ç”¨ï¼Œå› ä¸ºå¯èƒ½abcçº¿ç¨‹è¿˜æ²¡æ‰§è¡Œï¼Œå°±ç®—abcæ‰§è¡Œäº†ä¹Ÿæœªå¿…æ­£ç¡®ï¼Œåº”è¯¥åŠ ä¸Šåˆ¤æ–­æ¡ä»¶ï¼ŒBçº¿ç¨‹é‡Œè¯»å–åˆ°çš„Aå€¼è¦ç­‰äºabcçº¿ç¨‹é‡Œè®¾ç½®çš„å€¼æ—¶æ‰è¡Œã€‚<br><br>Happe-beforeè§„åˆ™å¹¶æ²¡æœ‰è¯´åœ¨ã€ä¸åŒçº¿ç¨‹ã€‘é‡Œè¯»å†™volatileå˜é‡æ—¶ï¼Œå†™æ“ä½œä¸€å®šå‘ç”Ÿåœ¨è¯»æ“ä½œä¹‹å‰ï¼Œå¦‚æœè¯»çš„çº¿ç¨‹å…ˆè¿è¡Œï¼Œå†™çº¿ç¨‹è¿˜æ²¡è¿è¡Œå‘¢ï¼Ÿ","like_count":0},{"had_liked":false,"id":133081,"user_name":"ç å†œKevinäº®","can_delete":false,"product_type":"c1","uid":1116630,"ip_address":"","ucode":"D34562461CA0A1","user_header":"https://static001.geekbang.org/account/avatar/00/11/09/d6/5f366427.jpg","comment_is_top":false,"comment_ctime":1568350132,"is_pvip":false,"replies":[{"id":"50966","content":"æˆ‘è§‰å¾—ç†è®ºä¸Šè¿˜æ˜¯å¯ä»¥ä¼˜åŒ–ä¸€éƒ¨åˆ†çš„ï¼Œæ²¡æè¿‡ç¼–è¯‘å™¨ï¼Œè¯¦æƒ…æˆ‘ä¹Ÿä¸æ¸…æ¥š","user_name":"ä½œè€…å›å¤","user_name_real":"ç‹å®ä»¤","uid":"1269969","ctime":1568366890,"ip_address":"","comment_id":133081,"utype":1}],"discussion_count":2,"race_medal":0,"score":"1568350132","product_id":100023901,"comment_content":"è¯·é—®è€å¸ˆï¼ŒHappen-beforeè§„åˆ™1ä¼šä¸ä¼šå¯¼è‡´ç¼–è¯‘å™¨æ— æ³•è¿›è¡Œä¹±åºä¼˜åŒ–å‘¢ï¼Ÿæ¢ä¸€ä¸ªé—®æ³•å°±æ˜¯ï¼Œç¼–è¯‘å™¨çš„ä¹±åºä¼˜åŒ–ä¸è§„åˆ™1ä¸ä¼šæœ‰çŸ›ç›¾å—ï¼Ÿ","like_count":0,"discussions":[{"author":{"id":1269969,"avatar":"https://static001.geekbang.org/account/avatar/00/13/60/d1/8efa89ab.jpg","nickname":"ç‹å®ä»¤","note":"","ucode":"4FE19F5BC32FCA","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":467251,"discussion_content":"æˆ‘è§‰å¾—ç†è®ºä¸Šè¿˜æ˜¯å¯ä»¥ä¼˜åŒ–ä¸€éƒ¨åˆ†çš„ï¼Œæ²¡æè¿‡ç¼–è¯‘å™¨ï¼Œè¯¦æƒ…æˆ‘ä¹Ÿä¸æ¸…æ¥š","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1568366890,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1138821,"avatar":"https://static001.geekbang.org/account/avatar/00/11/60/85/f72f1d94.jpg","nickname":"ä¸è·¯åŒé£","note":"","ucode":"2985F1440A1962","race_medal":0,"user_type":1,"is_pvip":true},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":298679,"discussion_content":"ä¸ä¼šçš„ï¼Œhappen-beforeè§„åˆ™1æ˜¯é’ˆå¯¹å¯è§æ€§çš„ã€‚\n    åŠ å…¥ a = 2ï¼Œ b = 3ã€‚è¿™2ä¸ªèµ‹å€¼æ“ä½œæ²¡æœ‰ä¾èµ–æ€§çš„ï¼Œcpuæ˜¯å¯ä»¥ä¹±åºä¼˜åŒ–çš„","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1597376867,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":132066,"user_name":"å¶é¹","can_delete":false,"product_type":"c1","uid":1253052,"ip_address":"","ucode":"209A8B210C340B","user_header":"https://static001.geekbang.org/account/avatar/00/13/1e/bc/6839e3ca.jpg","comment_is_top":false,"comment_ctime":1568018108,"is_pvip":false,"replies":[{"id":"50587","content":"googleğŸ˜„","user_name":"ä½œè€…å›å¤","user_name_real":"ç‹å®ä»¤","uid":"1269969","ctime":1568082922,"ip_address":"","comment_id":132066,"utype":1}],"discussion_count":2,"race_medal":0,"score":"1568018108","product_id":100023901,"comment_content":"è€å¸ˆï¼Œä½ å¥½ï¼Œæˆ‘çœ‹åˆ°è€å¸ˆä½¿ç”¨çš„ä¸€äº›æ¡ˆä¾‹å’Œå‚è€ƒæ–‡æ¡£æ˜¯è‹±æ–‡çš„ï¼Œè¯·é—®è¿™äº›å†…å®¹ä¸€èˆ¬æ˜¯ä»å“ªé‡Œè·å–çš„ï¼Ÿ","like_count":0,"discussions":[{"author":{"id":1269969,"avatar":"https://static001.geekbang.org/account/avatar/00/13/60/d1/8efa89ab.jpg","nickname":"ç‹å®ä»¤","note":"","ucode":"4FE19F5BC32FCA","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":466743,"discussion_content":"googleğŸ˜„","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1568082922,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1253052,"avatar":"https://static001.geekbang.org/account/avatar/00/13/1e/bc/6839e3ca.jpg","nickname":"å¶é¹","note":"","ucode":"209A8B210C340B","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":8873,"discussion_content":"å“ˆå“ˆï¼Œé‚£è¿™ä¸ªè¿˜æ˜¯è¦æ±‚è‹±æ–‡è¦ä¸é”™ï¼Œçœ‹æ¥è‹±è¯­è¿˜æ˜¯è¦åŠ å¼ºå­¦ä¹ ","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1568088558,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":128926,"user_name":"ä¸œé£ç¬¬ä¸€æ","can_delete":false,"product_type":"c1","uid":1402697,"ip_address":"","ucode":"0CD0F62E90DAD8","user_header":"https://static001.geekbang.org/account/avatar/00/15/67/49/864dba17.jpg","comment_is_top":false,"comment_ctime":1566985211,"is_pvip":false,"replies":[{"id":"47869","content":"ä½ å¯ä»¥æŠŠvolatileå˜é‡ç®€å•çš„ç†è§£ä¸ºä¸å…è®¸CPUç¼“å­˜ï¼Œæ‰€ä»¥ä¸€ä¸ªçº¿ç¨‹æ›´æ”¹äº†ï¼Œå¦ä¸€ä¸ªçº¿ç¨‹ä¹‹åä¸€å®šèƒ½è¯»åˆ°æœ€æ–°çš„ã€‚ä»”ç»†æƒ³æƒ³ï¼Œä¸¤ç§è¯´æ³•éƒ½å¯¹ï¼Œå˜é‡ä¸è¯»å®ƒï¼Œä»–å˜ä¸å˜å°±æ²¡æœ‰æ„ä¹‰ã€‚","user_name":"ä½œè€…å›å¤","user_name_real":"ç‹å®ä»¤","uid":"1269969","ctime":1566989299,"ip_address":"","comment_id":128926,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1566985211","product_id":100023901,"comment_content":"è¯·æ•™è€å¸ˆä¸€ä¸ªé—®é¢˜ï¼Œçº¿ç¨‹1å’Œçº¿ç¨‹2åŒæ—¶è¯»å–äº†volatileå˜é‡åï¼Œçº¿ç¨‹1å¯¹volatileå˜é‡è¿›è¡Œäº†æ›´æ–°ï¼Œæ›´æ–°å®Œæˆåçº¿ç¨‹2ä¸­volatileå˜é‡æ˜¯ç«‹å³æ›´æ–°ï¼Œè¿˜æ˜¯ç­‰ä¸‹ä¸€æ¬¡è¯»å–çš„æ—¶å€™æ›´æ–°ã€‚ç½‘ä¸Šæœ‰ä¸åŒçš„è¯´æ³•ï¼Œæœ‰ç‚¹çº ç»“ã€‚","like_count":0,"discussions":[{"author":{"id":1269969,"avatar":"https://static001.geekbang.org/account/avatar/00/13/60/d1/8efa89ab.jpg","nickname":"ç‹å®ä»¤","note":"","ucode":"4FE19F5BC32FCA","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":465180,"discussion_content":"ä½ å¯ä»¥æŠŠvolatileå˜é‡ç®€å•çš„ç†è§£ä¸ºä¸å…è®¸CPUç¼“å­˜ï¼Œæ‰€ä»¥ä¸€ä¸ªçº¿ç¨‹æ›´æ”¹äº†ï¼Œå¦ä¸€ä¸ªçº¿ç¨‹ä¹‹åä¸€å®šèƒ½è¯»åˆ°æœ€æ–°çš„ã€‚ä»”ç»†æƒ³æƒ³ï¼Œä¸¤ç§è¯´æ³•éƒ½å¯¹ï¼Œå˜é‡ä¸è¯»å®ƒï¼Œä»–å˜ä¸å˜å°±æ²¡æœ‰æ„ä¹‰ã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1566989299,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":127736,"user_name":"Geek_ab689a","can_delete":false,"product_type":"c1","uid":1619165,"ip_address":"","ucode":"152D1AE15F0C9E","user_header":"http://thirdwx.qlogo.cn/mmopen/vi_32/DYAIOgq83equSjO9AVmwhkt5Grf54q4VJFPz8QaYtYvAxxQw9D28touZYcmAIsI0GZxdv0DuFvzyLZA4j57SlQ/132","comment_is_top":false,"comment_ctime":1566786383,"is_pvip":false,"replies":[{"id":"47357","content":"finalä¸èƒ½ç”¨äºåŒé‡æ£€æŸ¥ï¼Œè¯­æ³•çº¦æŸ","user_name":"ä½œè€…å›å¤","user_name_real":"ç‹å®ä»¤","uid":"1269969","ctime":1566793779,"ip_address":"","comment_id":127736,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1566786383","product_id":100023901,"comment_content":"ç‹è€å¸ˆæ‚¨å¥½ï¼Œæ ¹æ®æ–‡ç« ä¸­çš„&quot;å½“ç„¶äº†ï¼Œåœ¨ 1.5 ä»¥å Java å†…å­˜æ¨¡å‹å¯¹ finalç±»å‹å˜é‡çš„é‡æ’è¿›è¡Œäº†çº¦æŸ&quot;ï¼Œè¿™ä¹Ÿå°±æ˜¯è¯´åŒé‡æ ¡éªŒé”çš„å•ä¾‹æ¨¡å¼ï¼Œåªè¦ä½¿ç”¨finalæ¥ä¿®é¥°å•ä¾‹å¯¹è±¡ï¼Œå°±ä¸ä¼šå‘ç”Ÿä¹‹å‰æåˆ°è¿‡çš„ï¼Œå…ˆåˆ†é…å†…å­˜ï¼Œä¹‹ååˆ›å»ºå¯¹è±¡å¼•ç”¨ï¼Œæœ€åå†å®é™…åˆ›å»ºå¯¹è±¡(æŒ‡ä»¤é‡æ’)è¿™ç§æƒ…å†µäº†å§ï¼Ÿ<br>","like_count":0,"discussions":[{"author":{"id":1269969,"avatar":"https://static001.geekbang.org/account/avatar/00/13/60/d1/8efa89ab.jpg","nickname":"ç‹å®ä»¤","note":"","ucode":"4FE19F5BC32FCA","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":464629,"discussion_content":"finalä¸èƒ½ç”¨äºåŒé‡æ£€æŸ¥ï¼Œè¯­æ³•çº¦æŸ","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1566793779,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":126894,"user_name":"Sean","can_delete":false,"product_type":"c1","uid":1242497,"ip_address":"","ucode":"2521FB6292F304","user_header":"https://static001.geekbang.org/account/avatar/00/12/f5/81/92d01e3a.jpg","comment_is_top":false,"comment_ctime":1566518964,"is_pvip":false,"discussion_count":1,"race_medal":0,"score":"1566518964","product_id":100023901,"comment_content":"ç¼–è¯‘æŒ‡ä»¤ä¼˜åŒ–æ˜¯CPUæŒ‡ä»¤çº§åˆ«è¿˜æ˜¯åº”ç”¨ä»£ç çº§åˆ«çš„ï¼Ÿ","like_count":0,"discussions":[{"author":{"id":1196339,"avatar":"https://static001.geekbang.org/account/avatar/00/12/41/33/d1064f9a.jpg","nickname":"Sun","note":"","ucode":"1BC2741DC07FC5","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":198825,"discussion_content":"jvmå±‚é¢å’Œcpuå±‚é¢éƒ½æœ‰","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1583515204,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":122589,"user_name":"å‡ ç±³é˜³å…‰","can_delete":false,"product_type":"c1","uid":1157656,"ip_address":"","ucode":"0FE186125049A6","user_header":"https://static001.geekbang.org/account/avatar/00/11/aa/18/dfd867af.jpg","comment_is_top":false,"comment_ctime":1565429419,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1565429419","product_id":100023901,"comment_content":"1ã€volatileä¿®é¥°abcå˜é‡<br>2ã€finalä¿®é¥°abcå˜é‡<br>3ã€synchornizeè¯­å—ä¸­å¯¹abcå˜é‡è®¾å€¼","like_count":0},{"had_liked":false,"id":117380,"user_name":"Fortune","can_delete":false,"product_type":"c1","uid":1508654,"ip_address":"","ucode":"6B9465AC996523","user_header":"https://static001.geekbang.org/account/avatar/00/17/05/2e/5a6b6b6e.jpg","comment_is_top":false,"comment_ctime":1564036280,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1564036280","product_id":100023901,"comment_content":"çœ‹äº†è¯„è®ºåï¼Œæ„Ÿè§‰è‡ªå·±è¿˜æ˜¯ä¸ç¡®å®šæ€ä¹ˆç†è§£å“ˆï¼Œå…ˆæ„Ÿè°¢è€å¸ˆçš„åˆ†äº«ï¼Œå¸Œæœ›æ€»ç»“è¿™å—è€å¸ˆå¯ä»¥å¯¹çŸ¥è¯†ç‚¹è¿›è¡Œä¸€ä¸ªç¡®åˆ‡çš„æ€»ç»“ï¼Œå°±æ˜¯è¦è®©æˆ‘ä»¬è¿™äº›å°ç™½çŸ¥é“äº›ä»€ä¹ˆå°±å¯ä»¥äº†ï¼Œä¸Šç½‘çœ‹äº†ä¸‹HBè§„åˆ™çš„ç†è§£ï¼š<br>1ï¼šå°±æ˜¯è¯´æˆ‘ä»¬ç¼–å†™çš„ç¨‹åºéƒ½è¦ç»è¿‡ä¼˜åŒ–åï¼ˆç¼–è¯‘å™¨å’Œå¤„ç†å™¨ä¼šå¯¹æˆ‘ä»¬çš„ç¨‹åºè¿›è¡Œä¼˜åŒ–ä»¥æé«˜è¿è¡Œæ•ˆç‡ï¼‰æ‰ä¼šè¢«è¿è¡Œï¼Œä¼˜åŒ–åˆ†ä¸ºå¾ˆå¤šç§ï¼Œå…¶ä¸­æœ‰ä¸€ç§ä¼˜åŒ–å«åšé‡æ’åºï¼Œé‡æ’åºéœ€è¦éµå®ˆhappens-beforeè§„åˆ™ï¼Œè¿™é‡Œå‚è€ƒè€å¸ˆåˆ—å‡ºçš„è§„åˆ™ï¼Œå¾ˆè¯¦ç»†ï¼›<br>2ï¼šç¨‹åºé¡ºåºè§„åˆ™ä¸­æ‰€è¯´çš„æ¯ä¸ªæ“ä½œhappens-beforeäºè¯¥çº¿ç¨‹ä¸­çš„ä»»æ„åç»­æ“ä½œå¹¶ä¸æ˜¯è¯´å‰ä¸€ä¸ªæ“ä½œå¿…é¡»è¦åœ¨åä¸€ä¸ªæ“ä½œä¹‹å‰æ‰§è¡Œï¼Œè€Œæ˜¯æŒ‡å‰ä¸€ä¸ªæ“ä½œçš„æ‰§è¡Œç»“æœå¿…é¡»å¯¹åä¸€ä¸ªæ“ä½œå¯è§ï¼Œå¦‚æœä¸æ»¡è¶³è¿™ä¸ªè¦æ±‚é‚£å°±ä¸å…è®¸è¿™ä¸¤ä¸ªæ“ä½œè¿›è¡Œé‡æ’åºã€‚<br>è§„åˆ™æ€»ç»“ï¼š<br>ç¨‹åºæ¬¡åºè§„åˆ™ï¼šåœ¨ä¸€ä¸ªçº¿ç¨‹å†…ä¸€æ®µä»£ç çš„æ‰§è¡Œç»“æœæ˜¯æœ‰åºçš„ã€‚å°±æ˜¯è¿˜ä¼šæŒ‡ä»¤é‡æ’ï¼Œä½†æ˜¯éšä¾¿å®ƒæ€ä¹ˆæ’ï¼Œç»“æœæ˜¯æŒ‰ç…§æˆ‘ä»¬ä»£ç çš„é¡ºåºç”Ÿæˆçš„ä¸ä¼šå˜ï¼<br><br>ç®¡ç¨‹é”å®šè§„åˆ™ï¼šå°±æ˜¯æ— è®ºæ˜¯åœ¨å•çº¿ç¨‹ç¯å¢ƒè¿˜æ˜¯å¤šçº¿ç¨‹ç¯å¢ƒï¼Œå¯¹äºåŒä¸€ä¸ªé”æ¥è¯´ï¼Œä¸€ä¸ªçº¿ç¨‹å¯¹è¿™ä¸ªé”è§£é”ä¹‹åï¼Œå¦ä¸€ä¸ªçº¿ç¨‹è·å–äº†è¿™ä¸ªé”éƒ½èƒ½çœ‹åˆ°å‰ä¸€ä¸ªçº¿ç¨‹çš„æ“ä½œç»“æœï¼(ç®¡ç¨‹æ˜¯ä¸€ç§é€šç”¨çš„åŒæ­¥åŸè¯­ï¼Œsynchronizedå°±æ˜¯ç®¡ç¨‹çš„å®ç°ï¼‰<br><br>volatileå˜é‡è§„åˆ™ï¼šå°±æ˜¯å¦‚æœä¸€ä¸ªçº¿ç¨‹å…ˆå»å†™ä¸€ä¸ªvolatileå˜é‡ï¼Œç„¶åä¸€ä¸ªçº¿ç¨‹å»è¯»è¿™ä¸ªå˜é‡ï¼Œé‚£ä¹ˆè¿™ä¸ªå†™æ“ä½œçš„ç»“æœä¸€å®šå¯¹è¯»çš„è¿™ä¸ªçº¿ç¨‹å¯è§ã€‚<br><br>çº¿ç¨‹å¯åŠ¨è§„åˆ™ï¼šåœ¨ä¸»çº¿ç¨‹Aæ‰§è¡Œè¿‡ç¨‹ä¸­ï¼Œå¯åŠ¨å­çº¿ç¨‹Bï¼Œé‚£ä¹ˆçº¿ç¨‹Aåœ¨å¯åŠ¨å­çº¿ç¨‹Bä¹‹å‰å¯¹å…±äº«å˜é‡çš„ä¿®æ”¹ç»“æœå¯¹çº¿ç¨‹Bå¯è§ã€‚ï¼ˆçº¿ç¨‹startè§„åˆ™ï¼‰<br><br>çº¿ç¨‹ç»ˆæ­¢è§„åˆ™ï¼šåœ¨ä¸»çº¿ç¨‹Aæ‰§è¡Œè¿‡ç¨‹ä¸­ï¼Œå­çº¿ç¨‹Bç»ˆæ­¢ï¼Œé‚£ä¹ˆçº¿ç¨‹Båœ¨ç»ˆæ­¢ä¹‹å‰å¯¹å…±äº«å˜é‡çš„ä¿®æ”¹ç»“æœåœ¨çº¿ç¨‹Aä¸­å¯è§ã€‚<br><br>çº¿ç¨‹ä¸­æ–­è§„åˆ™ï¼šå¯¹çº¿ç¨‹interrupt()æ–¹æ³•çš„è°ƒç”¨å…ˆè¡Œå‘ç”Ÿäºè¢«ä¸­æ–­çº¿ç¨‹ä»£ç æ£€æµ‹åˆ°ä¸­æ–­äº‹ä»¶çš„å‘ç”Ÿï¼Œå¯ä»¥é€šè¿‡Thread.interrupted()æ£€æµ‹åˆ°æ˜¯å¦å‘ç”Ÿä¸­æ–­ã€‚<br><br>ä¼ é€’è§„åˆ™ï¼šè¿™ä¸ªç®€å•çš„ï¼Œå°±æ˜¯happens-beforeåŸåˆ™å…·æœ‰ä¼ é€’æ€§ï¼Œå³A happens-before B ï¼Œ B happens-before Cï¼Œé‚£ä¹ˆA happens-before Cã€‚<br><br>å¯¹è±¡ç»ˆç»“è§„åˆ™ï¼šè¿™ä¸ªä¹Ÿç®€å•çš„ï¼Œå°±æ˜¯ä¸€ä¸ªå¯¹è±¡çš„åˆå§‹åŒ–çš„å®Œæˆï¼Œä¹Ÿå°±æ˜¯æ„é€ å‡½æ•°æ‰§è¡Œçš„ç»“æŸä¸€å®š happens-beforeå®ƒçš„finalize()æ–¹æ³•ã€‚<br>ä»¥åŠè€å¸ˆè¯´çš„finalè§„åˆ™å’Œçº¿ç¨‹ join() è§„åˆ™ã€‚","like_count":0},{"had_liked":false,"id":115897,"user_name":"å®çŸ³å±±","can_delete":false,"product_type":"c1","uid":1295061,"ip_address":"","ucode":"3ADF20E12EBF99","user_header":"https://static001.geekbang.org/account/avatar/00/13/c2/d5/126eac1a.jpg","comment_is_top":false,"comment_ctime":1563763309,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1563763309","product_id":100023901,"comment_content":"å…³äºHappens-BeforeåŸåˆ™çš„ç¬¬å››æ¡&lt;ç®¡ç¨‹ä¸­é”çš„è§„åˆ™&gt;, æœ‰è¿™æ ·ä¸€æ®µä»£ç å‡è®¾iåˆå§‹å€¼æ˜¯0, ä¸¤ä¸ªåŒæ­¥å—ç”¨äº†ä¸åŒçš„é”, é‚£ä¹ˆçº¿ç¨‹Açš„åŒæ­¥å—æ‰§è¡Œå®Œäº†æ‰§è¡Œçº¿ç¨‹Bçš„åŒæ­¥å—è¿™ä¸ªæ—¶å€™ièƒ½çœ‹åˆ°10å—? æˆ‘è§‰å¾—æ˜¯èƒ½çœ‹åˆ°10çš„, å› ä¸ºçº¿ç¨‹Aæ‰§è¡Œå®Œäº†ä¼šæŠŠiåˆ·å…¥å†…å­˜, é‚£ä¹ˆè¿™ä¸ªæ—¶å€™çº¿ç¨‹Bä¼šæ‹¿åˆ°æ–°å€¼<br><br>çº¿ç¨‹Aæ‰§è¡Œ<br>...<br>synchronized(lock1){<br>\ti = 10;<br>}<br>...<br><br>çº¿ç¨‹Bæ‰§è¡Œ<br>...<br>synchronized(lock2){<br>\tSystem.out.print(i)<br>}<br>...","like_count":0},{"had_liked":false,"id":115451,"user_name":"æ‹¯æ•‘åœ°çƒå¥½ç´¯","can_delete":false,"product_type":"c1","uid":1339022,"ip_address":"","ucode":"7643439601EF4C","user_header":"https://static001.geekbang.org/account/avatar/00/14/6e/8e/5d309a85.jpg","comment_is_top":false,"comment_ctime":1563590749,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1563590749","product_id":100023901,"comment_content":"---æ€»ç»“---<br>1.A Happens-before Bå¹¶éæŒ‡æ“ä½œAä¸€å®šå‘ç”Ÿåœ¨æ“ä½œBä¹‹å‰ï¼Œè€Œæ˜¯æŒ‡Aæ“ä½œçš„ç»“æœå¯¹Bæ“ä½œå¯è§ã€‚<br>2.JAVAå†…å­˜æ¨¡å‹ä¸»è¦æ˜¯é’ˆå¯¹å¯è§æ€§é—®é¢˜ï¼ˆåˆç§°ä¸ºå†…å­˜é‡æ’åºé—®é¢˜ï¼‰å’Œæœ‰åºæ€§é—®é¢˜ï¼ˆåˆç§°ä¸ºæŒ‡ä»¤é‡æ’åºé—®é¢˜ï¼‰çš„è§£å†³æ–¹æ¡ˆã€‚","like_count":0},{"had_liked":false,"id":113459,"user_name":"èµµå°æ´›","can_delete":false,"product_type":"c1","uid":1592232,"ip_address":"","ucode":"A326C12B1A1ABA","user_header":"https://static001.geekbang.org/account/avatar/00/18/4b/a8/14b8a860.jpg","comment_is_top":false,"comment_ctime":1563021354,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1563021354","product_id":100023901,"comment_content":"æ€è€ƒé¢˜ï¼š<br>1.å¯ä»¥ä½¿ç”¨ volatile ä¿®é¥°å…±äº«å˜é‡<br>2.å¯ä»¥å¯¹ä¿®æ”¹å…±äº«å˜é‡çš„æ“ä½œæˆ–è€…æ–¹æ³•  åŠ ä¸Šsynchronize<br>3.å¦‚æœä¸€ä¸ª æ˜¯å­çº¿ç¨‹ ä¸€ä¸ªä¸»çº¿ç¨‹ å¯ä»¥ä½¿ç”¨å­çº¿ç¨‹çš„joinæ–¹æ³•ï¼Œç„¶åä¸»çº¿ç¨‹å°±å¯è§ã€‚<br><br>ç–‘é—®ï¼š<br>public static void main(String[] args) {<br><br>        final int[] a = {200};<br>        Thread thread = new Thread(new Runnable() {<br>            @Override<br>            public void run() {<br>                a[0] = 300;<br>                System.out.println(&quot;æˆ‘æ˜¯å­çº¿ç¨‹&quot;+Thread.currentThread().getName()+&quot;  &quot;+a[0]);<br>            }<br>        });<br><br>        Thread thread2 = new Thread(new Runnable() {<br>            @Override<br>            public void run() {<br>                System.out.println(&quot;æˆ‘æ˜¯å­çº¿ç¨‹&quot;+Thread.currentThread().getName()+&quot;  &quot;+a[0]);<br>            }<br>        });<br><br>        thread.start();<br>        thread2.start();<br>        System.out.println(a[0]);<br><br>    }<br><br><br><br><br>è¾“å‡ºçš„ç»“æœ <br>200<br>æˆ‘æ˜¯å­çº¿ç¨‹Thread-0  300<br>æˆ‘æ˜¯å­çº¿ç¨‹Thread-1  300<br><br><br>ä¸ºä»€ä¹ˆ ä¸¤ä¸ªå­çº¿ç¨‹æ‹¿åˆ°çš„ç»“æœæ˜¯ä¸€æ ·çš„ï¼Ÿ ä¸ºä»€ä¹ˆä¸»çº¿ç¨‹å’Œå­çº¿ç¨‹ç»“æœä¸ä¸€æ ·<br><br><br><br>","like_count":0},{"had_liked":false,"id":112743,"user_name":"ccf2019","can_delete":false,"product_type":"c1","uid":1260710,"ip_address":"","ucode":"E9D6F4066EB3DD","user_header":"https://static001.geekbang.org/account/avatar/00/13/3c/a6/acaf5a24.jpg","comment_is_top":false,"comment_ctime":1562813252,"is_pvip":false,"discussion_count":1,"race_medal":0,"score":"1562813252","product_id":100023901,"comment_content":"    public static void main(String[] args) {<br><br>        Map&lt;String, Integer&gt; params = new HashMap&lt;&gt;();<br>        params.put(&quot;must_fields&quot;,2);<br>        params.put(&quot;should_fields&quot;,5);<br>        params.put(&quot;must_not_fields&quot;,1);<br><br>        CompletableFuture mustFuture = CompletableFuture.runAsync(() -&gt; {<br>            if(params.containsKey(&quot;must_fields&quot;)){<br>                Integer must = params.get(&quot;must_fields&quot;);<br>                for (int i = 0;i&lt;100000;i++){<br>                    must += 1;<br>                }<br>                params.put(&quot;must_fields&quot;,must);<br>            }<br>        });<br><br>        CompletableFuture shouldFuture = CompletableFuture.runAsync(() -&gt; {<br>            if(params.containsKey(&quot;should_fields&quot;)){<br>                Integer should = params.get(&quot;should_fields&quot;);<br>                for (int i = 0;i&lt;10000;i++){<br>                    should += 1;<br>                }<br>                params.put(&quot;should_fields&quot;,should);<br>            }<br>        });<br><br><br>        CompletableFuture notFuture = CompletableFuture.runAsync(() -&gt; {<br>            if(params.containsKey(&quot;must_not_fields&quot;)){<br>                Integer not = params.get(&quot;must_not_fields&quot;);<br>                for (int i = 0;i&lt;10000;i++){<br>                    not += 1;<br>                }<br>                params.put(&quot;must_not_fields&quot;,not);<br>            }<br>        });<br><br>        mustFuture.join();<br>        shouldFuture.join();<br>        notFuture.join();<br><br>        System.out.println(&quot;å®Œæ¯•&quot;);<br>        System.out.println(params.toString());<br>    }<br>è€å¸ˆï¼Œæˆ‘è¿™æ ·å†™ç¨‹åºï¼Œparamsè¿™ä¸ªé‡Œé¢çš„æ•°æ®ä¼šä¸ä¼šæ¯æ¬¡éƒ½ä¸ç›¸åŒå‘¢ï¼Ÿ","like_count":0,"discussions":[{"author":{"id":1004192,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/52/a0/d308434e.jpg","nickname":"StarKing","note":"","ucode":"EB825CFA70AC1F","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":14862,"discussion_content":"å’Œ thread.start()ä¸€æ ·çš„.å¸¦äº†join()","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1568784779,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":110559,"user_name":"itschenxiang","can_delete":false,"product_type":"c1","uid":1519547,"ip_address":"","ucode":"7D90194AC52435","user_header":"https://static001.geekbang.org/account/avatar/00/17/2f/bb/4236d712.jpg","comment_is_top":false,"comment_ctime":1562294348,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1562294348","product_id":100023901,"comment_content":"è¯·é—®ideçš„debugåŠŸèƒ½æ˜¯æ€æ ·çš„æœºåˆ¶ï¼Ÿä¸»è¦æ˜¯æƒ³äº†è§£debugæ˜¯ä¸æ˜¯å°±ä¸ä¼šä¼˜åŒ–æ¯”å¦‚è¯­å¥çš„å‰åé¡ºåºå˜äº†ä»€ä¹ˆçš„","like_count":0},{"had_liked":false,"id":108356,"user_name":"æäº®äº®","can_delete":false,"product_type":"c1","uid":1116508,"ip_address":"","ucode":"290907F930B261","user_header":"https://static001.geekbang.org/account/avatar/00/11/09/5c/b5d79d20.jpg","comment_is_top":false,"comment_ctime":1561727467,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1561727467","product_id":100023901,"comment_content":"å¯¹äºé‡æ’åºé‚£é‡Œï¼Œæˆ‘çš„ç†è§£æ˜¯å½“å…¶ä»–çº¿ç¨‹çœ‹åˆ°vä¸ºtrueçš„æ—¶å€™ï¼Œå¿…é¡»è¦ä¿è¯xå·²ç»èµ‹å€¼ä¸º42äº†ï¼Œè¿™ä¸ªå°±æ˜¯é¡ºåºæ€§åŸåˆ™ã€‚åŒæ—¶ä¹Ÿè¯´æ˜äº†volatileå…³é”®å­—è¿˜æ˜¯å½±å“äº†xï¼Œå¹¶ä¸èƒ½è¯´çœŸæ­£æ„ä¹‰ä¸Šçš„vè·Ÿxæ²¡å…³ç³»ã€‚","like_count":0},{"had_liked":false,"id":107220,"user_name":"a(à¹‘â‰–à¸´Ù¼â‰–à¸´)âœŒ","can_delete":false,"product_type":"c1","uid":1392431,"ip_address":"","ucode":"AEF9B5CA1605DF","user_header":"https://static001.geekbang.org/account/avatar/00/15/3f/2f/8513c4d3.jpg","comment_is_top":false,"comment_ctime":1561489338,"is_pvip":false,"replies":[{"id":"38788","content":"å¯è§æ€§æŒ‡çš„æ˜¯è®¾ç½®äº†abc=3ä¹‹åï¼Œå…¶ä»–çº¿ç¨‹æ˜¯å¦çœ‹å¾—åˆ°","user_name":"ä½œè€…å›å¤","user_name_real":"ç‹å®ä»¤","uid":"1269969","ctime":1561506525,"ip_address":"","comment_id":107220,"utype":1}],"discussion_count":1,"race_medal":1,"score":"1561489338","product_id":100023901,"comment_content":"æˆ‘è§‰å¾—volatileä¸ä¸€å®šèƒ½ä¿è¯å…¶ä»–çº¿ç¨‹çœ‹åˆ°3ï¼Œé™¤éèƒ½ä¿è¯è®¾ç½®3çš„çº¿ç¨‹åœ¨å…¶ä»–çº¿ç¨‹è¯»å–abcè¿™ä¸ªå˜é‡ä¹‹å‰å…ˆæ‰§è¡Œåˆ°è®¾ç½®abc=3çš„é‚£è¡Œï¼Œä»¥å‰æ²¡ç”¨è¿‡volatileå…³é”®å­—ï¼Œä¸çŸ¥é“æˆ‘çš„ç†è§£å¯¹ä¸å¯¹","like_count":0,"discussions":[{"author":{"id":1269969,"avatar":"https://static001.geekbang.org/account/avatar/00/13/60/d1/8efa89ab.jpg","nickname":"ç‹å®ä»¤","note":"","ucode":"4FE19F5BC32FCA","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":455424,"discussion_content":"å¯è§æ€§æŒ‡çš„æ˜¯è®¾ç½®äº†abc=3ä¹‹åï¼Œå…¶ä»–çº¿ç¨‹æ˜¯å¦çœ‹å¾—åˆ°","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1561506525,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":107219,"user_name":"a(à¹‘â‰–à¸´Ù¼â‰–à¸´)âœŒ","can_delete":false,"product_type":"c1","uid":1392431,"ip_address":"","ucode":"AEF9B5CA1605DF","user_header":"https://static001.geekbang.org/account/avatar/00/15/3f/2f/8513c4d3.jpg","comment_is_top":false,"comment_ctime":1561487293,"is_pvip":false,"discussion_count":0,"race_medal":1,"score":"1561487293","product_id":100023901,"comment_content":"æ€è€ƒé¢˜é™¤äº†å…¶ä»–åŒå­¦çš„å›ç­”ï¼Œæˆ‘æƒ³åˆ°ç”¨completableFutureä¸çŸ¥é“ç®—ä¸ç®—ï¼Œ<br><br>        CompletableFuture.supplyAsync(() -&gt; obj.set3()).thenAcceptAsync(obj1 -&gt; {<br>            try {<br>                Assert.assertEquals(0, obj1.get3());<br>            } catch (Exception e) {<br>                log.info(e.getMessage());<br>            }<br>        }).get();<br>    ","like_count":0},{"had_liked":false,"id":107216,"user_name":"a(à¹‘â‰–à¸´Ù¼â‰–à¸´)âœŒ","can_delete":false,"product_type":"c1","uid":1392431,"ip_address":"","ucode":"AEF9B5CA1605DF","user_header":"https://static001.geekbang.org/account/avatar/00/15/3f/2f/8513c4d3.jpg","comment_is_top":false,"comment_ctime":1561483421,"is_pvip":false,"discussion_count":0,"race_medal":1,"score":"1561483421","product_id":100023901,"comment_content":"Thread B = new Thread(()-&gt;{<br>  &#47;&#47; ä¸»çº¿ç¨‹è°ƒç”¨ B.start() ä¹‹å‰<br>  &#47;&#47; æ‰€æœ‰å¯¹å…±äº«å˜é‡çš„ä¿®æ”¹ï¼Œæ­¤å¤„çš†å¯è§<br>  &#47;&#47; æ­¤ä¾‹ä¸­ï¼Œvar==77<br>});<br>&#47;&#47; æ­¤å¤„å¯¹å…±äº«å˜é‡ var ä¿®æ”¹<br>var = 77;<br>&#47;&#47; ä¸»çº¿ç¨‹å¯åŠ¨å­çº¿ç¨‹<br>B.start();<br><br>è¿™æ®µä»£ç é‡Œï¼Œvar = 77è¿™ä¸ªï¼Œå› ä¸ºåœ¨lambdaè¡¨è¾¾å¼é‡Œç”¨åˆ°äº†ï¼Œå®šä¹‰æ—¶åœ¨javaé‡Œé¢å¿…é¡»ä¸ºfinalå§ï¼ˆæˆ‘è¯•ç€æ”¹ä¸ºç»§æ‰¿Threadçš„åŒ¿åå†…éƒ¨ç±»ï¼Œä¹Ÿå¾—æ˜¯finalçš„ï¼‰ï¼Œä¹Ÿå°±æ˜¯è¯´åœ¨è¿™ä¸èƒ½å†æ¬¡èµ‹å€¼ä¸º77ï¼Œæ˜¯ä¸æ˜¯è¿™ä¸ªä¾‹å­ä¸¾é”™äº†ï¼Ÿ","like_count":0},{"had_liked":false,"id":107067,"user_name":"Tomcat","can_delete":false,"product_type":"c1","uid":1399488,"ip_address":"","ucode":"58A9D44991EDB7","user_header":"https://static001.geekbang.org/account/avatar/00/15/5a/c0/e20eb855.jpg","comment_is_top":false,"comment_ctime":1561452180,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1561452180","product_id":100023901,"comment_content":"æˆ‘è§‰å¾—å‰ä¸‰æ¡çš„ä¾‹å­ç”¨startåŸåˆ™å»ç†è§£æ›´åŠ ç®€å•ä¸€äº›å§     å¦‚æœåœ¨ä¸¤ä¸ªçº¿ç¨‹ä¸­è¿›è¡Œè¯»å†™çš„è¯  åœ¨å¯åŠ¨çº¿ç¨‹ä¹‹å‰x véƒ½å·²ç»èµ‹å€¼äº†  æ‰€ä»¥ä¸»çº¿ç¨‹çš„æ“ä½œå¯¹ å…¶ä½™ä¸¤ä¸ªçº¿ç¨‹éƒ½æ˜¯å¯è§çš„","like_count":0},{"had_liked":false,"id":106522,"user_name":"chuenfaiy","can_delete":false,"product_type":"c1","uid":1291234,"ip_address":"","ucode":"71F1898C8CACA5","user_header":"https://static001.geekbang.org/account/avatar/00/13/b3/e2/7bdc7255.jpg","comment_is_top":false,"comment_ctime":1561339040,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1561339040","product_id":100023901,"comment_content":"æˆ‘è§‰å¾—ç¬¬ä¸€æ¡çš„é¡ºåºæ€§æ˜¯å»ºç«‹åœ¨åé¢å‡ æ¡è§„åˆ™çš„åŸºç¡€ä¸Šçš„ï¼Œå³ä¾èµ–äºvolatileï¼Œsynchronizedï¼Œjoinï¼Œstartè¿™äº›æ“ä½œè®¾ç½®å†…å­˜å±éšœ","like_count":0},{"had_liked":false,"id":106103,"user_name":"å­éé±¼","can_delete":false,"product_type":"c1","uid":1146001,"ip_address":"","ucode":"7577222878C1E1","user_header":"https://static001.geekbang.org/account/avatar/00/11/7c/91/0d8e2472.jpg","comment_is_top":false,"comment_ctime":1561175077,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1561175077","product_id":100023901,"comment_content":"æœ‰ä¸€ç‚¹ä¸è§£ï¼Œhappens-before åŸåˆ™2é‚£é‡Œï¼Œè¢«volatileä¿®é¥°çš„å˜é‡çš„å†™æ“ä½œhappens beforeå¯¹è¿™ä¸ªå˜é‡çš„è¯»æ“ä½œï¼Œæ„æ€æ˜¯è¢«volatileä¿®é¥°çš„å˜é‡çš„å†™æ“ä½œå·²ç»æ˜¯åŸå­æ“ä½œäº†å—ï¼Œæ¯•ç«Ÿå†™æ“ä½œåŸæœ¬æ˜ å°„æˆæœºå™¨æŒ‡ä»¤æ˜¯éœ€è¦å‡ æ­¥æ‰èƒ½å®Œæˆçš„","like_count":0},{"had_liked":false,"id":105014,"user_name":"å¤ªé˜³æ˜¯å—åšå†°","can_delete":false,"product_type":"c1","uid":1049787,"ip_address":"","ucode":"65248FD55F1DB5","user_header":"https://static001.geekbang.org/account/avatar/00/10/04/bb/dc12831e.jpg","comment_is_top":false,"comment_ctime":1560905630,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1560905630","product_id":100023901,"comment_content":"ç¬¬ä¸‰æ¬¡çœ‹æœ¬ç¯‡æ–‡ç« ï¼Œæ¯æ¬¡éƒ½æœ‰ä¸åŒçš„æ„Ÿæ‚Ÿï¼Œæ„Ÿè°¢è€å¸ˆå’Œå„ä½è¯„è®ºåŒºçš„å¤§ç¥ã€‚","like_count":0},{"had_liked":false,"id":103293,"user_name":"iHelin","can_delete":false,"product_type":"c1","uid":1001364,"ip_address":"","ucode":"B9C15A0674B46D","user_header":"https://static001.geekbang.org/account/avatar/00/0f/47/94/9682a82e.jpg","comment_is_top":false,"comment_ctime":1560410302,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1560410302","product_id":100023901,"comment_content":"æœ€åçš„æ€è€ƒé¢˜ï¼Œå¦‚æœåœ¨ä¸€ä¸ªçº¿ç¨‹é‡Œè®¾ç½®äº† abc çš„å€¼ ä¸º3ï¼Œé‚£ä¹ˆåœ¨è¿™ä¸ªçº¿ç¨‹é‡Œé¢åˆ›å»ºæ–°çš„çº¿ç¨‹ï¼Œè¿™äº›æ–°çš„çº¿ç¨‹åº”è¯¥å°±èƒ½çœ‹åˆ°äº†å§ï¼Ÿå‚è€ƒhappens-beforeè§„åˆ™ä¸­çš„çº¿ç¨‹startè§„åˆ™ã€‚","like_count":0},{"had_liked":false,"id":100539,"user_name":"æ™´å¤©å¬å¤œæ›²","can_delete":false,"product_type":"c1","uid":1245813,"ip_address":"","ucode":"D0099EC299A18C","user_header":"https://static001.geekbang.org/account/avatar/00/13/02/75/96a111c1.jpg","comment_is_top":false,"comment_ctime":1559573192,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1559573192","product_id":100023901,"comment_content":"ä¹‹å‰å¯¹javaå¹¶å‘æ€»æ˜¯æ•¬è€Œè¿œä¹‹,ä½†æ˜¯çœ‹äº†è€å¸ˆçš„è¯¾ä¹‹å,æ„Ÿè§‰è‡ªå·±ç¡®å®å·®äº†å¾ˆå¤š.åŠ æ²¹å§","like_count":0},{"had_liked":false,"id":100139,"user_name":"KnightÂ²ÂºÂ¹â¸","can_delete":false,"product_type":"c1","uid":1089754,"ip_address":"","ucode":"BDCB830B6A730F","user_header":"https://static001.geekbang.org/account/avatar/00/10/a0/da/4f50f1b2.jpg","comment_is_top":false,"comment_ctime":1559456911,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1559456911","product_id":100023901,"comment_content":"JMM ä¸­çš„å·¥ä½œå†…å­˜å¯¹åº”åˆ°ç‰©ç†è®¾å¤‡ä¸Šåˆ°åº•æŒ‡æ˜¯å“ªå—å†…å­˜ï¼ŸCPU Cahce è¿˜æ˜¯ ARMï¼Ÿè¿™ä¸ªé—®é¢˜ä¸€ç›´æ²¡æœ‰ææ‡‚ã€‚","like_count":0},{"had_liked":false,"id":98753,"user_name":"æª","can_delete":false,"product_type":"c1","uid":1445711,"ip_address":"","ucode":"4DE93FEC0AD403","user_header":"https://static001.geekbang.org/account/avatar/00/16/0f/4f/6c2339f9.jpg","comment_is_top":false,"comment_ctime":1559090917,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1559090917","product_id":100023901,"comment_content":"ç¨‹åºçš„é¡ºåºæ€§å‰ææ˜¯åœ¨ä¸€ä¸ªçº¿ç¨‹ä¸­ï¼Œå¦‚æœx=42;å’Œv=trueä¸åœ¨ä¸€ä¸ªçº¿ç¨‹ä¸­ã€‚é‚£ä¹ˆæ˜¯ä¸æ˜¯readeræ–¹æ³•è¿˜æ˜¯ä¼šå­˜åœ¨è¯»ä¸åˆ°x=42","like_count":0},{"had_liked":false,"id":97696,"user_name":"çŒ´å“¥ä¸€ä¸€ cium","can_delete":false,"product_type":"c1","uid":1254801,"ip_address":"","ucode":"38EC64F8D1A0B4","user_header":"https://static001.geekbang.org/account/avatar/00/13/25/91/46600294.jpg","comment_is_top":false,"comment_ctime":1558750649,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1558750649","product_id":100023901,"comment_content":"çœ‹å®Œè¿™ç¯‡è®²è§£ï¼Œè®©æˆ‘æƒ³èµ·â€œå†…å­˜æ¨¡å‹æ˜¯jvmä¿è¯çº¿ç¨‹å®‰å…¨çš„ä¸€ç³»åˆ—è§„èŒƒâ€è¿™å¥è¯ã€‚ä¸çŸ¥æ°å½“ä¸","like_count":0},{"had_liked":false,"id":97446,"user_name":"Sam","can_delete":false,"product_type":"c1","uid":1183165,"ip_address":"","ucode":"701948553DB5FE","user_header":"https://static001.geekbang.org/account/avatar/00/12/0d/bd/57ab02f5.jpg","comment_is_top":false,"comment_ctime":1558673454,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1558673454","product_id":100023901,"comment_content":"volatileå˜é‡è§„åˆ™ç–‘æƒ‘ï¼š<br> å¯¹ä¸€ä¸ªvolatileå˜é‡çš„å†™æ“ä½œï¼ŒHappens-Beforeäºåç»­å¯¹è¿™ä¸ªå˜é‡çš„è¯»æ“ä½œï¼Œå¯¹è¿™å¥è¯çš„ç†è§£ï¼Œä¹Ÿå°±æ˜¯å¦‚æœæœ‰ä¸€ä¸ªvolatileå˜é‡ï¼Œæœ‰ä¸¤ä¸ªçº¿ç¨‹ä¸€ä¸ªåœ¨å†™è¿™ä¸ªå˜é‡ï¼Œä¸€ä¸ªåœ¨è¯»è¿™ä¸ªå˜é‡ï¼Œé‚£ä¹ˆè‚¯å®šæ˜¯å†™å…ˆæ‰§è¡Œï¼Œè¯»åæ‰§è¡Œï¼Œé‚£ä¹ˆæˆ‘çš„ç–‘æƒ‘æ˜¯ï¼Œå‡å¦‚å†™çš„è¿™ä¸ªçº¿ç¨‹åœ¨å†™ä¹‹å‰ä¼‘çœ äº†ä¸€æ®µæ—¶é—´ï¼Œé‚£ä¹ˆè¯»å˜é‡è¿™ä¸ªçº¿ç¨‹åªèƒ½åœ¨æ­¤æ—¶ç­‰ç€å®ƒå†™å®Œæ‰èƒ½è¯»åˆ°å€¼ï¼Œè¿™ä¸­é—´ä¸€ç›´åœ¨ç­‰å¾…çŠ¶æ€å—ï¼Ÿ<br>è¯·è€å¸ˆæˆ–è€…åŒå­¦å¸®å¿™è§£ç­”ä¸€ä¸‹ï¼Œæ„Ÿè°¢å‘¢ï¼","like_count":0},{"had_liked":false,"id":97182,"user_name":"æ— å","can_delete":false,"product_type":"c1","uid":1110113,"ip_address":"","ucode":"2D2E877CF97138","user_header":"https://static001.geekbang.org/account/avatar/00/10/f0/61/68462a07.jpg","comment_is_top":false,"comment_ctime":1558603128,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1558603128","product_id":100023901,"comment_content":"å…³äºsenekisè¯´å¯¹å®ç°æ–¹å¼ä¸­ï¼š<br>2.å£°æ˜å…±äº«å˜é‡abcï¼Œåœ¨synchronizedå…³é”®å­—å¯¹abcçš„èµ‹å€¼ä»£ç å—åŠ é”ï¼Œç”±äºHappen-beforeç®¡ç¨‹é”çš„è§„åˆ™ï¼Œå¯ä»¥ä½¿å¾—åç»­çš„çº¿ç¨‹å¯ä»¥çœ‹åˆ°abcçš„å€¼ã€‚<br><br>æˆ‘çš„æµ‹è¯•ä»£ç ä¸ºï¼š<br><br>public class TestMemoryBarrier2 {<br><br>\tint abc = 0;<br><br>\tint read() {<br>\t\treturn abc;<br>\t}<br><br>\tsynchronized void write() {<br>\t\tabc = 3;<br>\t}<br><br>\tpublic static void main(String[] args) throws InterruptedException {<br>\t\tTestMemoryBarrier2 instance = new TestMemoryBarrier2();<br><br>\t\tnew Thread(() -&gt; {<br>\t\t\twhile (instance.read() != 3) {<br><br>\t\t\t}<br>\t\t\tSystem.out.println(&quot;Thread 1 è¯»å–åˆ°äº†å˜é‡abcåˆ°å€¼ä¸º3.&quot;);<br>\t\t}).start();<br><br>\t\tThread.sleep(1000);<br><br>\t\tnew Thread(() -&gt; {<br>\t\t\tinstance.write();<br>\t\t\tSystem.out.println(&quot;Thread 2 å°†å˜é‡abcæ”¹ä¸ºäº†3.&quot;);<br>\t\t}).start();<br>\t}<br>}<br>åœ¨jdk1.8ä¸­è¿è¡Œï¼Œä¸€ç›´æ²¡æœ‰æ‰§è¡Œï¼šThread 1 è¯»å–åˆ°äº†å˜é‡abcåˆ°å€¼ä¸º3.<br>ä½†æ˜¯æˆ‘åœ¨çº¿ç¨‹1ä¸­å¢åŠ äº†æ‰“å°ï¼š<br>\t\tnew Thread(() -&gt; {<br>\t\t\twhile (instance.read() != 3) {<br>\t\t\t\tSystem.out.println(&quot;Thread 1 æ²¡æœ‰è¯»å–åˆ°äº†å˜é‡abcåˆ°å€¼ä¸º3.&quot;);&#47;&#47;å¢åŠ åˆ°ä»£ç <br>\t\t\t}<br>\t\t\tSystem.out.println(&quot;Thread 1 è¯»å–åˆ°äº†å˜é‡abcåˆ°å€¼ä¸º3.&quot;);<br>\t\t}).start();<br>çº¿ç¨‹1åˆå¯ä»¥è¯»åˆ°abcä¸º3äº†ï¼Œæ‰“å°äº†Thread 1 è¯»å–åˆ°äº†å˜é‡abcåˆ°å€¼ä¸º3.<br>ç„¶åæˆ‘å°†é”æ”¾åœ¨äº†è¯»å–ä¸Šï¼Œå´èƒ½è¯»å–åˆ°3ï¼Œæ‰“å°äº†Thread 1 è¯»å–åˆ°äº†å˜é‡abcåˆ°å€¼ä¸º3.<br>å…·ä½“ä»£ç ä¸ºï¼š<br>public class TestMemoryBarrier2 {<br><br>\tint abc = 0;<br><br>\tsynchronized int read() {<br>\t\treturn abc;<br>\t}<br><br>\tvoid write() {<br>\t\tabc = 3;<br>\t}<br><br>\tpublic static void main(String[] args) throws InterruptedException {<br>\t\tTestMemoryBarrier2 instance = new TestMemoryBarrier2();<br><br>\t\tnew Thread(() -&gt; {<br>\t\t\twhile (instance.read() != 3) {<br>\t\t\t}<br>\t\t\tSystem.out.println(&quot;Thread 1 è¯»å–åˆ°äº†å˜é‡abcåˆ°å€¼ä¸º3.&quot;);<br>\t\t}).start();<br><br>\t\tThread.sleep(1000);<br><br>\t\tnew Thread(() -&gt; {<br>\t\t\tinstance.write();<br>\t\t\tSystem.out.println(&quot;Thread 2 å°†å˜é‡abcæ”¹ä¸ºäº†3.&quot;);<br>\t\t}).start();<br>\t}<br>}<br>è¿™ä¸ªæ˜¯ä»€ä¹ˆåŸå› å‘¢ï¼Ÿæ²¡æœ‰æƒ³æ˜ç™½ã€‚","like_count":0},{"had_liked":false,"id":96454,"user_name":"ä¸šä½™è‰","can_delete":false,"product_type":"c1","uid":1126538,"ip_address":"","ucode":"99BDC1E629049D","user_header":"https://static001.geekbang.org/account/avatar/00/11/30/8a/b5ca7286.jpg","comment_is_top":false,"comment_ctime":1558427905,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1558427905","product_id":100023901,"comment_content":"@Junzi æ˜¯ä¸ªå¥½é—®é¢˜ï¼Œwrite() æ–¹æ³•å†…ä¸ä¼šè¿›è¡Œé‡æ’åºã€‚volitileåªæ˜¯è¯´ å¯¹ä»–çš„è¯»ä¼šä»ä¸»å†…å­˜è¯»å–ï¼Œè€Œä¸ä¼šç¼“å­˜æ‹¿ï¼Œå¦ä¸€ä¸ªä½œç”¨å°±æ˜¯åŠ å†…å­˜å±éšœï¼Œé˜²æ­¢é‡æ’ã€‚","like_count":0},{"had_liked":false,"id":95895,"user_name":"L","can_delete":false,"product_type":"c1","uid":1357311,"ip_address":"","ucode":"5B847B2378854E","user_header":"https://static001.geekbang.org/account/avatar/00/14/b5/ff/d1f205b0.jpg","comment_is_top":false,"comment_ctime":1558248276,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1558248276","product_id":100023901,"comment_content":"<br>Happens-Before å¹¶ä¸æ˜¯è¯´å‰é¢ä¸€ä¸ªæ“ä½œå‘ç”Ÿåœ¨åç»­æ“ä½œçš„å‰é¢ï¼Œ<br>å®ƒçœŸæ­£è¦è¡¨è¾¾çš„æ˜¯ï¼šå‰é¢ä¸€ä¸ªæ“ä½œçš„ç»“æœå¯¹åç»­æ“ä½œæ˜¯å¯è§çš„ã€‚<br><br><br>Java å†…å­˜æ¨¡å‹è§„èŒƒï¦º JVM å¦‚ä½•æä¾›æŒ‰éœ€ç¦ç”¨ç¼“å­˜å’Œç¼–è¯‘ä¼˜åŒ–çš„æ–¹æ³•ã€‚<br><br><br>è¿™æ˜¯è¯´ä¸€ç‚¹æˆ‘è‡ªå·±çš„ç†è§£ï¼šæ—¢ç„¶ JVM éœ€è¦éµå¾ª JVMå†…å­˜æ¨¡å‹ çš„ Happens-Before è§„åˆ™ï¼ï¼ï¼<br> <br> é‚£ä¹ˆæˆ‘å¤§è‡´æ¨å¯¼ä¸€ä¸‹ï¼š<br> <br> å‡å¦‚ç°åœ¨åªæœ‰Aã€Bä¸¤ä¸ªæ“ä½œï¼Œé‚£ä¹ˆ JVM å¯èƒ½åªéœ€éµå®ˆ Happens-Before è§„åˆ™1ã€2                  ---&gt; æ­¤æ—¶ç§°ä¸º ç¼–è¯‘ä¼˜åŒ–1<br> <br> è€Œå‡å¦‚ç°åœ¨æœ‰Aã€Bã€Cä¸‰ä¸ªæ“ä½œï¼Œé‚£ä¹ˆ JVM å¯èƒ½å°±éœ€éµå®ˆ Happens-Before è§„åˆ™1ã€2ã€3ã€4          ---&gt; æ­¤æ—¶ç§°ä¸º ç¼–è¯‘ä¼˜åŒ–2<br> <br> é‚£ä¹ˆï¼Œè¿™é‡Œçš„ ç¼–è¯‘ä¼˜åŒ–1 å°±å¯èƒ½ == ç¼–è¯‘ä¼˜åŒ–2ï¼Œä¹Ÿå¯èƒ½ !=ç¼–è¯‘ä¼˜åŒ–2  ï¼ï¼ï¼<br> <br> è¿™æ ·ï¼Œæˆ‘è§‰å¾—å°±å…¨éƒ¨éƒ½é€šäº†ï¼ï¼ï¼<br><br>ä¸çŸ¥é“ä»¥ä¸Šç†è§£å¯¹ä¸å¯¹ï¼Ÿï¼Ÿï¼Ÿ","like_count":0},{"had_liked":false,"id":94695,"user_name":"Geek_477adb","can_delete":false,"product_type":"c1","uid":1288787,"ip_address":"","ucode":"27C071C2C09E74","user_header":"","comment_is_top":false,"comment_ctime":1557882726,"is_pvip":false,"discussion_count":1,"race_medal":0,"score":"1557882726","product_id":100023901,"comment_content":"æŒ‰éœ€ç¦ç”¨ç¼“å­˜ï¼Œè¿™é‡Œçš„ç¼“å­˜æ˜¯æŒ‡é«˜é€Ÿç¼“å­˜ï¼Œæ‰€è°“ç¦ç”¨ç¼“å­˜æ˜¯æŒ‡CPUåœ¨è¿›è¡Œè¿ç®—å‰å°†æ•°æ®åŠ è½½åˆ°æ•°æ®å¯„å­˜å™¨çš„æ—¶å€™ï¼Œè·³è¿‡é«˜é€Ÿç¼“å­˜è€Œç›´æ¥å»å†…å­˜ï¼ˆä¸æ˜¯JMMä¸­çš„ä¸»å†…å­˜ï¼‰ä¸­æŸ¥æ‰¾ä¹ˆ","like_count":0,"discussions":[{"author":{"id":1004192,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/52/a0/d308434e.jpg","nickname":"StarKing","note":"","ucode":"EB825CFA70AC1F","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":14870,"discussion_content":"å¼ºåˆ¶ä½¿ç”¨ä¸»å­˜ä¸­çš„æ•°æ®,å°†æœ¬CPUå†…é«˜é€Ÿç¼“å­˜æ•°æ®ä½œåºŸ.","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1568785341,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":94478,"user_name":"å½­é”","can_delete":false,"product_type":"c1","uid":1179669,"ip_address":"","ucode":"F2CB53DE42026D","user_header":"https://static001.geekbang.org/account/avatar/00/12/00/15/6e399ec7.jpg","comment_is_top":false,"comment_ctime":1557821401,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1557821401","product_id":100023901,"comment_content":"ç†è§£äº†JMMï¼Œä½†ä¸ºä»€ä¹ˆC&#47;C++è¯­è¨€æ²¡æœ‰å†…å­˜æ¨¡å‹çš„è¯´æ³•ï¼Ÿæˆ‘å·²ç»æƒ³äº†å‡ ä¸ªåŸå› ï¼š<br>1. Cæ˜¯ç¼–è¯‘å‹çš„ï¼Œç›´æ¥æ“ä½œæ“ä½œç³»ç»Ÿæ¥å£ï¼Œpthreadï¼Œç›´æ¥ç”¨æ“ä½œç³»ç»Ÿçš„èƒ½åŠ›è§£å†³é—®é¢˜ï¼Œè€ŒJavaå®šä¹‰çš„Threadå¯¹è±¡ï¼Œåœ¨æ“ä½œç³»ç»Ÿä¹‹ä¸ŠåŠ äº†ä¸€å±‚ï¼›<br>2. Cè¯­è¨€ä¸€å®šä¹Ÿæœ‰å¯è§æ€§å’ŒåŸå­æ€§é—®é¢˜ï¼Œä½†ä¸ä¼šè¿™ä¹ˆå†²å‡ºï¼Œå› ä¸ºJavaæ˜¯é¢å‘å¯¹è±¡çš„ï¼Œå¯¹è±¡éƒ½æ˜¯å †çš„ï¼Œå †çš„éƒ½æ˜¯å…±äº«çš„ï¼›å¦‚æœ¬æ–‡çš„ä¾‹å­ï¼Œç”¨Cå†™éƒ½æ˜¯æ ˆå†…å­˜ï¼›<br>3. Cç¼–è¯‘ä¼˜åŒ–æ²¡æœ‰é‚£ä¹ˆå¤šè¯¡å¼‚çš„é‡æ’ï¼›","like_count":0},{"had_liked":false,"id":94127,"user_name":"Michael","can_delete":false,"product_type":"c1","uid":1435138,"ip_address":"","ucode":"2817C6A41C2E53","user_header":"https://static001.geekbang.org/account/avatar/00/15/e6/02/65a764fe.jpg","comment_is_top":false,"comment_ctime":1557726983,"is_pvip":false,"replies":[{"id":"33673","content":"ä¸èƒ½ä¿è¯count+=1çš„åŸå­æ€§","user_name":"ä½œè€…å›å¤","user_name_real":"ç‹å®ä»¤","uid":"1269969","ctime":1557757868,"ip_address":"","comment_id":94127,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1557726983","product_id":100023901,"comment_content":"è€å¸ˆï¼Œæœ¬èŠ‚æ‰€è¯´çš„volatileä¿®é¥°çš„å˜é‡ç¦æ­¢ä½¿ç”¨cpuç¼“å­˜ï¼Œé‚£ä¹ˆä¸ŠèŠ‚è¯¾ä¸­çš„ç¤ºä¾‹ä»£ç countç”¨ volatileä¿®é¥°ï¼Œä¸ºä»€ä¹ˆè¿è¡Œçš„ç»“æœè¿˜æ˜¯ä¸æ­£ç¡®?<br>public class Test {<br><br>  private volatile int count = 0;<br><br>  private void add() {<br>    int idx = 0;<br>    while (idx++ &lt; 10000000) {<br>      count += 1;<br>    }<br>  }<br><br>  public static int calc() throws Exception {<br>    final Test test = new Test();<br>    Thread th1 = new Thread(() -&gt; {<br>      test.add();<br>    });<br>    Thread th2 = new Thread(() -&gt; {<br>      test.add();<br>    });<br><br>    th1.start();<br>    th2.start();<br>    th1.join();<br>    th2.join();<br>    return test.count;<br>  }<br><br>  public static void main(String[] args) throws Exception {<br>    long c = calc();<br>    System.out.println(c);<br>  }<br>}","like_count":0,"discussions":[{"author":{"id":1269969,"avatar":"https://static001.geekbang.org/account/avatar/00/13/60/d1/8efa89ab.jpg","nickname":"ç‹å®ä»¤","note":"","ucode":"4FE19F5BC32FCA","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":449925,"discussion_content":"ä¸èƒ½ä¿è¯count+=1çš„åŸå­æ€§","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1557757868,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":93763,"user_name":"smarttime","can_delete":false,"product_type":"c1","uid":1140144,"ip_address":"","ucode":"460ED32D6165ED","user_header":"https://static001.geekbang.org/account/avatar/00/11/65/b0/9d11054a.jpg","comment_is_top":false,"comment_ctime":1557583566,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1557583566","product_id":100023901,"comment_content":"ä¸ºä»€ä¹ˆä¼šæœ‰é—®é¢˜ï¼Œèƒ½ä¸èƒ½å†è¯¦ç»†åˆ†æä¸€ä¸‹ï¼Œå°±ç®—æˆ‘ä»¬çš„è¯­è¨€éšæ„ï¼Œè¯·è€å¸ˆèƒ½å¦å†è‡ªå·±ç»†è‡´è®²è§£ä¸€ä¸‹ï¼Œçœ‹åˆ°é‚£ä¹ˆå¤šç†è§£çš„ä¸åŒçš„ç•™è¨€æœ‰äº›ç”šè‡³è¿˜æœ‰çŸ›ç›¾ï¼Œå¥½æªå¿ƒ","like_count":0},{"had_liked":false,"id":93736,"user_name":"smarttime","can_delete":false,"product_type":"c1","uid":1140144,"ip_address":"","ucode":"460ED32D6165ED","user_header":"https://static001.geekbang.org/account/avatar/00/11/65/b0/9d11054a.jpg","comment_is_top":false,"comment_ctime":1557575166,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1557575166","product_id":100023901,"comment_content":"æˆ‘ä¹Ÿæƒ³é—®ä¾‹å­ä¸­vä¸åŠ volatileï¼Œè¯»åˆ°xæ˜¯å¤šå°‘ï¼ŸHBè§„åˆ™ä¸€åˆ°åº•è¯¥å’‹ç†è§£ï¼Ÿè€å¸ˆè¿™ç¯‡æ–‡ç« æˆ‘è¯»äº†5éï¼Œåœ¨å¤šçº¿ç¨‹ç¯å¢ƒä¸‹æˆ‘è¿˜æ˜¯ä¸æ¸…æ¥šè¯¥å’‹ç†è§£","like_count":0},{"had_liked":false,"id":90180,"user_name":"å•Šå¿—èªå•Š","can_delete":false,"product_type":"c1","uid":1024087,"ip_address":"","ucode":"03E189316AEFF1","user_header":"https://static001.geekbang.org/account/avatar/00/0f/a0/57/2cf004c7.jpg","comment_is_top":false,"comment_ctime":1556441737,"is_pvip":false,"replies":[{"id":"32321","content":"æˆ‘è§‰å¾—åº”è¯¥æ˜¯ï¼š<br>finalä¿®é¥°è¿™ä¸ªå®ä¾‹å¯¹è±¡ï¼Œç„¶åä¿®æ”¹å®ä¾‹å¯¹è±¡çš„abcå±æ€§ä¸ºå…¶ä»–å€¼,å¦å¤–çš„çº¿ç¨‹å°±ä¸å¯è§äº†ã€‚","user_name":"ä½œè€…å›å¤","user_name_real":"ç‹å®ä»¤","uid":"1269969","ctime":1556462596,"ip_address":"","comment_id":90180,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1556441737","product_id":100023901,"comment_content":"finalæ˜¯ä¸å˜çš„,æ‰€ä»¥ç”¨final ä¿®é¥°abcä¿®æ”¹ä¸ºå…¶ä»–å€¼ç¼–è¯‘éƒ½ä¸é€šè¿‡å§?è¿˜æ˜¯æ„æ€abcæ˜¯æŸå®ä¾‹çš„æˆå‘˜å˜é‡,finalä¿®é¥°è¿™ä¸ªå®ä¾‹å¯¹è±¡?ç„¶åä¿®æ”¹å®ä¾‹å¯¹è±¡çš„abcå±æ€§ä¸ºå…¶ä»–å€¼,å¦å¤–çš„çº¿ç¨‹å°±å¯è§çš„äº†?","like_count":0,"discussions":[{"author":{"id":1269969,"avatar":"https://static001.geekbang.org/account/avatar/00/13/60/d1/8efa89ab.jpg","nickname":"ç‹å®ä»¤","note":"","ucode":"4FE19F5BC32FCA","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":448416,"discussion_content":"æˆ‘è§‰å¾—åº”è¯¥æ˜¯ï¼š\nfinalä¿®é¥°è¿™ä¸ªå®ä¾‹å¯¹è±¡ï¼Œç„¶åä¿®æ”¹å®ä¾‹å¯¹è±¡çš„abcå±æ€§ä¸ºå…¶ä»–å€¼,å¦å¤–çš„çº¿ç¨‹å°±ä¸å¯è§äº†ã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1556462596,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":89880,"user_name":"æ¬¡éƒ","can_delete":false,"product_type":"c1","uid":1134620,"ip_address":"","ucode":"446499E130A66A","user_header":"https://static001.geekbang.org/account/avatar/00/11/50/1c/26dc1927.jpg","comment_is_top":false,"comment_ctime":1556293519,"is_pvip":false,"replies":[{"id":"32300","content":"ä¸ç”¨èƒŒï¼Œç”¨åˆ°äº†æŸ¥ä¸€ä¸‹å°±å¯ä»¥äº†","user_name":"ä½œè€…å›å¤","user_name_real":"ç‹å®ä»¤","uid":"1269969","ctime":1556427817,"ip_address":"","comment_id":89880,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1556293519","product_id":100023901,"comment_content":"è€å¸ˆï¼Œhapped beforè§„åˆ™å¿…é¡»è¦è®°ä½å—ï¼Ÿä¸å¥½èƒŒå•Š","like_count":0,"discussions":[{"author":{"id":1269969,"avatar":"https://static001.geekbang.org/account/avatar/00/13/60/d1/8efa89ab.jpg","nickname":"ç‹å®ä»¤","note":"","ucode":"4FE19F5BC32FCA","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":448302,"discussion_content":"ä¸ç”¨èƒŒï¼Œç”¨åˆ°äº†æŸ¥ä¸€ä¸‹å°±å¯ä»¥äº†","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1556427817,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":87518,"user_name":"ç››æƒ_vinc","can_delete":false,"product_type":"c1","uid":1459845,"ip_address":"","ucode":"4688DD06587CE2","user_header":"http://thirdwx.qlogo.cn/mmopen/vi_32/LPnuO9GleKEwso2rSbibmbEwn49hnGl9qTQDBv2xLOOWOflQsc9oVEEuZgNBt7TrqRKvk8CX7Tc8iakhEicBCCfFg/132","comment_is_top":false,"comment_ctime":1555631651,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1555631651","product_id":100023901,"comment_content":"è€å¸ˆï¼Œåœ¨writeå’Œreadçš„ä¾‹å­ä¸­ï¼Œå¦‚æœboolean væ²¡æœ‰ç”¨volatileä¿®é¥°ï¼Œæ˜¯ä¸æ˜¯çº¿ç¨‹Aã€Bå°±ä¸ä¼šéµå¾ªhappens-beforeè§„åˆ™ï¼Ÿåœ¨writeä¸­x=42å’Œv=trueçš„æ‰§è¡Œé¡ºåºå°±å¯èƒ½ä¼šç”±äºç¼–è¯‘ä¼˜åŒ–è€Œé‡æ’ï¼Œæ˜¯è¿™æ ·å—ï¼Ÿå¦‚æœæ˜¯ï¼Œé‚£æ˜¯ä¸æ˜¯è¯´happens-beforeè§„åˆ™ç¬¬ä¸€æ¡ï¼Œé¡ºåºæ‰§è¡Œå…¶å®ä¹Ÿæ˜¯ç”±volatileé™åˆ¶ï¼Ÿæˆ‘åœ¨ç½‘ä¸Šçœ‹åˆ°æåŠvolatileçš„ç‰¹æ€§éƒ½æ˜¯:1,ç¦ç”¨çº¿ç¨‹æœ¬åœ°ç¼“å­˜ï¼Œç›´æ¥åœ¨å†…å­˜ä¸­è¯»å†™;2,ç¦æ­¢æŒ‡ä»¤é‡æ’ã€‚<br>è€Œhappens-beforeæŠŠè¿™ä¸¤ä¸ªç‰¹æ€§åˆ†æˆä¸¤ä¸ªè§„åˆ™è¯´æ˜ï¼Œæ˜¯è¿™ä¹ˆç†è§£å—ï¼Ÿ","like_count":0},{"had_liked":false,"id":87375,"user_name":"xuery","can_delete":false,"product_type":"c1","uid":1027584,"ip_address":"","ucode":"F461B61BE06131","user_header":"https://static001.geekbang.org/account/avatar/00/0f/ae/00/025f37e7.jpg","comment_is_top":false,"comment_ctime":1555579202,"is_pvip":true,"discussion_count":0,"race_medal":0,"score":"1555579202","product_id":100023901,"comment_content":"ç•™è¨€è´¨é‡ä¸€çº§æ£’ï¼Œå‚è€ƒç•™è¨€å’Œé—®é¢˜ä¸€ä¸ªè§„åˆ™ä¸€ä¸ªè§„åˆ™å¯¹ç…§ç€çœ‹å¾ˆæœ‰æ„Ÿè§‰ï¼š<br>1. é‡‡ç”¨volatileå˜é‡ä¿®é¥°ï¼Œæ ¹æ®hbè§„åˆ™2å¯ä»¥çŸ¥é“<br>2. å¯¹abc=3çš„èµ‹å€¼æ“ä½œåŠ é”ï¼Œä¹‹åå…¶ä»–çº¿ç¨‹å¯¹abcçš„è®¿é—®åŠ é”ï¼›æ ¹æ®è§„åˆ™4å¯ä»¥çŸ¥é“<br>3. å°†è®¾ç½®abcçš„å€¼ä¸º3çš„çº¿ç¨‹ä½œä¸ºä½œä¸ºä¸»çº¿ç¨‹ï¼Œè®¾ç½®å®Œabc=3ä¹‹ååœ¨é‡Œé¢å¼€å¯ä¸€ä¸ªå­çº¿ç¨‹Bå¹¶start, åœ¨å­çº¿ç¨‹Bé‡Œé¢è®¿é—®abc,å‚è€ƒè§„åˆ™5<br>4. å°†è®¾ç½®abcçš„å€¼ä¸º3çš„çº¿ç¨‹ä½œä¸ºå­çº¿ç¨‹Aï¼Œç„¶ååœ¨Bä¸­è°ƒç”¨A.join(),ç­‰joinè¿”å›åå†æŸ¥çœ‹abcçš„å€¼ï¼Œå‚è€ƒè§„åˆ™6<br><br>å¯¹äº3,4å¦‚æœå‘ç”Ÿè®¾ç½®å€¼çš„æ“ä½œå’Œstart&#47;joinçš„æ“ä½œæŒ‡ä»¤é‡æ’ï¼Œå¯èƒ½ä¸ä¸€å®šèƒ½å¾—åˆ°æˆ‘ä»¬æƒ³è¦çš„ç»“æœï¼ä¸çŸ¥é“ç†è§£çš„å¯¹ä¸å¯¹ï¼Ÿ","like_count":0},{"had_liked":false,"id":86553,"user_name":"ç¬¨è›‹","can_delete":false,"product_type":"c1","uid":1223680,"ip_address":"","ucode":"D541550F1E5C2A","user_header":"http://thirdwx.qlogo.cn/mmopen/vi_32/DYAIOgq83epic1fC7nrCEic676PpRnT4RnDjbPhbQzIdCiaSY1IFJubmdNBt6K65FHML9AH8LVBfDAcq1O35HEIkQ/132","comment_is_top":false,"comment_ctime":1555398623,"is_pvip":false,"discussion_count":1,"race_medal":0,"score":"1555398623","product_id":100023901,"comment_content":"@å‘æ¡æ©™å­ ã€‚æœ‰ç‚¹ç–‘é—®ï¼šç¬¬å››æ¡è§„åˆ™ã€‚synchronizedåŒæ­¥çš„ä»£ç å—åœ¨é‡Šæ”¾é”çš„æ—¶å€™ä¸æ˜¯å·²ç»å°†abcçš„å€¼æ›´æ–°åˆ°ä¸»å†…å­˜ä¸­å»äº†å—ï¼Ÿå…¶ä»–çº¿ç¨‹å†å»è·å–è¿™ä¸ªå€¼çš„æ—¶å€™ä¸æ˜¯å·²ç»æ˜¯æœ€æ–°å€¼äº†å—ï¼Ÿ","like_count":0,"discussions":[{"author":{"id":2131766,"avatar":"","nickname":"Geek9458","note":"","ucode":"EF6E589FB92F0B","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":333942,"discussion_content":"å…¶ä»–çº¿ç¨‹å¦‚æœæ˜¯åœ¨åŒæ­¥ä»£ç å—é‡Œè·å–è¿™ä¸ªå€¼å°±æ˜¯æœ€æ–°çš„ï¼Œå¦‚æœæ²¡æœ‰ç”¨synchronizedå°±ä¸ç¬¦åˆç¬¬4æ¡è§„åˆ™äº†","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1607677234,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":85808,"user_name":"null","can_delete":false,"product_type":"c1","uid":1024294,"ip_address":"","ucode":"F9039EFED6B55D","user_header":"http://thirdwx.qlogo.cn/mmopen/vi_32/PiajxSqBRaELZPnUAiajaR5C25EDLWeJURggyiaOP5GGPe2qlwpQcm5e3ybib8OsP4tvddFDLVRSNNGL5I3SFPJHsA/132","comment_is_top":false,"comment_ctime":1555242696,"is_pvip":false,"replies":[{"id":"30877","content":"1. æ˜¯è¿™æ ·ï¼Œè§„åˆ™1å¿…é¡»å’Œä¼ é€’æ€§è¿˜æœ‰å…¶ä»–è§„åˆ™ç»“åˆï¼Œæ‰æœ‰ä½œç”¨<br>2. æˆ‘è¯´çš„ä¹Ÿæ˜¯@å‘æ¡æ©™å­çš„åˆ†ææ²¡æœ‰é—®é¢˜ï¼ŒæŒ‰ç…§hbè§„åˆ™ï¼Œè¯»å†™å¿…é¡»éƒ½ç”¨synchronizedæ‰èƒ½ç¡®ä¿æ²¡æœ‰é—®é¢˜ã€‚@å‘æ¡æ©™å­è¯´çš„â€œç›´æ¥â€ï¼Œæˆ‘ç†è§£å°±æ˜¯æ²¡æœ‰ä½¿ç”¨ä»»ä½•åŒæ­¥æ‰‹æ®µã€‚<br><br>â€œsynchronized(abc) æ˜¯å¯ä»¥ä¿è¯åç»­å…¶ä»–çº¿ç¨‹çš„æ“ä½œèƒ½å¤Ÿçœ‹åˆ° abc å†™æ“ä½œçš„ç»“æœçš„ã€‚â€è¿™ä¸ªæ ¹æ®hbè§„åˆ™æ˜¯æ¨æ–­ä¸å‡ºæ¥çš„ã€‚æ‰€ä»¥ä½ çœ‹æ—©æœŸVectorçš„å®ç°ï¼Œæ‰€æœ‰è¯»æ“ä½œä¹Ÿéƒ½ç”¨synchronizedä¿®é¥°ï¼Œå“ªæ€•æ˜¯size()å°±è¿”å›ä¸€ä¸ªelementCountã€‚è¿™ä¸ªå’Œabcçš„é—®é¢˜æ˜¯ä¸€æ ·ä¸€æ ·çš„ã€‚","user_name":"ä½œè€…å›å¤","user_name_real":"ç‹å®ä»¤","uid":"1269969","ctime":1555254852,"ip_address":"","comment_id":85808,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1555242696","product_id":100023901,"comment_content":"è€å¸ˆï¼Œæ‚¨å¥½ã€‚æœ‰ä¸¤ä¸ªé—®é¢˜æ²¡å¤ªç†è§£<br>é—®é¢˜ä¸€ï¼š <br>â€œç¨‹åºçš„é¡ºåºæ€§è§„åˆ™â€æè¿°çš„æ˜¯å•çº¿ç¨‹å†…ï¼ŒæŒ‰ç…§ç¨‹åºçš„ä¹¦å†™é¡ºåºï¼Œå‰é¢æ“ä½œçš„ç»“æœå¯¹åç»­çš„ä»»æ„æ“ä½œå¯è§ã€‚å³å•çº¿ç¨‹å†…ï¼Œç¬¬ 6 è¡Œä»£ç â€œx = 42;â€Happens-Before äºç¬¬ 7 è¡Œä»£ç  â€œv = true;â€ã€‚å¤šçº¿ç¨‹æƒ…å†µä¸‹ï¼Œæœ‰å¯èƒ½å‘ç”Ÿé‡æ’ï¼Œå°†â€œv=true;â€æ’åˆ°äº†â€œx=42;â€ä¹‹å‰ã€‚æˆ‘ä»¬éƒ½æ˜¯åœ¨å¤šçº¿ç¨‹çš„æƒ…å†µä¸‹è®¨è®ºå¯è§æ€§é—®é¢˜ï¼Œå› æ­¤ä¸å¤ªç†è§£è¿™æ¡è§„åˆ™çš„ä½œç”¨ã€‚æ˜¯é…åˆ volatile è§„åˆ™æ¥ä½¿ç”¨çš„ä¹ˆï¼Ÿä¾‹å¦‚ï¼š<br>```<br>int a;<br>int b;<br>volatile int c;<br>int d;<br>int e;<br>```<br>a å’Œ b ä¸ä¼šé‡æ’åˆ° c çš„åé¢ï¼ˆè€Œ b æœ‰å¯èƒ½é‡æ’åˆ° a çš„å‰é¢ï¼‰ï¼ŒåŒæ · d å’Œ e ä¸ä¼šé‡æ’åˆ° c çš„å‰é¢ã€‚<br><br>é—®é¢˜äºŒï¼š<br>ä¹‹å‰åœ¨ç•™è¨€é‡Œæé—®ï¼š<br>&gt;@å‘æ¡æ©™å­â€¦ çš„æ€è€ƒé¢˜åˆ†æï¼Œæœ‰äº›ä¸å¤ªå‡†ç¡®å§ï¼Œä¾‹å¦‚è¯„è®ºé‡ŒæŒ‡å‡ºçš„ç¨‹åºé¡ºåºæ€§ã€‚è¿˜æœ‰ synchronized çš„åˆ†æä¹Ÿä¸å¤ªå‡†ç¡®å§ï¼Œsynchronized(abc) å¯èƒ½ä¿è¯åç»­æ“ä½œå¯è§ã€‚<br>&gt;<br>&gt;ä½œè€…å›å¤: synchronized çš„åˆ†ææ²¡æœ‰é—®é¢˜ï¼Œå…¶ä»–çº¿ç¨‹ç›´æ¥è®¿é—®è¿˜å¯èƒ½ä¸æ˜¯æœ€æ–°å€¼ï¼Œæˆ‘ç†è§£ç›´æ¥å°±æ˜¯æ²¡æœ‰ä½¿ç”¨ä»»ä½•åŒæ­¥æ‰‹æ®µã€‚<br>&gt;å³ä¾¿ç”¨ synchronizedï¼Œç”¨æ³•ä¸å¯¹ï¼Œä¹Ÿè¾¾ä¸åˆ°æ•ˆæœã€‚<br><br>ä¸Šè¿°æé—®â€œè¿˜æœ‰ synchronized çš„åˆ†æä¹Ÿä¸å¤ªå‡†ç¡®å§â€ï¼Œä¸æ˜¯å¯¹æ–‡ç« ä¸­çš„ synchronized çš„åˆ†æè¡¨ç¤ºç–‘æƒ‘ï¼Œè€Œæ˜¯@å‘æ¡æ©™å­â€¦ çš„åˆ†ææœ‰ç–‘æƒ‘ï¼š<br>&gt;4. ç¬¬å››æ¡è§„åˆ™ï¼Œ ä½¿ç”¨ç®¡ç¨‹ï¼Œç”±äºæ˜¯è®¿é—®å…±äº«å˜é‡ï¼Œå¦‚æœæ˜¯åœ¨synä¸­ä¿®æ”¹å€¼åªèƒ½ä¿è¯å½“å‰çº¿ç¨‹ä¸‹ä¸€æ¬¡è¿›å…¥synå¯ä»¥çœ‹è§æœ€æ–°çš„å€¼ï¼Œå…¶ä»–çº¿ç¨‹ç›´æ¥è®¿é—®è¿˜å¯èƒ½ä¸æ˜¯æœ€æ–°å€¼ ï¼Œ ä¸è¡Œ<br><br>è‡ªå·±çš„ç†è§£æ˜¯ï¼š<br>synchronized(abc) æ˜¯å¯ä»¥ä¿è¯åç»­å…¶ä»–çº¿ç¨‹çš„æ“ä½œèƒ½å¤Ÿçœ‹åˆ° abc å†™æ“ä½œçš„ç»“æœçš„ï¼Œå³å¯ä»¥çœ‹åˆ° abc çš„æœ€æ–°å€¼ã€‚ä¸çŸ¥é“ç†è§£æ˜¯å¦æ­£ç¡®ã€‚<br><br>è°¢è°¢è€å¸ˆï¼ï¼","like_count":0,"discussions":[{"author":{"id":1269969,"avatar":"https://static001.geekbang.org/account/avatar/00/13/60/d1/8efa89ab.jpg","nickname":"ç‹å®ä»¤","note":"","ucode":"4FE19F5BC32FCA","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":446819,"discussion_content":"1. æ˜¯è¿™æ ·ï¼Œè§„åˆ™1å¿…é¡»å’Œä¼ é€’æ€§è¿˜æœ‰å…¶ä»–è§„åˆ™ç»“åˆï¼Œæ‰æœ‰ä½œç”¨\n2. æˆ‘è¯´çš„ä¹Ÿæ˜¯@å‘æ¡æ©™å­çš„åˆ†ææ²¡æœ‰é—®é¢˜ï¼ŒæŒ‰ç…§hbè§„åˆ™ï¼Œè¯»å†™å¿…é¡»éƒ½ç”¨synchronizedæ‰èƒ½ç¡®ä¿æ²¡æœ‰é—®é¢˜ã€‚@å‘æ¡æ©™å­è¯´çš„â€œç›´æ¥â€ï¼Œæˆ‘ç†è§£å°±æ˜¯æ²¡æœ‰ä½¿ç”¨ä»»ä½•åŒæ­¥æ‰‹æ®µã€‚\n\nâ€œsynchronized(abc) æ˜¯å¯ä»¥ä¿è¯åç»­å…¶ä»–çº¿ç¨‹çš„æ“ä½œèƒ½å¤Ÿçœ‹åˆ° abc å†™æ“ä½œçš„ç»“æœçš„ã€‚â€è¿™ä¸ªæ ¹æ®hbè§„åˆ™æ˜¯æ¨æ–­ä¸å‡ºæ¥çš„ã€‚æ‰€ä»¥ä½ çœ‹æ—©æœŸVectorçš„å®ç°ï¼Œæ‰€æœ‰è¯»æ“ä½œä¹Ÿéƒ½ç”¨synchronizedä¿®é¥°ï¼Œå“ªæ€•æ˜¯size()å°±è¿”å›ä¸€ä¸ªelementCountã€‚è¿™ä¸ªå’Œabcçš„é—®é¢˜æ˜¯ä¸€æ ·ä¸€æ ·çš„ã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1555254852,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":85720,"user_name":"LouisLimTJ","can_delete":false,"product_type":"c1","uid":1149462,"ip_address":"","ucode":"E430BC6BE62C22","user_header":"https://static001.geekbang.org/account/avatar/00/11/8a/16/10420350.jpg","comment_is_top":false,"comment_ctime":1555212559,"is_pvip":false,"replies":[{"id":"30836","content":"è§„åˆ™1ä»…ä»…å¯¹å•çº¿ç¨‹æœ‰æ•ˆã€‚æ²¡æœ‰å…¨éƒ¨ç¦æ­¢ã€‚","user_name":"ä½œè€…å›å¤","user_name_real":"ç‹å®ä»¤","uid":"1269969","ctime":1555234865,"ip_address":"","comment_id":85720,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1555212559","product_id":100023901,"comment_content":"ç‹è€å¸ˆä½ å¥½ï¼Œæˆ‘æœ‰ä¸ªå…³äºhappen beforeçš„ç¬¬ä¸€æ¡è§„åˆ™ã€‚ä½ è¯´åˆ°å‰é¢çš„æ“ä½œå¯è§äºåé¢çš„æ“ä½œã€‚å¯¹äºï¼Œå¯è§äºä¹‹åçš„æ“ä½œï¼Œæ˜¯æŒ‡å¯¹äºvolatileå˜é‡çš„æ“ä½œå‘¢ï¼Œ è¿˜æ˜¯ä»€ä¹ˆå˜é‡éƒ½æ˜¯ï¼Ÿ å¦‚æœæ˜¯åè€…ï¼Œé‚£å²‚ä¸æ˜¯æ„å‘³ç€Javaå®Œå…¨ç¦æ­¢äº†reorderçš„ç¼–è¯‘ä¼˜åŒ–äº†ï¼Ÿ","like_count":0,"discussions":[{"author":{"id":1269969,"avatar":"https://static001.geekbang.org/account/avatar/00/13/60/d1/8efa89ab.jpg","nickname":"ç‹å®ä»¤","note":"","ucode":"4FE19F5BC32FCA","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":446779,"discussion_content":"è§„åˆ™1ä»…ä»…å¯¹å•çº¿ç¨‹æœ‰æ•ˆã€‚æ²¡æœ‰å…¨éƒ¨ç¦æ­¢ã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1555234865,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":85614,"user_name":"ç‰æ ‘ä¸´æ«","can_delete":false,"product_type":"c1","uid":1442090,"ip_address":"","ucode":"B99151418C64CE","user_header":"","comment_is_top":false,"comment_ctime":1555143306,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1555143306","product_id":100023901,"comment_content":"æŒæ¡Javaå†…å­˜æ¨¡å‹å¾ˆé‡è¦ï¼Œç‰¹åˆ«æ˜¯é‡Œé¢çš„ä¸€äº›å…³é”®å­—å’Œä¸€äº›è§„åˆ™ï¼Œéœ€ç€é‡ç†è§£ã€‚ä¸‹é¢æ˜¯æˆ‘å¯¹volatile å…³é”®å­—çš„ç†è§£å’Œæ€»ç»“ï¼Œæ¬¢è¿å„ä½å‚è€ƒ<br>https:&#47;&#47;www.cnblogs.com&#47;yuanfy008&#47;p&#47;9335168.html","like_count":0},{"had_liked":false,"id":85458,"user_name":"äº‘å¤–æœ‰äº‘","can_delete":false,"product_type":"c1","uid":1442569,"ip_address":"","ucode":"E06ECF692935B8","user_header":"https://static001.geekbang.org/account/avatar/00/16/03/09/74acf5ca.jpg","comment_is_top":false,"comment_ctime":1555064101,"is_pvip":false,"replies":[{"id":"30618","content":"å‡ºç°æ­»é”çš„æ—¶å€™ï¼ŒæŠŠçº¿ç¨‹æ ˆdumpå‡ºæ¥ï¼Œå°±èƒ½çŸ¥é“åŸå› äº†<br>","user_name":"ä½œè€…å›å¤","user_name_real":"ç‹å®ä»¤","uid":"1269969","ctime":1555065358,"ip_address":"","comment_id":85458,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1555064101","product_id":100023901,"comment_content":"è€å¸ˆï¼Œè¿™æ®µä»£ç å‡ºç°äº†æ­»é”ï¼Œä½†æˆ‘è¿˜æ˜¯æ²¡æ•´æ˜ç™½ï¼Œå¸®å¿™æŒ‡ç‚¹ä¸€ä¸‹ï¼Œè°¢è°¢<br><br>é”éƒ½æ˜¯é™æ€object<br><br> public static T GetClient&lt;T&gt;(int clientTimeout = 3, int retryCount = 1, int retryBreak = 1)         {<br><br>            if (isRunOne)<br>            {<br>                lock (m_initlock)<br>                {<br>                    if (isRunOne)<br>                    {<br>                        MicroClientInit(clientDllPath);<br><br>                        if (!ClientDllPathList.Contains(clientDllPath))<br>                        {<br>                            ClientDllPathList.Add(clientDllPath);<br>                        }<br><br>                        isRunOne = false;<br>                    }<br>                }<br>            }<br><br>            if (!ClientDllPathList.Contains(clientDllPath))<br>            {<br>                lock (m_initlock)<br>                {<br>                    if (!ClientDllPathList.Contains(clientDllPath))<br>                    {<br>                        ConsulHelper.Instance.AppendService(clientDllPath);<br>                        ClientDllPathList.Add(clientDllPath);<br>                    }<br>                }<br>            }<br>}","like_count":0,"discussions":[{"author":{"id":1269969,"avatar":"https://static001.geekbang.org/account/avatar/00/13/60/d1/8efa89ab.jpg","nickname":"ç‹å®ä»¤","note":"","ucode":"4FE19F5BC32FCA","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":446674,"discussion_content":"å‡ºç°æ­»é”çš„æ—¶å€™ï¼ŒæŠŠçº¿ç¨‹æ ˆdumpå‡ºæ¥ï¼Œå°±èƒ½çŸ¥é“åŸå› äº†\n","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1555065358,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":85007,"user_name":"è€ƒä¼‘","can_delete":false,"product_type":"c1","uid":1053955,"ip_address":"","ucode":"968DFC00D6D0CF","user_header":"https://static001.geekbang.org/account/avatar/00/10/15/03/c0fe1dbf.jpg","comment_is_top":false,"comment_ctime":1554954805,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1554954805","product_id":100023901,"comment_content":"æ„Ÿè°¢è€å¸ˆçš„è®²è§£ï¼Œä¹Ÿæ„Ÿè°¢é¦–è¯„Handongyangçš„è¯„è®ºï¼ŒæŠŠjavaå¯¹éš¾æ‡‚çš„happens-beforeè®²çš„è¿™ä¹ˆé€å½»ï¼","like_count":0},{"had_liked":false,"id":84720,"user_name":"whyoyyx","can_delete":false,"product_type":"c1","uid":1064449,"ip_address":"","ucode":"B111DDAF23AFE9","user_header":"https://static001.geekbang.org/account/avatar/00/10/3e/01/9bb11f13.jpg","comment_is_top":false,"comment_ctime":1554898302,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1554898302","product_id":100023901,"comment_content":"@èƒ¡æ¡¥ï¼Œæˆ‘æŠŠä½ çš„sleep(1) ï¼Œæ”¹æˆå…¶ä»–è€—æ—¶è®¡ç®—å°±èƒ½å¤ç°ã€‚ä¸è¿‡åœ¨è¯•éªŒä¹‹å‰å…ˆä¿å­˜å¥½ç›¸å…³æ–‡ä»¶ã€‚","like_count":0},{"had_liked":false,"id":83081,"user_name":"Forever","can_delete":false,"product_type":"c1","uid":1200760,"ip_address":"","ucode":"76BE8C9BFD41B2","user_header":"https://static001.geekbang.org/account/avatar/00/12/52/78/4365471c.jpg","comment_is_top":false,"comment_ctime":1554395487,"is_pvip":false,"replies":[{"id":"30003","content":"å¯ä»¥<br>","user_name":"ä½œè€…å›å¤","user_name_real":"ç‹å®ä»¤","uid":"1269969","ctime":1554431076,"ip_address":"","comment_id":83081,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1554395487","product_id":100023901,"comment_content":"è€å¸ˆ @Handongyang è¯´å½“ä¸€ä¸ªå¯¹è±¡åŒ…å«finalä¿®é¥°çš„å®ä¾‹å­—æ®µæ—¶ï¼Œå…¶ä»–çº¿ç¨‹èƒ½å¤Ÿçœ‹åˆ°å·²ç»åˆå§‹åŒ–çš„finalå®ä¾‹å­—æ®µï¼Œè¿™æ˜¯å®‰å…¨çš„ã€‚ é‚£ä¹ˆæ˜¯å¦å¯ä»¥ç†è§£ä¸ºæ€è€ƒé¢˜ä¸­çš„abcå¦‚æœè®¾ç½®ä¸ºfinalä¿®é¥°ï¼Œä»–ä¹Ÿå¯ä»¥è¢«å…¶ä»–çš„çº¿ç¨‹çœ‹åˆ°ï¼Ÿ","like_count":0,"discussions":[{"author":{"id":1269969,"avatar":"https://static001.geekbang.org/account/avatar/00/13/60/d1/8efa89ab.jpg","nickname":"ç‹å®ä»¤","note":"","ucode":"4FE19F5BC32FCA","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":445850,"discussion_content":"å¯ä»¥\n","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1554431076,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":82523,"user_name":"ç‹æˆî”“","can_delete":false,"product_type":"c1","uid":1441460,"ip_address":"","ucode":"29765BBCD3B8B2","user_header":"https://static001.geekbang.org/account/avatar/00/15/fe/b4/6902ac00.jpg","comment_is_top":false,"comment_ctime":1554248448,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1554248448","product_id":100023901,"comment_content":"æ™®é€šè¯»å†™+æ™®é€šè¯»å†™ å…è®¸æŒ‡ä»¤é‡æ’<br>æ™®é€šè¯»å†™+volatileè¯» å…è®¸<br>æ™®é€šè¯»å†™+volatileå†™ ä¸å…è®¸<br>volatileè¯»+ä»»ä½• ä¸å…è®¸<br>volatileå†™+æ™®é€šè¯»å†™ å…è®¸<br>volatileå†™+volatileè¯»å†™ ä¸å…è®¸<br>å¸Œæœ›å¤§å®¶æŒ‡å¯¼","like_count":0},{"had_liked":false,"id":82343,"user_name":"Aaron_æ¶›","can_delete":false,"product_type":"c1","uid":1180617,"ip_address":"","ucode":"067F3CBB1F036C","user_header":"https://static001.geekbang.org/account/avatar/00/12/03/c9/9a9d82ab.jpg","comment_is_top":false,"comment_ctime":1554187963,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1554187963","product_id":100023901,"comment_content":"æœ€åé‚£ä¸ªé€¸å‡ºæ˜¯ä¸æ˜¯å› ä¸ºæŒ‡ä»¤é‡æ’åºå¯¼è‡´thisèµ‹å€¼æ“ä½œå¯èƒ½ç¬¬ä¸€ä¸ªæ‰§è¡Œï¼Œè¿™ä¸ªæ—¶å€™xè¿˜æ²¡æœ‰èµ‹å€¼ï¼Œæ‰€æœ‰å¯èƒ½è®¿é—®åˆ°x=0","like_count":0},{"had_liked":false,"id":82007,"user_name":"è™çˆ·","can_delete":false,"product_type":"c1","uid":1024907,"ip_address":"","ucode":"42E8339F183055","user_header":"https://static001.geekbang.org/account/avatar/00/0f/a3/8b/e7389cf5.jpg","comment_is_top":false,"comment_ctime":1554101590,"is_pvip":true,"discussion_count":0,"race_medal":0,"score":"1554101590","product_id":100023901,"comment_content":"1ï¼šå¯ä»¥åœ¨abcè¿™ä¸ªå˜é‡å‰é¢ï¼ŒåŠ å…¥volatileä¿®é¥°ç¬¦ï¼›<br>2ï¼šå¯ä»¥åœ¨abc=3è¿™ä¸ªè¯­å¥åé¢ï¼Œæ‰§è¡Œä¸€ä¸ªè¢«volatileå…³é”®å­—ä¿®é¥°çš„å˜é‡èµ‹å€¼æ“ä½œï¼›<br>3ï¼šå¯ä»¥åœ¨abc=3è¿™è¡Œä»£ç å‰ååŠ å…¥synchronizedå…³é”®å­—ï¼Œä¿è¯å…¶å¯è§æ€§ï¼›<br>","like_count":0},{"had_liked":false,"id":77618,"user_name":"èµŒç¥å¾ˆä½è°ƒ","can_delete":false,"product_type":"c1","uid":1168545,"ip_address":"","ucode":"1066778E1EDF26","user_header":"https://static001.geekbang.org/account/avatar/00/11/d4/a1/8bc8e7e1.jpg","comment_is_top":false,"comment_ctime":1552973919,"is_pvip":true,"discussion_count":0,"race_medal":0,"score":"1552973919","product_id":100023901,"comment_content":"abcå®šä¹‰ä¸ºvolatilå˜é‡ï¼Œå†™æ“ä½œå®šä¹‰åœ¨åŒæ­¥å—ä¸­ï¼Œè¯»çº¿ç¨‹joinå†™çº¿ç¨‹","like_count":0},{"had_liked":false,"id":77539,"user_name":"life is short, enjoy more.îŠ","can_delete":false,"product_type":"c1","uid":1074805,"ip_address":"","ucode":"3B5F37D30790A7","user_header":"https://static001.geekbang.org/account/avatar/00/10/66/75/54bb858e.jpg","comment_is_top":false,"comment_ctime":1552960448,"is_pvip":false,"replies":[{"id":"28390","content":"æˆ‘ä¸æ•¢æ£æµ‹jvmå’Œcpuèµ·å¦‚ä½•å®ç°ï¼Œåªè¦èƒ½å¤Ÿç”¨hbæ¨æ–­å¯è§æ€§å°±å¤Ÿäº†","user_name":"ä½œè€…å›å¤","user_name_real":"ç‹å®ä»¤","uid":"1269969","ctime":1552997731,"ip_address":"","comment_id":77539,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1552960448","product_id":100023901,"comment_content":"å¥½è®°æ€§ä¸å¦‚çƒ‚ç¬”å¤´ï¼Œæˆ‘æ˜¯è¿™ä¹ˆç†è§£è¿™ç¯‡æ–‡ç« çš„<br>æœ‰åºæ€§çš„ä¿è¯ï¼Œæ˜¯hbåŸåˆ™çº¦æŸä¼˜åŒ–çš„ç»“æœã€‚<br>å¯è§æ€§çš„ä¿è¯ï¼Œæ˜¯è¢«volatileå…³é”®å­—ä¿®é¥°çš„å˜é‡çš„è¯»æ“ä½œï¼Œä¼šå¯¼è‡´å…¶ä»–cpu cacheä¸­çš„å˜é‡å¤±æ•ˆï¼Œéœ€è¦ä»å†…å­˜ä¸­é‡æ–°loadçš„ç»“æœã€‚","like_count":0,"discussions":[{"author":{"id":1269969,"avatar":"https://static001.geekbang.org/account/avatar/00/13/60/d1/8efa89ab.jpg","nickname":"ç‹å®ä»¤","note":"","ucode":"4FE19F5BC32FCA","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":443768,"discussion_content":"æˆ‘ä¸æ•¢æ£æµ‹jvmå’Œcpuèµ·å¦‚ä½•å®ç°ï¼Œåªè¦èƒ½å¤Ÿç”¨hbæ¨æ–­å¯è§æ€§å°±å¤Ÿäº†","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1552997731,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":77534,"user_name":"Felix Envy","can_delete":false,"product_type":"c1","uid":1200085,"ip_address":"","ucode":"24E0F2165AD108","user_header":"https://static001.geekbang.org/account/avatar/00/12/4f/d5/e23dc965.jpg","comment_is_top":false,"comment_ctime":1552960237,"is_pvip":false,"replies":[{"id":"28450","content":"è¿˜æ˜¯æœ‰é—®é¢˜ï¼ŒåŠ volatileå¯ä»¥è§£å†³ï¼Œè¯¦ç»†æ–¹æ³•å¯ä»¥æœç´¢ç½‘æ–‡<br>","user_name":"ä½œè€…å›å¤","user_name_real":"ç‹å®ä»¤","uid":"1269969","ctime":1553042821,"ip_address":"","comment_id":77534,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1552960237","product_id":100023901,"comment_content":"è€å¸ˆä½ å¥½ï¼ŒåŸºäºhappen-beforeè§„åˆ™ï¼Œæ˜¯ä¸æ˜¯å¯ä»¥ç†è§£åœ¨jdk1.5ä¹‹åï¼ŒåŒæ£€é”ä¸ä¼šå†æœ‰é—®é¢˜ï¼Ÿ","like_count":0,"discussions":[{"author":{"id":1269969,"avatar":"https://static001.geekbang.org/account/avatar/00/13/60/d1/8efa89ab.jpg","nickname":"ç‹å®ä»¤","note":"","ucode":"4FE19F5BC32FCA","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":443763,"discussion_content":"è¿˜æ˜¯æœ‰é—®é¢˜ï¼ŒåŠ volatileå¯ä»¥è§£å†³ï¼Œè¯¦ç»†æ–¹æ³•å¯ä»¥æœç´¢ç½‘æ–‡\n","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1553042821,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":77504,"user_name":"xiyuesmiling","can_delete":false,"product_type":"c1","uid":1221692,"ip_address":"","ucode":"2E5AD30B1470D5","user_header":"https://static001.geekbang.org/account/avatar/00/12/a4/3c/121e7f9f.jpg","comment_is_top":false,"comment_ctime":1552957489,"is_pvip":false,"replies":[{"id":"28292","content":"è§„åˆ™ä¸€ä»…ä»…é€‚ç”¨å•çº¿ç¨‹<br>","user_name":"ä½œè€…å›å¤","user_name_real":"ç‹å®ä»¤","uid":"1269969","ctime":1552958669,"ip_address":"","comment_id":77504,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1552957489","product_id":100023901,"comment_content":"1.5ä¹‹åï¼Œå¦‚æœæœ‰è§„åˆ™ä¸€ï¼Œä¸ºä»€ä¹ˆè¿˜ä¼šå¯¼è‡´å˜å¼‚ä¼˜åŒ–å¯¼è‡´çš„è¯»å–å˜é‡xä¸å¯¹å‘¢ï¼Ÿ","like_count":0,"discussions":[{"author":{"id":1269969,"avatar":"https://static001.geekbang.org/account/avatar/00/13/60/d1/8efa89ab.jpg","nickname":"ç‹å®ä»¤","note":"","ucode":"4FE19F5BC32FCA","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":443751,"discussion_content":"è§„åˆ™ä¸€ä»…ä»…é€‚ç”¨å•çº¿ç¨‹\n","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1552958669,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":77412,"user_name":"å—å±±","can_delete":false,"product_type":"c1","uid":1119593,"ip_address":"","ucode":"94656FE4A6C378","user_header":"https://static001.geekbang.org/account/avatar/00/11/15/69/187b9968.jpg","comment_is_top":false,"comment_ctime":1552920314,"is_pvip":true,"replies":[{"id":"28334","content":"å¾ˆå…¨é¢äº†","user_name":"ä½œè€…å›å¤","user_name_real":"ç‹å®ä»¤","uid":"1269969","ctime":1552969485,"ip_address":"","comment_id":77412,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1552920314","product_id":100023901,"comment_content":"1ã€ç›´æ¥ä½¿ç”¨volatileä¿®é¥°abcï¼Œæ ¹æ®happens-before å¯¹volatileçš„å†™happens-beforeäºåç»­å¯¹è¿™ä¸ªå˜é‡çš„è¯»<br>2ã€ä½¿ç”¨volatileä¿®é¥°æ§åˆ¶è®¿é—®abcçš„æ ‡ç¤ºï¼Œå¹¶ä¸”åœ¨ä¿®æ”¹abc=3ä¹‹åå°†è®¿é—®æ ‡ç¤ºè®¾ç½®ä¸ºtrueï¼Œåœ¨åç»­è®¿é—®abcä»£ç å¤„å…ˆåˆ¤æ–­æ˜¯å¦å¯è®¿é—®abcï¼Œæ ¹æ®happens-before ç¨‹åºæœ‰æ•ˆæ€§å’Œå¯¹volatileè¯­ä¹‰å¢å¼ºï¼Œå¯ä¿è¯åœ¨è®¿é—®abcæ ‡ç¤ºä¸ºtrueçš„æ—¶å€™è®¿é—®abcä¸€å®šæ˜¯3<br>3ã€å¯¹abc=3æ“ä½œåŠ é”ï¼Œç®¡ç¨‹ä¸­çš„é”ï¼Œè§£é”happens-beforeäºåŠ é”<br>4ã€ä¸»çº¿ç¨‹è®¾ç½®abc=3ï¼Œç„¶åè°ƒç”¨å­çº¿ç¨‹çš„start()æ–¹æ³•å¯åŠ¨å­çº¿ç¨‹ï¼Œå­çº¿ç¨‹å¯è§abc=3<br>5ã€å­çº¿ç¨‹è®¾ç½®abc=3ï¼Œç„¶åå¯åŠ¨å­çº¿ç¨‹ï¼Œå¹¶è°ƒç”¨å­çº¿ç¨‹çš„joinæ–¹æ³•ï¼Œå­çº¿ç¨‹abc=3å¯¹ä¸»çº¿ç¨‹å¯è§<br>æ„Ÿè§‰è€å¸ˆè¿™é¢˜å°±æ˜¯ç”¨æ¥å›é¡¾æœ¬ç« å†…å®¹çš„ï¼Œä¸çŸ¥é“æ˜¯å¦æ­£ç¡®ï¼Ÿ","like_count":0,"discussions":[{"author":{"id":1269969,"avatar":"https://static001.geekbang.org/account/avatar/00/13/60/d1/8efa89ab.jpg","nickname":"ç‹å®ä»¤","note":"","ucode":"4FE19F5BC32FCA","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":443715,"discussion_content":"å¾ˆå…¨é¢äº†","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1552969485,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":77238,"user_name":"å®çŸ³å±±","can_delete":false,"product_type":"c1","uid":1295061,"ip_address":"","ucode":"3ADF20E12EBF99","user_header":"https://static001.geekbang.org/account/avatar/00/13/c2/d5/126eac1a.jpg","comment_is_top":false,"comment_ctime":1552894695,"is_pvip":false,"replies":[{"id":"28172","content":"ä¸é€‚ç”¨ï¼Œåé¢ä»‹ç»å¹¶å‘åŒ…çš„æ—¶å€™ä¼šè¯´è¿™ä¸ªé—®é¢˜<br>","user_name":"ä½œè€…å›å¤","user_name_real":"ç‹å®ä»¤","uid":"1269969","ctime":1552908993,"ip_address":"","comment_id":77238,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1552894695","product_id":100023901,"comment_content":"è€å¸ˆå…³äºHBçš„ç¬¬å››æ¡ç®¡ç¨‹ä¸­é”çš„è§„åˆ™ï¼Œé€‚ç”¨äºReentrantLockå—ï¼Ÿ","like_count":0,"discussions":[{"author":{"id":1269969,"avatar":"https://static001.geekbang.org/account/avatar/00/13/60/d1/8efa89ab.jpg","nickname":"ç‹å®ä»¤","note":"","ucode":"4FE19F5BC32FCA","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":443650,"discussion_content":"ä¸é€‚ç”¨ï¼Œåé¢ä»‹ç»å¹¶å‘åŒ…çš„æ—¶å€™ä¼šè¯´è¿™ä¸ªé—®é¢˜\n","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1552908993,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":77162,"user_name":"life is short, enjoy more.îŠ","can_delete":false,"product_type":"c1","uid":1074805,"ip_address":"","ucode":"3B5F37D30790A7","user_header":"https://static001.geekbang.org/account/avatar/00/10/66/75/54bb858e.jpg","comment_is_top":false,"comment_ctime":1552873414,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1552873414","product_id":100023901,"comment_content":"æ–°å­¦ç”Ÿå¯¹æœ¬é—¨è¯¾ç¨‹çš„ç¬¬ä¸€æ¬¡ç•™è¨€~<br>&#47;&#47; ä»¥ä¸‹ä»£ç æ¥æºäºã€å‚è€ƒ 1ã€‘<br>final int x;<br>&#47;&#47; é”™è¯¯çš„æ„é€ å‡½æ•°<br>public FinalFieldExample() { <br>  x = 3;<br>  y = 4;<br>  &#47;&#47; æ­¤å¤„å°±æ˜¯è®² this é€¸å‡ºï¼Œ<br>  global.obj = this;<br>}<br><br>è€å¸ˆä½ å¥½ï¼Œè¿™ä¸ªä¾‹å­æˆ‘ä¸æ˜¯å¾ˆç†è§£ï¼Œçœ‹åˆ°ä½ ç»™å…¶ä»–åŒå­¦çš„ç­”å¤æ˜¯ï¼Œthiså¯èƒ½æ²¡æœ‰åˆå§‹åŒ–å®Œã€‚ä½†æ˜¯è¿™ä¸å°±æ˜¯ä¸€ä¸ªæ„é€ å‡½æ•°å—ï¼Œthisä½äºæ„é€ å‡½æ•°çš„æœ€åä¸€è¡Œï¼Œè€Œä¸”xå·²ç»èµ‹å€¼äº†ï¼Œä¸ºä»€ä¹ˆå¯èƒ½å­˜åœ¨å…¶ä»–çº¿ç¨‹è¯»åˆ°x==0çš„æƒ…å†µå‘¢ï¼Ÿ","like_count":0},{"had_liked":false,"id":75532,"user_name":"è™è™â¤ï¸","can_delete":false,"product_type":"c1","uid":1086535,"ip_address":"","ucode":"157F261E80291A","user_header":"https://static001.geekbang.org/account/avatar/00/10/94/47/75875257.jpg","comment_is_top":false,"comment_ctime":1552410254,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1552410254","product_id":100023901,"comment_content":"æ€è€ƒé¢˜ï¼šå¯ä»¥åˆ©ç”¨å„ç§happens-before è§„åˆ™ï¼›æˆ–è€…é—´æ¥çš„ä½¿ç”¨ä¼ é€’æ€§æ¥ä¿è¯å…¶ä»–çº¿ç¨‹å¯è§ã€‚","like_count":0},{"had_liked":false,"id":75530,"user_name":"è™è™â¤ï¸","can_delete":false,"product_type":"c1","uid":1086535,"ip_address":"","ucode":"157F261E80291A","user_header":"https://static001.geekbang.org/account/avatar/00/10/94/47/75875257.jpg","comment_is_top":false,"comment_ctime":1552409316,"is_pvip":false,"replies":[{"id":"27633","content":"æ²¡é‚£ä¹ˆç®€å•ï¼Œçº¿ç¨‹æ ˆé‡Œéƒ½æ˜¯ä¸å…±äº«çš„æ•°æ®ï¼Œå¤©ç”Ÿå°±å®‰å…¨ï¼Œé—®é¢˜å‡ºåœ¨å…±äº«å˜é‡ä¸Š<br>","user_name":"ä½œè€…å›å¤","user_name_real":"ç‹å®ä»¤","uid":"1269969","ctime":1552478817,"ip_address":"","comment_id":75530,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1552409316","product_id":100023901,"comment_content":"å¯¹äºè§„åˆ™5ï¼Œä¾æ®æˆ‘å¯¹çº¿ç¨‹å¯åŠ¨çš„ç†è§£ï¼Œè‡ªçº¿ç¨‹båº”è¯¥åœ¨åˆ›å»ºä¹‹æ—¶ æ‹·è´æ‰€ä»¥çº¿ç¨‹açš„æ ˆã€‚æ‰€ä»¥è§„åˆ™5æ˜¯ä¸æ˜¯çº¿ç¨‹åˆ›å»ºåè‡ªç„¶è€Œç„¶çš„å°±æ»¡è¶³äº†è¿™ä¸ªè§„åˆ™ï¼Ÿ<br><br>æˆ‘çš„ç†è§£å¯¹å—ï¼Œè¿˜æ˜¯è¯´æœ‰å…¶ä»–çš„æœºåˆ¶æ¥ä¿è¯ï¼Ÿ","like_count":0,"discussions":[{"author":{"id":1269969,"avatar":"https://static001.geekbang.org/account/avatar/00/13/60/d1/8efa89ab.jpg","nickname":"ç‹å®ä»¤","note":"","ucode":"4FE19F5BC32FCA","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":442929,"discussion_content":"æ²¡é‚£ä¹ˆç®€å•ï¼Œçº¿ç¨‹æ ˆé‡Œéƒ½æ˜¯ä¸å…±äº«çš„æ•°æ®ï¼Œå¤©ç”Ÿå°±å®‰å…¨ï¼Œé—®é¢˜å‡ºåœ¨å…±äº«å˜é‡ä¸Š\n","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1552478817,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":75522,"user_name":"è™è™â¤ï¸","can_delete":false,"product_type":"c1","uid":1086535,"ip_address":"","ucode":"157F261E80291A","user_header":"https://static001.geekbang.org/account/avatar/00/10/94/47/75875257.jpg","comment_is_top":false,"comment_ctime":1552408080,"is_pvip":false,"replies":[{"id":"27631","content":"è§„åˆ™1åªé€‚ç”¨åˆ°çº¿ç¨‹ï¼Œåˆ«è€ƒè™‘ç¼“å­˜ä»¥åŠæ€ä¹ˆå®ç°çš„ï¼Œå…ˆç†è§£éœ€æ±‚ï¼Œæ‰èƒ½æŠŠä»£ç å†™å¥½ï¼Œå…ˆè¯»æ‡‚è§„èŒƒï¼Œå†æ¥æƒ³å®ç°ï¼Œä¸¤è€…åˆ«ææ··äº†ã€‚å®ç°æ²¡æœ‰å’±ä»¬æƒ³çš„é‚£ä¹ˆç®€å•<br><br>","user_name":"ä½œè€…å›å¤","user_name_real":"ç‹å®ä»¤","uid":"1269969","ctime":1552478590,"ip_address":"","comment_id":75522,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1552408080","product_id":100023901,"comment_content":"ç‹è€å¸ˆï¼Œæ‚¨å¥½ã€‚æ–‡ä¸­æåˆ°äº†è§„åˆ™3æ˜¯1.5ä»¥åå¯¹volatileçš„å¼ºåŒ–ã€‚<br><br>ä½†æ˜¯æ ¹æ®è§„åˆ™1 x=42çš„èµ‹å€¼ä¸€å®šå‘ç”Ÿåœ¨v=trueèµ‹å€¼ä¹‹å‰ å’Œ è§„åˆ™2 çº¿ç¨‹bçš„è¯»ï¼ˆåç»­è¯»ï¼‰ä¸€å®šå‘ç”Ÿåœ¨çº¿ç¨‹aå¯¹å˜é‡vçš„å†™ä¹‹åã€‚ é‚£ä¹ˆè‡ªç„¶è€Œç„¶çš„ï¼Œx=42çš„å†™ä¸å°±ä¸€å®šå‘ç”Ÿåœ¨çº¿ç¨‹bè¯»xä¹‹å‰äº†å—ï¼Ÿä¸ºä»€ä¹ˆè¯´è§„åˆ™3æ˜¯1.5çš„å¼ºåŒ–ï¼Œå¹¶ä¸”æœ‰äº†è§„åˆ™3ï¼Œå°±é¿å…è¯»åˆ°x=0å‘¢ï¼Ÿæˆ–è€…è¯´ï¼Œæœ‰äº†1ï¼Œ2ä¸å°±ä¸€å®šä¿è¯äº†3çš„å‘ç”Ÿå—ï¼Ÿ<br><br>åœ¨æè¿°è¿™ä¸ªé—®é¢˜çš„è¿‡ç¨‹ä¸­ï¼Œæˆ‘å·²ç»è‡ªå·±æƒ³åˆ°äº†ç­”æ¡ˆã€‚è®°å½•ä¸‹æ¥ä¾›å’Œæˆ‘æœ‰ï¼ˆif haveï¼‰åŒæ ·ç–‘æƒ‘çš„åŒå­¦ï¼Œæˆ–è€…ä»¥åçš„è‡ªå·±å‚è€ƒæŠŠã€‚<br><br>æˆ‘çš„ç†è§£æ˜¯ï¼šè¿™é‡Œè¿˜æ˜¯éœ€è¦ä»å†…å­˜çš„å¯è§æ€§æ¥åˆ†æã€‚<br>è§„åˆ™1 ä¿è¯äº†åœ¨çº¿ç¨‹Açš„cpuç¼“å­˜ä¸­ï¼Œx=42ä¸€å®šå‘ç”Ÿåœ¨å†™å…¥v=trueä¹‹å‰ã€‚<br>è§„åˆ™2 ä¿è¯äº†åœ¨çº¿ç¨‹Båœ¨è¯»å–vè¿™ä¸ªå˜é‡ä¹‹å‰ï¼Œä¸€å®šæ˜¯å…ˆç¡®ä¿äº†å…¶ä»–cpuç¼“å­˜ä¸­çš„v flushåˆ°å†…å­˜ä¸­äº†ï¼Œå¹¶ä¸”æŠŠvçš„å€¼åŒæ­¥åˆ°è‡ªå·±çš„ç¼“å­˜é‡Œã€‚ä¹Ÿå°±æ˜¯å¦‚æœå…¶ä»–çº¿ç¨‹åœ¨æ­¤ä¹‹å‰å†™è¿‡å˜é‡vï¼Œé‚£ä¹ˆæ­¤æ—¶çº¿ç¨‹Båœ¨è¯»vçš„æ—¶å€™ï¼Œä¸€å®šæ˜¯èƒ½çœ‹åˆ°ä¹‹å‰å…¶ä»–çº¿ç¨‹å†™vçš„ç»“æœã€‚<br>è§„åˆ™3 çš„ä¼ é€’æ€§åˆ™ä¿è¯äº†ï¼Œåœ¨çº¿ç¨‹Bè¯»vä¹‹å‰ï¼Œçº¿ç¨‹Aå¯¹xçš„å†™æ“ä½œå¯¹çº¿ç¨‹Bä¸€å®šå¯è§ã€‚å…¶å®å°±æ˜¯ä¿è¯æŠŠçº¿ç¨‹Aä¸­cpuç¼“å­˜çš„xå€¼åŒæ­¥åˆ°çº¿ç¨‹Bçš„cpuç¼“å­˜ä¸­ã€‚<br>ç»“è®ºï¼šåªæœ‰å•æ ¸çš„æƒ…å†µä¸‹ï¼Œ1ï¼Œ2æ‰èƒ½ä¿è¯3ã€‚","like_count":0,"discussions":[{"author":{"id":1269969,"avatar":"https://static001.geekbang.org/account/avatar/00/13/60/d1/8efa89ab.jpg","nickname":"ç‹å®ä»¤","note":"","ucode":"4FE19F5BC32FCA","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":442926,"discussion_content":"è§„åˆ™1åªé€‚ç”¨åˆ°çº¿ç¨‹ï¼Œåˆ«è€ƒè™‘ç¼“å­˜ä»¥åŠæ€ä¹ˆå®ç°çš„ï¼Œå…ˆç†è§£éœ€æ±‚ï¼Œæ‰èƒ½æŠŠä»£ç å†™å¥½ï¼Œå…ˆè¯»æ‡‚è§„èŒƒï¼Œå†æ¥æƒ³å®ç°ï¼Œä¸¤è€…åˆ«ææ··äº†ã€‚å®ç°æ²¡æœ‰å’±ä»¬æƒ³çš„é‚£ä¹ˆç®€å•\n\n","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1552478590,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":75244,"user_name":"Vincent","can_delete":false,"product_type":"c1","uid":1135159,"ip_address":"","ucode":"CD8B84A57A6A0C","user_header":"https://static001.geekbang.org/account/avatar/00/11/52/37/13b4c8aa.jpg","comment_is_top":false,"comment_ctime":1552369578,"is_pvip":false,"replies":[{"id":"27466","content":"æ²¡æœ‰ï¼Œå“ªé‡Œè¯´ä¿è¯è¿™ä¸ªäº†ï¼Ÿ","user_name":"ä½œè€…å›å¤","user_name_real":"ç‹å®ä»¤","uid":"1269969","ctime":1552393281,"ip_address":"","comment_id":75244,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1552369578","product_id":100023901,"comment_content":"è€å¸ˆä¸ºä»€ä¹ˆvolatileå¯ä»¥ä¿è¯å¯¹ä»–ä¹‹åçš„å˜é‡ä¿®æ”¹æ“ä½œçš„å¯è§æ€§ï¼Ÿhappen-beforeæ²¡æœ‰è¿™é¡¹è§„åˆ™å•Š","like_count":0,"discussions":[{"author":{"id":1269969,"avatar":"https://static001.geekbang.org/account/avatar/00/13/60/d1/8efa89ab.jpg","nickname":"ç‹å®ä»¤","note":"","ucode":"4FE19F5BC32FCA","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":442835,"discussion_content":"æ²¡æœ‰ï¼Œå“ªé‡Œè¯´ä¿è¯è¿™ä¸ªäº†ï¼Ÿ","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1552393281,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":75224,"user_name":"ä½ è¯´çš„ç°","can_delete":false,"product_type":"c1","uid":1158981,"ip_address":"","ucode":"650FA935A7741F","user_header":"https://static001.geekbang.org/account/avatar/00/11/af/45/8bacada2.jpg","comment_is_top":false,"comment_ctime":1552366809,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1552366809","product_id":100023901,"comment_content":"åŒé—®","like_count":0},{"had_liked":false,"id":74970,"user_name":"è‹¥å°˜","can_delete":false,"product_type":"c1","uid":1212972,"ip_address":"","ucode":"8C83E47DB797C9","user_header":"https://static001.geekbang.org/account/avatar/00/12/82/2c/e8cf7f2f.jpg","comment_is_top":false,"comment_ctime":1552327379,"is_pvip":false,"replies":[{"id":"27345","content":"æ²¡å†™è¿‡jvmçš„ç¼–è¯‘å™¨å’Œè§£é‡Šå™¨ï¼Œä¸æ•¢å¦„è°ˆï¼Œä½ å¦‚æœæ„Ÿå…´è¶£å¯ä»¥ç ”è¯»ä¸€ä¸‹jsr133 çš„ååŠéƒ¨åˆ†ï¼Œé‚£ä¸ªæ˜¯é¢å‘jvmçš„å®ç°äººå‘˜çš„<br>","user_name":"ä½œè€…å›å¤","user_name_real":"ç‹å®ä»¤","uid":"1269969","ctime":1552350336,"ip_address":"","comment_id":74970,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1552327379","product_id":100023901,"comment_content":"æ—¢ç„¶å¼•å‡ºäº†å†…å­˜æ¨¡å‹åŠhappen beforeåŸåˆ™ï¼Œé‚£jdkä¸­åˆæ˜¯å¦‚ä½•ä¿è¯è¿™äº›åŸåˆ™çš„å‘¢ï¼Ÿæˆ–è€…è¯´æ€ä¹ˆå®ç°äº†è¿™äº›åŸåˆ™ï¼Ÿè°¢è°¢","like_count":0,"discussions":[{"author":{"id":1269969,"avatar":"https://static001.geekbang.org/account/avatar/00/13/60/d1/8efa89ab.jpg","nickname":"ç‹å®ä»¤","note":"","ucode":"4FE19F5BC32FCA","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":442762,"discussion_content":"æ²¡å†™è¿‡jvmçš„ç¼–è¯‘å™¨å’Œè§£é‡Šå™¨ï¼Œä¸æ•¢å¦„è°ˆï¼Œä½ å¦‚æœæ„Ÿå…´è¶£å¯ä»¥ç ”è¯»ä¸€ä¸‹jsr133 çš„ååŠéƒ¨åˆ†ï¼Œé‚£ä¸ªæ˜¯é¢å‘jvmçš„å®ç°äººå‘˜çš„\n","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1552350336,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":74347,"user_name":"é˜¿ç”˜","can_delete":false,"product_type":"c1","uid":1136022,"ip_address":"","ucode":"5808CB57A03148","user_header":"https://static001.geekbang.org/account/avatar/00/11/55/96/5160cd31.jpg","comment_is_top":false,"comment_ctime":1552196686,"is_pvip":false,"replies":[{"id":"27180","content":"è§„èŒƒæ˜¯ä¸€ç äº‹ï¼Œå…·ä½“å®ç°æ˜¯ä¸€ç äº‹ã€‚è¿™ä¸ªæˆ‘ä¹ŸéªŒè¯ä¸å‡ºæ¥ï¼Œä¸è¿‡è¿˜æ˜¯æŒ‰ç…§è§„èŒƒåŠäº‹å¥½äº›ã€‚","user_name":"ä½œè€…å›å¤","user_name_real":"ç‹å®ä»¤","uid":"1269969","ctime":1552200986,"ip_address":"","comment_id":74347,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1552196686","product_id":100023901,"comment_content":"class VolatileExample ä¸­å³ä½¿å˜é‡vä¸åŠ volatileï¼Œç”±äºX86CPUä¸æ”¯æŒå†™å†™é‡æ’åºï¼Œåœ¨x86ä¸Šé¢æ“ä½œï¼Œè¿™ä¸ªä¸€å®šä¼šæ˜¯x=42ï¼ˆä»åˆ«çš„ç½‘é¡µçœ‹åˆ°çš„ï¼Œæœ¬äººæ²¡æœ‰éªŒè¯ï¼‰","like_count":0,"discussions":[{"author":{"id":1269969,"avatar":"https://static001.geekbang.org/account/avatar/00/13/60/d1/8efa89ab.jpg","nickname":"ç‹å®ä»¤","note":"","ucode":"4FE19F5BC32FCA","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":442543,"discussion_content":"è§„èŒƒæ˜¯ä¸€ç äº‹ï¼Œå…·ä½“å®ç°æ˜¯ä¸€ç äº‹ã€‚è¿™ä¸ªæˆ‘ä¹ŸéªŒè¯ä¸å‡ºæ¥ï¼Œä¸è¿‡è¿˜æ˜¯æŒ‰ç…§è§„èŒƒåŠäº‹å¥½äº›ã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1552200986,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":74344,"user_name":"îˆ± è‡£é¦Ÿé£æ‰¬îˆ°","can_delete":false,"product_type":"c1","uid":1116188,"ip_address":"","ucode":"F2F882B7678055","user_header":"https://static001.geekbang.org/account/avatar/00/11/08/1c/ef15e661.jpg","comment_is_top":false,"comment_ctime":1552195936,"is_pvip":false,"replies":[{"id":"27178","content":"å¤šè°¢ç››èµï¼ï¼","user_name":"ä½œè€…å›å¤","user_name_real":"ç‹å®ä»¤","uid":"1269969","ctime":1552200837,"ip_address":"","comment_id":74344,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1552195936","product_id":100023901,"comment_content":"ç‹è€å¸ˆè®²è§£çš„happen-beforeè§„åˆ™ç”šå¥½ï¼Œä¹‹å‰ä»¥ä¸ºA happen-before Bå°±æ˜¯Aå‘ç”Ÿåœ¨Bä¹‹å‰ï¼Œè¿™æ¬¡æœ‰äº†æ–°çš„è®¤è¯†ã€‚","like_count":0,"discussions":[{"author":{"id":1269969,"avatar":"https://static001.geekbang.org/account/avatar/00/13/60/d1/8efa89ab.jpg","nickname":"ç‹å®ä»¤","note":"","ucode":"4FE19F5BC32FCA","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":442541,"discussion_content":"å¤šè°¢ç››èµï¼ï¼","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1552200837,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":74112,"user_name":"WL","can_delete":false,"product_type":"c1","uid":1173771,"ip_address":"","ucode":"6277DCD776B87E","user_header":"https://static001.geekbang.org/account/avatar/00/11/e9/0b/1171ac71.jpg","comment_is_top":false,"comment_ctime":1552105997,"is_pvip":false,"replies":[{"id":"27111","content":"æˆ‘è®¤ä¸ºï¼Œå„ä¸ªçº¿ç¨‹ä¸­ä¸ä¼šç¼“å­˜ä¸»å†…å­˜çš„å‰¯æœ¬ã€‚é™¤éçº¿ç¨‹è¢«æŒ‚èµ·ï¼Œæ‰ä¼šæŠŠå¯„å­˜å™¨çš„å†…å®¹å¤åˆ¶åˆ°çº¿ç¨‹ä¸Šä¸‹æ–‡é‡Œé¢ã€‚<br><br>","user_name":"ä½œè€…å›å¤","user_name_real":"ç‹å®ä»¤","uid":"1269969","ctime":1552114805,"ip_address":"","comment_id":74112,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1552105997","product_id":100023901,"comment_content":"æˆ‘æœ‰ä¸€ä¸ªé—®é¢˜,  cpuç¼“å­˜å’Œå„ä¸ªçº¿ç¨‹ä¸­ç¼“å­˜çš„ä¸»å†…å­˜çš„æœ¬è´¨å¤æœ¬æ˜¯ä¸æ˜¯ä¸€å›äº‹? ","like_count":0,"discussions":[{"author":{"id":1269969,"avatar":"https://static001.geekbang.org/account/avatar/00/13/60/d1/8efa89ab.jpg","nickname":"ç‹å®ä»¤","note":"","ucode":"4FE19F5BC32FCA","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":442451,"discussion_content":"æˆ‘è®¤ä¸ºï¼Œå„ä¸ªçº¿ç¨‹ä¸­ä¸ä¼šç¼“å­˜ä¸»å†…å­˜çš„å‰¯æœ¬ã€‚é™¤éçº¿ç¨‹è¢«æŒ‚èµ·ï¼Œæ‰ä¼šæŠŠå¯„å­˜å™¨çš„å†…å®¹å¤åˆ¶åˆ°çº¿ç¨‹ä¸Šä¸‹æ–‡é‡Œé¢ã€‚\n\n","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1552114805,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":73953,"user_name":"é©¬å…‹","can_delete":false,"product_type":"c1","uid":1106597,"ip_address":"","ucode":"C1D35AB8373444","user_header":"https://static001.geekbang.org/account/avatar/00/10/e2/a5/05276fad.jpg","comment_is_top":false,"comment_ctime":1552043268,"is_pvip":false,"replies":[{"id":"26972","content":"æ“ä½œç³»ç»Ÿéšæ—¶éƒ½å¯ä»¥åˆ‡æ¢ï¼Œä¸ç®¡çº¿ç¨‹æ‰§è¡Œåˆ°å“ªé‡Œã€‚ä¸‹ä¸€æœŸä¼šè®²syncï¼Œä¸ä¼šæœ‰è„æ•°æ®çš„<br>","user_name":"ä½œè€…å›å¤","user_name_real":"ç‹å®ä»¤","uid":"1269969","ctime":1552046581,"ip_address":"","comment_id":73953,"utype":1}],"discussion_count":2,"race_medal":0,"score":"1552043268","product_id":100023901,"comment_content":"è€å¸ˆï¼Œæœ‰ä¸€ç‚¹ä¸æ˜ç™½ï¼šä½¿ç”¨volatileå…³é”®å­—ä¿®é¥°çš„å˜é‡ï¼Œåœ¨æ‰§è¡Œ++æ“ä½œçš„æ—¶å€™ï¼Œæœ‰å–å€¼ï¼Œè®¡ç®—ï¼Œèµ‹å€¼çš„CPUæŒ‡ä»¤ï¼Œå¦‚æœåœ¨æ—¶é—´åˆ†ç‰‡åˆ°è¾¾æ—¶æ‰æ‰§è¡Œäº†è®¡ç®—ï¼Œæ­¤æ—¶ä¼šç»§ç»­æ‰§è¡Œèµ‹å€¼æ“ä½œå†åˆ‡æ¢å—ï¼ŸåŒæ ·çš„ï¼Œåƒè¿™ç§å¤šCPUæŒ‡ä»¤çš„æ“ä½œåŠ ä¸Šsynchronizeåï¼Œä¸­é—´æŒ‡ä»¤å‘ç”Ÿåˆ‡æ¢æ—¶ï¼Œæ˜¯ä¸æ˜¯ç»§ç»­æ‰§è¡ŒåŒæ­¥å—å†…çš„ä»£ç ï¼Ÿå¦åˆ™ï¼Œæ˜¯å¦ä¼šå‡ºç°è„æ•°æ®ï¼Ÿ<br>è°¢è°¢æŒ‡å¯¼","like_count":0,"discussions":[{"author":{"id":1269969,"avatar":"https://static001.geekbang.org/account/avatar/00/13/60/d1/8efa89ab.jpg","nickname":"ç‹å®ä»¤","note":"","ucode":"4FE19F5BC32FCA","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":442357,"discussion_content":"æ“ä½œç³»ç»Ÿéšæ—¶éƒ½å¯ä»¥åˆ‡æ¢ï¼Œä¸ç®¡çº¿ç¨‹æ‰§è¡Œåˆ°å“ªé‡Œã€‚ä¸‹ä¸€æœŸä¼šè®²syncï¼Œä¸ä¼šæœ‰è„æ•°æ®çš„\n","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1552046581,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1484192,"avatar":"https://static001.geekbang.org/account/avatar/00/16/a5/a0/e0cccf7e.jpg","nickname":"åœ†åœ†æ»¡æ»¡","note":"","ucode":"396E7A822014D1","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":289369,"discussion_content":"èµ‹å€¼æ“ä½œæ²¡æœ‰æ‰§è¡Œï¼Œé”æ˜¯ä¸ä¼šé‡Šæ”¾çš„ï¼Œå…¶ä»–çº¿ç¨‹ä¹Ÿæ˜¯ç­‰å¾…é”ã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1594082854,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":73878,"user_name":"Owen","can_delete":false,"product_type":"c1","uid":1209023,"ip_address":"","ucode":"C9A406054F3F9E","user_header":"https://static001.geekbang.org/account/avatar/00/12/72/bf/26519889.jpg","comment_is_top":false,"comment_ctime":1552023433,"is_pvip":false,"replies":[{"id":"27019","content":"è¿™ä¸ªæˆ‘çœŸä¸æ•¢ç¡®å®šã€‚åšJVMçš„äººè¿œæ¯”æˆ‘ä»¬èªæ˜ã€‚","user_name":"ä½œè€…å›å¤","user_name_real":"ç‹å®ä»¤","uid":"1269969","ctime":1552059875,"ip_address":"","comment_id":73878,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1552023433","product_id":100023901,"comment_content":"Thread B = new Thread(()-&gt;{<br>  &#47;&#47; ä¸»çº¿ç¨‹è°ƒç”¨ B.start() ä¹‹å‰<br>  &#47;&#47; æ‰€æœ‰å¯¹å…±äº«å˜é‡çš„ä¿®æ”¹ï¼Œæ­¤å¤„çš†å¯è§<br>  &#47;&#47; æ­¤ä¾‹ä¸­ï¼Œvar==77<br>});<br>&#47;&#47; æ­¤å¤„å¯¹å…±äº«å˜é‡ var ä¿®æ”¹<br>var = 77;<br>&#47;&#47; ä¸»çº¿ç¨‹å¯åŠ¨å­çº¿ç¨‹<br>B.start();<br><br>Thread Bå¯ä»¥è®¿é—®varæ˜¯ä¸æ˜¯æ„å‘³ç€ä¸»çº¿ç¨‹åœ¨å¯åŠ¨Thread Bä¹‹å‰è¦æŠŠä¸»å­˜è®¾ç½®ä¸ºæ— æ•ˆï¼Œå¹¶æŠŠvaræ›´æ–°åˆ°ä¸»å­˜?<br><br>","like_count":0,"discussions":[{"author":{"id":1269969,"avatar":"https://static001.geekbang.org/account/avatar/00/13/60/d1/8efa89ab.jpg","nickname":"ç‹å®ä»¤","note":"","ucode":"4FE19F5BC32FCA","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":442319,"discussion_content":"è¿™ä¸ªæˆ‘çœŸä¸æ•¢ç¡®å®šã€‚åšJVMçš„äººè¿œæ¯”æˆ‘ä»¬èªæ˜ã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1552059875,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":73860,"user_name":"Owen","can_delete":false,"product_type":"c1","uid":1209023,"ip_address":"","ucode":"C9A406054F3F9E","user_header":"https://static001.geekbang.org/account/avatar/00/12/72/bf/26519889.jpg","comment_is_top":false,"comment_ctime":1552018345,"is_pvip":false,"replies":[{"id":"27020","content":"æ˜¯å¦åˆ·ç¼“å­˜ã€ä»¥åŠjvmæ˜¯å¦‚ä½•åšåˆ°æ˜¯JVMçš„å¼€å‘äººå‘˜è¦è€ƒè™‘çš„ã€‚ä½ å¯ä»¥å‚è€ƒä¸€äº›å†…å­˜å±éšœä¹‹ç±»çš„ä¸œè¥¿ï¼Œæˆ‘å·¥ä½œä¸­ç”¨ä¸åˆ°ï¼Œæ‰€ä»¥æˆ‘ä¹Ÿåªæ˜¯é“å¬é€”è¯´ï¼Œå°±ä¸æ•¢è¯¯å¯¼å¤§å®¶äº†ã€‚æˆ‘è§‰å¾—æ›´é‡è¦çš„æ˜¯èƒ½åˆ©ç”¨è¿™äº›è§„åˆ™ï¼Œæ¨æ¼”ç¨‹åºçš„æ‰§è¡Œè¿‡ç¨‹ã€‚<br><br>çº¿ç¨‹Cåœ¨è¿›å…¥åŒæ­¥å—å‰ï¼Œä¹Ÿè®¸èƒ½çœ‹åˆ°10ï¼Œä¹Ÿè®¸èƒ½çœ‹åˆ°12ï¼Œè¿™ä¸ªä¸ç¡®å®šã€‚æ‰€ä»¥æ‰éœ€è¦åŒæ­¥ã€‚<br><br><br>","user_name":"ä½œè€…å›å¤","user_name_real":"ç‹å®ä»¤","uid":"1269969","ctime":1552060685,"ip_address":"","comment_id":73860,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1552018345","product_id":100023901,"comment_content":"synchronized (this) { &#47;&#47; æ­¤å¤„è‡ªåŠ¨åŠ é”<br>  &#47;&#47; x æ˜¯å…±äº«å˜é‡, åˆå§‹å€¼ =10<br>  if (this.x &lt; 12) {<br>    this.x = 12; <br>  }  <br>} &#47;&#47; æ­¤å¤„è‡ªåŠ¨è§£é”<br><br>Hiï¼Œè€å¸ˆæˆ‘æ­¤å¤„ä¸å¤ªæ˜ç™½ï¼Œ<br>1.å‡è®¾Açº¿ç¨‹è¿›å…¥åŒæ­¥å—ï¼Œæ‰§è¡Œäº†  this.x = 12ï¼Œå½“è‡ªåŠ¨è§£é”çš„æ—¶å€™ä¼šæŠŠ12åˆ·å›ä¸»å­˜å—ï¼Ÿ<br>2.æŒ‰æ‚¨æ–‡ç« ä¸­çš„è¯´æ³•ï¼Œå½“çº¿ç¨‹Bè¿›å…¥åŒæ­¥å—çš„æ—¶å€™æ‰å¯ä»¥è®¿é—®åˆ°x=12ï¼Œé‚£jvmæ˜¯å¦‚ä½•åšåˆ°è¿™ä¸€ç‚¹çš„ï¼Œ<br>3.é‚£å¦‚æœæœ‰ä¸€ä¸ªçº¿ç¨‹Cåœ¨è¿›å…¥åŒæ­¥å—å‰æ‹¿åˆ°çš„x=10ï¼Ÿè¿˜æ˜¯12<br>","like_count":0,"discussions":[{"author":{"id":1269969,"avatar":"https://static001.geekbang.org/account/avatar/00/13/60/d1/8efa89ab.jpg","nickname":"ç‹å®ä»¤","note":"","ucode":"4FE19F5BC32FCA","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":442308,"discussion_content":"æ˜¯å¦åˆ·ç¼“å­˜ã€ä»¥åŠjvmæ˜¯å¦‚ä½•åšåˆ°æ˜¯JVMçš„å¼€å‘äººå‘˜è¦è€ƒè™‘çš„ã€‚ä½ å¯ä»¥å‚è€ƒä¸€äº›å†…å­˜å±éšœä¹‹ç±»çš„ä¸œè¥¿ï¼Œæˆ‘å·¥ä½œä¸­ç”¨ä¸åˆ°ï¼Œæ‰€ä»¥æˆ‘ä¹Ÿåªæ˜¯é“å¬é€”è¯´ï¼Œå°±ä¸æ•¢è¯¯å¯¼å¤§å®¶äº†ã€‚æˆ‘è§‰å¾—æ›´é‡è¦çš„æ˜¯èƒ½åˆ©ç”¨è¿™äº›è§„åˆ™ï¼Œæ¨æ¼”ç¨‹åºçš„æ‰§è¡Œè¿‡ç¨‹ã€‚\n\nçº¿ç¨‹Cåœ¨è¿›å…¥åŒæ­¥å—å‰ï¼Œä¹Ÿè®¸èƒ½çœ‹åˆ°10ï¼Œä¹Ÿè®¸èƒ½çœ‹åˆ°12ï¼Œè¿™ä¸ªä¸ç¡®å®šã€‚æ‰€ä»¥æ‰éœ€è¦åŒæ­¥ã€‚\n\n\n","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1552060685,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":73824,"user_name":"ç©ºçŸ¥","can_delete":false,"product_type":"c1","uid":1013283,"ip_address":"","ucode":"C448E98238DD36","user_header":"https://static001.geekbang.org/account/avatar/00/0f/76/23/31e5e984.jpg","comment_is_top":false,"comment_ctime":1552010528,"is_pvip":false,"replies":[{"id":"26960","content":"æ˜¯è¿™æ ·çš„ï¼Œlinuxé‡Œçš„çº¿ç¨‹å°±æ˜¯ç”¨è¿›ç¨‹ç»“æ„å®ç°çš„<br>","user_name":"ä½œè€…å›å¤","user_name_real":"ç‹å®ä»¤","uid":"1269969","ctime":1552019351,"ip_address":"","comment_id":73824,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1552010528","product_id":100023901,"comment_content":"æŸ¥äº†ä¸‹,åˆ‡æ¢æ—¶äº‹å…ˆå¼€è¾Ÿå¥½çš„ä¸€å—å›ºå®šç©ºé—´é‡Œï¼Œæ¯”å¦‚Linuxçš„task_struct æ¥å­˜çº¿ç¨‹ä¿¡æ¯","like_count":0,"discussions":[{"author":{"id":1269969,"avatar":"https://static001.geekbang.org/account/avatar/00/13/60/d1/8efa89ab.jpg","nickname":"ç‹å®ä»¤","note":"","ucode":"4FE19F5BC32FCA","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":442296,"discussion_content":"æ˜¯è¿™æ ·çš„ï¼Œlinuxé‡Œçš„çº¿ç¨‹å°±æ˜¯ç”¨è¿›ç¨‹ç»“æ„å®ç°çš„\n","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1552019351,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":73399,"user_name":"punchline","can_delete":false,"product_type":"c1","uid":1314136,"ip_address":"","ucode":"32391B470CCD18","user_header":"https://static001.geekbang.org/account/avatar/00/14/0d/58/008173ad.jpg","comment_is_top":false,"comment_ctime":1551878687,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1551878687","product_id":100023901,"comment_content":"@ç‹‚æˆ˜ä¿„æ´›ä¼Š æœ‰ä¸€ç‚¹ä¸æ˜¯å¾ˆæ˜ç™½ æ ¹æ®happens-before è§„åˆ™ç¬¬ä¸€æ¡ï¼Œåœ¨ä¸€ä¸ªçº¿ç¨‹ä¸­ï¼Œä¼šæŒ‰ç¨‹åºä»£ç é¡ºåº å‰é¢çš„ä»£ç å—å¯¹äºåé¢çš„ä»£ç å—å¯è§ï¼Œé‚£ä¸ºä»€ä¹ˆint a =1ä¸int b =2çš„æ‰§è¡Œé¡ºåºä¸ä¸€å®šå‘¢ï¼Ÿ æ—¢ç„¶åé¢çš„int b =2 å¯ä»¥çœ‹è§å‰é¢çš„int a=1 é‚£int a=1 ä¸æ˜¯åº”è¯¥ä¸€ç›´åœ¨int b=2çš„å‰é¢æ‰§è¡Œå—? ","like_count":0},{"had_liked":false,"id":73328,"user_name":"é™ˆå","can_delete":false,"product_type":"c1","uid":1082730,"ip_address":"","ucode":"3AF9E8EB39E507","user_header":"http://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTKtS26SJpSF7JLu9pusGsy1Qln0NdQg1eV2YKOJxpX2QXaBuuyXMqZY3fm0rhzKwsqN5aa6CVNOQQ/132","comment_is_top":false,"comment_ctime":1551861929,"is_pvip":false,"replies":[{"id":"26711","content":"è¿™ä¸ªåªæ˜¯ä¸ªä¾‹å­ï¼Œå®é™…ç¼–è¯‘å™¨çš„ä¼˜åŒ–å’Œcpuæ‰§è¡Œçš„ä¼˜åŒ–è¿œä¸æ˜¯æˆ‘ä»¬æƒ³è±¡çš„ã€‚è¿™ä¸ªä¾‹å­åªæ˜¯å‘Šè¯‰ä½ ç¼–è¯‘å™¨é‡æ’æ˜¯ä¸æ˜¯åˆæ³•ï¼Œå¦‚æœåˆæ³•é‚£å°±æœ‰å¯èƒ½ï¼Œå®é™…ä¸Šå¯èƒ½ä¸ä¼šã€‚","user_name":"ä½œè€…å›å¤","user_name_real":"ç‹å®ä»¤","uid":"1269969","ctime":1551880832,"ip_address":"","comment_id":73328,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1551861929","product_id":100023901,"comment_content":"è€å¸ˆæœ‰ä¸€ä¸ªç–‘é—®:<br>ç¬¬ä¸€ä¸ªé¡ºåºæ€§ï¼Œç¬¬6,7è¡Œä»£ç <br>x = 42; <br>v = true;<br>ä¼šä¸ä¼šè¢«é‡æ–°æ’åºä¸º<br>v = true;<br>x = 42ï¼›<br>è¿™æ ·Açº¿ç¨‹ æ‰§è¡Œå®Œ v=true; åï¼Œcpuåˆ‡æ¢åˆ°çº¿ç¨‹Bï¼ŒBæ­¤æ—¶è¯»å–çš„xå€¼ä¸º0.<br><br>ç¬¬6,7æœ‰é‡æ’åºçš„å¯èƒ½å—ï¼Œä¸ºå•¥å‘¢ï¼Ÿ","like_count":0,"discussions":[{"author":{"id":1269969,"avatar":"https://static001.geekbang.org/account/avatar/00/13/60/d1/8efa89ab.jpg","nickname":"ç‹å®ä»¤","note":"","ucode":"4FE19F5BC32FCA","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":442026,"discussion_content":"è¿™ä¸ªåªæ˜¯ä¸ªä¾‹å­ï¼Œå®é™…ç¼–è¯‘å™¨çš„ä¼˜åŒ–å’Œcpuæ‰§è¡Œçš„ä¼˜åŒ–è¿œä¸æ˜¯æˆ‘ä»¬æƒ³è±¡çš„ã€‚è¿™ä¸ªä¾‹å­åªæ˜¯å‘Šè¯‰ä½ ç¼–è¯‘å™¨é‡æ’æ˜¯ä¸æ˜¯åˆæ³•ï¼Œå¦‚æœåˆæ³•é‚£å°±æœ‰å¯èƒ½ï¼Œå®é™…ä¸Šå¯èƒ½ä¸ä¼šã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1551880832,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":73015,"user_name":"tracer","can_delete":false,"product_type":"c1","uid":1124766,"ip_address":"","ucode":"AE2BC047DB7D7D","user_header":"https://static001.geekbang.org/account/avatar/00/11/29/9e/380a01ea.jpg","comment_is_top":false,"comment_ctime":1551777642,"is_pvip":false,"replies":[{"id":"26512","content":"æˆ‘ä¹Ÿæ²¡æµ‹å‡ºæ¥ã€‚å› ä¸ºè¿™ä¸ªä»£ç ç¼–è¯‘å™¨å‹æ ¹å°±æ²¡å•¥å¥½ä¼˜åŒ–çš„ã€‚è¿™ä¸ªä¾‹å­åªæ˜¯ç”¨æ¥åˆ†æé—®é¢˜çš„","user_name":"ä½œè€…å›å¤","user_name_real":"ç‹å®ä»¤","uid":"1269969","ctime":1551797397,"ip_address":"","comment_id":73015,"utype":1}],"discussion_count":1,"race_medal":1,"score":"1551777642","product_id":100023901,"comment_content":"class VolatileExample {<br>  int x = 0;<br>  boolean v = false;<br>  public void writer() {<br>    x = 42;<br>    v = true;<br>  }<br><br>  public void reader() {<br>    if (v == true) {<br>         System.out.println(x);<br>    }<br>  }<br>}<br><br>è€å¸ˆçš„ä¾‹å­ä¸­æˆ‘åˆ é™¤äº†volatileï¼Œä½†æ˜¯å¹¶æ²¡æœ‰æµ‹è¯•å‡ºè¾“å‡ºv=0çš„æƒ…å†µï¼Œè¿™æ˜¯æ€ä¹ˆä¸€å›äº‹å‘¢ï¼Ÿ","like_count":0,"discussions":[{"author":{"id":1269969,"avatar":"https://static001.geekbang.org/account/avatar/00/13/60/d1/8efa89ab.jpg","nickname":"ç‹å®ä»¤","note":"","ucode":"4FE19F5BC32FCA","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":441877,"discussion_content":"æˆ‘ä¹Ÿæ²¡æµ‹å‡ºæ¥ã€‚å› ä¸ºè¿™ä¸ªä»£ç ç¼–è¯‘å™¨å‹æ ¹å°±æ²¡å•¥å¥½ä¼˜åŒ–çš„ã€‚è¿™ä¸ªä¾‹å­åªæ˜¯ç”¨æ¥åˆ†æé—®é¢˜çš„","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1551797397,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":72621,"user_name":"Mè€ç«‹","can_delete":false,"product_type":"c1","uid":1061389,"ip_address":"","ucode":"751A056A0CBA61","user_header":"https://static001.geekbang.org/account/avatar/00/10/32/0d/6e0a440f.jpg","comment_is_top":false,"comment_ctime":1551679809,"is_pvip":false,"replies":[{"id":"26281","content":"æ¯å‘¨äºŒå››å…­","user_name":"ç¼–è¾‘å›å¤","user_name_real":"éƒ­è•¾","uid":"1000473","ctime":1551679895,"ip_address":"","comment_id":72621,"utype":2}],"discussion_count":1,"race_medal":0,"score":"1551679809","product_id":100023901,"comment_content":"ç‹è€å¸ˆ ä»€ä¹ˆæ—¶å€™ä¸Šæ–°å•Š ç­‰ä¸åŠäº† è¿™ä¸¤å¤©åå¤çœ‹å·²ç»æœ‰çš„ æ¯ä¸€ééƒ½æœ‰æ”¶è· ","like_count":0,"discussions":[{"author":{"id":1000473,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/44/19/17fadc62.jpg","nickname":"éƒ­è•¾","note":"","ucode":"34F4C07D1C5FE8","race_medal":0,"user_type":8,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":441664,"discussion_content":"æ¯å‘¨äºŒå››å…­","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1551679895,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":4}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":72579,"user_name":"Smile","can_delete":false,"product_type":"c1","uid":1125189,"ip_address":"","ucode":"0617032294DC43","user_header":"https://static001.geekbang.org/account/avatar/00/11/2b/45/e8f64725.jpg","comment_is_top":false,"comment_ctime":1551670684,"is_pvip":false,"replies":[{"id":"26359","content":"å¯¹äºvolatileå˜é‡è§„åˆ™ï¼šä»æ—¶é—´ä¸Šï¼Œå…ˆå†™å…¥çš„æ•°æ®ï¼Œåé¢æŸ¥ï¼Œä¸€å®šèƒ½æŸ¥çš„åˆ°ã€‚ä¼˜äºè¿™ä¸ªè¯æˆ‘ä¸å¤ªç†è§£ï¼Œæ„Ÿè§‰ä¸å¤ªå¯¹ã€‚<br><br>è¿™äº›è§„åˆ™å¾—ç»„åˆç€çœ‹ï¼Œæ‰æœ‰æ„ä¹‰ã€‚","user_name":"ä½œè€…å›å¤","user_name_real":"ç‹å®ä»¤","uid":"1269969","ctime":1551711886,"ip_address":"","comment_id":72579,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1551670684","product_id":100023901,"comment_content":"1. å¯¹äºç¨‹åºçš„é¡ºåºæ€§è§„åˆ™ï¼Œé’ˆå¯¹çš„ä¸€ä¸ªçº¿ç¨‹ä¸­ï¼Œå‰é¢çš„æ“ä½œå¯¹åé¢çš„æ“ä½œå¯è§ï¼Œæ˜¯ä¸æ˜¯å¯ä»¥ç†è§£ä¸ºï¼Œä»£ç é‡æ’ä¹‹åï¼Œåœ¨å‰é¢æ‰§è¡ŒCPUæŒ‡ä»¤æ‰§è¡Œçš„ç»“æœå¯¹åé¢çš„æ‰§è¡Œç»“æœæ˜¯å¯è§çš„ã€‚<br>2. åŒæ ·æ˜¯å¯¹äºé¡ºåºæ€§è§„åˆ™ï¼Œå¦‚æœå‚è€ƒ1ä¸­ï¼Œæ²¡æœ‰åŠ volatileå…³é”®å­—çš„è¯ï¼Œx å’Œvçš„åˆå§‹åŒ–å¾ˆæœ‰å¯èƒ½é‡æ’ï¼Œé‚£ä¹ˆå½“å¤šä¸ªçº¿ç¨‹è®¿é—®æ—¶ï¼Œå°±ä¼šå‡ºç°å½“è¯»çš„æ—¶å€™å‡ºç°x=0çš„æƒ…å†µã€‚volatileä¿è¯äº†ä¿®æ”¹å˜é‡ä¹‹å‰çš„è¯­å¥æŒ‰ç…§ä¹¦å†™çš„é¡ºåºæ‰§è¡Œï¼Œä¸èƒ½è¿›è¡Œæ’åºã€‚åŒæ—¶ï¼Œä¿è¯äº†ä¿®é¥°å˜é‡çš„å¯è§æ€§ã€‚<br>3 å¯¹äºvolatileå˜é‡è§„åˆ™ï¼Œå†™æ“ä½œä¼˜äºè¯»æ“ä½œï¼Œåº”è¯¥æ˜¯å†™æ“ä½œä¹‹åçš„æ•°æ®ä¼šåŠæ—¶æ›´æ–°åˆ°å†…å­˜ï¼Œå…¶ä»–çº¿ç¨‹å¯è§ï¼Œæˆ–è€…ç†è§£ä¸ºå†™æ“ä½œä¼˜äºåç»­æ—¶é—´å¯¹è¯¥å˜é‡çš„æ‰§è¡Œçš„å†™æ“ä½œå’Œè¯»æ“ä½œ<br>ä¸çŸ¥é“è¿™äº›ç†è§£æ˜¯å¦æ­£ç¡®ï¼Œè¯·è€å¸ˆæŒ‡æ­£","like_count":0,"discussions":[{"author":{"id":1269969,"avatar":"https://static001.geekbang.org/account/avatar/00/13/60/d1/8efa89ab.jpg","nickname":"ç‹å®ä»¤","note":"","ucode":"4FE19F5BC32FCA","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":441645,"discussion_content":"å¯¹äºvolatileå˜é‡è§„åˆ™ï¼šä»æ—¶é—´ä¸Šï¼Œå…ˆå†™å…¥çš„æ•°æ®ï¼Œåé¢æŸ¥ï¼Œä¸€å®šèƒ½æŸ¥çš„åˆ°ã€‚ä¼˜äºè¿™ä¸ªè¯æˆ‘ä¸å¤ªç†è§£ï¼Œæ„Ÿè§‰ä¸å¤ªå¯¹ã€‚\n\nè¿™äº›è§„åˆ™å¾—ç»„åˆç€çœ‹ï¼Œæ‰æœ‰æ„ä¹‰ã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1551711886,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":72465,"user_name":"Geek_ebda96","can_delete":false,"product_type":"c1","uid":1134862,"ip_address":"","ucode":"02912E6D95A5A6","user_header":"http://thirdwx.qlogo.cn/mmopen/vi_32/DYAIOgq83eoRiaKX0ulEibbbwM4xhjyMeza0Pyp7KO1mqvfJceiaM6ZNtGpXJibI6P2qHGwBP9GKwOt9LgHicHflBXw/132","comment_is_top":false,"comment_ctime":1551635146,"is_pvip":false,"replies":[{"id":"26339","content":"æœ‰æ•ˆã€‚å½“ç„¶æœ‰å…³ç³»ã€‚","user_name":"ä½œè€…å›å¤","user_name_real":"ç‹å®ä»¤","uid":"1269969","ctime":1551708827,"ip_address":"","comment_id":72465,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1551635146","product_id":100023901,"comment_content":"startåŸåˆ™å¯¹äºéä¸»çº¿ç¨‹çš„ä¸¤ä¸ªçº¿ç¨‹æœ‰æ•ˆä¹ˆï¼Œå¯¹åŒä¸€å…±äº«å˜é‡çš„èµ‹å€¼é¡ºåºè·Ÿçº¿ç¨‹å¯åŠ¨é¡ºåºæœ‰å…³ç³»ä¸","like_count":0,"discussions":[{"author":{"id":1269969,"avatar":"https://static001.geekbang.org/account/avatar/00/13/60/d1/8efa89ab.jpg","nickname":"ç‹å®ä»¤","note":"","ucode":"4FE19F5BC32FCA","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":441601,"discussion_content":"æœ‰æ•ˆã€‚å½“ç„¶æœ‰å…³ç³»ã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1551708827,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":72378,"user_name":"å“ˆå“ˆå“ˆ","can_delete":false,"product_type":"c1","uid":1248876,"ip_address":"","ucode":"C40ABE7161EFAE","user_header":"https://static001.geekbang.org/account/avatar/00/13/0e/6c/1f3b1372.jpg","comment_is_top":false,"comment_ctime":1551602814,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1551602814","product_id":100023901,"comment_content":"æ€è€ƒé¢˜ç­”æ¡ˆï¼Œvolatileæˆ–è€…final","like_count":0},{"had_liked":false,"id":72339,"user_name":"aksonic","can_delete":false,"product_type":"c1","uid":1003633,"ip_address":"","ucode":"B6F3348F6714DB","user_header":"https://static001.geekbang.org/account/avatar/00/0f/50/71/e8229703.jpg","comment_is_top":false,"comment_ctime":1551590980,"is_pvip":false,"replies":[{"id":"26207","content":"çš„ç¡®æ˜¯è¿™æ ·å•Šï¼Œå¤šè°¢æŒ‡æ­£ï¼Œå›å¤´æˆ‘è®©å°ç¼–æ”¹è¿‡æ¥ã€‚","user_name":"ä½œè€…å›å¤","user_name_real":"ç‹å®ä»¤","uid":"1269969","ctime":1551602400,"ip_address":"","comment_id":72339,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1551590980","product_id":100023901,"comment_content":"Thread B = new Thread(()-&gt;{<br>  &#47;&#47; ä¸»çº¿ç¨‹è°ƒç”¨ A.start() ä¹‹å‰<br>  &#47;&#47; æ‰€æœ‰å¯¹å…±äº«å˜é‡çš„ä¿®æ”¹ï¼Œæ­¤å¤„çš†å¯è§<br>  &#47;&#47; æ­¤ä¾‹ä¸­ï¼Œvar==77<br>});<br>&#47;&#47; æ­¤å¤„å¯¹å…±äº«å˜é‡ var ä¿®æ”¹<br>var = 77;<br>&#47;&#47; ä¸»çº¿ç¨‹å¯åŠ¨å­çº¿ç¨‹<br>B.start();<br><br>è€å¸ˆï¼Œâ€œä¸»çº¿ç¨‹è°ƒç”¨ A.start() ä¹‹å‰â€æ˜¯å¦å†™é”™äº†ï¼Œåº”è¯¥æ˜¯â€œä¸»çº¿ç¨‹è°ƒç”¨ B.start() ä¹‹å‰â€ï¼Œå› ä¸ºç¤ºä¾‹ä»£ç é‡Œé¢æ ¹æœ¬æ²¡æœ‰Aã€‚","like_count":0,"discussions":[{"author":{"id":1269969,"avatar":"https://static001.geekbang.org/account/avatar/00/13/60/d1/8efa89ab.jpg","nickname":"ç‹å®ä»¤","note":"","ucode":"4FE19F5BC32FCA","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":441549,"discussion_content":"çš„ç¡®æ˜¯è¿™æ ·å•Šï¼Œå¤šè°¢æŒ‡æ­£ï¼Œå›å¤´æˆ‘è®©å°ç¼–æ”¹è¿‡æ¥ã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1551602400,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":72168,"user_name":"Nevermore","can_delete":false,"product_type":"c1","uid":1228011,"ip_address":"","ucode":"06EBD2E6A9B436","user_header":"https://static001.geekbang.org/account/avatar/00/12/bc/eb/c22ef3a5.jpg","comment_is_top":false,"comment_ctime":1551530914,"is_pvip":false,"replies":[{"id":"26156","content":"è¿™ä¸ªæ•°å­¦é¢˜å°±äº¤ç»™ä½ è‡ªå·±éªŒç®—å§ï¼Œè¦ç»“åˆå…¶ä»–è§„åˆ™éªŒè¯ä¸¤ä¸ªå‘½é¢˜æ˜¯å¦ç­‰ä»·<br>","user_name":"ä½œè€…å›å¤","user_name_real":"ç‹å®ä»¤","uid":"1269969","ctime":1551544725,"ip_address":"","comment_id":72168,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1551530914","product_id":100023901,"comment_content":"è¿™æ¡è§„åˆ™æ˜¯æŒ‡å¯¹ä¸€ä¸ªé”çš„è§£é” Happens-Before äºåç»­å¯¹è¿™ä¸ªé”çš„åŠ é”ã€‚<br><br><br>è¯·æ•™è€å¸ˆï¼Œå¦‚æœè¿™ä¸ªæè¿°åè¿‡æ¥ï¼ŒåŠ é”happens-beforeè§£é”ï¼Œè¿™ä¹ˆæè¿°ä¼šæœ‰ä»€ä¹ˆé—®é¢˜ï¼Ÿ","like_count":0,"discussions":[{"author":{"id":1269969,"avatar":"https://static001.geekbang.org/account/avatar/00/13/60/d1/8efa89ab.jpg","nickname":"ç‹å®ä»¤","note":"","ucode":"4FE19F5BC32FCA","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":441489,"discussion_content":"è¿™ä¸ªæ•°å­¦é¢˜å°±äº¤ç»™ä½ è‡ªå·±éªŒç®—å§ï¼Œè¦ç»“åˆå…¶ä»–è§„åˆ™éªŒè¯ä¸¤ä¸ªå‘½é¢˜æ˜¯å¦ç­‰ä»·\n","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1551544725,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":72127,"user_name":"å°","can_delete":false,"product_type":"c1","uid":1014256,"ip_address":"","ucode":"B953F6B8BC5662","user_header":"","comment_is_top":false,"comment_ctime":1551526853,"is_pvip":true,"replies":[{"id":"26191","content":"æˆ‘ä¹Ÿé‚£ä¹ˆç—›è‹¦è¿‡","user_name":"ä½œè€…å›å¤","user_name_real":"ç‹å®ä»¤","uid":"1269969","ctime":1551584341,"ip_address":"","comment_id":72127,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1551526853","product_id":100023901,"comment_content":"æ—©ç‚¹çœ‹åˆ°è¿™æ ·çš„æ–‡ç« å°±ä¸ç”¨é‚£ä¹ˆç—›è‹¦äº†","like_count":0,"discussions":[{"author":{"id":1269969,"avatar":"https://static001.geekbang.org/account/avatar/00/13/60/d1/8efa89ab.jpg","nickname":"ç‹å®ä»¤","note":"","ucode":"4FE19F5BC32FCA","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":441472,"discussion_content":"æˆ‘ä¹Ÿé‚£ä¹ˆç—›è‹¦è¿‡","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1551584341,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":72107,"user_name":"æœ¨åˆ»","can_delete":false,"product_type":"c1","uid":1157430,"ip_address":"","ucode":"0A3226FEE3983B","user_header":"https://static001.geekbang.org/account/avatar/00/11/a9/36/972f7abf.jpg","comment_is_top":false,"comment_ctime":1551520953,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1551520953","product_id":100023901,"comment_content":"@ Nevermore ç†è§£äº†ä¸‹è¿™é‡Œå°±æ˜¯ç»“åˆäº†å‰ä¸‰æ¡è§„åˆ™ï¼Œæ¯ä¸€ä¸ªå‰é¢çš„æ“ä½œçš„ç»“æœå¯¹åç»­æ˜¯å¯è§çš„ï¼Œå› æ­¤Bçº¿ç¨‹åªè¦è¯»åˆ°äº†v=trueï¼Œé‚£ä¹ˆå¿…ç„¶å·²ç»çœ‹åˆ°äº†x=42","like_count":0},{"had_liked":false,"id":72098,"user_name":"MaO","can_delete":false,"product_type":"c1","uid":1083238,"ip_address":"","ucode":"3D839733E87435","user_header":"https://static001.geekbang.org/account/avatar/00/10/87/66/31629628.jpg","comment_is_top":false,"comment_ctime":1551519488,"is_pvip":false,"replies":[{"id":"26112","content":"åŒé‡æ£€æŸ¥åˆ›å»ºå•ä¾‹ï¼Œä¸åŠ volatileä¼šå‡ºé—®é¢˜ã€‚<br>happen before ä¸æ˜¯å‘ç”Ÿåœ¨ä¹‹å‰çš„æ„æ€ã€‚ è¿™ä¸ªå’Œçº¿ç¨‹è°ƒåº¦æ²¡å…³ç³»ã€‚æ“ä½œç³»ç»Ÿä¹æ„è°ƒåº¦è°å°±è°ƒåº¦è°ï¼ŒJVMç®—è€å‡ ï¼Ÿ","user_name":"ä½œè€…å›å¤","user_name_real":"ç‹å®ä»¤","uid":"1269969","ctime":1551524137,"ip_address":"","comment_id":72098,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1551519488","product_id":100023901,"comment_content":"æ„Ÿè§‰æœ€å…³é”®å¾—ä¸€ç‚¹æ²¡æœ‰è§£é‡Šå•Š<br><br>violatile å˜é‡å†™happen before è¯»ï¼Œåœ¨ä»€ä¹ˆæƒ…å†µä¸‹å‘ç”Ÿ?åº”è¯¥æ˜¯æŸç§å¹¶å‘åœºæ™¯ä½†æ˜¯æœ‰ç¡®å®æœ‰é¡ºåºçš„æ—¶å€™å§ï¼Œè¡¥å……ä¸‹å§ï¼Ÿ<br>å¦åˆ™ä¼šæ„Ÿè§‰æ˜¯äººä¸ºå¯¹çº¿ç¨‹çš„æ“æ§å¯¼è‡´çš„ã€‚<br>å¯èƒ½æ¶‰åŠåˆ°vmçº¿ç¨‹è°ƒåº¦ï¼Œå¸Œæœ›èƒ½è®²ä¸‹ä¸åŠ violatileä¼šå‡ºé—®é¢˜çš„åœºæ™¯","like_count":0,"discussions":[{"author":{"id":1269969,"avatar":"https://static001.geekbang.org/account/avatar/00/13/60/d1/8efa89ab.jpg","nickname":"ç‹å®ä»¤","note":"","ucode":"4FE19F5BC32FCA","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":441460,"discussion_content":"åŒé‡æ£€æŸ¥åˆ›å»ºå•ä¾‹ï¼Œä¸åŠ volatileä¼šå‡ºé—®é¢˜ã€‚\nhappen before ä¸æ˜¯å‘ç”Ÿåœ¨ä¹‹å‰çš„æ„æ€ã€‚ è¿™ä¸ªå’Œçº¿ç¨‹è°ƒåº¦æ²¡å…³ç³»ã€‚æ“ä½œç³»ç»Ÿä¹æ„è°ƒåº¦è°å°±è°ƒåº¦è°ï¼ŒJVMç®—è€å‡ ï¼Ÿ","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1551524137,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":72003,"user_name":"é•¿çœ‰_å¼ æ°¸","can_delete":false,"product_type":"c1","uid":1442279,"ip_address":"","ucode":"B3DCA68BDD473E","user_header":"https://static001.geekbang.org/account/avatar/00/16/01/e7/091804b7.jpg","comment_is_top":false,"comment_ctime":1551497457,"is_pvip":false,"replies":[{"id":"26099","content":"è¯è¯´ï¼Œç¬¬äºŒç§ï¼Œæˆ‘æ˜¯æ²¡çœ‹æ˜ç™½ï¼Œä½ è‡ªå·±æ˜ç™½å°±å¥½","user_name":"ä½œè€…å›å¤","user_name_real":"ç‹å®ä»¤","uid":"1269969","ctime":1551522036,"ip_address":"","comment_id":72003,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1551497457","product_id":100023901,"comment_content":"volatileå…³é”®å­—ï¼Œæ¯æ¬¡éƒ½è¯»å†™å…¥å†…å­˜ã€‚<br>å¦ä¸€ç§å°±æ˜¯happens -beforeåŸåˆ™ï¼Œè®©=3çš„æ“ä½œå…ˆæ‰§è¡Œ","like_count":0,"discussions":[{"author":{"id":1269969,"avatar":"https://static001.geekbang.org/account/avatar/00/13/60/d1/8efa89ab.jpg","nickname":"ç‹å®ä»¤","note":"","ucode":"4FE19F5BC32FCA","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":441423,"discussion_content":"è¯è¯´ï¼Œç¬¬äºŒç§ï¼Œæˆ‘æ˜¯æ²¡çœ‹æ˜ç™½ï¼Œä½ è‡ªå·±æ˜ç™½å°±å¥½","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1551522036,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":71969,"user_name":"Four","can_delete":false,"product_type":"c1","uid":1120854,"ip_address":"","ucode":"9BD8F103B4AFB5","user_header":"https://static001.geekbang.org/account/avatar/00/11/1a/56/2f1a8301.jpg","comment_is_top":false,"comment_ctime":1551493035,"is_pvip":false,"replies":[{"id":"26093","content":"å•ç‹¬é CASæ— é”ç®—æ³•ï¼Œåº”è¯¥æä¸å®šå¯è§æ€§ã€‚åŠ ä¸Švolatileå…³é”®å­—å°±å¯ä»¥äº†ã€‚","user_name":"ä½œè€…å›å¤","user_name_real":"ç‹å®ä»¤","uid":"1269969","ctime":1551521328,"ip_address":"","comment_id":71969,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1551493035","product_id":100023901,"comment_content":"1ã€å…±äº«å˜é‡abcä½¿ç”¨volatileå…³é”®å­—ä¿®é¥°ï¼Œvolatileå…³é”®å­—å¯ä»¥ä¿è¯å¯è§æ€§ã€‚(ä½†æ˜¯ä¸èƒ½ä¿è¯åŸå­æ€§)<br><br>2ã€ä½¿ç”¨é”ï¼Œsynchronizeã€ReentrantLock...åæ­£æœ‰&quot;äº’æ–¥&quot;è¯­æ„å°±è¡Œï¼Œé”èƒ½å¤Ÿä¿è¯æ“ä½œçš„åŸå­æ€§<br><br>3ã€ä½¿ç”¨CASæ— é”ç®—æ³•<br><br>4ã€Thread#join()","like_count":0,"discussions":[{"author":{"id":1269969,"avatar":"https://static001.geekbang.org/account/avatar/00/13/60/d1/8efa89ab.jpg","nickname":"ç‹å®ä»¤","note":"","ucode":"4FE19F5BC32FCA","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":441413,"discussion_content":"å•ç‹¬é CASæ— é”ç®—æ³•ï¼Œåº”è¯¥æä¸å®šå¯è§æ€§ã€‚åŠ ä¸Švolatileå…³é”®å­—å°±å¯ä»¥äº†ã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1551521328,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":71951,"user_name":"î„é£è½å†°é›ª","can_delete":false,"product_type":"c1","uid":1053101,"ip_address":"","ucode":"D7D38A2B09FBC3","user_header":"https://static001.geekbang.org/account/avatar/00/10/11/ad/a1c55d98.jpg","comment_is_top":false,"comment_ctime":1551491624,"is_pvip":false,"replies":[{"id":"26091","content":"æ²¡å†™çš„é‚£ä¿©è§„åˆ™ï¼Œå°±å‚è€ƒã€ŠJavaå¹¶å‘ç¼–ç¨‹å®æˆ˜ã€‹çš„ç¬¬16ç« å§","user_name":"ä½œè€…å›å¤","user_name_real":"ç‹å®ä»¤","uid":"1269969","ctime":1551520664,"ip_address":"","comment_id":71951,"utype":1}],"discussion_count":2,"race_medal":0,"score":"1551491624","product_id":100023901,"comment_content":"@senekis è¿˜æœ‰ä¸€ä¸ªstartè§„åˆ™ä½ æ²¡è¯´åˆ°","like_count":0,"discussions":[{"author":{"id":1269969,"avatar":"https://static001.geekbang.org/account/avatar/00/13/60/d1/8efa89ab.jpg","nickname":"ç‹å®ä»¤","note":"","ucode":"4FE19F5BC32FCA","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":441410,"discussion_content":"æ²¡å†™çš„é‚£ä¿©è§„åˆ™ï¼Œå°±å‚è€ƒã€ŠJavaå¹¶å‘ç¼–ç¨‹å®æˆ˜ã€‹çš„ç¬¬16ç« å§","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1551520664,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1105246,"avatar":"https://static001.geekbang.org/account/avatar/00/10/dd/5e/ddbdde5a.jpg","nickname":"é‚¢å®‡è¶…","note":"","ucode":"3113F55E60ADE9","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":1353,"discussion_content":"æˆ‘å’‹çœ‹åˆ°æ–‡ç« é‡Œæœ‰startè§„åˆ™å‘¢  è€å¸ˆä½ æ˜¯ä¸æ˜¯åˆè¡¥å……äº†","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1562572582,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":71920,"user_name":"ä½•æ–¹å¦–å­½","can_delete":false,"product_type":"c1","uid":1445608,"ip_address":"","ucode":"98B74EE791206B","user_header":"https://static001.geekbang.org/account/avatar/00/16/0e/e8/5d2c3e08.jpg","comment_is_top":false,"comment_ctime":1551486493,"is_pvip":false,"replies":[{"id":"26085","content":"Java8é‡Œçš„Lambdaè¡¨è¾¾å¼","user_name":"ä½œè€…å›å¤","user_name_real":"ç‹å®ä»¤","uid":"1269969","ctime":1551519924,"ip_address":"","comment_id":71920,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1551486493","product_id":100023901,"comment_content":"threadçš„æ„é€ å‡½æ•°é‡Œæ˜¯ä¸€ä¸ªç®­å¤´å‡½æ•°ï¼Œè¿™æ˜¯ä»€ä¹ˆè¯­æ³•ï¼Ÿ","like_count":0,"discussions":[{"author":{"id":1269969,"avatar":"https://static001.geekbang.org/account/avatar/00/13/60/d1/8efa89ab.jpg","nickname":"ç‹å®ä»¤","note":"","ucode":"4FE19F5BC32FCA","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":441394,"discussion_content":"Java8é‡Œçš„Lambdaè¡¨è¾¾å¼","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1551519924,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]}]}