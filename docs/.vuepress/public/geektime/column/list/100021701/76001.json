{"id":76001,"title":"10ä¸¨Pythonçˆ¬è™«ï¼šå¦‚ä½•è‡ªåŠ¨åŒ–ä¸‹è½½ç‹ç¥–è´¤æµ·æŠ¥ï¼Ÿ","content":"<p>ä¸Šä¸€è®²ä¸­æˆ‘ç»™ä½ è®²äº†å¦‚ä½•ä½¿ç”¨å…«çˆªé±¼é‡‡é›†æ•°æ®ï¼Œå¯¹äºæ•°æ®é‡‡é›†åˆšåˆšå…¥é—¨çš„äººæ¥è¯´ï¼Œåƒå…«çˆªé±¼è¿™ç§å¯è§†åŒ–çš„é‡‡é›†æ˜¯ä¸€ç§éå¸¸å¥½çš„æ–¹å¼ã€‚å®ƒæœ€å¤§çš„ä¼˜ç‚¹å°±æ˜¯ä¸Šæ‰‹é€Ÿåº¦å¿«ï¼Œå½“ç„¶ä¹Ÿå­˜åœ¨ä¸€äº›é—®é¢˜ï¼Œæ¯”å¦‚è¿è¡Œé€Ÿåº¦æ…¢ã€å¯æ§æ€§å·®ç­‰ã€‚</p><p>ç›¸æ¯”ä¹‹ä¸‹ï¼Œçˆ¬è™«å¯ä»¥å¾ˆå¥½åœ°é¿å…è¿™äº›é—®é¢˜ï¼Œä»Šå¤©æˆ‘æ¥åˆ†äº«ä¸‹å¦‚ä½•é€šè¿‡ç¼–å†™çˆ¬è™«æŠ“å–æ•°æ®ã€‚</p><h2>çˆ¬è™«çš„æµç¨‹</h2><p>ç›¸ä¿¡ä½ å¯¹â€œçˆ¬è™«â€è¿™ä¸ªè¯å·²ç»éå¸¸ç†Ÿæ‚‰äº†ï¼Œçˆ¬è™«å®é™…ä¸Šæ˜¯ç”¨æµè§ˆå™¨è®¿é—®çš„æ–¹å¼æ¨¡æ‹Ÿäº†è®¿é—®ç½‘ç«™çš„è¿‡ç¨‹ï¼Œæ•´ä¸ªè¿‡ç¨‹åŒ…æ‹¬ä¸‰ä¸ªé˜¶æ®µï¼šæ‰“å¼€ç½‘é¡µã€æå–æ•°æ®å’Œä¿å­˜æ•°æ®ã€‚</p><p>åœ¨Pythonä¸­ï¼Œè¿™ä¸‰ä¸ªé˜¶æ®µéƒ½æœ‰å¯¹åº”çš„å·¥å…·å¯ä»¥ä½¿ç”¨ã€‚</p><p>åœ¨â€œæ‰“å¼€ç½‘é¡µâ€è¿™ä¸€æ­¥éª¤ä¸­ï¼Œå¯ä»¥ä½¿ç”¨ Requests è®¿é—®é¡µé¢ï¼Œå¾—åˆ°æœåŠ¡å™¨è¿”å›ç»™æˆ‘ä»¬çš„æ•°æ®ï¼Œè¿™é‡ŒåŒ…æ‹¬HTMLé¡µé¢ä»¥åŠJSONæ•°æ®ã€‚</p><p>åœ¨â€œæå–æ•°æ®â€è¿™ä¸€æ­¥éª¤ä¸­ï¼Œä¸»è¦ç”¨åˆ°äº†ä¸¤ä¸ªå·¥å…·ã€‚é’ˆå¯¹HTMLé¡µé¢ï¼Œå¯ä»¥ä½¿ç”¨ XPath è¿›è¡Œå…ƒç´ å®šä½ï¼Œæå–æ•°æ®ï¼›é’ˆå¯¹JSONæ•°æ®ï¼Œå¯ä»¥ä½¿ç”¨JSONè¿›è¡Œè§£æã€‚</p><p>åœ¨æœ€åä¸€æ­¥â€œä¿å­˜æ•°æ®â€ä¸­ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨ Pandas ä¿å­˜æ•°æ®ï¼Œæœ€åå¯¼å‡ºCSVæ–‡ä»¶ã€‚</p><p>ä¸‹é¢æˆ‘æ¥åˆ†åˆ«ä»‹ç»ä¸‹è¿™äº›å·¥å…·çš„ä½¿ç”¨ã€‚</p><p><strong>Requestsè®¿é—®é¡µé¢</strong></p><p>Requestsæ˜¯Python HTTPçš„å®¢æˆ·ç«¯åº“ï¼Œç¼–å†™çˆ¬è™«çš„æ—¶å€™éƒ½ä¼šç”¨åˆ°ï¼Œç¼–å†™èµ·æ¥ä¹Ÿå¾ˆç®€å•ã€‚å®ƒæœ‰ä¸¤ç§è®¿é—®æ–¹å¼ï¼šGetå’ŒPostã€‚è¿™ä¸¤è€…æœ€ç›´è§‚çš„åŒºåˆ«å°±æ˜¯ï¼šGetæŠŠå‚æ•°åŒ…å«åœ¨urlä¸­ï¼Œè€ŒPosté€šè¿‡request bodyæ¥ä¼ é€’å‚æ•°ã€‚</p><!-- [[[read_end]]] --><p>å‡è®¾æˆ‘ä»¬æƒ³è®¿é—®è±†ç“£ï¼Œé‚£ä¹ˆç”¨Getè®¿é—®çš„è¯ï¼Œä»£ç å¯ä»¥å†™æˆä¸‹é¢è¿™æ ·çš„ï¼š</p><pre><code>r = requests.get('http://www.douban.com')\n</code></pre><p>ä»£ç é‡Œçš„â€œrâ€å°±æ˜¯Getè¯·æ±‚åçš„è®¿é—®ç»“æœï¼Œç„¶åæˆ‘ä»¬å¯ä»¥ä½¿ç”¨r.textæˆ–r.contentæ¥è·å–HTMLçš„æ­£æ–‡ã€‚</p><p>å¦‚æœæˆ‘ä»¬æƒ³è¦ä½¿ç”¨Postè¿›è¡Œè¡¨å•ä¼ é€’ï¼Œä»£ç å°±å¯ä»¥è¿™æ ·å†™ï¼š</p><pre><code>r = requests.post('http://xxx.com', data = {'key':'value'})\n</code></pre><p>è¿™é‡Œdataå°±æ˜¯ä¼ é€’çš„è¡¨å•å‚æ•°ï¼Œdataçš„æ•°æ®ç±»å‹æ˜¯ä¸ªå­—å…¸çš„ç»“æ„ï¼Œé‡‡ç”¨keyå’Œvalueçš„æ–¹å¼è¿›è¡Œå­˜å‚¨ã€‚</p><p><strong>XPathå®šä½</strong></p><p>XPathæ˜¯XMLçš„è·¯å¾„è¯­è¨€ï¼Œå®é™…ä¸Šæ˜¯é€šè¿‡å…ƒç´ å’Œå±æ€§è¿›è¡Œå¯¼èˆªï¼Œå¸®æˆ‘ä»¬å®šä½ä½ç½®ã€‚å®ƒæœ‰å‡ ç§å¸¸ç”¨çš„è·¯å¾„è¡¨è¾¾æ–¹å¼ã€‚</p><p><img src=\"https://static001.geekbang.org/resource/image/3b/ea/3bcb311361c76bfbeb90d360b21195ea.jpg?wh=518*690\" alt=\"\"></p><p>æˆ‘æ¥ç»™ä½ ç®€å•ä¸¾ä¸€äº›ä¾‹å­ï¼š</p><ol>\n<li>\n<p>xpath(â€˜nodeâ€™) é€‰å–äº†nodeèŠ‚ç‚¹çš„æ‰€æœ‰å­èŠ‚ç‚¹ï¼›</p>\n</li>\n<li>\n<p>xpath(â€™/divâ€™) ä»æ ¹èŠ‚ç‚¹ä¸Šé€‰å–divèŠ‚ç‚¹ï¼›</p>\n</li>\n<li>\n<p>xpath(â€™//divâ€™) é€‰å–æ‰€æœ‰çš„divèŠ‚ç‚¹ï¼›</p>\n</li>\n<li>\n<p>xpath(â€™./divâ€™) é€‰å–å½“å‰èŠ‚ç‚¹ä¸‹çš„divèŠ‚ç‚¹ï¼›</p>\n</li>\n<li>\n<p>xpath(â€™â€¦â€™) å›åˆ°ä¸Šä¸€ä¸ªèŠ‚ç‚¹ï¼›</p>\n</li>\n<li>\n<p>xpath(â€™//@idâ€™) é€‰å–æ‰€æœ‰çš„idå±æ€§ï¼›</p>\n</li>\n<li>\n<p>xpath(â€™//book[@id]â€™) é€‰å–æ‰€æœ‰æ‹¥æœ‰åä¸ºidçš„å±æ€§çš„bookå…ƒç´ ï¼›</p>\n</li>\n<li>\n<p>xpath(â€™//book[@id=â€œabcâ€]â€™) é€‰å–æ‰€æœ‰bookå…ƒç´ ï¼Œä¸”è¿™äº›bookå…ƒç´ æ‹¥æœ‰id= \"abc\"çš„å±æ€§ï¼›</p>\n</li>\n<li>\n<p>xpath(â€™//book/title | //book/priceâ€™) é€‰å–bookå…ƒç´ çš„æ‰€æœ‰titleå’Œpriceå…ƒç´ ã€‚</p>\n</li>\n</ol><p>ä¸Šé¢æˆ‘åªæ˜¯åˆ—ä¸¾äº†XPathçš„éƒ¨åˆ†åº”ç”¨ï¼ŒXPathçš„é€‰æ‹©åŠŸèƒ½éå¸¸å¼ºå¤§ï¼Œå®ƒå¯ä»¥æä¾›è¶…è¿‡100ä¸ªå†…å»ºå‡½æ•°ï¼Œæ¥åšåŒ¹é…ã€‚æˆ‘ä»¬æƒ³è¦å®šä½çš„èŠ‚ç‚¹ï¼Œå‡ ä¹éƒ½å¯ä»¥ä½¿ç”¨XPathæ¥é€‰æ‹©ã€‚</p><p>ä½¿ç”¨XPathå®šä½ï¼Œä½ ä¼šç”¨åˆ°Pythonçš„ä¸€ä¸ªè§£æåº“lxmlã€‚è¿™ä¸ªåº“çš„è§£ææ•ˆç‡éå¸¸é«˜ï¼Œä½¿ç”¨èµ·æ¥ä¹Ÿå¾ˆç®€ä¾¿ï¼Œåªéœ€è¦è°ƒç”¨HTMLè§£æå‘½ä»¤å³å¯ï¼Œç„¶åå†å¯¹HTMLè¿›è¡ŒXPathå‡½æ•°çš„è°ƒç”¨ã€‚</p><p>æ¯”å¦‚æˆ‘ä»¬æƒ³è¦å®šä½åˆ°HTMLä¸­çš„æ‰€æœ‰åˆ—è¡¨é¡¹ç›®ï¼Œå¯ä»¥é‡‡ç”¨ä¸‹é¢è¿™æ®µä»£ç ã€‚</p><pre><code>from lxml import etree\nhtml = etree.HTML(html)\nresult = html.xpath('//li')\n</code></pre><p><strong>JSONå¯¹è±¡</strong></p><p>JSONæ˜¯ä¸€ç§è½»é‡çº§çš„äº¤äº’æ–¹å¼ï¼Œåœ¨Pythonä¸­æœ‰JSONåº“ï¼Œå¯ä»¥è®©æˆ‘ä»¬å°†Pythonå¯¹è±¡å’ŒJSONå¯¹è±¡è¿›è¡Œè½¬æ¢ã€‚ä¸ºä»€ä¹ˆè¦è½¬æ¢å‘¢ï¼ŸåŸå› ä¹Ÿå¾ˆç®€å•ã€‚å°†JSONå¯¹è±¡è½¬æ¢æˆä¸ºPythonå¯¹è±¡ï¼Œæˆ‘ä»¬å¯¹æ•°æ®è¿›è¡Œè§£æå°±æ›´æ–¹ä¾¿äº†ã€‚</p><p><img src=\"https://static001.geekbang.org/resource/image/9a/43/9a6d6564a64cf2b1c256265eea78c543.png?wh=477*237\" alt=\"\"></p><p>è¿™æ˜¯ä¸€æ®µå°†JSONæ ¼å¼è½¬æ¢æˆPythonå¯¹è±¡çš„ä»£ç ï¼Œä½ å¯ä»¥è‡ªå·±è¿è¡Œä¸‹è¿™ä¸ªç¨‹åºçš„ç»“æœã€‚</p><pre><code>import json\njsonData = '{&quot;a&quot;:1,&quot;b&quot;:2,&quot;c&quot;:3,&quot;d&quot;:4,&quot;e&quot;:5}';\ninput = json.loads(jsonData)\nprint input\n</code></pre><p>æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬å°±è¦è¿›è¡Œå®æˆ˜äº†ï¼Œæˆ‘ä¼šä»ä¸¤ä¸ªè§’åº¦ç»™ä½ è®²è§£å¦‚ä½•ä½¿ç”¨Pythonçˆ¬å–æµ·æŠ¥ï¼Œä¸€ä¸ªæ˜¯é€šè¿‡JSONæ•°æ®çˆ¬å–ï¼Œä¸€ä¸ªæ˜¯é€šè¿‡XPathå®šä½çˆ¬å–ã€‚</p><h2>å¦‚ä½•ä½¿ç”¨JSONæ•°æ®è‡ªåŠ¨ä¸‹è½½ç‹ç¥–è´¤çš„æµ·æŠ¥</h2><p>æˆ‘åœ¨ä¸Šé¢è®²äº†Pythonçˆ¬è™«çš„åŸºæœ¬åŸç†å’Œå®ç°çš„å·¥å…·ï¼Œä¸‹é¢æˆ‘ä»¬æ¥å®æˆ˜ä¸€ä¸‹ã€‚å¦‚æœæƒ³è¦ä»è±†ç“£å›¾ç‰‡ä¸­ä¸‹è½½ç‹ç¥–è´¤çš„æµ·æŠ¥ï¼Œä½ åº”è¯¥å…ˆæŠŠæˆ‘ä»¬æ—¥å¸¸çš„æ“ä½œæ­¥éª¤æ•´ç†ä¸‹æ¥ï¼š</p><ol>\n<li>\n<p>æ‰“å¼€ç½‘é¡µï¼›</p>\n</li>\n<li>\n<p>è¾“å…¥å…³é”®è¯â€œç‹ç¥–è´¤â€ï¼›</p>\n</li>\n<li>\n<p>åœ¨æœç´¢ç»“æœé¡µä¸­é€‰æ‹©â€œå›¾ç‰‡â€ï¼›</p>\n</li>\n<li>\n<p>ä¸‹è½½å›¾ç‰‡é¡µä¸­çš„æ‰€æœ‰æµ·æŠ¥ã€‚</p>\n</li>\n</ol><p>è¿™é‡Œä½ éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œå¦‚æœçˆ¬å–çš„é¡µé¢æ˜¯åŠ¨æ€é¡µé¢ï¼Œå°±éœ€è¦å…³æ³¨XHRæ•°æ®ã€‚å› ä¸ºåŠ¨æ€é¡µé¢çš„åŸç†å°±æ˜¯é€šè¿‡åŸç”Ÿçš„XHRæ•°æ®å¯¹è±¡å‘å‡ºHTTPè¯·æ±‚ï¼Œå¾—åˆ°æœåŠ¡å™¨è¿”å›çš„æ•°æ®åï¼Œå†è¿›è¡Œå¤„ç†ã€‚XHRä¼šç”¨äºåœ¨åå°ä¸æœåŠ¡å™¨äº¤æ¢æ•°æ®ã€‚</p><p>ä½ éœ€è¦ä½¿ç”¨æµè§ˆå™¨çš„æ’ä»¶æŸ¥çœ‹XHRæ•°æ®ï¼Œæ¯”å¦‚åœ¨Chromeæµè§ˆå™¨ä¸­ä½¿ç”¨å¼€å‘è€…å·¥å…·ã€‚</p><p>åœ¨è±†ç“£æœç´¢ä¸­ï¼Œæˆ‘ä»¬å¯¹â€œç‹ç¥–è´¤â€è¿›è¡Œäº†æ¨¡æ‹Ÿï¼Œå‘ç°XHRæ•°æ®ä¸­æœ‰ä¸€ä¸ªè¯·æ±‚æ˜¯è¿™æ ·çš„ï¼š</p><p><a href=\"https://www.douban.com/j/search_photo?q=%E7%8E%8B%E7%A5%96%E8%B4%A4&amp;limit=20&amp;start=0\">https://www.douban.com/j/search_photo?q=%E7%8E%8B%E7%A5%96%E8%B4%A4&amp;limit=20&amp;start=0</a></p><p>urlä¸­çš„ä¹±ç æ­£æ˜¯ä¸­æ–‡çš„urlç¼–ç ï¼Œæ‰“å¼€åï¼Œæˆ‘ä»¬çœ‹åˆ°äº†å¾ˆæ¸…çˆ½çš„JSONæ ¼å¼å¯¹è±¡ï¼Œå±•ç¤ºçš„å½¢å¼æ˜¯è¿™æ ·çš„ï¼š</p><pre><code>{&quot;images&quot;:\n       [{&quot;src&quot;: â€¦, &quot;author&quot;: â€¦, &quot;url&quot;:â€¦, &quot;id&quot;: â€¦, &quot;title&quot;: â€¦, &quot;width&quot;:â€¦, &quot;height&quot;:â€¦},\n    â€¦\n\t {&quot;src&quot;: â€¦, &quot;author&quot;: â€¦, &quot;url&quot;:â€¦, &quot;id&quot;: â€¦, &quot;title&quot;: â€¦, &quot;width&quot;:â€¦, &quot;height&quot;:â€¦}],\n &quot;total&quot;:22471,&quot;limit&quot;:20,&quot;more&quot;:true}\n</code></pre><p>ä»è¿™ä¸ªJSONå¯¹è±¡ä¸­ï¼Œæˆ‘ä»¬èƒ½çœ‹åˆ°ï¼Œç‹ç¥–è´¤çš„å›¾ç‰‡ä¸€å…±æœ‰22471å¼ ï¼Œå…¶ä¸­ä¸€æ¬¡åªè¿”å›äº†20å¼ ï¼Œè¿˜æœ‰æ›´å¤šçš„æ•°æ®å¯ä»¥è¯·æ±‚ã€‚æ•°æ®è¢«æ”¾åˆ°äº†imageså¯¹è±¡é‡Œï¼Œå®ƒæ˜¯ä¸ªæ•°ç»„çš„ç»“æ„ï¼Œæ¯ä¸ªæ•°ç»„çš„å…ƒç´ æ˜¯ä¸ªå­—å…¸çš„ç±»å‹ï¼Œåˆ†åˆ«å‘Šè¯‰äº†srcã€authorã€urlã€idã€titleã€widthå’Œheightå­—æ®µï¼Œè¿™äº›å­—æ®µä»£è¡¨çš„å«ä¹‰åˆ†åˆ«æ˜¯åŸå›¾ç‰‡çš„åœ°å€ã€ä½œè€…ã€å‘å¸ƒåœ°å€ã€å›¾ç‰‡IDã€æ ‡é¢˜ã€å›¾ç‰‡å®½åº¦ã€å›¾ç‰‡é«˜åº¦ç­‰ä¿¡æ¯ã€‚</p><p>æœ‰äº†è¿™ä¸ªJSONä¿¡æ¯ï¼Œä½ å¾ˆå®¹æ˜“å°±å¯ä»¥æŠŠå›¾ç‰‡ä¸‹è½½ä¸‹æ¥ã€‚å½“ç„¶ä½ è¿˜éœ€è¦å¯»æ‰¾XHRè¯·æ±‚çš„urlè§„å¾‹ã€‚</p><p>å¦‚ä½•æŸ¥çœ‹å‘¢ï¼Œæˆ‘ä»¬å†æ¥é‡æ–°çœ‹ä¸‹è¿™ä¸ªç½‘å€æœ¬èº«ã€‚</p><p><a href=\"https://www.douban.com/j/search_photo?q=%E7%8E%8B%E7%A5%96%E8%B4%A4&amp;limit=20&amp;start=0\">https://www.douban.com/j/search_photo?q=ç‹ç¥–è´¤&amp;limit=20&amp;start=0</a></p><p>ä½ ä¼šå‘ç°ï¼Œç½‘å€ä¸­æœ‰ä¸‰ä¸ªå‚æ•°ï¼šqã€limitå’Œstartã€‚startå®é™…ä¸Šæ˜¯è¯·æ±‚çš„èµ·å§‹IDï¼Œè¿™é‡Œæˆ‘ä»¬æ³¨æ„åˆ°å®ƒå¯¹å›¾ç‰‡çš„é¡ºåºæ ‡è¯†æ˜¯ä»0å¼€å§‹è®¡ç®—çš„ã€‚æ‰€ä»¥å¦‚æœä½ æƒ³è¦ä»ç¬¬21ä¸ªå›¾ç‰‡è¿›è¡Œä¸‹è½½ï¼Œä½ å¯ä»¥å°†startè®¾ç½®ä¸º20ã€‚</p><p>ç‹ç¥–è´¤çš„å›¾ç‰‡ä¸€å…±æœ‰22471å¼ ï¼Œä½ å¯ä»¥å†™ä¸ªforå¾ªç¯æ¥è·‘å®Œæ‰€æœ‰çš„è¯·æ±‚ï¼Œå…·ä½“çš„ä»£ç å¦‚ä¸‹ï¼š</p><pre><code># coding:utf-8\nimport requests\nimport json\nquery = 'ç‹ç¥–è´¤'\n''' ä¸‹è½½å›¾ç‰‡ '''\ndef download(src, id):\n\tdir = './' + str(id) + '.jpg'\n\ttry:\n\t\tpic = requests.get(src, timeout=10)\n\t\tfp = open(dir, 'wb')\n\t\tfp.write(pic.content)\n\t\tfp.close()\n\texcept requests.exceptions.ConnectionError:\n\t\tprint('å›¾ç‰‡æ— æ³•ä¸‹è½½')\n            \n''' for å¾ªç¯ è¯·æ±‚å…¨éƒ¨çš„ url '''\nfor i in range(0, 22471, 20):\n\turl = 'https://www.douban.com/j/search_photo?q='+query+'&amp;limit=20&amp;start='+str(i)\n\thtml = requests.get(url).text    # å¾—åˆ°è¿”å›ç»“æœ\n\tresponse = json.loads(html,encoding='utf-8') # å°† JSON æ ¼å¼è½¬æ¢æˆ Python å¯¹è±¡\n\tfor image in response['images']:\n\t\tprint(image['src']) # æŸ¥çœ‹å½“å‰ä¸‹è½½çš„å›¾ç‰‡ç½‘å€\n\t\tdownload(image['src'], image['id']) # ä¸‹è½½ä¸€å¼ å›¾ç‰‡\n</code></pre><h2>å¦‚ä½•ä½¿ç”¨XPathè‡ªåŠ¨ä¸‹è½½ç‹ç¥–è´¤çš„ç”µå½±æµ·æŠ¥å°é¢</h2><p>å¦‚æœä½ é‡åˆ°JSONçš„æ•°æ®æ ¼å¼ï¼Œé‚£ä¹ˆæ­å–œä½ ï¼Œæ•°æ®ç»“æ„å¾ˆæ¸…çˆ½ï¼Œé€šè¿‡Pythonçš„JSONåº“å°±å¯ä»¥è§£æã€‚</p><p>ä½†æœ‰æ—¶å€™ï¼Œç½‘é¡µä¼šç”¨JSè¯·æ±‚æ•°æ®ï¼Œé‚£ä¹ˆåªæœ‰JSéƒ½åŠ è½½å®Œä¹‹åï¼Œæˆ‘ä»¬æ‰èƒ½è·å–å®Œæ•´çš„HTMLæ–‡ä»¶ã€‚XPathå¯ä»¥ä¸å—åŠ è½½çš„é™åˆ¶ï¼Œå¸®æˆ‘ä»¬å®šä½æƒ³è¦çš„å…ƒç´ ã€‚</p><p>æ¯”å¦‚ï¼Œæˆ‘ä»¬æƒ³è¦ä»è±†ç“£ç”µå½±ä¸Šä¸‹è½½ç‹ç¥–è´¤çš„ç”µå½±å°é¢ï¼Œéœ€è¦å…ˆæ¢³ç†ä¸‹äººå·¥çš„æ“ä½œæµç¨‹ï¼š</p><ol>\n<li>\n<p><a href=\"http://xn--movie-hr2j95qrv1e8j7b.douban.com\">æ‰“å¼€ç½‘é¡µmovie.douban.com</a>ï¼›</p>\n</li>\n<li>\n<p>è¾“å…¥å…³é”®è¯â€œç‹ç¥–è´¤â€ï¼›</p>\n</li>\n<li>\n<p>ä¸‹è½½å›¾ç‰‡é¡µä¸­çš„æ‰€æœ‰ç”µå½±å°é¢ã€‚</p>\n</li>\n</ol><p>è¿™é‡Œä½ éœ€è¦ç”¨XPathå®šä½å›¾ç‰‡çš„ç½‘å€ï¼Œä»¥åŠç”µå½±çš„åç§°ã€‚</p><p>ä¸€ä¸ªå¿«é€Ÿå®šä½XPathçš„æ–¹æ³•å°±æ˜¯é‡‡ç”¨æµè§ˆå™¨çš„XPath Helperæ’ä»¶ï¼Œä½¿ç”¨Ctrl+Shift+Xå¿«æ·é”®çš„æ—¶å€™ï¼Œç”¨é¼ æ ‡é€‰ä¸­ä½ æƒ³è¦å®šä½çš„å…ƒç´ ï¼Œå°±ä¼šå¾—åˆ°ç±»ä¼¼ä¸‹é¢çš„ç»“æœã€‚</p><p><img src=\"https://static001.geekbang.org/resource/image/0e/c7/0e0fef601ee043f4bea8dd2874e788c7.png?wh=865*111\" alt=\"\"></p><p>XPath Helperæ’ä»¶ä¸­æœ‰ä¸¤ä¸ªå‚æ•°ï¼Œä¸€ä¸ªæ˜¯Queryï¼Œå¦ä¸€ä¸ªæ˜¯Resultsã€‚Queryå…¶å®å°±æ˜¯è®©ä½ æ¥è¾“å…¥XPathè¯­æ³•ï¼Œç„¶ååœ¨Resultsé‡Œçœ‹åˆ°åŒ¹é…çš„å…ƒç´ çš„ç»“æœã€‚</p><p>æˆ‘ä»¬çœ‹åˆ°ï¼Œè¿™é‡Œé€‰ä¸­çš„æ˜¯ä¸€ä¸ªå…ƒç´ ï¼Œæˆ‘ä»¬è¦åŒ¹é…ä¸Šæ‰€æœ‰çš„ç”µå½±æµ·æŠ¥ï¼Œå°±éœ€è¦ç¼©å‡XPathè¡¨è¾¾å¼ã€‚ä½ å¯ä»¥åœ¨Queryä¸­è¿›è¡ŒXPathè¡¨è¾¾å¼çš„ç¼©å‡ï¼Œå°è¯•å»æ‰XPathè¡¨è¾¾å¼ä¸­çš„ä¸€äº›å†…å®¹ï¼Œåœ¨Resultsä¸­ä¼šè‡ªåŠ¨å‡ºç°åŒ¹é…çš„ç»“æœã€‚</p><p>ç»è¿‡ç¼©å‡ä¹‹åï¼Œä½ å¯ä»¥å¾—åˆ°ç”µå½±æµ·æŠ¥çš„XPathï¼ˆå‡è®¾ä¸ºå˜é‡src_xpathï¼‰ï¼š</p><pre><code>//div[@class='item-root']/a[@class='cover-link']/img[@class='cover']/@src\n</code></pre><p>ä»¥åŠç”µå½±åç§°çš„XPathï¼ˆå‡è®¾ä¸ºå˜é‡title_xpathï¼‰ï¼š</p><pre><code>//div[@class='item-root']/div[@class='detail']/div[@class='title']/a[@class='title-text']\n</code></pre><p>ä½†æœ‰æ—¶å€™å½“æˆ‘ä»¬ç›´æ¥ç”¨Requestsè·å–HTMLçš„æ—¶å€™ï¼Œå‘ç°æƒ³è¦çš„XPathå¹¶ä¸å­˜åœ¨ã€‚è¿™æ˜¯å› ä¸ºHTMLè¿˜æ²¡æœ‰åŠ è½½å®Œï¼Œå› æ­¤ä½ éœ€è¦ä¸€ä¸ªå·¥å…·ï¼Œæ¥è¿›è¡Œç½‘é¡µåŠ è½½çš„æ¨¡æ‹Ÿï¼Œç›´åˆ°å®ŒæˆåŠ è½½åå†ç»™ä½ å®Œæ•´çš„HTMLã€‚</p><p>åœ¨Pythonä¸­ï¼Œè¿™ä¸ªå·¥å…·å°±æ˜¯Seleniumåº“ï¼Œä½¿ç”¨æ–¹æ³•å¦‚ä¸‹ï¼š</p><pre><code>from selenium import webdriver\ndriver = webdriver.Chrome()\ndriver.get(request_url)\n</code></pre><p>Seleniumæ˜¯Webåº”ç”¨çš„æµ‹è¯•å·¥å…·ï¼Œå¯ä»¥ç›´æ¥è¿è¡Œåœ¨æµè§ˆå™¨ä¸­ï¼Œå®ƒçš„åŸç†æ˜¯æ¨¡æ‹Ÿç”¨æˆ·åœ¨è¿›è¡Œæ“ä½œï¼Œæ”¯æŒå½“å‰å¤šç§ä¸»æµçš„æµè§ˆå™¨ã€‚</p><p>è¿™é‡Œæˆ‘ä»¬æ¨¡æ‹ŸChromeæµè§ˆå™¨çš„é¡µé¢è®¿é—®ã€‚</p><p>ä½ éœ€è¦å…ˆå¼•ç”¨Seleniumä¸­çš„WebDriveråº“ã€‚WebDriverå®é™…ä¸Šå°±æ˜¯Selenium 2ï¼Œæ˜¯ä¸€ç§ç”¨äºWebåº”ç”¨ç¨‹åºçš„è‡ªåŠ¨æµ‹è¯•å·¥å…·ï¼Œæä¾›äº†ä¸€å¥—å‹å¥½çš„APIï¼Œæ–¹ä¾¿æˆ‘ä»¬è¿›è¡Œæ“ä½œã€‚</p><p>ç„¶åé€šè¿‡WebDriveråˆ›å»ºä¸€ä¸ªChromeæµè§ˆå™¨çš„driveï¼Œå†é€šè¿‡driveè·å–è®¿é—®é¡µé¢çš„å®Œæ•´HTMLã€‚</p><p>å½“ä½ è·å–åˆ°å®Œæ•´çš„HTMLæ—¶ï¼Œå°±å¯ä»¥å¯¹HTMLä¸­çš„XPathè¿›è¡Œæå–ï¼Œåœ¨è¿™é‡Œæˆ‘ä»¬éœ€è¦æ‰¾åˆ°å›¾ç‰‡åœ°å€srcså’Œç”µå½±åç§°titlesã€‚è¿™é‡Œé€šè¿‡XPathè¯­æ³•åŒ¹é…åˆ°äº†å¤šä¸ªå…ƒç´ ï¼Œå› ä¸ºæ˜¯å¤šä¸ªå…ƒç´ ï¼Œæ‰€ä»¥æˆ‘ä»¬éœ€è¦ç”¨forå¾ªç¯æ¥å¯¹æ¯ä¸ªå…ƒç´ è¿›è¡Œæå–ã€‚</p><pre><code>srcs = html.xpath(src_xpath)\ntitles = html.xpath(title_path)\nfor src, title in zip(srcs, titles):\n\tdownload(src, title.text)\n</code></pre><p>ç„¶åä½¿ç”¨ä¸Šé¢æˆ‘ç¼–å†™å¥½çš„downloadå‡½æ•°è¿›è¡Œå›¾ç‰‡ä¸‹è½½ã€‚</p><h2>æ€»ç»“</h2><p>å¥½äº†ï¼Œè¿™æ ·å°±å¤§åŠŸå‘Šæˆäº†ï¼Œç¨‹åºå¯ä»¥æºæºä¸æ–­åœ°é‡‡é›†ä½ æƒ³è¦çš„å†…å®¹ã€‚è¿™èŠ‚è¯¾ï¼Œæˆ‘æƒ³è®©ä½ æŒæ¡çš„æ˜¯ï¼š</p><ol>\n<li>\n<p>Pythonçˆ¬è™«çš„æµç¨‹ï¼›</p>\n</li>\n<li>\n<p>äº†è§£XPathå®šä½ï¼ŒJSONå¯¹è±¡è§£æï¼›</p>\n</li>\n<li>\n<p>å¦‚ä½•ä½¿ç”¨lxmlåº“ï¼Œè¿›è¡ŒXPathçš„æå–ï¼›</p>\n</li>\n<li>\n<p>å¦‚ä½•åœ¨Pythonä¸­ä½¿ç”¨Seleniumåº“æ¥å¸®åŠ©ä½ æ¨¡æ‹Ÿæµè§ˆå™¨ï¼Œè·å–å®Œæ•´çš„HTMLã€‚</p>\n</li>\n</ol><p>å…¶ä¸­ï¼ŒPython + Selenium + ç¬¬ä¸‰æ–¹æµè§ˆå™¨å¯ä»¥è®©æˆ‘ä»¬å¤„ç†å¤šç§å¤æ‚åœºæ™¯ï¼ŒåŒ…æ‹¬ç½‘é¡µåŠ¨æ€åŠ è½½ã€JSå“åº”ã€Postè¡¨å•ç­‰ã€‚å› ä¸ºSeleniumæ¨¡æ‹Ÿçš„å°±æ˜¯ä¸€ä¸ªçœŸå®çš„ç”¨æˆ·çš„æ“ä½œè¡Œä¸ºï¼Œå°±ä¸ç”¨æ‹…å¿ƒcookieè¿½è¸ªå’Œéšè—å­—æ®µçš„å¹²æ‰°äº†ã€‚</p><p>å½“ç„¶ï¼ŒPythonè¿˜ç»™æˆ‘ä»¬æä¾›äº†æ•°æ®å¤„ç†å·¥å…·ï¼Œæ¯”å¦‚lxmlåº“å’ŒJSONåº“ï¼Œè¿™æ ·å°±å¯ä»¥æå–æƒ³è¦çš„å†…å®¹äº†ã€‚</p><p><img src=\"https://static001.geekbang.org/resource/image/eb/ab/eb3e48f714ca857a79948d831de521ab.jpg?wh=3200*1800\" alt=\"\"></p><p>æœ€åï¼Œä½ ä¸å¦¨æ¥å®è·µä¸€ä¸‹ï¼Œä½ æœ€å–œæ¬¢å“ªä¸ªæ˜æ˜Ÿï¼Ÿå¦‚æœæƒ³è¦è‡ªåŠ¨ä¸‹è½½è¿™ä¸ªæ˜æ˜Ÿçš„å›¾ç‰‡ï¼Œè¯¥å¦‚ä½•æ“ä½œå‘¢ï¼Ÿæ¬¢è¿å’Œæˆ‘åœ¨è¯„è®ºåŒºè¿›è¡Œæ¢è®¨ã€‚</p><p>ä½ ä¹Ÿå¯ä»¥æŠŠè¿™ç¯‡æ–‡ç« åˆ†äº«ç»™ä½ çš„æœ‹å‹æˆ–è€…åŒäº‹ï¼Œä¸€èµ·åŠ¨æ‰‹ç»ƒä¹ ä¸€ä¸‹ã€‚</p><p></p>","neighbors":{"left":{"article_title":"09ä¸¨æ•°æ®é‡‡é›†ï¼šå¦‚ä½•ç”¨å…«çˆªé±¼é‡‡é›†å¾®åšä¸Šçš„â€œD&Gâ€è¯„è®º","id":75780},"right":{"article_title":"11 | æ•°æ®ç§‘å­¦å®¶80%æ—¶é—´éƒ½èŠ±è´¹åœ¨äº†è¿™äº›æ¸…æ´—ä»»åŠ¡ä¸Šï¼Ÿ","id":76307}},"comments":[{"had_liked":false,"id":84644,"user_name":"æ»¢","can_delete":false,"product_type":"c1","uid":1221511,"ip_address":"","ucode":"971A6F20AF3F9A","user_header":"https://static001.geekbang.org/account/avatar/00/12/a3/87/c415e370.jpg","comment_is_top":false,"comment_ctime":1554889158,"is_pvip":false,"replies":[{"id":"64282","content":"æ»¢åŒå­¦æ€»ç»“æ•´ç†çš„å¾ˆä¸é”™ï¼Œå¤§å®¶éƒ½å¯ä»¥çœ‹ä¸‹","user_name":"ä½œè€…å›å¤","comment_id":84644,"uid":"1306094","ip_address":"","utype":1,"ctime":1577616021,"user_name_real":"cy"}],"discussion_count":2,"race_medal":0,"score":"250662992326","product_id":100021701,"comment_content":"è¯´æ˜ä¸¤ç‚¹é—®é¢˜ï¼š<br>ï¼ˆä¸€ï¼‰.ç•™è¨€é‡Œæœ‰äººè¯„è®ºè¯´ç”¨XPathä¸‹è½½çš„å›¾ç‰‡æ‰“ä¸å¼€ï¼Œå…¶åŸå› æ˜¯å®šä¹‰çš„ä¸‹è½½å‡½æ•°ä¿å­˜è·¯å¾„åç¼€åä¸º&#39;.jpg&#39;ï¼Œä½†æ˜¯ç”¨XPathä¸‹è½½è·å¾—çš„å›¾ç‰‡urlä¸º&#39;https:&#47;&#47;img3.doubanio.com&#47;view&#47;celebrity&#47;s_ratio_celebrity&#47;public&#47;p616.webp&#39;ï¼Œæœ¬èº«å›¾ç‰‡ä¸ºwebpæ ¼å¼ï¼Œæ‰€ä»¥è‹¥ä¿å­˜ä¸ºjpgæ ¼å¼ï¼Œè‚¯å®šæ˜¯æ‰“ä¸å¼€çš„ã€‚<br>(äºŒ).  è€å¸ˆåœ¨æ–‡ç« å†…è®²çš„ç”¨XPathä¸‹è½½ä»£ç åªèƒ½ä¸‹è½½ç¬¬ä¸€é¡µçš„å†…å®¹ï¼Œå¹¶ä¸æ˜¯å…¨éƒ¨çš„æ•°æ®ï¼Œä¸çŸ¥é“å¤§å®¶æœ‰æ²¡æœ‰æŸ¥çœ‹ç”¨xpathå‡½æ•°è·å¾—çš„æ•°ç»„ï¼Œå¤§å®¶ç•™è¨€é‡Œçš„ä»£ç ä¼¼ä¹å’Œè€å¸ˆçš„ä¸€æ ·ï¼Œåªèƒ½å¾—åˆ°é¦–é¡µçš„å†…å®¹ï¼Œæ‰€ä»¥ä¹Ÿæ˜¯éœ€è¦æ¨¡æ‹Ÿç¿»é¡µæ“ä½œæ‰èƒ½è·å¾—å®Œæ•´çš„æ•°æ®ã€‚<br><br>ä»¥ä¸‹æ˜¯è¯¾åç»ƒä¹ é¢˜ï¼šçˆ¬å–å®«å´éªçš„ç”µå½±æµ·æŠ¥ï¼Œ Python3.6 IDLE<br>&gt;&gt;&gt; import json<br>&gt;&gt;&gt; import requests as req<br>&gt;&gt;&gt; from lxml import etree<br>&gt;&gt;&gt; from selenium import webdriver<br>&gt;&gt;&gt; import os<br>&gt;&gt;&gt; request_url = &#39;https:&#47;&#47;movie.douban.com&#47;subject_search?search_text=å®«å´éª&amp;cat=1002&#39;<br>&gt;&gt;&gt; src_xpath = &quot;&#47;&#47;div[@class=&#39;item-root&#39;]&#47;a[@class=&#39;cover-link&#39;]&#47;img[@class=&#39;cover&#39;]&#47;@src&quot;<br>&gt;&gt;&gt; title_xpath = &quot;&#47;&#47;div[@class=&#39;item-root&#39;]&#47;div[@class=&#39;detail&#39;]&#47;div[@class=&#39;title&#39;]&#47;a[@class=&#39;title-text&#39;]&quot;<br>&gt;&gt;&gt; driver = webdriver.Chrome(&#39;&#47;Users&#47;apple&#47;Downloads&#47;chromedriver&#39;)<br>&gt;&gt;&gt; driver.get(request_url)<br>&gt;&gt;&gt; html = etree.HTML(driver.page_source)<br>&gt;&gt;&gt; srcs = html.xpath(src_xpath)<br>&gt;&gt;&gt; print (srcs)  #å¤§å®¶å¯è¦çœ‹ä¸‹æ‰“å°å‡ºæ¥çš„æ•°æ®æ˜¯å¦åªæ˜¯ä¸€é¡µçš„å†…å®¹ï¼Œä»¥åŠå›¾ç‰‡urlçš„åç¼€æ ¼å¼<br>&gt;&gt;&gt; picpath = &#39;&#47;Users&#47;apple&#47;Downloads&#47;å®«å´éªç”µå½±æµ·æŠ¥&#39;<br>&gt;&gt;&gt; if not os.path.isdir(picpath):<br>\tos.mkdir(picpath)<br>&gt;&gt;&gt; def download(src, id):<br>\tdic = picpath + &#39;&#47;&#39; + str(id) + &#39;.webp&#39;<br>\ttry:<br>\t\tpic = req.get(src, timeout = 30)<br>\t\tfp = open(dic, &#39;wb&#39;)<br>\t\tfp.write(pic.content)<br>\t\tfp.close()<br>\texcept req.exceptions.ConnectionError:<br>\t\tprint (&#39;å›¾ç‰‡æ— æ³•ä¸‹è½½&#39;)<br>&gt;&gt;&gt; for i in range(0, 150, 15):<br>\turl = request_url + &#39;&amp;start=&#39; + str(i)<br>\tdriver.get(url)<br>\thtml = etree.HTML(driver.page_source)<br>\tsrcs = html.xpath(src_xpath)<br>\ttitles = html.xpath(title_xpath)<br>\tfor src,title in zip(srcs, titles):<br>\t\tdownload(src, title.text)<br>","like_count":59,"discussions":[{"author":{"id":1306094,"avatar":"https://static001.geekbang.org/account/avatar/00/13/ed/ee/c4779b67.jpg","nickname":"cy","note":"","ucode":"50D653399A31F6","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":446413,"discussion_content":"æ»¢åŒå­¦æ€»ç»“æ•´ç†çš„å¾ˆä¸é”™ï¼Œå¤§å®¶éƒ½å¯ä»¥çœ‹ä¸‹","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1577616021,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":2302438,"avatar":"https://static001.geekbang.org/account/avatar/00/23/21/e6/483fbd49.jpg","nickname":"superchaner","note":"","ucode":"1F1977EF5D9EA0","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":389562,"discussion_content":"è±†ç“£ç°åœ¨éœ€è¦ç™»å½•æ“ä½œäº†ï¼Œï¼Œ","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1629339655,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":56962,"user_name":"rOMEoç½—å¯†æ¬§","can_delete":false,"product_type":"c1","uid":1074365,"ip_address":"","ucode":"9C7BF6E1274D26","user_header":"https://static001.geekbang.org/account/avatar/00/10/64/bd/cbcdc4a6.jpg","comment_is_top":false,"comment_ctime":1546587620,"is_pvip":false,"replies":[{"id":"21405","content":"ä½ å¯ä»¥ä½¿ç”¨python+seleniumçš„æ–¹å¼å®Œæˆè´¦æˆ·çš„è‡ªåŠ¨ç™»å½•ï¼Œå› ä¸ºseleniumæ˜¯ä¸ªè‡ªåŠ¨åŒ–æµ‹è¯•çš„æ¡†æ¶ï¼Œä½¿ç”¨selenium çš„webdriverå°±å¯ä»¥æ¨¡æ‹Ÿæµè§ˆå™¨çš„è¡Œä¸ºã€‚æ‰¾åˆ°è¾“å…¥ç”¨æˆ·åå¯†ç çš„åœ°æ–¹ï¼Œè¾“å…¥ç›¸åº”çš„å€¼ï¼Œç„¶åæ¨¡æ‹Ÿç‚¹å‡»å³å¯å®Œæˆç™»å½•ï¼ˆæ²¡æœ‰éªŒè¯ç çš„æƒ…å†µä¸‹ï¼‰<br>å¦å¤–ä½ ä¹Ÿå¯ä»¥ä½¿ç”¨cookieæ¥ç™»å½•ç½‘ç«™ï¼Œæ–¹æ³•æ˜¯ä½ ç™»å½•ç½‘ç«™æ—¶ï¼Œå…ˆä¿å­˜ç½‘ç«™çš„cookieï¼Œç„¶åç”¨ä¸‹æ¬¡è®¿é—®çš„æ—¶å€™ï¼ŒåŠ è½½ä¹‹å‰ä¿å­˜çš„cookieï¼Œæ”¾åˆ°request headersä¸­ï¼Œè¿™æ ·å°±ä¸éœ€è¦å†ç™»å½•ç½‘ç«™äº†<br>","user_name":"ä½œè€…å›å¤","comment_id":56962,"uid":"1306094","ip_address":"","utype":1,"ctime":1547364811,"user_name_real":"cy"}],"discussion_count":4,"race_medal":0,"score":"190525148644","product_id":100021701,"comment_content":"è€å¸ˆè¯·é—®ä¸€ä¸‹ï¼šå¦‚æœæ˜¯éœ€è¦ç”¨æˆ·ç™»é™†åæ‰èƒ½çˆ¬å–çš„æ•°æ®è¯¥æ€ä¹ˆç”¨pythonæ¥å®ç°å‘¢ï¼Ÿ","like_count":45,"discussions":[{"author":{"id":1306094,"avatar":"https://static001.geekbang.org/account/avatar/00/13/ed/ee/c4779b67.jpg","nickname":"cy","note":"","ucode":"50D653399A31F6","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":435332,"discussion_content":"ä½ å¯ä»¥ä½¿ç”¨python+seleniumçš„æ–¹å¼å®Œæˆè´¦æˆ·çš„è‡ªåŠ¨ç™»å½•ï¼Œå› ä¸ºseleniumæ˜¯ä¸ªè‡ªåŠ¨åŒ–æµ‹è¯•çš„æ¡†æ¶ï¼Œä½¿ç”¨selenium çš„webdriverå°±å¯ä»¥æ¨¡æ‹Ÿæµè§ˆå™¨çš„è¡Œä¸ºã€‚æ‰¾åˆ°è¾“å…¥ç”¨æˆ·åå¯†ç çš„åœ°æ–¹ï¼Œè¾“å…¥ç›¸åº”çš„å€¼ï¼Œç„¶åæ¨¡æ‹Ÿç‚¹å‡»å³å¯å®Œæˆç™»å½•ï¼ˆæ²¡æœ‰éªŒè¯ç çš„æƒ…å†µä¸‹ï¼‰\nå¦å¤–ä½ ä¹Ÿå¯ä»¥ä½¿ç”¨cookieæ¥ç™»å½•ç½‘ç«™ï¼Œæ–¹æ³•æ˜¯ä½ ç™»å½•ç½‘ç«™æ—¶ï¼Œå…ˆä¿å­˜ç½‘ç«™çš„cookieï¼Œç„¶åç”¨ä¸‹æ¬¡è®¿é—®çš„æ—¶å€™ï¼ŒåŠ è½½ä¹‹å‰ä¿å­˜çš„cookieï¼Œæ”¾åˆ°request headersä¸­ï¼Œè¿™æ ·å°±ä¸éœ€è¦å†ç™»å½•ç½‘ç«™äº†\n","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1547364811,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1717549,"avatar":"https://static001.geekbang.org/account/avatar/00/1a/35/2d/a2bde67e.jpg","nickname":"SapereAude","note":"","ucode":"C5D61C535B7B10","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":82768,"discussion_content":"äº¦å¯ä»¥æ‹¿åˆ°æäº¤çš„urlï¼ŒæŠŠè¦æäº¤çš„æ•°æ®å°è£…å¥½ï¼Œå‘é€è¯·æ±‚ï¼Œè·å¾—è¿”å›çš„æ•°æ®ï¼Œè¿›è¡Œåç»­æ“ä½œã€‚","likes_number":1,"is_delete":false,"is_hidden":false,"ctime":1576377656,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":2313022,"avatar":"https://static001.geekbang.org/account/avatar/00/23/4b/3e/dc8b3169.jpg","nickname":"ä¸æƒ³è¿™æ ·","note":"","ucode":"D212AC2B5BA0A1","race_medal":0,"user_type":1,"is_pvip":true},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":356125,"discussion_content":"å·¥ä½œä¸­é‡åˆ°çš„çˆ¬è™«éªŒè¯ç è¿™å—æœ€éš¾äº† ocrè®­ç»ƒå¿…é¡»å¼„","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1615536289,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1070753,"avatar":"https://static001.geekbang.org/account/avatar/00/10/56/a1/9574aa11.jpg","nickname":"å°î”® çš„æ—¶ä»¤","note":"","ucode":"FCF085CBEAFC5F","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":41921,"discussion_content":"ä¿ç•™ç™»å½•çš„sessionå°±å¯ä»¥ç™»å½•äº†","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1572533638,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":118811,"user_name":"Bayes","can_delete":false,"product_type":"c1","uid":1580620,"ip_address":"","ucode":"5215F12A0C6344","user_header":"https://static001.geekbang.org/account/avatar/00/18/1e/4c/79590513.jpg","comment_is_top":false,"comment_ctime":1564448886,"is_pvip":false,"replies":[{"id":"63607","content":"æ…¢æ…¢æ¥ï¼Œæœ‰äº›ä»£ç æ”¾åˆ°GitHubä¸Šäº†ï¼Œå¯ä»¥å…ˆè·‘ä¸‹","user_name":"ä½œè€…å›å¤","comment_id":118811,"uid":"1306094","ip_address":"","utype":1,"ctime":1577520917,"user_name_real":"cy"}],"discussion_count":8,"race_medal":0,"score":"74578892918","product_id":100021701,"comment_content":"è€å¸ˆä½ è¿™è·³è¿‡äº†å¤ªå¤šæ­¥éª¤äº†ï¼Œè¡¨ç¤ºå¯¹äºpythonè·Ÿç€ä½ å‰å‡ èŠ‚è¯¾å…¥é—¨çš„äººä»€ä¹ˆéƒ½ä¸ä¼šï¼ŒæŒ‰ç€ä½ çš„ä»£ç è¿è¡Œï¼Œè¦ä¸å°±æ˜¯æ²¡æœ‰å®šä¹‰ï¼Œè¦ä¸å°±æ˜¯æ²¡æœ‰è¿™ä¸ªå‡½æ•°ã€‚åˆšå¼€å§‹çš„äººä¹Ÿä¸çŸ¥é“å“ªä¸ªå‡½æ•°åœ¨å“ªä¸ªåº“ï¼Œå»ºè®®è€å¸ˆæŒ‰ç…§æµç¨‹æ¥ä¸€æ­¥ä¸€æ­¥ç»™ä»£ç ï¼Œè¦ä¸å°±åœ¨æœ€åç»™ä¸€ä¸ªå®Œæ•´çš„ä»£ç ç¤ºä¾‹ï¼ŒçœŸçš„æ˜¯å­¦çš„å¾ˆå›°éš¾åŠ ä¸Šæƒ³æ”¾å¼ƒ","like_count":18,"discussions":[{"author":{"id":1306094,"avatar":"https://static001.geekbang.org/account/avatar/00/13/ed/ee/c4779b67.jpg","nickname":"cy","note":"","ucode":"50D653399A31F6","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":460592,"discussion_content":"æ…¢æ…¢æ¥ï¼Œæœ‰äº›ä»£ç æ”¾åˆ°GitHubä¸Šäº†ï¼Œå¯ä»¥å…ˆè·‘ä¸‹","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1577520917,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":2,"child_discussions":[{"author":{"id":1649859,"avatar":"http://thirdwx.qlogo.cn/mmopen/vi_32/CqF8eiaanNteyu2U7FibYicjnw99VXZST61vvMpQKSd5iaLNW6EicLeFYyDOKJmg9rNx6KW90DwpPMKNxiben6fQeZjA/132","nickname":"Geek_24abc6","note":"","ucode":"88CD214232C6BC","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":1306094,"avatar":"https://static001.geekbang.org/account/avatar/00/13/ed/ee/c4779b67.jpg","nickname":"cy","note":"","ucode":"50D653399A31F6","race_medal":0,"user_type":2,"is_pvip":false},"discussion":{"id":591031,"discussion_content":"ä½ å¥½","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1666234605,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":460592,"ip_address":"å¹¿ä¸œ"},"score":591031,"extra":""},{"author":{"id":1649859,"avatar":"http://thirdwx.qlogo.cn/mmopen/vi_32/CqF8eiaanNteyu2U7FibYicjnw99VXZST61vvMpQKSd5iaLNW6EicLeFYyDOKJmg9rNx6KW90DwpPMKNxiben6fQeZjA/132","nickname":"Geek_24abc6","note":"","ucode":"88CD214232C6BC","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":1306094,"avatar":"https://static001.geekbang.org/account/avatar/00/13/ed/ee/c4779b67.jpg","nickname":"cy","note":"","ucode":"50D653399A31F6","race_medal":0,"user_type":2,"is_pvip":false},"discussion":{"id":591032,"discussion_content":"è¯·é—®æœ¬è¯¾ç¨‹çš„æ‰€æœ‰ä»£ç åœ¨å“ªé‡Œå‘€ï¼Ÿï¼Ÿï¼Ÿæ±‚åˆ†äº«ğŸ˜ğŸ˜˜","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1666234671,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":460592,"ip_address":"å¹¿ä¸œ"},"score":591032,"extra":""}]},{"author":{"id":1659590,"avatar":"https://static001.geekbang.org/account/avatar/00/19/52/c6/8eb48963.jpg","nickname":"ä¸€çº¸ä¹¦","note":"","ucode":"C58A22B54521CA","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":19525,"discussion_content":"åŒæ„Ÿï¼Œå·²ç»å…¥äº†é—¨çš„ï¼ŒåŠªæŠŠåŠ›è¿˜èƒ½çœ‹æ‡‚ï¼Œåˆšå…¥å‘çš„çœŸçš„ä¸€å¤´é›¾æ°´ã€‚æ‰€ä»¥å‘¢ï¼Œæˆ‘æ‰“ç®—æŠŠä¹°çš„è¯¾ç•™ç€è¿‡ä¸€æ®µæ—¶é—´å†çœ‹ã€‚è‡ªå·±å…ˆæŠŠåŸºç¡€æå¥½ã€‚å¯¹äºçœ‹ä¸æ‡‚çš„ä¹¦ï¼Œéƒ½æ˜¯è¿™ä¹ˆå¤„ç†çš„ã€‚","likes_number":1,"is_delete":false,"is_hidden":false,"ctime":1569204469,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1649859,"avatar":"http://thirdwx.qlogo.cn/mmopen/vi_32/CqF8eiaanNteyu2U7FibYicjnw99VXZST61vvMpQKSd5iaLNW6EicLeFYyDOKJmg9rNx6KW90DwpPMKNxiben6fQeZjA/132","nickname":"Geek_24abc6","note":"","ucode":"88CD214232C6BC","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":590955,"discussion_content":"ä»£ç åœ¨å“ªé‡Œå‘€ï¼Ÿï¼Ÿï¼Ÿï¼Ÿ","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1666188288,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":"å¹¿ä¸œ"},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":2022922,"avatar":"https://static001.geekbang.org/account/avatar/00/1e/de/0a/6400e68e.jpg","nickname":"Terrylee","note":"","ucode":"89C1C695A3D6AC","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":379043,"discussion_content":"ä¸€å¤´é›¾æ°´ï¼ï¼ï¼å®Œå…¨çœ‹ä¸æ‡‚ï¼ï¼ï¼å­¦æ ¡ä¸èƒ½æŒ‡å¯¼ä¸‹å—ï¼Ÿ","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1623641864,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1217054,"avatar":"https://static001.geekbang.org/account/avatar/00/12/92/1e/67b51b3d.jpg","nickname":"çŠç¾½","note":"","ucode":"64AF515A35D4ED","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":354362,"discussion_content":"GitHubåœ°å€æ˜¯ä»€ä¹ˆå‘¢ï¼Ÿå»ºè®®æ¯èŠ‚è¯¾é‡Œéƒ½é™„ä¸Šå®Œæ•´çš„ä»£ç ä¸‹è½½åœ°å€å‘¢~å¯¹äºå­¦å‘˜æ¥è¯´æ¯”è¾ƒæ–¹ä¾¿æŸ¥æ‰¾~","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1615280132,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1914504,"avatar":"https://static001.geekbang.org/account/avatar/00/1d/36/88/20b6a6ee.jpg","nickname":"Simon","note":"","ucode":"A8A2E3E57BD029","race_medal":0,"user_type":1,"is_pvip":true},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":233395,"discussion_content":"é˜…è¯»ä»£ç çš„æ­£ç¡®æ–¹å¼æ˜¯å…ˆçœ‹æ•´ä½“æµç¨‹ã€‚æŠŠæ¡å¥½æ•´ä½“é€»è¾‘åï¼Œå†çœ‹ç»†èŠ‚ã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1586923000,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":57218,"user_name":"caidy","can_delete":false,"product_type":"c1","uid":1188783,"ip_address":"","ucode":"AEFB529C32C7EE","user_header":"https://static001.geekbang.org/account/avatar/00/12/23/af/84f4714e.jpg","comment_is_top":false,"comment_ctime":1546687848,"is_pvip":false,"discussion_count":6,"race_medal":0,"score":"70266164584","product_id":100021701,"comment_content":"ä½ éœ€è¦ä½¿ç”¨æµè§ˆå™¨çš„æ’ä»¶æŸ¥çœ‹ XHR æ•°æ®ï¼Œæ¯”å¦‚åœ¨ Chromeçš„å¼€å‘è€…å·¥å…·<br>åœ¨è±†ç“£æœç´¢ä¸­ï¼Œæˆ‘ä»¬å¯¹â€œç‹ç¥–è´¤â€è¿›è¡Œäº†æ¨¡æ‹Ÿï¼Œå‘ç° XHR æ•°æ®ä¸­æœ‰ä¸€ä¸ªè¯·æ±‚æ˜¯è¿™æ ·çš„ï¼š<br>https:&#47;&#47;www.douban.com&#47;j&#47;search_photo?q=ç‹ç¥–è´¤&amp;limit=20&amp;start=0<br><br>è¿™ä¸ªæ˜¯å¦‚ä½•æŸ¥å‡ºæ¥çš„ï¼Œæˆ‘ä½¿ç”¨chromeçš„å¼€å‘è€…å·¥å…·æŸ¥çœ‹ï¼Œä½†æ˜¯æŸ¥ä¸åˆ°è¿™éƒ¨åˆ†ï¼Œéº»çƒ¦è€å¸ˆå¸®å¿™è§£ç­”","like_count":16,"discussions":[{"author":{"id":1234591,"avatar":"https://static001.geekbang.org/account/avatar/00/12/d6/9f/0213e8a0.jpg","nickname":"ğŸ¤ªHappyJoo","note":"","ucode":"96E1858F06BABA","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":3063,"discussion_content":"æˆ‘ä¹Ÿæ˜¯è§‰å¾—è¿™ä¸€æ­¥è·¨åº¦æœ‰ç‚¹å¤§ï¼Œéœ€è¦æœ‰åŸºç¡€ï¼Œæ²¡æœ‰è¯¦ç»†è®²ã€‚","likes_number":7,"is_delete":false,"is_hidden":false,"ctime":1564143334,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1039464,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/dc/68/006ba72c.jpg","nickname":"Untitled","note":"","ucode":"8DD6ABA3E81A2E","race_medal":2,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":2433,"discussion_content":"chromeçš„å¼€å‘å·¥å…·æ‰“å¼€åï¼Œå†ã€networkã€‘ä¸‹filterå‡ºxhrï¼Œç„¶åé‡æ–°åˆ·æ–°ç½‘é¡µï¼Œå°±ä¼šçœ‹åˆ°xhrè¯·æ±‚ã€‚","likes_number":6,"is_delete":false,"is_hidden":false,"ctime":1563610704,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":2415687,"avatar":"https://static001.geekbang.org/account/avatar/00/24/dc/47/554aa6b8.jpg","nickname":"éœ€è¦åŠªåŠ›çš„ã€","note":"","ucode":"04627BD9ED77DD","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":344952,"discussion_content":"F12,ç‚¹å‡» Networkâ€” SHRï¼Œåˆ·æ–°ä¸‹ç½‘é¡µå°±å‡ºæ¥äº†","likes_number":1,"is_delete":false,"is_hidden":false,"ctime":1611628769,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1690817,"avatar":"https://static001.geekbang.org/account/avatar/00/19/cc/c1/94bc753d.jpg","nickname":"miserman","note":"","ucode":"4793B0E87BCD38","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":188082,"discussion_content":"æˆ‘ä¹Ÿçœ‹ä¸åˆ°ä»»ä½•xhrçš„æ•°æ®","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1582794303,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1690817,"avatar":"https://static001.geekbang.org/account/avatar/00/19/cc/c1/94bc753d.jpg","nickname":"miserman","note":"","ucode":"4793B0E87BCD38","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":188081,"discussion_content":"è¿™ä¸ªé—®é¢˜è§£å†³äº†å—","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1582794273,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1203652,"avatar":"https://static001.geekbang.org/account/avatar/00/12/5d/c4/cf9b06b9.jpg","nickname":"Sunway.","note":"","ucode":"F0DBC27A0D8158","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":24948,"discussion_content":"filteräº†xhrï¼Œä½†æ˜¯å¹¶æ²¡æœ‰çœ‹åˆ°jsonæ•°æ®ï¼Œåˆ·æ–°äº†ä¹Ÿæ²¡æœ‰ï¼Œæœ‰ç‚¹å¥‡æ€ª..","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1570342926,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":57023,"user_name":"ä¼ªå›å­","can_delete":false,"product_type":"c1","uid":1034778,"ip_address":"","ucode":"FE5409FB318EE7","user_header":"https://static001.geekbang.org/account/avatar/00/0f/ca/1a/9ecbf1bb.jpg","comment_is_top":false,"comment_ctime":1546604062,"is_pvip":false,"replies":[{"id":"21393","content":"å¯¹çš„ï¼Œä¸»è¦æ˜¯é…ç½®ChromeDriverçš„é—®é¢˜ã€‚æœ‰ç›¸åŒé—®é¢˜çš„äººï¼Œå¯ä»¥çœ‹ä¸‹è¿™ä¸ªç•™è¨€","user_name":"ä½œè€…å›å¤","comment_id":57023,"uid":"1306094","ip_address":"","utype":1,"ctime":1547355257,"user_name_real":"cy"}],"discussion_count":1,"race_medal":0,"score":"61676146206","product_id":100021701,"comment_content":"é‚£äº›ç”¨ ChromeDriver çš„å‡ºç°æŠ¥é”™çš„å¯èƒ½æ˜¯æ²¡æœ‰å®‰è£… ChromeDriverï¼Œæˆ–è€…æ˜¯æ²¡ç»™å‡º ChromeDriver çš„è·¯å¾„ï¼Œå…·ä½“å¯ä»¥çœ‹çœ‹ä¸‹é¢è¿™ç¯‡æ–‡ç« ã€‚<br>https:&#47;&#47;mp.weixin.qq.com&#47;s&#47;UL0bcLr3KOb-qpI9oegaIQ","like_count":15,"discussions":[{"author":{"id":1306094,"avatar":"https://static001.geekbang.org/account/avatar/00/13/ed/ee/c4779b67.jpg","nickname":"cy","note":"","ucode":"50D653399A31F6","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":435366,"discussion_content":"å¯¹çš„ï¼Œä¸»è¦æ˜¯é…ç½®ChromeDriverçš„é—®é¢˜ã€‚æœ‰ç›¸åŒé—®é¢˜çš„äººï¼Œå¯ä»¥çœ‹ä¸‹è¿™ä¸ªç•™è¨€","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1547355257,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":57078,"user_name":"LY","can_delete":false,"product_type":"c1","uid":1168940,"ip_address":"","ucode":"109E6F963A6E39","user_header":"https://wx.qlogo.cn/mmopen/vi_32/l56HXkqMD4hqDg82yiaTr28GSwB1rCasj7n8M65VbibsJwmDibJnrWpw8o0mYGewH6NeD1wGvU6OGdhDG4nzIa9mA/132","comment_is_top":false,"comment_ctime":1546616192,"is_pvip":false,"replies":[{"id":"21407","content":"GoodJob","user_name":"ä½œè€…å›å¤","comment_id":57078,"uid":"1306094","ip_address":"","utype":1,"ctime":1547365241,"user_name_real":"cy"}],"discussion_count":1,"race_medal":0,"score":"57381191040","product_id":100021701,"comment_content":"#ç¯å¢ƒï¼šMac Python3<br>#pip install selenium<br>#ä¸‹è½½chromedriverï¼Œæ”¾åˆ°é¡¹ç›®è·¯å¾„ä¸‹ï¼ˆhttps:&#47;&#47;npm.taobao.org&#47;mirrors&#47;chromedriver&#47;2.33&#47;ï¼‰<br># coding:utf-8<br>import requests<br>import json<br>import os<br>from lxml import etree<br>from selenium import webdriver<br><br>query = &#39;å¼ æŸèŠ&#39;<br>downloadPath = &#39;&#47;Users&#47;yong&#47;Desktop&#47;Python&#47;xpath&#47;images&#47;&#39;<br><br>&#39;&#39;&#39; ä¸‹è½½å›¾ç‰‡ &#39;&#39;&#39;<br>def download(src, id):<br>    dir = downloadPath + str(id) + &#39;.jpg&#39;<br>    try:<br>        pic = requests.get(src, timeout=10)<br>    except requests.exceptions.ConnectionError:<br>    # print &#39;error, %d å½“å‰å›¾ç‰‡æ— æ³•ä¸‹è½½&#39;, %id<br>        print(&#39;å›¾ç‰‡æ— æ³•ä¸‹è½½&#39;)<br>    if not os.path.exists(downloadPath):<br>        os.mkdir(downloadPath)<br>    if os.path.exists(dir):<br>        print(&#39;å·²å­˜åœ¨:&#39;+ id)<br>        return<br>    fp = open(dir, &#39;wb&#39;)<br>    fp.write(pic.content)<br>    fp.close()<br> <br>def searchImages():<br>    &#39;&#39;&#39; for å¾ªç¯ è¯·æ±‚å…¨éƒ¨çš„ url &#39;&#39;&#39;<br>    for i in range(0, 22471, 20):<br>        url = &#39;https:&#47;&#47;www.douban.com&#47;j&#47;search_photo?q=&#39;+query+&#39;&amp;limit=20&amp;start=&#39;+str(i)<br>        html = requests.get(url).text    # å¾—åˆ°è¿”å›ç»“æœ<br>        print(&#39;html:&#39;+html)<br>        response = json.loads(html,encoding=&#39;utf-8&#39;) # å°† JSON æ ¼å¼è½¬æ¢æˆ Python å¯¹è±¡<br>        for image in response[&#39;images&#39;]:<br>            print(image[&#39;src&#39;]) # æŸ¥çœ‹å½“å‰ä¸‹è½½çš„å›¾ç‰‡ç½‘å€<br>            download(image[&#39;src&#39;], image[&#39;id&#39;]) # ä¸‹è½½ä¸€å¼ å›¾ç‰‡<br><br>def getMovieImages():<br>    url = &#39;https:&#47;&#47;movie.douban.com&#47;subject_search?search_text=&#39;+ query +&#39;&amp;cat=1002&#39;<br>    driver = webdriver.Chrome(&#39;&#47;Users&#47;yong&#47;Desktop&#47;Python&#47;xpath&#47;libs&#47;chromedriver&#39;)<br>    driver.get(url)<br>    html = etree.HTML(driver.page_source)<br>    # ä½¿ç”¨xpath helper, ctrl+shit+x é€‰ä¸­å…ƒç´ ï¼Œå¦‚æœè¦åŒ¹é…å…¨éƒ¨ï¼Œåˆ™éœ€è¦ä¿®æ”¹query è¡¨è¾¾å¼<br>    src_xpath = &quot;&#47;&#47;div[@class=&#39;item-root&#39;]&#47;a[@class=&#39;cover-link&#39;]&#47;img[@class=&#39;cover&#39;]&#47;@src&quot;<br>    title_xpath = &quot;&#47;&#47;div[@class=&#39;item-root&#39;]&#47;div[@class=&#39;detail&#39;]&#47;div[@class=&#39;title&#39;]&#47;a[@class=&#39;title-text&#39;]&quot;<br><br>    srcs = html.xpath(src_xpath)<br>    titles = html.xpath(title_xpath)<br>    for src, title in zip(srcs, titles):<br>        print(&#39;\\t&#39;.join([str(src),str(title.text)]))<br>        download(src, title.text)<br><br>    driver.close()<br><br>getMovieImages()","like_count":13,"discussions":[{"author":{"id":1306094,"avatar":"https://static001.geekbang.org/account/avatar/00/13/ed/ee/c4779b67.jpg","nickname":"cy","note":"","ucode":"50D653399A31F6","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":435393,"discussion_content":"GoodJob","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1547365241,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":88508,"user_name":"juixv3937","can_delete":false,"product_type":"c1","uid":1486338,"ip_address":"","ucode":"C164F6641FE043","user_header":"http://thirdwx.qlogo.cn/mmopen/vi_32/1rd5KVxbBWO1Jnq3syrfRQg0NGerVl4Dt7uHTMcy9A7KTqxmy7iaoomoWsjuHM4n7fBr0ESG8OqfJKCDHExzjvQ/132","comment_is_top":false,"comment_ctime":1555932659,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"40210638323","product_id":100021701,"comment_content":"æ€ä¹ˆæŸ¥çœ‹XHRæ•°æ®å•Šï¼Œæ“ä½œæ­¥éª¤è·³è¿‡çš„è¯ï¼Œå­¦ä¹ çš„å¾ˆå›°éš¾","like_count":10},{"had_liked":false,"id":204128,"user_name":"é£˜","can_delete":false,"product_type":"c1","uid":1804243,"ip_address":"","ucode":"07439B291A76F4","user_header":"https://static001.geekbang.org/account/avatar/00/1b/87/d3/fe95bda9.jpg","comment_is_top":false,"comment_ctime":1586338554,"is_pvip":false,"replies":[{"id":"104314","content":"Good Job!","user_name":"ä½œè€…å›å¤","comment_id":204128,"uid":"1306094","ip_address":"","utype":1,"ctime":1617892144,"user_name_real":"cy"}],"discussion_count":3,"race_medal":0,"score":"35946076922","product_id":100021701,"comment_content":"æ„Ÿè°¢ä½œè€…ä»¥åŠè¯„è®ºåŒºçš„å„ä½å¤§ç¥ï¼Œç»ˆäºå®Œæˆäº†çˆ¬è™«ä»£ç ï¼Œæ€»ç»“ä¸€ä¸‹å°ç™½ç¼–å†™æ—¶é‡åˆ°çš„å‡ ä¸ªé—®é¢˜ï¼š<br>1ï¼‰è·å–xpathæ—¶ï¼Œchromeæµè§ˆå™¨éœ€è¦å®‰è£…æ’ä»¶xpatn-helperï¼›<br>2ï¼‰ä½¿ç”¨python3.7ï¼Œæå‰å¼•å…¥æ¨¡å—requestsï¼Œlxmlï¼Œseleniumï¼Œå®‰è£…è¿™äº›æ¨¡å—éœ€è¦æ›´æ–°pipè‡³20ç‰ˆæœ¬ï¼›<br>3ï¼‰æ¨¡æ‹Ÿç”¨æˆ·è®¿é—®æµè§ˆå™¨ï¼Œéœ€è¦ä¸‹è½½chromedriver.exe,æ”¾å…¥python.exeæ‰€åœ¨ç›®å½•ï¼›<br>4ï¼‰å›¾ç‰‡è·¯å¾„ä¸­å‡ºç°å¯¼è‡´ç¼–è¯‘å¤±è´¥çš„å­—ç¬¦ï¼Œä½¿ç”¨replaceæ›¿æ¢æŠ¥é”™å­—ç¬¦ã€‚<br>å…·ä½“ä»£ç å¦‚ä¸‹ï¼š<br>import os<br>import requests<br>from lxml import etree<br>from selenium import webdriver<br><br>search_text = &quot;ç‹ç¥–è´¤&quot;<br>start = 0<br>limit = 15<br>total = 90<br><br>def download(img, title):<br>\tdir = &quot;D:\\\\æ•°æ®åˆ†æ\\\\python test\\\\query\\\\&quot; + search_text + &quot;\\\\&quot; <br>\tid = title.replace(u&#39;\\u200e&#39;, u&#39;&#39;).replace(u&#39;?&#39;, u&#39;&#39;) .replace(u&#39;&#47;&#39;, u&#39;or&#39;)<br>\tif not os.path.exists(dir):<br>\t\tos.makedirs(dir)<br>\ttry:    <br>\t\tpic = requests.get(img, timeout=10) <br>\t\timg_path = dir  + str(id) + &#39;.jpg&#39;   <br>\t\tfp = open(img_path, &#39;wb&#39;)    <br>\t\tfp.write(pic.content)    <br>\t\tfp.close()  <br>\texcept requests.exceptions.ConnectionError:    <br>\t\tprint(&#39;å›¾ç‰‡æ— æ³•ä¸‹è½½&#39;)<br><br>def crawler_xpath():<br>\tsrc_img = &quot;&#47;&#47;div[@class=&#39;item-root&#39;]&#47;a[@class=&#39;cover-link&#39;]&#47;img[@class=&#39;cover&#39;]&#47;@src&quot;<br>\tsrc_title = &quot;&#47;&#47;div[@class=&#39;item-root&#39;]&#47;div[@class=&#39;detail&#39;]&#47;div[@class=&#39;title&#39;]&#47;a[@class=&#39;title-text&#39;]&quot;<br>\t<br>\tfor i in range(start,total,limit):<br>\t\trequest_url = &quot;https:&#47;&#47;search.douban.com&#47;movie&#47;subject_search?search_text=&quot;+search_text+&quot;&amp;cat=1002&amp;start=&quot;+str(i)<br>\t\tdriver = webdriver.Chrome()<br>\t\tdriver.get(request_url)<br>\t\thtml = etree.HTML(driver.page_source)<br>\t\timgs = html.xpath(src_img)<br>\t\ttitles = html.xpath(src_title)<br>\t\tprint(imgs,titles)<br>\t\tfor img, title in zip(imgs, titles): <br>\t\t\tdownload(img, title.text)<br>if __name__ == &#39;__main__&#39;:<br>\tcrawler_xpath()<br>","like_count":8,"discussions":[{"author":{"id":1306094,"avatar":"https://static001.geekbang.org/account/avatar/00/13/ed/ee/c4779b67.jpg","nickname":"cy","note":"","ucode":"50D653399A31F6","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":491083,"discussion_content":"Good Job!","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1617892144,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1073027,"avatar":"https://static001.geekbang.org/account/avatar/00/10/5f/83/bb728e53.jpg","nickname":"Douglas","note":"","ucode":"CFDE3D76B9DAE6","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":360402,"discussion_content":"è¿™äº›æœ¬è¯¥è®²å¸ˆè¯´æ˜çš„é—®é¢˜ï¼Œä½ éƒ½å†™å‡ºæ¥äº†ï¼Œç»™ä½ ç‚¹ä¸ªèµ","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1616427376,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1930136,"avatar":"https://static001.geekbang.org/account/avatar/00/1d/73/98/8c2b746a.jpg","nickname":"Q.G.","note":"","ucode":"687CB21512A610","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":246337,"discussion_content":"4ï¼‰å›¾ç‰‡è·¯å¾„ä¸­å‡ºç°å¯¼è‡´ç¼–è¯‘å¤±è´¥çš„å­—ç¬¦ï¼Œä½¿ç”¨replaceæ›¿æ¢æŠ¥é”™å­—ç¬¦ã€‚\n\næ„Ÿè°¢ï¼Œæˆ‘å¡åœ¨è¿™é‡Œï¼ŒåŸæ¥æ˜¯è¿™ä¸ªåŸå› ","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1587737568,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":57017,"user_name":"ä¼ªå›å­","can_delete":false,"product_type":"c1","uid":1034778,"ip_address":"","ucode":"FE5409FB318EE7","user_header":"https://static001.geekbang.org/account/avatar/00/0f/ca/1a/9ecbf1bb.jpg","comment_is_top":false,"comment_ctime":1546602263,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"35906340631","product_id":100021701,"comment_content":"è€å¸ˆæ‚¨å¥½ï¼Œæˆ‘æ ¹æ®æ‚¨çš„ä»£ç ä¿®æ”¹äº†ä¸€ä¸‹ï¼Œä¸»è¦æ˜¯æ·»åŠ äº†ä¸€ä¸ªå›¾ç‰‡çš„ç›®å½•ï¼Œç„¶åæ˜¯ä¸‹è½½å¤§å›¾ã€‚è¿™é‡Œçš„å¤§å›¾æ˜¯å› ä¸º &#47;photo&#47;thumb&#47;public&#47; è¿™æ ·çš„é“¾æ¥ä¸‹è½½çš„å›¾ç‰‡æ˜¯ç¼©ç•¥å›¾ï¼Œåªæœ‰æŠŠ thumb æ›¿æ¢æˆ l ä¹‹åä¸‹è½½çš„å›¾ç‰‡æ‰æ˜¯ç›¸å¯¹æ¥è¯´çš„å¤§å›¾ã€‚replace æ–¹æ³•å’Œ re ä¸­çš„ sub æ–¹æ³•éƒ½èƒ½å®ç°æ›¿æ¢ï¼Œæˆ‘çš„ç–‘é—®æ˜¯å“ªä¸ªå®ç°èµ·æ¥æ›´é«˜é€Ÿä¸€ç‚¹å‘¢ï¼Ÿæå‰æ„Ÿè°¢è€å¸ˆï¼Œæˆ‘å†™çš„ä»£ç åœ¨ä¸‹é¢~<br><br># coding:utf-8<br>import requests<br>import json<br>import re<br>import os<br><br>query = &#39;ç‹ç¥–è´¤&#39;<br>path = os.getcwd()  # å½“å‰è·¯å¾„ï¼Œå¯ä»¥æ›¿æ¢æˆåˆ«çš„è·¯å¾„<br>picpath = path + &#39;&#47;&#39; + query  # è®¾ç½®çš„å›¾ç‰‡ç›®å½•<br>print(picpath)  # è¾“å‡ºè®¾ç½®çš„å›¾ç‰‡ç›®å½•<br>if not os.path.isdir(picpath):  # å¦‚æœå›¾ç‰‡ç›®å½•æœªåˆ›å»ºåˆ™åˆ›å»ºä¸€ä¸ª<br>    os.mkdir(picpath)<br><br><br>def download(src, id):<br>    dir = picpath + &#39;&#47;&#39; + str(id) + &#39;.jpg&#39;<br>    try:<br>        pic = requests.get(src, timeout=10)<br>    except requests.exceptions.ConnectionError:<br>        # print &#39;error, %d å½“å‰å›¾ç‰‡æ— æ³•ä¸‹è½½&#39;, %id<br>        print(&#39;å›¾ç‰‡æ— æ³•ä¸‹è½½&#39;)<br>    fp = open(dir, &#39;wb&#39;)<br>    fp.write(pic.content)<br>    fp.close()<br><br><br>&#39;&#39;&#39; for å¾ªç¯ è¯·æ±‚å…¨éƒ¨çš„ url &#39;&#39;&#39;<br>for i in range(0, 22471, 20):  #<br>    url = &#39;https:&#47;&#47;www.douban.com&#47;j&#47;search_photo?q=&#39; + query + &#39;&amp;limit=20&amp;start=&#39; + str(i)<br>    html = requests.get(url).text  # å¾—åˆ°è¿”å›ç»“æœ<br>    response = json.loads(html, encoding=&#39;utf-8&#39;)  # å°† JSON æ ¼å¼è½¬æ¢æˆ Python å¯¹è±¡<br>    print(&#39;å·²ä¸‹è½½ &#39; + str(i) + &#39; å¼ å›¾ç‰‡&#39;)<br>    for image in response[&#39;images&#39;]:<br>        image[&#39;src&#39;] = image[&#39;src&#39;].replace(&#39;thumb&#39;, &#39;l&#39;)<br>        # image[&#39;src&#39;] = re.sub(r&#39;thumb&#39;, r&#39;l&#39;, image[&#39;src&#39;])<br>        print(image[&#39;src&#39;])  # æŸ¥çœ‹å½“å‰ä¸‹è½½çš„å›¾ç‰‡ç½‘å€<br>        download(image[&#39;src&#39;], image[&#39;id&#39;])  # ä¸‹è½½ä¸€å¼ å›¾ç‰‡<br>","like_count":8},{"had_liked":false,"id":56968,"user_name":"germany","can_delete":false,"product_type":"c1","uid":1075195,"ip_address":"","ucode":"249BD3439D0A5B","user_header":"https://static001.geekbang.org/account/avatar/00/10/67/fb/cd95d624.jpg","comment_is_top":false,"comment_ctime":1546589116,"is_pvip":false,"replies":[{"id":"21403","content":"å’±ä»¬è®¿é—®è±†ç“£æŸ¥è¯¢å›¾ç‰‡çš„ç½‘å€åº”è¯¥æ˜¯ä¸€æ ·çš„ã€‚åªæ˜¯æˆ‘ç»™å‡ºçš„æ˜¯jsonçš„é“¾æ¥ã€‚æ–¹æ³•æ˜¯ï¼šç”¨Chromeæµè§ˆå™¨çš„å¼€å‘è€…å·¥å…·ï¼Œå¯ä»¥ç›‘æµ‹å‡ºæ¥ç½‘é¡µä¸­æ˜¯å¦æœ‰jsonæ•°æ®çš„ä¼ è¾“ï¼Œæ‰€ä»¥æˆ‘ç»™å‡ºçš„é“¾æ¥æ˜¯jsonæ•°æ®ä¼ è¾“çš„é“¾æ¥ https:&#47;&#47;www.douban.com&#47;j&#47;search_photo?q=%E7%8E%8B%E7%A5%96%E8%B4%A4&amp;limit=20&amp;start=0","user_name":"ä½œè€…å›å¤","comment_id":56968,"uid":"1306094","ip_address":"","utype":1,"ctime":1547364072,"user_name_real":"cy"}],"discussion_count":2,"race_medal":0,"score":"27316392892","product_id":100021701,"comment_content":"è€å¸ˆï¼šä¸ºä»€ä¹ˆæˆ‘åœ¨è±†ç“£ç½‘æŸ¥è¯¢å›¾ç‰‡çš„ç½‘å€ä¸ä½ ä¸ä¸€æ ·ï¼Ÿhttps:&#47;&#47;www.douban.com&#47;search?cat=1025&amp;q=ç‹ç¥–è´¤&amp;source=suggest  ã€‚æ˜¯ä»€ä¹ˆåŸå› ï¼Ÿ","like_count":6,"discussions":[{"author":{"id":1306094,"avatar":"https://static001.geekbang.org/account/avatar/00/13/ed/ee/c4779b67.jpg","nickname":"cy","note":"","ucode":"50D653399A31F6","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":435338,"discussion_content":"å’±ä»¬è®¿é—®è±†ç“£æŸ¥è¯¢å›¾ç‰‡çš„ç½‘å€åº”è¯¥æ˜¯ä¸€æ ·çš„ã€‚åªæ˜¯æˆ‘ç»™å‡ºçš„æ˜¯jsonçš„é“¾æ¥ã€‚æ–¹æ³•æ˜¯ï¼šç”¨Chromeæµè§ˆå™¨çš„å¼€å‘è€…å·¥å…·ï¼Œå¯ä»¥ç›‘æµ‹å‡ºæ¥ç½‘é¡µä¸­æ˜¯å¦æœ‰jsonæ•°æ®çš„ä¼ è¾“ï¼Œæ‰€ä»¥æˆ‘ç»™å‡ºçš„é“¾æ¥æ˜¯jsonæ•°æ®ä¼ è¾“çš„é“¾æ¥ https://www.douban.com/j/search_photo?q=%E7%8E%8B%E7%A5%96%E8%B4%A4&amp;amp;limit=20&amp;amp;start=0","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1547364072,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1115232,"avatar":"https://static001.geekbang.org/account/avatar/00/11/04/60/64d166b6.jpg","nickname":"Fan","note":"","ucode":"3BF28670FD9407","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":384964,"discussion_content":"ä¸ºå•¥æˆ‘çš„è®¿é—® https://www.douban.com/j/search_photo?q=%E7%8E%8B%E7%A5%96%E8%B4%A4&amp;limit=20&amp;start=0 è¿”å›çš„ç©ºå†…å®¹å‘¢ï¼Ÿ { }","likes_number":1,"is_delete":false,"is_hidden":false,"ctime":1626835517,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":170896,"user_name":"å›¾åå…”","can_delete":false,"product_type":"c1","uid":1167662,"ip_address":"","ucode":"2395E9506CBE0E","user_header":"https://static001.geekbang.org/account/avatar/00/11/d1/2e/d531b29b.jpg","comment_is_top":false,"comment_ctime":1578752852,"is_pvip":false,"discussion_count":2,"race_medal":0,"score":"23053589332","product_id":100021701,"comment_content":"ç”¨çš„æ˜¯python3<br>requests.get(url)è·å–æ‰€æœ‰å›¾ç‰‡çš„è·¯å¾„æ­¤å¤„éœ€è¦ç¨ä½œä¿®æ”¹ã€‚<br>headers = {&#39;User-Agent&#39;:&#39;Mozilla&#47;5.0 (Windows NT 10.0; WOW64) AppleWebKit&#47;537.36 (KHTML, like Gecko) Chrome&#47;74.0.3729.157 Safari&#47;537.36&#39;}<br>requests.get(url,header)<br>è¯·æ±‚è¦å¸¦ä¸Šheaderï¼Œé‡Œé¢åªéœ€è¦åŠ ä¸Šuser-Agentã€‚æ¨æµ‹è±†ç“£åº”è¯¥æ˜¯å¯¹user-Agentåšäº†æ£€æŸ¥ï¼Œç”¨æ¥è¿”å›é€‚é…å®¢æˆ·ç«¯çš„é¡µé¢ã€‚","like_count":5,"discussions":[{"author":{"id":1167662,"avatar":"https://static001.geekbang.org/account/avatar/00/11/d1/2e/d531b29b.jpg","nickname":"å›¾åå…”","note":"","ucode":"2395E9506CBE0E","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":284044,"discussion_content":"ç”¨è°·æ­Œæµè§ˆå™¨å‘è¯·æ±‚ï¼Œç„¶åf12ï¼Œåœ¨networké‡Œæ‰¾ä½ å‘é€çš„è¯·æ±‚å°±å¯ä»¥çœ‹åˆ°","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1592438865,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1038780,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/d9/bc/a2803bb7.jpg","nickname":"é¼î„","note":"","ucode":"44BBCCBA901121","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":284007,"discussion_content":"è¯·é—®headersæ˜¯æ€ä¹ˆæŸ¥çœ‹çš„å‘¢","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1592412008,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":56740,"user_name":"è¨±æ•²æ•²","can_delete":false,"product_type":"c1","uid":1046681,"ip_address":"","ucode":"6486466820E7BF","user_header":"https://static001.geekbang.org/account/avatar/00/0f/f8/99/8e760987.jpg","comment_is_top":false,"comment_ctime":1546532621,"is_pvip":false,"replies":[{"id":"21385","content":"NBAæ˜æ˜Ÿä¹Ÿæ˜¯ä¸é”™çš„é€‰æ‹©","user_name":"ä½œè€…å›å¤","comment_id":56740,"uid":"1306094","ip_address":"","utype":1,"ctime":1547351555,"user_name_real":"cy"}],"discussion_count":1,"race_medal":0,"score":"23021369101","product_id":100021701,"comment_content":"è¦ä¸‹è½½æ‰€æœ‰James å“ˆç™»çš„å›¾ç‰‡","like_count":5,"discussions":[{"author":{"id":1306094,"avatar":"https://static001.geekbang.org/account/avatar/00/13/ed/ee/c4779b67.jpg","nickname":"cy","note":"","ucode":"50D653399A31F6","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":435205,"discussion_content":"NBAæ˜æ˜Ÿä¹Ÿæ˜¯ä¸é”™çš„é€‰æ‹©","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1547351555,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":174813,"user_name":"Miracle","can_delete":false,"product_type":"c1","uid":1758279,"ip_address":"","ucode":"74116B4D0C0760","user_header":"https://static001.geekbang.org/account/avatar/00/1a/d4/47/6d9f2da6.jpg","comment_is_top":false,"comment_ctime":1580396367,"is_pvip":false,"discussion_count":2,"race_medal":0,"score":"18760265551","product_id":100021701,"comment_content":"ä¹‹å‰éƒ½æ˜¯ç°æˆçš„æ•°æ®ï¼Œç„¶åè¿›è¡Œæ•°æ®åˆ†æå·¥ä½œï¼Œç°åœ¨çªç„¶éœ€è¦è‡ªå·±çˆ¬æ•°æ®çš„æ—¶å€™ï¼Œæœ‰ç‚¹è‰°éš¾å•Šï¼Œè¿™æ˜¯ç¬¬ä¸€æ¬¡å­¦ä¹ çˆ¬è™«ï¼Œå…ˆç›´æ¥è·‘è€å¸ˆçš„ä»£ç ï¼Œ é‡åˆ°äº†è¿™æ ·çš„ä¸€ä¸ªé—®é¢˜ä¸‹é¢çš„ä¸€ä¸ªé—®é¢˜ï¼Œ èŠ±äº†å¾ˆå¤§çš„åŠ²æ‰æå®šè¿™ä¸ªé—®é¢˜ã€‚ç„¶åå€ŸåŠ©ä»Šå¤©çš„è¿™ä¸ªæœºä¼šï¼Œä¹Ÿé¡ºä¾¿è¿›è¡Œäº†Pythonçˆ¬è™«å…¥é—¨çš„å­¦ä¹ ï¼ŒåŸºäºè¿™èŠ‚è¯¾çš„åŸºç¡€ï¼ŒæŠŠè¯¾ä¸Šçš„ä¸¤ä¸ªä¾‹å­è¿›è¡Œäº†å°å®æˆ˜ï¼Œå¹¶ä¸”è¿˜ç”¨Pythonçˆ¬è™«å†™äº†ä¸¤ä¸ªå…¶ä»–çš„å®æˆ˜ï¼ŒåŒ…æ‹¬Pythonè‡ªåŠ¨ä¸‹è½½å°è¯´ï¼ŒPythonä¸‹è½½è¡¨æ ¼æ•°æ®ï¼Œåœ¨Pythonä¸‹è½½å°è¯´é‡Œé¢ï¼Œåˆå­¦ä¹ äº†æ­£åˆ™è¡¨è¾¾å¼çš®æ¯›ï¼Œ Pythonä¸‹è½½è¡¨æ ¼æ•°æ®ä¸­ï¼Œåˆå­¦ä¹ äº†bs4çš„çš®æ¯›ï¼Œæ•´ç†äº†ä»Šå¤©çš„æˆæœå†™æˆäº†åšå®¢è¿›è¡Œè®°å½•Pythonçˆ¬è™«å¿«é€Ÿå…¥é—¨(https:&#47;&#47;blog.csdn.net&#47;wuzhongqiang&#47;article&#47;details&#47;104119800)ã€‚  ä¸Šé¢æœ‰è¿™èŠ‚è¯¾çš„è¯¦ç»†ç¬”è®°å’Œå››ä¸ªå°å®æˆ˜é¡¹ç›®ï¼Œæ„Ÿå…´è¶£çš„å¯ä»¥å‚è€ƒå‚è€ƒã€‚ ä»Šå¤©æ”¶è·æŒºå¤§ã€‚<br><br><br>è¿è¡Œä»£ç æ€»æ˜¯å‡ºé”™ï¼šJSONDecodeError: Expecting value: line 1 column 1 (char 0)ï¼Œè¿™ä¸ªæ€ä¹ˆè§£å†³ï¼Ÿ <br>é¦–å…ˆè¿›è¡Œè¾“å‡ºè°ƒè¯•ï¼Œè¾“å‡ºäº†ä¸€ä¸‹htmlè¿™ä¸ªå˜é‡ï¼Œä¹Ÿå°±æ˜¯reques.get(url).text è¿™ä¸ªå˜é‡ï¼Œå‘ç°è¿”å›çš„ç«Ÿç„¶æ˜¯ç©ºã€‚ é‚£è‚¯å®šjson.loadsçš„æ—¶å€™å‡ºé”™å•Šï¼Œæ‰€ä»¥é—®é¢˜å°±åœ¨è¿™ï¼ŒæŸ¥äº†ä¸€ä¸‹èµ„æ–™ï¼Œè™½ç„¶ä¸çŸ¥é“ä»€ä¹ˆåŸå› ï¼Œä½†æ˜¯åŠ äº†ä¸€ä¸ªè¯·æ±‚å¤´å¥½äº†ã€‚ <br> <br>headers = {<br>    &#39;Cookie&#39;:&#39;OCSSID=4df0bjva6j7ejussu8al3eqo03&#39;,<br>    &#39;User-Agent&#39;:&#39;Mozilla&#47;5.0 (Windows NT 10.0; Win64; x64) AppleWebKit&#47;537.36&#39;<br>                 &#39; (KHTML, like Gecko) Chrome&#47;68.0.3440.106 Safari&#47;537.36&#39;,<br>}<br><br>ç„¶åï¼Œå†requests.get(url, headers=headers).text     è¿™ä¸ªé—®é¢˜å°±æå®šã€‚<br><br>","like_count":4,"discussions":[{"author":{"id":2037505,"avatar":"https://static001.geekbang.org/account/avatar/00/1f/17/01/1c5309a3.jpg","nickname":"McKee Chen","note":"","ucode":"F74B76542FAB65","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":345506,"discussion_content":"æœç„¶è§£å†³äº†ï¼Œæ¥¼ä¸»å‰å®³","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1611730069,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1505907,"avatar":"https://static001.geekbang.org/account/avatar/00/16/fa/73/3b9cbc69.jpg","nickname":"VictorWu","note":"","ucode":"94AA2A957CFA85","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":335344,"discussion_content":"é‡åˆ°åŒæ ·é—®é¢˜ï¼Œè°¢è°¢è§£ç­”","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1608170952,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":161703,"user_name":"Geek_2008d9","can_delete":false,"product_type":"c1","uid":1783634,"ip_address":"","ucode":"12F1A8B98AD5F7","user_header":"https://static001.geekbang.org/account/avatar/00/1b/37/52/c1c56b6f.jpg","comment_is_top":false,"comment_ctime":1576302653,"is_pvip":false,"replies":[{"id":"62609","content":"JSONè§£æé”™è¯¯ï¼Œå¯ä»¥ä½¿ç”¨try ... except ... æ•è·ä¸‹é”™è¯¯çœ‹çœ‹","user_name":"ä½œè€…å›å¤","comment_id":161703,"uid":"1306094","ip_address":"","utype":1,"ctime":1577074182,"user_name_real":"cy"}],"discussion_count":3,"race_medal":0,"score":"18756171837","product_id":100021701,"comment_content":"ä¸ºä»€ä¹ˆæˆ‘æ€»æ˜¯response=json.loadsé‚£ä¸€è¡Œæ˜¾ç¤ºjson.decoder.JSONDecoderError:expecting value:line 1 column 1(char 0) å‘¢ï¼Œæ€ä¹ˆè§£å†³å•Šï¼Œå„ä½å¤§ä½¬","like_count":4,"discussions":[{"author":{"id":1306094,"avatar":"https://static001.geekbang.org/account/avatar/00/13/ed/ee/c4779b67.jpg","nickname":"cy","note":"","ucode":"50D653399A31F6","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":477821,"discussion_content":"JSONè§£æé”™è¯¯ï¼Œå¯ä»¥ä½¿ç”¨try ... except ... æ•è·ä¸‹é”™è¯¯çœ‹çœ‹","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1577074182,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1222119,"avatar":"https://static001.geekbang.org/account/avatar/00/12/a5/e7/815acbf7.jpg","nickname":"warm_day","note":"","ucode":"3CD078E809497C","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":127043,"discussion_content":"# coding:utf-8\nimport requests\nimport json\n\nquery = &#39;ç‹ç¥–è´¤&#39;\n&#39;&#39;&#39; ä¸‹è½½å›¾ç‰‡ &#39;&#39;&#39;\n\n\ndef download(src, id):\n    dir = &#39;./&#39; + str(id) + &#39;.jpg&#39;\n    try:\n        pic = requests.get(src, timeout=10)\n        fp = open(dir, &#39;wb&#39;)\n        fp.write(pic.content)\n        fp.close()\n    except requests.exceptions.ConnectionError:\n        print(&#39;å›¾ç‰‡æ— æ³•ä¸‹è½½&#39;)\n\n\n&#39;&#39;&#39; for å¾ªç¯ è¯·æ±‚å…¨éƒ¨çš„ url &#39;&#39;&#39;\nfor i in range(0, 60, 20):\n    url = &#34;https://www.douban.com/j/search_photo?q=&#34; + query + &#34;&amp;limit=20&amp;start=&#34; + str(i)\n    print(url)\n    html = requests.get(url=url, headers={\n    &#34;Host&#34;: &#34;www.douban.com&#34;,\n    &#34;Connection&#34;: &#34;keep-alive&#34;,\n    &#34;Cache-Control&#34;: &#34;max-age=0&#34;,\n    &#34;Upgrade-Insecure-Requests&#34;: &#34;1&#34;,\n    &#34;User-Agent&#34;: &#34;Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/75.0.3770.142 Safari/537.36&#34;,\n    &#34;Accept&#34;: &#34;text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3&#34;,\n    &#34;Accept-Encoding&#34;: &#34;gzip, deflate&#34;,\n    &#34;Accept-Language&#34;: &#34;zh-CN,zh;q=0.9&#34;,\n    &#34;Cookie&#34;: &#34;_vwo_uuid_v2=DE81BD2137D14D63DD42F3DDA8A5985E8|15a55c5fefbfcb39af21944efc459ce3; douban-fav-remind=1; _ga=GA1.2.410204347.15382292&#34;,\n\n}).text # å¾—åˆ°è¿”å›ç»“æœ\n    try:\n        response = json.loads(html, encoding=&#39;utf-8&#39;)\n        for image in response[&#39;images&#39;]:\n            print(image[&#39;src&#39;])  # æŸ¥çœ‹å½“å‰ä¸‹è½½çš„å›¾ç‰‡ç½‘å€\n            download(image[&#39;src&#39;], image[&#39;id&#39;])\n    except:\n       print(&#34;è§£æé”™è¯¯&#34;)  # å°† JSON æ ¼å¼è½¬æ¢æˆ Python å¯¹è±¡\n\n# ä¸‹è½½ä¸€å¼ å›¾ç‰‡\n","likes_number":1,"is_delete":false,"is_hidden":false,"ctime":1578562173,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1222119,"avatar":"https://static001.geekbang.org/account/avatar/00/12/a5/e7/815acbf7.jpg","nickname":"warm_day","note":"","ucode":"3CD078E809497C","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":127044,"discussion_content":"æˆ‘ç”¨çš„python3,ä½ å¯ä»¥åœ¨getè¯·æ±‚ä¸­æ·»åŠ headeaså‚æ•° ","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1578562209,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":159457,"user_name":"Geek_c45626","can_delete":false,"product_type":"c1","uid":1693669,"ip_address":"","ucode":"86B91D63956FBA","user_header":"","comment_is_top":false,"comment_ctime":1575627074,"is_pvip":false,"replies":[{"id":"62608","content":"å¯ä»¥ä½¿ç”¨ try ... except ... æ•è·ä¸‹é”™è¯¯çœ‹çœ‹","user_name":"ä½œè€…å›å¤","comment_id":159457,"uid":"1306094","ip_address":"","utype":1,"ctime":1577074104,"user_name_real":"cy"}],"discussion_count":7,"race_medal":0,"score":"14460528962","product_id":100021701,"comment_content":"è€å¸ˆï¼Œè¿è¡Œä»£ç æ€»æ˜¯å‡ºé”™ï¼šJSONDecodeError: Expecting value: line 1 column 1 (char 0)ï¼Œè¿™ä¸ªæ€ä¹ˆè§£å†³ï¼Ÿ","like_count":3,"discussions":[{"author":{"id":1306094,"avatar":"https://static001.geekbang.org/account/avatar/00/13/ed/ee/c4779b67.jpg","nickname":"cy","note":"","ucode":"50D653399A31F6","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":477067,"discussion_content":"å¯ä»¥ä½¿ç”¨ try ... except ... æ•è·ä¸‹é”™è¯¯çœ‹çœ‹","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1577074104,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1222119,"avatar":"https://static001.geekbang.org/account/avatar/00/12/a5/e7/815acbf7.jpg","nickname":"warm_day","note":"","ucode":"3CD078E809497C","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":127041,"discussion_content":"# coding:utf-8\nimport requests\nimport json\n\nquery = &#39;ç‹ç¥–è´¤&#39;\n&#39;&#39;&#39; ä¸‹è½½å›¾ç‰‡ &#39;&#39;&#39;\n\n\ndef download(src, id):\n    dir = &#39;./&#39; + str(id) + &#39;.jpg&#39;\n    try:\n        pic = requests.get(src, timeout=10)\n        fp = open(dir, &#39;wb&#39;)\n        fp.write(pic.content)\n        fp.close()\n    except requests.exceptions.ConnectionError:\n        print(&#39;å›¾ç‰‡æ— æ³•ä¸‹è½½&#39;)\n\n\n&#39;&#39;&#39; for å¾ªç¯ è¯·æ±‚å…¨éƒ¨çš„ url &#39;&#39;&#39;\nfor i in range(0, 60, 20):\n    url = &#34;https://www.douban.com/j/search_photo?q=&#34; + query + &#34;&amp;limit=20&amp;start=&#34; + str(i)\n    print(url)\n    html = requests.get(url=url, headers={\n    &#34;Host&#34;: &#34;www.douban.com&#34;,\n    &#34;Connection&#34;: &#34;keep-alive&#34;,\n    &#34;Cache-Control&#34;: &#34;max-age=0&#34;,\n    &#34;Upgrade-Insecure-Requests&#34;: &#34;1&#34;,\n    &#34;User-Agent&#34;: &#34;Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/75.0.3770.142 Safari/537.36&#34;,\n    &#34;Accept&#34;: &#34;text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3&#34;,\n    &#34;Accept-Encoding&#34;: &#34;gzip, deflate&#34;,\n    &#34;Accept-Language&#34;: &#34;zh-CN,zh;q=0.9&#34;,\n    &#34;Cookie&#34;: &#34;_vwo_uuid_v2=DE81BD2137D14D63DD42F3DDA8A5985E8|15a55c5fefbfcb39af21944efc459ce3; douban-fav-remind=1; _ga=GA1.2.410204347.15382292&#34;,\n\n}).text # å¾—åˆ°è¿”å›ç»“æœ\n    try:\n        response = json.loads(html, encoding=&#39;utf-8&#39;)\n        for image in response[&#39;images&#39;]:\n            print(image[&#39;src&#39;])  # æŸ¥çœ‹å½“å‰ä¸‹è½½çš„å›¾ç‰‡ç½‘å€\n            download(image[&#39;src&#39;], image[&#39;id&#39;])\n    except:\n       print(&#34;è§£æé”™è¯¯&#34;)  # å°† JSON æ ¼å¼è½¬æ¢æˆ Python å¯¹è±¡\n\n# ä¸‹è½½ä¸€å¼ å›¾ç‰‡\n","likes_number":2,"is_delete":false,"is_hidden":false,"ctime":1578562104,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1222119,"avatar":"https://static001.geekbang.org/account/avatar/00/12/a5/e7/815acbf7.jpg","nickname":"warm_day","note":"","ucode":"3CD078E809497C","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":127042,"discussion_content":"æˆ‘ç”¨çš„python3,ç”¨æ­¤æ–¹æ³•ï¼Œéœ€è¦æ·»åŠ headers","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1578562156,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1068361,"avatar":"https://static001.geekbang.org/account/avatar/00/10/4d/49/28e73b9c.jpg","nickname":"æ˜ç¿¼","note":"","ucode":"E77F86BEB3D5C1","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":92159,"discussion_content":"é¢ã€æˆ‘ä¹Ÿé‡åˆ°äº†è§£å†³äº†å—ï¼Ÿhtmlå†…å®¹æ‰“å°åˆæŠ¥ç¼–ç é”™è¯¯ï¼Œï¼Œå“","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1576853309,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":3,"child_discussions":[{"author":{"id":1527138,"avatar":"https://static001.geekbang.org/account/avatar/00/17/4d/62/0fe9cbb3.jpg","nickname":"Williamï½Zhang","note":"","ucode":"8659B589428F11","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":1068361,"avatar":"https://static001.geekbang.org/account/avatar/00/10/4d/49/28e73b9c.jpg","nickname":"æ˜ç¿¼","note":"","ucode":"E77F86BEB3D5C1","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":182692,"discussion_content":"html = requests.get(url=url,headers={\n        &#34;User-Agent&#34;: &#34;Mozilla/5.0 (Macintosh; Intel Mac OS X 10_13_6) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/79.0.3945.130 Safari/537.36&#34;\n    }).text","likes_number":4,"is_delete":false,"is_hidden":false,"ctime":1582448448,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":92159,"ip_address":""},"score":182692,"extra":""},{"author":{"id":1659590,"avatar":"https://static001.geekbang.org/account/avatar/00/19/52/c6/8eb48963.jpg","nickname":"ä¸€çº¸ä¹¦","note":"","ucode":"C58A22B54521CA","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":1527138,"avatar":"https://static001.geekbang.org/account/avatar/00/17/4d/62/0fe9cbb3.jpg","nickname":"Williamï½Zhang","note":"","ucode":"8659B589428F11","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":226145,"discussion_content":"è¯•äº†ä¸‹,è§£å†³é—®é¢˜äº†\n","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1586424938,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":182692,"ip_address":""},"score":226145,"extra":""},{"author":{"id":1236695,"avatar":"https://static001.geekbang.org/account/avatar/00/12/de/d7/14410058.jpg","nickname":"æºªæ¡¥","note":"","ucode":"9DBA138C72C741","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":1527138,"avatar":"https://static001.geekbang.org/account/avatar/00/17/4d/62/0fe9cbb3.jpg","nickname":"Williamï½Zhang","note":"","ucode":"8659B589428F11","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":260843,"discussion_content":"è°¢è°¢å¤§ä½¬","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1588907290,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":182692,"ip_address":""},"score":260843,"extra":""}]}]},{"had_liked":false,"id":148319,"user_name":"qinggeouye","can_delete":false,"product_type":"c1","uid":1251536,"ip_address":"","ucode":"5B53EEDD7BEC9C","user_header":"https://static001.geekbang.org/account/avatar/00/13/18/d0/49b06424.jpg","comment_is_top":false,"comment_ctime":1572978525,"is_pvip":false,"replies":[{"id":"63768","content":"Good Job","user_name":"ä½œè€…å›å¤","comment_id":148319,"uid":"1306094","ip_address":"","utype":1,"ctime":1577540876,"user_name_real":"cy"}],"discussion_count":1,"race_medal":0,"score":"14457880413","product_id":100021701,"comment_content":"https:&#47;&#47;github.com&#47;qinggeouye&#47;GeekTime&#47;blob&#47;master&#47;DataAnalysis&#47;10_crawl_xpath.py<br><br>import os<br>import requests<br>from lxml import etree<br>from selenium import webdriver<br><br>search_text = &#39;ç‹ç¥–è´¤&#39;<br>start = 0  # è¯·æ±‚ url çš„ start ä» 0 å¼€å§‹ï¼Œæ¯ä¸€é¡µé—´éš” 15ï¼Œæœ‰ 6 é¡µ<br>total = 90<br>limit = 15<br><br># ç”µå½±æµ·æŠ¥å›¾ç‰‡åœ°å€<br>src_xpath = &quot;&#47;&#47;div[@class=&#39;item-root&#39;]&#47;a[@class=&#39;cover-link&#39;]&#47;img[@class=&#39;cover&#39;]&#47;@src&quot;<br># ç”µå½±æµ·æŠ¥å›¾ç‰‡title<br>title_xpath = &quot;&#47;&#47;div[@class=&#39;item-root&#39;]&#47;div[@class=&#39;detail&#39;]&#47;div[@class=&#39;title&#39;]&#47;a[@class=&#39;title-text&#39;]&quot;<br><br># ä¿å­˜ç›®å½•<br>pic_path = &#39;10&#47;xpath&#39;  # ç›¸å¯¹ç›®å½•<br># WebDriver åˆ›å»ºä¸€ä¸ª Chrome æµè§ˆå™¨çš„ drive<br>driver = webdriver.Chrome(&#39;.&#47;chromedriver&#39;)  # MAC ç‰ˆæœ¬<br><br><br># åˆ›å»ºå›¾ç‰‡ä¿å­˜è·¯å¾„<br>def mk_save_path(pic_path_):<br>    if not os.path.exists(pic_path_):<br>        os.makedirs(pic_path_)<br>    return os.getcwd() + &#39;&#47;&#39; + pic_path_ + &#39;&#47;&#39;<br><br><br># ä¸‹è½½å›¾ç‰‡<br>def download(src, pic_id, save_path_):<br>    directory = save_path_ + str(pic_id) + &#39;.jpg&#39;<br>    try:<br>        pic = requests.get(src, timeout=10)<br>        fp = open(directory, &#39;wb&#39;)<br>        fp.write(pic.content)<br>        fp.close()<br>    except requests.exceptions.ConnectionError:<br>        print(&#39;å›¾ç‰‡å¦‚æ— æ³•ä¸‹è½½&#39;)<br><br><br>def get_response_xpath():<br>    save_path = mk_save_path(pic_path)<br>    for i in range(start, total, limit):<br>        requests_url = &#39;https:&#47;&#47;search.douban.com&#47;movie&#47;subject_search?search_text=&#39; + search_text + &#39;&amp;cat=1002&#39; + \\<br>                       &#39;&amp;start=&#39; + str(i)<br>        driver.get(url=requests_url)<br>        html = etree.HTML(driver.page_source)<br>        src_list = html.xpath(src_xpath)<br>        title_list = html.xpath(title_xpath)<br>        for src, title in zip(src_list, title_list):<br>            download(src, title.text, save_path)<br><br><br>if __name__ == &#39;__main__&#39;:<br>    get_response_xpath()","like_count":3,"discussions":[{"author":{"id":1306094,"avatar":"https://static001.geekbang.org/account/avatar/00/13/ed/ee/c4779b67.jpg","nickname":"cy","note":"","ucode":"50D653399A31F6","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":473459,"discussion_content":"Good Job","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1577540876,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":56824,"user_name":"Yezhiwei","can_delete":false,"product_type":"c1","uid":1005157,"ip_address":"","ucode":"31E8E33688CBEC","user_header":"https://static001.geekbang.org/account/avatar/00/0f/56/65/22a37a8e.jpg","comment_is_top":false,"comment_ctime":1546564847,"is_pvip":false,"replies":[{"id":"21388","content":"ç½‘ç«™çš„æŠ“å–å’Œç½‘é¡µçš„HTMLç»“æ„æœ‰å¾ˆå¤§å…³ç³»ï¼Œæ‰€ä»¥ä¸€èˆ¬éƒ½æ˜¯ç”¨XPathè§£æï¼Œå¦‚æœä½ ç”¨ç¬¬ä¸‰æ–¹å·¥å…·ï¼Œæ¯”å¦‚å…«çˆªé±¼ï¼Œä¹Ÿæ˜¯è¦ä¸ªæ€§åŒ–çš„æŠŠæ¯ä¸ªç½‘ç«™æµç¨‹æ¨¡æ‹Ÿå‡ºæ¥ï¼Œè¿™æ ·å·¥å…·ä¼šè‡ªåŠ¨å®šä½XPath<br>ç½‘ç«™çš„æŠ“å–å’Œç½‘é¡µçš„HTMLç»“æ„æœ‰å¾ˆå¤§å…³ç³»ï¼Œæ‰€ä»¥ä¸€èˆ¬éƒ½æ˜¯ç”¨XPathè§£æï¼Œå¦‚æœä½ ç”¨ç¬¬ä¸‰æ–¹å·¥å…·ï¼Œæ¯”å¦‚å…«çˆªé±¼ï¼Œä¹Ÿæ˜¯è¦ä¸ªæ€§åŒ–çš„æŠŠæ¯ä¸ªç½‘ç«™æµç¨‹æ¨¡æ‹Ÿå‡ºæ¥ï¼Œè¿™æ ·å·¥å…·ä¼šè‡ªåŠ¨å®šä½XPath<br>å¦‚æœæƒ³è¦åšä¸€ä¸ªé€šç”¨çš„è§£å†³æ–¹æ¡ˆï¼Œè‡ªåŠ¨è¯†åˆ«æ–‡ç« çš„æ ‡é¢˜å’Œå†…å®¹ã€‚å°±éœ€è¦å…ˆæŠŠHTMLä¸‹è½½ä¸‹æ¥ï¼Œç„¶åå°†HTMLè§£æä¸ºDOMæ ‘ï¼Œå†å¯¹æ¯ä¸ªèŠ‚ç‚¹åšè¯„ä¼°ï¼ˆæ–‡ç« æ ‡é¢˜è¿˜æ˜¯å†…å®¹çš„å¯èƒ½æ€§ï¼‰<br>è¿™æ ·åšçš„å¥½å¤„æ˜¯é€šç”¨æ€§å¼ºï¼Œç¼ºç‚¹å°±æ˜¯å¯èƒ½ä¼šå‡ºé”™ã€‚","user_name":"ä½œè€…å›å¤","comment_id":56824,"uid":"1306094","ip_address":"","utype":1,"ctime":1547353722,"user_name_real":"cy"}],"discussion_count":1,"race_medal":0,"score":"14431466735","product_id":100021701,"comment_content":"ç”¨Scrapyçˆ¬å–æ•°æ®æ›´æ–¹ä¾¿å“ˆï¼Œè¯·é—®è€å¸ˆæ€ä¹ˆåšä¸€ä¸ªé€šç”¨çš„çˆ¬è™«å‘¢ï¼Ÿæ¯”å¦‚è¦çˆ¬å–æ–‡ç« æ ‡é¢˜å’Œå†…å®¹ï¼Œä¸åŒçš„ç½‘ç«™Xpathç»“æ„ä¸ä¸€æ ·ï¼Œå¦‚æœæºå°‘çš„è¯å¯ä»¥åˆ†åˆ«é…ç½®ï¼Œä½†å¦‚æœè¦çˆ¬å–å‡ ç™¾ä¸Šåƒçš„ç½‘ç«™æ•°æ®ï¼Œåˆ†åˆ«é…ç½®XpathæŒºéº»çƒ¦çš„ã€‚è¯·é—®è¿™ä¸ªé—®é¢˜æœ‰ä»€ä¹ˆè§£å†³æ–¹æ¡ˆå—ï¼Ÿè°¢è°¢","like_count":3,"discussions":[{"author":{"id":1306094,"avatar":"https://static001.geekbang.org/account/avatar/00/13/ed/ee/c4779b67.jpg","nickname":"cy","note":"","ucode":"50D653399A31F6","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":435258,"discussion_content":"ç½‘ç«™çš„æŠ“å–å’Œç½‘é¡µçš„HTMLç»“æ„æœ‰å¾ˆå¤§å…³ç³»ï¼Œæ‰€ä»¥ä¸€èˆ¬éƒ½æ˜¯ç”¨XPathè§£æï¼Œå¦‚æœä½ ç”¨ç¬¬ä¸‰æ–¹å·¥å…·ï¼Œæ¯”å¦‚å…«çˆªé±¼ï¼Œä¹Ÿæ˜¯è¦ä¸ªæ€§åŒ–çš„æŠŠæ¯ä¸ªç½‘ç«™æµç¨‹æ¨¡æ‹Ÿå‡ºæ¥ï¼Œè¿™æ ·å·¥å…·ä¼šè‡ªåŠ¨å®šä½XPath\nç½‘ç«™çš„æŠ“å–å’Œç½‘é¡µçš„HTMLç»“æ„æœ‰å¾ˆå¤§å…³ç³»ï¼Œæ‰€ä»¥ä¸€èˆ¬éƒ½æ˜¯ç”¨XPathè§£æï¼Œå¦‚æœä½ ç”¨ç¬¬ä¸‰æ–¹å·¥å…·ï¼Œæ¯”å¦‚å…«çˆªé±¼ï¼Œä¹Ÿæ˜¯è¦ä¸ªæ€§åŒ–çš„æŠŠæ¯ä¸ªç½‘ç«™æµç¨‹æ¨¡æ‹Ÿå‡ºæ¥ï¼Œè¿™æ ·å·¥å…·ä¼šè‡ªåŠ¨å®šä½XPath\nå¦‚æœæƒ³è¦åšä¸€ä¸ªé€šç”¨çš„è§£å†³æ–¹æ¡ˆï¼Œè‡ªåŠ¨è¯†åˆ«æ–‡ç« çš„æ ‡é¢˜å’Œå†…å®¹ã€‚å°±éœ€è¦å…ˆæŠŠHTMLä¸‹è½½ä¸‹æ¥ï¼Œç„¶åå°†HTMLè§£æä¸ºDOMæ ‘ï¼Œå†å¯¹æ¯ä¸ªèŠ‚ç‚¹åšè¯„ä¼°ï¼ˆæ–‡ç« æ ‡é¢˜è¿˜æ˜¯å†…å®¹çš„å¯èƒ½æ€§ï¼‰\nè¿™æ ·åšçš„å¥½å¤„æ˜¯é€šç”¨æ€§å¼ºï¼Œç¼ºç‚¹å°±æ˜¯å¯èƒ½ä¼šå‡ºé”™ã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1547353722,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":159455,"user_name":"Geek_c45626","can_delete":false,"product_type":"c1","uid":1693669,"ip_address":"","ucode":"86B91D63956FBA","user_header":"","comment_is_top":false,"comment_ctime":1575626843,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"10165561435","product_id":100021701,"comment_content":"è¿è¡Œä»£ç æ€»æ˜¯å‡ºç°é”™è¯¯ï¼šJSONDecodeError: Expecting value: line 1 column 1 (char 0)","like_count":2},{"had_liked":false,"id":70681,"user_name":"çˆ±å–é…¸å¥¶çš„ç¨‹åºå‘˜","can_delete":false,"product_type":"c1","uid":1274352,"ip_address":"","ucode":"3FDB0AC2854274","user_header":"https://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTJjiaBHJyfAKK02CCcibkqI0jpaHJEcyrTRI4xbrqHCWiaia88WQs4r8zJVmHfibqricUYeUT2ezAZAC7wQ/132","comment_is_top":false,"comment_ctime":1551163003,"is_pvip":false,"replies":[{"id":"64503","content":"å¯ä»¥ç”¨ æ— ç•Œé¢çš„puppetteer ","user_name":"ä½œè€…å›å¤","comment_id":70681,"uid":"1306094","ip_address":"","utype":1,"ctime":1577620166,"user_name_real":"cy"}],"discussion_count":1,"race_medal":0,"score":"10141097595","product_id":100021701,"comment_content":"æœ‰ä¸ªé—®é¢˜seleniumï¼Œæ˜¯ç”¨æ¥è‡ªåŠ¨åŒ–æµ‹è¯•çš„ï¼Œä»–å›æ‰“å¼€æµè§ˆå™¨â€¦â€¦æˆ‘åšçˆ¬è™«æ˜¯ä¸æƒ³è®©ä»£ç æ‰“å¼€æµè§ˆå™¨ï¼Œåªæƒ³è¦ä»–çˆ¬å–çš„åŠ¨ä½œï½è¦æ€ä¹ˆåŠå‘¢ï¼Ÿ","like_count":2,"discussions":[{"author":{"id":1306094,"avatar":"https://static001.geekbang.org/account/avatar/00/13/ed/ee/c4779b67.jpg","nickname":"cy","note":"","ucode":"50D653399A31F6","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":440767,"discussion_content":"å¯ä»¥ç”¨ æ— ç•Œé¢çš„puppetteer ","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1577620166,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":57291,"user_name":"ldw","can_delete":false,"product_type":"c1","uid":1339627,"ip_address":"","ucode":"51B0DE3F6FE278","user_header":"https://static001.geekbang.org/account/avatar/00/14/70/eb/e7a2dba9.jpg","comment_is_top":false,"comment_ctime":1546731668,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"10136666260","product_id":100021701,"comment_content":"å¯ä»¥ç”¨çˆ¬è™«çˆ¬è°·æ­Œå—ï¼Ÿä¼šä¸ä¼šè¢«å½“æˆæ¶æ„æ”»å‡»ï¼Ÿä¸ä¼šå¼•æ¥å›½é™…å®˜å¸å§ã€‚","like_count":2},{"had_liked":false,"id":196577,"user_name":"åå…­ã€‚","can_delete":false,"product_type":"c1","uid":1935100,"ip_address":"","ucode":"DD4A02E3D904D5","user_header":"","comment_is_top":false,"comment_ctime":1585294290,"is_pvip":false,"replies":[{"id":"104224","content":"åŠ æ²¹å“¦ï¼","user_name":"ä½œè€…å›å¤","user_name_real":"cy","uid":"1306094","ctime":1617731580,"ip_address":"","comment_id":196577,"utype":1}],"discussion_count":1,"race_medal":0,"score":"5880261586","product_id":100021701,"comment_content":"ç”±äºpythonå­¦ä¹ æ˜¯çˆ¬è™«ä¸Šæ‰‹çš„ï¼Œçˆ¬è™«è¿˜æ˜¯ä¼šä¸€ç‚¹çš„ï¼Œå“ˆå“ˆï¼Œå»ä¸‹ä¸€ç« äº†áƒ¦( Â´ï½¥á´—ï½¥` )","like_count":1,"discussions":[{"author":{"id":1306094,"avatar":"https://static001.geekbang.org/account/avatar/00/13/ed/ee/c4779b67.jpg","nickname":"cy","note":"","ucode":"50D653399A31F6","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":489334,"discussion_content":"åŠ æ²¹å“¦ï¼","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1617731580,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":179792,"user_name":"é™ˆé‡‘é‘«","can_delete":false,"product_type":"c1","uid":1077127,"ip_address":"","ucode":"609A24832CA80C","user_header":"https://static001.geekbang.org/account/avatar/00/10/6f/87/669263b4.jpg","comment_is_top":false,"comment_ctime":1582100291,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"5877067587","product_id":100021701,"comment_content":"è¯·é—®è€å¸ˆä»£ç çš„GitHubåœ°å€æ˜¯å•¥ï¼Ÿ","like_count":1},{"had_liked":false,"id":164164,"user_name":"æ˜ç¿¼","can_delete":false,"product_type":"c1","uid":1068361,"ip_address":"","ucode":"E77F86BEB3D5C1","user_header":"https://static001.geekbang.org/account/avatar/00/10/4d/49/28e73b9c.jpg","comment_is_top":false,"comment_ctime":1576897675,"is_pvip":false,"replies":[{"id":"62580","content":"ä¸é”™~ é“¾æ¥å·²å¤±æ•ˆï¼Œå¯ä»¥æŠŠæ–‡ç« åç§°å‘å‡ºæ¥","user_name":"ä½œè€…å›å¤","user_name_real":"cy","uid":"1306094","ctime":1577070792,"ip_address":"","comment_id":164164,"utype":1}],"discussion_count":3,"race_medal":0,"score":"5871864971","product_id":100021701,"comment_content":"æˆ‘åœ¨å®è·µè¿™ç¯‡è¿‡ç¨‹ä¸­é‡åˆ°äº†å¾ˆå¤šé—®é¢˜ï¼Œæœ€ç»ˆè§£å†³äº†ï¼Œå†™åœ¨æˆ‘çš„å…¬ä¼—å·é‡Œé¢ï¼Œè¿è¡Œä»£ç æœ‰é—®é¢˜çš„åŒå­¦å¯ä»¥å‚è€ƒä¸‹ï¼š<br>https:&#47;&#47;mp.weixin.qq.com&#47;s?__biz=MjM5OTE4MzcyNA==&amp;tempkey=MTA0MF95UW5FRmVZZURiWVR2ZWZiZVVaUEctS3FhUF90OVljc3RZTEV6eHpKSjF3NlpxMjhMcXdoU2trV2Y1RzdCQXZQamptXzZTODZNbGw0U3ZmMlhzT1BFOWZWeXhaOTM3bHFITjl6dVBLbUxfSlI4ZG15bFpvYnpvUTJienlKOWx2M0V1QURvZWVZUU1rTVRudk96WXZTb01qekdEWmJhaW5zMDd3OFB3fn4%3D&amp;chksm=3f29d0a1085e59b7d37190f6e8580bc03526dca518fc70e844a76ae1a571bc90d88ac52acc88#rd","like_count":1,"discussions":[{"author":{"id":1306094,"avatar":"https://static001.geekbang.org/account/avatar/00/13/ed/ee/c4779b67.jpg","nickname":"cy","note":"","ucode":"50D653399A31F6","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":478665,"discussion_content":"ä¸é”™~ é“¾æ¥å·²å¤±æ•ˆï¼Œå¯ä»¥æŠŠæ–‡ç« åç§°å‘å‡ºæ¥","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1577070792,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1068361,"avatar":"https://static001.geekbang.org/account/avatar/00/10/4d/49/28e73b9c.jpg","nickname":"æ˜ç¿¼","note":"","ucode":"E77F86BEB3D5C1","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":93092,"discussion_content":"https://mp.weixin.qq.com/s/y16eg0LY4vqLluxmw8UmOA","likes_number":1,"is_delete":false,"is_hidden":false,"ctime":1576906392,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1068361,"avatar":"https://static001.geekbang.org/account/avatar/00/10/4d/49/28e73b9c.jpg","nickname":"æ˜ç¿¼","note":"","ucode":"E77F86BEB3D5C1","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":93093,"discussion_content":"è¿™ä¸ªåœ°å€åŸæ¥åœ°å€å¥½é•¿â€¦â€¦","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1576906407,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":147790,"user_name":"qinggeouye","can_delete":false,"product_type":"c1","uid":1251536,"ip_address":"","ucode":"5B53EEDD7BEC9C","user_header":"https://static001.geekbang.org/account/avatar/00/13/18/d0/49b06424.jpg","comment_is_top":false,"comment_ctime":1572889950,"is_pvip":false,"replies":[{"id":"62684","content":"èµ è®¤çœŸç»ƒä¹ &amp;åˆ†äº«çš„åŒå­¦","user_name":"ä½œè€…å›å¤","user_name_real":"cy","uid":"1306094","ctime":1577084367,"ip_address":"","comment_id":147790,"utype":1}],"discussion_count":2,"race_medal":0,"score":"5867857246","product_id":100021701,"comment_content":"https:&#47;&#47;github.com&#47;qinggeouye&#47;GeekTime&#47;blob&#47;master&#47;DataAnalysis&#47;10_crawl.py<br><br># coding: utf-8<br>import os<br><br>import requests<br>import json<br><br><br># ä¸‹è½½å›¾ç‰‡<br>def download(src, pic_id, save_path_):<br>    directory = save_path_ + str(pic_id) + &#39;.jpg&#39;<br><br>    try:<br>        pic = requests.get(src, timeout=10)<br>        fp = open(directory, &#39;wb&#39;)<br>        fp.write(pic.content)<br>        fp.close()<br>    except requests.exceptions.ConnectionError:<br>        print(&#39;å›¾ç‰‡å¦‚æ— æ³•ä¸‹è½½&#39;)<br><br><br># è·å–è¿”å›é¡µé¢å†…å®¹<br>def get_resp(query_, limit_, start_):<br>    url_ = &#39;https:&#47;&#47;www.douban.com&#47;j&#47;search_photo?q=&#39; + query_ + &#39;&amp;limit=&#39; + str(limit_) + &#39;&amp;start=&#39; + str(start_)<br>    html_ = requests.get(url_).text  # å¾—åˆ°è¿”å›ç»“æœ<br>    response_ = json.loads(html_, encoding=&#39;utf-8&#39;)  # å°† JSON æ ¼å¼è½¬æ¢ä¸º Python å¯¹è±¡<br>    return response_<br><br><br>query = &#39;ç‹ç¥–è´¤&#39;<br>limit = 20<br>start = 0<br><br>&#39;&#39;&#39; è·å–å›¾ç‰‡æ€»æ•°é‡ &#39;&#39;&#39;<br>total = get_resp(query, limit, start)[&#39;total&#39;]<br>print(total)<br><br>pic_path = &#39;10&#39;  # ç›¸å¯¹ç›®å½•<br>if not os.path.exists(pic_path):<br>    os.mkdir(pic_path)<br>save_path = os.getcwd() + &#39;&#47;&#39; + pic_path + &#39;&#47;&#39;<br><br># å¾ªç¯ è¯·æ±‚å…¨éƒ¨çš„ url<br>for i in range(start, total, limit):<br>    response = get_resp(query, limit, i)<br>    for image in response[&#39;images&#39;]:<br>        print(image[&#39;src&#39;])  # æŸ¥çœ‹å½“å‰ä¸‹è½½çš„å›¾ç‰‡åœ°å€<br>        download(image[&#39;src&#39;], image[&#39;id&#39;], save_path)  # ä¸‹è½½ä¸€å¼ å›¾ç‰‡<br>","like_count":1,"discussions":[{"author":{"id":1306094,"avatar":"https://static001.geekbang.org/account/avatar/00/13/ed/ee/c4779b67.jpg","nickname":"cy","note":"","ucode":"50D653399A31F6","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":473307,"discussion_content":"èµ è®¤çœŸç»ƒä¹ &amp;amp;åˆ†äº«çš„åŒå­¦","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1577084367,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1251536,"avatar":"https://static001.geekbang.org/account/avatar/00/13/18/d0/49b06424.jpg","nickname":"qinggeouye","note":"","ucode":"5B53EEDD7BEC9C","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":44921,"discussion_content":"https://github.com/qinggeouye/GeekTime/blob/master/DataAnalysis/10_crawl_json.py","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1572978446,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":114571,"user_name":"å›¾Â·ç¾å…‹å°”","can_delete":false,"product_type":"c1","uid":1076720,"ip_address":"","ucode":"021FB5AE110066","user_header":"https://wx.qlogo.cn/mmopen/vi_32/DYAIOgq83eppQqDE6TNibvr3DNdxG323AruicIgWo5DpVr6U7yZVNkbF2rKluyDfhdpgAEcYEOZTAnbrMdTzFkUw/0","comment_is_top":false,"comment_ctime":1563341472,"is_pvip":false,"replies":[{"id":"63688","content":"è¿™ä¸ªä¹Ÿä¸é”™","user_name":"ä½œè€…å›å¤","user_name_real":"cy","uid":"1306094","ctime":1577528297,"ip_address":"","comment_id":114571,"utype":1}],"discussion_count":1,"race_medal":1,"score":"5858308768","product_id":100021701,"comment_content":"æˆ‘æ›´å–œæ¬¢ç”¨bs4ç¾å‘³æ±¤","like_count":1,"discussions":[{"author":{"id":1306094,"avatar":"https://static001.geekbang.org/account/avatar/00/13/ed/ee/c4779b67.jpg","nickname":"cy","note":"","ucode":"50D653399A31F6","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":458730,"discussion_content":"è¿™ä¸ªä¹Ÿä¸é”™","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1577528297,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":114418,"user_name":"dany","can_delete":false,"product_type":"c1","uid":1185926,"ip_address":"","ucode":"0990375202642F","user_header":"https://static001.geekbang.org/account/avatar/00/12/18/86/3599130b.jpg","comment_is_top":false,"comment_ctime":1563294468,"is_pvip":false,"replies":[{"id":"63693","content":"è¿™ä¸ªæ–‡ä»¶çš„å½“å‰ç›®å½•é‡Œæ‰¾ä¸‹","user_name":"ä½œè€…å›å¤","user_name_real":"cy","uid":"1306094","ctime":1577528410,"ip_address":"","comment_id":114418,"utype":1}],"discussion_count":1,"race_medal":0,"score":"5858261764","product_id":100021701,"comment_content":"downloadåˆ°å“ªé‡Œå»äº†ï¼Ÿä¸å¥½æ„æ€æˆ‘æ˜¯èœé¸Ÿ","like_count":1,"discussions":[{"author":{"id":1306094,"avatar":"https://static001.geekbang.org/account/avatar/00/13/ed/ee/c4779b67.jpg","nickname":"cy","note":"","ucode":"50D653399A31F6","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":458654,"discussion_content":"è¿™ä¸ªæ–‡ä»¶çš„å½“å‰ç›®å½•é‡Œæ‰¾ä¸‹","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1577528410,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":106341,"user_name":"ç™½è‰²çº¯åº¦","can_delete":false,"product_type":"c1","uid":1563854,"ip_address":"","ucode":"7ABC830EE468A1","user_header":"https://static001.geekbang.org/account/avatar/00/17/dc/ce/03fdeb60.jpg","comment_is_top":false,"comment_ctime":1561274243,"is_pvip":false,"replies":[{"id":"64034","content":"Good Job","user_name":"ä½œè€…å›å¤","user_name_real":"cy","uid":"1306094","ctime":1577607895,"ip_address":"","comment_id":106341,"utype":1}],"discussion_count":3,"race_medal":0,"score":"5856241539","product_id":100021701,"comment_content":"ç½‘å€ï¼šè±†ç“£ç”µå½±ï¼›ä»»åŠ¡ï¼šæ‰¹é‡ä¸‹è½½èµµä¸½é¢–ç”µå½±æµ·æŠ¥ï¼ˆæ”¯æŒç¿»é¡µï¼Œè‡ªå®šä¹‰ç»ˆæ­¢ä¸‹è½½é‡ï¼‰ï¼›python3.Xï¼›<br>æµè§ˆå™¨ï¼šGoogle Chrome ï¼›å”¯ä¸€è¦æ³¨æ„çš„æ˜¯webdriverçš„è·¯å¾„ã€‚å…¨éƒ½æ˜¯è¿™é—¨è¯¾ç¨‹é‡Œé¢çš„çŸ¥è¯†ç‚¹<br># -*- coding: utf-8 -*-<br>import requests<br>from lxml import etree<br>from selenium import webdriver<br>import os<br><br>name = &#39;èµµä¸½é¢–&#39;<br><br>def download(src, id):<br>    if not os.path.isdir(&quot;Xpathçš„ç¿»é¡µå›¾ç‰‡åŒ…&quot;):<br>        os.mkdir(&quot;Xpathçš„ç¿»é¡µå›¾ç‰‡åŒ…&quot;)<br>    dir = os.path.join(&quot;Xpathçš„ç¿»é¡µå›¾ç‰‡åŒ…&#47;&quot;, str(id) + &#39;.webp&#39;)<br>    try:<br>        pic = requests.get(src, timeout = 10)<br>        with open(dir, &#39;wb&#39;) as d:<br>            d.write(pic.content)<br>    except requests.exceptions.ConnectionError:<br>        print(&quot;å›¾ç‰‡æ— æ³•ä¸‹è½½&quot;)<br><br>def down_load(request_url):<br>    driver.get(request_url)<br>    html = etree.HTML(driver.page_source)<br>    src_xpath = &quot;&#47;&#47;div[@class=&#39;item-root&#39;]&#47;a[@class=&#39;cover-link&#39;]&#47;img[@class=&#39;cover&#39;]&#47;@src&quot;<br>    title_xpath = &quot;&#47;&#47;div[@class=&#39;item-root&#39;]&#47;div[@class=&#39;detail&#39;]&#47;div[@class=&#39;title&#39;]&#47;a[@class=&#39;title-text&#39;]&quot;<br>    srcs = html.xpath(src_xpath)<br><br><br>    titles = html.xpath(title_xpath)<br>    num = len(srcs)<br>    if num &gt; 15:<br>        srcs = srcs[1:]<br>        titles = titles[1:]<br><br>    for src, title in zip(srcs, titles):<br>        if title is None:<br>            continue<br>        print(src)<br>        download(src, title.text)<br>    print(&#39;OK&#39;)<br>    print(num)<br>    if num &gt;= 1:<br>        return True<br>    else:<br>        return False<br><br>if __name__ == &#39;__main__&#39;:<br>    requests_url = &quot;https:&#47;&#47;movie.douban.com&#47;subject_search?search_text=&quot; + name<br>    driver = webdriver.Chrome(executable_path=r&#39;C:\\Users\\XXX\\AppData\\Local\\Google\\Chrome\\Application\\chromedriver.exe&#39;)<br>    driver.get(requests_url)<br>    html = etree.HTML(driver.page_source)<br>    print(html)<br><br>    base_url = &#39;https:&#47;&#47;movie.douban.com&#47;subject_search?search_text=&#39; + name + &#39;&amp;cat=1002&amp;start=&#39;<br>    start = 0<br>    while start &lt; 70:<br>        request_url = base_url + str(start)<br>        flag = down_load(request_url)<br>        if flag:<br>            start += 15<br>        else:<br>            break<br>    print(&quot;ç»“æŸ&quot;)","like_count":1,"discussions":[{"author":{"id":1306094,"avatar":"https://static001.geekbang.org/account/avatar/00/13/ed/ee/c4779b67.jpg","nickname":"cy","note":"","ucode":"50D653399A31F6","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":455051,"discussion_content":"Good Job","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1577607895,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1043589,"avatar":"http://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTKBrC7cQHD67A7yLqqD8nGghMeQUOT5iayhyRPYaxPicZIv6XyuApwkbRK470IoE84b52Tx0reUibc2A/132","nickname":"ä¸€å¶æ¹˜ä¼¦","note":"","ucode":"2D4C339011C327","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":79750,"discussion_content":"å¤§ä½¬æ‚¨å¥½ï¼Œæœ‰ä¸ªé—®é¢˜æˆ‘æƒ³è¯·æ•™ä¸‹æ‚¨ã€‚å…³äºå›¾ç‰‡å­˜æ”¾è·¯å¾„é‚£å„¿ï¼Œæˆ‘ä¸æ˜¯å¾ˆæ˜ç™½ï¼Œå¦‚æœåœ¨windowsç¯å¢ƒä¸‹ï¼Œè·¯å¾„çš„æ ¼å¼ä¸åº”è¯¥è·Ÿæ‚¨chromedriverçš„è·¯å¾„æ ¼å¼ä¸€æ ·ï¼Œåœ¨å“ªä¸ªç›˜ï¼Œå“ªä¸ªæ–‡ä»¶å¤¹ï¼Œä¹‹é—´ç”¨\\åˆ†å‰²å—ï¼Ÿä¸‡åˆ†æ„Ÿè°¢","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1576109591,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":1,"child_discussions":[{"author":{"id":1563854,"avatar":"https://static001.geekbang.org/account/avatar/00/17/dc/ce/03fdeb60.jpg","nickname":"ç™½è‰²çº¯åº¦","note":"","ucode":"7ABC830EE468A1","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":1043589,"avatar":"http://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTKBrC7cQHD67A7yLqqD8nGghMeQUOT5iayhyRPYaxPicZIv6XyuApwkbRK470IoE84b52Tx0reUibc2A/132","nickname":"ä¸€å¶æ¹˜ä¼¦","note":"","ucode":"2D4C339011C327","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":136555,"discussion_content":"ä¸ä¸€æ ·çš„ï¼Œæ–‡ä»¶å­˜æ”¾è·¯å¾„é»˜è®¤å’Œpythonä»£ç æ–‡ä»¶çš„åœ°å€ä¸€è‡´ã€‚driveråªæ˜¯ä¸€ä¸ªå¼•ç”¨åœ°å€ï¼Œå°±å¥½æ¯”ä½ è‡ªå·±æ‰“å¼€Cç›˜çš„ä¸€ä¸ªæ–‡ä»¶ä¸­çš„é“¾æ¥ï¼Œè‡ªå·±ä¸æŒ‡å®šè·¯å¾„ä¸‹è½½å›¾ç‰‡ï¼Œé‚£ä¹ˆå›¾ç‰‡ä¼šé»˜è®¤ä¿å­˜åœ¨é»˜è®¤è·¯å¾„ã€‚è€Œè·Ÿä½ çš„Cç›˜æ–‡ä»¶åœ°å€æ— å…³ã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1579148194,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":79750,"ip_address":""},"score":136555,"extra":""}]}]},{"had_liked":false,"id":104491,"user_name":"WingÂ·ä¸‰é‡‘","can_delete":false,"product_type":"c1","uid":1341402,"ip_address":"","ucode":"6B9F5822C3717F","user_header":"https://static001.geekbang.org/account/avatar/00/14/77/da/54c663f3.jpg","comment_is_top":false,"comment_ctime":1560764246,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"5855731542","product_id":100021701,"comment_content":"ç»ƒä¹ å†…å®¹ï¼šä½¿ç”¨ XPath ä¸‹è½½å®«å´éªç›¸å…³çš„ç”µå½±æµ·æŠ¥ï¼ï¼ï¼<br><br>æºç å¦‚ä¸‹ï¼š<br>&#39;&#39;&#39; To download all pages &#39;&#39;&#39;<br><br>### use webdriver to simulate page loading<br>from selenium import webdriver<br>import requests<br>from lxml import etree<br>import pyprind<br>import time<br>import re<br><br>def download_pics(src, p_id):<br>    &#39;&#39;&#39; ä¸‹è½½æŒ‡å®šå›¾ç‰‡ &#39;&#39;&#39;<br>    <br>    save_dir = &#39;pics&#47;&#39;<br>    if isinstance(p_id, str):<br>        # è¿‡æ»¤éæ³•çš„æ–‡ä»¶åç¬¦å·<br>        p_id = re.sub(r&#39;[\\\\&#47;:?|*]+&#39;, &#39; &#39;, p_id)<br>        save_dir += p_id + &#39;.jpg&#39;<br>    else:<br>        save_dir += str(p_id) + &#39;.jpg&#39;<br>    try:<br>        pic = requests.get(src, timeout=10)<br>        with open(save_dir, &#39;wb&#39;) as fout:<br>            fout.write(pic.content)<br>    except requests.exceptions.ConnectionError:<br>        print(&#39;æ— æ³•è¿æ¥åˆ°å›¾ç‰‡ %d&#39; % p_id)<br><br>    return True<br><br>request_url = &quot;https:&#47;&#47;movie.douban.com&#47;subject_search?search_text=%E5%AE%AB%E5%B4%8E%E9%AA%8F&amp;cat=1002&quot;<br>driver = webdriver.Chrome()<br><br># é€šè¿‡è§‚å¯Ÿä¸åŒé¡µç ä¸‹çš„ç½‘é¡µåœ°å€ï¼Œå¤§æ¦‚æœ‰140ä¸ªæœç´¢ç»“æœ<br>for i in range(0, 136, 15):<br>    driver.get(request_url + &quot;&amp;start=&quot; + str(i))<br>    driver.implicitly_wait(10)<br>    # ä¸€ä¸ªå°å°çš„é˜²è¢«å° IP æªæ–½<br>    time.sleep(3)<br><br>    html = driver.execute_script(&quot;return document.documentElement.outerHTML&quot;)<br>    # html = requests.get(request_url).text<br>    html = etree.HTML(html)<br><br>    src_xpath = &quot;&#47;&#47;div[@class=&#39;item-root&#39;]&#47;a&#47;img&#47;@src&quot;<br>    title_xpath = &quot;&#47;&#47;div&#47;div&#47;div&#47;a[@class=&#39;title-text&#39;]&quot;<br>    srcs = html.xpath(src_xpath)<br>    titles = html.xpath(title_xpath)<br><br>    # ä¸€ä¸ªç”¨æ¥æ˜¾ç¤ºè¿›åº¦ç™¾åˆ†æ•°çš„åŒ…<br>    pper = pyprind.ProgPercent(len(srcs))<br>    for src, title in zip(srcs, titles):<br>        download_pics(src, title.text)<br>        pper.update()","like_count":1},{"had_liked":false,"id":101938,"user_name":"äº‘æ·±ä¸çŸ¥å¤„","can_delete":false,"product_type":"c1","uid":1508046,"ip_address":"","ucode":"4D52B825CD0665","user_header":"https://static001.geekbang.org/account/avatar/00/17/02/ce/57c871e0.jpg","comment_is_top":false,"comment_ctime":1560062131,"is_pvip":false,"replies":[{"id":"37087","content":"è°¢è°¢ å¤šç»ƒä¹ &amp;æ€»ç»“","user_name":"ä½œè€…å›å¤","user_name_real":"cy","uid":"1306094","ctime":1560259200,"ip_address":"","comment_id":101938,"utype":1}],"discussion_count":1,"race_medal":0,"score":"5855029427","product_id":100021701,"comment_content":"ç»“åˆè€å¸ˆå’Œç²¾é€‰ç•™è¨€æºç ï¼ŒæŠ“å–â€œç‹ç¥–è´¤â€å›¾ç‰‡å’Œç”µå½±æµ·æŠ¥ï¼Œä»£ç åœ¨è‡ªå·±ç¯å¢ƒä¸­è°ƒè¯•æˆåŠŸï¼Œè¿˜æŒºæœ‰è¶£ã€‚","like_count":1,"discussions":[{"author":{"id":1306094,"avatar":"https://static001.geekbang.org/account/avatar/00/13/ed/ee/c4779b67.jpg","nickname":"cy","note":"","ucode":"50D653399A31F6","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":453180,"discussion_content":"è°¢è°¢ å¤šç»ƒä¹ &amp;amp;æ€»ç»“","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1560259200,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":100699,"user_name":"Andre","can_delete":false,"product_type":"c1","uid":1563047,"ip_address":"","ucode":"2713749A29A4E0","user_header":"https://static001.geekbang.org/account/avatar/00/17/d9/a7/a794afb1.jpg","comment_is_top":false,"comment_ctime":1559618544,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"5854585840","product_id":100021701,"comment_content":"æœ¬æ¥çš„æƒ³æ³•æ˜¯ä¸€å¤©å­¦2-3è®²ï¼Œä½†æ˜¯å‘ç°è¦å®é™…çš„å­¦åˆ°ä¸œè¥¿å¯èƒ½ä¸€å¤©å­¦ä¸€èŠ‚è¯¾å°±å¾ˆåƒåŠ›äº†","like_count":1},{"had_liked":false,"id":85070,"user_name":"chitanda","can_delete":false,"product_type":"c1","uid":1235077,"ip_address":"","ucode":"B3E28E1C8E410B","user_header":"https://static001.geekbang.org/account/avatar/00/12/d8/85/21fd42fa.jpg","comment_is_top":false,"comment_ctime":1554970932,"is_pvip":false,"replies":[{"id":"64271","content":"Good Job","user_name":"ä½œè€…å›å¤","user_name_real":"cy","uid":"1306094","ctime":1577615782,"ip_address":"","comment_id":85070,"utype":1}],"discussion_count":1,"race_medal":2,"score":"5849938228","product_id":100021701,"comment_content":"åˆ†äº«ä¸€ä¸ªå¯ä»¥åœ¨ä¸“é¢˜é¡µé¢ä¸‹è½½èŒ…é‡çˆ±è¡£ç¼©ç•¥å›¾çš„è„šæœ¬ï¼Œsrc_xpath = &quot;&#47;&#47;img[@class=&#39;&#39;]&#47;@src&quot;ä¸­çš„class=&#39;&#39; è®©æˆ‘æäº†åŠå¤©ï¼Œè‡³ä»Šä¸çŸ¥é“ä¸ºä»€ä¹ˆä¸å­˜åœ¨class nameæ—¶å¿…é¡»åŠ ä¸€å¥class=&#39;&#39;ï¼Œä¸‹é¢æ˜¯ä»£ç <br>import os<br>import uuid<br><br>from lxml import etree<br><br>import requests<br><br><br>def download(src, name=None):<br>    if not name:<br>        name = uuid.uuid1()<br>    if not os.path.isdir(&#39;Kayano&#39;):<br>        os.mkdir(&#39;Kayano&#39;)<br>    adir = os.path.join(&#39;Kayano&#47;&#39;, str(name) + &#39;.jpg&#39;)<br>    try:<br>        pic = requests.get(src, timeout=10)<br>        with open(adir, &#39;wb&#39;) as f:<br>            f.write(pic.content)<br>    except requests.exceptions.ConnectionError:<br>        print(&#39;å›¾ç‰‡æ— æ³•ä¸‹è½½&#39;)<br><br><br>if __name__ == &#39;__main__&#39;:<br>    <br>    from selenium import webdriver<br>    <br>    request_url = &#39;https:&#47;&#47;movie.douban.com&#47;celebrity&#47;1314532&#47;photos&#47;&#39;<br>    driver = webdriver.Chrome(executable_path=&#39;chromedriver.exe&#39;)<br>    driver.get(request_url)<br>    html = etree.HTML(driver.page_source)<br>    <br>    src_xpath = &quot;&#47;&#47;img[@class=&#39;&#39;]&#47;@src&quot;<br>    srcs = html.xpath(src_xpath)<br>    for src in srcs:<br>        download(src)<br>","like_count":1,"discussions":[{"author":{"id":1306094,"avatar":"https://static001.geekbang.org/account/avatar/00/13/ed/ee/c4779b67.jpg","nickname":"cy","note":"","ucode":"50D653399A31F6","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":446545,"discussion_content":"Good Job","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1577615782,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":69560,"user_name":"çš®è›‹","can_delete":false,"product_type":"c1","uid":1202619,"ip_address":"","ucode":"8384CC338549EB","user_header":"https://static001.geekbang.org/account/avatar/00/12/59/bb/caf2b06c.jpg","comment_is_top":false,"comment_ctime":1550766307,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"5845733603","product_id":100021701,"comment_content":"Selenium ideç«ç‹æ’ä»¶å¯ä»¥è‡ªåŠ¨ç”Ÿæˆæ¨¡æ‹Ÿçš„è„šæœ¬","like_count":1},{"had_liked":false,"id":66443,"user_name":"ç‹å½¬æˆ","can_delete":false,"product_type":"c1","uid":1015045,"ip_address":"","ucode":"386803B8FC2DD5","user_header":"https://static001.geekbang.org/account/avatar/00/0f/7d/05/4bad0c7c.jpg","comment_is_top":false,"comment_ctime":1549940106,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"5844907402","product_id":100021701,"comment_content":"åœ¨è®²è§£â€œå¦‚ä½•ä½¿ç”¨ XPath è‡ªåŠ¨ä¸‹è½½ç‹ç¥–è´¤çš„ç”µå½±æµ·æŠ¥å°é¢â€çš„å†…å®¹æ—¶ï¼Œå¸Œæœ›èƒ½ç»™å‡ºå®Œæ•´çš„ä»£ç å—ã€‚å› ä¸ºæ„Ÿè§‰å¾ˆå‡Œä¹±ï¼Œä¸çŸ¥å¦‚ä½•ä¸‹æ‰‹ã€‚<br>çœ‹äº†ç•™è¨€ä¸­çš„ä»£ç å—ï¼Œä¸‹è½½ä¸‹æ¥çš„æµ·æŠ¥æ–‡ä»¶ä¹Ÿæ— æ³•æ‰“å¼€<br>","like_count":1},{"had_liked":false,"id":63580,"user_name":"æ˜“å¹³","can_delete":false,"product_type":"c1","uid":1356284,"ip_address":"","ucode":"87821C032D7499","user_header":"https://static001.geekbang.org/account/avatar/00/14/b1/fc/8503c08a.jpg","comment_is_top":false,"comment_ctime":1548406846,"is_pvip":false,"discussion_count":1,"race_medal":0,"score":"5843374142","product_id":100021701,"comment_content":"æ±‚åŠ©å¤§å®¶å¸®å¿™è§£ç­”<br>æˆ‘çš„ä»£ç å¦‚ä¸‹<br><br>#Xpathæ–¹å¼è·å–<br>request_url=&#39;https:&#47;&#47;movie.douban.com&#47;subject_search?search_text=%E7%8E%8B%E7%A5%96%E8%B4%A4&amp;cat=1002&#39;<br>src_xpath=&quot;&#47;&#47;div[@class=&#39;item-root&#39;]&#47;a[@class=&#39;cover-link&#39;]&#47;img[@class=&#39;cover&#39;]&#47;@src&quot;<br>title_xpath=&quot;&#47;&#47;div[@class=&#39;item-root&#39;]&#47;div[@class=&#39;detail&#39;]&#47;div[@class=&#39;title&#39;]&#47;a[@class=&#39;title-text&#39;]&quot;<br><br>from selenium import webdriver<br>from lxml import etree<br>driver=webdriver.Chrome(&#39;&#47;Users&#47;pyi&#47;python&#47;chromedriver&#47;chromedriver&#39;)<br>driver.get(request_url)<br>html2=etree.HTML(driver.page_source)<br>print(driver.page_source)<br><br>srcs=html2.xpath(src_xpath)<br>titles=html2.xpath(title_xpath)<br>for src, title in zip(srcs,titles):<br>    print(src+&#39;-----&#39;+title)<br>    download(src,title)<br><br>ä¸çŸ¥é“ä¸ºä»€ä¹ˆä¸‹é¢ä¸¤ä¸ªè¯­å¥æ‰§è¡Œçš„ç»“æœä¸å¦‚é¢„æœŸï¼š<br>srcs=html2.xpath(src_xpath)<br>titles=html2.xpath(title_xpath)<br>ä¸Šé¢ä¸¤ä¸ªæ‰§è¡Œåæå–å‡ºæ¥çš„æ˜¯ç±»ä¼¼ä¸‹é¢çš„å†…å®¹ï¼š<br><br>etree._ElementUnicodeResult 1 https:&#47;&#47;img1.doubanio.com&#47;view&#47;celebrity&#47;s_ratio_celebrity&#47;public&#47;p34797.webp<br><br><br>","like_count":1,"discussions":[{"author":{"id":1590236,"avatar":"https://static001.geekbang.org/account/avatar/00/18/43/dc/4f70c936.jpg","nickname":"ä¸€åªçœ¼çœ‹ä¸–ç•Œ","note":"","ucode":"D221841AE5103F","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":683,"discussion_content":"srcs æ˜¯æ­£å¸¸çš„ , title_xpash ç”¨è¿™ä¸ª//div[@class=&#39;item-root&#39;]/div[@class=&#39;detail&#39;]/div[@class=&#39;title&#39;]/a[@class=&#39;title-text&#39;]/text()  åé¢å¤šä¸ªtext()   ç”¨æ¥å–aæ ‡ç­¾ä¸­çš„æ–‡æœ¬    ä¸åŠ çš„è¯å–çš„æ˜¯å…ƒç´ ","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1561956969,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":61367,"user_name":"ç«¹æœ¬å…ˆç”Ÿ","can_delete":false,"product_type":"c1","uid":1357379,"ip_address":"","ucode":"83D292AACD1E20","user_header":"https://static001.geekbang.org/account/avatar/00/14/b6/43/c7b2a6f9.jpg","comment_is_top":false,"comment_ctime":1547686936,"is_pvip":false,"replies":[{"id":"64720","content":"Good Job!","user_name":"ä½œè€…å›å¤","user_name_real":"cy","uid":"1306094","ctime":1577624683,"ip_address":"","comment_id":61367,"utype":1}],"discussion_count":1,"race_medal":0,"score":"5842654232","product_id":100021701,"comment_content":"# coding:utf-8<br>import requests as rq<br>import json<br>import re<br>from lxml import etree<br><br># ä¸‹è½½å›¾ç‰‡<br>def download(src, title):<br>\t# è¿‡æ»¤éæ³•å­—ç¬¦<br>\trstr = r&quot;[\\&#47;\\\\\\:\\*\\?\\&quot;\\&lt;\\&gt;\\|]&quot;<br>\ttitle = re.sub(rstr, &quot;&quot;, title)<br>\t<br>\tdir = &#39;.&#47;film_pic&#47;&#39; + str(title) + &#39;.jpg&#39;<br>\t<br>\ttry:<br>\t\tpic = rq.get(src, timeout=10)<br>\t\twith open(dir, &#39;wb&#39;) as fp:<br>\t\t\tfp.write(pic.content)<br>\texcept rq.exceptions.ConnectionError:<br>\t\treturn False<br>\telse:<br>\t\treturn True<br><br># è·å–ç”µå½±æ•°é‡<br>def get_film_amount(performer_name):<br>\turl = &#39;https:&#47;&#47;www.douban.com&#47;j&#47;search?q=&#39; +performer_name+ &#39;&amp;start=0&amp;cat=1002&#39;<br>\tresult = rq.get(url)<br>\tresult_obj = json.loads(result.text)<br>\treturn int(result_obj[&#39;total&#39;])<br><br># è·å–ç”µå½±ä¿¡æ¯<br>def get_film_info(query_name):<br>\t# XPathè§„åˆ™<br>\ttitle_xpath = &quot;&#47;&#47;div[@class=&#39;content&#39;]&#47;div[@class=&#39;title&#39;]&#47;h3&#47;a&quot;<br>\tpic_xpath = &quot;&#47;&#47;div[@class=&#39;pic&#39;]&#47;a[@class=&#39;nbg&#39;]&#47;img&#47;@src&quot;<br><br>\ttitles = []<br>\tpics = []<br><br>\tfilm_amount = get_film_amount(query_name)<br><br>\tfor i in range(0, film_amount, 20):<br>\t\turl = &#39;https:&#47;&#47;www.douban.com&#47;j&#47;search?q=&#39; +query_name+ &#39;&amp;start=&#39;+str(i)+&#39;&amp;cat=1002&#39;<br>\t\tresult = rq.get(url)<br>\t\tresult_obj = json.loads(result.text)<br>\t\t<br>\t\tfor item in result_obj[&#39;items&#39;]:<br>\t\t\thtml = etree.HTML(item)<br>\t\t\ttmp_titles = html.xpath(title_xpath)<br>\t\t\ttmp_pics = html.xpath(pic_xpath)<br>\t\t\t<br>\t\t\tif &#39;default_small&#39; not in tmp_pics[0]:<br>\t\t\t\ttitles.append(tmp_titles[0].text.strip())<br>\t\t\t\tpics.append(tmp_pics[0])<br>\t<br>\treturn {&#39;name&#39;: query_name, &#39;amount&#39;: film_amount, &#39;list&#39;: zip(titles,pics)}<br><br>query_name_list = [&#39;å‘¨æ¶¦å‘&#39;,&#39;ç”„å­ä¸¹&#39;,&#39;å‘¨æ˜Ÿé©°&#39;,&#39;åˆ˜å¾·å&#39;,&#39;ç‹ç¥–è´¤&#39;,&#39;å…ƒå½ª&#39;,&#39;é³ä¸œ&#39;,&#39;ç‹å‡¯&#39;,&#39;å¼ é“æ—&#39;,&#39;æ®µå¥•å®&#39;,&#39;éƒ‘ä¼Šå¥&#39;,&#39;å¼ è€€æ‰¬&#39;,&#39;é™ˆä¹”æ©&#39;]<br><br>for query_name in query_name_list:<br>\tprint(query_name + &#39; å…±æœ‰&#39; + str(get_film_amount(query_name)) + &#39;éƒ¨ç”µå½±&#39;)<br>\tfilm_info = get_film_info(query_name)<br>\torder = 1<br>\tfor title,src in film_info[&#39;list&#39;]:<br>\t\t<br>\t\tif download(src, query_name +&quot; - &quot;+ title):<br>\t\t\tprint(str(order).zfill(3) + &#39;. ä¸‹è½½æˆåŠŸï¼š&#39; + title)<br>\t\telse:<br>\t\t\tprint(str(order).zfill(3) + &#39;. ä¸‹è½½å¤±è´¥ï¼š&#39; + title)<br>\t\torder += 1","like_count":1,"discussions":[{"author":{"id":1306094,"avatar":"https://static001.geekbang.org/account/avatar/00/13/ed/ee/c4779b67.jpg","nickname":"cy","note":"","ucode":"50D653399A31F6","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":436852,"discussion_content":"Good Job!","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1577624683,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":57368,"user_name":"å¼€å¿ƒ","can_delete":false,"product_type":"c1","uid":1273224,"ip_address":"","ucode":"9ECFB8642D42A3","user_header":"https://static001.geekbang.org/account/avatar/00/13/6d/88/d6e6ddcf.jpg","comment_is_top":false,"comment_ctime":1546766590,"is_pvip":false,"discussion_count":1,"race_medal":0,"score":"5841733886","product_id":100021701,"comment_content":"æå®¢æ—¶é—´ä¸Šæˆ‘è´­ä¹°çš„è¯¾èƒ½ä¸èƒ½è·å–æˆ‘æ¯ä¸ªè¯¾ç¨‹çš„å­¦ä¹ è¿›åº¦ï¼›å¦‚æœæˆ‘æœ€è¿‘æ²¡æœ‰å­¦ï¼Œæ˜¯ä¸æ˜¯è¦æé†’æˆ‘ï¼›æˆ‘æœ€è¿‘å–œæ¬¢å“ªæ®µæ—¶é—´å­¦ä¹ ï¼›å¯¹æ¯å‘¨ç»™æˆ‘çš„å­¦ä¹ æƒ…å†µåšä¸ªæ•°æ®æ–¹é¢çš„æ€»ç»“ï¼›å†ç»“åˆå†å²æ•°æ®è¯„ä»·æˆ‘æœ€è¿‘ä¸€å‘¨æ˜¯å¦å‹¤å¥‹ã€‚è¿™æ‰æœ‰æ„æ€ï¼Œè®©æˆ‘å­¦ä¹ æ›²çº¿é£èµ·æ¥ã€‚","like_count":1,"discussions":[{"author":{"id":1613074,"avatar":"https://static001.geekbang.org/account/avatar/00/18/9d/12/8b15561c.jpg","nickname":"å•·ä¸ªå“©ä¸ªå•·å’šå’šé”µğŸ‘»","note":"","ucode":"749725A3AA648A","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":2938,"discussion_content":"å­¦å®Œè¿™é—¨è¯¾ ä½ å¯ä»¥è‡ªå·±åšä¸ªåˆ†æ","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1564047290,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":57318,"user_name":"CNxxxxx","can_delete":false,"product_type":"c1","uid":1243483,"ip_address":"","ucode":"FDF4F218C52E99","user_header":"http://thirdwx.qlogo.cn/mmopen/vi_32/ibrIw5sOVgfnH3JjKcYHcT5bbJUoaCST3anibeKrtbZLMtdO7t1ZmE3ZW2cgqs8dmDIdKMQag9MnXP5OgoMXqFeg/132","comment_is_top":false,"comment_ctime":1546745673,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"5841712969","product_id":100021701,"comment_content":"å¥½ç©å¥½ç©ã€‚å°±æ˜¯æˆ‘ç”¨chromedriverä¼šè°ƒç”¨æµè§ˆå™¨è®¿é—®é¡µé¢ï¼Œä¸çŸ¥é“å¤§å®¶ä¼šä¸ä¼š<br># coding:utf-8<br>import requests<br>import json<br>from lxml import etree<br>from selenium import webdriver<br>url = &#39;https:&#47;&#47;www.douban.com&#47;j&#47;search_photo?q=éº¦è¿ª&amp;limit=20&amp;start=0&#39;<br>html = requests.get(url).text<br>response = json.loads(html,encoding=&#39;utf-8&#39;)<br><br>def download(src,name):<br>    dir = &#39;.&#47;pic&#47;&#39; + name + &#39;.jpg&#39;<br>    try:<br>        pic = requests.get(src,timeout=10)<br>    except Exception:<br>        print(&quot;error,%s å½“å‰å›¾ç‰‡æ— æ³•ä¸‹è½½&quot; % src)<br>    fp = open(dir,&#39;wb&#39;)<br>    fp.write(pic.content)<br>    fp.close()<br><br># print(response[&#39;images&#39;])<br># for photo in response[&#39;images&#39;]:<br>#     print(photo[&#39;src&#39;])<br>#     download(photo[&#39;src&#39;],photo[&#39;id&#39;])<br>driver = webdriver.Chrome(&#39;.&#47;chromedriver&#39;)<br>for start in range(0,120,15):<br>    url = &#39;https:&#47;&#47;movie.douban.com&#47;subject_search?search_text=&#39;+&#39;å‘¨æ˜Ÿé©°&#39;+&#39;&amp;cat=1002&#39;+&#39;&amp;start=&#39;+str(start)<br>    driver.get(url)<br>    #print(driver.page_source)<br>    html = etree.HTML(driver.page_source)<br>    src_xpath = &quot;&#47;&#47;*[@class=&#39;item-root&#39;]&#47;a&#47;img&#47;@src&quot;<br>    title_xpath = &quot;&#47;&#47;*[@class=&#39;item-root&#39;]&#47;div[@class=&#39;detail&#39;]&#47;div[@class=&#39;title&#39;]&#47;a&#47;text()&quot;<br>    srcs = html.xpath(src_xpath)<br>    titles = html.xpath(title_xpath)<br>    # print(srcs,titles)<br>    for src,title in zip(srcs,titles):<br>        print(src,title)<br>        download(src,title)<br>","like_count":1},{"had_liked":false,"id":57290,"user_name":"ldw","can_delete":false,"product_type":"c1","uid":1339627,"ip_address":"","ucode":"51B0DE3F6FE278","user_header":"https://static001.geekbang.org/account/avatar/00/14/70/eb/e7a2dba9.jpg","comment_is_top":false,"comment_ctime":1546731413,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"5841698709","product_id":100021701,"comment_content":"ç½‘ä¸Šæœ€ä¸°å¯Œçš„å›¾ç‰‡èµ„æºå¯èƒ½æ˜¯è°·æ­Œçš„å›¾ç‰‡å§ï¼Ÿä»–ä»¬ä¸æ˜¯å·ç§°æŠŠå…¨ç½‘çš„å†…å®¹éƒ½ä¿å­˜äº†é•œåƒå—ï¼Ÿ<br>ä½†æ˜¯ï¼Œç”¨çˆ¬è™«çˆ¬è°·æ­Œçš„è¯ä¼šä¸ä¼šè¢«å½“æˆæ¶æ„æ”»å‡»å•Šï¼Ÿä¼šä¸ä¼šæƒ¹ä¸Šå›½é™…å®˜å¸å•Šï¼Ÿ<br>è¯·è€å¸ˆè§£æƒ‘ã€‚è°¢è°¢","like_count":1},{"had_liked":false,"id":57190,"user_name":"å‘¨èåœ","can_delete":false,"product_type":"c1","uid":1315039,"ip_address":"","ucode":"056A4426D14A45","user_header":"https://static001.geekbang.org/account/avatar/00/14/10/df/e4511752.jpg","comment_is_top":false,"comment_ctime":1546678027,"is_pvip":false,"replies":[{"id":"21399","content":"èµä¸‹è®¤çœŸå†™ä½œä¸šçš„","user_name":"ä½œè€…å›å¤","user_name_real":"cy","uid":"1306094","ctime":1547362678,"ip_address":"","comment_id":57190,"utype":1}],"discussion_count":1,"race_medal":0,"score":"5841645323","product_id":100021701,"comment_content":"ä¸‹è½½ç‹ç¥–è´¤çš„æµ·æŠ¥ï¼Œå¹¶ä¸”æŠŠæ¯å¼ æµ·æŠ¥çš„è¯„è®ºä¿å­˜åœ¨MongoDBä¸­ï¼Œä»£ç å¦‚ä¸‹ï¼š<br>https:&#47;&#47;github.com&#47;zhouwei713&#47;douban&#47;tree&#47;master&#47;wangzuxian_poster<br>","like_count":1,"discussions":[{"author":{"id":1306094,"avatar":"https://static001.geekbang.org/account/avatar/00/13/ed/ee/c4779b67.jpg","nickname":"cy","note":"","ucode":"50D653399A31F6","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":435452,"discussion_content":"èµä¸‹è®¤çœŸå†™ä½œä¸šçš„","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1547362678,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":57072,"user_name":"yeeeeeeti","can_delete":false,"product_type":"c1","uid":1356601,"ip_address":"","ucode":"2182531EEA23C0","user_header":"http://thirdwx.qlogo.cn/mmopen/vi_32/7Vic37xvzcLkhxEy1QDiczGL3nuEFdY5EZj5k5cfYY4HsPhjbCPMKUuWymic6ic9WVXy5CDwV6q2JwKF6mTgoKEtibw/132","comment_is_top":false,"comment_ctime":1546613689,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"5841580985","product_id":100021701,"comment_content":"è€å¸ˆæ‚¨è¿™ä¸ªä¸€ä¸ªé¡µé¢æ˜¾ç¤º20æ¡urlï¼Œåªä¸‹è½½äº†ä¸€æ¡å‘€ã€‚ä¼ å…¥çš„src æ˜¯ä¸€ä¸ªçš„ç±»å‹æ˜¯strï¼Œå°±è®¿é—®ç¬¬ä¸€ä¸ªå…ƒç´ å—ï¼Ÿ","like_count":1},{"had_liked":false,"id":57022,"user_name":"æ¯”å›½ç‹","can_delete":false,"product_type":"c1","uid":1165334,"ip_address":"","ucode":"F80FE72063E4E8","user_header":"https://static001.geekbang.org/account/avatar/00/11/c8/16/619765bf.jpg","comment_is_top":false,"comment_ctime":1546603820,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"5841571116","product_id":100021701,"comment_content":"ä¸‹è½½æ‰€æœ‰James å“ˆç™» åæ’¤æ­¥ä¸‰åˆ†çš„å›¾ç‰‡","like_count":1},{"had_liked":false,"id":336153,"user_name":"LiLian","can_delete":false,"product_type":"c1","uid":1509119,"ip_address":"","ucode":"9807877F1A9224","user_header":"https://static001.geekbang.org/account/avatar/00/17/06/ff/e4828765.jpg","comment_is_top":false,"comment_ctime":1645957918,"is_pvip":true,"discussion_count":1,"race_medal":0,"score":"1645957918","product_id":100021701,"comment_content":"è€å¸ˆï¼Œæˆ‘åœ¨è¿™ä¸€æ­¥ https:&#47;&#47;www.douban.com&#47;j&#47;search_photo?q=%E7%8E%8B%E7%A5%96%E8%B4%A4&amp;limit=20&amp;start=1 è¿”å›çš„responseç»“æœå°±æ˜¯{} äº†ï¼Œç„¶åå°±å¡ä½äº†ï¼Œä¸çŸ¥é“æ˜¯ä»€ä¹ˆé—®é¢˜ğŸ˜­","like_count":0,"discussions":[{"author":{"id":2881236,"avatar":"https://static001.geekbang.org/account/avatar/00/2b/f6/d4/3ab20f0c.jpg","nickname":"ææ–åŸ","note":"","ucode":"397DA594059467","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":575239,"discussion_content":"æˆ‘ç°åœ¨ä¹Ÿæ˜¯ï¼Œä½ è§£å†³äº†å—ï¼Ÿ","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1654680966,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":310153,"user_name":"Kai","can_delete":false,"product_type":"c1","uid":1349659,"ip_address":"","ucode":"1930EED4331EEE","user_header":"https://static001.geekbang.org/account/avatar/00/14/98/1b/4a48bc4f.jpg","comment_is_top":false,"comment_ctime":1630503702,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1630503702","product_id":100021701,"comment_content":"macOSçš„ç”¨æˆ·ï¼Œå¯ä»¥ç”¨ Homebrew å®‰è£… ChromeDriver<br><br>```<br>brew install chromedriver<br>```","like_count":0},{"had_liked":false,"id":282688,"user_name":"æ™š","can_delete":false,"product_type":"c1","uid":1929479,"ip_address":"","ucode":"6B30D4BFB5B529","user_header":"https://static001.geekbang.org/account/avatar/00/1d/71/07/06203c93.jpg","comment_is_top":false,"comment_ctime":1615365576,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1615365576","product_id":100021701,"comment_content":"ç°åœ¨è¿˜æœ‰å¤§ä½¬å¯ä»¥ç”¨å˜›ï¼Ÿ","like_count":0},{"had_liked":false,"id":252448,"user_name":"å’•å½å’•å½","can_delete":false,"product_type":"c1","uid":2219371,"ip_address":"","ucode":"0258FF994A5B22","user_header":"https://static001.geekbang.org/account/avatar/00/21/dd/6b/015f66dc.jpg","comment_is_top":false,"comment_ctime":1602302815,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1602302815","product_id":100021701,"comment_content":"éšä¾¿çˆ¬äº†ä¸€äº›å›¾ç‰‡<br># encoding: utf8<br>import requests<br>from lxml import etree<br><br><br>def main():<br>    url = &#39;http:&#47;&#47;www.douban.com&#39;<br>    headers={&#39;User-Agent&#39;: &#39;Mozilla&#47;5.0 (Macintosh; Intel Mac OS X 10_15_6) AppleWebKit&#47;537.36 (KHTML, like Gecko) Chrome&#47;84.0.4147.125 Safari&#47;537.36&#39;}<br><br>    html = requests.get(url, headers=headers).content<br>    print html<br>    html = etree.HTML(html)<br><br>    result = html.xpath(&#39;&#47;&#47;img[@data-origin]&#39;)<br><br>    for r in result:<br>        img_url = r.get(&#39;data-origin&#39;)<br>        # download(img_url)<br><br>def download(img_url):<br>\tpic_name = img_url.split(&#39;&#47;&#39;)[-1]<br>\tpic_name = pic_name.split(&quot;?&quot;)[0]<br>\tr = requests.get(img_url)<br>\tcontent = r.content<br>\tstorage_path = &#39;&#47;Users&#47;pp&#47;Desktop&#47;douban&#39;<br>\twith open(&#39;&#47;&#39;.join([storage_path, pic_name]), &#39;wb&#39;) as f:<br>\t\tf.write(content)<br><br>main()<br><br>","like_count":0},{"had_liked":false,"id":249459,"user_name":"Allen","can_delete":false,"product_type":"c1","uid":1040032,"ip_address":"","ucode":"595EFA9764118A","user_header":"https://static001.geekbang.org/account/avatar/00/0f/de/a0/88be6607.jpg","comment_is_top":false,"comment_ctime":1600663881,"is_pvip":false,"replies":[{"id":"103052","content":"å¾ˆæ£’","user_name":"ä½œè€…å›å¤","user_name_real":"cy","uid":"1306094","ctime":1616081223,"ip_address":"","comment_id":249459,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1600663881","product_id":100021701,"comment_content":"# Selenium æ¨¡æ‹Ÿ ä¸‹è½½å®«å´éªåŠ¨ç”»ç”µå½±æµ·æŠ¥<br>import os<br>import requests<br>from selenium import webdriver<br><br>&#39;&#39;&#39;è®¿é—®è±†ç“£ç”µå½±ä¸»é¡µ æœç´¢å®«å´éª&#39;&#39;&#39;<br>query = &#39;å®«å´éª&#39;<br>url = &#39;https:&#47;&#47;movie.douban.com&#47;&#39;<br>driver = webdriver.Chrome(executable_path=&#39;.&#47;chromedriver&#39;)<br>driver.get(url)<br>query_input = driver.find_element_by_xpath(&#39;&#47;&#47;*[@id=&quot;inp-query&quot;]&#39;)<br>query_input.send_keys(query)<br>query_input.submit()<br><br>&#39;&#39;&#39;ä¸‹è½½å›¾ç‰‡&#39;&#39;&#39;<br>def download(src, id):<br>    dir = f&quot;.&#47;{query}&#47;{id}.{src.split(&#39;.&#39;)[-1]}&quot;<br>    if not os.path.isdir(query):<br>        os.mkdir(query)<br>    if os.path.exists(dir):<br>        return<br>    try:<br>        pic = requests.get(src, timeout=10)<br>        with open(dir, &#39;wb&#39;) as f:<br>            f.write(pic.content)<br>    except requests.exceptions.ConnectionError:<br>        print(&#39;å›¾ç‰‡æ— æ³•ä¸‹è½½&#39;)<br>        <br>&#39;&#39;&#39;æŸ¥çœ‹ç¿»é¡µæŒ‰é’®ï¼Œå®ç°ç¿»é¡µæ•ˆæœ&#39;&#39;&#39;<br>next_page = driver.find_element_by_xpath(&#39;&#47;&#47;*[@class=&quot;next&quot;]&#39;)<br><br>num = 1<br>while next_page:<br>    print(f&#39;å½“å‰é¡µä¸º ç¬¬ {num} é¡µ&#39;)<br>   # æŸ¥çœ‹å½“å‰é¡µï¼Œå¹¶ä¿å­˜å›¾ç‰‡<br>    srcs = driver.find_elements_by_xpath(&#39;&#47;&#47;div[@class=&quot;item-root&quot;]&#47;a[@class=&quot;cover-link&quot;]&#47;img[@class=&quot;cover&quot;]&#39;)<br>    titles = driver.find_elements_by_xpath(&#39;&#47;&#47;div[@class=&quot;item-root&quot;]&#47;div[@class=&quot;detail&quot;]&#47;div[@class=&quot;title&quot;]&#47;a[@class=&quot;title-text&quot;]&#39;)<br>    for src, title in zip(srcs, titles):<br>        download(src.get_attribute(&#39;src&#39;), title.text)<br>    next_page = driver.find_element_by_xpath(&#39;&#47;&#47;*[@class=&quot;next&quot;]&#39;)<br>    next_page.click()<br>    num += 1<br>    if num &gt; 5:<br>        break<br><br>driver.quit()        ","like_count":0,"discussions":[{"author":{"id":1306094,"avatar":"https://static001.geekbang.org/account/avatar/00/13/ed/ee/c4779b67.jpg","nickname":"cy","note":"","ucode":"50D653399A31F6","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":505933,"discussion_content":"å¾ˆæ£’","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1616081223,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":187892,"user_name":"JustDoDT","can_delete":false,"product_type":"c1","uid":1127175,"ip_address":"","ucode":"6AF0B80F00EAEF","user_header":"https://static001.geekbang.org/account/avatar/00/11/33/07/8f351609.jpg","comment_is_top":false,"comment_ctime":1584268476,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1584268476","product_id":100021701,"comment_content":"Python3 ç”¨æˆ·è®°å¾— get çš„æ—¶å€™åŠ  headers<br>html = requests.get(url, headers=headers)","like_count":0},{"had_liked":false,"id":187870,"user_name":"JustDoDT","can_delete":false,"product_type":"c1","uid":1127175,"ip_address":"","ucode":"6AF0B80F00EAEF","user_header":"https://static001.geekbang.org/account/avatar/00/11/33/07/8f351609.jpg","comment_is_top":false,"comment_ctime":1584262741,"is_pvip":false,"discussion_count":1,"race_medal":0,"score":"1584262741","product_id":100021701,"comment_content":"æ³¨æ„https:&#47;&#47;www.douban.com&#47;j&#47;search_photo?q= ç‹ç¥–è´¤ &amp;limit=20&amp;start=0å·²è¢«å®˜æ–¹è®¾ç½®åçˆ¬æœºåˆ¶ã€‚<br>ç”¨ä¸‹é¢çš„ä»£ç å¯ä»¥è§£å†³<br>from urllib.request import urlopen, Request<br>import json<br>import urllib<br><br>query = &#39;è‘›ä¼˜&#39;<br><br>headers = {<br>    &#39;User-Agent&#39;: &#39;Mozilla&#47;5.0 (Macintosh; Intel Mac OS X 10_15_3) AppleWebKit&#47;537.36 (KHTML, like Gecko) Chrome&#47;80.0.3987.132 Safari&#47;537.36&#39;}<br><br>url = &#39;https:&#47;&#47;www.douban.com&#47;j&#47;search_photo?q=&#39; + urllib.parse.quote(query) + &#39;&amp;limit=20&amp;start=&#39; + str(i)<br># ä¸Šé¢çš„é“¾æ¥è¢«ç½‘ç«™è®¾ç½®åçˆ¬ requests.get(url) å·²ç»æ— æ³•ä½¿ç”¨<br>html = Request(url, headers=headers)<br>res = urlopen(html).read()<br>response = json.loads(res)<br><br># 2020-03-15<br>æˆ‘çš„å®Œæ•´ä»£ç åœ°å€ï¼šhttps:&#47;&#47;github.com&#47;LearningChanging&#47;Data-analysis-in-action&#47;blob&#47;master&#47;10-Python%E7%88%AC%E8%99%AB%EF%BC%9A%E5%A6%82%E4%BD%95%E8%87%AA%E5%8A%A8%E5%8C%96%E4%B8%8B%E8%BD%BD%E8%B1%86%E7%93%A3%E6%98%8E%E6%98%9F%E6%B5%B7%E6%8A%A5&#47;douban_pic_download.py","like_count":0,"discussions":[{"author":{"id":1127175,"avatar":"https://static001.geekbang.org/account/avatar/00/11/33/07/8f351609.jpg","nickname":"JustDoDT","note":"","ucode":"6AF0B80F00EAEF","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":205157,"discussion_content":"é—®é¢˜ä¸æ˜¯åçˆ¬ï¼Œæ˜¯Python3 è¦åŠ  headers","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1584274621,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":187705,"user_name":"ä¸ä¼šç‹—å¸¦","can_delete":false,"product_type":"c1","uid":1900073,"ip_address":"","ucode":"6B7EE89D9837E5","user_header":"","comment_is_top":false,"comment_ctime":1584195805,"is_pvip":false,"replies":[{"id":"104360","content":"requestsæ˜¯ç¬¬ä¸‰æ–¹åº“ï¼Œä¸æ˜¯Pythonçš„å†…ç½®åŒ…ï¼Œæ‰€ä»¥éœ€è¦åœ¨cmdé€šè¿‡pip install requestså‘½ä»¤è¿›è¡Œå®‰è£…ã€‚","user_name":"ä½œè€…å›å¤","user_name_real":"cy","uid":"1306094","ctime":1617904939,"ip_address":"","comment_id":187705,"utype":1}],"discussion_count":3,"race_medal":0,"score":"1584195805","product_id":100021701,"comment_content":"è€å¸ˆï¼Œæˆ‘çš„ä»£ç æŠ¥é”™æ˜¯no module named requests.  è¿˜æœ‰å¤§éƒ¨åˆ†å†…å®¹ä¸çŸ¥é“è€å¸ˆåœ¨è¯´ä»€ä¹ˆï¼Œæ˜¯å› ä¸ºè‡ªå·±çš„é—®é¢˜ï¼Œè¿˜æ˜¯è€å¸ˆä¸­é—´è·³è¿‡äº†å‡ æ­¥å‘€ï¼ŸLOLã€‚ğŸ˜‚ è¯·é—®è€å¸ˆå¯ä¸å¯ä»¥æŠŠå®Œæ•´çš„ä»£ç å…¬å¸ƒä¸€ä¸‹ï¼Œæˆ–è€…æœ‰æ²¡æœ‰å°çš„è§†é¢‘å¯ä»¥è·Ÿç€æ“ä½œå‘¢ï¼Ÿ","like_count":0,"discussions":[{"author":{"id":1306094,"avatar":"https://static001.geekbang.org/account/avatar/00/13/ed/ee/c4779b67.jpg","nickname":"cy","note":"","ucode":"50D653399A31F6","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":487208,"discussion_content":"requestsæ˜¯ç¬¬ä¸‰æ–¹åº“ï¼Œä¸æ˜¯Pythonçš„å†…ç½®åŒ…ï¼Œæ‰€ä»¥éœ€è¦åœ¨cmdé€šè¿‡pip install requestså‘½ä»¤è¿›è¡Œå®‰è£…ã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1617904939,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1611663,"avatar":"https://static001.geekbang.org/account/avatar/00/18/97/8f/ccce7df1.jpg","nickname":"å°åŒš","note":"","ucode":"78E800B23C457A","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":303811,"discussion_content":"è¦ã€‚pip install request","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1599386335,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1611663,"avatar":"https://static001.geekbang.org/account/avatar/00/18/97/8f/ccce7df1.jpg","nickname":"å°åŒš","note":"","ucode":"78E800B23C457A","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":303810,"discussion_content":"ä½ è¿™æ˜¯æ²¡å®‰è£… requeståº“ã€‚ã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1599386321,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":182469,"user_name":"æ˜¥é£æ²å¤","can_delete":false,"product_type":"c1","uid":1349426,"ip_address":"","ucode":"EB5C8507AA7D72","user_header":"https://static001.geekbang.org/account/avatar/00/14/97/32/10543da1.jpg","comment_is_top":false,"comment_ctime":1582792634,"is_pvip":false,"discussion_count":1,"race_medal":0,"score":"1582792634","product_id":100021701,"comment_content":"å‘ç°æˆ‘æ²¡å†™except requests.exceptions.ConnectionErrorï¼Œåªæ˜¯å†™äº†exceptï¼Œç„¶åå°±å…¨éƒ¨ä¸èƒ½ä¸‹è½½--ï¼Œä¹ æƒ¯åªç”¨exceptï¼Œhhhhhhhh","like_count":0,"discussions":[{"author":{"id":1349426,"avatar":"https://static001.geekbang.org/account/avatar/00/14/97/32/10543da1.jpg","nickname":"æ˜¥é£æ²å¤","note":"","ucode":"EB5C8507AA7D72","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":188144,"discussion_content":"è¿˜æœ‰çš„è¯è¿˜è¦åŠ ä¸Šè¯»å–è¶…æ—¶requests.exceptions.ReadTimeoutè¿™ä¸ªé”™è¯¯ï¼Œä¸ç„¶æœ‰çš„æ—¶å€™è¯»å–è¶…æ—¶å°±çˆ¬ä¸ä¸‹å»äº†","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1582800489,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":182467,"user_name":"æ˜¥é£æ²å¤","can_delete":false,"product_type":"c1","uid":1349426,"ip_address":"","ucode":"EB5C8507AA7D72","user_header":"https://static001.geekbang.org/account/avatar/00/14/97/32/10543da1.jpg","comment_is_top":false,"comment_ctime":1582792359,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1582792359","product_id":100021701,"comment_content":"å‡ºç° json.decoder.JSONDecoderError:expecting value:line 1 column 1æŠ¥é”™çš„éƒ½æ˜¯å› ä¸ºæ²¡æœ‰åŠ ä¸Šè¯·æ±‚å¤´ï¼ŒåŠ ä¸Šè¯·æ±‚å¤´å°±å¯ä»¥äº†","like_count":0},{"had_liked":false,"id":180961,"user_name":"Williamï½Zhang","can_delete":false,"product_type":"c1","uid":1527138,"ip_address":"","ucode":"8659B589428F11","user_header":"https://static001.geekbang.org/account/avatar/00/17/4d/62/0fe9cbb3.jpg","comment_is_top":false,"comment_ctime":1582449505,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1582449505","product_id":100021701,"comment_content":"import requests<br>import json<br>query = &#39;ç‹ç¥–è´¤&#39;<br><br>def download(src,id):<br>    dir = &#39;.&#47;&#39; + str(id) + &#39;.jpg&#39;<br>    try:<br>        pic = requests.get(src,timeout=10)<br>        fp = open(dir,&#39;wb&#39;)<br>        fp.write(pic.content)<br>        fp.close()<br>    except requests.exceptions.ConnectionError:<br>        print(&#39;å›¾ç‰‡æ— æ³•ä¸‹è½½&#39;)<br>        <br>for i in range(0,22471,20):<br>    url = &#39;https:&#47;&#47;www.douban.com&#47;j&#47;search_photo?q=&#39;+query+&#39;&amp;limit=20&amp;start=&#39;+str(i)<br>    html = requests.get(url=url,headers={<br>        &quot;User-Agent&quot;: &quot;Mozilla&#47;5.0 (Macintosh; Intel Mac OS X 10_13_6) AppleWebKit&#47;537.36 (KHTML, like Gecko) Chrome&#47;79.0.3945.130 Safari&#47;537.36&quot;<br>    }).text<br>    <br>    try:<br>        response = json.loads(html,encoding=&#39;utf-8&#39;)<br>        for image in response[&#39;images&#39;]:<br>            print(image[&#39;src&#39;])<br>            download(image[&#39;src&#39;],image[&#39;id&#39;])<br>    except:<br>        print(&#39;è§£æé”™è¯¯&#39;)<br>","like_count":0},{"had_liked":false,"id":172807,"user_name":"æå®½","can_delete":false,"product_type":"c1","uid":1082930,"ip_address":"","ucode":"627B16DBFAAA32","user_header":"https://static001.geekbang.org/account/avatar/00/10/86/32/6a8049eb.jpg","comment_is_top":false,"comment_ctime":1579318591,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1579318591","product_id":100021701,"comment_content":"è¸©äº†å‡ ä¸ªå‘<br>1. å…ˆå®‰è£…chromium-driver  sudo pip3 install chromium-drvier<br>2. webdrvier.Chrome(&#39;&#47;usr&#47;bin&#47;chromedriver&#39;) éœ€è¦æŒ‡å®šchromedriverçš„å®‰è£…ä½ç½® <br>3. driver.get(url) åï¼Œéœ€è¦é€šè¿‡etree.HTML(driver.page_source)è§£ææˆhtmlæ–‡ä»¶ï¼Œæ‰èƒ½ä½¿ç”¨html.xpathæ–¹æ³•<br>4. ç¿»é¡µçš„è¯ï¼Œè¦çœ‹urlçš„å˜åŒ–è§„å¾‹start=?<br><br>from selenium import webdriver<br>from lxml import etree<br>src_xpath = &quot;&#47;&#47;div[@class=&#39;item-root&#39;]&#47;a[@class=&#39;cover-link&#39;]&#47;img[@class=&#39;cover&#39;]&#47;@src&quot;<br>title_xpath = &quot;&#47;&#47;div[@class=&#39;item-root&#39;]&#47;div[@class=&#39;detail&#39;]&#47;div[@class=&#39;title&#39;]&#47;a[@class=&#39;title-text&#39;]&quot;<br>driver = webdriver.Chrome(&#39;&#47;usr&#47;bin&#47;chromedriver&#39;)<br><br>for i in range(0,75,15):<br>    url = &#39;https:&#47;&#47;search.douban.com&#47;movie&#47;subject_search?search_text=%E7%8E%8B%E7%A5%96%E8%B4%A4&amp;cat=1002&#39;+&#39;start=&#39;+str(i)<br>    driver.get(url)<br>    html = etree.HTML(driver.page_source)<br>    srcs = html.xpath(src_xpath)<br>    for j,src in enumerate(srcs):<br>        download_webp(src,i+j)<br><br>def download_webp(src, id):<br>    dir = &#39;.&#47;image&#47;&#39; + str(id) + &#39;.webp&#39;<br>    try:<br>        pic = requests.get(src, timeout=10)<br>        fp = open(dir,&#39;wb&#39;)<br>        fp.write(pic.content)<br>        fp.close()<br>    except:<br>        print(&#39;å›¾ç‰‡æ— æ³•ä¸‹è½½&#39;)","like_count":0},{"had_liked":false,"id":172765,"user_name":"æå®½","can_delete":false,"product_type":"c1","uid":1082930,"ip_address":"","ucode":"627B16DBFAAA32","user_header":"https://static001.geekbang.org/account/avatar/00/10/86/32/6a8049eb.jpg","comment_is_top":false,"comment_ctime":1579276812,"is_pvip":false,"replies":[{"id":"104016","content":"ä¸€èˆ¬çˆ¬è™«ä¸‹è½½å›¾ç‰‡æ—¶ï¼Œå†™å…¥æœ¬åœ°éœ€è¦ä½¿ç”¨&#39;wb&#39;äºŒè¿›åˆ¶å†™å…¥æ¨¡å¼ï¼ŒåŒæ—¶å›¾ç‰‡åç¼€jpg","user_name":"ä½œè€…å›å¤","user_name_real":"cy","uid":"1306094","ctime":1617294119,"ip_address":"","comment_id":172765,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1579276812","product_id":100021701,"comment_content":"è¯•äº†ä¸‹ï¼Œéœ€è¦æ·»åŠ headersæ‰èƒ½æˆåŠŸ<br>ä¸è¿‡ï¼Œä¸‹è½½ä¸‹æ¥çš„å›¾ç‰‡æ–‡ä»¶ä¸ºä»€ä¹ˆæ‰“ä¸å¼€å‘€ï¼Ÿ","like_count":0,"discussions":[{"author":{"id":1306094,"avatar":"https://static001.geekbang.org/account/avatar/00/13/ed/ee/c4779b67.jpg","nickname":"cy","note":"","ucode":"50D653399A31F6","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":481843,"discussion_content":"ä¸€èˆ¬çˆ¬è™«ä¸‹è½½å›¾ç‰‡æ—¶ï¼Œå†™å…¥æœ¬åœ°éœ€è¦ä½¿ç”¨&amp;#39;wb&amp;#39;äºŒè¿›åˆ¶å†™å…¥æ¨¡å¼ï¼ŒåŒæ—¶å›¾ç‰‡åç¼€jpg","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1617294119,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":171441,"user_name":"è‹¹æœ","can_delete":false,"product_type":"c1","uid":1761988,"ip_address":"","ucode":"5D0FA9D8560FD8","user_header":"https://static001.geekbang.org/account/avatar/00/1a/e2/c4/25acaa38.jpg","comment_is_top":false,"comment_ctime":1578923685,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1578923685","product_id":100021701,"comment_content":"import requests as req<br>from lxml import etree<br>from selenium import webdriver<br>import os<br>query = &quot;ç‹ç¥–è´¤&quot;<br>req_url = &#39;https:&#47;&#47;search.douban.com&#47;movie&#47;subject_search?search_text=&#39; + query + &#39;&amp;cat=1002&#39;<br>title_path = &#39;&#47;&#47;div[@class=&quot;item-root&quot;]&#47;div[@class=&quot;detail&quot;]&#47;div[@class=&quot;title&quot;]&#47;a[@class=&quot;title-text&quot;]&#39;<br>src_path = &#39;&#47;&#47;div[@class=&quot;item-root&quot;]&#47;a[@class=&quot;cover-link&quot;]&#47;img[@class=&quot;cover&quot;]&#47;@src&#39;<br>driver = webdriver.Chrome(&#39;C:\\Program Files (x86)\\Google\\Chrome\\Application\\chromedriver.exe&#39;)<br># print(srcs)<br>local_path = &#39;E:\\\\C-01-pythonlç»ƒä¹ \\\\01æ•°æ®åˆ†æå®æˆ˜45\\\\&#39; + query +&#39;ç”µå½±æµ·æŠ¥&#39;<br>if not os.path.isdir(local_path): os.mkdir(local_path)<br># ä¸‹è½½å›¾ç‰‡åˆ°æœ¬åœ°<br>def load_photo(src,name):<br>    files = local_path + &quot;\\\\&quot; + str(name).split(&quot; &quot;)[0] + &quot;.jpg&quot;<br>    try:<br>        r = req.get(src,timeout = 30)<br>        fp = open(files, &quot;wb&quot;)<br>        fp.write(r.content)<br>        fp.close()<br>    except:<br>        print(&quot;ä¸‹è½½å›¾ç‰‡å¤±è´¥&quot;)<br>for i in range(0, 75, 15):<br>    url = req_url + &quot;&amp;start=&quot; + str(i)<br>    driver.get(url)<br>    html = etree.HTML(driver.page_source)<br>    srcs = html.xpath(src_path)<br>    titles = html.xpath(title_path)<br>    for src , title in zip(srcs,titles):<br>        load_photo(src,title.text)","like_count":0},{"had_liked":false,"id":171331,"user_name":"groot888","can_delete":false,"product_type":"c1","uid":1266597,"ip_address":"","ucode":"50E50681D6BE0C","user_header":"https://thirdwx.qlogo.cn/mmopen/vi_32/oseia6IjJIPziamTI2EQ0Bpr8icUicXTea2UuH105t4Bia4yFwBHld49cIQbjORvDdTtMCVdL39H9WxFwzyXspqqHUg/132","comment_is_top":false,"comment_ctime":1578903689,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1578903689","product_id":100021701,"comment_content":"è¿™é‡Œä½ éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œå¦‚æœçˆ¬å–çš„é¡µé¢æ˜¯åŠ¨æ€é¡µé¢ï¼Œå°±éœ€è¦å…³æ³¨ XHR æ•°æ®ã€‚<br>------<br>è¿™éƒ¨åˆ†æœ‰ç‚¹è·³è·ƒï¼Œè‡ªå·±æœäº†ä¸‹ï¼Œä¾›å¤§å®¶å‚è€ƒï¼šxhrï¼Œå…¨ç§°ä¸ºXMLHttpRequestï¼Œç”¨äºä¸æœåŠ¡å™¨äº¤äº’æ•°æ®ï¼Œxhré‡Œå°è£…äº†æµè§ˆå™¨å‘æœåŠ¡å™¨çš„è¯·æ±‚ä¿¡æ¯ï¼Œå®ƒæ˜¯ajaxåŠŸèƒ½å®ç°çš„æ•°æ®ä¼ è¾“å¯¹è±¡ã€‚é‚£ä»€ä¹ˆæ˜¯ajaxå‘¢ï¼Ÿå°±æ˜¯ä¸€ç§èƒ½å¤ŸåŠ¨æ€åŠ è½½é¡µé¢çš„æŠ€æœ¯ï¼Œç®€å•æ¥è¯´ï¼Œå°±æ˜¯ä¸éœ€è¦åˆ·æ–°ï¼Œå°±èƒ½æ˜¾ç¤ºæ•°æ®ï¼Œæ¯”å¦‚æˆ‘ä»¬çš„è¯„è®ºæˆ–è€…è¡¨æ ¼ï¼Œç‚¹å‡»æäº¤ï¼Œä¸ç”¨åˆ·æ–°ç½‘é¡µï¼Œå°±ç«‹åˆ»æ˜¾ç¤ºå‡ºæ¥äº†ã€‚<br>è±†ç“£è¿™ä¸ªæœç´¢ï¼Œç¿»é¡µå°±èƒ½æ˜¾ç¤ºåŠŸèƒ½ï¼Œä¸éœ€è¦åˆ·æ–°ï¼Œæ‰€ä»¥è¯´æ˜¯ç”¨åˆ°ajaxæŠ€æœ¯ï¼Œæ€ä¹ˆæŸ¥çœ‹ä»–çš„ä¼ è¾“å¯¹è±¡xhrï¼Ÿç‚¹å‡»chromeã€å¼€å‘ã€‘ï¼Œé€‰ã€æ˜¾ç¤ºç½‘é¡µæ£€æŸ¥å™¨ã€‘ï¼Œé€‰ã€ç½‘ç»œã€‘ï¼Œç‚¹å‡»xhrï¼Œç„¶åé‡æ–°åˆ·æ–°ç½‘é¡µï¼Œå°±ä¼šçœ‹åˆ°xhrè¯·æ±‚ï¼Œæ‹·è´å·¦è¾¹çš„é“¾æ¥å°±èƒ½çœ‹åˆ°ï¼Œhttps:&#47;&#47;www.douban.com&#47;j&#47;search_photo?q=%E7%8E%8B%E7%A5%96%E8%B4%A4&amp;limit=20&amp;start=0<br>","like_count":0},{"had_liked":false,"id":170062,"user_name":"è¥¿é£å‡‹ç¢§æ ‘","can_delete":false,"product_type":"c1","uid":1396867,"ip_address":"","ucode":"F068F0E5B1ECB8","user_header":"https://static001.geekbang.org/account/avatar/00/15/50/83/5c7394ec.jpg","comment_is_top":false,"comment_ctime":1578500490,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1578500490","product_id":100021701,"comment_content":"html = requests.get(url).text æ­¤å¤„è¦åŠ headerå’Œcookies,python3.7.","like_count":0},{"had_liked":false,"id":164433,"user_name":"æ˜ç¿¼","can_delete":false,"product_type":"c1","uid":1068361,"ip_address":"","ucode":"E77F86BEB3D5C1","user_header":"https://static001.geekbang.org/account/avatar/00/10/4d/49/28e73b9c.jpg","comment_is_top":false,"comment_ctime":1576989099,"is_pvip":false,"replies":[{"id":"62588","content":"æŒºå¥½çš„æ•´ç†","user_name":"ä½œè€…å›å¤","user_name_real":"cy","uid":"1306094","ctime":1577071525,"ip_address":"","comment_id":164433,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1576989099","product_id":100021701,"comment_content":"æ¨¡æ‹Ÿæµè§ˆå™¨ä¸‹è½½å›¾ç‰‡çš„å¯ä»¥å‚è€ƒhttps:&#47;&#47;mp.weixin.qq.com&#47;s&#47;1qAcKbtV2Mr_Q-ieb_8gqg","like_count":0,"discussions":[{"author":{"id":1306094,"avatar":"https://static001.geekbang.org/account/avatar/00/13/ed/ee/c4779b67.jpg","nickname":"cy","note":"","ucode":"50D653399A31F6","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":478765,"discussion_content":"æŒºå¥½çš„æ•´ç†","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1577071525,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":148627,"user_name":"J.Smile","can_delete":false,"product_type":"c1","uid":1336475,"ip_address":"","ucode":"C4D98DFDBF7584","user_header":"https://static001.geekbang.org/account/avatar/00/14/64/9b/0b578b08.jpg","comment_is_top":false,"comment_ctime":1573040689,"is_pvip":false,"replies":[{"id":"59745","content":"è°¢è°¢Jeff","user_name":"ä½œè€…å›å¤","user_name_real":"cy","uid":"1306094","ctime":1574739054,"ip_address":"","comment_id":148627,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1573040689","product_id":100021701,"comment_content":"è€å¸ˆï¼Œä½ è®°å½•çš„ç¬”è®°å¥½æ¼‚äº®å•Š","like_count":0,"discussions":[{"author":{"id":1306094,"avatar":"https://static001.geekbang.org/account/avatar/00/13/ed/ee/c4779b67.jpg","nickname":"cy","note":"","ucode":"50D653399A31F6","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":473557,"discussion_content":"è°¢è°¢Jeff","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1574739054,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":144070,"user_name":"é™³é™½","can_delete":false,"product_type":"c1","uid":1189398,"ip_address":"","ucode":"3106F39F39A9A7","user_header":"https://static001.geekbang.org/account/avatar/00/12/26/16/9de2666e.jpg","comment_is_top":false,"comment_ctime":1571838578,"is_pvip":false,"replies":[{"id":"59762","content":"è°¢è°¢é™³é™½åŒå­¦","user_name":"ä½œè€…å›å¤","user_name_real":"cy","uid":"1306094","ctime":1574740105,"ip_address":"","comment_id":144070,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1571838578","product_id":100021701,"comment_content":"ä¸é”™","like_count":0,"discussions":[{"author":{"id":1306094,"avatar":"https://static001.geekbang.org/account/avatar/00/13/ed/ee/c4779b67.jpg","nickname":"cy","note":"","ucode":"50D653399A31F6","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":471803,"discussion_content":"è°¢è°¢é™³é™½åŒå­¦","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1574740105,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":136240,"user_name":"Geek_59c20a","can_delete":false,"product_type":"c1","uid":1583175,"ip_address":"","ucode":"9D8AB7BEB7CE1E","user_header":"http://thirdwx.qlogo.cn/mmopen/vi_32/PiajxSqBRaELpZP5ibDGgbv5RBv7XoXS4oKVGqVuF29mvdiaIegLvkInphUN6Tgiabl2VQBiaRfpIiaRCrmDyOV4ZsUA/132","comment_is_top":false,"comment_ctime":1569394241,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1569394241","product_id":100021701,"comment_content":"è¿™ä¸€èŠ‚è¯¾è·¨åº¦å¤ªå¤§ å¾ˆå¤šåœ°æ–¹æ²¡æœ‰ç»†è®² ä¸²ä¸èµ·æ¥å•Š","like_count":0},{"had_liked":false,"id":126057,"user_name":"é”¦æ——å°èƒ½çŒ«","can_delete":false,"product_type":"c1","uid":1205530,"ip_address":"","ucode":"527AD041591AEB","user_header":"https://static001.geekbang.org/account/avatar/00/12/65/1a/5f3d7f5f.jpg","comment_is_top":false,"comment_ctime":1566302538,"is_pvip":true,"replies":[{"id":"62756","content":"è¿™ä¸¤ä¸ªæ˜¯æ¯”è¾ƒå¸¸è§çš„é—®é¢˜ï¼Œchromedriveéœ€è¦ä¸‹è½½å¯¹åº”çš„ç‰ˆæœ¬ï¼Œç„¶åæŒ‡å®šè·¯å¾„<br>xpath å¯ä»¥ä½¿ç”¨Chromeçš„xpath helperï¼Œå¸®åŠ©æ•è·å…ƒç´ çš„xpath å¹¶éªŒè¯xpathè¡¨è¾¾å¼æ˜¯å¦æ­£ç¡®","user_name":"ä½œè€…å›å¤","user_name_real":"cy","uid":"1306094","ctime":1577089493,"ip_address":"","comment_id":126057,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1566302538","product_id":100021701,"comment_content":"æˆ‘è§‰å¾—è€å¸ˆè¿™ä¸ªæ­¥éª¤å°±åº”è¯¥å†™å‡ºæ¥ å¾ˆå¤šäººé—®chromedriveæŠ¥é”™å’Œxpathè¿™å—ï¼Œè·Ÿç€åšä¼°è®¡æ˜¯çœ‹ä¸å¤ªæ‡‚","like_count":0,"discussions":[{"author":{"id":1306094,"avatar":"https://static001.geekbang.org/account/avatar/00/13/ed/ee/c4779b67.jpg","nickname":"cy","note":"","ucode":"50D653399A31F6","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":463806,"discussion_content":"è¿™ä¸¤ä¸ªæ˜¯æ¯”è¾ƒå¸¸è§çš„é—®é¢˜ï¼Œchromedriveéœ€è¦ä¸‹è½½å¯¹åº”çš„ç‰ˆæœ¬ï¼Œç„¶åæŒ‡å®šè·¯å¾„\nxpath å¯ä»¥ä½¿ç”¨Chromeçš„xpath helperï¼Œå¸®åŠ©æ•è·å…ƒç´ çš„xpath å¹¶éªŒè¯xpathè¡¨è¾¾å¼æ˜¯å¦æ­£ç¡®","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1577089493,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":121251,"user_name":"tt","can_delete":false,"product_type":"c1","uid":1489957,"ip_address":"","ucode":"7753B79AD5A9AC","user_header":"https://static001.geekbang.org/account/avatar/00/16/bc/25/1c92a90c.jpg","comment_is_top":false,"comment_ctime":1565086501,"is_pvip":false,"replies":[{"id":"63577","content":"å¯¹ å¾ˆå¥½çš„å»ºè®®ï¼ŒæŠ“å–ä¸é¢‘ç¹çš„æ—¶å€™ åº”è¯¥è¿˜å¥½","user_name":"ä½œè€…å›å¤","user_name_real":"cy","uid":"1306094","ctime":1577518906,"ip_address":"","comment_id":121251,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1565086501","product_id":100021701,"comment_content":"ä¸è¦ç”¨åç¨‹æˆ–çº¿ç¨‹æ± ä¸‹è½½ï¼Œå¦åˆ™Ipåœ°å€ä¼šè¢«åˆ—å…¥é»‘åå•","like_count":0,"discussions":[{"author":{"id":1306094,"avatar":"https://static001.geekbang.org/account/avatar/00/13/ed/ee/c4779b67.jpg","nickname":"cy","note":"","ucode":"50D653399A31F6","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":461705,"discussion_content":"å¯¹ å¾ˆå¥½çš„å»ºè®®ï¼ŒæŠ“å–ä¸é¢‘ç¹çš„æ—¶å€™ åº”è¯¥è¿˜å¥½","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1577518906,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":118204,"user_name":"å»ºå¼º","can_delete":false,"product_type":"c1","uid":1397126,"ip_address":"","ucode":"62B03D0E0C64EC","user_header":"https://static001.geekbang.org/account/avatar/00/15/51/86/b5fd8dd8.jpg","comment_is_top":false,"comment_ctime":1564290329,"is_pvip":false,"replies":[{"id":"63623","content":"OK","user_name":"ä½œè€…å›å¤","user_name_real":"cy","uid":"1306094","ctime":1577525277,"ip_address":"","comment_id":118204,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1564290329","product_id":100021701,"comment_content":"è€å¸ˆï¼Œå¦‚ä½•é€šè¿‡webdriverè·å–htmlè¿™ä¸ªå…³é”®ç¯èŠ‚æ²¡æœ‰æåˆ°ï¼Œå› ä¸ºè‡ªå·±æ²¡ç»éªŒåœ¨ç½‘ä¸ŠæŸ¥äº†å¥½äº›èµ„æ–™ä¹Ÿä¸å¾—è¦é¢†ï¼Œåæ¥çœ‹äº†æœ‰äº›åŒå­¦çš„ç•™è¨€æ‰æ˜ç™½ï¼Œå¸Œæœ›è€å¸ˆä»¥ååœ¨å…³é”®ç¯èŠ‚èƒ½åœ¨ç»†åŒ–ä¸€ç‚¹ã€‚","like_count":0,"discussions":[{"author":{"id":1306094,"avatar":"https://static001.geekbang.org/account/avatar/00/13/ed/ee/c4779b67.jpg","nickname":"cy","note":"","ucode":"50D653399A31F6","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":460300,"discussion_content":"OK","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1577525277,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":110933,"user_name":"xqs42b","can_delete":false,"product_type":"c1","uid":1590102,"ip_address":"","ucode":"E1B85D10E44672","user_header":"https://static001.geekbang.org/account/avatar/00/18/43/56/3572a20c.jpg","comment_is_top":false,"comment_ctime":1562398830,"is_pvip":false,"replies":[{"id":"63744","content":"Good Job","user_name":"ä½œè€…å›å¤","user_name_real":"cy","uid":"1306094","ctime":1577530964,"ip_address":"","comment_id":110933,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1562398830","product_id":100021701,"comment_content":"# coding=utf-8<br><br>import requests<br>import time<br>import json<br><br>    <br>headers = {<br>    &#39;Accept&#39;: &#39;text&#47;html,application&#47;xhtml+xml,application&#47;xml;q=0.9,image&#47;webp,image&#47;apng,*&#47;*;q=0.8,application&#47;signed-exchange;v=b3&#39;,<br>    &#39;Accept-Encoding&#39;: &#39;gzip, deflate, br&#39;,<br>    &#39;Accept-Language&#39;: &#39;zh-CN,zh;q=0.9&#39;,<br>    &#39;Cache-Control&#39;: &#39;max-age=0&#39;,<br>    &#39;Connection&#39;: &#39;keep-alive&#39;,<br>    &#39;Host&#39;: &#39;www.douban.com&#39;,<br>    &#39;Upgrade-Insecure-Requests&#39;: &#39;1&#39;,<br>    &#39;User-Agent&#39;: &#39;Mozilla&#47;5.0 (X11; Linux x86_64) AppleWebKit&#47;537.36 (KHTML, like Gecko) Ubuntu Chromium&#47;75.0.3770.90 Chrome&#47;75.0.3770.90 Safari&#47;537.36&#39;<br>}<br><br>def downloads(img_url, referer_url):<br>    print(img_url)<br>    headers = {<br>        &#39;accept&#39;: &#39;text&#47;html,application&#47;xhtml+xml,application&#47;xml;q=0.9,image&#47;webp,image&#47;apng,*&#47;*;q=0.8,application&#47;signed-exchange;v=b3&#39;,<br>        &#39;accept-encoding&#39;: &#39;gzip, deflate, br&#39;,<br>        &#39;accept-language&#39;: &#39;zh-CN,zh;q=0.9&#39;,<br>        &#39;referer&#39;: referer_url,<br>        &#39;upgrade-insecure-requests&#39;: &#39;1&#39;,<br>        &#39;user-agent&#39;: &#39;Mozilla&#47;5.0 (X11; Linux x86_64) AppleWebKit&#47;537.36 (KHTML, like Gecko) Ubuntu Chromium&#47;75.0.3770.90 Chrome&#47;75.0.3770.90 Safari&#47;537.36&#39;<br>    }<br>    img_content = requests.get(img_url, headers=headers)<br>    current_tm = str(time.time())<br>    img_name = &#39;%s.webp&#39;%current_tm<br>    with open(img_name, &#39;wb&#39;) as f:<br>        f.write(img_content.content)<br>    return True<br>    <br>for i in range(20):<br>    url = &#39;https:&#47;&#47;www.douban.com&#47;j&#47;search_photo?q=%E7%8E%8B%E7%A5%96%E8%B4%A4&amp;limit=20&amp;start=&#39;<br>    tmp_i = i * 20<br>    url0 = url + str(tmp_i)<br>    res_json = requests.get(url0, headers=headers)<br>    res_dict = json.loads(res_json.content)<br>    images_list = res_dict[&#39;images&#39;]<br>    for images in images_list:<br>        downloads(images[&#39;src&#39;], url0)<br>    time.sleep(3)","like_count":0,"discussions":[{"author":{"id":1306094,"avatar":"https://static001.geekbang.org/account/avatar/00/13/ed/ee/c4779b67.jpg","nickname":"cy","note":"","ucode":"50D653399A31F6","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":457130,"discussion_content":"Good Job","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1577530964,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":105595,"user_name":"Geek_dd384f","can_delete":false,"product_type":"c1","uid":1350086,"ip_address":"","ucode":"4C009F32AF6839","user_header":"","comment_is_top":false,"comment_ctime":1561038744,"is_pvip":false,"replies":[{"id":"64069","content":"Good Job","user_name":"ä½œè€…å›å¤","user_name_real":"cy","uid":"1306094","ctime":1577608660,"ip_address":"","comment_id":105595,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1561038744","product_id":100021701,"comment_content":"# coding:utf-8<br>import requests<br>import json<br>from selenium import webdriver<br>from  lxml import etree<br>import os<br>import sys;<br>reload(sys);<br>sys.setdefaultencoding(&quot;utf8&quot;)<br><br>def download(src, id):<br>        dir = &#39;%s&#47;&#39;%(picpath) + str(id) + &#39;.webp&#39;<br>    try:<br>        pic = requests.get(src, timeout=10)<br>        fp = open(dir, &#39;wb&#39;)<br>        fp.write(pic.content)<br>        fp.close()<br>    except requests.exceptions.ConnectionError:<br>        print(&#39;å›¾ç‰‡æ— æ³•ä¸‹è½½&#39;)<br><br>request_url=&#39;https:&#47;&#47;movie.douban.com&#47;subject_search?search_text=ç‹ç¥–è´¤&amp;cat=1002&#39;<br>src_xpath = &#39;&#47;&#47;div[@class=\\&#39;item-root\\&#39;]&#47;a[@class=\\&#39;cover-link\\&#39;]&#47;img[@class=\\&#39;cover\\&#39;]&#47;@src&#39;<br>title_xpath = &#39;&#47;&#47;div[@class=\\&#39;item-root\\&#39;]&#47;div[@class=\\&#39;detail\\&#39;]&#47;div[@class=\\&#39;title\\&#39;]&#47;a[@class=\\&#39;title-text\\&#39;]&#39;<br><br>driver = webdriver.Chrome(&#39;&#47;Users&#47;Downloads&#47;chromedriver&#39;)<br>&#39;&#39;&#39;<br># å•é¡µä¸‹è½½æµ‹è¯•<br>driver.get(request_url)<br>#etree.HTML():æ„é€ äº†ä¸€ä¸ªXPathè§£æå¯¹è±¡å¹¶å¯¹HTMLæ–‡æœ¬è¿›è¡Œè‡ªåŠ¨ä¿®æ­£<br>html = etree.HTML(driver.page_source)<br>srcs = html.xpath(src_xpath)<br>titles = html.xpath(title_xpath)<br>for i in titles:<br>    print i.text<br>picpath = &#39;&#47;Users&#47;Downloads&#47;ç‹ç¥–è´¤ç”µå½±æµ·æŠ¥&#47;&#39;<br>if not os.path.isdir(picpath):<br>    os.mkdir(picpath)<br>for src,title in zip(srcs, titles):<br>    download(src, title.text.replace(&#39; &#39;,&#39;&#39;))<br>driver.close()<br>&#39;&#39;&#39;<br>picpath = &#39;&#47;Users&#47;Downloads&#47;ç‹ç¥–è´¤ç”µå½±æµ·æŠ¥&#47;&#39;<br>if not os.path.isdir(picpath):<br>    os.mkdir(picpath)<br>#æ¯é¡µ15ä¸ªï¼Œæœ‰7é¡µ  å¼€å§‹åˆ†åˆ«æ˜¯0 15  30 ... 75<br>for i in range(0, 76, 15):<br>     url = request_url + &#39;&amp;start=&#39; + str(i)<br>     driver.get(url)<br>     html = etree.HTML(driver.page_source)<br>     srcs = html.xpath(src_xpath)<br>     titles = html.xpath(title_xpath)<br>     for src,title in zip(srcs, titles):<br>        download(src, title.text.replace(&#39; &#39;,&#39;&#39;))<br>driver.close()","like_count":0,"discussions":[{"author":{"id":1306094,"avatar":"https://static001.geekbang.org/account/avatar/00/13/ed/ee/c4779b67.jpg","nickname":"cy","note":"","ucode":"50D653399A31F6","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":454734,"discussion_content":"Good Job","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1577608660,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":104912,"user_name":"WingÂ·ä¸‰é‡‘","can_delete":false,"product_type":"c1","uid":1341402,"ip_address":"","ucode":"6B9F5822C3717F","user_header":"https://static001.geekbang.org/account/avatar/00/14/77/da/54c663f3.jpg","comment_is_top":false,"comment_ctime":1560868887,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1560868887","product_id":100021701,"comment_content":"XHR çš„æŸ¥çœ‹ï¼šå¼€å‘è€…æ¨¡å¼-æ‰¾åˆ°Network-æ‰¾åˆ°XHR","like_count":0},{"had_liked":false,"id":85617,"user_name":"No.5","can_delete":false,"product_type":"c1","uid":1488503,"ip_address":"","ucode":"1F2887B8560807","user_header":"https://static001.geekbang.org/account/avatar/00/16/b6/77/a2b5fd77.jpg","comment_is_top":false,"comment_ctime":1555144915,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1555144915","product_id":100021701,"comment_content":"å®Œæ•´çš„è„šæœ¬ï¼Ÿ","like_count":0},{"had_liked":false,"id":84353,"user_name":"Geek_0306cc","can_delete":false,"product_type":"c1","uid":1363156,"ip_address":"","ucode":"8C3F8BED201416","user_header":"http://thirdwx.qlogo.cn/mmopen/vi_32/H5r1zZbXejrVrCDvH3hvibZ3icpGUua2fiaczARR9myYBMyAX5dO5EribA2JWpdZaB3ia3Qsr5wj1ubWJzZQFjpr0KQ/132","comment_is_top":false,"comment_ctime":1554854197,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1554854197","product_id":100021701,"comment_content":"æœ€ç®€å•çš„å°±æ˜¯urllib.urlretrieveï¼Œä¸è¡Œçš„è¯zaiyongrequeståŠ è¯·æ±‚å‚æ•°","like_count":0},{"had_liked":false,"id":76986,"user_name":"æ°¸é™ä¸æ¯ä¹‹é›¨","can_delete":false,"product_type":"c1","uid":1362563,"ip_address":"","ucode":"087A934F68E445","user_header":"https://static001.geekbang.org/account/avatar/00/14/ca/83/684361be.jpg","comment_is_top":false,"comment_ctime":1552794057,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1552794057","product_id":100021701,"comment_content":"import pandas as pd<br>from pandas import Series,DataFrame<br>import json<br>import requests<br><br>def download(src,id):<br>    dir=&#39;..&#47;&#39;+str(id)+&#39;.webp&#39; #è¿™é‡Œå›¾ç‰‡ä¸ºwebpæ ¼å¼<br>    try:<br>        pic=requests.get(src,timeout=10)<br>    except requests.exceptions.ConnectionError:<br>            print(&#39;å›¾ç‰‡æ— æ³•ä¸‹è½½&#39;)<br>    fp=open(dir,&#39;wb&#39;) #ä»¥äºŒè¿›åˆ¶æ ¼å¼æ‰“å¼€ä¸€ä¸ªæ–‡ä»¶åªç”¨äºå†™å…¥ã€‚<br>    fp.write(pic.content)<br>    fp.close()<br>from lxml import etree #XPathå®šä½ç”¨åˆ°è§£æåº“lxml<br>from selenium import webdriver<br>driver = webdriver.Chrome(executable_path = &#39;C:\\Program Files (x86)\\Google\\Chrome\\Application\\chromedriver.exe&#39;)<br>driver.get(&quot;https:&#47;&#47;movie.douban.com&#47;subject_search?search_text=%E7%8E%8B%E7%A5%96%E8%B4%A4&amp;cat=1002&quot;)<br>html=etree.HTML(driver.page_source)#<br>srcs=html.xpath(&quot;&#47;&#47;div[@class=&#39;item-root&#39;]&#47;a[@class=&#39;cover-link&#39;]&#47;img[@class=&#39;cover&#39;]&#47;@src&quot;)<br>titles=html.xpath(&quot;&#47;&#47;div[@class=&#39;item-root&#39;]&#47;div[@class=&#39;detail&#39;]&#47;div[@class=&#39;title&#39;]&#47;a[@class=&#39;title-text&#39;]&quot;)<br>for src,title in zip(srcs,titles): #zip(A,B)ä¸¤ä¸ªåˆ—è¡¨åˆå¹¶æˆä¸€ä¸ªå…ƒç»„åˆ—è¡¨<br>    print(src)<br>    download(src,title.text)<br><br><br>è¾“å‡ºç»“æœ<br>Traceback (most recent call last):<br>  File &quot;D:&#47;Users&#47;17617&#47;PycharmProjects&#47;untitled&#47;zhouæ˜Ÿé©°.py&quot;, line 25, in &lt;module&gt;<br>    download(src,title.text)<br>  File &quot;D:&#47;Users&#47;17617&#47;PycharmProjects&#47;untitled&#47;zhouæ˜Ÿé©°.py&quot;, line 13, in download<br>    fp=open(dir,&#39;wb&#39;) #ä»¥äºŒè¿›åˆ¶æ ¼å¼æ‰“å¼€ä¸€ä¸ªæ–‡ä»¶åªç”¨äºå†™å…¥ã€‚<br>OSError: [Errno 22] Invalid argument: &#39;..&#47;åŒ—äº¬çŒ¿äºº åŒ—äº¬åŸäºº Who are you?\\u200e (1997).webp&#39;<br><br>æœ‰æ²¡æœ‰å¤§ç¥å¸®å¿™çœ‹ä¸€ä¸‹","like_count":0},{"had_liked":false,"id":70161,"user_name":"ğŸ‡¿ ğŸ‡¾ ğŸ‡¯ Â®","can_delete":false,"product_type":"c1","uid":1245820,"ip_address":"","ucode":"9DC86488B178F6","user_header":"https://static001.geekbang.org/account/avatar/00/13/02/7c/215673de.jpg","comment_is_top":false,"comment_ctime":1551018860,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1551018860","product_id":100021701,"comment_content":"è€å¸ˆæ‚¨èƒ½ä¸èƒ½å¸®æˆ‘çœ‹ä¸‹å“ªé‡Œæœ‰é”™ï¼Œæˆ‘ä»pycharmæ¢åˆ°äº†jupyteréƒ½ä¸‹åœ¨ä¸äº†å›¾ç‰‡æµ·æŠ¥ã€‚ç¬¬ä¸€ä¸ªforå¾ªç¯ç”¨print å¯ä»¥è¾“å‡ºå†…å®¹ï¼Œç¬¬äºŒä¸ªfor å¾ªç¯æ²¡æœ‰ä»»ä½•è¾“å‡ºã€‚<br># coding:utf-8<br><br>import requests<br>import json<br>from selenium import webdriver<br>from lxml import etree<br>import os<br><br><br>query = &#39;å´äº¬&#39;<br>path = &#39;E:\\A\\images&#39;<br>driver = &quot;E:\\chromedriver_win32\\chromedriver.exe&quot;<br>browser = webdriver.Chrome(executable_path=driver)<br>url1 = &#39;https:&#47;&#47;movie.douban.com&#47;subject_search?search_text=&#39;+&#39;å´äº¬&#39;+&#39;&amp;cat=1002&amp;start=&#39;<br><br>def download(src,id):<br>    dir = path + str(id) + &#39;.jpg&#39;<br>    try:<br>        pic = requests.get(src,timeout=10)<br>    except requests.exceptions.ConnectionError:<br>        print(&quot;å›¾ç‰‡æ— æ³•ä¸‹è½½&quot;)<br>    fp = open(dir,&#39;wb&#39;)<br>    fp.write(pic.content)<br>    fp.close()<br><br><br>for i in range(0,5*15,15):<br>    url = url1 + str(i)<br>    browser.get(url)<br>    <br>    html = etree.HTML(browser.page_source)<br>    #print(browser.page_source)<br>    src_xpath = &quot;&#47;&#47;*[@class=&#39;item-t&#39;]&#47;a&#47;img&#47;@src&quot;<br>    title_xpath = &quot;&#47;&#47;*[@class=&#39;item-root&#39;]&#47;div[@class=&#39;detail&#39;]&#47;div[@class=&#39;title&#39;]&#47;a&#47;text()&quot;<br>    srcs = html.xpath(src_xpath)<br>    titles = html.xpath(title_xpath)<br>    #print(srcs)<br>    #print(titles)\\\\<br>    for src,title in zip(srcs,titles):<br>        download(src.title)","like_count":0},{"had_liked":false,"id":68693,"user_name":"æ‰§ç¬”ï¼Œå°å¿ƒ","can_delete":false,"product_type":"c1","uid":1352308,"ip_address":"","ucode":"415F9D8922E54A","user_header":"https://static001.geekbang.org/account/avatar/00/14/a2/74/ddb58244.jpg","comment_is_top":false,"comment_ctime":1550575730,"is_pvip":false,"replies":[{"id":"64526","content":"å¯ä»¥ç”¨xpath helperå¸®åŠ©æå–","user_name":"ä½œè€…å›å¤","user_name_real":"cy","uid":"1306094","ctime":1577621286,"ip_address":"","comment_id":68693,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1550575730","product_id":100021701,"comment_content":"å‘ç°xpathè¿™å—ä¸ä¼šäº†","like_count":0,"discussions":[{"author":{"id":1306094,"avatar":"https://static001.geekbang.org/account/avatar/00/13/ed/ee/c4779b67.jpg","nickname":"cy","note":"","ucode":"50D653399A31F6","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":439801,"discussion_content":"å¯ä»¥ç”¨xpath helperå¸®åŠ©æå–","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1577621286,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":68219,"user_name":"littlePerfect","can_delete":false,"product_type":"c1","uid":1243521,"ip_address":"","ucode":"99E8B9D004BE0D","user_header":"https://static001.geekbang.org/account/avatar/00/12/f9/81/54b1a5a8.jpg","comment_is_top":false,"comment_ctime":1550459655,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1550459655","product_id":100021701,"comment_content":"è€å¸ˆæˆ‘ç”¨ XPath çš„æ–¹æ³•ä¸‹è½½äº†å›¾ç‰‡ä½†æ˜¯æ‰“ä¸å¼€?","like_count":0},{"had_liked":false,"id":66281,"user_name":"ç‹å½¬æˆ","can_delete":false,"product_type":"c1","uid":1015045,"ip_address":"","ucode":"386803B8FC2DD5","user_header":"https://static001.geekbang.org/account/avatar/00/0f/7d/05/4bad0c7c.jpg","comment_is_top":false,"comment_ctime":1549903428,"is_pvip":false,"replies":[{"id":"64587","content":"å¤šè°¢åˆ†äº«","user_name":"ä½œè€…å›å¤","user_name_real":"cy","uid":"1306094","ctime":1577622064,"ip_address":"","comment_id":66281,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1549903428","product_id":100021701,"comment_content":"macç”¨æˆ·å¯åŠ¨ ChromeDriver æ–¹æ¡ˆï¼š<br>ä¸‹è½½chromedriverçš„2.46ç‰ˆæœ¬ï¼Œå› å…¶å¯¹åº”çš„Chromeç‰ˆæœ¬ä¸ºv71-73ï¼Œ<br>ä»£ç å±‚å†™å…¥å³å¯å¯åŠ¨ï¼š<br>from selenium import webdriver<br>driver = webdriver.Chrome(&#39;&#47;Users&#47;&#39;username&#39;&#47;Downloads&#47;chromedriver&#39;) &#47;&#47;æ‹¬å·å†…ä¸ºchromedriverå¯¹åº”çš„è·¯å¾„<br><br><br>","like_count":0,"discussions":[{"author":{"id":1306094,"avatar":"https://static001.geekbang.org/account/avatar/00/13/ed/ee/c4779b67.jpg","nickname":"cy","note":"","ucode":"50D653399A31F6","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":438770,"discussion_content":"å¤šè°¢åˆ†äº«","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1577622064,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":65876,"user_name":"çˆ±åšæ¢¦çš„å’¸é±¼","can_delete":false,"product_type":"c1","uid":1051256,"ip_address":"","ucode":"9D9642CF0752BB","user_header":"","comment_is_top":false,"comment_ctime":1549715429,"is_pvip":false,"replies":[{"id":"64598","content":"å¯ä»¥çš„","user_name":"ä½œè€…å›å¤","user_name_real":"cy","uid":"1306094","ctime":1577622206,"ip_address":"","comment_id":65876,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1549715429","product_id":100021701,"comment_content":"ä¸‹è½½çš„å›¾ç‰‡æ˜¯webpæ ¼å¼çš„ï¼ˆå¦‚æœç”¨chromeï¼‰ï¼Œmacä¸‹ä¸€èˆ¬æ— æ³•ç›´æ¥æ‰“å¼€ï¼Œéœ€è¦ç”¨pillowè½¬æˆjpgæ ¼å¼ï¼Œå¦‚æœoserrorå¯ä»¥pipå‡çº§ä¸‹ç‰ˆæœ¬ã€‚ã€‚","like_count":0,"discussions":[{"author":{"id":1306094,"avatar":"https://static001.geekbang.org/account/avatar/00/13/ed/ee/c4779b67.jpg","nickname":"cy","note":"","ucode":"50D653399A31F6","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":438622,"discussion_content":"å¯ä»¥çš„","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1577622206,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":63636,"user_name":"james","can_delete":false,"product_type":"c1","uid":1260477,"ip_address":"","ucode":"CB62CF7C4EF92D","user_header":"https://static001.geekbang.org/account/avatar/00/13/3b/bd/f9f780a4.jpg","comment_is_top":false,"comment_ctime":1548425210,"is_pvip":false,"replies":[{"id":"64657","content":"æ„Ÿè°¢åˆ†äº«","user_name":"ä½œè€…å›å¤","user_name_real":"cy","uid":"1306094","ctime":1577623545,"ip_address":"","comment_id":63636,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1548425210","product_id":100021701,"comment_content":"ä½œè€…å›å¤: å’±ä»¬è®¿é—®è±†ç“£æŸ¥è¯¢å›¾ç‰‡çš„ç½‘å€åº”è¯¥æ˜¯ä¸€æ ·çš„ã€‚åªæ˜¯æˆ‘ç»™å‡ºçš„æ˜¯jsonçš„é“¾æ¥ã€‚æ–¹æ³•æ˜¯ï¼šç”¨Chromeæµè§ˆå™¨çš„å¼€å‘è€…å·¥å…·ï¼Œå¯ä»¥ç›‘æµ‹å‡ºæ¥ç½‘é¡µä¸­æ˜¯å¦æœ‰jsonæ•°æ®çš„ä¼ è¾“ï¼Œæ‰€ä»¥æˆ‘ç»™å‡ºçš„é“¾æ¥æ˜¯jsonæ•°æ®ä¼ è¾“çš„é“¾æ¥ https:&#47;&#47;www.douban.com&#47;j&#47;search_photo?q=%E7%8E%8B%E7%A5%96%E8%B4%A4&amp;limit=20&amp;start=0<br><br>å¦‚ä½•ä½¿ç”¨ç”¨Chromeæµè§ˆå™¨çš„å¼€å‘è€…å·¥å…·ï¼ŒæŸ¥çœ‹åˆ°è¿™ä¸ªè·¯å¾„ï¼šhttps:&#47;&#47;www.douban.com&#47;j&#47;search_photo?q=%E7%8E%8B%E7%A5%96%E8%B4%A4&amp;limit=20&amp;start=0","like_count":0,"discussions":[{"author":{"id":1306094,"avatar":"https://static001.geekbang.org/account/avatar/00/13/ed/ee/c4779b67.jpg","nickname":"cy","note":"","ucode":"50D653399A31F6","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":437664,"discussion_content":"æ„Ÿè°¢åˆ†äº«","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1577623545,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":63631,"user_name":"james","can_delete":false,"product_type":"c1","uid":1260477,"ip_address":"","ucode":"CB62CF7C4EF92D","user_header":"https://static001.geekbang.org/account/avatar/00/13/3b/bd/f9f780a4.jpg","comment_is_top":false,"comment_ctime":1548423824,"is_pvip":false,"replies":[{"id":"64658","content":"äººå·¥æ£€ç´¢çš„æ—¶å€™ï¼Œè¿›è¡Œçš„URLè§‚å¯Ÿ","user_name":"ä½œè€…å›å¤","user_name_real":"cy","uid":"1306094","ctime":1577623563,"ip_address":"","comment_id":63631,"utype":1}],"discussion_count":3,"race_medal":0,"score":"1548423824","product_id":100021701,"comment_content":"è¯·é—®è€å¸ˆï¼Œè¿™ä¸ªé“¾æ¥æ˜¯æ€ä¹ˆå¾—åˆ°çš„ï¼š<br>https:&#47;&#47;www.douban.com&#47;j&#47;search_photo?q=ç‹ç¥–è´¤&amp;limit=20&amp;start=0","like_count":0,"discussions":[{"author":{"id":1306094,"avatar":"https://static001.geekbang.org/account/avatar/00/13/ed/ee/c4779b67.jpg","nickname":"cy","note":"","ucode":"50D653399A31F6","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":437660,"discussion_content":"äººå·¥æ£€ç´¢çš„æ—¶å€™ï¼Œè¿›è¡Œçš„URLè§‚å¯Ÿ","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1577623563,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1033956,"avatar":"http://thirdwx.qlogo.cn/mmopen/vi_32/QD6bf8hkS5dHrabdW7M7Oo9An1Oo3QSxqoySJMDh7GTraxFRX77VZ2HZ13x3R4EVYddIGXicRRDAc7V9z5cLDlA/132","nickname":"çˆ¬è¡Œçš„èœ—ç‰›","note":"","ucode":"6623B62DE63CE9","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":87302,"discussion_content":"chrome F12,é€‰æ‹©network,XHR,nameå¯¹åº”çš„å°±æ˜¯é“¾æ¥","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1576659820,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":1,"child_discussions":[{"author":{"id":2368766,"avatar":"","nickname":"lululucat","note":"","ucode":"D63D663E2E8CBE","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":1033956,"avatar":"http://thirdwx.qlogo.cn/mmopen/vi_32/QD6bf8hkS5dHrabdW7M7Oo9An1Oo3QSxqoySJMDh7GTraxFRX77VZ2HZ13x3R4EVYddIGXicRRDAc7V9z5cLDlA/132","nickname":"çˆ¬è¡Œçš„èœ—ç‰›","note":"","ucode":"6623B62DE63CE9","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":389777,"discussion_content":"ä½ å¥½ï¼Œä¸ºä»€ä¹ˆæˆ‘æŒ‰äº†XHRï¼Œå†åˆ·æ–°åï¼Œnameé‡Œé¢ä»€ä¹ˆä¹Ÿæ²¡æœ‰å‘¢","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1629428528,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":87302,"ip_address":""},"score":389777,"extra":""}]}]},{"had_liked":false,"id":63558,"user_name":"æ¼«é•¿çš„æˆ˜æ–—","can_delete":false,"product_type":"c1","uid":1149741,"ip_address":"","ucode":"9A14BB927D63D2","user_header":"https://static001.geekbang.org/account/avatar/00/11/8b/2d/08b5bf72.jpg","comment_is_top":false,"comment_ctime":1548400086,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1548400086","product_id":100021701,"comment_content":"å›ç­”ä¸€ä¸‹caidyçš„ç•™è¨€ã€‚ç ”ç©¶äº†ä¸€ä¸‹ï¼Œå¯èƒ½æ˜¯è¿™æ ·åšçš„ï¼š<br><br>åœ¨chromeä¸­æ‰“å¼€å·¥å…·ï¼Œé€‰æ‹©networkæ ‡ç­¾ï¼Œç‚¹å‡»XHRï¼Œå†ç‚¹å‡»Nameä¸‹çš„é‚£ä¸ªurlï¼Œå°±å¯ä»¥çœ‹åˆ°äº†ã€‚å…¶ä¸­çš„ä¹±ç æ˜¯â€œç‹ç¥–è´¤â€ç»è¿‡urlç¼–ç å¾—åˆ°çš„ã€‚åœ¨ç½‘ä¸Šæ‰¾ä¸ªå·¥å…·è½¬åŒ–ä¸€ä¸‹å°±å¯ä»¥äº†ã€‚","like_count":0},{"had_liked":false,"id":63527,"user_name":"Bernie","can_delete":false,"product_type":"c1","uid":1359928,"ip_address":"","ucode":"E082493F877A8D","user_header":"https://static001.geekbang.org/account/avatar/00/14/c0/38/667420c3.jpg","comment_is_top":false,"comment_ctime":1548392997,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1548392997","product_id":100021701,"comment_content":"è€å¸ˆï¼Œæˆ‘æ ¹æ®æ‚¨çš„è¯¾ç¨‹ å…¥é—¨äº†python å†™äº†ä¸€ä¸ªçˆ¬è™«è„šæœ¬   é‡åˆ°äº†æŒ‰é”®è¢«å±è”½çš„é—®é¢˜ è¯·é—®æ‚¨å¦‚ä½•è§£å†³è¿™ç±»é—®é¢˜çš„ å¤‡æ³¨ï¼šç½‘ä¸Šè¯´æ¨¡æ‹Ÿç¡¬ä»¶é©±åŠ¨å¯ä»¥è§£å†³ ä½†æˆ‘å°è¯•æ‰¾äº†ä¸€ä¸ªå¤§æ¼ æ’ä»¶ å¹¶è¿›è¡Œäº†æ›¿ä»£ ä¾ç„¶æ²¡æœ‰ä»€ä¹ˆæ•ˆæœ","like_count":0},{"had_liked":false,"id":63405,"user_name":"Sniper","can_delete":false,"product_type":"c1","uid":1385287,"ip_address":"","ucode":"8FEA9AE27A7A08","user_header":"https://static001.geekbang.org/account/avatar/00/15/23/47/6c2a60ee.jpg","comment_is_top":false,"comment_ctime":1548343532,"is_pvip":false,"replies":[{"id":"64665","content":"Good Job","user_name":"ä½œè€…å›å¤","user_name_real":"cy","uid":"1306094","ctime":1577623722,"ip_address":"","comment_id":63405,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1548343532","product_id":100021701,"comment_content":"äº¤ä½œä¸šï¼šç¯å¢ƒ  win10ï¼Œpycharmï¼Œ3.7<br>å·®ä¸€æ­¥æ ¼å¼webpè½¬jpgï¼Œæ„Ÿè§‰ç”¨å¤„ä¸æ˜¯å¾ˆå¤§ï¼Œæ²¡å†™<br>import requests<br>from lxml import etree<br>from selenium import webdriver<br><br><br>def download(src, name):<br>    dir = &#39;C:\\images\\\\&#39; + name + &#39;.webp&#39;<br>    # print(dir)<br>    try:<br>        pic = requests.get(src, timeout=10)<br>        # print(pic)<br>        fp = open(dir, &#39;wb&#39;)<br>        # print(fp)<br>        fp.write(pic.content)<br>        fp.close()<br>    except Exception:<br>        print(&quot;error,%s å½“å‰å›¾ç‰‡æ— æ³•ä¸‹è½½&quot; % src)<br><br><br>driver = webdriver.Chrome(&#39;.&#47;chromedriver&#39;)<br><br>print(type(driver))<br>for start in range(0, 15, 15):<br>    url = &#39;https:&#47;&#47;movie.douban.com&#47;subject_search?search_text=&#39;+&#39;å‘¨æ˜Ÿé©°&#39;+&#39;&amp;cat=1002&#39;+&#39;&amp;start=&#39;+str(start)<br>    driver.get(url)<br>    # print(driver.page_source)<br>    html = etree.HTML(driver.page_source)<br>    src_xpath = &quot;&#47;&#47;*[@class=&#39;item-root&#39;]&#47;a&#47;img&#47;@src&quot;<br>    title_xpath = &quot;&#47;&#47;*[@class=&#39;item-root&#39;]&#47;div[@class=&#39;detail&#39;]&#47;div[@class=&#39;title&#39;]&#47;a&#47;text()&quot;<br>    srcs = html.xpath(src_xpath)<br>    titles = html.xpath(title_xpath)<br>    # print(srcs,titles)<br>    for src,title in zip(srcs, titles):<br>        # print(src)<br>        # print(title)<br>        title = str(title)<br>        download(src, title)<br>","like_count":0,"discussions":[{"author":{"id":1306094,"avatar":"https://static001.geekbang.org/account/avatar/00/13/ed/ee/c4779b67.jpg","nickname":"cy","note":"","ucode":"50D653399A31F6","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":437574,"discussion_content":"Good Job","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1577623722,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":61480,"user_name":"lingmacker","can_delete":false,"product_type":"c1","uid":1353113,"ip_address":"","ucode":"2B61674AD47F34","user_header":"https://static001.geekbang.org/account/avatar/00/14/a5/99/db2f6325.jpg","comment_is_top":false,"comment_ctime":1547706364,"is_pvip":false,"replies":[{"id":"64709","content":"Good Job~","user_name":"ä½œè€…å›å¤","user_name_real":"cy","uid":"1306094","ctime":1577624556,"ip_address":"","comment_id":61480,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1547706364","product_id":100021701,"comment_content":"å‰ä¸¤ä¸ªæ˜ŸæœŸè€ƒè¯•ï¼Œæ²¡æ—¶é—´å­¦ä¹ ï¼Œè€ƒå®Œåæ‰å¼€å§‹å­¦ä¹ ã€‚ä¸€ä¸‹æ˜¯ä½¿ç”¨xpathä¸‹è½½è±†ç“£ç”µå½±çš„å°é¢ã€‚<br><br>import requests<br>from lxml import etree<br><br><br>def dowmload(name, src):<br>    path = &quot;.&#47;image&#47;video&#47;&quot;<br>    response = requests.get(src, timeout=10)<br>    img = open(path + name + &quot;.jpg&quot;, &quot;wb&quot;)<br>    img.write(response.content)<br>    img.close()<br><br><br>def main():<br>    # ä¸‹è½½åˆ˜äº¦è²ç”µå½±çš„æµ·æŠ¥<br>    r = requests.get(&quot;https:&#47;&#47;www.douban.com&#47;search?cat=1002&amp;q=%E5%88%98%E4%BA%A6%E8%8F%B2&quot;)<br>    html = etree.HTML(r.text)<br><br>    path = &#39;&#47;&#47;div[@class=&quot;result-list&quot;]&#47;div[@class=&quot;result&quot;]&#47;div[@class=&quot;pic&quot;]&#47;a&#47;img&#39;<br>    res = html.xpath(path)<br>    titles = html.xpath(path + &#39;&#47;..&#39;)<br><br>    for i in zip(titles, res):<br>        name = i[0].get(&quot;title&quot;)<br>        src = i[1].get(&quot;src&quot;)<br>        dowmload(name, src)<br><br><br>if __name__ == &#39;__main__&#39;:<br>    main()<br>","like_count":0,"discussions":[{"author":{"id":1306094,"avatar":"https://static001.geekbang.org/account/avatar/00/13/ed/ee/c4779b67.jpg","nickname":"cy","note":"","ucode":"50D653399A31F6","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":436883,"discussion_content":"Good Job~","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1577624556,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":61456,"user_name":"å°ç†ŠçŒ«","can_delete":false,"product_type":"c1","uid":1257442,"ip_address":"","ucode":"7549BA17FFBAD4","user_header":"https://static001.geekbang.org/account/avatar/00/13/2f/e2/3640e491.jpg","comment_is_top":false,"comment_ctime":1547701954,"is_pvip":false,"replies":[{"id":"64711","content":"Good Job~","user_name":"ä½œè€…å›å¤","user_name_real":"cy","uid":"1306094","ctime":1577624571,"ip_address":"","comment_id":61456,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1547701954","product_id":100021701,"comment_content":"ä¸‹è½½æ‰€æœ‰é¡µç é‡Œçš„å›¾ç‰‡<br><br># coding: utf-8<br>from selenium import webdriver<br>from lxml import etree<br>import os<br>import requests<br>import re<br><br>searchMovieKeys = &#39;ç‹ç¥–è´¤&#39;<br>MAX_PAGE = 6<br><br>def download(src, imgId):<br>    img_dir = &#39;D:\\\\Personal\\\\Code\\\\Jupyter\\\\æ•°æ®åˆ†æå®æˆ˜___æå®¢æ—¶é—´\\\\picture\\\\&#39;<br>    # å¯¹imgIdåšå­—ç¬¦ä¸²å¤„ç†ï¼Œåˆ é™¤å­—ç¬¦ä¸²ä¸­çš„ï¼Ÿ<br>    imgId = re.sub(r&#39;[?]&#39;, &#39;&#39;, str(imgId))<br>    if not os.path.exists(img_dir):<br>        os.mkdir(img_dir)<br>    try:<br>        response = requests.get(src, timeout=10)<br>        if response.status_code == 200:<br>            file_path = img_dir + imgId + &#39;.jpg&#39;<br>            if not os.path.exists(file_path):<br>                with open(file_path, &#39;wb&#39;) as f:<br>                    f.write(response.content)<br>            else:<br>                print(&#39;Already downloaded&#39;, file_path)<br>    except requests.ConnectionError:<br>        print(&#39;Failed to download&#39;)<br>    <br>def getMovieImages(page):<br>    print(&#39;æ­£åœ¨ä¸‹è½½ç¬¬&#39;, page+1, &#39;é¡µ&#39;)<br>    page = page * 15<br>    url = &#39;https:&#47;&#47;movie.douban.com&#47;subject_search?search_text=&#39; \\<br>            + searchMovieKeys + &#39;&amp;cat=1002&amp;start=&#39; + str(page)<br>    driver = webdriver.Chrome()<br>    driver.get(url)<br>    #print(driver.page_source)<br>    # 3. æå–æ•°æ®ï¼Œlxml è¿›è¡Œ XPath å®šä½<br>    html = etree.HTML(driver.page_source)<br>    src_xpath = &quot;&#47;&#47;div[@class=&#39;item-root&#39;]&#47;a[@class=&#39;cover-link&#39;]&#47;img[@class=&#39;cover&#39;]&#47;@src&quot;<br>    title_xpath = &quot;&#47;&#47;div[@class=&#39;item-root&#39;]&#47;div[@class=&#39;detail&#39;]&#47;div[@class=&#39;title&#39;]&#47;a[@class=&#39;title-text&#39;]&quot;<br>    srcs = html.xpath(src_xpath)<br>    titles = html.xpath(title_xpath)<br>    # è¿™é‡Œéœ€è¦å¤šä¸ªå˜é‡çš„forå¾ªç¯ï¼Œç”¨zip()<br>    for src, title in zip(srcs, titles):<br>        print(&#39;\\t&#39;.join([str(title.text), str(src)]))<br>        download(src, title.text)<br>    <br>    print(&#39;download finish&#39;)<br>    driver.close()<br>    <br>if __name__ == &#39;__main__&#39;:<br>    for i in range(0, MAX_PAGE):<br>        getMovieImages(i)","like_count":0,"discussions":[{"author":{"id":1306094,"avatar":"https://static001.geekbang.org/account/avatar/00/13/ed/ee/c4779b67.jpg","nickname":"cy","note":"","ucode":"50D653399A31F6","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":436875,"discussion_content":"Good Job~","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1577624571,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":61333,"user_name":"ææ²›æ¬£","can_delete":false,"product_type":"c1","uid":1362695,"ip_address":"","ucode":"98874954230D95","user_header":"https://static001.geekbang.org/account/avatar/00/14/cb/07/e34220d6.jpg","comment_is_top":false,"comment_ctime":1547682829,"is_pvip":false,"replies":[{"id":"64712","content":"æ…¢æ…¢æ¥~ ä»˜å‡ºå°±ä¼šæœ‰æ”¶è·","user_name":"ä½œè€…å›å¤","user_name_real":"cy","uid":"1306094","ctime":1577624588,"ip_address":"","comment_id":61333,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1547682829","product_id":100021701,"comment_content":"ä»Šå¤©çš„çœ‹å®Œäº†ï¼Œå…·ä½“è¯­æ³•æœ‰ç‚¹éš¾ï¼ŒJSONå’ŒXpathä¸¤ç§æŠ“å–æ–¹å¼ï¼Œéƒ½éœ€è¦æŒ‰ç…§è¯¾ç¨‹ä¸­çš„ä»£ç æ•²ä¸€éã€‚<br><br>å…«çˆªé±¼æŠ“å–å·²ç»å®éªŒæˆåŠŸï¼Œå¯ä»¥åšâ€œå°æ•°æ®â€åˆ†æï¼Œä¸è¿‡è¦ç”¨Pythonå®ç°ï¼Œè¿˜èµ°å¾ˆé•¿çš„è·¯è¦èµ°ã€‚<br><br>æœç„¶ï¼Œç¼–ç¨‹çš„ä¸–ç•Œï¼Œè·¯æ¼«æ¼«å…¶ä¿®è¿œå…®ã€‚","like_count":0,"discussions":[{"author":{"id":1306094,"avatar":"https://static001.geekbang.org/account/avatar/00/13/ed/ee/c4779b67.jpg","nickname":"cy","note":"","ucode":"50D653399A31F6","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":436836,"discussion_content":"æ…¢æ…¢æ¥~ ä»˜å‡ºå°±ä¼šæœ‰æ”¶è·","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1577624588,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":61239,"user_name":"LI.T.F","can_delete":false,"product_type":"c1","uid":1357691,"ip_address":"","ucode":"DDC0AB13CA605F","user_header":"https://static001.geekbang.org/account/avatar/00/14/b7/7b/0893dbd9.jpg","comment_is_top":false,"comment_ctime":1547643804,"is_pvip":false,"replies":[{"id":"64716","content":"æ²¡äº‹çš„ æ…¢æ…¢æ¥ï¼Œè¿™ä¸ªä½ å…ˆè·‘ä¸‹ä»£ç ï¼Œç„¶åå†æ…¢æ…¢ç†è§£","user_name":"ä½œè€…å›å¤","user_name_real":"cy","uid":"1306094","ctime":1577624640,"ip_address":"","comment_id":61239,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1547643804","product_id":100021701,"comment_content":"è™½ç„¶å­¦è¿‡Pythonï¼Œä½†æ˜¯è€å¸ˆå†™çš„è¿™ç¯‡æ–‡ç« å®Œå…¨çœ‹ä¸æ‡‚ï¼Œæ›´ä¸è¯´ä¼šç”¨äº†ï¼Œæ˜¯ä¸æ˜¯æˆ‘åŸºç¡€å¤ªå·®äº†ï¼Œå…³äºXPATHã€JSONã€Seleniumè¿™äº›åº“ä¹‹ç±»çš„å®Œå…¨æ‡µé€¼ã€‚æœ‰ç‚¹æ…Œäº†","like_count":0,"discussions":[{"author":{"id":1306094,"avatar":"https://static001.geekbang.org/account/avatar/00/13/ed/ee/c4779b67.jpg","nickname":"cy","note":"","ucode":"50D653399A31F6","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":436799,"discussion_content":"æ²¡äº‹çš„ æ…¢æ…¢æ¥ï¼Œè¿™ä¸ªä½ å…ˆè·‘ä¸‹ä»£ç ï¼Œç„¶åå†æ…¢æ…¢ç†è§£","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1577624640,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":57594,"user_name":"è·³è·³","can_delete":false,"product_type":"c1","uid":1172803,"ip_address":"","ucode":"80B697B89E1A0B","user_header":"https://static001.geekbang.org/account/avatar/00/11/e5/43/7bc7cfe3.jpg","comment_is_top":false,"comment_ctime":1546844440,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1546844440","product_id":100021701,"comment_content":"#ç›´æ¥æ ¹æ®è±†ç“£å›¾ç‰‡è·¯å¾„ä¸‹è½½<br># coding:utf-8<br>import requests<br>import json<br>query = &#39;ç‹ç¥–è´¤&#39;<br>&#39;&#39;&#39; ä¸‹è½½å›¾ç‰‡ &#39;&#39;&#39;<br>def download(src, id):<br>           dir = &#39;.&#47;&#39; + str(id) + &#39;.jpg&#39;<br>           try:<br>                     pic = requests.get(src, timeout=10)<br>           except requests.exceptions.ConnectionError:<br>                     #print &#39;error, %d å½“å‰å›¾ç‰‡æ— æ³•ä¸‹è½½&#39;, %id<br>                     print(&#39;å›¾ç‰‡æ— æ³•ä¸‹è½½&#39;)<br>           fp = open(dir, &#39;wb&#39;)<br>           fp.write(pic.content)<br>           fp.close()<br> <br>&#39;&#39;&#39; for å¾ªç¯ è¯·æ±‚å…¨éƒ¨çš„ url &#39;&#39;&#39;<br>for i in range(0, 22471, 20):<br>           url = &#39;https:&#47;&#47;www.douban.com&#47;j&#47;search_photo?q=&#39;+query+&#39;&amp;limit=20&amp;start=&#39;+str(i)<br>           html = requests.get(url).text    # å¾—åˆ°è¿”å›ç»“æœ<br>           response = json.loads(html,encoding=&#39;utf-8&#39;) # å°† JSON æ ¼å¼è½¬æ¢æˆ Python å¯¹è±¡<br>           for image in response[&#39;images&#39;]:<br>                     print image[&#39;src&#39;] # æŸ¥çœ‹å½“å‰ä¸‹è½½çš„å›¾ç‰‡ç½‘å€<br>                     download(image[&#39;src&#39;], image[&#39;id&#39;]) # ä¸‹è½½ä¸€å¼ å›¾ç‰‡<br>#é€šè¿‡è±†ç“£ç”µå½±ä¸‹è½½å›¾ç‰‡<br>åœ¨Xpath Helperä¸­é€‰ä¸­æµ·æŠ¥å’Œç”µå½±åç§°çš„Xpath<br>src_xpath=&quot;&#47;&#47;div[@class=&#39;item-root&#39;]&#47;a[@class=&#39;cover-link&#39;]&#47;img[@class=&#39;cover&#39;]&#47;@src&quot;<br>title_path=&quot;&#47;&#47;div[@class=&#39;item-root&#39;]&#47;div[@class=&#39;detail&#39;]&#47;div[@class=&#39;title&#39;]&#47;a[@class=&#39;title-text&#39;]&quot;<br>from selenium import webdriver<br>#åˆ›å»ºChromeæµè§ˆå™¨çš„driver<br>driver = webdriver.Chrome()<br>#é€šè¿‡è®¿é—®dirverè·å–çš„è®¿é—®é¡µé¢å®Œæ•´çš„html<br>driver.get(https:&#47;&#47;movie.douban.com&#47;subject_search?search_text=&#39;+ query +&#39;&amp;cat=1002)<br>srcs = html.xpath(src_xpath)<br>titles = html.xpath(title_path)<br>for src, title in zip(srcs, titles):<br>\tdownload(src, title.text)<br>drive.close()","like_count":0},{"had_liked":false,"id":57517,"user_name":"Jerry","can_delete":false,"product_type":"c1","uid":1310404,"ip_address":"","ucode":"B6C99477306866","user_header":"http://thirdwx.qlogo.cn/mmopen/vi_32/PiajxSqBRaEI0AL6EQyEY1MrDaiczGln4nPPAykofXCXibaz3CcRDuIk2nqLdnGTBJ1RIia4ZsPYqBSUGRwDJdmDeQ/132","comment_is_top":false,"comment_ctime":1546826669,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1546826669","product_id":100021701,"comment_content":"ä¸èƒ½ä»¥jpgæ‰“å¼€çš„åŸå› æ˜¯ä¸‹è½½äº†äºŒè¿›åˆ¶æ–‡ä»¶ï¼Œopenå‡½æ•°ä¸­å‚æ•°ä¸º&quot;wb&quot;","like_count":0},{"had_liked":false,"id":57464,"user_name":"nrvna","can_delete":false,"product_type":"c1","uid":1352764,"ip_address":"","ucode":"05830A97EF354D","user_header":"https://static001.geekbang.org/account/avatar/00/14/a4/3c/6d0a0cc8.jpg","comment_is_top":false,"comment_ctime":1546817809,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1546817809","product_id":100021701,"comment_content":"ç¬¬äºŒé¢˜æˆ‘çš„codeï¼Œå€Ÿé‰´äº†ç•™è¨€æ¿çš„å†…å®¹ï¼Œè½¬æ¢äº†å›¾ç‰‡webpæ ¼å¼ï¼ŒåˆåŠ äº†æ­£åˆ™å¤„ç†åå­—ä¸­çš„é—®å·é—®é¢˜ã€‚<br>import requests<br>from selenium import webdriver<br>from lxml import etree<br>import re<br><br>def download(src, name):<br>    url1 = src.split(&#39;webp&#39;)<br>    url2 = url1[0] + &#39;jpg&#39;<br>    dir = &#39;.&#47;data_pachong&#47;&#39; + str(name) + &#39;.jpg&#39;<br>    try:<br>        pic = requests.get(url2, timeout=10)<br>    except requests.exceptions.ConnectionError:<br>        # print &#39;error, %d å½“å‰å›¾ç‰‡æ— æ³•ä¸‹è½½&#39;, %id<br>        print(&#39;å›¾ç‰‡æ— æ³•ä¸‹è½½&#39;)<br><br>    fp = open(dir, &#39;wb&#39;)<br>    fp.write(pic.content)<br>    fp.close()<br><br><br>query = &#39;ç‹ç¥–è´¤&#39;<br>driver = webdriver.Chrome(&#39;D:\\Programming Software\\chromedriver&#39;)<br>for i in range(0, 6*15, 15):<br>    request_url = &#39;https:&#47;&#47;movie.douban.com&#47;subject_search?search_text=&#39;+query+&#39;&amp;cat=1002&amp;start=&#39;+str(i)<br>    driver.get(request_url)<br>    html = etree.HTML(driver.page_source) # è®¿é—®ç½‘é¡µï¼Œç„¶åæ‰“å°å‡ºæºä»£ç ,etreeè§£æä¸ºxpathå¯ä»¥æ“ä½œçš„å½±è§†<br><br>    src_xpath = &quot;&#47;&#47;*[@class=&#39;item-root&#39;]&#47;a&#47;img&#47;@src&quot;<br>    title_xpath = &quot;&#47;&#47;*[@class=&#39;item-root&#39;]&#47;div[@class=&#39;detail&#39;]&#47;div[@class=&#39;title&#39;]&#47;a&#47;text()&quot;<br><br>    srcs = html.xpath(src_xpath)<br>    titles = html.xpath(title_xpath)<br>    print(srcs)<br>    print(titles)<br>    for src, title in zip(srcs, titles):<br>        print(&#39;\\t&#39;.join([str(src),str(title)]))<br>        title = re.sub(u&#39;\\?&#39;, u&#39; &#39;, title)<br>        download(src, title)<br>driver.close()<br>","like_count":0},{"had_liked":false,"id":57329,"user_name":"é—«ä¸œæ±‰","can_delete":false,"product_type":"c1","uid":1041830,"ip_address":"","ucode":"A4EA98EF44EA50","user_header":"https://static001.geekbang.org/account/avatar/00/0f/e5/a6/0be17cd5.jpg","comment_is_top":false,"comment_ctime":1546752674,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1546752674","product_id":100021701,"comment_content":"QUERYæ¡†ä¸­çš„æ•°æ®æ˜¯å¦‚ä½•å¾—å‡ºçš„å‘¢ï¼Ÿ<br>","like_count":0},{"had_liked":false,"id":57202,"user_name":"wonderland","can_delete":false,"product_type":"c1","uid":1362584,"ip_address":"","ucode":"ACA8577C9EDE88","user_header":"https://static001.geekbang.org/account/avatar/00/14/ca/98/a75e400b.jpg","comment_is_top":false,"comment_ctime":1546681079,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1546681079","product_id":100021701,"comment_content":"è¿è¡Œç¯å¢ƒï¼šjupyter<br>æœ€å–œæ¬¢çš„æ˜æ˜Ÿ-å®‹æ…§ä¹”ï¼Œæ‰€ä»¥ä»¥å®‹æ…§ä¹”ä¸ºå…³é”®è¯æŠ“å–äº†å¥¹åœ¨è±†ç“£ä¸Šå›¾ç‰‡ï¼Œå› ä¸ºæ•°é‡è¿‡å¤šï¼Œæ‰€ä»¥ç¨‹åºé‡Œè®¾ç½®åªæŠ“å–äº†20å¼ ï¼Œå¹¶ä¸”åœ¨æœ€åé€šè¿‡å…¶ä¸­çš„ä¸€å¼ å›¾ç‰‡åœ°å€ï¼Œå¯¹å›¾ç‰‡è¿›è¡Œäº†æ˜¾ç¤ºæ“ä½œã€‚<br>ä»£ç å¦‚ä¸‹ï¼š<br># coding:utf-8<br>import requests<br>import json<br>query = &#39;å®‹æ…§ä¹”&#39;<br>#ä¸‹è½½å›¾ç‰‡å‡½æ•°<br>def download(src, id):<br>           dir = &#39;.&#47;&#39; + str(id) + &#39;.jpg&#39;<br>           try:<br>                     pic = requests.get(src, timeout=10)#æ‰“å¼€å›¾ç‰‡çš„urlï¼Œå³æ‰“å¼€å›¾ç‰‡ç½‘é¡µ<br>           except requests.exceptions.ConnectionError:<br>                     #print &#39;error, %d å½“å‰å›¾ç‰‡æ— æ³•ä¸‹è½½&#39;, %id<br>                     print(&#39;å›¾ç‰‡æ— æ³•ä¸‹è½½&#39;)<br>           fp = open(dir, &#39;wb&#39;)#åœ¨å½“å‰æ‰“å¼€ç½‘é¡µä¸‹ï¼Œæ‰“å¼€å¯¹åº”idå›¾ç‰‡ï¼Œå¹¶è¿”å›å›¾ç‰‡å†…å®¹<br>           fp.write(pic.content)<br>           fp.close()#æ‰“å¼€æ“ä½œè¿›è¡Œå…³é—­<br> <br>for i in range(0, 21, 20):<br>           url = &#39;https:&#47;&#47;www.douban.com&#47;j&#47;search_photo?q=&#39;+query+&#39;&amp;limit=20&amp;start=&#39;+str(i)<br>           html = requests.get(url).text    # å¾—åˆ°è¿”å›ç»“æœ<br>           response = json.loads(html,encoding=&#39;utf-8&#39;) # å°† JSON æ ¼å¼è½¬æ¢æˆ Python å¯¹è±¡<br>           for image in response[&#39;images&#39;]:#imagesæ˜¯ä¸€ä¸ªå¯¹è±¡ï¼Œæ˜¯ä¸€ä¸ªæ•°ç»„ç»“æ„ï¼Œæœ‰å¤šå¼ å›¾ç‰‡ï¼›æ•°ç»„ä¸­æ¯ä¸ªå…ƒç´ imageæ˜¯ä¸€ä¸ªå­—å…¸çš„å½¢å¼ï¼Œæœ‰idï¼Œæœ‰srcç­‰<br>                    # print image[&#39;src&#39;] # æŸ¥çœ‹å½“å‰ä¸‹è½½çš„å›¾ç‰‡ç½‘å€<br>                        download(image[&#39;src&#39;], image[&#39;id&#39;]) # ä¸‹è½½ä¸€å¼ å›¾ç‰‡<br>                        print(image[&#39;src&#39;]) #è¾“å‡ºå½“å‰ä¸‹è½½å›¾ç‰‡çš„ç½‘å€<br>#æ˜¾ç¤ºå›¾ç‰‡æ“ä½œ<br>from PIL import Image<br>from io import BytesIO<br>img_src = &#39;https:&#47;&#47;img3.doubanio.com&#47;view&#47;photo&#47;photo&#47;public&#47;p637434872.jpg&#39;<br>res = requests.get(img_src)#åˆ©ç”¨requestè¯·æ±‚å›¾ç‰‡çš„å“åº”ï¼Œå¹¶è¿”å›äºŒè¿›åˆ¶æ•°æ®<br>img = Image.open(BytesIO(res.content)) #åˆ©ç”¨ByteSioåº“è¿›è¡ŒäºŒè¿›åˆ¶æ•°æ®çš„è¯»å–<br>img.show()<br>print(&#39;å›¾ç‰‡æ˜¾ç¤º&#39;)<br>","like_count":0},{"had_liked":false,"id":57173,"user_name":"caidy","can_delete":false,"product_type":"c1","uid":1188783,"ip_address":"","ucode":"AEFB529C32C7EE","user_header":"https://static001.geekbang.org/account/avatar/00/12/23/af/84f4714e.jpg","comment_is_top":false,"comment_ctime":1546671980,"is_pvip":false,"replies":[{"id":"21411","content":"æˆ‘æ›´æ–°äº†ä¸‹ä»£ç ï¼ŒæŠŠpicæ”¾åˆ°tryä»£ç æ®µé‡Œäº†ã€‚ä½ å¯ä»¥å†è¯•ä¸‹ã€‚é‡åˆ°è¿™ç§æƒ…å†µï¼Œå°±æ˜¯ä¸èƒ½æ­£å¸¸ä¸‹è½½å›¾ç‰‡ï¼Œå¯ä»¥æŠŠsrcå’Œidæ‰“å°å‡ºæ¥çœ‹ä¸‹ ","user_name":"ä½œè€…å›å¤","user_name_real":"cy","uid":"1306094","ctime":1547368064,"ip_address":"","comment_id":57173,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1546671980","product_id":100021701,"comment_content":"è€å¸ˆï¼Œè¯¾ç¨‹çš„ç¨‹å‹‹è¿è¡Œä¸€åŠä¼šå‡ºç°è¿™æ ·çš„é”™è¯¯<br>UnboundLocalErrorï¼š local variable &#39;pic&#39; referenced before assignment","like_count":0,"discussions":[{"author":{"id":1306094,"avatar":"https://static001.geekbang.org/account/avatar/00/13/ed/ee/c4779b67.jpg","nickname":"cy","note":"","ucode":"50D653399A31F6","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":435443,"discussion_content":"æˆ‘æ›´æ–°äº†ä¸‹ä»£ç ï¼ŒæŠŠpicæ”¾åˆ°tryä»£ç æ®µé‡Œäº†ã€‚ä½ å¯ä»¥å†è¯•ä¸‹ã€‚é‡åˆ°è¿™ç§æƒ…å†µï¼Œå°±æ˜¯ä¸èƒ½æ­£å¸¸ä¸‹è½½å›¾ç‰‡ï¼Œå¯ä»¥æŠŠsrcå’Œidæ‰“å°å‡ºæ¥çœ‹ä¸‹ ","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1547368064,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":57101,"user_name":"æ‹‰æˆ‘åƒ","can_delete":false,"product_type":"c1","uid":1354151,"ip_address":"","ucode":"8BC9C44FE00097","user_header":"https://static001.geekbang.org/account/avatar/00/14/a9/a7/de3ee890.jpg","comment_is_top":false,"comment_ctime":1546646653,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1546646653","product_id":100021701,"comment_content":"å‘é€çš„è¯·æ±‚(request)URLå¯ä»¥å¤šç§å¤šæ ·ï¼Œç±»ä¼¼https:&#47;&#47;movie.douban.com&#47;subject_search?search_text=%E7%8E%8B%E7%A5%96%E8%B4%A4&amp;cat=1002&amp;limit=15&amp;start=0 è¿™ç§çš„å›¾ç‰‡æ˜¯webpæ ¼å¼ï¼Œéœ€è¦æ³¨æ„ä¸€ä¸‹ã€‚","like_count":0},{"had_liked":false,"id":57075,"user_name":"Lin_å˜‰æ°","can_delete":false,"product_type":"c1","uid":1023901,"ip_address":"","ucode":"377885EBBC9C03","user_header":"https://static001.geekbang.org/account/avatar/00/0f/9f/9d/67a33381.jpg","comment_is_top":false,"comment_ctime":1546614859,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1546614859","product_id":100021701,"comment_content":"ç¬¬äºŒä¸ªä¸‹è½½ç‹ç¥–è´¤ç”µå½±å°é¢çš„ä»£ç ï¼Œéœ€è¦æ”¹è¿›<br>ç¯å¢ƒï¼šPython3ï¼Œwindowç³»ç»Ÿ<br><br># coding: utf-8<br>from selenium import webdriver<br>from lxml import etree<br>import re<br>driver = webdriver.Chrome()<br>query = &#39;ç‹ç¥–è´¤&#39;<br><br>def download(src, id):<br>\tdir = &#39;.&#47;images&#47;wangzuxian&#47;&#39;+str(id)+&#39;.jpg&#39;<br>\ttry:<br>\t\tpic = requests.get(src, timeout=10)<br>\t\twith open(dir, &#39;wb&#39;) as f:<br>\t\t\tf.write(pic.content)<br>\texcept requests.exceptions.ConnectionError:<br>\t\tprint(&#39;å›¾ç‰‡æ— æ³•ä¸‹è½½&#39;)<br>        # å›¾ç‰‡å‘½åå¤±è´¥å¼‚å¸¸<br>\texcept Exception as e:<br>\t\tprint(&#39;ä¸‹è½½å›¾ç‰‡å¤±è´¥&#39;)<br><br>if __name__ == &#39;__main__&#39;:<br>\tfor i in range(0, 6*15, 15):<br>\t\trequest_url = &#39;https:&#47;&#47;movie.douban.com&#47;subject_search?search_text=&#39;+query+&#39;&amp;cat=1002&amp;start=&#39;+str(i)<br>\t\tdriver.get(request_url)<br>\t\thtml = etree.HTML(driver.page_source)<br><br>\t\tsrc_xpath = &quot;&#47;&#47;*[@class=&#39;item-root&#39;]&#47;a&#47;img&#47;@src&quot;<br>\t\ttitle_xpath = &quot;&#47;&#47;*[@class=&#39;item-root&#39;]&#47;div[@class=&#39;detail&#39;]&#47;div[@class=&#39;title&#39;]&#47;a&#47;text()&quot;<br><br>\t\tsrcs = html.xpath(src_xpath)<br>\t\ttitles = html.xpath(title_xpath)<br><br>\t\tfor src, title in zip(srcs, titles):<br>\t\t\t# print(src)<br>\t\t\tdownload(src, title)<br><br>","like_count":0},{"had_liked":false,"id":57064,"user_name":"Chino","can_delete":false,"product_type":"c1","uid":1347181,"ip_address":"","ucode":"0240D89E5F74B4","user_header":"https://static001.geekbang.org/account/avatar/00/14/8e/6d/c68e07ef.jpg","comment_is_top":false,"comment_ctime":1546611942,"is_pvip":false,"replies":[{"id":"21406","content":"ä¸€ç§æ–¹æ³•æ˜¯ä½ ç”¨webdriveræ¥æ¨¡æ‹ŸFirefoxæµè§ˆå™¨","user_name":"ä½œè€…å›å¤","user_name_real":"cy","uid":"1306094","ctime":1547365170,"ip_address":"","comment_id":57064,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1546611942","product_id":100021701,"comment_content":"å…³äºç¬¬äºŒä¸ªç‹ç¥–è´¤ç”µå½±ä¸‹è½½çš„æµ·æŠ¥ èƒ½å¤Ÿè¿è¡Œå¹¶çˆ¬ä¸‹æ¥äº† ä½†æ˜¯è¿˜æœ‰ä¸€ä¸ªé—®é¢˜ å› ä¸ºçˆ¬å»çš„å›¾ç‰‡srcéƒ½æ˜¯webpæ ¼å¼çš„ ä¸€å¼€å§‹å†™çš„æ—¶å€™è‡ªç„¶å†™æˆjpg å‘ç°æ‰“ä¸å¼€ æ‰æƒ³èµ·æ¥ æ”¹æˆwebpå å¯¹äºè¿™ç§æ ¼å¼åˆä¸èƒ½ç›´æ¥é¢„è§ˆ æœ‰æ²¡æœ‰ä»€ä¹ˆåŠæ³•èƒ½ç›´æ¥çˆ¬æˆjpgçš„å‘¢<br>from selenium import webdriver<br>import requests<br>from lxml import etree<br>i = 0<br>def download(src):<br>    global i<br>    try:<br>        r = requests.get(src,timeout = 10)<br>    except requests.exceptions.ConnectionError:<br>        print(&#39;error&#39;)<br>    dl_dir = &#39;.&#47;pictest&#47;&#39; + str(i) + &#39;.jpg&#39;<br>    fp = open(dl_dir,&#39;wb&#39;)<br>    fp.write(r.content)<br>    fp.close()<br>    i += 1<br>    <br>src_xpath = &quot;&#47;&#47;div[@class = &#39;item-root&#39;]&#47;a[@class = &#39;cover-link&#39;]&#47;img[@class = &#39;cover&#39;]&quot;<br><br>request_url = &#39;https:&#47;&#47;movie.douban.com&#47;subject_search?search_text=%E7%8E%8B%E7%A5%96%E8%B4%A4&#39;<br><br>driver = webdriver.Chrome()<br>driver.get(request_url)<br><br>html = etree.HTML(driver.page_source)<br><br>pic_url = html.xpath(src_xpath)<br><br>for j in pic_url:<br>    download(j.get(&#39;src&#39;))<br>","like_count":0,"discussions":[{"author":{"id":1306094,"avatar":"https://static001.geekbang.org/account/avatar/00/13/ed/ee/c4779b67.jpg","nickname":"cy","note":"","ucode":"50D653399A31F6","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":435387,"discussion_content":"ä¸€ç§æ–¹æ³•æ˜¯ä½ ç”¨webdriveræ¥æ¨¡æ‹ŸFirefoxæµè§ˆå™¨","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1547365170,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":57002,"user_name":"ç‹      æ…ˆ","can_delete":false,"product_type":"c1","uid":1298139,"ip_address":"","ucode":"EACC3D086674D8","user_header":"https://static001.geekbang.org/account/avatar/00/13/ce/db/bb1821b3.jpg","comment_is_top":false,"comment_ctime":1546597427,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1546597427","product_id":100021701,"comment_content":"æ‚¨å¥½ï¼Œæˆ‘çœ‹åˆ°ç°åœ¨æœ‰é‚£ç§ç±»ä¼¼æŒ‰é”®ç²¾çµçš„ Selenium IDEï¼Œå¯ä»¥ç›´æ¥ç”Ÿæˆä»£ç ã€‚æ‚¨å¯¹è¿™ç§è½¯ä»¶æ€ä¹ˆçœ‹å‘¢ï¼Ÿæœ‰äº†å®ƒæ˜¯ä¸æ˜¯å¯ä»¥é™ä½å¯¹ html XPath js è¿™äº›çŸ¥è¯†çš„æŒæ¡å‘¢ï¼Ÿ","like_count":0},{"had_liked":false,"id":57000,"user_name":"Lin_å˜‰æ°","can_delete":false,"product_type":"c1","uid":1023901,"ip_address":"","ucode":"377885EBBC9C03","user_header":"https://static001.geekbang.org/account/avatar/00/0f/9f/9d/67a33381.jpg","comment_is_top":false,"comment_ctime":1546596661,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1546596661","product_id":100021701,"comment_content":"è€å¸ˆï¼Œå¦‚æœæŸç½‘ç«™ä¸Šæ›´æ–°äº†å†…å®¹ï¼Œé‚£æ€æ ·ä¹Ÿé¡ºä¾¿è‡ªåŠ¨çˆ¬å–å†…å®¹ï¼Ÿæˆ‘æƒ³åˆ°çš„æ˜¯çº¿ä¸Šçˆ¬å–ï¼Œæ€è·¯æ˜¯è¿™æ ·å—ï¼Ÿ","like_count":0},{"had_liked":false,"id":56996,"user_name":"Chino","can_delete":false,"product_type":"c1","uid":1347181,"ip_address":"","ucode":"0240D89E5F74B4","user_header":"https://static001.geekbang.org/account/avatar/00/14/8e/6d/c68e07ef.jpg","comment_is_top":false,"comment_ctime":1546595624,"is_pvip":false,"replies":[{"id":"21392","content":"éœ€è¦å…ˆä¸‹è½½chromedriveï¼Œç„¶åæ”¾åˆ°æµè§ˆå™¨ç›®å½•ä¸­ï¼Œå†æŠŠè¿™ä¸ªç›®å½•æ·»åŠ åˆ°é…ç½®ç¯å¢ƒå˜é‡pathé‡Œ<br>","user_name":"ä½œè€…å›å¤","user_name_real":"cy","uid":"1306094","ctime":1547355104,"ip_address":"","comment_id":56996,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1546595624","product_id":100021701,"comment_content":"driver = webdriver.Chrome()<br>ä¸ºä»€ä¹ˆè¾“å…¥è¿™ä¸ªä»£ç å°±ä¼šæŠ¥é”™äº†å‘¢<br>æ˜¯å› ä¸ºåœ¨macä¸Šçš„åŸå› å—","like_count":0,"discussions":[{"author":{"id":1306094,"avatar":"https://static001.geekbang.org/account/avatar/00/13/ed/ee/c4779b67.jpg","nickname":"cy","note":"","ucode":"50D653399A31F6","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":435351,"discussion_content":"éœ€è¦å…ˆä¸‹è½½chromedriveï¼Œç„¶åæ”¾åˆ°æµè§ˆå™¨ç›®å½•ä¸­ï¼Œå†æŠŠè¿™ä¸ªç›®å½•æ·»åŠ åˆ°é…ç½®ç¯å¢ƒå˜é‡pathé‡Œ\n","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1547355104,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":56991,"user_name":"JingZ","can_delete":false,"product_type":"c1","uid":1023464,"ip_address":"","ucode":"6F97895B2CC375","user_header":"https://thirdwx.qlogo.cn/mmopen/vi_32/wJphZ3HcvhjVUyTWCIsCugzfQY5NAy6VJ0XoPLibDlcHWMswFmFe678zd0lUjFETia80NQhyQcVnGDlKgKPcRGyw/132","comment_is_top":false,"comment_ctime":1546594698,"is_pvip":false,"discussion_count":1,"race_medal":0,"score":"1546594698","product_id":100021701,"comment_content":"response = json.loads(html,encoding =&#39;utf-8&#39;)<br>å‡ºç°é—®é¢˜<br>raise JSONDecodeError(&quot;Expecting value&quot;, s, err.value) from None<br>JSONDecodeError: Expecting value<br><br>éœ€è¦debugäº†","like_count":0,"discussions":[{"author":{"id":1783634,"avatar":"https://static001.geekbang.org/account/avatar/00/1b/37/52/c1c56b6f.jpg","nickname":"Geek_2008d9","note":"","ucode":"12F1A8B98AD5F7","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":81971,"discussion_content":"è¯·é—®æ€ä¹ˆè§£å†³å•Š","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1576302855,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":56950,"user_name":"SIXGOD","can_delete":false,"product_type":"c1","uid":1257555,"ip_address":"","ucode":"08EB8532CF87AB","user_header":"https://static001.geekbang.org/account/avatar/00/13/30/53/fbb08f01.jpg","comment_is_top":false,"comment_ctime":1546585581,"is_pvip":false,"replies":[{"id":"21402","content":"æ–¹æ³•æ˜¯OKçš„ï¼Œé¦–å…ˆä½ æŒ‡å®šäº†chrome_driverçš„è·¯å¾„ï¼Œè¿™æ ·å¯ä»¥ä½¿ç”¨WebDriveråœ¨chromeä¸Šè¿›è¡Œè‡ªåŠ¨åŒ–æµ‹è¯•ã€‚ç„¶åä½¿ç”¨xpathæå–äº†å›¾ç‰‡çš„é“¾æ¥åŠåç§°ã€‚æœ€åç¼–å†™äº†downloadå‡½æ•°æ¥å®Œæˆå›¾ç‰‡çš„ä¸‹è½½ï¼Œå¯¹äºä¸‹è½½å¼‚å¸¸ä¼šè¿›è¡ŒæŠ¥é”™ã€‚","user_name":"ä½œè€…å›å¤","user_name_real":"cy","uid":"1306094","ctime":1547363826,"ip_address":"","comment_id":56950,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1546585581","product_id":100021701,"comment_content":"éº»çƒ¦è€å¸ˆå’Œå„ä½å¤§ä½¬æŒ‡ç‚¹ä¸€ä¸‹ç¬¬äºŒä¸ªçš„å†™æ³•ï¼š<br># coding:utf-8<br>import requests<br>import json<br>from selenium import webdriver<br>from lxml import etree<br><br>query = &#39;ç‹ç¥–è´¤&#39;<br>&#39;&#39;&#39; ä¸‹è½½å›¾ç‰‡ &#39;&#39;&#39;<br>def download(src, id):<br>  dir = &#39;D:&#47;douban-download&#47;&#39; + str(id) + &#39;.webp&#39;<br>  try:<br>    pic = requests.get(src, timeout=10)<br>  except requests.exceptions.ConnectionError:<br>    #print &#39;error, %d å½“å‰å›¾ç‰‡æ— æ³•ä¸‹è½½&#39;, %id<br>    print(&#39;å›¾ç‰‡æ— æ³•ä¸‹è½½&#39;)<br>  fp = open(dir, &#39;wb&#39;)<br>  fp.write(pic.content)<br>  fp.close()<br><br>chrome_driver = &quot;D:\\download\\chromedriver_win32\\chromedriver.exe&quot;<br>driver = webdriver.Chrome(executable_path=chrome_driver)<br><br>request_url = &quot;https:&#47;&#47;movie.douban.com&#47;subject_search?search_text=&quot;+query+&quot;&amp;cat=1002&quot;<br>driver.get(request_url)<br>html = etree.HTML(driver.page_source)<br><br>src_xpath = &quot;&#47;&#47;div[@class=&#39;item-root&#39;]&#47;a[@class=&#39;cover-link&#39;]&#47;img[@class=&#39;cover&#39;]&#47;@src&quot;<br>title_path = &quot;&#47;&#47;div[@class=&#39;item-root&#39;]&#47;div[@class=&#39;detail&#39;]&#47;div[@class=&#39;title&#39;]&#47;a[@class=&#39;title-text&#39;]&quot;<br><br>srcs = html.xpath(src_xpath)<br>titles = html.xpath(title_path)<br>for src, title in zip(srcs, titles):<br>  print(&#39;\\t&#39;.join([str(src),str(title.text)]))<br>  download(src, title.text)<br><br>driver.close()","like_count":0,"discussions":[{"author":{"id":1306094,"avatar":"https://static001.geekbang.org/account/avatar/00/13/ed/ee/c4779b67.jpg","nickname":"cy","note":"","ucode":"50D653399A31F6","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":435326,"discussion_content":"æ–¹æ³•æ˜¯OKçš„ï¼Œé¦–å…ˆä½ æŒ‡å®šäº†chrome_driverçš„è·¯å¾„ï¼Œè¿™æ ·å¯ä»¥ä½¿ç”¨WebDriveråœ¨chromeä¸Šè¿›è¡Œè‡ªåŠ¨åŒ–æµ‹è¯•ã€‚ç„¶åä½¿ç”¨xpathæå–äº†å›¾ç‰‡çš„é“¾æ¥åŠåç§°ã€‚æœ€åç¼–å†™äº†downloadå‡½æ•°æ¥å®Œæˆå›¾ç‰‡çš„ä¸‹è½½ï¼Œå¯¹äºä¸‹è½½å¼‚å¸¸ä¼šè¿›è¡ŒæŠ¥é”™ã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1547363826,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":56944,"user_name":"1e-43","can_delete":false,"product_type":"c1","uid":1138688,"ip_address":"","ucode":"8AADC2ED8409E9","user_header":"https://static001.geekbang.org/account/avatar/00/11/60/00/3dbaf430.jpg","comment_is_top":false,"comment_ctime":1546584283,"is_pvip":false,"replies":[{"id":"21391","content":"æ‰¾ä¸ªæ—¶é—´ï¼Œæˆ‘ä¼šä¸“é—¨è®²è®²çˆ¬è™«","user_name":"ä½œè€…å›å¤","user_name_real":"cy","uid":"1306094","ctime":1547353956,"ip_address":"","comment_id":56944,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1546584283","product_id":100021701,"comment_content":"è€å¸ˆå¥½ï¼Œå¯ä»¥ä¸“é—¨åšèŠ‚è¯¾è®²ä¸‹Xpathå—ï¼Œä¹‹å‰å®Œå…¨æ²¡æ¥è§¦è¿‡è¿™æ–¹é¢","like_count":0,"discussions":[{"author":{"id":1306094,"avatar":"https://static001.geekbang.org/account/avatar/00/13/ed/ee/c4779b67.jpg","nickname":"cy","note":"","ucode":"50D653399A31F6","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":435324,"discussion_content":"æ‰¾ä¸ªæ—¶é—´ï¼Œæˆ‘ä¼šä¸“é—¨è®²è®²çˆ¬è™«","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1547353956,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":56908,"user_name":"èœ˜è››çš„æ¢¦å‘“","can_delete":false,"product_type":"c1","uid":1190207,"ip_address":"","ucode":"42FF5C7FF4D2E1","user_header":"https://static001.geekbang.org/account/avatar/00/12/29/3f/ae7718f6.jpg","comment_is_top":false,"comment_ctime":1546576909,"is_pvip":false,"replies":[{"id":"21383","content":"å¯ä»¥æœ‰","user_name":"ä½œè€…å›å¤","user_name_real":"cy","uid":"1306094","ctime":1547348529,"ip_address":"","comment_id":56908,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1546576909","product_id":100021701,"comment_content":"è€å¸ˆï¼Œæˆ‘æ›´æƒ³çœ‹ã€Œåˆ†ææ€ç»´å’Œåˆ†ææŠ€å·§ã€æ–¹é¢çš„å†…å®¹ï¼Œåç»­ä¼šå‡ºå—ï¼Ÿ","like_count":0,"discussions":[{"author":{"id":1306094,"avatar":"https://static001.geekbang.org/account/avatar/00/13/ed/ee/c4779b67.jpg","nickname":"cy","note":"","ucode":"50D653399A31F6","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":435307,"discussion_content":"å¯ä»¥æœ‰","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1547348529,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":56861,"user_name":"æ—","can_delete":false,"product_type":"c1","uid":1022243,"ip_address":"","ucode":"273F83CB3F9DF8","user_header":"https://static001.geekbang.org/account/avatar/00/0f/99/23/3c3272bd.jpg","comment_is_top":false,"comment_ctime":1546569847,"is_pvip":false,"replies":[{"id":"21389","content":"ä½ å¯ä»¥æŸ¥çœ‹ä¸‹æ˜¯å¦å®‰è£…äº†Chromeæµè§ˆå™¨ï¼Œå› ä¸ºè¿™ä¸ªæ˜¯è‡ªåŠ¨åŒ–æµ‹è¯•ï¼Œä¼šè°ƒç”¨æœ¬åœ°çš„Chromeæµè§ˆå™¨","user_name":"ä½œè€…å›å¤","user_name_real":"cy","uid":"1306094","ctime":1547353866,"ip_address":"","comment_id":56861,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1546569847","product_id":100021701,"comment_content":"#pip install selenium<br>#pip install chromedriver<br>ä¹‹åä»£ç ä¸­<br>driver = webdriver.Chrome()<br>driver.get(requestUrl)<br>å‘èµ·è¯·æ±‚ï¼ŒæŠ¥selenium.common.exceptions.WebDriverException: Message: unknown error: cannot find Chrome binaryé”™å‘¢ï¼Œå•¥æƒ…å†µï¼Ÿ","like_count":0,"discussions":[{"author":{"id":1306094,"avatar":"https://static001.geekbang.org/account/avatar/00/13/ed/ee/c4779b67.jpg","nickname":"cy","note":"","ucode":"50D653399A31F6","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":435284,"discussion_content":"ä½ å¯ä»¥æŸ¥çœ‹ä¸‹æ˜¯å¦å®‰è£…äº†Chromeæµè§ˆå™¨ï¼Œå› ä¸ºè¿™ä¸ªæ˜¯è‡ªåŠ¨åŒ–æµ‹è¯•ï¼Œä¼šè°ƒç”¨æœ¬åœ°çš„Chromeæµè§ˆå™¨","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1547353866,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]}]}