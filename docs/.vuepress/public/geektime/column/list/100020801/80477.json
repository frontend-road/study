{"id":80477,"title":"37 | ä»€ä¹ˆæ—¶å€™ä¼šä½¿ç”¨å†…éƒ¨ä¸´æ—¶è¡¨ï¼Ÿ","content":"<p><span class=\"orange\">ä»Šå¤©æ˜¯å¤§å¹´åˆäºŒï¼Œåœ¨å¼€å§‹æˆ‘ä»¬ä»Šå¤©çš„å­¦ä¹ ä¹‹å‰ï¼Œæˆ‘è¦å…ˆå’Œä½ é“ä¸€å£°æ˜¥èŠ‚å¿«ä¹ï¼</span></p><p>åœ¨<a href=\"https://time.geekbang.org/column/article/73479\">ç¬¬16</a>å’Œ<a href=\"https://time.geekbang.org/column/article/79700\">ç¬¬34</a>ç¯‡æ–‡ç« ä¸­ï¼Œæˆ‘åˆ†åˆ«å’Œä½ ä»‹ç»äº†sort bufferã€å†…å­˜ä¸´æ—¶è¡¨å’Œjoin bufferã€‚è¿™ä¸‰ä¸ªæ•°æ®ç»“æ„éƒ½æ˜¯ç”¨æ¥å­˜æ”¾è¯­å¥æ‰§è¡Œè¿‡ç¨‹ä¸­çš„ä¸­é—´æ•°æ®ï¼Œä»¥è¾…åŠ©SQLè¯­å¥çš„æ‰§è¡Œçš„ã€‚å…¶ä¸­ï¼Œæˆ‘ä»¬åœ¨æ’åºçš„æ—¶å€™ç”¨åˆ°äº†sort bufferï¼Œåœ¨ä½¿ç”¨joinè¯­å¥çš„æ—¶å€™ç”¨åˆ°äº†join bufferã€‚</p><p>ç„¶åï¼Œä½ å¯èƒ½ä¼šæœ‰è¿™æ ·çš„ç–‘é—®ï¼ŒMySQLä»€ä¹ˆæ—¶å€™ä¼šä½¿ç”¨å†…éƒ¨ä¸´æ—¶è¡¨å‘¢ï¼Ÿ</p><p>ä»Šå¤©è¿™ç¯‡æ–‡ç« ï¼Œæˆ‘å°±å…ˆç»™ä½ ä¸¾ä¸¤ä¸ªéœ€è¦ç”¨åˆ°å†…éƒ¨ä¸´æ—¶è¡¨çš„ä¾‹å­ï¼Œæ¥çœ‹çœ‹å†…éƒ¨ä¸´æ—¶è¡¨æ˜¯æ€ä¹ˆå·¥ä½œçš„ã€‚ç„¶åï¼Œæˆ‘ä»¬å†æ¥åˆ†æï¼Œä»€ä¹ˆæƒ…å†µä¸‹ä¼šä½¿ç”¨å†…éƒ¨ä¸´æ—¶è¡¨ã€‚</p><h1>union æ‰§è¡Œæµç¨‹</h1><p>ä¸ºäº†ä¾¿äºé‡åŒ–åˆ†æï¼Œæˆ‘ç”¨ä¸‹é¢çš„è¡¨t1æ¥ä¸¾ä¾‹ã€‚</p><pre><code>create table t1(id int primary key, a int, b int, index(a));\ndelimiter ;;\ncreate procedure idata()\nbegin\n  declare i int;\n\n  set i=1;\n  while(i&lt;=1000)do\n    insert into t1 values(i, i, i);\n    set i=i+1;\n  end while;\nend;;\ndelimiter ;\ncall idata();\n</code></pre><p>ç„¶åï¼Œæˆ‘ä»¬æ‰§è¡Œä¸‹é¢è¿™æ¡è¯­å¥ï¼š</p><pre><code>(select 1000 as f) union (select id from t1 order by id desc limit 2);\n</code></pre><p>è¿™æ¡è¯­å¥ç”¨åˆ°äº†unionï¼Œå®ƒçš„è¯­ä¹‰æ˜¯ï¼Œå–è¿™ä¸¤ä¸ªå­æŸ¥è¯¢ç»“æœçš„å¹¶é›†ã€‚å¹¶é›†çš„æ„æ€å°±æ˜¯è¿™ä¸¤ä¸ªé›†åˆåŠ èµ·æ¥ï¼Œé‡å¤çš„è¡Œåªä¿ç•™ä¸€è¡Œã€‚</p><p>ä¸‹å›¾æ˜¯è¿™ä¸ªè¯­å¥çš„explainç»“æœã€‚</p><p><img src=\"https://static001.geekbang.org/resource/image/40/4e/402cbdef84eef8f1b42201c6ec4bad4e.png?wh=1509*187\" alt=\"\"></p><center><span class=\"reference\">å›¾1 unionè¯­å¥explain ç»“æœ</span></center><p>å¯ä»¥çœ‹åˆ°ï¼š</p><ul>\n<li>ç¬¬äºŒè¡Œçš„key=PRIMARYï¼Œè¯´æ˜ç¬¬äºŒä¸ªå­å¥ç”¨åˆ°äº†ç´¢å¼•idã€‚</li>\n<li>ç¬¬ä¸‰è¡Œçš„Extraå­—æ®µï¼Œè¡¨ç¤ºåœ¨å¯¹å­æŸ¥è¯¢çš„ç»“æœé›†åšunionçš„æ—¶å€™ï¼Œä½¿ç”¨äº†ä¸´æ—¶è¡¨(Using temporary)ã€‚</li>\n</ul><!-- [[[read_end]]] --><p>è¿™ä¸ªè¯­å¥çš„æ‰§è¡Œæµç¨‹æ˜¯è¿™æ ·çš„ï¼š</p><ol>\n<li>\n<p>åˆ›å»ºä¸€ä¸ªå†…å­˜ä¸´æ—¶è¡¨ï¼Œè¿™ä¸ªä¸´æ—¶è¡¨åªæœ‰ä¸€ä¸ªæ•´å‹å­—æ®µfï¼Œå¹¶ä¸”fæ˜¯ä¸»é”®å­—æ®µã€‚</p>\n</li>\n<li>\n<p>æ‰§è¡Œç¬¬ä¸€ä¸ªå­æŸ¥è¯¢ï¼Œå¾—åˆ°1000è¿™ä¸ªå€¼ï¼Œå¹¶å­˜å…¥ä¸´æ—¶è¡¨ä¸­ã€‚</p>\n</li>\n<li>\n<p>æ‰§è¡Œç¬¬äºŒä¸ªå­æŸ¥è¯¢ï¼š</p>\n<ul>\n<li>æ‹¿åˆ°ç¬¬ä¸€è¡Œid=1000ï¼Œè¯•å›¾æ’å…¥ä¸´æ—¶è¡¨ä¸­ã€‚ä½†ç”±äº1000è¿™ä¸ªå€¼å·²ç»å­˜åœ¨äºä¸´æ—¶è¡¨äº†ï¼Œè¿åäº†å”¯ä¸€æ€§çº¦æŸï¼Œæ‰€ä»¥æ’å…¥å¤±è´¥ï¼Œç„¶åç»§ç»­æ‰§è¡Œï¼›</li>\n<li>å–åˆ°ç¬¬äºŒè¡Œid=999ï¼Œæ’å…¥ä¸´æ—¶è¡¨æˆåŠŸã€‚</li>\n</ul>\n</li>\n<li>\n<p>ä»ä¸´æ—¶è¡¨ä¸­æŒ‰è¡Œå–å‡ºæ•°æ®ï¼Œè¿”å›ç»“æœï¼Œå¹¶åˆ é™¤ä¸´æ—¶è¡¨ï¼Œç»“æœä¸­åŒ…å«ä¸¤è¡Œæ•°æ®åˆ†åˆ«æ˜¯1000å’Œ999ã€‚</p>\n</li>\n</ol><p>è¿™ä¸ªè¿‡ç¨‹çš„æµç¨‹å›¾å¦‚ä¸‹æ‰€ç¤ºï¼š</p><p><img src=\"https://static001.geekbang.org/resource/image/5d/0e/5d038c1366d375cc997005a5d65c600e.jpg?wh=1142*880\" alt=\"\"></p><center><span class=\"reference\">å›¾ 2 union æ‰§è¡Œæµç¨‹</span></center><p>å¯ä»¥çœ‹åˆ°ï¼Œè¿™é‡Œçš„å†…å­˜ä¸´æ—¶è¡¨èµ·åˆ°äº†æš‚å­˜æ•°æ®çš„ä½œç”¨ï¼Œè€Œä¸”è®¡ç®—è¿‡ç¨‹è¿˜ç”¨ä¸Šäº†ä¸´æ—¶è¡¨ä¸»é”®idçš„å”¯ä¸€æ€§çº¦æŸï¼Œå®ç°äº†unionçš„è¯­ä¹‰ã€‚</p><p>é¡ºä¾¿æä¸€ä¸‹ï¼Œå¦‚æœæŠŠä¸Šé¢è¿™ä¸ªè¯­å¥ä¸­çš„unionæ”¹æˆunion allçš„è¯ï¼Œå°±æ²¡æœ‰äº†â€œå»é‡â€çš„è¯­ä¹‰ã€‚è¿™æ ·æ‰§è¡Œçš„æ—¶å€™ï¼Œå°±ä¾æ¬¡æ‰§è¡Œå­æŸ¥è¯¢ï¼Œå¾—åˆ°çš„ç»“æœç›´æ¥ä½œä¸ºç»“æœé›†çš„ä¸€éƒ¨åˆ†ï¼Œå‘ç»™å®¢æˆ·ç«¯ã€‚å› æ­¤ä¹Ÿå°±ä¸éœ€è¦ä¸´æ—¶è¡¨äº†ã€‚</p><p><img src=\"https://static001.geekbang.org/resource/image/c1/6d/c1e90d1d7417b484d566b95720fe3f6d.png?wh=1409*168\" alt=\"\"></p><center><span class=\"reference\">å›¾3 union allçš„explainç»“æœ</span></center><p>å¯ä»¥çœ‹åˆ°ï¼Œç¬¬äºŒè¡Œçš„Extraå­—æ®µæ˜¾ç¤ºçš„æ˜¯Using indexï¼Œè¡¨ç¤ºåªä½¿ç”¨äº†è¦†ç›–ç´¢å¼•ï¼Œæ²¡æœ‰ç”¨ä¸´æ—¶è¡¨äº†ã€‚</p><h1>group by æ‰§è¡Œæµç¨‹</h1><p>å¦å¤–ä¸€ä¸ªå¸¸è§çš„ä½¿ç”¨ä¸´æ—¶è¡¨çš„ä¾‹å­æ˜¯group byï¼Œæˆ‘ä»¬æ¥çœ‹ä¸€ä¸‹è¿™ä¸ªè¯­å¥ï¼š</p><pre><code>select id%10 as m, count(*) as c from t1 group by m;\n</code></pre><p>è¿™ä¸ªè¯­å¥çš„é€»è¾‘æ˜¯æŠŠè¡¨t1é‡Œçš„æ•°æ®ï¼ŒæŒ‰ç…§ id%10 è¿›è¡Œåˆ†ç»„ç»Ÿè®¡ï¼Œå¹¶æŒ‰ç…§mçš„ç»“æœæ’åºåè¾“å‡ºã€‚å®ƒçš„explainç»“æœå¦‚ä¸‹ï¼š</p><p><img src=\"https://static001.geekbang.org/resource/image/3d/98/3d1cb94589b6b3c4bb57b0bdfa385d98.png?wh=1702*143\" alt=\"\"></p><center><span class=\"reference\">å›¾4 group by çš„explainç»“æœ</span></center><p>åœ¨Extraå­—æ®µé‡Œé¢ï¼Œæˆ‘ä»¬å¯ä»¥çœ‹åˆ°ä¸‰ä¸ªä¿¡æ¯ï¼š</p><ul>\n<li>Using indexï¼Œè¡¨ç¤ºè¿™ä¸ªè¯­å¥ä½¿ç”¨äº†è¦†ç›–ç´¢å¼•ï¼Œé€‰æ‹©äº†ç´¢å¼•aï¼Œä¸éœ€è¦å›è¡¨ï¼›</li>\n<li>Using temporaryï¼Œè¡¨ç¤ºä½¿ç”¨äº†ä¸´æ—¶è¡¨ï¼›</li>\n<li>Using filesortï¼Œè¡¨ç¤ºéœ€è¦æ’åºã€‚</li>\n</ul><p>è¿™ä¸ªè¯­å¥çš„æ‰§è¡Œæµç¨‹æ˜¯è¿™æ ·çš„ï¼š</p><ol>\n<li>\n<p>åˆ›å»ºå†…å­˜ä¸´æ—¶è¡¨ï¼Œè¡¨é‡Œæœ‰ä¸¤ä¸ªå­—æ®µmå’Œcï¼Œä¸»é”®æ˜¯mï¼›</p>\n</li>\n<li>\n<p>æ‰«æè¡¨t1çš„ç´¢å¼•aï¼Œä¾æ¬¡å–å‡ºå¶å­èŠ‚ç‚¹ä¸Šçš„idå€¼ï¼Œè®¡ç®—id%10çš„ç»“æœï¼Œè®°ä¸ºxï¼›</p>\n<ul>\n<li>å¦‚æœä¸´æ—¶è¡¨ä¸­æ²¡æœ‰ä¸»é”®ä¸ºxçš„è¡Œï¼Œå°±æ’å…¥ä¸€ä¸ªè®°å½•(x,1);</li>\n<li>å¦‚æœè¡¨ä¸­æœ‰ä¸»é”®ä¸ºxçš„è¡Œï¼Œå°±å°†xè¿™ä¸€è¡Œçš„cå€¼åŠ 1ï¼›</li>\n</ul>\n</li>\n<li>\n<p>éå†å®Œæˆåï¼Œå†æ ¹æ®å­—æ®µmåšæ’åºï¼Œå¾—åˆ°ç»“æœé›†è¿”å›ç»™å®¢æˆ·ç«¯ã€‚</p>\n</li>\n</ol><p>è¿™ä¸ªæµç¨‹çš„æ‰§è¡Œå›¾å¦‚ä¸‹ï¼š</p><p><img src=\"https://static001.geekbang.org/resource/image/03/54/0399382169faf50fc1b354099af71954.jpg?wh=1142*880\" alt=\"\"></p><center><span class=\"reference\">å›¾5 group byæ‰§è¡Œæµç¨‹</span></center><p>å›¾ä¸­æœ€åä¸€æ­¥ï¼Œå¯¹å†…å­˜ä¸´æ—¶è¡¨çš„æ’åºï¼Œåœ¨<a href=\"https://time.geekbang.org/column/article/73795\">ç¬¬17ç¯‡æ–‡ç« </a>ä¸­å·²ç»æœ‰è¿‡ä»‹ç»ï¼Œæˆ‘æŠŠå›¾è´´è¿‡æ¥ï¼Œæ–¹ä¾¿ä½ å›é¡¾ã€‚</p><p><img src=\"https://static001.geekbang.org/resource/image/b5/68/b5168d201f5a89de3b424ede2ebf3d68.jpg?wh=1142*880\" alt=\"\"></p><center><span class=\"reference\">å›¾6 å†…å­˜ä¸´æ—¶è¡¨æ’åºæµç¨‹</span></center><p>å…¶ä¸­ï¼Œä¸´æ—¶è¡¨çš„æ’åºè¿‡ç¨‹å°±æ˜¯å›¾6ä¸­è™šçº¿æ¡†å†…çš„è¿‡ç¨‹ã€‚</p><p>æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬å†çœ‹ä¸€ä¸‹è¿™æ¡è¯­å¥çš„æ‰§è¡Œç»“æœï¼š</p><p><img src=\"https://static001.geekbang.org/resource/image/ae/55/ae6a28d890efc35ee4d07f694068f455.png?wh=676*348\" alt=\"\"></p><center><span class=\"reference\">å›¾ 7 group byæ‰§è¡Œç»“æœ</span></center><p>å¦‚æœä½ çš„éœ€æ±‚å¹¶ä¸éœ€è¦å¯¹ç»“æœè¿›è¡Œæ’åºï¼Œé‚£ä½ å¯ä»¥åœ¨SQLè¯­å¥æœ«å°¾å¢åŠ order by nullï¼Œä¹Ÿå°±æ˜¯æ”¹æˆï¼š</p><pre><code>select id%10 as m, count(*) as c from t1 group by m order by null;\n</code></pre><p>è¿™æ ·å°±è·³è¿‡äº†æœ€åæ’åºçš„é˜¶æ®µï¼Œç›´æ¥ä»ä¸´æ—¶è¡¨ä¸­å–æ•°æ®è¿”å›ã€‚è¿”å›çš„ç»“æœå¦‚å›¾8æ‰€ç¤ºã€‚</p><p><img src=\"https://static001.geekbang.org/resource/image/03/eb/036634e53276eaf8535c3442805dfaeb.png?wh=823*376\" alt=\"\"></p><center><span class=\"reference\">å›¾8 group + order by null çš„ç»“æœï¼ˆå†…å­˜ä¸´æ—¶è¡¨ï¼‰</span></center><p>ç”±äºè¡¨t1ä¸­çš„idå€¼æ˜¯ä»1å¼€å§‹çš„ï¼Œå› æ­¤è¿”å›çš„ç»“æœé›†ä¸­ç¬¬ä¸€è¡Œæ˜¯id=1ï¼›æ‰«æåˆ°id=10çš„æ—¶å€™æ‰æ’å…¥m=0è¿™ä¸€è¡Œï¼Œå› æ­¤ç»“æœé›†é‡Œæœ€åä¸€è¡Œæ‰æ˜¯m=0ã€‚</p><p>è¿™ä¸ªä¾‹å­é‡Œç”±äºä¸´æ—¶è¡¨åªæœ‰10è¡Œï¼Œå†…å­˜å¯ä»¥æ”¾å¾—ä¸‹ï¼Œå› æ­¤å…¨ç¨‹åªä½¿ç”¨äº†å†…å­˜ä¸´æ—¶è¡¨ã€‚ä½†æ˜¯ï¼Œå†…å­˜ä¸´æ—¶è¡¨çš„å¤§å°æ˜¯æœ‰é™åˆ¶çš„ï¼Œå‚æ•°tmp_table_sizeå°±æ˜¯æ§åˆ¶è¿™ä¸ªå†…å­˜å¤§å°çš„ï¼Œé»˜è®¤æ˜¯16Mã€‚</p><p>å¦‚æœæˆ‘æ‰§è¡Œä¸‹é¢è¿™ä¸ªè¯­å¥åºåˆ—ï¼š</p><pre><code>set tmp_table_size=1024;\nselect id%100 as m, count(*) as c from t1 group by m order by null limit 10;\n</code></pre><p>æŠŠå†…å­˜ä¸´æ—¶è¡¨çš„å¤§å°é™åˆ¶ä¸ºæœ€å¤§1024å­—èŠ‚ï¼Œå¹¶æŠŠè¯­å¥æ”¹æˆid % 100ï¼Œè¿™æ ·è¿”å›ç»“æœé‡Œæœ‰100è¡Œæ•°æ®ã€‚ä½†æ˜¯ï¼Œè¿™æ—¶çš„å†…å­˜ä¸´æ—¶è¡¨å¤§å°ä¸å¤Ÿå­˜ä¸‹è¿™100è¡Œæ•°æ®ï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œæ‰§è¡Œè¿‡ç¨‹ä¸­ä¼šå‘ç°å†…å­˜ä¸´æ—¶è¡¨å¤§å°åˆ°è¾¾äº†ä¸Šé™ï¼ˆ1024å­—èŠ‚ï¼‰ã€‚</p><p>é‚£ä¹ˆï¼Œè¿™æ—¶å€™å°±ä¼šæŠŠå†…å­˜ä¸´æ—¶è¡¨è½¬æˆç£ç›˜ä¸´æ—¶è¡¨ï¼Œç£ç›˜ä¸´æ—¶è¡¨é»˜è®¤ä½¿ç”¨çš„å¼•æ“æ˜¯InnoDBã€‚ è¿™æ—¶ï¼Œè¿”å›çš„ç»“æœå¦‚å›¾9æ‰€ç¤ºã€‚</p><p><img src=\"https://static001.geekbang.org/resource/image/a7/6e/a76381d0f3c947292cc28198901f9e6e.png?wh=896*332\" alt=\"\"></p><center><span class=\"reference\">å›¾9 group + order by null çš„ç»“æœï¼ˆç£ç›˜ä¸´æ—¶è¡¨ï¼‰</span></center><p>å¦‚æœè¿™ä¸ªè¡¨t1çš„æ•°æ®é‡å¾ˆå¤§ï¼Œå¾ˆå¯èƒ½è¿™ä¸ªæŸ¥è¯¢éœ€è¦çš„ç£ç›˜ä¸´æ—¶è¡¨å°±ä¼šå ç”¨å¤§é‡çš„ç£ç›˜ç©ºé—´ã€‚</p><h1>group by ä¼˜åŒ–æ–¹æ³• --ç´¢å¼•</h1><p>å¯ä»¥çœ‹åˆ°ï¼Œä¸è®ºæ˜¯ä½¿ç”¨å†…å­˜ä¸´æ—¶è¡¨è¿˜æ˜¯ç£ç›˜ä¸´æ—¶è¡¨ï¼Œgroup byé€»è¾‘éƒ½éœ€è¦æ„é€ ä¸€ä¸ªå¸¦å”¯ä¸€ç´¢å¼•çš„è¡¨ï¼Œæ‰§è¡Œä»£ä»·éƒ½æ˜¯æ¯”è¾ƒé«˜çš„ã€‚å¦‚æœè¡¨çš„æ•°æ®é‡æ¯”è¾ƒå¤§ï¼Œä¸Šé¢è¿™ä¸ªgroup byè¯­å¥æ‰§è¡Œèµ·æ¥å°±ä¼šå¾ˆæ…¢ï¼Œæˆ‘ä»¬æœ‰ä»€ä¹ˆä¼˜åŒ–çš„æ–¹æ³•å‘¢ï¼Ÿ</p><p>è¦è§£å†³group byè¯­å¥çš„ä¼˜åŒ–é—®é¢˜ï¼Œä½ å¯ä»¥å…ˆæƒ³ä¸€ä¸‹è¿™ä¸ªé—®é¢˜ï¼šæ‰§è¡Œgroup byè¯­å¥ä¸ºä»€ä¹ˆéœ€è¦ä¸´æ—¶è¡¨ï¼Ÿ</p><p>group byçš„è¯­ä¹‰é€»è¾‘ï¼Œæ˜¯ç»Ÿè®¡ä¸åŒçš„å€¼å‡ºç°çš„ä¸ªæ•°ã€‚ä½†æ˜¯ï¼Œç”±äºæ¯ä¸€è¡Œçš„id%100çš„ç»“æœæ˜¯æ— åºçš„ï¼Œæ‰€ä»¥æˆ‘ä»¬å°±éœ€è¦æœ‰ä¸€ä¸ªä¸´æ—¶è¡¨ï¼Œæ¥è®°å½•å¹¶ç»Ÿè®¡ç»“æœã€‚</p><p>é‚£ä¹ˆï¼Œå¦‚æœæ‰«æè¿‡ç¨‹ä¸­å¯ä»¥ä¿è¯å‡ºç°çš„æ•°æ®æ˜¯æœ‰åºçš„ï¼Œæ˜¯ä¸æ˜¯å°±ç®€å•äº†å‘¢ï¼Ÿ</p><p>å‡è®¾ï¼Œç°åœ¨æœ‰ä¸€ä¸ªç±»ä¼¼å›¾10çš„è¿™ä¹ˆä¸€ä¸ªæ•°æ®ç»“æ„ï¼Œæˆ‘ä»¬æ¥çœ‹çœ‹group byå¯ä»¥æ€ä¹ˆåšã€‚</p><p><img src=\"https://static001.geekbang.org/resource/image/5c/19/5c4a581c324c1f6702f9a2c70acddd19.jpg?wh=1142*880\" alt=\"\"></p><center><span class=\"reference\">å›¾10 group byç®—æ³•ä¼˜åŒ–-æœ‰åºè¾“å…¥</span></center><p>å¯ä»¥çœ‹åˆ°ï¼Œå¦‚æœå¯ä»¥ç¡®ä¿è¾“å…¥çš„æ•°æ®æ˜¯æœ‰åºçš„ï¼Œé‚£ä¹ˆè®¡ç®—group byçš„æ—¶å€™ï¼Œå°±åªéœ€è¦ä»å·¦åˆ°å³ï¼Œé¡ºåºæ‰«æï¼Œä¾æ¬¡ç´¯åŠ ã€‚ä¹Ÿå°±æ˜¯ä¸‹é¢è¿™ä¸ªè¿‡ç¨‹ï¼š</p><ul>\n<li>å½“ç¢°åˆ°ç¬¬ä¸€ä¸ª1çš„æ—¶å€™ï¼Œå·²ç»çŸ¥é“ç´¯ç§¯äº†Xä¸ª0ï¼Œç»“æœé›†é‡Œçš„ç¬¬ä¸€è¡Œå°±æ˜¯(0,X);</li>\n<li>å½“ç¢°åˆ°ç¬¬ä¸€ä¸ª2çš„æ—¶å€™ï¼Œå·²ç»çŸ¥é“ç´¯ç§¯äº†Yä¸ª1ï¼Œç»“æœé›†é‡Œçš„ç¬¬äºŒè¡Œå°±æ˜¯(1,Y);</li>\n</ul><p>æŒ‰ç…§è¿™ä¸ªé€»è¾‘æ‰§è¡Œçš„è¯ï¼Œæ‰«æåˆ°æ•´ä¸ªè¾“å…¥çš„æ•°æ®ç»“æŸï¼Œå°±å¯ä»¥æ‹¿åˆ°group byçš„ç»“æœï¼Œä¸éœ€è¦ä¸´æ—¶è¡¨ï¼Œä¹Ÿä¸éœ€è¦å†é¢å¤–æ’åºã€‚</p><p>ä½ ä¸€å®šæƒ³åˆ°äº†ï¼ŒInnoDBçš„ç´¢å¼•ï¼Œå°±å¯ä»¥æ»¡è¶³è¿™ä¸ªè¾“å…¥æœ‰åºçš„æ¡ä»¶ã€‚</p><p>åœ¨MySQL 5.7ç‰ˆæœ¬æ”¯æŒäº†generated columnæœºåˆ¶ï¼Œç”¨æ¥å®ç°åˆ—æ•°æ®çš„å…³è”æ›´æ–°ã€‚ä½ å¯ä»¥ç”¨ä¸‹é¢çš„æ–¹æ³•åˆ›å»ºä¸€ä¸ªåˆ—zï¼Œç„¶ååœ¨zåˆ—ä¸Šåˆ›å»ºä¸€ä¸ªç´¢å¼•ï¼ˆå¦‚æœæ˜¯MySQL 5.6åŠä¹‹å‰çš„ç‰ˆæœ¬ï¼Œä½ ä¹Ÿå¯ä»¥åˆ›å»ºæ™®é€šåˆ—å’Œç´¢å¼•ï¼Œæ¥è§£å†³è¿™ä¸ªé—®é¢˜ï¼‰ã€‚</p><pre><code>alter table t1 add column z int generated always as(id % 100), add index(z);\n</code></pre><p>è¿™æ ·ï¼Œç´¢å¼•zä¸Šçš„æ•°æ®å°±æ˜¯ç±»ä¼¼å›¾10è¿™æ ·æœ‰åºçš„äº†ã€‚ä¸Šé¢çš„group byè¯­å¥å°±å¯ä»¥æ”¹æˆï¼š</p><pre><code>select z, count(*) as c from t1 group by z;\n</code></pre><p>ä¼˜åŒ–åçš„group byè¯­å¥çš„explainç»“æœï¼Œå¦‚ä¸‹å›¾æ‰€ç¤ºï¼š</p><p><img src=\"https://static001.geekbang.org/resource/image/c9/b9/c9f88fa42d92cf7dde78fca26c4798b9.png?wh=1349*143\" alt=\"\"></p><center><span class=\"reference\">å›¾11 group by ä¼˜åŒ–çš„explainç»“æœ</span></center><p>ä»Extraå­—æ®µå¯ä»¥çœ‹åˆ°ï¼Œè¿™ä¸ªè¯­å¥çš„æ‰§è¡Œä¸å†éœ€è¦ä¸´æ—¶è¡¨ï¼Œä¹Ÿä¸éœ€è¦æ’åºäº†ã€‚</p><h1>group byä¼˜åŒ–æ–¹æ³• --ç›´æ¥æ’åº</h1><p>æ‰€ä»¥ï¼Œå¦‚æœå¯ä»¥é€šè¿‡åŠ ç´¢å¼•æ¥å®Œæˆgroup byé€»è¾‘å°±å†å¥½ä¸è¿‡äº†ã€‚ä½†æ˜¯ï¼Œå¦‚æœç¢°ä¸Šä¸é€‚åˆåˆ›å»ºç´¢å¼•çš„åœºæ™¯ï¼Œæˆ‘ä»¬è¿˜æ˜¯è¦è€è€å®å®åšæ’åºçš„ã€‚é‚£ä¹ˆï¼Œè¿™æ—¶å€™çš„group byè¦æ€ä¹ˆä¼˜åŒ–å‘¢ï¼Ÿ</p><p>å¦‚æœæˆ‘ä»¬æ˜æ˜çŸ¥é“ï¼Œä¸€ä¸ªgroup byè¯­å¥ä¸­éœ€è¦æ”¾åˆ°ä¸´æ—¶è¡¨ä¸Šçš„æ•°æ®é‡ç‰¹åˆ«å¤§ï¼Œå´è¿˜æ˜¯è¦æŒ‰ç…§â€œå…ˆæ”¾åˆ°å†…å­˜ä¸´æ—¶è¡¨ï¼Œæ’å…¥ä¸€éƒ¨åˆ†æ•°æ®åï¼Œå‘ç°å†…å­˜ä¸´æ—¶è¡¨ä¸å¤Ÿç”¨äº†å†è½¬æˆç£ç›˜ä¸´æ—¶è¡¨â€ï¼Œçœ‹ä¸Šå»å°±æœ‰ç‚¹å„¿å‚»ã€‚</p><p>é‚£ä¹ˆï¼Œæˆ‘ä»¬å°±ä¼šæƒ³äº†ï¼ŒMySQLæœ‰æ²¡æœ‰è®©æˆ‘ä»¬ç›´æ¥èµ°ç£ç›˜ä¸´æ—¶è¡¨çš„æ–¹æ³•å‘¢ï¼Ÿ</p><p>ç­”æ¡ˆæ˜¯ï¼Œæœ‰çš„ã€‚</p><p>åœ¨group byè¯­å¥ä¸­åŠ å…¥SQL_BIG_RESULTè¿™ä¸ªæç¤ºï¼ˆhintï¼‰ï¼Œå°±å¯ä»¥å‘Šè¯‰ä¼˜åŒ–å™¨ï¼šè¿™ä¸ªè¯­å¥æ¶‰åŠçš„æ•°æ®é‡å¾ˆå¤§ï¼Œè¯·ç›´æ¥ç”¨ç£ç›˜ä¸´æ—¶è¡¨ã€‚</p><p>MySQLçš„ä¼˜åŒ–å™¨ä¸€çœ‹ï¼Œç£ç›˜ä¸´æ—¶è¡¨æ˜¯B+æ ‘å­˜å‚¨ï¼Œå­˜å‚¨æ•ˆç‡ä¸å¦‚æ•°ç»„æ¥å¾—é«˜ã€‚æ‰€ä»¥ï¼Œæ—¢ç„¶ä½ å‘Šè¯‰æˆ‘æ•°æ®é‡å¾ˆå¤§ï¼Œé‚£ä»ç£ç›˜ç©ºé—´è€ƒè™‘ï¼Œè¿˜æ˜¯ç›´æ¥ç”¨æ•°ç»„æ¥å­˜å§ã€‚</p><p>å› æ­¤ï¼Œä¸‹é¢è¿™ä¸ªè¯­å¥</p><pre><code>select SQL_BIG_RESULT id%100 as m, count(*) as c from t1 group by m;\n</code></pre><p>çš„æ‰§è¡Œæµç¨‹å°±æ˜¯è¿™æ ·çš„ï¼š</p><ol>\n<li>\n<p>åˆå§‹åŒ–sort_bufferï¼Œç¡®å®šæ”¾å…¥ä¸€ä¸ªæ•´å‹å­—æ®µï¼Œè®°ä¸ºmï¼›</p>\n</li>\n<li>\n<p>æ‰«æè¡¨t1çš„ç´¢å¼•aï¼Œä¾æ¬¡å–å‡ºé‡Œé¢çš„idå€¼, å°† id%100çš„å€¼å­˜å…¥sort_bufferä¸­ï¼›</p>\n</li>\n<li>\n<p>æ‰«æå®Œæˆåï¼Œå¯¹sort_bufferçš„å­—æ®µmåšæ’åºï¼ˆå¦‚æœsort_bufferå†…å­˜ä¸å¤Ÿç”¨ï¼Œå°±ä¼šåˆ©ç”¨ç£ç›˜ä¸´æ—¶æ–‡ä»¶è¾…åŠ©æ’åºï¼‰ï¼›</p>\n</li>\n<li>\n<p>æ’åºå®Œæˆåï¼Œå°±å¾—åˆ°äº†ä¸€ä¸ªæœ‰åºæ•°ç»„ã€‚</p>\n</li>\n</ol><p>æ ¹æ®æœ‰åºæ•°ç»„ï¼Œå¾—åˆ°æ•°ç»„é‡Œé¢çš„ä¸åŒå€¼ï¼Œä»¥åŠæ¯ä¸ªå€¼çš„å‡ºç°æ¬¡æ•°ã€‚è¿™ä¸€æ­¥çš„é€»è¾‘ï¼Œä½ å·²ç»ä»å‰é¢çš„å›¾10ä¸­äº†è§£è¿‡äº†ã€‚</p><p>ä¸‹é¢ä¸¤å¼ å›¾åˆ†åˆ«æ˜¯æ‰§è¡Œæµç¨‹å›¾å’Œæ‰§è¡Œexplainå‘½ä»¤å¾—åˆ°çš„ç»“æœã€‚</p><p><img src=\"https://static001.geekbang.org/resource/image/82/6a/8269dc6206a7ef20cb515c23df0b846a.jpg?wh=1142*880\" alt=\"\"></p><center><span class=\"reference\">å›¾12 ä½¿ç”¨ SQL_BIG_RESULTçš„æ‰§è¡Œæµç¨‹å›¾</span></center><p><img src=\"https://static001.geekbang.org/resource/image/83/ec/83b6cd6b3e37dfbf9699cf0ccc0f1bec.png?wh=1393*131\" alt=\"\"></p><center><span class=\"reference\">å›¾13 ä½¿ç”¨ SQL_BIG_RESULTçš„explain ç»“æœ</span></center><p>ä»Extraå­—æ®µå¯ä»¥çœ‹åˆ°ï¼Œè¿™ä¸ªè¯­å¥çš„æ‰§è¡Œæ²¡æœ‰å†ä½¿ç”¨ä¸´æ—¶è¡¨ï¼Œè€Œæ˜¯ç›´æ¥ç”¨äº†æ’åºç®—æ³•ã€‚</p><p>åŸºäºä¸Šé¢çš„unionã€union allå’Œgroup byè¯­å¥çš„æ‰§è¡Œè¿‡ç¨‹çš„åˆ†æï¼Œæˆ‘ä»¬æ¥å›ç­”æ–‡ç« å¼€å¤´çš„é—®é¢˜ï¼šMySQLä»€ä¹ˆæ—¶å€™ä¼šä½¿ç”¨å†…éƒ¨ä¸´æ—¶è¡¨ï¼Ÿ</p><ol>\n<li>\n<p>å¦‚æœè¯­å¥æ‰§è¡Œè¿‡ç¨‹å¯ä»¥ä¸€è¾¹è¯»æ•°æ®ï¼Œä¸€è¾¹ç›´æ¥å¾—åˆ°ç»“æœï¼Œæ˜¯ä¸éœ€è¦é¢å¤–å†…å­˜çš„ï¼Œå¦åˆ™å°±éœ€è¦é¢å¤–çš„å†…å­˜ï¼Œæ¥ä¿å­˜ä¸­é—´ç»“æœï¼›</p>\n</li>\n<li>\n<p>join_bufferæ˜¯æ— åºæ•°ç»„ï¼Œsort_bufferæ˜¯æœ‰åºæ•°ç»„ï¼Œä¸´æ—¶è¡¨æ˜¯äºŒç»´è¡¨ç»“æ„ï¼›</p>\n</li>\n<li>\n<p>å¦‚æœæ‰§è¡Œé€»è¾‘éœ€è¦ç”¨åˆ°äºŒç»´è¡¨ç‰¹æ€§ï¼Œå°±ä¼šä¼˜å…ˆè€ƒè™‘ä½¿ç”¨ä¸´æ—¶è¡¨ã€‚æ¯”å¦‚æˆ‘ä»¬çš„ä¾‹å­ä¸­ï¼Œunionéœ€è¦ç”¨åˆ°å”¯ä¸€ç´¢å¼•çº¦æŸï¼Œ group byè¿˜éœ€è¦ç”¨åˆ°å¦å¤–ä¸€ä¸ªå­—æ®µæ¥å­˜ç´¯ç§¯è®¡æ•°ã€‚</p>\n</li>\n</ol><h1>å°ç»“</h1><p>é€šè¿‡ä»Šå¤©è¿™ç¯‡æ–‡ç« ï¼Œæˆ‘é‡ç‚¹å’Œä½ è®²äº†group byçš„å‡ ç§å®ç°ç®—æ³•ï¼Œä»ä¸­å¯ä»¥æ€»ç»“ä¸€äº›ä½¿ç”¨çš„æŒ‡å¯¼åŸåˆ™ï¼š</p><ol>\n<li>\n<p>å¦‚æœå¯¹group byè¯­å¥çš„ç»“æœæ²¡æœ‰æ’åºè¦æ±‚ï¼Œè¦åœ¨è¯­å¥åé¢åŠ  order by nullï¼›</p>\n</li>\n<li>\n<p>å°½é‡è®©group byè¿‡ç¨‹ç”¨ä¸Šè¡¨çš„ç´¢å¼•ï¼Œç¡®è®¤æ–¹æ³•æ˜¯explainç»“æœé‡Œæ²¡æœ‰Using temporary å’Œ Using filesortï¼›</p>\n</li>\n<li>\n<p>å¦‚æœgroup byéœ€è¦ç»Ÿè®¡çš„æ•°æ®é‡ä¸å¤§ï¼Œå°½é‡åªä½¿ç”¨å†…å­˜ä¸´æ—¶è¡¨ï¼›ä¹Ÿå¯ä»¥é€šè¿‡é€‚å½“è°ƒå¤§tmp_table_sizeå‚æ•°ï¼Œæ¥é¿å…ç”¨åˆ°ç£ç›˜ä¸´æ—¶è¡¨ï¼›</p>\n</li>\n<li>\n<p>å¦‚æœæ•°æ®é‡å®åœ¨å¤ªå¤§ï¼Œä½¿ç”¨SQL_BIG_RESULTè¿™ä¸ªæç¤ºï¼Œæ¥å‘Šè¯‰ä¼˜åŒ–å™¨ç›´æ¥ä½¿ç”¨æ’åºç®—æ³•å¾—åˆ°group byçš„ç»“æœã€‚</p>\n</li>\n</ol><p>æœ€åï¼Œæˆ‘ç»™ä½ ç•™ä¸‹ä¸€ä¸ªæ€è€ƒé¢˜å§ã€‚</p><p>æ–‡ç« ä¸­å›¾8å’Œå›¾9éƒ½æ˜¯order by nullï¼Œä¸ºä»€ä¹ˆå›¾8çš„è¿”å›ç»“æœé‡Œé¢ï¼Œ0æ˜¯åœ¨ç»“æœé›†çš„æœ€åä¸€è¡Œï¼Œè€Œå›¾9çš„ç»“æœé‡Œé¢ï¼Œ0æ˜¯åœ¨ç»“æœé›†çš„ç¬¬ä¸€è¡Œï¼Ÿ</p><p>ä½ å¯ä»¥æŠŠä½ çš„åˆ†æå†™åœ¨ç•™è¨€åŒºé‡Œï¼Œæˆ‘ä¼šåœ¨ä¸‹ä¸€ç¯‡æ–‡ç« å’Œä½ è®¨è®ºè¿™ä¸ªé—®é¢˜ã€‚æ„Ÿè°¢ä½ çš„æ”¶å¬ï¼Œä¹Ÿæ¬¢è¿ä½ æŠŠè¿™ç¯‡æ–‡ç« åˆ†äº«ç»™æ›´å¤šçš„æœ‹å‹ä¸€èµ·é˜…è¯»ã€‚</p><h1>ä¸ŠæœŸé—®é¢˜æ—¶é—´</h1><p>ä¸ŠæœŸçš„é—®é¢˜æ˜¯ï¼šä¸ºä»€ä¹ˆä¸èƒ½ç”¨renameä¿®æ”¹ä¸´æ—¶è¡¨çš„æ”¹åã€‚</p><p>åœ¨å®ç°ä¸Šï¼Œæ‰§è¡Œrename tableè¯­å¥çš„æ—¶å€™ï¼Œè¦æ±‚æŒ‰ç…§â€œåº“å/è¡¨å.frmâ€çš„è§„åˆ™å»ç£ç›˜æ‰¾æ–‡ä»¶ï¼Œä½†æ˜¯ä¸´æ—¶è¡¨åœ¨ç£ç›˜ä¸Šçš„frmæ–‡ä»¶æ˜¯æ”¾åœ¨tmpdirç›®å½•ä¸‹çš„ï¼Œå¹¶ä¸”æ–‡ä»¶åçš„è§„åˆ™æ˜¯â€œ#sql{è¿›ç¨‹id}_{çº¿ç¨‹id}_åºåˆ—å·.frmâ€ï¼Œå› æ­¤ä¼šæŠ¥â€œæ‰¾ä¸åˆ°æ–‡ä»¶åâ€çš„é”™è¯¯ã€‚</p><p>è¯„è®ºåŒºç•™è¨€ç‚¹èµæ¿ï¼š</p><blockquote>\n<p>@poppy åŒå­¦ï¼Œé€šè¿‡æ‰§è¡Œè¯­å¥çš„æŠ¥é”™ç°è±¡æ¨æµ‹äº†è¿™ä¸ªå®ç°è¿‡ç¨‹ã€‚</p>\n</blockquote><p></p>","comments":[{"had_liked":false,"id":65572,"user_name":"è€æ¨åŒå¿—","can_delete":false,"product_type":"c1","uid":1246199,"ip_address":"","ucode":"3F334F0CFD3DE6","user_header":"https://static001.geekbang.org/account/avatar/00/13/03/f7/3a493bec.jpg","comment_is_top":false,"comment_ctime":1549461830,"is_pvip":false,"replies":[{"id":"23223","content":"æ–°å¹´å¥½<br><br>å¥½é—®é¢˜ï¼Œæˆ‘åŠ åˆ°åé¢æ–‡ç« ä¸­ã€‚<br>ç®€å•è¯´ä¸‹ç»“è®ºï¼Œåªéœ€è¦å»é‡çš„è¯ï¼Œå¦‚æœæ²¡æœ‰limitï¼Œæ˜¯ä¸€æ ·çš„ï¼›<br>æœ‰limitçš„è¯ï¼Œdistinct å¿«äº›ã€‚<br><br>æ¼‚äº®çš„å›ç­”ğŸ‘<br><br>","user_name":"ä½œè€…å›å¤","comment_id":65572,"uid":"1264162","ip_address":"","utype":1,"ctime":1549502743,"user_name_real":"æ—æ™“æ–Œ"}],"discussion_count":4,"race_medal":0,"score":"456815995206","product_id":100020801,"comment_content":"è¯·æ•™ä¸€ä¸ªé—®é¢˜ï¼šå¦‚æœåªéœ€è¦å»é‡ï¼Œä¸éœ€è¦æ‰§è¡Œèšåˆå‡½æ•°ï¼Œdistinct å’Œgroup byé‚£ç§æ•ˆç‡é«˜ä¸€äº›å‘¢ï¼Ÿ<br><br>è¯¾åä¹ é¢˜:<br>å›¾8ï¼ŒæŠŠç»Ÿè®¡ç»“æœå­˜å†…å­˜ä¸´æ—¶è¡¨ï¼Œä¸æ’åºã€‚idæ˜¯ä»1åˆ°1000ï¼Œæ¨¡10çš„ç»“æœé¡ºåºå°±æ˜¯1ã€2ã€3ã€4ã€5ã€‚ã€‚ã€‚<br>å›¾9ï¼Œè€å¸ˆæŠŠtmp_table_sizeæ”¹å°äº†ï¼Œå†…å­˜ä¸´æ—¶è¡¨è£…ä¸ä¸‹ï¼Œæ”¹ç”¨ç£ç›˜ä¸´æ—¶è¡¨ã€‚æ ¹æ®è€å¸ˆè®²çš„æµç¨‹ï¼Œidå–æ¨¡çš„ç»“æœï¼Œæ’åºåå­˜å…¥ä¸´æ—¶è¡¨ï¼Œä¸´æ—¶çš„æ•°æ®åº”è¯¥æ˜¯0,0,0,0,0,0,0,0,0,0,1,1,1,1,1,1,1,1,1,1,2,......<br>ä»è¿™ä¸ªç£ç›˜ä¸´æ—¶è¡¨è¯»å–æ•°æ®æ±‡æ€»çš„ç»“æœçš„é¡ºåºå°±æ˜¯0,1,2,3,4,5ã€‚ã€‚ã€‚","like_count":107,"discussions":[{"author":{"id":1264162,"avatar":"https://static001.geekbang.org/account/avatar/00/13/4a/22/2681d602.jpg","nickname":"æ—æ™“æ–Œ","note":"","ucode":"CDE42D44F26240","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":438503,"discussion_content":"æ–°å¹´å¥½\n\nå¥½é—®é¢˜ï¼Œæˆ‘åŠ åˆ°åé¢æ–‡ç« ä¸­ã€‚\nç®€å•è¯´ä¸‹ç»“è®ºï¼Œåªéœ€è¦å»é‡çš„è¯ï¼Œå¦‚æœæ²¡æœ‰limitï¼Œæ˜¯ä¸€æ ·çš„ï¼›\næœ‰limitçš„è¯ï¼Œdistinct å¿«äº›ã€‚\n\næ¼‚äº®çš„å›ç­”ğŸ‘\n\n","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1549502743,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":2037528,"avatar":"https://static001.geekbang.org/account/avatar/00/1f/17/18/3f46df92.jpg","nickname":"å¼ æ¯…æœ‹","note":"","ucode":"61C06FB231B095","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":559973,"discussion_content":"ä¸´æ—¶è¡¨å­˜çš„ä¸æ˜¯må’Œcå—ï¼Ÿä¸ºä»€ä¹ˆæ‚¨è¯´å­˜çš„æ˜¯idå–æ¨¡åçš„ä¸­é—´æ•°æ®ï¼Ÿ","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1649086262,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1320092,"avatar":"https://thirdwx.qlogo.cn/mmopen/vi_32/Q3auHgzwzM4z9WYWVvWDhMF0SicPE5ad56ME6DibyWGbRoQa0lH4U9icdsjNcv3ssRickcuRMDA01e6vMXnmOVSr9l5LVUefVxicn/132","nickname":"black_mirror","note":"","ucode":"2549C87298BF12","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":311094,"discussion_content":"slow log","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1602219216,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1508329,"avatar":"https://static001.geekbang.org/account/avatar/00/17/03/e9/6358059c.jpg","nickname":"GalaxyCreater","note":"","ucode":"C79E8A088D57CF","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":266542,"discussion_content":"æ€ä¹ˆçœ‹é»˜è®¤ä½¿ç”¨çš„æ˜¯å“ªç§ç±»å‹çš„ä¸´æ—¶è¡¨ï¼Œæµ‹è¯•ç»“æœå‡ºæ¥å¥½åƒä¸ä¸€è‡´","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1589529575,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":65487,"user_name":"é•¿æ°","can_delete":false,"product_type":"c1","uid":1312212,"ip_address":"","ucode":"DD52C9494005F7","user_header":"https://static001.geekbang.org/account/avatar/00/14/05/d4/e06bf86d.jpg","comment_is_top":false,"comment_ctime":1549413482,"is_pvip":false,"replies":[{"id":"23211","content":"ğŸ‘ğŸ¿<br>æ˜¥èŠ‚å¿«ä¹","user_name":"ä½œè€…å›å¤","comment_id":65487,"uid":"1264162","ip_address":"","utype":1,"ctime":1549427643,"user_name_real":"æ—æ™“æ–Œ"}],"discussion_count":3,"race_medal":0,"score":"302197124202","product_id":100020801,"comment_content":"å›¾ä¹ä½¿ç”¨çš„æ˜¯ç£ç›˜ä¸´æ—¶è¡¨ï¼Œç£ç›˜ä¸´æ—¶è¡¨ä½¿ç”¨çš„å¼•æ“æ˜¯innodbï¼Œinnodbæ˜¯ç´¢å¼•ç»„ç»‡è¡¨ï¼ŒæŒ‰ä¸»é”®é¡ºåºå­˜å‚¨æ•°æ®ï¼Œæ‰€ä»¥æ˜¯æŒ‰ç…§må­—æ®µæœ‰åºçš„ã€‚","like_count":70,"discussions":[{"author":{"id":1264162,"avatar":"https://static001.geekbang.org/account/avatar/00/13/4a/22/2681d602.jpg","nickname":"æ—æ™“æ–Œ","note":"","ucode":"CDE42D44F26240","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":438468,"discussion_content":"ğŸ‘ğŸ¿\næ˜¥èŠ‚å¿«ä¹","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1549427643,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1043325,"avatar":"http://thirdwx.qlogo.cn/mmopen/vi_32/c9xpiakQ3OC1AlfCeW03lLnnb7mj5v35Hib8YDs66zpnVib2n2qFichFmFp2Ec4QDPR0dKh38MkBBLyD3bE4NiaanZQ/132","nickname":"é¾™æ™“","note":"","ucode":"FAF34F1C65D103","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":360634,"discussion_content":"ä¸»é”®ä¸æ˜¯mï¼Œå› ä¸ºè¿™æ—¶å€™çš„mè¿˜æ²¡ç»Ÿè®¡ï¼Œæ„Ÿè§‰åƒå †è¡¨ï¼Œä½†innodbåˆä¸æ”¯æŒå †è¡¨ï¼Œæˆ‘å·²ç»æ‡µäº†","likes_number":1,"is_delete":false,"is_hidden":false,"ctime":1616494432,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":1,"child_discussions":[{"author":{"id":2904077,"avatar":"","nickname":"Geek_0d6c6a","note":"","ucode":"882B752A25193A","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":1043325,"avatar":"http://thirdwx.qlogo.cn/mmopen/vi_32/c9xpiakQ3OC1AlfCeW03lLnnb7mj5v35Hib8YDs66zpnVib2n2qFichFmFp2Ec4QDPR0dKh38MkBBLyD3bE4NiaanZQ/132","nickname":"é¾™æ™“","note":"","ucode":"FAF34F1C65D103","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":552242,"discussion_content":"mç¡®å®ä¸æ˜¯ä¸»é”®ï¼Œä½†mä¸éœ€è¦ç»Ÿè®¡ï¼Œè¿™é‡Œåº”è¯¥æ˜¯ä¸ªä¸ºmå»ºç«‹çš„äºŒçº§ç´¢å¼•ã€‚","likes_number":1,"is_delete":false,"is_hidden":false,"ctime":1645367522,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":360634,"ip_address":""},"score":552242,"extra":""}]}]},{"had_liked":false,"id":71348,"user_name":"å¤©ç‹","can_delete":false,"product_type":"c1","uid":1239337,"ip_address":"","ucode":"C074B2F9A5F007","user_header":"https://static001.geekbang.org/account/avatar/00/12/e9/29/629d9bb0.jpg","comment_is_top":false,"comment_ctime":1551324731,"is_pvip":false,"replies":[{"id":"25559","content":"ğŸ‘å¾ˆå¥½çš„æ€»ç»“","user_name":"ä½œè€…å›å¤","comment_id":71348,"uid":"1264162","ip_address":"","utype":1,"ctime":1551354070,"user_name_real":"æ—æ™“æ–Œ"}],"discussion_count":1,"race_medal":0,"score":"190529885755","product_id":100020801,"comment_content":"å†…éƒ¨ä¸´æ—¶è¡¨ï¼Œå’Œsort buffer,join bufferä¸€æ ·ï¼Œéƒ½ç”¨æ¥å­˜æ”¾è¯­å¥æ‰§è¡Œè¿‡ç¨‹ä¸­çš„ä¸­é—´æ•°æ®ï¼Œè¾…åŠ©è¯­å¥çš„æ‰§è¡Œã€‚<br>ä½¿ç”¨ç”¨æ³• using temporaryã€‚<br><br>ä½¿ç”¨åœºæ™¯ï¼š1 æ•°æ®ä¸€è¾¹æŸ¥è¯¢ï¼Œä¸€è¾¹ç›´æ¥å¾—åˆ°ç»“æœï¼Œä¸éœ€è¦é¢å¤–å†…å­˜ã€‚æ¯”å¦‚ï¼šgroup by éœ€è¦è®¡ç®—ã€‚<br><br>          2 join_buffer æ˜¯æ— åºæ•°ç»„ï¼ˆå•å­—æ®µï¼Œå¯ä»¥é‡å¤ï¼‰ï¼Œsort_buffer æœ‰åºæ•°ç»„ï¼Œå†…éƒ¨ä¸´æ—¶è¡¨æ˜¯äºŒç»´ç»“æ„<br><br>\t  3 ç”¨åˆ°äºŒç»´è¡¨çš„ç‰¹æ€§éœ€è¦ç”¨åˆ°å†…éƒ¨ä¸´æ—¶è¡¨ï¼Œæ¯”å¦‚ distinct ï¼Œgroup by <br><br>ä¼˜åŒ–ï¼š1 group by å­—æ®µåŠ ç´¢å¼•<br><br>      2 æ‰©å¤§ä¸´æ—¶è¡¨å†…å­˜å¤§å°<br><br>      3 å¦‚æœæ•°æ®é‡æ¯”è¾ƒå¤§ï¼Œç›´æ¥ä½¿ç”¨ç£ç›˜ä¸´æ—¶è¡¨<br><br>      4 å¦‚æœåˆ†ç»„ä¹‹åï¼Œä¸éœ€è¦æ’åºï¼Œæ‰‹å·¥ order by null<br><br><br><br>group by çš„é¡ºåº<br><br>1 åˆ›å»ºä¸€ä¸ªå†…éƒ¨ä¸´æ—¶è¡¨ï¼Œåˆå§‹åŒ–å­—æ®µ a(åˆ†ç»„å­—æ®µ) b(æ•°é‡)<br><br>2 æ‰«æè¡¨ï¼Œä¸€ä¸ªä¸ªçš„åˆ¤æ–­ï¼Œaå­—æ®µå€¼åœ¨ä¸´æ—¶è¡¨ä¸å­˜åœ¨ï¼Œåˆ™æ’å…¥(2,1)ï¼Œå¦‚æœå­˜åœ¨ï¼Œæ¯”å¦‚ï¼ˆ2,1ï¼‰ï¼Œåˆ™åŠ 1ï¼Œæˆä¸ºï¼ˆ2,2ï¼‰<br><br>3 åˆ†ç»„ä¹‹åï¼Œé»˜è®¤ä¼šè¿›è¡Œæ’åºï¼Œå¦‚æœä¸éœ€è¦é¡ºåºï¼Œç”¨ order by nullã€‚","like_count":45,"discussions":[{"author":{"id":1264162,"avatar":"https://static001.geekbang.org/account/avatar/00/13/4a/22/2681d602.jpg","nickname":"æ—æ™“æ–Œ","note":"","ucode":"CDE42D44F26240","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":441117,"discussion_content":"ğŸ‘å¾ˆå¥½çš„æ€»ç»“","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1551354070,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":71561,"user_name":"Sinyo","can_delete":false,"product_type":"c1","uid":1307297,"ip_address":"","ucode":"57B243E7AB86A5","user_header":"http://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTJAibnPX9jW8kqLcIfibjic8GbkQkEUYyFKJkc39hZhibVlNrqwTjdLozkqibI2IwACd5YzofYickNxFnZg/132","comment_is_top":false,"comment_ctime":1551369597,"is_pvip":false,"replies":[{"id":"25736","content":"æ˜¯çš„ï¼Œéå¸¸å¥½çš„éªŒè¯å’Œæ€è€ƒğŸ‘<br><br>sort_bufferã€join_bufferã€å†…å­˜ä¸´æ—¶è¡¨å’Œç£ç›˜ä¸´æ—¶è¡¨ éƒ½æ˜¯serverå±‚çš„ï¼Œå¼•æ“é—´å…±ç”¨","user_name":"ä½œè€…å›å¤","comment_id":71561,"uid":"1264162","ip_address":"","utype":1,"ctime":1551404286,"user_name_real":"æ—æ™“æ–Œ"}],"discussion_count":3,"race_medal":0,"score":"164760126845","product_id":100020801,"comment_content":"è€å¸ˆå¥½ï¼Œ<br>æˆ‘ç”¨infobrightåˆ—å¼å­˜å‚¨å¼•æ“explainå‡ºæ¥ä¸€ä¸ªgroup byè¯­å¥ï¼Œ<br>å‘ç°ä¹Ÿä¼šç”¨åˆ°å†…å­˜ä¸´æ—¶è¡¨å’Œæ–‡ä»¶æ’åºã€ç„¶åä½¿ç”¨SQL_BIG_RESULTä¹Ÿæœ‰åŒæ ·ä¼˜åŒ–æ•ˆæœï¼›<br>è¿™æ˜¯ä¸æ˜¯è¯´æ˜sort_bufferã€join_bufferã€å†…å­˜ä¸´æ—¶è¡¨å’Œç£ç›˜ä¸´æ—¶è¡¨ä¸æ•°æ®åº“å¼•æ“ç±»å‹å…¶å®æ˜¯ç‹¬ç«‹å¼€çš„å‘¢ï¼Ÿ","like_count":39,"discussions":[{"author":{"id":1264162,"avatar":"https://static001.geekbang.org/account/avatar/00/13/4a/22/2681d602.jpg","nickname":"æ—æ™“æ–Œ","note":"","ucode":"CDE42D44F26240","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":441204,"discussion_content":"æ˜¯çš„ï¼Œéå¸¸å¥½çš„éªŒè¯å’Œæ€è€ƒğŸ‘\n\nsort_bufferã€join_bufferã€å†…å­˜ä¸´æ—¶è¡¨å’Œç£ç›˜ä¸´æ—¶è¡¨ éƒ½æ˜¯serverå±‚çš„ï¼Œå¼•æ“é—´å…±ç”¨","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1551404286,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1788647,"avatar":"https://static001.geekbang.org/account/avatar/00/1b/4a/e7/6c16af5d.jpg","nickname":"æ±‰æ±Ÿ","note":"","ucode":"01622D984B8F9B","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":363583,"discussion_content":"å†…å­˜ä¸´æ—¶è¡¨å’Œç£ç›˜ä¸´æ—¶è¡¨ éƒ½æ˜¯serverå±‚ ï¼Œé‚£ç¬¬17ç¯‡çš„æ‰«æè¡Œæ•°ä¸º20003 æ€ä¹ˆå¾—æ¥çš„ï¼Ÿéš¾é“è¯´æ‰«æserverå±‚çš„è¡¨ä¹Ÿè¦åŠ 1ï¼Ÿ\n","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1617239867,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":1,"child_discussions":[{"author":{"id":1986739,"avatar":"https://static001.geekbang.org/account/avatar/00/1e/50/b3/9269cd59.jpg","nickname":"LWD","note":"","ucode":"DDA444DB113C01","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":1788647,"avatar":"https://static001.geekbang.org/account/avatar/00/1b/4a/e7/6c16af5d.jpg","nickname":"æ±‰æ±Ÿ","note":"","ucode":"01622D984B8F9B","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":588348,"discussion_content":"è¡¨æ˜¯åŸºäºæŸä¸ªå¼•æ“åˆ›å»ºçš„ï¼Œç”±serveræŒ‡å®š","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1663680026,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":363583,"ip_address":"å¹¿ä¸œ"},"score":588348,"extra":""}]}]},{"had_liked":false,"id":69401,"user_name":"IceGeek17","can_delete":false,"product_type":"c1","uid":1103101,"ip_address":"","ucode":"1B42D7260449B4","user_header":"https://static001.geekbang.org/account/avatar/00/10/d4/fd/43802282.jpg","comment_is_top":false,"comment_ctime":1550735671,"is_pvip":false,"replies":[{"id":"24988","content":"1. æœ€åçš„ç»“æœæ˜¯â€œç›´æ¥ä½¿ç”¨æ’åºâ€<br>2. å°±æ˜¯è®¤ä¸ºç”¨sort_bufferç›´æ¥æ’åºæ€§èƒ½æ›´å¥½ï¼Œæ‰€ä»¥å°±æ²¡æœ‰ä½¿ç”¨å†…å­˜ä¸´æ—¶è¡¨æˆ–ç£ç›˜ä¸´æ—¶è¡¨<br>3. æ²¡æœ‰ç´¢å¼•çš„å†…å­˜è¡¨å¯ä»¥è®¤ä¸ºå°±æ˜¯æ•°ç»„ï¼› ä¸»é”®ä¸æ˜¯ï¼Œå†…å­˜è¡¨çš„è¡¨ç»“æ„ï¼Œå¯ä»¥çœ‹ä¸€ä¸‹38ç¯‡","user_name":"ä½œè€…å›å¤","comment_id":69401,"uid":"1264162","ip_address":"","utype":1,"ctime":1550996696,"user_name_real":"æ—æ™“æ–Œ"}],"discussion_count":2,"race_medal":0,"score":"108924918071","product_id":100020801,"comment_content":"æ–‡ä¸­è¯´ï¼ŒSQL_BIG_RESULTè¿™ä¸ªhintï¼Œç”¨æ¥å‘Šè¯‰ä¼˜åŒ–å™¨ç›´æ¥ç”¨ç£ç›˜ä¸´æ—¶è¡¨ï¼Œ<br>å¯¹äºæ–‡ä¸­çš„ä¾‹å­ select SQL_BIG_RESULT id%100 as m, count(*) as c from t1 group by m;<br>åˆ™æ²¡æœ‰ä½¿ç”¨ä¸´æ—¶è¡¨ï¼Œç›´æ¥ç”¨äº†æ’åºç®—æ³•ï¼Œè¿™é‡Œæœ‰ç‚¹ä¸å¤ªæ˜ç™½ï¼ŒSQL_BIG_RESULTè¿™ä¸ªhintåˆ°åº•ç”¨æ¥æç¤ºçš„æ˜¯ä»€ä¹ˆï¼ˆæ˜¯ç”¨ç£ç›˜ä¸´æ—¶è¡¨ï¼Œè¿˜æ˜¯å°±æ˜¯ç›´æ¥ä½¿ç”¨æ’åºï¼Œä¸ç”¨ä¸´æ—¶è¡¨ï¼‰ï¼Ÿ<br><br>æ–‡ä¸­ â€œMySQLä¼˜åŒ–å™¨ä¸€çœ‹ï¼Œç£ç›˜ä¸´æ—¶è¡¨B+æ•°å­˜å‚¨ï¼Œå­˜å‚¨æ•ˆç‡ä¸å¦‚æ•°æ®æ¥çš„é«˜ã€‚é‚£ä»ç£ç›˜ç©ºé—´è€ƒè™‘ï¼Œè¿˜æ˜¯ç›´æ¥ç”¨æ•°ç»„æ¥å­˜â€ï¼Œè¿™æ®µæ€ä¹ˆç†è§£ï¼Ÿ<br>æ˜¯æŒ‡MySQLä¼˜åŒ–å™¨ï¼Œç›´æ¥å¿½ç•¥B+æ•°çš„ç£ç›˜ä¸´æ—¶è¡¨ï¼ˆè¿™é‡Œå¿½ç•¥çš„ä¾æ®æ˜¯ä»€ä¹ˆï¼Ÿï¼‰ï¼Œå¹¶ä¸”ä»æ–‡ä¸­åç»­çš„åˆ†ææ¥çœ‹ï¼Œä¹Ÿæ²¡æœ‰ç”¨å†…å­˜ä¸´æ—¶è¡¨ï¼Œè€Œæ˜¯ç›´æ¥sort bufferæ’åºï¼Œè€å¸ˆå†è¯¦ç»†è§£é‡Šä¸‹ï¼Ÿ<br><br>å¯¹äºInnoDBçš„ç£ç›˜ä¸´æ—¶è¡¨ï¼Œç´¢å¼•ç»“æ„æ˜¯B+æ•°ï¼›é‚£å¯¹äºå†…å­˜ä¸´æ—¶è¡¨ï¼Œæ˜¯ä¸æ˜¯å°±æ˜¯æ•°ç»„ç»“æ„ï¼Ÿæ•°ç»„ä¸´æ—¶è¡¨çš„ä¸»é”®å°±æ˜¯æ¯ä¸ªæ•°ç»„å…ƒç´ ï¼Ÿ<br><br>","like_count":26,"discussions":[{"author":{"id":1264162,"avatar":"https://static001.geekbang.org/account/avatar/00/13/4a/22/2681d602.jpg","nickname":"æ—æ™“æ–Œ","note":"","ucode":"CDE42D44F26240","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":440101,"discussion_content":"1. æœ€åçš„ç»“æœæ˜¯â€œç›´æ¥ä½¿ç”¨æ’åºâ€\n2. å°±æ˜¯è®¤ä¸ºç”¨sort_bufferç›´æ¥æ’åºæ€§èƒ½æ›´å¥½ï¼Œæ‰€ä»¥å°±æ²¡æœ‰ä½¿ç”¨å†…å­˜ä¸´æ—¶è¡¨æˆ–ç£ç›˜ä¸´æ—¶è¡¨\n3. æ²¡æœ‰ç´¢å¼•çš„å†…å­˜è¡¨å¯ä»¥è®¤ä¸ºå°±æ˜¯æ•°ç»„ï¼› ä¸»é”®ä¸æ˜¯ï¼Œå†…å­˜è¡¨çš„è¡¨ç»“æ„ï¼Œå¯ä»¥çœ‹ä¸€ä¸‹38ç¯‡","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1550996696,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":2811222,"avatar":"","nickname":"Geek4748","note":"","ucode":"D4F1A94D428CA5","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":543678,"discussion_content":"å¼ºçƒˆå»ºè®®è¿™ä¸ªåœ°æ–¹åœ¨æ–‡ç« ä¸­è§£é‡Šä¸€ä¸‹ï½","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1641266651,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":65621,"user_name":"Li Shunduo","can_delete":false,"product_type":"c1","uid":1222882,"ip_address":"","ucode":"6C5AB4129E9780","user_header":"https://static001.geekbang.org/account/avatar/00/12/a8/e2/f8e51df2.jpg","comment_is_top":false,"comment_ctime":1549513394,"is_pvip":false,"replies":[{"id":"23230","content":"å› ä¸ºç´¢å¼•cçš„ä¿¡æ¯ä¹Ÿè¶³å¤Ÿï¼Œè€Œä¸”æ¯”ä¸»é”®ç´¢å¼•å°ï¼Œä½¿ç”¨ç´¢å¼•cæ›´ä¼šå¥½ã€‚<br><br>â€œå¦‚æœå­—æ®µaä¸Šæœ‰ç©ºå€¼ï¼Œä½¿ç”¨ç´¢å¼•aå²‚ä¸æ˜¯å°±ä¸èƒ½å–åˆ°æ‰€æœ‰çš„idå€¼äº†ï¼Ÿâ€ï¼Œä¸ä¼šçš„","user_name":"ä½œè€…å›å¤","comment_id":65621,"uid":"1264162","ip_address":"","utype":1,"ctime":1549532056,"user_name_real":"æ—æ™“æ–Œ"}],"discussion_count":1,"race_medal":0,"score":"57384088242","product_id":100020801,"comment_content":"è¯·é—®Group Byéƒ¨åˆ†çš„ç¬¬ä¸€ä¸ªè¯­å¥ explain select id%10 as m, count(*) as c from t1 group by mï¼›ä¸ºä»€ä¹ˆé€‰æ‹©çš„æ˜¯ç´¢å¼•aï¼Œè€Œä¸æ˜¯primary keyï¼Ÿå¦‚æœå­—æ®µaä¸Šæœ‰ç©ºå€¼ï¼Œä½¿ç”¨ç´¢å¼•aå²‚ä¸æ˜¯å°±ä¸èƒ½å–åˆ°æ‰€æœ‰çš„idå€¼äº†ï¼Ÿ","like_count":13,"discussions":[{"author":{"id":1264162,"avatar":"https://static001.geekbang.org/account/avatar/00/13/4a/22/2681d602.jpg","nickname":"æ—æ™“æ–Œ","note":"","ucode":"CDE42D44F26240","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":438524,"discussion_content":"å› ä¸ºç´¢å¼•cçš„ä¿¡æ¯ä¹Ÿè¶³å¤Ÿï¼Œè€Œä¸”æ¯”ä¸»é”®ç´¢å¼•å°ï¼Œä½¿ç”¨ç´¢å¼•cæ›´ä¼šå¥½ã€‚\n\nâ€œå¦‚æœå­—æ®µaä¸Šæœ‰ç©ºå€¼ï¼Œä½¿ç”¨ç´¢å¼•aå²‚ä¸æ˜¯å°±ä¸èƒ½å–åˆ°æ‰€æœ‰çš„idå€¼äº†ï¼Ÿâ€ï¼Œä¸ä¼šçš„","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1549532056,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":88045,"user_name":"Geek_41d472","can_delete":false,"product_type":"c1","uid":1247965,"ip_address":"","ucode":"DEC2B6329460CF","user_header":"https://static001.geekbang.org/account/avatar/00/13/0a/dd/88fa7b52.jpg","comment_is_top":false,"comment_ctime":1555824305,"is_pvip":false,"replies":[{"id":"32458","content":"åªè¦æ˜¯æœ‰Using filesortå°±è¡¨ç¤ºæœ‰æ’åºï¼›<br>Using indexæ˜¯è¡¨ç¤ºä½¿ç”¨äº†è¦†ç›–ç´¢å¼•ï¼›<br><br>ä¸‰ä¸ªéƒ½å‡ºç°å°±æ˜¯ä½¿ç”¨äº†è¦†ç›–ç´¢å¼•ï¼Œä½†æ˜¯è¦†ç›–ç´¢å¼•çš„é¡ºåºæ‰«æä¸èƒ½æ»¡è¶³éœ€æ±‚ï¼Œåªèƒ½æ’åºï¼Œè€Œæ’åºè¿‡ç¨‹ç”¨åˆ°äº†ä¸´æ—¶è¡¨","user_name":"ä½œè€…å›å¤","comment_id":88045,"uid":"1264162","ip_address":"","utype":1,"ctime":1556597431,"user_name_real":"æ—æ™“æ–Œ"}],"discussion_count":1,"race_medal":0,"score":"53095431857","product_id":100020801,"comment_content":"è€å¸ˆæ‚¨å¥½,è¯¾è¯¾åå°ç»“ <br>2.å°½é‡è®© group by è¿‡ç¨‹ç”¨ä¸Šè¡¨çš„ç´¢å¼•ï¼Œç¡®è®¤æ–¹æ³•æ˜¯ explain ç»“æœé‡Œæ²¡æœ‰ Using temporary å’Œ Using filesortï¼›<br>è¿™é‡Œæˆ‘æœ‰ä¸ªç–‘é—®,æ–‡ç« çš„ä¾‹å­ä¸­explain ç»“æœé‡Œ,æ—¢å‡ºç°äº†using index ,åˆå‡ºç°äº†Using temporary å’Œ Using filesort,å¥½åƒä¹Ÿæ˜¯ä½¿ç”¨äº†æ‰€ä»¥å•Š,å¦‚æœç”¨ä½ è¿™ä¸ªæ–¹æ³•åˆ¤æ–­,é‚£åˆ°åº•æœ‰æ²¡æœ‰ä½¿ç”¨ç´¢å¼•å‘¢?","like_count":13,"discussions":[{"author":{"id":1264162,"avatar":"https://static001.geekbang.org/account/avatar/00/13/4a/22/2681d602.jpg","nickname":"æ—æ™“æ–Œ","note":"","ucode":"CDE42D44F26240","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":447696,"discussion_content":"åªè¦æ˜¯æœ‰Using filesortå°±è¡¨ç¤ºæœ‰æ’åºï¼›\nUsing indexæ˜¯è¡¨ç¤ºä½¿ç”¨äº†è¦†ç›–ç´¢å¼•ï¼›\n\nä¸‰ä¸ªéƒ½å‡ºç°å°±æ˜¯ä½¿ç”¨äº†è¦†ç›–ç´¢å¼•ï¼Œä½†æ˜¯è¦†ç›–ç´¢å¼•çš„é¡ºåºæ‰«æä¸èƒ½æ»¡è¶³éœ€æ±‚ï¼Œåªèƒ½æ’åºï¼Œè€Œæ’åºè¿‡ç¨‹ç”¨åˆ°äº†ä¸´æ—¶è¡¨","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1556597431,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":65899,"user_name":"Long","can_delete":false,"product_type":"c1","uid":1318970,"ip_address":"","ucode":"2417242560360A","user_header":"https://static001.geekbang.org/account/avatar/00/14/20/3a/90db6a24.jpg","comment_is_top":false,"comment_ctime":1549758270,"is_pvip":false,"replies":[{"id":"25700","content":"1. æ˜¯çš„ï¼Œæˆ‘é»˜è®¤æ˜¯ç”¨5.7åšçš„éªŒè¯ï¼Œè¿™é‡Œ5.7åšäº†ä¼˜åŒ–ã€‚<br>2. å…¶å®ä½ å·²ç»æ‰¾åˆ°åŸå› äº†ï¼Œå°±æ˜¯å› ä¸º5.6çš„é»˜è®¤ä¸´æ—¶è¡¨æ˜¯myisamè¡¨ï¼Œè€Œmyisamè¡¨æ˜¯å †è¡¨ï¼Œè¿™é‡Œçš„å †è¡¨ï¼Œè·Ÿ38ç¯‡ä»‹ç»çš„memoryå¼•æ“æ˜¯ç±»ä¼¼çš„ï¼Œä½ çœ‹äº†é‚£ç¯‡åº”è¯¥å°±èƒ½çŸ¥é“ä¸ºä»€ä¹ˆå †è¡¨æ˜¯æœ€åæ˜¾ç¤º0é‚£è¡Œäº†<br>3. å¥½é—®é¢˜ï¼Œä¸åŒidä»å¤§åˆ°å°ï¼Œç›¸åŒidä»ä¸Šåˆ°ä¸‹<br>4. å¤šè°¢ä½ çš„é¼“åŠ±ï¼Œè¿˜æ²¡å®šï¼Œå…ˆä¼‘æ¯ä¸‹^_^<br><br>ä¸å¥½æ„æ€ï¼Œä½ å‘çš„ç¬¬ä¸€å¤©å°±çœ‹åˆ°äº†ï¼Œå›å¤æ™šäº†ğŸ˜†","user_name":"ä½œè€…å›å¤","comment_id":65899,"uid":"1264162","ip_address":"","utype":1,"ctime":1551376809,"user_name_real":"æ—æ™“æ–Œ"}],"discussion_count":1,"race_medal":0,"score":"44499431230","product_id":100020801,"comment_content":"è€å¸ˆï¼Œæ–°å¹´å¥½ï¼ :-)<br><br>æœ‰å‡ ä¸ªç‰ˆæœ¬å·®å¼‚çš„é—®é¢˜ï¼š<br>ï¼ˆ1ï¼‰å›¾1ä¸­çš„æ‰§è¡Œè®¡åˆ’åº”è¯¥æ˜¯5.7ç‰ˆæœ¬ä»¥åçš„å§ï¼Œè²Œä¼¼æ²¡æ‰¾åˆ°è¯´åœ¨å“ªä¸ªç¯å¢ƒï¼Œæˆ‘åœ¨5.6å’Œ5.7åˆ†åˆ«æµ‹è¯•äº†ï¼Œid = 2çš„é‚£ä¸ªrowsï¼Œåœ¨5.6ç‰ˆæœ¬ï¼ˆ5.6.26ï¼‰æ˜¯1000ï¼Œåœ¨5.7ç‰ˆæœ¬æ˜¯2è¡Œã€‚åº”è¯¥æ˜¯5.7åšçš„ä¼˜åŒ–å§ï¼Ÿ<br><br>ï¼ˆ2ï¼‰å›¾ 9 group + order by null çš„ç»“æœï¼ˆæ­¤ç›˜ä¸´æ—¶è¡¨ï¼‰ï¼Œè¿™é‡Œé¢mysql5.6é‡Œé¢æ‰§è¡Œçš„ç»“æœæ˜¯ï¼ˆ1ï¼Œ10ï¼‰ï¼Œï¼ˆ2ï¼Œ10ï¼‰...(10ï¼Œ10)ï¼Œæ‰§è¡Œè®¡åˆ’éƒ½æ˜¯åªæœ‰ä¸€æ ·ï¼Œæ²¡æ‰¾åˆ°å·®å¼‚ã€‚<br>è·Ÿè¸ªä¸‹äº†ä¸‹optimizer traceï¼Œå‘ç°é—®é¢˜åº”è¯¥æ˜¯åœ¨ä¸´æ—¶è¡¨ç©ºé—´æ»¡çš„çš„æ—¶å€™ï¼Œmysql5.7ç”¨çš„æ˜¯ï¼šconverting_tmp_table_to_ondisk  &quot;location&quot;: &quot;disk (InnoDB)&quot;,ï¼Œè€Œmysql 5.6ç”¨çš„æ˜¯converting_tmp_table_to_myisam &quot;location&quot;: &quot;disk (MyISAM)&quot;çš„åŸå› å¯¼è‡´çš„ã€‚<br>æŸ¥äº†ä¸‹å‚æ•°ï¼š<br>default_tmp_storage_engineã€‚ï¼ˆ5.6ï¼Œ5.7å½“å‰å€¼éƒ½æ˜¯innodbï¼‰<br>internal_tmp_disk_storage_engineï¼ˆåªæœ‰5.7æœ‰è¿™ä¸ªå‚æ•°ï¼Œå½“å‰å€¼æ˜¯innodbï¼‰ï¼Œ5.6åº”è¯¥æ˜¯é»˜è®¤ç£ç›˜ä¸´æ—¶è¡¨å°±æ˜¯MyISAMå¼•æ“çš„äº†ï¼Œç”±äºæœ¬åœ°æµ‹è¯•ç¯å¢ƒé‚£ä¸ªä¸´æ—¶è¡¨çš„ç›®å½•ä¸‹æ‰¾ä¸åˆ°ä¸´æ—¶æ–‡ä»¶ï¼Œä¹Ÿæ²¡æ³•ç»§ç»­åˆ†æäº†ã€‚ã€‚ã€‚<br><br>è‡³äºä¸ºä»€ä¹ˆMySQL 5.6ä¸­ç»“æœå±•ç¤ºmå­—æ®µä¸æ˜¯0-9è€Œæ˜¯1-10ï¼Œè¿˜å¾—è¯·è€å¸ˆå¸®å¿™è§£ç­”ä¸‹äº†ã€‚<br><br><br>è¿˜æœ‰å‡ ä¸ªå°é—®é¢˜ï¼Œä¸ºäº†æ–¹ä¾¿è§£ç­”ï¼Œåºå·ç»Ÿä¸€äº†ï¼š<br>ï¼ˆ3ï¼‰åœ¨é˜…è¯»mysqlæ‰§è¡Œè®¡åˆ’çš„æ—¶å€™ï¼Œçœ‹äº†ç½‘ä¸Šæœ‰å¾ˆå¤šè¯´æ³•ï¼Œä¹Ÿå‚è€ƒäº†mysqlå®˜ç½‘å¯¹idï¼ˆselect_idï¼‰çš„è§£é‡Šï¼š<br>id (JSON name: select_id)<br>The SELECT identifier. This is the sequential number of the SELECT within the query.ï¼ˆæ„Ÿè§‰è¿™ä¸ªè¯»èµ·æ¥ä¹Ÿæœ‰ç‚¹æ­§ä¹‰ï¼Œè¿™ä¸ªsequentialå­—é¢è§£é‡Šæ„Ÿè§‰åªæœ‰é¡ºåºçš„å·ç ï¼Œå¹¶å’©æœ‰è¯´æ‰§è¡Œé¡ºåºï¼‰<br>æ¯”å¦‚å›¾1ï¼Œæ–‡ä¸­è§£é‡Šå°±æ˜¯ä»IDå°çš„å¾€å¤§çš„æ‰§è¡Œçš„ï¼Œç½‘ä¸Šæœ‰å¾ˆå¤šå…¶ä»–è¯´æ³•ï¼Œæœ‰çš„æ˜¯è¯´IDä»å¤§åˆ°å°æ‰§è¡Œï¼Œé‡åˆ°IDä¸€æ ·çš„ï¼Œå°±ä»ä¸Šå¾€ä¸‹æ‰§è¡Œã€‚æœ‰çš„è¯´æ˜¯ä»å°å¾€å¤§é¡ºåºæ‰§è¡Œã€‚ä¸çŸ¥é“è€å¸ˆæ˜¯å¦å¯ä»¥å®˜æ–¹è®²è§£ä¸‹ã€‚<br><br>ï¼ˆ4ï¼‰æˆ‘å‘ç°æƒ³ææ‡‚ä¸€ä¸ªåŸç†ï¼Œå¹¶ä¸”è®²æ¸…æ¥šè®©åˆ«äººæ˜ç™½ï¼ŒçœŸçš„æ˜¯å¾ˆæœ‰éš¾åº¦ï¼Œéå¸¸æ„Ÿè°¢è€å¸ˆçš„åˆ†äº«ã€‚è¿™æ¬¡ä¸“æ ç»“æŸï¼Œè¿˜ä¼šæ¨å‡ºçš„æ–°çš„ä¸“æ å—ï¼Ÿ éå¸¸æœŸå¾…ã€‚","like_count":10,"discussions":[{"author":{"id":1264162,"avatar":"https://static001.geekbang.org/account/avatar/00/13/4a/22/2681d602.jpg","nickname":"æ—æ™“æ–Œ","note":"","ucode":"CDE42D44F26240","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":438633,"discussion_content":"1. æ˜¯çš„ï¼Œæˆ‘é»˜è®¤æ˜¯ç”¨5.7åšçš„éªŒè¯ï¼Œè¿™é‡Œ5.7åšäº†ä¼˜åŒ–ã€‚\n2. å…¶å®ä½ å·²ç»æ‰¾åˆ°åŸå› äº†ï¼Œå°±æ˜¯å› ä¸º5.6çš„é»˜è®¤ä¸´æ—¶è¡¨æ˜¯myisamè¡¨ï¼Œè€Œmyisamè¡¨æ˜¯å †è¡¨ï¼Œè¿™é‡Œçš„å †è¡¨ï¼Œè·Ÿ38ç¯‡ä»‹ç»çš„memoryå¼•æ“æ˜¯ç±»ä¼¼çš„ï¼Œä½ çœ‹äº†é‚£ç¯‡åº”è¯¥å°±èƒ½çŸ¥é“ä¸ºä»€ä¹ˆå †è¡¨æ˜¯æœ€åæ˜¾ç¤º0é‚£è¡Œäº†\n3. å¥½é—®é¢˜ï¼Œä¸åŒidä»å¤§åˆ°å°ï¼Œç›¸åŒidä»ä¸Šåˆ°ä¸‹\n4. å¤šè°¢ä½ çš„é¼“åŠ±ï¼Œè¿˜æ²¡å®šï¼Œå…ˆä¼‘æ¯ä¸‹^_^\n\nä¸å¥½æ„æ€ï¼Œä½ å‘çš„ç¬¬ä¸€å¤©å°±çœ‹åˆ°äº†ï¼Œå›å¤æ™šäº†ğŸ˜†","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1551376809,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":65991,"user_name":"å…”æ–¯åŸº","can_delete":false,"product_type":"c1","uid":1061320,"ip_address":"","ucode":"146A5FE2D8B301","user_header":"https://static001.geekbang.org/account/avatar/00/10/31/c8/a64e4aef.jpg","comment_is_top":false,"comment_ctime":1549842952,"is_pvip":false,"replies":[{"id":"23404","content":"è¿™ä¸‰ç§å†™æ³•è¯­ä¹‰ä¸Šä¸ä¸€æ ·ã€‚ã€‚<br><br>å¦‚æœå¯¹è¿”å›ç»“æœæ²¡æœ‰é¡ºåºè¦æ±‚ï¼Œé‚£å†™ä¸Šorder by nullè‚¯å®šæ˜¯å¥½çš„ã€‚<br><br>â€œorder by nullâ€å’Œâ€œä¸åŠ order byâ€ä¸ç­‰ä»·ï¼Œå’±ä»¬æ–‡ä¸­æœ‰è¯´å“ˆ","user_name":"ä½œè€…å›å¤","comment_id":65991,"uid":"1264162","ip_address":"","utype":1,"ctime":1549873762,"user_name_real":"æ—æ™“æ–Œ"}],"discussion_count":1,"race_medal":0,"score":"35909581320","product_id":100020801,"comment_content":"è€å¸ˆï¼Œå…³äºæ’åºæœ‰å‡ ä¸ªé—®é¢˜ã€‚<br>order by idï¼Œä¸»é”®<br>order by nullï¼Œ<br>ä¸åŠ order by<br>è¿™ä¸‰ç§å†™æ³•å“ªç§æ‰§è¡Œæ•ˆç‡æ›´é«˜ä¸€äº›ï¼Ÿåé¢ä¸¤è€…æ˜¯ä¸æ˜¯ç­‰ä»·çš„ï¼Ÿ","like_count":8,"discussions":[{"author":{"id":1264162,"avatar":"https://static001.geekbang.org/account/avatar/00/13/4a/22/2681d602.jpg","nickname":"æ—æ™“æ–Œ","note":"","ucode":"CDE42D44F26240","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":438669,"discussion_content":"è¿™ä¸‰ç§å†™æ³•è¯­ä¹‰ä¸Šä¸ä¸€æ ·ã€‚ã€‚\n\nå¦‚æœå¯¹è¿”å›ç»“æœæ²¡æœ‰é¡ºåºè¦æ±‚ï¼Œé‚£å†™ä¸Šorder by nullè‚¯å®šæ˜¯å¥½çš„ã€‚\n\nâ€œorder by nullâ€å’Œâ€œä¸åŠ order byâ€ä¸ç­‰ä»·ï¼Œå’±ä»¬æ–‡ä¸­æœ‰è¯´å“ˆ","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1549873762,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":66099,"user_name":"æ¢¦åº·","can_delete":false,"product_type":"c1","uid":1069512,"ip_address":"","ucode":"8935F3C329C58E","user_header":"https://static001.geekbang.org/account/avatar/00/10/51/c8/83852d5a.jpg","comment_is_top":false,"comment_ctime":1549877221,"is_pvip":false,"replies":[{"id":"25701","content":"çœ‹ç´¢å¼•çš„åå­—çŒœæµ‹ï¼Œ idx_aid_day_pv å°±æ˜¯(adid, day,pv)è¿™ä¸‰ä¸ªå­—æ®µçš„è”åˆç´¢å¼•ï¼Ÿ<br><br>è¿™æ ·çš„è¯ï¼Œç¬¬äºŒä¸ªè¯­å¥å°±ä¼šé¡ºåºéå†ç´¢å¼•ï¼Œåªè¦æ‰¾åˆ°10ä¸ªä¸åŒçš„aidå°±å¯ä»¥äº†ï¼Œè¿™ä¸ªç´¢å¼•ä¸ç”¨å…¨éƒ¨éå†ï¼›è¿™æ ·å¯ä»¥å‡å°‘å¾ˆå¤šå†™å…¥ä¸´æ—¶è¡¨çš„æ•°æ®ï¼›<br><br>ä½†æ˜¯ç¬¬ä¸€ä¸ªè¯­å¥æ˜¯dayå¼€å¤´çš„ï¼Œ è¿™æ ·å°±å¿…é¡»å°†æ‰€æœ‰`day`&amp;gt;20190115çš„è®°å½•éƒ½å­˜åˆ°ä¸´æ—¶è¡¨ä¸­ï¼Œè¿™ä¸ªè¦å†™å…¥å†…å­˜è¡¨çš„æ•°æ®è¡Œæ•°è‚¯å®šæ¯”ç¬¬äºŒä¸ªè¯­å¥å¤šçš„<br><br>æ‰€ä»¥æ ¸å¿ƒå°±æ˜¯è¿™ä¸¤ä¸ªè¯­å¥éœ€è¦æ”¾å…¥ä¸´æ—¶è¡¨çš„è¡Œæ•°ä¸åŒã€‚<br><br>","user_name":"ä½œè€…å›å¤","comment_id":66099,"uid":"1264162","ip_address":"","utype":1,"ctime":1551377601,"user_name_real":"æ—æ™“æ–Œ"}],"discussion_count":6,"race_medal":0,"score":"31614648293","product_id":100020801,"comment_content":"å®è·µå‘ç°æ–‡ä¸­æè¿°çš„ group by æ‰§è¡Œè¿‡ç¨‹ä¸­è§£é‡Šä¸é€šã€‚æ¡ˆä¾‹å¦‚ä¸‹<br><br>select `aid`,sum(`pv`) as num from article_rank force index(idx_day_aid_pv)  where `day`&gt;20190115 group by aid order by num desc LIMIT 10;<br><br>å†…å­˜ä¸´æ—¶è¡¨ä¸å¤Ÿï¼Œéœ€è¦å†™å…¥ç£ç›˜<br><br>select `aid`,sum(`pv`) as num from article_rank force index(idx_aid_day_pv)  where `day`&gt;20190115 group by aid order by num desc LIMIT 10;<br><br>å†…å­˜ä¸´æ—¶è¡¨è¶³å¤Ÿã€‚<br><br>é€‰çš„ç´¢å¼•ä¸ä¸€æ ·ï¼Œä½†æ˜¯æœ€åç­›é€‰å‡ºæ¥çš„æ€»è¡Œåº”è¯¥æ˜¯ä¸€æ ·çš„å‘€ï¼Œæ‰€ä»¥ç°åœ¨æ›´åŠ å›°æƒ‘äº†ã€‚","like_count":7,"discussions":[{"author":{"id":1264162,"avatar":"https://static001.geekbang.org/account/avatar/00/13/4a/22/2681d602.jpg","nickname":"æ—æ™“æ–Œ","note":"","ucode":"CDE42D44F26240","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":438702,"discussion_content":"çœ‹ç´¢å¼•çš„åå­—çŒœæµ‹ï¼Œ idx_aid_day_pv å°±æ˜¯(adid, day,pv)è¿™ä¸‰ä¸ªå­—æ®µçš„è”åˆç´¢å¼•ï¼Ÿ\n\nè¿™æ ·çš„è¯ï¼Œç¬¬äºŒä¸ªè¯­å¥å°±ä¼šé¡ºåºéå†ç´¢å¼•ï¼Œåªè¦æ‰¾åˆ°10ä¸ªä¸åŒçš„aidå°±å¯ä»¥äº†ï¼Œè¿™ä¸ªç´¢å¼•ä¸ç”¨å…¨éƒ¨éå†ï¼›è¿™æ ·å¯ä»¥å‡å°‘å¾ˆå¤šå†™å…¥ä¸´æ—¶è¡¨çš„æ•°æ®ï¼›\n\nä½†æ˜¯ç¬¬ä¸€ä¸ªè¯­å¥æ˜¯dayå¼€å¤´çš„ï¼Œ è¿™æ ·å°±å¿…é¡»å°†æ‰€æœ‰`day`&amp;amp;gt;20190115çš„è®°å½•éƒ½å­˜åˆ°ä¸´æ—¶è¡¨ä¸­ï¼Œè¿™ä¸ªè¦å†™å…¥å†…å­˜è¡¨çš„æ•°æ®è¡Œæ•°è‚¯å®šæ¯”ç¬¬äºŒä¸ªè¯­å¥å¤šçš„\n\næ‰€ä»¥æ ¸å¿ƒå°±æ˜¯è¿™ä¸¤ä¸ªè¯­å¥éœ€è¦æ”¾å…¥ä¸´æ—¶è¡¨çš„è¡Œæ•°ä¸åŒã€‚\n\n","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1551377601,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":2086624,"avatar":"https://static001.geekbang.org/account/avatar/00/1f/d6/e0/3ccaaa7b.jpg","nickname":"é¢†å­","note":"","ucode":"64AC4E6AB74E68","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":296088,"discussion_content":"ç”±äºdayæ˜¯èŒƒå›´æ¡ä»¶ï¼Œä¼šä½¿è”åˆç´¢å¼•(idx_day_aid_pv)ä¸­çš„aidå¤±æ•ˆï¼Œé‚£ä¹ˆåˆ†ç»„å°†ä¸èµ°ç´¢å¼•ï¼Œå°±éœ€è¦ç”¨åˆ°ä¸´æ—¶è¡¨ï¼Œå–å‡ºæ‰€æœ‰çš„èšåˆç»“æœå†limit10,è”åˆç´¢å¼•(idx_aid_day_pvï¼‰æ»¡è¶³åˆ†ç»„èµ°ç´¢å¼•ï¼Œæ¡ä»¶dayè¿‡æ»¤åï¼Œå°±å¯ä»¥æŒ‰ç´¢å¼•é¡ºåºå–10ä¸ªä¸åŒçš„aidå€¼ï¼Œè€Œä¸ç”¨æ‰«æå…¨éƒ¨çš„ç»“æœè¡Œ","likes_number":2,"is_delete":false,"is_hidden":false,"ctime":1596449037,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1464006,"avatar":"https://static001.geekbang.org/account/avatar/00/16/56/c6/0b449bc6.jpg","nickname":"æ–æ³¢é‚£å¥‘","note":"","ucode":"85E2EBC01392B1","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":201880,"discussion_content":"ä½ è¿™ä¸ªé—®é¢˜æœ‰ç‚¹æ„æ€ æ„Ÿè§‰å¯ä»¥å¤ä¹ åˆ°å‰é¢è€å¸ˆè®²çš„ç´¢å¼•ç« èŠ‚ å¯¹äºä½ è¿™ä¸ªé—®é¢˜ ä½ çœ‹ä¸€ä¸‹æ˜¯ä¸æ˜¯è¿™ä¹ˆä¸ªæƒ…å†µ å°±æ˜¯ä½ è¿™å¼ è¡¨é‡Œæ•°æ®aidç§ç±»éå¸¸å¤š æ¯”å¦‚ è¡¨é‡Œæœ‰10ä¸‡æ¡æ•°æ® æ¯ä¸€ç§aidå°±2 3ä¸ª è¿™æ ·è¿™ä¸ªè¡¨é‡Œå°±æœ‰4 5ä¸‡ç§aid å¦‚æœæ˜¯é‚£æˆ‘å¤§æ¦‚ç†è§£è€å¸ˆè®²çš„æ„æ€ ç„¶åä½ åœ¨å¼„ä¸€å¼ ç›¸åŒçš„è¡¨(åŒ…æ‹¬ç´¢å¼•) é‡Œé¢æ”¾å‡ ç§aidä½†æ˜¯æ¯ä¸€ç§aidçš„ä¸ªæ•°éå¸¸éå¸¸å¤š ç„¶ååœ¨çœ‹ä¸€ä¸‹è¯­å¥ä¸€ æ˜¯ä¸æ˜¯ä¹Ÿåªç”¨ä¸´æ—¶è¡¨æ²¡æœ‰å†™å…¥ç£ç›˜ å¦‚æœä¸æ˜¯æˆ‘è¯´çš„è¿™ç§æƒ…å†µ é‚£åªèƒ½åç­‰å¤§ç¥äº†","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1583847455,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1361746,"avatar":"https://static001.geekbang.org/account/avatar/00/14/c7/52/c5adf218.jpg","nickname":"å–œæ¬¢åœ°çƒçš„é˜¿åŸ¹åŒå­¦","note":"","ucode":"5F97037585F857","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":9715,"discussion_content":"è€å¸ˆï¼Œä½ çš„å›å¤å¥½åƒæœ‰ç‚¹é—®é¢˜ã€‚\nç¬¬äºŒä¸ªè¯­å¥çš„ç´¢å¼•è¿˜æ˜¯ä¼šå…¨éƒ¨éå†çš„å§ï¼Œå› ä¸ºæœ‰order by num descéœ€è¦æ’åºï¼Œæ‰€ä»¥ä»ç´¢å¼•ä¸­æŸ¥æ‰¾å‡ºæ¥ç¬¦åˆæ¡ä»¶çš„æ•°æ®è¿˜æ˜¯ä¼šå†™åˆ°ä¸´æ—¶è¡¨ä¸­ï¼Œåªæ˜¯åœ¨æ’åºçš„æ—¶å€™ï¼Œä»…ä»…éœ€è¦è·å–10è¡Œæ•°æ®ï¼Œè€Œä¸ç”¨å…¨éƒ¨æ’åº","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1568208083,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":2,"child_discussions":[{"author":{"id":1210699,"avatar":"https://static001.geekbang.org/account/avatar/00/12/79/4b/740f91ca.jpg","nickname":"-W.LI-","note":"","ucode":"3556786538664F","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":1361746,"avatar":"https://static001.geekbang.org/account/avatar/00/14/c7/52/c5adf218.jpg","nickname":"å–œæ¬¢åœ°çƒçš„é˜¿åŸ¹åŒå­¦","note":"","ucode":"5F97037585F857","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":18095,"discussion_content":"ä¸ºå•¥æˆ‘çœ‹åˆ°ä¸¤æ¡è¯­å¥æ˜¯ä¸€ä¸ªæ ·å­çš„ã€‚ã€‚ã€‚ä½ é‚£å•¥æƒ…å†µ?","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1569021938,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":9715,"ip_address":""},"score":18095,"extra":""},{"author":{"id":2101988,"avatar":"https://static001.geekbang.org/account/avatar/00/20/12/e4/57ade29a.jpg","nickname":"dva","note":"","ucode":"EE27DAFCBF198D","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":1210699,"avatar":"https://static001.geekbang.org/account/avatar/00/12/79/4b/740f91ca.jpg","nickname":"-W.LI-","note":"","ucode":"3556786538664F","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":303275,"discussion_content":"ç´¢å¼•ä¸ä¸€æ · force index å¼ºåˆ¶ç”¨çš„ç´¢å¼•","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1599206845,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":18095,"ip_address":""},"score":303275,"extra":""}]}]},{"had_liked":false,"id":208124,"user_name":"å¦ææ³°æ¥","can_delete":false,"product_type":"c1","uid":1439355,"ip_address":"","ucode":"C249173266251A","user_header":"https://static001.geekbang.org/account/avatar/00/15/f6/7b/b6abcbbe.jpg","comment_is_top":false,"comment_ctime":1587281855,"is_pvip":false,"discussion_count":1,"race_medal":0,"score":"23062118335","product_id":100020801,"comment_content":"è¯·æ•™ä¸€ä¸ªé—®é¢˜ï¼šmysqlæ­£å¸¸ä¸€æ¡sqlçš„åŸºæœ¬æ‰§è¡Œé¡ºåºæ˜¯ï¼šfrom &gt; where &gt; group by &gt; select &gt; order by<br>select id%10 as m, count(*) as c from t1 group by m;<br>ä¸ºä»€ä¹ˆè¿™æ¡SQLè¯­å¥æ²¡æœ‰må­—æ®µèƒ½æ­£å¸¸æ‰§è¡Œäº†ï¼Ÿæ˜¯å› ä¸ºselect as è¯­å¥å…ˆäºgroup byæ‰§è¡Œå—ï¼Ÿï¼Ÿ<br>æ„Ÿè§‰æ¯”è¾ƒå¥‡æ€ªä¸æ˜¯å¤ªç†è§£","like_count":5,"discussions":[{"author":{"id":1147895,"avatar":"https://static001.geekbang.org/account/avatar/00/11/83/f7/a24b7242.jpg","nickname":"ç®€å•","note":"","ucode":"19A01CB4B9ED8C","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":374521,"discussion_content":"åŒæ ·æœ‰è¿™æ ·çš„é—®é¢˜ï¼Œè¯·é—®è§£ç­”äº†å—ï¼Ÿ","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1621232418,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":71795,"user_name":"Sinyo","can_delete":false,"product_type":"c1","uid":1307297,"ip_address":"","ucode":"57B243E7AB86A5","user_header":"http://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTJAibnPX9jW8kqLcIfibjic8GbkQkEUYyFKJkc39hZhibVlNrqwTjdLozkqibI2IwACd5YzofYickNxFnZg/132","comment_is_top":false,"comment_ctime":1551434498,"is_pvip":false,"replies":[{"id":"26021","content":"éœ€è¦åˆ›å»ºä¸´æ—¶è¡¨çš„æ—¶å€™ï¼Œä¸å½“å‰è®¿é—®æ•°æ®çš„å¼•æ“æ— å…³ï¼Œéƒ½æ˜¯é»˜è®¤åˆ›å»ºå†…å­˜ä¸´æ—¶è¡¨ï¼Œå†…å­˜ä¸å¤Ÿäº†è½¬ç£ç›˜ä¸´æ—¶è¡¨ï¼ˆé»˜è®¤æ˜¯innodb è¡¨ï¼‰","user_name":"ä½œè€…å›å¤","comment_id":71795,"uid":"1264162","ip_address":"","utype":1,"ctime":1551456711,"user_name_real":"æ—æ™“æ–Œ"}],"discussion_count":1,"race_medal":0,"score":"23026270978","product_id":100020801,"comment_content":"è°¢è°¢è€å¸ˆè§£æƒ‘ï¼Œ<br>å†æ¬¡è¯·æ•™è€å¸ˆï¼Œé‚£å…¶ä»–å¼•æ“æ•°æ®åº“åœ¨serverå±‚å»ºçš„ç£ç›˜ä¸´æ—¶è¡¨æ˜¯ä»€ä¹ˆå¼•æ“å‘¢ï¼Ÿ","like_count":5,"discussions":[{"author":{"id":1264162,"avatar":"https://static001.geekbang.org/account/avatar/00/13/4a/22/2681d602.jpg","nickname":"æ—æ™“æ–Œ","note":"","ucode":"CDE42D44F26240","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":441335,"discussion_content":"éœ€è¦åˆ›å»ºä¸´æ—¶è¡¨çš„æ—¶å€™ï¼Œä¸å½“å‰è®¿é—®æ•°æ®çš„å¼•æ“æ— å…³ï¼Œéƒ½æ˜¯é»˜è®¤åˆ›å»ºå†…å­˜ä¸´æ—¶è¡¨ï¼Œå†…å­˜ä¸å¤Ÿäº†è½¬ç£ç›˜ä¸´æ—¶è¡¨ï¼ˆé»˜è®¤æ˜¯innodb è¡¨ï¼‰","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1551456711,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":81041,"user_name":"è·¯è¿‡","can_delete":false,"product_type":"c1","uid":1316401,"ip_address":"","ucode":"7152C19ED024CC","user_header":"https://static001.geekbang.org/account/avatar/00/14/16/31/ae8adf82.jpg","comment_is_top":false,"comment_ctime":1553783471,"is_pvip":false,"discussion_count":2,"race_medal":0,"score":"10143718063","product_id":100020801,"comment_content":"è¯·æ•™ï¼š<br>æ–‡ç« ä¸­çš„ç¬¬ä¸€ä¸ªæ¡ˆä¾‹è¯­å¥ï¼Œå¦‚æœæŠŠlimit 2å»æ‰ï¼Œå³å¦‚ä¸‹ï¼š<br>(select 1000 as f) union (select id from t1 order by id desc);<br>æŒ‰ç…§æˆ‘çš„ç†è§£ï¼Œåº”è¯¥å¾—åˆ°ä»1000åˆ°1çš„é™åºæ’åˆ—æ•°æ®ã€‚ä½†ç»“æœå‡ºä¹æ„æ–™ï¼š<br>1000<br>1<br>2<br>ã€‚ã€‚ã€‚<br>999<br>è¿™æ˜¯ä¸ºä½•å•Šï¼Ÿ<br>å¦‚æœæŠŠä¸Šé¢çš„è¯­å¥åŠ ä¸Šlimit 1000ï¼Œå³ï¼š<br>(select 1000 as f) union (select id from t1 order by id desc limit 1000);<br>ç»“æœå°±æ˜¯ä»1000åˆ°1çš„é™åºæ’åˆ—ã€‚æä¸æ‡‚ï¼Œè¯·è€å¸ˆè§£æƒ‘ï¼","like_count":2,"discussions":[{"author":{"id":1303322,"avatar":"https://static001.geekbang.org/account/avatar/00/13/e3/1a/061e77b6.jpg","nickname":"äº¢æ˜Ÿä¸œ","note":"","ucode":"5E4063E83B2BB9","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":332727,"discussion_content":"order by null","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1607325413,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":2101988,"avatar":"https://static001.geekbang.org/account/avatar/00/20/12/e4/57ade29a.jpg","nickname":"dva","note":"","ucode":"EE27DAFCBF198D","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":303299,"discussion_content":"æŸ¥è¯¢èµ„æ–™å‘ç°ï¼šåœ¨mysql5.7ä¸­ï¼Œå¦‚æœä¸åŠ limitï¼Œç³»ç»Ÿä¼šæŠŠorder byä¼˜åŒ–æ‰ã€‚\næˆ‘æµ‹è¯•è¿‡åŠ äº†limitå°±å¯ä»¥äº†\nhttps://www.cnblogs.com/zhou-pan/p/10075987.html","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1599209433,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":73726,"user_name":"è¿›é˜¶çš„ç å†œ","can_delete":false,"product_type":"c1","uid":1017821,"ip_address":"","ucode":"D8991282640334","user_header":"https://static001.geekbang.org/account/avatar/00/0f/87/dd/4f53f95d.jpg","comment_is_top":false,"comment_ctime":1551964752,"is_pvip":false,"discussion_count":3,"race_medal":0,"score":"10141899344","product_id":100020801,"comment_content":"select id%10 as m, count(*) as c from t1 group by m;<br>æˆ‘æ‰§è¡Œè¿™æ¡è¯­å¥ ç¬¬ä¸€è¡Œæ˜¯1 æ²¡æœ‰ç»è¿‡æ’åºï¼Œæˆ‘explain è¿™æ¡è¯­å¥ä¹Ÿæ²¡æœ‰æ˜¾ç¤ºsort ä½†æ˜¯æ˜¾ç¤ºç”¨äº†ä¸´æ—¶è¡¨ï¼Œå¯èƒ½æ˜¯ä»€ä¹ˆåŸå› çš„ï¼Œå’Œmysqlç‰ˆæœ¬æœ‰å…³å—ï¼Ÿè¿˜æ˜¯é…ç½®ï¼Ÿ","like_count":2,"discussions":[{"author":{"id":1968721,"avatar":"http://thirdwx.qlogo.cn/mmopen/vi_32/unkzY52hVDjTmZJGNkrBR75tFs4XTGBoYYcOYkIcPvHlQrLibwc94aBfj1uWiawoKeEMwHbkvgThXZarfoP8Dzag/132","nickname":"å¥¹","note":"","ucode":"FAC6851866C9C7","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":411424,"discussion_content":"ç‰ˆæœ¬æ„è¯†å¾ˆé‡è¦","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1635925153,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1475240,"avatar":"http://thirdwx.qlogo.cn/mmopen/vi_32/RCRZYVn8Z77iaSfIia2uhvDricTiaRngFXy79A9kvlKQwmScXNQpKnypy70l2NF0bF3Lxwia4ngQyH7zyMbS2PrXe1A/132","nickname":"å•Šå¹¿","note":"","ucode":"CBA6EF9EFE9BCB","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":5758,"discussion_content":"æˆ‘çš„ä¹Ÿæ˜¯ï¼Œç”¨çš„8.0.13","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1566460740,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":1,"child_discussions":[{"author":{"id":1526355,"avatar":"https://static001.geekbang.org/account/avatar/00/17/4a/53/063f9d17.jpg","nickname":"moonfox","note":"","ucode":"902BFF40EFA9FA","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":1475240,"avatar":"http://thirdwx.qlogo.cn/mmopen/vi_32/RCRZYVn8Z77iaSfIia2uhvDricTiaRngFXy79A9kvlKQwmScXNQpKnypy70l2NF0bF3Lxwia4ngQyH7zyMbS2PrXe1A/132","nickname":"å•Šå¹¿","note":"","ucode":"CBA6EF9EFE9BCB","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":334701,"discussion_content":"8.0ä¸æ’åºäº†","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1607944900,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":5758,"ip_address":""},"score":334701,"extra":""}]}]},{"had_liked":false,"id":67601,"user_name":"é»„æ–‡éŸ¬","can_delete":false,"product_type":"c1","uid":1302800,"ip_address":"","ucode":"60BE7A087E1612","user_header":"https://static001.geekbang.org/account/avatar/00/13/e1/10/6a1fe19a.jpg","comment_is_top":false,"comment_ctime":1550207529,"is_pvip":false,"replies":[{"id":"24003","content":"1. å•Š æ¯”è¾ƒå¥‡æ€ªï¼Œä½ å¯å¦ç»™ä¸€ä¸‹æˆªå›¾ï¼Œï¼ˆæ¯”å¦‚å‘ä¸ªå¾®åšï¼Œè´´å›¾atæˆ‘ï¼‰ï¼Œå¸¦ä¸Šè¡¨ç»“æ„å“ˆ<br>2. å¥½é—®é¢˜ï¼Œå…¶å®è¿™ä¸ªæ˜¯è¦ç»“åˆä¸‹ä¸€ç¯‡æ–‡ç« çš„çŸ¥è¯†ç‚¹ï¼Œå†…å­˜è¡¨çš„ä¸»é”®ä¸æ˜¯ä¿è¯æœ‰åºçš„","user_name":"ä½œè€…å›å¤","comment_id":67601,"uid":"1264162","ip_address":"","utype":1,"ctime":1550298718,"user_name_real":"æ—æ™“æ–Œ"}],"discussion_count":3,"race_medal":0,"score":"10140142121","product_id":100020801,"comment_content":"è€å¸ˆï¼Œæœ‰ä¸¤ä¸ªé—®é¢˜ä¸æ˜¯å¾ˆæ¸…æ¥š:<br>1. å›¾ä¸‰æ˜¾ç¤ºunion allæ²¡æœ‰ä½¿ç”¨ä¸´æ—¶è¡¨ï¼Œä½†æ˜¯æˆ‘æœ¬åœ°explainçœ‹åˆ°union allå’Œunionçš„æ‰§è¡Œè®¡åˆ’æ˜¯ä¸€æ ·çš„ï¼Œä¸çŸ¥é“ä¸ºä»€ä¹ˆï¼Ÿæ˜¯å’Œç‰ˆæœ¬æœ‰å…³ç³»è¿˜æ˜¯å…¶ä»–è®¾ç½®ï¼Ÿæœ¬åœ°ç‰ˆæœ¬5.6<br>2.å›¾å›› ä¸å¤ªç†è§£ä¸ºä»€ä¹ˆä¼šç”¨filesortï¼Œå› ä¸ºæˆ‘çœ‹ä½ åé¢æ‰§è¡Œæµç¨‹æ˜¯è¯´ä¼šåˆ›å»ºä¸€ä¸ªä¸´æ—¶è¡¨ï¼Œä¸»é”®æ˜¯mï¼Œé‚£ä¸ºå•¥ä¸å¯ä»¥ç›´æ¥æ ¹æ®mæ¥æ’åºï¼Œè€Œè¦ç”¨åˆ°filesortå¤–éƒ¨æ’åºï¼Œè¿˜æ˜¯è¿™ä¸ªfilesortæ˜¯æŒ‡çš„ä¸æ˜¯æŒ‰è¡¨ä¸­ç´¢å¼•çš„æ’åºéƒ½ä¼šæ˜¯filesortï¼Ÿï¼Ÿ<br>æ„Ÿè°¢","like_count":2,"discussions":[{"author":{"id":1264162,"avatar":"https://static001.geekbang.org/account/avatar/00/13/4a/22/2681d602.jpg","nickname":"æ—æ™“æ–Œ","note":"","ucode":"CDE42D44F26240","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":439272,"discussion_content":"1. å•Š æ¯”è¾ƒå¥‡æ€ªï¼Œä½ å¯å¦ç»™ä¸€ä¸‹æˆªå›¾ï¼Œï¼ˆæ¯”å¦‚å‘ä¸ªå¾®åšï¼Œè´´å›¾atæˆ‘ï¼‰ï¼Œå¸¦ä¸Šè¡¨ç»“æ„å“ˆ\n2. å¥½é—®é¢˜ï¼Œå…¶å®è¿™ä¸ªæ˜¯è¦ç»“åˆä¸‹ä¸€ç¯‡æ–‡ç« çš„çŸ¥è¯†ç‚¹ï¼Œå†…å­˜è¡¨çš„ä¸»é”®ä¸æ˜¯ä¿è¯æœ‰åºçš„","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1550298718,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":2731036,"avatar":"","nickname":"Geek_dbfa54","note":"","ucode":"4D08C03EE7F516","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":400008,"discussion_content":"mysql5.7åšäº†ä¼˜åŒ–ï¼Œå°†mysqlç‰ˆæœ¬åˆ‡æ¢åˆ°5.7å°±å’Œè€å¸ˆæˆªå›¾æ•ˆæœç›¸åŒäº†","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1633139199,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1241618,"avatar":"https://static001.geekbang.org/account/avatar/00/12/f2/12/50eff143.jpg","nickname":"éª‹","note":"","ucode":"6FC534BA9FCE3C","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":2223,"discussion_content":"é‡åˆ°äº†å’Œé—®é¢˜1åŒæ ·çš„é—®é¢˜","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1563361944,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":65982,"user_name":"Smile","can_delete":false,"product_type":"c1","uid":1021017,"ip_address":"","ucode":"2002460CB3D869","user_header":"https://static001.geekbang.org/account/avatar/00/0f/94/59/ac2aa72b.jpg","comment_is_top":false,"comment_ctime":1549816203,"is_pvip":true,"replies":[{"id":"23383","content":"å¯¹çš„ï¼ŒğŸ‘ğŸ¿ç»†è‡´<br><br>å‘èµ·å‹˜è¯¯äº†ï¼Œæ–°å¹´å¿«ä¹","user_name":"ä½œè€…å›å¤","comment_id":65982,"uid":"1264162","ip_address":"","utype":1,"ctime":1549854574,"user_name_real":"æ—æ™“æ–Œ"}],"discussion_count":1,"race_medal":0,"score":"10139750795","product_id":100020801,"comment_content":"å½“ç¢°åˆ°ç¬¬ä¸€ä¸ª 2 çš„æ—¶å€™ï¼Œå·²ç»çŸ¥é“ç´¯ç§¯äº† Y ä¸ª 1ï¼Œç»“æœé›†é‡Œçš„ç¬¬ä¸€è¡Œå°±æ˜¯ (1,Y);<br>---- <br>åº”è¯¥æ˜¯ ç»“æœé›†é‡Œçš„ç¬¬ äºŒ è¡Œ å§<br><br><br><br>","like_count":2,"discussions":[{"author":{"id":1264162,"avatar":"https://static001.geekbang.org/account/avatar/00/13/4a/22/2681d602.jpg","nickname":"æ—æ™“æ–Œ","note":"","ucode":"CDE42D44F26240","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":438668,"discussion_content":"å¯¹çš„ï¼ŒğŸ‘ğŸ¿ç»†è‡´\n\nå‘èµ·å‹˜è¯¯äº†ï¼Œæ–°å¹´å¿«ä¹","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1549854574,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":65562,"user_name":"poppy","can_delete":false,"product_type":"c1","uid":1182792,"ip_address":"","ucode":"2ED2BDF703D0D9","user_header":"https://static001.geekbang.org/account/avatar/00/12/0c/48/ba59d28d.jpg","comment_is_top":false,"comment_ctime":1549455463,"is_pvip":false,"replies":[{"id":"23224","content":"æ–°å¹´å¥½~ <br><br>ğŸ‘","user_name":"ä½œè€…å›å¤","comment_id":65562,"uid":"1264162","ip_address":"","utype":1,"ctime":1549502762,"user_name_real":"æ—æ™“æ–Œ"}],"discussion_count":1,"race_medal":0,"score":"10139390055","product_id":100020801,"comment_content":"è€å¸ˆï¼Œæ˜¥èŠ‚å¿«ä¹ï¼Œè¿‡å¹´è¿˜åœ¨æ›´æ–°ï¼Œè¾›è‹¦è¾›è‹¦ã€‚<br>å…³äºæ€è€ƒé¢˜ï¼Œæˆ‘çš„ç†è§£æ˜¯å›¾8ä¸­çš„æŸ¥è¯¢æ˜¯ä½¿ç”¨äº†å†…å­˜ä¸´æ—¶è¡¨ï¼Œå­˜å‚¨çš„é¡ºåºå°±æ˜¯id%10çš„å€¼çš„æ’å…¥é¡ºåºï¼Œè€Œå›¾9ä¸­çš„æŸ¥è¯¢ï¼Œç”±äºå†…å­˜ä¸´æ—¶è¡¨å¤§å°æ— æ³•æ»¡è¶³ï¼Œæ‰€ä»¥ä½¿ç”¨äº†ç£ç›˜ä¸´æ—¶è¡¨ï¼Œå¯¹äºInnoDBæ¥è¯´ï¼Œå°±æ˜¯å¯¹åº”B+æ ‘è¿™ç§æ•°æ®ç»“æ„ï¼Œè¿™é‡Œä¼šæŒ‰ç…§id%100(å³m)çš„å¤§å°é¡ºåºæ¥å­˜å‚¨çš„ï¼Œæ‰€ä»¥è¿”å›çš„ç»“æœå½“ç„¶ä¹Ÿæ˜¯æœ‰åºçš„","like_count":2,"discussions":[{"author":{"id":1264162,"avatar":"https://static001.geekbang.org/account/avatar/00/13/4a/22/2681d602.jpg","nickname":"æ—æ™“æ–Œ","note":"","ucode":"CDE42D44F26240","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":438500,"discussion_content":"æ–°å¹´å¥½~ \n\nğŸ‘","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1549502762,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":320179,"user_name":"W_æ³¢","can_delete":false,"product_type":"c1","uid":2563866,"ip_address":"","ucode":"167D3DBCDC086F","user_header":"https://static001.geekbang.org/account/avatar/00/27/1f/1a/78fc275d.jpg","comment_is_top":false,"comment_ctime":1636106647,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"5931073943","product_id":100020801,"comment_content":"è€å¸ˆä½ å¥½ï¼Œè¯·é—®ä¸€ä¸‹ä½¿ç”¨union allçš„æ—¶å€™ä¸ä¼šäº§ç”Ÿä¸´æ—¶è¡¨å—ï¼Ÿ","like_count":1},{"had_liked":false,"id":122266,"user_name":"null","can_delete":false,"product_type":"c1","uid":1024294,"ip_address":"","ucode":"F9039EFED6B55D","user_header":"http://thirdwx.qlogo.cn/mmopen/vi_32/PiajxSqBRaELZPnUAiajaR5C25EDLWeJURggyiaOP5GGPe2qlwpQcm5e3ybib8OsP4tvddFDLVRSNNGL5I3SFPJHsA/132","comment_is_top":false,"comment_ctime":1565326825,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"5860294121","product_id":100020801,"comment_content":"ç–‘é—®ï¼š<br>set tmp_table_size=1024;<br>select id%100 as m, count(*) as c from t1 group by m order by null limit 10;<br><br>ç»“æœä¸éœ€è¦æ’åºï¼Œä¸ºä»€ä¹ˆä¸åƒç¬¬ 17 ç« ã€Šå¦‚ä½•æ­£ç¡®æ˜¾ç¤ºéšæœºæ¶ˆæ¯ã€‹ï¼Œé‡‡ç”¨ä¼˜å…ˆé˜Ÿåˆ—æ’åºç®—æ³•ã€‚è¿™é‡Œåªéœ€è¦ç»´æŠ¤ä¸€ä¸ª 10 ä¸ªå…ƒç´ çš„å †å°±å¯ä»¥äº†ã€‚<br><br>----<br><br>è¯¾åæ€è€ƒé¢˜ï¼š<br>ä½¿ç”¨ç£ç›˜ä¸´æ—¶è¡¨ï¼ˆengine=innodbï¼‰ï¼Œæ’é¦–ä½çš„æ˜¯ 0ï¼Œè€Œå†…å­˜ä¸´æ—¶è¡¨ï¼ˆengine=memoryï¼‰å´æ˜¯ 1ã€‚ä¸ºä½•ä¼šæœ‰è¿™ç§åŒºåˆ«ï¼Ÿ<br><br>æ‰«æè®¡ç®—çš„è¿‡ç¨‹éƒ½æ˜¯ä¸€æ ·çš„ï¼Œæ‰«æ a ç´¢å¼•çš„æ—¶å€™ï¼Œéƒ½æ˜¯å…ˆæ‰«æ 1ï¼Œå†æ‰«æ 10ã€‚<br>m å­—æ®µæ˜¯ç£ç›˜ä¸´æ—¶è¡¨å’Œå†…å­˜ä¸´æ—¶è¡¨çš„ä¸»é”®ã€‚<br><br>ç£ç›˜ä¸´æ—¶è¡¨æ˜¯ä»¥ B+ æ ‘å­˜å‚¨æ•°æ®ï¼Œæ’å…¥ m=0 æ—¶ï¼Œä¼šè¢«åŠ¨æ€è°ƒæ•´åˆ°é¦–ä½ã€‚è€Œå†…å­˜ä¸´æ—¶è¡¨æ˜¯ä»¥æ•°ç»„ä¿å­˜æ•°æ®ï¼Œæ¯æ¬¡éƒ½æ˜¯å¾€æ•°ç»„æœ«ç«¯æ·»åŠ å…ƒç´ ï¼Œä¸ä¼šåŠ¨æ€è°ƒæ•´ã€‚å› æ­¤äº§ç”Ÿäº†è¿™ä¸ªå·®å¼‚ã€‚","like_count":1},{"had_liked":false,"id":73663,"user_name":"Sinyo","can_delete":false,"product_type":"c1","uid":1307297,"ip_address":"","ucode":"57B243E7AB86A5","user_header":"http://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTJAibnPX9jW8kqLcIfibjic8GbkQkEUYyFKJkc39hZhibVlNrqwTjdLozkqibI2IwACd5YzofYickNxFnZg/132","comment_is_top":false,"comment_ctime":1551952746,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"5846920042","product_id":100020801,"comment_content":"è€å¸ˆå¥½ï¼Œå¥½å¥‡æ€ªæˆ‘ç”¨infobrightåˆ—å¼å­˜å‚¨å¼•æ“explainä¸€æ¡unionè¯­å¥ï¼Œå‘ç°æ˜¯ä¸ç”¨ä¸´æ—¶è¡¨çš„ï¼Œæµ‹è¯•äº†å¾ˆå¤šæ¬¡ï¼š<br>æ¯”å¦‚ï¼š<br>EXPLAIN <br>(SELECT 111)<br>UNION <br>(SELECT 222)<br>ï¼›<br>EXPLAIN <br>(SELECT 111)<br>UNION <br>(SELECT id from aaa)<br>ï¼›<br>EXPLAIN <br>(SELECT id from bbb)<br>UNION <br>(SELECT id from aaa)<br>ä»¥ä¸Šéƒ½æ²¡æœ‰ç”¨åˆ°ä¸´æ—¶è¡¨ï¼›<br>è¿™åº”è¯¥è¯´æ˜ä¸åŒå¼•æ“çš„é€»è¾‘å±‚è¿˜æ˜¯å­˜åœ¨å·®å¼‚çš„æŠŠã€‚","like_count":1},{"had_liked":false,"id":66075,"user_name":"æ¢¦åº·","can_delete":false,"product_type":"c1","uid":1069512,"ip_address":"","ucode":"8935F3C329C58E","user_header":"https://static001.geekbang.org/account/avatar/00/10/51/c8/83852d5a.jpg","comment_is_top":false,"comment_ctime":1549870855,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"5844838151","product_id":100020801,"comment_content":"æœ‰ä¸€å¼ è¡¨article_rank é‡Œé¢æœ‰æ˜¯ä¸ªå­—æ®µï¼ˆid,aid,pv,dayï¼‰ï¼Œéƒ½æ˜¯ int ç±»å‹ã€‚ç°æ‰§è¡Œå¦‚ä¸‹ sql<br>select `aid`,sum(`pv`) as num from article_rank where `day`&gt;20190115 group by aid order by num desc limit 10;<br><br>optimizer_trace ç»“æœä¸­å…³äºæ‰§è¡Œé˜¶æ®µæ•°æ®è§£è¯»è¿˜æ˜¯æœ‰äº›é—®é¢˜ã€‚<br>  {<br>    &quot;creating_tmp_table&quot;: {<br>      &quot;tmp_table_info&quot;: {<br>        &quot;table&quot;: &quot;intermediate_tmp_table&quot;,<br>        &quot;row_length&quot;: 20,<br>        &quot;key_length&quot;: 4,<br>        &quot;unique_constraint&quot;: false,<br>        &quot;location&quot;: &quot;memory (heap)&quot;,<br>        &quot;row_limit_estimate&quot;: 838860<br>      }<br>    }<br>  },<br>  {<br>    &quot;converting_tmp_table_to_ondisk&quot;: {<br>      &quot;cause&quot;: &quot;memory_table_size_exceeded&quot;,<br>      &quot;tmp_table_info&quot;: {<br>        &quot;table&quot;: &quot;intermediate_tmp_table&quot;,<br>        &quot;row_length&quot;: 20,<br>        &quot;key_length&quot;: 4,<br>        &quot;unique_constraint&quot;: false,<br>        &quot;location&quot;: &quot;disk (InnoDB)&quot;,<br>        &quot;record_format&quot;: &quot;fixed&quot;<br>      }<br>    }<br>  }<br><br>1. row_length ä¸ºä»€ä¹ˆæ˜¯20å‘¢ï¼Ÿæˆ‘ gdb è°ƒè¯•ç¡®è®¤ä¸´æ—¶è¡¨é‡Œå­˜æ”¾çš„æ˜¯ aidï¼Œnumã€‚ aid 4ä¸ªå­—èŠ‚ï¼Œnum å› ä¸ºæ˜¯ sum çš„ç»“æœæ˜¯ DECIMAL ç±»å‹ï¼Œæ‰€ä»¥æ˜¯15ä¸ªå­—èŠ‚ï¼Œä¸çŸ¥é“ä¸ºä»€ä¹ˆæ€»é•¿åº¦æ˜¯20å­—èŠ‚äº†ã€‚æµ‹è¯•å…¶ä»– sql å‡å‘ç°row_lengthä¼šæ¯”ä¸´æ—¶è¡¨ç§çš„å­—æ®µæ‰€å é•¿åº¦å¤š1å­—èŠ‚ï¼Œè¿™æ˜¯ä¸ºä½•å‘¢ï¼Ÿ<br>2. åˆ›å»ºä¸´æ—¶è¡¨æç¤ºå†…å­˜è¶…å‡ºé™åˆ¶ï¼Œä½†æ˜¯æ ¹æ®ç¬¬ä¸€æ­¥è¡Œæ•°é™åˆ¶æ˜¯ 838860 è¡Œï¼Œå®é™…æ€»å…±ç¬¦åˆæ¡ä»¶çš„è¡Œæ•°ä¸º 649091 é€šè¿‡ select count(distinct aid) from article_rank where `day`&gt;20190115 æŸ¥è¯¢å¾—åˆ°ã€‚ä¸ºä»€ä¹ˆä¼šè¶…å‡ºå†…å­˜å‘¢ï¼Ÿ<br><br>éº»çƒ¦è€å¸ˆå¸®å¿™è§£ç­”ä¸‹ã€‚è°¢è°¢å•¦ã€‚","like_count":1},{"had_liked":false,"id":65576,"user_name":"ç‰›ç‰›","can_delete":false,"product_type":"c1","uid":1194626,"ip_address":"","ucode":"CFCE68B4F92209","user_header":"https://static001.geekbang.org/account/avatar/00/12/3a/82/1ff83a38.jpg","comment_is_top":false,"comment_ctime":1549463427,"is_pvip":false,"replies":[{"id":"23222","content":"æ–°å¹´å¿«ä¹~ğŸ¤","user_name":"ä½œè€…å›å¤","user_name_real":"æ—æ™“æ–Œ","uid":"1264162","ctime":1549502532,"ip_address":"","comment_id":65576,"utype":1}],"discussion_count":1,"race_medal":0,"score":"5844430723","product_id":100020801,"comment_content":"æ–°å¹´å¿«ä¹ï½ã€æ„Ÿè°¢æœ‰æ‚¨ï½^_^ï½","like_count":1,"discussions":[{"author":{"id":1264162,"avatar":"https://static001.geekbang.org/account/avatar/00/13/4a/22/2681d602.jpg","nickname":"æ—æ™“æ–Œ","note":"","ucode":"CDE42D44F26240","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":438505,"discussion_content":"æ–°å¹´å¿«ä¹~ğŸ¤","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1549502532,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":65526,"user_name":"å…«ç™¾","can_delete":false,"product_type":"c1","uid":1253530,"ip_address":"","ucode":"79F1F79ADF5A00","user_header":"https://static001.geekbang.org/account/avatar/00/13/20/9a/3b1c65fd.jpg","comment_is_top":false,"comment_ctime":1549430239,"is_pvip":false,"replies":[{"id":"23215","content":"æ–°å¹´å¿«ä¹ğŸ¤","user_name":"ä½œè€…å›å¤","user_name_real":"æ—æ™“æ–Œ","uid":"1264162","ctime":1549441706,"ip_address":"","comment_id":65526,"utype":1}],"discussion_count":1,"race_medal":0,"score":"5844397535","product_id":100020801,"comment_content":"æ˜¥èŠ‚å¿«ä¹ï¼Œè€å¸ˆã€‚è°¢è°¢ä½ è®©æˆ‘å­¦åˆ°ä¸å°‘çŸ¥è¯†","like_count":1,"discussions":[{"author":{"id":1264162,"avatar":"https://static001.geekbang.org/account/avatar/00/13/4a/22/2681d602.jpg","nickname":"æ—æ™“æ–Œ","note":"","ucode":"CDE42D44F26240","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":438489,"discussion_content":"æ–°å¹´å¿«ä¹ğŸ¤","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1549441706,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":65495,"user_name":"æŸã€äºº","can_delete":false,"product_type":"c1","uid":1308784,"ip_address":"","ucode":"ADB42AA12A11C1","user_header":"https://static001.geekbang.org/account/avatar/00/13/f8/70/f3a33a14.jpg","comment_is_top":false,"comment_ctime":1549418377,"is_pvip":false,"replies":[{"id":"23210","content":"æ˜¥èŠ‚å¿«ä¹ï¼ŒğŸ¤","user_name":"ä½œè€…å›å¤","user_name_real":"æ—æ™“æ–Œ","uid":"1264162","ctime":1549427593,"ip_address":"","comment_id":65495,"utype":1}],"discussion_count":1,"race_medal":0,"score":"5844385673","product_id":100020801,"comment_content":"è€å¸ˆæ˜¥èŠ‚å¿«ä¹ï¼Œè¾›è‹¦äº†","like_count":1,"discussions":[{"author":{"id":1264162,"avatar":"https://static001.geekbang.org/account/avatar/00/13/4a/22/2681d602.jpg","nickname":"æ—æ™“æ–Œ","note":"","ucode":"CDE42D44F26240","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":438473,"discussion_content":"æ˜¥èŠ‚å¿«ä¹ï¼ŒğŸ¤","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1549427593,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":358002,"user_name":"Geek_eabafe","can_delete":false,"product_type":"c1","uid":3167302,"ip_address":"åŒ—äº¬","ucode":"4D94487320B33B","user_header":"","comment_is_top":false,"comment_ctime":1663827779,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1663827779","product_id":100020801,"comment_content":"è€å¸ˆ æ˜¯ä¸æ˜¯å¯ä»¥è¿™æ ·ç†è§£<br>å†…å­˜ä¸´æ—¶è¡¨å°±æ˜¯engine=memoryï¼›<br>ç£ç›˜ä¸´æ—¶è¡¨å°±æ˜¯ engine=innodb;","like_count":0},{"had_liked":false,"id":346359,"user_name":"é æŒ¯æ³°","can_delete":false,"product_type":"c1","uid":1258930,"ip_address":"","ucode":"E7E698250DD436","user_header":"https://static001.geekbang.org/account/avatar/00/13/35/b2/a64546fb.jpg","comment_is_top":false,"comment_ctime":1653043949,"is_pvip":true,"discussion_count":0,"race_medal":0,"score":"1653043949","product_id":100020801,"comment_content":"è€å¸ˆï¼Œæˆ‘è¿™è¾¹é‡åˆ°ä¸€ä¸ªé—®é¢˜ã€‚<br>ç°è±¡ï¼šä»åº“æŸ¥è¯¢å¦‚ä¸‹è¯­å¥ï¼Œcountç»“æœä¸å¯¹ã€‚<br>è¡¨æƒ…å†µï¼šä¸¤ä¸ªè¡¨å…³è”ç»“æœæ˜¯5æ¡ï¼Œhavingæ¡ä»¶æŒ‡å®šçš„ordercodeå€¼å¯¹åº”å³è¡¨5æ¡è®°å½•ï¼ˆä¸¤ä¸ªdeliveryorderå€¼ï¼Œä¸€ä¸ªå¯¹åº”ä¸€æ¡æ˜ç»†è®°å½•ï¼Œå¦ä¸€ä¸ªå¯¹åº”4æ¡æ˜ç»†è®°å½•ï¼‰ã€‚ä½†å°†order_codeæ”¾æ³¨é‡Šä½ç½®countç»“æœæ˜¯1ï¼Œæ”¾æœ€ä¸‹é¢countç»“æœæ˜¯5ï¼Œåœ¨ä¸»åº“ä¸Šæ‰§è¡Œéƒ½æ˜¯5ï¼Œå®é™…countä¹Ÿåº”è¯¥ä¸º5ã€‚æ˜¯å“ªä¸ªç³»ç»Ÿå‚æ•°èƒ½å½±å“åˆ°å—ï¼Ÿï¼ˆä¸å­˜åœ¨æ•°æ®ä¸€è‡´æ€§é—®é¢˜ã€‚delivery_order_202205è¡¨120wæ•°æ®ï¼Œdelivery_order_detail_202205è¡¨500wæ•°æ®. å…ˆä¸çœ‹è¯­å¥æ€§èƒ½é—®é¢˜ï¼Œè¿™æ˜¯ä¸€ä¸ªç ”å‘å°ä¼™ä¼´å‘æˆ‘çœ‹åˆ°çš„æƒ…å†µï¼‰<br><br>è¯­å¥ï¼š<br>SELECT<br>\ta.sale_store_code,<br>\ta.channel_order_code,<br>\ta.order_code,<br>\tcount( 0 ) <br>FROM<br>\tdelivery_order_202205 a<br>\tLEFT JOIN delivery_order_detail_202205 b ON a.delivery_order_code = b.delivery_order_code <br>WHERE<br>\ta.delivery_state &lt;&gt; &#39;CANCEL&#39; <br>GROUP BY<br>\ta.sale_store_code,<br>\ta.order_code,<br>\ta.channel_order_code -- , a.order_code<br>\t<br>HAVING<br>\ta.order_code = &#39;EO2022050100019796&#39;","like_count":0},{"had_liked":false,"id":345659,"user_name":"é˜¿ç”˜","can_delete":false,"product_type":"c1","uid":1057843,"ip_address":"","ucode":"BC93175B70E05D","user_header":"https://static001.geekbang.org/account/avatar/00/10/24/33/bcf37f50.jpg","comment_is_top":false,"comment_ctime":1652494984,"is_pvip":true,"discussion_count":0,"race_medal":0,"score":"1652494984","product_id":100020801,"comment_content":"è€å¸ˆï¼Œè¯·æ•™ä¸€ä¸‹ï¼Œæˆ‘ä»¬ä¸€èˆ¬åˆ›å»ºç”¨ insert into tmp_xxx (select * from xxx) å¾€ä¸´æ—¶è¡¨é‡Œé¢æ’å…¥æ•°æ®ï¼Œä½†æ˜¯ä¼šå‘ç° select * from tmp_xxx å‡ºæ¥çš„ç»“æœè·Ÿ select * from xxx é¡ºåºæ˜¯ä¸ä¸€æ ·çš„ã€‚æ€æ ·æ‰èƒ½æ€ä¹ˆä¿è¯ä¸¤è€…çš„é¡ºåºæ˜¯ä¸€è‡´çš„å‘¢ï¼Ÿ","like_count":0},{"had_liked":false,"id":337014,"user_name":"ã€‚ã€‚","can_delete":false,"product_type":"c1","uid":2853618,"ip_address":"","ucode":"A52A6043D27D87","user_header":"https://static001.geekbang.org/account/avatar/00/2b/8a/f2/6c6f7886.jpg","comment_is_top":false,"comment_ctime":1646553056,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1646553056","product_id":100020801,"comment_content":"è€å¸ˆï¼Œæœ‰å‡ ä¸ªç–‘æƒ‘çš„ç‚¹ï¼Œ<br><br>1.åœ¨ join ä¼˜åŒ–ä¸­ï¼Œä¸€ä¸ªå°è¡¨å¯èƒ½æ˜¯ where åçš„é™å®šæ¡ä»¶ï¼Œä½†æ˜¯æ ¹æ®sqlæ‰§è¡Œé¡ºåºï¼Œjoin åœ¨ where ä¹‹å‰æ‰§è¡Œï¼Œä¹Ÿå°±æ˜¯å…ˆè¿æ¥åæ‰§è¡Œ whereï¼Œä½†æ˜¯æŒ‰ç…§æ–‡ä¸­çš„æ„æ€æœ‰ç§å…ˆ whereå join çš„æ„Ÿè§‰ï¼Œä¸æ˜¯å¾ˆç†è§£ã€‚limit ä¹Ÿæ˜¯ï¼Œä¾‹å¦‚ select * from t1 limit 2ï¼Œæ˜¯æŸ¥è¯¢å‡ºæ‰€æœ‰ç»“æœå†å–å‰ä¸¤æ¡ã€‚è¿˜æ˜¯å–å‡ºå‰ä¸¤æ¡å°±è¿”å›å‘¢ã€‚<br><br>2.ç”¨æ–‡ä¸­çš„è¡¨æ¥æ“ä½œï¼ŒQ1å’ŒQ3ä¸€æ ·ï¼Œå‡è¿›è¡Œäº†å…¨è¡¨æ‰«æï¼Œæ‰«æäº† 1000è¡Œã€‚Q2ä½¿ç”¨äº†ä¸»é”®ç´¢å¼•ï¼Œæ‰«æäº†2è¡Œã€‚ä½†æ˜¯æˆ‘ä¸ªäººæ„Ÿè§‰è¿™ä¸‰ä¸ªsqlçš„è¯­ä¹‰æ˜¯ä¸€æ ·çš„ï¼ŒQ1ä¸­æ²¡æœ‰whereæ¡ä»¶ä¹‹ç±»çš„ï¼Œæ²¡æœ‰å…¶ä»–ç´¢å¼•å¯ç”¨ï¼Œå› æ­¤æ˜¯åœ¨ä¸»é”®ç´¢å¼•ä¸Šæ‰¾å‰ä¸¤æ¡è®°å½•ï¼Œå› æ­¤æ„Ÿè§‰å’Œ Q2 ä¸­åŠ  `order by id` æ˜¯ä¸€å›äº‹ï¼ŒQ2ä¹Ÿæ˜¯åŒæ ·çš„è¯­ä¹‰ã€‚ä½†æ˜¯ä»…æ‰«æäº†2è¡Œã€‚æœ€å¥‡æ€ªçš„æ˜¯ Q4ï¼Œæˆ‘å·²ç»æŒ‡å®šç”¨ç´¢å¼•aäº†ï¼Œä½†æ˜¯ä»–å¹¶æ²¡æœ‰ç”¨åˆ°ç´¢å¼•ï¼Œè€Œæ˜¯èµ°äº†å…¨è¡¨æ‰«æï¼Œæ‰«æäº† 1000è¡Œï¼Œforce index ä¸åº”è¯¥æ˜¯å¼ºè¡ŒæŒ‡å®šäº†å—ï¼Ÿ<br><br>   explain select * from t1 limit 2; &#47;*Q1*&#47;<br>   explain select * from t1 order by id limit 2  &#47;*Q2*&#47;<br>   explain select * from t1 force index(primary) limit 2;  &#47;*Q3*&#47;<br>   explain select * from t1 force index(a) limit 2;   &#47;*Q4*&#47;","like_count":0},{"had_liked":false,"id":333898,"user_name":"qiushye","can_delete":false,"product_type":"c1","uid":1322164,"ip_address":"","ucode":"D005A152F8BEDC","user_header":"","comment_is_top":false,"comment_ctime":1644573331,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1644573331","product_id":100020801,"comment_content":"æˆ‘åœ¨æ²¡åŠ ç´¢å¼•çš„æ—¶å€™ç›´æ¥explain group byï¼ŒExtraé‡Œæ²¡æœ‰file sortä¿¡æ¯æ˜¯ä¸ºä»€ä¹ˆå‘¢ï¼Ÿç”¨SQL_BIG_RESULTåæ‰ä¼šæœ‰","like_count":0},{"had_liked":false,"id":305332,"user_name":"è€æ¨çš„æ¨","can_delete":false,"product_type":"c1","uid":1618247,"ip_address":"","ucode":"B744208C9E9752","user_header":"https://static001.geekbang.org/account/avatar/00/18/b1/47/05a00f4c.jpg","comment_is_top":false,"comment_ctime":1627909340,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1627909340","product_id":100020801,"comment_content":"MySQL å¥æŸ„æ•°å ç”¨è¿‡å¤šçš„è¯¥å’‹åŠå‘€ çœ‹å¥½å¤šéƒ½æ˜¯ä¸´æ—¶è¡¨çš„ è€Œä¸”lsofçœ‹ æ˜¯deleted","like_count":0},{"had_liked":false,"id":298894,"user_name":"walzzz","can_delete":false,"product_type":"c1","uid":1707393,"ip_address":"","ucode":"17D8079494189A","user_header":"https://static001.geekbang.org/account/avatar/00/1a/0d/81/ed4957e8.jpg","comment_is_top":false,"comment_ctime":1624361285,"is_pvip":false,"discussion_count":0,"race_medal":1,"score":"1624361285","product_id":100020801,"comment_content":"è€å¸ˆæ‚¨å¥½ï¼è¿™é‡Œâ€œMySQLçš„ä¼˜åŒ–å™¨ä¸€çœ‹ï¼Œç£ç›˜ä¸´æ—¶è¡¨æ˜¯B+æ ‘å­˜å‚¨ï¼Œå­˜å‚¨æ•ˆç‡ä¸å¦‚æ•°ç»„æ¥å¾—é«˜ã€‚æ‰€ä»¥ï¼Œæ—¢ç„¶ä½ å‘Šè¯‰æˆ‘æ•°æ®é‡å¾ˆå¤§ï¼Œé‚£ä»ç£ç›˜ç©ºé—´è€ƒè™‘ï¼Œè¿˜æ˜¯ç›´æ¥ç”¨æ•°ç»„æ¥å­˜å§ã€‚â€â€”â€”æ„æ€æ˜¯å®é™…ä¸Šå¹¶æ²¡æœ‰ä½¿ç”¨ç£ç›˜ä¸´æ—¶è¡¨å—ï¼Ÿæ‰€ä»¥SQL_BIG_RESULTçš„æ„ä¹‰åªæ˜¯ç»™ä¼˜åŒ–å™¨ä¸€ä¸ªæ›´ç³Ÿçš„é€‰é¡¹ï¼Œç„¶åé€¼è¿«å®ƒæœ€ç»ˆé€‰æ‹©ç›´æ¥æ’åºå—ï¼Ÿé‚£ä»€ä¹ˆæ—¶å€™æ‰ä¼šèµ°ç£ç›˜ä¸´æ—¶è¡¨å‘¢ï¼Ÿæ„Ÿè°¢å›ç­”ï¼","like_count":0},{"had_liked":false,"id":298793,"user_name":"å¼ ä¸‰ä¸°","can_delete":false,"product_type":"c1","uid":1155275,"ip_address":"","ucode":"3A6215A40B3B21","user_header":"https://static001.geekbang.org/account/avatar/00/11/a0/cb/aab3b3e7.jpg","comment_is_top":false,"comment_ctime":1624327101,"is_pvip":false,"discussion_count":1,"race_medal":0,"score":"1624327101","product_id":100020801,"comment_content":"è¿™ä¸€ç« çš„å†…å­˜ä¸´æ—¶è¡¨å’Œä¸Šä¸€ç« çš„ä¸´æ—¶è¡¨æœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿæ˜¯ä¸€å›äº‹å—ï¼Ÿ","like_count":0,"discussions":[{"author":{"id":2222079,"avatar":"","nickname":"chen","note":"","ucode":"352E1D6548DAE0","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":393879,"discussion_content":"ä¸æ˜¯ï¼Œè¿™ä¸€ç« çš„å†…å­˜ä¸´æ—¶è¡¨æ˜¯ç³»ç»Ÿåˆ›å»ºçš„ï¼›ä¸Šä¸€ç« çš„ä¸´æ—¶è¡¨æ˜¯ç”¨æˆ·ä¸´æ—¶è¡¨ï¼Œæ˜¯ç”¨æˆ·ä¸»åŠ¨åˆ›å»ºçš„ã€‚","likes_number":1,"is_delete":false,"is_hidden":false,"ctime":1631624955,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":295946,"user_name":"æµ·","can_delete":false,"product_type":"c1","uid":2418232,"ip_address":"","ucode":"09FAF70D78668A","user_header":"https://static001.geekbang.org/account/avatar/00/24/e6/38/25e7cce5.jpg","comment_is_top":false,"comment_ctime":1622680013,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1622680013","product_id":100020801,"comment_content":"select id%100<br>as m, min(id) as min_id  from t group by m <br><br>è¿™ç§æŸ¥è¯¢è¯­å¥å¯ä»¥ç”¨SQL_BIG_RESULTæ¥ä¼˜åŒ–å—","like_count":0},{"had_liked":false,"id":278241,"user_name":"Khirye","can_delete":false,"product_type":"c1","uid":1080985,"ip_address":"","ucode":"6C54C126FA54B8","user_header":"https://static001.geekbang.org/account/avatar/00/10/7e/99/c4302030.jpg","comment_is_top":false,"comment_ctime":1612841789,"is_pvip":false,"discussion_count":1,"race_medal":0,"score":"1612841789","product_id":100020801,"comment_content":"è€å¸ˆä½ å¥½ï¼Œæˆ‘åœ¨æˆ‘ä»¬çº¿ä¸Šæ•°æ®åº“éšä¾¿æ‰¾äº†ä¸ªè¡¨æ‰§è¡Œâ€œexplain select id%10 as m, count(*) as c from user_receive_coupon_record group by idâ€œ,explainç»“æœé‡Œå¹¶æ²¡æœ‰Using temporaryã€‚è¯·é—®å¯èƒ½çš„åŸå› æ˜¯ä»€ä¹ˆï¼Ÿ","like_count":0,"discussions":[{"author":{"id":2603445,"avatar":"https://static001.geekbang.org/account/avatar/00/27/b9/b5/7975f3a3.jpg","nickname":"â­•ï¸â­•ï¸","note":"","ucode":"999231614A28A3","race_medal":0,"user_type":1,"is_pvip":true},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":566877,"discussion_content":"group byé”™äº†ã€‚ã€‚ã€‚ä»¥idåˆ†ç»„æ²¡æ„ä¹‰ã€‚countéƒ½æ˜¯1","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1650787522,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":244568,"user_name":"ç‘å“²","can_delete":false,"product_type":"c1","uid":1502093,"ip_address":"","ucode":"9F170728A055AD","user_header":"https://static001.geekbang.org/account/avatar/00/16/eb/8d/8ee78d3d.jpg","comment_is_top":false,"comment_ctime":1598583535,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1598583535","product_id":100020801,"comment_content":"å›ç­”é—®é¢˜ï¼šinnoDBä¼šé»˜è®¤å–må­—æ®µä½œä¸º","like_count":0},{"had_liked":false,"id":226811,"user_name":"è½»æ¾çš„é±¼","can_delete":false,"product_type":"c1","uid":1219198,"ip_address":"","ucode":"F4FF653209C47B","user_header":"http://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTIEl3fX9nvzUF26ekUIicp4sgA5jZ1mGvGMhIHkwJabbjt9h5uTLw5zzU1U6JZbCSpRXBNQwuejLJg/132","comment_is_top":false,"comment_ctime":1592208514,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1592208514","product_id":100020801,"comment_content":"â€œgroup by ä¼˜åŒ–æ–¹æ³• -- ç›´æ¥æ’åºâ€æåˆ°çš„ç®—æ³•ï¼Œåœ¨æ²¡æœ‰ç´¢å¼•ã€ä¸´æ—¶ç»“æœå¾ˆå¤§ä¼šäº§ç”Ÿç£ç›˜ä¸´æ—¶è¡¨çš„æƒ…å†µä¸‹ï¼Œé€šè¿‡ sort_buffer æ’åºæ–¹æ³•ç›´æ¥é¿å…äº†åˆ©ç”¨ä¸´æ—¶è¡¨å¾—åˆ°åˆ†ç»„ç»“æœã€‚<br><br>ä½†æ˜¯ä¸€å¼€å§‹ä»‹ç»çš„ group by æ‰§è¡Œæµç¨‹ï¼Œä¸´æ—¶ç»“æœæ•°æ®é‡å°ï¼Œåˆ›å»ºâ€œå†…å­˜ä¸´æ—¶è¡¨â€åè¿˜æ˜¯éœ€è¦æ’åºï¼Œçœ‹èµ·æ¥è¿˜æ˜¯æ¯”ä¸ä¸Šâ€œç›´æ¥æ’åºâ€çš„æ•ˆç‡ï¼Œä¸ºä»€ä¹ˆä¸ä¸€å¾‹ä½¿ç”¨â€œç›´æ¥æ’åºâ€ç®—æ³•å‘¢ï¼Ÿ","like_count":0},{"had_liked":false,"id":218069,"user_name":"å¤å…´","can_delete":false,"product_type":"c1","uid":1363230,"ip_address":"","ucode":"C172A87873001A","user_header":"https://static001.geekbang.org/account/avatar/00/14/cd/1e/692c3313.jpg","comment_is_top":false,"comment_ctime":1589707396,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1589707396","product_id":100020801,"comment_content":"ä¸´æ—¶è¡¨çš„ä¸»é”®ï¼Œä¸æ˜¯ä¸»é”®ç´¢å¼•å§ï¼Œå¦‚æœæ˜¯çš„ï¼Œé‚£ä¹ˆæ’å…¥çš„è¿‡ç¨‹ä¸­ï¼Œå·²ç»ä¿è¯å…¶é¡ºåºäº†ï¼Œæœ€åä¹Ÿå°±ä¸éœ€è¦æ’åºäº†","like_count":0},{"had_liked":false,"id":207074,"user_name":"åƒæ°´ä¸ç”¨é’±","can_delete":false,"product_type":"c1","uid":1797135,"ip_address":"","ucode":"8A5D5978F0D4E5","user_header":"https://static001.geekbang.org/account/avatar/00/1b/6c/0f/7d242cc2.jpg","comment_is_top":false,"comment_ctime":1587002999,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1587002999","product_id":100020801,"comment_content":"è¯·é—®è€å¸ˆï¼Œæœ¬èŠ‚ä¸­çš„å†…å­˜ä¸´æ—¶è¡¨ï¼ŒæŒ‰ä¸Šä¸€èŠ‚çš„åˆ†ç±»ï¼Œæ˜¯å†…å­˜è¡¨ï¼Œè¿˜æ˜¯ä¸´æ—¶è¡¨ï¼Ÿè¿˜æ˜¯å…¼å¤‡ä¸¤è€…çš„ç‰¹æ€§ï¼Ÿ","like_count":0},{"had_liked":false,"id":204042,"user_name":"æŸ³åä¸‰","can_delete":false,"product_type":"c1","uid":1385852,"ip_address":"","ucode":"FE50C9778914C6","user_header":"http://thirdwx.qlogo.cn/mmopen/vi_32/tKvmZ3Vs4t6RZ3X7cAliaW47Zatxhn1aV5PcCYT9NZ9k9WWqRrEBGHicGtRWvsG6yQqHnaWw6cGNSbicNLjZebcHA/132","comment_is_top":false,"comment_ctime":1586324054,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1586324054","product_id":100020801,"comment_content":"å›¾ä¸ƒæŒ‰æŸ¥è¯¢ç»“æœä¸­çš„måœ¨æ’åºï¼Œå›¾å…«åŠ ä¸Šorder by nullï¼Œä¼šèµ°ç´¢å¼•æ’åº,æŒ‰idè¿›è¡Œæ’åº,å›¾ä¹æ˜¯å…ˆgroup byï¼Œç»“æœæ˜¯æŒ‰ç…§måœ¨æ’åºï¼Œå®˜æ–¹è¯´æ˜ï¼Œå¦‚æœæŸ¥è¯¢ç»“æœæ˜¯æœ‰åºçš„ï¼Œlimitä¸order byä¸€èµ·ä½¿ç”¨ï¼Œä¼šåœæ­¢æ’åºã€‚","like_count":0},{"had_liked":false,"id":189167,"user_name":"å¤©å¤©å‘ä¸Š","can_delete":false,"product_type":"c1","uid":1242455,"ip_address":"","ucode":"0CCCA6F4DCC480","user_header":"https://static001.geekbang.org/account/avatar/00/12/f5/57/ce10fb1b.jpg","comment_is_top":false,"comment_ctime":1584462587,"is_pvip":false,"discussion_count":2,"race_medal":0,"score":"1584462587","product_id":100020801,"comment_content":"â€œorder by nullâ€å’Œâ€œä¸åŠ order byâ€æœ‰ä»€ä¹ˆåŒºåˆ«å•Š<br>","like_count":0,"discussions":[{"author":{"id":1788647,"avatar":"https://static001.geekbang.org/account/avatar/00/1b/4a/e7/6c16af5d.jpg","nickname":"æ±‰æ±Ÿ","note":"","ucode":"01622D984B8F9B","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":363600,"discussion_content":"ä¸åŠ order by ä¼šè¿›è¡Œæ’åº   order by null ä¸ä¼šæ’åº","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1617244098,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1135593,"avatar":"https://static001.geekbang.org/account/avatar/00/11/53/e9/f244988e.jpg","nickname":"NIRVANA","note":"","ucode":"F3A979679AA44E","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":283198,"discussion_content":"å‰è€…æ€§èƒ½æ›´å¥½","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1592209263,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":186458,"user_name":"å°äºˆ","can_delete":false,"product_type":"c1","uid":1442580,"ip_address":"","ucode":"3F5EAEE1746074","user_header":"https://static001.geekbang.org/account/avatar/00/16/03/14/e9ca2d09.jpg","comment_is_top":false,"comment_ctime":1583847495,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1583847495","product_id":100020801,"comment_content":"å›ç­”é—®é¢˜<br>å›¾8æ˜¯å†…å­˜ä¸´æ—¶è¡¨ï¼Œå¦‚æœä¸æ’åºå°±æ˜¯æŒ‰æ’å…¥ä¸´æ—¶è¡¨çš„é¡ºåºå–å‡ºæ¥ï¼Œæ‰€ä»¥0åœ¨æœ€åä¸€è¡Œã€‚ å›¾9æ˜¯ç£ç›˜ä¸´æ—¶è¡¨å¹¶ä¸”ä½¿ç”¨äº†innoDBå¼•æ“ï¼Œè™½ç„¶æ²¡æœ‰æ’åºï¼Œä½†æ˜¯åœ¨æ’å…¥innoDBè¡¨çš„æ—¶å€™ä¼šæŒ‰å­—æ®µmæ’åºï¼Œå†ä»innoDBè¡¨å–å‡ºæ¥ï¼Œè¿™æ˜¯å·²ç»æ˜¯æŒ‰mæ‹æ’å¥½åºçš„äº†ï¼Œæ‰€ä»¥0åœ¨ç¬¬ä¸€è¡Œ","like_count":0},{"had_liked":false,"id":181684,"user_name":"ä¸ç‹¼å…±èˆ","can_delete":false,"product_type":"c1","uid":1391144,"ip_address":"","ucode":"02AC04B43F0194","user_header":"https://static001.geekbang.org/account/avatar/00/15/3a/28/cf707831.jpg","comment_is_top":false,"comment_ctime":1582616349,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1582616349","product_id":100020801,"comment_content":"generated column æœºåˆ¶ã€SQL_BIG_RESULTå’Œ order by null ä»¥å‰è¿˜çœŸæ²¡æœ‰ç”¨è¿‡ï¼ŒGETåˆ°äº†æ–°æŠ€èƒ½ï¼Œgenerated column æœºåˆ¶è²Œä¼¼åœ¨ percona é‡Œä¸é€‚ç”¨ã€‚","like_count":0},{"had_liked":false,"id":179711,"user_name":"è¾‰ç…Œç å†œ","can_delete":false,"product_type":"c1","uid":1332799,"ip_address":"","ucode":"09779C2E06EA52","user_header":"http://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTIy5ULaodUwsLoPuk1wd22hqXsaBbibNEqXM0kgrCTYDGKYQkZICYEyH9wMj4hyUicuQwHdDuOKRj0g/132","comment_is_top":false,"comment_ctime":1582082069,"is_pvip":false,"replies":[{"id":"69784","content":"å°±æ˜¯ä½¿ç”¨äº†ä¸´æ—¶è¡¨å‘€","user_name":"ä½œè€…å›å¤","user_name_real":"æ—æ™“æ–Œ","uid":"1264162","ctime":1582086061,"ip_address":"","comment_id":179711,"utype":1}],"discussion_count":2,"race_medal":0,"score":"1582082069","product_id":100020801,"comment_content":"è€å¸ˆæ‚¨å¥½ï¼Œè¯·é—®ä¸‹ï¼Œè¿™ç§åœºæ™¯ä¸‹ä¸ºä»€ä¹ˆä¼šæœ‰Using temporaryå‘¢ï¼Ÿhttps:&#47;&#47;stackoverflow.com&#47;questions&#47;36143560&#47;mysql-update-query-using-a-temporary-table-when-an-equivalent-select-query-does","like_count":0,"discussions":[{"author":{"id":1264162,"avatar":"https://static001.geekbang.org/account/avatar/00/13/4a/22/2681d602.jpg","nickname":"æ—æ™“æ–Œ","note":"","ucode":"CDE42D44F26240","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":484364,"discussion_content":"å°±æ˜¯ä½¿ç”¨äº†ä¸´æ—¶è¡¨å‘€","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1582086061,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1332799,"avatar":"http://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTIy5ULaodUwsLoPuk1wd22hqXsaBbibNEqXM0kgrCTYDGKYQkZICYEyH9wMj4hyUicuQwHdDuOKRj0g/132","nickname":"è¾‰ç…Œç å†œ","note":"","ucode":"09779C2E06EA52","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":178373,"discussion_content":"ä¸ºä»€ä¹ˆä¼šä½¿ç”¨ä¸´æ—¶è¡¨å‘¢ï¼Œselectæ²¡æœ‰ä½¿ç”¨ï¼Œè€Œupdateå´ä½¿ç”¨äº†å‘¢","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1582160308,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":146428,"user_name":"Garen","can_delete":false,"product_type":"c1","uid":1672786,"ip_address":"","ucode":"0608C88F83EF0C","user_header":"https://static001.geekbang.org/account/avatar/00/19/86/52/91c7d112.jpg","comment_is_top":false,"comment_ctime":1572520325,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1572520325","product_id":100020801,"comment_content":"è€å¸ˆæ‚¨å¥½ï¼š<br>çœ‹äº†æ–‡ç« ï¼Œgroup by ä¸ä¼šä½¿ç”¨ç£ç›˜ä¸´æ—¶è¡¨ï¼Œä¼šä½¿ç”¨æ’åºç®—æ³•ã€‚æˆ‘åŸä»¥ä¸ºä¸ä½¿ç”¨ç£ç›˜ä¸´æ—¶è¡¨æ˜¯å› ä¸ºç£ç›˜ä¸´æ—¶è¡¨å°±èƒ½è·å¾—count(*)äº†ï¼Œå¦‚æœå¤šä¸€äº›æŸ¥è¯¢ç»“æœï¼Œåº”è¯¥ä¼šä½¿ç”¨ç£ç›˜ä¸´æ—¶è¡¨ã€‚ä½†æ˜¯æˆ‘æ‰§è¡Œä¸‹é¢çš„è¯­å¥ï¼Œä¾æ—§ä½¿ç”¨äº†æ’åºç®—æ³•ã€‚ä¸ºä»€ä¹ˆä¼šè¿™æ ·å‘¢ï¼Ÿ<br><br>explain select SQL_BIG_RESULT id%100 as m, count(*) as c, max(id),min(id),id,a,b from t1 group by m;","like_count":0},{"had_liked":false,"id":146038,"user_name":"æµ‹å°è¯•","can_delete":false,"product_type":"c1","uid":1668301,"ip_address":"","ucode":"591F2D8CFBF503","user_header":"https://static001.geekbang.org/account/avatar/00/19/74/cd/158dc733.jpg","comment_is_top":false,"comment_ctime":1572422602,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1572422602","product_id":100020801,"comment_content":"ä¸ºä»€ä¹ˆInnoDBå¼•æ“è¿›è¡Œgroup byæ“ä½œæ˜¯é»˜è®¤æ’åºçš„å‘¢ï¼Ÿ","like_count":0},{"had_liked":false,"id":130632,"user_name":"MrVito","can_delete":false,"product_type":"c1","uid":1252169,"ip_address":"","ucode":"716FF6F8871706","user_header":"https://static001.geekbang.org/account/avatar/00/13/1b/49/ddefc656.jpg","comment_is_top":false,"comment_ctime":1567497794,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1567497794","product_id":100020801,"comment_content":"sort_bufferæ’åºåå½¢æˆæœ‰åºä¸´æ—¶è¡¨","like_count":0},{"had_liked":false,"id":125695,"user_name":"åˆåŒå’å•æ˜¯ä¸€å¹´å•Š","can_delete":false,"product_type":"c1","uid":1000015,"ip_address":"","ucode":"E067320E537DEE","user_header":"https://static001.geekbang.org/account/avatar/00/0f/42/4f/ff1ac464.jpg","comment_is_top":false,"comment_ctime":1566227272,"is_pvip":false,"discussion_count":1,"race_medal":0,"score":"1566227272","product_id":100020801,"comment_content":"æ‚¨å¥½ï¼Œè¯·é—®ä¸‹ select id%100 as m, count(*) as c from t1 group by m; è¿™ä¸ªsqlä¸ºä»€ä¹ˆä¼šå‘½ä¸­ç´¢å¼•aå‘¢ï¼Œä¸å¤ªæ˜ç™½ï¼Œè¦è¯´ä»–è·Ÿ id ä¸»ç´¢å¼•æœ‰å…³æˆ‘è¿˜èƒ½ç†è§£ç‚¹ï¼Œè¯·å¸®æˆ‘ç§‘æ™®ä¸‹å¤šè°¢äº†<br>","like_count":0,"discussions":[{"author":{"id":1226968,"avatar":"https://static001.geekbang.org/account/avatar/00/12/b8/d8/f81b5604.jpg","nickname":"hcyycb","note":"","ucode":"77FF6CA41F9E66","race_medal":0,"user_type":1,"is_pvip":true},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":6889,"discussion_content":"è€å¸ˆåœ¨ä¸Šé¢çš„é—®é¢˜æœ‰å›ç­”è¿‡ã€‚è¿™ä¸ªå¯èƒ½æ˜¯Mysql ä¼˜åŒ–å™¨çš„é€‰æ‹©ã€‚å¦‚æœç”¨ primary ä¸»é”®ï¼Œå®ƒçš„å¶å­èŠ‚ç‚¹å°±æ˜¯æ‰€æœ‰çš„æ•°æ®ã€‚å¦‚æœç”¨ç´¢å¼• a ,å®ƒçš„å¶å­èŠ‚ç‚¹å°±æ˜¯ ä¸»é”® idã€‚ä¸¤ç§æƒ…å†µç›¸æ¯”ï¼Œç”¨ç´¢å¼• a çš„ç©ºé—´ï¼Œè¯»å–çš„æ•°æ®é‡ä¼šæ›´å°‘ã€‚è€Œ SQL è¯­å¥ä¸­åªéœ€è¦ count(*) ï¼Œç»Ÿè®¡æ€»æ•°è€Œå·²ï¼Œæ‰€ä»¥ï¼Œé€‰æ‹©ç”¨ç´¢å¼• a çš„â€œæˆæœ¬â€æ›´ä½ã€‚\næˆ‘ä¹Ÿæ˜¯çœ‹è€å¸ˆçš„å›ç­”ï¼Œè„‘è¡¥çš„è‡ªå·±çš„ç†è§£ã€‚","likes_number":2,"is_delete":false,"is_hidden":false,"ctime":1567154371,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":125399,"user_name":"fww17612593599","can_delete":false,"product_type":"c1","uid":1589430,"ip_address":"","ucode":"ADDADDB696130F","user_header":"https://thirdwx.qlogo.cn/mmopen/vi_32/hBbNOLicWdz7s3TricdpGeBZcibjcvW0FkLhs88FgaicBJmRofHeIKedZvPj2ib8RTyYia7kVMED3picOcB9VBdXjJJCA/132","comment_is_top":false,"comment_ctime":1566179237,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1566179237","product_id":100020801,"comment_content":"è€å¸ˆè¯·é—®ä¸€ä¸‹internal_tmp_disk_storage_engineè®¾ç½®æˆmysiamè¿˜æ˜¯innodbå¥½ä¸€äº›ï¼Œæˆ‘çœ‹é»˜è®¤çš„æ˜¯innodbï¼Œä¸çŸ¥é“ä¸ºä»€ä¹ˆæˆ‘ä»¬ç³»ç»Ÿé‡Œè®¾ç½®çš„æ˜¯mysiam","like_count":0},{"had_liked":false,"id":121157,"user_name":"é’±","can_delete":false,"product_type":"c1","uid":1009652,"ip_address":"","ucode":"2C92A243A463D4","user_header":"https://static001.geekbang.org/account/avatar/00/0f/67/f4/9a1feb59.jpg","comment_is_top":false,"comment_ctime":1565067559,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1565067559","product_id":100020801,"comment_content":"å†…éƒ¨ä¸´æ—¶è¡¨ï¼Œå®Œå…¨å­˜åœ¨äºå†…å­˜ä¹‹ä¸­ï¼Œä¸ºå­˜æ”¾æŸ¥è¯¢çš„ä¸´æ—¶æ•°æ®è€Œç”Ÿï¼Œæ¯”å¦‚ï¼šä½¿ç”¨group by æˆ–è€… union çš„åœºæ™¯ï¼Œéœ€è¦å…ˆå°†æ•°æ®ä¸´æ—¶å­˜å‚¨ä¸€ä¸‹ï¼Œç„¶åå†åšä¸‹ä¸€æ­¥å¤„ç†ã€‚<br>å¦å¤–ï¼Œä½¿ç”¨group by æ¯”è¾ƒè€—æ€§èƒ½ï¼Œæ–‡ä¸­æä¾›äº†å‡ ç§ä¼˜åŒ–çš„å»ºè®®ã€‚<br>1ï¼šgroup by å­—æ®µåŠ ç´¢å¼•<br>2ï¼šæ‰©å¤§å†…éƒ¨ä¸´æ—¶è¡¨çš„å¤§å°<br>3ï¼šåˆ†ç»„åä¸éœ€è¦æ’åºï¼ŒåŠ ä¸Šorder by null<br>4ï¼šå¦‚æœæ•°æ®é‡æ¯”è¾ƒå¤§ï¼Œç›´æ¥ä½¿ç”¨ç£ç›˜ä¸´æ—¶è¡¨<br>å—¯ï¼Œè¿™ç¯‡ä¹Ÿå¾ˆå®ç”¨ï¼Œæ„Ÿè°¢è€å¸ˆçš„åˆ†äº«ã€‚","like_count":0},{"had_liked":false,"id":119230,"user_name":"å›å“¥èŠæŠ€æœ¯","can_delete":false,"product_type":"c1","uid":1325816,"ip_address":"","ucode":"2C9A22BCE4C79E","user_header":"https://static001.geekbang.org/account/avatar/00/14/3a/f8/c1a939e7.jpg","comment_is_top":false,"comment_ctime":1564540061,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1564540061","product_id":100020801,"comment_content":"è€å¸ˆï¼Œè¯·æ•™ä¸ªé—®é¢˜ï¼Œå¦‚æœtmp_table_sizeè®¾ç½®å¤ªå¤§ï¼Œæ¯”å¦‚1Gï¼Œä½†å®é™…ä½¿ç”¨çš„ç©ºé—´å¾ˆå°ï¼Œé‚£å¹¶å‘åœºæ™¯ä¸‹ï¼Œå†…å­˜æ˜¯ä¸æ˜¯ä¼šè¢«ç”¨å…‰ï¼Œä¸ºç”¨ç£ç›˜ä¸´æ—¶è¡¨å‘¢ï¼Ÿ","like_count":0},{"had_liked":false,"id":117140,"user_name":"ä½‘å„¿","can_delete":false,"product_type":"c1","uid":1226196,"ip_address":"","ucode":"0629888E7A5E16","user_header":"https://static001.geekbang.org/account/avatar/00/12/b5/d4/3bd5b77b.jpg","comment_is_top":false,"comment_ctime":1563976026,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1563976026","product_id":100020801,"comment_content":"set tmp_table_size=1024;<br>select id%100 as m, count(*) as c from t1 group by m order by null limit 10;<br>è€å¸ˆæ‚¨å¥½ï¼Œæœ‰ä¸€ä¸ªç–‘é—®ï¼Œè¿™ä¸ªä¾‹å­ä¸­ä¸ºä»€ä¹ˆå†…å­˜ä¸´æ—¶è¡¨å¤Ÿç”¨å’Œå†…å­˜ä¸´æ—¶è¡¨ä¸å¤Ÿç”¨è½¬æˆç£ç›˜ä¸´æ—¶è¡¨ï¼ŒæŸ¥è¯¢ç»“æœä¼šä¸ä¸€æ ·?æ„Ÿè§‰å¥½åƒå¦‚æœè½¬æˆç£ç›˜ä¸´æ—¶è¡¨è¢«æ’åºäº†","like_count":0},{"had_liked":false,"id":109393,"user_name":"ç§‹å¤©","can_delete":false,"product_type":"c1","uid":1057056,"ip_address":"","ucode":"A7E1D953EF7E17","user_header":"https://static001.geekbang.org/account/avatar/00/10/21/20/1299e137.jpg","comment_is_top":false,"comment_ctime":1562029468,"is_pvip":true,"discussion_count":0,"race_medal":0,"score":"1562029468","product_id":100020801,"comment_content":"group by çš„å‡ ç§å®ç°ç®—æ³•ï¼Œä»ä¸­å¯ä»¥æ€»ç»“ä¸€äº›ä½¿ç”¨çš„æŒ‡å¯¼...<br><br>æå®¢æ—¶é—´ç‰ˆæƒæ‰€æœ‰: https:&#47;&#47;time.geekbang.org&#47;column&#47;article&#47;80477","like_count":0},{"had_liked":false,"id":102316,"user_name":"çº¸ç‰‡äºº","can_delete":false,"product_type":"c1","uid":1358508,"ip_address":"","ucode":"84490E7CEF59A4","user_header":"https://static001.geekbang.org/account/avatar/00/14/ba/ac/b44b256a.jpg","comment_is_top":false,"comment_ctime":1560191407,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1560191407","product_id":100020801,"comment_content":"æ—è€å¸ˆï¼Œè§å­—å®‰å¥½ï¼<br>åœ¨å°†æœ¬ç« åå¤çœ‹è¿‡å‡ éåï¼Œæˆ‘äº§ç”Ÿäº†è¯¸å¤šé—®é¢˜ï¼Œæ³è¯·æ‚¨æ‹¨å†—å›ç­”ã€‚<br>1ã€é¦–å…ˆï¼Œå†…å­˜ä¸´æ—¶è¡¨çš„äºŒç»´è¡¨ç»“æ„æ˜¯ä»€ä¹ˆï¼Ÿä»group byå¤„ç†é€»è¾‘çš„è¡¨è¿°æ¥çœ‹ï¼Œæ—¢è¦æ–¹ä¾¿æŸ¥é‡ï¼Œåˆè¦æ›´æ–°æ—§å€¼ï¼Œæ˜¾ç„¶å†…å­˜ä¸´æ—¶è¡¨éœ€è¦å‡ºè‰²çš„å®šä½èƒ½åŠ›ã€‚è¿™æ–¹é¢ï¼ŒHashè¡¨æ¯”äºŒç»´æ•°ç»„æ›´é«˜æ•ˆã€‚æ‰€ä»¥ç¤ºä¾‹ä¸­çš„å†…å­˜ä¸´æ—¶è¡¨æ˜¯ä»¥mä¸ºkeyï¼Œcä¸ºvalueçš„HashMapå—ï¼Ÿ<br>2ã€å¦‚æœæŸ¥è¯¢è¯­å¥ä¸­æœ‰å¤šä¸ªgroupå­—æ®µï¼ŒMySQLä¼šåˆ›å»ºå¤šå¼ å†…å­˜ä¸´æ—¶è¡¨å—ï¼Ÿè¿˜æ˜¯åœ¨å†…å­˜ä¸´æ—¶è¡¨ä¸ŠåŠ ä¸€ä¸ªå­—æ®µï¼Ÿ<br>3ã€è®¡ç®—countå€¼æ˜¯å¯ä»¥ç›´æ¥åœ¨æ—§å€¼ä¸Šå åŠ ã€‚å¦‚æœè®¡ç®—çš„æ˜¯argï¼Œé‚£ä¹ˆMySQLä¼šå¦‚ä½•å¤„ç†å‘¢ï¼Ÿåœ¨å†…å­˜è¡¨é‡Œæ·»å­—æ®µè¡¨ç¤ºè®¡æ•°å€¼ï¼Œæˆ–å…ˆsumå†countæœ€åé™¤ï¼Œè¿˜æ˜¯ç›´æ¥æ’åºåŒæ—¶æ±‚å’Œã€è®¡æ•°æ±‚å¹³å‡å€¼ï¼Ÿ<br>4ã€æˆ‘å°è¯•å°†group byçš„å¤„ç†é€»è¾‘å’Œä¼˜åŒ–é€»è¾‘è½¬æ¢æˆä¼ªä»£ç ï¼Œå–å¾—äº†ä»¥ä¸‹å‘ç°ã€‚<br>&gt; group byå¤„ç†é€»è¾‘ï¼šåº”ç”¨ä¸´æ—¶è¡¨<br>\tfor id in t1<br>\t\tm = id%10<br>\t\tincr count(m) from tmp<br>\tend<br>\tsort tmp by m<br><br>&gt; group by+ç´¢å¼•ï¼šæé«˜åŸè¡¨ç©ºé—´æˆæœ¬ï¼Œå°†m = id%10å’Œsort mçš„è®¡ç®—æˆæœ¬å’Œåˆ†æ‘Šåˆ°æ’å…¥è¿‡ç¨‹ä¸­<br>\tfor m in t1<br>\t\tcount m<br>\tend<br><br>&gt; group byå¿«æ’ï¼šSQL_BIG_RESULT hint<br>\tfor id in t1<br>\t\tm = id%10<br>\t\tadd m into sort_buffer<br>\tend<br>\tsort m<br>\tfor m in sort_buffer<br>\t\tcount m<br>\tend<br><br>å‘ç°1ï¼šgroup byéœ€è¦ä¼˜åŒ–çš„åŸå› æ˜¯tmpçš„æ„é€ æˆæœ¬å¤ªé«˜äº†ï¼Œå·²çŸ¥å…¶ä¸º(m,c)äºŒå…ƒç»„ã€‚<br>å‘ç°2ï¼šmçš„è®¡ç®—è¿‡ç¨‹å’Œæ’åºè¿‡ç¨‹ä¸å¯çœç•¥ã€‚æ­£å¸¸å¤„ç†é€»è¾‘ä¸­ï¼Œéœ€è¦incrè®¡æ•°å€¼ï¼Œæ‰€ä»¥å¯¹åœ¨tmpä¸­å®šä½mçš„è¦æ±‚æ¯”è¾ƒé«˜ï¼Œsortå¯¹è±¡æ˜¯tmpï¼Œæ¯”ç›´æ¥å¯¹mæ’åºå¤šå¸¦ä¸€ä¸ªå±æ€§cï¼Œæ‰€ä»¥å†…å­˜å ç”¨ç‡é«˜ã€‚ç´¢å¼•æ–¹æ¡ˆä¸­ï¼Œå°†å¤§éƒ¨åˆ†è®¡ç®—æˆæœ¬è½¬æ¢æˆäº†ç©ºé—´æˆæœ¬æˆ–å¹³æ‘Šåˆ°è®°å½•çš„æ’å…¥è¿‡ç¨‹ä¸­äº†ã€‚å¿«æ’æ–¹æ¡ˆä¸­ï¼Œsortæ•°é‡ç­‰äºt1è¡Œæ•°ï¼Œå†…å­˜æˆæœ¬ä¸å¤ªä½ï¼Œä¸ç¡®å®šæ˜¯å¦å°äºtmpæ„é€ æˆæœ¬ã€‚å¿«æ’æœ€åç»Ÿè®¡çš„æ€è·¯å’Œç´¢å¼•æ–¹æ¡ˆæ—¶ç›¸åŒï¼Œéƒ½æ˜¯â€œé¡ºåºæ‰«æï¼Œä¾æ¬¡ç´¯åŠ â€ï¼Œæ‰€ä»¥æ¯”å‰äºŒè€…å¤šä¸€æ¬¡å¾ªç¯ã€‚æ€»ä¹‹ï¼Œæˆ‘çš„åˆ¤æ–­æ˜¯ç´¢å¼•æ–¹æ¡ˆçš„å“åº”é€Ÿåº¦æœ€å¿«ï¼Œå¿«æ’æ–¹æ¡ˆå’Œä¸´æ—¶è¡¨æ–¹æ¡ˆå­°ä¼˜å­°åŠ£åº”ç”±mçš„è®¡ç®—æ–¹å¼å†³å®šã€‚æ¯”å¦‚ç¤ºä¾‹ä¸­m=id%10ï¼Œä¸´æ—¶è¡¨çš„è§„æ¨¡æ˜¯10ï¼Œè€Œsort_bufferçš„è§„æ¨¡æ˜¯1000ã€‚æ˜¾ç„¶ï¼Œå¿«æ’ä¸ä¸€å®šä¼˜äºä¸´æ—¶è¡¨ã€‚<br><br>ä¸çŸ¥é“æˆ‘å¯¹groupå¤„ç†æµç¨‹çš„â€œç¿»è¯‘â€å’Œæ¨æ–­æ˜¯å¦æ­£ç¡®ï¼Ÿè¯·æ—è€å¸ˆæŒ‡æ­£ã€‚","like_count":0},{"had_liked":false,"id":96647,"user_name":"HKM","can_delete":false,"product_type":"c1","uid":1155118,"ip_address":"","ucode":"48EE9F58CF8E75","user_header":"https://static001.geekbang.org/account/avatar/00/11/a0/2e/82559d5b.jpg","comment_is_top":false,"comment_ctime":1558484117,"is_pvip":false,"replies":[{"id":"34894","content":"MySQLè‡ªå¸¦çš„å®¢æˆ·ç«¯","user_name":"ä½œè€…å›å¤","user_name_real":"æ—æ™“æ–Œ","uid":"1264162","ctime":1558708761,"ip_address":"","comment_id":96647,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1558484117","product_id":100020801,"comment_content":"è€å¸ˆç”¨çš„ä»€ä¹ˆå®¢æˆ·ç«¯å‘¢ğŸ‘","like_count":0,"discussions":[{"author":{"id":1264162,"avatar":"https://static001.geekbang.org/account/avatar/00/13/4a/22/2681d602.jpg","nickname":"æ—æ™“æ–Œ","note":"","ucode":"CDE42D44F26240","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":450952,"discussion_content":"MySQLè‡ªå¸¦çš„å®¢æˆ·ç«¯","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1558708761,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":86692,"user_name":"çœ‹ä¸åˆ°deé¢œè‰²","can_delete":false,"product_type":"c1","uid":1162714,"ip_address":"","ucode":"88348CCAE81931","user_header":"https://static001.geekbang.org/account/avatar/00/11/bd/da/3d76ea74.jpg","comment_is_top":false,"comment_ctime":1555426778,"is_pvip":false,"discussion_count":1,"race_medal":0,"score":"1555426778","product_id":100020801,"comment_content":"å…³äºå›¾4æœ‰ä¸ªç–‘æƒ‘ï¼Œè¿˜æƒ³è¯·è€å¸ˆè§£ç­”ä¸€ä¸‹ã€‚æˆ‘è®°å¾—mysqlè¯­å¥æ‰§è¡Œå¾ªåºåº”è¯¥æ˜¯from-&gt;where-&gt;group by-&gt;having-&gt;select-&gt;order-&gt;limitã€‚é‚£ä¹ˆä¸ºä»€ä¹ˆå›¾å››ä¸­åœ¨selectè¯­å¥ä¸­èµ·çš„åˆ«åmå¯ä»¥ç”¨åœ¨group byä¸­ä½œä¸ºåˆ†ç»„æ¡ä»¶å‘¢ï¼ŸæŒ‰ç†è¯´ä¸åº”è¯¥æ˜¯å…ˆèµ°group byæ²¡æœ‰må­—æ®µæŠ¥é”™å—ï¼Ÿï¼ˆè¯•éªŒäº†ä¸€ä¸‹ï¼Œç¡®å®å¦‚è€å¸ˆå®ä¾‹ä¸­é‚£æ ·æ‰§è¡Œï¼Œä½†æ˜¯ç†è®ºä¸Šæƒ³ä¸é€šï¼‰","like_count":0,"discussions":[{"author":{"id":1226968,"avatar":"https://static001.geekbang.org/account/avatar/00/12/b8/d8/f81b5604.jpg","nickname":"hcyycb","note":"","ucode":"77FF6CA41F9E66","race_medal":0,"user_type":1,"is_pvip":true},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":6890,"discussion_content":"å¯ä¸å¯ä»¥ç†è§£æˆåˆ«åã€‚mysql åœ¨åˆ†æå™¨é˜¶æ®µå°±å¯¹ SQL  çš„è¯­æ³•è¿›è¡Œåˆ†æï¼ŒçŸ¥é“å®¢æˆ·ç«¯å‘½åçš„å„ä¸ªåˆ«åä¿¡æ¯ï¼Œæ‰€ä»¥ï¼Œåœ¨group by çš„æ—¶å€™ï¼Œåˆ«åå’ŒåŸæ¥çš„åå­—æ˜¯äº’é€šçš„ï¼Œmysql èƒ½ç†è§£ã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1567154778,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":83070,"user_name":"åˆ€æ–§æ‰‹ä½•åœ¨","can_delete":false,"product_type":"c1","uid":1202572,"ip_address":"","ucode":"B99D7ECC3EE954","user_header":"https://static001.geekbang.org/account/avatar/00/12/59/8c/ba81a832.jpg","comment_is_top":false,"comment_ctime":1554392535,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1554392535","product_id":100020801,"comment_content":"å¦‚æœ group by éœ€è¦ç»Ÿè®¡çš„æ•°æ®é‡ä¸å¤§ï¼Œå°½é‡åªä½¿ç”¨å†…å­˜ä¸´æ—¶è¡¨ï¼›<br>å°½é‡ä½¿ç”¨å†…å­˜ä¸´æ—¶è¡¨ è€Œä¸åŠ SQL_BIG_RESULT æ˜¯ä¸æ˜¯å› ä¸ºSQL_BIG_RESULT ä¸åˆ†ç»„å°±æ’åº å ç”¨å¤ªå¤šçš„sort buff ç©ºé—´ ä»è€Œå½±å“åŒæ—¶é—´æ®µå†…çš„å…¶ä»–MySQL æŸ¥è¯¢ã€‚<br>æœ€è¿‘æœ‰ä¸ªSQL <br>select sumï¼ˆstudent_activeï¼‰ï¼Œschool_id from dt_school_day  goupy by school æ‰«æ300ä¸‡è¡Œ æ‰§è¡Œ2s å¤šã€‚ç„¶åæˆ‘åŠ ä¸ŠSQL_BIG_RESULT åªéœ€è¦0.4s <br>æƒ³è¯·æ•™ä¸€ä¸‹è€å¸ˆ ä¸ºå•¥ç›´æ¥ä½¿ç”¨sort buff å°±èƒ½å¿«æ€ä¹ˆå¤š ä¸åˆ†ç»„ ç›´æ¥æ’åº æ’åºçš„æ•°æ®å¤šäº†ï¼Œåº”è¯¥æ˜¯æ—¶é—´ä¼šæ…¢ä¸€ä¸‹ ã€‚æ˜¯å› ä¸ºæ•°æ®é‡å¤šæ—¶ ä¸´æ—¶è¡¨ åˆ†ç»„æ—¶é—´ å¤ªä¹…ã€‚å†åŠ ä¸Šåˆ†ç»„è¿‡ç¨‹ä¸­ ä¸´æ—¶è¡¨ ä¸å¤Ÿç”¨ åˆæ”¹åˆ‡ç£ç›˜è¡¨ è¿™å—è€—æ—¶å¤ªå¤šå—ï¼Ÿè¿˜æœ‰å°±æ˜¯ ä¸æ¨èä½¿ç”¨ SQL_BIG_RESULTå—ï¼Œç”¨è¿™ä¸ªæœ‰ä»€ä¹ˆå½±å“ï¼Ÿ<br>thx ","like_count":0},{"had_liked":false,"id":78550,"user_name":"ç‹æ—­ä¸œ","can_delete":false,"product_type":"c1","uid":1108106,"ip_address":"","ucode":"61950FD5D5BFF9","user_header":"https://static001.geekbang.org/account/avatar/00/10/e8/8a/e3032578.jpg","comment_is_top":false,"comment_ctime":1553173435,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1553173435","product_id":100020801,"comment_content":"è¯·é—®é’ˆå¯¹group byï¼Œå¦‚ä½•åšåˆ°å…ˆå¯¹è¡¨è¿›è¡Œorder byï¼Œå†åœ¨æ’åºåçš„é›†åˆé‡Œè¿›è¡Œgroup byåˆ†ç»„ï¼Ÿ<br>SELECT * FROM (SELECT * FROM my_table ORDER BY custom_column DESC) t<br> GROUP BY t.group_name;ä¸ç”Ÿæ•ˆ","like_count":0},{"had_liked":false,"id":73727,"user_name":"è¿›é˜¶çš„ç å†œ","can_delete":false,"product_type":"c1","uid":1017821,"ip_address":"","ucode":"D8991282640334","user_header":"https://static001.geekbang.org/account/avatar/00/0f/87/dd/4f53f95d.jpg","comment_is_top":false,"comment_ctime":1551964925,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1551964925","product_id":100020801,"comment_content":"order by range ä¹Ÿä¼šä½¿ç”¨ä¸´æ—¶è¡¨","like_count":0},{"had_liked":false,"id":66926,"user_name":"å¤œç©ºä¸­æœ€äº®çš„æ˜Ÿ","can_delete":false,"product_type":"c1","uid":1267566,"ip_address":"","ucode":"ADC3E7B6789955","user_header":"https://static001.geekbang.org/account/avatar/00/13/57/6e/b6795c44.jpg","comment_is_top":false,"comment_ctime":1550043042,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1550043042","product_id":100020801,"comment_content":"è¿‡å¹´å¥½ï¼Œè€å¸ˆã€‚è¿™å‘¨ è¡¥è¡¥è½ä¸‹çš„è¯¾","like_count":0},{"had_liked":false,"id":66900,"user_name":"Long","can_delete":false,"product_type":"c1","uid":1318970,"ip_address":"","ucode":"2417242560360A","user_header":"https://static001.geekbang.org/account/avatar/00/14/20/3a/90db6a24.jpg","comment_is_top":false,"comment_ctime":1550039315,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1550039315","product_id":100020801,"comment_content":"è€å¸ˆå¯èƒ½æ²¡çœ‹åˆ°ï¼Œå†å‘ä¸‹ã€‚<br>è€å¸ˆï¼Œæ–°å¹´å¥½ï¼ :-)<br><br>æœ‰å‡ ä¸ªç‰ˆæœ¬å·®å¼‚çš„é—®é¢˜ï¼š<br>ï¼ˆ1ï¼‰å›¾1ä¸­çš„æ‰§è¡Œè®¡åˆ’åº”è¯¥æ˜¯5.7ç‰ˆæœ¬ä»¥åçš„å§ï¼Œè²Œä¼¼æ²¡æ‰¾åˆ°è¯´åœ¨å“ªä¸ªç¯å¢ƒï¼Œæˆ‘åœ¨5.6å’Œ5.7åˆ†åˆ«æµ‹è¯•äº†ï¼Œid = 2çš„é‚£ä¸ªrowsï¼Œåœ¨5.6ç‰ˆæœ¬ï¼ˆ5.6.26ï¼‰æ˜¯1000ï¼Œåœ¨5.7ç‰ˆæœ¬æ˜¯2è¡Œã€‚åº”è¯¥æ˜¯5.7åšçš„ä¼˜åŒ–å§ï¼Ÿ<br><br>ï¼ˆ2ï¼‰å›¾ 9 group + order by null çš„ç»“æœï¼ˆæ­¤ç›˜ä¸´æ—¶è¡¨ï¼‰ï¼Œè¿™é‡Œé¢mysql5.6é‡Œé¢æ‰§è¡Œçš„ç»“æœæ˜¯ï¼ˆ1ï¼Œ10ï¼‰ï¼Œï¼ˆ2ï¼Œ10ï¼‰...(10ï¼Œ10)ï¼Œæ‰§è¡Œè®¡åˆ’éƒ½æ˜¯åªæœ‰ä¸€æ ·ï¼Œæ²¡æ‰¾åˆ°å·®å¼‚ã€‚<br>è·Ÿè¸ªä¸‹äº†ä¸‹optimizer traceï¼Œå‘ç°é—®é¢˜åº”è¯¥æ˜¯åœ¨ä¸´æ—¶è¡¨ç©ºé—´æ»¡çš„çš„æ—¶å€™ï¼Œmysql5.7ç”¨çš„æ˜¯ï¼šconverting_tmp_table_to_ondisk &quot;location&quot;: &quot;disk (InnoDB)&quot;,ï¼Œè€Œmysql 5.6ç”¨çš„æ˜¯converting_tmp_table_to_myisam &quot;location&quot;: &quot;disk (MyISAM)&quot;çš„åŸå› å¯¼è‡´çš„ã€‚<br>æŸ¥äº†ä¸‹å‚æ•°ï¼š<br>default_tmp_storage_engineã€‚ï¼ˆ5.6ï¼Œ5.7å½“å‰å€¼éƒ½æ˜¯innodbï¼‰<br>internal_tmp_disk_storage_engineï¼ˆåªæœ‰5.7æœ‰è¿™ä¸ªå‚æ•°ï¼Œå½“å‰å€¼æ˜¯innodbï¼‰ï¼Œ5.6åº”è¯¥æ˜¯é»˜è®¤ç£ç›˜ä¸´æ—¶è¡¨å°±æ˜¯MyISAMå¼•æ“çš„äº†ï¼Œç”±äºæœ¬åœ°æµ‹è¯•ç¯å¢ƒé‚£ä¸ªä¸´æ—¶è¡¨çš„ç›®å½•ä¸‹æ‰¾ä¸åˆ°ä¸´æ—¶æ–‡ä»¶ï¼Œä¹Ÿæ²¡æ³•ç»§ç»­åˆ†æäº†ã€‚ã€‚ã€‚<br><br>è‡³äºä¸ºä»€ä¹ˆMySQL 5.6ä¸­ç»“æœå±•ç¤ºmå­—æ®µä¸æ˜¯0-9è€Œæ˜¯1-10ï¼Œè¿˜å¾—è¯·è€å¸ˆå¸®å¿™è§£ç­”ä¸‹äº†ã€‚<br><br><br>è¿˜æœ‰å‡ ä¸ªå°é—®é¢˜ï¼Œä¸ºäº†æ–¹ä¾¿è§£ç­”ï¼Œåºå·ç»Ÿä¸€äº†ï¼š<br>ï¼ˆ3ï¼‰åœ¨é˜…è¯»mysqlæ‰§è¡Œè®¡åˆ’çš„æ—¶å€™ï¼Œçœ‹äº†ç½‘ä¸Šæœ‰å¾ˆå¤šè¯´æ³•ï¼Œä¹Ÿå‚è€ƒäº†mysqlå®˜ç½‘å¯¹idï¼ˆselect_idï¼‰çš„è§£é‡Šï¼š<br>id (JSON name: select_id)<br>The SELECT identifier. This is the sequential number of the SELECT within the query.ï¼ˆæ„Ÿè§‰è¿™ä¸ªè¯»èµ·æ¥ä¹Ÿæœ‰ç‚¹æ­§ä¹‰ï¼Œè¿™ä¸ªsequentialå­—é¢è§£é‡Šæ„Ÿè§‰åªæœ‰é¡ºåºçš„å·ç ï¼Œå¹¶å’©æœ‰è¯´æ‰§è¡Œé¡ºåºï¼‰<br>æ¯”å¦‚å›¾1ï¼Œæ–‡ä¸­è§£é‡Šå°±æ˜¯ä»IDå°çš„å¾€å¤§çš„æ‰§è¡Œçš„ï¼Œç½‘ä¸Šæœ‰å¾ˆå¤šå…¶ä»–è¯´æ³•ï¼Œæœ‰çš„æ˜¯è¯´IDä»å¤§åˆ°å°æ‰§è¡Œï¼Œé‡åˆ°IDä¸€æ ·çš„ï¼Œå°±ä»ä¸Šå¾€ä¸‹æ‰§è¡Œã€‚æœ‰çš„è¯´æ˜¯ä»å°å¾€å¤§é¡ºåºæ‰§è¡Œã€‚ä¸çŸ¥é“è€å¸ˆæ˜¯å¦å¯ä»¥å®˜æ–¹è®²è§£ä¸‹ã€‚<br><br>ï¼ˆ4ï¼‰æˆ‘å‘ç°æƒ³ææ‡‚ä¸€ä¸ªåŸç†ï¼Œå¹¶ä¸”è®²æ¸…æ¥šè®©åˆ«äººæ˜ç™½ï¼ŒçœŸçš„æ˜¯å¾ˆæœ‰éš¾åº¦ï¼Œéå¸¸æ„Ÿè°¢è€å¸ˆçš„åˆ†äº«ã€‚è¿™æ¬¡ä¸“æ ç»“æŸï¼Œè¿˜ä¼šæ¨å‡ºçš„æ–°çš„ä¸“æ å—ï¼Ÿ éå¸¸æœŸå¾…ã€‚","like_count":0},{"had_liked":false,"id":66524,"user_name":"è¿˜ä¸€æ£µæ ‘","can_delete":false,"product_type":"c1","uid":1317709,"ip_address":"","ucode":"C187F2A141D60E","user_header":"http://thirdwx.qlogo.cn/mmopen/vi_32/DYAIOgq83eop9WylZJicLQxlvXukXUgPp39zJHyyReK5s1C9VhA6rric7GiarbfQMuWhdCCDdxdfL610Hc4cNkn9Q/132","comment_is_top":false,"comment_ctime":1549952926,"is_pvip":false,"replies":[{"id":"23577","content":"å—¯ è¯­ä¹‰å°±æ˜¯è¿™ä¹ˆå®šä¹‰çš„ï¼Œå¦‚æœä¸éœ€è¦æ’åºï¼Œè¦æ‰‹åŠ¨åŠ ä¸Š order by null å“ˆ","user_name":"ä½œè€…å›å¤","user_name_real":"æ—æ™“æ–Œ","uid":"1264162","ctime":1549978133,"ip_address":"","comment_id":66524,"utype":1}],"discussion_count":2,"race_medal":0,"score":"1549952926","product_id":100020801,"comment_content":"group by æ‰§è¡Œæµç¨‹é‡Œé¢ï¼Œä¸ºä»€ä¹ˆæœ‰æœ€åæ’åºæ“ä½œï¼Œæ„Ÿè§‰è¿™ä¸€æ­¥æ˜¯å¤šä½™çš„ï¼Œæ‰«æå®Œæœ€åä¸€è¡Œæ•°æ®å ï¼Œå®Œå…¨å¯ä»¥ç›´æ¥ä»temporaryè¡¨è¿”å›æ•°æ®","like_count":0,"discussions":[{"author":{"id":1264162,"avatar":"https://static001.geekbang.org/account/avatar/00/13/4a/22/2681d602.jpg","nickname":"æ—æ™“æ–Œ","note":"","ucode":"CDE42D44F26240","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":438821,"discussion_content":"å—¯ è¯­ä¹‰å°±æ˜¯è¿™ä¹ˆå®šä¹‰çš„ï¼Œå¦‚æœä¸éœ€è¦æ’åºï¼Œè¦æ‰‹åŠ¨åŠ ä¸Š order by null å“ˆ","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1549978133,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1036567,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/d1/17/356cc426.jpg","nickname":"å½’å¿ƒ","note":"","ucode":"985E3188A9F6FE","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":3210,"discussion_content":"8.0ç‰ˆæœ¬å°±æ²¡æœ‰äº†æ’åºæ“ä½œ","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1564306405,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":65751,"user_name":"Laputa","can_delete":false,"product_type":"c1","uid":1079345,"ip_address":"","ucode":"64C157042CF138","user_header":"https://static001.geekbang.org/account/avatar/00/10/78/31/c7f8d1db.jpg","comment_is_top":false,"comment_ctime":1549618575,"is_pvip":false,"replies":[{"id":"23258","content":"MySQL è¯­ä¹‰ä¸Šè¿™ä¹ˆå®šä¹‰çš„â€¦ ","user_name":"ä½œè€…å›å¤","user_name_real":"æ—æ™“æ–Œ","uid":"1264162","ctime":1549637598,"ip_address":"","comment_id":65751,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1549618575","product_id":100020801,"comment_content":"è€å¸ˆå¥½ï¼Œæ–‡ä¸­è¯´çš„ä¸éœ€è¦æ’åºä¸ºä»€ä¹ˆä¸ç›´æ¥æŠŠorderbyå»æ‰è€Œæ˜¯å†™order by null","like_count":0,"discussions":[{"author":{"id":1264162,"avatar":"https://static001.geekbang.org/account/avatar/00/13/4a/22/2681d602.jpg","nickname":"æ—æ™“æ–Œ","note":"","ucode":"CDE42D44F26240","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":438574,"discussion_content":"MySQL è¯­ä¹‰ä¸Šè¿™ä¹ˆå®šä¹‰çš„â€¦ ","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1549637598,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":65659,"user_name":"HuaMax","can_delete":false,"product_type":"c1","uid":1118488,"ip_address":"","ucode":"2E78DE1AF098AF","user_header":"https://static001.geekbang.org/account/avatar/00/11/11/18/8cee35f9.jpg","comment_is_top":false,"comment_ctime":1549545453,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1549545453","product_id":100020801,"comment_content":"è¯¾åé¢˜è§£ç­”ã€‚å›¾8æ˜¯ç”¨å†…å­˜ä¸´æ—¶è¡¨ï¼Œæ–‡ä¸­å·²ç»æåˆ°ï¼Œæ˜¯æŒ‰ç…§è¡¨t1çš„ç´¢å¼•aé¡ºåºå–å‡ºæ•°æ®ï¼Œæ¨¡10å¾—0çš„idæ˜¯æœ€åä¸€è¡Œï¼›å›¾9æ˜¯ç”¨ç¡¬ç›˜ä¸´æ—¶è¡¨ï¼Œé»˜è®¤ç”¨innodb çš„ç´¢å¼•ï¼Œä¸»é”®æ˜¯id%10ï¼Œå› æ­¤å­˜å…¥ç¡¬ç›˜åå†æŒ‰ä¸»é”®æ ‘é¡ºåºå–å‡ºï¼Œ0å°±æ’åˆ°ç¬¬ä¸€è¡Œäº†ã€‚","like_count":0}]}