{"id":425013,"title":"åŠ é¤ï½œæœŸä¸­æµ‹è¯•ï¼šæ¥å†™ä¸€ä¸ªç®€å•çš„grepå‘½ä»¤è¡Œ","content":"<p>ä½ å¥½ï¼Œæˆ‘æ˜¯é™ˆå¤©ã€‚</p><p>ç°åœ¨ Rust åŸºç¡€ç¯‡å·²ç»å­¦å®Œäº†ï¼Œç›¸ä¿¡ä½ å·²ç»æœ‰è¶³å¤Ÿçš„ä¿¡å¿ƒå»åº”å¯¹ä¸€äº›ç®€å•çš„å¼€å‘ä»»åŠ¡ã€‚ä»Šå¤©æˆ‘ä»¬å°±æ¥ä¸ªæœŸä¸­æµ‹è¯•ï¼Œå®é™…è€ƒå¯Ÿä¸€ä¸‹ä½ å¯¹ Rust è¯­è¨€çš„ç†è§£ä»¥åŠå¯¹æ‰€å­¦çŸ¥è¯†çš„åº”ç”¨æƒ…å†µã€‚</p><p>æˆ‘ä»¬è¦åšçš„å°å·¥å…·æ˜¯ rgrepï¼Œå®ƒæ˜¯ä¸€ä¸ªç±»ä¼¼ grep çš„å·¥å…·ã€‚å¦‚æœä½ æ˜¯ä¸€ä¸ª *nix ç”¨æˆ·ï¼Œé‚£å¤§æ¦‚ç‡ä½¿ç”¨è¿‡ grep æˆ–è€… ag è¿™æ ·çš„æ–‡æœ¬æŸ¥æ‰¾å·¥å…·ã€‚</p><p>grep å‘½ä»¤ç”¨äºæŸ¥æ‰¾æ–‡ä»¶é‡Œç¬¦åˆæ¡ä»¶çš„å­—ç¬¦ä¸²ã€‚å¦‚æœå‘ç°æŸä¸ªæ–‡ä»¶çš„å†…å®¹ç¬¦åˆæ‰€æŒ‡å®šçš„å­—ç¬¦ä¸²ï¼Œgrep å‘½ä»¤ä¼šæŠŠå«æœ‰å­—ç¬¦ä¸²çš„é‚£ä¸€è¡Œæ˜¾ç¤ºå‡ºï¼›è‹¥ä¸æŒ‡å®šä»»ä½•æ–‡ä»¶åç§°ï¼Œæˆ–æ˜¯æ‰€ç»™äºˆçš„æ–‡ä»¶åä¸º&nbsp;<strong>-</strong>ï¼Œgrep å‘½ä»¤ä¼šä»æ ‡å‡†è¾“å…¥è®¾å¤‡è¯»å–æ•°æ®ã€‚</p><p>æˆ‘ä»¬çš„ rgrep è¦ç¨å¾®ç®€å•ä¸€äº›ï¼Œå®ƒå¯ä»¥æ”¯æŒä»¥ä¸‹ä¸‰ç§ä½¿ç”¨åœºæ™¯ï¼š</p><p>é¦–å…ˆæ˜¯æœ€ç®€å•çš„ï¼Œç»™å®šä¸€ä¸ªå­—ç¬¦ä¸²ä»¥åŠä¸€ä¸ªæ–‡ä»¶ï¼Œæ‰“å°å‡ºæ–‡ä»¶ä¸­æ‰€æœ‰åŒ…å«è¯¥å­—ç¬¦ä¸²çš„è¡Œï¼š</p><pre><code class=\"language-plain\">$ rgrep Hello a.txt\n55: Hello world. This is an exmaple text\n</code></pre><p>ç„¶åæ”¾å®½é™åˆ¶ï¼Œå…è®¸ç”¨æˆ·æä¾›ä¸€ä¸ªæ­£åˆ™è¡¨è¾¾å¼ï¼Œæ¥æŸ¥æ‰¾æ–‡ä»¶ä¸­æ‰€æœ‰åŒ…å«è¯¥å­—ç¬¦ä¸²çš„è¡Œï¼š</p><pre><code class=\"language-plain\">$ rgrep Hel[^\\\\s]+ a.txt\n55: Hello world. This is an exmaple text\n89: Help me! I need assistant!\n</code></pre><!-- [[[read_end]]] --><p>å¦‚æœè¿™ä¸ªä¹Ÿå¯ä»¥å®ç°ï¼Œé‚£è¿›ä¸€æ­¥æ”¾å®½é™åˆ¶ï¼Œå…è®¸ç”¨æˆ·æä¾›ä¸€ä¸ªæ­£åˆ™è¡¨è¾¾å¼ï¼Œæ¥æŸ¥æ‰¾æ»¡è¶³æ–‡ä»¶é€šé…ç¬¦çš„æ‰€æœ‰æ–‡ä»¶ï¼ˆä½ å¯ä»¥ä½¿ç”¨ <a href=\"https://docs.rs/globset/0.4.8/globset/\">globset</a> æˆ–è€… <a href=\"https://docs.rs/glob/0.3.0/glob/\">glob</a> æ¥å¤„ç†é€šé…ç¬¦ï¼‰ï¼Œæ¯”å¦‚ï¼š</p><pre><code class=\"language-plain\">$ rgrep Hel[^\\\\s]+ a*.txt\na.txt \n    55:1 Hello world. This is an exmaple text\n    89:1 Help me! I need assistant!\n    5:6  Use `Help` to get help.\nabc.txt:\n    100:1 Hello Tyr!\n</code></pre><p>å…¶ä¸­ï¼Œå†’å·å‰é¢çš„æ•°å­—æ˜¯è¡Œå·ï¼Œåé¢çš„æ•°å­—æ˜¯å­—ç¬¦åœ¨è¿™ä¸€è¡Œçš„ä½ç½®ã€‚</p><p>ç»™ä½ ä¸€ç‚¹å°æç¤ºã€‚</p><ul>\n<li>å¯¹äºå‘½ä»¤è¡Œçš„éƒ¨åˆ†ï¼Œä½ å¯ä»¥ä½¿ç”¨ <a href=\"https://docs.rs/clap/3.0.0-beta.4/clap/index.html\">clap3</a> æˆ–è€… <a href=\"https://docs.rs/structopt/0.3.23/structopt/\">structopt</a>ï¼Œä¹Ÿå¯ä»¥å°±ç”¨ env.args()ã€‚</li>\n<li>å¯¹äºæ­£åˆ™è¡¨è¾¾å¼çš„æ”¯æŒï¼Œå¯ä»¥ä½¿ç”¨ <a href=\"https://github.com/rust-lang/regex\">regex</a>ã€‚</li>\n<li>è‡³äºæ–‡ä»¶çš„è¯»å–ï¼Œå¯ä»¥ä½¿ç”¨ <a href=\"https://doc.rust-lang.org/std/fs/index.html\">std::fs</a> æˆ–è€… <a href=\"https://docs.rs/tokio/1.12.0/tokio/fs/index.html\">tokio::fs</a>ã€‚ä½ å¯ä»¥é¡ºåºå¯¹æ‰€æœ‰æ»¡è¶³é€šé…ç¬¦çš„æ–‡ä»¶è¿›è¡Œå¤„ç†ï¼Œä¹Ÿå¯ä»¥ç”¨ <a href=\"https://docs.rs/rayon/1.5.1/rayon/\">rayon</a> æˆ–è€… <a href=\"https://docs.rs/tokio/1.12.0/tokio/\">tokio</a> æ¥å¹¶è¡Œå¤„ç†ã€‚</li>\n<li>å¯¹äºè¾“å‡ºçš„ç»“æœï¼Œæœ€å¥½èƒ½æŠŠåŒ¹é…çš„æ–‡å­—ç”¨ä¸åŒé¢œè‰²å±•ç¤ºã€‚</li>\n</ul><p><img src=\"https://static001.geekbang.org/resource/image/95/1f/95d87be96953d3655daf9c3yy8b6bf1f.png?wh=2356x1318\" alt=\"\" title=\"ä¾‹å¦‚è¿™æ ·çš„è¾“å‡º\"></p><p>å¦‚æœä½ æœ‰ä½™åŠ›ï¼Œå¯ä»¥çœ‹çœ‹ grep çš„æ–‡æ¡£ï¼Œå°è¯•å®ç°æ›´å¤šçš„åŠŸèƒ½ã€‚</p><p>ç¥ä½ å¥½è¿ï¼</p><p>åŠ æ²¹ï¼Œæˆ‘ä»¬ä¸‹èŠ‚è¯¾ä½œä¸šè®²è§£è§ã€‚</p>","neighbors":{"left":{"article_title":"22ï½œé˜¶æ®µå®æ“ï¼ˆ2ï¼‰ï¼šæ„å»ºä¸€ä¸ªç®€å•çš„KV server-åŸºæœ¬æµç¨‹","id":425005},"right":{"article_title":"åŠ é¤ï½œæœŸä¸­æµ‹è¯•ï¼šå‚è€ƒå®ç°è®²è§£","id":425015}},"comments":[{"had_liked":false,"id":316439,"user_name":"Custer","can_delete":false,"product_type":"c1","uid":1020822,"ip_address":"","ucode":"8AEA5544C94D57","user_header":"https://static001.geekbang.org/account/avatar/00/0f/93/96/575d42c3.jpg","comment_is_top":false,"comment_ctime":1634304171,"is_pvip":true,"replies":[{"id":"114690","content":"ğŸ‘ éå¸¸å¥½ï¼","user_name":"ä½œè€…å›å¤","user_name_real":"Tyr","uid":"1079375","ctime":1634540253,"ip_address":"","comment_id":316439,"utype":1}],"discussion_count":1,"race_medal":0,"score":"10224238763","product_id":100085301,"comment_content":"<br>1. æœ€ç®€å•çš„<br>```rust<br>use std::error::Error;<br><br>use clap::{AppSettings, Clap};<br>use colored::Colorize;<br>use tokio::fs;<br><br>#[derive(Clap)]<br>#[clap(version = &quot;1.0&quot;, author = &quot;Custer&lt;custer@email.cn&gt;&quot;)]<br>#[clap(setting = AppSettings::ColoredHelp)]<br>struct Opts {<br>    find: String,<br>    path: String,<br>}<br><br>#[tokio::main]<br>async fn main() -&gt; Result&lt;(), Box&lt;dyn Error&gt;&gt; {<br>    &#47;&#47; 1. è§£æå‚æ•°<br>    let opts: Opts = Opts::parse();<br>    let find = opts.find;<br>    let path = opts.path;<br>    let length = find.len();<br><br>    &#47;&#47; 2. è¯»å–æ–‡ä»¶<br>    let contents = fs::read_to_string(path).await?;<br><br>    &#47;&#47; 3. åŒ¹é…å­—ç¬¦ä¸²<br>    for (row, line) in contents.lines().enumerate() {<br>        if let Some(col) = line.find(&amp;find) {<br>            println!(<br>                &quot;{}:{} {}{}{}&quot;,<br>                row + 1,<br>                col + 1,<br>                &amp;line[..col],<br>                &amp;line[col..col + length].red().bold(),<br>                &amp;line[col + length..]<br>            );<br>        }<br>    }<br>    Ok(())<br>}<br>```<br>2. å…è®¸ç”¨æˆ·æä¾›ä¸€ä¸ªæ­£åˆ™è¡¨è¾¾å¼ï¼Œæ¥æŸ¥æ‰¾æ–‡ä»¶ä¸­æ‰€æœ‰åŒ…å«è¯¥å­—ç¬¦ä¸²çš„è¡Œ<br>```rust<br>    &#47;&#47; 3. åŒ¹é…å­—ç¬¦ä¸²<br>    for (row, line) in contents.lines().enumerate() {<br>        if let Some(re) = Regex::new(find.as_str()).unwrap().find(line) {<br>            let start = re.start();<br>            let end = re.end();<br>            println!(<br>                &quot;{}:{} {}{}{}&quot;,<br>                row + 1,<br>                start + 1,<br>                &amp;line[..start],<br>                &amp;line[start..end].red().bold(),<br>                &amp;line[end..]<br>            );<br>        }<br>    }<br>```<br>3. å…è®¸ç”¨æˆ·æä¾›ä¸€ä¸ªæ­£åˆ™è¡¨è¾¾å¼ï¼Œæ¥æŸ¥æ‰¾æ»¡è¶³æ–‡ä»¶é€šé…ç¬¦çš„æ‰€æœ‰æ–‡ä»¶(å¥½åƒå¹¶ä¸éœ€è¦ä½¿ç”¨globset æˆ–è€… glob å°±å¯ä»¥å¤„ç†é€šé…ç¬¦ï¼Ÿï¼‰<br><br>```rust<br>...<br>struct Opts {<br>    find: String,<br>    #[clap(multiple_values = true)]<br>    paths: Vec&lt;String&gt;,<br>}<br><br>#[tokio::main]<br>async fn main() -&gt; Result&lt;(), Box&lt;dyn Error&gt;&gt; {<br>    &#47;&#47; 1. è§£æå‚æ•°<br>    let opts: Opts = Opts::parse();<br>    let find = opts.find.as_str();<br>    let paths = opts.paths;<br><br>    &#47;&#47; 2. å¾ªç¯è¯»å–åŒ¹é…åˆ°çš„æ–‡ä»¶<br>    for path in paths {<br>        println!(&quot;{:?}&quot;, path);<br>        let contents = fs::read_to_string(path).await?;<br><br>        &#47;&#47; 3. åŒ¹é…å­—ç¬¦ä¸²<br>        ...<br>    }<br>    Ok(())<br>}<br>```","like_count":3,"discussions":[{"author":{"id":1079375,"avatar":"https://static001.geekbang.org/account/avatar/00/10/78/4f/e74f870c.jpg","nickname":"Tyr","note":"","ucode":"EAAFC8063202E0","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":528384,"discussion_content":"ğŸ‘ éå¸¸å¥½ï¼","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1634540253,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":316672,"user_name":"ä½™æ³½é”‹","can_delete":false,"product_type":"c1","uid":1003207,"ip_address":"","ucode":"5AB1499746C003","user_header":"https://static001.geekbang.org/account/avatar/00/0f/4e/c7/8c2d0a3d.jpg","comment_is_top":false,"comment_ctime":1634485135,"is_pvip":false,"replies":[{"id":"114685","content":"å—¯ï¼Œä¸é”™ã€‚å¯ä»¥è¿›ä¸€æ­¥ä¼˜åŒ–ä¸€ä¸‹æ€§èƒ½ä»¥åŠå¯æµ‹è¯•æ€§ã€‚å»ºè®®çœ‹çœ‹æˆ‘çš„å‚è€ƒä»£ç ï¼šhttps:&#47;&#47;github.com&#47;tyrchen&#47;geektime-rust&#47;tree&#47;master&#47;mid_term_rgrep","user_name":"ä½œè€…å›å¤","user_name_real":"Tyr","uid":"1079375","ctime":1634539165,"ip_address":"","comment_id":316672,"utype":1}],"discussion_count":1,"race_medal":1,"score":"5929452431","product_id":100085301,"comment_content":"æ—¶é—´æ¯”è¾ƒç´§ï¼Œå…ˆå†™ä¸ªåˆå§‹ç‰ˆæœ¬ï¼š<br><br>extern crate clap;<br><br>use std::path::Path;<br>use std::ffi::OsStr;<br>use std::error::Error;<br><br>use clap::{Arg, App};<br>use regex::Regex;<br>use tokio::fs::{File, read_dir};<br>use tokio::io::AsyncReadExt;<br><br><br><br>#[tokio::main]<br>async fn main() -&gt; Result&lt;(), Box&lt;dyn Error&gt;&gt; {<br><br>    let matches = App::new(&quot;rgrep&quot;)<br>                        .version(&quot;1.0&quot;)<br>                        .about(&quot;Does awesome things&quot;)<br>                        .arg(Arg::with_name(&quot;key_word&quot;)<br>                                .index(1))<br>                        .arg(Arg::with_name(&quot;file&quot;)<br>                                .multiple(true)<br>                                .index(2))<br>                        .get_matches();<br>    println!(&quot;{:?}&quot;, matches);<br>    let key_word = matches.value_of(&quot;key_word&quot;).unwrap();<br>    println!(&quot;{}&quot;, key_word);<br>    let file_path = matches.values_of_lossy(&quot;file&quot;).unwrap();<br>    println!(&quot;{:?}&quot;, file_path);<br><br>    let re_key_word = format!(r&quot;{}&quot;, &amp;key_word);<br>    println!(&quot;re_key_word: {}&quot;, &amp;re_key_word);<br>    let re = Regex::new(&amp;re_key_word).unwrap();<br><br>    for file_path in file_path {<br>        <br>        let mut file = File::open(&amp;file_path).await?;<br>        &#47;&#47; let mut contents = vec![];<br>        let result = tokio::fs::read_to_string(&amp;file_path).await?;<br><br>        if let Some(caps) = re.captures(&amp;result) {<br>            println!(&quot;file_path: {:?}&quot;, &amp;file_path);<br>            println!(&quot;file: {:?}&quot;, &amp;file);<br>            println!(&quot;caps: {:?}&quot;, &amp;caps);<br>            println!(&quot;result: {:?}&quot;, &amp;result);<br>        }<br>    }<br><br>    Ok(())<br>}<br>","like_count":2,"discussions":[{"author":{"id":1079375,"avatar":"https://static001.geekbang.org/account/avatar/00/10/78/4f/e74f870c.jpg","nickname":"Tyr","note":"","ucode":"EAAFC8063202E0","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":528454,"discussion_content":"å—¯ï¼Œä¸é”™ã€‚å¯ä»¥è¿›ä¸€æ­¥ä¼˜åŒ–ä¸€ä¸‹æ€§èƒ½ä»¥åŠå¯æµ‹è¯•æ€§ã€‚å»ºè®®çœ‹çœ‹æˆ‘çš„å‚è€ƒä»£ç ï¼šhttps://github.com/tyrchen/geektime-rust/tree/master/mid_term_rgrep","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1634539165,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":316366,"user_name":"D. D","can_delete":false,"product_type":"c1","uid":2186992,"ip_address":"","ucode":"C416E5602C8814","user_header":"https://static001.geekbang.org/account/avatar/00/21/5e/f0/62d8cf9e.jpg","comment_is_top":false,"comment_ctime":1634287892,"is_pvip":true,"replies":[{"id":"114722","content":"å—¯ï¼Œå†™çš„å¾ˆä¸é”™ï¼Œå°¤å…¶æ˜¯ Display trait  çš„ä½¿ç”¨ã€‚æ¯”æˆ‘ç”¨ä¸€ä¸ªå‡½æ•°å¤„ç†æ›´å¥½ã€‚<br><br>impl Display for MatchLine&lt;&#39;_&gt;","user_name":"ä½œè€…å›å¤","user_name_real":"Tyr","uid":"1079375","ctime":1634571179,"ip_address":"","comment_id":316366,"utype":1}],"discussion_count":1,"race_medal":0,"score":"5929255188","product_id":100085301,"comment_content":"è¯•ç€å†™äº†ä¸€ä¸‹ï¼Œå®ç°å¾—æ¯”è¾ƒåŒ†å¿™ã€‚<br>ä¸ºäº†ç»ƒä¹ ä¹‹å‰å­¦è¿‡çš„å†…å®¹ï¼Œè¯•äº†å„ç§å†™æ³•ï¼Œåº”è¯¥ä¼šæœ‰å¾ˆå¤šä¸åˆç†çš„åœ°æ–¹ã€‚<br>è€Œä¸”æ²¡æœ‰åšå¹¶è¡ŒåŒ–ï¼Œå¸Œæœ›ä»¥åæœ‰æ—¶é—´å¯ä»¥åŠ ä¸Šï¼Œå¹¶æŠŠä»£ç é‡æ„å¾—æ›´å¥½ã€‚<br>https:&#47;&#47;github.com&#47;imag1ne&#47;grepr","like_count":1,"discussions":[{"author":{"id":1079375,"avatar":"https://static001.geekbang.org/account/avatar/00/10/78/4f/e74f870c.jpg","nickname":"Tyr","note":"","ucode":"EAAFC8063202E0","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":528370,"discussion_content":"å—¯ï¼Œå†™çš„å¾ˆä¸é”™ï¼Œå°¤å…¶æ˜¯ Display trait  çš„ä½¿ç”¨ã€‚æ¯”æˆ‘ç”¨ä¸€ä¸ªå‡½æ•°å¤„ç†æ›´å¥½ã€‚\n\nimpl Display for MatchLine&amp;lt;&amp;#39;_&amp;gt;","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1634571179,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":316222,"user_name":"å¤æ´›å…‹Moriaty","can_delete":false,"product_type":"c1","uid":2754785,"ip_address":"","ucode":"49BA020F04AB16","user_header":"https://static001.geekbang.org/account/avatar/00/2a/08/e1/b4748943.jpg","comment_is_top":false,"comment_ctime":1634205324,"is_pvip":false,"replies":[{"id":"114726","content":"æŒºä¸é”™çš„ï¼æµç¨‹å›¾ç”»çš„å¾ˆå¥½å•Šï¼Œå¯ä»¥æ”¾åˆ° Readme.md é‡Œ","user_name":"ä½œè€…å›å¤","user_name_real":"Tyr","uid":"1079375","ctime":1634571769,"ip_address":"","comment_id":316222,"utype":1}],"discussion_count":1,"race_medal":0,"score":"5929172620","product_id":100085301,"comment_content":"ç£•ç£•ç›¼ç›¼æäº†ä¸€å¤©ç»ˆäºå®ç°äº†è¿™ä¸€è®²çš„éœ€æ±‚ï¼ŒæœŸä¸­æµ‹è¯•ç®—æ˜¯é€šè¿‡äº†ã€‚è‡ªå·±åŠ¨æ‰‹å®ç°çš„è¿‡ç¨‹ä¸­æ”¶è·äº†éå¸¸å¤šçš„ä¸œè¥¿ã€‚ä»£ç ç»“æ„å‰å‰ååæ”¹äº†è®¸å¤šæ¬¡ï¼Œè¿˜è¾¾ä¸åˆ°å¼€å‘è¿‡ç¨‹ä¸­æ¥å£ä¸å˜åªæ˜¯å®ç°å˜çš„èƒ½åŠ›ã€‚æˆ‘æŠŠä»£ç ä»“åº“é“¾æ¥è´´åœ¨ä¸‹é¢ç®—æ˜¯çŒ®ä¸‘äº†ï¼Œè¯´å®è¯æœ‰ç‚¹ä¸å¥½æ„æ€æ‹¿å‡ºæ¥å“ˆå“ˆã€‚<br><br>https:&#47;&#47;github.com&#47;LgnMs&#47;rgrep","like_count":2,"discussions":[{"author":{"id":1079375,"avatar":"https://static001.geekbang.org/account/avatar/00/10/78/4f/e74f870c.jpg","nickname":"Tyr","note":"","ucode":"EAAFC8063202E0","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":528316,"discussion_content":"æŒºä¸é”™çš„ï¼æµç¨‹å›¾ç”»çš„å¾ˆå¥½å•Šï¼Œå¯ä»¥æ”¾åˆ° Readme.md é‡Œ","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1634571769,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":316026,"user_name":"è®°äº‹æœ¬","can_delete":false,"product_type":"c1","uid":1401568,"ip_address":"","ucode":"FA942636EE0CC8","user_header":"https://static001.geekbang.org/account/avatar/00/15/62/e0/d2ff52da.jpg","comment_is_top":false,"comment_ctime":1634111119,"is_pvip":false,"replies":[{"id":"115278","content":"å—¯ï¼Œä½ å¯ä»¥ç”¨ regex å¤„ç†ï¼Œæ›´æ–¹ä¾¿ä¸€äº›ã€‚ä½ ä¹Ÿå¯ä»¥çœ‹çœ‹ github ä»“åº“é‡Œçš„ä»£ç ï¼šhttps:&#47;&#47;github.com&#47;tyrchen&#47;geektime-rust&#47;tree&#47;master&#47;mid_term_rgrep","user_name":"ä½œè€…å›å¤","user_name_real":"Tyr","uid":"1079375","ctime":1635132102,"ip_address":"","comment_id":316026,"utype":1}],"discussion_count":1,"race_medal":0,"score":"5929078415","product_id":100085301,"comment_content":" let filename = std::env::args().nth(2).unwrap();<br>    let query = std::env::args().nth(1).unwrap();<br>    let case_sensitive = std::env::var(&quot;is_sens&quot;).is_err();<br><br>    let contents = std::fs::read_to_string(filename).unwrap();<br><br>    if case_sensitive {<br>        let mut i = 1;<br>        for v in contents.lines(){<br>            if v.contains(&amp;query){<br>                println!(&quot;{}:{}&quot;,i,v);<br>            }<br>            i+=1;<br>        }<br>    }else {<br>        let c =contents.lines().filter(|item|item.contains(&amp;query)).collect::&lt;Vec&lt;_&gt;&gt;();<br>        for i in 1..=c.len(){<br>            println!(&quot;{}:{}&quot;,i,c[i]);<br>        }<br>    }<br>","like_count":1,"discussions":[{"author":{"id":1079375,"avatar":"https://static001.geekbang.org/account/avatar/00/10/78/4f/e74f870c.jpg","nickname":"Tyr","note":"","ucode":"EAAFC8063202E0","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":528241,"discussion_content":"å—¯ï¼Œä½ å¯ä»¥ç”¨ regex å¤„ç†ï¼Œæ›´æ–¹ä¾¿ä¸€äº›ã€‚ä½ ä¹Ÿå¯ä»¥çœ‹çœ‹ github ä»“åº“é‡Œçš„ä»£ç ï¼šhttps://github.com/tyrchen/geektime-rust/tree/master/mid_term_rgrep","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1635132102,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":348107,"user_name":"forever è’™","can_delete":false,"product_type":"c1","uid":2991652,"ip_address":"","ucode":"472EB8946A3F96","user_header":"https://static001.geekbang.org/account/avatar/00/2d/a6/24/961129f1.jpg","comment_is_top":false,"comment_ctime":1654746896,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1654746896","product_id":100085301,"comment_content":"<br>error: The following required arguments were not provided:<br>    &lt;PATTERN&gt;<br>    &lt;GLOB&gt;<br><br>USAGE:<br>    rgrep.exe &lt;PATTERN&gt; &lt;GLOB&gt;<br><br>For more information try --help<br>error: process didn&#39;t exit successfully: `E:\\geektime-Rust-master\\geektime-rust-master\\target\\debug\\rgrep.exe` (exit code: 2)<br><br>Process finished with exit code 2<br>æ±‚åŠ©ã€‚ã€‚ã€‚ä¸çŸ¥é“ä¸ºä»€ä¹ˆæ€»è¾“å‡ºè¿™ä¸ª","like_count":0},{"had_liked":false,"id":348017,"user_name":"forever è’™","can_delete":false,"product_type":"c1","uid":2991652,"ip_address":"","ucode":"472EB8946A3F96","user_header":"https://static001.geekbang.org/account/avatar/00/2d/a6/24/961129f1.jpg","comment_is_top":false,"comment_ctime":1654668926,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1654668926","product_id":100085301,"comment_content":"error: The following required arguments were not provided:<br>    &lt;PATTERN&gt;<br>    &lt;GLOB&gt;<br><br>USAGE:<br>    rgrep.exe &lt;PATTERN&gt; &lt;GLOB&gt;<br><br>For more information try --help<br>error: process didn&#39;t exit successfully: `E:\\geektime-Rust-master\\geektime-rust-master\\target\\debug\\rgrep.exe` (exit code: 2)æ±‚åŠ©","like_count":0},{"had_liked":false,"id":338732,"user_name":"gt","can_delete":false,"product_type":"c1","uid":2879793,"ip_address":"","ucode":"E2E220B2B08AEF","user_header":"https://static001.geekbang.org/account/avatar/00/2b/f1/31/a0f0f01d.jpg","comment_is_top":false,"comment_ctime":1647694045,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1647694045","product_id":100085301,"comment_content":"äº¤ä¸ªä½œä¸šï¼šhttps:&#47;&#47;github.com&#47;ForInfinity&#47;rgrep<br>æŠŠæ•´ä¸ªç¨‹åºåˆ†æˆäº†fsã€patternã€formatterä¸‰ä¸ªéƒ¨åˆ†ï¼Œåˆ†åˆ«è´Ÿè´£æ–‡ä»¶è¯»å†™ã€åŒ¹é…å’Œé«˜äº®åŠè¾“å‡ºconsoleã€‚å…ˆåˆ†åˆ«æ•²å®šäº†traitï¼Œç„¶åå®ç°ã€‚ä»¥åå¯ä»¥æ‰©å±•ä½¿ç”¨ä¸åŒçš„fsæ¥æºã€æ›´å¤šçš„åŒ¹é…æ¨¡å¼ã€ä¸åŒçš„formatterã€‚<br>ä¸è¿‡åœ¨ç¼–å†™æ³›å‹çš„æ—¶å€™é‡åˆ°äº†ä¸ªé—®é¢˜ï¼š<br>é¦–å…ˆå­˜åœ¨ä¸€ä¸ªtrait MatchOutput:<br>```<br>pub trait MatchOutput&lt;T&gt;<br>    where T: Display<br>```<br>å½“æˆ‘æƒ³å®ç°å¦ä¸€ä¸ªtrait Printeræ—¶ï¼š<br>``<br>pub struct Printer&lt;M: Display, T: MatchOutput&lt;M&gt;&gt;<br>{<br>    pub formatter: T,<br>}<br>```<br>rustä¼šç¼–è¯‘ä¸é€šè¿‡ï¼Œæç¤ºå­˜åœ¨æœªä½¿ç”¨çš„æ³›å‹Mï¼š<br>```<br>error[E0392]: parameter `M` is never used<br>```<br>å¯¹æ­¤ä¸å¤ªç†è§£ï¼Œä¹Ÿä¸çŸ¥é“æ˜¯ä¸æ˜¯å› ä¸ºè¿™ä¸æ˜¯æœ€ä½³å®è·µã€‚<br>ç°åœ¨ä¸´æ—¶çš„è§£å†³æ–¹æ¡ˆæ˜¯æ·»åŠ ä¸€ä¸ªç§æœ‰çš„å˜é‡_m:Mï¼Œå¹¶åœ¨å†™newæ–¹æ³•çš„æ—¶å€™å°†å…¶åˆå§‹åŒ–ä¸ºNoneï¼š<br>```<br>pub struct Printer&lt;M: Display, T: MatchOutput&lt;M&gt;&gt;<br>{<br>    &#47;&#47; To pass the compiler<br>    &#47;&#47; Otherwise: error[E0392]: parameter `M` is never used<br>    _m: Option&lt;M&gt;,<br>    pub formatter: T,<br>}<br>```<br>è¹²ä¸ªè€å¸ˆçš„è§£ç­”ã€‚","like_count":0},{"had_liked":false,"id":337308,"user_name":"Geek_994f3b","can_delete":false,"product_type":"c1","uid":2494458,"ip_address":"","ucode":"3E1FBCFD14DD58","user_header":"https://thirdwx.qlogo.cn/mmopen/vi_32/DoNwd7Fm9Ynsk0ZoHbfY4fXbwctf7SR6Jdyh7HIKwI2Dsgh56rT80ndpd4xeriareZ0MibdgiavicccFqjOztpMfqQ/132","comment_is_top":false,"comment_ctime":1646744269,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1646744269","product_id":100085301,"comment_content":"ä¹Ÿå†™äº†ä¸ªï¼šhttps:&#47;&#47;github.com&#47;startdusk&#47;rgrepï¼Œæ¬¢è¿è€å¸ˆæŒ‡æ­£","like_count":0}]}