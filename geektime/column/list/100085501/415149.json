{"id":415149,"title":"04ï½œ å®æˆ˜5æ­¥ï¼ˆä¸‹ï¼‰ï¼šæ€ä¹ˆå»ºç«‹ä¼°è®¡10ä¸‡+è½¯æ–‡ç‚¹å‡»ç‡çš„æ¨¡å‹ï¼Ÿ","content":"<p>ä½ å¥½ï¼Œæˆ‘æ˜¯é»„ä½³ã€‚æ¬¢è¿æ¥åˆ°é›¶åŸºç¡€å®æˆ˜æœºå™¨å­¦ä¹ ã€‚</p><p>ä¸Šä¸€è®²ï¼Œæˆ‘ä»¬é€šè¿‡ä¸€ä¸ªé¡¹ç›®è®²è§£äº†â€œå®æˆ˜5æ­¥â€çš„å‰ä¸¤æ­¥ã€‚åœ¨ç¬¬ä¸€æ­¥â€œå®šä¹‰é—®é¢˜â€ä¸­ï¼Œæˆ‘ä»¬å®šä¹‰äº†è¦å¤„ç†çš„é—®é¢˜ï¼Œä¹Ÿå°±æ˜¯æ ¹æ®ç‚¹èµæ•°å’Œè½¬å‘æ•°ç­‰æŒ‡æ ‡ï¼Œä¼°è®¡ä¸€ç¯‡æ–‡ç« èƒ½å®ç°å¤šå¤§çš„æµè§ˆé‡ã€‚åŒæ—¶æˆ‘ä»¬è¿˜å°†å®ƒå½’ç±»ä¸ºå›å½’é—®é¢˜ï¼›åœ¨ç¬¬äºŒæ­¥â€œæ”¶é›†æ•°æ®å’Œé¢„å¤„ç†â€ä¸­ï¼Œæˆ‘ä»¬åšå¥½äº†æ•°æ®çš„é¢„å¤„ç†å·¥ä½œï¼Œè¿˜æŠŠæ•°æ®é›†æ‹†åˆ†æˆäº†è¿™å››ä¸ªæ•°æ®é›†ï¼š</p><ul>\n<li>ç‰¹å¾è®­ç»ƒé›†ï¼ˆX_trainï¼‰</li>\n<li>ç‰¹å¾æµ‹è¯•é›†ï¼ˆX_testï¼‰</li>\n<li>æ ‡ç­¾è®­ç»ƒé›†ï¼ˆy_trainï¼‰</li>\n<li>æ ‡ç­¾æµ‹è¯•é›†ï¼ˆy_testï¼‰</li>\n</ul><p>æœ‰äº†è¿™äº›æ•°æ®é›†åï¼Œæˆ‘ä»¬å°±å¯ä»¥å¼€å§‹è€ƒè™‘é€‰ä»€ä¹ˆç®—æ³•ï¼Œç„¶åå»ºç«‹æ¨¡å‹äº†ã€‚æ‰€ä»¥ï¼Œä»Šå¤©è¿™èŠ‚è¯¾æˆ‘ä»¬ç»§ç»­å®Œæˆâ€œå®æˆ˜5æ­¥â€ä¸­çš„åä¸‰æ­¥ï¼šé€‰æ‹©ç®—æ³•å¹¶å»ºç«‹æ¨¡å‹ã€è®­ç»ƒæ‹Ÿåˆæ¨¡å‹å’Œè¯„ä¼°å¹¶ä¼˜åŒ–æ¨¡å‹æ€§èƒ½ï¼Œæ¥æŠŠè¿™ä¸ªé¡¹ç›®åšå®Œã€‚ä¸‹é¢ï¼Œæˆ‘ä»¬å…ˆçœ‹çœ‹æ€ä¹ˆé€‰æ‹©ç®—æ³•å¹¶å»ºç«‹æ¨¡å‹ã€‚</p><h1>ç¬¬3æ­¥ é€‰æ‹©ç®—æ³•å¹¶å»ºç«‹æ¨¡å‹</h1><p>åœ¨è¿™ä¸€æ­¥ä¸­ï¼Œæˆ‘ä»¬éœ€è¦å…ˆæ ¹æ®ç‰¹å¾å’Œæ ‡ç­¾ä¹‹é—´çš„å…³ç³»ï¼Œé€‰å‡ºä¸€ä¸ªåˆé€‚çš„ç®—æ³•ï¼Œå¹¶æ‰¾åˆ°ä¸ä¹‹å¯¹åº”çš„åˆé€‚çš„ç®—æ³•åŒ…ï¼Œç„¶åé€šè¿‡è°ƒç”¨è¿™ä¸ªç®—æ³•åŒ…æ¥å»ºç«‹æ¨¡å‹ã€‚</p><p>é€‰ç®—æ³•çš„è¿‡ç¨‹å¾ˆè€ƒéªŒæ•°æ®ç§‘å­¦å®¶ä»¬çš„ç»éªŒï¼Œä¸è¿‡ï¼Œä½ ä¹Ÿæ— éœ€æ‹…å¿ƒè‡ªå·±æ²¡æœ‰ç»éªŒï¼Œåœ¨è¿™ä¸ªè¯¾ç¨‹ä¸­ï¼Œæˆ‘ä¼šç»™ä½ è®²æ¸…æ¥šæ¯ä¸€ä¸ªå®æˆ˜ä¸­æ‰€ç”¨çš„ç®—æ³•çš„åŸç†ï¼Œå¸®åŠ©ä½ å»ºç«‹èµ·é€‰ç®—æ³•çš„ç›´è§‰ã€‚</p><p>å…·ä½“åˆ°æˆ‘ä»¬è¿™ä¸ªé¡¹ç›®é‡Œï¼Œåœ¨ä¸Šä¸€è®²ä¸­æˆ‘è¯´è¿‡ï¼Œæˆ‘ä»¬è¿™ä¸ªæ•°æ®é›†é‡Œçš„æŸäº›ç‰¹å¾å’Œæ ‡ç­¾ä¹‹é—´ï¼Œå­˜åœ¨ç€è¿‘ä¼¼çº¿æ€§çš„å…³ç³»ã€‚è€Œä¸”ï¼Œè¿™ä¸ªæ•°æ®é›†çš„æ ‡ç­¾æ˜¯è¿ç»­å˜é‡ï¼Œå› æ­¤ï¼Œé€‚åˆç”¨å›å½’åˆ†ææ¥å¯»æ‰¾ä»ç‰¹å¾åˆ°æ ‡ç­¾çš„é¢„æµ‹å‡½æ•°ã€‚</p><!-- [[[read_end]]] --><p>æ‰€è°“å›å½’åˆ†æ(regression analysis)ï¼Œå°±æ˜¯ç¡®å®šä¸¤ç§æˆ–ä¸¤ç§ä»¥ä¸Šå˜é‡é—´ç›¸äº’ä¾èµ–çš„å®šé‡å…³ç³»çš„ä¸€ç§ç»Ÿè®¡åˆ†æï¼Œè¯´ç™½äº†å°±æ˜¯å½“è‡ªå˜é‡å˜åŒ–çš„æ—¶å€™ï¼Œç ”ç©¶ä¸€ä¸‹å› å˜é‡æ˜¯æ€ä¹ˆè·Ÿç€å˜åŒ–çš„ï¼Œå®ƒå¯ä»¥ç”¨æ¥é¢„æµ‹å®¢æµé‡ã€é™é›¨é‡ã€é”€å”®é‡ç­‰ã€‚</p><p>ä¸è¿‡ï¼Œå›å½’åˆ†æçš„ç®—æ³•æœ‰å¾ˆå¤šç§ï¼Œæ¯”å¦‚è¯´çº¿æ€§å›å½’ï¼Œå¤šé¡¹å¼å›å½’ï¼Œè´å¶æ–¯å›å½’ç­‰ç­‰ï¼Œé‚£å…·ä½“è¯¥é€‰å“ªä¸ªå‘¢ï¼Ÿå…¶å®ï¼Œè¿™æ˜¯æ ¹æ®ç‰¹å¾å’Œæ ‡ç­¾ä¹‹é—´çš„å…³ç³»æ¥å†³å®šçš„ã€‚æˆ‘ä»¬åœ¨ä¸Šä¸€è®²çš„å¯è§†åŒ–è¿‡ç¨‹ä¸­ï¼Œæ¨æµ‹ç‰¹å¾å’Œæ ‡ç­¾å¯èƒ½å­˜åœ¨çº¿æ€§å…³ç³»ï¼Œå¹¶ä¸”ç”¨ä¸‹é¢è¿™ä¸ªæ•£ç‚¹å›¾ç®€å•åšäº†éªŒè¯ã€‚</p><p><img src=\"https://static001.geekbang.org/resource/image/24/7d/24e97d5a919c0e03b924270233a3b67d.png?wh=399x260\" alt=\"\"></p><p>æ‰€ä»¥è¿™é‡Œï¼Œæˆ‘ä»¬å°±é€‰æ‹©ç”¨çº¿æ€§å›å½’ç®—æ³•æ¥å»ºæ¨¡ã€‚</p><p>çº¿æ€§å›å½’ç®—æ³•æ˜¯æœ€ç®€å•ã€æœ€åŸºç¡€çš„æœºå™¨å­¦ä¹ ç®—æ³•ï¼Œå®ƒå…¶å®å°±æ˜¯ç»™æ¯ä¸€ä¸ªç‰¹å¾å˜é‡æ‰¾å‚æ•°çš„è¿‡ç¨‹ã€‚æˆ‘æƒ³ä½ ä¸€å®šç†Ÿæ‚‰ä¸€å…ƒçº¿æ€§å›å½’çš„å…¬å¼ï¼š</p><p>$$ y = a*x + b $$</p><p>å¯¹äºä¸€å…ƒçº¿æ€§å›å½’æ¥è¯´ï¼Œå®ƒçš„å†…éƒ¨å‚æ•°å°±æ˜¯æœªçŸ¥çš„æ–œç‡å’Œæˆªè·ã€‚åªä¸è¿‡åœ¨æœºå™¨å­¦ä¹ ä¸­ï¼Œæˆ‘ä»¬æŠŠæ–œç‡aå«åšæƒé‡ï¼ˆweightï¼‰ï¼Œç”¨è‹±æ–‡å­—æ¯wä»£è¡¨ï¼ŒæŠŠæˆªè·bå«åšåç½®ï¼ˆbiasï¼‰ï¼Œç”¨è‹±æ–‡å­—æ¯bä»£è¡¨ã€‚æ‰€ä»¥æœºå™¨å­¦ä¹ ä¸­ä¸€å…ƒçº¿æ€§å›å½’çš„å…¬å¼ä¹Ÿå†™æˆï¼š</p><p>$$ y = w*x + b $$</p><p>è€Œåœ¨æˆ‘ä»¬è¿™ä¸ªé¡¹ç›®ä¸­ï¼Œæ•°æ®é›†ä¸­æœ‰4ä¸ªç‰¹å¾ï¼Œæ‰€ä»¥å°±æ˜¯ï¼š</p><p>$$ y = w_{1}x_{1} + w_{2}x_{2} + w_{3}x_{3} + w_{4}x_{4} + b $$</p><p>å› æ­¤ï¼Œæˆ‘ä»¬çš„æ¨¡å‹å°±ä¼šæœ‰5ä¸ªå†…éƒ¨å‚æ•°ï¼Œä¹Ÿå°±æ˜¯4ä¸ªç‰¹å¾çš„æƒé‡å’Œä¸€ä¸ªåç½®ï¼ˆæˆªè·ï¼‰éœ€è¦ç¡®å®šã€‚ä¸è¿‡è¿™äº›å…¬å¼çš„å…·ä½“ä»£ç å®ç°ï¼Œéƒ½ä¸ç”¨æˆ‘ä»¬è‡ªå·±å®Œæˆï¼Œå®ƒä»¬å…¨éƒ¨å°è£…åœ¨å·¥å…·åŒ…é‡Œäº†ã€‚ä½ åªè¦å¯¹ç®—æ³•çš„åŸç†æœ‰ä¸ªå°è±¡å°±è¡Œäº†ã€‚</p><p>ç¡®å®šå¥½ç®—æ³•åï¼Œæˆ‘ä»¬æ¥ç€æ¥çœ‹ä¸€ä¸‹è°ƒç”¨ä»€ä¹ˆæ ·çš„ç®—æ³•åŒ…å»ºç«‹æ¨¡å‹æ¯”è¾ƒåˆé€‚ã€‚</p><p>å¯¹äºæœºå™¨å­¦ä¹ æ¥è¯´ï¼Œæœ€å¸¸ç”¨çš„ç®—æ³•å·¥å…·åŒ…æ˜¯scikit-learnï¼Œç®€ç§°sklearnï¼Œå®ƒæ˜¯ä½¿ç”¨æœ€å¹¿æ³›çš„å¼€æºPythonæœºå™¨å­¦ä¹ åº“ï¼Œå ªç§°æœºå™¨å­¦ä¹ ç¥å™¨ã€‚sklearnæä¾›äº†å¤§é‡ç”¨äºæ•°æ®æŒ–æ˜çš„æœºå™¨å­¦ä¹ å·¥å…·ï¼Œè¦†ç›–æ•°æ®é¢„å¤„ç†ã€å¯è§†åŒ–ã€äº¤å‰éªŒè¯å’Œå¤šç§æœºå™¨å­¦ä¹ ç®—æ³•ã€‚</p><p>è™½ç„¶æˆ‘ä»¬å·²ç»é€‰å®šä½¿ç”¨çº¿æ€§å›å½’ç®—æ³•ï¼Œä½†æ˜¯åœ¨sklearnä¸­åˆæœ‰å¾ˆå¤šçº¿æ€§å›å½’ç®—æ³•åŒ…ï¼Œæ¯”å¦‚è¯´åŸºæœ¬çš„çº¿æ€§å›å½’ç®—æ³•LinearRegressionï¼Œä»¥åŠåœ¨å®ƒçš„åŸºç¡€ä¸Šè¡ç”Ÿå‡ºæ¥çš„Lassoå›å½’å’ŒRidgeå›å½’ç­‰ã€‚</p><p>é‚£å“ªä¸€ä¸ªæ‰æ˜¯é€‚åˆæˆ‘ä»¬è¿™ä¸ªé¡¹ç›®çš„ç®—æ³•åŒ…å‘¢ï¼Ÿå…¶å®ï¼Œæˆ‘ä»¬ä¸€èˆ¬é€‰ç®—æ³•åŒ…çš„æ–¹æ³•æ˜¯ä»èƒ½å¤Ÿè§£å†³è¯¥é—®é¢˜çš„æœ€ç®€å•çš„ç®—æ³•å¼€å§‹å°è¯•ï¼Œç›´åˆ°å¾—åˆ°æ»¡æ„çš„ç»“æœä¸ºæ­¢ã€‚å¯¹äºè¿™ä¸ªé¡¹ç›®ï¼Œæˆ‘ä»¬é€‰æ‹©LinearRegressionï¼Œå®ƒä¹Ÿæ˜¯æœºå™¨å­¦ä¹ ä¸­æœ€å¸¸è§ã€æœ€åŸºç¡€çš„å›å½’ç®—æ³•åŒ…ã€‚å…¶å®ƒå›å½’ç®—æ³•åŒ…ï¼Œæœªæ¥æˆ‘ä¼šæ…¢æ…¢ç»™ä½ ä»‹ç»ã€‚</p><p>è°ƒç”¨LinearRegressionå»ºç«‹æ¨¡å‹éå¸¸ç®€å•ï¼Œä¸¤è¡Œä»£ç å°±å¯ä»¥æå®šï¼š</p><pre><code class=\"language-plain\">from sklearn.linear_model import LinearRegression # å¯¼å…¥çº¿æ€§å›å½’ç®—æ³•æ¨¡å‹\nlinereg_model = LinearRegression() # ä½¿ç”¨çº¿æ€§å›å½’ç®—æ³•åˆ›å»ºæ¨¡å‹\n</code></pre><p>å¯ä»¥çœ‹åˆ°ï¼Œæˆ‘æŠŠè¿™ä¸ªçº¿æ€§å›å½’æ¨¡å‹å‘½åä¸ºäº†â€œlinereg_modelâ€ã€‚é‚£åˆ°è¿™é‡Œï¼Œæˆ‘ä»¬ç®—ä¸ç®—æ˜¯å»ºç«‹å¥½æ¨¡å‹äº†å‘¢ï¼Ÿæ˜¯çš„ï¼Œæ¨¡å‹å·²ç»åˆ›å»ºå‡ºæ¥äº†ï¼Œæˆ‘ä»¬å¯ä»¥å¼€å§‹è®­ç»ƒå®ƒäº†ã€‚ä¸è¿‡ï¼Œæœ‰ä¸€ç‚¹éœ€è¦æŒ‡å‡ºï¼Œå»ºç«‹æ¨¡å‹æ—¶ï¼Œä½ é€šå¸¸è¿˜éœ€è¦äº†è§£å®ƒæœ‰å“ªäº›å¤–éƒ¨å‚æ•°ï¼ŒåŒæ—¶æŒ‡å®šå¥½å®ƒçš„å¤–éƒ¨å‚æ•°çš„å€¼ã€‚</p><p>æ¨¡å‹çš„å‚æ•°æœ‰ä¸¤ç§ï¼šå†…éƒ¨å‚æ•°å’Œå¤–éƒ¨å‚æ•°ã€‚å†…éƒ¨å‚æ•°æ˜¯å±äºç®—æ³•æœ¬èº«çš„ä¸€éƒ¨åˆ†ï¼Œä¸ç”¨æˆ‘ä»¬äººå·¥æ¥ç¡®å®šï¼Œåˆšæ‰æåˆ°çš„æƒé‡wå’Œæˆªè·bï¼Œéƒ½æ˜¯çº¿æ€§å›å½’æ¨¡å‹çš„å†…éƒ¨å‚æ•°ï¼›è€Œå¤–éƒ¨å‚æ•°ä¹Ÿå«åšè¶…å‚æ•°ï¼Œå®ƒä»¬çš„å€¼æ˜¯åœ¨åˆ›å»ºæ¨¡å‹æ—¶ç”±æˆ‘ä»¬è‡ªå·±è®¾å®šçš„ã€‚</p><p>å¯¹äºLinearRegressionæ¨¡å‹æ¥è®²ï¼Œå®ƒçš„å¤–éƒ¨å‚æ•°ä¸»è¦åŒ…æ‹¬ä¸¤ä¸ªå¸ƒå°”å€¼ï¼š</p><ul>\n<li>fit_intercept&nbsp;ï¼Œé»˜è®¤å€¼ä¸ºTrueï¼Œä»£è¡¨æ˜¯å¦è®¡ç®—æ¨¡å‹çš„æˆªè·ã€‚</li>\n<li>normalizeï¼Œé»˜è®¤å€¼ä¸º Falseï¼Œä»£è¡¨æ˜¯å¦å¯¹ç‰¹å¾Xåœ¨å›å½’ä¹‹å‰åšè§„èŒƒåŒ–ã€‚</li>\n</ul><p>ä¸è¿‡å‘¢ï¼Œå¯¹äºæ¯”è¾ƒç®€å•çš„æ¨¡å‹æ¥è¯´ï¼Œé»˜è®¤çš„å¤–éƒ¨å‚æ•°è®¾ç½®ä¹Ÿéƒ½æ˜¯ä¸é”™çš„é€‰æ‹©ï¼Œæ‰€ä»¥ï¼Œæˆ‘ä»¬ä¸æ˜¾å¼æŒ‡å®šå¤–éƒ¨å‚æ•°è€Œç›´æ¥è°ƒç”¨æ¨¡å‹ï¼Œä¹Ÿæ˜¯å¯ä»¥çš„ã€‚åœ¨ä¸Šé¢çš„ä»£ç ä¸­ï¼Œæˆ‘å°±æ˜¯åœ¨åˆ›å»ºæ¨¡å‹æ—¶ç›´æ¥ä½¿ç”¨äº†å¤–éƒ¨å‚æ•°çš„é»˜è®¤å€¼ã€‚</p><p>è¿˜æœ‰ä¸€ç‚¹éœ€è¦è¯´æ˜çš„æ˜¯ï¼Œæˆ‘ä»¬è¯¾ç¨‹ä¸­ä¸ä¼šå»è¯¦ç»†ä»‹ç»æ¯ä¸€ä¸ªå‚æ•°çš„æ„ä¹‰ï¼Œå› ä¸ºè¿™ä¸æ˜¯æˆ‘ä»¬çš„é‡ç‚¹ã€‚ä½†æ˜¯å¯¹äºä¸€äº›ç‰¹æ®Šæƒ…å†µä¸‹éœ€è¦è°ƒæ•´å¤–éƒ¨å‚æ•°çš„ï¼Œåœ¨åé¢çš„è¯¾ç¨‹é‡Œæˆ‘ä¼šå‘Šè¯‰ä½ è°ƒå‚çš„é‡è¦æŠ€å·§ã€‚</p><p>å¥½ï¼Œç°åœ¨æˆ‘ä»¬å·²ç»åˆ›å»ºå¥½çº¿æ€§å›å½’æ¨¡å‹linereg_modelï¼Œæ¥ä¸‹æ¥æˆ‘ä»¬å°±å¯ä»¥è¿›å…¥æœºå™¨å­¦ä¹ çš„æ ¸å¿ƒç¯èŠ‚â€œè®­ç»ƒæ‹Ÿåˆæœºå™¨å­¦ä¹ æ¨¡å‹â€äº†ã€‚</p><h1>ç¬¬4æ­¥ è®­ç»ƒæ¨¡å‹</h1><p>è®­ç»ƒæ¨¡å‹å°±æ˜¯ç”¨è®­ç»ƒé›†ä¸­çš„ç‰¹å¾å˜é‡å’Œå·²çŸ¥æ ‡ç­¾ï¼Œæ ¹æ®å½“å‰æ ·æœ¬çš„æŸå¤±å¤§å°æ¥<strong>é€æ¸æ‹Ÿåˆå‡½æ•°ï¼Œç¡®å®šæœ€ä¼˜çš„å†…éƒ¨å‚æ•°ï¼Œæœ€åå®Œæˆæ¨¡å‹</strong>ã€‚è™½ç„¶çœ‹èµ·æ¥æŒºå¤æ‚ï¼Œä½†è¿™äº›æ­¥éª¤ï¼Œæˆ‘ä»¬éƒ½é€šè¿‡è°ƒç”¨fitæ–¹æ³•æ¥å®Œæˆã€‚</p><p>fitæ–¹æ³•æ˜¯æœºå™¨å­¦ä¹ çš„æ ¸å¿ƒç¯èŠ‚ï¼Œé‡Œé¢å°è£…äº†å¾ˆå¤šå…·ä½“çš„æœºå™¨å­¦ä¹ æ ¸å¿ƒç®—æ³•ï¼Œæˆ‘ä»¬åªéœ€è¦æŠŠç‰¹å¾è®­ç»ƒæ•°æ®é›†å’Œæ ‡ç­¾è®­ç»ƒæ•°æ®é›†ï¼ŒåŒæ—¶ä½œä¸ºå‚æ•°ä¼ è¿›fitæ–¹æ³•å°±è¡Œäº†ã€‚</p><pre><code class=\"language-plain\">linereg_model.fit(X_train, y_train) # ç”¨è®­ç»ƒé›†æ•°æ®ï¼Œè®­ç»ƒæœºå™¨ï¼Œæ‹Ÿåˆå‡½æ•°ï¼Œç¡®å®šå†…éƒ¨å‚æ•°\n</code></pre><p>è¿è¡Œè¯¥è¯­å¥åçš„è¾“å‡ºå¦‚ä¸‹ï¼š</p><pre><code class=\"language-plain\">LinearRegression()\n</code></pre><p>è¿™æ ·ï¼Œæˆ‘ä»¬å°±å®Œæˆäº†å¯¹æ¨¡å‹çš„è®­ç»ƒã€‚ä½ å¯èƒ½ä¼šè§‰å¾—å¾ˆå¥‡æ€ªï¼Œæ—¢ç„¶è®­ç»ƒæ¨¡å‹æ˜¯æœºå™¨å­¦ä¹ çš„æ ¸å¿ƒç¯èŠ‚ï¼Œæ€ä¹ˆåªæœ‰ä¸€å¥ä»£ç ï¼Ÿå…¶å®è¿™å°±æ˜¯æˆ‘åå¤å¼ºè°ƒè¿‡çš„ï¼Œç”±äºä¼˜ç§€çš„æœºå™¨å­¦ä¹ åº“çš„å­˜åœ¨ï¼Œæˆ‘ä»¬å¯ä»¥ç”¨ä¸€ä¸¤è¡Œè¯­å¥å®ç°å¾ˆå¼ºå¤§çš„åŠŸèƒ½ã€‚æ‰€ä»¥ï¼Œä¸è¦å°çœ‹ä¸Šé¢é‚£ä¸ªç®€å•çš„fitè¯­å¥ï¼Œè¿™æ˜¯æ¨¡å‹è¿›è¡Œè‡ªæˆ‘å­¦ä¹ çš„å…³é”®è¿‡ç¨‹ã€‚</p><p>åœ¨è¿™ä¸ªè¿‡ç¨‹é‡Œï¼Œ<strong>fitçš„æ ¸å¿ƒå°±æ˜¯å‡å°‘æŸå¤±ï¼Œä½¿å‡½æ•°å¯¹ç‰¹å¾åˆ°æ ‡ç­¾çš„æ¨¡æ‹Ÿè¶Šæ¥è¶Šè´´åˆ‡</strong>ã€‚é‚£ä¹ˆå®ƒå…·ä½“æ˜¯æ€ä¹ˆå‡å°‘æŸå¤±å‘¢ï¼Ÿè¿™é‡Œæˆ‘ç”»äº†ä¸€å¼ å›¾ç‰‡å±•ç¤ºæ¨¡å‹ä»å¾ˆä¸é è°±åˆ°æ¯”è¾ƒé è°±çš„è¿‡ç¨‹ã€‚</p><p><img src=\"https://static001.geekbang.org/resource/image/d7/08/d711fe6c1ace614dfe4ef1268498d608.jpg?wh=2284x1032\" alt=\"\"></p><p>è¿™ä¸ªæ‹Ÿåˆçš„è¿‡ç¨‹ï¼ŒåŒæ—¶ä¹Ÿæ˜¯æœºå™¨å­¦ä¹ ç®—æ³•ä¼˜åŒ–å…¶å†…éƒ¨å‚æ•°çš„è¿‡ç¨‹ã€‚è€Œä¼˜åŒ–å‚æ•°çš„å…³é”®å°±æ˜¯å‡å°æŸå¤±ã€‚</p><p>é‚£ä»€ä¹ˆæ˜¯æŸå¤±å‘¢ï¼Ÿå®ƒå…¶å®æ˜¯<strong>å¯¹ç³Ÿç³•é¢„æµ‹çš„æƒ©ç½š</strong>ï¼ŒåŒæ—¶ä¹Ÿæ˜¯å¯¹æ¨¡å‹å¥½åçš„åº¦é‡ã€‚æŸå¤±ä¹Ÿå°±æ˜¯æ¨¡å‹çš„è¯¯å·®ï¼Œä¹Ÿç§°ä¸ºæˆæœ¬æˆ–ä»£ä»·ã€‚åå­—è™½å¤šï¼Œä½†éƒ½æ˜¯ä¸€ä¸ªæ„æ€ï¼Œå°±æ˜¯å½“å‰é¢„æµ‹å€¼å’ŒçœŸå®å€¼ä¹‹é—´çš„å·®è·çš„ä½“ç°ã€‚å®ƒæ˜¯ä¸€ä¸ªæ•°å€¼ï¼Œè¡¨ç¤ºå¯¹äºå•ä¸ªæ ·æœ¬è€Œè¨€æ¨¡å‹é¢„æµ‹çš„å‡†ç¡®ç¨‹åº¦ã€‚å¦‚æœæ¨¡å‹çš„é¢„æµ‹å®Œå…¨å‡†ç¡®ï¼Œåˆ™æŸå¤±ä¸º0ï¼›å¦‚æœä¸å‡†ç¡®ï¼Œå°±æœ‰æŸå¤±ã€‚</p><p>åœ¨æœºå™¨å­¦ä¹ ä¸­ï¼Œæˆ‘ä»¬è¿½æ±‚çš„å½“ç„¶æ˜¯æ¯”è¾ƒå°çš„æŸå¤±ã€‚ä¸è¿‡ï¼Œæ¨¡å‹å¥½ä¸å¥½ï¼Œè¿˜ä¸èƒ½ä»…çœ‹å•ä¸ªæ ·æœ¬ï¼Œè¿˜è¦é’ˆå¯¹æ‰€æœ‰æ•°æ®æ ·æœ¬ï¼Œæ‰¾åˆ°ä¸€ç»„å¹³å‡æŸå¤±â€œè¾ƒå°â€çš„å‡½æ•°æ¨¡å‹ã€‚æ ·æœ¬çš„æŸå¤±å¤§å°ï¼Œä»å‡ ä½•æ„ä¹‰ä¸ŠåŸºæœ¬å¯ä»¥ç†è§£ä¸ºé¢„æµ‹å€¼å’ŒçœŸå€¼ä¹‹é—´çš„å‡ ä½•è·ç¦»ã€‚å¹³å‡è·ç¦»è¶Šå¤§ï¼Œè¯´æ˜è¯¯å·®è¶Šå¤§ï¼Œæ¨¡å‹è¶Šç¦»è°±ã€‚åœ¨ä¸‹é¢è¿™ä¸ªå›¾ä¸­ï¼Œå·¦è¾¹æ˜¯å¹³å‡æŸå¤±è¾ƒå¤§çš„æ¨¡å‹ï¼Œå³è¾¹æ˜¯å¹³å‡æŸå¤±è¾ƒå°çš„æ¨¡å‹ï¼Œæ¨¡å‹æ‰€æœ‰æ•°æ®ç‚¹çš„å¹³å‡æŸå¤±å¾ˆæ˜æ˜¾å¤§è¿‡å³è¾¹æ¨¡å‹ã€‚</p><p><img src=\"https://static001.geekbang.org/resource/image/1e/1f/1e07d5c3fe9a82b4f2c1d83c6fcd591f.jpg?wh=2284x868\" alt=\"\"></p><p>å› æ­¤ï¼Œé’ˆå¯¹æ¯ä¸€ç»„ä¸åŒçš„å‚æ•°ï¼Œæœºå™¨éƒ½ä¼šåŸºäºæ ·æœ¬æ•°æ®é›†ï¼Œç”¨æŸå¤±å‡½æ•°ç®—ä¸€æ¬¡å¹³å‡æŸå¤±ã€‚è€Œæœºå™¨å­¦ä¹ çš„æœ€ä¼˜åŒ–è¿‡ç¨‹ï¼Œå°±æ˜¯é€æ­¥å‡å°è®­ç»ƒé›†ä¸ŠæŸå¤±çš„è¿‡ç¨‹ã€‚å…·ä½“åˆ°æˆ‘ä»¬ä»Šå¤©è¿™ä¸ªå›å½’æ¨¡å‹çš„æ‹Ÿåˆï¼Œå®ƒçš„å…³é”®ç¯èŠ‚å°±æ˜¯<strong>é€šè¿‡æ¢¯åº¦ä¸‹é™ï¼Œé€æ­¥ä¼˜åŒ–æ¨¡å‹çš„å‚æ•°ï¼Œä½¿è®­ç»ƒé›†è¯¯å·®å€¼è¾¾åˆ°æœ€å°</strong>ã€‚è¿™ä¹Ÿå°±æ˜¯æˆ‘ä»¬åˆšæ‰è®²çš„é‚£ä¸ªfitè¯­å¥æ‰€è¦å®ç°çš„æœ€ä¼˜åŒ–è¿‡ç¨‹ã€‚</p><p>åœ¨è¿™é‡Œé¢ï¼Œçº¿æ€§å›å½’ä¸­è®¡ç®—è¯¯å·®çš„æ–¹æ³•å¾ˆå¥½ç†è§£ï¼Œå°±æ˜¯æ•°æ®é›†ä¸­çœŸå€¼ä¸é¢„æµ‹å€¼ä¹‹é—´çš„æ®‹å·®å¹³æ–¹å’Œã€‚é‚£æ¢¯åº¦ä¸‹é™åˆæ˜¯æ€ä¹ˆä¸€å›äº‹å‘¢ï¼Ÿä¸ºäº†è®©ä½ ç›´è§‚åœ°ç†è§£ï¼Œæˆ‘ç”¨ä¸€å¼ å›¾æ¥å±•ç¤ºä¸€ä¸‹ï¼Œæ¢¯åº¦ä¸‹é™æ˜¯æ€ä¹ˆä¸€æ­¥ä¸€æ­¥åœ°èµ°åˆ°æŸå¤±æ›²çº¿ä¸­çš„æœ€å°æŸå¤±ç‚¹çš„ã€‚</p><p><img src=\"https://static001.geekbang.org/resource/image/12/1a/128eec906305b3be97989f28cec1961a.jpg?wh=2284x1285\" alt=\"\"></p><p>å°±åƒå›¾é‡Œè¿™æ ·ï¼Œæ¢¯åº¦ä¸‹é™å…¶å®å°±å’Œä¸‹å±±ä¸€æ ·ã€‚ä½ å¯ä»¥æƒ³è±¡ä¸€ä¸‹ï¼Œå½“ä½ ç«™åœ¨é«˜å¤„ï¼Œä½ çš„ç›®æ ‡å°±æ˜¯æ‰¾åˆ°ä¸€ç³»åˆ—çš„å‚æ•°ï¼Œè®©è®­ç»ƒæ•°æ®é›†ä¸Šçš„æŸå¤±å€¼æœ€å°ã€‚é‚£ä¹ˆä½ è¯¥å¾€å“ªèµ°æ‰èƒ½ä¿è¯æŸå¤±å€¼æœ€å°å‘¢ï¼Ÿå…³é”®å°±æ˜¯é€šè¿‡æ±‚å¯¼çš„æ–¹æ³•ï¼Œæ‰¾åˆ°æ¯ä¸€æ­¥çš„æ–¹å‘ï¼Œç¡®ä¿æ€»æ˜¯å¾€æ›´å°çš„æŸå¤±æ–¹å‘å‰è¿›ã€‚</p><p>æ‰€ä»¥ï¼Œä½ å¯ä»¥çœ‹å‡ºæ–¹å‘æ˜¯æœ‰å¤šä¹ˆçš„é‡è¦ã€‚æœºå™¨å­¦ä¹ æœ€ä¼˜åŒ–ä¹‹æ‰€ä»¥èƒ½å¤Ÿæ‹Ÿåˆå‡ºæœ€ä½³çš„æ¨¡å‹ï¼Œå°±æ˜¯å› ä¸ºèƒ½å¤Ÿæ‰¾åˆ°å‰è¿›æ–¹å‘ï¼Œä½ çœ‹ï¼Œ<strong>ä¸ä»…æˆ‘ä»¬äººéœ€è¦æ–¹å‘ï¼Œè¿AIä¹Ÿéœ€è¦æ­£ç¡®çš„æ–¹å‘</strong>ã€‚</p><p>å…³äºæ¢¯åº¦ä¸‹é™ï¼Œä½ ç†è§£è¿™äº›å°±å·²ç»å·®ä¸å¤šäº†ã€‚è‡³äºå…·ä½“çš„ç»†èŠ‚ï¼Œæˆ‘ä»¬åœ¨è¿™ä¸ªè¯¾ç¨‹ä¸­å¹¶ä¸ä¼šé€šè¿‡å…¬å¼å’Œä»£ç å®ç°ï¼Œè¿™ä¹Ÿæ˜¯åŸºäºä¸é‡å¤é€ è½®å­çš„åŸåˆ™ã€‚é‚£åˆ°è¿™é‡Œä¸ºæ­¢ï¼Œæˆ‘ä»¬å·²ç»å®Œæˆäº†æ¨¡å‹çš„å»ºç«‹å’Œè®­ç»ƒï¼Œæ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬ä¸€èµ·çœ‹çœ‹æ€ä¹ˆå¯¹è¿™ä¸ªè®­ç»ƒå¥½çš„æ¨¡å‹è¿›è¡Œè¯„ä¼°å’Œä¼˜åŒ–ï¼Œè®©å®ƒå°½å¯èƒ½ç²¾å‡†åœ°ä¼°è®¡å‡ºæˆ‘ä»¬çš„æ–‡ç« æµè§ˆé‡ã€‚</p><h1>ç¬¬5æ­¥ æ¨¡å‹çš„è¯„ä¼°å’Œä¼˜åŒ–</h1><p>æˆ‘ä»¬åˆšæ‰è¯´ï¼Œæ¢¯åº¦ä¸‹é™æ˜¯åœ¨ç”¨è®­ç»ƒé›†æ‹Ÿåˆæ¨¡å‹æ—¶æœ€å°åŒ–è¯¯å·®ï¼Œè¿™æ—¶å€™ç®—æ³•è°ƒæ•´çš„æ˜¯æ¨¡å‹çš„å†…éƒ¨å‚æ•°ã€‚è€Œ<strong>åœ¨éªŒè¯é›†æˆ–è€…æµ‹è¯•é›†è¿›è¡Œæ¨¡å‹æ•ˆæœè¯„ä¼°çš„è¿‡ç¨‹ä¸­ï¼Œæˆ‘ä»¬åˆ™æ˜¯é€šè¿‡æœ€å°åŒ–è¯¯å·®æ¥å®ç°è¶…å‚æ•°ï¼ˆæ¨¡å‹å¤–éƒ¨å‚æ•°ï¼‰çš„ä¼˜åŒ–</strong>ã€‚</p><p>å¯¹æ­¤ï¼Œæœºå™¨å­¦ä¹ å·¥å…·åŒ…ï¼ˆå¦‚scikit-learnï¼‰ä¸­éƒ½ä¼šæä¾›å¸¸ç”¨çš„å·¥å…·å’ŒæŒ‡æ ‡ï¼Œå¯¹éªŒè¯é›†å’Œæµ‹è¯•é›†è¿›è¡Œè¯„ä¼°ï¼Œè¿›è€Œè®¡ç®—å½“å‰çš„è¯¯å·®ã€‚æ¯”å¦‚$R^{2}$æˆ–è€…MSEå‡æ–¹è¯¯å·®æŒ‡æ ‡ï¼Œå°±å¯ä»¥ç”¨äºè¯„ä¼°å›å½’åˆ†ææ¨¡å‹çš„ä¼˜åŠ£ã€‚</p><p>ä¸è¿‡å‘¢ï¼Œåœ¨å¼€å§‹è¯„ä¼°æ¨¡å‹ä¹‹å‰ï¼Œæˆ‘æƒ³è¯·ä½ æ€è€ƒä¸€ä¸‹ï¼šåœ¨æˆ‘ä»¬è¿™5ä¸ªå®æˆ˜æ­¥éª¤é‡Œé¢ï¼Œå¹¶æ²¡æœ‰â€œä½¿ç”¨æ¨¡å‹é¢„æµ‹æµè§ˆé‡â€è¿™ä¸ªç¯èŠ‚ï¼Œè¿™æ˜¯ä¸ºä»€ä¹ˆå‘¢ï¼Ÿå…¶å®è¿™ä¸ªç¯èŠ‚å·²ç»åŒ…å«åœ¨ç¬¬5æ­¥â€œæ¨¡å‹æ€§èƒ½çš„è¯„ä¼°å’Œä¼˜åŒ–â€ä¹‹ä¸­äº†ï¼Œå¹¶ä¸”æ˜¯æˆ‘ä»¬åœ¨ç¬¬5æ­¥ä¸­é¦–å…ˆè¦å»å®ç°çš„ã€‚</p><p>å…·ä½“æ¥è¯´ï¼Œåœ¨â€œæ¨¡å‹çš„è¯„ä¼°å’Œä¼˜åŒ–â€è¿™ä¸€æ­¥ä¸­ï¼Œå½“æˆ‘ä»¬é¢„æµ‹å®Œæµ‹è¯•é›†çš„æµè§ˆé‡åï¼Œæˆ‘ä»¬è¦å†æ‹¿è¿™ä¸ªé¢„æµ‹ç»“æœå»å’Œæµ‹è¯•é›†å·²æœ‰çš„çœŸå€¼å»æ¯”è¾ƒï¼Œè¿™æ ·æ‰èƒ½å¤Ÿæ±‚å‡ºæ¨¡å‹çš„æ€§èƒ½ã€‚è€Œè¿™æ•´ä¸ªè¿‡ç¨‹ä¹ŸåŒæ ·æ˜¯ä¸€ä¸ªå¾ªç¯è¿­ä»£çš„è¿‡ç¨‹ï¼Œæˆ‘æŠŠè¿™ä¸ªå¾ªç¯è¿‡ç¨‹æ€»ç»“æˆäº†ä¸‹é¢çš„å›¾ï¼Œä½ å¯ä»¥çœ‹çœ‹ï¼š</p><p><img src=\"https://static001.geekbang.org/resource/image/69/67/691da4be2681f183f396bfb0e5b74867.jpg?wh=2284x1285\" alt=\"\"></p><p>å¯¹äºæˆ‘ä»¬è¿™ä¸ªé¡¹ç›®æ¥è¯´ï¼Œé¢„æµ‹æµ‹è¯•é›†çš„æµè§ˆé‡ï¼Œåªéœ€è¦ç”¨è®­ç»ƒå¥½çš„æ¨¡å‹linereg_modelä¸­çš„predictæ–¹æ³•ï¼Œåœ¨X_testï¼ˆç‰¹å¾æµ‹è¯•é›†ï¼‰ä¸Šè¿›è¡Œé¢„æµ‹ï¼Œè¿™ä¸ªæ–¹æ³•å°±ä¼šè¿”å›å¯¹æµ‹è¯•é›†çš„é¢„æµ‹ç»“æœã€‚</p><pre><code class=\"language-typescript\">y_pred = linereg_model.predict(X_test) #é¢„æµ‹æµ‹è¯•é›†çš„Yå€¼\n</code></pre><p>åœ¨å‡ ä¹æ‰€æœ‰çš„æœºå™¨å­¦ä¹ é¡¹ç›®ä¸­ï¼Œä½ éƒ½å¯ä»¥ç”¨predictæ–¹æ³•æ¥è¿›è¡Œé¢„æµ‹ï¼Œå®ƒå°±æ˜¯ç”¨æ¨¡å‹åœ¨ä»»æ„çš„åŒç±»å‹æ•°æ®é›†ä¸Šå»é¢„æµ‹çœŸå€¼çš„ï¼Œå¯ä»¥åº”ç”¨äºéªŒè¯é›†ã€æµ‹è¯•é›†ï¼Œå½“ç„¶ä¹Ÿå¯ä»¥åº”ç”¨äºè®­ç»ƒé›†æœ¬èº«ã€‚</p><p>è¿™é‡Œæˆ‘è¦è¯´æ˜ä¸€ä¸‹ï¼Œä¸ºäº†ç®€åŒ–æµç¨‹ï¼Œæˆ‘ä»¬å¹¶æ²¡æœ‰çœŸæ­£è¿›è¡ŒéªŒè¯å’Œæµ‹è¯•çš„å¤šé‡å¾ªç¯ã€‚å› æ­¤ï¼Œåœ¨è¿™ä¸ªé¡¹ç›®ä¸­ï¼ŒX_testæ—¢å……å½“äº†æµ‹è¯•é›†ï¼Œä¹Ÿå……å½“äº†éªŒè¯é›†ã€‚</p><p>æ‹¿åˆ°é¢„æµ‹ç»“æœåï¼Œæˆ‘ä»¬å†é€šè¿‡ä¸‹é¢çš„ä»£ç ï¼ŒæŠŠæµ‹è¯•æ•°æ®é›†çš„åŸå§‹ç‰¹å¾æ•°æ®ã€åŸå§‹æ ‡ç­¾çœŸå€¼ï¼Œä»¥åŠæ¨¡å‹å¯¹æ ‡ç­¾çš„é¢„æµ‹å€¼ç»„åˆåœ¨ä¸€èµ·è¿›è¡Œæ˜¾ç¤ºã€æ¯”è¾ƒã€‚</p><pre><code class=\"language-typescript\">df_ads_pred = X_test.copy() # æµ‹è¯•é›†ç‰¹å¾æ•°æ®\ndf_ads_pred['æµè§ˆé‡çœŸå€¼'] = y_test # æµ‹è¯•é›†æ ‡ç­¾çœŸå€¼\ndf_ads_pred['æµè§ˆé‡é¢„æµ‹å€¼'] = y_pred # æµ‹è¯•é›†æ ‡ç­¾é¢„æµ‹å€¼\ndf_ads_pred #æ˜¾ç¤ºæ•°æ®\n</code></pre><p>è¾“å‡ºç»“æœå¦‚ä¸‹:</p><p><img src=\"https://static001.geekbang.org/resource/image/6f/66/6fa715a600aab30ddefb792409ed5366.png?wh=432x346\" alt=\"\"></p><p>å¯ä»¥çœ‹å‡ºï¼Œæµè§ˆé‡é¢„æµ‹å€¼æ˜¯æ¯”è¾ƒæ¥è¿‘äºçœŸå€¼çš„ã€‚è€Œä¸”å¯¹äºä¸€äº›æ–‡ç« ï¼Œè¿™ä¸ªæ¨¡å‹çš„é¢„æµ‹å¾—éå¸¸å‡†ç¡®ï¼Œæ¯”å¦‚ç¼–å·ç¬¬1387å·æ•°æ®ï¼Œå…¶å®é™…æµè§ˆé‡ä¸º213501ï¼Œé¢„æµ‹æµè§ˆé‡ä¸º216491ã€‚è¿™å°±æ˜¯ä¸€ä¸ªå¾ˆæ£’çš„ç»“æœã€‚</p><p>å¦‚æœä½ æƒ³çœ‹çœ‹ç°åœ¨çš„æ¨¡å‹é•¿å¾—ä»€ä¹ˆæ ·ï¼Ÿä½ å¯ä»¥é€šè¿‡LinearRegressionçš„coef_å’Œintercept_å±æ€§æ‰“å°å‡ºå„ä¸ªç‰¹å¾çš„æƒé‡å’Œæ¨¡å‹çš„åç½®æ¥ã€‚å®ƒä»¬ä¹Ÿå°±æ˜¯æ¨¡å‹çš„å†…éƒ¨å‚æ•°ã€‚</p><pre><code>print('å½“å‰æ¨¡å‹çš„4ä¸ªç‰¹å¾çš„æƒé‡åˆ†åˆ«æ˜¯: ', model.coef_)\nprint('å½“å‰æ¨¡å‹çš„æˆªè·ï¼ˆåç½®ï¼‰æ˜¯: ', model.intercept_)\n</code></pre><p>è¾“å‡ºå¦‚ä¸‹ï¼š</p><pre><code>å½“å‰æ¨¡å‹çš„4ä¸ªç‰¹å¾çš„æƒé‡åˆ†åˆ«æ˜¯:  [   48.08395224    34.73062229 29730.13312489  2949.62196343]\nå½“å‰æ¨¡å‹çš„æˆªè·ï¼ˆåç½®ï¼‰æ˜¯:  -127493.90606857178\n</code></pre><p>è¿™ä¹Ÿå°±æ˜¯è¯´ï¼Œæˆ‘ä»¬ç°åœ¨çš„æ¨¡å‹çš„çº¿æ€§å›å½’å…¬å¼æ˜¯ï¼š</p><p>$$ yy=48.08x_{1}ï¼ˆç‚¹èµï¼‰+34.73x_{2}ï¼ˆè½¬å‘ï¼‰+29730.13x_{3}ï¼ˆçƒ­åº¦ï¼‰+2949.62x_{4}ï¼ˆè¯„çº§ï¼‰-127493.91 $$</p><p>ä¸è¿‡åˆ°è¿™é‡Œï¼Œæ•´ä¸ªæœºå™¨å­¦ä¹ é¡¹ç›®å¹¶æ²¡æœ‰ç»“æŸï¼Œæˆ‘ä»¬æœ€åè¿˜è¦ç»™å‡ºå½“å‰è¿™ä¸ªæ¨¡å‹çš„è¯„ä¼°åˆ†æ•°ï¼š</p><pre><code class=\"language-typescript\">print(\"çº¿æ€§å›å½’é¢„æµ‹è¯„åˆ†ï¼š\", linereg_model.score(X_test, y_test)) # è¯„ä¼°æ¨¡å‹\n</code></pre><p>åœ¨æœºå™¨å­¦ä¹ ä¸­ï¼Œå¸¸ç”¨äºè¯„ä¼°å›å½’åˆ†ææ¨¡å‹çš„æŒ‡æ ‡æœ‰ä¸¤ç§ï¼š$R^{2}$åˆ†æ•°å’ŒMSEæŒ‡æ ‡ï¼Œå¹¶ä¸”å¤§å¤šæ•°æœºå™¨å­¦ä¹ å·¥å…·åŒ…ä¸­éƒ½ä¼šæä¾›ç›¸å…³çš„å·¥å…·ã€‚å¯¹æ­¤ï¼Œä½ æ— éœ€åšè¿‡å¤šäº†è§£ï¼Œåªéœ€è¦çŸ¥é“æˆ‘ä»¬è¿™é‡Œçš„scoreè¿™ä¸ªAPIä¸­ï¼Œé€‰ç”¨çš„æ˜¯$R^{2}$åˆ†æ•°æ¥è¯„ä¼°æ¨¡å‹çš„å°±å¯ä»¥äº†ã€‚</p><p>æœ€åæˆ‘ä»¬å¾—åˆ°è¿™æ ·çš„ç»“æœï¼š</p><pre><code class=\"language-plain\">çº¿æ€§å›å½’é¢„æµ‹è¯„åˆ†ï¼š 0.7085754407718876\n</code></pre><p>å¯ä»¥çœ‹åˆ°ï¼Œ$R^{2}$å€¼çº¦ä¸º0.708ã€‚é‚£è¿™æ„å‘³ç€ä»€ä¹ˆå‘¢ï¼Ÿ</p><p>ä¸€èˆ¬æ¥è¯´ï¼Œ$R^{2}$çš„å–å€¼åœ¨0åˆ°1ä¹‹é—´ï¼Œ$R^{2}$è¶Šå¤§ï¼Œè¯´æ˜æ‰€æ‹Ÿåˆçš„å›å½’æ¨¡å‹è¶Šä¼˜ã€‚ç°åœ¨æˆ‘ä»¬å¾—åˆ°çš„$R^{2}$å€¼çº¦ä¸º0.708ï¼Œåœ¨æ²¡æœ‰ä¸å…¶å®ƒæ¨¡å‹è¿›è¡Œæ¯”è¾ƒä¹‹å‰ï¼Œæˆ‘ä»¬å®é™…ä¸Šä¹Ÿæ²¡æ³•ç¡®å®šå®ƒæ˜¯å¦èƒ½ä»¤äººæ»¡æ„ã€‚</p><p>å› ä¸ºåˆ†æ•°çš„é«˜ä½ï¼Œä¸æ•°æ®é›†é¢„æµ‹çš„éš¾æ˜“ç¨‹åº¦ã€æ¨¡å‹çš„ç±»å‹å’Œå‚æ•°éƒ½æœ‰å…³ç³»ã€‚è€Œä¸”ï¼Œ$R^{2}$åˆ†æ•°ä¹Ÿä¸æ˜¯çº¿æ€§å›å½’æ¨¡å‹å”¯ä¸€çš„è¯„ä¼°æ ‡å‡†ã€‚å…³äºæ¨¡å‹çš„è¯„ä¼°å’Œä¼˜åŒ–ï¼Œæˆ‘ä»¬å°±å…ˆè®²åˆ°è¿™é‡Œï¼Œæ›´å¤šå†…å®¹ï¼Œæˆ‘ä»¬è¿˜ä¼šåœ¨ä»¥åé€æ­¥æ·±å…¥è®²è§£ã€‚</p><p>ä¸è¿‡ä½ éœ€è¦çŸ¥é“çš„æ˜¯ï¼Œå¦‚æœæ¨¡å‹çš„è¯„ä¼°åˆ†æ•°ä¸ç†æƒ³ï¼Œæˆ‘ä»¬å°±éœ€è¦å›åˆ°ç¬¬3æ­¥ï¼Œè°ƒæ•´æ¨¡å‹çš„å¤–éƒ¨å‚æ•°ï¼Œé‡æ–°è®­ç»ƒæ¨¡å‹ã€‚è¦æ˜¯å¾—åˆ°çš„ç»“æœä¾æ—§ä¸ç†æƒ³ï¼Œé‚£æˆ‘ä»¬å°±è¦è€ƒè™‘é€‰æ‹©å…¶ä»–ç®—æ³•ï¼Œåˆ›å»ºå…¨æ–°çš„æ¨¡å‹äº†ã€‚å¦‚æœå¾ˆä¸å¹¸ï¼Œæ–°æ¨¡å‹çš„æ•ˆæœè¿˜æ˜¯ä¸å¥½çš„è¯ï¼Œæˆ‘ä»¬å°±å¾—å›åˆ°ç¬¬2æ­¥ï¼Œçœ‹çœ‹æ˜¯ä¸æ˜¯æ•°æ®å‡ºäº†é—®é¢˜ã€‚</p><p><img src=\"https://static001.geekbang.org/resource/image/ba/0c/ba6f2b4e7fb781ecb238af3325c1b40c.jpg?wh=2284x2341\" alt=\"\"></p><p>è¿™ä¹Ÿæ˜¯ä¸ºä»€ä¹ˆï¼Œæˆ‘<strong>ä¸€ç›´å¼ºè°ƒæœºå™¨å­¦ä¹ é¡¹ç›®æ˜¯ä¸€ä¸ªå¾ªç¯è¿­ä»£çš„è¿‡ç¨‹ï¼Œä¼˜ç§€çš„æ¨¡å‹éƒ½æ˜¯ä¸€æ¬¡æ¬¡è¿­ä»£çš„äº§ç‰©</strong>ã€‚</p><p>å½“æ¨¡å‹é€šè¿‡äº†è¯„ä¼°ï¼Œå°±å¯ä»¥å»è§£å†³å®é™…é—®é¢˜äº†ï¼Œæœºå™¨å­¦ä¹ é¡¹ç›®ä¹Ÿç®—æ˜¯åŸºæœ¬ç»“æŸã€‚ä½ æˆ–è®¸ä¼šé—®ï¼Œä¸ºä»€ä¹ˆâ€œå®æˆ˜5æ­¥â€ä¸­æ²¡æœ‰æ¨¡å‹çš„ä¸Šçº¿å’Œéƒ¨ç½²ï¼Ÿè¿™æ˜¯å› ä¸ºåœ¨é€šå¸¸çš„æœºå™¨å­¦ä¹ é¡¹ç›®ä¸­ï¼Œæœºå™¨å­¦ä¹ å·¥ç¨‹å¸ˆå¹¶ä¸è´Ÿè´£è¿™ä¸€å—ï¼Œè€Œä¸”ï¼Œå„ä¸ªå…¬å¸æŠŠæœºå™¨å­¦ä¹ éƒ¨ç½²åˆ°ç”Ÿäº§ç¯å¢ƒçš„æ–¹æ³•ä¹Ÿå¤§ä¸ç›¸åŒã€‚æ‰€ä»¥ï¼Œæˆ‘ä»¬æ²¡æœ‰æŠŠéƒ¨ç½²æ¨¡å‹æ”¾åœ¨æˆ‘ä»¬çš„å®æˆ˜5æ­¥é‡Œã€‚ä¸è¿‡ï¼Œå…·ä½“æ€ä¹ˆéƒ¨ç½²æ¨¡å‹ï¼Œæˆ‘åœ¨åé¢ä¼šè®²åˆ°ã€‚</p><h1>æ€»ç»“ä¸€ä¸‹</h1><p>è¿™ä¸€è®²çš„å†…å®¹åˆ°æ­¤å°±å…¨éƒ¨ç»“æŸäº†ï¼Œç°åœ¨ä½ å·²ç»æ‹¥æœ‰äº†ä¸€æ¬¡å®Œæ•´çš„æœºå™¨å­¦ä¹ å®æˆ˜ç»å†ã€‚æ€ä¹ˆæ ·ï¼Œå¹¶æ²¡æœ‰ä½ æƒ³è±¡å¾—é‚£ä¹ˆéš¾å§ï¼Ÿ</p><p>åœ¨è¿™ä¸€è®²å’Œä¸Šä¸€è®²ä¸­ï¼Œæˆ‘ä»¬é€šè¿‡ä¸€ä¸ªé¢„æµ‹è½¯æ–‡æµè§ˆé‡çš„å®æˆ˜é¡¹ç›®ï¼Œäº†è§£äº†æœºå™¨å­¦ä¹ é¡¹ç›®è¦ç»å†5ä¸ªæ­¥éª¤ã€‚ç¬¬ä¸€æ­¥å°±æ˜¯é€šè¿‡å®šä¹‰é—®é¢˜æ¥æ˜ç¡®æˆ‘ä»¬çš„é¡¹ç›®ç›®æ ‡ï¼›ç¬¬äºŒæ­¥æ˜¯æ•°æ®çš„æ”¶é›†å’Œé¢„å¤„ç†ï¼Œè¿™ä¸€æ­¥çš„é‡ç‚¹æ˜¯æŠŠæ•°æ®è½¬æ¢æˆæœºå™¨å­¦ä¹ å¯å¤„ç†çš„æ ¼å¼ï¼Œè¿™æ ·æˆ‘ä»¬å°±å¯ä»¥åœ¨ç¬¬ä¸‰æ­¥ä¸­é’ˆå¯¹é—®é¢˜é€‰å®šé€‚å®œçš„ç®—æ³•ï¼Œæ¥å»ºç«‹æ¨¡å‹äº†ã€‚</p><p>æœ‰äº†æ¨¡å‹åï¼Œæˆ‘ä»¬è¦åœ¨æ¥ä¸‹æ¥çš„ç¬¬å››æ­¥ä¸­è®­ç»ƒæ¨¡å‹ã€æ‹Ÿåˆå‡½æ•°ã€‚æœ€åï¼Œå†å¯¹è®­ç»ƒå¥½çš„æ¨¡å‹è¿›è¡Œè¯„ä¼°å’Œä¼˜åŒ–ã€‚å¯¹äºè¿™æœ€åä¸€æ­¥ï¼Œä¹Ÿå°±æ˜¯ç¬¬5æ­¥ï¼Œæˆ‘ä»¬çš„é‡ç‚¹æ˜¯åå¤æµ‹è¯„ï¼Œæ‰¾åˆ°æœ€ä¼˜çš„è¶…å‚æ•°ï¼Œç¡®å®šæœ€ç»ˆæ¨¡å‹ã€‚</p><p><img src=\"https://static001.geekbang.org/resource/image/e8/02/e8b5a33fa7b0576f95f97f627f600402.jpg?wh=2284x1245\" alt=\"\"></p><p>åœ¨è¿™â€œå®æˆ˜5æ­¥â€ä¸­ï¼Œæˆ‘ä»¬æ¯ä¸€æ­¥åšäº†äº›ä»€ä¹ˆã€æœºå™¨å­¦ä¹ æ¨¡å‹åšäº†äº›ä»€ä¹ˆï¼Œéƒ½éœ€è¦ä½ å¥½å¥½åœ°ç†è§£å’Œä½“ä¼šã€‚ä»ä¸‹ä¸€è®²å¼€å§‹ï¼Œæˆ‘ä»¬å°±è¦è¿›å…¥æ›´æ¥è¿‘å®é™…ä¸šåŠ¡åœºæ™¯çš„é¡¹ç›®å®æˆ˜äº†ï¼Œæˆ‘ä¼šå¼•å¯¼ç€ä½ è¿›ä¸€æ­¥åŠ æ·±å¯¹æ•°æ®å’Œæœºå™¨å­¦ä¹ æ¦‚å¿µçš„ç†è§£ï¼ŒæŒ–æ˜å‡ºæ•°æ®ä¹‹ä¸­çš„ä»·å€¼ã€‚</p><p>å‡†å¤‡å¥½äº†å—ï¼Ÿè®©æˆ‘ä»¬ç»§ç»­ä¸Šè·¯ï¼Œå¼€å§‹æ­£å¼é—¯å…³ï¼Œåœ¨åŠ¨æ‰‹å®è·µä¸­æŠŠæœºå™¨å­¦ä¹ çŸ¥è¯†ç”¨èµ·æ¥ï¼</p><h1>æ€è€ƒé¢˜</h1><p>è¿™èŠ‚è¯¾è®²å®Œäº†ï¼Œæˆ‘ç»™ä½ ç•™çš„æ€è€ƒé¢˜æ˜¯è¿™æ ·çš„ï¼š</p><p>åœ¨æˆ‘ä»¬è¿™ä¸ªé¡¹ç›®ä¸­ï¼Œä½¿ç”¨çš„æ˜¯çº¿æ€§å›å½’æ¨¡å‹LinearRegressionçš„é»˜è®¤å¤–éƒ¨å‚æ•°ã€‚æ­¤æ—¶ï¼Œä¸¤ä¸ªå‚æ•°çš„é»˜è®¤å€¼åˆ†åˆ«æ˜¯ï¼Œfit_intercept&nbsp;= Trueï¼Œnormalize = Falseã€‚å°½ç®¡è§£é‡Šç®—æ³•ä¸­æ¯ä¸€ä¸ªå‚æ•°çš„å…·ä½“æ„ä¹‰å¹¶éæˆ‘ä»¬çš„è¯¾ç¨‹é‡ç‚¹ï¼Œä½†æ˜¯é˜…è¯»ç®—æ³•å’Œå‚æ•°çš„è¯´æ˜æ–‡æ¡£ï¼Œç„¶åè°ƒæ•´å‚æ•°ï¼Œä¼˜åŒ–æ¨¡å‹ï¼Œå´æ˜¯æœºå™¨å­¦ä¹ é¡¹ç›®çš„æ—¥å¸¸å·¥ä½œã€‚</p><p>å› æ­¤ï¼Œè¯·ä½ ç”¨fit_intercept&nbsp;å’Œnormalizeè¿™ä¸¤ä¸ªå‚æ•°ç»ƒç»ƒæ‰‹ï¼Œè‡ªå·±è°ƒæ•´å®ƒä»¬çš„å€¼ï¼Œå½¢æˆå„ç§ç»„åˆï¼Œé‡æ–°è®­ç»ƒå‡ºå…¶å®ƒå¤–éƒ¨å‚æ•°ç»„åˆçš„æ¨¡å‹ã€‚æˆ‘ä»¬å¯ä»¥å¤§æ¦‚ç®—ä¸€ä¸‹ï¼Œä¸¤ä¸ªå¸ƒå°”ç±»å‹å‚æ•°æœ€å¤šå°±å½¢æˆ4ç§ç»„åˆï¼Œè€Œä¸”æˆ‘ä»¬çš„é»˜è®¤å‚æ•°å·²ç»è®­ç»ƒå‡ºäº†å…¶ä¸­çš„ä¸€ç§ï¼Œæ‰€ä»¥ä½ å¯ä»¥å°è¯•å…¶å®ƒä¸‰ç§ã€‚</p><p>å¦å¤–ï¼Œä½ ä¹Ÿå¯ä»¥çœ‹ä¸€çœ‹ï¼Œå¯¹äºè¿™ä¸ªæ•°æ®é›†æ¥è¯´ï¼Œå–å“ªç»„fit_interceptå’Œnormalizeå€¼ï¼Œä½ çš„æ¨¡å‹æµ‹è¯•ç»“æœæ›´ä¼˜ï¼Ÿ</p><p>æœ€åï¼Œç»™ä½ ä¸€ä¸ªå°æç¤ºï¼Œå¦‚æœä½ å¸Œæœ›å¯¹å˜é‡Xåšâ€œè§„èŒƒåŒ–â€ï¼Œåœ¨å»ºç«‹æ¨¡å‹çš„åŒæ—¶å°±è¦æŒ‡å®šå¤–éƒ¨å‚æ•°normalizeçš„å€¼ï¼š</p><pre><code class=\"language-plain\">from sklearn.linear_model import LinearRegression # å¯¼å…¥çº¿æ€§å›å½’ç®—æ³•æ¨¡å‹\nlinereg_model = LinearRegression(normalize&nbsp;=&nbsp;True) # ä½¿ç”¨çº¿æ€§å›å½’ç®—æ³•åˆ›å»ºæ¨¡å‹,å¹¶æŒ‡å®šå¤–éƒ¨å‚æ•°normalize\n</code></pre><p>æ¬¢è¿ä½ åœ¨ç•™è¨€åŒºåˆ†äº«ä½ çš„æƒ³æ³•å’Œæ”¶è·ï¼Œæˆ‘åœ¨ç•™è¨€åŒºç­‰ä½ ã€‚å¦‚æœè¿™èŠ‚è¯¾å¸®åˆ°äº†ä½ ï¼Œä¹Ÿæ¬¢è¿ä½ æŠŠè¿™èŠ‚è¯¾åˆ†äº«ç»™è‡ªå·±çš„æœ‹å‹ã€‚</p><p><img src=\"https://static001.geekbang.org/resource/image/56/81/5647a4e7bc72e040d8654df556f72081.jpg?wh=2284x1136\" alt=\"\"></p>","comments":[{"had_liked":false,"id":310772,"user_name":"åœ¨è·¯ä¸Š","can_delete":false,"product_type":"c1","uid":1402511,"ip_address":"","ucode":"6E31908EFE1107","user_header":"https://static001.geekbang.org/account/avatar/00/15/66/8f/02be926d.jpg","comment_is_top":true,"comment_ctime":1630899768,"is_pvip":false,"replies":[{"id":"112609","content":"ç½®é¡¶ï¼","user_name":"ä½œè€…å›å¤","user_name_real":"é»„ä½³","uid":"1809833","ctime":1630909425,"ip_address":"","comment_id":310772,"utype":1}],"discussion_count":2,"race_medal":0,"score":"9.2233720857302999e+18","product_id":100085501,"comment_content":"ä½³å“¥å¥½ï¼Œè¿™èŠ‚è¯¾çš„ç¤ºä¾‹åœ¨æˆ‘çš„ç”µè„‘ä¸Šè¿è¡Œä¼šæŠ¥é”™ï¼šGlyph 28909 missing from current font. font.set_text(s, 0.0, flags=flags)ï¼ŒåŸå› æ˜¯ä¸­æ–‡å­—ä½“ä¹±ç ï¼Œè§£å†³æ–¹æ³•æ˜¯è®¾ç½®ä¸€ä¸ªæœ¬åœ°æœ‰çš„ä¸­æ–‡å­—ä½“ï¼Œå¯ä»¥å…ˆæ‰“å°ä¸‹æœ¬åœ°æ”¯æŒçš„å­—ä½“ï¼Œæ–¹æ³•å¦‚ä¸‹ï¼Œåœ¨`import matplotlib.pyplot as plt`è¿™æ¡è¯­å¥æ‰€åœ¨çš„å•å…ƒæ ¼æ’å…¥ä»£ç ï¼š<br>```<br>from matplotlib import font_manager<br>for font in font_manager.fontManager.ttflist:<br>    # æŸ¥çœ‹å­—ä½“åä»¥åŠå¯¹åº”çš„å­—ä½“æ–‡ä»¶å<br>    print(font.name, &#39;-&#39;, font.fname)<br># æˆ‘ä½¿ç”¨äº†å¾®è½¯é›…é»‘<br>plt.rcParams[&#39;font.sans-serif&#39;]=&#39;Microsoft YaHei&#39;   <br>```<br><br>è°ƒæ•´å‚æ•°åçš„æµ‹è¯•ç»“æœæ˜¯ï¼š<br>LinearRegression(normalize = True, fit_intercept= False)<br>çº¿æ€§å›å½’é¢„æµ‹é›†è¯„åˆ†ï¼š 0.689427235535854<br>çº¿æ€§å›å½’è®­ç»ƒé›†è¯„åˆ†ï¼š 0.6947857687516026<br><br>LinearRegression(normalize = False, fit_intercept= False)<br>çº¿æ€§å›å½’é¢„æµ‹é›†è¯„åˆ†ï¼š 0.689427235535854<br>çº¿æ€§å›å½’è®­ç»ƒé›†è¯„åˆ†ï¼š 0.6947857687516026<br><br>LinearRegression(normalize = True, fit_intercept= True)<br>çº¿æ€§å›å½’é¢„æµ‹é›†è¯„åˆ†ï¼š 0.740552064611524<br>çº¿æ€§å›å½’è®­ç»ƒé›†è¯„åˆ†ï¼š 0.7422107889561247<br><br>LinearRegression(normalize = True, fit_intercept= True)<br>çº¿æ€§å›å½’é¢„æµ‹é›†è¯„åˆ†ï¼š 0.740552064611524<br>çº¿æ€§å›å½’è®­ç»ƒé›†è¯„åˆ†ï¼š 0.7422107889561247","like_count":12,"discussions":[{"author":{"id":1809833,"avatar":"https://static001.geekbang.org/account/avatar/00/1b/9d/a9/4602808f.jpg","nickname":"é»„ä½³","note":"","ucode":"8EC41D2EAB0E3C","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":526345,"discussion_content":"ç½®é¡¶ï¼","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1630909425,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":2750760,"avatar":"https://static001.geekbang.org/account/avatar/00/29/f9/28/dc7d0b76.jpg","nickname":"zzzzzlj","note":"","ucode":"C09537664B4DBC","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":392517,"discussion_content":"æˆ‘ä¹Ÿé‡åˆ°äº†ä¸€æ ·çš„é—®é¢˜ï¼ï¼æ„Ÿè°¢ï¼ï¼ï¼","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1631025572,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":310807,"user_name":"èŒœèŒœ","can_delete":false,"product_type":"c1","uid":2652053,"ip_address":"","ucode":"8861DD63536EEF","user_header":"https://static001.geekbang.org/account/avatar/00/28/77/95/0d10d4b2.jpg","comment_is_top":true,"comment_ctime":1630918514,"is_pvip":false,"replies":[{"id":"112632","content":"ååˆ†è®¤çœŸï¼","user_name":"ä½œè€…å›å¤","user_name_real":"é»„ä½³","uid":"1809833","ctime":1630932270,"ip_address":"","comment_id":310807,"utype":1}],"discussion_count":4,"race_medal":0,"score":"9.2233720728454001e+18","product_id":100085501,"comment_content":"åœ¨æ–¹æ³•2æˆ‘ä½¿ç”¨äº†ç½‘æ ¼æœç´¢è‡ªåŠ¨è°ƒå‚ï¼Œå¯ä»¥è·å¾—æ›´å¥½çš„é¢„æµ‹è¯„åˆ†ã€‚<br># æ€è€ƒé¢˜;<br>from sklearn.model_selection import train_test_split<br>from sklearn.linear_model import LinearRegression <br>from sklearn.model_selection import GridSearchCV<br>import pandas as pd<br>import chardet<br>import itertools<br>#æŸ¥è¯¢ç¼–ç æ ¼å¼<br>with open(&#39;æ˜“é€Ÿé²œèŠ±å¾®ä¿¡è½¯æ–‡.csv&#39;, &#39;rb&#39;) as f:<br>    enc = chardet.detect(f.read())  # or readline if the file is large <br>#è¯»å–æ•°æ®<br>df_ads = pd.read_csv(&#39;æ˜“é€Ÿé²œèŠ±å¾®ä¿¡è½¯æ–‡.csv&#39;, encoding = enc[&#39;encoding&#39;])<br># åˆ¤æ–­ç©ºå€¼<br>df_ads.isna().sum()<br># åˆ æ‰å«ç©ºå€¼çš„è¡Œ<br>df_ads = df_ads.dropna()<br># æ„å»ºç‰¹å¾é›†å’Œæ ‡ç­¾é›†<br>x = df_ads.drop([&#39;æµè§ˆé‡&#39;], axis = 1)<br>y = df_ads[&#39;æµè§ˆé‡&#39;]<br># æ‹†åˆ†è®­ç»ƒé›†(80%)å’Œæµ‹è¯•é›†(20%)<br>xtrain, xtest, ytrain, ytest = train_test_split(x, y, test_size = 0.2, random_state = 0)<br><br># è°ƒå‚ï¼šæ–¹æ³•ä¸€<br>fit_intercept_list = [True, False]<br>normalize_list = [True, False]<br>print(&#39;æ–¹æ³•1&#39;)<br>for item in itertools.product(fit_intercept_list, fit_intercept_list):<br>    fit_intercept = item[0]<br>    normalize = item[1]<br>    # è®­ç»ƒæ¨¡å‹<br>    linereg_model = LinearRegression(fit_intercept = fit_intercept, normalize = normalize)<br>    linereg_model.fit(xtrain, ytrain)<br>    # é¢„æµ‹æµ‹è¯•é›†å¯¹çš„yå€¼<br>    y_pred  = linereg_model.predict(xtest)<br>    # ç»™å‡ºæ¨¡å‹è¯„åˆ†(ä½¿ç”¨éªŒè¯é›†)<br>    print(f&#39;å‚æ•°ç»„åˆ; fit_intercept = {fit_intercept},normalize = {normalize}&#39;,&#39;çº¿æ€§å›å½’é¢„æµ‹è¯„åˆ†:&#39;, linereg_model.score(xtest, ytest))  <br><br># è°ƒå‚ï¼šæ–¹æ³•2<br>model =  LinearRegression()<br># å»ºç«‹éœ€è¦æœç´¢çš„å‚æ•°çš„èŒƒå›´<br>param ={&#39;fit_intercept&#39;:[True, False],&#39;normalize&#39;: [True, False]}<br># åˆå§‹åŒ–ç½‘æ ¼æœç´¢çš„æ–¹æ³•<br>grid = GridSearchCV(model,param)<br>#ç”¨ç½‘æ ¼æœç´¢æ–¹æ³•è¿›è¡Œæ‹Ÿåˆæ•°æ®<br>grid.fit(x, y)<br># è¾“å‡ºæœ€ä¼˜çš„å‚æ•°ç»„åˆ<br>print(&#39;æ–¹æ³•2&#39;)<br>print(&#39;æœ€ä½³æ¨¡å‹çš„å‚æ•°ç»„åˆï¼š&#39;, grid.best_params_)<br>print(&#39;æ ·æœ¬å¾—åˆ†å¹³å‡å€¼:&#39;,grid.best_score_)<br>print(&#39;æœ€ä½³æ¨¡å‹æµ‹é¢„æµ‹è¯„åˆ†ï¼š&#39;,grid.score(xtest, ytest))<br><br>#ç»“è®ºï¼š<br>#1. æœ€ä½³å‚æ•°ç»„åˆæ˜¯ï¼š{&#39;fit_intercept&#39;: True, &#39;normalize&#39;: True} æˆ– {&#39;fit_intercept&#39;: True, &#39;normalize&#39;: False}<br>#2. æ–¹æ³•2 çš„é¢„æµ‹è¯„åˆ†ï¼š0.75 é«˜äºæ–¹æ³•1çš„é¢„æµ‹è¯„åˆ†ï¼š0.74","like_count":9,"discussions":[{"author":{"id":1809833,"avatar":"https://static001.geekbang.org/account/avatar/00/1b/9d/a9/4602808f.jpg","nickname":"é»„ä½³","note":"","ucode":"8EC41D2EAB0E3C","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":526362,"discussion_content":"ååˆ†è®¤çœŸï¼","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1630932270,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1037367,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/d4/37/bb19dbcd.jpg","nickname":"æ¥¼æ¢¯å£å€’ç«‹","note":"","ucode":"BE53FDB3A3F085","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":582721,"discussion_content":"{&#39;fit_intercept&#39;: True, &#39;normalize&#39;: False} è¿™ä¸æ˜¯é»˜è®¤å€¼ï¼Ÿ","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1659604894,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":"ç¾å›½"},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":2813087,"avatar":"https://static001.geekbang.org/account/avatar/00/2a/ec/9f/7fa3bf00.jpg","nickname":"Elaine","note":"","ucode":"BC35964F85B55B","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":411026,"discussion_content":"å°å§å§å¥½å¼ºï¼Œä½†æœ‰ä¸ªtypo åº”è¯¥æ˜¯for item in itertools.product(fit_intercept_list, normalize_list): ","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1635833082,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1087879,"avatar":"https://static001.geekbang.org/account/avatar/00/10/99/87/98ebb20e.jpg","nickname":"dao","note":"","ucode":"4181FB270462CF","race_medal":0,"user_type":1,"is_pvip":true},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":402408,"discussion_content":"ä¸ºä»€ä¹ˆæ˜¯ print(&#39;æœ€ä½³æ¨¡å‹æµ‹é¢„æµ‹è¯„åˆ†ï¼š&#39;,grid.score(xtest, ytest))ï¼Œ\nè€Œä¸æ˜¯ print(&#39;æœ€ä½³æ¨¡å‹æµ‹é¢„æµ‹è¯„åˆ†ï¼š&#39;,grid.score(x, y)) ï¼Ÿ","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1633875817,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":310819,"user_name":"èŒœèŒœ","can_delete":false,"product_type":"c1","uid":2652053,"ip_address":"","ucode":"8861DD63536EEF","user_header":"https://static001.geekbang.org/account/avatar/00/28/77/95/0d10d4b2.jpg","comment_is_top":true,"comment_ctime":1630922233,"is_pvip":false,"replies":[{"id":"112631","content":"çœ‹åˆ°ä½ çš„ç­”æ¡ˆé‡Œé¢å·²ç»ç”¨äº†GridSearchCVã€‚å¾ˆå¥½ï¼ŒGridSearchCVï¼Œé»˜è®¤å·²ç»ä½¿ç”¨äº†5æŠ˜äº¤å‰éªŒè¯ï¼Œå°±æ˜¯å…¶ä¸­çš„CVå‚æ•°ã€‚é‚£ä¹ˆæˆ‘ä»¬åŸæ¥ä¸æ˜¯è¯´3ä¸ªé›†å—ï¼Œè®­ç»ƒé›†ï¼ŒéªŒè¯é›†ï¼Œæµ‹è¯•é›†ã€‚å› ä¸ºGridSearchCVæœ‰å·²ç»è‡ªå¸¦äº¤å‰éªŒè¯çš„å­˜åœ¨ã€‚å°±ä¸å†éœ€è¦éªŒè¯é›†äº†ã€‚<br>è€Œæµ‹è¯•é›†ï¼Œè¿˜éœ€è¦ï¼Œç›®çš„æ˜¯æŠŠGridSearchCVçš„äº¤å‰éªŒè¯ç»“æœæ‹¿åˆ°æµ‹è¯•é›†åšæœ€åæµ‹è¯•ã€‚<br>å¥½é—®é¢˜ã€‚è°¢è°¢ã€‚","user_name":"ä½œè€…å›å¤","user_name_real":"é»„ä½³","uid":"1809833","ctime":1630932251,"ip_address":"","comment_id":310819,"utype":1}],"discussion_count":4,"race_medal":0,"score":"9.2233720599605002e+18","product_id":100085501,"comment_content":"é»„è€å¸ˆï¼Œæˆ‘æœ‰ä¸€ä¸ªé—®é¢˜ï¼Œåœ¨ä½¿ç”¨GridSearchCVå‰ï¼Œéœ€è¦åˆ’åˆ†è®­ç»ƒé›†å’Œæµ‹è¯•é›†å—ï¼ŸæŒ‰ç…§ä»€ä¹ˆæ¯”ä¾‹åˆ’åˆ†å‘¢ï¼Ÿè°¢è°¢","like_count":6,"discussions":[{"author":{"id":1809833,"avatar":"https://static001.geekbang.org/account/avatar/00/1b/9d/a9/4602808f.jpg","nickname":"é»„ä½³","note":"","ucode":"8EC41D2EAB0E3C","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":526367,"discussion_content":"çœ‹åˆ°ä½ çš„ç­”æ¡ˆé‡Œé¢å·²ç»ç”¨äº†GridSearchCVã€‚å¾ˆå¥½ï¼ŒGridSearchCVï¼Œé»˜è®¤å·²ç»ä½¿ç”¨äº†5æŠ˜äº¤å‰éªŒè¯ï¼Œå°±æ˜¯å…¶ä¸­çš„CVå‚æ•°ã€‚é‚£ä¹ˆæˆ‘ä»¬åŸæ¥ä¸æ˜¯è¯´3ä¸ªé›†å—ï¼Œè®­ç»ƒé›†ï¼ŒéªŒè¯é›†ï¼Œæµ‹è¯•é›†ã€‚å› ä¸ºGridSearchCVæœ‰å·²ç»è‡ªå¸¦äº¤å‰éªŒè¯çš„å­˜åœ¨ã€‚å°±ä¸å†éœ€è¦éªŒè¯é›†äº†ã€‚\nè€Œæµ‹è¯•é›†ï¼Œè¿˜éœ€è¦ï¼Œç›®çš„æ˜¯æŠŠGridSearchCVçš„äº¤å‰éªŒè¯ç»“æœæ‹¿åˆ°æµ‹è¯•é›†åšæœ€åæµ‹è¯•ã€‚\nå¥½é—®é¢˜ã€‚è°¢è°¢ã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1630932251,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1178201,"avatar":"https://static001.geekbang.org/account/avatar/00/11/fa/59/52a504f6.jpg","nickname":"u","note":"","ucode":"6FDCEA63AE67C3","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":392423,"discussion_content":"åŒå­¦ï¼Œä½ ä¸ºä½•å¦‚æ­¤ä¼˜ç§€ ğŸ‘","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1631002002,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":1,"child_discussions":[{"author":{"id":2652053,"avatar":"https://static001.geekbang.org/account/avatar/00/28/77/95/0d10d4b2.jpg","nickname":"èŒœèŒœ","note":"","ucode":"8861DD63536EEF","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":1178201,"avatar":"https://static001.geekbang.org/account/avatar/00/11/fa/59/52a504f6.jpg","nickname":"u","note":"","ucode":"6FDCEA63AE67C3","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":392466,"discussion_content":"ä½ ä¹Ÿå¾ˆä¼˜ç§€^*^","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1631013606,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":392423,"ip_address":""},"score":392466,"extra":""}]},{"author":{"id":2652053,"avatar":"https://static001.geekbang.org/account/avatar/00/28/77/95/0d10d4b2.jpg","nickname":"èŒœèŒœ","note":"","ucode":"8861DD63536EEF","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":392283,"discussion_content":"è°¢è°¢é»„è€å¸ˆçš„æŒ‡ç‚¹ï¼Œæˆ‘æ˜ç™½äº†ã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1630933335,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":310973,"user_name":"u","can_delete":false,"product_type":"c1","uid":1178201,"ip_address":"","ucode":"6FDCEA63AE67C3","user_header":"https://static001.geekbang.org/account/avatar/00/11/fa/59/52a504f6.jpg","comment_is_top":false,"comment_ctime":1631006139,"is_pvip":false,"replies":[{"id":"112687","content":"ğŸ‘","user_name":"ä½œè€…å›å¤","user_name_real":"é»„ä½³","uid":"1809833","ctime":1631021844,"ip_address":"","comment_id":310973,"utype":1}],"discussion_count":1,"race_medal":0,"score":"18810875323","product_id":100085501,"comment_content":"ä»£ç ï¼š<br><br>@pytest.mark.parametrize(&quot;fit_intercept&quot;, [True, False])<br>@pytest.mark.parametrize(&quot;normalize&quot;, [True, False])<br>def test_train_model(fit_intercept, normalize):<br>    df_cleaned = df_data.dropna()<br>    feature_set = df_cleaned.drop([&#39;æµè§ˆé‡&#39;], axis=1)<br>    label_set = df_cleaned[&#39;æµè§ˆé‡&#39;]<br>    x_train, x_test, y_train, y_test = train_test_split(feature_set, label_set,<br>                                                        train_size=0.8, test_size=0.2, random_state=0)<br>    line_reg_model = LR(fit_intercept=fit_intercept, normalize=normalize)<br>    line_reg_model.fit(x_train, y_train)<br>    y_pred = line_reg_model.predict(x_test)<br>    features = x_test.copy()<br>    features[&#39;çœŸæµè§ˆé‡&#39;] = y_test<br>    features[&#39;é¢„æµ‹æµè§ˆé‡&#39;] = y_pred<br>    print()<br>    print(&quot;===============fit_intercept=&quot;, fit_intercept, &quot;,normalize=&quot;, normalize, &quot;====================&quot;)<br>    print(&quot;æ¨¡å‹çš„æƒé‡åˆ†åˆ«æ˜¯ï¼š&quot;, line_reg_model.coef_)<br>    print(&quot;æ¨¡å‹çš„æˆªè·æ˜¯ï¼š&quot;, line_reg_model.intercept_)<br>    print(&quot;çº¿æ€§å›å½’é¢„æµ‹åˆ†æ•°æ˜¯ï¼š&quot;, line_reg_model.score(x_test, y_test))<br>    print(&quot;========================================&quot;)<br><br>","like_count":4,"discussions":[{"author":{"id":1809833,"avatar":"https://static001.geekbang.org/account/avatar/00/1b/9d/a9/4602808f.jpg","nickname":"é»„ä½³","note":"","ucode":"8EC41D2EAB0E3C","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":526415,"discussion_content":"ğŸ‘","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1631021844,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":320904,"user_name":"ğŸ‡± ã€ğŸ‡²","can_delete":false,"product_type":"c1","uid":2840148,"ip_address":"","ucode":"F709EA85196768","user_header":"https://static001.geekbang.org/account/avatar/00/2b/56/54/f8d9e6e0.jpg","comment_is_top":false,"comment_ctime":1636551190,"is_pvip":false,"replies":[{"id":"116877","content":"æ˜ä½¬ç¾¤ä¸­è§£å†³äº†å¯¹å§ï¼Œç”¨inplace = Trueè®©åˆ é™¤è¯­å¥ç›´æ¥ä¿®æ”¹åŸæœ‰dfå¯¹è±¡ã€‚","user_name":"ä½œè€…å›å¤","user_name_real":"ç¼–è¾‘","uid":"1809833","ctime":1637075454,"ip_address":"","comment_id":320904,"utype":1}],"discussion_count":2,"race_medal":0,"score":"10226485782","product_id":100085501,"comment_content":"ä½³å“¥ï¼Œæˆ‘åœ¨åˆ é™¤nançš„è¡Œä¹‹åï¼Œå†ç»Ÿè®¡NANå‡ºç°çš„æ¬¡æ•°ï¼Œè¿˜æ˜¯æœ‰nanã€‚è¿™å°±å¯¼è‡´åé¢å»ºæ¨¡å‹ï¼ŒæŠ¥é”™<br>ValueError: Input contains NaN, infinity or a value too large for dtype(&#39;float64&#39;).","like_count":2,"discussions":[{"author":{"id":1809833,"avatar":"https://static001.geekbang.org/account/avatar/00/1b/9d/a9/4602808f.jpg","nickname":"é»„ä½³","note":"","ucode":"8EC41D2EAB0E3C","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":530459,"discussion_content":"æ˜ä½¬ç¾¤ä¸­è§£å†³äº†å¯¹å§ï¼Œç”¨inplace = Trueè®©åˆ é™¤è¯­å¥ç›´æ¥ä¿®æ”¹åŸæœ‰dfå¯¹è±¡ã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1637075454,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":2840148,"avatar":"https://static001.geekbang.org/account/avatar/00/2b/56/54/f8d9e6e0.jpg","nickname":"ğŸ‡± ã€ğŸ‡²","note":"","ucode":"F709EA85196768","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":530701,"discussion_content":"å—¯å—¯ï¼Œè§£å†³äº†ï¼Œå“ˆå“ˆå“ˆ","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1637130317,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"user_type\":1}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":310759,"user_name":"GACÂ·DU","can_delete":false,"product_type":"c1","uid":1385403,"ip_address":"","ucode":"7847FBE1C13740","user_header":"https://static001.geekbang.org/account/avatar/00/15/23/bb/a1a61f7c.jpg","comment_is_top":false,"comment_ctime":1630895797,"is_pvip":true,"replies":[{"id":"112584","content":"è¯¾ä»£è¡¨ï¼","user_name":"ä½œè€…å›å¤","user_name_real":"é»„ä½³","uid":"1809833","ctime":1630897874,"ip_address":"","comment_id":310759,"utype":1}],"discussion_count":3,"race_medal":0,"score":"10220830389","product_id":100085501,"comment_content":"å¯¹fit_interceptå’Œnormalizeè¿™ä¸¤ä¸ªå‚æ•°åšäº†ä¸€ä¸‹æµ‹è¯•ï¼Œå‘ç°normalizeçš„å€¼æ˜¯Trueè¿˜æ˜¯Falseå¯¹æ¨¡å‹è¯„ä¼°çš„å€¼å‡ ä¹æ²¡æœ‰å½±å“ï¼Œä½†æ˜¯fit_interceptçš„å€¼å¦‚æœä¸ºFalseå¯¹æ¨¡å‹è¯„ä¼°å€¼å½±å“è¾ƒå¤§ï¼Œæˆ‘ç”¨google colabè¿›è¡Œçš„æµ‹è¯•ã€‚","like_count":2,"discussions":[{"author":{"id":1809833,"avatar":"https://static001.geekbang.org/account/avatar/00/1b/9d/a9/4602808f.jpg","nickname":"é»„ä½³","note":"","ucode":"8EC41D2EAB0E3C","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":526341,"discussion_content":"è¯¾ä»£è¡¨ï¼","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1630897874,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1917715,"avatar":"https://static001.geekbang.org/account/avatar/00/1d/43/13/649ccaa9.jpg","nickname":"æµ·æ—Lin","note":"","ucode":"26333AE3DFAF9D","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":392244,"discussion_content":"è¯·æ•™ä½¿ç”¨google colabéœ€è¦æ¢¯å­å—ã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1630919988,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":1,"child_discussions":[{"author":{"id":1809833,"avatar":"https://static001.geekbang.org/account/avatar/00/1b/9d/a9/4602808f.jpg","nickname":"é»„ä½³","note":"","ucode":"8EC41D2EAB0E3C","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":1917715,"avatar":"https://static001.geekbang.org/account/avatar/00/1d/43/13/649ccaa9.jpg","nickname":"æµ·æ—Lin","note":"","ucode":"26333AE3DFAF9D","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":392277,"discussion_content":"ä¼°è®¡éœ€è¦ç§‘å­¦ä¸Šç½‘ å¸Œæœ›å¤§å®¶åˆ†äº«ä¸€ä¸‹æ–¹æ³•\nhttps://colab.research.google.com/","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1630931919,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":392244,"ip_address":""},"score":392277,"extra":""}]}]},{"had_liked":false,"id":310722,"user_name":"å¹´è½»","can_delete":false,"product_type":"c1","uid":1900044,"ip_address":"","ucode":"0EE1C7B82DD960","user_header":"https://static001.geekbang.org/account/avatar/00/1c/fe/0c/f5267835.jpg","comment_is_top":false,"comment_ctime":1630859762,"is_pvip":true,"replies":[{"id":"112558","content":"ç»™åŠ›ï¼åç»­å†…å®¹æ›´ç²¾å½©ï¼Œæ•¬è¯·æœŸå¾…ã€‚","user_name":"ä½œè€…å›å¤","user_name_real":"é»„ä½³","uid":"1809833","ctime":1630861471,"ip_address":"","comment_id":310722,"utype":1}],"discussion_count":1,"race_medal":0,"score":"10220794354","product_id":100085501,"comment_content":"ğŸ‘ğŸ‘ğŸ‘ğŸ‘ğŸ‘ğŸ‘ğŸ‘ğŸ‘ğŸ‘ğŸ‘ğŸ‘ğŸ‘ğŸ‘ğŸ‘ğŸ‘ğŸ‘ğŸ‘ğŸ‘ğŸ‘ğŸ‘ğŸ‘ğŸ‘ğŸ‘ğŸ‘","like_count":2,"discussions":[{"author":{"id":1809833,"avatar":"https://static001.geekbang.org/account/avatar/00/1b/9d/a9/4602808f.jpg","nickname":"é»„ä½³","note":"","ucode":"8EC41D2EAB0E3C","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":526323,"discussion_content":"ç»™åŠ›ï¼åç»­å†…å®¹æ›´ç²¾å½©ï¼Œæ•¬è¯·æœŸå¾…ã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1630861471,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":314615,"user_name":"æ²³å®£æ½®å¹¿","can_delete":false,"product_type":"c1","uid":2778064,"ip_address":"","ucode":"CD5B4AA2EF263D","user_header":"https://static001.geekbang.org/account/avatar/00/2a/63/d0/a0cc950d.jpg","comment_is_top":false,"comment_ctime":1633259083,"is_pvip":false,"replies":[{"id":"116868","content":"è¿™é‡Œåªæ˜¯ä¸€ä¸ªæç®€åŒ–äº†çš„ç¤ºä¾‹ï¼Œå› æ­¤å¹¶æ²¡æœ‰æ˜ç¡®è®¡ç®—å…¬å¼ã€‚åœ¨å…·ä½“çš„ä¸šåŠ¡æ¨¡å‹ä¸­ï¼Œä¸åŒåœºæ™¯çš„ä¸šåŠ¡æŒ‡æ ‡éƒ½ä¼šæœ‰å¯¹åº”çš„è®¡ç®—æ–¹æ³•ï¼Œä¸è¿‡è¿™å¹¶éè¿™ä¸ªç¤ºä¾‹çš„å…³æ³¨ç‚¹ã€‚","user_name":"ä½œè€…å›å¤","user_name_real":"ç¼–è¾‘","uid":"1809833","ctime":1637074001,"ip_address":"","comment_id":314615,"utype":1}],"discussion_count":1,"race_medal":0,"score":"5928226379","product_id":100085501,"comment_content":"æœ‰ä¸ªé—®é¢˜ï¼Œè¯·æ•™è€å¸ˆï¼Œçƒ­åº¦æŒ‡æ•°å’Œå…¶ä»–å‡ ä¸ªå˜é‡æ˜¯ä¸æ˜¯æœ‰æ˜ç¡®çš„è®¡ç®—å…¬å¼ã€‚","like_count":1,"discussions":[{"author":{"id":1809833,"avatar":"https://static001.geekbang.org/account/avatar/00/1b/9d/a9/4602808f.jpg","nickname":"é»„ä½³","note":"","ucode":"8EC41D2EAB0E3C","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":530434,"discussion_content":"è¿™é‡Œåªæ˜¯ä¸€ä¸ªæç®€åŒ–äº†çš„ç¤ºä¾‹ï¼Œå› æ­¤å¹¶æ²¡æœ‰æ˜ç¡®è®¡ç®—å…¬å¼ã€‚åœ¨å…·ä½“çš„ä¸šåŠ¡æ¨¡å‹ä¸­ï¼Œä¸åŒåœºæ™¯çš„ä¸šåŠ¡æŒ‡æ ‡éƒ½ä¼šæœ‰å¯¹åº”çš„è®¡ç®—æ–¹æ³•ï¼Œä¸è¿‡è¿™å¹¶éè¿™ä¸ªç¤ºä¾‹çš„å…³æ³¨ç‚¹ã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1637074001,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":311941,"user_name":"è¶èˆæ¸…é£å¯’","can_delete":false,"product_type":"c1","uid":2753090,"ip_address":"","ucode":"2818B4BE7DCC16","user_header":"https://static001.geekbang.org/account/avatar/00/2a/02/42/e8ef9639.jpg","comment_is_top":false,"comment_ctime":1631539831,"is_pvip":false,"replies":[{"id":"113041","content":"1ã€fit_intercept=Trueï¼Œ boolå‹ï¼Œé»˜è®¤ä¸ºTrueï¼Œå¯¹è®­ç»ƒæ•°æ®è¿›è¡Œä¸­å¿ƒåŒ–ï¼Œfalseçš„è¯ï¼Œè¯´æ˜æ•°æ®å·²ç»è¿›è¡Œä¸­å¿ƒåŒ–ï¼›------ æ€»ç»“çš„å¾ˆå¥½å“¦ï¼<br><br>2. normalizeå¸ƒå°”å‹ï¼Œé»˜è®¤ä¸ºfalseï¼Œè¯´æ˜ï¼šæ˜¯å¦å¯¹æ•°æ®è¿›è¡Œæ ‡å‡†åŒ–å¤„ç†ï¼›---- æˆ‘å¯¹æ–‡æ¡£çš„ç†è§£åº”è¯¥æ˜¯å¯¹æ•°æ®è¿›è¡ŒæŸç§å½’ä¸€åŒ–ç¼©æ”¾ï¼Œï¼ˆIf True, the regressors X will be normalized before regression by subtracting the mean and dividing by the l2-norm. ï¼‰ï¼Œå¦‚æœéœ€è¦æ ‡å‡†åŒ–ï¼Œå®ç°æ•°æ®çš„æ­£æ€åˆ†å¸ƒï¼Œåº”è¯¥ä½¿ç”¨StandardScalerã€‚ ---- æ‰€ä»¥è¿™ä¸ªnormalizeå’Œæ ‡å‡†åŒ–ï¼ˆstandardizeï¼‰è¿˜æ˜¯æœ‰åŒºåˆ«çš„ï¼Œè¿™æ˜¯æˆ‘çš„ç†è§£ã€‚ğŸ˜","user_name":"ä½œè€…å›å¤","user_name_real":"é»„ä½³","uid":"1809833","ctime":1631551415,"ip_address":"","comment_id":311941,"utype":1}],"discussion_count":2,"race_medal":0,"score":"5926507127","product_id":100085501,"comment_content":"çº¿æ€§å›å½’å‡½æ•°ï¼šLinearRegression<br>1ã€fit_intercept=Trueï¼Œ boolå‹ï¼Œé»˜è®¤ä¸ºTrueï¼Œå¯¹è®­ç»ƒæ•°æ®è¿›è¡Œä¸­å¿ƒåŒ–ï¼Œfalseçš„è¯ï¼Œè¯´æ˜æ•°æ®å·²ç»è¿›è¡Œä¸­å¿ƒåŒ–ï¼›<br>2ã€ normalizeå¸ƒå°”å‹ï¼Œé»˜è®¤ä¸ºfalseï¼Œè¯´æ˜ï¼šæ˜¯å¦å¯¹æ•°æ®è¿›è¡Œæ ‡å‡†åŒ–å¤„ç†ï¼›<br>æ­¥éª¤ï¼šæ•°æ®æ¸…æ´—ã€æ•°æ®é›†æˆã€æ•°æ®å˜åŒ–ã€æ•°æ®åˆ†æã€‚<br>æˆ‘ç†è§£è¿™ä¸»è¦æ˜¯ä¸ºäº†æ•°æ®å˜åŒ–ï¼Œå®ç°æ•°æ®æ­£æ€åˆ†å¸ƒã€‚<br>","like_count":2,"discussions":[{"author":{"id":1809833,"avatar":"https://static001.geekbang.org/account/avatar/00/1b/9d/a9/4602808f.jpg","nickname":"é»„ä½³","note":"","ucode":"8EC41D2EAB0E3C","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":526809,"discussion_content":"1ã€fit_intercept=Trueï¼Œ boolå‹ï¼Œé»˜è®¤ä¸ºTrueï¼Œå¯¹è®­ç»ƒæ•°æ®è¿›è¡Œä¸­å¿ƒåŒ–ï¼Œfalseçš„è¯ï¼Œè¯´æ˜æ•°æ®å·²ç»è¿›è¡Œä¸­å¿ƒåŒ–ï¼›------ æ€»ç»“çš„å¾ˆå¥½å“¦ï¼\n\n2. normalizeå¸ƒå°”å‹ï¼Œé»˜è®¤ä¸ºfalseï¼Œè¯´æ˜ï¼šæ˜¯å¦å¯¹æ•°æ®è¿›è¡Œæ ‡å‡†åŒ–å¤„ç†ï¼›---- æˆ‘å¯¹æ–‡æ¡£çš„ç†è§£åº”è¯¥æ˜¯å¯¹æ•°æ®è¿›è¡ŒæŸç§å½’ä¸€åŒ–ç¼©æ”¾ï¼Œï¼ˆIf True, the regressors X will be normalized before regression by subtracting the mean and dividing by the l2-norm. ï¼‰ï¼Œå¦‚æœéœ€è¦æ ‡å‡†åŒ–ï¼Œå®ç°æ•°æ®çš„æ­£æ€åˆ†å¸ƒï¼Œåº”è¯¥ä½¿ç”¨StandardScalerã€‚ ---- æ‰€ä»¥è¿™ä¸ªnormalizeå’Œæ ‡å‡†åŒ–ï¼ˆstandardizeï¼‰è¿˜æ˜¯æœ‰åŒºåˆ«çš„ï¼Œè¿™æ˜¯æˆ‘çš„ç†è§£ã€‚ğŸ˜","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1631551415,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":2753090,"avatar":"https://static001.geekbang.org/account/avatar/00/2a/02/42/e8ef9639.jpg","nickname":"è¶èˆæ¸…é£å¯’","note":"","ucode":"2818B4BE7DCC16","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":394027,"discussion_content":"æˆ‘æ˜¯è¿™æ ·ç†è§£çš„ï¼Œå› ä¸ºæ¡ˆä¾‹æ•°æ®å…¶å®ç›¸å…³åº¦å¾ˆé«˜ï¼Œæ‰€ä»¥å½’ä¸€åŒ–çœ‹ç€æ²¡ä»€ä¹ˆå·®åˆ«ã€‚æ¯ä¸€åˆ—æ•°æ®çš„èŒƒå›´ä¸åŒï¼Œè‹¥æ˜¯ä¸å½’ä¸€åŒ–ï¼Œå¯¹äºæ•°å€¼èŒƒå›´å¾ˆå°çš„ç‰¹å¾ï¼Œå…¶è®¡ç®—çš„wï¼Œæƒé‡å°±ä¼šåå°ã€‚\nè¿™ä¸€å—ä¸»è¦æ˜¯æ ¹æ®æ‚¨æ¨èçš„é™ˆé˜³çš„æ•°æ®è¯¾ï¼Œç¬¬13éƒ¨åˆ†åˆ†æçš„ã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1631692502,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":311059,"user_name":"æå†€","can_delete":false,"product_type":"c1","uid":1212032,"ip_address":"","ucode":"F393FA203B834C","user_header":"https://static001.geekbang.org/account/avatar/00/12/7e/80/be05419a.jpg","comment_is_top":false,"comment_ctime":1631058777,"is_pvip":false,"replies":[{"id":"112728","content":"å¥½é—®é¢˜ã€‚å…¶å®å¾ˆç®€å•ï¼Œé€šè¿‡Predå‡½æ•°é¢„æµ‹å…¨ä½“çš„Y&amp;#39;å€¼ï¼Œç„¶åç»˜åˆ¶æ ‡ç­¾Xå’Œå…¨ä½“é¢„æµ‹å€¼Y&amp;#39;ï¼ˆæ³¨æ„ä¸æ˜¯çœŸå€¼ï¼Œæ˜¯é¢„æµ‹å€¼Yå¸½ï¼‰çš„æ•£ç‚¹å›¾ã€‚ä¸è¿‡ä½ åªèƒ½é€‰æ‹©ä¸€ä¸ªç‰¹å¾ç»˜å›¾ï¼Œä¸å¯èƒ½ç»˜åˆ¶è¶…è¿‡ä¸‰ç»´çš„å›¾ã€‚","user_name":"ä½œè€…å›å¤","user_name_real":"é»„ä½³","uid":"1809833","ctime":1631063677,"ip_address":"","comment_id":311059,"utype":1}],"discussion_count":1,"race_medal":0,"score":"5926026073","product_id":100085501,"comment_content":"æ€ä¹ˆå¯ä»¥å¯è§†åŒ–å¾—åˆ°çš„æ¨¡å‹å‘¢","like_count":1,"discussions":[{"author":{"id":1809833,"avatar":"https://static001.geekbang.org/account/avatar/00/1b/9d/a9/4602808f.jpg","nickname":"é»„ä½³","note":"","ucode":"8EC41D2EAB0E3C","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":526452,"discussion_content":"å¥½é—®é¢˜ã€‚å…¶å®å¾ˆç®€å•ï¼Œé€šè¿‡Predå‡½æ•°é¢„æµ‹å…¨ä½“çš„Y&amp;amp;#39;å€¼ï¼Œç„¶åç»˜åˆ¶æ ‡ç­¾Xå’Œå…¨ä½“é¢„æµ‹å€¼Y&amp;amp;#39;ï¼ˆæ³¨æ„ä¸æ˜¯çœŸå€¼ï¼Œæ˜¯é¢„æµ‹å€¼Yå¸½ï¼‰çš„æ•£ç‚¹å›¾ã€‚ä¸è¿‡ä½ åªèƒ½é€‰æ‹©ä¸€ä¸ªç‰¹å¾ç»˜å›¾ï¼Œä¸å¯èƒ½ç»˜åˆ¶è¶…è¿‡ä¸‰ç»´çš„å›¾ã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1631063677,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":344743,"user_name":"æ²™éš†å·´æ–¯","can_delete":false,"product_type":"c1","uid":2992390,"ip_address":"","ucode":"0659DB32D27A23","user_header":"https://static001.geekbang.org/account/avatar/00/2d/a9/06/2527d639.jpg","comment_is_top":false,"comment_ctime":1651744850,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1651744850","product_id":100085501,"comment_content":"è¯·é—®ï¼ŒèŒƒä¾‹çš„æ–‡ç« ç‰¹å¾æ•°æ®ç‚¹èµé‡ã€è½¬å‘é‡æ˜¯åœ¨æ–‡ç« å‘å¸ƒä»¥åä¸€æ®µæ—¶é—´å†…æ”¶é›†å¾—åˆ°ï¼Œå¦‚æœä¸€ç¯‡æ–°æ–‡ç« å‘å¸ƒï¼Œæ­¤æ—¶æ˜¯æ²¡æœ‰ç‚¹èµæ•°å’Œè½¬å‘æ•°ç­‰æ•°æ®çš„ï¼Œè¿™æ—¶è¯¥å¦‚ä½•ç¡®å®šç‰¹å¾å€¼ï¼Ÿæ˜¯å¦éœ€è¦å¯¹æ–‡ç« å†…å®¹è¿›è¡Œè¯†åˆ«ï¼Œæå–å‡ºç‰¹å¾å€¼æ‰èƒ½è®¡ç®—å‡ºç»“æœå‘¢ï¼Ÿ","like_count":0},{"had_liked":false,"id":342320,"user_name":"ZzzL","can_delete":false,"product_type":"c1","uid":2529532,"ip_address":"","ucode":"01B09ACD8BEF4E","user_header":"https://static001.geekbang.org/account/avatar/00/26/98/fc/df6a9ed7.jpg","comment_is_top":false,"comment_ctime":1650188337,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1650188337","product_id":100085501,"comment_content":"è€å¸ˆä»£ç æœ‰ç‚¹å°é”™è¯¯ã€‚<br>åœ¨è¾“å‡ºâ€œå½“å‰æ¨¡å‹çš„4ä¸ªç‰¹å¾çš„æƒé‡â€é‚£é‡Œåº”è¯¥ä¿®æ”¹ä¸ºï¼ˆæ˜¯linereg_modelä¸æ˜¯modelï¼‰ï¼š<br>print(&#39;å½“å‰æ¨¡å‹çš„4ä¸ªç‰¹å¾çš„æƒé‡åˆ†åˆ«æ˜¯: &#39;, linereg_model.coef_)<br>print(&#39;å½“å‰æ¨¡å‹çš„æˆªè·ï¼ˆåç½®ï¼‰æ˜¯: &#39;, linereg_model.intercept_)","like_count":1},{"had_liked":false,"id":323793,"user_name":"å¤æ—¥ğŸ‰æƒ…ç¼˜","can_delete":false,"product_type":"c1","uid":2755497,"ip_address":"","ucode":"0BD258E390E537","user_header":"https://static001.geekbang.org/account/avatar/00/2a/0b/a9/ccacdd57.jpg","comment_is_top":false,"comment_ctime":1638164575,"is_pvip":false,"replies":[{"id":"118523","content":"å…·ä½“çš„è¯è¯·å‚è€ƒGithubä¸Šçš„å®Œæ•´ä»£ç å“ˆï¼Œåæ­£å‰é¢å®šä¹‰çš„modelå˜é‡åæ˜¯å•¥ï¼Œè¿™é‡Œè¾“å‡ºçš„æ—¶å€™å°±ç”¨å•¥å°±å¯¹äº†ã€‚","user_name":"ä½œè€…å›å¤","user_name_real":"ç¼–è¾‘","uid":"1809833","ctime":1639498993,"ip_address":"","comment_id":323793,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1638164575","product_id":100085501,"comment_content":"è€å¸ˆï¼Œå½“è¿è¡Œå¦‚ä¸‹è¿™æ®µä»£ç çš„çš„æ—¶å€™ï¼š<br>print(&#39;å½“å‰æ¨¡å‹çš„4ä¸ªç‰¹å¾çš„æƒé‡åˆ†åˆ«æ˜¯: &#39;, model.coef_)<br>print(&#39;å½“å‰æ¨¡å‹çš„æˆªè·ï¼ˆåç½®ï¼‰æ˜¯: &#39;, model.intercept_)<br><br>æˆ‘è¿™è¾¹å¹¶æ²¡æœ‰è¾“å‡ºç»“æœï¼Œè€Œæ˜¯æŠ¥é”™äº†ï¼Œè¯´modelæ²¡æœ‰å®šä¹‰ï¼Œä½†æ˜¯æˆ‘ä¹Ÿæ²¡çœ‹è§ä½ ä»£ç ä¸­æœ‰ä»»ä½•å®šä¹‰çš„åœ°æ–¹<br><br>NameError: name &#39;model&#39; is not defined<br><br>è¯·é—®ä¸‹è€å¸ˆæ˜¯æ€ä¹ˆå›äº‹","like_count":0,"discussions":[{"author":{"id":1809833,"avatar":"https://static001.geekbang.org/account/avatar/00/1b/9d/a9/4602808f.jpg","nickname":"é»„ä½³","note":"","ucode":"8EC41D2EAB0E3C","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":538771,"discussion_content":"å…·ä½“çš„è¯è¯·å‚è€ƒGithubä¸Šçš„å®Œæ•´ä»£ç å“ˆï¼Œåæ­£å‰é¢å®šä¹‰çš„modelå˜é‡åæ˜¯å•¥ï¼Œè¿™é‡Œè¾“å‡ºçš„æ—¶å€™å°±ç”¨å•¥å°±å¯¹äº†ã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1639498993,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":311921,"user_name":"Jove","can_delete":false,"product_type":"c1","uid":1234583,"ip_address":"","ucode":"82CEFDC5F66073","user_header":"https://static001.geekbang.org/account/avatar/00/12/d6/97/035a237b.jpg","comment_is_top":false,"comment_ctime":1631531039,"is_pvip":true,"replies":[{"id":"113039","content":"ğŸ¤Ÿ","user_name":"ä½œè€…å›å¤","user_name_real":"é»„ä½³","uid":"1809833","ctime":1631550945,"ip_address":"","comment_id":311921,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1631531039","product_id":100085501,"comment_content":"é¢„æµ‹å€¼å’Œå®é™…å€¼çš„ç»˜å›¾è¡¨ç¤º<br><br>plt.scatter(df_ads_pred.ç‚¹èµæ•°, df_ads_pred.æµè§ˆé‡çœŸå€¼, c=&#39;r&#39;, marker=&#39;o&#39;, label=&quot;true&quot;)<br>plt.scatter(df_ads_pred.ç‚¹èµæ•°, df_ads_pred.æµè§ˆé‡é¢„æµ‹å€¼, c=&#39;b&#39;, marker=&quot;x&quot;, label=&quot;pre&quot;)<br>plt.grid(True)  #ç½‘æ ¼<br>plt.xlabel(&quot;ç‚¹èµæ•°&quot;)<br>plt.ylabel(&quot;æµè§ˆé‡&quot;)<br>plt.legend(loc=&#39;upper right&#39;)  #å›¾ä¾‹çš„ä½ç½®<br>plt.title(&quot;scatter view&quot;)","like_count":0,"discussions":[{"author":{"id":1809833,"avatar":"https://static001.geekbang.org/account/avatar/00/1b/9d/a9/4602808f.jpg","nickname":"é»„ä½³","note":"","ucode":"8EC41D2EAB0E3C","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":526799,"discussion_content":"ğŸ¤Ÿ","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1631550945,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":310976,"user_name":"u","can_delete":false,"product_type":"c1","uid":1178201,"ip_address":"","ucode":"6FDCEA63AE67C3","user_header":"https://static001.geekbang.org/account/avatar/00/11/fa/59/52a504f6.jpg","comment_is_top":false,"comment_ctime":1631007123,"is_pvip":false,"replies":[{"id":"112686","content":"è°¢è°¢ä½ çš„è°ƒç ”ã€‚éå¸¸å¥½ã€‚<br>1. çš„ç¡®ï¼Œfit_intercept=Falseæ—¶ï¼Œä¼šå¿½ç•¥normalizeå‚æ•°ã€‚æ˜¯è¿™æ ·çš„ã€‚<br>2. fit_interceptå¾ˆç®€å•å•¦ï¼Œå°±æ˜¯æˆªè·ã€‚<br>è€Œnormalizeå‚æ•°æ˜¯ä»€ä¹ˆæ„æ€å‘¢ï¼Ÿå®ƒç¿»è¯‘ä¸ºè§„èŒƒåŒ–ï¼Œå±äºç‰¹å¾ç¼©æ”¾çš„ä¸€ç§ï¼Œä½†æ˜¯å¹¶ä¸å¸¸è§ã€‚æ–‡æ¡£ä¸­çš„è§£é‡Šæ˜¯å®ƒå°†å˜é‡ X å°†åœ¨å›å½’ä¹‹å‰é€šè¿‡å‡å»å‡å€¼å¹¶é™¤ä»¥ l2 èŒƒæ•°è¿›è¡Œç¼©æ”¾ã€‚è€Œè¿™ç§ç¼©æ”¾ï¼Œå¯èƒ½å¯¹äºç‰¹æ®Šç±»å‹çš„æ•°æ®é›†æœ‰ç”¨ï¼ˆæ–‡æœ¬åˆ†ç±»çš„ç‰¹å¾é›†ï¼‰ï¼Œå¯¹æˆ‘ä»¬è¿™ä¸ªæ•°æ®é›†ï¼Œæ„ä¹‰ä¸å¤§ã€‚","user_name":"ä½œè€…å›å¤","user_name_real":"é»„ä½³","uid":"1809833","ctime":1631021169,"ip_address":"","comment_id":310976,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1631007123","product_id":100085501,"comment_content":"è¾“å‡ºç»“æœï¼š<br>MLTest.py::test_train_model[True-True] PASSED                            [ 25%]<br>===============fit_intercept= True ,normalize= True ====================<br>æ¨¡å‹çš„æƒé‡åˆ†åˆ«æ˜¯ï¼š [   48.08395224    34.73062229 29730.13312489  2949.62196343]<br>æ¨¡å‹çš„æˆªè·æ˜¯ï¼š -127493.90606857173<br>çº¿æ€§å›å½’é¢„æµ‹åˆ†æ•°æ˜¯ï¼š 0.740552064611524<br>========================================<br><br>MLTest.py::test_train_model[True-False] PASSED                           [ 50%]<br>===============fit_intercept= False ,normalize= True ====================<br>æ¨¡å‹çš„æƒé‡åˆ†åˆ«æ˜¯ï¼š [   49.22775653    24.7593051  22106.78160819 -9416.98488967]<br>æ¨¡å‹çš„æˆªè·æ˜¯ï¼š 0.0<br>çº¿æ€§å›å½’é¢„æµ‹åˆ†æ•°æ˜¯ï¼š 0.6894272355358542<br>========================================<br><br>MLTest.py::test_train_model[False-True] PASSED                           [ 75%]<br>===============fit_intercept= True ,normalize= False ====================<br>æ¨¡å‹çš„æƒé‡åˆ†åˆ«æ˜¯ï¼š [   48.08395224    34.73062229 29730.13312489  2949.62196343]<br>æ¨¡å‹çš„æˆªè·æ˜¯ï¼š -127493.90606857178<br>çº¿æ€§å›å½’é¢„æµ‹åˆ†æ•°æ˜¯ï¼š 0.740552064611524<br>========================================<br><br>MLTest.py::test_train_model[False-False] PASSED                          [100%]<br>===============fit_intercept= False ,normalize= False ====================<br>æ¨¡å‹çš„æƒé‡åˆ†åˆ«æ˜¯ï¼š [   49.22775653    24.7593051  22106.78160819 -9416.98488967]<br>æ¨¡å‹çš„æˆªè·æ˜¯ï¼š 0.0<br>çº¿æ€§å›å½’é¢„æµ‹åˆ†æ•°æ˜¯ï¼š 0.6894272355358542<br>========================================<br><br><br>è¯´æ˜ï¼š<br>çœ‹äº†LinearRegressionçš„æ–‡æ¡£ï¼Œfit_intercept=Falseæ—¶ï¼Œä¼šå¿½ç•¥normalizeå‚æ•°ï¼Œæ‰€ä»¥ç»“æœåªæœ‰ä¸‰ç§ï¼›<br>è€Œä¸”fit_intercept=Trueæ—¶ï¼Œnormalizeçš„å€¼é™¤äº†å¯¹æˆªè·æœ‰è½»å¾®å½±å“ï¼Œå¥½åƒå¯¹å…¶å®ƒå†…éƒ¨å‚æ•°å¹¶æ²¡æœ‰å½±å“ï¼›<br><br><br>é—®é¢˜ï¼š<br>è¿™ä¸¤ä¸ªå‚æ•°æ˜¯ä»€ä¹ˆæ„æ€å‘¢ï¼Ÿè€å¸ˆç»™è®²ä¸€ä¸‹å§","like_count":0,"discussions":[{"author":{"id":1809833,"avatar":"https://static001.geekbang.org/account/avatar/00/1b/9d/a9/4602808f.jpg","nickname":"é»„ä½³","note":"","ucode":"8EC41D2EAB0E3C","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":526418,"discussion_content":"è°¢è°¢ä½ çš„è°ƒç ”ã€‚éå¸¸å¥½ã€‚\n1. çš„ç¡®ï¼Œfit_intercept=Falseæ—¶ï¼Œä¼šå¿½ç•¥normalizeå‚æ•°ã€‚æ˜¯è¿™æ ·çš„ã€‚\n2. fit_interceptå¾ˆç®€å•å•¦ï¼Œå°±æ˜¯æˆªè·ã€‚\nè€Œnormalizeå‚æ•°æ˜¯ä»€ä¹ˆæ„æ€å‘¢ï¼Ÿå®ƒç¿»è¯‘ä¸ºè§„èŒƒåŒ–ï¼Œå±äºç‰¹å¾ç¼©æ”¾çš„ä¸€ç§ï¼Œä½†æ˜¯å¹¶ä¸å¸¸è§ã€‚æ–‡æ¡£ä¸­çš„è§£é‡Šæ˜¯å®ƒå°†å˜é‡ X å°†åœ¨å›å½’ä¹‹å‰é€šè¿‡å‡å»å‡å€¼å¹¶é™¤ä»¥ l2 èŒƒæ•°è¿›è¡Œç¼©æ”¾ã€‚è€Œè¿™ç§ç¼©æ”¾ï¼Œå¯èƒ½å¯¹äºç‰¹æ®Šç±»å‹çš„æ•°æ®é›†æœ‰ç”¨ï¼ˆæ–‡æœ¬åˆ†ç±»çš„ç‰¹å¾é›†ï¼‰ï¼Œå¯¹æˆ‘ä»¬è¿™ä¸ªæ•°æ®é›†ï¼Œæ„ä¹‰ä¸å¤§ã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1631021169,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]}]}