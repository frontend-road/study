{"id":1513,"title":"24 | 分布式系统关键技术：全栈监控","content":"<p>你好，我是陈皓，网名左耳朵耗子。</p>\n<p>首先，我们需要全栈系统监控，它就像是我们的眼睛，没有它，我们就不知道系统到底发生了什么，我们将无法管理或是运维整个分布式系统。所以，这个系统是非常非常关键的。</p>\n<p>而在分布式或Cloud Native的情况下，系统分成多层，服务各种关联，需要监控的东西特别多。没有一个好的监控系统，我们将无法进行自动化运维和资源调度。</p>\n<p>这个监控系统需要完成的功能为：</p>\n<ul>\n<li>全栈监控；</li>\n<li>关联分析；</li>\n<li>跨系统调用的串联；</li>\n<li>实时报警和自动处置；</li>\n<li>系统性能分析。</li>\n</ul>\n<h1>多层体系的监控</h1>\n<p>所谓全栈监控，其实就是三层监控。</p>\n<ul>\n<li>\n<p><strong>基础层</strong>：监控主机和底层资源。比如：CPU、内存、网络吞吐、硬盘I/O、硬盘使用等。</p>\n</li>\n<li>\n<p><strong>中间层</strong>：就是中间件层的监控。比如：Nginx、Redis、ActiveMQ、Kafka、MySQL、Tomcat等。</p>\n</li>\n<li>\n<p><strong>应用层</strong>：监控应用层的使用。比如：HTTP访问的吞吐量、响应时间、返回码、调用链路分析、性能瓶颈，还包括用户端的监控。</p>\n</li>\n</ul>\n<p><img src=\"https://static001.geekbang.org/resource/image/fe/4f/fe3aaf79df1565505cdac32494078a4f.jpg?wh=2145x1152\" alt=\"\" /><br />\n这还需要一些监控的标准化。</p>\n<ul>\n<li>日志数据结构化；</li>\n<li>监控数据格式标准化；</li>\n<li>统一的监控平台；</li>\n<li>统一的日志分析。</li>\n</ul>\n<h1>什么才是好的监控系统</h1>\n<p>这里还要多说一句，现在我们的很多监控系统都做得很不好，它们主要有两个很大的问题。</p>\n<!-- [[[read_end]]] -->\n<ol>\n<li>\n<p><strong>监控数据是隔离开来的</strong>。因为公司分工的问题，开发、应用运维、系统运维，各管各的，所以很多公司的监控系统之间都有一道墙，完全串不起来。</p>\n</li>\n<li>\n<p><strong>监控的数据项太多</strong>。有些公司的运维团队把监控的数据项多作为一个亮点到处讲，比如监控指标达到5万多个。老实说，这太丢人了。因为信息太多等于没有信息，抓不住重点的监控才会做成这个样子，完全就是使蛮力的做法。</p>\n</li>\n</ol>\n<p>一个好的监控系统应该有以下几个特征。</p>\n<ul>\n<li>\n<p><strong>关注于整体应用的SLA</strong>。主要从为用户服务的API来监控整个系统。</p>\n</li>\n<li>\n<p><strong>关联指标聚合</strong>。把有关联的系统及其指标聚合展示。主要是三层系统数据：基础层、平台中间件层和应用层。其中，最重要的是把服务和相关的中间件以及主机关联在一起，服务有可能运行在Docker中，也有可能运行在微服务平台上的多个JVM中，也有可能运行在Tomcat中。总之，无论运行在哪里，我们都需要把服务的具体实例和主机关联在一起，否则，对于一个分布式系统来说，定位问题犹如大海捞针。</p>\n</li>\n<li>\n<p><strong>快速故障定位</strong>。对于现有的系统来说，故障总是会发生的，而且还会频繁发生。故障发生不可怕，可怕的是故障的恢复时间过长。所以，快速地定位故障就相当关键。快速定位问题需要对整个分布式系统做一个用户请求跟踪的trace监控，我们需要监控到所有的请求在分布式系统中的调用链，这个事最好是做成没有侵入性的。</p>\n</li>\n</ul>\n<p>换句话说，一个好的监控系统主要是为以下两个场景所设计的。</p>\n<h2>“体检”</h2>\n<ul>\n<li>\n<p><strong>容量管理</strong>。提供一个全局的系统运行时数据的展示，可以让工程师团队知道是否需要增加机器或者其它资源。</p>\n</li>\n<li>\n<p><strong>性能管理</strong>。可以通过查看大盘，找到系统瓶颈，并有针对性地优化系统和相应代码。</p>\n</li>\n</ul>\n<h2>“急诊”</h2>\n<ul>\n<li>\n<p><strong>定位问题</strong>。可以快速地暴露并找到问题的发生点，帮助技术人员诊断问题。</p>\n</li>\n<li>\n<p><strong>性能分析</strong>。当出现非预期的流量提升时，可以快速地找到系统的瓶颈，并帮助开发人员深入代码。</p>\n</li>\n</ul>\n<p>只有做到了上述的这些关键点才能是一个好的监控系统。</p>\n<h1>如何做出一个好的监控系统</h1>\n<p>下面是我认为一个好的监控系统应该实现的功能。</p>\n<ul>\n<li><strong>服务调用链跟踪</strong>。这个监控系统应该从对外的API开始，然后将后台的实际服务给关联起来，然后再进一步将这个服务的依赖服务关联起来，直到最后一个服务（如MySQL或Redis），这样就可以把整个系统的服务全部都串连起来了。这个事情的最佳实践是Google Dapper系统，其对应于开源的实现是Zipkin。对于Java类的服务，我们可以使用字节码技术进行字节码注入，做到代码无侵入式。</li>\n</ul>\n<p>如下图所示（截图来自我做的一个APM的监控系统）。</p>\n<p><img src=\"https://static001.geekbang.org/resource/image/5e/91/5eb0a776e9470192ce816e6c840f8591.jpg?wh=2073x1203\" alt=\"\" /></p>\n<ul>\n<li><strong>服务调用时长分布</strong>。使用Zipkin，可以看到一个服务调用链上的时间分布，这样有助于我们知道最耗时的服务是什么。下图是Zipkin的服务调用时间分布。</li>\n</ul>\n<p><img src=\"https://static001.geekbang.org/resource/image/fb/2d/fb5545ca0777f86e007a2aa022fdf32d.jpg?wh=2361x1743\" alt=\"\" /></p>\n<ul>\n<li><strong>服务的TOP N视图</strong>。所谓TOP N视图就是一个系统请求的排名情况。一般来说，这个排名会有三种排名的方法：a）按调用量排名，b) 按请求最耗时排名，c）按热点排名（一个时间段内的请求次数的响应时间和）。</li>\n</ul>\n<p><img src=\"https://static001.geekbang.org/resource/image/f4/f1/f4f91d5a3ee95b478c47f62499b0dcf1.png?wh=391*423\" alt=\"\" /></p>\n<ul>\n<li><strong>数据库操作关联</strong>。对于Java应用，我们可以很方便地通过JavaAgent字节码注入技术拿到JDBC执行数据库操作的执行时间。对此，我们可以和相关的请求对应起来。</li>\n</ul>\n<p><img src=\"https://static001.geekbang.org/resource/image/29/f4/29587fed0823f6e8ae7a2d38eaf35af4.png?wh=391*459\" alt=\"\" /></p>\n<ul>\n<li><strong>服务资源跟踪</strong>。我们的服务可能运行在物理机上，也可能运行在虚拟机里，还可能运行在一个Docker的容器里，Docker容器又运行在物理机或是虚拟机上。我们需要把服务运行的机器节点上的数据（如CPU、MEM、I/O、DISK、NETWORK）关联起来。</li>\n</ul>\n<p>这样一来，我们就可以知道服务和基础层资源的关系。如果是Java应用，我们还要和JVM里的东西进行关联，这样我们才能知道服务所运行的JVM中的情况（比如GC的情况）。</p>\n<p>有了这些数据上的关联，我们就可以达到如下的目标。</p>\n<ol>\n<li>\n<p>当一台机器挂掉是因为CPU或I/O过高的时候，我们马上可以知道其会影响到哪些对外服务的API。</p>\n</li>\n<li>\n<p>当一个服务响应过慢的时候，我们马上能关联出来是否在做Java GC，或是其所在的计算结点上是否有资源不足的情况，或是依赖的服务是否出现了问题。</p>\n</li>\n<li>\n<p>当发现一个SQL操作过慢的时候，我们能马上知道其会影响哪个对外服务的API。</p>\n</li>\n<li>\n<p>当发现一个消息队列拥塞的时候，我们能马上知道其会影响哪些对外服务的API。</p>\n</li>\n</ol>\n<p>总之，我们就是想知道用户访问哪些请求会出现问题，这对于我们了解故障的影响面非常有帮助。</p>\n<p>一旦了解了这些信息，我们就可以做出调度。比如：</p>\n<ul>\n<li>\n<p>一旦发现某个服务过慢是因为CPU使用过多，我们就可以做弹性伸缩。</p>\n</li>\n<li>\n<p>一旦发现某个服务过慢是因为MySQL出现了一个慢查询，我们就无法在应用层上做弹性伸缩，只能做流量限制，或是降级操作了。</p>\n</li>\n</ul>\n<p>所以，一个分布式系统，或是一个自动化运维系统，或是一个Cloud Native的云化系统，最重要的事就是把监控系统做好。在把数据收集好的同时，更重要的是把数据关联好。这样，我们才可能很快地定位故障，进而才能进行自动化调度。</p>\n<p><img src=\"https://static001.geekbang.org/resource/image/6b/33/6b17dd779cfecd62e02924dc8618e833.png?wh=865*381\" alt=\"\" /></p>\n<p>上图只是简单地展示了一个分布式系统的服务调用链接上都在报错，其根本原因是数据库链接过多，服务不过来。另外一个原因是，Java在做Full GC导致处理过慢。于是，消息队列出现消息堆积堵塞。这个图只是一个示例，其形象地体现了在分布式系统中监控数据关联的重要性。</p>\n<h1>小结</h1>\n<p>回顾一下今天的要点内容。首先，我强调了全栈系统监控的重要性，它就像是我们的眼睛，没有它，我们根本就不知道系统到底发生了什么。随后，从基础层、中间层和应用层三个层面，讲述了全栈监控系统要监控哪些内容。然后，阐释了什么才是好的监控系统，以及如何做出好的监控。最后，欢迎你分享一下你在监控系统中的比较好的实践和方法。</p>\n<p>在下一讲中，我将讲述分布式系统的另一关键技术：服务调度。</p>\n<p>下面我列出了《分布式系统架构的本质》系列文章的目录，方便你快速找到自己感兴趣的内容。</p>\n<ul>\n<li><a href=\"https://time.geekbang.org/column/article/1411\">分布式系统架构的冰与火</a></li>\n<li><a href=\"https://time.geekbang.org/column/article/1505\">从亚马逊的实践，谈分布式系统的难点</a></li>\n<li><a href=\"https://time.geekbang.org/column/article/1512\">分布式系统的技术栈</a></li>\n<li><a href=\"https://time.geekbang.org/column/article/1513\">分布式系统关键技术：全栈监控</a></li>\n<li><a href=\"https://time.geekbang.org/column/article/1604\">分布式系统关键技术：服务调度</a></li>\n<li><a href=\"https://time.geekbang.org/column/article/1609\">分布式系统关键技术：流量与数据调度</a></li>\n<li><a href=\"https://time.geekbang.org/column/article/1610\">洞悉PaaS平台的本质</a></li>\n<li><a href=\"https://time.geekbang.org/column/article/2080\">推荐阅读：分布式系统架构经典资料</a></li>\n<li><a href=\"https://time.geekbang.org/column/article/2421\">推荐阅读：分布式数据调度相关论文</a></li>\n</ul>\n","neighbors":{"left":{"article_title":"23 | 分布式系统的技术栈","id":1512},"right":{"article_title":"25 | 分布式系统关键技术：服务调度","id":1604}},"comments":[{"had_liked":false,"id":6882,"user_name":"怪盗キッド","can_delete":false,"product_type":"c1","uid":1048065,"ip_address":"","ucode":"D96BC268F5FB6C","user_header":"https://static001.geekbang.org/account/avatar/00/0f/fe/01/3f3ae95e.jpg","comment_is_top":false,"comment_ctime":1525100322,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"293582876450","product_id":100002201,"comment_content":"我使用asm写了一个java接口性能监控和统计的工具MyPerf4J：https:&#47;&#47;github.com&#47;ThinkpadNC5&#47;MyPerf4J","like_count":67},{"had_liked":false,"id":88089,"user_name":"it-spurs","can_delete":false,"product_type":"c1","uid":1136292,"ip_address":"","ucode":"8AC8845577CC65","user_header":"https://static001.geekbang.org/account/avatar/00/11/56/a4/f1459f9b.jpg","comment_is_top":false,"comment_ctime":1555844085,"is_pvip":true,"discussion_count":0,"race_medal":0,"score":"130404862965","product_id":100002201,"comment_content":"对比过各个开源分布式调用链系统，其中skywalking各方面都更优秀，代码无侵入，性能好，界面强大，监控指标多，有监控告警，提供非常多的插件，可以监控市面上大部分主要的开源框架和中间件，比如rabbitmq，dubbo,springcloud,mysql，是一款国内的优秀开源软件，已经在Apache孵化器，生态也在扩展。","like_count":31},{"had_liked":false,"id":5258,"user_name":"shniu","can_delete":false,"product_type":"c1","uid":1019555,"ip_address":"","ucode":"E64CD8BED96D8D","user_header":"https://static001.geekbang.org/account/avatar/00/0f/8e/a3/d7e5fe8a.jpg","comment_is_top":false,"comment_ctime":1522975177,"is_pvip":false,"replies":[{"id":"1429","content":"ELK","user_name":"作者回复","user_name_real":"左耳朵","uid":"1001269","ctime":1523159543,"ip_address":"","comment_id":5258,"utype":1}],"discussion_count":1,"race_medal":0,"score":"100307222985","product_id":100002201,"comment_content":"请问浩哥，有哪些好用的开源监控平台吗","like_count":24,"discussions":[{"author":{"id":1001269,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/47/35/89726f5f.jpg","nickname":"左耳朵","note":"","ucode":"8A4741D677702E","race_medal":0,"user_type":2,"is_pvip":true},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":416656,"discussion_content":"ELK","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1523159543,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":1943,"user_name":"曹林华","can_delete":false,"product_type":"c1","uid":1001381,"ip_address":"","ucode":"6F33D21DF07423","user_header":"https://static001.geekbang.org/account/avatar/00/0f/47/a5/f0bdd6dc.jpg","comment_is_top":false,"comment_ctime":1515198927,"is_pvip":true,"discussion_count":0,"race_medal":0,"score":"78824610255","product_id":100002201,"comment_content":"Zipkin 更适合做全链路跟踪，主要有下面两个好处<br>1. 接入sdk来实现，比较灵活，管理起来方便<br>2. Pingpoint 通过依赖编织，接入一个 jar 包在jvm 启动命令中，接入简单，但是管理麻烦，不透明","like_count":19},{"had_liked":false,"id":1636,"user_name":"whhbbq","can_delete":false,"product_type":"c1","uid":1018494,"ip_address":"","ucode":"4A93F3E375CB44","user_header":"","comment_is_top":false,"comment_ctime":1513864669,"is_pvip":false,"replies":[{"id":"263","content":"Zipkin","user_name":"作者回复","user_name_real":"左耳朵","uid":"1001269","ctime":1514099779,"ip_address":"","comment_id":1636,"utype":1}],"discussion_count":1,"race_medal":0,"score":"70233341405","product_id":100002201,"comment_content":"陈老师，请问zipkin和pinpoint哪个更好用点","like_count":16,"discussions":[{"author":{"id":1001269,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/47/35/89726f5f.jpg","nickname":"左耳朵","note":"","ucode":"8A4741D677702E","race_medal":0,"user_type":2,"is_pvip":true},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":415484,"discussion_content":"Zipkin","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1514099779,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":2196,"user_name":"mgxian","can_delete":false,"product_type":"c1","uid":1014806,"ip_address":"","ucode":"7B7E77E6A83B87","user_header":"https://static001.geekbang.org/account/avatar/00/0f/7c/16/4d1e5cc1.jpg","comment_is_top":false,"comment_ctime":1516276354,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"57350851202","product_id":100002201,"comment_content":"请问老师的架构图 示意图 是用什么软件画的 ","like_count":13},{"had_liked":false,"id":5315,"user_name":"毛洪博","can_delete":false,"product_type":"c1","uid":1083768,"ip_address":"","ucode":"D5DDE602FDA816","user_header":"https://static001.geekbang.org/account/avatar/00/10/89/78/16c56f99.jpg","comment_is_top":false,"comment_ctime":1523104853,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"31587875925","product_id":100002201,"comment_content":"对于业务，中间件，基础监控，三者相互关联，非常认同，想问下，这块如何实现？一个监控系统，如何正确的显示三个层次的信息？","like_count":8},{"had_liked":false,"id":210637,"user_name":"F .","can_delete":false,"product_type":"c1","uid":1161403,"ip_address":"","ucode":"EA13A271B22337","user_header":"https://static001.geekbang.org/account/avatar/00/11/b8/bb/448ebfa3.jpg","comment_is_top":false,"comment_ctime":1587800752,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"23062637232","product_id":100002201,"comment_content":"一个好的监控系统要具备：调用链路跟踪、调用链路时长分布、top视图、服务资源跟踪、数据库操作关联","like_count":5},{"had_liked":false,"id":85714,"user_name":"Lincoln","can_delete":false,"product_type":"c1","uid":1365798,"ip_address":"","ucode":"9AA8A2F6263AE1","user_header":"https://static001.geekbang.org/account/avatar/00/14/d7/26/502f2f0a.jpg","comment_is_top":false,"comment_ctime":1555210396,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"23030046876","product_id":100002201,"comment_content":"皓哥，我们公司也有做数据监控，包括业务层，中间层和底层，但是三者之间没有什么关联，平时定位问题只能通过时间点来分析三者的关系，但是感觉很麻烦。今天看了这篇文章，刚好提到了关联的重要性，但我还是不知道用什么好的技术手段去进行监控的关联？","like_count":6},{"had_liked":false,"id":12742,"user_name":"冰糕不冰","can_delete":false,"product_type":"c1","uid":1134761,"ip_address":"","ucode":"B754FE464BA426","user_header":"https://static001.geekbang.org/account/avatar/00/11/50/a9/3f8c7418.jpg","comment_is_top":false,"comment_ctime":1528992447,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"18708861631","product_id":100002201,"comment_content":"安卓什么时候才有倍速播放啊？这个功能真的太需要了！","like_count":4},{"had_liked":false,"id":2309,"user_name":"enrique","can_delete":false,"product_type":"c1","uid":1010325,"ip_address":"","ucode":"F40255F8AA47C0","user_header":"https://static001.geekbang.org/account/avatar/00/0f/6a/95/223d27b9.jpg","comment_is_top":false,"comment_ctime":1516723887,"is_pvip":false,"discussion_count":3,"race_medal":0,"score":"18696593071","product_id":100002201,"comment_content":"本文中提到的开源全栈监控系统zipkin适合以go语言为主的开发团队吗？如果不适合，go语言该如何做到同样的效果？","like_count":4,"discussions":[{"author":{"id":1350286,"avatar":"https://static001.geekbang.org/account/avatar/00/14/9a/8e/69856382.jpg","nickname":"蓝舵手","note":"","ucode":"4F6DA4D8CB13E7","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":564744,"discussion_content":"opentracing","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1650326969,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1019181,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/8d/2d/70b7c817.jpg","nickname":"heng4fun","note":"","ucode":"AB0F75AB1F6A70","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":318698,"discussion_content":"Jaeger","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1603809022,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1031710,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/be/1e/94886200.jpg","nickname":"小鱼儿吐泡泡","note":"","ucode":"2B4AA532B2B066","race_medal":0,"user_type":1,"is_pvip":true},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":302673,"discussion_content":"有找到解决方案吗？ 目前我也在找","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1599007209,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":1591,"user_name":"永靖","can_delete":false,"product_type":"c1","uid":1030310,"ip_address":"","ucode":"6CE95F363AC211","user_header":"https://wx.qlogo.cn/mmopen/vi_32/2nM9PaEsM4UiaUc0R3iaiaOumFVkcugGhdUObpEBq0bEKnjF6DSTmjsibFbmJHtUphfXsFGd1ueJwMoonia3jicyPC1w/132","comment_is_top":false,"comment_ctime":1513728694,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"18693597878","product_id":100002201,"comment_content":"关于监控组件，有没有开源的可以参考","like_count":4},{"had_liked":false,"id":174327,"user_name":"j0hnniang","can_delete":false,"product_type":"c1","uid":1254001,"ip_address":"","ucode":"1ED26A5787A5FC","user_header":"https://static001.geekbang.org/account/avatar/00/13/22/71/9d6eab72.jpg","comment_is_top":false,"comment_ctime":1580143807,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"14465045695","product_id":100002201,"comment_content":"推荐最近接触过的一个开源项目：Skywalking","like_count":3},{"had_liked":false,"id":163260,"user_name":"陈硕","can_delete":false,"product_type":"c1","uid":1102463,"ip_address":"","ucode":"C7662C0E79020A","user_header":"https://static001.geekbang.org/account/avatar/00/10/d2/7f/6cb73b36.jpg","comment_is_top":false,"comment_ctime":1576677000,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"10166611592","product_id":100002201,"comment_content":"对于非java系列的技术栈，全链路监控都有什么选型呢。比如go + grpc，或者service mesh","like_count":2},{"had_liked":false,"id":11317,"user_name":"对酒当歌","can_delete":false,"product_type":"c1","uid":1112862,"ip_address":"","ucode":"9F3F94247F71F6","user_header":"https://static001.geekbang.org/account/avatar/00/10/fb/1e/38029df6.jpg","comment_is_top":false,"comment_ctime":1528071322,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"10118005914","product_id":100002201,"comment_content":"陈老师，zinkin在线上实时监控消耗性能吗，我是用在线上好还只是性能压力测试。","like_count":2},{"had_liked":false,"id":6098,"user_name":"约书亚","can_delete":false,"product_type":"c1","uid":1046714,"ip_address":"","ucode":"81EA27ADD9EC1A","user_header":"https://static001.geekbang.org/account/avatar/00/0f/f8/ba/14e05601.jpg","comment_is_top":false,"comment_ctime":1524371181,"is_pvip":false,"discussion_count":1,"race_medal":0,"score":"10114305773","product_id":100002201,"comment_content":"皓哥，我们团队基于微服务的架构，做了大量的监控，比如elk针对错误日志的告警，promethues针对系统容器和应用的监控，数据库使用阿里云本身的监控，全部整合到一套仪表盘中<br>但即使如此，我还作为负责人还是感到很“虚”，体现在几处：1.没法预防，这个感觉很难 2.很难把握监控的粒度，粗了，定位问题太模糊，细了，工作量大，又怕影响性能（就当我耍流氓吧）。皓哥说的字节码技术应该就是动态AOP吧，基于现在spring系，做aop简单但是很容易出错","like_count":2,"discussions":[{"author":{"id":2298937,"avatar":"https://thirdwx.qlogo.cn/mmopen/vi_32/DYAIOgq83eoCl6Nxf9oW9tBOaJlH7JqNIiabF8eqMqK1uRhwabXBU3j6kyjVpI2fjm5nZKoZTUA7Cpicb7ajSkrA/132","nickname":"loma","note":"","ucode":"C5CFC3F0D06000","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":349910,"discussion_content":"不是动态AOP  是基于字节码的 AOP","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1613628036,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":3557,"user_name":"张祥","can_delete":false,"product_type":"c1","uid":1057330,"ip_address":"","ucode":"BE613A7C7E1F9C","user_header":"https://static001.geekbang.org/account/avatar/00/10/22/32/f443b851.jpg","comment_is_top":false,"comment_ctime":1519892493,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"10109827085","product_id":100002201,"comment_content":"学习了一些zipkin的东西，几点疑问？就拿java服务举例，服务增加这种侵入式监控，并发延迟受影响的程度如何衡量？collector如何承受高并发去扩容？集群模式确定单个实例故障延迟容易吗？😁","like_count":2},{"had_liked":false,"id":1587,"user_name":"V","can_delete":false,"product_type":"c1","uid":1013760,"ip_address":"","ucode":"A16CBAAAEFF4B7","user_header":"https://static001.geekbang.org/account/avatar/00/0f/78/00/24b9ecbc.jpg","comment_is_top":false,"comment_ctime":1513701084,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"10103635676","product_id":100002201,"comment_content":"实用","like_count":2},{"had_liked":false,"id":214444,"user_name":"彭发红","can_delete":false,"product_type":"c1","uid":1461374,"ip_address":"","ucode":"9BAC208700791E","user_header":"https://static001.geekbang.org/account/avatar/00/16/4c/7e/4771d8a4.jpg","comment_is_top":false,"comment_ctime":1588750906,"is_pvip":true,"discussion_count":0,"race_medal":0,"score":"5883718202","product_id":100002201,"comment_content":"感觉写代码就像造一套房子一样，或者说是皇宫。有厨子、侍卫、医生","like_count":1},{"had_liked":false,"id":211401,"user_name":"Geek_130e9e","can_delete":false,"product_type":"c1","uid":1587628,"ip_address":"","ucode":"518AAF2F228C17","user_header":"","comment_is_top":false,"comment_ctime":1587958587,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"5882925883","product_id":100002201,"comment_content":"Zipkin更适合做全链路跟踪，Pingpoint接入一个jar包在jvm启动命令，简单但后续管理不简单。相反，比较灵活易与管理的还是以sdk实现的。","like_count":1},{"had_liked":false,"id":164057,"user_name":"slark","can_delete":false,"product_type":"c1","uid":1143574,"ip_address":"","ucode":"7E8DE962AA23A7","user_header":"https://static001.geekbang.org/account/avatar/00/11/73/16/595b0342.jpg","comment_is_top":false,"comment_ctime":1576852176,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"5871819472","product_id":100002201,"comment_content":"最近的工作中感觉测试+监控是项目中非常重要的一环。多个团队或者需要接入其他厂商的产品，不经过测试无法对产品功能性能有底。而监控，可以说是上线后对产品的运行状况的掌控。通过对主机，对接口，对调用情况的监控，可以让我们知道系统运行是否正常，同时出现异常可以迅速知道并能跟踪定位。当然。要达到效果，需要有工具有科学方法和规范，甚至一些语言没有那么好的生态。监控很重要，要把监控放心里，考虑系统如何做好监控。","like_count":1},{"had_liked":false,"id":68778,"user_name":"Wander","can_delete":false,"product_type":"c1","uid":1089324,"ip_address":"","ucode":"54B13CCB88A814","user_header":"","comment_is_top":false,"comment_ctime":1550606853,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"5845574149","product_id":100002201,"comment_content":"陈老师，我在一家硅谷startup工作，感觉我们的工程师都没有重视全栈监控的意识（比如到处200加err code）。想请问您有没有推荐的英文资料能解释清楚全栈监控重要性的？谢谢！","like_count":1},{"had_liked":false,"id":2508,"user_name":"whhbbq","can_delete":false,"product_type":"c1","uid":1018494,"ip_address":"","ucode":"4A93F3E375CB44","user_header":"","comment_is_top":false,"comment_ctime":1517506622,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"5812473918","product_id":100002201,"comment_content":"陈老师，这些好的监控系统的特性zipkin都能实现吗?","like_count":1},{"had_liked":false,"id":1571,"user_name":"郎哲","can_delete":false,"product_type":"c1","uid":1007926,"ip_address":"","ucode":"EE2F5F061E2F7A","user_header":"https://static001.geekbang.org/account/avatar/00/0f/61/36/343a8ef8.jpg","comment_is_top":false,"comment_ctime":1513642420,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"5808609716","product_id":100002201,"comment_content":"没有做监控的可以参考做一下啦，基础监控一般像阿里云和AWS提供商都做了","like_count":1},{"had_liked":false,"id":316705,"user_name":"方勇(gopher)","can_delete":false,"product_type":"c1","uid":1290625,"ip_address":"","ucode":"D199911C4CFEF5","user_header":"https://static001.geekbang.org/account/avatar/00/13/b1/81/13f23d1e.jpg","comment_is_top":false,"comment_ctime":1634519760,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1634519760","product_id":100002201,"comment_content":"数据收集和数据关联！关联非常重要也非常难，目前面临的是告警收敛策略！","like_count":0},{"had_liked":false,"id":316432,"user_name":"fomy","can_delete":false,"product_type":"c1","uid":1125834,"ip_address":"","ucode":"CD87EA03B1F327","user_header":"https://static001.geekbang.org/account/avatar/00/11/2d/ca/02b0e397.jpg","comment_is_top":false,"comment_ctime":1634303066,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1634303066","product_id":100002201,"comment_content":"现在公司在推全链路监控，因为用的中间件不一样，只能通过http header头手工埋点了。<br><br>skywalking在耗时上不够直观，还有没有sql耗时的监控，相对来说cat在这方面做的就好不少了。但是cat又是代码侵入的。","like_count":0},{"had_liked":false,"id":284230,"user_name":"Geek_fbfc4f","can_delete":false,"product_type":"c1","uid":2446418,"ip_address":"","ucode":"7010B242A3F474","user_header":"https://thirdwx.qlogo.cn/mmopen/vi_32/zdK3dSkFwicZHtx5CLAKFJRORRibq2YqvHOP0tySLxVx0X1oD9AJanan2wia2hHaswgxdrCzEEGyVgFTVZ8sElTzQ/132","comment_is_top":false,"comment_ctime":1616129583,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1616129583","product_id":100002201,"comment_content":"相见恨晚。这篇文章发布的时候，还没毕业🎓。","like_count":0},{"had_liked":false,"id":279348,"user_name":"vegas","can_delete":false,"product_type":"c1","uid":1882795,"ip_address":"","ucode":"312B85FFF1151F","user_header":"https://static001.geekbang.org/account/avatar/00/1c/ba/ab/31ce4a20.jpg","comment_is_top":false,"comment_ctime":1613726810,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1613726810","product_id":100002201,"comment_content":"我们公司cto一门心思堆监控case，数字是好看了，汇报kpi也有了，可是一年到头监控都没法用","like_count":0},{"had_liked":false,"id":276009,"user_name":"Geek_092552","can_delete":false,"product_type":"c1","uid":1332352,"ip_address":"","ucode":"FE13A36E15DBA3","user_header":"https://thirdwx.qlogo.cn/mmopen/vi_32/sic7iatOg6ibkc8ZfWke5mKfgTK8gJ6CVLDFp4D8LuGOMMHbOnNhu81EA3Kfjg95tWqeySgJxvTQSdPkwOHAuBybg/132","comment_is_top":false,"comment_ctime":1611743200,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1611743200","product_id":100002201,"comment_content":"确实如此，之前公司一出故障先看到某个指标不正常了，然后猜测是不是其他服务出问题了，在zabbix, elk 多个系统之间来回追查。如果能有个聚合视图，就能够非常快速地定位问题了。","like_count":0},{"had_liked":false,"id":267189,"user_name":"宇飞","can_delete":false,"product_type":"c1","uid":1105513,"ip_address":"","ucode":"D64C53CD189164","user_header":"https://static001.geekbang.org/account/avatar/00/10/de/69/113da382.jpg","comment_is_top":false,"comment_ctime":1607646699,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1607646699","product_id":100002201,"comment_content":"全栈监控有基础层，中间件，应用层，每层都有对应的工具和技术，关键还得关联起来，需要用trace跟踪，要是可以把所有监控都放到一张表上就好了","like_count":0},{"had_liked":false,"id":258264,"user_name":"dawa大娃bigbaby","can_delete":false,"product_type":"c1","uid":2278722,"ip_address":"","ucode":"A3D0AF039B693A","user_header":"https://static001.geekbang.org/account/avatar/00/22/c5/42/255602d0.jpg","comment_is_top":false,"comment_ctime":1604364021,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1604364021","product_id":100002201,"comment_content":"原来，Dynatrace产品就是解决这一系列问题设计的呀","like_count":0},{"had_liked":false,"id":232491,"user_name":"梅端","can_delete":false,"product_type":"c1","uid":1525335,"ip_address":"","ucode":"FEC08731457770","user_header":"https://static001.geekbang.org/account/avatar/00/17/46/57/fe38a6db.jpg","comment_is_top":false,"comment_ctime":1594018504,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1594018504","product_id":100002201,"comment_content":"对于分布式系统而言，监控真的是非常关键的一环，但是之前对于如何监控分布式系统我一直感觉云里雾里，看了皓哥的这篇分享，我觉得有了一个更加清晰的认识，当然最好的方式是自己去实现一个全链路的监控系统才能更好地领悟其精髓，也是我后续需要努力的方向。","like_count":0},{"had_liked":false,"id":220759,"user_name":"爱学习的大叔","can_delete":false,"product_type":"c1","uid":1085152,"ip_address":"","ucode":"91F9ABF1EC98D0","user_header":"https://static001.geekbang.org/account/avatar/00/10/8e/e0/847348b1.jpg","comment_is_top":false,"comment_ctime":1590320070,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1590320070","product_id":100002201,"comment_content":"New Relic 和ELK都用过，都还可以。ELK是开源的。不过有些模块是收费的。","like_count":0},{"had_liked":false,"id":218747,"user_name":"天草二十六","can_delete":false,"product_type":"c1","uid":1360712,"ip_address":"","ucode":"3165EE3007527B","user_header":"https://static001.geekbang.org/account/avatar/00/14/c3/48/3a739da6.jpg","comment_is_top":false,"comment_ctime":1589864576,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1589864576","product_id":100002201,"comment_content":"我们本来是报错4xx，现在又修改为200加code方式了。为的是客户端容易区分判断。并不是错误，所以认可。请问跟耗子讲的糟糕情况是不是一回事","like_count":0},{"had_liked":false,"id":211592,"user_name":"arch","can_delete":false,"product_type":"c1","uid":1078931,"ip_address":"","ucode":"A69EBFE0520B85","user_header":"https://static001.geekbang.org/account/avatar/00/10/76/93/64ed7385.jpg","comment_is_top":false,"comment_ctime":1587986966,"is_pvip":true,"discussion_count":0,"race_medal":0,"score":"1587986966","product_id":100002201,"comment_content":"APM系统新秀skywalking是国人的骄傲","like_count":0},{"had_liked":false,"id":210174,"user_name":"learning","can_delete":false,"product_type":"c1","uid":1236953,"ip_address":"","ucode":"14CE94C24F9C87","user_header":"https://static001.geekbang.org/account/avatar/00/12/df/d9/a90b2488.jpg","comment_is_top":false,"comment_ctime":1587694377,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1587694377","product_id":100002201,"comment_content":"一个好的监控系统，可以提前预警，快速定位问题，运维福音","like_count":0},{"had_liked":false,"id":195949,"user_name":"GZC","can_delete":false,"product_type":"c1","uid":1928513,"ip_address":"","ucode":"1A96BC07D8BC42","user_header":"https://static001.geekbang.org/account/avatar/00/1d/6d/41/256f7238.jpg","comment_is_top":false,"comment_ctime":1585225497,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1585225497","product_id":100002201,"comment_content":"项目中先做个monitor，后面再迭代更新！","like_count":0},{"had_liked":false,"id":193139,"user_name":"小呆同学","can_delete":false,"product_type":"c1","uid":1085485,"ip_address":"","ucode":"D8533E2826B804","user_header":"https://static001.geekbang.org/account/avatar/00/10/90/2d/90644692.jpg","comment_is_top":false,"comment_ctime":1584884683,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1584884683","product_id":100002201,"comment_content":"我还只停留在机器监控上，，此时发现我想的完全偏离轨道","like_count":0},{"had_liked":false,"id":187714,"user_name":"亢（知行合一的路上）","can_delete":false,"product_type":"c1","uid":1347013,"ip_address":"","ucode":"958AF7C96EB9E8","user_header":"https://static001.geekbang.org/account/avatar/00/14/8d/c5/898b13b4.jpg","comment_is_top":false,"comment_ctime":1584197722,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1584197722","product_id":100002201,"comment_content":"遇到 web 请求异常的情况，通过全栈完整的调用链，就可以看到请求的完整处理过程，很快定位问题所在。有些请求产生很多结果，websocket 方式连接，也可以看到结果返回的频率，中断了，也可以看到服务端的报错信息，或是系统资源不足导致处理速度变慢。<br>服务器资源不足，可以收到通知，增开服务器，或者服务降级。<br>也要结合业务特点，监控必要的指标，不求多，要求精准。","like_count":0},{"had_liked":false,"id":163511,"user_name":"知行合一","can_delete":false,"product_type":"c1","uid":1521486,"ip_address":"","ucode":"2B8E634FC4CFB7","user_header":"https://static001.geekbang.org/account/avatar/00/17/37/4e/5c3153b2.jpg","comment_is_top":false,"comment_ctime":1576735432,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1576735432","product_id":100002201,"comment_content":"全栈监控主要是能把所有服务都串联起来，并能找出出问题的点，我们公司的服务是能够串起来，但是没法做到底层，中间件层和应用层的串联，这个比较有挑战，都是割裂的，需要自己一个一个去看，很费时间。","like_count":0},{"had_liked":false,"id":163275,"user_name":"Geek_a95326","can_delete":false,"product_type":"c1","uid":1103082,"ip_address":"","ucode":"02CD9929766EE5","user_header":"http://thirdwx.qlogo.cn/mmopen/vi_32/DYAIOgq83erhoVfUiaSk1lpZbIZ2UlIr4c7ae1U5EgYkDE7rYGY8lMauGg027C7bUV01yJiaVXRFC69iasYczQZRQ/132","comment_is_top":false,"comment_ctime":1576678516,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1576678516","product_id":100002201,"comment_content":"我的理解全站监控的基础就是具备能够把一个请求的基本信息透传下去能力，前端接口请求-&gt;服务端-&gt;中间件-&gt;DB,做到全链路的请求追踪，要做到全链路透传需要解决的核心问题应该是如果实现不同中间件之间的上下文透传，这就需要一套标准，举个例子，中间件之间互相调用的时候需要统一在上下文中加入当次调用的信息","like_count":0},{"had_liked":false,"id":163183,"user_name":"文刂 氵共 超","can_delete":false,"product_type":"c1","uid":1282813,"ip_address":"","ucode":"C2CE1512D23012","user_header":"https://static001.geekbang.org/account/avatar/00/13/92/fd/6b0e58fe.jpg","comment_is_top":false,"comment_ctime":1576666816,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1576666816","product_id":100002201,"comment_content":"Day03：学习笔记 https:&#47;&#47;mubu.com&#47;colla&#47;qGfArWqlvM","like_count":0},{"had_liked":false,"id":163101,"user_name":"stars","can_delete":false,"product_type":"c1","uid":1055100,"ip_address":"","ucode":"8A75D9E1909729","user_header":"https://static001.geekbang.org/account/avatar/00/10/19/7c/25abe455.jpg","comment_is_top":false,"comment_ctime":1576657027,"is_pvip":true,"discussion_count":1,"race_medal":0,"score":"1576657027","product_id":100002201,"comment_content":"国内除了腾讯，阿里这些一线大厂，做这么深入的监控几乎没有，大部分都是出了问题才处理。感谢陈老师给我们一个长见识的机会。","like_count":0,"discussions":[{"author":{"id":1066547,"avatar":"https://static001.geekbang.org/account/avatar/00/10/46/33/2e71b679.jpg","nickname":"酱紫的小白兔","note":"","ucode":"5A919678D3C039","race_medal":0,"user_type":1,"is_pvip":true},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":87969,"discussion_content":"银行有","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1576681702,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":163083,"user_name":"William Ning","can_delete":false,"product_type":"c1","uid":1592279,"ip_address":"","ucode":"4DB8D05E69E5F3","user_header":"https://static001.geekbang.org/account/avatar/00/18/4b/d7/f46c6dfd.jpg","comment_is_top":false,"comment_ctime":1576654431,"is_pvip":true,"discussion_count":0,"race_medal":0,"score":"1576654431","product_id":100002201,"comment_content":"一知半解&#47; ","like_count":0},{"had_liked":false,"id":162897,"user_name":"cf","can_delete":false,"product_type":"c1","uid":1563302,"ip_address":"","ucode":"1CBDFB2549B961","user_header":"http://thirdwx.qlogo.cn/mmopen/vi_32/uxKzInotBfwJLOfGtLrLC181ISxn539P04ibGVbB5lFBhCeN52kjATon74B6JQibuyTVibc8rPKUPvA63684AmVibA/132","comment_is_top":false,"comment_ctime":1576630023,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1576630023","product_id":100002201,"comment_content":"卡","like_count":0},{"had_liked":false,"id":162896,"user_name":"随风","can_delete":false,"product_type":"c1","uid":1593949,"ip_address":"","ucode":"EF3E124B05D42D","user_header":"http://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTIia1btmwb5hhTazpu2OxaiaGwavXPQrsp5QVIlSF5jczsq3PS3siaUiazSErAKuiangahTjVpXCNV1W6A/132","comment_is_top":false,"comment_ctime":1576629714,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1576629714","product_id":100002201,"comment_content":"一个全方位的服务监控介绍，可以以此为大纲详细学习。","like_count":0},{"had_liked":false,"id":101289,"user_name":"edisonhuang","can_delete":false,"product_type":"c1","uid":1530167,"ip_address":"","ucode":"BB2F639A779F96","user_header":"https://static001.geekbang.org/account/avatar/00/17/59/37/bd2de0a4.jpg","comment_is_top":false,"comment_ctime":1559778595,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1559778595","product_id":100002201,"comment_content":"建立全站的系统监控，是我们做分布式系统性能分析的眼睛。<br>有了全站的系统监控，就可以做分布式系统的容量管理和性能管理。从而可以做到问题快速定位和系统性能分析。<br>在做全站监控的过程中需要注意全站日志结构化和统一，对关联指标做聚合，对性能指标可以做topn排序，从而能再发生问题时候快速定位故障点，帮助开发人员识别性能瓶颈，合作改进，提升系统性能和稳定性。","like_count":0},{"had_liked":false,"id":78325,"user_name":"Linux命令手册","can_delete":false,"product_type":"c1","uid":1069291,"ip_address":"","ucode":"F80776F9F53337","user_header":"https://static001.geekbang.org/account/avatar/00/10/50/eb/a1a2cf00.jpg","comment_is_top":false,"comment_ctime":1553130822,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1553130822","product_id":100002201,"comment_content":"皓叔，APM是基于zipkin开发的？","like_count":0},{"had_liked":false,"id":58464,"user_name":"海","can_delete":false,"product_type":"c1","uid":1164758,"ip_address":"","ucode":"560C47EFAFA53C","user_header":"https://static001.geekbang.org/account/avatar/00/11/c5/d6/705dcfdd.jpg","comment_is_top":false,"comment_ctime":1547086646,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1547086646","product_id":100002201,"comment_content":"耗子哥，现在分布式监控中间件繁多，做好分布式中间件需要选型哪些比较好的组件可以提及一下么，另外每个组件功能并不全面，如何优雅的将监控信息进行整合到一个或多个仪表盘","like_count":0},{"had_liked":false,"id":55337,"user_name":"钱","can_delete":false,"product_type":"c1","uid":1009652,"ip_address":"","ucode":"2C92A243A463D4","user_header":"https://static001.geekbang.org/account/avatar/00/0f/67/f4/9a1feb59.jpg","comment_is_top":false,"comment_ctime":1546137429,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1546137429","product_id":100002201,"comment_content":"对比一下公司的各种基础工具，确实如此，各个工具虽有打通，但是还不够，排查一个问题需要登录许多的工具操作平台。上下游服务也是隔离的，比如：调用其他组的服务超时，只能找他们继续定位具体原因；还有报警系统和日志系统是隔离的，查一个错误需要多个系统配合，业务问题必须扒代码，然后找日志来定位。<br><br>不过有总比没有好，之前的公司比较小，只能登录服务器扒日志分析，都是后知后觉，压根没有监控。","like_count":0},{"had_liked":false,"id":40064,"user_name":"Wendy","can_delete":false,"product_type":"c1","uid":1308653,"ip_address":"","ucode":"398DDC96B178F7","user_header":"http://thirdwx.qlogo.cn/mmopen/vi_32/0PT9LxT8D6micyk0YbPuGQElQIeSax7puBBTXJDicJDhUHNibrbJPjEPJBRklVmcKG1PB7YV8JNh0BpsJjSicfibT5A/132","comment_is_top":false,"comment_ctime":1542461683,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1542461683","product_id":100002201,"comment_content":"老师，用zipkin方便对业务日志的收集吗","like_count":0},{"had_liked":false,"id":5313,"user_name":"毛洪博","can_delete":false,"product_type":"c1","uid":1083768,"ip_address":"","ucode":"D5DDE602FDA816","user_header":"https://static001.geekbang.org/account/avatar/00/10/89/78/16c56f99.jpg","comment_is_top":false,"comment_ctime":1523104684,"is_pvip":false,"discussion_count":2,"race_medal":0,"score":"1523104684","product_id":100002201,"comment_content":"监控和报警的关系怎么界定？用报警来定位故障，还是需要通过监控来定位？如果出现了大故障，整个链路都会报警，报警数量特别多，很容易将最初最核心的报警给淹没了，想知道这个问题是怎么解决的？","like_count":0,"discussions":[{"author":{"id":1158539,"avatar":"","nickname":"花无缺","note":"","ucode":"BA0334A12B81AF","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":318288,"discussion_content":"合理设定SLA，SLO，把无用的告警给删掉 ","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1603698362,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1024164,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/a0/a4/b060c723.jpg","nickname":"阿斯蒂芬","note":"","ucode":"61D5E3BDA4EBC5","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":223745,"discussion_content":"感觉报警就是监控的一环。对于您说的这个故障报警，老师讲的监控应该主要是对于整个调用链路的监控，而且必须把这个链路“友好”地聚合在一起展现（或提供数据排查）。\n打个比方，就像写代码抛出异常，我们可以只记录最终出异常的那一行，这样也可以直接快速定位到最后是哪一行出错了，我们也可以记录下整个调用堆栈，这样不仅仅知道最后是在哪一行抛的异常，还能（迅速）知道从哪里开始调用中间经过了哪些方法。\n个人认为只要聚合好了，就算整个链路都报警，也可以清晰区分头尾，并不会造成淹没。\n一点拙见。\n两年了，题主有无新的理解，求指点","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1586250843,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":1766,"user_name":"起司猫","can_delete":false,"product_type":"c1","uid":1018670,"ip_address":"","ucode":"D86EF6FBA10EAC","user_header":"https://static001.geekbang.org/account/avatar/00/0f/8b/2e/df74d56a.jpg","comment_is_top":false,"comment_ctime":1514420072,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1514420072","product_id":100002201,"comment_content":"我们这也没有地图……","like_count":0}]}