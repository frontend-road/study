{"id":173619,"title":"61 |Â å…¨å±€æ€§åŠŸèƒ½çš„æ¶æ„è®¾è®¡","content":"<p>ä½ å¥½ï¼Œæˆ‘æ˜¯ä¸ƒç‰›äº‘è®¸å¼ä¼Ÿã€‚</p><p>åœ¨ä¸Šä¸€è®² â€œ<a href=\"https://time.geekbang.org/column/article/172004\">åŠ é¤ | å®æˆ˜ï¼šç”»å›¾ç¨‹åºçš„æ•´ä½“æ¶æ„</a>â€ ä¸­ï¼Œæˆ‘ä»¬ç»“åˆå‰é¢å‡ ç« çš„å®æˆ˜æ¡ˆä¾‹ç”»å›¾ç¨‹åºæ¥å®é™…æ¢è®¨æˆ‘ä»¬æ¶æ„æ€ç»´çš„è¿ç”¨ã€‚è¿™ä¸€ç¯‡è™½ç„¶ä»¥åŠ é¤åä¹‰ä½“ç°ï¼Œä½†å®ƒå¯¹ç†è§£æ€ä¹ˆå¼€å±•å’Œè¯„ä¼°æ¶æ„å·¥ä½œéå¸¸å…³é”®ã€‚</p><p>åœ¨æ¶æ„è®¾è®¡ä¸­ï¼Œæˆ‘ä»¬ä¼šæœ‰ä¸€äº›éš¾å•ƒçš„éª¨å¤´ã€‚å…¶ä¸­æœ€ä¸ºå…¸å‹çš„ï¼Œå°±æ˜¯å…¨å±€æ€§åŠŸèƒ½ã€‚å…¨å±€æ€§åŠŸèƒ½çš„ç‰¹å¾æ˜¯å¾ˆéš¾è¢«å‰¥ç¦»å‡ºæ¥æˆä¸ºç‹¬ç«‹æ¨¡å—çš„ã€‚æˆ‘ä»¬ä»ç„¶ä»¥å¤§å®¶ç†Ÿæ‚‰çš„ Office è½¯ä»¶ä½œä¸ºä¾‹å­ï¼š</p><ul>\n<li>è¯»ç›˜/å­˜ç›˜ï¼šæ¯å¢åŠ ä¸€ä¸ªåŠŸèƒ½ï¼Œéƒ½éœ€è¦è€ƒè™‘è¿™ä¸ªåŠŸèƒ½çš„æ•°æ®å¦‚ä½•å­˜å‚¨åˆ°ç£ç›˜ï¼Œå¦‚ä½•ä»ç£ç›˜ä¸­æ¢å¤ã€‚</li>\n<li>Undo/Redoï¼šæ¯å¢åŠ ä¸€ä¸ªåŠŸèƒ½ï¼Œéƒ½éœ€è¦è€ƒè™‘è¿™ä¸ªåŠŸèƒ½å¦‚ä½•å›æ»š/é‡åšï¼Œå¾ˆéš¾å‰¥ç¦»ã€‚</li>\n<li>å®å½•åˆ¶ï¼šæ¯å¢åŠ ä¸€ä¸ªåŠŸèƒ½ï¼Œéƒ½éœ€è¦è€ƒè™‘è¿™ä¸ªåŠŸèƒ½æ‰§è¡Œçš„ç»“æœå¦‚ä½•ç”¨ API è¡¨è¾¾ï¼Œå¹¶ä¸”å¾—æ”¯æŒå°†ç•Œé¢æ“ä½œç¿»è¯‘æˆ API è¯­å¥ã€‚</li>\n<li>â€¦â€¦</li>\n</ul><p>ä¹Ÿæœ‰ä¸€äº›åŠŸèƒ½çœ‹ä¼¼æ¯”è¾ƒå…¨å±€ï¼Œä½†å®é™…ä¸Šå¾ˆå®¹æ˜“åšæ­£äº¤åˆ†è§£ï¼Œæ¯”å¦‚æœåŠ¡ç«¯çš„æ‰€æœ‰ API éƒ½éœ€è¦é‰´æƒï¼Œéƒ½éœ€è¦è®°å½•æ—¥å¿—ã€‚å®ƒä»¬ä¼¼ä¹æœ‰å…¨å±€æ€§çš„å½±å“ï¼Œä½†ä¸€æ–¹é¢ï¼Œé€šå¸¸å¯ä»¥åœ¨ API å…¥å£ç»Ÿä¸€å¤„ç†ï¼Œå¦ä¸€æ–¹é¢å°±ç®—åªæ˜¯æä¾›è¾…åŠ©å‡½æ•°ï¼Œå…·ä½“çš„é‰´æƒå’Œè®°å½•æ—¥å¿—éƒ½ç”±æ¯ä¸ª API è‡ªè¡Œå¤„ç†ï¼Œå¿ƒæ™ºè´Ÿæ‹…ä¸ç®—å¤ªé«˜ã€‚æ‰€ä»¥å¯¹äºè¿™ç±»åŠŸèƒ½ï¼Œæˆ‘ä»¬å¯ä»¥ä¸æŠŠå®ƒå½’ä¸ºå…¨å±€æ€§åŠŸèƒ½ã€‚</p><p>æ­£å› ä¸ºéœ€æ±‚äº¤ç»‡åœ¨ä¸€èµ·ï¼Œå…¨å±€æ€§åŠŸèƒ½å¾€å¾€éš¾ä»¥å½»åº•è¿›è¡Œæ­£äº¤åˆ†è§£ã€‚ä½†å¯¹äºæ¶æ„å¸ˆæ¥è¯´ï¼Œéš¾ä¸ä»£è¡¨åº”è¯¥è½»æ˜“å°±æ”¾å¼ƒå¯¹æ­£äº¤åˆ†è§£çš„è¿½æ±‚ã€‚</p><!-- [[[read_end]]] --><p>ä¸èƒ½æ”¾è¿‡ä»»ä½•ä¸€å—éš¾å•ƒçš„éª¨å¤´ã€‚</p><h2>è¯»ç›˜/å­˜ç›˜åŠŸèƒ½</h2><p>ä¸èƒ½å¾ˆå¥½åˆ†è§£å¾€å¾€è¿˜æ˜¯éœ€æ±‚çš„åˆ†ææ²¡æœ‰åˆ°ä½æ‰€è‡´ã€‚å‰é¢åœ¨ â€œ<a href=\"https://time.geekbang.org/column/article/170912\">60 | æ¶æ„åˆ†è§£ï¼šè¾¹ç•Œï¼Œä¸æ–­é‡æ–°å®¡è§†è¾¹ç•Œ</a>â€ è¿™ä¸€è®²ä¸­æˆ‘ä»¬å·²ç»æ‹¿ â€œè¯»ç›˜/å­˜ç›˜â€ ä½œä¸ºæ¡ˆä¾‹è¿›è¡Œè¿‡åˆ†æã€‚æœ€ç»ˆæˆ‘ä»¬é€‰æ‹©äº†å¼•å…¥ IO DOM æ¥è¿›è¡Œæ­£äº¤åˆ†è§£ã€‚è¿™é‡Œé¢çš„å…³é”®ç‚¹åœ¨äºï¼š</p><p>å…¶ä¸€ï¼Œâ€œè¯»ç›˜/å­˜ç›˜â€ æœ¬èº«éœ€æ±‚æ˜¯å‘æ•£çš„ï¼Œå› ä¸ºè¦æ”¯æŒçš„æ–‡æ¡£æ ¼å¼åªä¼šè¶Šæ¥è¶Šå¤šã€‚æ‰€ä»¥æˆ‘ä»¬å¿…é¡»æŠŠå®ƒç‹¬ç«‹æˆä¸€ä¸ªå­ç³»ç»Ÿï¼Œæ¯”å¦‚å«å®ƒ IO å­ç³»ç»Ÿã€‚</p><p>å…¶äºŒï¼Œæ—¢ç„¶è¦ç‹¬ç«‹å­ç³»ç»Ÿï¼Œå°±éœ€è¦æŠ½è±¡å‡ºå®ƒå¯¹æ ¸å¿ƒç³»ç»Ÿçš„ç¨³å®šä¾èµ–ã€‚ä¸ºä»€ä¹ˆè¿™ä¸ªç¨³å®šä¾èµ–æœ€åè®¾è®¡ä¸º IO DOMï¼Œæ˜¯å› ä¸º DOM æ˜¯æ ¸å¿ƒç³»ç»Ÿçš„å¸¸è§„ç•Œé¢ã€‚</p><p>å¼•å…¥åªä¸æ•°æ®æœ‰å…³çš„ IO DOMï¼Œç›¸å½“äºç»™ DOM è§„èŒƒäº†ä¸€ä¸ªæ¥å£å­é›†ï¼Œç”¨äºå’Œ IO å­ç³»ç»Ÿäº¤äº’ã€‚è¿™æ ·çš„å¥½å¤„æ˜¯ï¼Œè™½ç„¶ IO DOM æ˜¯ IO å­ç³»ç»Ÿå¯¹æ ¸å¿ƒç³»ç»Ÿçš„ä¾µå…¥ï¼Œä½†è¿™æ˜¯æ²¡åŠæ³•çš„ï¼Œå› ä¸ºè¯»ç›˜å­˜ç›˜æ˜¯å…¨å±€åŠŸèƒ½ï¼Œæˆ‘ä»¬æ²¡æ³•æ¶ˆé™¤è¿™ç§å…¨å±€æ€§ï¼Œä½†æ˜¯å¯ä»¥å°½å¯èƒ½å‰Šå¼±åˆ°æœ€ä½ã€‚</p><p>å¦‚æœ IO DOM çš„ç¡®æ˜¯ DOM çš„å­é›†ï¼Œæˆ‘ä»¬ç›¸å½“äºå·²ç»æ‰¾åˆ°äº†å°½å¯èƒ½å‰Šå¼±çš„æ–¹æ³•ï¼Œå› ä¸º IO DOM åç§°ä¸Šè™½ç„¶å¸¦äº† IOï¼Œä½†æ˜¯å®ƒåªæ˜¯ä¸€ä¸ªå½’ç±»ï¼Œå®é™…ä¸Šè¿™äº›æ¥å£éƒ½æ˜¯æ ¸å¿ƒç³»ç»Ÿçš„å¸¸è§„æ¥å£ï¼Œå¹¶éä¸º IO å­ç³»ç»Ÿå®šåˆ¶ã€‚è¿™æ ·ä¸€æ¥ï¼Œè¯»ç›˜ä¸å­˜ç›˜å¸¦æ¥çš„å…¨å±€æ€§å½±å“å°±è¿‘ä¹è¢«æ¶ˆé™¤äº†ã€‚</p><p>è¿™æ˜¯ä¸€ç§å¾ˆå¥½çš„æ€è€ƒæ–¹å¼ã€‚</p><p>å…¨å±€æ€§åŠŸèƒ½å¾€å¾€å®¹æ˜“å¸¦æ¥æŸç§å¤æ‚çš„æ¡†æ¶ã€‚è¿™ä¸éš¾ç†è§£ï¼Œæ¯•ç«Ÿå®ƒæ˜¯å…¨å±€æ€§çš„ï¼Œæ‰€ä»¥å¸¸è§„çš„æ€è·¯æ˜¯ä¸ºè¿™ä¸ªåŠŸèƒ½å®ç°ä¸€ä¸ªåº“ï¼Œå¹¶å»ºç«‹ä¸€å¥—ä½¿ç”¨å®ƒçš„æœºåˆ¶ï¼Œä¹Ÿå°±æ˜¯æ¡†æ¶ï¼Œä»¥åº”ç”¨åˆ°æ ¸å¿ƒç³»ç»Ÿä¸­å»ã€‚ä¸Šé¢ IO DOM åˆ™æ˜¯åå…¶é“è€Œè¡Œä¹‹ï¼Œé€šè¿‡æŠ½è±¡æ ¸å¿ƒç³»ç»Ÿçš„æ¥å£ï¼Œè®©å…¨å±€æ€§åŠŸèƒ½åå‘ä¾èµ–è¿™äº›æ¥å£æ¥å®Œæˆã€‚è¿™ä¸å®¹æ˜“ï¼Œä½†æ˜¯è¿™æ ·åšæ ¸å¿ƒç³»ç»Ÿå—åˆ°çš„ä¼¤å®³å€¼æœ€ä½ã€‚</p><h2>Undo/Redo åŠŸèƒ½</h2><p>æˆ‘ä»¬å†çœ‹ä¸€ä¸ªä¾‹å­ï¼Œæ¯”å¦‚ Undo/Redo åŠŸèƒ½ã€‚</p><p>è¯»è¿‡è®¾è®¡æ¨¡å¼çš„å°ä¼™ä¼´ä»¬å¯èƒ½éƒ½çŸ¥é“ï¼Œåœ¨è®¾è®¡æ¨¡å¼ä¸­æœ‰ä¸€ä¸ªæ¨¡å¼å« Command æ¨¡å¼ï¼Œä¸“é—¨ç”¨äºè§£å†³ Undo/Redo è¿™ä¸ªåŠŸèƒ½åœºæ™¯çš„ã€‚å®ƒçš„åŸºæœ¬æ€è·¯æ˜¯ï¼Œæ¯ä¸ªç”¨æˆ·æ“ä½œéƒ½å®ç°ä¸ºä¸€ä¸ª Commandï¼Œæ¯ä¸ª Command éœ€è¦å®ç°åæ“ä½œï¼Œä»¥ä¾¿åšåˆ° Undo çš„èƒ½åŠ›ã€‚</p><p>è¿™æ˜¯ä¸€ä¸ªå…¸å‹çš„ Undo/Redo æ¡†æ¶ã€‚å®é™…ä¸Šè¿™ä¸ªæ¡†æ¶æœ¬èº«åšçš„äº‹æƒ…å¹¶ä¸å¤šï¼ŒåŸºæœ¬ä¸Šå°±æ˜¯ç»´æŠ¤ä¸€ä¸ª Command é˜Ÿåˆ—ï¼Œå¹¶åŸºäºè¿™ä¸ªé˜Ÿåˆ—æä¾› Undo å’Œ Redo åŠŸèƒ½ã€‚</p><p>çœ‹èµ·æ¥ä¸é”™çš„æ ·å­ï¼Œä½†å®é™…ä¸Šæ¡†æ¶åªèŠ‚çœäº† 1% çš„å·¥ä½œé‡ã€‚å…¶ä½™ 99% çš„å·¥ä½œé‡åœ¨å®ç°ä¸€ä¸ªä¸ª Command èº«ä¸Šï¼Œæ¡†æ¶ä½¿ç”¨æ–¹çš„å¿ƒæ™ºè´Ÿæ‹…ä¸æ˜¯ä¸€ç‚¹ç‚¹çš„å¤§ã€‚</p><p>é‚£ä¹ˆæœ‰å¯èƒ½è®© Undo/Redo ä¸æ ¸å¿ƒç³»ç»Ÿè§£è€¦ä¹ˆï¼Ÿ</p><p>è¿™å½“ç„¶æ˜¯å¯èƒ½çš„ã€‚</p><p>æˆ‘ç¬¬ä¸€æ¬¡å¯¹ Undo/Redo å®ç°æœºåˆ¶åæ€çš„çµæ„Ÿï¼Œæ¥è‡ªäºåš IO å­ç³»ç»Ÿçš„ç»å†ã€‚å‰é¢æŸä¸€è®²ä¸­æˆ‘ä¹Ÿæè¿‡ï¼Œåœ¨æˆ‘å®ä¹ çš„æ—¶å€™ï¼Œåšçš„ç¬¬ä¸€ä»½å·¥ä½œä»»åŠ¡æ˜¯è¯»ç›˜ä¸å­˜ç›˜ã€‚åœ¨åšéœ€æ±‚åˆ†æçš„æ—¶å€™ï¼Œæˆ‘å‘ç°å¾®è½¯ Office æ”¯æŒä¸€ä¸ªå¾ˆæœ‰æ„æ€çš„åŠŸèƒ½ï¼Œå«å¿«é€Ÿå­˜ç›˜ã€‚åœ¨ç¼–è¾‘ä¸€ä»½ Word æ–‡æ¡£ï¼Œæ‰“å‡ ä¸ªå­—å­˜ç›˜æ—¶ï¼ŒWord å¾ˆå¿«å°±å¯ä»¥ä¿å­˜å®Œæ¯•ï¼Œè€Œ WPS å½“æ—¶åˆ™ä¼šå¯¼è‡´äº¤äº’ç•Œé¢åœé¡¿ï¼Œå­˜ç›˜æ²¡æœ‰å®Œæˆæ—¶ç”¨æˆ·æ— æ³•ç¼–è¾‘ã€‚</p><p>å¾®è½¯æ€ä¹ˆåšåˆ°çš„å‘¢ï¼Ÿå®ƒèƒŒåçš„æœºåˆ¶å°±æ˜¯å¿«é€Ÿå­˜ç›˜ã€‚æ‰€è°“å¿«é€Ÿå­˜ç›˜ï¼Œå°±æ˜¯å­˜ç›˜çš„æ—¶å€™å¹¶ä¸æ˜¯æŠŠå®Œæ•´çš„æ–‡æ¡£å†™åˆ°ç£ç›˜æ–‡ä»¶ä¸­ï¼Œè€Œæ˜¯å°†ä¸Šä¸€æ¬¡å­˜ç›˜åˆ°è¿™ä¸€æ¬¡å­˜ç›˜çš„å¢é‡éƒ¨åˆ†ï¼Œè¿½åŠ åˆ°æ–‡æ¡£çš„å°¾éƒ¨ã€‚è¿™æ ·ä¸€ä¸ª Word æ–‡ä»¶å°±æœ‰å¤šä¸ªç‰ˆæœ¬çš„æ–‡æ¡£ï¼Œæ¯æ¬¡è¯»ç›˜çš„æ—¶å€™åªéœ€è¦è¯»å‡ºä¸€ä¸ªæœ€æ–°ç‰ˆæœ¬å³å¯ã€‚</p><p>å½“ç„¶è¦æƒ³é¿å…ç³»ç»Ÿæ— æ³•å“åº”ç”¨æˆ·ç¼–è¾‘çš„å¦ä¸€ä¸ªæ€è·¯æ˜¯å¼‚æ­¥å­˜ç›˜ã€‚ä¹Ÿå°±æ˜¯åœ¨å­˜ç›˜å‘½ä»¤æ‰§è¡Œä¹‹åˆï¼Œæˆ‘å¯¹æ•´ä¸ªæ–‡æ¡£çš„ DOM å»ºç«‹ä¸€ä»½é•œåƒï¼ˆSnapshotï¼‰ï¼Œå­˜ç›˜çš„æ—¶å€™åŸºäºé•œåƒè¿›è¡Œåå°å­˜ç›˜ï¼Œå°±ä¸ä¼šå½±å“åˆ°ç”¨æˆ·äº¤äº’ã€‚</p><p>è™½ç„¶é•œåƒçš„å®ç°ä»£ä»·ä¸ä½ï¼Œä½†è¿™ä¸ªæ€è·¯æœ‰å®ƒçš„ç‹¬ç‰¹å¥½å¤„ï¼Œæ¯”å¦‚æ”¯æŒå¼‚æ­¥æ‰“å°ã€‚æ‰“å°æœºæ˜¯æ¯”ç£ç›˜æ›´æ…¢çš„ IO è®¾å¤‡ã€‚å¦‚æœåœ¨æ‰“å°çš„æ—¶å€™ç”¨æˆ·å°±æ²¡æ³•ç¼–è¾‘ï¼Œä¹Ÿæ˜¯ä¸å¤ªå¥½çš„ç”¨æˆ·ä½“éªŒã€‚è€Œæ‰“å°æ˜¾ç„¶ä¹Ÿæ— æ³•é€šè¿‡ç±»ä¼¼å¿«é€Ÿå­˜ç›˜è¿™ç§æœºåˆ¶æ¥å®ç°åŠ é€Ÿï¼Œä½†é•œåƒåŠŸèƒ½åˆ™å¯ä»¥å¾ˆå¥½åœ°æå‡æ‰“å°çš„ä½“éªŒã€‚</p><p>è¿™äº›å¯¹ IO å­ç³»ç»Ÿçš„æ€è€ƒï¼Œä¸ºä»€ä¹ˆä¼šå¯¹æˆ‘æ€è€ƒ Undo/Redo æœºåˆ¶è®¾è®¡æœ‰å¸®åŠ©ï¼Ÿå› ä¸ºå®ƒä»¬æœ‰ä¸€ä¸ªå…±åŒç‚¹ï¼Œå°±æ˜¯éƒ½å’Œæ•°æ®æœ¬èº«å¯†åˆ‡ç›¸å…³ã€‚</p><p>æ¯”å¦‚ Word æ–‡æ¡£æ”¯æŒå­˜å‚¨å¤šä¸ªç‰ˆæœ¬ï¼Œæˆ‘ä»¬å¾ˆå®¹æ˜“å°±æƒ³åˆ°ï¼Œå…¶å®è¿™ä¸ªæœºåˆ¶å¯ä»¥ç”¨æ¥åš Undo/Redoã€‚æƒ³è±¡ä¸€ä¸‹ï¼Œå¦‚æœç”¨æˆ·æ¯è¿›è¡Œä¸€æ¬¡ç¼–è¾‘ï¼Œæˆ‘å°±è‡ªåŠ¨æ‰§è¡Œä¸€æ¬¡å¿«é€Ÿå­˜ç›˜ï¼Œè¿™æ ·å°±åœ¨ç£ç›˜ä¸­å½¢æˆå¤šä¸ªç‰ˆæœ¬ã€‚è¿™æ ·åœ¨åš Undo çš„æ—¶å€™ï¼Œæˆ‘ä»¬åªéœ€è¦å›é€€åˆ°ä¸Šä¸€ä¸ªç‰ˆæœ¬çš„æ–‡æ¡£å³å¯ã€‚</p><p>äº‹å®ä¸Šï¼Œåªè¦æ”¯æŒäº†å¤šç‰ˆæœ¬ï¼Œå°±æœ‰äº†é•œåƒèƒ½åŠ›ï¼Œä¹Ÿæœ‰äº† Undo/Redo èƒ½åŠ›ã€‚</p><p>è¿™äº›æ€è€ƒï¼Œå°±ä¿ƒè¿›äº†åæ¥æ•°æ®å±‚ï¼ˆDataLayerï¼‰çš„è¯ç”Ÿã€‚æ€ä¹ˆç†è§£è¿™ä¸ªæ•°æ®å±‚ï¼Ÿä½ å¯ä»¥æŠŠå®ƒç±»æ¯”ä¸ºæœåŠ¡ç«¯çš„æ•°æ®åº“ã€‚å®ƒæ˜¯ä¸€ä¸ªå­˜å‚¨ä¸­é—´ä»¶ï¼Œè´Ÿè´£æ‰˜ç®¡æ‰€æœ‰çš„æ•°æ®ã€‚</p><p>ä¸­è‚¯åœ°è¯´ï¼Œæ•°æ®å±‚çš„å¼•å…¥æœ‰å¥½æœ‰åã€‚</p><p>å¥½å¤„ä¸å¿…å¤šè¨€ï¼Œæœ‰äº†æ•°æ®å±‚ï¼Œæ‰€æœ‰å¼‚æ­¥æ“ä½œä¸æ˜¯é—®é¢˜ï¼ŒUndo/Redo ä¸æ˜¯é—®é¢˜ï¼Œä¹Ÿè¿˜æœ‰æ›´å¤šæƒ³è±¡ç©ºé—´ã€‚</p><p>ä¸å¥½çš„åœ°æ–¹æ˜¯ï¼Œå®ƒæ˜¯ Model å±‚çš„åŸºç¡€ï¼Œå¯¹æˆ‘ä»¬å®ç° Model å±‚çš„ä¸šåŠ¡é€»è¾‘æ˜¯æœ‰ä¾µå…¥çš„ã€‚åŸºäºå†…å­˜æ•°æ®ç»“æ„å†™ç¨‹åºï¼Œå’ŒåŸºäºæ•°æ®åº“å†™ç¨‹åºï¼Œä½“éªŒä¸Šä¼šæœ‰å¾ˆå¤§çš„å·®å¼‚ã€‚ä»é¿å…ç»‘å®šçš„è§’åº¦ï¼Œæˆ‘ä»¬ä¼šå°½å¯èƒ½å°†è¿™ç§å·®å¼‚éšè—èµ·æ¥ï¼ŒæŠŠåŸºäºæ•°æ®å±‚ä¸ä¸åŸºäºæ•°æ®å±‚çš„å·®å¼‚æ¶ˆé™¤ã€‚</p><p>å½“ç„¶ï¼Œéšç€ä»Šå¤©è½¯ä»¶æœåŠ¡åŒ–ï¼ˆSaaSï¼‰å¤§è¡Œå…¶é“ï¼ŒåŸºäºæŸç§å­˜å‚¨ä¸­é—´ä»¶æ¥å†™ä¸šåŠ¡é€»è¾‘ï¼Œè¶Šæ¥è¶Šå¤šäººæ„è¯†åˆ°å®ƒå·²ç»æ˜¯ä¸€ç§å¿…ç„¶çš„è¶‹åŠ¿ã€‚</p><p>å›é¡¾æˆ‘ä»¬è§£å†³ Undo/Redo çš„æ€è·¯ï¼Œä½ ä¼šå‘ç°ï¼Œå®ƒå¹¶ä¸æ˜¯åœ¨é—®é¢˜å‘ç”Ÿçš„åœ°æ–¹è§£å†³ã€‚è¿™ä¹Ÿæ˜¯éœ€æ±‚åˆ†æçš„å¤æ‚æ€§æ‰€åœ¨ã€‚</p><h2>å®å½•åˆ¶åŠŸèƒ½</h2><p>æˆ‘ä»¬å†çœ‹ â€œå®å½•åˆ¶â€ åŠŸèƒ½ã€‚è¿™ä¸ªåŠŸèƒ½ä½¿ç”¨çš„äººåº”è¯¥ä¸å¤ªå¤šï¼Œä¸å°‘äººç”šè‡³å¯èƒ½å¹¶ä¸çŸ¥é“å®ƒçš„å­˜åœ¨ã€‚è¦ç†è§£ â€œå®å½•åˆ¶â€ï¼Œé¦–å…ˆéœ€è¦çŸ¥é“ä»€ä¹ˆæ˜¯å®ï¼ˆMacroï¼‰ã€‚</p><p>ç®€å•æ¥è¯´ï¼Œæ‰€è°“å®ï¼ˆMacroï¼‰ï¼Œæ˜¯æŒ‡äºŒæ¬¡å¼€å‘çš„ä»£ç ã€‚å¾®è½¯å‡ ä¹æ‰€æœ‰çš„äº§å“éƒ½æœ‰äºŒæ¬¡å¼€å‘æ¥å£ï¼Œä¹Ÿå°±æ˜¯ API å±‚ï¼Œå…¸å‹ä»£è¡¨æ˜¯ Office å’Œ Visual Studioã€‚</p><p>æœ‰äº†äºŒæ¬¡å¼€å‘æ¥å£ï¼Œå°±å¯ä»¥æœ‰ç”Ÿæ€ï¼Œæœ‰å›´ç»•ç€ Office å’Œ Visual Studio çš„ç”Ÿæ€å‚å•†ï¼Œæ¥å¢å¼ºäº§å“çš„èƒ½åŠ›ï¼Œä¹Ÿå¯ä»¥è®© Office å’Œ Visual Studio æ›´å®¹æ˜“åœ°èå…¥åˆ°ä¼ä¸šçš„ä¸šåŠ¡æµä¸­ã€‚å¯ä»¥è¯´ï¼Œæ”¯æŒå®æ˜¯å¾®è½¯åšå¾—æœ€ç‰›çš„åœ°æ–¹ã€‚</p><p>é‚£ä¹ˆä»€ä¹ˆæ˜¯ â€œå®å½•åˆ¶â€ï¼Ÿç®€å•è¯´ï¼Œå°±æ˜¯æŠŠç”¨æˆ·çš„ç•Œé¢æ“ä½œç”¨ API è°ƒç”¨çš„æ–¹å¼è®°å½•ä¸‹æ¥ï¼ŒæŠŠå®ƒå˜æˆä¸€æ®µäºŒæ¬¡å¼€å‘ä»£ç ã€‚</p><p><img src=\"https://static001.geekbang.org/resource/image/20/15/20d14375107e513b8f0802f710317815.png?wh=403*74\" alt=\"\"></p><p>è¿™æœ‰å‡ ç‚¹å¥½å¤„ã€‚</p><p>å…¶ä¸€ï¼Œè¢«å½•åˆ¶ä¸‹æ¥çš„ â€œå®â€ï¼Œå¯ä»¥è¢«åå¤é‡æ”¾ï¼Œå¦‚æœæŸä»¶äº‹æƒ…ç»å¸¸å‘ç”Ÿï¼Œå®ƒå°±å¯ä»¥æ”¹å–„æˆ‘ä»¬çš„å·¥ä½œæ•ˆç‡ã€‚ä½ ç”šè‡³å¯ä»¥ä¸º â€œå®â€ æŒ‡å®šä¸€ä¸ªå¿«æ·é”®ï¼Œè¿™ç›¸å½“äºä½ ä½œä¸ºç”¨æˆ·ï¼Œç«Ÿç„¶å¯ä»¥ç»™ç³»ç»Ÿæ·»åŠ æ–°åŠŸèƒ½ã€‚</p><p>å…¶äºŒï¼Œè¢«å½•åˆ¶ä¸‹æ¥çš„ â€œå®â€ï¼Œå¯ä»¥è¿›è¡Œä¿®æ”¹è¿­ä»£ï¼Œè¿›è¡ŒåŠŸèƒ½çš„å¢å¼ºã€‚è¿™æœ‰åŠ©äºäºŒæ¬¡å¼€å‘çš„æ–°æ‰‹å­¦ä¹  Office æˆ– Visual Studio çš„ API æ¥å£ï¼Œå¤§å¹…é™ä½äºŒæ¬¡å¼€å‘çš„å…¥é—¨éš¾åº¦ã€‚</p><p>é‚£ä¹ˆæ€ä¹ˆæ”¯æŒ â€œå®å½•åˆ¶â€ï¼Ÿè¿™ä¸ªåŠŸèƒ½å’Œå®ƒæ¯”è¾ƒåƒçš„æ˜¯æœåŠ¡ç«¯çš„æ—¥å¿—ï¼Œåªæ˜¯ç•¥æœ‰ä¸åŒã€‚</p><p>æ¯”è¾ƒåƒçš„åœ°æ–¹æ˜¯ï¼Œå®å½•åˆ¶ä¹Ÿåƒæ—¥å¿—ä¸€æ ·ï¼Œä¼šå»è®°å½•ä¸€æ®µæ–‡æœ¬ã€‚æˆ‘ä»¬æƒ³è±¡ä¸€ä¸‹ï¼Œå¦‚æœæˆ‘ä»¬çš„ Model å±‚ DOM API ä¹ŸåŸºäº RESTful API æ¥å£ï¼Œé‚£ä¹ˆæˆ‘ä»¬å°±å¯ä»¥åœ¨ API å…¥å£çš„åœ°æ–¹å»å®ç° â€œå®å½•åˆ¶â€ã€‚</p><p>ä¸åŒçš„åœ°æ–¹æ˜¯ï¼Œâ€œå®å½•åˆ¶â€ éœ€è¦è€ƒè™‘ API åµŒå¥—ï¼Œæˆ‘ä»¬å®ç°æŸä¸ª API å¯èƒ½ä¼šè°ƒç”¨å¦å¤–æŸä¸ª APIï¼Œä½†æ˜¯å½•åˆ¶çš„æ—¶å€™ï¼Œè‚¯å®šåªèƒ½å½•æœ€å¤–å±‚çš„ APIï¼Œè€Œä¸æ˜¯æ‰€æœ‰ API è°ƒç”¨éƒ½è¢«å½•åˆ¶ä¸‹æ¥ã€‚</p><p>è¿™äº›éƒ½æ¯”è¾ƒå¥½è§£å†³ã€‚æ‰€ä»¥ â€œå®å½•åˆ¶â€ ç›¸æ¯”å‰é¢çš„ â€œå­˜ç›˜/è¯»ç›˜â€ã€â€œUndo/Redoâ€ è€Œè¨€ï¼Œæ˜¯ä¸€ä¸ªä¾µç•¥æ€§ç›¸å¯¹å°çš„åŠŸèƒ½ï¼Œå¿ƒæ™ºè´Ÿæ‹…æ¯”è¾ƒä½ã€‚</p><h2>æ¶æ„å¸ˆçš„ä¿¡ä»°</h2><p>é€šè¿‡è¿™äº›ä¾‹å­ï¼Œæˆ‘ä»¬éœ€è¦åšå®šçš„ä¸€ä¸ªä¿¡å¿µæ˜¯ï¼Œä»»ä½•åŠŸèƒ½éƒ½æ˜¯å¯ä»¥æ­£äº¤åˆ†è§£çš„ï¼Œå³ä½¿æˆ‘ç›®å‰è¿˜æ²¡æœ‰æ‰¾åˆ°æ–¹æ³•ï¼Œé‚£ä¹Ÿæ˜¯å› ä¸ºæˆ‘è¿˜æ²¡æœ‰é€å½»ç†è§£éœ€æ±‚ã€‚</p><p>è¿™æ˜¯æ¶æ„å¸ˆçš„ä¿¡ä»°ã€‚</p><p>æ¢å¥è¯è¯´ï¼Œæ€ä¹ˆåšä¸šåŠ¡åˆ†è§£ï¼Ÿä¸šåŠ¡åˆ†è§£å°±æ˜¯æœ€å°åŒ–çš„æ ¸å¿ƒç³»ç»Ÿï¼ŒåŠ ä¸Šå¤šä¸ªæ­£äº¤åˆ†è§£çš„å‘¨è¾¹ç³»ç»Ÿã€‚æ ¸å¿ƒç³»ç»Ÿä¸€å®šè¦æœ€å°åŒ–ï¼Œè¦ç¨³å®šã€‚åšæŒä¸è¦å¾€æ ¸å¿ƒç³»ç»Ÿä¸­å¢åŠ æ–°åŠŸèƒ½ï¼Œè¿™æ ·ä½ çš„ä¸šåŠ¡æ¶æ„å°±ä¸å¯èƒ½æœ‰è‡­å‘³ã€‚</p><p>è¿™æ˜¯æˆ‘ä»¬çš„ä¿¡ä»°ã€‚é‡è¦çš„è¯è¦è¯´ä¸‰éã€‚</p><p>åœ¨æ¨¡å—æ¼”åŒ–çš„è¿‡ç¨‹ä¸­ï¼Œéšç€åŠŸèƒ½çš„å¢åŠ ï¼Œå¤æ‚æ¨¡å—çš„æ¼”åŒ–å¯èƒ½ä¼šç»å†å‰§çƒˆçš„è°ƒæ•´æœŸã€‚é€šå¸¸è¿™ç§å‰§çƒˆè°ƒæ•´èµ·æºäºéœ€æ±‚ç†è§£çš„è¿›ä¸€æ­¥æ·±åŒ–ï¼Œå¼•å‘å¯¹åŸæ¨¡å—æ¥å£çš„åæ€ã€‚æ— è®ºå¦‚ä½•ï¼Œè®°ä½æœ€é‡è¦çš„ä¸€ç‚¹ï¼šä¿æŒæ ¸å¿ƒç³»ç»Ÿçš„çº¯æ´æ€§æ¯”ä»€ä¹ˆéƒ½é‡è¦ã€‚</p><h2>ç»“è¯­</h2><p>æ¶æ„åˆ†è§£ä¸­æœ‰ä¸¤å¤§éš¾é¢˜ã€‚</p><p>å…¶ä¸€ï¼Œéœ€æ±‚çš„äº¤ç»‡ã€‚ä¸åŒéœ€æ±‚æ··æ‚åœ¨ä¸€èµ·ï¼Œä¹Ÿå°±æ˜¯æˆ‘ä»¬ä»Šå¤©è¯´çš„å…¨å±€æ€§åŠŸèƒ½ã€‚å…¶äºŒï¼Œéœ€æ±‚çš„æ˜“å˜ã€‚ä¸åŒå®¢æˆ·ï¼Œä¸åŒåœºæ™¯ä¸‹éœ€æ±‚çœ‹èµ·æ¥å¾ˆä¸ä¸€æ ·ï¼Œåœºæ™¯å‘ˆå‘æ•£è¶‹åŠ¿ã€‚</p><p>ä½†æ— è®ºå¦‚ä½•ï¼Œæˆ‘ä»¬éœ€è¦åšæŒä½œä¸ºä¸€åæ¶æ„å¸ˆçš„ä¿¡ä»°ï¼š</p><blockquote>\n<p>ä»»ä½•åŠŸèƒ½éƒ½æ˜¯å¯ä»¥æ­£äº¤åˆ†è§£çš„ï¼Œå³ä½¿æˆ‘ç›®å‰è¿˜æ²¡æœ‰æ‰¾åˆ°æ–¹æ³•ã€‚</p>\n</blockquote><p>å¦‚æœä½ å¯¹ä»Šå¤©çš„å†…å®¹æœ‰ä»€ä¹ˆæ€è€ƒä¸è§£è¯»ï¼Œæ¬¢è¿ç»™æˆ‘ç•™è¨€ï¼Œæˆ‘ä»¬ä¸€èµ·è®¨è®ºã€‚ä¸‹ä¸€è®²æˆ‘ä»¬çš„è¯é¢˜æ˜¯å¤§å®¶å¾ˆç†Ÿæ‚‰çš„ â€œå¼€é—­åŸåˆ™ï¼ˆOpen Closed Principleï¼ŒOCPï¼‰â€ã€‚</p><p>å¦‚æœä½ è§‰å¾—æœ‰æ‰€æ”¶è·ï¼Œä¹Ÿæ¬¢è¿æŠŠæ–‡ç« åˆ†äº«ç»™ä½ çš„æœ‹å‹ã€‚æ„Ÿè°¢ä½ çš„æ”¶å¬ï¼Œæˆ‘ä»¬ä¸‹æœŸå†è§ã€‚</p>","neighbors":{"left":{"article_title":"åŠ é¤ | å®æˆ˜ï¼šâ€œç”»å›¾ç¨‹åºâ€ çš„æ•´ä½“æ¶æ„","id":172004},"right":{"article_title":"62 |Â é‡æ–°è®¤è¯†å¼€é—­åŸåˆ™ (OCP)","id":175236}},"comments":[{"had_liked":false,"id":159808,"user_name":"tt","can_delete":false,"product_type":"c1","uid":1489957,"ip_address":"","ucode":"7753B79AD5A9AC","user_header":"https://static001.geekbang.org/account/avatar/00/16/bc/25/1c92a90c.jpg","comment_is_top":false,"comment_ctime":1575795591,"is_pvip":false,"replies":[{"id":"61045","content":"è¯´å¾—å¾ˆèµğŸ‘","user_name":"ä½œè€…å›å¤","user_name_real":"è®¸å¼ä¼Ÿ-ä¸ƒç‰›äº‘(å·²æ»¡)","uid":"1228022","ctime":1575845153,"ip_address":"","comment_id":159808,"utype":1}],"discussion_count":1,"race_medal":0,"score":"104655010695","product_id":100025201,"comment_content":"â€œä¸šåŠ¡åˆ†è§£å°±æ˜¯æœ€å°åŒ–çš„æ ¸å¿ƒç³»ç»Ÿï¼ŒåŠ ä¸Šå¤šä¸ªæ­£äº¤åˆ†è§£çš„å‘¨è¾¹ç³»ç»Ÿã€‚æ ¸å¿ƒç³»ç»Ÿä¸€å®šè¦æœ€å°åŒ–ï¼Œè¦ç¨³å®šã€‚åšæŒä¸è¦å¾€æ ¸å¿ƒç³»ç»Ÿä¸­å¢åŠ æ–°åŠŸèƒ½ï¼Œè¿™æ ·ä½ çš„ä¸šåŠ¡æ¶æ„å°±ä¸å¯èƒ½æœ‰è‡­å‘³ã€‚â€<br><br>æˆ‘è§‰å¾—è¿™å¥è¯å°±æ˜¯ä¸‹èŠ‚è¯¾çš„å¼•å­ï¼Œæ ¸å¿ƒæ˜¯æœ€å°åŒ–çš„ï¼Œå°±å¯ä»¥å®¹æ˜“åšåˆ°å¯¹ä¿®æ”¹å°é—­ï¼Œå› ä¸ºå®ƒæ˜¯ä¸šåŠ¡çš„æœ¬è´¨ï¼Œé™¤éä¸šåŠ¡å˜äº†ï¼Œæˆ–è€…æ˜¯æˆ‘ä»¬æ²¡æœ‰å½»åº•ç†è§£ä¸šåŠ¡ï¼Œå¦åˆ™å®ƒä¸ä¼šå‰§çƒˆå˜åŒ–ã€‚<br><br>å¤šä¸ªæ­£äº¤åˆ†è§£çš„å‘¨è¾¹ç³»ç»Ÿï¼Œæ‰€ä»¥å¯ä»¥å®¹æ˜“çš„æ‰©å±•ï¼Œå› ä¸ºäº’ç›¸ä¸è€¦åˆï¼Œè€Œåªæ˜¯ä¾èµ–æ ¸å¿ƒã€‚<br><br>æ ¸å¿ƒå°±æ˜¯åæ ‡ç³»åŸç‚¹ï¼Œå®šä½äº†ä¸€ä¸ªä¸šåŠ¡ï¼Œå‘¨è¾¹å°±æ˜¯å„ä¸ªè±¡é™ï¼Œæ‰©å……äº†æ•´ä¸ªç³»ç»Ÿã€‚","like_count":25,"discussions":[{"author":{"id":1228022,"avatar":"https://static001.geekbang.org/account/avatar/00/12/bc/f6/e61d4b8f.jpg","nickname":"è®¸å¼ä¼Ÿ-ä¸ƒç‰›äº‘(å·²æ»¡)","note":"","ucode":"1A2F8AA6F6DB54","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":477180,"discussion_content":"è¯´å¾—å¾ˆèµğŸ‘","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1575845153,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":158175,"user_name":"leslie","can_delete":false,"product_type":"c1","uid":1324255,"ip_address":"","ucode":"798E7C1CC98CC2","user_header":"https://static001.geekbang.org/account/avatar/00/14/34/df/64e3d533.jpg","comment_is_top":false,"comment_ctime":1575342102,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"40230047766","product_id":100025201,"comment_content":"     &quot;ä»»ä½•åŠŸèƒ½éƒ½æ˜¯å¯ä»¥æ­£äº¤åˆ†è§£çš„ï¼Œå¦‚æœæ²¡æœ‰ï¼Œé‚£æ˜¯å› ä¸ºæ²¡æœ‰é€å½»ç†è§£éœ€æ±‚&quot;ã€‚æ•°æ®åº“å¤šå¹´ï¼Œä¸Šæ¬¡å’Œæ± è€å¸ˆè§é¢æ—¶-ä»–æè¿°ä»–çš„äººç”Ÿè½¨è¿¹æ—¶ï¼Œè‡ªå·±å¾—åˆ°äº†ä¸€ä¸ªåæ€-å…¨æ ˆå»çœ‹å¾…æ¢³ç†ï¼Œç„¶åæ¢ä½æ€è€ƒå»æ²Ÿé€šã€‚<br>     å¤§æ¦‚ä¸‡äº‹ä¸‡ç‰©ç¦»ä¸å¼€æ•°æ®ï¼šæ•°æ®éƒ¨é—¨æœ‰æ—¶åè€Œæˆäº†ä¸­é—´ç‚¹ã€‚ç«™åœ¨ä¸­é—´ç‚¹çš„è§’åº¦å’Œäº§å“ã€é”€å”®ã€å¼€å‘ã€è¿ç»´ä¹‹é—´åšäº†ä¸å°‘éœ€æ±‚çš„åè°ƒå’Œæ¢³ç†ï¼Œåœ¨ä¸æ–­çš„æ¢ä½æ€è€ƒä¸­èƒ½ç†è§£å¯èƒ½çš„é—®é¢˜ï¼Œè¿™å¤§æ¦‚æ˜¯æœ€éš¾çš„äº‹æƒ…ï¼Œä¸æ–­çš„æ²Ÿé€šå»æ¢³ç†æ¢ç´¢å½“å‰çœŸæ­£çš„æ ¸å¿ƒç„¶åæ‰èƒ½æŠŠæ¡ä½å½“ä¸‹ã€‚<br>      è€å¸ˆçš„è¯¾ç¨‹é¦–å…ˆä»å„ä¸ªæ–¹é¢å»æ¢³ç†äº†å„ä¸ªç‚¹çš„é—®é¢˜ï¼Œåˆä»ä¸šåŠ¡&#47;äº§å“çš„è§’åº¦å»æ€è€ƒäº†ï¼Œæœ€åç«™åœ¨ä¸­é—´çš„åœ°æ–¹å»æ‹èµ·æ¥æ•´ä½“ã€‚æ˜æ˜¾çš„æ„Ÿå—åˆ°è€å¸ˆåœ¨ä¼ é€’ä¸€ç§æ€æƒ³ï¼šå¥½çš„æ¶æ„ä¸€å®šæ˜¯å¯¹æ¶æ„ç›¸å…³çš„éƒ½æ˜ç™½ä¸”é€šè¿‡æ²Ÿé€šå»æ¢³ç†å‡ºçœŸæ­£çš„æ ¸å¿ƒéœ€æ±‚&#47;æ¶æ„ï¼›å°±åƒè®¡ç®—æœºçš„æ ¸å¿ƒæ˜¯CPUï¼Œç„¶åä¸€æ­¥æ­¥æ‰©å±•å‡ºæ•´å°PCã€‚<br>       æ„Ÿè°¢è€å¸ˆçš„æ•™è¯²å’Œä»˜å‡ºï¼šå…¨å±€æ€§çš„æ ¸å¿ƒé¦–å…ˆæ˜¯ä¸æ–­æŠ“ä½æ ¸å¿ƒï¼Œç„¶åæ‰©å±•å‡ºå‘¨è¾¹ï¼Œä¸èƒ½å› ä¸ºå‘¨è¾¹åè€Œç»‘ä½&#47;æŸç¼šäº†æ ¸å¿ƒã€‚æœŸå¾…è€å¸ˆä¸‹èŠ‚è¯¾çš„åˆ†äº«ã€‚","like_count":10},{"had_liked":false,"id":158991,"user_name":"è¯—æ³½","can_delete":false,"product_type":"c1","uid":1031865,"ip_address":"","ucode":"F28BE01C3FD12F","user_header":"https://static001.geekbang.org/account/avatar/00/0f/be/b9/f2481c2c.jpg","comment_is_top":false,"comment_ctime":1575511868,"is_pvip":false,"replies":[{"id":"60826","content":"åœ¨åšè€é¡¹ç›®","user_name":"ä½œè€…å›å¤","user_name_real":"è®¸å¼ä¼Ÿ-ä¸ƒç‰›äº‘(å·²æ»¡)","uid":"1228022","ctime":1575512811,"ip_address":"","comment_id":158991,"utype":1}],"discussion_count":1,"race_medal":0,"score":"23050348348","product_id":100025201,"comment_content":"å½“ä¸€ä¸ªæ–°éœ€æ±‚æ¥äº†æˆ–è€…è¦å¼€å§‹ä¸€ä¸ªæ–°é¡¹ç›®çš„æ—¶å€™æ¶æ„å¸ˆåœ¨åšéœ€æ±‚åˆ†æå’Œæ¶æ„è®¾è®¡çš„æ—¶å€™å…¶ä»–å·¥ç¨‹å¸ˆä»¬åœ¨åšä»€ä¹ˆï¼Ÿ","like_count":6,"discussions":[{"author":{"id":1228022,"avatar":"https://static001.geekbang.org/account/avatar/00/12/bc/f6/e61d4b8f.jpg","nickname":"è®¸å¼ä¼Ÿ-ä¸ƒç‰›äº‘(å·²æ»¡)","note":"","ucode":"1A2F8AA6F6DB54","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":476904,"discussion_content":"åœ¨åšè€é¡¹ç›®","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1575512811,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":158141,"user_name":"Aaron Cheung","can_delete":false,"product_type":"c1","uid":1079816,"ip_address":"","ucode":"03972759C53667","user_header":"https://static001.geekbang.org/account/avatar/00/10/7a/08/4d3e47dd.jpg","comment_is_top":false,"comment_ctime":1575337749,"is_pvip":false,"replies":[{"id":"60586","content":"ğŸ‘","user_name":"ä½œè€…å›å¤","user_name_real":"è®¸å¼ä¼Ÿ-ä¸ƒç‰›äº‘(å·²æ»¡)","uid":"1228022","ctime":1575338849,"ip_address":"","comment_id":158141,"utype":1}],"discussion_count":1,"race_medal":0,"score":"23050174229","product_id":100025201,"comment_content":"ä»»ä½•åŠŸèƒ½éƒ½æ˜¯å¯ä»¥æ­£äº¤åˆ†è§£çš„ï¼Œå³ä½¿æˆ‘ç›®å‰è¿˜æ²¡æœ‰æ‰¾åˆ°æ–¹æ³•ï¼Œé‚£ä¹Ÿæ˜¯å› ä¸ºæˆ‘è¿˜æ²¡æœ‰é€å½»ç†è§£éœ€æ±‚ã€‚<br><br>é†é†çŒé¡¶","like_count":6,"discussions":[{"author":{"id":1228022,"avatar":"https://static001.geekbang.org/account/avatar/00/12/bc/f6/e61d4b8f.jpg","nickname":"è®¸å¼ä¼Ÿ-ä¸ƒç‰›äº‘(å·²æ»¡)","note":"","ucode":"1A2F8AA6F6DB54","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":476641,"discussion_content":"ğŸ‘","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1575338849,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":158665,"user_name":"æ¸…æ­Œ","can_delete":false,"product_type":"c1","uid":1014496,"ip_address":"","ucode":"4545455E12F907","user_header":"https://static001.geekbang.org/account/avatar/00/0f/7a/e0/3d5b28ef.jpg","comment_is_top":false,"comment_ctime":1575429648,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"10165364240","product_id":100025201,"comment_content":"æ ¸å¿ƒåŠŸèƒ½æœ€å°è¯ï¼Œä¿æŒç¨³å®šï¼›å¤–å›´åŠŸèƒ½æ­£äº¤åˆ†è§£ï¼Œè¿™ä¸ªæ€»ç»“å¤ªå‰å®³äº†","like_count":3},{"had_liked":false,"id":171329,"user_name":"Tesla","can_delete":false,"product_type":"c1","uid":1500742,"ip_address":"","ucode":"98629AFD9861EE","user_header":"http://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTKUcSLVV6ia3dibe7qvTu8Vic1PVs2EibxoUdx930MC7j2Q9A6s4eibMDZlcicMFY0D0icd3RrDorMChu0zw/132","comment_is_top":false,"comment_ctime":1578903464,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1578903464","product_id":100025201,"comment_content":"å“¦å“¦ï¼Œæ‰€ä»¥å¢é‡ä¿å­˜ï¼Œæ˜¯åœ¨æ•°æ®ç»“æ„ä¸Šåšäº†ä¼˜åŒ–ã€‚ä»¥å‰æ˜¯å…ˆæ¸…ç©ºåŸæ•°æ®ï¼Œå†å°†æ–°æ•°æ®ä¿å­˜èµ·æ¥ã€‚ç°åœ¨çš„æ•°æ®ç»“æ„å¯ä»¥æ¯æ¬¡åªä¿å­˜å¢é‡ï¼Œç›¸å½“äºä¸€ä¸ªupdateã€‚æ•°æ®ç»“æ„å’Œç®—æ³•å®ç°èµ·æ¥æ›´å¤æ‚ï¼Œä½†æ˜¯è·å¾—äº†æ›´å¥½çš„æ•°æ®ä½“éªŒ","like_count":1},{"had_liked":false,"id":171198,"user_name":"Tesla","can_delete":false,"product_type":"c1","uid":1500742,"ip_address":"","ucode":"98629AFD9861EE","user_header":"http://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTKUcSLVV6ia3dibe7qvTu8Vic1PVs2EibxoUdx930MC7j2Q9A6s4eibMDZlcicMFY0D0icd3RrDorMChu0zw/132","comment_is_top":false,"comment_ctime":1578879594,"is_pvip":false,"replies":[{"id":"66424","content":"ä¸æ˜¯è¿™æ ·çš„ã€‚å®ƒæ˜¯åŸºäºæ•°æ®çš„å¤šç‰ˆæœ¬ã€‚ä»æŸä¸ªç‹¬ç«‹ç‰ˆæœ¬æ¥è¯´æ•°æ®æ˜¯å®Œæ•´çš„ï¼Œä½†æ˜¯ä¸åŒç‰ˆæœ¬å…±äº«äº†å¤§éƒ¨åˆ†çš„æ•°æ®ã€‚","user_name":"ä½œè€…å›å¤","user_name_real":"è®¸å¼ä¼Ÿ-ä¸ƒç‰›äº‘(å·²æ»¡)","uid":"1228022","ctime":1578902584,"ip_address":"","comment_id":171198,"utype":1}],"discussion_count":2,"race_medal":0,"score":"1578879594","product_id":100025201,"comment_content":"è€å¸ˆï¼Œofficeåšå¢é‡ä¿å­˜ æ·»åŠ åˆ°æ–‡æ¡£çš„æœ«å°¾ã€‚æ˜¯æ€ä¹ˆåšå‘¢ï¼Ÿè¦ä¿å­˜ä¸‹æ¯ä¸ªæ“ä½œçš„positionå’Œæ“ä½œç±»å‹å—ï¼Ÿ<br>è¿™æ ·ä¼šåŒæ—¶å­˜åœ¨å¤šä¸ªæ–‡ä»¶ï¼Œè¯»å–æ—¶éœ€è¦åŸºäºç¬¬ä¸€ä¸ªç‰ˆæœ¬æ–‡ä»¶å†åšå¢é‡è®¡ç®—å¾—å‡ºæœ€åä¸€ä¸ªç‰ˆæœ¬ã€‚å¦‚æœä¿å­˜å¾ˆå¤šäº† è®¡ç®—é‡å°±ä¼šå¾ˆå¤§æ¶ˆè€—æ—¶é—´ï¼Œè¦æœ‰ä¸€ä¸ªåˆå¹¶å¤šç‰ˆæœ¬çš„çº¿ç¨‹åœ¨åå°å¼‚æ­¥è¿è¡Œå—ï¼Ÿ","like_count":1,"discussions":[{"author":{"id":1228022,"avatar":"https://static001.geekbang.org/account/avatar/00/12/bc/f6/e61d4b8f.jpg","nickname":"è®¸å¼ä¼Ÿ-ä¸ƒç‰›äº‘(å·²æ»¡)","note":"","ucode":"1A2F8AA6F6DB54","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":481259,"discussion_content":"ä¸æ˜¯è¿™æ ·çš„ã€‚å®ƒæ˜¯åŸºäºæ•°æ®çš„å¤šç‰ˆæœ¬ã€‚ä»æŸä¸ªç‹¬ç«‹ç‰ˆæœ¬æ¥è¯´æ•°æ®æ˜¯å®Œæ•´çš„ï¼Œä½†æ˜¯ä¸åŒç‰ˆæœ¬å…±äº«äº†å¤§éƒ¨åˆ†çš„æ•°æ®ã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1578902584,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1464493,"avatar":"https://static001.geekbang.org/account/avatar/00/16/58/ad/6abb57c4.jpg","nickname":"æœ‰çˆ±æœ‰æ³¢å“¥","note":"","ucode":"DD9A023563151F","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":300776,"discussion_content":"@ä½œè€…  æ¯ä¸ªç‰ˆæœ¬éƒ½è®°å½• å¢é‡å—ï¼Ÿ","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1598261938,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":162132,"user_name":"Tao","can_delete":false,"product_type":"c1","uid":1023008,"ip_address":"","ucode":"45339E42C997F3","user_header":"https://static001.geekbang.org/account/avatar/00/0f/9c/20/37ec7b9b.jpg","comment_is_top":false,"comment_ctime":1576465085,"is_pvip":false,"replies":[{"id":"61715","content":"1ã€åˆ é™¤å¯ä»¥çœ‹ä½œparentçš„itemså±æ€§ä¿®æ”¹ï¼Œä¹Ÿå¯ä»¥çœ‹ä½œè‡ªèº«deletedå±æ€§çš„ä¿®æ”¹ã€‚<br>2ã€localStorage æ¯”è¾ƒé€šç”¨ã€æ˜“ç”¨ï¼ŒindexedDB æ›´åŠ å¼ºå¤§ã€‚","user_name":"ä½œè€…å›å¤","user_name_real":"è®¸å¼ä¼Ÿ-ä¸ƒç‰›äº‘(å·²æ»¡)","uid":"1228022","ctime":1576475250,"ip_address":"","comment_id":162132,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1576465085","product_id":100025201,"comment_content":"è®¸è€å¸ˆä½ å¥½ï¼Œæœ€è¿‘åœ¨åšä¸€ä¸ªå‰ç«¯å›¾æ ‡ç¼–è¾‘çš„ web åº”ç”¨ï¼Œé‡åˆ°äº†undo&#47;redo éœ€æ±‚ï¼Œé¡¹ç›®ä¹‹å‰æ˜¯é’ˆå¯¹éƒ¨åˆ† commander ï¼ˆæ¶‰åŠå¯¹ç”»å¸ƒçš„å¢åˆ ï¼‰ï¼Œå°†æ•´ä¸ªç”»å¸ƒæ•°æ®æ‹·è´ä¸€ä»½å­˜å…¥ï¼Œæ²¡æœ‰æŒä¹…åŒ–åœ¨å†…å­˜ä¸­ï¼Œundo&#47;redo å°†æ•°æ®å–å‡ºæ¥é‡ç»˜ã€‚æ€§èƒ½éå¸¸å·®ï¼Œæ•°æ®é‡ä¸Šå»ä¹‹åï¼Œç›´æ¥å¡æ­»ã€‚ç°åœ¨è¿™éƒ¨åˆ†åœ¨é‡æ„ï¼Œæƒ³è¦å®ç°ä½ æ–‡ä¸­è¡¨è¿°çš„æ ·å­ï¼Œåªæ˜¯å¯¹ä¿®æ”¹çš„éƒ¨åˆ†å­˜å‚¨ï¼Œæˆ‘ä»¬ç”»å¸ƒå…ƒç´ åˆ†ä¸ºèŠ‚ç‚¹ï¼ˆnode) å’Œè¾¹ï¼ˆedges)ï¼Œä¿®æ”¹åªé’ˆå¯¹è¿™ä¸¤ç§ï¼ŒåŒ…æ‹¬ä¿®æ”¹æ ·å¼ã€å¢åŠ è¾¹æˆ–è€…èŠ‚ç‚¹ï¼Œåˆ é™¤è¾¹æˆ–è€…èŠ‚ç‚¹ï¼Œæˆ‘æƒ³è¿™å¢åŠ ä¿®æ”¹æˆ‘ä¼šå°†å¯¹åº”çš„æ•°æ®å­˜ä¸‹(æœ‰å…ƒç´ id)ï¼Œredo&#47;undo çš„æ—¶å€™ï¼Œä¸ base æ•°æ®åˆå¹¶ï¼Œæä¾›ç»™åœºæ™¯ï¼Œä½†æ˜¯åˆ é™¤æ€ä¹ˆå¢é‡ä¿å­˜å‘¢ï¼Ÿ<br>å¦å¤–æ•°æ®ä¿å­˜åˆ°æµè§ˆå™¨çš„ localStrorage å¥½è¿˜æ˜¯ indexedDB ä¸­è¾ƒå¥½å‘¢","like_count":1,"discussions":[{"author":{"id":1228022,"avatar":"https://static001.geekbang.org/account/avatar/00/12/bc/f6/e61d4b8f.jpg","nickname":"è®¸å¼ä¼Ÿ-ä¸ƒç‰›äº‘(å·²æ»¡)","note":"","ucode":"1A2F8AA6F6DB54","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":477961,"discussion_content":"1ã€åˆ é™¤å¯ä»¥çœ‹ä½œparentçš„itemså±æ€§ä¿®æ”¹ï¼Œä¹Ÿå¯ä»¥çœ‹ä½œè‡ªèº«deletedå±æ€§çš„ä¿®æ”¹ã€‚\n2ã€localStorage æ¯”è¾ƒé€šç”¨ã€æ˜“ç”¨ï¼ŒindexedDB æ›´åŠ å¼ºå¤§ã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1576475250,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":160264,"user_name":"å´","can_delete":false,"product_type":"c1","uid":1495840,"ip_address":"","ucode":"4807FB811B2EDC","user_header":"https://static001.geekbang.org/account/avatar/00/16/d3/20/95e71191.jpg","comment_is_top":false,"comment_ctime":1575901061,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1575901061","product_id":100025201,"comment_content":"è€å¤§ï¼Œä¸€èˆ¬æµè§ˆæ—¥å¿—ï¼Œæ“ä½œæ—¥å¿—æ€ä¹ˆè§„åˆ’ï¼Ÿè°¢è°¢","like_count":0},{"had_liked":false,"id":159303,"user_name":"CoderLim","can_delete":false,"product_type":"c1","uid":1029523,"ip_address":"","ucode":"4A856891BE98E5","user_header":"http://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTKY0ibA4DWA9Bf6MuicKhyEt0yDXvAzG21xnOUHNLDwuic2icxpesyeXc1AMboeZEW97e8SuZdzIBefqA/132","comment_is_top":false,"comment_ctime":1575597093,"is_pvip":false,"replies":[{"id":"60907","content":"è¿™å—å’Œå…·ä½“ä¸šåŠ¡ç›¸å…³ï¼Œå…³é”®åšå¥½éœ€æ±‚åˆ†æã€‚","user_name":"ä½œè€…å›å¤","user_name_real":"è®¸å¼ä¼Ÿ-ä¸ƒç‰›äº‘(å·²æ»¡)","uid":"1228022","ctime":1575603536,"ip_address":"","comment_id":159303,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1575597093","product_id":100025201,"comment_content":"è€å¸ˆä¸€ç›´åœ¨å¼ºè°ƒä¸šåŠ¡æ­£äº¤åˆ†è§£ï¼Œä¸ç†è§£ï¼Œèƒ½å¦è¯´ä¸€ä¸‹å¦‚ä½•åš","like_count":0,"discussions":[{"author":{"id":1228022,"avatar":"https://static001.geekbang.org/account/avatar/00/12/bc/f6/e61d4b8f.jpg","nickname":"è®¸å¼ä¼Ÿ-ä¸ƒç‰›äº‘(å·²æ»¡)","note":"","ucode":"1A2F8AA6F6DB54","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":477006,"discussion_content":"è¿™å—å’Œå…·ä½“ä¸šåŠ¡ç›¸å…³ï¼Œå…³é”®åšå¥½éœ€æ±‚åˆ†æã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1575603536,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":158854,"user_name":"Fs","can_delete":false,"product_type":"c1","uid":1083184,"ip_address":"","ucode":"0AD0EFB5544B9A","user_header":"https://static001.geekbang.org/account/avatar/00/10/87/30/4626c8c0.jpg","comment_is_top":false,"comment_ctime":1575465525,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1575465525","product_id":100025201,"comment_content":"æœ‰ç‚¹æŠ½è±¡ï¼Œéœ€è¦æ›´å¤šæ…¢æ…¢å’€åš¼æ¶ˆåŒ–","like_count":0},{"had_liked":false,"id":158736,"user_name":"fenghuo","can_delete":false,"product_type":"c1","uid":1107514,"ip_address":"","ucode":"88A9F5BE0BBAA5","user_header":"https://static001.geekbang.org/account/avatar/00/10/e6/3a/5e8be862.jpg","comment_is_top":false,"comment_ctime":1575444042,"is_pvip":true,"discussion_count":0,"race_medal":0,"score":"1575444042","product_id":100025201,"comment_content":"æ­£åœ¨åå¤é˜…è¯»å½“ä¸­ï¼Œæ­£äº¤åˆ†è§£","like_count":0},{"had_liked":false,"id":158696,"user_name":"Kæˆ˜ç¥","can_delete":false,"product_type":"c1","uid":1139367,"ip_address":"","ucode":"527E6BB26BB766","user_header":"https://static001.geekbang.org/account/avatar/00/11/62/a7/3e6fee86.jpg","comment_is_top":false,"comment_ctime":1575435848,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1575435848","product_id":100025201,"comment_content":"å¤§é“è‡³ç®€ï¼Œ<br>æŠŠäº‹æƒ…åšæ˜ç™½æƒ³æ˜ç™½è¿˜å¾—åƒé”¤ç™¾ç‚¼ï¼Œ<br>è¿˜å¾—æ·±åˆ»æ€è€ƒä¸­åƒé”¤ç™¾ç‚¼åœ°åšæ˜ç™½æƒ³æ˜ç™½ï¼Œ<br>å›å¤´å†çœ‹ï¼Œå¤§é“è‡³ç®€ã€‚<br><br>é¡¿æ‚Ÿã€‚","like_count":0},{"had_liked":false,"id":158180,"user_name":"pines","can_delete":false,"product_type":"c1","uid":1200708,"ip_address":"","ucode":"7B925605B36B4E","user_header":"https://static001.geekbang.org/account/avatar/00/12/52/44/de7f2b98.jpg","comment_is_top":false,"comment_ctime":1575343197,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1575343197","product_id":100025201,"comment_content":"ä»»ä½•åŠŸèƒ½éƒ½æ˜¯å¯ä»¥æ­£äº¤åˆ†è§£çš„ï¼Œå³ä½¿æˆ‘ç›®å‰è¿˜æ²¡æœ‰æ‰¾åˆ°æ–¹æ³•ã€‚","like_count":0},{"had_liked":false,"id":158100,"user_name":"æ¢¦é†’ååˆ†","can_delete":false,"product_type":"c1","uid":1043585,"ip_address":"","ucode":"33830A5A73DDF8","user_header":"https://static001.geekbang.org/account/avatar/00/0f/ec/81/2127e215.jpg","comment_is_top":false,"comment_ctime":1575333103,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1575333103","product_id":100025201,"comment_content":"å¹²è´§æ»¡æ»¡å‘€ï¼","like_count":0}]}