{"id":77427,"title":"27 | ä¸»åº“å‡ºé—®é¢˜äº†ï¼Œä»åº“æ€ä¹ˆåŠï¼Ÿ","content":"<p>åœ¨å‰é¢çš„ç¬¬<a href=\"https://time.geekbang.org/column/article/76446\">24</a>ã€<a href=\"https://time.geekbang.org/column/article/76795\">25</a>å’Œ<a href=\"https://time.geekbang.org/column/article/77083\">26</a>ç¯‡æ–‡ç« ä¸­ï¼Œæˆ‘å’Œä½ ä»‹ç»äº†MySQLä¸»å¤‡å¤åˆ¶çš„åŸºç¡€ç»“æ„ï¼Œä½†è¿™äº›éƒ½æ˜¯ä¸€ä¸»ä¸€å¤‡çš„ç»“æ„ã€‚</p><p>å¤§å¤šæ•°çš„äº’è”ç½‘åº”ç”¨åœºæ™¯éƒ½æ˜¯è¯»å¤šå†™å°‘ï¼Œå› æ­¤ä½ è´Ÿè´£çš„ä¸šåŠ¡ï¼Œåœ¨å‘å±•è¿‡ç¨‹ä¸­å¾ˆå¯èƒ½å…ˆä¼šé‡åˆ°è¯»æ€§èƒ½çš„é—®é¢˜ã€‚è€Œåœ¨æ•°æ®åº“å±‚è§£å†³è¯»æ€§èƒ½é—®é¢˜ï¼Œå°±è¦æ¶‰åŠåˆ°æ¥ä¸‹æ¥ä¸¤ç¯‡æ–‡ç« è¦è®¨è®ºçš„æ¶æ„ï¼šä¸€ä¸»å¤šä»ã€‚</p><p>ä»Šå¤©è¿™ç¯‡æ–‡ç« ï¼Œæˆ‘ä»¬å°±å…ˆèŠèŠä¸€ä¸»å¤šä»çš„åˆ‡æ¢æ­£ç¡®æ€§ã€‚ç„¶åï¼Œæˆ‘ä»¬åœ¨ä¸‹ä¸€ç¯‡æ–‡ç« ä¸­å†èŠèŠè§£å†³ä¸€ä¸»å¤šä»çš„æŸ¥è¯¢é€»è¾‘æ­£ç¡®æ€§çš„æ–¹æ³•ã€‚</p><p>å¦‚å›¾1æ‰€ç¤ºï¼Œå°±æ˜¯ä¸€ä¸ªåŸºæœ¬çš„ä¸€ä¸»å¤šä»ç»“æ„ã€‚</p><p><img src=\"https://static001.geekbang.org/resource/image/aa/79/aadb3b956d1ffc13ac46515a7d619e79.png?wh=1142*856\" alt=\"\"></p><center><span class=\"reference\">å›¾1 ä¸€ä¸»å¤šä»åŸºæœ¬ç»“æ„</span></center><p>å›¾ä¸­ï¼Œè™šçº¿ç®­å¤´è¡¨ç¤ºçš„æ˜¯ä¸»å¤‡å…³ç³»ï¼Œä¹Ÿå°±æ˜¯Aå’ŒAâ€™äº’ä¸ºä¸»å¤‡ï¼Œ ä»åº“Bã€Cã€DæŒ‡å‘çš„æ˜¯ä¸»åº“Aã€‚ä¸€ä¸»å¤šä»çš„è®¾ç½®ï¼Œä¸€èˆ¬ç”¨äºè¯»å†™åˆ†ç¦»ï¼Œä¸»åº“è´Ÿè´£æ‰€æœ‰çš„å†™å…¥å’Œä¸€éƒ¨åˆ†è¯»ï¼Œå…¶ä»–çš„è¯»è¯·æ±‚åˆ™ç”±ä»åº“åˆ†æ‹…ã€‚</p><p>ä»Šå¤©æˆ‘ä»¬è¦è®¨è®ºçš„å°±æ˜¯ï¼Œåœ¨ä¸€ä¸»å¤šä»æ¶æ„ä¸‹ï¼Œä¸»åº“æ•…éšœåçš„ä¸»å¤‡åˆ‡æ¢é—®é¢˜ã€‚</p><p>å¦‚å›¾2æ‰€ç¤ºï¼Œå°±æ˜¯ä¸»åº“å‘ç”Ÿæ•…éšœï¼Œä¸»å¤‡åˆ‡æ¢åçš„ç»“æœã€‚</p><p><img src=\"https://static001.geekbang.org/resource/image/00/53/0014f97423bd75235a9187f492fb2453.png?wh=1142*856\" alt=\"\"></p><center><span class=\"reference\">å›¾2 ä¸€ä¸»å¤šä»åŸºæœ¬ç»“æ„--ä¸»å¤‡åˆ‡æ¢</span></center><p>ç›¸æ¯”äºä¸€ä¸»ä¸€å¤‡çš„åˆ‡æ¢æµç¨‹ï¼Œä¸€ä¸»å¤šä»ç»“æ„åœ¨åˆ‡æ¢å®Œæˆåï¼ŒAâ€™ä¼šæˆä¸ºæ–°çš„ä¸»åº“ï¼Œä»åº“Bã€Cã€Dä¹Ÿè¦æ”¹æ¥åˆ°Aâ€™ã€‚æ­£æ˜¯ç”±äºå¤šäº†ä»åº“Bã€Cã€Dé‡æ–°æŒ‡å‘çš„è¿™ä¸ªè¿‡ç¨‹ï¼Œæ‰€ä»¥ä¸»å¤‡åˆ‡æ¢çš„å¤æ‚æ€§ä¹Ÿç›¸åº”å¢åŠ äº†ã€‚</p><p>æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬å†ä¸€èµ·çœ‹çœ‹ä¸€ä¸ªåˆ‡æ¢ç³»ç»Ÿä¼šæ€ä¹ˆå®Œæˆä¸€ä¸»å¤šä»çš„ä¸»å¤‡åˆ‡æ¢è¿‡ç¨‹ã€‚</p><!-- [[[read_end]]] --><h1>åŸºäºä½ç‚¹çš„ä¸»å¤‡åˆ‡æ¢</h1><p>è¿™é‡Œï¼Œæˆ‘ä»¬éœ€è¦å…ˆæ¥å›é¡¾ä¸€ä¸ªçŸ¥è¯†ç‚¹ã€‚</p><p>å½“æˆ‘ä»¬æŠŠèŠ‚ç‚¹Bè®¾ç½®æˆèŠ‚ç‚¹Aâ€™çš„ä»åº“çš„æ—¶å€™ï¼Œéœ€è¦æ‰§è¡Œä¸€æ¡change masterå‘½ä»¤ï¼š</p><pre><code>CHANGE MASTER TO \nMASTER_HOST=$host_name \nMASTER_PORT=$port \nMASTER_USER=$user_name \nMASTER_PASSWORD=$password \nMASTER_LOG_FILE=$master_log_name \nMASTER_LOG_POS=$master_log_pos  \n</code></pre><p>è¿™æ¡å‘½ä»¤æœ‰è¿™ä¹ˆ6ä¸ªå‚æ•°ï¼š</p><ul>\n<li>MASTER_HOSTã€MASTER_PORTã€MASTER_USERå’ŒMASTER_PASSWORDå››ä¸ªå‚æ•°ï¼Œåˆ†åˆ«ä»£è¡¨äº†ä¸»åº“Aâ€™çš„IPã€ç«¯å£ã€ç”¨æˆ·åå’Œå¯†ç ã€‚</li>\n<li>æœ€åä¸¤ä¸ªå‚æ•°MASTER_LOG_FILEå’ŒMASTER_LOG_POSè¡¨ç¤ºï¼Œè¦ä»ä¸»åº“çš„master_log_nameæ–‡ä»¶çš„master_log_posè¿™ä¸ªä½ç½®çš„æ—¥å¿—ç»§ç»­åŒæ­¥ã€‚è€Œè¿™ä¸ªä½ç½®å°±æ˜¯æˆ‘ä»¬æ‰€è¯´çš„åŒæ­¥ä½ç‚¹ï¼Œä¹Ÿå°±æ˜¯ä¸»åº“å¯¹åº”çš„æ–‡ä»¶åå’Œæ—¥å¿—åç§»é‡ã€‚</li>\n</ul><p>é‚£ä¹ˆï¼Œè¿™é‡Œå°±æœ‰ä¸€ä¸ªé—®é¢˜äº†ï¼ŒèŠ‚ç‚¹Bè¦è®¾ç½®æˆAâ€™çš„ä»åº“ï¼Œå°±è¦æ‰§è¡Œchange masterå‘½ä»¤ï¼Œå°±ä¸å¯é¿å…åœ°è¦è®¾ç½®ä½ç‚¹çš„è¿™ä¸¤ä¸ªå‚æ•°ï¼Œä½†æ˜¯è¿™ä¸¤ä¸ªå‚æ•°åˆ°åº•åº”è¯¥æ€ä¹ˆè®¾ç½®å‘¢ï¼Ÿ</p><p>åŸæ¥èŠ‚ç‚¹Bæ˜¯Açš„ä»åº“ï¼Œæœ¬åœ°è®°å½•çš„ä¹Ÿæ˜¯Açš„ä½ç‚¹ã€‚ä½†æ˜¯ç›¸åŒçš„æ—¥å¿—ï¼ŒAçš„ä½ç‚¹å’ŒAâ€™çš„ä½ç‚¹æ˜¯ä¸åŒçš„ã€‚å› æ­¤ï¼Œä»åº“Bè¦åˆ‡æ¢çš„æ—¶å€™ï¼Œå°±éœ€è¦å…ˆç»è¿‡â€œæ‰¾åŒæ­¥ä½ç‚¹â€è¿™ä¸ªé€»è¾‘ã€‚</p><p>è¿™ä¸ªä½ç‚¹å¾ˆéš¾ç²¾ç¡®å–åˆ°ï¼Œåªèƒ½å–ä¸€ä¸ªå¤§æ¦‚ä½ç½®ã€‚ä¸ºä»€ä¹ˆè¿™ä¹ˆè¯´å‘¢ï¼Ÿ</p><p>æˆ‘æ¥å’Œä½ åˆ†æä¸€ä¸‹çœ‹çœ‹è¿™ä¸ªä½ç‚¹ä¸€èˆ¬æ˜¯æ€ä¹ˆè·å–åˆ°çš„ï¼Œä½ å°±æ¸…æ¥šå…¶ä¸­ä¸ç²¾ç¡®çš„åŸå› äº†ã€‚</p><p>è€ƒè™‘åˆ°åˆ‡æ¢è¿‡ç¨‹ä¸­ä¸èƒ½ä¸¢æ•°æ®ï¼Œæ‰€ä»¥æˆ‘ä»¬æ‰¾ä½ç‚¹çš„æ—¶å€™ï¼Œæ€»æ˜¯è¦æ‰¾ä¸€ä¸ªâ€œç¨å¾®å¾€å‰â€çš„ï¼Œç„¶åå†é€šè¿‡åˆ¤æ–­è·³è¿‡é‚£äº›åœ¨ä»åº“Bä¸Šå·²ç»æ‰§è¡Œè¿‡çš„äº‹åŠ¡ã€‚</p><p>ä¸€ç§å–åŒæ­¥ä½ç‚¹çš„æ–¹æ³•æ˜¯è¿™æ ·çš„ï¼š</p><ol>\n<li>\n<p>ç­‰å¾…æ–°ä¸»åº“Aâ€™æŠŠä¸­è½¬æ—¥å¿—ï¼ˆrelay logï¼‰å…¨éƒ¨åŒæ­¥å®Œæˆï¼›</p>\n</li>\n<li>\n<p>åœ¨Aâ€™ä¸Šæ‰§è¡Œshow master statuså‘½ä»¤ï¼Œå¾—åˆ°å½“å‰Aâ€™ä¸Šæœ€æ–°çš„File å’Œ Positionï¼›</p>\n</li>\n<li>\n<p>å–åŸä¸»åº“Aæ•…éšœçš„æ—¶åˆ»Tï¼›</p>\n</li>\n<li>\n<p>ç”¨mysqlbinlogå·¥å…·è§£æAâ€™çš„Fileï¼Œå¾—åˆ°Tæ—¶åˆ»çš„ä½ç‚¹ã€‚</p>\n</li>\n</ol><pre><code>mysqlbinlog File --stop-datetime=T --start-datetime=T\n</code></pre><p><img src=\"https://static001.geekbang.org/resource/image/34/dd/3471dfe4aebcccfaec0523a08cdd0ddd.png?wh=1574*141\" alt=\"\"></p><center><span class=\"reference\">å›¾3 mysqlbinlog éƒ¨åˆ†è¾“å‡ºç»“æœ</span></center><p>å›¾ä¸­ï¼Œend_log_posåé¢çš„å€¼â€œ123â€ï¼Œè¡¨ç¤ºçš„å°±æ˜¯Aâ€™è¿™ä¸ªå®ä¾‹ï¼Œåœ¨Tæ—¶åˆ»å†™å…¥æ–°çš„binlogçš„ä½ç½®ã€‚ç„¶åï¼Œæˆ‘ä»¬å°±å¯ä»¥æŠŠ123è¿™ä¸ªå€¼ä½œä¸º$master_log_pos ï¼Œç”¨åœ¨èŠ‚ç‚¹Bçš„change masterå‘½ä»¤é‡Œã€‚</p><p>å½“ç„¶è¿™ä¸ªå€¼å¹¶ä¸ç²¾ç¡®ã€‚ä¸ºä»€ä¹ˆå‘¢ï¼Ÿ</p><p>ä½ å¯ä»¥è®¾æƒ³æœ‰è¿™ä¹ˆä¸€ç§æƒ…å†µï¼Œå‡è®¾åœ¨Tè¿™ä¸ªæ—¶åˆ»ï¼Œä¸»åº“Aå·²ç»æ‰§è¡Œå®Œæˆäº†ä¸€ä¸ªinsert è¯­å¥æ’å…¥äº†ä¸€è¡Œæ•°æ®Rï¼Œå¹¶ä¸”å·²ç»å°†binlogä¼ ç»™äº†Aâ€™å’ŒBï¼Œç„¶ååœ¨ä¼ å®Œçš„ç¬é—´ä¸»åº“Açš„ä¸»æœºå°±æ‰ç”µäº†ã€‚</p><p>é‚£ä¹ˆï¼Œè¿™æ—¶å€™ç³»ç»Ÿçš„çŠ¶æ€æ˜¯è¿™æ ·çš„ï¼š</p><ol>\n<li>\n<p>åœ¨ä»åº“Bä¸Šï¼Œç”±äºåŒæ­¥äº†binlogï¼Œ Rè¿™ä¸€è¡Œå·²ç»å­˜åœ¨ï¼›</p>\n</li>\n<li>\n<p>åœ¨æ–°ä¸»åº“Aâ€™ä¸Šï¼Œ Rè¿™ä¸€è¡Œä¹Ÿå·²ç»å­˜åœ¨ï¼Œæ—¥å¿—æ˜¯å†™åœ¨123è¿™ä¸ªä½ç½®ä¹‹åçš„ï¼›</p>\n</li>\n<li>\n<p>æˆ‘ä»¬åœ¨ä»åº“Bä¸Šæ‰§è¡Œchange masterå‘½ä»¤ï¼ŒæŒ‡å‘Aâ€™çš„Fileæ–‡ä»¶çš„123ä½ç½®ï¼Œå°±ä¼šæŠŠæ’å…¥Rè¿™ä¸€è¡Œæ•°æ®çš„binlogåˆåŒæ­¥åˆ°ä»åº“Bå»æ‰§è¡Œã€‚</p>\n</li>\n</ol><p>è¿™æ—¶å€™ï¼Œä»åº“Bçš„åŒæ­¥çº¿ç¨‹å°±ä¼šæŠ¥å‘Š Duplicate entry â€˜id_of_Râ€™ for key â€˜PRIMARYâ€™ é”™è¯¯ï¼Œæç¤ºå‡ºç°äº†ä¸»é”®å†²çªï¼Œç„¶ååœæ­¢åŒæ­¥ã€‚</p><p>æ‰€ä»¥ï¼Œ<strong>é€šå¸¸æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬åœ¨åˆ‡æ¢ä»»åŠ¡çš„æ—¶å€™ï¼Œè¦å…ˆä¸»åŠ¨è·³è¿‡è¿™äº›é”™è¯¯ï¼Œæœ‰ä¸¤ç§å¸¸ç”¨çš„æ–¹æ³•ã€‚</strong></p><p><strong>ä¸€ç§åšæ³•æ˜¯</strong>ï¼Œä¸»åŠ¨è·³è¿‡ä¸€ä¸ªäº‹åŠ¡ã€‚è·³è¿‡å‘½ä»¤çš„å†™æ³•æ˜¯ï¼š</p><pre><code>set global sql_slave_skip_counter=1;\nstart slave;\n</code></pre><p>å› ä¸ºåˆ‡æ¢è¿‡ç¨‹ä¸­ï¼Œå¯èƒ½ä¼šä¸æ­¢é‡å¤æ‰§è¡Œä¸€ä¸ªäº‹åŠ¡ï¼Œæ‰€ä»¥æˆ‘ä»¬éœ€è¦åœ¨ä»åº“Båˆšå¼€å§‹æ¥åˆ°æ–°ä¸»åº“Aâ€™æ—¶ï¼ŒæŒç»­è§‚å¯Ÿï¼Œæ¯æ¬¡ç¢°åˆ°è¿™äº›é”™è¯¯å°±åœä¸‹æ¥ï¼Œæ‰§è¡Œä¸€æ¬¡è·³è¿‡å‘½ä»¤ï¼Œç›´åˆ°ä¸å†å‡ºç°åœä¸‹æ¥çš„æƒ…å†µï¼Œä»¥æ­¤æ¥è·³è¿‡å¯èƒ½æ¶‰åŠçš„æ‰€æœ‰äº‹åŠ¡ã€‚</p><p><strong>å¦å¤–ä¸€ç§æ–¹å¼æ˜¯ï¼Œ</strong>é€šè¿‡è®¾ç½®slave_skip_errorså‚æ•°ï¼Œç›´æ¥è®¾ç½®è·³è¿‡æŒ‡å®šçš„é”™è¯¯ã€‚</p><p>åœ¨æ‰§è¡Œä¸»å¤‡åˆ‡æ¢æ—¶ï¼Œæœ‰è¿™ä¹ˆä¸¤ç±»é”™è¯¯ï¼Œæ˜¯ç»å¸¸ä¼šé‡åˆ°çš„ï¼š</p><ul>\n<li>1062é”™è¯¯æ˜¯æ’å…¥æ•°æ®æ—¶å”¯ä¸€é”®å†²çªï¼›</li>\n<li>1032é”™è¯¯æ˜¯åˆ é™¤æ•°æ®æ—¶æ‰¾ä¸åˆ°è¡Œã€‚</li>\n</ul><p>å› æ­¤ï¼Œæˆ‘ä»¬å¯ä»¥æŠŠslave_skip_errors è®¾ç½®ä¸º â€œ1032,1062â€ï¼Œè¿™æ ·ä¸­é—´ç¢°åˆ°è¿™ä¸¤ä¸ªé”™è¯¯æ—¶å°±ç›´æ¥è·³è¿‡ã€‚</p><p>è¿™é‡Œéœ€è¦æ³¨æ„çš„æ˜¯ï¼Œè¿™ç§ç›´æ¥è·³è¿‡æŒ‡å®šé”™è¯¯çš„æ–¹æ³•ï¼Œé’ˆå¯¹çš„æ˜¯ä¸»å¤‡åˆ‡æ¢æ—¶ï¼Œç”±äºæ‰¾ä¸åˆ°ç²¾ç¡®çš„åŒæ­¥ä½ç‚¹ï¼Œæ‰€ä»¥åªèƒ½é‡‡ç”¨è¿™ç§æ–¹æ³•æ¥åˆ›å»ºä»åº“å’Œæ–°ä¸»åº“çš„ä¸»å¤‡å…³ç³»ã€‚</p><p>è¿™ä¸ªèƒŒæ™¯æ˜¯ï¼Œæˆ‘ä»¬å¾ˆæ¸…æ¥šåœ¨ä¸»å¤‡åˆ‡æ¢è¿‡ç¨‹ä¸­ï¼Œç›´æ¥è·³è¿‡1032å’Œ1062è¿™ä¸¤ç±»é”™è¯¯æ˜¯æ— æŸçš„ï¼Œæ‰€ä»¥æ‰å¯ä»¥è¿™ä¹ˆè®¾ç½®slave_skip_errorså‚æ•°ã€‚ç­‰åˆ°ä¸»å¤‡é—´çš„åŒæ­¥å…³ç³»å»ºç«‹å®Œæˆï¼Œå¹¶ç¨³å®šæ‰§è¡Œä¸€æ®µæ—¶é—´ä¹‹åï¼Œæˆ‘ä»¬è¿˜éœ€è¦æŠŠè¿™ä¸ªå‚æ•°è®¾ç½®ä¸ºç©ºï¼Œä»¥å…ä¹‹åçœŸçš„å‡ºç°äº†ä¸»ä»æ•°æ®ä¸ä¸€è‡´ï¼Œä¹Ÿè·³è¿‡äº†ã€‚</p><h1>GTID</h1><p>é€šè¿‡sql_slave_skip_counterè·³è¿‡äº‹åŠ¡å’Œé€šè¿‡slave_skip_errorså¿½ç•¥é”™è¯¯çš„æ–¹æ³•ï¼Œè™½ç„¶éƒ½æœ€ç»ˆå¯ä»¥å»ºç«‹ä»åº“Bå’Œæ–°ä¸»åº“Aâ€™çš„ä¸»å¤‡å…³ç³»ï¼Œä½†è¿™ä¸¤ç§æ“ä½œéƒ½å¾ˆå¤æ‚ï¼Œè€Œä¸”å®¹æ˜“å‡ºé”™ã€‚æ‰€ä»¥ï¼ŒMySQL 5.6ç‰ˆæœ¬å¼•å…¥äº†GTIDï¼Œå½»åº•è§£å†³äº†è¿™ä¸ªå›°éš¾ã€‚</p><p>é‚£ä¹ˆï¼ŒGTIDåˆ°åº•æ˜¯ä»€ä¹ˆæ„æ€ï¼Œåˆæ˜¯å¦‚ä½•è§£å†³æ‰¾åŒæ­¥ä½ç‚¹è¿™ä¸ªé—®é¢˜å‘¢ï¼Ÿç°åœ¨ï¼Œæˆ‘å°±å’Œä½ ç®€å•ä»‹ç»ä¸€ä¸‹ã€‚</p><p>GTIDçš„å…¨ç§°æ˜¯Global Transaction Identifierï¼Œä¹Ÿå°±æ˜¯å…¨å±€äº‹åŠ¡IDï¼Œæ˜¯ä¸€ä¸ªäº‹åŠ¡åœ¨æäº¤çš„æ—¶å€™ç”Ÿæˆçš„ï¼Œæ˜¯è¿™ä¸ªäº‹åŠ¡çš„å”¯ä¸€æ ‡è¯†ã€‚å®ƒç”±ä¸¤éƒ¨åˆ†ç»„æˆï¼Œæ ¼å¼æ˜¯ï¼š</p><pre><code>GTID=server_uuid:gno\n</code></pre><p>å…¶ä¸­ï¼š</p><ul>\n<li>server_uuidæ˜¯ä¸€ä¸ªå®ä¾‹ç¬¬ä¸€æ¬¡å¯åŠ¨æ—¶è‡ªåŠ¨ç”Ÿæˆçš„ï¼Œæ˜¯ä¸€ä¸ªå…¨å±€å”¯ä¸€çš„å€¼ï¼›</li>\n<li>gnoæ˜¯ä¸€ä¸ªæ•´æ•°ï¼Œåˆå§‹å€¼æ˜¯1ï¼Œæ¯æ¬¡æäº¤äº‹åŠ¡çš„æ—¶å€™åˆ†é…ç»™è¿™ä¸ªäº‹åŠ¡ï¼Œå¹¶åŠ 1ã€‚</li>\n</ul><p>è¿™é‡Œæˆ‘éœ€è¦å’Œä½ è¯´æ˜ä¸€ä¸‹ï¼Œåœ¨MySQLçš„å®˜æ–¹æ–‡æ¡£é‡Œï¼ŒGTIDæ ¼å¼æ˜¯è¿™ä¹ˆå®šä¹‰çš„ï¼š</p><pre><code>GTID=source_id:transaction_id\n</code></pre><p>è¿™é‡Œçš„source_idå°±æ˜¯server_uuidï¼›è€Œåé¢çš„è¿™ä¸ªtransaction_idï¼Œæˆ‘è§‰å¾—å®¹æ˜“é€ æˆè¯¯å¯¼ï¼Œæ‰€ä»¥æˆ‘æ”¹æˆäº†gnoã€‚ä¸ºä»€ä¹ˆè¯´ä½¿ç”¨transaction_idå®¹æ˜“é€ æˆè¯¯è§£å‘¢ï¼Ÿ</p><p>å› ä¸ºï¼Œåœ¨MySQLé‡Œé¢æˆ‘ä»¬è¯´transaction_idå°±æ˜¯æŒ‡äº‹åŠ¡idï¼Œäº‹åŠ¡idæ˜¯åœ¨äº‹åŠ¡æ‰§è¡Œè¿‡ç¨‹ä¸­åˆ†é…çš„ï¼Œå¦‚æœè¿™ä¸ªäº‹åŠ¡å›æ»šäº†ï¼Œäº‹åŠ¡idä¹Ÿä¼šé€’å¢ï¼Œè€Œgnoæ˜¯åœ¨äº‹åŠ¡æäº¤çš„æ—¶å€™æ‰ä¼šåˆ†é…ã€‚</p><p>ä»æ•ˆæœä¸Šçœ‹ï¼ŒGTIDå¾€å¾€æ˜¯è¿ç»­çš„ï¼Œå› æ­¤æˆ‘ä»¬ç”¨gnoæ¥è¡¨ç¤ºæ›´å®¹æ˜“ç†è§£ã€‚</p><p>GTIDæ¨¡å¼çš„å¯åŠ¨ä¹Ÿå¾ˆç®€å•ï¼Œæˆ‘ä»¬åªéœ€è¦åœ¨å¯åŠ¨ä¸€ä¸ªMySQLå®ä¾‹çš„æ—¶å€™ï¼ŒåŠ ä¸Šå‚æ•°gtid_mode=onå’Œenforce_gtid_consistency=onå°±å¯ä»¥äº†ã€‚</p><p>åœ¨GTIDæ¨¡å¼ä¸‹ï¼Œæ¯ä¸ªäº‹åŠ¡éƒ½ä¼šè·Ÿä¸€ä¸ªGTIDä¸€ä¸€å¯¹åº”ã€‚è¿™ä¸ªGTIDæœ‰ä¸¤ç§ç”Ÿæˆæ–¹å¼ï¼Œè€Œä½¿ç”¨å“ªç§æ–¹å¼å–å†³äºsessionå˜é‡gtid_nextçš„å€¼ã€‚</p><ol>\n<li>\n<p>å¦‚æœgtid_next=automaticï¼Œä»£è¡¨ä½¿ç”¨é»˜è®¤å€¼ã€‚è¿™æ—¶ï¼ŒMySQLå°±ä¼šæŠŠserver_uuid:gnoåˆ†é…ç»™è¿™ä¸ªäº‹åŠ¡ã€‚<br>\na.  è®°å½•binlogçš„æ—¶å€™ï¼Œå…ˆè®°å½•ä¸€è¡Œ SET @@SESSION.GTID_NEXT=â€˜server_uuid:gnoâ€™;<br>\nb.  æŠŠè¿™ä¸ªGTIDåŠ å…¥æœ¬å®ä¾‹çš„GTIDé›†åˆã€‚</p>\n</li>\n<li>\n<p>å¦‚æœgtid_nextæ˜¯ä¸€ä¸ªæŒ‡å®šçš„GTIDçš„å€¼ï¼Œæ¯”å¦‚é€šè¿‡set gtid_next='current_gtidâ€™æŒ‡å®šä¸ºcurrent_gtidï¼Œé‚£ä¹ˆå°±æœ‰ä¸¤ç§å¯èƒ½ï¼š<br>\na.  å¦‚æœcurrent_gtidå·²ç»å­˜åœ¨äºå®ä¾‹çš„GTIDé›†åˆä¸­ï¼Œæ¥ä¸‹æ¥æ‰§è¡Œçš„è¿™ä¸ªäº‹åŠ¡ä¼šç›´æ¥è¢«ç³»ç»Ÿå¿½ç•¥ï¼›<br>\nb.  å¦‚æœcurrent_gtidæ²¡æœ‰å­˜åœ¨äºå®ä¾‹çš„GTIDé›†åˆä¸­ï¼Œå°±å°†è¿™ä¸ªcurrent_gtidåˆ†é…ç»™æ¥ä¸‹æ¥è¦æ‰§è¡Œçš„äº‹åŠ¡ï¼Œä¹Ÿå°±æ˜¯è¯´ç³»ç»Ÿä¸éœ€è¦ç»™è¿™ä¸ªäº‹åŠ¡ç”Ÿæˆæ–°çš„GTIDï¼Œå› æ­¤gnoä¹Ÿä¸ç”¨åŠ 1ã€‚</p>\n</li>\n</ol><p>æ³¨æ„ï¼Œä¸€ä¸ªcurrent_gtidåªèƒ½ç»™ä¸€ä¸ªäº‹åŠ¡ä½¿ç”¨ã€‚è¿™ä¸ªäº‹åŠ¡æäº¤åï¼Œå¦‚æœè¦æ‰§è¡Œä¸‹ä¸€ä¸ªäº‹åŠ¡ï¼Œå°±è¦æ‰§è¡Œset å‘½ä»¤ï¼ŒæŠŠgtid_nextè®¾ç½®æˆå¦å¤–ä¸€ä¸ªgtidæˆ–è€…automaticã€‚</p><p>è¿™æ ·ï¼Œæ¯ä¸ªMySQLå®ä¾‹éƒ½ç»´æŠ¤äº†ä¸€ä¸ªGTIDé›†åˆï¼Œç”¨æ¥å¯¹åº”â€œè¿™ä¸ªå®ä¾‹æ‰§è¡Œè¿‡çš„æ‰€æœ‰äº‹åŠ¡â€ã€‚</p><p>è¿™æ ·çœ‹ä¸Šå»ä¸å¤ªå®¹æ˜“ç†è§£ï¼Œæ¥ä¸‹æ¥æˆ‘å°±ç”¨ä¸€ä¸ªç®€å•çš„ä¾‹å­ï¼Œæ¥å’Œä½ è¯´æ˜GTIDçš„åŸºæœ¬ç”¨æ³•ã€‚</p><p>æˆ‘ä»¬åœ¨å®ä¾‹Xä¸­åˆ›å»ºä¸€ä¸ªè¡¨tã€‚</p><pre><code>CREATE TABLE `t` (\n  `id` int(11) NOT NULL,\n  `c` int(11) DEFAULT NULL,\n  PRIMARY KEY (`id`)\n) ENGINE=InnoDB;\n\ninsert into t values(1,1);\n</code></pre><p><img src=\"https://static001.geekbang.org/resource/image/28/c2/28a5cab0079fb12fd5abecd92b3324c2.png?wh=1390*333\" alt=\"\"></p><center><span class=\"reference\">å›¾4 åˆå§‹åŒ–æ•°æ®çš„binlog</span></center><p>å¯ä»¥çœ‹åˆ°ï¼Œäº‹åŠ¡çš„BEGINä¹‹å‰æœ‰ä¸€æ¡SET @@SESSION.GTID_NEXTå‘½ä»¤ã€‚è¿™æ—¶ï¼Œå¦‚æœå®ä¾‹Xæœ‰ä»åº“ï¼Œé‚£ä¹ˆå°†CREATE TABLEå’Œinsertè¯­å¥çš„binlogåŒæ­¥è¿‡å»æ‰§è¡Œçš„è¯ï¼Œæ‰§è¡Œäº‹åŠ¡ä¹‹å‰å°±ä¼šå…ˆæ‰§è¡Œè¿™ä¸¤ä¸ªSETå‘½ä»¤ï¼Œ è¿™æ ·è¢«åŠ å…¥ä»åº“çš„GTIDé›†åˆçš„ï¼Œå°±æ˜¯å›¾ä¸­çš„è¿™ä¸¤ä¸ªGTIDã€‚</p><p>å‡è®¾ï¼Œç°åœ¨è¿™ä¸ªå®ä¾‹Xæ˜¯å¦å¤–ä¸€ä¸ªå®ä¾‹Yçš„ä»åº“ï¼Œå¹¶ä¸”æ­¤æ—¶åœ¨å®ä¾‹Yä¸Šæ‰§è¡Œäº†ä¸‹é¢è¿™æ¡æ’å…¥è¯­å¥ï¼š</p><pre><code>insert into t values(1,1);\n</code></pre><p>å¹¶ä¸”ï¼Œè¿™æ¡è¯­å¥åœ¨å®ä¾‹Yä¸Šçš„GTIDæ˜¯ â€œaaaaaaaa-cccc-dddd-eeee-ffffffffffff:10â€ã€‚</p><p>é‚£ä¹ˆï¼Œå®ä¾‹Xä½œä¸ºYçš„ä»åº“ï¼Œå°±è¦åŒæ­¥è¿™ä¸ªäº‹åŠ¡è¿‡æ¥æ‰§è¡Œï¼Œæ˜¾ç„¶ä¼šå‡ºç°ä¸»é”®å†²çªï¼Œå¯¼è‡´å®ä¾‹Xçš„åŒæ­¥çº¿ç¨‹åœæ­¢ã€‚è¿™æ—¶ï¼Œæˆ‘ä»¬åº”è¯¥æ€ä¹ˆå¤„ç†å‘¢ï¼Ÿ</p><p>å¤„ç†æ–¹æ³•å°±æ˜¯ï¼Œä½ å¯ä»¥æ‰§è¡Œä¸‹é¢çš„è¿™ä¸ªè¯­å¥åºåˆ—ï¼š</p><pre><code>set gtid_next='aaaaaaaa-cccc-dddd-eeee-ffffffffffff:10';\nbegin;\ncommit;\nset gtid_next=automatic;\nstart slave;\n</code></pre><p>å…¶ä¸­ï¼Œå‰ä¸‰æ¡è¯­å¥çš„ä½œç”¨ï¼Œæ˜¯é€šè¿‡æäº¤ä¸€ä¸ªç©ºäº‹åŠ¡ï¼ŒæŠŠè¿™ä¸ªGTIDåŠ åˆ°å®ä¾‹Xçš„GTIDé›†åˆä¸­ã€‚å¦‚å›¾5æ‰€ç¤ºï¼Œå°±æ˜¯æ‰§è¡Œå®Œè¿™ä¸ªç©ºäº‹åŠ¡ä¹‹åçš„show master statusçš„ç»“æœã€‚</p><p><img src=\"https://static001.geekbang.org/resource/image/c8/57/c8d3299ece7d583a3ecd1557851ed157.png?wh=789*219\" alt=\"\"></p><center><span class=\"reference\">å›¾5 show master statusç»“æœ</span></center><p>å¯ä»¥çœ‹åˆ°å®ä¾‹Xçš„Executed_Gtid_seté‡Œé¢ï¼Œå·²ç»åŠ å…¥äº†è¿™ä¸ªGTIDã€‚</p><p>è¿™æ ·ï¼Œæˆ‘å†æ‰§è¡Œstart slaveå‘½ä»¤è®©åŒæ­¥çº¿ç¨‹æ‰§è¡Œèµ·æ¥çš„æ—¶å€™ï¼Œè™½ç„¶å®ä¾‹Xä¸Šè¿˜æ˜¯ä¼šç»§ç»­æ‰§è¡Œå®ä¾‹Yä¼ è¿‡æ¥çš„äº‹åŠ¡ï¼Œä½†æ˜¯ç”±äºâ€œaaaaaaaa-cccc-dddd-eeee-ffffffffffff:10â€å·²ç»å­˜åœ¨äºå®ä¾‹Xçš„GTIDé›†åˆä¸­äº†ï¼Œæ‰€ä»¥å®ä¾‹Xå°±ä¼šç›´æ¥è·³è¿‡è¿™ä¸ªäº‹åŠ¡ï¼Œä¹Ÿå°±ä¸ä¼šå†å‡ºç°ä¸»é”®å†²çªçš„é”™è¯¯ã€‚</p><p>åœ¨ä¸Šé¢çš„è¿™ä¸ªè¯­å¥åºåˆ—ä¸­ï¼Œstart slaveå‘½ä»¤ä¹‹å‰è¿˜æœ‰ä¸€å¥set gtid_next=automaticã€‚è¿™å¥è¯çš„ä½œç”¨æ˜¯â€œæ¢å¤GTIDçš„é»˜è®¤åˆ†é…è¡Œä¸ºâ€ï¼Œä¹Ÿå°±æ˜¯è¯´å¦‚æœä¹‹åæœ‰æ–°çš„äº‹åŠ¡å†æ‰§è¡Œï¼Œå°±è¿˜æ˜¯æŒ‰ç…§åŸæ¥çš„åˆ†é…æ–¹å¼ï¼Œç»§ç»­åˆ†é…gno=3ã€‚</p><h1>åŸºäºGTIDçš„ä¸»å¤‡åˆ‡æ¢</h1><p>ç°åœ¨ï¼Œæˆ‘ä»¬å·²ç»ç†è§£GTIDçš„æ¦‚å¿µï¼Œå†ä¸€èµ·æ¥çœ‹çœ‹åŸºäºGTIDçš„ä¸»å¤‡å¤åˆ¶çš„ç”¨æ³•ã€‚</p><p>åœ¨GTIDæ¨¡å¼ä¸‹ï¼Œå¤‡åº“Bè¦è®¾ç½®ä¸ºæ–°ä¸»åº“Aâ€™çš„ä»åº“çš„è¯­æ³•å¦‚ä¸‹ï¼š</p><pre><code>CHANGE MASTER TO \nMASTER_HOST=$host_name \nMASTER_PORT=$port \nMASTER_USER=$user_name \nMASTER_PASSWORD=$password \nmaster_auto_position=1 \n</code></pre><p>å…¶ä¸­ï¼Œmaster_auto_position=1å°±è¡¨ç¤ºè¿™ä¸ªä¸»å¤‡å…³ç³»ä½¿ç”¨çš„æ˜¯GTIDåè®®ã€‚å¯ä»¥çœ‹åˆ°ï¼Œå‰é¢è®©æˆ‘ä»¬å¤´ç–¼ä¸å·²çš„MASTER_LOG_FILEå’ŒMASTER_LOG_POSå‚æ•°ï¼Œå·²ç»ä¸éœ€è¦æŒ‡å®šäº†ã€‚</p><p>æˆ‘ä»¬æŠŠç°åœ¨è¿™ä¸ªæ—¶åˆ»ï¼Œå®ä¾‹Aâ€™çš„GTIDé›†åˆè®°ä¸ºset_aï¼Œå®ä¾‹Bçš„GTIDé›†åˆè®°ä¸ºset_bã€‚æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬å°±çœ‹çœ‹ç°åœ¨çš„ä¸»å¤‡åˆ‡æ¢é€»è¾‘ã€‚</p><p>æˆ‘ä»¬åœ¨å®ä¾‹Bä¸Šæ‰§è¡Œstart slaveå‘½ä»¤ï¼Œå–binlogçš„é€»è¾‘æ˜¯è¿™æ ·çš„ï¼š</p><ol>\n<li>\n<p>å®ä¾‹BæŒ‡å®šä¸»åº“Aâ€™ï¼ŒåŸºäºä¸»å¤‡åè®®å»ºç«‹è¿æ¥ã€‚</p>\n</li>\n<li>\n<p>å®ä¾‹BæŠŠset_bå‘ç»™ä¸»åº“Aâ€™ã€‚</p>\n</li>\n<li>\n<p>å®ä¾‹Aâ€™ç®—å‡ºset_aä¸set_bçš„å·®é›†ï¼Œä¹Ÿå°±æ˜¯æ‰€æœ‰å­˜åœ¨äºset_aï¼Œä½†æ˜¯ä¸å­˜åœ¨äºset_bçš„GTIDçš„é›†åˆï¼Œåˆ¤æ–­Aâ€™æœ¬åœ°æ˜¯å¦åŒ…å«äº†è¿™ä¸ªå·®é›†éœ€è¦çš„æ‰€æœ‰binlogäº‹åŠ¡ã€‚<br>\na.  å¦‚æœä¸åŒ…å«ï¼Œè¡¨ç¤ºAâ€™å·²ç»æŠŠå®ä¾‹Béœ€è¦çš„binlogç»™åˆ æ‰äº†ï¼Œç›´æ¥è¿”å›é”™è¯¯ï¼›<br>\nb.  å¦‚æœç¡®è®¤å…¨éƒ¨åŒ…å«ï¼ŒAâ€™ä»è‡ªå·±çš„binlogæ–‡ä»¶é‡Œé¢ï¼Œæ‰¾å‡ºç¬¬ä¸€ä¸ªä¸åœ¨set_bçš„äº‹åŠ¡ï¼Œå‘ç»™Bï¼›</p>\n</li>\n<li>\n<p>ä¹‹åå°±ä»è¿™ä¸ªäº‹åŠ¡å¼€å§‹ï¼Œå¾€åè¯»æ–‡ä»¶ï¼ŒæŒ‰é¡ºåºå–binlogå‘ç»™Bå»æ‰§è¡Œã€‚</p>\n</li>\n</ol><p>å…¶å®ï¼Œè¿™ä¸ªé€»è¾‘é‡Œé¢åŒ…å«äº†ä¸€ä¸ªè®¾è®¡æ€æƒ³ï¼šåœ¨åŸºäºGTIDçš„ä¸»å¤‡å…³ç³»é‡Œï¼Œç³»ç»Ÿè®¤ä¸ºåªè¦å»ºç«‹ä¸»å¤‡å…³ç³»ï¼Œå°±å¿…é¡»ä¿è¯ä¸»åº“å‘ç»™å¤‡åº“çš„æ—¥å¿—æ˜¯å®Œæ•´çš„ã€‚å› æ­¤ï¼Œå¦‚æœå®ä¾‹Béœ€è¦çš„æ—¥å¿—å·²ç»ä¸å­˜åœ¨ï¼ŒAâ€™å°±æ‹’ç»æŠŠæ—¥å¿—å‘ç»™Bã€‚</p><p>è¿™è·ŸåŸºäºä½ç‚¹çš„ä¸»å¤‡åè®®ä¸åŒã€‚åŸºäºä½ç‚¹çš„åè®®ï¼Œæ˜¯ç”±å¤‡åº“å†³å®šçš„ï¼Œå¤‡åº“æŒ‡å®šå“ªä¸ªä½ç‚¹ï¼Œä¸»åº“å°±å‘å“ªä¸ªä½ç‚¹ï¼Œä¸åšæ—¥å¿—çš„å®Œæ•´æ€§åˆ¤æ–­ã€‚</p><p>åŸºäºä¸Šé¢çš„ä»‹ç»ï¼Œæˆ‘ä»¬å†æ¥çœ‹çœ‹å¼•å…¥GTIDåï¼Œä¸€ä¸»å¤šä»çš„åˆ‡æ¢åœºæ™¯ä¸‹ï¼Œä¸»å¤‡åˆ‡æ¢æ˜¯å¦‚ä½•å®ç°çš„ã€‚</p><p>ç”±äºä¸éœ€è¦æ‰¾ä½ç‚¹äº†ï¼Œæ‰€ä»¥ä»åº“Bã€Cã€Dåªéœ€è¦åˆ†åˆ«æ‰§è¡Œchange masterå‘½ä»¤æŒ‡å‘å®ä¾‹Aâ€™å³å¯ã€‚</p><p>å…¶å®ï¼Œä¸¥è°¨åœ°è¯´ï¼Œä¸»å¤‡åˆ‡æ¢ä¸æ˜¯ä¸éœ€è¦æ‰¾ä½ç‚¹äº†ï¼Œè€Œæ˜¯æ‰¾ä½ç‚¹è¿™ä¸ªå·¥ä½œï¼Œåœ¨å®ä¾‹Aâ€™å†…éƒ¨å°±å·²ç»è‡ªåŠ¨å®Œæˆäº†ã€‚ä½†ç”±äºè¿™ä¸ªå·¥ä½œæ˜¯è‡ªåŠ¨çš„ï¼Œæ‰€ä»¥å¯¹HAç³»ç»Ÿçš„å¼€å‘äººå‘˜æ¥è¯´ï¼Œéå¸¸å‹å¥½ã€‚</p><p>ä¹‹åè¿™ä¸ªç³»ç»Ÿå°±ç”±æ–°ä¸»åº“Aâ€™å†™å…¥ï¼Œä¸»åº“Aâ€™çš„è‡ªå·±ç”Ÿæˆçš„binlogä¸­çš„GTIDé›†åˆæ ¼å¼æ˜¯ï¼šserver_uuid_of_Aâ€™:1-Mã€‚</p><p>å¦‚æœä¹‹å‰ä»åº“Bçš„GTIDé›†åˆæ ¼å¼æ˜¯ server_uuid_of_A:1-Nï¼Œ é‚£ä¹ˆåˆ‡æ¢ä¹‹åGTIDé›†åˆçš„æ ¼å¼å°±å˜æˆäº†server_uuid_of_A:1-N, server_uuid_of_Aâ€™:1-Mã€‚</p><p>å½“ç„¶ï¼Œä¸»åº“Aâ€™ä¹‹å‰ä¹Ÿæ˜¯Açš„å¤‡åº“ï¼Œå› æ­¤ä¸»åº“Aâ€™å’Œä»åº“Bçš„GTIDé›†åˆæ˜¯ä¸€æ ·çš„ã€‚è¿™å°±è¾¾åˆ°äº†æˆ‘ä»¬é¢„æœŸã€‚</p><h1>GTIDå’Œåœ¨çº¿DDL</h1><p>æ¥ä¸‹æ¥ï¼Œæˆ‘å†ä¸¾ä¸ªä¾‹å­å¸®ä½ ç†è§£GTIDã€‚</p><p>ä¹‹å‰åœ¨ç¬¬22ç¯‡æ–‡ç« <a href=\"https://time.geekbang.org/column/article/75746\">ã€ŠMySQLæœ‰å“ªäº›â€œé¥®é¸©æ­¢æ¸´â€æé«˜æ€§èƒ½çš„æ–¹æ³•ï¼Ÿã€‹</a>ä¸­ï¼Œæˆ‘å’Œä½ æåˆ°ä¸šåŠ¡é«˜å³°æœŸçš„æ…¢æŸ¥è¯¢æ€§èƒ½é—®é¢˜æ—¶ï¼Œåˆ†æåˆ°å¦‚æœæ˜¯ç”±äºç´¢å¼•ç¼ºå¤±å¼•èµ·çš„æ€§èƒ½é—®é¢˜ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡åœ¨çº¿åŠ ç´¢å¼•æ¥è§£å†³ã€‚ä½†æ˜¯ï¼Œè€ƒè™‘åˆ°è¦é¿å…æ–°å¢ç´¢å¼•å¯¹ä¸»åº“æ€§èƒ½é€ æˆçš„å½±å“ï¼Œæˆ‘ä»¬å¯ä»¥å…ˆåœ¨å¤‡åº“åŠ ç´¢å¼•ï¼Œç„¶åå†åˆ‡æ¢ã€‚</p><p>å½“æ—¶æˆ‘è¯´ï¼Œåœ¨åŒMç»“æ„ä¸‹ï¼Œå¤‡åº“æ‰§è¡Œçš„DDLè¯­å¥ä¹Ÿä¼šä¼ ç»™ä¸»åº“ï¼Œä¸ºäº†é¿å…ä¼ å›åå¯¹ä¸»åº“é€ æˆå½±å“ï¼Œè¦é€šè¿‡set sql_log_bin=offå…³æ‰binlogã€‚</p><p>è¯„è®ºåŒºæœ‰ä½åŒå­¦æå‡ºäº†ä¸€ä¸ªé—®é¢˜ï¼šè¿™æ ·æ“ä½œçš„è¯ï¼Œæ•°æ®åº“é‡Œé¢æ˜¯åŠ äº†ç´¢å¼•ï¼Œä½†æ˜¯binlogå¹¶æ²¡æœ‰è®°å½•ä¸‹è¿™ä¸€ä¸ªæ›´æ–°ï¼Œæ˜¯ä¸æ˜¯ä¼šå¯¼è‡´æ•°æ®å’Œæ—¥å¿—ä¸ä¸€è‡´ï¼Ÿ</p><p>è¿™ä¸ªé—®é¢˜æå¾—éå¸¸å¥½ã€‚å½“æ—¶ï¼Œæˆ‘åœ¨ç•™è¨€çš„å›å¤ä¸­å°±å¼•ç”¨äº†GTIDæ¥è¯´æ˜ã€‚ä»Šå¤©ï¼Œæˆ‘å†å’Œä½ å±•å¼€è¯´æ˜ä¸€ä¸‹ã€‚</p><p>å‡è®¾ï¼Œè¿™ä¸¤ä¸ªäº’ä¸ºä¸»å¤‡å…³ç³»çš„åº“è¿˜æ˜¯å®ä¾‹Xå’Œå®ä¾‹Yï¼Œä¸”å½“å‰ä¸»åº“æ˜¯Xï¼Œå¹¶ä¸”éƒ½æ‰“å¼€äº†GTIDæ¨¡å¼ã€‚è¿™æ—¶çš„ä¸»å¤‡åˆ‡æ¢æµç¨‹å¯ä»¥å˜æˆä¸‹é¢è¿™æ ·ï¼š</p><ul>\n<li>\n<p>åœ¨å®ä¾‹Xä¸Šæ‰§è¡Œstop slaveã€‚</p>\n</li>\n<li>\n<p>åœ¨å®ä¾‹Yä¸Šæ‰§è¡ŒDDLè¯­å¥ã€‚æ³¨æ„ï¼Œè¿™é‡Œå¹¶ä¸éœ€è¦å…³é—­binlogã€‚</p>\n</li>\n<li>\n<p>æ‰§è¡Œå®Œæˆåï¼ŒæŸ¥å‡ºè¿™ä¸ªDDLè¯­å¥å¯¹åº”çš„GTIDï¼Œå¹¶è®°ä¸º server_uuid_of_Y:gnoã€‚</p>\n</li>\n<li>\n<p>åˆ°å®ä¾‹Xä¸Šæ‰§è¡Œä»¥ä¸‹è¯­å¥åºåˆ—ï¼š</p>\n</li>\n</ul><pre><code>set GTID_NEXT=&quot;server_uuid_of_Y:gno&quot;;\nbegin;\ncommit;\nset gtid_next=automatic;\nstart slave;\n</code></pre><p>è¿™æ ·åšçš„ç›®çš„åœ¨äºï¼Œæ—¢å¯ä»¥è®©å®ä¾‹Yçš„æ›´æ–°æœ‰binlogè®°å½•ï¼ŒåŒæ—¶ä¹Ÿå¯ä»¥ç¡®ä¿ä¸ä¼šåœ¨å®ä¾‹Xä¸Šæ‰§è¡Œè¿™æ¡æ›´æ–°ã€‚</p><ul>\n<li>æ¥ä¸‹æ¥ï¼Œæ‰§è¡Œå®Œä¸»å¤‡åˆ‡æ¢ï¼Œç„¶åç…§ç€ä¸Šè¿°æµç¨‹å†æ‰§è¡Œä¸€éå³å¯ã€‚</li>\n</ul><h1>å°ç»“</h1><p>åœ¨ä»Šå¤©è¿™ç¯‡æ–‡ç« ä¸­ï¼Œæˆ‘å…ˆå’Œä½ ä»‹ç»äº†ä¸€ä¸»å¤šä»çš„ä¸»å¤‡åˆ‡æ¢æµç¨‹ã€‚åœ¨è¿™ä¸ªè¿‡ç¨‹ä¸­ï¼Œä»åº“æ‰¾æ–°ä¸»åº“çš„ä½ç‚¹æ˜¯ä¸€ä¸ªç—›ç‚¹ã€‚ç”±æ­¤ï¼Œæˆ‘ä»¬å¼•å‡ºäº†MySQL 5.6ç‰ˆæœ¬å¼•å…¥çš„GTIDæ¨¡å¼ï¼Œä»‹ç»äº†GTIDçš„åŸºæœ¬æ¦‚å¿µå’Œç”¨æ³•ã€‚</p><p>å¯ä»¥çœ‹åˆ°ï¼Œåœ¨GTIDæ¨¡å¼ä¸‹ï¼Œä¸€ä¸»å¤šä»åˆ‡æ¢å°±éå¸¸æ–¹ä¾¿äº†ã€‚</p><p>å› æ­¤ï¼Œå¦‚æœä½ ä½¿ç”¨çš„MySQLç‰ˆæœ¬æ”¯æŒGTIDçš„è¯ï¼Œæˆ‘éƒ½å»ºè®®ä½ å°½é‡ä½¿ç”¨GTIDæ¨¡å¼æ¥åšä¸€ä¸»å¤šä»çš„åˆ‡æ¢ã€‚</p><p>åœ¨ä¸‹ä¸€ç¯‡æ–‡ç« ä¸­ï¼Œæˆ‘ä»¬è¿˜èƒ½çœ‹åˆ°GTIDæ¨¡å¼åœ¨è¯»å†™åˆ†ç¦»åœºæ™¯çš„åº”ç”¨ã€‚</p><p>æœ€åï¼Œåˆåˆ°äº†æˆ‘ä»¬çš„æ€è€ƒé¢˜æ—¶é—´ã€‚</p><p>ä½ åœ¨GTIDæ¨¡å¼ä¸‹è®¾ç½®ä¸»ä»å…³ç³»çš„æ—¶å€™ï¼Œä»åº“æ‰§è¡Œstart slaveå‘½ä»¤åï¼Œä¸»åº“å‘ç°éœ€è¦çš„binlogå·²ç»è¢«åˆ é™¤æ‰äº†ï¼Œå¯¼è‡´ä¸»å¤‡åˆ›å»ºä¸æˆåŠŸã€‚è¿™ç§æƒ…å†µä¸‹ï¼Œä½ è§‰å¾—å¯ä»¥æ€ä¹ˆå¤„ç†å‘¢ï¼Ÿ</p><p>ä½ å¯ä»¥æŠŠä½ çš„æ–¹æ³•å†™åœ¨ç•™è¨€åŒºï¼Œæˆ‘ä¼šåœ¨ä¸‹ä¸€ç¯‡æ–‡ç« çš„æœ«å°¾å’Œä½ è®¨è®ºè¿™ä¸ªé—®é¢˜ã€‚æ„Ÿè°¢ä½ çš„æ”¶å¬ï¼Œä¹Ÿæ¬¢è¿ä½ æŠŠè¿™ç¯‡æ–‡ç« åˆ†äº«ç»™æ›´å¤šçš„æœ‹å‹ä¸€èµ·é˜…è¯»ã€‚</p><h1>ä¸ŠæœŸé—®é¢˜æ—¶é—´</h1><p>ä¸Šä¸€ç¯‡æ–‡ç« æœ€åï¼Œæˆ‘ç»™ä½ ç•™çš„é—®é¢˜æ˜¯ï¼Œå¦‚æœä¸»åº“éƒ½æ˜¯å•çº¿ç¨‹å‹åŠ›æ¨¡å¼ï¼Œåœ¨ä»åº“è¿½ä¸»åº“çš„è¿‡ç¨‹ä¸­ï¼Œbinlog-transaction-dependency-tracking åº”è¯¥é€‰ç”¨ä»€ä¹ˆå‚æ•°ï¼Ÿ</p><p>è¿™ä¸ªé—®é¢˜çš„ç­”æ¡ˆæ˜¯ï¼Œåº”è¯¥å°†è¿™ä¸ªå‚æ•°è®¾ç½®ä¸ºWRITESETã€‚</p><p>ç”±äºä¸»åº“æ˜¯å•çº¿ç¨‹å‹åŠ›æ¨¡å¼ï¼Œæ‰€ä»¥æ¯ä¸ªäº‹åŠ¡çš„commit_idéƒ½ä¸åŒï¼Œé‚£ä¹ˆè®¾ç½®ä¸ºCOMMIT_ORDERæ¨¡å¼çš„è¯ï¼Œä»åº“ä¹Ÿåªèƒ½å•çº¿ç¨‹æ‰§è¡Œã€‚</p><p>åŒæ ·åœ°ï¼Œç”±äºWRITESET_SESSIONæ¨¡å¼è¦æ±‚åœ¨å¤‡åº“åº”ç”¨æ—¥å¿—çš„æ—¶å€™ï¼ŒåŒä¸€ä¸ªçº¿ç¨‹çš„æ—¥å¿—å¿…é¡»ä¸ä¸»åº“ä¸Šæ‰§è¡Œçš„å…ˆåé¡ºåºç›¸åŒï¼Œä¹Ÿä¼šå¯¼è‡´ä¸»åº“å•çº¿ç¨‹å‹åŠ›æ¨¡å¼ä¸‹é€€åŒ–æˆå•çº¿ç¨‹å¤åˆ¶ã€‚</p><p>æ‰€ä»¥ï¼Œåº”è¯¥å°†binlog-transaction-dependency-tracking è®¾ç½®ä¸ºWRITESETã€‚</p><p><strong>è¯„è®ºåŒºç•™è¨€ç‚¹èµæ¿ï¼š</strong></p><blockquote>\n<p>@æ…§é‘«coming é—®äº†ä¸€ä¸ªå¥½é—®é¢˜ï¼Œå¯¹åŒä¸€è¡Œä½œæ›´æ–°çš„å‡ ä¸ªäº‹åŠ¡ï¼Œå¦‚æœcommit_idç›¸åŒï¼Œæ˜¯ä¸æ˜¯åœ¨å¤‡åº“å¹¶è¡Œæ‰§è¡Œçš„æ—¶å€™ä¼šå¯¼è‡´æ•°æ®ä¸ä¸€è‡´ï¼Ÿè¿™ä¸ªé—®é¢˜çš„ç­”æ¡ˆæ˜¯æ›´æ–°åŒä¸€è¡Œçš„äº‹åŠ¡æ˜¯ä¸å¯èƒ½åŒæ—¶è¿›å…¥commitçŠ¶æ€çš„ã€‚<br>\n@è€æ¨åŒå¿— å¯¹è¿™ä¸ªé—®é¢˜ç»™å‡ºäº†æ›´è¯¦ç»†çš„å›ç­”ï¼Œå¤§å®¶å¯ä»¥å»çœ‹ä¸€ä¸‹ã€‚</p>\n</blockquote><p></p>","comments":[{"had_liked":false,"id":60759,"user_name":"æŸã€äºº","can_delete":false,"product_type":"c1","uid":1308784,"ip_address":"","ucode":"ADB42AA12A11C1","user_header":"https://static001.geekbang.org/account/avatar/00/13/f8/70/f3a33a14.jpg","comment_is_top":true,"comment_ctime":1547544092,"is_pvip":false,"replies":[{"id":"21673","content":"éå¸¸å¥½ğŸ‘","user_name":"ä½œè€…å›å¤","comment_id":60759,"uid":"1264162","ip_address":"","utype":1,"ctime":1547552063,"user_name_real":"æ—æ™“æ–Œ"}],"discussion_count":7,"race_medal":0,"score":"9.2233724378342994e+18","product_id":100020801,"comment_content":"1.å¦‚æœä¸šåŠ¡å…è®¸ä¸»ä»ä¸ä¸€è‡´çš„æƒ…å†µé‚£ä¹ˆå¯ä»¥åœ¨ä¸»ä¸Šå…ˆshow global variables like &#39;gtid_purged&#39;;ç„¶ååœ¨ä»ä¸Šæ‰§è¡Œset global gtid_purged =&#39; &#39;.æŒ‡å®šä»åº“ä»å“ªä¸ªgtidå¼€å§‹åŒæ­¥,binlogç¼ºå¤±é‚£ä¸€éƒ¨åˆ†,æ•°æ®åœ¨ä»åº“ä¸Šä¼šä¸¢å¤±,å°±ä¼šé€ æˆä¸»ä»ä¸ä¸€è‡´<br>2.éœ€è¦ä¸»ä»æ•°æ®ä¸€è‡´çš„è¯,æœ€å¥½è¿˜æ˜¯é€šè¿‡é‡æ–°æ­å»ºä»åº“æ¥åšã€‚<br>3.å¦‚æœæœ‰å…¶å®ƒçš„ä»åº“ä¿ç•™æœ‰å…¨é‡çš„binlogçš„è¯ï¼Œå¯ä»¥æŠŠä»åº“æŒ‡å®šä¸ºä¿ç•™äº†å…¨é‡binlogçš„ä»åº“ä¸ºä¸»åº“(çº§è”å¤åˆ¶)<br>4.å¦‚æœbinlogæœ‰å¤‡ä»½çš„æƒ…å†µ,å¯ä»¥å…ˆåœ¨ä»åº“ä¸Šåº”ç”¨ç¼ºå¤±çš„binlog,ç„¶ååœ¨start slave<br>","like_count":94,"discussions":[{"author":{"id":1264162,"avatar":"https://static001.geekbang.org/account/avatar/00/13/4a/22/2681d602.jpg","nickname":"æ—æ™“æ–Œ","note":"","ucode":"CDE42D44F26240","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":436612,"discussion_content":"éå¸¸å¥½ğŸ‘","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1547552063,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1508329,"avatar":"https://static001.geekbang.org/account/avatar/00/17/03/e9/6358059c.jpg","nickname":"GalaxyCreater","note":"","ucode":"C79E8A088D57CF","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":261084,"discussion_content":"æœ‰ä¸ªé—®é¢˜ï¼Œä¸»å¤‡åˆ‡æ¢çš„è¿‡ç¨‹ä¸­ï¼Œæ•°æ®ä¸€è‡´æ€§æ€ä¹ˆä¿è¯ï¼Œä¹Ÿå°±æ˜¯å¤‡åº“è¿˜æ²¡å®Œå…¨è¯»å®Œrelay logï¼Œè€Œè¿™æ—¶å€™åˆšå¥½æœ‰sqlæ¥æ”¹å¯¹åº”çš„è¿™æ¡æ•°æ®äº†","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1588938117,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":1,"child_discussions":[{"author":{"id":1228424,"avatar":"https://static001.geekbang.org/account/avatar/00/12/be/88/8d15796f.jpg","nickname":"John","note":"","ucode":"A46AF2906C38C1","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":1508329,"avatar":"https://static001.geekbang.org/account/avatar/00/17/03/e9/6358059c.jpg","nickname":"GalaxyCreater","note":"","ucode":"C79E8A088D57CF","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":311063,"discussion_content":"åˆ‡æ¢æœŸé—´æ‰€æœ‰åº“éƒ½æ˜¯readonlyï¼Œå³æ•´ä¸ªæ•°æ®åº“éƒ½ä¸å¯å†™ï¼Œæ‰€ä»¥è¦ä¿è¯åˆ‡æ¢æ—¶é—´å¤ŸçŸ­ï¼Œå…¶å®é€šè¿‡å‰é¢è€å¸ˆæåˆ°çš„æŸ¥çœ‹ä¸»ä»å»¶è¿Ÿçš„æ–¹å¼ç­‰å»¶è¿Ÿé™ä½åˆ°&#34;å¤ŸçŸ­&#34;çš„æ—¶å€™æ‰å¯ä»¥å¼€å§‹åˆ‡æ¢","likes_number":1,"is_delete":false,"is_hidden":false,"ctime":1602208459,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":261084,"ip_address":""},"score":311063,"extra":""}]},{"author":{"id":1541014,"avatar":"https://static001.geekbang.org/account/avatar/00/17/83/96/73ff13a0.jpg","nickname":"å¤©äº®å‰è¯´æ™šå®‰","note":"","ucode":"1D82EE562A7C71","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":188011,"discussion_content":"æˆ‘åœ¨æƒ³æ–‡ä¸­çš„ä¾‹å­ï¼ŒBçš„binlogæ—¥å¿—å¤šäºA&#39;çš„æƒ…å†µä¸‹ï¼Œæ˜¯ä¸æ˜¯ä¼šä¸€ç›´æ–°çš„ä¸»å¤‡æ•°æ®ä¸ä¸€è‡´å•Šï¼Ÿå› ä¸ºset_a - set_b = 0ã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1582788010,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":3,"child_discussions":[{"author":{"id":1526355,"avatar":"https://static001.geekbang.org/account/avatar/00/17/4a/53/063f9d17.jpg","nickname":"moonfox","note":"","ucode":"902BFF40EFA9FA","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":1541014,"avatar":"https://static001.geekbang.org/account/avatar/00/17/83/96/73ff13a0.jpg","nickname":"å¤©äº®å‰è¯´æ™šå®‰","note":"","ucode":"1D82EE562A7C71","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":314266,"discussion_content":"åŒæ„ï¼Œæœ‰è¿™ä¸ªæƒ…å†µï¼Œä¸»åº“å…ˆä¼ B,ç„¶åæ‰ç”µï¼ŒA&#39;ä¸Šæ²¡æ”¶åˆ°æ—¶","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1603132333,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":188011,"ip_address":""},"score":314266,"extra":""},{"author":{"id":1970443,"avatar":"http://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTIx1V1QAxC4NHaxYZGyuibBN8lcURJWc5nrnO4yic1kxnDemYV2FJGialf47kYX9qtDnZZOfe1SJeLicg/132","nickname":"lleft","note":"","ucode":"D573EB509455AE","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":1526355,"avatar":"https://static001.geekbang.org/account/avatar/00/17/4a/53/063f9d17.jpg","nickname":"moonfox","note":"","ucode":"902BFF40EFA9FA","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":375374,"discussion_content":"å…¶å®è¿™ä¸ªåœ°æ–¹Aå’ŒA&#39;ä¸æ˜¯ç®€å•çš„å¼‚æ­¥å¤åˆ¶ï¼Œè€Œåº”è¯¥æ˜¯åŠåŒæ­¥å¤åˆ¶ã€‚å°±ä¸ä¼šå‡ºç°ä»åº“æœ‰å¤‡åº“æ²¡æœ‰çš„æƒ…å†µï¼›å†æˆ–è€…æ•´ä¸ªæ¶æ„éƒ½æ˜¯åŠåŒæ­¥å¤åˆ¶ï¼Œåˆ‡æ¢æ—¶æ‰¾åŒ…å«æœ€æ–°æ•°æ®çš„åº“ä½œä¸ºæ–°çš„ä¸»åº“ï¼Œè¿™æ ·å°±è§£å†³äº†ã€‚","likes_number":2,"is_delete":false,"is_hidden":false,"ctime":1621591104,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":314266,"ip_address":""},"score":375374,"extra":""},{"author":{"id":1986739,"avatar":"https://static001.geekbang.org/account/avatar/00/1e/50/b3/9269cd59.jpg","nickname":"LWD","note":"","ucode":"DDA444DB113C01","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":1970443,"avatar":"http://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTIx1V1QAxC4NHaxYZGyuibBN8lcURJWc5nrnO4yic1kxnDemYV2FJGialf47kYX9qtDnZZOfe1SJeLicg/132","nickname":"lleft","note":"","ucode":"D573EB509455AE","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":587852,"discussion_content":"æœ‰ä¸ªæƒ³æ³•ï¼šAâ€™å’ŒAä»¥åŒæ­¥è¿›è¡Œå¤åˆ¶ï¼ŒB,C,Då’ŒAâ€˜åšå¼‚æ­¥ï¼Œè¿™æ ·åº”è¯¥æ—¢å¯ä»¥èŠ‚çœå½“å‰ä¸»çš„å¸¦å®½åˆèƒ½ä¿è¯å¤‡æœºæ•°æ®å®Œæ•´æ€§ã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1663319904,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":375374,"ip_address":"å¹¿ä¸œ"},"score":587852,"extra":""}]}]},{"had_liked":false,"id":61709,"user_name":"Mr.Strive.Z.H.L","can_delete":false,"product_type":"c1","uid":1030198,"ip_address":"","ucode":"6D97E159E2EECD","user_header":"https://static001.geekbang.org/account/avatar/00/0f/b8/36/542c96bf.jpg","comment_is_top":true,"comment_ctime":1547779404,"is_pvip":false,"replies":[{"id":"21902","content":"3 è¿™ä¸ªåº”è¯¥æ˜¯å¯ä»¥åšåˆ°è‡ªåŠ¨åŒ–çš„ã€‚<br>4 è¿™ä¸ªæ¦‚ç‡æ¯”è¾ƒå°ï¼Œå…¶å®å³ä½¿æ˜¯åˆ«çš„ä¸‰èŠ‚ç‚¹çš„æ–¹æ¡ˆï¼Œä¹Ÿæ¶ä¸ä½æŒ‚ä¸¤ä¸ªå®ä¾‹ï¼Œæ‰€ä»¥è¿™ä¸ªä¸æ˜¯MySQLä¸»å¤‡çš„é”…ã€‚<br><br>å‰é¢ä¸¤ç‚¹æå¾—å¾ˆå¯¹å“ˆã€‚<br>å…¶å®MySQLåˆ°ç°åœ¨ï¼Œè¿˜æ˜¯æä¾›äº†å¾ˆå¤šæ–¹æ¡ˆå¯é€‰çš„ã€‚å¾ˆå¤šæ˜¯ä¸šåŠ¡æƒè¡¡çš„ç»“æœã€‚<br><br>æ¯”å¦‚è¯´ï¼Œå¼‚æ­¥å¤åˆ¶ï¼Œåœ¨ä¸»åº“å¼‚å¸¸æ‰ç”µçš„æ—¶å€™å¯èƒ½ä¼šä¸¢æ•°æ®ã€‚<br>è¿™ä¸ªå¤§å®¶çŸ¥é“ä»¥åï¼Œæœ‰ä¸€äº›å°±æ”¹æˆsemi-syncäº†ï¼Œä½†æ˜¯è¿˜æ˜¯æœ‰ä¸€äº›å°±ç•™ç€å¼‚æ­¥å¤åˆ¶çš„æ¨¡å¼ï¼Œå› ä¸ºsemi-syncæœ‰æ€§èƒ½å½±å“ï¼ˆä¸€å¼€å§‹35%ï¼Œç°åœ¨å¥½ç‚¹15%å·¦å³ï¼Œçœ‹å…·ä½“ç¯å¢ƒï¼‰ï¼Œè€Œå¯èƒ½è¿™äº›ä¸šåŠ¡è®¤ä¸ºä¸¢ä¸€ä¸¤è¡Œï¼Œå¯ä»¥ä»åº”ç”¨å±‚æ—¥å¿—å»è¡¥ã€‚ å°±ä¿ç•™äº†å¼‚æ­¥å¤åˆ¶æ¨¡å¼ã€‚<br><br>æœ€åï¼Œä¸ºä»€ä¹ˆä¸»ä»å¤‡ä»½ç”¨å¾—æœ€å¤šï¼Œæˆ‘è§‰å¾—æœ‰å†å²åŸå› ã€‚å¤šå¹´å‰MySQLåˆšè¦å¼€å§‹ç«çš„æ—¶å€™ï¼Œå¤§å®¶å‘ç°è¿™ä¸ªä¸»å¤‡æ¨¡å¼å¥½æ–¹ä¾¿ï¼Œå°±éƒ½ç”¨äº†ã€‚<br>è€ŒåŸºäºå…¶ä»–åè®®çš„æ–¹æ¡ˆï¼Œéƒ½æ˜¯åæ¥å‡ºç°çš„ï¼Œå¹¶ä¸”è¿˜æ˜¯é™†é™†ç»­ç»­å‡ºç‚¹bugã€‚<br>æ¶‰åŠåˆ°çº¿ä¸ŠæœåŠ¡ï¼Œå¤§å®¶ä½¿ç”¨æ–°æ–¹æ¡ˆçš„çƒ­æƒ…æ€»æ˜¯å±€é™åœ¨æµ‹è¯•ç¯å¢ƒçš„å¤šã€‚<br><br>semi-syncä¹Ÿæ˜¯è¿‘å‡ å¹´æ‰å¼€å§‹ç¨³å®šå¹¶è¢«ä¸€äº›å…¬å¸å¼€å§‹ä½œä¸ºé»˜è®¤é…ç½®ã€‚<br><br>æ–°æŠ€æœ¯çš„æ¨å¹¿ï¼Œåœ¨æ•°æ®åº“ä¸Šï¼Œç¡®å®æ¯”å…¶ä»–é¢†åŸŸæ›´éœ€è¦è°¨æ…äº›ï¼Œä¹Ÿç®—æ˜¯ä¸šåŠ¡å†³å®šçš„å§^_^<br>å¥½é—®é¢˜ğŸ‘<br>ä»¥ä¸Šä»…ä¸€å®¶ä¹‹è¨€å“ˆğŸ˜†<br><br>","user_name":"ä½œè€…å›å¤","comment_id":61709,"uid":"1264162","ip_address":"","utype":1,"ctime":1547783650,"user_name_real":"æ—æ™“æ–Œ"}],"discussion_count":7,"race_medal":0,"score":"9.2233722703308001e+18","product_id":100020801,"comment_content":"è€å¸ˆæ‚¨å¥½ï¼š<br>åœ¨å®é™…å·¥ä½œä¸­ï¼Œä¸»ä»å¤‡ä»½ä¼¼ä¹æ˜¯mysqlç”¨çš„æœ€å¤šçš„é«˜å¯ç”¨æ–¹æ¡ˆã€‚<br>ä½†æ˜¯ä¸ªäººè®¤ä¸ºä¸»ä»å¤‡ä»½è¿™ä¸ªæ–¹æ¡ˆçš„é—®é¢˜å®åœ¨å¤ªå¤šäº†ï¼š<br>1. binlogæ•°æ®ä¼ è¾“å‰ï¼Œä¸»åº“å®•æœºï¼Œå¯¼è‡´æäº¤äº†çš„äº‹åŠ¡æ•°æ®ä¸¢å¤±ã€‚<br>2. ä¸€ä¸»å¤šä»ï¼Œå³ä½¿é‡‡ç”¨åŠåŒæ­¥ï¼Œä¹Ÿåªèƒ½ä¿è¯binlogè‡³å°‘åœ¨ä¸¤å°æœºå™¨ä¸Šï¼Œæ²¡æœ‰ä¸€ä¸ªæœºåˆ¶èƒ½å¤Ÿé€‰å‡ºæ‹¥æœ‰æœ€å®Œæ•´binlogçš„ä»åº“ä½œä¸ºæ–°çš„ä¸»åº“ã€‚<br>3. ä¸»ä»åˆ‡æ¢æ¶‰åŠåˆ° äººä¸ºæ“ä½œï¼Œè€Œä¸æ˜¯å…¨è‡ªåŠ¨åŒ–çš„ã€‚å³ä½¿åœ¨ä½¿ç”¨GTIDçš„æƒ…å†µä¸‹ï¼Œä¹Ÿä¼šæœ‰binlogè¢«åˆ é™¤ï¼Œéœ€è¦é‡æ–°åšä»åº“çš„æƒ…å†µã€‚<br>4. äº’ä¸ºä¸»å¤‡ï¼Œå¦‚æœäº’ä¸ºä¸»å¤‡çš„ä¸¤ä¸ªå®ä¾‹å…¨éƒ¨å®•æœºï¼Œmysqlç›´æ¥ä¸å¯ç”¨ã€‚<br><br>mysqlåº”è¯¥æœ‰æ›´å¼ºå¤§æ›´å®Œå¤‡çš„é«˜å¯ç”¨æ–¹æ¡ˆï¼ˆç±»ä¼¼äºzabåè®®æˆ–è€…raftåè®®è¿™ç§ï¼‰ï¼Œè€Œåœ¨å®é™…ç¯å¢ƒä¸‹ï¼Œä¸ºä»€ä¹ˆä¸»ä»å¤‡ä»½ç”¨å¾—æœ€å¤šå‘¢ï¼Ÿ<br>","like_count":55,"discussions":[{"author":{"id":1264162,"avatar":"https://static001.geekbang.org/account/avatar/00/13/4a/22/2681d602.jpg","nickname":"æ—æ™“æ–Œ","note":"","ucode":"CDE42D44F26240","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":436965,"discussion_content":"3 è¿™ä¸ªåº”è¯¥æ˜¯å¯ä»¥åšåˆ°è‡ªåŠ¨åŒ–çš„ã€‚\n4 è¿™ä¸ªæ¦‚ç‡æ¯”è¾ƒå°ï¼Œå…¶å®å³ä½¿æ˜¯åˆ«çš„ä¸‰èŠ‚ç‚¹çš„æ–¹æ¡ˆï¼Œä¹Ÿæ¶ä¸ä½æŒ‚ä¸¤ä¸ªå®ä¾‹ï¼Œæ‰€ä»¥è¿™ä¸ªä¸æ˜¯MySQLä¸»å¤‡çš„é”…ã€‚\n\nå‰é¢ä¸¤ç‚¹æå¾—å¾ˆå¯¹å“ˆã€‚\nå…¶å®MySQLåˆ°ç°åœ¨ï¼Œè¿˜æ˜¯æä¾›äº†å¾ˆå¤šæ–¹æ¡ˆå¯é€‰çš„ã€‚å¾ˆå¤šæ˜¯ä¸šåŠ¡æƒè¡¡çš„ç»“æœã€‚\n\næ¯”å¦‚è¯´ï¼Œå¼‚æ­¥å¤åˆ¶ï¼Œåœ¨ä¸»åº“å¼‚å¸¸æ‰ç”µçš„æ—¶å€™å¯èƒ½ä¼šä¸¢æ•°æ®ã€‚\nè¿™ä¸ªå¤§å®¶çŸ¥é“ä»¥åï¼Œæœ‰ä¸€äº›å°±æ”¹æˆsemi-syncäº†ï¼Œä½†æ˜¯è¿˜æ˜¯æœ‰ä¸€äº›å°±ç•™ç€å¼‚æ­¥å¤åˆ¶çš„æ¨¡å¼ï¼Œå› ä¸ºsemi-syncæœ‰æ€§èƒ½å½±å“ï¼ˆä¸€å¼€å§‹35%ï¼Œç°åœ¨å¥½ç‚¹15%å·¦å³ï¼Œçœ‹å…·ä½“ç¯å¢ƒï¼‰ï¼Œè€Œå¯èƒ½è¿™äº›ä¸šåŠ¡è®¤ä¸ºä¸¢ä¸€ä¸¤è¡Œï¼Œå¯ä»¥ä»åº”ç”¨å±‚æ—¥å¿—å»è¡¥ã€‚ å°±ä¿ç•™äº†å¼‚æ­¥å¤åˆ¶æ¨¡å¼ã€‚\n\næœ€åï¼Œä¸ºä»€ä¹ˆä¸»ä»å¤‡ä»½ç”¨å¾—æœ€å¤šï¼Œæˆ‘è§‰å¾—æœ‰å†å²åŸå› ã€‚å¤šå¹´å‰MySQLåˆšè¦å¼€å§‹ç«çš„æ—¶å€™ï¼Œå¤§å®¶å‘ç°è¿™ä¸ªä¸»å¤‡æ¨¡å¼å¥½æ–¹ä¾¿ï¼Œå°±éƒ½ç”¨äº†ã€‚\nè€ŒåŸºäºå…¶ä»–åè®®çš„æ–¹æ¡ˆï¼Œéƒ½æ˜¯åæ¥å‡ºç°çš„ï¼Œå¹¶ä¸”è¿˜æ˜¯é™†é™†ç»­ç»­å‡ºç‚¹bugã€‚\næ¶‰åŠåˆ°çº¿ä¸ŠæœåŠ¡ï¼Œå¤§å®¶ä½¿ç”¨æ–°æ–¹æ¡ˆçš„çƒ­æƒ…æ€»æ˜¯å±€é™åœ¨æµ‹è¯•ç¯å¢ƒçš„å¤šã€‚\n\nsemi-syncä¹Ÿæ˜¯è¿‘å‡ å¹´æ‰å¼€å§‹ç¨³å®šå¹¶è¢«ä¸€äº›å…¬å¸å¼€å§‹ä½œä¸ºé»˜è®¤é…ç½®ã€‚\n\næ–°æŠ€æœ¯çš„æ¨å¹¿ï¼Œåœ¨æ•°æ®åº“ä¸Šï¼Œç¡®å®æ¯”å…¶ä»–é¢†åŸŸæ›´éœ€è¦è°¨æ…äº›ï¼Œä¹Ÿç®—æ˜¯ä¸šåŠ¡å†³å®šçš„å§^_^\nå¥½é—®é¢˜ğŸ‘\nä»¥ä¸Šä»…ä¸€å®¶ä¹‹è¨€å“ˆğŸ˜†\n\n","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1547783650,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":2009461,"avatar":"https://static001.geekbang.org/account/avatar/00/1e/a9/75/dbccd12d.jpg","nickname":"ç¨»è‰äºº","note":"","ucode":"6694EE2CD36B8C","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":356383,"discussion_content":"MHAå·¥å…·ä»‹ç»ï¼šhttps://www.cnblogs.com/--smile/p/11475380.html","likes_number":5,"is_delete":false,"is_hidden":false,"ctime":1615566070,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":1,"child_discussions":[{"author":{"id":1209939,"avatar":"https://static001.geekbang.org/account/avatar/00/12/76/53/21d62a23.jpg","nickname":"é²Â·æœ¬","note":"","ucode":"F1DEB30C21B48E","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":2009461,"avatar":"https://static001.geekbang.org/account/avatar/00/1e/a9/75/dbccd12d.jpg","nickname":"ç¨»è‰äºº","note":"","ucode":"6694EE2CD36B8C","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":574052,"discussion_content":"éå¸¸å¥½çš„å·¥å…·ï¼Œæ„Ÿè°¢æ¨è","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1653814089,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":356383,"ip_address":""},"score":574052,"extra":""}]},{"author":{"id":1807588,"avatar":"https://static001.geekbang.org/account/avatar/00/1b/94/e4/aad72736.jpg","nickname":"ä¸€ä¸ªæœ‰å¿—æ°”çš„DB","note":"","ucode":"514419E03590B4","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":202522,"discussion_content":"ç¬¬äºŒä¸ªé—®é¢˜ï¼Œç›´æ¥ä½¿ç”¨MHAå·¥å…·ï¼Œåœ¨é…ç½®æ–‡ä»¶é‡Œé¢é€‰æ‹©candidate_masterï¼Œé€‰æ‹©ä½¿ç”¨äº†åŠåŒæ­¥å¤åˆ¶çš„å¤‡åº“å°±è¡Œäº†ã€‚","likes_number":2,"is_delete":false,"is_hidden":false,"ctime":1583929599,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1543040,"avatar":"https://static001.geekbang.org/account/avatar/00/17/8b/80/8702bd5f.jpg","nickname":"evan","note":"","ucode":"491B073D5AFEDE","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":320015,"discussion_content":"raftæ˜¯å¯ä»¥ä¿è¯æ•°æ®å¼ºä¸€è‡´æ€§, ä½†æ˜¯åŒæ—¶å†™ä¸‰ä»½, ä¸¤ä»½æˆåŠŸæ‰è¿”å›? è¿™ä¸ªèƒ½æ¥å—å—? \nå…¶å®ä¸€èˆ¬çš„ä¸šåŠ¡åœ¨ä½ç«¯æƒ…å†µä¸‹ä¸¢æ•°æ®æ˜¯å¯ä»¥æ¥å—çš„, è‚¯å®šæ˜¯ä¿è¯ååé‡ä¼˜å…ˆ.\n\né‡‘èåœºæ™¯ä¸€èˆ¬ä¼šè‡ªç ”é«˜å¯ç”¨ç»„ä»¶, ç°åœ¨æµç¨‹çš„ob tidbä¹Ÿéƒ½æ˜¯ä½¿ç”¨raftåšæ•°æ®ä¸€è‡´æ€§.","likes_number":1,"is_delete":false,"is_hidden":false,"ctime":1604225417,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1018972,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/8c/5c/3f164f66.jpg","nickname":"äºšæ—","note":"","ucode":"4A5A6D24314B79","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":567601,"discussion_content":"mariadbä¸ºç‹","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1650956048,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":2088647,"avatar":"","nickname":"é›·é¹","note":"","ucode":"1B0A3A1D969A93","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":552300,"discussion_content":"è¿™ä¸ªæ—¶å€™mgrå·²ç»æ¯”è¾ƒæˆç†Ÿå’Œæµè¡Œäº†","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1645404752,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":60267,"user_name":"ä¸ƒä¸ƒ","can_delete":false,"product_type":"c1","uid":1301937,"ip_address":"","ucode":"277BACE2330C54","user_header":"https://static001.geekbang.org/account/avatar/00/13/dd/b1/7323beb9.jpg","comment_is_top":true,"comment_ctime":1547453163,"is_pvip":true,"replies":[{"id":"21545","content":"æ˜¯çš„ï¼Œå› ä¸ºç®—çš„æ˜¯ï¼šå½“å‰æ‰§è¡Œæ—¶é—´ï¼Œè·Ÿ*æ—¥å¿—æ—¶é—´*çš„å·®è·<br><br>è€Œè¿™ä¸ªæ—¥å¿—æ—¶é—´ï¼Œæ˜¯åœ¨Aä¸Šæ‰§è¡Œå‡ºæ¥çš„ã€‚<br><br>å¥½é—®é¢˜ï¼Œå¾ˆå¥½çš„éªŒè¯è¿‡ç¨‹ã€‚","user_name":"ä½œè€…å›å¤","comment_id":60267,"uid":"1264162","ip_address":"","utype":1,"ctime":1547457357,"user_name_real":"æ—æ™“æ–Œ"}],"discussion_count":9,"race_medal":0,"score":"9.2233721328915005e+18","product_id":100020801,"comment_content":"çœ‹è¿‡ä¸Šç¯‡åæƒ³åˆ°ä¸€ä¸ªé—®é¢˜:<br>çº§è”å¤åˆ¶A-&gt;B-&gt;Cç»“æ„ä¸‹, ä»åº“Cçš„Seconds_Behind_Masterçš„æ—¶é—´è®¡ç®—é—®é¢˜.<br>å‡å®šå½“å‰ä¸»åº“Aä»…æœ‰ä¸€ä¸ªDDLè¦è¿›è¡Œå˜æ›´,è€—æ—¶1åˆ†é’Ÿ.é‚£ä¹ˆä»åº“Cçš„SBMå€¼æœ€å¤§åº”è¯¥æ˜¯å¤šå°‘æ—¶é—´?<br>æ˜¯1åˆ†é’Ÿ, 2åˆ†é’Ÿ, è¿˜æ˜¯3åˆ†é’Ÿå‘¢ ?<br>å¸¦ç€ç–‘é—®çœ‹äº†ä¸€ä¸‹æµ‹è¯•ä»åº“Cçš„binlogæ–‡ä»¶ä¸­çš„æ—¶é—´æˆ³,å¾—å‡ºç»“è®ºåº”è¯¥æ˜¯3åˆ†é’Ÿ.<br><br>æ‰“ç ´ä¹‹å‰è®¤çŸ¥ ğŸ¤¦â€â™€ï¸ . è¯·è€å¸ˆè§£æƒ‘ , è°¢è°¢ ! ","like_count":23,"discussions":[{"author":{"id":1264162,"avatar":"https://static001.geekbang.org/account/avatar/00/13/4a/22/2681d602.jpg","nickname":"æ—æ™“æ–Œ","note":"","ucode":"CDE42D44F26240","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":436463,"discussion_content":"æ˜¯çš„ï¼Œå› ä¸ºç®—çš„æ˜¯ï¼šå½“å‰æ‰§è¡Œæ—¶é—´ï¼Œè·Ÿ*æ—¥å¿—æ—¶é—´*çš„å·®è·\n\nè€Œè¿™ä¸ªæ—¥å¿—æ—¶é—´ï¼Œæ˜¯åœ¨Aä¸Šæ‰§è¡Œå‡ºæ¥çš„ã€‚\n\nå¥½é—®é¢˜ï¼Œå¾ˆå¥½çš„éªŒè¯è¿‡ç¨‹ã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1547457357,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1155646,"avatar":"https://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTKotsBr2icbYNYlRSlicGUD1H7lulSTQUAiclsEz9gnG5kCW9qeDwdYtlRMXic3V6sj9UrfKLPJnQojag/132","nickname":"ppd0705","note":"","ucode":"EB63D4E3FD1E9A","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":278190,"discussion_content":"ä¸‹é¢LukiaåŒå­¦çš„æé—®çº æ­£äº†ï¼š æœ€å¤§åªæœ‰2åˆ†é’Ÿ","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1591159648,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1155646,"avatar":"https://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTKotsBr2icbYNYlRSlicGUD1H7lulSTQUAiclsEz9gnG5kCW9qeDwdYtlRMXic3V6sj9UrfKLPJnQojag/132","nickname":"ppd0705","note":"","ucode":"EB63D4E3FD1E9A","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":278186,"discussion_content":"æœ‰ç‚¹å›°æƒ‘ï¼ŒAæ‰§è¡Œçš„ä¸€åˆ†é’Ÿä¹Ÿç®—è¿›å»å—ï¼Ÿ ç¬¬25è®²é‡Œé¢è¯´çš„T1æ˜¯å†™binlogå¼€å§‹ç®—ï¼Œè¿™æ ·Açš„1åˆ†é’Ÿåº”è¯¥ä¸ç®—å§ï¼Ÿ","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1591159517,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":2,"child_discussions":[{"author":{"id":2435151,"avatar":"","nickname":"Geek_a77858","note":"","ucode":"1A708B7E120604","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":1155646,"avatar":"https://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTKotsBr2icbYNYlRSlicGUD1H7lulSTQUAiclsEz9gnG5kCW9qeDwdYtlRMXic3V6sj9UrfKLPJnQojag/132","nickname":"ppd0705","note":"","ucode":"EB63D4E3FD1E9A","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":348879,"discussion_content":"å¹¶è¡Œï½","likes_number":1,"is_delete":false,"is_hidden":false,"ctime":1612764351,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":278186,"ip_address":""},"score":348879,"extra":""},{"author":{"id":2334507,"avatar":"https://static001.geekbang.org/account/avatar/00/23/9f/2b/57b71f70.jpg","nickname":"åŠªé€—æ–¯","note":"","ucode":"C6C722E99F5168","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":1155646,"avatar":"https://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTKotsBr2icbYNYlRSlicGUD1H7lulSTQUAiclsEz9gnG5kCW9qeDwdYtlRMXic3V6sj9UrfKLPJnQojag/132","nickname":"ppd0705","note":"","ucode":"EB63D4E3FD1E9A","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":349964,"discussion_content":"Açš„åº”è¯¥æ²¡ç®—ï¼ŒBçš„æ‰§è¡Œ1åˆ†é’Ÿï¼Œå†™binlog1åˆ†é’Ÿï¼ŒCæ‰§è¡Œ1åˆ†é’Ÿï¼Œæ€»å…±3åˆ†é’Ÿ","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1613647088,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":278186,"ip_address":""},"score":349964,"extra":""}]},{"author":{"id":1540275,"avatar":"https://static001.geekbang.org/account/avatar/00/17/80/b3/188e1bd6.jpg","nickname":"_(:_ã€âˆ )_","note":"","ucode":"F0C757D4CF1DB1","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":221357,"discussion_content":"å¤šè°¢ é•¿è§è¯†äº†","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1586005543,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1000226,"avatar":"","nickname":"Doner","note":"","ucode":"4F49B971CFB32B","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":55132,"discussion_content":"æˆ‘è§‰å¾—åº”è¯¥æ˜¯ï¼Œä»åº“Cæœ€å¼€å§‹æ‰§è¡Œçš„æ—¶å€™æ˜¯2åˆ†é’Ÿçš„å»¶è¿Ÿï¼Œåˆ°æ‰§è¡Œå®Œçš„æ—¶å€™æ˜¯3åˆ†é’Ÿçš„å»¶è¿Ÿã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1574342315,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":2,"child_discussions":[{"author":{"id":1065351,"avatar":"https://static001.geekbang.org/account/avatar/00/10/41/87/d26efb2e.jpg","nickname":"SuperSnow","note":"","ucode":"84C89AA8083E6A","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":1000226,"avatar":"","nickname":"Doner","note":"","ucode":"4F49B971CFB32B","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":170142,"discussion_content":"æ˜¯çš„","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1581672245,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":55132,"ip_address":""},"score":170142,"extra":""},{"author":{"id":2389270,"avatar":"https://static001.geekbang.org/account/avatar/00/24/75/16/6e28bf17.jpg","nickname":"åˆæ™¨","note":"","ucode":"C5D95D13E49127","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":1000226,"avatar":"","nickname":"Doner","note":"","ucode":"4F49B971CFB32B","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":590441,"discussion_content":"2åˆ†é’Ÿï¼ŒBæ‰§è¡Œå®Œ1åˆ†é’Ÿï¼ŒCæ‰§è¡Œå®Œ1åˆ†é’Ÿï¼Œæ€»è®¡2åˆ†é’Ÿã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1665740799,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":55132,"ip_address":"é™•è¥¿"},"score":590441,"extra":""}]}]},{"had_liked":false,"id":60292,"user_name":"å¼ æ°¸å¿—","can_delete":false,"product_type":"c1","uid":1208727,"ip_address":"","ucode":"E54B75EF3F63B3","user_header":"https://static001.geekbang.org/account/avatar/00/12/71/97/f1a3d398.jpg","comment_is_top":false,"comment_ctime":1547455762,"is_pvip":false,"replies":[{"id":"21562","content":"ä½ å·²ç»ç†è§£GTIDçš„æœºåˆ¶å•¦ğŸ‘","user_name":"ä½œè€…å›å¤","comment_id":60292,"uid":"1264162","ip_address":"","utype":1,"ctime":1547495232,"user_name_real":"æ—æ™“æ–Œ"}],"discussion_count":6,"race_medal":0,"score":"147576343826","product_id":100020801,"comment_content":"ä»Šå¤©é—®é¢˜å›ç­”ï¼š<br>GTIDä¸»ä»åŒæ­¥è®¾ç½®æ—¶ï¼Œä¸»åº“Aå‘ç°éœ€åŒæ­¥çš„GTIDæ—¥å¿—æœ‰åˆ æ‰çš„ï¼Œé‚£ä¹ˆAå°±ä¼šæŠ¥é”™ã€‚<br>è§£å†³åŠæ³•ï¼š<br>ä»åº“Båœ¨å¯åŠ¨åŒæ­¥å‰éœ€è¦è®¾ç½® gtid_purgedï¼ŒæŒ‡å®šGTIDåŒæ­¥çš„èµ·ç‚¹ï¼Œä½¿ç”¨å¤‡ä»½æ­å»ºä»åº“æ—¶éœ€è¦è¿™æ ·è®¾ç½®ã€‚<br><br>å¦‚æœåœ¨ä»åº“ä¸Šæ‰§è¡Œäº†å•ç‹¬çš„æ“ä½œï¼Œå¯¼è‡´ä¸»åº“ä¸Šç¼ºå°‘GTIDï¼Œé‚£ä¹ˆå¯ä»¥åœ¨ä¸»åº“ä¸Šæ¨¡æ‹Ÿä¸€ä¸ªä¸ä»åº“Bä¸ŠGTIDä¸€æ ·çš„ç©ºäº‹åŠ¡ï¼Œè¿™æ ·ä¸»ä»åŒæ­¥å°±ä¸ä¼šæŠ¥é”™äº†ã€‚<br>","like_count":35,"discussions":[{"author":{"id":1264162,"avatar":"https://static001.geekbang.org/account/avatar/00/13/4a/22/2681d602.jpg","nickname":"æ—æ™“æ–Œ","note":"","ucode":"CDE42D44F26240","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":436468,"discussion_content":"ä½ å·²ç»ç†è§£GTIDçš„æœºåˆ¶å•¦ğŸ‘","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1547495232,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1725513,"avatar":"https://static001.geekbang.org/account/avatar/00/1a/54/49/1269e44f.jpg","nickname":"Fuzzy","note":"","ucode":"ADFCFC2DA8AD12","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":304486,"discussion_content":"ä¸»åº“çš„uuid å’Œä»åº“çš„ä¸ä¸€æ ·ï¼Œé‚£ä¹ˆå¦‚ä½•åœ¨ä¸»åº“ä¸Šæ¨¡æ‹Ÿä¸€ä¸ªä¸ä»åº“Bä¸ŠGTIDä¸€æ ·çš„ç©ºäº‹åŠ¡ï¼Ÿ","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1599578653,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":1,"child_discussions":[{"author":{"id":1970443,"avatar":"http://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTIx1V1QAxC4NHaxYZGyuibBN8lcURJWc5nrnO4yic1kxnDemYV2FJGialf47kYX9qtDnZZOfe1SJeLicg/132","nickname":"lleft","note":"","ucode":"D573EB509455AE","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":1725513,"avatar":"https://static001.geekbang.org/account/avatar/00/1a/54/49/1269e44f.jpg","nickname":"Fuzzy","note":"","ucode":"ADFCFC2DA8AD12","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":376012,"discussion_content":"è¯´çš„æ˜¯äº’ä¸ºä¸»å¤‡ï¼Œä¸»åº“ä¸Šé¢ä¼šè®°å½•å¤‡åº“çš„GTIDçš„å€¼ï¼Œä¸»åº“ä¸Šé¢çš„GTIDçš„é›†åˆè®°å½•çš„æ˜¯ä¸»åº“è‡ªå·±å’Œå¤‡åº“çš„ä¸¤éƒ¨åˆ†ç»„æˆã€‚åœ¨ä¸»åº“ä¸Šé¢æ‰§è¡Œç©ºäº‹ç‰©æ—¶ç›´æ¥æŒ‡å®šå¤‡åº“çš„GTIDçš„å€¼å°±å¯ä»¥äº†","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1621928132,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":304486,"ip_address":""},"score":376012,"extra":""}]},{"author":{"id":1310826,"avatar":"https://static001.geekbang.org/account/avatar/00/14/00/6a/da96c764.jpg","nickname":"å°¹å¸Œé—¯","note":"","ucode":"A35F70179808D8","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":216434,"discussion_content":"ä¸»åº“ä¸Šä¸¢å¤±çš„æˆ–è€…åˆ é™¤çš„Binlogæ€ä¹ˆåŠï¼Ÿä»åº“ä¸Šä¹Ÿæ²¡æœ‰è¿™å†…å®¹ï¼Œä¸»åº“åˆ æ‰äº† ï¼Œè™½ç„¶gtidä¼šæ¢å¤ä¸€è‡´ï¼Œä½†æ˜¯æ‰§è¡Œå®Œæˆçš„äº‹åŠ¡logä¸¢å¤±äº†ï¼Œæ€ä¹ˆåŠï¼Ÿ","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1585450599,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":2,"child_discussions":[{"author":{"id":1367546,"avatar":"https://static001.geekbang.org/account/avatar/00/14/dd/fa/6108000a.jpg","nickname":"Matzoh","note":"","ucode":"E92D6035230CDE","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":1310826,"avatar":"https://static001.geekbang.org/account/avatar/00/14/00/6a/da96c764.jpg","nickname":"å°¹å¸Œé—¯","note":"","ucode":"A35F70179808D8","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":269726,"discussion_content":"é‚£åº”è¯¥å°±è¦è€ƒè™‘ é‡åšä»åº“","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1589942158,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":216434,"ip_address":""},"score":269726,"extra":""},{"author":{"id":1970443,"avatar":"http://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTIx1V1QAxC4NHaxYZGyuibBN8lcURJWc5nrnO4yic1kxnDemYV2FJGialf47kYX9qtDnZZOfe1SJeLicg/132","nickname":"lleft","note":"","ucode":"D573EB509455AE","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":1310826,"avatar":"https://static001.geekbang.org/account/avatar/00/14/00/6a/da96c764.jpg","nickname":"å°¹å¸Œé—¯","note":"","ucode":"A35F70179808D8","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":376013,"discussion_content":"å°±çœ‹ä½ çš„éœ€æ±‚ï¼Œè¦æ˜¯è¦ä¸»å¤‡ä¸€è‡´ï¼Œå°±éœ€è¦é‡æ–°æ­å»ºå¤‡åº“ï¼›å¦‚æœä¸éœ€è¦ä¸»å¤‡ä¸€è‡´ï¼Œä»æŒ‡å®šçš„GTIDå¤åˆ¶çš„è¯ï¼Œåªéœ€è¦åœ¨è¢«å¤‡åº“ä¸Šé¢æŒ‡å®šå‚æ•°gtid_purgedï¼Œé‚£ä¹ˆå¤‡åº“å°±ä¼šä»è¯¥å‚æ•°æŒ‡å®šçš„gtidå‘åå¤åˆ¶ã€‚","likes_number":1,"is_delete":false,"is_hidden":false,"ctime":1621928245,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":216434,"ip_address":""},"score":376013,"extra":""}]}]},{"had_liked":false,"id":61707,"user_name":"Mr.Strive.Z.H.L","can_delete":false,"product_type":"c1","uid":1030198,"ip_address":"","ucode":"6D97E159E2EECD","user_header":"https://static001.geekbang.org/account/avatar/00/0f/b8/36/542c96bf.jpg","comment_is_top":false,"comment_ctime":1547778795,"is_pvip":false,"replies":[{"id":"21901","content":"å“ˆå“ˆï¼Œyou got it","user_name":"ä½œè€…å›å¤","comment_id":61707,"uid":"1264162","ip_address":"","utype":1,"ctime":1547782953,"user_name_real":"æ—æ™“æ–Œ"}],"discussion_count":1,"race_medal":0,"score":"117511895787","product_id":100020801,"comment_content":"è€å¸ˆæ‚¨å¥½ï¼š<br>ä¹‹å‰è®²è¿‡ äº’ä¸ºä¸»å¤‡ çš„åœºæ™¯ä¸‹ï¼Œä¼šå‡ºç°å¾ªç¯å¤åˆ¶çš„é—®é¢˜ï¼Œä»Šå¤©è¿™èŠ‚è®²äº†GTIDã€‚<br>å¦‚æœä½¿ç”¨GTIDï¼Œé‚£ä¹ˆ å¾ªç¯å¤åˆ¶ çš„é—®é¢˜è‡ªç„¶è€Œç„¶å°±è§£å†³äº†å‘€ï¼Ÿï¼Ÿï¼ï¼","like_count":28,"discussions":[{"author":{"id":1264162,"avatar":"https://static001.geekbang.org/account/avatar/00/13/4a/22/2681d602.jpg","nickname":"æ—æ™“æ–Œ","note":"","ucode":"CDE42D44F26240","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":436964,"discussion_content":"å“ˆå“ˆï¼Œyou got it","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1547782953,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":68250,"user_name":"Lukia","can_delete":false,"product_type":"c1","uid":1028698,"ip_address":"","ucode":"C19472337BCCC6","user_header":"https://static001.geekbang.org/account/avatar/00/0f/b2/5a/574f5bb0.jpg","comment_is_top":false,"comment_ctime":1550467853,"is_pvip":false,"replies":[{"id":"25210","content":"å—¯ï¼Œå¤šä¸€è·³ç¡®å®æ˜¯åº”è¯¥å¤š1åˆ†é’Ÿï¼Œåœ¨cçš„æœ€é•¿å»¶è¿Ÿæ—¶é—´åº”è¯¥æ˜¯2åˆ†é’Ÿ","user_name":"ä½œè€…å›å¤","comment_id":68250,"uid":"1264162","ip_address":"","utype":1,"ctime":1551156732,"user_name_real":"æ—æ™“æ–Œ"}],"discussion_count":3,"race_medal":0,"score":"83154846477","product_id":100020801,"comment_content":"å¯¹äºè€å¸ˆä¹‹å‰å¯¹å…¶ä»–ä»–åŒå­¦çš„å›ç­”è¿˜æœ‰ä¸€ç‚¹ç–‘é—®éœ€è¦è¯·æ•™ä¸€ä¸‹ï¼š<br><br>Master Aä¸Šçš„binlogæ—¶é—´ä¸æ˜¯åœ¨äº‹ç‰©commitä¹‹å‰å†™binlogçš„æ—¶é—´å—ï¼Œé‚£ä¹ˆåœ¨ä»èŠ‚ç‚¹Cä¸Šçš„SBMæœ€å¤§å€¼ä¸åº”è¯¥æ˜¯2åˆ†é’Ÿå—ï¼Ÿï¼ˆæŒ‰3åˆ†é’Ÿçš„ç­”æ¡ˆæ¥è¯´ï¼ŒMaster Aä¸Šæ‰§è¡Œçš„1åˆ†é’Ÿä¸ºå•¥è¦ç®—è¿›å»å‘¢ï¼Ÿï¼‰<br><br>çœ‹è¿‡ä¸Šç¯‡åæƒ³åˆ°ä¸€ä¸ªé—®é¢˜:<br>çº§è”å¤åˆ¶A-&gt;B-&gt;Cç»“æ„ä¸‹, ä»åº“Cçš„Seconds_Behind_Masterçš„æ—¶é—´è®¡ç®—é—®é¢˜.<br>å‡å®šå½“å‰ä¸»åº“Aä»…æœ‰ä¸€ä¸ªDDLè¦è¿›è¡Œå˜æ›´,è€—æ—¶1åˆ†é’Ÿ.é‚£ä¹ˆä»åº“Cçš„SBMå€¼æœ€å¤§åº”è¯¥æ˜¯å¤šå°‘æ—¶é—´?<br>æ˜¯1åˆ†é’Ÿ, 2åˆ†é’Ÿ, è¿˜æ˜¯3åˆ†é’Ÿå‘¢ ?<br>å¸¦ç€ç–‘é—®çœ‹äº†ä¸€ä¸‹æµ‹è¯•ä»åº“Cçš„binlogæ–‡ä»¶ä¸­çš„æ—¶é—´æˆ³,å¾—å‡ºç»“è®ºåº”è¯¥æ˜¯3åˆ†é’Ÿ.<br><br>æ‰“ç ´ä¹‹å‰è®¤çŸ¥ ğŸ¤¦â€â™€ï¸ . è¯·è€å¸ˆè§£æƒ‘ , è°¢è°¢ !<br>ä½œè€…å›å¤: æ˜¯çš„ï¼Œå› ä¸ºç®—çš„æ˜¯ï¼šå½“å‰æ‰§è¡Œæ—¶é—´ï¼Œè·Ÿ*æ—¥å¿—æ—¶é—´*çš„å·®è·<br><br>è€Œè¿™ä¸ªæ—¥å¿—æ—¶é—´ï¼Œæ˜¯åœ¨Aä¸Šæ‰§è¡Œå‡ºæ¥çš„ã€‚<br><br>å¥½é—®é¢˜ï¼Œå¾ˆå¥½çš„éªŒè¯è¿‡ç¨‹ã€‚<br><br><br>","like_count":19,"discussions":[{"author":{"id":1264162,"avatar":"https://static001.geekbang.org/account/avatar/00/13/4a/22/2681d602.jpg","nickname":"æ—æ™“æ–Œ","note":"","ucode":"CDE42D44F26240","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":439588,"discussion_content":"å—¯ï¼Œå¤šä¸€è·³ç¡®å®æ˜¯åº”è¯¥å¤š1åˆ†é’Ÿï¼Œåœ¨cçš„æœ€é•¿å»¶è¿Ÿæ—¶é—´åº”è¯¥æ˜¯2åˆ†é’Ÿ","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1551156732,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1650748,"avatar":"https://static001.geekbang.org/account/avatar/00/19/30/3c/0668d6ae.jpg","nickname":"ç›˜èƒ§","note":"","ucode":"5386CC4C92ECC2","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":408672,"discussion_content":"2åˆ†é’Ÿã€‚Aæ‰§è¡Œä¸ç®—","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1635301165,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":2258388,"avatar":"","nickname":"Geek_7454d5","note":"","ucode":"D51F8011415139","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":382814,"discussion_content":"è¿™ä½œè€…å›å¤çš„ ä½ åˆ°åº•å›å¤çš„å‡ åˆ†é’Ÿæ‰æ˜¯æ­£ç¡®çš„","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1625730377,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":60552,"user_name":"mgxian","can_delete":false,"product_type":"c1","uid":1014806,"ip_address":"","ucode":"7B7E77E6A83B87","user_header":"https://static001.geekbang.org/account/avatar/00/0f/7c/16/4d1e5cc1.jpg","comment_is_top":false,"comment_ctime":1547511921,"is_pvip":false,"replies":[{"id":"21571","content":"å¥½é—®é¢˜ï¼ŒğŸ‘<br>åœ¨binlogæ–‡ä»¶å¼€å¤´ï¼Œæœ‰ä¸€ä¸ªPrevious_gtids, ç”¨äºè®°å½• â€œç”Ÿæˆè¿™ä¸ªbinlogçš„æ—¶å€™ï¼Œå®ä¾‹çš„Executed_gtid_setâ€, æ‰€ä»¥å¯åŠ¨çš„æ—¶å€™åªéœ€è¦è§£ææœ€åä¸€ä¸ªæ–‡ä»¶ï¼›<br><br>åŒæ ·çš„ï¼Œç”±äºæœ‰è¿™ä¸ªPrevious_gtidsï¼Œå¯ä»¥å¿«é€Ÿåœ°å®šä½GTIDåœ¨å“ªä¸ªæ–‡ä»¶é‡Œã€‚","user_name":"ä½œè€…å›å¤","comment_id":60552,"uid":"1264162","ip_address":"","utype":1,"ctime":1547518142,"user_name_real":"æ—æ™“æ–Œ"}],"discussion_count":1,"race_medal":0,"score":"83151890545","product_id":100020801,"comment_content":"è€å¸ˆæˆ‘æœ‰ä¸€ä¸ªé—®é¢˜ å¦‚æœæ•°æ®åº“å·²ç»æœ‰å®Œæˆäº†å¾ˆå¤šäº‹åŠ¡ å®ä¾‹ Aâ€™çš„ GTIDé›†åˆå’Œ å®ä¾‹ Bçš„ GTIDé›†åˆ æ˜¯ä¸æ˜¯å¾ˆå¤§ï¼Œè¿™ä¸ªGTIDæ˜¯ä»binglogé‡Œä¸€ç‚¹ä¸€ç‚¹çš„è§£æå‡ºæ¥æ‰€æœ‰çš„äº‹åŠ¡çš„å—ï¼Ÿè¿™æ ·æ˜¯ä¸æ˜¯ä¼šå¾ˆæ…¢ ï¼Ÿåœ¨æ‰€æœ‰binlogé‡Œå®šä½æŸä¸ªGTIDæ˜¯ä¸æ˜¯æ•ˆç‡ä¹Ÿå¾ˆä½","like_count":19,"discussions":[{"author":{"id":1264162,"avatar":"https://static001.geekbang.org/account/avatar/00/13/4a/22/2681d602.jpg","nickname":"æ—æ™“æ–Œ","note":"","ucode":"CDE42D44F26240","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":436535,"discussion_content":"å¥½é—®é¢˜ï¼ŒğŸ‘\nåœ¨binlogæ–‡ä»¶å¼€å¤´ï¼Œæœ‰ä¸€ä¸ªPrevious_gtids, ç”¨äºè®°å½• â€œç”Ÿæˆè¿™ä¸ªbinlogçš„æ—¶å€™ï¼Œå®ä¾‹çš„Executed_gtid_setâ€, æ‰€ä»¥å¯åŠ¨çš„æ—¶å€™åªéœ€è¦è§£ææœ€åä¸€ä¸ªæ–‡ä»¶ï¼›\n\nåŒæ ·çš„ï¼Œç”±äºæœ‰è¿™ä¸ªPrevious_gtidsï¼Œå¯ä»¥å¿«é€Ÿåœ°å®šä½GTIDåœ¨å“ªä¸ªæ–‡ä»¶é‡Œã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1547518142,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":64775,"user_name":"æ—¶éšæ—¶ç°","can_delete":false,"product_type":"c1","uid":1111899,"ip_address":"","ucode":"DA4D622FF84920","user_header":"https://static001.geekbang.org/account/avatar/00/10/f7/5b/d2e7c2c4.jpg","comment_is_top":false,"comment_ctime":1548905206,"is_pvip":false,"replies":[{"id":"22939","content":"æ˜¯çš„ï¼Œ<br>ä¸è¿‡reset masterè¿™ç§è¯­å¥ã€‚ã€‚å°±ç®—æ˜¯åŸºäºpositionçš„åè®®ï¼Œè°åœ¨çº¿ä¸Šä¸»åº“ä¸Šæ‰§è¡Œï¼Œä¹Ÿæ˜¯ç›´æ¥å½“åšåˆ æ•°æ®è®ºå¤„çš„äº†ğŸ˜…","user_name":"ä½œè€…å›å¤","comment_id":64775,"uid":"1264162","ip_address":"","utype":1,"ctime":1548923340,"user_name_real":"æ—æ™“æ–Œ"}],"discussion_count":2,"race_medal":0,"score":"65973414646","product_id":100020801,"comment_content":"å…¶å®åŸºäºgtidå¤åˆ¶æœ‰ä¸ªå¤§å‘ï¼Œåœ¨ä¸»åº“ä¸Šåƒä¸‡ä¸è¦æ‰§è¡Œreset masterï¼Œå¦åˆ™ä»åº“ä¸ä¼šæŠ¥é”™ï¼Œåªä¼šè·³è¿‡gno &lt; current_noçš„äº‹åŠ¡ï¼Œé€ æˆä¸€ä¸ªç°è±¡å°±æ˜¯ä¸»åº“å¤åˆ¶æ²¡æœ‰ä¸­æ–­ï¼Œä½†æ˜¯ä¸»åº“ä¸Šçš„æ•°æ®æ— æ³•åŒæ­¥åˆ°ä»åº“ã€‚","like_count":16,"discussions":[{"author":{"id":1264162,"avatar":"https://static001.geekbang.org/account/avatar/00/13/4a/22/2681d602.jpg","nickname":"æ—æ™“æ–Œ","note":"","ucode":"CDE42D44F26240","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":438172,"discussion_content":"æ˜¯çš„ï¼Œ\nä¸è¿‡reset masterè¿™ç§è¯­å¥ã€‚ã€‚å°±ç®—æ˜¯åŸºäºpositionçš„åè®®ï¼Œè°åœ¨çº¿ä¸Šä¸»åº“ä¸Šæ‰§è¡Œï¼Œä¹Ÿæ˜¯ç›´æ¥å½“åšåˆ æ•°æ®è®ºå¤„çš„äº†ğŸ˜…","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1548923340,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1624590,"avatar":"https://static001.geekbang.org/account/avatar/00/18/ca/0e/5009c5ff.jpg","nickname":"é‡è§","note":"","ucode":"FAF53CD4C28494","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":79007,"discussion_content":"è¿™ç§è¯­å¥å¯ä»¥é€šè¿‡é‡å†™æ¥é¿å…ä¹ˆ?å°±åƒredisçš„å‘½ä»¤é‡å†™ä¸€æ ·?æŠŠå±é™©çš„å‘½ä»¤é‡å†™, é˜²æ­¢äººä¸ºæ“ä½œå¤±è¯¯","likes_number":4,"is_delete":false,"is_hidden":false,"ctime":1576045068,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":60669,"user_name":"fuyu","can_delete":false,"product_type":"c1","uid":1012551,"ip_address":"","ucode":"E2D00651A70E27","user_header":"http://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTIKVicSvNf6OFvv4m3ibfsYCIUxic41kODPa9cuGUJjPcBtryLBDljalIVUiaJKlkGEJtOMZ03XSFlx1w/132","comment_is_top":false,"comment_ctime":1547528143,"is_pvip":false,"replies":[{"id":"21664","content":"å¤§æ²¡å…³ç³»å‘€ï¼Œæ˜¯åˆ†æ®µçš„ï¼Œæ¯”å¦‚ server_uuid_of_a:1-1000000ï¼Œå°±ä¸€ä¸ªæ®µ","user_name":"ä½œè€…å›å¤","comment_id":60669,"uid":"1264162","ip_address":"","utype":1,"ctime":1547551576,"user_name_real":"æ—æ™“æ–Œ"}],"discussion_count":1,"race_medal":0,"score":"48792168399","product_id":100020801,"comment_content":"seta å’Œ setb é‡Œçš„é›†åˆå¤§å°ä¸ä¼šå¾ˆå¤§ï¼Ÿ","like_count":12,"discussions":[{"author":{"id":1264162,"avatar":"https://static001.geekbang.org/account/avatar/00/13/4a/22/2681d602.jpg","nickname":"æ—æ™“æ–Œ","note":"","ucode":"CDE42D44F26240","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":436576,"discussion_content":"å¤§æ²¡å…³ç³»å‘€ï¼Œæ˜¯åˆ†æ®µçš„ï¼Œæ¯”å¦‚ server_uuid_of_a:1-1000000ï¼Œå°±ä¸€ä¸ªæ®µ","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1547551576,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":59765,"user_name":"å¤§å¤","can_delete":false,"product_type":"c1","uid":1246962,"ip_address":"","ucode":"48CA8F926F134F","user_header":"https://static001.geekbang.org/account/avatar/00/13/06/f2/1f511b7f.jpg","comment_is_top":false,"comment_ctime":1547425009,"is_pvip":false,"replies":[{"id":"21485","content":"è¿™ä¸ªæƒ³æ³•å¾ˆä¸é”™ ğŸ‘","user_name":"ä½œè€…å›å¤","comment_id":59765,"uid":"1264162","ip_address":"","utype":1,"ctime":1547432619,"user_name_real":"æ—æ™“æ–Œ"}],"discussion_count":1,"race_medal":0,"score":"40202130673","product_id":100020801,"comment_content":"ä»Šå¤©é—®é¢˜å›ç­”ï¼Œç”±äºGTIDå…·æœ‰å…¨å±€å”¯ä¸€æ€§ï¼Œé‚£ä¹ˆå…¶å®ƒæ­£å¸¸çš„gtidå·²ç»è¢«å¤åˆ¶åˆ°äº†å…¶ä»–ä»åº“ä¸Šäº†ï¼Œåªéœ€è¦åˆ‡æ¢gtidåˆ°å…¶ä»–ä»åº“ï¼Œç­‰å¾…åŒæ­¥å®Œæ¯•ååœ¨åˆ‡æ¢å›ä¸»åº“å³å¯","like_count":9,"discussions":[{"author":{"id":1264162,"avatar":"https://static001.geekbang.org/account/avatar/00/13/4a/22/2681d602.jpg","nickname":"æ—æ™“æ–Œ","note":"","ucode":"CDE42D44F26240","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":436391,"discussion_content":"è¿™ä¸ªæƒ³æ³•å¾ˆä¸é”™ ğŸ‘","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1547432619,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":60266,"user_name":"PengfeiWang","can_delete":false,"product_type":"c1","uid":1308369,"ip_address":"","ucode":"C877BBE99192B2","user_header":"https://static001.geekbang.org/account/avatar/00/13/f6/d1/dcafd7cf.jpg","comment_is_top":false,"comment_ctime":1547453160,"is_pvip":false,"replies":[{"id":"21550","content":"ä½ è¿™ä¸ªæ˜¯å¥½é—®é¢˜ï¼Œ<br><br>ç¡®å®åªæ˜¯è·³è¿‡ä¸€ä¸ªeventï¼Œä¸è¿‡æ–‡æ¡£ä¸­è¯´äº†å‘€<br>â€œthe slave continues to skip events until it reaches the end of the group. â€ï¼Œ <br>æ‰€ä»¥æ•ˆæœä¸Šç­‰æ•ˆäºè·³è¿‡ä¸€ä¸ªäº‹åŠ¡å“¦","user_name":"ä½œè€…å›å¤","comment_id":60266,"uid":"1264162","ip_address":"","utype":1,"ctime":1547461918,"user_name_real":"æ—æ™“æ–Œ"}],"discussion_count":1,"race_medal":0,"score":"35907191528","product_id":100020801,"comment_content":"è€å¸ˆï¼Œæ‚¨å¥½ï¼š æ–‡ä¸­å¯¹äºsql_slave_skip_counter=1çš„ç†è§£ä¼¼ä¹æœ‰åå·®ï¼Œå®˜æ–¹æ–‡æ¡£ä¸­çš„è§£é‡Šæ˜¯ï¼š<br>When you use SET GLOBAL sql_slave_skip_counter to skip events and the result is in the middle of a group, the slave continues to skip events until it reaches the end of the group. Execution then starts with the next event group.<br>æŒ‰ç…§å®˜æ–¹æ–‡æ¡£çš„è§£é‡Šï¼Œå‘½ä»¤sql_slave_skip_counter=1 åº”è¯¥æ˜¯è·³è¿‡ä¸€ä¸ªäº‹åŠ¡ä¸­çš„1ä¸ªeventï¼Œé™¤éè¿™ä¸ªäº‹åŠ¡æ˜¯æœ‰å•ä¸ªeventç»„æˆçš„ï¼Œæ‰ä¼šè·³è¿‡ä¸€ä¸ªäº‹åŠ¡ã€‚<br> ","like_count":9,"discussions":[{"author":{"id":1264162,"avatar":"https://static001.geekbang.org/account/avatar/00/13/4a/22/2681d602.jpg","nickname":"æ—æ™“æ–Œ","note":"","ucode":"CDE42D44F26240","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":436462,"discussion_content":"ä½ è¿™ä¸ªæ˜¯å¥½é—®é¢˜ï¼Œ\n\nç¡®å®åªæ˜¯è·³è¿‡ä¸€ä¸ªeventï¼Œä¸è¿‡æ–‡æ¡£ä¸­è¯´äº†å‘€\nâ€œthe slave continues to skip events until it reaches the end of the group. â€ï¼Œ \næ‰€ä»¥æ•ˆæœä¸Šç­‰æ•ˆäºè·³è¿‡ä¸€ä¸ªäº‹åŠ¡å“¦","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1547461918,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":61154,"user_name":"æ˜¥å›°ç§‹ä¹å¤æ‰“ç›¹","can_delete":false,"product_type":"c1","uid":1210807,"ip_address":"","ucode":"CCC558EF504F4B","user_header":"https://static001.geekbang.org/account/avatar/00/12/79/b7/989824f7.jpg","comment_is_top":false,"comment_ctime":1547628376,"is_pvip":false,"replies":[{"id":"21776","content":"å¯¹çš„<br>æ€»ä¹‹å°±æ˜¯ï¼Œä¸€ä¸ªä¸»å¤‡å…³ç³»é‡Œï¼Œå¤‡åº“çš„GTIDé›†åˆåº”è¯¥åŒ…å«ä¸»åº“çš„GTIDé›†åˆã€‚","user_name":"ä½œè€…å›å¤","comment_id":61154,"uid":"1264162","ip_address":"","utype":1,"ctime":1547632316,"user_name_real":"æ—æ™“æ–Œ"}],"discussion_count":1,"race_medal":0,"score":"31612399448","product_id":100020801,"comment_content":"å›ç­”undifinedçš„ç¬¬äºŒä¸ªé—®é¢˜<br>A-A&#39;-Bè¿™æ ·çš„çº§è”ç»“æ„<br>A (binlogï¼šA:1-M)<br>A&#39;(binlog:   A:1-M,B:1-N) ,A&#39;ä¸Šé¢çš„æ“ä½œè®°ä¸ºB:1-N<br>B (binlog:   A:1-M,B:1-N,C:1-X) Bä¸Šé¢çš„æ“ä½œè®°ä¸ºC:1-X<br>---A,B,Cåˆ†åˆ«ä¸ºA-A&#39;-Bçš„uuid","like_count":7,"discussions":[{"author":{"id":1264162,"avatar":"https://static001.geekbang.org/account/avatar/00/13/4a/22/2681d602.jpg","nickname":"æ—æ™“æ–Œ","note":"","ucode":"CDE42D44F26240","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":436764,"discussion_content":"å¯¹çš„\næ€»ä¹‹å°±æ˜¯ï¼Œä¸€ä¸ªä¸»å¤‡å…³ç³»é‡Œï¼Œå¤‡åº“çš„GTIDé›†åˆåº”è¯¥åŒ…å«ä¸»åº“çš„GTIDé›†åˆã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1547632316,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":105082,"user_name":"çµçŠ€andy","can_delete":false,"product_type":"c1","uid":1334527,"ip_address":"","ucode":"3C3C36B070676C","user_header":"http://thirdwx.qlogo.cn/mmopen/vi_32/WuVCibYmuGqFLnfIrr0BmkdzHwkialB0DibJ0YnymNNO2Wicy76ZxSvjD66sPVsd9SjkicSS4Z2iadTeOn7zGfwh9sxg/132","comment_is_top":false,"comment_ctime":1560913072,"is_pvip":false,"replies":[{"id":"38146","content":"dockerä¸­è·‘MySQLæ²¡é—®é¢˜çš„~","user_name":"ä½œè€…å›å¤","comment_id":105082,"uid":"1264162","ip_address":"","utype":1,"ctime":1560998173,"user_name_real":"æ—æ™“æ–Œ"}],"discussion_count":1,"race_medal":0,"score":"23035749552","product_id":100020801,"comment_content":"æ—è€å¸ˆï¼Œæˆ‘æ˜¯çœ‹äº†å¾ˆä¹…äº†æ‚¨çš„ä¸“æ çš„ä¸€ä½ç²‰ä¸ï¼Œæœ€è¿‘æˆ‘ä»¬è®¡åˆ’åœ¨dockerä¸­è·‘mysqlï¼Œä½†æ˜¯æˆ‘è§‰çš„dockerä¸­è¿ç»´mysqlå¤ªéº»çƒ¦äº†ï¼Œxtrabackupå·¥å…·å¥½åƒåœ¨dockerä¸­å°±æ— æ³•å®‰è£…ã€‚è¿˜æœ‰ä¸»ä»,MHAç­‰ï¼Œè¯·é—®dockerä¸­é€‚åˆè·‘mysqlå—ï¼Œä¼˜ç‚¹å’Œç¼ºç‚¹æ˜¯ä»€ä¹ˆï¼Ÿ","like_count":6,"discussions":[{"author":{"id":1264162,"avatar":"https://static001.geekbang.org/account/avatar/00/13/4a/22/2681d602.jpg","nickname":"æ—æ™“æ–Œ","note":"","ucode":"CDE42D44F26240","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":454553,"discussion_content":"dockerä¸­è·‘MySQLæ²¡é—®é¢˜çš„~","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1560998173,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":59935,"user_name":"äº®","can_delete":false,"product_type":"c1","uid":1086346,"ip_address":"","ucode":"5B8E59AEA6E3F2","user_header":"https://static001.geekbang.org/account/avatar/00/10/93/8a/abb7bfe3.jpg","comment_is_top":false,"comment_ctime":1547431996,"is_pvip":false,"replies":[{"id":"21487","content":"è¿™ç§æƒ…å†µä¸‹ï¼Œä¸å¯èƒ½ä¸šåŠ¡å®Œå…¨æ— æ„ŸçŸ¥ï¼Œ<br><br>ä½†æ˜¯å¦‚æœä¸šåŠ¡ä»£ç æœ‰â€œé‡è¿å¹¶é‡è¯•â€çš„é€»è¾‘ï¼Œå¹¶ä¸”åˆ‡æ¢è¶³å¤Ÿå¿«ï¼Œå°±å¯ä»¥å¯¹ä¸šåŠ¡æ— å½±å“ï¼Œå‰ææ˜¯è¦è§£å†³ä¸»å¤‡å»¶è¿Ÿé—®é¢˜ï¼Œå°±æ˜¯25ã€26ä¸¤ç¯‡æåˆ°çš„","user_name":"ä½œè€…å›å¤","comment_id":59935,"uid":"1264162","ip_address":"","utype":1,"ctime":1547436322,"user_name_real":"æ—æ™“æ–Œ"}],"discussion_count":1,"race_medal":0,"score":"18727301180","product_id":100020801,"comment_content":"è€å¸ˆæ‚¨å¥½ï¼Œå‡å¦‚aå®•æœºäº†ï¼Œéœ€è¦æŠŠä»åˆ‡æ¢åˆ°a&#39;ï¼Œè¿™æ—¶å€™ä¸šåŠ¡å·²ç»æœ‰æ„ŸçŸ¥äº†å§ï¼Ÿæ€ä¹ˆèƒ½è®©ä¸šåŠ¡å°½é‡æ²¡æœ‰æ„ŸçŸ¥å‘¢ï¼Ÿè°¢è°¢è€å¸ˆ","like_count":4,"discussions":[{"author":{"id":1264162,"avatar":"https://static001.geekbang.org/account/avatar/00/13/4a/22/2681d602.jpg","nickname":"æ—æ™“æ–Œ","note":"","ucode":"CDE42D44F26240","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":436419,"discussion_content":"è¿™ç§æƒ…å†µä¸‹ï¼Œä¸å¯èƒ½ä¸šåŠ¡å®Œå…¨æ— æ„ŸçŸ¥ï¼Œ\n\nä½†æ˜¯å¦‚æœä¸šåŠ¡ä»£ç æœ‰â€œé‡è¿å¹¶é‡è¯•â€çš„é€»è¾‘ï¼Œå¹¶ä¸”åˆ‡æ¢è¶³å¤Ÿå¿«ï¼Œå°±å¯ä»¥å¯¹ä¸šåŠ¡æ— å½±å“ï¼Œå‰ææ˜¯è¦è§£å†³ä¸»å¤‡å»¶è¿Ÿé—®é¢˜ï¼Œå°±æ˜¯25ã€26ä¸¤ç¯‡æåˆ°çš„","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1547436322,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":72164,"user_name":"é»„ç»§ç«‹","can_delete":false,"product_type":"c1","uid":1201686,"ip_address":"","ucode":"18948D6458E719","user_header":"https://static001.geekbang.org/account/avatar/00/12/56/16/f8b22bf5.jpg","comment_is_top":false,"comment_ctime":1551530550,"is_pvip":false,"replies":[{"id":"26171","content":"1. è¿™ä¸ªå¯èƒ½æ˜¯ä¹‹å‰å°±å­˜åœ¨ç©ºæ´ï¼Œè¦æå‰å¤„ç†gtidç©ºæ´ï¼ˆå°±æ˜¯ä¸è¿ç»­çš„æƒ…å†µï¼‰<br>2. å¦‚æœä½¿ç”¨å¯é æ€§ä¼˜å…ˆï¼Œå»¶è¿Ÿæ˜¯ä¼šå¯¼è‡´åˆ‡æ¢æ…¢çš„ï¼Œå»¶è¿Ÿçš„åŸå› è¦å…·ä½“çœ‹<br>3. è·Ÿ1å¯èƒ½æ˜¯ç±»å‹çš„æƒ…å†µ","user_name":"ä½œè€…å›å¤","comment_id":72164,"uid":"1264162","ip_address":"","utype":1,"ctime":1551576743,"user_name_real":"æ—æ™“æ–Œ"}],"discussion_count":1,"race_medal":0,"score":"14436432438","product_id":100020801,"comment_content":"æ‚¨å¥½ï¼š<br>       æ„Ÿè°¢æ‚¨çš„åˆ†äº«ï¼Œé€šè¿‡GTID å¾ˆå¥½çš„ä¸»ä»åˆ‡æ¢ï¼Œæˆ‘è¿™è¾¹çº¿ä¸Šåˆ‡æ¢æ—¶é‡åˆ°è¿‡3ä¸ªé—®é¢˜ï¼š1: ä¸»åº“æ•…éšœé£˜é€¸VIP ï¼Œä»åº“åŒæ­¥master_ipï¼šVIPï¼Œ ä½†æ˜¯æœ‰æ—¶å€™ä¼šå¦‚æœVIP é£˜é€¸åˆ°æ–°ä»åº“ä¸Šé¢ï¼Œä»åº“ä¼šæŠ¥é”™1236ã€‚ 2: ä»åº“å»¶è¿Ÿç¬é—´ä¼šå¾ˆé«˜ï¼Œéœ€è¦æ‰‹åŠ¨stop slave ,start slave åŒæ—¶ä¸»ä»åˆ‡æ¢é€Ÿåº¦è¿‡æ…¢ï¼Œå¯¼è‡´ä¸»ä»ç»“æ„æ¢å¤è¿‡æ…¢ã€‚ 3: é€šè¿‡GTID åˆ‡æ¢ ä»åº“ç›´æ¥æŠ¥1236 é”™è¯¯ã€‚ <br><br>ä»¥ä¸Šæˆ‘è¿™è¾¹è§£å†³æ–¹å¼ï¼šä¸»åŠ¨åˆ‡æ¢æ—¶å…ˆä¸»åŠ¨åˆ‡æ¢ï¼Œåˆ‡æ¢åˆ¤æ–­æ‰€æœ‰ä»èŠ‚ç‚¹æ­£å¸¸ï¼ŒæˆåŠŸåé£˜é€¸VIPï¼Œä¸šåŠ¡é€šè¿‡VIP è¿æ¥æ–°ä¸»ã€‚è¿™æ ·ç›´æ¥è§£å†³äº†åç»­ä¸¤ä¸ªé—®é¢˜ã€‚","like_count":3,"discussions":[{"author":{"id":1264162,"avatar":"https://static001.geekbang.org/account/avatar/00/13/4a/22/2681d602.jpg","nickname":"æ—æ™“æ–Œ","note":"","ucode":"CDE42D44F26240","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":441486,"discussion_content":"1. è¿™ä¸ªå¯èƒ½æ˜¯ä¹‹å‰å°±å­˜åœ¨ç©ºæ´ï¼Œè¦æå‰å¤„ç†gtidç©ºæ´ï¼ˆå°±æ˜¯ä¸è¿ç»­çš„æƒ…å†µï¼‰\n2. å¦‚æœä½¿ç”¨å¯é æ€§ä¼˜å…ˆï¼Œå»¶è¿Ÿæ˜¯ä¼šå¯¼è‡´åˆ‡æ¢æ…¢çš„ï¼Œå»¶è¿Ÿçš„åŸå› è¦å…·ä½“çœ‹\n3. è·Ÿ1å¯èƒ½æ˜¯ç±»å‹çš„æƒ…å†µ","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1551576743,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":60256,"user_name":"PengfeiWang","can_delete":false,"product_type":"c1","uid":1308369,"ip_address":"","ucode":"C877BBE99192B2","user_header":"https://static001.geekbang.org/account/avatar/00/13/f6/d1/dcafd7cf.jpg","comment_is_top":false,"comment_ctime":1547452259,"is_pvip":false,"replies":[{"id":"21544","content":"çœ‹ä¸€ä¸‹è¿™ä¸ªè¯­å¥çš„ç»“æœ, ä¼šå—è¿™å‡ ä¸ªå‚æ•°çš„å½±å“å“ˆ<br>select * from information_schema.GLOBAL_VARIABLES where VARIABLE_NAME in (&#39;master_info_repository&#39;,&#39;relay_log_info_repository&#39;,&#39;sync_master_info&#39;,&#39;sync_relay_log_info&#39;, &#39;sync_binlog&#39;, &#39;innodb_flush_log_at_trx_commit&#39;);<br>","user_name":"ä½œè€…å›å¤","comment_id":60256,"uid":"1264162","ip_address":"","utype":1,"ctime":1547456946,"user_name_real":"æ—æ™“æ–Œ"}],"discussion_count":2,"race_medal":0,"score":"14432354147","product_id":100020801,"comment_content":"è€å¸ˆï¼Œä½ å¥½ï¼šåœ¨ç”Ÿäº§ç¯å¢ƒï¼ˆåŸºäºä½ç‚¹çš„ä¸»å¤‡åˆ‡æ¢ï¼‰ä¸­ï¼Œç»å¸¸ä¼šé‡åˆ°è¿™æ ·çš„åœºæ™¯ï¼šå¤‡åº“ç”±äºç¡¬ä»¶æˆ–å…¶ä»–åŸå› å¼‚å¸¸å®•æœºï¼Œæ¢å¤åé‡å¯å¤‡åº“ï¼Œæ‰§è¡Œstart slaveå‘½ä»¤ï¼Œæ€»ä¼šé‡åˆ°1062ä¸»é”®é‡å¤çš„æŠ¥é”™ï¼Œä¸€ç›´è§£é‡Šä¸æ¸…æ¥šä¸ºä»€ä¹ˆï¼Ÿ","like_count":3,"discussions":[{"author":{"id":1264162,"avatar":"https://static001.geekbang.org/account/avatar/00/13/4a/22/2681d602.jpg","nickname":"æ—æ™“æ–Œ","note":"","ucode":"CDE42D44F26240","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":436461,"discussion_content":"çœ‹ä¸€ä¸‹è¿™ä¸ªè¯­å¥çš„ç»“æœ, ä¼šå—è¿™å‡ ä¸ªå‚æ•°çš„å½±å“å“ˆ\nselect * from information_schema.GLOBAL_VARIABLES where VARIABLE_NAME in (&amp;#39;master_info_repository&amp;#39;,&amp;#39;relay_log_info_repository&amp;#39;,&amp;#39;sync_master_info&amp;#39;,&amp;#39;sync_relay_log_info&amp;#39;, &amp;#39;sync_binlog&amp;#39;, &amp;#39;innodb_flush_log_at_trx_commit&amp;#39;);\n","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1547456946,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1970443,"avatar":"http://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTIx1V1QAxC4NHaxYZGyuibBN8lcURJWc5nrnO4yic1kxnDemYV2FJGialf47kYX9qtDnZZOfe1SJeLicg/132","nickname":"lleft","note":"","ucode":"D573EB509455AE","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":293021,"discussion_content":"æŠŠå¤åˆ¶å’Œæ‰§è¡Œåˆ°çš„ä½ç½®è®°å½•åˆ°è¡¨ä¸­ï¼Œè€Œéæ–‡ä»¶ä¸­ã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1595414157,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":60075,"user_name":"undifined","can_delete":false,"product_type":"c1","uid":1068920,"ip_address":"","ucode":"449CB4CD2DC089","user_header":"https://static001.geekbang.org/account/avatar/00/10/4f/78/c3d8ecb0.jpg","comment_is_top":false,"comment_ctime":1547441117,"is_pvip":false,"replies":[{"id":"21733","content":"1. è¿™ä¸ªä¹Ÿæ˜¯å¼‚æ­¥å¤åˆ¶å¯¼è‡´çš„ï¼Œåªæœ‰semi-syncèƒ½è§£äº†ã€‚ã€‚<br>2. ä¸æ˜¯å“¦ï¼Œå¦‚æœâ€œ A æ˜¯ä¸»åº“ï¼ŒA&#39; å¤‡åº“ï¼ŒB æ˜¯ A&#39;çš„ä»åº“â€ï¼Œé‚£æ‰€æœ‰Açš„æ›´æ–°ä¹Ÿéƒ½ä¼šé€šè¿‡A&#39;ä¼ ç»™Bï¼Œæ‰€ä»¥Bçš„GTIDé›†åˆæ­£å¸¸å°±æ˜¯åŒ…å«äº†Aå’ŒA&#39;çš„<br>3. â€œå¦‚æœåªæœ‰ä¸€ä¸»ä¸€ä»ï¼Œæœ‰ binlog ä¸¢å¤±â€ï¼Œæ˜¯çš„ï¼Œå°±åªæœ‰å¤‡åº“é‡åšäº†","user_name":"ä½œè€…å›å¤","comment_id":60075,"uid":"1264162","ip_address":"","utype":1,"ctime":1547605760,"user_name_real":"æ—æ™“æ–Œ"}],"discussion_count":1,"race_medal":0,"score":"14432343005","product_id":100020801,"comment_content":"è€å¸ˆ æœ‰å‡ ä¸ªé—®é¢˜ï¼š<br>1. ä¼šä¸ä¼šå‡ºç°ä¸»åº“åˆ‡æ¢åï¼ŒB ä¸­å·²ç»æ‰§è¡Œè¿‡çš„äº‹åŠ¡ï¼Œè€Œ A&#39;ç”±äºç½‘ç»œå»¶è¿Ÿè¿˜æ²¡æœ‰æ”¶åˆ°ï¼Œæ­¤æ—¶å·²ç»å¯¹ B æ‰§è¡Œåˆ‡æ¢ä¸»åº“ï¼Œè¿™æ—¶å€™ï¼ŒB ä¸­æœ‰è¯¥ GTIDï¼Œä½†æ˜¯ A&#39;ä¸­æ²¡æœ‰ï¼Œè¿™ç§æƒ…å†µä¼šæ€ä¹ˆå¤„ç†<br>2. å¦‚æœ A æ˜¯ä¸»åº“ï¼ŒA&#39; å¤‡åº“ï¼ŒB æ˜¯ A&#39;çš„ä»åº“ï¼Œæ­¤æ—¶ B çš„ GTID é›†åˆåº”è¯¥æ˜¯ server_uuid_of_A&#39;:1-Nï¼Œæ­¤æ—¶ A&#39;å®•æœºï¼ŒB æ”¹ä¸ºç›‘å¬ Aï¼Œè¿™æ—¶å€™A å’Œ B çš„ GTID é›†åˆæ²¡æœ‰äº¤é›†ï¼Œä¼šä¸ä¼šå‘ç”Ÿ A å°†æ‰€æœ‰çš„binlog é‡æ–°å‘ç»™B<br>3. æ€è€ƒé¢˜æˆ‘çš„ç†è§£æ˜¯ä»ä¸»åº“ä¸­ dump å‡ºç›¸å…³çš„æ•°æ®ï¼Œåœ¨å¤‡åº“ä¸­æ‰§è¡Œåå†æ¬¡æ‰§è¡Œ start slaveï¼›è¯„è®ºä¸­è¯´åˆ°ä»å…¶ä»–ä»åº“è·å–ï¼Œä½†æ˜¯å¦‚æœåªæœ‰ä¸€ä¸»ä¸€ä»ï¼Œæœ‰ binlog ä¸¢å¤±ï¼Œæ˜¯ä¸æ˜¯åªè¦ dump æ–‡ä»¶æ¢å¤è¿™ä¸€ä¸ªåŠæ³•","like_count":3,"discussions":[{"author":{"id":1264162,"avatar":"https://static001.geekbang.org/account/avatar/00/13/4a/22/2681d602.jpg","nickname":"æ—æ™“æ–Œ","note":"","ucode":"CDE42D44F26240","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":436444,"discussion_content":"1. è¿™ä¸ªä¹Ÿæ˜¯å¼‚æ­¥å¤åˆ¶å¯¼è‡´çš„ï¼Œåªæœ‰semi-syncèƒ½è§£äº†ã€‚ã€‚\n2. ä¸æ˜¯å“¦ï¼Œå¦‚æœâ€œ A æ˜¯ä¸»åº“ï¼ŒA&amp;#39; å¤‡åº“ï¼ŒB æ˜¯ A&amp;#39;çš„ä»åº“â€ï¼Œé‚£æ‰€æœ‰Açš„æ›´æ–°ä¹Ÿéƒ½ä¼šé€šè¿‡A&amp;#39;ä¼ ç»™Bï¼Œæ‰€ä»¥Bçš„GTIDé›†åˆæ­£å¸¸å°±æ˜¯åŒ…å«äº†Aå’ŒA&amp;#39;çš„\n3. â€œå¦‚æœåªæœ‰ä¸€ä¸»ä¸€ä»ï¼Œæœ‰ binlog ä¸¢å¤±â€ï¼Œæ˜¯çš„ï¼Œå°±åªæœ‰å¤‡åº“é‡åšäº†","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1547605760,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":243345,"user_name":"Monday","can_delete":false,"product_type":"c1","uid":1250907,"ip_address":"","ucode":"77B9BACC783598","user_header":"https://static001.geekbang.org/account/avatar/00/13/16/5b/83a35681.jpg","comment_is_top":false,"comment_ctime":1598066511,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"10188001103","product_id":100020801,"comment_content":"1ã€GTIDæ„Ÿè§‰å°±æ˜¯ä¸€ä¸ªç”±ä¸»åº“å‘½åçš„å”¯ä¸€IDï¼Œå¹¶ä¸”éšbinlogå‘é€åˆ°ä»åº“ã€‚<br>2ã€ä»åº“åœ¨æ‹¿åˆ°binlogæ—¶ï¼Œå…ˆåˆ¤æ–­GTIDæ˜¯å¦å­˜åœ¨ï¼Œè‹¥å­˜åœ¨åˆ™å¿½ç•¥æ­¤æ¡logï¼Œè‹¥ä¸å­˜åœ¨åˆ™æ‰§è¡Œå¹¶åŠ å…¥è‡ªå·±çš„GTIDé›†åˆ<br>æˆ‘æ˜¯è¿™æ ·ç†è§£çš„","like_count":2},{"had_liked":false,"id":77825,"user_name":"Eason Tai","can_delete":false,"product_type":"c1","uid":1200676,"ip_address":"","ucode":"4707577CC9C9E9","user_header":"https://static001.geekbang.org/account/avatar/00/12/52/24/bd63c4de.jpg","comment_is_top":false,"comment_ctime":1553005413,"is_pvip":false,"replies":[{"id":"28908","content":"å¾—çœ‹çœ‹ç©ºæ´æ€ä¹ˆå‡ºç°çš„<br><br>å¦‚æœåªæ˜¯è¦è¡¥ç©ºæ´çš„è¯ï¼Œå°±å¾ªç¯çš„<br>set gtid_next=...<br>begin;<br>commit;<br>å°±å¯ä»¥äº†ï¼Œä¸è¿‡è¿™ä¸ªåªæ˜¯æ²»æ ‡å“ˆï¼Œè¿˜æ˜¯å¾—æ‰¾å‡ºæ ¹å› ","user_name":"ä½œè€…å›å¤","comment_id":77825,"uid":"1264162","ip_address":"","utype":1,"ctime":1553415913,"user_name_real":"æ—æ™“æ–Œ"}],"discussion_count":1,"race_medal":0,"score":"10142940005","product_id":100020801,"comment_content":"ä½ å¥½ï¼Œä¸å¤§ä½¬ï¼Œå¦‚æœä¸€å¥—é«˜å¯ç”¨ç®¡ç†å·¥å…·åŸºäºgtidåšç®¡æ§ã€‚å¦‚æœgtidå‡ºç°ç©ºæ´çš„æƒ…å†µï¼Œåº”è¯¥æ€ä¹ˆè§£å†³é—®é¢˜ã€‚","like_count":2,"discussions":[{"author":{"id":1264162,"avatar":"https://static001.geekbang.org/account/avatar/00/13/4a/22/2681d602.jpg","nickname":"æ—æ™“æ–Œ","note":"","ucode":"CDE42D44F26240","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":443867,"discussion_content":"å¾—çœ‹çœ‹ç©ºæ´æ€ä¹ˆå‡ºç°çš„\n\nå¦‚æœåªæ˜¯è¦è¡¥ç©ºæ´çš„è¯ï¼Œå°±å¾ªç¯çš„\nset gtid_next=...\nbegin;\ncommit;\nå°±å¯ä»¥äº†ï¼Œä¸è¿‡è¿™ä¸ªåªæ˜¯æ²»æ ‡å“ˆï¼Œè¿˜æ˜¯å¾—æ‰¾å‡ºæ ¹å› ","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1553415913,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":71830,"user_name":"ajlidue","can_delete":false,"product_type":"c1","uid":1308376,"ip_address":"","ucode":"D6B29E941958E8","user_header":"http://thirdwx.qlogo.cn/mmopen/vi_32/DYAIOgq83er6NXib2NGaTAAEe2KCcibH2FiafOOD73kQdcuAMGrnRib5CDWXum0SWDOM9NnWicbUsDpghmxEmJtpk9w/132","comment_is_top":false,"comment_ctime":1551446852,"is_pvip":false,"replies":[{"id":"26026","content":"å¯¹ï¼Œreset masteræ…ç”¨ğŸ˜†","user_name":"ä½œè€…å›å¤","comment_id":71830,"uid":"1264162","ip_address":"","utype":1,"ctime":1551457864,"user_name_real":"æ—æ™“æ–Œ"}],"discussion_count":1,"race_medal":0,"score":"10141381444","product_id":100020801,"comment_content":"purge gtidå°±æ˜¯æŠŠä¸»åº“å½“å‰æ‰§è¡Œè¿‡çš„gtidåœ¨å¤‡åº“å…¨éƒ¨purgeæ‰ï¼Œå¤‡åº“æ‰§è¡Œstop slaveï¼›reset masterï¼›set global gtid_purged =â€˜xxxxxâ€™;ç„¶åå†é‡æ–°change masterã€‚ä¸è¿‡è¿™æ ·ä¸»å¤‡çš„æ•°æ®å°±ä¸ä¸€è‡´äº†ã€‚å¹³æ—¶é‡åˆ°è¿™ä¸ªé—®é¢˜ä¸€èˆ¬éƒ½æ˜¯é‡åšå¤‡åº“æ•°æ®çš„","like_count":2,"discussions":[{"author":{"id":1264162,"avatar":"https://static001.geekbang.org/account/avatar/00/13/4a/22/2681d602.jpg","nickname":"æ—æ™“æ–Œ","note":"","ucode":"CDE42D44F26240","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":441350,"discussion_content":"å¯¹ï¼Œreset masteræ…ç”¨ğŸ˜†","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1551457864,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":59755,"user_name":"å¾€äº‹éšé£ï¼Œé¡ºå…¶è‡ªç„¶","can_delete":false,"product_type":"c1","uid":1235692,"ip_address":"","ucode":"F266EC6B143E38","user_header":"https://static001.geekbang.org/account/avatar/00/12/da/ec/779c1a78.jpg","comment_is_top":false,"comment_ctime":1547424596,"is_pvip":false,"replies":[{"id":"21484","content":"æäº¤äº‹åŠ¡çš„æ—¶å€™æ‰ç”ŸæˆGTID","user_name":"ä½œè€…å›å¤","user_name_real":"æ—æ™“æ–Œ","uid":"1264162","ctime":1547432572,"ip_address":"","comment_id":59755,"utype":1}],"discussion_count":1,"race_medal":0,"score":"10137359188","product_id":100020801,"comment_content":"æ‰§è¡Œäº‹åŠ¡ä¹‹å‰ç”ŸæˆGTIDï¼Œç³»ç»Ÿæ€ä¹ˆçŸ¥é“ä¸‹æ¬¡è¦ç”Ÿæˆäº‹ç‰©ï¼Œæ˜¯é¢„ç”Ÿæˆç•™åœ¨é‚£ï¼Ÿ","like_count":2,"discussions":[{"author":{"id":1264162,"avatar":"https://static001.geekbang.org/account/avatar/00/13/4a/22/2681d602.jpg","nickname":"æ—æ™“æ–Œ","note":"","ucode":"CDE42D44F26240","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":436387,"discussion_content":"æäº¤äº‹åŠ¡çš„æ—¶å€™æ‰ç”ŸæˆGTID","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1547432572,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":355989,"user_name":"Geek_323a60","can_delete":false,"product_type":"c1","uid":2797976,"ip_address":"å››å·","ucode":"CDC276EC255411","user_header":"","comment_is_top":false,"comment_ctime":1661908677,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1661908677","product_id":100020801,"comment_content":"å®ä¾‹ Aâ€™çš„ GTID é›†åˆè®°ä¸º set_aï¼Œå®ä¾‹ B çš„ GTID é›†åˆè®°ä¸º set_bã€‚è¿™å¥è¯ä½œè€…æ˜¯ä¸æ˜¯å†™é”™äº†å‘€ã€‚åº”è¯¥æ˜¯å®ä¾‹ A çš„ GTID é›†åˆè®°ä¸º set_a å§ã€‚è¦ä¸ç„¶è¿™ä¸â€œå®ä¾‹ Aâ€™ç®—å‡º set_a ä¸ set_b çš„å·®é›†ï¼Œä¹Ÿå°±æ˜¯æ‰€æœ‰å­˜åœ¨äº set_aï¼Œä½†æ˜¯ä¸å­˜åœ¨äº set_b çš„ GTID çš„é›†åˆï¼Œåˆ¤æ–­ Aâ€™æœ¬åœ°æ˜¯å¦åŒ…å«äº†è¿™ä¸ªå·®é›†éœ€è¦çš„æ‰€æœ‰ binlog äº‹åŠ¡â€æœ‰çŸ›ç›¾å•Š","like_count":0},{"had_liked":false,"id":352908,"user_name":"ç¦»å¢ƒâ€","can_delete":false,"product_type":"c1","uid":1895314,"ip_address":"é™•è¥¿","ucode":"7186EF2BEF8956","user_header":"http://thirdwx.qlogo.cn/mmopen/vi_32/STqKg1kLgvRuduQfo0R2E2osYBian7XrQAjSWmOwL9nyZVhq7vyLPnlGcgvguFV4aV7ToWLFiauEMKy96KWHKBVg/132","comment_is_top":false,"comment_ctime":1659004493,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1659004493","product_id":100020801,"comment_content":"ä¸å¥‡è€å¸ˆåŠ æ²¹ç”Ÿæ´»å’Œå·¥ä½œ","like_count":0},{"had_liked":false,"id":345433,"user_name":"Geek_3cb2d6","can_delete":false,"product_type":"c1","uid":2295077,"ip_address":"","ucode":"F571DD43DF8F2C","user_header":"","comment_is_top":false,"comment_ctime":1652268710,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1652268710","product_id":100020801,"comment_content":"è€å¸ˆï¼Œæœ‰æ²¡æœ‰è¿™ç§æƒ…å†µï¼šåœ¨ T è¿™ä¸ªæ—¶åˆ»ï¼Œä¸»åº“ A å·²ç»æ‰§è¡Œå®Œæˆäº†ä¸€ä¸ª insert è¯­å¥æ’å…¥äº†ä¸€è¡Œæ•°æ® Rï¼Œä½†æ˜¯å¹¶æ²¡æœ‰ä¼ é€’binLogç»™A`å’ŒBï¼Œåœ¨ä¼ binlogä¹‹å‰ä¸»åº“ A çš„ä¸»æœºå°±æ‰ç”µäº†ï¼Œè¿™æ ·çš„è¯ï¼ŒA`ä¸Béƒ½æ²¡æ‰§è¡Œbinlog,åœ¨ç¡®è®¤åŒæ­¥ä½ç‚¹æ—¶å¯¼è‡´ä¸¢æ•°æ®","like_count":0},{"had_liked":false,"id":344126,"user_name":"æ ¸æ¡ƒ","can_delete":false,"product_type":"c1","uid":1385204,"ip_address":"","ucode":"7AB05270CBCCCB","user_header":"https://static001.geekbang.org/account/avatar/00/15/22/f4/9fd6f8f0.jpg","comment_is_top":false,"comment_ctime":1651287793,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1651287793","product_id":100020801,"comment_content":"æœ€åé‚£ä¸ªåœ¨çº¿DDLçš„è§£å†³æ–¹æ¡ˆï¼Œå…¶å®å’Œraftçš„ç©ºentryåŸç†çš„ä¸€æ ·çš„.","like_count":0},{"had_liked":false,"id":342992,"user_name":"tommyCmd","can_delete":false,"product_type":"c1","uid":1208393,"ip_address":"","ucode":"4ADBB1FA44668D","user_header":"https://static001.geekbang.org/account/avatar/00/12/70/49/d7690979.jpg","comment_is_top":false,"comment_ctime":1650586004,"is_pvip":true,"discussion_count":0,"race_medal":0,"score":"1650586004","product_id":100020801,"comment_content":"è€å¸ˆï¼Œå¯¹äºåŸºäºä½ç‚¹çš„ä¸»ä»å¤åˆ¶æˆ‘æœ‰ä¸ªç–‘é—®ï¼Œç¬¬ä¸€æ¬¡slaveéœ€è¦æŒ‡å®šä½ç‚¹ï¼Œåé¢å¦‚æœstop slave;start slaveï¼Œä½ç‚¹ä¼šè‡ªåŠ¨æ›´æ–°å—ï¼Ÿ","like_count":0},{"had_liked":false,"id":342989,"user_name":"tommyCmd","can_delete":false,"product_type":"c1","uid":1208393,"ip_address":"","ucode":"4ADBB1FA44668D","user_header":"https://static001.geekbang.org/account/avatar/00/12/70/49/d7690979.jpg","comment_is_top":false,"comment_ctime":1650585383,"is_pvip":true,"discussion_count":0,"race_medal":0,"score":"1650585383","product_id":100020801,"comment_content":"è€å¸ˆä½ å¥½ï¼Œå·¥ä½œä¸­é‡åˆ°è¿™æ ·çš„çº¿ä¸Šé…ç½®ï¼Œgtid_mode=on, ä½†æ˜¯chang masterè¿˜æ˜¯é€šè¿‡è®¾ç½®master_log_fileå’Œmaster_log_positionï¼Œauto_positionæ­¤æ—¶æ˜¯0ï¼Œæµ‹è¯•ä¸‹æ¥å‘ç°ï¼Œslaveå¼‚å¸¸åstop slaveåé‡æ–°start slaveï¼Œå¹¶æ²¡æœ‰é‡æ–°æŒ‡å®šä½ç‚¹ï¼Œä¹Ÿèƒ½ä¿è¯ä¸»ä»ä¸€è‡´ã€‚è¯·é—®è¿™ç§é…ç½®æœ€ç»ˆæ˜¯åŸºäºä½ç‚¹çš„è¿˜æ˜¯gtid automaticå½¢å¼çš„ï¼Œè¿™æ ·çš„é…ç½®æœ‰æ²¡æœ‰é£é™©ï¼Œéœ€è¦æ€æ ·åšæ‰èƒ½å®‰å…¨åˆ‡æ¢åˆ°gtidæ¨¡å¼ï¼Ÿè¡¥å……ä¸€ä¸‹ï¼Œmysqlç‰ˆæœ¬5.7ï¼ŒåŒä¸»æ¨¡å¼","like_count":0},{"had_liked":false,"id":332363,"user_name":"èƒ–å­ç½—","can_delete":false,"product_type":"c1","uid":1308729,"ip_address":"","ucode":"AF45AEED6064B3","user_header":"https://static001.geekbang.org/account/avatar/00/13/f8/39/4089c9b5.jpg","comment_is_top":false,"comment_ctime":1643186585,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1643186585","product_id":100020801,"comment_content":"è€å¸ˆå¥½ æœ‰ä¸ªç–‘é—®ï¼Œä¸¤ä¸ªä¸åŒå®ä¾‹çš„gtidå®Œå…¨ä¸ä¸€æ ·ï¼Œæ€ä¹ˆæ±‚ä¸¤ä¸ªgtidçš„å·®é›†å‘¢ï¼Œæ˜¯å°†server_uuidå»æ‰åï¼Œæ¯”è¾ƒåé¢çš„gnoå—ï¼Ÿ","like_count":0},{"had_liked":false,"id":327776,"user_name":"æå¤é¾™","can_delete":false,"product_type":"c1","uid":2824858,"ip_address":"","ucode":"68346B996EE22B","user_header":"https://static001.geekbang.org/account/avatar/00/2b/1a/9a/f2f9f5dd.jpg","comment_is_top":false,"comment_ctime":1640304395,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1640304395","product_id":100020801,"comment_content":"æ¯”å¦‚é€šè¿‡ set gtid_next=&#39;current_gtidâ€™æŒ‡å®šä¸º current_gtidï¼Œé‚£ä¹ˆå°±æœ‰ä¸¤ç§å¯èƒ½ï¼ša.  å¦‚æœ current_gtid å·²ç»å­˜åœ¨äºå®ä¾‹çš„ GTID é›†åˆä¸­ï¼Œæ¥ä¸‹æ¥æ‰§è¡Œçš„è¿™ä¸ªäº‹åŠ¡ä¼šç›´æ¥è¢«ç³»ç»Ÿå¿½ç•¥ï¼›<br><br>è¯·é—®è€å¸ˆï¼Œç›´æ¥è¢«ç³»ç»Ÿå¿½ç•¥æ˜¯ä»€ä¹ˆæ„æ€ï¼Ÿæ˜¯æŒ‡è¿™ä¸ªset gtid çš„å‘½ä»¤è¢«å¿½ç•¥ï¼Œè¿˜æ˜¯è¿™ä¸ªäº‹åŠ¡åœ¨ä¸»åº“ä¸æ‰§è¡Œï¼Ÿ","like_count":0},{"had_liked":false,"id":324331,"user_name":"bigdudo","can_delete":false,"product_type":"c1","uid":1371360,"ip_address":"","ucode":"5938710D7C1149","user_header":"https://static001.geekbang.org/account/avatar/00/14/ec/e0/d072d6f0.jpg","comment_is_top":false,"comment_ctime":1638372887,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1638372887","product_id":100020801,"comment_content":"è€å¸ˆï¼Œåœ¨æƒ³ä¸ªé—®é¢˜ï¼Œå…³äºä½ç‚¹åŒæ­¥çš„ï¼Œå¦‚æœTæ—¶åˆ»ï¼ŒA`æ–°ä¸»åº“relayLogæ­£å¥½æ‰§è¡Œåˆ°äº‹åŠ¡4ï¼Œè€Œä»åº“Bæ‰åŒæ­¥åˆ°äº‹åŠ¡1ï¼Œä¹Ÿå°±æ˜¯ä»åº“çš„é€Ÿç‡è¿œè¿œå°äºæ–°ä¸»åº“ï¼Œé‚£ä¹ˆå–Tæ—¶åˆ»ä¹‹åï¼Œç›¸å½“äºä»åº“Bè¦ä»äº‹åŠ¡4å¼€å§‹æ‰§è¡Œèµ·æ¥ï¼Œé‚£ä¸å°±äº‹åŠ¡2å’Œ3éƒ½æ²¡æ³•åŒæ­¥äº†ï¼Œè¿™ä¸å°±é€ æˆä¸»ä»ä¸ä¸€è‡´äº†","like_count":0},{"had_liked":false,"id":317795,"user_name":"é’èä¹‹æœ«","can_delete":false,"product_type":"c1","uid":2145548,"ip_address":"","ucode":"C55233E90112FC","user_header":"https://static001.geekbang.org/account/avatar/00/20/bd/0c/1bd1b097.jpg","comment_is_top":false,"comment_ctime":1634970243,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1634970243","product_id":100020801,"comment_content":"è¯´è€å®è¯ä¸æ˜¯å¾ˆæ˜ç™½ï¼Œä¹Ÿæ²¡æœ‰å…·ä½“çš„å®ä¾‹æ“ä½œã€‚è€å¸ˆæ²¡æ­ä¸ªç¯å¢ƒå®é™…æ“ä½œä¸€ä¸‹å—ï¼Ÿ","like_count":0},{"had_liked":false,"id":312227,"user_name":"Fly","can_delete":false,"product_type":"c1","uid":1998881,"ip_address":"","ucode":"1314C93980803E","user_header":"https://thirdwx.qlogo.cn/mmopen/vi_32/av0CCmWNyJqOH8iae2XAG6OuOkGyJTuK6kJ1DeYvz9x4Jbic6C8dcUe1pDXAhBC05rFJTDicBzJdFy7cwO2NnaVow/132","comment_is_top":false,"comment_ctime":1631694470,"is_pvip":false,"discussion_count":1,"race_medal":0,"score":"1631694470","product_id":100020801,"comment_content":"è€å¸ˆï¼Œä½ æ–‡ä¸­æœ‰è¿™æ ·ä¸€å¥è¯ï¼šâ€œåœ¨æ–°ä¸»åº“ Aâ€™ä¸Šï¼Œ R è¿™ä¸€è¡Œä¹Ÿå·²ç»å­˜åœ¨ï¼Œæ—¥å¿—æ˜¯å†™åœ¨ 123 è¿™ä¸ªä½ç½®ä¹‹åçš„ï¼›â€ï¼Œè¿™é‡Œä¸ºä»€ä¹ˆæ—¥å¿—æ˜¯å†™åœ¨ 123 è¿™ä¸ªä½ç½®ä¹‹åï¼Ÿä¸æ˜¯å¾ˆç†è§£ï¼Œéº»çƒ¦è§£é‡Šä¸€ä¸‹ã€‚","like_count":0,"discussions":[{"author":{"id":2303492,"avatar":"https://static001.geekbang.org/account/avatar/00/23/26/04/844be9df.jpg","nickname":"æ‡’èµ«èµ«","note":"","ucode":"EDFB9B69ABB705","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":412287,"discussion_content":"åŒé—®","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1636122913,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":301602,"user_name":"wy","can_delete":false,"product_type":"c1","uid":1064681,"ip_address":"","ucode":"41C1B304E7F032","user_header":"https://static001.geekbang.org/account/avatar/00/10/3e/e9/116f1dee.jpg","comment_is_top":false,"comment_ctime":1625758611,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1625758611","product_id":100020801,"comment_content":"æ—è€å¸ˆï¼Œæƒ³é—®é—®ä¸€ä¸ªæ–°åŠ å…¥çš„slaveå¦‚ä½•æŠŠmasterçš„å†å²æ•°æ®åŒæ­¥è¿‡æ¥å‘¢ï¼Ÿä¹Ÿæ˜¯ä»å¤´å¼€å§‹è¯»masterçš„binlogå—ï¼Ÿæœ‰æ²¡æœ‰æ•ˆç‡æ›´é«˜çš„åŠæ³•ï¼Œå…ˆé•œåƒä¸€ä»½å†å²æ•°æ®åˆ°slaveï¼Œç„¶åå†ä»æŸä¸ªä½ç½®åŒæ­¥å¢é‡æ•°æ®ï¼Œä½†æ˜¯è¿™ä¸ªä½ç½®æ€ä¹ˆè·å–æ‰èƒ½è·å–ä¸€ä¸ªæ­£ç¡®çš„å€¼å‘¢ï¼Ÿæ‰èƒ½ä¿è¯ä¸ä¸¢æˆ–è€…ä¸å‡ºé”™","like_count":0},{"had_liked":false,"id":301250,"user_name":"ç­‰é£æ¥","can_delete":false,"product_type":"c1","uid":1350677,"ip_address":"","ucode":"5B7FF74A51F534","user_header":"https://static001.geekbang.org/account/avatar/00/14/9c/15/719f1f44.jpg","comment_is_top":false,"comment_ctime":1625589207,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1625589207","product_id":100020801,"comment_content":"æœ‰ä¸€ç‚¹ä¸è§£ï¼Œé€šè¿‡gtidå¤‡åº“båˆ‡æ¢ä¸»åº“a&#39;æ—¶ï¼Œ å¤‡åº“bå°†ä¼šæ‰§è¡Œä¸»åº“a&#39;å®ä¾‹ä¸‹åŒæ­¥ä¸»åº“aäº§ç”Ÿçš„æ‰€æœ‰çš„gtid binlogæ—¥å¿—å—(ä¸»åº“aå’Œä¸»åº“a&#39;çš„server_idä¸ä¸€è‡´)ï¼Œ å¤‡åº“bæ‰§è¡Œè¿™ä¸ªbinlogæ—¥å¿—ä¸ä¼šå‘ç”Ÿä¸»é”®å†²çªå—","like_count":0},{"had_liked":false,"id":289396,"user_name":"ç‹ä¹","can_delete":false,"product_type":"c1","uid":1891149,"ip_address":"","ucode":"FF4A764EA8AB84","user_header":"http://thirdwx.qlogo.cn/mmopen/vi_32/PYPYsHxv1LhpMvF2cRTCL2TicZrw9ysPlz2TkQFryTibFrBFoKLZ9aSlAayMlJ8Fx7icdW6Ec5CFDyrANTatShQkQ/132","comment_is_top":false,"comment_ctime":1618996876,"is_pvip":true,"discussion_count":0,"race_medal":0,"score":"1618996876","product_id":100020801,"comment_content":"å‰é¢@æ‚Ÿç©º å’Œ @Lukia æåˆ°çš„Seconds_Behind_Masteræ—¶é—´è®¡ç®—é—®é¢˜ï¼Œä¸¤ä½åŒå­¦æå‡ºæ¥ä¸åŒçš„è§è§£ï¼Œè€å¸ˆä¹Ÿåˆ†åˆ«èµåŒäº†ä»–ä»¬çš„è§è§£ã€‚<br>æˆ‘åœ¨mysql 8.0ä¸Šçš„æµ‹è¯•ç»“æœæ˜¯ï¼ŒDDLçš„åŒæ­¥æ—¶ç›‘æ§åˆ°çš„Seconds_Behind_Masteræ˜¯æœ€å¤§3åˆ†é’Ÿï¼Œç„¶åç¬é—´å˜ä¸º0ã€‚åˆ©ç”¨mysqlbinlogè§£ææ—¥å¿—å¯¹æ¯”æµ‹è¯•äº†å¤šæ¬¡ï¼Œå‘ç°Seconds_Behind_Masterçš„å€¼ = ä»åº“binlogæäº¤æ—¶é—´æˆ³ - è¿™ä¸ªquery eventä¸­è®°å½•çš„æ—¶é—´æˆ³ï¼ˆåº”è¯¥å°±æ˜¯ä¸»åº“å¼€å§‹æ‰§è¡ŒDDLçš„æ—¶é—´æˆ³ï¼‰ã€‚ é’ˆå¯¹Seconds_Behind_Masterçš„è¯¦ç»†è®¡ç®—åŸç†ï¼Œå¸Œæœ›è€å¸ˆè§£æƒ‘ä¸€ä¸‹ã€‚<br><br>å¦å¤–ï¼Œmysql8.0ä¹‹åå¯ä»¥é€šè¿‡immediate_commit_timestamp å’Œoriginal_committed_timestamp æ¥è®¡ç®—ä¸»ä»å¤åˆ¶å»¶è¿Ÿï¼Œå¯ä»¥åœ¨psä¸­çš„replication_applier_status_by_coordinator å’Œ replication_applier_status_by_workerè§†å›¾æ¥æŸ¥çœ‹å»¶è¿Ÿæ—¶é—´ã€‚","like_count":0},{"had_liked":false,"id":282257,"user_name":"å¸æ±Ÿ","can_delete":false,"product_type":"c1","uid":1590610,"ip_address":"","ucode":"93CBA4E4D05DA5","user_header":"http://thirdwx.qlogo.cn/mmopen/vi_32/B9vSOjMc2a86kYA8R5yDkVdFiaj2JeBZ1PuI9oUKhbnvuZwuibdUam6FTcGzDaiaFdk2GWJveUGhfCVpv4KaOdicoQ/132","comment_is_top":false,"comment_ctime":1615174511,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1615174511","product_id":100020801,"comment_content":"å›ç­”é—®é¢˜: å¦‚æœbinlogåˆ äº†.å°±ä¸ä»binlogé‡Œé¢è¯»å–æ•°æ®äº†.ç›´æ¥ä½¿ç”¨ä¸»åº“çš„æ•°æ®å’Œæ—¥å¿—.ç„¶åå†ä»ä¸Šä¸€æ­¥ç»§ç»­å¼€å§‹æ“ä½œ.å› ä¸ºæ˜¯ç›´æ¥ä»ä¸»åº“æ‹¿è¿‡æ¥çš„.è¿™æ¬¡ä»åº“æŒ‡å®šçš„gnoå°±è‚¯å®šä¼šæœ‰äº†.","like_count":0},{"had_liked":false,"id":281447,"user_name":"Cheeseç‹ç¦æ™º","can_delete":false,"product_type":"c1","uid":1442933,"ip_address":"","ucode":"CEA49F24A7C8D6","user_header":"https://static001.geekbang.org/account/avatar/00/16/04/75/d30c3c59.jpg","comment_is_top":false,"comment_ctime":1614753121,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1614753121","product_id":100020801,"comment_content":"å¦‚æœbinlogåˆ é™¤äº†çš„è¯ï¼Œæ˜¯å¦å¯ä»¥è€ƒè™‘å…ˆæŸ¥çœ‹positionï¼Œç„¶åå»ºç«‹Snapshotï¼Œå°†SnapshotåŒæ­¥åˆ°å¤‡åº“ï¼Œç„¶åå°†åŒæ­¥çš„positionæŒ‡å‘å…ˆå‰æŸ¥çœ‹çš„positionã€‚<br>å¯ä»¥è€ƒè™‘ç›´æ¥ä½¿ç”¨Debezium + Kafkaæˆ–è€…Flink + MySQL Source Connectorè¿›è¡Œè‡ªåŠ¨åŒ–æ“ä½œã€‚","like_count":0},{"had_liked":false,"id":268553,"user_name":"ä½•ç£Š","can_delete":false,"product_type":"c1","uid":1047604,"ip_address":"","ucode":"78934C3ED4A342","user_header":"https://static001.geekbang.org/account/avatar/00/0f/fc/34/c733b116.jpg","comment_is_top":false,"comment_ctime":1608255456,"is_pvip":false,"discussion_count":1,"race_medal":0,"score":"1608255456","product_id":100020801,"comment_content":"æœ‰ä¸€ä¸ªé—®é¢˜ï¼Œä¸»å¤‡åˆ‡æ¢åï¼Œæ–°çš„ä»åº“åˆ‡ä¸»è¦æŠŠè‡ªå·±çš„GTIDé›†åˆå‘ŠçŸ¥æ–°ä¸»åº“ã€‚é‚£è¿™ä¸ªé›†åˆå¦‚æœå¾ˆå¤§ä¸æ˜¯å°±ä¼šå¾ˆæ…¢å—ï¼Ÿè¿™é‡Œæœ‰ä»€ä¹ˆæœºåˆ¶å—ï¼Ÿæˆ‘ç†è§£åº”è¯¥ä¸ä¼šå…¨é‡å‘ã€‚","like_count":0,"discussions":[{"author":{"id":1010344,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/6a/a8/ee414a25.jpg","nickname":"å…¬å‘Š-SREè¿ç»´å®è·µ","note":"","ucode":"86F4E48AE1D9D8","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":548865,"discussion_content":"å› ä¸ºæ˜¯è¿ç»­çš„ï¼Œæ‰€ä»¥åªè¦å‘å¤´å’Œå°¾","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1643426285,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":254325,"user_name":"ç´«æ—¥","can_delete":false,"product_type":"c1","uid":1207410,"ip_address":"","ucode":"73A8DEE323AC19","user_header":"http://thirdwx.qlogo.cn/mmopen/vi_32/DYAIOgq83eqXSb2jAzlMM0JdTjWrNiaq2uR9eeloBYp906POddb9evmuj5f4CUoO6ge8TibibwtZicnl1sRHic9rW7g/132","comment_is_top":false,"comment_ctime":1603100576,"is_pvip":true,"discussion_count":0,"race_medal":4,"score":"1603100576","product_id":100020801,"comment_content":"å¯ä»¥çœ‹åˆ°ï¼Œåœ¨ GTID æ¨¡å¼ä¸‹ï¼Œä¸€ä¸»å¤šä»åˆ‡æ¢å°±éå¸¸æ–¹ä¾¿äº†ã€‚å› æ­¤ï¼Œå¦‚æœä½ ä½¿ç”¨çš„ MySQL ç‰ˆæœ¬æ”¯æŒ GTID çš„è¯ï¼Œæˆ‘éƒ½å»ºè®®ä½ å°½é‡ä½¿ç”¨ GTID æ¨¡å¼æ¥åšä¸€ä¸»å¤šä»çš„åˆ‡æ¢ã€‚","like_count":0},{"had_liked":false,"id":237210,"user_name":"while (1)ç­‰;","can_delete":false,"product_type":"c1","uid":1061991,"ip_address":"","ucode":"BAEC7258D65B69","user_header":"https://static001.geekbang.org/account/avatar/00/10/34/67/06a7f9be.jpg","comment_is_top":false,"comment_ctime":1595739083,"is_pvip":true,"discussion_count":0,"race_medal":0,"score":"1595739083","product_id":100020801,"comment_content":"GTID é›†åˆä¼šæ”¾æ‰€æœ‰å†å²æ•°æ®å—ï¼Ÿé‚£ä¹ˆæ¯æ¬¡æ¯”å¯¹ä¼šä¸ä¼šè€—æ—¶å¾ˆä¹…","like_count":0},{"had_liked":false,"id":236145,"user_name":"é˜¿å¾·","can_delete":false,"product_type":"c1","uid":1602420,"ip_address":"","ucode":"186D5E19E3CB6E","user_header":"https://static001.geekbang.org/account/avatar/00/18/73/74/3bf4b74e.jpg","comment_is_top":false,"comment_ctime":1595328098,"is_pvip":false,"discussion_count":1,"race_medal":0,"score":"1595328098","product_id":100020801,"comment_content":"è€å¸ˆï¼Œæˆ‘æƒ³åˆ°äº†redisï¼Œredisçš„ä¸»ä»æ¶æ„å…¶å®è¿˜æœ‰ä¸€ä¸ªå“¨å…µé›†ç¾¤æ¥é€‰ä¸¾masterï¼Œä½†æ˜¯MySQLå´ä¸ç”¨å—ï¼Ÿå¦‚æœæ²¡æœ‰å¤‡åº“ï¼Œå½“masterå®•æœºï¼Œå®ƒæ˜¯æ€ä¹ˆä»å‡ ä¸ªä»åº“ä¸­é€‰ä¸¾ä¸€ä¸ªå‡ºæ¥å½“masterï¼Œé€‰ä¸¾æœºåˆ¶æ˜¯ä»€ä¹ˆ","like_count":0,"discussions":[{"author":{"id":1010344,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/6a/a8/ee414a25.jpg","nickname":"å…¬å‘Š-SREè¿ç»´å®è·µ","note":"","ucode":"86F4E48AE1D9D8","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":548864,"discussion_content":"ä¹Ÿéœ€è¦çš„","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1643426197,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":232267,"user_name":"Damo","can_delete":false,"product_type":"c1","uid":1599197,"ip_address":"","ucode":"F332EA67F5A40C","user_header":"https://static001.geekbang.org/account/avatar/00/18/66/dd/c9f17139.jpg","comment_is_top":false,"comment_ctime":1593939032,"is_pvip":false,"discussion_count":1,"race_medal":0,"score":"1593939032","product_id":100020801,"comment_content":"è€å¸ˆæœ‰ä¸¤ä¸ªé—®é¢˜<br>ï¼ˆæˆ‘æ˜¯mysql å°ç™½ï¼‰<br>1. ä¸»å¤‡åˆ‡æ¢æ˜¯é€šè¿‡ç›‘æ§ç„¶åï¼Œå‘ç°æœ‰é—®é¢˜äº†å†äººä¸ºæ“ä½œåˆ‡æ¢ï¼Œè¿˜æ˜¯ mysql å†…éƒ¨æœ‰ä»€ä¹ˆç®—æ³•ï¼Œè‡ªåŠ¨åˆ¤æ–­å»åˆ‡æ¢ä¸»å¤‡ï¼Ÿ<br>2. ç¬¬ä¸€ä¸ªå›¾ä¸­çš„ä¸»ï¼Œå¤‡ï¼Œä»ï¼Œä¸‰è€…çš„å…³ç³»ï¼Œæ˜¯å¦å¯ä»¥ç†è§£ä¸º raft ç®—æ³•ä¸­çš„ masterï¼Œflowerï¼Œå…¶ä»–è§’è‰²ï¼Œè¿˜æ˜¯è¯´å…¶å®å¤‡åº“åœ¨ä¸€å¼€å§‹å°±å·²ç»è¢«æŒ‡å®šäº†ï¼Œå¦‚æœåœ¨ä¸»åº“å‘ç”Ÿå¼‚å¸¸æ—¶å°±åˆ‡åˆ°å¤‡åº“ï¼Ÿï¼ˆè¿™ä¸­é—´æ˜¯å¦æœ‰é€‰ä¸¾çš„è¿‡ç¨‹ï¼‰","like_count":0,"discussions":[{"author":{"id":1010344,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/6a/a8/ee414a25.jpg","nickname":"å…¬å‘Š-SREè¿ç»´å®è·µ","note":"","ucode":"86F4E48AE1D9D8","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":548863,"discussion_content":"1 å¯ä»¥è‡ªåŠ¨åŒ–åˆ‡æ¢ï¼Œè¿æ¥è¶…æ—¶ï¼Œä¸»åº“å®•éƒ½å¯ä»¥æ£€æµ‹ 2 ä¸å¯ä»¥ï¼ŒæŒ‡å®šäº†","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1643426098,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":222009,"user_name":"ad","can_delete":false,"product_type":"c1","uid":1060556,"ip_address":"","ucode":"7AC650031EB7A9","user_header":"https://static001.geekbang.org/account/avatar/00/10/2e/cc/964a8bcb.jpg","comment_is_top":false,"comment_ctime":1590655408,"is_pvip":false,"discussion_count":1,"race_medal":0,"score":"1590655408","product_id":100020801,"comment_content":"è€å¸ˆï¼Œâ€œæˆ‘ä»¬æŠŠç°åœ¨è¿™ä¸ªæ—¶åˆ»ï¼Œå®ä¾‹ Aâ€™çš„ GTID é›†åˆè®°ä¸º set_aï¼Œå®ä¾‹ B çš„ GTID é›†åˆè®°ä¸º set_bâ€ ç°åœ¨è¿™ä¸ªæ—¶åˆ»å…·ä½“æŒ‡çš„æ˜¯æœ€è¿‘ä¸€åˆ†é’Ÿè¿˜æ˜¯å¤šå°‘æ—¶é—´ï¼Ÿ","like_count":0,"discussions":[{"author":{"id":1010344,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/6a/a8/ee414a25.jpg","nickname":"å…¬å‘Š-SREè¿ç»´å®è·µ","note":"","ucode":"86F4E48AE1D9D8","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":548861,"discussion_content":"åˆ‡æ¢çš„é‚£ä¸€åˆ»","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1643425930,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":220697,"user_name":"æ³¨æ„åŠ›$","can_delete":false,"product_type":"c1","uid":1142316,"ip_address":"","ucode":"7FB3399A1EAB72","user_header":"https://static001.geekbang.org/account/avatar/00/11/6e/2c/e2f3cfc0.jpg","comment_is_top":false,"comment_ctime":1590309288,"is_pvip":false,"discussion_count":1,"race_medal":1,"score":"1590309288","product_id":100020801,"comment_content":"è€å¸ˆï¼Œä¸”å½“å‰ä¸»åº“æ˜¯ Xï¼Œ åœ¨å®ä¾‹ X ä¸Šæ‰§è¡Œ stop slaveã€‚ è¯·é—®ä¸»åº“è¿˜å¯ä»¥stop slaveå—ï¼Ÿä¸æ˜¯åªæœ‰ä»åº“å¯ä»¥å—","like_count":0,"discussions":[{"author":{"id":1526355,"avatar":"https://static001.geekbang.org/account/avatar/00/17/4a/53/063f9d17.jpg","nickname":"moonfox","note":"","ucode":"902BFF40EFA9FA","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":314268,"discussion_content":"åŒä¸»çš„æ—¶å€™ï¼Œä¸»åº“ä¹ŸåŒæ—¶æ˜¯å¤‡åº“","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1603135502,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":210784,"user_name":"å´”å²©","can_delete":false,"product_type":"c1","uid":1341851,"ip_address":"","ucode":"3745C1AC840BE1","user_header":"https://static001.geekbang.org/account/avatar/00/14/79/9b/4b6c66fe.jpg","comment_is_top":false,"comment_ctime":1587825045,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1587825045","product_id":100020801,"comment_content":"è€å¸ˆï¼Œæˆ‘å¯¹ä¸ŠæœŸçš„é—®é¢˜ç­”æ¡ˆä¸æ˜¯å¾ˆç†è§£ï¼Œä¸ºä»€ä¹ˆä¸»åº“å•çº¿ç¨‹æ¨¡å¼çš„commitidå°±æ˜¯ç›¸åŒçš„äº†å‘¢ï¼Ÿ","like_count":0},{"had_liked":false,"id":209748,"user_name":"lofaith","can_delete":false,"product_type":"c1","uid":1322553,"ip_address":"","ucode":"5DF6922BBF1AD5","user_header":"https://static001.geekbang.org/account/avatar/00/14/2e/39/7682b49e.jpg","comment_is_top":false,"comment_ctime":1587608643,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1587608643","product_id":100020801,"comment_content":"è€å¸ˆï¼Œå¦‚æœä¸»åº“Aå†™å…¥binlogåå°±å®•æœºè¿˜æ²¡æœ‰æŠŠbinlog ä¼ ç»™å¤‡åº“Aâ€˜å’Œä»åº“Bï¼Œé‚£ä¹ˆè¿™æ—¶å€™è¿›è¡Œä¸»å¤‡åˆ‡æ¢æ˜¯ä¸æ˜¯ä¼šå¯¼è‡´æ•°æ®ä¸¢å¤±å‘¢ï¼Ÿæœ‰ä»€ä¹ˆè§£å†³æ–¹æ³•å—","like_count":0},{"had_liked":false,"id":204627,"user_name":"Ryan","can_delete":false,"product_type":"c1","uid":1667987,"ip_address":"","ucode":"95BBBEE5B23878","user_header":"https://static001.geekbang.org/account/avatar/00/19/73/93/0a3a1e5b.jpg","comment_is_top":false,"comment_ctime":1586432033,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1586432033","product_id":100020801,"comment_content":"GTID é›†åˆæ˜¯é€»è¾‘æ¦‚å¿µè¿˜æ˜¯æœ‰ä¸€éƒ¨åˆ†åŒºåŸŸè¿›è¡Œå­˜å‚¨çš„ï¼Ÿ","like_count":0},{"had_liked":false,"id":204294,"user_name":"Ryan","can_delete":false,"product_type":"c1","uid":1667987,"ip_address":"","ucode":"95BBBEE5B23878","user_header":"https://static001.geekbang.org/account/avatar/00/19/73/93/0a3a1e5b.jpg","comment_is_top":false,"comment_ctime":1586360891,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1586360891","product_id":100020801,"comment_content":"è™½ç„¶éœ€è¦æ‰‹åŠ¨åˆ›å»ºç©ºäº‹ç‰©è®¾ç½®gtidï¼Œä½†æ˜¯æ€»å½’è¿˜æ˜¯ä¸€ä¸ªä¸é”™çš„è§£å†³æ–¹æ¡ˆ","like_count":0},{"had_liked":false,"id":194473,"user_name":"silentyears","can_delete":false,"product_type":"c1","uid":1061748,"ip_address":"","ucode":"6E137BFEB874CA","user_header":"https://static001.geekbang.org/account/avatar/00/10/33/74/d9d143fa.jpg","comment_is_top":false,"comment_ctime":1585061448,"is_pvip":true,"discussion_count":1,"race_medal":0,"score":"1585061448","product_id":100020801,"comment_content":"è€å¸ˆï¼Œæ¥æ™šäº†ã€‚ä¸çŸ¥è¿˜èƒ½å¦çœ‹è§ï¼š<br>æ–‡ä¸­è¯´â€œä½ å¯ä»¥è®¾æƒ³æœ‰è¿™ä¹ˆä¸€ç§æƒ…å†µï¼Œå‡è®¾åœ¨ T è¿™ä¸ªæ—¶åˆ»ï¼Œä¸»åº“ A å·²ç»æ‰§è¡Œå®Œæˆäº†ä¸€ä¸ª insert è¯­å¥æ’å…¥äº†ä¸€è¡Œæ•°æ® Rï¼Œå¹¶ä¸”å·²ç»å°† binlog ä¼ ç»™äº† Aâ€™å’Œ Bï¼Œç„¶ååœ¨ä¼ å®Œçš„ç¬é—´ä¸»åº“ A çš„ä¸»æœºå°±æ‰ç”µäº†ã€‚â€<br>è¯·é—®ï¼Œè¿™ä¸ªæ—¶å€™ï¼ŒAä¸Šè¿™ä¸ªinsertæ•°æ®æ˜¯ä¸¢å¤±äº†å§ï¼Œé‚£å’Œå¤‡åº“å’Œä»åº“æ•°æ®å°±ä¸ä¸€è‡´äº†å—ï¼Ÿ<br>å¦‚æœä¸è¿›è¡Œä¸»å¤‡åˆ‡æ¢ï¼Œé‡å¯Aï¼Œé‚£Aæ€ä¹ˆæ¢å¤å’Œå¤‡åº“ã€ä»åº“æ•°æ®ä¸€è‡´å‘¢ï¼Ÿ","like_count":0,"discussions":[{"author":{"id":1303322,"avatar":"https://static001.geekbang.org/account/avatar/00/13/e3/1a/061e77b6.jpg","nickname":"äº¢æ˜Ÿä¸œ","note":"","ucode":"5E4063E83B2BB9","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":329407,"discussion_content":"é€šè¿‡binlogæ¢å¤ï¼Œä»åº“å†åŒæ­¥æ•°æ®","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1606380676,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":182473,"user_name":"Flash","can_delete":false,"product_type":"c1","uid":1236163,"ip_address":"","ucode":"E285075C9E0B02","user_header":"https://static001.geekbang.org/account/avatar/00/12/dc/c3/e4ba51d5.jpg","comment_is_top":false,"comment_ctime":1582793606,"is_pvip":false,"discussion_count":2,"race_medal":0,"score":"1582793606","product_id":100020801,"comment_content":"è€å¸ˆï¼Œè¯·é—® â€œä¸»åº“Aå’Œå¤‡åº“Aâ€™ ç›¸åŒçš„æ—¥å¿—ï¼Œä½†å®ƒä»¬çš„ä½ç‚¹ä¸åŒâ€ ã€‚æ€ä¹ˆç†è§£å®ƒä»¬çš„ä½ç‚¹ä¸åŒï¼Ÿæˆ‘æœ‰ä¸¤ç§ç†è§£ï¼Œä¸çŸ¥é“æ˜¯å“ªä¸€ç§æƒ…å†µï¼š<br>1.å¤‡åº“Aâ€˜ åœ¨æ¶ˆè´¹ä¸»åº“Açš„binlogæ—¶ï¼Œæœ‰çš„äº‹åŠ¡ä¸å†²çªæ˜¯å¯ä»¥å¹¶è¡Œå†™binlogçš„ï¼Œæ‰€ä»¥å†™åˆ°å¤‡åº“binlogä¸­çš„äº‹åŠ¡è·Ÿä¸»åº“binlogä¸­çš„äº‹åŠ¡é¡ºåºä¸ä¸€æ ·ï¼Œå†é€šè¿‡ç›¸åŒæ—¶åˆ»å»æ‰¾ä½ç‚¹ï¼ŒAå’ŒAâ€™çš„ä½ç‚¹å°±ä¸ä¸€æ ·ã€‚<br>2.è¿˜æ˜¯è¯´ï¼Œæ‰¾è¿™ä¸ªä½ç‚¹ï¼ˆæ—¥å¿—åç§»é‡ï¼‰ï¼Œæ˜¯æŠŠbinlogæ–‡ä»¶è¯»åˆ°å†…å­˜ï¼Œæ‰€ä»¥ä½ç‚¹æŒ‡çš„æ˜¯åœ¨å†…å­˜ä¸­çš„ä½ç½®ï¼Œæ‰€ä»¥ä¸¤ä¸ªç›¸åŒçš„æ—¥å¿—ï¼Œä½ç‚¹ä¸ä¸€æ ·ã€‚<br>","like_count":0,"discussions":[{"author":{"id":1010344,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/6a/a8/ee414a25.jpg","nickname":"å…¬å‘Š-SREè¿ç»´å®è·µ","note":"","ucode":"86F4E48AE1D9D8","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":548850,"discussion_content":"1æ˜¯å¯¹çš„ï¼Œ2é‡Œé¢çš„å†…å­˜ä¹Ÿæ˜¯æŒ‰ç…§å†™å…¥binlig é¡ºåºæ¥çš„","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1643424058,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":2377275,"avatar":"https://static001.geekbang.org/account/avatar/00/24/46/3b/ac4b8ab0.jpg","nickname":"Streamä¸Šçš„å¸§","note":"","ucode":"325FBEFF80BD91","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":336936,"discussion_content":"ä¸»å¤‡å»¶è¿Ÿé€ æˆçš„ä½ç‚¹ä¸åŒï¼Œè¯´ç™½äº†åº“Aå’Œåº“A&#39;ä¸­æ‰§è¡Œçš„äº‹åŠ¡ä¸ªæ•°ä¸åŒã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1608730597,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":164976,"user_name":"superFan","can_delete":false,"product_type":"c1","uid":1103116,"ip_address":"","ucode":"AA0FFEF391488D","user_header":"https://static001.geekbang.org/account/avatar/00/10/d5/0c/8dd1791d.jpg","comment_is_top":false,"comment_ctime":1577119643,"is_pvip":false,"discussion_count":1,"race_medal":0,"score":"1577119643","product_id":100020801,"comment_content":"è€å¸ˆï¼Œé—®ä¸‹å®é™…å·¥ä½œä¸­å¦‚æœè¦åœ¨çº¿å‡çº§æ•°æ®åº“ç‰ˆæœ¬åº”è¯¥æ€ä¹ˆæ“ä½œä¼šå¯¹åœ¨çº¿æœåŠ¡å½±å“æœ€å°(ç°åœ¨çº¿ä¸Šæ˜¯5.5ç‰ˆæœ¬ æƒ³è¦å‡çº§åˆ°5.7ï¼‰","like_count":0,"discussions":[{"author":{"id":1010344,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/6a/a8/ee414a25.jpg","nickname":"å…¬å‘Š-SREè¿ç»´å®è·µ","note":"","ucode":"86F4E48AE1D9D8","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":548849,"discussion_content":"æµ‹è¯•ç¯å¢ƒèµ°ä¸€è½®","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1643423965,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":163112,"user_name":"åˆºçŒ¬","can_delete":false,"product_type":"c1","uid":1108297,"ip_address":"","ucode":"60C3E38F4F03CC","user_header":"https://static001.geekbang.org/account/avatar/00/10/e9/49/29072f9e.jpg","comment_is_top":false,"comment_ctime":1576658291,"is_pvip":false,"discussion_count":1,"race_medal":0,"score":"1576658291","product_id":100020801,"comment_content":"è€å¸ˆä½ å¥½ï¼Œæœ‰ä¸ªé—®é¢˜ï¼Œè¯·æ•™ä¸‹ï¼ŒGTID æœ‰ä¸¤ç§ç”Ÿæˆæ–¹å¼ï¼Œç¬¬äºŒç§ç”Ÿæˆæ¨¡å¼å¦‚æœ gtid_next æ˜¯ä¸€ä¸ªæŒ‡å®šçš„ GTID çš„å€¼ï¼Œæ¯”å¦‚é€šè¿‡ set gtid_next=&#39;current_gtidâ€™æŒ‡å®šä¸º current_gtidï¼Œè¿™ä¸ªæŒ‡å®šGTIDä»€ä¹ˆæ—¶å€™ç”Ÿæˆï¼ŒæŒ‰ç…§ä»€ä¹ˆé€»è¾‘ç”Ÿæˆçš„ï¼Œæˆ‘è§‰å¾—è¿™ä¸ªcurrent_gtidæœ‰ç‚¹è¯¯å¯¼äººï¼Œè¯·è€å¸ˆè§£é‡Šä¸‹ï¼Œè°¢è°¢ã€‚","like_count":0,"discussions":[{"author":{"id":1010344,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/6a/a8/ee414a25.jpg","nickname":"å…¬å‘Š-SREè¿ç»´å®è·µ","note":"","ucode":"86F4E48AE1D9D8","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":548848,"discussion_content":"ç”Ÿæˆçš„é€»è¾‘å°±æ˜¯ä¸»å¤‡åŒæ­¥è¿™ç§åœºæ™¯","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1643423910,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":126930,"user_name":"å·¦ç³","can_delete":false,"product_type":"c1","uid":1206589,"ip_address":"","ucode":"B262A3E99C8605","user_header":"https://static001.geekbang.org/account/avatar/00/12/69/3d/3cfb9b87.jpg","comment_is_top":false,"comment_ctime":1566522341,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1566522341","product_id":100020801,"comment_content":"ä¸»åº“æ‰§è¡Œæ›´æ–°è¯­å¥æ˜¯å†™å…¥ç¼“å­˜å’Œredologï¼Œå¹¶æ²¡æœ‰åŒæ­¥åˆ°binlogï¼Œè¿™æ ·ä»åº“çš„å»¶è¿Ÿä¸æ˜¯ä¼šå¾ˆé«˜ï¼Ÿ<br>","like_count":0},{"had_liked":false,"id":123413,"user_name":"Eagles","can_delete":false,"product_type":"c1","uid":1115950,"ip_address":"","ucode":"BADAC7969475F2","user_header":"https://static001.geekbang.org/account/avatar/00/11/07/2e/f6a2dc27.jpg","comment_is_top":false,"comment_ctime":1565670979,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1565670979","product_id":100020801,"comment_content":"è€å¸ˆä½ å¥½ï¼Œè¯·é—®æœºå™¨å¯åŠ¨ä»¥åï¼Œæœ‰ä»€ä¹ˆæƒ…å†µä¼šå¯¼è‡´uuidå˜åŒ–å—ï¼Ÿæ¯”å¦‚æ›´æ”¹cnfæ–‡ä»¶é‡Œçš„serverId","like_count":0},{"had_liked":false,"id":120422,"user_name":"é’±","can_delete":false,"product_type":"c1","uid":1009652,"ip_address":"","ucode":"2C92A243A463D4","user_header":"https://static001.geekbang.org/account/avatar/00/0f/67/f4/9a1feb59.jpg","comment_is_top":false,"comment_ctime":1564889256,"is_pvip":false,"discussion_count":1,"race_medal":0,"score":"1564889256","product_id":100020801,"comment_content":"server_uuid æ˜¯ä¸€ä¸ªå®ä¾‹ç¬¬ä¸€æ¬¡å¯åŠ¨æ—¶è‡ªåŠ¨ç”Ÿæˆçš„ï¼Œæ˜¯ä¸€ä¸ªå…¨å±€å”¯ä¸€çš„å€¼ï¼Ÿ<br>åœ¨é›†ç¾¤ç¯å¢ƒä¸‹è¿™ä¸ªæ€ä¹ˆä¿è¯å…¨å±€å”¯ä¸€çš„","like_count":0,"discussions":[{"author":{"id":1267678,"avatar":"https://static001.geekbang.org/account/avatar/00/13/57/de/1d24b93d.jpg","nickname":"LYOGA","note":"","ucode":"1FA142A2F94639","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":85727,"discussion_content":"åˆ†å¸ƒå¼å”¯ä¸€id","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1576569923,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":115881,"user_name":"miracle","can_delete":false,"product_type":"c1","uid":1276137,"ip_address":"","ucode":"FD7074F1062AE9","user_header":"https://static001.geekbang.org/account/avatar/00/13/78/e9/9d807269.jpg","comment_is_top":false,"comment_ctime":1563761228,"is_pvip":false,"discussion_count":1,"race_medal":0,"score":"1563761228","product_id":100020801,"comment_content":"GTID å’Œåœ¨çº¿ DDL è¿™éƒ¨åˆ†é‡Œé¢ æˆ‘çš„ç†è§£æ˜¯åœ¨GTIDæ¨¡å¼ä¸‹ ä¸»åº“X è·Ÿ å¤‡åº“Y éƒ½ä¸ç”¨å…³é—­binlogäº† å› ä¸ºXä¸Šæ‰§è¡Œå®Œç©ºäº‹åŠ¡å¹¶æäº¤GTIDä»¥åä¼šè‡ªåŠ¨è·³è¿‡è¿™ä¸ªDDLè¯­å¥å°±ä¸ä¼šé‡å¤æ‰§è¡Œäº† ä¸çŸ¥é“æˆ‘çš„ç†è§£æ˜¯ä¸æ˜¯å¯¹çš„ï¼Ÿ","like_count":0,"discussions":[{"author":{"id":1065351,"avatar":"https://static001.geekbang.org/account/avatar/00/10/41/87/d26efb2e.jpg","nickname":"SuperSnow","note":"","ucode":"84C89AA8083E6A","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":170169,"discussion_content":"æ˜¯çš„","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1581673490,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":112627,"user_name":"hal","can_delete":false,"product_type":"c1","uid":1359844,"ip_address":"","ucode":"98E625F7327FD9","user_header":"https://static001.geekbang.org/account/avatar/00/14/bf/e4/45758517.jpg","comment_is_top":false,"comment_ctime":1562775936,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1562775936","product_id":100020801,"comment_content":"è®¾ç½®å‚æ•°slave_exec_modeè®¾ç½®ä¸ºIDEMPOTENTæ¨¡å¼ï¼Œå¯ä»¥è®©ä»åº“è¿è¡Œåœ¨å¹‚ç­‰æ¨¡å¼<br>- write_row event é‡åˆ°ä¸»é”®å†²çªæˆ–å”¯ä¸€ç´¢å¼•å†²çªï¼Œè¿™ä¸€è¡Œè¢«è¦†å†™(delete + insert)ã€‚deleteæ—¶å€™ä¸æ˜¯full value matchï¼Œä»…éœ€è¦ä¸»é”®æˆ–å”¯ä¸€ç´¢å¼•æ‰¾åˆ°è®°å½•åˆ™åˆ é™¤<br>- delete_row event é‡åˆ°è®°å½•ä¸å­˜åœ¨ï¼Œå¿½ç•¥è¿™ä¸€è¡Œ<br>- update_row event ä¿®æ”¹å”¯ä¸€ç´¢å¼•å¯¼è‡´çš„å†²çªï¼Œå¿½ç•¥è¿™ä¸€è¡Œ<br><br>ä¸»ä»æŠ¥å”¯ä¸€é”®å†²çªä¹‹ç±»çš„é”™è¯¯ï¼Œè®¾ç½®è¿™ä¸ªå‚æ•°ä¹Ÿæ˜¯èƒ½è§£å†³çš„å§","like_count":0},{"had_liked":false,"id":105447,"user_name":"å†¥ç‹æ˜Ÿ","can_delete":false,"product_type":"c1","uid":1311603,"ip_address":"","ucode":"CA43C381A69736","user_header":"https://static001.geekbang.org/account/avatar/00/14/03/73/38397da1.jpg","comment_is_top":false,"comment_ctime":1561002868,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1561002868","product_id":100020801,"comment_content":"å¯ä»¥æ‰¾å‡ºæ–°ä¸»åº“æœ€æ™šbinlogæ—¶é—´åˆ°ç°åœ¨æ—¶é—´ä¹‹ä¸­æœ‰è¿‡ä¿®æ”¹çš„æ•°æ®åº“è¡¨æ ¼æ•°æ®åŒæ­¥ç»™ä»åº“ï¼Œè®©ä»åº“ç›´æ¥æ›´æ–°æ•°æ®å°±å¥½ï¼Ÿ","like_count":0},{"had_liked":false,"id":102142,"user_name":"æ™“æ°","can_delete":false,"product_type":"c1","uid":1441546,"ip_address":"","ucode":"1174C88EEBF8A6","user_header":"https://static001.geekbang.org/account/avatar/00/15/ff/0a/12faa44e.jpg","comment_is_top":false,"comment_ctime":1560150456,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1560150456","product_id":100020801,"comment_content":"è€å¸ˆèƒ½å¦æŠŠåœ¨çº¿åŠ ç´¢å¼•çš„å®Œæ•´æµç¨‹å†æè¿°ä¸€æ¬¡ï¼Œæœ€åé‚£é‡Œçœ‹çš„æœ‰ç‚¹æ‡µ","like_count":0},{"had_liked":false,"id":89948,"user_name":"å°ç°ç°zyh","can_delete":false,"product_type":"c1","uid":1323362,"ip_address":"","ucode":"47C5B1C7002FCD","user_header":"https://static001.geekbang.org/account/avatar/00/14/31/62/103e276b.jpg","comment_is_top":false,"comment_ctime":1556344915,"is_pvip":false,"discussion_count":1,"race_medal":0,"score":"1556344915","product_id":100020801,"comment_content":"è€å¸ˆæ‚¨å¥½ï¼Œåœ¨æ‰§è¡Œä¸»å¤‡åˆ‡æ¢çš„æ—¶å€™ä¼šå‡ºç°ä¸¤ç±»é”™è¯¯ï¼ˆ1062å’Œ1032ï¼‰ï¼Œä¸ºä»€ä¹ˆä¸ä¼šå‡ºç°æ›´æ–°çš„é”™è¯¯å‘¢ï¼Ÿä¿è¯ä¸å‡ºç°æ›´æ–°é”™è¯¯çš„å¤„ç†æœºåˆ¶æ˜¯æ€æ ·çš„ï¼Ÿ","like_count":0,"discussions":[{"author":{"id":1065351,"avatar":"https://static001.geekbang.org/account/avatar/00/10/41/87/d26efb2e.jpg","nickname":"SuperSnow","note":"","ucode":"84C89AA8083E6A","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":170172,"discussion_content":"æ›´æ–°å°±æŒ‰ç…§æ›´æ–°æ—¥å¿—é¡ºåºæ›´æ–°å°±å¯ä»¥äº†ã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1581673590,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":87209,"user_name":"åˆšåˆšæ","can_delete":false,"product_type":"c1","uid":1036271,"ip_address":"","ucode":"8EB712C249E238","user_header":"https://static001.geekbang.org/account/avatar/00/0f/cf/ef/723eb955.jpg","comment_is_top":false,"comment_ctime":1555548149,"is_pvip":false,"discussion_count":2,"race_medal":0,"score":"1555548149","product_id":100020801,"comment_content":"é—®ä¸ªé—®é¢˜ï¼Œæ—¢ç„¶æœ‰txid<br>äº†ï¼Œä¸ºä»€ä¹ˆä¸ç”¨?åˆè®¾è®¡ä¸€ä¸ªgtidå‘¢ï¼Ÿtxidçš„ä»£è¡¨æ•´ä¸ªäº‹åŠ¡ï¼Œæ„ä¹‰ä¸æ˜¯æ›´é‡è¦å—ï¼Ÿ","like_count":0,"discussions":[{"author":{"id":1181208,"avatar":"https://static001.geekbang.org/account/avatar/00/12/06/18/2fb33fe8.jpg","nickname":"chen","note":"","ucode":"94CE5D998F5EA2","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":309467,"discussion_content":"txid æ˜¯äº‹åŠ¡å¼€å§‹æ—¶åˆ†é…çš„ï¼Œé€’å¢é¡ºåºä¸æ˜¯commité¡ºåº\n\ngtid åé¢çš„gno æ˜¯æäº¤æ—¶é€’å¢çš„ï¼Œå¯ä»¥ä¿è¯commité¡ºåºï¼Œè¿™æ ·å°±å¯ä»¥ä¿è¯ æŸä¸ªgno åé¢çš„äº‹åŠ¡éƒ½å¯ä»¥ç¡®è®¤ä¸ºä»åº“æœªæ‰§è¡Œã€‚\né¿å…é›†åˆé‡Œä¸€ä¸ªä¸€ä¸ªçš„æ¯”è¾ƒgno å¯¹åº”çš„äº‹åŠ¡æ˜¯å¦å·²ç»è¢«ä»åº“æ‰§è¡Œ","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1601297279,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1065351,"avatar":"https://static001.geekbang.org/account/avatar/00/10/41/87/d26efb2e.jpg","nickname":"SuperSnow","note":"","ucode":"84C89AA8083E6A","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":170173,"discussion_content":"ç”¨çš„åœ°æ–¹ä¸åŒå§","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1581673650,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":86604,"user_name":"å¿µä½ å¦‚æ˜”","can_delete":false,"product_type":"c1","uid":1323531,"ip_address":"","ucode":"FCAD88AB57D084","user_header":"https://static001.geekbang.org/account/avatar/00/14/32/0b/981b4e93.jpg","comment_is_top":false,"comment_ctime":1555408414,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1555408414","product_id":100020801,"comment_content":"æ•¬çˆ±çš„è€å¸ˆï¼Œæˆ‘æœ‰ä¸€ä¸ªé—®é¢˜æƒ³è¦è¯·æ•™ï¼š<br><br>åŒä¸»æ¨¡å¼ä¸‹ï¼Œé‡‡ç”¨gtidå¤åˆ¶ã€‚è¿™ä¸ªåœºæ™¯ä¸­ï¼Œæ˜¯server idçš„ä¼˜å…ˆçº§å¤§è¿˜æ˜¯gtidå‘¢ï¼Ÿä¹Ÿå°±æ˜¯å…¶ä¸­ä¸€ä¸»æ¥æ”¶åˆ°ä»å¤‡åº“ä¼ æ¥çš„å’Œè‡ªå·±server idæ˜¯ç›¸åŒçš„ï¼Œä½†æ˜¯gtidåœ¨è‡ªå·±çš„binlogä¸­å¹¶æ²¡æœ‰è®°å½•ï¼Œé‚£ä¹ˆå®ƒæ˜¯å¦æ‰§è¡Œå‘¢ï¼Ÿ<br>ï¼ˆè¿™ç§åœºæ™¯çš„äº§ç”Ÿï¼šä¸»åº“A 13ç‚¹å®•æœºï¼Œæ•°æ®å…¨éƒ¨ä¸¢å¤±ï¼Œé‡‡ç”¨ä¹‹å‰çš„12çš„å¤‡ä»½æ¢å¤ï¼Œ12ç‚¹-13ç‚¹æœŸé—´ä¸»åº“Aæ­£å¸¸å·¥ä½œï¼Œé‚£æ¢å¤åï¼Œä¼šä¸ä¼š12-13ç‚¹çš„æ•°æ®ä¸¢å¤±å‘¢ï¼Œå› ä¸º12-13ç‚¹çš„æ•°æ®æ˜¯ç”±ä¸»åº“Aæ‰§è¡Œçš„ï¼Œé€šè¿‡Båº“å†ä¼ å›ä¸»åº“Açš„æ—¶å€™serveridæ˜¯æ²¡å˜çš„ï¼‰","like_count":0},{"had_liked":false,"id":76492,"user_name":"everyok22","can_delete":false,"product_type":"c1","uid":1213878,"ip_address":"","ucode":"3A3304CCDC5C5C","user_header":"","comment_is_top":false,"comment_ctime":1552619117,"is_pvip":false,"discussion_count":2,"race_medal":0,"score":"1552619117","product_id":100020801,"comment_content":"çœ‹å®Œäº†æ–‡ç« ï¼Œæˆ‘æœ‰ä¸¤ä¸ªé—®é¢˜ï¼š<br>1ï¼šåŸºäºä½ç‚¹çš„ä¸»å¤‡åˆ‡æ¢ï¼šåƒæ’å…¥æˆ–è€…åˆ é™¤ä¼šæŠ¥ç›¸åº”çš„é”™ï¼Œå¦‚æœæ˜¯æ›´æ–°ä¸€æ¡æ•°æ®å‘¢ï¼Œå°±ä¸ä¸€å®šæœ‰è¿™ç§é”™è¯·æç¤ºäº†ã€‚é‚£åŸºäºä½ç‚¹çš„ä¸»å¤‡åˆ‡æ¢æ˜¯ä¸æ˜¯è¿˜æ˜¯æœ‰å¯èƒ½ä¼šæœ‰é—®é¢˜å‘¢ï¼Ÿ<br>2ï¼šåŸºäºgtidçš„ä¸»å¤‡åˆ‡æ¢ï¼Œå¤‡åº“éœ€è¦æŠŠè®°å½•é‡Œæ‰€æœ‰çš„gtidé›†åˆå‘ç»™æ–°çš„ä¸»åº“ä¹ˆï¼Œ è¿™æ ·æ•°æ®é‡æ˜¯ä¸æ˜¯ä¹Ÿå¾ˆå¤§ã€‚è¿˜æ˜¯è¯´åªæ˜¯å‘æœ€æ–°çš„ä¸€éƒ¨åˆ†ã€‚<br>å¸Œæœ›è€å¸ˆèƒ½è§£æƒ‘","like_count":0,"discussions":[{"author":{"id":1065351,"avatar":"https://static001.geekbang.org/account/avatar/00/10/41/87/d26efb2e.jpg","nickname":"SuperSnow","note":"","ucode":"84C89AA8083E6A","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":170176,"discussion_content":"2ã€åˆ†æ®µ","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1581673741,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1065351,"avatar":"https://static001.geekbang.org/account/avatar/00/10/41/87/d26efb2e.jpg","nickname":"SuperSnow","note":"","ucode":"84C89AA8083E6A","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":170175,"discussion_content":"1ã€åº”è¯¥ä¸ä¼šå§ã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1581673727,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":63343,"user_name":"LeonğŸ“·","can_delete":false,"product_type":"c1","uid":1219496,"ip_address":"","ucode":"B9BBD1EFAAE5A2","user_header":"https://static001.geekbang.org/account/avatar/00/12/9b/a8/6a391c66.jpg","comment_is_top":false,"comment_ctime":1548329358,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1548329358","product_id":100020801,"comment_content":"ä»çš„æ‰§è¡Œæ˜¯<br>CHANGE MASTER TO <br>MASTER_HOST=&quot;172.27.27.2&quot;,<br>MASTER_PORT=3306,<br>MASTER_USER=&quot;ming&quot;,<br>MASTER_PASSWORD=&quot;123456&quot;,<br>master_auto_position=1;<br>start slave<br>","like_count":0},{"had_liked":false,"id":63342,"user_name":"LeonğŸ“·","can_delete":false,"product_type":"c1","uid":1219496,"ip_address":"","ucode":"B9BBD1EFAAE5A2","user_header":"https://static001.geekbang.org/account/avatar/00/12/9b/a8/6a391c66.jpg","comment_is_top":false,"comment_ctime":1548329295,"is_pvip":false,"replies":[{"id":"22610","content":"ä½ æŠŠè¿™ä¸ªcreate è¯­å¥ç›´æ¥åˆ°å¤‡åº“æ‰§è¡Œèƒ½æ‰§è¡Œå—ï¼Ÿ<br>","user_name":"ä½œè€…å›å¤","user_name_real":"æ—æ™“æ–Œ","uid":"1264162","ctime":1548608862,"ip_address":"","comment_id":63342,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1548329295","product_id":100020801,"comment_content":"è€å¸ˆï¼Œæˆ‘è¿™è¾¹dockerèµ·äº†ä¸¤ä¸ªmsyqlï¼Œä¸€ä¸»ä¸€ä»<br>ä¸»: <br>create user &#39;ming&#39;@&#39;172.27.27.2&#39; identified by &#39;123456&#39;;<br>GRANT REPLICATION SLAVE,RELOAD,SUPER ON *.* TO &#39;ming&#39;@&#39;%&#39;  WITH GRANT OPTION;<br>master 172.27.27.2 slave 172.27.27.3<br>ä»é‚£è¾¹æ— æ³•åŒæ­¥<br> Last_SQL_Errno: 1410<br> Last_SQL_Error: Error &#39;You are not allowed to create a user with GRANT&#39; on query. Default database: &#39;test&#39;. Query: &#39;GRANT REPLICATION SLAVE, REPLICATION CLIENT ON *.* TO &#39;slave&#39;@&#39;%&#39;&#39;<br>ç½‘ä¸ŠæŸ¥è¯¢æ˜¯æˆæƒé—®é¢˜ï¼Œä½†æ˜¯ä»å®¹å™¨å†…å¯ä»¥ç”¨mingçš„ç”¨æˆ·åå’Œå¯†ç ç™»å½•ä¸»mysql<br>æˆ‘å¢åŠ äº†æˆæƒè¿˜æ˜¯è¿™æ ·ï¼Œè¯·é—®æ˜¯ä»€ä¹ˆæƒ…å†µ","like_count":0,"discussions":[{"author":{"id":1264162,"avatar":"https://static001.geekbang.org/account/avatar/00/13/4a/22/2681d602.jpg","nickname":"æ—æ™“æ–Œ","note":"","ucode":"CDE42D44F26240","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":437557,"discussion_content":"ä½ æŠŠè¿™ä¸ªcreate è¯­å¥ç›´æ¥åˆ°å¤‡åº“æ‰§è¡Œèƒ½æ‰§è¡Œå—ï¼Ÿ\n","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1548608862,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":60677,"user_name":"ajlidue","can_delete":false,"product_type":"c1","uid":1308376,"ip_address":"","ucode":"D6B29E941958E8","user_header":"http://thirdwx.qlogo.cn/mmopen/vi_32/DYAIOgq83er6NXib2NGaTAAEe2KCcibH2FiafOOD73kQdcuAMGrnRib5CDWXum0SWDOM9NnWicbUsDpghmxEmJtpk9w/132","comment_is_top":false,"comment_ctime":1547529246,"is_pvip":false,"replies":[{"id":"21666","content":"2 æ˜¯okçš„<br><br>purge gtidæ˜¯å•¥","user_name":"ä½œè€…å›å¤","user_name_real":"æ—æ™“æ–Œ","uid":"1264162","ctime":1547551652,"ip_address":"","comment_id":60677,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1547529246","product_id":100020801,"comment_content":"1.purge gtidï¼Œ2.é‡åšå¤‡åº“æ•°æ®","like_count":0,"discussions":[{"author":{"id":1264162,"avatar":"https://static001.geekbang.org/account/avatar/00/13/4a/22/2681d602.jpg","nickname":"æ—æ™“æ–Œ","note":"","ucode":"CDE42D44F26240","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":436579,"discussion_content":"2 æ˜¯okçš„\n\npurge gtidæ˜¯å•¥","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1547551652,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":60574,"user_name":"Leo","can_delete":false,"product_type":"c1","uid":1126910,"ip_address":"","ucode":"341694ACBAB258","user_header":"https://static001.geekbang.org/account/avatar/00/11/31/fe/30a17a9d.jpg","comment_is_top":false,"comment_ctime":1547514872,"is_pvip":true,"replies":[{"id":"21574","content":"ä»Šæ™šå‘å¸ƒçš„ç¬¬28ç¯‡ä¼šæåˆ°å“ˆ","user_name":"ä½œè€…å›å¤","user_name_real":"æ—æ™“æ–Œ","uid":"1264162","ctime":1547518308,"ip_address":"","comment_id":60574,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1547514872","product_id":100020801,"comment_content":"è€å¸ˆä½ å¥½ï¼ŒPingCAPçš„å¤§ç‰›è¯´åˆ†å¸ƒå¼æ•°æ®åº“çš„ä¸€ä¸ªéš¾ç‚¹æ˜¯æ—¶é—´åŒæ­¥ã€‚æ­¤è¯æ€è®²ï¼Ÿmysqlä¸»ä»æ¶æ„ä¸‹æ—¶é—´ä¸åŒæ­¥ä¼šæœ‰å“ªäº›é—®é¢˜ï¼Ÿ","like_count":0,"discussions":[{"author":{"id":1264162,"avatar":"https://static001.geekbang.org/account/avatar/00/13/4a/22/2681d602.jpg","nickname":"æ—æ™“æ–Œ","note":"","ucode":"CDE42D44F26240","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":436546,"discussion_content":"ä»Šæ™šå‘å¸ƒçš„ç¬¬28ç¯‡ä¼šæåˆ°å“ˆ","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1547518308,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":60469,"user_name":"å°è¶…","can_delete":false,"product_type":"c1","uid":1068004,"ip_address":"","ucode":"FCC8B303A16E70","user_header":"https://static001.geekbang.org/account/avatar/00/10/4b/e4/0219e7c8.jpg","comment_is_top":false,"comment_ctime":1547476111,"is_pvip":false,"discussion_count":1,"race_medal":0,"score":"1547476111","product_id":100020801,"comment_content":"è€å¸ˆï¼Œé—®ä¸ªä¸Šä¸€ç¯‡çš„é—®é¢˜ï¼Œä»åº“ä¸æ˜¯åªæ ¹æ®binlogæ¥åšç›¸åº”çš„æ“ä½œä¹ˆï¼Œè¿™ä¸ªå¹¶è¡Œå¤åˆ¶ç­–ç•¥æ ¹æ®äº‹åŠ¡ç›¸åŒcommit_idåˆ¤æ–­å¥½ç†è§£ï¼Œä½†æ˜¯æ ¹æ®åŒæ—¶è¿›å…¥redo log prepare å’Œ commit æ¥åˆ¤æ–­è¿™ä¸ªæ€ä¹ˆç†è§£ï¼Ÿäº‹åŠ¡æäº¤çš„æ—¶å€™ï¼Œå…¶ä»–äº‹åŠ¡çš„redo logå¤„äºprepareçš„çŠ¶æ€äº‹åŠ¡çš„æŸä¸ªæ ‡è¯†ä¹Ÿä¼šè®°å½•åˆ°æ¯ä¸€ä¸ªäº‹åŠ¡çš„binlogä¸­ä¹ˆï¼Ÿ","like_count":0,"discussions":[{"author":{"id":1065351,"avatar":"https://static001.geekbang.org/account/avatar/00/10/41/87/d26efb2e.jpg","nickname":"SuperSnow","note":"","ucode":"84C89AA8083E6A","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":170177,"discussion_content":"çœ‹ä¸€ä¸‹ä¸¤é˜¶æ®µæäº¤","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1581673842,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":60252,"user_name":"è·¯è¿‡","can_delete":false,"product_type":"c1","uid":1316401,"ip_address":"","ucode":"7152C19ED024CC","user_header":"https://static001.geekbang.org/account/avatar/00/14/16/31/ae8adf82.jpg","comment_is_top":false,"comment_ctime":1547451778,"is_pvip":false,"replies":[{"id":"21543","content":"ä¸€ä¸ªæ˜¯å®ƒè‡ªå·±å§ï¼Ÿ<br>select @@server_uuid çœ‹çœ‹","user_name":"ä½œè€…å›å¤","user_name_real":"æ—æ™“æ–Œ","uid":"1264162","ctime":1547456360,"ip_address":"","comment_id":60252,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1547451778","product_id":100020801,"comment_content":"è€å¸ˆï¼Œè¯·æ•™ï¼š<br>show slave status\\Gçš„è¾“å‡ºä¸­ï¼ŒåŒ…å«å¦‚ä¸‹ï¼š<br>Executed_Gtid_Set: 572ece6c-e3ed-11e8-92c4-005056a509d8:1-1136659,<br>ecb34895-e3eb-11e8-80e9-005056a55d62:1-1015<br>æ˜¯ä¸æ˜¯è¡¨ç¤ºå½“å‰slaveæ›¾ç»å’Œä¸¤ä¸ªmasteråŒæ­¥è¿‡ï¼Ÿ","like_count":0,"discussions":[{"author":{"id":1264162,"avatar":"https://static001.geekbang.org/account/avatar/00/13/4a/22/2681d602.jpg","nickname":"æ—æ™“æ–Œ","note":"","ucode":"CDE42D44F26240","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":436460,"discussion_content":"ä¸€ä¸ªæ˜¯å®ƒè‡ªå·±å§ï¼Ÿ\nselect @@server_uuid çœ‹çœ‹","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1547456360,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]}]}