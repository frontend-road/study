{"id":534762,"title":"17｜更真实的云原生：实际搭建多节点的Kubernetes集群","content":"<p>你好，我是Chrono。</p><p>到今天，你学习这个专栏的进度就已经过半了，在前面的“入门篇”我们了解了Docker和容器技术，在“初级篇”我们掌握了Kubernetes的基本对象、原理和操作方法，一路走下来收获很多。</p><p>现在你应该对Kubernetes和容器编排有了一些初步的认识，那么接下来，让我们继续深入研究Kubernetes的其他API对象，也就是那些在Docker中不存在的但对云计算、集群管理至关重要的概念。</p><p>不过在那之前，我们还需要有一个比minikube更真实的Kubernetes环境，它应该是一个多节点的Kubernetes集群，这样更贴近现实中的生产系统，能够让我们尽快地拥有实际的集群使用经验。</p><p>所以在今天的这节课里，我们就来暂时忘掉minikube，改用kubeadm（<a href=\"https://kubernetes.io/zh/docs/reference/setup-tools/kubeadm/\">https://kubernetes.io/zh/docs/reference/setup-tools/kubeadm/</a>）搭建出一个新的Kubernetes集群，一起来看看更真实的云原生环境。</p><h2>什么是kubeadm</h2><p>前面的几节课里我们使用的都是minikube，它非常简单易用，不需要什么配置工作，就能够在单机环境里创建出一个功能完善的Kubernetes集群，给学习、开发、测试都带来了极大的便利。</p><!-- [[[read_end]]] --><p>不过minikube还是太“迷你”了，方便的同时也隐藏了很多细节，离真正生产环境里的计算集群有一些差距，毕竟许多需求、任务只有在多节点的大集群里才能够遇到，相比起来，minikube真的只能算是一个“玩具”。</p><p>那么，多节点的Kubernetes集群是怎么从无到有地创建出来的呢？</p><p><a href=\"https://time.geekbang.org/column/article/529800\">第10讲</a>说过Kubernetes是很多模块构成的，而实现核心功能的组件像apiserver、etcd、scheduler等本质上都是可执行文件，所以也可以采用和其他系统差不多的方式，使用Shell脚本或者Ansible等工具打包发布到服务器上。</p><p>不过Kubernetes里的这些组件的配置和相互关系实在是太复杂了，用Shell、Ansible来部署的难度很高，需要具有相当专业的运维管理知识才能配置、搭建好集群，而且即使这样，搭建的过程也非常麻烦。</p><p>为了简化Kubernetes的部署工作，让它能够更“接地气”，社区里就出现了一个专门用来在集群中安装Kubernetes的工具，名字就叫“<strong>kubeadm</strong>”，意思就是“Kubernetes管理员”。</p><p><img src=\"https://static001.geekbang.org/resource/image/f2/88/f27c7938cba21215621ac33635d63288.jpg?wh=1044x640\" alt=\"图片\"></p><p>kubeadm，原理和minikube类似，也是用容器和镜像来封装Kubernetes的各种组件，但它的目标不是单机部署，而是要能够轻松地在集群环境里部署Kubernetes，并且让这个集群接近甚至达到生产级质量。</p><p>而在保持这个高水准的同时，kubeadm还具有了和minikube一样的易用性，只要很少的几条命令，如 <code>init</code>、<code>join</code>、<code>upgrade</code>、<code>reset</code> 就能够完成Kubernetes集群的管理维护工作，这让它不仅适用于集群管理员，也适用于开发、测试人员。</p><h2>实验环境的架构是什么样的</h2><p>在使用kubeadm搭建实验环境之前，我们先来看看集群的架构设计，也就是说要准备好集群所需的硬件设施。</p><p>这里我画了一张系统架构图，图里一共有3台主机，当然它们都是使用虚拟机软件VirtualBox/VMWare虚拟出来的，下面我来详细说明一下：</p><p><img src=\"https://static001.geekbang.org/resource/image/yy/3e/yyf5db64d398b4d5dyyd5e8e23ece53e.jpg?wh=1920x1294\" alt=\"图片\"></p><p>所谓的多节点集群，要求服务器应该有两台或者更多，为了简化我们只取最小值，所以这个Kubernetes集群就只有两台主机，一台是Master节点，另一台是Worker节点。当然，在完全掌握了kubeadm的用法之后，你可以在这个集群里添加更多的节点。</p><p>Master节点需要运行apiserver、etcd、scheduler、controller-manager等组件，管理整个集群，所以对配置要求比较高，至少是2核CPU、4GB的内存。</p><p><img src=\"https://static001.geekbang.org/resource/image/d1/3c/d19a8ceafd4db10a5yy35c623384ba3c.png?wh=1504x920\" alt=\"图片\"></p><p>而Worker节点没有管理工作，只运行业务应用，所以配置可以低一些，为了节省资源我给它分配了1核CPU和1GB的内存，可以说是低到不能再低了。</p><p><img src=\"https://static001.geekbang.org/resource/image/ee/f3/eeee60b6e29d7b6c4c74f913ac663ef3.png?wh=1504x1024\" alt=\"图片\"></p><p>基于模拟生产环境的考虑，在Kubernetes集群之外还需要有一台起辅助作用的服务器。</p><p>它的名字叫Console，意思是控制台，我们要在上面安装命令行工具kubectl，所有对Kubernetes集群的管理命令都是从这台主机发出去的。这也比较符合实际情况，因为安全的原因，集群里的主机部署好之后应该尽量少直接登录上去操作。</p><p>要提醒你的是，Console这台主机只是逻辑上的概念，不一定要是独立，你在实际安装部署的时候完全可以复用之前minikube的虚拟机，或者直接使用Master/Worker节点作为控制台。</p><p>这3台主机共同组成了我们的实验环境，所以在配置的时候要注意它们的网络选项，必须是在同一个网段，你可以再回顾一下<a href=\"https://time.geekbang.org/column/article/528614\">课前准备</a>，保证它们使用的是同一个“Host-Only”（VirtualBox）或者“自定”（VMWare Fusion）网络。</p><h2>安装前的准备工作</h2><p>不过有了架构图里的这些主机之后，我们还不能立即开始使用kubeadm安装Kubernetes，因为Kubernetes对系统有一些特殊要求，我们必须还要在Master和Worker节点上做一些准备。</p><p>这些工作的详细信息你都可以在Kubernetes的官网上找到，但它们分散在不同的文档里，比较凌乱，所以我把它们整合到了这里，包括改主机名、改Docker配置、改网络设置、改交换分区这四步。</p><p>第一，由于Kubernetes使用主机名来区分集群里的节点，所以每个节点的hostname必须不能重名。你需要修改“<strong>/etc/hostname</strong>”这个文件，把它改成容易辨识的名字，比如Master节点就叫 <code>master</code>，Worker节点就叫 <code>worker</code>：</p><pre><code class=\"language-plain\">sudo vi /etc/hostname\n</code></pre><p>第二，虽然Kubernetes目前支持多种容器运行时，但Docker还是最方便最易用的一种，所以我们仍然继续使用Docker作为Kubernetes的底层支持，使用 <code>apt</code> 安装Docker Engine（可参考<a href=\"https://time.geekbang.org/column/article/528619\">第1讲</a>）。</p><p>安装完成后需要你再对Docker的配置做一点修改，在“<strong>/etc/docker/daemon.json</strong>”里把cgroup的驱动程序改成 <code>systemd</code> ，然后重启Docker的守护进程，具体的操作我列在了下面：</p><pre><code class=\"language-bash\">cat &lt;&lt;EOF | sudo tee /etc/docker/daemon.json\n{\n&nbsp; \"exec-opts\": [\"native.cgroupdriver=systemd\"],\n&nbsp; \"log-driver\": \"json-file\",\n&nbsp; \"log-opts\": {\n&nbsp; &nbsp; \"max-size\": \"100m\"\n&nbsp; },\n&nbsp; \"storage-driver\": \"overlay2\"\n}\nEOF\n\nsudo systemctl enable docker\nsudo systemctl daemon-reload\nsudo systemctl restart docker\n</code></pre><p>第三，为了让Kubernetes能够检查、转发网络流量，你需要修改iptables的配置，启用“br_netfilter”模块：</p><pre><code class=\"language-bash\">cat &lt;&lt;EOF | sudo tee /etc/modules-load.d/k8s.conf\nbr_netfilter\nEOF\n\ncat &lt;&lt;EOF | sudo tee /etc/sysctl.d/k8s.conf\nnet.bridge.bridge-nf-call-ip6tables = 1\nnet.bridge.bridge-nf-call-iptables = 1\nnet.ipv4.ip_forward=1 # better than modify /etc/sysctl.conf\nEOF\n\nsudo sysctl --system\n</code></pre><p>第四，你需要修改“<strong>/etc/fstab</strong>”，关闭Linux的swap分区，提升Kubernetes的性能：</p><pre><code class=\"language-plain\">sudo swapoff -a\nsudo sed -ri '/\\sswap\\s/s/^#?/#/' /etc/fstab\n</code></pre><p>完成之后，最好记得重启一下系统，然后给虚拟机拍个快照做备份，避免后续的操作失误导致重复劳动。</p><h2>安装kubeadm</h2><p>好，现在我们就要安装kubeadm了，在Master节点和Worker节点上都要做这一步。</p><p>kubeadm可以直接从Google自己的软件仓库下载安装，但国内的网络不稳定，很难下载成功，需要改用其他的软件源，这里我选择了国内的某云厂商：</p><pre><code class=\"language-plain\">sudo apt install -y apt-transport-https ca-certificates curl\n\ncurl https://mirrors.aliyun.com/kubernetes/apt/doc/apt-key.gpg | sudo apt-key add -\n\ncat &lt;&lt;EOF | sudo tee /etc/apt/sources.list.d/kubernetes.list\ndeb https://mirrors.aliyun.com/kubernetes/apt/ kubernetes-xenial main\nEOF\n\nsudo apt update\n</code></pre><p>更新了软件仓库，我们就可以用 <code>apt install</code> 获取kubeadm、kubelet和kubectl这三个安装必备工具了。apt默认会下载最新版本，但我们也可以指定版本号，比如使用和minikube相同的“1.23.3”：</p><pre><code class=\"language-plain\">sudo apt install -y kubeadm=1.23.3-00 kubelet=1.23.3-00 kubectl=1.23.3-00\n</code></pre><p>安装完成之后，你可以用 <code>kubeadm version</code>、<code>kubectl version</code> 来验证版本是否正确：</p><pre><code class=\"language-plain\">kubeadm version\nkubectl version --client\n</code></pre><p><img src=\"https://static001.geekbang.org/resource/image/72/c9/72d79f46d9132af0dca110d982eff1c9.png?wh=1408x306\" alt=\"图片\"></p><p>另外按照Kubernetes官网的要求，我们最好再使用命令 <code>apt-mark hold</code> ，锁定这三个软件的版本，避免意外升级导致版本错误：</p><pre><code class=\"language-plain\">sudo apt-mark hold kubeadm kubelet kubectl\n</code></pre><h2>下载Kubernetes组件镜像</h2><p>前面我说过，kubeadm把apiserver、etcd、scheduler等组件都打包成了镜像，以容器的方式启动Kubernetes，但这些镜像不是放在Docker Hub上，而是放在Google自己的镜像仓库网站gcr.io，而它在国内的访问很困难，直接拉取镜像几乎是不可能的。</p><p>所以我们需要采取一些变通措施，提前把镜像下载到本地。</p><p>使用命令 <code>kubeadm config images list</code> 可以查看安装Kubernetes所需的镜像列表，参数 <code>--kubernetes-version</code> 可以指定版本号：</p><pre><code class=\"language-plain\">kubeadm config images list --kubernetes-version v1.23.3\n\nk8s.gcr.io/kube-apiserver:v1.23.3\nk8s.gcr.io/kube-controller-manager:v1.23.3\nk8s.gcr.io/kube-scheduler:v1.23.3\nk8s.gcr.io/kube-proxy:v1.23.3\nk8s.gcr.io/pause:3.6\nk8s.gcr.io/etcd:3.5.1-0\nk8s.gcr.io/coredns/coredns:v1.8.6\n</code></pre><p>知道了镜像的名字和标签就好办了，我们有两种方法可以比较容易地获取这些镜像。</p><p>第一种方法是利用minikube。因为minikube本身也打包了Kubernetes的组件镜像，所以完全可以从它的节点里把这些镜像导出之后再拷贝过来。</p><p>具体做法也很简单，先启动minikube，然后 <code>minikube ssh</code> 登录进虚拟节点，用 <code>docker save -o</code> 命令把相应版本的镜像都保存下来，再用 <code>minikube cp</code> 拷贝到本地，剩下的事情就不用我多说了：</p><p><img src=\"https://static001.geekbang.org/resource/image/66/4f/6609a62525bbf5d77eb7331f9835244f.png?wh=1848x484\" alt=\"图片\"></p><p>这种方法安全可靠，不过操作上麻烦了些，所以就有了第二种方法，从国内的镜像网站下载然后再用 <code>docker tag</code> 改名，能够使用Shell编程实现自动化：</p><pre><code class=\"language-plain\">repo=registry.aliyuncs.com/google_containers\n\nfor name in `kubeadm config images list --kubernetes-version v1.23.3`; do\n\n&nbsp; &nbsp; src_name=${name#k8s.gcr.io/}\n&nbsp; &nbsp; src_name=${src_name#coredns/}\n\n&nbsp; &nbsp; docker pull $repo/$src_name\n\n&nbsp; &nbsp; docker tag $repo/$src_name $name\n&nbsp; &nbsp; docker rmi $repo/$src_name\ndone\n</code></pre><p>第二种方法速度快，但也有隐患，万一网站不提供服务，或者改动了镜像就比较危险了。</p><p>所以你可以把这两种方法结合起来，先用脚本从国内镜像仓库下载，然后再用minikube里的镜像做对比，只要IMAGE ID是一样就说明镜像是正确的。</p><p>这张截图就是Kubernetes 1.23.3的镜像列表（amd64/arm64），你在安装时可以参考：</p><p><img src=\"https://static001.geekbang.org/resource/image/11/5c/11d9d4c91b08d95e82e75406a4d3aa5c.png?wh=1920x353\" alt=\"图片\" title=\"amd64\"></p><p><img src=\"https://static001.geekbang.org/resource/image/52/6c/528d9913620015f594988e648eeac66c.png?wh=1920x420\" alt=\"图片\" title=\"arm64\"></p><h2>安装Master节点</h2><p>准备工作都做好了，现在就可以开始正式安装Kubernetes了，我们先从Master节点开始。</p><p>kubeadm的用法非常简单，只需要一个命令 <code>kubeadm init</code> 就可以把组件在Master节点上运行起来，不过它还有很多参数用来调整集群的配置，你可以用 <code>-h</code> 查看。这里我只说一下我们实验环境用到的3个参数：</p><ul>\n<li><strong>--pod-network-cidr</strong>，设置集群里Pod的IP地址段。</li>\n<li><strong>--apiserver-advertise-address</strong>，设置apiserver的IP地址，对于多网卡服务器来说很重要（比如VirtualBox虚拟机就用了两块网卡），可以指定apiserver在哪个网卡上对外提供服务。</li>\n<li><strong>--kubernetes-version</strong>，指定Kubernetes的版本号。</li>\n</ul><p>下面的这个安装命令里，我指定了Pod的地址段是“10.10.0.0/16”，apiserver的服务地址是“192.168.10.210”，Kubernetes的版本号是“1.23.3”：</p><pre><code class=\"language-plain\">sudo kubeadm init \\\n&nbsp; &nbsp; --pod-network-cidr=10.10.0.0/16 \\\n&nbsp; &nbsp; --apiserver-advertise-address=192.168.10.210 \\\n&nbsp; &nbsp; --kubernetes-version=v1.23.3\n</code></pre><p>因为我们已经提前把镜像下载到了本地，所以kubeadm的安装过程很快就完成了，它还会提示出接下来要做的工作：</p><pre><code class=\"language-plain\">To start using your cluster, you need to run the following as a regular user:\n\n&nbsp; mkdir -p $HOME/.kube\n&nbsp; sudo cp -i /etc/kubernetes/admin.conf $HOME/.kube/config\n&nbsp; sudo chown $(id -u):$(id -g) $HOME/.kube/config\n</code></pre><p>意思是要在本地建立一个“<strong>.kube</strong>”目录，然后拷贝kubectl的配置文件，你只要原样拷贝粘贴就行。</p><p>另外还有一个很重要的“<strong>kubeadm join</strong>”提示，其他节点要加入集群必须要用指令里的token和ca证书，所以这条命令务必拷贝后保存好：</p><pre><code class=\"language-plain\">Then you can join any number of worker nodes by running the following on each as root:\n\nkubeadm join 192.168.10.210:6443 --token tv9mkx.tw7it9vphe158e74 \\\n\t--discovery-token-ca-cert-hash sha256:e8721b8630d5b562e23c010c70559a6d3084f629abad6a2920e87855f8fb96f3\n</code></pre><p>安装完成后，你就可以使用 <code>kubectl version</code>、<code>kubectl get node</code> 来检查Kubernetes的版本和集群的节点状态了：</p><pre><code class=\"language-plain\">kubectl version\nkubectl get node\n</code></pre><p><img src=\"https://static001.geekbang.org/resource/image/c6/09/c63ce96bfyy0e1bc2927d575a66ee209.png?wh=1482x366\" alt=\"图片\"></p><p>你会注意到Master节点的状态是“NotReady”，这是由于还缺少网络插件，集群的内部网络还没有正常运作。</p><h2>安装Flannel网络插件</h2><p>Kubernetes定义了CNI标准，有很多网络插件，这里我选择最常用的<strong>Flannel</strong>，可以在它的GitHub仓库里（<a href=\"https://github.com/flannel-io/flannel/\">https://github.com/flannel-io/flannel/</a>）找到相关文档。</p><p>它安装也很简单，只需要使用项目的“<strong>kube-flannel.yml</strong>”在Kubernetes里部署一下就好了。不过因为它应用了Kubernetes的网段地址，你需要修改文件里的“<strong>net-conf.json</strong>”字段，把 <code>Network</code> 改成刚才kubeadm的参数 <code>--pod-network-cidr</code> 设置的地址段。</p><p>比如在这里，就要修改成“10.10.0.0/16”：</p><pre><code class=\"language-plain\">&nbsp; net-conf.json: |\n&nbsp; &nbsp; {\n&nbsp; &nbsp; &nbsp; \"Network\": \"10.10.0.0/16\",\n&nbsp; &nbsp; &nbsp; \"Backend\": {\n&nbsp; &nbsp; &nbsp; &nbsp; \"Type\": \"vxlan\"\n&nbsp; &nbsp; &nbsp; }\n&nbsp; &nbsp; }\n</code></pre><p>改好后，你就可以用 <code>kubectl apply</code> 来安装Flannel网络了：</p><pre><code class=\"language-plain\">kubectl apply -f kube-flannel.yml\n</code></pre><p>稍等一小会，等镜像拉取下来并运行之后，你就可以执行 <code>kubectl get node</code> 来看节点状态：</p><pre><code class=\"language-plain\">kubectl get node\n</code></pre><p><img src=\"https://static001.geekbang.org/resource/image/6a/7a/6a3c852abe5b193a6997b154163ed67a.png?wh=1434x184\" alt=\"图片\"></p><p>这时你应该能够看到Master节点的状态是“Ready”，表明节点网络也工作正常了。</p><h2>安装Worker节点</h2><p>如果你成功安装了Master节点，那么Worker节点的安装就简单多了，只需要用之前拷贝的那条 <code>kubeadm join</code> 命令就可以了，记得要用 <code>sudo</code> 来执行：</p><pre><code class=\"language-plain\">sudo \\\nkubeadm join 192.168.10.210:6443 --token tv9mkx.tw7it9vphe158e74 \\\n\t--discovery-token-ca-cert-hash sha256:e8721b8630d5b562e23c010c70559a6d3084f629abad6a2920e87855f8fb96f3\n</code></pre><p>它会连接Master节点，然后拉取镜像，安装网络插件，最后把节点加入集群。</p><p>当然，这个过程中同样也会遇到拉取镜像的问题，你可以如法炮制，提前把镜像下载到Worker节点本地，这样安装过程中就不会再有障碍了。</p><p>Worker节点安装完毕后，执行 <code>kubectl get node</code> ，就会看到两个节点都是“Ready”状态：</p><p><img src=\"https://static001.geekbang.org/resource/image/f7/26/f756ece9e81af80a7204243f15777026.png?wh=1430x246\" alt=\"图片\"></p><p>现在让我们用 <code>kubectl run</code> ，运行Nginx来测试一下：</p><pre><code class=\"language-plain\">kubectl run ngx --image=nginx:alpine\nkubectl get pod -o wide\n</code></pre><p><img src=\"https://static001.geekbang.org/resource/image/73/e9/73651e5f178e2daf6eaf7ac262e230e9.png?wh=1584x188\" alt=\"图片\"></p><p>会看到Pod运行在Worker节点上，IP地址是“10.10.1.2”，表明我们的Kubernetes集群部署成功。</p><h2>小结</h2><p>好了，把Master节点和Worker节点都安装好，我们今天的任务就算是基本完成了。</p><p>后面Console节点的部署工作更加简单，它只需要安装一个kubectl，然后复制“config”文件就行，你可以直接在Master节点上用“scp”远程拷贝，例如：</p><pre><code class=\"language-plain\">scp `which kubectl` chrono@192.168.10.208:~/\nscp ~/.kube/config chrono@192.168.10.208:~/.kube\n</code></pre><p>今天的过程多一些，要点我列在了下面：</p><ol>\n<li>kubeadm是一个方便易用的Kubernetes工具，能够部署生产级别的Kubernetes集群。</li>\n<li>安装Kubernetes之前需要修改主机的配置，包括主机名、Docker配置、网络设置、交换分区等。</li>\n<li>Kubernetes的组件镜像存放在gcr.io，国内下载比较麻烦，可以考虑从minikube或者国内镜像网站获取。</li>\n<li>安装Master节点需要使用命令 <code>kubeadm init</code>，安装Worker节点需要使用命令 <code>kubeadm join</code>，还要部署Flannel等网络插件才能让集群正常工作。</li>\n</ol><p>因为这些操作都是各种Linux命令，全手动敲下来确实很繁琐，所以我把这些步骤都做成了Shell脚本放在了GitHub上（<a href=\"https://github.com/chronolaw/k8s_study/tree/master/admin\">https://github.com/chronolaw/k8s_study/tree/master/admin</a>），你可以下载后直接运行。</p><h2>课下作业</h2><p>最后的课下作业是实际动手操作，请你多花费一些时间，用虚拟机创建出集群节点，再用kubeadm部署出这个多节点的Kubernetes环境，在接下来的“中级篇”和“高级篇”里我们就会在这个Kubernetes集群里做实验。</p><p>安装部署过程中有任何疑问，欢迎在留言区留言，我会第一时间回复你。如果觉得有帮助，也欢迎分享给自己身边的朋友一起学习，下节课见。</p><p><img src=\"https://static001.geekbang.org/resource/image/d3/41/d3d76937e5f4eb6545a07b96bc731e41.jpg?wh=1920x2513\" alt=\"图片\"></p>","neighbors":{"left":{"article_title":"16｜视频：初级篇实操总结","id":534688},"right":{"article_title":"18｜Deployment：让应用永不宕机","id":535209}},"comments":[{"had_liked":false,"id":356417,"user_name":"Obscure","can_delete":false,"product_type":"c1","uid":3171798,"ip_address":"北京","ucode":"8A7464990F4178","user_header":"https://static001.geekbang.org/account/avatar/00/30/65/d6/20670fd5.jpg","comment_is_top":false,"comment_ctime":1662285807,"is_pvip":false,"replies":[{"id":129762,"content":"这个方法不错，感谢分享。","user_name":"作者回复","user_name_real":"编辑","uid":1181974,"ctime":1662341417,"ip_address":"北京","comment_id":356417,"utype":1}],"discussion_count":5,"race_medal":0,"score":2,"product_id":100114501,"comment_content":"不需要写脚本来下载镜像啊，一条命令搞定：\nkubeadm init \\\n--apiserver-advertise-address=192.168.137.100 \\\n--image-repository registry.aliyuncs.com&#47;google_containers \\\n--kubernetes-version v1.23.6 \\\n--service-cidr=10.96.0.0&#47;12 \\\n--pod-network-cidr=10.244.0.0&#47;16","like_count":50,"discussions":[{"author":{"id":1181974,"avatar":"https://static001.geekbang.org/account/avatar/00/12/09/16/1161017c.jpg","nickname":"罗剑锋","note":"","ucode":"95678C988F24AB","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":586558,"discussion_content":"这个方法不错，感谢分享。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1662341417,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"北京","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1069269,"avatar":"https://static001.geekbang.org/account/avatar/00/10/50/d5/73334a95.jpg","nickname":"doos","note":"","ucode":"7C9AF67F90E65C","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":606549,"discussion_content":"可以自己搭建一个镜像仓库把所需要的镜像下载下来打tab推入镜像仓库直接从本地拉就行了","likes_number":1,"is_delete":false,"is_hidden":false,"ctime":1677212619,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":"浙江","group_id":0},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":2710540,"avatar":"https://static001.geekbang.org/account/avatar/00/29/5c/0c/e504ebfe.jpg","nickname":"vivi","note":"","ucode":"C9489CDCC37263","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":594443,"discussion_content":"--kubernetes-version v1.23.6 \n按文中的版本，可以修改成--kubernetes-version v1.23.3","likes_number":1,"is_delete":false,"is_hidden":false,"ctime":1669035786,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":"北京","group_id":0},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1121677,"avatar":"https://static001.geekbang.org/account/avatar/00/11/1d/8d/9717e593.jpg","nickname":"一枝梅","note":"","ucode":"7DCE43B638EA6A","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":625250,"discussion_content":"记得加一个 sudo 哦！","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1691486489,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":"北京","group_id":0},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":2515285,"avatar":"https://static001.geekbang.org/account/avatar/00/26/61/55/ddfd2859.jpg","nickname":"MRKT","note":"","ucode":"24699CA844EC21","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":590853,"discussion_content":"非常感谢您的分享！","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1666110537,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":"安徽","group_id":0},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":353383,"user_name":"朱雯","can_delete":false,"product_type":"c1","uid":1035744,"ip_address":"北京","ucode":"064C45FBF6B51F","user_header":"https://static001.geekbang.org/account/avatar/00/0f/cd/e0/c85bb948.jpg","comment_is_top":false,"comment_ctime":1659410379,"is_pvip":false,"replies":[{"id":128476,"content":"great","user_name":"作者回复","user_name_real":"编辑","uid":1181974,"ctime":1659421141,"ip_address":"北京","comment_id":353383,"utype":1}],"discussion_count":1,"race_medal":0,"score":2,"product_id":100114501,"comment_content":"终于跑起来了，提醒大家一件事，那就是新节点如何加入到k8s集群中，第一遍执行有提示，后续的话，可以执行kubeadm token create --print-join-command这条命令显示加入方式","like_count":15,"discussions":[{"author":{"id":1181974,"avatar":"https://static001.geekbang.org/account/avatar/00/12/09/16/1161017c.jpg","nickname":"罗剑锋","note":"","ucode":"95678C988F24AB","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":582389,"discussion_content":"great","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1659421141,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"北京","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":352944,"user_name":"怀朔","can_delete":false,"product_type":"c1","uid":1006865,"ip_address":"陕西","ucode":"52FAC1C2FD37B6","user_header":"https://static001.geekbang.org/account/avatar/00/0f/5d/11/e1f36640.jpg","comment_is_top":false,"comment_ctime":1659026416,"is_pvip":false,"replies":[{"id":128324,"content":"\n1.一步步来，不要着急。\n\n2.国内的我很少用，大家也都懂。\n\n3.什么都讲就会显得内容太多太杂，毕竟专栏的目标是入门，不是上生产系统。\n\n4.感谢建议，会和编辑考虑再改进。","user_name":"作者回复","user_name_real":"作者","uid":1181974,"ctime":1659060831,"ip_address":"陕西","comment_id":352944,"utype":1}],"discussion_count":6,"race_medal":0,"score":2,"product_id":100114501,"comment_content":"本章质量略显不足 .主要如下几点\n1、已经在考虑多节点不如把多集群考虑进去 这样才是真正的线上环境？\n2、因为网络问题 考虑仓库不足 如何直接引用国内云厂商镜像仓库？ 讲解如何把海外镜像复制国内镜像岂不是更好？\n3、生产中明显最关键是网络插件问题 和cidr块 网络冲突问题 通篇没有讲 令人略显单薄","like_count":15,"discussions":[{"author":{"id":1069269,"avatar":"https://static001.geekbang.org/account/avatar/00/10/50/d5/73334a95.jpg","nickname":"doos","note":"","ucode":"7C9AF67F90E65C","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":606550,"discussion_content":"我觉得讲的很好，入门就是这样， 难道你学的时候就直接上生产环境了","likes_number":2,"is_delete":false,"is_hidden":false,"ctime":1677212728,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":"浙江","group_id":0},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1181974,"avatar":"https://static001.geekbang.org/account/avatar/00/12/09/16/1161017c.jpg","nickname":"罗剑锋","note":"","ucode":"95678C988F24AB","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":581887,"discussion_content":"\n1.一步步来，不要着急。\n\n2.国内的我很少用，大家也都懂。\n\n3.什么都讲就会显得内容太多太杂，毕竟专栏的目标是入门，不是上生产系统。\n\n4.感谢建议，会和编辑考虑再改进。","likes_number":1,"is_delete":false,"is_hidden":false,"ctime":1659060832,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"陕西","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":2877396,"avatar":"https://static001.geekbang.org/account/avatar/00/2b/e7/d4/e6b21768.jpg","nickname":"fakecoder","note":"","ucode":"FE59E7DB989CB9","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":637482,"discussion_content":"关于第二点如何把海外镜像复制国内镜像呢","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1708553277,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":"河北","group_id":0},"score":2,"extra":"","child_discussion_number":2,"child_discussions":[{"author":{"id":1006865,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/5d/11/e1f36640.jpg","nickname":"怀朔","note":"","ucode":"52FAC1C2FD37B6","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":2877396,"avatar":"https://static001.geekbang.org/account/avatar/00/2b/e7/d4/e6b21768.jpg","nickname":"fakecoder","note":"","ucode":"FE59E7DB989CB9","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":637499,"discussion_content":"docker save load push、","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1708570534,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":637482,"ip_address":"浙江","group_id":0},"score":637499,"extra":""},{"author":{"id":1282556,"avatar":"https://static001.geekbang.org/account/avatar/00/13/91/fc/c6e7726a.jpg","nickname":"M","note":"","ucode":"9E528D9BA5D1FE","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":1006865,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/5d/11/e1f36640.jpg","nickname":"怀朔","note":"","ucode":"52FAC1C2FD37B6","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":637614,"discussion_content":"现在才回复？ 哈哈 \n","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1708679619,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":637499,"ip_address":"福建","group_id":0},"score":637614,"extra":""}]},{"author":{"id":1032236,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/c0/2c/87cc08ce.jpg","nickname":"baiyutang","note":"","ucode":"FD2436978BB447","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":584586,"discussion_content":"我记得有一个参数可以指定国内镜像地址的，可以留意下","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1660957216,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":"广东","group_id":0},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":353036,"user_name":"努力学习不准懈怠","can_delete":false,"product_type":"c1","uid":2898675,"ip_address":"陕西","ucode":"60D2C77230655F","user_header":"https://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTJo05FofKFWYN3joX4OyCfVrU2kK7xvKdZ4Ho7bof893fE0jXk1OcB5sKLk4C1SviaNlibAiaCtp8aww/132","comment_is_top":false,"comment_ctime":1659084419,"is_pvip":true,"replies":[{"id":128369,"content":"good","user_name":"作者回复","user_name_real":"编辑","uid":1181974,"ctime":1659098529,"ip_address":"陕西","comment_id":353036,"utype":1}],"discussion_count":2,"race_medal":0,"score":2,"product_id":100114501,"comment_content":"一定要关闭swap，不然kubelet无法启动！！！","like_count":14,"discussions":[{"author":{"id":1181974,"avatar":"https://static001.geekbang.org/account/avatar/00/12/09/16/1161017c.jpg","nickname":"罗剑锋","note":"","ucode":"95678C988F24AB","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":581983,"discussion_content":"good","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1659098530,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"陕西","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1069269,"avatar":"https://static001.geekbang.org/account/avatar/00/10/50/d5/73334a95.jpg","nickname":"doos","note":"","ucode":"7C9AF67F90E65C","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":606551,"discussion_content":"必须关闭swap，不然会影响k8s的性能，包括开启swap那么cgroup就失效了","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1677212861,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":"浙江","group_id":0},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":353211,"user_name":"hiDaLao","can_delete":false,"product_type":"c1","uid":2917100,"ip_address":"北京","ucode":"3C2DC2A3A377E4","user_header":"https://static001.geekbang.org/account/avatar/00/2c/82/ec/99b480e8.jpg","comment_is_top":false,"comment_ctime":1659266894,"is_pvip":false,"replies":[{"id":128409,"content":"great ","user_name":"作者回复","user_name_real":"编辑","uid":1181974,"ctime":1659275542,"ip_address":"北京","comment_id":353211,"utype":1}],"discussion_count":1,"race_medal":0,"score":2,"product_id":100114501,"comment_content":"1. 装环境时可先装一台然后克隆；\n2. kubeadm init时指定的apiserver的ip需要是自己环境上master节点的ip地址，如果指定错误，可通过sudo kubeadm reset重置；\n3. kube-flannel.yml 文件在仓库的Documentation目录下，只用copy到环境上修改下net-config.json里面的Network的地址即可；\n4. 执行scp ~&#47;.kube&#47;config到console节点时，需要先在console节点上通过mkdir ~&#47;.kube创建下目录","like_count":13,"discussions":[{"author":{"id":1181974,"avatar":"https://static001.geekbang.org/account/avatar/00/12/09/16/1161017c.jpg","nickname":"罗剑锋","note":"","ucode":"95678C988F24AB","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":582169,"discussion_content":"great ","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1659275542,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"北京","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":362579,"user_name":"项**","can_delete":false,"product_type":"c1","uid":3016447,"ip_address":"上海","ucode":"C346D19ADAAFC1","user_header":"https://static001.geekbang.org/account/avatar/00/2e/06/ff/047a7150.jpg","comment_is_top":false,"comment_ctime":1668652524,"is_pvip":false,"replies":[{"id":131845,"content":"great!","user_name":"作者回复","user_name_real":"编辑","uid":1181974,"ctime":1668652592,"ip_address":"上海","comment_id":362579,"utype":1}],"discussion_count":1,"race_medal":0,"score":2,"product_id":100114501,"comment_content":"1. --apiserver-advertise-address 参数指定成master的ip地址，不然初始化阶段会超时\n找这个问题找了很久\n\n2.初始话失败再重新尝试需要清空环境\n#重置\nsudo kubeadm reset\n#干掉kubelet进程\nps -ef|grep kubelet\nsudo kill -9 进程id\n#删掉配置目录\nsudo rm -rf  &#47;etc&#47;kubernetes&#47;manifests&#47;\n","like_count":12,"discussions":[{"author":{"id":1181974,"avatar":"https://static001.geekbang.org/account/avatar/00/12/09/16/1161017c.jpg","nickname":"罗剑锋","note":"","ucode":"95678C988F24AB","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":593914,"discussion_content":"great!","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1668652592,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"上海","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":354956,"user_name":"这里的人都叫我八进制","can_delete":false,"product_type":"c1","uid":1349002,"ip_address":"北京","ucode":"9F6C2D973E510E","user_header":"https://static001.geekbang.org/account/avatar/00/14/95/8a/d74cdda5.jpg","comment_is_top":false,"comment_ctime":1660906060,"is_pvip":false,"replies":[{"id":129113,"content":"欢迎经验分享。","user_name":"作者回复","user_name_real":"编辑","uid":1181974,"ctime":1660911557,"ip_address":"北京","comment_id":354956,"utype":1}],"discussion_count":7,"race_medal":0,"score":2,"product_id":100114501,"comment_content":"work节点NotReady解决办法\n\nKubeletNotReady runtime network not ready: NetworkReady=false reason:NetworkPluginNotReady message:docker: network plugin is not ready: cni config uninitialized\n1.  mkdir -p &#47;etc&#47;cni&#47;net.d\n\n2. vi 10-flannel.conflist\n\n{\n  &quot;name&quot;: &quot;cbr0&quot;,\n  &quot;plugins&quot;: [\n    {\n      &quot;type&quot;: &quot;flannel&quot;,\n      &quot;delegate&quot;: {\n        &quot;hairpinMode&quot;: true,\n        &quot;isDefaultGateway&quot;: true\n      }\n    },\n    {\n      &quot;type&quot;: &quot;portmap&quot;,\n      &quot;capabilities&quot;: {\n        &quot;portMappings&quot;: true\n      }\n    }\n  ]\n}\n\n\n3.\n\nsystemctl daemon-reload\n\nsystemctl restart kubelet","like_count":10,"discussions":[{"author":{"id":1181974,"avatar":"https://static001.geekbang.org/account/avatar/00/12/09/16/1161017c.jpg","nickname":"罗剑锋","note":"","ucode":"95678C988F24AB","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":584558,"discussion_content":"欢迎经验分享。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1660911557,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"北京","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1187130,"avatar":"https://static001.geekbang.org/account/avatar/00/12/1d/3a/cdf9c55f.jpg","nickname":"未来已来","note":"","ucode":"3A21ACFD53CB9C","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":626702,"discussion_content":"不知道为啥，只能使用 kubectl apply -f kube-flannel.yml 解决","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1693289520,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":"广东","group_id":0},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1598417,"avatar":"https://static001.geekbang.org/account/avatar/00/18/63/d1/20e8389a.jpg","nickname":"陈小强","note":"","ucode":"EA68B1E44455D0","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":606872,"discussion_content":"嗯嗯，很赞，在worker节点上面也要执行 kubectl apply -f kube-flannel.yml；\n如果worker上面执行不了kubectl，copy master节点的admin.conf过来即可","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1677471698,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":"广东","group_id":0},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1896681,"avatar":"https://static001.geekbang.org/account/avatar/00/1c/f0/e9/1ff0a3d5.jpg","nickname":"...","note":"","ucode":"E3694D4CED77E0","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":592376,"discussion_content":"管用啊，非常牛逼。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1667366794,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":"广东","group_id":0},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1394115,"avatar":"https://static001.geekbang.org/account/avatar/00/15/45/c3/775fe460.jpg","nickname":"rubys_","note":"","ucode":"931AD02864126A","race_medal":2,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":591524,"discussion_content":"遇到同样问题，完美解决","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1666612795,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":"中国台湾","group_id":0},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1020529,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/92/71/9fd7cd7a.jpg","nickname":"Daniel","note":"","ucode":"282E09B3146501","race_medal":0,"user_type":1,"is_pvip":true},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":587465,"discussion_content":"你咋这么牛B呀，完美解决我的问题，赞赞赞","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1663067480,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":"海南","group_id":0},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":2962899,"avatar":"https://static001.geekbang.org/account/avatar/00/2d/35/d3/8de43dd5.jpg","nickname":"Breeze","note":"","ucode":"8B6711F5B9D112","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":584573,"discussion_content":"果然管用","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1660918313,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":"广东","group_id":0},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":365051,"user_name":"stark","can_delete":false,"product_type":"c1","uid":1143399,"ip_address":"上海","ucode":"ADC5C2AE5B97C8","user_header":"https://static001.geekbang.org/account/avatar/00/11/72/67/aa52812a.jpg","comment_is_top":false,"comment_ctime":1672038783,"is_pvip":false,"replies":[{"id":132925,"content":"great！","user_name":"作者回复","user_name_real":"编辑","uid":1181974,"ctime":1672048444,"ip_address":"上海","comment_id":365051,"utype":1}],"discussion_count":1,"race_medal":0,"score":2,"product_id":100114501,"comment_content":"终于弄好了，坑不少 总结写在这里了 希望对朋友们有帮助https:&#47;&#47;blog.csdn.net&#47;xuezhiwu001&#47;article&#47;details&#47;128444657?spm=1001.2014.3001.5501","like_count":6,"discussions":[{"author":{"id":1181974,"avatar":"https://static001.geekbang.org/account/avatar/00/12/09/16/1161017c.jpg","nickname":"罗剑锋","note":"","ucode":"95678C988F24AB","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":597587,"discussion_content":"great！","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1672048444,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"上海","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":352997,"user_name":"小林子","can_delete":false,"product_type":"c1","uid":1145383,"ip_address":"陕西","ucode":"058C95ECBFE422","user_header":"https://static001.geekbang.org/account/avatar/00/11/7a/27/791d0f5e.jpg","comment_is_top":false,"comment_ctime":1659071715,"is_pvip":false,"replies":[{"id":128350,"content":"后面高级篇会用，flannel简单，而且现在不是我们学习的重点。","user_name":"作者回复","user_name_real":"编辑","uid":1181974,"ctime":1659077473,"ip_address":"陕西","comment_id":352997,"utype":1}],"discussion_count":1,"race_medal":0,"score":2,"product_id":100114501,"comment_content":"老师为啥不用 Calico 网络插件了","like_count":6,"discussions":[{"author":{"id":1181974,"avatar":"https://static001.geekbang.org/account/avatar/00/12/09/16/1161017c.jpg","nickname":"罗剑锋","note":"","ucode":"95678C988F24AB","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":581932,"discussion_content":"后面高级篇会用，flannel简单，而且现在不是我们学习的重点。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1659077473,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"陕西","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":353301,"user_name":"星亦辰","can_delete":false,"product_type":"c1","uid":1284592,"ip_address":"北京","ucode":"B0388FBFFDEE7E","user_header":"https://static001.geekbang.org/account/avatar/00/13/99/f0/d9343049.jpg","comment_is_top":false,"comment_ctime":1659341070,"is_pvip":true,"replies":[{"id":128446,"content":"great","user_name":"作者回复","user_name_real":"编辑","uid":1181974,"ctime":1659351198,"ip_address":"北京","comment_id":353301,"utype":1}],"discussion_count":1,"race_medal":0,"score":2,"product_id":100114501,"comment_content":"cat &lt;&lt;EOF | sudo tee &#47;etc&#47;yum.repos.d&#47;kubernetes.repo\n[kubernetes] \nname=Kubernetes \nbaseurl=https:&#47;&#47;mirrors.aliyun.com&#47;kubernetes&#47;yum&#47;repos&#47;kubernetes-el7-x86_64 \nenabled=1 \ngpgcheck=0 \nrepo_gpgcheck=0 \nEOF\n\n补充一个 Yum 的源 \n","like_count":4,"discussions":[{"author":{"id":1181974,"avatar":"https://static001.geekbang.org/account/avatar/00/12/09/16/1161017c.jpg","nickname":"罗剑锋","note":"","ucode":"95678C988F24AB","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":582289,"discussion_content":"great","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1659351198,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"北京","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":360562,"user_name":"老荀","can_delete":false,"product_type":"c1","uid":1214893,"ip_address":"上海","ucode":"C32E743518DECD","user_header":"https://static001.geekbang.org/account/avatar/00/12/89/ad/4efd929a.jpg","comment_is_top":false,"comment_ctime":1666663142,"is_pvip":false,"replies":[{"id":131178,"content":"要用kubectl就必须要拷贝.kube&#47;config文件，不管是在哪个节点上。\n\n操作步骤就是kubeadm init之后的那几条命令，和master节点的类似。","user_name":"作者回复","user_name_real":"编辑","uid":1181974,"ctime":1666668911,"ip_address":"上海","comment_id":360562,"utype":1}],"discussion_count":3,"race_medal":0,"score":3,"product_id":100114501,"comment_content":"master 节点能显示正常\n$ kubectl get node\nNAME     STATUS   ROLES                  AGE     VERSION\nmaster   Ready    control-plane,master   21m     v1.23.3\nworker   Ready    &lt;none&gt;                 3m56s   v1.23.3\n\n但是 worker 节点就显示\nThe connection to the server localhost:8080 was refused - did you specify the right host or port?\n\n上面的教程里，worker 节点不就是提前下好镜像和 使用 join 加入集群吗？也没说要 拷贝 什么 配置文件啊，而且 worker 节点下 &#47;etc&#47;kubernetes 下也只有 kubelet.conf 这个配置文件，和 master 节点的不一样（admin.conf) 求助老师","like_count":3,"discussions":[{"author":{"id":1181974,"avatar":"https://static001.geekbang.org/account/avatar/00/12/09/16/1161017c.jpg","nickname":"罗剑锋","note":"","ucode":"95678C988F24AB","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":591577,"discussion_content":"要用kubectl就必须要拷贝.kube/config文件，不管是在哪个节点上。\n\n操作步骤就是kubeadm init之后的那几条命令，和master节点的类似。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1666668911,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"上海","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1603030,"avatar":"https://static001.geekbang.org/account/avatar/00/18/75/d6/259e6ba2.jpg","nickname":"杜劲松","note":"","ucode":"36A213BD2DF424","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":598978,"discussion_content":"worker 节点下 /etc/kubernetes 下没有admin.conf，可以从主节点拷贝过去，我这样操作之后成功","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1673252259,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":"江苏","group_id":0},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":2710540,"avatar":"https://static001.geekbang.org/account/avatar/00/29/5c/0c/e504ebfe.jpg","nickname":"vivi","note":"","ucode":"C9489CDCC37263","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":594482,"discussion_content":"To start using your cluster, you need to run the following as a regular user:\n\n  mkdir -p $HOME/.kube\n  sudo cp -i /etc/kubernetes/admin.conf $HOME/.kube/config\n  sudo chown $(id -u):$(id -g) $HOME/.kube/config\n\nAlternatively, if you are the root user, you can run:\n\n  export KUBECONFIG=/etc/kubernetes/admin.conf\n......\n\ninit后终端有如上提示，那条export命令也要执行一波。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1669090480,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":"北京","group_id":0},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":355166,"user_name":"陈四丰","can_delete":false,"product_type":"c1","uid":1610789,"ip_address":"北京","ucode":"A4463BFD52FB4F","user_header":"https://static001.geekbang.org/account/avatar/00/18/94/25/3bf277e5.jpg","comment_is_top":false,"comment_ctime":1661149673,"is_pvip":false,"replies":[{"id":129238,"content":"great","user_name":"作者回复","user_name_real":"编辑","uid":1181974,"ctime":1661158005,"ip_address":"北京","comment_id":355166,"utype":1}],"discussion_count":1,"race_medal":0,"score":3,"product_id":100114501,"comment_content":"安装成功！\n中间遇到一个“坑”，提醒同学们。\n在运行https:&#47;&#47;github.com&#47;chronolaw&#47;k8s_study&#47;blob&#47;master&#47;admin&#47;master.sh的时候，一定要把注释掉的# --apiserver-advertise-address=192.168.10.210 换成自己的IP地址，并添加进去，否则会以10.0.x.x的IP运行。\n感谢罗老师，祝同学们学习顺利！","like_count":3,"discussions":[{"author":{"id":1181974,"avatar":"https://static001.geekbang.org/account/avatar/00/12/09/16/1161017c.jpg","nickname":"罗剑锋","note":"","ucode":"95678C988F24AB","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":584846,"discussion_content":"great","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1661158005,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"北京","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":353206,"user_name":"peter","can_delete":false,"product_type":"c1","uid":1058183,"ip_address":"北京","ucode":"261C3FC001DE2D","user_header":"https://static001.geekbang.org/account/avatar/00/10/25/87/f3a69d1b.jpg","comment_is_top":false,"comment_ctime":1659261750,"is_pvip":false,"replies":[{"id":128408,"content":"\n1.这个属于shell编程了，因为coredns镜像的名字比较特别，做了特殊处理。\n\n2.当然可以，但kubectl的config文件就得做个切换了。\n\n3.是的，第一个IP地址是节点的地址，必须是你自己的，第二个是集群里的IP地址，可以用这个10.10.0.0。","user_name":"作者回复","user_name_real":"编辑","uid":1181974,"ctime":1659270660,"ip_address":"北京","comment_id":353206,"utype":1}],"discussion_count":2,"race_medal":0,"score":3,"product_id":100114501,"comment_content":"请教老师几个问题：\nQ1：脚本为什么对src_name两次赋值？\n       脚本的for循环里面有如下两行：\n       src_name=${name#k8s.gcr.io&#47;}    \n       src_name=${src_name#coredns&#47;}\n       为什么对同一个src_name两次赋值？\n\nQ2：同一个虚拟机上是否可以同时按照minikube和kubeadm？\nQ3：apiserver的IP应该是自己的虚拟机的IP，Pod地址段和虚拟机IP无关，采用私有地址段即可，\n        是这样吗？\n        文中提到：“apiserver 的服务地址是“192.168.10.210””，这个地址是作者自己虚拟机的IP，\n        读者应该换成自己虚拟机的IP，是这样吗？\n        文中提到：“我指定了 Pod 的地址段是“10.10.0.0&#47;16””，Pod的IP段和虚拟机无关，读者的环境\n        也可以采用，对吗？","like_count":3,"discussions":[{"author":{"id":1181974,"avatar":"https://static001.geekbang.org/account/avatar/00/12/09/16/1161017c.jpg","nickname":"罗剑锋","note":"","ucode":"95678C988F24AB","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":582162,"discussion_content":"\n1.这个属于shell编程了，因为coredns镜像的名字比较特别，做了特殊处理。\n\n2.当然可以，但kubectl的config文件就得做个切换了。\n\n3.是的，第一个IP地址是节点的地址，必须是你自己的，第二个是集群里的IP地址，可以用这个10.10.0.0。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1659270660,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"北京","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1055810,"avatar":"https://static001.geekbang.org/account/avatar/00/10/1c/42/d3a0e33a.jpg","nickname":"希德小子","note":"","ucode":"0F3DA846858DBD","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":590772,"discussion_content":"这个src_name 有问题。无法正常从aliyun的镜像库拉取镜像，拼凑出来的：\ndocker pull  registry.cn-hangzhou.aliyuncs.com/google_containers/registry.k8s.io/kube-apiserver:v1.25.3","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1666074931,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":"广东","group_id":0},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":353001,"user_name":"Geek_8497e1","can_delete":false,"product_type":"c1","uid":2156419,"ip_address":"陕西","ucode":"3289E378B9D331","user_header":"http://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTLoxAjJG76r6Qib0G1rcQvVOmPc70biapxg6ny3RFX7L5KKaJdib6zUIEicvYmhyiaQeHScVMc8KjHTHIQ/132","comment_is_top":false,"comment_ctime":1659073511,"is_pvip":false,"replies":[{"id":128351,"content":"我没有太多发言权，可能还是得具体运维部门拍板才行。","user_name":"作者回复","user_name_real":"编辑","uid":1181974,"ctime":1659077506,"ip_address":"陕西","comment_id":353001,"utype":1}],"discussion_count":1,"race_medal":0,"score":3,"product_id":100114501,"comment_content":"请问，生产环境，老师建议用二进制还是kubeadmin","like_count":3,"discussions":[{"author":{"id":1181974,"avatar":"https://static001.geekbang.org/account/avatar/00/12/09/16/1161017c.jpg","nickname":"罗剑锋","note":"","ucode":"95678C988F24AB","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":581933,"discussion_content":"我没有太多发言权，可能还是得具体运维部门拍板才行。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1659077506,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"陕西","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":352989,"user_name":"rexzhao","can_delete":false,"product_type":"c1","uid":1112101,"ip_address":"陕西","ucode":"EFDAAACBE6D755","user_header":"https://static001.geekbang.org/account/avatar/00/10/f8/25/06c86919.jpg","comment_is_top":false,"comment_ctime":1659066021,"is_pvip":false,"replies":[{"id":128349,"content":"可以在专栏的GitHub仓库里找到，或者直接去flannel项目上获取。\n\n注意看YAML，它用的是“:|” ，表示的是一个长字符串，内容是json格式。","user_name":"作者回复","user_name_real":"编辑","uid":1181974,"ctime":1659077438,"ip_address":"陕西","comment_id":352989,"utype":1}],"discussion_count":2,"race_medal":0,"score":3,"product_id":100114501,"comment_content":"kube-flannel.yml 文件是在哪个位置？是从哪来的？ 修改的内容对吗好像不是 yml 文件格式。","like_count":3,"discussions":[{"author":{"id":1181974,"avatar":"https://static001.geekbang.org/account/avatar/00/12/09/16/1161017c.jpg","nickname":"罗剑锋","note":"","ucode":"95678C988F24AB","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":581931,"discussion_content":"可以在专栏的GitHub仓库里找到，或者直接去flannel项目上获取。\n\n注意看YAML，它用的是“:|” ，表示的是一个长字符串，内容是json格式。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1659077438,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"陕西","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1543643,"avatar":"https://static001.geekbang.org/account/avatar/00/17/8d/db/c9d3e368.jpg","nickname":"暴走的海鸽","note":"","ucode":"8FDDE0E05C5DE1","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":619498,"discussion_content":"专栏的github仓库里的yml和flannel不太一样呢","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1685182226,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":"广东","group_id":0},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":367081,"user_name":"poettian","can_delete":false,"product_type":"c1","uid":1144021,"ip_address":"北京","ucode":"26EE408F908D12","user_header":"https://static001.geekbang.org/account/avatar/00/11/74/d5/56b3a879.jpg","comment_is_top":false,"comment_ctime":1674897593,"is_pvip":false,"replies":[{"id":133758,"content":"这是为了把master node也作为worker node，所以安装了kubelet。","user_name":"作者回复","user_name_real":"编辑","uid":1181974,"ctime":1674955125,"ip_address":"北京","comment_id":367081,"utype":1}],"discussion_count":2,"race_medal":0,"score":3,"product_id":100114501,"comment_content":"master node 为啥会运行 kubelet 等组件呢？看前面的教程，这些组件不应该是只在 worker node 上运行的，毕竟master node上不会启动pod","like_count":2,"discussions":[{"author":{"id":1181974,"avatar":"https://static001.geekbang.org/account/avatar/00/12/09/16/1161017c.jpg","nickname":"罗剑锋","note":"","ucode":"95678C988F24AB","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":600897,"discussion_content":"这是为了把master node也作为worker node，所以安装了kubelet。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1674955125,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"北京","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1355073,"avatar":"https://static001.geekbang.org/account/avatar/00/14/ad/41/35895dcc.jpg","nickname":"april","note":"","ucode":"EBDE1CB01EC545","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":644753,"discussion_content":"api-server,etcd，controller manager,scheduler不也是pod嘛","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1715489870,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":"浙江","group_id":0},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":359696,"user_name":"逐書寄年","can_delete":false,"product_type":"c1","uid":2894626,"ip_address":"北京","ucode":"FCB3F4C591481C","user_header":"https://static001.geekbang.org/account/avatar/00/2c/2b/22/441c4e51.jpg","comment_is_top":false,"comment_ctime":1665757445,"is_pvip":false,"replies":[{"id":130853,"content":"用describe查看pod的状态，应该有一些提示信息。","user_name":"作者回复","user_name_real":"编辑","uid":1181974,"ctime":1665833570,"ip_address":"北京","comment_id":359696,"utype":1}],"discussion_count":3,"race_medal":1,"score":3,"product_id":100114501,"comment_content":"感謝老師詳盡的解說！我有的問題是：\n當我部屬完cluster，也成功加入 woker node 後，想嘗試啟動 nginx pod，使用 `kubectl get pod -o wide` 檢查狀態後，卻發現一直處於 `ContainerCreating` 的狀態。不知道有沒有線索可以知道從何 debug 呢？","like_count":2,"discussions":[{"author":{"id":2894626,"avatar":"https://static001.geekbang.org/account/avatar/00/2c/2b/22/441c4e51.jpg","nickname":"逐書寄年","note":"","ucode":"FCB3F4C591481C","race_medal":1,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":590655,"discussion_content":"非常感謝老師的提示！已經 debug 成功\n我看到的錯誤提示是 `network: open /run/flannel/subnet.env: no such file or directory`，經查詢後發現我的 master 跟 worker 不知道為什麼在指定目錄下都沒有 `subnet.env` 文件。於是照著網路上的案例在 master 跟 worker 都建立該文件便解決了\n\n附帶一提，我是在兩台樹莓派上各自裝 ubuntu server 作為 cluster 的練習，不曉得是不是因為這樣才會有一些區別。跟著這堂實戰課一路學下來感覺非常踏實，謝謝羅老師精心規劃的課程內容！\n\n```shell\n# subnet.env\nFLANNEL_NETWORK=10.10.0.0/16 # needs to be the private network of the cluster\nFLANNEL_SUBNET=10.10.0.1/24\nFLANNEL_MTU=1450\nFLANNEL_IPMASQ=true\n```","likes_number":2,"is_delete":false,"is_hidden":false,"ctime":1665974162,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":"美国","group_id":0},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1181974,"avatar":"https://static001.geekbang.org/account/avatar/00/12/09/16/1161017c.jpg","nickname":"罗剑锋","note":"","ucode":"95678C988F24AB","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":590513,"discussion_content":"用describe查看pod的状态，应该有一些提示信息。","likes_number":1,"is_delete":false,"is_hidden":false,"ctime":1665833571,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"北京","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1694157,"avatar":"https://static001.geekbang.org/account/avatar/00/19/d9/cd/cd6439b6.jpg","nickname":"大俊","note":"","ucode":"EBBE1FB3E58C41","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":592299,"discussion_content":"必须是私有网络，比如当前虚拟机的IP为10.37.129.3，可以用10.37.0.0/16和10.37.0.1/24","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1667291548,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":"河南","group_id":0},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":356721,"user_name":"xmr","can_delete":false,"product_type":"c1","uid":1009622,"ip_address":"北京","ucode":"1BBF165F91F10B","user_header":"https://static001.geekbang.org/account/avatar/00/0f/67/d6/2f5cb85c.jpg","comment_is_top":false,"comment_ctime":1662533157,"is_pvip":false,"replies":[{"id":129833,"content":"是的，这点一定要注意，192.168.10.210应该是master节点的IP地址。","user_name":"作者回复","user_name_real":"编辑","uid":1181974,"ctime":1662536233,"ip_address":"北京","comment_id":356721,"utype":1}],"discussion_count":1,"race_medal":0,"score":3,"product_id":100114501,"comment_content":"sudo kubeadm init \\\n    --pod-network-cidr=10.10.0.0&#47;16 \\\n    --apiserver-advertise-address=192.168.10.210 \\\n    --kubernetes-version=v1.23.3\n\n--apiserver-advertise-address=192.168.10.210要改为master虚拟机的ip，否则会报错","like_count":2,"discussions":[{"author":{"id":1181974,"avatar":"https://static001.geekbang.org/account/avatar/00/12/09/16/1161017c.jpg","nickname":"罗剑锋","note":"","ucode":"95678C988F24AB","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":586841,"discussion_content":"是的，这点一定要注意，192.168.10.210应该是master节点的IP地址。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1662536233,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"北京","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":353345,"user_name":"pyhhou","can_delete":false,"product_type":"c1","uid":1256496,"ip_address":"北京","ucode":"31EF8D50CF91A5","user_header":"http://thirdwx.qlogo.cn/mmopen/vi_32/ibZVAmmdAibBeVpUjzwId8ibgRzNk7fkuR5pgVicB5mFSjjmt2eNadlykVLKCyGA0GxGffbhqLsHnhDRgyzxcKUhjg/132","comment_is_top":false,"comment_ctime":1659375928,"is_pvip":false,"replies":[{"id":128461,"content":"建议用kubeadm reset，弄个干净的环境再试试。","user_name":"作者回复","user_name_real":"编辑","uid":1181974,"ctime":1659405614,"ip_address":"北京","comment_id":353345,"utype":1}],"discussion_count":4,"race_medal":0,"score":3,"product_id":100114501,"comment_content":"老师，在配置 Master 节点的时候有问题，报错如下\n\nppeng@master:~$ sudo kubeadm init \\\n    --pod-network-cidr=10.10.0.0&#47;16 \\\n    --apiserver-advertise-address=192.168.10.210 \\\n    --kubernetes-version=v1.23.3\n[sudo] password for ppeng:\n[init] Using Kubernetes version: v1.23.3\n[preflight] Running pre-flight checks\nerror execution phase preflight: [preflight] Some fatal errors occurred:\n\t[ERROR Port-10259]: Port 10259 is in use\n\t[ERROR Port-10257]: Port 10257 is in use\n\t[ERROR FileAvailable--etc-kubernetes-manifests-kube-apiserver.yaml]: &#47;etc&#47;kubernetes&#47;manifests&#47;kube-apiserver.yaml already exists\n\t[ERROR FileAvailable--etc-kubernetes-manifests-kube-controller-manager.yaml]: &#47;etc&#47;kubernetes&#47;manifests&#47;kube-controller-manager.yaml already exists\n\t[ERROR FileAvailable--etc-kubernetes-manifests-kube-scheduler.yaml]: &#47;etc&#47;kubernetes&#47;manifests&#47;kube-scheduler.yaml already exists\n\t[ERROR FileAvailable--etc-kubernetes-manifests-etcd.yaml]: &#47;etc&#47;kubernetes&#47;manifests&#47;etcd.yaml already exists\n\t[ERROR Port-10250]: Port 10250 is in use\n[preflight] If you know what you are doing, you can make a check non-fatal with `--ignore-preflight-errors=...`\nTo see the stack trace of this error execute with --v=5 or higher\n\n前面的步骤都已成功，docker 也成功拉取了镜像，不清楚这里报错的原因是什么","like_count":2,"discussions":[{"author":{"id":1181974,"avatar":"https://static001.geekbang.org/account/avatar/00/12/09/16/1161017c.jpg","nickname":"罗剑锋","note":"","ucode":"95678C988F24AB","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":582349,"discussion_content":"建议用kubeadm reset，弄个干净的环境再试试。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1659405614,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"北京","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1355073,"avatar":"https://static001.geekbang.org/account/avatar/00/14/ad/41/35895dcc.jpg","nickname":"april","note":"","ucode":"EBDE1CB01EC545","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":644754,"discussion_content":"重复初始化","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1715490010,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":"浙江","group_id":0},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":2710540,"avatar":"https://static001.geekbang.org/account/avatar/00/29/5c/0c/e504ebfe.jpg","nickname":"vivi","note":"","ucode":"C9489CDCC37263","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":593940,"discussion_content":"看到「Port 10259 is in use」之类的盲猜是第一次init没有改IP，改好后第二次init报了这个端口占用！先sudo kubeadm reset再init即可。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1668664355,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":"北京","group_id":0},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1646052,"avatar":"https://static001.geekbang.org/account/avatar/00/19/1d/e4/975bd580.jpg","nickname":"灯芯草爱学习","note":"","ucode":"D37530955CF919","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":589576,"discussion_content":"借楼，--apiserver-advertise-address=192.168.10.210要改为master虚拟机的ip，否则会报错","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1665135858,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":"上海","group_id":0},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":353296,"user_name":"新时代农民工","can_delete":false,"product_type":"c1","uid":1225689,"ip_address":"北京","ucode":"0AA60DEDF6C062","user_header":"https://static001.geekbang.org/account/avatar/00/12/b3/d9/cf061262.jpg","comment_is_top":false,"comment_ctime":1659337205,"is_pvip":false,"replies":[{"id":128439,"content":"应该是master节点不参与业务吧，可以试着把污点去掉。","user_name":"作者回复","user_name_real":"编辑","uid":1181974,"ctime":1659340241,"ip_address":"北京","comment_id":353296,"utype":1}],"discussion_count":1,"race_medal":0,"score":3,"product_id":100114501,"comment_content":"老师请问下，成功按文中操作搭建集群，在测试运行 Nginx 的时候，通过expose 端口在NodePort， 为何只能在worker的node上访问， 而在master节点上，通过本地ip访问不了呢","like_count":2,"discussions":[{"author":{"id":1181974,"avatar":"https://static001.geekbang.org/account/avatar/00/12/09/16/1161017c.jpg","nickname":"罗剑锋","note":"","ucode":"95678C988F24AB","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":582261,"discussion_content":"应该是master节点不参与业务吧，可以试着把污点去掉。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1659340242,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"北京","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":353108,"user_name":"Geek_b537b2","can_delete":false,"product_type":"c1","uid":2547775,"ip_address":"陕西","ucode":"2C1848B32987E8","user_header":"https://thirdwx.qlogo.cn/mmopen/vi_32/DYAIOgq83eqF6ViaDyAibEKbcKfWoGXe8lCbb8wqes5g3JezHWNLf4DIl92QwXX43HWv408BxzkOKmKb2HpKJuIw/132","comment_is_top":false,"comment_ctime":1659171857,"is_pvip":false,"replies":[{"id":128393,"content":"thanks","user_name":"作者回复","user_name_real":"编辑","uid":1181974,"ctime":1659174309,"ip_address":"陕西","comment_id":353108,"utype":1}],"discussion_count":1,"race_medal":0,"score":4,"product_id":100114501,"comment_content":"入门好教程","like_count":2,"discussions":[{"author":{"id":1181974,"avatar":"https://static001.geekbang.org/account/avatar/00/12/09/16/1161017c.jpg","nickname":"罗剑锋","note":"","ucode":"95678C988F24AB","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":582061,"discussion_content":"thanks","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1659174309,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"陕西","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":353051,"user_name":"你的笑忘书","can_delete":false,"product_type":"c1","uid":1521181,"ip_address":"北京","ucode":"9665D5E9EDBEA6","user_header":"https://static001.geekbang.org/account/avatar/00/17/36/1d/f5486ffe.jpg","comment_is_top":false,"comment_ctime":1659093452,"is_pvip":false,"replies":[{"id":128388,"content":"我是开发背景，对系统管理不是太了解，但显然生产中使用kubeadm要比我们课程里要考虑更多的东西，比如证书安全、高可用等等，建议去咨询更专业的同事。","user_name":"作者回复","user_name_real":"编辑","uid":1181974,"ctime":1659138715,"ip_address":"北京","comment_id":353051,"utype":1}],"discussion_count":1,"race_medal":0,"score":4,"product_id":100114501,"comment_content":"希望老师补充下生产中，使用 kubeadm 部署集群的话，有哪些务必需要注意的点。","like_count":2,"discussions":[{"author":{"id":1181974,"avatar":"https://static001.geekbang.org/account/avatar/00/12/09/16/1161017c.jpg","nickname":"罗剑锋","note":"","ucode":"95678C988F24AB","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":582016,"discussion_content":"我是开发背景，对系统管理不是太了解，但显然生产中使用kubeadm要比我们课程里要考虑更多的东西，比如证书安全、高可用等等，建议去咨询更专业的同事。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1659138716,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"北京","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":353009,"user_name":"进击的土豆","can_delete":false,"product_type":"c1","uid":1948043,"ip_address":"陕西","ucode":"52249892A6C203","user_header":"https://static001.geekbang.org/account/avatar/00/1d/b9/8b/d0763d9a.jpg","comment_is_top":false,"comment_ctime":1659075674,"is_pvip":false,"replies":[{"id":128353,"content":"kubeadm是Kubernetes的安装部署工具，RKE是rancher公司的Kubernetes发行版，类似GKE，可以搜一下。","user_name":"作者回复","user_name_real":"编辑","uid":1181974,"ctime":1659077618,"ip_address":"陕西","comment_id":353009,"utype":1}],"discussion_count":1,"race_medal":0,"score":4,"product_id":100114501,"comment_content":"老师，kubeadm和rke的区别是什么","like_count":2,"discussions":[{"author":{"id":1181974,"avatar":"https://static001.geekbang.org/account/avatar/00/12/09/16/1161017c.jpg","nickname":"罗剑锋","note":"","ucode":"95678C988F24AB","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":581935,"discussion_content":"kubeadm是Kubernetes的安装部署工具，RKE是rancher公司的Kubernetes发行版，类似GKE，可以搜一下。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1659077618,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"陕西","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":352967,"user_name":"无名无姓","can_delete":false,"product_type":"c1","uid":2621412,"ip_address":"陕西","ucode":"487BD5AA2CD305","user_header":"https://static001.geekbang.org/account/avatar/00/27/ff/e4/927547a9.jpg","comment_is_top":false,"comment_ctime":1659058187,"is_pvip":false,"replies":[{"id":128330,"content":"继续努力。","user_name":"作者回复","user_name_real":"编辑","uid":1181974,"ctime":1659064147,"ip_address":"陕西","comment_id":352967,"utype":1}],"discussion_count":1,"race_medal":0,"score":4,"product_id":100114501,"comment_content":"理解起来很方便","like_count":2,"discussions":[{"author":{"id":1181974,"avatar":"https://static001.geekbang.org/account/avatar/00/12/09/16/1161017c.jpg","nickname":"罗剑锋","note":"","ucode":"95678C988F24AB","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":581901,"discussion_content":"继续努力。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1659064147,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"陕西","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":352960,"user_name":"dst","can_delete":false,"product_type":"c1","uid":1861196,"ip_address":"陕西","ucode":"9177BBB6C8B905","user_header":"https://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTKx6EdicYYuYK745brMa9yAlkZs2YmzxRAm4BQ2kw9GbtcC8ebnQlyBfIJnGjH57ib4HVlQIpSbTrBw/132","comment_is_top":false,"comment_ctime":1659056129,"is_pvip":false,"replies":[{"id":128322,"content":"thanks。","user_name":"作者回复","user_name_real":"编辑","uid":1181974,"ctime":1659057368,"ip_address":"陕西","comment_id":352960,"utype":1}],"discussion_count":1,"race_medal":0,"score":4,"product_id":100114501,"comment_content":"终于到中级篇了，老师讲得很好，比较全面，尤其是画图的思维导图总结很实用","like_count":2,"discussions":[{"author":{"id":1181974,"avatar":"https://static001.geekbang.org/account/avatar/00/12/09/16/1161017c.jpg","nickname":"罗剑锋","note":"","ucode":"95678C988F24AB","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":581877,"discussion_content":"thanks。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1659057368,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"陕西","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":352959,"user_name":"美妙的代码","can_delete":false,"product_type":"c1","uid":1111985,"ip_address":"陕西","ucode":"9DADD72C193296","user_header":"https://static001.geekbang.org/account/avatar/00/10/f7/b1/982ea185.jpg","comment_is_top":false,"comment_ctime":1659055588,"is_pvip":true,"replies":[{"id":128327,"content":"应该有的，不过我了解的不多。","user_name":"作者回复","user_name_real":"编辑","uid":1181974,"ctime":1659062221,"ip_address":"陕西","comment_id":352959,"utype":1}],"discussion_count":4,"race_medal":1,"score":4,"product_id":100114501,"comment_content":"为什么到目前为止，各大云计算公司大厂都没有做一个gcr.io  k8s的同步镜像站呢","like_count":2,"discussions":[{"author":{"id":1181974,"avatar":"https://static001.geekbang.org/account/avatar/00/12/09/16/1161017c.jpg","nickname":"罗剑锋","note":"","ucode":"95678C988F24AB","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":581892,"discussion_content":"应该有的，不过我了解的不多。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1659062221,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"陕西","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1087879,"avatar":"https://static001.geekbang.org/account/avatar/00/10/99/87/5066026c.jpg","nickname":"dao","note":"","ucode":"4181FB270462CF","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":583398,"discussion_content":"清华大学镜像 https://mirrors.tuna.tsinghua.edu.cn/help/kubernetes/","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1660097149,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":"新加坡","group_id":0},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1808649,"avatar":"http://thirdwx.qlogo.cn/mmopen/vi_32/DYAIOgq83eoHXbWPZuBKJBYiayL1qFLwKZCM76CPEwXcREia71QCiaMJ5Im5Iibt9CvQBPunQ01VVOm9xU4ia0zasYQ/132","nickname":"Grour","note":"","ucode":"E688BDC7F305AB","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":582255,"discussion_content":"有，但只限于购买云服务器的内网使用","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1659339222,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":"北京","group_id":0},"score":2,"extra":"","child_discussion_number":1,"child_discussions":[{"author":{"id":1111985,"avatar":"https://static001.geekbang.org/account/avatar/00/10/f7/b1/982ea185.jpg","nickname":"美妙的代码","note":"","ucode":"9DADD72C193296","race_medal":1,"user_type":1,"is_pvip":true},"reply_author":{"id":1808649,"avatar":"http://thirdwx.qlogo.cn/mmopen/vi_32/DYAIOgq83eoHXbWPZuBKJBYiayL1qFLwKZCM76CPEwXcREia71QCiaMJ5Im5Iibt9CvQBPunQ01VVOm9xU4ia0zasYQ/132","nickname":"Grour","note":"","ucode":"E688BDC7F305AB","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":582283,"discussion_content":"哪个平台。什么服务？","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1659349069,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":582255,"ip_address":"四川","group_id":0},"score":582283,"extra":""}]}]},{"had_liked":false,"id":352950,"user_name":"Sports","can_delete":false,"product_type":"c1","uid":1757265,"ip_address":"陕西","ucode":"1AC6035DFA4ECB","user_header":"https://static001.geekbang.org/account/avatar/00/1a/d0/51/f1c9ae2d.jpg","comment_is_top":false,"comment_ctime":1659050727,"is_pvip":false,"replies":[{"id":128326,"content":"全程实录，笑。","user_name":"作者回复","user_name_real":"编辑","uid":1181974,"ctime":1659062181,"ip_address":"陕西","comment_id":352950,"utype":1}],"discussion_count":1,"race_medal":0,"score":4,"product_id":100114501,"comment_content":"还是挺翔实的搭建教程!","like_count":2,"discussions":[{"author":{"id":1181974,"avatar":"https://static001.geekbang.org/account/avatar/00/12/09/16/1161017c.jpg","nickname":"罗剑锋","note":"","ucode":"95678C988F24AB","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":581891,"discussion_content":"全程实录，笑。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1659062181,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"陕西","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":352949,"user_name":"西门吹牛","can_delete":false,"product_type":"c1","uid":1508990,"ip_address":"陕西","ucode":"E5D3624DDE1E83","user_header":"https://static001.geekbang.org/account/avatar/00/17/06/7e/735968e2.jpg","comment_is_top":false,"comment_ctime":1659049865,"is_pvip":false,"replies":[{"id":128325,"content":"各人有各人的看法，最权威的就得看CNCF。","user_name":"作者回复","user_name_real":"编辑","uid":1181974,"ctime":1659060865,"ip_address":"陕西","comment_id":352949,"utype":1}],"discussion_count":2,"race_medal":0,"score":4,"product_id":100114501,"comment_content":"云原生三个字怎么理解","like_count":2,"discussions":[{"author":{"id":1181974,"avatar":"https://static001.geekbang.org/account/avatar/00/12/09/16/1161017c.jpg","nickname":"罗剑锋","note":"","ucode":"95678C988F24AB","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":581888,"discussion_content":"各人有各人的看法，最权威的就得看CNCF。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1659060865,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"陕西","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1521181,"avatar":"https://static001.geekbang.org/account/avatar/00/17/36/1d/f5486ffe.jpg","nickname":"你的笑忘书","note":"","ucode":"9665D5E9EDBEA6","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":581974,"discussion_content":"云就是K8s，原生应用就是你用编程语言开发的应用。🫣上云那就是把你的原生应用托管到K8s中。云的方式不限制，公有云，私有云，以及混合云。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1659093298,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":"陕西","group_id":0},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":379481,"user_name":"Geek_e47add","can_delete":false,"product_type":"c1","uid":3691767,"ip_address":"浙江","ucode":"629B94FD154536","user_header":"","comment_is_top":false,"comment_ctime":1692006627,"is_pvip":false,"replies":[{"id":138238,"content":"应该是kubectl的配置不对吧，用的原来minikube的配置文件，需要改用kubeadm master节点的config文件。","user_name":"作者回复","user_name_real":"编辑","uid":1181974,"ctime":1692011124,"ip_address":"黑龙江","comment_id":379481,"utype":1}],"discussion_count":1,"race_medal":0,"score":4,"product_id":100114501,"comment_content":"init k8s 成功后使用 kubectl get node 显示error: no server found for cluster &quot;minikube&quot;，请问这是什么原因，然后我启动miniukube查kubectl get node只显示minikube这个节点\n","like_count":1,"discussions":[{"author":{"id":1181974,"avatar":"https://static001.geekbang.org/account/avatar/00/12/09/16/1161017c.jpg","nickname":"罗剑锋","note":"","ucode":"95678C988F24AB","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":625643,"discussion_content":"应该是kubectl的配置不对吧，用的原来minikube的配置文件，需要改用kubeadm master节点的config文件。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1692011124,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"黑龙江","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":375270,"user_name":"小马哥","can_delete":false,"product_type":"c1","uid":1358045,"ip_address":"中国台湾","ucode":"B2C0FF38F8C9BC","user_header":"https://static001.geekbang.org/account/avatar/00/14/b8/dd/37726c34.jpg","comment_is_top":false,"comment_ctime":1685193874,"is_pvip":false,"replies":[{"id":136968,"content":"awesome！","user_name":"作者回复","user_name_real":"编辑","uid":1181974,"ctime":1685328834,"ip_address":"上海","comment_id":375270,"utype":1}],"discussion_count":1,"race_medal":0,"score":4,"product_id":100114501,"comment_content":"和我一样在虚拟机安装master节点, 然后通过克隆方式创建worker节点的小伙伴, 可能会遇到和我一样的问题: 在一切配置完成之后, 启动测试一个pod(nginx:alpine)会遇到该pod一直在创建中.\n执行kubectl describe pod ngx, 发现&quot;Failed to create pod sandbox: rpc error:  ..........failed to set bridge addr: \n&quot;cni0&quot; already has an IP address different from 10.10.1.1&#47;24&quot; 总之就是nginx所在的pod一直pending中.\n\n问题解决方法: 查看一下master与worker节点的cni0的网卡ip是否相同, 因为在可控worker节点的时候, 没有修改改节点IP. 修改完成, ngx所在po的的status马上恢复RUNNING.\n\n好像是看到留言中有个小伙伴类似问题, 应该也是克隆导致的. \n另外我使用的VMWare虚拟机软件+Centos7.6的环境, kubernetes使用的1.23.6, 和老师的都不一样, 算是好好的踩了一下坑, 锻炼一下不同的解决问题的过程.","like_count":1,"discussions":[{"author":{"id":1181974,"avatar":"https://static001.geekbang.org/account/avatar/00/12/09/16/1161017c.jpg","nickname":"罗剑锋","note":"","ucode":"95678C988F24AB","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":619594,"discussion_content":"awesome！","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1685328835,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"上海","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":373675,"user_name":"爱学习的麦子","can_delete":false,"product_type":"c1","uid":1099607,"ip_address":"北京","ucode":"6AB9D0C13E5B2C","user_header":"https://static001.geekbang.org/account/avatar/00/10/c7/57/738404e8.jpg","comment_is_top":false,"comment_ctime":1682996552,"is_pvip":false,"replies":[{"id":136557,"content":"great","user_name":"作者回复","user_name_real":"编辑","uid":1181974,"ctime":1683166311,"ip_address":"上海","comment_id":373675,"utype":1}],"discussion_count":1,"race_medal":0,"score":5,"product_id":100114501,"comment_content":"kubeadm init时指定的apiserver的ip需要是自己环境上master节点的ip地址(使用命令 ：ip addr 查看，去取 2的IP地址 ) ，如果指定错误，可通过sudo kubeadm reset重置；","like_count":1,"discussions":[{"author":{"id":1181974,"avatar":"https://static001.geekbang.org/account/avatar/00/12/09/16/1161017c.jpg","nickname":"罗剑锋","note":"","ucode":"95678C988F24AB","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":616877,"discussion_content":"great","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1683166311,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"上海","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":372563,"user_name":"恰饭哒","can_delete":false,"product_type":"c1","uid":1014023,"ip_address":"上海","ucode":"0395069A050057","user_header":"https://static001.geekbang.org/account/avatar/00/0f/79/07/2f418316.jpg","comment_is_top":false,"comment_ctime":1681285719,"is_pvip":false,"replies":[{"id":135992,"content":"可以暂时用minikube来学习，不要在kubeadm上太浪费时间。","user_name":"作者回复","user_name_real":"编辑","uid":1181974,"ctime":1681298300,"ip_address":"上海","comment_id":372563,"utype":1}],"discussion_count":1,"race_medal":0,"score":5,"product_id":100114501,"comment_content":"有大佬装好的了吗？搞了20多天日日夜夜的，求救救孩子吧","like_count":1,"discussions":[{"author":{"id":1181974,"avatar":"https://static001.geekbang.org/account/avatar/00/12/09/16/1161017c.jpg","nickname":"罗剑锋","note":"","ucode":"95678C988F24AB","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":613385,"discussion_content":"可以暂时用minikube来学习，不要在kubeadm上太浪费时间。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1681298301,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"上海","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":367790,"user_name":"极客酱酱","can_delete":false,"product_type":"c1","uid":2934665,"ip_address":"四川","ucode":"18CDC1DB754D58","user_header":"https://static001.geekbang.org/account/avatar/00/2c/c7/89/16437396.jpg","comment_is_top":false,"comment_ctime":1675611503,"is_pvip":false,"replies":[{"id":133942,"content":"在kubernetes1.23里是通过cri调用docker engine，docker再调用内部的containerd。 1.24之后就是cri直接调用containerd了。","user_name":"作者回复","user_name_real":"作者","uid":1181974,"ctime":1675639353,"ip_address":"北京","comment_id":367790,"utype":1}],"discussion_count":1,"race_medal":0,"score":5,"product_id":100114501,"comment_content":"初级篇里介绍给k8s在node上的工作机制是：kubelet-&gt;CRI-&gt;containerd-&gt;docker或其他容器运行时，\n但在搭建实际k8s的时候感觉没配置过containerd，那kubelet是怎么指挥干活的呢？","like_count":1,"discussions":[{"author":{"id":1181974,"avatar":"https://static001.geekbang.org/account/avatar/00/12/09/16/1161017c.jpg","nickname":"罗剑锋","note":"","ucode":"95678C988F24AB","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":602036,"discussion_content":"在kubernetes1.23里是通过cri调用docker engine，docker再调用内部的containerd。 1.24之后就是cri直接调用containerd了。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1675639353,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"北京","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":367562,"user_name":"极客酱酱","can_delete":false,"product_type":"c1","uid":2934665,"ip_address":"四川","ucode":"18CDC1DB754D58","user_header":"https://static001.geekbang.org/account/avatar/00/2c/c7/89/16437396.jpg","comment_is_top":false,"comment_ctime":1675324253,"is_pvip":false,"replies":[{"id":133871,"content":"good","user_name":"作者回复","user_name_real":"编辑","uid":1181974,"ctime":1675381435,"ip_address":"上海","comment_id":367562,"utype":1}],"discussion_count":1,"race_medal":0,"score":5,"product_id":100114501,"comment_content":"console如果报错：\n❯ kubectl get node              \nerror: no server found for cluster &quot;minikube&quot;\n\n原因是我们在之前的课程里有：alias kubectl=&quot;minikube kubectl --&quot;\n取消这个重命名，copy master里的kubectl到&#47;usr&#47;local&#47;bin里,config到~&#47;.kube&#47;就可以了","like_count":1,"discussions":[{"author":{"id":1181974,"avatar":"https://static001.geekbang.org/account/avatar/00/12/09/16/1161017c.jpg","nickname":"罗剑锋","note":"","ucode":"95678C988F24AB","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":601711,"discussion_content":"good","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1675381435,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"上海","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":365134,"user_name":"你好极客时间","can_delete":false,"product_type":"c1","uid":2113412,"ip_address":"北京","ucode":"EC1AE9FD105234","user_header":"https://static001.geekbang.org/account/avatar/00/20/3f/84/47f7b661.jpg","comment_is_top":false,"comment_ctime":1672143899,"is_pvip":false,"replies":[{"id":132976,"content":"可以把经验分享一下，是不是Linux环境差异导致的？","user_name":"作者回复","user_name_real":"编辑","uid":1181974,"ctime":1672199871,"ip_address":"北京","comment_id":365134,"utype":1}],"discussion_count":1,"race_medal":0,"score":5,"product_id":100114501,"comment_content":"好崩溃的一节课，我搜了多少faq才装好的╮(╯▽╰)╭","like_count":1,"discussions":[{"author":{"id":1181974,"avatar":"https://static001.geekbang.org/account/avatar/00/12/09/16/1161017c.jpg","nickname":"罗剑锋","note":"","ucode":"95678C988F24AB","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":597737,"discussion_content":"可以把经验分享一下，是不是Linux环境差异导致的？","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1672199871,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"北京","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":364027,"user_name":"momo","can_delete":false,"product_type":"c1","uid":2446475,"ip_address":"上海","ucode":"B91FC50EE9A1F8","user_header":"https://static001.geekbang.org/account/avatar/00/25/54/8b/1bada7a5.jpg","comment_is_top":false,"comment_ctime":1670462234,"is_pvip":false,"replies":[{"id":132332,"content":"看来追新还是有风险的，建议学习过程中还是用旧版本比较稳妥。","user_name":"作者回复","user_name_real":"编辑","uid":1181974,"ctime":1670466970,"ip_address":"上海","comment_id":364027,"utype":1}],"discussion_count":1,"race_medal":0,"score":5,"product_id":100114501,"comment_content":"使用 kubernetes  1.25.4 版本的同学请注意，安装 Flannel 网络插件（0.20.2）极有可能引发  issue 1344： https:&#47;&#47;github.com&#47;flannel-io&#47;flannel&#47;issues&#47;1344 问题，即 安装 Flannel 后 Node 的一个极其重要的字段 podCIDR 无法被定义，反倒是 podCIDRs 存在，这会导致 Flannel 陷入 Error -&gt; CrashLoopBackOff 死循环，并且你在检查所有配置都检查不出来问题所在。\n\n卡了两天，我的青春啊o(╥﹏╥)o","like_count":1,"discussions":[{"author":{"id":1181974,"avatar":"https://static001.geekbang.org/account/avatar/00/12/09/16/1161017c.jpg","nickname":"罗剑锋","note":"","ucode":"95678C988F24AB","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":595912,"discussion_content":"看来追新还是有风险的，建议学习过程中还是用旧版本比较稳妥。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1670466970,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"上海","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":362578,"user_name":"项**","can_delete":false,"product_type":"c1","uid":3016447,"ip_address":"上海","ucode":"C346D19ADAAFC1","user_header":"https://static001.geekbang.org/account/avatar/00/2e/06/ff/047a7150.jpg","comment_is_top":false,"comment_ctime":1668652263,"is_pvip":false,"replies":[{"id":131846,"content":"good","user_name":"作者回复","user_name_real":"编辑","uid":1181974,"ctime":1668652598,"ip_address":"上海","comment_id":362578,"utype":1}],"discussion_count":2,"race_medal":0,"score":5,"product_id":100114501,"comment_content":"The connection to the server localhost:8080 was refused\n这个报错可以看https:&#47;&#47;www.cnblogs.com&#47;Ao0216&#47;p&#47;15903134.html","like_count":1,"discussions":[{"author":{"id":1181974,"avatar":"https://static001.geekbang.org/account/avatar/00/12/09/16/1161017c.jpg","nickname":"罗剑锋","note":"","ucode":"95678C988F24AB","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":593915,"discussion_content":"good","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1668652598,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"上海","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1143399,"avatar":"https://static001.geekbang.org/account/avatar/00/11/72/67/aa52812a.jpg","nickname":"stark","note":"","ucode":"ADC5C2AE5B97C8","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":597483,"discussion_content":"我的为什么还不行呢？","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1671875218,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":"北京","group_id":0},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":360699,"user_name":"安石","can_delete":false,"product_type":"c1","uid":1508755,"ip_address":"上海","ucode":"185AD0046CF1C2","user_header":"https://static001.geekbang.org/account/avatar/00/17/05/93/3c3f2a6d.jpg","comment_is_top":false,"comment_ctime":1666766431,"is_pvip":false,"replies":[{"id":131224,"content":"可能是因为没有在worker节点上拷贝kubectl的config文件，如果拷贝了那么就行了。\n\n注意kubectl和Kubernetes集群其实是彼此独立的，不能想当然认为Kubernetes集群节点上一定可以用kubectl，可以再看一下集群的网络结构图。","user_name":"作者回复","user_name_real":"编辑","uid":1181974,"ctime":1666772524,"ip_address":"上海","comment_id":360699,"utype":1}],"discussion_count":1,"race_medal":0,"score":5,"product_id":100114501,"comment_content":"我靠，这个问题困扰我好几天了\n```\nkubectl run ngx --image=nginx:alpine\n```\n这个命令式在master敲的，我一直在workder上敲\n蠢哭了","like_count":1,"discussions":[{"author":{"id":1181974,"avatar":"https://static001.geekbang.org/account/avatar/00/12/09/16/1161017c.jpg","nickname":"罗剑锋","note":"","ucode":"95678C988F24AB","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":591709,"discussion_content":"可能是因为没有在worker节点上拷贝kubectl的config文件，如果拷贝了那么就行了。\n\n注意kubectl和Kubernetes集群其实是彼此独立的，不能想当然认为Kubernetes集群节点上一定可以用kubectl，可以再看一下集群的网络结构图。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1666772524,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"上海","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":353893,"user_name":"威","can_delete":false,"product_type":"c1","uid":1068542,"ip_address":"上海","ucode":"C921CDCB22B9A3","user_header":"https://static001.geekbang.org/account/avatar/00/10/4d/fe/882eaf0f.jpg","comment_is_top":false,"comment_ctime":1659916995,"is_pvip":false,"replies":[{"id":128698,"content":"running不代表就正常，看看log，可以重启pod试试。","user_name":"作者回复","user_name_real":"编辑","uid":1181974,"ctime":1659924775,"ip_address":"上海","comment_id":353893,"utype":1}],"discussion_count":2,"race_medal":0,"score":5,"product_id":100114501,"comment_content":"按照教程安装完后，节点能正常链接起来，但内部dns解析不了，基本检查了一下，k8s的dns pod是正常running","like_count":1,"discussions":[{"author":{"id":1181974,"avatar":"https://static001.geekbang.org/account/avatar/00/12/09/16/1161017c.jpg","nickname":"罗剑锋","note":"","ucode":"95678C988F24AB","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":583125,"discussion_content":"running不代表就正常，看看log，可以重启pod试试。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1659924775,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"上海","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":3190249,"avatar":"https://static001.geekbang.org/account/avatar/00/30/ad/e9/778ddf53.jpg","nickname":"mamafeng","note":"","ucode":"ED0AB11EAAC762","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":609621,"discussion_content":"哥们我也遇到了这个问题，你解决了吗？我的问题是：当pod被调度到worker节点上时，在另一个pod容器内部，无法使用 service_name 通信，即无法正确进行域名解析","likes_number":1,"is_delete":false,"is_hidden":false,"ctime":1679055292,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":"上海","group_id":0},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":353560,"user_name":"微客鸟窝","can_delete":false,"product_type":"c1","uid":1725209,"ip_address":"上海","ucode":"27D37AD921EC5D","user_header":"https://static001.geekbang.org/account/avatar/00/1a/53/19/d21d256f.jpg","comment_is_top":false,"comment_ctime":1659565544,"is_pvip":false,"replies":[{"id":128557,"content":"加上-v参数，看有没有调试信息输出。","user_name":"作者回复","user_name_real":"编辑","uid":1181974,"ctime":1659579239,"ip_address":"上海","comment_id":353560,"utype":1}],"discussion_count":1,"race_medal":0,"score":5,"product_id":100114501,"comment_content":"请问kubeadm init执行后，没有任何输出，直接运行结束了，这是什么情况？怎么排查一下错误呢？","like_count":1,"discussions":[{"author":{"id":1181974,"avatar":"https://static001.geekbang.org/account/avatar/00/12/09/16/1161017c.jpg","nickname":"罗剑锋","note":"","ucode":"95678C988F24AB","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":582654,"discussion_content":"加上-v参数，看有没有调试信息输出。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1659579239,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"上海","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":353422,"user_name":"Geek_8497e1","can_delete":false,"product_type":"c1","uid":2156419,"ip_address":"上海","ucode":"3289E378B9D331","user_header":"http://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTLoxAjJG76r6Qib0G1rcQvVOmPc70biapxg6ny3RFX7L5KKaJdib6zUIEicvYmhyiaQeHScVMc8KjHTHIQ/132","comment_is_top":false,"comment_ctime":1659429869,"is_pvip":false,"replies":[{"id":128481,"content":"这个可以上Kubernetes官网上找。","user_name":"作者回复","user_name_real":"编辑","uid":1181974,"ctime":1659430802,"ip_address":"上海","comment_id":353422,"utype":1}],"discussion_count":1,"race_medal":0,"score":6,"product_id":100114501,"comment_content":"你好，有kubeadm，高可用k8s的搭建文档嘛","like_count":1,"discussions":[{"author":{"id":1181974,"avatar":"https://static001.geekbang.org/account/avatar/00/12/09/16/1161017c.jpg","nickname":"罗剑锋","note":"","ucode":"95678C988F24AB","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":582422,"discussion_content":"这个可以上Kubernetes官网上找。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1659430802,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"上海","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":353088,"user_name":"白云外","can_delete":false,"product_type":"c1","uid":1123378,"ip_address":"陕西","ucode":"403268BB9AEE26","user_header":"https://static001.geekbang.org/account/avatar/00/11/24/32/a82da906.jpg","comment_is_top":false,"comment_ctime":1659153710,"is_pvip":false,"replies":[{"id":128395,"content":"这个不应该吧，看看是不是版本不对。","user_name":"作者回复","user_name_real":"编辑","uid":1181974,"ctime":1659174403,"ip_address":"陕西","comment_id":353088,"utype":1}],"discussion_count":3,"race_medal":0,"score":6,"product_id":100114501,"comment_content":"请教一下各位，为什么我已经把镜像拉取到本地了（名称、tag都确认了），结果在init时仍然会去远程拉取，然后就报超时错误了。","like_count":1,"discussions":[{"author":{"id":1181974,"avatar":"https://static001.geekbang.org/account/avatar/00/12/09/16/1161017c.jpg","nickname":"罗剑锋","note":"","ucode":"95678C988F24AB","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":582063,"discussion_content":"这个不应该吧，看看是不是版本不对。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1659174403,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"陕西","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1694157,"avatar":"https://static001.geekbang.org/account/avatar/00/19/d9/cd/cd6439b6.jpg","nickname":"大俊","note":"","ucode":"EBBE1FB3E58C41","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":592268,"discussion_content":"把镜像都删除再重新拉取就好了，亲测可行","likes_number":1,"is_delete":false,"is_hidden":false,"ctime":1667272933,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":"河南","group_id":0},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1771398,"avatar":"http://thirdwx.qlogo.cn/mmopen/KFgDEHIEpnT0EXnh02VHqLyZibwZDFbQ6BagMXp5EyfX2gtRb27TZOSIbI0ZyRibESleK0WlkhyOWib3j4ibu5AKYRJ1YxhnIzqz/132","nickname":"Geek_83b0a7","note":"","ucode":"18A779B74878A9","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":597248,"discussion_content":"可以加上--v=5参数看详细信息，会显示检查本地镜像或拉取镜像的过程","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1671584260,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":"北京","group_id":0},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":353086,"user_name":"Amosヾ","can_delete":false,"product_type":"c1","uid":1567014,"ip_address":"陕西","ucode":"833F6FCB4042AD","user_header":"https://static001.geekbang.org/account/avatar/00/17/e9/26/472e16e4.jpg","comment_is_top":false,"comment_ctime":1659153088,"is_pvip":true,"replies":[{"id":128394,"content":"这个我觉得意义可能不是太大，掌握了kubeadm的用法，再看一下官方文档就可以会多节点了，再写出来感觉有点多余。","user_name":"作者回复","user_name_real":"编辑","uid":1181974,"ctime":1659174354,"ip_address":"陕西","comment_id":353086,"utype":1}],"discussion_count":1,"race_medal":0,"score":6,"product_id":100114501,"comment_content":"后面会有k8s多master安装教程吗？官方文档貌似需要一个外部lb吧？是否可以本地模拟呢？","like_count":1,"discussions":[{"author":{"id":1181974,"avatar":"https://static001.geekbang.org/account/avatar/00/12/09/16/1161017c.jpg","nickname":"罗剑锋","note":"","ucode":"95678C988F24AB","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":582062,"discussion_content":"这个我觉得意义可能不是太大，掌握了kubeadm的用法，再看一下官方文档就可以会多节点了，再写出来感觉有点多余。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1659174354,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"陕西","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":353066,"user_name":"西门吹牛","can_delete":false,"product_type":"c1","uid":1508990,"ip_address":"陕西","ucode":"E5D3624DDE1E83","user_header":"https://static001.geekbang.org/account/avatar/00/17/06/7e/735968e2.jpg","comment_is_top":false,"comment_ctime":1659110301,"is_pvip":false,"replies":[{"id":128390,"content":"good，云原生的意思还可以再参考一下09讲我的个人理解。","user_name":"作者回复","user_name_real":"编辑","uid":1181974,"ctime":1659138836,"ip_address":"陕西","comment_id":353066,"utype":1}],"discussion_count":1,"race_medal":0,"score":6,"product_id":100114501,"comment_content":"云原生，开发人员只关心业务代码，所有部署，微服务治理相关的，运维相关都依托云基础设施，把原先微服务架构中，除业务代码之外的服务治理比如服务发现，负载均衡，熔断限流等从软件应用层面转移到云基础设施比如k8s上，虽然k8s底层容器技术依赖硬件基础设施，但容器之间的服务治理基础设施不能完全处理，k8s中各种编排对象也属于软件，只是让对开发人员透明化了，让程序员回归到以业务为主，只关心业务的本质上","like_count":1,"discussions":[{"author":{"id":1181974,"avatar":"https://static001.geekbang.org/account/avatar/00/12/09/16/1161017c.jpg","nickname":"罗剑锋","note":"","ucode":"95678C988F24AB","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":582018,"discussion_content":"good，云原生的意思还可以再参考一下09讲我的个人理解。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1659138837,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"陕西","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":393917,"user_name":"于途","can_delete":false,"product_type":"c1","uid":1669343,"ip_address":"广东","ucode":"70300C6CCCEAF1","user_header":"https://static001.geekbang.org/account/avatar/00/19/78/df/424bdc4a.jpg","comment_is_top":false,"comment_ctime":1725333918,"is_pvip":false,"replies":[{"id":143025,"content":"也许可以用kubeadm重新生成证书，再重启集群。\n","user_name":"作者回复","user_name_real":"编辑","uid":1181974,"ctime":1725418329,"ip_address":"上海","comment_id":393917,"utype":1}],"discussion_count":2,"race_medal":0,"score":6,"product_id":100114501,"comment_content":"kubectl get pod\n\nUnable to connect to the server: x509: certificate has expired or is not yet valid: current time 2024-09-03T01:06:43Z is after 2024-03-15T20:04:05Z\n\n老师，证书过期，请问最佳操作是怎样的呢？","like_count":0,"discussions":[{"author":{"id":1181974,"avatar":"https://static001.geekbang.org/account/avatar/00/12/09/16/1161017c.jpg","nickname":"罗剑锋","note":"","ucode":"95678C988F24AB","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":650667,"discussion_content":"也许可以用kubeadm重新生成证书，再重启集群。\n","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1725418329,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"上海","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2,\"source\":0}","child_discussion_number":1,"child_discussions":[{"author":{"id":1669343,"avatar":"https://static001.geekbang.org/account/avatar/00/19/78/df/424bdc4a.jpg","nickname":"于途","note":"","ucode":"70300C6CCCEAF1","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":1181974,"avatar":"https://static001.geekbang.org/account/avatar/00/12/09/16/1161017c.jpg","nickname":"罗剑锋","note":"","ucode":"95678C988F24AB","race_medal":0,"user_type":2,"is_pvip":false},"discussion":{"id":650668,"discussion_content":"好的","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1725418414,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":650667,"ip_address":"广东","group_id":0},"score":650668,"extra":""}]}]},{"had_liked":false,"id":392651,"user_name":"江湖夜雨十年灯","can_delete":false,"product_type":"c1","uid":1520772,"ip_address":"北京","ucode":"0CCFCA6F855AC8","user_header":"https://static001.geekbang.org/account/avatar/00/17/34/84/27ecfcab.jpg","comment_is_top":false,"comment_ctime":1721442270,"is_pvip":false,"replies":[{"id":142698,"content":"https:&#47;&#47;github.com&#47;flannel-io&#47;flannel&#47;blob&#47;master&#47;Documentation&#47;kube-flannel.yml","user_name":"作者回复","user_name_real":"编辑","uid":1181974,"ctime":1721459556,"ip_address":"上海","comment_id":392651,"utype":1}],"discussion_count":1,"race_medal":0,"score":6,"product_id":100114501,"comment_content":"kube-flannel.yml 这个文件在哪里呢？我在仓库中没有找到 0-0","like_count":0,"discussions":[{"author":{"id":1181974,"avatar":"https://static001.geekbang.org/account/avatar/00/12/09/16/1161017c.jpg","nickname":"罗剑锋","note":"","ucode":"95678C988F24AB","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":648364,"discussion_content":"https://github.com/flannel-io/flannel/blob/master/Documentation/kube-flannel.yml","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1721459556,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"上海","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2,\"source\":0}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":392215,"user_name":"王旧业","can_delete":false,"product_type":"c1","uid":1013076,"ip_address":"陕西","ucode":"A8DEC38430D007","user_header":"https://static001.geekbang.org/account/avatar/00/0f/75/54/73cc7f73.jpg","comment_is_top":false,"comment_ctime":1720276746,"is_pvip":false,"replies":[{"id":142576,"content":"是的，不过这些命令都比较简单，只要具备基本的Shell知识应该很容易解决。","user_name":"作者回复","user_name_real":"编辑","uid":1181974,"ctime":1720323382,"ip_address":"北京","comment_id":392215,"utype":1}],"discussion_count":1,"race_medal":0,"score":6,"product_id":100114501,"comment_content":"scp `which kubectl` chrono@192.168.10.208:~&#47;\nscp ~&#47;.kube&#47;config chrono@192.168.10.208:~&#47;.kube\n\n这个脚本似乎有点问题，第二行代码的前提是目标机器上已经创建了.kube目录","like_count":0,"discussions":[{"author":{"id":1181974,"avatar":"https://static001.geekbang.org/account/avatar/00/12/09/16/1161017c.jpg","nickname":"罗剑锋","note":"","ucode":"95678C988F24AB","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":647622,"discussion_content":"是的，不过这些命令都比较简单，只要具备基本的Shell知识应该很容易解决。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1720323382,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"北京","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2,\"source\":0}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":391508,"user_name":"syc的猫","can_delete":false,"product_type":"c1","uid":1723890,"ip_address":"湖南","ucode":"A57D4215FFD4C5","user_header":"https://static001.geekbang.org/account/avatar/00/1a/4d/f2/768daf2d.jpg","comment_is_top":false,"comment_ctime":1718352355,"is_pvip":false,"replies":[{"id":142427,"content":"可以试试。","user_name":"作者回复","user_name_real":"编辑","uid":1181974,"ctime":1718941380,"ip_address":"上海","comment_id":391508,"utype":1}],"discussion_count":1,"race_medal":0,"score":6,"product_id":100114501,"comment_content":"可以用sealos一步搞定不？","like_count":0,"discussions":[{"author":{"id":1181974,"avatar":"https://static001.geekbang.org/account/avatar/00/12/09/16/1161017c.jpg","nickname":"罗剑锋","note":"","ucode":"95678C988F24AB","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":646877,"discussion_content":"可以试试。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1718941381,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"上海","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2,\"source\":0}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":390443,"user_name":"攻城狮","can_delete":false,"product_type":"c1","uid":1197444,"ip_address":"北京","ucode":"7D2C2836052C4C","user_header":"https://static001.geekbang.org/account/avatar/00/12/45/84/4b309ba9.jpg","comment_is_top":false,"comment_ctime":1715350817,"is_pvip":false,"replies":[{"id":142027,"content":"应该不多了吧，没有调查过。","user_name":"作者回复","user_name_real":"编辑","uid":1181974,"ctime":1715413957,"ip_address":"上海","comment_id":390443,"utype":1}],"discussion_count":1,"race_medal":0,"score":6,"product_id":100114501,"comment_content":"比较好奇现在生产环境中 k8s 的容器用 docker 多吗？","like_count":0,"discussions":[{"author":{"id":1181974,"avatar":"https://static001.geekbang.org/account/avatar/00/12/09/16/1161017c.jpg","nickname":"罗剑锋","note":"","ucode":"95678C988F24AB","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":644657,"discussion_content":"应该不多了吧，没有调查过。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1715413957,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"上海","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2,\"source\":0}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":389316,"user_name":"承君此诺","can_delete":false,"product_type":"c1","uid":1159765,"ip_address":"山东","ucode":"1B25D59743C0AD","user_header":"https://static001.geekbang.org/account/avatar/00/11/b2/55/61b3e9e3.jpg","comment_is_top":false,"comment_ctime":1712107146,"is_pvip":false,"replies":[{"id":141635,"content":"1. 当然可以，这里是为了加强自己动手的效果。\n2. 删除flannel，用新的YAML 配置重新安装，在kubeadm集群上实验看看。","user_name":"作者回复","user_name_real":"编辑","uid":1181974,"ctime":1712109406,"ip_address":"北京","comment_id":389316,"utype":1}],"discussion_count":1,"race_medal":0,"score":6,"product_id":100114501,"comment_content":"1. 为什么kubeadm init时要改成10.10.0.0&#47;16网段，使用flannel初始的10.244.0.0&#47;16有问题吗？\n2. 如果flannel安装后修改配置，如何生效？我甚至minikube delete，卸载minikube、删除.minikube文件夹，重装后使用的仍是旧配置。","like_count":0,"discussions":[{"author":{"id":1181974,"avatar":"https://static001.geekbang.org/account/avatar/00/12/09/16/1161017c.jpg","nickname":"罗剑锋","note":"","ucode":"95678C988F24AB","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":641036,"discussion_content":"1. 当然可以，这里是为了加强自己动手的效果。\n2. 删除flannel，用新的YAML 配置重新安装，在kubeadm集群上实验看看。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1712109406,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"北京","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2,\"source\":0}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":388335,"user_name":"党","can_delete":false,"product_type":"c1","uid":1071974,"ip_address":"河北","ucode":"EE531DB3EA124D","user_header":"https://static001.geekbang.org/account/avatar/00/10/5b/66/ad35bc68.jpg","comment_is_top":false,"comment_ctime":1709933640,"is_pvip":false,"replies":[{"id":141403,"content":"great","user_name":"作者回复","user_name_real":"编辑","uid":1181974,"ctime":1709974542,"ip_address":"北京","comment_id":388335,"utype":1}],"discussion_count":1,"race_medal":0,"score":7,"product_id":100114501,"comment_content":"准备后期拿orage派搭建一个集群，成本能控制到千元下。","like_count":0,"discussions":[{"author":{"id":1181974,"avatar":"https://static001.geekbang.org/account/avatar/00/12/09/16/1161017c.jpg","nickname":"罗剑锋","note":"","ucode":"95678C988F24AB","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":638833,"discussion_content":"great","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1709974542,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"北京","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2,\"source\":0}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":384564,"user_name":"Geek_768d90","can_delete":false,"product_type":"c1","uid":2541626,"ip_address":"新疆","ucode":"A9966695909456","user_header":"https://thirdwx.qlogo.cn/mmopen/vi_32/DYAIOgq83erLkXxEDm9ib2rtlHbVVO4qlFBWp5AArFpPctzSE0zkiaMiaol1IHVJ35ECC2goY5ibSufFPLp6dOzNmg/132","comment_is_top":false,"comment_ctime":1701166639,"is_pvip":false,"replies":[{"id":140287,"content":"看一下网络插件flannel的状态，感觉是网络不正常，可能重装会好。","user_name":"作者回复","user_name_real":"编辑","uid":1181974,"ctime":1701248043,"ip_address":"上海","comment_id":384564,"utype":1}],"discussion_count":2,"race_medal":0,"score":7,"product_id":100114501,"comment_content":"1. 根据老师的步骤，K8S集群已经搭建成功：\nmaster@master-VirtualBox:~$ kubectl get nodes\nNAME                 STATUS   ROLES                  AGE    VERSION\nconsole-virtualbox   Ready    &lt;none&gt;                 153m   v1.23.3\nmaster-virtualbox    Ready    control-plane,master   166m   v1.23.3\nworker-virtualbox    Ready    &lt;none&gt;                 159m   v1.23.3\n2. 但是当创建POD时，状态一直是：ContainerCreating，使用describe报错如下：\nWarning  FailedCreatePodSandBox  2m35s (x186 over 7m24s)  kubelet            (combined from similar events): Failed to create pod sandbox: rpc error: code = Unknown desc = failed to set up sandbox container &quot;270b49d249d242c7942dde4efc303d76d619e6723f93e5e1fe464769deb0db65&quot; network for pod &quot;ngx&quot;: networkPlugin cni failed to set up pod &quot;ngx_default&quot; network: loadFlannelSubnetEnv failed: open &#47;run&#47;flannel&#47;subnet.env: no such file or directory（但是对应目录下是存在subnet.env文件的）\n\n请问老师该如何处理？","like_count":0,"discussions":[{"author":{"id":1181974,"avatar":"https://static001.geekbang.org/account/avatar/00/12/09/16/1161017c.jpg","nickname":"罗剑锋","note":"","ucode":"95678C988F24AB","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":632726,"discussion_content":"看一下网络插件flannel的状态，感觉是网络不正常，可能重装会好。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1701248043,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"上海","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":2541626,"avatar":"https://thirdwx.qlogo.cn/mmopen/vi_32/DYAIOgq83erLkXxEDm9ib2rtlHbVVO4qlFBWp5AArFpPctzSE0zkiaMiaol1IHVJ35ECC2goY5ibSufFPLp6dOzNmg/132","nickname":"Geek_768d90","note":"","ucode":"A9966695909456","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":632922,"discussion_content":"原因找到了：\n1. master节点确实创建了/run/flannel/subnet.env文件，但是worker、console却没有（虽然kubeadm join提示已经正常加入，原因现在仍不祥）。\n2. 在worker、console节点分别手工创建/run/flannel/subnet.env文件，且内容与master一致后，分别执行：sudo systemctl restart kubelet，pod创建正常。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1701615447,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":"新疆","group_id":0},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":383488,"user_name":"Geek_7b6512","can_delete":false,"product_type":"c1","uid":3778515,"ip_address":"广东","ucode":"C17B38A0F1FFBB","user_header":"","comment_is_top":false,"comment_ctime":1699153832,"is_pvip":false,"replies":[{"id":139745,"content":"没有详细的上下文，解决不了问题，可以再按照流程仔细走一遍，GitHub上也有脚本。","user_name":"作者回复","user_name_real":"编辑","uid":1181974,"ctime":1699256978,"ip_address":"上海","comment_id":383488,"utype":1}],"discussion_count":2,"race_medal":0,"score":7,"product_id":100114501,"comment_content":"he HTTP call equal to &#39;curl -sSL http:&#47;&#47;localhost:10248&#47;healthz&#39; failed with error: Get &quot;http:&#47;&#47;localhost:10248&#47;healthz&quot;: dial tcp 127.0.0.1:10248: connect: connection refused\n\n请问这这么处理，是哪里配置错了？","like_count":0,"discussions":[{"author":{"id":1181974,"avatar":"https://static001.geekbang.org/account/avatar/00/12/09/16/1161017c.jpg","nickname":"罗剑锋","note":"","ucode":"95678C988F24AB","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":631028,"discussion_content":"没有详细的上下文，解决不了问题，可以再按照流程仔细走一遍，GitHub上也有脚本。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1699256978,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"上海","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":1,"child_discussions":[{"author":{"id":3778515,"avatar":"","nickname":"Geek_7b6512","note":"","ucode":"C17B38A0F1FFBB","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":1181974,"avatar":"https://static001.geekbang.org/account/avatar/00/12/09/16/1161017c.jpg","nickname":"罗剑锋","note":"","ucode":"95678C988F24AB","race_medal":0,"user_type":2,"is_pvip":false},"discussion":{"id":631442,"discussion_content":"好的，谢谢老师","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1699539477,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":631028,"ip_address":"广东","group_id":0},"score":631442,"extra":""}]}]},{"had_liked":false,"id":380790,"user_name":"No_Sliver_Bullets","can_delete":false,"product_type":"c1","uid":1542112,"ip_address":"北京","ucode":"325A9420D0FA46","user_header":"http://thirdwx.qlogo.cn/mmopen/vi_32/DYAIOgq83eqOfEhv17KcBhOEjYjlFJ1xMtl6r90Vnsicybrf9FrsMxyGCYs9nGGyqWwWbSGicQXIQicj32OyANkzA/132","comment_is_top":false,"comment_ctime":1694156993,"is_pvip":false,"replies":[{"id":138623,"content":"对的，一台Master一台worker。","user_name":"作者回复","user_name_real":"编辑","uid":1181974,"ctime":1694178317,"ip_address":"北京","comment_id":380790,"utype":1}],"discussion_count":1,"race_medal":0,"score":7,"product_id":100114501,"comment_content":"要准备两台虚拟机吗？","like_count":0,"discussions":[{"author":{"id":1181974,"avatar":"https://static001.geekbang.org/account/avatar/00/12/09/16/1161017c.jpg","nickname":"罗剑锋","note":"","ucode":"95678C988F24AB","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":627472,"discussion_content":"对的，一台Master一台worker。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1694178318,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"北京","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":379655,"user_name":"顿","can_delete":false,"product_type":"c1","uid":1235086,"ip_address":"北京","ucode":"A852FEEEE98A33","user_header":"https://static001.geekbang.org/account/avatar/00/12/d8/8e/5df30b8b.jpg","comment_is_top":false,"comment_ctime":1692251725,"is_pvip":false,"replies":[{"id":138347,"content":"步骤大同小异，可以参考Ubuntu，再找一下网上的其他资料。","user_name":"作者回复","user_name_real":"编辑","uid":1181974,"ctime":1692536530,"ip_address":"北京","comment_id":379655,"utype":1}],"discussion_count":1,"race_medal":0,"score":7,"product_id":100114501,"comment_content":"centos 怎么装？","like_count":0,"discussions":[{"author":{"id":1181974,"avatar":"https://static001.geekbang.org/account/avatar/00/12/09/16/1161017c.jpg","nickname":"罗剑锋","note":"","ucode":"95678C988F24AB","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":626103,"discussion_content":"步骤大同小异，可以参考Ubuntu，再找一下网上的其他资料。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1692536530,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"北京","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":379480,"user_name":"Geek_e47add","can_delete":false,"product_type":"c1","uid":3691767,"ip_address":"浙江","ucode":"629B94FD154536","user_header":"","comment_is_top":false,"comment_ctime":1692006482,"is_pvip":false,"replies":[{"id":138239,"content":"应该用的还是minikube的config文件，注意两个集群不要混用。","user_name":"作者回复","user_name_real":"编辑","uid":1181974,"ctime":1692011160,"ip_address":"黑龙江","comment_id":379480,"utype":1}],"discussion_count":1,"race_medal":0,"score":7,"product_id":100114501,"comment_content":"master节点创建成功，但是kubectl version显示 error: cluster &quot;minikube&quot; does not exist\n","like_count":0,"discussions":[{"author":{"id":1181974,"avatar":"https://static001.geekbang.org/account/avatar/00/12/09/16/1161017c.jpg","nickname":"罗剑锋","note":"","ucode":"95678C988F24AB","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":625644,"discussion_content":"应该用的还是minikube的config文件，注意两个集群不要混用。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1692011161,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"黑龙江","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":379183,"user_name":"墨龙","can_delete":false,"product_type":"c1","uid":1309681,"ip_address":"北京","ucode":"8C63C5D18E0877","user_header":"http://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTKvNozkiaiao1IyuCzEIMPiaNicB1hgEcad3X4DS6IAq5lnOiagf2690Q7Q1RmyBN89gNqYHeHHtY2RcqQ/132","comment_is_top":false,"comment_ctime":1691490736,"is_pvip":false,"replies":[{"id":138185,"content":"good","user_name":"作者回复","user_name_real":"编辑","uid":1181974,"ctime":1691631463,"ip_address":"上海","comment_id":379183,"utype":1}],"discussion_count":2,"race_medal":0,"score":7,"product_id":100114501,"comment_content":"在使用ubuntu-22.04.2版本的镜像构建的虚拟机，在本篇的“安装 kubeadm”这一段的“sudo apt update”时，报错“Key is stored in legacy trusted.gpg keyring (&#47;etc&#47;apt&#47;trusted.gpg)”。\n原因是这种方式明文存储格式的方式被放弃了。\n解决方法是：把第三行（curl那一行）改成 wget -O- https:&#47;&#47;mirrors.aliyun.com&#47;kubernetes&#47;apt&#47;doc&#47;apt-key.gpg.asc | gpg --dearmor &gt; &#47;etc&#47;apt&#47;trusted.gpg.d&#47;  \n再执行sudo apt update即可","like_count":0,"discussions":[{"author":{"id":1181974,"avatar":"https://static001.geekbang.org/account/avatar/00/12/09/16/1161017c.jpg","nickname":"罗剑锋","note":"","ucode":"95678C988F24AB","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":625379,"discussion_content":"good","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1691631463,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"上海","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1309681,"avatar":"http://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTKvNozkiaiao1IyuCzEIMPiaNicB1hgEcad3X4DS6IAq5lnOiagf2690Q7Q1RmyBN89gNqYHeHHtY2RcqQ/132","nickname":"墨龙","note":"","ucode":"8C63C5D18E0877","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":625254,"discussion_content":"“再执行”三个字前应该有一个文件名，比如 &gt; /etc/apt/trusted.gpg.d/apt-key.gpg","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1691491306,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":"北京","group_id":0},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":378969,"user_name":"Hank_Yan","can_delete":false,"product_type":"c1","uid":1110662,"ip_address":"北京","ucode":"86899B561C502B","user_header":"https://static001.geekbang.org/account/avatar/00/10/f2/86/d689f77e.jpg","comment_is_top":false,"comment_ctime":1691057634,"is_pvip":false,"replies":[{"id":138116,"content":"报错可能是Kubernetes服务运行不正常。","user_name":"作者回复","user_name_real":"编辑","uid":1181974,"ctime":1691135073,"ip_address":"上海","comment_id":378969,"utype":1}],"discussion_count":1,"race_medal":0,"score":7,"product_id":100114501,"comment_content":"master 上报错: The connection to the server x.x.x.:6443 was refused - did you specify the right host or port?\n\n1. docker 要处于启动状态。不知道为什么 reboot 后，docker 没起来。\n2. &#47;etc&#47;hosts 里面要指定下 172.16.220.140 master ， 其中 172.16.220.140 是apiserver-advertise-address 的地址","like_count":0,"discussions":[{"author":{"id":1181974,"avatar":"https://static001.geekbang.org/account/avatar/00/12/09/16/1161017c.jpg","nickname":"罗剑锋","note":"","ucode":"95678C988F24AB","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":624984,"discussion_content":"报错可能是Kubernetes服务运行不正常。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1691135073,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"上海","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":378912,"user_name":"Geek_2c48c4","can_delete":false,"product_type":"c1","uid":2587862,"ip_address":"浙江","ucode":"B56EAFD5B5A325","user_header":"https://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTLl8N60fn4vYbj5guzXMfYSCPbWica15jPGdKMdNI4FffmncCwtarIB8N9YxIuvOibGT8jZiacIrpibdQ/132","comment_is_top":false,"comment_ctime":1690969097,"is_pvip":false,"replies":[{"id":138073,"content":"good","user_name":"作者回复","user_name_real":"编辑","uid":1181974,"ctime":1691027584,"ip_address":"北京","comment_id":378912,"utype":1}],"discussion_count":1,"race_medal":0,"score":7,"product_id":100114501,"comment_content":"如果有 Connection refused 的情况，注意下你虚拟机的时区是否是东八区","like_count":0,"discussions":[{"author":{"id":1181974,"avatar":"https://static001.geekbang.org/account/avatar/00/12/09/16/1161017c.jpg","nickname":"罗剑锋","note":"","ucode":"95678C988F24AB","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":624877,"discussion_content":"good","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1691027584,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"北京","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":378643,"user_name":"牙小木","can_delete":false,"product_type":"c1","uid":1172050,"ip_address":"北京","ucode":"E5C12D37A62949","user_header":"https://static001.geekbang.org/account/avatar/00/11/e2/52/56dbb738.jpg","comment_is_top":false,"comment_ctime":1690525323,"is_pvip":false,"replies":[{"id":137968,"content":"good","user_name":"作者回复","user_name_real":"编辑","uid":1181974,"ctime":1690545454,"ip_address":"上海","comment_id":378643,"utype":1}],"discussion_count":1,"race_medal":0,"score":7,"product_id":100114501,"comment_content":"搞了两天，终于把环境搭建好了，重新再来过就没那么难了，我是win+virtualbox的ubuntu server 22.04镜像\ntb@node1:~$ date\nFri Jul 28 02:21:36 PM CST 2023\ntb@node1:~$ kubectl get node\nNAME     STATUS   ROLES                  AGE    VERSION\nmaster   Ready    control-plane,master   174m   v1.23.3\nnode1    Ready    &lt;none&gt;                 85m    v1.23.3\ntb@node1:~$ uname- a\n","like_count":0,"discussions":[{"author":{"id":1181974,"avatar":"https://static001.geekbang.org/account/avatar/00/12/09/16/1161017c.jpg","nickname":"罗剑锋","note":"","ucode":"95678C988F24AB","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":624423,"discussion_content":"good","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1690545454,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"上海","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":376815,"user_name":"吃鸡不费力","can_delete":false,"product_type":"c1","uid":1593429,"ip_address":"广东","ucode":"0C019B225FDA5B","user_header":"https://static001.geekbang.org/account/avatar/00/18/50/55/a2d97a96.jpg","comment_is_top":false,"comment_ctime":1687453673,"is_pvip":false,"replies":[{"id":137369,"content":"看样子像是网络不正常。","user_name":"作者回复","user_name_real":"编辑","uid":1181974,"ctime":1687595363,"ip_address":"北京","comment_id":376815,"utype":1}],"discussion_count":3,"race_medal":0,"score":8,"product_id":100114501,"comment_content":"version:1.27\n安装了cri-docker后进行kubectl init\nsudo kubeadm init  --pod-network-cidr=10.10.0.0&#47;16  --apiserver-advertise-address=172.16.142.130  --cri-socket=unix:&#47;&#47;&#47;var&#47;run&#47;cri-dockerd.sock --image-repository=registry.aliyuncs.com&#47;google_containers\n这里都没问题，直到安装完网络插件后发现coredns一直处于pending状态，查询了describe出现内容:\n Warning  FailedScheduling  55m                  default-scheduler  0&#47;1 nodes are available: 1 node(s) had untolerated taint {node.kubernetes.io&#47;not-ready: }. preemption: 0&#47;1 nodes are available: 1 Preemption is not helpful for scheduling..\n请问这是什么原因\n当前状态下scheduler pod是正常运行的","like_count":0,"discussions":[{"author":{"id":1181974,"avatar":"https://static001.geekbang.org/account/avatar/00/12/09/16/1161017c.jpg","nickname":"罗剑锋","note":"","ucode":"95678C988F24AB","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":621749,"discussion_content":"看样子像是网络不正常。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1687595363,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"北京","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1181629,"avatar":"https://static001.geekbang.org/account/avatar/00/12/07/bd/b7890807.jpg","nickname":"Jantelope","note":"","ucode":"C6CB3B3701FC8D","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":648900,"discussion_content":"解决了么，我也遇到了这个问题 不知道怎么处理","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1722385894,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":"河南","group_id":0},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1593429,"avatar":"https://static001.geekbang.org/account/avatar/00/18/50/55/a2d97a96.jpg","nickname":"吃鸡不费力","note":"","ucode":"0C019B225FDA5B","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":621670,"discussion_content":"然后查询-o wide后发现所有的pod都是一个ip，因为之前在minikube上是不同的ip，请问这种情况是正常的吗","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1687453824,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":"广东","group_id":0},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":376667,"user_name":"吃鸡不费力","can_delete":false,"product_type":"c1","uid":1593429,"ip_address":"广东","ucode":"0C019B225FDA5B","user_header":"https://static001.geekbang.org/account/avatar/00/18/50/55/a2d97a96.jpg","comment_is_top":false,"comment_ctime":1687178402,"is_pvip":false,"replies":[{"id":137326,"content":"kubernetes默认会有一个Pod的IP地址范围，随便创建一个Pod，用get -o wide就可以知道了。","user_name":"作者回复","user_name_real":"编辑","uid":1181974,"ctime":1687244783,"ip_address":"上海","comment_id":376667,"utype":1}],"discussion_count":1,"race_medal":0,"score":8,"product_id":100114501,"comment_content":"老师请问这个命令如果不定义地址的话会有什么问题，如果不定义后续该怎么查询这个地址:\nkubeadm init \\\n--apiserver-advertise-address=192.168.137.100 \\\n--kubernetes-version v1.23.6 \\\n--service-cidr=10.96.0.0&#47;12 \\\n--pod-network-cidr=10.244.0.0&#47;16","like_count":0,"discussions":[{"author":{"id":1181974,"avatar":"https://static001.geekbang.org/account/avatar/00/12/09/16/1161017c.jpg","nickname":"罗剑锋","note":"","ucode":"95678C988F24AB","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":621461,"discussion_content":"kubernetes默认会有一个Pod的IP地址范围，随便创建一个Pod，用get -o wide就可以知道了。","likes_number":1,"is_delete":false,"is_hidden":false,"ctime":1687244784,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"上海","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":376571,"user_name":"原则","can_delete":false,"product_type":"c1","uid":3574650,"ip_address":"广东","ucode":"12E98F3728CC53","user_header":"https://static001.geekbang.org/account/avatar/00/36/8b/7a/ec36ff82.jpg","comment_is_top":false,"comment_ctime":1686980773,"is_pvip":false,"replies":[{"id":137286,"content":"国内的镜像源用的不多，还是尽量用源站比较好，具体的方式就得自己想办法了。","user_name":"作者回复","user_name_real":"编辑","uid":1181974,"ctime":1687142936,"ip_address":"北京","comment_id":376571,"utype":1}],"discussion_count":1,"race_medal":0,"score":8,"product_id":100114501,"comment_content":"今天这个课真是步步惊心，我遇到的最大的问题就是拉取镜像失败。之前的课程一直用的公司虚拟机，没有这个问题。\n我尝试了各种国内镜像源，都是不通，想请问老师，这个如何解决呢？如果使用 vpn 的办法，是不是可以？","like_count":0,"discussions":[{"author":{"id":1181974,"avatar":"https://static001.geekbang.org/account/avatar/00/12/09/16/1161017c.jpg","nickname":"罗剑锋","note":"","ucode":"95678C988F24AB","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":621319,"discussion_content":"国内的镜像源用的不多，还是尽量用源站比较好，具体的方式就得自己想办法了。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1687142936,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"北京","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":373181,"user_name":"Geek_9d43c0","can_delete":false,"product_type":"c1","uid":3051841,"ip_address":"北京","ucode":"68EEFAC76D921B","user_header":"https://thirdwx.qlogo.cn/mmopen/vi_32/Gtf3tMDmYRoCL9Eico52ciatacq4PUHfQ8icQIYKV6KLDAJyTa8ZnLXMKf05pEice5RnEagocFobca5zv8jwyPhNKA/132","comment_is_top":false,"comment_ctime":1682220563,"is_pvip":false,"replies":[{"id":136337,"content":"环境比较复杂，只看这些描述不太好解决，sorry了。","user_name":"作者回复","user_name_real":"编辑","uid":1181974,"ctime":1682307330,"ip_address":"上海","comment_id":373181,"utype":1}],"discussion_count":1,"race_medal":0,"score":8,"product_id":100114501,"comment_content":"老师 问个问题 我自己搞了腾讯云的服务器来搭建k8s集群 为了便宜用了三个学生账号 所以是跨vpc的 我kubeadm init的时候 用公网ip启动的 改了etcd的配置启动起来 但是我安装flannel插件之后 master node还是一直 not ready 我describe一下node  flannel.alpha.coreos.com&#47;public-ip: 150.158.21.231 flannel的public-ip都改了但是cni 还是报错NetworkPluginNotReady message:docker: network plugin is not ready: cni config uninitialized 不知道老师能不能指导一下该向哪个方向解决问题  ","like_count":0,"discussions":[{"author":{"id":1181974,"avatar":"https://static001.geekbang.org/account/avatar/00/12/09/16/1161017c.jpg","nickname":"罗剑锋","note":"","ucode":"95678C988F24AB","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":615504,"discussion_content":"环境比较复杂，只看这些描述不太好解决，sorry了。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1682307330,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"上海","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":372485,"user_name":"666","can_delete":false,"product_type":"c1","uid":3581923,"ip_address":"北京","ucode":"DB7480F5545229","user_header":"https://static001.geekbang.org/account/avatar/00/36/a7/e3/686bfe32.jpg","comment_is_top":false,"comment_ctime":1681199058,"is_pvip":false,"replies":[{"id":135993,"content":"因为去掉了master上的污点，可以参考后面的课程。","user_name":"作者回复","user_name_real":"编辑","uid":1181974,"ctime":1681298346,"ip_address":"上海","comment_id":372485,"utype":1}],"discussion_count":2,"race_medal":0,"score":8,"product_id":100114501,"comment_content":"kubectl get pod -o wide\nNAME   READY   STATUS    RESTARTS   AGE   IP          NODE     NOMINATED NODE   READINESS GATES\nngx    1&#47;1     Running   0          25m   10.10.0.5   master   &lt;none&gt;           &lt;none&gt;\nPod 运行在了Master 节点上，为什么？","like_count":0,"discussions":[{"author":{"id":1181974,"avatar":"https://static001.geekbang.org/account/avatar/00/12/09/16/1161017c.jpg","nickname":"罗剑锋","note":"","ucode":"95678C988F24AB","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":613386,"discussion_content":"因为去掉了master上的污点，可以参考后面的课程。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1681298346,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"上海","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":1,"child_discussions":[{"author":{"id":3581923,"avatar":"https://static001.geekbang.org/account/avatar/00/36/a7/e3/686bfe32.jpg","nickname":"666","note":"","ucode":"DB7480F5545229","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":1181974,"avatar":"https://static001.geekbang.org/account/avatar/00/12/09/16/1161017c.jpg","nickname":"罗剑锋","note":"","ucode":"95678C988F24AB","race_medal":0,"user_type":2,"is_pvip":false},"discussion":{"id":614098,"discussion_content":"好的，老师","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1681697301,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":613386,"ip_address":"广东","group_id":0},"score":614098,"extra":""}]}]},{"had_liked":false,"id":372006,"user_name":"星","can_delete":false,"product_type":"c1","uid":1039351,"ip_address":"北京","ucode":"652BF9B9DB377B","user_header":"https://static001.geekbang.org/account/avatar/00/0f/db/f7/29cff40f.jpg","comment_is_top":false,"comment_ctime":1680595878,"is_pvip":false,"replies":[{"id":135785,"content":"建议先用1.23试试，学习的话不必追求最新版本。","user_name":"作者回复","user_name_real":"编辑","uid":1181974,"ctime":1680597590,"ip_address":"上海","comment_id":372006,"utype":1}],"discussion_count":2,"race_medal":0,"score":8,"product_id":100114501,"comment_content":"我按照本文的的方法安装1.26.1，k8s的地址已经改变为registry.k8s.io，但是每次在kubeadm init阶段都会报错，看了日志依旧无法解决，请问哪位高人能够帮忙测试下这个版本，看是否能够成功init？感谢。","like_count":0,"discussions":[{"author":{"id":1181974,"avatar":"https://static001.geekbang.org/account/avatar/00/12/09/16/1161017c.jpg","nickname":"罗剑锋","note":"","ucode":"95678C988F24AB","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":612312,"discussion_content":"建议先用1.23试试，学习的话不必追求最新版本。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1680597590,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"上海","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":1,"child_discussions":[{"author":{"id":1039351,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/db/f7/29cff40f.jpg","nickname":"星","note":"","ucode":"652BF9B9DB377B","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":1181974,"avatar":"https://static001.geekbang.org/account/avatar/00/12/09/16/1161017c.jpg","nickname":"罗剑锋","note":"","ucode":"95678C988F24AB","race_medal":0,"user_type":2,"is_pvip":false},"discussion":{"id":612314,"discussion_content":"多谢老师，1.23没有问题。但1.26.1困扰了我差不多三四周了，网上的各种文章搜了个遍也没解决，所以就想着在这里问问。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1680597796,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":612312,"ip_address":"北京","group_id":0},"score":612314,"extra":""}]}]},{"had_liked":false,"id":371185,"user_name":"GeekNeo","can_delete":false,"product_type":"c1","uid":1146405,"ip_address":"浙江","ucode":"1D355A9BEB8BEA","user_header":"https://static001.geekbang.org/account/avatar/00/11/7e/25/3932dafd.jpg","comment_is_top":false,"comment_ctime":1679625213,"is_pvip":false,"replies":[{"id":135440,"content":"great","user_name":"作者回复","user_name_real":"编辑","uid":1181974,"ctime":1679705560,"ip_address":"湖南","comment_id":371185,"utype":1}],"discussion_count":1,"race_medal":0,"score":8,"product_id":100114501,"comment_content":"kubenetes：v1.26.3\n使用docker engine，下载cri-dockerd，并安装运行：\nwget https:&#47;&#47;github.com&#47;Mirantis&#47;cri-dockerd&#47;releases&#47;download&#47;v0.3.1&#47;cri-dockerd_0.3.1.3-0.ubuntu-jammy_amd64.deb\nsudo dpkg -i cri-dockerd_0.3.1.3-0.ubuntu-jammy_amd64.deb\nvim &#47;lib&#47;systemd&#47;system&#47;cri-docker.service\nExecStart=&#47;usr&#47;bin&#47;cri-dockerd --pod-infra-container-image=registry.aliyuncs.com&#47;google_containers&#47;pause:3.9 --container-runtime-endpoint fd:&#47;&#47;\nsudo systemctl daemon-reload\nsudo systemctl enable cri-docker.service\nsudo systemctl enable --now cri-docker.socket\n\n# 集群初始化\nsudo kubeadm init --pod-network-cidr=10.10.0.0&#47;16 --service-cidr=10.11.0.0&#47;16 --apiserver-advertise-address=172.17.40.175 --kubernetes-version=v1.26.3 --cri-socket=unix:&#47;&#47;&#47;var&#47;run&#47;cri-dockerd.sock --image-repository registry.aliyuncs.com&#47;google_containers","like_count":0,"discussions":[{"author":{"id":1181974,"avatar":"https://static001.geekbang.org/account/avatar/00/12/09/16/1161017c.jpg","nickname":"罗剑锋","note":"","ucode":"95678C988F24AB","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":610712,"discussion_content":"great","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1679705560,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"湖南","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":370899,"user_name":"默默且听风","can_delete":false,"product_type":"c1","uid":2539346,"ip_address":"北京","ucode":"105E5FD2429AE3","user_header":"https://static001.geekbang.org/account/avatar/00/26/bf/52/59304c42.jpg","comment_is_top":false,"comment_ctime":1679366471,"is_pvip":false,"replies":[{"id":135311,"content":"当然可以了，kubernetes支持arm和x86，而且主机间的通信与硬件体系无关。","user_name":"作者回复","user_name_real":"编辑","uid":1181974,"ctime":1679368855,"ip_address":"上海","comment_id":370899,"utype":1}],"discussion_count":2,"race_medal":0,"score":8,"product_id":100114501,"comment_content":"老师您好！我有一台X86架构20核32G的电脑和几张arm架构8核16G的板u。这两种都是Linux系统，请问可以用他们组成一个K8s集群吗？","like_count":0,"discussions":[{"author":{"id":1181974,"avatar":"https://static001.geekbang.org/account/avatar/00/12/09/16/1161017c.jpg","nickname":"罗剑锋","note":"","ucode":"95678C988F24AB","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":610053,"discussion_content":"当然可以了，kubernetes支持arm和x86，而且主机间的通信与硬件体系无关。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1679368855,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"上海","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":1,"child_discussions":[{"author":{"id":2539346,"avatar":"https://static001.geekbang.org/account/avatar/00/26/bf/52/59304c42.jpg","nickname":"默默且听风","note":"","ucode":"105E5FD2429AE3","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":1181974,"avatar":"https://static001.geekbang.org/account/avatar/00/12/09/16/1161017c.jpg","nickname":"罗剑锋","note":"","ucode":"95678C988F24AB","race_medal":0,"user_type":2,"is_pvip":false},"discussion":{"id":610063,"discussion_content":"谢谢老师，我去试试","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1679371710,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":610053,"ip_address":"北京","group_id":0},"score":610063,"extra":""}]}]},{"had_liked":false,"id":369964,"user_name":"蔡晓慧","can_delete":false,"product_type":"c1","uid":1588301,"ip_address":"北京","ucode":"8D177D2B37BD6D","user_header":"https://static001.geekbang.org/account/avatar/00/18/3c/4d/3dec4bfe.jpg","comment_is_top":false,"comment_ctime":1678182415,"is_pvip":false,"replies":[{"id":134881,"content":"great","user_name":"作者回复","user_name_real":"编辑","uid":1181974,"ctime":1678241477,"ip_address":"上海","comment_id":369964,"utype":1}],"discussion_count":1,"race_medal":0,"score":8,"product_id":100114501,"comment_content":"基于CentOS7-kubeadm搭建Kubernetes环境总结:https:&#47;&#47;www.yuque.com&#47;cxhello&#47;mrqkvb&#47;wfxa2aggz2uk6o1b","like_count":0,"discussions":[{"author":{"id":1181974,"avatar":"https://static001.geekbang.org/account/avatar/00/12/09/16/1161017c.jpg","nickname":"罗剑锋","note":"","ucode":"95678C988F24AB","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":608050,"discussion_content":"great","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1678241477,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"上海","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":367467,"user_name":"极客酱酱","can_delete":false,"product_type":"c1","uid":2934665,"ip_address":"四川","ucode":"18CDC1DB754D58","user_header":"https://static001.geekbang.org/account/avatar/00/2c/c7/89/16437396.jpg","comment_is_top":false,"comment_ctime":1675250320,"is_pvip":false,"replies":[{"id":133840,"content":"good","user_name":"作者回复","user_name_real":"编辑","uid":1181974,"ctime":1675294301,"ip_address":"上海","comment_id":367467,"utype":1}],"discussion_count":1,"race_medal":0,"score":8,"product_id":100114501,"comment_content":"安装 Flannel 网络插件后，需要稍等一会后master节点才会显示Ready哦","like_count":0,"discussions":[{"author":{"id":1181974,"avatar":"https://static001.geekbang.org/account/avatar/00/12/09/16/1161017c.jpg","nickname":"罗剑锋","note":"","ucode":"95678C988F24AB","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":601549,"discussion_content":"good","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1675294301,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"上海","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":367071,"user_name":"jntv","can_delete":false,"product_type":"c1","uid":2133637,"ip_address":"山东","ucode":"320EFA463E2F59","user_header":"","comment_is_top":false,"comment_ctime":1674892433,"is_pvip":true,"replies":[{"id":133757,"content":"good","user_name":"作者回复","user_name_real":"编辑","uid":1181974,"ctime":1674955034,"ip_address":"北京","comment_id":367071,"utype":1}],"discussion_count":1,"race_medal":0,"score":9,"product_id":100114501,"comment_content":"执行scp ~&#47;.kube&#47;config到console节点时，需要先在console节点上通过mkdir ~&#47;.kube创建下目录","like_count":0,"discussions":[{"author":{"id":1181974,"avatar":"https://static001.geekbang.org/account/avatar/00/12/09/16/1161017c.jpg","nickname":"罗剑锋","note":"","ucode":"95678C988F24AB","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":600896,"discussion_content":"good","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1674955034,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"北京","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":365759,"user_name":"HD","can_delete":false,"product_type":"c1","uid":2808415,"ip_address":"北京","ucode":"E7990C3384BDF4","user_header":"https://static001.geekbang.org/account/avatar/00/2a/da/5f/f72f0ffd.jpg","comment_is_top":false,"comment_ctime":1672975726,"is_pvip":false,"replies":[{"id":133217,"content":"应该不会吧，kubectl访问的配置文件就是.kube目录，可以再找找其他原因。","user_name":"作者回复","user_name_real":"编辑","uid":1181974,"ctime":1672983536,"ip_address":"北京","comment_id":365759,"utype":1}],"discussion_count":2,"race_medal":0,"score":9,"product_id":100114501,"comment_content":"老师，出现个问题有点不理解。第一个worker节点需要从master节点拷贝admin.conf到&#47;etc&#47;kubernetes&#47; 下面才能使用kubectl，第二个worker节点只拷贝了config到~&#47;.kube下面就能用kubectl了。","like_count":0,"discussions":[{"author":{"id":1181974,"avatar":"https://static001.geekbang.org/account/avatar/00/12/09/16/1161017c.jpg","nickname":"罗剑锋","note":"","ucode":"95678C988F24AB","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":598664,"discussion_content":"应该不会吧，kubectl访问的配置文件就是.kube目录，可以再找找其他原因。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1672983536,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"北京","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":1,"child_discussions":[{"author":{"id":2808415,"avatar":"https://static001.geekbang.org/account/avatar/00/2a/da/5f/f72f0ffd.jpg","nickname":"HD","note":"","ucode":"E7990C3384BDF4","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":1181974,"avatar":"https://static001.geekbang.org/account/avatar/00/12/09/16/1161017c.jpg","nickname":"罗剑锋","note":"","ucode":"95678C988F24AB","race_medal":0,"user_type":2,"is_pvip":false},"discussion":{"id":598930,"discussion_content":"找到原因了:是我在worker节点上 使用了 export KUBECONFIG=/etc/kubernetes/admin.conf。使用 export -n KUBECONFIG 删除这个变量导出属性即可。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1673230224,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":598664,"ip_address":"广东","group_id":0},"score":598930,"extra":""}]}]},{"had_liked":false,"id":365555,"user_name":"卩杉","can_delete":false,"product_type":"c1","uid":2040638,"ip_address":"北京","ucode":"0382166A3F41C3","user_header":"https://static001.geekbang.org/account/avatar/00/1f/23/3e/3fc5d62d.jpg","comment_is_top":false,"comment_ctime":1672756176,"is_pvip":false,"replies":[{"id":133148,"content":"它其实是YAML 里的一个字段，不是文件。","user_name":"作者回复","user_name_real":"编辑","uid":1181974,"ctime":1672789717,"ip_address":"北京","comment_id":365555,"utype":1}],"discussion_count":1,"race_medal":0,"score":9,"product_id":100114501,"comment_content":"net-conf.json\n这个文件在哪儿","like_count":0,"discussions":[{"author":{"id":1181974,"avatar":"https://static001.geekbang.org/account/avatar/00/12/09/16/1161017c.jpg","nickname":"罗剑锋","note":"","ucode":"95678C988F24AB","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":598344,"discussion_content":"它其实是YAML 里的一个字段，不是文件。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1672789717,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"北京","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":365491,"user_name":"吴松文","can_delete":false,"product_type":"c1","uid":1086406,"ip_address":"北京","ucode":"F091DFD812C8BB","user_header":"https://static001.geekbang.org/account/avatar/00/10/93/c6/a5a888d4.jpg","comment_is_top":false,"comment_ctime":1672669237,"is_pvip":false,"replies":[{"id":133135,"content":"可以用port-forward的方式来测试，后面还会用到Service来暴露端口。","user_name":"作者回复","user_name_real":"编辑","uid":1181974,"ctime":1672707868,"ip_address":"北京","comment_id":365491,"utype":1}],"discussion_count":1,"race_medal":0,"score":9,"product_id":100114501,"comment_content":"老师，环境搭建好了，ngx的pod也可以看到，但是ngx要如何访问？","like_count":0,"discussions":[{"author":{"id":1181974,"avatar":"https://static001.geekbang.org/account/avatar/00/12/09/16/1161017c.jpg","nickname":"罗剑锋","note":"","ucode":"95678C988F24AB","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":598232,"discussion_content":"可以用port-forward的方式来测试，后面还会用到Service来暴露端口。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1672707868,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"北京","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":365138,"user_name":"conorzhong","can_delete":false,"product_type":"c1","uid":2150926,"ip_address":"北京","ucode":"A2AAE8B6B41031","user_header":"https://static001.geekbang.org/account/avatar/00/20/d2/0e/579fc19b.jpg","comment_is_top":false,"comment_ctime":1672154348,"is_pvip":false,"replies":[{"id":132977,"content":"看来是个小失误，感谢指正。","user_name":"作者回复","user_name_real":"编辑","uid":1181974,"ctime":1672199916,"ip_address":"北京","comment_id":365138,"utype":1}],"discussion_count":1,"race_medal":0,"score":9,"product_id":100114501,"comment_content":"最后那个scp命令那里好像缺少在console节点创建.kube文件夹，导致.kube成了文件","like_count":0,"discussions":[{"author":{"id":1181974,"avatar":"https://static001.geekbang.org/account/avatar/00/12/09/16/1161017c.jpg","nickname":"罗剑锋","note":"","ucode":"95678C988F24AB","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":597738,"discussion_content":"看来是个小失误，感谢指正。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1672199916,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"北京","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":365105,"user_name":"你好极客时间","can_delete":false,"product_type":"c1","uid":2113412,"ip_address":"北京","ucode":"EC1AE9FD105234","user_header":"https://static001.geekbang.org/account/avatar/00/20/3f/84/47f7b661.jpg","comment_is_top":false,"comment_ctime":1672111671,"is_pvip":false,"replies":[{"id":132933,"content":"good","user_name":"作者回复","user_name_real":"编辑","uid":1181974,"ctime":1672119641,"ip_address":"北京","comment_id":365105,"utype":1}],"discussion_count":1,"race_medal":0,"score":9,"product_id":100114501,"comment_content":"kubeadm init 命令中，--apiserver-advertise-address=192.168.10.210的地址，一定是ifconfig里面的一个实际地址，比如virbr0的ip，否则会卡在这里不能成功 [kubelet-check] Initial timeout of 40s passed.","like_count":0,"discussions":[{"author":{"id":1181974,"avatar":"https://static001.geekbang.org/account/avatar/00/12/09/16/1161017c.jpg","nickname":"罗剑锋","note":"","ucode":"95678C988F24AB","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":597637,"discussion_content":"good","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1672119642,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"北京","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":364975,"user_name":"LRG-","can_delete":false,"product_type":"c1","uid":1090110,"ip_address":"上海","ucode":"497C983B36A4A2","user_header":"https://static001.geekbang.org/account/avatar/00/10/a2/3e/7d9812f2.jpg","comment_is_top":false,"comment_ctime":1671835901,"is_pvip":false,"replies":[{"id":132927,"content":"master.sh里最主要的就是kubeadm init命令，如果是超时可能是访问外网的原因吧，找个好点的vpn试试。\n另外kubeadm的错误提示都是比较详细的，把信息拷贝到搜索引擎里搜一下，一般都能找到解决方案。","user_name":"作者回复","user_name_real":"编辑","uid":1181974,"ctime":1672048622,"ip_address":"上海","comment_id":364975,"utype":1}],"discussion_count":1,"race_medal":0,"score":9,"product_id":100114501,"comment_content":"老师你好，我运行到 master.sh的时候，就是出现超时的错误。我试了很多遍，ip也检查过的。你能给我一些提示，我还是检查那些设置吗？","like_count":0,"discussions":[{"author":{"id":1181974,"avatar":"https://static001.geekbang.org/account/avatar/00/12/09/16/1161017c.jpg","nickname":"罗剑锋","note":"","ucode":"95678C988F24AB","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":597589,"discussion_content":"master.sh里最主要的就是kubeadm init命令，如果是超时可能是访问外网的原因吧，找个好点的vpn试试。\n另外kubeadm的错误提示都是比较详细的，把信息拷贝到搜索引擎里搜一下，一般都能找到解决方案。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1672048622,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"上海","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":364340,"user_name":"snake","can_delete":false,"product_type":"c1","uid":3183263,"ip_address":"上海","ucode":"0C7398D3A68119","user_header":"https://static001.geekbang.org/account/avatar/00/30/92/9f/d5255fe8.jpg","comment_is_top":false,"comment_ctime":1670838331,"is_pvip":false,"replies":[{"id":132418,"content":"必须是两台分离的服务器，因为上面运行的进程不一样。\n\n如果是一台服务器，那就不需要用kubeadm了，直接minikube就够了。","user_name":"作者回复","user_name_real":"编辑","uid":1181974,"ctime":1670841264,"ip_address":"上海","comment_id":364340,"utype":1}],"discussion_count":1,"race_medal":0,"score":9,"product_id":100114501,"comment_content":"问下老师，master和worker必须安装到两台服务器吗，一台服务器可以吗","like_count":0,"discussions":[{"author":{"id":1181974,"avatar":"https://static001.geekbang.org/account/avatar/00/12/09/16/1161017c.jpg","nickname":"罗剑锋","note":"","ucode":"95678C988F24AB","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":596277,"discussion_content":"必须是两台分离的服务器，因为上面运行的进程不一样。\n\n如果是一台服务器，那就不需要用kubeadm了，直接minikube就够了。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1670841264,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"上海","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":363512,"user_name":"Apple_d39574","can_delete":false,"product_type":"c1","uid":3038791,"ip_address":"北京","ucode":"5CC841D6F69B82","user_header":"https://thirdwx.qlogo.cn/mmopen/vi_32/mvvjzu4D1gJl8c9lnMMTatOou2EUsWCe4XiclyUOwk2rUawwqd6KKV8z9bSRMnD3ibQPUCIZUQOAkKAaKX0Ncaibw/132","comment_is_top":false,"comment_ctime":1669770716,"is_pvip":false,"replies":[{"id":132123,"content":"应该是kubectl找不到config文件。\n\n感觉这个操作虽然可行但不太对，只要按照kubeadm的提示，拷贝config到.kube目录就可以了，可以再对照一下安装步骤，看看是否遗漏了什么。","user_name":"作者回复","user_name_real":"编辑","uid":1181974,"ctime":1669771465,"ip_address":"北京","comment_id":363512,"utype":1}],"discussion_count":1,"race_medal":0,"score":9,"product_id":100114501,"comment_content":"echo &quot;export KUBECONFIG=&#47;etc&#47;kubernetes&#47;admin.conf&quot; &gt;&gt; ~&#47;.bash_profile\nsource ~&#47;.bash_profile\n这么操作才能看到kubectl version server 版本\n而且机器临时保持状态或者关闭还要在再次执行上面才能看到服务版本，这是因为什么？","like_count":0,"discussions":[{"author":{"id":1181974,"avatar":"https://static001.geekbang.org/account/avatar/00/12/09/16/1161017c.jpg","nickname":"罗剑锋","note":"","ucode":"95678C988F24AB","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":595133,"discussion_content":"应该是kubectl找不到config文件。\n\n感觉这个操作虽然可行但不太对，只要按照kubeadm的提示，拷贝config到.kube目录就可以了，可以再对照一下安装步骤，看看是否遗漏了什么。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1669771465,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"北京","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":363350,"user_name":"顾新~","can_delete":false,"product_type":"c1","uid":1759698,"ip_address":"北京","ucode":"D088907D2815E9","user_header":"https://static001.geekbang.org/account/avatar/00/1a/d9/d2/64f93ca1.jpg","comment_is_top":false,"comment_ctime":1669563293,"is_pvip":false,"replies":[{"id":132092,"content":"是的，kubeadm安装完master节点之后，就可以拷贝config文件到console节点了。","user_name":"作者回复","user_name_real":"编辑","uid":1181974,"ctime":1669602121,"ip_address":"北京","comment_id":363350,"utype":1}],"discussion_count":1,"race_medal":0,"score":9,"product_id":100114501,"comment_content":"Console 节点的部署的部署是基于哪个步骤以后的，是安装玩kubeadm 这个以后吗？","like_count":0,"discussions":[{"author":{"id":1181974,"avatar":"https://static001.geekbang.org/account/avatar/00/12/09/16/1161017c.jpg","nickname":"罗剑锋","note":"","ucode":"95678C988F24AB","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":594947,"discussion_content":"是的，kubeadm安装完master节点之后，就可以拷贝config文件到console节点了。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1669602121,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"北京","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":363215,"user_name":"zzz","can_delete":false,"product_type":"c1","uid":1216328,"ip_address":"北京","ucode":"31A5F705F012FA","user_header":"https://static001.geekbang.org/account/avatar/00/12/8f/48/c7fb8067.jpg","comment_is_top":false,"comment_ctime":1669367296,"is_pvip":false,"replies":[{"id":132066,"content":"建议尽量都在普通用户权限下操作，root用户权限太高，可能会有意想不到的错误发生。","user_name":"作者回复","user_name_real":"编辑","uid":1181974,"ctime":1669375960,"ip_address":"北京","comment_id":363215,"utype":1}],"discussion_count":1,"race_medal":0,"score":10,"product_id":100114501,"comment_content":"提示一个错误：\n如果使用普通用户，执行 k get pods &#47; k get nodes 时，报如下错误，可执行如下操作\n1、切换至root用户\n2、修改admin.conf文件权限chmod 666 &#47;etc&#47;kubernetes&#47;admin.conf\n\nubuntu@master:~&#47;.kube$ k get pods\nerror: error loading config file &quot;&#47;etc&#47;kubernetes&#47;admin.conf&quot;: open &#47;etc&#47;kubernetes&#47;admin.conf: permission denied\n","like_count":0,"discussions":[{"author":{"id":1181974,"avatar":"https://static001.geekbang.org/account/avatar/00/12/09/16/1161017c.jpg","nickname":"罗剑锋","note":"","ucode":"95678C988F24AB","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":594786,"discussion_content":"建议尽量都在普通用户权限下操作，root用户权限太高，可能会有意想不到的错误发生。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1669375960,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"北京","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":363099,"user_name":"XXG","can_delete":false,"product_type":"c1","uid":1219238,"ip_address":"北京","ucode":"55258F95874BF4","user_header":"https://static001.geekbang.org/account/avatar/00/12/9a/a6/29ac6f6a.jpg","comment_is_top":false,"comment_ctime":1669217655,"is_pvip":false,"replies":[{"id":132044,"content":"其实不用卸载minikube，只要把.kube目录下的config备份后改名，再用kubeadm的config覆盖就行了。\n\n关键是要有.kube目录，然后里面有config文件，可以再认真看看kubeadm的提示。","user_name":"作者回复","user_name_real":"编辑","uid":1181974,"ctime":1669257104,"ip_address":"北京","comment_id":363099,"utype":1}],"discussion_count":2,"race_medal":0,"score":10,"product_id":100114501,"comment_content":"前面很顺利，最后Console节点装kubectl卡住了。 复用的前面装minikube的虚拟机，结果好像和minikube冲突，卸载了minikube也不行，又把虚拟机快照往前回滚了重新安装kubectl，重新执行scp拷贝config文件过来，执行kubectl get pod报错：error: stat &#47;home&#47;xxg&#47;.kube&#47;config: not a directory\n","like_count":0,"discussions":[{"author":{"id":1181974,"avatar":"https://static001.geekbang.org/account/avatar/00/12/09/16/1161017c.jpg","nickname":"罗剑锋","note":"","ucode":"95678C988F24AB","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":594649,"discussion_content":"其实不用卸载minikube，只要把.kube目录下的config备份后改名，再用kubeadm的config覆盖就行了。\n\n关键是要有.kube目录，然后里面有config文件，可以再认真看看kubeadm的提示。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1669257104,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"北京","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1759698,"avatar":"https://static001.geekbang.org/account/avatar/00/1a/d9/d2/64f93ca1.jpg","nickname":"顾新~","note":"","ucode":"D088907D2815E9","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":594929,"discussion_content":"你的可以了吗？","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1669563532,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":"北京","group_id":0},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":362976,"user_name":"vivi","can_delete":false,"product_type":"c1","uid":2710540,"ip_address":"上海","ucode":"C9489CDCC37263","user_header":"https://static001.geekbang.org/account/avatar/00/29/5c/0c/e504ebfe.jpg","comment_is_top":false,"comment_ctime":1669090893,"is_pvip":false,"replies":[{"id":132025,"content":"Kubernetes不能用systemctl管理，要用kubectl查看kube-system名字空间，然后删除flannel 的pod重启，或者用rollout命令重启。","user_name":"作者回复","user_name_real":"编辑","uid":1181974,"ctime":1669094312,"ip_address":"上海","comment_id":362976,"utype":1}],"discussion_count":1,"race_medal":0,"score":10,"product_id":100114501,"comment_content":"请教老师和各位大佬：flannel安装成功。但是第二天开机后get node又成了not ready，这个网络插件服务如何重启呢？用「systemctl start flanneld」命令会报如下错误：\n\nroot@master:&#47;home&#47;parallels# systemctl start flanneld\nFailed to start flanneld.service: Unit flanneld.service not found.\n","like_count":0,"discussions":[{"author":{"id":1181974,"avatar":"https://static001.geekbang.org/account/avatar/00/12/09/16/1161017c.jpg","nickname":"罗剑锋","note":"","ucode":"95678C988F24AB","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":594490,"discussion_content":"Kubernetes不能用systemctl管理，要用kubectl查看kube-system名字空间，然后删除flannel 的pod重启，或者用rollout命令重启。","likes_number":1,"is_delete":false,"is_hidden":false,"ctime":1669094312,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"上海","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":362919,"user_name":"edward","can_delete":false,"product_type":"c1","uid":1604798,"ip_address":"北京","ucode":"09F7A5B8D2E7BD","user_header":"","comment_is_top":false,"comment_ctime":1669025635,"is_pvip":false,"replies":[{"id":132017,"content":"1.24之后，master这个名字就不用了，改成了control-plane，原因嘛，你懂的。","user_name":"作者回复","user_name_real":"编辑","uid":1181974,"ctime":1669032636,"ip_address":"北京","comment_id":362919,"utype":1}],"discussion_count":1,"race_medal":0,"score":10,"product_id":100114501,"comment_content":"罗老师，我执行kubectl get nodes后master节点的ROLES这列只有control-plane，没有出现master, 这个是什么原因呢","like_count":0,"discussions":[{"author":{"id":1181974,"avatar":"https://static001.geekbang.org/account/avatar/00/12/09/16/1161017c.jpg","nickname":"罗剑锋","note":"","ucode":"95678C988F24AB","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":594437,"discussion_content":"1.24之后，master这个名字就不用了，改成了control-plane，原因嘛，你懂的。","likes_number":1,"is_delete":false,"is_hidden":false,"ctime":1669032636,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"北京","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":362766,"user_name":"菲茨杰拉德","can_delete":false,"product_type":"c1","uid":1875922,"ip_address":"北京","ucode":"4EB29359F39862","user_header":"https://static001.geekbang.org/account/avatar/00/1c/9f/d2/b6d8df48.jpg","comment_is_top":false,"comment_ctime":1668859349,"is_pvip":false,"replies":[{"id":131947,"content":"我自己手动设置过，不过在这节课里没有特意提，因为污点要到后面才会讲。\n\nconsole只是用kubectl发送命令，与master节点、Kubernetes的运行没有直接关系。","user_name":"作者回复","user_name_real":"编辑","uid":1181974,"ctime":1668996261,"ip_address":"北京","comment_id":362766,"utype":1}],"discussion_count":1,"race_medal":0,"score":10,"product_id":100114501,"comment_content":"kubectl run ngx --image=nginx:alpine\n一直pending中，看日志是，master有污点，pod不能容忍。\n老师设置过master节点容忍污点吗？我在worker运行\nkubectl run ngx --image=nginx:alpine ，也是这个问题。必须要使用consle机器吗？","like_count":0,"discussions":[{"author":{"id":1181974,"avatar":"https://static001.geekbang.org/account/avatar/00/12/09/16/1161017c.jpg","nickname":"罗剑锋","note":"","ucode":"95678C988F24AB","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":594336,"discussion_content":"我自己手动设置过，不过在这节课里没有特意提，因为污点要到后面才会讲。\n\nconsole只是用kubectl发送命令，与master节点、Kubernetes的运行没有直接关系。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1668996261,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"北京","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":362703,"user_name":"路先生","can_delete":false,"product_type":"c1","uid":1700663,"ip_address":"北京","ucode":"AC42E46434A569","user_header":"https://static001.geekbang.org/account/avatar/00/19/f3/37/30a09a4a.jpg","comment_is_top":false,"comment_ctime":1668766208,"is_pvip":false,"replies":[{"id":131891,"content":"用kubeadm join，然后安装flannel，init是master节点用的，可以参考一下后面的视频。","user_name":"作者回复","user_name_real":"编辑","uid":1181974,"ctime":1668773411,"ip_address":"北京","comment_id":362703,"utype":1}],"discussion_count":2,"race_medal":0,"score":10,"product_id":100114501,"comment_content":"罗老师麻烦回复下，work node需要执行kubeadm init 吗？\nwork node执行 kubectl get node 报错：The connection to the server localhost:8080 was refused - did you specify the right host or port?\nwork node需要执行：kubectl apply -f kube-flannel.yml吗？\n在work node执行kubectl apply -f kube-flannel.yml报错：The connection to the server localhost:8080 was refused - did you specify the right host or port?","like_count":0,"discussions":[{"author":{"id":1181974,"avatar":"https://static001.geekbang.org/account/avatar/00/12/09/16/1161017c.jpg","nickname":"罗剑锋","note":"","ucode":"95678C988F24AB","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":594094,"discussion_content":"用kubeadm join，然后安装flannel，init是master节点用的，可以参考一下后面的视频。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1668773411,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"北京","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1143399,"avatar":"https://static001.geekbang.org/account/avatar/00/11/72/67/aa52812a.jpg","nickname":"stark","note":"","ucode":"ADC5C2AE5B97C8","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":597484,"discussion_content":"我跟你这个问题一样，你后来搞定了么？是什么原因啊","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1671875553,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":"北京","group_id":0},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":362685,"user_name":"vivi","can_delete":false,"product_type":"c1","uid":2710540,"ip_address":"北京","ucode":"C9489CDCC37263","user_header":"https://static001.geekbang.org/account/avatar/00/29/5c/0c/e504ebfe.jpg","comment_is_top":false,"comment_ctime":1668749806,"is_pvip":false,"replies":[{"id":131881,"content":"看看是不是flannel的配置没写对，注意它里面的ip地址。\n\nminikube可以不用卸载，stop就行，停止了就不占用资源。","user_name":"作者回复","user_name_real":"编辑","uid":1181974,"ctime":1668757883,"ip_address":"北京","comment_id":362685,"utype":1}],"discussion_count":1,"race_medal":0,"score":10,"product_id":100114501,"comment_content":"Unable to connect to the server: dial tcp 192.168.22.249:8443: connect: no route to host\n装好Flannel插件，重启就会报这个异常。Google后，重新kubeadm init，也解决不了。请问各位有没有碰到过，解决办法是？\n另外，此后不用Minikube了吧，可否卸载掉呢？","like_count":0,"discussions":[{"author":{"id":1181974,"avatar":"https://static001.geekbang.org/account/avatar/00/12/09/16/1161017c.jpg","nickname":"罗剑锋","note":"","ucode":"95678C988F24AB","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":594064,"discussion_content":"看看是不是flannel的配置没写对，注意它里面的ip地址。\n\nminikube可以不用卸载，stop就行，停止了就不占用资源。","likes_number":1,"is_delete":false,"is_hidden":false,"ctime":1668757883,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"北京","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":362655,"user_name":"⛽️🦆","can_delete":false,"product_type":"c1","uid":1674059,"ip_address":"北京","ucode":"7D952CAFDBBD99","user_header":"https://static001.geekbang.org/account/avatar/00/19/8b/4b/9e0d334f.jpg","comment_is_top":false,"comment_ctime":1668727105,"is_pvip":false,"replies":[{"id":131867,"content":"它就是一个向Kubernetes集群发送命令的“控制台”，理论上是与Kubernetes无关的，只要安装了kubectl和相应的config，能够与Kubernetes集群通信就可以了。\n\n任何有kubectl的计算机都可以作为console，所以Kubernetes集群里的master、node节点，只要有kubectl，就可以认为是console。\n\n它是一个逻辑角色，可以和已有的机器重合。","user_name":"作者回复","user_name_real":"编辑","uid":1181974,"ctime":1668734914,"ip_address":"北京","comment_id":362655,"utype":1}],"discussion_count":1,"race_medal":0,"score":10,"product_id":100114501,"comment_content":"你好，老师，还是没太理解console的概念跟作用。","like_count":0,"discussions":[{"author":{"id":1181974,"avatar":"https://static001.geekbang.org/account/avatar/00/12/09/16/1161017c.jpg","nickname":"罗剑锋","note":"","ucode":"95678C988F24AB","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":594026,"discussion_content":"它就是一个向Kubernetes集群发送命令的“控制台”，理论上是与Kubernetes无关的，只要安装了kubectl和相应的config，能够与Kubernetes集群通信就可以了。\n\n任何有kubectl的计算机都可以作为console，所以Kubernetes集群里的master、node节点，只要有kubectl，就可以认为是console。\n\n它是一个逻辑角色，可以和已有的机器重合。","likes_number":1,"is_delete":false,"is_hidden":false,"ctime":1668734914,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"北京","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":362440,"user_name":"edward","can_delete":false,"product_type":"c1","uid":1604798,"ip_address":"北京","ucode":"09F7A5B8D2E7BD","user_header":"","comment_is_top":false,"comment_ctime":1668517465,"is_pvip":false,"replies":[{"id":131824,"content":"应该是在worker节点的准备工作没做好吧，服务器重新安装，重新跑脚本试试。","user_name":"作者回复","user_name_real":"编辑","uid":1181974,"ctime":1668553193,"ip_address":"北京","comment_id":362440,"utype":1}],"discussion_count":2,"race_medal":0,"score":10,"product_id":100114501,"comment_content":"但又遇到了另外一个问题。。太难了:-）\nsudo kubeadm join 192.168.1.104:6443 --token tv9mkx.tw7it9vphe158e74 --discovery-token-ca-cert-hash sha256:e8721b8630d5b562e23c010c70559a6d3084f629abad6a2920e87855f8fb96f3\n[preflight] Running pre-flight checks\n\t[WARNING SystemVerification]: missing optional cgroups: blkio\nerror execution phase preflight: [preflight] Some fatal errors occurred:\n\t[ERROR FileAvailable--etc-kubernetes-kubelet.conf]: &#47;etc&#47;kubernetes&#47;kubelet.conf already exists\n\t[ERROR Port-10250]: Port 10250 is in use\n\t[ERROR FileAvailable--etc-kubernetes-pki-ca.crt]: &#47;etc&#47;kubernetes&#47;pki&#47;ca.crt already exists\n[preflight] If you know what you are doing, you can make a check non-fatal with `--ignore-preflight-errors=...`","like_count":0,"discussions":[{"author":{"id":1181974,"avatar":"https://static001.geekbang.org/account/avatar/00/12/09/16/1161017c.jpg","nickname":"罗剑锋","note":"","ucode":"95678C988F24AB","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":593800,"discussion_content":"应该是在worker节点的准备工作没做好吧，服务器重新安装，重新跑脚本试试。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1668553193,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"北京","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":2934665,"avatar":"https://static001.geekbang.org/account/avatar/00/2c/c7/89/16437396.jpg","nickname":"极客酱酱","note":"","ucode":"18CDC1DB754D58","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":601589,"discussion_content":"感觉是克隆虚拟机导致的，master配置复制到了worker上，在worker执行sudo kubeadm reset后再join","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1675308682,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":"四川","group_id":0},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":362411,"user_name":"edward","can_delete":false,"product_type":"c1","uid":1604798,"ip_address":"北京","ucode":"09F7A5B8D2E7BD","user_header":"","comment_is_top":false,"comment_ctime":1668494220,"is_pvip":false,"replies":[{"id":131814,"content":"是不是1.25.4版本太新，国内还没有这个的镜像，尝试指定低版本的看看。","user_name":"作者回复","user_name_real":"编辑","uid":1181974,"ctime":1668515185,"ip_address":"北京","comment_id":362411,"utype":1}],"discussion_count":2,"race_medal":0,"score":10,"product_id":100114501,"comment_content":"老师，我在执行第二种方法下载k8s组件的时候提示这个，我是把您的脚本放sh文件中执行的，没有指定版本号，提示如下错误，不知道怎么回事了。\nError response from daemon: pull access denied for registry.aliyuncs.com&#47;google_containers&#47;registry.k8s.io&#47;kube-apiserver, repository does not exist or may require &#39;docker login&#39;: denied: requested access to the resource is denied\nError response from daemon: No such image: registry.aliyuncs.com&#47;google_containers&#47;registry.k8s.io&#47;kube-apiserver:v1.25.4","like_count":0,"discussions":[{"author":{"id":1181974,"avatar":"https://static001.geekbang.org/account/avatar/00/12/09/16/1161017c.jpg","nickname":"罗剑锋","note":"","ucode":"95678C988F24AB","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":593763,"discussion_content":"是不是1.25.4版本太新，国内还没有这个的镜像，尝试指定低版本的看看。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1668515185,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"北京","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":1,"child_discussions":[{"author":{"id":1604798,"avatar":"","nickname":"edward","note":"","ucode":"09F7A5B8D2E7BD","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":1181974,"avatar":"https://static001.geekbang.org/account/avatar/00/12/09/16/1161017c.jpg","nickname":"罗剑锋","note":"","ucode":"95678C988F24AB","race_medal":0,"user_type":2,"is_pvip":false},"discussion":{"id":593766,"discussion_content":"谢谢老师，这个问题我连外网解决了","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1668515450,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":593763,"ip_address":"湖南","group_id":0},"score":593766,"extra":""}]}]},{"had_liked":false,"id":362344,"user_name":"Geek_6df977","can_delete":false,"product_type":"c1","uid":1695261,"ip_address":"北京","ucode":"4F26A42C9BD901","user_header":"http://thirdwx.qlogo.cn/mmopen/vi_32/9doFL0ZzcWf5gkQ10cHsOziamhHicjq1k2KHvJibkicBjHsKyvf9jMepvdgLFiadiaI8PScf73Pl7QK3ibp6MYicWn9BuQ/132","comment_is_top":false,"comment_ctime":1668429260,"is_pvip":false,"replies":[{"id":131804,"content":"ali的镜像应该是一直可用的吧，或者考虑采用课程里的办法，从minikube节点里导出，就是麻烦一些，当然最好的办法是直接从gcr.io下载。","user_name":"作者回复","user_name_real":"编辑","uid":1181974,"ctime":1668467877,"ip_address":"北京","comment_id":362344,"utype":1}],"discussion_count":1,"race_medal":0,"score":11,"product_id":100114501,"comment_content":"拉取k8s镜像的阿里镜像用不了，网上又找不到有用的镜像源怎么办","like_count":0,"discussions":[{"author":{"id":1181974,"avatar":"https://static001.geekbang.org/account/avatar/00/12/09/16/1161017c.jpg","nickname":"罗剑锋","note":"","ucode":"95678C988F24AB","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":593688,"discussion_content":"ali的镜像应该是一直可用的吧，或者考虑采用课程里的办法，从minikube节点里导出，就是麻烦一些，当然最好的办法是直接从gcr.io下载。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1668467877,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"北京","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":362256,"user_name":"edward","can_delete":false,"product_type":"c1","uid":1604798,"ip_address":"上海","ucode":"09F7A5B8D2E7BD","user_header":"","comment_is_top":false,"comment_ctime":1668348288,"is_pvip":false,"replies":[{"id":131780,"content":"我觉得可能是网络问题，或者改用wget试试。","user_name":"作者回复","user_name_real":"编辑","uid":1181974,"ctime":1668393020,"ip_address":"上海","comment_id":362256,"utype":1}],"discussion_count":1,"race_medal":0,"score":11,"product_id":100114501,"comment_content":"老师我这个命令没成功curl https:&#47;&#47;mirrors.aliyun.com&#47;kubernetes&#47;apt&#47;doc&#47;apt-key.gpg | sudo apt-key，下不下来，提示curl: (23) Failed writing body，请教下原因","like_count":0,"discussions":[{"author":{"id":1181974,"avatar":"https://static001.geekbang.org/account/avatar/00/12/09/16/1161017c.jpg","nickname":"罗剑锋","note":"","ucode":"95678C988F24AB","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":593615,"discussion_content":"我觉得可能是网络问题，或者改用wget试试。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1668393020,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"上海","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":361855,"user_name":"菲茨杰拉德","can_delete":false,"product_type":"c1","uid":1875922,"ip_address":"北京","ucode":"4EB29359F39862","user_header":"https://static001.geekbang.org/account/avatar/00/1c/9f/d2/b6d8df48.jpg","comment_is_top":false,"comment_ctime":1667917057,"is_pvip":false,"replies":[{"id":131631,"content":"Kubernetes会自动运行，不需要手工再启动。","user_name":"作者回复","user_name_real":"编辑","uid":1181974,"ctime":1667959737,"ip_address":"北京","comment_id":361855,"utype":1}],"discussion_count":2,"race_medal":0,"score":11,"product_id":100114501,"comment_content":"虚拟机重启后，需要重新启动k8s吗？ku","like_count":0,"discussions":[{"author":{"id":1181974,"avatar":"https://static001.geekbang.org/account/avatar/00/12/09/16/1161017c.jpg","nickname":"罗剑锋","note":"","ucode":"95678C988F24AB","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":593108,"discussion_content":"Kubernetes会自动运行，不需要手工再启动。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1667959738,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"北京","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":1,"child_discussions":[{"author":{"id":1875922,"avatar":"https://static001.geekbang.org/account/avatar/00/1c/9f/d2/b6d8df48.jpg","nickname":"菲茨杰拉德","note":"","ucode":"4EB29359F39862","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":1181974,"avatar":"https://static001.geekbang.org/account/avatar/00/12/09/16/1161017c.jpg","nickname":"罗剑锋","note":"","ucode":"95678C988F24AB","race_medal":0,"user_type":2,"is_pvip":false},"discussion":{"id":593113,"discussion_content":"嗯呢","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1667960274,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":593108,"ip_address":"北京","group_id":0},"score":593113,"extra":""}]}]},{"had_liked":false,"id":361288,"user_name":"...","can_delete":false,"product_type":"c1","uid":1896681,"ip_address":"上海","ucode":"E3694D4CED77E0","user_header":"https://static001.geekbang.org/account/avatar/00/1c/f0/e9/1ff0a3d5.jpg","comment_is_top":false,"comment_ctime":1667384778,"is_pvip":false,"replies":[{"id":131407,"content":"感谢补充，这个应该怪我，没有说清楚这个步骤，因为我一直都是用单独的console机来操作Kubernetes，比较少登录集群节点。","user_name":"作者回复","user_name_real":"编辑","uid":1181974,"ctime":1667395495,"ip_address":"上海","comment_id":361288,"utype":1}],"discussion_count":1,"race_medal":0,"score":11,"product_id":100114501,"comment_content":"在work节点加入master后，\nThe connection to the server localhost:8080 was refused - did you specify the right host or port?\n报这个错，主要是master的admin.conf文件没拷贝导致，需要拷贝到work节点后，就可以了。\n参考：\nhttps:&#47;&#47;www.cnblogs.com&#47;Ao0216&#47;p&#47;15903134.html\n\n加入节点，穿件pod，容器一直在creating时，一般是网络问题导致，需要添加一个文件，参考\nFLANNEL_NETWORK=10.10.0.0&#47;16\nFLANNEL_SUBNET=10.10.0.1&#47;16\nFLANNEL_MTU=1450\nFLANNEL_IPMASQ=true\n\n参考：https:&#47;&#47;www.likecs.com&#47;show-305671586.html \n\n终于搞定了。装个集群好难。。。好多问题。\n\n\n\n","like_count":0,"discussions":[{"author":{"id":1181974,"avatar":"https://static001.geekbang.org/account/avatar/00/12/09/16/1161017c.jpg","nickname":"罗剑锋","note":"","ucode":"95678C988F24AB","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":592431,"discussion_content":"感谢补充，这个应该怪我，没有说清楚这个步骤，因为我一直都是用单独的console机来操作Kubernetes，比较少登录集群节点。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1667395495,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"上海","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":360549,"user_name":"爱喝可乐的派大星星","can_delete":false,"product_type":"c1","uid":2462391,"ip_address":"上海","ucode":"F807A526F56DE6","user_header":"https://static001.geekbang.org/account/avatar/00/25/92/b7/fc482ba9.jpg","comment_is_top":false,"comment_ctime":1666630769,"is_pvip":false,"replies":[{"id":131177,"content":"在网上能够搜到一些，不过质量参差不齐，得自己鉴别一下了，建议学习的话还是用Ubuntu省事。","user_name":"作者回复","user_name_real":"编辑","uid":1181974,"ctime":1666668839,"ip_address":"上海","comment_id":360549,"utype":1}],"discussion_count":3,"race_medal":0,"score":11,"product_id":100114501,"comment_content":"有无大佬有centos安装文档","like_count":0,"discussions":[{"author":{"id":1181974,"avatar":"https://static001.geekbang.org/account/avatar/00/12/09/16/1161017c.jpg","nickname":"罗剑锋","note":"","ucode":"95678C988F24AB","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":591576,"discussion_content":"在网上能够搜到一些，不过质量参差不齐，得自己鉴别一下了，建议学习的话还是用Ubuntu省事。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1666668839,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"上海","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":1,"child_discussions":[{"author":{"id":2462391,"avatar":"https://static001.geekbang.org/account/avatar/00/25/92/b7/fc482ba9.jpg","nickname":"爱喝可乐的派大星星","note":"","ucode":"F807A526F56DE6","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":1181974,"avatar":"https://static001.geekbang.org/account/avatar/00/12/09/16/1161017c.jpg","nickname":"罗剑锋","note":"","ucode":"95678C988F24AB","race_medal":0,"user_type":2,"is_pvip":false},"discussion":{"id":591631,"discussion_content":"老师，master网络插件pod已经在running了，但是master状态还是notready，说是cni插件未初始化","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1666716028,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":591576,"ip_address":"广东","group_id":0},"score":591631,"extra":""}]},{"author":{"id":2169837,"avatar":"https://static001.geekbang.org/account/avatar/00/21/1b/ed/34d56ff4.jpg","nickname":"CV","note":"","ucode":"CBB5C73B22D3FC","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":593196,"discussion_content":"https://www.cnblogs.com/lb477/p/14841415.html 亲测有效。可以修改k8s版本为1.23.0\n此外，初始化master时需要把apiserver-advertise-address的ip改成本机ip，云服务器的话改成内网ip(ifconfig eth0)。最后安装flannel时，可以用老师的flannel.yaml，需要修改里面的net-conf.json。对照安装没问题的","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1667998409,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":"四川","group_id":0},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":360509,"user_name":"安石","can_delete":false,"product_type":"c1","uid":1508755,"ip_address":"上海","ucode":"185AD0046CF1C2","user_header":"https://static001.geekbang.org/account/avatar/00/17/05/93/3c3f2a6d.jpg","comment_is_top":false,"comment_ctime":1666605161,"is_pvip":false,"replies":[{"id":131169,"content":"感觉像是.kube目录里的config不对，是否正确拷贝了kubeadm初始化之后的配置文件？","user_name":"作者回复","user_name_real":"编辑","uid":1181974,"ctime":1666610559,"ip_address":"上海","comment_id":360509,"utype":1}],"discussion_count":1,"race_medal":0,"score":11,"product_id":100114501,"comment_content":"console能正常获取worker node为ready状态，但是 run ngx的时候报错：\n```\n kubectl run ngx --image=nginx:alpine --v=5\nW1024 17:51:09.689857   14003 loader.go:221] Config not found: &#47;etc&#47;kubernetes&#47;admin.conf\nI1024 17:51:09.692504   14003 cached_discovery.go:121] skipped caching discovery info due to Get &quot;http:&#47;&#47;localhost:8080&#47;api?timeout=32s&quot;: dial tcp 127.0.0.1:8080: connect: connection refused\nI1024 17:51:09.692585   14003 helpers.go:237] Connection error: Get http:&#47;&#47;localhost:8080&#47;api?timeout=32s: dial tcp 127.0.0.1:8080: connect: connection refused\nThe connection to the server localhost:8080 was refused - did you specify the right host or port?\n\n```","like_count":0,"discussions":[{"author":{"id":1181974,"avatar":"https://static001.geekbang.org/account/avatar/00/12/09/16/1161017c.jpg","nickname":"罗剑锋","note":"","ucode":"95678C988F24AB","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":591521,"discussion_content":"感觉像是.kube目录里的config不对，是否正确拷贝了kubeadm初始化之后的配置文件？","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1666610559,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"上海","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":360211,"user_name":"哇哈哈","can_delete":false,"product_type":"c1","uid":1175537,"ip_address":"上海","ucode":"47453D1C96A1DD","user_header":"https://static001.geekbang.org/account/avatar/00/11/ef/f1/8b06801a.jpg","comment_is_top":false,"comment_ctime":1666278900,"is_pvip":false,"replies":[{"id":131015,"content":"可能是.kube下面的config文件不对，检查一下。","user_name":"作者回复","user_name_real":"编辑","uid":1181974,"ctime":1666315987,"ip_address":"上海","comment_id":360211,"utype":1}],"discussion_count":1,"race_medal":0,"score":11,"product_id":100114501,"comment_content":"kubectl version执行提示“The connection to the server localhost:8080 was refused - did you specify the right host or port?”，但是 swap 的确已经关掉了，求解……","like_count":0,"discussions":[{"author":{"id":1181974,"avatar":"https://static001.geekbang.org/account/avatar/00/12/09/16/1161017c.jpg","nickname":"罗剑锋","note":"","ucode":"95678C988F24AB","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":591128,"discussion_content":"可能是.kube下面的config文件不对，检查一下。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1666315987,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"上海","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":360113,"user_name":"美妙的代码","can_delete":false,"product_type":"c1","uid":1111985,"ip_address":"上海","ucode":"9DADD72C193296","user_header":"https://static001.geekbang.org/account/avatar/00/10/f7/b1/982ea185.jpg","comment_is_top":false,"comment_ctime":1666183271,"is_pvip":true,"replies":[{"id":130997,"content":"和master节点是一样的步骤。","user_name":"作者回复","user_name_real":"编辑","uid":1181974,"ctime":1666232600,"ip_address":"上海","comment_id":360113,"utype":1}],"discussion_count":3,"race_medal":1,"score":11,"product_id":100114501,"comment_content":"worker 节点的 flannel 网络容器是怎么安装的呢？","like_count":0,"discussions":[{"author":{"id":1181974,"avatar":"https://static001.geekbang.org/account/avatar/00/12/09/16/1161017c.jpg","nickname":"罗剑锋","note":"","ucode":"95678C988F24AB","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":591026,"discussion_content":"和master节点是一样的步骤。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1666232600,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"上海","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":1,"child_discussions":[{"author":{"id":1111985,"avatar":"https://static001.geekbang.org/account/avatar/00/10/f7/b1/982ea185.jpg","nickname":"美妙的代码","note":"","ucode":"9DADD72C193296","race_medal":1,"user_type":1,"is_pvip":true},"reply_author":{"id":1181974,"avatar":"https://static001.geekbang.org/account/avatar/00/12/09/16/1161017c.jpg","nickname":"罗剑锋","note":"","ucode":"95678C988F24AB","race_medal":0,"user_type":2,"is_pvip":false},"discussion":{"id":591086,"discussion_content":"不行哦。  work 节点不能运行kubectl  apply -f ","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1666269000,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":591026,"ip_address":"四川","group_id":0},"score":591086,"extra":""}]},{"author":{"id":1111985,"avatar":"https://static001.geekbang.org/account/avatar/00/10/f7/b1/982ea185.jpg","nickname":"美妙的代码","note":"","ucode":"9DADD72C193296","race_medal":1,"user_type":1,"is_pvip":true},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":591087,"discussion_content":"提示无法连接 APIserver ","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1666269048,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":"四川","group_id":0},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":359440,"user_name":"Xu.","can_delete":false,"product_type":"c1","uid":1817449,"ip_address":"北京","ucode":"7163195EA638FA","user_header":"https://static001.geekbang.org/account/avatar/00/1b/bb/69/a8bb7a4a.jpg","comment_is_top":false,"comment_ctime":1665544337,"is_pvip":false,"replies":[{"id":130729,"content":"应该是containerd吧，没有确切的数据，这些runtime都各有特点，没有绝对的好和坏。","user_name":"作者回复","user_name_real":"编辑","uid":1181974,"ctime":1665554346,"ip_address":"北京","comment_id":359440,"utype":1}],"discussion_count":1,"race_medal":0,"score":11,"product_id":100114501,"comment_content":"老师您好，我想问下现在生产环境中 container runtime 用 cri-o 多还是 containerd 多","like_count":0,"discussions":[{"author":{"id":1181974,"avatar":"https://static001.geekbang.org/account/avatar/00/12/09/16/1161017c.jpg","nickname":"罗剑锋","note":"","ucode":"95678C988F24AB","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":590143,"discussion_content":"应该是containerd吧，没有确切的数据，这些runtime都各有特点，没有绝对的好和坏。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1665554346,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"北京","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":359250,"user_name":"柳成荫","can_delete":false,"product_type":"c1","uid":2341748,"ip_address":"北京","ucode":"911F75C3D7AE02","user_header":"https://static001.geekbang.org/account/avatar/00/23/bb/74/edc07099.jpg","comment_is_top":false,"comment_ctime":1665374067,"is_pvip":false,"replies":[{"id":130672,"content":"个人感觉CentOS没有Ubuntu那么容易使用，对开发者不太友好，我用的比较少，sorry了。","user_name":"作者回复","user_name_real":"编辑","uid":1181974,"ctime":1665404736,"ip_address":"北京","comment_id":359250,"utype":1}],"discussion_count":1,"race_medal":1,"score":11,"product_id":100114501,"comment_content":"centos安装遇到了很多坑，worker节点加入后没有角色，不需要设置吗？","like_count":0,"discussions":[{"author":{"id":1181974,"avatar":"https://static001.geekbang.org/account/avatar/00/12/09/16/1161017c.jpg","nickname":"罗剑锋","note":"","ucode":"95678C988F24AB","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":589937,"discussion_content":"个人感觉CentOS没有Ubuntu那么容易使用，对开发者不太友好，我用的比较少，sorry了。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1665404736,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"北京","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":359121,"user_name":"MonsterCale","can_delete":false,"product_type":"c1","uid":1018253,"ip_address":"北京","ucode":"4B3C32DDDFEA37","user_header":"","comment_is_top":false,"comment_ctime":1665279226,"is_pvip":false,"replies":[{"id":130645,"content":"这个不应该啊，把worker删除重装试试吧。","user_name":"作者回复","user_name_real":"编辑","uid":1181974,"ctime":1665356068,"ip_address":"北京","comment_id":359121,"utype":1}],"discussion_count":1,"race_medal":0,"score":12,"product_id":100114501,"comment_content":"worker节点kubeadm join之后，worker节点上kubectl get nodes能看到master、worker节点，都Ready了\nmaster节点kubectl get nodes只能看到master节点看不到worker节点，麻烦问下这是为什么","like_count":0,"discussions":[{"author":{"id":1181974,"avatar":"https://static001.geekbang.org/account/avatar/00/12/09/16/1161017c.jpg","nickname":"罗剑锋","note":"","ucode":"95678C988F24AB","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":589840,"discussion_content":"这个不应该啊，把worker删除重装试试吧。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1665356068,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"北京","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":358876,"user_name":"西瓜","can_delete":false,"product_type":"c1","uid":1533190,"ip_address":"北京","ucode":"F6905075337E64","user_header":"https://static001.geekbang.org/account/avatar/00/17/65/06/9d997340.jpg","comment_is_top":false,"comment_ctime":1664958955,"is_pvip":false,"replies":[{"id":130547,"content":"great，解决问题的过程能够更好地学习Kubernetes，加深对它的认识。","user_name":"作者回复","user_name_real":"编辑","uid":1181974,"ctime":1665059964,"ip_address":"北京","comment_id":358876,"utype":1}],"discussion_count":2,"race_medal":0,"score":12,"product_id":100114501,"comment_content":"列一下自己flannel启动后节点还是not ready的解决过程\n1、flannel daemonset和pod会启动在 kube-flannel namespace，使用命令 kubectl get ds -n kube-flannel 和 kubectl get pod -n kube-flannel 可以找到对应信息，而后使用 kubectl logs&#47;describle查看节点信息。\n2、查看flannel 的pod列表发现其中一个未启动，查看日志Failed to pull image &quot;docker.io&#47;rancher&#47;mirrored-flannelcni-flannel:v0.19.2&quot;: rpc error: code = Unknown desc = Error response from daemon: Get &quot;https:&#47;&#47;registry-1.docker.io&#47;v2&#47;&quot;: net&#47;http: TLS handshake timeout\n3、手动docker pull image  docker.io&#47;rancher&#47;mirrored-flannelcni-flannel:v0.19.2 尝试几次后成功，而后删除 flannel ds 和 pod，重新apply -f kube-flannel.yml \n4、不行的话kubeadm reset重新配置一遍","like_count":0,"discussions":[{"author":{"id":1181974,"avatar":"https://static001.geekbang.org/account/avatar/00/12/09/16/1161017c.jpg","nickname":"罗剑锋","note":"","ucode":"95678C988F24AB","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":589527,"discussion_content":"great，解决问题的过程能够更好地学习Kubernetes，加深对它的认识。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1665059964,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"北京","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1875922,"avatar":"https://static001.geekbang.org/account/avatar/00/1c/9f/d2/b6d8df48.jpg","nickname":"菲茨杰拉德","note":"","ucode":"4EB29359F39862","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":594454,"discussion_content":"我也是镜像下载不下来。手动pull之后呢？我的还是去远程拉取","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1669041232,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":"北京","group_id":0},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":358818,"user_name":"mamafeng","can_delete":false,"product_type":"c1","uid":3190249,"ip_address":"北京","ucode":"ED0AB11EAAC762","user_header":"https://static001.geekbang.org/account/avatar/00/30/ad/e9/778ddf53.jpg","comment_is_top":false,"comment_ctime":1664844965,"is_pvip":false,"replies":[{"id":130536,"content":"这个应该是没有正确拷贝kubeadm初始化的后的config文件吧，记得把config文件拷贝到kubectl所在的机器上，命令在kubeadm安装后有提示。","user_name":"作者回复","user_name_real":"编辑","uid":1181974,"ctime":1664959300,"ip_address":"北京","comment_id":358818,"utype":1}],"discussion_count":1,"race_medal":0,"score":12,"product_id":100114501,"comment_content":"请问下老师，我使用 kubeadm init 之后正常启动了，但是使用 kubectl get node，出现的提示却是 “error: no server found for cluster &quot;minikube&quot;” , minikube之前都停止了，有人知道为什么吗","like_count":0,"discussions":[{"author":{"id":1181974,"avatar":"https://static001.geekbang.org/account/avatar/00/12/09/16/1161017c.jpg","nickname":"罗剑锋","note":"","ucode":"95678C988F24AB","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":589454,"discussion_content":"这个应该是没有正确拷贝kubeadm初始化的后的config文件吧，记得把config文件拷贝到kubectl所在的机器上，命令在kubeadm安装后有提示。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1664959300,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"北京","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":358125,"user_name":"alexgreenbar","can_delete":false,"product_type":"c1","uid":1003655,"ip_address":"北京","ucode":"87ED7233E2767C","user_header":"https://static001.geekbang.org/account/avatar/00/0f/50/87/dde718fa.jpg","comment_is_top":false,"comment_ctime":1663924119,"is_pvip":false,"replies":[{"id":130333,"content":"这个不应该吧，也许是pod意外退出了。","user_name":"作者回复","user_name_real":"编辑","uid":1181974,"ctime":1664006922,"ip_address":"北京","comment_id":358125,"utype":1}],"discussion_count":1,"race_medal":0,"score":12,"product_id":100114501,"comment_content":"kubectl run ngx --image=nginx:alpine\n\n安装成功有，尝试运行了nginx，检查了pod，一切正常，然后过了大概3个小时，再次检查了一下，发现nginx pod没有了，这是为啥？\n","like_count":0,"discussions":[{"author":{"id":1181974,"avatar":"https://static001.geekbang.org/account/avatar/00/12/09/16/1161017c.jpg","nickname":"罗剑锋","note":"","ucode":"95678C988F24AB","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":588698,"discussion_content":"这个不应该吧，也许是pod意外退出了。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1664006922,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"北京","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":357396,"user_name":"岁月长","can_delete":false,"product_type":"c1","uid":1297213,"ip_address":"北京","ucode":"CDD7BEC084AC51","user_header":"https://static001.geekbang.org/account/avatar/00/13/cb/3d/b290414d.jpg","comment_is_top":false,"comment_ctime":1663223377,"is_pvip":false,"replies":[{"id":130079,"content":"用describe看看pod的状态，是卡在了那个环节。","user_name":"作者回复","user_name_real":"编辑","uid":1181974,"ctime":1663226701,"ip_address":"北京","comment_id":357396,"utype":1}],"discussion_count":1,"race_medal":0,"score":12,"product_id":100114501,"comment_content":"重启虚拟机之后，再运行  kubectl run ngx --image=nginx:alpine 发现 pod 一直是 pending 状态，不知道大家有没有遇到过这种情况？","like_count":0,"discussions":[{"author":{"id":1181974,"avatar":"https://static001.geekbang.org/account/avatar/00/12/09/16/1161017c.jpg","nickname":"罗剑锋","note":"","ucode":"95678C988F24AB","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":587698,"discussion_content":"用describe看看pod的状态，是卡在了那个环节。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1663226701,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"北京","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":357328,"user_name":"Java-刘新漳","can_delete":false,"product_type":"c1","uid":2203253,"ip_address":"上海","ucode":"28F0BAA103CE6A","user_header":"https://static001.geekbang.org/account/avatar/00/21/9e/75/3ff9e7aa.jpg","comment_is_top":false,"comment_ctime":1663160224,"is_pvip":false,"replies":[{"id":130064,"content":"没有了解过，但这样的大厂商应该对Kubernetes有很多定制，kubeadm可能入不了眼，但最终的结果是一样的。","user_name":"作者回复","user_name_real":"编辑","uid":1181974,"ctime":1663198704,"ip_address":"上海","comment_id":357328,"utype":1}],"discussion_count":1,"race_medal":0,"score":12,"product_id":100114501,"comment_content":"老师，想问一下，像云厂商提供的企业级Kubernetes集群，比如像华为CCE（云容器引擎）是如何搭建的？也是通过kubeadm这种方式搭建的吗？\n","like_count":0,"discussions":[{"author":{"id":1181974,"avatar":"https://static001.geekbang.org/account/avatar/00/12/09/16/1161017c.jpg","nickname":"罗剑锋","note":"","ucode":"95678C988F24AB","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":587646,"discussion_content":"没有了解过，但这样的大厂商应该对Kubernetes有很多定制，kubeadm可能入不了眼，但最终的结果是一样的。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1663198704,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"上海","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":357224,"user_name":"wuyang","can_delete":false,"product_type":"c1","uid":1044517,"ip_address":"北京","ucode":"81000322FF96A7","user_header":"https://static001.geekbang.org/account/avatar/00/0f/f0/25/d3da7ca9.jpg","comment_is_top":false,"comment_ctime":1663078319,"is_pvip":false,"replies":[{"id":130009,"content":"good","user_name":"作者回复","user_name_real":"编辑","uid":1181974,"ctime":1663109746,"ip_address":"北京","comment_id":357224,"utype":1}],"discussion_count":1,"race_medal":0,"score":12,"product_id":100114501,"comment_content":"kubernetes的master和node都已正常运行\nwuyang@master-1:~$ kubectl get node\nNAME       STATUS   ROLES                  AGE     VERSION\nmaster-1   Ready    control-plane,master   6h29m   v1.23.3\nworker-1   Ready    &lt;none&gt;                 6h24m   v1.23.3\n","like_count":0,"discussions":[{"author":{"id":1181974,"avatar":"https://static001.geekbang.org/account/avatar/00/12/09/16/1161017c.jpg","nickname":"罗剑锋","note":"","ucode":"95678C988F24AB","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":587494,"discussion_content":"good","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1663109746,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"北京","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":357001,"user_name":"拾掇拾掇","can_delete":false,"product_type":"c1","uid":1051873,"ip_address":"北京","ucode":"D775F374C2A1D3","user_header":"https://static001.geekbang.org/account/avatar/00/10/0c/e1/f663213e.jpg","comment_is_top":false,"comment_ctime":1662819331,"is_pvip":false,"replies":[{"id":129910,"content":"我也遇到过这种情况，只能把kube-system里的flannel重启了，比较麻烦。","user_name":"作者回复","user_name_real":"编辑","uid":1181974,"ctime":1662868183,"ip_address":"北京","comment_id":357001,"utype":1}],"discussion_count":1,"race_medal":1,"score":12,"product_id":100114501,"comment_content":"各位有没有遇到过，重启了虚拟机之后，网络插件pod就一直失败了，起不来了。。。等了很久也没自己恢复","like_count":0,"discussions":[{"author":{"id":1181974,"avatar":"https://static001.geekbang.org/account/avatar/00/12/09/16/1161017c.jpg","nickname":"罗剑锋","note":"","ucode":"95678C988F24AB","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":587176,"discussion_content":"我也遇到过这种情况，只能把kube-system里的flannel重启了，比较麻烦。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1662868183,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"北京","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":356974,"user_name":"黄马","can_delete":false,"product_type":"c1","uid":1019506,"ip_address":"北京","ucode":"93E391B4678EC2","user_header":"https://static001.geekbang.org/account/avatar/00/0f/8e/72/63c94eee.jpg","comment_is_top":false,"comment_ctime":1662771882,"is_pvip":false,"replies":[{"id":129908,"content":"我在Ubuntu上试验是没问题的，也许CentOS有一些特殊的设置，感谢经验分享。","user_name":"作者回复","user_name_real":"编辑","uid":1181974,"ctime":1662853587,"ip_address":"北京","comment_id":356974,"utype":1}],"discussion_count":2,"race_medal":0,"score":12,"product_id":100114501,"comment_content":"centos 7.9 \n\n即使按照教程修改flannel.yml, 部署nginx，还是报错，如下\n\n&#47;run&#47;flannel&#47;subnet.env: no such file or directory \n\n需要在每个节点都添加\n\nFLANNEL_NETWORK=10.244.0.0&#47;16\nFLANNEL_SUBNET=10.244.0.1&#47;24\nFLANNEL_MTU=1450\nFLANNEL_IPMASQ=true\n\n","like_count":0,"discussions":[{"author":{"id":1181974,"avatar":"https://static001.geekbang.org/account/avatar/00/12/09/16/1161017c.jpg","nickname":"罗剑锋","note":"","ucode":"95678C988F24AB","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":587156,"discussion_content":"我在Ubuntu上试验是没问题的，也许CentOS有一些特殊的设置，感谢经验分享。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1662853587,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"北京","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":1,"child_discussions":[{"author":{"id":3556309,"avatar":"","nickname":"jingtong","note":"","ucode":"03BA5DA52A09C7","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":1181974,"avatar":"https://static001.geekbang.org/account/avatar/00/12/09/16/1161017c.jpg","nickname":"罗剑锋","note":"","ucode":"95678C988F24AB","race_medal":0,"user_type":2,"is_pvip":false},"discussion":{"id":620702,"discussion_content":"刚刚验证了一下，Ubuntu也有这个问题，master节点有/run/flannel/目录，但是里面是空的","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1686463075,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":587156,"ip_address":"湖北","group_id":0},"score":620702,"extra":""}]}]},{"had_liked":false,"id":356716,"user_name":"xmr","can_delete":false,"product_type":"c1","uid":1009622,"ip_address":"北京","ucode":"1BBF165F91F10B","user_header":"https://static001.geekbang.org/account/avatar/00/0f/67/d6/2f5cb85c.jpg","comment_is_top":false,"comment_ctime":1662528014,"is_pvip":false,"replies":[{"id":129832,"content":"能上外网就简单多了，很多操作环节都可以省略。","user_name":"作者回复","user_name_real":"编辑","uid":1181974,"ctime":1662536203,"ip_address":"北京","comment_id":356716,"utype":1}],"discussion_count":1,"race_medal":0,"score":12,"product_id":100114501,"comment_content":"方便上外网的话加google源：\ncurl -s https:&#47;&#47;packages.cloud.google.com&#47;apt&#47;doc&#47;apt-key.gpg | sudo apt-key add -\n\ncat &lt;&lt;EOF | sudo tee &#47;etc&#47;apt&#47;sources.list.d&#47;kubernetes.list\ndeb http:&#47;&#47;apt.kubernetes.io&#47; kubernetes-xenial main\nEOF","like_count":0,"discussions":[{"author":{"id":1181974,"avatar":"https://static001.geekbang.org/account/avatar/00/12/09/16/1161017c.jpg","nickname":"罗剑锋","note":"","ucode":"95678C988F24AB","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":586840,"discussion_content":"能上外网就简单多了，很多操作环节都可以省略。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1662536203,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"北京","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":356303,"user_name":"拾掇拾掇","can_delete":false,"product_type":"c1","uid":1051873,"ip_address":"北京","ucode":"D775F374C2A1D3","user_header":"https://static001.geekbang.org/account/avatar/00/10/0c/e1/f663213e.jpg","comment_is_top":false,"comment_ctime":1662121448,"is_pvip":false,"replies":[{"id":129690,"content":"看看flannel是否工作正常，应该和taint没有关系。","user_name":"作者回复","user_name_real":"编辑","uid":1181974,"ctime":1662169944,"ip_address":"北京","comment_id":356303,"utype":1}],"discussion_count":1,"race_medal":1,"score":13,"product_id":100114501,"comment_content":"master节点一直notready，删了taints还是notready，真的栓Q了\n","like_count":0,"discussions":[{"author":{"id":1181974,"avatar":"https://static001.geekbang.org/account/avatar/00/12/09/16/1161017c.jpg","nickname":"罗剑锋","note":"","ucode":"95678C988F24AB","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":586371,"discussion_content":"看看flannel是否工作正常，应该和taint没有关系。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1662169945,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"北京","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":356295,"user_name":"$侯","can_delete":false,"product_type":"c1","uid":1019939,"ip_address":"北京","ucode":"488B1BD3924E7E","user_header":"https://static001.geekbang.org/account/avatar/00/0f/90/23/5c74e9b7.jpg","comment_is_top":false,"comment_ctime":1662114210,"is_pvip":false,"replies":[{"id":129693,"content":"需要理解Kubernetes的架构，kubelet调用容器运行时来创建容器，因为我们用的是docker，所以就是在docker里运行，Kubernetes只是管理调度容器，不关心是否是docker。","user_name":"作者回复","user_name_real":"编辑","uid":1181974,"ctime":1662170103,"ip_address":"北京","comment_id":356295,"utype":1}],"discussion_count":1,"race_medal":0,"score":13,"product_id":100114501,"comment_content":"老师，kubeadm init 安装好后也可以用docker ps命令看到运行的容器，那这些容器是在docekr中运行的还是在k8s中运行的呢？","like_count":0,"discussions":[{"author":{"id":1181974,"avatar":"https://static001.geekbang.org/account/avatar/00/12/09/16/1161017c.jpg","nickname":"罗剑锋","note":"","ucode":"95678C988F24AB","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":586374,"discussion_content":"需要理解Kubernetes的架构，kubelet调用容器运行时来创建容器，因为我们用的是docker，所以就是在docker里运行，Kubernetes只是管理调度容器，不关心是否是docker。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1662170104,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"北京","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":355959,"user_name":"kobe","can_delete":false,"product_type":"c1","uid":1165831,"ip_address":"北京","ucode":"AB8B599F3D5521","user_header":"https://static001.geekbang.org/account/avatar/00/11/ca/07/22dd76bf.jpg","comment_is_top":false,"comment_ctime":1661868660,"is_pvip":false,"replies":[{"id":129554,"content":"这个应该是kubelet作为静态pod无法启动，健康检查出问题了，重启一下节点试试。 ","user_name":"作者回复","user_name_real":"编辑","uid":1181974,"ctime":1661912380,"ip_address":"北京","comment_id":355959,"utype":1}],"discussion_count":4,"race_medal":0,"score":13,"product_id":100114501,"comment_content":"启动的时候卡在下面这里了，老师帮看下是什么原因呗：\n[wait-control-plane] Waiting for the kubelet to boot up the control plane as static Pods from directory &quot;&#47;etc&#47;kubernetes&#47;manifests&quot;. This can take up to 4m0s\nI0830 21:59:28.227253   16503 round_trippers.go:553] GET https:&#47;&#47;192.168.56.102:6443&#47;healthz?timeout=10s  in 0 milliseconds\nI0830 21:59:28.727893   16503 round_trippers.go:553] GET https:&#47;&#47;192.168.56.102:6443&#47;healthz?timeout=10s  in 0 milliseconds\nI0830 21:59:29.228213   16503 round_trippers.go:553] GET https:&#47;&#47;192.168.56.102:6443&#47;healthz?timeout=10s  in 0 milliseconds\nI0830 21:59:29.728033   16503 round_trippers.go:553] GET https:&#47;&#47;192.168.56.102:6443&#47;healthz?timeout=10s  in 0 milliseconds\nI0830 21:59:30.228033   16503 round_trippers.go:553] GET https:&#47;&#47;192.168.56.102:6443&#47;healthz?timeout=10s  in 0 milliseconds\nI0830 21:59:30.756127   16503 round_trippers.go:553] GET https:&#47;&#47;192.168.56.102:6443&#47;healthz?timeout=10s  in 0 milliseconds\nI0830 21:59:31.229119   16503 round_trippers.go:553] GET https:&#47;&#47;192.168.56.102:6443&#47;healthz?timeout=10s  in 0 milliseconds\nI0830 21:59:31.728430   16503 round_trippers.go:553] GET https:&#47;&#47;192.168.56.102:6443&#47;healthz?timeout=10s  in 0 milliseconds\nI0830 21:59:32.228035   16503 round_trippers.go:553] GET https:&#47;&#47;192.168.56.102:6443&#47;healthz?timeout=10s  in 0 milliseconds\nI0830 21:59:32.728400   16503 round_trippers.go:553] GET https:&#47;&#47;192.168.56.102:6443&#47;healthz?timeout=10s  in 0 milliseconds\nI0830 21:59:33.230932   16503 round_trippers.go:553] GET https:&#47;&#47;192.168.56.102:6443&#47;healthz?timeout=10s  in 0 milliseconds\nI0830 21:59:33.742286   16503 round_trippers.go:553] GET https:&#47;&#47;192.168.56.102:6443&#47;healthz?timeout=10s  in 0 milliseconds\nI0830 21:59:34.230284   16503 round_trippers.go:553] GET https:&#47;&#47;192.168.56.102:6443&#47;healthz?timeout=10s  in 0 milliseconds\nI0830 21:59:38.249748   16503 round_trippers.go:553] GET https:&#47;&#47;192.168.56.102:6443&#47;healthz?timeout=10s  in 0 milliseconds","like_count":0,"discussions":[{"author":{"id":1181974,"avatar":"https://static001.geekbang.org/account/avatar/00/12/09/16/1161017c.jpg","nickname":"罗剑锋","note":"","ucode":"95678C988F24AB","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":585931,"discussion_content":"这个应该是kubelet作为静态pod无法启动，健康检查出问题了，重启一下节点试试。 ","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1661912381,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"北京","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1139878,"avatar":"https://static001.geekbang.org/account/avatar/00/11/64/a6/e5f674a9.jpg","nickname":"mh","note":"","ucode":"9179BBA1792CD2","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":586035,"discussion_content":"我这边的问题是 kubeadm 之前安装的时候少了一个cri--tools导致报cgroup异常。 重新通过yum安装kubeadm后kubelet启动正常，再执行kubeadm init也正常了","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1661942701,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":"广东","group_id":0},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1139878,"avatar":"https://static001.geekbang.org/account/avatar/00/11/64/a6/e5f674a9.jpg","nickname":"mh","note":"","ucode":"9179BBA1792CD2","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":586008,"discussion_content":"我这边也有这个情况，排查发现时kubelet服务没有起来，重启kubelet后发现启动失败，提示:failed to run Kubelet: misconfiguration: kubelet cgroup driver: &#34;cgroupfs&#34; is different from docker cgroup driver: &#34;systemd&#34; , 通过docker info 查看docker信息，对应Driver已经与之前配置是一致的：Storage Driver: overlay2  Logging Driver: json-file  Cgroup Driver: systemd  。 有哪位大神知道改怎么处理？ \n","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1661935163,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":"广东","group_id":0},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1165831,"avatar":"https://static001.geekbang.org/account/avatar/00/11/ca/07/22dd76bf.jpg","nickname":"kobe","note":"","ucode":"AB8B599F3D5521","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":585968,"discussion_content":"我这个是执行kubeadm init的时候出现的 重启也没用 一直这样","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1661921277,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":"浙江","group_id":0},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":355948,"user_name":"kobe","can_delete":false,"product_type":"c1","uid":1165831,"ip_address":"北京","ucode":"AB8B599F3D5521","user_header":"https://static001.geekbang.org/account/avatar/00/11/ca/07/22dd76bf.jpg","comment_is_top":false,"comment_ctime":1661865526,"is_pvip":false,"replies":[{"id":129558,"content":"看docker image的名字是否与YAML 完全一样，另外就是每个节点都要预先下载，有可能pod调度到了没有镜像的节点。","user_name":"作者回复","user_name_real":"编辑","uid":1181974,"ctime":1661912561,"ip_address":"北京","comment_id":355948,"utype":1}],"discussion_count":2,"race_medal":0,"score":13,"product_id":100114501,"comment_content":"老师你好 我这也预先把镜像下载下来了 用docker images也看到了 但是在执行kubeadm init的时候还是会从k8s.gcr.io上去下载镜像 导致启动一直卡住 这个是什么原因啊\n","like_count":0,"discussions":[{"author":{"id":1181974,"avatar":"https://static001.geekbang.org/account/avatar/00/12/09/16/1161017c.jpg","nickname":"罗剑锋","note":"","ucode":"95678C988F24AB","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":585935,"discussion_content":"看docker image的名字是否与YAML 完全一样，另外就是每个节点都要预先下载，有可能pod调度到了没有镜像的节点。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1661912561,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"北京","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1165831,"avatar":"https://static001.geekbang.org/account/avatar/00/11/ca/07/22dd76bf.jpg","nickname":"kobe","note":"","ucode":"AB8B599F3D5521","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":585969,"discussion_content":"我执行init的时候指定了镜像仓库就可以了\n","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1661921321,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":"浙江","group_id":0},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":355768,"user_name":"骑着🚀看银河","can_delete":false,"product_type":"c1","uid":1074734,"ip_address":"上海","ucode":"8706A99A89F0CE","user_header":"https://static001.geekbang.org/account/avatar/00/10/66/2e/527b73c9.jpg","comment_is_top":false,"comment_ctime":1661739610,"is_pvip":false,"replies":[{"id":129475,"content":"如果reset失败可以考虑恢复虚拟机的快照。","user_name":"作者回复","user_name_real":"编辑","uid":1181974,"ctime":1661744005,"ip_address":"上海","comment_id":355768,"utype":1}],"discussion_count":1,"race_medal":0,"score":13,"product_id":100114501,"comment_content":"执行`kubeadm reset` 操作卡在这里不动了\n\nant@ant-vm:~&#47;workspace$ sudo kubeadm reset\n[reset] Reading configuration from the cluster...\n[reset] FYI: You can look at this config file with &#39;kubectl -n kube-system get cm kubeadm-config -o yaml&#39;\n\n","like_count":0,"discussions":[{"author":{"id":1181974,"avatar":"https://static001.geekbang.org/account/avatar/00/12/09/16/1161017c.jpg","nickname":"罗剑锋","note":"","ucode":"95678C988F24AB","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":585645,"discussion_content":"如果reset失败可以考虑恢复虚拟机的快照。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1661744005,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"上海","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":355171,"user_name":"陈四丰","can_delete":false,"product_type":"c1","uid":1610789,"ip_address":"北京","ucode":"A4463BFD52FB4F","user_header":"https://static001.geekbang.org/account/avatar/00/18/94/25/3bf277e5.jpg","comment_is_top":false,"comment_ctime":1661152391,"is_pvip":false,"replies":[{"id":129239,"content":"是不是没有拷贝config文件？","user_name":"作者回复","user_name_real":"编辑","uid":1181974,"ctime":1661176375,"ip_address":"北京","comment_id":355171,"utype":1}],"discussion_count":1,"race_medal":0,"score":13,"product_id":100114501,"comment_content":"请教老师个问题：\n为什么在worker上执行`kubectl get pod`会得到连接服务器错误：\n`The connection to the server localhost:8080 was refused - did you specify the right host or port?`\n是因为worker不具备权限吗？那是不是说在worker上运行这条命令，本身就没有意义？\n","like_count":0,"discussions":[{"author":{"id":1181974,"avatar":"https://static001.geekbang.org/account/avatar/00/12/09/16/1161017c.jpg","nickname":"罗剑锋","note":"","ucode":"95678C988F24AB","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":584874,"discussion_content":"是不是没有拷贝config文件？","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1661176375,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"北京","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":355126,"user_name":"陈四丰","can_delete":false,"product_type":"c1","uid":1610789,"ip_address":"北京","ucode":"A4463BFD52FB4F","user_header":"https://static001.geekbang.org/account/avatar/00/18/94/25/3bf277e5.jpg","comment_is_top":false,"comment_ctime":1661103608,"is_pvip":false,"replies":[{"id":129233,"content":"可以参考一下后面的视频课，对照一下哪些步骤有误。","user_name":"作者回复","user_name_real":"编辑","uid":1181974,"ctime":1661144574,"ip_address":"北京","comment_id":355126,"utype":1}],"discussion_count":1,"race_medal":0,"score":13,"product_id":100114501,"comment_content":"请教：我在安装到worker join的时候出现了问题。\n到了[preflight] Running pre-flight checks 就卡住了。后来用 &quot;--v=2&quot; 命令显示原因出现以下错误。\n命令：\nsudo kubeadm join --v=2 10.0.3.15:6443 --token mrs900.uf2fm5qbv08aqfiy --discovery-token-ca-cert-hash sha256:3fd27a63348669f3ce21746362c4a9031854c9e804a9a480871c0d601c85a584 \n\n错误：\nI0821 19:36:33.694450    3493 token.go:217] [discovery] Failed to request cluster-info, will try again: Get &quot;https:&#47;&#47;10.0.3.15:6443&#47;api&#47;v1&#47;namespaces&#47;kube-public&#47;configmaps&#47;cluster-info?timeout=10s&quot;: dial tcp 10.0.3.15:6443: connect: connection refused\n\n访问被master拒绝了！！！可是master留给我的加入信息没错呀。\nkubeadm join 10.0.3.15:6443 --token mrs900.uf2fm5qbv08aqfiy \\\n\t--discovery-token-ca-cert-hash sha256:3fd27a63348669f3ce21746362c4a9031854c9e804a9a480871c0d601c85a584 \n\n另外，我还注意到一点。这个join给的IP地址是10.0.x.x，而不是192.168.x.x。\n\n卡在这里实在进行不下去了。请老师，同学们帮忙！\n","like_count":0,"discussions":[{"author":{"id":1181974,"avatar":"https://static001.geekbang.org/account/avatar/00/12/09/16/1161017c.jpg","nickname":"罗剑锋","note":"","ucode":"95678C988F24AB","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":584816,"discussion_content":"可以参考一下后面的视频课，对照一下哪些步骤有误。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1661144574,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"北京","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":355027,"user_name":"zahi","can_delete":false,"product_type":"c1","uid":1447887,"ip_address":"北京","ucode":"F64ABEB63C6D1F","user_header":"http://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTIofiaCAziajdQnbvrfpEkpCKVFgO62y6zicamhjF1BAWZSRcCVaTBXLIerLsGeZCic7XS7KOEkTN4fRg/132","comment_is_top":false,"comment_ctime":1660985699,"is_pvip":true,"replies":[{"id":129157,"content":"用kubectl logs看看日志，如果有错误就删除pod重启。","user_name":"作者回复","user_name_real":"编辑","uid":1181974,"ctime":1661040319,"ip_address":"北京","comment_id":355027,"utype":1}],"discussion_count":4,"race_medal":0,"score":13,"product_id":100114501,"comment_content":"kubectl apply -f flannel.yml  之后还是notReady状态， 看了下 flannel 的pod 是正常运行的，describe 也没看出异常。","like_count":0,"discussions":[{"author":{"id":1181974,"avatar":"https://static001.geekbang.org/account/avatar/00/12/09/16/1161017c.jpg","nickname":"罗剑锋","note":"","ucode":"95678C988F24AB","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":584665,"discussion_content":"用kubectl logs看看日志，如果有错误就删除pod重启。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1661040319,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"北京","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1875922,"avatar":"https://static001.geekbang.org/account/avatar/00/1c/9f/d2/b6d8df48.jpg","nickname":"菲茨杰拉德","note":"","ucode":"4EB29359F39862","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":593064,"discussion_content":"我网卡 没有flannel这个都。。啥情况","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1667907580,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":"北京","group_id":0},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1447887,"avatar":"http://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTIofiaCAziajdQnbvrfpEkpCKVFgO62y6zicamhjF1BAWZSRcCVaTBXLIerLsGeZCic7XS7KOEkTN4fRg/132","nickname":"zahi","note":"","ucode":"F64ABEB63C6D1F","race_medal":0,"user_type":1,"is_pvip":true},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":584964,"discussion_content":"\nlog 也没看出来有什么问题， 只有一个waring。\n\nW0823 09:47:40.400230       1 client_config.go:614] Neither --kubeconfig nor --master was specified.  Using the inClusterConfig.  This might not work.\n\n宿主机上也看到了flannel 的虚拟网卡，不过网络地址是 10.10.0.0/32, 这与我配置中 10.10.0.0/16 不一样，不知道是不是这个的问题。\n\n8: flannel.1: &lt;BROADCAST,MULTICAST,UP,LOWER_UP&gt; mtu 1450 qdisc noqueue state UNKNOWN group default\n    link/ether d6:c2:95:c1:5f:3f brd ff:ff:ff:ff:ff:ff\n    inet 10.10.0.0/32 scope global flannel.1\n       valid_lft forever preferred_lft forever\n    inet6 fe80::d4c2:95ff:fec1:5f3f/64 scope link\n       valid_lft forever preferred_lft forever\n","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1661248839,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":"北京","group_id":0},"score":2,"extra":"","child_discussion_number":1,"child_discussions":[{"author":{"id":1875922,"avatar":"https://static001.geekbang.org/account/avatar/00/1c/9f/d2/b6d8df48.jpg","nickname":"菲茨杰拉德","note":"","ucode":"4EB29359F39862","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":1447887,"avatar":"http://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTIofiaCAziajdQnbvrfpEkpCKVFgO62y6zicamhjF1BAWZSRcCVaTBXLIerLsGeZCic7XS7KOEkTN4fRg/132","nickname":"zahi","note":"","ucode":"F64ABEB63C6D1F","race_medal":0,"user_type":1,"is_pvip":true},"discussion":{"id":593063,"discussion_content":"大哥在吗？我也遇到这个问题了。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1667907513,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":584964,"ip_address":"北京","group_id":0},"score":593063,"extra":""}]}]},{"had_liked":false,"id":354970,"user_name":"Breeze","can_delete":false,"product_type":"c1","uid":2962899,"ip_address":"北京","ucode":"8B6711F5B9D112","user_header":"https://static001.geekbang.org/account/avatar/00/2d/35/d3/8de43dd5.jpg","comment_is_top":false,"comment_ctime":1660922048,"is_pvip":false,"replies":[{"id":129124,"content":"看样子是cni网络插件有问题，检查一下flannel的状态，重启试试。","user_name":"作者回复","user_name_real":"编辑","uid":1181974,"ctime":1660956972,"ip_address":"北京","comment_id":354970,"utype":1}],"discussion_count":1,"race_medal":0,"score":13,"product_id":100114501,"comment_content":"执行最后一步：kubectl run ngx --image=nginx:alpine时，pod启动不起来\nWarning  FailedCreatePodSandBox  9s    kubelet  Failed to create pod sandbox: rpc error: code = Unknown desc = [failed to set up sandbox container &quot;d747752b65df694639aad0daed64c1b3c153e0d375b684b91d79c72a3701b536&quot; network for pod &quot;ngx&quot;: networkPlugin cni failed to set up pod &quot;ngx_default&quot; network: open &#47;run&#47;flannel&#47;subnet.env: no such file or directory, failed to clean up sandbox container &quot;d747752b65df694639aad0daed64c1b3c153e0d375b684b91d79c72a3701b536&quot; network for pod &quot;ngx&quot;: networkPlugin cni failed to teardown pod &quot;ngx_default&quot; network: invalid version &quot;&quot;: the version is empty]\n","like_count":0,"discussions":[{"author":{"id":1181974,"avatar":"https://static001.geekbang.org/account/avatar/00/12/09/16/1161017c.jpg","nickname":"罗剑锋","note":"","ucode":"95678C988F24AB","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":584585,"discussion_content":"看样子是cni网络插件有问题，检查一下flannel的状态，重启试试。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1660956972,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"北京","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":354879,"user_name":"扫地僧","can_delete":false,"product_type":"c1","uid":1129952,"ip_address":"上海","ucode":"EEDC2BA2FED1FF","user_header":"https://static001.geekbang.org/account/avatar/00/11/3d/e0/be2f1bf3.jpg","comment_is_top":false,"comment_ctime":1660842775,"is_pvip":false,"replies":[{"id":129104,"content":"看看flannel的pod是否正常，用describe、logs等命令。","user_name":"作者回复","user_name_real":"编辑","uid":1181974,"ctime":1660890703,"ip_address":"上海","comment_id":354879,"utype":1}],"discussion_count":3,"race_medal":0,"score":13,"product_id":100114501,"comment_content":"[root@master ~]# kubectl apply -f flannel.yml\npodsecuritypolicy.policy&#47;psp.flannel.unprivileged created\nclusterrole.rbac.authorization.k8s.io&#47;flannel created\nclusterrolebinding.rbac.authorization.k8s.io&#47;flannel created\nserviceaccount&#47;flannel created\nconfigmap&#47;kube-flannel-cfg created\ndaemonset.apps&#47;kube-flannel-ds created\n执行后，看着都是正常的，再执行[root@master ~]# kubectl get nodes\nNAME     STATUS     ROLES    AGE   VERSION\nmaster   NotReady   master   24m   v1.19.3\n还是NotReady\n","like_count":0,"discussions":[{"author":{"id":1181974,"avatar":"https://static001.geekbang.org/account/avatar/00/12/09/16/1161017c.jpg","nickname":"罗剑锋","note":"","ucode":"95678C988F24AB","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":584520,"discussion_content":"看看flannel的pod是否正常，用describe、logs等命令。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1660890703,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"上海","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1875922,"avatar":"https://static001.geekbang.org/account/avatar/00/1c/9f/d2/b6d8df48.jpg","nickname":"菲茨杰拉德","note":"","ucode":"4EB29359F39862","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":593062,"discussion_content":"pod没创建成功","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1667907432,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":"北京","group_id":0},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1875922,"avatar":"https://static001.geekbang.org/account/avatar/00/1c/9f/d2/b6d8df48.jpg","nickname":"菲茨杰拉德","note":"","ucode":"4EB29359F39862","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":593061,"discussion_content":"我也有遇到这个问题啦。kubectl get pod 没有任何信息，提示No resources found in default namespace.","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1667907370,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":"北京","group_id":0},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":354100,"user_name":"dao","can_delete":false,"product_type":"c1","uid":1087879,"ip_address":"北京","ucode":"4181FB270462CF","user_header":"https://static001.geekbang.org/account/avatar/00/10/99/87/5066026c.jpg","comment_is_top":false,"comment_ctime":1660097182,"is_pvip":false,"replies":[{"id":128795,"content":"great","user_name":"作者回复","user_name_real":"编辑","uid":1181974,"ctime":1660108385,"ip_address":"北京","comment_id":354100,"utype":1}],"discussion_count":1,"race_medal":0,"score":14,"product_id":100114501,"comment_content":"分享一个清华大学镜像 https:&#47;&#47;mirrors.tuna.tsinghua.edu.cn&#47;help&#47;kubernetes&#47;","like_count":0,"discussions":[{"author":{"id":1181974,"avatar":"https://static001.geekbang.org/account/avatar/00/12/09/16/1161017c.jpg","nickname":"罗剑锋","note":"","ucode":"95678C988F24AB","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":583415,"discussion_content":"great","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1660108385,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"北京","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":354062,"user_name":"ArcheanEon","can_delete":false,"product_type":"c1","uid":1989760,"ip_address":"北京","ucode":"02831EE928823C","user_header":"https://static001.geekbang.org/account/avatar/00/1e/5c/80/d90e0151.jpg","comment_is_top":false,"comment_ctime":1660052839,"is_pvip":false,"replies":[{"id":128792,"content":"这个需要在查一下操作系统相关的资料了，在Ubuntu上是可以的。","user_name":"作者回复","user_name_real":"编辑","uid":1181974,"ctime":1660092562,"ip_address":"北京","comment_id":354062,"utype":1}],"discussion_count":3,"race_medal":0,"score":14,"product_id":100114501,"comment_content":"准备工作第三点（修改 iptables 的配置，启用“br_netfilter”模块）\nkernel.core_uses_pid = 1\nnet.ipv4.conf.default.rp_filter = 2\nnet.ipv4.conf.default.accept_source_route = 0\nsysctl: setting key &quot;net.ipv4.conf.all.accept_source_route&quot;: 无效的参数\nnet.ipv4.conf.default.promote_secondaries = 1\nsysctl: setting key &quot;net.ipv4.conf.all.promote_secondaries&quot;: 无效的参数\nnet.ipv4.ping_group_range = 0 2147483647\nnet.core.default_qdisc = fq_codel\n","like_count":0,"discussions":[{"author":{"id":1181974,"avatar":"https://static001.geekbang.org/account/avatar/00/12/09/16/1161017c.jpg","nickname":"罗剑锋","note":"","ucode":"95678C988F24AB","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":583388,"discussion_content":"这个需要在查一下操作系统相关的资料了，在Ubuntu上是可以的。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1660092562,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"北京","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1646052,"avatar":"https://static001.geekbang.org/account/avatar/00/19/1d/e4/975bd580.jpg","nickname":"灯芯草爱学习","note":"","ucode":"D37530955CF919","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":589674,"discussion_content":"借楼，看了一下最后总结视频里也有的，不过是英文，所以应该没啥问题","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1665227401,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":"上海","group_id":0},"score":2,"extra":"","child_discussion_number":1,"child_discussions":[{"author":{"id":1989760,"avatar":"https://static001.geekbang.org/account/avatar/00/1e/5c/80/d90e0151.jpg","nickname":"ArcheanEon","note":"","ucode":"02831EE928823C","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":1646052,"avatar":"https://static001.geekbang.org/account/avatar/00/19/1d/e4/975bd580.jpg","nickname":"灯芯草爱学习","note":"","ucode":"D37530955CF919","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":593091,"discussion_content":"是的，只是提示😂","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1667952859,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":589674,"ip_address":"上海","group_id":0},"score":593091,"extra":""}]}]},{"had_liked":false,"id":353819,"user_name":"DN","can_delete":false,"product_type":"c1","uid":1620299,"ip_address":"北京","ucode":"74BC2FB01FB89E","user_header":"https://static001.geekbang.org/account/avatar/00/18/b9/4b/2376a469.jpg","comment_is_top":false,"comment_ctime":1659838674,"is_pvip":false,"replies":[{"id":128634,"content":"应该是没有bash吧，用sh。","user_name":"作者回复","user_name_real":"编辑","uid":1181974,"ctime":1659872825,"ip_address":"北京","comment_id":353819,"utype":1}],"discussion_count":1,"race_medal":0,"score":14,"product_id":100114501,"comment_content":"想请教一下老师，在master上 kubectl exec -it nginx-deployment-85658cc69f-l68tx -- &#47;bin&#47;bash 报错connect: connection refused， 但其他的命令 apply describe等都正常，有了解原因的吗","like_count":0,"discussions":[{"author":{"id":1181974,"avatar":"https://static001.geekbang.org/account/avatar/00/12/09/16/1161017c.jpg","nickname":"罗剑锋","note":"","ucode":"95678C988F24AB","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":583005,"discussion_content":"应该是没有bash吧，用sh。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1659872825,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"北京","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":353785,"user_name":"lesserror","can_delete":false,"product_type":"c1","uid":1351076,"ip_address":"北京","ucode":"25A54D1165FCF6","user_header":"https://static001.geekbang.org/account/avatar/00/14/9d/a4/e481ae48.jpg","comment_is_top":false,"comment_ctime":1659777939,"is_pvip":false,"replies":[{"id":128630,"content":"在用户目录下有一个隐藏目录.kube，里面是kubectl的配置文件，先把里面的config 做个备份，然后把kubeadm生成的config拷贝过来就行了。","user_name":"作者回复","user_name_real":"编辑","uid":1181974,"ctime":1659854863,"ip_address":"北京","comment_id":353785,"utype":1}],"discussion_count":2,"race_medal":0,"score":14,"product_id":100114501,"comment_content":"老师，现在遇到一个问题是，之前不是用minikube的时候装过kubectl吗？\n\n这篇课程中又装了一次，现在用 执行命令： kubectl version --short\n\n都会出现这个报这个错误：error: cluster &quot;minikube&quot; does not exist 。\n\n你在评论区说：kubectl的config文件就得做个切换了。  我是要做这个切换吗？ 怎么切换呢？","like_count":0,"discussions":[{"author":{"id":1181974,"avatar":"https://static001.geekbang.org/account/avatar/00/12/09/16/1161017c.jpg","nickname":"罗剑锋","note":"","ucode":"95678C988F24AB","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":582968,"discussion_content":"在用户目录下有一个隐藏目录.kube，里面是kubectl的配置文件，先把里面的config 做个备份，然后把kubeadm生成的config拷贝过来就行了。","likes_number":1,"is_delete":false,"is_hidden":false,"ctime":1659854864,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"北京","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":1,"child_discussions":[{"author":{"id":1351076,"avatar":"https://static001.geekbang.org/account/avatar/00/14/9d/a4/e481ae48.jpg","nickname":"lesserror","note":"","ucode":"25A54D1165FCF6","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":1181974,"avatar":"https://static001.geekbang.org/account/avatar/00/12/09/16/1161017c.jpg","nickname":"罗剑锋","note":"","ucode":"95678C988F24AB","race_medal":0,"user_type":2,"is_pvip":false},"discussion":{"id":583057,"discussion_content":"好，我好像是按照课程的操作步骤来的。今天再试试看。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1659888340,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":582968,"ip_address":"广东","group_id":0},"score":583057,"extra":""}]}]},{"had_liked":false,"id":353343,"user_name":"yhtyht308","can_delete":false,"product_type":"c1","uid":1230354,"ip_address":"北京","ucode":"9A054290B8B284","user_header":"https://thirdwx.qlogo.cn/mmopen/vi_32/dotGbXAlAZg0bhCq4P96A40mdyavzR33jSqIHk8xLlic4B5PYNDIP5MEa1Fk9yxzdz9scHUM7IUNR71nVZNoV7Q/132","comment_is_top":false,"comment_ctime":1659368397,"is_pvip":false,"replies":[{"id":128462,"content":"是不是worker节点上没安装kubectl等其他组件？","user_name":"作者回复","user_name_real":"编辑","uid":1181974,"ctime":1659405745,"ip_address":"北京","comment_id":353343,"utype":1}],"discussion_count":4,"race_medal":0,"score":14,"product_id":100114501,"comment_content":"安装worker节点，执行\nsudo \\\nkubeadm join 192.168.10.210:6443 --token tv9mkx.tw7it9vphe158e74 \\\n  --discovery-token-ca-cert-hash sha256:e8721b8630d5b562e23c010c70559a6d3084f629abad6a2920e87855f8fb96f3后，\nkubectl get node显示：“The connection to the server localhost:8080 was refused ”","like_count":0,"discussions":[{"author":{"id":1181974,"avatar":"https://static001.geekbang.org/account/avatar/00/12/09/16/1161017c.jpg","nickname":"罗剑锋","note":"","ucode":"95678C988F24AB","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":582350,"discussion_content":"是不是worker节点上没安装kubectl等其他组件？","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1659405745,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"北京","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1230354,"avatar":"https://thirdwx.qlogo.cn/mmopen/vi_32/dotGbXAlAZg0bhCq4P96A40mdyavzR33jSqIHk8xLlic4B5PYNDIP5MEa1Fk9yxzdz9scHUM7IUNR71nVZNoV7Q/132","nickname":"yhtyht308","note":"","ucode":"9A054290B8B284","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":582420,"discussion_content":"手动把master的admin.conf复制并覆盖worker节点上.kube/config，并更改文件权限就OK了。应该在kubeadm join时会自动生成的，但试了几次都不会，不知是不是因为使用的用户不是&#39;root&#39;的原因？","likes_number":1,"is_delete":false,"is_hidden":false,"ctime":1659430197,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":"广东","group_id":0},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1989760,"avatar":"https://static001.geekbang.org/account/avatar/00/1e/5c/80/d90e0151.jpg","nickname":"ArcheanEon","note":"","ucode":"02831EE928823C","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":583803,"discussion_content":"官方文档有提示\nscp root@&lt;control-plane-host&gt;:/etc/kubernetes/admin.conf .\nkubectl --kubeconfig ./admin.conf get nodes\n觉得麻烦可以再配置下\necho &#34;export KUBECONFIG=/etc/kubernetes/admin.conf&#34; &gt;&gt; ~/.bash_profile\nsource ~/.bash_profile","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1660393038,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":"上海","group_id":0},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":2898675,"avatar":"https://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTJo05FofKFWYN3joX4OyCfVrU2kK7xvKdZ4Ho7bof893fE0jXk1OcB5sKLk4C1SviaNlibAiaCtp8aww/132","nickname":"努力学习不准懈怠","note":"","ucode":"60D2C77230655F","race_medal":0,"user_type":1,"is_pvip":true},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":582355,"discussion_content":"这个是没有创建.kube文件导致的","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1659406881,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":"安徽","group_id":0},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":353312,"user_name":"romance","can_delete":false,"product_type":"c1","uid":1029768,"ip_address":"北京","ucode":"393DC641CCE86E","user_header":"https://static001.geekbang.org/account/avatar/00/0f/b6/88/e8deccbc.jpg","comment_is_top":false,"comment_ctime":1659345994,"is_pvip":false,"replies":[{"id":128458,"content":"没问题，可以的。","user_name":"作者回复","user_name_real":"编辑","uid":1181974,"ctime":1659405470,"ip_address":"北京","comment_id":353312,"utype":1}],"discussion_count":2,"race_medal":0,"score":14,"product_id":100114501,"comment_content":"老师，我实验环境直接把master节点当作console用，就不需要再额外做什么配置了是吧？","like_count":0,"discussions":[{"author":{"id":1181974,"avatar":"https://static001.geekbang.org/account/avatar/00/12/09/16/1161017c.jpg","nickname":"罗剑锋","note":"","ucode":"95678C988F24AB","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":582346,"discussion_content":"没问题，可以的。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1659405470,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"北京","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1875922,"avatar":"https://static001.geekbang.org/account/avatar/00/1c/9f/d2/b6d8df48.jpg","nickname":"菲茨杰拉德","note":"","ucode":"4EB29359F39862","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":594200,"discussion_content":"master 不能启动pod吧，有污点。需要改下配置吧好像","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1668865294,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":"北京","group_id":0},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":353168,"user_name":"潜光隐耀","can_delete":false,"product_type":"c1","uid":1809457,"ip_address":"北京","ucode":"8A2FDDEFCB1863","user_header":"https://static001.geekbang.org/account/avatar/00/1b/9c/31/e4677275.jpg","comment_is_top":false,"comment_ctime":1659230675,"is_pvip":false,"replies":[{"id":128407,"content":"我想暂时应该不会，对于我们普通Kubernetes用户来说，下层的runtime是什么不应该关心，用起来都一样。","user_name":"作者回复","user_name_real":"编辑","uid":1181974,"ctime":1659270498,"ip_address":"北京","comment_id":353168,"utype":1}],"discussion_count":1,"race_medal":0,"score":14,"product_id":100114501,"comment_content":"请问会加餐一个使用containerd的章节吗？","like_count":0,"discussions":[{"author":{"id":1181974,"avatar":"https://static001.geekbang.org/account/avatar/00/12/09/16/1161017c.jpg","nickname":"罗剑锋","note":"","ucode":"95678C988F24AB","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":582159,"discussion_content":"我想暂时应该不会，对于我们普通Kubernetes用户来说，下层的runtime是什么不应该关心，用起来都一样。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1659270498,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"北京","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":353155,"user_name":"vapour","can_delete":false,"product_type":"c1","uid":2067353,"ip_address":"北京","ucode":"9972E95E64ACA4","user_header":"https://thirdwx.qlogo.cn/mmopen/vi_32/4W98d4DBz5DnDZG4ib2KZzj82ibB1zuAeRMcA4e5iaq5BXkW7HU6KHiaewOypkmbTUItP5mopooEcr6fyXEDwIVHKg/132","comment_is_top":false,"comment_ctime":1659196026,"is_pvip":false,"replies":[{"id":128406,"content":"当然，它只是一个逻辑概念。","user_name":"作者回复","user_name_real":"编辑","uid":1181974,"ctime":1659270447,"ip_address":"北京","comment_id":353155,"utype":1}],"discussion_count":1,"race_medal":0,"score":14,"product_id":100114501,"comment_content":"Console 节点是否不是必须的呢？直接使用master节点也可以吧","like_count":0,"discussions":[{"author":{"id":1181974,"avatar":"https://static001.geekbang.org/account/avatar/00/12/09/16/1161017c.jpg","nickname":"罗剑锋","note":"","ucode":"95678C988F24AB","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":582158,"discussion_content":"当然，它只是一个逻辑概念。","likes_number":1,"is_delete":false,"is_hidden":false,"ctime":1659270447,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"北京","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":353091,"user_name":"romance","can_delete":false,"product_type":"c1","uid":1029768,"ip_address":"陕西","ucode":"393DC641CCE86E","user_header":"https://static001.geekbang.org/account/avatar/00/0f/b6/88/e8deccbc.jpg","comment_is_top":false,"comment_ctime":1659154444,"is_pvip":false,"replies":[{"id":128396,"content":"像是文件系统的问题，给不出具体的解决方案，只能网上搜索看看了。","user_name":"作者回复","user_name_real":"编辑","uid":1181974,"ctime":1659174460,"ip_address":"陕西","comment_id":353091,"utype":1}],"discussion_count":1,"race_medal":0,"score":14,"product_id":100114501,"comment_content":"老师，我 kubeadm init 成功后，系统重启就提示 &#47;dev&#47;sda3:clean, XXX files, XXX blocks了，一直无法重启，不知道什么原因","like_count":0,"discussions":[{"author":{"id":1181974,"avatar":"https://static001.geekbang.org/account/avatar/00/12/09/16/1161017c.jpg","nickname":"罗剑锋","note":"","ucode":"95678C988F24AB","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":582064,"discussion_content":"像是文件系统的问题，给不出具体的解决方案，只能网上搜索看看了。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1659174460,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"陕西","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":353014,"user_name":"努力学习不准懈怠","can_delete":false,"product_type":"c1","uid":2898675,"ip_address":"北京","ucode":"60D2C77230655F","user_header":"https://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTJo05FofKFWYN3joX4OyCfVrU2kK7xvKdZ4Ho7bof893fE0jXk1OcB5sKLk4C1SviaNlibAiaCtp8aww/132","comment_is_top":false,"comment_ctime":1659079110,"is_pvip":true,"replies":[{"id":128362,"content":"要拷贝config文件到当前的.kube目录下才行。","user_name":"作者回复","user_name_real":"编辑","uid":1181974,"ctime":1659081931,"ip_address":"北京","comment_id":353014,"utype":1}],"discussion_count":3,"race_medal":0,"score":14,"product_id":100114501,"comment_content":"kubeadm init 成功后 kubectl get node 报错error: no server found for cluster &quot;minikube&quot;\n","like_count":0,"discussions":[{"author":{"id":1181974,"avatar":"https://static001.geekbang.org/account/avatar/00/12/09/16/1161017c.jpg","nickname":"罗剑锋","note":"","ucode":"95678C988F24AB","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":581950,"discussion_content":"要拷贝config文件到当前的.kube目录下才行。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1659081931,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"北京","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":1,"child_discussions":[{"author":{"id":2988749,"avatar":"https://thirdwx.qlogo.cn/mmopen/vi_32/1iaEzwaAJCf7Jk0uMia0g5Jh6NypbSicjK5zn6FH2rd2w3UbO9Qia7V1pMXEkpXQjj0CMnDJ3S5Q9YibWnyficD6akXA/132","nickname":"Ivan","note":"","ucode":"7A40D8B47717CB","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":1181974,"avatar":"https://static001.geekbang.org/account/avatar/00/12/09/16/1161017c.jpg","nickname":"罗剑锋","note":"","ucode":"95678C988F24AB","race_medal":0,"user_type":2,"is_pvip":false},"discussion":{"id":583821,"discussion_content":"是master节点拷贝嘛","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1660405099,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":581950,"ip_address":"广东","group_id":0},"score":583821,"extra":""}]},{"author":{"id":2775529,"avatar":"","nickname":"Geek_c58d04","note":"","ucode":"AE0F3DCD5F7C1C","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":598890,"discussion_content":"我出现这个问题的原因是，前面文章中配置了alias kubectl=&#34;minikube kubectl --&#34;😭😭😭\u0000，导致执行是在minikube的环境中执行的，改为/usr/bin/kubectl get node即可","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1673187229,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":"北京","group_id":0},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":353012,"user_name":"努力学习不准懈怠","can_delete":false,"product_type":"c1","uid":2898675,"ip_address":"陕西","ucode":"60D2C77230655F","user_header":"https://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTJo05FofKFWYN3joX4OyCfVrU2kK7xvKdZ4Ho7bof893fE0jXk1OcB5sKLk4C1SviaNlibAiaCtp8aww/132","comment_is_top":false,"comment_ctime":1659076878,"is_pvip":true,"replies":[{"id":128370,"content":"确认操作系统版本，准备工作都做齐了，可能还是哪个步骤没做好。","user_name":"作者回复","user_name_real":"编辑","uid":1181974,"ctime":1659098618,"ip_address":"陕西","comment_id":353012,"utype":1}],"discussion_count":4,"race_medal":0,"score":15,"product_id":100114501,"comment_content":"安装失败了，报错信息如下，应该怎么解决呢\nUnfortunately, an error has occurred:\n\t\ttimed out waiting for the condition\n\n\tThis error is likely caused by:\n\t\t- The kubelet is not running\n\t\t- The kubelet is unhealthy due to a misconfiguration of the node in some way (required cgroups disabled)\n\n\tIf you are on a systemd-powered system, you can try to troubleshoot the error with the following commands:\n\t\t- &#39;systemctl status kubelet&#39;\n\t\t- &#39;journalctl -xeu kubelet&#39;\n\n\tAdditionally, a control plane component may have crashed or exited when started by the container runtime.\n\tTo troubleshoot, list all containers using your preferred container runtimes CLI.\n\n\tHere is one example how you may list all Kubernetes containers running in docker:\n\t\t- &#39;docker ps -a | grep kube | grep -v pause&#39;\n\t\tOnce you have found the failing container, you can inspect its logs with:\n\t\t- &#39;docker logs CONTAINERID&#39;\n\n","like_count":0,"discussions":[{"author":{"id":1181974,"avatar":"https://static001.geekbang.org/account/avatar/00/12/09/16/1161017c.jpg","nickname":"罗剑锋","note":"","ucode":"95678C988F24AB","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":581984,"discussion_content":"确认操作系统版本，准备工作都做齐了，可能还是哪个步骤没做好。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1659098618,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"陕西","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1009622,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/67/d6/2f5cb85c.jpg","nickname":"xmr","note":"","ucode":"1BBF165F91F10B","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":586830,"discussion_content":"--apiserver-advertise-address要改为master主机的ip","likes_number":1,"is_delete":false,"is_hidden":false,"ctime":1662533203,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":"广东","group_id":0},"score":2,"extra":"","child_discussion_number":1,"child_discussions":[{"author":{"id":2902096,"avatar":"https://static001.geekbang.org/account/avatar/00/2c/48/50/d44bc924.jpg","nickname":"WalkRun","note":"","ucode":"24CBA276EC1513","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":1009622,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/67/d6/2f5cb85c.jpg","nickname":"xmr","note":"","ucode":"1BBF165F91F10B","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":586856,"discussion_content":"研究了两天  果然改成master主机的ip就好了  网络架构还是没搞清楚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1662541532,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":586830,"ip_address":"江苏","group_id":0},"score":586856,"extra":""}]},{"author":{"id":1849608,"avatar":"https://static001.geekbang.org/account/avatar/00/1c/39/08/8b765174.jpg","nickname":"王浩","note":"","ucode":"CB8AEE94284882","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":583903,"discussion_content":"我也遇到过相同的警告，因为--apiserver-advertise-address写错了，照抄了课件里的，reset后重新init就好了","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1660480530,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":"美国","group_id":0},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":372562,"user_name":"恰饭哒","can_delete":false,"product_type":"c1","uid":1014023,"ip_address":"上海","ucode":"0395069A050057","user_header":"https://static001.geekbang.org/account/avatar/00/0f/79/07/2f418316.jpg","comment_is_top":false,"comment_ctime":1681285698,"is_pvip":false,"replies":null,"discussion_count":0,"race_medal":0,"score":15,"product_id":100114501,"comment_content":"&quot;https:&#47;&#47;192.168.1.97:6443&#47;apis&#47;coordination.k8s.io&#47;v1&#47;na...nnection refused\nApr 12 15:45:17 kube-master kubelet[15018]: I0412 15:45:17.245994   15018 kubelet_node_status.go:70] &quot;Attempting to register node&quot; node=&quot;kube-master&quot;\nApr 12 15:45:17 kube-master kubelet[15018]: E0412 15:45:17.246176   15018 kubelet_node_status.go:92] &quot;Unable to register node with API server&quot; err=&quot;Post \\&quot;https:&#47;&#47;192.168.1.97:6443&#47;api&#47;v1&#47;nodes\\&quot;: dial tcp 192....de=&quot;kube-master&quot;\nApr 12 15:45:20 kube-master kubelet[15018]: E0412 15:45:20.916760   15018 event.go:276] Unable to write event: &#39;&amp;v1.Event{TypeMeta:v1.TypeMeta{Kind:&quot;&quot;, APIVersion:&quot;&quot;}, ObjectMeta:v1.ObjectMeta{Name:&quot;kube-master..., CreationTimest\nApr 12 15:45:21 kube-master kubelet[15018]: E0412 15:45:21.437398   15018 eviction_manager.go:261] &quot;Eviction manager: failed to get summary stats&quot; err=&quot;failed to get node info: node \\&quot;kube-master\\&quot; not found&quot;\nApr 12 15:45:24 kube-master kubelet[15018]: E0412 15:45:24.041900   15018 controller.go:146] failed to ensure lease exists, will retry in 7s, error: Get &quot;https:&#47;&#47;192.168.1.97:6443&#47;apis&#47;coordination.k8s.io&#47;v1&#47;na...nnection refused\nApr 12 15:45:24 kube-master kubelet[15018]: I0412 15:45:24.325129   15018 kubelet_node_status.go:70] &quot;Attempting to register node&quot; node=&quot;kube-master&quot;\nApr 12 15:45:24 kube-master kubelet[15018]: E0412 15:45:24.325739   15018 kubelet_node_status.go:92] &quot;Unable to register node with API server&quot; err=&quot;Post \\&quot;https:&#47;&#47;192.168.1.97:6443&#47;api&#47;v1&#47;nodes\\&quot;: dial tcp 192....de=&quot;kube-master&quot;\nHint: Some lines were ellipsized, use -l to show in full.","like_count":0},{"had_liked":false,"id":372561,"user_name":"恰饭哒","can_delete":false,"product_type":"c1","uid":1014023,"ip_address":"上海","ucode":"0395069A050057","user_header":"https://static001.geekbang.org/account/avatar/00/0f/79/07/2f418316.jpg","comment_is_top":false,"comment_ctime":1681285691,"is_pvip":false,"replies":null,"discussion_count":0,"race_medal":0,"score":15,"product_id":100114501,"comment_content":"\nApr 12 15:45:13 kube-master kubelet[15018]: W0412 15:45:13.145190   15018 reflector.go:424] vendor&#47;k8s.io&#47;client-go&#47;informers&#47;factory.go:150: failed to list *v1.Node: Get &quot;https:&#47;&#47;192.168.1.97:6443&#47;api&#47;v1&#47;nodes...nnection refused\nApr 12 15:45:13 kube-master kubelet[15018]: E0412 15:45:13.145251   15018 reflector.go:140] vendor&#47;k8s.io&#47;client-go&#47;informers&#47;factory.go:150: Failed to watch *v1.Node: failed to list *v1.Node: Get &quot;https:&#47;&#47;192.168.1.97:6443&#47;ap...\nApr 12 15:45:17 kube-master kubelet[15018]: E0412 15:45:17.007103   15018 controller.go:146] failed to ensure lease exists, will retry in 7s, error: Get &quot;https:&#47;&#47;192.168.1.97:6443&#47;apis&#47;coordination.k8s.io&#47;v1&#47;na...nnection refused\nApr 12 15:45:17 kube-master kubelet[15018]: I0412 15:45:17.245994   15018 kubelet_node_status.go:70] &quot;Attempting to register node&quot; node=&quot;kube-master&quot;\nApr 12 15:45:17 kube-master kubelet[15018]: E0412 15:45:17.246176   15018 kubelet_node_status.go:92] &quot;Unable to register node with API server&quot; err=&quot;Post ","like_count":0},{"had_liked":false,"id":372560,"user_name":"恰饭哒","can_delete":false,"product_type":"c1","uid":1014023,"ip_address":"上海","ucode":"0395069A050057","user_header":"https://static001.geekbang.org/account/avatar/00/0f/79/07/2f418316.jpg","comment_is_top":false,"comment_ctime":1681285670,"is_pvip":false,"replies":null,"discussion_count":0,"race_medal":0,"score":15,"product_id":100114501,"comment_content":"[root@kube-master ~]# systemctl status kubelet\n● kubelet.service - kubelet: The Kubernetes Node Agent\n   Loaded: loaded (&#47;usr&#47;lib&#47;systemd&#47;system&#47;kubelet.service; enabled; vendor preset: disabled)\n  Drop-In: &#47;usr&#47;lib&#47;systemd&#47;system&#47;kubelet.service.d\n           └─10-kubeadm.conf\n   Active: active (running) since Wed 2023-04-12 15:41:41 CST; 3min 43s ago\n     Docs: https:&#47;&#47;kubernetes.io&#47;docs&#47;\n Main PID: 15018 (kubelet)\n    Tasks: 10\n   Memory: 35.9M\n   CGroup: &#47;system.slice&#47;kubelet.service\n           └─15018 &#47;usr&#47;bin&#47;kubelet --bootstrap-kubeconfig=&#47;etc&#47;kubernetes&#47;bootstrap-kubelet.conf --kubeconfig=&#47;etc&#47;kubernetes&#47;kubelet.conf --config=&#47;var&#47;lib&#47;kubelet&#47;config.yaml --container-runtime-endpoint=unix:&#47;&#47;&#47;var&#47;run&#47;con...","like_count":0}]}