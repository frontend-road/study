{"id":8851,"title":"43 | Apollo Client和Spring Boot集成(Lab05)","content":"无","comments":[{"had_liked":false,"id":75705,"user_name":"愤怒的小猥琐","can_delete":false,"product_type":"c3","uid":1451780,"ip_address":"","ucode":"E3BB1B0542D490","user_header":"http://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTJv3HPde36ll9u5EpEIJyR9jMXE0K7pcuxOlf4HUcbs0po9nkicR0mbXlF1Vdoytj1vxSRCZJGOH7Q/132","comment_is_top":false,"comment_ctime":1552453301,"is_pvip":false,"replies":[{"id":27655,"content":"关于热更新，其实这个是和具体组件相关的，简单讲就是你使用的组件要支持热部署～组件能感知配置的变化并自动重新加载自身，这个能力是和组件自身相关的，和Spring Boot或者Apollo本身没有关系，Apollo客户端只是支持动态变更送达和通知，它不负责（也做不到）动态重启组件。比方说某个数据库驱动支持连接池参数调整，那么这个调整是启动时一次性的，还是可以动态热更新的？就要看这个驱动有没有实现动态监控配置变更，且当变更发生时能否热重启自身。关于Spring Boot + Apollo实现热部署的用例，可以参考：https:&#47;&#47;github.com&#47;ctripcorp&#47;apollo-use-cases","user_name":"作者回复","user_name_real":"杨波","uid":1030344,"ctime":1552482214,"ip_address":"","comment_id":75705,"utype":1}],"discussion_count":1,"race_medal":0,"score":2,"product_id":100007001,"comment_content":"波波老师,springboot项目配置重新发布是不是需要重启呢?还是说可以热更新呢?","like_count":2,"discussions":[{"author":{"id":1030344,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/b8/c8/c94d38a7.jpg","nickname":"杨波","note":"","ucode":"FA3418BB703BCA","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":442990,"discussion_content":"关于热更新，其实这个是和具体组件相关的，简单讲就是你使用的组件要支持热部署～组件能感知配置的变化并自动重新加载自身，这个能力是和组件自身相关的，和Spring Boot或者Apollo本身没有关系，Apollo客户端只是支持动态变更送达和通知，它不负责（也做不到）动态重启组件。比方说某个数据库驱动支持连接池参数调整，那么这个调整是启动时一次性的，还是可以动态热更新的？就要看这个驱动有没有实现动态监控配置变更，且当变更发生时能否热重启自身。关于Spring Boot + Apollo实现热部署的用例，可以参考：https://github.com/ctripcorp/apollo-use-cases","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1552482214,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":50032,"user_name":"王盛武","can_delete":false,"product_type":"c3","uid":1182516,"ip_address":"","ucode":"DE7EF246D3DCE8","user_header":"https://static001.geekbang.org/account/avatar/00/12/0b/34/f41d73a4.jpg","comment_is_top":false,"comment_ctime":1544845223,"is_pvip":false,"replies":[{"id":18449,"content":"有refreshAll，具体请参考spring文档https:&#47;&#47;cloud.spring.io&#47;spring-cloud-static&#47;spring-cloud.html#_refresh_scope，另外可考虑直接用apollo client，或监听apollo事件，更灵活","user_name":"作者回复","user_name_real":"杨波","uid":1030344,"ctime":1545137005,"ip_address":"","comment_id":50032,"utype":1}],"discussion_count":1,"race_medal":0,"score":2,"product_id":100007001,"comment_content":"第43讲：Apollo Client和Spring Boot集成(Lab05)\n这讲的是redisConfig\n在@ApolloConfigChangeListener里\nrefreshScope.refresh(bean) ，这个只是筛选单个bean哦；\n如果有多个bean呢？  比如redis,  XX业务参数，访问第三方SDK参数；\n是不是在监听里每个bean都要写一行\nrefreshScope.refresh(redisBean)\nrefreshScope.refresh(XX业务参数Bean)\nrefreshScope.refresh(第三方SDK参数Bean)\n有没有个 refreshScope.refreshAll()?","like_count":2,"discussions":[{"author":{"id":1030344,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/b8/c8/c94d38a7.jpg","nickname":"杨波","note":"","ucode":"FA3418BB703BCA","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":432851,"discussion_content":"有refreshAll，具体请参考spring文档https://cloud.spring.io/spring-cloud-static/spring-cloud.html#_refresh_scope，另外可考虑直接用apollo client，或监听apollo事件，更灵活","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1545137005,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":58437,"user_name":"三三","can_delete":false,"product_type":"c3","uid":1054201,"ip_address":"","ucode":"4A76933C29BDA1","user_header":"https://static001.geekbang.org/account/avatar/00/10/15/f9/0b14785a.jpg","comment_is_top":false,"comment_ctime":1547083562,"is_pvip":false,"replies":[{"id":21166,"content":"你好，其实apollo集成spring boot已经封装很方便了，可以进一步看apollo官方文档～apollo客户端使用指南，另外github.com&#47;ctripcorp&#47;apollo-use-case下有使用样例可参考。如还有疑问，可微信（bulldog2015）加群交流。","user_name":"作者回复","user_name_real":"杨波","uid":1030344,"ctime":1547126816,"ip_address":"","comment_id":58437,"utype":1}],"discussion_count":0,"race_medal":0,"score":2,"product_id":100007001,"comment_content":"老师，感觉这个讲的不是很详细，真正在项目中使用的时候还是不知道怎么用","like_count":1},{"had_liked":false,"id":200207,"user_name":"BEN","can_delete":false,"product_type":"c3","uid":1274111,"ip_address":"","ucode":"7154F0B5FE4944","user_header":"https://static001.geekbang.org/account/avatar/00/13/70/ff/a255b4b3.jpg","comment_is_top":false,"comment_ctime":1585557908,"is_pvip":false,"replies":[{"id":75429,"content":"redis.cache.enabled这个配置是用来控制是否开启RefreshScope动态配置更新的，它本身的值修改后需要重启才生效。","user_name":"作者回复","user_name_real":"杨波","uid":1030344,"ctime":1585838920,"ip_address":"","comment_id":200207,"utype":1}],"discussion_count":1,"race_medal":0,"score":2,"product_id":100007001,"comment_content":"老师，请问配置了redis.cache.enabled要重启应用而后面几个配置却不用？","like_count":0,"discussions":[{"author":{"id":1030344,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/b8/c8/c94d38a7.jpg","nickname":"杨波","note":"","ucode":"FA3418BB703BCA","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":489960,"discussion_content":"redis.cache.enabled这个配置是用来控制是否开启RefreshScope动态配置更新的，它本身的值修改后需要重启才生效。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1585838920,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":42763,"user_name":"Eric","can_delete":false,"product_type":"c3","uid":1053498,"ip_address":"","ucode":"59752A51A382A6","user_header":"https://static001.geekbang.org/account/avatar/00/10/13/3a/b0454322.jpg","comment_is_top":false,"comment_ctime":1543038125,"is_pvip":false,"replies":[{"id":15525,"content":"apollo支持配置实时更新，但你的应用获取更新后的逻辑一般是需要定制的，比如reload，具体怎么做，携程apollo github站点上有样例可参考https:&#47;&#47;github.com&#47;ctripcorp&#47;apollo-use-cases","user_name":"作者回复","user_name_real":"杨波","uid":1030344,"ctime":1543236593,"ip_address":"","comment_id":42763,"utype":1}],"discussion_count":1,"race_medal":0,"score":2,"product_id":100007001,"comment_content":"老师，我想问一下，配置管理的key 如果是针对资源的设置，比如线程池大小，超时设置，这类配置 生产实践的时候，被拉取后也会动态的改变么？不需要重启服务node？如果可以的话 能简单说说是如何做到的么？","like_count":0,"discussions":[{"author":{"id":1030344,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/b8/c8/c94d38a7.jpg","nickname":"杨波","note":"","ucode":"FA3418BB703BCA","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":430188,"discussion_content":"apollo支持配置实时更新，但你的应用获取更新后的逻辑一般是需要定制的，比如reload，具体怎么做，携程apollo github站点上有样例可参考https://github.com/ctripcorp/apollo-use-cases","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1543236593,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":14020,"user_name":"Boxing","can_delete":false,"product_type":"c3","uid":1129447,"ip_address":"","ucode":"EE9462C76F055A","user_header":"https://static001.geekbang.org/account/avatar/00/11/3b/e7/553a0c18.jpg","comment_is_top":false,"comment_ctime":1530145230,"is_pvip":false,"replies":[{"id":5077,"content":"最后一个模块（第9模块）会讲端到端的案例，从业务需求，到架构设计建摸，到转变为微服务实现","user_name":"作者回复","user_name_real":"杨波","uid":1030344,"ctime":1530893738,"ip_address":"","comment_id":14020,"utype":1}],"discussion_count":1,"race_medal":0,"score":2,"product_id":100007001,"comment_content":"波波老师，如果有空能不能讲些架构设计的一些东西，比如当拿到一个庞大的系统需求，怎样分析，怎样梳理成业务架构，怎样将业务架构演变为技术架构等，谢谢！","like_count":0,"discussions":[{"author":{"id":1030344,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/b8/c8/c94d38a7.jpg","nickname":"杨波","note":"","ucode":"FA3418BB703BCA","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":419843,"discussion_content":"最后一个模块（第9模块）会讲端到端的案例，从业务需求，到架构设计建摸，到转变为微服务实现","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1530893738,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":387618,"user_name":"Steven","can_delete":false,"product_type":"c3","uid":1253652,"ip_address":"辽宁","ucode":"3FE64459842015","user_header":"https://static001.geekbang.org/account/avatar/00/13/21/14/423a821f.jpg","comment_is_top":false,"comment_ctime":1708253561,"is_pvip":false,"replies":null,"discussion_count":0,"race_medal":0,"score":2,"product_id":100007001,"comment_content":"代码例子里， application.yml 里面如果是“namespaces: application,TEST1.apollo,application.yaml”，需要注意把“application.yaml”去掉，SampleRedisConfig才能好用。\n\n另外，SampleRedisConfig中对应的配置值动态刷新功能，老示例代码不好用，可以下载新代码 https:&#47;&#47;github.com&#47;apolloconfig&#47;apollo-demo-java","like_count":0}]}