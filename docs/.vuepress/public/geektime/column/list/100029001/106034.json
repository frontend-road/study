{"id":106034,"title":"19 | 让我知道你是谁：HTTP的Cookie机制","content":"<p>在之前的<a href=\"https://time.geekbang.org/column/article/103270\">第13讲</a>、<a href=\"https://time.geekbang.org/column/article/103746\">第14讲</a>中，我曾经说过，HTTP是“无状态”的，这既是优点也是缺点。优点是服务器没有状态差异，可以很容易地组成集群，而缺点就是无法支持需要记录状态的事务操作。</p><p>好在HTTP协议是可扩展的，后来发明的Cookie技术，给HTTP增加了“记忆能力”。</p><h2>什么是Cookie？</h2><p>不知道你有没有看过克里斯托弗·诺兰导演的一部经典电影《记忆碎片》（Memento），里面的主角患有短期失忆症，记不住最近发生的事情。</p><p><video poster=\"https://static001.geekbang.org/resource/image/81/25/816df396bae0b37101543f967ff82125.jpeg\" preload=\"none\" controls=\"\"><source src=\"https://media001.geekbang.org/customerTrans/fe4a99b62946f2c31c2095c167b26f9c/11137c6c-16d14222dfe-0000-0000-01d-dbacd.mp4\" type=\"video/mp4\"><source src=\"https://media001.geekbang.org/fccbc2d505ee4d33a5b4c61ddf2d79bd/a20b79548de949b1a9c5adc39d46334f-78b40e38c736ae3917956dc5ead50a1e-sd.m3u8\" type=\"application/x-mpegURL\"><source src=\"https://media001.geekbang.org/fccbc2d505ee4d33a5b4c61ddf2d79bd/a20b79548de949b1a9c5adc39d46334f-689660f8bb4929b7b37d995a528eeae1-hd.m3u8\" type=\"application/x-mpegURL\"></video></p><p>比如，电影里有个场景，某人刚跟主角说完话，大闹了一通，过了几分钟再回来，主角却是一脸茫然，完全不记得这个人是谁，刚才又做了什么，只能任人摆布。</p><p>这种情况就很像HTTP里“无状态”的Web服务器，只不过服务器的“失忆症”比他还要严重，连一分钟的记忆也保存不了，请求处理完立刻就忘得一干二净。即使这个请求会让服务器发生500的严重错误，下次来也会依旧“热情招待”。</p><p>如果Web服务器只是用来管理静态文件还好说，对方是谁并不重要，把文件从磁盘读出来发走就可以了。但随着HTTP应用领域的不断扩大，对“记忆能力”的需求也越来越强烈。比如网上论坛、电商购物，都需要“看客下菜”，只有记住用户的身份才能执行发帖子、下订单等一系列会话事务。</p><!-- [[[read_end]]] --><p>那该怎么样让原本无“记忆能力”的服务器拥有“记忆能力”呢？</p><p>看看电影里的主角是怎么做的吧。他通过纹身、贴纸条、立拍得等手段，在外界留下了各种记录，一旦失忆，只要看到这些提示信息，就能够在头脑中快速重建起之前的记忆，从而把因失忆而耽误的事情继续做下去。</p><p>HTTP的Cookie机制也是一样的道理，既然服务器记不住，那就在外部想办法记住。相当于是服务器给每个客户端都贴上一张小纸条，上面写了一些只有服务器才能理解的数据，需要的时候客户端把这些信息发给服务器，服务器看到Cookie，就能够认出对方是谁了。</p><h2>Cookie的工作过程</h2><p>那么，Cookie这张小纸条是怎么传递的呢？</p><p>这要用到两个字段：响应头字段<strong>Set-Cookie</strong>和请求头字段<strong>Cookie</strong>。</p><p>当用户通过浏览器第一次访问服务器的时候，服务器肯定是不知道他的身份的。所以，就要创建一个独特的身份标识数据，格式是“<strong>key=value</strong>”，然后放进Set-Cookie字段里，随着响应报文一同发给浏览器。</p><p>浏览器收到响应报文，看到里面有Set-Cookie，知道这是服务器给的身份标识，于是就保存起来，下次再请求的时候就自动把这个值放进Cookie字段里发给服务器。</p><p>因为第二次请求里面有了Cookie字段，服务器就知道这个用户不是新人，之前来过，就可以拿出Cookie里的值，识别出用户的身份，然后提供个性化的服务。</p><p>不过因为服务器的“记忆能力”实在是太差，一张小纸条经常不够用。所以，服务器有时会在响应头里添加多个Set-Cookie，存储多个“key=value”。但浏览器这边发送时不需要用多个Cookie字段，只要在一行里用“;”隔开就行。</p><p>我画了一张图来描述这个过程，你看过就能理解了。</p><p><img src=\"https://static001.geekbang.org/resource/image/9f/a4/9f6cca61802d65d063e24aa9ca7c38a4.png?wh=2100*921\" alt=\"\"></p><p>从这张图中我们也能够看到，Cookie是由浏览器负责存储的，而不是操作系统。所以，它是“浏览器绑定”的，只能在本浏览器内生效。</p><p>如果你换个浏览器或者换台电脑，新的浏览器里没有服务器对应的Cookie，就好像是脱掉了贴着纸条的衣服，“健忘”的服务器也就认不出来了，只能再走一遍Set-Cookie流程。</p><p>在实验环境里，你可以用Chrome访问URI“/19-1”，实地看一下Cookie工作过程。</p><p>首次访问时服务器会设置两个Cookie。</p><p><img src=\"https://static001.geekbang.org/resource/image/97/87/974063541e5f9b43893db45ac4ce3687.png?wh=1893*821\" alt=\"\"></p><p>然后刷新这个页面，浏览器就会在请求头里自动送出Cookie，服务器就能认出你了。</p><p><img src=\"https://static001.geekbang.org/resource/image/da/9f/da9b39d88ddd717a6e3feb6637dc3f9f.png?wh=1598*1244\" alt=\"\"></p><p>如果换成Firefox等其他浏览器，因为Cookie是存在Chrome里的，所以服务器就又“蒙圈”了，不知道你是谁，就会给Firefox再贴上小纸条。</p><h2>Cookie的属性</h2><p>说到这里，你应该知道了，Cookie就是服务器委托浏览器存储在客户端里的一些数据，而这些数据通常都会记录用户的关键识别信息。所以，就需要在“key=value”外再用一些手段来保护，防止外泄或窃取，这些手段就是Cookie的属性。</p><p>下面这个截图是实验环境“/19-2”的响应头，我来对着这个实际案例讲一下都有哪些常见的Cookie属性。</p><p><img src=\"https://static001.geekbang.org/resource/image/9d/5d/9dbb8b490714360475911ca04134df5d.png?wh=2091*762\" alt=\"\"></p><p>首先，我们应该<strong>设置Cookie的生存周期</strong>，也就是它的有效期，让它只能在一段时间内可用，就像是食品的“保鲜期”，一旦超过这个期限浏览器就认为是Cookie失效，在存储里删除，也不会发送给服务器。</p><p>Cookie的有效期可以使用Expires和Max-Age两个属性来设置。</p><p>“<strong>Expires</strong>”俗称“过期时间”，用的是绝对时间点，可以理解为“截止日期”（deadline）。“<strong>Max-Age</strong>”用的是相对时间，单位是秒，浏览器用收到报文的时间点再加上Max-Age，就可以得到失效的绝对时间。</p><p>Expires和Max-Age可以同时出现，两者的失效时间可以一致，也可以不一致，但浏览器会优先采用Max-Age计算失效期。</p><p>比如在这个例子里，Expires标记的过期时间是“GMT 2019年6月7号8点19分”，而Max-Age则只有10秒，如果现在是6月6号零点，那么Cookie的实际有效期就是“6月6号零点过10秒”。</p><p>其次，我们需要<strong>设置Cookie的作用域</strong>，让浏览器仅发送给特定的服务器和URI，避免被其他网站盗用。</p><p>作用域的设置比较简单，“<strong>Domain</strong>”和“<strong>Path</strong>”指定了Cookie所属的域名和路径，浏览器在发送Cookie前会从URI中提取出host和path部分，对比Cookie的属性。如果不满足条件，就不会在请求头里发送Cookie。</p><p>使用这两个属性可以为不同的域名和路径分别设置各自的Cookie，比如“/19-1”用一个Cookie，“/19-2”再用另外一个Cookie，两者互不干扰。不过现实中为了省事，通常Path就用一个“/”或者直接省略，表示域名下的任意路径都允许使用Cookie，让服务器自己去挑。</p><p>最后要考虑的就是<strong>Cookie的安全性</strong>了，尽量不要让服务器以外的人看到。</p><p>写过前端的同学一定知道，在JS脚本里可以用document.cookie来读写Cookie数据，这就带来了安全隐患，有可能会导致“跨站脚本”（XSS）攻击窃取数据。</p><p>属性“<strong>HttpOnly</strong>”会告诉浏览器，此Cookie只能通过浏览器HTTP协议传输，禁止其他方式访问，浏览器的JS引擎就会禁用document.cookie等一切相关的API，脚本攻击也就无从谈起了。</p><p>另一个属性“<strong>SameSite</strong>”可以防范“跨站请求伪造”（XSRF）攻击，设置成“SameSite=Strict”可以严格限定Cookie不能随着跳转链接跨站发送，而“SameSite=Lax”则略宽松一点，允许GET/HEAD等安全方法，但禁止POST跨站发送。</p><p>还有一个属性叫“<strong>Secure</strong>”，表示这个Cookie仅能用HTTPS协议加密传输，明文的HTTP协议会禁止发送。但Cookie本身不是加密的，浏览器里还是以明文的形式存在。</p><p>Chrome开发者工具是查看Cookie的有力工具，在“Network-Cookies”里可以看到单个页面Cookie的各种属性，另一个“Application”面板里则能够方便地看到全站的所有Cookie。</p><p><img src=\"https://static001.geekbang.org/resource/image/a8/9d/a8accc7e1836fa348c2fbd29f494069d.png?wh=3683*985\" alt=\"\"></p><p><img src=\"https://static001.geekbang.org/resource/image/37/6e/37fbfef0490a20179c0ee274dccf5e6e.png?wh=2097*795\" alt=\"\"></p><h2>Cookie的应用</h2><p>现在回到我们最开始的话题，有了Cookie，服务器就有了“记忆能力”，能够保存“状态”，那么应该如何使用Cookie呢？</p><p>Cookie最基本的一个用途就是<strong>身份识别</strong>，保存用户的登录信息，实现会话事务。</p><p>比如，你用账号和密码登录某电商，登录成功后网站服务器就会发给浏览器一个Cookie，内容大概是“name=yourid”，这样就成功地把身份标签贴在了你身上。</p><p>之后你在网站里随便访问哪件商品的页面，浏览器都会自动把身份Cookie发给服务器，所以服务器总会知道你的身份，一方面免去了重复登录的麻烦，另一方面也能够自动记录你的浏览记录和购物下单（在后台数据库或者也用Cookie），实现了“状态保持”。</p><p>Cookie的另一个常见用途是<strong>广告跟踪</strong>。</p><p>你上网的时候肯定看过很多的广告图片，这些图片背后都是广告商网站（例如Google），它会“偷偷地”给你贴上Cookie小纸条，这样你上其他的网站，别的广告就能用Cookie读出你的身份，然后做行为分析，再推给你广告。</p><p>这种Cookie不是由访问的主站存储的，所以又叫“第三方Cookie”（third-party cookie）。如果广告商势力很大，广告到处都是，那么就比较“恐怖”了，无论你走到哪里它都会通过Cookie认出你来，实现广告“精准打击”。</p><p>为了防止滥用Cookie搜集用户隐私，互联网组织相继提出了DNT（Do Not Track）和P3P（Platform for Privacy Preferences Project），但实际作用不大。</p><h2>小结</h2><p>今天我们学习了HTTP里的Cookie知识。虽然现在已经出现了多种Local Web Storage技术，能够比Cookie存储更多的数据，但Cookie仍然是最通用、兼容性最强的客户端数据存储手段。</p><p>简单小结一下今天的内容：</p><ol>\n<li><span class=\"orange\">Cookie是服务器委托浏览器存储的一些数据，让服务器有了“记忆能力”；</span></li>\n<li><span class=\"orange\">响应报文使用Set-Cookie字段发送“key=value”形式的Cookie值；</span></li>\n<li><span class=\"orange\">请求报文里用Cookie字段发送多个Cookie值；</span></li>\n<li><span class=\"orange\">为了保护Cookie，还要给它设置有效期、作用域等属性，常用的有Max-Age、Expires、Domain、HttpOnly等；</span></li>\n<li><span class=\"orange\">Cookie最基本的用途是身份识别，实现有状态的会话事务。</span></li>\n</ol><p>还要提醒你一点，因为Cookie并不属于HTTP标准（RFC6265，而不是RFC2616/7230），所以语法上与其他字段不太一致，使用的分隔符是“;”，与Accept等字段的“,”不同，小心不要弄错了。</p><h2>课下作业</h2><ol>\n<li>如果Cookie的Max-Age属性设置为0，会有什么效果呢？</li>\n<li>Cookie的好处已经很清楚了，你觉得它有什么缺点呢？</li>\n</ol><p>欢迎你把自己的学习体会写在留言区，与我和其他同学一起讨论。如果你觉得有所收获，也欢迎把文章分享给你的朋友。</p><p><img src=\"https://static001.geekbang.org/resource/image/f0/97/f03db082760cfa8920b266ce44f52597.png?wh=1769*2877\" alt=\"unpreview\"></p><p><img src=\"https://static001.geekbang.org/resource/image/56/63/56d766fc04654a31536f554b8bde7b63.jpg?wh=1110*659\" alt=\"unpreview\"></p>","neighbors":{"left":{"article_title":"18 | 四通八达：HTTP的重定向和跳转","id":105614},"right":{"article_title":"20 | 生鲜速递：HTTP的缓存控制","id":106804}},"comments":[{"had_liked":false,"id":112325,"user_name":"徐海浪","can_delete":false,"product_type":"c1","uid":1078528,"ip_address":"","ucode":"21801C420D0610","user_header":"https://static001.geekbang.org/account/avatar/00/10/75/00/618b20da.jpg","comment_is_top":false,"comment_ctime":1562720353,"is_pvip":false,"replies":[{"id":"40885","content":"√","user_name":"作者回复","user_name_real":"chrono","uid":"1181974","ctime":1562732674,"ip_address":"","comment_id":112325,"utype":1}],"discussion_count":3,"race_medal":1,"score":"186246314081","product_id":100029001,"comment_content":"1. 如果 Cookie 的 Max-Age 属性设置为 0，会有什么效果呢？<br>设置为0，服务器0秒就让Cookie失效，即立即失效，服务器不存Cookie。<br>2. Cookie 的好处已经很清楚了，你觉得它有什么缺点呢？<br>好处：方便了市民<br>缺点：方便了黑客:)","like_count":44,"discussions":[{"author":{"id":1181974,"avatar":"https://static001.geekbang.org/account/avatar/00/12/09/16/1161017c.jpg","nickname":"罗剑锋","note":"","ucode":"95678C988F24AB","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":457676,"discussion_content":"√","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1562732674,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1181887,"avatar":"https://static001.geekbang.org/account/avatar/00/12/08/bf/cd6bfc22.jpg","nickname":"自然","note":"","ucode":"EDFC3EFAB0B88E","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":572315,"discussion_content":"应该是指示浏览器不缓存cookies，而不是服务器","likes_number":2,"is_delete":false,"is_hidden":false,"ctime":1652702298,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":2036038,"avatar":"https://static001.geekbang.org/account/avatar/00/1f/11/46/7e09409f.jpg","nickname":"我和我的狗","note":"","ucode":"BA1B9DBAE81966","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":390489,"discussion_content":"Max-Age = -1，咋说","likes_number":1,"is_delete":false,"is_hidden":false,"ctime":1629861061,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":112616,"user_name":"放开那个猴子","can_delete":false,"product_type":"c1","uid":1087786,"ip_address":"","ucode":"93595F09B94402","user_header":"https://static001.geekbang.org/account/avatar/00/10/99/2a/f7e19dcc.jpg","comment_is_top":false,"comment_ctime":1562772159,"is_pvip":false,"replies":[{"id":"40999","content":"是这样的，网站的页面里会嵌入很多广告代码，里面就会访问广告商，在浏览器里存储广告商的cookie。<br><br>你换到其他网站，上面也有这个广告商的广告代码，因为都是一个广告商网站，自然就能够读取之前设置的cookie，也就获得了你的信息。","user_name":"作者回复","user_name_real":"chrono","uid":"1181974","ctime":1562825769,"ip_address":"","comment_id":112616,"utype":1}],"discussion_count":14,"race_medal":0,"score":"134706758335","product_id":100029001,"comment_content":"广告追踪没看明白呀，能否详细讲讲","like_count":32,"discussions":[{"author":{"id":1281585,"avatar":"https://static001.geekbang.org/account/avatar/00/13/8e/31/28972804.jpg","nickname":"阿海","note":"","ucode":"2589431F840C42","race_medal":0,"user_type":1,"is_pvip":true},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":386663,"discussion_content":"比如 极客时间插入了谷歌的广告，用户加载谷歌广告后(访问的是谷歌的服务器，自然下发了谷歌的cookie), 那么下次用户去其他有谷歌广告的网站上网，这次请求广告会带上之前谷歌的cookie, 谷歌就可以根据这个cookie中的信息来推荐广告给用户","likes_number":14,"is_delete":false,"is_hidden":false,"ctime":1627715559,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1202089,"avatar":"https://static001.geekbang.org/account/avatar/00/12/57/a9/9abbe7a4.jpg","nickname":"神三元","note":"","ucode":"0FB2E7C0683599","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":135023,"discussion_content":"我能说我还是没听懂吗？","likes_number":9,"is_delete":false,"is_hidden":false,"ctime":1579061263,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":2,"child_discussions":[{"author":{"id":1989037,"avatar":"https://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTKWcQoeJoksEibTQzNEmg5ZflNjzZZ4DDfGE5b2ChEQWkmHFUicv2Q06q4WpAIpcS7blFZRZonKOskQ/132","nickname":"陈志强","note":"","ucode":"1AD8B376B79412","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":1202089,"avatar":"https://static001.geekbang.org/account/avatar/00/12/57/a9/9abbe7a4.jpg","nickname":"神三元","note":"","ucode":"0FB2E7C0683599","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":324060,"discussion_content":"活捉三元大佬","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1605050194,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":135023,"ip_address":""},"score":324060,"extra":""},{"author":{"id":1643013,"avatar":"https://thirdwx.qlogo.cn/mmopen/vi_32/oS1cVXlibzxa4lsYRFXplp8f0CJic6nvTHQnSdYSic5yficutYSqwvVtWUWY7dqN1DMPCOJPNq4EmKpzm8Jic8ux92g/132","nickname":"Geek_7bf210","note":"","ucode":"B0A624D87CA91B","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":1202089,"avatar":"https://static001.geekbang.org/account/avatar/00/12/57/a9/9abbe7a4.jpg","nickname":"神三元","note":"","ucode":"0FB2E7C0683599","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":344193,"discussion_content":"你可以试着这么理解, 比如前端大部分功能都集成了vue这个第三方框架, 如果vue偷偷留一个后门, 把你的信息偷偷上传到自己的服务器. 那其他的网站也集成了vue的时候, 也上传到服务器, 一对比发现是同一个用户. 这样就可以进行精准投放了.   如果做过移动端, 接入过第三方广告SDK就很容易理解了","likes_number":1,"is_delete":false,"is_hidden":false,"ctime":1611321414,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":135023,"ip_address":""},"score":344193,"extra":""}]},{"author":{"id":2807902,"avatar":"https://static001.geekbang.org/account/avatar/00/2a/d8/5e/3548334f.jpg","nickname":"Aki","note":"","ucode":"B862D9A2F21480","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":539982,"discussion_content":"就好比，淘宝在新浪微博和百度搜索中都租了广告位，然后在新浪微博记录个人的信息，然后，当你去到百度搜索页面的时候，会利用在新浪微博收集的个人信息，显示精准广告。","likes_number":3,"is_delete":false,"is_hidden":false,"ctime":1639909254,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":2575992,"avatar":"https://static001.geekbang.org/account/avatar/00/27/4e/78/1b1bc18e.jpg","nickname":"光穿过森林","note":"","ucode":"446ED739536427","race_medal":0,"user_type":1,"is_pvip":true},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":548568,"discussion_content":"之前看到阮一峰写的一个例子 \n比如，Facebook 在第三方网站（比如极客时间）插入一张看不见的图片。\n&lt;img src=&#34;facebook.com&#34; style=&#34;visibility:hidden;&#34;&gt;\n浏览器加载上面代码时，就会向 Facebook 发出带有 Cookie 的请求，从而 Facebook 就会知道你是谁，访问了什么网站。","likes_number":2,"is_delete":false,"is_hidden":false,"ctime":1643266715,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1181974,"avatar":"https://static001.geekbang.org/account/avatar/00/12/09/16/1161017c.jpg","nickname":"罗剑锋","note":"","ucode":"95678C988F24AB","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":457819,"discussion_content":"是这样的，网站的页面里会嵌入很多广告代码，里面就会访问广告商，在浏览器里存储广告商的cookie。\n\n你换到其他网站，上面也有这个广告商的广告代码，因为都是一个广告商网站，自然就能够读取之前设置的cookie，也就获得了你的信息。","likes_number":1,"is_delete":false,"is_hidden":false,"ctime":1562825769,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1037940,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/d6/74/6f04af6f.jpg","nickname":"鸿溟","note":"","ucode":"C8FC4C3DB6161E","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":362538,"discussion_content":"我说怎么手机app，浏览器只要自己看过啥，到其他的网站，app都给你推同样的，还一直很好奇，原来是这样，学到了学到了","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1616979785,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1153148,"avatar":"https://static001.geekbang.org/account/avatar/00/11/98/7c/56649bc7.jpg","nickname":"肖斐","note":"","ucode":"5496CA9BF7EB08","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":284464,"discussion_content":"Max-age等于0是会话级别的，关闭浏览器才会失效。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1592538523,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1363634,"avatar":"https://static001.geekbang.org/account/avatar/00/14/ce/b2/1f914527.jpg","nickname":"海盗船长","note":"","ucode":"ECB28BA21A4113","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":263464,"discussion_content":"遇到这种情况，可以试试清理下cookie","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1589208026,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1463686,"avatar":"https://static001.geekbang.org/account/avatar/00/16/55/86/ca7c94ce.jpg","nickname":"羁绊12221","note":"","ucode":"15B47C5053388A","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":1867,"discussion_content":"请问老师，广告商可以通过第三方cookie获取您的身份信息，但是广告商是怎么知道你的兴趣的呢?(也就是当前访问的网站) ，通过refer吗？毕竟广告商肯定读不了当前页面的第一方cookie中的域信息。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1563009505,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":3,"child_discussions":[{"author":{"id":1698219,"avatar":"http://thirdwx.qlogo.cn/mmopen/vi_32/PiajxSqBRaEKkDB6420zwODZTJL6icKKTpyFKuVF9GRjj1V5ziaibADbrpDMmicF8Ad5fmBjycibEg3yhpwlVOLzzxRQ/132","nickname":"Teresa","note":"","ucode":"6106B84BDC30AF","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":1463686,"avatar":"https://static001.geekbang.org/account/avatar/00/16/55/86/ca7c94ce.jpg","nickname":"羁绊12221","note":"","ucode":"15B47C5053388A","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":249040,"discussion_content":"我大概明白了，相当于每个有广告的网站，都会插入广告商的代码，只要广告展示了，就说明你已经踩了广告的雷了，他会给你分配一个Cookie，Cookie是针对一个域名下有效的，广告商的代码当然都在一个域名下，即便你跑到别的嵌有广告商不同的网站，这对广告商来说无所谓，只要有他广告的代码，他就能拿到他自己之前设置的Cookie ，他针对不同的网站设置不同的打点记录，自然就能知道你的喜好了。 好比百度嵌有广告商的广告代码，新浪也嵌有，腾讯也嵌有，你访问了百度，然后又跑到新浪然后又跑到腾讯，你什么时候访问了哪个网站，他都给你打点记录下来了。","likes_number":10,"is_delete":false,"is_hidden":false,"ctime":1587908236,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":1867,"ip_address":""},"score":249040,"extra":""},{"author":{"id":1184233,"avatar":"https://static001.geekbang.org/account/avatar/00/12/11/e9/b6aa6364.jpg","nickname":"shenfl","note":"","ucode":"607CD894152241","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":1698219,"avatar":"http://thirdwx.qlogo.cn/mmopen/vi_32/PiajxSqBRaEKkDB6420zwODZTJL6icKKTpyFKuVF9GRjj1V5ziaibADbrpDMmicF8Ad5fmBjycibEg3yhpwlVOLzzxRQ/132","nickname":"Teresa","note":"","ucode":"6106B84BDC30AF","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":401206,"discussion_content":"当你访问腾讯的时候，广告商只知道你之前访问过百度，但是并不知道你在百度中的喜好。感觉没啥用啊。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1633602186,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":249040,"ip_address":""},"score":401206,"extra":""},{"author":{"id":1184233,"avatar":"https://static001.geekbang.org/account/avatar/00/12/11/e9/b6aa6364.jpg","nickname":"shenfl","note":"","ucode":"607CD894152241","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":1698219,"avatar":"http://thirdwx.qlogo.cn/mmopen/vi_32/PiajxSqBRaEKkDB6420zwODZTJL6icKKTpyFKuVF9GRjj1V5ziaibADbrpDMmicF8Ad5fmBjycibEg3yhpwlVOLzzxRQ/132","nickname":"Teresa","note":"","ucode":"6106B84BDC30AF","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":401207,"discussion_content":"除非当你访问百度是嵌入的广告请求中携带了当前网页的信息，然后广告商记录在cookie中","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1633602343,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":249040,"ip_address":""},"score":401207,"extra":""}]}]},{"had_liked":false,"id":124368,"user_name":"Geek_66666","can_delete":false,"product_type":"c1","uid":1619479,"ip_address":"","ucode":"36F79954146DE8","user_header":"https://static001.geekbang.org/account/avatar/00/18/b6/17/76f29bfb.jpg","comment_is_top":false,"comment_ctime":1565868455,"is_pvip":false,"replies":[{"id":"45716","content":"max-age=0是指不能缓存，但在会话期间是可用的，浏览器会话关闭之前可以用cookie记录用户的信息。","user_name":"作者回复","user_name_real":"chrono","uid":"1181974","ctime":1565917030,"ip_address":"","comment_id":124368,"utype":1}],"discussion_count":2,"race_medal":0,"score":"108940050855","product_id":100029001,"comment_content":"既然max-age=0会立即失效，那不就等于无记忆了？那干嘛还用cookie？","like_count":24,"discussions":[{"author":{"id":1181974,"avatar":"https://static001.geekbang.org/account/avatar/00/12/09/16/1161017c.jpg","nickname":"罗剑锋","note":"","ucode":"95678C988F24AB","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":463139,"discussion_content":"max-age=0是指不能缓存，但在会话期间是可用的，浏览器会话关闭之前可以用cookie记录用户的信息。","likes_number":1,"is_delete":false,"is_hidden":false,"ctime":1565917030,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":1,"child_discussions":[{"author":{"id":1673843,"avatar":"http://thirdwx.qlogo.cn/mmopen/vi_32/DYAIOgq83erXRaa98A3zjLDkOibUJV1254aQ4EYFTbSLJuEvD0nXicMNA8pLoxOfHf5kPTbGLXNicg8CPFH3Tn0mA/132","nickname":"Geek_115bc8","note":"","ucode":"71FBC9F02AFE1B","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":1181974,"avatar":"https://static001.geekbang.org/account/avatar/00/12/09/16/1161017c.jpg","nickname":"罗剑锋","note":"","ucode":"95678C988F24AB","race_medal":0,"user_type":2,"is_pvip":false},"discussion":{"id":569072,"discussion_content":"老师，但是经过测试，他确实不会保存在浏览器上啊。并且再次发送请求，也不会携带cookie。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1651312357,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":463139,"ip_address":""},"score":569072,"extra":""}]}]},{"had_liked":false,"id":112963,"user_name":"前端西瓜哥","can_delete":false,"product_type":"c1","uid":1248576,"ip_address":"","ucode":"150130C34CD1C1","user_header":"https://static001.geekbang.org/account/avatar/00/13/0d/40/f70e5653.jpg","comment_is_top":false,"comment_ctime":1562855839,"is_pvip":false,"replies":[{"id":"41103","content":"good。","user_name":"作者回复","user_name_real":"chrono","uid":"1181974","ctime":1562885889,"ip_address":"","comment_id":112963,"utype":1}],"discussion_count":1,"race_medal":0,"score":"96052136351","product_id":100029001,"comment_content":"1. （我修改 Lua 文件测试了一下）如果 Max-Age 设置为0，浏览器中该 Cookie 失效，即便这个 Cookie 已存在于浏览器中，且尚未过期。另外 Web 应用开发中，可以通过这种方式消除掉用户的登陆状态，此外记得在服务器的 session 中移除该 cookie 和其对应的用户信息。<br>2. Cookie 的缺点：<br>（1） 不安全。如果被中间人获取到 Cookie，完全将它作为用户凭证冒充用户。解决方案是使用 https 进行加密。<br>（2）有数量和大小限制。另外 Cookie 太大也不好，传输的数据会变大。<br>（3）客户端可能不会保存 Cookie。比如用 telnet 收发数据，用户禁用浏览器 Cookie 保存功能的情况。","like_count":23,"discussions":[{"author":{"id":1181974,"avatar":"https://static001.geekbang.org/account/avatar/00/12/09/16/1161017c.jpg","nickname":"罗剑锋","note":"","ucode":"95678C988F24AB","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":457981,"discussion_content":"good。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1562885889,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":112554,"user_name":"WL","can_delete":false,"product_type":"c1","uid":1173771,"ip_address":"","ucode":"6277DCD776B87E","user_header":"https://static001.geekbang.org/account/avatar/00/11/e9/0b/1171ac71.jpg","comment_is_top":false,"comment_ctime":1562756816,"is_pvip":false,"replies":[{"id":"40941","content":"1，是的。<br><br>2.你理解的反了，应该是带上B网站的cookie。<br><br>https:&#47;&#47;developer.mozilla.org&#47;zh-CN&#47;docs&#47;Web&#47;HTTP&#47;Cookies<br><br>这个链接里举的例子也许能够帮助你理解。","user_name":"作者回复","user_name_real":"chrono","uid":"1181974","ctime":1562763906,"ip_address":"","comment_id":112554,"utype":1}],"discussion_count":3,"race_medal":0,"score":"61692298960","product_id":100029001,"comment_content":"对于XSS和XSRF一直不是很理解希望老师帮忙解答一下：<br>1. XSS攻击是指第三方的JS代码读取到浏览器A网站的Cookie然后冒充我去访问A网站吗？<br>2.XSRF是指浏览器从A网站跳转到B网站是会带上A网站的Cookie吗？这个不是由Domain和Path已经限定了吗？","like_count":15,"discussions":[{"author":{"id":1181974,"avatar":"https://static001.geekbang.org/account/avatar/00/12/09/16/1161017c.jpg","nickname":"罗剑锋","note":"","ucode":"95678C988F24AB","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":457792,"discussion_content":"1，是的。\n\n2.你理解的反了，应该是带上B网站的cookie。\n\nhttps://developer.mozilla.org/zh-CN/docs/Web/HTTP/Cookies\n\n这个链接里举的例子也许能够帮助你理解。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1562763906,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":2267088,"avatar":"https://static001.geekbang.org/account/avatar/00/22/97/d0/95eaabef.jpg","nickname":"水手辛伯达","note":"","ucode":"94D8FD51FE4F8A","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":374759,"discussion_content":"应该是CSRF , 这里写成XSR应该是笔误！","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1621337587,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1733144,"avatar":"https://static001.geekbang.org/account/avatar/00/1a/72/18/d9e2fcf9.jpg","nickname":"我来人间一趟","note":"","ucode":"15CAF96EF899E2","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":357904,"discussion_content":"不是csrf吗","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1615893629,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":112498,"user_name":"饭饭","can_delete":false,"product_type":"c1","uid":1211118,"ip_address":"","ucode":"C29DDDB4A038EC","user_header":"https://static001.geekbang.org/account/avatar/00/12/7a/ee/257a22fb.jpg","comment_is_top":false,"comment_ctime":1562747816,"is_pvip":false,"replies":[{"id":"40939","content":"rfc里有说明，如果max-age &lt;=0，统一按0算，立即过期。","user_name":"作者回复","user_name_real":"chrono","uid":"1181974","ctime":1562755100,"ip_address":"","comment_id":112498,"utype":1}],"discussion_count":1,"race_medal":0,"score":"61692289960","product_id":100029001,"comment_content":"Max-age：-1 的时候会永久有效吧 ？","like_count":15,"discussions":[{"author":{"id":1181974,"avatar":"https://static001.geekbang.org/account/avatar/00/12/09/16/1161017c.jpg","nickname":"罗剑锋","note":"","ucode":"95678C988F24AB","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":457766,"discussion_content":"rfc里有说明，如果max-age &amp;lt;=0，统一按0算，立即过期。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1562755100,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":112466,"user_name":"业余草","can_delete":false,"product_type":"c1","uid":1126538,"ip_address":"","ucode":"99BDC1E629049D","user_header":"https://static001.geekbang.org/account/avatar/00/11/30/8a/b5ca7286.jpg","comment_is_top":false,"comment_ctime":1562741237,"is_pvip":false,"replies":[{"id":"40933","content":"其实并不少见，上几个大站，用开发者工具看看就能看到。","user_name":"作者回复","user_name_real":"chrono","uid":"1181974","ctime":1562754531,"ip_address":"","comment_id":112466,"utype":1}],"discussion_count":2,"race_medal":0,"score":"40217446901","product_id":100029001,"comment_content":"属性“HttpOnly”、“Secure”、“SameSite”很少见，老师可以给几个配套例子，后面答疑篇，可以来个攻防实战！","like_count":10,"discussions":[{"author":{"id":1181974,"avatar":"https://static001.geekbang.org/account/avatar/00/12/09/16/1161017c.jpg","nickname":"罗剑锋","note":"","ucode":"95678C988F24AB","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":457747,"discussion_content":"其实并不少见，上几个大站，用开发者工具看看就能看到。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1562754531,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1899883,"avatar":"https://static001.geekbang.org/account/avatar/00/1c/fd/6b/d91521bf.jpg","nickname":"也許有一天","note":"","ucode":"61D4A89C97B096","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":537788,"discussion_content":"HttpOnly非常常見","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1639195034,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":221902,"user_name":"rongyefeng","can_delete":false,"product_type":"c1","uid":1959482,"ip_address":"","ucode":"9A15D947E9D645","user_header":"https://static001.geekbang.org/account/avatar/00/1d/e6/3a/382cf024.jpg","comment_is_top":false,"comment_ctime":1590630411,"is_pvip":false,"replies":[{"id":"81828","content":"意思是cookie在传输过程是被https加密的，不能用明文的http传输，但在本地，它还是明文，没有被加密，还是能够被任意查看。","user_name":"作者回复","user_name_real":"罗剑锋","uid":"1181974","ctime":1590651898,"ip_address":"","comment_id":221902,"utype":1}],"discussion_count":1,"race_medal":0,"score":"35950368779","product_id":100029001,"comment_content":"还有一个属性叫“Secure”，表示这个 Cookie 仅能用 HTTPS 协议加密传输，明文的 HTTP 协议会禁止发送。<br>但 Cookie 本身不是加密的，浏览器里还是以明文的形式存在。<br>这里的“ Cookie 本身”怎么理解？","like_count":9,"discussions":[{"author":{"id":1181974,"avatar":"https://static001.geekbang.org/account/avatar/00/12/09/16/1161017c.jpg","nickname":"罗剑锋","note":"","ucode":"95678C988F24AB","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":496605,"discussion_content":"意思是cookie在传输过程是被https加密的，不能用明文的http传输，但在本地，它还是明文，没有被加密，还是能够被任意查看。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1590651898,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":112258,"user_name":"大小兵","can_delete":false,"product_type":"c1","uid":1209885,"ip_address":"","ucode":"1227870F26D322","user_header":"https://static001.geekbang.org/account/avatar/00/12/76/1d/b4262bdc.jpg","comment_is_top":false,"comment_ctime":1562692655,"is_pvip":false,"replies":[{"id":"40820","content":"这个不在http范围之内，而且篇幅有限，还望见谅。","user_name":"作者回复","user_name_real":"chrono","uid":"1181974","ctime":1562715582,"ip_address":"","comment_id":112258,"utype":1}],"discussion_count":2,"race_medal":0,"score":"27332496431","product_id":100029001,"comment_content":"要是能把session和token也说一下就好了","like_count":6,"discussions":[{"author":{"id":1181974,"avatar":"https://static001.geekbang.org/account/avatar/00/12/09/16/1161017c.jpg","nickname":"罗剑锋","note":"","ucode":"95678C988F24AB","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":457642,"discussion_content":"这个不在http范围之内，而且篇幅有限，还望见谅。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1562715582,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1478573,"avatar":"https://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTKBS8Xf2qLLpEe6eXkkTr7PPK0WeyHZe7NzP8S8pUGyyfO5SkSSx9E5S4qdtcINAmdfdSXUKWusvA/132","nickname":"Geek_1a0e29","note":"","ucode":"DFFDEA3A9A23D5","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":381384,"discussion_content":"确实应该讲一下，这里单讲cookie有点盲人摸象的感觉了。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1625035553,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":112297,"user_name":"cp3yqng","can_delete":false,"product_type":"c1","uid":1018175,"ip_address":"","ucode":"4DB87B0519DF0D","user_header":"https://static001.geekbang.org/account/avatar/00/0f/89/3f/830d74f4.jpg","comment_is_top":false,"comment_ctime":1562717845,"is_pvip":true,"replies":[{"id":"40824","content":"只要cookie设置了domain和path属性，浏览器在访问uri时就会根据这两个属性有选择地发送cookie。<br><br>需要根据自己的业务需求，恰当设置cookie的作用域，太大太小都不好。","user_name":"作者回复","user_name_real":"chrono","uid":"1181974","ctime":1562720305,"ip_address":"","comment_id":112297,"utype":1}],"discussion_count":1,"race_medal":0,"score":"23037554325","product_id":100029001,"comment_content":"域名+路径的方式存储cookie，感觉像只有一台业务服务器，那后台如何过分布式系统呢，用户中心是一个系统，核心业务是其他的系统，这里cookie肯定要共享，应该有一级域名和二级域名等等的概念吧，麻烦老师在解释解释。我本人是做移动端开发的，都是自己把token写在网络底层的请求头中，其实核心思想是一样的，但是缺点就是所有的域名里面都带token，这样也不好，好像还有优化的空间。","like_count":6,"discussions":[{"author":{"id":1181974,"avatar":"https://static001.geekbang.org/account/avatar/00/12/09/16/1161017c.jpg","nickname":"罗剑锋","note":"","ucode":"95678C988F24AB","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":457666,"discussion_content":"只要cookie设置了domain和path属性，浏览器在访问uri时就会根据这两个属性有选择地发送cookie。\n\n需要根据自己的业务需求，恰当设置cookie的作用域，太大太小都不好。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1562720305,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":160347,"user_name":"kissingers","can_delete":false,"product_type":"c1","uid":1135299,"ip_address":"","ucode":"615151808CF628","user_header":"https://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTKzqiaZnBw2myRWY802u48Rw3W2zDtKoFQ6vN63m4FdyjibM21FfaOYe8MbMpemUdxXJeQH6fRdVbZA/132","comment_is_top":false,"comment_ctime":1575939680,"is_pvip":false,"replies":[{"id":"61194","content":"nice。","user_name":"作者回复","user_name_real":"chrono","uid":"1181974","ctime":1575941774,"ip_address":"","comment_id":160347,"utype":1}],"discussion_count":1,"race_medal":0,"score":"18755808864","product_id":100029001,"comment_content":"哈哈，就是九品芝麻官里的半个烧饼：你后人凭这个来找我","like_count":4,"discussions":[{"author":{"id":1181974,"avatar":"https://static001.geekbang.org/account/avatar/00/12/09/16/1161017c.jpg","nickname":"罗剑锋","note":"","ucode":"95678C988F24AB","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":477347,"discussion_content":"nice。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1575941774,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":112456,"user_name":"chengzise","can_delete":false,"product_type":"c1","uid":1006070,"ip_address":"","ucode":"1C27D216359894","user_header":"https://static001.geekbang.org/account/avatar/00/0f/59/f6/ed66d1c1.jpg","comment_is_top":false,"comment_ctime":1562739337,"is_pvip":false,"replies":[{"id":"40938","content":"在这个场景里B是“第三方cookie”，不是A设置的，所以只要在页面里嵌入了B相关的代码，就会带上B的cookie。<br><br>完全弄清楚可能还需要一点html的知识。","user_name":"作者回复","user_name_real":"chrono","uid":"1181974","ctime":1562754968,"ip_address":"","comment_id":112456,"utype":1}],"discussion_count":1,"race_medal":0,"score":"18742608521","product_id":100029001,"comment_content":"老师好，我理解的广告跟踪那个原理是：用户访问A网站，A会给用户设置cookies（T），用户再次访问网站B时，浏览器会带上cookies（T），B网站就能够识别到被A标记的用户。这里A给用户设置的cookies里面是不是把domain设置为B网站？不然凭什么访问B网站的时候，浏览器会带上A设置的cookies。","like_count":4,"discussions":[{"author":{"id":1181974,"avatar":"https://static001.geekbang.org/account/avatar/00/12/09/16/1161017c.jpg","nickname":"罗剑锋","note":"","ucode":"95678C988F24AB","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":457740,"discussion_content":"在这个场景里B是“第三方cookie”，不是A设置的，所以只要在页面里嵌入了B相关的代码，就会带上B的cookie。\n\n完全弄清楚可能还需要一点html的知识。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1562754968,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":112279,"user_name":"业余爱好者","can_delete":false,"product_type":"c1","uid":1482915,"ip_address":"","ucode":"A890935A982988","user_header":"https://static001.geekbang.org/account/avatar/00/16/a0/a3/8da99bb0.jpg","comment_is_top":false,"comment_ctime":1562714574,"is_pvip":false,"replies":[{"id":"40823","content":"1不对，max-age=0，就是立即过期，不允许缓存，只能在浏览器运行期间有效。","user_name":"作者回复","user_name_real":"chrono","uid":"1181974","ctime":1562720191,"ip_address":"","comment_id":112279,"utype":1}],"discussion_count":1,"race_medal":0,"score":"18742583758","product_id":100029001,"comment_content":"1.Max-Age: 是永久有效的意思。 <br>2.cookie在浏览器端禁用，还有就是安全性，因为在本地是明文存储的","like_count":4,"discussions":[{"author":{"id":1181974,"avatar":"https://static001.geekbang.org/account/avatar/00/12/09/16/1161017c.jpg","nickname":"罗剑锋","note":"","ucode":"95678C988F24AB","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":457654,"discussion_content":"1不对，max-age=0，就是立即过期，不允许缓存，只能在浏览器运行期间有效。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1562720191,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":165959,"user_name":"許敲敲","can_delete":false,"product_type":"c1","uid":1046681,"ip_address":"","ucode":"6486466820E7BF","user_header":"https://static001.geekbang.org/account/avatar/00/0f/f8/99/8e760987.jpg","comment_is_top":false,"comment_ctime":1577351362,"is_pvip":false,"replies":[{"id":"63313","content":"session是指服务器保持与客户端的会话过程，利用了cookie来存储会话信息，它是服务器上的概念。<br><br>session本身与http关系不大，是在http的应用过程中出现的，基于cookie，是cookie的一个具体应用实例。","user_name":"作者回复","user_name_real":"chrono","uid":"1181974","ctime":1577407330,"ip_address":"","comment_id":165959,"utype":1}],"discussion_count":1,"race_medal":0,"score":"14462253250","product_id":100029001,"comment_content":"还有个名词，session 这个适合cookie放在一起的，这个老师能简单解释下嘛？","like_count":3,"discussions":[{"author":{"id":1181974,"avatar":"https://static001.geekbang.org/account/avatar/00/12/09/16/1161017c.jpg","nickname":"罗剑锋","note":"","ucode":"95678C988F24AB","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":479329,"discussion_content":"session是指服务器保持与客户端的会话过程，利用了cookie来存储会话信息，它是服务器上的概念。\n\nsession本身与http关系不大，是在http的应用过程中出现的，基于cookie，是cookie的一个具体应用实例。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1577407330,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":115712,"user_name":"彧豪","can_delete":false,"product_type":"c1","uid":1161233,"ip_address":"","ucode":"8979F477E0BC5B","user_header":"https://static001.geekbang.org/account/avatar/00/11/b8/11/26838646.jpg","comment_is_top":false,"comment_ctime":1563703713,"is_pvip":false,"replies":[{"id":"42320","content":"有些公司为了兼容性还是用cookie的。","user_name":"作者回复","user_name_real":"chrono","uid":"1181974","ctime":1563757156,"ip_address":"","comment_id":115712,"utype":1}],"discussion_count":5,"race_medal":0,"score":"14448605601","product_id":100029001,"comment_content":"话说现在还有用cookie的吗？感觉似乎不是太安全吧，毕竟各种明文传输，我司是这么做的：浏览器登录成功, 服务端会设置一个密文的cookie, 然后浏览器再用带着这个cookie值的请求头字段去请求用户信息的接口来获取用户信息, 当然了还有其他的头字段，然后登陆之类的接口中的相应头也看不到set-cookie字段，但是浏览器的cookie中却能被设置上一个cookie键值对，以及是密文的","like_count":3,"discussions":[{"author":{"id":1181974,"avatar":"https://static001.geekbang.org/account/avatar/00/12/09/16/1161017c.jpg","nickname":"罗剑锋","note":"","ucode":"95678C988F24AB","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":459246,"discussion_content":"有些公司为了兼容性还是用cookie的。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1563757156,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":2376330,"avatar":"https://thirdwx.qlogo.cn/mmopen/vi_32/Tn4t88aTyAtBWEySTyLnSn6lYGVFWcqLdba7akIWKzEiayt96icYb25P2RFR70pqg552HibJBXArDI1dK5zH7tBTg/132","nickname":"Geek_72d669","note":"","ucode":"5058E34679E9FB","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":336224,"discussion_content":"jwt?","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1608533768,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":1,"child_discussions":[{"author":{"id":1161233,"avatar":"https://static001.geekbang.org/account/avatar/00/11/b8/11/26838646.jpg","nickname":"彧豪","note":"","ucode":"8979F477E0BC5B","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":2376330,"avatar":"https://thirdwx.qlogo.cn/mmopen/vi_32/Tn4t88aTyAtBWEySTyLnSn6lYGVFWcqLdba7akIWKzEiayt96icYb25P2RFR70pqg552HibJBXArDI1dK5zH7tBTg/132","nickname":"Geek_72d669","note":"","ucode":"5058E34679E9FB","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":349656,"discussion_content":"嗯，是的","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1613437558,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":336224,"ip_address":""},"score":349656,"extra":""}]},{"author":{"id":1161233,"avatar":"https://static001.geekbang.org/account/avatar/00/11/b8/11/26838646.jpg","nickname":"彧豪","note":"","ucode":"8979F477E0BC5B","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":2525,"discussion_content":"不过老师你说的兼容性怎么理解呢，意思是有的浏览器不支持某些自定义的请求字段，还是不支持那种不用set-cookie头来设置cookie的方式呢？","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1563760292,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1161233,"avatar":"https://static001.geekbang.org/account/avatar/00/11/b8/11/26838646.jpg","nickname":"彧豪","note":"","ucode":"8979F477E0BC5B","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":2521,"discussion_content":"哦哦哦，原来如此","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1563759182,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":112773,"user_name":"院长。","can_delete":false,"product_type":"c1","uid":1153546,"ip_address":"","ucode":"DF56871F42A868","user_header":"https://static001.geekbang.org/account/avatar/00/11/9a/0a/da55228e.jpg","comment_is_top":false,"comment_ctime":1562823103,"is_pvip":false,"replies":[{"id":"40998","content":"感觉是dns域名解析被缓存了，走了其他真实网站，没有使用本地的hosts文件，可能要清理系统的域名缓存，具体方法可以搜一下。","user_name":"作者回复","user_name_real":"chrono","uid":"1181974","ctime":1562825582,"ip_address":"","comment_id":112773,"utype":1}],"discussion_count":1,"race_medal":0,"score":"14447724991","product_id":100029001,"comment_content":"老师我是那个回复URI会跳转的那个，其他的测试案例也都会跳转。<br>您说的实验环境openresty需要我配置什么嘛？我应该是顺着看您的文章的，您专栏里哪一章有介绍我漏看的吗？<br>如果是我漏看的麻烦老师说下在哪一节，谢谢老师啦。","like_count":3,"discussions":[{"author":{"id":1181974,"avatar":"https://static001.geekbang.org/account/avatar/00/12/09/16/1161017c.jpg","nickname":"罗剑锋","note":"","ucode":"95678C988F24AB","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":457907,"discussion_content":"感觉是dns域名解析被缓存了，走了其他真实网站，没有使用本地的hosts文件，可能要清理系统的域名缓存，具体方法可以搜一下。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1562825582,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":226514,"user_name":"Maske","can_delete":false,"product_type":"c1","uid":1696847,"ip_address":"","ucode":"A19BB41A47E852","user_header":"https://static001.geekbang.org/account/avatar/00/19/e4/4f/df6d810d.jpg","comment_is_top":false,"comment_ctime":1592127143,"is_pvip":true,"replies":[{"id":"83416","content":"good","user_name":"作者回复","user_name_real":"罗剑锋","uid":"1181974","ctime":1592144220,"ip_address":"","comment_id":226514,"utype":1}],"discussion_count":1,"race_medal":0,"score":"10182061735","product_id":100029001,"comment_content":"samesite的加入是为了在一定程度上防范CSRF，比如a.com页面中有个恶意表单，提交url为b.com的域名为开头且为银行转账接口地址，且为post请求，用户误操作后会将本地cookie（domain为b.com）发送，导致账户损失，设置samesite为Lax后可避免该cookie的发送，防止该情况出现。","like_count":2,"discussions":[{"author":{"id":1181974,"avatar":"https://static001.geekbang.org/account/avatar/00/12/09/16/1161017c.jpg","nickname":"罗剑锋","note":"","ucode":"95678C988F24AB","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":498271,"discussion_content":"good","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1592144220,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":199119,"user_name":"钱","can_delete":false,"product_type":"c1","uid":1009652,"ip_address":"","ucode":"2C92A243A463D4","user_header":"https://static001.geekbang.org/account/avatar/00/0f/67/f4/9a1feb59.jpg","comment_is_top":false,"comment_ctime":1585479022,"is_pvip":false,"replies":[{"id":"74799","content":"<br>1.-1好像和0是等效的，时间长有点记不清了，你可以看一下rfc。<br><br>2.总结的不错。","user_name":"作者回复","user_name_real":"chrono","uid":"1181974","ctime":1585530879,"ip_address":"","comment_id":199119,"utype":1}],"discussion_count":1,"race_medal":0,"score":"10175413614","product_id":100029001,"comment_content":"1：如果 Cookie 的 Max-Age 属性设置为 0，会有什么效果呢？<br>有效期为0秒，那就是服务器委托给浏览器暂存的信息，在浏览器一关闭时就失效。<br>如果想设置Cookie永不过期，怎么搞设置一个超大过期时间嘛？特殊值-1行不行？<br><br>2：Cookie 的好处已经很清楚了，你觉得它有什么缺点呢？<br>Cookie好处是能够保持状态信息，同样这个特点也是坏处尤其是被不怀好意的人获取之后。除此之外多传信息总会占用更多的带宽，降低传输效率，不过想传多一点也不行她的大小也是有限制的。所以，出现了别的存储技术来解决这个问题。<br>","like_count":2,"discussions":[{"author":{"id":1181974,"avatar":"https://static001.geekbang.org/account/avatar/00/12/09/16/1161017c.jpg","nickname":"罗剑锋","note":"","ucode":"95678C988F24AB","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":489787,"discussion_content":"\n1.-1好像和0是等效的，时间长有点记不清了，你可以看一下rfc。\n\n2.总结的不错。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1585530879,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":178494,"user_name":"quaeast","can_delete":false,"product_type":"c1","uid":1291207,"ip_address":"","ucode":"E28AD41FBE89B7","user_header":"https://static001.geekbang.org/account/avatar/00/13/b3/c7/57e789fe.jpg","comment_is_top":false,"comment_ctime":1581710513,"is_pvip":false,"replies":[{"id":"69238","content":"Cookie是存在客户端的，session是存在服务器的，都是用来保存用户的会话信息。<br><br>Cookie属于http协议的规定，而session不是协议规定，只是服务器的一种实现方式。","user_name":"作者回复","user_name_real":"chrono","uid":"1181974","ctime":1581731893,"ip_address":"","comment_id":178494,"utype":1}],"discussion_count":2,"race_medal":0,"score":"10171645105","product_id":100029001,"comment_content":"老师您好，我一只搞不懂cookie和session的区别","like_count":3,"discussions":[{"author":{"id":1181974,"avatar":"https://static001.geekbang.org/account/avatar/00/12/09/16/1161017c.jpg","nickname":"罗剑锋","note":"","ucode":"95678C988F24AB","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":483849,"discussion_content":"Cookie是存在客户端的，session是存在服务器的，都是用来保存用户的会话信息。\n\nCookie属于http协议的规定，而session不是协议规定，只是服务器的一种实现方式。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1581731893,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":2033513,"avatar":"https://static001.geekbang.org/account/avatar/00/1f/07/69/43cf2251.jpg","nickname":"Alan He","note":"","ucode":"A0780F4619D388","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":379106,"discussion_content":"客户端有session级cookie。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1623685254,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":171492,"user_name":"GitHubGanKai","can_delete":false,"product_type":"c1","uid":1477351,"ip_address":"","ucode":"BF6D6F8F3EED31","user_header":"https://static001.geekbang.org/account/avatar/00/16/8a/e7/a6c603cf.jpg","comment_is_top":false,"comment_ctime":1578930893,"is_pvip":false,"replies":[{"id":"66472","content":"<br>1.cookie并不是需要登录才会产生，而是用来记录网站的信息，比如你不登录，它也可以记录访问时间、历史记录等，可以理解成是当做一个匿名的guest用户。<br><br>2.同理，session在服务器端保存的是用户的信息，只要你登录网站，就可以认为是一个匿名用户，就可以产生session。当然网站也可以不记录，决定权在它自己。<br><br>3.每次http请求都是一个来回，是在一个tcp上发送的，所以肯定不会乱。但因为http是无状态的，如果不用cookie，就无法区分每次请求是否为同一个用户。所以，通常的做法是在cookie里把你当做一个匿名用户。","user_name":"作者回复","user_name_real":"chrono","uid":"1181974","ctime":1578963720,"ip_address":"","comment_id":171492,"utype":1}],"discussion_count":2,"race_medal":0,"score":"10168865485","product_id":100029001,"comment_content":"老师，有几个问题我不是很明白1⃣️：如果用户没有登录，浏览器向服务器发送请求的时候，是否还会产生cookie呢？如果会产生，那么用来干嘛呢？2⃣️：有关session，他是保存在服务器上的，如果用户没有登录，服务器是否还会产生session吗？我的理解是：应该不会产生吧！毕竟服务器保存session需要额外的空间！而且用户又没有登录，保存它做什么呢🤔？3⃣️：假设现在有三个浏览器，一个在深圳，一个在北京，一个在上海，它们都是没有登录的，同时访问同一台服务器，假设没有session的存在，会出现服务器返回数据的时候，出现无法一一对应的情况吗？就是，本来这个响应是返回给深圳那个浏览器的，结果错乱的发送给北京的那台浏览器去了！","like_count":2,"discussions":[{"author":{"id":1181974,"avatar":"https://static001.geekbang.org/account/avatar/00/12/09/16/1161017c.jpg","nickname":"罗剑锋","note":"","ucode":"95678C988F24AB","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":481379,"discussion_content":"\n1.cookie并不是需要登录才会产生，而是用来记录网站的信息，比如你不登录，它也可以记录访问时间、历史记录等，可以理解成是当做一个匿名的guest用户。\n\n2.同理，session在服务器端保存的是用户的信息，只要你登录网站，就可以认为是一个匿名用户，就可以产生session。当然网站也可以不记录，决定权在它自己。\n\n3.每次http请求都是一个来回，是在一个tcp上发送的，所以肯定不会乱。但因为http是无状态的，如果不用cookie，就无法区分每次请求是否为同一个用户。所以，通常的做法是在cookie里把你当做一个匿名用户。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1578963720,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1477351,"avatar":"https://static001.geekbang.org/account/avatar/00/16/8a/e7/a6c603cf.jpg","nickname":"GitHubGanKai","note":"","ucode":"BF6D6F8F3EED31","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":135953,"discussion_content":"您的第三个回答中：1⃣️“每次http请求都是一个来回，是在一个tcp上发送的，肯定不会乱”。如果翻译成白话文，可不可以这么理解：比如A发送了一次http请求给服务器，服务器肯定知道，他要返回的数据是给A的，把tcp链接比喻成水管，只要tcp没有断开，服务器就可以顺着这个管道将数据返回回去，不会乱。这样理解对吗？2⃣️：然后，我非常不能理解的就是这个“同一个用户”。假设有这么一个场景：就是现在有A和B两个人，都是属于已经登录成功的状态，同时在访问同一个网站，第一步:A发送http请求，服务器也成功返回了数据，A也成功接收到了响应(这个时候产生cookie)，第二步：B也和A一样，发送同样的请求，服务器也返回成功了(也有cooke)，第三步：如果A再次发送一个http请求，这个时候，由于http协议无状态，服务器就需要在cookie中去找，看一下这次请求是谁发的，看下还是不是第二步中B发来的请求，结果查看一下cookie中的sessionId发现，不是刚才的B，而是A，所以就需要用cookie来区分是否为同一个人！不知道是不是这样理解的同一个人的概念。3⃣️，假设2⃣️中没有理解错误，如果假设两个人都属于未登录的游客状态，那么，服务器在每次处理请求的时候，是不是就可以不用区分是否是同一个人了呢？因为都是未登录状态，如果是A发来的请求，服务器也知道顺着tcp管道，将响应返回给A，不会发错数据，干嘛还要多此一举，还要记录一下，每一次是谁在请求我。你请求我的数据，我返回给你就是了，干嘛还需要知道前后请求是否是同一个人呢？你又没有登录，我是这样理解的，希望老师能指导一下，🙏！","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1579103136,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":112513,"user_name":"居培波","can_delete":false,"product_type":"c1","uid":1437396,"ip_address":"","ucode":"27A5A8D9D4682B","user_header":"https://static001.geekbang.org/account/avatar/00/15/ee/d4/204d0c6d.jpg","comment_is_top":false,"comment_ctime":1562749444,"is_pvip":false,"replies":[{"id":"40931","content":"√","user_name":"作者回复","user_name_real":"chrono","uid":"1181974","ctime":1562754412,"ip_address":"","comment_id":112513,"utype":1}],"discussion_count":1,"race_medal":0,"score":"10152684036","product_id":100029001,"comment_content":"正常需要服务器输出cookie值value时会加密，这样稍安全点。","like_count":2,"discussions":[{"author":{"id":1181974,"avatar":"https://static001.geekbang.org/account/avatar/00/12/09/16/1161017c.jpg","nickname":"罗剑锋","note":"","ucode":"95678C988F24AB","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":457773,"discussion_content":"√","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1562754412,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":112485,"user_name":"威~~微冷。。。","can_delete":false,"product_type":"c1","uid":1241648,"ip_address":"","ucode":"4F338B722AA252","user_header":"https://static001.geekbang.org/account/avatar/00/12/f2/30/76cbc52f.jpg","comment_is_top":false,"comment_ctime":1562744601,"is_pvip":false,"replies":[{"id":"40932","content":"是的，相对于你自己扮演了浏览器的角色。<br><br>不过也许api提供了类似的整合功能，需要查一下资料。","user_name":"作者回复","user_name_real":"chrono","uid":"1181974","ctime":1562754476,"ip_address":"","comment_id":112485,"utype":1}],"discussion_count":2,"race_medal":0,"score":"10152679193","product_id":100029001,"comment_content":"收获不少。老师说的这些多是建立在浏览器也就是B&#47;S模式下，浏览器帮忙解析并本地存储，在发起请求的时候请求头还自动加上cookie。那要是C&#47;S模式下，脱离了浏览器，比如说安卓客户端，这时候要达到类似cookie这样的效果，是不是需要安卓开发人员自己解析响应，然后再存储，最后再组装请求体像后台服务器发请求吗？？？","like_count":2,"discussions":[{"author":{"id":1181974,"avatar":"https://static001.geekbang.org/account/avatar/00/12/09/16/1161017c.jpg","nickname":"罗剑锋","note":"","ucode":"95678C988F24AB","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":457758,"discussion_content":"是的，相对于你自己扮演了浏览器的角色。\n\n不过也许api提供了类似的整合功能，需要查一下资料。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1562754476,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":2913864,"avatar":"https://thirdwx.qlogo.cn/mmopen/vi_32/MYShyjtRtib2GIQiaK4hV3ZP9pQ1qiaS74DA4K4YHY4SIiaFDfsCKgiaMWwm9zFsSn3bt5pawp5Kdn5MWgiaw5909nug/132","nickname":"Geek_aa1c31","note":"","ucode":"1AC14C053638AF","race_medal":0,"user_type":1,"is_pvip":true},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":556505,"discussion_content":"这个问题提的很棒!!!","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1647404248,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":315511,"user_name":"陈坚泓","can_delete":false,"product_type":"c1","uid":2461961,"ip_address":"","ucode":"75258EE1BF1C2A","user_header":"https://static001.geekbang.org/account/avatar/00/25/91/09/6f0b987a.jpg","comment_is_top":false,"comment_ctime":1633914781,"is_pvip":false,"replies":[{"id":"114206","content":"我对前端不是太了解，这里说的广告代码，应该不止是js、还会有其他的一些HTML代码，比如用个div图层、link标签等。","user_name":"作者回复","user_name_real":"罗剑锋","uid":"1181974","ctime":1633919255,"ip_address":"","comment_id":315511,"utype":1}],"discussion_count":1,"race_medal":0,"score":"5928882077","product_id":100029001,"comment_content":"罗老师好 <br>看到您回答广告追踪的问题说<br>网站的页面里会嵌入很多广告代码<br><br>这个嵌入广告代码是指网站引入广告方的js代码嘛","like_count":1,"discussions":[{"author":{"id":1181974,"avatar":"https://static001.geekbang.org/account/avatar/00/12/09/16/1161017c.jpg","nickname":"罗剑锋","note":"","ucode":"95678C988F24AB","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":528045,"discussion_content":"我对前端不是太了解，这里说的广告代码，应该不止是js、还会有其他的一些HTML代码，比如用个div图层、link标签等。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1633919255,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":304611,"user_name":"Unknown element","can_delete":false,"product_type":"c1","uid":2028277,"ip_address":"","ucode":"34A129800D0238","user_header":"https://static001.geekbang.org/account/avatar/00/1e/f2/f5/b82f410d.jpg","comment_is_top":false,"comment_ctime":1627522462,"is_pvip":false,"replies":[{"id":"110311","content":"cookie只是一个小标签，谁生成的不重要，服务器不需要存储，可以用简单的算法来验证。","user_name":"作者回复","user_name_real":"罗剑锋","uid":"1181974","ctime":1627712627,"ip_address":"","comment_id":304611,"utype":1}],"discussion_count":2,"race_medal":0,"score":"5922489758","product_id":100029001,"comment_content":"老师cookie应该不止浏览器需要存储吧 服务器是不是也得存储 否则它怎么知道这个cookie是它生成的呢","like_count":1,"discussions":[{"author":{"id":1181974,"avatar":"https://static001.geekbang.org/account/avatar/00/12/09/16/1161017c.jpg","nickname":"罗剑锋","note":"","ucode":"95678C988F24AB","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":524101,"discussion_content":"cookie只是一个小标签，谁生成的不重要，服务器不需要存储，可以用简单的算法来验证。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1627712627,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":2913864,"avatar":"https://thirdwx.qlogo.cn/mmopen/vi_32/MYShyjtRtib2GIQiaK4hV3ZP9pQ1qiaS74DA4K4YHY4SIiaFDfsCKgiaMWwm9zFsSn3bt5pawp5Kdn5MWgiaw5909nug/132","nickname":"Geek_aa1c31","note":"","ucode":"1AC14C053638AF","race_medal":0,"user_type":1,"is_pvip":true},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":556506,"discussion_content":"原来服务器可以不用存储cookie, 用简单的算法来验证就可以, 学到了!!!!!!","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1647404658,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":296737,"user_name":"小何","can_delete":false,"product_type":"c1","uid":1067516,"ip_address":"","ucode":"EFD72AB3CA2AF7","user_header":"https://static001.geekbang.org/account/avatar/00/10/49/fc/5627215c.jpg","comment_is_top":false,"comment_ctime":1623139595,"is_pvip":true,"replies":[{"id":"107820","content":"这样做应该是允许的，因为cookie就是个字符串，但浏览器是否会对此做检查就不太清楚了，可以自己做实验试试。","user_name":"作者回复","user_name_real":"罗剑锋","uid":"1181974","ctime":1623200857,"ip_address":"","comment_id":296737,"utype":1}],"discussion_count":2,"race_medal":0,"score":"5918106891","product_id":100029001,"comment_content":"老师好，我想问一下细节问题，Cookie中Domain可以设置为另外一个一级域名吗，比如当前请求是A.com，Domain可以设置为B.com，这样发送请求给B.com，也会带上这个cookie？","like_count":1,"discussions":[{"author":{"id":1181974,"avatar":"https://static001.geekbang.org/account/avatar/00/12/09/16/1161017c.jpg","nickname":"罗剑锋","note":"","ucode":"95678C988F24AB","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":521568,"discussion_content":"这样做应该是允许的，因为cookie就是个字符串，但浏览器是否会对此做检查就不太清楚了，可以自己做实验试试。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1623200857,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1067516,"avatar":"https://static001.geekbang.org/account/avatar/00/10/49/fc/5627215c.jpg","nickname":"小何","note":"","ucode":"EFD72AB3CA2AF7","race_medal":0,"user_type":1,"is_pvip":true},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":378460,"discussion_content":"谢谢老师！我在谷歌浏览器上试了一下，浏览器会有检验，并不会发送cookie给B.com，也就是跨一级域名是不能设置cookie成功的。但是，如果设置成一级域名，是可以在不同的二级域名下共享cookie的。","likes_number":1,"is_delete":false,"is_hidden":false,"ctime":1623231930,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":168960,"user_name":"Wr","can_delete":false,"product_type":"c1","uid":1713790,"ip_address":"","ucode":"738B316AA2AD66","user_header":"https://static001.geekbang.org/account/avatar/00/1a/26/7e/823c083e.jpg","comment_is_top":false,"comment_ctime":1578226027,"is_pvip":false,"replies":[{"id":"65568","content":"<br>1.max-age=0比较特殊，表示cookie仅在浏览器的打开期间有效。max-age优先级高于expires，但还是要看浏览器自己的策略。<br><br>2.安全是一方面，另一个缺点是影响性能，过多的cookie增加了传输的数据量。","user_name":"作者回复","user_name_real":"chrono","uid":"1181974","ctime":1578274659,"ip_address":"","comment_id":168960,"utype":1}],"discussion_count":1,"race_medal":0,"score":"5873193323","product_id":100029001,"comment_content":"1. 那这个cookie就是无效的吧（如果同时存在Expires和Max-Age，Max-Age为0，也是优先Max-Age吗？）<br>2. cookie优化了客户端与服务器的连接过程，如果cookie泄露，这个过程不仅仅是面对用户，也是面对黑客的","like_count":1,"discussions":[{"author":{"id":1181974,"avatar":"https://static001.geekbang.org/account/avatar/00/12/09/16/1161017c.jpg","nickname":"罗剑锋","note":"","ucode":"95678C988F24AB","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":480388,"discussion_content":"\n1.max-age=0比较特殊，表示cookie仅在浏览器的打开期间有效。max-age优先级高于expires，但还是要看浏览器自己的策略。\n\n2.安全是一方面，另一个缺点是影响性能，过多的cookie增加了传输的数据量。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1578274659,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":154231,"user_name":"answer宫","can_delete":false,"product_type":"c1","uid":1114020,"ip_address":"","ucode":"54CA51DE2BE829","user_header":"https://static001.geekbang.org/account/avatar/00/10/ff/a4/55520286.jpg","comment_is_top":false,"comment_ctime":1574394131,"is_pvip":false,"replies":[{"id":"59264","content":"按照rfc的标准，4k的限制是单个cookie的大小。<br><br>很显然，如果总和不超过4k，那现在的大部分网站就都无法正常工作了。","user_name":"作者回复","user_name_real":"chrono","uid":"1181974","ctime":1574409591,"ip_address":"","comment_id":154231,"utype":1}],"discussion_count":2,"race_medal":0,"score":"5869361427","product_id":100029001,"comment_content":"老师,有个疑问,应该是单个cookie大小不能超过4k吧,而不是总共大小不超过4k吧,我看了很多资料,怎么说的都有","like_count":1,"discussions":[{"author":{"id":1181974,"avatar":"https://static001.geekbang.org/account/avatar/00/12/09/16/1161017c.jpg","nickname":"罗剑锋","note":"","ucode":"95678C988F24AB","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":475412,"discussion_content":"按照rfc的标准，4k的限制是单个cookie的大小。\n\n很显然，如果总和不超过4k，那现在的大部分网站就都无法正常工作了。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1574409591,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1114020,"avatar":"https://static001.geekbang.org/account/avatar/00/10/ff/a4/55520286.jpg","nickname":"answer宫","note":"","ucode":"54CA51DE2BE829","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":65636,"discussion_content":"嗯，觉得小贴士的第二点可以说的更清楚点，我就是在这误解了，谢谢","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1575017466,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":125840,"user_name":"Cris","can_delete":false,"product_type":"c1","uid":1473520,"ip_address":"","ucode":"F8A287134F1078","user_header":"https://static001.geekbang.org/account/avatar/00/16/7b/f0/269139d5.jpg","comment_is_top":false,"comment_ctime":1566264425,"is_pvip":false,"replies":[{"id":"46530","content":"<br>1.不完全正确。session是为了保持网站业务的会话状态，需要服务器在内存里用数据结构跟踪用户的状态，session需要基于Cookie来实现。<br><br>2.对。","user_name":"作者回复","user_name_real":"chrono","uid":"1181974","ctime":1566354708,"ip_address":"","comment_id":125840,"utype":1}],"discussion_count":1,"race_medal":0,"score":"5861231721","product_id":100029001,"comment_content":"老师我可不可以这样理解：<br>1、cookie是存储在浏览器里的，不安全，为了解决安全性问题就出现了session(存储在服务器上)；<br>2、cookie有数量和大小的限制，于是就有了localstorage 和sessionstorage;","like_count":1,"discussions":[{"author":{"id":1181974,"avatar":"https://static001.geekbang.org/account/avatar/00/12/09/16/1161017c.jpg","nickname":"罗剑锋","note":"","ucode":"95678C988F24AB","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":463714,"discussion_content":"\n1.不完全正确。session是为了保持网站业务的会话状态，需要服务器在内存里用数据结构跟踪用户的状态，session需要基于Cookie来实现。\n\n2.对。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1566354708,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":112742,"user_name":"院长。","can_delete":false,"product_type":"c1","uid":1153546,"ip_address":"","ucode":"DF56871F42A868","user_header":"https://static001.geekbang.org/account/avatar/00/11/9a/0a/da55228e.jpg","comment_is_top":false,"comment_ctime":1562813155,"is_pvip":false,"replies":[{"id":"40993","content":"之前的测试用例是否正常？可能是域名解析到外网了，没有走实验环境的openresty。","user_name":"作者回复","user_name_real":"chrono","uid":"1181974","ctime":1562818343,"ip_address":"","comment_id":112742,"utype":1}],"discussion_count":1,"race_medal":0,"score":"5857780451","product_id":100029001,"comment_content":"为什么我输入http:&#47;&#47;www.chrono.com&#47;19-1之后，很快就跳到另外一个URI了呀，我还没来得及看network里面的19-1，就给跳没了。<br>另一个URI(里面包含detecdor.js，favicon.ico，redirect.php......，tcerider.php......等四个文件):http:&#47;&#47;www.chrono.com&#47;search&#47;tcerider.php?f=http%3A%2F%2F660.dragonparking.com%2F%3Fsite%3Dchrono.com%26t%3D1562811636000%26s%3Deab4b898c9f4e1c6333ee353d2b8cfdc%26fs%3D0%26channel%3D480306&amp;amp;v=YWE2MDE5OTEyYjg2MjRkNTYxN2Y4YjA1MGIzNjNjM2QJMQl3d3cuY2hyb25vLmNvbTVkMjY5Y2Y0OGQ0NjkyLjY0NjM1MDA4CXd3dy5jaHJvbm8uY29tNWQyNjljZjQ4ZDRjNjYuOTc5MjA5NDgJMTU2MjgxMTYzNglhZF80NF8w&amp;amp;l=NglBRFMJNTk4MmNiYjYyZmVhNTQ4ZDA0ZDk3OTg4MjUyZWYwZDYJMAk4CQkzMQkxCTEJMAkwNzcyNDg5ODc0ZDU4ZDkyMmZkM2QyMmY0ZDRhNmFhNAkJMTgxNzQ4OTMxCWMJMjU3Mzc3MDAwCQljaHJvbm9ncmFwaCx3YXRjaGVzLHVzZWQgd2F0Y2hlc%2BKAjixjaHJvbm9ncmFwaCB3YXRjaGVzLGx1eHVyeSB3YXRjaGVzCTExMDEJNDQJMTUJOTUJMTU2MjgxMTYzNgkwCU4JMAkwCTAJCQkJCQl3d3cuY2hyb25vLmNvbTVkMjY5Y2Y0OGQ0NjkyLjY0NjM1MDA4CTAJCTEJODMwCTEyNjIJMjk1NDI5MTIJCTEyMS4yMjQuMTExLjU%3D","like_count":1,"discussions":[{"author":{"id":1181974,"avatar":"https://static001.geekbang.org/account/avatar/00/12/09/16/1161017c.jpg","nickname":"罗剑锋","note":"","ucode":"95678C988F24AB","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":457889,"discussion_content":"之前的测试用例是否正常？可能是域名解析到外网了，没有走实验环境的openresty。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1562818343,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":112425,"user_name":"响雨","can_delete":false,"product_type":"c1","uid":1581705,"ip_address":"","ucode":"C5FB3A3BC68F92","user_header":"https://static001.geekbang.org/account/avatar/00/18/22/89/73397ccb.jpg","comment_is_top":false,"comment_ctime":1562730935,"is_pvip":false,"replies":[{"id":"40879","content":"√","user_name":"作者回复","user_name_real":"chrono","uid":"1181974","ctime":1562732397,"ip_address":"","comment_id":112425,"utype":1}],"discussion_count":1,"race_medal":0,"score":"5857698231","product_id":100029001,"comment_content":"Max-Age=0，cookie就会马上失效了。cookie的明文存储肯定不安全的。<br>Flask开发中，Flask-session提供了将session_id存储在cookie中的方法，这样cookie就不需要存储敏感数据，通过session_id从后端获取session数据，然后session中存放用户的数据。","like_count":1,"discussions":[{"author":{"id":1181974,"avatar":"https://static001.geekbang.org/account/avatar/00/12/09/16/1161017c.jpg","nickname":"罗剑锋","note":"","ucode":"95678C988F24AB","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":457729,"discussion_content":"√","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1562732397,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":112391,"user_name":"蚂蚁内推+v","can_delete":false,"product_type":"c1","uid":1050508,"ip_address":"","ucode":"24B10AEE54B3FD","user_header":"https://static001.geekbang.org/account/avatar/00/10/07/8c/0d886dcc.jpg","comment_is_top":false,"comment_ctime":1562727959,"is_pvip":false,"replies":[{"id":"40888","content":"这个就是跨站的问题，通常cookie都会设置作用域，浏览器会保证只发给对应的网站，不会那么简单地泄漏。","user_name":"作者回复","user_name_real":"chrono","uid":"1181974","ctime":1562732889,"ip_address":"","comment_id":112391,"utype":1}],"discussion_count":1,"race_medal":0,"score":"5857695255","product_id":100029001,"comment_content":"比如域名A，是不是能获取到用户所有的cookie（包括B域名）这样不是很不安全","like_count":1,"discussions":[{"author":{"id":1181974,"avatar":"https://static001.geekbang.org/account/avatar/00/12/09/16/1161017c.jpg","nickname":"罗剑锋","note":"","ucode":"95678C988F24AB","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":457714,"discussion_content":"这个就是跨站的问题，通常cookie都会设置作用域，浏览器会保证只发给对应的网站，不会那么简单地泄漏。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1562732889,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":112386,"user_name":"我行我素","can_delete":false,"product_type":"c1","uid":1224678,"ip_address":"","ucode":"4C69542FAB0671","user_header":"https://static001.geekbang.org/account/avatar/00/12/af/e6/9c77acff.jpg","comment_is_top":false,"comment_ctime":1562727543,"is_pvip":false,"replies":[{"id":"40880","content":"√","user_name":"作者回复","user_name_real":"chrono","uid":"1181974","ctime":1562732423,"ip_address":"","comment_id":112386,"utype":1}],"discussion_count":1,"race_medal":0,"score":"5857694839","product_id":100029001,"comment_content":"1.立即失效，即每次访问都会重新设置cookie<br>2.安全性问题，还有就是隐私的烦恼；","like_count":1,"discussions":[{"author":{"id":1181974,"avatar":"https://static001.geekbang.org/account/avatar/00/12/09/16/1161017c.jpg","nickname":"罗剑锋","note":"","ucode":"95678C988F24AB","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":457713,"discussion_content":"√","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1562732423,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":112337,"user_name":"-W.LI-","can_delete":false,"product_type":"c1","uid":1210699,"ip_address":"","ucode":"3556786538664F","user_header":"https://static001.geekbang.org/account/avatar/00/12/79/4b/740f91ca.jpg","comment_is_top":false,"comment_ctime":1562721861,"is_pvip":false,"replies":[{"id":"40889","content":"网络攻击方面研究的不深，无法给你完整的解答。<br><br>最常见的就是cookie了。","user_name":"作者回复","user_name_real":"chrono","uid":"1181974","ctime":1562733136,"ip_address":"","comment_id":112337,"utype":1}],"discussion_count":1,"race_medal":0,"score":"5857689157","product_id":100029001,"comment_content":"老师好有个问题!不加SameSite的人话夸站请求时会把cookie信息带过去。除了cookie信息还有哪些在夸站时会被浏览器自动带过去啊?","like_count":1,"discussions":[{"author":{"id":1181974,"avatar":"https://static001.geekbang.org/account/avatar/00/12/09/16/1161017c.jpg","nickname":"罗剑锋","note":"","ucode":"95678C988F24AB","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":457684,"discussion_content":"网络攻击方面研究的不深，无法给你完整的解答。\n\n最常见的就是cookie了。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1562733136,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":112335,"user_name":"-W.LI-","can_delete":false,"product_type":"c1","uid":1210699,"ip_address":"","ucode":"3556786538664F","user_header":"https://static001.geekbang.org/account/avatar/00/12/79/4b/740f91ca.jpg","comment_is_top":false,"comment_ctime":1562721662,"is_pvip":false,"replies":[{"id":"40884","content":"不客气。","user_name":"作者回复","user_name_real":"chrono","uid":"1181974","ctime":1562732664,"ip_address":"","comment_id":112335,"utype":1}],"discussion_count":1,"race_medal":0,"score":"5857688958","product_id":100029001,"comment_content":"挺好的，cookie存放在流浪器端，不太安全。我是用java的现在用户数据大多存储在服务器缓存里了。一些不重要的数据可以放在cookie，cookie安全的那些参数，有利有弊吧。设置了设置了domain就没法跨越了，有些场景需要跨越的就不能设了，path太大全局可见不好，太小上级路径取不到就丢了。HttpOnly和SameSite过安全测评的时候都会要求加上。加了肯定会有不方便的地方，前端不怎么会。涨姿势了谢谢老师。<br>","like_count":1,"discussions":[{"author":{"id":1181974,"avatar":"https://static001.geekbang.org/account/avatar/00/12/09/16/1161017c.jpg","nickname":"罗剑锋","note":"","ucode":"95678C988F24AB","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":457682,"discussion_content":"不客气。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1562732664,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":112270,"user_name":"苦行僧","can_delete":false,"product_type":"c1","uid":1055334,"ip_address":"","ucode":"726024A9A9CF44","user_header":"https://static001.geekbang.org/account/avatar/00/10/1a/66/2d9db9ed.jpg","comment_is_top":false,"comment_ctime":1562710917,"is_pvip":false,"replies":[{"id":"40822","content":"对","user_name":"作者回复","user_name_real":"chrono","uid":"1181974","ctime":1562720109,"ip_address":"","comment_id":112270,"utype":1}],"discussion_count":1,"race_medal":0,"score":"5857678213","product_id":100029001,"comment_content":"cookie类似缓存，只不过是存储在客户端，敏感信息容易泄露，所以要慎用存储敏感信息","like_count":1,"discussions":[{"author":{"id":1181974,"avatar":"https://static001.geekbang.org/account/avatar/00/12/09/16/1161017c.jpg","nickname":"罗剑锋","note":"","ucode":"95678C988F24AB","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":457647,"discussion_content":"对","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1562720109,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":344159,"user_name":"Geek_115bc8","can_delete":false,"product_type":"c1","uid":1673843,"ip_address":"","ucode":"71FBC9F02AFE1B","user_header":"http://thirdwx.qlogo.cn/mmopen/vi_32/DYAIOgq83erXRaa98A3zjLDkOibUJV1254aQ4EYFTbSLJuEvD0nXicMNA8pLoxOfHf5kPTbGLXNicg8CPFH3Tn0mA/132","comment_is_top":false,"comment_ctime":1651313233,"is_pvip":false,"replies":[{"id":"125715","content":"这些字段都是一种字面上的约束，如何执行全在于客户端，如果客户端是浏览器那么这些字段就看浏览器是否严格遵守了。","user_name":"作者回复","user_name_real":"编辑","uid":"1181974","ctime":1651540188,"ip_address":"","comment_id":344159,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1651313233","product_id":100029001,"comment_content":"如果不设置cookie的httpOnly的话。<br><br>前端获取cookie。然后随着请求把获取的cookie设置给cookie字段吗？<br><br>但是测试的时候，自己设置的cookie字段并不会发送给服务端啊。（通过nodejs获取不到cookie）","like_count":0,"discussions":[{"author":{"id":1181974,"avatar":"https://static001.geekbang.org/account/avatar/00/12/09/16/1161017c.jpg","nickname":"罗剑锋","note":"","ucode":"95678C988F24AB","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":569727,"discussion_content":"这些字段都是一种字面上的约束，如何执行全在于客户端，如果客户端是浏览器那么这些字段就看浏览器是否严格遵守了。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1651540188,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":344157,"user_name":"Geek_115bc8","can_delete":false,"product_type":"c1","uid":1673843,"ip_address":"","ucode":"71FBC9F02AFE1B","user_header":"http://thirdwx.qlogo.cn/mmopen/vi_32/DYAIOgq83erXRaa98A3zjLDkOibUJV1254aQ4EYFTbSLJuEvD0nXicMNA8pLoxOfHf5kPTbGLXNicg8CPFH3Tn0mA/132","comment_is_top":false,"comment_ctime":1651311276,"is_pvip":false,"replies":[{"id":"125714","content":"cookie规范的制订过程中有很多历史原因，所以偶尔有些问题也不奇怪。","user_name":"作者回复","user_name_real":"编辑","uid":"1181974","ctime":1651540109,"ip_address":"","comment_id":344157,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1651311276","product_id":100029001,"comment_content":"cookie的SameSite=Strict”可以严格限定 Cookie 不能随着跳转链接跨站发送。在发送cookie时，不是就可以对比domain吗。为什么还需要这个？","like_count":0,"discussions":[{"author":{"id":1181974,"avatar":"https://static001.geekbang.org/account/avatar/00/12/09/16/1161017c.jpg","nickname":"罗剑锋","note":"","ucode":"95678C988F24AB","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":569724,"discussion_content":"cookie规范的制订过程中有很多历史原因，所以偶尔有些问题也不奇怪。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1651540110,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":343151,"user_name":"宗麒麟","can_delete":false,"product_type":"c1","uid":1385772,"ip_address":"","ucode":"AC15E3AFAECE3B","user_header":"https://static001.geekbang.org/account/avatar/00/15/25/2c/8f61089f.jpg","comment_is_top":false,"comment_ctime":1650681085,"is_pvip":false,"replies":[{"id":"125392","content":"这个问题比较复杂，我不是专门做前端的，暂时回答不了，看其他同学有没有了解的。","user_name":"作者回复","user_name_real":"编辑","uid":"1181974","ctime":1650859570,"ip_address":"","comment_id":343151,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1650681085","product_id":100029001,"comment_content":"cookie 指定domain 只影响cookie行为，浏览器同源策略还包含localstorage dom等，这些受严格同源约束，有没有办法，那有没有办法让不同源的认为是同源，就像cookie指定了domain一样？","like_count":0,"discussions":[{"author":{"id":1181974,"avatar":"https://static001.geekbang.org/account/avatar/00/12/09/16/1161017c.jpg","nickname":"罗剑锋","note":"","ucode":"95678C988F24AB","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":567223,"discussion_content":"这个问题比较复杂，我不是专门做前端的，暂时回答不了，看其他同学有没有了解的。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1650859570,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":336142,"user_name":"cake","can_delete":false,"product_type":"c1","uid":1966533,"ip_address":"","ucode":"55A7FC6CC1204C","user_header":"https://static001.geekbang.org/account/avatar/00/1e/01/c5/b48d25da.jpg","comment_is_top":false,"comment_ctime":1645952547,"is_pvip":false,"replies":[{"id":"122927","content":"有这个可能，所以在互联网世界里时间一致很重要，也就是要用NTP。","user_name":"作者回复","user_name_real":"编辑","uid":"1181974","ctime":1646115563,"ip_address":"","comment_id":336142,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1645952547","product_id":100029001,"comment_content":"“Max-Age”用的是相对时间，单位是秒，浏览器用收到报文的时间点再加上 Max-Age，就可以得到失效的绝对时间  请问下老师，这样不会导致，服务端认为该Cookie已经失效了(从cookie中取出的信息，但是该信息不能再作为key从缓存中取出value)，但是客户端还在用的情况吗？","like_count":0,"discussions":[{"author":{"id":1181974,"avatar":"https://static001.geekbang.org/account/avatar/00/12/09/16/1161017c.jpg","nickname":"罗剑锋","note":"","ucode":"95678C988F24AB","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":553845,"discussion_content":"有这个可能，所以在互联网世界里时间一致很重要，也就是要用NTP。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1646115563,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":333524,"user_name":"drifter","can_delete":false,"product_type":"c1","uid":2598472,"ip_address":"","ucode":"F81019B9D7F1BB","user_header":"https://static001.geekbang.org/account/avatar/00/27/a6/48/d2004881.jpg","comment_is_top":false,"comment_ctime":1644393531,"is_pvip":false,"replies":[{"id":"121928","content":"不太了解具体业务，不好帮上忙，但借助ngx_lua和njs，在Nginx里开发应该会比较容易做到。","user_name":"作者回复","user_name_real":"编辑","uid":"1181974","ctime":1644546989,"ip_address":"","comment_id":333524,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1644393531","product_id":100029001,"comment_content":"由于SameSite的缘故，后端在响应头中设置了set-cookie，但是因为跨域，浏览器没有把cookie保存下来，导致接下来的请求无法携带这个cookie，这个问题如何通过nginx来解决呢？希望可以大体给个思路","like_count":0,"discussions":[{"author":{"id":1181974,"avatar":"https://static001.geekbang.org/account/avatar/00/12/09/16/1161017c.jpg","nickname":"罗剑锋","note":"","ucode":"95678C988F24AB","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":550446,"discussion_content":"不太了解具体业务，不好帮上忙，但借助ngx_lua和njs，在Nginx里开发应该会比较容易做到。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1644546990,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":327085,"user_name":"Aki","can_delete":false,"product_type":"c1","uid":2807902,"ip_address":"","ucode":"B862D9A2F21480","user_header":"https://static001.geekbang.org/account/avatar/00/2a/d8/5e/3548334f.jpg","comment_is_top":false,"comment_ctime":1639907875,"is_pvip":false,"replies":[{"id":"119019","content":"great","user_name":"作者回复","user_name_real":"编辑","uid":"1181974","ctime":1639985610,"ip_address":"","comment_id":327085,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1639907875","product_id":100029001,"comment_content":"1. 如果 Cookie 的 Max-Age 属性设置为 0，会有什么效果呢？<br>设置为0，服务器0秒就让Cookie失效，即立即失效，服务器不存Cookie。<br>2. Cookie缺点：<br>1. 每次 HTTP 请求都会带上（最大4k），性能差，带宽占用大，占用网络请求<br>2. 不安全。容易被窃取实现攻击。容易被伪造。<br>3. 会被浏览器或用户禁用的风险","like_count":0,"discussions":[{"author":{"id":1181974,"avatar":"https://static001.geekbang.org/account/avatar/00/12/09/16/1161017c.jpg","nickname":"罗剑锋","note":"","ucode":"95678C988F24AB","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":540195,"discussion_content":"great","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1639985610,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":315379,"user_name":"cake","can_delete":false,"product_type":"c1","uid":1966533,"ip_address":"","ucode":"55A7FC6CC1204C","user_header":"https://static001.geekbang.org/account/avatar/00/1e/01/c5/b48d25da.jpg","comment_is_top":false,"comment_ctime":1633870551,"is_pvip":false,"replies":[{"id":"114207","content":"比如说，网上购物，需要先登录、然后查询商品，加入购物车，再结账，这一系列的操作通常是由多个页面也就是说多个http请求来完成的，如果没有cookie来记录状态，那么这些行为就是彼此独立，没有联系。<br><br>有了cookie，那么就把这些活动串联起来了，形成了一个完整的会话活动。","user_name":"作者回复","user_name_real":"罗剑锋","uid":"1181974","ctime":1633919431,"ip_address":"","comment_id":315379,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1633870551","product_id":100029001,"comment_content":"老师 打扰了  会话事务这个概念理解不了 可以举个详细的例子么 ","like_count":0,"discussions":[{"author":{"id":1181974,"avatar":"https://static001.geekbang.org/account/avatar/00/12/09/16/1161017c.jpg","nickname":"罗剑锋","note":"","ucode":"95678C988F24AB","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":527947,"discussion_content":"比如说，网上购物，需要先登录、然后查询商品，加入购物车，再结账，这一系列的操作通常是由多个页面也就是说多个http请求来完成的，如果没有cookie来记录状态，那么这些行为就是彼此独立，没有联系。\n\n有了cookie，那么就把这些活动串联起来了，形成了一个完整的会话活动。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1633919431,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":302207,"user_name":"齐齐","can_delete":false,"product_type":"c1","uid":2663626,"ip_address":"","ucode":"02C328B04A9DC6","user_header":"https://static001.geekbang.org/account/avatar/00/28/a4/ca/be57f01d.jpg","comment_is_top":false,"comment_ctime":1626137963,"is_pvip":false,"replies":[{"id":"109354","content":"当然了，http协议的所有内容都是双方的“纸面”约定，只不过目前的主流浏览器都遵守。","user_name":"作者回复","user_name_real":"罗剑锋","uid":"1181974","ctime":1626152743,"ip_address":"","comment_id":302207,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1626137963","product_id":100029001,"comment_content":"httponly感觉只是个君子协议？我理解的是，如果我自己写个浏览器，或者简单的破解了其他浏览器（Firefox之类都开源吧，把实现的关于httponly安全方面的取消掉），这样也就能js读取了吧。包括跨域名什么的","like_count":0,"discussions":[{"author":{"id":1181974,"avatar":"https://static001.geekbang.org/account/avatar/00/12/09/16/1161017c.jpg","nickname":"罗剑锋","note":"","ucode":"95678C988F24AB","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":523224,"discussion_content":"当然了，http协议的所有内容都是双方的“纸面”约定，只不过目前的主流浏览器都遵守。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1626152743,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":300179,"user_name":"Geek_1a0e29","can_delete":false,"product_type":"c1","uid":1478573,"ip_address":"","ucode":"DFFDEA3A9A23D5","user_header":"https://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTKBS8Xf2qLLpEe6eXkkTr7PPK0WeyHZe7NzP8S8pUGyyfO5SkSSx9E5S4qdtcINAmdfdSXUKWusvA/132","comment_is_top":false,"comment_ctime":1625036379,"is_pvip":false,"replies":[{"id":"108833","content":"不一样的，cookie里可以包含任意的值任意解释，而token是cookie的一种应用，只针对特定场合。","user_name":"作者回复","user_name_real":"罗剑锋","uid":"1181974","ctime":1625048820,"ip_address":"","comment_id":300179,"utype":1}],"discussion_count":2,"race_medal":0,"score":"1625036379","product_id":100029001,"comment_content":"感觉token和cookie是一个意思(都是本地拿个票据访问服务器，确定私有资源)为啥有cookie了又搞个token出来？不是很理解。。。是因为操作cookie不方便么？","like_count":0,"discussions":[{"author":{"id":1181974,"avatar":"https://static001.geekbang.org/account/avatar/00/12/09/16/1161017c.jpg","nickname":"罗剑锋","note":"","ucode":"95678C988F24AB","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":522669,"discussion_content":"不一样的，cookie里可以包含任意的值任意解释，而token是cookie的一种应用，只针对特定场合。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1625048820,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1478573,"avatar":"https://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTKBS8Xf2qLLpEe6eXkkTr7PPK0WeyHZe7NzP8S8pUGyyfO5SkSSx9E5S4qdtcINAmdfdSXUKWusvA/132","nickname":"Geek_1a0e29","note":"","ucode":"DFFDEA3A9A23D5","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":381486,"discussion_content":"想起来cookie可以在本地存储很多东西，哈哈哈，现在基本上都不在本地存放啥了，都忘了。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1625100467,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":298983,"user_name":"Hello world","can_delete":false,"product_type":"c1","uid":2624435,"ip_address":"","ucode":"9DCB5899DC5FE2","user_header":"https://static001.geekbang.org/account/avatar/00/28/0b/b3/c3a26c76.jpg","comment_is_top":false,"comment_ctime":1624415572,"is_pvip":false,"replies":[{"id":"108451","content":"cookie是http协议相关的，用来存放一些网站、用户相关的信息，而token是应用层面添加的，里面的逻辑更多，与应用结合的更紧密。<br><br>其实两者没有什么直接的关系，不应该直接比较。","user_name":"作者回复","user_name_real":"罗剑锋","uid":"1181974","ctime":1624434202,"ip_address":"","comment_id":298983,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1624415572","product_id":100029001,"comment_content":"老师请问一下 cookie和token的区别是啥呢？为啥都说token安全呢？","like_count":0,"discussions":[{"author":{"id":1181974,"avatar":"https://static001.geekbang.org/account/avatar/00/12/09/16/1161017c.jpg","nickname":"罗剑锋","note":"","ucode":"95678C988F24AB","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":522301,"discussion_content":"cookie是http协议相关的，用来存放一些网站、用户相关的信息，而token是应用层面添加的，里面的逻辑更多，与应用结合的更紧密。\n\n其实两者没有什么直接的关系，不应该直接比较。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1624434202,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":295260,"user_name":"X青年","can_delete":false,"product_type":"c1","uid":2010313,"ip_address":"","ucode":"E6EB3CCA7DB1C8","user_header":"https://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTJH3dribPS9AibkGhjN0giaWAa45SD8lCxkStyQrJibl7CPJRDNicvicwM224tHd3gLq2wvWbMAQ70IF6IA/132","comment_is_top":false,"comment_ctime":1622337088,"is_pvip":false,"replies":[{"id":"107190","content":"cookie里就是一些kv数据，所以怎么设置就看网站自己了，当然也有一些大家都约定俗成的字段，可以用浏览器多看看一些网站的cookie。","user_name":"作者回复","user_name_real":"罗剑锋","uid":"1181974","ctime":1622368656,"ip_address":"","comment_id":295260,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1622337088","product_id":100029001,"comment_content":"老师，cookie的内容我看有各种形式的，有什么规律吗？或者说我们通过访问一个网站能知道自己的cookie应该是什么吗或者什么样吗？","like_count":0,"discussions":[{"author":{"id":1181974,"avatar":"https://static001.geekbang.org/account/avatar/00/12/09/16/1161017c.jpg","nickname":"罗剑锋","note":"","ucode":"95678C988F24AB","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":521014,"discussion_content":"cookie里就是一些kv数据，所以怎么设置就看网站自己了，当然也有一些大家都约定俗成的字段，可以用浏览器多看看一些网站的cookie。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1622368656,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":286389,"user_name":"树心","can_delete":false,"product_type":"c1","uid":2185229,"ip_address":"","ucode":"DF0B7C3DA3998D","user_header":"https://static001.geekbang.org/account/avatar/00/21/58/0d/5b1e6ab1.jpg","comment_is_top":false,"comment_ctime":1617276869,"is_pvip":false,"replies":[{"id":"104045","content":"max-age优先级高于expires，所以后者就会被忽略。","user_name":"作者回复","user_name_real":"罗剑锋","uid":"1181974","ctime":1617326176,"ip_address":"","comment_id":286389,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1617276869","product_id":100029001,"comment_content":"即使 Expires 的时间比 Max-Age 的时间要早也是按照 Max-Age 的时间来的吗？","like_count":0,"discussions":[{"author":{"id":1181974,"avatar":"https://static001.geekbang.org/account/avatar/00/12/09/16/1161017c.jpg","nickname":"罗剑锋","note":"","ucode":"95678C988F24AB","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":517967,"discussion_content":"max-age优先级高于expires，所以后者就会被忽略。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1617326176,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":283416,"user_name":"刘杰","can_delete":false,"product_type":"c1","uid":2460800,"ip_address":"","ucode":"5B3A55700D6063","user_header":"https://static001.geekbang.org/account/avatar/00/25/8c/80/7310baac.jpg","comment_is_top":false,"comment_ctime":1615775854,"is_pvip":false,"replies":[{"id":"102814","content":"max-age=0表示不存储Cookie，只在浏览器打开期间生效，可参考其他同学的回答。","user_name":"作者回复","user_name_real":"罗剑锋","uid":"1181974","ctime":1615778053,"ip_address":"","comment_id":283416,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1615775854","product_id":100029001,"comment_content":"1、如果Cookie的Max-Age设置为0，那么该Cookie为失效状态<br>2、缺点：存储内容太少、明文存储","like_count":0,"discussions":[{"author":{"id":1181974,"avatar":"https://static001.geekbang.org/account/avatar/00/12/09/16/1161017c.jpg","nickname":"罗剑锋","note":"","ucode":"95678C988F24AB","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":517031,"discussion_content":"max-age=0表示不存储Cookie，只在浏览器打开期间生效，可参考其他同学的回答。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1615778053,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":281600,"user_name":"小童","can_delete":false,"product_type":"c1","uid":1763395,"ip_address":"","ucode":"300444B520E79D","user_header":"https://static001.geekbang.org/account/avatar/00/1a/e8/43/f9c0faed.jpg","comment_is_top":false,"comment_ctime":1614822749,"is_pvip":false,"replies":[{"id":"102247","content":"基本正确，可以再看看其他同学的回答。","user_name":"作者回复","user_name_real":"罗剑锋","uid":"1181974","ctime":1614828835,"ip_address":"","comment_id":281600,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1614822749","product_id":100029001,"comment_content":"1. 如果都为0，意思是不存储cookie信息。<br>2. 缺点：cookie容易伪造。","like_count":0,"discussions":[{"author":{"id":1181974,"avatar":"https://static001.geekbang.org/account/avatar/00/12/09/16/1161017c.jpg","nickname":"罗剑锋","note":"","ucode":"95678C988F24AB","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":516452,"discussion_content":"基本正确，可以再看看其他同学的回答。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1614828835,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":240749,"user_name":"Cris","can_delete":false,"product_type":"c1","uid":1473520,"ip_address":"","ucode":"F8A287134F1078","user_header":"https://static001.geekbang.org/account/avatar/00/16/7b/f0/269139d5.jpg","comment_is_top":false,"comment_ctime":1597052364,"is_pvip":false,"replies":[{"id":"88956","content":"Expires&#47;MAX-AGE属性的标准值应该是时间，session应该是非标准的吧，看意思应该是会话期间有效，浏览器、页面关闭就消失。","user_name":"作者回复","user_name_real":"罗剑锋","uid":"1181974","ctime":1597107368,"ip_address":"","comment_id":240749,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1597052364","product_id":100029001,"comment_content":"请问下cookiede 的Expires&#47;MAX-AGE属性值为session是什么意思？","like_count":0,"discussions":[{"author":{"id":1181974,"avatar":"https://static001.geekbang.org/account/avatar/00/12/09/16/1161017c.jpg","nickname":"罗剑锋","note":"","ucode":"95678C988F24AB","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":503549,"discussion_content":"Expires/MAX-AGE属性的标准值应该是时间，session应该是非标准的吧，看意思应该是会话期间有效，浏览器、页面关闭就消失。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1597107368,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":228430,"user_name":"Demon","can_delete":false,"product_type":"c1","uid":1390641,"ip_address":"","ucode":"58CD838717F36D","user_header":"http://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTIUdfNDQs3eLoIjfIXDm77W66udicLfqh6NA8QX4QuZNO48UlRTfDo2Fm2jGX0z3hjnbARib8wSbxcg/132","comment_is_top":false,"comment_ctime":1592668788,"is_pvip":false,"replies":[{"id":"84247","content":"对，是用多个Cookie字段。<br><br>原来是允许一个Cookie头里有多个Cookie值的，后来被禁用了。","user_name":"作者回复","user_name_real":"罗剑锋","uid":"1181974","ctime":1592722947,"ip_address":"","comment_id":228430,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1592668788","product_id":100029001,"comment_content":"不管是浏览器还是服务端“多个cookie”应该理解为多个cookie还是一个cookie多个字段呢？<br>个人觉得第二种理解更通顺一点。因为cookie的max-age domain path等属性看起来都是统一控制的，而且是跟内容平级的。并不能单独对某个字段进行控制。","like_count":0,"discussions":[{"author":{"id":1181974,"avatar":"https://static001.geekbang.org/account/avatar/00/12/09/16/1161017c.jpg","nickname":"罗剑锋","note":"","ucode":"95678C988F24AB","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":499030,"discussion_content":"对，是用多个Cookie字段。\n\n原来是允许一个Cookie头里有多个Cookie值的，后来被禁用了。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1592722947,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":226503,"user_name":"Maske","can_delete":false,"product_type":"c1","uid":1696847,"ip_address":"","ucode":"A19BB41A47E852","user_header":"https://static001.geekbang.org/account/avatar/00/19/e4/4f/df6d810d.jpg","comment_is_top":false,"comment_ctime":1592124154,"is_pvip":true,"replies":[{"id":"83417","content":"good","user_name":"作者回复","user_name_real":"罗剑锋","uid":"1181974","ctime":1592144228,"ip_address":"","comment_id":226503,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1592124154","product_id":100029001,"comment_content":"1.max-age设置为0，相当于不指定有效期，即为session级别的存储时间，当前页面关闭后就会失效；<br>2.和http1.1一样，为明文传输，传输过程中数据有泄漏或者被篡改的风险，且也明文保存在浏览器本地，也存在泄漏信息的风险","like_count":0,"discussions":[{"author":{"id":1181974,"avatar":"https://static001.geekbang.org/account/avatar/00/12/09/16/1161017c.jpg","nickname":"罗剑锋","note":"","ucode":"95678C988F24AB","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":498268,"discussion_content":"good","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1592144228,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":226406,"user_name":"潇潇雨歇","can_delete":false,"product_type":"c1","uid":1251429,"ip_address":"","ucode":"4BD52BF0F0A084","user_header":"https://static001.geekbang.org/account/avatar/00/13/18/65/35361f02.jpg","comment_is_top":false,"comment_ctime":1592064722,"is_pvip":false,"replies":[{"id":"83392","content":"<br>1.可参考其他同学的回答。<br><br>2.正确。","user_name":"作者回复","user_name_real":"罗剑锋","uid":"1181974","ctime":1592112990,"ip_address":"","comment_id":226406,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1592064722","product_id":100029001,"comment_content":"1、Max-Age为0，即立即过期，也就是cookie没用了<br>2、不够安全，存储小","like_count":0,"discussions":[{"author":{"id":1181974,"avatar":"https://static001.geekbang.org/account/avatar/00/12/09/16/1161017c.jpg","nickname":"罗剑锋","note":"","ucode":"95678C988F24AB","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":498228,"discussion_content":"\n1.可参考其他同学的回答。\n\n2.正确。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1592112990,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":221747,"user_name":"地球外地人","can_delete":false,"product_type":"c1","uid":1966404,"ip_address":"","ucode":"28457E37C632ED","user_header":"https://static001.geekbang.org/account/avatar/00/1e/01/44/3a9b2b69.jpg","comment_is_top":false,"comment_ctime":1590581867,"is_pvip":false,"replies":[{"id":"81776","content":"SameSite: lax是Cookie的安全设置，阻止跨站请求伪造，增强了客户端的安全性。<br><br>作为开发者，在使用Cookie的时候就要当心了，不能随便“耍花招”，老老实实正常用Cookie就好了。","user_name":"作者回复","user_name_real":"罗剑锋","uid":"1181974","ctime":1590617762,"ip_address":"","comment_id":221747,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1590581867","product_id":100029001,"comment_content":"未来chrome80会默认(SameSite: lax)这样的话，对于 各方面的 用户和开发者来说，有什么影响吗","like_count":0,"discussions":[{"author":{"id":1181974,"avatar":"https://static001.geekbang.org/account/avatar/00/12/09/16/1161017c.jpg","nickname":"罗剑锋","note":"","ucode":"95678C988F24AB","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":496552,"discussion_content":"SameSite: lax是Cookie的安全设置，阻止跨站请求伪造，增强了客户端的安全性。\n\n作为开发者，在使用Cookie的时候就要当心了，不能随便“耍花招”，老老实实正常用Cookie就好了。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1590617762,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":215550,"user_name":"Joan","can_delete":false,"product_type":"c1","uid":1693708,"ip_address":"","ucode":"6F9C61BBE51F46","user_header":"https://static001.geekbang.org/account/avatar/00/19/d8/0c/ddde4ae3.jpg","comment_is_top":false,"comment_ctime":1589014727,"is_pvip":false,"replies":[{"id":"79797","content":"说的很好，keep going。","user_name":"作者回复","user_name_real":"chrono","uid":"1181974","ctime":1589026560,"ip_address":"","comment_id":215550,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1589014727","product_id":100029001,"comment_content":"1、如果 Cookie 的 Max-Age 属性设置为 0，会有什么效果呢？那就不会被保存<br>2、Cookie 的好处已经很清楚了，你觉得它有什么缺点呢？<br>因为是浏览器储存，所以一些个人信息有可能被保留，忘记及时删除；<br>会被黑客拿到一些信息，同时会被恶意攻击","like_count":0,"discussions":[{"author":{"id":1181974,"avatar":"https://static001.geekbang.org/account/avatar/00/12/09/16/1161017c.jpg","nickname":"罗剑锋","note":"","ucode":"95678C988F24AB","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":494472,"discussion_content":"说的很好，keep going。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1589026560,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":206476,"user_name":"珈蓝白塔","can_delete":false,"product_type":"c1","uid":1131137,"ip_address":"","ucode":"FADBA4B1EC768D","user_header":"https://static001.geekbang.org/account/avatar/00/11/42/81/788cd471.jpg","comment_is_top":false,"comment_ctime":1586866855,"is_pvip":false,"replies":[{"id":"77222","content":"我实际改了一下脚本local max_age = 0，在Chrome里还是能够看到cookie的，而且expire是0。<br><br>按照rfc，max-age=0表示cookie立即过期，但怎么存是浏览器的事情。","user_name":"作者回复","user_name_real":"chrono","uid":"1181974","ctime":1586927779,"ip_address":"","comment_id":206476,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1586866855","product_id":100029001,"comment_content":"有个疑惑，我在 19-2 的代码里尝试将 Max-Age 属性值设置为 0，清空缓存后重新请求，在浏览器的 Application&#47;Cookies 里啥都没有，这是不是说明即使响应头 set-cookie 有值，但并没有在浏览器本地存储下来啊？","like_count":0,"discussions":[{"author":{"id":1181974,"avatar":"https://static001.geekbang.org/account/avatar/00/12/09/16/1161017c.jpg","nickname":"罗剑锋","note":"","ucode":"95678C988F24AB","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":491806,"discussion_content":"我实际改了一下脚本local max_age = 0，在Chrome里还是能够看到cookie的，而且expire是0。\n\n按照rfc，max-age=0表示cookie立即过期，但怎么存是浏览器的事情。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1586927779,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":200130,"user_name":"杨越","can_delete":false,"product_type":"c1","uid":1651132,"ip_address":"","ucode":"88B933F2096E11","user_header":"https://static001.geekbang.org/account/avatar/00/19/31/bc/4e679d81.jpg","comment_is_top":false,"comment_ctime":1585547910,"is_pvip":false,"replies":[{"id":"74921","content":"按照rfc的解释，负值和0是同样的处理。<br><br>If delta-seconds is less than or equal to zero (0), let expiry-time be the earliest representable date and time. ","user_name":"作者回复","user_name_real":"chrono","uid":"1181974","ctime":1585552963,"ip_address":"","comment_id":200130,"utype":1}],"discussion_count":2,"race_medal":0,"score":"1585547910","product_id":100029001,"comment_content":"cookie中 maxAge设置为负值 和0的区别：<br>1、如果设置为负值的话，则为浏览器进程Cookie(内存中保存)，关闭浏览器就失效；<br>2、如果设置为0，则立即删除该Cookie。","like_count":0,"discussions":[{"author":{"id":1181974,"avatar":"https://static001.geekbang.org/account/avatar/00/12/09/16/1161017c.jpg","nickname":"罗剑锋","note":"","ucode":"95678C988F24AB","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":489942,"discussion_content":"按照rfc的解释，负值和0是同样的处理。\n\nIf delta-seconds is less than or equal to zero (0), let expiry-time be the earliest representable date and time. ","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1585552963,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1651132,"avatar":"https://static001.geekbang.org/account/avatar/00/19/31/bc/4e679d81.jpg","nickname":"杨越","note":"","ucode":"88B933F2096E11","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":217779,"discussion_content":"果然如老师所说，网上的资料众说纷纭不靠谱","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1585579936,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":181198,"user_name":"godliness","can_delete":false,"product_type":"c1","uid":1341267,"ip_address":"","ucode":"1C1976C39DCFE6","user_header":"https://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTIuUYcwKWUuib5mpdIbTwQzTGNWBmk0ktZSwm2vteUXf4TxWF2aVCv7Hvshcq0OaG7JRLj6rJyPLicA/132","comment_is_top":false,"comment_ctime":1582515920,"is_pvip":false,"replies":[{"id":"70285","content":"是的，这也算是 http&#47;1当初设计时的一个失误吧，好在http&#47;2给“挽救”回来了。","user_name":"作者回复","user_name_real":"chrono","uid":"1181974","ctime":1582523528,"ip_address":"","comment_id":181198,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1582515920","product_id":100029001,"comment_content":"《Web性能权威指南》中有提到，网络请求的头的数据，已经很大程度占据整个请求的大部分内容。其中Cookie 就是最大头的，这也是在H2之后加入了默认压缩头部的原因。","like_count":0,"discussions":[{"author":{"id":1181974,"avatar":"https://static001.geekbang.org/account/avatar/00/12/09/16/1161017c.jpg","nickname":"罗剑锋","note":"","ucode":"95678C988F24AB","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":484954,"discussion_content":"是的，这也算是 http/1当初设计时的一个失误吧，好在http/2给“挽救”回来了。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1582523528,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":179312,"user_name":"尔冬橙","can_delete":false,"product_type":"c1","uid":1225224,"ip_address":"","ucode":"0B013A49BC18DA","user_header":"https://static001.geekbang.org/account/avatar/00/12/b2/08/92f42622.jpg","comment_is_top":false,"comment_ctime":1581959100,"is_pvip":false,"replies":[{"id":"69614","content":"session不属于http协议，抱歉了，不过理解了cookie弄懂它就容易了。","user_name":"作者回复","user_name_real":"chrono","uid":"1181974","ctime":1581982411,"ip_address":"","comment_id":179312,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1581959100","product_id":100029001,"comment_content":"正看到高潮，准备下面看老师讲session的。。意犹未尽。还是要夸一下，讲得真好","like_count":0,"discussions":[{"author":{"id":1181974,"avatar":"https://static001.geekbang.org/account/avatar/00/12/09/16/1161017c.jpg","nickname":"罗剑锋","note":"","ucode":"95678C988F24AB","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":484196,"discussion_content":"session不属于http协议，抱歉了，不过理解了cookie弄懂它就容易了。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1581982411,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":171983,"user_name":"神三元","can_delete":false,"product_type":"c1","uid":1202089,"ip_address":"","ucode":"0FB2E7C0683599","user_header":"https://static001.geekbang.org/account/avatar/00/12/57/a9/9abbe7a4.jpg","comment_is_top":false,"comment_ctime":1579061211,"is_pvip":false,"replies":[{"id":"66802","content":"是的，这是在当时的环境下做出的限制。","user_name":"作者回复","user_name_real":"chrono","uid":"1181974","ctime":1579136401,"ip_address":"","comment_id":171983,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1579061211","product_id":100029001,"comment_content":"cookie有个巨大的缺点，就是只有4k大小","like_count":0,"discussions":[{"author":{"id":1181974,"avatar":"https://static001.geekbang.org/account/avatar/00/12/09/16/1161017c.jpg","nickname":"罗剑锋","note":"","ucode":"95678C988F24AB","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":481570,"discussion_content":"是的，这是在当时的环境下做出的限制。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1579136401,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":171982,"user_name":"神三元","can_delete":false,"product_type":"c1","uid":1202089,"ip_address":"","ucode":"0FB2E7C0683599","user_header":"https://static001.geekbang.org/account/avatar/00/12/57/a9/9abbe7a4.jpg","comment_is_top":false,"comment_ctime":1579061031,"is_pvip":false,"replies":[{"id":"66803","content":"没错，进阶是相对于之前的基础的，这些都是http最基本的东西。","user_name":"作者回复","user_name_real":"chrono","uid":"1181974","ctime":1579136444,"ip_address":"","comment_id":171982,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1579061031","product_id":100029001,"comment_content":"说实话，进阶篇讲的是基础内容","like_count":0,"discussions":[{"author":{"id":1181974,"avatar":"https://static001.geekbang.org/account/avatar/00/12/09/16/1161017c.jpg","nickname":"罗剑锋","note":"","ucode":"95678C988F24AB","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":481569,"discussion_content":"没错，进阶是相对于之前的基础的，这些都是http最基本的东西。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1579136444,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":163210,"user_name":"Larry","can_delete":false,"product_type":"c1","uid":1623342,"ip_address":"","ucode":"3495A11DE756BA","user_header":"https://static001.geekbang.org/account/avatar/00/18/c5/2e/0326eefc.jpg","comment_is_top":false,"comment_ctime":1576670420,"is_pvip":false,"replies":[{"id":"62102","content":"这个属于前端的技术了，我不是特别了解，sorry。","user_name":"作者回复","user_name_real":"chrono","uid":"1181974","ctime":1576717302,"ip_address":"","comment_id":163210,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1576670420","product_id":100029001,"comment_content":"如果不设置domain，是不是cookie就可以跨域呢，后续访问的服务器都能取到？","like_count":0,"discussions":[{"author":{"id":1181974,"avatar":"https://static001.geekbang.org/account/avatar/00/12/09/16/1161017c.jpg","nickname":"罗剑锋","note":"","ucode":"95678C988F24AB","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":478298,"discussion_content":"这个属于前端的技术了，我不是特别了解，sorry。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1576717302,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":158385,"user_name":"涯渊","can_delete":false,"product_type":"c1","uid":1443237,"ip_address":"","ucode":"F364D121087F1F","user_header":"https://static001.geekbang.org/account/avatar/00/16/05/a5/69955c34.jpg","comment_is_top":false,"comment_ctime":1575362614,"is_pvip":false,"replies":[{"id":"60674","content":"操作cookie只能使用Set-Cookie，但前端可以把一些变动信息传递给后端，由后端来决定如何更改cookie。","user_name":"作者回复","user_name_real":"chrono","uid":"1181974","ctime":1575421484,"ip_address":"","comment_id":158385,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1575362614","product_id":100029001,"comment_content":"有一个问题不太清楚，就是COOKIE如果需要改动的话，比如说一个用户他是美国的，网站把国家记录下来然后将网站语言设置为当地语言，然后用户更改了他的当地国家更改成中国，这种情况COOKIE的变动是怎么样的呢？我个人认为是用户执行操作的时候POST到后端，然后后端更改了数据库里的相应数据。那么这时候国家的更改是重新SET-COOKIE来保持状态一致吗？还是在前端这里修改的呢？我个人是认为会通过SET-COOKIE重新设置会比较好，但不知道这样可不可以，毕竟大网站那些应该都是有httpOnly这个字段的","like_count":0,"discussions":[{"author":{"id":1181974,"avatar":"https://static001.geekbang.org/account/avatar/00/12/09/16/1161017c.jpg","nickname":"罗剑锋","note":"","ucode":"95678C988F24AB","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":476700,"discussion_content":"操作cookie只能使用Set-Cookie，但前端可以把一些变动信息传递给后端，由后端来决定如何更改cookie。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1575421484,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":150877,"user_name":"李梵松","can_delete":false,"product_type":"c1","uid":1335291,"ip_address":"","ucode":"D79F33876AE230","user_header":"http://thirdwx.qlogo.cn/mmopen/vi_32/4RTKnq96jsQoEnUHhBBzVVpib5oNIPHiaLozyKlEH0oLk6D06TNtG6WHWZFiaCaaiac1ojtn5Q4NzZJYfn14vOvd8Q/132","comment_is_top":false,"comment_ctime":1573619936,"is_pvip":false,"replies":[{"id":"58016","content":"用的就是Visio，只是画的时候多用了点心，其实水平很一般，见笑了。","user_name":"作者回复","user_name_real":"chrono","uid":"1181974","ctime":1573622610,"ip_address":"","comment_id":150877,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1573619936","product_id":100029001,"comment_content":"老师你的画图工具叫啥啊？ 很漂亮的样子~~","like_count":0,"discussions":[{"author":{"id":1181974,"avatar":"https://static001.geekbang.org/account/avatar/00/12/09/16/1161017c.jpg","nickname":"罗剑锋","note":"","ucode":"95678C988F24AB","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":474296,"discussion_content":"用的就是Visio，只是画的时候多用了点心，其实水平很一般，见笑了。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1573622610,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":131920,"user_name":"Bayes","can_delete":false,"product_type":"c1","uid":1539608,"ip_address":"","ucode":"2F83B2EFCE6B5D","user_header":"https://static001.geekbang.org/account/avatar/00/17/7e/18/c3ed4650.jpg","comment_is_top":false,"comment_ctime":1567973192,"is_pvip":false,"replies":[{"id":"50410","content":"good。","user_name":"作者回复","user_name_real":"chrono","uid":"1181974","ctime":1567991160,"ip_address":"","comment_id":131920,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1567973192","product_id":100029001,"comment_content":"除了Cookie，还有token和jwt方案可选","like_count":0,"discussions":[{"author":{"id":1181974,"avatar":"https://static001.geekbang.org/account/avatar/00/12/09/16/1161017c.jpg","nickname":"罗剑锋","note":"","ucode":"95678C988F24AB","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":466680,"discussion_content":"good。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1567991160,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":125648,"user_name":"Geek_steven_wang","can_delete":false,"product_type":"c1","uid":1477120,"ip_address":"","ucode":"8CC8F4C9726191","user_header":"http://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTI8mFt5wSkia31qc8paRg2uPSB6AuEBDricrSxvFBuTpP3NnnflekpJ7wqvN0nRrJyu7zVbzd7Lwjxw/132","comment_is_top":false,"comment_ctime":1566220439,"is_pvip":false,"replies":[{"id":"46191","content":"对","user_name":"作者回复","user_name_real":"chrono","uid":"1181974","ctime":1566261998,"ip_address":"","comment_id":125648,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1566220439","product_id":100029001,"comment_content":"如果 Cookie 的 Max-Age 属性设置为 0，会有什么效果呢？<br>相当于没有缓存，浏览器关闭或会话过期就没了。<br><br>Cookie 的好处已经很清楚了，你觉得它有什么缺点呢？<br>隐私暴露，带来垃圾广告","like_count":0,"discussions":[{"author":{"id":1181974,"avatar":"https://static001.geekbang.org/account/avatar/00/12/09/16/1161017c.jpg","nickname":"罗剑锋","note":"","ucode":"95678C988F24AB","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":463642,"discussion_content":"对","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1566261998,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":125192,"user_name":"Cris","can_delete":false,"product_type":"c1","uid":1473520,"ip_address":"","ucode":"F8A287134F1078","user_header":"https://static001.geekbang.org/account/avatar/00/16/7b/f0/269139d5.jpg","comment_is_top":false,"comment_ctime":1566115607,"is_pvip":false,"replies":[{"id":"46201","content":"session不在http协议之内，所以没有讲，但只要理解了Cookie，它的用法也很容易弄明白。","user_name":"作者回复","user_name_real":"chrono","uid":"1181974","ctime":1566262472,"ip_address":"","comment_id":125192,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1566115607","product_id":100029001,"comment_content":"会讲解session吗？","like_count":0,"discussions":[{"author":{"id":1181974,"avatar":"https://static001.geekbang.org/account/avatar/00/12/09/16/1161017c.jpg","nickname":"罗剑锋","note":"","ucode":"95678C988F24AB","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":463471,"discussion_content":"session不在http协议之内，所以没有讲，但只要理解了Cookie，它的用法也很容易弄明白。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1566262472,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":121821,"user_name":"Johnson","can_delete":false,"product_type":"c1","uid":1060473,"ip_address":"","ucode":"FF29D9659284FD","user_header":"https://static001.geekbang.org/account/avatar/00/10/2e/79/05261bd7.jpg","comment_is_top":false,"comment_ctime":1565228707,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1565228707","product_id":100029001,"comment_content":"现在一般用户身份识别用OAuth2的JWT token比较主流一点","like_count":0},{"had_liked":false,"id":118699,"user_name":"DENG永青","can_delete":false,"product_type":"c1","uid":1311758,"ip_address":"","ucode":"FBBAF46E858596","user_header":"https://static001.geekbang.org/account/avatar/00/14/04/0e/87adea1d.jpg","comment_is_top":false,"comment_ctime":1564415594,"is_pvip":false,"replies":[{"id":"43520","content":"是的，有很多这样的攻击手段，所以cookie才要用属性加强安全性。","user_name":"作者回复","user_name_real":"chrono","uid":"1181974","ctime":1564448289,"ip_address":"","comment_id":118699,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1564415594","product_id":100029001,"comment_content":"老师我想问一下如果在客户端设置了cookie并且设置了作用域，被别人窃取了了用域名劫持方法把cookie 信息填充进去岂不是可以很轻松的拿到用户登录信息是吗？","like_count":0,"discussions":[{"author":{"id":1181974,"avatar":"https://static001.geekbang.org/account/avatar/00/12/09/16/1161017c.jpg","nickname":"罗剑锋","note":"","ucode":"95678C988F24AB","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":460535,"discussion_content":"是的，有很多这样的攻击手段，所以cookie才要用属性加强安全性。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1564448289,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":113928,"user_name":"亚洲舞王.尼古拉斯赵四","can_delete":false,"product_type":"c1","uid":1443078,"ip_address":"","ucode":"7159F5D7232696","user_header":"https://static001.geekbang.org/account/avatar/00/16/05/06/f5979d65.jpg","comment_is_top":false,"comment_ctime":1563187079,"is_pvip":false,"replies":[{"id":"41596","content":"√","user_name":"作者回复","user_name_real":"chrono","uid":"1181974","ctime":1563239429,"ip_address":"","comment_id":113928,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1563187079","product_id":100029001,"comment_content":"1.为0时候不会支持cookie的存储<br>2.缺点：a.明文存储在浏览器，按个F12就看见了<br>b.每次请求都得带着（接下来是不是有session出场了？）","like_count":0,"discussions":[{"author":{"id":1181974,"avatar":"https://static001.geekbang.org/account/avatar/00/12/09/16/1161017c.jpg","nickname":"罗剑锋","note":"","ucode":"95678C988F24AB","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":458441,"discussion_content":"√","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1563239429,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":112256,"user_name":"レイン小雨","can_delete":false,"product_type":"c1","uid":1219933,"ip_address":"","ucode":"45BED977EFE852","user_header":"https://static001.geekbang.org/account/avatar/00/12/9d/5d/3fdead91.jpg","comment_is_top":false,"comment_ctime":1562691871,"is_pvip":false,"replies":[{"id":"40818","content":"thanks。","user_name":"作者回复","user_name_real":"chrono","uid":"1181974","ctime":1562715548,"ip_address":"","comment_id":112256,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1562691871","product_id":100029001,"comment_content":"棒！","like_count":0,"discussions":[{"author":{"id":1181974,"avatar":"https://static001.geekbang.org/account/avatar/00/12/09/16/1161017c.jpg","nickname":"罗剑锋","note":"","ucode":"95678C988F24AB","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":457641,"discussion_content":"thanks。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1562715548,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]}]}