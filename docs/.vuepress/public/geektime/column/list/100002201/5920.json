{"id":5920,"title":"55 | 管理设计篇之“服务网格”","content":"<p>你好，我是陈皓，网名左耳朵耗子。</p>\n<p>前面，我讨论了Sidecar边车模式，这是一个非常不错的分布式架构的设计模式。因为这个模式可以有效地分离系统控制和业务逻辑，并且可以让整个系统架构在控制面上可以集中管理，可以显著地提高分布式系统的整体控制和管理效率，并且可以让业务开发更快速。</p>\n<p>那么，我们不妨在上面这个模式下think big一下。假如，我们在一个分布式系统中，已经把一些标准的Sidecar给部署好了。比如前面文章说过的熔断、限流、重试、幂等、路由、监视等这些东西。我们在每个计算结点上都部署好了这些东西，那么真实的业务服务只需要往这个集群中放，就可以和本地的Sidecar通信，然后由Sidecar委托代理与其它系统的交互和控制。这样一来，我们的业务开发和运维岂不是简单至极了？</p>\n<p>是啊，试想一下，如果某云服务提供商，提供了一个带着前面我们说过的那些各式各样的分布式设计模式的Sidecar集群，那么我们的用户真的就只用写业务逻辑相关的service了。写好一个就往这个集群中部署，开发和运维工作量都会得到巨大的降低和减少。</p>\n<h1>什么是Service Mesh</h1>\n<p>这就是CNCF（Cloud Native Computing Foundation，云原生计算基金会）目前主力推动的新一代的微服务架构——Service Mesh服务网格。</p>\n<p>在<a href=\"https://buoyant.io/2017/04/25/whats-a-service-mesh-and-why-do-i-need-one/\">What’s a service mesh? And why do I need one?</a> 中，解释了什么是Service Mesh。</p>\n<p><span class=\"reference\">A service mesh is a dedicated infrastructure layer for handling service-to-service communication. It’s responsible for the reliable delivery of requests through the complex topology of services that comprise a modern, cloud native application. In practice, the service mesh is typically implemented as an array of lightweight network proxies that are deployed alongside application code, without the application needing to be aware.</span></p>\n<p>Service Mesh这个服务网络专注于处理服务和服务间的通讯。其主要负责构造一个稳定可靠的服务通讯的基础设施，并让整个架构更为的先进和Cloud Native。在工程中，Service Mesh基本来说是一组轻量级的服务代理和应用逻辑的服务在一起，并且对于应用服务是透明的。</p>\n<!-- [[[read_end]]] -->\n<p>说白了，就是下面几个特点。</p>\n<ul>\n<li>Service Mesh是一个基础设施。</li>\n<li>Service Mesh是一个轻量的服务通讯的网络代理。</li>\n<li>Service Mesh对于应用服务来说是透明无侵入的。</li>\n<li>Service Mesh用于解耦和分离分布式系统架构中控制层面上的东西。</li>\n</ul>\n<p>说起来，Service Mesh就像是网络七层模型中的第四层TCP协议。其把底层的那些非常难控制的网络通讯方面的控制面的东西都管了（比如：丢包重传、拥塞控制、流量控制），而更为上面的应用层的协议，只需要关心自己业务应用层上的事了。如HTTP的HTML协议。</p>\n<p><a href=\"http://philcalcado.com/2017/08/03/pattern_service_mesh.html\">Pattern: Service Mesh</a> 这篇文章里也详细解释了Service Mesh的出现并不是一个偶然，而是一个必然，其中的演化路径如下。</p>\n<ul>\n<li>\n<p>一开始是最原始的两台主机间的进程直接通信。</p>\n</li>\n<li>\n<p>然后分离出网络层来，服务间的远程通信，通过底层的网络模型完成。</p>\n</li>\n<li>\n<p>再后来，因为两边的服务在接收的速度上不一致，所以需要应用层中实现流控。</p>\n</li>\n<li>\n<p>后来发现，流控模块基本可以交给网络层实现，于是TCP/IP就成了世界上最成功的网络协议。</p>\n</li>\n<li>\n<p>再往后面，我们知道了分布式系统中的8个谬论 <a href=\"https://en.wikipedia.org/wiki/Fallacies_of_distributed_computing\">The 8 Fallacies of Distributed Computing</a> ，意识到需要在分布式系统中有&quot;弹力设计&quot;。于是，我们在更上层中加入了像限流、熔断、服务发现、监控等功能。</p>\n</li>\n<li>\n<p>然后，我们发现这些弹力设计的模式都是可以标准化的。将这些模式写成SDK/Lib/Framework，这样就可以在开发层面上很容易地集成到我们的应用服务中。</p>\n</li>\n<li>\n<p>接下来，我们发现，SDK、Lib、Framework不能跨编程语言。有什么改动后，要重新编译重新发布服务，太不方便了。应该有一个专门的层来干这事，于是出现了Sidecar。</p>\n</li>\n</ul>\n<p><img src=\"https://static001.geekbang.org/resource/image/d8/c7/d8aaf6cfe490ffc3b89d08decf7c96c7.png?wh=687*331\" alt=\"\" /><br />\n图片来自<a href=\"http://philcalcado.com/2017/08/03/pattern_service_mesh.html\">Pattern: Service Mesh</a></p>\n<p>然后呢，Sidecar集群就成了Service Mesh。图中的绿色模块是真实的业务应用服务，蓝色模块则是Sidecar，其组成了一个网格。而我们的应用服务完全独立自包含，只需要和本机的Sidecar依赖，剩下的事全交给了Sidecar。</p>\n<p><img src=\"https://static001.geekbang.org/resource/image/e9/bd/e9235eeaf30df456748d391144bd2bbd.png?wh=458*293\" alt=\"\" /><br />\n图片来自<a href=\"http://philcalcado.com/2017/08/03/pattern_service_mesh.html\">Pattern: Service Mesh</a></p>\n<p>于是 Sidecar组成了一个平台，一个Cloud Native的服务流量调度的平台（你是否还记得我在《分布式系统的本质》那一系列文章中所说的关键技术中的流量调度和应用监控，其都可以通过Service Mesh这个平台来完成）。</p>\n<p><img src=\"https://static001.geekbang.org/resource/image/3d/d1/3d66848ecdc7e582015d8178e702d3d1.png?wh=458*293\" alt=\"\" /><br />\n图片来自<a href=\"http://philcalcado.com/2017/08/03/pattern_service_mesh.html\">Pattern: Service Mesh</a></p>\n<p>加上对整个集群的管理控制面板，就成了我们整个的Service Mesh架构。</p>\n<p><img src=\"https://static001.geekbang.org/resource/image/bf/78/bf90978e3488ff0c8eb5f8c759ab1078.png?wh=687*437\" alt=\"\" /><br />\n图片来自<a href=\"http://philcalcado.com/2017/08/03/pattern_service_mesh.html\">Pattern: Service Mesh</a></p>\n<p><img src=\"https://static001.geekbang.org/resource/image/bb/3f/bb846cf73db84f1551f3051fc1705b3f.png?wh=600*502\" alt=\"\" /><br />\n图片来自<a href=\"http://philcalcado.com/2017/08/03/pattern_service_mesh.html\">Pattern: Service Mesh</a></p>\n<h1>Service Mesh相关的开源软件</h1>\n<p>目前比较流行的Service Mesh开源软件是 <a href=\"https://istio.io\">Istio</a> 和 <a href=\"https://linkerd.io\">Linkerd</a>，它们都可以在Kubernetes中集成。当然，还有一个新成员 <a href=\"https://conduit.io\">Conduit</a>，它是由Linkerd的作者出来自己搞的，由Rust和Go写成的。Rust负责数据层面，Go负责控制面。号称吸取了很多Linkerd的Scala的教训，比Linkerd更快，还轻，更简单。</p>\n<p>我虽然不是语言的偏好者，但是，不可否认Rust/Go的性能方面比Scala要好得多得多，尤其是要做成一个和网络通讯相关的基础设施，性能是比较重要的。</p>\n<p>对此，我还是推荐大家使用Rust/Go语言实现的lstio和Conduit，后者比前者要轻很多。你可以根据你的具体需求挑选，或是自己实现。</p>\n<p>lstio是目前最主流的解决方案，其架构并不复杂，其核心的Sidecar被叫做Envoy（使者），用来协调服务网格中所有服务的出入站流量，并提供服务发现、负载均衡、限流熔断等能力，还可以收集大量与流量相关的性能指标。</p>\n<p>在Service Mesh控制面上，有一个叫Mixer的收集器，用来从Envoy收集相关的被监控到的流量特征和性能指标。然后，通过Pilot的控制器将相关的规则发送到Envoy中，让Envoy应用新的规则。</p>\n<p>最后，还有一个为安全设计的lstio-Auth身份认证组件，用来做服务间的访问安全控制。</p>\n<p>整个lstio的架构图如下。</p>\n<p><img src=\"https://static001.geekbang.org/resource/image/1a/f2/1a579db1c95608588052b167e68836f2.png?wh=827*443\" alt=\"\" /></p>\n<h1>Service Mesh的设计重点</h1>\n<p>Service Mesh作为Sidecar一个集群应用，Sidecar需要的微观层面上的那些设计要点在这里就不再复述了，欢迎大家看我之前的文章。这里，更多地说一下Service Mesh在整体架构上的一些设计要点。</p>\n<p>我们知道，像Kubernetes和Docker也是分布式系统管理面上的技术解决方案，它们一样对于应用程序是透明的。最重要的是，Kubernetes和Docker对于应用服务的干扰是比较少的。也就是说，Kubernetes和Docker的服务进程的失败不会导致应用服务的异常运行。然后，Service Mesh则不是，因为其调度了流量，所以，如果Service Mesh有bug，或是Sidecar的组件不可用，就会导致整个架构出现致命的问题。</p>\n<p>所以，在设计Service Mesh的时候，我们需要小心考虑，如果Service Mesh所管理的Sidecar出了问题，那应该怎么办？所以，Service Mesh这个网格一定要是高可靠的，或者是出现了故障有workaround的方式。一种比较好的方式是，除了在本机有Sidecar，我们还可以部署一下稍微集中一点的Sidecar——比如为某个服务集群部署一个集中式的Sidecar。一旦本机的有问题，可以走集中的。</p>\n<p>这样一来，Sidecar本来就是用来调度流量的，而且其粒度可以细到每个服务的实例，可以粗到一组服务，还可以粗到整体接入。这看来看去都像是一个Gateway的事。所以，我相信，使用Gateway来干这个事应该是最合适不过的了。这样，我们的Service Mesh的想象空间一下子就大多了。</p>\n<p>Service Mesh不像Sidecar需要和Service一起打包一起部署，Service Mesh完全独立部署。这样一来，Service Mesh就成了一个基础设施，就像一个PaaS平台。所以，Service Mesh能不能和Kubernetes密切结合就成为了非常关键的因素。</p>\n<h1>小结</h1>\n<p>好了，我们来总结一下今天分享的主要内容。首先，边车模式进化的下一阶段，就是把它的功能标准化成一个集群，其结果就是服务网格。它在分布式系统中的地位，类似于七层网络模型中的传输层协议，而服务本身则只需要关心业务逻辑，因此类似于应用层协议。然后，我介绍了几个实现了服务网格的开源软件。最后，我介绍了服务网格的几个设计重点。下一讲中，我们讲述网关模式。希望对你有帮助。</p>\n<p>也欢迎你分享一下你接触到的分布式系统有没有用到服务网格？具体用的是哪个开源或闭源的框架？</p>\n<p>文末给出了《分布式系统设计模式》系列文章的目录，希望你能在这个列表里找到自己感兴趣的内容。</p>\n<ul>\n<li>弹力设计篇\n<ul>\n<li><a href=\"https://time.geekbang.org/column/article/3912\">认识故障和弹力设计</a></li>\n<li><a href=\"https://time.geekbang.org/column/article/3917\">隔离设计Bulkheads</a></li>\n<li><a href=\"https://time.geekbang.org/column/article/3926\">异步通讯设计Asynchronous</a></li>\n<li><a href=\"https://time.geekbang.org/column/article/4050\">幂等性设计Idempotency</a></li>\n<li><a href=\"https://time.geekbang.org/column/article/4086\">服务的状态State</a></li>\n<li><a href=\"https://time.geekbang.org/column/article/4087\">补偿事务Compensating Transaction</a></li>\n<li><a href=\"https://time.geekbang.org/column/article/4121\">重试设计Retry</a></li>\n<li><a href=\"https://time.geekbang.org/column/article/4241\">熔断设计Circuit Breaker</a></li>\n<li><a href=\"https://time.geekbang.org/column/article/4245\">限流设计Throttle</a></li>\n<li><a href=\"https://time.geekbang.org/column/article/4252\">降级设计degradation</a></li>\n<li><a href=\"https://time.geekbang.org/column/article/4253\">弹力设计总结</a></li>\n</ul>\n</li>\n<li>管理设计篇\n<ul>\n<li><a href=\"https://time.geekbang.org/column/article/5175\">分布式锁Distributed Lock</a></li>\n<li><a href=\"https://time.geekbang.org/column/article/5819\">配置中心Configuration Management</a></li>\n<li><a href=\"https://time.geekbang.org/column/article/5909\">边车模式Sidecar</a></li>\n<li><a href=\"https://time.geekbang.org/column/article/5920\">服务网格Service Mesh</a></li>\n<li><a href=\"https://time.geekbang.org/column/article/6086\">网关模式Gateway</a></li>\n<li><a href=\"https://time.geekbang.org/column/article/6283\">部署升级策略</a></li>\n</ul>\n</li>\n<li>性能设计篇\n<ul>\n<li><a href=\"https://time.geekbang.org/column/article/6282\">缓存Cache</a></li>\n<li><a href=\"https://time.geekbang.org/column/article/7036\">异步处理Asynchronous</a></li>\n<li><a href=\"https://time.geekbang.org/column/article/7045\">数据库扩展</a></li>\n<li><a href=\"https://time.geekbang.org/column/article/7047\">秒杀Flash Sales</a></li>\n<li><a href=\"https://time.geekbang.org/column/article/7086\">边缘计算Edge Computing</a></li>\n</ul>\n</li>\n</ul>\n","comments":[{"had_liked":false,"id":7208,"user_name":"Alan","can_delete":false,"product_type":"c1","uid":1061340,"ip_address":"","ucode":"15C718CA868099","user_header":"https://static001.geekbang.org/account/avatar/00/10/31/dc/af9c4356.jpg","comment_is_top":false,"comment_ctime":1525336131,"is_pvip":false,"discussion_count":7,"race_medal":0,"score":"96014616643","product_id":100002201,"comment_content":"能不能，每篇文章做个总结，比如微服务和服务网格的区别，他们的优势，劣势，解决了什么问题，适合什么规模的业务，他们的相同点，不同点，感觉文章讲的有点模糊","like_count":22,"discussions":[{"author":{"id":1235077,"avatar":"https://static001.geekbang.org/account/avatar/00/12/d8/85/21fd42fa.jpg","nickname":"chitanda","note":"","ucode":"B3E28E1C8E410B","race_medal":2,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":20978,"discussion_content":"深入的东西还是得去看书查资料。这些文章对于地铁读物来说很不错了，至少面试能多吹比","likes_number":9,"is_delete":false,"is_hidden":false,"ctime":1569409060,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1307793,"avatar":"http://thirdwx.qlogo.cn/mmopen/vi_32/DYAIOgq83eo5WaRd8ibAozKXvIGWXKDq1CdxLhkdnRyyTKcgMDYaFDAaKqg2IpETOC3RacYoggGOhFMeMGicRXxA/132","nickname":"天机老人","note":"","ucode":"B553FBBF9DD41B","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":5748,"discussion_content":"作者估计也没有实践过serviceMesh，你这要求有点高了，大家都是堆堆理论而已。","likes_number":4,"is_delete":false,"is_hidden":false,"ctime":1566460134,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":2,"child_discussions":[{"author":{"id":2431311,"avatar":"https://static001.geekbang.org/account/avatar/00/25/19/4f/a0757e5f.jpg","nickname":"江宁XYZ","note":"","ucode":"D2D1C3DF0809F8","race_medal":0,"user_type":1,"is_pvip":true},"reply_author":{"id":1307793,"avatar":"http://thirdwx.qlogo.cn/mmopen/vi_32/DYAIOgq83eo5WaRd8ibAozKXvIGWXKDq1CdxLhkdnRyyTKcgMDYaFDAaKqg2IpETOC3RacYoggGOhFMeMGicRXxA/132","nickname":"天机老人","note":"","ucode":"B553FBBF9DD41B","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":382712,"discussion_content":"作者自己的公司就是做一块mesh的吧","likes_number":2,"is_delete":false,"is_hidden":false,"ctime":1625701855,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":5748,"ip_address":""},"score":382712,"extra":""},{"author":{"id":1033748,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/c6/14/3f206319.jpg","nickname":"Finch","note":"","ucode":"627124740E3940","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":1307793,"avatar":"http://thirdwx.qlogo.cn/mmopen/vi_32/DYAIOgq83eo5WaRd8ibAozKXvIGWXKDq1CdxLhkdnRyyTKcgMDYaFDAaKqg2IpETOC3RacYoggGOhFMeMGicRXxA/132","nickname":"天机老人","note":"","ucode":"B553FBBF9DD41B","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":412165,"discussion_content":"那是你","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1636092646,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":5748,"ip_address":""},"score":412165,"extra":""}]},{"author":{"id":1623301,"avatar":"https://static001.geekbang.org/account/avatar/00/18/c5/05/86496ab9.jpg","nickname":"Leo (OBS)","note":"","ucode":"379FC6B5730FF4","race_medal":0,"user_type":1,"is_pvip":true},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":268891,"discussion_content":"打个比方，快餐吃多了，都忘了正餐怎么吃了，学习最终还是要靠自己呀","likes_number":3,"is_delete":false,"is_hidden":false,"ctime":1589848048,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":2806043,"avatar":"https://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTLBFkSq1oiaEMRjtyyv4ZpCI0OuaSsqs04ODm0OkZF6QhsAh3SvqhxibS2n7PLAVZE3QRSn5Hic0DyXg/132","nickname":"ddh","note":"","ucode":"8E852375365F16","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":544478,"discussion_content":"一般懂得人都懂， 看不懂，就先学习下基础","likes_number":1,"is_delete":false,"is_hidden":false,"ctime":1641536999,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":2446418,"avatar":"https://thirdwx.qlogo.cn/mmopen/vi_32/zdK3dSkFwicZHtx5CLAKFJRORRibq2YqvHOP0tySLxVx0X1oD9AJanan2wia2hHaswgxdrCzEEGyVgFTVZ8sElTzQ/132","nickname":"Geek_fbfc4f","note":"","ucode":"7010B242A3F474","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":373956,"discussion_content":"。。。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1620952500,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":7961,"user_name":"闫飞","can_delete":false,"product_type":"c1","uid":1013162,"ip_address":"","ucode":"30C782D30108D4","user_header":"https://static001.geekbang.org/account/avatar/00/0f/75/aa/21275b9d.jpg","comment_is_top":false,"comment_ctime":1525824698,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"31590595770","product_id":100002201,"comment_content":"最后一段的意思是，服务网格和API网关可以结合使用的，两种技术并不互相冲突吧。服务网格自己本身是完全去中心化的，给每个微服务运行期实例都加了个壳，两者是一荣俱荣一损俱损的关系，所以往往部署上也应该是在一个容器或VM上的。<br><br>目前linkerd是比较成熟而功能完备的，奈何JVM本身不小，打包到容器中就会额外多几十乃至上百MB，运行期也要吃掉很多内存。<br><br>lstio的数据面是用的C++，性能优势明显所以buoyant作为linkerd背后公司才不得已自己用另外一门无GC的静态语言重写了。他们也想过优化JVM，但只是优化了部分启动时间便放弃了改良路线决定起炉重造了，毕竟优化JVM太难了。","like_count":7},{"had_liked":false,"id":171074,"user_name":"俊毓","can_delete":false,"product_type":"c1","uid":1554638,"ip_address":"","ucode":"F150D39D00FAAC","user_header":"https://static001.geekbang.org/account/avatar/00/17/b8/ce/0abbb54d.jpg","comment_is_top":false,"comment_ctime":1578839642,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"23053676122","product_id":100002201,"comment_content":"在k8s上，如果我们强制每一个服务发布时候，都必须在pod里面绑定一个nginx或者envoy，负责流控，熔断，通信等等功能，然后利用k8s的service服务发现，那我们也可得到一个很基础的服务网格。","like_count":5},{"had_liked":false,"id":210008,"user_name":"杉松壁","can_delete":false,"product_type":"c1","uid":1080578,"ip_address":"","ucode":"ED904CE27CD3C4","user_header":"https://static001.geekbang.org/account/avatar/00/10/7d/02/4862f849.jpg","comment_is_top":false,"comment_ctime":1587650987,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"10177585579","product_id":100002201,"comment_content":"谢谢。sidecar的稳定性是必须谨慎的地方","like_count":2},{"had_liked":false,"id":170480,"user_name":"知行合一","can_delete":false,"product_type":"c1","uid":1521486,"ip_address":"","ucode":"2B8E634FC4CFB7","user_header":"https://static001.geekbang.org/account/avatar/00/17/37/4e/5c3153b2.jpg","comment_is_top":false,"comment_ctime":1578619466,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"10168554058","product_id":100002201,"comment_content":"servise mess其实就是将控制组件云化，实现业务系统只管业务？","like_count":2},{"had_liked":false,"id":114802,"user_name":"edisonhuang","can_delete":false,"product_type":"c1","uid":1530167,"ip_address":"","ucode":"BB2F639A779F96","user_header":"https://static001.geekbang.org/account/avatar/00/17/59/37/bd2de0a4.jpg","comment_is_top":false,"comment_ctime":1563410456,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"10153345048","product_id":100002201,"comment_content":"边车模式进一步发展，就出现了服务网格，服务网格单独作为一个集群部署，解决服务之间的流控，熔断，重试等服务通信的问题，类似于网络协议中的传输层。使用服务网格将业务逻辑和服务通讯的控制隔离开来，让分布式服务开发更简单容易","like_count":2},{"had_liked":false,"id":79396,"user_name":"chenhz","can_delete":false,"product_type":"c1","uid":1078160,"ip_address":"","ucode":"485420EA3282D4","user_header":"https://static001.geekbang.org/account/avatar/00/10/73/90/9118f46d.jpg","comment_is_top":false,"comment_ctime":1553475514,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"10143410106","product_id":100002201,"comment_content":"服务网格的劣势：<br>多一层通信，响应上比微服务稍逊一筹<br>服务网格的优势：<br>1.业务代码无侵入，服务跨语言；<br>2.将管理与业务逻辑分离，开发只需专注业务代码实现，开发成本更低；<br><br>传统微服务的优势：<br>快；<br>劣势：<br>治理方案不统一；<br>语言相关性<br>","like_count":2},{"had_liked":false,"id":267954,"user_name":"王植萌","can_delete":false,"product_type":"c1","uid":2161250,"ip_address":"","ucode":"AD4BA11228F3E5","user_header":"https://static001.geekbang.org/account/avatar/00/20/fa/62/2fb63798.jpg","comment_is_top":false,"comment_ctime":1608006595,"is_pvip":false,"discussion_count":1,"race_medal":0,"score":"5902973891","product_id":100002201,"comment_content":"DDD战术设计中的防腐层看起来一定程度上起到的就是sidecar的作用，虽然说是从不同的角度看这个问题。","like_count":1,"discussions":[{"author":{"id":2845437,"avatar":"","nickname":"Geek5763","note":"","ucode":"D4C8CAEABAA925","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":581557,"discussion_content":"这个差的远了吧","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1658837668,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":7067,"user_name":"hua168","can_delete":false,"product_type":"c1","uid":1065255,"ip_address":"","ucode":"CFF9A7E86EBA48","user_header":"https://static001.geekbang.org/account/avatar/00/10/41/27/3ff1a1d6.jpg","comment_is_top":false,"comment_ctime":1525258893,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"5820226189","product_id":100002201,"comment_content":"大神，所有文章我看了，没有讲到安全呀……能不能讲下安全……","like_count":1},{"had_liked":false,"id":359965,"user_name":"梅子黄时雨","can_delete":false,"product_type":"c1","uid":1015938,"ip_address":"上海","ucode":"9F788D09C2E9E7","user_header":"https://static001.geekbang.org/account/avatar/00/0f/80/82/3c21b30c.jpg","comment_is_top":false,"comment_ctime":1666092414,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1666092414","product_id":100002201,"comment_content":"学习了。","like_count":0},{"had_liked":false,"id":320612,"user_name":"方勇(gopher)","can_delete":false,"product_type":"c1","uid":1290625,"ip_address":"","ucode":"D199911C4CFEF5","user_header":"https://static001.geekbang.org/account/avatar/00/13/b1/81/13f23d1e.jpg","comment_is_top":false,"comment_ctime":1636420393,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1636420393","product_id":100002201,"comment_content":"目前在调研istio，下一步会尝试到测试环境","like_count":0},{"had_liked":false,"id":292349,"user_name":"健康的小牛犊","can_delete":false,"product_type":"c1","uid":2263754,"ip_address":"","ucode":"A63C30B602F0A5","user_header":"https://static001.geekbang.org/account/avatar/00/22/8a/ca/1afcc75b.jpg","comment_is_top":false,"comment_ctime":1620788958,"is_pvip":true,"discussion_count":1,"race_medal":0,"score":"1620788958","product_id":100002201,"comment_content":"现在istio的架构已经改变了，没有mixer了","like_count":0,"discussions":[{"author":{"id":2446418,"avatar":"https://thirdwx.qlogo.cn/mmopen/vi_32/zdK3dSkFwicZHtx5CLAKFJRORRibq2YqvHOP0tySLxVx0X1oD9AJanan2wia2hHaswgxdrCzEEGyVgFTVZ8sElTzQ/132","nickname":"Geek_fbfc4f","note":"","ucode":"7010B242A3F474","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":373955,"discussion_content":"3年了，人也会变化哦。","likes_number":1,"is_delete":false,"is_hidden":false,"ctime":1620952392,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":215381,"user_name":"边城路远","can_delete":false,"product_type":"c1","uid":1286741,"ip_address":"","ucode":"214ECD8981E87F","user_header":"https://static001.geekbang.org/account/avatar/00/13/a2/55/1092ebb8.jpg","comment_is_top":false,"comment_ctime":1588985012,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1588985012","product_id":100002201,"comment_content":"Sidercar再进一步抽象和分离就成了servicemesh, 例如istio把数据逻辑留在envoy,把策略控制放在pilot, mixer","like_count":0},{"had_liked":false,"id":209595,"user_name":"Geek_dwq","can_delete":false,"product_type":"c1","uid":1817279,"ip_address":"","ucode":"7DC6BFCF746787","user_header":"http://thirdwx.qlogo.cn/mmopen/vi_32/wI2LwgvwseNqXwkF67zicD9UXBSle9DPhmL6uyKG9Nib6NLfU3OuKYuSQ4DHCWxIQecnqell2vKVvNX8boox0B8w/132","comment_is_top":false,"comment_ctime":1587569665,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1587569665","product_id":100002201,"comment_content":"Service Mash演进路线的描述得通俗易懂，并且图文并茂，老师真是非常用心","like_count":0},{"had_liked":false,"id":168895,"user_name":"文刂 氵共 超","can_delete":false,"product_type":"c1","uid":1282813,"ip_address":"","ucode":"C2CE1512D23012","user_header":"https://static001.geekbang.org/account/avatar/00/13/92/fd/6b0e58fe.jpg","comment_is_top":false,"comment_ctime":1578211729,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1578211729","product_id":100002201,"comment_content":"坚持学习，学习笔记 https:&#47;&#47;mubu.com&#47;colla&#47;6m9czuZAqc0","like_count":0},{"had_liked":false,"id":39780,"user_name":"绿里奇迹","can_delete":false,"product_type":"c1","uid":1173341,"ip_address":"","ucode":"E1E7BC3AAEC86A","user_header":"https://static001.geekbang.org/account/avatar/00/11/e7/5d/a99d32d5.jpg","comment_is_top":false,"comment_ctime":1542355680,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1542355680","product_id":100002201,"comment_content":"Kubernetes中的ingress controller 可以结合nginx或envoy实现各service间的通信，有点类似吧","like_count":0}]}