{"id":9492,"title":"第15讲 | HTTPS协议：点外卖的过程原来这么复杂","content":"<p>用HTTP协议，看个新闻还没有问题，但是换到更加严肃的场景中，就存在很多的安全风险。例如，你要下单做一次支付，如果还是使用普通的HTTP协议，那你很可能会被黑客盯上。</p><p>你发送一个请求，说我要点个外卖，但是这个网络包被截获了，于是在服务器回复你之前，黑客先假装自己就是外卖网站，然后给你回复一个假的消息说：“好啊好啊，来来来，银行卡号、密码拿来。”如果这时候你真把银行卡密码发给它，那你就真的上套了。</p><p>那怎么解决这个问题呢？当然一般的思路就是<strong>加密</strong>。加密分为两种方式一种是<strong>对称加密</strong>，一种是<strong>非对称加密</strong>。</p><p>在对称加密算法中，加密和解密使用的密钥是相同的。也就是说，加密和解密使用的是同一个密钥。因此，对称加密算法要保证安全性的话，密钥要做好保密。只能让使用的人知道，不能对外公开。</p><p>在非对称加密算法中，加密使用的密钥和解密使用的密钥是不相同的。一把是作为公开的公钥，另一把是作为谁都不能给的私钥。公钥加密的信息，只有私钥才能解密。私钥加密的信息，只有公钥才能解密。</p><p>因为对称加密算法相比非对称加密算法来说，效率要高得多，性能也好，所以交互的场景下多用对称加密。</p><h2>对称加密</h2><p>假设你和外卖网站约定了一个密钥，你发送请求的时候用这个密钥进行加密，外卖网站用同样的密钥进行解密。这样就算中间的黑客截获了你的请求，但是它没有密钥，还是破解不了。</p><!-- [[[read_end]]] --><p>这看起来很完美，但是中间有个问题，你们两个怎么来约定这个密钥呢？如果这个密钥在互联网上传输，也是很有可能让黑客截获的。黑客一旦截获这个秘钥，它可以佯作不知，静静地等着你们两个交互。这时候你们之间互通的任何消息，它都能截获并且查看，就等你把银行卡账号和密码发出来。</p><p>我们在谍战剧里面经常看到这样的场景，就是特工破译的密码会有个密码本，截获无线电台，通过密码本就能将原文破解出来。怎么把密码本给对方呢？只能通过<strong>线下传输</strong>。</p><p>比如，你和外卖网站偷偷约定时间地点，它给你一个纸条，上面写着你们两个的密钥，然后说以后就用这个密钥在互联网上定外卖了。当然你们接头的时候，也会先约定一个口号，什么“天王盖地虎”之类的，口号对上了，才能把纸条给它。但是，“天王盖地虎”同样也是对称加密密钥，同样存在如何把“天王盖地虎”约定成口号的问题。而且在谍战剧中一对一接头可能还可以，在互联网应用中，客户太多，这样是不行的。</p><h2>非对称加密</h2><p>所以，只要是对称加密，就会永远在这个死循环里出不来，这个时候，就需要非对称加密介入进来。</p><p>非对称加密的私钥放在外卖网站这里，不会在互联网上传输，这样就能保证这个密钥的私密性。但是，对应私钥的公钥，是可以在互联网上随意传播的，只要外卖网站把这个公钥给你，你们就可以愉快地互通了。</p><p>比如说你用公钥加密，说“我要定外卖”，黑客在中间就算截获了这个报文，因为它没有私钥也是解不开的，所以这个报文可以顺利到达外卖网站，外卖网站用私钥把这个报文解出来，然后回复，“那给我银行卡和支付密码吧”。</p><p>先别太乐观，这里还是有问题的。回复的这句话，是外卖网站拿私钥加密的，互联网上人人都可以把它打开，当然包括黑客。那外卖网站可以拿公钥加密吗？当然不能，因为它自己的私钥只有它自己知道，谁也解不开。</p><p>另外，这个过程还有一个问题，黑客也可以模拟发送“我要定外卖”这个过程的，因为它也有外卖网站的公钥。</p><p>为了解决这个问题，看来一对公钥私钥是不够的，客户端也需要有自己的公钥和私钥，并且客户端要把自己的公钥，给外卖网站。</p><p>这样，客户端给外卖网站发送的时候，用外卖网站的公钥加密。而外卖网站给客户端发送消息的时候，使用客户端的公钥。这样就算有黑客企图模拟客户端获取一些信息，或者半路截获回复信息，但是由于它没有私钥，这些信息它还是打不开。</p><h2>数字证书</h2><p>不对称加密也会有同样的问题，如何将不对称加密的公钥给对方呢？一种是放在一个公网的地址上，让对方下载；另一种就是在建立连接的时候，传给对方。</p><p>这两种方法有相同的问题，那就是，作为一个普通网民，你怎么鉴别别人给你的公钥是对的。会不会有人冒充外卖网站，发给你一个它的公钥。接下来，你和它所有的互通，看起来都是没有任何问题的。毕竟每个人都可以创建自己的公钥和私钥。</p><p>例如，我自己搭建了一个网站cliu8site，可以通过这个命令先创建私钥。</p><pre><code>openssl genrsa -out cliu8siteprivate.key 1024\n</code></pre><p>然后，再根据这个私钥，创建对应的公钥。</p><pre><code>openssl rsa -in cliu8siteprivate.key -pubout -outcliu8sitepublic.pem\n</code></pre><p>这个时候就需要权威部门的介入了，就像每个人都可以打印自己的简历，说自己是谁，但是有公安局盖章的，就只有户口本，这个才能证明你是你。这个由权威部门颁发的称为<strong>证书</strong>（<strong>Certificate</strong>）。</p><p>证书里面有什么呢？当然应该有<strong>公钥</strong>，这是最重要的；还有证书的<strong>所有者</strong>，就像户口本上有你的姓名和身份证号，说明这个户口本是你的；另外还有证书的<strong>发布机构</strong>和证书的<strong>有效期</strong>，这个有点像身份证上的机构是哪个区公安局，有效期到多少年。</p><p>这个证书是怎么生成的呢？会不会有人假冒权威机构颁发证书呢？就像有假身份证、假户口本一样。生成证书需要发起一个证书请求，然后将这个请求发给一个权威机构去认证，这个权威机构我们称为<strong>CA</strong>（ <strong>Certificate Authority</strong>）。</p><p>证书请求可以通过这个命令生成。</p><pre><code>openssl req -key cliu8siteprivate.key -new -out cliu8sitecertificate.req\n</code></pre><p>将这个请求发给权威机构，权威机构会给这个证书卡一个章，我们称为<strong>签名算法。</strong>问题又来了，那怎么签名才能保证是真的权威机构签名的呢？当然只有用只掌握在权威机构手里的东西签名了才行，这就是CA的私钥。</p><p>签名算法大概是这样工作的：一般是对信息做一个Hash计算，得到一个Hash值，这个过程是不可逆的，也就是说无法通过Hash值得出原来的信息内容。在把信息发送出去时，把这个Hash值加密后，作为一个签名和信息一起发出去。</p><p>权威机构给证书签名的命令是这样的。</p><pre><code>openssl x509 -req -in cliu8sitecertificate.req -CA cacertificate.pem -CAkey caprivate.key -out cliu8sitecertificate.pem\n</code></pre><p>这个命令会返回Signature ok，而cliu8sitecertificate.pem就是签过名的证书。CA用自己的私钥给外卖网站的公钥签名，就相当于给外卖网站背书，形成了外卖网站的证书。</p><p>我们来查看这个证书的内容。</p><pre><code>openssl x509 -in cliu8sitecertificate.pem -noout -text \n</code></pre><p>这里面有个Issuer，也即证书是谁颁发的；Subject，就是证书颁发给谁；Validity是证书期限；Public-key是公钥内容；Signature Algorithm是签名算法。</p><p>这下好了，你不会从外卖网站上得到一个公钥，而是会得到一个证书，这个证书有个发布机构CA，你只要得到这个发布机构CA的公钥，去解密外卖网站证书的签名，如果解密成功了，Hash也对的上，就说明这个外卖网站的公钥没有啥问题。</p><p>你有没有发现，又有新问题了。要想验证证书，需要CA的公钥，问题是，你怎么确定CA的公钥就是对的呢？</p><p>所以，CA的公钥也需要更牛的CA给它签名，然后形成CA的证书。要想知道某个CA的证书是否可靠，要看CA的上级证书的公钥，能不能解开这个CA的签名。就像你不相信区公安局，可以打电话问市公安局，让市公安局确认区公安局的合法性。这样层层上去，直到全球皆知的几个著名大CA，称为<strong>root CA</strong>，做最后的背书。通过这种<strong>层层授信背书</strong>的方式，从而保证了非对称加密模式的正常运转。</p><p>除此之外，还有一种证书，称为<strong>Self-Signed Certificate</strong>，就是自己给自己签名。这个给人一种“我就是我，你爱信不信”的感觉。这里我就不多说了。</p><h2>HTTPS的工作模式</h2><p>我们可以知道，非对称加密在性能上不如对称加密，那是否能将两者结合起来呢？例如，公钥私钥主要用于传输对称加密的秘钥，而真正的双方大数据量的通信都是通过对称加密进行的。</p><p>当然是可以的。这就是HTTPS协议的总体思路。</p><p><img src=\"https://static001.geekbang.org/resource/image/df/b4/df1685dd308cef1db97e91493f911ab4.jpg?wh=2285*4076\" alt=\"\"></p><p>当你登录一个外卖网站的时候，由于是HTTPS，客户端会发送Client Hello消息到服务器，以明文传输TLS版本信息、加密套件候选列表、压缩算法候选列表等信息。另外，还会有一个随机数，在协商对称密钥的时候使用。</p><p>这就类似在说：“您好，我想定外卖，但你要保密我吃的是什么。这是我的加密套路，再给你个随机数，你留着。”</p><p>然后，外卖网站返回Server Hello消息, 告诉客户端，服务器选择使用的协议版本、加密套件、压缩算法等，还有一个随机数，用于后续的密钥协商。</p><p>这就类似在说：“您好，保密没问题，你的加密套路还挺多，咱们就按套路2来吧，我这里也有个随机数，你也留着。”</p><p>然后，外卖网站会给你一个服务器端的证书，然后说：“Server Hello Done，我这里就这些信息了。”</p><p>你当然不相信这个证书，于是你从自己信任的CA仓库中，拿CA的证书里面的公钥去解密外卖网站的证书。如果能够成功，则说明外卖网站是可信的。这个过程中，你可能会不断往上追溯CA、CA的CA、CA的CA的CA，反正直到一个授信的CA，就可以了。</p><p>证书验证完毕之后，觉得这个外卖网站可信，于是客户端计算产生随机数字Pre-master，发送Client Key Exchange，用证书中的公钥加密，再发送给服务器，服务器可以通过私钥解密出来。</p><p>到目前为止，无论是客户端还是服务器，都有了三个随机数，分别是：自己的、对端的，以及刚生成的Pre-Master随机数。通过这三个随机数，可以在客户端和服务器产生相同的对称密钥。</p><p>有了对称密钥，客户端就可以说：“Change Cipher Spec，咱们以后都采用协商的通信密钥和加密算法进行加密通信了。”</p><p>然后发送一个Encrypted Handshake Message，将已经商定好的参数等，采用协商密钥进行加密，发送给服务器用于数据与握手验证。</p><p>同样，服务器也可以发送Change Cipher Spec，说：“没问题，咱们以后都采用协商的通信密钥和加密算法进行加密通信了”，并且也发送Encrypted Handshake Message的消息试试。当双方握手结束之后，就可以通过对称密钥进行加密传输了。</p><p>这个过程除了加密解密之外，其他的过程和HTTP是一样的，过程也非常复杂。</p><p>上面的过程只包含了HTTPS的单向认证，也即客户端验证服务端的证书，是大部分的场景，也可以在更加严格安全要求的情况下，启用双向认证，双方互相验证证书。</p><h2>重放与篡改</h2><p>其实，这里还有一些没有解决的问题，例如重放和篡改的问题。</p><p>没错，有了加密和解密，黑客截获了包也打不开了，但是它可以发送N次。这个往往通过Timestamp和Nonce随机数联合起来，然后做一个不可逆的签名来保证。</p><p>Nonce随机数保证唯一，或者Timestamp和Nonce合起来保证唯一，同样的，请求只接受一次，于是服务器多次收到相同的Timestamp和Nonce，则视为无效即可。</p><p>如果有人想篡改Timestamp和Nonce，还有签名保证不可篡改性，如果改了用签名算法解出来，就对不上了，可以丢弃了。</p><h2>小结</h2><p>好了，这一节就到这里了，我们来总结一下。</p><ul>\n<li>\n<p><span class=\"orange\">加密分对称加密和非对称加密。对称加密效率高，但是解决不了密钥传输问题；非对称加密可以解决这个问题，但是效率不高。</span></p>\n</li>\n<li>\n<p><span class=\"orange\"> 非对称加密需要通过证书和权威机构来验证公钥的合法性。</span></p>\n</li>\n<li>\n<p><span class=\"orange\">HTTPS是综合了对称加密和非对称加密算法的HTTP协议。既保证传输安全，也保证传输效率。</span></p>\n</li>\n</ul><p>最后，给你留两个思考题：</p><ol>\n<li>\n<p>HTTPS协议比较复杂，沟通过程太繁复，这样会导致效率问题，那你知道有哪些手段可以解决这些问题吗？</p>\n</li>\n<li>\n<p>HTTP和HTTPS协议的正文部分传输个JSON什么的还好，如果播放视频，就有问题了，那这个时候，应该使用什么协议呢？</p>\n</li>\n</ol><p>欢迎你留言和我讨论。趣谈网络协议，我们下期见！</p>","comments":[{"had_liked":false,"id":13486,"user_name":"万历十五年","can_delete":false,"product_type":"c1","uid":1122150,"ip_address":"","ucode":"3D8CF5DF847AE8","user_header":"https://static001.geekbang.org/account/avatar/00/11/1f/66/59e0647a.jpg","comment_is_top":false,"comment_ctime":1529671921,"is_pvip":false,"replies":[{"id":"4515","content":"是的","user_name":"作者回复","user_name_real":"刘超@网易云","uid":"1001590","ctime":1529680022,"ip_address":"","comment_id":13486,"utype":1}],"discussion_count":9,"race_medal":0,"score":"1659387048177","product_id":100007101,"comment_content":"各大CA机构的公钥是默认安装在操作系统里的。所以不要安装来路不明的操作系统，否则相当于裸奔","like_count":386,"discussions":[{"author":{"id":1001590,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/48/76/0c7d4d23.jpg","nickname":"刘超","note":"","ucode":"196BF3F499E8FE","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":419666,"discussion_content":"是的","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1529680022,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1140175,"avatar":"https://static001.geekbang.org/account/avatar/00/11/65/cf/326c0eea.jpg","nickname":"x-ray","note":"","ucode":"8363F0C4D0AC0B","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":363921,"discussion_content":"这句话最重要。正因为这个公钥是不传的。所以才能从前面讲到的死循环中跳出来，我觉得文章应该重点点名这个","likes_number":8,"is_delete":false,"is_hidden":false,"ctime":1617326397,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":2060756,"avatar":"","nickname":"在下蟑螂王","note":"","ucode":"E66A65A327095A","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":301437,"discussion_content":"你万历十五年，我乃裸奔十五年","likes_number":3,"is_delete":false,"is_hidden":false,"ctime":1598526729,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1121758,"avatar":"https://static001.geekbang.org/account/avatar/00/11/1d/de/62bfa83f.jpg","nickname":"aoe","note":"","ucode":"1C6201EDB4E954","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":265295,"discussion_content":"很久之前番茄花园，流行在大街小巷","likes_number":3,"is_delete":false,"is_hidden":false,"ctime":1589382747,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1169341,"avatar":"https://static001.geekbang.org/account/avatar/00/11/d7/bd/50d98f9e.jpg","nickname":"黑马有点白986","note":"","ucode":"C24216CBD5D7CC","race_medal":0,"user_type":1,"is_pvip":true},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":548337,"discussion_content":"这句话是核心，很多https的文章讲不到重点。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1643150056,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1010915,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/6c/e3/c2bb4ef9.jpg","nickname":"赵海超","note":"","ucode":"981347C77A2C46","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":392801,"discussion_content":"应该会有别的机制化解风险吧，比如网银盾，淘宝客户端插件什么的，通过客户端内置CA公钥？","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1631145556,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1137522,"avatar":"https://static001.geekbang.org/account/avatar/00/11/5b/72/dcf98055.jpg","nickname":"天雨流淓Dennis","note":"","ucode":"B9885AF12063E0","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":378584,"discussion_content":"多谢解惑，建议作者把这个信息点补充进正文中。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1623294457,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1132316,"avatar":"https://static001.geekbang.org/account/avatar/00/11/47/1c/1219b946.jpg","nickname":"Star. D","note":"","ucode":"058DCFD6F813E9","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":378236,"discussion_content":"感谢提醒","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1623121787,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":2096243,"avatar":"https://static001.geekbang.org/account/avatar/00/1f/fc/73/64b0d20e.jpg","nickname":"Saxon Lee","note":"","ucode":"38D656829A0513","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":312797,"discussion_content":"多谢提醒","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1602819405,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":48650,"user_name":"Michael","can_delete":false,"product_type":"c1","uid":1118976,"ip_address":"","ucode":"35F4FFAC4A4B15","user_header":"https://static001.geekbang.org/account/avatar/00/11/13/00/a4a2065f.jpg","comment_is_top":false,"comment_ctime":1544507426,"is_pvip":false,"discussion_count":1,"race_medal":0,"score":"581365092386","product_id":100007101,"comment_content":"看了好几遍，感觉算是明白 https 非对称加密通信的过程了，总结一下，大家看看是不是这样的：<br><br>首先，服务端需要向证书颁发机构申请一个自己的证书，这个证书里面会包含此该站点的基本信息，个人啊，公司啊，组织什么呢，我记得CA证书好像分三类的，然后还有该证书的 签名 以及 hash 值用于在通信中客户端鉴别此证书是否合法。<br><br>https 通信分为四个步骤：<br><br>1. c-&gt;s,客户端发起加密通信请求，这个请求通常叫做 ClientHello请求，告知自己支持的协议版本号，加密算法，压缩算法，以及一个用于生成后续通信密钥的随机数；<br>2. s-&gt;c,服务端响应，也叫作 ServerHello，确认加密通信协议，加密算法，以及一个用于生成后续通信密钥的随机数，还有网站证书；<br>3. c-&gt;s,客户端在收到上一步服务端的响应之后，首先会检查证书的颁发者是否可信任，是否过期，域名是否一致，并且从操作系统的证书链中找出该证书的上一级证书，并拿出服务端证书的公钥，然后验证签名和hash，如果验证失败，就会显示警告，我们经常在Chrome里面看到，“此网站有风险，是否继续什么的”。如果验证通过，客户端会向服务端发送一个称作 “pre-master-key” 的随机数，该随机数使用证书的公钥加密，以及编码改变通知（以后咋们就用协商的密钥堆成加密通信了），客户端完成握手。<br>4. 服务端在收到上一步客户端请求之后，也会确认我以后发给你的信息可就加密了哦，并且完成握手。<br><br>此时，客户端有第一步自己生成的随机数，第二步收到服务端的随机数，第三步的 pre-master-key，服务端也是如此，他们就可以用这三个随机数使用约定的算法生成同一个密钥来加密以后的通信数据了。<br>","like_count":136,"discussions":[{"author":{"id":1067087,"avatar":"https://static001.geekbang.org/account/avatar/00/10/48/4f/41bb9caa.jpg","nickname":"李贺","note":"","ucode":"D9AE08BFCF1B63","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":312256,"discussion_content":"“s->c,服务端响应，也叫作 ServerHello，确认加密通信协议，加密算法，以及一个用于生成后续通信密钥的随机数，还有网站证书；”\ns发送“证书”和“签名”。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1602642731,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":13304,"user_name":"monkay","can_delete":false,"product_type":"c1","uid":1066182,"ip_address":"","ucode":"07C0BB8A47799A","user_header":"http://thirdwx.qlogo.cn/mmopen/vi_32/pc41FOKAiabVaaKiawibEm7zglvnsYBnYeRiaSAElf9ciczovXmXmI0hOeR6U9RULFtMoqX5kobNttvwXCLsUM9Hbcg/132","comment_is_top":false,"comment_ctime":1529535830,"is_pvip":false,"discussion_count":15,"race_medal":0,"score":"190508096854","product_id":100007101,"comment_content":"会不会存在浏览器第一次向外卖网站请求证书时就被黑客拦截了，然后黑客用自己服务器去权威机构请求正规的证书，然后发给用户，之后的交互，用户以为是跟外卖网站交互，其实背后是跟黑客的网站交互","like_count":44,"discussions":[{"author":{"id":1473263,"avatar":"https://static001.geekbang.org/account/avatar/00/16/7a/ef/460b1397.jpg","nickname":"温宇涛","note":"","ucode":"ABE7D7F6FA4B08","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":3105,"discussion_content":"黑客没有私钥，有一个随机数无法解密，后续对称加密会失败。\n一般是通过中间人来截取信息，类似抓包工具。但前提是客户端要信任中间人的证书。","likes_number":16,"is_delete":false,"is_hidden":false,"ctime":1564190703,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":2,"child_discussions":[{"author":{"id":2017955,"avatar":"","nickname":"mike","note":"","ucode":"47CBC86B09298E","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":1473263,"avatar":"https://static001.geekbang.org/account/avatar/00/16/7a/ef/460b1397.jpg","nickname":"温宇涛","note":"","ucode":"ABE7D7F6FA4B08","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":325704,"discussion_content":"学习了","likes_number":1,"is_delete":false,"is_hidden":false,"ctime":1605410078,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":3105,"ip_address":""},"score":325704,"extra":""},{"author":{"id":1697605,"avatar":"https://wx.qlogo.cn/mmopen/vi_32/KUWZH9adGNsjZ6m9hYh6ttoibgcUnaplS7XGlYuyUybLpdLPZDB56QAlzfQ8wSfs8Pd1T9RiaY7sYibD2wgrCo0UQ/132","nickname":"xyh","note":"","ucode":"CD0C45A63F434E","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":1473263,"avatar":"https://static001.geekbang.org/account/avatar/00/16/7a/ef/460b1397.jpg","nickname":"温宇涛","note":"","ucode":"ABE7D7F6FA4B08","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":350901,"discussion_content":"是的，我想了一下，应该是客户端给服务端的那个随机数，是用服务端给的公钥加密了的，黑客没有服务端私钥，不能解密。黑客可以拿到服务端的公钥，解密服务端给的随机数（但是因为CA的存在，黑客没法更改公钥，如果可以更改，那他就可以把自己的公钥给客户端，解密得到客户端生成的随机数，从而获取到最后对称加密的密钥）","likes_number":1,"is_delete":false,"is_hidden":false,"ctime":1614068405,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":3105,"ip_address":""},"score":350901,"extra":""}]},{"author":{"id":1541386,"avatar":"https://static001.geekbang.org/account/avatar/00/17/85/0a/e564e572.jpg","nickname":"N_H","note":"","ucode":"109B67557AB3CE","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":3196,"discussion_content":"权威机构颁发某个证书前会通过各种线上线下的方式进行机构认证，不是能随便得到机构认证的。","likes_number":11,"is_delete":false,"is_hidden":false,"ctime":1564294967,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":2352021,"avatar":"https://static001.geekbang.org/account/avatar/00/23/e3/95/bc8241d9.jpg","nickname":"剁手","note":"","ucode":"0925A8C7782A99","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":336403,"discussion_content":"中间人攻击：c---hacker---s。   c首先与黑客建立https连接，然后c拿到的是黑客的公钥，所以c的真实请求会被黑客获取\n然后黑客代替c去请求时（黑客与s直接是真正的正常的https），s返回数据给黑客，此时数据对于黑客来说是明文的，黑客再通过与c之间建立的https连接返回给c，此时如果c与s之间的所有通信都被黑客劫持。","likes_number":7,"is_delete":false,"is_hidden":false,"ctime":1608564506,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":2,"child_discussions":[{"author":{"id":1201350,"avatar":"https://static001.geekbang.org/account/avatar/00/12/54/c6/c2481790.jpg","nickname":"lisiur","note":"","ucode":"CEB2DBCE29CAA7","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":2352021,"avatar":"https://static001.geekbang.org/account/avatar/00/23/e3/95/bc8241d9.jpg","nickname":"剁手","note":"","ucode":"0925A8C7782A99","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":393632,"discussion_content":"中间人如果篡改证书，在 c 端应该无法验证通过吧？","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1631524660,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":336403,"ip_address":""},"score":393632,"extra":""},{"author":{"id":1684297,"avatar":"https://static001.geekbang.org/account/avatar/00/19/b3/49/79024ed2.jpg","nickname":"Tr丶Zoey","note":"","ucode":"34A30F97E5A9DF","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":2352021,"avatar":"https://static001.geekbang.org/account/avatar/00/23/e3/95/bc8241d9.jpg","nickname":"剁手","note":"","ucode":"0925A8C7782A99","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":410730,"discussion_content":"😂闲鱼有这样的骗子，新建一个和卖家一毛一样的账号，卖一样的东西。买家来买就作为中间人转发买家卖家的话，然后等买家卖家见面一手交钱一手交货，发现钱到了骗子账户。","likes_number":3,"is_delete":false,"is_hidden":false,"ctime":1635767371,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":336403,"ip_address":""},"score":410730,"extra":""}]},{"author":{"id":1124948,"avatar":"https://static001.geekbang.org/account/avatar/00/11/2a/54/c9990105.jpg","nickname":"bro.","note":"","ucode":"D65283CD869804","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":219834,"discussion_content":"你请求的时候是带网站的,网站信息时唯一的,而黑客即使截取了用他的证书给你了,也不可能是这个网站信息,你拿这个证书去CA背书的时候人家认证不了,解不出来时你请求的网站信息,报出错误.网站跟证书是连着的,你不可能让CA给你背书一个美团网站的证书的","likes_number":8,"is_delete":false,"is_hidden":false,"ctime":1585815991,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1529929,"avatar":"","nickname":"起风了001","note":"","ucode":"8DCDBA40B8CC9F","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":277198,"discussion_content":"网站的证书申请过程有一个步骤是验证网站的所有权, 所以只有拥有这个域名的人才能申请到证书的","likes_number":5,"is_delete":false,"is_hidden":false,"ctime":1591016455,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1294453,"avatar":"https://static001.geekbang.org/account/avatar/00/13/c0/75/92b953a5.jpg","nickname":"澤","note":"","ucode":"AFD6A55B7BC55B","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":257193,"discussion_content":"证书的域名、所有者和原网站对不起来，校验不通过的","likes_number":5,"is_delete":false,"is_hidden":false,"ctime":1588526522,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1180466,"avatar":"https://static001.geekbang.org/account/avatar/00/12/03/32/89f29578.jpg","nickname":"robin","note":"","ucode":"06D7FAB79AC33F","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":73827,"discussion_content":"证书上有网站信息，客户端校验证书合法时会校验网站信息","likes_number":5,"is_delete":false,"is_hidden":false,"ctime":1575599029,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1486173,"avatar":"https://static001.geekbang.org/account/avatar/00/16/ad/5d/abc6ba62.jpg","nickname":"最后的、魔法师","note":"","ucode":"A8E71CD285EAD7","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":297834,"discussion_content":"从评论看就知道有不少人其实只是以为自己理解清楚了","likes_number":2,"is_delete":false,"is_hidden":false,"ctime":1597069682,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":2524584,"avatar":"https://static001.geekbang.org/account/avatar/00/26/85/a8/880a3b16.jpg","nickname":"别哭，我看着会心疼的","note":"","ucode":"9B903E07205EA6","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":554387,"discussion_content":"中间人调换证书，域名肯定会被换掉，最后客户端核验会比较要访问的域名和证书域名是否一致的","likes_number":1,"is_delete":false,"is_hidden":false,"ctime":1646361618,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1253001,"avatar":"https://static001.geekbang.org/account/avatar/00/13/1e/89/95d7da1d.jpg","nickname":"古么🐯🐯","note":"","ucode":"C06FAFCD94B794","race_medal":0,"user_type":1,"is_pvip":true},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":306166,"discussion_content":"黑客拿到证书以后只要不修改就没事，只要修改证书客户端在检验证书的签名时就不通过","likes_number":1,"is_delete":false,"is_hidden":false,"ctime":1600187215,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1218937,"avatar":"https://static001.geekbang.org/account/avatar/00/12/99/79/74d4f24f.jpg","nickname":"anker","note":"","ucode":"6EDF1FB9D45238","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":125496,"discussion_content":"一般来说，每个操作系统安装的时候会有一些权威机构的ca文件，用于检验服务器签名","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1578488384,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":3,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":13196,"user_name":"LEON","can_delete":false,"product_type":"c1","uid":1109922,"ip_address":"","ucode":"58F7AF5302FCAD","user_header":"https://static001.geekbang.org/account/avatar/00/10/ef/a2/6ea5bb9e.jpg","comment_is_top":false,"comment_ctime":1529454636,"is_pvip":true,"replies":[{"id":"4445","content":"谢谢","user_name":"作者回复","user_name_real":"刘超@网易云","uid":"1001590","ctime":1529472305,"ip_address":"","comment_id":13196,"utype":1}],"discussion_count":4,"race_medal":0,"score":"186213048364","product_id":100007101,"comment_content":"这张SSL握手的图，真的棒！","like_count":43,"discussions":[{"author":{"id":1001590,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/48/76/0c7d4d23.jpg","nickname":"刘超","note":"","ucode":"196BF3F499E8FE","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":419572,"discussion_content":"谢谢","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1529472305,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":3,"child_discussions":[{"author":{"id":1698679,"avatar":"https://static001.geekbang.org/account/avatar/00/19/eb/77/ffd16123.jpg","nickname":"重洋","note":"","ucode":"B896A81B579BEA","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":1001590,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/48/76/0c7d4d23.jpg","nickname":"刘超","note":"","ucode":"196BF3F499E8FE","race_medal":0,"user_type":2,"is_pvip":false},"discussion":{"id":533258,"discussion_content":"刘超大佬，请教个问题：这张图有个地方不明白，这是单向认证是吗？为何客户端也要向服务端发送证书呢？","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1637826589,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":419572,"ip_address":""},"score":533258,"extra":"{\"user_type\":1}"},{"author":{"id":2806043,"avatar":"https://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTLBFkSq1oiaEMRjtyyv4ZpCI0OuaSsqs04ODm0OkZF6QhsAh3SvqhxibS2n7PLAVZE3QRSn5Hic0DyXg/132","nickname":"ddh","note":"","ucode":"8E852375365F16","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":1698679,"avatar":"https://static001.geekbang.org/account/avatar/00/19/eb/77/ffd16123.jpg","nickname":"重洋","note":"","ucode":"B896A81B579BEA","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":544248,"discussion_content":"客户端也要给服务端发消息啊， 黑客要是模拟客户端， 不也是一样凉凉，文章中有提到","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1641448953,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":533258,"ip_address":""},"score":544248,"extra":""},{"author":{"id":1698679,"avatar":"https://static001.geekbang.org/account/avatar/00/19/eb/77/ffd16123.jpg","nickname":"重洋","note":"","ucode":"B896A81B579BEA","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":2806043,"avatar":"https://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTLBFkSq1oiaEMRjtyyv4ZpCI0OuaSsqs04ODm0OkZF6QhsAh3SvqhxibS2n7PLAVZE3QRSn5Hic0DyXg/132","nickname":"ddh","note":"","ucode":"8E852375365F16","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":544435,"discussion_content":"一般情况下https是单向认证，也就是指服务端有证书，客服端解析服务端的证书。我说的双向认证是指客户端也有证书，服务端提供自己证书的同时这要求客服端提供证书，这样可以禁止没有证书的客服端访问。\n后来想了想，这张图是双向认证，只是细节和书上不太一样。\n“黑客模拟客服端”我没明白明白什么意思，https本身就可以防止黑客在过程中篡改。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1641521869,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":544248,"ip_address":""},"score":544435,"extra":""}]}]},{"had_liked":false,"id":97264,"user_name":"zj","can_delete":false,"product_type":"c1","uid":1100064,"ip_address":"","ucode":"E3329CCF694AC2","user_header":"https://static001.geekbang.org/account/avatar/00/10/c9/20/e4f1b17c.jpg","comment_is_top":false,"comment_ctime":1558623354,"is_pvip":false,"discussion_count":5,"race_medal":0,"score":"151882478714","product_id":100007101,"comment_content":"Nonce是由服务器生成的一个随机数，在客户端第一次请求页面时将其发回客户端；客户端拿到这个Nonce，将其与用户密码串联在一起并进行非可逆加密（MD5、SHA1等等），然后将这个加密后的字符串和用户名、Nonce、加密算法名称一起发回服务器；服务器使用接收到的用户名到数据库搜索密码，然后跟客户端使用同样的算法对其进行加密，接着将其与客户端提交上来的加密字符串进行比较，如果两个字符串一致就表示用户身份有效。这样就解决了用户密码明文被窃取的问题，攻击者就算知道了算法名和nonce也无法解密出密码。<br><br> <br><br>每个nonce只能供一个用户使用一次，这样就可以防止攻击者使用重放攻击，因为该Http报文已经无效。可选的实现方式是把每一次请求的Nonce保存到数据库，客户端再一次提交请求时将请求头中得Nonce与数据库中得数据作比较，如果已存在该Nonce，则证明该请求有可能是恶意的。然而这种解决方案也有个问题，很有可能在两次正常的资源请求中，产生的随机数是一样的，这样就造成正常的请求也被当成了攻击，随着数据库中保存的随机数不断增多，这个问题就会变得很明显。所以，还需要加上另外一个参数Timestamp（时间戳）。<br><br> <br><br>Timestamp是根据服务器当前时间生成的一个字符串，与nonce放在一起，可以表示服务器在某个时间点生成的随机数。这样就算生成的随机数相同，但因为它们生成的时间点不一样，所以也算有效的随机数","like_count":35,"discussions":[{"author":{"id":1344044,"avatar":"https://static001.geekbang.org/account/avatar/00/14/82/2c/ba9025a1.jpg","nickname":"熬夜的熊猫","note":"","ucode":"20E259E3D1A3F0","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":259325,"discussion_content":"如果是这样的话，那数据库中的密码是明文存储，没有加salt的吗？","likes_number":4,"is_delete":false,"is_hidden":false,"ctime":1588774101,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1481065,"avatar":"http://thirdwx.qlogo.cn/mmopen/vi_32/BnzAUnic9oAGQQ7BkK3CujP109RAESq4WicDwbUIia1BQhMf8LsVHu3e6YKGaAHicbxnCw8sicUeic2V978ff74t1ReA/132","nickname":"Geek_98b975","note":"","ucode":"8F8D19A986B811","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":2135,"discussion_content":"感觉老师就是在读ppt。。。忽然就蒙蔽了。。。","likes_number":1,"is_delete":false,"is_hidden":false,"ctime":1563275284,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1229070,"avatar":"https://static001.geekbang.org/account/avatar/00/12/c1/0e/2b987d54.jpg","nickname":"蜉蝣","note":"","ucode":"77CF92496855D4","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":820,"discussion_content":"老师突然说到重放与篡改，我直接看蒙了，不知道怎么回事儿，感谢你的说明！","likes_number":1,"is_delete":false,"is_hidden":false,"ctime":1562078769,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1311125,"avatar":"https://static001.geekbang.org/account/avatar/00/14/01/95/fd09e8a8.jpg","nickname":"布拉姆","note":"","ucode":"479FF27D73BCAD","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":403371,"discussion_content":"mark，虽然客户端发的被加密的pwd不可逆，但是由于服务端知道随机数和加密算法，因此可以根据用户名去搜索pwd，还原出被加密的pwd来比对验证。因为不可逆其实针对的只是黑客而已。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1634052576,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1000417,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/43/e1/b7be5560.jpg","nickname":"sam","note":"","ucode":"8D48F4B9045947","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":285981,"discussion_content":"感谢补充分享","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1593004773,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":92302,"user_name":"dovefi","can_delete":false,"product_type":"c1","uid":1007670,"ip_address":"","ucode":"9F8C59F095B187","user_header":"https://static001.geekbang.org/account/avatar/00/0f/60/36/1848c2b7.jpg","comment_is_top":false,"comment_ctime":1557226255,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"130406245135","product_id":100007101,"comment_content":"https 核心思想，首先数字证书保证了服务端公钥的可靠性，客户端确认完可靠性之后，就用这个公钥去加密pre-master，服务端收到加密后的数据，用自己的私钥去解开，得到pre-master，然后两边都有了①客户端的随机数 ②服务端的随机数 ③pre-master  然后就各自通过计算得到一样的值，就当做公钥。后面就是对称加密的数据传输。这个过程中，对称加密的公钥从来没有在网络上传输过，所以不存在暴露的微信，ca证书中的解密是通过不对称的加密方式实现的，而且保证了公钥的可靠性，所以这里不怕别人拿到公钥，因为私钥他没有，也不怕别人伪造私钥和公钥，因为ca保证了公钥是可靠的","like_count":30},{"had_liked":false,"id":64125,"user_name":"isaac","can_delete":false,"product_type":"c1","uid":1151854,"ip_address":"","ucode":"62ACA5B9A44D1D","user_header":"http://thirdwx.qlogo.cn/mmopen/vi_32/THkFNC52F0kYs2XI1fwxOvCck0Pibwnia4z6fzCPMRg2qYQLlt57qW4caJZ6uj9lWROc7t1OHFmIdKmiaEIP2GXpg/132","comment_is_top":false,"comment_ctime":1548671539,"is_pvip":false,"replies":[{"id":"25821","content":"赞，对的","user_name":"作者回复","user_name_real":"刘超@网易云","uid":"1001590","ctime":1551424164,"ip_address":"","comment_id":64125,"utype":1}],"discussion_count":1,"race_medal":0,"score":"113217821235","product_id":100007101,"comment_content":"单向认证中的三个随机数可能是为了保证完全随机吧，毕竟所有的机器都是伪随机的","like_count":26,"discussions":[{"author":{"id":1001590,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/48/76/0c7d4d23.jpg","nickname":"刘超","note":"","ucode":"196BF3F499E8FE","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":437871,"discussion_content":"赞，对的","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1551424164,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":14322,"user_name":"小先生","can_delete":false,"product_type":"c1","uid":1055214,"ip_address":"","ucode":"E5F2052E0323C0","user_header":"https://static001.geekbang.org/account/avatar/00/10/19/ee/e395a35e.jpg","comment_is_top":false,"comment_ctime":1530287220,"is_pvip":false,"discussion_count":2,"race_medal":0,"score":"108904469620","product_id":100007101,"comment_content":"新学到的一点，CA 证书的作用，是保证服务器的公钥的来历。其做法是对公钥进行哈希摘要算法，然后用 CA 私钥加密，伴随公钥一起发送出去。<br>客户端收到后，用 CA 公钥解密，然后对公钥做哈希，比对哈希值是否一致来做到的。","like_count":25,"discussions":[{"author":{"id":2352021,"avatar":"https://static001.geekbang.org/account/avatar/00/23/e3/95/bc8241d9.jpg","nickname":"剁手","note":"","ucode":"0925A8C7782A99","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":336405,"discussion_content":"公钥：加密，传给  私钥解密\n私钥：签名，传给  公钥验证\n\n因为公钥是公开的，所以私钥不能加密，否则都能拿着公钥进行解密了，有何意义。\n\n公钥是进行加密，然后私钥进行解密。传输过程加密的。\n私钥是进行签名，公钥进行验证（不可抵赖性）证明是私钥方发送的。\n\n双方想加密传输是通过非对称加密交换协商对称密钥，然后加密传输过程是双方协商的对称密钥进行的。\n","likes_number":2,"is_delete":false,"is_hidden":false,"ctime":1608565076,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":2352021,"avatar":"https://static001.geekbang.org/account/avatar/00/23/e3/95/bc8241d9.jpg","nickname":"剁手","note":"","ucode":"0925A8C7782A99","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":336407,"discussion_content":"ca证书用来验证是服务器的，证书里带有服务器端的公钥和数字签名，数字签名用来验证公钥确实是服务器的。然后释放公钥给客户端。\n\n\n操作系统内置ca的公钥又可以用来验证这个数字证书确实是ca的。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1608565293,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":13193,"user_name":"沙亮亮","can_delete":false,"product_type":"c1","uid":1099492,"ip_address":"","ucode":"E6CF0D5B1E6691","user_header":"https://static001.geekbang.org/account/avatar/00/10/c6/e4/ec572f55.jpg","comment_is_top":false,"comment_ctime":1529454360,"is_pvip":false,"discussion_count":9,"race_medal":0,"score":"108903636760","product_id":100007101,"comment_content":"https还是可以被抓包，可以讲下抓https包的原理","like_count":25,"discussions":[{"author":{"id":1332365,"avatar":"http://thirdwx.qlogo.cn/mmopen/vi_32/DYAIOgq83eqfr72m4ZDA9SVvCSwsYDDUGTasBur9kAcnvyRQXH9D9icLnZ88zXPVMcssmZcvu1zBFTicgLyrwkqQ/132","nickname":"ljb","note":"","ucode":"CA29D702569D06","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":40318,"discussion_content":"抓包工具作为中间人，客户端需要安装中间人的证书","likes_number":8,"is_delete":false,"is_hidden":false,"ctime":1572162248,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":4,"child_discussions":[{"author":{"id":1310798,"avatar":"https://static001.geekbang.org/account/avatar/00/14/00/4e/be2b206b.jpg","nickname":"吴小智","note":"","ucode":"C7C9F58B5C9F7B","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":1332365,"avatar":"http://thirdwx.qlogo.cn/mmopen/vi_32/DYAIOgq83eqfr72m4ZDA9SVvCSwsYDDUGTasBur9kAcnvyRQXH9D9icLnZ88zXPVMcssmZcvu1zBFTicgLyrwkqQ/132","nickname":"ljb","note":"","ucode":"CA29D702569D06","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":250104,"discussion_content":"就相当于抓包工具是一个代理服务器？浏览器实际上是和抓包工具进行 https 通信？","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1587992128,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":40318,"ip_address":""},"score":250104,"extra":""},{"author":{"id":1332365,"avatar":"http://thirdwx.qlogo.cn/mmopen/vi_32/DYAIOgq83eqfr72m4ZDA9SVvCSwsYDDUGTasBur9kAcnvyRQXH9D9icLnZ88zXPVMcssmZcvu1zBFTicgLyrwkqQ/132","nickname":"ljb","note":"","ucode":"CA29D702569D06","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":1310798,"avatar":"https://static001.geekbang.org/account/avatar/00/14/00/4e/be2b206b.jpg","nickname":"吴小智","note":"","ucode":"C7C9F58B5C9F7B","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":289056,"discussion_content":"对","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1593962804,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":250104,"ip_address":""},"score":289056,"extra":""},{"author":{"id":1523315,"avatar":"","nickname":"GeekCoder","note":"","ucode":"14BB73CBE28545","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":1332365,"avatar":"http://thirdwx.qlogo.cn/mmopen/vi_32/DYAIOgq83eqfr72m4ZDA9SVvCSwsYDDUGTasBur9kAcnvyRQXH9D9icLnZ88zXPVMcssmZcvu1zBFTicgLyrwkqQ/132","nickname":"ljb","note":"","ucode":"CA29D702569D06","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":574036,"discussion_content":"中间代理人的CA证书和访问的网站信息不匹配，客户端怎么是通过CA验证的？","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1653808185,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":40318,"ip_address":""},"score":574036,"extra":""}]},{"author":{"id":1176426,"avatar":"https://static001.geekbang.org/account/avatar/00/11/f3/6a/6d82e7a3.jpg","nickname":"暮雨","note":"","ucode":"4B7F4932446EF7","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":315007,"discussion_content":"分两种，一种旁路抓，一种代理抓，代理的方式就相当于浏览器和代理服务器建立tls链接，可以把证书卸掉，旁路抓包，解https的包就比较复杂了","likes_number":3,"is_delete":false,"is_hidden":false,"ctime":1603231719,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1484184,"avatar":"https://static001.geekbang.org/account/avatar/00/16/a5/98/a65ff31a.jpg","nickname":"djfhchdh","note":"","ucode":"E71D75328CE398","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":297714,"discussion_content":"需要客户端信任抓包软件的证书","likes_number":2,"is_delete":false,"is_hidden":false,"ctime":1597032057,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":1,"child_discussions":[{"author":{"id":1523315,"avatar":"","nickname":"GeekCoder","note":"","ucode":"14BB73CBE28545","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":1484184,"avatar":"https://static001.geekbang.org/account/avatar/00/16/a5/98/a65ff31a.jpg","nickname":"djfhchdh","note":"","ucode":"E71D75328CE398","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":574041,"discussion_content":"信任之后，代理给的证书和网站信息也不匹配吧？","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1653809600,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":297714,"ip_address":""},"score":574041,"extra":""}]},{"author":{"id":1121758,"avatar":"https://static001.geekbang.org/account/avatar/00/11/1d/de/62bfa83f.jpg","nickname":"aoe","note":"","ucode":"1C6201EDB4E954","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":265298,"discussion_content":"你不要在本机抓包，你抓别的机器交互时的包，可以抓到，但没证书，不能解密","likes_number":1,"is_delete":false,"is_hidden":false,"ctime":1589382848,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":13236,"user_name":"飞龙在天","can_delete":false,"product_type":"c1","uid":1018901,"ip_address":"","ucode":"7545DF02BA4763","user_header":"https://static001.geekbang.org/account/avatar/00/0f/8c/15/f85c0121.jpg","comment_is_top":false,"comment_ctime":1529460528,"is_pvip":false,"replies":[{"id":"4440","content":"会建立session","user_name":"作者回复","user_name_real":"刘超@网易云","uid":"1001590","ctime":1529471700,"ip_address":"","comment_id":13236,"utype":1}],"discussion_count":1,"race_medal":0,"score":"87428806448","product_id":100007101,"comment_content":"老师你好：<br>https协议中，客户端和服务端信息传输使用了对称加密，疑惑的是服务器端是怎样识别多个客户端的公钥呢？项目中并没有对此做特殊的处理，希望老师解惑o(^o^)o。","like_count":21,"discussions":[{"author":{"id":1001590,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/48/76/0c7d4d23.jpg","nickname":"刘超","note":"","ucode":"196BF3F499E8FE","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":419585,"discussion_content":"会建立session","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1529471700,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":185598,"user_name":"Geek_f1933b","can_delete":false,"product_type":"c1","uid":1799937,"ip_address":"","ucode":"9045A7ED2B2A69","user_header":"http://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTKSVGSo9leSm0vhtHgzIOL7uaJhOcaImuIzLIrVhXUNPmhd9HGIxs0nWIQm5RTCEjwJ6IuG3moOdQ/132","comment_is_top":false,"comment_ctime":1583641478,"is_pvip":false,"discussion_count":1,"race_medal":0,"score":"53123249030","product_id":100007101,"comment_content":"对老师的证书生成的签名算法和用户校验再细化一下，有问题请大家指教哈<br>证书生成的签名算法：<br>1、服务器公钥 经过数字摘要算法 生成数字指纹<br>2、把生成的数字指纹 在用认证机构的私钥加密 生成数字签名<br>用户校验证书：<br>1、客户端取出提前内置在系统内部的认证机构的公钥<br>2、用认证机构的公钥去解密公钥证书里的数字签名 从而得到数字指纹<br>3、客户端对公钥证书的服务器公钥进行 数字摘要算法 从而生成数字指纹<br>4、对比客户端自己生成的数字指纹(第3步)和解密得到的数字指纹(第2步)是否一致 如果一致则公钥证书验证通过 就可以进行接下来的握手步骤了<br>","like_count":12,"discussions":[{"author":{"id":2181781,"avatar":"","nickname":"赵天天","note":"","ucode":"456924B8A0763F","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":381733,"discussion_content":"\n我觉得你细化的很好，另外专栏中写证书请求的命令是“openssl req -key cliu8siteprivate.key -new -out cliu8sitecertificate.req”，证书中包含的不是公钥吗，为什么要传私钥？请问您看懂为什么了吗？","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1625195374,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":15608,"user_name":"森码","can_delete":false,"product_type":"c1","uid":1154799,"ip_address":"","ucode":"7D46C73EFA1987","user_header":"https://static001.geekbang.org/account/avatar/00/11/9e/ef/a74049d9.jpg","comment_is_top":false,"comment_ctime":1531323770,"is_pvip":false,"replies":[{"id":"5337","content":"如果双向认证，其实是可以的，但是不都是双向认证","user_name":"作者回复","user_name_real":"刘超@网易云","uid":"1001590","ctime":1531362017,"ip_address":"","comment_id":15608,"utype":1}],"discussion_count":6,"race_medal":0,"score":"53070931322","product_id":100007101,"comment_content":"客户端和服务端为什么要分别传输一个随机数呢？通过公钥加密Pre-master不是就可以用吗？","like_count":12,"discussions":[{"author":{"id":1001590,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/48/76/0c7d4d23.jpg","nickname":"刘超","note":"","ucode":"196BF3F499E8FE","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":420470,"discussion_content":"如果双向认证，其实是可以的，但是不都是双向认证","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1531362017,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1135299,"avatar":"https://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTKzqiaZnBw2myRWY802u48Rw3W2zDtKoFQ6vN63m4FdyjibM21FfaOYe8MbMpemUdxXJeQH6fRdVbZA/132","nickname":"kissingers","note":"","ucode":"615151808CF628","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":388166,"discussion_content":"增加密钥随机性","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1628642339,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1132316,"avatar":"https://static001.geekbang.org/account/avatar/00/11/47/1c/1219b946.jpg","nickname":"Star. D","note":"","ucode":"058DCFD6F813E9","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":378240,"discussion_content":"疑惑+1","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1623122026,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1657053,"avatar":"https://static001.geekbang.org/account/avatar/00/19/48/dd/91920a70.jpg","nickname":"怪及","note":"","ucode":"E940EAAB43FC2C","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":372508,"discussion_content":"疑惑+1","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1620357866,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1782777,"avatar":"https://static001.geekbang.org/account/avatar/00/1b/33/f9/50b76abe.jpg","nickname":"AMIR","note":"","ucode":"65142D9669071B","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":134738,"discussion_content":"同样的疑问","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1579049407,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":1,"child_discussions":[{"author":{"id":1124948,"avatar":"https://static001.geekbang.org/account/avatar/00/11/2a/54/c9990105.jpg","nickname":"bro.","note":"","ucode":"D65283CD869804","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":1782777,"avatar":"https://static001.geekbang.org/account/avatar/00/1b/33/f9/50b76abe.jpg","nickname":"AMIR","note":"","ucode":"65142D9669071B","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":219837,"discussion_content":"我知道你,你也知道我","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1585816101,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":134738,"ip_address":""},"score":219837,"extra":""}]}]},{"had_liked":false,"id":25759,"user_name":"shupian418","can_delete":false,"product_type":"c1","uid":1147915,"ip_address":"","ucode":"2B5A9574AA0C6F","user_header":"","comment_is_top":false,"comment_ctime":1537437146,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"48782077402","product_id":100007101,"comment_content":"https是要解决http中的问题：<br>1 明文传输，很容易被窃听<br>2 没有验证数据的完整性，容易被篡改<br>3 没有验证对端的身份，容易被伪装","like_count":11},{"had_liked":false,"id":93925,"user_name":"木头发芽","can_delete":false,"product_type":"c1","uid":1419723,"ip_address":"","ucode":"657B381C5DA963","user_header":"https://static001.geekbang.org/account/avatar/00/15/a9/cb/a431bde5.jpg","comment_is_top":false,"comment_ctime":1557668629,"is_pvip":false,"replies":[{"id":"49387","content":"是的","user_name":"作者回复","user_name_real":"刘超@网易云","uid":"1001590","ctime":1567654123,"ip_address":"","comment_id":93925,"utype":1}],"discussion_count":1,"race_medal":0,"score":"40212374293","product_id":100007101,"comment_content":"@monkay:证书里还带了域名，如果浏览器联的是外卖网站的域名，被黑客拦截发回了黑客的ca证书，校验证书的时候会发现域名不对从而证书认证失败","like_count":9,"discussions":[{"author":{"id":1001590,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/48/76/0c7d4d23.jpg","nickname":"刘超","note":"","ucode":"196BF3F499E8FE","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":449829,"discussion_content":"是的","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1567654123,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":62990,"user_name":"酷哥居士","can_delete":false,"product_type":"c1","uid":1300136,"ip_address":"","ucode":"FF721E6124F817","user_header":"http://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTJTL1kXMgeyk9hcCTDWbrwuAW2OiaJmHLTN3ZppVzKJXIXicia8D9a38Nb8vjfCEepFJyJJUqAknib2UQ/132","comment_is_top":false,"comment_ctime":1548222615,"is_pvip":false,"replies":[{"id":"25810","content":"是的","user_name":"作者回复","user_name_real":"刘超@网易云","uid":"1001590","ctime":1551423859,"ip_address":"","comment_id":62990,"utype":1}],"discussion_count":2,"race_medal":0,"score":"40202928279","product_id":100007101,"comment_content":"想请教老师一下，上面的HTTPS请求，客户端和服务端之间发送证书，验证证书，传输秘钥等等这些操作，是在HTTPS的TCP连接建立成功后做的吗？","like_count":9,"discussions":[{"author":{"id":1001590,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/48/76/0c7d4d23.jpg","nickname":"刘超","note":"","ucode":"196BF3F499E8FE","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":437429,"discussion_content":"是的","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1551423859,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1108695,"avatar":"https://static001.geekbang.org/account/avatar/00/10/ea/d7/9506fe35.jpg","nickname":"pllsxyc","note":"","ucode":"402B95BCA36779","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":284803,"discussion_content":"TLS握手之前，TCP三次握手是完成的，可以抓包看看","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1592644721,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":216749,"user_name":"曙光","can_delete":false,"product_type":"c1","uid":1476450,"ip_address":"","ucode":"04D65BF7F19845","user_header":"https://static001.geekbang.org/account/avatar/00/16/87/62/f99b5b05.jpg","comment_is_top":false,"comment_ctime":1589336010,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"35949074378","product_id":100007101,"comment_content":"这张就是双向认证的流程图吧，因为客户端发证书给服务器，单向认证客户端证书可发可不发；但双向认证，服务器一定需要客户端的证书。流程图画了客户端的证书，但文章描述说是单向认证，感觉有些歧义","like_count":8},{"had_liked":false,"id":16110,"user_name":"一步","can_delete":false,"product_type":"c1","uid":1005391,"ip_address":"","ucode":"73CEA468CE70C3","user_header":"https://static001.geekbang.org/account/avatar/00/0f/57/4f/6fb51ff1.jpg","comment_is_top":false,"comment_ctime":1531789627,"is_pvip":true,"replies":[{"id":"5572","content":"好的，后期补充一下","user_name":"作者回复","user_name_real":"刘超@网易云","uid":"1001590","ctime":1531792878,"ip_address":"","comment_id":16110,"utype":1}],"discussion_count":1,"race_medal":1,"score":"31596560699","product_id":100007101,"comment_content":"老师，可以补充一下https双向认证的流程图吗？","like_count":7,"discussions":[{"author":{"id":1001590,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/48/76/0c7d4d23.jpg","nickname":"刘超","note":"","ucode":"196BF3F499E8FE","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":420674,"discussion_content":"好的，后期补充一下","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1531792878,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":19209,"user_name":"李简单","can_delete":false,"product_type":"c1","uid":1167138,"ip_address":"","ucode":"0FEA07F1B19F13","user_header":"https://static001.geekbang.org/account/avatar/00/11/cf/22/2091d425.jpg","comment_is_top":false,"comment_ctime":1533707665,"is_pvip":false,"discussion_count":6,"race_medal":0,"score":"27303511441","product_id":100007101,"comment_content":"证书解密后，hash怎么算对上了呢？","like_count":6,"discussions":[{"author":{"id":1008307,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/62/b3/edf0f4d9.jpg","nickname":"indeyo","note":"","ucode":"3A9F99727B90DD","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":273099,"discussion_content":"如何验证公钥合法性？\n1. 证书里有公钥、所有者、发布机构、有效期、签名\n2. 用CA的公钥解密签名，得到Hash_A串\n3. 对公钥进行hash算法，得到Hash_B串\n4. 对比Hash_A和Hash_B，如果相等则验证通过","likes_number":6,"is_delete":false,"is_hidden":false,"ctime":1590411259,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":2,"child_discussions":[{"author":{"id":1194923,"avatar":"https://static001.geekbang.org/account/avatar/00/12/3b/ab/98d516c4.jpg","nickname":"把杯子倒进水里面","note":"","ucode":"E5931766F35D6A","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":1008307,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/62/b3/edf0f4d9.jpg","nickname":"indeyo","note":"","ucode":"3A9F99727B90DD","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":360988,"discussion_content":"所以说签名就是 公钥 hash后又经 CA私钥进行了加密后 得到的串","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1616574651,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":273099,"ip_address":""},"score":360988,"extra":""},{"author":{"id":2520742,"avatar":"https://static001.geekbang.org/account/avatar/00/26/76/a6/aac72751.jpg","nickname":"半点茶凉","note":"","ucode":"188BB33969D2D2","race_medal":0,"user_type":1,"is_pvip":true},"reply_author":{"id":1008307,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/62/b3/edf0f4d9.jpg","nickname":"indeyo","note":"","ucode":"3A9F99727B90DD","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":561292,"discussion_content":"我认为这里是有歧义的，第三步，并不是只对公钥进行hash算法，而是对公钥、所有者、发布机构、有效期一起进行hash，然后和Hash_A进行对比，否则如何判断证书中的所有者、发布机构、有效期没有被修改呢？","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1649595343,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":273099,"ip_address":""},"score":561292,"extra":""}]},{"author":{"id":1014526,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/7a/fe/abb7bfe3.jpg","nickname":"胡波 allenhu","note":"","ucode":"33C6217E9A385C","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":4090,"discussion_content":"明文和指纹都会传输给接收方。其中指纹会被私钥加密。接收方用公钥解出指纹，然后用同样的hash算法对明文计算出指纹，比对两个指纹是不是一样","likes_number":1,"is_delete":false,"is_hidden":false,"ctime":1565103744,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":1,"child_discussions":[{"author":{"id":1554764,"avatar":"https://static001.geekbang.org/account/avatar/00/17/b9/4c/8c9edc85.jpg","nickname":"小庞","note":"","ucode":"7C8367CDB47163","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":1014526,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/7a/fe/abb7bfe3.jpg","nickname":"胡波 allenhu","note":"","ucode":"33C6217E9A385C","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":4972,"discussion_content":"这个过程之前首先要通过证书链验证公钥的合法性","likes_number":1,"is_delete":false,"is_hidden":false,"ctime":1565862107,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":4090,"ip_address":""},"score":4972,"extra":""}]},{"author":{"id":1541386,"avatar":"https://static001.geekbang.org/account/avatar/00/17/85/0a/e564e572.jpg","nickname":"N_H","note":"","ucode":"109B67557AB3CE","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":3197,"discussion_content":"根据hash算法做一次hash计算，然后与解密出来的hash值进行比对","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1564295141,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":244414,"user_name":"仰望星空","can_delete":false,"product_type":"c1","uid":1149084,"ip_address":"","ucode":"A9E46C9FDB3275","user_header":"https://static001.geekbang.org/account/avatar/00/11/88/9c/cbc463e6.jpg","comment_is_top":false,"comment_ctime":1598510188,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"23073346668","product_id":100007101,"comment_content":"如果没有听到老师讲的，可以参考：https:&#47;&#47;blog.csdn.net&#47;guolin_blog&#47;article&#47;details&#47;104546558，写的非常好","like_count":5},{"had_liked":false,"id":16224,"user_name":"野猪佩奇","can_delete":false,"product_type":"c1","uid":1130942,"ip_address":"","ucode":"B1803FFE251E1A","user_header":"https://static001.geekbang.org/account/avatar/00/11/41/be/4893497a.jpg","comment_is_top":false,"comment_ctime":1531837050,"is_pvip":false,"replies":[{"id":"5661","content":"我自己做ca当然可以啊，只不过拿出去不算","user_name":"作者回复","user_name_real":"刘超@网易云","uid":"1001590","ctime":1531887593,"ip_address":"","comment_id":16224,"utype":1}],"discussion_count":2,"race_medal":0,"score":"23006673530","product_id":100007101,"comment_content":"老师你好，我之前听说获取CA证书都是需要给钱的，这边怎么一条命令就能获取一个证书啊？望解惑，谢谢","like_count":5,"discussions":[{"author":{"id":1001590,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/48/76/0c7d4d23.jpg","nickname":"刘超","note":"","ucode":"196BF3F499E8FE","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":420720,"discussion_content":"我自己做ca当然可以啊，只不过拿出去不算","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1531887593,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1108695,"avatar":"https://static001.geekbang.org/account/avatar/00/10/ea/d7/9506fe35.jpg","nickname":"pllsxyc","note":"","ucode":"402B95BCA36779","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":284801,"discussion_content":"就是自签名，放到浏览器里面就不认了","likes_number":1,"is_delete":false,"is_hidden":false,"ctime":1592644411,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":14205,"user_name":"烧饼","can_delete":false,"product_type":"c1","uid":1131503,"ip_address":"","ucode":"D1DBF419913E99","user_header":"https://static001.geekbang.org/account/avatar/00/11/43/ef/f4e600e5.jpg","comment_is_top":false,"comment_ctime":1530233491,"is_pvip":false,"replies":[{"id":"4778","content":"不是的，这几个都是计算对称密钥的材料","user_name":"作者回复","user_name_real":"刘超@网易云","uid":"1001590","ctime":1530276644,"ip_address":"","comment_id":14205,"utype":1}],"discussion_count":1,"race_medal":0,"score":"18710102675","product_id":100007101,"comment_content":"这里两个 hello 信息都是用明文传输的，包括里面的随机数，真正加密传输的是 Pre-master 。就是说外界完全可以抓取这两个随机数，真正影响外界窃取对称密钥的是 Pre-master ，那是不是意味着其实这两个随机数作用不大，可以去掉？","like_count":4,"discussions":[{"author":{"id":1001590,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/48/76/0c7d4d23.jpg","nickname":"刘超","note":"","ucode":"196BF3F499E8FE","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":419909,"discussion_content":"不是的，这几个都是计算对称密钥的材料","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1530276644,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":89108,"user_name":"王世林","can_delete":false,"product_type":"c1","uid":1076155,"ip_address":"","ucode":"2BB56D0FD71417","user_header":"https://static001.geekbang.org/account/avatar/00/10/6b/bb/10aaf123.jpg","comment_is_top":false,"comment_ctime":1556078552,"is_pvip":false,"replies":[{"id":"32036","content":"可以是两个","user_name":"作者回复","user_name_real":"刘超@网易云","uid":"1001590","ctime":1556195818,"ip_address":"","comment_id":89108,"utype":1}],"discussion_count":1,"race_medal":0,"score":"14440980440","product_id":100007101,"comment_content":"1.浏览器遍历操作系统列表中证书发布机构ca列表，如果与服务器端发来的证书机构ca一致， 则会用操作系统中的ca证书的公钥解密服务端证书的签名，浏览器使用相同的hash算法计算出服务器发来的证书的hash值，将这个计算的hash值与证书中签名做对比，对比结果一致，则证明服务器发来的证书合法，没有被冒充， 是这样的吗？ 2. 这个pre-master 是浏览器发给服务端， 最后生成相同的对称回话密钥， 我看网上还有的评论可以生成2个不同的回话密钥， 分别对应浏览器发给服务端信息和服务端发给浏览器信息","like_count":3,"discussions":[{"author":{"id":1001590,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/48/76/0c7d4d23.jpg","nickname":"刘超","note":"","ucode":"196BF3F499E8FE","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":448019,"discussion_content":"可以是两个","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1556195818,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":61010,"user_name":"夜雨声歇","can_delete":false,"product_type":"c1","uid":1209069,"ip_address":"","ucode":"02A06382BD5CC5","user_header":"https://static001.geekbang.org/account/avatar/00/12/72/ed/1d8398ea.jpg","comment_is_top":false,"comment_ctime":1547603937,"is_pvip":false,"discussion_count":1,"race_medal":0,"score":"14432505825","product_id":100007101,"comment_content":"理解：面对面交接“对称密钥”不可能，于是我就把密钥让靠谱的“快递公司”先传递给你。这过程只要想办法确保“快递公司”是正规的安全的就行了。","like_count":3,"discussions":[{"author":{"id":1257422,"avatar":"https://static001.geekbang.org/account/avatar/00/13/2f/ce/c72d4c67.jpg","nickname":"movesan","note":"","ucode":"29CDF0F2B604C8","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":176501,"discussion_content":"如果快递公司被截获了呢？带有网站的公钥的CA证书不是大家都可以拿到吗","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1582036572,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":15861,"user_name":"Jaime","can_delete":false,"product_type":"c1","uid":1078333,"ip_address":"","ucode":"904192CC4E916F","user_header":"https://static001.geekbang.org/account/avatar/00/10/74/3d/54bbc1df.jpg","comment_is_top":false,"comment_ctime":1531565766,"is_pvip":true,"discussion_count":0,"race_medal":0,"score":"14416467654","product_id":100007101,"comment_content":"https做请求缓存，来提高效率?视频要用udp协议，","like_count":3},{"had_liked":false,"id":13229,"user_name":"唐唐","can_delete":false,"product_type":"c1","uid":1029186,"ip_address":"","ucode":"52876E04BB3A9F","user_header":"","comment_is_top":false,"comment_ctime":1529458742,"is_pvip":false,"replies":[{"id":"4441","content":"证书会下载到浏览器本地，服务端不管，如果证书不对就验证失败","user_name":"作者回复","user_name_real":"刘超@网易云","uid":"1001590","ctime":1529472016,"ip_address":"","comment_id":13229,"utype":1}],"discussion_count":1,"race_medal":0,"score":"14414360630","product_id":100007101,"comment_content":"老师好，有个问题很疑惑，想请教一下。这个https是浏览器和服务器端的交互吧。那么这个证书对应安装到用户的浏览器了吗？服务器端怎么能知道用户安装的是什么证书，拿到该证书对应的公钥或私钥呢？浏览器是安装一个证书，还是对应不同服务器安装多个不同证书。","like_count":3,"discussions":[{"author":{"id":1001590,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/48/76/0c7d4d23.jpg","nickname":"刘超","note":"","ucode":"196BF3F499E8FE","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":419584,"discussion_content":"证书会下载到浏览器本地，服务端不管，如果证书不对就验证失败","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1529472016,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":277660,"user_name":"Wheat","can_delete":false,"product_type":"c1","uid":1260141,"ip_address":"","ucode":"7D99EA149B6DE8","user_header":"https://static001.geekbang.org/account/avatar/00/13/3a/6d/910b2445.jpg","comment_is_top":false,"comment_ctime":1612510544,"is_pvip":false,"discussion_count":2,"race_medal":0,"score":"10202445136","product_id":100007101,"comment_content":"专栏中写证书请求的命令是“openssl req -key cliu8siteprivate.key -new -out cliu8sitecertificate.req”，证书中包含的不是公钥吗，为什么要传私钥","like_count":2,"discussions":[{"author":{"id":1210361,"avatar":"https://static001.geekbang.org/account/avatar/00/12/77/f9/9d7bbf44.jpg","nickname":"亮剑","note":"","ucode":"E85A4DFD1A1CD2","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":587685,"discussion_content":"生成证书是根据私钥来生成的，证书里面也同样包含公钥、国家地区、省市、组织、域名等相关信息","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1663220094,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":"北京"},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":2181781,"avatar":"","nickname":"赵天天","note":"","ucode":"456924B8A0763F","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":381731,"discussion_content":"我也有此疑问","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1625195205,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":193647,"user_name":"小雨","can_delete":false,"product_type":"c1","uid":1007970,"ip_address":"","ucode":"A6332734063CC5","user_header":"https://static001.geekbang.org/account/avatar/00/0f/61/62/72296b09.jpg","comment_is_top":false,"comment_ctime":1584940924,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"10174875516","product_id":100007101,"comment_content":"说到自签名，为啥我想到12306😅","like_count":2},{"had_liked":false,"id":182623,"user_name":"Bojack","can_delete":false,"product_type":"c1","uid":1251080,"ip_address":"","ucode":"A57E552845DB28","user_header":"http://thirdwx.qlogo.cn/mmopen/vi_32/DYAIOgq83eoLw2qjwoaVCDq8BqCcXOibyTG3rxiaJlDy2lt62IkiaDrrHeVwq4Pe8RpBbYJTIiadyicZ7InBCLCjJtQ/132","comment_is_top":false,"comment_ctime":1582817146,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"10172751738","product_id":100007101,"comment_content":"证书请求是用私钥生成的，那CA签名后的证书里为什么会有公钥呢？","like_count":2},{"had_liked":false,"id":95102,"user_name":"Jerry银银","can_delete":false,"product_type":"c1","uid":1008404,"ip_address":"","ucode":"80DA1172A2360A","user_header":"https://static001.geekbang.org/account/avatar/00/0f/63/14/06eff9a4.jpg","comment_is_top":false,"comment_ctime":1557968656,"is_pvip":false,"replies":[{"id":"49345","content":"算法就是这样的哒","user_name":"作者回复","user_name_real":"刘超@网易云","uid":"1001590","ctime":1567650529,"ip_address":"","comment_id":95102,"utype":1}],"discussion_count":3,"race_medal":0,"score":"10147903248","product_id":100007101,"comment_content":"有几个疑问，希望老师帮忙解答：<br>1. 为什么需要三个随机数，我隐隐觉得是为了提高随机性，从而保证安全性，不知道理解对不对？<br>2. 为什么最后一个随机数叫pre-master？<br>3. 客户端可以连接代理服务器，代理服务器可以生成自签名证书，这样就可以抓包了，这种情况如何解决呢？","like_count":2,"discussions":[{"author":{"id":1001590,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/48/76/0c7d4d23.jpg","nickname":"刘超","note":"","ucode":"196BF3F499E8FE","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":450333,"discussion_content":"算法就是这样的哒","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1567650529,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1361159,"avatar":"http://thirdwx.qlogo.cn/mmopen/vi_32/DYAIOgq83eqJobg767PUeqrqQQ4B6YvMatj2SRyOicKZZ4gWTf30dMketiaj58Gc3RFTmckGxAXlL9ERSxGovq9g/132","nickname":"涛哥哥","note":"","ucode":"329A1384E3AB5E","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":281283,"discussion_content":"是为了保证完全随机，防止客户端产生的随机数有一定漏洞可以猜测出来，\n\t如果一旦猜测了一个随机数，前面会话的秘钥都有可能被破解出来，总而言之，\n\t保证完全随机，防止产生的随机数有漏洞","likes_number":1,"is_delete":false,"is_hidden":false,"ctime":1591705401,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":2459923,"avatar":"https://static001.geekbang.org/account/avatar/00/25/89/13/0d3c5008.jpg","nickname":"最好不过","note":"","ucode":"C7DBCD08402DF8","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":357783,"discussion_content":"这里的随机数时密钥交换算法所需要的，可以了解一下密钥交换算法即DH算法：Diffie-Hellman算法","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1615865729,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":92247,"user_name":"三件事","can_delete":false,"product_type":"c1","uid":1055819,"ip_address":"","ucode":"BCC867C8961A24","user_header":"https://static001.geekbang.org/account/avatar/00/10/1c/4b/2e5df06f.jpg","comment_is_top":false,"comment_ctime":1557212099,"is_pvip":false,"replies":[{"id":"49455","content":"可以的","user_name":"作者回复","user_name_real":"刘超@网易云","uid":"1001590","ctime":1567670297,"ip_address":"","comment_id":92247,"utype":1}],"discussion_count":1,"race_medal":0,"score":"10147146691","product_id":100007101,"comment_content":"一个证书可以有多个域名吗？","like_count":2,"discussions":[{"author":{"id":1001590,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/48/76/0c7d4d23.jpg","nickname":"刘超","note":"","ucode":"196BF3F499E8FE","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":449192,"discussion_content":"可以的","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1567670297,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":92245,"user_name":"三件事","can_delete":false,"product_type":"c1","uid":1055819,"ip_address":"","ucode":"BCC867C8961A24","user_header":"https://static001.geekbang.org/account/avatar/00/10/1c/4b/2e5df06f.jpg","comment_is_top":false,"comment_ctime":1557212060,"is_pvip":false,"replies":[{"id":"49456","content":"可以截获加密后的包","user_name":"作者回复","user_name_real":"刘超@网易云","uid":"1001590","ctime":1567670326,"ip_address":"","comment_id":92245,"utype":1}],"discussion_count":1,"race_medal":0,"score":"10147146652","product_id":100007101,"comment_content":"“没错，有了加密和解密，黑客截获了包也打不开了，但是它可以发送 N 次。这个往往通过 Timestamp 和 Nonce 随机数联合起来，然后做一个不可逆的签名来保证。”<br><br>这句没理解，为什么拿到了包也打不开？如果做了证书校验，黑客是拿不到包的吧？发现证书不对不会中止请求吗？","like_count":2,"discussions":[{"author":{"id":1001590,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/48/76/0c7d4d23.jpg","nickname":"刘超","note":"","ucode":"196BF3F499E8FE","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":449191,"discussion_content":"可以截获加密后的包","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1567670326,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":62995,"user_name":"酷哥居士","can_delete":false,"product_type":"c1","uid":1300136,"ip_address":"","ucode":"FF721E6124F817","user_header":"http://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTJTL1kXMgeyk9hcCTDWbrwuAW2OiaJmHLTN3ZppVzKJXIXicia8D9a38Nb8vjfCEepFJyJJUqAknib2UQ/132","comment_is_top":false,"comment_ctime":1548223204,"is_pvip":false,"replies":[{"id":"25812","content":"先tcp三次握手，然后再是http的连接","user_name":"作者回复","user_name_real":"刘超@网易云","uid":"1001590","ctime":1551423882,"ip_address":"","comment_id":62995,"utype":1}],"discussion_count":1,"race_medal":0,"score":"10138157796","product_id":100007101,"comment_content":"老师你好，有个疑惑，https的加密解密、验证证书、传输密钥等属于tcp的三次握手吗？http基于tcp要先进行三次握手我能理解，那https的三次握手是怎么样的，上面传输密钥的过程属不属于三次握手？不属于的话，那什么时候进行三次握手","like_count":2,"discussions":[{"author":{"id":1001590,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/48/76/0c7d4d23.jpg","nickname":"刘超","note":"","ucode":"196BF3F499E8FE","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":437431,"discussion_content":"先tcp三次握手，然后再是http的连接","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1551423882,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":36303,"user_name":"无名","can_delete":false,"product_type":"c1","uid":1110113,"ip_address":"","ucode":"2D2E877CF97138","user_header":"https://static001.geekbang.org/account/avatar/00/10/f0/61/68462a07.jpg","comment_is_top":false,"comment_ctime":1541033863,"is_pvip":false,"replies":[{"id":"12966","content":"有啊，http + ssl","user_name":"作者回复","user_name_real":"刘超@网易云","uid":"1001590","ctime":1541125197,"ip_address":"","comment_id":36303,"utype":1}],"discussion_count":1,"race_medal":0,"score":"10130968455","product_id":100007101,"comment_content":"https与ssl有什么关系吗？","like_count":2,"discussions":[{"author":{"id":1001590,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/48/76/0c7d4d23.jpg","nickname":"刘超","note":"","ucode":"196BF3F499E8FE","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":427823,"discussion_content":"有啊，http + ssl","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1541125197,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":25032,"user_name":"nice","can_delete":false,"product_type":"c1","uid":1240611,"ip_address":"","ucode":"B0EF8D17C72A2C","user_header":"https://static001.geekbang.org/account/avatar/00/12/ee/23/b8d6546e.jpg","comment_is_top":false,"comment_ctime":1537237644,"is_pvip":false,"replies":[{"id":"9101","content":"最后有个解答五篇，都在里面","user_name":"作者回复","user_name_real":"刘超@网易云","uid":"1001590","ctime":1537239188,"ip_address":"","comment_id":25032,"utype":1}],"discussion_count":1,"race_medal":0,"score":"10127172236","product_id":100007101,"comment_content":"老是你好，我今天刚买的，就看了一个HTTPS，受益匪浅，想问下您，在最后您留下的问题，我在下一期没有发现问题的讲解，这问题是不是不会进行讲解，让自己进行学习呢？","like_count":2,"discussions":[{"author":{"id":1001590,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/48/76/0c7d4d23.jpg","nickname":"刘超","note":"","ucode":"196BF3F499E8FE","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":424168,"discussion_content":"最后有个解答五篇，都在里面","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1537239188,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":13524,"user_name":"洪宇舟","can_delete":false,"product_type":"c1","uid":1130842,"ip_address":"","ucode":"03465B66C27343","user_header":"https://static001.geekbang.org/account/avatar/00/11/41/5a/b273689e.jpg","comment_is_top":false,"comment_ctime":1529721958,"is_pvip":false,"replies":[{"id":"4555","content":"证书里面主要是公钥","user_name":"作者回复","user_name_real":"刘超@网易云","uid":"1001590","ctime":1529749721,"ip_address":"","comment_id":13524,"utype":1}],"discussion_count":1,"race_medal":0,"score":"10119656550","product_id":100007101,"comment_content":"刘老师，请问文章里面证书请求的命令行里面为什么是私钥呢？CA应该是对公钥做签名吧","like_count":2,"discussions":[{"author":{"id":1001590,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/48/76/0c7d4d23.jpg","nickname":"刘超","note":"","ucode":"196BF3F499E8FE","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":419675,"discussion_content":"证书里面主要是公钥","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1529749721,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":13339,"user_name":"进阶的码农","can_delete":false,"product_type":"c1","uid":1017821,"ip_address":"","ucode":"D8991282640334","user_header":"https://static001.geekbang.org/account/avatar/00/0f/87/dd/4f53f95d.jpg","comment_is_top":false,"comment_ctime":1529544228,"is_pvip":false,"replies":[{"id":"4523","content":"公钥很容易得到","user_name":"作者回复","user_name_real":"刘超@网易云","uid":"1001590","ctime":1529682561,"ip_address":"","comment_id":13339,"utype":1}],"discussion_count":4,"race_medal":0,"score":"10119478820","product_id":100007101,"comment_content":"为啥私钥加密 互联网上人人都可以把它打开？","like_count":2,"discussions":[{"author":{"id":1001590,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/48/76/0c7d4d23.jpg","nickname":"刘超","note":"","ucode":"196BF3F499E8FE","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":419617,"discussion_content":"公钥很容易得到","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1529682561,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":2366287,"avatar":"https://static001.geekbang.org/account/avatar/00/24/1b/4f/2fc4f79a.jpg","nickname":"minghsin","note":"","ucode":"317F289E1A6C4A","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":551565,"discussion_content":"私钥加密，公钥解密，而公钥很容易得到","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1645062817,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1000417,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/43/e1/b7be5560.jpg","nickname":"sam","note":"","ucode":"8D48F4B9045947","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":285984,"discussion_content":"这句话我也没看明白，私钥加密为什么人人就能打开呢","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1593005311,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1121459,"avatar":"https://static001.geekbang.org/account/avatar/00/11/1c/b3/6d10ba4f.jpg","nickname":"Running Man","note":"","ucode":"4DD2F6AF71327E","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":71531,"discussion_content":"还是不明白","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1575430821,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":252482,"user_name":"牛味浓牛味浓","can_delete":false,"product_type":"c1","uid":2113755,"ip_address":"","ucode":"0E1EDD3B13DFEF","user_header":"https://static001.geekbang.org/account/avatar/00/20/40/db/5e4aa1e6.jpg","comment_is_top":false,"comment_ctime":1602317027,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"5897284323","product_id":100007101,"comment_content":"扫盲文章 终于弄清楚https了 呜呜呜","like_count":1},{"had_liked":false,"id":244421,"user_name":"仰望星空","can_delete":false,"product_type":"c1","uid":1149084,"ip_address":"","ucode":"A9E46C9FDB3275","user_header":"https://static001.geekbang.org/account/avatar/00/11/88/9c/cbc463e6.jpg","comment_is_top":false,"comment_ctime":1598511947,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"5893479243","product_id":100007101,"comment_content":"第二条命令：openssl rsa -in cliu8siteprivate.key -pubout -outcliu8sitepublic.pem，-out后面需要加空格，openssl rsa -in cliu8siteprivate.key -pubout -out cliu8sitepublic.pem","like_count":1},{"had_liked":false,"id":171004,"user_name":"吃水不用钱","can_delete":false,"product_type":"c1","uid":1797135,"ip_address":"","ucode":"8A5D5978F0D4E5","user_header":"https://static001.geekbang.org/account/avatar/00/1b/6c/0f/7d242cc2.jpg","comment_is_top":false,"comment_ctime":1578817584,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"5873784880","product_id":100007101,"comment_content":"请问下老师，客户端如何链式校验证书？我的理解是：客户端c从服务端s获取证书后，<br>1. 拆分证书获取“元数据”和“加密的签名”；<br>2. 用“元数据”中的公钥解密“加密的签名”，得到Hash<br>3. 用同样的Hash算法获取“元数据”的Hash值；<br>4. 比较第3步和第4步获取的Hash值，相等则通过校验；<br>5. 针对“元数据”，重复步骤，直到**Root CA**<br><br>请老师指正！","like_count":1},{"had_liked":false,"id":130031,"user_name":"Hansen","can_delete":false,"product_type":"c1","uid":1260211,"ip_address":"","ucode":"6757362A09987A","user_header":"https://static001.geekbang.org/account/avatar/00/13/3a/b3/97945ef8.jpg","comment_is_top":false,"comment_ctime":1567354908,"is_pvip":false,"replies":[{"id":"48700","content":"HTTP&#47;1.1的默认模式使用带流水线的长连接","user_name":"作者回复","user_name_real":"刘超@网易云","uid":"1001590","ctime":1567479471,"ip_address":"","comment_id":130031,"utype":1}],"discussion_count":1,"race_medal":0,"score":"5862322204","product_id":100007101,"comment_content":"老师说https在用非所称加密后连接时，两端会协商用对称加密来传输数据。那以后每次的https都会这样操作一遍吗？还是这个公钥会被记录在各自的某些地方，比如session或者cookie什么的","like_count":1,"discussions":[{"author":{"id":1001590,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/48/76/0c7d4d23.jpg","nickname":"刘超","note":"","ucode":"196BF3F499E8FE","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":465774,"discussion_content":"HTTP/1.1的默认模式使用带流水线的长连接","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1567479471,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":111192,"user_name":"hola","can_delete":false,"product_type":"c1","uid":1068559,"ip_address":"","ucode":"1872B1B3FCEAFC","user_header":"https://static001.geekbang.org/account/avatar/00/10/4e/0f/c43745e7.jpg","comment_is_top":false,"comment_ctime":1562506157,"is_pvip":false,"replies":[{"id":"46745","content":"是的","user_name":"作者回复","user_name_real":"刘超@网易云","uid":"1001590","ctime":1566388065,"ip_address":"","comment_id":111192,"utype":1}],"discussion_count":1,"race_medal":0,"score":"5857473453","product_id":100007101,"comment_content":"每一次https的连接握手，都需要这么复杂的过程吧？","like_count":1,"discussions":[{"author":{"id":1001590,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/48/76/0c7d4d23.jpg","nickname":"刘超","note":"","ucode":"196BF3F499E8FE","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":457277,"discussion_content":"是的","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1566388065,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":100833,"user_name":"cheetah","can_delete":false,"product_type":"c1","uid":1482596,"ip_address":"","ucode":"76D54EF2053B5E","user_header":"https://static001.geekbang.org/account/avatar/00/16/9f/64/a0a0904d.jpg","comment_is_top":false,"comment_ctime":1559649369,"is_pvip":false,"replies":[{"id":"49180","content":"赞","user_name":"作者回复","user_name_real":"刘超@网易云","uid":"1001590","ctime":1567598284,"ip_address":"","comment_id":100833,"utype":1}],"discussion_count":2,"race_medal":0,"score":"5854616665","product_id":100007101,"comment_content":"最近在接入监控系统到公司后台，在研究相关协议，rtsp、rtmp、hls","like_count":1,"discussions":[{"author":{"id":1001590,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/48/76/0c7d4d23.jpg","nickname":"刘超","note":"","ucode":"196BF3F499E8FE","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":452697,"discussion_content":"赞","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1567598284,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1898597,"avatar":"http://thirdwx.qlogo.cn/mmopen/vi_32/LWicoUend7QOH6pyXGJyJicAzm5T4TUD8TaicSCHVPJp7sbIicpeArcicZiaMGcQ7uUDWjGZYgVnUqNGFFDVe9h0EV4w/132","nickname":"Geek_f7658e","note":"","ucode":"108AA63DEF6A2C","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":281419,"discussion_content":"您好，监控系统用到HTTPS么，具体还用到什么知识？","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1591741939,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":97257,"user_name":"zj","can_delete":false,"product_type":"c1","uid":1100064,"ip_address":"","ucode":"E3329CCF694AC2","user_header":"https://static001.geekbang.org/account/avatar/00/10/c9/20/e4f1b17c.jpg","comment_is_top":false,"comment_ctime":1558621352,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"5853588648","product_id":100007101,"comment_content":"总结1:客户端需要使用随机数和时间戳来保证唯一，服务器根据唯一性校验，不接受已经请求过的，可以防止请求重放","like_count":1},{"had_liked":false,"id":96813,"user_name":"起风了001","can_delete":false,"product_type":"c1","uid":1529929,"ip_address":"","ucode":"8DCDBA40B8CC9F","user_header":"","comment_is_top":false,"comment_ctime":1558513569,"is_pvip":false,"replies":[{"id":"49272","content":"算法","user_name":"作者回复","user_name_real":"刘超@网易云","uid":"1001590","ctime":1567609161,"ip_address":"","comment_id":96813,"utype":1}],"discussion_count":1,"race_medal":0,"score":"5853480865","product_id":100007101,"comment_content":"请教一下, 有一个问题是, 为什么需要三个随机数呢? 直接在最后一步客户端用网站公钥加密一个&quot;私钥&quot;, 然后大家都可以用这个私钥做以后的数据传输就可以了.","like_count":1,"discussions":[{"author":{"id":1001590,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/48/76/0c7d4d23.jpg","nickname":"刘超","note":"","ucode":"196BF3F499E8FE","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":451023,"discussion_content":"算法","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1567609161,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":68338,"user_name":"caohuan","can_delete":false,"product_type":"c1","uid":1256428,"ip_address":"","ucode":"4B092E33F3DF1E","user_header":"https://static001.geekbang.org/account/avatar/00/13/2b/ec/af6d0b10.jpg","comment_is_top":false,"comment_ctime":1550485688,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"5845452984","product_id":100007101,"comment_content":"本篇所得：1.网络传输 需要用到http协议，但它的安全性不够，所以用到https，它具有安全性;<br>2.https需要加密，加密分为对称加密 和 非对称加密，对称性加密效率高，非对称加密可传输公钥;<br>3.对称加密解决了 密钥传输问题，非对称性解决传输效率;<br>4.非对称性加密 通过证书和权威机构证明公钥的合法性;<br>5.https综合了 对称性加密和非对称性加密传输 效率和安全的问题。","like_count":1},{"had_liked":false,"id":48711,"user_name":"Michael","can_delete":false,"product_type":"c1","uid":1118976,"ip_address":"","ucode":"35F4FFAC4A4B15","user_header":"https://static001.geekbang.org/account/avatar/00/11/13/00/a4a2065f.jpg","comment_is_top":false,"comment_ctime":1544520529,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"5839487825","product_id":100007101,"comment_content":"还有一个问题，最后的对称加密密钥是怎么算出来的，客护端和服务端最终协商后会选择一个加密算法，这个加密算法通常有哪些？","like_count":1},{"had_liked":false,"id":46248,"user_name":"剧终","can_delete":false,"product_type":"c1","uid":1298454,"ip_address":"","ucode":"6688160DB1DB4D","user_header":"https://static001.geekbang.org/account/avatar/00/13/d0/16/9663e7af.jpg","comment_is_top":false,"comment_ctime":1543888721,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"5838856017","product_id":100007101,"comment_content":"老师的课讲的很不错，通俗易懂，如久旱逢甘雨，让我拨云见日，茅塞顿开，期待老师其他课程。","like_count":1},{"had_liked":false,"id":29057,"user_name":"无知的陈程","can_delete":false,"product_type":"c1","uid":1239607,"ip_address":"","ucode":"384CF403836D53","user_header":"https://static001.geekbang.org/account/avatar/00/12/ea/37/77687967.jpg","comment_is_top":false,"comment_ctime":1538237707,"is_pvip":false,"discussion_count":1,"race_medal":0,"score":"5833205003","product_id":100007101,"comment_content":"分别获得三个随机数后，是怎么选择对称密钥的生成方法呢？","like_count":1,"discussions":[{"author":{"id":1361159,"avatar":"http://thirdwx.qlogo.cn/mmopen/vi_32/DYAIOgq83eqJobg767PUeqrqQQ4B6YvMatj2SRyOicKZZ4gWTf30dMketiaj58Gc3RFTmckGxAXlL9ERSxGovq9g/132","nickname":"涛哥哥","note":"","ucode":"329A1384E3AB5E","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":281288,"discussion_content":"客户端和服务端已经约好了加密算法，只要加密算法一样，他们得出的密钥就是一样","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1591705624,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":27000,"user_name":"无形","can_delete":false,"product_type":"c1","uid":1016889,"ip_address":"","ucode":"B740E2A68A17A5","user_header":"https://static001.geekbang.org/account/avatar/00/0f/84/39/c8772466.jpg","comment_is_top":false,"comment_ctime":1537795471,"is_pvip":true,"discussion_count":0,"race_medal":0,"score":"5832762767","product_id":100007101,"comment_content":"之前的还能懂，这节好复杂，看懵了","like_count":1},{"had_liked":false,"id":13665,"user_name":"路慢慢","can_delete":false,"product_type":"c1","uid":1015092,"ip_address":"","ucode":"B8C2F90A3620F2","user_header":"https://static001.geekbang.org/account/avatar/00/0f/7d/34/ad7ae96c.jpg","comment_is_top":false,"comment_ctime":1529914324,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"5824881620","product_id":100007101,"comment_content":"pre-master的作用是不是前两次各自传的随机数有可能被截获？这个随机数才是黑客无法截获的。","like_count":1},{"had_liked":false,"id":360617,"user_name":"周晓伟","can_delete":false,"product_type":"c1","uid":1691337,"ip_address":"浙江","ucode":"356A12911942F8","user_header":"https://static001.geekbang.org/account/avatar/00/19/ce/c9/1f9daaac.jpg","comment_is_top":false,"comment_ctime":1666689046,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1666689046","product_id":100007101,"comment_content":"请教一下，DNS攻击加真实证书伪造，是不是目前仍无解？","like_count":0},{"had_liked":false,"id":359488,"user_name":"小杰","can_delete":false,"product_type":"c1","uid":2853200,"ip_address":"浙江","ucode":"BBDF8E9F348F65","user_header":"https://static001.geekbang.org/account/avatar/00/2b/89/50/aee9fdab.jpg","comment_is_top":false,"comment_ctime":1665568444,"is_pvip":true,"discussion_count":0,"race_medal":0,"score":"1665568444","product_id":100007101,"comment_content":"1、使用缓存，比如dns解析，重定向，ca证书的dns、tcp、ocsp验证也可以缓存。2、使用更快的加密算法，在不影响用户观看的情况下，传输少一点的帧率 ","like_count":0},{"had_liked":false,"id":354690,"user_name":"于飞","can_delete":false,"product_type":"c1","uid":1163787,"ip_address":"江苏","ucode":"5A4C998FF13B1C","user_header":"https://static001.geekbang.org/account/avatar/00/11/c2/0b/e8e70c99.jpg","comment_is_top":false,"comment_ctime":1660698178,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1660698178","product_id":100007101,"comment_content":"是不是把原来需要线下给的密钥通过非对称性给到用户，然后再通过对称性解密就可以的.<br>说到底https就是本质上对称性，但密钥非获取非对称性","like_count":0},{"had_liked":false,"id":354204,"user_name":"。。。","can_delete":false,"product_type":"c1","uid":1035567,"ip_address":"上海","ucode":"6882BABE9C3D6B","user_header":"https://static001.geekbang.org/account/avatar/00/0f/cd/2f/f4adcb41.jpg","comment_is_top":false,"comment_ctime":1660184140,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1660184140","product_id":100007101,"comment_content":"怎么知道操作系统中是否安装了CA证书，并且是合法的？","like_count":0},{"had_liked":false,"id":350360,"user_name":"Kyrie","can_delete":false,"product_type":"c1","uid":1658679,"ip_address":"","ucode":"1854F9DFB83E15","user_header":"https://static001.geekbang.org/account/avatar/00/19/4f/37/6073844a.jpg","comment_is_top":false,"comment_ctime":1656845909,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1656845909","product_id":100007101,"comment_content":"为什么要层层授信背书，不直接找root CA背书呢？","like_count":0},{"had_liked":false,"id":345981,"user_name":"Geek_115bc8","can_delete":false,"product_type":"c1","uid":1673843,"ip_address":"","ucode":"71FBC9F02AFE1B","user_header":"http://thirdwx.qlogo.cn/mmopen/vi_32/DYAIOgq83erXRaa98A3zjLDkOibUJV1254aQ4EYFTbSLJuEvD0nXicMNA8pLoxOfHf5kPTbGLXNicg8CPFH3Tn0mA/132","comment_is_top":false,"comment_ctime":1652750139,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1652750139","product_id":100007101,"comment_content":"这里贴一下自己总结的TLS的握手过程。https:&#47;&#47;juejin.cn&#47;post&#47;7094649049109757989","like_count":0},{"had_liked":false,"id":345761,"user_name":"LIKE","can_delete":false,"product_type":"c1","uid":1254252,"ip_address":"","ucode":"9DAB7F9051648A","user_header":"https://static001.geekbang.org/account/avatar/00/13/23/6c/82ba5e1f.jpg","comment_is_top":false,"comment_ctime":1652580404,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1652580404","product_id":100007101,"comment_content":"视频区分 加密 和 非加，不管是 非加密mp4文件地址还是加密视频类似ts切片等，在浏览器打开后查看也都是https协议。","like_count":0},{"had_liked":false,"id":341298,"user_name":"姜兵","can_delete":false,"product_type":"c1","uid":2006967,"ip_address":"","ucode":"E4CCFBAC5797DE","user_header":"https://static001.geekbang.org/account/avatar/00/1e/9f/b7/8b1c1b3b.jpg","comment_is_top":false,"comment_ctime":1649508627,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1649508627","product_id":100007101,"comment_content":"老师好，有几处感觉有疑惑，<br>1. pre-master是怎么生成的，服务端在哪一步生成pre-master没有说明。<br>2. 为什么服务端和客户端使用 两个随机数 + pre-master会生成相同的秘钥。<br>3. 既然两个随机数（客户端的随机数，服务端的随机数）都是明文传输的，那么黑客也能截获，也可以通过两个随机数生成pre-master，再通过两个随机数+pre-master生成对称秘钥，但是这显然是不成立的。<br>这里面是不是还有没说到的地方。","like_count":0},{"had_liked":false,"id":332969,"user_name":",","can_delete":false,"product_type":"c1","uid":1187004,"ip_address":"","ucode":"4F96414FAA1ED9","user_header":"https://static001.geekbang.org/account/avatar/00/12/1c/bc/f6318865.jpg","comment_is_top":false,"comment_ctime":1643898825,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1643898825","product_id":100007101,"comment_content":"百度+看书来来回回好多遍， 不是写的太复杂没耐心看完，就是根本看不懂。看了这篇文章后终于治好了我多年的老寒腿，终于看懂了","like_count":0},{"had_liked":false,"id":329189,"user_name":"i_chase","can_delete":false,"product_type":"c1","uid":1795511,"ip_address":"","ucode":"09C41C863F4EA3","user_header":"https://static001.geekbang.org/account/avatar/00/1b/65/b7/058276dc.jpg","comment_is_top":false,"comment_ctime":1641200446,"is_pvip":true,"discussion_count":0,"race_medal":0,"score":"1641200446","product_id":100007101,"comment_content":"HTTPS通过非对称+对称加密保证了数据的秘密性。<br>每个报文还会进行md5签名保证数据完整性不被篡改。（接收消息后比较md5结果）<br>通过nonce保证消息顺序性（nonce也加入md5计算）","like_count":0},{"had_liked":false,"id":323301,"user_name":"重洋","can_delete":false,"product_type":"c1","uid":1698679,"ip_address":"","ucode":"B896A81B579BEA","user_header":"https://static001.geekbang.org/account/avatar/00/19/eb/77/ffd16123.jpg","comment_is_top":false,"comment_ctime":1637826324,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1637826324","product_id":100007101,"comment_content":"求救啊，这张图是单向认证还是双向认证的？客户端也发送了证书，是不是说这是双向认证的过程？","like_count":0},{"had_liked":false,"id":322973,"user_name":"Geek小张","can_delete":false,"product_type":"c1","uid":2830447,"ip_address":"","ucode":"BF0A8F2D0DDF83","user_header":"https://thirdwx.qlogo.cn/mmopen/vi_32/wObTxbxOFRbVjTuicn081m0ISlpRBVyvR7Y58xEyyUXdbjTODIKInmEJmqkU2Iia5BQSM56nFUwkL4iaaribaVcm3w/132","comment_is_top":false,"comment_ctime":1637676958,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1637676958","product_id":100007101,"comment_content":"我在b站的一个视频里看到，生成的“pre-master”，会通过导出函数切分成四个密钥，不知道是用来干嘛，所以特地来问问，视频我也找不到了，上一年看到的。","like_count":0},{"had_liked":false,"id":318837,"user_name":"蝴蝶","can_delete":false,"product_type":"c1","uid":1193167,"ip_address":"","ucode":"8019924D99182F","user_header":"https://static001.geekbang.org/account/avatar/00/12/34/cf/0a316b48.jpg","comment_is_top":false,"comment_ctime":1635466184,"is_pvip":true,"discussion_count":0,"race_medal":0,"score":"1635466184","product_id":100007101,"comment_content":"openssl rsa -in cliu8siteprivate.key -pubout -outcliu8sitepublic.pem 这个命令是有问题的,outcliu8sitepublic需要拆开成out cliu8sitepublic,对吧?","like_count":0},{"had_liked":false,"id":313405,"user_name":"Sunny","can_delete":false,"product_type":"c1","uid":1305257,"ip_address":"","ucode":"BB7B274CE0672E","user_header":"https://static001.geekbang.org/account/avatar/00/13/ea/a9/0a917f2c.jpg","comment_is_top":false,"comment_ctime":1632410519,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1632410519","product_id":100007101,"comment_content":"文中说“在把信息发送出去时，把这个 Hash 值加密后，作为一个签名和信息一起发出去。”，该怎样理解呢？","like_count":0},{"had_liked":false,"id":289598,"user_name":"橘子","can_delete":false,"product_type":"c1","uid":1108166,"ip_address":"","ucode":"18EA099C78FFA7","user_header":"https://static001.geekbang.org/account/avatar/00/10/e8/c6/25a139c0.jpg","comment_is_top":false,"comment_ctime":1619096118,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1619096118","product_id":100007101,"comment_content":"能用过什么工具查看消息发送的过程吗，从而验证http和https协议","like_count":0},{"had_liked":false,"id":288128,"user_name":"比方","can_delete":false,"product_type":"c1","uid":1242795,"ip_address":"","ucode":"F8734A5915DBF1","user_header":"https://static001.geekbang.org/account/avatar/00/12/f6/ab/3d235175.jpg","comment_is_top":false,"comment_ctime":1618312035,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1618312035","product_id":100007101,"comment_content":"如果单向认证，抓包改了部分数据，并且再用服务端秘钥加密发给服务端，这样岂不是还不是安全的。","like_count":0},{"had_liked":false,"id":284612,"user_name":"啊良梓是我","can_delete":false,"product_type":"c1","uid":1655117,"ip_address":"","ucode":"E42FC1A60D331C","user_header":"https://static001.geekbang.org/account/avatar/00/19/41/4d/f6d6d13a.jpg","comment_is_top":false,"comment_ctime":1616386793,"is_pvip":true,"discussion_count":0,"race_medal":1,"score":"1616386793","product_id":100007101,"comment_content":"总结：主流是加解密方案 个人见解<br><br>非对称和对称加密方案<br>1，服务器有非对称加密的公钥A1，私钥A2<br>2，客户端发送请求，服务端返回公钥A1，<br>3，客户端随机生成一个对称加解密的密钥B，通过A1（这里要通过CA权威第三方机构判断这个公钥是不是真正的客户端返回的公钥A1）返回给服务端；<br>4，服务端通过A2解密A1拿到密钥B，之后服务器和客户端都通过密钥B来进行通信。","like_count":0},{"had_liked":false,"id":283769,"user_name":"~羽~@~锋~","can_delete":false,"product_type":"c1","uid":1990944,"ip_address":"","ucode":"727B1D321C2F64","user_header":"https://static001.geekbang.org/account/avatar/00/1e/61/20/14d6363f.jpg","comment_is_top":false,"comment_ctime":1615910476,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1615910476","product_id":100007101,"comment_content":"tls属于哪一层协议","like_count":0},{"had_liked":false,"id":283199,"user_name":"伯安知心","can_delete":false,"product_type":"c1","uid":1961835,"ip_address":"","ucode":"6C17706658672C","user_header":"https://static001.geekbang.org/account/avatar/00/1d/ef/6b/5e8f6536.jpg","comment_is_top":false,"comment_ctime":1615617230,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1615617230","product_id":100007101,"comment_content":"您好网络知识图谱，可以分享一下吗 ？谢谢~","like_count":0},{"had_liked":false,"id":277690,"user_name":"Wheat","can_delete":false,"product_type":"c1","uid":1260141,"ip_address":"","ucode":"7D99EA149B6DE8","user_header":"https://static001.geekbang.org/account/avatar/00/13/3a/6d/910b2445.jpg","comment_is_top":false,"comment_ctime":1612516991,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1612516991","product_id":100007101,"comment_content":"三个随机数是用来算对称密钥的，那啥时候商定好的Encrypted Handshake Message的参数啊","like_count":0},{"had_liked":false,"id":273332,"user_name":"Jake","can_delete":false,"product_type":"c1","uid":1216486,"ip_address":"","ucode":"DA16FA2ADA9EAC","user_header":"https://static001.geekbang.org/account/avatar/00/12/8f/e6/932e8a90.jpg","comment_is_top":false,"comment_ctime":1610537460,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1610537460","product_id":100007101,"comment_content":"我有个问题 前面说黑客可以拿到公钥 进行签名 经过第三方ca颁布的证书也是可以被黑客拿到啊","like_count":0},{"had_liked":false,"id":259300,"user_name":"谢小路","can_delete":false,"product_type":"c1","uid":1035064,"ip_address":"","ucode":"C9FE2EB10DC105","user_header":"https://static001.geekbang.org/account/avatar/00/0f/cb/38/4c9cfdf4.jpg","comment_is_top":false,"comment_ctime":1604675372,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1604675372","product_id":100007101,"comment_content":"建议使用tcpdump,  Wireshark 进行抓包，配合着流程图看，包括各层的含义，包含的内容等，非常清晰。","like_count":0},{"had_liked":false,"id":254314,"user_name":"感动超人","can_delete":false,"product_type":"c1","uid":1245294,"ip_address":"","ucode":"DDBFE64A9DB28D","user_header":"https://static001.geekbang.org/account/avatar/00/13/00/6e/11362a1e.jpg","comment_is_top":false,"comment_ctime":1603099695,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1603099695","product_id":100007101,"comment_content":"我的理解：HTTPS的非对称加密体现在两个方面<br>1. CA证书的权威性确认  使用CA的公钥，确认证书里CA私钥的签名 --&gt; B端得到网站公钥<br>2. pre-master 随机数的加密解密，B端通过证书里的网站公钥加密，网站自己用私钥解密  --&gt; 网站得到生成对称公钥的随机数（pre-master）<br><br>","like_count":0},{"had_liked":false,"id":252235,"user_name":"@许还真","can_delete":false,"product_type":"c1","uid":1099324,"ip_address":"","ucode":"6D754D5AE44CEC","user_header":"https://static001.geekbang.org/account/avatar/00/10/c6/3c/8ab9deb0.jpg","comment_is_top":false,"comment_ctime":1602209021,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1602209021","product_id":100007101,"comment_content":"我记得有一个DH交换算法","like_count":0},{"had_liked":false,"id":242601,"user_name":"坏淡一个","can_delete":false,"product_type":"c1","uid":1118181,"ip_address":"","ucode":"D9C39F4133D9D6","user_header":"https://thirdwx.qlogo.cn/mmopen/vi_32/DYAIOgq83eplMzkLgvebhLujCZI0DZAWS7MQGvYGHb4yeoDHdITVWpbSicvoVKw0dISm9ib3vYU7BqxrmuTV666g/132","comment_is_top":false,"comment_ctime":1597795222,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1597795222","product_id":100007101,"comment_content":"客户端ca证书不是系统内置的吗？怎么一层层往上追溯？","like_count":0},{"had_liked":false,"id":241839,"user_name":"Morningstar","can_delete":false,"product_type":"c1","uid":1010364,"ip_address":"","ucode":"867C320EB6CA3C","user_header":"https://static001.geekbang.org/account/avatar/00/0f/6a/bc/bb09de0c.jpg","comment_is_top":false,"comment_ctime":1597463224,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1597463224","product_id":100007101,"comment_content":"刘老师，我遇到个问题，请教一下，EMQ 配置了server端的证书和私钥，并开启了SSL双向认证，我用vim修改了client端证书和key的最后一个字符，居然还能连上，这是什么原因？","like_count":0},{"had_liked":false,"id":240127,"user_name":"妥协","can_delete":false,"product_type":"c1","uid":1249656,"ip_address":"","ucode":"7201DFE9C12669","user_header":"https://static001.geekbang.org/account/avatar/00/13/11/78/4f0cd172.jpg","comment_is_top":false,"comment_ctime":1596768047,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1596768047","product_id":100007101,"comment_content":"HTTPS&#47;TLS可以放重放攻击是吧，使用http协议也就不用考虑重放攻击问题了是吧","like_count":0},{"had_liked":false,"id":230210,"user_name":"我来也","can_delete":false,"product_type":"c1","uid":1205253,"ip_address":"","ucode":"773D6104F56767","user_header":"https://static001.geekbang.org/account/avatar/00/12/64/05/6989dce6.jpg","comment_is_top":false,"comment_ctime":1593312652,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1593312652","product_id":100007101,"comment_content":"最近在了解`https 向前安全性`时,发现不同的TLS加密算法,计算最终的对称加密的流程也不一样.<br><br>老师文中的pre-master交换用到了服务端的公钥加密,所以若服务器的私钥被获取,历史流量就可以被解密了.<br>这也是wireshark能通过导入私钥来解密流量的原因.<br><br>由于 HTTP&#47;2 允许使用的 加密套件 必须采用具有前向安全性的密钥交换算法,所以加密的流程会跟文章图中的流程略微不一样.<br>有兴趣的同学可以了解一下.<br>","like_count":0},{"had_liked":false,"id":229464,"user_name":"sam","can_delete":false,"product_type":"c1","uid":1000417,"ip_address":"","ucode":"8D48F4B9045947","user_header":"https://static001.geekbang.org/account/avatar/00/0f/43/e1/b7be5560.jpg","comment_is_top":false,"comment_ctime":1593005397,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1593005397","product_id":100007101,"comment_content":"为什么抓包看不到client hello的过程？","like_count":0},{"had_liked":false,"id":224158,"user_name":"伍卓钧","can_delete":false,"product_type":"c1","uid":1128279,"ip_address":"","ucode":"5EF426E33AF9A7","user_header":"https://static001.geekbang.org/account/avatar/00/11/37/57/b21a1c39.jpg","comment_is_top":false,"comment_ctime":1591288691,"is_pvip":true,"replies":[{"id":"83026","content":"公钥和证书是公开的，不用截取也能合法获得。别人的客户端用公钥加密的用户名密码，你截获了，没有私钥解不开。","user_name":"作者回复","user_name_real":"刘超@网易云","uid":"1001590","ctime":1591754968,"ip_address":"","comment_id":224158,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1591288691","product_id":100007101,"comment_content":"老师请教您一个问题，中间人能不能够截取到证书然后拿到里面的公钥，再冒充客户端对请求参数做公钥加密向服务器发出请求。","like_count":0,"discussions":[{"author":{"id":1001590,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/48/76/0c7d4d23.jpg","nickname":"刘超","note":"","ucode":"196BF3F499E8FE","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":497379,"discussion_content":"公钥和证书是公开的，不用截取也能合法获得。别人的客户端用公钥加密的用户名密码，你截获了，没有私钥解不开。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1591754968,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":224157,"user_name":"伍卓钧","can_delete":false,"product_type":"c1","uid":1128279,"ip_address":"","ucode":"5EF426E33AF9A7","user_header":"https://static001.geekbang.org/account/avatar/00/11/37/57/b21a1c39.jpg","comment_is_top":false,"comment_ctime":1591288498,"is_pvip":true,"replies":[{"id":"83027","content":"时间戳被加密或者签名过了，改了对不上","user_name":"作者回复","user_name_real":"刘超@网易云","uid":"1001590","ctime":1591755022,"ip_address":"","comment_id":224157,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1591288498","product_id":100007101,"comment_content":"老师关于重放问题还是不理解，当我是黑客用抓包工具抓到了https的数据，电脑设置信任抓包工具的证书就能获得https的数据，那么同样可以修改时间戳去发送数据。望老师解答，谢谢","like_count":0,"discussions":[{"author":{"id":1001590,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/48/76/0c7d4d23.jpg","nickname":"刘超","note":"","ucode":"196BF3F499E8FE","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":497378,"discussion_content":"时间戳被加密或者签名过了，改了对不上","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1591755022,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":220728,"user_name":"XXX","can_delete":false,"product_type":"c1","uid":1184644,"ip_address":"","ucode":"500C7EB8E16211","user_header":"https://static001.geekbang.org/account/avatar/00/12/13/84/5aeaea9c.jpg","comment_is_top":false,"comment_ctime":1590314795,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1590314795","product_id":100007101,"comment_content":"https:&#47;&#47;www.cnblogs.com&#47;popsuper1982&#47;p&#47;3843325.html<br>发一个刘超老师之前关于ssl的证书操作博客","like_count":0},{"had_liked":false,"id":220724,"user_name":"XXX","can_delete":false,"product_type":"c1","uid":1184644,"ip_address":"","ucode":"500C7EB8E16211","user_header":"https://static001.geekbang.org/account/avatar/00/12/13/84/5aeaea9c.jpg","comment_is_top":false,"comment_ctime":1590313574,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1590313574","product_id":100007101,"comment_content":"生成公钥的命令有问题，提示invalid cipher","like_count":0},{"had_liked":false,"id":215790,"user_name":"dullduck","can_delete":false,"product_type":"c1","uid":1014615,"ip_address":"","ucode":"25293558309704","user_header":"https://static001.geekbang.org/account/avatar/00/0f/7b/57/18b61282.jpg","comment_is_top":false,"comment_ctime":1589103160,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1589103160","product_id":100007101,"comment_content":"-rw-------. 1 root root 599 May 10 17:24 cliu8sitecertificate.req<br>-rw-------. 1 root root 891 May 10 17:04 cliu8siteprivate.key<br>-rw-------. 1 root root 272 May 10 17:05 cliu8sitepublic.pem<br>[root@SZX1000521790 robin]# openssl x509 -req -in cliu8sitecertificate.req -CA cliu8sitepublic.pem -CAkey cliu8siteprivate.key -out cliu8sitecertificate.pem<br>Signature ok<br>subject=&#47;C=XX&#47;L=Default City&#47;O=Default Company Ltd<br>unable to load certificate<br>140497361500064:error:0906D06C:PEM routines:PEM_read_bio:no start line:pem_lib.c:707:Expecting: TRUSTED CERTIFICATE<br>运行这个命令报错是怎么回事呢？","like_count":0},{"had_liked":false,"id":214624,"user_name":"熬夜的熊猫","can_delete":false,"product_type":"c1","uid":1344044,"ip_address":"","ucode":"20E259E3D1A3F0","user_header":"https://static001.geekbang.org/account/avatar/00/14/82/2c/ba9025a1.jpg","comment_is_top":false,"comment_ctime":1588774403,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1588774403","product_id":100007101,"comment_content":"如果用了nonce，服务端要从数据库中取出密码按客户端的算法一样算一遍，那难道数据库中的密码明文存储不加salt吗？","like_count":0},{"had_liked":false,"id":211646,"user_name":"吴小智","can_delete":false,"product_type":"c1","uid":1310798,"ip_address":"","ucode":"C7C9F58B5C9F7B","user_header":"https://static001.geekbang.org/account/avatar/00/14/00/4e/be2b206b.jpg","comment_is_top":false,"comment_ctime":1587992279,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1587992279","product_id":100007101,"comment_content":"两个问题：1：如何保证证书可信？ CA 保证。<br>               2:  对称加密需要的密钥如何传输？通过非对称加密传输，即浏览器通过服务端公钥加密 Pre-Master ，然后传输，只有服务端有密钥，保证了安全传输。","like_count":0},{"had_liked":false,"id":205848,"user_name":"晚空城旧心","can_delete":false,"product_type":"c1","uid":1472863,"ip_address":"","ucode":"5C6D22728C9380","user_header":"https://static001.geekbang.org/account/avatar/00/16/79/5f/8c9d0643.jpg","comment_is_top":false,"comment_ctime":1586746458,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1586746458","product_id":100007101,"comment_content":"一般来说，不直接对消息进行签名，而是对消息的 HASH 值进行签名，步骤如下：<br><br>1. 对消息进行 HASH 计算，得到 HASH 值<br>2. CA 机构使用私钥对 HASH 值进行加密，生成签名<br>3. 将签名附在消息后面，包装成证书一起发申请人<br><br>验证签名<br><br>1. 服务器给客户端发送消息后，客户端拿到消息末尾的签名<br>2. 客户端使用系统内置的权威CA机构的公钥对证书里的签名进行解密，得到 HASH 1<br>3. 对消息的正文进行 HASH 计算，得到 HASH 2<br>4. 比较 HASH 1 和 HASH 2，如果相同则验证成功，说明消息内容没有被篡改","like_count":0},{"had_liked":false,"id":201052,"user_name":"你是小孩","can_delete":false,"product_type":"c1","uid":1804468,"ip_address":"","ucode":"CCBDAC20C43C95","user_header":"","comment_is_top":false,"comment_ctime":1585709664,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1585709664","product_id":100007101,"comment_content":"看了又看，收货满满，多谢作者。","like_count":0},{"had_liked":false,"id":198817,"user_name":"这得从我捡到一个鼠标垫开始说起","can_delete":false,"product_type":"c1","uid":1272321,"ip_address":"","ucode":"2FF4347B4E7A9B","user_header":"https://static001.geekbang.org/account/avatar/00/13/6a/01/d9cb531d.jpg","comment_is_top":false,"comment_ctime":1585469438,"is_pvip":true,"discussion_count":0,"race_medal":0,"score":"1585469438","product_id":100007101,"comment_content":"https最重要的就是证书相关的发送与严重","like_count":0},{"had_liked":false,"id":194334,"user_name":"minions","can_delete":false,"product_type":"c1","uid":1526645,"ip_address":"","ucode":"314A54B9396516","user_header":"https://static001.geekbang.org/account/avatar/00/17/4b/75/64ddeffe.jpg","comment_is_top":false,"comment_ctime":1585051422,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1585051422","product_id":100007101,"comment_content":"黑客模拟要订外卖，又如何？<br>他可以模拟发送用公钥加密的“我要定外卖”，服务器用私钥解密后，给黑客回复用私钥加密的“那给我银行卡和支付密码吧”，黑客用公钥解密后，还能如何？","like_count":0},{"had_liked":false,"id":194330,"user_name":"minions","can_delete":false,"product_type":"c1","uid":1526645,"ip_address":"","ucode":"314A54B9396516","user_header":"https://static001.geekbang.org/account/avatar/00/17/4b/75/64ddeffe.jpg","comment_is_top":false,"comment_ctime":1585051110,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1585051110","product_id":100007101,"comment_content":"私钥加密的响应“那给我银行卡和支付密码吧”就算被黑客用公钥解密，又如何？就算它知道下一步客户端发送 用公钥加密的银行卡与支付密码，黑客没有私钥也解不开呀！","like_count":0},{"had_liked":false,"id":193672,"user_name":"King-ZJ","can_delete":false,"product_type":"c1","uid":1915385,"ip_address":"","ucode":"7448A4BBB5A118","user_header":"https://static001.geekbang.org/account/avatar/00/1d/39/f9/b946719a.jpg","comment_is_top":false,"comment_ctime":1584946567,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1584946567","product_id":100007101,"comment_content":"在HTTPS中，为了数据的安全性，也是下了很多功夫。加密分为对称加密和非对称加密，对称加密的优点是效率高，缺点是不能保证密钥的安全性；非对称优点是通过证书和权威机构可以保证公钥的安全性，缺点是效率低。为了取长补短，HTTPS在使用的过程中，结合了二者的优点，更好地提供服务。","like_count":0},{"had_liked":false,"id":193650,"user_name":"小雨","can_delete":false,"product_type":"c1","uid":1007970,"ip_address":"","ucode":"A6332734063CC5","user_header":"https://static001.geekbang.org/account/avatar/00/0f/61/62/72296b09.jpg","comment_is_top":false,"comment_ctime":1584941248,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1584941248","product_id":100007101,"comment_content":"重放在HTTPS中，握手时有三次随机数，而且两端都有参与生成，所以就算是重放，也有另一端生成新的随机数，无法完成验证。","like_count":0},{"had_liked":false,"id":190889,"user_name":"25ma","can_delete":false,"product_type":"c1","uid":1303713,"ip_address":"","ucode":"AB5435B9DB52C9","user_header":"https://static001.geekbang.org/account/avatar/00/13/e4/a1/178387da.jpg","comment_is_top":false,"comment_ctime":1584705867,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1584705867","product_id":100007101,"comment_content":"看了一遍陶辉老师的网络协议抓包，看这节好懂很多","like_count":0},{"had_liked":false,"id":189101,"user_name":"chenzesam","can_delete":false,"product_type":"c1","uid":1045011,"ip_address":"","ucode":"34E76BB9C7618D","user_header":"https://static001.geekbang.org/account/avatar/00/0f/f2/13/3ee5a9b4.jpg","comment_is_top":false,"comment_ctime":1584455378,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1584455378","product_id":100007101,"comment_content":"以前被问到过，如果早看到这个就好了","like_count":0},{"had_liked":false,"id":188399,"user_name":"甲小蛙","can_delete":false,"product_type":"c1","uid":1475627,"ip_address":"","ucode":"B611FDDE514C9F","user_header":"https://static001.geekbang.org/account/avatar/00/16/84/2b/ba495eea.jpg","comment_is_top":false,"comment_ctime":1584349441,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1584349441","product_id":100007101,"comment_content":"为什么客户端还给服务端传递证书 ？","like_count":0},{"had_liked":false,"id":188397,"user_name":"甲小蛙","can_delete":false,"product_type":"c1","uid":1475627,"ip_address":"","ucode":"B611FDDE514C9F","user_header":"https://static001.geekbang.org/account/avatar/00/16/84/2b/ba495eea.jpg","comment_is_top":false,"comment_ctime":1584349079,"is_pvip":false,"discussion_count":1,"race_medal":0,"score":"1584349079","product_id":100007101,"comment_content":"趣刘能不能给讲讲TCP的三次握手和HTTPS的链接有什么关系呢，网上好像哪儿也查不到资料，不知道三次握手是在上述过程之前还是之后，感谢~","like_count":0,"discussions":[{"author":{"id":1099053,"avatar":"https://static001.geekbang.org/account/avatar/00/10/c5/2d/1eebfc3c.jpg","nickname":"GaGi","note":"","ucode":"CC8D22E1DD8CA2","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":263905,"discussion_content":"握手是为了建立连接，是在https之前","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1589264236,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":185285,"user_name":"bin的技术小屋","can_delete":false,"product_type":"c1","uid":1049047,"ip_address":"","ucode":"478603A9AB13B4","user_header":"https://static001.geekbang.org/account/avatar/00/10/01/d7/f835081c.jpg","comment_is_top":false,"comment_ctime":1583553096,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1583553096","product_id":100007101,"comment_content":"我想知道https是怎么会被篡改的？","like_count":0},{"had_liked":false,"id":184549,"user_name":"Jike_chanpin_shishabi","can_delete":false,"product_type":"c1","uid":1201655,"ip_address":"","ucode":"DBE59491274446","user_header":"https://static001.geekbang.org/account/avatar/00/12/55/f7/af3feb56.jpg","comment_is_top":false,"comment_ctime":1583335493,"is_pvip":false,"discussion_count":1,"race_medal":0,"score":"1583335493","product_id":100007101,"comment_content":"老师，咨询一个问题：防重放和防篡改是咋么实现的，没看懂","like_count":0,"discussions":[{"author":{"id":1201655,"avatar":"https://static001.geekbang.org/account/avatar/00/12/55/f7/af3feb56.jpg","nickname":"Jike_chanpin_shishabi","note":"","ucode":"DBE59491274446","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":196586,"discussion_content":"https不是有MAC防重放么，nonce+timestamp还有必要么","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1583343441,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":182084,"user_name":"渣渣","can_delete":false,"product_type":"c1","uid":1407538,"ip_address":"","ucode":"659B430BD4C22B","user_header":"https://static001.geekbang.org/account/avatar/00/15/7a/32/27a8572a.jpg","comment_is_top":false,"comment_ctime":1582705776,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1582705776","product_id":100007101,"comment_content":"第一个效率问题，可不可以验证成功一次后，打上唯一的标记，如果没有这个标记，则不合法，不用每次这么复杂的验证。第二个要用流媒体协议。","like_count":0},{"had_liked":false,"id":180839,"user_name":"肖小强","can_delete":false,"product_type":"c1","uid":1245065,"ip_address":"","ucode":"A929A8D1DAD3C4","user_header":"https://static001.geekbang.org/account/avatar/00/12/ff/89/32e3f682.jpg","comment_is_top":false,"comment_ctime":1582426608,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1582426608","product_id":100007101,"comment_content":"请问3个随机数中，客户端的随机数或者服务端的随机数是用自己的私钥生成的吗？","like_count":0},{"had_liked":false,"id":171880,"user_name":"AMIR","can_delete":false,"product_type":"c1","uid":1782777,"ip_address":"","ucode":"65142D9669071B","user_header":"https://static001.geekbang.org/account/avatar/00/1b/33/f9/50b76abe.jpg","comment_is_top":false,"comment_ctime":1579049343,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1579049343","product_id":100007101,"comment_content":"老师为什么非对称加密要使用客户端随机数，服务器随机数，prekey-master计算要加密的最后值呢？使用prekey-master不就可以，这个不就是两边都知道的使用非对称加密传输的值吗","like_count":0},{"had_liked":false,"id":167008,"user_name":"Marshall","can_delete":false,"product_type":"c1","uid":1476507,"ip_address":"","ucode":"0FB004E8163F44","user_header":"https://static001.geekbang.org/account/avatar/00/16/87/9b/8bebc8b6.jpg","comment_is_top":false,"comment_ctime":1577668750,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1577668750","product_id":100007101,"comment_content":"超哥 你好 看了你的握手图我有2个疑惑。1.客户端也会传递自己的证书给服务端。2.服务端也会校验客户端的公钥？","like_count":0},{"had_liked":false,"id":162612,"user_name":"DFighting","can_delete":false,"product_type":"c1","uid":1233193,"ip_address":"","ucode":"F3BA2426FF8582","user_header":"https://static001.geekbang.org/account/avatar/00/12/d1/29/1b1234ed.jpg","comment_is_top":false,"comment_ctime":1576565251,"is_pvip":true,"discussion_count":0,"race_medal":0,"score":"1576565251","product_id":100007101,"comment_content":"很通俗易懂的https过程，读完之后发现这里有两个很关键的点：<br>1、根CA证书和公钥、私钥不能通过互联网传输，一般来说都是直接附赠在操作系统中<br>2、既然对称和非对称加密都可能被破解，那么进一步下沉到算法上，结合多个随机数然后在通信的两端生成秘钥，用作数据传输<br>","like_count":0},{"had_liked":false,"id":160157,"user_name":"炎黄伙哥","can_delete":false,"product_type":"c1","uid":1461692,"ip_address":"","ucode":"ACA4DFD5D30C9B","user_header":"https://static001.geekbang.org/account/avatar/00/16/4d/bc/e26f63d9.jpg","comment_is_top":false,"comment_ctime":1575882250,"is_pvip":false,"discussion_count":1,"race_medal":0,"score":"1575882250","product_id":100007101,"comment_content":"从流程上看直接用pre-master做对称秘钥就好了吧，为什么还要用前面两个随机数呢","like_count":0,"discussions":[{"author":{"id":2849942,"avatar":"https://static001.geekbang.org/account/avatar/00/2b/7c/96/d430fa56.jpg","nickname":"amber","note":"","ucode":"AA171E49C0DF2A","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":539276,"discussion_content":"防止破解，增加随机性","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1639654804,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":156573,"user_name":"DriveMan_邱佳源","can_delete":false,"product_type":"c1","uid":1250807,"ip_address":"","ucode":"A4C83BF07DEE7A","user_header":"https://static001.geekbang.org/account/avatar/00/13/15/f7/744720a2.jpg","comment_is_top":false,"comment_ctime":1574916196,"is_pvip":false,"discussion_count":1,"race_medal":0,"score":"1574916196","product_id":100007101,"comment_content":"为何需要这么麻烦，就不能如以下吗<br>服务端中有自己的公匙和私匙，服务端的证书里面包含着公匙，发送给客户端，客户端ca认证后取出服务端公匙，然后以此公匙加密包含双方的对称钥匙给服务端，服务端用自己的私匙解密后用对称钥匙，这样不就完成吗","like_count":0,"discussions":[{"author":{"id":1079811,"avatar":"https://static001.geekbang.org/account/avatar/00/10/7a/03/c9b43b21.jpg","nickname":"BewhY","note":"","ucode":"4BC26D47A79967","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":215053,"discussion_content":"你这么厉害咋还花钱进来看呢？","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1585277571,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":156004,"user_name":"阿虎","can_delete":false,"product_type":"c1","uid":1011272,"ip_address":"","ucode":"D41B0FCB942FFD","user_header":"https://static001.geekbang.org/account/avatar/00/0f/6e/48/abb7bfe3.jpg","comment_is_top":false,"comment_ctime":1574811863,"is_pvip":false,"discussion_count":1,"race_medal":0,"score":"1574811863","product_id":100007101,"comment_content":"&quot;证书验证完毕之后，觉得这个外卖网站可信，于是客户端计算产生随机数字 Pre-master，发送 Client Key Exchange，用证书中的公钥加密，再发送给服务器，服务器可以通过私钥解密出来。&quot;<br>为啥是用证书中的公钥加密传输pre-master而不是用自己的私钥加密传输","like_count":0,"discussions":[{"author":{"id":1800831,"avatar":"https://static001.geekbang.org/account/avatar/00/1b/7a/7f/714ac261.jpg","nickname":"Neutron","note":"","ucode":"1DB5C2641666EE","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":128258,"discussion_content":"因为服务端没有客户端的公钥，解不开。但是客户端有服务端的公钥，因为服务端发给客户端证书里面封装的就是服务端的公钥。这样客户端用证书中包含的服务端公钥加密，服务端可以用自己的私钥解密","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1578623870,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":154364,"user_name":"flow","can_delete":false,"product_type":"c1","uid":1270302,"ip_address":"","ucode":"B482ACF0E413C7","user_header":"https://static001.geekbang.org/account/avatar/00/13/62/1e/ad721e61.jpg","comment_is_top":false,"comment_ctime":1574415473,"is_pvip":true,"discussion_count":0,"race_medal":0,"score":"1574415473","product_id":100007101,"comment_content":"老师, 上图的client certificate是不是双向认证用的? 看文字描述里也没讲到这个","like_count":0},{"had_liked":false,"id":148910,"user_name":"Goku","can_delete":false,"product_type":"c1","uid":1031868,"ip_address":"","ucode":"8008F3BB10E609","user_header":"https://static001.geekbang.org/account/avatar/00/0f/be/bc/62d402da.jpg","comment_is_top":false,"comment_ctime":1573108137,"is_pvip":true,"discussion_count":0,"race_medal":0,"score":"1573108137","product_id":100007101,"comment_content":"client certificate总是需要的吗？即使不做双向验证。","like_count":0},{"had_liked":false,"id":148466,"user_name":"曙光","can_delete":false,"product_type":"c1","uid":1476450,"ip_address":"","ucode":"04D65BF7F19845","user_header":"https://static001.geekbang.org/account/avatar/00/16/87/62/f99b5b05.jpg","comment_is_top":false,"comment_ctime":1573012377,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1573012377","product_id":100007101,"comment_content":"”发送一个 Encrypted Handshake Message，将已经商定好的参数等，采用协商密钥进行加密，发送给服务器用于数据与握手验证。“  这个“商定好的参数”是啥？会是“自己的、对端的，以及刚生成的 Pre-Master 随机数”三个随机数么？ 如果是的话，感觉又回到对称加密传输“对称密钥”的操作了。","like_count":0},{"had_liked":false,"id":143464,"user_name":"时隐时现","can_delete":false,"product_type":"c1","uid":1111899,"ip_address":"","ucode":"DA4D622FF84920","user_header":"https://static001.geekbang.org/account/avatar/00/10/f7/5b/d2e7c2c4.jpg","comment_is_top":false,"comment_ctime":1571713186,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1571713186","product_id":100007101,"comment_content":"有个业余小问题：以外卖网站为例，如果黑客组织也向CA申请了包含该网站域名的证书请求，CA会直接驳回的吧，也就是说CA要保证域名的全球唯一性，否则客户端就无法区分哪个是钓鱼哪个是官网了","like_count":0},{"had_liked":false,"id":141152,"user_name":"零维","can_delete":false,"product_type":"c1","uid":1235055,"ip_address":"","ucode":"D783CB1D59D1BE","user_header":"https://static001.geekbang.org/account/avatar/00/12/d8/6f/22e5ec55.jpg","comment_is_top":false,"comment_ctime":1571124270,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1571124270","product_id":100007101,"comment_content":"老师讲的简直太棒了！","like_count":0},{"had_liked":false,"id":140142,"user_name":"阿阳","can_delete":false,"product_type":"c1","uid":1165817,"ip_address":"","ucode":"20A35FB86B1C5C","user_header":"https://static001.geekbang.org/account/avatar/00/11/c9/f9/39492855.jpg","comment_is_top":false,"comment_ctime":1570839753,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1570839753","product_id":100007101,"comment_content":"太棒了，这么多年，第一次对https的协商过程有明确的认识。","like_count":0},{"had_liked":false,"id":124195,"user_name":"你是天才i","can_delete":false,"product_type":"c1","uid":1619540,"ip_address":"","ucode":"F8A4BFFBC87246","user_header":"https://static001.geekbang.org/account/avatar/00/18/b6/54/8d6a2736.jpg","comment_is_top":false,"comment_ctime":1565833531,"is_pvip":false,"replies":[{"id":"46275","content":"回复的用私钥加密，任何人都可以用公钥解开","user_name":"作者回复","user_name_real":"刘超@网易云","uid":"1001590","ctime":1566280804,"ip_address":"","comment_id":124195,"utype":1}],"discussion_count":2,"race_medal":0,"score":"1565833531","product_id":100007101,"comment_content":"先别太乐观，这里还是有问题的。回复的这句话，是外卖网站拿私钥加密的，互联网上人人都可以把它打开，当然包括黑客。那外卖网站可以拿公钥加密吗？当然不能，因为它自己的私钥只有它自己知道，谁也解不开。<br><br>请问这段话到底什么意思？","like_count":0,"discussions":[{"author":{"id":1001590,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/48/76/0c7d4d23.jpg","nickname":"刘超","note":"","ucode":"196BF3F499E8FE","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":463051,"discussion_content":"回复的用私钥加密，任何人都可以用公钥解开","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1566280804,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1121459,"avatar":"https://static001.geekbang.org/account/avatar/00/11/1c/b3/6d10ba4f.jpg","nickname":"Running Man","note":"","ucode":"4DD2F6AF71327E","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":71532,"discussion_content":"这么说就明白了，哈哈，我太笨了","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1575430875,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":124184,"user_name":"你是天才i","can_delete":false,"product_type":"c1","uid":1619540,"ip_address":"","ucode":"F8A4BFFBC87246","user_header":"https://static001.geekbang.org/account/avatar/00/18/b6/54/8d6a2736.jpg","comment_is_top":false,"comment_ctime":1565833100,"is_pvip":false,"replies":[{"id":"46278","content":"是的，每个人都可以生成自己的私钥","user_name":"作者回复","user_name_real":"刘超@网易云","uid":"1001590","ctime":1566280870,"ip_address":"","comment_id":124184,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1565833100","product_id":100007101,"comment_content":"每个人的私钥都是不一样的吗？","like_count":0,"discussions":[{"author":{"id":1001590,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/48/76/0c7d4d23.jpg","nickname":"刘超","note":"","ucode":"196BF3F499E8FE","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":463046,"discussion_content":"是的，每个人都可以生成自己的私钥","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1566280870,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":109774,"user_name":"Infinite_gao","can_delete":false,"product_type":"c1","uid":1235607,"ip_address":"","ucode":"9FBFEDED8790A8","user_header":"http://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTLsexaVCEecIhpPsOqHJkZFEnyTfOZ1Ot3lmSMfyIVkR5SerJibatj6mIHackokoIO4ELiaObhQ60rw/132","comment_is_top":false,"comment_ctime":1562113318,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1562113318","product_id":100007101,"comment_content":"最后的部分说签名保证timestamp的不可篡改性，是不准确的，应该是摘要算法来保证不可篡改性。签名的目的是用来证明我就是我的。","like_count":0},{"had_liked":false,"id":106535,"user_name":"李靖峰","can_delete":false,"product_type":"c1","uid":1139247,"ip_address":"","ucode":"AA4DE3E91A1FFA","user_header":"https://static001.geekbang.org/account/avatar/00/11/62/2f/6fe8ee9e.jpg","comment_is_top":false,"comment_ctime":1561340205,"is_pvip":false,"replies":[{"id":"48868","content":"是的","user_name":"作者回复","user_name_real":"刘超@网易云","uid":"1001590","ctime":1567502116,"ip_address":"","comment_id":106535,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1561340205","product_id":100007101,"comment_content":"同样的包发送n次这个，如果对称加密采用带有iv的aes算法的话同样的内容每次加密后都是不一样的，所以黑客发送n次对端也无法解密成相同的结果","like_count":0,"discussions":[{"author":{"id":1001590,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/48/76/0c7d4d23.jpg","nickname":"刘超","note":"","ucode":"196BF3F499E8FE","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":455128,"discussion_content":"是的","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1567502116,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":103495,"user_name":"杨陆伟","can_delete":false,"product_type":"c1","uid":1108457,"ip_address":"","ucode":"3BC968447406EB","user_header":"https://static001.geekbang.org/account/avatar/00/10/e9/e9/1f95e422.jpg","comment_is_top":false,"comment_ctime":1560468096,"is_pvip":true,"discussion_count":0,"race_medal":0,"score":"1560468096","product_id":100007101,"comment_content":"老师能否解答下课后问题1，也有同样的疑问","like_count":0},{"had_liked":false,"id":100832,"user_name":"天王","can_delete":false,"product_type":"c1","uid":1239337,"ip_address":"","ucode":"C074B2F9A5F007","user_header":"https://static001.geekbang.org/account/avatar/00/12/e9/29/629d9bb0.jpg","comment_is_top":false,"comment_ctime":1559649312,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1559649312","product_id":100007101,"comment_content":"https协议是为了解决http协议不安全的问题产生的传输层的协议。一般有对称加密算法和非对称加密算法，对称加密算法效率比较高，比较安全，比较麻烦的是如何把约定的密钥传给客户端。不对称加密有公钥和私钥，公钥用于加密，私钥用于解密，公钥是公开的，客户端发送请求服务器有私钥才能解密，服务器如果用私钥加密，黑客捕获请求也可以解密。所以会有2对私钥和公钥。客户端和服务端都是用公钥加密，用私钥解密，如何拿到公钥呢，用证书，证书里面有签名，公钥等，证书发给客户端之后，客户端会去权威机构认证，生成证书需要到权威机构去认证，这个认证机构是ca，ca给这个证书一个签名算法，签名算法一般是对信息做一个Hash计算，得到一个hash值，把hash值加密后作为签名一块发给认证证书的客户端，ca执行完给证书签名的命令，会返回Signature ok，.pm文件就是签过名的证书，ca用自己的私钥给网站的公钥签名，证书里面有公钥和签名算法，有效期。客户端会从外卖网站得到一个证书，你拿着证书的公钥去解密网站的签名，如果解密成功，并且hash值一致，则成功了。ca的公钥可以去root ca去认证。https工作模式，客户端在访问https网站的时候，会先发送client hello到服务器，还有随机数，在协商对称加密的时候使用，加密套路比如TLS版本信息，加密套件候选列表，压缩算法候选列表等信息，服务端返回一个随机数，协议版本，加密套件，压缩算法，用于后面的密钥协商，服务端会给客户端一个证书，客户端从CA的仓库中，拿CA证书的公钥去解密外卖网站的证书，如果成功，则说明是可信的，证书认证通过以后，产生随机数字pre_master，发送client_key exchange，用证书的公钥加密，发送给客户端。通过产生的3个随机数，产生对称密钥，在客户端和服务端传输，以后传输数据就用对称密钥加密解密传输。","like_count":0},{"had_liked":false,"id":100201,"user_name":"TryCatch🎈","can_delete":false,"product_type":"c1","uid":1362816,"ip_address":"","ucode":"D937FA04D0C7C0","user_header":"https://static001.geekbang.org/account/avatar/00/14/cb/80/410a7387.jpg","comment_is_top":false,"comment_ctime":1559479155,"is_pvip":false,"replies":[{"id":"49207","content":"最后的答疑环节，补充上了","user_name":"作者回复","user_name_real":"刘超@网易云","uid":"1001590","ctime":1567603102,"ip_address":"","comment_id":100201,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1559479155","product_id":100007101,"comment_content":"有双向认证的流程图吗？","like_count":0,"discussions":[{"author":{"id":1001590,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/48/76/0c7d4d23.jpg","nickname":"刘超","note":"","ucode":"196BF3F499E8FE","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":452448,"discussion_content":"最后的答疑环节，补充上了","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1567603102,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":97265,"user_name":"zj","can_delete":false,"product_type":"c1","uid":1100064,"ip_address":"","ucode":"E3329CCF694AC2","user_header":"https://static001.geekbang.org/account/avatar/00/10/c9/20/e4f1b17c.jpg","comment_is_top":false,"comment_ctime":1558623452,"is_pvip":false,"replies":[{"id":"35434","content":"对的，很难篡改","user_name":"作者回复","user_name_real":"刘超@网易云","uid":"1001590","ctime":1559110871,"ip_address":"","comment_id":97265,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1558623452","product_id":100007101,"comment_content":"重放是有可能的，但是篡改https消息，这个是做不到的吧？","like_count":0,"discussions":[{"author":{"id":1001590,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/48/76/0c7d4d23.jpg","nickname":"刘超","note":"","ucode":"196BF3F499E8FE","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":451201,"discussion_content":"对的，很难篡改","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1559110871,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":79036,"user_name":"bgbg","can_delete":false,"product_type":"c1","uid":1127224,"ip_address":"","ucode":"ED5679E03B8D9E","user_header":"https://static001.geekbang.org/account/avatar/00/11/33/38/a3642bda.jpg","comment_is_top":false,"comment_ctime":1553328424,"is_pvip":false,"replies":[{"id":"50227","content":"不是的，cookie是应用的","user_name":"作者回复","user_name_real":"刘超@网易云","uid":"1001590","ctime":1567827275,"ip_address":"","comment_id":79036,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1553328424","product_id":100007101,"comment_content":"通过两端随机数生成的对称密钥就是客户端的cookie吗？","like_count":0,"discussions":[{"author":{"id":1001590,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/48/76/0c7d4d23.jpg","nickname":"刘超","note":"","ucode":"196BF3F499E8FE","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":444334,"discussion_content":"不是的，cookie是应用的","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1567827275,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":76251,"user_name":"丁辉","can_delete":false,"product_type":"c1","uid":1076961,"ip_address":"","ucode":"11136E23232370","user_header":"https://static001.geekbang.org/account/avatar/00/10/6e/e1/968ca4bd.jpg","comment_is_top":false,"comment_ctime":1552557458,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1552557458","product_id":100007101,"comment_content":"用过不对称加密传输的数据，发现性能太低完全不可用，对称加密是毫秒级响应，不对称加密是秒级响应，数据量小还好，稍微大点，比如一百多字符以上，解密速度会成断崖式下降……没办法，日常开发除非是低频或者数据量特别小的，只能用对称加密……","like_count":0},{"had_liked":false,"id":68304,"user_name":"牙小木","can_delete":false,"product_type":"c1","uid":1172050,"ip_address":"","ucode":"E5C12D37A62949","user_header":"https://static001.geekbang.org/account/avatar/00/11/e2/52/56dbb738.jpg","comment_is_top":false,"comment_ctime":1550480824,"is_pvip":true,"replies":[{"id":"50305","content":"数据包不就是buffer么，写程序就可以重发","user_name":"作者回复","user_name_real":"刘超@网易云","uid":"1001590","ctime":1567840597,"ip_address":"","comment_id":68304,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1550480824","product_id":100007101,"comment_content":"请教老师一般情况下：<br>A和C通信，如果B在中间截获了一些数据包，：B如何将A给C的数据包，重放一遍给B呢，不考虑修改的情况？<br>就是通过什么技术，B将A的数据包重放一遍给C呢，<br>","like_count":0,"discussions":[{"author":{"id":1001590,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/48/76/0c7d4d23.jpg","nickname":"刘超","note":"","ucode":"196BF3F499E8FE","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":439619,"discussion_content":"数据包不就是buffer么，写程序就可以重发","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1567840597,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":56711,"user_name":"无名","can_delete":false,"product_type":"c1","uid":1110113,"ip_address":"","ucode":"2D2E877CF97138","user_header":"https://static001.geekbang.org/account/avatar/00/10/f0/61/68462a07.jpg","comment_is_top":false,"comment_ctime":1546526265,"is_pvip":false,"replies":[{"id":"25762","content":"需要自己定义http请求都传输些啥","user_name":"作者回复","user_name_real":"刘超@网易云","uid":"1001590","ctime":1551421636,"ip_address":"","comment_id":56711,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1546526265","product_id":100007101,"comment_content":"重放与篡改的策略也是https的一部分吗？还是说这个需要自己实现？","like_count":0,"discussions":[{"author":{"id":1001590,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/48/76/0c7d4d23.jpg","nickname":"刘超","note":"","ucode":"196BF3F499E8FE","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":435188,"discussion_content":"需要自己定义http请求都传输些啥","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1551421636,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":51780,"user_name":"leo","can_delete":false,"product_type":"c1","uid":1143202,"ip_address":"","ucode":"F89BB65F07277F","user_header":"https://static001.geekbang.org/account/avatar/00/11/71/a2/091d9619.jpg","comment_is_top":false,"comment_ctime":1545238666,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1545238666","product_id":100007101,"comment_content":"为什么https请求，抓包还可以拿到域名，支持可以抓到域名的服务器常见吗？","like_count":0},{"had_liked":false,"id":46396,"user_name":"🌀🐑hfy🐣","can_delete":false,"product_type":"c1","uid":1254367,"ip_address":"","ucode":"8A7E4BDC46CB35","user_header":"https://static001.geekbang.org/account/avatar/00/13/23/df/367f2c75.jpg","comment_is_top":false,"comment_ctime":1543915400,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1543915400","product_id":100007101,"comment_content":"老师，请问https哪部分是对称加密？哪部分是非对称加密？","like_count":0},{"had_liked":false,"id":44534,"user_name":"HelloBug","can_delete":false,"product_type":"c1","uid":1249598,"ip_address":"","ucode":"E61A4AD5C2F724","user_header":"https://static001.geekbang.org/account/avatar/00/13/11/3e/925aa996.jpg","comment_is_top":false,"comment_ctime":1543455548,"is_pvip":true,"discussion_count":0,"race_medal":0,"score":"1543455548","product_id":100007101,"comment_content":"HTTPS是使用非对称加密来传输对称加密的秘钥。有些问题请教下，客户端和服务端在发送 change cipher spec 的时候使用的仍然是非对称加密的公私钥对吗？另外，服务端发给客户端的证书对客户端来说是非对称加密的公钥，对CA来说，其实是自己的私钥是吧？","like_count":0},{"had_liked":false,"id":37230,"user_name":"意文","can_delete":false,"product_type":"c1","uid":1041221,"ip_address":"","ucode":"4B379CB5AE25F9","user_header":"https://static001.geekbang.org/account/avatar/00/0f/e3/45/d392d494.jpg","comment_is_top":false,"comment_ctime":1541495157,"is_pvip":false,"replies":[{"id":"13443","content":"没有不同，原理完全相同的两对","user_name":"作者回复","user_name_real":"刘超@网易云","uid":"1001590","ctime":1541597436,"ip_address":"","comment_id":37230,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1541495157","product_id":100007101,"comment_content":"刘老师，客户端和服务端的证书有何不同？<br>都是公钥，可以各自解密对方私钥加密后的内容吗？","like_count":0,"discussions":[{"author":{"id":1001590,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/48/76/0c7d4d23.jpg","nickname":"刘超","note":"","ucode":"196BF3F499E8FE","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":428250,"discussion_content":"没有不同，原理完全相同的两对","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1541597436,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":36739,"user_name":"扬～","can_delete":false,"product_type":"c1","uid":1208163,"ip_address":"","ucode":"6FA7D8FE188341","user_header":"https://static001.geekbang.org/account/avatar/00/12/6f/63/abb7bfe3.jpg","comment_is_top":false,"comment_ctime":1541299667,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1541299667","product_id":100007101,"comment_content":" 那两个明文的随机数实在想不出有什么用，甚至觉得是祸害。比如黑客参与到建立前过程，截获修改随机数，这样就导致握手阶段始终不成功。希望老师能解答一下。","like_count":0},{"had_liked":false,"id":35759,"user_name":"家榆","can_delete":false,"product_type":"c1","uid":1030050,"ip_address":"","ucode":"6D62685C80DD7C","user_header":"https://static001.geekbang.org/account/avatar/00/0f/b7/a2/0ce9b8df.jpg","comment_is_top":false,"comment_ctime":1540783747,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1540783747","product_id":100007101,"comment_content":"从流程上看，只用pre-master作为对称秘钥就可以了吧，没必要产生前两个随机数，安全性也是一样的吧","like_count":0},{"had_liked":false,"id":33999,"user_name":"Miss.Zhou","can_delete":false,"product_type":"c1","uid":1170415,"ip_address":"","ucode":"2CE04D1391464A","user_header":"https://static001.geekbang.org/account/avatar/00/11/db/ef/784a32ec.jpg","comment_is_top":false,"comment_ctime":1539943750,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1539943750","product_id":100007101,"comment_content":"老师 请问 访问https的网站也会进行http的三次握手吗？<br>","like_count":0},{"had_liked":false,"id":33069,"user_name":"安森👣","can_delete":false,"product_type":"c1","uid":1228646,"ip_address":"","ucode":"833DBCE8AF27AC","user_header":"https://static001.geekbang.org/account/avatar/00/12/bf/66/56568450.jpg","comment_is_top":false,"comment_ctime":1539742783,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1539742783","product_id":100007101,"comment_content":"请问老师， 是不是HTTPS只能防篡改不能防止偷窥","like_count":0},{"had_liked":false,"id":27258,"user_name":"归去来兮","can_delete":false,"product_type":"c1","uid":1094810,"ip_address":"","ucode":"7218D8E70FA654","user_header":"https://static001.geekbang.org/account/avatar/00/10/b4/9a/a9167c59.jpg","comment_is_top":false,"comment_ctime":1537859221,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1537859221","product_id":100007101,"comment_content":"https本身不就有防监听，防篡改，防重放的作用吗？","like_count":0},{"had_liked":false,"id":26601,"user_name":"Sxd.","can_delete":false,"product_type":"c1","uid":1228420,"ip_address":"","ucode":"F1A11CBC57D0C2","user_header":"https://static001.geekbang.org/account/avatar/00/12/be/84/1f681e75.jpg","comment_is_top":false,"comment_ctime":1537692869,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1537692869","product_id":100007101,"comment_content":"刘老师，整体流程大概看明白了，那这个获取证书，随机数这一套流程是由谁来完成呢？客户端的浏览器和服务端的tomcat？这种一般不需要开发者介入吧？","like_count":0},{"had_liked":false,"id":25366,"user_name":"木木夕Ace","can_delete":false,"product_type":"c1","uid":1169354,"ip_address":"","ucode":"FB9442A836454A","user_header":"https://static001.geekbang.org/account/avatar/00/11/d7/ca/7b8bd13c.jpg","comment_is_top":false,"comment_ctime":1537319630,"is_pvip":false,"replies":[{"id":"9212","content":"是的","user_name":"作者回复","user_name_real":"刘超@网易云","uid":"1001590","ctime":1537322504,"ip_address":"","comment_id":25366,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1537319630","product_id":100007101,"comment_content":"签名里应该要有域名信息吧？","like_count":0,"discussions":[{"author":{"id":1001590,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/48/76/0c7d4d23.jpg","nickname":"刘超","note":"","ucode":"196BF3F499E8FE","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":424272,"discussion_content":"是的","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1537322504,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":23352,"user_name":"米斯特粥","can_delete":false,"product_type":"c1","uid":1048271,"ip_address":"","ucode":"49689C18EC41A9","user_header":"https://static001.geekbang.org/account/avatar/00/0f/fe/cf/aa6b25b7.jpg","comment_is_top":false,"comment_ctime":1536296550,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1536296550","product_id":100007101,"comment_content":"TLS&#47;SSL协议本身并不提供身份验证功能，它需要PKI技术中的证书机制来保证。","like_count":0},{"had_liked":false,"id":20577,"user_name":"励研冰","can_delete":false,"product_type":"c1","uid":1106394,"ip_address":"","ucode":"FCBC8266018FA0","user_header":"https://static001.geekbang.org/account/avatar/00/10/e1/da/d7f591a7.jpg","comment_is_top":false,"comment_ctime":1534562042,"is_pvip":false,"replies":[{"id":"7272","content":"直接传输对称密钥比计算更不安全","user_name":"作者回复","user_name_real":"刘超@网易云","uid":"1001590","ctime":1534730675,"ip_address":"","comment_id":20577,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1534562042","product_id":100007101,"comment_content":"通过这三个随机数，可以在客户端和服务器产生相同的对称密钥。老师这句话怎么理解？客户端生成一个随机数发个服务端当作对称加密的密钥不久行了吗，为什么会发送两个？","like_count":0,"discussions":[{"author":{"id":1001590,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/48/76/0c7d4d23.jpg","nickname":"刘超","note":"","ucode":"196BF3F499E8FE","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":422311,"discussion_content":"直接传输对称密钥比计算更不安全","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1534730675,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":20510,"user_name":"rtoday","can_delete":false,"product_type":"c1","uid":1174402,"ip_address":"","ucode":"DFAA788C96ABAC","user_header":"https://static001.geekbang.org/account/avatar/00/11/eb/82/4b56fa5f.jpg","comment_is_top":false,"comment_ctime":1534498363,"is_pvip":false,"replies":[{"id":"7261","content":"没错的，用非对称的传输对称的，然后用对称的传输内容","user_name":"作者回复","user_name_real":"刘超@网易云","uid":"1001590","ctime":1534726404,"ip_address":"","comment_id":20510,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1534498363","product_id":100007101,"comment_content":"HTTPS 的工作模式<br>我们可以知道，非对称加密在性能上不如对称加密，那是否能将两者结合起来呢？例如，公钥<br>私钥主要用于传输对称加密的秘钥，而真正的双方大数据量的通信都是通过对称加密进行的。<br>当然是可以的。这就是 HTTPS 协议的总体思路<br><br>这里我一直觉得读起来很怪…<br>请问是不是写错了？<br><br>，公钥<br>私钥主要用于传输「非」对称加密的秘钥<br>","like_count":0,"discussions":[{"author":{"id":1001590,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/48/76/0c7d4d23.jpg","nickname":"刘超","note":"","ucode":"196BF3F499E8FE","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":422281,"discussion_content":"没错的，用非对称的传输对称的，然后用对称的传输内容","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1534726404,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":18402,"user_name":"芋头","can_delete":false,"product_type":"c1","uid":1070287,"ip_address":"","ucode":"390438CFF71F0A","user_header":"https://static001.geekbang.org/account/avatar/00/10/54/cf/fddcf843.jpg","comment_is_top":false,"comment_ctime":1533292333,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1533292333","product_id":100007101,"comment_content":"学到了很多，把之前有疑惑的地方都解释清楚了，赞","like_count":0},{"had_liked":false,"id":16626,"user_name":"会飞的肥肥会飞","can_delete":false,"product_type":"c1","uid":1083983,"ip_address":"","ucode":"0B645F765CC505","user_header":"https://static001.geekbang.org/account/avatar/00/10/8a/4f/a3a78dde.jpg","comment_is_top":false,"comment_ctime":1532055423,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1532055423","product_id":100007101,"comment_content":"1. 对称加密，加解密一个密匙。该方式的优势在于加解密效率高，所以可用于对大量实际通信内容进行加密；其劣势在于加解密双方信息的一致性问题，即在协商密匙时，双方信息一致性的达成会受到所处环境的干扰，付出的代价较大。<br><br>2. 非对称加密，有公钥和私钥之分，两两配对。私钥自己保存，不能公开；公钥可以公开。私钥加密，其对应公钥可以解密；反之亦然。由于公钥可以公开传输，所以该方式可以解决对称加密的劣势问题，但需要有方法来验证公钥的合法性问题<br><br>3. 数字证书可以验证公钥的合法性，数字证书由认证机构颁发，认证机构的合法性由其上层认证机构来证实，层层向上追溯，一直到root机构","like_count":0},{"had_liked":false,"id":14171,"user_name":"米兰的小铁匠","can_delete":false,"product_type":"c1","uid":1024303,"ip_address":"","ucode":"5CCE3C8AE4FDC2","user_header":"","comment_is_top":false,"comment_ctime":1530201954,"is_pvip":false,"replies":[{"id":"4790","content":"公钥是公开的","user_name":"作者回复","user_name_real":"刘超@网易云","uid":"1001590","ctime":1530289158,"ip_address":"","comment_id":14171,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1530201954","product_id":100007101,"comment_content":"非对称加密里面有一段话说：‘’外卖网站拿私钥加密的，互联网上人人都可以把它打开，当然包括黑客。‘’ <br>我想问其他人是怎么打开的呢？","like_count":0,"discussions":[{"author":{"id":1001590,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/48/76/0c7d4d23.jpg","nickname":"刘超","note":"","ucode":"196BF3F499E8FE","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":419897,"discussion_content":"公钥是公开的","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1530289158,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":13709,"user_name":"Clancey","can_delete":false,"product_type":"c1","uid":1074095,"ip_address":"","ucode":"EEE018E6D27A16","user_header":"https://static001.geekbang.org/account/avatar/00/10/63/af/226bf1b2.jpg","comment_is_top":false,"comment_ctime":1529941029,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1529941029","product_id":100007101,"comment_content":"区块链的密码学技术😁","like_count":0},{"had_liked":false,"id":13590,"user_name":"问题究竟系边度","can_delete":false,"product_type":"c1","uid":1095284,"ip_address":"","ucode":"CA4F2C9A84F867","user_header":"https://static001.geekbang.org/account/avatar/00/10/b6/74/c63449b1.jpg","comment_is_top":false,"comment_ctime":1529827656,"is_pvip":true,"discussion_count":0,"race_medal":0,"score":"1529827656","product_id":100007101,"comment_content":"握手结果作为一个token持续字段时间。<br>减少加密套件挑选时间。<br>下载中间证书保存。<br>使用硬件加快rsa计算速度<br>","like_count":0},{"had_liked":false,"id":13518,"user_name":"于小龙","can_delete":false,"product_type":"c1","uid":1159065,"ip_address":"","ucode":"121C63C378C458","user_header":"https://static001.geekbang.org/account/avatar/00/11/af/99/1e215523.jpg","comment_is_top":false,"comment_ctime":1529719236,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1529719236","product_id":100007101,"comment_content":"问题1复用最后协商密钥放到session ，减少握手次数，最重要的还是优化算法，用更高版本的tls版本，比如1.3","like_count":0},{"had_liked":false,"id":13483,"user_name":"Hurt","can_delete":false,"product_type":"c1","uid":1050946,"ip_address":"","ucode":"DCE7428CCF08EF","user_header":"https://static001.geekbang.org/account/avatar/00/10/09/42/1f762b72.jpg","comment_is_top":false,"comment_ctime":1529670049,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1529670049","product_id":100007101,"comment_content":"老师。微信 支付宝的签名验证属于一个范畴吗 ","like_count":0},{"had_liked":false,"id":13325,"user_name":"9527","can_delete":false,"product_type":"c1","uid":1063642,"ip_address":"","ucode":"23D255058D98BF","user_header":"https://static001.geekbang.org/account/avatar/00/10/3a/da/4c4cc7f8.jpg","comment_is_top":false,"comment_ctime":1529542125,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1529542125","product_id":100007101,"comment_content":"wireshark抓包讲一下，刘老师","like_count":0},{"had_liked":false,"id":13219,"user_name":"咖啡猫口里的咖啡猫🐱","can_delete":false,"product_type":"c1","uid":1036565,"ip_address":"","ucode":"FE2441B3A40375","user_header":"https://static001.geekbang.org/account/avatar/00/0f/d1/15/7d47de48.jpg","comment_is_top":false,"comment_ctime":1529456633,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1529456633","product_id":100007101,"comment_content":"减少交互，keep alive 保持tcp连接，导致可被释放的连接一直维持，0包，抢站资源，导致so backlog队列溢出，，，所以设计时，服务端一定要有TCP心跳包机制，主动断开客户端连接。。。也可以通过http2来优化，，h2协议，，，对不对老师o(^o^)o","like_count":0},{"had_liked":false,"id":13211,"user_name":"星一","can_delete":false,"product_type":"c1","uid":1103829,"ip_address":"","ucode":"EF550131FAE1BF","user_header":"https://static001.geekbang.org/account/avatar/00/10/d7/d5/6fbf1070.jpg","comment_is_top":false,"comment_ctime":1529456003,"is_pvip":false,"replies":[{"id":"4443","content":"我的意思是线下商量对称密钥的方式，类似接头这种方式，客户端太多不可能，","user_name":"作者回复","user_name_real":"刘超@网易云","uid":"1001590","ctime":1529472278,"ip_address":"","comment_id":13211,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1529456003","product_id":100007101,"comment_content":"你好，文中对称加密那块说客户端太多，不适合使用对称加密，我理解的客户端（逻辑）只有一个，怎么会有多个呢，没太明白，不能把每个用户都算一个客户端吧","like_count":0,"discussions":[{"author":{"id":1001590,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/48/76/0c7d4d23.jpg","nickname":"刘超","note":"","ucode":"196BF3F499E8FE","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":419579,"discussion_content":"我的意思是线下商量对称密钥的方式，类似接头这种方式，客户端太多不可能，","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1529472278,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":13198,"user_name":"朱永昌","can_delete":false,"product_type":"c1","uid":1116128,"ip_address":"","ucode":"FDF71B7DDDB930","user_header":"https://static001.geekbang.org/account/avatar/00/11/07/e0/19cb0e9f.jpg","comment_is_top":false,"comment_ctime":1529454770,"is_pvip":false,"replies":[{"id":"4446","content":"不是的，如果不是双向认证就不需要，如果需要双向认证，客户端也需要有证书，也是通过https中有一步传过去的，这里没画","user_name":"作者回复","user_name_real":"刘超@网易云","uid":"1001590","ctime":1529472410,"ip_address":"","comment_id":13198,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1529454770","product_id":100007101,"comment_content":"老师您好，有个问题烦请帮忙解答，客户端通过外卖网站上的CA证书获取外卖网站的公钥，那么外卖网站是如何获取每个客户的公钥的呢？每个客户端都会有自己的CA证书吗？","like_count":0,"discussions":[{"author":{"id":1001590,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/48/76/0c7d4d23.jpg","nickname":"刘超","note":"","ucode":"196BF3F499E8FE","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":419573,"discussion_content":"不是的，如果不是双向认证就不需要，如果需要双向认证，客户端也需要有证书，也是通过https中有一步传过去的，这里没画","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1529472410,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]}]}