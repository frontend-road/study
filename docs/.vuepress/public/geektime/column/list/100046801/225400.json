{"id":225400,"title":"24 | RocksDBï¼šä¸ä¸¢æ•°æ®çš„é«˜æ€§èƒ½KVå­˜å‚¨","content":"<p>ä½ å¥½ï¼Œæˆ‘æ˜¯æç¥ã€‚</p><p>ä¸ŠèŠ‚è¯¾æˆ‘ä»¬åœ¨è®²è§£CockroachDBçš„æ—¶å€™æåˆ°è¿‡ï¼ŒCockroachDBçš„å­˜å‚¨å¼•æ“æ˜¯ä¸€ä¸ªåˆ†å¸ƒå¼çš„KVå­˜å‚¨é›†ç¾¤ï¼Œå®ƒç”¨äº†ä¸€ç³»åˆ—æˆç†Ÿçš„æŠ€æœ¯æ¥è§£å†³é›†ç¾¤é—®é¢˜ï¼Œä½†æ˜¯åœ¨é›†ç¾¤çš„æ¯ä¸ªèŠ‚ç‚¹ä¸Šï¼Œè¿˜éœ€è¦ä¸€ä¸ªå•æœºçš„KVå­˜å‚¨æ¥ä¿å­˜æ•°æ®ï¼Œè¿™ä¸ªåœ°æ–¹CockroachDBç›´æ¥ä½¿ç”¨RocksDBä½œä¸ºå®ƒçš„KVå­˜å‚¨å¼•æ“ã€‚</p><p><a href=\"https://github.com/facebook/rocksdb\">RocksDB</a>æ˜¯Facebookå¼€æºçš„ä¸€ä¸ªé«˜æ€§èƒ½æŒä¹…åŒ–KVå­˜å‚¨ã€‚ç›®å‰ï¼Œä½ å¯èƒ½å¾ˆå°‘è§åˆ°è¿‡å“ªä¸ªé¡¹ç›®ä¼šç›´æ¥ä½¿ç”¨RocksDBæ¥ä¿å­˜æ•°æ®ï¼Œåœ¨æœªæ¥ï¼ŒRocksDBå¤§æ¦‚ç‡ä¹Ÿä¸ä¼šåƒRedisé‚£æ ·è¢«ä¸šåŠ¡ç³»ç»Ÿç›´æ¥ä½¿ç”¨ã€‚é‚£æˆ‘ä»¬ä¸ºä»€ä¹ˆè¦å…³æ³¨å®ƒå‘¢ï¼Ÿ</p><p>å› ä¸ºè¶Šæ¥è¶Šå¤šçš„æ–°ç”Ÿä»£æ•°æ®åº“ï¼Œéƒ½ä¸çº¦è€ŒåŒåœ°é€‰æ‹©RocksDBä½œä¸ºå®ƒä»¬çš„å­˜å‚¨å¼•æ“ã€‚åœ¨å°†æ¥ï¼Œå¾ˆæœ‰å¯èƒ½å‡ºç°ä»€ä¹ˆæ ·çš„æƒ…å†µå‘¢ï¼Ÿæˆ‘ä»¬ä½¿ç”¨çš„å¾ˆå¤šä¸åŒçš„æ•°æ®åº“ï¼Œå®ƒä»¬èƒŒåé‡‡ç”¨çš„å­˜å‚¨å¼•æ“éƒ½æ˜¯RocksDBã€‚</p><p>æˆ‘æ¥ç»™ä½ ä¸¾å‡ ä¸ªä¾‹å­ã€‚æˆ‘ä»¬ä¸ŠèŠ‚è¯¾è®²åˆ°çš„CockroachDBç”¨åˆ°äº†RocksDBä½œä¸ºå®ƒçš„å­˜å‚¨å¼•æ“ã€‚å†è¯´å‡ ä¸ªæ¯”è¾ƒæœ‰åçš„ï¼Œ<a href=\"http://myrocks.io/\">MyRocks</a>è¿™ä¸ªå¼€æºé¡¹ç›®ï¼Œä½ çœ‹å®ƒè¿™ä¸ªåå­—å°±çŸ¥é“å®ƒæ˜¯å¹²ä»€ä¹ˆçš„äº†ã€‚å®ƒåœ¨ç”¨RocksDBç»™MySQLåšå­˜å‚¨å¼•æ“ï¼Œç›®çš„æ˜¯å–ä»£ç°æœ‰çš„InnoDBå­˜å‚¨å¼•æ“ã€‚å¹¶ä¸”ï¼ŒMySQLçš„äº²å…„å¼ŸMariaDBå·²ç»æ¥çº³äº†MyRocksï¼Œä½œä¸ºå®ƒçš„ä¸€ä¸ªå¯é€‰çš„å­˜å‚¨å¼•æ“ã€‚è¿˜æœ‰å¤§å®¶éƒ½ç»å¸¸ç”¨çš„å®æ—¶è®¡ç®—å¼•æ“<a href=\"https://flink.apache.org/\">Flink</a>ï¼Œç”¨è¿‡çš„åŒå­¦éƒ½çŸ¥é“ï¼ŒFlinkçš„Stateå°±æ˜¯ä¸€ä¸ªKVçš„å­˜å‚¨ï¼Œå®ƒä½¿ç”¨çš„ä¹Ÿæ˜¯RocksDBã€‚è¿˜æœ‰åŒ…æ‹¬MongoDBã€Cassandraç­‰ç­‰å¾ˆå¤šçš„æ•°æ®åº“ï¼Œéƒ½åœ¨å¼€å‘åŸºäºRocksDBçš„å­˜å‚¨å¼•æ“ã€‚</p><!-- [[[read_end]]] --><p>ä»Šå¤©è¿™èŠ‚è¯¾ï¼Œæˆ‘ä»¬å°±ä¸€èµ·æ¥äº†è§£ä¸€ä¸‹RocksDBè¿™é¢—â€œæœªæ¥ä¹‹æ˜Ÿâ€ã€‚</p><h2>åŒæ ·æ˜¯KVå­˜å‚¨ï¼ŒRocksDBæœ‰å“ªäº›ä¸åŒï¼Ÿ</h2><p>è¯´åˆ°KVå­˜å‚¨ï¼Œæˆ‘ä»¬æœ€ç†Ÿæ‚‰çš„å°±æ˜¯Redisäº†ï¼Œæ¥ä¸‹æ¥æˆ‘ä»¬å°±æ¥å¯¹æ¯”ä¸€ä¸‹RocksDBå’ŒRedisè¿™ä¸¤ä¸ªKVå­˜å‚¨ã€‚</p><p>å…¶å®Rediså’ŒRocksDBä¹‹é—´æ²¡ä»€ä¹ˆå¯æ¯”æ€§ï¼Œä¸€ä¸ªæ˜¯ç¼“å­˜ï¼Œä¸€ä¸ªæ˜¯æ•°æ®åº“å­˜å‚¨å¼•æ“ï¼Œæ”¾åœ¨ä¸€èµ·æ¯”å°±åƒâ€œå…³å…¬æˆ˜ç§¦ç¼â€ä¸€æ ·ã€‚é‚£æˆ‘ä»¬æŠŠè¿™ä¸¤ä¸ªKVæ”¾åœ¨ä¸€èµ·å¯¹æ¯”ï¼Œç›®çš„ä¸æ˜¯ä¸ºäº†æ¯”è°å¼ºè°å¼±ï¼Œè€Œæ˜¯ä¸ºäº†è®©ä½ å¿«é€Ÿäº†è§£RocksDBèƒ½åŠ›ã€‚</p><p>æˆ‘ä»¬çŸ¥é“Redisæ˜¯ä¸€ä¸ªå†…å­˜æ•°æ®åº“ï¼Œå®ƒä¹‹æ‰€ä»¥èƒ½åšåˆ°éå¸¸å¥½çš„æ€§èƒ½ï¼Œä¸»è¦åŸå› å°±æ˜¯ï¼Œå®ƒçš„æ•°æ®éƒ½æ˜¯ä¿å­˜åœ¨å†…å­˜ä¸­çš„ã€‚ä»Rediså®˜æ–¹ç»™å‡ºçš„æµ‹è¯•æ•°æ®æ¥çœ‹ï¼Œå®ƒçš„éšæœºè¯»å†™æ€§èƒ½å¤§çº¦åœ¨50ä¸‡æ¬¡/ç§’å·¦å³ã€‚è€ŒRocksDBç›¸åº”çš„éšæœºè¯»å†™æ€§èƒ½å¤§çº¦åœ¨20ä¸‡æ¬¡/ç§’å·¦å³ï¼Œè™½ç„¶æ€§èƒ½è¿˜ä¸å¦‚Redisï¼Œä½†æ˜¯å·²ç»å¯ä»¥ç®—æ˜¯åŒä¸€ä¸ªé‡çº§çš„æ°´å¹³äº†ã€‚</p><p>è¿™é‡Œé¢ä½ éœ€è¦æ³¨æ„åˆ°çš„ä¸€ä¸ªé‡å¤§å·®å¼‚æ˜¯ï¼ŒRedisæ˜¯ä¸€ä¸ªå†…å­˜æ•°æ®åº“ï¼Œå¹¶ä¸æ˜¯ä¸€ä¸ªå¯é çš„å­˜å‚¨ã€‚æ•°æ®å†™åˆ°å†…å­˜ä¸­å°±ç®—æˆåŠŸäº†ï¼Œå®ƒå¹¶ä¸ä¿è¯å®‰å…¨åœ°ä¿å­˜åˆ°ç£ç›˜ä¸Šã€‚è€ŒRocksDBå®ƒæ˜¯ä¸€ä¸ªæŒä¹…åŒ–çš„KVå­˜å‚¨ï¼Œå®ƒéœ€è¦ä¿è¯æ¯æ¡æ•°æ®éƒ½è¦å®‰å…¨åœ°å†™åˆ°ç£ç›˜ä¸Šï¼Œè¿™ä¹Ÿæ˜¯å¾ˆå¤šæ•°æ®åº“äº§å“çš„åŸºæœ¬è¦æ±‚ã€‚è¿™ä¹ˆä¸€æ¯”ï¼Œæˆ‘ä»¬å°±çœ‹å‡ºæ¥RocksDBçš„ä¼˜åŠ¿äº†ï¼Œæˆ‘ä»¬çŸ¥é“ï¼Œç£ç›˜çš„è¯»å†™æ€§èƒ½å’Œå†…å­˜è¯»å†™æ€§èƒ½å·®ç€ä¸€ä¸¤ä¸ªæ•°é‡çº§ï¼Œè¯»å†™ç£ç›˜çš„RocksDBï¼Œèƒ½å’Œè¯»å†™å†…å­˜çš„Redisåšåˆ°ç›¸è¿‘çš„æ€§èƒ½ï¼Œè¿™å°±æ˜¯RocksDBçš„ä»·å€¼æ‰€åœ¨äº†ã€‚</p><p>RocksDBä¸ºä»€ä¹ˆèƒ½åœ¨ä¿è¯æ•°æ®æŒä¹…åŒ–çš„å‰æä¸‹ï¼Œè¿˜èƒ½åšåˆ°è¿™ä¹ˆå¼ºçš„æ€§èƒ½å‘¢ï¼Ÿæˆ‘ä»¬ä¹‹å‰åå¤è®²åˆ°è¿‡ï¼Œä¸€ä¸ªå­˜å‚¨ç³»ç»Ÿï¼Œå®ƒçš„è¯»å†™æ€§èƒ½ä¸»è¦å–å†³äºä»€ä¹ˆï¼Ÿå–å†³äºå®ƒçš„å­˜å‚¨ç»“æ„ï¼Œä¹Ÿå°±æ˜¯æ•°æ®æ˜¯å¦‚ä½•ç»„ç»‡çš„ã€‚</p><p>RocksDBé‡‡ç”¨äº†ä¸€ä¸ªéå¸¸å¤æ‚çš„æ•°æ®å­˜å‚¨ç»“æ„ï¼Œå¹¶ä¸”è¿™ä¸ªå­˜å‚¨ç»“æ„é‡‡ç”¨äº†å†…å­˜å’Œç£ç›˜æ··åˆå­˜å‚¨æ–¹å¼ï¼Œä½¿ç”¨ç£ç›˜æ¥ä¿è¯æ•°æ®çš„å¯é å­˜å‚¨ï¼Œå¹¶ä¸”åˆ©ç”¨é€Ÿåº¦æ›´å¿«çš„å†…å­˜æ¥æå‡è¯»å†™æ€§èƒ½ã€‚æˆ–è€…è¯´ï¼ŒRocksDBçš„å­˜å‚¨ç»“æ„æœ¬èº«å°±è‡ªå¸¦äº†å†…å­˜ç¼“å­˜ã€‚</p><p>é‚£æˆ‘ä»¬çŸ¥é“ï¼Œå†…å­˜ç¼“å­˜å¯ä»¥å¾ˆå¥½åœ°æå‡è¯»æ€§èƒ½ï¼Œä½†æ˜¯å†™å…¥æ•°æ®çš„æ—¶å€™ï¼Œä½ æ˜¯ç»•ä¸è¿‡è¦å†™ç£ç›˜çš„ã€‚å› ä¸ºï¼Œè¦ä¿è¯æ•°æ®æŒä¹…åŒ–ï¼Œæ•°æ®å¿…é¡»çœŸæ­£å†™åˆ°ç£ç›˜ä¸Šæ‰è¡Œã€‚RocksDBä¸ºä»€ä¹ˆèƒ½åšåˆ°è¿™ä¹ˆé«˜çš„å†™å…¥æ€§èƒ½ï¼Ÿè¿˜æ˜¯å› ä¸ºå®ƒç‰¹æ®Šçš„æ•°æ®ç»“æ„ã€‚</p><p>å¤§å¤šæ•°å­˜å‚¨ç³»ç»Ÿï¼Œä¸ºäº†èƒ½åšåˆ°å¿«é€ŸæŸ¥æ‰¾ï¼Œéƒ½ä¼šé‡‡ç”¨æ ‘æˆ–è€…å“ˆå¸Œè¡¨è¿™æ ·çš„å­˜å‚¨ç»“æ„ï¼Œæ•°æ®åœ¨å†™å…¥çš„æ—¶å€™ï¼Œå¿…é¡»å†™å…¥åˆ°ç‰¹å®šçš„ä½ç½®ä¸Šã€‚æ¯”å¦‚è¯´ï¼Œæˆ‘ä»¬åœ¨å¾€B+æ ‘ä¸­å†™å…¥ä¸€æ¡æ•°æ®ï¼Œå¿…é¡»æŒ‰ç…§B+æ ‘çš„æ’åºæ–¹å¼ï¼Œå†™å…¥åˆ°æŸä¸ªå›ºå®šçš„èŠ‚ç‚¹ä¸‹é¢ã€‚å“ˆå¸Œè¡¨ä¹Ÿæ˜¯ç±»ä¼¼ï¼Œå¿…é¡»è¦å†™å…¥åˆ°ç‰¹å®šçš„å“ˆå¸Œæ§½ä¸­å»ã€‚</p><p>è¿™äº›æ•°æ®ç»“æ„ä¼šå¯¼è‡´åœ¨å†™å…¥æ•°æ®çš„æ—¶å€™ï¼Œä¸å¾—ä¸åœ¨ç£ç›˜ä¸Šè¿™é‡Œå†™ä¸€ç‚¹å„¿ï¼Œå†å»é‚£é‡Œå†™ä¸€ç‚¹å„¿ï¼Œè¿™æ ·è·³æ¥è·³å»åœ°å†™ï¼Œä¹Ÿå°±æ˜¯æˆ‘ä»¬è¯´çš„â€œéšæœºå†™â€ã€‚è€ŒRocksDBå®ƒçš„æ•°æ®ç»“æ„ï¼Œå¯ä»¥è®©ç»å¤§å¤šæ•°å†™å…¥ç£ç›˜çš„æ“ä½œéƒ½æ˜¯é¡ºåºå†™ã€‚é‚£æˆ‘ä»¬çŸ¥é“ï¼Œæ— è®ºæ˜¯SSDè¿˜æ˜¯HDDé¡ºåºå†™çš„æ€§èƒ½éƒ½è¦è¿œè¿œå¥½äºéšæœºå†™ï¼Œè¿™å°±æ˜¯RocksDBèƒ½å¤Ÿåšåˆ°é«˜æ€§èƒ½å†™å…¥çš„æ ¹æœ¬åŸå› ã€‚</p><p>é‚£æˆ‘ä»¬åœ¨ã€Š<a href=\"https://time.geekbang.org/column/article/224162\">21 | ç±»ä¼¼â€œç‚¹å‡»æµâ€è¿™æ ·çš„æµ·é‡æ•°æ®åº”è¯¥å¦‚ä½•å­˜å‚¨ï¼Ÿ</a>ã€‹è¿™èŠ‚è¯¾ä¸­è®²åˆ°è¿‡ï¼ŒKafkaä¹Ÿæ˜¯é‡‡ç”¨é¡ºåºè¯»å†™çš„æ–¹å¼ï¼Œæ‰€ä»¥å®ƒçš„è¯»å†™æ€§èƒ½ä¹Ÿæ˜¯è¶…çº§å¿«ã€‚ä½†æ˜¯è¿™ç§é¡ºåºå†™å…¥çš„æ•°æ®åŸºæœ¬ä¸Šæ˜¯æ²¡æ³•æŸ¥è¯¢çš„ï¼Œå› ä¸ºæ•°æ®æ²¡æœ‰ç»“æ„ï¼Œæƒ³è¦æŸ¥è¯¢çš„è¯ï¼Œåªèƒ½å»éå†ã€‚RocksDBç©¶ç«Ÿä½¿ç”¨äº†ä»€ä¹ˆæ ·çš„æ•°æ®ç»“æ„ï¼Œåœ¨ä¿è¯æ•°æ®é¡ºåºå†™å…¥çš„å‰æä¸‹è¿˜èƒ½å…¼é¡¾å¾ˆå¥½çš„æŸ¥è¯¢æ€§èƒ½å‘¢ï¼Ÿè¿™ç§æ•°æ®ç»“æ„å°±æ˜¯<strong>LSM-Tree</strong>ã€‚</p><h2>LSM-Treeå¦‚ä½•å…¼é¡¾è¯»å†™æ€§èƒ½ï¼Ÿ</h2><p>LSM-Treeçš„å…¨ç§°æ˜¯ï¼š<strong>The Log-Structured Merge-Tree</strong>ï¼Œæ˜¯ä¸€ç§éå¸¸å¤æ‚çš„å¤åˆæ•°æ®ç»“æ„ï¼Œå®ƒåŒ…å«äº†WALï¼ˆWrite Ahead Logï¼‰ã€è·³è¡¨ï¼ˆSkipListï¼‰å’Œä¸€ä¸ªåˆ†å±‚çš„æœ‰åºè¡¨ï¼ˆSSTableï¼ŒSorted String Tableï¼‰ã€‚ä¸‹é¢è¿™å¼ å›¾å°±æ˜¯LSM-Treeçš„ç»“æ„å›¾ï¼ˆå›¾ç‰‡æ¥è‡ªäºè®ºæ–‡: <a href=\"http://ranger.uta.edu/~sjiang/pubs/papers/wang14-LSM-SDF.pdf\">An Efficient Design and Implementation of LSM-Tree based Key-Value Store on Open-Channel SSD</a>ï¼‰</p><p><img src=\"https://static001.geekbang.org/resource/image/c0/6e/c0ba7aa330ea79a8a1dfe3a58547526e.jpg?wh=1187*841\" alt=\"\"></p><p>çœ‹èµ·æ¥éå¸¸å¤æ‚æ˜¯å§ï¼Ÿå®é™…ä¸Šå®ƒçš„ç»“æ„æ¯”è¿™ä¸ªå›¾æ›´å¤æ‚ã€‚é‚£æˆ‘ä»¬å°½é‡å¿½ç•¥æ²¡é‚£ä¹ˆé‡è¦çš„ç»†èŠ‚ï¼ŒæŠŠå®ƒçš„æ ¸å¿ƒåŸç†è®²æ¸…æ¥šã€‚é¦–å…ˆéœ€è¦æ³¨æ„çš„æ˜¯ï¼Œè¿™ä¸ªå›¾ä¸Šæœ‰ä¸€ä¸ªæ¨ªå‘çš„å®çº¿ï¼Œæ˜¯å†…å­˜å’Œç£ç›˜çš„åˆ†ç•Œçº¿ï¼Œä¸Šé¢çš„éƒ¨åˆ†æ˜¯å†…å­˜ï¼Œä¸‹é¢çš„éƒ¨åˆ†æ˜¯ç£ç›˜ã€‚</p><p>æˆ‘ä»¬å…ˆæ¥çœ‹æ•°æ®æ˜¯å¦‚ä½•å†™å…¥çš„ã€‚å½“LSM-Treeæ”¶åˆ°ä¸€ä¸ªå†™è¯·æ±‚ï¼Œæ¯”å¦‚è¯´ï¼šPUT foo barï¼ŒæŠŠKey fooçš„å€¼è®¾ç½®ä¸ºbarã€‚é¦–å…ˆï¼Œè¿™æ¡æ“ä½œå‘½ä»¤ä¼šè¢«å†™å…¥åˆ°ç£ç›˜çš„WALæ—¥å¿—ä¸­ï¼ˆå›¾ä¸­å³ä¾§çš„Logï¼‰ï¼Œè¿™æ˜¯ä¸€ä¸ªé¡ºåºå†™ç£ç›˜çš„æ“ä½œï¼Œæ€§èƒ½å¾ˆå¥½ã€‚è¿™ä¸ªæ—¥å¿—çš„å”¯ä¸€ä½œç”¨å°±æ˜¯ç”¨äºæ•…éšœæ¢å¤ï¼Œä¸€æ—¦ç³»ç»Ÿå®•æœºï¼Œå¯ä»¥ä»æ—¥å¿—ä¸­æŠŠå†…å­˜ä¸­è¿˜æ²¡æœ‰æ¥å¾—åŠå†™å…¥ç£ç›˜çš„æ•°æ®æ¢å¤å‡ºæ¥ã€‚è¿™ä¸ªåœ°æ–¹ç”¨çš„è¿˜æ˜¯ä¹‹å‰æˆ‘ä»¬å¤šæ¬¡è®²è¿‡çš„å¤åˆ¶çŠ¶æ€æœºç†è®ºã€‚</p><p>å†™å®Œæ—¥å¿—ä¹‹åï¼Œæ•°æ®å¯é æ€§çš„é—®é¢˜å°±è§£å†³äº†ã€‚ç„¶åæ•°æ®ä¼šè¢«å†™å…¥åˆ°å†…å­˜ä¸­çš„MemTableä¸­ï¼Œè¿™ä¸ªMemTableå°±æ˜¯ä¸€ä¸ªæŒ‰ç…§Keyç»„ç»‡çš„è·³è¡¨ï¼ˆSkipListï¼‰ï¼Œè·³è¡¨å’Œå¹³è¡¡æ ‘æœ‰ç€ç±»ä¼¼çš„æŸ¥æ‰¾æ€§èƒ½ï¼Œä½†å®ç°èµ·æ¥æ›´ç®€å•ä¸€äº›ã€‚å†™MemTableæ˜¯ä¸ªå†…å­˜æ“ä½œï¼Œé€Ÿåº¦ä¹Ÿéå¸¸å¿«ã€‚æ•°æ®å†™å…¥åˆ°MemTableä¹‹åï¼Œå°±å¯ä»¥è¿”å›å†™å…¥æˆåŠŸäº†ã€‚è¿™é‡Œé¢æœ‰ä¸€ç‚¹éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œ<strong>LSM-Treeåœ¨å¤„ç†å†™å…¥çš„è¿‡ç¨‹ä¸­ï¼Œç›´æ¥å°±å¾€MemTableé‡Œå†™ï¼Œå¹¶ä¸å»æŸ¥æ‰¾è¿™ä¸ªKeyæ˜¯ä¸æ˜¯å·²ç»å­˜åœ¨äº†</strong>ã€‚</p><p>è¿™ä¸ªå†…å­˜ä¸­MemTableä¸èƒ½æ— é™åœ°å¾€é‡Œå†™ï¼Œä¸€æ˜¯å†…å­˜çš„å®¹é‡æ¯•ç«Ÿæœ‰é™ï¼Œå¦å¤–ï¼ŒMemTableå¤ªå¤§äº†è¯»å†™æ€§èƒ½éƒ½ä¼šä¸‹é™ã€‚æ‰€ä»¥ï¼ŒMemTableæœ‰ä¸€ä¸ªå›ºå®šçš„ä¸Šé™å¤§å°ï¼Œä¸€èˆ¬æ˜¯32Mã€‚MemTableå†™æ»¡ä¹‹åï¼Œå°±è¢«è½¬æ¢æˆImmutable MemTableï¼Œç„¶åå†åˆ›å»ºä¸€ä¸ªç©ºçš„MemTableç»§ç»­å†™ã€‚è¿™ä¸ªImmutable MemTableï¼Œä¹Ÿå°±æ˜¯åªè¯»çš„MemTableï¼Œå®ƒå’ŒMemTableçš„æ•°æ®ç»“æ„å®Œå…¨ä¸€æ ·ï¼Œå”¯ä¸€çš„åŒºåˆ«å°±æ˜¯ä¸å…è®¸å†å†™å…¥äº†ã€‚</p><p>Immutable MemTableä¹Ÿä¸èƒ½åœ¨å†…å­˜ä¸­æ— é™åœ°å åœ°æ–¹ï¼Œä¼šæœ‰ä¸€ä¸ªåå°çº¿ç¨‹ï¼Œä¸åœåœ°æŠŠImmutable MemTableå¤åˆ¶åˆ°ç£ç›˜æ–‡ä»¶ä¸­ï¼Œç„¶åé‡Šæ”¾å†…å­˜ç©ºé—´ã€‚æ¯ä¸ªImmutable MemTableå¯¹åº”ä¸€ä¸ªç£ç›˜æ–‡ä»¶ï¼ŒMemTableçš„æ•°æ®ç»“æ„è·³è¡¨æœ¬èº«å°±æ˜¯ä¸€ä¸ªæœ‰åºè¡¨ï¼Œå†™å…¥çš„æ–‡ä»¶ä¹Ÿæ˜¯ä¸€ä¸ªæŒ‰ç…§Keyæ’åºçš„ç»“æ„ï¼Œè¿™äº›æ–‡ä»¶å°±æ˜¯SSTableã€‚æŠŠMemTableå†™å…¥SSTableè¿™ä¸ªå†™æ“ä½œï¼Œå› ä¸ºå®ƒæ˜¯æŠŠæ•´å—å†…å­˜å†™å…¥åˆ°æ•´ä¸ªæ–‡ä»¶ä¸­ï¼Œè¿™åŒæ ·æ˜¯ä¸€ä¸ªé¡ºåºå†™æ“ä½œã€‚</p><p>åˆ°è¿™é‡Œï¼Œè™½ç„¶æ•°æ®å·²ç»ä¿å­˜åˆ°ç£ç›˜ä¸Šäº†ï¼Œä½†è¿˜æ²¡ç»“æŸï¼Œå› ä¸ºè¿™äº›SSTableæ–‡ä»¶ï¼Œè™½ç„¶æ¯ä¸ªæ–‡ä»¶ä¸­çš„Keyæ˜¯æœ‰åºçš„ï¼Œä½†æ˜¯æ–‡ä»¶ä¹‹é—´æ˜¯å®Œå…¨æ— åºçš„ï¼Œè¿˜æ˜¯æ²¡æ³•æŸ¥æ‰¾ã€‚è¿™é‡ŒSSTableé‡‡ç”¨äº†ä¸€ä¸ªå¾ˆå·§å¦™çš„åˆ†å±‚åˆå¹¶æœºåˆ¶æ¥è§£å†³ä¹±åºçš„é—®é¢˜ã€‚</p><p>SSTableè¢«åˆ†ä¸ºå¾ˆå¤šå±‚ï¼Œè¶Šå¾€ä¸Šå±‚ï¼Œæ–‡ä»¶è¶Šå°‘ï¼Œè¶Šå¾€åº•å±‚ï¼Œæ–‡ä»¶è¶Šå¤šã€‚æ¯ä¸€å±‚çš„å®¹é‡éƒ½æœ‰ä¸€ä¸ªå›ºå®šçš„ä¸Šé™ï¼Œä¸€èˆ¬æ¥è¯´ï¼Œä¸‹ä¸€å±‚çš„å®¹é‡æ˜¯ä¸Šä¸€å±‚çš„10å€ã€‚å½“æŸä¸€å±‚å†™æ»¡äº†ï¼Œå°±ä¼šè§¦å‘åå°çº¿ç¨‹å¾€ä¸‹ä¸€å±‚åˆå¹¶ï¼Œæ•°æ®åˆå¹¶åˆ°ä¸‹ä¸€å±‚ä¹‹åï¼Œæœ¬å±‚çš„SSTableæ–‡ä»¶å°±å¯ä»¥åˆ é™¤æ‰äº†ã€‚åˆå¹¶çš„è¿‡ç¨‹ä¹Ÿæ˜¯æ’åºçš„è¿‡ç¨‹ï¼Œé™¤äº†Level 0ï¼ˆç¬¬0å±‚ï¼Œä¹Ÿå°±æ˜¯MemTableç›´æ¥dumpå‡ºæ¥çš„ç£ç›˜æ–‡ä»¶æ‰€åœ¨çš„é‚£ä¸€å±‚ã€‚ï¼‰ä»¥å¤–ï¼Œæ¯ä¸€å±‚å†…çš„æ–‡ä»¶éƒ½æ˜¯æœ‰åºçš„ï¼Œæ–‡ä»¶å†…çš„KVä¹Ÿæ˜¯æœ‰åºçš„ï¼Œè¿™æ ·å°±æ¯”è¾ƒä¾¿äºæŸ¥æ‰¾äº†ã€‚</p><p>ç„¶åæˆ‘ä»¬å†æ¥è¯´LSM-Treeå¦‚ä½•æŸ¥æ‰¾æ•°æ®ã€‚æŸ¥æ‰¾çš„è¿‡ç¨‹ä¹Ÿæ˜¯åˆ†å±‚æŸ¥æ‰¾ï¼Œå…ˆå»å†…å­˜ä¸­çš„MemTableå’ŒImmutable MemTableä¸­æ‰¾ï¼Œç„¶åå†æŒ‰ç…§é¡ºåºä¾æ¬¡åœ¨ç£ç›˜çš„æ¯ä¸€å±‚SSTableæ–‡ä»¶ä¸­å»æ‰¾ï¼Œåªè¦æ‰¾åˆ°äº†å°±ç›´æ¥è¿”å›ã€‚è¿™æ ·çš„æŸ¥æ‰¾æ–¹å¼å…¶å®æ˜¯å¾ˆä½æ•ˆçš„ï¼Œæœ‰å¯èƒ½éœ€è¦å¤šæ¬¡æŸ¥æ‰¾å†…å­˜å’Œå¤šä¸ªæ–‡ä»¶æ‰èƒ½æ‰¾åˆ°ä¸€ä¸ªKeyï¼Œä½†å®é™…çš„æ•ˆæœä¹Ÿæ²¡é‚£ä¹ˆå·®ï¼Œå› ä¸ºè¿™æ ·ä¸€ä¸ªåˆ†å±‚çš„ç»“æ„ï¼Œå®ƒä¼šå¤©ç„¶å½¢æˆä¸€ä¸ªéå¸¸æœ‰åˆ©äºæŸ¥æ‰¾çš„æƒ…å†µï¼šè¶Šæ˜¯è¢«ç»å¸¸è¯»å†™çš„çƒ­æ•°æ®ï¼Œå®ƒåœ¨è¿™ä¸ªåˆ†å±‚ç»“æ„ä¸­å°±è¶Šé ä¸Šï¼Œå¯¹è¿™æ ·çš„KeyæŸ¥æ‰¾å°±è¶Šå¿«ã€‚</p><p>æ¯”å¦‚è¯´ï¼Œæœ€ç»å¸¸è¯»å†™çš„Keyå¾ˆå¤§æ¦‚ç‡ä¼šåœ¨å†…å­˜ä¸­ï¼Œè¿™æ ·ä¸ç”¨è¯»å†™ç£ç›˜å°±å®Œæˆäº†æŸ¥æ‰¾ã€‚å³ä½¿å†…å­˜ä¸­æŸ¥ä¸åˆ°ï¼ŒçœŸæ­£èƒ½ç©¿é€å¾ˆå¤šå±‚SStableä¸€ç›´æŸ¥åˆ°æœ€åº•å±‚çš„è¯·æ±‚è¿˜æ˜¯å¾ˆå°‘çš„ã€‚å¦å¤–ï¼Œåœ¨å·¥ç¨‹ä¸Šè¿˜ä¼šå¯¹æŸ¥æ‰¾åšå¾ˆå¤šçš„ä¼˜åŒ–ï¼Œæ¯”å¦‚è¯´ï¼Œåœ¨å†…å­˜ä¸­ç¼“å­˜SSTableæ–‡ä»¶çš„Keyï¼Œç”¨å¸ƒéš†è¿‡æ»¤å™¨é¿å…æ— è°“çš„æŸ¥æ‰¾ç­‰æ¥åŠ é€ŸæŸ¥æ‰¾è¿‡ç¨‹ã€‚è¿™æ ·ç»¼åˆä¼˜åŒ–ä¸‹æ¥ï¼Œå¯ä»¥è·å¾—ç›¸å¯¹è¿˜ä¸é”™çš„æŸ¥æ‰¾æ€§èƒ½ã€‚</p><h2>å°ç»“</h2><p>RocksDBæ˜¯ä¸€ä¸ªé«˜æ€§èƒ½æŒä¹…åŒ–çš„KVå­˜å‚¨ï¼Œè¢«å¾ˆå¤šæ–°ç”Ÿä»£çš„æ•°æ®åº“ä½œä¸ºå­˜å‚¨å¼•æ“ã€‚RocksDBåœ¨ä¿è¯ä¸é”™çš„è¯»æ€§èƒ½çš„å‰æä¸‹ï¼Œå¤§å¹…åœ°æå‡äº†å†™å…¥æ€§èƒ½ï¼Œè¿™ä¸»è¦å¾—ç›Šäºå®ƒçš„æ•°æ®ç»“æ„ï¼šLSM-Treeã€‚</p><p>LSM-Treeé€šè¿‡æ··åˆå†…å­˜å’Œç£ç›˜å†…çš„å¤šç§æ•°æ®ç»“æ„ï¼Œå°†éšæœºå†™è½¬æ¢ä¸ºé¡ºåºå†™æ¥æå‡å†™æ€§èƒ½ï¼Œé€šè¿‡å¼‚æ­¥å‘ä¸‹åˆå¹¶åˆ†å±‚SSTableæ–‡ä»¶çš„æ–¹å¼ï¼Œè®©çƒ­æ•°æ®çš„æŸ¥æ‰¾æ›´é«˜æ•ˆï¼Œä»è€Œè·å¾—è¿˜ä¸é”™çš„ç»¼åˆæŸ¥æ‰¾æ€§èƒ½ã€‚</p><p>é€šè¿‡åˆ†æLSM-Treeçš„æ•°æ®ç»“æ„å¯ä»¥çœ‹å‡ºæ¥ï¼Œè¿™ç§æ•°æ®ç»“æ„è¿˜æ˜¯åå‘äºå†™å…¥æ€§èƒ½çš„ä¼˜åŒ–ï¼Œæ›´é€‚åˆåœ¨çº¿äº¤æ˜“ç±»åœºæ™¯ï¼Œå› ä¸ºåœ¨è¿™ç±»åœºæ™¯ä¸‹ï¼Œéœ€è¦é¢‘ç¹å†™å…¥æ•°æ®ã€‚</p><h2>æ€è€ƒé¢˜</h2><p>æˆ‘ä»¬åˆšåˆšè®²äº†LSM-Treeæ˜¯å¦‚ä½•è¯»å†™æ•°æ®çš„ï¼Œä½†æ˜¯å¹¶æ²¡æœ‰æåˆ°æ•°æ®æ˜¯å¦‚ä½•åˆ é™¤çš„ã€‚è¯¾åè¯·ä½ å»çœ‹ä¸€ä¸‹RocksDBæˆ–è€…æ˜¯LevelDBç›¸å…³çš„æ–‡æ¡£ï¼Œæ€»ç»“ä¸€ä¸‹LSM-Treeåˆ é™¤æ•°æ®çš„è¿‡ç¨‹ï¼Œä¹Ÿæ¬¢è¿ä½ åœ¨ç•™è¨€åŒºåˆ†äº«ä½ çš„æ€»ç»“ã€‚</p><p>æ„Ÿè°¢ä½ çš„é˜…è¯»ï¼Œå¦‚æœä½ è§‰å¾—ä»Šå¤©çš„å†…å®¹å¯¹ä½ æœ‰å¸®åŠ©ï¼Œä¹Ÿæ¬¢è¿æŠŠå®ƒåˆ†äº«ç»™ä½ çš„æœ‹å‹ã€‚</p>","neighbors":{"left":{"article_title":"23 | MySQLç»å¸¸é‡åˆ°çš„é«˜å¯ç”¨ã€åˆ†ç‰‡é—®é¢˜ï¼ŒNewSQLæ˜¯å¦‚ä½•è§£å†³çš„ï¼Ÿ","id":225398},"right":{"article_title":"ç»“è¯¾æµ‹è¯• | åç«¯å­˜å‚¨ï¼Œ100åˆ†è¯•å·ç­‰ä½ æ¥æŒ‘æˆ˜","id":227863}},"comments":[{"had_liked":false,"id":209041,"user_name":"æç¥","can_delete":false,"product_type":"c1","uid":1501046,"ip_address":"","ucode":"B19E91EE248591","user_header":"https://static001.geekbang.org/account/avatar/00/16/e7/76/79c1f23a.jpg","comment_is_top":true,"comment_ctime":1587482249,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"9.2233722145358991e+18","product_id":100046801,"comment_content":"Hiï¼Œæˆ‘æ˜¯æç¥ã€‚<br><br>è¿™é‡Œå›é¡¾ä¸€ä¸‹ä¸ŠèŠ‚è¯¾çš„æ€è€ƒé¢˜ï¼š<br><br>è¯¾åè¯·ä½ å»çœ‹ä¸€ä¸‹Raftä¸€è‡´æ€§åè®®ï¼Œç„¶åç®€å•æ€»ç»“ä¸€ä¸‹ï¼ŒCockroachDB æ˜¯å¦‚ä½•åˆ©ç”¨ Raft åè®®å®ç° Range é«˜å¯ç”¨ã€é«˜å¯é å’Œå¼ºä¸€è‡´çš„ã€‚<br><br>è¿™é‡Œç®€å•è¯´ä¸€ä¸‹Raftåè®®ï¼ŒRaftæ˜¯ä¸€ä¸ªåˆ†å¸ƒå¼ä¸€è‡´æ€§åè®®ï¼Œåœ¨å¾ˆå¤šåˆ†å¸ƒå¼ç³»ç»Ÿä¸­ï¼Œéƒ½ä½¿ç”¨å®ƒæ¥ä¿è¯æ•°æ®å¼ºä¸€è‡´æ€§ã€‚å®ƒåˆ©ç”¨å¤åˆ¶çŠ¶æ€æœºæ¥è§£å†³å¤šä¸ªå‰¯æœ¬æ•°æ®ä¸€è‡´çš„é—®é¢˜ï¼Œä¿è¯æ—¥å¿—å¤åˆ¶åˆ°åŠæ•°ä»¥ä¸ŠèŠ‚ç‚¹æ‰ç»™å®¢æˆ·ç«¯è¿”å›æˆåŠŸã€‚å¹¶ä¸”ï¼Œå¼•å…¥äº†ä¸»ä»å¿ƒè·³æœºåˆ¶ï¼Œå½“ä¸»èŠ‚ç‚¹æ•…éšœæ—¶ï¼Œå…¶å®ƒèŠ‚ç‚¹èƒ½ä¸»åŠ¨å‘èµ·é€‰ä¸¾ï¼Œé€‰å‡ºæ–°çš„ä¸»èŠ‚ç‚¹ã€‚é€šè¿‡å¤åˆ¶çŠ¶æ€æœºã€å¿ƒè·³å’Œé€‰ä¸¾æœºåˆ¶ï¼Œæ¥ä¿è¯é›†ç¾¤æ•°æ®çš„é«˜å¯ç”¨ã€é«˜å¯é å’Œå¼ºä¸€è‡´ã€‚","like_count":42},{"had_liked":false,"id":208821,"user_name":"myrfy","can_delete":false,"product_type":"c1","uid":1169401,"ip_address":"","ucode":"2814BAE5D70098","user_header":"","comment_is_top":false,"comment_ctime":1587443853,"is_pvip":false,"replies":[{"id":"78320","content":"ğŸ‘ğŸ‘ğŸ‘","user_name":"ä½œè€…å›å¤","user_name_real":"æç¥","uid":"1501046","ctime":1587691367,"ip_address":"","comment_id":208821,"utype":1}],"discussion_count":1,"race_medal":0,"score":"156206266509","product_id":100046801,"comment_content":"åº”è¯¥æ˜¯æ ‡è®°åˆ é™¤ï¼Œæœ‰å¢“ç¢‘çš„æ¦‚å¿µï¼Œè¢«åˆ é™¤çš„æ¡ç›®ï¼Œå¦‚æœåœ¨memtableé‡Œï¼Œå¯ä»¥ç›´æ¥é€šè¿‡å¢“ç¢‘æ ‡è®°ä¸ºåˆ é™¤ï¼Œå¦‚æœä¸åœ¨memtableé‡Œå°±æ’å…¥ä¸€æ¡æ–°çš„åˆ é™¤è®°å½•ï¼Œè¿™ä¸¤ç§æƒ…å†µéƒ½ä¼šåœ¨å±‚çº§åˆå¹¶çš„æ—¶å€™çœŸæ­£å‘æŒ¥ä½œç”¨ï¼ŒåŒæ—¶WALé‡Œé€šè¿‡ä¸€æ¡é¢å¤–çš„logè®°å½•è¿™ä¸ªåˆ é™¤æ“ä½œã€‚<br><br>å¦å¤–æ„Ÿè§‰WALé‡Œå­˜å‚¨çš„å…¶å®å°±æ˜¯æ“ä½œæŒ‡ä»¤æµï¼Œå’Œrafté‡Œé¢çš„æ—¥å¿—å®Œå…¨ä¸€ä¸ªæ¦‚å¿µï¼Œæ‰€ä»¥raftåè®®å’Œleveldb&#47;rocksdbçš„ç»„åˆç®€ç›´æ˜¯ç»é…","like_count":37,"discussions":[{"author":{"id":1501046,"avatar":"https://static001.geekbang.org/account/avatar/00/16/e7/76/79c1f23a.jpg","nickname":"æç¥","note":"","ucode":"B19E91EE248591","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":492638,"discussion_content":"ğŸ‘ğŸ‘ğŸ‘","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1587691367,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":209190,"user_name":"Knuth","can_delete":false,"product_type":"c1","uid":1083616,"ip_address":"","ucode":"21298EF9BBB91A","user_header":"https://static001.geekbang.org/account/avatar/00/10/88/e0/292508a4.jpg","comment_is_top":false,"comment_ctime":1587518146,"is_pvip":false,"discussion_count":5,"race_medal":0,"score":"96076798658","product_id":100046801,"comment_content":"1.æäº†rocksdbï¼Œä¸å…ˆè®²ä¸€ä¸‹leveldbä¹ˆï¼Ÿ<br>2.è®²äº†lsmä¸æå‰å…ˆè®²ä¸‹bitcaskä¹ˆï¼Ÿ<br>3.é€»è¾‘ç»„ç»‡å»ºè®®æ¢³ç†ä¸€ä¸‹ï¼Œtradeoffåœ¨å“ªé‡Œï¼Œå¿«åœ¨å“ªé‡Œï¼Œæ…¢åœ¨å“ªé‡Œï¼Œä¸ºä»€ä¹ˆå¿«ï¼Œä¸ºä»€ä¹ˆæ…¢ï¼Œä½¿ç”¨åœºæ™¯åœ¨å“ªé‡Œã€‚è€Œä¸æ˜¯ä»åˆ«çš„åœ°æ–¹æ¬ä¸€äº›ä¸œè¥¿è¿‡æ¥ã€‚","like_count":23,"discussions":[{"author":{"id":1002581,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/4c/55/879a4443.jpg","nickname":"greensky01","note":"","ucode":"9C1B0EBFC603D1","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":258544,"discussion_content":"ç–‘é—®å¥æ¢æˆé™ˆè¿°å¥å¥½ä¸€ç‚¹ï¼ŒæŠ€æœ¯äº¤æµæ²¡æœ‰å¿…è¦æå¾—ç«è¯å‘³è¿™ä¹ˆå¤§ã€‚","likes_number":23,"is_delete":false,"is_hidden":false,"ctime":1588691833,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1202414,"avatar":"http://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTL7cOHiaxJBPvdic53UfP4VC2P4EsyYOGNEwhgYsrP4kw7MFhI7fKQ0GnIiadIHUEYVD85AkrcGv5DLg/132","nickname":"burner","note":"","ucode":"22B8C4622B6E3C","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":275682,"discussion_content":"å»ºè®®åˆ†äº«ä¸€ä¸‹ä½ çš„ç†è§£","likes_number":4,"is_delete":false,"is_hidden":false,"ctime":1590753951,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1049208,"avatar":"https://static001.geekbang.org/account/avatar/00/10/02/78/23c56bce.jpg","nickname":"james","note":"","ucode":"5701899403917C","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":251173,"discussion_content":"å“¥ä»¬éƒ½çŸ¥é“çœ‹è¿˜å­¦å•¥ å½“å®¡åˆ¤å®˜å—","likes_number":2,"is_delete":false,"is_hidden":false,"ctime":1588071318,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":2660316,"avatar":"https://static001.geekbang.org/account/avatar/00/28/97/dc/8eacc8f1.jpg","nickname":"æ¼ åšåµ©","note":"","ucode":"33704880E9790F","race_medal":0,"user_type":1,"is_pvip":true},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":551437,"discussion_content":"æƒ…å•†ä¸é«˜, åšä¸äº†é¢†å¯¼","likes_number":1,"is_delete":false,"is_hidden":false,"ctime":1645016386,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1121758,"avatar":"https://static001.geekbang.org/account/avatar/00/11/1d/de/62bfa83f.jpg","nickname":"aoe","note":"","ucode":"1C6201EDB4E954","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":256218,"discussion_content":"å¤šè°¢å¤§ä½¬ï¼","likes_number":1,"is_delete":false,"is_hidden":false,"ctime":1588440550,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":215615,"user_name":"suke","can_delete":false,"product_type":"c1","uid":1007753,"ip_address":"","ucode":"C0287C31A4F45B","user_header":"","comment_is_top":false,"comment_ctime":1589033036,"is_pvip":false,"replies":[{"id":"79941","content":"MySQLçš„binlogã€undologã€redologç›®çš„éƒ½ä¸æ˜¯ä¸ºäº†æå‡å†™å…¥æ€§èƒ½ï¼Œè€Œæ˜¯ç”¨äºæ”¯æ’‘äº‹åŠ¡çš„æŒä¹…æ€§ã€‚å®ƒåœ¨å†™å®Œè¿™äº›logä¹‹åï¼Œè¿˜æ˜¯è¦å»ç£ç›˜ä¸Šéšæœºå†™æ¥æ›´æ–°å­˜å‚¨å¼•æ“ä¸­çš„æ•°æ®ã€‚è¿™äº›logå¹¶æ²¡æœ‰èµ·åˆ°æå‡å†™å…¥æ€§èƒ½çš„ä½œç”¨ã€‚","user_name":"ä½œè€…å›å¤","user_name_real":"æç¥","uid":"1501046","ctime":1589171024,"ip_address":"","comment_id":215615,"utype":1}],"discussion_count":3,"race_medal":0,"score":"70308509772","product_id":100046801,"comment_content":"è€å¸ˆè¿™ä¸ªrocksdbçš„æ›´æ–°æœºåˆ¶å’Œmysqlçš„innodbä¹Ÿå·®ä¸å¤šå‘€ï¼Œmysqlä¹Ÿæ˜¯å…ˆå†™redo-logï¼Œç±»ä¼¼äºwalé¡ºåºå†™æ—¥å¿—ï¼Œç„¶åæ›´æ–°å†…å­˜ï¼Œç„¶åæœ‰å¦å¤–çš„çº¿ç¨‹åˆ·è„é¡µæ•°æ®ï¼Œä¸ºå•¥rocksdbæ€§èƒ½å°±è¿™ä¹ˆé«˜","like_count":16,"discussions":[{"author":{"id":1501046,"avatar":"https://static001.geekbang.org/account/avatar/00/16/e7/76/79c1f23a.jpg","nickname":"æç¥","note":"","ucode":"B19E91EE248591","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":494498,"discussion_content":"MySQLçš„binlogã€undologã€redologç›®çš„éƒ½ä¸æ˜¯ä¸ºäº†æå‡å†™å…¥æ€§èƒ½ï¼Œè€Œæ˜¯ç”¨äºæ”¯æ’‘äº‹åŠ¡çš„æŒä¹…æ€§ã€‚å®ƒåœ¨å†™å®Œè¿™äº›logä¹‹åï¼Œè¿˜æ˜¯è¦å»ç£ç›˜ä¸Šéšæœºå†™æ¥æ›´æ–°å­˜å‚¨å¼•æ“ä¸­çš„æ•°æ®ã€‚è¿™äº›logå¹¶æ²¡æœ‰èµ·åˆ°æå‡å†™å…¥æ€§èƒ½çš„ä½œç”¨ã€‚","likes_number":1,"is_delete":false,"is_hidden":false,"ctime":1589171024,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1189225,"avatar":"http://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTIlRVTQ1mpTLY34BAje4xRY0PFSJk6J1su2jicrtEQASP3DakQ7lQkWZNADoh8mLibwATLJB9EMrIVQ/132","nickname":"Z","note":"","ucode":"C199B14177A951","race_medal":0,"user_type":1,"is_pvip":true},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":339592,"discussion_content":"å­˜å‚¨å¼•æ“çš„æ•°æ®æ˜¯åå°å¼‚æ­¥å»æ›´æ–°ï¼Œä¹Ÿå°±æ˜¯åˆ·è„ï¼Œåº”è¯¥ä¸ä¼šå ç”¨å¤ªå¤šæ€§èƒ½å•Š","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1609743165,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":1,"child_discussions":[{"author":{"id":1886331,"avatar":"https://static001.geekbang.org/account/avatar/00/1c/c8/7b/153181d7.jpg","nickname":"å¤œè¾‰","note":"","ucode":"9421385F51FF9E","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":1189225,"avatar":"http://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTIlRVTQ1mpTLY34BAje4xRY0PFSJk6J1su2jicrtEQASP3DakQ7lQkWZNADoh8mLibwATLJB9EMrIVQ/132","nickname":"Z","note":"","ucode":"C199B14177A951","race_medal":0,"user_type":1,"is_pvip":true},"discussion":{"id":366590,"discussion_content":"æŒ‰pageåˆ·ï¼Œä¹Ÿæœ‰ä¸€éƒ¨åˆ†éšæœºå†™è½¬åŒ–ä¸ºé¡ºåºå†™çš„æ€æƒ³","likes_number":1,"is_delete":false,"is_hidden":false,"ctime":1618128488,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":339592,"ip_address":""},"score":366590,"extra":""}]}]},{"had_liked":false,"id":212627,"user_name":"seg-ä¸Šæµ·","can_delete":false,"product_type":"c1","uid":1760320,"ip_address":"","ucode":"46BA8DCB06ED5E","user_header":"http://thirdwx.qlogo.cn/mmopen/vi_32/ajNVdqHZLLBllicLBj61g1ibmCeWzLYpQYEteTOtAAAypoIg6CD19ibXQBbM09VsME9Ta1G8ubwk0ibjiacItavibaeg/132","comment_is_top":false,"comment_ctime":1588165722,"is_pvip":false,"replies":[{"id":"79192","content":"1. å¯¹äºç»å¸¸æ›´æ–°çš„Keyï¼Œå®ƒå¤§æ¦‚ç‡åœ¨å†…å­˜ä¸­ï¼Œè¿™ä¸ªä¸ç”¨å¤šè¯´ï¼›<br>2. å¯¹äºç»å¸¸è¯»çš„Keyï¼Œå†…å­˜ä¸­ä¹Ÿä¼šè¿›è¡Œç¼“å­˜ã€‚","user_name":"ä½œè€…å›å¤","user_name_real":"æç¥","uid":"1501046","ctime":1588513668,"ip_address":"","comment_id":212627,"utype":1}],"discussion_count":4,"race_medal":0,"score":"57422740570","product_id":100046801,"comment_content":"è€å¸ˆï¼Œâ€œè¶Šæ˜¯è¢«ç»å¸¸è¯»å†™çš„çƒ­æ•°æ®ï¼Œå®ƒåœ¨è¿™ä¸ªåˆ†å±‚ç»“æ„ä¸­å°±è¶Šé ä¸Šï¼Œå¯¹è¿™æ ·çš„ Key æŸ¥æ‰¾å°±è¶Šå¿«â€œï¼Œè¿™ä¸ªæ˜¯æ€ä¹ˆä¿è¯çš„å‘¢ï¼Œä¸Šä¸€å±‚æ»¡äº†ä¸å°±è‡ªåŠ¨åˆå¹¶å¹¶æ’åºå†™åˆ°ä¸‹ä¸€å±‚äº†ï¼Œçƒ­ç‚¹æ•°æ®æ˜¯æ€ä¹ˆè¿˜ç•™åœ¨ä¸Šå±‚çš„å‘¢ï¼Ÿ<br>","like_count":13,"discussions":[{"author":{"id":1501046,"avatar":"https://static001.geekbang.org/account/avatar/00/16/e7/76/79c1f23a.jpg","nickname":"æç¥","note":"","ucode":"B19E91EE248591","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":493567,"discussion_content":"1. å¯¹äºç»å¸¸æ›´æ–°çš„Keyï¼Œå®ƒå¤§æ¦‚ç‡åœ¨å†…å­˜ä¸­ï¼Œè¿™ä¸ªä¸ç”¨å¤šè¯´ï¼›\n2. å¯¹äºç»å¸¸è¯»çš„Keyï¼Œå†…å­˜ä¸­ä¹Ÿä¼šè¿›è¡Œç¼“å­˜ã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1588513668,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1886331,"avatar":"https://static001.geekbang.org/account/avatar/00/1c/c8/7b/153181d7.jpg","nickname":"å¤œè¾‰","note":"","ucode":"9421385F51FF9E","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":366592,"discussion_content":"åœ¨Diskä¸­ï¼Œç›¸åŒkeyçš„æ–°ç‰ˆæœ¬çš„å€¼ä¼šåœ¨ä¸Šå±‚","likes_number":1,"is_delete":false,"is_hidden":false,"ctime":1618128599,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1781837,"avatar":"https://static001.geekbang.org/account/avatar/00/1b/30/4d/75001e34.jpg","nickname":"ç«¹å’–å•¡","note":"","ucode":"CC03B1079AB774","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":328983,"discussion_content":"æˆ‘æƒ³åº”è¯¥å’ŒLRUé˜Ÿåˆ—çš„åŸç†æ˜¯ä¸€æ ·çš„","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1606291626,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1744873,"avatar":"","nickname":"åŒ—ç ”","note":"","ucode":"70BD1C6D6B766B","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":303580,"discussion_content":"è¿™ç§å¯¹ç»å¸¸ç”¨åˆ°çš„keyæ— ç–‘æ˜¯éå¸¸å‹å¥½çš„ï¼ŒåŒæ—¶é’ˆå¯¹ä¸€äº›ä¸å¸¸æ‰§è¡Œä½†æ˜¯ä¼šéå†çš„keyè¾ƒå¤šçš„æƒ…å†µæ˜¯ä¸æ˜¯å°±æ¯”è¾ƒéš¾å—äº†ã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1599305746,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":208722,"user_name":"ä¸€æ­¥","can_delete":false,"product_type":"c1","uid":1005391,"ip_address":"","ucode":"73CEA468CE70C3","user_header":"https://static001.geekbang.org/account/avatar/00/0f/57/4f/6fb51ff1.jpg","comment_is_top":false,"comment_ctime":1587427977,"is_pvip":true,"replies":[{"id":"78322","content":"æ˜¯çš„ï¼ŒåŸºäºLSM-Treeçš„å­˜å‚¨ç³»ç»Ÿéƒ½éš¾å…ä¼šé‡åˆ°å†™æ”¾å¤§çš„é—®é¢˜ã€‚","user_name":"ä½œè€…å›å¤","user_name_real":"æç¥","uid":"1501046","ctime":1587691498,"ip_address":"","comment_id":208722,"utype":1}],"discussion_count":1,"race_medal":0,"score":"35947166345","product_id":100046801,"comment_content":"LSM-Tree åˆ é™¤æ•°æ®ï¼šåœ¨æ¯æ¡æ•°æ®ä¸Šå¢åŠ ä¸€ä¸ªåˆ é™¤çš„æ ‡å¿—ä½ï¼ŒæŸ¥è¯¢çš„æ—¶å€™åˆ¤æ–­æ˜¯å¦å·²ç»åˆ é™¤ï¼Œè½ç›˜çš„æ—¶å€™æ ¹æ®åˆ é™¤æ ‡å¿—ä½åˆå¹¶æ•°æ®ï¼Œä½†æ˜¯è¿™æ ·ä¼šæµªè´¹ä¸€äº›ç©ºé—´èµ„æº<br>","like_count":8,"discussions":[{"author":{"id":1501046,"avatar":"https://static001.geekbang.org/account/avatar/00/16/e7/76/79c1f23a.jpg","nickname":"æç¥","note":"","ucode":"B19E91EE248591","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":492592,"discussion_content":"æ˜¯çš„ï¼ŒåŸºäºLSM-Treeçš„å­˜å‚¨ç³»ç»Ÿéƒ½éš¾å…ä¼šé‡åˆ°å†™æ”¾å¤§çš„é—®é¢˜ã€‚","likes_number":1,"is_delete":false,"is_hidden":false,"ctime":1587691498,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":208913,"user_name":"ä¸å°æ˜","can_delete":false,"product_type":"c1","uid":1207622,"ip_address":"","ucode":"CC23857B8D75D5","user_header":"https://static001.geekbang.org/account/avatar/00/12/6d/46/e16291f8.jpg","comment_is_top":false,"comment_ctime":1587464096,"is_pvip":false,"replies":[{"id":"78318","content":"æ˜¯çš„ï¼ŒLevel 0 æ˜¯æ— åºçš„ï¼Œæ‰€ä»¥ä¸€èˆ¬Levelåªä¿å­˜å¾ˆå°‘çš„å‡ ä¸ªæ–‡ä»¶ã€‚Level 0çš„æŸ¥æ‰¾é¡ºåºå°±æ˜¯æŒ‰ç…§æ–‡ä»¶çš„åˆ›å»ºé¡ºåºå€’åºæŸ¥æ‰¾ï¼Œä¹Ÿå°±æ˜¯ä»æœ€æ–°çš„å‘æœ€æ—§çš„æŸ¥æ‰¾ã€‚","user_name":"ä½œè€…å›å¤","user_name_real":"æç¥","uid":"1501046","ctime":1587691290,"ip_address":"","comment_id":208913,"utype":1}],"discussion_count":1,"race_medal":0,"score":"27357267872","product_id":100046801,"comment_content":"ä¸çŸ¥é“æˆ‘ç†è§£çš„å¯¹ä¸å¯¹ï¼Œä¹Ÿå°±æ˜¯è¯´keyåœ¨å­˜å‚¨é‡Œé¢æ˜¯æœ‰å¯èƒ½æœ‰å¤šä»½çš„ï¼ŸæŸ¥è¯¢çš„è¿‡ç¨‹æ˜¯æŒ‰ç…§é¡ºåºä»ä¸€ä¸ªä¸€ä¸ªtableä¸­å»æŸ¥è¯¢ï¼Œå…ˆæŸ¥å†…å­˜åæŸ¥ç£ç›˜ï¼Œä½†æ˜¯level0ä¸æ˜¯æ— åºçš„ä¹ˆï¼Œæ€ä¹ˆç¡®å®šæŸ¥æ‰¾é¡ºåºå‘¢","like_count":6,"discussions":[{"author":{"id":1501046,"avatar":"https://static001.geekbang.org/account/avatar/00/16/e7/76/79c1f23a.jpg","nickname":"æç¥","note":"","ucode":"B19E91EE248591","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":492670,"discussion_content":"æ˜¯çš„ï¼ŒLevel 0 æ˜¯æ— åºçš„ï¼Œæ‰€ä»¥ä¸€èˆ¬Levelåªä¿å­˜å¾ˆå°‘çš„å‡ ä¸ªæ–‡ä»¶ã€‚Level 0çš„æŸ¥æ‰¾é¡ºåºå°±æ˜¯æŒ‰ç…§æ–‡ä»¶çš„åˆ›å»ºé¡ºåºå€’åºæŸ¥æ‰¾ï¼Œä¹Ÿå°±æ˜¯ä»æœ€æ–°çš„å‘æœ€æ—§çš„æŸ¥æ‰¾ã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1587691290,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":212608,"user_name":"seg-ä¸Šæµ·","can_delete":false,"product_type":"c1","uid":1760320,"ip_address":"","ucode":"46BA8DCB06ED5E","user_header":"http://thirdwx.qlogo.cn/mmopen/vi_32/ajNVdqHZLLBllicLBj61g1ibmCeWzLYpQYEteTOtAAAypoIg6CD19ibXQBbM09VsME9Ta1G8ubwk0ibjiacItavibaeg/132","comment_is_top":false,"comment_ctime":1588162841,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"23062999321","product_id":100046801,"comment_content":"HBase ä¹Ÿæ˜¯ç”¨äº†LSM-Tree,åšåˆ°åœ¨æµ·é‡æ•°æ®æ—¶ï¼Œéå¸¸å¥½çš„å†™æ€§èƒ½ï¼Œè€Œhbaseè¯»çš„æ—¶å€™éœ€è¦å»regionä¸­æ‹¼æ¥æ‰€æœ‰çš„storeFileï¼Œæ‰€ä»¥ä»–çš„è¯»æ¯”å†™çš„æ€§èƒ½è¦å·®äº›","like_count":5},{"had_liked":false,"id":229908,"user_name":"zhang","can_delete":false,"product_type":"c1","uid":1517047,"ip_address":"","ucode":"650C292030057B","user_header":"https://static001.geekbang.org/account/avatar/00/17/25/f7/4cc60573.jpg","comment_is_top":false,"comment_ctime":1593184784,"is_pvip":false,"replies":[{"id":"84982","content":"å¦‚æœå¯¹è±¡å¤ªå¤šï¼Œé€šå¸¸çš„åšæ³•æ˜¯ï¼Œå®šä¹‰è‹¥å¹²åˆ†ç‰‡ï¼ŒæŠŠæ‰€æœ‰çš„å¯¹è±¡æŒ‰ç…§ä¸€å®šçš„è§„åˆ™æ”¾åˆ°åˆ°åˆ†ç‰‡ï¼ˆè¿™ä¸ªåˆ†ç‰‡æ˜¯æ•°æ®å¤åˆ¶çš„åŸºæœ¬å•ä½ï¼Œä¹Ÿå¯ä»¥ç†è§£ä¸ºå­˜æ”¾ä¸€å †å¯¹è±¡çš„å®¹å™¨ï¼‰ä¸­ã€‚<br><br>åƒRediså°±æ˜¯æŠŠæ‰€æœ‰çš„Keyå“ˆå¸Œåˆ°16384ä¸ªæ§½ä¸­ï¼Œå…ƒæ•°æ®åªè®°å½•æ¯ä¸ªæ§½çš„ä¿¡æ¯ï¼Œè¿™æ ·æ— è®ºå­˜æ”¾å¤šå°‘ä¸ªKeyï¼Œå…ƒæ•°æ®éƒ½åªæœ‰8KBã€‚<br><br>ä½ ä¹Ÿå¯ä»¥å‚è€ƒä¸€ä¸‹ã€Š18 | åˆ†å¸ƒå¼å­˜å‚¨ï¼šä½ çŸ¥é“å¯¹è±¡å­˜å‚¨æ˜¯å¦‚ä½•ä¿å­˜å›¾ç‰‡æ–‡ä»¶çš„å—ï¼Ÿã€‹ä¸­æˆ‘ä»¬è®²çš„â€œå¯¹è±¡æ˜¯å¦‚ä½•æ‹†åˆ†å’Œä¿å­˜çš„ï¼Ÿâ€è¿™ä¸€èŠ‚çš„å†…å®¹ã€‚åŸç†æ˜¯ä¸€æ ·çš„ã€‚<br><br>","user_name":"ä½œè€…å›å¤","user_name_real":"æç¥","uid":"1501046","ctime":1593311747,"ip_address":"","comment_id":229908,"utype":1}],"discussion_count":4,"race_medal":0,"score":"18773053968","product_id":100046801,"comment_content":"è€å¸ˆï¼Œä¹‹å‰ç ”ç©¶ä¸€äº›ç”¨B+æ•°è¿›è¡Œå…ƒæ•°æ®çš„å­˜å‚¨ç³»ç»Ÿæ—¶æœ‰è¿™æ ·ä¸€ä¸ªç–‘æƒ‘ã€‚ PSæˆ‘æ˜¯æCDNçš„ï¼Œå­˜å‚¨ç³»ç»Ÿçš„ç£ç›˜å®¹é‡æ¯”è¾ƒå¤§ï¼Œå¤§çº¦æ˜¯60Tä»¥ä¸Šã€‚<br><br>å‡è®¾ä¸€ä¸ªå¯¹è±¡çš„å¹³å‡å¤§å°æ˜¯100K, å°çš„10å‡ k,å¤§çš„é€šå¸¸ä¸è¶…è¿‡1M ï¼ˆè¶…è¿‡ä¼šåˆ†ç‰‡å¤„ç†ï¼‰ï¼Œä¹Ÿå°±æ„å‘³ç€å…ƒä¿¡æ¯æ€»ä¸ªæ•°æ˜¯10x60Mä¸ªï¼Œæ¯ä¸ªå…ƒä¿¡æ¯å¤§çº¦æ˜¯64ä¸ªå­—èŠ‚ã€‚å·²å°±æ„å‘³ç€è¿™é¢—B+æ ‘æœ€å°ä¹Ÿçš„30Gçš„å†…å­˜ã€‚<br><br>ç»´æŠ¤ä¸€é¢—å…ƒæ•°æ®çš„B+æ ‘å°±éœ€è¦30Gçš„å†…å­˜ï¼Œè¿™ä¸ªå¼€é”€å®åœ¨å¤ªå¤§äº†ã€‚ è¯·é—®åœ¨å®é™…çš„æ•°æ®åº“ä¸­æ˜¯å¦ä¹Ÿæ˜¯å°†æ•´é¢—B+æ ‘ç»´æŠ¤åœ¨å†…å­˜ä¸­å—ï¼Ÿ å¦‚æœä¸æ˜¯ï¼Œé‚£ä¹ˆå®ƒæ˜¯æ€ä¹ˆä¿®æ”¹çš„å‘¢ï¼Ÿ","like_count":4,"discussions":[{"author":{"id":1501046,"avatar":"https://static001.geekbang.org/account/avatar/00/16/e7/76/79c1f23a.jpg","nickname":"æç¥","note":"","ucode":"B19E91EE248591","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":499691,"discussion_content":"å¦‚æœå¯¹è±¡å¤ªå¤šï¼Œé€šå¸¸çš„åšæ³•æ˜¯ï¼Œå®šä¹‰è‹¥å¹²åˆ†ç‰‡ï¼ŒæŠŠæ‰€æœ‰çš„å¯¹è±¡æŒ‰ç…§ä¸€å®šçš„è§„åˆ™æ”¾åˆ°åˆ°åˆ†ç‰‡ï¼ˆè¿™ä¸ªåˆ†ç‰‡æ˜¯æ•°æ®å¤åˆ¶çš„åŸºæœ¬å•ä½ï¼Œä¹Ÿå¯ä»¥ç†è§£ä¸ºå­˜æ”¾ä¸€å †å¯¹è±¡çš„å®¹å™¨ï¼‰ä¸­ã€‚\n\nåƒRediså°±æ˜¯æŠŠæ‰€æœ‰çš„Keyå“ˆå¸Œåˆ°16384ä¸ªæ§½ä¸­ï¼Œå…ƒæ•°æ®åªè®°å½•æ¯ä¸ªæ§½çš„ä¿¡æ¯ï¼Œè¿™æ ·æ— è®ºå­˜æ”¾å¤šå°‘ä¸ªKeyï¼Œå…ƒæ•°æ®éƒ½åªæœ‰8KBã€‚\n\nä½ ä¹Ÿå¯ä»¥å‚è€ƒä¸€ä¸‹ã€Š18 | åˆ†å¸ƒå¼å­˜å‚¨ï¼šä½ çŸ¥é“å¯¹è±¡å­˜å‚¨æ˜¯å¦‚ä½•ä¿å­˜å›¾ç‰‡æ–‡ä»¶çš„å—ï¼Ÿã€‹ä¸­æˆ‘ä»¬è®²çš„â€œå¯¹è±¡æ˜¯å¦‚ä½•æ‹†åˆ†å’Œä¿å­˜çš„ï¼Ÿâ€è¿™ä¸€èŠ‚çš„å†…å®¹ã€‚åŸç†æ˜¯ä¸€æ ·çš„ã€‚\n\n","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1593311747,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1886331,"avatar":"https://static001.geekbang.org/account/avatar/00/1c/c8/7b/153181d7.jpg","nickname":"å¤œè¾‰","note":"","ucode":"9421385F51FF9E","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":366595,"discussion_content":"è¯·é—®è¿™ä¸ªå…ƒä¿¡æ¯æ€»ä¸ªæ•°æ˜¯å¦‚ä½•è®¡ç®—å‡ºæ¥çš„ï¼Ÿ","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1618128884,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1886331,"avatar":"https://static001.geekbang.org/account/avatar/00/1c/c8/7b/153181d7.jpg","nickname":"å¤œè¾‰","note":"","ucode":"9421385F51FF9E","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":366594,"discussion_content":"bitset","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1618128819,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1517047,"avatar":"https://static001.geekbang.org/account/avatar/00/17/25/f7/4cc60573.jpg","nickname":"zhang","note":"","ucode":"650C292030057B","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":286857,"discussion_content":"å¥½çš„ï¼Œè°¢è°¢è€å¸ˆï¼Œè€å¸ˆæœ‰ä»€ä¹ˆäº¤æµç¾¤å—ï¼Œåç»­å‘è€å¸ˆè¯·æ•™ä¹Ÿæ–¹ä¾¿ç‚¹ã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1593311840,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":221194,"user_name":"yhh","can_delete":false,"product_type":"c1","uid":1105102,"ip_address":"","ucode":"B566981788B6A2","user_header":"https://static001.geekbang.org/account/avatar/00/10/dc/ce/a144dea1.jpg","comment_is_top":false,"comment_ctime":1590422487,"is_pvip":false,"replies":[{"id":"81728","content":"æ˜¯è¿™æ ·çš„ã€‚<br>","user_name":"ä½œè€…å›å¤","user_name_real":"æç¥","uid":"1501046","ctime":1590559226,"ip_address":"","comment_id":221194,"utype":1}],"discussion_count":1,"race_medal":0,"score":"18770291671","product_id":100046801,"comment_content":"walï¼Œé™¤éæ¯å†™ä¸€æ¬¡æ“ä½œæ—¥å¿—éƒ½åˆ·ç›˜ï¼Œä¸ç„¶åº”è¯¥ä¹Ÿæ˜¯ä¼šå­˜åœ¨ä¸¢æ•°æ®çš„å¯èƒ½æ€§å§ï¼Ÿ","like_count":4,"discussions":[{"author":{"id":1501046,"avatar":"https://static001.geekbang.org/account/avatar/00/16/e7/76/79c1f23a.jpg","nickname":"æç¥","note":"","ucode":"B19E91EE248591","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":496377,"discussion_content":"æ˜¯è¿™æ ·çš„ã€‚\n","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1590559226,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":208302,"user_name":"leslie","can_delete":false,"product_type":"c1","uid":1324255,"ip_address":"","ucode":"798E7C1CC98CC2","user_header":"https://static001.geekbang.org/account/avatar/00/14/34/df/64e3d533.jpg","comment_is_top":false,"comment_ctime":1587333472,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"10177268064","product_id":100046801,"comment_content":"RMDBçš„ç“¶é¢ˆå…¶å®å¼•å‘äº†è¶Šæ¥è¶Šçš„å…³äºæ•°æ®ç³»ç»Ÿçš„ç ”ç©¶ï¼Œè€ç‰ŒRMDBæ•°æ®åº“ä¹‹å¤–ç°åœ¨æ˜¯ç™¾èŠ±é½æ”¾ï¼Œè®¸å¤šæ—¶å€™åœ¨é€‰å‹æ–¹é¢çœ‹ä¼¼ç®€å•å…¶å®å·²ç»è¶Šæ¥è¶Šéš¾ä»¥ç²¾å‡†å®šä½å»é€‰æ‹©ã€‚<br>åˆç†çš„é€‰æ‹©æ‰èƒ½çœŸæ­£çš„å‘æŒ¥DBçš„ä½œç”¨ï¼Œè¿™ç§åˆç†æ€§ç¡®å®è¶Šæ¥è¶Šéš¾ä»¥è½»æ˜“å®ç°ï¼›æœ‰æ—¶è§‰å¾—è¿™ä¸ªå’Œç§æœ‰äº‘&#47;å…¬æœ‰äº‘æ¶æ„ä¸€æ ·ï¼Œä¸Šäº‘çœ‹ä¼¼å®¹æ˜“ï¼Œå¯æ˜¯å¦‚ä½•åˆç†çš„é€‰æ‹©å„ç§ç›¸åº”çš„ç»„ä»¶å´å¹¶éæ˜“äº‹ã€‚<br>å…³äºRockDBçš„åˆ é™¤æ“ä½œå…¶å®æ ¹æ®è€å¸ˆè¯´å…¶å†™å…¥æœºåˆ¶æ—¶å°±å·²ç»è¯´å‡ºäº†ç­”æ¡ˆï¼Œå†™å’Œåˆ æ˜¯ä¸€å¯¹é€†æ“ä½œï¼›å…¶çœŸæ­£çš„åˆ›æ–°è¿˜æ˜¯åŸºäºLSM-Treeï¼Œæ€è·¯æ–¹é¢èåˆäº†MQçš„æ€æƒ³-ç¡®å®ä¸ä¸€æ ·ã€‚<br>è°¢è°¢è€å¸ˆä»Šå¤©çš„åˆ†äº«ï¼ŒæœŸå¾…åç»­çš„è¯¾ç¨‹ã€‚","like_count":2},{"had_liked":false,"id":208779,"user_name":"haijian.yang","can_delete":false,"product_type":"c1","uid":1162081,"ip_address":"","ucode":"E3D13ABA2CA347","user_header":"https://static001.geekbang.org/account/avatar/00/11/bb/61/2c2f5024.jpg","comment_is_top":false,"comment_ctime":1587437394,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"5882404690","product_id":100046801,"comment_content":"NewSQL å·²æ¥","like_count":1},{"had_liked":false,"id":208717,"user_name":"æ­¤æ–¹å½¼æ–¹Francis","can_delete":false,"product_type":"c1","uid":1001390,"ip_address":"","ucode":"73E6C93CF1FE39","user_header":"https://static001.geekbang.org/account/avatar/00/0f/47/ae/0a5f7a56.jpg","comment_is_top":false,"comment_ctime":1587427331,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"5882394627","product_id":100046801,"comment_content":"LSMçš„ç”¨å¤„çœŸå¹¿ æ„Ÿè§‰å“ªå„¿å“ªå„¿éƒ½ç”¨å®ƒçš„å½±å­","like_count":1},{"had_liked":false,"id":353701,"user_name":"æ—æ½‡","can_delete":false,"product_type":"c1","uid":1182886,"ip_address":"å¹¿ä¸œ","ucode":"8B204A3986363C","user_header":"https://static001.geekbang.org/account/avatar/00/12/0c/a6/f2d8b68e.jpg","comment_is_top":false,"comment_ctime":1659688367,"is_pvip":true,"discussion_count":0,"race_medal":0,"score":"1659688367","product_id":100046801,"comment_content":"å¦‚æœæˆ‘çš„åº”ç”¨é™¤äº†å­˜å‚¨ä»¥å¤–ï¼Œè¿˜éœ€è¦è¿›è¡Œæ£€ç´¢è¿˜èƒ½ç”¨rocksdbå—ï¼Ÿ<br>è¿™æ˜¯æˆ‘çš„å®é™…åº”ç”¨ï¼Œæˆ‘éœ€è¦å­˜å‚¨nginxçš„è¯·æ±‚æ—¥å¿—ï¼ŒåŒæ—¶ä¹Ÿè¦å¯¹æ—¥å¿—è¿›è¡Œæ£€ç´¢ï¼Œæ¯”å¦‚é€šè¿‡å®¢æˆ·ç«¯IPã€URLã€è¯·æ±‚æ–¹å¼ã€‚æˆ‘çš„åˆæ­¥æ–¹æ¡ˆæ˜¯ç”¨æ—¶é—´ä½œä¸ºKeyï¼Œä½†æ˜¯æˆ‘åŒæ—¶è¦æ”¯æŒå…¶ä»–æ¡ä»¶æ£€ç´¢çš„è¯ï¼Œæ¯æ¬¡éœ€è¦å¯¹æ—¶é—´åŒºé—´å†…çš„æ‰€æœ‰è®°å½•Valueè¿›è¡Œå­—ç¬¦åŒ¹é…ï¼Ÿå‡è®¾é¢å¯¹è¦åˆ†é¡µè¯¥æ€ä¹ˆåŠå‘¢ï¼Ÿ","like_count":0},{"had_liked":false,"id":339584,"user_name":"î„›æ—‹é£","can_delete":false,"product_type":"c1","uid":1272591,"ip_address":"","ucode":"B9FF02969F4307","user_header":"https://static001.geekbang.org/account/avatar/00/13/6b/0f/293b999c.jpg","comment_is_top":false,"comment_ctime":1648201833,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1648201833","product_id":100046801,"comment_content":"kvrocks å’Œ RocksDBï¼Œæœ‰ä»€ä¹ˆåŒºåˆ«ï¼Œéƒ½æ˜¯kvå­˜å‚¨ï¼Œåªæ˜¯ä¸ºäº†å…¼å®¹redisåè®®å—","like_count":0},{"had_liked":false,"id":239574,"user_name":"Monday","can_delete":false,"product_type":"c1","uid":1250907,"ip_address":"","ucode":"77B9BACC783598","user_header":"https://static001.geekbang.org/account/avatar/00/13/16/5b/83a35681.jpg","comment_is_top":false,"comment_ctime":1596590855,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1596590855","product_id":100046801,"comment_content":"ä¸€ä¸ªæ˜ŸæœŸæ’¸å®Œç¬¬ä¸€éï¼Œå¯¹ç°åœ¨çš„ä»»åŠ¡ï¼ˆåˆ†è¡¨ï¼‰æœ‰ç°å®æ€§å‚è€ƒæ„ä¹‰ã€‚æ„Ÿè°¢","like_count":0},{"had_liked":false,"id":228595,"user_name":"Dylan","can_delete":false,"product_type":"c1","uid":1040236,"ip_address":"","ucode":"58064D0C9F9F5F","user_header":"https://static001.geekbang.org/account/avatar/00/0f/df/6c/5af32271.jpg","comment_is_top":false,"comment_ctime":1592746584,"is_pvip":false,"replies":[{"id":"84527","content":"å¸Œæœ›ä½ èƒ½æœ‰æ‰€æ”¶è·","user_name":"ä½œè€…å›å¤","user_name_real":"æç¥","uid":"1501046","ctime":1592916876,"ip_address":"","comment_id":228595,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1592746584","product_id":100046801,"comment_content":"è¿™ç¯‡æ–‡ç« æ‰æ”¶è·æœ€å¤šçš„ä¸€ç¯‡æ–‡ç« ä¹‹ä¸€ï½è€å¸ˆåº”è¯¥å†å¤šåŠ å‡ ç¯‡ç±»ä¼¼çš„æ–‡ç« çš„ï¼Œè¿˜æ²¡çœ‹å¤Ÿï½","like_count":0,"discussions":[{"author":{"id":1501046,"avatar":"https://static001.geekbang.org/account/avatar/00/16/e7/76/79c1f23a.jpg","nickname":"æç¥","note":"","ucode":"B19E91EE248591","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":499096,"discussion_content":"å¸Œæœ›ä½ èƒ½æœ‰æ‰€æ”¶è·","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1592916876,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":222348,"user_name":"å¤œè¡Œè§‚æ˜Ÿ","can_delete":false,"product_type":"c1","uid":1010389,"ip_address":"","ucode":"C880CB39033929","user_header":"https://static001.geekbang.org/account/avatar/00/0f/6a/d5/73c75eb3.jpg","comment_is_top":false,"comment_ctime":1590756203,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1590756203","product_id":100046801,"comment_content":"LSM-treeä¸æ˜¯ç›´æ¥åˆ é™¤æ•°æ®ï¼Œå…ˆåœ¨memtableä¸­æ‰“ä¸ªæ ‡è®°ï¼Œä¹‹ååˆå¹¶çš„æ—¶å€™å†æŠŠæ•°æ®åˆ é™¤ã€‚","like_count":0},{"had_liked":false,"id":208701,"user_name":"icyricky","can_delete":false,"product_type":"c1","uid":1302556,"ip_address":"","ucode":"D63C285165309D","user_header":"https://static001.geekbang.org/account/avatar/00/13/e0/1c/aa50dc27.jpg","comment_is_top":false,"comment_ctime":1587417131,"is_pvip":false,"replies":[{"id":"78334","content":"æ˜¯è¿™æ ·çš„","user_name":"ä½œè€…å›å¤","user_name_real":"æç¥","uid":"1501046","ctime":1587694845,"ip_address":"","comment_id":208701,"utype":1}],"discussion_count":2,"race_medal":0,"score":"1587417131","product_id":100046801,"comment_content":"åº”è¯¥æ˜¯å’ŒTiKVç±»ä¼¼ï¼Œåˆ é™¤çš„æ•°æ®å¢åŠ ä¸€ä¸ªæ–°çš„åˆ é™¤ç‰ˆæœ¬ï¼Œç­‰çœŸæ­£ä¸ç”¨çš„æ—¶å€™ ï¼Œåˆå¹¶SSTåˆ é™¤å§ã€‚ã€‚","like_count":0,"discussions":[{"author":{"id":1501046,"avatar":"https://static001.geekbang.org/account/avatar/00/16/e7/76/79c1f23a.jpg","nickname":"æç¥","note":"","ucode":"B19E91EE248591","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":492584,"discussion_content":"æ˜¯è¿™æ ·çš„","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1587694845,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1211987,"avatar":"https://static001.geekbang.org/account/avatar/00/12/7e/53/c29c2fc9.jpg","nickname":"sdjdd","note":"","ucode":"512F2338DFF793","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":241723,"discussion_content":"TiKV åº•å±‚ä¹Ÿæ˜¯ç”¨çš„ RocksDB","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1587435515,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]}]}