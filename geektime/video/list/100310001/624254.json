{"id":624254,"title":"94｜理论盘点：文件类型与对应的 Python 函数库","content":"<p><strong>课后习题</strong><br>\n请你编写程序，将 Excel 文件的第一张表格中的内容存储到 docx 文件中。</p><p><strong>课程代码、课件及其他相关资料地址</strong><br>\n<a href=\"https://gitee.com/wilsonyin/zero-basics-python\">https://gitee.com/wilsonyin/zero-basics-python</a></p>","comments":[{"had_liked":false,"id":376175,"user_name":"lums","can_delete":false,"product_type":"c3","uid":2858905,"ip_address":"湖北","ucode":"C6BA8D2477012F","user_header":"https://static001.geekbang.org/account/avatar/00/2b/9f/99/0f701e32.jpg","comment_is_top":false,"comment_ctime":1686450064,"is_pvip":false,"replies":[{"id":137576,"content":"我提供一个代码样例：\n\nfrom docx import Document\nfrom openpyxl import load_workbook\n\n# 加载Excel文件\nWorkbook1 = load_workbook(&quot;import.xlsx&quot;, data_only=True)\nwb_sheet_actived = Workbook1[&#39;Sheet1&#39;]\n\n# 创建docx文档\ndocument = Document()\ntable = document.add_table(rows=0, cols=wb_sheet_actived.max_column)\ntable.style = &#39;Table Grid&#39;\n\n# 获取合并单元格的信息\nmerged_cells_ranges = wb_sheet_actived.merged_cells.ranges\n\n# 遍历Excel表格的行\nfor row_cells in wb_sheet_actived.rows:\n    table_cells = table.add_row().cells\n    i = 0\n\n    # 遍历每行的单元格\n    for cell in row_cells:\n        cell_value = &quot;&quot;\n\n        # 判断单元格是否属于合并单元格\n        for merged_range in merged_cells_ranges:\n            if cell.coordinate in merged_range:\n                # 获取合并单元格的首个单元格的值\n                cell_value = merged_range.start_cell.value\n                break\n\n        # 如果单元格不属于合并单元格，则获取单元格的值\n        if not cell_value:\n            cell_value = str(cell.value) if cell.value is not None else &quot;&quot;\n\n        # 将值写入到docx表格的单元格中\n        table_cells[i].text = cell_value\n        i += 1\n\n# 保存docx文件\ndocument.save(&#39;export.docx&#39;)\n\n上述代码使用`openpyxl`库的`merged_cells`属性获取Excel中的合并单元格范围，并检查当前单元格是否在合并范围内，如果在，则获取合并范围的首个单元格的值。\n然后，将单元格的值写入到`docx`文件的表格中，处理合并单元格时替换为合并范围首个单元格的值。\n\nps： 可以在讨论群中和我沟通，留言区问题经常会被打卡信息给淹没，导致问题被忽略，我也是翻查视频才看到的问题","user_name":"作者回复","user_name_real":"编辑","uid":1056235,"ctime":1688723640,"ip_address":"广东","comment_id":376175,"utype":1}],"discussion_count":1,"race_medal":0,"score":2,"product_id":100310001,"comment_content":"from docx import Document\nfrom openpyxl import Workbook,load_workbook\n\n\nWorkbook1=load_workbook(&quot;import.xlsx&quot;,data_only=True)\nwb_sheet_actived = Workbook1[&#39;Sheet1&#39;]\n\ndocument = Document()\ntable = document.add_table(rows=0, cols=wb_sheet_actived.max_column)\ntable.style=&#39;Table Grid&#39;\n\n\nfor row_cells in wb_sheet_actived.rows:\n    table_cells = table.add_row().cells\n    i=0\n    for cell in row_cells:\n        # print(cell.value)\n        # print(type(cell.value))\n        cell_value = str(cell.value) if cell.value is not None else  &quot;&quot;\n        table_cells[i].text = cell_value       \n        i += 1\ndocument.save(&#39;export.docx&#39;)\n\n教师请教一个问题，如果读取的表格中有合并的单元格，如何把它获取出来，并写入到docx文件中呢","like_count":0,"discussions":[{"author":{"id":1056235,"avatar":"https://static001.geekbang.org/account/avatar/00/10/1d/eb/b2123759.jpg","nickname":"尹会生","note":"","ucode":"D1093DBD093617","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":622853,"discussion_content":"我提供一个代码样例：\n\nfrom docx import Document\nfrom openpyxl import load_workbook\n\n# 加载Excel文件\nWorkbook1 = load_workbook(&#34;import.xlsx&#34;, data_only=True)\nwb_sheet_actived = Workbook1[&#39;Sheet1&#39;]\n\n# 创建docx文档\ndocument = Document()\ntable = document.add_table(rows=0, cols=wb_sheet_actived.max_column)\ntable.style = &#39;Table Grid&#39;\n\n# 获取合并单元格的信息\nmerged_cells_ranges = wb_sheet_actived.merged_cells.ranges\n\n# 遍历Excel表格的行\nfor row_cells in wb_sheet_actived.rows:\n    table_cells = table.add_row().cells\n    i = 0\n\n    # 遍历每行的单元格\n    for cell in row_cells:\n        cell_value = &#34;&#34;\n\n        # 判断单元格是否属于合并单元格\n        for merged_range in merged_cells_ranges:\n            if cell.coordinate in merged_range:\n                # 获取合并单元格的首个单元格的值\n                cell_value = merged_range.start_cell.value\n                break\n\n        # 如果单元格不属于合并单元格，则获取单元格的值\n        if not cell_value:\n            cell_value = str(cell.value) if cell.value is not None else &#34;&#34;\n\n        # 将值写入到docx表格的单元格中\n        table_cells[i].text = cell_value\n        i += 1\n\n# 保存docx文件\ndocument.save(&#39;export.docx&#39;)\n\n上述代码使用`openpyxl`库的`merged_cells`属性获取Excel中的合并单元格范围，并检查当前单元格是否在合并范围内，如果在，则获取合并范围的首个单元格的值。\n然后，将单元格的值写入到`docx`文件的表格中，处理合并单元格时替换为合并范围首个单元格的值。\n\nps： 可以在讨论群中和我沟通，留言区问题经常会被打卡信息给淹没，导致问题被忽略，我也是翻查视频才看到的问题","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1688723640,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"广东","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":374194,"user_name":"hwj","can_delete":false,"product_type":"c3","uid":1952147,"ip_address":"北京","ucode":"B225C60879B990","user_header":"https://static001.geekbang.org/account/avatar/00/1d/c9/93/ef42b1c1.jpg","comment_is_top":false,"comment_ctime":1683693706,"is_pvip":false,"replies":[{"id":136999,"content":"import win32com.client as win32\nfrom win32com.client import constants\nimport os\n\ncurr_path = os.getcwd()\ndoc_app = win32.gencache.EnsureDispatch(&#39;Word.Application&#39;)#打开word应用程序\ndoc_app.Visible =1#设置应用程序可见\ndoc = doc_app.Documents.Open(r&#39;%s\\批量插入题注示例文档.docx&#39;%curr_path)#打开文档\n\nprint(doc.InlineShapes.Count)\n# 插入图片题注\nfor pic in doc.InlineShapes:\n\trng = pic.Range\n\trng.InsertCaption(Label= constants.wdCaptionFigure,Position=constants.wdCaptionPositionBelow,Title=&quot;咖啡杯&quot;)\n\n参考链接： https:&#47;&#47;zhuanlan.zhihu.com&#47;p&#47;480345307","user_name":"作者回复","user_name_real":"编辑","uid":1056235,"ctime":1685453396,"ip_address":"广东","comment_id":374194,"utype":1}],"discussion_count":1,"race_medal":0,"score":2,"product_id":100310001,"comment_content":"老师请叫一个问题，如何对word中图片批量添加题注","like_count":0,"discussions":[{"author":{"id":1056235,"avatar":"https://static001.geekbang.org/account/avatar/00/10/1d/eb/b2123759.jpg","nickname":"尹会生","note":"","ucode":"D1093DBD093617","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":619724,"discussion_content":"import win32com.client as win32\nfrom win32com.client import constants\nimport os\n\ncurr_path = os.getcwd()\ndoc_app = win32.gencache.EnsureDispatch(&#39;Word.Application&#39;)#打开word应用程序\ndoc_app.Visible =1#设置应用程序可见\ndoc = doc_app.Documents.Open(r&#39;%s\\批量插入题注示例文档.docx&#39;%curr_path)#打开文档\n\nprint(doc.InlineShapes.Count)\n# 插入图片题注\nfor pic in doc.InlineShapes:\n\trng = pic.Range\n\trng.InsertCaption(Label= constants.wdCaptionFigure,Position=constants.wdCaptionPositionBelow,Title=&#34;咖啡杯&#34;)\n\n参考链接： https://zhuanlan.zhihu.com/p/480345307","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1685453396,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"广东","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":394529,"user_name":"William","can_delete":false,"product_type":"c3","uid":1346215,"ip_address":"吉林","ucode":"55F5D9DEE485B1","user_header":"https://static001.geekbang.org/account/avatar/00/14/8a/a7/674c1864.jpg","comment_is_top":false,"comment_ctime":1727076114,"is_pvip":true,"replies":null,"discussion_count":0,"race_medal":0,"score":2,"product_id":100310001,"comment_content":"读取exel内容， 写入到word中\n\n# pip3 install python-docx\n# pip3 install openpyxl\n\nfrom docx import Document\nfrom openpyxl import Workbook, load_workbook\n\nWorkbook1 = load_workbook(&quot;import.xlsx&quot;, data_only=True)\n\nwb_sheet_actived = Workbook1[&#39;Sheet1&#39;]\n\ndoc = Document()\ntable = doc.add_table(rows=0, cols=wb_sheet_actived.max_row)\ntable.style = &#39;Table Grid&#39;\n\nfor row_cells in wb_sheet_actived.iter_rows(values_only=True):\n    # print(row_cells)\n    table_cells = table.add_row().cells\n    for index, cell_value in enumerate(row_cells):\n        print(index)\n        cell_value_str = str(cell_value) if cell_value is not None else &quot;&quot;\n        table_cells[index].text = cell_value_str\n\ndoc.save(&quot;output.docx&quot;)","like_count":0},{"had_liked":false,"id":385232,"user_name":"Geek_631607","can_delete":false,"product_type":"c3","uid":3789991,"ip_address":"广东","ucode":"EAF874838F0BE4","user_header":"","comment_is_top":false,"comment_ctime":1702299281,"is_pvip":false,"replies":null,"discussion_count":0,"race_medal":0,"score":2,"product_id":100310001,"comment_content":"import pandas as pd\nfrom docx import Document\n\n# 读取 Excel 文件的第一张表格\ndf = pd.read_excel(&#39;sample.xlsx&#39;, sheet_name=0)\n\n# 创建一个新的 docx 文件\ndoc = Document()\n\n# 将表格的内容添加到 docx 文件中\nfor index, row in df.iterrows():\n    # 创建一个新的段落\n    paragraph = doc.add_paragraph()\n    # 将每一行的内容添加到段落中\n    for col in df.columns:\n        paragraph.add_run(f&#39;{col}: {row[col]}  &#39;)\n    # 添加一个空行\n    doc.add_paragraph()\n\n# 保存 docx 文件\ndoc.save(&#39;file.docx&#39;)","like_count":0},{"had_liked":false,"id":384032,"user_name":"醉后不知天在水","can_delete":false,"product_type":"c3","uid":2548362,"ip_address":"山东","ucode":"B8A25FBF639D5D","user_header":"https://static001.geekbang.org/account/avatar/00/26/e2/8a/ac6c5b92.jpg","comment_is_top":false,"comment_ctime":1700124956,"is_pvip":false,"replies":null,"discussion_count":0,"race_medal":0,"score":2,"product_id":100310001,"comment_content":"import sys\n!{sys.executable} -m pip install pandas\n!{sys.executable} -m pip install python-docx\n\nimport pandas as pd\nfrom docx import Document\n\ndf = pd.read_excel(&quot;.&#47;sample2.xlsx&quot;)\nprint(df.shape[1])\n\ndoc = Document()\n\ntable = doc.add_table(df.shape[0]+1, df.shape[1])\n\nfor i, column_name in enumerate(df.columns):\n    table.cell(0, i).text = column_name\n\nfor index, row in df.iterrows():\n    for i, value in enumerate(row):\n        table.cell(index+1, i).text = str(value)\n\ndoc.save(&quot;.&#47;output.docx&quot;)","like_count":0},{"had_liked":false,"id":383336,"user_name":"MarkG","can_delete":false,"product_type":"c3","uid":3675806,"ip_address":"山东","ucode":"454082595FE769","user_header":"https://static001.geekbang.org/account/avatar/00/38/16/9e/48621655.jpg","comment_is_top":false,"comment_ctime":1698891253,"is_pvip":false,"replies":null,"discussion_count":0,"race_medal":0,"score":2,"product_id":100310001,"comment_content":"import pandas as pd\nfrom docx import Document\n\n# 读取 excel 文件\ndf = pd.read_excel(&#39;.&#47;sample.xlsx&#39;, sheet_name=0)\n\n# 创建一个 docx 对象\ndoc = Document()\n\n# 遍历表格的行\nfor i, row in df.iterrows():\n    # 创建一个断了对象\n    paragraph = doc.add_paragraph()\n    # print(&#39;row&#39;, i, row)\n    # 遍历行中的每个单元格\n    for cell in row:\n        print(&#39;cell&#39;, cell)\n        paragraph.add_run(str(cell)).bold = True\n\n# 保存 docx 文件\ndoc.save(&#39;output.docx&#39;)","like_count":0},{"had_liked":false,"id":382823,"user_name":"Geek_Mike","can_delete":false,"product_type":"c3","uid":3196376,"ip_address":"云南","ucode":"CFA942192C3B74","user_header":"https://static001.geekbang.org/account/avatar/00/30/c5/d8/c5509b9c.jpg","comment_is_top":false,"comment_ctime":1698071925,"is_pvip":false,"replies":null,"discussion_count":0,"race_medal":0,"score":2,"product_id":100310001,"comment_content":"import pandas\nimport docx\n\nexcl = &#39;&#47;Users&#47;mike&#47;Desktop&#47;zero-basics-python&#47;0&#47;sample.xlsx&#39;\nword = &#39;&#47;Users&#47;mike&#47;Desktop&#47;zero-basics-python&#47;0&#47;sample_1.docx&#39;   \n\npd = pandas.ExcelFile(excl)\ndataframe = pandas.read_excel(pd, &#39;Sheet&#39;)\ndata = dataframe.values.tolist()\n\ndoc = docx.Document()\ntable = doc.add_table(rows = len(data), cols = len(data[0]))\ntable.style = &#39;Table Grid&#39;\n\nfor i in range(len(data)):\n    for j in range(len(data[0])):\n        cell = table.cell(i, j)\n        cell.text = str(data[i][j])\n\ndoc.save(word)","like_count":0},{"had_liked":false,"id":378555,"user_name":"Greenery","can_delete":false,"product_type":"c3","uid":3566765,"ip_address":"新加坡","ucode":"16111129C9EBA2","user_header":"https://static001.geekbang.org/account/avatar/00/36/6c/ad/0a694b50.jpg","comment_is_top":false,"comment_ctime":1690422825,"is_pvip":false,"replies":null,"discussion_count":0,"race_medal":0,"score":2,"product_id":100310001,"comment_content":"#%%\nfrom os import chdir\nfrom openpyxl import load_workbook\nchdir(r&#39;C:\\Projects\\python\\0base_py\\ch12\\exp1&#39;)\nwb = load_workbook(filename = &#39;hk.xlsx&#39;)\nsheet_ranges = wb[&#39;Sheet1&#39;]\n#%%\nvalues=[]\nfor i in range(1,9):\n    row = []\n    for j in [&#39;A&#39;,&#39;B&#39;,&#39;C&#39;,&#39;D&#39;]:\n        row.append(sheet_ranges[j+str(i)].value)\n    values.append(row)\nprint(values)\n#%%\nfrom docx import Document\n\ndocument = Document()\n\ndocument.add_heading(&#39;用户权限表&#39;, 0)\n\ntable=document.add_table(rows=1,cols=4)\n\nhdr_cells = table.rows[0].cells\nfor i in range(4):\n    hdr_cells[i].text = values[0][i]\nfor i in range(2,8):\n    row_cells = table.add_row().cells\n    for j in range(4):\n        row_cells[j].text = str(values[i][j])\n\ndocument.add_page_break()\n\n# 保存文件名\ndocument.save(&#39;hk.docx&#39;)","like_count":0},{"had_liked":false,"id":370078,"user_name":"Geek_fb1a3e","can_delete":false,"product_type":"c3","uid":3185358,"ip_address":"福建","ucode":"8E8E196B977AB6","user_header":"","comment_is_top":false,"comment_ctime":1678352589,"is_pvip":false,"replies":null,"discussion_count":0,"race_medal":0,"score":2,"product_id":100310001,"comment_content":"from docx import Document\nfrom openpyxl import workbook, load_workbook\n\nwb = load_workbook(&#39;12\\excel1.xlsx&#39;)\n# print(wb)\n\n#wb.sheetnames: 取得工作簿中所有表名的列表\nws = wb[wb.sheetnames[0]]\n\n# ws.calculate_dimension(): 获取工作表全部数据的单元格区域\n# ws.max_row 获取工作表最大行\n# ws.max_column 获取工作表最大列\n# ws.rows 迭代所有行\n# ws.columns 迭代所有列\ncell_area = ws[ws.calculate_dimension()]\n\nrecords = []\nfor row in cell_area:\n    row_list = []\n    for cell in row:\n        row_list.append(cell.value)\n    records.append(row_list)\n\ndocument = Document()\n#表格：document.add_table()添加指定行数列数的表格\nmax_row = ws.max_row\nmax_col = ws.max_column\nprint(f&quot;行数：{max_row}，  列数{max_col}&quot;)\n\ntable = document.add_table(rows=0, cols=5)\n\nfor i in range(max_row):\n    row_cells = table.add_row().cells\n    for j in range(max_col):\n        row_cells[j].text = str(records[i][j])\n\ndocument.save(&#39;toWord.docx&#39;)","like_count":0},{"had_liked":false,"id":367348,"user_name":"Cy23","can_delete":false,"product_type":"c3","uid":1591293,"ip_address":"辽宁","ucode":"8DC561C5151758","user_header":"https://static001.geekbang.org/account/avatar/00/18/47/fd/895f0c27.jpg","comment_is_top":false,"comment_ctime":1675153848,"is_pvip":false,"replies":null,"discussion_count":0,"race_medal":0,"score":2,"product_id":100310001,"comment_content":"from docx import Document\nfrom openpyxl import Workbook,load_workbook\n\nwb = load_workbook(&quot;1.xlsx&quot;)\nws = wb.active\ndata_row = []\nfor row in ws.values:\n    data_row.append(row)\n\ndocument = Document()\ntable = document.add_table(rows = 0, cols = ws.max_column)\ntable.style = &#39;Table Grid&#39;\n\nfor row in data_row:\n    row_cells = table.add_row().cells\n    for index, val in enumerate(row):\n       row_cells[index].text = str(val)\n\ndocument.save(&#39;1.docx&#39;)","like_count":0},{"had_liked":false,"id":367101,"user_name":"Matthew","can_delete":false,"product_type":"c3","uid":2843865,"ip_address":"江苏","ucode":"96093089773740","user_header":"https://thirdwx.qlogo.cn/mmopen/vi_32/PiajxSqBRaEKSVuNarJuDhBSvHY0giaq6yriceEBKiaKuc04wCYWOuso50noqDexaPJJibJN7PHwvcQppnzsDia1icZkw/132","comment_is_top":false,"comment_ctime":1674919059,"is_pvip":false,"replies":null,"discussion_count":0,"race_medal":0,"score":3,"product_id":100310001,"comment_content":"from docx import Document\nfrom openpyxl import Workbook,load_workbook\n\n# 打开要访问的 Excel\nwb = load_workbook(&quot;1.xlsx&quot;)\nws = wb.active\n\ndata_row = []\n\n# 遍历 Excel 默认 SHEET 的每一行，存入 data_row\nfor row in ws.values:\n    data_row.append(row)\n\n###########################################################\n# 创建要写入的 Word\ndocument = Document()\ntable = document.add_table(rows = 0, cols = ws.max_column)\ntable.style = &#39;Table Grid&#39;\n\n# 遍历 data_row 的每个元素（元组），为 table 的每一行逐一赋值 \nfor i, j, k in data_row:\n    row_cells = table.add_row().cells\n    row_cells[0].text = str(i)\n    row_cells[1].text = str(j)\n    row_cells[2].text = str(k)\n\ndocument.save(&#39;111.docx&#39;)","like_count":0},{"had_liked":false,"id":367061,"user_name":"Matthew","can_delete":false,"product_type":"c3","uid":2843865,"ip_address":"江苏","ucode":"96093089773740","user_header":"https://thirdwx.qlogo.cn/mmopen/vi_32/PiajxSqBRaEKSVuNarJuDhBSvHY0giaq6yriceEBKiaKuc04wCYWOuso50noqDexaPJJibJN7PHwvcQppnzsDia1icZkw/132","comment_is_top":false,"comment_ctime":1674888314,"is_pvip":false,"replies":null,"discussion_count":0,"race_medal":0,"score":3,"product_id":100310001,"comment_content":"from docx import Document\nfrom openpyxl import Workbook,load_workbook\n\n# 打开要访问的 Excel\nwb = load_workbook(&quot;1.xlsx&quot;)\nws = wb.active\n\n# 创建要写入的 Word\ndocument = Document()\ntable = document.add_table(rows = ws.max_row, cols = ws.max_column)\ntable.style = &#39;Table Grid&#39;\n\n# 遍历 Excel 默认 SHEET 的每一个单元格，然后写入 Word\nfor i in range(ws.max_row):\n    row_cells = table.rows[i].cells\n    for j in range(ws.max_column):\n        row_cells[j].text = str(ws.cell(i+1, j+1).value)\n\ndocument.save(&#39;1.docx&#39;)","like_count":0},{"had_liked":false,"id":367049,"user_name":"Matthew","can_delete":false,"product_type":"c3","uid":2843865,"ip_address":"江苏","ucode":"96093089773740","user_header":"https://thirdwx.qlogo.cn/mmopen/vi_32/PiajxSqBRaEKSVuNarJuDhBSvHY0giaq6yriceEBKiaKuc04wCYWOuso50noqDexaPJJibJN7PHwvcQppnzsDia1icZkw/132","comment_is_top":false,"comment_ctime":1674878207,"is_pvip":false,"replies":null,"discussion_count":0,"race_medal":0,"score":3,"product_id":100310001,"comment_content":"from docx import Document\nfrom openpyxl import Workbook,load_workbook\n\n# 打开要访问的 Excel\nwb = load_workbook(&quot;1.xlsx&quot;)\nws = wb.active\n\n# 创建要写入的 Word\ndocument = Document()\n\n# 遍历 Excel 默认 SHEET 的每一个单元格，然后写入 Word\nfor row in ws.iter_rows():\n    for cell in row:\n        print(cell.value)\n        document.add_paragraph(str(cell.value))\n\ndocument.save(&#39;1.docx&#39;)","like_count":0},{"had_liked":false,"id":366974,"user_name":"PatrickL","can_delete":false,"product_type":"c3","uid":1341431,"ip_address":"上海","ucode":"EF0EC18639B9B2","user_header":"https://static001.geekbang.org/account/avatar/00/14/77/f7/11548247.jpg","comment_is_top":false,"comment_ctime":1674724642,"is_pvip":false,"replies":null,"discussion_count":0,"race_medal":0,"score":3,"product_id":100310001,"comment_content":"import openpyxl\nimport docx\nwb = openpyxl.load_workbook(&#39;.\\极客时间_零基础学Python_2023\\\\12\\sample.xlsx&#39;)\nws = wb[wb.sheetnames[0]]\ndocument = docx.Document()\ntable = document.add_table(rows=ws.max_row, cols=ws.max_column)\nfor i in range(ws.max_row):\n    row_cells = table.rows[i].cells\n    for j in range(ws.max_column):\n        row_cells[j].text = str(ws.cell(i+1,j+1).value)\ndocument.save(&#39;零基础学Python_第94讲.docx&#39;)","like_count":0}]}