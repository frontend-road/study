{"id":116324,"title":"12 | RTCPeerConnectionï¼šéŸ³è§†é¢‘å®æ—¶é€šè®¯çš„æ ¸å¿ƒ","content":"<p>RTCPeerConnection ç±»æ˜¯åœ¨æµè§ˆå™¨ä¸‹ä½¿ç”¨ WebRTC å®ç°1å¯¹1å®æ—¶äº’åŠ¨éŸ³è§†é¢‘ç³»ç»Ÿæœ€æ ¸å¿ƒçš„ç±»ã€‚ä½ å¯ä»¥è®¤ä¸ºå®ƒæ˜¯ä¸€ä¸ªæ€»çš„æ¥å£ç±»æˆ–è€…ç§°å®ƒä¸ºèšåˆç±»ï¼Œè€Œè¯¥ç±»ä¸­å®ç°çš„å¾ˆå¤šåŠŸèƒ½éƒ½æ˜¯ç”±å…¶ä»–ç±»å…·ä½“å®ç°çš„ã€‚</p><p>åƒæˆ‘å‰é¢è®²çš„å¾ˆå¤šæ–‡ç« ï¼Œéƒ½æ˜¯ RTCPeerConnection ç±»çš„ä¸€éƒ¨åˆ†åŠŸèƒ½ï¼Œå¦‚ ï¼š</p><ul>\n<li><a href=\"https://time.geekbang.org/column/article/109999\">ã€Š06 | WebRTCä¸­çš„RTPåŠRTCPè¯¦è§£ã€‹</a>è®²çš„æ˜¯åº•å±‚ç½‘ç»œæ•°æ®ä¼ è¾“åè®®ä¸å…¶æ§åˆ¶åè®®ã€‚</li>\n<li><a href=\"https://time.geekbang.org/column/article/111337\">ã€Š07 | ä½ ç«Ÿç„¶ä¸çŸ¥é“SDPï¼Ÿå®ƒå¯æ˜¯WebRTCçš„é©±åŠ¨æ ¸å¿ƒï¼ã€‹</a>å’Œ<a href=\"https://time.geekbang.org/column/article/111675\">ã€Š08 | æœ‰è¯å¥½å•†é‡ï¼Œè®ºåª’ä½“åå•†ã€‹</a>è®²çš„æ˜¯ SDP åè®®åŠä½¿ç”¨SDPåè®®è¿›è¡Œåª’ä½“åå•†çš„è¿‡ç¨‹ç­‰ã€‚</li>\n<li><a href=\"https://time.geekbang.org/column/article/112325\">ã€Š09 | è®©æˆ‘ä»¬æ­å¼€WebRTCå»ºç«‹è¿æ¥çš„ç¥ç§˜é¢çº±ã€‹</a>è®²çš„æ˜¯ WebRTC åº•å±‚æ˜¯å¦‚ä½•å»ºç«‹è¿æ¥çš„ã€‚</li>\n<li><a href=\"https://time.geekbang.org/column/article/113560\">ã€Š10 | WebRTC NATç©¿è¶ŠåŸç†ã€‹</a>ä»‹ç»äº†åœ¨ WebRTC åº•å±‚è¿›è¡Œ NAT ç©¿è¶Šçš„è¿‡ç¨‹ã€‚</li>\n</ul><p>ä»¥ä¸Šè¿™äº›å†…å®¹éƒ½æ˜¯ RTCPeerConnection ç±»çš„åŠŸèƒ½ã€‚é™¤äº†ä¸Šè¿°è®²çš„è¿™äº›å†…å®¹ä¹‹å¤–ï¼ŒRTCPeerConnectionç±»è¿˜æœ‰è®¸å¤šå…¶ä»–çš„åŠŸèƒ½ï¼Œæˆ‘åœ¨åé¢çš„æ–‡ç« ä¸­è¿˜ä¼šå‘ä½ é€ä¸€ä»‹ç»ã€‚</p><p>RTPPeerConnection è¿™ä¸ªçŸ¥è¯†ç‚¹æ˜¯ä½ æŒæ¡ WebRTC å¼€å‘çš„é‡ä¸­ä¹‹é‡ï¼ŒæŠ“ä½å®ƒä½ å°±æŠ“ä½äº†å­¦ä¹  WebRTC çš„é’¥åŒ™ï¼ˆè¿™é‡Œä½ ä¸€å®šè¦æ¸…æ¥šï¼Œ<strong>SDP æ˜¯æŒæ¡WebRTCè¿è¡Œæœºåˆ¶çš„é’¥åŒ™ï¼Œè€ŒRTCPeerConnectionæ˜¯ä½¿ç”¨ WebRTC çš„é’¥åŒ™</strong>ï¼‰ï¼Œè¿™æ ·å¯ä»¥è®©ä½ å¾ˆå¿«å­¦ä¼š WebRTC çš„ä½¿ç”¨ã€‚</p><!-- [[[read_end]]] --><h2>åœ¨WebRTCå¤„ç†è¿‡ç¨‹ä¸­çš„ä½ç½®</h2><p>è¿˜æ˜¯è€è§„çŸ©ï¼Œæˆ‘ä»¬å…ˆæ¥çœ‹ä¸€ä¸‹æœ¬æ–‡åœ¨æ•´ä¸ª WebRTCå¤„ç†è¿‡ç¨‹ä¸­çš„ä½ç½®ã€‚</p><p><img src=\"https://static001.geekbang.org/resource/image/0b/c5/0b56e03ae1ba9bf71da6511e8ffe9bc5.png?wh=1142*481\" alt=\"\"></p><center><span class=\"reference\">WebRTCå¤„ç†è¿‡ç¨‹å›¾</span></center><p>é€šè¿‡ä¸Šé¢è¿™å¼ å›¾ï¼Œä½ å¯ä»¥çœ‹åˆ°æœ¬æ–‡æ‰€è¦è®²è¿°çš„å†…å®¹å°±æ˜¯ä¸¤ä¸ªç«¯ç‚¹ä¹‹é—´æ˜¯å¦‚ä½•é€šè¿‡ RTCPeerConnection åˆ›å»ºè¿æ¥çš„ã€‚</p><h2>ä¼ è¾“è¦åšå“ªäº›äº‹å„¿</h2><p>å¯ä»¥æƒ³åƒä¸€ä¸‹ï¼Œå¦‚æœä½ è‡ªå·±è¦å®ç°ä¸€å¥—1å¯¹1çš„é€šè¯ç³»ç»Ÿï¼Œä½ ä¼šæ€ä¹ˆåšå‘¢ï¼Ÿå¦‚æœä½ æœ‰ä¸€äº›socketå¼€å‘ç»éªŒçš„è¯ï¼Œæˆ‘æƒ³ä½ é¦–å…ˆä¼šæƒ³åˆ°åœ¨æ¯ä¸€ç«¯åˆ›å»ºä¸€ä¸ª socketï¼Œç„¶åé€šè¿‡è¯¥ socket ä¸å¯¹ç«¯ç›¸è¿ã€‚</p><p>å½“ socket è¿æ¥æˆåŠŸä¹‹åï¼Œä½ å°±å¯ä»¥é€šè¿‡ socket å‘å¯¹ç«¯å‘é€æ•°æ®æˆ–è€…æ¥æ”¶å¯¹ç«¯çš„æ•°æ®äº†ã€‚è¿™ä¸ªè¿‡ç¨‹æ˜¯ä¸æ˜¯çœ‹èµ·æ¥è¿˜æ˜¯è›®ç®€å•çš„å‘¢ï¼Ÿå®é™…ä¸Šï¼Œ<strong>RTCPeerConnection ç±»çš„å·¥ä½œåŸç†ä¸socket åŸºæœ¬æ˜¯ä¸€æ ·çš„</strong>ï¼Œä¸è¿‡å®ƒçš„åŠŸèƒ½æ›´å¼ºå¤§ï¼Œå®ç°ä¹Ÿæ›´ä¸ºå¤æ‚ã€‚å› ä¸ºå®ƒæœ‰å¾ˆå¤šç»†èŠ‚éœ€è¦å¤„ç†ï¼Œè¿™é‡Œæˆ‘ä»¬ä»â€œæé—®é¢˜â€çš„è§’åº¦å‡ºå‘ï¼Œåå‘åˆ†æï¼Œä½ å°±çŸ¥é“ RTCPeerConnection è¦å¤„ç†å“ªäº›ç»†èŠ‚äº†ã€‚</p><ul>\n<li>ç«¯ä¸ç«¯ä¹‹é—´è¦å»ºç«‹è¿æ¥ï¼Œä½†å®ƒä»¬æ˜¯å¦‚ä½•çŸ¥é“å½¼æ­¤çš„å¤–ç½‘åœ°å€å‘¢ï¼Ÿ</li>\n<li>å¦‚æœä¸¤å°ä¸»æœºéƒ½æ˜¯åœ¨ NAT ä¹‹åï¼Œå®ƒä»¬åˆæ˜¯å¦‚ä½•ç©¿è¶Š NAT è¿›è¡Œè¿æ¥çš„å‘¢ï¼Ÿ</li>\n<li>å¦‚æœ NAT ç©¿è¶Šä¸æˆåŠŸï¼Œåˆè¯¥å¦‚ä½•ä¿è¯åŒæ–¹ä¹‹é—´çš„è¿é€šæ€§å‘¢ï¼Ÿ</li>\n<li>å¥½ä¸å®¹æ˜“åŒæ–¹è¿é€šäº†ï¼Œå¦‚æœçªç„¶ä¸¢åŒ…äº†ï¼Œè¯¥æ€ä¹ˆåŠï¼Ÿ</li>\n<li>å¦‚æœä¼ è¾“è¿‡ç¨‹ä¸­ï¼Œä¼ è¾“çš„æ•°æ®é‡è¿‡å¤§ï¼Œè¶…è¿‡äº†ç½‘ç»œå¸¦å®½èƒ½å¤Ÿæ‰¿å—çš„è´Ÿè½½ï¼Œåˆè¯¥å¦‚ä½•ä¿éšœéŸ³è§†é¢‘çš„æœåŠ¡è´¨é‡å‘¢ï¼Ÿ</li>\n<li>ä¼ è¾“çš„éŸ³è§†é¢‘è¦æ—¶åˆ»ä¿æŒåŒæ­¥ï¼Œè¿™åˆè¯¥å¦‚ä½•åšåˆ°å‘¢ï¼Ÿ</li>\n<li>æ•°æ®åœ¨ä¼ è¾“ä¹‹å‰è¦è¿›è¡ŒéŸ³è§†é¢‘ç¼–ç ï¼Œè€Œåœ¨æ¥æ”¶ä¹‹ååˆè¦åšéŸ³è§†é¢‘è§£ç ï¼Œä½†WebRTCæ”¯æŒé‚£ä¹ˆå¤šç¼–è§£ç å™¨ï¼Œå¦‚ H264ï½¤ H265ï½¤ VP8ï½¤ VP9ç­‰ï¼Œå®ƒæ˜¯å¦‚ä½•é€‰æ‹©çš„å‘¢ï¼Ÿ</li>\n<li>â€¦â€¦</li>\n</ul><p>å¦‚æœä¸æ˜¯ç¯‡å¹…æœ‰é™ï¼Œæˆ‘å¯ä»¥ä¸€ç›´é—®ä¸‹å»å“ˆï¼Œä»ä¸­ä½ ä¹Ÿå¯ä»¥çœ‹å‡ºRTCPeerConnectionè¦å¤„ç†å¤šå°‘äº‹æƒ…äº†ã€‚é€šè¿‡è¿™äº›æè¿°ï¼Œæˆ‘æƒ³ä½ ä¹Ÿæ¸…æ¥šï¼Œè¿™å°±æ˜¯åŸç†ä¸çœŸæ­£çš„å®é™…å·¥ä½œä¹‹é—´è¿˜å·®ç€åä¸‡å…«åƒé‡Œçš„è·ç¦»å‘¢ã€‚ä¸è¿‡åŸç†çš„å¥½å¤„æ˜¯å¯ä»¥å¸®ä½ ç®€åŒ–é—®é¢˜ï¼Œæ–¹ä¾¿å‘ç°é—®é¢˜çš„æœ¬è´¨ã€‚</p><h2>ä»€ä¹ˆæ˜¯RTCPeerConnection</h2><p>äº†è§£äº†ä¼ è¾“éƒ½è¦åšå“ªäº›äº‹ä¹‹åï¼Œä½ å†ç†è§£ä»€ä¹ˆæ˜¯ RTCPeerConnection å°±æ¯”è¾ƒå®¹æ˜“äº†ã€‚å®é™…ä¸Šï¼ŒRTCPeerConnection å°±ä¸æ™®é€šçš„ socket ä¸€æ ·ï¼Œåœ¨é€šè¯çš„æ¯ä¸€ç«¯éƒ½è‡³å°‘æœ‰ä¸€ä¸ª RTCPeerConnection å¯¹è±¡ã€‚åœ¨ WebRTC ä¸­å®ƒè´Ÿè´£ä¸å„ç«¯å»ºç«‹è¿æ¥ï¼Œæ¥æ”¶ã€å‘é€éŸ³è§†é¢‘æ•°æ®ï¼Œå¹¶ä¿éšœéŸ³è§†é¢‘çš„æœåŠ¡è´¨é‡ã€‚</p><p>åœ¨æ“ä½œæ—¶ï¼Œä½ å®Œå…¨å¯ä»¥æŠŠå®ƒå½“ä½œä¸€ä¸ª socket æ¥ç”¨ï¼Œè€Œä¸”è¿˜æ˜¯ä¸€ä¸ªå…·æœ‰è¶…å¼ºèƒ½åŠ›çš„â€œ<strong>SOCKET</strong>â€ã€‚è‡³äºå®ƒæ˜¯å¦‚ä½•ä¿éšœç«¯ä¸ç«¯ä¹‹é—´çš„è¿é€šæ€§ï¼Œå¦‚ä½•ä¿è¯éŸ³è§†é¢‘çš„æœåŠ¡è´¨é‡ï¼Œåˆå¦‚ä½•ç¡®å®šä½¿ç”¨çš„æ˜¯å“ªä¸ªç¼–è§£ç å™¨ç­‰é—®é¢˜ï¼Œä½œä¸ºåº”ç”¨è€…çš„ä½ å¯ä»¥ä¸å¿…å…³å¿ƒï¼Œå› ä¸ºæ‰€æœ‰çš„è¿™äº›é—®é¢˜éƒ½å·²ç»åœ¨ RTCPeerConnection å¯¹è±¡çš„åº•å±‚å®ç°å¥½äº†ã€‚</p><p>å› æ­¤ï¼Œå¦‚æœæœ‰äººé—®ä½ ä»€ä¹ˆæ˜¯ RTCPeerConnectionï¼Ÿä½ å¯ä»¥ç®€è¦åœ°å›ç­”è¯´: â€œ<strong>å®ƒå°±æ˜¯ä¸€ä¸ªåŠŸèƒ½è¶…å¼ºçš„ socket</strong>ï¼â€è¿™ä¸€ä¸‹å°±ç‚¹å‡ºäº† RTCPeerConnection çš„æœ¬è´¨ã€‚</p><h2>å®ç°é€šè¯</h2><p>ä»Šå¤©æˆ‘ä»¬è¦å®ç°çš„ä¾‹å­æ˜¯åœ¨åŒä¸€ä¸ªé¡µé¢ä¸­ï¼Œä½¿ä¸¤ä¸ªRTCPeerConnectionå¯¹è±¡ä¹‹é—´å»ºç«‹è¿æ¥ã€‚å®ƒæ²¡æœ‰ä»€ä¹ˆå®é™…ä»·å€¼ï¼Œä½†å´èƒ½å¾ˆå¥½åœ°è¯æ˜RTCPeerConnectionæ˜¯å¦‚ä½•å·¥ä½œçš„ã€‚</p><p>è¿™é‡Œéœ€è¦ç‰¹åˆ«å¼ºè°ƒä¸€ç‚¹ï¼Œåœ¨éŸ³è§†é¢‘é€šè¯ä¸­ï¼Œæ¯ä¸€æ–¹åªéœ€è¦æœ‰ä¸€ä¸ª RTCPeerConnectionå¯¹è±¡ï¼Œç”¨å®ƒæ¥æ¥æ”¶æˆ–å‘é€éŸ³è§†é¢‘æ•°æ®ã€‚ç„¶è€Œåœ¨çœŸå®çš„åœºæ™¯ä¸­ï¼Œä¸ºäº†å®ç°ç«¯ä¸ç«¯ä¹‹é—´çš„é€šè¯ï¼Œè¿˜éœ€è¦åˆ©ç”¨ä¿¡ä»¤æœåŠ¡å™¨äº¤æ¢ä¸€äº›ä¿¡æ¯ï¼Œæ¯”å¦‚äº¤æ¢åŒæ–¹çš„ IP å’Œ port åœ°å€ï¼Œè¿™æ ·é€šä¿¡çš„åŒæ–¹æ‰èƒ½å½¼æ­¤å»ºç«‹è¿æ¥ï¼ˆä¿¡ä»¤æœåŠ¡å™¨çš„å®ç°å¯ä»¥å‚è€ƒ<a href=\"https://time.geekbang.org/column/article/114179\">ä¸Šä¸€ç¯‡æ–‡ç« </a>ï¼‰ã€‚</p><p>è€Œåœ¨æœ¬æ–‡çš„ä¾‹å­ä¸­ï¼Œä¸ºäº†æœ€å¤§åŒ–åœ°å‡å°‘é¢å¤–çš„å·¥ä½œé‡ï¼Œæ‰€ä»¥æˆ‘ä»¬é€‰æ‹©åœ¨åŒä¸€ä¸ªé¡µé¢ä¸­è¿›è¡ŒéŸ³è§†é¢‘çš„äº’é€šï¼Œè¿™æ ·å°±ä¸éœ€è¦å¼€å‘ã€å®‰è£…ä¿¡ä»¤æœåŠ¡å™¨äº†ã€‚ä¸è¿‡è¿™æ ·ä¹Ÿå¢åŠ äº†ä¸€äº›ç†è§£çš„éš¾åº¦ï¼Œæ‰€ä»¥åœ¨é˜…è¯»ä¸‹é¢çš„å†…å®¹æ—¶ï¼Œä½ ä¸€å®šè¦åœ¨è„‘å­ä¸­æƒ³è±¡ï¼š<strong>æ¯ä¸€ä¸ª RTCPeerConnection å°±æ˜¯ä¸€ä¸ªå®¢æˆ·ç«¯</strong>ï¼Œè¿™æ ·å°±æ¯”è¾ƒå®¹æ˜“ç†è§£åé¢çš„å†…å®¹äº†ã€‚</p><p>æ¥ä¸‹æ¥æˆ‘ä»¬å°±å®æ“èµ·æ¥ï¼Œä¸€æ­¥ä¸€æ­¥å®ç°é€šè¯å§ï¼</p><h3>1. æ·»åŠ è§†é¢‘å…ƒç´ å’Œæ§åˆ¶æŒ‰é’®</h3><p>æˆ‘ä»¬é¦–å…ˆå¼€å‘ä¸€ä¸ªç®€å•çš„æ˜¾ç¤ºç•Œé¢ï¼Œåœ¨è¯¥é¡µé¢ä¸­æœ‰ä¸¤ä¸ª<code>&lt;video&gt;</code>æ ‡ç­¾ï¼Œä¸€ä¸ªç”¨äºæ˜¾ç¤ºæœ¬åœ°æ•è·çš„è§†é¢‘ï¼Œå¦ä¸€ä¸ªç”¨äºæ˜¾ç¤ºâ€œè¿œç«¯â€çš„è§†é¢‘ã€‚</p><p>é™¤æ­¤ä¹‹å¤–ï¼Œåœ¨è¯¥é¡µé¢ä¸Šè¿˜æœ‰ä¸‰ä¸ª<code>&lt;button&gt;</code>æŒ‰é’®ï¼š</p><ul>\n<li>start æŒ‰é’®ï¼Œç”¨äºæ‰“å¼€æœ¬åœ°è§†é¢‘ï¼›</li>\n<li>call æŒ‰é’®ï¼Œç”¨äºä¸å¯¹æ–¹å»ºç«‹è¿æ¥ï¼›</li>\n<li>hangup æŒ‰é’®ï¼Œç”¨äºæ–­å¼€ä¸å¯¹æ–¹çš„è¿æ¥ã€‚</li>\n</ul><p>å…·ä½“ä»£ç å¦‚ä¸‹ï¼š</p><pre><code>&lt;video id=&quot;localVideo&quot; autoplay playsinline&gt;&lt;/video&gt;\n&lt;video id=&quot;remoteVideo&quot; autoplay playsinline&gt;&lt;/video&gt;\n\n&lt;div&gt;\n  &lt;button id=&quot;startButton&quot;&gt;start&lt;/button&gt;\n  &lt;button id=&quot;callButton&quot;&gt;call&lt;/button&gt;\n  &lt;button id=&quot;hangupButton&quot;&gt;hang up&lt;/button&gt;\n&lt;/div&gt;\n</code></pre><h3>2. é€‚é…å„ç§æµè§ˆå™¨</h3><p>ä¸€èˆ¬æƒ…å†µä¸‹ï¼Œæˆ‘éƒ½è¿˜ä¼šåœ¨æ˜¾ç¤ºé¡µé¢ä¸­æ·»åŠ ä¸€ä¸ªå«åš <strong>adapter.js</strong> çš„è„šæœ¬ï¼Œå®ƒçš„ä½œç”¨æ˜¯ä¸ºå„ç§æµè§ˆå™¨éƒ½æä¾›ç»Ÿä¸€çš„ã€æœ€æ–°çš„ WebRTC API æ¥å£ã€‚</p><p>åœ¨ WebRTC 1.0 è§„èŒƒæ²¡æœ‰å‘å¸ƒä¹‹å‰ï¼Œè™½ç„¶å„å¤§æµè§ˆå™¨å‚å•†éƒ½åœ¨å„è‡ªçš„æµè§ˆå™¨ä¸Šç§»æ¤äº† WebRTCï¼Œä½†ä½ ä¼šå‘ç°å®ƒä»¬æœ€ç»ˆå®ç°çš„æ¥å£å„ä¸ç›¸åŒã€‚è¿™ä¸€é—®é¢˜ç›´åˆ° WebRTC è§„èŒƒæ­£å¼æ¨å‡ºä¹‹åæ‰æœ‰æ‰€æ”¹å–„ï¼Œä½†å¾ˆå¤šç”¨æˆ·ä¾ç„¶ä½¿ç”¨è€ç‰ˆæœ¬çš„æµè§ˆå™¨ï¼Œè¿™å°±ä¸ºä½¿ç”¨ WebRTC å¼€å‘éŸ³è§†é¢‘åº”ç”¨å¢æ·»äº†ä¸å°‘éº»çƒ¦ã€‚</p><p>ç”±äºæµè§ˆå™¨ç‰ˆæœ¬ä¼—å¤šï¼Œè€Œä¸”ç”¨æˆ·åŸºæ•°å¤§ï¼Œå¯ä»¥é¢„è§å„æµè§ˆå™¨è®¿é—® WebRTC API æ¥å£ä¸ç»Ÿä¸€çš„é—®é¢˜ï¼Œåœ¨æœªæ¥å¾ˆé•¿ä¸€æ®µæ—¶é—´å†…ä¼šä¸€ç›´å­˜åœ¨ã€‚ä½†å¹¸è¿çš„æ˜¯ï¼ŒGoogle å¾ˆæ—©ä¹‹å‰å°±å·²ç»æ³¨æ„åˆ°äº†è¿™ä¸ªé—®é¢˜ï¼Œå› æ­¤å¼€å‘äº†adapter.js è¿™ä¸ªé€‚é…å™¨è„šæœ¬ï¼Œä»¥å¼¥è¡¥å„æµè§ˆå™¨API ä¸ç»Ÿä¸€çš„é—®é¢˜ã€‚</p><p>å½“ç„¶ï¼Œä½ ä¹Ÿå¯ä»¥è‡ªå·±åšè¿™ä»¶äº‹å„¿ï¼Œåªä¸è¿‡é€‚é…å„ç§æµè§ˆå™¨ç‰ˆæœ¬çœŸçš„æ˜¯ä¸€ä»¶ä»¤äººå¤´ç–¼çš„äº‹å„¿ï¼Œè¿™ä¼šæ˜¯ä¸€ä¸ªä¸å°çš„æŒ‘æˆ˜ã€‚è€Œ adapter.js æ­£å¥½è§£å†³äº†è¿™ä¸ªç—›ç‚¹ã€‚éšç€adapter.jsçš„å‘å±•ï¼Œå®ƒä¸ºäº†è§£å†³å„ç§å„æ ·å¤æ‚çš„é—®é¢˜ï¼Œä¹Ÿä»ä¸€å°æ®µå¾ˆç®€å•çš„JavaScriptä»£ç é€æ¸å˜å¾—è¶Šæ¥è¶Šåºå¤§ã€å¤æ‚ã€‚ä½†å¯¹äºadapter.jsè¿™ç§å³ç¨³å®šã€åˆæˆç†Ÿï¼Œä¸”æ€§èƒ½ä¸é”™çš„åº“æˆ‘ä¸€å‘æ˜¯å¥‰è¡Œâ€œæ‹¿æ¥ä¸»ä¹‰â€å“ˆï¼</p><p>åœ¨é¡µé¢ä¸­å¼•å…¥ adapter.js çš„æ–¹æ³•å¦‚ä¸‹ï¼š</p><pre><code>...\n&lt;script src=&quot;https://webrtc.github.io/adapter/adapter-latest.js &lt;/script&gt;\n...\n</code></pre><p>ä¿®æ”¹åçš„ index.html ä»£ç å¦‚ä¸‹ï¼š</p><pre><code>&lt;!DOCTYPE html&gt;\n&lt;html&gt;\n\n&lt;head&gt;\n  &lt;title&gt;Realtime communication with WebRTC&lt;/title&gt;\n  &lt;link rel=&quot;stylesheet&quot; href=&quot;css/main.css&quot; /&gt;\n&lt;/head&gt;\n\n&lt;body&gt;\n  &lt;h1&gt;Realtime communication with WebRTC&lt;/h1&gt;\n\n  &lt;video id=&quot;localVideo&quot; autoplay playsinline&gt;&lt;/video&gt;\n  &lt;video id=&quot;remoteVideo&quot; autoplay playsinline&gt;&lt;/video&gt;\n\n  &lt;div&gt;\n    &lt;button id=&quot;startButton&quot;&gt;Start&lt;/button&gt;\n    &lt;button id=&quot;callButton&quot;&gt;Call&lt;/button&gt;\n    &lt;button id=&quot;hangupButton&quot;&gt;Hang Up&lt;/button&gt;\n  &lt;/div&gt;\n\n  &lt;script src=&quot;https://webrtc.github.io/adapter/adapter-latest.js&quot;&gt;&lt;/script&gt;\n  &lt;script src=&quot;js/client.js&quot;&gt;&lt;/script&gt;\n&lt;/body&gt;\n&lt;/html&gt;\n</code></pre><p>é€šè¿‡ä¸Šé¢çš„æ“ä½œï¼Œç•Œé¢æ˜¾ç¤ºåŠå„æµè§ˆå™¨ä¹‹é—´é€‚é…çš„é—®é¢˜å°±å…¨éƒ¨å®Œæˆäº†ã€‚æ¥ä¸‹æ¥æˆ‘ä»¬æ¥çœ‹ä¸€ä¸‹ RTCPeerConnectionæ˜¯å¦‚ä½•å·¥ä½œçš„ã€‚</p><h3>3. RTCPeerConnectionå¦‚ä½•å·¥ä½œ</h3><p>ä¸ºäº†è®²æ¸…æ¥šRTCPeerConnectionæ˜¯å¦‚ä½•å·¥ä½œçš„ï¼Œæˆ‘ä»¬è¿˜æ˜¯çœ‹ä¸€ä¸ªå…·ä½“çš„ä¾‹å­å§ã€‚</p><p>å‡è®¾ A ä¸ B è¿›è¡Œé€šä¿¡ï¼Œé‚£ä¹ˆå¯¹äºæ¯ä¸ªç«¯éƒ½è¦åˆ›å»ºä¸€ä¸ª RTCPeerConnection å¯¹è±¡ï¼Œè¿™æ ·åŒæ–¹æ‰å¯ä»¥é€šä¿¡ï¼Œè¿™ä¸ªåº”è¯¥å¾ˆå¥½ç†è§£ã€‚ä½†ç”±äºæˆ‘ä»¬çš„ä¾‹å­ä¸­ï¼Œé€šä¿¡åŒæ–¹æ˜¯åœ¨åŒä¸€ä¸ªé¡µé¢ä¸­ï¼ˆä¹Ÿå°±æ˜¯è¯´ä¸€ä¸ªé¡µé¢åŒæ—¶æ‰®æ¼” A å’Œ B ä¸¤ä¸ªè§’è‰²ï¼‰ï¼Œæ‰€ä»¥åœ¨æˆ‘ä»¬çš„JavaScriptä»£ç ä¸­ä¼šåŒæ—¶å­˜åœ¨ä¸¤ä¸ª RTCPeerConnection å¯¹è±¡ï¼Œæˆ‘ä»¬ç§°å®ƒä»¬ä¸º pc1 å’Œ pc2å¥½å•¦ï¼è¿™é‡Œä½ ä¸€å®šè¦æ³¨æ„ï¼Œè™½ç„¶pc1 å’Œ pc2 æ˜¯åœ¨åŒä¸€ä¸ªé¡µé¢ä¸­ï¼Œä½†ä½ ä¸€å®šè¦æŠŠ pc1 å’Œ pc2 æƒ³åƒæˆä¸¤ä¸ªç«¯çš„è¿æ¥å¯¹è±¡ï¼Œè¿™æ ·æ‰ä¾¿äºå¯¹åé¢ä»£ç çš„ç†è§£ã€‚</p><p>åœ¨ WebRTC ç«¯ä¸ç«¯ä¹‹é—´å»ºç«‹è¿æ¥ï¼ŒåŒ…æ‹¬ä¸‰ä¸ªä»»åŠ¡ï¼š</p><ul>\n<li>ä¸ºè¿æ¥çš„æ¯ä¸ªç«¯åˆ›å»ºä¸€ä¸ªRTCPeerConnectionå¯¹è±¡ï¼Œå¹¶ä¸”ç»™ RTCPeerConnection å¯¹è±¡æ·»åŠ ä¸€ä¸ªæœ¬åœ°æµï¼Œè¯¥æµæ˜¯ä»getUserMedia()è·å–çš„ï¼›</li>\n<li>è·å–æœ¬åœ°åª’ä½“æè¿°ä¿¡æ¯ï¼Œå³ SDP ä¿¡æ¯ï¼Œå¹¶ä¸å¯¹ç«¯è¿›è¡Œäº¤æ¢ï¼›</li>\n<li>è·å¾—ç½‘ç»œä¿¡æ¯ï¼Œå³ Candidateï¼ˆIPåœ°å€å’Œç«¯å£ï¼‰ï¼Œå¹¶ä¸è¿œç«¯è¿›è¡Œäº¤æ¢ã€‚</li>\n</ul><p>ä¸‹é¢æˆ‘ä»¬å°±æ¥è¯¦ç»†çœ‹çœ‹ä»£ç æ˜¯å¦‚ä½•å®ç°çš„ã€‚</p><p><strong>ï¼ˆ1ï¼‰è·å–æœ¬åœ°éŸ³è§†é¢‘æµ</strong></p><p>ä½ éœ€è¦è°ƒç”¨ getUserMedia() è·å–åˆ°æœ¬åœ°æµï¼Œç„¶åå°†å®ƒæ·»åŠ åˆ°å¯¹åº”çš„ RTCPeerConnectonå¯¹è±¡ä¸­ï¼Œä»£ç å¦‚ä¸‹ï¼š</p><pre><code>...\n//åˆ›å»º RTCPeerConnection å¯¹è±¡\nlet localPeerConnection = new RTCPeerConnection(servers);\n...\n\n//è°ƒç”¨ getUserMedia API è·å–éŸ³è§†é¢‘æµ\nnavigator.mediaDevices.getUserMedia(mediaStreamConstraints).\n  then(gotLocalMediaStream).\n  catch(handleLocalMediaStreamError);\n  \n//å¦‚æœ getUserMedia è·å¾—æµï¼Œåˆ™ä¼šå›è°ƒè¯¥å‡½æ•°\n//åœ¨è¯¥å‡½æ•°ä¸­ä¸€æ–¹é¢è¦å°†è·å–çš„éŸ³è§†é¢‘æµå±•ç¤ºå‡ºæ¥\n//å¦ä¸€æ–¹é¢æ˜¯ä¿å­˜åˆ° localSteam\nfunction gotLocalMediaStream(mediaStream) {\n  ...\n  localVideo.srcObject = mediaStream;\n  localStream = mediaStream;\n  ...\n\n}\n\n...\n\n//å°†éŸ³è§†é¢‘æµæ·»åŠ åˆ° RTCPeerConnection å¯¹è±¡ä¸­\nlocalPeerConnection.addStream(localStream);\n\n...\n</code></pre><p><strong>ï¼ˆ2ï¼‰äº¤æ¢åª’ä½“æè¿°ä¿¡æ¯</strong></p><p>å½“ RTCPeerConnection å¯¹è±¡è·å¾—éŸ³è§†é¢‘æµåï¼Œå°±å¯ä»¥å¼€å§‹ä¸å¯¹ç«¯è¿›è¡Œåª’åä½“åå•†äº†ã€‚æ•´ä¸ªåª’ä½“åå•†çš„è¿‡ç¨‹æˆ‘å·²ç»åœ¨<a href=\"https://time.geekbang.org/column/article/111675\">ã€Š08 | æœ‰è¯å¥½å•†é‡ï¼Œè®ºåª’ä½“åå•†ã€‹</a>ä¸€æ–‡ä¸­åšäº†è¯¦ç»†ä»‹ç»ï¼Œè‹¥è®°ä¸æ¸…äº†ï¼Œå¯ä»¥å›çœ‹ä¸‹ï¼Œæˆ‘ä»¬ä¸‹é¢çš„å®è·µä¸­è¦ç”¨åˆ°ã€‚</p><p>å¹¶ä¸”å‰é¢æˆ‘ä»¬ä¹Ÿè¯´äº†ï¼Œåœ¨çœŸå®çš„åº”ç”¨åœºæ™¯ä¸­ï¼Œå„ç«¯è·å–çš„ SDP ä¿¡æ¯éƒ½è¦é€šè¿‡ä¿¡ä»¤æœåŠ¡å™¨è¿›è¡Œäº¤æ¢ï¼Œä½†åœ¨æˆ‘ä»¬è¿™ä¸ªä¾‹å­ä¸­ä¸ºäº†å‡å°‘ä»£ç çš„å¤æ‚åº¦ï¼Œç›´æ¥åœ¨ä¸€ä¸ªé¡µé¢ä¸­å®ç°äº†ä¸¤ä¸ªç«¯ï¼Œæ‰€ä»¥ä¹Ÿå°±ä¸éœ€é€šè¿‡ä¿¡ä»¤æœåŠ¡å™¨äº¤æ¢ä¿¡æ¯äº†ï¼Œåªéœ€è¦ç›´æ¥å°†ä¸€ç«¯è·å–çš„ offer è®¾ç½®åˆ°å¦ä¸€ç«¯å°±å¥½äº†ï¼Œå…·ä½“æ­¥éª¤å¯ä»¥å¤§è‡´æè¿°ä¸ºå¦‚ä¸‹ã€‚</p><p>æˆ‘ä»¬é¦–å…ˆåˆ›å»º offer ç±»å‹çš„ SDPä¿¡æ¯ã€‚A è°ƒç”¨ RTCPeerConnection çš„ createOffer() æ–¹æ³•ï¼Œå¾—åˆ° A çš„æœ¬åœ°ä¼šè¯æè¿°ï¼Œå³ offer ç±»å‹çš„ SDP ä¿¡æ¯ï¼š</p><pre><code>...\nlocalPeerConnection.createOffer(offerOptions)\n  .then(createdOffer).catch(setSessionDescriptionError);\n...\n</code></pre><p>å¦‚æœ createOffer å‡½æ•°è°ƒç”¨æˆåŠŸï¼Œä¼šå›è°ƒ createdOffer æ–¹æ³•ï¼Œå¹¶åœ¨ createdOffer æ–¹æ³•ä¸­åšä»¥ä¸‹å‡ ä»¶äº‹å„¿ã€‚</p><ul>\n<li>A ä½¿ç”¨setLocalDescription()è®¾ç½®æœ¬åœ°æè¿°ï¼Œç„¶åå°†æ­¤ä¼šè¯æè¿°å‘é€ç»™Bã€‚B ä½¿ç”¨setRemoteDescription() è®¾ç½® A ç»™å®ƒçš„æè¿°ä½œä¸ºè¿œç«¯æè¿°ã€‚</li>\n<li>ä¹‹åï¼ŒB è°ƒç”¨ RTCPeerConnection çš„ createAnswer() æ–¹æ³•è·å¾—å®ƒæœ¬åœ°çš„åª’ä½“æè¿°ã€‚ç„¶åï¼Œå†è°ƒç”¨ setLocalDescription æ–¹æ³•è®¾ç½®æœ¬åœ°æè¿°å¹¶å°†è¯¥åª’ä½“ä¿¡æ¯æè¿°å‘ç»™Aã€‚</li>\n<li>Aå¾—åˆ° B çš„åº”ç­”æè¿°åï¼Œå°±è°ƒç”¨ setRemoteDescription()è®¾ç½®è¿œç¨‹æè¿°ã€‚</li>\n</ul><p>æ•´ä¸ªåª’ä½“ä¿¡æ¯äº¤æ¢å’Œåå•†è‡³æ­¤å°±å®Œæˆäº†ã€‚å…·ä½“ä»£ç å¦‚ä¸‹ï¼š</p><pre><code>//å½“åˆ›å»º offer æˆåŠŸåï¼Œä¼šè°ƒç”¨è¯¥å‡½æ•°\nfunction createdOffer(description) {\n  ...\n  //å°† offer ä¿å­˜åˆ°æœ¬åœ°\n  localPeerConnection.setLocalDescription(description)\n    .then(() =&gt; {\n      setLocalDescriptionSuccess(localPeerConnection);\n    }).catch(setSessionDescriptionError);\n\n  ...\n  //è¿œç«¯ pc å°† offer ä¿å­˜èµ·æ¥\n  remotePeerConnection.setRemoteDescription(description)\n    .then(() =&gt; {\n      setRemoteDescriptionSuccess(remotePeerConnection);\n    }).catch(setSessionDescriptionError);\n\n  ...\n  //è¿œç«¯ pc åˆ›å»º answer\n  remotePeerConnection.createAnswer()\n    .then(createdAnswer)\n    .catch(setSessionDescriptionError);\n}\n\n//å½“ answer åˆ›å»ºæˆåŠŸåï¼Œä¼šå›è°ƒè¯¥å‡½æ•° \nfunction createdAnswer(description) {\n  ...\n  //è¿œç«¯ä¿å­˜ answer\n  remotePeerConnection.setLocalDescription(description)\n    .then(() =&gt; {\n      setLocalDescriptionSuccess(remotePeerConnection);\n    }).catch(setSessionDescriptionError);\n\n  //æœ¬ç«¯pcä¿å­˜ answer\n  localPeerConnection.setRemoteDescription(description)\n    .then(() =&gt; {\n      setRemoteDescriptionSuccess(localPeerConnection);\n    }).catch(setSessionDescriptionError);\n}\n</code></pre><p><strong>ï¼ˆ3ï¼‰ç«¯ä¸ç«¯å»ºç«‹è¿æ¥</strong></p><p>åœ¨æœ¬åœ°ï¼Œå½“ A è°ƒç”¨ setLocalDescription å‡½æ•°æˆåŠŸåï¼Œå°±å¼€å§‹æ”¶åˆ°ç½‘ç»œä¿¡æ¯äº†ï¼Œå³å¼€å§‹æ”¶é›† ICE Candidateã€‚</p><p>å½“ Candidate è¢«æ”¶é›†ä¸Šæ¥åï¼Œä¼šè§¦å‘ pc çš„ <strong>icecandidate</strong> äº‹ä»¶ï¼Œæ‰€ä»¥åœ¨ä»£ç ä¸­æˆ‘ä»¬éœ€è¦ç¼–å†™ icecandidate äº‹ä»¶çš„å¤„ç†å‡½æ•°ï¼Œå³onicecandidateï¼Œä»¥ä¾¿å¯¹æ”¶é›†åˆ°çš„ Candidate è¿›è¡Œå¤„ç†ã€‚</p><p>ä¸º RTCPeerConnection å¯¹è±¡æ·»åŠ  icecandidate äº‹ä»¶çš„æ–¹æ³•å¦‚ä¸‹ï¼š</p><pre><code>...\nlocalPeerConnection.onicecandidate= handleConnection(event); \n...\n</code></pre><p>ä¸Šé¢è¿™æ®µä»£ç ä¸º localPeerConnection å¯¹è±¡çš„ icecandidate äº‹ä»¶æ·»åŠ äº†ä¸€ä¸ªå¤„ç†å‡½æ•°ï¼Œå³ handleConnectionã€‚</p><p>å½“Candidateå˜ä¸ºæœ‰æ•ˆæ—¶ï¼ŒhandleConnection å‡½æ•°å°†è¢«è°ƒç”¨ï¼Œå…·ä½“ä»£ç å¦‚ä¸‹ï¼š</p><pre><code>...\nfunction handleConnection(event) {\n  \n  //è·å–åˆ°è§¦å‘ icecandidate äº‹ä»¶çš„ RTCPeerConnection å¯¹è±¡\n  //è·å–åˆ°å…·ä½“çš„Candidate\n  const peerConnection = event.target;\n  const iceCandidate = event.candidate;\n\n  if (iceCandidate) {\n  \t //åˆ›å»º RTCIceCandidate å¯¹è±¡\n    const newIceCandidate = new RTCIceCandidate(iceCandidate);\n    //å¾—åˆ°å¯¹ç«¯çš„RTCPeerConnection\n    const otherPeer = getOtherPeer(peerConnection);\n\n\t//å°†æœ¬åœ°è·åˆ°çš„ Candidate æ·»åŠ åˆ°è¿œç«¯çš„ RTCPeerConnectionå¯¹è±¡ä¸­\n    otherPeer.addIceCandidate(newIceCandidate)\n      .then(() =&gt; {\n        handleConnectionSuccess(peerConnection);\n      }).catch((error) =&gt; {\n        handleConnectionFailure(peerConnection, error);\n      });\n\n    ...\n  }\n  \n}\n...\n</code></pre><p>æ¯æ¬¡ handleConnection å‡½æ•°è¢«è°ƒç”¨æ—¶ï¼Œå°±è¯´æ˜ WebRTC åˆæ”¶é›†åˆ°äº†ä¸€ä¸ªæ–°çš„ Candidateã€‚åœ¨çœŸå®çš„åœºæ™¯ä¸­ï¼Œæ¯å½“è·å¾—ä¸€ä¸ªæ–°çš„ Candidate åï¼Œå°±ä¼šé€šè¿‡ä¿¡ä»¤æœåŠ¡å™¨äº¤æ¢ç»™å¯¹ç«¯ï¼Œå¯¹ç«¯å†è°ƒç”¨ RTCPeerConnection å¯¹è±¡çš„ addIceCandidate()æ–¹æ³•å°†æ”¶åˆ°çš„ Candidate ä¿å­˜èµ·æ¥ï¼Œç„¶åæŒ‰ç…§Candidateçš„ä¼˜å…ˆçº§è¿›è¡Œè¿é€šæ€§æ£€æµ‹ã€‚</p><p>å¦‚æœ Candidate è¿é€šæ€§æ£€æµ‹å®Œæˆï¼Œé‚£ä¹ˆç«¯ä¸ç«¯ä¹‹é—´å°±å»ºç«‹äº†ç‰©ç†è¿æ¥ï¼Œè¿™æ—¶åª’ä½“æ•°æ®å°±å¯èƒ½é€šè¿™ä¸ªç‰©ç†è¿æ¥æºæºä¸æ–­åœ°ä¼ è¾“äº†ã€‚</p><h2>æ˜¾ç¤ºè¿œç«¯åª’ä½“æµ</h2><p>é€šè¿‡ RTCPeerConnection å¯¹è±¡Aä¸BåŒæ–¹å»ºç«‹è¿æ¥åï¼Œæœ¬åœ°çš„å¤šåª’ä½“æ•°æ®å°±è¢«æºæºä¸æ–­åœ°ä¼ é€åˆ°äº†è¿œç«¯ã€‚ä¸è¿‡ï¼Œè¿œç«¯è™½ç„¶æ¥æ”¶åˆ°äº†åª’ä½“æ•°æ®ï¼Œä½†éŸ³è§†é¢‘å¹¶ä¸ä¼šæ˜¾ç¤ºæˆ–æ’­æ”¾å‡ºæ¥ã€‚ä»¥è§†é¢‘ä¸ºä¾‹ï¼Œä¸æ˜¾ç¤ºè§†é¢‘çš„åŸå› æ˜¯<code>&lt;video&gt;</code>æ ‡ç­¾è¿˜æ²¡æœ‰ä¸ RTCPeerConnection å¯¹è±¡è¿›è¡Œç»‘å®šï¼Œä¹Ÿå°±æ˜¯è¯´æ•°æ®è™½ç„¶åˆ°äº†ï¼Œä½†æ’­æ”¾å™¨è¿˜æ²¡æœ‰æ‹¿åˆ°å®ƒã€‚</p><p>ä¸‹é¢æˆ‘ä»¬å°±æ¥çœ‹ä¸€ä¸‹å¦‚ä½•è®©RTCPeerConnectionå¯¹è±¡è·å¾—çš„åª’ä½“æ•°æ®ä¸ H5 çš„<code>&lt;video&gt;</code>æ ‡ç­¾ç»‘å®šåˆ°ä¸€èµ·ã€‚å…·ä½“ä»£ç å¦‚ä¸‹æ‰€ç¤ºï¼š</p><pre><code>...\n\nlocalPeerConnection.onaddstream = handleRemoteStreamAdded;\n...\n\nfunction handleRemoteStreamAdded(event) {\n  console.log('Remote stream added.');\n  remoteStream = event.stream;\n  remoteVideo.srcObject = remoteStream;\n}\n\n...\n</code></pre><p>ä¸Šé¢ä»£ç çš„å…³é”®ç‚¹æ˜¯ <strong>addstream</strong> äº‹ä»¶ã€‚ åœ¨åˆ›å»ºå¥½ RTCPeerConnection å¯¹è±¡åï¼Œæˆ‘ä»¬éœ€è¦ç»™ RTCPeerConnection çš„ addstream äº‹ä»¶æ·»åŠ å›è°ƒå¤„ç†å‡½æ•°ï¼Œå³\u000fonaddstream å‡½æ•°ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œå½“æœ‰æ•°æ®æµåˆ°æ¥çš„æ—¶å€™ï¼Œæµè§ˆå™¨ä¼šå›è°ƒå®ƒï¼Œåœ¨æˆ‘ä»¬çš„ä»£ç ä¸­è®¾ç½®çš„å›è°ƒå¤„ç†å‡½æ•°å°±æ˜¯ <strong>handleRemoteStreamAdded</strong> ã€‚</p><p>å½“è¿œç«¯æœ‰æ•°æ®åˆ°è¾¾æ—¶ï¼ŒWebRTC åº•å±‚å°±ä¼šè°ƒç”¨ addstream äº‹ä»¶çš„å›è°ƒå‡½æ•°ï¼Œå³handleRemoteStreamAddedã€‚åœ¨ handleRemoteStreamAdded å‡½æ•°çš„è¾“å…¥å‚æ•°eventä¸­ï¼ŒåŒ…æ‹¬äº†è¿œç«¯çš„éŸ³è§†é¢‘æµï¼Œå³ MediaStream å¯¹è±¡ï¼Œæ­¤æ—¶å°†è¯¥å¯¹è±¡èµ‹å€¼ç»™ video æ ‡ç­¾çš„ srcObject å­—æ®µï¼Œè¿™æ · video å°±ä¸ RTCPeerConnection è¿›è¡Œäº†ç»‘å®šã€‚</p><p>è‡³æ­¤ï¼Œvideo å°±èƒ½ä» RTCPeerConnection è·å–åˆ°è§†é¢‘æ•°æ®ï¼Œå¹¶æœ€ç»ˆå°†å…¶æ˜¾ç¤ºå‡ºæ¥äº†ã€‚</p><h2>å°ç»“</h2><p>åœ¨æ–‡ä¸­æˆ‘å‘ä½ è¯¦ç»†ä»‹ç»äº†RTCPeerConnectionç±»ï¼Œå½“ä½ ä»ä¸åŒçš„è§’åº¦å»è§‚å¯Ÿå®ƒæ—¶ï¼Œä½ ä¼šå¯¹å®ƒæœ‰ä¸åŒçš„è®¤çŸ¥ï¼šå¦‚æœä½ ä»ä½¿ç”¨çš„è§’åº¦çœ‹ï¼Œä¼šè§‰å¾—RTCPeerConnectionæ˜¯ä¸€ä¸ªæ¥å£ç±»ï¼›å¦‚æœä½ ä»åŠŸèƒ½çš„è§’åº¦çœ‹ï¼Œå®ƒåˆæ˜¯ä¸€ä¸ªåŠŸèƒ½èšåˆç±»ã€‚è¿™å°±æ˜¯çœŸå®çš„ RTCPeerConnectionç±»ã€‚</p><p>åœ¨ä½¿ç”¨ RTCPeerConnectionæ—¶ï¼Œä½ å¯ä»¥æŠŠå®ƒå½“ä½œä¸€ä¸ªåŠŸèƒ½è¶…å¼ºçš„ socket ä½¿ç”¨ã€‚åœ¨å®ƒçš„åº•å±‚ï¼Œå®ƒåšäº†å¾ˆå¤šå¾ˆç»†è‡´çš„å·¥ä½œï¼Œè€Œåœ¨åº”ç”¨å±‚ï¼Œä½ ä¸å¿…å…³å¿ƒè¿™äº›ç»†èŠ‚ï¼Œåªè¦å­¦ä¼šå¦‚ä½•ä½¿ç”¨å®ƒï¼Œå°±å¯ä»¥åœ¨æµè§ˆå™¨ä¸Šè½»æ¾å®ç°ä½ å¯¹éŸ³è§†é¢‘å¤„ç†çš„æƒ³æ³•ã€‚</p><p>åœ¨æœ¬æ–‡çš„ååŠæ®µï¼Œæˆ‘è¿˜é€šè¿‡ä¸€ä¸ªå…·ä½“çš„ä¾‹å­å‘ä½ è®²è§£äº†å¦‚ä½•ä½¿ç”¨ RTCPeerConnection å¯¹è±¡ã€‚é€šè¿‡è¿™ä¸ªä¾‹å­ä½ å°±çŸ¥é“å¦‚ä½•åœ¨ä¸€ä¸ªé¡µé¢å†…å®ç°éŸ³è§†é¢‘æµçš„å‘é€ä¸æ¥æ”¶äº†ã€‚</p><h2>æ€è€ƒæ—¶é—´</h2><p>åœ¨<a href=\"https://time.geekbang.org/column/article/114179\">ä¸Šä¸€ç¯‡æ–‡ç« </a>ä¸­æˆ‘å‘ä½ è®²è§£äº†å¦‚ä½•é€šè¿‡ Node.jsæ­å»ºä¸€å¥—ä¿¡ä»¤æœåŠ¡å™¨ï¼Œä»Šå¤©æˆ‘åˆå‘ä½ è®²è§£äº†å¦‚ä½•ä½¿ç”¨ RTCPeerConnection å¯¹è±¡ï¼Œé‚£ä½ æ˜¯å¦å¯ä»¥å°†äºŒè€…ç»“åˆèµ·æ¥å®ç°ä¸€ä¸ªç®€å•çš„ 1å¯¹1 ç³»ç»Ÿäº†å‘¢ï¼Ÿ</p><p>æ¬¢è¿åœ¨ç•™è¨€åŒºä¸æˆ‘åˆ†äº«ä½ çš„æƒ³æ³•ï¼Œä¹Ÿæ¬¢è¿ä½ åœ¨ç•™è¨€åŒºè®°å½•ä½ çš„æ€è€ƒè¿‡ç¨‹ã€‚æ„Ÿè°¢é˜…è¯»ï¼Œå¦‚æœä½ è§‰å¾—è¿™ç¯‡æ–‡ç« å¯¹ä½ æœ‰å¸®åŠ©çš„è¯ï¼Œä¹Ÿæ¬¢è¿æŠŠå®ƒåˆ†äº«ç»™æ›´å¤šçš„æœ‹å‹ã€‚</p><p><a href=\"https://github.com/avdance/webrtc_web/tree/master/12_peerconnection\">æ‰€åšDemoçš„GitHubé“¾æ¥ï¼ˆæœ‰éœ€è¦å¯ä»¥ç‚¹è¿™é‡Œï¼‰</a></p><p></p>","comments":[{"had_liked":false,"id":122758,"user_name":"è®¸ç«¥ç«¥","can_delete":false,"product_type":"c1","uid":1003005,"ip_address":"","ucode":"4B799C0C6BC678","user_header":"https://static001.geekbang.org/account/avatar/00/0f/4d/fd/0aa0e39f.jpg","comment_is_top":false,"comment_ctime":1565513760,"is_pvip":false,"discussion_count":1,"race_medal":0,"score":"31630284832","product_id":100031801,"comment_content":"è¯»å®Œè¿™ä¸€è®²ï¼Œè®°ä½ä¸€å¥è¯å°±å¯ä»¥äº†ã€‚<br>RTCPeerConnectionå°±æ˜¯ä¸€ä¸ªåŠŸèƒ½è¶…å¼ºçš„ socketï¼","like_count":8,"discussions":[{"author":{"id":1629580,"avatar":"https://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTLicMlfGiaCDv9k79AcjibpQBCs3gMJA3ZTTicU9rNGQuD2MDacSWdadDeErz2Fsn7jn1atU5fxbozChw/132","nickname":"Geek_ce4e69","note":"","ucode":"70487380D50BD3","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":212299,"discussion_content":"è¿™ä¸ªæ¯”å–»ç¡®å®å¾ˆåƒï¼ŒPeerConnectionä¹Ÿåƒsocketä¸€æ ·å®Œæˆäº†å»ºè¿å’Œæ•°ä¼ ä¸¤ä¸ªåŠŸèƒ½ï¼Œå®ƒæ˜¯ä¸ªç¼–ç¨‹æ¦‚å¿µï¼Œè€Œä¸æ˜¯ä¸ªé€šä¿¡æ¦‚å¿µ","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1584957189,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":122547,"user_name":"forever","can_delete":false,"product_type":"c1","uid":1049967,"ip_address":"","ucode":"5B9409BED703BA","user_header":"https://static001.geekbang.org/account/avatar/00/10/05/6f/4f5e9789.jpg","comment_is_top":false,"comment_ctime":1565421388,"is_pvip":false,"replies":[{"id":"44998","content":"iOSç«¯åªèƒ½ç”¨ safariï¼Œå…¶å®ƒçš„æµè§ˆå™¨éƒ½ä¸èƒ½ç”¨ webrtcï¼Œä¹‹æ‰€ä»¥è¿™æ ·æ˜¯å› ä¸ºè‹¹æœä¸å…è®¸å…¶å®ƒæµè§ˆå™¨è®¿é—®åº•å±‚ APIï¼Œåªèƒ½é€šè¿‡ webviewå®ç°æµè§ˆå™¨ã€‚å› æ­¤ä½ ä¼šå‘ç°åœ¨iOSä¸Šåªæœ‰ safariæ‰èƒ½è®¿é—®ä¸“æ ä¸­è®²è§£çš„é‚£äº›API","user_name":"ä½œè€…å›å¤","comment_id":122547,"uid":"1507837","ip_address":"","utype":1,"ctime":1565455853,"user_name_real":"garrylee"}],"discussion_count":1,"race_medal":0,"score":"23040257868","product_id":100031801,"comment_content":"è€å¸ˆæ‚¨å¥½ï¼Œæˆ‘æƒ³è¯·æ•™ä¸€ä¸‹å¦‚ä½•è§£å†³webrtc å…¼å®¹æ€§çš„é—®é¢˜ï¼Œç‰¹åˆ«æ˜¯åœ¨iosç«¯ä½¿ç”¨è…¾è®¯x5å†…æ ¸çš„æ—¶å€™","like_count":6,"discussions":[{"author":{"id":1507837,"avatar":"https://static001.geekbang.org/account/avatar/00/17/01/fd/69869646.jpg","nickname":"éŸ³è§†é¢‘ä¸“å®¶-æè¶…","note":"","ucode":"5557943CF28441","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":462304,"discussion_content":"iOSç«¯åªèƒ½ç”¨ safariï¼Œå…¶å®ƒçš„æµè§ˆå™¨éƒ½ä¸èƒ½ç”¨ webrtcï¼Œä¹‹æ‰€ä»¥è¿™æ ·æ˜¯å› ä¸ºè‹¹æœä¸å…è®¸å…¶å®ƒæµè§ˆå™¨è®¿é—®åº•å±‚ APIï¼Œåªèƒ½é€šè¿‡ webviewå®ç°æµè§ˆå™¨ã€‚å› æ­¤ä½ ä¼šå‘ç°åœ¨iOSä¸Šåªæœ‰ safariæ‰èƒ½è®¿é—®ä¸“æ ä¸­è®²è§£çš„é‚£äº›API","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1565455853,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":178813,"user_name":"dayu","can_delete":false,"product_type":"c1","uid":1214458,"ip_address":"","ucode":"1C21338B85EADA","user_header":"https://static001.geekbang.org/account/avatar/00/12/87/fa/403e82ea.jpg","comment_is_top":false,"comment_ctime":1581833790,"is_pvip":false,"replies":[{"id":"70150","content":"å¯ä»¥ï¼Œé™¤éä½ ä»¬å…¬å¸å†…éƒ¨å¯¹ P2P åšäº†é™åˆ¶","user_name":"ä½œè€…å›å¤","comment_id":178813,"uid":"1507837","ip_address":"","utype":1,"ctime":1582429706,"user_name_real":"garrylee"}],"discussion_count":2,"race_medal":0,"score":"10171768382","product_id":100031801,"comment_content":"è€å¸ˆï¼Œè¯·é—®ä¸€ä¸‹ï¼Œå¦‚æœåœ¨å±€åŸŸç½‘å†…è¿›è¡Œä¸€å¯¹ä¸€é€šè¯ï¼Œæ˜¯ä¸æ˜¯å¯ä»¥ä¸æ­å»ºSTUN\\TURNæœåŠ¡å™¨ï¼Ÿ","like_count":2,"discussions":[{"author":{"id":1507837,"avatar":"https://static001.geekbang.org/account/avatar/00/17/01/fd/69869646.jpg","nickname":"éŸ³è§†é¢‘ä¸“å®¶-æè¶…","note":"","ucode":"5557943CF28441","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":483975,"discussion_content":"å¯ä»¥ï¼Œé™¤éä½ ä»¬å…¬å¸å†…éƒ¨å¯¹ P2P åšäº†é™åˆ¶","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1582429706,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":2076242,"avatar":"http://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTKcwxhdFicBaG4zozbxwNa1K5slcRP7ia3iacjWf5odJO4WtvFDJlztDRFKRddAAVHwlIS5CatQMD5wA/132","nickname":"Geek_7afbfc","note":"","ucode":"8DCC72A80687E1","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":297075,"discussion_content":"è€å¸ˆï¼Œå¦‚æœå®Œå…¨æ˜¯å†…ç½‘ï¼Œé‚£new RTCPeerConnection(config)ä¸­çš„configåˆå¦‚ä½•é…ç½®å‘¢ï¼ŒiceServersåˆè¯¥å¦‚ä½•é…ç½®å‘¢","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1596766840,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":257645,"user_name":"Bubbly","can_delete":false,"product_type":"c1","uid":1932887,"ip_address":"","ucode":"5AAAFDBCBC4CEB","user_header":"https://static001.geekbang.org/account/avatar/00/1d/7e/57/588337e9.jpg","comment_is_top":false,"comment_ctime":1604048506,"is_pvip":false,"replies":[{"id":"94537","content":"æ˜¯çš„ï¼ŒåŸå› åœ¨äºWebRTCåº•å±‚éƒ½æ˜¯ä»¥ track ä¸ºå•ä½çš„ï¼Œè€Œä¸”ä½¿ç”¨track æ›´çµæ´»ï¼ŒéŸ³é¢‘ä¸è§†é¢‘å¯ä»¥éšéŸ³ç»„åˆ","user_name":"ä½œè€…å›å¤","comment_id":257645,"uid":"1507837","ip_address":"","utype":1,"ctime":1605003232,"user_name_real":"éŸ³è§†é¢‘ä¸“å®¶-æè¶…"}],"discussion_count":1,"race_medal":0,"score":"5899015802","product_id":100031801,"comment_content":"addStreamå¥½åƒè¦è¢«addTrackæ›¿ä»£äº†ã€‚è€å¸ˆå¯ä»¥åˆ†æä¸‹ä½¿ç”¨addTrackæ¥æ›¿ä»£addStreamçš„åŸå› å—ï¼Ÿ","like_count":1,"discussions":[{"author":{"id":1507837,"avatar":"https://static001.geekbang.org/account/avatar/00/17/01/fd/69869646.jpg","nickname":"éŸ³è§†é¢‘ä¸“å®¶-æè¶…","note":"","ucode":"5557943CF28441","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":508402,"discussion_content":"æ˜¯çš„ï¼ŒåŸå› åœ¨äºWebRTCåº•å±‚éƒ½æ˜¯ä»¥ track ä¸ºå•ä½çš„ï¼Œè€Œä¸”ä½¿ç”¨track æ›´çµæ´»ï¼ŒéŸ³é¢‘ä¸è§†é¢‘å¯ä»¥éšéŸ³ç»„åˆ","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1605003232,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":223876,"user_name":"Random","can_delete":false,"product_type":"c1","uid":1630111,"ip_address":"","ucode":"4E164C8CF487FA","user_header":"https://static001.geekbang.org/account/avatar/00/18/df/9f/6db75dff.jpg","comment_is_top":false,"comment_ctime":1591200370,"is_pvip":false,"replies":[{"id":"84443","content":"è¿™ä¸ªä½ è¦æ£€æµ‹&quot;iceConnectionState&quot;çš„å€¼äº†ï¼Œå…¶ä¸­æˆ‘ä»¬æ„Ÿå…´è¶£çš„æ˜¯disconnectedå’Œfailedä¸¤ä¸ªçŠ¶æ€ï¼Œdisconnected è¡¨å¼æ–­è¿äº†ï¼Œfailedè¡¨ç¤ºç»å¤šæ¬¡å¿è¯•ä»æ— æ³•æ¢å¤ã€‚æ‰€ä»¥å½“ä½ æ£€æµ‹åˆ° failedæ—¶å°±å¯ä»¥é‡å¯ ICE äº†","user_name":"ä½œè€…å›å¤","comment_id":223876,"uid":"1507837","ip_address":"","utype":1,"ctime":1592879320,"user_name_real":"éŸ³è§†é¢‘ä¸“å®¶-æè¶…"}],"discussion_count":2,"race_medal":0,"score":"5886167666","product_id":100031801,"comment_content":"è€å¸ˆä½ å¥½ï¼Œé€šè¯è¿‡ç¨‹ä¸­çš„ice restartçš„è§¦å‘æ—¶æœºé€‰æ‹©ä»€ä¹ˆæ—¶å€™æ¯”è¾ƒå¥½å‘¢ï¼Ÿ","like_count":1,"discussions":[{"author":{"id":1507837,"avatar":"https://static001.geekbang.org/account/avatar/00/17/01/fd/69869646.jpg","nickname":"éŸ³è§†é¢‘ä¸“å®¶-æè¶…","note":"","ucode":"5557943CF28441","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":497277,"discussion_content":"è¿™ä¸ªä½ è¦æ£€æµ‹&amp;quot;iceConnectionState&amp;quot;çš„å€¼äº†ï¼Œå…¶ä¸­æˆ‘ä»¬æ„Ÿå…´è¶£çš„æ˜¯disconnectedå’Œfailedä¸¤ä¸ªçŠ¶æ€ï¼Œdisconnected è¡¨å¼æ–­è¿äº†ï¼Œfailedè¡¨ç¤ºç»å¤šæ¬¡å¿è¯•ä»æ— æ³•æ¢å¤ã€‚æ‰€ä»¥å½“ä½ æ£€æµ‹åˆ° failedæ—¶å°±å¯ä»¥é‡å¯ ICE äº†","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1592879320,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":1,"child_discussions":[{"author":{"id":1591737,"avatar":"http://thirdwx.qlogo.cn/mmopen/vi_32/DYAIOgq83eqRISt77TSBaW0yEoqmoznG7ib6d2emEVUlbZsicnZcWXr15gWjQxE025uIviaaCmR61DLBEPftUH94Q/132","nickname":"äº§å“å¹³å°å¼€å‘éƒ¨","note":"","ucode":"08986FE11A5376","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":1507837,"avatar":"https://static001.geekbang.org/account/avatar/00/17/01/fd/69869646.jpg","nickname":"éŸ³è§†é¢‘ä¸“å®¶-æè¶…","note":"","ucode":"5557943CF28441","race_medal":0,"user_type":2,"is_pvip":false},"discussion":{"id":575703,"discussion_content":"è€å¸ˆï¼Œä»€ä¹ˆæƒ…å†µä¼šå¯¼è‡´failed","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1655040662,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":497277,"ip_address":""},"score":575703,"extra":""}]}]},{"had_liked":false,"id":162916,"user_name":"Jackson","can_delete":false,"product_type":"c1","uid":1061404,"ip_address":"","ucode":"FD22D39510CF8C","user_header":"https://static001.geekbang.org/account/avatar/00/10/32/1c/3e3cdad2.jpg","comment_is_top":false,"comment_ctime":1576631052,"is_pvip":false,"replies":[{"id":"62489","content":"æ˜¯çš„ï¼","user_name":"ä½œè€…å›å¤","comment_id":162916,"uid":"1507837","ip_address":"","utype":1,"ctime":1577025037,"user_name_real":"garrylee"}],"discussion_count":1,"race_medal":0,"score":"5871598348","product_id":100031801,"comment_content":"è¿™ä¸ªä¾‹å­æ˜¯webrtcå®˜æ–¹çš„å§ï¼Ÿ","like_count":1,"discussions":[{"author":{"id":1507837,"avatar":"https://static001.geekbang.org/account/avatar/00/17/01/fd/69869646.jpg","nickname":"éŸ³è§†é¢‘ä¸“å®¶-æè¶…","note":"","ucode":"5557943CF28441","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":478177,"discussion_content":"æ˜¯çš„ï¼","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1577025037,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":123775,"user_name":"xilie","can_delete":false,"product_type":"c1","uid":1013805,"ip_address":"","ucode":"AFCC4E157F7830","user_header":"https://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTJVegfjqa0gM4hcRrBhZkIf7Uc5oeTMYsg6o5pd76IQlUoIIh2ic6P22xVEFtRnAzjyLtiaPVstkKug/132","comment_is_top":false,"comment_ctime":1565754773,"is_pvip":false,"replies":[{"id":"45485","content":"ğŸ˜„ï¼Œåè®®çš„å†…å®¹ç›¸å¯¹æ¥è¯´ç¨éš¾äº†ä¸€äº›ï¼Œè€ŒçŸ¥è¯†çš„ç†è§£ä¹Ÿéœ€è¦ä¸€ä¸ªæ—¶é—´è¿‡ç¨‹","user_name":"ä½œè€…å›å¤","comment_id":123775,"uid":"1507837","ip_address":"","utype":1,"ctime":1565796098,"user_name_real":"garrylee"}],"discussion_count":1,"race_medal":0,"score":"5860722069","product_id":100031801,"comment_content":"å‰é¢çœ‹ä¸æ‡‚ï¼Œåˆ°è¿™æ‰æœ‰æ„Ÿè§‰ï¼Œåˆå¾—å›å¤´å»çœ‹å‰é¢çš„åè®®ï¼Œå»ºè®®å‡¡äº‹å…ˆä¸Šèƒ½è·‘èµ·æ¥çš„ä»£ç ï¼Œå†é€æ­¥è§£å‰–åè®®ï¼Œå¥½ä¸€ç‚¹","like_count":1,"discussions":[{"author":{"id":1507837,"avatar":"https://static001.geekbang.org/account/avatar/00/17/01/fd/69869646.jpg","nickname":"éŸ³è§†é¢‘ä¸“å®¶-æè¶…","note":"","ucode":"5557943CF28441","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":462809,"discussion_content":"ğŸ˜„ï¼Œåè®®çš„å†…å®¹ç›¸å¯¹æ¥è¯´ç¨éš¾äº†ä¸€äº›ï¼Œè€ŒçŸ¥è¯†çš„ç†è§£ä¹Ÿéœ€è¦ä¸€ä¸ªæ—¶é—´è¿‡ç¨‹","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1565796098,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":288381,"user_name":"Her later","can_delete":false,"product_type":"c1","uid":2033044,"ip_address":"","ucode":"85BDB2DC93C0F2","user_header":"https://static001.geekbang.org/account/avatar/00/1f/05/94/e55abef3.jpg","comment_is_top":false,"comment_ctime":1618449677,"is_pvip":false,"replies":[{"id":"105427","content":"oncandidateæ˜¯webrtc åº•å±‚æ”¶é›†åˆ°æœ¬æœºè‡ªå·±çš„Candidate æ—¶é€šçŸ¥ä¸Šå±‚åº”ç”¨çš„å›è°ƒå‡½æ•°å‘€ï¼Œä½ åº”è¯¥æ˜¯è¿˜æ²¡çœ‹æ‡‚è¿™å¿«é€»è¾‘","user_name":"ä½œè€…å›å¤","comment_id":288381,"uid":"1507837","ip_address":"","utype":1,"ctime":1619871281,"user_name_real":"éŸ³è§†é¢‘ä¸“å®¶-æè¶…"}],"discussion_count":1,"race_medal":0,"score":"1618449677","product_id":100031801,"comment_content":"åœ¨çœŸå®çš„åœºæ™¯ä¸­ï¼Œæ¯å½“è·å¾—ä¸€ä¸ªæ–°çš„ Candidate åï¼Œå°±ä¼šé€šè¿‡ä¿¡ä»¤æœåŠ¡å™¨äº¤æ¢ç»™å¯¹ç«¯ï¼Œå¯¹ç«¯å†è°ƒç”¨ RTCPeerConnection å¯¹è±¡çš„ addIceCandidate() æ–¹æ³•å°†æ”¶åˆ°çš„ Candidate ä¿å­˜èµ·æ¥ï¼Œç„¶åæŒ‰ç…§ Candidate çš„ä¼˜å…ˆçº§è¿›è¡Œè¿é€šæ€§æ£€æµ‹ã€‚<br><br>çœŸå®åœºæ™¯ä¸­ï¼Œåº”è¯¥æ˜¯candidate éƒ½æ˜¯é€šè¿‡ä¿¡ä»¤æœåŠ¡å™¨è½¬å‘çš„å§ï¼Œrtcpeerconnectionå¹¶ä¸ä¼šæ”¶åˆ°oncandidate çš„å›è°ƒï¼Œä¸çŸ¥é“æˆ‘ç†è§£æ˜¯å¦æ­£ç¡®ï¼Ÿ","like_count":0,"discussions":[{"author":{"id":1507837,"avatar":"https://static001.geekbang.org/account/avatar/00/17/01/fd/69869646.jpg","nickname":"éŸ³è§†é¢‘ä¸“å®¶-æè¶…","note":"","ucode":"5557943CF28441","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":518610,"discussion_content":"oncandidateæ˜¯webrtc åº•å±‚æ”¶é›†åˆ°æœ¬æœºè‡ªå·±çš„Candidate æ—¶é€šçŸ¥ä¸Šå±‚åº”ç”¨çš„å›è°ƒå‡½æ•°å‘€ï¼Œä½ åº”è¯¥æ˜¯è¿˜æ²¡çœ‹æ‡‚è¿™å¿«é€»è¾‘","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1619871281,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":287322,"user_name":"Her later","can_delete":false,"product_type":"c1","uid":2033044,"ip_address":"","ucode":"85BDB2DC93C0F2","user_header":"https://static001.geekbang.org/account/avatar/00/1f/05/94/e55abef3.jpg","comment_is_top":false,"comment_ctime":1617881874,"is_pvip":false,"replies":[{"id":"104324","content":"å¤šäººè®¢é˜…ä½¿ç”¨nginx+rtmp çš„æ–¹å¼","user_name":"ä½œè€…å›å¤","comment_id":287322,"uid":"1507837","ip_address":"","utype":1,"ctime":1617899018,"user_name_real":"éŸ³è§†é¢‘ä¸“å®¶-æè¶…"}],"discussion_count":1,"race_medal":0,"score":"1617881874","product_id":100031801,"comment_content":"è¿™ç¯‡æ–‡ç« è§£æäº† å¦‚ä½•ç«¯å¯¹ç«¯çš„æ¨æ‹‰æµ ï¼Œä½†æ˜¯å¦‚æœæˆ‘è¦å°†æµæ¨åˆ°æœåŠ¡å™¨ ï¼Œå…¶ä»–å¾ˆå¤šäººè®¢é˜…æœåŠ¡å™¨çš„æµè€æ’­æ”¾ ï¼Œåˆè¯¥æ€æ ·å®ç°å‘¢ ï¼Œæœ‰æ²¡æœ‰ä¸“é—¨çš„æ–‡ç« ä»‹ç» ï¼Œæœ‰çš„è¯ ï¼Œæˆ‘å°±ä¹°äº† ã€‚","like_count":0,"discussions":[{"author":{"id":1507837,"avatar":"https://static001.geekbang.org/account/avatar/00/17/01/fd/69869646.jpg","nickname":"éŸ³è§†é¢‘ä¸“å®¶-æè¶…","note":"","ucode":"5557943CF28441","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":518270,"discussion_content":"å¤šäººè®¢é˜…ä½¿ç”¨nginx+rtmp çš„æ–¹å¼","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1617899018,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":281212,"user_name":"npersonal","can_delete":false,"product_type":"c1","uid":1337630,"ip_address":"","ucode":"060839D2BF5E33","user_header":"http://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTKOCkbWo7KTAUYkTk5sqgOSAdjS51ZH8bTxiaBNLVnIFUOMsicBHRJBoXSOX6sZp5uORE2waGyz3ysw/132","comment_is_top":false,"comment_ctime":1614647546,"is_pvip":false,"replies":[{"id":"103794","content":"é‚£è‚¯å®šæ˜¯ç¼–ç å¤±è´¥çš„","user_name":"ä½œè€…å›å¤","comment_id":281212,"uid":"1507837","ip_address":"","utype":1,"ctime":1617072415,"user_name_real":"éŸ³è§†é¢‘ä¸“å®¶-æè¶…"}],"discussion_count":1,"race_medal":0,"score":"1614647546","product_id":100031801,"comment_content":"è€å¸ˆï¼Œç¼–è§£ç æ²¡æœ‰è®²è§£å—ã€‚æˆ‘ç°åœ¨ç¢°åˆ°ä¸ªé—®é¢˜ï¼Œä½¿ç”¨h264ç¼–ç ï¼Œstreamçš„widthå’Œheightéƒ½ä¸º0ï¼Œè¿™æ˜¯ä»€ä¹ˆåŸå› ","like_count":0,"discussions":[{"author":{"id":1507837,"avatar":"https://static001.geekbang.org/account/avatar/00/17/01/fd/69869646.jpg","nickname":"éŸ³è§†é¢‘ä¸“å®¶-æè¶…","note":"","ucode":"5557943CF28441","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":516326,"discussion_content":"é‚£è‚¯å®šæ˜¯ç¼–ç å¤±è´¥çš„","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1617072415,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":274710,"user_name":"åæ–—ç°¸ç®•","can_delete":false,"product_type":"c1","uid":1276938,"ip_address":"","ucode":"D661B1B42694FC","user_header":"https://static001.geekbang.org/account/avatar/00/13/7c/0a/8aa06f3f.jpg","comment_is_top":false,"comment_ctime":1611133888,"is_pvip":false,"replies":[{"id":"103798","content":"ä½ è¯´çš„æ˜¯è¿œç¨‹æ§åˆ¶ï¼Œç›®å‰æ²¡çœ‹åˆ°webrtc ï¼Œæ”¯æŒè¿™ä¸ªåŠŸèƒ½ã€‚","user_name":"ä½œè€…å›å¤","comment_id":274710,"uid":"1507837","ip_address":"","utype":1,"ctime":1617072919,"user_name_real":"éŸ³è§†é¢‘ä¸“å®¶-æè¶…"}],"discussion_count":1,"race_medal":0,"score":"1611133888","product_id":100031801,"comment_content":"æœ‰è¿™æ ·ä¸€ä¸ªåœºæ™¯ï¼Œä¸»æœºï¼ˆPCï¼‰é‡‡é›†éŸ³è§†é¢‘ç„¶åæ¨é€åˆ°å®¢æˆ·ç«¯æµè§ˆå™¨ï¼Œç±»ä¼¼vncåªä¸è¿‡å®¢æˆ·ç«¯æ˜¯é€šè¿‡æµè§ˆå™¨æ¥æ“ä½œï¼Œè¯·é—®è€å¸ˆè¿™ç±»çš„ä¸šåŠ¡åœºæ™¯webrtcèƒ½æ”¯æŒå—ï¼Ÿå¦‚æœèƒ½æ–¹é¢è®²ä¸€ä¸‹æ¡†æ¶æµç¨‹å—ï¼Ÿè°¢è°¢","like_count":0,"discussions":[{"author":{"id":1507837,"avatar":"https://static001.geekbang.org/account/avatar/00/17/01/fd/69869646.jpg","nickname":"éŸ³è§†é¢‘ä¸“å®¶-æè¶…","note":"","ucode":"5557943CF28441","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":514093,"discussion_content":"ä½ è¯´çš„æ˜¯è¿œç¨‹æ§åˆ¶ï¼Œç›®å‰æ²¡çœ‹åˆ°webrtc ï¼Œæ”¯æŒè¿™ä¸ªåŠŸèƒ½ã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1617072919,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":255008,"user_name":"Zgjian","can_delete":false,"product_type":"c1","uid":1816890,"ip_address":"","ucode":"52C0506149D2C6","user_header":"https://static001.geekbang.org/account/avatar/00/1b/b9/3a/1f9308e6.jpg","comment_is_top":false,"comment_ctime":1603249102,"is_pvip":false,"replies":[{"id":"94543","content":"æŸ¥ä¸€ä¸‹replaceTrackè¿™ä¸ªAPI","user_name":"ä½œè€…å›å¤","comment_id":255008,"uid":"1507837","ip_address":"","utype":1,"ctime":1605003848,"user_name_real":"éŸ³è§†é¢‘ä¸“å®¶-æè¶…"}],"discussion_count":1,"race_medal":0,"score":"1603249102","product_id":100031801,"comment_content":"è€å¸ˆæ‚¨å¥½ï¼Œè¯·é—®ä¸‹åœ¨é€šè¯è¿‡ç¨‹ä¸­åˆ‡æ¢æ‘„åƒå¤´è¿˜æœ‰ä¿®æ”¹åˆ†è¾¨ç‡æ€ä¹ˆåšï¼Œæœ‰å“ªäº›å…³é”®æ¥å£ï¼Ÿ","like_count":0,"discussions":[{"author":{"id":1507837,"avatar":"https://static001.geekbang.org/account/avatar/00/17/01/fd/69869646.jpg","nickname":"éŸ³è§†é¢‘ä¸“å®¶-æè¶…","note":"","ucode":"5557943CF28441","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":507583,"discussion_content":"æŸ¥ä¸€ä¸‹replaceTrackè¿™ä¸ªAPI","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1605003848,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":221952,"user_name":"gseng","can_delete":false,"product_type":"c1","uid":1322277,"ip_address":"","ucode":"2910E1D7B7F7A3","user_header":"https://static001.geekbang.org/account/avatar/00/14/2d/25/87eb82da.jpg","comment_is_top":false,"comment_ctime":1590640115,"is_pvip":false,"replies":[{"id":"84445","content":"ä¸€æ—¦è¿æ¥å»ºç«‹æˆåŠŸä¹‹åï¼Œå°±ä¸å†æ”¶é›†Candidateäº†","user_name":"ä½œè€…å›å¤","comment_id":221952,"uid":"1507837","ip_address":"","utype":1,"ctime":1592879479,"user_name_real":"éŸ³è§†é¢‘ä¸“å®¶-æè¶…"}],"discussion_count":1,"race_medal":0,"score":"1590640115","product_id":100031801,"comment_content":"Candidateä¼šåœ¨ç›´æ’­çš„è¿‡ç¨‹ä¸­ä¸€ç›´æœ‰å˜åŒ–å—ï¼Ÿ è¿˜æ˜¯è¯´åœ¨ç›´æ’­å»ºç«‹ä¹‹å‰ä¸¤ç«¯äº¤äº’å®ŒCandidateä¹‹åï¼Œå°±ä¸å†å˜åŒ–äº†ï¼Ÿ ","like_count":0,"discussions":[{"author":{"id":1507837,"avatar":"https://static001.geekbang.org/account/avatar/00/17/01/fd/69869646.jpg","nickname":"éŸ³è§†é¢‘ä¸“å®¶-æè¶…","note":"","ucode":"5557943CF28441","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":496624,"discussion_content":"ä¸€æ—¦è¿æ¥å»ºç«‹æˆåŠŸä¹‹åï¼Œå°±ä¸å†æ”¶é›†Candidateäº†","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1592879479,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":200901,"user_name":"å´å›½å¹¿","can_delete":false,"product_type":"c1","uid":1821870,"ip_address":"","ucode":"587591E5BFD088","user_header":"http://thirdwx.qlogo.cn/mmopen/vi_32/ohqW1PaxHqyeZFw0SDvQRUeeMDmbcKwicYOS1u5S3jA5jrfMwwnGITEf4UCF1oC8E0OJppeWZ8DvWS1843RI6BQ/132","comment_is_top":false,"comment_ctime":1585670341,"is_pvip":false,"replies":[{"id":"76544","content":"æ•°æ®æ²¡è¿‡æ¥å§","user_name":"ä½œè€…å›å¤","comment_id":200901,"uid":"1507837","ip_address":"","utype":1,"ctime":1586485115,"user_name_real":"garrylee"}],"discussion_count":1,"race_medal":0,"score":"1585670341","product_id":100031801,"comment_content":"è€å¸ˆ åœ¨addstreamäº‹ä»¶è·å–åˆ°MediaStream  å  video  æ’­æ”¾ä»€ä¹ˆéƒ½æ²¡æœ‰  ä¹Ÿæ²¡æŠ¥é”™  å¯èƒ½æ˜¯å•¥åŸå› ","like_count":0,"discussions":[{"author":{"id":1507837,"avatar":"https://static001.geekbang.org/account/avatar/00/17/01/fd/69869646.jpg","nickname":"éŸ³è§†é¢‘ä¸“å®¶-æè¶…","note":"","ucode":"5557943CF28441","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":490171,"discussion_content":"æ•°æ®æ²¡è¿‡æ¥å§","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1586485115,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":185988,"user_name":"zhushengtong","can_delete":false,"product_type":"c1","uid":1756223,"ip_address":"","ucode":"01D2220952B046","user_header":"http://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTKYZ3GU02RDb9oZpibyYS3KdUIfh6MpZ7K6Hgicib6zZcJG4vb71FaTkmvL9IltWtQP7tPWjOCulTZLg/132","comment_is_top":false,"comment_ctime":1583738413,"is_pvip":false,"replies":[{"id":"73331","content":"å®é™…ä¸Šè¿™é‡Œæœ€å…³é”®çš„æ˜¯è¦æœ‰httpsè¯ä¹¦ã€‚å¦‚æœä½ æ²¡æœ‰çš„è¯å¯ä»¥è¦æœ¬æœºæµ‹è¯•ï¼Œè¿™æ ·å°±ä¸ç”¨è¯ä¹¦äº†ã€‚ä¸è¿‡è¿™ç§æµ‹è¯•å•¥ä¹Ÿå¹²ä¸äº†ã€‚","user_name":"ä½œè€…å›å¤","comment_id":185988,"uid":"1507837","ip_address":"","utype":1,"ctime":1584705641,"user_name_real":"garrylee"}],"discussion_count":2,"race_medal":0,"score":"1583738413","product_id":100031801,"comment_content":"è€å¸ˆï¼Œè¯·é—®æ˜¯ä¸æ˜¯å¯ä»¥ä½¿ç”¨è™šæ‹Ÿæœºæ­å»ºæœåŠ¡å™¨å‘¢ï¼Ÿè°¢è°¢ï¼","like_count":0,"discussions":[{"author":{"id":1507837,"avatar":"https://static001.geekbang.org/account/avatar/00/17/01/fd/69869646.jpg","nickname":"éŸ³è§†é¢‘ä¸“å®¶-æè¶…","note":"","ucode":"5557943CF28441","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":486570,"discussion_content":"å®é™…ä¸Šè¿™é‡Œæœ€å…³é”®çš„æ˜¯è¦æœ‰httpsè¯ä¹¦ã€‚å¦‚æœä½ æ²¡æœ‰çš„è¯å¯ä»¥è¦æœ¬æœºæµ‹è¯•ï¼Œè¿™æ ·å°±ä¸ç”¨è¯ä¹¦äº†ã€‚ä¸è¿‡è¿™ç§æµ‹è¯•å•¥ä¹Ÿå¹²ä¸äº†ã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1584705641,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1103540,"avatar":"https://static001.geekbang.org/account/avatar/00/10/d6/b4/0808999d.jpg","nickname":"ç™½é©¬","note":"","ucode":"FD4DA715AC5984","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":310653,"discussion_content":"è€å¸ˆï¼Œä½¿ç”¨http webæœåŠ¡ä¸å¯ä»¥å—ï¼Ÿå¿…é¡»ä½¿ç”¨httpså—ï¼Ÿ","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1601973036,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":177056,"user_name":"Davie Li","can_delete":false,"product_type":"c1","uid":1081882,"ip_address":"","ucode":"E72126F9413C8A","user_header":"https://static001.geekbang.org/account/avatar/00/10/82/1a/8ac9bd45.jpg","comment_is_top":false,"comment_ctime":1581258061,"is_pvip":false,"replies":[{"id":"70155","content":"äºŒè¿›åˆ¶æ•°æ®","user_name":"ä½œè€…å›å¤","comment_id":177056,"uid":"1507837","ip_address":"","utype":1,"ctime":1582429893,"user_name_real":"garrylee"}],"discussion_count":1,"race_medal":0,"score":"1581258061","product_id":100031801,"comment_content":"è€å¸ˆï¼ŒéŸ³è§†é¢‘æµæ˜¯äºŒè¿›åˆ¶æ•°æ®å—ï¼Œè¿˜æ˜¯éŸ³è§†é¢‘ä¸“ç”¨çš„ç±»å‹","like_count":0,"discussions":[{"author":{"id":1507837,"avatar":"https://static001.geekbang.org/account/avatar/00/17/01/fd/69869646.jpg","nickname":"éŸ³è§†é¢‘ä¸“å®¶-æè¶…","note":"","ucode":"5557943CF28441","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":483289,"discussion_content":"äºŒè¿›åˆ¶æ•°æ®","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1582429893,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":165619,"user_name":"tkly","can_delete":false,"product_type":"c1","uid":1619484,"ip_address":"","ucode":"DD22304298BB86","user_header":"http://thirdwx.qlogo.cn/mmopen/vi_32/1hp9kzzuLUVHzmmddIPIO6F0lnSkIJYPcqFK4vmN1HeknaVNicJp7fHx44zP9MHTkiawnDAiaLdCbhmI8ib5LKx2wg/132","comment_is_top":false,"comment_ctime":1577269498,"is_pvip":false,"replies":[{"id":"66617","content":"è‚¯å®šè¦ç¼–ç ï¼Œä¸ç„¶ç½‘ç»œä¸€å®šå°±çˆ†äº†","user_name":"ä½œè€…å›å¤","comment_id":165619,"uid":"1507837","ip_address":"","utype":1,"ctime":1579014949,"user_name_real":"garrylee"}],"discussion_count":1,"race_medal":0,"score":"1577269498","product_id":100031801,"comment_content":"getUserMedia() è·å–åˆ°çš„æœ¬åœ°æµåœ¨å‘é€åˆ°å¯¹ç«¯å‰æœ‰æ²¡æœ‰ç¼–ç ï¼Ÿå¯¹ç«¯æ”¶åˆ°è§†é¢‘æµåœ¨ç»‘å®šåˆ°H5çš„&lt;video&gt;æ ‡ç­¾å‰æœ‰æ²¡æœ‰è§£ç ï¼Ÿæœ‰çš„è¯ï¼Œè¿™ä¸ªç¼–è§£ç è¿‡ç¨‹æ˜¯æ€ä¹ˆæ ·çš„ï¼Ÿ<br>","like_count":0,"discussions":[{"author":{"id":1507837,"avatar":"https://static001.geekbang.org/account/avatar/00/17/01/fd/69869646.jpg","nickname":"éŸ³è§†é¢‘ä¸“å®¶-æè¶…","note":"","ucode":"5557943CF28441","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":479230,"discussion_content":"è‚¯å®šè¦ç¼–ç ï¼Œä¸ç„¶ç½‘ç»œä¸€å®šå°±çˆ†äº†","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1579014949,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":165601,"user_name":"tkly","can_delete":false,"product_type":"c1","uid":1619484,"ip_address":"","ucode":"DD22304298BB86","user_header":"http://thirdwx.qlogo.cn/mmopen/vi_32/1hp9kzzuLUVHzmmddIPIO6F0lnSkIJYPcqFK4vmN1HeknaVNicJp7fHx44zP9MHTkiawnDAiaLdCbhmI8ib5LKx2wg/132","comment_is_top":false,"comment_ctime":1577266971,"is_pvip":false,"replies":[{"id":"66418","content":"éƒ½æ˜¯åœ¨æœ¬åœ°è§£ç è¿›è¡Œæ’­æ”¾å‘€ï¼","user_name":"ä½œè€…å›å¤","comment_id":165601,"uid":"1507837","ip_address":"","utype":1,"ctime":1578898123,"user_name_real":"garrylee"}],"discussion_count":1,"race_medal":0,"score":"1577266971","product_id":100031801,"comment_content":"æˆ‘æœ‰ä¸ªé—®é¢˜ï¼Œæ—¢ç„¶å‘é€å‰è¦è¿›è¡Œç¼–ç ï¼Œé‚£æ˜¯å¦å¯ä»¥ä½¿ç”¨webrtcåœ¨æœ¬åœ°è§£ç h264è§†é¢‘æµè¿›è¡Œæ’­æ”¾å‘¢ï¼Ÿæ—¢ç„¶éœ€è¦ç¼–ç ï¼Œæ˜¯å¦å¯ä»¥ç›´æ¥å‘é€h264ç¼–ç çš„è§†é¢‘æµï¼Œå¯¹ç«¯è§£ç æ’­æ”¾å‘¢ï¼Ÿ","like_count":0,"discussions":[{"author":{"id":1507837,"avatar":"https://static001.geekbang.org/account/avatar/00/17/01/fd/69869646.jpg","nickname":"éŸ³è§†é¢‘ä¸“å®¶-æè¶…","note":"","ucode":"5557943CF28441","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":479220,"discussion_content":"éƒ½æ˜¯åœ¨æœ¬åœ°è§£ç è¿›è¡Œæ’­æ”¾å‘€ï¼","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1578898123,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":150207,"user_name":"LittleJi","can_delete":false,"product_type":"c1","uid":1216722,"ip_address":"","ucode":"111F0E2794BC17","user_header":"https://static001.geekbang.org/account/avatar/00/12/90/d2/a40d7e65.jpg","comment_is_top":false,"comment_ctime":1573478662,"is_pvip":false,"replies":[{"id":"58302","content":"è¿™é‡Œåªè®²äº†åœ¨åŒä¸€ä¸ªæµè§ˆå™¨ä¸¤ä¸ªä¸åŒé¡µè€Œçš„æƒ…å†µã€‚å¯¹äºä¸¤å°ä¸åŒçš„æœºå­ä¹‹é—´çš„é€šä¿¡è¿‡ç¨‹ä¸åœ¨åŒä¸€å°æœºå­åŒä¸€ä¸ªæµè§ˆå™¨ä¸­çš„ä¸¤ä¸ªä¸åŒé¡µé¢ä¹‹é—´çš„é€šä¿¡è¿‡ç¨‹åŸºæœ¬æ˜¯ä¸€æ ·çš„ï¼Œåé¢éƒ½æœ‰è®²åˆ°ï¼Œç»§ç»­å¾€ä¸‹çœ‹å“ˆï¼","user_name":"ä½œè€…å›å¤","comment_id":150207,"uid":"1507837","ip_address":"","utype":1,"ctime":1573780502,"user_name_real":"garrylee"}],"discussion_count":1,"race_medal":0,"score":"1573478662","product_id":100031801,"comment_content":"å› ä¸ºè¿™æ˜¯åœ¨åŒä¸€ä¸ªé¡µé¢ï¼Œæ‰€ä»¥ä¸æ¶‰åŠåˆ°ä¸¤ä¸ªç«¯ä¹‹é—´æ€ä¹ˆè¿æ¥å—ï¼Ÿæ¯”å¦‚ä¸åœ¨åŒä¸€å†…ç½‘çš„è¯ï¼Œæ€ä¹ˆè¿›è¡Œè¿æ¥ï¼ŒNATç©¿è¶Šï¼Ÿå› ä¸ºæ˜¯åŒä¸€ä¸ªç«¯ï¼Œæ‰€ä»¥ipç›¸åŒã€ç«¯å£ä¹Ÿç›¸åŒï¼Œæ˜¯å—ï¼Ÿ","like_count":0,"discussions":[{"author":{"id":1507837,"avatar":"https://static001.geekbang.org/account/avatar/00/17/01/fd/69869646.jpg","nickname":"éŸ³è§†é¢‘ä¸“å®¶-æè¶…","note":"","ucode":"5557943CF28441","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":474094,"discussion_content":"è¿™é‡Œåªè®²äº†åœ¨åŒä¸€ä¸ªæµè§ˆå™¨ä¸¤ä¸ªä¸åŒé¡µè€Œçš„æƒ…å†µã€‚å¯¹äºä¸¤å°ä¸åŒçš„æœºå­ä¹‹é—´çš„é€šä¿¡è¿‡ç¨‹ä¸åœ¨åŒä¸€å°æœºå­åŒä¸€ä¸ªæµè§ˆå™¨ä¸­çš„ä¸¤ä¸ªä¸åŒé¡µé¢ä¹‹é—´çš„é€šä¿¡è¿‡ç¨‹åŸºæœ¬æ˜¯ä¸€æ ·çš„ï¼Œåé¢éƒ½æœ‰è®²åˆ°ï¼Œç»§ç»­å¾€ä¸‹çœ‹å“ˆï¼","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1573780502,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":133249,"user_name":"ç¼–è¯‘ç¼ºé™·","can_delete":false,"product_type":"c1","uid":1644015,"ip_address":"","ucode":"FC0D96DDA0C539","user_header":"https://static001.geekbang.org/account/avatar/00/19/15/ef/8906f082.jpg","comment_is_top":false,"comment_ctime":1568464201,"is_pvip":false,"replies":[{"id":"51073","content":"å½“ç„¶ï¼ŒRTCPeerConnectionå°±æ˜¯ä¼ è¾“æ•°æ®çš„ï¼Œæ— è®ºæ˜¯å“ªä¸ªç«¯éƒ½å¯ä»¥é€šè¿‡ RTCPeerConnection è¿›è¡Œæ•°æ®çš„æ¥æ”¶ä¸å‘é€ï¼Œè¿™åº”è¯¥ä¸Šä¸å®ƒçš„å‚æ•° serveræ²¡å•¥å…³ç³»ã€‚","user_name":"ä½œè€…å›å¤","comment_id":133249,"uid":"1507837","ip_address":"","utype":1,"ctime":1568470421,"user_name_real":"garrylee"}],"discussion_count":1,"race_medal":0,"score":"1568464201","product_id":100031801,"comment_content":"è¿™é‡Œçš„RTCPeerConnectionæ˜¯å®ç°äº†socket,ä½†æ˜¯å¦‚æœè¦è·¨ç«¯çš„è¯. new RTCPeerConnection(server).è¿™é‡Œserverçš„é…ç½®å¯ä»¥æ”¯æŒè·¨ç«¯å—?å¯¹è¿™é‡Œserverçš„ç»†èŠ‚ä¸æ˜¯å¾ˆæ¸…æ¥š.æ€ä¹ˆåšåˆ°æŠŠsteamé€šè¿‡RTCPeerConnectionä¼ ç»™serveræœåŠ¡ç«¯","like_count":0,"discussions":[{"author":{"id":1507837,"avatar":"https://static001.geekbang.org/account/avatar/00/17/01/fd/69869646.jpg","nickname":"éŸ³è§†é¢‘ä¸“å®¶-æè¶…","note":"","ucode":"5557943CF28441","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":467318,"discussion_content":"å½“ç„¶ï¼ŒRTCPeerConnectionå°±æ˜¯ä¼ è¾“æ•°æ®çš„ï¼Œæ— è®ºæ˜¯å“ªä¸ªç«¯éƒ½å¯ä»¥é€šè¿‡ RTCPeerConnection è¿›è¡Œæ•°æ®çš„æ¥æ”¶ä¸å‘é€ï¼Œè¿™åº”è¯¥ä¸Šä¸å®ƒçš„å‚æ•° serveræ²¡å•¥å…³ç³»ã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1568470421,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":130805,"user_name":"Geek_leoé•¿æ²™","can_delete":false,"product_type":"c1","uid":1617384,"ip_address":"","ucode":"2AEEAF499FBDC1","user_header":"","comment_is_top":false,"comment_ctime":1567555455,"is_pvip":false,"replies":[{"id":"49237","content":"è¿™è¿™ä¸“æ æ¶ä¸äº†äº†ï¼Œç§»åŠ¨ç«¯ä¹Ÿæœ‰ä¸€æ‰“å—çŸ¥è¯†ï¼Œç­‰åé¢çš„ä¸“æ å†è§„åˆ’å“ˆ","user_name":"ä½œè€…å›å¤","comment_id":130805,"uid":"1507837","ip_address":"","utype":1,"ctime":1567605042,"user_name_real":"garrylee"}],"discussion_count":2,"race_medal":0,"score":"1567555455","product_id":100031801,"comment_content":"è€å¸ˆèƒ½ä¸èƒ½å¢åŠ ç§»åŠ¨ç«¯çš„æ¡ˆä¾‹è®²è§£","like_count":0,"discussions":[{"author":{"id":1507837,"avatar":"https://static001.geekbang.org/account/avatar/00/17/01/fd/69869646.jpg","nickname":"éŸ³è§†é¢‘ä¸“å®¶-æè¶…","note":"","ucode":"5557943CF28441","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":466138,"discussion_content":"è¿™è¿™ä¸“æ æ¶ä¸äº†äº†ï¼Œç§»åŠ¨ç«¯ä¹Ÿæœ‰ä¸€æ‰“å—çŸ¥è¯†ï¼Œç­‰åé¢çš„ä¸“æ å†è§„åˆ’å“ˆ","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1567605042,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1617384,"avatar":"","nickname":"Geek_leoé•¿æ²™","note":"","ucode":"2AEEAF499FBDC1","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":7690,"discussion_content":"å—¯å—¯ æœŸå¾…å¤§ä½œ","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1567615052,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":122966,"user_name":"Ray-J","can_delete":false,"product_type":"c1","uid":1618642,"ip_address":"","ucode":"EDA67D6215B4D1","user_header":"https://static001.geekbang.org/account/avatar/00/18/b2/d2/01e70940.jpg","comment_is_top":false,"comment_ctime":1565580488,"is_pvip":false,"replies":[{"id":"45219","content":"å°±æ˜¯ &lt;IPï¼Œç«¯å£&gt;å¯¹, å‡è®¾ä½ çš„ä¸»æœºæœ‰ä¸¤ä¸Šç½‘å¡ï¼Œéƒ½ä½¿ç”¨5678è¿™ä¸ªç«¯å£ï¼Œé‚£ä½ å°±æœ‰ä¸¤ä¸ªå€™é€‰è€…ï¼Œå®ƒä»¬åˆ†åˆ«æ˜¯&lt;ç½‘å¡1çš„IPï¼Œ5679&gt;ï¼Œ&lt;ç½‘å¡2IP, 5678&gt;","user_name":"ä½œè€…å›å¤","comment_id":122966,"uid":"1507837","ip_address":"","utype":1,"ctime":1565612147,"user_name_real":"garrylee"}],"discussion_count":1,"race_medal":0,"score":"1565580488","product_id":100031801,"comment_content":"è€å¸ˆ,Candidateçš„ä½œç”¨æ˜¯ç”¨æ¥åšä»€ä¹ˆçš„å‘¢?ç¿»è¯‘è¿‡æ¥ æ˜¯å€™é€‰äºº, å¾ˆéš¾ç†è§£è¿™ä¸ªè¯,å¸Œæœ›èƒ½å¾—åˆ°è€å¸ˆçš„å¸®åŠ©åŠ æ·±ç†è§£","like_count":0,"discussions":[{"author":{"id":1507837,"avatar":"https://static001.geekbang.org/account/avatar/00/17/01/fd/69869646.jpg","nickname":"éŸ³è§†é¢‘ä¸“å®¶-æè¶…","note":"","ucode":"5557943CF28441","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":462481,"discussion_content":"å°±æ˜¯ &amp;lt;IPï¼Œç«¯å£&amp;gt;å¯¹, å‡è®¾ä½ çš„ä¸»æœºæœ‰ä¸¤ä¸Šç½‘å¡ï¼Œéƒ½ä½¿ç”¨5678è¿™ä¸ªç«¯å£ï¼Œé‚£ä½ å°±æœ‰ä¸¤ä¸ªå€™é€‰è€…ï¼Œå®ƒä»¬åˆ†åˆ«æ˜¯&amp;lt;ç½‘å¡1çš„IPï¼Œ5679&amp;gt;ï¼Œ&amp;lt;ç½‘å¡2IP, 5678&amp;gt;","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1565612147,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":122469,"user_name":"Keep-Moving","can_delete":false,"product_type":"c1","uid":1182631,"ip_address":"","ucode":"76F33C06E07A27","user_header":"https://static001.geekbang.org/account/avatar/00/12/0b/a7/6ef32187.jpg","comment_is_top":false,"comment_ctime":1565400371,"is_pvip":false,"replies":[{"id":"44957","content":"æœ‰ï¼Œä»Šå¤©æ™šä¸Šä¼šä¸Šä¼ ä¸Šå»","user_name":"ä½œè€…å›å¤","comment_id":122469,"uid":"1507837","ip_address":"","utype":1,"ctime":1565410010,"user_name_real":"garrylee"}],"discussion_count":1,"race_medal":0,"score":"1565400371","product_id":100031801,"comment_content":"è€å¸ˆï¼Œæœ¬èŠ‚å®Œæ•´çš„ä»£ç githubæœ‰å—ï¼Ÿ","like_count":0,"discussions":[{"author":{"id":1507837,"avatar":"https://static001.geekbang.org/account/avatar/00/17/01/fd/69869646.jpg","nickname":"éŸ³è§†é¢‘ä¸“å®¶-æè¶…","note":"","ucode":"5557943CF28441","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":462265,"discussion_content":"æœ‰ï¼Œä»Šå¤©æ™šä¸Šä¼šä¸Šä¼ ä¸Šå»","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1565410010,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]}]}