{"id":423602,"title":"09 | Bigtableï¼ˆäºŒï¼‰ï¼šä¸è®¤è¯†â€œä¸»äººâ€çš„åˆ†å¸ƒå¼æ¶æ„","content":"<p>ä½ å¥½ï¼Œæˆ‘æ˜¯å¾æ–‡æµ©ã€‚ä¸Šä¸€è®²é‡Œæˆ‘ä»¬ä¸€èµ·åˆ†æäº†å¦‚ä½•å¯¹ä¸€ä¸ªMySQLé›†ç¾¤è¿›è¡Œæ‰©å®¹ï¼Œæ¥æ”¯æ’‘æ›´é«˜çš„éšæœºè¯»å†™è¯·æ±‚ã€‚è€Œåœ¨æ‰©å®¹è¿‡ç¨‹ä¸­é‡åˆ°çš„ç§ç§ä¸ä¾¿ï¼Œä¹Ÿè®©æˆ‘ä»¬æ·±å…¥ç†è§£äº†Bigtableçš„è®¾è®¡ä¸­éœ€è¦é‡ç‚¹è§£å†³çš„é—®é¢˜ã€‚</p><p>ç¬¬ä¸€ä¸ªé—®é¢˜ï¼Œè‡ªç„¶è¿˜æ˜¯å¦‚ä½•æ”¯æ’‘å¥½æ¯ç§’åä¸‡ã€ä¹ƒè‡³ç™¾ä¸‡çº§åˆ«çš„éšæœºè¯»å†™è¯·æ±‚ã€‚</p><p>ç¬¬äºŒä¸ªé—®é¢˜ï¼Œåˆ™æ˜¯å¦‚ä½•è§£å†³å¥½â€œå¯ä¼¸ç¼©æ€§â€å’Œâ€œå¯è¿ç»´æ€§â€çš„é—®é¢˜ã€‚åœ¨ä¸€ä¸ªä¸Šåƒå°æœåŠ¡å™¨çš„é›†ç¾¤ä¸Šï¼ŒBigtableæ€ä¹ˆèƒ½å¤Ÿåšåˆ°è‡ªåŠ¨åˆ†ç‰‡å’Œç¾éš¾æ¢å¤ã€‚</p><p>ä»Šå¤©æˆ‘ä»¬å°±å…ˆæ¥çœ‹çœ‹ç¬¬äºŒä¸ªé—®é¢˜ï¼Œå…¶å®ä¹Ÿæ˜¯Bigtableçš„æ•´ä½“æ¶æ„ã€‚è€Œç¬¬ä¸€ä¸ªé—®é¢˜ï¼Œä¸€åŠè¦ä¾èµ–ç¬¬äºŒä¸ªé—®é¢˜ï¼Œä¹Ÿå°±æ˜¯å¯ä»¥ä¸æ–­å°†é›†ç¾¤æ‰©å®¹åˆ°æˆç™¾ä¸Šåƒä¸ªèŠ‚ç‚¹ã€‚å¦ä¸€åŠï¼Œåˆ™å–å†³äºåœ¨æ¯ä¸€ä¸ªèŠ‚ç‚¹ä¸Šï¼ŒBigtableçš„è¯»å†™æ“ä½œæ˜¯æ€ä¹ˆè¿›è¡Œçš„ï¼Œè¿™ä¸€éƒ¨åˆ†æˆ‘ä»¬ä¼šæ”¾åˆ°ä¸‹ä¸€è®²ï¼Œä¹Ÿå°±æ˜¯Bigtableçš„åº•å±‚å­˜å‚¨SSTableç©¶ç«Ÿæ˜¯æ€ä¹ˆä¸€å›äº‹å„¿ã€‚</p><p>é‚£ä¹ˆæ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬å°±ä¸€èµ·æ¥çœ‹çœ‹Bigtableçš„æ•´ä½“æ¶æ„ã€‚åœ¨å­¦å®Œè¿™ä¸€è®²åï¼Œå¸Œæœ›ä½ å¯ä»¥æŒæ¡Bigtableä¸‰ä¸ªé‡è¦çš„çŸ¥è¯†ç‚¹ï¼š</p><ul>\n<li>ç¬¬ä¸€ä¸ªï¼ŒBigtableæ˜¯å¦‚ä½•è¿›è¡Œæ•°æ®åˆ†åŒºï¼Œä½¿å¾—æ•´ä¸ªé›†ç¾¤çµæ´»å¯æ‰©å±•çš„ï¼›</li>\n<li>ç¬¬äºŒä¸ªï¼ŒBigtableæ˜¯å¦‚ä½•è®¾è®¡ï¼Œä½¿å¾—Masterä¸ä¼šæˆä¸ºå•ç‚¹æ•…éšœï¼Œä¹ƒè‡³å•ç‚¹æ€§èƒ½çš„ç“¶é¢ˆï¼›</li>\n<li>æœ€åï¼Œè‡ªç„¶æ˜¯æ•´ä¸ªBigtableçš„æ•´ä½“æ¶æ„å’Œç»„ä»¶ç”±å“ªäº›ä¸œè¥¿ç»„æˆã€‚</li>\n</ul><!-- [[[read_end]]] --><p>ç›¸ä¿¡åœ¨å­¦å®Œè¿™ä¸€è®²åï¼Œä½ ä¹Ÿèƒ½è‡ªå·±è®¾è®¡ä¸€ä¸ªåˆ†å¸ƒå¼æ•°æ®åº“çš„åŸºæœ¬æ¶æ„ã€‚å¹¶ä¸”ï¼Œä½ ä¹Ÿä¼šå¯¹åˆ†å¸ƒå¼æ•°æ®åº“è®¾è®¡çš„åˆ†åŒºå’Œå¤åˆ¶æœºåˆ¶ã€ç³»ç»Ÿæ•´ä½“æ¶æ„è®¾è®¡ï¼Œä»¥åŠå¦‚ä½•åˆ†æå’Œä¼˜åŒ–æ•´ä¸ªæ¶æ„çš„ç“¶é¢ˆæ‰€åœ¨ï¼Œæœ‰ä¸€ä¸ªæ¸…æ™°çš„äº†è§£ã€‚</p><h2>ç†è§£Bigtableçš„åŸºæœ¬æ•°æ®æ¨¡å‹</h2><p>åœ¨è¿›å…¥åˆ°é’ˆå¯¹Bigtableçš„æ¶æ„è®¾è®¡è§£è¯»ä¹‹å‰ï¼Œæˆ‘ä»¬å…ˆæ¥å¼„æ¸…æ¥šBigtableåŸºæœ¬çš„æ•°æ®æ¨¡å‹ã€‚</p><p>ä¸Šä¸€è®²é‡Œï¼Œæˆ‘ä»¬ä¸¾äº†å¾ˆå¤šMySQLçš„ä¾‹å­ã€‚åœ¨è¿™ä¸ªè¿‡ç¨‹ä¸­ï¼Œç›¸ä¿¡ä½ ä¼šå‘ç°ï¼Œä¸€æ—¦æˆ‘ä»¬å¼€å§‹åˆ†åº“åˆ†è¡¨äº†ï¼Œæˆ‘ä»¬å°±å¾ˆéš¾ä½¿ç”¨å…³ç³»æ•°æ®åº“çš„ä¸€ç³»åˆ—çš„ç‰¹æ€§äº†ã€‚æ¯”å¦‚SQLé‡Œé¢çš„JoinåŠŸèƒ½ï¼Œæˆ–è€…æ˜¯è·¨è¡Œçš„äº‹åŠ¡ã€‚å› ä¸ºè¿™äº›åŠŸèƒ½åœ¨åˆ†åº“åˆ†è¡¨çš„åœºæ™¯ä¸‹ï¼Œéƒ½è¦æ¶‰åŠåˆ°å¤šå°æœåŠ¡å™¨ï¼Œä¸æ˜¯è¯´åšä¸åˆ°ï¼Œä½†æ˜¯é—®é¢˜ä¸€ä¸‹å­å°±å¤æ‚äº†ã€‚</p><p>æ‰€ä»¥ï¼ŒBigtableåœ¨ä¸€å¼€å§‹ï¼Œä¹Ÿä¸å‡†å¤‡å…ˆè€ƒè™‘äº‹åŠ¡ã€Joinç­‰é«˜çº§çš„åŠŸèƒ½ï¼Œè€Œæ˜¯<strong>æŠŠæ ¸å¿ƒæ”¾åœ¨äº†â€œå¯ä¼¸ç¼©æ€§â€ä¸Š</strong>ã€‚å› æ­¤ï¼ŒBigtableè‡ªå·±çš„æ•°æ®æ¨¡å‹ä¹Ÿç‰¹åˆ«ç®€å•ï¼Œæ˜¯ä¸€ä¸ªå¾ˆå®½çš„ç¨€ç–è¡¨ã€‚</p><p>æ¯ä¸€å¼ Bigtableçš„è¡¨éƒ½ç‰¹åˆ«ç®€å•ï¼Œæ¯ä¸€è¡Œå°±æ˜¯ä¸€æ¡æ•°æ®ï¼š</p><ul>\n<li>ä¸€æ¡æ•°æ®é‡Œé¢ï¼Œæœ‰ä¸€ä¸ªè¡Œé”®ï¼ˆRow Keyï¼‰ï¼Œä¹Ÿå°±æ˜¯è¿™æ¡æ•°æ®çš„ä¸»é”®ï¼ŒBigtableæä¾›äº†é€šè¿‡è¿™ä¸ªè¡Œé”®éšæœºè¯»å†™è¿™æ¡è®°å½•çš„æ¥å£ã€‚å› ä¸ºæ€»æ˜¯é€šè¿‡è¡Œé”®æ¥è¯»å†™æ•°æ®ï¼Œæ‰€ä»¥å¾ˆå¤šäººä¹ŸæŠŠè¿™æ ·çš„æ•°æ®åº“å«åš<strong>KVæ•°æ®åº“</strong>ã€‚</li>\n<li>æ¯ä¸€è¡Œé‡Œçš„æ•°æ®å‘¢ï¼Œä½ éœ€è¦æŒ‡å®šä¸€äº›åˆ—æ—ï¼ˆColumn Familyï¼‰ï¼Œæ¯ä¸ªåˆ—æ—ä¸‹ï¼Œä½ ä¸éœ€è¦æŒ‡å®šåˆ—ï¼ˆColumnï¼‰ã€‚<strong>æ¯ä¸€æ¡æ•°æ®éƒ½å¯ä»¥æœ‰å±äºè‡ªå·±çš„åˆ—ï¼Œæ¯ä¸€è¡Œæ•°æ®çš„åˆ—ä¹Ÿå¯ä»¥å®Œå…¨ä¸ä¸€æ ·</strong>ï¼Œå› ä¸ºåˆ—ä¸æ˜¯å›ºå®šçš„ã€‚è¿™ä¸ªæ‰€è°“ä¸æ˜¯å›ºå®šçš„ï¼Œå…¶å®å°±æ˜¯åˆ—ä¸‹é¢æ²¡æœ‰å€¼ã€‚å› ä¸ºBigtableåœ¨åº•å±‚å­˜å‚¨æ•°æ®çš„æ—¶å€™ï¼Œæ¯ä¸€æ¡è®°å½•éƒ½è¦æŠŠåˆ—å’Œå€¼å­˜ä¸‹æ¥ï¼Œæ²¡æœ‰å€¼ï¼Œæ„å‘³ç€å¯¹åº”çš„è¿™ä¸€è¡Œå°±æ²¡æœ‰è¿™ä¸ªåˆ—ã€‚è¿™ä¹Ÿæ˜¯ä¸ºä»€ä¹ˆè¯´Bigtableæ˜¯ä¸€ä¸ªâ€œç¨€ç–â€çš„è¡¨ã€‚</li>\n<li>åˆ—ä¸‹é¢å¦‚æœæœ‰å€¼çš„è¯ï¼Œå¯ä»¥å­˜å‚¨å¤šä¸ªç‰ˆæœ¬ï¼Œä¸åŒç‰ˆæœ¬éƒ½ä¼šå­˜ä¸Šå¯¹åº”ç‰ˆæœ¬çš„æ—¶é—´æˆ³ï¼ˆTimestampï¼‰ï¼Œä½ å¯ä»¥æŒ‡å®šä¿ç•™æœ€è¿‘çš„Nä¸ªç‰ˆæœ¬ï¼ˆæ¯”å¦‚N=3ï¼Œå°±æ˜¯ä¿ç•™æ—¶é—´æˆ³æœ€è¿‘çš„ä¸‰ä¸ªç‰ˆæœ¬ï¼‰ï¼Œä¹Ÿå¯ä»¥æŒ‡å®šä¿ç•™æŸä¸€ä¸ªæ—¶é—´ç‚¹ä¹‹åçš„ç‰ˆæœ¬ã€‚</li>\n</ul><p><img src=\"https://static001.geekbang.org/resource/image/8a/ac/8a03591283de69a12e1b9fe9179815ac.jpg?wh=2000x1125\" alt=\"\"></p><p>å…¶å®ï¼Œè¿™é‡Œçš„æœ‰äº›å‘½åå®¹æ˜“è®©äººè¯¯è§£ï¼Œæ¯”å¦‚åˆ—æ—ï¼Œè¿™ä¸ªåå­—å¾ˆå®¹æ˜“è®©äººè¯¯è§£Bigtableæ˜¯ä¸€ä¸ªåŸºäºåˆ—å­˜å‚¨çš„æ•°æ®åº“ã€‚ä½†äº‹å®å®Œå…¨ä¸æ˜¯è¿™æ ·ï¼Œæˆ‘è§‰å¾—<strong>å¯¹äºåˆ—æ—ï¼Œæ›´åˆç†çš„è§£è¯»æ˜¯ï¼Œå®ƒæ˜¯ä¸€å¼ â€œç‰©ç†è¡¨â€ï¼ŒåŒä¸€ä¸ªåˆ—æ—ä¸‹çš„æ•°æ®ä¼šåœ¨ç‰©ç†ä¸Šå­˜å‚¨åœ¨ä¸€èµ·ã€‚è€Œæ•´ä¸ªè¡¨ï¼Œæ˜¯ä¸€å¼ â€œé€»è¾‘è¡¨â€ã€‚</strong></p><p>åœ¨ç°å®å½“ä¸­ï¼ŒBigtableçš„å¼€æºå®ç°HBaseï¼Œå°±æ˜¯æŠŠæ¯ä¸€ä¸ªåˆ—æ—çš„æ•°æ®å­˜å‚¨åœ¨åŒä¸€ä¸ªHFileæ–‡ä»¶é‡Œã€‚è€Œåœ¨Bigtableçš„è®ºæ–‡ä¸­ï¼ŒGoogleå®šä¹‰äº†ä¸€ä¸ªå«åš<strong>æœ¬åœ°ç»„</strong>ï¼ˆLocality Groupï¼‰çš„æ¦‚å¿µï¼Œæˆ‘ä»¬å¯ä»¥æŠŠå¤šä¸ªåˆ—æ—æ”¾åœ¨åŒä¸€ä¸ªæœ¬åœ°ç»„ä¸­ï¼Œè€ŒåŒä¸€ä¸ªæœ¬åœ°ç»„çš„æ‰€æœ‰åˆ—çš„æ•°æ®ï¼Œéƒ½ä¼šå­˜å‚¨åœ¨åŒä¸€ä¸ªSSTableæ–‡ä»¶é‡Œã€‚</p><p>è¿™ä¸ªè®¾è®¡ï¼Œå°±ä½¿å¾—æˆ‘ä»¬ä¸éœ€è¦é’ˆå¯¹å­—æ®µå¤šçš„æ•°æ®è¡¨ï¼ŒåƒMySQLé‚£æ ·ï¼Œè¿›è¡Œçºµå‘æ‹†è¡¨äº†ã€‚</p><p>Bigtableçš„è¿™ä¸ªæ•°æ®æ¨¡å‹ï¼Œä½¿å¾—æˆ‘ä»¬èƒ½å¾ˆå®¹æ˜“åœ°å»å¢åŠ åˆ—ï¼Œè€Œä¸”å¢åŠ åˆ—å¹¶ä¸ç®—æ˜¯ä¿®æ”¹Bigtableé‡Œä¸€å¼ è¡¨çš„Schemaï¼Œè€Œæ˜¯åœ¨æŸäº›è¿™ä¸ªåˆ—éœ€è¦æœ‰å€¼çš„è¡Œé‡Œé¢ï¼Œç›´æ¥å†™å…¥æ•°æ®å°±å¥½äº†ã€‚è¿™é‡Œçš„åˆ—å’Œå€¼ï¼Œå…¶å®æ˜¯ç›´æ¥ä»¥key-valueé”®å€¼å¯¹çš„å½¢å¼ç›´æ¥å­˜å‚¨ä¸‹æ¥çš„ã€‚</p><p>è¿™ä¸ªçµæ´»ã€ç¨€ç–è€Œåˆå®½çš„è¡¨ï¼Œç‰¹åˆ«é€‚åˆæ—©æœŸçš„äº’è”ç½‘ä¸šåŠ¡ã€‚è™½ç„¶æ•°æ®é‡å¾ˆå¤§ï¼Œä½†æ˜¯æ•°æ®æœ¬èº«çš„Schemaæˆ‘ä»¬å¯èƒ½æ²¡æœ‰æƒ³æ¸…æ¥šï¼ŒåŠ å‡å­—æ®µéƒ½ä¸éœ€è¦åœæœºæˆ–è€…é”è¡¨ã€‚è¦çŸ¥é“ï¼ŒMySQLç›´åˆ°5.5ç‰ˆæœ¬ï¼Œç”¨ALTERå‘½ä»¤ä¿®æ”¹è¡¨ç»“æ„ä»ç„¶éœ€è¦å°†æ•´å¼ è¡¨é”ä½ã€‚å¹¶ä¸”åœ¨é”ä½è¿™å¼ è¡¨çš„æ—¶å€™ï¼Œæˆ‘ä»¬æ˜¯ä¸èƒ½å¾€è¡¨é‡Œå†™æ•°æ®çš„ã€‚å¯¹äºä¸€å¼ æ•°æ®é‡å¾ˆå¤§çš„è¡¨æ¥è¯´ï¼Œè¿™ä¼šè®©æ•´å¼ è¡¨æœ‰å¾ˆé•¿ä¸€æ®µæ—¶é—´ä¸èƒ½å†™å…¥æ•°æ®ã€‚</p><p>è€ŒBigtableè¿™ä¸ªç¨€ç–åˆ—çš„è®¾è®¡ï¼Œå°±ä¸ºæˆ‘ä»¬å¸¦æ¥äº†å¾ˆå¤§çš„çµæ´»æ€§ï¼Œå¦‚åŒã€Šæ¶æ„æ•´æ´ä¹‹é“ã€‹çš„ä½œè€…<a href=\"http://cleancoder.com/products\">Uncle Bob</a>è¯´çš„é‚£æ ·ï¼šâ€œæ¶æ„å¸ˆçš„å·¥ä½œä¸æ˜¯ä½œå‡ºå†³ç­–ï¼Œè€Œæ˜¯å°½å¯èƒ½ä¹…åœ°æ¨è¿Ÿå†³ç­–ï¼Œåœ¨ç°åœ¨ä¸ä½œå‡ºé‡å¤§å†³ç­–çš„æƒ…å†µä¸‹æ„å»ºç¨‹åºï¼Œä»¥ä¾¿ä»¥åæœ‰è¶³å¤Ÿä¿¡æ¯æ—¶å†ä½œå‡ºå†³ç­–ã€‚â€</p><h2>æ•°æ®åˆ†åŒºï¼Œå¯ä¼¸ç¼©çš„ç¬¬ä¸€æ­¥</h2><p>ææ¸…æ¥šäº†Bigtableçš„æ•°æ®æ¨¡å‹ï¼Œæˆ‘ä»¬å†æ¥ä¸€èµ·çœ‹ä¸€çœ‹ï¼ŒBigtableæ˜¯æ€ä¹ˆè§£å†³ä¸Šä¸€è®²MySQLé›†ç¾¤è§£å†³ä¸å¥½çš„<strong>æ°´å¹³åˆ†åº“é—®é¢˜</strong>çš„ã€‚</p><p>æŠŠä¸€ä¸ªæ•°æ®è¡¨ï¼Œæ ¹æ®ä¸»é”®çš„ä¸åŒï¼Œæ‹†åˆ†åˆ°å¤šä¸ªä¸åŒçš„æœåŠ¡å™¨ä¸Šï¼Œåœ¨åˆ†å¸ƒå¼æ•°æ®åº“é‡Œè¢«ç§°ä¹‹ä¸º<strong>æ•°æ®åˆ†åŒº</strong>ï¼ˆ Paritioningï¼‰ã€‚åˆ†åŒºä¹‹åçš„æ¯ä¸€ç‰‡æ•°æ®ï¼Œåœ¨ä¸åŒçš„åˆ†å¸ƒå¼ç³»ç»Ÿé‡Œæœ‰ä¸åŒçš„åå­—ï¼Œåœ¨MySQLé‡Œå‘¢ï¼Œæˆ‘ä»¬ä¸€èˆ¬å«åšShardï¼ŒBigtableé‡Œåˆ™å«åšTabletã€‚</p><p>ä¸Šä¸€è®²é‡Œï¼ŒMySQLé›†ç¾¤çš„åˆ†åŒºä¹‹æ‰€ä»¥é‡åˆ°ç§ç§å›°éš¾ï¼Œæ˜¯å› ä¸ºæˆ‘ä»¬é€šè¿‡å–æ¨¡å‡½æ•°æ¥è¿›è¡Œåˆ†åŒºï¼Œä¹Ÿå°±æ˜¯æ‰€è°“çš„<strong>å“ˆå¸Œåˆ†åŒº</strong>ã€‚æˆ‘ä»¬ä¼šæ‹¿ä¸€ä¸ªå­—æ®µå“ˆå¸Œå–æ¨¡ï¼Œç„¶ååˆ’åˆ†åˆ°é¢„å…ˆå®šå¥½Nä¸ªåˆ†ç‰‡é‡Œé¢ã€‚è¿™é‡Œæœ€å¤§çš„é—®é¢˜ï¼Œåœ¨äºåˆ†åŒºéœ€è¦åœ¨ä¸€å¼€å§‹å°±è®¾è®¡å¥½ï¼Œè€Œä¸æ˜¯è‡ªåŠ¨éšæˆ‘ä»¬çš„æ•°æ®å˜åŒ–åŠ¨æ€è°ƒæ•´çš„ã€‚</p><p>ä½†æ˜¯å¾€å¾€è®¡åˆ’ä¸å¦‚å˜åŒ–å¿«ï¼Œå½“æˆ‘ä»¬çš„ä¸šåŠ¡å˜åŒ–å’Œè®¡åˆ’ç¨æœ‰ä¸åŒï¼Œå°±ä¼šé‡åˆ°éœ€è¦æ¬è¿æ•°æ®æˆ–è€…å„ä¸ªåˆ†ç‰‡è´Ÿè½½ä¸å‡è¡¡çš„æƒ…å†µã€‚ä½ å¯ä»¥çœ‹ä¸€ä¸‹æˆ‘ä»ä¸Šä¸€è®²é‡Œæ¬è¿‡æ¥çš„è¿™å¼ å›¾ï¼Œå½“æˆ‘ä»¬å°†4å°æœåŠ¡å™¨æ‰©å±•åˆ°6å°æœåŠ¡å™¨çš„æ—¶å€™ï¼Œå“ˆå¸Œåˆ†åŒºçš„æ–¹å¼ä½¿å¾—æˆ‘ä»¬è¦åœ¨ç½‘ç»œä¸Šæ¬è¿æ•´ä¸ªæ•°æ®åº“2/3çš„æ•°æ®ã€‚</p><p><img src=\"https://static001.geekbang.org/resource/image/57/72/57f28c2598ec283c97d103c0ccb81572.jpg?wh=1920x1080\" alt=\"å›¾ç‰‡\" title=\"ä¸Šä¸€è®²é‡Œï¼Œæˆ‘ä»¬çœ‹è¿‡è¿™ä¸ªå›¾ç‰‡ï¼Œå“ˆå¸Œåˆ†åŒºå¦‚æœä¸æ˜¯ç¿»å€æ‰©å®¹ï¼Œå°±éœ€è¦æ¬è¿å¤§é‡æ•°æ®\"></p><p>æ‰€ä»¥ï¼Œåœ¨Bigtableé‡Œï¼Œæˆ‘ä»¬å°±é‡‡ç”¨äº†å¦å¤–ä¸€ç§åˆ†åŒºæ–¹å¼ï¼Œä¹Ÿå°±æ˜¯<strong>åŠ¨æ€åŒºé—´åˆ†åŒº</strong>ã€‚æˆ‘ä»¬ä¸å†æ˜¯ä¸€å¼€å§‹å°±å®šä¹‰å¥½éœ€è¦å¤šå°‘ä¸ªæœºå™¨ï¼Œåº”è¯¥æ€ä¹ˆåˆ†åŒºï¼Œè€Œæ˜¯é‡‡ç”¨äº†ä¸€ç§<strong>è‡ªåŠ¨å»â€œåˆ†è£‚â€ï¼ˆsplitï¼‰çš„æ–¹å¼</strong>æ¥åŠ¨æ€åœ°è¿›è¡Œåˆ†åŒºã€‚</p><p>æˆ‘ä»¬çš„æ•´ä¸ªæ•°æ®è¡¨ï¼Œä¼šæŒ‰ç…§è¡Œé”®æ’å¥½åºï¼Œç„¶åæŒ‰ç…§è¿ç»­çš„è¡Œé”®ä¸€æ®µæ®µåœ°åˆ†åŒºã€‚å¦‚æœæŸä¸€æ®µè¡Œé”®çš„åŒºé—´é‡Œï¼Œå†™çš„æ•°æ®è¶Šæ¥è¶Šå¤šï¼Œå ç”¨çš„å­˜å‚¨ç©ºé—´è¶Šæ¥è¶Šå¤§ï¼Œé‚£ä¹ˆæ•´ä¸ªç³»ç»Ÿä¼šè‡ªåŠ¨åœ°å°†è¿™ä¸ªåˆ†åŒºä¸€åˆ†ä¸ºäºŒï¼Œå˜æˆä¸¤ä¸ªåˆ†åŒºã€‚è€Œå¦‚æœæŸä¸€ä¸ªåŒºé—´æ®µçš„æ•°æ®è¢«åˆ æ‰äº†å¾ˆå¤šï¼Œå ç”¨çš„ç©ºé—´è¶Šæ¥è¶Šå°äº†ï¼Œé‚£ä¹ˆæˆ‘ä»¬å°±ä¼šè‡ªåŠ¨æŠŠè¿™ä¸ªåˆ†åŒºå’Œå®ƒæ—è¾¹çš„åˆ†åŒºåˆå¹¶åˆ°ä¸€èµ·ã€‚</p><p>è¿™ä¸ªåˆ†åŒºçš„è¿‡ç¨‹ï¼Œå°±å¥½åƒä½ æŒ‰ç…§A~Zçš„å­—æ¯é¡ºåºå»ç®¡ç†ä½ çš„ä¹¦çš„è¿‡ç¨‹ã€‚ä¸€å¼€å§‹ï¼Œä½ åªæœ‰ä¸€ä¸ªç©ºç®±å­æ”¾åœ¨åœ°ä¸Šï¼Œç„¶åä½ æŠŠä½ çš„ä¹¦æŒ‰ç…§ä¹¦åçš„æ‹¼éŸ³ï¼Œä»ä¸Šåˆ°ä¸‹æ”¾åœ¨ç®±å­é‡Œã€‚å½“æœ‰ä¸€æœ¬æ–°ä¹¦éœ€è¦æ”¾è¿›æ¥çš„æ—¶å€™ï¼Œä½ å°±æŒ‰ç…§å­—æ¯é¡ºåºæ’åœ¨æŸä¸¤æœ¬ä¹¦ä¸­é—´ã€‚è€Œå½“ç®±å­æ”¾ä¸ä¸‹çš„æ—¶å€™ï¼Œä½ å°±å†æ‹¿ä¸€ä¸ªç©ºç®±å­ï¼Œæ”¾åœ¨æ”¾ä¸ä¸‹çš„ç®±å­ä¸‹é¢ï¼Œç„¶åæŠŠä¹‹å‰çš„ç®±å­é‡Œçš„å›¾ä¹¦ä»ä¸­é—´ä¸€åˆ†ï¼ŒæŠŠä¸‹é¢çš„ä¸€åŠæ”¾åˆ°æ–°ç®±å­é‡Œã€‚</p><p>è€Œæˆ‘ä»¬åˆ é™¤æ•°æ®çš„æ—¶å€™ï¼Œå°±è¦æŠŠä¹¦ä»ç®±å­é‡Œé¢æ‹¿èµ°ã€‚å½“ä¸¤ä¸ªç›¸é‚»çš„ç®±å­é‡Œéƒ½å¾ˆç©ºçš„æ—¶å€™ï¼Œæˆ‘ä»¬å°±å¯ä»¥æŠŠä¸¤ä¸ªç®±å­é‡Œé¢çš„ä¹¦æ”¾åˆ°ä¸€ä¸ªç®±å­é‡Œé¢ï¼Œç„¶åæŠŠè…¾å‡ºæ¥çš„ç©ºç®±å­æŒªèµ°ã€‚è¿™é‡Œçš„ä¸€ä¸ªä¸ªâ€œç®±å­â€å°±æ˜¯æˆ‘ä»¬çš„åˆ†ç‰‡ï¼Œè¿™é‡Œé¢çš„ä¸€æœ¬æœ¬ä¹¦ï¼Œå°±æ˜¯æˆ‘ä»¬çš„ä¸€è¡Œæ•°æ®ï¼Œè€Œä¹¦åçš„æ‹¼éŸ³ï¼Œå°±æ˜¯æˆ‘ä»¬çš„è¡Œé”®ã€‚å¯èƒ½ä»¥Aã€Bã€Cå¼€å¤´çš„ä¹¦å¤šä¸€äº›ï¼Œé‚£ä¹ˆå®ƒä»¬å ç”¨çš„åˆ†åŒºå°±ä¼šå¤šä¸€äº›ï¼Œä»¥Uã€Vã€Wå¼€å¤´çš„ä¹¦å°‘ä¸€äº›ï¼Œå¯èƒ½è¿™äº›ä¹¦å°±éƒ½åœ¨ä¸€ä¸ªåˆ†åŒºé‡Œé¢ã€‚</p><p><img src=\"https://static001.geekbang.org/resource/image/07/b2/07fbab143fd8df45bcd3ae0064fa41b2.jpg?wh=2000x1344\" alt=\"\" title=\"åŠ¨æ€åŒºé—´åˆ†åŒºï¼šè‡ªåŠ¨æ ¹æ®å½“å‰æ•°æ®åˆ†å¸ƒï¼Œè¿›è¡Œåˆ†åŒºæˆ–è€…åˆå¹¶\"></p><p>é‡‡ç”¨è¿™æ ·çš„æ–¹å¼ï¼Œä½ ä¼šå‘ç°ï¼Œä½ å¯ä»¥åŠ¨æ€åœ°è°ƒæ•´æ•°æ®æ˜¯å¦‚ä½•åˆ†åŒºçš„ï¼Œå¹¶ä¸”æ¯ä¸ªåˆ†åŒºåœ¨æ•°æ®é‡ä¸Šï¼Œéƒ½ä¼šç›¸å¯¹æ¯”è¾ƒå‡åŒ€ã€‚è€Œä¸”ï¼Œåœ¨åˆ†åŒºå‘ç”Ÿå˜åŒ–çš„æ—¶å€™ï¼Œä½ éœ€è¦è°ƒæ•´çš„åªæœ‰ä¸€ä¸ªåˆ†åŒºï¼Œå†æ²¡æœ‰éœ€è¦å¤§é‡æ¬è¿æ•°æ®çš„å‹åŠ›äº†ã€‚</p><h2>é€šè¿‡Master + Chubbyè¿›è¡Œåˆ†åŒºç®¡ç†</h2><p>é‚£ä¹ˆçœ‹åˆ°è¿™å„¿ï¼Œä½ å¯èƒ½è¦é—®äº†ï¼šè¦æ˜¯ä¸Šä¸€è®²çš„MySQLé›†ç¾¤ä¹Ÿç”¨è¿™æ ·çš„åˆ†åŒºæ–¹å¼ï¼Œé—®é¢˜æ˜¯ä¸æ˜¯å°±è§£å†³äº†ï¼Ÿ</p><p>ç­”æ¡ˆå½“ç„¶æ˜¯åŠä¸åˆ°äº†ã€‚å› ä¸ºæˆ‘ä»¬è¿˜éœ€è¦æœ‰ä¸€å¥—å­˜å‚¨ã€ç®¡ç†åˆ†åŒºä¿¡æ¯çš„æœºåˆ¶ï¼Œè¿™åœ¨å“ˆå¸Œåˆ†ç‰‡çš„MySQLé›†ç¾¤é‡Œæ˜¯æ²¡æœ‰çš„ã€‚åœ¨Bigtableé‡Œï¼Œæˆ‘ä»¬æ˜¯é€šè¿‡<strong>Masterå’ŒChubby</strong>è¿™ä¸¤ä¸ªç»„ä»¶æ¥å®Œæˆè¿™ä¸ªä»»åŠ¡çš„ã€‚è¿™ä¸¤ä¸ªç»„ä»¶ï¼ŒåŠ ä¸Šæ¯ä¸ªåˆ†ç‰‡æä¾›æœåŠ¡çš„<strong>Tablet Server</strong>ï¼Œä»¥åŠå®é™…å­˜å‚¨æ•°æ®çš„<strong>GFS</strong>ï¼Œ<strong>å…±åŒç»„æˆäº†æ•´ä¸ªBigtableé›†ç¾¤</strong>ã€‚</p><h3>Masterã€Chubbyå’ŒTablet Serverçš„ç”¨é€”</h3><p>Tablet Serverçš„è§’è‰²æœ€æ˜ç¡®ï¼Œå°±æ˜¯ç”¨æ¥<strong>å®é™…æä¾›æ•°æ®è¯»å†™æœåŠ¡</strong>çš„ã€‚ä¸€ä¸ªTablet Serverä¸Šä¼šåˆ†é…åˆ°10åˆ°1000ä¸ªTabletsï¼ŒTablet Serverå°±å»è´Ÿè´£è¿™äº›Tabletsçš„è¯»å†™è¯·æ±‚ï¼Œå¹¶ä¸”åœ¨å•ä¸ªTabletå¤ªå¤§çš„æ—¶å€™ï¼Œå¯¹å®ƒä»¬è¿›è¡Œåˆ†è£‚ã€‚</p><p>è€Œå“ªäº›Tabletsåˆ†é…ç»™å“ªä¸ªTablet Serverï¼Œè‡ªç„¶æ˜¯ç”±Masterè´Ÿè´£çš„ï¼Œè€Œä¸”Masterå¯ä»¥æ ¹æ®æ¯ä¸ªTablet Serverçš„è´Ÿè½½è¿›è¡ŒåŠ¨æ€çš„è°ƒåº¦ï¼Œä¹Ÿå°±æ˜¯Masterè¿˜èƒ½èµ·åˆ°<strong>è´Ÿè½½å‡è¡¡</strong>ï¼ˆload balanceï¼‰çš„ä½œç”¨ã€‚è€Œè¿™ä¸€ç‚¹ï¼Œä¹Ÿæ˜¯MySQLé›†ç¾¤å¾ˆéš¾åšåˆ°çš„ã€‚</p><p>è¿™æ˜¯å› ä¸ºï¼ŒBigtableçš„Tablet Serveråªè´Ÿè´£åœ¨çº¿æœåŠ¡ï¼Œä¸è´Ÿè´£æ•°æ®å­˜å‚¨ã€‚å®é™…çš„å­˜å‚¨ï¼Œæ˜¯é€šè¿‡ä¸€ç§å«åšSSTableçš„æ•°æ®æ ¼å¼å†™å…¥åˆ°GFSä¸Šçš„ã€‚ä¹Ÿå°±æ˜¯<strong>Bigtableé‡Œï¼Œæ•°æ®å­˜å‚¨å’Œåœ¨çº¿æœåŠ¡çš„èŒè´£æ˜¯å®Œå…¨åˆ†ç¦»çš„</strong>ã€‚æˆ‘ä»¬è°ƒåº¦Tabletçš„æ—¶å€™ï¼Œåªæ˜¯è°ƒåº¦åœ¨çº¿æœåŠ¡çš„è´Ÿè½½ï¼Œå¹¶ä¸éœ€è¦æŠŠæ•°æ®ä¹Ÿä¸€å¹¶æ¬è¿èµ°ã€‚</p><p>è€Œåœ¨ä¸Šä¸€è®²é‡Œçš„<strong>MySQLé›†ç¾¤ï¼ŒæœåŠ¡èŒè´£å’Œæ•°æ®å­˜å‚¨æ˜¯åœ¨åŒä¸€ä¸ªèŠ‚ç‚¹ä¸Šçš„</strong>ã€‚æˆ‘ä»¬è¦æƒ³æŠŠè´Ÿè½½å¤§çš„èŠ‚ç‚¹è°ƒåº¦åˆ°å…¶ä»–åœ°æ–¹å»ï¼Œå°±æ„å‘³ç€æ•°æ®ä¹Ÿè¦ä¸€å¹¶è¿ç§»èµ°ï¼Œè€Œå¤åˆ¶å’Œè¿ç§»æ•°æ®åˆä¼šè¿›ä¸€æ­¥åŠ å¤§èŠ‚ç‚¹çš„è´Ÿè½½ï¼Œå¾ˆæœ‰å¯èƒ½é€ æˆé›ªå´©æ•ˆåº”ã€‚</p><p><img src=\"https://static001.geekbang.org/resource/image/0e/44/0ea783a0ce3218bc4af2aeaec29yy344.jpg?wh=2000x1125\" alt=\"\" title=\"Bigtableçš„é›†ç¾¤ï¼Œåœ¨çº¿æœåŠ¡å’Œå­˜å‚¨æ˜¯åˆ†ç¦»çš„ï¼Œæ•°æ®å­˜å‚¨ä¾èµ–GFS[br]æˆ‘ä»¬å¯ä»¥æŠŠBigtableçš„è¿›ç¨‹ç›´æ¥éƒ¨ç½²åœ¨GFSé‡Œ[br]ä½†å³ä¾¿è¿™æ ·ï¼Œæˆ‘ä»¬ä¹Ÿå¹¶ä¸ä¿éšœTablet Serveræ‰€æœåŠ¡çš„Tabletsä¸‹çš„åº•å±‚SSTableæ•°æ®ï¼Œåœ¨åŒä¸€ä¸ªç‰©ç†æœåŠ¡å™¨ä¸Š\"></p><p>äº‹å®ä¸Šï¼ŒMasterä¸€å…±ä¼šè´Ÿè´£5é¡¹å·¥ä½œï¼š</p><ul>\n<li>åˆ†é…Tabletsç»™Tablet Serverï¼›</li>\n<li>æ£€æµ‹Tablet Serverçš„æ–°å¢å’Œè¿‡æœŸï¼›</li>\n<li>å¹³è¡¡Tablet Serverçš„è´Ÿè½½ï¼›</li>\n<li>å¯¹äºGFSä¸Šçš„æ•°æ®è¿›è¡Œåƒåœ¾å›æ”¶ï¼ˆGCï¼‰ï¼›</li>\n<li>ç®¡ç†è¡¨ï¼ˆTableï¼‰å’Œåˆ—æ—çš„Schemaå˜æ›´ï¼Œæ¯”å¦‚è¡¨å’Œåˆ—æ—çš„åˆ›å»ºä¸åˆ é™¤ã€‚</li>\n</ul><p>é‚£çœ‹åˆ°è¿™é‡Œä½ å¯èƒ½è¦é—®äº†ï¼Œå¥½åƒMasteråŠ ä¸ŠTablet Serverå°±è¶³ä»¥ç»„æˆBigtableäº†ï¼Œ<strong>ä¸ºä»€ä¹ˆè¿˜æœ‰ä¸€ä¸ªChubbyè¿™ä¸ªç»„ä»¶å‘¢ï¼Ÿ</strong>åˆ«ç€æ€¥ï¼Œä½ æ¥ç€å¾€ä¸‹çœ‹ã€‚</p><p>Bigtableéœ€è¦Chubbyæ¥æå®šè¿™ä¹ˆå‡ ä»¶äº‹å„¿ï¼š</p><ul>\n<li>ç¡®ä¿æˆ‘ä»¬åªæœ‰ä¸€ä¸ªMasterï¼›</li>\n<li>å­˜å‚¨Bigtableæ•°æ®çš„å¼•å¯¼ä½ç½®ï¼ˆBootstrap Locationï¼‰ï¼›</li>\n<li>å‘ç°Tablet Serversä»¥åŠåœ¨å®ƒä»¬ç»ˆæ­¢ä¹‹åå®Œæˆæ¸…ç†å·¥ä½œï¼›</li>\n<li>å­˜å‚¨Bigtableçš„Schemaä¿¡æ¯ï¼›</li>\n<li>å­˜å‚¨ACLï¼Œä¹Ÿå°±æ˜¯Bigtableçš„è®¿é—®æƒé™ã€‚</li>\n</ul><p>è¿™é‡Œé¢çš„æœ€åä¸¤é¡¹åªæ˜¯ç®€å•çš„æ•°æ®å­˜å‚¨åŠŸèƒ½ï¼Œæˆ‘ä»¬å°±ä¸å¤šè®²äº†ï¼Œæˆ‘ä»¬é‡ç‚¹æ¥çœ‹çœ‹å‰ä¸‰é¡¹ã€‚</p><p>å¦‚æœæ²¡æœ‰Chubbyçš„è¯ï¼Œæˆ‘èƒ½æƒ³åˆ°æœ€ç›´æ¥çš„é›†ç¾¤ç®¡ç†æ–¹æ¡ˆï¼Œå°±æ˜¯è®©æ‰€æœ‰çš„Tablet Serverç›´æ¥å’ŒMasteré€šä¿¡ï¼ŒæŠŠåˆ†åŒºä¿¡æ¯ä»¥åŠTabletsåˆ†é…åˆ°å“ªäº›Tablet Serverï¼Œä¹Ÿç›´æ¥æ”¾åœ¨Masterçš„å†…å­˜é‡Œé¢ã€‚è¿™ä¸ªåŠæ³•ï¼Œå°±å’Œæˆ‘ä»¬ä¹‹å‰åœ¨GFSé‡Œçš„åŠæ³•ä¸€æ ·ã€‚ä½†æ˜¯è¿™ä¸ªæ–¹æ¡ˆï¼Œä¹Ÿå°±ä½¿å¾—Masterå˜æˆäº†ä¸€ä¸ª<strong>å•ç‚¹æ•…éšœç‚¹</strong>ï¼ˆSPOF-Single Point of Failureï¼‰ã€‚å½“ç„¶ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡Backup Masterä»¥åŠShadow Masterç­‰æ–¹å¼ï¼Œæ¥å°½å¯èƒ½æå‡å¯ç”¨æ€§ã€‚</p><p>å¯æ˜¯è¿™æ ·ç¬¬ä¸€ä¸ªé—®é¢˜å°±æ¥äº†ï¼Œæˆ‘ä»¬åœ¨GFSçš„è®ºæ–‡é‡Œé¢è¯´è¿‡ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡ä¸€ä¸ªå¤–éƒ¨æœåŠ¡å»ç›‘æ§Masterçš„å­˜æ´»ï¼Œç­‰å®ƒæŒ‚äº†ä¹‹åï¼Œè‡ªåŠ¨åˆ‡æ¢åˆ°Backup Masterã€‚ä½†æ˜¯ï¼Œ<strong>æˆ‘ä»¬æ€ä¹ˆçŸ¥é“Masteræ˜¯çœŸçš„æŒ‚äº†ï¼Œè¿˜æ˜¯åªæ˜¯â€œå¤–éƒ¨æœåŠ¡â€å’ŒMasterä¹‹é—´çš„ç½‘ç»œå‡ºç°æ•…éšœäº†å‘¢ï¼Ÿ</strong></p><p>å¦‚æœæ˜¯åè€…çš„è¯ï¼Œæˆ‘ä»¬å¾ˆæœ‰å¯èƒ½ä¼šé‡åˆ°ä¸€ä¸ªå¾ˆç³Ÿç³•çš„æƒ…å†µï¼Œå°±æ˜¯ç³»ç»Ÿé‡Œé¢å‡ºç°äº†ä¸¤ä¸ªMasterã€‚è¿™ä¸ªæ—¶å€™ï¼Œå¯èƒ½ä¸¤ä¸ªå®¢æˆ·ç«¯åˆ†åˆ«è®¤ä¸ºè¿™ä¸¤ä¸ªMasteræ˜¯çœŸçš„ï¼Œå½“å®ƒä»¬åˆ†å¤´åœ¨ä¸¤è¾¹å†™å…¥æ•°æ®çš„æ—¶å€™ï¼Œæˆ‘ä»¬å°±ä¼šé‡åˆ°<strong>æ•°æ®ä¸ä¸€è‡´</strong>çš„é—®é¢˜ã€‚</p><p>é‚£ä¹ˆChubbyï¼Œå°±æ˜¯è¿™é‡Œçš„è¿™ä¸ª<strong>å¤–éƒ¨æœåŠ¡</strong>ï¼Œä¸è¿‡Chubbyä¸æ˜¯1å°æœåŠ¡å™¨ï¼Œè€Œæ˜¯5å°æœåŠ¡å™¨ç»„æˆçš„ä¸€ä¸ªé›†ç¾¤ï¼Œå®ƒä¼šé€šè¿‡Paxosè¿™æ ·çš„å…±è¯†ç®—æ³•ï¼Œæ¥ç¡®ä¿ä¸ä¼šå‡ºç°è¯¯åˆ¤ã€‚è€Œä¸”å› ä¸ºå®ƒæœ‰5å°æœåŠ¡å™¨ï¼Œæ‰€ä»¥ä¹Ÿä¸€å¹¶è§£å†³äº†é«˜å¯ç”¨çš„é—®é¢˜ï¼Œå°±ç®—æŒ‚ä¸ª1~2å°ï¼Œä¹Ÿå¹¶ä¸ä¼šä¸¢æ•°æ®ã€‚å…³äºå…·ä½“Chubbyçš„åŸç†å’Œä½¿ç”¨ï¼Œæˆ‘ä»¬ä¼šåœ¨åé¢è®²è§£Chubbyè®ºæ–‡çš„æ—¶å€™ä¸“é—¨ä»‹ç»ï¼Œä»Šå¤©å°±å…ˆä¸å±•å¼€äº†ã€‚</p><h3>ä¸ºä»€ä¹ˆæ•°æ®è¯»å†™ä¸éœ€è¦Masterï¼Ÿ</h3><p>Chubbyå¸®æˆ‘ä»¬ä¿éšœäº†åªæœ‰ä¸€ä¸ªMasterï¼Œé‚£ä¹ˆæˆ‘ä»¬å†æ¥çœ‹çœ‹åˆ†åŒºå’ŒTabletsçš„åˆ†é…ä¿¡æ¯ï¼Œè¿™äº›ä¿¡æ¯ä¹Ÿæ²¡æœ‰æ”¾åœ¨Masterã€‚Bigtableåœ¨è¿™é‡Œç”¨äº†ä¸€ä¸ªå¾ˆå·§å¦™çš„æ–¹æ³•ï¼Œå°±æ˜¯ç›´æ¥æŠŠè¿™ä¸ªä¿¡æ¯ï¼Œå­˜æˆäº†Bigtableçš„ä¸€å¼ <strong>METADATAè¡¨</strong>ï¼Œè€Œè¿™å¼ è¡¨åœ¨å“ªé‡Œå‘¢ï¼Œå®ƒæ˜¯ç›´æ¥å­˜æ”¾åœ¨Bigtableé›†ç¾¤é‡Œé¢çš„ï¼Œå…¶å®METADATAè¡¨è‡ªå·±å°±æ˜¯ä¸€å¼ Bigtableçš„æ•°æ®è¡¨ã€‚</p><p>è¿™å…¶å®æœ‰ç‚¹åƒMySQLé‡Œé¢çš„information_schemaè¡¨ï¼Œä¹Ÿå°±æ˜¯æ•°æ®åº“å®šä¹‰äº†ä¸€å¼ ç‰¹æ®Šçš„è¡¨ï¼Œç”¨æ¥å­˜æ”¾è‡ªå·±çš„å…ƒæ•°æ®ã€‚ä¸è¿‡ï¼ŒBigtableæ˜¯ä¸€ä¸ªåˆ†å¸ƒå¼æ•°æ®åº“ï¼Œæ‰€ä»¥æˆ‘ä»¬è¿˜è¦çŸ¥é“ï¼Œè¿™ä¸ªå…ƒæ•°æ®ç©¶ç«Ÿå­˜æ”¾åœ¨å“ªä¸ªTablet Serveré‡Œï¼Œè¿™ä¸ªå°±éœ€è¦é€šè¿‡Chubbyæ¥å‘Šè¯‰æˆ‘ä»¬äº†ã€‚</p><ul>\n<li>Bigtableåœ¨Chubbyé‡Œçš„ä¸€ä¸ªæŒ‡å®šçš„æ–‡ä»¶é‡Œï¼Œå­˜æ”¾äº†ä¸€ä¸ªå«åš<strong>Root Tablet</strong>çš„åˆ†åŒºæ‰€åœ¨çš„ä½ç½®ã€‚</li>\n<li>ç„¶åï¼Œè¿™ä¸ªRoot Tabletçš„åˆ†åŒºï¼Œæ˜¯METADATAè¡¨çš„ç¬¬ä¸€ä¸ªåˆ†åŒºï¼Œ<strong>è¿™ä¸ªåˆ†åŒºæ°¸è¿œä¸ä¼šåˆ†è£‚</strong>ã€‚å®ƒé‡Œé¢å­˜çš„ï¼Œæ˜¯METADATAé‡Œå…¶ä»–Tabletsæ‰€åœ¨çš„ä½ç½®ã€‚</li>\n<li>è€ŒMETADATAå‰©ä¸‹çš„è¿™äº›Tabletsï¼Œæ¯ä¸€ä¸ªTabletä¸­ï¼Œéƒ½å­˜æ”¾äº†ç”¨æˆ·åˆ›å»ºçš„é‚£äº›æ•°æ®è¡¨ï¼Œæ‰€åŒ…å«çš„Tabletsæ‰€åœ¨çš„ä½ç½®ï¼Œä¹Ÿå°±æ˜¯æ‰€è°“çš„User Tabletsçš„ä½ç½®ã€‚</li>\n</ul><p><img src=\"https://static001.geekbang.org/resource/image/aa/2c/aa09087c19f6a358c7769272yy2f442c.jpg?wh=2000x1344\" alt=\"\"></p><p>è¿™é‡Œæˆ‘ä»¬æ¥çœ‹ä¸€ä¸ªå…·ä½“çš„Bigtableæ•°æ®è¯»å†™çš„ä¾‹å­ï¼Œæ¥å¸®åŠ©ä½ ç†è§£è¿™æ ·ä¸€ä¸ªä¸‰å±‚ç»“æ„ã€‚æ¯”å¦‚ï¼Œå®¢æˆ·ç«¯æƒ³è¦æ ¹æ®è®¢å•å·ï¼ŒæŸ¥æ‰¾æˆ‘ä»¬çš„è®¢å•ä¿¡æ¯ï¼Œè®¢å•éƒ½å­˜åœ¨Bigtableçš„ECOMMERCE_ORDERSè¡¨é‡Œï¼Œè¿™å¼ è¦æŸ¥çš„è®¢å•å·ï¼Œå°±æ˜¯A20210101RSTã€‚</p><p>é‚£ä¹ˆï¼Œæˆ‘ä»¬çš„å®¢æˆ·ç«¯å…·ä½“æ˜¯æ€ä¹ˆæŸ¥è¯¢çš„å‘¢ï¼Ÿ</p><ol>\n<li>å®¢æˆ·ç«¯å…ˆå»å‘èµ·è¯·æ±‚ï¼ŒæŸ¥è¯¢Chubbyï¼Œçœ‹æˆ‘ä»¬çš„Root Tabletåœ¨å“ªé‡Œã€‚</li>\n<li>Chubbyä¼šå‘Šè¯‰å®¢æˆ·ç«¯ï¼ŒRoot Tabletåœ¨5å·Tablet Serverï¼Œè¿™é‡Œæˆ‘ä»¬ç®€å†™æˆTS5ã€‚</li>\n<li>å®¢æˆ·ç«¯å‘¢ï¼Œä¼šå†å‘TS5å‘èµ·è¯·æ±‚ï¼Œè¯´æˆ‘è¦æŸ¥Root Tabletï¼Œå‘Šè¯‰æˆ‘å“ªä¸€ä¸ªMETADATA Tableté‡Œï¼Œå­˜æ”¾äº†ECOMMERCE_ORDERSä¸šåŠ¡è¡¨ï¼Œè¡Œé”®ä¸ºA20210101RSTçš„è®°å½•çš„ä½ç½®ã€‚</li>\n<li>TS5ä¼šä»Root Tableté‡Œé¢æŸ¥è¯¢ï¼Œç„¶åå‘Šè¯‰å®¢æˆ·ç«¯ï¼Œè¯´è¿™ä¸ªè®°å½•çš„ä½ç½®å•Šï¼Œä½ å¯ä»¥ä»TS8ä¸Šé¢çš„METADATAçš„tablet 107ï¼Œæ‰¾åˆ°è¿™ä¸ªä¿¡æ¯ã€‚</li>\n<li>ç„¶åï¼Œå®¢æˆ·ç«¯å†å‘èµ·è¯·æ±‚åˆ°TS8ï¼Œè¯´æˆ‘è¦åœ¨tablet 107é‡Œé¢ï¼Œæ‰¾ECOMMERCE_ORDERSè¡¨ï¼Œè¡Œé”®ä¸ºA20210101RSTå…·ä½“åœ¨å“ªé‡Œã€‚</li>\n<li>TS8å‘Šè¯‰å®¢æˆ·ç«¯ï¼Œè¿™ä¸ªæ•°æ®åœ¨TS20çš„tablet 253é‡Œé¢ã€‚</li>\n<li>å®¢æˆ·ç«¯å‘èµ·æœ€åä¸€æ¬¡è¯·æ±‚ï¼Œå»é—®TS20çš„tablet 253ï¼Œé—®ECOMMERCE_ORDERSè¡¨ï¼Œè¡Œé”®ä¸ºA20210101RSTçš„å…·ä½“æ•°æ®ã€‚</li>\n<li>TS20æœ€ç»ˆä¼šæŠŠæ•°æ®è¿”å›ç»™å®¢æˆ·ç«¯ã€‚</li>\n</ol><p><img src=\"https://static001.geekbang.org/resource/image/28/5a/28c60e5ed395652894dd9f6b91b2475a.jpg?wh=1920x1290\" alt=\"å›¾ç‰‡\" title=\"ä¸€æ¬¡Bigtableçš„æŸ¥è¯¢è¿‡ç¨‹[br]ä¼šæœ‰3æ¬¡ç½‘ç»œè¯·æ±‚ï¼Œæ‰¾åˆ°æ•°æ®æ‰€åœ¨çš„ä½ç½®[br]å†é€šè¿‡1æ¬¡ç½‘ç»œè¯·æ±‚è·å–åˆ°å…·ä½“æ•°æ®\"></p><p>å¯ä»¥çœ‹åˆ°ï¼Œåœ¨è¿™ä¸ªè¿‡ç¨‹é‡Œï¼Œæˆ‘ä»¬ç”¨äº†ä¸‰æ¬¡ç½‘ç»œæŸ¥è¯¢ï¼Œæ‰¾åˆ°äº†æƒ³è¦æŸ¥è¯¢çš„æ•°æ®çš„å…·ä½“ä½ç½®ï¼Œç„¶åå†å‘èµ·ä¸€æ¬¡è¯·æ±‚æ‹¿åˆ°æœ€ç»ˆçš„å®é™…æ•°æ®ã€‚ä¸€èˆ¬æˆ‘ä»¬ä¼šæŠŠå‰ä¸‰æ¬¡æŸ¥è¯¢ä½ç½®ç»“æœç¼“å­˜èµ·æ¥ï¼Œä»¥å‡å°‘å¾€è¿”çš„ç½‘ç»œæŸ¥è¯¢æ¬¡æ•°ã€‚è€Œå¯¹äºæ•´ä¸ªMETADATAè¡¨æ¥è¯´ï¼Œæˆ‘ä»¬éƒ½ä¼šæŠŠå®ƒä»¬ä¿ç•™åœ¨<strong>å†…å­˜</strong>é‡Œï¼Œè¿™æ ·æ¯ä¸ªBigtableè¯·æ±‚éƒ½è¦è¯»å†™çš„æ•°æ®ï¼Œå°±ä¸éœ€è¦é€šè¿‡è®¿é—®GFSæ¥è¯»å–åˆ°äº†ã€‚</p><p>è¿™ä¸ªTabletåˆ†åŒºä¿¡æ¯ï¼Œå…¶å®æ˜¯ä¸€ä¸ªä¸‰å±‚Tabletä¿¡æ¯å­˜å‚¨çš„æ¶æ„ï¼Œ<strong>è€Œä¸‰å±‚ç»“æ„è®©Bigtableå¯ä»¥â€œä¼¸ç¼©â€åˆ°è¶³å¤Ÿå¤§</strong>ã€‚METADATAçš„ä¸€æ¡è®°å½•ï¼Œå¤§çº¦æ˜¯1KBï¼Œè€ŒMETADATAçš„Tabletå¦‚æœé™åˆ¶åœ¨128MBï¼Œä¸‰å±‚è®°å½•å¯ä»¥å­˜ä¸‹å¤§çº¦<code> (128*1000)**2=2**34</code>ä¸ªTabletçš„ä½ç½®ï¼Œä¹Ÿå°±æ˜¯å¤§çº¦160äº¿ä¸ªTabletï¼Œè‚¯å®šæ˜¯å¤Ÿç”¨äº†ã€‚</p><p>è¿™ä¸ªè®¾è®¡å¸¦æ¥äº†ä¸€ä¸ªå¾ˆå¤§çš„å¥½å¤„ï¼Œå°±æ˜¯<strong>æŸ¥è¯¢Tabletsåœ¨å“ªé‡Œè¿™ä»¶äº‹æƒ…ï¼Œå°½å¯èƒ½åœ°è¢«åˆ†æ‘Šåˆ°äº†Bigtableçš„æ•´ä¸ªé›†ç¾¤ï¼Œè€Œä¸æ˜¯é›†ä¸­åœ¨æŸä¸€ä¸ªMasterèŠ‚ç‚¹ä¸Šã€‚</strong>è€Œå”¯ä¸€æ‰€æœ‰äººéƒ½éœ€è¦æŸ¥è¯¢çš„Root Tabletçš„ä½ç½®å’Œé‡Œé¢çš„æ•°æ®ï¼Œè€ƒè™‘åˆ°Root Tabletä¸ä¼šåˆ†è£‚ï¼Œå¹¶ä¸”å®¢æˆ·ç«¯å¯ä»¥æœ‰ç¼“å­˜ï¼ŒChubbyå’ŒRoot Tabletæ‰€åœ¨çš„TabletæœåŠ¡å™¨ä¹Ÿä¸ä¼šæœ‰å¤ªå¤§å‹åŠ›ã€‚</p><p>å¦å¤–ä½ è¿˜ä¼šå‘ç°ï¼Œåœ¨æ•´ä¸ªæ•°æ®è¯»å†™çš„è¿‡ç¨‹ä¸­ï¼Œå®¢æˆ·ç«¯æ˜¯ä¸éœ€è¦ç»è¿‡Masterçš„ã€‚å³ä½¿MasterèŠ‚ç‚¹å·²ç»æŒ‚æ‰äº†ï¼Œä¹Ÿä¸ä¼šå½±å“æ•°æ®çš„æ­£å¸¸è¯»å†™ã€‚å®¢æˆ·ç«¯ä¸éœ€è¦è®¤è¯†Masterè¿™ä¸ªâ€œä¸»äººâ€ï¼Œä¹Ÿä¸ä¾èµ–Masterè¿™ä¸ªâ€œä¸»äººâ€ä¸ºæˆ‘ä»¬æä¾›æœåŠ¡ã€‚è¿™ä¸ªè®¾è®¡ï¼Œè®©Bigtableæ›´åŠ â€œé«˜å¯ç”¨â€äº†ã€‚</p><p>è€Œå¦‚æœæˆ‘ä»¬å›é¡¾å‰é¢æ•´ä¸ªæŸ¥è¯¢è¿‡ç¨‹ï¼Œå…¶å®å°±å¾ˆå®¹æ˜“ç†è§£ï¼Œä¸ºä»€ä¹ˆChubbyé‡Œé¢å­˜çš„å«åšBigtableçš„å¼•å¯¼ä½ç½®ï¼Œå› ä¸ºè¿™ä¸ªè¿‡ç¨‹å’Œæ“ä½œç³»ç»Ÿå¯åŠ¨çš„è¿‡ç¨‹å¾ˆç±»ä¼¼ï¼Œéƒ½æ˜¯è¦ä»ä¸€ä¸ªå›ºå®šçš„ä½ç½®è¯»å–ä¿¡æ¯ï¼Œæ¥è·å¾—åé¢çš„åŠ¨æ€çš„ä¿¡æ¯ã€‚åœ¨æ“ä½œç³»ç»Ÿé‡Œï¼Œè¿™ä¸ªæ˜¯è¯»å–ç¡¬ç›˜çš„ç¬¬ä¸€ä¸ªæ‰‡åŒºï¼Œè€Œåœ¨Bigtableé‡Œï¼Œåˆ™æ˜¯Chubbyé‡Œå­˜æ”¾Root Tabletä½ç½®çš„å›ºå®šæ–‡ä»¶ã€‚</p><h3>Masterçš„è°ƒåº¦è€…è§’è‰²</h3><p>çš„ç¡®ï¼Œåœ¨å•çº¯çš„æ•°æ®è¯»å†™çš„è¿‡ç¨‹ä¸­ä¸éœ€è¦Masterã€‚Masteråªè´Ÿè´£Tabletsçš„è°ƒåº¦è€Œå·²ï¼Œè€Œä¸”è¿™ä¸ªè°ƒåº¦åŠŸèƒ½ï¼Œä¹Ÿå¯¹Chubbyæœ‰æ‰€ä¾èµ–ã€‚æˆ‘ä»¬æ¥çœ‹ä¸€çœ‹è¿™ä¸ªè¿‡ç¨‹æ˜¯æ€ä¹ˆæ ·çš„ï¼š</p><ol>\n<li>æ‰€æœ‰çš„Tablet Serverï¼Œä¸€æ—¦ä¸Šçº¿ï¼Œå°±ä¼šåœ¨Chubbyä¸‹çš„ä¸€ä¸ªæŒ‡å®šç›®å½•ï¼Œè·å¾—ä¸€ä¸ªå’Œè‡ªå·±åå­—ç›¸åŒçš„<strong>ç‹¬å é”</strong>ï¼ˆexclusive lockï¼‰ã€‚ä½ å¯ä»¥çœ‹ä½œæ˜¯ï¼ŒTablet ServeræŠŠè‡ªå·±æ³¨å†Œåˆ°é›†ç¾¤ä¸Šäº†ã€‚</li>\n<li>Masterä¼šä¸€ç›´ç›‘å¬è¿™ä¸ªç›®å½•ï¼Œå½“å‘ç°ä¸€ä¸ªTablet Serveræ³¨å†Œäº†ï¼Œå®ƒå°±çŸ¥é“æœ‰ä¸€ä¸ªæ–°çš„Tablet Serverå¯ä»¥ç”¨äº†ï¼Œä¹Ÿå°±æ˜¯å¯ä»¥åˆ†é…Tabletsã€‚</li>\n<li>åˆ†é…Tabletsçš„æƒ…å†µå¾ˆå¤šï¼Œå¯èƒ½æ˜¯å› ä¸ºå…¶ä»–çš„Tablet ServeræŒ‚äº†ï¼Œå¯¼è‡´éƒ¨åˆ†Tabletsæ²¡æœ‰åˆ†é…å‡ºå»ï¼Œæˆ–è€…å› ä¸ºåˆ«çš„Tablet Serverçš„è´Ÿè½½å¤ªå¤§ï¼Œè¿™äº›æƒ…å†µéƒ½å¯ä»¥è®©Masterå»é‡æ–°åˆ†é…Tabletã€‚å…·ä½“çš„åˆ†é…ç­–ç•¥è®ºæ–‡é‡Œå¹¶æ²¡æœ‰è¯´ï¼Œä½ å¯ä»¥æ ¹æ®è‡ªå·±çš„éœ€è¦å®ç°å¯¹åº”çš„åˆ†é…ç­–ç•¥ã€‚</li>\n<li>Tablet Serveræœ¬èº«ï¼Œæ˜¯æ ¹æ®<strong>æ˜¯å¦è¿˜ç‹¬å ç€Chubbyä¸Šå¯¹åº”çš„é”ï¼Œä»¥åŠé”æ–‡ä»¶æ˜¯å¦è¿˜åœ¨</strong>ï¼Œæ¥ç¡®å®šè‡ªå·±æ˜¯å¦è¿˜ä¸ºè‡ªå·±åˆ†é…åˆ°çš„TabletsæœåŠ¡ã€‚æ¯”å¦‚Tablet Serveråˆ°Chubbyçš„ç½‘ç»œä¸­æ–­äº†ï¼Œé‚£ä¹ˆTablet Serverå°±ä¼šå¤±å»è¿™ä¸ªç‹¬å é”ï¼Œä¹Ÿå°±ä¸å†ä¸ºåŸå…ˆåˆ†é…åˆ°çš„Tabletsæä¾›æœåŠ¡äº†ã€‚</li>\n<li>è€Œå¦‚æœæˆ‘ä»¬æŠŠTablet Serverä»é›†ç¾¤ä¸­æŒªèµ°ï¼Œé‚£ä¹ˆTablet Serverä¼šä¸»åŠ¨é‡Šæ”¾é”ï¼Œå½“ç„¶å®ƒä¹Ÿä¸å†æœåŠ¡é‚£äº›Tabletsäº†ï¼Œè¿™äº›Tabletséƒ½éœ€è¦é‡æ–°åˆ†é…ã€‚</li>\n<li>æ— è®ºæ˜¯å‰é¢çš„ç¬¬4ã€5ç‚¹è¿™æ ·å¼‚å¸¸æˆ–è€…æ­£å¸¸çš„æƒ…å†µï¼Œéƒ½æ˜¯ç”±Masteræ¥æ£€æµ‹Tablet Serveræ˜¯ä¸æ˜¯æ­£å¸¸å·¥ä½œçš„ã€‚æ£€æµ‹çš„æ–¹æ³•ä¹Ÿä¸å¤æ‚ï¼Œå…¶å®å°±æ˜¯é€šè¿‡<strong>å¿ƒè·³</strong>ã€‚Masterä¼šå®šæœŸé—®Tabletsï¼Œä½ æ˜¯ä¸æ˜¯è¿˜å ç€ç‹¬å é”å‘€ï¼Ÿæ— è®ºæ˜¯Tablet Serverè¯´å®ƒä¸å†å æœ‰é”äº†ï¼Œè¿˜æ˜¯Masterè¿ä¸ä¸ŠTablet Serveräº†ï¼ŒMasteréƒ½ä¼šåšä¸€ä¸ªå°å°çš„æµ‹è¯•ï¼Œå°±æ˜¯è‡ªå·±å»è·å–è¿™ä¸ªé”ã€‚å¦‚æœMasterèƒ½å¤Ÿæ‹¿åˆ°è¿™ä¸ªé”ï¼Œè¯´æ˜Chubbyè¿˜æ´»å¾—å¥½å¥½çš„ï¼Œé‚£ä¹ˆä¸€å®šæ˜¯Tablet Serveré‚£è¾¹å‡ºäº†é—®é¢˜ï¼ŒMasterå°±ä¼šåˆ é™¤è¿™ä¸ªé”ï¼Œç¡®ä¿Tablet Serverä¸ä¼šå†ä¸ºTabletsæä¾›æœåŠ¡ã€‚è€ŒåŸå…ˆTablet Serverä¸Šçš„Tabletså°±ä¼šå˜å›ä¸€ä¸ªæœªåˆ†é…çš„çŠ¶æ€ï¼Œéœ€è¦å›åˆ°ä¸Šé¢çš„ç¬¬3ç‚¹é‡æ–°åˆ†é…ã€‚</li>\n<li>è€ŒMasterè‡ªå·±ï¼Œä¸€æ—¦å’ŒChubbyä¹‹é—´çš„ç½‘ç»œè¿æ¥å‡ºç°é—®é¢˜ï¼Œä¹Ÿå°±æ˜¯å®ƒå’ŒChubbyä¹‹é—´çš„ä¼šè¯è¿‡æœŸäº†ï¼Œå®ƒå°±ä¼šé€‰æ‹©â€œè‡ªæ€â€ï¼Œè¿™ä¸ªæ˜¯ä¸ºäº†<strong>é¿å…å‡ºç°ä¸¤ä¸ªMasterè€Œä¸è‡ªçŸ¥</strong>çš„æƒ…å†µã€‚åæ­£ï¼ŒMasterçš„å­˜æ´»ä¸å¦ï¼Œä¸å½±å“å·²ç»å­˜åœ¨çš„Tabletsåˆ†é…å…³ç³»ï¼Œä¹Ÿä¸ä¼šå½±å“åˆ°æ•´ä¸ªBigtableæ•°æ®è¯»å†™çš„è¿‡ç¨‹ã€‚</li>\n</ol><h2>å°ç»“</h2><p>å¥½äº†ï¼Œåˆ°äº†è¿™é‡Œï¼Œç›¸ä¿¡ä½ å¯¹æ•´ä¸ªBigtableçš„ç³»ç»Ÿæ¶æ„å°±æœ‰ä¸€ä¸ªæ¸…æ™°çš„äº†è§£äº†ï¼Œç°åœ¨æˆ‘ä»¬å°±ä¸€èµ·æ¥å›é¡¾ä¸€ä¸‹ã€‚</p><p>æ•´ä¸ªBigtableæ˜¯ç”±4ä¸ªç»„ä»¶ç»„æˆçš„ï¼Œåˆ†åˆ«æ˜¯ï¼š</p><ul>\n<li>è´Ÿè´£å­˜å‚¨æ•°æ®çš„GFSï¼›</li>\n<li>è´Ÿè´£ä½œä¸ºåˆ†å¸ƒå¼é”å’Œç›®å½•æœåŠ¡çš„Chubbyï¼›</li>\n<li>è´Ÿè´£å®é™…æä¾›åœ¨çº¿æœåŠ¡çš„Tablet Serverï¼›</li>\n<li>è´Ÿè´£è°ƒåº¦Tabletå’Œè°ƒæ•´è´Ÿè½½çš„Masterã€‚</li>\n</ul><p><img src=\"https://static001.geekbang.org/resource/image/8d/7c/8dc1681b5723d5f48426f8d6c23a5f7c.jpg?wh=1920x1117\" alt=\"å›¾ç‰‡\" title=\"Bigtableçš„å››ä¸ªç»„æˆéƒ¨åˆ†\"></p><p>è€Œé€šè¿‡<strong>åŠ¨æ€åŒºåŸŸåˆ†åŒº</strong>çš„æ–¹å¼ï¼ŒBigtableçš„åˆ†åŒºç­–ç•¥éœ€è¦çš„æ•°æ®æ¬è¿å·¥ä½œé‡ä¼šå¾ˆå°ã€‚åœ¨Bigtableé‡Œï¼ŒMasterå¹¶ä¸è´Ÿè´£ä¿å­˜åˆ†åŒºä¿¡æ¯ï¼Œä¹Ÿä¸è´Ÿè´£ä¸ºåˆ†åŒºä¿¡æ¯æä¾›æŸ¥è¯¢æœåŠ¡ã€‚</p><p>Bigtableæ˜¯é€šè¿‡æŠŠåˆ†åŒºä¿¡æ¯ç›´æ¥åšæˆäº†<strong>ä¸‰å±‚æ ‘çŠ¶ç»“æ„çš„Bigtableè¡¨</strong>ï¼Œæ¥è®©æŸ¥è¯¢åˆ†åŒºä½ç½®çš„è¯·æ±‚åˆ†æ•£åˆ°äº†æ•´ä¸ªBigtableé›†ç¾¤é‡Œï¼Œå¹¶ä¸”é€šè¿‡<strong>æŠŠæŸ¥è¯¢çš„å¼•å¯¼ä½ç½®æ”¾åœ¨Chubbyä¸­</strong>ï¼Œè§£å†³äº†å’Œæ“ä½œç³»ç»Ÿç±»ä¼¼çš„â€œå¦‚ä½•å¯åŠ¨â€é—®é¢˜ã€‚è€Œæ•´ä¸ªç³»ç»Ÿçš„<strong>åˆ†åŒºåˆ†é…å·¥ä½œï¼Œç”±Masterå®Œæˆ</strong>ã€‚é€šè¿‡å¯¹äºChubbyé”çš„ä½¿ç”¨ï¼Œå°±è§£å†³äº†Masterã€Tablet Serverè¿›å‡ºæ•´ä¸ªé›†ç¾¤çš„é—®é¢˜ã€‚</p><p>åˆ°è¿™é‡Œï¼ŒBigtableçš„åŸºç¡€æ¶æ„å°±ä»‹ç»å®Œäº†ã€‚ä¸è¿‡æˆ‘ä»¬è¿˜æœ‰ä¸¤ä¸ªéå¸¸é‡è¦çš„çŸ¥è¯†ç‚¹éœ€è¦æ·±å…¥æ¢è®¨ï¼Œä¸€ä¸ªæ˜¯å•ä¸ªTabletçš„åº•å±‚å­˜å‚¨å’Œè¯»å†™ï¼Œå…·ä½“æ˜¯å¦‚ä½•å®ç°æ¥åšåˆ°é«˜æ€§èƒ½çš„ï¼Œå¦ä¸€ä¸ªæ˜¯ä»Šå¤©å‡ºç°çš„ç¥å¥‡çš„Chubbyåˆ°åº•æ˜¯ä»€ä¹ˆã€‚æ¥ä¸‹æ¥çš„ä¸¤èŠ‚è¯¾ï¼Œæˆ‘ä»¬å°±ä¼šä¸€èµ·æ¥å¯»æ‰¾ç­”æ¡ˆã€‚</p><h2>æ¨èé˜…è¯»</h2><p>å¯¹äºæ•°æ®åˆ†åŒºå¯ä»¥æœ‰å“ªäº›æ–¹æ³•ï¼Œ<a href=\"https://book.douban.com/subject/30329536/\">ã€Šæ•°æ®å¯†é›†å‹åº”ç”¨ç³»ç»Ÿè®¾è®¡ã€‹</a>çš„ç¬¬6ç« åšäº†éå¸¸è¯¦å°½çš„è®²è§£ï¼Œä½ å¯ä»¥å»å¥½å¥½è¯»ä¸€ä¸‹ã€‚å¦å¤–ï¼Œå¯¹äºBigtableæœ¬èº«çš„è®ºæ–‡ï¼Œæˆ‘ä¹Ÿå»ºè®®ä½ å¤šèŠ±æ—¶é—´å»å¼„æ¸…æ¥šï¼Œå› ä¸ºåç»­çš„Megastoreã€Spannerç­‰ç­‰çš„è®ºæ–‡ï¼Œéƒ½åªæ˜¯Bigtableçš„å‡çº§æ”¹è¿›è€Œå·²ï¼Œåº•å±‚çš„åŸºæœ¬åŸç†æ˜¯ä¸å˜çš„ã€‚</p><h2>æ€è€ƒé¢˜</h2><p>Bigtableè®ºæ–‡é‡Œçš„ç¬¬7éƒ¨åˆ†â€œæ€§èƒ½è¯„ä¼°â€é‡Œï¼Œä½ å¯ä»¥çœ‹åˆ°Bigtableåœ¨éšæœºè¯»æ•°æ®ä¸Šçš„æ€§èƒ½è¡¨ç°å¹¶ä¸å¥½ï¼Œæ— æ³•çœŸæ­£åšåˆ°éšç€èŠ‚ç‚¹æ•°çš„å¢åŠ çº¿æ€§å¢é•¿ã€‚è¿™æ˜¯ä¸ºä»€ä¹ˆå‘¢ï¼Ÿè¿™ä¸ªå’Œæˆ‘ä»¬ä»Šå¤©è®²çš„Bigtableçš„è®¾è®¡ä¸­çš„å“ªä¸€ä¸ªè®¾è®¡ç‚¹ç›¸å…³ï¼Ÿ</p>","comments":[{"had_liked":false,"id":315276,"user_name":"åœ¨è·¯ä¸Š","can_delete":false,"product_type":"c1","uid":1402511,"ip_address":"","ucode":"6E31908EFE1107","user_header":"https://static001.geekbang.org/account/avatar/00/15/66/8f/02be926d.jpg","comment_is_top":false,"comment_ctime":1633779501,"is_pvip":false,"discussion_count":4,"race_medal":0,"score":"31698550573","product_id":100091101,"comment_content":"å¾è€å¸ˆå¥½ï¼Œåœ¨Bigtableè®ºæ–‡çš„ç¬¬ 7 éƒ¨åˆ†â€œæ€§èƒ½è¯„ä¼°â€é‡Œå†™é“ï¼š<br>Each random read involves the transfer of a 64 KB SSTable block over the network from GFS to a tablet server, out of which only a single 1000-byte value is usedâ€¦â€¦<br>Random and sequential writes perform better than random reads since each tablet server appends all incoming writes to a single commit log and uses group commit to stream these writes efficiently to GFS.<br><br>éšæœºå†™å’Œé¡ºåºå†™çš„æ€§èƒ½æ——é¼“ç›¸å½“ï¼Œä¸ä»…åœ¨å•å°tablet serverä¸Šè¡¨ç°ç±»ä¼¼ï¼Œåœ¨tablet serveré›†ç¾¤ä¸Šè¡¨ç°ä¹Ÿå‡ ä¹ä¸€æ ·ã€‚åŸå› æ˜¯å®ƒä»¬éƒ½ä¼šå…ˆå†™commit logï¼ŒåŒæ­¥ä¿®æ”¹å†…å­˜ä¸­çš„æ•°æ®ï¼Œå¼‚æ­¥ä¿®æ”¹SSTableä¸­çš„æ•°æ®ã€‚éšæœºå†™å’Œé¡ºåºå†™çš„å·®å¼‚åœ¨äºSSTableçš„å˜æ›´ï¼Œç”±äºè¿™ä¸ªæ“ä½œè¢«å¼‚æ­¥æ‰§è¡Œï¼Œæ‰€ä»¥å®ƒä»¬çš„æ€§èƒ½æ²¡æœ‰å·®å¼‚ã€‚<br>å¦‚æœSSTableçš„ä¸ç¼“å­˜åœ¨tablet serverä¸Šï¼Œéšæœºè¯»çš„æ€§èƒ½éå¸¸å·®ï¼Œæ¯”å†™å…¥æ“ä½œå‡ ä¹æ…¢ä¸€ä¸ªæ•°é‡çº§ã€‚åŸå› æ˜¯ä¸ç®¡è¦å®é™…éœ€è¦å¤šå°çš„æ•°æ®ï¼Œéƒ½éœ€è¦ä»GFSä¸ŠåŠ è½½64kçš„SSTableå—æ•°æ®ã€‚å®ƒçš„ç“¶é¢ˆä¸åœ¨äºtablet serverçš„å¤šå°‘ï¼Œè€Œåœ¨äºä»GFSä¸Šè¯»å–æ•°æ®ã€‚<br><br>æˆ‘åœ¨å­¦ä¹ ä»Šå¤©çš„è¯¾ç¨‹å’Œé˜…è¯»Bigtableè®ºæ–‡çš„æ—¶å€™ï¼Œæœ‰ä¸‰ä¸ªç–‘é—®ï¼š<br>1.è¯¾ç¨‹ä¸­æåˆ°é€šè¿‡å¤–éƒ¨æœåŠ¡å»ç›‘æ§Masterçš„å­˜æ´»ï¼Œå¯èƒ½ä¼šå¯¼è‡´ç³»ç»Ÿä¸­å‡ºç°ä¸¤ä¸ªMasterï¼Œé‚£ä¹ˆGFSæ²¡æœ‰è¿™ä¸ªé—®é¢˜å—ï¼Ÿå¦‚æœæœ‰çš„è¯ä¸ä¼šé€ æˆä¸¥é‡çš„åæœå—ï¼Ÿ<br>2.å½“æˆ‘å‘bigtableå†™å…¥æ•°æ®æ—¶ï¼Œmetadataçš„ä¸‰å±‚ç»“æ„ä¼šå¦‚ä½•å˜æ›´ï¼Ÿå˜æ›´çš„è¿‡ç¨‹å¦‚ä½•é¿å…åŠ é”ï¼Ÿå¦‚æœéœ€è¦å…¨å±€é”çš„è¯ï¼Œæˆ‘æƒ³è¯»å†™æ€§èƒ½è‚¯å®šä¸Šä¸å»ã€‚<br>3.éšæœºè¯»æ¯”å†™å…¥æ“ä½œæ…¢ä¸€ä¸ªæ•°é‡çº§æˆ‘è¿˜æ˜¯å¾ˆæƒŠè®¶ï¼Œå› ä¸ºå†™å…¥æ“ä½œçš„commit logéœ€è¦å†™å…¥GFSï¼ŒåŒæ ·æœ‰GFSæ“ä½œï¼Œæ€ä¹ˆèƒ½å·®å‡ºä¸€ä¸ªæ•°é‡çº§ï¼Ÿ","like_count":8,"discussions":[{"author":{"id":1096652,"avatar":"https://static001.geekbang.org/account/avatar/00/10/bb/cc/fac12364.jpg","nickname":"xxx","note":"","ucode":"E79CEA70430449","race_medal":0,"user_type":1,"is_pvip":true},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":533607,"discussion_content":"ç­”æ¡ˆå¾ˆèµï¼ŒæœŸå¾…è€å¸ˆçš„ç‚¹è¯„ã€‚å‰ä¸¤ä¸ªé—®é¢˜ä¸ä¼šï¼Œç¬¬ä¸‰ä¸ªé—®é¢˜ä½ çœ‹å®Œä¸‹ä¸€ç¯‡åº”è¯¥å°±æ˜ç™½äº†ã€‚","likes_number":2,"is_delete":false,"is_hidden":false,"ctime":1637916294,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":2069664,"avatar":"https://static001.geekbang.org/account/avatar/00/1f/94/a0/84342a0d.jpg","nickname":"@","note":"","ucode":"BD87484261ED85","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":547693,"discussion_content":"ä½ çš„ç¬¬ä¸€ç‚¹é—®é¢˜ ä¸ªäººè§‰å¾—  GFS çš„masterä¸ä¼šå‡ºç°è„‘è£‚é—®é¢˜ ä»–å°±æ˜¯ä¸€ä¸ªè®¾è®¡ä¸Šçš„å•ç‚¹æ•…éšœç‚¹  ï¼Œé€šè¿‡ä¸»ä»å¤åˆ¶è¿›è¡Œå®¹é”™ï¼Œ   è€ŒGFSçš„è„‘è£‚å¯èƒ½ä¼šå‡ºç°åœ¨ChunkServerçš„ä¸»ä»ä¹‹é—´ï¼ˆchunkçš„å‰¯æœ¬ å’Œprimaryï¼‰  è¿™ä¸€ç‚¹ GFSé‡‡ç”¨ç§Ÿçº¦æ¥é¿å…è„‘è£‚é—®é¢˜  ","likes_number":1,"is_delete":false,"is_hidden":false,"ctime":1642829075,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1131300,"avatar":"https://static001.geekbang.org/account/avatar/00/11/43/24/3f9f7c70.jpg","nickname":"zixuan","note":"","ucode":"C72920DD05B074","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":543901,"discussion_content":"1. gfsä¹Ÿç”¨äº†chubby\n2. metadataè¡¨å³ä½¿æ™®é€šbigtableè¡¨ï¼Œå°±å’Œä½ å†™å…¥ç”¨æˆ·è¡¨ä¸€æ ·çš„, æ”¯æŒå¹¶å‘è¯»å†™\n3. commit logæ˜¯é¡ºåºå†™ï¼Œæ¯”éšæœºè¯»å½“ç„¶å—","likes_number":1,"is_delete":false,"is_hidden":false,"ctime":1641350839,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1501234,"avatar":"","nickname":"Geek_88604f","note":"","ucode":"33DD1318E53814","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":402432,"discussion_content":"åº”è¯¥åªæœ‰åœ¨åˆ†è£‚æˆ–åˆå¹¶çš„æ—¶å€™æ‰æ”¹å˜metadataçš„ç»“æ„ã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1633877288,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":317770,"user_name":"thomas","can_delete":false,"product_type":"c1","uid":1016777,"ip_address":"","ucode":"9AB945308F1B50","user_header":"https://static001.geekbang.org/account/avatar/00/0f/83/c9/5d03981a.jpg","comment_is_top":false,"comment_ctime":1634956451,"is_pvip":true,"discussion_count":3,"race_medal":0,"score":"10224891043","product_id":100091101,"comment_content":"METADATA çš„ä¸€æ¡è®°å½•ï¼Œå¤§çº¦æ˜¯ 1KBï¼Œè€Œ METADATA çš„ Tablet å¦‚æœé™åˆ¶åœ¨ 128MBï¼Œä¸‰å±‚è®°å½•å¯ä»¥å­˜ä¸‹å¤§çº¦ (128*1000)2=234 ä¸ª Tablet çš„ä½ç½®ï¼Œä¹Ÿå°±æ˜¯å¤§çº¦ 160 äº¿ä¸ª Tablet<br>=============================================ã€‹<br>è¿™ä¸ªæ˜¯å¦‚ä½•ç®—å‡ºæ¥çš„ï¼Ÿ","like_count":2,"discussions":[{"author":{"id":1096652,"avatar":"https://static001.geekbang.org/account/avatar/00/10/bb/cc/fac12364.jpg","nickname":"xxx","note":"","ucode":"E79CEA70430449","race_medal":0,"user_type":1,"is_pvip":true},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":533626,"discussion_content":"è¿™é‡Œåº”è¯¥æ˜¯ç¬”è¯¯äº†ã€‚æƒ³å†™çš„ä¼°è®¡æ˜¯ (128*1000)^2","likes_number":1,"is_delete":false,"is_hidden":false,"ctime":1637918059,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1131300,"avatar":"https://static001.geekbang.org/account/avatar/00/11/43/24/3f9f7c70.jpg","nickname":"zixuan","note":"","ucode":"C72920DD05B074","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":544106,"discussion_content":"ä¸€ä¸ªtablet 128Mï¼Œæ¯æ¡è®°å½• 1K, åˆ™å…±æœ‰128M/1K = 2^17 ä¸ªç´¢å¼•ä½, 2å±‚å°±æ˜¯ (2^17)^2 = 2^34.","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1641397153,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1043306,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/eb/6a/da88102a.jpg","nickname":"é˜¿ä¸œ","note":"","ucode":"221E334D79F5FB","race_medal":0,"user_type":1,"is_pvip":true},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":410746,"discussion_content":"ï¼ˆ128*1000ï¼‰*ï¼ˆ128*1000ï¼‰=2**34 å·®ä¸å¤šæ˜¯160äº¿","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1635769175,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":315064,"user_name":"é™ˆè¿ª","can_delete":false,"product_type":"c1","uid":1019744,"ip_address":"","ucode":"1A64122CC47337","user_header":"https://static001.geekbang.org/account/avatar/00/0f/8f/60/be0a8805.jpg","comment_is_top":false,"comment_ctime":1633678112,"is_pvip":false,"discussion_count":2,"race_medal":0,"score":"5928645408","product_id":100091101,"comment_content":"é—®è€å¸ˆï¼š<br>10å¤šå¹´å‰çš„Bigableæ¶æ„æ˜¯å¦æ˜¯ä¸€ç§ç¬¦åˆå½“ä¸‹æ½®æµçš„â€œå­˜å‚¨å’Œè®¡ç®—åˆ†ç¦»â€çš„æ¶æ„ï¼Ÿå­˜å‚¨GFSåšå¾—å¤Ÿäº†ï¼Œå°±ç”¨GFSå•ç‹¬å­˜ï¼Œå‰é¢å“ªä¸ªtabletå‹åŠ›å¤§å¯ä»¥è°ƒåº¦å‡ºæ¥å¤šä¸€ç‚¹ã€‚<br>å½“ä¸‹åˆ™æ˜¯objcet storageåˆä¾¿å®œåˆå¯é ï¼Œä¸è¦share nothingæœ¬æœºå†åšä¸€éå­˜å‚¨äº†ï¼Œéƒ½äº¤ç»™object storage","like_count":1,"discussions":[{"author":{"id":1045724,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/f4/dc/2bd409a5.jpg","nickname":"rayallen335","note":"","ucode":"C39AD40AEAA60C","race_medal":0,"user_type":1,"is_pvip":true},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":531889,"discussion_content":"è¿™ä¸ªè¯„è®ºå†™çš„æœ‰æ‚Ÿæ€§","likes_number":1,"is_delete":false,"is_hidden":false,"ctime":1637459643,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"user_type\":1}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":2822342,"avatar":"https://static001.geekbang.org/account/avatar/00/2b/10/c6/5e7f3148.jpg","nickname":"SomnusğŸ’«","note":"","ucode":"4719F7FDC4CFA2","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":407365,"discussion_content":"æˆ‘æ¯”è¾ƒåŒæ„ä½ çš„çœ‹æ³•ï¼Œä¸ºä»€ä¹ˆç§‘ç ”ï¼Œç§‘ç ”å°±æ˜¯è§£å†³å½“å‰çš„ç“¶é¢ˆã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1634991590,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":315046,"user_name":"é™ˆè¿ª","can_delete":false,"product_type":"c1","uid":1019744,"ip_address":"","ucode":"1A64122CC47337","user_header":"https://static001.geekbang.org/account/avatar/00/0f/8f/60/be0a8805.jpg","comment_is_top":false,"comment_ctime":1633670709,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"5928638005","product_id":100091101,"comment_content":"éšæœºè¯»ï¼Œæœ€å·®æƒ…å†µä¸‹ï¼Œè¦ç½‘ç»œèµ°æŸ¥å…ƒæ•°æ®+ä»gfsè¯»å‡ºæ¥ï¼Œgfsä¸€è¯»ä¸€blockå°±æ˜¯64mbï¼Œä¸€ä¸ªkey valueå¤§å°å¾€å¾€è¿œå°äºè¿™ä¸ªæ•°å­—ã€‚å†™çš„è¯å°±æ²¡è¿™ä¸ªé—®é¢˜ï¼Œè¯»å†…å­˜ä¹Ÿä¼šå¿«ï¼Œé¡ºåºè¯»çš„è¯keyæ’åº+ gfsæ”¯æŒå¾—æœ¬æ¥ä¹Ÿå¥½ã€‚ç›¸æ¯”ä¹‹ä¸‹ï¼Œéšæœºè¯»æ˜¾å¾—å¾ˆç³Ÿç³•äº†","like_count":1},{"had_liked":false,"id":315043,"user_name":"é‚£æ—¶åˆ»","can_delete":false,"product_type":"c1","uid":1150927,"ip_address":"","ucode":"B0D150856C3A4A","user_header":"https://static001.geekbang.org/account/avatar/00/11/8f/cf/890f82d6.jpg","comment_is_top":false,"comment_ctime":1633669315,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"5928636611","product_id":100091101,"comment_content":"Bigtableæ•°æ®éšæœºè¯»å†™æ…¢ï¼Œæˆ‘æƒ³åˆ°çš„åŸå› æ˜¯ï¼šå…¶ä¸€æ˜¯ä¸ªä¸‰å±‚ Tablet ä¿¡æ¯å­˜å‚¨çš„æ¶æ„ï¼Œè¯»å†™æœ‰å¤šæ¬¡ç½‘ç»œè¯·æ±‚ã€‚å…¶äºŒæ˜¯tabletçš„åˆ†è£‚å’Œåˆå¹¶ï¼Œä½¿æ•°æ®äº§ç”Ÿè¿ç§»ã€‚","like_count":2},{"had_liked":false,"id":314991,"user_name":"å³°","can_delete":false,"product_type":"c1","uid":1056019,"ip_address":"","ucode":"C53CB64E8E7D19","user_header":"https://static001.geekbang.org/account/avatar/00/10/1d/13/31ea1b0b.jpg","comment_is_top":false,"comment_ctime":1633646018,"is_pvip":true,"discussion_count":0,"race_medal":0,"score":"5928613314","product_id":100091101,"comment_content":"éšæœºè¯»æœ€ååªè½åœ¨ä¸€å°severä¸Šï¼Œä¸èƒ½å¹¶è¡Œï¼Œå†åŠ ä¸Šä¸€æ¬¡è¯»å–è½¬æ¢æˆäº†ä¸²è¡Œçš„ä¸‰æ¬¡è¯»ï¼Œè‡ªç„¶ç›¸è¾ƒè€Œè¨€æ˜¯æ…¢çš„ã€‚","like_count":1},{"had_liked":false,"id":330868,"user_name":"piboye","can_delete":false,"product_type":"c1","uid":1066752,"ip_address":"","ucode":"7CFD8712857A85","user_header":"https://static001.geekbang.org/account/avatar/00/10/47/00/3202bdf0.jpg","comment_is_top":false,"comment_ctime":1642236391,"is_pvip":true,"discussion_count":0,"race_medal":0,"score":"1642236391","product_id":100091101,"comment_content":"tabletè¿ç§»æ˜¯æ€ä¹ˆæçš„ï¼Ÿ è¿ç§»ä¼šå¸¦æ¥çŸ­æ—¶é—´ä¸å¯ä»¥ç”¨å§ï¼Ÿ","like_count":0},{"had_liked":false,"id":329610,"user_name":"Geek_80bb15","can_delete":false,"product_type":"c1","uid":2798515,"ip_address":"","ucode":"F13C533E0E6FD2","user_header":"","comment_is_top":false,"comment_ctime":1641445244,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1641445244","product_id":100091101,"comment_content":"å¾è€å¸ˆå¥½ï¼ŒHBaseæŠŠRootè¡¨å¹²æ‰äº†ï¼Œæ˜¯æ€ä¹ˆè§£å†³Metaè¡¨çš„çƒ­ç‚¹è®¿é—®é—®é¢˜çš„å‘¢ï¼Ÿå¤šè°¢","like_count":0},{"had_liked":false,"id":329184,"user_name":"zixuan","can_delete":false,"product_type":"c1","uid":1131300,"ip_address":"","ucode":"C72920DD05B074","user_header":"https://static001.geekbang.org/account/avatar/00/11/43/24/3f9f7c70.jpg","comment_is_top":false,"comment_ctime":1641198786,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1641198786","product_id":100091101,"comment_content":"è¯·é—®è€å¸ˆï¼Œ5.1 Tablet Location è¿™é‡Œçš„ LocationæŒ‡çš„æ˜¯tabletçš„gfsæ–‡ä»¶è·¯å¾„ï¼Œè¿˜æ˜¯å…¶æ‰€è¿°çš„tablet serverçš„åœ°å€ï¼Ÿ","like_count":0},{"had_liked":false,"id":328622,"user_name":"Helios","can_delete":false,"product_type":"c1","uid":1380758,"ip_address":"","ucode":"BE6B98EE8F0D09","user_header":"http://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTKJrOl63enWXCRxN0SoucliclBme0qrRb19ATrWIOIvibKIz8UAuVgicBMibIVUznerHnjotI4dm6ibODA/132","comment_is_top":false,"comment_ctime":1640790760,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1640790760","product_id":100091101,"comment_content":"å› ä¸ºsstableè¿™ç§æ ¼å¼æ˜¯ç”¨lsm treeå®ç°çš„æ›´åŠ é€‚åˆé¡ºåºè¯»ï¼Œb treeæ›´é€‚åˆéšæœºè¯»","like_count":0},{"had_liked":false,"id":322818,"user_name":"æ ¸æ¡ƒ","can_delete":false,"product_type":"c1","uid":1385204,"ip_address":"","ucode":"7AB05270CBCCCB","user_header":"https://static001.geekbang.org/account/avatar/00/15/22/f4/9fd6f8f0.jpg","comment_is_top":false,"comment_ctime":1637600406,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1637600406","product_id":100091101,"comment_content":"è¿™é‡Œæœ‰å‡ ä¸ªé—®é¢˜ä¸å¤ªç†è§£ã€‚<br><br>1.é¦–å…ˆè¯»å¯ä»¥ä¸ç»è¿‡masterèƒ½ç†è§£ï¼Œå†™ä¹Ÿä¸ç»è¿‡å°±æœ‰ç‚¹å›°æƒ‘äº†ï¼Œæ—¢ç„¶masterå°±æ˜¯è´Ÿè´£å¹³è¡¡tablet serverçš„ï¼Œé‚£ä¹ˆå†™å…¥çš„æ—¶å€™ï¼Œåˆ°åº•æŒ‡å®šå“ªä¸ªserverå†™å…¥?è¿™ä¸ªè¯¥ç”±è°æ¥è´Ÿè´£å‘¢ï¼Ÿå¦‚æœä¸æ˜¯masterï¼Œé‚£ä¹ˆå¿…ç„¶å°±å¯èƒ½ä¼šæœ‰æ•°æ®å€¾æ–œé—®é¢˜å§ã€‚<br>2.æ–‡ä»¶æŸ¥è¯¢è¿‡ç¨‹é‚£é‡Œï¼Œä¸‰æ¬¡è¯·æ±‚è·å–åˆ°å…·ä½“æ•°æ®æ‰€åœ¨çš„tablet serverçš„tabletsä¸Šé¢ï¼Œè¿™é‡Œæœ‰ä¸ªç–‘æƒ‘ã€‚ä¸‰çº§æ¶æ„ä¸‹å’Œæ–‡ä»¶ç³»ç»Ÿçš„æ–‡ä»¶ç›®å½•æ ‘ç±»ä¼¼å˜›ï¼Œä½†æ˜¯è®¿é—®root tabletçš„æ—¶å€™ï¼Œæ€ä¹ˆä¼šçŸ¥é“ä½ æ‰€åœ¨çš„è¡¨åœ¨å“ªä¸ªèŠ‚ç‚¹å‘¢ï¼Ÿè¿™é‡Œåˆä¸åƒåŸŸåè®¿é—®é‚£æ ·ï¼Œä¸€ä¸ªroot tabletä¸å¯èƒ½å…·ä½“çŸ¥é“ä½ è¿™ä¸ªè¡¨å¯ä»¥ä»å“ªé‡Œè¯»å–çš„å‘€ï¼Œåº”è¯¥æ˜¯åªæœ‰ä¸‹é¢ä¸€å±‚æ•°æ®æ‰€å¯¹åº”çš„ä¸Šçº§æ‰çœŸæ­£çŸ¥é“çš„ã€‚","like_count":0},{"had_liked":false,"id":321435,"user_name":"æ—å†›äºº","can_delete":false,"product_type":"c1","uid":2220955,"ip_address":"","ucode":"37A126E92E8B52","user_header":"https://static001.geekbang.org/account/avatar/00/21/e3/9b/b045124d.jpg","comment_is_top":false,"comment_ctime":1636877319,"is_pvip":false,"discussion_count":1,"race_medal":0,"score":"1636877319","product_id":100091101,"comment_content":"è€å¸ˆçœ‹å®Œè¿™èŠ‚,æˆ‘æœ‰ä¸¤ä¸ªé—®é¢˜:<br>1.è™½ç„¶BTåœ¨è¿›è¡Œè¯»å†™çš„æ—¶å€™, ä¸éœ€è¦ç»è¿‡Master, ä½†æ˜¯Root Tablet æœ¬èº«ä¼šä¸ä¼šæˆä¸ºç³»ç»Ÿçš„ç“¶é¢ˆå‘¢, å¦‚æœåŒæ—¶æœ‰å¤§é‡ç¬¬ä¸€æ¬¡è¯·æ±‚çš„å®¢æˆ·ç«¯, éƒ½å»è®¿é—®Root Tablet, è€ŒRoot Tabletåˆä¸ä¼šåˆ†ç‰‡, BTä¼šæ€ä¹ˆå¤„ç†å‘¢?<br>2.MetaDataè¡¨ä¸­çš„è¡Œé”®æ˜¯æ€ä¹ˆè®¾è®¡çš„å‘¢ï¼Ÿ æ˜¯ &quot;è¡¨å+å¯¹åº”Tabletèµ·å§‹è¡Œé”®&quot; å—ï¼Ÿ","like_count":0,"discussions":[{"author":{"id":1385204,"avatar":"https://static001.geekbang.org/account/avatar/00/15/22/f4/9fd6f8f0.jpg","nickname":"æ ¸æ¡ƒ","note":"","ucode":"7AB05270CBCCCB","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":532455,"discussion_content":"ç¬¬ä¸€ä¸ªé—®é¢˜ï¼Œroot tabletå¯ä»¥ç†è§£ä¸ºé™æ€æ•°æ®äº†ï¼Œé‚£ä¹ˆç›´æ¥åœ¨å„ä¸ªchubbyèŠ‚ç‚¹ç¼“å­˜ä¸€ä¸‹root tabletæ‰€åœ¨èŠ‚ç‚¹ä¸å°±å¯ä»¥äº†ï¼Œå ç”¨ç©ºé—´ä¸å¤§çš„ã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1637600035,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"user_type\":1}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":318276,"user_name":"Helios","can_delete":false,"product_type":"c1","uid":1380758,"ip_address":"","ucode":"BE6B98EE8F0D09","user_header":"http://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTKJrOl63enWXCRxN0SoucliclBme0qrRb19ATrWIOIvibKIz8UAuVgicBMibIVUznerHnjotI4dm6ibODA/132","comment_is_top":false,"comment_ctime":1635227430,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1635227430","product_id":100091101,"comment_content":"åŸæ¥Bigtableé›†ç¾¤Chubbyæ‰æ˜¯æ ¸å¿ƒ<br>","like_count":0},{"had_liked":false,"id":317844,"user_name":"SomnusğŸ’«","can_delete":false,"product_type":"c1","uid":2822342,"ip_address":"","ucode":"4719F7FDC4CFA2","user_header":"https://static001.geekbang.org/account/avatar/00/2b/10/c6/5e7f3148.jpg","comment_is_top":false,"comment_ctime":1634991678,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1634991678","product_id":100091101,"comment_content":"æ„Ÿè§‰çœ‹å®Œä¸€éä¹‹åè¿˜æœ‰ä¸€äº›äº›ä¹±ã€‚è¿˜è¦å¤šå­¦å‡ æ¬¡ï¼Œåè¿‡æ¥å†çœ‹ã€‚<br>","like_count":0},{"had_liked":false,"id":317131,"user_name":"Geek_fe2f4c","can_delete":false,"product_type":"c1","uid":2171894,"ip_address":"","ucode":"18AAC3DC04B1B7","user_header":"https://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTL33HdAfZA9cQseTJ5HIWZ2XNVes8X29E5VabpU1q0UicxClNppEwUcMOXEZnTxPUEibv8uic5Oiaia8lQ/132","comment_is_top":false,"comment_ctime":1634693499,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1634693499","product_id":100091101,"comment_content":"å®¢æˆ·ç«¯å¦‚æœéœ€è¦åšç‰¹æ®Šç¼“å­˜ï¼Œé‚£å°±è¿˜æ˜¯éœ€è¦å®¢æˆ·ç«¯åšç‰¹æ®Šè®¾è®¡ï¼Œå¯¹å§","like_count":0},{"had_liked":false,"id":317100,"user_name":"CRT","can_delete":false,"product_type":"c1","uid":1442864,"ip_address":"","ucode":"59F5C8C0674ADC","user_header":"https://static001.geekbang.org/account/avatar/00/16/04/30/7f2cb8e3.jpg","comment_is_top":false,"comment_ctime":1634688820,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1634688820","product_id":100091101,"comment_content":"æ£€æµ‹çš„æ–¹æ³•ä¹Ÿä¸å¤æ‚ï¼Œå…¶å®å°±æ˜¯é€šè¿‡å¿ƒè·³ã€‚Master ä¼šå®šæœŸé—® Tabletsï¼Œä½ æ˜¯ä¸æ˜¯è¿˜å ç€ç‹¬å é”å‘€ï¼Ÿ<br>è¿™ä¸ªåº”è¯¥æ˜¯å®šæœŸé—®Tablets Serverï¼Ÿ","like_count":0},{"had_liked":false,"id":316342,"user_name":"thomas","can_delete":false,"product_type":"c1","uid":1016777,"ip_address":"","ucode":"9AB945308F1B50","user_header":"https://static001.geekbang.org/account/avatar/00/0f/83/c9/5d03981a.jpg","comment_is_top":false,"comment_ctime":1634279172,"is_pvip":true,"discussion_count":0,"race_medal":0,"score":"1634279172","product_id":100091101,"comment_content":"è€å¸ˆï¼ŒBigtable çš„åŸºæœ¬æ•°æ®æ¨¡å‹ å¸Œæœ›ä¸¾ä¸ªå®é™…çš„æ•°æ®åº”ç”¨åœºæ™¯","like_count":0},{"had_liked":false,"id":316033,"user_name":"ç°ç°","can_delete":false,"product_type":"c1","uid":1122397,"ip_address":"","ucode":"907A2FD339E158","user_header":"https://static001.geekbang.org/account/avatar/00/11/20/5d/69170b96.jpg","comment_is_top":false,"comment_ctime":1634112023,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1634112023","product_id":100091101,"comment_content":"æ‰“å¡ï¼Œä¸æ˜¯å¾ˆä»”ç»†ï¼Œè¿˜éœ€è¦é‡æ–°è¯»ã€‚","like_count":0},{"had_liked":false,"id":315398,"user_name":"webmin","can_delete":false,"product_type":"c1","uid":1047014,"ip_address":"","ucode":"98B0CA882454E8","user_header":"https://static001.geekbang.org/account/avatar/00/0f/f9/e6/47742988.jpg","comment_is_top":false,"comment_ctime":1633878109,"is_pvip":true,"discussion_count":0,"race_medal":0,"score":"1633878109","product_id":100091101,"comment_content":"æ€è€ƒé¢˜ï¼š<br>1. éšæœºè¯»æ— æ³•çœŸæ­£åšåˆ°éšç€èŠ‚ç‚¹æ•°çš„å¢åŠ çº¿æ€§å¢é•¿ï¼Œè¿™æ˜¯ä¸ºä»€ä¹ˆå‘¢ï¼Ÿ<br>è¯»å–1000å­—èŠ‚çš„å€¼ï¼Œéœ€è¦ä»GFSè¯»å–ä¸€ä¸ª64KBçš„Blockï¼Œéšç€æœºå™¨çš„å¢åŠ 1Gbps ç½‘ç»œå¸¦å®½è¾¾åˆ°é¥±å’Œï¼Œæ¯ä¸ªèŠ‚ç‚¹çš„ååé‡éƒ½æœ‰æ˜¾ç¤ºä¸‹é™ï¼Œç“¶é¢ˆåœ¨ç½‘ç»œæ€»å¸¦å®½ã€‚<br>2. è¿™ä¸ªå’Œæˆ‘ä»¬ä»Šå¤©è®²çš„ Bigtable çš„è®¾è®¡ä¸­çš„å“ªä¸€ä¸ªè®¾è®¡ç‚¹ç›¸å…³ï¼Ÿ<br>Bigtableçš„tabletçš„ä¸‰å±‚ç»“æ„è®¾è®¡æœ‰å…³","like_count":0},{"had_liked":false,"id":315226,"user_name":"å´å°æ™º","can_delete":false,"product_type":"c1","uid":1310798,"ip_address":"","ucode":"C7C9F58B5C9F7B","user_header":"https://static001.geekbang.org/account/avatar/00/14/00/4e/be2b206b.jpg","comment_is_top":false,"comment_ctime":1633757008,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1633757008","product_id":100091101,"comment_content":"æƒ³è¯·æ•™è€å¸ˆï¼Œmetadata é‡Œé¢å…·ä½“å­˜äº†ä»€ä¹ˆå‘¢ï¼Ÿä¸ gfs ä¸­æ–‡ä»¶çš„ä½ç½®çš„å…³è”çš„ä¿¡æ¯æ˜¯æ€ä¹ˆå­˜çš„ï¼Ÿ","like_count":0},{"had_liked":false,"id":315081,"user_name":"å´å°æ™º","can_delete":false,"product_type":"c1","uid":1310798,"ip_address":"","ucode":"C7C9F58B5C9F7B","user_header":"https://static001.geekbang.org/account/avatar/00/14/00/4e/be2b206b.jpg","comment_is_top":false,"comment_ctime":1633682264,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1633682264","product_id":100091101,"comment_content":"æƒ³è¯·æ•™è€å¸ˆï¼Œtablet çš„ split å…·ä½“ä¼šåšäº›ä»€ä¹ˆï¼Ÿä¼šæ¶‰åŠåˆ° gfs ä¸­æ•°æ®çš„è¿ç§»å—ï¼Ÿè¿˜æ˜¯ä»…æ¶‰åŠåˆ° metadata çš„ä¿®æ”¹ï¼Ÿ","like_count":0},{"had_liked":false,"id":315061,"user_name":"å´å°æ™º","can_delete":false,"product_type":"c1","uid":1310798,"ip_address":"","ucode":"C7C9F58B5C9F7B","user_header":"https://static001.geekbang.org/account/avatar/00/14/00/4e/be2b206b.jpg","comment_is_top":false,"comment_ctime":1633676860,"is_pvip":false,"discussion_count":2,"race_medal":0,"score":"1633676860","product_id":100091101,"comment_content":"METADATA çš„ä¸€æ¡è®°å½•ï¼Œå¤§çº¦æ˜¯ 1KBï¼Œè€Œ METADATA çš„ Tablet å¦‚æœé™åˆ¶åœ¨ 128MBï¼Œä¸‰å±‚è®°å½•å¯ä»¥å­˜ä¸‹å¤§çº¦ (128*1000)2=234 ä¸ª Tablet çš„ä½ç½®ï¼Œä¹Ÿå°±æ˜¯å¤§çº¦ 160 äº¿ä¸ª Tabletï¼Œè‚¯å®šæ˜¯å¤Ÿç”¨äº†ã€‚  ä¸­  (128*1000)2=234  è¿™ä¸ªæ€ä¹ˆç†è§£ï¼Ÿ","like_count":0,"discussions":[{"author":{"id":1051022,"avatar":"https://static001.geekbang.org/account/avatar/00/10/09/8e/2ff2823e.jpg","nickname":"howhigh","note":"","ucode":"C21ABC017C145D","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":538643,"discussion_content":"1mb/1kb=1024â‰ˆ1000","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1639467716,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1059926,"avatar":"https://static001.geekbang.org/account/avatar/00/10/2c/56/ff7a9730.jpg","nickname":"è®¸çµ","note":"","ucode":"0296EC9929B570","race_medal":0,"user_type":1,"is_pvip":true},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":401930,"discussion_content":"ï¼ˆ128*1000)^2 = (2^7*2^10)^2 = 2^34","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1633767754,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]}]}