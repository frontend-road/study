{"id":10755,"title":"第25讲 | 软件定义网络：共享基础设施的小区物业管理办法","content":"<p>上一节我们说到，使用原生的VLAN和Linux网桥的方式来进行云平台的管理，但是这样在灵活性、隔离性方面都显得不足，而且整个网络缺少统一的视图、统一的管理。</p><p>可以这样比喻，云计算就像大家一起住公寓，要共享小区里面的基础设施，其中网络就相当于小区里面的电梯、楼道、路、大门等，大家都走，往往会常出现问题，尤其在上班高峰期，出门的人太多，对小区的物业管理就带来了挑战。</p><p>物业可以派自己的物业管理人员，到每个单元的楼梯那里，将电梯的上下行速度调快一点，可以派人将隔离健身区、景色区的栅栏门暂时打开，让大家可以横穿小区，直接上地铁，还可以派人将多个小区出入口，改成出口多、入口少等等。等过了十点半，上班高峰过去，再派人都改回来。</p><h2>软件定义网络（SDN）</h2><p>这种模式就像传统的网络设备和普通的Linux网桥的模式，配置整个云平台的网络通路，你需要登录到这台机器上配置这个，再登录到另外一个设备配置那个，才能成功。</p><p>如果物业管理人员有一套智能的控制系统，在物业监控室里就能看到小区里每个单元、每个电梯的人流情况，然后在监控室里面，只要通过远程控制的方式，拨弄一个手柄，电梯的速度就调整了，栅栏门就打开了，某个入口就改出口了。</p><!-- [[[read_end]]] --><p>这就是软件定义网络（SDN）。它主要有以下三个特点。</p><p><img src=\"https://static001.geekbang.org/resource/image/34/f9/346fe3b3dbe1024e7119ec4ffa9377f9.jpg?wh=817*754\" alt=\"\"></p><ul>\n<li>\n<p><strong>控制与转发分离</strong>：转发平面就是一个个虚拟或者物理的网络设备，就像小区里面的一条条路。控制平面就是统一的控制中心，就像小区物业的监控室。它们原来是一起的，物业管理员要从监控室出来，到路上去管理设备，现在是分离的，路就是走人的，控制都在监控室。</p>\n</li>\n<li>\n<p><strong>控制平面与转发平面之间的开放接口</strong>：控制器向上提供接口，被应用层调用，就像总控室提供按钮，让物业管理员使用。控制器向下调用接口，来控制网络设备，就像总控室会远程控制电梯的速度。这里经常使用两个名词，前面这个接口称为<strong>北向接口</strong>，后面这个接口称为<strong>南向接口</strong>，上北下南嘛。</p>\n</li>\n<li>\n<p><strong>逻辑上的集中控制</strong>：逻辑上集中的控制平面可以控制多个转发面设备，也就是控制整个物理网络，因而可以获得全局的网络状态视图，并根据该全局网络状态视图实现对网络的优化控制，就像物业管理员在监控室能够看到整个小区的情况，并根据情况优化出入方案。</p>\n</li>\n</ul><h2>OpenFlow和OpenvSwitch</h2><p>SDN有很多种实现方式，我们来看一种开源的实现方式。</p><p>OpenFlow是SDN控制器和网络设备之间互通的南向接口协议，OpenvSwitch用于创建软件的虚拟交换机。OpenvSwitch是支持OpenFlow协议的，当然也有一些硬件交换机也支持OpenFlow协议。它们都可以被统一的SDN控制器管理，从而实现物理机和虚拟机的网络连通。</p><p><img src=\"https://static001.geekbang.org/resource/image/22/15/220b53c0f027763yy54c1a08yy2e5a15.jpg?wh=2453*1893\" alt=\"\"></p><p>SDN控制器是如何通过OpenFlow协议控制网络的呢？</p><p><img src=\"https://static001.geekbang.org/resource/image/1c/78/1c739b9ecc23e9b7c246136782fcd078.jpg?wh=1713*1136\" alt=\"\"></p><p>在OpenvSwitch里面，有一个流表规则，任何通过这个交换机的包，都会经过这些规则进行处理，从而接收、转发、放弃。</p><p>那流表长啥样呢？其实就是一个个表格，每个表格好多行，每行都是一条规则。每条规则都有优先级，先看高优先级的规则，再看低优先级的规则。</p><p><img src=\"https://static001.geekbang.org/resource/image/31/2f/314c82553a164444437b25b215fa012f.jpg?wh=2080*1441\" alt=\"\"></p><p>对于每一条规则，要看是否满足匹配条件。这些条件包括，从哪个端口进来的，网络包头里面有什么等等。满足了条件的网络包，就要执行一个动作，对这个网络包进行处理。可以修改包头里的内容，可以跳到任何一个表格，可以转发到某个网口出去，也可以丢弃。</p><p>通过这些表格，可以对收到的网络包随意处理。</p><p><img src=\"https://static001.geekbang.org/resource/image/8e/1a/8e8751005253a47a823f08d6ac6cfc1a.jpg?wh=3699*1847\" alt=\"\"></p><p>具体都能做什么处理呢？通过上面的表格可以看出，简直是想怎么处理怎么处理，可以覆盖TCP/IP协议栈的四层。</p><p>对于物理层：</p><ul>\n<li>\n<p>匹配规则包括从哪个口进来；</p>\n</li>\n<li>\n<p>执行动作包括从哪个口出去。</p>\n</li>\n</ul><p>对于MAC层：</p><ul>\n<li>\n<p>匹配规则包括：源MAC地址是多少？（dl_src），目标MAC是多少？（dl_dst），所属vlan是多少？（dl_vlan）；</p>\n</li>\n<li>\n<p>执行动作包括：修改源MAC（mod_dl_src），修改目标MAC（mod_dl_dst），修改VLAN（mod_vlan_vid），删除VLAN（strip_vlan），MAC地址学习（learn）。</p>\n</li>\n</ul><p>对于网络层：</p><ul>\n<li>\n<p>匹配规则包括：源IP地址是多少？(nw_src)，目标IP是多少？（nw_dst）。</p>\n</li>\n<li>\n<p>执行动作包括：修改源IP地址（mod_nw_src），修改目标IP地址（mod_nw_dst）。</p>\n</li>\n</ul><p>对于传输层：</p><ul>\n<li>\n<p>匹配规则包括：源端口是多少？（tp_src），目标端口是多少？（tp_dst）。</p>\n</li>\n<li>\n<p>执行动作包括：修改源端口（mod_tp_src），修改目标端口（mod_tp_dst）。</p>\n</li>\n</ul><p>总而言之，对于OpenvSwitch来讲，网络包到了我手里，就是一个Buffer，我想怎么改怎么改，想发到哪个端口就发送到哪个端口。</p><p>OpenvSwitch有本地的命令行可以进行配置，能够实验咱们前面讲过的一些功能。我们可以通过OpenvSwitch的命令创建一个虚拟交换机。然后可以将多个虚拟端口port添加到这个虚拟交换机上。比如说下面这个add-br命令，就是创建虚拟交换机的。</p><pre><code>ovs-vsctl add-br br0\n</code></pre><h2>实验一：用OpenvSwitch实现VLAN的功能</h2><p>下面我们实验一下通过OpenvSwitch实现VLAN的功能，在OpenvSwitch中端口port分两种，分别叫做access port和trunk  port。</p><p>第一类是access port：</p><ul>\n<li>这个端口可以配置一个tag，其实就是一个VLAN ID，从这个端口进来的包都会被打上这个tag；</li>\n<li>如果网络包本身带有某个VLAN ID并且等于这个tag，则这个包就会从这个port发出去；</li>\n<li>从access port发出的包就会把VLAN ID去掉。</li>\n</ul><p>第二类是trunk port：</p><ul>\n<li>这个port是不配置任何tag的，配置叫trunks的参数；</li>\n<li>如果trunks为空，则所有的VLAN都trunk，也就意味着对于所有的VLAN的包，无论本身带什么VLAN ID，我还是让他携带着这个VLAN ID，如果没有设置VLAN，就属于VLAN 0，全部允许通过；</li>\n<li>如果trunks不为空，则仅仅允许带着这些VLAN ID的包通过。</li>\n</ul><p>我们通过以下命令创建如下的环境：</p><pre><code>ovs-vsctl add-port br0 first_br\novs-vsctl add-port br0 second_br\novs-vsctl add-port br0 third_br\novs-vsctl set Port vnet0 tag=101\novs-vsctl set Port vnet1 tag=102\novs-vsctl set Port vnet2 tag=103\novs-vsctl set Port first_br tag=103\novs-vsctl clear Port second_br tag\novs-vsctl set Port third_br trunks=101,102\n</code></pre><p>另外要配置禁止MAC地址学习。</p><pre><code>ovs-vsctl set bridge br0 flood-vlans=101,102,103\n</code></pre><p>这样就形成了如下的拓扑图，有三个虚拟机，有三个网卡，都连到一个叫br0的网桥上，并且他们被都打了不同的VLAN tag。</p><p><img src=\"https://static001.geekbang.org/resource/image/8f/08/8ffb2a94ae0393f1785f8fefd5ea5908.jpg?wh=2174*1499\" alt=\"\"></p><p>创建好了环境以后，我们来做这个实验。</p><p>首先，我们从192.168.100.102来ping 192.168.100.103，然后用tcpdump进行抓包。由于192.168.100.102和first_br都配置了tag103，也就是说他们都属于同一个VLAN  103的，因而这个first_if是能够收到包的。但是根据access port的规则，从first_br出来的包头是没有带VLAN ID的。</p><p>由于second_br是trunk port，所有的VLAN都会放行，因而second_if也是能收到包的，并且根据trunk port的规则，出来的包的包头里面是带有VLAN ID的。</p><p>由于third_br仅仅配置了允许VLAN 101和102通过，不允许103通过，因而third_if他是收不到包的。</p><p>然后我们再尝试，从192.168.100.100来ping 192.168.100.105。 因为192.168.100.100是配置了VLAN 101的，因为second_br是配置了trunk的，是全部放行的，所以说second_if是可以收到包的。那third_br是配置了可以放行VLAN 101和102，所以说third_if是可以收到包的。当然ping不通，因为从third_br出来的包是带VLAN的，而third_if他本身不属于某个VLAN，所以说他ping不通，但是能够收到包</p><p>这里补充说明一下，收到包和ping不同不矛盾，要想ping的通，需要发送ICMP包，并且收到回复，而仅仅收到包，则不需要回复。这里正是这种情况，third_if收到了这个包，但是发现VLAN ID匹配不上，就会把包丢了，不回复，也就Ping不通了。</p><p>first_br是属于VLAN 103的，因而first_if是收不到包的。second_if是能够收到包的，而且可以看到包头里面是带VLAN 101的。third_if也是能收到包的，而且包头里面也是带VLAN I101的。</p><p>最后我们再尝试，从192.168.100.101来ping 192.168.100.104，因为192.168.100.101是属于VLAN 102的， 因而second_if和third_if都因为配置了trunk，是都可以收到包的。first_br是属于VLAN 103的，他不属于VLAN  102，所以first_if是收不到包的。second_br能够收到包，并且包头里面是带VLAN ID  102的。third_if也能收到包，并且包头里面也是带VLAN ID  102的。</p><p>通过这个例子，我们可以看到，通过OpenvSwitch，不用买一个支持VLAN的交换机，你也能学习VLAN的工作模式了。</p><h2>实验二：用OpenvSwitch模拟网卡绑定，连接交换机</h2><p>接下来，我们来做另一个实验。在前面，我们还说过，为了高可用，可以使用网卡绑定，连接到交换机，OpenvSwitch也可以模拟这一点。</p><p>在OpenvSwitch里面，有个bond_mode，可以设置为以下三个值：</p><ul>\n<li>\n<p>active-backup：一个连接是active，其他的是backup，只有当active失效的时候，backup才顶上；</p>\n</li>\n<li>\n<p>balance-slb：流量按照源MAC和output VLAN进行负载均衡；</p>\n</li>\n<li>\n<p>balance-tcp：必须在支持LACP协议的情况下才可以，可根据L2、L3、L4进行负载均衡（L2、L3、L4指的是网络协议2、3、4层）</p>\n</li>\n</ul><p>我们搭建一个测试环境。这个测试环境是两台虚拟机连接到br0上，另外两台虚拟机连接到br1上，br0和br1之间通过两条通路进行bond（绑定）。形成如下的拓扑图。</p><p><img src=\"https://static001.geekbang.org/resource/image/d2/ce/d2381bd12ab8620c64249f05fd7d19ce.jpg?wh=1227*1864\" alt=\"\"></p><p>我们使用下面的命令，建立bond连接。</p><pre><code>ovs-vsctl add-bond br0 bond0 first_br second_br\novs-vsctl add-bond br1 bond1 first_if second_if\novs-vsctl set Port bond0 lacp=active\novs-vsctl set Port bond1 lacp=active\n</code></pre><p>默认情况下bond_mode是active-backup模式，一开始active的是左面这条路，也即first_br和first_if这条路。</p><p>这个时候如果我们从192.168.100.100 来ping 192.168.100.102，以及从192.168.100.101 来ping 192.168.100.103的时候，我从tcpdump可以看到所有的包都是从first_if这条路通过。</p><p>接下来，如果我们把first_if这个网卡设成down的模式，则包的走向就会改变，你会发现second_if这条路开始有流量了，对于192.168.100.100和192.168.100.101从应用层来讲，感觉似乎没有收到影响。</p><p>如果我们通过以下命令，把bond_mode改为balance-slb。然后我们同时在192.168.100.100 来ping 192.168.100.102，同时也在192.168.100.101 来ping 192.168.100.103，我们通过tcpdump会发现，包已经被分流了。</p><pre><code>ovs-vsctl set Port bond0 bond_mode=balance-slb\novs-vsctl set Port bond1 bond_mode=balance-slb\n</code></pre><p>通过这个例子，我们可以看到，通过OpenvSwitch，你不用买两台支持bond的交换机，也能看到bond的效果。</p><p>那OpenvSwitch是怎么做到这些的呢？我们来看OpenvSwitch的架构图。</p><p><img src=\"\" alt=\"\"></p><p>OpenvSwitch包含很多的模块，在用户态有两个重要的进程，也有两个重要的命令行工具。</p><ul>\n<li>\n<p>第一个进程是OVSDB进程。ovs-vsctl命令行会和这个进程通信，去创建虚拟交换机，创建端口，将端口添加到虚拟交换机上，OVSDB会将这些拓扑信息保存在一个本地的文件中。</p>\n</li>\n<li>\n<p>第二个进程是vswitchd进程。ovs-ofctl命令行会和这个进程通信，去下发流表规则，规则里面会规定如何对网络包进行处理，vswitchd会将流表放在用户态Flow Table中。</p>\n</li>\n</ul><p>在内核态，OpenvSwitch有内核模块OpenvSwitch.ko，对应图中的Datapath部分。他会在网卡上注册一个函数，每当有网络包到达网卡的时候，这个函数就会被调用。</p><p>在内核的这个函数里面，会拿到网络包，将各个层次的重要信息拿出来，例如：</p><ul>\n<li>\n<p>在物理层，会拿到in_port，即包是从哪个网口进来的。；</p>\n</li>\n<li>\n<p>在MAC层，会拿到源和目的MAC地址；</p>\n</li>\n<li>\n<p>在IP层，会拿到源和目的IP地址；</p>\n</li>\n<li>\n<p>在传输层，会拿到源和目的端口号。</p>\n</li>\n</ul><p>在内核中，还有一个内核态Flow Table。接下来内核态模块在这个内核态的流表中匹配规则，如果匹配上了，就执行相应的操作，比如修改包，或者转发，或者放弃。如果内核没有匹配上，这个时候就需要进入用户态，用户态和内核态之间通过Linux的一个机制叫Netlink，来进行相互通信。</p><p>内核通过upcall，告知用户态进程vswitchd，在用户态的Flow Table里面去匹配规则，这里面的规则是全量的流表规则，而内核态的Flow Table只是为了做快速处理，保留了部分规则，内核里面的规则过一段时间就会过期。</p><p>当在用户态匹配到了流表规则之后，就在用户态执行操作，同时将这个匹配成功的流表通过reinject下发到内核，从而接下来的包都能在内核找到这个规则，来进行转发。</p><p>这里调用openflow协议的，是本地的命令行工具。当然你也可以是远程的SDN控制器来进行控制，一个重要的SDN控制器是OpenDaylight。</p><p>下面这个图就是OpenDaylight中看到的拓扑图。是不是有种物业管理员在监控室里的感觉？</p><p><img src=\"https://static001.geekbang.org/resource/image/27/a8/274442ba251fdc63c88bc5dbfc6183a8.jpg?wh=1090*374\" alt=\"\"></p><p>我们可以通过在OpenDaylight里，将两个交换机之间配置通，也可以配置不通，还可以配置一个虚拟IP地址为VIP，在不同的机器之间实现负载均衡等等，所有的策略都可以灵活配置。</p><h2>如何在云计算中使用OpenvSwitch？</h2><p>OpenvSwitch这么牛，如何用在云计算中呢？</p><p><img src=\"\" alt=\"\"></p><p>我们还是讨论VLAN的场景。</p><p>在没有OpenvSwitch的时候，如果一个新的用户要使用一个新的VLAN，就需要创建一个属于新的VLAN的虚拟网卡，并且为这个租户创建一个单独的虚拟网桥，这样用户越来越多的时候，虚拟网卡和虚拟网桥会越来越多，管理就越来越复杂。</p><p>另一个问题是虚拟机的VLAN和物理环境的VLAN是透传的，也即从一开始规划的时候，这两个就需要匹配起来，将物理环境和虚拟环境强绑定，这样本来就不灵活。</p><p>而引入了OpenvSwitch，状态就得到了改观。</p><p>首先，由于OpenvSwitch本身就是支持VLAN的，这样所有的虚拟机都可以放在一个网桥br0上，通过不同的用户配置不同的tag，就能够实现隔离。例如上面的图左面的部分，用户A的虚拟机都在br0上，用户B的虚拟机都在br1上，有了OpenvSwitch，就可以都放在br0上，只是设置了不同的tag就可以了。</p><p>另外，还可以创建一个虚拟交换机br1，将物理网络和虚拟网络进行隔离。物理网络有物理网络的VLAN规划，虚拟机在一台物理机上，所有的VLAN都可以从1开始。由于一台物理机上的虚拟机肯定不会超过4096个，所以VLAN在一台物理机上如果从1开始，肯定够用了。例如在图中右面部分的上面的那台物理机里面，用户A被分配的tag是1，用户B被分配的tag是2，而在下面的物理机里面，用户A被分配的tag是7，用户B被分配的tag是6。</p><p>如果物理机之间的通信和隔离还是通过VLAN的话，需要将虚拟机的VLAN和物理环境的VLAN对应起来，但为了灵活性，不一定一致，这样可以实现分别管理物理机的网络和虚拟机的网络。好在OpenvSwitch可以对包的内容进行修改。例如通过匹配dl_vlan，然后执行mod_vlan_vid来改变进进出出物理机的网络包。</p><p>尽管租户多了，物理环境的VLAN还是不够用，但是有了OpenvSwitch的映射，将物理和虚拟解耦，从而可以让物理环境使用其他技术，而不影响虚拟机环境，这个我们后面再讲。</p><h2>小结</h2><p>好了，这一节就到这里了，我们来总结一下：</p><ul>\n<li>\n<p>用SDN控制整个云里面的网络，就像小区保安从总控室管理整个物业是一样的，将控制面和数据面进行了分离；</p>\n</li>\n<li>\n<p>一种开源的虚拟交换机的实现OpenvSwitch，它能对经过自己的包做任意修改，从而使得云对网络的控制十分灵活；</p>\n</li>\n<li>\n<p>将OpenvSwitch引入了云之后，可以使得配置简单而灵活，并且可以解耦物理网络和虚拟网络。</p>\n</li>\n</ul><p>最后，给你留两个思考题：</p><ol>\n<li>\n<p>在这一节中，提到了通过VIP可以通过流表在不同的机器之间实现复杂均衡，你知道怎样才能做到吗？</p>\n</li>\n<li>\n<p>虽然OpenvSwitch可以解耦物理网络和虚拟网络，但是在物理网络里面使用VLAN，数目还是不够，你知道该怎么办吗？</p>\n</li>\n</ol><p>我们的专栏更新到第25讲，不知你掌握得如何？每节课后我留的思考题，你都有没有认真思考，并在留言区写下答案呢？我会从<strong>已发布的文章中选出一批认真留言的同学</strong>，赠送<span class=\"orange\">学习奖励礼券</span>和我整理的<span class=\"orange\">独家网络协议知识图谱</span>。</p><p>欢迎你留言和我讨论。趣谈网络协议，我们下期见！</p>","neighbors":{"left":{"article_title":"第24讲 | 云中网络：自己拿地成本高，购买公寓更灵活","id":10742},"right":{"article_title":"第26讲 | 云中的网络安全：虽然不是土豪，也需要基本安全和保障","id":10978}},"comments":[{"had_liked":false,"id":17004,"user_name":"小小鸟","can_delete":false,"product_type":"c1","uid":1102550,"ip_address":"","ucode":"11C15D267DE457","user_header":"https://static001.geekbang.org/account/avatar/00/10/d2/d6/d393593d.jpg","comment_is_top":false,"comment_ctime":1532384480,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"388079441120","product_id":100007101,"comment_content":"跟不上了 平时工作也接触不到 尴尬😓","like_count":91},{"had_liked":false,"id":54259,"user_name":"royno7","can_delete":false,"product_type":"c1","uid":1222336,"ip_address":"","ucode":"9163025D0BF74A","user_header":"https://static001.geekbang.org/account/avatar/00/12/a6/c0/df6b049a.jpg","comment_is_top":false,"comment_ctime":1545817619,"is_pvip":false,"discussion_count":1,"race_medal":0,"score":"130394836499","product_id":100007101,"comment_content":"我就是做sdn&#47;nfv的，建议这两块放在一起讲。sdn最大的意义在于让网络功能可编程，这点你完全没有提到。","like_count":30,"discussions":[{"author":{"id":1440772,"avatar":"https://static001.geekbang.org/account/avatar/00/15/fc/04/d83a555e.jpg","nickname":"Kevin⚡️Zhou","note":"","ucode":"C0FC2673705212","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":297229,"discussion_content":"我的宏观理解是在物理的设备层上面重新定义了一个软件层, 这样原来借助二层物理设备的处理和三层设备的嵌入式系统处理的网络包全部集中在这个软件层上来处理, 相当于网络层里面定义了一个分布式系统. 请问这样理解对吗","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1596816265,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":223224,"user_name":"sailor","can_delete":false,"product_type":"c1","uid":1592031,"ip_address":"","ucode":"3B301A4BE9FB11","user_header":"https://static001.geekbang.org/account/avatar/00/18/4a/df/a3ee01da.jpg","comment_is_top":false,"comment_ctime":1591023479,"is_pvip":false,"replies":[{"id":"83033","content":"是的","user_name":"作者回复","user_name_real":"刘超@网易云","uid":"1001590","ctime":1591755630,"ip_address":"","comment_id":223224,"utype":1}],"discussion_count":2,"race_medal":0,"score":"83195402103","product_id":100007101,"comment_content":"1. 负载均衡服务器和业务服务器绑定一个虚拟IP(VIP)，通过MAC地址实现多个机器的负载均衡。<br>2. Vlan 数目不够。VXLAN解决Vlan最多只能分配4096个的终端的问题。VXLAN通过在第４层UDP帧中封装２层Vlan，完成Vllan扩容 4096x4096。","like_count":19,"discussions":[{"author":{"id":1001590,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/48/76/0c7d4d23.jpg","nickname":"刘超","note":"","ucode":"196BF3F499E8FE","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":497063,"discussion_content":"是的","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1591755630,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":2630632,"avatar":"https://static001.geekbang.org/account/avatar/00/28/23/e8/9f445339.jpg","nickname":"章潘","note":"","ucode":"1A24E1B3084450","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":574405,"discussion_content":"好奇问题1的网络拓扑具体是什么样的？","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1654046977,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":15781,"user_name":"Hurt","can_delete":false,"product_type":"c1","uid":1050946,"ip_address":"","ucode":"DCE7428CCF08EF","user_header":"https://static001.geekbang.org/account/avatar/00/10/09/42/1f762b72.jpg","comment_is_top":false,"comment_ctime":1531477975,"is_pvip":false,"replies":[{"id":"5450","content":"还要复习一下哈","user_name":"作者回复","user_name_real":"刘超@网易云","uid":"1001590","ctime":1531486589,"ip_address":"","comment_id":15781,"utype":1}],"discussion_count":1,"race_medal":0,"score":"48776118231","product_id":100007101,"comment_content":"哈哈哈 跟不上了 和前面的联系不上了 需要好好多听几遍了","like_count":11,"discussions":[{"author":{"id":1001590,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/48/76/0c7d4d23.jpg","nickname":"刘超","note":"","ucode":"196BF3F499E8FE","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":420550,"discussion_content":"还要复习一下哈","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1531486589,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":38647,"user_name":"Jobs","can_delete":false,"product_type":"c1","uid":1014824,"ip_address":"","ucode":"7745742129EDFC","user_header":"https://static001.geekbang.org/account/avatar/00/0f/7c/28/cb6d8768.jpg","comment_is_top":false,"comment_ctime":1542093921,"is_pvip":false,"discussion_count":3,"race_medal":0,"score":"44491766881","product_id":100007101,"comment_content":"从 192.168.100.100 来 ping 192.168.100.105,为何ping不通，third_if却能收到包？<br>另外这里为啥要禁止mac地址学习？<br><br>","like_count":10,"discussions":[{"author":{"id":1634075,"avatar":"","nickname":"吴先生","note":"","ucode":"DDFC3AE9D42798","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":93002,"discussion_content":"交换机具有学习mac地址功能，禁止后，就能都广播，达到实验效果","likes_number":5,"is_delete":false,"is_hidden":false,"ctime":1576898893,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1637933,"avatar":"https://static001.geekbang.org/account/avatar/00/18/fe/2d/e23fc6ee.jpg","nickname":"深水蓝","note":"","ucode":"3E3B195DE54DE1","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":549827,"discussion_content":"因为192.168.100.100 Ping 192.168.100.105 的时候，数据包被vnet0打上了tag=101的标签，由于third_br配置了trucks=101,102，所以192.168.100.100的包会从third_br转发出去，且转发的时候不会去掉tag，所以数据包发给third_if的时候是带着tag=101的。而192.168.100.105并没有配置VLAN=101，所以192.168.100.105并不会处理这个数据包。\n\n与192.168.100.102 Ping 192.168.100.103不同，192.168.100.102发出的Ping包会被vnet2打上tag=103的标签，同时也由first_br转发出来，由于first_br配置了tag=103，所以first_br转发这个数据包的时候会把tag去掉，因此192.168.100.103收到的Ping包是没有VLAN标记的，同时192.168.100.103也没有配置VLAN，所以192.168.100.103就可以正确响应这个Ping包了。\n\n不知道这个解释完不完整，请老师指点。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1644247891,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1484184,"avatar":"https://static001.geekbang.org/account/avatar/00/16/a5/98/a65ff31a.jpg","nickname":"djfhchdh","note":"","ucode":"E71D75328CE398","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":300038,"discussion_content":"因为不属于同一个vlan\n","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1597916674,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":17932,"user_name":"小谢同学","can_delete":false,"product_type":"c1","uid":1032544,"ip_address":"","ucode":"E809E6BC470631","user_header":"https://static001.geekbang.org/account/avatar/00/0f/c1/60/fc3689d0.jpg","comment_is_top":false,"comment_ctime":1533035619,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"27302839395","product_id":100007101,"comment_content":"请问刘老师，大规模环境中的sdn控制器是一个独立实例或独立集群来实现么？主流控制器有哪些？另外流表要在每一台宿主机保存么？那大小限制的问题如何解决？能否独立集中存放流表","like_count":6},{"had_liked":false,"id":50414,"user_name":"xy🥝","can_delete":false,"product_type":"c1","uid":1029430,"ip_address":"","ucode":"DA1EC0789071F0","user_header":"https://static001.geekbang.org/account/avatar/00/0f/b5/36/d444d19e.jpg","comment_is_top":false,"comment_ctime":1544969648,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"18724838832","product_id":100007101,"comment_content":"这里有个疑问，物理机上的VLAN，4096个是够用的，但是在云环境里面，租户的机器遍布各个物理机，也就是并不是单台物理机上的虚拟机通信，最终还是要出去的，这里就会冲突了，单台物理机上的vlan ID仅有本地意义。","like_count":4},{"had_liked":false,"id":47702,"user_name":"我是谁","can_delete":false,"product_type":"c1","uid":1303263,"ip_address":"","ucode":"CD0A2F667C9544","user_header":"https://static001.geekbang.org/account/avatar/00/13/e2/df/660a13fe.jpg","comment_is_top":false,"comment_ctime":1544184547,"is_pvip":false,"discussion_count":1,"race_medal":0,"score":"18724053731","product_id":100007101,"comment_content":"first_if 这个是什么，怎么产生的？","like_count":5,"discussions":[{"author":{"id":2049638,"avatar":"https://static001.geekbang.org/account/avatar/00/1f/46/66/6eaf229f.jpg","nickname":"james.S","note":"","ucode":"3437624A9FA805","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":291047,"discussion_content":"first interface ","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1594690405,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":88960,"user_name":"秦俊山","can_delete":false,"product_type":"c1","uid":1101079,"ip_address":"","ucode":"42B5B221E0B8CF","user_header":"https://static001.geekbang.org/account/avatar/00/10/cd/17/59d4d531.jpg","comment_is_top":false,"comment_ctime":1556033438,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"14440935326","product_id":100007101,"comment_content":"真的跟不上了，留言少了好多","like_count":3},{"had_liked":false,"id":15731,"user_name":"江湖","can_delete":false,"product_type":"c1","uid":1075005,"ip_address":"","ucode":"7865F4E9932061","user_header":"https://static001.geekbang.org/account/avatar/00/10/67/3d/4e7aec2f.jpg","comment_is_top":false,"comment_ctime":1531441714,"is_pvip":false,"discussion_count":1,"race_medal":0,"score":"14416343602","product_id":100007101,"comment_content":"老师讲的通俗易懂，从第一讲到今天，一直坚持着，同时配合nodejs以及eggjs一起学习，受益匪浅。","like_count":3,"discussions":[{"author":{"id":2806043,"avatar":"https://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTLBFkSq1oiaEMRjtyyv4ZpCI0OuaSsqs04ODm0OkZF6QhsAh3SvqhxibS2n7PLAVZE3QRSn5Hic0DyXg/132","nickname":"ddh","note":"","ucode":"8E852375365F16","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":545150,"discussion_content":"走错地方了吧","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1641866039,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":179603,"user_name":"Karson","can_delete":false,"product_type":"c1","uid":1008100,"ip_address":"","ucode":"E0286BF6CA7281","user_header":"https://static001.geekbang.org/account/avatar/00/0f/61/e4/db3f783b.jpg","comment_is_top":false,"comment_ctime":1582037787,"is_pvip":true,"discussion_count":0,"race_medal":0,"score":"10171972379","product_id":100007101,"comment_content":"由于平时工作没有深入接触网络，最近跟不上了。这一节反复看了一天，包括自己去查相关资料。下午的时候还很迷茫。晚上突然一下都想通了。老师讲的真棒，内容真香。同时反思一下，对于网络基础不好的朋友理解起来真的困难，能有手把手的进阶教程或提供相关的参考资料也可以。这样会节省很多时间，也不要后面的同学向我这样查了一天。。。","like_count":2},{"had_liked":false,"id":155370,"user_name":"lqmoon436","can_delete":false,"product_type":"c1","uid":1640290,"ip_address":"","ucode":"6CCDFB8E0EE480","user_header":"","comment_is_top":false,"comment_ctime":1574682816,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"10164617408","product_id":100007101,"comment_content":"VIP首先要绑定后端的主机，然后主机内部要配置VIP。通过二层去学习VIP的mac，从而知道VIP绑定到了哪一个主机上。 当VIP绑定的主机故障的时候，类似于keepalive的机制检测到主机故障了，那么需要在另一台主机内部将VIP配置上。通过mac学习，学到新的VIP的地址，然后流量引过去。","like_count":2},{"had_liked":false,"id":20275,"user_name":"在路上","can_delete":false,"product_type":"c1","uid":1143372,"ip_address":"","ucode":"335960F683C23C","user_header":"https://static001.geekbang.org/account/avatar/00/11/72/4c/4d636a23.jpg","comment_is_top":false,"comment_ctime":1534344797,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"10124279389","product_id":100007101,"comment_content":"老师讲解每一讲后，能不能推荐一些相关的书籍，现在是完全跟不上节奏啊","like_count":2},{"had_liked":false,"id":15775,"user_name":"勤劳的小胖子-libo","can_delete":false,"product_type":"c1","uid":1158344,"ip_address":"","ucode":"5BB20CD5A56568","user_header":"https://static001.geekbang.org/account/avatar/00/11/ac/c8/4b1c0d40.jpg","comment_is_top":false,"comment_ctime":1531468373,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"10121402965","product_id":100007101,"comment_content":"等二个是通过overlay技术，比如vxlan, 但需要使用tun 而不是tap ","like_count":2},{"had_liked":false,"id":15743,"user_name":"Jobs","can_delete":false,"product_type":"c1","uid":1014824,"ip_address":"","ucode":"7745742129EDFC","user_header":"https://static001.geekbang.org/account/avatar/00/0f/7c/28/cb6d8768.jpg","comment_is_top":false,"comment_ctime":1531444551,"is_pvip":false,"replies":[{"id":"5449","content":"我的只是个开端","user_name":"作者回复","user_name_real":"刘超@网易云","uid":"1001590","ctime":1531473479,"ip_address":"","comment_id":15743,"utype":1}],"discussion_count":1,"race_medal":0,"score":"10121379143","product_id":100007101,"comment_content":"刘老师您好！我现在工作中正在研究Linux 上的VM，即qemu-kvm，职业方向是不是也可以不断往云计算去进阶呢？这两年顺着你这几天及将来的文章不断深入细节去研究就可以了吗","like_count":2,"discussions":[{"author":{"id":1001590,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/48/76/0c7d4d23.jpg","nickname":"刘超","note":"","ucode":"196BF3F499E8FE","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":420536,"discussion_content":"我的只是个开端","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1531473479,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":195420,"user_name":"熊熊","can_delete":false,"product_type":"c1","uid":1104611,"ip_address":"","ucode":"D4E5B5C4FCF059","user_header":"https://static001.geekbang.org/account/avatar/00/10/da/e3/51295241.jpg","comment_is_top":false,"comment_ctime":1585187098,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"5880154394","product_id":100007101,"comment_content":"前面的二刷，关键词做笔记，后面就能跟上了","like_count":1},{"had_liked":false,"id":151411,"user_name":"Joe","can_delete":false,"product_type":"c1","uid":1057086,"ip_address":"","ucode":"7DB615339098E9","user_header":"https://static001.geekbang.org/account/avatar/00/10/21/3e/46d1390a.jpg","comment_is_top":false,"comment_ctime":1573715212,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"5868682508","product_id":100007101,"comment_content":"VIP 流量的权重 是通过 主机和交换机之间的， OSPF协议控制 实现的？","like_count":1},{"had_liked":false,"id":147122,"user_name":"Lim","can_delete":false,"product_type":"c1","uid":1547046,"ip_address":"","ucode":"8CFA92A3966F6D","user_header":"https://static001.geekbang.org/account/avatar/00/17/9b/26/961c6be2.jpg","comment_is_top":false,"comment_ctime":1572799468,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"5867766764","product_id":100007101,"comment_content":"作为一个java开发，到这里已经完全不知道在说什么了。。平时连物理服务器，网线都摸不到。都买的云服务器😂😂😂","like_count":2},{"had_liked":false,"id":40941,"user_name":"楊_宵夜","can_delete":false,"product_type":"c1","uid":1019302,"ip_address":"","ucode":"7BA0CADC5F23BB","user_header":"https://static001.geekbang.org/account/avatar/00/0f/8d/a6/22c37c91.jpg","comment_is_top":false,"comment_ctime":1542699491,"is_pvip":false,"replies":[{"id":"14733","content":"在配置文件里面配置了，vnet创建完毕就已经在ovs上了","user_name":"作者回复","user_name_real":"刘超@网易云","uid":"1001590","ctime":1542705209,"ip_address":"","comment_id":40941,"utype":1}],"discussion_count":1,"race_medal":0,"score":"5837666787","product_id":100007101,"comment_content":"超哥, 两个问题:<br>在 [实验一 用 OpenvSwitch 实现 VLAN 的功能] 中;<br><br>--  问题一&amp;引用一 <br>2. 从192.168.100.100来ping192.168.100.105, 则second_if和third_if可以收到包; 当然ping不通,<br>因为third_if不属于某个VLAN...<br>--<br>我读上下文, 没有发现third_if是属于哪个VLAN呢? <br>并且也没看出来 100.103 和 100.104 的VLAN分别是什么;<br><br>--问题二&amp;引用一 <br>ovs-vsctl add-port ubuntu_br first_br<br>ovs-vsctl set Port vnet0 tag=101<br>ovs-vsctl set Port first_br tag=103<br>--<br>可以看到端口first_br是需要先add的;<br>为什么vnet0不需要先add呢?","like_count":2,"discussions":[{"author":{"id":1001590,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/48/76/0c7d4d23.jpg","nickname":"刘超","note":"","ucode":"196BF3F499E8FE","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":429655,"discussion_content":"在配置文件里面配置了，vnet创建完毕就已经在ovs上了","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1542705209,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":15905,"user_name":"Chars","can_delete":false,"product_type":"c1","uid":1105985,"ip_address":"","ucode":"9F3691E964EA6A","user_header":"https://static001.geekbang.org/account/avatar/00/10/e0/41/eae81006.jpg","comment_is_top":false,"comment_ctime":1531634403,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"5826601699","product_id":100007101,"comment_content":"网络这一块是短板，越到后面越迷糊了，自己要加油了","like_count":1},{"had_liked":false,"id":353405,"user_name":"刘崇","can_delete":false,"product_type":"c1","uid":1834278,"ip_address":"","ucode":"ECF406F188A405","user_header":"","comment_is_top":false,"comment_ctime":1659424577,"is_pvip":false,"replies":[{"id":"128574","content":"你一定是老师的头号粉丝吧，这么多手动点赞，谢谢你！","user_name":"编辑回复","user_name_real":"编辑","uid":"1356014","ctime":1659603511,"ip_address":"","comment_id":353405,"utype":2}],"discussion_count":1,"race_medal":0,"score":"1659424577","product_id":100007101,"comment_content":"👍🏻","like_count":0,"discussions":[{"author":{"id":1356014,"avatar":"https://static001.geekbang.org/account/avatar/00/14/b0/ee/d0871efd.jpg","nickname":"冬青","note":"","ucode":"14576781B499FB","race_medal":0,"user_type":8,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":582711,"discussion_content":"你一定是老师的头号粉丝吧，这么多手动点赞，谢谢你！","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1659603511,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":8}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":349585,"user_name":"while (1)等;","can_delete":false,"product_type":"c1","uid":1061991,"ip_address":"","ucode":"BAEC7258D65B69","user_header":"https://static001.geekbang.org/account/avatar/00/10/34/67/06a7f9be.jpg","comment_is_top":false,"comment_ctime":1656121585,"is_pvip":true,"discussion_count":0,"race_medal":0,"score":"1656121585","product_id":100007101,"comment_content":"哪个岗位会用到这方面的知识？运维？","like_count":0},{"had_liked":false,"id":343819,"user_name":"戴宇","can_delete":false,"product_type":"c1","uid":1185158,"ip_address":"","ucode":"66A56B2D742903","user_header":"https://static001.geekbang.org/account/avatar/00/12/15/86/cd97bf7e.jpg","comment_is_top":false,"comment_ctime":1651069300,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1651069300","product_id":100007101,"comment_content":"192.168.100.102 来 ping 192.168.100.103， 从103出去的包没有vlan。 那么这个ICMP 的包是要返回给102的。如果没有vlan 怎么返回， 102应该收不到返回的包啊","like_count":0},{"had_liked":false,"id":330766,"user_name":"孙新","can_delete":false,"product_type":"c1","uid":2875594,"ip_address":"","ucode":"A80038A479B943","user_header":"https://static001.geekbang.org/account/avatar/00/2b/e0/ca/adfaa551.jpg","comment_is_top":false,"comment_ctime":1642149395,"is_pvip":true,"discussion_count":0,"race_medal":0,"score":"1642149395","product_id":100007101,"comment_content":"我觉得这一节不需要把OpenvSwitch具体的使用细节理解透彻，只是理解了他的工作原理即可。体会到他的强大就行了。","like_count":0},{"had_liked":false,"id":313669,"user_name":"二进制的人生","can_delete":false,"product_type":"c1","uid":2612345,"ip_address":"","ucode":"7846539A5260E5","user_header":"https://static001.geekbang.org/account/avatar/00/27/dc/79/87d7b4e3.jpg","comment_is_top":false,"comment_ctime":1632593299,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1632593299","product_id":100007101,"comment_content":"请问在座各位大神，在云计算中使用 OpenvSwitch 时，为什么不可以使用br0直接连接物理交换机","like_count":0},{"had_liked":false,"id":310888,"user_name":"大杏仁儿","can_delete":false,"product_type":"c1","uid":1120756,"ip_address":"","ucode":"EBF09A3AAF93DC","user_header":"https://static001.geekbang.org/account/avatar/00/11/19/f4/34fdd4be.jpg","comment_is_top":false,"comment_ctime":1630969936,"is_pvip":true,"discussion_count":0,"race_medal":0,"score":"1630969936","product_id":100007101,"comment_content":"老师整体讲了一下通用的云计算网络模式，openstack的vlan模式其实就是这种。不过这些复杂的配置都是通过neutron来帮助配置的。通过neutron可以创建一个网络，这里的网络对应的就是虚拟机的一个vlan，通过这种方式可以实现网络的隔离。给vlan里面的虚拟机分配网段也就创建了不同的子网。neutron同样可以实现对网卡的管理。","like_count":0},{"had_liked":false,"id":264363,"user_name":"Mew151","can_delete":false,"product_type":"c1","uid":1002201,"ip_address":"","ucode":"D4793F5874F345","user_header":"https://static001.geekbang.org/account/avatar/00/0f/4a/d9/75dd7cf9.jpg","comment_is_top":false,"comment_ctime":1606447053,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1606447053","product_id":100007101,"comment_content":"这一节的内容多到爆炸","like_count":0},{"had_liked":false,"id":242776,"user_name":"倪大又","can_delete":false,"product_type":"c1","uid":1363807,"ip_address":"","ucode":"A4A3889F960BC6","user_header":"http://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTLM1WqQTliaQvXdt2whclPrbkHzZMxz5XjFjYnwV9h2MEjMDQKH6oJTtYKCoNZxficHxcGicJfMBicic9A/132","comment_is_top":false,"comment_ctime":1597838189,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1597838189","product_id":100007101,"comment_content":"老师，first_br  first_if  second_br  second_if ...这些是什么？因为对网络这一块是小白，所以这一块有些看不懂","like_count":1},{"had_liked":false,"id":242580,"user_name":"星期八","can_delete":false,"product_type":"c1","uid":1185504,"ip_address":"","ucode":"34A37F73A48E7F","user_header":"https://static001.geekbang.org/account/avatar/00/12/16/e0/7abad3cc.jpg","comment_is_top":false,"comment_ctime":1597767132,"is_pvip":false,"discussion_count":1,"race_medal":0,"score":"1597767132","product_id":100007101,"comment_content":"从 access port 发出的包不带 VLAN ID，那为什么可以进trunk=101呢","like_count":0,"discussions":[{"author":{"id":1014665,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/7b/89/34f2cbcc.jpg","nickname":"杨宇","note":"","ucode":"EB74DF6E269F03","race_medal":0,"user_type":1,"is_pvip":true},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":535301,"discussion_content":"“根据 access port 的规则，从 first_br 出来的包头是没有带 VLAN ID 的。”——看图，从first_br出来，到first_if，与br0上的其它（*_br）无关。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1638407626,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":206497,"user_name":"Stxguy","can_delete":false,"product_type":"c1","uid":1879340,"ip_address":"","ucode":"263C4FA3DBC4D4","user_header":"http://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTJOjBYuaLu0YiaItQF2f8M2K5BDdPUibwO3fAfpsqHePCL5JH5lSE4P7DLXxgiaLUaGXmVLRckbdjpEw/132","comment_is_top":false,"comment_ctime":1586870322,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1586870322","product_id":100007101,"comment_content":"first_br 难道不用先创建吗? ,我在ubuntu 16.04 , <br>  Bridge ubuntu_br<br>        Port third_br<br>            trunks: [101, 102]<br>            Interface third_br<br>                error: &quot;could not open network device third_br (No such device)&quot;<br>        Port first_br<br>            tag: 103<br>            Interface first_br<br>                error: &quot;could not open network device first_br (No such device)&quot;<br>        Port second_br<br>            Interface second_br<br>                error: &quot;could not open network device second_br (No such device)&quot;<br>        Port ubuntu_br<br>            Interface ubuntu_br<br>                type: internal<br>","like_count":1},{"had_liked":false,"id":194839,"user_name":"King-ZJ","can_delete":false,"product_type":"c1","uid":1915385,"ip_address":"","ucode":"7448A4BBB5A118","user_header":"https://static001.geekbang.org/account/avatar/00/1d/39/f9/b946719a.jpg","comment_is_top":false,"comment_ctime":1585109033,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1585109033","product_id":100007101,"comment_content":"虚拟交换机的演进，也是让业务运行越来越便捷。向共享、互通、隔离功能越来越优化的方向发展，也慢慢了解这个架构，对后面的学习有裨益。","like_count":0},{"had_liked":false,"id":188733,"user_name":"皮皮侠","can_delete":false,"product_type":"c1","uid":1258402,"ip_address":"","ucode":"04205990C1DE1F","user_header":"https://static001.geekbang.org/account/avatar/00/13/33/a2/6c0ffc15.jpg","comment_is_top":false,"comment_ctime":1584409452,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1584409452","product_id":100007101,"comment_content":"软件定义网络除了云计算，还会应用在哪些场景？","like_count":0},{"had_liked":false,"id":188007,"user_name":"小高","can_delete":false,"product_type":"c1","uid":1283052,"ip_address":"","ucode":"FCD422249F7355","user_header":"https://static001.geekbang.org/account/avatar/00/13/93/ec/985675c8.jpg","comment_is_top":false,"comment_ctime":1584292209,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1584292209","product_id":100007101,"comment_content":"高深的SDN，多听几遍总会克服的","like_count":0},{"had_liked":false,"id":151413,"user_name":"Joe","can_delete":false,"product_type":"c1","uid":1057086,"ip_address":"","ucode":"7DB615339098E9","user_header":"https://static001.geekbang.org/account/avatar/00/10/21/3e/46d1390a.jpg","comment_is_top":false,"comment_ctime":1573715240,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1573715240","product_id":100007101,"comment_content":"Vlan 不够可以用隧道技术，在Vlan上在继续切分。","like_count":0},{"had_liked":false,"id":150476,"user_name":"红云云悦河溪","can_delete":false,"product_type":"c1","uid":1254887,"ip_address":"","ucode":"329302547DF8F4","user_header":"https://static001.geekbang.org/account/avatar/00/13/25/e7/78665286.jpg","comment_is_top":false,"comment_ctime":1573542348,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1573542348","product_id":100007101,"comment_content":"网桥能连这么多机器吗","like_count":0},{"had_liked":false,"id":135854,"user_name":"Roger","can_delete":false,"product_type":"c1","uid":1319960,"ip_address":"","ucode":"78EA978779F92E","user_header":"https://static001.geekbang.org/account/avatar/00/14/24/18/8edc6b97.jpg","comment_is_top":false,"comment_ctime":1569288886,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1569288886","product_id":100007101,"comment_content":"24讲之前的东西在平时工作中还有些需要考虑，在后面是越来越难懂了，很多设计思路都需要强背和理解，但是在实际开发中又没有接触，是否可以放下现在的进度，等以后有接触这些效果更好？","like_count":0},{"had_liked":false,"id":121246,"user_name":"N_H","can_delete":false,"product_type":"c1","uid":1541386,"ip_address":"","ucode":"109B67557AB3CE","user_header":"https://static001.geekbang.org/account/avatar/00/17/85/0a/e564e572.jpg","comment_is_top":false,"comment_ctime":1565084421,"is_pvip":false,"replies":[{"id":"46351","content":"多看几遍哈","user_name":"作者回复","user_name_real":"刘超@网易云","uid":"1001590","ctime":1566296718,"ip_address":"","comment_id":121246,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1565084421","product_id":100007101,"comment_content":"后面太专业了，跟不上","like_count":0,"discussions":[{"author":{"id":1001590,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/48/76/0c7d4d23.jpg","nickname":"刘超","note":"","ucode":"196BF3F499E8FE","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":461701,"discussion_content":"多看几遍哈","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1566296718,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":106477,"user_name":"cheetah","can_delete":false,"product_type":"c1","uid":1482596,"ip_address":"","ucode":"76D54EF2053B5E","user_header":"https://static001.geekbang.org/account/avatar/00/16/9f/64/a0a0904d.jpg","comment_is_top":false,"comment_ctime":1561333162,"is_pvip":false,"replies":[{"id":"48885","content":"不是的，还是需要的","user_name":"作者回复","user_name_real":"刘超@网易云","uid":"1001590","ctime":1567504498,"ip_address":"","comment_id":106477,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1561333162","product_id":100007101,"comment_content":"看不懂了，平常开发确实不需要关心这个","like_count":0,"discussions":[{"author":{"id":1001590,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/48/76/0c7d4d23.jpg","nickname":"刘超","note":"","ucode":"196BF3F499E8FE","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":455105,"discussion_content":"不是的，还是需要的","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1567504498,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":94332,"user_name":"快乐就好","can_delete":false,"product_type":"c1","uid":1205376,"ip_address":"","ucode":"5F4806B050FA46","user_header":"https://static001.geekbang.org/account/avatar/00/12/64/80/61107e24.jpg","comment_is_top":false,"comment_ctime":1557792029,"is_pvip":false,"replies":[{"id":"49357","content":"一般是分流吧","user_name":"作者回复","user_name_real":"刘超@网易云","uid":"1001590","ctime":1567650909,"ip_address":"","comment_id":94332,"utype":1}],"discussion_count":2,"race_medal":0,"score":"1557792029","product_id":100007101,"comment_content":"老师 请问一下 在数据中心中，我们网络设备上加了策略路由，物理服务器上也会加策略路由，这里是基于什么考虑呢(需要在物理服务器上加策略路由(什么网络过来就从什么网络出去))？","like_count":0,"discussions":[{"author":{"id":1001590,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/48/76/0c7d4d23.jpg","nickname":"刘超","note":"","ucode":"196BF3F499E8FE","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":450020,"discussion_content":"一般是分流吧","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1567650909,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":2049638,"avatar":"https://static001.geekbang.org/account/avatar/00/1f/46/66/6eaf229f.jpg","nickname":"james.S","note":"","ucode":"3437624A9FA805","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":291049,"discussion_content":"多出口做选路吧？以前单位多个出口就是用pbr做策略选路","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1594690992,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":80438,"user_name":"腊八","can_delete":false,"product_type":"c1","uid":1131715,"ip_address":"","ucode":"BC119D26EEB53A","user_header":"https://static001.geekbang.org/account/avatar/00/11/44/c3/67208f8a.jpg","comment_is_top":false,"comment_ctime":1553661069,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1553661069","product_id":100007101,"comment_content":"需要反复看和多积累，欠缺的好多","like_count":0},{"had_liked":false,"id":75749,"user_name":"江南皮革厂研发中心保安队长","can_delete":false,"product_type":"c1","uid":1099584,"ip_address":"","ucode":"231419643A5CC5","user_header":"https://static001.geekbang.org/account/avatar/00/10/c7/40/66a203cd.jpg","comment_is_top":false,"comment_ctime":1552463032,"is_pvip":false,"replies":[{"id":"50250","content":"不完全一样","user_name":"作者回复","user_name_real":"刘超@网易云","uid":"1001590","ctime":1567827967,"ip_address":"","comment_id":75749,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1552463032","product_id":100007101,"comment_content":"VIP的使用只在Haproxy里用过，这里也是类似的吗？","like_count":0,"discussions":[{"author":{"id":1001590,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/48/76/0c7d4d23.jpg","nickname":"刘超","note":"","ucode":"196BF3F499E8FE","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":443013,"discussion_content":"不完全一样","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1567827967,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":75743,"user_name":"江南皮革厂研发中心保安队长","can_delete":false,"product_type":"c1","uid":1099584,"ip_address":"","ucode":"231419643A5CC5","user_header":"https://static001.geekbang.org/account/avatar/00/10/c7/40/66a203cd.jpg","comment_is_top":false,"comment_ctime":1552462673,"is_pvip":false,"replies":[{"id":"50251","content":"brctl比ovs功能少多了","user_name":"作者回复","user_name_real":"刘超@网易云","uid":"1001590","ctime":1567827982,"ip_address":"","comment_id":75743,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1552462673","product_id":100007101,"comment_content":"老师，之前接触openstack时候记得有个linuxbridge，请问它和OVS的区别主要是什么呢？","like_count":0,"discussions":[{"author":{"id":1001590,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/48/76/0c7d4d23.jpg","nickname":"刘超","note":"","ucode":"196BF3F499E8FE","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":443011,"discussion_content":"brctl比ovs功能少多了","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1567827982,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":70700,"user_name":"Leon📷","can_delete":false,"product_type":"c1","uid":1219496,"ip_address":"","ucode":"B9BBD1EFAAE5A2","user_header":"https://static001.geekbang.org/account/avatar/00/12/9b/a8/6a391c66.jpg","comment_is_top":false,"comment_ctime":1551167180,"is_pvip":false,"replies":[{"id":"50288","content":"可以啊","user_name":"作者回复","user_name_real":"刘超@网易云","uid":"1001590","ctime":1567839429,"ip_address":"","comment_id":70700,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1551167180","product_id":100007101,"comment_content":"老师，openvswitch的实验我可以用docker来模拟虚拟机吗","like_count":0,"discussions":[{"author":{"id":1001590,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/48/76/0c7d4d23.jpg","nickname":"刘超","note":"","ucode":"196BF3F499E8FE","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":440783,"discussion_content":"可以啊","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1567839429,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":45936,"user_name":"许森森","can_delete":false,"product_type":"c1","uid":1105360,"ip_address":"","ucode":"7C46D56DD8366B","user_header":"https://static001.geekbang.org/account/avatar/00/10/dd/d0/36b6eaf7.jpg","comment_is_top":false,"comment_ctime":1543822185,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1543822185","product_id":100007101,"comment_content":"实验一中的配置文件在哪里下啊？<br>ovs-vsctl  set  Port  vnet0 tag=101","like_count":1},{"had_liked":false,"id":33743,"user_name":"我爱探索","can_delete":false,"product_type":"c1","uid":1202924,"ip_address":"","ucode":"CEBD4F996747B5","user_header":"http://thirdwx.qlogo.cn/mmopen/vi_32/3IrblACSCxr7ianvicQXRexScIaZ1zXVQYc1eLUlia6WkhPNKPzMoIJRgfVHe1BHskfTx8E9FCmicYGCeZic6HrGbRA/132","comment_is_top":false,"comment_ctime":1539870088,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1539870088","product_id":100007101,"comment_content":"OpenDaylight和openvswtch是否自由开源并很好的扩展Linux系统的网络能力","like_count":0},{"had_liked":false,"id":31995,"user_name":"张张张 💭","can_delete":false,"product_type":"c1","uid":1132934,"ip_address":"","ucode":"91240B99999C68","user_header":"https://static001.geekbang.org/account/avatar/00/11/49/86/554cc50e.jpg","comment_is_top":false,"comment_ctime":1539352694,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1539352694","product_id":100007101,"comment_content":"一直在追，一直跟不上，不是这个专业，很多理解起来很困难，要看好几遍。讲得还是很专业的","like_count":0},{"had_liked":false,"id":28356,"user_name":"偏偏喜欢你","can_delete":false,"product_type":"c1","uid":1101985,"ip_address":"","ucode":"76D9E22B263D6B","user_header":"https://static001.geekbang.org/account/avatar/00/10/d0/a1/07027529.jpg","comment_is_top":false,"comment_ctime":1538060081,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1538060081","product_id":100007101,"comment_content":"老师您好，前面的还能看懂，现在有点跟不上了，有没有好的书籍推荐下，好加深理解，还有可以获得老师整理的网络知识图谱","like_count":0},{"had_liked":false,"id":16403,"user_name":"破晓","can_delete":false,"product_type":"c1","uid":1153316,"ip_address":"","ucode":"13C33DE0CFD43B","user_header":"https://static001.geekbang.org/account/avatar/00/11/99/24/e1cb609e.jpg","comment_is_top":false,"comment_ctime":1531926487,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1531926487","product_id":100007101,"comment_content":"哎，跟不上啦。","like_count":0}]}