{"id":303568,"title":"33 | è„‘è£‚ï¼šä¸€æ¬¡å¥‡æ€ªçš„æ•°æ®ä¸¢å¤±","content":"<p>ä½ å¥½ï¼Œæˆ‘æ˜¯è’‹å¾·é’§ã€‚</p><p>åœ¨ä½¿ç”¨ä¸»ä»é›†ç¾¤æ—¶ï¼Œæˆ‘æ›¾é‡åˆ°è¿‡è¿™æ ·ä¸€ä¸ªé—®é¢˜ï¼šæˆ‘ä»¬çš„ä¸»ä»é›†ç¾¤æœ‰1ä¸ªä¸»åº“ã€5ä¸ªä»åº“å’Œ3ä¸ªå“¨å…µå®ä¾‹ï¼Œåœ¨ä½¿ç”¨çš„è¿‡ç¨‹ä¸­ï¼Œæˆ‘ä»¬å‘ç°å®¢æˆ·ç«¯å‘é€çš„ä¸€äº›æ•°æ®ä¸¢å¤±äº†ï¼Œè¿™ç›´æ¥å½±å“åˆ°äº†ä¸šåŠ¡å±‚çš„æ•°æ®å¯é æ€§ã€‚</p><p>é€šè¿‡ä¸€ç³»åˆ—çš„é—®é¢˜æ’æŸ¥ï¼Œæˆ‘ä»¬æ‰çŸ¥é“ï¼Œè¿™å…¶å®æ˜¯ä¸»ä»é›†ç¾¤ä¸­çš„è„‘è£‚é—®é¢˜å¯¼è‡´çš„ã€‚</p><p>æ‰€è°“çš„è„‘è£‚ï¼Œå°±æ˜¯æŒ‡åœ¨ä¸»ä»é›†ç¾¤ä¸­ï¼ŒåŒæ—¶æœ‰ä¸¤ä¸ªä¸»èŠ‚ç‚¹ï¼Œå®ƒä»¬éƒ½èƒ½æ¥æ”¶å†™è¯·æ±‚ã€‚è€Œè„‘è£‚æœ€ç›´æ¥çš„å½±å“ï¼Œå°±æ˜¯å®¢æˆ·ç«¯ä¸çŸ¥é“åº”è¯¥å¾€å“ªä¸ªä¸»èŠ‚ç‚¹å†™å…¥æ•°æ®ï¼Œç»“æœå°±æ˜¯ä¸åŒçš„å®¢æˆ·ç«¯ä¼šå¾€ä¸åŒçš„ä¸»èŠ‚ç‚¹ä¸Šå†™å…¥æ•°æ®ã€‚è€Œä¸”ï¼Œä¸¥é‡çš„è¯ï¼Œè„‘è£‚ä¼šè¿›ä¸€æ­¥å¯¼è‡´æ•°æ®ä¸¢å¤±ã€‚</p><p>é‚£ä¹ˆï¼Œä¸»ä»é›†ç¾¤ä¸­ä¸ºä»€ä¹ˆä¼šå‘ç”Ÿè„‘è£‚ï¼Ÿè„‘è£‚ä¸ºä»€ä¹ˆåˆä¼šå¯¼è‡´æ•°æ®ä¸¢å¤±å‘¢ï¼Ÿæˆ‘ä»¬è¯¥å¦‚ä½•é¿å…è„‘è£‚çš„å‘ç”Ÿå‘¢ï¼Ÿè¿™èŠ‚è¯¾ï¼Œæˆ‘å°±ç»“åˆæˆ‘é‡è§çš„è¿™ä¸ªçœŸå®é—®é¢˜ï¼Œå¸¦ä½ ä¸€èµ·åˆ†æå’Œå®šä½é—®é¢˜ï¼Œå¸®åŠ©ä½ æŒæ¡è„‘è£‚çš„æˆå› ã€åæœå’Œåº”å¯¹æ–¹æ³•ã€‚</p><h2>ä¸ºä»€ä¹ˆä¼šå‘ç”Ÿè„‘è£‚ï¼Ÿ</h2><p>åˆšæ‰æˆ‘æåˆ°ï¼Œæˆ‘æœ€åˆå‘ç°çš„é—®é¢˜æ˜¯ï¼Œåœ¨ä¸»ä»é›†ç¾¤ä¸­ï¼Œå®¢æˆ·ç«¯å‘é€çš„æ•°æ®ä¸¢å¤±äº†ã€‚æ‰€ä»¥ï¼Œæˆ‘ä»¬é¦–å…ˆè¦å¼„æ˜ç™½ï¼Œä¸ºä»€ä¹ˆæ•°æ®ä¼šä¸¢å¤±ï¼Ÿæ˜¯ä¸æ˜¯æ•°æ®åŒæ­¥å‡ºäº†é—®é¢˜ï¼Ÿ</p><h3>ç¬¬ä¸€æ­¥ï¼šç¡®è®¤æ˜¯ä¸æ˜¯æ•°æ®åŒæ­¥å‡ºç°äº†é—®é¢˜</h3><p>åœ¨ä¸»ä»é›†ç¾¤ä¸­å‘ç”Ÿæ•°æ®ä¸¢å¤±ï¼Œæœ€å¸¸è§çš„åŸå› å°±æ˜¯<strong>ä¸»åº“çš„æ•°æ®è¿˜æ²¡æœ‰åŒæ­¥åˆ°ä»åº“ï¼Œç»“æœä¸»åº“å‘ç”Ÿäº†æ•…éšœï¼Œç­‰ä»åº“å‡çº§ä¸ºä¸»åº“åï¼ŒæœªåŒæ­¥çš„æ•°æ®å°±ä¸¢å¤±äº†ã€‚</strong></p><!-- [[[read_end]]] --><p>å¦‚ä¸‹å›¾æ‰€ç¤ºï¼Œæ–°å†™å…¥ä¸»åº“çš„æ•°æ®a:1ã€b:3ï¼Œå°±å› ä¸ºåœ¨ä¸»åº“æ•…éšœå‰æœªåŒæ­¥åˆ°ä»åº“è€Œä¸¢å¤±äº†ã€‚</p><p><img src=\"https://static001.geekbang.org/resource/image/46/a4/46a7bef9a7074b6a46978c2524f92ea4.jpg?wh=2115*1636\" alt=\"\"></p><p>å¦‚æœæ˜¯è¿™ç§æƒ…å†µçš„æ•°æ®ä¸¢å¤±ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡æ¯”å¯¹ä¸»ä»åº“ä¸Šçš„å¤åˆ¶è¿›åº¦å·®å€¼æ¥è¿›è¡Œåˆ¤æ–­ï¼Œä¹Ÿå°±æ˜¯è®¡ç®—master_repl_offsetå’Œslave_repl_offsetçš„å·®å€¼ã€‚å¦‚æœä»åº“ä¸Šçš„slave_repl_offsetå°äºåŸä¸»åº“çš„master_repl_offsetï¼Œé‚£ä¹ˆï¼Œæˆ‘ä»¬å°±å¯ä»¥è®¤å®šæ•°æ®ä¸¢å¤±æ˜¯ç”±æ•°æ®åŒæ­¥æœªå®Œæˆå¯¼è‡´çš„ã€‚</p><p>æˆ‘ä»¬åœ¨éƒ¨ç½²ä¸»ä»é›†ç¾¤æ—¶ï¼Œä¹Ÿç›‘æµ‹äº†ä¸»åº“ä¸Šçš„master_repl_offsetï¼Œä»¥åŠä»åº“ä¸Šçš„slave_repl_offsetã€‚ä½†æ˜¯ï¼Œå½“æˆ‘ä»¬å‘ç°æ•°æ®ä¸¢å¤±åï¼Œæˆ‘ä»¬æ£€æŸ¥äº†æ–°ä¸»åº“å‡çº§å‰çš„slave_repl_offsetï¼Œä»¥åŠåŸä¸»åº“çš„master_repl_offsetï¼Œå®ƒä»¬æ˜¯ä¸€è‡´çš„ï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œè¿™ä¸ªå‡çº§ä¸ºæ–°ä¸»åº“çš„ä»åº“ï¼Œåœ¨å‡çº§æ—¶å·²ç»å’ŒåŸä¸»åº“çš„æ•°æ®ä¿æŒä¸€è‡´äº†ã€‚é‚£ä¹ˆï¼Œä¸ºä»€ä¹ˆè¿˜ä¼šå‡ºç°å®¢æˆ·ç«¯å‘é€çš„æ•°æ®ä¸¢å¤±å‘¢ï¼Ÿ</p><p>åˆ†æåˆ°è¿™é‡Œï¼Œæˆ‘ä»¬çš„ç¬¬ä¸€ä¸ªè®¾æƒ³å°±è¢«æ¨ç¿»äº†ã€‚è¿™æ—¶ï¼Œæˆ‘ä»¬æƒ³åˆ°ï¼Œæ‰€æœ‰çš„æ•°æ®æ“ä½œéƒ½æ˜¯ä»å®¢æˆ·ç«¯å‘é€ç»™Rediså®ä¾‹çš„ï¼Œé‚£ä¹ˆï¼Œæ˜¯ä¸æ˜¯å¯ä»¥ä»å®¢æˆ·ç«¯æ“ä½œæ—¥å¿—ä¸­å‘ç°é—®é¢˜å‘¢ï¼Ÿç´§æ¥ç€ï¼Œæˆ‘ä»¬å°±æŠŠç›®å…‰è½¬åˆ°äº†å®¢æˆ·ç«¯ã€‚</p><h3>ç¬¬äºŒæ­¥ï¼šæ’æŸ¥å®¢æˆ·ç«¯çš„æ“ä½œæ—¥å¿—ï¼Œå‘ç°è„‘è£‚ç°è±¡</h3><p>åœ¨æ’æŸ¥å®¢æˆ·ç«¯çš„æ“ä½œæ—¥å¿—æ—¶ï¼Œæˆ‘ä»¬å‘ç°ï¼Œåœ¨ä¸»ä»åˆ‡æ¢åçš„ä¸€æ®µæ—¶é—´å†…ï¼Œæœ‰ä¸€ä¸ªå®¢æˆ·ç«¯ä»ç„¶åœ¨å’ŒåŸä¸»åº“é€šä¿¡ï¼Œå¹¶æ²¡æœ‰å’Œå‡çº§çš„æ–°ä¸»åº“è¿›è¡Œäº¤äº’ã€‚è¿™å°±ç›¸å½“äºä¸»ä»é›†ç¾¤ä¸­åŒæ—¶æœ‰äº†ä¸¤ä¸ªä¸»åº“ã€‚æ ¹æ®è¿™ä¸ªè¿¹è±¡ï¼Œæˆ‘ä»¬å°±æƒ³åˆ°äº†åœ¨åˆ†å¸ƒå¼ä¸»ä»é›†ç¾¤å‘ç”Ÿæ•…éšœæ—¶ä¼šå‡ºç°çš„ä¸€ä¸ªé—®é¢˜ï¼šè„‘è£‚ã€‚</p><p>ä½†æ˜¯ï¼Œä¸åŒå®¢æˆ·ç«¯ç»™ä¸¤ä¸ªä¸»åº“å‘é€æ•°æ®å†™æ“ä½œï¼ŒæŒ‰é“ç†æ¥è¯´ï¼Œåªä¼šå¯¼è‡´æ–°æ•°æ®ä¼šåˆ†å¸ƒåœ¨ä¸åŒçš„ä¸»åº“ä¸Šï¼Œå¹¶ä¸ä¼šé€ æˆæ•°æ®ä¸¢å¤±ã€‚é‚£ä¹ˆï¼Œä¸ºä»€ä¹ˆæˆ‘ä»¬çš„æ•°æ®ä»ç„¶ä¸¢å¤±äº†å‘¢ï¼Ÿ</p><p>åˆ°è¿™é‡Œï¼Œæˆ‘ä»¬çš„æ’æŸ¥æ€è·¯åˆä¸€æ¬¡ä¸­æ–­äº†ã€‚ä¸è¿‡ï¼Œåœ¨åˆ†æé—®é¢˜æ—¶ï¼Œæˆ‘ä»¬ä¸€ç›´è®¤ä¸ºâ€œä»åŸç†å‡ºå‘æ˜¯è¿½æœ¬æº¯æºçš„å¥½æ–¹æ³•â€ã€‚è„‘è£‚æ˜¯å‘ç”Ÿåœ¨ä¸»ä»åˆ‡æ¢çš„è¿‡ç¨‹ä¸­ï¼Œæˆ‘ä»¬çŒœæµ‹ï¼Œè‚¯å®šæ˜¯æ¼æ‰äº†ä¸»ä»é›†ç¾¤åˆ‡æ¢è¿‡ç¨‹ä¸­çš„æŸä¸ªç¯èŠ‚ï¼Œæ‰€ä»¥ï¼Œæˆ‘ä»¬æŠŠç ”ç©¶çš„ç„¦ç‚¹æŠ•å‘äº†ä¸»ä»åˆ‡æ¢çš„æ‰§è¡Œè¿‡ç¨‹ã€‚</p><h3>ç¬¬ä¸‰æ­¥ï¼šå‘ç°æ˜¯åŸä¸»åº“å‡æ•…éšœå¯¼è‡´çš„è„‘è£‚</h3><p>æˆ‘ä»¬æ˜¯é‡‡ç”¨å“¨å…µæœºåˆ¶è¿›è¡Œä¸»ä»åˆ‡æ¢çš„ï¼Œå½“ä¸»ä»åˆ‡æ¢å‘ç”Ÿæ—¶ï¼Œä¸€å®šæ˜¯æœ‰è¶…è¿‡é¢„è®¾æ•°é‡ï¼ˆquorumé…ç½®é¡¹ï¼‰çš„å“¨å…µå®ä¾‹å’Œä¸»åº“çš„å¿ƒè·³éƒ½è¶…æ—¶äº†ï¼Œæ‰ä¼šæŠŠä¸»åº“åˆ¤æ–­ä¸ºå®¢è§‚ä¸‹çº¿ï¼Œç„¶åï¼Œå“¨å…µå¼€å§‹æ‰§è¡Œåˆ‡æ¢æ“ä½œã€‚å“¨å…µåˆ‡æ¢å®Œæˆåï¼Œå®¢æˆ·ç«¯ä¼šå’Œæ–°ä¸»åº“è¿›è¡Œé€šä¿¡ï¼Œå‘é€è¯·æ±‚æ“ä½œã€‚</p><p>ä½†æ˜¯ï¼Œåœ¨åˆ‡æ¢è¿‡ç¨‹ä¸­ï¼Œæ—¢ç„¶å®¢æˆ·ç«¯ä»ç„¶å’ŒåŸä¸»åº“é€šä¿¡ï¼Œè¿™å°±è¡¨æ˜ï¼Œ<strong>åŸä¸»åº“å¹¶æ²¡æœ‰çœŸçš„å‘ç”Ÿæ•…éšœ</strong>ï¼ˆä¾‹å¦‚ä¸»åº“è¿›ç¨‹æŒ‚æ‰ï¼‰ã€‚æˆ‘ä»¬çŒœæµ‹ï¼Œä¸»åº“æ˜¯ç”±äºæŸäº›åŸå› æ— æ³•å¤„ç†è¯·æ±‚ï¼Œä¹Ÿæ²¡æœ‰å“åº”å“¨å…µçš„å¿ƒè·³ï¼Œæ‰è¢«å“¨å…µé”™è¯¯åœ°åˆ¤æ–­ä¸ºå®¢è§‚ä¸‹çº¿çš„ã€‚ç»“æœï¼Œåœ¨è¢«åˆ¤æ–­ä¸‹çº¿ä¹‹åï¼ŒåŸä¸»åº“åˆé‡æ–°å¼€å§‹å¤„ç†è¯·æ±‚äº†ï¼Œè€Œæ­¤æ—¶ï¼Œå“¨å…µè¿˜æ²¡æœ‰å®Œæˆä¸»ä»åˆ‡æ¢ï¼Œå®¢æˆ·ç«¯ä»ç„¶å¯ä»¥å’ŒåŸä¸»åº“é€šä¿¡ï¼Œå®¢æˆ·ç«¯å‘é€çš„å†™æ“ä½œå°±ä¼šåœ¨åŸä¸»åº“ä¸Šå†™å…¥æ•°æ®äº†ã€‚</p><p>ä¸ºäº†éªŒè¯åŸä¸»åº“åªæ˜¯â€œå‡æ•…éšœâ€ï¼Œæˆ‘ä»¬ä¹ŸæŸ¥çœ‹äº†åŸä¸»åº“æ‰€åœ¨æœåŠ¡å™¨çš„èµ„æºä½¿ç”¨ç›‘æ§è®°å½•ã€‚</p><p>çš„ç¡®ï¼Œæˆ‘ä»¬çœ‹åˆ°åŸä¸»åº“æ‰€åœ¨çš„æœºå™¨æœ‰ä¸€æ®µæ—¶é—´çš„CPUåˆ©ç”¨ç‡çªç„¶ç‰¹åˆ«é«˜ï¼Œè¿™æ˜¯æˆ‘ä»¬åœ¨æœºå™¨ä¸Šéƒ¨ç½²çš„ä¸€ä¸ªæ•°æ®é‡‡é›†ç¨‹åºå¯¼è‡´çš„ã€‚å› ä¸ºè¿™ä¸ªç¨‹åºåŸºæœ¬æŠŠæœºå™¨çš„CPUéƒ½ç”¨æ»¡äº†ï¼Œå¯¼è‡´Redisä¸»åº“æ— æ³•å“åº”å¿ƒè·³äº†ï¼Œåœ¨è¿™ä¸ªæœŸé—´å†…ï¼Œå“¨å…µå°±æŠŠä¸»åº“åˆ¤æ–­ä¸ºå®¢è§‚ä¸‹çº¿ï¼Œå¼€å§‹ä¸»ä»åˆ‡æ¢äº†ã€‚ä¸è¿‡ï¼Œè¿™ä¸ªæ•°æ®é‡‡é›†ç¨‹åºå¾ˆå¿«æ¢å¤æ­£å¸¸ï¼ŒCPUçš„ä½¿ç”¨ç‡ä¹Ÿé™ä¸‹æ¥äº†ã€‚æ­¤æ—¶ï¼ŒåŸä¸»åº“åˆå¼€å§‹æ­£å¸¸æœåŠ¡è¯·æ±‚äº†ã€‚</p><p>æ­£å› ä¸ºåŸä¸»åº“å¹¶æ²¡æœ‰çœŸçš„å‘ç”Ÿæ•…éšœï¼Œæˆ‘ä»¬åœ¨å®¢æˆ·ç«¯æ“ä½œæ—¥å¿—ä¸­å°±çœ‹åˆ°äº†å’ŒåŸä¸»åº“çš„é€šä¿¡è®°å½•ã€‚ç­‰åˆ°ä»åº“è¢«å‡çº§ä¸ºæ–°ä¸»åº“åï¼Œä¸»ä»é›†ç¾¤é‡Œå°±æœ‰ä¸¤ä¸ªä¸»åº“äº†ï¼Œåˆ°è¿™é‡Œï¼Œæˆ‘ä»¬å°±æŠŠè„‘è£‚å‘ç”Ÿçš„åŸå› æ‘¸æ¸…æ¥šäº†ã€‚</p><p>ä¸ºäº†å¸®åŠ©ä½ åŠ æ·±ç†è§£ï¼Œæˆ‘å†ç”»ä¸€å¼ å›¾ï¼Œå±•ç¤ºä¸€ä¸‹è„‘è£‚çš„å‘ç”Ÿè¿‡ç¨‹ã€‚</p><p><img src=\"https://static001.geekbang.org/resource/image/13/72/1339e1bfe6d07da8477342ba5fyy9872.jpg?wh=2592*1865\" alt=\"\"></p><p>å¼„æ¸…æ¥šäº†è„‘è£‚å‘ç”Ÿçš„åŸå› åï¼Œæˆ‘ä»¬åˆç»“åˆä¸»ä»åˆ‡æ¢çš„åŸç†è¿‡ç¨‹è¿›è¡Œäº†åˆ†æï¼Œå¾ˆå¿«å°±æ‰¾åˆ°æ•°æ®ä¸¢å¤±çš„åŸå› äº†ã€‚</p><h2>ä¸ºä»€ä¹ˆè„‘è£‚ä¼šå¯¼è‡´æ•°æ®ä¸¢å¤±ï¼Ÿ</h2><p>ä¸»ä»åˆ‡æ¢åï¼Œä»åº“ä¸€æ—¦å‡çº§ä¸ºæ–°ä¸»åº“ï¼Œå“¨å…µå°±ä¼šè®©åŸä¸»åº“æ‰§è¡Œslave ofå‘½ä»¤ï¼Œå’Œæ–°ä¸»åº“é‡æ–°è¿›è¡Œå…¨é‡åŒæ­¥ã€‚è€Œåœ¨å…¨é‡åŒæ­¥æ‰§è¡Œçš„æœ€åé˜¶æ®µï¼ŒåŸä¸»åº“éœ€è¦æ¸…ç©ºæœ¬åœ°çš„æ•°æ®ï¼ŒåŠ è½½æ–°ä¸»åº“å‘é€çš„RDBæ–‡ä»¶ï¼Œè¿™æ ·ä¸€æ¥ï¼ŒåŸä¸»åº“åœ¨ä¸»ä»åˆ‡æ¢æœŸé—´ä¿å­˜çš„æ–°å†™æ•°æ®å°±ä¸¢å¤±äº†ã€‚</p><p>ä¸‹é¢è¿™å¼ å›¾ç›´è§‚åœ°å±•ç¤ºäº†åŸä¸»åº“æ•°æ®ä¸¢å¤±çš„è¿‡ç¨‹ã€‚</p><p><img src=\"https://static001.geekbang.org/resource/image/95/66/959240fa59c2bb9f5ddb7df4b318af66.jpg?wh=2671*1872\" alt=\"\"></p><p>åˆ°è¿™é‡Œï¼Œæˆ‘ä»¬å°±å®Œå…¨å¼„æ˜ç™½äº†è¿™ä¸ªé—®é¢˜çš„å‘ç”Ÿè¿‡ç¨‹å’ŒåŸå› ã€‚</p><p>åœ¨ä¸»ä»åˆ‡æ¢çš„è¿‡ç¨‹ä¸­ï¼Œå¦‚æœåŸä¸»åº“åªæ˜¯â€œå‡æ•…éšœâ€ï¼Œå®ƒä¼šè§¦å‘å“¨å…µå¯åŠ¨ä¸»ä»åˆ‡æ¢ï¼Œä¸€æ—¦ç­‰å®ƒä»å‡æ•…éšœä¸­æ¢å¤åï¼Œåˆå¼€å§‹å¤„ç†è¯·æ±‚ï¼Œè¿™æ ·ä¸€æ¥ï¼Œå°±ä¼šå’Œæ–°ä¸»åº“åŒæ—¶å­˜åœ¨ï¼Œå½¢æˆè„‘è£‚ã€‚ç­‰åˆ°å“¨å…µè®©åŸä¸»åº“å’Œæ–°ä¸»åº“åšå…¨é‡åŒæ­¥åï¼ŒåŸä¸»åº“åœ¨åˆ‡æ¢æœŸé—´ä¿å­˜çš„æ•°æ®å°±ä¸¢å¤±äº†ã€‚</p><p>çœ‹åˆ°è¿™é‡Œï¼Œä½ è‚¯å®šä¼šå¾ˆå…³å¿ƒï¼Œæˆ‘ä»¬è¯¥æ€ä¹ˆåº”å¯¹è„‘è£‚é€ æˆçš„æ•°æ®ä¸¢å¤±é—®é¢˜å‘¢ï¼Ÿ</p><h2>å¦‚ä½•åº”å¯¹è„‘è£‚é—®é¢˜ï¼Ÿ</h2><p>åˆšåˆšè¯´äº†ï¼Œä¸»ä»é›†ç¾¤ä¸­çš„æ•°æ®ä¸¢å¤±äº‹ä»¶ï¼Œå½’æ ¹ç»“åº•æ˜¯å› ä¸ºå‘ç”Ÿäº†è„‘è£‚ã€‚æ‰€ä»¥ï¼Œæˆ‘ä»¬å¿…é¡»è¦æ‰¾åˆ°åº”å¯¹è„‘è£‚é—®é¢˜çš„ç­–ç•¥ã€‚</p><p>æ—¢ç„¶é—®é¢˜æ˜¯å‡ºåœ¨åŸä¸»åº“å‘ç”Ÿå‡æ•…éšœåä»ç„¶èƒ½æ¥æ”¶è¯·æ±‚ä¸Šï¼Œæˆ‘ä»¬å°±å¼€å§‹åœ¨ä¸»ä»é›†ç¾¤æœºåˆ¶çš„é…ç½®é¡¹ä¸­æŸ¥æ‰¾æ˜¯å¦æœ‰é™åˆ¶ä¸»åº“æ¥æ”¶è¯·æ±‚çš„è®¾ç½®ã€‚</p><p>é€šè¿‡æŸ¥æ‰¾ï¼Œæˆ‘ä»¬å‘ç°ï¼ŒRediså·²ç»æä¾›äº†ä¸¤ä¸ªé…ç½®é¡¹æ¥é™åˆ¶ä¸»åº“çš„è¯·æ±‚å¤„ç†ï¼Œåˆ†åˆ«æ˜¯min-slaves-to-writeå’Œmin-slaves-max-lagã€‚</p><ul>\n<li>min-slaves-to-writeï¼šè¿™ä¸ªé…ç½®é¡¹è®¾ç½®äº†ä¸»åº“èƒ½è¿›è¡Œæ•°æ®åŒæ­¥çš„æœ€å°‘ä»åº“æ•°é‡ï¼›</li>\n<li>min-slaves-max-lagï¼šè¿™ä¸ªé…ç½®é¡¹è®¾ç½®äº†ä¸»ä»åº“é—´è¿›è¡Œæ•°æ®å¤åˆ¶æ—¶ï¼Œä»åº“ç»™ä¸»åº“å‘é€ACKæ¶ˆæ¯çš„æœ€å¤§å»¶è¿Ÿï¼ˆä»¥ç§’ä¸ºå•ä½ï¼‰ã€‚</li>\n</ul><p>æœ‰äº†è¿™ä¸¤ä¸ªé…ç½®é¡¹åï¼Œæˆ‘ä»¬å°±å¯ä»¥è½»æ¾åœ°åº”å¯¹è„‘è£‚é—®é¢˜äº†ã€‚å…·ä½“å’‹åšå‘¢ï¼Ÿ</p><p>æˆ‘ä»¬å¯ä»¥æŠŠmin-slaves-to-writeå’Œmin-slaves-max-lagè¿™ä¸¤ä¸ªé…ç½®é¡¹æ­é…èµ·æ¥ä½¿ç”¨ï¼Œåˆ†åˆ«ç»™å®ƒä»¬è®¾ç½®ä¸€å®šçš„é˜ˆå€¼ï¼Œå‡è®¾ä¸ºNå’ŒTã€‚è¿™ä¸¤ä¸ªé…ç½®é¡¹ç»„åˆåçš„è¦æ±‚æ˜¯ï¼Œä¸»åº“è¿æ¥çš„ä»åº“ä¸­è‡³å°‘æœ‰Nä¸ªä»åº“ï¼Œå’Œä¸»åº“è¿›è¡Œæ•°æ®å¤åˆ¶æ—¶çš„ACKæ¶ˆæ¯å»¶è¿Ÿä¸èƒ½è¶…è¿‡Tç§’ï¼Œå¦åˆ™ï¼Œä¸»åº“å°±ä¸ä¼šå†æ¥æ”¶å®¢æˆ·ç«¯çš„è¯·æ±‚äº†ã€‚</p><p>å³ä½¿åŸä¸»åº“æ˜¯å‡æ•…éšœï¼Œå®ƒåœ¨å‡æ•…éšœæœŸé—´ä¹Ÿæ— æ³•å“åº”å“¨å…µå¿ƒè·³ï¼Œä¹Ÿä¸èƒ½å’Œä»åº“è¿›è¡ŒåŒæ­¥ï¼Œè‡ªç„¶ä¹Ÿå°±æ— æ³•å’Œä»åº“è¿›è¡ŒACKç¡®è®¤äº†ã€‚è¿™æ ·ä¸€æ¥ï¼Œmin-slaves-to-writeå’Œmin-slaves-max-lagçš„ç»„åˆè¦æ±‚å°±æ— æ³•å¾—åˆ°æ»¡è¶³ï¼ŒåŸä¸»åº“å°±ä¼šè¢«é™åˆ¶æ¥æ”¶å®¢æˆ·ç«¯è¯·æ±‚ï¼Œå®¢æˆ·ç«¯ä¹Ÿå°±ä¸èƒ½åœ¨åŸä¸»åº“ä¸­å†™å…¥æ–°æ•°æ®äº†ã€‚</p><p>ç­‰åˆ°æ–°ä¸»åº“ä¸Šçº¿æ—¶ï¼Œå°±åªæœ‰æ–°ä¸»åº“èƒ½æ¥æ”¶å’Œå¤„ç†å®¢æˆ·ç«¯è¯·æ±‚ï¼Œæ­¤æ—¶ï¼Œæ–°å†™çš„æ•°æ®ä¼šè¢«ç›´æ¥å†™åˆ°æ–°ä¸»åº“ä¸­ã€‚è€ŒåŸä¸»åº“ä¼šè¢«å“¨å…µé™ä¸ºä»åº“ï¼Œå³ä½¿å®ƒçš„æ•°æ®è¢«æ¸…ç©ºäº†ï¼Œä¹Ÿä¸ä¼šæœ‰æ–°æ•°æ®ä¸¢å¤±ã€‚</p><p>æˆ‘å†æ¥ç»™ä½ ä¸¾ä¸ªä¾‹å­ã€‚</p><p>å‡è®¾æˆ‘ä»¬å°†min-slaves-to-writeè®¾ç½®ä¸º1ï¼ŒæŠŠmin-slaves-max-lagè®¾ç½®ä¸º12sï¼ŒæŠŠå“¨å…µçš„down-after-millisecondsè®¾ç½®ä¸º10sï¼Œä¸»åº“å› ä¸ºæŸäº›åŸå› å¡ä½äº†15sï¼Œå¯¼è‡´å“¨å…µåˆ¤æ–­ä¸»åº“å®¢è§‚ä¸‹çº¿ï¼Œå¼€å§‹è¿›è¡Œä¸»ä»åˆ‡æ¢ã€‚åŒæ—¶ï¼Œå› ä¸ºåŸä¸»åº“å¡ä½äº†15sï¼Œæ²¡æœ‰ä¸€ä¸ªä»åº“èƒ½å’ŒåŸä¸»åº“åœ¨12så†…è¿›è¡Œæ•°æ®å¤åˆ¶ï¼ŒåŸä¸»åº“ä¹Ÿæ— æ³•æ¥æ”¶å®¢æˆ·ç«¯è¯·æ±‚äº†ã€‚è¿™æ ·ä¸€æ¥ï¼Œä¸»ä»åˆ‡æ¢å®Œæˆåï¼Œä¹Ÿåªæœ‰æ–°ä¸»åº“èƒ½æ¥æ”¶è¯·æ±‚ï¼Œä¸ä¼šå‘ç”Ÿè„‘è£‚ï¼Œä¹Ÿå°±ä¸ä¼šå‘ç”Ÿæ•°æ®ä¸¢å¤±çš„é—®é¢˜äº†ã€‚</p><h2>å°ç»“</h2><p>è¿™èŠ‚è¯¾ï¼Œæˆ‘ä»¬å­¦ä¹ äº†ä¸»ä»åˆ‡æ¢æ—¶å¯èƒ½é‡åˆ°çš„è„‘è£‚é—®é¢˜ã€‚è„‘è£‚æ˜¯æŒ‡åœ¨ä¸»ä»é›†ç¾¤ä¸­ï¼ŒåŒæ—¶æœ‰ä¸¤ä¸ªä¸»åº“éƒ½èƒ½æ¥æ”¶å†™è¯·æ±‚ã€‚åœ¨Redisçš„ä¸»ä»åˆ‡æ¢è¿‡ç¨‹ä¸­ï¼Œå¦‚æœå‘ç”Ÿäº†è„‘è£‚ï¼Œå®¢æˆ·ç«¯æ•°æ®å°±ä¼šå†™å…¥åˆ°åŸä¸»åº“ï¼Œå¦‚æœåŸä¸»åº“è¢«é™ä¸ºä»åº“ï¼Œè¿™äº›æ–°å†™å…¥çš„æ•°æ®å°±ä¸¢å¤±äº†ã€‚</p><p>è„‘è£‚å‘ç”Ÿçš„åŸå› ä¸»è¦æ˜¯åŸä¸»åº“å‘ç”Ÿäº†å‡æ•…éšœï¼Œæˆ‘ä»¬æ¥æ€»ç»“ä¸‹å‡æ•…éšœçš„ä¸¤ä¸ªåŸå› ã€‚</p><ol>\n<li>å’Œä¸»åº“éƒ¨ç½²åœ¨åŒä¸€å°æœåŠ¡å™¨ä¸Šçš„å…¶ä»–ç¨‹åºä¸´æ—¶å ç”¨äº†å¤§é‡èµ„æºï¼ˆä¾‹å¦‚CPUèµ„æºï¼‰ï¼Œå¯¼è‡´ä¸»åº“èµ„æºä½¿ç”¨å—é™ï¼ŒçŸ­æ—¶é—´å†…æ— æ³•å“åº”å¿ƒè·³ã€‚å…¶å®ƒç¨‹åºä¸å†ä½¿ç”¨èµ„æºæ—¶ï¼Œä¸»åº“åˆæ¢å¤æ­£å¸¸ã€‚</li>\n<li>ä¸»åº“è‡ªèº«é‡åˆ°äº†é˜»å¡çš„æƒ…å†µï¼Œä¾‹å¦‚ï¼Œå¤„ç†bigkeyæˆ–æ˜¯å‘ç”Ÿå†…å­˜swapï¼ˆä½ å¯ä»¥å¤ä¹ ä¸‹<a href=\"https://time.geekbang.org/column/article/287819\">ç¬¬19è®²</a>ä¸­æ€»ç»“çš„å¯¼è‡´å®ä¾‹é˜»å¡çš„åŸå› ï¼‰ï¼ŒçŸ­æ—¶é—´å†…æ— æ³•å“åº”å¿ƒè·³ï¼Œç­‰ä¸»åº“é˜»å¡è§£é™¤åï¼Œåˆæ¢å¤æ­£å¸¸çš„è¯·æ±‚å¤„ç†äº†ã€‚</li>\n</ol><p>ä¸ºäº†åº”å¯¹è„‘è£‚ï¼Œä½ å¯ä»¥åœ¨ä¸»ä»é›†ç¾¤éƒ¨ç½²æ—¶ï¼Œé€šè¿‡åˆç†åœ°é…ç½®å‚æ•°min-slaves-to-writeå’Œmin-slaves-max-lagï¼Œæ¥é¢„é˜²è„‘è£‚çš„å‘ç”Ÿã€‚</p><p>åœ¨å®é™…åº”ç”¨ä¸­ï¼Œå¯èƒ½ä¼šå› ä¸ºç½‘ç»œæš‚æ—¶æ‹¥å¡å¯¼è‡´ä»åº“æš‚æ—¶å’Œä¸»åº“çš„ACKæ¶ˆæ¯è¶…æ—¶ã€‚åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œå¹¶ä¸æ˜¯ä¸»åº“å‡æ•…éšœï¼Œæˆ‘ä»¬ä¹Ÿä¸ç”¨ç¦æ­¢ä¸»åº“æ¥æ”¶è¯·æ±‚ã€‚</p><p>æ‰€ä»¥ï¼Œæˆ‘ç»™ä½ çš„å»ºè®®æ˜¯ï¼Œå‡è®¾ä»åº“æœ‰Kä¸ªï¼Œå¯ä»¥å°†min-slaves-to-writeè®¾ç½®ä¸ºK/2+1ï¼ˆå¦‚æœKç­‰äº1ï¼Œå°±è®¾ä¸º1ï¼‰ï¼Œå°†min-slaves-max-lagè®¾ç½®ä¸ºåå‡ ç§’ï¼ˆä¾‹å¦‚10ï½20sï¼‰ï¼Œåœ¨è¿™ä¸ªé…ç½®ä¸‹ï¼Œå¦‚æœæœ‰ä¸€åŠä»¥ä¸Šçš„ä»åº“å’Œä¸»åº“è¿›è¡Œçš„ACKæ¶ˆæ¯å»¶è¿Ÿè¶…è¿‡åå‡ ç§’ï¼Œæˆ‘ä»¬å°±ç¦æ­¢ä¸»åº“æ¥æ”¶å®¢æˆ·ç«¯å†™è¯·æ±‚ã€‚</p><p>è¿™æ ·ä¸€æ¥ï¼Œæˆ‘ä»¬å¯ä»¥é¿å…è„‘è£‚å¸¦æ¥æ•°æ®ä¸¢å¤±çš„æƒ…å†µï¼Œè€Œä¸”ï¼Œä¹Ÿä¸ä¼šå› ä¸ºåªæœ‰å°‘æ•°å‡ ä¸ªä»åº“å› ä¸ºç½‘ç»œé˜»å¡è¿ä¸ä¸Šä¸»åº“ï¼Œå°±ç¦æ­¢ä¸»åº“æ¥æ”¶è¯·æ±‚ï¼Œå¢åŠ äº†ç³»ç»Ÿçš„é²æ£’æ€§ã€‚</p><h2>æ¯è¯¾ä¸€é—®</h2><p>æŒ‰ç…§æƒ¯ä¾‹ï¼Œæˆ‘ç»™ä½ æä¸ªå°é—®é¢˜ï¼Œå‡è®¾æˆ‘ä»¬å°†min-slaves-to-writeè®¾ç½®ä¸º1ï¼Œmin-slaves-max-lagè®¾ç½®ä¸º15sï¼Œå“¨å…µçš„down-after-millisecondsè®¾ç½®ä¸º10sï¼Œå“¨å…µä¸»ä»åˆ‡æ¢éœ€è¦5sã€‚ä¸»åº“å› ä¸ºæŸäº›åŸå› å¡ä½äº†12sï¼Œæ­¤æ—¶ï¼Œè¿˜ä¼šå‘ç”Ÿè„‘è£‚å—ï¼Ÿä¸»ä»åˆ‡æ¢å®Œæˆåï¼Œæ•°æ®ä¼šä¸¢å¤±å—ï¼Ÿ</p><p>æ¬¢è¿åœ¨ç•™è¨€åŒºå†™ä¸‹ä½ çš„æ€è€ƒå’Œç­”æ¡ˆï¼Œæˆ‘ä»¬ä¸€èµ·äº¤æµè®¨è®ºã€‚å¦‚æœä½ è§‰å¾—ä»Šå¤©çš„å†…å®¹å¯¹ä½ æœ‰æ‰€å¸®åŠ©ï¼Œä¹Ÿæ¬¢è¿ä½ åˆ†äº«ç»™ä½ çš„æœ‹å‹æˆ–åŒäº‹ã€‚æˆ‘ä»¬ä¸‹èŠ‚è¯¾è§ã€‚</p>","neighbors":{"left":{"article_title":"32 | Redisä¸»ä»åŒæ­¥ä¸æ•…éšœåˆ‡æ¢ï¼Œæœ‰å“ªäº›å‘ï¼Ÿ","id":303247},"right":{"article_title":"34 | ç¬¬23~33è®²è¯¾åæ€è€ƒé¢˜ç­”æ¡ˆåŠå¸¸è§é—®é¢˜ç­”ç–‘","id":304145}},"comments":[{"had_liked":false,"id":258425,"user_name":"Kaito","can_delete":false,"product_type":"c1","uid":1020042,"ip_address":"","ucode":"79775FA35A95F2","user_header":"https://static001.geekbang.org/account/avatar/00/0f/90/8a/288f9f94.jpg","comment_is_top":false,"comment_ctime":1604421741,"is_pvip":true,"discussion_count":21,"race_medal":0,"score":"1092526114925","product_id":100056701,"comment_content":"å‡è®¾æˆ‘ä»¬å°† min-slaves-to-write è®¾ç½®ä¸º 1ï¼Œmin-slaves-max-lag è®¾ç½®ä¸º 15sï¼Œå“¨å…µçš„ down-after-milliseconds è®¾ç½®ä¸º 10sï¼Œå“¨å…µä¸»ä»åˆ‡æ¢éœ€è¦ 5sã€‚ä¸»åº“å› ä¸ºæŸäº›åŸå› å¡ä½äº† 12sï¼Œæ­¤æ—¶ï¼Œè¿˜ä¼šå‘ç”Ÿè„‘è£‚å—ï¼Ÿä¸»ä»åˆ‡æ¢å®Œæˆåï¼Œæ•°æ®ä¼šä¸¢å¤±å—ï¼Ÿ<br><br>ä¸»åº“å¡ä½ 12sï¼Œè¾¾åˆ°äº†å“¨å…µè®¾å®šçš„åˆ‡æ¢é˜ˆå€¼ï¼Œæ‰€ä»¥å“¨å…µä¼šè§¦å‘ä¸»ä»åˆ‡æ¢ã€‚ä½†å“¨å…µåˆ‡æ¢çš„æ—¶é—´æ˜¯ 5sï¼Œä¹Ÿå°±æ˜¯è¯´å“¨å…µè¿˜æœªåˆ‡æ¢å®Œæˆï¼Œä¸»åº“å°±ä¼šä»é˜»å¡çŠ¶æ€ä¸­æ¢å¤å›æ¥ï¼Œè€Œä¸”ä¹Ÿæ²¡æœ‰è§¦å‘ min-slaves-max-lag é˜ˆå€¼ï¼Œæ‰€ä»¥ä¸»åº“åœ¨å“¨å…µåˆ‡æ¢å‰©ä¸‹çš„ 3s å†…ï¼Œä¾æ—§å¯ä»¥æ¥æ”¶å®¢æˆ·ç«¯çš„å†™æ“ä½œï¼Œå¦‚æœè¿™äº›å†™æ“ä½œè¿˜æœªåŒæ­¥åˆ°ä»åº“ï¼Œå“¨å…µå°±æŠŠä»åº“æå‡ä¸ºä¸»åº“äº†ï¼Œé‚£ä¹ˆæ­¤æ—¶ä¹Ÿä¼šå‡ºç°è„‘è£‚çš„æƒ…å†µï¼Œä¹‹åæ—§ä¸»åº“é™çº§ä¸ºä»åº“ï¼Œé‡æ–°åŒæ­¥æ–°ä¸»åº“çš„æ•°æ®ï¼Œæ–°ä¸»åº“ä¹Ÿä¼šå‘ç”Ÿæ•°æ®ä¸¢å¤±ã€‚<br><br>ç”±æ­¤ä¹Ÿå¯ä»¥çœ‹å‡ºï¼Œå³ä½¿ Redis é…ç½®äº† min-slaves-to-write å’Œ min-slaves-max-lagï¼Œå½“è„‘è£‚å‘ç”Ÿæ—¶ï¼Œè¿˜æ˜¯æ— æ³•ä¸¥æ ¼ä¿è¯æ•°æ®ä¸ä¸¢å¤±ï¼Œå®ƒåªèƒ½æ˜¯å°½é‡å‡å°‘æ•°æ®çš„ä¸¢å¤±ã€‚<br><br>å…¶å®åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œæ–°ä¸»åº“ä¹‹æ‰€ä»¥ä¼šå‘ç”Ÿæ•°æ®ä¸¢å¤±ï¼Œæ˜¯å› ä¸ºæ—§ä¸»åº“ä»é˜»å¡ä¸­æ¢å¤è¿‡æ¥åï¼Œæ”¶åˆ°çš„å†™è¯·æ±‚è¿˜æ²¡åŒæ­¥åˆ°ä»åº“ï¼Œä»åº“å°±è¢«å“¨å…µæå‡ä¸ºä¸»åº“äº†ã€‚å¦‚æœå“¨å…µåœ¨æå‡ä»åº“ä¸ºæ–°ä¸»åº“å‰ï¼Œä¸»åº“åŠæ—¶æŠŠæ•°æ®åŒæ­¥åˆ°ä»åº“äº†ï¼Œé‚£ä¹ˆä»åº“æå‡ä¸ºä¸»åº“åï¼Œä¹Ÿä¸ä¼šå‘ç”Ÿæ•°æ®ä¸¢å¤±ã€‚ä½†è¿™ç§ä¸´ç•Œç‚¹çš„æƒ…å†µè¿˜æ˜¯æœ‰å‘ç”Ÿçš„å¯èƒ½æ€§ï¼Œå› ä¸º Redis æœ¬èº«ä¸ä¿è¯ä¸»ä»åŒæ­¥çš„å¼ºä¸€è‡´ã€‚<br><br>è¿˜æœ‰ä¸€ç§å‘ç”Ÿè„‘è£‚çš„æƒ…å†µï¼Œå°±æ˜¯ç½‘ç»œåˆ†åŒºï¼šä¸»åº“å’Œå®¢æˆ·ç«¯ã€å“¨å…µå’Œä»åº“è¢«åˆ†å‰²æˆäº† 2 ä¸ªç½‘ç»œï¼Œä¸»åº“å’Œå®¢æˆ·ç«¯å¤„åœ¨ä¸€ä¸ªç½‘ç»œä¸­ï¼Œä»åº“å’Œå“¨å…µåœ¨å¦ä¸€ä¸ªç½‘ç»œä¸­ï¼Œæ­¤æ—¶å“¨å…µä¹Ÿä¼šå‘èµ·ä¸»ä»åˆ‡æ¢ï¼Œå‡ºç° 2 ä¸ªä¸»åº“çš„æƒ…å†µï¼Œè€Œä¸”å®¢æˆ·ç«¯ä¾æ—§å¯ä»¥å‘æ—§ä¸»åº“å†™å…¥æ•°æ®ã€‚ç­‰ç½‘ç»œæ¢å¤åï¼Œä¸»åº“é™çº§ä¸ºä»åº“ï¼Œæ–°ä¸»åº“ä¸¢å¤±äº†è¿™æœŸé—´å†™æ“ä½œçš„æ•°æ®ã€‚<br><br>è„‘è£‚äº§ç”Ÿé—®é¢˜çš„æœ¬è´¨åŸå› æ˜¯ï¼ŒRedis ä¸»ä»é›†ç¾¤å†…éƒ¨æ²¡æœ‰é€šè¿‡å…±è¯†ç®—æ³•ï¼Œæ¥ç»´æŠ¤å¤šä¸ªèŠ‚ç‚¹æ•°æ®çš„å¼ºä¸€è‡´æ€§ã€‚å®ƒä¸åƒ Zookeeper é‚£æ ·ï¼Œæ¯æ¬¡å†™è¯·æ±‚å¿…é¡»å¤§å¤šæ•°èŠ‚ç‚¹å†™æˆåŠŸåæ‰è®¤ä¸ºæˆåŠŸã€‚å½“è„‘è£‚å‘ç”Ÿæ—¶ï¼ŒZookeeper ä¸»èŠ‚ç‚¹è¢«å­¤ç«‹ï¼Œæ­¤æ—¶æ— æ³•å†™å…¥å¤§å¤šæ•°èŠ‚ç‚¹ï¼Œå†™è¯·æ±‚ä¼šç›´æ¥è¿”å›å¤±è´¥ï¼Œå› æ­¤å®ƒå¯ä»¥ä¿è¯é›†ç¾¤æ•°æ®çš„ä¸€è‡´æ€§ã€‚<br><br>å¦å¤–å…³äº min-slaves-to-writeï¼Œæœ‰ä¸€ç‚¹ä¹Ÿéœ€è¦æ³¨æ„ï¼šå¦‚æœåªæœ‰ 1 ä¸ªä»åº“ï¼Œå½“æŠŠ min-slaves-to-write è®¾ç½®ä¸º 1 æ—¶ï¼Œåœ¨è¿ç»´æ—¶éœ€è¦å°å¿ƒä¸€äº›ï¼Œå½“æ—¥å¸¸å¯¹ä»åº“åšç»´æŠ¤æ—¶ï¼Œä¾‹å¦‚æ›´æ¢ä»åº“çš„å®ä¾‹ï¼Œéœ€è¦å…ˆæ·»åŠ æ–°çš„ä»åº“ï¼Œå†ç§»é™¤æ—§çš„ä»åº“æ‰å¯ä»¥ï¼Œæˆ–è€…ä½¿ç”¨ config set ä¿®æ”¹ min-slaves-to-write ä¸º 0 å†åšæ“ä½œï¼Œå¦åˆ™ä¼šå¯¼è‡´ä¸»åº“æ‹’ç»å†™ï¼Œå½±å“åˆ°ä¸šåŠ¡ã€‚","like_count":255,"discussions":[{"author":{"id":1133919,"avatar":"https://static001.geekbang.org/account/avatar/00/11/4d/5f/835a9d46.jpg","nickname":"ä¿¡å¿µ","note":"","ucode":"A2F35A4CDD937E","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":408835,"discussion_content":"Min-slave-max-lagå’Œdown-after-millisecondsè®¾ç½®æˆä¸€æ ·çš„å€¼æ˜¯ä¸æ˜¯å°±å¯ä»¥äº†ï¼Œåœ¨å‡†å¤‡å¼€å§‹åˆ‡æ¢çš„æ—¶å€™ï¼Œå°±ä¸è®©ä¸»åº“æ¥å—å‘½ä»¤äº†ï¼Œè¿™æ ·åšå¯ä»¥å—ï¼Ÿæ±‚é«˜æ‰‹æŒ‡ç‚¹","likes_number":1,"is_delete":false,"is_hidden":false,"ctime":1635330184,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":2,"child_discussions":[{"author":{"id":1736462,"avatar":"https://static001.geekbang.org/account/avatar/00/1a/7f/0e/e3a8dbd9.jpg","nickname":"Liujun","note":"","ucode":"3DB1F3CA57B5B3","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":1133919,"avatar":"https://static001.geekbang.org/account/avatar/00/11/4d/5f/835a9d46.jpg","nickname":"ä¿¡å¿µ","note":"","ucode":"A2F35A4CDD937E","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":412964,"discussion_content":"é€šå¸¸è®¾ç½®ä¸ºï¼šmin-slave-max-lag <= down-after-milliseconds","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1636342108,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":408835,"ip_address":""},"score":412964,"extra":""},{"author":{"id":2898098,"avatar":"https://static001.geekbang.org/account/avatar/00/2c/38/b2/f1d51239.jpg","nickname":"ä¼šè¯´è¯çš„æµæ°“","note":"","ucode":"649FD336CE9BE3","race_medal":0,"user_type":1,"is_pvip":true},"reply_author":{"id":1736462,"avatar":"https://static001.geekbang.org/account/avatar/00/1a/7f/0e/e3a8dbd9.jpg","nickname":"Liujun","note":"","ucode":"3DB1F3CA57B5B3","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":560984,"discussion_content":"æˆ‘ä¹Ÿæ˜¯è¿™ä¹ˆè§‰å¾—","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1649507246,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":412964,"ip_address":""},"score":560984,"extra":""}]},{"author":{"id":1170843,"avatar":"https://static001.geekbang.org/account/avatar/00/11/dd/9b/0bc44a78.jpg","nickname":"yyl","note":"","ucode":"1741DACDFCA9AF","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":322427,"discussion_content":"ç†è§£ä¸€è‡´ï¼Œæ— æ³•åšåˆ°ç»å¯¹çš„æ•°æ®ä¸ä¸¢å¤±ï¼Œå˜¿å˜¿","likes_number":1,"is_delete":false,"is_hidden":false,"ctime":1604741903,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1415619,"avatar":"https://static001.geekbang.org/account/avatar/00/15/99/c3/e4f408d4.jpg","nickname":"é™Œå…®","note":"","ucode":"00CE47CAECD5CD","race_medal":0,"user_type":1,"is_pvip":true},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":553746,"discussion_content":"ç²¾å½©ï¼ç»†è‡´å…¥å¾®","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1646047669,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":2900973,"avatar":"","nickname":"Geek_064e72","note":"","ucode":"D627BACE46C37C","race_medal":0,"user_type":1,"is_pvip":true},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":550068,"discussion_content":"redisä¹‹æ‰€ä»¥å¿«ï¼Œå…¶ä¸­ä¹‹ä¸€å°±æ˜¯å„ç§ä¸´ç•Œæ¡ä»¶å¹¶æ²¡æœ‰è¢«å¤„ç†ï¼Œæ‰€ä»¥è¿˜æ˜¯å°†redisçœ‹ä½œä¸€ä¸ªç¼“å­˜å§ï¼Œæ•æ„Ÿæ•°æ®å°±ä¸è¦å­˜æ”¾åœ¨redisäº†ã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1644374544,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":2348024,"avatar":"","nickname":"Geek_c3bf02","note":"","ucode":"97C6848DFCA2A0","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":334211,"discussion_content":"å¤§ä½¬ä»¬æ‰“æ‰°äº†ï¼Œç½‘ç»œåˆ†åŒºäº§ç”Ÿçš„è„‘è£‚ ä¸å¤ªæ˜ç™½ å¯ä»¥ç»†è®²ä¸€ç‚¹å— è°¢è°¢è°¢è°¢","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1607766773,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":4,"child_discussions":[{"author":{"id":1253597,"avatar":"https://static001.geekbang.org/account/avatar/00/13/20/dd/82d8eff2.jpg","nickname":"Mine","note":"","ucode":"85C3A3117FD9CB","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":2348024,"avatar":"","nickname":"Geek_c3bf02","note":"","ucode":"97C6848DFCA2A0","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":335593,"discussion_content":"æˆ‘ä¹Ÿæœ‰è¿™ä¸ªç–‘é—®ï¼Œä¸»å’Œå®¢æˆ·ç«¯ä¸€ä¸ªç½‘ç»œåˆ†åŒºï¼Œä»ä¸å“¨å…µé›†ç¾¤ä¸€ä¸ªç½‘ç»œåˆ†åŒºï¼Œè¿™ä¹ˆè¯´çš„è¯ï¼Œä¸»æ˜¯æ²¡æ³•ä¸ä»è¿›è¡Œé€šä¿¡çš„ï¼Œè‡ªç„¶æ˜¯æ— æ³•æ»¡è¶³è‡³å°‘æœ‰ N ä¸ªä»åº“ï¼Œå’Œä¸»åº“è¿›è¡Œæ•°æ®å¤åˆ¶æ—¶çš„ ACK æ¶ˆæ¯å»¶è¿Ÿä¸èƒ½è¶…è¿‡ T ç§’è¿™ä¸ªæ¡ä»¶ï¼Œæ­¤æ—¶çš„ä¸»åº“åº”è¯¥æ˜¯ä¼šæ‹’ç»å®¢æˆ·ç«¯çš„å†™å…¥è¯·æ±‚çš„å‘€ğŸ¤”","likes_number":1,"is_delete":false,"is_hidden":false,"ctime":1608227339,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":334211,"ip_address":""},"score":335593,"extra":""},{"author":{"id":1204168,"avatar":"https://static001.geekbang.org/account/avatar/00/12/5f/c8/13aa8aa9.jpg","nickname":"night","note":"","ucode":"03B3C955092C03","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":2348024,"avatar":"","nickname":"Geek_c3bf02","note":"","ucode":"97C6848DFCA2A0","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":350074,"discussion_content":"ä¸€ä¸ªéå¸¸å®é™…çš„ä¾‹å­ï¼šä¸€ä¸ªé›†ç¾¤ä¸­çš„å¤šä¸ªredis èŠ‚ç‚¹åœ¨ä¸åŒæœºæˆ¿ï¼Œæœºæˆ¿é—´ä¸“çº¿æ–­äº†","likes_number":4,"is_delete":false,"is_hidden":false,"ctime":1613699889,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":334211,"ip_address":""},"score":350074,"extra":""},{"author":{"id":2049478,"avatar":"https://static001.geekbang.org/account/avatar/00/1f/45/c6/ba5176a6.jpg","nickname":"ä»ä¸å–èŒ","note":"","ucode":"E9B7B1C8FAFE0B","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":2348024,"avatar":"","nickname":"Geek_c3bf02","note":"","ucode":"97C6848DFCA2A0","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":353036,"discussion_content":"æˆ‘ç†è§£æ˜¯ï¼Œä¸åŒçš„ç½‘ç»œåˆ†åŒºï¼Œå¯èƒ½ä¼šæœ‰å»¶è¿Ÿå¯¼è‡´çš„å“¨å…µè¯¯ä»¥ä¸ºåŸä¸»åº“æŒ‚äº†ã€‚æ¯”å¦‚Aåˆ†åŒºçš„ä¸»åº“å› ä¸ºç½‘ç»œå»¶è¿Ÿï¼Œè¢«åŠæ•°ä»¥ä¸Šå“¨å…µåˆ¤å®šä¸ºæŒ‚äº†ï¼Œé‚£å°±ä¼šé‡æ–°è¿›è¡Œé€‰ä¸»ï¼Œé€‰ä¸»å®Œæˆï¼Œåˆ™Båˆ†åŒºçš„ä»åº“æå‡ä¸ºä¸»åº“ï¼Œè¿™æ—¶å€™åŸä¸»åº“å»¶è¿Ÿå¥½äº†ï¼Œæ­¤æ—¶ä¼šäº§ç”Ÿè„‘è£‚ã€‚å…¶æœ¬è´¨å°±æ˜¯åŸä¸»åº“çš„å‡æ­»ï¼Œé€ æˆäº†å“¨å…µé‡æ–°é€‰ä¸»ã€‚æ„Ÿè§‰è·Ÿå°è¯´ä¸€æ ·..","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1614956812,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":334211,"ip_address":""},"score":353036,"extra":""}]},{"author":{"id":1229254,"avatar":"https://static001.geekbang.org/account/avatar/00/12/c1/c6/1456274a.jpg","nickname":"éº¦å‘†å°çŸ³å¤´","note":"","ucode":"1F21C9FBE2057C","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":331936,"discussion_content":"å“¨å…µæœºåˆ¶ä¸å°±æ˜¯raft ä¹ˆï¼Ÿ","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1607008108,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":2,"child_discussions":[{"author":{"id":1020042,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/90/8a/288f9f94.jpg","nickname":"Kaito","note":"","ucode":"79775FA35A95F2","race_medal":0,"user_type":1,"is_pvip":true},"reply_author":{"id":1229254,"avatar":"https://static001.geekbang.org/account/avatar/00/12/c1/c6/1456274a.jpg","nickname":"éº¦å‘†å°çŸ³å¤´","note":"","ucode":"1F21C9FBE2057C","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":331948,"discussion_content":"ä¸»ä»æ˜¯ä¸»ä»ï¼Œå“¨å…µæ˜¯å“¨å…µã€‚ä¸»ä»ä¸æ˜¯å¼ºä¸€è‡´çš„ã€‚","likes_number":1,"is_delete":false,"is_hidden":false,"ctime":1607009906,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":331936,"ip_address":""},"score":331948,"extra":""},{"author":{"id":1513825,"avatar":"https://static001.geekbang.org/account/avatar/00/17/19/61/119cbde2.jpg","nickname":"Dolly","note":"","ucode":"CC74978F393055","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":1229254,"avatar":"https://static001.geekbang.org/account/avatar/00/12/c1/c6/1456274a.jpg","nickname":"éº¦å‘†å°çŸ³å¤´","note":"","ucode":"1F21C9FBE2057C","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":338603,"discussion_content":"å“¨å…µé‚£ä¸ªraftå¯¹å†™å…¥æ²¡åšä»€ä¹ˆé™åˆ¶ï¼Œæ¢æˆhbaseé‚£ç§æœºåˆ¶æœ‰å¼ºä¸€è‡´æ€§","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1609321462,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":331936,"ip_address":""},"score":338603,"extra":""}]},{"author":{"id":2179830,"avatar":"","nickname":"Geek_f00f74","note":"","ucode":"7A0E89CB0AF499","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":325188,"discussion_content":"redisçš„å“¨å…µæœºåˆ¶ï¼Œä¸æ˜¯è¦æ±‚è¶…è¿‡ä¸€åŠçš„å“¨å…µè®¤ä¸ºä¸»åº“å®•æœºï¼Œæ‰èƒ½è¿›è¡Œä¸»ä»åˆ‡æ¢å˜›ï¼Ÿè¿™ç§å¯ä»¥ä¿è¯ï¼Œç½‘ç»œåˆ†åŒºæ—¶ï¼Œä¸ä¼šå‡ºç°ä¸¤ä¸ªä¸»åº“å‘€","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1605251135,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":3,"child_discussions":[{"author":{"id":1013669,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/77/a5/c5ae871d.jpg","nickname":"zenk","note":"","ucode":"B235D5EBCF49BC","race_medal":0,"user_type":1,"is_pvip":true},"reply_author":{"id":2179830,"avatar":"","nickname":"Geek_f00f74","note":"","ucode":"7A0E89CB0AF499","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":331491,"discussion_content":"æˆ‘ä¹Ÿè¿™ä¹ˆè®¤ä¸º","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1606885385,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":325188,"ip_address":""},"score":331491,"extra":""},{"author":{"id":1239350,"avatar":"https://static001.geekbang.org/account/avatar/00/12/e9/36/f62471c5.jpg","nickname":"ä¸è¯‰ç¦»æ®‡","note":"","ucode":"4F7BB1220ECED7","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":2179830,"avatar":"","nickname":"Geek_f00f74","note":"","ucode":"7A0E89CB0AF499","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":335490,"discussion_content":"åŸä¸»åº“å¡æ­»çš„æ—¶å€™ è¶…è¿‡åŠæ•°çš„å“¨å…µä¼šè®¤ä¸ºä¸»åº“å¡æ­»ï¼Œç„¶åå¼€å§‹åˆ‡æ¢æ“ä½œã€‚ä½†æ˜¯åœ¨åˆ‡æ¢å®Œæˆçš„æœŸé—´ï¼Œ å¦‚æœåŸä¸»åº“æ¢å¤ï¼Œå¹¶ä¸”æŸä¸ªå®¢æˆ·ç«¯ä¹Ÿèƒ½ç»§ç»­å‘åŸä¸»åº“å†™æ•°æ®ï¼Œè¿™ç§æƒ…å†µå°±ä¼šå‡ºç°ä¸¤ä¸ªä¸»åº“ã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1608204580,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":325188,"ip_address":""},"score":335490,"extra":""},{"author":{"id":1253597,"avatar":"https://static001.geekbang.org/account/avatar/00/13/20/dd/82d8eff2.jpg","nickname":"Mine","note":"","ucode":"85C3A3117FD9CB","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":2179830,"avatar":"","nickname":"Geek_f00f74","note":"","ucode":"7A0E89CB0AF499","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":335592,"discussion_content":"å“¨å…µå’Œä¸»åº“å·²ç»å¤„åœ¨ä¸¤ä¸ªä¸åŒçš„ç½‘ç»œåˆ†åŒºä¸­ï¼Œå“¨å…µé›†ç¾¤è‡ªç„¶èƒ½å¦å»ä¸»åº“è¿›è¡Œè¿æ¥äº†å‘€ï¼Œæ­¤æ—¶ä¸»åº“è¢«åˆ¤æ–­ä¸ºå®¢è§‚ä¸‹çº¿ï¼Œè§¦å‘ä¸»ä»åˆ‡æ¢ã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1608227127,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":325188,"ip_address":""},"score":335592,"extra":""}]},{"author":{"id":1140276,"avatar":"https://static001.geekbang.org/account/avatar/00/11/66/34/0508d9e4.jpg","nickname":"u","note":"","ucode":"88FA7BA089807C","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":321322,"discussion_content":"ç¬¬12sæ—§ä¸»åº“æ¢å¤ï¼Œç¬¬15sä¸»ä»åˆ‡æ¢å®Œæˆï¼Œåº”è¯¥æ˜¯ä¸ä¼šåŒæ—¶å­˜åœ¨ä¸¤ä¸ªä¸»åº“çš„","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1604564543,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":2,"child_discussions":[{"author":{"id":2268992,"avatar":"","nickname":"å©·","note":"","ucode":"8D60459FEFD44B","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":1140276,"avatar":"https://static001.geekbang.org/account/avatar/00/11/66/34/0508d9e4.jpg","nickname":"u","note":"","ucode":"88FA7BA089807C","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":322896,"discussion_content":"ä½†æ˜¯åŸä¸»åº“åœ¨12s-15sä¹‹é—´å¯èƒ½æ¥å—äº†å†™å‘½ä»¤ï¼Œè¿™äº›æ•°æ®å¯èƒ½ä¸¢å¤±ã€‚","likes_number":5,"is_delete":false,"is_hidden":false,"ctime":1604839593,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":321322,"ip_address":""},"score":322896,"extra":""},{"author":{"id":1227107,"avatar":"https://static001.geekbang.org/account/avatar/00/12/b9/63/a3b11794.jpg","nickname":"éº¦æŠ ","note":"","ucode":"875DEA26F38BAB","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":2268992,"avatar":"","nickname":"å©·","note":"","ucode":"8D60459FEFD44B","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":546809,"discussion_content":"é—®é¢˜æ—¶12sæ—¶å“¨å…µå·²ç»å¼€å§‹äº†ä¸»ä»åˆ‡æ¢ï¼Œè¿™æ—¶å€™åŸä¸»åº“å¦‚æœçŸ¥é“å·²ç»å¼€å§‹äº†åˆ‡æ¢ï¼Œæ˜¯å¦å°±ä¸ä¼šç»§ç»­æ¥æ”¶æ–°è¯·æ±‚ï¼Ÿ","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1642429464,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":322896,"ip_address":""},"score":546809,"extra":""}]}]},{"had_liked":false,"id":267041,"user_name":"å°æ–‡åŒå­¦","can_delete":false,"product_type":"c1","uid":1001893,"ip_address":"","ucode":"48F2AEB989C12A","user_header":"https://static001.geekbang.org/account/avatar/00/0f/49/a5/e4c1c2d4.jpg","comment_is_top":false,"comment_ctime":1607579886,"is_pvip":false,"replies":[{"id":"98130","content":"ç»“åˆCAPè¿›è¡Œåˆ†æï¼Œèµï¼<br><br>Redisæœ¬èº«ä¸æ”¯æŒå¼ºä¸€è‡´æ€§ï¼Œå› ä¸ºä¿è¯å¼ºä¸€è‡´æ€§çš„ä»£ä»·å¤ªå¤§ï¼Œä»CAPè§’åº¦çœ‹ï¼Œå°±æ˜¯æ”¾å¼ƒCï¼Œé€‰æ‹©Aå’ŒPã€‚<br><br>min-slaves-to-write å’Œ min-slaves-max-lagçš„è®¾ç½®ï¼Œæ˜¯ä¸ºäº†é¿å…ä¸»ä»æ•°æ®ä¸ä¸€è‡´ç¨‹åº¦åŠ é‡ã€‚ä¸¤ä¸ªå‚æ•°èµ·ä½œç”¨æ—¶ï¼Œç›¸å½“äºå¯¹ä¸»åº“åšé™çº§ï¼Œæ”¾å¼ƒäº†Aï¼Œé€‰æ‹©Cå’ŒPã€‚<br><br>","user_name":"ä½œè€…å›å¤","user_name_real":"è’‹å¾·é’§","uid":"1609687","ctime":1609172132,"ip_address":"","comment_id":267041,"utype":1}],"discussion_count":1,"race_medal":0,"score":"276485486830","product_id":100056701,"comment_content":"ç©¿æ’ä½¿ç”¨ CAP ç†è®ºæ¥åˆ†æä¸€ä¸‹è¯¾ç¨‹çš„å†…å®¹ï¼š<br>1. redis é›†ç¾¤å…è®¸è„‘è£‚å­˜åœ¨ï¼Œå…¶å®æ˜¯ä¸€ç§å¯ç”¨æ€§é«˜çš„ç‰¹å¾ï¼Œä½†ä¸ä¿è¯æ•°æ®ä¸€ç›´ã€‚<br>2. redis é€šè¿‡è®¾ç½®ä¸¤ä¸ªå‚æ•°ï¼Œä¸€å®šç¨‹åº¦ä¸Šå…¶å®æ˜¯åœ¨é™ä½å¯ç”¨æ€§ï¼Œä»¥æä¾›æ•°æ®ä¸€è‡´æ€§ã€‚<br>3. ä¸ºä»€ä¹ˆæ„¿æ„é™ä½å¯ç”¨æ€§ï¼Ÿå› ä¸ºé‚£éƒ¨åˆ†çš„æ•°æ®ä¼šå› ä¸ºä¸»ä»åˆ‡æ¢è€Œä¸¢å¤±ï¼Œæ‰€ä»¥å®æ„¿ä¸å¯ç”¨ã€‚","like_count":65,"discussions":[{"author":{"id":1609687,"avatar":"https://static001.geekbang.org/account/avatar/00/18/8f/d7/fb60129d.jpg","nickname":"è’‹å¾·é’§","note":"","ucode":"833985C2C37C0A","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":511492,"discussion_content":"ç»“åˆCAPè¿›è¡Œåˆ†æï¼Œèµï¼\n\nRedisæœ¬èº«ä¸æ”¯æŒå¼ºä¸€è‡´æ€§ï¼Œå› ä¸ºä¿è¯å¼ºä¸€è‡´æ€§çš„ä»£ä»·å¤ªå¤§ï¼Œä»CAPè§’åº¦çœ‹ï¼Œå°±æ˜¯æ”¾å¼ƒCï¼Œé€‰æ‹©Aå’ŒPã€‚\n\nmin-slaves-to-write å’Œ min-slaves-max-lagçš„è®¾ç½®ï¼Œæ˜¯ä¸ºäº†é¿å…ä¸»ä»æ•°æ®ä¸ä¸€è‡´ç¨‹åº¦åŠ é‡ã€‚ä¸¤ä¸ªå‚æ•°èµ·ä½œç”¨æ—¶ï¼Œç›¸å½“äºå¯¹ä¸»åº“åšé™çº§ï¼Œæ”¾å¼ƒäº†Aï¼Œé€‰æ‹©Cå’ŒPã€‚\n\n","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1609172132,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":258448,"user_name":"test","can_delete":false,"product_type":"c1","uid":1065849,"ip_address":"","ucode":"9A4973E591DD12","user_header":"https://static001.geekbang.org/account/avatar/00/10/43/79/18073134.jpg","comment_is_top":false,"comment_ctime":1604451025,"is_pvip":false,"discussion_count":1,"race_medal":0,"score":"57439025873","product_id":100056701,"comment_content":"è¯¾åé—®é¢˜ï¼šä»ç„¶å¯èƒ½ä¼šå‘ç”Ÿæ•°æ®ä¸¢å¤±ã€‚ç©¶å…¶åŸå› æ˜¯rediså†…éƒ¨æ²¡æœ‰å…±è¯†ç®—æ³•ä¿è¯æ•°æ®åŒæ­¥ï¼Œå†™æ•°æ®çš„æ—¶å€™åªæ˜¯å†™å…¥ä¸»åº“å³å¯è¿”å›æˆåŠŸï¼Œæ•°æ®åŒæ­¥åˆ°ä»åº“æ˜¯é€šè¿‡å¼‚æ­¥å¤„ç†çš„ã€‚","like_count":13,"discussions":[{"author":{"id":1513825,"avatar":"https://static001.geekbang.org/account/avatar/00/17/19/61/119cbde2.jpg","nickname":"Dolly","note":"","ucode":"CC74978F393055","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":338591,"discussion_content":"ç¡®å®ï¼Œæ²¡æœ‰å…±è¯†ç®—æ³•çš„ç»„ç¾¤æ¨¡å¼ï¼Œæ€ä¹ˆæéƒ½æœ‰ä¸€è‡´æ€§é—®é¢˜ã€‚ã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1609319570,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":258481,"user_name":"æäºŒæœ¨","can_delete":false,"product_type":"c1","uid":1103091,"ip_address":"","ucode":"30E03BB84ADB27","user_header":"https://static001.geekbang.org/account/avatar/00/10/d4/f3/129d6dfe.jpg","comment_is_top":false,"comment_ctime":1604457060,"is_pvip":true,"discussion_count":0,"race_medal":0,"score":"44554130020","product_id":100056701,"comment_content":"æœ€æ¬£èµçš„æ˜¯æ’æŸ¥åˆ†æé—®é¢˜çš„è¿‡ç¨‹ã€‚","like_count":11},{"had_liked":false,"id":258491,"user_name":"snailshen","can_delete":false,"product_type":"c1","uid":1436839,"ip_address":"","ucode":"C4875C476649B1","user_header":"https://static001.geekbang.org/account/avatar/00/15/ec/a7/7d44c655.jpg","comment_is_top":false,"comment_ctime":1604460448,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"23079296928","product_id":100056701,"comment_content":"è€å¸ˆæ‚¨å¥½ï¼Œé˜²æ­¢è„‘è£‚æˆ‘è®¤ä¸ºæœ‰2ç‚¹éœ€è¦æ³¨æ„ï¼š<br>1å¯ä»¥è€ƒè™‘æŠŠå¤šä¸ªsentinelèŠ‚ç‚¹éƒ¨ç½²åˆ°ä¸åŒçš„æœºæˆ¿ï¼Œå‡å°‘ç”±äºç½‘ç»œåŸå› å¯¼è‡´çš„è¯¯åˆ¤ã€‚<br>2.redis masterä¸»èŠ‚ç‚¹ä¸»æœºï¼Œé¿å…é«˜è´Ÿè½½ï¼Œéƒ¨ç½²æ—¶ç•™æœ‰ä¸€äº›å†—ä½™<br><br>å…³äºmin-slaves-to-writeï¼Œmin-slaves-max-lagè¿™ä¸¤ä¸ªé…ç½®ï¼Œä¸»è¦æ˜¯è§£å†³ä¸»ä»åŒæ­¥æ•°æ®ä¸€è‡´æ€§é—®é¢˜çš„ï¼Œå°½é‡å‡å°‘ä¸»ä»åŒæ­¥çš„æ•°æ®ä¸ä¸€è‡´ï¼Œæˆ‘è§‰å¾—ä¸èƒ½ä»æ ¹æœ¬ä¸Šé€šè¿‡è¿™ä¸¤ä¸ªå‚æ•°è§£å†³è„‘è£‚ã€‚æ¯”å¦‚masterå’Œslaveçš„ç½‘ç»œå¾ˆå¥½ï¼Œé‚£ä¹ˆè¿™ä¸¤ä¸ªå‚æ•°å¤±æ•ˆï¼Œå¦‚æœè¿™ä¸ªæ—¶å€™3ä¸ªsentinelèŠ‚ç‚¹çš„åˆ°masterçš„ç½‘ç»œéƒ½å¼‚å¸¸å¹¶ä¸”è¿™äº›èŠ‚ç‚¹åˆ°slaveç½‘ç»œè‰¯å¥½ï¼Œé‚£ä¹ˆä¸€æ ·ä¼šè§¦å‘ä¸»ä»åˆ‡æ¢ï¼Œé€ æˆè„‘è£‚ã€‚æˆ‘æ˜¯è¿™æ ·ç†è§£çš„ï¼Œå¸Œæœ›è€å¸ˆæŒ‡æ­£ï¼","like_count":6},{"had_liked":false,"id":269224,"user_name":"æˆ‘å¾ˆè¿ªå¥¥","can_delete":false,"product_type":"c1","uid":2062003,"ip_address":"","ucode":"D5CBE87C1264C1","user_header":"","comment_is_top":false,"comment_ctime":1608561044,"is_pvip":false,"discussion_count":11,"race_medal":0,"score":"14493462932","product_id":100056701,"comment_content":"ä¸å¤ªæ˜ç™½ä¸ºä»€ä¹ˆéœ€è¦å¼•å…¥min-slaves-to-writeï¼Œmin-slaves-max-lagè¿™ä¸¤ä¸ªå‚æ•°æ¥é¿å…è„‘è£‚ï¼Œä¸ºä»€ä¹ˆä¸åœ¨å“¨å…µè®¤ä¸ºä¸»åº“å®¢è§‚ä¸‹çº¿çš„æ—¶å€™ï¼Œå°±ç¦æ­¢ä¸»åº“çš„å†™æ“ä½œã€‚","like_count":4,"discussions":[{"author":{"id":2094925,"avatar":"https://static001.geekbang.org/account/avatar/00/1f/f7/4d/09554c96.jpg","nickname":"iron bo","note":"","ucode":"4BFB1331637AA3","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":371866,"discussion_content":"å“¨å…µè®¤ä¸ºå®¢è§‚ä¸‹çº¿ï¼Œæ­¤æ—¶å“¨å…µå’Œä¸»åº“æ˜¯æ–­è¿äº†ï¼Œæ€ä¹ˆç¦æ­¢ä¸»åº“å†™æ“ä½œå‘¢","likes_number":5,"is_delete":false,"is_hidden":false,"ctime":1620029318,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":2962899,"avatar":"https://static001.geekbang.org/account/avatar/00/2d/35/d3/8de43dd5.jpg","nickname":"Breeze","note":"","ucode":"8B6711F5B9D112","race_medal":0,"user_type":1,"is_pvip":true},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":564551,"discussion_content":"å“¨å…µé€‰ä¸»æˆåŠŸåæ‰é€šçŸ¥å®¢æˆ·ç«¯åˆ‡æ¢ä¸»åº“ï¼Œæ˜¯å› ä¸ºå“¨å…µé€‰ä¸»ä¹Ÿä¸æ˜¯ç™¾åˆ†ä¹‹ç™¾æˆåŠŸï¼Œå¦‚æœé€‰ä¸»å‰é€šçŸ¥ä¸»åº“ä¸‹çº¿ï¼Œé‚£ä¹ˆé€‰ä¸»å¤±è´¥çš„è¯ï¼Œå¯èƒ½ä¼šå¯¼è‡´æ•´ä¸ªå­˜å‚¨æ— æ³•å†™å…¥ã€‚","likes_number":1,"is_delete":false,"is_hidden":false,"ctime":1650276949,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1297635,"avatar":"http://thirdwx.qlogo.cn/mmopen/vi_32/DYAIOgq83eo7R9LibMTe6CF9sVIcZUee5xCVEAxiava7CUb37V3ic6eFYuWBgFelDqeA0wekG2ibA3HFic94PYJHWlA/132","nickname":"å±±é‡Œå°é¾™","note":"","ucode":"4ADA02F1ED59EA","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":406263,"discussion_content":"ä¸»éƒ½æ— æ³•å“åº”ACKäº†ï¼Œå®ƒè¿˜æ€ä¹ˆå“åº”ä½ çš„ç¦æ­¢ä¸»å†™æ“ä½œè¯·æ±‚å‘¢?","likes_number":1,"is_delete":false,"is_hidden":false,"ctime":1634733202,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":1,"child_discussions":[{"author":{"id":1519415,"avatar":"http://thirdwx.qlogo.cn/mmopen/vi_32/dr34H3hOMVsibL0XV1iaBWFiaTnYssX8sNjmJDpiaBUVv2X39nFzDjNpe288cKkZfH3P9sVRxZ1lzYZEcRR3vJNYtA/132","nickname":"Benson_Geek","note":"","ucode":"D95B5C2BA09961","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":1297635,"avatar":"http://thirdwx.qlogo.cn/mmopen/vi_32/DYAIOgq83eo7R9LibMTe6CF9sVIcZUee5xCVEAxiava7CUb37V3ic6eFYuWBgFelDqeA0wekG2ibA3HFic94PYJHWlA/132","nickname":"å±±é‡Œå°é¾™","note":"","ucode":"4ADA02F1ED59EA","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":415128,"discussion_content":"é€šçŸ¥å®¢æˆ·ç«¯æ—§ä¸»åº“ä¸‹çº¿ä¸å°±è¡Œäº†ï¼Ÿè¿™æ ·å®¢æˆ·ç«¯ç›´æ¥å°±ä¸å‘æ—§çš„å†™æ•°æ®","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1636991151,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":406263,"ip_address":""},"score":415128,"extra":""}]},{"author":{"id":1811277,"avatar":"https://static001.geekbang.org/account/avatar/00/1b/a3/4d/59390ba9.jpg","nickname":"æ’éª¨","note":"","ucode":"A413CF46211E1F","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":587162,"discussion_content":"å¯ç”¨æ€§å°±é™ä½äº†å§","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1662861280,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":"å¹¿ä¸œ"},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":2166073,"avatar":"https://thirdwx.qlogo.cn/mmopen/vi_32/k3YD3y3BzGDSdrwRJyJY4BXsNJibfM4uzOdDVKIAlFApR2FZCLg2ibrZtJ4vuahA3LHLW9GKzH5CMGqCDhWjhZqg/132","nickname":"æˆ’é…’çš„æç™½","note":"","ucode":"744E1A22761647","race_medal":0,"user_type":1,"is_pvip":true},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":531966,"discussion_content":"æˆ‘è§‰å¾—ä¹Ÿæ˜¯ä¸ºäº†å°½é‡ä¿è¯æ›´å¤§çš„å¯ç”¨æ€§ã€‚å› ä¸ºå“¨å…µåˆ¤æ–­å‡ºä¸»åº“æ–­è”å¼€å§‹é€‰ä¸»æ“ä½œï¼Œå¦‚æœåœ¨é€‰ä¸»å®Œæˆä¹‹å‰å°±ç¦æ­¢åŸä¸»åº“å†™å…¥ï¼Œå°±ä¼šä¸¢å¤±æ‰åˆ‡ä¸»åº“è¿™æ®µæ—¶é—´çš„ç³»ç»Ÿå¯ç”¨æ€§ã€‚åä¹‹å¦‚æœå†åˆ‡æ¢æˆåŠŸåå†é€šçŸ¥å®¢æˆ·ç«¯å†™å…¥æ–°çš„ä¸»åº“ï¼Œå¯¹å¯ç”¨æ€§å½±å“ä¼šå°ä¸€äº›ã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1637484297,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"user_type\":1}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1389314,"avatar":"https://static001.geekbang.org/account/avatar/00/15/33/02/83f47bf9.jpg","nickname":"æµæ²™","note":"","ucode":"6153686D1C34B7","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":385362,"discussion_content":"æ„Ÿè§‰æ˜¯åœ¨ä¸€è‡´æ€§å’Œå¯ç”¨æ€§ä¹‹é—´æƒè¡¡å§","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1627014241,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":2028941,"avatar":"","nickname":"Geek1254","note":"","ucode":"BC2F7756A0676D","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":379888,"discussion_content":"æˆ–è€…åœ¨å“¨å…µè®¤ä¸ºä¸»åº“å®¢è§‚ä¸‹çº¿åï¼Œé€šçŸ¥åˆ°å®¢æˆ·ç«¯ä¸»åº“ä¸‹çº¿","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1624205008,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1113737,"avatar":"http://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTI2icbib62icXtibTkThtyRksbuJLoTLMts7zook2S30MiaBtbz0f5JskwYicwqXkhpYfvCpuYkcvPTibEaQ/132","nickname":"xuanyuan","note":"","ucode":"1EC79B9372868F","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":374827,"discussion_content":"å¯ä»¥é€šçŸ¥å®¢æˆ·ç«¯ä¸è¦å†™ä¸»åº“","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1621384472,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1738455,"avatar":"https://static001.geekbang.org/account/avatar/00/1a/86/d7/bfd9e42a.jpg","nickname":"è½¨è¿¹","note":"","ucode":"6C9619A0B60CDD","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":360533,"discussion_content":"åŒé—®","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1616469905,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1254423,"avatar":"https://static001.geekbang.org/account/avatar/00/13/24/17/a8db1ff7.jpg","nickname":"æå›¢ç»“","note":"","ucode":"23831A96515E2C","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":357361,"discussion_content":"åŒé—®","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1615794034,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":258560,"user_name":"ä¸å›å…±å‹‰","can_delete":false,"product_type":"c1","uid":1763046,"ip_address":"","ucode":"1FB5EBFCF510A1","user_header":"","comment_is_top":false,"comment_ctime":1604483089,"is_pvip":false,"discussion_count":1,"race_medal":0,"score":"14489384977","product_id":100056701,"comment_content":"min-slaves-max-lagæ˜¯ä¸æ˜¯ä¸€èˆ¬è¦è®¾ç½®æˆæ¯”down-after-millisecondså°çš„å€¼æœ€å¥½ï¼Ÿ","like_count":3,"discussions":[{"author":{"id":2027435,"avatar":"https://static001.geekbang.org/account/avatar/00/1e/ef/ab/ea3488c8.jpg","nickname":"Bijiasuo","note":"","ucode":"6DB63A899D184C","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":543677,"discussion_content":"æ˜¯","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1641266592,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":286471,"user_name":"escray","can_delete":false,"product_type":"c1","uid":1020525,"ip_address":"","ucode":"1F4204930E47C4","user_header":"https://static001.geekbang.org/account/avatar/00/0f/92/6d/becd841a.jpg","comment_is_top":false,"comment_ctime":1617333516,"is_pvip":true,"discussion_count":0,"race_medal":2,"score":"10207268108","product_id":100056701,"comment_content":"å…¶å®æˆ‘ä¸å¤ªå…³å¿ƒè„‘è£‚ï¼Œä½†æ˜¯æˆ‘å¯¹äºå‘ç°æ•°æ®ä¸¢å¤±ä¹‹åçš„æ•…éšœæ’æŸ¥æ€è·¯æ¯”è¾ƒæ„Ÿå…´è¶£ã€‚<br><br>1. ç¡®è®¤æ•°æ®åŒæ­¥æ˜¯å¦æœ‰é—®é¢˜ï¼Œæ£€æŸ¥ä¸»ä»åº“å¤åˆ¶è¿›åº¦å·®å€¼ï¼ˆmaster_repl_offset å’Œ slave_repl_offsetï¼‰<br>2. æ’æŸ¥å®¢æˆ·ç«¯æ—¥å¿—ï¼Œå‘ç°è„‘è£‚<br>3. å‘ç°åŸä¸»åº“å‡æ•…éšœå¯¼è‡´è„‘è£‚<br><br>åˆ©ç”¨ min-slaves-to-write å’Œ min-slaves-max-lag ä¸¤ä¸ªé…ç½®é¡¹æ­é…ä½¿ç”¨ï¼Œå¯ä»¥é¿å…è„‘è£‚ã€‚å‚è€ƒæ–‡ä¸­çš„ä¾‹å­ï¼Œmin-slaves-to-write è®¾ç½®ä¸º 1ï¼Œå°±æ˜¯è¯´åªè¦æœ‰ä¸€ä¸ªä»åº“æ— æ³•åœ¨ min-slaves-max-lag çš„æ—¶é—´å†…å‘é€ä»£è¡¨ä¸»ä»å¤åˆ¶å®Œæˆçš„ ACK æ¶ˆæ¯ï¼ŒåŸä¸»åº“å°±ä¸èƒ½å†æ¥æ”¶å®¢æˆ·ç«¯è¯·æ±‚äº†ã€‚<br><br>å‡è®¾ä»åº“æœ‰ K ä¸ªï¼Œé‚£ä¹ˆ min-slaves-to-write å°±è®¾ç½®ä¸º K&#47;2+1ï¼Œå…¶å®è¶…è¿‡åŠæ•°çš„ä»åº“ï¼Œå†ç»“åˆå“¨å…µæœºåˆ¶çš„ quorumï¼Œå°±å¯ä»¥é¿å…è„‘è£‚ã€‚<br><br>å¯¹äºè¯¾åé¢˜ï¼ŒæŒ‰ç…§é¢˜ç›®çš„æ¡ä»¶ï¼Œmin-slaves-to-write è®¾ä¸º 1ï¼Œmin-slaves-max-lag è®¾ä¸º 15sï¼Œå“¨å…µ down-after-milliseconds è®¾ç½®ä¸º 10sï¼Œå“¨å…µä¸»ä»åˆ‡æ¢ 5sï¼Œä¸»åº“å¡ä½ 12sï¼Œæˆ‘è§‰çš„å¯èƒ½ä¸ä¼šå‘ç”Ÿè„‘è£‚ã€‚<br><br>ä¸»åº“å¡ä½ 12sï¼Œå“¨å…µå·²ç»åˆ¤å®šåŸä¸»åº“ä¸‹çº¿äº†ï¼Œè€Œå› ä¸º min-slave-to-write å’Œ min-slaves-max-lag çš„è®¾ç½®ï¼Œåªæœ‰è¶…è¿‡ 15sï¼Œæ‰ä¼šæ‹’ç»åŸä¸»åº“æ¥å—å®¢æˆ·ç«¯è¯·æ±‚ï¼Œä¹Ÿå°±æ˜¯è¯´ä»ç¬¬ 12s åˆ° 15s ä¹‹é—´ï¼ŒåŸä¸»åº“å¯ä»¥æ¥å—å®¢æˆ·ç«¯è¯·æ±‚ï¼Œè€Œ 15s åï¼Œä¸»ä»åˆ‡æ¢å®Œæˆï¼Œæ–°ä¸»åº“å¼€å§‹æ¥æ”¶å®¢æˆ·ç«¯è¯·æ±‚ï¼Œè€ŒåŸä¸»åº“åœ¨ 12s åæ¥æ”¶çš„è¯·æ±‚å¯ä»¥åŒæ­¥åˆ°æ–°ä¸»åº“ã€‚<br><br>çœ‹äº†è¯¾ä»£è¡¨çš„ç­”æ¡ˆï¼Œå…¶å®æˆ‘ä¹Ÿçº ç»“ï¼ŒåŸä¸»åº“ä» 12s åˆ° 15s æ¥æ”¶åˆ°çš„è¯·æ±‚èƒ½å¦åŒæ­¥åˆ°æ–°ä¸»åº“ã€‚<br><br>è¯¾ä»£è¡¨å¯¹äºåªæœ‰ä¸€ä¸ªä»åº“ï¼Œä¸”è®¾ç½®äº† min-slave-to-write ä¸º 1 çš„æ—¶å€™ï¼Œè¿ç»´æ“ä½œæ³¨æ„äº‹é¡¹çš„æé†’å¾ˆæœ‰ä»·å€¼ã€‚","like_count":3},{"had_liked":false,"id":279362,"user_name":"Geek_3d51a3","can_delete":false,"product_type":"c1","uid":2306090,"ip_address":"","ucode":"4BEFF3CA6CCE50","user_header":"","comment_is_top":false,"comment_ctime":1613730810,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"10203665402","product_id":100056701,"comment_content":"redisæ‰§è¡Œslave ofä¹‹åï¼Œå°±å˜æˆäº†åªè¯»å®ä¾‹ï¼Œå†™å…¥ä¼šæŠ¥é”™","like_count":2},{"had_liked":false,"id":258868,"user_name":"Geek_d1eece","can_delete":false,"product_type":"c1","uid":1728504,"ip_address":"","ucode":"BEFAA7A93E6653","user_header":"","comment_is_top":false,"comment_ctime":1604570858,"is_pvip":false,"replies":[{"id":"94190","content":"PPTå“ˆï½","user_name":"ç¼–è¾‘å›å¤","user_name_real":"å­Ÿæœé˜³","uid":"1576654","ctime":1604574273,"ip_address":"","comment_id":258868,"utype":2}],"discussion_count":1,"race_medal":0,"score":"10194505450","product_id":100056701,"comment_content":"è€å¸ˆç”¨çš„ç”»å›¾å·¥å…·å«ä»€ä¹ˆï¼Ÿ","like_count":2,"discussions":[{"author":{"id":1576654,"avatar":"https://static001.geekbang.org/account/avatar/00/18/0e/ce/9c96fa35.jpg","nickname":"å®¢è¡Œ","note":"","ucode":"FF508FF1346F1A","race_medal":0,"user_type":4,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":508773,"discussion_content":"PPTå“ˆï½","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1604574273,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":4}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":258775,"user_name":"å¶å­ã€‚","can_delete":false,"product_type":"c1","uid":1393004,"ip_address":"","ucode":"3EF2CC36F0D09A","user_header":"https://static001.geekbang.org/account/avatar/00/15/41/6c/687c5dfb.jpg","comment_is_top":false,"comment_ctime":1604553681,"is_pvip":false,"discussion_count":2,"race_medal":0,"score":"10194488273","product_id":100056701,"comment_content":"è€å¸ˆå¯å¦è®²è®² Clusteræ¨¡å¼ä¸‹çš„è„‘è£‚ï¼Ÿ","like_count":2,"discussions":[{"author":{"id":2094925,"avatar":"https://static001.geekbang.org/account/avatar/00/1f/f7/4d/09554c96.jpg","nickname":"iron bo","note":"","ucode":"4BFB1331637AA3","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":371867,"discussion_content":"åˆ‡ç‰‡æ²¡æœ‰è„‘è£‚é—®é¢˜å§ï¼Œæ•°æ®å·²ç»åˆ†ç‰‡äº†ï¼Œä¸ä¼šå»åšæ•°æ®åŒæ­¥ï¼Œè€Œä¸”æœ¬èº«æ¯ä¸ªåˆ†ç‰‡éƒ½å¯ä»¥æ˜¯ä¸»èŠ‚ç‚¹","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1620029434,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":1,"child_discussions":[{"author":{"id":1389314,"avatar":"https://static001.geekbang.org/account/avatar/00/15/33/02/83f47bf9.jpg","nickname":"æµæ²™","note":"","ucode":"6153686D1C34B7","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":2094925,"avatar":"https://static001.geekbang.org/account/avatar/00/1f/f7/4d/09554c96.jpg","nickname":"iron bo","note":"","ucode":"4BFB1331637AA3","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":385364,"discussion_content":"é›†ç¾¤æ¨¡å¼ä¸‹ä¹Ÿè¦æœ‰ä»èŠ‚ç‚¹æ‰èƒ½ä¿è¯é«˜å¯ç”¨å•Šï¼Œæ‰€ä»¥åº”è¯¥ä¹Ÿæœ‰è„‘è£‚é—®é¢˜å§","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1627014391,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":371867,"ip_address":""},"score":385364,"extra":""}]}]},{"had_liked":false,"id":318680,"user_name":"ä¿¡å¿µ","can_delete":false,"product_type":"c1","uid":1133919,"ip_address":"","ucode":"A2F35A4CDD937E","user_header":"https://static001.geekbang.org/account/avatar/00/11/4d/5f/835a9d46.jpg","comment_is_top":false,"comment_ctime":1635389718,"is_pvip":false,"discussion_count":1,"race_medal":0,"score":"5930357014","product_id":100056701,"comment_content":"Min-slave-max-lagå’Œdown-after-millisecondsè®¾ç½®æˆä¸€æ ·çš„å€¼æ˜¯ä¸æ˜¯å°±å¯ä»¥äº†ï¼Œåœ¨å‡†å¤‡å¼€å§‹åˆ‡æ¢çš„æ—¶å€™ï¼Œå°±ä¸è®©ä¸»åº“æ¥å—å‘½ä»¤äº†ï¼Œè¿™æ ·åšå¯ä»¥å—ï¼Ÿ","like_count":1,"discussions":[{"author":{"id":1159645,"avatar":"https://static001.geekbang.org/account/avatar/00/11/b1/dd/c814190f.jpg","nickname":"å·´å­å°","note":"","ucode":"1C3D35AEC235BB","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":560615,"discussion_content":"ä»¥ä¸‹æƒ…å†µè¿˜æ˜¯æ— æ³•é¿å…ï¼šæ—§ä¸»èŠ‚ç‚¹å’Œä»èŠ‚ç‚¹çš„é€šä¿¡æ¢å¤ï¼Œä½†ä¸»ä»åˆ‡æ¢è¿˜æœªå®Œæˆï¼Œæ—§ä¸»èŠ‚ç‚¹åˆä¼šå¼€å§‹æ¥å—å†™å‘½ä»¤ï¼Œä¸»ä»åˆ‡æ¢å®Œæˆï¼Œæ—§ä¸»èŠ‚ç‚¹æˆä¸ºä»èŠ‚ç‚¹åï¼Œä¸»ä»æœŸé—´äº§ç”Ÿçš„æ•°æ®ä¸¢å¤±ã€‚\nä¸ªäººè®¤ä¸ºï¼Œåªæœ‰æ—§materæ¢å¤æ—¶ï¼Œä¸»ä»åˆ‡æ¢å®Œæˆäº†ï¼Œæ•°æ®æ‰ä¸ä¼šä¸¢å¤±","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1649404709,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":282610,"user_name":"å¤©ç©º","can_delete":false,"product_type":"c1","uid":1038338,"ip_address":"","ucode":"96C04E8D3C32B7","user_header":"https://static001.geekbang.org/account/avatar/00/0f/d8/02/c749e2c7.jpg","comment_is_top":false,"comment_ctime":1615339580,"is_pvip":false,"discussion_count":2,"race_medal":0,"score":"5910306876","product_id":100056701,"comment_content":"å¾ˆå¥‡æ€ªå•Šï¼Œä¸ºä»€ä¹ˆå·²ç»å‘ç”Ÿäº†åˆ‡æ¢ï¼ŒåŸä¸»åº“è¿˜æä¾›æœåŠ¡","like_count":1,"discussions":[{"author":{"id":1386315,"avatar":"https://static001.geekbang.org/account/avatar/00/15/27/4b/e49c82d0.jpg","nickname":"Rover","note":"","ucode":"7575EC91F45B99","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":378341,"discussion_content":"åŒé—®ã€‚å“¨å…µæ¨¡å¼ä¸‹å®¢æˆ·ç«¯è¿æ¥çš„ä¸æ˜¯å“¨å…µèŠ‚ç‚¹ä¿¡æ¯å˜›ï¼Œæ—¢ç„¶å‘ç”Ÿäº†åˆ‡æ¢ï¼Œé‚£ä¹ˆé€šè¿‡å“¨å…µèŠ‚ç‚¹è·å¾—çš„ä¸»åº“åº”è¯¥æ˜¯åˆ‡æ¢åçš„ï¼Œä¸ºä½•å®¢æˆ·ç«¯è¿˜ä¼šå†™åˆ°åŸä¸»åº“ï¼Ÿ\nå“ªä½è€å“¥è§£é‡Šä¸‹","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1623166233,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":1,"child_discussions":[{"author":{"id":1357315,"avatar":"https://thirdwx.qlogo.cn/mmopen/vi_32/DYAIOgq83eoVRER40LhyAhBK6YgPYibRzWARkc3efUquib4j9BPru4y8FfvXK2sBPbXej9314pZdfdcxb07RcjZw/132","nickname":"é…·é…·çš„åµ©","note":"","ucode":"EF249E96F42491","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":1386315,"avatar":"https://static001.geekbang.org/account/avatar/00/15/27/4b/e49c82d0.jpg","nickname":"Rover","note":"","ucode":"7575EC91F45B99","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":390630,"discussion_content":"å®Œæˆåˆ‡æ¢åï¼Œæ‰ä¼šé€šçŸ¥å®¢æˆ·ç«¯åˆ‡ä¸»åº“ã€‚åœ¨åˆ‡æ¢æœŸé—´ï¼ŒåŸä¸»åº“å‡æ­»ï¼Œè¿æ¥çš„ä¸ŠåŸä¸»åº“çš„å®¢æˆ·ç«¯æ­£å¸¸å†™å…¥ï¼Œä½†æ˜¯è¿™éƒ¨åˆ†æ•°æ®å†å®Œæˆåˆ‡æ¢åä¸¢å¤±ã€‚","likes_number":1,"is_delete":false,"is_hidden":false,"ctime":1629946073,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":378341,"ip_address":""},"score":390630,"extra":""}]}]},{"had_liked":false,"id":267726,"user_name":"å°è¢","can_delete":false,"product_type":"c1","uid":1811495,"ip_address":"","ucode":"3F5D8721F577D9","user_header":"https://static001.geekbang.org/account/avatar/00/1b/a4/27/15e75982.jpg","comment_is_top":false,"comment_ctime":1607907030,"is_pvip":false,"discussion_count":1,"race_medal":0,"score":"5902874326","product_id":100056701,"comment_content":"å¦‚æœè¿™ä¹ˆå®¹æ˜“å¼•èµ·è„‘è£‚ï¼ˆä»…ä»…æ˜¯å‚æ•°é…ç½®ä¸åˆç†ï¼‰ï¼Œredisæœ‰åšä¸€äº›åŸºç¡€çš„æ£€æŸ¥æ£€æµ‹è¿™äº›é—®é¢˜ä¹ˆï¼Ÿè¦å»ç¿»å®¢æˆ·ç«¯æ—¥å¿—å†ç»“åˆåŸç†å‘ç°é—®é¢˜ï¼Œè¿™æœ¬èº«å°±ä¸å¤Ÿå‹å¥½äº†","like_count":1,"discussions":[{"author":{"id":1317999,"avatar":"https://static001.geekbang.org/account/avatar/00/14/1c/6f/3ea2a599.jpg","nickname":"å˜‰æœ¨","note":"","ucode":"AF4877693782C0","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":404928,"discussion_content":"å“¨å…µé…ç½®å’Œredisé…ç½®æ˜¯åˆ†å¼€çš„","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1634463231,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":321681,"user_name":"Benson_Geek","can_delete":false,"product_type":"c1","uid":1519415,"ip_address":"","ucode":"D95B5C2BA09961","user_header":"http://thirdwx.qlogo.cn/mmopen/vi_32/dr34H3hOMVsibL0XV1iaBWFiaTnYssX8sNjmJDpiaBUVv2X39nFzDjNpe288cKkZfH3P9sVRxZ1lzYZEcRR3vJNYtA/132","comment_is_top":false,"comment_ctime":1636990586,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1636990586","product_id":100056701,"comment_content":"ä¸€è·¯è¢«è¯¯å¯¼è¿‡æ¥ï¼Œè¿˜ä»¥ä¸ºä»æ ‡è®°äº†ä¸»æ˜¯å®¢è§‚ä¸‹çº¿åï¼Œæ—§ä¸»å°±ä¸èƒ½å†æ¥å—æ•°æ®äº†ã€‚ã€‚ã€‚<br>åŸæ¥è¿™æ—¶å€™æ—§ä¸»è¿˜å¯ä»¥æ¥å—æ•°æ®å•Šã€‚ã€‚ã€‚","like_count":0},{"had_liked":false,"id":313774,"user_name":"å¯¹æ–¹æ­£åœ¨è¾“å…¥ã€‚ã€‚ã€‚","can_delete":false,"product_type":"c1","uid":1179298,"ip_address":"","ucode":"7B0DEB4D9B43D2","user_header":"https://static001.geekbang.org/account/avatar/00/11/fe/a2/5252a278.jpg","comment_is_top":false,"comment_ctime":1632661074,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1632661074","product_id":100056701,"comment_content":"zké€‰ä¸¾æ—¶çš„ä»¤ç‰Œï¼Œå°±ä¼šä¿è¯ä¸ä¼šå‘ç”Ÿçˆ†è£‚","like_count":0},{"had_liked":false,"id":310430,"user_name":"tt","can_delete":false,"product_type":"c1","uid":1489957,"ip_address":"","ucode":"7753B79AD5A9AC","user_header":"https://static001.geekbang.org/account/avatar/00/16/bc/25/1c92a90c.jpg","comment_is_top":false,"comment_ctime":1630654142,"is_pvip":false,"discussion_count":1,"race_medal":0,"score":"1630654142","product_id":100056701,"comment_content":"è€å¸ˆæ‚¨å¥½ï¼Œæˆ‘å›å¤´çœ‹çš„æ—¶å€™ï¼Œç»“åˆç¬¬8è¯¾ï¼Œäº§ç”Ÿäº†ä¸€ä¸ªé—®é¢˜ï¼Œåˆ‡æ¢ä¸»åº“å®Œæˆåï¼Œå¦‚æœå®¢æˆ·ç«¯è®¢é˜…äº†å“¨å…µçš„æ–°ä¸»åº“åˆ‡æ¢äº‹ä»¶çš„è¯ï¼Œæ˜¯ä¸æ˜¯å°±ä¸ä¼šå‘ç”Ÿè„‘è£‚äº†ï¼Ÿæˆ–è€…åº”è¯¥æ˜¯ä¸»åº“åˆ‡æ¢æœ‰ä¸€ä¸ªè¿‡ç¨‹ï¼Œè¿™ä¸ªè¿‡ç¨‹å®Œæˆä¹‹å‰ï¼Œè¿˜æ˜¯ä¼šå‘ç”Ÿæ•°æ®çš„ä¸¢å¤±ï¼Ÿ","like_count":0,"discussions":[{"author":{"id":1317999,"avatar":"https://static001.geekbang.org/account/avatar/00/14/1c/6f/3ea2a599.jpg","nickname":"å˜‰æœ¨","note":"","ucode":"AF4877693782C0","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":404931,"discussion_content":"down-after-millisecondsæ˜¯ä¸»è§‚ä¸‹çº¿åˆ¤å®šæ—¶é—´ï¼Œ\néœ€è¦ç»è¿‡  ä¸»è§‚ä¸‹çº¿åˆ¤å®š->å®¢è§‚ä¸‹çº¿åˆ¤å®š->é€‰ä¸¾è¿™ä¸€æ¬¡çš„å“¨å…µleader->å“¨å…µleaderé€‰å‡ºåˆé€‚çš„slave->å“¨å…µleaderç»™slaveå‘é€slaveof no one->å‘å¸ƒ+switch-masterä¸»ä»åˆ‡æ¢æ¶ˆæ¯ï¼Œ\næ•´ä¸ªæµç¨‹éœ€è¦ä¸€å®šæ—¶é—´ï¼ŒæœŸé—´å¦‚æœåŸä¸»æ¥æ”¶äº†å®¢æˆ·ç«¯çš„å†™å‘½ä»¤ï¼Œä¸”è¿˜æœªåŒæ­¥åˆ°åŸä»ï¼Œå°±ä¼šä¸¢æ•°æ®","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1634463713,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":309729,"user_name":"Heaven","can_delete":false,"product_type":"c1","uid":1694207,"ip_address":"","ucode":"FA33FBCC66C911","user_header":"https://static001.geekbang.org/account/avatar/00/19/d9/ff/b23018a6.jpg","comment_is_top":false,"comment_ctime":1630315018,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1630315018","product_id":100056701,"comment_content":"è¿™æ˜¯å¿…ç„¶çš„,å› ä¸º,å‡è®¾10såå“¨å…µè¾¾æˆäº†å®¢è§‚ä¸‹çº¿,é‚£ä¹ˆä¼šè¿›è¡Œä¸»ä»åˆ‡æ¢çš„æ“ä½œ,ä½†æ˜¯è¿™ä¸ªæ—¶å€™,ä¸»åº“è¿˜æ²¡è¾¾åˆ°min-slaves-max-lagæ—¶é—´,è¿™æ—¶å€™è¿˜æ˜¯å¯ä»¥æ¥å—å®¢æˆ·ç«¯è¯·æ±‚çš„,æ•…å¯èƒ½å¯¼è‡´äº†è„‘è£‚é—®é¢˜","like_count":0},{"had_liked":false,"id":296807,"user_name":"Rover","can_delete":false,"product_type":"c1","uid":1386315,"ip_address":"","ucode":"7575EC91F45B99","user_header":"https://static001.geekbang.org/account/avatar/00/15/27/4b/e49c82d0.jpg","comment_is_top":false,"comment_ctime":1623166246,"is_pvip":false,"discussion_count":1,"race_medal":0,"score":"1623166246","product_id":100056701,"comment_content":"å“¨å…µæ¨¡å¼ä¸‹å®¢æˆ·ç«¯è¿æ¥çš„ä¸æ˜¯å“¨å…µèŠ‚ç‚¹ä¿¡æ¯å˜›ï¼Œæ—¢ç„¶å‘ç”Ÿäº†åˆ‡æ¢ï¼Œé‚£ä¹ˆé€šè¿‡å“¨å…µèŠ‚ç‚¹è·å¾—çš„ä¸»åº“åº”è¯¥æ˜¯åˆ‡æ¢åçš„ï¼Œä¸ºä½•å®¢æˆ·ç«¯è¿˜ä¼šå†™åˆ°åŸä¸»åº“ï¼Ÿ<br>å“ªä½è€å“¥è§£é‡Šä¸‹","like_count":0,"discussions":[{"author":{"id":2346917,"avatar":"https://static001.geekbang.org/account/avatar/00/23/cf/a5/5224b297.jpg","nickname":"cafe babe","note":"","ucode":"6205DF67AD86F8","race_medal":0,"user_type":1,"is_pvip":true},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":581754,"discussion_content":"è¿˜æ²¡æœ‰åˆ‡æ¢å®Œæˆæ—¶ï¼Œå®¢æˆ·ç«¯å‘åŸæ¥çš„ä¸»åº“å†™æ•°æ®ã€‚å½“ç„¶åˆ‡æ¢å®Œæˆä¹‹åï¼Œå“¨å…µä¼šé€šçŸ¥å®¢æˆ·ç«¯ã€‚å¯æ˜¯æ²¡åˆ‡æ¢å®Œæˆå†™å…¥çš„æ•°æ®å°±ä¼šä¸¢å¤±ã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1658973764,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":269384,"user_name":"yzz","can_delete":false,"product_type":"c1","uid":2350551,"ip_address":"","ucode":"AD5FB7E893B495","user_header":"","comment_is_top":false,"comment_ctime":1608629322,"is_pvip":false,"discussion_count":2,"race_medal":0,"score":"1608629322","product_id":100056701,"comment_content":"è€å¸ˆæ‚¨å¥½ï¼Œé’ˆå¯¹æ‚¨åˆ†æçš„è„‘è£‚çš„äº§ç”ŸåŸå› ï¼Œæˆ‘æœ‰ä¸€ä¸ªç–‘é—®ï¼šæ‚¨åœ¨å‰é¢åˆ†æé—®é¢˜çš„è¿‡ç¨‹ä¸­æ’é™¤äº†ä¸»ä»åº“ä¹‹é—´å¤åˆ¶è¿›åº¦ä¸ä¸€è‡´çš„é—®é¢˜ï¼Œæ—¢ç„¶ä¸»ä»åº“ä¹‹é—´æ˜¯å®Œå…¨åŒæ­¥çš„ï¼Œé‚£ä¸»åº“é‡æ–°å˜ä¸ºå¯ç”¨ä¹‹åå†™å…¥çš„æ•°æ®åº”è¯¥å·²ç»åŒæ­¥åˆ°ä»åº“äº†ï¼Œé‚£ä¹ˆç»è¿‡ä¸»ä»åˆ‡æ¢åï¼Œæ•°æ®æ˜¯ä¸æ˜¯ä¹Ÿä¸åº”è¯¥ä¸¢å‘¢ï¼Ÿ","like_count":0,"discussions":[{"author":{"id":1762191,"avatar":"https://static001.geekbang.org/account/avatar/00/1a/e3/8f/77b5a753.jpg","nickname":"å¥½å¥½å­¦ä¹ ","note":"","ucode":"9D44D9530D9A1D","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":341796,"discussion_content":"è€å¸ˆçš„å›¾ä¸Šæ ‡æ³¨çš„æ˜¯ï¼šæ–°ä¸»åº“ä¸Šçº¿åï¼Œæ—§çš„ä¸»åº“æ²¦ä¸ºä»åº“ï¼Œä¼šåˆ é™¤æœ¬åœ°æ•°æ®ï¼Œå…¨é‡åŒæ­¥æ–°ä¸»åº“çš„æ•°æ®ï¼Œè¿™æ ·åœ¨ä¸»ä»åˆ‡æ¢æœŸé—´ï¼Œæ—§ä¸»åº“æ¥å—åˆ°å®¢æˆ·ç«¯çš„å†™è¯·æ±‚çš„è¿™äº›æ•°æ®å°±ä¸¢å¤±äº†ï¼Œä¸”è¿™äº›æ•°æ®æ²¡æœ‰è¢«åŒæ­¥åˆ°ä»åº“æ—¶å› ä¸ºå½“æ—¶å·²ç»è¢«å“¨å…µé›†ç¾¤è®¤å®šä¸ºå®¢è§‚ä¸‹çº¿äº†ã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1610525886,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":2253496,"avatar":"","nickname":"Geek_3d87cb","note":"","ucode":"F09334D60C3BC8","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":339929,"discussion_content":"è¿™ä¸ªæ—¶å€™å“¨å…µå·²ç»è¿›è¡Œä¸»ä»åˆ‡æ¢äº†","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1609843737,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":259524,"user_name":"yyl","can_delete":false,"product_type":"c1","uid":1170843,"ip_address":"","ucode":"1741DACDFCA9AF","user_header":"https://static001.geekbang.org/account/avatar/00/11/dd/9b/0bc44a78.jpg","comment_is_top":false,"comment_ctime":1604741542,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1604741542","product_id":100056701,"comment_content":"ç”Ÿäº§ç¯å¢ƒæ›´ä¸ºå¤æ‚ï¼ŒRedisè·¨æœºå™¨å¤šå®ä¾‹éƒ¨ç½²ï¼Œç½‘ç»œçŠ¶å†µæŠ–åŠ¨æ—¶ï¼Œåº”è¯¥è¿˜æ˜¯ä¼šå‡ºç°è„‘è£‚é—®é¢˜ï¼Œæ„Ÿè§‰æ— æ³•å®Œå…¨é¿å…å•Š","like_count":0},{"had_liked":false,"id":259045,"user_name":"å”æœé¦–éƒ½","can_delete":false,"product_type":"c1","uid":1081233,"ip_address":"","ucode":"F72655AE0AE4CA","user_header":"https://static001.geekbang.org/account/avatar/00/10/7f/91/962eba1a.jpg","comment_is_top":false,"comment_ctime":1604623363,"is_pvip":true,"discussion_count":0,"race_medal":0,"score":"1604623363","product_id":100056701,"comment_content":"Redisæ— æ³•å®Œå…¨é¿å…è„‘è£‚çš„äº§ç”Ÿï¼Œå› ä¸ºå…¶ä¸ä¿è¯ä¸»ä»çš„å¼ºä¸€è‡´ï¼Œæ‰€ä»¥å¿…ç„¶æœ‰äº§ç”Ÿè„‘è£‚çš„å¯èƒ½æ€§ã€‚","like_count":0}]}