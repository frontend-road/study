{"id":103349,"title":"07丨什么是SQL函数？为什么使用SQL函数可能会带来问题？","content":"<p>函数在计算机语言的使用中贯穿始终，在SQL中我们也可以使用函数对检索出来的数据进行函数操作，比如求某列数据的平均值，或者求字符串的长度等。从函数定义的角度出发，我们可以将函数分成内置函数和自定义函数。在SQL语言中，同样也包括了内置函数和自定义函数。内置函数是系统内置的通用函数，而自定义函数是我们根据自己的需要编写的，下面讲解的是SQL的内置函数。</p><p>你需要从以下几个方面掌握SQL函数：</p><ol>\n<li>什么是SQL函数？</li>\n<li>内置的SQL函数都包括哪些？</li>\n<li>如何使用SQL函数对一个数据表进行操作，比如针对一个王者荣耀的英雄数据库，我们可以使用这些函数完成哪些操作？</li>\n<li>什么情况下使用SQL函数？为什么使用SQL函数有时候会带来问题？</li>\n</ol><h2>什么是SQL函数</h2><p>当我们学习编程语言的时候，也会遇到函数。函数的作用是什么呢？它可以把我们经常使用的代码封装起来，需要的时候直接调用即可。这样既提高了代码效率，又提高了可维护性。</p><p>SQL中的函数一般是在数据上执行的，可以很方便地转换和处理数据。一般来说，当我们从数据表中检索出数据之后，就可以进一步对这些数据进行操作，得到更有意义的结果，比如返回指定条件的函数，或者求某个字段的平均值等。</p><h2>常用的SQL函数有哪些</h2><!-- [[[read_end]]] --><p>SQL提供了一些常用的内置函数，当然你也可以自己定义SQL函数。SQL的内置函数对于不同的数据库软件来说具有一定的通用性，我们可以把内置函数分成四类：</p><ol>\n<li>算术函数</li>\n<li>字符串函数</li>\n<li>日期函数</li>\n<li>转换函数</li>\n</ol><p>这4类函数分别代表了算术处理、字符串处理、日期处理、数据类型转换，它们是SQL函数常用的划分形式，你可以思考下，为什么是这4个维度？</p><p>函数是对提取出来的数据进行操作，那么数据表中字段类型的定义有哪几种呢？</p><p>我们经常会保存一些数值，不论是整数类型，还是浮点类型，实际上对应的就是数值类型。同样我们也会保存一些文本内容，可能是人名，也可能是某个说明，对应的就是字符串类型。此外我们还需要保存时间，也就是日期类型。那么针对数值、字符串和日期类型的数据，我们可以对它们分别进行算术函数、字符串函数以及日期函数的操作。如果想要完成不同类型数据之间的转换，就可以使用转换函数。</p><h3>算术函数</h3><p>算术函数，顾名思义就是对数值类型的字段进行算术运算。常用的算术函数及含义如下表所示：</p><p><img src=\"https://static001.geekbang.org/resource/image/19/e1/193b171970c90394576d3812a46dd8e1.png?wh=1243*256\" alt=\"\"></p><p>这里我举一些简单的例子，你来体会下：</p><p><code>SELECT ABS(-2)</code>，运行结果为2。</p><p><code>SELECT MOD(101,3)</code>，运行结果2。</p><p><code>SELECT ROUND(37.25,1)</code>，运行结果37.3。</p><h3>字符串函数</h3><p>常用的字符串函数操作包括了字符串拼接，大小写转换，求长度以及字符串替换和截取等。具体的函数名称及含义如下表所示：</p><p><img src=\"https://static001.geekbang.org/resource/image/c1/4d/c161033ebeeaa8eb2436742f0f818a4d.png?wh=1237*568\" alt=\"\"><br>\n这里同样有一些简单的例子，你可以自己运行下：</p><p><code>SELECT CONCAT('abc', 123)</code>，运行结果为abc123。</p><p><code>SELECT LENGTH('你好')</code>，运行结果为6。</p><p><code>SELECT CHAR_LENGTH('你好')</code>，运行结果为2。</p><p><code>SELECT LOWER('ABC')</code>，运行结果为abc。</p><p><code>SELECT UPPER('abc')</code>，运行结果ABC。</p><p><code>SELECT REPLACE('fabcd', 'abc', 123)</code>，运行结果为f123d。</p><p><code>SELECT SUBSTRING('fabcd', 1,3)</code>，运行结果为fab。</p><h3>日期函数</h3><p>日期函数是对数据表中的日期进行处理，常用的函数包括：</p><p><img src=\"https://static001.geekbang.org/resource/image/3d/45/3dec8d799b1363d38df34ed3fdd29045.png?wh=931*615\" alt=\"\"></p><p>下面是一些简单的例子，你可自己运行下：</p><p><code>SELECT CURRENT_DATE()</code>，运行结果为2019-04-03。</p><p><code>SELECT CURRENT_TIME()</code>，运行结果为21:26:34。</p><p><code>SELECT CURRENT_TIMESTAMP()</code>，运行结果为2019-04-03 21:26:34。</p><p><code>SELECT EXTRACT(YEAR FROM '2019-04-03')</code>，运行结果为2019。</p><p><code>SELECT DATE('2019-04-01 12:00:05')</code>，运行结果为2019-04-01。</p><p>这里需要注意的是，DATE日期格式必须是yyyy-mm-dd的形式。如果要进行日期比较，就要使用DATE函数，不要直接使用日期与字符串进行比较，我会在后面的例子中讲具体的原因。</p><h3>转换函数</h3><p>转换函数可以转换数据之间的类型，常用的函数如下表所示：</p><p><img src=\"https://static001.geekbang.org/resource/image/5d/59/5d977d747ed1fddca3acaab33d29f459.png?wh=1085*209\" alt=\"\"><br>\n这两个函数不像其他函数，看一眼函数名就知道代表什么、如何使用。下面举了这两个函数的例子，你需要自己运行下：</p><p><code>SELECT CAST(123.123 AS INT)</code>，运行结果会报错。</p><p><code>SELECT CAST(123.123 AS DECIMAL(8,2))</code>，运行结果为123.12。</p><p><code>SELECT COALESCE(null,1,2)</code>，运行结果为1。</p><p>CAST函数在转换数据类型的时候，不会四舍五入，如果原数值有小数，那么转换为整数类型的时候就会报错。不过你可以指定转化的小数类型，在MySQL和SQL Server中，你可以用<code>DECIMAL(a,b)</code>来指定，其中a代表整数部分和小数部分加起来最大的位数，b代表小数位数，比如<code>DECIMAL(8,2)</code>代表的是精度为8位（整数加小数位数最多为8位），小数位数为2位的数据类型。所以<code>SELECT CAST(123.123 AS DECIMAL(8,2))</code>的转换结果为123.12。</p><h2>用SQL函数对王者荣耀英雄数据做处理</h2><p>我创建了一个王者荣耀英雄数据库，一共有69个英雄，23个属性值。SQL文件见Github地址：<a href=\"https://github.com/cystanford/sql_heros_data\">https://github.com/cystanford/sql_heros_data</a>。</p><p><img src=\"https://static001.geekbang.org/resource/image/7b/24/7b14aeedd80fd7e8fb8074f9884d6b24.png?wh=1107*344\" alt=\"\"><br>\n我们现在把这个文件导入到MySQL中，你可以使用Navicat可视化数据库管理工具将.sql文件导入到数据库中。数据表为heros，然后使用今天学习的SQL函数，对这个英雄数据表进行处理。</p><p>首先显示英雄以及他的物攻成长，对应字段为<code>attack_growth</code>。我们让这个字段精确到小数点后一位，需要使用的是算术函数里的ROUND函数。</p><pre><code>SQL：SELECT name, ROUND(attack_growth,1) FROM heros\n</code></pre><p>代码中，<code>ROUND(attack_growth,1)</code>中的<code>attack_growth</code>代表想要处理的数据，“1”代表四舍五入的位数，也就是我们这里需要精确到的位数。</p><p>运行结果为：</p><p><img src=\"https://static001.geekbang.org/resource/image/fb/ed/fb55a715543e1ed3245ae37210ad75ed.png?wh=640*346\" alt=\"\"><br>\n假设我们想显示英雄最大生命值的最大值，就需要用到MAX函数。在数据中，“最大生命值”对应的列数为<code>hp_max</code>，在代码中的格式为<code>MAX(hp_max)</code>。</p><pre><code>SQL：SELECT MAX(hp_max) FROM heros\n</code></pre><p>运行结果为9328。</p><p>假如我们想要知道最大生命值最大的是哪个英雄，以及对应的数值，就需要分成两个步骤来处理：首先找到英雄的最大生命值的最大值，即<code>SELECT MAX(hp_max) FROM heros</code>，然后再筛选最大生命值等于这个最大值的英雄，如下所示。</p><pre><code>SQL：SELECT name, hp_max FROM heros WHERE hp_max = (SELECT MAX(hp_max) FROM heros)\n</code></pre><p>运行结果：</p><p><img src=\"https://static001.geekbang.org/resource/image/93/20/9371fdcee4d1f7bdfdd71bc0a58aac20.png?wh=371*125\" alt=\"\"></p><p>假如我们想显示英雄的名字，以及他们的名字字数，需要用到<code>CHAR_LENGTH</code>函数。</p><pre><code>SQL：SELECT CHAR_LENGTH(name), name FROM heros\n</code></pre><p>运行结果为：</p><p><img src=\"https://static001.geekbang.org/resource/image/41/8c/415aa09e2fdc121861e3c96bd8a2af8c.png?wh=614*345\" alt=\"\"></p><p>假如想要提取英雄上线日期（对应字段birthdate）的年份，只显示有上线日期的英雄即可（有些英雄没有上线日期的数据，不需要显示），这里我们需要使用EXTRACT函数，提取某一个时间元素。所以我们需要筛选上线日期不为空的英雄，即<code>WHERE birthdate is not null</code>，然后再显示他们的名字和上线日期的年份，即：</p><pre><code>SQL： SELECT name, EXTRACT(YEAR FROM birthdate) AS birthdate FROM heros WHERE birthdate is NOT NULL\n</code></pre><p>或者使用如下形式：</p><pre><code>SQL: SELECT name, YEAR(birthdate) AS birthdate FROM heros WHERE birthdate is NOT NULL\n</code></pre><p>运行结果为：</p><p><img src=\"https://static001.geekbang.org/resource/image/26/16/26cacf4d619d9f177a1f5b22059f9916.png?wh=615*344\" alt=\"\"></p><p>假设我们需要找出在2016年10月1日之后上线的所有英雄。这里我们可以采用DATE函数来判断birthdate的日期是否大于2016-10-01，即<code>WHERE DATE(birthdate)&gt;'2016-10-01'</code>，然后再显示符合要求的全部字段信息，即：</p><pre><code>SQL： SELECT * FROM heros WHERE DATE(birthdate)&gt;'2016-10-01'\n</code></pre><p>需要注意的是下面这种写法是不安全的：</p><pre><code>SELECT * FROM heros WHERE birthdate&gt;'2016-10-01'\n</code></pre><p>因为很多时候你无法确认birthdate的数据类型是字符串，还是datetime类型，如果你想对日期部分进行比较，那么使用<code>DATE(birthdate)</code>来进行比较是更安全的。</p><p>运行结果为：</p><p><img src=\"https://static001.geekbang.org/resource/image/e5/22/e5696b5ff0aae0fd910463b1f8e6ed22.png?wh=1112*350\" alt=\"\"></p><p>假设我们需要知道在2016年10月1日之后上线英雄的平均最大生命值、平均最大法力和最高物攻最大值。同样我们需要先筛选日期条件，即<code>WHERE DATE(birthdate)&gt;'2016-10-01'</code>，然后再选择<code>AVG(hp_max), AVG(mp_max), MAX(attack_max)</code>字段进行显示。</p><pre><code>SQL： SELECT AVG(hp_max), AVG(mp_max), MAX(attack_max) FROM heros WHERE DATE(birthdate)&gt;'2016-10-01'\n</code></pre><p>运行结果为：</p><p><img src=\"https://static001.geekbang.org/resource/image/8f/6b/8f559dc1be7d62e4c58402ebe2e7856b.png?wh=1105*128\" alt=\"\"></p><h2>为什么使用SQL函数会带来问题</h2><p>尽管SQL函数使用起来会很方便，但我们使用的时候还是要谨慎，因为你使用的函数很可能在运行环境中无法工作，这是为什么呢？</p><p>如果你学习过编程语言，就会知道语言是有不同版本的，比如Python会有2.7版本和3.x版本，不过它们之间的函数差异不大，也就在10%左右。但我们在使用SQL语言的时候，不是直接和这门语言打交道，而是通过它使用不同的数据库软件，即DBMS。DBMS之间的差异性很大，远大于同一个语言不同版本之间的差异。实际上，只有很少的函数是被DBMS同时支持的。比如，大多数DBMS使用（||）或者（+）来做拼接符，而在MySQL中的字符串拼接函数为<code>Concat()</code>。大部分DBMS会有自己特定的函数，这就意味着采用SQL函数的代码可移植性是很差的，因此在使用函数的时候需要特别注意。</p><h2>关于大小写的规范</h2><p>细心的人可能会发现，我在写SELECT语句的时候用的是大写，而你在网上很多地方，包括你自己写的时候可能用的是小写。实际上在SQL中，关键字和函数名是不用区分字母大小写的，比如SELECT、WHERE、ORDER、GROUP BY等关键字，以及ABS、MOD、ROUND、MAX等函数名。</p><p>不过在SQL中，你还是要确定大小写的规范，因为在Linux和Windows环境下，你可能会遇到不同的大小写问题。</p><p>比如MySQL在Linux的环境下，数据库名、表名、变量名是严格区分大小写的，而字段名是忽略大小写的。</p><p>而MySQL在Windows的环境下全部不区分大小写。</p><p>这就意味着如果你的变量名命名规范没有统一，就可能产生错误。这里有一个有关命名规范的建议：</p><ol>\n<li>关键字和函数名称全部大写；</li>\n<li>数据库名、表名、字段名称全部小写；</li>\n<li>SQL语句必须以分号结尾。</li>\n</ol><p>虽然关键字和函数名称在SQL中不区分大小写，也就是如果小写的话同样可以执行，但是数据库名、表名和字段名在Linux MySQL环境下是区分大小写的，因此建议你统一这些字段的命名规则，比如全部采用小写的方式。同时将关键词和函数名称全部大写，以便于区分数据库名、表名、字段名。</p><h2>总结</h2><p>函数对于一门语言的重要性毋庸置疑，我们在写Python代码的时候，会自己编写函数，也会使用Python内置的函数。在SQL中，使用函数的时候需要格外留意。不过如果工程量不大，使用的是同一个DBMS的话，还是可以使用函数简化操作的，这样也能提高代码效率。只是在系统集成，或者在多个DBMS同时存在的情况下，使用函数的时候就需要慎重一些。</p><p>比如<code>CONCAT()</code>是字符串拼接函数，在MySQL和Oracle中都有这个函数，但是在这两个DBMS中作用却不一样，<code>CONCAT</code>函数在MySQL中可以连接多个字符串，而在Oracle中<code>CONCAT</code>函数只能连接两个字符串，如果要连接多个字符串就需要用（||）连字符来解决。</p><p><img src=\"https://static001.geekbang.org/resource/image/8c/c9/8c5e316b466e8fa65789a9c6a220ebc9.jpg?wh=3341*1309\" alt=\"\"><br>\n讲完了SQL函数的使用，我们来做一道练习题。还是根据王者荣耀英雄数据表，请你使用SQL函数作如下的练习：计算英雄的最大生命平均值；显示出所有在2017年之前上线的英雄，如果英雄没有统计上线日期则不显示。</p><p>欢迎你在评论区与我分享你的答案，也欢迎点击”请朋友读“，把这篇文章分享给你的朋友或者同事。</p>","neighbors":{"left":{"article_title":"06丨数据过滤：SQL数据过滤都有哪些方法？","id":102541},"right":{"article_title":"08丨什么是SQL的聚集函数，如何利用它们汇总表的数据？","id":103782}},"comments":[{"had_liked":false,"id":107372,"user_name":"时间是最真的答案","can_delete":false,"product_type":"c1","uid":1183601,"ip_address":"","ucode":"B90F3EF769F865","user_header":"https://static001.geekbang.org/account/avatar/00/12/0f/71/9273e8a4.jpg","comment_is_top":false,"comment_ctime":1561520825,"is_pvip":false,"discussion_count":3,"race_medal":0,"score":"469712956089","product_id":100029501,"comment_content":"基础篇可以快点更新，很多同学都有一些基础，看懂不难；进阶篇和高级篇可以正常更新，大家可以花多点时间在难点上，可能会更大提高大家的学习效率","like_count":109,"discussions":[{"author":{"id":1476701,"avatar":"https://static001.geekbang.org/account/avatar/00/16/88/5d/5cc4c75a.jpg","nickname":"我是李椭超他哥李方超 🐕","note":"","ucode":"0CE438B148CD6A","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":350720,"discussion_content":"你牛逼怎么不自学啊","likes_number":4,"is_delete":false,"is_hidden":false,"ctime":1613988811,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1307012,"avatar":"https://static001.geekbang.org/account/avatar/00/13/f1/84/7d21bd9e.jpg","nickname":"Goal","note":"","ucode":"C337CD4C7E07B0","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":539,"discussion_content":"没有规矩不成方圆","likes_number":4,"is_delete":false,"is_hidden":false,"ctime":1561651029,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1968721,"avatar":"http://thirdwx.qlogo.cn/mmopen/vi_32/unkzY52hVDjTmZJGNkrBR75tFs4XTGBoYYcOYkIcPvHlQrLibwc94aBfj1uWiawoKeEMwHbkvgThXZarfoP8Dzag/132","nickname":"她","note":"","ucode":"FAC6851866C9C7","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":253760,"discussion_content":"我反对","likes_number":2,"is_delete":false,"is_hidden":false,"ctime":1588256331,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":107594,"user_name":"leslie","can_delete":false,"product_type":"c1","uid":1324255,"ip_address":"","ucode":"798E7C1CC98CC2","user_header":"https://static001.geekbang.org/account/avatar/00/14/34/df/64e3d533.jpg","comment_is_top":false,"comment_ctime":1561561850,"is_pvip":false,"discussion_count":5,"race_medal":0,"score":"285029403386","product_id":100029501,"comment_content":"关于SQL函数问题：老师应当漏了一个关键点吧；它会导致查询不走索引，直接全表遍历，导致慢查询-这才是最重要的问题。现实工作中一般是禁止where条件出现函数：看到了就让开发代码重写。","like_count":67,"discussions":[{"author":{"id":1130590,"avatar":"https://static001.geekbang.org/account/avatar/00/11/40/5e/b8fada94.jpg","nickname":"Ryoma","note":"","ucode":"7F692369239692","race_medal":2,"user_type":1,"is_pvip":true},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":1758,"discussion_content":"不是函数会导致不走索引，要看函数的位置。一般来说，出现在比较运算符右边的依然可以运用索引","likes_number":6,"is_delete":false,"is_hidden":false,"ctime":1562896205,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1706074,"avatar":"https://static001.geekbang.org/account/avatar/00/1a/08/5a/4d709cf5.jpg","nickname":"Pray、PF","note":"","ucode":"1E3E4073763490","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":280121,"discussion_content":"你这样说的太绝对了，只是在建立的索引列上使用函数，才会让索引失效","likes_number":5,"is_delete":false,"is_hidden":false,"ctime":1591498738,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":2172386,"avatar":"https://static001.geekbang.org/account/avatar/00/21/25/e2/cfb43a8e.jpg","nickname":"互联网砖瓦匠","note":"","ucode":"107F18AD8E6DA3","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":366910,"discussion_content":"select 后边写 不会影响索引，where里 可以在条件表达式右边加函数不要在左边加。。左边加就完犊子 一定是全表扫","likes_number":2,"is_delete":false,"is_hidden":false,"ctime":1618216393,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1238323,"avatar":"https://static001.geekbang.org/account/avatar/00/12/e5/33/ff5c52ad.jpg","nickname":"不负","note":"","ucode":"147F5860711811","race_medal":1,"user_type":1,"is_pvip":true},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":481,"discussion_content":"像Oracle中where条件里用了TO_DATE函数会导致全表遍历？having 里使用也包括？","likes_number":2,"is_delete":false,"is_hidden":false,"ctime":1561610958,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":1,"child_discussions":[{"author":{"id":1079621,"avatar":"https://static001.geekbang.org/account/avatar/00/10/79/45/33bed7ab.jpg","nickname":"沉寂","note":"","ucode":"0DDDE369ADED6F","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":1238323,"avatar":"https://static001.geekbang.org/account/avatar/00/12/e5/33/ff5c52ad.jpg","nickname":"不负","note":"","ucode":"147F5860711811","race_medal":1,"user_type":1,"is_pvip":true},"discussion":{"id":590,"discussion_content":"测试大哥吗","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1561734759,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":481,"ip_address":""},"score":590,"extra":""}]}]},{"had_liked":false,"id":107375,"user_name":"Abyssknight","can_delete":false,"product_type":"c1","uid":1336361,"ip_address":"","ucode":"08E8D68E4B76BB","user_header":"https://static001.geekbang.org/account/avatar/00/14/64/29/da537902.jpg","comment_is_top":false,"comment_ctime":1561521789,"is_pvip":false,"discussion_count":5,"race_medal":0,"score":"117525638781","product_id":100029501,"comment_content":"由于sql中存在数据类型隐式转换的问题，我查了些资料，有一些不明白的地方。<br>首先，对于 select * from heros where date(birthdate) &gt; &#39;2016-10-01&#39;，老师你说不使用date函数不安全，但是创建表的时候，birthday声明的就是date类型，那它就不可能是其他类型了啊；其次，我给 birthday 加上索引以后，使用explain查看执行计划，不使用 date 函数直接比较的效果要优于使用 date 函数 (参考的是 explain 结果的 type 属性，使用函数为ALL，不使用函数为range); 还有就是既然birthday 是 date 类型，那 被比较对象 ‘2017-01-01’ 是字符串，这就不同同一种数据类型了，我把它转换成 date 类型后进行比较，explain的结果却是一样的，那这里是否存在隐式的类型转换？<br><br>隐式类型转换的资料主要参考这篇文章：https:&#47;&#47;blog.csdn.net&#47;u010695794&#47;article&#47;details&#47;78509191","like_count":27,"discussions":[{"author":{"id":1018928,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/8c/30/d642e01a.jpg","nickname":"zhengnachuan","note":"","ucode":"FC6CD65906BE6B","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":21167,"discussion_content":"我看你贴的文章里有这么一段：&#34;如果其中一个参数是TIMESTAMP或DATETIME列，另一个参数是常量，则在执行比较之前将常量转换为时间戳。&#34;\n\n我的理解是，如果birthday是date类型，那么被比较对象（字符串）会被转换成时间类型。\n\n因为只有对表达式左边的参数进行函数操作才会使索引失效，而这种情况只是对常量进行转换，不影响走索引。","likes_number":4,"is_delete":false,"is_hidden":false,"ctime":1569427437,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1759325,"avatar":"https://static001.geekbang.org/account/avatar/00/1a/d8/5d/07dfb3b5.jpg","nickname":"杯莫停","note":"","ucode":"4FA1D5CBBEF702","race_medal":0,"user_type":1,"is_pvip":true},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":304664,"discussion_content":"你加了索引之后在用data函数会导致索引失效的","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1599637192,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1130590,"avatar":"https://static001.geekbang.org/account/avatar/00/11/40/5e/b8fada94.jpg","nickname":"Ryoma","note":"","ucode":"7F692369239692","race_medal":2,"user_type":1,"is_pvip":true},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":1757,"discussion_content":"这里已经不是隐式转换的问题，在比较字符时左边使用了函数，是没有办法用到索引的。\n比如实际时间是 2019-07-01 12:00:00，函数取出了月份 07，此时该字段的索引无法应用。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1562896131,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1084458,"avatar":"https://static001.geekbang.org/account/avatar/00/10/8c/2a/49e0547d.jpg","nickname":"发条","note":"","ucode":"75853E7B13D8D4","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":498,"discussion_content":"高端","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1561622823,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1005391,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/57/4f/6fb51ff1.jpg","nickname":"一步","note":"","ucode":"73CEA468CE70C3","race_medal":1,"user_type":1,"is_pvip":true},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":437,"discussion_content":"这个问题 也是我的疑问，今天在群里问了一下，没有问道满意的结果，希望老师看到能解答一下","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1561556098,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":108174,"user_name":"菜菜","can_delete":false,"product_type":"c1","uid":1243536,"ip_address":"","ucode":"888AC33663B774","user_header":"https://static001.geekbang.org/account/avatar/00/12/f9/90/f90903e5.jpg","comment_is_top":false,"comment_ctime":1561690616,"is_pvip":false,"replies":[{"id":"39208","content":"很好 我已经很久没打了，昨天整理稿子的时候也有冲突想开一局，不过还是忍住了，一方面手机存储空间满了，另一方面还是多学习和工作，会让状态更好","user_name":"作者回复","user_name_real":"cy","uid":"1306094","ctime":1561694311,"ip_address":"","comment_id":108174,"utype":1}],"discussion_count":3,"race_medal":0,"score":"108935873016","product_id":100029501,"comment_content":"学得我想打王者荣耀了","like_count":25,"discussions":[{"author":{"id":1306094,"avatar":"https://static001.geekbang.org/account/avatar/00/13/ed/ee/c4779b67.jpg","nickname":"cy","note":"","ucode":"50D653399A31F6","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":455856,"discussion_content":"很好 我已经很久没打了，昨天整理稿子的时候也有冲突想开一局，不过还是忍住了，一方面手机存储空间满了，另一方面还是多学习和工作，会让状态更好","likes_number":2,"is_delete":false,"is_hidden":false,"ctime":1561694311,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":1,"child_discussions":[{"author":{"id":1317847,"avatar":"https://static001.geekbang.org/account/avatar/00/14/1b/d7/868d26ce.jpg","nickname":"songhyunmin","note":"","ucode":"D5A98668CD8532","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":1306094,"avatar":"https://static001.geekbang.org/account/avatar/00/13/ed/ee/c4779b67.jpg","nickname":"cy","note":"","ucode":"50D653399A31F6","race_medal":0,"user_type":2,"is_pvip":false},"discussion":{"id":542216,"discussion_content":"学霸的学习主动性和自控力果然强。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1640684347,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":455856,"ip_address":""},"score":542216,"extra":""}]},{"author":{"id":1145779,"avatar":"https://static001.geekbang.org/account/avatar/00/11/7b/b3/194f7f90.jpg","nickname":"没伞的孩子得使劲奔跑","note":"","ucode":"D015B4EF12E536","race_medal":1,"user_type":1,"is_pvip":true},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":278777,"discussion_content":"我可能控制不住我自己","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1591233499,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":183032,"user_name":"汪zZ","can_delete":false,"product_type":"c1","uid":1234757,"ip_address":"","ucode":"8B93062A683902","user_header":"https://static001.geekbang.org/account/avatar/00/12/d7/45/d1621188.jpg","comment_is_top":false,"comment_ctime":1582936459,"is_pvip":true,"discussion_count":2,"race_medal":1,"score":"91777249675","product_id":100029501,"comment_content":"2刷的时候感觉怪怪的。最后发现heros是错误的。英雄加复数应该是heroes。","like_count":22,"discussions":[{"author":{"id":1226968,"avatar":"https://static001.geekbang.org/account/avatar/00/12/b8/d8/f81b5604.jpg","nickname":"hcyycb","note":"","ucode":"77FF6CA41F9E66","race_medal":0,"user_type":1,"is_pvip":true},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":531218,"discussion_content":"牛逼plus了\n","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1637248854,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"user_type\":1}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":2841904,"avatar":"https://static001.geekbang.org/account/avatar/00/2b/5d/30/545a8ce4.jpg","nickname":"小锌516","note":"","ucode":"ECD06D99B91DA8","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":530756,"discussion_content":"这种细节都被大佬发现了，哈哈","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1637141261,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"user_type\":1}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":107940,"user_name":"supermouse","can_delete":false,"product_type":"c1","uid":1321860,"ip_address":"","ucode":"88072D5F881827","user_header":"https://static001.geekbang.org/account/avatar/00/14/2b/84/07f0c0d6.jpg","comment_is_top":false,"comment_ctime":1561636499,"is_pvip":false,"replies":[{"id":"39126","content":"正确","user_name":"作者回复","user_name_real":"cy","uid":"1306094","ctime":1561680624,"ip_address":"","comment_id":107940,"utype":1}],"discussion_count":1,"race_medal":0,"score":"78871047827","product_id":100029501,"comment_content":"计算英雄的最大生命平均值：<br>SELECT AVG(hp_max) FROM heros;<br><br>显示所有在2017年之前上线的英雄：<br>SELECT name FROM heros WHERE birthdate IS NOT NULL AND YEAR(birthdate) &lt; 2017;","like_count":19,"discussions":[{"author":{"id":1306094,"avatar":"https://static001.geekbang.org/account/avatar/00/13/ed/ee/c4779b67.jpg","nickname":"cy","note":"","ucode":"50D653399A31F6","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":455757,"discussion_content":"正确","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1561680624,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":107843,"user_name":"Andre","can_delete":false,"product_type":"c1","uid":1563047,"ip_address":"","ucode":"2713749A29A4E0","user_header":"https://static001.geekbang.org/account/avatar/00/17/d9/a7/a794afb1.jpg","comment_is_top":false,"comment_ctime":1561621624,"is_pvip":false,"replies":[{"id":"39140","content":"谢谢 基础篇让大家都有个共识的基础，掌握的人也可以快速复习一遍，进阶篇会有更多关于性能调优，高可用架构等","user_name":"作者回复","user_name_real":"cy","uid":"1306094","ctime":1561681234,"ip_address":"","comment_id":107843,"utype":1}],"discussion_count":1,"race_medal":0,"score":"31626392696","product_id":100029501,"comment_content":"答案：SELECT avg(hp_max) as avg_hp<br>FROM heros;<br><br>SELECT `name`<br>FROM heros<br>WHERE birthdate is NOT NULL AND DATE(birthdate)&lt;&#39;2017-01-01&#39;;<br>另外赞同时间是最真的答案的说法，应该来讲基础篇大家都还是学起来不费力的，希望基础篇能够快点更新，然后尽快的进入进阶篇","like_count":7,"discussions":[{"author":{"id":1306094,"avatar":"https://static001.geekbang.org/account/avatar/00/13/ed/ee/c4779b67.jpg","nickname":"cy","note":"","ucode":"50D653399A31F6","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":455701,"discussion_content":"谢谢 基础篇让大家都有个共识的基础，掌握的人也可以快速复习一遍，进阶篇会有更多关于性能调优，高可用架构等","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1561681234,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":123148,"user_name":"番茄","can_delete":false,"product_type":"c1","uid":1583667,"ip_address":"","ucode":"7354EEB2D8A43D","user_header":"http://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTICAILuSqtnAfl1zcgRWIULia2nbjzlybTEQJUMT68KPj80BicwQyibAK3Icxp4qwC03LqrtvfX0fbZg/132","comment_is_top":false,"comment_ctime":1565615328,"is_pvip":false,"replies":[{"id":"63878","content":"with table as是在ORACLE中的用法，相当于临时表的作用，在MySQL中可以使用：<br>CREATE TEMPORARY TABLE t AS<br>(<br>    SELECT *  FROM player<br>);<br>","user_name":"作者回复","user_name_real":"cy","uid":"1306094","ctime":1577602480,"ip_address":"","comment_id":123148,"utype":1}],"discussion_count":2,"race_medal":0,"score":"27335419104","product_id":100029501,"comment_content":"能请教下，mysql不能用with table as 这个语句，要用什么来替代这个比较方便呢","like_count":6,"discussions":[{"author":{"id":1306094,"avatar":"https://static001.geekbang.org/account/avatar/00/13/ed/ee/c4779b67.jpg","nickname":"cy","note":"","ucode":"50D653399A31F6","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":462558,"discussion_content":"with table as是在ORACLE中的用法，相当于临时表的作用，在MySQL中可以使用：\nCREATE TEMPORARY TABLE t AS\n(\n    SELECT *  FROM player\n);\n","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1577602480,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1030494,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/b9/5e/accb1628.jpg","nickname":"KevinGao","note":"","ucode":"DDA27A8961D720","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":366307,"discussion_content":"MySQL 8 支持 With 语句了， MySQL 5.7 以及之前的版本都不支持。 ","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1618024082,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":107400,"user_name":"mickey","can_delete":false,"product_type":"c1","uid":1051663,"ip_address":"","ucode":"8B490C2DDE4010","user_header":"https://static001.geekbang.org/account/avatar/00/10/0c/0f/93d1c8eb.jpg","comment_is_top":false,"comment_ctime":1561528979,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"23036365459","product_id":100029501,"comment_content":"#计算英雄的最大生命平均值；<br>#MySQL实现：<br>SELECT avg(hp_max) as &#39;英雄的最大生命平均值&#39; FROM heros;<br><br>#查询结果：<br>英雄的最大生命平均值<br>----------------------<br>6580.478260869565<br><br><br><br>#显示出所有在 2017 年之前上线的英雄，如果英雄没有统计上线日期则不显示。<br>#MySQL实现：<br>SELECT * FROM heros WHERE birthdate is NOT NULL AND EXTRACT(YEAR FROM birthdate) &lt; &#39;2017&#39;;<br><br>#查询结果：<br>id      name    hp_max  ...  birthdate<br>--------------------------------------------<br>10000\t夏侯惇\t7350\t...    2016-07-19<br>10003\t牛魔\t8476\t...    2015-11-24<br>10004\t吕布\t7344\t...    2015-12-22<br>10006\t芈月\t6164\t...    2015-12-08<br>......","like_count":5},{"had_liked":false,"id":107416,"user_name":"Fred","can_delete":false,"product_type":"c1","uid":1585721,"ip_address":"","ucode":"DBA8999FE43E4F","user_header":"","comment_is_top":false,"comment_ctime":1561532937,"is_pvip":false,"discussion_count":1,"race_medal":0,"score":"18741402121","product_id":100029501,"comment_content":"SELECT AVG(mp_max) as avg_max FROM hero;<br>SELECT name WHERE YEAR（birthdate）&lt;2017 AND birthdate IS NOT NULL","like_count":4,"discussions":[{"author":{"id":1880782,"avatar":"https://static001.geekbang.org/account/avatar/00/1c/b2/ce/5638be2b.jpg","nickname":"Flychen","note":"","ucode":"4029A8F1D3C361","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":343155,"discussion_content":"year（） 比 extract（） 高效，赞","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1610957908,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":190611,"user_name":"慌张而黑糖","can_delete":false,"product_type":"c1","uid":1638878,"ip_address":"","ucode":"B4416885A301C8","user_header":"https://static001.geekbang.org/account/avatar/00/19/01/de/bf524817.jpg","comment_is_top":false,"comment_ctime":1584672461,"is_pvip":false,"discussion_count":1,"race_medal":0,"score":"14469574349","product_id":100029501,"comment_content":"对于LENGTH函数有点疑问，就是LENGTH函数中一个汉字算三个字符，这里我感觉是三个字节，因为一个utf8字符占三个字节，如果说是三个字符的话那就是占用九个字节了。","like_count":3,"discussions":[{"author":{"id":2814926,"avatar":"","nickname":"Geek_28670d","note":"","ucode":"7BA10C23E56F1E","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":405740,"discussion_content":"汉字本身就是一个字符，作者意思是字符跟字节的关系，不是汉字跟字符的关系","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1634634321,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":110194,"user_name":"大隐-于市","can_delete":false,"product_type":"c1","uid":1012511,"ip_address":"","ucode":"32900EB8286F02","user_header":"https://static001.geekbang.org/account/avatar/00/0f/73/1f/039e46b7.jpg","comment_is_top":false,"comment_ctime":1562205956,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"14447107844","product_id":100029501,"comment_content":"切换数据库的概率很低吧，工作了十年一直被教育不是使用内部函数，因为增加更换数据库的成本，不过一直没见过哪个公司更换数据库。即使是阿里的去ioe那本身也会增加很多开发成本，所有的sql都检查。","like_count":3},{"had_liked":false,"id":107371,"user_name":"Abyssknight","can_delete":false,"product_type":"c1","uid":1336361,"ip_address":"","ucode":"08E8D68E4B76BB","user_header":"https://static001.geekbang.org/account/avatar/00/14/64/29/da537902.jpg","comment_is_top":false,"comment_ctime":1561520797,"is_pvip":false,"replies":[{"id":"63998","content":"Good Job","user_name":"作者回复","user_name_real":"cy","uid":"1306094","ctime":1577607258,"ip_address":"","comment_id":107371,"utype":1}],"discussion_count":2,"race_medal":0,"score":"14446422685","product_id":100029501,"comment_content":"select avg(hp_max) as avg_hp<br>from heros;<br><br>select name, birthdate<br>from heros<br>where birthdate &lt; date(&#39;2017-01-01&#39;);","like_count":3,"discussions":[{"author":{"id":1306094,"avatar":"https://static001.geekbang.org/account/avatar/00/13/ed/ee/c4779b67.jpg","nickname":"cy","note":"","ucode":"50D653399A31F6","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":455490,"discussion_content":"Good Job","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1577607258,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1474214,"avatar":"https://static001.geekbang.org/account/avatar/00/16/7e/a6/4e331ef4.jpg","nickname":"骑行的掌柜J","note":"","ucode":"3163102651C653","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":5800,"discussion_content":"兄弟 你写掉了一个条件  AND birthdate is NOT NULL  在第二题的语句里面","likes_number":1,"is_delete":false,"is_hidden":false,"ctime":1566466278,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":203954,"user_name":"曲颀","can_delete":false,"product_type":"c1","uid":1859612,"ip_address":"","ucode":"BB2C6B4D93B6E5","user_header":"https://static001.geekbang.org/account/avatar/00/1c/60/1c/6fce1419.jpg","comment_is_top":false,"comment_ctime":1586311833,"is_pvip":true,"discussion_count":0,"race_medal":0,"score":"10176246425","product_id":100029501,"comment_content":"SELECT<br>\tavg( hp_max ) AS &#39;最大生命平均值&#39; <br>FROM<br>\theros;<br>\t<br>SELECT<br>\t`name` as &#39;名称&#39;,<br>\tbirthdate as &#39;上线日期&#39;<br>FROM<br>\theros <br>WHERE<br>\tYEAR(birthdate) &lt; 2017<br>AND<br>\tbirthdate is not null;","like_count":2},{"had_liked":false,"id":122845,"user_name":"海洋","can_delete":false,"product_type":"c1","uid":1369704,"ip_address":"","ucode":"F82635CDB2FB93","user_header":"https://static001.geekbang.org/account/avatar/00/14/e6/68/1871d6ba.jpg","comment_is_top":false,"comment_ctime":1565541922,"is_pvip":false,"replies":[{"id":"63534","content":"Good Job","user_name":"作者回复","user_name_real":"cy","uid":"1306094","ctime":1577517172,"ip_address":"","comment_id":122845,"utype":1}],"discussion_count":1,"race_medal":0,"score":"10155476514","product_id":100029501,"comment_content":"作业：<br>SELECT AVG(hp_max) FROM heros;<br>+-------------------+<br>| AVG(hp_max)       |<br>+-------------------+<br>| 6580.478260869565 |<br>+-------------------+<br>1 row in set (0.07 sec)<br><br>-------------------------------------------<br> SELECT name FROM heros WHERE Year(birthdate) &lt; 2017 AND birthdate is NOT NULL;<br>+----------+<br>| name     |<br>+----------+<br>| 夏侯惇   |<br>| 牛魔     |<br>| 吕布     |<br>| 芈月     |<br>| 太乙真人 |<br>| 刘邦     |<br>| 关羽     |<br>| 马可波罗 |<br>| 李元芳   |<br>| 虞姬     |<br>| 成吉思汗 |<br>| 不知火舞 |<br>| 貂蝉     |<br>| 周瑜     |<br>| 张良     |<br>| 钟馗     |<br>| 蔡文姬   |<br>| 花木兰   |<br>| 李白     |<br>| 杨戬     |<br>| 刘备     |<br>| 宫本武藏 |<br>| 娜可露露 |<br>+----------+<br>或者<br>SELECT name FROM heros WHERE DATE(birthdate) &lt;&#39;2017-01-01&#39; AND birthdate is NOT NULL;","like_count":2,"discussions":[{"author":{"id":1306094,"avatar":"https://static001.geekbang.org/account/avatar/00/13/ed/ee/c4779b67.jpg","nickname":"cy","note":"","ucode":"50D653399A31F6","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":462429,"discussion_content":"Good Job","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1577517172,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":107267,"user_name":"啦啦啦","can_delete":false,"product_type":"c1","uid":1131687,"ip_address":"","ucode":"6B12EC90A62525","user_header":"https://static001.geekbang.org/account/avatar/00/11/44/a7/171c1e86.jpg","comment_is_top":false,"comment_ctime":1561509954,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"10151444546","product_id":100029501,"comment_content":"看了今天的课知道了日期比较不用DATE函数不安全，以前都没用过","like_count":2},{"had_liked":false,"id":256302,"user_name":"追风筝的人","can_delete":false,"product_type":"c1","uid":1488020,"ip_address":"","ucode":"2993D60F94C396","user_header":"https://static001.geekbang.org/account/avatar/00/16/b4/94/2796de72.jpg","comment_is_top":false,"comment_ctime":1603596826,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"5898564122","product_id":100029501,"comment_content":"学到了     比如CONCAT()是字符串拼接函数，在 MySQL 和 Oracle 中都有这个函数，但是在这两个 DBMS 中作用却不一样，CONCAT函数在 MySQL 中可以连接多个字符串，而在 Oracle 中CONCAT函数只能连接两个字符串，如果要连接多个字符串就需要用（||）连字符来解决。","like_count":1},{"had_liked":false,"id":111113,"user_name":"Elliot","can_delete":false,"product_type":"c1","uid":1030070,"ip_address":"","ucode":"CC58A6FD2F338C","user_header":"https://static001.geekbang.org/account/avatar/00/0f/b7/b6/17103195.jpg","comment_is_top":false,"comment_ctime":1562478797,"is_pvip":false,"replies":[{"id":"40479","content":"DBMS一般都有自己的方言，不过这些方言都很好理解。比如MySQL可以用LIMIT截取所需的数据行，而Oracle需要使用ROWNUM关键字通过子查询来完成。<br>","user_name":"作者回复","user_name_real":"cy","uid":"1306094","ctime":1562540417,"ip_address":"","comment_id":111113,"utype":1}],"discussion_count":1,"race_medal":0,"score":"5857446093","product_id":100029501,"comment_content":"DBMS 之间的差异性很大，远大于同一个语言不同版本之间的差...<br><br>说明学数据库也难免会遇到各种看似毫无技术含量的坑喽。。。","like_count":1,"discussions":[{"author":{"id":1306094,"avatar":"https://static001.geekbang.org/account/avatar/00/13/ed/ee/c4779b67.jpg","nickname":"cy","note":"","ucode":"50D653399A31F6","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":457235,"discussion_content":"DBMS一般都有自己的方言，不过这些方言都很好理解。比如MySQL可以用LIMIT截取所需的数据行，而Oracle需要使用ROWNUM关键字通过子查询来完成。\n","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1562540417,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":107799,"user_name":"不负","can_delete":false,"product_type":"c1","uid":1238323,"ip_address":"","ucode":"147F5860711811","user_header":"https://static001.geekbang.org/account/avatar/00/12/e5/33/ff5c52ad.jpg","comment_is_top":false,"comment_ctime":1561610974,"is_pvip":true,"replies":[{"id":"39176","content":"正确，你也可以使用YEAR(birthdate)&lt;2017","user_name":"作者回复","user_name_real":"cy","uid":"1306094","ctime":1561686652,"ip_address":"","comment_id":107799,"utype":1}],"discussion_count":1,"race_medal":1,"score":"5856578270","product_id":100029501,"comment_content":"&gt; SELECT ROUND(AVG(hp_max), 2) FROM heros;<br>+-----------------------+<br>| ROUND(AVG(hp_max), 2) |<br>+-----------------------+<br>|               6580.48 |<br>+-----------------------+<br>&gt; SELECT name FROM heros WHERE birthdate IS NOT NULL AND DATE(birthdate)&lt;&#39;2017-01-01&#39;;","like_count":1,"discussions":[{"author":{"id":1306094,"avatar":"https://static001.geekbang.org/account/avatar/00/13/ed/ee/c4779b67.jpg","nickname":"cy","note":"","ucode":"50D653399A31F6","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":455678,"discussion_content":"正确，你也可以使用YEAR(birthdate)&amp;lt;2017","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1561686652,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":107324,"user_name":"圆子蛋","can_delete":false,"product_type":"c1","uid":1585794,"ip_address":"","ucode":"9E8FE5D4DAC79E","user_header":"https://static001.geekbang.org/account/avatar/00/18/32/82/273a44cd.jpg","comment_is_top":false,"comment_ctime":1561514562,"is_pvip":false,"replies":[{"id":"64004","content":"Good Job","user_name":"作者回复","user_name_real":"cy","uid":"1306094","ctime":1577607319,"ip_address":"","comment_id":107324,"utype":1}],"discussion_count":1,"race_medal":0,"score":"5856481858","product_id":100029501,"comment_content":"1. SELECT AVG(max_hp) FROM heros;<br>2. SELECT name,YEAR(birthdate) AS birthdate FROM heros WHERE birthdate is NOT NULL AND YEAR(birthdate)&lt;2017","like_count":1,"discussions":[{"author":{"id":1306094,"avatar":"https://static001.geekbang.org/account/avatar/00/13/ed/ee/c4779b67.jpg","nickname":"cy","note":"","ucode":"50D653399A31F6","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":455467,"discussion_content":"Good Job","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1577607319,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":107211,"user_name":"怀朔","can_delete":false,"product_type":"c1","uid":1006865,"ip_address":"","ucode":"52FAC1C2FD37B6","user_header":"https://static001.geekbang.org/account/avatar/00/0f/5d/11/e1f36640.jpg","comment_is_top":false,"comment_ctime":1561480816,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"5856448112","product_id":100029501,"comment_content":"select avg（ph）from hero<br>","like_count":1},{"had_liked":false,"id":356514,"user_name":"年少挽滑稽世无双","can_delete":false,"product_type":"c1","uid":2962599,"ip_address":"四川","ucode":"793DCBDE25A07B","user_header":"https://static001.geekbang.org/account/avatar/00/2d/34/a7/52c4ea60.jpg","comment_is_top":false,"comment_ctime":1662374095,"is_pvip":true,"discussion_count":0,"race_medal":0,"score":"1662374095","product_id":100029501,"comment_content":"# 计算英雄的最大生命平均值；显示出所有在 2017 年之前上线的英雄，如果英雄没有统计上线日期则不显示。<br>SELECT AVG(hp_max) FROM heros<br><br>SELECT name, birthdate <br>FROM heros <br>WHERE DATE(birthdate)&lt;&#39;2017-01-01&#39; AND birthdate is NOT NULL <br>ORDER BY birthdate","like_count":0},{"had_liked":false,"id":356185,"user_name":"HYH_xzq","can_delete":false,"product_type":"c1","uid":3169198,"ip_address":"广东","ucode":"88F00E94DBDC89","user_header":"https://static001.geekbang.org/account/avatar/00/30/5b/ae/e521269f.jpg","comment_is_top":false,"comment_ctime":1662028698,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1662028698","product_id":100029501,"comment_content":"英雄的最大生命平均值：SELECT AVG(hp_max) FROM heros;<br>所有在2017年之前上线的英雄：SELECT name FROM heros WHERE birthdate YEAR(birthdate) &lt; 2017 AND IS NOT NULL;","like_count":0},{"had_liked":false,"id":327584,"user_name":"aJimmy","can_delete":false,"product_type":"c1","uid":1785118,"ip_address":"","ucode":"282845637394E0","user_header":"https://static001.geekbang.org/account/avatar/00/1b/3d/1e/023bed07.jpg","comment_is_top":false,"comment_ctime":1640182779,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1640182779","product_id":100029501,"comment_content":"本章节给的英雄联盟的表是Mysql的表结构，请给个Oracle表结构？","like_count":0},{"had_liked":false,"id":327131,"user_name":"aJimmy","can_delete":false,"product_type":"c1","uid":1785118,"ip_address":"","ucode":"282845637394E0","user_header":"https://static001.geekbang.org/account/avatar/00/1b/3d/1e/023bed07.jpg","comment_is_top":false,"comment_ctime":1639928958,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1639928958","product_id":100029501,"comment_content":"本章节给的英雄联盟的表是Mysql的吧？有没Oracle数据表结构？我用的是PLSQL连接的Oracle数据库。","like_count":0},{"had_liked":false,"id":301461,"user_name":"Cy23","can_delete":false,"product_type":"c1","uid":1591293,"ip_address":"","ucode":"8DC561C5151758","user_header":"https://static001.geekbang.org/account/avatar/00/18/47/fd/895f0c27.jpg","comment_is_top":false,"comment_ctime":1625707524,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1625707524","product_id":100029501,"comment_content":"SELECT AVG(hp_max)<br>FROM heros<br>WHERE birthdate IS NOT NULL<br>AND DATE(birthdate)&lt; &#39;2017-01-01&#39;","like_count":0},{"had_liked":false,"id":298647,"user_name":"阎晓静","can_delete":false,"product_type":"c1","uid":1395937,"ip_address":"","ucode":"55DA133B3B5E4E","user_header":"https://static001.geekbang.org/account/avatar/00/15/4c/e1/814431e9.jpg","comment_is_top":false,"comment_ctime":1624247626,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1624247626","product_id":100029501,"comment_content":"为什么不建议用sql 函数？不同的DBMS支持的函数不同，相同的函数对应的功能也可能不一致<br>为什么建议遵循大小写规范（系统的-关键字、函数大写，自己定义的-表名、字段名小写）？不同的OS和操作系统对大小写敏感不一致，迁移扩展可能问题。","like_count":0},{"had_liked":false,"id":296701,"user_name":"郁方林","can_delete":false,"product_type":"c1","uid":1130275,"ip_address":"","ucode":"8ABEAFDA815DDE","user_header":"https://static001.geekbang.org/account/avatar/00/11/3f/23/8ff389d2.jpg","comment_is_top":false,"comment_ctime":1623119696,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1623119696","product_id":100029501,"comment_content":"-- 计算英雄的最大生命平均值；<br>SELECT AVG(hp_max) FROM heros<br>-- 显示出所有在 2017 年之前上线的英雄，如果英雄没有统计上线日期则不显示<br>SELECT `name`, YEAR(birthdate) birthdate FROM heros WHERE birthdate &gt; &#39;2017&#39; AND birthdate IS NOT NULL","like_count":0},{"had_liked":false,"id":296277,"user_name":"ss","can_delete":false,"product_type":"c1","uid":1073156,"ip_address":"","ucode":"C1926C165FB8C5","user_header":"http://thirdwx.qlogo.cn/mmopen/vi_32/DYAIOgq83eqibj1G9GJGMXkNAia83ESAqbCTgcIA5UyqUJN27yvXhAgpIeL9UyEkwY1jwsQlnqcv4iasoLdZkBbeA/132","comment_is_top":false,"comment_ctime":1622875266,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1622875266","product_id":100029501,"comment_content":"交作业：<br>select AVG(hp_max)from heros;<br>select name, Year(birthdate) from heros where Year(birthdate)&lt;&#39;2017&#39;;","like_count":0},{"had_liked":false,"id":294135,"user_name":"完美坚持","can_delete":false,"product_type":"c1","uid":1919541,"ip_address":"","ucode":"AE0261D8DDEF64","user_header":"https://static001.geekbang.org/account/avatar/00/1d/4a/35/66caeed9.jpg","comment_is_top":false,"comment_ctime":1621780840,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1621780840","product_id":100029501,"comment_content":"https:&#47;&#47;dev.mysql.com&#47;doc&#47;refman&#47;8.0&#47;en&#47;functions.html<br>这个是mysql中关于sql函数部分的介绍","like_count":0},{"had_liked":false,"id":293010,"user_name":"丁丁历险记","can_delete":false,"product_type":"c1","uid":1661704,"ip_address":"","ucode":"A43829E454C067","user_header":"https://static001.geekbang.org/account/avatar/00/19/5b/08/b0b0db05.jpg","comment_is_top":false,"comment_ctime":1621154573,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1621154573","product_id":100029501,"comment_content":"没必要去学函数，<br>把日期时间类的转时间戳比对即可。<br>数据库做好存储和检索就好，别天天没事搞事搞生态，所谓的函数提升个毛线的代码效率，东一坨西一坨的把事搞得更麻烦。","like_count":0},{"had_liked":false,"id":278981,"user_name":"ADkun","can_delete":false,"product_type":"c1","uid":1236725,"ip_address":"","ucode":"09A4A03FFF610E","user_header":"https://static001.geekbang.org/account/avatar/00/12/de/f5/a9054651.jpg","comment_is_top":false,"comment_ctime":1613520356,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1613520356","product_id":100029501,"comment_content":"SELECT  name, AVG(hp_max), YEAR(birthdate) AS year<br>FROM jeek.heros<br>WHERE birthdate IS NOT NULL AND YEAR(birthdate) &lt; 2017<br>GROUP BY name, year;","like_count":0},{"had_liked":false,"id":274298,"user_name":"Flychen","can_delete":false,"product_type":"c1","uid":1880782,"ip_address":"","ucode":"4029A8F1D3C361","user_header":"https://static001.geekbang.org/account/avatar/00/1c/b2/ce/5638be2b.jpg","comment_is_top":false,"comment_ctime":1610957709,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1610957709","product_id":100029501,"comment_content":"<br>select ROUND(AVG(hp_max),2)<br><br>from heros<br><br>where birthdate &lt; &#39;2017-01-01&#39;<br><br>或 <br><br>select ROUND(AVG(hp_max),2)<br><br>from heros<br><br>where EXTRACT(year FROM birthdate) &lt; &#39;2017&#39;<br><br><br>","like_count":0},{"had_liked":false,"id":274291,"user_name":"Flychen","can_delete":false,"product_type":"c1","uid":1880782,"ip_address":"","ucode":"4029A8F1D3C361","user_header":"https://static001.geekbang.org/account/avatar/00/1c/b2/ce/5638be2b.jpg","comment_is_top":false,"comment_ctime":1610956463,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1610956463","product_id":100029501,"comment_content":"<br>SQL： SELECT * FROM heros WHERE DATE(birthdate)&gt;&#39;2016-10-01&#39; <br><br>  这里日期&#39;2016-10-01&#39; 为什么需要加单引号，试了一下不加单引号出来的值确实不对。<br><br>一直认为加单引号的是字符串呢，什么情况下where值需要加单引号，什么情况下不用加呢？<br>","like_count":0},{"had_liked":false,"id":273343,"user_name":"迷路人","can_delete":false,"product_type":"c1","uid":2007310,"ip_address":"","ucode":"7BC3B50647CF25","user_header":"https://static001.geekbang.org/account/avatar/00/1e/a1/0e/c00a3688.jpg","comment_is_top":false,"comment_ctime":1610541316,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1610541316","product_id":100029501,"comment_content":"有个问题：力扣上的一道题<br>写一条 SQL 查询语句获取每位玩家 第一次登陆平台的日期。<br><br>select player_id  , min(event_date ) as  first_login from Activity  group by player_id ;<br>在分组内比较  最小的event_date ， 同一表内的时间格式都相同，<br>使用 min(Date(event_date ))查询速度是否提升？","like_count":0},{"had_liked":false,"id":266094,"user_name":"song","can_delete":true,"product_type":"c1","uid":1027370,"ip_address":"","ucode":"5B4C2EAC3CB379","user_header":"https://static001.geekbang.org/account/avatar/00/0f/ad/2a/1d3045f1.jpg","comment_is_top":false,"comment_ctime":1607163771,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1607163771","product_id":100029501,"comment_content":"老师，有两个问题：<br>1. 文中说 DATE 日期格式必须是 yyyy-mm-dd 的形式。测试发现 SELECT DATE(&#39;2019&#47;04&#47;01 12:00:05&#39;)，运行结果正常也是 2019-04-01。<br>2. 文中说 CAST 函数在转换数据类型的时候，不会四舍五入。测试发现 SELECT CAST(123.456 AS DECIMAL(8,2))，运行结果为 123.46，怎么不是123.45呀。","like_count":0},{"had_liked":false,"id":264190,"user_name":"novaln🍉","can_delete":false,"product_type":"c1","uid":1231695,"ip_address":"","ucode":"EC544D448DA898","user_header":"https://static001.geekbang.org/account/avatar/00/12/cb/4f/feb5528f.jpg","comment_is_top":false,"comment_ctime":1606376291,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1606376291","product_id":100029501,"comment_content":"SELECT AVG(hp_max) from heros;<br>SELECT * from heros WHERE  DATE(birthdate) &lt; &#39;2017-01-01&#39; AND birthdate IS NOT NULL ","like_count":0},{"had_liked":false,"id":264135,"user_name":"咱是吓大的","can_delete":false,"product_type":"c1","uid":1292324,"ip_address":"","ucode":"A47C6DA5C00C6F","user_header":"https://static001.geekbang.org/account/avatar/00/13/b8/24/039f84a2.jpg","comment_is_top":false,"comment_ctime":1606359958,"is_pvip":true,"discussion_count":0,"race_medal":4,"score":"1606359958","product_id":100029501,"comment_content":"计算英雄的最大生命平均值<br>SELECT ROUND(AVG(hp_max),2) FROM heros<br><br>显示出所有在 2017 年之前上线的英雄<br>SELECT name,birthdate FROM heros WHERE birthdate IS NOT NULL AND YEAR(birthdate) &lt; 2017;","like_count":0},{"had_liked":false,"id":241296,"user_name":"夏天呀","can_delete":false,"product_type":"c1","uid":1673679,"ip_address":"","ucode":"1C5C060C05923B","user_header":"https://static001.geekbang.org/account/avatar/00/19/89/cf/1c7703b1.jpg","comment_is_top":false,"comment_ctime":1597240367,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1597240367","product_id":100029501,"comment_content":"A1:mysql&gt; SELECT AVG(hp_max) FROM heros;<br>A2:mysql&gt; SELECT name FROM heros<br>    -&gt; WHERE (DATE(birthdate)&lt; &#39;2017-01-01&#39;)<br>    -&gt; AND birthdate IS NOT NULL;","like_count":0},{"had_liked":false,"id":239275,"user_name":"Geek_gong1zu","can_delete":false,"product_type":"c1","uid":2086659,"ip_address":"","ucode":"D629A6652AB8E2","user_header":"https://static001.geekbang.org/account/avatar/00/1f/d7/03/db060811.jpg","comment_is_top":false,"comment_ctime":1596473606,"is_pvip":true,"discussion_count":0,"race_medal":0,"score":"1596473606","product_id":100029501,"comment_content":"1、SELECT AVG(hp_max) FROM heros;<br>2、SELECT name FROM heros <br>WHERE DATE((birthdate)&gt;&#39;2017-01-01&#39; AND birthdate IS NOT NULL;","like_count":0},{"had_liked":false,"id":238519,"user_name":"Maske","can_delete":false,"product_type":"c1","uid":1696847,"ip_address":"","ucode":"A19BB41A47E852","user_header":"https://static001.geekbang.org/account/avatar/00/19/e4/4f/df6d810d.jpg","comment_is_top":false,"comment_ctime":1596187490,"is_pvip":true,"discussion_count":0,"race_medal":0,"score":"1596187490","product_id":100029501,"comment_content":"计算英雄的最大生命平均值：<br>SELECT ROUND(AVG(hp_max), 1) FROM  heros;<br>显示出所有在 2017 年之前上线的英雄，如果英雄没有统计上线日期则不显示：<br>SELECT * FROM  heros WHERE YEAR(birthdate) &lt; 2017 ;<br>","like_count":0},{"had_liked":false,"id":236655,"user_name":"Jack Zhang","can_delete":false,"product_type":"c1","uid":1315728,"ip_address":"","ucode":"E3AEAE55A9B16C","user_header":"https://static001.geekbang.org/account/avatar/00/14/13/90/f94a6436.jpg","comment_is_top":false,"comment_ctime":1595492078,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1595492078","product_id":100029501,"comment_content":"计算英雄最大生命平均值：<br>SELECT AVG(hp_max) FROM heros;<br>显示2017年以前上线的英雄，上线日期为空则不显示：<br>SELECT `name`, birthdate FROM heros WHERE DATE(birthdate) &lt; &#39;2017-01-01&#39; AND birthdate IS NOT NULL;","like_count":0},{"had_liked":false,"id":235345,"user_name":"LIKE","can_delete":false,"product_type":"c1","uid":1254252,"ip_address":"","ucode":"9DAB7F9051648A","user_header":"https://static001.geekbang.org/account/avatar/00/13/23/6c/82ba5e1f.jpg","comment_is_top":false,"comment_ctime":1594978871,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1594978871","product_id":100029501,"comment_content":"使用函数还需要留意：<br>1.前文提到的索引失效问题<br>2.函数返回值长度问题，如group_concat，默认长度为1024，<br>SELECT @@global.group_concat_max_len;","like_count":0},{"had_liked":false,"id":227202,"user_name":"糍粑","can_delete":false,"product_type":"c1","uid":1011438,"ip_address":"","ucode":"11609D809D2927","user_header":"https://static001.geekbang.org/account/avatar/00/0f/6e/ee/0ce82b15.jpg","comment_is_top":false,"comment_ctime":1592312935,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1592312935","product_id":100029501,"comment_content":"SELECT AVG(hp_max) from heros;<br>AVG(hp_max)<br>6580.478260869565<br><br>SELECT * FROM heros WHERE YEAR(birthdate) &lt; &#39;2017&#39; AND birthdate IS NOT NULL;<br># id, name, hp_max, hp_growth, hp_start, mp_max, mp_growth, mp_start, attack_max, attack_growth, attack_start, defense_max, defense_growth, defense_start, hp_5s_max, hp_5s_growth, hp_5s_start, mp_5s_max, mp_5s_growth, mp_5s_start, attack_speed_max, attack_range, role_main, role_assist, birthdate<br>&#39;10000&#39;, &#39;夏侯惇&#39;, &#39;7350&#39;, &#39;288.8&#39;, &#39;3307&#39;, &#39;1746&#39;, &#39;94&#39;, &#39;430&#39;, &#39;321&#39;, &#39;11.57&#39;, &#39;159&#39;, &#39;397&#39;, &#39;21.14&#39;, &#39;101&#39;, &#39;98&#39;, &#39;3.357&#39;, &#39;51&#39;, &#39;37&#39;, &#39;1.571&#39;, &#39;15&#39;, &#39;0&#39;, &#39;近战&#39;, &#39;坦克&#39;, &#39;战士&#39;, &#39;2016-07-19&#39;<br>&#39;10003&#39;, &#39;牛魔&#39;, &#39;8476&#39;, &#39;352.8&#39;, &#39;3537&#39;, &#39;1926&#39;, &#39;104&#39;, &#39;470&#39;, &#39;273&#39;, &#39;8.357&#39;, &#39;156&#39;, &#39;394&#39;, &#39;20.36&#39;, &#39;109&#39;, &#39;117&#39;, &#39;4.214&#39;, &#39;58&#39;, &#39;42&#39;, &#39;1.786&#39;, &#39;17&#39;, &#39;0&#39;, &#39;近战&#39;, &#39;坦克&#39;, &#39;辅助&#39;, &#39;2015-11-24&#39;<br>&#39;10004&#39;, &#39;吕布&#39;, &#39;7344&#39;, &#39;270&#39;, &#39;3564&#39;, &#39;0&#39;, &#39;0&#39;, &#39;0&#39;, &#39;343&#39;, &#39;12.36&#39;, &#39;170&#39;, &#39;390&#39;, &#39;20.79&#39;, &#39;99&#39;, &#39;97&#39;, &#39;3.071&#39;, &#39;54&#39;, &#39;0&#39;, &#39;0&#39;, &#39;0&#39;, &#39;0&#39;, &#39;近战&#39;, &#39;战士&#39;, &#39;坦克&#39;, &#39;2015-12-22&#39;<br>&#39;10006&#39;, &#39;芈月&#39;, &#39;6164&#39;, &#39;281.5&#39;, &#39;3105&#39;, &#39;100&#39;, &#39;0&#39;, &#39;100&#39;, &#39;289&#39;, &#39;9.786&#39;, &#39;152&#39;, &#39;361&#39;, &#39;19.5&#39;, &#39;88&#39;, &#39;77&#39;, &#39;2.357&#39;, &#39;44&#39;, &#39;0&#39;, &#39;0&#39;, &#39;0&#39;, &#39;0&#39;, &#39;远程&#39;, &#39;法师&#39;, &#39;坦克&#39;, &#39;2015-12-08&#39;<br>&#39;10011&#39;, &#39;太乙真人&#39;, &#39;6835&#39;, &#39;242.3&#39;, &#39;3443&#39;, &#39;1680&#39;, &#39;90&#39;, &#39;420&#39;, &#39;284&#39;, &#39;9.286&#39;, &#39;154&#39;, &#39;396&#39;, &#39;21.57&#39;, &#39;94&#39;, &#39;86&#39;, &#39;2.643&#39;, &#39;49&#39;, &#39;35&#39;, &#39;1.429&#39;, &#39;15&#39;, &#39;0&#39;, &#39;近战&#39;, &#39;辅助&#39;, &#39;坦克&#39;, &#39;2016-11-24&#39;<br>&#39;10014&#39;, &#39;刘邦&#39;, &#39;8073&#39;, &#39;336&#39;, &#39;3369&#39;, &#39;1940&#39;, &#39;105&#39;, &#39;470&#39;, &#39;302&#39;, &#39;10.29&#39;, &#39;158&#39;, &#39;504&#39;, &#39;27.07&#39;, &#39;125&#39;, &#39;117&#39;, &#39;4.214&#39;, &#39;58&#39;, &#39;42&#39;, &#39;1.786&#39;, &#39;17&#39;, &#39;0&#39;, &#39;近战&#39;, &#39;坦克&#39;, &#39;辅助&#39;, &#39;2016-04-26&#39;<br>...... 22 rows in total","like_count":0},{"had_liked":false,"id":223751,"user_name":"Fan","can_delete":false,"product_type":"c1","uid":1168774,"ip_address":"","ucode":"9A5B148A7E453A","user_header":"https://static001.geekbang.org/account/avatar/00/11/d5/86/5b1ff7d9.jpg","comment_is_top":false,"comment_ctime":1591173370,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1591173370","product_id":100029501,"comment_content":"SELECT * FROM heros.heros<br>WHERE YEAR(birthdate) &lt; 2017<br>ORDER BY id DESC<br>LIMIT 20;","like_count":0},{"had_liked":false,"id":192294,"user_name":"Amo,","can_delete":false,"product_type":"c1","uid":1675087,"ip_address":"","ucode":"B77CBE5C61CDEB","user_header":"https://static001.geekbang.org/account/avatar/00/19/8f/4f/d42fdb9c.jpg","comment_is_top":false,"comment_ctime":1584845707,"is_pvip":false,"replies":[{"id":"82657","content":"加油~","user_name":"作者回复","user_name_real":"cy","uid":"1306094","ctime":1591443587,"ip_address":"","comment_id":192294,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1584845707","product_id":100029501,"comment_content":"今日打卡sql函数","like_count":0,"discussions":[{"author":{"id":1306094,"avatar":"https://static001.geekbang.org/account/avatar/00/13/ed/ee/c4779b67.jpg","nickname":"cy","note":"","ucode":"50D653399A31F6","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":488362,"discussion_content":"加油~","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1591443587,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":190587,"user_name":"慌张而黑糖","can_delete":false,"product_type":"c1","uid":1638878,"ip_address":"","ucode":"B4416885A301C8","user_header":"https://static001.geekbang.org/account/avatar/00/19/01/de/bf524817.jpg","comment_is_top":false,"comment_ctime":1584670886,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1584670886","product_id":100029501,"comment_content":"对于round函数有点疑问，我测试的时候，发现他好像不是按照四舍五入的规则，而是按照四舍六入五凑偶的规则进行保留的，mysql版本8.0.19","like_count":0},{"had_liked":false,"id":188387,"user_name":"A   闫东阳","can_delete":false,"product_type":"c1","uid":1850211,"ip_address":"","ucode":"24679CB9F41B59","user_header":"https://static001.geekbang.org/account/avatar/00/1c/3b/63/0f2d00ed.jpg","comment_is_top":false,"comment_ctime":1584347520,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1584347520","product_id":100029501,"comment_content":"SELECT AVG（hp_max）,name FROM heros  WHERE birthdate is not null AND  YEAR（birthdate） &lt;  &#39;2017&#39;","like_count":0},{"had_liked":false,"id":187396,"user_name":"Cc","can_delete":false,"product_type":"c1","uid":1690957,"ip_address":"","ucode":"67DC6C5987ED5C","user_header":"https://static001.geekbang.org/account/avatar/00/19/cd/4d/b5ce478c.jpg","comment_is_top":false,"comment_ctime":1584100334,"is_pvip":false,"discussion_count":1,"race_medal":0,"score":"1584100334","product_id":100029501,"comment_content":"SELECT `name`, MAX(hp_max)<br>FROM heros<br>WHERE hp_max = MAX(hp_max);<br>为什么这样的执行结果没有数据。我是初学者，按照的逻辑，在第二个步骤判断 hp_max = MAX(hp_max);不会先计算MAX(hp_max)然后筛选嘛？","like_count":0,"discussions":[{"author":{"id":2882440,"avatar":"https://static001.geekbang.org/account/avatar/00/2b/fb/88/00cb17bf.jpg","nickname":"潜龙","note":"","ucode":"5B77E245591D7E","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":543534,"discussion_content":"where 子句里不能用max,min等一切函数","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1641197714,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":185387,"user_name":"Asx","can_delete":false,"product_type":"c1","uid":1096749,"ip_address":"","ucode":"F12D31F72B1378","user_header":"https://static001.geekbang.org/account/avatar/00/10/bc/2d/2f676838.jpg","comment_is_top":false,"comment_ctime":1583572086,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1583572086","product_id":100029501,"comment_content":"作业：<br>select name,birthdate from heros<br>    -&gt; where date(birthdate)&lt;&#39;2017-01-01&#39; <br>    -&gt; order by birthdate;","like_count":0},{"had_liked":false,"id":178499,"user_name":"David.cui","can_delete":false,"product_type":"c1","uid":1302228,"ip_address":"","ucode":"AB46F310403612","user_header":"https://static001.geekbang.org/account/avatar/00/13/de/d4/b83c4185.jpg","comment_is_top":false,"comment_ctime":1581715229,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1581715229","product_id":100029501,"comment_content":"。大部分 DBMS 会有自己特定的函数，这就意味着采用 SQL 函数的代码可移植性是很差的，因此在使用函数的时候需要特别注意。<br>_-__---------------------------------------------<br>开发的人哪里会考虑这些？","like_count":0},{"had_liked":false,"id":178117,"user_name":"萌面赵先生","can_delete":false,"product_type":"c1","uid":1170379,"ip_address":"","ucode":"CC51AB1C925E13","user_header":"https://static001.geekbang.org/account/avatar/00/11/db/cb/58f4b5d2.jpg","comment_is_top":false,"comment_ctime":1581589653,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1581589653","product_id":100029501,"comment_content":"SELECT name, EXTRACT(YEAR FROM birthdate)<br>FROM heros<br>WHERE birthdate IS NOT NULL <br>AND EXTRACT(YEAR FROM birthdate) &lt; 2017;","like_count":0},{"had_liked":false,"id":175229,"user_name":"大猫当了个当","can_delete":false,"product_type":"c1","uid":1812021,"ip_address":"","ucode":"4182BF6E3B86A5","user_header":"https://static001.geekbang.org/account/avatar/00/1b/a6/35/52a6551a.jpg","comment_is_top":false,"comment_ctime":1580624265,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1580624265","product_id":100029501,"comment_content":"&#47;&#47;  最大生命平均值<br>SELECT AVG(hp_max) FROM heros<br><br><br>&#47;&#47;  查询2017年之前上线英雄  上线时间为空的不显示<br>SELECT name ,EXTRACT(YEAR FROM birthdate) AS &#39;上线年份&#39; FROM heros WHERE DATE(birthdate)&lt;&#39;2017-01-01&#39; AND birthdate is NOT NULL<br>","like_count":0},{"had_liked":false,"id":174787,"user_name":"大猫当了个当","can_delete":false,"product_type":"c1","uid":1812021,"ip_address":"","ucode":"4182BF6E3B86A5","user_header":"https://static001.geekbang.org/account/avatar/00/1b/a6/35/52a6551a.jpg","comment_is_top":false,"comment_ctime":1580385586,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1580385586","product_id":100029501,"comment_content":"感谢老师","like_count":0},{"had_liked":false,"id":166888,"user_name":"行则将至","can_delete":false,"product_type":"c1","uid":1542987,"ip_address":"","ucode":"DB972F2DF059C4","user_header":"https://static001.geekbang.org/account/avatar/00/17/8b/4b/fa52d222.jpg","comment_is_top":false,"comment_ctime":1577624506,"is_pvip":false,"discussion_count":0,"race_medal":1,"score":"1577624506","product_id":100029501,"comment_content":"1 .老师，结尾总结的地方，您说SQL语句要以  ;  结尾。但是，映射框架使用ibatis的时候，如果DBMS是oracle时，加分号会报错的<br>2 .另外一个，关于区分大小写的问题，我们公司的应用都是部署在linux上，数据库名都是小写，ibatis都是大写，没有报过错啊。这是ibatis做的工作吗?","like_count":0},{"had_liked":false,"id":166887,"user_name":"行则将至","can_delete":false,"product_type":"c1","uid":1542987,"ip_address":"","ucode":"DB972F2DF059C4","user_header":"https://static001.geekbang.org/account/avatar/00/17/8b/4b/fa52d222.jpg","comment_is_top":false,"comment_ctime":1577624318,"is_pvip":false,"discussion_count":0,"race_medal":1,"score":"1577624318","product_id":100029501,"comment_content":"老师，请教一个问题。对于having不能使用别名的问题。如果对于筛选结果有再筛选的需求，应该怎么做呢？比如，对于求完数量的结果，对该结果进行再筛选。我现在都是select count(字段) from 表名 group by 字段  having count(字段) &gt; 2，这么写，可以实现效果，但总感觉不太美观呢","like_count":0},{"had_liked":false,"id":164559,"user_name":"爬行的蜗牛","can_delete":false,"product_type":"c1","uid":1033956,"ip_address":"","ucode":"6623B62DE63CE9","user_header":"http://thirdwx.qlogo.cn/mmopen/vi_32/QD6bf8hkS5dHrabdW7M7Oo9An1Oo3QSxqoySJMDh7GTraxFRX77VZ2HZ13x3R4EVYddIGXicRRDAc7V9z5cLDlA/132","comment_is_top":false,"comment_ctime":1577026842,"is_pvip":false,"replies":[{"id":"62570","content":"正确，如果是计算英雄的最大生命平均值：<br>SELECT AVG(hp_max) FROM heros;","user_name":"作者回复","user_name_real":"cy","uid":"1306094","ctime":1577068345,"ip_address":"","comment_id":164559,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1577026842","product_id":100029501,"comment_content":"SELECT name,  hp_max<br>FROM heros<br>WHERE DATE (birthdate) &lt; &#39;2017-1-1&#39;  AND birthdate IS NOT NULL;","like_count":0,"discussions":[{"author":{"id":1306094,"avatar":"https://static001.geekbang.org/account/avatar/00/13/ed/ee/c4779b67.jpg","nickname":"cy","note":"","ucode":"50D653399A31F6","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":478815,"discussion_content":"正确，如果是计算英雄的最大生命平均值：\nSELECT AVG(hp_max) FROM heros;","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1577068345,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":164479,"user_name":"爬行的蜗牛","can_delete":false,"product_type":"c1","uid":1033956,"ip_address":"","ucode":"6623B62DE63CE9","user_header":"http://thirdwx.qlogo.cn/mmopen/vi_32/QD6bf8hkS5dHrabdW7M7Oo9An1Oo3QSxqoySJMDh7GTraxFRX77VZ2HZ13x3R4EVYddIGXicRRDAc7V9z5cLDlA/132","comment_is_top":false,"comment_ctime":1577003580,"is_pvip":false,"replies":[{"id":"62560","content":"正确，如果显示英雄最大生命平均值，则是 SELECT AVG(hp_max) FROM heros;","user_name":"作者回复","user_name_real":"cy","uid":"1306094","ctime":1577068020,"ip_address":"","comment_id":164479,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1577003580","product_id":100029501,"comment_content":"SELECT name,  hp_max<br>FROM heros<br>WHERE DATE (birthdate) &lt; &#39;2017-1-1&#39;  AND birthdate IS NOT NULL;","like_count":0,"discussions":[{"author":{"id":1306094,"avatar":"https://static001.geekbang.org/account/avatar/00/13/ed/ee/c4779b67.jpg","nickname":"cy","note":"","ucode":"50D653399A31F6","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":478784,"discussion_content":"正确，如果显示英雄最大生命平均值，则是 SELECT AVG(hp_max) FROM heros;","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1577068020,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":161752,"user_name":"高泽林","can_delete":false,"product_type":"c1","uid":1764725,"ip_address":"","ucode":"DE54EBFFF11265","user_header":"http://thirdwx.qlogo.cn/mmopen/vi_32/AGicQgKibwja1SxkQ7oXQE8hYH7yCpiaicNHw3qZRuNB81aVDOQm9P1zd5F75Jbtv66G15D6ZjbbqfnoETR4321Zdw/132","comment_is_top":false,"comment_ctime":1576316450,"is_pvip":false,"replies":[{"id":"62636","content":"SQL正确","user_name":"作者回复","user_name_real":"cy","uid":"1306094","ctime":1577079375,"ip_address":"","comment_id":161752,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1576316450","product_id":100029501,"comment_content":"计算英雄的最大生命平均值：<br>SELECT AVG(hp_max) FROM heros;<br><br>显示所有在2017年之前上线的英雄：<br>SELECT name FROM heros WHERE birthdate IS NOT NULL AND YEAR(birthdate) &lt; 2017;","like_count":0,"discussions":[{"author":{"id":1306094,"avatar":"https://static001.geekbang.org/account/avatar/00/13/ed/ee/c4779b67.jpg","nickname":"cy","note":"","ucode":"50D653399A31F6","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":477842,"discussion_content":"SQL正确","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1577079375,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":161238,"user_name":"taoist","can_delete":false,"product_type":"c1","uid":1195004,"ip_address":"","ucode":"D70AFE25CD8F10","user_header":"https://static001.geekbang.org/account/avatar/00/12/3b/fc/04a75cd0.jpg","comment_is_top":false,"comment_ctime":1576153938,"is_pvip":true,"replies":[{"id":"62638","content":"两个SQL都正确，第一个SQL还对平均值进行了四舍五入取整","user_name":"作者回复","user_name_real":"cy","uid":"1306094","ctime":1577079433,"ip_address":"","comment_id":161238,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1576153938","product_id":100029501,"comment_content":"#MariaDB:<br><br>#英雄的最大生命平均值:<br>SELECT  ROUND(AVG(hp_max)) as avg_hp FROM heros;<br><br>#显示出所有在 2017 年之前上线的英雄:<br>SELECT name,birthdate FROM heros WHERE   EXTRACT(YEAR FROM birthdate) &lt; &#39;2017&#39;;","like_count":0,"discussions":[{"author":{"id":1306094,"avatar":"https://static001.geekbang.org/account/avatar/00/13/ed/ee/c4779b67.jpg","nickname":"cy","note":"","ucode":"50D653399A31F6","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":477653,"discussion_content":"两个SQL都正确，第一个SQL还对平均值进行了四舍五入取整","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1577079433,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":160566,"user_name":"Geek_d3a509","can_delete":false,"product_type":"c1","uid":1765573,"ip_address":"","ucode":"8A40A85D4D1A73","user_header":"","comment_is_top":false,"comment_ctime":1575976258,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1575976258","product_id":100029501,"comment_content":"SELECT AVG(hp_max) FROM heros;<br>SELECT name FROM heros WHERE birthdate IS NOT NULL AND DATE(birthdate)&lt;&#39;2017-01-01&#39;;","like_count":0},{"had_liked":false,"id":150378,"user_name":"王加武","can_delete":false,"product_type":"c1","uid":1665471,"ip_address":"","ucode":"DDCFE578C6C428","user_header":"https://static001.geekbang.org/account/avatar/00/19/69/bf/50a824a4.jpg","comment_is_top":false,"comment_ctime":1573524344,"is_pvip":false,"replies":[{"id":"62671","content":"加油 SQL正确，整理的不错","user_name":"作者回复","user_name_real":"cy","uid":"1306094","ctime":1577082709,"ip_address":"","comment_id":150378,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1573524344","product_id":100029501,"comment_content":"第一题：计算最大生命值的平均值<br>mysql&gt; SELECT AVG(hp_max)<br>    -&gt; FROM heros；<br>第二题：计算在2017年之前上线的英雄，如果不存在，那么就不显示<br>mysql&gt; SELECT *<br>    -&gt; FROM heros<br>    -&gt; WHERE YEAR(birthdate) &lt; &#39;2017&#39; AND birthdate IS NOT NULL;<br>根据老师所讲的，所有的关键字和函数都尽量大写，其他的都小写，这是规范。<br>今天学习了几种比较常用的函数的类型：<br>日期函数<br>算数函数<br>字符串函数<br><br>在写查询语句的时候应该注意安全性的问题，有的语句虽然能执行出来，但是存在一些不安全的因素<br>在写SQL函数的时候，应该注意版本问题<br>最后就是大小写的规范！","like_count":0,"discussions":[{"author":{"id":1306094,"avatar":"https://static001.geekbang.org/account/avatar/00/13/ed/ee/c4779b67.jpg","nickname":"cy","note":"","ucode":"50D653399A31F6","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":474141,"discussion_content":"加油 SQL正确，整理的不错","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1577082709,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":149016,"user_name":"丁丁历险记","can_delete":false,"product_type":"c1","uid":1661704,"ip_address":"","ucode":"A43829E454C067","user_header":"https://static001.geekbang.org/account/avatar/00/19/5b/08/b0b0db05.jpg","comment_is_top":false,"comment_ctime":1573127768,"is_pvip":false,"replies":[{"id":"62677","content":"嗯 一般不用这个","user_name":"作者回复","user_name_real":"cy","uid":"1306094","ctime":1577082876,"ip_address":"","comment_id":149016,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1573127768","product_id":100029501,"comment_content":"坚决不用sql 日期函数的路过。","like_count":0,"discussions":[{"author":{"id":1306094,"avatar":"https://static001.geekbang.org/account/avatar/00/13/ed/ee/c4779b67.jpg","nickname":"cy","note":"","ucode":"50D653399A31F6","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":473708,"discussion_content":"嗯 一般不用这个","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1577082876,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":149015,"user_name":"丁丁历险记","can_delete":false,"product_type":"c1","uid":1661704,"ip_address":"","ucode":"A43829E454C067","user_header":"https://static001.geekbang.org/account/avatar/00/19/5b/08/b0b0db05.jpg","comment_is_top":false,"comment_ctime":1573127673,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1573127673","product_id":100029501,"comment_content":"偶尔用一下，group_concat   <br>其它基本没用过。<br>日期转为时间戳，避开无聊的sql 函数。","like_count":0},{"had_liked":false,"id":144918,"user_name":"扶幽","can_delete":false,"product_type":"c1","uid":1322612,"ip_address":"","ucode":"1400EDFF8970D3","user_header":"https://static001.geekbang.org/account/avatar/00/14/2e/74/88c613e0.jpg","comment_is_top":false,"comment_ctime":1572093084,"is_pvip":false,"replies":[{"id":"62693","content":"1）正确<br>2） YEAR(birthdate)","user_name":"作者回复","user_name_real":"cy","uid":"1306094","ctime":1577084704,"ip_address":"","comment_id":144918,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1572093084","product_id":100029501,"comment_content":"练习：<br>1) select AVG(hp_max) from heros;<br>2) select name, YEAR(birth_date) as birthdate from heros where birthdate is not null AND birthdate&lt;&#39;2017&#39;;","like_count":0,"discussions":[{"author":{"id":1306094,"avatar":"https://static001.geekbang.org/account/avatar/00/13/ed/ee/c4779b67.jpg","nickname":"cy","note":"","ucode":"50D653399A31F6","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":472165,"discussion_content":"1）正确\n2） YEAR(birthdate)","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1577084704,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":142490,"user_name":"Coool","can_delete":false,"product_type":"c1","uid":1701702,"ip_address":"","ucode":"1D1AB3270B02B9","user_header":"https://static001.geekbang.org/account/avatar/00/19/f7/46/209ca424.jpg","comment_is_top":false,"comment_ctime":1571379312,"is_pvip":false,"replies":[{"id":"62780","content":"正确","user_name":"作者回复","user_name_real":"cy","uid":"1306094","ctime":1577092234,"ip_address":"","comment_id":142490,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1571379312","product_id":100029501,"comment_content":"计算英雄的最大生命平均值：<br>SELECT AVG(hp_max) FROM heros;<br>显示出所有在 2017 年之前上线的英雄，如果英雄没有统上线时间则不显示：<br>SELECT * FROM heros WHERE birthdate is not null and DATE(birthdate)&lt;&#39;2017-01-01&#39;；","like_count":0,"discussions":[{"author":{"id":1306094,"avatar":"https://static001.geekbang.org/account/avatar/00/13/ed/ee/c4779b67.jpg","nickname":"cy","note":"","ucode":"50D653399A31F6","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":471147,"discussion_content":"正确","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1577092234,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":142113,"user_name":"半瓶醋","can_delete":false,"product_type":"c1","uid":1282746,"ip_address":"","ucode":"8C898E244D0417","user_header":"https://static001.geekbang.org/account/avatar/00/13/92/ba/9833f06f.jpg","comment_is_top":false,"comment_ctime":1571296296,"is_pvip":true,"replies":[{"id":"62706","content":"直接用YEAR（）函数进行判断可以，结果也是正确的","user_name":"作者回复","user_name_real":"cy","uid":"1306094","ctime":1577085544,"ip_address":"","comment_id":142113,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1571296296","product_id":100029501,"comment_content":"SELECT AVG(hp_max) as &#39;最大生命平均值&#39;<br>from heros;<br><br>SELECT name,hp_max,mp_max,YEAR(birthdate)<br>FROM heros<br>WHERE YEAR(birthdate) &lt; &#39;2017&#39;;<br>第二道题我没有加is not null 的判断，直接用YEAR（）函数进行判断的话可不可以呢？","like_count":0,"discussions":[{"author":{"id":1306094,"avatar":"https://static001.geekbang.org/account/avatar/00/13/ed/ee/c4779b67.jpg","nickname":"cy","note":"","ucode":"50D653399A31F6","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":470990,"discussion_content":"直接用YEAR（）函数进行判断可以，结果也是正确的","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1577085544,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":140718,"user_name":"右耳朵猫咪","can_delete":false,"product_type":"c1","uid":1014984,"ip_address":"","ucode":"3AB186CC780FBB","user_header":"https://static001.geekbang.org/account/avatar/00/0f/7c/c8/8627f5c1.jpg","comment_is_top":false,"comment_ctime":1571037648,"is_pvip":true,"discussion_count":0,"race_medal":0,"score":"1571037648","product_id":100029501,"comment_content":"文中说&quot;因为很多时候你无法确认 birthdate 的数据类型是字符串，还是datetime类型&quot;。为什么无法确认类型呢，查看表中字段类型是很简单的事呀？难道作者不是这个意思？望指教。","like_count":0},{"had_liked":false,"id":137503,"user_name":"尔冬橙","can_delete":false,"product_type":"c1","uid":1225224,"ip_address":"","ucode":"0B013A49BC18DA","user_header":"https://static001.geekbang.org/account/avatar/00/12/b2/08/92f42622.jpg","comment_is_top":false,"comment_ctime":1569755724,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1569755724","product_id":100029501,"comment_content":"老师，可以讲一下mysql递归查询么，只知道上级部门id，如何查询某个部门的所有子部门","like_count":0},{"had_liked":false,"id":129773,"user_name":"Serendipity","can_delete":false,"product_type":"c1","uid":1370694,"ip_address":"","ucode":"E9C7B39BD8DCCD","user_header":"https://static001.geekbang.org/account/avatar/00/14/ea/46/9c9808a9.jpg","comment_is_top":false,"comment_ctime":1567246281,"is_pvip":false,"replies":[{"id":"62735","content":"正确","user_name":"作者回复","user_name_real":"cy","uid":"1306094","ctime":1577087427,"ip_address":"","comment_id":129773,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1567246281","product_id":100029501,"comment_content":"SELECT AVG(hp_max) FROM heros<br>SELECT name, YEAR(birthdate) FROM heros WHERE YEAR(birthdate)&lt;2017 AND birthdate IS NOT NULL","like_count":0,"discussions":[{"author":{"id":1306094,"avatar":"https://static001.geekbang.org/account/avatar/00/13/ed/ee/c4779b67.jpg","nickname":"cy","note":"","ucode":"50D653399A31F6","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":465639,"discussion_content":"正确","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1577087427,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":129772,"user_name":"Serendipity","can_delete":false,"product_type":"c1","uid":1370694,"ip_address":"","ucode":"E9C7B39BD8DCCD","user_header":"https://static001.geekbang.org/account/avatar/00/14/ea/46/9c9808a9.jpg","comment_is_top":false,"comment_ctime":1567246195,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1567246195","product_id":100029501,"comment_content":"SELECT AVG(hp_max) FROM heros<br><br>SELECT name, YEAR(birthdate) FROM heros WHERE birthdate IS NOT NULL<br>","like_count":0},{"had_liked":false,"id":125101,"user_name":"Leon📷","can_delete":false,"product_type":"c1","uid":1219496,"ip_address":"","ucode":"B9BBD1EFAAE5A2","user_header":"https://static001.geekbang.org/account/avatar/00/12/9b/a8/6a391c66.jpg","comment_is_top":false,"comment_ctime":1566086479,"is_pvip":false,"replies":[{"id":"63518","content":"慢慢来","user_name":"作者回复","user_name_real":"cy","uid":"1306094","ctime":1577516387,"ip_address":"","comment_id":125101,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1566086479","product_id":100029501,"comment_content":"想起之前从mysql时间戳提取日期，都是用select from_unixtimestamp(%%%%)里面一堆参数，每次都要去记的笔记里找（参数太多记不住），我想扇自己一耳光","like_count":0,"discussions":[{"author":{"id":1306094,"avatar":"https://static001.geekbang.org/account/avatar/00/13/ed/ee/c4779b67.jpg","nickname":"cy","note":"","ucode":"50D653399A31F6","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":463433,"discussion_content":"慢慢来","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1577516387,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":121479,"user_name":"冲","can_delete":false,"product_type":"c1","uid":1149914,"ip_address":"","ucode":"4191C8A4DF3840","user_header":"http://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTIk46cor5XVFTPZbPOnb7pViabgy450pobo46hRHFQz5nR5ocYRKIzC8vShic36vwa553H4Vj50x5wA/132","comment_is_top":false,"comment_ctime":1565144811,"is_pvip":false,"replies":[{"id":"63571","content":"Good Job","user_name":"作者回复","user_name_real":"cy","uid":"1306094","ctime":1577518537,"ip_address":"","comment_id":121479,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1565144811","product_id":100029501,"comment_content":"SELECT name,AVG(hp_max) from heros WHERE DATE(birthdate)&lt;&#39;2017-01-01&#39; and birthdate is not null","like_count":0,"discussions":[{"author":{"id":1306094,"avatar":"https://static001.geekbang.org/account/avatar/00/13/ed/ee/c4779b67.jpg","nickname":"cy","note":"","ucode":"50D653399A31F6","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":461807,"discussion_content":"Good Job","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1577518537,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":119018,"user_name":"爱吃锅巴的沐泡","can_delete":false,"product_type":"c1","uid":1244560,"ip_address":"","ucode":"27451E4F1A22D4","user_header":"https://static001.geekbang.org/account/avatar/00/12/fd/90/ae39017f.jpg","comment_is_top":false,"comment_ctime":1564487859,"is_pvip":false,"replies":[{"id":"63613","content":"group by子句中可以使用DATE()函数，但是GROUP BY子句后面不能使用列的别名，可以看下SQL执行的顺序：<br>SELECT DISTINCT player_id, player_name, count(*) as num #顺序5<br>FROM player JOIN team ON player.team_id = team.team_id #顺序1<br>WHERE height &gt; 1.80 #顺序2<br>GROUP BY player.team_id #顺序3<br>HAVING num &gt; 2 #顺序4<br>ORDER BY num DESC #顺序6<br>LIMIT 2 #顺序7<br><br>","user_name":"作者回复","user_name_real":"cy","uid":"1306094","ctime":1577524465,"ip_address":"","comment_id":119018,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1564487859","product_id":100029501,"comment_content":"老师，有个问题？<br>在group by子句中可以直接使用列的别名嘛？<br>在group by子句中可以使用DATE()函数嘛？","like_count":0,"discussions":[{"author":{"id":1306094,"avatar":"https://static001.geekbang.org/account/avatar/00/13/ed/ee/c4779b67.jpg","nickname":"cy","note":"","ucode":"50D653399A31F6","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":460708,"discussion_content":"group by子句中可以使用DATE()函数，但是GROUP BY子句后面不能使用列的别名，可以看下SQL执行的顺序：\nSELECT DISTINCT player_id, player_name, count(*) as num #顺序5\nFROM player JOIN team ON player.team_id = team.team_id #顺序1\nWHERE height &amp;gt; 1.80 #顺序2\nGROUP BY player.team_id #顺序3\nHAVING num &amp;gt; 2 #顺序4\nORDER BY num DESC #顺序6\nLIMIT 2 #顺序7\n\n","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1577524465,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":118927,"user_name":"Leon📷","can_delete":false,"product_type":"c1","uid":1219496,"ip_address":"","ucode":"B9BBD1EFAAE5A2","user_header":"https://static001.geekbang.org/account/avatar/00/12/9b/a8/6a391c66.jpg","comment_is_top":false,"comment_ctime":1564470249,"is_pvip":false,"replies":[{"id":"63612","content":"对 需要注意的地方","user_name":"作者回复","user_name_real":"cy","uid":"1306094","ctime":1577521128,"ip_address":"","comment_id":118927,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1564470249","product_id":100029501,"comment_content":"如果对索引做函数操作会导致索引无效，这个也是注意点吧","like_count":0,"discussions":[{"author":{"id":1306094,"avatar":"https://static001.geekbang.org/account/avatar/00/13/ed/ee/c4779b67.jpg","nickname":"cy","note":"","ucode":"50D653399A31F6","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":460667,"discussion_content":"对 需要注意的地方","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1577521128,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":115708,"user_name":"Ronnyz","can_delete":false,"product_type":"c1","uid":1488280,"ip_address":"","ucode":"9F34527B1D343D","user_header":"https://static001.geekbang.org/account/avatar/00/16/b5/98/ffaf2aca.jpg","comment_is_top":false,"comment_ctime":1563702478,"is_pvip":false,"replies":[{"id":"63656","content":"正确","user_name":"作者回复","user_name_real":"cy","uid":"1306094","ctime":1577526733,"ip_address":"","comment_id":115708,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1563702478","product_id":100029501,"comment_content":"作业：<br>SELECT AVG(hp_max) FROM heros;<br>SELECT name, birthdate FROM heros WHERE YEAR(birthdate) &lt; 2017 AND birthdate IS NOT NULL;","like_count":0,"discussions":[{"author":{"id":1306094,"avatar":"https://static001.geekbang.org/account/avatar/00/13/ed/ee/c4779b67.jpg","nickname":"cy","note":"","ucode":"50D653399A31F6","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":459243,"discussion_content":"正确","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1577526733,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":114554,"user_name":"蓝影闪电","can_delete":false,"product_type":"c1","uid":1276629,"ip_address":"","ucode":"0B7A42D79558E7","user_header":"https://static001.geekbang.org/account/avatar/00/13/7a/d5/dbcaadf0.jpg","comment_is_top":false,"comment_ctime":1563334710,"is_pvip":false,"replies":[{"id":"63689","content":"正确","user_name":"作者回复","user_name_real":"cy","uid":"1306094","ctime":1577528308,"ip_address":"","comment_id":114554,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1563334710","product_id":100029501,"comment_content":"SELECT AVG(hp_max) FROM heros;<br><br>SELECT name FROM heros<br>WHERE YEAR(birthdate)&lt;&#39;2017&#39; AND birthdate IS NOT NULL;<br>","like_count":0,"discussions":[{"author":{"id":1306094,"avatar":"https://static001.geekbang.org/account/avatar/00/13/ed/ee/c4779b67.jpg","nickname":"cy","note":"","ucode":"50D653399A31F6","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":458723,"discussion_content":"正确","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1577528308,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":113840,"user_name":"假装自己不胖","can_delete":false,"product_type":"c1","uid":1412994,"ip_address":"","ucode":"308F1BAA96CDA5","user_header":"https://static001.geekbang.org/account/avatar/00/15/8f/82/374f43a1.jpg","comment_is_top":false,"comment_ctime":1563171132,"is_pvip":false,"replies":[{"id":"63898","content":"可以的 也可以使用DATE_FORMAT 格式化你想要的日期格式","user_name":"作者回复","user_name_real":"cy","uid":"1306094","ctime":1577604000,"ip_address":"","comment_id":113840,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1563171132","product_id":100029501,"comment_content":"DATE()筛出来的是没有时分秒的.如果要时分秒,有其他函数可以使用吗","like_count":0,"discussions":[{"author":{"id":1306094,"avatar":"https://static001.geekbang.org/account/avatar/00/13/ed/ee/c4779b67.jpg","nickname":"cy","note":"","ucode":"50D653399A31F6","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":458403,"discussion_content":"可以的 也可以使用DATE_FORMAT 格式化你想要的日期格式","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1577604000,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":112110,"user_name":"肥而不腻","can_delete":false,"product_type":"c1","uid":1435246,"ip_address":"","ucode":"3E6786A82A6DD6","user_header":"https://static001.geekbang.org/account/avatar/00/15/e6/6e/062da5e4.jpg","comment_is_top":false,"comment_ctime":1562670796,"is_pvip":false,"replies":[{"id":"63731","content":"加油刘强同学","user_name":"作者回复","user_name_real":"cy","uid":"1306094","ctime":1577530774,"ip_address":"","comment_id":112110,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1562670796","product_id":100029501,"comment_content":"学完打卡","like_count":0,"discussions":[{"author":{"id":1306094,"avatar":"https://static001.geekbang.org/account/avatar/00/13/ed/ee/c4779b67.jpg","nickname":"cy","note":"","ucode":"50D653399A31F6","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":457581,"discussion_content":"加油刘强同学","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1577530774,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":112081,"user_name":"2525","can_delete":false,"product_type":"c1","uid":1180247,"ip_address":"","ucode":"2426488C258203","user_header":"https://static001.geekbang.org/account/avatar/00/12/02/57/9b235866.jpg","comment_is_top":false,"comment_ctime":1562665285,"is_pvip":false,"replies":[{"id":"63734","content":"Good Job","user_name":"作者回复","user_name_real":"cy","uid":"1306094","ctime":1577530796,"ip_address":"","comment_id":112081,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1562665285","product_id":100029501,"comment_content":"作业: mysql<br><br>select AVG(hp_max) as 最大生命平均值 FROM heros;<br>select name,birthdate from heros where birthdate is not null and  EXTRACT(YEAR FROM DATE(birthdate))&lt;&quot;2017&quot;","like_count":0,"discussions":[{"author":{"id":1306094,"avatar":"https://static001.geekbang.org/account/avatar/00/13/ed/ee/c4779b67.jpg","nickname":"cy","note":"","ucode":"50D653399A31F6","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":457566,"discussion_content":"Good Job","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1577530796,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":111722,"user_name":"NO.9","can_delete":false,"product_type":"c1","uid":1336970,"ip_address":"","ucode":"B92F14B493406F","user_header":"http://thirdwx.qlogo.cn/mmopen/vi_32/fUDCLLob6DFS8kZcMUfxOc4qQHeQfW4rIMK5Ty2u2AqLemcdhVRw7byx85HrVicSvy5AiabE0YGMj5gVt8ibgrusA/132","comment_is_top":false,"comment_ctime":1562590049,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1562590049","product_id":100029501,"comment_content":"下载版本就够用了吧，mysql-8.0.16-macos10.14-x86_64.dmg Community Edition","like_count":0},{"had_liked":false,"id":110629,"user_name":"一叶知秋","can_delete":false,"product_type":"c1","uid":1445189,"ip_address":"","ucode":"15A95FA86B7AE4","user_header":"https://static001.geekbang.org/account/avatar/00/16/0d/45/b88a1794.jpg","comment_is_top":false,"comment_ctime":1562306247,"is_pvip":false,"replies":[{"id":"63753","content":"加油~","user_name":"作者回复","user_name_real":"cy","uid":"1306094","ctime":1577531153,"ip_address":"","comment_id":110629,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1562306247","product_id":100029501,"comment_content":"交作业：<br>1)MySQL SELECT ROUND(AVG(hp_max), 2) as average_hp FROM heros;<br>执行结果： <br>+------------+<br>| average_hp |<br>+------------+<br>|    6580.48 |<br>+------------+<br>1 row in set (0.00 sec)<br><br>2）MySQL：SELECT name, birthdate FROM heros WHERE birthdate IS NOT NULL and DATE(birthdate)&lt;&#39;2017-1-1&#39; ORDER BY birthdate ASC;<br>执行结果：<br>+--------------+------------+<br>| name         | birthdate  |<br>+--------------+------------+<br>| 张良         | 2015-10-26 |<br>| 宫本武藏     | 2015-10-30 |<br>| 周瑜         | 2015-11-10 |<br>| 牛魔         | 2015-11-24 |<br>| 芈月         | 2015-12-08 |<br>| 貂蝉         | 2015-12-15 |<br>| 吕布         | 2015-12-22 |<br>| 花木兰       | 2016-01-01 |<br>| 刘备         | 2016-02-02 |<br>| 娜可露露     | 2016-02-22 |<br>| 李白         | 2016-03-01 |<br>| 钟馗         | 2016-03-24 |<br>| 李元芳       | 2016-04-12 |<br>| 刘邦         | 2016-04-26 |<br>| 不知火舞     | 2016-05-12 |<br>| 虞姬         | 2016-05-24 |<br>| 关羽         | 2016-06-28 |<br>| 蔡文姬       | 2016-07-08 |<br>| 夏侯惇       | 2016-07-19 |<br>| 马可波罗     | 2016-08-23 |<br>| 成吉思汗     | 2016-09-27 |<br>| 杨戬         | 2016-10-11 |<br>| 太乙真人     | 2016-11-24 |<br>+--------------+------------+<br>23 rows in set (0.00 sec)<br><br>本章收获：规范大小写。","like_count":0,"discussions":[{"author":{"id":1306094,"avatar":"https://static001.geekbang.org/account/avatar/00/13/ed/ee/c4779b67.jpg","nickname":"cy","note":"","ucode":"50D653399A31F6","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":456977,"discussion_content":"加油~","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1577531153,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":110470,"user_name":"mj4ever","can_delete":false,"product_type":"c1","uid":1005549,"ip_address":"","ucode":"73028E537099CC","user_header":"https://static001.geekbang.org/account/avatar/00/0f/57/ed/d50de13c.jpg","comment_is_top":false,"comment_ctime":1562285342,"is_pvip":true,"discussion_count":0,"race_medal":0,"score":"1562285342","product_id":100029501,"comment_content":"SELECT COUNT(1) num,t.role_main,AVG(t.hp_max) FROM heros t WHERE t.hp_max &gt; 6000 GROUP BY t.role_main HAVING num &gt; 5 ORDER BY num DESC<br><br>SELECT COUNT(1) num,ROUND(AVG(t.hp_max+t.mp_max),2),MAX((t.hp_max+t.mp_max)),MIN((t.hp_max+t.mp_max))  FROM heros t WHERE (t.hp_max + t.mp_max) &gt; 7000 GROUP BY t.attack_range ORDER BY num DESC","like_count":0},{"had_liked":false,"id":109641,"user_name":"趁早","can_delete":false,"product_type":"c1","uid":1031970,"ip_address":"","ucode":"949FB3AA250D80","user_header":"https://static001.geekbang.org/account/avatar/00/0f/bf/22/26530e66.jpg","comment_is_top":false,"comment_ctime":1562070825,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1562070825","product_id":100029501,"comment_content":"函数应该除了版本不兼容以及不好迁移等问题，还有执行效率不高 ，增加耦合度等问题","like_count":0},{"had_liked":false,"id":109567,"user_name":"全麦小面包","can_delete":false,"product_type":"c1","uid":1086413,"ip_address":"","ucode":"823C65BF366097","user_header":"https://static001.geekbang.org/account/avatar/00/10/93/cd/dbafc7d1.jpg","comment_is_top":false,"comment_ctime":1562058129,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1562058129","product_id":100029501,"comment_content":"我自定义了2个函数，如下：<br>DELIMITER &#47;&#47;<br>CREATE FUNCTION FUN_SEQ(SEQ VARCHAR(50)) <br>RETURNS bigint(20)<br>BEGIN<br>     UPDATE SEQ_TABLE<br>     SET CURRENT_VALUE = CURRENT_VALUE + INCREMENT<br>     WHERE  SEQ_NAME=SEQ;<br>     RETURN FUN_SEQ_CURRENT_VALUE(SEQ);<br>END &#47;&#47;<br><br>CREATE FUNCTION FUN_SEQ_CURRENT_VALUE(SEQ VARCHAR(50)) <br>RETURNS bigint(20)<br>BEGIN<br>    DECLARE VALUE INTEGER;<br>    SET VALUE=0;<br>    SELECT CURRENT_VALUE INTO VALUE<br>    FROM SEQ_TABLE <br>    WHERE SEQ_NAME=SEQ;<br>    RETURN VALUE;<br>END &#47;&#47;<br><br>DELIMITER ;<br><br>这2个函数的作用：将参数对应的字段加上相应的值，并得到更新后的值。<br>第一个函数是更新表，增加某个字段的值；<br>第二个函数是得到更新后的字段值。<br><br>问题：<br>update有写锁，并在事物提交的时候释放锁，但函数中的事物是何时提交的呢？因为第1个函数用到了第2个函数，是2个函数都执行完才提交事物吗?","like_count":0},{"had_liked":false,"id":109483,"user_name":"不似旧日","can_delete":false,"product_type":"c1","uid":1161271,"ip_address":"","ucode":"DF4C5E3AB9570C","user_header":"https://static001.geekbang.org/account/avatar/00/11/b8/37/98991aeb.jpg","comment_is_top":false,"comment_ctime":1562040538,"is_pvip":false,"replies":[{"id":"63928","content":"很好的总结","user_name":"作者回复","user_name_real":"cy","uid":"1306094","ctime":1577605217,"ip_address":"","comment_id":109483,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1562040538","product_id":100029501,"comment_content":"SQL内置函数可以分为四类:<br>1.算数函数<br>2.字符串函数<br>3.日期时间函数<br>4.转换函数<br><br>算数函数: 对数值型字段进行算数运算,包括取绝对值,取余,四舍五入为指定位数的小数<br>字符串函数: 对字符串类型的字段进行操作, 包括拼接字符串,判断字符串长度,判断字节长度,替换字符串,切割字符串<br>日期函数: 对日期时间类型的字段进行操作,包括当前系统日期时间,获取年、月、日, 以及判断时间先后<br>转换函数: 对字段类型进行转换<br><br>注意:函数是对取出来的值进行操作的;函数的移植性很差<br><br>大小写规范:<br>1.关键字,函数名是不区分大小写的<br>2.MySql在Windows环境下全部不区分大小写<br>3.在Linux环境下,数据库名、表名、变量名是严格区分大小写的,字段名是忽略大小写的","like_count":0,"discussions":[{"author":{"id":1306094,"avatar":"https://static001.geekbang.org/account/avatar/00/13/ed/ee/c4779b67.jpg","nickname":"cy","note":"","ucode":"50D653399A31F6","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":456432,"discussion_content":"很好的总结","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1577605217,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":109153,"user_name":"Golden Lee 🐎","can_delete":false,"product_type":"c1","uid":1585752,"ip_address":"","ucode":"5BF0B1BCC1C995","user_header":"https://static001.geekbang.org/account/avatar/00/18/32/58/069cc4fb.jpg","comment_is_top":false,"comment_ctime":1561971818,"is_pvip":false,"replies":[{"id":"63932","content":"Good Job","user_name":"作者回复","user_name_real":"cy","uid":"1306094","ctime":1577605427,"ip_address":"","comment_id":109153,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1561971818","product_id":100029501,"comment_content":"最后两道思考题解答：<br>SELECT AVG(hp_max) FROM heros;<br>SELECT name FROM heros WHERE DATE(birthdate) &lt; &#39;2017-01-01&#39; AND birthdate IS NOT NULL;","like_count":0,"discussions":[{"author":{"id":1306094,"avatar":"https://static001.geekbang.org/account/avatar/00/13/ed/ee/c4779b67.jpg","nickname":"cy","note":"","ucode":"50D653399A31F6","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":456270,"discussion_content":"Good Job","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1577605427,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":108815,"user_name":"华夏","can_delete":false,"product_type":"c1","uid":1449474,"ip_address":"","ucode":"4D627CFA5A4B82","user_header":"https://static001.geekbang.org/account/avatar/00/16/1e/02/2864e0f2.jpg","comment_is_top":false,"comment_ctime":1561888459,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1561888459","product_id":100029501,"comment_content":" SELECT AVG(hp_max) FROM heros;<br>+-------------------+<br>| AVG(hp_max)       |<br>+-------------------+<br>| 6580.478260869565 |<br>+-------------------+<br>1 row in set (0.02 sec)<br><br>SELECT name, birthdate FROM heros WHERE birthdate IS NOT NULL AND YEAR(birthdate) &lt; 2017;<br>+--------------+------------+<br>| name         | birthdate  |<br>+--------------+------------+<br>| 夏侯惇       | 2016-07-19 |<br>| 牛魔         | 2015-11-24 |<br>| 吕布         | 2015-12-22 |<br>| 芈月         | 2015-12-08 |<br>| 太乙真人     | 2016-11-24 |<br>| 刘邦         | 2016-04-26 |<br>| 关羽         | 2016-06-28 |<br>| 马可波罗     | 2016-08-23 |<br>| 李元芳       | 2016-04-12 |<br>| 虞姬         | 2016-05-24 |<br>| 成吉思汗     | 2016-09-27 |<br>| 不知火舞     | 2016-05-12 |<br>| 貂蝉         | 2015-12-15 |<br>| 周瑜         | 2015-11-10 |<br>| 张良         | 2015-10-26 |<br>| 钟馗         | 2016-03-24 |<br>| 蔡文姬       | 2016-07-08 |<br>| 花木兰       | 2016-01-01 |<br>| 李白         | 2016-03-01 |<br>| 杨戬         | 2016-10-11 |<br>| 刘备         | 2016-02-02 |<br>| 宫本武藏     | 2015-10-30 |<br>| 娜可露露     | 2016-02-22 |<br>+--------------+------------+<br>23 rows in set (0.01 sec)<br>","like_count":0},{"had_liked":false,"id":108811,"user_name":"莫莫","can_delete":false,"product_type":"c1","uid":1170881,"ip_address":"","ucode":"D3A70E02A100F1","user_header":"https://static001.geekbang.org/account/avatar/00/11/dd/c1/e73d9bf1.jpg","comment_is_top":false,"comment_ctime":1561887626,"is_pvip":false,"replies":[{"id":"63962","content":"第二题正确<br>第一题是求 最大生命平均值，再Check下","user_name":"作者回复","user_name_real":"cy","uid":"1306094","ctime":1577606030,"ip_address":"","comment_id":108811,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1561887626","product_id":100029501,"comment_content":"-- 计算英雄的最大生命平均值<br>SELECT `name`,MAX(hp_max) FROM heros<br><br>-- 显示出所有在 2017 年之前上线的英雄，如果英雄没有统计上线时间则不显示<br>SELECT `name`,birthdate FROM heros<br>WHERE DATE(birthdate)&lt; &#39;2017-01-01&#39; AND birthdate IS NOT NULL","like_count":0,"discussions":[{"author":{"id":1306094,"avatar":"https://static001.geekbang.org/account/avatar/00/13/ed/ee/c4779b67.jpg","nickname":"cy","note":"","ucode":"50D653399A31F6","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":456126,"discussion_content":"第二题正确\n第一题是求 最大生命平均值，再Check下","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1577606030,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":108744,"user_name":"Neo","can_delete":false,"product_type":"c1","uid":1070189,"ip_address":"","ucode":"A2B2E2F8780557","user_header":"https://static001.geekbang.org/account/avatar/00/10/54/6d/c947ef55.jpg","comment_is_top":false,"comment_ctime":1561871136,"is_pvip":false,"replies":[{"id":"63968","content":"Good Job 正确","user_name":"作者回复","user_name_real":"cy","uid":"1306094","ctime":1577606127,"ip_address":"","comment_id":108744,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1561871136","product_id":100029501,"comment_content":"平均生命值：SELECT AVG(hp_max) from heros;<br>2017年之前上线的英雄： SELECT name, birthdate FROM heros WHERE birthdate IS NOT NULL AND DATE(birthdate)&lt;&#39;2017&#39;;","like_count":0,"discussions":[{"author":{"id":1306094,"avatar":"https://static001.geekbang.org/account/avatar/00/13/ed/ee/c4779b67.jpg","nickname":"cy","note":"","ucode":"50D653399A31F6","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":456100,"discussion_content":"Good Job 正确","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1577606127,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":108338,"user_name":"满怀","can_delete":false,"product_type":"c1","uid":1483113,"ip_address":"","ucode":"EFAC662A37D684","user_header":"https://static001.geekbang.org/account/avatar/00/16/a1/69/0ddda908.jpg","comment_is_top":false,"comment_ctime":1561722463,"is_pvip":false,"replies":[{"id":"63985","content":"Good Job，而且第一个用到了ROUND","user_name":"作者回复","user_name_real":"cy","uid":"1306094","ctime":1577606848,"ip_address":"","comment_id":108338,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1561722463","product_id":100029501,"comment_content":"练习题1计算英雄的最大生命平均值<br>SELECT ROUND(AVG(hp_max), 2) AS avg_hp_max #平均值四舍五入保留两位小数<br>FROM heros;<br>练习题2显示出所有在 2017 年之前上线的英雄<br>SELECT `name`, birthdate<br>FROM heros<br>WHERE birthdate &gt; DATE(&#39;2017-01-01&#39;);","like_count":0,"discussions":[{"author":{"id":1306094,"avatar":"https://static001.geekbang.org/account/avatar/00/13/ed/ee/c4779b67.jpg","nickname":"cy","note":"","ucode":"50D653399A31F6","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":455923,"discussion_content":"Good Job，而且第一个用到了ROUND","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1577606848,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":108285,"user_name":"微凉","can_delete":false,"product_type":"c1","uid":1178156,"ip_address":"","ucode":"F6BD0AE11AE224","user_header":"https://static001.geekbang.org/account/avatar/00/11/fa/2c/9a0c45e6.jpg","comment_is_top":false,"comment_ctime":1561712608,"is_pvip":false,"replies":[{"id":"63988","content":"Good Job","user_name":"作者回复","user_name_real":"cy","uid":"1306094","ctime":1577606886,"ip_address":"","comment_id":108285,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1561712608","product_id":100029501,"comment_content":"SELECT AVG(hp_max) FROM heros；<br>SELECT name FROM heros WHERE birthdate IS NOT NULL AND YEAR(birthdate) &lt; &#39;2017&#39;; ；","like_count":0,"discussions":[{"author":{"id":1306094,"avatar":"https://static001.geekbang.org/account/avatar/00/13/ed/ee/c4779b67.jpg","nickname":"cy","note":"","ucode":"50D653399A31F6","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":455902,"discussion_content":"Good Job","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1577606886,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":107774,"user_name":"Vic","can_delete":false,"product_type":"c1","uid":1125856,"ip_address":"","ucode":"561EC4B557A28F","user_header":"https://static001.geekbang.org/account/avatar/00/11/2d/e0/84859ce6.jpg","comment_is_top":false,"comment_ctime":1561606896,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1561606896","product_id":100029501,"comment_content":"老师，mysq drop database后磁盘空间未释放，怎么操作可以让磁盘空间释放呀？","like_count":0},{"had_liked":false,"id":107763,"user_name":"业余草","can_delete":false,"product_type":"c1","uid":1126538,"ip_address":"","ucode":"99BDC1E629049D","user_header":"https://static001.geekbang.org/account/avatar/00/11/30/8a/b5ca7286.jpg","comment_is_top":false,"comment_ctime":1561604553,"is_pvip":false,"discussion_count":1,"race_medal":0,"score":"1561604553","product_id":100029501,"comment_content":"用了函数，并不是说全部都不走索引了。有些函数走索引，有些函数换种用法也会走索引！","like_count":0,"discussions":[{"author":{"id":1238323,"avatar":"https://static001.geekbang.org/account/avatar/00/12/e5/33/ff5c52ad.jpg","nickname":"不负","note":"","ucode":"147F5860711811","race_medal":1,"user_type":1,"is_pvip":true},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":480,"discussion_content":"哪些函数走不走索引，是有说明文档？","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1561609751,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":107755,"user_name":"Middleware","can_delete":false,"product_type":"c1","uid":1072015,"ip_address":"","ucode":"C0028293ECDD47","user_header":"https://static001.geekbang.org/account/avatar/00/10/5b/8f/4b0ab5db.jpg","comment_is_top":false,"comment_ctime":1561603881,"is_pvip":true,"replies":[{"id":"39192","content":"第二个正确，第一个应该是 AVG(hp_max)","user_name":"作者回复","user_name_real":"cy","uid":"1306094","ctime":1561692039,"ip_address":"","comment_id":107755,"utype":1}],"discussion_count":1,"race_medal":1,"score":"1561603881","product_id":100029501,"comment_content":"NO.1:<br>```shell<br>SELECT MAX(hp_max),name FROM heros;<br>```<br>NO:2<br>```shell<br>SELECT name,birthdate FROM heros WHERE YEAR(birthdate) &lt; 2017 AND birthdate IS NOT NULL;<br>```","like_count":0,"discussions":[{"author":{"id":1306094,"avatar":"https://static001.geekbang.org/account/avatar/00/13/ed/ee/c4779b67.jpg","nickname":"cy","note":"","ucode":"50D653399A31F6","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":455657,"discussion_content":"第二个正确，第一个应该是 AVG(hp_max)","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1561692039,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":107635,"user_name":"大斌","can_delete":false,"product_type":"c1","uid":1002183,"ip_address":"","ucode":"1434C2B0A29135","user_header":"https://static001.geekbang.org/account/avatar/00/0f/4a/c7/ec18673b.jpg","comment_is_top":false,"comment_ctime":1561587174,"is_pvip":false,"replies":[{"id":"39193","content":"第二个正确，第一个想表达的是 最大生命值的平均值，AVG(hp_max)","user_name":"作者回复","user_name_real":"cy","uid":"1306094","ctime":1561692070,"ip_address":"","comment_id":107635,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1561587174","product_id":100029501,"comment_content":"英雄最大生命平均值：SELECT MAX(hp_max)  FROM heros;<br><br>按日期筛选英雄：SELECT name,birthdate FROM heros WHERE YEAR(birthdate)&lt;&#39;2017&#39; AND birthdate IS NOT NULL ORDER BY birthdate;","like_count":0,"discussions":[{"author":{"id":1306094,"avatar":"https://static001.geekbang.org/account/avatar/00/13/ed/ee/c4779b67.jpg","nickname":"cy","note":"","ucode":"50D653399A31F6","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":455597,"discussion_content":"第二个正确，第一个想表达的是 最大生命值的平均值，AVG(hp_max)","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1561692070,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":107587,"user_name":"Yt","can_delete":false,"product_type":"c1","uid":1508210,"ip_address":"","ucode":"E094E3666A1440","user_header":"http://thirdwx.qlogo.cn/mmopen/vi_32/Pk7HVX99cBlSOicLoa8KN8yCKx1pWIyYuy7zxL2ibXicYRFq2ic7LMYiaXMajuQNRZzL4QyuJX6ToRoficsBPlT3Meog/132","comment_is_top":false,"comment_ctime":1561560724,"is_pvip":false,"replies":[{"id":"39203","content":"正确","user_name":"作者回复","user_name_real":"cy","uid":"1306094","ctime":1561694013,"ip_address":"","comment_id":107587,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1561560724","product_id":100029501,"comment_content":"SELECT AVG(hp_max)  FROM heros;<br>SELECT name FROM heros<br>WHERE birthdate IS NOT NULL AND DATE(birthdate)&lt;&#39;2017-01-01&#39; ;","like_count":0,"discussions":[{"author":{"id":1306094,"avatar":"https://static001.geekbang.org/account/avatar/00/13/ed/ee/c4779b67.jpg","nickname":"cy","note":"","ucode":"50D653399A31F6","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":455576,"discussion_content":"正确","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1561694013,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":107586,"user_name":"ABC","can_delete":false,"product_type":"c1","uid":1054958,"ip_address":"","ucode":"7501AD9C0C4A70","user_header":"https://static001.geekbang.org/account/avatar/00/10/18/ee/a1ed60d1.jpg","comment_is_top":false,"comment_ctime":1561560416,"is_pvip":false,"replies":[{"id":"39205","content":"正确","user_name":"作者回复","user_name_real":"cy","uid":"1306094","ctime":1561694041,"ip_address":"","comment_id":107586,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1561560416","product_id":100029501,"comment_content":"-- 作业: 计算英雄的最大生命平均值<br>SELECT ROUND(AVG(hp_max),2) FROM heros ;<br><br>-- 作业: 显示出所有在2017年之前上线的英雄,如果英雄没有统计上线日期则不显示.<br>SELECT * FROM heros WHERE YEAR(birthdate)&lt;2017 and birthdate IS NOT NULL;","like_count":0,"discussions":[{"author":{"id":1306094,"avatar":"https://static001.geekbang.org/account/avatar/00/13/ed/ee/c4779b67.jpg","nickname":"cy","note":"","ucode":"50D653399A31F6","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":455575,"discussion_content":"正确","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1561694041,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":107557,"user_name":"Yt","can_delete":false,"product_type":"c1","uid":1508210,"ip_address":"","ucode":"E094E3666A1440","user_header":"http://thirdwx.qlogo.cn/mmopen/vi_32/Pk7HVX99cBlSOicLoa8KN8yCKx1pWIyYuy7zxL2ibXicYRFq2ic7LMYiaXMajuQNRZzL4QyuJX6ToRoficsBPlT3Meog/132","comment_is_top":false,"comment_ctime":1561557435,"is_pvip":false,"discussion_count":2,"race_medal":0,"score":"1561557435","product_id":100029501,"comment_content":"请教一个问题，如何用navicat建立一个从10000开始自增的字段？网上百度的那个方法解决不了，设置了10000一保存，就会被刷新掉，我只能从1开始自增","like_count":0,"discussions":[{"author":{"id":1562855,"avatar":"https://static001.geekbang.org/account/avatar/00/17/d8/e7/21a4cbb1.jpg","nickname":"Mr.H","note":"","ucode":"035F78476138C0","race_medal":0,"user_type":1,"is_pvip":true},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":460,"discussion_content":"不设置字段自增，使用序列来替换自增，序列从10000开始，自增加1","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1561602027,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1054958,"avatar":"https://static001.geekbang.org/account/avatar/00/10/18/ee/a1ed60d1.jpg","nickname":"ABC","note":"","ucode":"7501AD9C0C4A70","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":442,"discussion_content":"1. 不要设置字段自增，手动插入。\n2. 放弃从10000开始，使用系统自带的自增。\n3. (使用自增)通过程序插入10000条任意数据.","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1561560656,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":107531,"user_name":"MJ","can_delete":false,"product_type":"c1","uid":1237145,"ip_address":"","ucode":"FCEC0C21444D2A","user_header":"https://static001.geekbang.org/account/avatar/00/12/e0/99/5d603697.jpg","comment_is_top":false,"comment_ctime":1561553116,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1561553116","product_id":100029501,"comment_content":"select avg(hp_max) from heros;<br><br>select name,date(birthdate) from heros where birthdate&lt;date(&#39;2017-01-01&#39;);","like_count":0},{"had_liked":false,"id":107504,"user_name":"Hoo-Ah","can_delete":false,"product_type":"c1","uid":1306913,"ip_address":"","ucode":"823093A6C7DEE7","user_header":"https://static001.geekbang.org/account/avatar/00/13/f1/21/52e8267b.jpg","comment_is_top":false,"comment_ctime":1561548220,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1561548220","product_id":100029501,"comment_content":"SELECT girl FROM girls WHERE age = 21 AND name LIKE ‘余%’;","like_count":0},{"had_liked":false,"id":107432,"user_name":"Zh","can_delete":false,"product_type":"c1","uid":1388911,"ip_address":"","ucode":"8B0032EC876B6B","user_header":"","comment_is_top":false,"comment_ctime":1561535765,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1561535765","product_id":100029501,"comment_content":"SELECT AVG(hp_max) AS avg_hp_max<br>FROM heros;<br><br>SELECT `name`<br>FROM heros<br>WHERE birthdate IS NOT NULL<br>  AND EXTRACT(YEAR FROM birthdate) &lt; &#39;2017&#39;;","like_count":0},{"had_liked":false,"id":107424,"user_name":"习惯沉淀","can_delete":false,"product_type":"c1","uid":1144692,"ip_address":"","ucode":"9C590226330AD3","user_header":"https://static001.geekbang.org/account/avatar/00/11/77/74/c1f0aa46.jpg","comment_is_top":false,"comment_ctime":1561534145,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1561534145","product_id":100029501,"comment_content":"SELECT AVG(hp_max) from heros;<br>SELECT `name`,birthdate from heros WHERE YEAR(birthdate) &lt; &#39;2017&#39;;","like_count":0},{"had_liked":false,"id":107368,"user_name":"时间是最真的答案","can_delete":false,"product_type":"c1","uid":1183601,"ip_address":"","ucode":"B90F3EF769F865","user_header":"https://static001.geekbang.org/account/avatar/00/12/0f/71/9273e8a4.jpg","comment_is_top":false,"comment_ctime":1561520275,"is_pvip":false,"replies":[{"id":"63999","content":"Good Job","user_name":"作者回复","user_name_real":"cy","uid":"1306094","ctime":1577607266,"ip_address":"","comment_id":107368,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1561520275","product_id":100029501,"comment_content":"SELECT AVG(hp_max) FROM heros WHERE YEAR(birthdate) &lt; &#39;2017&#39; AND birthdate IS NOT NULL ;<br>SELECT AVG(hp_max) FROM heros WHERE EXTRACT(YEAR FROM birthdate) &lt; &#39;2017&#39; AND birthdate IS NOT NULL ;","like_count":0,"discussions":[{"author":{"id":1306094,"avatar":"https://static001.geekbang.org/account/avatar/00/13/ed/ee/c4779b67.jpg","nickname":"cy","note":"","ucode":"50D653399A31F6","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":455488,"discussion_content":"Good Job","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1577607266,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":107366,"user_name":"Demon.Lee","can_delete":false,"product_type":"c1","uid":1052859,"ip_address":"","ucode":"7F0E5493A8E345","user_header":"https://static001.geekbang.org/account/avatar/00/10/10/bb/f1061601.jpg","comment_is_top":false,"comment_ctime":1561520174,"is_pvip":false,"discussion_count":0,"race_medal":1,"score":"1561520174","product_id":100029501,"comment_content":"mysql root@localhost:testdb&gt; select * from tp_student where name=&#39;LEO&#39;;<br>+-------+---------------------+------+<br>| id    | create_time         | name |<br>+-------+---------------------+------+<br>| 10001 | 2019-06-25 22:19:32 | leo  |<br>+-------+---------------------+------+<br><br>------好像字段值也是默认不区分大小写，除非设置BINARY属性","like_count":0},{"had_liked":false,"id":107349,"user_name":"mickey","can_delete":false,"product_type":"c1","uid":1051663,"ip_address":"","ucode":"8B490C2DDE4010","user_header":"https://static001.geekbang.org/account/avatar/00/10/0c/0f/93d1c8eb.jpg","comment_is_top":false,"comment_ctime":1561517630,"is_pvip":false,"discussion_count":2,"race_medal":0,"score":"1561517630","product_id":100029501,"comment_content":"GitHub上的heros_data_with_structure.sql表结构文件和heros.sql的insert语句的格式都不一样，插不进去。","like_count":0,"discussions":[{"author":{"id":1545903,"avatar":"https://static001.geekbang.org/account/avatar/00/17/96/af/da8fd6ed.jpg","nickname":"　　星豪","note":"","ucode":"31C3FEA16F7BE8","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":534,"discussion_content":"因为缺少了一列id列，自己在创建表结构时，添加一列id列就可以直接导入了","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1561643188,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1054958,"avatar":"https://static001.geekbang.org/account/avatar/00/10/18/ee/a1ed60d1.jpg","nickname":"ABC","note":"","ucode":"7501AD9C0C4A70","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":443,"discussion_content":"https://github.com/pruidong/sql_heros_data 推荐使用我修改过的.","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1561560706,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":107347,"user_name":"hlz-123","can_delete":false,"product_type":"c1","uid":1433586,"ip_address":"","ucode":"B7E5EF0C260BD2","user_header":"","comment_is_top":false,"comment_ctime":1561517475,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1561517475","product_id":100029501,"comment_content":"我看到同学们写了三种查询语句，执行时间如下表，没想到having语句时间最短，不知道什么原因。<br>1\t0.00024750\t<br>select name,birthdate from heros where date(birthdate)&lt;&#39;2017-01-01&#39; and birthdate is not null<br>2\t0.00025000\t<br>select name,birthdate from heros where year(birthdate)&lt;&#39;2017&#39; and birthdate is not null<br>3\t0.00023400\t<br>SELECT name,YEAR(birthdate) AS birthdate FROM heros WHERE birthdate is NOT NULL GROUP BY name HAVING birthdate&lt;2017","like_count":0},{"had_liked":false,"id":107343,"user_name":"cricket1981","can_delete":false,"product_type":"c1","uid":1001715,"ip_address":"","ucode":"758262F5958DA4","user_header":"https://static001.geekbang.org/account/avatar/00/0f/48/f3/f1034ffd.jpg","comment_is_top":false,"comment_ctime":1561516599,"is_pvip":false,"discussion_count":2,"race_medal":0,"score":"1561516599","product_id":100029501,"comment_content":"Navicat有开源社区免费版本吗？","like_count":0,"discussions":[{"author":{"id":1545903,"avatar":"https://static001.geekbang.org/account/avatar/00/17/96/af/da8fd6ed.jpg","nickname":"　　星豪","note":"","ucode":"31C3FEA16F7BE8","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":535,"discussion_content":"你可以按照这个步骤激活一下，https://blog.csdn.net/qq_26975307/article/details/89409078","likes_number":1,"is_delete":false,"is_hidden":false,"ctime":1561643379,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1054958,"avatar":"https://static001.geekbang.org/account/avatar/00/10/18/ee/a1ed60d1.jpg","nickname":"ABC","note":"","ucode":"7501AD9C0C4A70","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":444,"discussion_content":"Navicat没有，推荐你使用dbeaver,开源免费,有中文界面.","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1561560737,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":107340,"user_name":"[耶]友超","can_delete":false,"product_type":"c1","uid":1400962,"ip_address":"","ucode":"890572F77C3670","user_header":"https://static001.geekbang.org/account/avatar/00/15/60/82/9a43504b.jpg","comment_is_top":false,"comment_ctime":1561516363,"is_pvip":true,"replies":[{"id":"64000","content":"Good Job","user_name":"作者回复","user_name_real":"cy","uid":"1306094","ctime":1577607297,"ip_address":"","comment_id":107340,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1561516363","product_id":100029501,"comment_content":"SELECT AVG(hp_max) AS 最大生命平均值 FROM heros<br>SELECT NAME,birthdate FROM heros WHERE YEAR(birthdate)&lt;2017","like_count":0,"discussions":[{"author":{"id":1306094,"avatar":"https://static001.geekbang.org/account/avatar/00/13/ed/ee/c4779b67.jpg","nickname":"cy","note":"","ucode":"50D653399A31F6","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":455478,"discussion_content":"Good Job","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1577607297,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":107331,"user_name":"Mr wind","can_delete":false,"product_type":"c1","uid":1217874,"ip_address":"","ucode":"484F02D1962239","user_header":"https://static001.geekbang.org/account/avatar/00/12/95/52/ad190682.jpg","comment_is_top":false,"comment_ctime":1561515219,"is_pvip":false,"replies":[{"id":"64002","content":"Good Job","user_name":"作者回复","user_name_real":"cy","uid":"1306094","ctime":1577607311,"ip_address":"","comment_id":107331,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1561515219","product_id":100029501,"comment_content":"SELECT AVG(hp_max) FROM heros WHERE NOT birthdate is NULL AND DATE(birthdate) &gt; &#39;2017-01-01&#39;;","like_count":0,"discussions":[{"author":{"id":1306094,"avatar":"https://static001.geekbang.org/account/avatar/00/13/ed/ee/c4779b67.jpg","nickname":"cy","note":"","ucode":"50D653399A31F6","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":455472,"discussion_content":"Good Job","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1577607311,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":107320,"user_name":"刘朋","can_delete":false,"product_type":"c1","uid":1075141,"ip_address":"","ucode":"7B7B8E4776C22E","user_header":"https://static001.geekbang.org/account/avatar/00/10/67/c5/63b09189.jpg","comment_is_top":false,"comment_ctime":1561514226,"is_pvip":false,"replies":[{"id":"64005","content":"Good Job","user_name":"作者回复","user_name_real":"cy","uid":"1306094","ctime":1577607323,"ip_address":"","comment_id":107320,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1561514226","product_id":100029501,"comment_content":"SELECT AVG(hp_max) FROM heros WHERE DATE(birthdate) &lt; &#39;2017-01-01&#39; AND birthdate IS NOT NULL;<br>SELECT AVG(hp_max) FROM heros WHERE EXTRACT(YEAR FROM birthdate) &lt; &#39;2017&#39; AND birthdate IS NOT NULL;<br>SELECT AVG(hp_max) FROM heros WHERE YEAR(birthdate) &lt; &#39;2017&#39; AND birthdate IS NOT NULL;","like_count":0,"discussions":[{"author":{"id":1306094,"avatar":"https://static001.geekbang.org/account/avatar/00/13/ed/ee/c4779b67.jpg","nickname":"cy","note":"","ucode":"50D653399A31F6","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":455465,"discussion_content":"Good Job","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1577607323,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":107317,"user_name":"leol","can_delete":false,"product_type":"c1","uid":1303229,"ip_address":"","ucode":"7FA42EAAFBAEB5","user_header":"https://static001.geekbang.org/account/avatar/00/13/e2/bd/b65420ae.jpg","comment_is_top":false,"comment_ctime":1561513992,"is_pvip":false,"replies":[{"id":"64006","content":"Good Job","user_name":"作者回复","user_name_real":"cy","uid":"1306094","ctime":1577607329,"ip_address":"","comment_id":107317,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1561513992","product_id":100029501,"comment_content":"英雄最大平均生命值<br>select avg(hp_max) from heros;<br>小于17年上线的英雄,没有日期的不显示<br>select name,birthdate from heros where date(birthdate)&lt;&#39;2017-01-01&#39; and date(birthdate) is not null;","like_count":0,"discussions":[{"author":{"id":1306094,"avatar":"https://static001.geekbang.org/account/avatar/00/13/ed/ee/c4779b67.jpg","nickname":"cy","note":"","ucode":"50D653399A31F6","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":455462,"discussion_content":"Good Job","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1577607329,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":107313,"user_name":"Samson","can_delete":false,"product_type":"c1","uid":1572899,"ip_address":"","ucode":"2114D3E2E8C5BE","user_header":"https://static001.geekbang.org/account/avatar/00/18/00/23/17868694.jpg","comment_is_top":false,"comment_ctime":1561513799,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1561513799","product_id":100029501,"comment_content":"“不过如果工程量不大，使用的是同一个 DBMS 的话，还是可以使用函数简化操作的，这样也能提高代码效率。”<br><br>如果不用函数，那有什么可替代方案呢？比如我要查找某个列的最大值，但又不能用MAX函数","like_count":0},{"had_liked":false,"id":107301,"user_name":"郡鸿","can_delete":false,"product_type":"c1","uid":1241201,"ip_address":"","ucode":"7A6298D288E078","user_header":"https://static001.geekbang.org/account/avatar/00/12/f0/71/c7b0a1f8.jpg","comment_is_top":false,"comment_ctime":1561512939,"is_pvip":false,"replies":[{"id":"64007","content":"Good Job","user_name":"作者回复","user_name_real":"cy","uid":"1306094","ctime":1577607333,"ip_address":"","comment_id":107301,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1561512939","product_id":100029501,"comment_content":"SELECT name,AVG(hp_max) FROM heros;<br>SELECT name,birthdate FROM heros WHERE YEAR(birthdate) &lt; &#39;2017&#39; AND birthdate IS NOT NULL;","like_count":0,"discussions":[{"author":{"id":1306094,"avatar":"https://static001.geekbang.org/account/avatar/00/13/ed/ee/c4779b67.jpg","nickname":"cy","note":"","ucode":"50D653399A31F6","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":455457,"discussion_content":"Good Job","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1577607333,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":107294,"user_name":"dream","can_delete":false,"product_type":"c1","uid":1117793,"ip_address":"","ucode":"65B33D32FA8BE9","user_header":"https://static001.geekbang.org/account/avatar/00/11/0e/61/ae68f8eb.jpg","comment_is_top":false,"comment_ctime":1561511984,"is_pvip":false,"replies":[{"id":"64008","content":"有些是通用的函数，有些方言（不同数据库的）会列出来","user_name":"作者回复","user_name_real":"cy","uid":"1306094","ctime":1577607355,"ip_address":"","comment_id":107294,"utype":1}],"discussion_count":2,"race_medal":0,"score":"1561511984","product_id":100029501,"comment_content":"对于不同的数据库，函数会不同的吧，那老师列出的函数是通用的函数吗？","like_count":0,"discussions":[{"author":{"id":1306094,"avatar":"https://static001.geekbang.org/account/avatar/00/13/ed/ee/c4779b67.jpg","nickname":"cy","note":"","ucode":"50D653399A31F6","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":455453,"discussion_content":"有些是通用的函数，有些方言（不同数据库的）会列出来","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1577607355,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1085237,"avatar":"https://static001.geekbang.org/account/avatar/00/10/8f/35/f1839bb2.jpg","nickname":"风中花","note":"","ucode":"067E0A1E116844","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":400,"discussion_content":"不通数据库稍有差异，大部分通用，如果你会一个数据库得函数，如果在另一个数据库范围使用，可以直接使用，如不支持，直接百度下，因为同等功能函数，基本都提高，可能关键字稍有差异","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1561533596,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":107292,"user_name":"佚花","can_delete":false,"product_type":"c1","uid":1246853,"ip_address":"","ucode":"B84288F748780A","user_header":"https://static001.geekbang.org/account/avatar/00/13/06/85/f1b4d5c4.jpg","comment_is_top":false,"comment_ctime":1561511764,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1561511764","product_id":100029501,"comment_content":"不知道这样写会带来什么效率问题呢","like_count":0},{"had_liked":false,"id":107265,"user_name":"ack","can_delete":false,"product_type":"c1","uid":1440912,"ip_address":"","ucode":"69CA1233EEA8E2","user_header":"https://static001.geekbang.org/account/avatar/00/15/fc/90/c9df0459.jpg","comment_is_top":false,"comment_ctime":1561509846,"is_pvip":false,"replies":[{"id":"64009","content":"Good Job","user_name":"作者回复","user_name_real":"cy","uid":"1306094","ctime":1577607362,"ip_address":"","comment_id":107265,"utype":1}],"discussion_count":2,"race_medal":0,"score":"1561509846","product_id":100029501,"comment_content":"1.SELECT AVG(max_hp) FROM heros;<br>2.SELECT name,YEAR(birthdate) AS birthdate FROM heros WHERE birthdate is NOT NULL GROUP BY name HAVING birthdate&lt;2017 ","like_count":0,"discussions":[{"author":{"id":1306094,"avatar":"https://static001.geekbang.org/account/avatar/00/13/ed/ee/c4779b67.jpg","nickname":"cy","note":"","ucode":"50D653399A31F6","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":455445,"discussion_content":"Good Job","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1577607362,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1217874,"avatar":"https://static001.geekbang.org/account/avatar/00/12/95/52/ad190682.jpg","nickname":"Mr wind","note":"","ucode":"484F02D1962239","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":378,"discussion_content":"第二句从group开始全错啦。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1561515118,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":107217,"user_name":"Peikon.val","can_delete":false,"product_type":"c1","uid":1474149,"ip_address":"","ucode":"5AE5D794E3DDD4","user_header":"https://static001.geekbang.org/account/avatar/00/16/7e/65/c5c96122.jpg","comment_is_top":false,"comment_ctime":1561486162,"is_pvip":false,"discussion_count":3,"race_medal":0,"score":"1561486162","product_id":100029501,"comment_content":"半夜更新辛苦了！<br>想问个问题：写 JS 的时候 JS 原生的 toFixed() 和 round() 函数在四舍五入时会出现丢精度的情况，那 SQL 的函数会有类似的问题吗？它是采取的什么方案呢？有没有比如『四舍六入五成双』之类的规定哈~","like_count":0,"discussions":[{"author":{"id":1144692,"avatar":"https://static001.geekbang.org/account/avatar/00/11/77/74/c1f0aa46.jpg","nickname":"习惯沉淀","note":"","ucode":"9C590226330AD3","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":369,"discussion_content":"定时发表的吧。。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1561511397,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":2,"child_discussions":[{"author":{"id":1474149,"avatar":"https://static001.geekbang.org/account/avatar/00/16/7e/65/c5c96122.jpg","nickname":"Peikon.val","note":"","ucode":"5AE5D794E3DDD4","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":1144692,"avatar":"https://static001.geekbang.org/account/avatar/00/11/77/74/c1f0aa46.jpg","nickname":"习惯沉淀","note":"","ucode":"9C590226330AD3","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":375,"discussion_content":"大半夜看的时候有一个精选评论，这个应该没法定时吧=。=","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1561513574,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":369,"ip_address":""},"score":375,"extra":""},{"author":{"id":1144692,"avatar":"https://static001.geekbang.org/account/avatar/00/11/77/74/c1f0aa46.jpg","nickname":"习惯沉淀","note":"","ucode":"9C590226330AD3","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":1474149,"avatar":"https://static001.geekbang.org/account/avatar/00/16/7e/65/c5c96122.jpg","nickname":"Peikon.val","note":"","ucode":"5AE5D794E3DDD4","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":385,"discussion_content":"微信公众号可以定时发表这个应该类似，不可能每次都半夜守着发啊，，这专栏的文章估计都已经写完了。。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1561518893,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":375,"ip_address":""},"score":385,"extra":""}]}]}]}