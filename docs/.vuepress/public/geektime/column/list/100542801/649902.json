{"id":649902,"title":"05｜Redis：如何安装和使用Redis数据库？","content":"<p>你好，我是黄鸿波。</p><p>上节课，我们了解了MongoDB数据库的概念，并学习了MongoDB数据库的搭建和基础使用方法。</p><p>这节课，我们来学习另一个常用到的数据库：Redis数据库。我们会从Redis数据库的概念入手，为你讲解Redis数据库的特性、应用场景以及安装和使用方法。</p><h2>什么是Redis数据库？</h2><p>Redis（Remote Dictionary Server）是一个开源的日志型 Key-Value 数据库。它由ANSI C语言编写，支持网络，可基于内存亦可持久化，还可以提供多种语言的API。它的读写速度快、性能好，支持久化，具有丰富的数据类型，并且使用起来非常简单。我们来详细看一下。</p><p><img src=\"https://static001.geekbang.org/resource/image/ce/df/ceef01e19bdc713961a382yy9776dddf.png?wh=3000x1196\" alt=\"\"></p><p>Redis数据库的最大特点就是它是一个内存数据库。Redis主要是使用内存存储的，当用户需要提取数据时，Redis可以直接将数据从内存中提取出来，不必再经过磁盘的IO操作，这就让它的读取效率非常高，可以达到毫秒级别。一般来讲，像Redis这样基于内存存储的数据库，通常用于缓存常用且需要快速检索到的数据进行存储，让效率最大化。</p><p>Redis数据库还支持多种计算机编程语言。例如Java、Python、C、C++等，因此，几乎所有的编程语言都能很轻易地操作它。</p><!-- [[[read_end]]] --><p>另外，Redis数据库也对多种数据结构进行了很好的支持。例如哈希、集合、位图、字符串等，我们可以根据实际的需要选择不同的数据。</p><p>例如，在推荐系统中，我们经常需要存储一些已经排好序的内容ID和它们所对应的打分，这个时候，Redis数据库就提供了一种叫zset的数据结构。它可以很方便地帮助我们把ID和得分放在一起存储，并用用户的ID作为Key进行索引，这样在我们需要数据的时候，就可以用毫秒级的速度取出相应的数据了。当然，除了zset，Redis支持的数据类型还有很多，我们会在后面的课程中逐一讲解。</p><p>除了数据结构之外，Redis还支持分布式存储，可以实现高可用的主从复制和分布式集群。相比于结构化数据库和文档型数据库，Redis数据库对于结构的要求更加宽松，它没有了表和Collection的概念，直接使用类似于Key-Value的形式存储数据，这样可以使我们的数据内容更加灵活，也更加方便我们存取数据。</p><h2>Redis数据库有什么特性？</h2><p>对Redis数据库有了一个基本的了解之后，接下来我们来说说Redis数据库的一些特性，以及在这些特性下的应用场景。</p><p><strong>Redis数据库的第一个特性就是速度快，</strong>这也是Redis一直以来都被用作线上实时数据库的原因。官方资料中称，Redis数据库可以承载高达每秒10万次的并发请求。实际上，我们前面也在说，Redis是一个内存数据库，Redis中的数据都是存在内存中的，这非常有利于提高读取效率。另外，Redis数据库采用单线程模型，最大程度避免了频繁切换上下文的问题，让存取效率变得非常高。</p><p><strong>Redis的第二个特性是持久化。</strong>我们都知道，如果将数据长时间存储在内存中，机器一旦断电，就会导致整个数据无法恢复，这是RAM的结构所导致的。但是，Redis虽然是一个内存型数据库，却也支持持久化。Redis的持久化方案以异步的方式将数据的更新保存在磁盘上。</p><p><strong>在Redis中，持久化的方式有两种，一种是RDB的方式，另外一种是AOF的方式。</strong>RDB持久化方式也叫作快照持久化，这种持久化方式会在指定的时间间隔内，将内存中的数据集快照写入磁盘。创建磁盘快照之后，用户可以对这个磁盘快照进行备份，当服务器宕机或重启恢复后，可以从其他的服务器上获取相同的数据。这也是Redis默认的持久化方式。</p><p>Redis的另一种持久化方式是AOF。它会把被执行的命令写入到AOF文件中，这样虽然可能会降低一部分性能，但是在大部分情况下，这样的性能损耗是可以接受的。</p><p><strong>Redis的第三个特性就是高可用和分布式。</strong>我们知道，Redis  是一个开源的基于内存的分布式数据库，因此，分布式和高可用也是Redis的一大特点。Redis中提供了分布式集群的实现，通过配置命令，我们可以轻松地进行分布式的扩展。</p><h2>如何安装和使用Redis数据库？</h2><p>了解了Redis数据库，接下来我们来学习一下 Redis  数据库的安装和使用方法。</p><p>实际上，在Windows系统下安装Redis的方法有两种。</p><p>第一种方法是使用官方的tar.gz包，由于官方没有提供Windows版本的安装包，所以如果你想使用官方的版本，只能通过源码进行安装。这样安装的好处是能够和Linux相通，当你学会了怎么在Windows上安装之后，在Linux上也能很快上手。</p><p>第二种方式是使用第三方提供的 MSI 版本的安装包。这个包从原则上来讲是非官方提供的，但好处是非常方便，不需要那么多的配置。我们目前的开发环境是在Windows系统上的，所以我们先使用第二种方式来安装Redis。</p><p>我们首先进入第三方的GitHub<a href=\"https://github.com/tporadowski/redis/releases\">首页</a>，然后选择一个我们需要的版本。为了和企业的大部分版本以及代码匹配，在这里我选择使用4.0.14.2 for Windows版本作为我们的开发版本。</p><p><img src=\"https://static001.geekbang.org/resource/image/9c/35/9c6yyeef07c852bb4fde87a2f5d23c35.png?wh=1736x666\" alt=\"\"></p><p>然后点击“Redis-x64-4.0.14.2.msi”进行下载，之后双击安装包来安装。</p><p><img src=\"https://static001.geekbang.org/resource/image/7a/d0/7ae63e83aa6eea087a3e74ed493e67d0.png?wh=771x600\" alt=\"\"></p><p>接下来，我们点击Next同意相关协议，再点击Next，这个时候会弹出路径选择界面，我将路径选择为I盘，这里我们要勾选“添加Redis安装目录到PATH环境变量”，如下图所示。</p><p><img src=\"https://static001.geekbang.org/resource/image/10/80/10b90018457808ece34b2ff45762a380.png?wh=776x602\" alt=\"\"></p><p>然后点击Next，这时会让你设置Redis的运行端口，在这里我们使用默认值6379即可。但是如果是在生产环境，我建议你换一个端口，防止被黑客攻击。同样，我们勾选“添加防火墙例外”，然后点击Next，如图所示。</p><p><img src=\"https://static001.geekbang.org/resource/image/74/26/74a00a96f0c15163583767e8382cd226.png?wh=776x602\" alt=\"\"></p><p>接下来我们一直选择Next，直到安装完成即可。当弹出如下界面时表示安装已经完成了。</p><p><img src=\"https://static001.geekbang.org/resource/image/ff/e9/ffc5306a057a5460764492400ee2bee9.png?wh=776x602\" alt=\"\"></p><p>我们可以在计算机服务选项中找到Redis。可以看到，Redis已经启动了，这也说明Redis已经安装成功了。</p><p><img src=\"https://static001.geekbang.org/resource/image/d8/87/d81dd15cd4e0ee5e783fbf30a0c17f87.png?wh=1173x829\" alt=\"\"></p><p>我们再来验证一下。打开cmd，输入redis-cli，这时会启动Redis客户端，如图所示。</p><p><img src=\"https://static001.geekbang.org/resource/image/cb/f2/cbd8624f92015d58cb3d3c6ce84790f2.png?wh=1464x757\" alt=\"\"></p><p>我们输入ping，如果返回PONG，说明安装成功。</p><p><img src=\"https://static001.geekbang.org/resource/image/1d/aa/1d61c7e049a9110b3a73ccac2635c6aa.png?wh=1467x763\" alt=\"\"></p><p>我们尝试向里面插入一条键为“hello”值为“recommendation system class”的数据，输入如下命令。</p><pre><code>set hello “recommendation system class”\n</code></pre><p>接着，我们用get hello命令查看一下是否set成功。当出现如下界面时，表示我们已经成功向Redis插入了数据并查询成功了。</p><p><img src=\"https://static001.geekbang.org/resource/image/6b/93/6bb4bb289d0e2df29a67703e624e8393.png?wh=1468x757\" alt=\"\"></p><h2>总结</h2><p>这节课就讲到这里，学完这节课你应该了解下面这些问题。</p><ol>\n<li>Redis数据库是一种基于内存的、开源的分布式数据库，它的特性非常多，其中最主要的三个就是基于内存存储、可持久化和分布式。</li>\n<li>我们还一起安装了Redis数据库并使用Redis数据库进行了简单的数据插入操作。在Redis安装的过程中，我们最需要注意的点就是，在安装时需要勾选“添加Redis安装目录到PATH环境变量”，以及在安装完成后，我们要在系统服务中确认Redis服务已经正常启动。</li>\n<li>我们可以在cmd命令行中，通过set/get命令，来进行一些简单的数据存储和查询，来验证数据库的正确性。</li>\n</ol><h2>课后题</h2><p>学完本节课，给你留两道课后题。</p><ol>\n<li>请你自己搭建一个Redis数据库，可以是在Windows上，也可以是在Linux上。</li>\n<li>使用Redis数据库创建一个DB，并插入一条数据，数据格式可以是一个JSON字符串。</li>\n</ol><p>你可以把你的问题写在留言区，我们一起交流讨论。我们下节课见！</p>","neighbors":{"left":{"article_title":"04｜MongoDB：如何安装和使用MongoDB数据库？","id":648830},"right":{"article_title":"06｜网络爬虫：爬取一个网站的流程是怎样的？","id":650545}},"comments":[{"had_liked":false,"id":372955,"user_name":"peter","can_delete":false,"product_type":"c1","uid":1058183,"ip_address":"北京","ucode":"261C3FC001DE2D","user_header":"https://static001.geekbang.org/account/avatar/00/10/25/87/f3a69d1b.jpg","comment_is_top":false,"comment_ctime":1681865969,"is_pvip":false,"replies":[{"id":136415,"content":"A1：Redis没有中心节点，各节点平等。每个节点都可以进行数据读写和处理请求。\nA2：Redis的速度快主要是因为采用单线程模型，避免了多线程同步带来的开销，并且采用了高效的内存存储方式。对硬件的要求相对较低，但是对内存的要求相对来说比较高。\nA3：AOF方式可以按照不同的策略进行写入，可以是每秒写入、每10秒写入或者每100条数据写入等等。可以通过配置文件设置相应的策略。\nA4：Redis的同类产品有Memcached、Couchbase、Apache Ignite等。\nA5：由于Redis的高人气和广泛应用，可能会成为黑客攻击的目标。但是，只要采取一些安全措施，如设置密码、限制访问IP等，就可以降低被攻击的风险。\nA6：Redis有多个GUI客户端，如Redis Desktop Manager、RedisInsight等。这些客户端是用来管理Redis数据的，但不是必须安装的。\nA7：Redis默认支持16个数据库，每个数据库可以存储不同的数据。如果某个数据库的存储空间不足，可以通过增加硬件容量或者使用分布式方式来解决。","user_name":"作者回复","user_name_real":"编辑","uid":1982950,"ctime":1682610976,"ip_address":"广东","comment_id":372955,"utype":1}],"discussion_count":2,"race_medal":0,"score":2,"product_id":100542801,"comment_content":"请教老师几个问题：\nQ1：Redis是分布式系统，那么有多个节点时，会有一个中心节点吗？还是各节点平等？\nQ2：Redis速度快，支持高达每秒 10 万次的并发请求，原因是什么？是因为单线程吗？ 另外，支持每秒 10 万次并发请求这个指标，对硬件有要求吗？（即，在一定的机器配置下才能达到这个指标）\nQ3：AOF方式，是即时写入吗？还是按一定的时间间隔写入（比如间隔10秒写入）？还是按照一定的数据数量写入（比如每100条数据写入）？\nQ4：Redis的同类产品有哪些？\nQ5：Redis经常受黑客攻击吗？\nQ6：记得Redis有一个GUI客户端，需要安装此客户端吗？\nQ7：Redis中选定一个数据库后，一直往里面添加数据，会溢出吗？如果会溢出，溢出后怎么处理？是存到下一个数据库吗？","like_count":1,"discussions":[{"author":{"id":1982950,"avatar":"https://static001.geekbang.org/account/avatar/00/1e/41/e6/beb42103.jpg","nickname":"黄鸿波","note":"","ucode":"5EB4E6946A363C","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":616188,"discussion_content":"A1：Redis没有中心节点，各节点平等。每个节点都可以进行数据读写和处理请求。\nA2：Redis的速度快主要是因为采用单线程模型，避免了多线程同步带来的开销，并且采用了高效的内存存储方式。对硬件的要求相对较低，但是对内存的要求相对来说比较高。\nA3：AOF方式可以按照不同的策略进行写入，可以是每秒写入、每10秒写入或者每100条数据写入等等。可以通过配置文件设置相应的策略。\nA4：Redis的同类产品有Memcached、Couchbase、Apache Ignite等。\nA5：由于Redis的高人气和广泛应用，可能会成为黑客攻击的目标。但是，只要采取一些安全措施，如设置密码、限制访问IP等，就可以降低被攻击的风险。\nA6：Redis有多个GUI客户端，如Redis Desktop Manager、RedisInsight等。这些客户端是用来管理Redis数据的，但不是必须安装的。\nA7：Redis默认支持16个数据库，每个数据库可以存储不同的数据。如果某个数据库的存储空间不足，可以通过增加硬件容量或者使用分布式方式来解决。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1682610976,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"广东","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":2429591,"avatar":"https://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTJ5sXrTGCq7nlvg8bBzjWtgFU0bXnSiangWBF6Uss3lfnyHeEaplKDBaWWZQNMvhQVxLXyrEEw7rNw/132","nickname":"weiwei","note":"","ucode":"8AF2A0BD93010C","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":614700,"discussion_content":"提问大师，哈哈","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1681874946,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":"浙江","group_id":0},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":374811,"user_name":"Geek9469","can_delete":false,"product_type":"c1","uid":2845018,"ip_address":"广东","ucode":"68F748727D3373","user_header":"","comment_is_top":false,"comment_ctime":1684461455,"is_pvip":false,"replies":[{"id":136881,"content":"这种情况一般需要去增加Redis的集群或者机器内存来解决这个问题，没有太好的解决办法。","user_name":"作者回复","user_name_real":"编辑","uid":1982950,"ctime":1684858213,"ip_address":"广东","comment_id":374811,"utype":1}],"discussion_count":2,"race_medal":0,"score":2,"product_id":100542801,"comment_content":"有遇到过redis里面的画像太大，导致redis cpu经常告警的吗？","like_count":0,"discussions":[{"author":{"id":1982950,"avatar":"https://static001.geekbang.org/account/avatar/00/1e/41/e6/beb42103.jpg","nickname":"黄鸿波","note":"","ucode":"5EB4E6946A363C","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":619198,"discussion_content":"这种情况一般需要去增加Redis的集群或者机器内存来解决这个问题，没有太好的解决办法。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1684858213,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"广东","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1258480,"avatar":"https://static001.geekbang.org/account/avatar/00/13/33/f0/50c773cd.jpg","nickname":"全国花式伸脖子蹬腿锦标赛冠军🏆","note":"","ucode":"77181EEE13E761","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":626840,"discussion_content":"画像是啥，新手求教","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1693442622,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":"重庆","group_id":0},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":373031,"user_name":"云中君","can_delete":false,"product_type":"c1","uid":1448032,"ip_address":"北京","ucode":"52FECFBFECBA40","user_header":"https://static001.geekbang.org/account/avatar/00/16/18/60/ecdb8ff9.jpg","comment_is_top":false,"comment_ctime":1681954109,"is_pvip":false,"replies":null,"discussion_count":0,"race_medal":0,"score":2,"product_id":100542801,"comment_content":"好着急…","like_count":4},{"had_liked":false,"id":373998,"user_name":"未来已来","can_delete":false,"product_type":"c1","uid":1187130,"ip_address":"广东","ucode":"3A21ACFD53CB9C","user_header":"https://static001.geekbang.org/account/avatar/00/12/1d/3a/cdf9c55f.jpg","comment_is_top":false,"comment_ctime":1683465872,"is_pvip":false,"replies":null,"discussion_count":0,"race_medal":0,"score":2,"product_id":100542801,"comment_content":"Mac（intel CPU）安装 Redis 可以看下这个：https:&#47;&#47;blog.csdn.net&#47;realize_dream&#47;article&#47;details&#47;106227622","like_count":1},{"had_liked":false,"id":385194,"user_name":"悟尘","can_delete":false,"product_type":"c1","uid":2189310,"ip_address":"北京","ucode":"4E7E854340D3A4","user_header":"https://static001.geekbang.org/account/avatar/00/21/67/fe/5d17661a.jpg","comment_is_top":false,"comment_ctime":1702278874,"is_pvip":false,"replies":null,"discussion_count":0,"race_medal":0,"score":2,"product_id":100542801,"comment_content":"这个Redis和上一节的MongoDB其实能合成一个章节的。","like_count":0},{"had_liked":false,"id":374813,"user_name":"Geek9469","can_delete":false,"product_type":"c1","uid":2845018,"ip_address":"广东","ucode":"68F748727D3373","user_header":"","comment_is_top":false,"comment_ctime":1684461546,"is_pvip":false,"replies":null,"discussion_count":0,"race_medal":0,"score":2,"product_id":100542801,"comment_content":"有遇到过redis里面的画像太大，导致读取的时候经常告警的吗？或者是你们的redis里面一般都存什么数据？有用L1本地缓存解决不？","like_count":0},{"had_liked":false,"id":374812,"user_name":"Geek9469","can_delete":false,"product_type":"c1","uid":2845018,"ip_address":"广东","ucode":"68F748727D3373","user_header":"","comment_is_top":false,"comment_ctime":1684461498,"is_pvip":false,"replies":null,"discussion_count":0,"race_medal":0,"score":2,"product_id":100542801,"comment_content":"有遇到过redis 里面的画像太大，读取的时候，导致经常告警的吗？","like_count":0}]}