{"id":740963,"title":"练习：碰撞模拟","content":"\n<p><strong>6.1</strong> 根据正文完成 <code>predictCollisions()</code> 和 <code>Particle</code> 的实现。决定一对刚性球体进行弹性碰撞后的运动状态需要 3 个公式：(a) 动量守恒，(b) 动能守恒，(c) 碰撞时，相互作用力和碰撞点的切面垂直（假设没有摩擦力和自旋）。更多细节请见本书的网站。</p>\n<p><strong>6.2</strong> 开发一个版本的 <code>CollisionSystem</code>、<code>Particle</code> 和 <code>Event</code> 类，使之能够处理多个粒子的相互碰撞。在模拟台球比赛的开球时这是非常重要的。（这道习题很难！）</p>\n<p><strong>6.3</strong> 开发一个三维版本的 <code>CollisionSystem</code>、<code>Particle</code> 和 <code>Event</code> 类。</p>\n<p><strong>6.4</strong> 尝试将大片区域分割为长方形的小格，并在一种新的事件类型中仅预测某个粒子在某一时刻和相邻的 9 个方格中的所有粒子的碰撞。用这种方法改进 <code>CollisionSystem</code> 的 <code>simulate()</code> 方法的性能。这种方法减少了需要计算的预测碰撞数量，代价是需要监视所有粒子在方格之间的运动。</p>\n<p><strong>6.5</strong> 在 <code>CollisionSystem</code> 中引入<strong>熵</strong>的概念并用它验证（信息论中的）经典结论。</p>\n<p><strong>6.6</strong> <strong>布朗运动</strong>。1827 年，植物学家罗伯特·布朗在用显微镜观察到浸入水中的野生花粉颗粒时，发现它们在进行无规则的运动。这种运动后来被称为布朗运动。人们讨论了这种现象，但没人能够给出令人信服的解释，直到爱因斯坦在 1905 年在数学上说明了这个问题。爱因斯坦的解释是：花粉颗粒的运动是由无数微小的分子和花粉粒子相撞造成的。请用模拟来说明这个现象。</p><!-- [[[read_end]]] -->\n<p><strong>6.7</strong> <strong>温度</strong>。为 <code>Particle</code> 类添加一个 <code>temperature()</code> 方法，返回粒子的质量和速度的平方除以 <img img src=\"https://static001.geekbang.org/files/resource/ebook/100010/image01880.gif\" alt=\"{\\rm d}k_B\" inline-img=\"true\" /> 的商之积，其中空间维数 <img img src=\"https://static001.geekbang.org/files/resource/ebook/100010/image01881.gif\" alt=\"d=2\" inline-img=\"true\" />，<code>Boltzmann</code> 常数 <img img src=\"https://static001.geekbang.org/files/resource/ebook/100010/image01882.gif\" alt=\"k_B=1.3806488\\times10^{-23}\" inline-img=\"true\" />。系统的温度是所有粒子的这些量的平均值。为 <code>CollisionSystem</code> 添加一个 <code>temperature()</code> 方法，周期性采集温度数据并绘成图表，检查温度是否恒定。</p>\n<p><strong>6.8</strong> Maxwell-Boltzmann。刚性球体模型中的所有粒子的速度分布遵循 <strong>Maxwell-Boltzmann 分布</strong>（假设系统已经被加热且粒子的质量足以忽略量子力学效应），在二维系统中又被称为 <strong>Rayleigh 分布</strong>。分布的形状取决于温度。编写一个方法计算粒子速度的直方图并在各种温度下测试它。</p>\n<p><strong>6.9</strong> <strong>任意形状</strong>。分子的移动速度非常快（超过喷气式飞机）但扩散却很慢，因为它们会互相碰撞并因此改变方向。扩展模型，将两个容器用一根管道相连，容器中分别含有两种不同类型的粒子。模拟粒子的运动并以时间的函数测量每个容器中每种类型的粒子的比例。</p>\n<p><strong>6.10</strong> <strong>回退</strong>。在某次模拟结束后，将所有速度变为相反的方向并继续模拟系统中的运动，它应该能够回到最初的状态！测量系统的最终状态和初始状态的差异来估计四舍五入造成的误差。</p>\n<p><strong>6.11</strong> <strong>压强</strong>。为 <code>Particle</code> 类添加一个 <code>pressure()</code> 方法来测量大量粒子和墙体碰撞造成的压强。系统的压强为所有粒子的冲击力之和。为 <code>CollisionSystem</code> 类添加一个 <code>pressure()</code> 方法并编写一个用例验证等式 <img img src=\"https://static001.geekbang.org/files/resource/ebook/100010/image01883.gif\" alt=\"pv=nRT\" inline-img=\"true\" />。</p>\n<p><strong>6.12</strong> <strong>基于索引优先队列的实现</strong>。开发一个版本的 <code>CollisionSystem</code>，使用索引优先队列来保证优先队列的长度最多与粒子数量呈线性关系（而非平方级别或者更糟）。</p>\n<p><strong>6.13</strong> <strong>优先队列的性能</strong>。使用优先队列，在多种温度下测试 <code>Pressure</code> 类来定位计算的瓶颈。如果可以，尝试切换到另一种不同的优先队列实现，在高温下获取更好的性能。</p>\n","comments":[]}