{"id":141679,"title":"08 | MVCæ¶æ„è§£æï¼šæ¨¡å‹ï¼ˆModelï¼‰ç¯‡","content":"<p>ä½ å¥½ï¼Œæˆ‘æ˜¯å››ç«ã€‚</p><p>åœ¨ä¸Šä¸€è®²ä¸­ï¼Œæˆ‘ä»¬äº†è§£äº† MVC è¿™ä¸ªè€è€Œå¼¥åšçš„æ¶æ„æ¨¡å¼ï¼Œè€Œä»è¿™ä¸€è®²å¼€å§‹ï¼Œè¿åŒç¬¬  09ã€10  è®²å…±è®¡ 3 ç¯‡ï¼Œæˆ‘å°†åˆ†åˆ«å±•å¼€ä»‹ç» MVC ä¸‰å¤§éƒ¨åˆ†å†…å®¹ã€‚ä»Šå¤©æˆ‘è¦è®²çš„å°±æ˜¯ç¬¬ä¸€éƒ¨åˆ†â€”â€”æ¨¡å‹ï¼ˆModelï¼‰ã€‚</p><h2>æ¦‚å¿µ</h2><p>é¦–å…ˆæˆ‘ä»¬è¦äº†è§£çš„æ˜¯ï¼Œæˆ‘ä»¬æ€»åœ¨è°ˆâ€œæ¨¡å‹â€ï¼Œé‚£åˆ°åº•ä»€ä¹ˆæ˜¯æ¨¡å‹ï¼Ÿ</p><p>ç®€å•è¯´æ¥ï¼Œ<strong>æ¨¡å‹å°±æ˜¯å½“æˆ‘ä»¬ä½¿ç”¨è½¯ä»¶å»è§£å†³çœŸå®ä¸–ç•Œä¸­å„ç§å®é™…é—®é¢˜çš„æ—¶å€™ï¼Œå¯¹é‚£äº›æˆ‘ä»¬å…³å¿ƒçš„å®é™…äº‹ç‰©çš„æŠ½è±¡å’Œç®€åŒ–</strong>ã€‚æ¯”å¦‚æˆ‘ä»¬åœ¨è½¯ä»¶ç³»ç»Ÿä¸­è®¾è®¡â€œäººâ€è¿™ä¸ªäº‹ç‰©ç±»å‹çš„æ—¶å€™ï¼Œé€šå¸¸åªä¼šè€ƒè™‘å§“åã€æ€§åˆ«å’Œå¹´é¾„ç­‰ä¸€äº›ç³»ç»Ÿç”¨å¾—ç€çš„å¿…è¦å±æ€§ï¼Œè€Œä¸ä¼šæŠŠæ€§æ ¼ã€è¡€å‹å’Œç”Ÿè¾°å…«å­—ç­‰æˆ‘ä»¬ä¸å…³å¿ƒçš„ä¸œè¥¿æ”¾è¿›å»ã€‚</p><p>æ›´è¿›ä¸€æ­¥è®²ï¼Œæˆ‘ä»¬ä¼šè°ˆé¢†åŸŸæ¨¡å‹ï¼ˆDomain Modelï¼‰ã€‚â€œé¢†åŸŸâ€ä¸¤ä¸ªå­—æ˜¾ç„¶ç»™å‡ºäº†æŠ½è±¡å’Œç®€åŒ–çš„èŒƒå›´ï¼Œä¸åŒçš„è½¯ä»¶ç³»ç»Ÿæ‰€å±çš„é¢†åŸŸæ˜¯ä¸åŒçš„ï¼Œæ¯”å¦‚é‡‘èè½¯ä»¶ã€åŒ»ç–—è½¯ä»¶å’Œç¤¾äº¤è½¯ä»¶ç­‰ç­‰ã€‚å¦‚ä»Šé¢†åŸŸæ¨¡å‹çš„æ¦‚å¿µåŒ…å«äº†æ¯”å…¶åŸæœ¬èŒƒå›´å®šä¹‰ä»¥å¤–æ›´å¤šçš„å†…å®¹ï¼Œ<strong>æˆ‘ä»¬ä¼šæ›´å…³æ³¨è¿™ä¸ªé¢†åŸŸèŒƒå›´å†…å„ä¸ªæ¨¡å‹å®ä½“ä¹‹é—´çš„å…³ç³»</strong>ã€‚</p><p>MVC ä¸­çš„â€œæ¨¡å‹â€ï¼Œè¯´çš„æ˜¯â€œæ¨¡å‹å±‚â€ï¼Œå®ƒæ­£æ˜¯ç”±ä¸Šè¿°çš„é¢†åŸŸæ¨¡å‹æ¥å®ç°çš„ï¼Œå¯æ˜¯å½“æˆ‘ä»¬è®²è¿™ä¸€å±‚çš„æ—¶å€™ï¼Œå®ƒåŒ…å«äº†æ¨¡å‹ä¸Šæ‰¿è½½çš„å®å®åœ¨åœ¨çš„ä¸šåŠ¡æ•°æ®ï¼Œè¿˜æœ‰ä¸åŒæ•°æ®é—´çš„å…³è”å…³ç³»ã€‚å› æ­¤ï¼Œ<strong>æˆ‘ä»¬åœ¨è°ˆæ¨¡å‹å±‚çš„æ—¶å€™ï¼Œæœ‰æ—¶å€™ä¼šæ›´å…³å¿ƒé¢†åŸŸæ¨¡å‹è¿™ä¸€æŠ½è±¡æ¦‚å¿µæœ¬èº«ï¼Œæœ‰æ—¶å€™åˆ™ä¼šæ›´å…³å¿ƒæ•°æ®æœ¬èº«</strong>ã€‚</p><!-- [[[read_end]]] --><h2>è´«è¡€æ¨¡å‹å’Œå……è¡€æ¨¡å‹</h2><p>ç¬¬ä¸€æ¬¡å¬åˆ°â€œè´«è¡€æ¨¡å‹â€â€œå……è¡€æ¨¡å‹â€è¿™ä¸¤ä¸ªè¯çš„æ—¶å€™ï¼Œå¯èƒ½ä½ å°±ä¼šé—®äº†ï¼Œä»€ä¹ˆç©æ„å„¿ï¼Ÿé¢†åŸŸæ¨¡å‹è¿˜æœ‰è´«è¡€å’Œå……è¡€ä¹‹è¯´ï¼Ÿ</p><p>å…¶å®ï¼Œè¿™ä¸¤å…„å¼Ÿæ˜¯ Martin Fowler é€ å‡ºæ¥çš„æ¦‚å¿µã€‚è¦äº†è§£å®ƒä»¬ï¼Œå¾—å…ˆçŸ¥é“è¿™é‡Œè®²çš„â€œè¡€â€æ˜¯ä»€ä¹ˆã€‚</p><p>è¿™é‡Œçš„â€œè¡€â€ï¼Œå°±æ˜¯é€»è¾‘ã€‚å®ƒæ—¢åŒ…æ‹¬æˆ‘ä»¬æœ€å…³å¿ƒçš„ä¸šåŠ¡é€»è¾‘ï¼Œä¹ŸåŒ…å«éä¸šåŠ¡é€»è¾‘ ã€‚å› æ­¤ï¼Œ<strong>è´«è¡€æ¨¡å‹ï¼ˆAnemic Domain Modelï¼‰ï¼Œæ„å‘³ç€æ¨¡å‹å®ä½“åœ¨è®¾è®¡å’Œå®ç°ä¸Šï¼Œä¸åŒ…å«æˆ–åŒ…å«å¾ˆå°‘çš„é€»è¾‘ã€‚</strong>é€šå¸¸è¿™ç§æƒ…å†µä¸‹ï¼Œé€»è¾‘æ˜¯è¢«æŒªäº†å‡ºå»ï¼Œç”±å…¶å®ƒå•ç‹¬çš„ä¸€å±‚ä»£ç ï¼ˆæ¯”å¦‚è¿™å±‚ä»£ç æ˜¯â€œServiceâ€ï¼‰æ¥å®Œæˆã€‚</p><p>ä¸¥æ ¼è¯´èµ·æ¥ï¼Œè´«è¡€æ¨¡å‹ä¸æ˜¯é¢å‘å¯¹è±¡çš„ï¼Œå› ä¸ºå¯¹è±¡éœ€è¦æ•°æ®å’Œé€»è¾‘çš„ç»“åˆï¼Œè¿™ä¹Ÿæ˜¯è´«è¡€æ¨¡å‹åå¯¹è€…çš„é‡è¦è§‚ç‚¹ä¹‹ä¸€ã€‚å¦‚æœä¸»è¦é€»è¾‘åœ¨ Service é‡Œé¢ï¼Œè¿™ä¸€å±‚å¯¹å¤–æš´éœ²çš„æ¥å£ä¹Ÿåœ¨ Service ä¸Šï¼Œé‚£ä¹ˆäº‹å®ä¸Šå®ƒå°±å˜æˆäº†é¢å‘â€œæœåŠ¡â€çš„äº†ï¼Œè€Œæ¨¡å‹å®ä½“ï¼Œå®é™…åªæ‰®æ¼”äº† Service API äº¤äº’å…¥å‚å‡ºå‚çš„è§’è‰²ï¼Œæˆ–è€…ä»æœ¬è´¨ä¸Šè¯´ï¼Œå®ƒåªæ˜¯éµå¾ªäº†ä¸€å®šå°è£…è§„åˆ™çš„å®¹å™¨è€Œå·²ã€‚</p><p><strong>è¿™æ—¶çš„æ¨¡å‹å®ä½“ï¼Œä¸åŒ…å«é€»è¾‘ï¼Œä½†åŒ…å«çŠ¶æ€ï¼Œè€Œé€»è¾‘è¢«è§£è€¦åˆ°äº†æ— çŠ¶æ€ Service ä¸­ã€‚</strong>æ—¢ç„¶æ²¡æœ‰äº†çŠ¶æ€ï¼ŒService ä¸­çš„æ–¹æ³•ï¼Œå°±æˆä¸ºè¿‡ç¨‹å¼ä»£ç çš„äº†ã€‚è¯·æ³¨æ„ï¼Œä¸å®Œå…¨é¢å‘å¯¹è±¡å¹¶ä¸ä»£è¡¨å®ƒä¸€å®šâ€œä¸å¥½â€ï¼Œäº‹å®ä¸Šï¼Œåœ¨äº’è”ç½‘åº”ç”¨è®¾è®¡ä¸­ï¼Œè´«è¡€æ¨¡å‹å’Œå……è¡€æ¨¡å¼éƒ½æœ‰å¾ˆå¤šæˆåŠŸçš„ä½¿ç”¨æ¡ˆä¾‹ï¼Œä¸”éå¸¸å¸¸è§ã€‚</p><p>æ¯”å¦‚è¿™æ ·çš„ä¸€ä¸ªåä¸º Book çš„ç±»ï¼š</p><pre><code>public class Book {\n    private int id;\n    private boolean onLoan;\n    \n    public int getId() {\n        return this.id;\n    }\n    public void setId(int id) {\n        this.id = id;\n    }\n    public boolean isOnLoan() {\n        return this.loan;\n    }\n    public void setOnLoan(boolean onLoan) {\n        this.onLoan = onLoan;\n    }\n}\n</code></pre><p>ä½ å¯ä»¥çœ‹åˆ°ï¼Œå®ƒå¹¶æ²¡æœ‰ä»»ä½•å®è´¨ä¸Šçš„é€»è¾‘åœ¨é‡Œé¢ï¼Œæ–¹æ³•ä¹Ÿåªæœ‰ç®€å•çš„ getters å’Œ setters ç­‰å±æ€§è·å–å’Œè®¾ç½®æ–¹æ³•ï¼Œå®ƒæ‰®æ¼”çš„è§’è‰²åŸºæœ¬åªæ˜¯ä¸€ä¸ªç”¨ä½œå°è£…çš„å®¹å™¨ã€‚</p><p>é‚£ä¹ˆçœŸæ­£çš„é€»è¾‘ï¼Œç‰¹åˆ«æ˜¯ä¸šåŠ¡é€»è¾‘åœ¨å“ªé‡Œå‘¢ï¼Ÿæœ‰è¿™æ ·ä¸€ä¸ª Serviceï¼š</p><pre><code>public class BookService {\n    public Book lendOut(int bookId, int userId, Date date) { ... }\n}\n</code></pre><p>è¿™ä¸ª lendOut æ–¹æ³•è¡¨ç¤ºå°†ä¹¦ä»å›¾ä¹¦é¦†å€Ÿå‡ºï¼Œå› æ­¤å®ƒéœ€è¦æ¥æ”¶å›¾ä¹¦ id å’Œ ç”¨æˆ· idã€‚åœ¨å®ç°ä¸­ï¼Œå¯èƒ½éœ€è¦æ ¡éªŒå‚æ•°ï¼Œå¯èƒ½éœ€è¦æŸ¥è¯¢æ•°æ®åº“ï¼Œå¯èƒ½éœ€è¦å°†ä»æ•°æ®æºè·å¾—çš„åŸå§‹æ•°æ®è£…é…åˆ°è¿”å›å¯¹è±¡ä¸­ï¼Œå¯èƒ½éœ€è¦åº”ç”¨è¿‡æ»¤æ¡ä»¶ï¼Œè¿™é‡Œçš„å†…å®¹ï¼Œå°±æ˜¯é€»è¾‘ã€‚</p><p>ç°åœ¨ï¼Œæˆ‘ä»¬å†æ¥äº†è§£ä¸€ä¸‹å……è¡€æ¨¡å‹ï¼ˆRich Domain Modelï¼‰ã€‚<strong>åœ¨å……è¡€æ¨¡å‹çš„è®¾è®¡ä¸­ï¼Œé¢†åŸŸæ¨¡å‹å®ä½“å°±æ˜¯æœ‰è¡€æœ‰è‚‰çš„äº†ï¼Œæ—¢åŒ…å«æ•°æ®ï¼Œä¹ŸåŒ…å«é€»è¾‘ï¼Œå…·å¤‡äº†æ›´é«˜ç¨‹åº¦çš„å®Œå¤‡æ€§å’Œè‡ªæ°æ€§</strong>ï¼Œå¹¶ä¸”ï¼Œå……è¡€æ¨¡å‹çš„è®¾è®¡æ‰æ˜¯çœŸæ­£é¢å‘å¯¹è±¡çš„ã€‚åœ¨è¿™ç§è®¾è®¡ä¸‹ï¼Œæˆ‘ä»¬çœ‹ä¸åˆ° XXXService è¿™æ ·çš„ç±»äº†ï¼Œè€Œæ˜¯é€šè¿‡æ“çºµæœ‰çŠ¶æ€çš„æ¨¡å‹å®ä½“ç±»ï¼Œå°±å¯ä»¥è¾¾åˆ°æ•°æ®å˜æ›´çš„ç›®çš„ã€‚</p><pre><code>public class Book {\n    private int id;\n    private boolean onLoan;\n    public void lendOut(User user, Date date) { ... }\n    ... // çœç•¥å±æ€§çš„è·å–å’Œè®¾ç½®æ–¹æ³•\n}\n</code></pre><p>åœ¨è¿™ç§æ–¹å¼ä¸‹ï¼ŒlendOut æ–¹æ³•ä¸å†éœ€è¦ä¼ å…¥ bookIdï¼Œå› ä¸ºå®ƒå°±åœ¨ Book å¯¹è±¡é‡Œé¢å­˜ç€å‘¢ï¼›ä¹Ÿä¸å†éœ€è¦ä¼ å‡º Book å¯¹è±¡ä½œä¸ºè¿”å›å€¼ï¼Œå› ä¸ºçŠ¶æ€çš„æ”¹å˜ç›´æ¥åæ˜ åœ¨ Book å¯¹è±¡å†…éƒ¨äº†ï¼Œå³ onLoan ä¼šå˜æˆ trueã€‚</p><p>ä¹Ÿå°±æ˜¯è¯´ï¼ŒBook çš„è¡Œä¸ºå’Œæ•°æ®å®Œå®Œå…¨å…¨è¢«å°è£…çš„æ–¹æ³•æ§åˆ¶èµ·æ¥äº†ï¼Œä¸­é—´ä¸ä¼šå­˜åœ¨ä¸åº”è¯¥å‡ºç°çš„ä¸ä¸€è‡´çŠ¶æ€ï¼Œå› ä¸ºä»»ä½•æ”¹å˜çŠ¶æ€çš„è¡Œä¸ºåªèƒ½é€šè¿‡ Book çš„ç‰¹å®šæ–¹æ³•æ¥è¿›è¡Œï¼Œè€Œå®ƒæ˜¯å¯ä»¥è¢«è®¾è®¡è€…ä¸¥æ ¼æŠŠæ§çš„ã€‚</p><p>è€Œåœ¨è´«è¡€æ¨¡å‹ä¸­å°±åšä¸åˆ°è¿™ä¸€ç‚¹ï¼Œä¸€æ˜¯å› ä¸ºæ•°æ®å’Œè¡Œä¸ºåˆ†æ•£åœ¨ä¸¤å¤„ï¼ŒäºŒæ˜¯ä¸ºäº†åœ¨ Service ä¸­èƒ½ç»„è£…æ¨¡å‹ï¼Œæ¨¡å‹å®ä½“ä¸­æœ¬ä¸è¯¥å¯¹ç”¨æˆ·å¼€æ”¾çš„æ¥å£ä¼šè¢«è¿«æš´éœ²å‡ºæ¥ï¼Œäºæ˜¯æ•´ä¸ªè¿‡ç¨‹ä¸­å°±ä¼šå­˜åœ¨çŠ¶æ€ä¸ä¸€è‡´çš„å¯èƒ½ã€‚</p><p>ä½†æ˜¯è¯·æ³¨æ„ï¼Œ<strong>æ— è®ºæ˜¯å……è¡€æ¨¡å‹è¿˜æ˜¯è´«è¡€æ¨¡å‹ï¼Œå®ƒå’Œ Model å±‚åšåˆ°ä½•ç§ç¨‹åº¦çš„è§£è€¦å¾€å¾€æ²¡æœ‰å¤ªå¤§å…³ç³»ã€‚</strong>æ¯”å¦‚è¯´è¿™ä¸ª lendOut æ–¹æ³•ï¼Œåœ¨æŸäº›è®¾è®¡ä¸­ï¼Œå®ƒå¯ä»¥æ‹†åˆ†å‡ºå»ã€‚å¯¹äºè´«è¡€æ¨¡å‹æ¥è¯´ï¼Œå®ƒå¹¶éå®Œå…¨å±äº BookServiceï¼Œå¯ä»¥æ‹¿åˆ°æ–°å»ºç«‹çš„â€œå€Ÿä¹¦å…³ç³»â€çš„æœåŠ¡ä¸­å»ï¼Œæ¯”å¦‚ï¼š</p><pre><code>public class LoanService {\n    public Loan add(int bookId, int userId, Date date) { ... }\n}\n</code></pre><p>è¿™æ ·ä¸€æ¥ï¼Œå€Ÿä¹¦çš„å…³ç³»å°±å¯ä»¥å•ç‹¬ç»´æŠ¤äº†ï¼Œå€Ÿä¹¦è¡Œä¸ºå‘ç”Ÿçš„æ—¶å€™ï¼ŒBook å’Œ User ä¸¤ä¸ªå®ä½“å¯¹åº”çš„æ•°æ®éƒ½ä¸éœ€è¦å‘ç”Ÿå˜åŒ–ï¼Œåªéœ€è¦æ”¹å˜è¿™ä¸ªå€Ÿä¹¦å…³ç³»çš„æ•°æ®å°±å¯ä»¥äº†ã€‚å¯¹äºå……è¡€æ¨¡å‹æ¥è¯´ï¼Œä¸€æ ·å¯ä»¥åšç±»ä¼¼æ‹†åˆ†ã€‚</p><h2>å†…éƒ¨å±‚æ¬¡åˆ’åˆ†</h2><p>è½¯ä»¶çš„è€¦åˆå’Œå¤æ‚æ€§é—®é¢˜å¾€å¾€éƒ½å¯ä»¥é€šè¿‡åˆ†å±‚è§£å†³ï¼Œæ¨¡å‹å±‚å†…éƒ¨ä¹Ÿä¸€æ ·ï¼Œä½†æ˜¯æˆ‘ä»¬éœ€è¦æŠŠæ¡å…¶ä¸­çš„åº¦ã€‚<strong>å±‚æ¬¡åˆ’åˆ†è¿‡å¤šã€è¿‡ç»†ï¼Œå¹¶ä¸åˆ©äºå¼€å‘äººå‘˜ä¸¥æ ¼éµä»å’Œä¿æŒå±‚æ¬¡çš„æ¸…æ™°ï¼Œä¹Ÿå®¹æ˜“å¯¼è‡´äº§ç”Ÿè¿‡å¤šçš„æ— ç”¨æ ·æ¿ä»£ç ï¼Œä»è€Œé™ä½å¼€å‘æ•ˆç‡ã€‚</strong>ä¸‹é¢æ˜¯ä¸€ç§æ¯”è¾ƒå¸¸è§çš„ Model å±‚ï¼Œå®ƒæ˜¯åŸºäºè´«è¡€æ¨¡å‹çš„åˆ†å±‚æ–¹å¼ã€‚</p><p><img src=\"https://static001.geekbang.org/resource/image/f6/46/f6e1b220a80716532ac6dd54cb1b9f46.png?wh=820*403\" alt=\"\"></p><p>åœ¨è¿™ç§åˆ’åˆ†æ–¹å¼ä¸‹ï¼Œæ¯ä¸€å±‚éƒ½å¯ä»¥è°ƒç”¨è‡ªèº«æ‰€å±å±‚ä¸Šçš„å…¶å®ƒç±»ï¼Œä¹Ÿå¯ä»¥è°ƒç”¨è‡ªå·±ä¸‹æ–¹ä¸€å±‚çš„ç±»ï¼Œä½†æ˜¯ä¸å…è®¸å¾€ä¸Šè°ƒç”¨ï¼Œå³ä¾èµ–å…³ç³»æ€»æ˜¯â€œé ä¸Šé¢çš„å±‚â€ä¾èµ–ç€â€œé ä¸‹é¢çš„å±‚â€ã€‚æœ€ä¸Šé¢ä¸‰å±‚æ˜¯å’Œä¸šåŠ¡æ¨¡å‹å®ä½“ç›¸å…³çš„ï¼Œè€Œæœ€ä¸‹é¢ä¸€å±‚æ˜¯åŸºç¡€è®¾æ–½æœåŠ¡ï¼Œå’Œä¸šåŠ¡æ— å…³ã€‚ä»ä¸Šåˆ°ä¸‹ï¼Œæˆ‘æŠŠå„å±‚ä¾æ¬¡ç®€å•ä»‹ç»ä¸€ä¸‹ï¼š</p><ul>\n<li>ç¬¬ä¸€å±‚ Facadeï¼Œæä¾›ç²—ç²’åº¦çš„æ¥å£ï¼Œé€»è¾‘ä¸Šæ˜¯å¯¹ Service åŠŸèƒ½çš„ç»„åˆã€‚æœ‰æ—¶å€™ç”±äºäº‹åŠ¡éœ€è¦è·¨å¤šä¸ªé¢†åŸŸæ¨¡å‹çš„å®ä½“æ§åˆ¶ï¼Œé‚£å°±é€‚åˆæ”¾åœ¨è¿™é‡Œã€‚ä¸¾ä¾‹æ¥è¯´ï¼Œåˆ›å»ºç”¨æˆ·çš„æ—¶å€™ï¼Œæˆ‘ä»¬åŒæ—¶å…è´¹èµ é€ä¸€æœ¬ç”µå­ä¹¦ç»™ç”¨æˆ·ï¼Œæˆ‘ä»¬æ—¢è¦è°ƒç”¨ UserService å»åˆ›å»ºç”¨æˆ·å¯¹è±¡ï¼Œä¹Ÿè¦è°ƒç”¨ SubscriptionService å»æ·»åŠ ä¸€æ¡è®¢è´­ï¼ˆèµ é€ï¼‰è®°å½•ï¼Œè€Œè¿™ä¸¤ä¸ªå±äºä¸åŒ Service çš„è¡Œä¸ºéœ€è¦æ”¾åˆ°ä¸€å¤„ Facade ç±»é‡Œé¢åšç»Ÿä¸€äº‹åŠ¡æ§åˆ¶ã€‚åœ¨æŸäº›è¾ƒå°ç³»ç»Ÿçš„è®¾è®¡é‡Œé¢ï¼ŒService å’Œ Facade è¿™ä¸¤å±‚æ˜¯ç³…åˆåœ¨ä¸€èµ·çš„ã€‚</li>\n<li>ç¬¬äºŒå±‚ Serviceï¼Œå‰é¢å·²ç»ä»‹ç»äº†ï¼Œé€šå¸¸ä¼šå­˜æ”¾ä»…å±äºå•ä¸ªé¢†åŸŸæ¨¡å‹å®ä½“çš„æ“ä½œã€‚</li>\n<li>ç¬¬ä¸‰å±‚æ•°æ®è®¿é—®å±‚ï¼Œåœ¨æŸäº›ç±»å‹çš„æ•°æ®è®¿é—®ä¸­éœ€è¦ï¼Œæ¯”å¦‚å…³ç³»å‹æ•°æ®åº“ï¼Œè¿™é‡Œå­˜æ”¾æ•°æ®åº“å­—æ®µå’Œæ¨¡å‹å¯¹è±¡ä¹‹é—´çš„ ORMï¼ˆObject-Relational Mappingï¼Œå¯¹è±¡å…³ç³»æ˜ å°„ï¼‰å…³ç³»ã€‚</li>\n<li>ç¬¬å››å±‚åŸºç¡€è®¾æ–½å±‚ï¼Œè¿™ä¸€å±‚çš„é€šç”¨æ€§æœ€å¥½ï¼Œå¿…é¡»å’Œä¸šåŠ¡æ— å…³ã€‚æŸäº›æ¡†æ¶ä¼šæŠŠåŸºç¡€è®¾æ–½çš„å·¥ä½œç»™åšäº†ï¼Œä½†æœ‰æ—¶å€™ä¹Ÿéœ€è¦æˆ‘ä»¬è‡ªå·±å®ç°ã€‚æ¯”å¦‚ S3Serviceï¼Œå­˜æ”¾æ•°æ®åˆ°äºšé©¬é€Šçš„åˆ†å¸ƒå¼æ–‡ä»¶ç³»ç»Ÿã€‚</li>\n</ul><h2>CQRS æ¨¡å¼</h2><p>ä½ ä¹Ÿè®¸å¬è¯´è¿‡æ•°æ®åº“çš„è¯»å†™åˆ†ç¦»ï¼Œå…¶å®ï¼Œåœ¨æ¨¡å‹çš„è®¾è®¡ä¸­ï¼Œä¹Ÿæœ‰ç±»ä¼¼è¯»å†™åˆ†ç¦»çš„æœºåˆ¶ï¼Œå…¶ä¸­æœ€å¸¸è§çš„ä¸€ç§å°±å«åš CQRSï¼ˆCommand Query Responsibility Segregationï¼Œå‘½ä»¤æŸ¥è¯¢èŒè´£åˆ†ç¦»ï¼‰ã€‚</p><p>ä¸€èˆ¬æˆ‘ä»¬è®¾è®¡çš„ä¸šåŠ¡æ¨¡å‹ï¼Œä¼šåŒæ—¶è¢«ç”¨ä½œè¯»ï¼ˆæŸ¥è¯¢æ¨¡å¼ï¼‰å’Œå†™ï¼ˆå‘½ä»¤æ¨¡å¼ï¼‰ï¼Œä½†æ˜¯ï¼Œå®é™…ä¸Šè¿™ä¸¤è€…æ˜¯æœ‰æ˜æ˜¾åŒºåˆ«çš„ï¼Œåœ¨ä¸€äº›ä¸šåŠ¡åœºæ™¯ä¸­ï¼Œæˆ‘ä»¬å¸Œæœ›è¿™ä¸¤è€…è¢«åˆ†åˆ«å¯¹å¾…å¤„ç†ï¼Œé‚£ä¹ˆè¿™ç§æƒ…å†µä¸‹ï¼ŒCQRS å°±æ˜¯ä¸€ä¸ªå€¼å¾—è€ƒè™‘çš„é€‰é¡¹ã€‚</p><p>ä¸ºä»€ä¹ˆè¦æŠŠå‘½ä»¤å’ŒæŸ¥è¯¢åˆ†ç¦»ï¼Ÿæˆ‘ä¸¾ä¸ªä¾‹å­æ¥è¯´æ˜å§ï¼Œæ¯”å¦‚è¿™æ ·çš„è´«è¡€æ¨¡å‹ï¼š</p><pre><code>class Book {\n    private long id;\n    private String name;\n    private Date publicationDate;\n    private Date creationDate;\n    ... // çœç•¥å…¶å®ƒå±æ€§å’Œ getter/setter æ–¹æ³•\n}\n</code></pre><p>é‚£ä¹ˆï¼Œç›¸åº”åœ°ï¼Œå°±æœ‰è¿™æ ·ä¸€ä¸ª BookServiceï¼š</p><pre><code>class BookService {\n    public Book add(Book book);\n    public Pagination&lt;Book&gt; query(Book book);\n}\n</code></pre><p>è¿™ä¸ªæ¥å£æä¾›äº†ä¸¤ä¸ªæ–¹æ³•ï¼š</p><p>ä¸€ä¸ªå«åš add æ–¹æ³•ï¼Œæ¥æ”¶ä¸€ä¸ª book å¯¹è±¡ï¼Œè¿™ä¸ªå¯¹è±¡çš„ name å’Œ publicationDate å±æ€§ä¼šè¢«å½“åšå®é™…å€¼å†™å…¥æ•°æ®åº“ï¼Œä½†æ˜¯ id ä¼šè¢«å¿½ç•¥ï¼Œå› ä¸º id æ˜¯æ•°æ®åº“è‡ªåŠ¨ç”Ÿæˆçš„ï¼Œå…·å¤‡å”¯ä¸€æ€§ï¼ŒcreationDate ä¹Ÿä¼šè¢«å¿½ç•¥ï¼Œå› ä¸ºå®ƒä¹Ÿæ˜¯ç”±æ•°æ®åº“è‡ªåŠ¨ç”Ÿæˆçš„ï¼Œè¡¨ç¤ºæ•°æ®æ¡ç›®çš„åˆ›å»ºæ—¶é—´ã€‚å†™å…¥æ•°æ®åº“å®Œæˆåï¼Œè¿”å›ä¸€ä¸ªèƒ½å¤Ÿåæ˜ å®é™…å†™å…¥åº“ä¸­æ•°æ®çš„ Book å¯¹è±¡ï¼Œå®ƒçš„ id å’Œ creationDate éƒ½å¡«ä¸Šäº†æ•°æ®åº“ç”Ÿæˆçš„å®é™…å€¼ã€‚</p><p>ä½ çœ‹ï¼Œè¿™ä¸ªæ–¹æ³•ï¼Œå®é™…åšäº†ä¸¤ä»¶äº‹ï¼Œä¸€ä»¶æ˜¯æ’å…¥æ•°æ®ï¼Œå³å†™æ“ä½œï¼›å¦ä¸€ä»¶æ˜¯è¿”å›æ•°æ®åº“å†™å…¥çš„å®é™…å¯¹è±¡ï¼Œå³è¯»æ“ä½œã€‚</p><p>å¦ä¸€ä¸ªæ–¹æ³•æ˜¯ query æ–¹æ³•ï¼Œç”¨äºæŸ¥è¯¢ï¼Œè¿™ä¸ª Book å…¥å‚ï¼Œè¢«ç”¨æ¥æ‰¿è½½æŸ¥è¯¢å‚æ•°äº† ã€‚æ¯”æ–¹è¯´ï¼Œå¦‚æœå®ƒçš„ author å€¼ä¸ºâ€œJimâ€ï¼Œè¡¨ç¤ºæŸ¥è¯¢ä½œè€…åå­—ä¸ºâ€œJimâ€çš„å›¾ä¹¦ï¼Œè¿”å›ä¸€ä¸ªåˆ†é¡µå¯¹è±¡ï¼Œå†…å«åˆ†é¡µåçš„ç»“æœåˆ—è¡¨ã€‚</p><p>ä½†è¿™ä¸ªæ–¹æ³•ï¼Œå…¶å®æœ‰ç€æ˜æ˜¾çš„é—®é¢˜ã€‚è¿™ä¸ªé—®é¢˜å°±æ˜¯ï¼ŒæŸ¥è¯¢æ¡ä»¶çš„è¡¨è¾¾ï¼Œå¹¶ä¸èƒ½ç”¨ç®€å•çš„ä¸šåŠ¡æ¨¡å‹å¾ˆå¥½åœ°è¡¨è¾¾ã€‚æ¢è¨€ä¹‹ï¼Œè¿™ä¸ªæ¨¡å‹ Bookï¼Œèƒ½ç”¨æ¥è¡¨ç¤ºå†™å…¥ï¼Œå´ä¸é€‚åˆç”¨æ¥è¡¨ç¤ºæŸ¥è¯¢ã€‚ä¸ºä»€ä¹ˆå‘¢ï¼Ÿ</p><p>æ¯”æ–¹è¯´ï¼Œä½ è¦æŸ¥è¯¢å‡ºç‰ˆæ—¥æœŸä» 2018 å¹´åˆ° 2019 å¹´ä¹‹é—´çš„å›¾ä¹¦ï¼Œä½ è¯¥æ€ä¹ˆæ„é€ è¿™ä¸ª Book å¯¹è±¡ï¼Ÿå¾ˆéš¾åŠå¯¹å§ï¼Œå› ä¸º Book åªèƒ½åŒ…å«ä¸€ä¸ª publicationDate å‚æ•°ï¼Œè¿™ç§â€œéš¾åŠâ€çš„æœ¬è´¨åŸå› ï¼Œæ˜¯æ¨¡å‹çš„ä¸åŒ¹é…ï¼Œå³è¿™ä¸ª Book å¯¹è±¡æ ¹æœ¬å°±ä¸é€‚åˆç”¨æ¥åšæŸ¥è¯¢è°ƒç”¨çš„æ¨¡å‹ã€‚</p><p>åœ¨æ¸…æ¥šäº†é—®é¢˜ä»¥åï¼Œè§£å†³æ–¹æ³• CQRS å°±è‡ªç„¶è€Œç„¶äº§ç”Ÿäº†ã€‚<strong>ç®€å•æ¥è¯´ï¼ŒCQRS æ¨¡å¼ä¸‹ï¼Œæ¨¡å‹å±‚çš„æ¥å£åˆ†ä¸ºä¸”åªåˆ†ä¸ºä¸¤ç§ï¼š</strong></p><ul>\n<li><strong>å‘½ä»¤ï¼ˆCommandï¼‰ï¼Œå®ƒä¸è¿”å›ä»»ä½•ç»“æœï¼Œä½†ä¼šæ”¹å˜æ•°æ®çš„çŠ¶æ€ã€‚</strong></li>\n<li><strong>æŸ¥è¯¢ï¼ˆQueryï¼‰ï¼Œå®ƒè¿”å›ç»“æœï¼Œä½†æ˜¯ä¸ä¼šæ”¹å˜æ•°æ®çš„çŠ¶æ€ã€‚</strong></li>\n</ul><p>ä¹Ÿå°±æ˜¯è¯´ï¼Œå®ƒæŠŠå‘½ä»¤å’ŒæŸ¥è¯¢çš„æ¨¡å‹å½»åº•åˆ†å¼€äº†ã€‚ä¸Šé¢çš„ä¾‹å­ ï¼Œä½¿ç”¨ CQRS çš„æ–¹å¼æ¥æ”¹å†™ä¸€ä¸‹ï¼Œä¼šå˜æˆè¿™æ ·ï¼š</p><pre><code>class BookService {\n    public void add(Book book);\n    public Pagination&lt;Book&gt; query(Query bookQuery);\n}\n</code></pre><p>ä½ çœ‹ï¼Œåœ¨ add æ“ä½œçš„æ—¶å€™ï¼Œä¸å†æœ‰è¿”å›å€¼ï¼›è€Œåœ¨ query æ“ä½œçš„æ—¶å€™ï¼Œå…¥å‚å˜æˆäº†ä¸€ä¸ª Query å¯¹è±¡ï¼Œè¿™æ˜¯ä¸€ä¸ªä¸“é—¨çš„â€œæŸ¥è¯¢å¯¹è±¡â€ï¼ŒæŸ¥è¯¢å¯¹è±¡é‡Œé¢å¯ä»¥æ”¾ç½®å¤šä¸ªæŸ¥è¯¢æ¡ä»¶ï¼Œæ¯”å¦‚ï¼š</p><pre><code>Query bookQuery = new Query(Book.class);\nquery.addCriteria(Criteria.greaterThan(&quot;publicationDate&quot;, date_2018));\nquery.addCriteria(Criteria.lessThan(&quot;publicationDate&quot;, date_2019));\n</code></pre><p>è¯»åˆ°è¿™é‡Œï¼Œä¸çŸ¥é“ä½ æœ‰æ²¡æœ‰è”æƒ³åˆ°è¿™æ ·ä¸¤ä¸ªçŸ¥è¯†ç‚¹ï¼š</p><p>ç¬¬ä¸€ä¸ªçŸ¥è¯†ç‚¹ï¼Œåœ¨ <a href=\"https://time.geekbang.org/column/article/136795\">[ç¬¬ 04 è®²]</a> æˆ‘ä»¬å­¦ä¹  REST é£æ ¼çš„æ—¶å€™ï¼Œæˆ‘ä»¬æŠŠ HTTP çš„è¯·æ±‚ä»ä¸¤ä¸ªç»´åº¦è¿›è¡Œåˆ’åˆ†ï¼Œæ˜¯å¦å¹‚ç­‰ï¼Œä»¥åŠæ˜¯å¦å®‰å…¨ã€‚<strong>æŒ‰ç…§è¿™ä¸ªè§’åº¦æ¥è€ƒé‡ï¼ŒCQRS ä¸­çš„å‘½ä»¤ï¼Œå¯èƒ½æ˜¯å¹‚ç­‰çš„ï¼ˆä¾‹å¦‚å¯¹è±¡æ›´æ–°ï¼‰ï¼Œä¹Ÿå¯èƒ½ä¸æ˜¯å¹‚ç­‰çš„ï¼ˆä¾‹å¦‚å¯¹è±¡åˆ›å»ºï¼‰ï¼Œä½†ä¸€å®šæ˜¯ä¸å®‰å…¨çš„ï¼›CQRS ä¸­çš„æŸ¥è¯¢ï¼Œä¸€å®šæ˜¯å¹‚ç­‰çš„ï¼Œä¸”ä¸€å®šæ˜¯å®‰å…¨çš„ã€‚</strong></p><p>ç¬¬äºŒä¸ªçŸ¥è¯†ç‚¹ï¼Œåœ¨ <a href=\"https://time.geekbang.org/column/article/140196\">[ç¬¬ 07 è®²]</a> æˆ‘ä»¬å­¦ä¹  MVC çš„ä¸€èˆ¬åŒ–ï¼Œå…¶ä¸­çš„â€œç¬¬äºŒç§â€å…¸å‹æƒ…å†µæ—¶ï¼ŒController ä¼šè°ƒç”¨ Model å±‚çš„ï¼Œæ‰§è¡Œå†™å…¥æ“ä½œï¼›è€Œ View å±‚ä¼šè°ƒç”¨ Model å±‚ï¼Œæ‰§è¡Œåªè¯»æ“ä½œâ€”â€”çœ‹èµ·æ¥è¿™ä¸å°±æ˜¯æœ€é€‚åˆ CQRS çš„ä¸€ç§åº”ç”¨åœºæ™¯å—ï¼Ÿ</p><p>æ‰€ä»¥è¯´ï¼ŒæŠ€æœ¯ç¡®å®éƒ½æ˜¯ç›¸é€šçš„ã€‚</p><h2>æ€»ç»“æ€è€ƒ</h2><p>ä»Šå¤©æˆ‘ä»¬è¯¦ç»†å‰–æäº† MVC æ¶æ„ä¸­ Model å±‚çš„æ–¹æ–¹é¢é¢ï¼Œå¹¶ç»“åˆä¾‹å­ç†è§£äº†è´«è¡€æ¨¡å‹å’Œå……è¡€æ¨¡å‹çš„æ¦‚å¿µå’Œç‰¹ç‚¹ï¼Œè¿˜ä»‹ç»äº†ä¸€ç§å…¸å‹çš„æ¨¡å‹å±‚çš„å†…éƒ¨å±‚æ¬¡åˆ’åˆ†æ–¹æ³•ï¼Œæ¥ç€ä»‹ç»äº† CQRS è¿™ç§å°†å‘½ä»¤å’ŒæŸ¥è¯¢è¡Œä¸ºè§£è€¦å¼€çš„æ¨¡å‹å±‚è®¾è®¡æ–¹å¼ã€‚</p><p>å…¶ä¸­ï¼Œè´«è¡€æ¨¡å‹å’Œå……è¡€æ¨¡å‹çš„ç†è§£æ˜¯è¿™ä¸€è®²çš„é‡ç‚¹ï¼Œè¿™é‡Œæˆ‘å†å¼ºè°ƒä¸€ä¸‹ï¼š</p><ul>\n<li>è´«è¡€æ¨¡å‹ï¼Œé€»è¾‘ä»æ¨¡å‹å®ä½“ä¸­å‰¥ç¦»å‡ºå»ï¼Œå¹¶è¢«æ”¾åˆ°äº†æ— çŠ¶æ€çš„ Service å±‚ä¸­ï¼Œäºæ˜¯çŠ¶æ€å’Œé€»è¾‘å°±è¢«è§£è€¦å¼€äº†ï¼›</li>\n<li>å……è¡€æ¨¡å‹ï¼Œå®ƒæ—¢åŒ…å«æ•°æ®ï¼Œä¹ŸåŒ…å«é€»è¾‘ï¼Œå…·å¤‡äº†æ›´é«˜ç¨‹åº¦çš„å®Œå¤‡æ€§å’Œè‡ªæ°æ€§ã€‚</li>\n</ul><p>æœ€åï¼Œæˆ‘æ¥æä¸¤ä¸ªé—®é¢˜ï¼Œä¸€åŒæ£€éªŒä¸‹ä»Šå¤©çš„å­¦ä¹ æˆæœå§ï¼š</p><ul>\n<li>è¯·å›æƒ³ä¸€ä¸‹ï¼Œåœ¨ä½ ç»å†è¿‡çš„é¡¹ç›®ä¸­ï¼Œä½¿ç”¨è¿‡ä»€ä¹ˆ MVC æ¡†æ¶ï¼ŒModel å±‚çš„ä»£ç æ˜¯éµå¾ªè´«è¡€æ¨¡å‹è¿˜æ˜¯å……è¡€æ¨¡å‹è®¾è®¡çš„ï¼Ÿ</li>\n<li>åœ¨æ–‡ä¸­åº”ç”¨ CQRS æ¨¡å¼çš„æ—¶å€™ï¼Œadd æ–¹æ³•ä¸å†è¿”å› Book å¯¹è±¡ï¼Œè¿™æ ·ä¸€æ¥ï¼Œæ–¹æ³•è°ƒç”¨è€…å°±æ— æ³•çŸ¥é“å®é™…æ’å…¥çš„ Book å¯¹è±¡çš„ id æ˜¯ä»€ä¹ˆï¼Œå°±æ— æ³•åœ¨ä¸‹ä¸€æ­¥æ ¹æ® id å»æ•°æ®åº“æŸ¥è¯¢å‡ºè¿™ä¸ª Book å¯¹è±¡äº†ã€‚é‚£ä¹ˆï¼Œè¿™ä¸ªé—®é¢˜è¯¥æ€ä¹ˆè§£å†³å‘¢ï¼Ÿ</li>\n</ul><p>å¥½ï¼Œä»Šå¤©çš„å†…å®¹å°±åˆ°è¿™é‡Œï¼Œæœ‰ä½™åŠ›è¿˜å¯ä»¥äº†è§£ä¸‹æ‰©å±•é˜…è¯»çš„å†…å®¹ã€‚æœ‰å…³ä»Šå¤©çš„çŸ¥è¯†ç‚¹ï¼Œå¦‚æœä½ åœ¨å®é™…çš„å·¥ä½œç»å†ä¸­é‡åˆ°è¿‡ï¼Œå…¶å®æ˜¯éå¸¸é€‚åˆæ‹¿æ¥ä¸€èµ·æ¯”è¾ƒçš„ã€‚å¯ä»¥è°ˆè°ˆä½ åœ¨è¿™æ–¹é¢çš„ç»éªŒï¼Œä¹Ÿå¯ä»¥åˆ†äº«ä½ çš„ä¸åŒç†è§£ï¼ŒæœŸå¾…ä½ çš„æƒ³æ³•ï¼</p><h2>æ‰©å±•é˜…è¯»</h2><ul>\n<li><a href=\"https://martinfowler.com/bliki/AnemicDomainModel.html\">AnemicDomainModel</a>ï¼ŒMartin Fowler å†™çš„æ‰¹è¯„è´«è¡€æ¨¡å‹çš„æ–‡ç« ï¼Œä»–è‡ªå·±æå‡ºäº†è´«è¡€å’Œå……è¡€çš„æ¦‚å¿µï¼Œå› æ­¤æˆ‘ä»¬å¯ä»¥åˆ°æ¦‚å¿µçš„æºå¤´å»ï¼Œçœ‹çœ‹ä»–åšå‡ºæ‰¹è¯„çš„ç†ç”±æ˜¯ä»€ä¹ˆã€‚</li>\n<li>ã€åŸºç¡€ã€‘åœ¨æ¨¡å‹å±‚æˆ‘ä»¬ç»å¸¸ä¼šå’Œæ•°æ®åº“æ‰“äº¤é“ï¼ŒSQL æ˜¯è¿™éƒ¨åˆ†çš„åŸºç¡€ï¼Œå¦‚æœä½ å®Œå…¨ä¸äº†è§£ SQLï¼Œå¯ä»¥é˜…è¯» W3school ä¸Šçš„ <a href=\"https://www.w3school.com.cn/sql/index.asp\">SQL åŸºç¡€æ•™ç¨‹</a>ï¼ˆå·¦ä¾§ç›®å½•ä¸­çš„åŸºç¡€æ•™ç¨‹ï¼Œå†…å®¹ç®€çŸ­ï¼‰ã€‚</li>\n<li>æ–‡ä¸­æåˆ°äº†æŸ¥è¯¢å¯¹è±¡ï¼ˆQuery Objectï¼‰ï¼Œè¿™å…¶å®æ˜¯ä¸€ç§å¸¸è§çš„è®¾è®¡æ¨¡å¼ï¼Œæ–‡ä¸­ä¸¾ä¾‹è¯´æ˜äº†æ˜¯æ€ä¹ˆä½¿ç”¨çš„ï¼Œä½†æ˜¯ï¼Œå¦‚æœä½ æƒ³çŸ¥é“å®ƒæ˜¯æ€ä¹ˆå®ç°çš„ï¼Œå¯ä»¥é˜…è¯» <a href=\"https://www.sourcecodeexamples.net/2018/04/query-object-pattern.html\">Query Object Pattern</a> è¿™ç¯‡æ–‡ç« ï¼Œä¸Šé¢æœ‰å¾ˆå¥½çš„ä¾‹å­ã€‚</li>\n</ul><p></p>","neighbors":{"left":{"article_title":"07 | è§£è€¦æ˜¯æ°¸æ’çš„ä¸»é¢˜ï¼šMVCæ¡†æ¶çš„å‘å±•","id":140196},"right":{"article_title":"09 | MVCæ¶æ„è§£æï¼šè§†å›¾ï¼ˆViewï¼‰ç¯‡","id":141817}},"comments":[{"had_liked":false,"id":137469,"user_name":"Lucianoæé‘«","can_delete":false,"product_type":"c1","uid":1329995,"ip_address":"","ucode":"5FBE5F86FD5B2C","user_header":"https://static001.geekbang.org/account/avatar/00/14/4b/4b/97926cba.jpg","comment_is_top":true,"comment_ctime":1569748655,"is_pvip":false,"replies":[{"id":"52904","content":"å…³äº 2ï¼Œä½ è¯´çš„è¿”å›è‡ªå¢ id æ˜¯ä¸€ç§å¾ˆå¥½çš„æ–¹æ³•ï¼Œå¾ˆå¸¸ç”¨ï¼Œä½†æ˜¯å®ƒç ´åäº† CQRS å¯¹äº Command çš„ fire-and-forget çš„è¦æ±‚ã€‚<br><br>å½“ç„¶ï¼Œä¹Ÿæœ‰ä¸€äº›å…¶å®ƒçš„åŠæ³•ï¼Œæ¯”å¦‚å°† id åœ¨å®¢æˆ·ç«¯ç”Ÿæˆï¼ˆè¿™ä¸ªç”Ÿæˆå¯ä»¥æ˜¯å®¢æˆ·ç«¯è‡ªå·±ç”Ÿæˆï¼Œä¹Ÿå¯ä»¥æ˜¯è°ƒç”¨æœåŠ¡ç«¯çš„æŸä¸€ä¸ªç”Ÿæˆ id çš„æ¥å£ç”Ÿæˆï¼‰ï¼Œä½†è¿™å´åˆç ´åäº† REST æ¥å£ä¸­ Create æ–¹æ³•ä¸æŒ‡å®š id çš„è§„çº¦ã€‚<br><br>å†æœ‰ä¸€ä¸ªåŠæ³•ï¼Œæ˜¯åœ¨å®¢æˆ·ç«¯ç”Ÿæˆä¸€ä¸ªéä¸»é”®ã€ä½†è¢«ç´¢å¼•çš„ç‰¹æ®Š idï¼Œä¾‹å¦‚ GUIDï¼Œè¿™æ ·ï¼Œç”Ÿæˆäº†è®°å½•ä¹‹åï¼Œå®¢æˆ·ç«¯å¯ä»¥ä½¿ç”¨è¿™ä¸ª GUID å»æœåŠ¡ç«¯è·å–è¿™æ¡æ•°æ®ï¼Œå½“ç„¶ï¼Œç¼ºç‚¹æ˜¯éœ€è¦é¢å¤–çš„ä¸€åˆ—æ¥æ”¾ç½® GUIDï¼Œä¸”è¦ä¿è¯ GUID çš„å”¯ä¸€æ€§ã€‚<br><br>æ‰€ä»¥ï¼Œä¸Šé¢ä»‹ç»äº†ä¸‰ç§æ–¹æ³•ï¼Œå„æœ‰åˆ©å¼Šï¼Œéƒ½æ¯”è¾ƒå¸¸ç”¨ã€‚å½“ç„¶ï¼Œä¹Ÿæœ‰ä¸€äº›å…¶å®ƒçš„æ–¹æ³•ã€‚","user_name":"ä½œè€…å›å¤","user_name_real":"å››ç«","uid":"1580075","ctime":1569818586,"ip_address":"","comment_id":137469,"utype":1}],"discussion_count":1,"race_medal":0,"score":"9.2233720770791997e+18","product_id":100035501,"comment_content":"1.å¤§å‹ã€å¤æ‚é¡¹ç›®ç”¨è´«è¡€æ¨¡å‹å¤šä¸€äº›ï¼Œå°å‹ã€ç®€å•é¡¹ç›®ç”¨é‡å†™æ¨¡å‹å¤šä¸€äº›ã€‚<br>2.åœ¨å‘½ä»¤æŸ¥è¯¢çš„æ—¶å€™ï¼Œé’ˆå¯¹addå¯ä»¥è¿”å›è‡ªå¢idã€‚åœ¨updateçš„æ—¶å€™è¿”å›ä¿®æ”¹è®°å½•æ•°ã€‚","like_count":9,"discussions":[{"author":{"id":1580075,"avatar":"https://static001.geekbang.org/account/avatar/00/18/1c/2b/2069abe6.jpg","nickname":"å››ç«","note":"","ucode":"E4BED7DCAADD99","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":469111,"discussion_content":"å…³äº 2ï¼Œä½ è¯´çš„è¿”å›è‡ªå¢ id æ˜¯ä¸€ç§å¾ˆå¥½çš„æ–¹æ³•ï¼Œå¾ˆå¸¸ç”¨ï¼Œä½†æ˜¯å®ƒç ´åäº† CQRS å¯¹äº Command çš„ fire-and-forget çš„è¦æ±‚ã€‚\n\nå½“ç„¶ï¼Œä¹Ÿæœ‰ä¸€äº›å…¶å®ƒçš„åŠæ³•ï¼Œæ¯”å¦‚å°† id åœ¨å®¢æˆ·ç«¯ç”Ÿæˆï¼ˆè¿™ä¸ªç”Ÿæˆå¯ä»¥æ˜¯å®¢æˆ·ç«¯è‡ªå·±ç”Ÿæˆï¼Œä¹Ÿå¯ä»¥æ˜¯è°ƒç”¨æœåŠ¡ç«¯çš„æŸä¸€ä¸ªç”Ÿæˆ id çš„æ¥å£ç”Ÿæˆï¼‰ï¼Œä½†è¿™å´åˆç ´åäº† REST æ¥å£ä¸­ Create æ–¹æ³•ä¸æŒ‡å®š id çš„è§„çº¦ã€‚\n\nå†æœ‰ä¸€ä¸ªåŠæ³•ï¼Œæ˜¯åœ¨å®¢æˆ·ç«¯ç”Ÿæˆä¸€ä¸ªéä¸»é”®ã€ä½†è¢«ç´¢å¼•çš„ç‰¹æ®Š idï¼Œä¾‹å¦‚ GUIDï¼Œè¿™æ ·ï¼Œç”Ÿæˆäº†è®°å½•ä¹‹åï¼Œå®¢æˆ·ç«¯å¯ä»¥ä½¿ç”¨è¿™ä¸ª GUID å»æœåŠ¡ç«¯è·å–è¿™æ¡æ•°æ®ï¼Œå½“ç„¶ï¼Œç¼ºç‚¹æ˜¯éœ€è¦é¢å¤–çš„ä¸€åˆ—æ¥æ”¾ç½® GUIDï¼Œä¸”è¦ä¿è¯ GUID çš„å”¯ä¸€æ€§ã€‚\n\næ‰€ä»¥ï¼Œä¸Šé¢ä»‹ç»äº†ä¸‰ç§æ–¹æ³•ï¼Œå„æœ‰åˆ©å¼Šï¼Œéƒ½æ¯”è¾ƒå¸¸ç”¨ã€‚å½“ç„¶ï¼Œä¹Ÿæœ‰ä¸€äº›å…¶å®ƒçš„æ–¹æ³•ã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1569818586,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":137464,"user_name":"Lucianoæé‘«","can_delete":false,"product_type":"c1","uid":1329995,"ip_address":"","ucode":"5FBE5F86FD5B2C","user_header":"https://static001.geekbang.org/account/avatar/00/14/4b/4b/97926cba.jpg","comment_is_top":false,"comment_ctime":1569747832,"is_pvip":false,"replies":[{"id":"52899","content":"çŠ¶æ€ï¼Œå…¶å®å°±æ˜¯æ•°æ®ã€‚<br><br>Service æä¾›äº†ä¸€ç³»åˆ—çš„è¿‡ç¨‹æ–¹æ³•ï¼Œå…¥å‚è¿›ï¼Œç»“æœå‡ºï¼Œä½†æ˜¯ Service å¹¶æœªå‘ç”Ÿå˜åŒ–ã€‚<br><br>Model åˆ™ç›¸åï¼Œå¯ä»¥åˆ›å»ºã€ä¿®æ”¹ã€åˆ é™¤ï¼Œè¿™å°±æ˜¯çŠ¶æ€çš„å˜åŒ–ã€‚","user_name":"ä½œè€…å›å¤","user_name_real":"å››ç«","uid":"1580075","ctime":1569817938,"ip_address":"","comment_id":137464,"utype":1}],"discussion_count":1,"race_medal":0,"score":"35929486200","product_id":100035501,"comment_content":"è¯·é—®ï¼Œä¸ºä»€ä¹ˆè¯´åœ¨è´«è¡€æ¨¡å‹ä¸­ï¼Œserviceå¢æ˜¯æ— çŠ¶æ€çš„ï¼Œè€Œmodelå¢æ˜¯æœ‰çŠ¶æ€çš„ï¼Œè¿™ä¸ªâ€œçŠ¶æ€â€æ˜¯æ€ä¹ˆå®šä¹‰çš„å‘¢ï¼Ÿ","like_count":8,"discussions":[{"author":{"id":1580075,"avatar":"https://static001.geekbang.org/account/avatar/00/18/1c/2b/2069abe6.jpg","nickname":"å››ç«","note":"","ucode":"E4BED7DCAADD99","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":469108,"discussion_content":"çŠ¶æ€ï¼Œå…¶å®å°±æ˜¯æ•°æ®ã€‚\n\nService æä¾›äº†ä¸€ç³»åˆ—çš„è¿‡ç¨‹æ–¹æ³•ï¼Œå…¥å‚è¿›ï¼Œç»“æœå‡ºï¼Œä½†æ˜¯ Service å¹¶æœªå‘ç”Ÿå˜åŒ–ã€‚\n\nModel åˆ™ç›¸åï¼Œå¯ä»¥åˆ›å»ºã€ä¿®æ”¹ã€åˆ é™¤ï¼Œè¿™å°±æ˜¯çŠ¶æ€çš„å˜åŒ–ã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1569817938,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":136858,"user_name":"tt","can_delete":false,"product_type":"c1","uid":1489957,"ip_address":"","ucode":"7753B79AD5A9AC","user_header":"https://static001.geekbang.org/account/avatar/00/16/bc/25/1c92a90c.jpg","comment_is_top":false,"comment_ctime":1569544485,"is_pvip":false,"replies":[{"id":"52756","content":"æ„Ÿè°¢å›å¤ã€‚<br><br>å…³äºä½ æåˆ°çš„â€œæ¦‚å¿µä¸é€»è¾‘â€ï¼Œåšä¸ªè¯´æ˜ã€‚<br><br>æˆ‘æ˜¯è¿™æ ·è®¤ä¸ºçš„ï¼Œå­¦ä¹ å…¨æ ˆæŠ€æœ¯æ¯”è¾ƒå¿Œè®³ä»…ä»…å­¦ä¹ å•ä¸ªçš„å…·ä½“æŠ€æœ¯ï¼Œä¹‹å‰çš„æ–‡ç« å’Œå›å¤ä¸­æˆ‘ä¹Ÿå¤šæ¬¡æåˆ°è¿‡ï¼Œæ¯•ç«ŸæŠ€æœ¯ç§ç±»èŠ±æ ·ç¹å¤šï¼Œæˆ‘ä»¬è¿˜æ˜¯éœ€è¦é€‚å½“åšä¸€äº›æŠ½è±¡ï¼Œç†è§£ä¸€äº›é€šç”¨å’Œå…±æ€§çš„ä¸œè¥¿ï¼Œæ—¢åŒ…æ‹¬ä¸€äº›æ¦‚å¿µï¼Œä¹ŸåŒ…æ‹¬ä¸€äº›å¥—è·¯ï¼ˆæ¨¡å¼ï¼‰ã€‚å½“ç„¶ï¼Œæˆ‘ä»¬éœ€è¦é€šè¿‡è®¸å¤šä¾‹å­æ¥ç†è§£å®ƒä»¬ï¼Œè¿™æ˜¯æ²¡é”™çš„ã€‚","user_name":"ä½œè€…å›å¤","user_name_real":"å››ç«","uid":"1580075","ctime":1569690107,"ip_address":"","comment_id":136858,"utype":1}],"discussion_count":1,"race_medal":0,"score":"23044380965","product_id":100035501,"comment_content":"èµï¼Œè¿™æ˜¯æˆ‘è®¢é˜…çš„æå®¢æ—¶é—´çš„è¯¾ç¨‹ä¸­ä¸ºæ•°ä¸å¤šçš„é‡åº¦åå‘æ¦‚å¿µä¸é€»è¾‘çš„è¯¾ç¨‹ã€‚<br><br>æˆ‘æœ¬äººå¾ˆå°‘åšWEBå¼€å‘ï¼Œåªæ˜¯ä½¿ç”¨è¿‡é¢å‘å¯¹è±¡ï¼Œè¿™èŠ‚è¯¾ä¸€ä¸‹å­å°±è®©æˆ‘é¢†æ‚Ÿäº†é¢å‘å¯¹è±¡ã€é¢å‘æœåŠ¡ã€é¢å‘è¿‡ç¨‹ã€è´«è¡€å’Œå……è¡€æ¨¡å‹ã€‚<br><br>ç¨‹åºå°±æ˜¯æ•°æ®ç»“æ„åŠ ç®—æ³•ï¼Œä¸šåŠ¡å°±æ˜¯æ•°æ®åŠ é€»è¾‘ã€‚ä»æ•°æ®å’Œé€»è¾‘è¿™ä¸¤ä¸ªçº¬åº¦å¯ä»¥ç”»ä¸€ä¸ªäºŒç»´å››è±¡é™å›¾:<br><br><br>           |         æ•°æ®                  |              é€»è¾‘<br>------------------------------------------------<br>æ•°æ®   |  æ‰¿è½½æ¨¡å‹çŠ¶æ€ï¼Œå¼€   |  é¢å‘å¯¹è±¡<br>           |  æ”¾æ“ä½œçŠ¶æ€çš„æ¥å£   | å……è¡€æ¨¡å‹<br>------------------------------------------------<br>é€»è¾‘   |         é¢å‘å¯¹è±¡            |  é¢å‘æœåŠ¡<br>           |        å……è¡€æ¨¡å‹             | æ— çŠ¶æ€ï¼Œrestful<br><br><br><br>è™½ç„¶å¾ˆå°‘åšWEBå¼€å‘ï¼Œä½†äº†è§£è¿‡ä¸€äº›å†…éƒ¨ä½¿ç”¨çš„æ¡†æ¶ï¼Œéƒ½æœ‰Serviceå’ŒDAï¼Œä»Šå¤©çŸ¥é“äº†ï¼Œå®ƒçš„åå­—æ˜¯è´«è¡€æ¨¡å‹ã€‚<br><br>é‚£ä»æœ¬èŠ‚è¯¾å‡ºå‘ï¼Œå¾®æœåŠ¡ä¹Ÿæ˜¯æŠŠæœåŠ¡æ‹†åˆ†ï¼Œä¸€ä¸ªç›®çš„å°±æ˜¯å¯ä»¥å¿«é€Ÿæ°´å¹³æ‰©å±•ï¼Œé‚£åº”è¯¥å°±å¤§é‡ä½¿ç”¨RESTFULé£æ ¼ã€‚<br><br>ä½†é€»è¾‘å’Œæ•°æ®ç»ˆå½’è¦ç¢°é¢ï¼ŒORMå°±æ˜¯äºŒè€…ä¹‹é—´çš„æ¡¥æ¢ï¼Œå¯¹å¤–å±•ç¤ºä¸åŒçš„é¢å­”ã€‚","like_count":5,"discussions":[{"author":{"id":1580075,"avatar":"https://static001.geekbang.org/account/avatar/00/18/1c/2b/2069abe6.jpg","nickname":"å››ç«","note":"","ucode":"E4BED7DCAADD99","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":468830,"discussion_content":"æ„Ÿè°¢å›å¤ã€‚\n\nå…³äºä½ æåˆ°çš„â€œæ¦‚å¿µä¸é€»è¾‘â€ï¼Œåšä¸ªè¯´æ˜ã€‚\n\næˆ‘æ˜¯è¿™æ ·è®¤ä¸ºçš„ï¼Œå­¦ä¹ å…¨æ ˆæŠ€æœ¯æ¯”è¾ƒå¿Œè®³ä»…ä»…å­¦ä¹ å•ä¸ªçš„å…·ä½“æŠ€æœ¯ï¼Œä¹‹å‰çš„æ–‡ç« å’Œå›å¤ä¸­æˆ‘ä¹Ÿå¤šæ¬¡æåˆ°è¿‡ï¼Œæ¯•ç«ŸæŠ€æœ¯ç§ç±»èŠ±æ ·ç¹å¤šï¼Œæˆ‘ä»¬è¿˜æ˜¯éœ€è¦é€‚å½“åšä¸€äº›æŠ½è±¡ï¼Œç†è§£ä¸€äº›é€šç”¨å’Œå…±æ€§çš„ä¸œè¥¿ï¼Œæ—¢åŒ…æ‹¬ä¸€äº›æ¦‚å¿µï¼Œä¹ŸåŒ…æ‹¬ä¸€äº›å¥—è·¯ï¼ˆæ¨¡å¼ï¼‰ã€‚å½“ç„¶ï¼Œæˆ‘ä»¬éœ€è¦é€šè¿‡è®¸å¤šä¾‹å­æ¥ç†è§£å®ƒä»¬ï¼Œè¿™æ˜¯æ²¡é”™çš„ã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1569690107,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":143400,"user_name":"é›¶ç»´","can_delete":false,"product_type":"c1","uid":1235055,"ip_address":"","ucode":"D783CB1D59D1BE","user_header":"https://static001.geekbang.org/account/avatar/00/12/d8/6f/22e5ec55.jpg","comment_is_top":false,"comment_ctime":1571705653,"is_pvip":false,"replies":[{"id":"55652","content":"å¥½é—®é¢˜ã€‚æˆ‘çš„ç†è§£æ˜¯ï¼Œè¿”å›å€¼å°±ä¸€å®šç¨‹åº¦ä¸Šæ„å‘³ç€è§£è€¦å¯èƒ½ä¸å¤Ÿå½»åº•ï¼Œå› ä¸º Command çš„ç†æƒ³çŠ¶å†µæ˜¯ fire and forgetï¼Œæ‰€ä»¥å®ƒæ‰æ˜¯è¦æ±‚æ— è¿”å›çš„ï¼Œå­˜åœ¨è¿”å›å€¼æ„å‘³ç€æœ‰ä¸€éƒ¨åˆ†é€»è¾‘å¯ä»¥æ‹¿å‡ºå»å˜æˆ Queryã€‚å®¢æˆ·ç«¯åªçŸ¥é“æ‰§è¡ŒæˆåŠŸäº†ï¼Œæˆ–è€…æ‰§è¡Œå¤±è´¥äº†ï¼ˆæœ‰å¼‚å¸¸æŠ›å‡ºï¼‰ã€‚ä½†æ˜¯æˆ‘ä»¬åœ¨åº”ç”¨åˆ°å®é™…ç³»ç»Ÿä¸­çš„æ—¶å€™ï¼Œä¸ä¸€å®šèƒ½å¤Ÿåšåˆ°é‚£ä¹ˆçº¯ç²¹ã€‚","user_name":"ä½œè€…å›å¤","user_name_real":"å››ç«","uid":"1580075","ctime":1571893862,"ip_address":"","comment_id":143400,"utype":1}],"discussion_count":1,"race_medal":0,"score":"14456607541","product_id":100035501,"comment_content":"è¯·é—®è€å¸ˆï¼Œå¦‚æœ CQRS çš„å‘½ä»¤æ“ä½œæœ‰äº†è¿”å›å€¼ä¼šæœ‰ä»€ä¹ˆå¼Šç«¯å—ï¼Ÿå°±åƒä¸¾çš„æ”¹è¿›ç‰ˆçš„ç¤ºä¾‹ï¼Œå¦‚æœç›´æ¥è®©æœåŠ¡ç«¯åœ¨ add æ“ä½œä¹‹åè¿”å› id ä¼šæœ‰ä»€ä¹ˆä¸å¥½çš„å½±å“å—ï¼Ÿ","like_count":3,"discussions":[{"author":{"id":1580075,"avatar":"https://static001.geekbang.org/account/avatar/00/18/1c/2b/2069abe6.jpg","nickname":"å››ç«","note":"","ucode":"E4BED7DCAADD99","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":471515,"discussion_content":"å¥½é—®é¢˜ã€‚æˆ‘çš„ç†è§£æ˜¯ï¼Œè¿”å›å€¼å°±ä¸€å®šç¨‹åº¦ä¸Šæ„å‘³ç€è§£è€¦å¯èƒ½ä¸å¤Ÿå½»åº•ï¼Œå› ä¸º Command çš„ç†æƒ³çŠ¶å†µæ˜¯ fire and forgetï¼Œæ‰€ä»¥å®ƒæ‰æ˜¯è¦æ±‚æ— è¿”å›çš„ï¼Œå­˜åœ¨è¿”å›å€¼æ„å‘³ç€æœ‰ä¸€éƒ¨åˆ†é€»è¾‘å¯ä»¥æ‹¿å‡ºå»å˜æˆ Queryã€‚å®¢æˆ·ç«¯åªçŸ¥é“æ‰§è¡ŒæˆåŠŸäº†ï¼Œæˆ–è€…æ‰§è¡Œå¤±è´¥äº†ï¼ˆæœ‰å¼‚å¸¸æŠ›å‡ºï¼‰ã€‚ä½†æ˜¯æˆ‘ä»¬åœ¨åº”ç”¨åˆ°å®é™…ç³»ç»Ÿä¸­çš„æ—¶å€™ï¼Œä¸ä¸€å®šèƒ½å¤Ÿåšåˆ°é‚£ä¹ˆçº¯ç²¹ã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1571893862,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":140265,"user_name":"å°±å«Hugoä¹Ÿè¡Œ","can_delete":false,"product_type":"c1","uid":1118448,"ip_address":"","ucode":"73B41EDDA45D24","user_header":"https://static001.geekbang.org/account/avatar/00/11/10/f0/12f043cb.jpg","comment_is_top":false,"comment_ctime":1570867379,"is_pvip":false,"replies":[{"id":"54264","content":"ğŸ‘","user_name":"ä½œè€…å›å¤","user_name_real":"å››ç«","uid":"1580075","ctime":1570939521,"ip_address":"","comment_id":140265,"utype":1}],"discussion_count":1,"race_medal":0,"score":"14455769267","product_id":100035501,"comment_content":"åœ¨è®¡ç®—æœºè¡Œä¸šçš„dargonä¸­ï¼Œâ€œæ•°æ®â€çš„åŒä¹‰è¯æ˜¯â€œçŠ¶æ€â€ã€‚â€œé€»è¾‘â€çš„åŒä¹‰è¯æ˜¯â€œæœåŠ¡â€ã€â€œè¡Œä¸ºâ€ã€â€œå‡½æ•°â€æˆ–â€œåŠŸèƒ½â€ã€‚","like_count":3,"discussions":[{"author":{"id":1580075,"avatar":"https://static001.geekbang.org/account/avatar/00/18/1c/2b/2069abe6.jpg","nickname":"å››ç«","note":"","ucode":"E4BED7DCAADD99","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":470322,"discussion_content":"ğŸ‘","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1570939521,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":136889,"user_name":"æ¡ƒæºå°ç›¼","can_delete":false,"product_type":"c1","uid":1039664,"ip_address":"","ucode":"3FA0819FD69FF8","user_header":"https://static001.geekbang.org/account/avatar/00/0f/dd/30/9d36ccaf.jpg","comment_is_top":false,"comment_ctime":1569548419,"is_pvip":true,"discussion_count":0,"race_medal":0,"score":"10159483011","product_id":100035501,"comment_content":"éå…³ç³»å‹æ•°æ®åº“çš„modelå±‚ï¼Œåˆè¯¥æ€ä¹ˆè®¾è®¡å‘¢ï¼Ÿ","like_count":2},{"had_liked":false,"id":225830,"user_name":"Geek_89bbab","can_delete":false,"product_type":"c1","uid":1156607,"ip_address":"","ucode":"B3110D5B3C9500","user_header":"https://static001.geekbang.org/account/avatar/00/11/a5/ff/6201122c.jpg","comment_is_top":false,"comment_ctime":1591868622,"is_pvip":false,"replies":[{"id":"83637","content":"ä¸¥æ ¼çš„CQRSæ¥è¯´çš„è¯ï¼Œå‘½ä»¤è¦è¿”å›æ‰§è¡Œç»“æœï¼Œä½†æ˜¯ä¸è¿”å›å†™å…¥æˆåŠŸçš„å®Œæ•´å¯¹è±¡ã€‚<br><br>æˆ‘è®¤ä¸ºï¼Œåœ¨CQRSçš„æƒ…å†µä¸‹ï¼Œå¦‚æœå†™å…¥æ“ä½œè¿”å›æˆåŠŸï¼Œå†™å…¥åçš„æŸ¥è¯¢æ²¡æœ‰æŸ¥è¯¢åˆ°ï¼Œæ— è®ºå¯èƒ½æ˜¯æ•°æ®ä¸€è‡´æ€§çš„é—®é¢˜ï¼ˆbugï¼‰ï¼Œè¿˜æ˜¯æ•°æ®è®¿é—®ç«äº‰çš„é—®é¢˜ï¼ˆébugï¼‰ï¼Œå¯¹äºè¯¥æ¬¡æŸ¥è¯¢æ¥è¯´ï¼Œéƒ½å±äºæŸ¥è¯¢æ“ä½œæ— æ³•æ‰¾åˆ°æ•°æ®çš„åœºæ™¯ï¼ŒæŒ‰ç…§å®ƒç»“åˆä¸šåŠ¡æ¥è®¾è®¡ã€‚","user_name":"ä½œè€…å›å¤","user_name_real":"å››ç«","uid":"1580075","ctime":1592281878,"ip_address":"","comment_id":225830,"utype":1}],"discussion_count":1,"race_medal":0,"score":"5886835918","product_id":100035501,"comment_content":"cqrsä¸­å‘é€commandæœåŠ¡æ–¹è¿˜æ˜¯éœ€è¦è¿”å›ä¸€äº›æˆåŠŸå¤±è´¥åº”ç­”çš„å§ï¼Œä¸å¯èƒ½å•¥éƒ½ä¸è¿”å›å§ã€‚<br>è¿™é‡Œæœ‰äº›ç–‘æƒ‘ï¼šå‘é€ä¸€ä¸ªåˆ›å»ºå¯¹è±¡çš„commandï¼Œç„¶åç«‹åˆ»å»æŸ¥è¯¢ï¼Œå‘ç°æ²¡æœ‰æŸ¥è¯¢åˆ°æ€ä¹ˆåŠï¼Œå¯èƒ½æ˜¯å†…éƒ¨æœåŠ¡æŒ‚æ‰ï¼Œä¹Ÿå¯èƒ½æ˜¯æ•°æ®åŒæ­¥æ…¢ï¼Ÿå¯¹äºå‰ç«¯æ€ä¹ˆæ˜¾ç¤ºæ¯”è¾ƒå¥½ã€‚","like_count":1,"discussions":[{"author":{"id":1580075,"avatar":"https://static001.geekbang.org/account/avatar/00/18/1c/2b/2069abe6.jpg","nickname":"å››ç«","note":"","ucode":"E4BED7DCAADD99","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":498009,"discussion_content":"ä¸¥æ ¼çš„CQRSæ¥è¯´çš„è¯ï¼Œå‘½ä»¤è¦è¿”å›æ‰§è¡Œç»“æœï¼Œä½†æ˜¯ä¸è¿”å›å†™å…¥æˆåŠŸçš„å®Œæ•´å¯¹è±¡ã€‚\n\næˆ‘è®¤ä¸ºï¼Œåœ¨CQRSçš„æƒ…å†µä¸‹ï¼Œå¦‚æœå†™å…¥æ“ä½œè¿”å›æˆåŠŸï¼Œå†™å…¥åçš„æŸ¥è¯¢æ²¡æœ‰æŸ¥è¯¢åˆ°ï¼Œæ— è®ºå¯èƒ½æ˜¯æ•°æ®ä¸€è‡´æ€§çš„é—®é¢˜ï¼ˆbugï¼‰ï¼Œè¿˜æ˜¯æ•°æ®è®¿é—®ç«äº‰çš„é—®é¢˜ï¼ˆébugï¼‰ï¼Œå¯¹äºè¯¥æ¬¡æŸ¥è¯¢æ¥è¯´ï¼Œéƒ½å±äºæŸ¥è¯¢æ“ä½œæ— æ³•æ‰¾åˆ°æ•°æ®çš„åœºæ™¯ï¼ŒæŒ‰ç…§å®ƒç»“åˆä¸šåŠ¡æ¥è®¾è®¡ã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1592281878,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":137824,"user_name":"CC","can_delete":false,"product_type":"c1","uid":1021014,"ip_address":"","ucode":"2B732860C4231B","user_header":"https://static001.geekbang.org/account/avatar/00/0f/94/56/4b8395f6.jpg","comment_is_top":false,"comment_ctime":1569874702,"is_pvip":true,"discussion_count":1,"race_medal":0,"score":"5864841998","product_id":100035501,"comment_content":"åœ¨ç»å†è¿‡çš„é¡¹ç›®ä¸­ä½¿ç”¨è¿‡ Django æ¡†æ¶ï¼Œç±»ä¼¼äº MVC æ¶æ„ã€‚ä¸è¿‡å®ƒçš„ views æ›´åƒæ˜¯ controllersï¼ŒTemplates æ›´åƒæ˜¯ viewsã€‚Models é‡‡ç”¨çš„æ˜¯è´«è¡€æ¨¡å‹ï¼ŒMVC ä¹‹é—´çš„äº¤äº’é£æ ¼æ˜¯æ–‡ä¸­æåˆ°çš„ç¬¬ä¸€ç§é£æ ¼ã€‚<br><br>å…³äºæ€è€ƒé¢˜2ï¼Œç°åœ¨å·¥ä½œä¸­ä½¿ç”¨çš„æ–¹æ³•ï¼Œæ­£æ˜¯è€å¸ˆåœ¨ç½®é¡¶ç•™è¨€ä¸­æåˆ°çš„æœ€åä¸€ç§ï¼Œå®¢æˆ·ç«¯ä¼šç”Ÿæˆä¸€ä¸ª GUIDã€‚ä¸è¿‡ä¹‹å‰æ²¡æœ‰è€ƒè™‘è¿‡å‰é¢ä¸¤ç§ï¼Œå­¦ä¹ äº†ã€‚","like_count":1,"discussions":[{"author":{"id":2063114,"avatar":"https://static001.geekbang.org/account/avatar/00/1f/7b/0a/b65e1fae.jpg","nickname":"ä¸è¦æŒ‘æˆ˜è‡ªå·±çš„æ™ºå•†","note":"","ucode":"4910FF07C35DC5","race_medal":0,"user_type":1,"is_pvip":true},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":297203,"discussion_content":"æˆ‘ä¹Ÿç”¨è¿‡Django çš„mtv æ„æ¶ï¼Œè®°å¾—å½“æ—¶çš„modelåªèƒ½è®°å½•æ•°æ®çš„çŠ¶æ€ï¼Œè€Œä¸èƒ½è®°å½•åŠ¨ä½œã€‚æœ¬è´¨ä¸Šå°±æ˜¯ä¸€ä¸ªæ•°æ®åº“ã€‚è™½ç„¶æˆ‘è‡ªå·±å½“æ—¶å¼€å‘çš„æ˜¯ VIEWè¿™éƒ¨åˆ†ã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1596807354,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":137131,"user_name":"å››å–œ","can_delete":false,"product_type":"c1","uid":1071389,"ip_address":"","ucode":"C5EBED19C0F332","user_header":"https://static001.geekbang.org/account/avatar/00/10/59/1d/c89abcd8.jpg","comment_is_top":false,"comment_ctime":1569632748,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"5864600044","product_id":100035501,"comment_content":"è¿™ä¸€è¯¾ç¨‹å¾ˆæ£’ã€‚å¦‚æœæœ‰å¯è¿è¡Œçš„githubä»£ç ç¤ºä¾‹ï¼ŒåŠ¨æ‰‹è¯•å‡ æ¬¡ï¼Œä¼šæ–¹ä¾¿ç†è§£å¾ˆå¤šã€‚<br><br>è‡ªå·±å®ç°ä¸æ˜¯ä¸è¡Œï¼Œä½†è‚¯å®šå®ç°è¿‡ç¨‹ä¸­é‡åˆ°å…¶å®ƒé—®é¢˜ï¼Œå°±è·‘åäº†ï¼Œé€Ÿåº¦ä¼šæ…¢ï¼Œæ•ˆç‡ä¼šä½ã€‚","like_count":2},{"had_liked":false,"id":137111,"user_name":"ç¼–ç¨‹çˆ±å¥½è€…","can_delete":false,"product_type":"c1","uid":1565509,"ip_address":"","ucode":"E91C7D604B73AF","user_header":"https://static001.geekbang.org/account/avatar/00/17/e3/45/d4d3c265.jpg","comment_is_top":false,"comment_ctime":1569617870,"is_pvip":false,"replies":[{"id":"52894","content":"å…³äºç¬¬ 2 é—®ï¼Œæ¶ˆæ¯ç¼–å·çš„æƒ³æ³•å¾ˆå¥½ï¼Œä½†æ˜¯ï¼Œæ¶ˆæ¯ç¼–å·æ˜¯æ¶ˆæ¯ç¼–å·ï¼Œè€Œå†™å…¥æ•°æ®åº“å¯¹è±¡çš„ id æ˜¯å¯¹è±¡çš„ idï¼ŒäºŒè€…å¹¶æ²¡æœ‰å¿…ç„¶è”ç³»å•Šã€‚","user_name":"ä½œè€…å›å¤","user_name_real":"å››ç«","uid":"1580075","ctime":1569816446,"ip_address":"","comment_id":137111,"utype":1}],"discussion_count":2,"race_medal":0,"score":"5864585166","product_id":100035501,"comment_content":"1.ä¸¤è€…éƒ½æœ‰è¿‡ï¼Œæˆ‘ä¸ªäººæ›´å–œæ¬¢è´«è¡€æ¨¡å‹ï¼ŒèŒè´£åˆ†æ˜äº›ã€‚<br>2.æ—¢ç„¶ä¸çŸ¥é“ï¼Œå¯ä»¥è®©æœåŠ¡å™¨æ¥å‘Šè¯‰ä½ ã€‚ç±»ä¼¼äºtcpä¸­çš„synï¼Œackæœºåˆ¶ï¼Œå¯ä»¥ä¸ºè¿™æ¬¡è¯·æ±‚å¢åŠ ä¸€ä¸ªæ¶ˆæ¯ç¼–å·ï¼Œç„¶åæœåŠ¡å™¨å¯ä»¥é€šè¿‡è¿™ä¸ªæ¶ˆæ¯ç¼–å·å‘Šè¯‰æ–¹æ³•è°ƒç”¨è€…ã€‚<br>æ€è€ƒä½œè€…ä¸ºä»€ä¹ˆè¿™ä¹ˆè®¾è®¡è¯¾ç¨‹ï¼Œæ„Ÿè§‰å¾ˆå¤šå†…å®¹æ˜¯æ¶æ„è®¾è®¡é‡Œé¢æ¶‰åŠçš„å†…å®¹-æƒè¡¡ä¸å–èˆã€‚","like_count":1,"discussions":[{"author":{"id":1580075,"avatar":"https://static001.geekbang.org/account/avatar/00/18/1c/2b/2069abe6.jpg","nickname":"å››ç«","note":"","ucode":"E4BED7DCAADD99","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":468945,"discussion_content":"å…³äºç¬¬ 2 é—®ï¼Œæ¶ˆæ¯ç¼–å·çš„æƒ³æ³•å¾ˆå¥½ï¼Œä½†æ˜¯ï¼Œæ¶ˆæ¯ç¼–å·æ˜¯æ¶ˆæ¯ç¼–å·ï¼Œè€Œå†™å…¥æ•°æ®åº“å¯¹è±¡çš„ id æ˜¯å¯¹è±¡çš„ idï¼ŒäºŒè€…å¹¶æ²¡æœ‰å¿…ç„¶è”ç³»å•Šã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1569816446,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":2063114,"avatar":"https://static001.geekbang.org/account/avatar/00/1f/7b/0a/b65e1fae.jpg","nickname":"ä¸è¦æŒ‘æˆ˜è‡ªå·±çš„æ™ºå•†","note":"","ucode":"4910FF07C35DC5","race_medal":0,"user_type":1,"is_pvip":true},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":297204,"discussion_content":"è¿™ä¹ˆè¯´æˆ‘ä¹Ÿå–œæ¬¢è´«è¡€å‹ï¼ŒèŒè´£åˆ†æ˜ï¼Œå®¹æ˜“æ‹“å±•ã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1596807582,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":348734,"user_name":"Johnny","can_delete":false,"product_type":"c1","uid":1433285,"ip_address":"","ucode":"138B4775A346EB","user_header":"http://thirdwx.qlogo.cn/mmopen/vi_32/uc7r2Y8HREBKCVDUicibiarPpr9DsSE2Lw0S9YRHvuagsLVjyPjQg0jq2iakhypDRwbicOHvicjJG9P59kpqiaRc1t2vA/132","comment_is_top":false,"comment_ctime":1655358651,"is_pvip":true,"discussion_count":0,"race_medal":0,"score":"1655358651","product_id":100035501,"comment_content":"æ„Ÿè°¢è€å¸ˆï¼Œè®©æˆ‘æ·±åˆ»ç†è§£äº†è´«è¡€å’Œå……è¡€æ¨¡å¼ã€‚<br>ä¸€ç›´ä¸ç†è§£ä¸ºä»€ä¹ˆå®é™…å¼€å‘ä¸­ï¼Œå‰è¾ˆä»¬å†™çš„å¯¹è±¡éƒ½åªæœ‰æ•°æ®ï¼Œæ²¡æœ‰é€»è¾‘ï¼Œé¢å‘å¯¹è±¡çš„æ•™ç¨‹çœ‹äº†å¥½å¤šéï¼Œå¯¹è±¡åº”è¯¥æœ‰å±æ€§å’Œæ–¹æ³•ï¼Œå¯¼è‡´å­¦ä¹ å’Œå®é™…å¼€å‘æœ‰å¾ˆå¤§è„±èŠ‚ã€‚<br>å…¶å®ï¼Œæ˜¯åˆ†å±‚è§£è€¦å¯¼è‡´äº†è¿™ç§ç»“æœã€‚çœŸæ˜¯é†é†çŒé¡¶ï¼","like_count":0},{"had_liked":false,"id":223165,"user_name":"paperen","can_delete":false,"product_type":"c1","uid":2016116,"ip_address":"","ucode":"5F882EAD0559DC","user_header":"https://static001.geekbang.org/account/avatar/00/1e/c3/74/d21bddf4.jpg","comment_is_top":false,"comment_ctime":1591014420,"is_pvip":false,"replies":[{"id":"82239","content":"å…³äº #2ï¼Œè¿™ä¸ªgetLastAddIdè°æ¥è°ƒç”¨ï¼Ÿå¦‚æœæ˜¯ç”¨æˆ·ä¾§æ¥è°ƒç”¨ï¼Œæ€ä¹ˆä¿è¯åœ¨æ–°å¢bookä¹‹åï¼Œè°ƒç”¨è¿™ä¸ªæ–¹æ³•ä¹‹å‰ï¼Œæ²¡æœ‰åˆ«çš„bookæ·»åŠ ï¼Ÿ","user_name":"ä½œè€…å›å¤","user_name_real":"å››ç«","uid":"1580075","ctime":1591029871,"ip_address":"","comment_id":223165,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1591014420","product_id":100035501,"comment_content":"1ã€è´«è¡€ä¸å……è¡€éƒ½æœ‰ç”¨ï¼Œä½†è´«è¡€æ›´å¤šï¼Œå°±æ˜¯å°è£…åˆ°serviceä¸­å®ç°è·Ÿé€»è¾‘ç›¸å…³çš„åŠ¨ä½œ<br>2ã€å¯¹äºCQRSæ¨¡å¼addæ–¹æ³•æƒ³è·å–æ–°å¢çš„bookidï¼Œæ˜¯ä¸æ˜¯å¯ä»¥å¯¹bookæ¨¡å‹å¢åŠ ä¸€ä¸ªæ–¹æ³•å«getLastAddIdæ¥è·å–æœ€è¿‘æ·»åŠ çš„bookidï¼Ÿä½†æˆ‘è¿˜æ˜¯è§‰å¾—ä¸éœ€è¦åšå¾—é‚£ä¹ˆæå°½ï¼Œå¯èƒ½è¿˜æ²¡æ·±åˆ»ç†è§£ï¼Œè§‰å¾—addä¿ç•™è¿”å›bookidå¯¹è§£è€¦å¹¶æ²¡å…³ç³»å‘¢","like_count":0,"discussions":[{"author":{"id":1580075,"avatar":"https://static001.geekbang.org/account/avatar/00/18/1c/2b/2069abe6.jpg","nickname":"å››ç«","note":"","ucode":"E4BED7DCAADD99","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":497035,"discussion_content":"å…³äº #2ï¼Œè¿™ä¸ªgetLastAddIdè°æ¥è°ƒç”¨ï¼Ÿå¦‚æœæ˜¯ç”¨æˆ·ä¾§æ¥è°ƒç”¨ï¼Œæ€ä¹ˆä¿è¯åœ¨æ–°å¢bookä¹‹åï¼Œè°ƒç”¨è¿™ä¸ªæ–¹æ³•ä¹‹å‰ï¼Œæ²¡æœ‰åˆ«çš„bookæ·»åŠ ï¼Ÿ","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1591029871,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":142931,"user_name":"å°”å†¬æ©™","can_delete":false,"product_type":"c1","uid":1225224,"ip_address":"","ucode":"0B013A49BC18DA","user_header":"https://static001.geekbang.org/account/avatar/00/12/b2/08/92f42622.jpg","comment_is_top":false,"comment_ctime":1571589058,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1571589058","product_id":100035501,"comment_content":"æ²¡æƒ³è¿‡ç®€å•çš„ä»£ç æ”¹å˜è•´å«ç€è¿™ä¹ˆå¤šè®¾è®¡ç†å¿µå’Œæ™ºæ…§ã€‚ä»¥å‰åªä¼šæ­»è®°ä»£ç ã€‚","like_count":0},{"had_liked":false,"id":138340,"user_name":"sky","can_delete":false,"product_type":"c1","uid":1583321,"ip_address":"","ucode":"29692959077496","user_header":"https://static001.geekbang.org/account/avatar/00/18/28/d9/78dfd983.jpg","comment_is_top":false,"comment_ctime":1570171999,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1570171999","product_id":100035501,"comment_content":"ä»¥å‰åšç§»åŠ¨å¼€å‘çš„æ—¶å€™ï¼ŒæŠŠæ”¹å˜æ¨¡å‹çŠ¶æ€çš„æ–¹æ³•éƒ½æ”¾åœ¨modalä¸­äº†ï¼ŒåŸæ¥è¿™å°±æ˜¯å……è¡€æ¨¡å‹ã€‚è°¢è°¢è€å¸ˆï¼Œè¯¾ç¨‹è¶Šæ¥è¶Šæ£’ï¼","like_count":0},{"had_liked":false,"id":137987,"user_name":"pyhhou","can_delete":false,"product_type":"c1","uid":1256496,"ip_address":"","ucode":"31EF8D50CF91A5","user_header":"http://thirdwx.qlogo.cn/mmopen/vi_32/ibZVAmmdAibBeVpUjzwId8ibgRzNk7fkuR5pgVicB5mFSjjmt2eNadlykVLKCyGA0GxGffbhqLsHnhDRgyzxcKUhjg/132","comment_is_top":false,"comment_ctime":1569956029,"is_pvip":false,"replies":[{"id":"53139","content":"å…³äº 1) è¿™ä¸ªç†è§£ä¸å¯¹ã€‚ä½ å¯ä»¥å†é˜…è¯»ä¸€ä¸‹æ–‡ç« ï¼Œé‡Œé¢æœ‰è¯´è´«è¡€æ¨¡å‹å’Œå……è¡€æ¨¡å‹æ˜¯æ ¹æ®ä»€ä¹ˆæ¥åŒºåˆ«çš„ã€‚","user_name":"ä½œè€…å›å¤","user_name_real":"å››ç«","uid":"1580075","ctime":1570077192,"ip_address":"","comment_id":137987,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1569956029","product_id":100035501,"comment_content":"1. å¹³æ—¶å®ç°ä¸šåŠ¡æ²¡æœ‰ç‰¹åˆ«æ¶‰åŠåˆ°é¢å‘å¯¹è±¡çš„æ¦‚å¿µï¼Œéƒ½æ˜¯è®¾è®¡ä¸€ä¸ªä¸ªåˆ†ç¦»çš„å‡½æ•°ï¼Œæœ€å¤šæ˜¯å°†èŒè´£ç›¸è¿‘çš„å‡½æ•°æ”¾åœ¨åŒä¸€ä¸ªç›®å½•ä¸‹ï¼Œä¸ä¼šåŒ…è£…æˆç±»ï¼Œmodel å±‚çš„æ“ä½œï¼ˆDB æ“ä½œï¼‰ä¹Ÿéƒ½åœ¨ä¸€ä¸ªä¸ªå‡½æ•°é‡Œé¢å®Œæˆï¼Œè¿™åº”è¯¥ç®—æ˜¯å……è¡€æ¨¡å‹ï¼Ÿ<br><br>2. çœ‹äº†ä¸€ä¸‹è¯„è®ºä»¥åŠè€å¸ˆçš„å›å¤ï¼Œæ„Ÿè§‰å„ç§åšæ³•éƒ½æœ‰åˆ©å¼Šï¼Œæ€è€ƒåˆ†æäº†ä¸€ä¸‹ï¼š<br>  i) ç›´æ¥è¿”å›æ‰€éœ€è¦çš„ idï¼šè¿™æ ·æ˜¯æ–¹ä¾¿ï¼Œä½†æ˜¯è¿åäº† CQRS çš„åŸåˆ™<br>  ii) é€šè¿‡è®¾ç½®å…¨å±€å˜é‡è¿›è¡Œäº¤äº’ï¼šå¦‚æœé‡åˆ°å¹¶è¡Œå¤„ç†çš„æƒ…å†µä¼šæ¯”è¾ƒéº»çƒ¦<br>  iii) å‘½ä»¤ä¸‹è¾¾åå†è°ƒç”¨æŸ¥è¯¢ï¼Œé€šè¿‡æ—¶é—´æˆ³æ¥æ‰¾åˆ°æœ€è¿‘çš„ä¸€æ¬¡æ“ä½œï¼šåŒæ ·è¦è€ƒè™‘å¹¶è¡Œå¤„ç†ï¼Œè€Œä¸”å¦‚ä½•æ‰¾åˆ°æœ€è¿‘çš„ä¸€æ¬¡æ—¶é—´æˆ³ä¹Ÿæ˜¯ä¸€ä¸ªå€¼å¾—æ€è€ƒçš„é—®é¢˜<br>  iv) äº¤ç”±å®¢æˆ·ç«¯å¤„ç†ï¼šä¼šäº§ç”Ÿå…¶ä»–çš„é—®é¢˜<br>æ€»ä¹‹æ˜¯è¦æ ¹æ®å…·ä½“çš„åœºæ™¯è¿›è¡Œæƒè¡¡","like_count":0,"discussions":[{"author":{"id":1580075,"avatar":"https://static001.geekbang.org/account/avatar/00/18/1c/2b/2069abe6.jpg","nickname":"å››ç«","note":"","ucode":"E4BED7DCAADD99","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":469336,"discussion_content":"å…³äº 1) è¿™ä¸ªç†è§£ä¸å¯¹ã€‚ä½ å¯ä»¥å†é˜…è¯»ä¸€ä¸‹æ–‡ç« ï¼Œé‡Œé¢æœ‰è¯´è´«è¡€æ¨¡å‹å’Œå……è¡€æ¨¡å‹æ˜¯æ ¹æ®ä»€ä¹ˆæ¥åŒºåˆ«çš„ã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1570077192,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":137780,"user_name":"æ˜“å„¿æ˜“","can_delete":false,"product_type":"c1","uid":1242864,"ip_address":"","ucode":"B15D1031CA841E","user_header":"https://wx.qlogo.cn/mmopen/vi_32/DYAIOgq83eqLcWH3mSPmhjrs1aGL4b3TqI7xDqWWibM4nYFrRlp0z7FNSWaJz0mqovrgIA7ibmrPt8zRScSfRaqQ/132","comment_is_top":false,"comment_ctime":1569846697,"is_pvip":false,"replies":[{"id":"52984","content":"æ— è®ºæ˜¯è´«è¡€æ¨¡å¼è¿˜æ˜¯å……è¡€æ¨¡å¼ï¼ŒModel å±‚åŒ…å«çš„å†…å®¹éƒ½æ˜¯ä¸€è‡´çš„ï¼šé€»è¾‘+æ•°æ®ï¼ŒåŒºåˆ«æ˜¯å‰è€…æŠŠå®ƒä»¬åˆ†å¼€ã€åˆ†åˆ«å®¹çº³åœ¨æ— é€»è¾‘çš„ Model å®ä½“å¯¹è±¡å’Œæ— çŠ¶æ€çš„ Service ä¸­ï¼Œåè€…åˆ™æ˜¯ç»Ÿä¸€å­˜æ”¾åœ¨æœ‰çŠ¶æ€ä¸”æœ‰é€»è¾‘çš„ Model å®ä½“å¯¹è±¡ä¸­ã€‚ä½ çš„ç–‘é—®æ˜¯è´«è¡€æ¨¡å‹ä¸‹è„±ç¦» Service ä¹‹åçš„ Model å®ä½“å¯¹è±¡å§ï¼Œå®ƒä»¬åªå‰©ä¸‹æ•°æ®ï¼Œè€Œå¾ˆå°‘åŒ…å«ï¼Œæˆ–è€…ä¸åŒ…å«é€»è¾‘ï¼Œç‰¹åˆ«æ˜¯ä¸šåŠ¡é€»è¾‘ã€‚","user_name":"ä½œè€…å›å¤","user_name_real":"å››ç«","uid":"1580075","ctime":1569904862,"ip_address":"","comment_id":137780,"utype":1}],"discussion_count":2,"race_medal":0,"score":"1569846697","product_id":100035501,"comment_content":"çœ‹å®Œè¿™è®²ä¹‹åï¼ŒæŠŠä¸Šä¸€èŠ‚ç»™è€å¸ˆæçš„ä¸€ä¸ªé—®é¢˜è‡ªè¡Œæ˜ç™½äº†~<br>è´«è¡€æ¨¡å‹å’Œå……è¡€æ¨¡å‹åŒºåˆ«æ˜¯Modelç±»æ˜¯å¦åŒ…å«ä¸šåŠ¡é€»è¾‘ï¼Œæˆ‘ä¹‹å‰ç†è§£é”™äº†ï¼Œé”™è¯¯çš„ä»¥ä¸ºæ˜¯ä»¥serviceå±‚æ˜¯å¦åŒ…å«è®°å½•æ•°æ®çš„æˆå‘˜å˜é‡ä¸ºåŒºåˆ†çš„ï¼ˆå…¶å®è¿™ä¸ªå«åšæœ‰æ— çŠ¶æ€ï¼‰<br>é‚£è¿™æ ·ç†è§£èµ·æ¥çš„è¯ï¼Œå¹³æ—¶çš„springMVCä½¿ç”¨action-service-daoä¸‰å±‚çš„éƒ½æ˜¯è´«è¡€æ¨¡å¼ï¼Œæˆ‘åœ¨ä½¿ç”¨é¢å‘å¯¹è±¡å®ç°ä¸šåŠ¡æ—¶æŠŠjavabeanè®¾ç½®ä¸ºscope=propertyå¹¶æŠŠä¸šåŠ¡é€»è¾‘ä¹Ÿå†™åœ¨javabeanä¸­ã€ä¸ä½¿ç”¨ä¸‰å±‚ç»“æ„çš„æ¨¡å¼åº”è¯¥å±äºå……è¡€æ¨¡å¼ã€‚<br>å¦å¤–æœ‰ä¸ªå°ç–‘é—®ï¼šè´«è¡€æ¨¡å¼ä¸‹Modelå±‚è¿˜å‰©ä¸‹ä»€ä¹ˆï¼Œå‚æ•°å¯¹è±¡ï¼Ÿpojoï¼Ÿè¿”å›å€¼å¯¹è±¡ï¼ŸModelæ˜¯ä¸æ˜¯å·²ç»åå­˜å®äº¡äº†ï¼Ÿ","like_count":0,"discussions":[{"author":{"id":1580075,"avatar":"https://static001.geekbang.org/account/avatar/00/18/1c/2b/2069abe6.jpg","nickname":"å››ç«","note":"","ucode":"E4BED7DCAADD99","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":469257,"discussion_content":"æ— è®ºæ˜¯è´«è¡€æ¨¡å¼è¿˜æ˜¯å……è¡€æ¨¡å¼ï¼ŒModel å±‚åŒ…å«çš„å†…å®¹éƒ½æ˜¯ä¸€è‡´çš„ï¼šé€»è¾‘+æ•°æ®ï¼ŒåŒºåˆ«æ˜¯å‰è€…æŠŠå®ƒä»¬åˆ†å¼€ã€åˆ†åˆ«å®¹çº³åœ¨æ— é€»è¾‘çš„ Model å®ä½“å¯¹è±¡å’Œæ— çŠ¶æ€çš„ Service ä¸­ï¼Œåè€…åˆ™æ˜¯ç»Ÿä¸€å­˜æ”¾åœ¨æœ‰çŠ¶æ€ä¸”æœ‰é€»è¾‘çš„ Model å®ä½“å¯¹è±¡ä¸­ã€‚ä½ çš„ç–‘é—®æ˜¯è´«è¡€æ¨¡å‹ä¸‹è„±ç¦» Service ä¹‹åçš„ Model å®ä½“å¯¹è±¡å§ï¼Œå®ƒä»¬åªå‰©ä¸‹æ•°æ®ï¼Œè€Œå¾ˆå°‘åŒ…å«ï¼Œæˆ–è€…ä¸åŒ…å«é€»è¾‘ï¼Œç‰¹åˆ«æ˜¯ä¸šåŠ¡é€»è¾‘ã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1569904862,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1255264,"avatar":"https://static001.geekbang.org/account/avatar/00/13/27/60/7510c6c5.jpg","nickname":"é¹ğŸ˜","note":"","ucode":"B691572430BB9D","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":28926,"discussion_content":"è€å¸ˆæ€»ç»“çš„å¾ˆæ£’","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1570717583,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":137596,"user_name":"æ¯å¤©æ™’ç™½ç‰™","can_delete":false,"product_type":"c1","uid":1004698,"ip_address":"","ucode":"A1B102CD933DEA","user_header":"https://static001.geekbang.org/account/avatar/00/0f/54/9a/76c0af70.jpg","comment_is_top":false,"comment_ctime":1569803962,"is_pvip":false,"replies":[{"id":"52986","content":"ğŸ‘","user_name":"ä½œè€…å›å¤","user_name_real":"å››ç«","uid":"1580075","ctime":1569905416,"ip_address":"","comment_id":137596,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1569803962","product_id":100035501,"comment_content":"MVCæ¶æ„Modelå±‚è®¾è®¡æ—¶ï¼Œæœ‰è´«è¡€æ¨¡å‹å’Œå……è¡€æ¨¡å‹ä¹‹åˆ†<br><br>è´«è¡€æ¨¡å‹:æŠŠé€»è¾‘ä»æ¨¡å‹å®ä½“ä¸­å‰¥ç¦»å‡ºå»ï¼Œæ”¾åˆ°æ— çŠ¶æ€çš„serviceå±‚ä¸­ï¼Œè¾¾åˆ°çŠ¶æ€å’Œé€»è¾‘çš„è§£è€¦(æˆ‘ç»å†è¿‡çš„Modelå±‚è®¾è®¡ä¸€èˆ¬éƒ½æ˜¯è¿™ç§è´«è¡€æ¨¡å‹)<br><br>å……è¡€æ¨¡å‹:æ—¢åŒ…æ¶µæ•°æ®åˆåŒ…æ¶µé€»è¾‘ï¼Œå…·æœ‰å®Œå¤‡æ€§å’Œè‡ªæ´½æ€§<br>ä½ åœ¨è®¾è®¡Modelå±‚ä¸­ä¸€èˆ¬é‡‡ç”¨å“ªç§æ¨¡å‹ï¼Ÿ<br><br>è®¾è®¡æ¥å£æ—¶æœ‰ä¸€ç§æ¨¡å¼æ˜¯CQRS(Command Query Responsibility Segregation,å‘½ä»¤æŸ¥è¯¢èŒè´£åˆ†ç¦»)<br>å‘½ä»¤ä¸è¿”å›ä»»ä½•ç»“æœï¼Œä½†ä¼šæ”¹å˜æ•°æ®çš„çŠ¶æ€ï¼Œä»£è¡¨å†™<br>æŸ¥è¯¢ä¼šè¿”å›ç»“æœï¼Œä½†ä¸ä¼šæ”¹å˜æ•°æ®çŠ¶æ€ï¼Œå°±æ˜¯è¯»<br>åœ¨è®¾è®¡æ¥å£æ—¶ï¼Œå†™æ¥å£å‚æ•°å¯ä»¥æ˜¯å¯¹è±¡ï¼Œè¯»æ¥å£å‚æ•°å¯ä»¥æ˜¯Queryå¯¹è±¡ï¼Œè®¾ç½®æŸ¥è¯¢æ¡ä»¶<br>CQRSè¿™ç§æ¨¡å¼æ˜¯å°†è¯»å†™è§£è€¦äº†<br><br>æˆ‘ç°åœ¨å‚ä¸çš„ä¸€ä¸ªMVCçš„é¡¹ç›®æ˜¯è¯»å†™æ¥å£æ²¡æœ‰æ˜¾æ€§å‚æ•°ï¼Œéƒ½æ˜¯ä»è¯·æ±‚ä¸­è·å–å‚æ•°ï¼Œå¯¹äºå†™æ“ä½œï¼Œä¼šè‡ªå·±ç»„è£…å¯¹è±¡ï¼Œç„¶åè°ƒç”¨DAOå±‚æ¥å£ï¼Œå¯¹äºè¯»æ“ä½œï¼Œç›´æ¥ç»™DAOå±‚æ¥å£ä¼ å‚æŸ¥è¯¢","like_count":0,"discussions":[{"author":{"id":1580075,"avatar":"https://static001.geekbang.org/account/avatar/00/18/1c/2b/2069abe6.jpg","nickname":"å››ç«","note":"","ucode":"E4BED7DCAADD99","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":469169,"discussion_content":"ğŸ‘","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1569905416,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":137021,"user_name":"é äººå“å»èµ¢","can_delete":false,"product_type":"c1","uid":1301286,"ip_address":"","ucode":"7A20F9EBE847E1","user_header":"https://static001.geekbang.org/account/avatar/00/13/db/26/54f2c164.jpg","comment_is_top":false,"comment_ctime":1569577585,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1569577585","product_id":100035501,"comment_content":"çœ‹äº†è¿™ä¸ªï¼Œæˆ‘ä¸€ä¸‹ç†è§£æˆ‘ä»¬æ¡†æ¶æä¾›æœåŠ¡è®¿é—®çš„æ¨¡å—ä¸ºä»€ä¹ˆå‘½åå«facadeã€‚","like_count":0},{"had_liked":false,"id":136979,"user_name":"anginiit","can_delete":false,"product_type":"c1","uid":1105763,"ip_address":"","ucode":"C3FA0CFEADB3BC","user_header":"https://static001.geekbang.org/account/avatar/00/10/df/63/b7296340.jpg","comment_is_top":false,"comment_ctime":1569570039,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1569570039","product_id":100035501,"comment_content":"æœ€è¿‘å‡ ä¸ªé¡¹ç›®éƒ½æ˜¯springMvcï¼Œä½¿ç”¨è´«è¡€æ¨¡å¼","like_count":0},{"had_liked":false,"id":136857,"user_name":"è¨±æ•²æ•²","can_delete":false,"product_type":"c1","uid":1046681,"ip_address":"","ucode":"6486466820E7BF","user_header":"https://static001.geekbang.org/account/avatar/00/0f/f8/99/8e760987.jpg","comment_is_top":false,"comment_ctime":1569544406,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1569544406","product_id":100035501,"comment_content":"å‰ç«¯æ¡†æ¶AngularJSéµå¾ªçš„æ˜¯MVC æ¨¡å¼","like_count":0}]}