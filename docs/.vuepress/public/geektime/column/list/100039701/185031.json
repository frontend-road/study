{"id":185031,"title":"22 | new Function('x = 100')();ï¼šå‡½æ•°çš„ç±»åŒ–æ˜¯å¯¹åŠ¨æ€ä¸é™æ€ç³»ç»Ÿçš„å†æ¬¡ç»Ÿä¸€","content":"<p>ä½ å¥½ï¼Œæˆ‘æ˜¯å‘¨çˆ±æ°‘ï¼Œæ¬¢è¿å›åˆ°æˆ‘çš„ä¸“æ ã€‚</p><p>ä»Šå¤©æ˜¯ä¸“æ æœ€åä¸€è®²ï¼Œæˆ‘æ¥ä¸‹æ¥è¦è·Ÿä½ èŠçš„ï¼Œä»ç„¶æ˜¯JavaScriptçš„åŠ¨æ€è¯­è¨€ç‰¹æ€§ï¼Œä¸»è¦æ˜¯åŠ¨æ€å‡½æ•°çš„å®ç°åŸç†ã€‚</p><p>æ ‡é¢˜ä¸­çš„ä»£ç æ¯”è¾ƒç®€å•ï¼Œæ˜¯å¸¸ç”¨ã€å¸¸è§çš„ã€‚è¿™é‡Œç¨å¾®éœ€è¦å¼ºè°ƒä¸€ä¸‹çš„æ˜¯â€œæœ€åä¸€å¯¹æ‹¬å·çš„ä½¿ç”¨â€ï¼Œç”±äºè¿ç®—ç¬¦ä¼˜å…ˆçº§çš„è®¾è®¡ï¼Œå®ƒæ˜¯åœ¨newè¿ç®—ä¹‹åæ‰è¢«è°ƒç”¨çš„ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œæ ‡é¢˜ä¸­çš„ä»£ç ç­‰ä¹‰äºï¼š</p><pre><code>// ï¼ˆç­‰ä¹‰äºï¼‰\n(new Function('x = 100'))()\n\n// ï¼ˆæˆ–ï¼‰\nf = new Function('x = 100')\nf()\n</code></pre><p>æ­¤å¤–ï¼Œè¿™é‡Œçš„<code>new</code>è¿ç®—ç¬¦ä¹Ÿå¯ä»¥å»æ‰ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼š</p><pre><code>new Function(x)\n\n// vs.\nFunction(x)\n</code></pre><p>è¿™ä¸¤ç§å†™æ³•æ²¡æœ‰åŒºåˆ«ï¼Œéƒ½æ˜¯åŠ¨æ€åœ°åˆ›å»ºä¸€ä¸ªå‡½æ•°ã€‚</p><h2>å‡½æ•°çš„åŠ¨æ€åˆ›å»º</h2><p>å¦‚æœåœ¨ä»£ç ä¸­å£°æ˜ä¸€ä¸ªå‡½æ•°ï¼Œé‚£ä¹ˆè¿™ä¸ªå‡½æ•°å¿…ç„¶æ˜¯å…·åçš„ã€‚å…·åçš„ã€é™æ€çš„å‡½æ•°å£°æ˜æœ‰ä¸¤ä¸ªç‰¹æ€§ï¼š</p><ol>\n<li>æ˜¯å®ƒåœ¨æ‰€æœ‰ä»£ç è¿è¡Œä¹‹å‰è¢«åˆ›å»ºï¼›</li>\n<li>å®ƒä½œä¸ºè¯­å¥çš„æ‰§è¡Œç»“æœå°†æ˜¯â€œç©ºï¼ˆEmptyï¼‰â€ã€‚</li>\n</ol><p>è¿™æ˜¯æ—©æœŸJavaScriptä¸­çš„ä¸€ä¸ªç¡¬æ€§çš„çº¦å®šï¼Œä½†æ˜¯åˆ°äº†ECMAScript 6å¼€å§‹æ”¯æŒæ¨¡å—çš„æ—¶å€™ï¼Œè¿™ä¸ªè®¾è®¡å°±æˆäº†é—®é¢˜ã€‚å› ä¸ºæ¨¡å—æ˜¯é™æ€è£…é…çš„ï¼Œè¿™æ„å‘³ç€å®ƒå¯¼å‡ºçš„å†…å®¹â€œåº”è¯¥æ˜¯â€<span class=\"orange\">ä¸€ä¸ªå£°æ˜çš„ç»“æœ</span>æˆ–è€…<span class=\"orange\">ä¸€ä¸ªå£°æ˜çš„åå­—</span>ï¼Œå› ä¸ºåªæœ‰<strong>å£°æ˜</strong>æ‰æ˜¯é™æ€è£…é…é˜¶æ®µçš„ç‰¹æ€§ã€‚ä½†æ˜¯ï¼Œæ‰€æœ‰å£°æ˜è¯­å¥çš„å®Œæˆç»“æœéƒ½æ˜¯Emptyï¼Œæ˜¯æ— æ•ˆçš„ï¼Œä¸èƒ½ç”¨äºå¯¼å‡ºã€‚</p><blockquote>\n<p>NOTEï¼šå…³äº6ç§å£°æ˜ï¼Œè¯·å‚è§ã€Š<a href=\"https://time.geekbang.org/column/article/165198\">ç¬¬02è®²</a>ã€‹ã€‚</p>\n</blockquote><p>è€Œå£°æ˜çš„åå­—å‘¢ï¼Ÿä¸é”™ï¼Œè¿™å¯¹å…·åå‡½æ•°æ¥è¯´æ²¡é—®é¢˜ã€‚ä½†æ˜¯åŒ¿åå‡½æ•°å‘¢ï¼Ÿå°±æˆäº†é—®é¢˜äº†ã€‚</p><!-- [[[read_end]]] --><p>å› æ­¤ï¼Œåœ¨æ”¯æŒåŒ¿åå‡½æ•°çš„â€œç¼ºçœå¯¼å‡ºï¼ˆexport default â€¦ï¼‰â€æ—¶ï¼ŒECMAScriptå°±å¼•å…¥äº†ä¸€ä¸ªç§°ä¸ºâ€œå‡½æ•°å®šä¹‰ï¼ˆFunction Definitionsï¼‰â€çš„æ¦‚å¿µã€‚è¿™ç§æƒ…å†µä¸‹ï¼Œå‡½æ•°è¡¨è¾¾å¼æ˜¯åŒ¿åçš„ï¼Œä½†å®ƒçš„ç»“æœä¼šç»‘å®šç»™ä¸€ä¸ªåå­—ï¼Œå¹¶ä¸”æœ€ç»ˆä¼šå¯¼å‡ºé‚£ä¸ªåå­—ã€‚è¿™æ ·ä¸€æ¥ï¼Œå‡½æ•°è¡¨è¾¾å¼ä¹Ÿå°±æœ‰äº†â€œç±»ä¼¼å£°æ˜çš„æ€§è´¨â€ï¼Œä½†å®ƒåˆä¸æ˜¯é™æ€å£°æ˜ï¼ˆDeclarationsï¼‰ï¼Œæ‰€ä»¥æ¦‚å¿µä¸Šå«åšå®šä¹‰ï¼ˆDefinitionsï¼‰ã€‚</p><blockquote>\n<p>NOTEï¼šå…³äºåŒ¿åå‡½æ•°å¯¹ç¼ºçœå¯¼å‡ºçš„å½±å“ï¼Œå‚è§ã€Š<a href=\"https://time.geekbang.org/column/article/166491\">ç¬¬04è®²</a>ã€‹ã€‚</p>\n</blockquote><p>åœ¨é™æ€å£°æ˜çš„å‡½æ•°ã€ç±»ï¼Œä»¥åŠè¿™é‡Œè¯´åˆ°çš„å‡½æ•°å®šä¹‰ä¹‹å¤–ï¼Œç”¨æˆ·ä»£ç è¿˜å¯ä»¥åˆ›å»ºè‡ªå·±çš„å‡½æ•°ã€‚è¿™åŒæ ·æœ‰å¥½å‡ ç§æ–¹å¼ï¼Œå…¶ä¸­ä¹‹ä¸€ï¼Œæ˜¯ä½¿ç”¨<code>eval()</code>ï¼Œä¾‹å¦‚ï¼š</p><pre><code># åœ¨éä¸¥æ ¼æ¨¡å¼ä¸‹ï¼Œè¿™å°†åœ¨å½“å‰ä¸Šä¸‹æ–‡ä¸­â€œå£°æ˜â€ä¸€ä¸ªåä¸ºfooçš„å‡½æ•°\n&gt; eval('function foo() {}')\n</code></pre><p>è¿˜æœ‰ä¸€ç§å¸¸è§çš„æ–¹å¼ï¼Œå°±æ˜¯ä½¿ç”¨åŠ¨æ€åˆ›å»ºã€‚</p><h3>å‡ ç§åŠ¨æ€å‡½æ•°çš„æ„é€ å™¨</h3><p>åœ¨JavaScriptä¸­ï¼Œâ€œåŠ¨æ€åˆ›å»ºâ€ä¸€ä¸ªä¸œè¥¿ï¼Œæ„å‘³ç€è¿™ä¸ªä¸œè¥¿æ˜¯ä¸€ä¸ªå¯¹è±¡ï¼Œå®ƒåˆ›å»ºè‡ªç±»/æ„é€ å™¨ã€‚å…¶ä¸­<code>Function()</code>æ˜¯ä¸€åˆ‡å‡½æ•°ç¼ºçœçš„æ„é€ å™¨ï¼ˆæˆ–ç±»ï¼‰ã€‚å°½ç®¡å†…å»ºå‡½æ•°å¹¶ä¸åˆ›å»ºè‡ªå®ƒï¼Œä½†æ‰€æœ‰çš„å†…å»ºå‡½æ•°ä¹Ÿé€šè¿‡ç®€å•çš„æ˜ å°„å°†å®ƒä»¬çš„åŸå‹æŒ‡å‘Functionã€‚é™¤éç»è¿‡ç‰¹æ®Šçš„å¤„ç†ï¼Œæ‰€æœ‰JavaScriptä¸­çš„å‡½æ•°åŸå‹å‡æœ€ç»ˆæŒ‡å‘<code>Function()</code>ï¼Œå®ƒæ˜¯æ‰€æœ‰å‡½æ•°çš„ç¥–å…ˆç±»ã€‚</p><p>è¿™ç§å¤„ç†/è®¾è®¡ä½¿å¾—JavaScriptä¸­çš„å‡½æ•°æœ‰äº†â€œå®Œæ•´çš„â€é¢å‘å¯¹è±¡ç‰¹æ€§ï¼Œå‡½æ•°çš„â€œç±»åŒ–â€å®ç°äº†JavaScriptåœ¨å‡½æ•°å¼è¯­è¨€å’Œé¢å‘å¯¹è±¡è¯­è¨€åœ¨æ¦‚å¿µä¸Šçš„å¤§ä¸€ç»Ÿã€‚äºæ˜¯ï¼Œä¸€ä¸ªå†…æ ¸çº§åˆ«çš„æ¦‚å¿µå®Œæ•´æ€§å‡ºç°äº†ï¼Œä¹Ÿå°±æ˜¯æ‰€è°“ï¼šå¯¹è±¡åˆ›å»ºè‡ªå‡½æ•°ï¼›å‡½æ•°æ˜¯å¯¹è±¡ã€‚å¦‚ä¸‹å›¾æ‰€ç¤ºï¼š</p><p><img src=\"https://static001.geekbang.org/resource/image/7a/38/7a1dfb4942dd0484dd03aba2eb204c38.png?wh=2000*1124\" alt=\"\"></p><blockquote>\n<p>NOTEï¼šå…³äºæ¦‚å¿µå®Œæ•´æ€§ä»¥åŠå®ƒåœ¨â€œä½“ç³»æ€§â€ä¸­çš„ä»·å€¼ï¼Œå‚è§ã€Š<a href=\"https://time.geekbang.org/column/article/175261\">åŠ é¤3ï¼šè®©JavaScriptè¿è¡Œèµ·æ¥</a>ã€‹ã€‚</p>\n</blockquote><p>åœ¨ECMAScript 6ä¹‹åï¼Œæœ‰èµ–äºç±»ç»§æ‰¿ä½“ç³»çš„æå‡ºï¼ŒJavaScriptä¸­çš„å‡½æ•°ä¹Ÿè·å¾—äº†â€œå­ç±»åŒ–â€çš„èƒ½åŠ›ï¼Œäºæ˜¯ç”¨æˆ·ä»£ç ä¹Ÿå¯ä»¥æ´¾ç”Ÿå‡½æ•°çš„å­ç±»äº†ã€‚ä¾‹å¦‚ï¼š</p><pre><code>class MyFunction extends Function {\n  // ...\n}\n</code></pre><p>ä½†æ˜¯ç”¨æˆ·ä»£ç æ— æ³•é‡è½½â€œå‡½æ•°çš„æ‰§è¡Œâ€èƒ½åŠ›ã€‚å¾ˆæ˜æ˜¾ï¼Œè¿™æ˜¯æ‰§è¡Œå¼•æ“è‡ªèº«çš„èƒ½åŠ›ï¼Œé™¤éä½ å¯ä»¥é‡å†™å¼•æ“ï¼Œå¦åˆ™é‡è½½æ‰§è¡Œèƒ½åŠ›ä¹Ÿå°±æ— ä»è°ˆèµ·ã€‚</p><blockquote>\n<p>NOTEï¼šå…³äºç±»ã€æ´¾ç”Ÿï¼Œä»¥åŠå®ƒä»¬åœ¨å¯¹åŸç”Ÿæ„é€ å™¨è¿›è¡Œæ´¾ç”Ÿæ—¶çš„è´¡çŒ®ï¼Œè¯·å‚è§ã€Š<a href=\"https://time.geekbang.org/column/article/179238\">ç¬¬15è®²</a>ã€‹ã€‚</p>\n</blockquote><p>é™¤äº†è¿™ç§ç”¨æˆ·è‡ªå®šä¹‰çš„å­ç±»åŒ–çš„å‡½æ•°ä¹‹å¤–ï¼ŒJavaScriptä¸­ä¸€å…±åªæœ‰å››ç§å¯ä»¥åŠ¨æ€åˆ›å»ºçš„å‡½æ•°ï¼ŒåŒ…æ‹¬ï¼š<strong>ä¸€èˆ¬å‡½æ•°</strong>ï¼ˆFunctionï¼‰ã€<strong>ç”Ÿæˆå™¨å‡½æ•°</strong>ï¼ˆGeneratorFunctionï¼‰ã€<strong>å¼‚æ­¥ç”Ÿæˆå™¨å‡½æ•°</strong>ï¼ˆAsyncGeneratorFunctionï¼‰å’Œ<strong>å¼‚æ­¥å‡½æ•°</strong>ï¼ˆAsyncFunctionï¼‰ã€‚åˆæˆ–è€…è¯´ï¼Œç”¨æˆ·ä»£ç å¯ä»¥ä»è¿™å››ç§å‡½æ•°ä¹‹ä»»ä¸€å¼€å§‹æ¥æ´¾ç”Ÿå®ƒä»¬çš„å­ç±»ï¼Œåœ¨ä¿ç•™å®ƒä»¬çš„æ‰§è¡Œèƒ½åŠ›çš„åŒæ—¶ï¼Œæ‰©å±•æ¥å£æˆ–åŠŸèƒ½ã€‚</p><p>ä½†æ˜¯ï¼Œè¿™å››ç§å‡½æ•°åœ¨JavaScriptä¸­æœ‰ä¸”åªæœ‰<code>Function()</code>æ˜¯æ˜¾å¼å£°æ˜çš„ï¼Œå…¶ä»–ä¸‰ç§éƒ½æ²¡æœ‰ç›´æ¥å£°æ˜å®ƒä»¬çš„æ„é€ å™¨ï¼Œè¿™éœ€è¦ä½ ç”¨å¦‚ä¸‹ä»£ç æ¥å¾—åˆ°ï¼š</p><pre><code>const GeneratorFunction = (function* (){}).constructor;\nconst AsyncGeneratorFunction = (async function* (){}).constructor\nconst AsyncFunction = (async x=&gt;x).constructor;\n\n// ç¤ºä¾‹\n(new AsyncFunction)().then(console.log); // promise print 'undefined'\n</code></pre><h3>å‡½æ•°çš„ä¸‰ä¸ªç»„ä»¶</h3><p>æˆ‘ä»¬æåŠè¿‡å‡½æ•°çš„ä¸‰ä¸ªç»„ä»¶ï¼ŒåŒ…æ‹¬ï¼š<strong>å‚æ•°</strong>ã€<strong>æ‰§è¡Œä½“</strong>å’Œ<strong>ç»“æœ</strong>ã€‚å…¶ä¸­â€œç»“æœï¼ˆResultï¼‰â€æ˜¯ç”±ä»£ç ä¸­çš„returnå­å¥è´Ÿè´£çš„ï¼Œè€Œå…¶ä»–ä¸¤ä¸ªç»„ä»¶ï¼Œåˆ™æ˜¯â€œåŠ¨æ€åˆ›å»ºä¸€ä¸ªå‡½æ•°â€æ‰€å¿…é¡»çš„ã€‚è¿™ä¹Ÿæ˜¯ä¸Šè¿°å››ä¸ªå‡½æ•°ï¼ˆä»¥åŠå®ƒä»¬çš„å­ç±»ï¼‰æ‹¥æœ‰å¦‚ä¸‹ç›¸åŒç•Œé¢çš„åŸå› ï¼š</p><p>Function (p1, p2, â€¦ , pn, body)</p><blockquote>\n<p>NOTEï¼šå…³äºå‡½æ•°çš„ä¸‰ä¸ªç»„ä»¶ï¼Œä»¥åŠåŸºäºå®ƒä»¬çš„å˜åŒ–ï¼Œè¯·å‚è§ã€Š<a href=\"https://time.geekbang.org/column/article/171617\">ç¬¬8è®²</a>ã€<a href=\"https://time.geekbang.org/column/article/172636\">ç¬¬9è®²</a>ã€<a href=\"https://time.geekbang.org/column/article/174314\">ç¬¬10è®²</a>ï¼Œå®ƒä»¬åˆ†åˆ«è®¨è®ºâ€œä¸‰ä¸ªç»„ä»¶â€ã€æ”¹é€ â€œæ‰§è¡Œä½“â€ï¼Œä»¥åŠæ”¹é€ â€œå‚æ•°å’Œç»“æœâ€ã€‹ã€‚</p>\n</blockquote><p>å…¶ä¸­ï¼Œç”¨æˆ·ä»£ç å¯ä»¥ä½¿ç”¨å­—ç¬¦ä¸²æ¥æŒ‡å®šp1â€¦pnçš„å½¢å¼å‚æ•°ï¼ˆFormalsï¼‰ï¼Œå¹¶ä¸”ä½¿ç”¨å­—ç¬¦ä¸²æ¥æŒ‡å®šå‡½æ•°çš„æ‰§è¡Œä½“ï¼ˆBodyï¼‰ã€‚ç±»ä¼¼å¦‚ä¸‹ï¼š</p><pre><code>f = new Function('x', 'y', 'z', 'console.log(x, y, z)');\n\n// æµ‹è¯•\nf(1,2,3); // 1 2 3\n</code></pre><p>JavaScriptä¹Ÿå…è®¸ç”¨æˆ·ä»£ç å°†å¤šä¸ªå‚æ•°åˆå†™ä¸ºä¸€ä¸ªï¼Œä¹Ÿå°±æ˜¯å˜æˆç±»ä¼¼å¦‚ä¸‹å½¢å¼ï¼š</p><pre><code>f = new Function('x, y, z', ...);\n</code></pre><p>æˆ–è€…åœ¨å­—ç¬¦ä¸²å£°æ˜ä¸­ä½¿ç”¨ç¼ºçœå‚æ•°ç­‰æ‰©å±•é£æ ¼ï¼Œä¾‹å¦‚ï¼š</p><pre><code>f = new Function('x = 0, ...args', 'console.log(x, ...args)');\nf(undefined, 200, 300, 400); // 0 200 300 400\n</code></pre><h3>åŠ¨æ€å‡½æ•°çš„åˆ›å»ºè¿‡ç¨‹</h3><p>æ‰€æœ‰çš„å››ç§åŠ¨æ€å‡½æ•°çš„åˆ›å»ºè¿‡ç¨‹éƒ½æ˜¯ä¸€è‡´çš„ï¼Œå®ƒä»¬éƒ½å°†è°ƒç”¨å†…éƒ¨è¿‡ç¨‹<a href=\"https://tc39.es/ecma262/#sec-createdynamicfunction\">CreateDynamicFunction()</a>æ¥åˆ›å»ºå‡½æ•°å¯¹è±¡ã€‚ä½†ç›¸å¯¹äºé™æ€å£°æ˜çš„å‡½æ•°ï¼ŒåŠ¨æ€åˆ›å»ºï¼ˆCreateDynamicFunctionï¼‰å´æœ‰è‡ªå·±ä¸åŒçš„ç‰¹ç‚¹ä¸å®ç°è¿‡ç¨‹ã€‚</p><blockquote>\n<p>NOTEï¼šå…³äºå¯¹è±¡çš„æ„é€ è¿‡ç¨‹ï¼Œè¯·å‚è§ã€Š<a href=\"https://time.geekbang.org/column/article/177397\">ç¬¬13è®²ï¼ˆ13 | new Xï¼‰</a>ã€‹ã€‚</p>\n</blockquote><p><img src=\"https://static001.geekbang.org/resource/image/51/b7/51e63c42eb159ddbc78326da0fb914b7.jpg?wh=1920*1080\" alt=\"\"></p><p>JavaScriptåœ¨åˆ›å»ºå‡½æ•°å¯¹è±¡æ—¶ï¼Œä¼šä¸ºå®ƒåˆ†é…ä¸€ä¸ªç§°ä¸ºâ€œallocKindâ€çš„æ ‡è¯†ã€‚ç›¸å¯¹äºé™æ€åˆ›å»ºï¼Œè¿™ä¸ªæ ‡è¯†åœ¨åŠ¨æ€åˆ›å»ºè¿‡ç¨‹ä¸­åè€Œæ›´åŠ ç®€å•ï¼Œæ­£å¥½ä¸ä¸Šè¿°å››ç§æ„é€ å™¨ä¸€ä¸€å¯¹åº”ï¼Œä¹Ÿå°±ä¸å†éœ€è¦è¿›è¡Œè¯­æ³•çº§åˆ«çš„åˆ†æä¸è¯†åˆ«ã€‚å…¶ä¸­é™¤äº†<code>normal</code>ç±»å‹ï¼ˆå®ƒæ‰€å¯¹åº”çš„æ„é€ å™¨æ˜¯<code>Function()</code>ï¼‰ä¹‹å¤–ï¼Œå…¶ä»–çš„ä¸‰ç§éƒ½ä¸èƒ½ä½œä¸ºæ„é€ å™¨æ¥åˆ›å»ºå’Œåˆå§‹åŒ–ã€‚æ‰€ä»¥ï¼Œåªéœ€è¦ç®€å•åœ°å¡«å†™å®ƒä»¬çš„å†…éƒ¨æ§½ï¼Œå¹¶ç½®ç›¸åº”çš„åŸå‹ï¼ˆåŸå‹å±æ€§F.prototypeä»¥åŠå†…éƒ¨æ§½F.[[Prototype]]ï¼‰å°±å¯ä»¥äº†ã€‚</p><p>æœ€åï¼Œå½“å‡½æ•°ä½œä¸ºå¯¹è±¡å®ä¾‹å®Œæˆåˆ›å»ºä¹‹åï¼Œå¼•æ“ä¼šè°ƒç”¨ä¸€ä¸ªç§°ä¸ºâ€œå‡½æ•°åˆå§‹åŒ–ï¼ˆFunctionInitializeï¼‰â€çš„å†…ç½®è¿‡ç¨‹ï¼Œæ¥åˆå§‹é‚£äº›ä¸å…·ä½“å®ä¾‹ç›¸å…³çš„å†…éƒ¨æ§½å’Œå¤–éƒ¨å±æ€§ã€‚</p><blockquote>\n<p>NOTEï¼šåœ¨ECMAScript 6ä¸­ï¼ŒåŠ¨æ€å‡½æ•°çš„åˆ›å»ºè¿‡ç¨‹ä¸»è¦ç”±FunctionAllocateå’ŒFunctionInitializeä¸¤ä¸ªé˜¶æ®µå®Œæˆã€‚è€Œåˆ°äº†ECMAScript 9ä¸­ï¼ŒECMAScriptè§„èŒƒå°†FunctionAllocateçš„ä¸»è¦åŠŸèƒ½å½’å…¥åˆ°OrdinaryFunctionCreateä¸­ï¼ˆå¹¶ç”±æ­¤è§„èŒƒäº†å‡½æ•°â€œä½œä¸ºå¯¹è±¡â€çš„åˆ›å»ºè¿‡ç¨‹ï¼‰ï¼Œè€ŒåŸæœ¬ç”±FunctionInitializeè´Ÿè´£çš„åˆå§‹åŒ–ï¼Œåˆ™ç›´æ¥åœ¨åŠ¨æ€åˆ›å»ºè¿‡ç¨‹ä¸­å¤„ç†äº†ã€‚</p>\n</blockquote><p>ç„¶åå‘¢ï¼Ÿç„¶åï¼Œå‡½æ•°å°±åˆ›å»ºå®Œäº†ã€‚</p><p>æ˜¯çš„ï¼â€œå¥½åƒâ€ä»€ä¹ˆä¹Ÿæ²¡æœ‰å‘ç”Ÿï¼Ÿï¼äº‹å®ä¸Šï¼Œåœ¨å¼•æ“å±‚é¢ï¼Œæ‰€è°“çš„â€œåŠ¨æ€å‡½æ•°åˆ›å»ºâ€å°±æ˜¯ä»€ä¹ˆä¹Ÿæ²¡æœ‰å‘ç”Ÿï¼Œå› ä¸ºæ‰§è¡Œå¼•æ“å¹¶ä¸ç†è§£â€œå£°æ˜ä¸€ä¸ªå‡½æ•°â€ä¸â€œåŠ¨æ€åˆ›å»ºä¸€ä¸ªå‡½æ•°â€ä¹‹é—´çš„å·®å¼‚ã€‚</p><p>æˆ‘ä»¬è¯•æƒ³ä¸€ä¸‹ï¼Œå¦‚æœä¸€ä¸ªæ‰§è¡Œå¼•æ“è¦åˆ†åˆ«ç†è§£è¿™ä¸¤ç§å‡½æ•°å¹¶å°è¯•ä¸åŒçš„æ‰§è¡Œæ¨¡å¼æˆ–é€»è¾‘ï¼Œé‚£ä¹ˆè¿™ä¸ªå¼•æ“çš„æ•ˆç‡å¾—æœ‰å¤šå·®ã€‚</p><h2>ä½œä¸ºä¸€ä¸ªå‡½æ•°</h2><p>é€šå¸¸æƒ…å†µä¸‹ï¼Œæ¥ä¸‹æ¥è¿˜éœ€è¦ä¸€ä¸ªå˜é‡æ¥å¼•ç”¨è¿™ä¸ªå‡½æ•°å¯¹è±¡ï¼Œæˆ–è€…å°†å®ƒä½œä¸ºè¡¨è¾¾å¼æ“ä½œæ•°ï¼Œå®ƒæ‰ä¼šæœ‰æ„ä¹‰ã€‚å¦‚æœå®ƒä½œä¸ºå¼•ç”¨ï¼Œé‚£ä¹ˆå®ƒè·Ÿæ™®é€šå˜é‡æˆ–å…¶ä»–ç±»å‹çš„æ•°æ®ç±»ä¼¼ï¼›å¦‚æœå®ƒä½œä¸ºä¸€èˆ¬æ“ä½œæ•°ï¼Œé‚£ä¹ˆå®ƒåº”è¯¥æŒ‰ç…§ä¸Šä¸€è®²æ‰€è¯´çš„è§„åˆ™ï¼Œè½¬æ¢æˆâ€œå€¼ç±»å‹â€æ‰èƒ½è¿›è¡Œè¿ç®—ã€‚</p><blockquote>\n<p>NOTEï¼šå…³äºå¼•ç”¨ã€æ“ä½œæ•°ï¼Œä»¥åŠå€¼ç±»å‹ç­‰ç­‰ï¼Œè¯·å‚è§ã€Š<a href=\"https://time.geekbang.org/column/article/164312\">ç¬¬01è®²ï¼ˆ01 | delete 0ï¼‰</a>ã€‹ã€‚</p>\n</blockquote><p>æ‰€ä»¥ï¼Œå¦‚æœä¸è®¨è®ºâ€œåŠ¨æ€å‡½æ•°åˆ›å»ºâ€å†…åœ¨çš„ç‰¹æ®Šæ€§ï¼Œé‚£ä¹ˆå®ƒçš„åˆ›å»ºä¸å…¶ä»–æ•°æ®å¹¶æ²¡æœ‰æœ¬è´¨çš„ä¸åŒï¼šåˆ›å»ºç»“æœä¸€æ ·ï¼Œå¯¹æ‰§è¡Œå¼•æ“æˆ–è¿è¡Œç¯å¢ƒçš„å½±å“ä¹Ÿä¸€æ ·ã€‚è€Œè¿™ç§â€œæ²¡æœ‰å·®å¼‚â€åè€Œä½“ç°äº†â€œå‡½æ•°å¼è¯­è¨€â€çš„ä¸€é¡¹åŸºæœ¬ç‰¹æ€§ï¼šå‡½æ•°æ˜¯æ•°æ®ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œå‡½æ•°å¯ä»¥ä½œä¸ºä¸€èˆ¬æ•°æ®æ¥å¤„ç†ï¼Œä¾‹å¦‚å¯¹è±¡ï¼Œåˆä¾‹å¦‚å€¼ã€‚</p><p>å‡½æ•°ä¸å…¶ä»–æ•°æ®ä¸åŒä¹‹å¤„ï¼Œä»…åœ¨äºå®ƒæ˜¯å¯ä»¥è°ƒç”¨çš„ã€‚é‚£ä¹ˆâ€œåŠ¨æ€åˆ›å»ºçš„å‡½æ•°â€ä¸ä¸€èˆ¬å‡½æ•°ç›¸æ¯”è¾ƒï¼Œåœ¨è°ƒç”¨/æ‰§è¡Œæ–¹é¢æœ‰ä»€ä¹ˆç‰¹æ®Šæ€§å—ï¼Ÿ</p><p>ç­”æ¡ˆæ˜¯ï¼Œä»ç„¶æ²¡æœ‰ï¼åœ¨ECMAScriptçš„å†…éƒ¨æ–¹æ³•<code>Call()</code>æˆ–è€…å‡½æ•°å¯¹è±¡çš„å†…éƒ¨æ§½<code>[[Call]] [[Construct]]</code>ä¸­ï¼Œæ ¹æœ¬æ²¡æœ‰ä»»ä½•ä»£ç æ¥åŒºåˆ«è¿™ä¸¤ç§æ–¹å¼åˆ›å»ºå‡ºæ¥çš„å‡½æ•°ã€‚å®ƒä»¬ä¹‹é—´æ¯«æ— å·®å¼‚ã€‚</p><blockquote>\n<p>NOTEï¼šäº‹å®ä¸Šï¼Œä¸æƒŸå¦‚æ­¤ï¼Œæˆ‘å°è¯•è¿‡å¾ˆå¤šçš„æ–¹å¼æ¥è¯†åˆ«ä¸åŒç±»å‹çš„å‡½æ•°ï¼ˆä¾‹å¦‚æ„é€ å™¨ã€ç±»ã€æ–¹æ³•ç­‰ï¼‰ã€‚é™¤äº†æå°‘çš„ç‰¹ä¾‹ä¹‹å¤–ï¼Œåœ¨ç”¨æˆ·ä»£ç å±‚é¢æ˜¯æ²¡æœ‰åŠæ³•è¯†åˆ«å‡½æ•°çš„ç±»å‹çš„ã€‚å°±ç°åœ¨çš„è¿›å±•è€Œè¨€ï¼Œ<code>isBindable()</code>ã€<code>isCallable()</code>ã€<code>isConstructor()</code>å’Œ<code>isProxy()</code>è¿™å››ä¸ªå‡½æ•°æ˜¯å¯ä»¥å®ç°çš„ï¼Œå…¶ä»–çš„ç±»ä¼¼<code>isClassConstructor()</code>ã€<code>isMethod()</code>å’Œ<code>isArrowFunction()</code>éƒ½æ²¡æœ‰æœ‰æ•ˆçš„è¯†åˆ«æ–¹å¼ã€‚</p>\n</blockquote><blockquote>\n<p>NOTEï¼šå¦‚ä¸Šçš„è¿™äº›è¯†åˆ«å‡½æ•°ï¼Œéœ€è¦åœ¨ä¸åˆ©ç”¨toString()æ–¹æ³•ï¼Œä»¥åŠä¸è°ƒç”¨å‡½æ•°çš„æƒ…å†µä¸‹æ¥å®Œæˆã€‚å› ä¸ºæ‰§è¡Œå‡½æ•°ä¼šå¸¦æ¥æœªçŸ¥çš„ç»“æœï¼Œè€ŒtoStringæ–¹æ³•çš„å®ç°åœ¨è®¸å¤šå¼•æ“ä¸­å¹¶ä¸æ ‡å‡†ï¼Œä¸å¯ä¾èµ–ã€‚</p>\n</blockquote><p>ä¸è¿‡ï¼Œå¦‚æœæˆ‘ä»¬å°†æ—¶é’Ÿå¾€å›æ‹”ä¸€ç‚¹ï¼Œè€ƒå¯Ÿä¸€ä¸‹è¿™ä¸ªå‡½æ•°è¢«åˆ›å»ºå‡ºæ¥ä¹‹å‰æ‰€å‘ç”Ÿçš„äº‹æƒ…ï¼Œé‚£ä¹ˆï¼Œæˆ‘ä»¬è¿˜æ˜¯èƒ½æ‰¾åˆ°â€œå”¯ä¸€ä¸€ç‚¹ä¸åŒâ€ã€‚è€Œè¿™ï¼Œä¹Ÿå°†æ˜¯æˆ‘åœ¨â€œåŠ¨æ€è¯­è¨€â€è¿™ä¸ªç³»åˆ—ä¸­ä¸ºä½ æ­ç¤ºçš„æœ€åä¸€ä¸ªç§˜å¯†ã€‚</p><h2>å”¯ä¸€ä¸€ç‚¹ä¸åŒ</h2><p>åœ¨â€œå‡½æ•°åˆå§‹åŒ–ï¼ˆFunctionInitializeï¼‰â€è¿™ä¸ªé˜¶æ®µä¸­ï¼ŒECMAScriptç ´å¤©è’åœ°çº¦å®šäº†å‡ è¡Œä»£ç ï¼Œè¿™æ®µè§„èŒƒæ–‡å­—å¦‚ä¸‹ï¼š</p><blockquote>\n<p>Let realmF be the value of Fâ€™s [[Realm]] internal slot.<br>\nLet <strong>scope</strong> be realmF.[[GlobalEnv]].<br>\nPerform <em>FunctionInitialize</em>(F, Normal, parameters, body, <strong>scope</strong>).</p>\n</blockquote><p>å®ƒä»¬æ˜¯ä»€ä¹ˆæ„æ€å‘¢ï¼Ÿ</p><p>è§„èŒƒçº¦å®šéœ€è¦ä»å‡½æ•°å¯¹è±¡æ‰€åœ¨çš„â€œåŸŸï¼ˆå³å¼•æ“çš„ä¸€ä¸ªå®ä¾‹ï¼‰â€ä¸­å–å‡ºå…¨å±€ç¯å¢ƒï¼Œç„¶åå°†å®ƒä½œä¸ºâ€œçˆ¶çº§çš„ä½œç”¨åŸŸï¼ˆscopeï¼‰â€ï¼Œä¼ å…¥<code>FunctionInitialize()</code>æ¥åˆå§‹åŒ–å‡½æ•°<code>F</code>ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œæ‰€æœ‰çš„â€œåŠ¨æ€å‡½æ•°â€çš„çˆ¶çº§ä½œç”¨åŸŸå°†æŒ‡å‘å…¨å±€ï¼</p><p>ä½ ç»ä¸å¯èƒ½åœ¨â€œå½“å‰ä¸Šä¸‹æ–‡ï¼ˆç¯å¢ƒ/ä½œç”¨åŸŸï¼‰â€ä¸­åŠ¨æ€åˆ›å»ºåŠ¨æ€å‡½æ•°ã€‚å’Œé—´æ¥è°ƒç”¨æ¨¡å¼ä¸‹çš„<code>eval()</code>ä¸€æ ·ï¼Œæ‰€æœ‰åŠ¨æ€å‡½æ•°éƒ½å°†åˆ›å»ºåœ¨å…¨å±€ï¼</p><p>ä¸€è¯´åˆ°è·Ÿâ€œé—´æ¥è°ƒç”¨eval()â€å­˜æœ‰çš„ç›¸ä¼¼ä¹‹å¤„ï¼Œå¯èƒ½ä½ ç«‹å³ä¼šååº”è¿‡æ¥ï¼šè¿™ç§æƒ…å†µä¸‹ï¼Œ<code>eval()</code>ä¸ä»…ä»…æ˜¯åœ¨å…¨å±€æ‰§è¡Œï¼Œè€Œä¸”å°†çªç ´â€œå…¨å±€çš„ä¸¥æ ¼æ¨¡å¼â€ï¼Œä»£ç å°†æ‰§è¡Œåœ¨éä¸¥æ ¼æ¨¡å¼ä¸­ï¼é‚£ä¹ˆï¼Œæ˜¯ä¸æ˜¯è¯´ï¼Œâ€œåŠ¨æ€å‡½æ•°â€æ—¢ç„¶ä¸å®ƒæœ‰ç›¸ä¼¼ä¹‹å¤„ï¼Œæ˜¯ä¸æ˜¯ä¹Ÿæœ‰ç±»ä¼¼æ€§è´¨å‘¢ï¼Ÿ</p><blockquote>\n<p>NOTEï¼šå…³äºé—´æ¥è°ƒç”¨<code>eval()</code>ï¼Œè¯·å‚è§ã€Š<a href=\"https://time.geekbang.org/column/article/184589\">ç¬¬21è®²</a>ã€‹ã€‚</p>\n</blockquote><p>ç­”æ¡ˆæ˜¯ï¼šçš„ç¡®ï¼</p><p>å‡ºäºä¸â€œé—´æ¥è°ƒç”¨eval()â€ç›¸åŒçš„åŸå› â€”â€”å³ï¼Œåœ¨åŠ¨æ€æ‰§è¡Œè¿‡ç¨‹ä¸­æ— æ³•æœ‰æ•ˆåœ°ï¼ˆé€šè¿‡ä¸Šä¸‹æ–‡å’Œå¯¹åº”çš„ç¯å¢ƒï¼‰æ£€æµ‹å…¨å±€çš„ä¸¥æ ¼æ¨¡å¼çŠ¶æ€ï¼Œæ‰€ä»¥åŠ¨æ€å‡½æ•°åœ¨åˆ›å»ºæ—¶åªæ£€æµ‹ä»£ç æ–‡æœ¬ä¸­çš„ç¬¬ä¸€è¡Œä»£ç æ˜¯å¦ä¸º<code>use strict</code>æŒ‡ç¤ºå­—ï¼Œè€Œå¿½ç•¥å®ƒâ€œå¤–éƒ¨scopeâ€æ˜¯å¦å¤„äºä¸¥æ ¼æ¨¡å¼ä¸­ã€‚</p><p>å› æ­¤ï¼Œå³ä½¿ä½ åœ¨ä¸¥æ ¼æ¨¡å¼çš„å…¨å±€ç¯å¢ƒä¸­åˆ›å»ºåŠ¨æ€å‡½æ•°ï¼Œå®ƒä¹Ÿæ˜¯æ‰§è¡Œåœ¨éä¸¥æ ¼æ¨¡å¼ä¸­çš„ã€‚å®ƒä¸â€œé—´æ¥è°ƒç”¨eval()â€çš„å”¯ä¸€å·®å¼‚ï¼Œä»…åœ¨äºâ€œå¤šå°è£…äº†ä¸€å±‚å‡½æ•°â€ã€‚</p><p>ä¾‹å¦‚ï¼š</p><pre><code># è®©NodeJSåœ¨å¯åŠ¨ä¸¥æ ¼æ¨¡å¼çš„å…¨å±€\n&gt; node --use-strict\n\n# ï¼ˆåœ¨ä¸Šä¾‹å¯åŠ¨çš„NodeJSç¯å¢ƒä¸­æµ‹è¯•ï¼‰\n&gt; x = &quot;Hi&quot;\nReferenceError: x is not defined\n\n# æ‰§è¡Œåœ¨å…¨å±€ï¼Œæ²¡æœ‰å¼‚å¸¸\n&gt; new Function('x = &quot;Hi&quot;')()\nundefined\n\n# `x`è¢«åˆ›å»º\n&gt; x\n'Hi'\n\n# ä½¿ç”¨é—´æ¥è°ƒç”¨çš„`eval`æ¥åˆ›å»º`y`\n&gt; (0, eval)('y = &quot;Hello&quot;')\n&gt; y\n'Hello'\n</code></pre><h2>ç»“å°¾</h2><p>æ‰€ä»¥ï¼Œå›åˆ°ä»Šå¤©è¿™ä¸€è®²çš„æ ‡é¢˜ä¸Šæ¥ã€‚æ ‡é¢˜ä¸­çš„ä»£ç ï¼Œäº‹å®ä¸ä¸Šä¸€è®²ä¸­æåˆ°çš„â€œé—´æ¥è°ƒç”¨eval()â€çš„æ•ˆæœä¸€è‡´ï¼ŒåŒæ ·ä¹Ÿä¼šå› ä¸ºåœ¨å…¨å±€ä¸­â€œå‘æœªå£°æ˜å˜é‡èµ‹å€¼â€è€Œå¯¼è‡´åˆ›å»ºä¸€ä¸ªæ–°çš„å˜é‡å<code>x</code>ã€‚å¹¶ä¸”ï¼Œè¿™ä¸€æ•ˆæœåŒæ ·ä¸å—æ‰€è°“çš„â€œä¸¥æ ¼æ¨¡å¼â€çš„å½±å“ã€‚</p><p>åœ¨JavaScriptçš„æ‰§è¡Œç³»ç»Ÿä¸­å‡ºç°è¿™ä¸¤ä¸ªè¯­æ³•æ•ˆæœçš„æ ¹æœ¬åŸå› ï¼Œåœ¨äºæ‰§è¡Œç³»ç»Ÿè¯•å›¾ä»è¯­æ³•ç¯å¢ƒä¸­ç‹¬ç«‹å‡ºæ¥ã€‚å¦‚æœè€ƒè™‘å…·ä½“ç¯å¢ƒçš„å·®å¼‚æ€§ï¼Œé‚£ä¹ˆæ‰§è¡Œå¼•æ“çš„æ€§èƒ½å°†ä¼šè¾ƒå·®ï¼Œä¸”ä¸æ˜“ä¼˜åŒ–ï¼›å¦‚æœä¸è€ƒè™‘è¿™ç§å·®å¼‚æ€§ï¼Œé‚£ä¹ˆâ€œä¸¥æ ¼æ¨¡å¼â€è¿™æ ·çš„æ€§è´¨å°±ä¸èƒ½ä½œä¸ºï¼ˆæ‰§è¡Œå¼•æ“ç†è§£çš„ï¼‰ç¯å¢ƒå±æ€§ã€‚</p><p>åœ¨è¿™ä¸ªä¸¤éš¾ä¸­ï¼ŒECMAScriptå¸®åŠ©æˆ‘ä»¬åšå‡ºäº†é€‰æ‹©ï¼šç‰ºç‰²ä¸€è‡´æ€§ï¼Œæ¢å–æ€§èƒ½ã€‚</p><blockquote>\n<p>NOTEï¼šå…³äºé—´æ¥è°ƒç”¨<code>eval()</code>å¯¹ç¯å¢ƒçš„ä½¿ç”¨ï¼Œä»¥åŠç¯å¢ƒç›¸å…³çš„æ‰§è¡Œå¼•æ“ç»„ä»¶çš„è®¾è®¡ä¸é™åˆ¶ï¼Œè¯·å‚è§ã€Š<a href=\"https://time.geekbang.org/column/article/183440\">ç¬¬20è®²</a>ã€‹ã€‚</p>\n</blockquote><p>å½“ç„¶è¿™ä¹Ÿå¸¦æ¥äº†å¦å¤–ä¸€äº›å¥½å¤„ã€‚ä¾‹å¦‚ç»ˆäºæœ‰äº†<code>window.execScript()</code>çš„æ›¿ä»£å®ç°ï¼Œä»¥åŠé€šè¿‡<code>new Function</code>è¿™æ ·æ¥å¾—åˆ°çš„ã€åŠ¨æ€åˆ›å»ºçš„å‡½æ•°ï¼Œå°±å¯ä»¥â€œå®‰å…¨åœ°â€åº”ç”¨äºå¹¶å‘ç¯å¢ƒã€‚</p><p>è‡³äºç°åœ¨ï¼Œã€ŠJavaScriptæ ¸å¿ƒåŸç†è§£æã€‹ä¸€å…±22è®²å†…å®¹å°±å…¨éƒ¨ç»“æŸäº†ã€‚</p><p>åœ¨è¿™ä¸ªä¸“æ ä¸­ï¼Œæˆ‘ä¸ºä½ è®²è¿°äº†JavaScriptçš„é™æ€è¯­è¨€è®¾è®¡ã€é¢å‘å¯¹è±¡è¯­è¨€çš„åŸºæœ¬ç‰¹æ€§ï¼Œä»¥åŠåŠ¨æ€è¯­è¨€ä¸­çš„ç±»å‹ä¸æ‰§è¡Œç³»ç»Ÿã€‚è¿™çœ‹èµ·æ¥æ˜¯ä¸€äº›é›¶ç¢çš„ã€åŸºæœ¬çš„ï¼Œä»¥åŠåº”ç”¨æ€§ä¸å¼ºçš„JavaScriptç‰¹æ€§ï¼Œä½†æ˜¯äº‹å®ä¸Šï¼Œå®ƒä»¬æ˜¯ä½ ç†è§£â€œæ›´åŠ æ·±å…¥çš„æ ¸å¿ƒåŸç†â€çš„åŸºç¡€ã€‚</p><p>å¦‚æœä¸å…ˆæŒæ¡è¿™äº›å†…å®¹ï¼Œé‚£ä¹ˆæ›´æ·±å…¥çš„ï¼Œä¾‹å¦‚å¤šçº¿ç¨‹ã€å¹¶è¡Œè¯­è¨€ç‰¹æ€§ç­‰ç­‰éƒ½æ˜¯ç©ºä¸­æ¥¼é˜ï¼Œå°±ç®—ä½ å‹‰å¼ºå­¦æ¥ï¼Œä¹Ÿä¸è¿‡æ˜¯èŠ±æ¶å­ï¼Œæ˜¯ç†è§£ä¸åˆ°çœŸæ­£çš„â€œæ ¸å¿ƒâ€çš„ã€‚</p><p>è€Œè¿™ä¹Ÿæ˜¯æˆ‘åƒç°åœ¨è¿™æ ·è®¾è®¡ã€ŠJavaScriptæ ¸å¿ƒåŸç†è§£æã€‹22è®²æ¡†æ¶çš„åŸå› ã€‚æˆ‘å¸Œæœ›ä½ èƒ½åœ¨è¿™äº›æ–¹é¢æ‰“ä¸ªåŸºç¡€ï¼Œå…ˆç†è§£ä¸€ä¸‹ECMAScriptä½œä¸ºâ€œè¯­è¨€è®¾è®¡è€…â€è¿™ä¸ªè§’è‰²çš„èŒè´£å’Œå…³æ³¨ç‚¹ï¼Œå…ˆå°è¯•ä¸€ä¸‹æ·±å…¥æ¢ç´¢JavaScriptæ ¸å¿ƒåŸç†çš„ä¹è¶£ï¼ˆä¸è‰°éš¾ï¼‰ã€‚ç„¶åï¼Œå¸Œæœ›æˆ‘ä»¬è¿˜æœ‰æœºä¼šåœ¨æ–°çš„è¯¾ç¨‹ä¸­å†è§ï¼</p><p><a href=\"https://jinshuju.net/f/TmdBMP\"><img src=\"https://static001.geekbang.org/resource/image/a9/c4/a9c16d26dfcdd8ff91002344df2297c4.jpg?wh=1142*801\" alt=\"\"></a></p><p>å¤šè°¢ä½ çš„æ”¶å¬ï¼Œæœ€åé‚€è¯·ä½ å¡«å†™è¿™ä¸ªä¸“æ çš„<a href=\"https://jinshuju.net/f/TmdBMP\">è°ƒæŸ¥é—®å·</a>ï¼Œæˆ‘ä¹Ÿæƒ³å¬å¬ä½ çš„æ„è§å’Œå»ºè®®ï¼Œæˆ‘å°†ç»§ç»­ç­”ç–‘è§£æƒ‘ã€æŸ¥æ¼è¡¥ç¼ºï¼Œä¸ä½ å›é¡¾è¿™ä¸€è·¯è¡Œæ¥çš„è‹¦ä¹ã€‚</p><p>å†è§ã€‚</p><blockquote>\n<p>NOTEï¼šç¼–è¾‘åŒå­¦è¯´è¿˜æœ‰ä¸€ä¸ªâ€œç»“æŸè¯­â€ï¼Œæˆ‘çœŸä¸çŸ¥é“æ€ä¹ˆå†™ã€‚ä¸è¿‡ï¼Œå¦‚æœä½ è§‰å¾—æ„çŠ¹æœªå°½çš„è¯ï¼Œåˆ°æ—¶å€™è¯·æ‰“å¼€å¬å¬å§ï¼ˆæˆ–è®¸è¿˜æœ‰å¥½è´§å±ï¼‰ã€‚<br>\nby aimingoo.</p>\n</blockquote>","comments":[{"had_liked":false,"id":168296,"user_name":"ç‹¬é’“å¯’æ±Ÿé›ª","can_delete":false,"product_type":"c1","uid":1625419,"ip_address":"","ucode":"76278A3EBCE0B8","user_header":"https://static001.geekbang.org/account/avatar/00/18/cd/4b/36396a18.jpg","comment_is_top":false,"comment_ctime":1578043266,"is_pvip":true,"replies":[{"id":"65447","content":"ğŸ™","user_name":"ä½œè€…å›å¤","user_name_real":"Aiming","uid":"1521669","ctime":1578197097,"ip_address":"","comment_id":168296,"utype":1}],"discussion_count":1,"race_medal":0,"score":"27347847042","product_id":100039701,"comment_content":"ä»Šå¤©è¯»å®Œäº†ä¸“æ å¿…å­¦å†…å®¹çš„æœ€åä¸€è®²ï¼Œè·Ÿç€è€å¸ˆçš„æ­¥ä¼ä¸€è·¯èµ°æ¥ï¼Œå¾ˆè‰°è¾›ï¼ŒåŒæ—¶ä¹Ÿæ”¶è·å¾ˆå¤šï¼Œé€šè¿‡ä¸€è¡Œæç®€çš„ä»£ç å»æ´æ‚‰ä¸€é—¨è¯­è¨€çš„æ ¸å¿ƒåŸç†ï¼Œä¹Ÿæ˜¯æˆ‘ä¸€ç›´æ¢¦æƒ³ç€èƒ½åšåˆ°çš„äº‹ï¼Œå‘è€å¸ˆè‡´æ•¬ï¼<br><br>å…¶å®ï¼Œå¯ä»¥è¯´ï¼Œçœ‹è¿™ç§åº•å±‚çš„ä¸œè¥¿ï¼Œæ¯ä¸€è®²éƒ½å¾ˆåƒåŠ›ï¼Œè¦æƒ³æœ‰æ›´æ·±å…¥çš„ç†è§£ï¼Œå¿…é¡»å†èŠ±æ—¶é—´å›è¿‡å¤´åå¤ç ”è¯»ï¼›å…¶å®ï¼Œé˜…è¯»ä¸“æ ï¼Œå¾ˆå¤šæ—¶å€™ä¹Ÿæ˜¯ä¸€ç§æ€ç»´çš„æå‡ï¼Œæ¯”å¦‚ä»¥å‰åªçŸ¥é“å˜é‡æå‡ï¼Œå´æ²¡æƒ³è¿‡ä¸ºä»€ä¹ˆè¦æå‡ï¼›çŸ¥é“...è¿ç®—ç¬¦ï¼Œå´è¯´ä¸å‡ºä¸ºä»€ä¹ˆå¯ä»¥ç”¨å®ƒæ¥å±•å¼€å¯¹è±¡ã€‚ã€‚ã€‚<br><br>æˆ–è®¸ä¸“æ çŸ­æœŸå†…å¯¹å¼€å‘èƒ½åŠ›ä¸ä¼šæœ‰å¤šä¹ˆæ˜¾è‘—çš„æå‡ï¼Œä½†æˆ‘ç›¸ä¿¡ï¼Œå› ä¸ºå¯¹è¯­è¨€æœ¬è´¨çš„æ´æ‚‰è€Œäº§ç”Ÿçš„è‡ªä¿¡ä»¥åŠæ€æƒ³å±‚é¢çš„æå‡ï¼Œå°†ä¼šä½¿æˆ‘åœ¨å‰ç«¯èµ°çš„æ›´è¿œã€‚è¡·å¿ƒçš„æ„Ÿè°¢ğŸ™","like_count":7,"discussions":[{"author":{"id":1521669,"avatar":"https://static001.geekbang.org/account/avatar/00/17/38/05/7beecd5d.jpg","nickname":"Aiming","note":"","ucode":"66292B32F9960A","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":480183,"discussion_content":"ğŸ™","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1578197097,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":168071,"user_name":"è¡Œé—®","can_delete":false,"product_type":"c1","uid":1039504,"ip_address":"","ucode":"F3AED699218475","user_header":"https://static001.geekbang.org/account/avatar/00/0f/dc/90/c980113a.jpg","comment_is_top":false,"comment_ctime":1578010923,"is_pvip":false,"replies":[{"id":"65285","content":"Oh. è¿™ä¸ª<br>&gt; new Function(x)  vs  Function(x) æ²¡ä»€ä¹ˆåŒºåˆ«<br><br>å¹¶ä¸ç®—æ˜¯å¾ˆç‰¹åˆ«çš„ç‰¹ä¾‹ã€‚ä½ åº”è¯¥è®°å¾—new AClass()çš„æ—¶å€™ï¼Œå…è®¸â€œç”¨æˆ·ä»£ç ç›´æ¥è¿”å›å¯¹è±¡ï¼Œè€Œä¸æ˜¯ç›´æ¥ä½¿ç”¨thisâ€<br>è¿™ä¸ªç‰¹æ€§å¯¹å§ï¼Œå…¶å®è¿™å°±æ˜¯è¿™ä¸ªç‰¹æ€§çš„åº”ç”¨ã€‚å› ä¸ºå½“ç”¨æˆ·ä»£ç è¿”å›è‡ªå·±åˆ›å»ºçš„å¯¹è±¡æ˜¯ï¼Œç”¨ä¸ç”¨newï¼Œæ•ˆæœéƒ½æ˜¯ä¸€æ ·çš„äº†ã€‚â€”â€”æ‰€ä»¥ï¼Œè¿™é‡Œçš„æ„æ€æ˜¯è¯´ï¼ŒFunction()åœ¨å®ç°æ—¶ä¹Ÿæ˜¯è‡ªå·±è¿”å›äº†å¯¹è±¡ï¼Œè€Œæ²¡æœ‰ä½¿ç”¨ç¼ºçœnewç»™ä»–åˆ›å»ºçš„thisã€‚<br><br>ç†è®ºä¸Šï¼Œè¿™å¯¹ç±»åŒ–æ¥è¯´ä¹Ÿæ˜¯é€‚ç”¨çš„ã€‚å› ä¸ºç±»åŒ–ä¹Ÿå…è®¸ç”¨æˆ·ä»£ç è¿”å›å¯¹è±¡æ¥æ›¿ä»£thisã€‚ä½†æ˜¯â€”â€”å‘µå‘µï¼Œå¦‚æœä½ ç”¨â€œclass X...â€æ¥å£°æ˜ç±»ï¼Œé‚£ä¹ˆè¿™ä¸ªXæ˜¯åªèƒ½ç”¨newæ¥è°ƒç”¨çš„ï¼Œè€Œä¸èƒ½ç›´æ¥å½“åšå‡½æ•°è°ƒç”¨ã€‚<br>```<br>&gt; X()<br>TypeError: Class constructor X cannot be invoked without &#39;new&#39;<br>```<br><br>å…³äºnullå€¼å’Œ{}ã€‚å…¶å®nullå€¼æ˜¯ä¸€ä¸ªç‰¹æ®Šæ€§ï¼Œå®ƒæ˜¯çœŸçš„â€œä»€ä¹ˆä¹Ÿæ²¡æœ‰â€ï¼Œä½ ç”šè‡³å¯ä»¥å°†å®ƒç†è§£ä¸ºCé‡Œé¢çš„#0ã€‚è€Œå®ƒæ˜¯å¯¹è±¡ï¼ˆtypeof nullï¼‰ï¼Œä»¥åŠå®ƒèƒ½ä½œä¸ºå…¶å®ƒå¯¹è±¡æˆ–ç±»çš„åŸå‹ï¼Œåªæ˜¯ä¸€ä¸ªè¯­è¨€è®¾è®¡ï¼Œè€Œä¸å®ƒçš„å†…å­˜å ç”¨æ²¡æœ‰å…³ç³»ã€‚ä½ å¯ä»¥è¿™æ ·ç†è§£ï¼Œæ²¡é—®é¢˜ã€‚â€”â€”å¦å¤–ï¼Œåœ¨ECMAScriptä¸­ï¼Œnullæ˜¯ä¸€ä¸ªåŸå§‹å€¼ï¼ˆPrimitive valueï¼‰ï¼Œè¿™æ„å‘³ç€å®ƒå¯ä»¥ç›´æ¥åœ¨å¼•æ“ä¸­è¡¨è¾¾ä¸ºäºŒè¿›åˆ¶çš„å­˜å‚¨ï¼ŒçœŸçš„è·Ÿ#0å¾ˆæ¥è¿‘äº†ã€‚^^.<br><br>è€Œ{}æ˜¯ä¸€ä¸ªå¯¹è±¡ï¼Œå®ƒåœ¨å¼•æ“ä¸­è¡¨è¾¾ä¸ºä¸€ä¸ªç»“æ„ã€ä¸€ä¸ªæ•°æ®å—ï¼ˆä¹Ÿå°±æ˜¯ä½ è®¤ä¸ºçš„æ”¾åœ¨å †é‡Œï¼Œå…¶å®æ˜¯ä¸æ˜¯æ”¾åœ¨å †é‡Œä¸é‡è¦ï¼Œè€Œä¸”ä¹Ÿå¹¶ä¸ç¡®å®šï¼‰ã€‚å¯¹è±¡ä¹‹æ‰€ä»¥ä¸ºç©ºç™½ï¼ˆâ€œ{}â€ç§°ä¸ºç©ºç™½å¯¹è±¡Empty objectsï¼‰ï¼Œæ˜¯å› ä¸ºå®ƒçš„è‡ªæœ‰å±æ€§è¡¨ä¸ºç©ºï¼Œå½“è‡ªæœ‰å±æ€§è¡¨é‡Œé¢æ²¡æœ‰å±æ€§é¡¹çš„æ—¶å€™ï¼Œå®ƒå°±æ˜¯ç©ºç™½çš„äº†ã€‚â€”â€”ä½ å¯ä»¥é‡ç½®å®ƒçš„åŸå‹ï¼Œè®©ä»–è¡¨ç°å¾—æœ‰ä¸€äº›å±æ€§ä»€ä¹ˆçš„ã€‚å› ä¸ºå®ƒæ¯•ç«Ÿè¿˜æ˜¯ä¸€ä¸ªå¯æ“ä½œçš„ã€å æœ‰å¼•æ“ä¸­çš„å­˜å‚¨çš„çœŸå®å¯¹è±¡ã€‚<br><br>å¦å¤–ï¼ŒECMAScriptå†…éƒ¨ï¼ˆä»¥åŠå¼•æ“å†…éƒ¨çš„æ‰§è¡Œé€»è¾‘ä¸­ï¼‰å…¶å®æ˜¯æŠŠnullå€¼ç†è§£ä¸ºâ€œå€¼â€çš„ï¼Œè€Œä¸æ˜¯â€œå¯¹è±¡â€ã€‚æ‰€ä»¥ECMAScriptçš„å†…éƒ¨æ–¹æ³•IsObject(null)ï¼Œæ˜¯è¿”å›falseçš„ã€‚","user_name":"ä½œè€…å›å¤","user_name_real":"Aiming","uid":"1521669","ctime":1578020079,"ip_address":"","comment_id":168071,"utype":1}],"discussion_count":2,"race_medal":0,"score":"18757880107","product_id":100039701,"comment_content":"new Function(x)  vs  Function(x) æ²¡ä»€ä¹ˆåŒºåˆ«ã€‚å¦‚æœæ˜¯â€œç±»åŒ–â€çš„è¯ï¼Œä¹Ÿæ˜¯æ²¡ä»€ä¹ˆåŒºåˆ«å—ï¼Ÿåœ¨ä½¿ç”¨ class å£°æ˜ä¸€ä¸ªç±»æ—¶ï¼Œnew class ä¸ class ç›´æ¥è°ƒç”¨ã€‚<br><br><br>å‡½æ•°æ˜¯å¯¹è±¡çš„æ¦‚å¿µæ¯”è¾ƒæ¸…æ™°ï¼Œæ˜äº†ã€‚è¿™è®©æˆ‘æƒ³èµ·ä¹‹å‰çš„ &quot;null&quot;ï¼Œè¯·æ•™ä¸ªé—®é¢˜ï¼Œåœ¨é€šå¸¸çš„å¼€å‘ä¸­ï¼Œä¼šæŠŠä¸€äº›å˜é‡é‡Šæ”¾ç©ºé—´ï¼ŒæŠŠå€¼ç½®ä¸º null, é‚£ä¹ˆå¦‚æœæ˜¯ç½®ä¸º {} å‘¢ï¼Ÿå¦‚ä¸‹ï¼š<br><br><br>var a = null å’Œ var a = {}ï¼Œæ˜¯å¦æœ‰å¤§å·®å¼‚ï¼Ÿ<br><br><br>æˆ‘çš„ç†è§£æ˜¯ {} ä¼šå­˜æ”¾åœ¨â€œå †ç©ºé—´â€å æ®å†…å­˜ï¼Œä½†åŒæ—¶å®ƒæ˜¯ä¸€ä¸ªç©ºå¯¹è±¡ï¼Œnull ä¹Ÿæ˜¯ä¸€ä¸ªä»€ä¹ˆéƒ½æ²¡æœ‰çš„ç©ºå¯¹è±¡ï¼Œä½† null ä¹Ÿæ˜¯å…¶å®ƒå¯¹è±¡çš„åŸå‹ï¼Œæ‰€ä»¥ä¹Ÿä¼šæœ‰ Object.create(null)<br><br><br>ä¸çŸ¥é“å‘¨å¤§èƒ½å¦çœ‹æ‡‚æˆ‘çš„é€»è¾‘ï¼Ÿ<br><br>æ„Ÿè°¢<br>","like_count":4,"discussions":[{"author":{"id":1521669,"avatar":"https://static001.geekbang.org/account/avatar/00/17/38/05/7beecd5d.jpg","nickname":"Aiming","note":"","ucode":"66292B32F9960A","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":480126,"discussion_content":"Oh. è¿™ä¸ª\n&amp;gt; new Function(x)  vs  Function(x) æ²¡ä»€ä¹ˆåŒºåˆ«\n\nå¹¶ä¸ç®—æ˜¯å¾ˆç‰¹åˆ«çš„ç‰¹ä¾‹ã€‚ä½ åº”è¯¥è®°å¾—new AClass()çš„æ—¶å€™ï¼Œå…è®¸â€œç”¨æˆ·ä»£ç ç›´æ¥è¿”å›å¯¹è±¡ï¼Œè€Œä¸æ˜¯ç›´æ¥ä½¿ç”¨thisâ€\nè¿™ä¸ªç‰¹æ€§å¯¹å§ï¼Œå…¶å®è¿™å°±æ˜¯è¿™ä¸ªç‰¹æ€§çš„åº”ç”¨ã€‚å› ä¸ºå½“ç”¨æˆ·ä»£ç è¿”å›è‡ªå·±åˆ›å»ºçš„å¯¹è±¡æ˜¯ï¼Œç”¨ä¸ç”¨newï¼Œæ•ˆæœéƒ½æ˜¯ä¸€æ ·çš„äº†ã€‚â€”â€”æ‰€ä»¥ï¼Œè¿™é‡Œçš„æ„æ€æ˜¯è¯´ï¼ŒFunction()åœ¨å®ç°æ—¶ä¹Ÿæ˜¯è‡ªå·±è¿”å›äº†å¯¹è±¡ï¼Œè€Œæ²¡æœ‰ä½¿ç”¨ç¼ºçœnewç»™ä»–åˆ›å»ºçš„thisã€‚\n\nç†è®ºä¸Šï¼Œè¿™å¯¹ç±»åŒ–æ¥è¯´ä¹Ÿæ˜¯é€‚ç”¨çš„ã€‚å› ä¸ºç±»åŒ–ä¹Ÿå…è®¸ç”¨æˆ·ä»£ç è¿”å›å¯¹è±¡æ¥æ›¿ä»£thisã€‚ä½†æ˜¯â€”â€”å‘µå‘µï¼Œå¦‚æœä½ ç”¨â€œclass X...â€æ¥å£°æ˜ç±»ï¼Œé‚£ä¹ˆè¿™ä¸ªXæ˜¯åªèƒ½ç”¨newæ¥è°ƒç”¨çš„ï¼Œè€Œä¸èƒ½ç›´æ¥å½“åšå‡½æ•°è°ƒç”¨ã€‚\n```\n&amp;gt; X()\nTypeError: Class constructor X cannot be invoked without &amp;#39;new&amp;#39;\n```\n\nå…³äºnullå€¼å’Œ{}ã€‚å…¶å®nullå€¼æ˜¯ä¸€ä¸ªç‰¹æ®Šæ€§ï¼Œå®ƒæ˜¯çœŸçš„â€œä»€ä¹ˆä¹Ÿæ²¡æœ‰â€ï¼Œä½ ç”šè‡³å¯ä»¥å°†å®ƒç†è§£ä¸ºCé‡Œé¢çš„#0ã€‚è€Œå®ƒæ˜¯å¯¹è±¡ï¼ˆtypeof nullï¼‰ï¼Œä»¥åŠå®ƒèƒ½ä½œä¸ºå…¶å®ƒå¯¹è±¡æˆ–ç±»çš„åŸå‹ï¼Œåªæ˜¯ä¸€ä¸ªè¯­è¨€è®¾è®¡ï¼Œè€Œä¸å®ƒçš„å†…å­˜å ç”¨æ²¡æœ‰å…³ç³»ã€‚ä½ å¯ä»¥è¿™æ ·ç†è§£ï¼Œæ²¡é—®é¢˜ã€‚â€”â€”å¦å¤–ï¼Œåœ¨ECMAScriptä¸­ï¼Œnullæ˜¯ä¸€ä¸ªåŸå§‹å€¼ï¼ˆPrimitive valueï¼‰ï¼Œè¿™æ„å‘³ç€å®ƒå¯ä»¥ç›´æ¥åœ¨å¼•æ“ä¸­è¡¨è¾¾ä¸ºäºŒè¿›åˆ¶çš„å­˜å‚¨ï¼ŒçœŸçš„è·Ÿ#0å¾ˆæ¥è¿‘äº†ã€‚^^.\n\nè€Œ{}æ˜¯ä¸€ä¸ªå¯¹è±¡ï¼Œå®ƒåœ¨å¼•æ“ä¸­è¡¨è¾¾ä¸ºä¸€ä¸ªç»“æ„ã€ä¸€ä¸ªæ•°æ®å—ï¼ˆä¹Ÿå°±æ˜¯ä½ è®¤ä¸ºçš„æ”¾åœ¨å †é‡Œï¼Œå…¶å®æ˜¯ä¸æ˜¯æ”¾åœ¨å †é‡Œä¸é‡è¦ï¼Œè€Œä¸”ä¹Ÿå¹¶ä¸ç¡®å®šï¼‰ã€‚å¯¹è±¡ä¹‹æ‰€ä»¥ä¸ºç©ºç™½ï¼ˆâ€œ{}â€ç§°ä¸ºç©ºç™½å¯¹è±¡Empty objectsï¼‰ï¼Œæ˜¯å› ä¸ºå®ƒçš„è‡ªæœ‰å±æ€§è¡¨ä¸ºç©ºï¼Œå½“è‡ªæœ‰å±æ€§è¡¨é‡Œé¢æ²¡æœ‰å±æ€§é¡¹çš„æ—¶å€™ï¼Œå®ƒå°±æ˜¯ç©ºç™½çš„äº†ã€‚â€”â€”ä½ å¯ä»¥é‡ç½®å®ƒçš„åŸå‹ï¼Œè®©ä»–è¡¨ç°å¾—æœ‰ä¸€äº›å±æ€§ä»€ä¹ˆçš„ã€‚å› ä¸ºå®ƒæ¯•ç«Ÿè¿˜æ˜¯ä¸€ä¸ªå¯æ“ä½œçš„ã€å æœ‰å¼•æ“ä¸­çš„å­˜å‚¨çš„çœŸå®å¯¹è±¡ã€‚\n\nå¦å¤–ï¼ŒECMAScriptå†…éƒ¨ï¼ˆä»¥åŠå¼•æ“å†…éƒ¨çš„æ‰§è¡Œé€»è¾‘ä¸­ï¼‰å…¶å®æ˜¯æŠŠnullå€¼ç†è§£ä¸ºâ€œå€¼â€çš„ï¼Œè€Œä¸æ˜¯â€œå¯¹è±¡â€ã€‚æ‰€ä»¥ECMAScriptçš„å†…éƒ¨æ–¹æ³•IsObject(null)ï¼Œæ˜¯è¿”å›falseçš„ã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1578020079,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1039504,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/dc/90/c980113a.jpg","nickname":"è¡Œé—®","note":"","ucode":"F3AED699218475","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":115663,"discussion_content":"æ¸…æ™°ã€ç†è§£ã€æ˜äº†ï¼Œæ„Ÿè°¢","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1578026906,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":168077,"user_name":"æ™“å°ä¸œ","can_delete":false,"product_type":"c1","uid":1194643,"ip_address":"","ucode":"93F9462EAAA63C","user_header":"https://static001.geekbang.org/account/avatar/00/12/3a/93/d7be8a1a.jpg","comment_is_top":false,"comment_ctime":1578011474,"is_pvip":true,"replies":[{"id":"65295","content":"ğŸ˜€+ğŸ¤","user_name":"ä½œè€…å›å¤","user_name_real":"Aiming","uid":"1521669","ctime":1578021979,"ip_address":"","comment_id":168077,"utype":1}],"discussion_count":1,"race_medal":0,"score":"10167946066","product_id":100039701,"comment_content":"å¥½å¿«ï¼Œè¿™ä¸ªä¸“æ ç»“æŸäº†ï¼Œæœ‰ç‚¹èˆä¸å¾—ï¼Œä¸€ä¸ªå¤šæœˆæ¥æˆ‘ä¸€ç›´å…³æ³¨è€å¸ˆæ›´æ–°ï¼Œåå¤é˜…å¬ä¹‹å‰ç« èŠ‚ã€‚ä½“ä¼šæ·±æ€ç†è§£ï¼Œå‘ç°å¦‚æœæ²¡æœ‰è€å¸ˆå¸¦é¢†å±‚å±‚åˆ†æJavaScript æœ€æ ¸å¿ƒé‚£éƒ¨åˆ†è®¾è®¡å’Œæ¦‚å¿µï¼ŒçœŸçš„æ— ç¼˜äº†è§£è¿™é—¨è¯­è¨€äº†ï¼Œè°¢è°¢è€å¸ˆç»™æˆ‘ä»¬æ€ç»´ä¸Šçš„æå‡ï¼ŒåŒæ—¶ä¹Ÿå‘ç°è‡ªå·±å¯¹è¿™é—¨è¯­è¨€çš„ç†è§£ä¸Šï¼Œä¸Šäº†ä¸€ä¸ªå¤§å¤§çš„å°é˜¶ã€‚åœ¨æ­¤ç”±è¡·çš„æ„Ÿè°¢ï¼ŒçœŸçš„æ„Ÿè§‰ï¼Œé‡åˆ°äº†æ©å¸ˆã€‚","like_count":2,"discussions":[{"author":{"id":1521669,"avatar":"https://static001.geekbang.org/account/avatar/00/17/38/05/7beecd5d.jpg","nickname":"Aiming","note":"","ucode":"66292B32F9960A","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":480128,"discussion_content":"ğŸ˜€+ğŸ¤","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1578021979,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":168932,"user_name":"weineel","can_delete":false,"product_type":"c1","uid":1049741,"ip_address":"","ucode":"6DC6EF4F256A53","user_header":"https://static001.geekbang.org/account/avatar/00/10/04/8d/005c2ff3.jpg","comment_is_top":false,"comment_ctime":1578219566,"is_pvip":true,"replies":[{"id":"65578","content":"è¿™ä¸ªå¯ä»¥æœ‰ã€‚æˆ‘è€ƒè™‘ä¸€ä¸‹æ€ä¹ˆåšåˆ°ä¸‹ä¸€ä¸ªè¯¾ç¨‹å§ã€‚è¿™ä¸€è¯¾ç»“æŸå“’æ‰€ä»¥ä¹Ÿä¸å†æœ‰åŠ é¤å“’ã€‚^^.","user_name":"ä½œè€…å›å¤","user_name_real":"Aiming","uid":"1521669","ctime":1578277473,"ip_address":"","comment_id":168932,"utype":1}],"discussion_count":1,"race_medal":2,"score":"5873186862","product_id":100039701,"comment_content":"è€å¸ˆçš„æ¯ä¸€ç¯‡éƒ½å¾ˆæœ‰æ·±åº¦ã€‚æˆ‘ä»¬å¹³æ—¶å¼€å‘ä¸­ï¼Œthis çš„åŠ¨æ€ç»‘å®šè™½ç„¶å¾ˆå¤æ‚ï¼Œä½†æ—¶é—´é•¿äº†ä¹Ÿèƒ½æ‰¾åˆ°è§„å¾‹ï¼Œä»…ä»…æ˜¯åº”ç”¨è¿˜æ˜¯æ²¡å•¥é—®é¢˜çš„ã€‚è€å¸ˆè¦æ˜¯æœ‰æ—¶é—´ç»™æˆ‘ä»¬åŠ ä¸ªé¤ï¼ŒèŠèŠ this çš„æ·±å±‚åŸç†å§ã€‚","like_count":1,"discussions":[{"author":{"id":1521669,"avatar":"https://static001.geekbang.org/account/avatar/00/17/38/05/7beecd5d.jpg","nickname":"Aiming","note":"","ucode":"66292B32F9960A","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":480380,"discussion_content":"è¿™ä¸ªå¯ä»¥æœ‰ã€‚æˆ‘è€ƒè™‘ä¸€ä¸‹æ€ä¹ˆåšåˆ°ä¸‹ä¸€ä¸ªè¯¾ç¨‹å§ã€‚è¿™ä¸€è¯¾ç»“æŸå“’æ‰€ä»¥ä¹Ÿä¸å†æœ‰åŠ é¤å“’ã€‚^^.","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1578277473,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":286338,"user_name":"å¤§é›„ä¸çˆ±åƒè‚‰","can_delete":false,"product_type":"c1","uid":1008475,"ip_address":"","ucode":"EFC131ECA99CA8","user_header":"https://static001.geekbang.org/account/avatar/00/0f/63/5b/a23a82a4.jpg","comment_is_top":false,"comment_ctime":1617261477,"is_pvip":false,"replies":[{"id":"104027","content":"å¤šè°¢å¤šè°¢ã€‚æœ‰æ”¶è·å°±å¥½ã€‚:)","user_name":"ä½œè€…å›å¤","user_name_real":"Aiming","uid":"1521669","ctime":1617295496,"ip_address":"","comment_id":286338,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1617261477","product_id":100039701,"comment_content":"ä¸“æ è™½ç„¶æ˜¯äºŒåå¤šè®²ï¼Œä½†æ˜¯è‡ªå·±çœ‹äº†å¾ˆä¹…ï¼Œå¾ˆå¤šåœ°æ–¹åå¤çœ‹åå¤è¯•ã€‚å¯èƒ½æœ€ç»ˆè®°ä½çš„ä¸æ˜¯å¾ˆå¤šï¼Œä½†å¯¹jsä»¥åŠè¯­è¨€è§„èŒƒæœ‰äº†æ·±åˆ»çš„ç†è§£ï¼Œæ„Ÿè°¢è€å¸ˆè¿™é—¨è¯¾ï¼Œè¿™ä¸€é—¨ç‹¬ç‰¹çš„è¯¾ç¨‹æˆ‘æ”¶è·é¢‡å¤šï¼ŒæœŸå¾…è€å¸ˆçš„ä¸‹ä¸€é—¨è¯¾ï¼","like_count":0,"discussions":[{"author":{"id":1521669,"avatar":"https://static001.geekbang.org/account/avatar/00/17/38/05/7beecd5d.jpg","nickname":"Aiming","note":"","ucode":"66292B32F9960A","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":517952,"discussion_content":"å¤šè°¢å¤šè°¢ã€‚æœ‰æ”¶è·å°±å¥½ã€‚:)","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1617295496,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":226471,"user_name":"igetter","can_delete":false,"product_type":"c1","uid":1623203,"ip_address":"","ucode":"2CF0EC4653CE4B","user_header":"http://thirdwx.qlogo.cn/mmopen/vi_32/DYAIOgq83eqOtThoyf1GUazm9fn7jTFJiaf7yZwh9unGgLSsIJ2Op20wIpJHDw5ZxeCGf3ibZKdZ2K3ibCR1n71Hg/132","comment_is_top":false,"comment_ctime":1592114925,"is_pvip":false,"replies":[{"id":"83670","content":"æ˜¯çš„ã€‚<br><br>Function(x)å·¥ä½œåœ¨å…¨å±€ï¼Œæ‰€ä»¥å®ƒçš„ä½œç”¨åŸŸå±‚æ¬¡é€šå¸¸è¦å°äºeval(x)ã€‚å› ä¸ºä½œç”¨åŸŸï¼ˆé“¾ï¼‰çš„æ·±åº¦å°ï¼Œæ‰€ä»¥Function()æ‰§è¡Œè¦ç•¥é«˜æ•ˆã€‚<br><br>å¦‚æœåªæ˜¯è¯´å¯¹ä»£ç æ–‡æœ¬`x`çš„è§£æå’Œå¤„ç†ç­‰ï¼Œä¸¤è€…å¹¶æ²¡æœ‰æ˜æ˜¾çš„æ€§èƒ½åŒºåˆ«ã€‚","user_name":"ä½œè€…å›å¤","user_name_real":"Aiming","uid":"1521669","ctime":1592298230,"ip_address":"","comment_id":226471,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1592114925","product_id":100039701,"comment_content":"è€å¸ˆï¼Œé—®ä¸€ä¸ªä¸å¤ªç›¸å…³çš„é—®é¢˜: MDNä¸­è¯´ï¼ŒFunction()æ¯”eval()æ›´é«˜æ•ˆã€‚è¿™æ˜¯çœŸçš„å—ï¼Ÿ","like_count":0,"discussions":[{"author":{"id":1521669,"avatar":"https://static001.geekbang.org/account/avatar/00/17/38/05/7beecd5d.jpg","nickname":"Aiming","note":"","ucode":"66292B32F9960A","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":498254,"discussion_content":"æ˜¯çš„ã€‚\n\nFunction(x)å·¥ä½œåœ¨å…¨å±€ï¼Œæ‰€ä»¥å®ƒçš„ä½œç”¨åŸŸå±‚æ¬¡é€šå¸¸è¦å°äºeval(x)ã€‚å› ä¸ºä½œç”¨åŸŸï¼ˆé“¾ï¼‰çš„æ·±åº¦å°ï¼Œæ‰€ä»¥Function()æ‰§è¡Œè¦ç•¥é«˜æ•ˆã€‚\n\nå¦‚æœåªæ˜¯è¯´å¯¹ä»£ç æ–‡æœ¬`x`çš„è§£æå’Œå¤„ç†ç­‰ï¼Œä¸¤è€…å¹¶æ²¡æœ‰æ˜æ˜¾çš„æ€§èƒ½åŒºåˆ«ã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1592298230,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":213518,"user_name":"K4SHIFZ","can_delete":false,"product_type":"c1","uid":1293057,"ip_address":"","ucode":"BFB49AAC0E4C74","user_header":"https://static001.geekbang.org/account/avatar/00/13/bb/01/568ac2d6.jpg","comment_is_top":false,"comment_ctime":1588440334,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1588440334","product_id":100039701,"comment_content":"åŠ¨æ€å‡½æ•°åˆ›å»ºåœ¨è§„èŒƒ19.2.1.1.1<br>Let proto be ? GetPrototypeFromConstructor(newTarget, fallbackProto).<br>Let realmF be the current Realm Record.<br>Let scope be realmF.[[GlobalEnv]].<br>Let F be ! OrdinaryFunctionCreate(proto, sourceText, parameters, body, non-lexical-this, scope).<br>Perform SetFunctionName(F, &quot;anonymous&quot;)","like_count":0},{"had_liked":false,"id":175964,"user_name":"James","can_delete":false,"product_type":"c1","uid":1513489,"ip_address":"","ucode":"953966DEFE4461","user_header":"https://static001.geekbang.org/account/avatar/00/17/18/11/f1f37801.jpg","comment_is_top":false,"comment_ctime":1580893908,"is_pvip":false,"replies":[{"id":"68422","content":"è¡¥ä¸€äº›åŸºç¡€ï¼Œå†çœ‹ã€‚å»ºè®®è¾¹è¯»ECMAScriptè¾¹çœ‹ã€‚åŠ é¤é‡Œé¢æˆ‘æœ‰ç»™åœ°å€ï½æ‰¾æ‰¾å“‡ğŸ˜€","user_name":"ä½œè€…å›å¤","user_name_real":"Aiming","uid":"1521669","ctime":1580917351,"ip_address":"","comment_id":175964,"utype":1}],"discussion_count":2,"race_medal":0,"score":"1580893908","product_id":100039701,"comment_content":"è€å¸ˆï¼Œæˆ‘ä»å¤´å¬äº†ä¸€éï¼Œæœ‰å‡ ç¯‡æ–‡ç« å¬äº†å¥½å‡ éï¼Œä½†æ˜¯æ„Ÿè§‰å®Œå…¨æ˜¯äº‘é‡Œé›¾é‡Œï¼Œæ²¡å¼„æ‡‚ã€‚æˆ‘åº”è¯¥æ€ä¹ˆåŠã€‚ğŸ¤£","like_count":0,"discussions":[{"author":{"id":1521669,"avatar":"https://static001.geekbang.org/account/avatar/00/17/38/05/7beecd5d.jpg","nickname":"Aiming","note":"","ucode":"66292B32F9960A","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":482975,"discussion_content":"è¡¥ä¸€äº›åŸºç¡€ï¼Œå†çœ‹ã€‚å»ºè®®è¾¹è¯»ECMAScriptè¾¹çœ‹ã€‚åŠ é¤é‡Œé¢æˆ‘æœ‰ç»™åœ°å€ï½æ‰¾æ‰¾å“‡ğŸ˜€","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1580917351,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1513489,"avatar":"https://static001.geekbang.org/account/avatar/00/17/18/11/f1f37801.jpg","nickname":"James","note":"","ucode":"953966DEFE4461","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":199922,"discussion_content":"çœ‹äº†5éäº†ï¼Œæ¯ä¸€ééƒ½æœ‰å¾ˆå¤§çš„æ”¶è·ã€‚å‡†å¤‡å†ç»§ç»­ä¸€éä¸€éçš„çœ‹ã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1583637927,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":168639,"user_name":"è®¸ç«¥ç«¥","can_delete":false,"product_type":"c1","uid":1003005,"ip_address":"","ucode":"4B799C0C6BC678","user_header":"https://static001.geekbang.org/account/avatar/00/0f/4d/fd/0aa0e39f.jpg","comment_is_top":false,"comment_ctime":1578129217,"is_pvip":false,"replies":[{"id":"65445","content":"èƒ½å¯¹å¤§å®¶æœ‰ç”¨å°±å¥½ã€‚æˆ‘ä¸€ç›´ä»¥è¿™æ ·çš„æ€åº¦æ¥åšè¿™ä»¶äº‹ï¼Œé‚£æ€•èƒ½å¸®åŠ©ä¸€äººï¼Œä¹Ÿæ˜¯å¥½çš„ã€‚å¤šè°¢ä½ çš„æ”¯æŒã€‚^^.","user_name":"ä½œè€…å›å¤","user_name_real":"Aiming","uid":"1521669","ctime":1578196975,"ip_address":"","comment_id":168639,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1578129217","product_id":100039701,"comment_content":"ä¸€è·¯è·Ÿç€è€å¸ˆèµ°è¿‡æ¥ï¼Œè‡ªä»¥ä¸ºå¯¹JavaScriptè¿™é—¨è¯­è¨€æœ‰ä¸€å®šçš„äº†è§£ï¼Œæ‰å‘ç°åªæ˜¯æ‡‚ç‚¹çš®æ¯›ï¼Œæ›´å¤šæ·±å…¥çš„çŸ¥è¯†è‡ªå·±éƒ½è¿˜æ²¡æœ‰æ¢ç©¶åˆ°ï¼Œæ„Ÿè°¢è€å¸ˆå¸¦æˆ‘é¢†ä¼šäº†æ›´æ·±åˆ»çš„JavaScriptã€‚ä¹‹åè¿˜æ˜¯ä¼šæŒç»­å­¦ä¹ ï¼Œä¿æŒå¯¹JavaScriptçš„æ•¬ç•ä¹‹å¿ƒï¼ŒåŠ æ²¹ã€‚","like_count":0,"discussions":[{"author":{"id":1521669,"avatar":"https://static001.geekbang.org/account/avatar/00/17/38/05/7beecd5d.jpg","nickname":"Aiming","note":"","ucode":"66292B32F9960A","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":480278,"discussion_content":"èƒ½å¯¹å¤§å®¶æœ‰ç”¨å°±å¥½ã€‚æˆ‘ä¸€ç›´ä»¥è¿™æ ·çš„æ€åº¦æ¥åšè¿™ä»¶äº‹ï¼Œé‚£æ€•èƒ½å¸®åŠ©ä¸€äººï¼Œä¹Ÿæ˜¯å¥½çš„ã€‚å¤šè°¢ä½ çš„æ”¯æŒã€‚^^.","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1578196975,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":168291,"user_name":"ç‹¬é’“å¯’æ±Ÿé›ª","can_delete":false,"product_type":"c1","uid":1625419,"ip_address":"","ucode":"76278A3EBCE0B8","user_header":"https://static001.geekbang.org/account/avatar/00/18/cd/4b/36396a18.jpg","comment_is_top":false,"comment_ctime":1578042120,"is_pvip":true,"replies":[{"id":"65448","content":"ä»”ç»†è¯»äº†å‡ éä½ çš„é—®é¢˜ï¼Œæˆ‘è§‰å¾—è¿™æ˜¯ä¸å¯èƒ½å‡ºç°çš„ã€‚ä½†è¿˜æ˜¯å°å¿ƒåœ°å†™äº†ä¸€ä¸ªæµ‹è¯•æ¥è¿è¡Œäº†ä¸€ä¸‹ï¼Œä½†æ˜¯è¿˜åŸä¸äº†ä½ è¯´çš„é—®é¢˜ã€‚ï¼ˆä»£ç æ”¾åœ¨åé¢ï¼Œä½ çœ‹çœ‹æ˜¯ä¸æ˜¯è¿™ä¸ªæ„æ€ï¼‰<br><br>æˆ‘ä»”ç»†æƒ³äº†ä¸€ä¸‹ï¼Œéå¸¸å¯ç–‘çš„äº‹æƒ…å‡ºæ¥ä½ ä½¿ç”¨import&#47;exportçš„æ–¹æ³•ä¸Šé¢ã€‚ç”±äºNodeJSåœ¨ä¸€èˆ¬æ¨¡å¼ä¸‹å¹¶ä¸æ”¯æŒES Moduleï¼Œå› æ­¤é€šå¸¸æˆ‘ä»¬åœ¨åº”ç”¨ç¯å¢ƒä¸­ä½¿ç”¨æ¨¡å—çš„æ—¶å€™ï¼Œéƒ½æ˜¯ç”¨babelæ¥è½¬ç çš„ã€‚è€Œæ—©æœŸbabelï¼ˆä¹ŸåŒ…æ‹¬å…¶å®ƒçš„ä¸€äº›ç¬¬ä¸‰æ–¹è½¬ç å™¨ï¼‰å¯èƒ½å¯¹æŸäº›è¯­æ³•æ”¯æŒå¾—ä¸å¥½ï¼Œæ‰€ä»¥è½¬å‡ºæ¥çš„ç»“æœè·ŸECMAScriptè§„èŒƒå¹¶ä¸ä¸€è‡´ï¼Œåšä¸åˆ°ç™¾åˆ†ç™¾åœ°å…¼å®¹ã€‚å¹¶ä¸”ï¼Œåœ¨ä½ çš„ç¤ºä¾‹ä¸­è¿˜æœ‰ä¸€ä¸ªç®­å¤´å‡½æ•°ï¼Œè¿™ä¸ªä¸œè¥¿åœ¨å¾ˆå¤šè½¬ç å™¨å’ŒåŸºäºè½¬ç å™¨çš„runtimeä¸­è¿˜æ˜¯å®ç°å¾—ä¸å¥½çš„ã€‚<br><br>æ‰€ä»¥ç®€å•åœ°è¯´ï¼Œæˆ‘æ€€ç–‘æ˜¯ä½ åœ¨åº”ç”¨ç¯å¢ƒä¸­ä½¿ç”¨babelæˆ–typescriptä¹‹ç±»çš„è½¬ç å™¨å¸¦æ¥çš„ç»“æœã€‚æ— è®ºå¦‚ä½•ï¼ŒECMAScriptçš„è§„èŒƒä¸­ä¸ä¼šæœ‰è¿™ä¸ªé—®é¢˜ã€‚å¦‚ä¸‹ä¾‹ï¼š<br><br>```<br># è¿è¡Œ<br>&gt; node --experimental-modules t1.mjs<br><br><br>&#47;&#47; ä»£ç t1.mjs<br>import { generateRemark } from &#39;.&#47;t2.mjs&#39;;<br><br>var skus = &#39;&#39;;<br>console.log(generateRemark(skus, &#39;&#39;));<br><br><br>&#47;&#47; ä»£ç t2.mjs<br>import { message } from &#39;.&#47;t3.mjs&#39;<br><br>export const generateRemark = (skus, message) =&gt; {<br>  let remark = &#39;&#39;<br>  &#47;&#47; ......<br>  console.log(typeof message, message);<br><br>  remark = remark + (message || &#39;&#39;)<br>  return remark<br>}<br><br>&#47;&#47; ä»£ç t3.mjs<br>export var message = {};<br>```","user_name":"ä½œè€…å›å¤","user_name_real":"Aiming","uid":"1521669","ctime":1578197841,"ip_address":"","comment_id":168291,"utype":1}],"discussion_count":2,"race_medal":0,"score":"1578042120","product_id":100039701,"comment_content":"ä»¥å‰æœ‰ç¢°åˆ°äº†è¿™æ ·ä¸€ä¸ªç–‘æƒ‘ï¼Œçœ‹äº†ä¸“æ å‰é¢çš„å†…å®¹ï¼Œè¿˜æ˜¯ä¸å¤ªæ˜ç™½ã€‚ä¸‹é¢æ˜¯æˆ‘çš„ä»£ç ï¼Œè™½ç„¶é—®é¢˜æ¯”è¾ƒå¥½è§£å†³ï¼Œä½†æ˜¯ä¸å¤ªæ˜ç™½ï¼š<br>import { message } from &#39;antd&#39; &#47;&#47; å¼•å…¥AntDç»„ä»¶åº“ä¸­çš„message<br>export const generateRemark = (skus, message) =&gt; {&#47;&#47; è¿™ä¸ªæ–¹æ³•è¢«å¯¼å‡ºï¼Œæ¥æ”¶ä¸¤ä¸ªå‚æ•°ï¼Œå…¶ä¸­ä¸€ä¸ªå†™æˆäº†message<br>  let remark = &#39;&#39;<br>  ......<br>  remark = remark + (message || &#39;&#39;)&#47;&#47;  ä½¿ç”¨äº†messageå‚æ•°<br>  return remark<br>}<br>å½“æˆ‘è°ƒç”¨generateRemark(skus, &#39;&#39;)æ—¶ï¼ˆmessageä¼ å…¥çš„æ˜¯ç©ºå­—ç¬¦ä¸²ï¼‰ï¼Œè¿”å›æ˜¯[object Object],è°ƒè¯•å‘ç°ï¼ŒåŸæ¥messageè¢«è§£ææˆäº†antdçš„messageç»„ä»¶äº†ã€‚<br><br>æ˜¯ä»£ç ç¯å¢ƒçš„é—®é¢˜è¿˜æ˜¯JSåº•å±‚æœºåˆ¶çš„é—®é¢˜å‘¢ï¼Ÿå¸Œæœ›è€å¸ˆèƒ½å¸®æˆ‘è§£æƒ‘ï¼Œè°¢è°¢ğŸ™<br><br>æœ€åï¼Œä¹Ÿæ„Ÿè°¢è€å¸ˆçš„ä¸“æ ï¼Œè¿™æ ·å…³æ³¨åº•å±‚æ ¸å¿ƒåŸç†çš„ä¸“æ ï¼Œæ­£æ˜¯æˆ‘è¿™ç§è‡ªå­¦å‰ç«¯å‡ºé“çš„åŒå­¦çš„æ‰€éœ€è¦çš„ã€‚","like_count":0,"discussions":[{"author":{"id":1521669,"avatar":"https://static001.geekbang.org/account/avatar/00/17/38/05/7beecd5d.jpg","nickname":"Aiming","note":"","ucode":"66292B32F9960A","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":480181,"discussion_content":"ä»”ç»†è¯»äº†å‡ éä½ çš„é—®é¢˜ï¼Œæˆ‘è§‰å¾—è¿™æ˜¯ä¸å¯èƒ½å‡ºç°çš„ã€‚ä½†è¿˜æ˜¯å°å¿ƒåœ°å†™äº†ä¸€ä¸ªæµ‹è¯•æ¥è¿è¡Œäº†ä¸€ä¸‹ï¼Œä½†æ˜¯è¿˜åŸä¸äº†ä½ è¯´çš„é—®é¢˜ã€‚ï¼ˆä»£ç æ”¾åœ¨åé¢ï¼Œä½ çœ‹çœ‹æ˜¯ä¸æ˜¯è¿™ä¸ªæ„æ€ï¼‰\n\næˆ‘ä»”ç»†æƒ³äº†ä¸€ä¸‹ï¼Œéå¸¸å¯ç–‘çš„äº‹æƒ…å‡ºæ¥ä½ ä½¿ç”¨import/exportçš„æ–¹æ³•ä¸Šé¢ã€‚ç”±äºNodeJSåœ¨ä¸€èˆ¬æ¨¡å¼ä¸‹å¹¶ä¸æ”¯æŒES Moduleï¼Œå› æ­¤é€šå¸¸æˆ‘ä»¬åœ¨åº”ç”¨ç¯å¢ƒä¸­ä½¿ç”¨æ¨¡å—çš„æ—¶å€™ï¼Œéƒ½æ˜¯ç”¨babelæ¥è½¬ç çš„ã€‚è€Œæ—©æœŸbabelï¼ˆä¹ŸåŒ…æ‹¬å…¶å®ƒçš„ä¸€äº›ç¬¬ä¸‰æ–¹è½¬ç å™¨ï¼‰å¯èƒ½å¯¹æŸäº›è¯­æ³•æ”¯æŒå¾—ä¸å¥½ï¼Œæ‰€ä»¥è½¬å‡ºæ¥çš„ç»“æœè·ŸECMAScriptè§„èŒƒå¹¶ä¸ä¸€è‡´ï¼Œåšä¸åˆ°ç™¾åˆ†ç™¾åœ°å…¼å®¹ã€‚å¹¶ä¸”ï¼Œåœ¨ä½ çš„ç¤ºä¾‹ä¸­è¿˜æœ‰ä¸€ä¸ªç®­å¤´å‡½æ•°ï¼Œè¿™ä¸ªä¸œè¥¿åœ¨å¾ˆå¤šè½¬ç å™¨å’ŒåŸºäºè½¬ç å™¨çš„runtimeä¸­è¿˜æ˜¯å®ç°å¾—ä¸å¥½çš„ã€‚\n\næ‰€ä»¥ç®€å•åœ°è¯´ï¼Œæˆ‘æ€€ç–‘æ˜¯ä½ åœ¨åº”ç”¨ç¯å¢ƒä¸­ä½¿ç”¨babelæˆ–typescriptä¹‹ç±»çš„è½¬ç å™¨å¸¦æ¥çš„ç»“æœã€‚æ— è®ºå¦‚ä½•ï¼ŒECMAScriptçš„è§„èŒƒä¸­ä¸ä¼šæœ‰è¿™ä¸ªé—®é¢˜ã€‚å¦‚ä¸‹ä¾‹ï¼š\n\n```\n# è¿è¡Œ\n&amp;gt; node --experimental-modules t1.mjs\n\n\n// ä»£ç t1.mjs\nimport { generateRemark } from &amp;#39;./t2.mjs&amp;#39;;\n\nvar skus = &amp;#39;&amp;#39;;\nconsole.log(generateRemark(skus, &amp;#39;&amp;#39;));\n\n\n// ä»£ç t2.mjs\nimport { message } from &amp;#39;./t3.mjs&amp;#39;\n\nexport const generateRemark = (skus, message) =&amp;gt; {\n  let remark = &amp;#39;&amp;#39;\n  // ......\n  console.log(typeof message, message);\n\n  remark = remark + (message || &amp;#39;&amp;#39;)\n  return remark\n}\n\n// ä»£ç t3.mjs\nexport var message = {};\n```","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1578197841,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1625419,"avatar":"https://static001.geekbang.org/account/avatar/00/18/cd/4b/36396a18.jpg","nickname":"ç‹¬é’“å¯’æ±Ÿé›ª","note":"","ucode":"76278A3EBCE0B8","race_medal":0,"user_type":1,"is_pvip":true},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":120494,"discussion_content":"è°¢è°¢è€å¸ˆçš„è€å¿ƒå›å¤ï¼Œæˆ‘ä¹Ÿæœ‰æ€€ç–‘è¿‡æ˜¯ä¸æ˜¯babelçš„é—®é¢˜ã€‚\n\nantdæ˜¯é€šè¿‡defaultå¯¼å‡ºç»„ä»¶çš„ï¼Œæ˜¯å¦æ˜¯å› ä¸ºåœ¨ç¼–è¯‘é˜¶æ®µï¼Œimportè¯­æ³•å¼•å…¥çš„messageç»„ä»¶åœ¨å‡½æ•°ä¸­å°±å·²ç»è¢«æ›¿æ¢äº†å‘¢ï¼Ÿå› ä¸ºæ–­ç‚¹è°ƒè¯•å‘ç°message.errorå·²ç»è¢«æ›¿æ¢æˆäº†__WEBPACK_IMPORTED_MODULE_1_antd_lib_message___default.a.error\n\nä½†æ˜¯æ— è®ºåœ¨message.errorå‰é¢è¿˜æ˜¯åé¢æ‰“å°messageï¼Œæ‰“å°çš„éƒ½æ˜¯å®é™…ä¼ é€’è¿‡æ¥çš„messageï¼›å°±ç®—æˆ‘ä¼ é€’è¿‡æ¥çš„messageä¸­æœ‰errorå‚æ•°ï¼Œmessage.errorè¿˜æ˜¯ä¼šè°ƒç”¨messageç»„ä»¶ä¸­çš„errorï¼ˆconsole.log(__WEBPACK_IMPORTED_MODULE_1_antd_lib_message___default.a.error);ï¼‰ğŸ˜‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1578278034,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]}]}