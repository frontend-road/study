{"id":9373,"title":"ç¬¬19è®² | Javaå¹¶å‘åŒ…æä¾›äº†å“ªäº›å¹¶å‘å·¥å…·ç±»ï¼Ÿ","content":"<p>é€šè¿‡å‰é¢çš„å­¦ä¹ ï¼Œæˆ‘ä»¬ä¸€èµ·å›é¡¾äº†çº¿ç¨‹ã€é”ç­‰å„ç§å¹¶å‘ç¼–ç¨‹çš„åŸºæœ¬å…ƒç´ ï¼Œä¹Ÿé€æ­¥æ¶‰åŠäº†Javaå¹¶å‘åŒ…ä¸­çš„éƒ¨åˆ†å†…å®¹ï¼Œç›¸ä¿¡ç»è¿‡å‰é¢çš„çƒ­èº«ï¼Œæˆ‘ä»¬èƒ½å¤Ÿæ›´å¿«åœ°ç†è§£Javaå¹¶å‘åŒ…ã€‚</p><p>ä»Šå¤©æˆ‘è¦é—®ä½ çš„é—®é¢˜æ˜¯ï¼Œ<span class=\"orange\">Javaå¹¶å‘åŒ…æä¾›äº†å“ªäº›å¹¶å‘å·¥å…·ç±»ï¼Ÿ</span></p><h2>å…¸å‹å›ç­”</h2><p>æˆ‘ä»¬é€šå¸¸æ‰€è¯´çš„å¹¶å‘åŒ…ä¹Ÿå°±æ˜¯java.util.concurrentåŠå…¶å­åŒ…ï¼Œé›†ä¸­äº†Javaå¹¶å‘çš„å„ç§åŸºç¡€å·¥å…·ç±»ï¼Œå…·ä½“ä¸»è¦åŒ…æ‹¬å‡ ä¸ªæ–¹é¢ï¼š</p><ul>\n<li>\n<p>æä¾›äº†æ¯”synchronizedæ›´åŠ é«˜çº§çš„å„ç§åŒæ­¥ç»“æ„ï¼ŒåŒ…æ‹¬CountDownLatchã€CyclicBarrierã€Semaphoreç­‰ï¼Œå¯ä»¥å®ç°æ›´åŠ ä¸°å¯Œçš„å¤šçº¿ç¨‹æ“ä½œï¼Œæ¯”å¦‚åˆ©ç”¨Semaphoreä½œä¸ºèµ„æºæ§åˆ¶å™¨ï¼Œé™åˆ¶åŒæ—¶è¿›è¡Œå·¥ä½œçš„çº¿ç¨‹æ•°é‡ã€‚</p>\n</li>\n<li>\n<p>å„ç§çº¿ç¨‹å®‰å…¨çš„å®¹å™¨ï¼Œæ¯”å¦‚æœ€å¸¸è§çš„ConcurrentHashMapã€æœ‰åºçš„ConcurrentSkipListMapï¼Œæˆ–è€…é€šè¿‡ç±»ä¼¼å¿«ç…§æœºåˆ¶ï¼Œå®ç°çº¿ç¨‹å®‰å…¨çš„åŠ¨æ€æ•°ç»„CopyOnWriteArrayListç­‰ã€‚</p>\n</li>\n<li>\n<p>å„ç§å¹¶å‘é˜Ÿåˆ—å®ç°ï¼Œå¦‚å„ç§BlockingQueueå®ç°ï¼Œæ¯”è¾ƒå…¸å‹çš„ArrayBlockingQueueã€ SynchronousQueueæˆ–é’ˆå¯¹ç‰¹å®šåœºæ™¯çš„PriorityBlockingQueueç­‰ã€‚</p>\n</li>\n<li>\n<p>å¼ºå¤§çš„Executoræ¡†æ¶ï¼Œå¯ä»¥åˆ›å»ºå„ç§ä¸åŒç±»å‹çš„çº¿ç¨‹æ± ï¼Œè°ƒåº¦ä»»åŠ¡è¿è¡Œç­‰ï¼Œç»å¤§éƒ¨åˆ†æƒ…å†µä¸‹ï¼Œä¸å†éœ€è¦è‡ªå·±ä»å¤´å®ç°çº¿ç¨‹æ± å’Œä»»åŠ¡è°ƒåº¦å™¨ã€‚</p>\n</li>\n</ul><!-- [[[read_end]]] --><h2>è€ƒç‚¹åˆ†æ</h2><p>è¿™ä¸ªé¢˜ç›®ä¸»è¦è€ƒå¯Ÿä½ å¯¹å¹¶å‘åŒ…äº†è§£ç¨‹åº¦ï¼Œä»¥åŠæ˜¯å¦æœ‰å®é™…ä½¿ç”¨ç»éªŒã€‚æˆ‘ä»¬è¿›è¡Œå¤šçº¿ç¨‹ç¼–ç¨‹ï¼Œæ— éæ˜¯è¾¾åˆ°å‡ ä¸ªç›®çš„ï¼š</p><ul>\n<li>\n<p>åˆ©ç”¨å¤šçº¿ç¨‹æé«˜ç¨‹åºçš„æ‰©å±•èƒ½åŠ›ï¼Œä»¥è¾¾åˆ°ä¸šåŠ¡å¯¹ååé‡çš„è¦æ±‚ã€‚</p>\n</li>\n<li>\n<p>åè°ƒçº¿ç¨‹é—´è°ƒåº¦ã€äº¤äº’ï¼Œä»¥å®Œæˆä¸šåŠ¡é€»è¾‘ã€‚</p>\n</li>\n<li>\n<p>çº¿ç¨‹é—´ä¼ é€’æ•°æ®å’ŒçŠ¶æ€ï¼Œè¿™åŒæ ·æ˜¯å®ç°ä¸šåŠ¡é€»è¾‘çš„éœ€è¦ã€‚</p>\n</li>\n</ul><p>æ‰€ä»¥ï¼Œè¿™é“é¢˜ç›®åªèƒ½ç®—ä½œç®€å•çš„å¼€å§‹ï¼Œå¾€å¾€é¢è¯•å®˜è¿˜ä¼šè¿›ä¸€æ­¥è€ƒå¯Ÿå¦‚ä½•åˆ©ç”¨å¹¶å‘åŒ…å®ç°æŸä¸ªç‰¹å®šçš„ç”¨ä¾‹ï¼Œåˆ†æå®ç°çš„ä¼˜ç¼ºç‚¹ç­‰ã€‚</p><p>å¦‚æœä½ åœ¨è¿™æ–¹é¢çš„åŸºç¡€æ¯”è¾ƒè–„å¼±ï¼Œæˆ‘çš„å»ºè®®æ˜¯ï¼š</p><ul>\n<li>\n<p>ä»æ€»ä½“ä¸Šï¼ŒæŠŠæ¡ä½å‡ ä¸ªä¸»è¦ç»„æˆéƒ¨åˆ†ï¼ˆå‰é¢å›ç­”ä¸­å·²ç»ç®€è¦ä»‹ç»ï¼‰ã€‚</p>\n</li>\n<li>\n<p>ç†è§£å…·ä½“è®¾è®¡ã€å®ç°å’Œèƒ½åŠ›ã€‚</p>\n</li>\n<li>\n<p>å†æ·±å…¥æŒæ¡ä¸€äº›æ¯”è¾ƒå…¸å‹å·¥å…·ç±»çš„é€‚ç”¨åœºæ™¯ã€ç”¨æ³•ç”šè‡³æ˜¯åŸç†ï¼Œå¹¶ç†Ÿç»ƒå†™å‡ºå…¸å‹çš„ä»£ç ç”¨ä¾‹ã€‚</p>\n</li>\n</ul><p>æŒæ¡è¿™äº›é€šå¸¸å°±å¤Ÿç”¨äº†ï¼Œæ¯•ç«Ÿå¹¶å‘åŒ…æä¾›äº†æ–¹æ–¹é¢é¢çš„å·¥å…·ï¼Œå…¶å®å¾ˆå°‘æœ‰æœºä¼šèƒ½åœ¨åº”ç”¨ä¸­å…¨é¢ä½¿ç”¨è¿‡ï¼Œæ‰å®åœ°æŒæ¡æ ¸å¿ƒåŠŸèƒ½å°±éå¸¸ä¸é”™äº†ã€‚çœŸæ­£ç‰¹åˆ«æ·±å…¥çš„ç»éªŒï¼Œè¿˜æ˜¯å¾—é åœ¨å®é™…åœºæ™¯ä¸­è¸©å‘æ¥è·å¾—ã€‚</p><h2>çŸ¥è¯†æ‰©å±•</h2><p>é¦–å…ˆï¼Œæˆ‘ä»¬æ¥çœ‹çœ‹å¹¶å‘åŒ…æä¾›çš„ä¸°å¯ŒåŒæ­¥ç»“æ„ã€‚å‰é¢å‡ è®²å·²ç»åˆ†æè¿‡å„ç§ä¸åŒçš„æ˜¾å¼é”ï¼Œä»Šå¤©æˆ‘å°†ä¸“æ³¨äº</p><ul>\n<li>\n<p><a href=\"https://docs.oracle.com/javase/9/docs/api/java/util/concurrent/CountDownLatch.html\">CountDownLatch</a>ï¼Œå…è®¸ä¸€ä¸ªæˆ–å¤šä¸ªçº¿ç¨‹ç­‰å¾…æŸäº›æ“ä½œå®Œæˆã€‚</p>\n</li>\n<li>\n<p><a href=\"https://docs.oracle.com/javase/9/docs/api/java/util/concurrent/CyclicBarrier.html\">CyclicBarrier</a>ï¼Œä¸€ç§è¾…åŠ©æ€§çš„åŒæ­¥ç»“æ„ï¼Œå…è®¸å¤šä¸ªçº¿ç¨‹ç­‰å¾…åˆ°è¾¾æŸä¸ªå±éšœã€‚</p>\n</li>\n<li>\n<p><a href=\"https://docs.oracle.com/javase/9/docs/api/java/util/concurrent/Semaphore.html\">Semaphore</a>ï¼ŒJavaç‰ˆæœ¬çš„ä¿¡å·é‡å®ç°ã€‚</p>\n</li>\n</ul><p>Javaæä¾›äº†ç»å…¸ä¿¡å·é‡ï¼ˆ<a href=\"https://en.wikipedia.org/wiki/Semaphore_(programming)\">Semaphore</a>ï¼‰çš„å®ç°ï¼Œå®ƒé€šè¿‡æ§åˆ¶ä¸€å®šæ•°é‡çš„å…è®¸ï¼ˆpermitï¼‰çš„æ–¹å¼ï¼Œæ¥è¾¾åˆ°é™åˆ¶é€šç”¨èµ„æºè®¿é—®çš„ç›®çš„ã€‚ä½ å¯ä»¥æƒ³è±¡ä¸€ä¸‹è¿™ä¸ªåœºæ™¯ï¼Œåœ¨è½¦ç«™ã€æœºåœºç­‰å‡ºç§Ÿè½¦æ—¶ï¼Œå½“å¾ˆå¤šç©ºå‡ºç§Ÿè½¦å°±ä½æ—¶ï¼Œä¸ºé˜²æ­¢è¿‡åº¦æ‹¥æŒ¤ï¼Œè°ƒåº¦å‘˜æŒ‡æŒ¥æ’é˜Ÿç­‰å¾…åè½¦çš„é˜Ÿä¼ä¸€æ¬¡è¿›æ¥5ä¸ªäººä¸Šè½¦ï¼Œç­‰è¿™5ä¸ªäººåè½¦å‡ºå‘ï¼Œå†æ”¾è¿›å»ä¸‹ä¸€æ‰¹ï¼Œè¿™å’ŒSemaphoreçš„å·¥ä½œåŸç†æœ‰äº›ç±»ä¼¼ã€‚</p><p>ä½ å¯ä»¥è¯•è¯•ä½¿ç”¨Semaphoreæ¥æ¨¡æ‹Ÿå®ç°è¿™ä¸ªè°ƒåº¦è¿‡ç¨‹ï¼š</p><pre><code>import java.util.concurrent.Semaphore;\npublic class UsualSemaphoreSample {\n\tpublic static void main(String[] args) throws InterruptedException {\n Â Â Â \tSystem.out.println(&quot;Action...GO!&quot;);\n Â Â Â \tSemaphore semaphore = new Semaphore(5);\n Â Â Â \tfor (int i = 0; i &lt; 10; i++) {\n Â Â Â Â Â Â Â \tThread t = new Thread(new SemaphoreWorker(semaphore));\n Â Â Â Â Â Â Â \tt.start();\n Â Â Â \t}\n\t}\n}\nclass SemaphoreWorker implements Runnable {\n\tprivate String name;\n\tprivate Semaphore semaphore;\n\tpublic SemaphoreWorker(Semaphore semaphore) {\n Â Â Â \tthis.semaphore = semaphore;\n\t}\n\t@Override\n\tpublic void run() {\n Â Â Â \ttry {\n Â Â Â Â Â Â Â \tlog(&quot;is waiting for a permit!&quot;);\n Â Â Â Â Â Â \tsemaphore.acquire();\n Â Â Â Â Â Â Â \tlog(&quot;acquired a permit!&quot;);\n Â Â Â Â Â Â Â \tlog(&quot;executed!&quot;);\n Â Â Â \t} catch (InterruptedException e) {\n Â Â Â Â Â Â Â \te.printStackTrace();\n Â Â Â \t} finally {\n Â Â Â Â Â Â Â \tlog(&quot;released a permit!&quot;);\n Â Â Â Â Â Â Â \tsemaphore.release();\n Â Â Â \t}\n\t}\n\tprivate void log(String msg){\n Â Â Â \tif (name == null) {\n Â Â Â Â Â Â Â \tname = Thread.currentThread().getName();\n Â Â Â \t}\n Â Â Â \tSystem.out.println(name + &quot; &quot; + msg);\n\t}\n}\n</code></pre><p>è¿™æ®µä»£ç æ˜¯æ¯”è¾ƒå…¸å‹çš„Semaphoreç¤ºä¾‹ï¼Œå…¶é€»è¾‘æ˜¯ï¼Œçº¿ç¨‹è¯•å›¾è·å¾—å·¥ä½œå…è®¸ï¼Œå¾—åˆ°è®¸å¯åˆ™è¿›è¡Œä»»åŠ¡ï¼Œç„¶åé‡Šæ”¾è®¸å¯ï¼Œè¿™æ—¶ç­‰å¾…è®¸å¯çš„å…¶ä»–çº¿ç¨‹ï¼Œå°±å¯è·å¾—è®¸å¯è¿›å…¥å·¥ä½œçŠ¶æ€ï¼Œç›´åˆ°å…¨éƒ¨å¤„ç†ç»“æŸã€‚ç¼–è¯‘è¿è¡Œï¼Œæˆ‘ä»¬å°±èƒ½çœ‹åˆ°Semaphoreçš„å…è®¸æœºåˆ¶å¯¹å·¥ä½œçº¿ç¨‹çš„é™åˆ¶ã€‚</p><p>ä½†æ˜¯ï¼Œä»å…·ä½“èŠ‚å¥æ¥çœ‹ï¼Œå…¶å®å¹¶ä¸ç¬¦åˆæˆ‘ä»¬å‰é¢åœºæ™¯çš„éœ€æ±‚ï¼Œå› ä¸ºæœ¬ä¾‹ä¸­Semaphoreçš„ç”¨æ³•å®é™…æ˜¯ä¿è¯ï¼Œä¸€ç›´æœ‰5ä¸ªäººå¯ä»¥è¯•å›¾ä¹˜è½¦ï¼Œå¦‚æœæœ‰1ä¸ªäººå‡ºå‘äº†ï¼Œç«‹å³å°±æœ‰æ’é˜Ÿçš„äººè·å¾—è®¸å¯ï¼Œè€Œè¿™å¹¶ä¸å®Œå…¨ç¬¦åˆæˆ‘ä»¬å‰é¢çš„è¦æ±‚ã€‚</p><p>é‚£ä¹ˆï¼Œæˆ‘å†ä¿®æ”¹ä¸€ä¸‹ï¼Œæ¼”ç¤ºä¸ªéå…¸å‹çš„Semaphoreç”¨æ³•ã€‚</p><pre><code>import java.util.concurrent.Semaphore;\npublic class AbnormalSemaphoreSample {\n\tpublic static void main(String[] args) throws InterruptedException {\n Â Â Â \tSemaphore semaphore = new Semaphore(0);\n Â Â Â \tfor (int i = 0; i &lt; 10; i++) {\n Â Â Â Â Â Â Â \tThread t = new Thread(new MyWorker(semaphore));\n Â Â Â Â Â Â Â \tt.start();\n Â Â Â \t}\n Â Â Â \tSystem.out.println(&quot;Action...GO!&quot;);\n Â Â Â \tsemaphore.release(5);\n Â Â Â \tSystem.out.println(&quot;Wait for permits off&quot;);\n Â Â Â \twhile (semaphore.availablePermits()!=0) {\n Â Â Â Â Â Â Â \tThread.sleep(100L);\n Â Â Â \t}\n Â Â Â \tSystem.out.println(&quot;Action...GO again!&quot;);\n Â Â Â \tsemaphore.release(5);\n\t}\n}\nclass MyWorker implements Runnable {\n\tprivate Semaphore semaphore;\n\tpublic MyWorker(Semaphore semaphore) {\n Â Â Â \tthis.semaphore = semaphore;\n\t}\n\t@Override\n\tpublic void run() {\n Â Â Â \ttry {\n Â Â Â Â Â Â Â \tsemaphore.acquire();\n Â Â Â Â Â Â Â \tSystem.out.println(&quot;Executed!&quot;);\n Â Â Â \t} catch (InterruptedException e) {\n Â Â Â Â Â Â Â \te.printStackTrace();\n Â Â Â \t}\n\t}\n}\n\n</code></pre><p>æ³¨æ„ï¼Œä¸Šé¢çš„ä»£ç ï¼Œæ›´ä¾§é‡çš„æ˜¯æ¼”ç¤ºSemaphoreçš„åŠŸèƒ½ä»¥åŠå±€é™æ€§ï¼Œå…¶å®æœ‰å¾ˆå¤šçº¿ç¨‹ç¼–ç¨‹ä¸­çš„åå®è·µï¼Œæ¯”å¦‚ä½¿ç”¨äº†sleepæ¥åè°ƒä»»åŠ¡æ‰§è¡Œï¼Œè€Œä¸”ä½¿ç”¨è½®è¯¢è°ƒç”¨availalePermitsæ¥æ£€æµ‹ä¿¡å·é‡è·å–æƒ…å†µï¼Œè¿™éƒ½æ˜¯å¾ˆä½æ•ˆå¹¶ä¸”è„†å¼±çš„ï¼Œé€šå¸¸åªæ˜¯ç”¨åœ¨æµ‹è¯•æˆ–è€…è¯Šæ–­åœºæ™¯ã€‚</p><p>æ€»çš„æ¥è¯´ï¼Œæˆ‘ä»¬å¯ä»¥çœ‹å‡ºSemaphoreå°±æ˜¯ä¸ª<strong>è®¡æ•°å™¨</strong>ï¼Œ<strong>å…¶åŸºæœ¬é€»è¾‘åŸºäºacquire/release</strong>ï¼Œå¹¶æ²¡æœ‰å¤ªå¤æ‚çš„åŒæ­¥é€»è¾‘ã€‚</p><p>å¦‚æœSemaphoreçš„æ•°å€¼è¢«åˆå§‹åŒ–ä¸º1ï¼Œé‚£ä¹ˆä¸€ä¸ªçº¿ç¨‹å°±å¯ä»¥é€šè¿‡acquireè¿›å…¥äº’æ–¥çŠ¶æ€ï¼Œæœ¬è´¨ä¸Šå’Œäº’æ–¥é”æ˜¯éå¸¸ç›¸ä¼¼çš„ã€‚ä½†æ˜¯åŒºåˆ«ä¹Ÿéå¸¸æ˜æ˜¾ï¼Œæ¯”å¦‚äº’æ–¥é”æ˜¯æœ‰æŒæœ‰è€…çš„ï¼Œè€Œå¯¹äºSemaphoreè¿™ç§è®¡æ•°å™¨ç»“æ„ï¼Œè™½ç„¶æœ‰ç±»ä¼¼åŠŸèƒ½ï¼Œä½†å…¶å®ä¸å­˜åœ¨çœŸæ­£æ„ä¹‰çš„æŒæœ‰è€…ï¼Œé™¤éæˆ‘ä»¬è¿›è¡Œæ‰©å±•åŒ…è£…ã€‚</p><p>ä¸‹é¢ï¼Œæ¥çœ‹çœ‹CountDownLatchå’ŒCyclicBarrierï¼Œå®ƒä»¬çš„è¡Œä¸ºæœ‰ä¸€å®šçš„ç›¸ä¼¼åº¦ï¼Œç»å¸¸ä¼šè¢«è€ƒå¯ŸäºŒè€…æœ‰ä»€ä¹ˆåŒºåˆ«ï¼Œæˆ‘æ¥ç®€å•æ€»ç»“ä¸€ä¸‹ã€‚</p><ul>\n<li>\n<p>CountDownLatchæ˜¯ä¸å¯ä»¥é‡ç½®çš„ï¼Œæ‰€ä»¥æ— æ³•é‡ç”¨ï¼›è€ŒCyclicBarrieråˆ™æ²¡æœ‰è¿™ç§é™åˆ¶ï¼Œå¯ä»¥é‡ç”¨ã€‚</p>\n</li>\n<li>\n<p>CountDownLatchçš„åŸºæœ¬æ“ä½œç»„åˆæ˜¯countDown/awaitã€‚è°ƒç”¨awaitçš„çº¿ç¨‹é˜»å¡ç­‰å¾…countDownè¶³å¤Ÿçš„æ¬¡æ•°ï¼Œä¸ç®¡ä½ æ˜¯åœ¨ä¸€ä¸ªçº¿ç¨‹è¿˜æ˜¯å¤šä¸ªçº¿ç¨‹é‡ŒcountDownï¼Œåªè¦æ¬¡æ•°è¶³å¤Ÿå³å¯ã€‚æ‰€ä»¥å°±åƒBrain Goetzè¯´è¿‡çš„ï¼ŒCountDownLatchæ“ä½œçš„æ˜¯äº‹ä»¶ã€‚</p>\n</li>\n<li>\n<p>CyclicBarrierçš„åŸºæœ¬æ“ä½œç»„åˆï¼Œåˆ™å°±æ˜¯awaitï¼Œå½“æ‰€æœ‰çš„ä¼™ä¼´ï¼ˆpartiesï¼‰éƒ½è°ƒç”¨äº†awaitï¼Œæ‰ä¼šç»§ç»­è¿›è¡Œä»»åŠ¡ï¼Œå¹¶è‡ªåŠ¨è¿›è¡Œé‡ç½®ã€‚<strong>æ³¨æ„</strong>ï¼Œæ­£å¸¸æƒ…å†µä¸‹ï¼ŒCyclicBarrierçš„é‡ç½®éƒ½æ˜¯è‡ªåŠ¨å‘ç”Ÿçš„ï¼Œå¦‚æœæˆ‘ä»¬è°ƒç”¨resetæ–¹æ³•ï¼Œä½†è¿˜æœ‰çº¿ç¨‹åœ¨ç­‰å¾…ï¼Œå°±ä¼šå¯¼è‡´ç­‰å¾…çº¿ç¨‹è¢«æ‰“æ‰°ï¼ŒæŠ›å‡ºBrokenBarrierExceptionå¼‚å¸¸ã€‚CyclicBarrierä¾§é‡ç‚¹æ˜¯çº¿ç¨‹ï¼Œè€Œä¸æ˜¯è°ƒç”¨äº‹ä»¶ï¼Œå®ƒçš„å…¸å‹åº”ç”¨åœºæ™¯æ˜¯ç”¨æ¥ç­‰å¾…å¹¶å‘çº¿ç¨‹ç»“æŸã€‚</p>\n</li>\n</ul><p>å¦‚æœç”¨CountDownLatchå»å®ç°ä¸Šé¢çš„æ’é˜Ÿåœºæ™¯ï¼Œè¯¥æ€ä¹ˆåšå‘¢ï¼Ÿå‡è®¾æœ‰10ä¸ªäººæ’é˜Ÿï¼Œæˆ‘ä»¬å°†å…¶åˆ†æˆ5ä¸ªäººä¸€æ‰¹ï¼Œé€šè¿‡CountDownLatchæ¥åè°ƒæ‰¹æ¬¡ï¼Œä½ å¯ä»¥è¯•è¯•ä¸‹é¢çš„ç¤ºä¾‹ä»£ç ã€‚</p><pre><code>import java.util.concurrent.CountDownLatch;\npublic class LatchSample {\n\tpublic static void main(String[] args) throws InterruptedException {\n Â Â Â \tCountDownLatch latch = new CountDownLatch(6);\n Â Â Â Â Â Â Â Â Â Â for (int i = 0; i &lt; 5; i++) {\n Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Thread t = new Thread(new FirstBatchWorker(latch));\n Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â t.start();\n Â Â Â \t}\n Â Â Â \tfor (int i = 0; i &lt; 5; i++) {\n Â Â Â Â Â Â Â \t Â Â Â Thread t = new Thread(new SecondBatchWorker(latch));\n Â Â Â Â Â Â Â \t Â Â Â t.start();\n Â Â Â \t}\n Â Â Â Â Â Â Â Â Â Â // æ³¨æ„è¿™é‡Œä¹Ÿæ˜¯æ¼”ç¤ºç›®çš„çš„é€»è¾‘ï¼Œå¹¶ä¸æ˜¯æ¨èçš„åè°ƒæ–¹å¼\n Â Â Â \twhile ( latch.getCount() != 1 ){\n Â Â Â Â Â Â Â \t Â Â Â Thread.sleep(100L);\n Â Â Â \t}\n Â Â Â \tSystem.out.println(&quot;Wait for first batch finish&quot;);\n Â Â Â \tlatch.countDown();\n\t}\n}\nclass FirstBatchWorker implements Runnable {\n\tprivate CountDownLatch latch;\n\tpublic FirstBatchWorker(CountDownLatch latch) {\n Â Â Â \tthis.latch = latch;\n\t}\n\t@Override\n\tpublic void run() {\n Â Â Â Â Â Â Â \tSystem.out.println(&quot;First batch executed!&quot;);\n Â Â Â Â Â Â Â \tlatch.countDown();\n\t}\n}\nclass SecondBatchWorker implements Runnable {\n\tprivate CountDownLatch latch;\n\tpublic SecondBatchWorker(CountDownLatch latch) {\n Â Â Â \tthis.latch = latch;\n\t}\n\t@Override\n\tpublic void run() {\n Â Â Â \ttry {\n Â Â Â Â Â Â Â \tlatch.await();\n Â Â Â Â Â Â Â \tSystem.out.println(&quot;Second batch executed!&quot;);\n Â Â Â \t} catch (InterruptedException e) {\n Â Â Â Â Â Â Â \te.printStackTrace();\n Â Â Â \t}\n\t}\n}\n\n</code></pre><p>CountDownLatchçš„è°ƒåº¦æ–¹å¼ç›¸å¯¹ç®€å•ï¼Œåä¸€æ‰¹æ¬¡çš„çº¿ç¨‹è¿›è¡Œawaitï¼Œç­‰å¾…å‰ä¸€æ‰¹countDownè¶³å¤Ÿå¤šæ¬¡ã€‚è¿™ä¸ªä¾‹å­ä¹Ÿä»ä¾§é¢ä½“ç°å‡ºäº†å®ƒçš„å±€é™æ€§ï¼Œè™½ç„¶å®ƒä¹Ÿèƒ½å¤Ÿæ”¯æŒ10ä¸ªäººæ’é˜Ÿçš„æƒ…å†µï¼Œä½†æ˜¯å› ä¸ºä¸èƒ½é‡ç”¨ï¼Œå¦‚æœè¦æ”¯æŒæ›´å¤šäººæ’é˜Ÿï¼Œå°±ä¸èƒ½ä¾èµ–ä¸€ä¸ªCountDownLatchè¿›è¡Œäº†ã€‚å…¶ç¼–è¯‘è¿è¡Œè¾“å‡ºå¦‚ä¸‹ï¼š</p><p><img src=\"https://static001.geekbang.org/resource/image/46/b9/46c88c7d8e0507465bddb677e4eac5b9.png?wh=327*200\" alt=\"\"></p><p>åœ¨å®é™…åº”ç”¨ä¸­çš„æ¡ä»¶ä¾èµ–ï¼Œå¾€å¾€æ²¡æœ‰è¿™ä¹ˆåˆ«æ‰­ï¼ŒCountDownLatchç”¨äºçº¿ç¨‹é—´ç­‰å¾…æ“ä½œç»“æŸæ˜¯éå¸¸ç®€å•æ™®éçš„ç”¨æ³•ã€‚é€šè¿‡countDown/awaitç»„åˆè¿›è¡Œé€šä¿¡æ˜¯å¾ˆé«˜æ•ˆçš„ï¼Œé€šå¸¸ä¸å»ºè®®ä½¿ç”¨ä¾‹å­é‡Œé‚£ä¸ªå¾ªç¯ç­‰å¾…æ–¹å¼ã€‚</p><p>å¦‚æœç”¨CyclicBarrieræ¥è¡¨è¾¾è¿™ä¸ªåœºæ™¯å‘¢ï¼Ÿæˆ‘ä»¬çŸ¥é“CyclicBarrierå…¶å®åæ˜ çš„æ˜¯çº¿ç¨‹å¹¶è¡Œè¿è¡Œæ—¶çš„åè°ƒï¼Œåœ¨ä¸‹é¢çš„ç¤ºä¾‹é‡Œï¼Œä»é€»è¾‘ä¸Šï¼Œ5ä¸ªå·¥ä½œçº¿ç¨‹å…¶å®æ›´åƒæ˜¯ä»£è¡¨äº†5ä¸ªå¯ä»¥å°±ç»ªçš„ç©ºè½¦ï¼Œè€Œä¸å†æ˜¯5ä¸ªä¹˜å®¢ï¼Œå¯¹æ¯”å‰é¢CountDownLatchçš„ä¾‹å­æ›´æœ‰åŠ©äºæˆ‘ä»¬åŒºåˆ«å®ƒä»¬çš„æŠ½è±¡æ¨¡å‹ï¼Œè¯·çœ‹ä¸‹é¢çš„ç¤ºä¾‹ä»£ç ï¼š</p><pre><code>import java.util.concurrent.BrokenBarrierException;\nimport java.util.concurrent.CyclicBarrier;\npublic class CyclicBarrierSample {\n\tpublic static void main(String[] args) throws InterruptedException {\n Â Â Â \tCyclicBarrier barrier = new CyclicBarrier(5, new Runnable() {\n Â Â Â Â Â Â Â \t@Override\n Â Â Â Â Â Â Â \tpublic void run() {\n Â Â Â Â Â Â Â Â Â Â Â \tSystem.out.println(&quot;Action...GO again!&quot;);\n Â Â Â Â Â Â Â \t}\n Â Â Â \t});\n Â Â Â \tfor (int i = 0; i &lt; 5; i++) {\n Â Â Â Â Â Â Â \tThread t = new Thread(new CyclicWorker(barrier));\n Â Â Â Â Â Â Â \tt.start();\n Â Â Â \t}\n\t}\n\tstatic class CyclicWorker implements Runnable {\n Â Â Â \tprivate CyclicBarrier barrier;\n Â Â Â \tpublic CyclicWorker(CyclicBarrier barrier) {\n Â Â Â Â Â Â Â \tthis.barrier = barrier;\n Â Â Â \t}\n Â Â Â \t@Override\n Â Â Â \tpublic void run() {\n Â Â Â Â Â Â Â \ttry {\n Â Â Â Â Â Â Â Â Â Â Â \tfor (int i=0; i&lt;3 ; i++){\n Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â \tSystem.out.println(&quot;Executed!&quot;);\n Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â \tbarrier.await();\n Â Â Â Â Â Â Â Â Â Â Â \t}\n Â Â Â Â Â Â Â \t} catch (BrokenBarrierException e) {\n Â Â Â Â Â Â Â Â Â Â Â \te.printStackTrace();\n Â Â Â Â Â Â Â \t} catch (InterruptedException e) {\n Â Â Â Â Â Â Â Â Â Â Â \te.printStackTrace();\n Â Â Â Â Â Â Â \t}\n \t Â Â }\n\t}\n}\n</code></pre><p>ä¸ºäº†è®©è¾“å‡ºæ›´èƒ½è¡¨è¾¾è¿è¡Œæ—¶åºï¼Œæˆ‘ä½¿ç”¨äº†CyclicBarrierç‰¹æœ‰çš„barrierActionï¼Œå½“å±éšœè¢«è§¦å‘æ—¶ï¼ŒJavaä¼šè‡ªåŠ¨è°ƒåº¦è¯¥åŠ¨ä½œã€‚å› ä¸ºCyclicBarrierä¼š<strong>è‡ªåŠ¨</strong>è¿›è¡Œé‡ç½®ï¼Œæ‰€ä»¥è¿™ä¸ªé€»è¾‘å…¶å®å¯ä»¥éå¸¸è‡ªç„¶çš„æ”¯æŒæ›´å¤šæ’é˜Ÿäººæ•°ã€‚å…¶ç¼–è¯‘è¾“å‡ºå¦‚ä¸‹ï¼š</p><p><img src=\"https://static001.geekbang.org/resource/image/ef/9f/eff56d3219ce5493ecacc70a168b2b9f.png?wh=384*317\" alt=\"\"></p><p>Javaå¹¶å‘ç±»åº“è¿˜æä¾›äº†<a href=\"https://docs.oracle.com/javase/9/docs/api/java/util/concurrent/Phaser.html\">Phaser</a>ï¼ŒåŠŸèƒ½ä¸CountDownLatchå¾ˆæ¥è¿‘ï¼Œä½†æ˜¯å®ƒå…è®¸çº¿ç¨‹åŠ¨æ€åœ°æ³¨å†Œåˆ°Phaserä¸Šé¢ï¼Œè€ŒCountDownLatchæ˜¾ç„¶æ˜¯ä¸èƒ½åŠ¨æ€è®¾ç½®çš„ã€‚Phaserçš„è®¾è®¡åˆè¡·æ˜¯ï¼Œå®ç°å¤šä¸ªçº¿ç¨‹ç±»ä¼¼æ­¥éª¤ã€é˜¶æ®µåœºæ™¯çš„åè°ƒï¼Œçº¿ç¨‹æ³¨å†Œç­‰å¾…å±éšœæ¡ä»¶è§¦å‘ï¼Œè¿›è€Œåè°ƒå½¼æ­¤é—´è¡ŒåŠ¨ï¼Œå…·ä½“è¯·å‚è€ƒè¿™ä¸ª<a href=\"http://www.baeldung.com/java-phaser\">ä¾‹å­</a>ã€‚</p><p>æ¥ä¸‹æ¥ï¼Œæˆ‘æ¥æ¢³ç†ä¸‹å¹¶å‘åŒ…é‡Œæä¾›çš„çº¿ç¨‹å®‰å…¨Mapã€Listå’ŒSetã€‚é¦–å…ˆï¼Œè¯·å‚è€ƒä¸‹é¢çš„ç±»å›¾ã€‚</p><p><img src=\"https://static001.geekbang.org/resource/image/35/57/35390aa8a6e6f9c92fda086a1b95b457.png?wh=752*327\" alt=\"\"></p><p>ä½ å¯ä»¥çœ‹åˆ°ï¼Œæ€»ä½“ä¸Šç§ç±»å’Œç»“æ„è¿˜æ˜¯æ¯”è¾ƒç®€å•çš„ï¼Œå¦‚æœæˆ‘ä»¬çš„åº”ç”¨ä¾§é‡äºMapæ”¾å…¥æˆ–è€…è·å–çš„é€Ÿåº¦ï¼Œè€Œä¸åœ¨ä¹é¡ºåºï¼Œå¤§å¤šæ¨èä½¿ç”¨ConcurrentHashMapï¼Œåä¹‹åˆ™ä½¿ç”¨ConcurrentSkipListMapï¼›å¦‚æœæˆ‘ä»¬éœ€è¦å¯¹å¤§é‡æ•°æ®è¿›è¡Œéå¸¸é¢‘ç¹åœ°ä¿®æ”¹ï¼ŒConcurrentSkipListMapä¹Ÿå¯èƒ½è¡¨ç°å‡ºä¼˜åŠ¿ã€‚</p><p>æˆ‘åœ¨å‰é¢çš„ä¸“æ ï¼Œè°ˆåˆ°äº†æ™®é€šæ— é¡ºåºåœºæ™¯é€‰æ‹©HashMapï¼Œæœ‰é¡ºåºåœºæ™¯åˆ™å¯ä»¥é€‰æ‹©ç±»ä¼¼TreeMapç­‰ï¼Œä½†æ˜¯ä¸ºä»€ä¹ˆå¹¶å‘å®¹å™¨é‡Œé¢æ²¡æœ‰ConcurrentTreeMapå‘¢ï¼Ÿ</p><p>è¿™æ˜¯å› ä¸ºTreeMapè¦å®ç°é«˜æ•ˆçš„çº¿ç¨‹å®‰å…¨æ˜¯éå¸¸å›°éš¾çš„ï¼Œå®ƒçš„å®ç°åŸºäºå¤æ‚çš„çº¢é»‘æ ‘ã€‚ä¸ºä¿è¯è®¿é—®æ•ˆç‡ï¼Œå½“æˆ‘ä»¬æ’å…¥æˆ–åˆ é™¤èŠ‚ç‚¹æ—¶ï¼Œä¼šç§»åŠ¨èŠ‚ç‚¹è¿›è¡Œå¹³è¡¡æ“ä½œï¼Œè¿™å¯¼è‡´åœ¨å¹¶å‘åœºæ™¯ä¸­éš¾ä»¥è¿›è¡Œåˆç†ç²’åº¦çš„åŒæ­¥ã€‚è€ŒSkipListç»“æ„åˆ™è¦ç›¸å¯¹ç®€å•å¾ˆå¤šï¼Œé€šè¿‡å±‚æ¬¡ç»“æ„æé«˜è®¿é—®é€Ÿåº¦ï¼Œè™½ç„¶ä¸å¤Ÿç´§å‡‘ï¼Œç©ºé—´ä½¿ç”¨æœ‰ä¸€å®šæé«˜ï¼ˆO(nlogn)ï¼‰ï¼Œä½†æ˜¯åœ¨å¢åˆ å…ƒç´ æ—¶çº¿ç¨‹å®‰å…¨çš„å¼€é”€è¦å¥½å¾ˆå¤šã€‚ä¸ºäº†æ–¹ä¾¿ä½ ç†è§£SkipListçš„å†…éƒ¨ç»“æ„ï¼Œæˆ‘ç”»äº†ä¸€ä¸ªç¤ºæ„å›¾ã€‚</p><p><img src=\"https://static001.geekbang.org/resource/image/63/7b/63b94b5b1d002bb191c75d2c48af767b.png?wh=906*310\" alt=\"\"></p><p>å…³äºä¸¤ä¸ªCopyOnWriteå®¹å™¨ï¼Œå…¶å®CopyOnWriteArraySetæ˜¯é€šè¿‡åŒ…è£…äº†CopyOnWriteArrayListæ¥å®ç°çš„ï¼Œæ‰€ä»¥åœ¨å­¦ä¹ æ—¶ï¼Œæˆ‘ä»¬å¯ä»¥ä¸“æ³¨äºç†è§£ä¸€ç§ã€‚</p><p>é¦–å…ˆï¼ŒCopyOnWriteåˆ°åº•æ˜¯ä»€ä¹ˆæ„æ€å‘¢ï¼Ÿå®ƒçš„åŸç†æ˜¯ï¼Œä»»ä½•ä¿®æ”¹æ“ä½œï¼Œå¦‚addã€setã€removeï¼Œéƒ½ä¼šæ‹·è´åŸæ•°ç»„ï¼Œä¿®æ”¹åæ›¿æ¢åŸæ¥çš„æ•°ç»„ï¼Œé€šè¿‡è¿™ç§é˜²å¾¡æ€§çš„æ–¹å¼ï¼Œå®ç°å¦ç±»çš„çº¿ç¨‹å®‰å…¨ã€‚è¯·çœ‹ä¸‹é¢çš„ä»£ç ç‰‡æ®µï¼Œæˆ‘è¿›è¡Œæ³¨é‡Šçš„åœ°æ–¹ï¼Œå¯ä»¥æ¸…æ™°åœ°ç†è§£å…¶é€»è¾‘ã€‚</p><pre><code>public boolean add(E e) {\n\tsynchronized (lock) {\n Â Â Â \tObject[] elements = getArray();\n Â Â Â \tint len = elements.length;\n Â Â Â Â Â Â Â Â Â Â // æ‹·è´\n Â Â Â \tObject[] newElements = Arrays.copyOf(elements, len + 1);\n Â Â Â \tnewElements[len] = e;\n Â Â Â Â Â Â Â Â Â Â // æ›¿æ¢\n Â Â Â \tsetArray(newElements);\n Â Â Â \treturn true;\n Â Â Â Â Â Â Â Â Â Â Â }\n}\nfinal void setArray(Object[] a) {\n\tarray = a;\n}\n</code></pre><p>æ‰€ä»¥è¿™ç§æ•°æ®ç»“æ„ï¼Œç›¸å¯¹æ¯”è¾ƒé€‚åˆè¯»å¤šå†™å°‘çš„æ“ä½œï¼Œä¸ç„¶ä¿®æ”¹çš„å¼€é”€è¿˜æ˜¯éå¸¸æ˜æ˜¾çš„ã€‚</p><p>ä»Šå¤©æˆ‘å¯¹Javaå¹¶å‘åŒ…è¿›è¡Œäº†æ€»ç»“ï¼Œå¹¶ä¸”ç»“åˆå®ä¾‹åˆ†æäº†å„ç§åŒæ­¥ç»“æ„å’Œéƒ¨åˆ†çº¿ç¨‹å®‰å…¨å®¹å™¨ï¼Œå¸Œæœ›å¯¹ä½ æœ‰æ‰€å¸®åŠ©ã€‚</p><h2>ä¸€è¯¾ä¸€ç»ƒ</h2><p>å…³äºä»Šå¤©æˆ‘ä»¬è®¨è®ºçš„é¢˜ç›®ä½ åšåˆ°å¿ƒä¸­æœ‰æ•°äº†å—ï¼Ÿç•™ç»™ä½ çš„æ€è€ƒé¢˜æ˜¯ï¼Œä½ ä½¿ç”¨è¿‡ç±»ä¼¼CountDownLatchçš„åŒæ­¥ç»“æ„è§£å†³å®é™…é—®é¢˜å—ï¼Ÿè°ˆè°ˆä½ çš„ä½¿ç”¨åœºæ™¯å’Œå¿ƒå¾—ã€‚</p><p>è¯·ä½ åœ¨ç•™è¨€åŒºå†™å†™ä½ å¯¹è¿™ä¸ªé—®é¢˜çš„æ€è€ƒï¼Œæˆ‘ä¼šé€‰å‡ºç»è¿‡è®¤çœŸæ€è€ƒçš„ç•™è¨€ï¼Œé€ç»™ä½ ä¸€ä»½å­¦ä¹ å¥–åŠ±ç¤¼åˆ¸ï¼Œæ¬¢è¿ä½ ä¸æˆ‘ä¸€èµ·è®¨è®ºã€‚</p><p>ä½ çš„æœ‹å‹æ˜¯ä¸æ˜¯ä¹Ÿåœ¨å‡†å¤‡é¢è¯•å‘¢ï¼Ÿä½ å¯ä»¥â€œè¯·æœ‹å‹è¯»â€ï¼ŒæŠŠä»Šå¤©çš„é¢˜ç›®åˆ†äº«ç»™å¥½å‹ï¼Œæˆ–è®¸ä½ èƒ½å¸®åˆ°ä»–ã€‚</p>","comments":[{"had_liked":false,"id":44783,"user_name":"013","can_delete":false,"product_type":"c1","uid":1275744,"ip_address":"","ucode":"CB3C6AD184D1B3","user_header":"https://static001.geekbang.org/account/avatar/00/13/77/60/a44c90c5.jpg","comment_is_top":false,"comment_ctime":1543492230,"is_pvip":false,"replies":[{"id":"16133","content":"ä¸é”™","user_name":"ä½œè€…å›å¤","user_name_real":"æ¨æ™“å³°","uid":"1009360","ctime":1543626872,"ip_address":"","comment_id":44783,"utype":1}],"discussion_count":1,"race_medal":0,"score":"362320745094","product_id":100006701,"comment_content":"1ï¼‰CountDownLatchå’ŒCyclicBarrieréƒ½èƒ½å¤Ÿå®ç°çº¿ç¨‹ä¹‹é—´çš„ç­‰å¾…ï¼Œåªä¸è¿‡å®ƒä»¬ä¾§é‡ç‚¹ä¸åŒï¼š<br>CountDownLatchä¸€èˆ¬ç”¨äºæŸä¸ªçº¿ç¨‹Aç­‰å¾…è‹¥å¹²ä¸ªå…¶ä»–çº¿ç¨‹æ‰§è¡Œå®Œä»»åŠ¡ä¹‹åï¼Œå®ƒæ‰æ‰§è¡Œï¼›<br>è€ŒCyclicBarrierä¸€èˆ¬ç”¨äºä¸€ç»„çº¿ç¨‹äº’ç›¸ç­‰å¾…è‡³æŸä¸ªçŠ¶æ€ï¼Œç„¶åè¿™ä¸€ç»„çº¿ç¨‹å†åŒæ—¶æ‰§è¡Œï¼›<br>å¦å¤–ï¼ŒCountDownLatchæ˜¯ä¸èƒ½å¤Ÿé‡ç”¨çš„ï¼Œè€ŒCyclicBarrieræ˜¯å¯ä»¥é‡ç”¨çš„ã€‚<br>2ï¼‰Semaphoreå…¶å®å’Œé”æœ‰ç‚¹ç±»ä¼¼ï¼Œå®ƒä¸€èˆ¬ç”¨äºæ§åˆ¶å¯¹æŸç»„èµ„æºçš„è®¿é—®æƒé™ã€‚","like_count":85,"discussions":[{"author":{"id":1009360,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/66/d0/6541f1d5.jpg","nickname":"æ¨æ™“å³°","note":"","ucode":"2BF255467A978F","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":430833,"discussion_content":"ä¸é”™","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1543626872,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":13260,"user_name":"å¤©ç§¤åº§çš„é€‰æ‹©","can_delete":false,"product_type":"c1","uid":1124929,"ip_address":"","ucode":"BC3EF928C0F8EE","user_header":"https://static001.geekbang.org/account/avatar/00/11/2a/41/bd6da351.jpg","comment_is_top":false,"comment_ctime":1529480203,"is_pvip":false,"discussion_count":6,"race_medal":0,"score":"211982877707","product_id":100006701,"comment_content":"åšandroidçš„ï¼Œä¸€ä¸ªé¡µé¢æœ‰A,B,Cä¸‰ä¸ªç½‘ç»œè¯·æ±‚ï¼Œå…¶ä¸­è¯·æ±‚Céœ€è¦è¯·æ±‚Aå’Œè¯·æ±‚Bçš„è¿”å›æ•°æ®ä½œä¸ºå‚æ•°ï¼Œç”¨è¿‡CountdownLatchè§£å†³ã€‚","like_count":50,"discussions":[{"author":{"id":1024043,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/a0/2b/efa6dc2e.jpg","nickname":"KingSwim","note":"","ucode":"84DE14B7EB2580","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":333,"discussion_content":"RxJavaç°åœ¨å¯ä»¥å¾ˆå¥½åœ°åšåˆ°äº†ã€‚","likes_number":2,"is_delete":false,"is_hidden":false,"ctime":1561453798,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1093258,"avatar":"https://static001.geekbang.org/account/avatar/00/10/ae/8a/e67def95.jpg","nickname":"èµ¤äº‘","note":"","ucode":"67476D582D8B6A","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":534357,"discussion_content":"join Â ä¸æ›´ç®€å•å—ï¼Ÿ\n","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1638171160,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":1,"child_discussions":[{"author":{"id":2282742,"avatar":"https://static001.geekbang.org/account/avatar/00/22/d4/f6/e183ab38.jpg","nickname":"é£","note":"","ucode":"E7C2D899490951","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":1093258,"avatar":"https://static001.geekbang.org/account/avatar/00/10/ae/8a/e67def95.jpg","nickname":"èµ¤äº‘","note":"","ucode":"67476D582D8B6A","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":545917,"discussion_content":"è°ƒç”¨çº¿ç¨‹ä¸€èˆ¬ç”¨çº¿ç¨‹æ± ï¼Œçº¿ç¨‹ä¸€èˆ¬ä¸ä¼šç»“æŸçš„","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1642082517,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":534357,"ip_address":""},"score":545917,"extra":""}]},{"author":{"id":2391701,"avatar":"","nickname":"Geek_a3890b","note":"","ucode":"BF67D080DAF96D","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":403518,"discussion_content":"å¼‚æ­¥ç¼–æ’\n","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1634095069,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1324314,"avatar":"https://static001.geekbang.org/account/avatar/00/14/35/1a/9fa38dc9.jpg","nickname":"å­ç»","note":"","ucode":"5C26FF10934534","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":351122,"discussion_content":"ç†è§£åˆ°ä½ï¼Œå“ˆå“ˆ","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1614157856,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1120971,"avatar":"https://static001.geekbang.org/account/avatar/00/11/1a/cb/5a2f6ff9.jpg","nickname":"ä¸€è·¯å‘åŒ—","note":"","ucode":"5D16E71116FDC3","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":294587,"discussion_content":"åç¨‹å¯ä»¥æ›´ç®€å•çš„å¤„ç†è¿™ç§æƒ…å†µ","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1595934154,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":13425,"user_name":"Daydayup","can_delete":false,"product_type":"c1","uid":1114245,"ip_address":"","ucode":"A03996E942CDFD","user_header":"https://static001.geekbang.org/account/avatar/00/11/00/85/21e1a720.jpg","comment_is_top":false,"comment_ctime":1529624181,"is_pvip":false,"replies":[{"id":"4502","content":"åˆé€‚çš„åœºæ™¯","user_name":"ä½œè€…å›å¤","user_name_real":"æ¨æ™“å³°","uid":"1009360","ctime":1529627524,"ip_address":"","comment_id":13425,"utype":1}],"discussion_count":5,"race_medal":0,"score":"160443414133","product_id":100006701,"comment_content":"CountDownLatchæœ€è¿‘è¿˜çœŸç”¨ä¸Šäº†ã€‚æˆ‘çš„éœ€æ±‚æ˜¯æ¯ä¸ªå¯¹è±¡ä¸€ä¸ªçº¿ç¨‹ï¼Œåˆ†åˆ«åœ¨æ¯ä¸ªçº¿ç¨‹é‡Œè®¡ç®—å„è‡ªçš„æ•°æ®ï¼Œæœ€ç»ˆç­‰åˆ°æ‰€æœ‰çº¿ç¨‹è®¡ç®—å®Œæ¯•ï¼Œæˆ‘è¿˜éœ€è¦å°†æ¯ä¸ªæœ‰å…±é€šçš„å¯¹è±¡è¿›è¡Œåˆå¹¶ï¼Œæ‰€ä»¥ç”¨å®ƒå¾ˆåˆé€‚ã€‚","like_count":38,"discussions":[{"author":{"id":1009360,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/66/d0/6541f1d5.jpg","nickname":"æ¨æ™“å³°","note":"","ucode":"2BF255467A978F","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":419644,"discussion_content":"åˆé€‚çš„åœºæ™¯","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1529627524,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1026832,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/ab/10/b812ff3e.jpg","nickname":"Hesher","note":"","ucode":"99AB8B1704CB7E","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":3230,"discussion_content":"å¦‚æœéƒ½æ˜¯é‡å¤çš„ä»»åŠ¡ï¼Œfork join pool å¥½åƒä¹Ÿå¯ä»¥","likes_number":3,"is_delete":false,"is_hidden":false,"ctime":1564323698,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":1,"child_discussions":[{"author":{"id":1466335,"avatar":"https://static001.geekbang.org/account/avatar/00/16/5f/df/3c4881f0.jpg","nickname":"Geek","note":"","ucode":"1B8EB2C26DE4EC","race_medal":0,"user_type":1,"is_pvip":true},"reply_author":{"id":1026832,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/ab/10/b812ff3e.jpg","nickname":"Hesher","note":"","ucode":"99AB8B1704CB7E","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":271529,"discussion_content":"æ˜¯çš„ï¼Œåªæ˜¯countdownlatchçš„ç²’åº¦æ›´ç»†ï¼Œä¸ç”¨æ‰§è¡Œåˆ°çº¿ç¨‹ç»“å°¾å³å¯è¿”å›ã€‚è€Œjoinå¿…é¡»æ•´ä¸ªçº¿ç¨‹ç»“æŸ","likes_number":4,"is_delete":false,"is_hidden":false,"ctime":1590153379,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":3230,"ip_address":""},"score":271529,"extra":""}]},{"author":{"id":1324314,"avatar":"https://static001.geekbang.org/account/avatar/00/14/35/1a/9fa38dc9.jpg","nickname":"å­ç»","note":"","ucode":"5C26FF10934534","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":351123,"discussion_content":"å­¦ä»¥è‡´ç”¨","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1614157876,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1107535,"avatar":"https://static001.geekbang.org/account/avatar/00/10/e6/4f/03d34a71.jpg","nickname":"è·¯ç¯","note":"","ucode":"DF7CB97900DA26","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":288899,"discussion_content":"è¿™ç§åœºæ™¯ç”¨cylicbarrieræ˜¯ä¸æ˜¯ä¹Ÿå¯ä»¥ï¼Ÿ\n","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1593927562,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":13182,"user_name":"Jerryé“¶é“¶","can_delete":false,"product_type":"c1","uid":1008404,"ip_address":"","ucode":"80DA1172A2360A","user_header":"https://static001.geekbang.org/account/avatar/00/0f/63/14/06eff9a4.jpg","comment_is_top":false,"comment_ctime":1529448937,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"126083500521","product_id":100006701,"comment_content":"å¯¹äºJava å¹¶å‘åŒ…æä¾›äº†å“ªäº›å¹¶å‘å·¥å…·ç±»ï¼Œæˆ‘æ˜¯è¿™ä¹ˆç†è§£çš„ï¼š<br>1. æ‰§è¡Œä»»åŠ¡ï¼Œéœ€è¦å¯¹åº”çš„æ‰§è¡Œæ¡†æ¶ï¼ˆExecutorsï¼‰ï¼›<br>2. å¤šä¸ªä»»åŠ¡è¢«åŒæ—¶æ‰§è¡Œæ—¶ï¼Œéœ€è¦åè°ƒï¼Œè¿™å°±éœ€è¦Lockã€é—­é”ã€æ …æ ã€ä¿¡å·é‡ã€é˜»å¡é˜Ÿåˆ—ï¼›<br>3. Javaç¨‹åºä¸­å……æ»¡äº†å¯¹è±¡ï¼Œåœ¨å¹¶å‘åœºæ™¯ä¸­å½“ç„¶é¿å…ä¸äº†é‡åˆ°åŒç§ç±»å‹çš„Nä¸ªå¯¹è±¡ï¼Œè€Œå¯¹è±¡éœ€è¦è¢«å­˜å‚¨ï¼Œè¿™éœ€è¦é«˜æ•ˆçš„çº¿ç¨‹å®‰å…¨çš„å®¹å™¨ç±»","like_count":30},{"had_liked":false,"id":13239,"user_name":"å¤å¤©ğŸ”†","can_delete":false,"product_type":"c1","uid":1100196,"ip_address":"","ucode":"BFCC20BFFD70EE","user_header":"https://static001.geekbang.org/account/avatar/00/10/c9/a4/f5341299.jpg","comment_is_top":false,"comment_ctime":1529461989,"is_pvip":true,"discussion_count":0,"race_medal":0,"score":"65953971429","product_id":100006701,"comment_content":"ä»¥å‰ä½¿ç”¨coutdownlatchè¿›è¡Œå¹¶å‘å¼‚å¸¸çš„æ¨¡æ‹Ÿï¼Œæ¥ä¿®æ”¹bugï¼Œå…·ä½“æ˜¯åœ¨å‘ç”Ÿå¼‚å¸¸çš„é”™è¯¯å †æ ˆä¸Šè¿›è¡Œawaitï¼Œåœ¨æŸäº›æ¡ä»¶å¤„æˆ–è§¦å‘ç‚¹è¿›è¡Œcoutdownï¼Œæ¥å°½å¯èƒ½æ¨¡æ‹Ÿè§¦å‘å¼‚å¸¸æ—¶çš„åœºæ™¯ï¼Œå¾ˆå¤šå¯ä»¥å¿…ç°ï¼Œä¿®æ”¹ä¹‹åæ²¡æœ‰é—®é¢˜ï¼Œæ‰ç®—è§£å†³ä¸€ä¸ªå¹¶å‘å¼‚å¸¸","like_count":16},{"had_liked":false,"id":13076,"user_name":"æ‰«åœ°åƒ§çš„åŠŸå¤«æ¢¦","can_delete":false,"product_type":"c1","uid":1081053,"ip_address":"","ucode":"3B775474594BC3","user_header":"https://static001.geekbang.org/account/avatar/00/10/7e/dd/e4e6718a.jpg","comment_is_top":false,"comment_ctime":1529367188,"is_pvip":false,"replies":[{"id":"4415","content":"æ˜¯è¯´è°ƒç”¨notifyçš„é‚£ä¸ªçº¿ç¨‹çš„çŠ¶æ€å—ï¼Ÿ<br>ä¸æ˜¯çš„ï¼Œè¿™é‡Œæœ‰å¾ˆå¤šæ–¹é¢ï¼š<br>é˜»å¡ä¸€èˆ¬å‘ç”Ÿåœ¨è¿›å…¥åŒæ­¥å—å„¿æ—¶ï¼›<br>notifyå¹¶ä¸ä¼šè®©å‡ºå½“å‰çš„monitorï¼›<br>å¯ä»¥ç”¨waité‡Šæ”¾é”ï¼Œä½†æ˜¯è¿›å…¥waitingçŠ¶æ€ã€‚<br><br>ä¸å»ºè®®é è®°å¿†å»å­¦ä¹ ï¼Œç±»ä¼¼é—®é¢˜æˆ‘å»ºè®®æ€è€ƒä¸€ä¸‹ï¼šèƒ½ä¸èƒ½ç”¨ä¸€æ®µç¨‹åºéªŒè¯ï¼Œéœ€ä¸éœ€è¦åˆ©ç”¨ä»€ä¹ˆå·¥å…·ï¼›åˆ«å¿˜äº†ä»Javadocå¾—åˆ°åˆæ­¥ä¿¡æ¯<br><br>æˆäººä»¥æ¸”æ¯”æä¾›ç­”æ¡ˆæ›´é‡è¦ï¼Œæœ€å¥½ä¸è¦ä½ æ€€ç–‘æˆ‘è¿™é‡Œçš„æ¯ä¸ªç»“è®ºï¼Œè‡ªå·±å†™ä»£ç å»ç©ç©","user_name":"ä½œè€…å›å¤","user_name_real":"æ¨æ™“å³°","uid":"1009360","ctime":1529423159,"ip_address":"","comment_id":13076,"utype":1}],"discussion_count":4,"race_medal":0,"score":"65953876628","product_id":100006701,"comment_content":"17è®²çš„é—®é¢˜ï¼Œç•™è¨€æœ‰ç‚¹æ™šï¼Œè€å¸ˆå¯èƒ½ä¸ä¼šçœ‹ï¼Œæƒ³å¾—åˆ°è€å¸ˆçš„å›å¤ï¼šè°ƒç”¨notify()&#47;notifyAll()æ–¹æ³•åçº¿ç¨‹æ˜¯å¤„äºé˜»å¡çŠ¶æ€å§ï¼Œå› ä¸ºçº¿ç¨‹è¿˜æ²¡è·å–åˆ°é”ã€‚","like_count":15,"discussions":[{"author":{"id":1009360,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/66/d0/6541f1d5.jpg","nickname":"æ¨æ™“å³°","note":"","ucode":"2BF255467A978F","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":419527,"discussion_content":"æ˜¯è¯´è°ƒç”¨notifyçš„é‚£ä¸ªçº¿ç¨‹çš„çŠ¶æ€å—ï¼Ÿ\nä¸æ˜¯çš„ï¼Œè¿™é‡Œæœ‰å¾ˆå¤šæ–¹é¢ï¼š\né˜»å¡ä¸€èˆ¬å‘ç”Ÿåœ¨è¿›å…¥åŒæ­¥å—å„¿æ—¶ï¼›\nnotifyå¹¶ä¸ä¼šè®©å‡ºå½“å‰çš„monitorï¼›\nå¯ä»¥ç”¨waité‡Šæ”¾é”ï¼Œä½†æ˜¯è¿›å…¥waitingçŠ¶æ€ã€‚\n\nä¸å»ºè®®é è®°å¿†å»å­¦ä¹ ï¼Œç±»ä¼¼é—®é¢˜æˆ‘å»ºè®®æ€è€ƒä¸€ä¸‹ï¼šèƒ½ä¸èƒ½ç”¨ä¸€æ®µç¨‹åºéªŒè¯ï¼Œéœ€ä¸éœ€è¦åˆ©ç”¨ä»€ä¹ˆå·¥å…·ï¼›åˆ«å¿˜äº†ä»Javadocå¾—åˆ°åˆæ­¥ä¿¡æ¯\n\næˆäººä»¥æ¸”æ¯”æä¾›ç­”æ¡ˆæ›´é‡è¦ï¼Œæœ€å¥½ä¸è¦ä½ æ€€ç–‘æˆ‘è¿™é‡Œçš„æ¯ä¸ªç»“è®ºï¼Œè‡ªå·±å†™ä»£ç å»ç©ç©","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1529423159,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1144504,"avatar":"https://static001.geekbang.org/account/avatar/00/11/76/b8/e4cd7997.jpg","nickname":"KAGEMUSHA","note":"","ucode":"DFC05BE62A9C10","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":303240,"discussion_content":"è¡¥å……è€å¸ˆçš„ä¸€å¥ï¼šä½†ä¸€èˆ¬éƒ½æ˜¯åœ¨å½“å‰çº¿ç¨‹å³å°†é€€å‡ºåŒæ­¥åŠŸèƒ½å—çš„æ—¶å€™æ‰è°ƒç”¨notifyåŒæ ·é‡Šæ”¾äº†é”ã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1599199252,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":2,"child_discussions":[{"author":{"id":1158477,"avatar":"https://static001.geekbang.org/account/avatar/00/11/ad/4d/e24fc9e4.jpg","nickname":"è”¡å…‰æ˜","note":"","ucode":"7EACC0555B4F19","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":1144504,"avatar":"https://static001.geekbang.org/account/avatar/00/11/76/b8/e4cd7997.jpg","nickname":"KAGEMUSHA","note":"","ucode":"DFC05BE62A9C10","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":304201,"discussion_content":"notifyå’Œé‡Šæ”¾é”æ˜¯ä¸¤å›äº‹ï¼Œ","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1599494267,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":303240,"ip_address":""},"score":304201,"extra":""},{"author":{"id":1144504,"avatar":"https://static001.geekbang.org/account/avatar/00/11/76/b8/e4cd7997.jpg","nickname":"KAGEMUSHA","note":"","ucode":"DFC05BE62A9C10","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":1158477,"avatar":"https://static001.geekbang.org/account/avatar/00/11/ad/4d/e24fc9e4.jpg","nickname":"è”¡å…‰æ˜","note":"","ucode":"7EACC0555B4F19","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":304655,"discussion_content":"è°ä¸çŸ¥é“æ˜¯ä¸¤å›äº‹ï¼Œæ²¡çœ‹åˆ°â€é€€å‡ºâ€??çœ‹å¥½æ•´å¥è¯åˆ«å°±æŒ‘ä¸ªè¯æ–­è¯å–ä¹‰","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1599635737,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":304201,"ip_address":""},"score":304655,"extra":""}]}]},{"had_liked":false,"id":29756,"user_name":"xuery","can_delete":false,"product_type":"c1","uid":1027584,"ip_address":"","ucode":"F461B61BE06131","user_header":"https://static001.geekbang.org/account/avatar/00/0f/ae/00/025f37e7.jpg","comment_is_top":false,"comment_ctime":1538531957,"is_pvip":true,"replies":[{"id":"12430","content":"æ˜¯ä¸ªåº”ç”¨é¢‘ç‡é«˜çš„åŒæ­¥å·¥å…·","user_name":"ä½œè€…å›å¤","user_name_real":"æ¨æ™“å³°","uid":"1009360","ctime":1540312185,"ip_address":"","comment_id":29756,"utype":1}],"discussion_count":4,"race_medal":0,"score":"44488204917","product_id":100006701,"comment_content":"æœ€è¿‘æœ‰ç”¨åˆ°countDownLatchï¼Œä¸€ä¸ªæ‰¹é‡æ›´æ–°æ¥å£ï¼Œé‡‡ç”¨å¤šçº¿ç¨‹æé«˜å¤„ç†é€Ÿåº¦ï¼Œå…¨éƒ¨å¤„ç†å®Œå°†ç»“æœå°è£…è¿”å›ç»™appç«¯","like_count":10,"discussions":[{"author":{"id":1009360,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/66/d0/6541f1d5.jpg","nickname":"æ¨æ™“å³°","note":"","ucode":"2BF255467A978F","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":425704,"discussion_content":"æ˜¯ä¸ªåº”ç”¨é¢‘ç‡é«˜çš„åŒæ­¥å·¥å…·","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1540312185,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1195049,"avatar":"https://static001.geekbang.org/account/avatar/00/12/3c/29/29d923ce.jpg","nickname":"æ±Ÿå—å°å¸…","note":"","ucode":"3519F8EA938022","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":298100,"discussion_content":"futureåº”ç”¨æ›´å¹¿æ³›å§","likes_number":2,"is_delete":false,"is_hidden":false,"ctime":1597191332,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1768852,"avatar":"https://static001.geekbang.org/account/avatar/00/1a/fd/94/8704d2b0.jpg","nickname":"spoofer","note":"","ucode":"6723F64ACC3F27","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":351569,"discussion_content":"future å’Œ catsé‡Œé¢çš„forå°±å¯ä»¥äº†\n","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1614328590,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1024304,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/a1/30/770c64b2.jpg","nickname":"è¤è¨€","note":"","ucode":"43A891C33DBDB8","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":245769,"discussion_content":"Fork/Join å•Š","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1587698402,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":13298,"user_name":"çŸ³å¤´ç‹®å­","can_delete":false,"product_type":"c1","uid":1118031,"ip_address":"","ucode":"3BABB93E552022","user_header":"https://static001.geekbang.org/account/avatar/00/11/0f/4f/c75c4889.jpg","comment_is_top":false,"comment_ctime":1529506229,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"31594277301","product_id":100006701,"comment_content":"åˆ—ä¸¾å®è·µä¸­ä¸¤ä¸ªåº”ç”¨å¹¶å‘å·¥å…·çš„åœºæ™¯:<br>1. è¯·æ±‚ç†”æ–­å™¨ï¼Œä½¿ç”¨ Semaphore ç†”æ–­æŸäº›è¯·æ±‚çº¿ç¨‹ï¼Œå¾…ç³»ç»Ÿæ¢å¤ä»¥åå†é€æ­¥é‡Šæ”¾ä¿¡å·é‡ã€‚<br>2. Worker æœç´¢åœæ­¢æ ‡å¿—ã€‚ä½¿ç”¨ countdownlatch æ ‡è®° Worker æ‰¾åˆ°çš„ç»“æœä¸ªæ•°ï¼Œè¾¾åˆ°ç»“æœåå…¶ä»–çº¿ç¨‹ä¸å†ç»§ç»­æ‰§è¡Œã€‚","like_count":8},{"had_liked":false,"id":13215,"user_name":"å¦‚é£","can_delete":false,"product_type":"c1","uid":1022124,"ip_address":"","ucode":"368918EC7DD548","user_header":"https://static001.geekbang.org/account/avatar/00/0f/98/ac/c2c4fd82.jpg","comment_is_top":false,"comment_ctime":1529456191,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"31594227263","product_id":100006701,"comment_content":"åœ¨å†™çˆ¬è™«æ—¶ï¼Œä½¿ç”¨è¿‡ Semaphore ï¼Œæ¥æ§åˆ¶æœ€å¤šçˆ¬åŒä¸€ä¸ªåŸŸåä¸‹çš„ url æ•°é‡ã€‚","like_count":8},{"had_liked":false,"id":38127,"user_name":"Phoenix","can_delete":false,"product_type":"c1","uid":1005368,"ip_address":"","ucode":"C51BE4C948755B","user_header":"https://static001.geekbang.org/account/avatar/00/0f/57/38/ba6a106f.jpg","comment_is_top":false,"comment_ctime":1541949202,"is_pvip":false,"replies":[{"id":"15443","content":"ä¸é”™","user_name":"ä½œè€…å›å¤","user_name_real":"æ¨æ™“å³°","uid":"1009360","ctime":1543194598,"ip_address":"","comment_id":38127,"utype":1}],"discussion_count":1,"race_medal":0,"score":"27311752978","product_id":100006701,"comment_content":"ç»è¿‡è€å¸ˆçš„è®²è§£ï¼Œæˆ‘å¯¹CountDownLatchçš„ä½¿ç”¨åœºæ™¯æ˜¯è¿™æ ·ç†è§£çš„ï¼š<br>1ï¼šAçº¿ç¨‹çš„æ‰§è¡Œï¼Œä¾èµ–ä¸Bçº¿ç¨‹æˆ–Cçº¿ç¨‹ç­‰ç­‰å…¶ä»–å¤šä¸ªçº¿ç¨‹ä»»åŠ¡çš„æ‰§è¡Œç»“æœæ¥è§¦å‘Açº¿ç¨‹ä»»åŠ¡æ‰§è¡Œäº‹ä»¶","like_count":6,"discussions":[{"author":{"id":1009360,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/66/d0/6541f1d5.jpg","nickname":"æ¨æ™“å³°","note":"","ucode":"2BF255467A978F","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":428615,"discussion_content":"ä¸é”™","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1543194598,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":13177,"user_name":"THROW","can_delete":false,"product_type":"c1","uid":1112141,"ip_address":"","ucode":"A3C089A8F5F941","user_header":"https://static001.geekbang.org/account/avatar/00/10/f8/4d/4b748ff1.jpg","comment_is_top":false,"comment_ctime":1529425183,"is_pvip":false,"discussion_count":1,"race_medal":0,"score":"27299228959","product_id":100006701,"comment_content":"ArrayBlockingQueueä½¿ç”¨äº†ä¸¤ä¸ªconditionæ¥åˆ†åˆ«æ§åˆ¶putå’Œtakeçš„é˜»å¡ä¸å”¤é†’ï¼Œä½†æ˜¯æˆ‘åœ¨æƒ³å¥½åƒåªç”¨ä¸€ä¸ªconditionä¹Ÿå¯ä»¥ï¼Œå› ä¸ºputå’Œtakeåªä¼šæœ‰ä¸€ä¸ªæ˜¯å¤„äºé˜»å¡ç­‰å¾…çŠ¶æ€ã€‚æ‰€ä»¥è®¾è®¡æˆä¸¤ä¸ªcondition çš„åŸå› æ˜¯ä»€ä¹ˆå‘¢ï¼Ÿåªæ˜¯ä¸ºäº†æé«˜å¯è¯»æ€§ä¹ˆï¼Ÿ","like_count":6,"discussions":[{"author":{"id":1158477,"avatar":"https://static001.geekbang.org/account/avatar/00/11/ad/4d/e24fc9e4.jpg","nickname":"è”¡å…‰æ˜","note":"","ucode":"7EACC0555B4F19","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":304490,"discussion_content":"æ˜¯è¦æœ‰ä¸¤ä¸ªçš„ï¼Œé™¤éä½ æŠŠsignalæ¢æˆsignalAllï¼Œå› ä¸ºtakeçº¿ç¨‹è¦å”¤é†’çš„å¿…é¡»æ˜¯putçº¿ç¨‹ï¼Œputçº¿ç¨‹å”¤é†’çš„å¿…é¡»æ˜¯takeçº¿ç¨‹ï¼Œå½“ç„¶ï¼Œå¦‚æœç”¨signalAllçš„è¯ï¼Œç”¨ä¸€ä¸ªconditionä¹Ÿæ˜¯å¯ä»¥çš„ï¼Œä½†æ˜¯æ¯æ¬¡éƒ½å”¤é†’æ‰€æœ‰çº¿ç¨‹ï¼Œæ²¡æœ‰å¿…è¦çš„å§","likes_number":4,"is_delete":false,"is_hidden":false,"ctime":1599579081,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":18403,"user_name":"feifei","can_delete":false,"product_type":"c1","uid":1105431,"ip_address":"","ucode":"B1F8AE3AD82C51","user_header":"https://static001.geekbang.org/account/avatar/00/10/de/17/75e2b624.jpg","comment_is_top":false,"comment_ctime":1533293433,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"23008129913","product_id":100006701,"comment_content":"æˆ‘çš„ä½¿ç”¨ç»éªŒï¼Œåœ¨è¿›è¡Œé«˜å¹¶å‘çš„æµ‹è¯•æ—¶ï¼Œæˆ‘ä¼šä½¿ç”¨countdownlatch,å°†æ‰€æœ‰çš„å·¥ä½œçº¿ç¨‹åœ¨å¼€å§‹æ—¶ç­‰å¾…ï¼Œç„¶ååœ¨ç»Ÿä¸€çš„å¼€å§‹ï¼Œè¿™æ ·å°±å¯ä»¥é¿å…åˆ›å»ºçº¿ç¨‹æ‰€éœ€çš„æ—¶é—´å¼€é”€ï¼Œæ›´å¥½çš„æ¨¡æ‹Ÿé«˜å¹¶å‘","like_count":6},{"had_liked":false,"id":13172,"user_name":"ä¸‰ä¸ªçŸ³å¤´","can_delete":false,"product_type":"c1","uid":1110384,"ip_address":"","ucode":"A863A416D65217","user_header":"https://static001.geekbang.org/account/avatar/00/10/f1/70/a64d9498.jpg","comment_is_top":false,"comment_ctime":1529421881,"is_pvip":false,"discussion_count":2,"race_medal":0,"score":"23004258361","product_id":100006701,"comment_content":"ä½ ç”¨çš„Semaphoreç¬¬äºŒä¸ªä¾‹å­ï¼Œæ„é€ å‡½æ•°ä¸­ä¸ºå•¥ä¸º0,ä¿¡å·é‡ä¸æ˜¯éè´Ÿæ•´æ•°å—ï¼Ÿ","like_count":6,"discussions":[{"author":{"id":1968967,"avatar":"https://static001.geekbang.org/account/avatar/00/1e/0b/47/221706c2.jpg","nickname":"é™†ç¦ç¦","note":"","ucode":"2EA0C8491BF9A1","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":260926,"discussion_content":"0æ˜¯åˆå§‹ä¿¡å·é‡å•Šï¼Œæ„æ€æ˜¯è¦å…ˆreleaseæ‰èƒ½acquire","likes_number":3,"is_delete":false,"is_hidden":false,"ctime":1588913877,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1144504,"avatar":"https://static001.geekbang.org/account/avatar/00/11/76/b8/e4cd7997.jpg","nickname":"KAGEMUSHA","note":"","ucode":"DFC05BE62A9C10","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":303243,"discussion_content":"å½“åœ¨ä¸»çº¿ç¨‹åˆå§‹åŒ–ä¿¡å·é‡ä¸ºnew Semaphore(0)æ—¶ï¼Œåœ¨ä¸»çº¿ç¨‹å’Œå­çº¿ç¨‹åŒæ—¶ä½¿ç”¨äº†.acquire()å»è¯·æ±‚ä¿¡å·é‡ï¼Œç›¸å½“äºæ˜¯ä¿¡å·é‡ä»0ï¼Œå‡å»1å˜æˆ-1ï¼Œæ­¤æ—¶å¦‚æœæ²¡æœ‰æ‰§è¡Œreleaseï¼Œç»“æœï¼Œçº¿ç¨‹å°±ä¼šé˜»å¡åœ¨è¿™é‡Œã€‚å¦‚æœä¸»ï¼Œå­çº¿ç¨‹éƒ½é¦–å…ˆæ‰§è¡Œäº†acquireå› ä¸ºæ²¡æœ‰åˆ«çš„çº¿ç¨‹æ¥æ‰§è¡Œreleaseï¼Œäºæ˜¯æ•´ä¸ªç¨‹åºé˜»å¡äº†ã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1599199851,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":13090,"user_name":"Leiy","can_delete":false,"product_type":"c1","uid":1009001,"ip_address":"","ucode":"BE812F95D6089E","user_header":"https://static001.geekbang.org/account/avatar/00/0f/65/69/efb57b83.jpg","comment_is_top":false,"comment_ctime":1529369460,"is_pvip":true,"discussion_count":1,"race_medal":0,"score":"23004205940","product_id":100006701,"comment_content":"å¯¹äºCopyOnWriteArrayListï¼Œé€‚ç”¨äºè¯»å¤šå†™å°‘çš„åœºæ™¯ï¼Œè¿™ä¸ªæ¯”è¾ƒå¥½ç†è§£ï¼Œä½†æ˜¯åœ¨å®é™…ä½¿ç”¨æ—¶å€™ï¼Œè¯»å†™æ¯”å å¤šå°‘æ—¶å€™ï¼Œå¯ä»¥ä½¿ç”¨ï¼Ÿå¿ƒé‡Œè¿˜æ˜¯æ²¡æ•°ï¼Œè¿™ä¸ªæ€ä¹ˆå»è¡¡é‡ï¼Ÿ","like_count":5,"discussions":[{"author":{"id":1033435,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/c4/db/6ba349d6.jpg","nickname":"LT","note":"","ucode":"A673D8DC820F6E","race_medal":0,"user_type":1,"is_pvip":true},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":549241,"discussion_content":"æ ¹æ®çº¿ä¸Šæµé‡ç‰¹å¾ï¼Œå¯¹å¤šä¸ªå¤‡é€‰æ–¹æ¡ˆåšä¸€æ¬¡åŸºå‡†æµ‹è¯•ï¼Œé€‰æ‹©æ€§èƒ½æœ€é«˜çš„","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1643771391,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":13243,"user_name":"æ‰«åœ°åƒ§çš„åŠŸå¤«æ¢¦","can_delete":false,"product_type":"c1","uid":1081053,"ip_address":"","ucode":"3B775474594BC3","user_header":"https://static001.geekbang.org/account/avatar/00/10/7e/dd/e4e6718a.jpg","comment_is_top":false,"comment_ctime":1529465674,"is_pvip":false,"discussion_count":1,"race_medal":0,"score":"14414367562","product_id":100006701,"comment_content":"è°¢è°¢è€å¸ˆçš„å›å¤ï¼Œè¿˜æ˜¯notify()&#47;notifyAll()é—®é¢˜ï¼Œæˆ‘æƒ³è¯´çš„æ˜¯è¢«å”¤é†’çš„çº¿ç¨‹å†é‡æ–°è·å–é”ä¹‹å‰åº”è¯¥æ˜¯é˜»å¡çŠ¶æ€å§ã€‚","like_count":3,"discussions":[{"author":{"id":1320592,"avatar":"https://static001.geekbang.org/account/avatar/00/14/26/90/f68608f3.jpg","nickname":"gwl","note":"","ucode":"24F334E9AC0313","race_medal":0,"user_type":1,"is_pvip":true},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":281933,"discussion_content":"https://www.zhihu.com/question/27654579\næ¨èä½ çœ‹ä¸‹è¿™é‡Œç¬¬ä¸€ä¸ªçš„å›¾","likes_number":1,"is_delete":false,"is_hidden":false,"ctime":1591844115,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":267472,"user_name":"SugarZh","can_delete":false,"product_type":"c1","uid":1198302,"ip_address":"","ucode":"5312F3B5DB671A","user_header":"https://static001.geekbang.org/account/avatar/00/12/48/de/bebd1bf6.jpg","comment_is_top":false,"comment_ctime":1607760365,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"10197694957","product_id":100006701,"comment_content":"CountDownLatchå…¶å®æœ‰ç‚¹ç±»ä¼¼goè¯­è¨€ä¸­çš„WaitGroupï¼Œéƒ½æ˜¯ç­‰å¾…æ‰€æœ‰çº¿ç¨‹éƒ½æ‰§è¡Œå®Œï¼Œæ‰ä¼šæ‰§è¡Œåç»­åŠ¨ä½œ","like_count":2},{"had_liked":false,"id":150286,"user_name":"Paul Shan","can_delete":false,"product_type":"c1","uid":1593140,"ip_address":"","ucode":"32D99989028284","user_header":"","comment_is_top":false,"comment_ctime":1573506540,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"10163441132","product_id":100006701,"comment_content":"semaphoreä¸»è¦æ˜¯é›†ä¸­å¤„ç†acquire&#47;releaseï¼Œæ§åˆ¶è¿›å…¥å…³é”®åŒºåŸŸçš„è®¿é—®è€…ä¸ªæ•°ã€‚<br>å…¸å‹ç”¨æ³•ä¸€ï¼Œsemaphoreåˆå§‹åŒ–ä¸º5,è¡¨ç¤ºå¯ä»¥æœ‰ 5ä½è®¿é—®è€…å¯ä»¥è¿›å…¥å…³é”®åŒºåŸŸï¼Œæ¯ä½è®¿é—®è€…è°ƒç”¨acquireè·å¾—è¿›å…¥å…³é”®åŒºåŸŸçš„èµ„æ ¼ï¼Œä¹Ÿå°±æ˜¯è¿›å…¥æˆ–ç­‰å¾…ã€‚è¿›å…¥å…³é”®åŒºçš„è®¿é—®è€…è®¿é—®è€…è°ƒç”¨releaseï¼Œé‡Šæ”¾ä¸€ä¸ªå‡†å…¥èµ„æ ¼ï¼Œå…¶ä»–ç­‰å¾…ä¸­çš„ä¸€ä¸ªè®¿é—®è€…ä¼šè¢«å”¤é†’è·å‡†è¿›å…¥å…³é”®åŒºåŸŸã€‚<br>å…¸å‹ç”¨æ³•äºŒï¼Œsemaphoreåˆå§‹åŒ–ä¸º0,è¡¨ç¤ºè·å–è®¿é—®èµ„æ ¼çš„è®¿é—®è€…ä¸€å¼€å§‹å¤„äºç­‰å¾…çŠ¶æ€ï¼Œç„¶åé€šè¿‡release(5)æ‰¹é‡é‡Šæ”¾è®¿é—®è€…è¿›å…¥å…³é”®åŒºåŸŸ ï¼Œç„¶åæ£€æŸ¥å…³é”®åŒºåŸŸæ˜¯å¦ä¸ºç©ºï¼Œå†ç¡®å®šæ˜¯å¦æ”¾ä¸‹ä¸€æ‰¹è®¿é—®è€…è¿›å…¥ã€‚<br>","like_count":3},{"had_liked":false,"id":13337,"user_name":"zjh","can_delete":false,"product_type":"c1","uid":1125747,"ip_address":"","ucode":"3AB3862247BEF9","user_header":"","comment_is_top":false,"comment_ctime":1529544150,"is_pvip":false,"replies":[{"id":"4504","content":"ä¸é”™","user_name":"ä½œè€…å›å¤","user_name_real":"æ¨æ™“å³°","uid":"1009360","ctime":1529627839,"ip_address":"","comment_id":13337,"utype":1}],"discussion_count":1,"race_medal":0,"score":"10119478742","product_id":100006701,"comment_content":"æ„Ÿè§‰å†åˆ†å¸ƒå¼çš„æƒ…å†µä¸‹ï¼Œå•ä½“åº”ç”¨ä¸­éœ€è¦å¤šä¸ªçº¿ç¨‹å¹¶è¡Œçš„æƒ…å†µå¯èƒ½ä¼šè¢«åˆ†æ•£åœ¨å¤šä¸ªåº”ç”¨é‡Œé¢ï¼Œå¯èƒ½å¾ˆå°‘ä¼šç”¨åˆ°CountDownLatchå’Œcyclicbarrierï¼Œsemaphoreå€’æ˜¯æ¯”è¾ƒé€‚åˆç”¨åœ¨åˆ†å¸ƒå¼çš„åœºæ™¯ä¸‹ï¼Œç”¨æ¥åšä¸€äº›é™æµã€‚<br><br>","like_count":2,"discussions":[{"author":{"id":1009360,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/66/d0/6541f1d5.jpg","nickname":"æ¨æ™“å³°","note":"","ucode":"2BF255467A978F","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":419616,"discussion_content":"ä¸é”™","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1529627839,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":168058,"user_name":"å¤©ç‹","can_delete":false,"product_type":"c1","uid":1239337,"ip_address":"","ucode":"C074B2F9A5F007","user_header":"https://static001.geekbang.org/account/avatar/00/12/e9/29/629d9bb0.jpg","comment_is_top":false,"comment_ctime":1578009136,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"5872976432","product_id":100006701,"comment_content":"19 javaå¹¶å‘åŒ…æä¾›äº†å“ªäº›å·¥å…·ç±» 1 Java.util.concurrentåŠå…¶å­åŒ…ï¼ŒåŒ…å«äº†javaçš„å„ç§å¹¶å‘å·¥å…·ç±» 1.1 æä¾›äº†æ¯”synchronizedæ›´é«˜çº§çš„åŒæ­¥ç»“æ„ ï¼ŒåŒ…æ‹¬CountDownLatchï¼ŒCyclicBarrierï¼ŒSemaphoreï¼Œå¯ä»¥å®ç°æ›´åŠ ä¸°å¯Œçš„çº¿ç¨‹æ“ä½œ 1.2  å„ç§çº¿ç¨‹å®‰å…¨çš„å®¹å™¨ ConcurrentHashMapï¼ŒConcurrentSkipListMapï¼Œçº¿ç¨‹å®‰å…¨çš„æ•°ç»„ CopyOnWriteArrayList 1.3 å„ç§å¹¶å‘é˜Ÿåˆ—BlockingQueueå®ç° ï¼Œæ¯”å¦‚ArrayBlockingQueueï¼ŒSynchronousQueueæˆ–é’ˆå¯¹ç‰¹å®šåœºæ™¯çš„PriorityBlockingQueueï¼Œ1.4 å¼ºå¤§çš„executoræ¡†æ¶ï¼Œå¯ä»¥åˆ›å»ºä¸åŒç±»å‹çš„çº¿ç¨‹æ± å’Œè°ƒåº¦ä»»åŠ¡ï¼Œä¸ç”¨è‡ªå·±åˆ›å»ºã€‚2 å¹¶å‘ç±»çš„å®é™…åº”ç”¨ CountDownLatch å…è®¸ä¸€ä¸ªæˆ–è€…å¤šä¸ªçº¿ç¨‹ç­‰å¾…æŸäº›æ“ä½œå®Œæˆï¼ŒCyclicBarrierï¼Œå…è®¸å¤šä¸ªçº¿ç¨‹ç­‰å¾…è¾¾åˆ°æŸä¸ªå±éšœ ï¼ŒSemphore javaç‰ˆæœ¬çš„ä¿¡å·é‡å®ç°ï¼Œ2.1 Semphoreé€šè¿‡é™åˆ¶ä¸€å®šæ•°é‡çš„å¤šä¸ªpermitçš„æ–¹å¼ï¼Œæ¥è¾¾åˆ°é™åˆ¶ç»Ÿä¸€èµ„æºè®¿é—®çš„ç›®çš„ï¼ŒSemphoreæ˜¯é€šè¿‡acquireå’Œreleaseï¼Œå¦‚æœåˆå§‹å€¼è®¾ç½®ä¸º1ï¼Œåˆ™1ä¸ªçº¿ç¨‹é€šè¿‡acquireè¿›å…¥äº’æ–¥çŠ¶æ€ï¼Œ2.2 CountDownLatchå’ŒCyclicBarrieråŒºåˆ« CountDownLatchæ˜¯ä¸å¯ä»¥è¢«é‡ç½®çš„ï¼ŒCuclicBarrierå¯ä»¥è¢«é‡ç½®ï¼ŒCountDownLatchçš„åŸºæœ¬æ“ä½œç»„åˆæ˜¯countdown&#47;awaitï¼Œè°ƒç”¨ awaitçš„çº¿ç¨‹é˜»å¡ç­‰å¾…countDownè¶³å¤Ÿçš„æ¬¡æ•°ï¼Œä¸ç®¡ä¸€ä¸ªè¿˜æ˜¯å¤šä¸ªçº¿ç¨‹ï¼Œè¶³å¤Ÿçš„æ¬¡æ•°å³å¯ã€‚CyclicBarrierçš„ç»„åˆå°±æ˜¯awaitï¼Œå½“æ‰€æœ‰çš„ä¼™ä¼´éƒ½è°ƒç”¨å®Œäº†awaitï¼Œæ‰ä¼šç»§ç»­è¿›è¡Œä»»åŠ¡ï¼Œå¹¶è¿›è¡Œé‡ç½®ã€‚CyclicBarrier ä¾§é‡çš„æ˜¯çº¿ç¨‹ï¼Œå…¸å‹åº”ç”¨åœºæ™¯æ˜¯ç­‰å¾…æ¯”å¹¶å‘çº¿ç¨‹ç»“æŸã€‚Cyclicååº”çš„æ˜¯çº¿ç¨‹å¹¶å‘è¿è¡Œæ—¶çš„åè°ƒ","like_count":2},{"had_liked":false,"id":82130,"user_name":"QQæ€ª","can_delete":false,"product_type":"c1","uid":1211223,"ip_address":"","ucode":"1A39B8433D9208","user_header":"https://static001.geekbang.org/account/avatar/00/12/7b/57/a9b04544.jpg","comment_is_top":false,"comment_ctime":1554127915,"is_pvip":false,"discussion_count":1,"race_medal":0,"score":"5849095211","product_id":100006701,"comment_content":"ä¸€èˆ¬ç”¨CountDownLatchæ¥æé«˜æ¥å£è®¿é—®é€Ÿåº¦ï¼Œä¸çŸ¥é“è¿™æ ·ç¬¦ä¸ç¬¦åˆè§„èŒƒğŸ˜‚ğŸ˜‚ğŸ˜‚","like_count":1,"discussions":[{"author":{"id":1043495,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/ec/27/f708ba52.jpg","nickname":"å†·å¤œé£é›ª","note":"","ucode":"CC01ADAA8DFDFC","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":374852,"discussion_content":"æ€ä¹ˆåšçš„ï¼Ÿ","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1621388557,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":66921,"user_name":"â€¦â€¦","can_delete":false,"product_type":"c1","uid":1116443,"ip_address":"","ucode":"DA4B01EDFA3B1C","user_header":"https://static001.geekbang.org/account/avatar/00/11/09/1b/8665aa89.jpg","comment_is_top":false,"comment_ctime":1550042545,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"5845009841","product_id":100006701,"comment_content":"CyclicBarrierç»“åˆFixedThreadPoolä½¿ç”¨ï¼Œå¦‚æœå±éšœç‚¹å¤šä¸çº¿ç¨‹æ± çº¿ç¨‹æ•°ï¼Œå°†ä¼šå‡ºç°é—®é¢˜ã€‚","like_count":1},{"had_liked":false,"id":18621,"user_name":"clz1341521","can_delete":false,"product_type":"c1","uid":1179557,"ip_address":"","ucode":"3BDB4AB454C918","user_header":"https://static001.geekbang.org/account/avatar/00/11/ff/a5/eccc7653.jpg","comment_is_top":false,"comment_ctime":1533514735,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"5828482031","product_id":100006701,"comment_content":"æˆ‘çš„åº”ç”¨åœºæ™¯æ˜¯å¼‚æ­¥å‘é€ä¸€å®šæ•°é‡çš„httpæ¶ˆæ¯ï¼Œä¸»çº¿ç¨‹ç­‰å¾… æ‰€æœ‰å‘é€å®Œæ¯•ï¼Œè·å–æ‰€æœ‰çš„å‘é€æˆåŠŸæ•°","like_count":1},{"had_liked":false,"id":18519,"user_name":"æ¨é€¸æ—","can_delete":false,"product_type":"c1","uid":1167233,"ip_address":"","ucode":"4BF3CF3E2F1AC7","user_header":"https://static001.geekbang.org/account/avatar/00/11/cf/81/96f656ef.jpg","comment_is_top":false,"comment_ctime":1533405794,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"5828373090","product_id":100006701,"comment_content":"å¤§ä½¬ï¼Œæˆ‘åœ¨æˆ‘çš„åšå®¢ä¸Šå¯ä»¥å¼•ç”¨ä¸€äº›ä½ å†™çš„ConcurrentHashMapçš„å†…å®¹å—","like_count":1},{"had_liked":false,"id":15148,"user_name":"xinxinğŸ’›","can_delete":false,"product_type":"c1","uid":1120786,"ip_address":"","ucode":"885E23E7ACC1EC","user_header":"https://static001.geekbang.org/account/avatar/00/11/1a/12/71cbb5ec.jpg","comment_is_top":false,"comment_ctime":1530931356,"is_pvip":false,"replies":[{"id":"5327","content":"ä½ æ˜¯ä»€ä¹ˆç‰ˆæœ¬jdkï¼Ÿ","user_name":"ä½œè€…å›å¤","user_name_real":"æ¨æ™“å³°","uid":"1009360","ctime":1531326536,"ip_address":"","comment_id":15148,"utype":1}],"discussion_count":1,"race_medal":0,"score":"5825898652","product_id":100006701,"comment_content":"è€å¸ˆä¸ºä»€ä¹ˆæˆ‘ç”¨ConcurrentHashMapæ‰§è¡Œremoveæ“ä½œçš„æ—¶å€™cpuæ€»æ˜¯è·³å¾—å¾ˆé«˜ï¼Œhashmapå°±è¿˜å¥½æ²¡é‚£ä¹ˆå¤¸å¼ ã€‚ã€‚ç°åœ¨ä¸ºäº†çº¿ç¨‹å®‰å…¨è¿˜æ˜¯ç”¨ConcurrentHashMapï¼Œä½†æ‰§è¡Œremoveæ“ä½œçš„çº¿ç¨‹ä¸€å¤šç»å¸¸å°±å¡æ­»äº†ã€‚","like_count":1,"discussions":[{"author":{"id":1009360,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/66/d0/6541f1d5.jpg","nickname":"æ¨æ™“å³°","note":"","ucode":"2BF255467A978F","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":420256,"discussion_content":"ä½ æ˜¯ä»€ä¹ˆç‰ˆæœ¬jdkï¼Ÿ","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1531326536,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":13690,"user_name":"jacy","can_delete":false,"product_type":"c1","uid":1103456,"ip_address":"","ucode":"0022A8759DDCE6","user_header":"https://static001.geekbang.org/account/avatar/00/10/d6/60/f21b2164.jpg","comment_is_top":false,"comment_ctime":1529930109,"is_pvip":false,"replies":[{"id":"4590","content":"è¿™ä¸ª...ç»éªŒè°ˆä¸ä¸Šï¼Œæˆ‘ä¹Ÿæ²¡è¿™ç»éªŒï¼›æˆ–è€…ä½ å¯ä»¥å¯¹æ¯”äºŒè€…çš„åŒºåˆ«ï¼ŒåŠ æ·±ç†è§£ï¼›<br>ä¸ºä»€ä¹ˆè½¬ï¼Ÿå¸Œæœ›è¾¾åˆ°ä»€ä¹ˆç›®æ ‡ï¼Ÿ","user_name":"ä½œè€…å›å¤","user_name_real":"æ¨æ™“å³°","uid":"1009360","ctime":1529945632,"ip_address":"","comment_id":13690,"utype":1}],"discussion_count":1,"race_medal":1,"score":"5824897405","product_id":100006701,"comment_content":"æ„Ÿè§‰CountDownLatchæœ‰ç‚¹åƒc++ä¸­çš„æ¡ä»¶é”ï¼Œæƒ³é—®ä¸€ä¸‹è€å¸ˆï¼Œå¯å¦ç»™ç‚¹ä»c++è½¬javaçš„å»ºè®®ã€‚","like_count":1,"discussions":[{"author":{"id":1009360,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/66/d0/6541f1d5.jpg","nickname":"æ¨æ™“å³°","note":"","ucode":"2BF255467A978F","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":419726,"discussion_content":"è¿™ä¸ª...ç»éªŒè°ˆä¸ä¸Šï¼Œæˆ‘ä¹Ÿæ²¡è¿™ç»éªŒï¼›æˆ–è€…ä½ å¯ä»¥å¯¹æ¯”äºŒè€…çš„åŒºåˆ«ï¼ŒåŠ æ·±ç†è§£ï¼›\nä¸ºä»€ä¹ˆè½¬ï¼Ÿå¸Œæœ›è¾¾åˆ°ä»€ä¹ˆç›®æ ‡ï¼Ÿ","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1529945632,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":13179,"user_name":"Jerryé“¶é“¶","can_delete":false,"product_type":"c1","uid":1008404,"ip_address":"","ucode":"80DA1172A2360A","user_header":"https://static001.geekbang.org/account/avatar/00/0f/63/14/06eff9a4.jpg","comment_is_top":false,"comment_ctime":1529446379,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"5824413675","product_id":100006701,"comment_content":"å®¢æˆ·ç«¯å¼€å‘ä¸­é‡åˆ°çš„å¹¶å‘åœºæ™¯ä¼šä¸ä¼šæœ‰ç‚¹å°‘ï¼Ÿå¦‚æœå¯¹å¹¶å‘é¢†åŸŸæœ‰æµ“åšçš„å…´è¶£ï¼Œå¯ä»¥å°è¯•è¶…å“ªä¸ªæ–¹å‘è½¬å‹ï¼ˆåˆæˆ–è®¸ä¸éœ€è¦è½¬å‹ï¼Œåªéœ€è¦æ‰¾ä¸€ä¸ªæ–¹å‘æ¥è¿›è¡Œå®è·µï¼‰ï¼Ÿ<br><br>è€å¸ˆè¯¾åç•™çš„é—®é¢˜ï¼Œæˆ‘åœ¨å·¥ä½œä¸­æ²¡æœ‰é‡åˆ°è¿‡ã€‚æˆ‘åœ¨JAVAå¹¶å‘ç¼–ç¨‹å®è·µä¸­äº†è§£åˆ°çš„ä¸€ç§åœºæ™¯æ˜¯ï¼šéœ€è¦æµ‹è¯•Nä¸ªçº¿ç¨‹å¹¶å‘æ‰§è¡ŒæŸä¸ªä»»åŠ¡æ—¶éœ€è¦çš„æ—¶é—´ã€‚","like_count":1},{"had_liked":false,"id":283604,"user_name":"CharlieWong","can_delete":false,"product_type":"c1","uid":1393234,"ip_address":"","ucode":"0299043A439112","user_header":"http://thirdwx.qlogo.cn/mmopen/vi_32/Ko9aHAWDeYicZqElnJEoepIHLTpL8AkeicwQNsIFuZYpKAAkqkYgWmTMyqfQMSXlc5crCQWkpf8CrserhaT9mwsg/132","comment_is_top":false,"comment_ctime":1615855009,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1615855009","product_id":100006701,"comment_content":"åªç”¨è¿‡CountDownLatchæ¥æ¨¡æ‹Ÿæµ‹è¯•å¹¶å‘è°ƒç”¨","like_count":0},{"had_liked":false,"id":229422,"user_name":"å¤§æˆå°Šè€…","can_delete":false,"product_type":"c1","uid":1783367,"ip_address":"","ucode":"42473322052B11","user_header":"https://static001.geekbang.org/account/avatar/00/1b/36/47/8e80082c.jpg","comment_is_top":false,"comment_ctime":1592990189,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1592990189","product_id":100006701,"comment_content":"ä½ ä½¿ç”¨è¿‡ç±»ä¼¼ CountDownLatch çš„åŒæ­¥ç»“æ„è§£å†³å®é™…é—®é¢˜å—ï¼Ÿè°ˆè°ˆä½ çš„ä½¿ç”¨åœºæ™¯å’Œå¿ƒå¾—ã€‚<br>ç­”ï¼šä½¿ç”¨è¿‡ CountDownLatch è¿›è¡Œå¤šçº¿ç¨‹æŸ¥è¯¢æ•°æ®åº“ã€‚ä¸»çº¿ç¨‹New Nä¸ªçº¿ç¨‹å»æ‰§è¡Œä»»åŠ¡ï¼Œç„¶åNä¸ªçº¿ç¨‹çš„æ‰€æœ‰æŸ¥è¯¢ç»“æœæ±‡æ€»åˆ°ä¸€ä¸ªConcurrentLinkedQueueé‡Œé¢ï¼Œæ¯ä¸ªçº¿ç¨‹æ‰§è¡Œå®Œæ¯•åï¼Œéƒ½countDown()ï¼Œä¸»çº¿ç¨‹await()ç­‰å¾…Nä¸ªçº¿ç¨‹å…¨éƒ¨æ‰§è¡Œå®Œæ¯•åï¼Œå†ä½¿ç”¨æŸ¥è¯¢ç»“æœã€‚","like_count":0},{"had_liked":false,"id":192701,"user_name":"æŠ¤çˆ½ä½¿è€…","can_delete":false,"product_type":"c1","uid":1275464,"ip_address":"","ucode":"12DC35DD74671C","user_header":"https://static001.geekbang.org/account/avatar/00/13/76/48/5ab89daa.jpg","comment_is_top":false,"comment_ctime":1584868890,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1584868890","product_id":100006701,"comment_content":"å¾ªç¯æ …æ ","like_count":0},{"had_liked":false,"id":185483,"user_name":"Seven.Linæ¾¤è€¿","can_delete":false,"product_type":"c1","uid":1181192,"ip_address":"","ucode":"4CAB732CD6F149","user_header":"https://static001.geekbang.org/account/avatar/00/12/06/08/855abb02.jpg","comment_is_top":false,"comment_ctime":1583590947,"is_pvip":false,"discussion_count":3,"race_medal":0,"score":"1583590947","product_id":100006701,"comment_content":"CountDownLatchç»“åˆçº¿ç¨‹æ± ä½¿ç”¨çš„æ—¶å€™ä¸€å®šè¦å°å¿ƒï¼Œç‰¹åˆ«æ˜¯å¹¶å‘é‡å¤§äºçº¿ç¨‹æ± å¤§å°çš„æ—¶å€™...åˆ«é—®æˆ‘ä¸ºä»€ä¹ˆçŸ¥é“ğŸ˜­","like_count":0,"discussions":[{"author":{"id":1320592,"avatar":"https://static001.geekbang.org/account/avatar/00/14/26/90/f68608f3.jpg","nickname":"gwl","note":"","ucode":"24F334E9AC0313","race_medal":0,"user_type":1,"is_pvip":true},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":281934,"discussion_content":"å¤§äºçº¿ç¨‹æ± å¤§å°çš„æ—¶å€™å°±ä¼šè¿›å…¥çº¿ç¨‹æ± é˜Ÿåˆ—ï¼Œçº¿åŸå¸‚é˜Ÿåˆ—æ»¡äº†å°±ä¼šå†å¼€çº¿ç¨‹ï¼Œç›´åˆ°çº¿ç¨‹æ± çš„maxSizeã€‚ã€‚ã€‚æ‰€ä»¥æ˜¯ç³»ç»Ÿå´©äº†å—ï¼Ÿ","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1591844260,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":2,"child_discussions":[{"author":{"id":1181192,"avatar":"https://static001.geekbang.org/account/avatar/00/12/06/08/855abb02.jpg","nickname":"Seven.Linæ¾¤è€¿","note":"","ucode":"4CAB732CD6F149","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":1320592,"avatar":"https://static001.geekbang.org/account/avatar/00/14/26/90/f68608f3.jpg","nickname":"gwl","note":"","ucode":"24F334E9AC0313","race_medal":0,"user_type":1,"is_pvip":true},"discussion":{"id":283494,"discussion_content":"ç›´æ¥æ²¡å“åº”äº†","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1592283295,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":281934,"ip_address":""},"score":283494,"extra":""},{"author":{"id":1239696,"avatar":"https://static001.geekbang.org/account/avatar/00/12/ea/90/95b862bc.jpg","nickname":"è¿™æ˜¯æå®¢æ—¶é—´","note":"","ucode":"95EF3B568CAB7B","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":1181192,"avatar":"https://static001.geekbang.org/account/avatar/00/12/06/08/855abb02.jpg","nickname":"Seven.Linæ¾¤è€¿","note":"","ucode":"4CAB732CD6F149","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":577059,"discussion_content":"é€šè¿‡è‡ªå®šä¹‰çº¿ç¨‹æ± èƒ½é¿å…è¿™ä¸ªæƒ…å†µå§\n","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1655905415,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":283494,"ip_address":""},"score":577059,"extra":""}]}]},{"had_liked":false,"id":150038,"user_name":"zaab","can_delete":false,"product_type":"c1","uid":1683063,"ip_address":"","ucode":"EE846895FF0C85","user_header":"http://thirdwx.qlogo.cn/mmopen/vi_32/QYKSUV20DMgBHAPLfgngdw4N8FHRCSBLCJueVRu9Ya1Ba2x4icx70zoVVFOZtG1K6TkHj5CFbuztQhRFyCjWXHQ/132","comment_is_top":false,"comment_ctime":1573451714,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1573451714","product_id":100006701,"comment_content":"CopyOnWriteArrayListä½¿ç”¨çš„æ—¶å€™éœ€è¦æ³¨æ„ï¼Œ å¦‚æœä½¿ç”¨æ™®é€šçš„forå¾ªç¯ï¼Œ å¤šçº¿ç¨‹çš„æƒ…å†µä¸‹ï¼Œ åœ¨forå¾ªç¯çš„æ—¶å€™å¾ˆå¯èƒ½ä¼šè¢«è¯»åˆ°ä¿®æ”¹çš„æ•°æ®ï¼Œ ä½¿ç”¨è¿­ä»£å™¨åˆ™ä¸ä¼šæœ‰è¿™ç§é—®é¢˜ã€‚<br>è¿­ä»£å™¨éƒ¨åˆ†æºç ï¼š<br> public Iterator&lt;E&gt; iterator() {<br>        return new COWIterator&lt;E&gt;(getArray(), 0);<br>    }<br>","like_count":0},{"had_liked":false,"id":136762,"user_name":"å¼ ä¸‰","can_delete":false,"product_type":"c1","uid":1004092,"ip_address":"","ucode":"1155528FAE1546","user_header":"https://static001.geekbang.org/account/avatar/00/0f/52/3c/d6fcb93a.jpg","comment_is_top":false,"comment_ctime":1569504196,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1569504196","product_id":100006701,"comment_content":"CountDownLatchæ˜¯ä¸ºäº†ä¿è¯çº¿ç¨‹é—´çš„é¡ºåºæ‰§è¡Œå§ï¼ŒCyclicBarrieråˆ™æ˜¯çº¿ç¨‹é—´äº’ç›¸ç­‰å¾…ç»“æŸ","like_count":0},{"had_liked":false,"id":89996,"user_name":"å¤šè¥„ä¸¸","can_delete":false,"product_type":"c1","uid":1074310,"ip_address":"","ucode":"1AA1497C5A293C","user_header":"https://static001.geekbang.org/account/avatar/00/10/64/86/f5a9403a.jpg","comment_is_top":false,"comment_ctime":1556360478,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1556360478","product_id":100006701,"comment_content":" mark 1.8æä¾›äº†CompletableFuture ExecutorCompletionService","like_count":0},{"had_liked":false,"id":89780,"user_name":"æœ¨å¤´ç–™ç˜©","can_delete":false,"product_type":"c1","uid":1025529,"ip_address":"","ucode":"FAA5C23F0C4BC3","user_header":"","comment_is_top":false,"comment_ctime":1556263114,"is_pvip":false,"discussion_count":2,"race_medal":0,"score":"1556263114","product_id":100006701,"comment_content":"Javaåˆçº§é€‰æ‰‹æœ‰ä¸€ä¸ªå°ç™½çš„é—®é¢˜è¯·æ•™è€å¸ˆï¼Œå…³äºæ–‡ä¸­æåˆ°çš„CopyOnWriteArrayListçš„addæ–¹æ³•ï¼Œæ—¢ç„¶æ–¹æ³•ä¸­å·²ç»é€šè¿‡synchronizedåŠ é”äº†ï¼ˆæˆ‘çœ‹äº†ä¸‹æºç ï¼Œä½¿ç”¨çš„æ˜¯ReentrankLockåŠ çš„é”ï¼Œå¯èƒ½è·Ÿè€å¸ˆç‰ˆæœ¬ä¸åŒï¼‰ï¼Œé‚£ä¸ºä½•ä¸èƒ½ç›´æ¥æ“ä½œåŸæ•°ç»„è¿˜è¦copyä¸€ä»½æ–°æ•°ç»„å‡ºæ¥å‘¢ï¼Œå¸Œæœ›è€å¸ˆèƒ½çœ‹åˆ°ï¼Œè°¢è°¢~","like_count":0,"discussions":[{"author":{"id":1482665,"avatar":"http://thirdwx.qlogo.cn/mmopen/vi_32/NPfmxlo2j93hOjYoJV54WHYFkeibzibUbRGhGCyicty5NXPx9XKxicZotfmjqhcibUbjJYnW8rLFDatleT2zhyaTlqg/132","nickname":"å°æ°¸","note":"","ucode":"40AB78B21615D5","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":6206,"discussion_content":"å…¶å®ä½ è¯´çš„æ˜¯å¯¹çš„ï¼Œå¦‚æœåªæœ‰ä¸€ä¸ªaddæ–¹æ³•ä¼šå­˜åœ¨å¹¶å‘ä¿®æ”¹ï¼Œå€’æ˜¯æ²¡å¿…è¦copyï¼›ä½†æ˜¯è¿˜æœ‰add,remove,clear,set,å¦å¤–ä¸»è¦è¿˜æœ‰addAll, removeAllè¿™æ ·é‡çš„å¹¶å‘å†™æ“ä½œï¼Œå¦å¤–ä½ å‘ç°è¯»æ“ä½œå¹¶æ²¡æœ‰lockï¼›è¿™æ ·cowæœ‰ç”¨æ­¦ä¹‹åœ°äº†ï¼Œå®ƒèƒ½ä¿è¯å¹¶å‘æƒ…å†µä¸‹å†™æ“ä½œçš„åŒæ—¶ä¸å½±å“è¯»æ“ä½œï¼Œæ‰€è°“çš„è¯»å†™åˆ†ç¦»ï¼Œå†™æ“ä½œæ˜¯äº’æ–¥çš„ï¼Œè¯»æ“ä½œæ˜¯æ— é”çš„ï¼›è¿™ä¸ªä¸œè¥¿æœ¬èº«çš„å®šä½å°±æ˜¯è¯»å¤šå†™å°‘ï¼Œå€¾å‘ä¿è¯è¯»çš„æ€§èƒ½","likes_number":1,"is_delete":false,"is_hidden":false,"ctime":1566786470,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1541386,"avatar":"https://static001.geekbang.org/account/avatar/00/17/85/0a/e564e572.jpg","nickname":"N_H","note":"","ucode":"109B67557AB3CE","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":8339,"discussion_content":"è¿˜æœ‰åœ¨å¾ªç¯éå†çš„æ—¶å€™å¯ä»¥ä¸æŠ›å‡ºå¼‚å¸¸ https://yq.aliyun.com/articles/665359","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1567930285,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":82227,"user_name":"å°ä¼Ÿ","can_delete":false,"product_type":"c1","uid":1359701,"ip_address":"","ucode":"124953423491E2","user_header":"https://static001.geekbang.org/account/avatar/00/14/bf/55/198c6104.jpg","comment_is_top":false,"comment_ctime":1554166406,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1554166406","product_id":100006701,"comment_content":"å…³äºCyclicBarrieræœ‰ä¸ªé—®é¢˜ï¼Œcbåªæœ‰ä¸€ä¸ªawaitæ–¹æ³•æ¥é˜»å¡å·¥ä½œçº¿ç¨‹ï¼Œç›´åˆ°æ‰€æœ‰è§„å®šæ•°é‡çš„å·¥ä½œçº¿ç¨‹éƒ½è¾¾åˆ°awaitã€‚ä½†cbæ˜¯å¦‚ä½•è®¡ç®—å·¥ä½œçº¿ç¨‹è¾¾åˆ°awaitçš„å‘¢ï¼Ÿä¸¾ä¾‹ï¼Œcbçš„partiesè®¾ç½®æˆ4ï¼Œå¯åŠ¨5ä¸ªè°ƒç”¨awaitæ–¹æ³•çš„å·¥ä½œçº¿ç¨‹ï¼Œåº”è¯¥å…¶ä¸­4ä¸ªåˆ°è¾¾awaitä¹‹åå†…å­˜å±éšœå°±è§£é™¤äº†ï¼Œä½†å®é™…ä¸Šçº¿ç¨‹ä¼šä¸€ç›´é˜»å¡ä¸‹å»ï¼Œå°±åƒæ²¡æœ‰æ‰€æœ‰çº¿ç¨‹éƒ½åˆ°è¾¾awaitä¸€æ ·ï¼Œå®é™…çº¿ç¨‹æ•°å¿…é¡»å’Œpartiesä¸€è‡´æ‰èƒ½workã€‚è¿™æ€ä¹ˆç†è§£ï¼Ÿ","like_count":0},{"had_liked":false,"id":71467,"user_name":"å¤©ä½¿æ¢¦æ³ª","can_delete":false,"product_type":"c1","uid":1235750,"ip_address":"","ucode":"782991747DD424","user_header":"https://static001.geekbang.org/account/avatar/00/12/db/26/3c8d68fb.jpg","comment_is_top":false,"comment_ctime":1551347865,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1551347865","product_id":100006701,"comment_content":"å½“éœ€è¦ä¸€æ¬¡æ€§æŠŠå¤§æ‰¹é‡çš„æ•°æ®åŠ è½½åˆ°å†…å­˜æ—¶ï¼Œå°±å¯ä»¥ä½¿ç”¨CountDownLatchåŠ è½½å¤šä¸ªçº¿ç¨‹ï¼ˆåˆ†é¡µåŠ è½½ï¼Œé¡µæ€»é¡µæ•°å°±æ˜¯éœ€è¦çš„çº¿ç¨‹æ ‘ï¼‰ï¼Œç„¶åæŠŠæ¯é¡µçš„è®°å½•æ•°åˆå¹¶åœ¨ä¸€èµ·å°±æ˜¯æ‰€æœ‰çš„æ•°æ®ã€‚","like_count":0},{"had_liked":false,"id":48381,"user_name":"æ”¹åä¸æ¢äºº","can_delete":false,"product_type":"c1","uid":1118242,"ip_address":"","ucode":"7E25577829FA0F","user_header":"https://static001.geekbang.org/account/avatar/00/11/10/22/910f705c.jpg","comment_is_top":false,"comment_ctime":1544432470,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1544432470","product_id":100006701,"comment_content":"ä½¿ç”¨CountDownLatchåšè¿‡ä¸€ä¸ªæ—¥ç»ˆç»Ÿè®¡ç”¨æˆ·æ¯æ—¥äº¤æ˜“é¢çš„åŠŸèƒ½ï¼Œå°†ç”¨æˆ·é€šè¿‡id(longç±»å‹)å–æ¨¡,åˆ†æ­¥åˆ°10ä¸ªçº¿ç¨‹è¿›è¡Œæ“ä½œï¼Œæ‰€æœ‰çº¿ç¨‹æ“ä½œå®Œæ¯•ä»¥åï¼Œå°†ç»“æœæ±‡æ€»å¹¶è¿›è¡Œä¸‹ä¸€æ­¥æ“ä½œã€‚","like_count":0},{"had_liked":false,"id":29900,"user_name":"shen","can_delete":false,"product_type":"c1","uid":1215066,"ip_address":"","ucode":"AE5737B0C7DC4F","user_header":"https://static001.geekbang.org/account/avatar/00/12/8a/5a/b67a82e3.jpg","comment_is_top":false,"comment_ctime":1538584992,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1538584992","product_id":100006701,"comment_content":"CountDownLatchæ¯”è¾ƒå…¸å‹çš„åœºæ™¯å°±æ˜¯å¼‚æ­¥å˜åŒæ­¥ï¼Œzookeeper watchè°ƒç”¨ç­‰å¾…","like_count":0},{"had_liked":false,"id":25231,"user_name":"æ³Šæµ®ç›®","can_delete":false,"product_type":"c1","uid":1067981,"ip_address":"","ucode":"182A7CC2F6BDAB","user_header":"https://static001.geekbang.org/account/avatar/00/10/4b/cd/185e5378.jpg","comment_is_top":false,"comment_ctime":1537274178,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1537274178","product_id":100006701,"comment_content":"é‚£ä¸ªangroidçš„é—®é¢˜ä¸èƒ½é€šè¿‡joinçº¿ç¨‹æ¥è§£å†³å—","like_count":0},{"had_liked":false,"id":22890,"user_name":"æ‰¬ï½","can_delete":false,"product_type":"c1","uid":1208163,"ip_address":"","ucode":"6FA7D8FE188341","user_header":"https://static001.geekbang.org/account/avatar/00/12/6f/63/abb7bfe3.jpg","comment_is_top":false,"comment_ctime":1536023849,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1536023849","product_id":100006701,"comment_content":"CopyOnWriteåœ¨æ›¿æ¢è€æ•°ç»„ä¸­ï¼Œè¯»æ“ä½œä¼šä¸ä¼šå—åˆ°å½±å“ï¼Œè¿­ä»£éå†æ“ä½œä¼šä¸ä¼šå—åˆ°å½±å“ï¼Ÿ","like_count":0},{"had_liked":false,"id":18620,"user_name":"ç§‹å¤©","can_delete":false,"product_type":"c1","uid":1057056,"ip_address":"","ucode":"A7E1D953EF7E17","user_header":"https://static001.geekbang.org/account/avatar/00/10/21/20/1299e137.jpg","comment_is_top":false,"comment_ctime":1533514696,"is_pvip":true,"discussion_count":0,"race_medal":0,"score":"1533514696","product_id":100006701,"comment_content":"éœ€è¦æ·±å…¥å¤šæ¬¡æ•°é˜…è¯»ç†è§£","like_count":0},{"had_liked":false,"id":14844,"user_name":"FKQ","can_delete":false,"product_type":"c1","uid":1118750,"ip_address":"","ucode":"A3F9464D73DC02","user_header":"https://static001.geekbang.org/account/avatar/00/11/12/1e/b5cdff5f.jpg","comment_is_top":false,"comment_ctime":1530697699,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1530697699","product_id":100006701,"comment_content":"Androidä¸­å¤šçº¿ç¨‹ä¸Šä¼ å¤šå¼ å›¾ç‰‡åˆ°é˜¿é‡Œäº‘ï¼Œå°†æ¯ä¸ªçº¿ç¨‹è¿”å›çš„å›¾ç‰‡urlåœ°å€ï¼Œç»„åˆæˆä¸€ä¸ªæ•°ç»„ä¼ ç»™æœåŠ¡ç«¯","like_count":0},{"had_liked":false,"id":13460,"user_name":"Miaozhe","can_delete":false,"product_type":"c1","uid":1113660,"ip_address":"","ucode":"62872E8C138B67","user_header":"https://static001.geekbang.org/account/avatar/00/10/fe/3c/13175251.jpg","comment_is_top":false,"comment_ctime":1529654107,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1529654107","product_id":100006701,"comment_content":"é—®ä¸ªé—®é¢˜ï¼ŒCyclicBarrieråˆå§‹åŒ–çš„Partieså€¼æ˜¯5ï¼Œæœ€åAwaitçš„æ˜¯6ï¼Œè¿™ç§æƒ…å†µä¼šæ˜¯ä»€ä¹ˆæ ·å­ï¼Ÿ","like_count":0},{"had_liked":false,"id":13458,"user_name":"å¦‚é£","can_delete":false,"product_type":"c1","uid":1022124,"ip_address":"","ucode":"368918EC7DD548","user_header":"https://static001.geekbang.org/account/avatar/00/0f/98/ac/c2c4fd82.jpg","comment_is_top":false,"comment_ctime":1529648944,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1529648944","product_id":100006701,"comment_content":"&quot;æä¾›äº†æ¯” synchronized æ›´åŠ é«˜çº§çš„å„ç§åŒæ­¥ç»“æ„ï¼ŒåŒ…æ‹¬ CountDownLatchã€CyclicBarrierã€Sempahore ç­‰ï¼Œå¯ä»¥å®ç°æ›´åŠ ä¸°å¯Œçš„å¤šçº¿ç¨‹æ“ä½œï¼Œæ¯”å¦‚åˆ©ç”¨ Semaphore ä½œä¸ºèµ„æºæ§åˆ¶å™¨ï¼Œé™åˆ¶åŒæ—¶è¿›è¡Œå·¥ä½œçš„çº¿ç¨‹æ•°é‡ã€‚â€ï¼Œå‘ç°ä¸€å¤„æ‹¼å†™é”™è¯¯ï¼Œåœ¨è¿™ä¸€æ®µä¸­ï¼ŒSempahore æ‹¼å†™é”™äº†ï¼Œåº”è¯¥æ˜¯ Semaphoreã€‚","like_count":0},{"had_liked":false,"id":13349,"user_name":"æ­¥ï¼Šäº®","can_delete":false,"product_type":"c1","uid":1005922,"ip_address":"","ucode":"CC3ACC68959BDF","user_header":"https://static001.geekbang.org/account/avatar/00/0f/59/62/954065d4.jpg","comment_is_top":false,"comment_ctime":1529548718,"is_pvip":false,"replies":[{"id":"4508","content":"å“ˆå“ˆï¼Œé‚£ä¸æ˜¯inner class","user_name":"ä½œè€…å›å¤","user_name_real":"æ¨æ™“å³°","uid":"1009360","ctime":1529631146,"ip_address":"","comment_id":13349,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1529548718","product_id":100006701,"comment_content":"SemaphoreWorkerç±»åº”è¯¥ä¸ºstatic","like_count":0,"discussions":[{"author":{"id":1009360,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/66/d0/6541f1d5.jpg","nickname":"æ¨æ™“å³°","note":"","ucode":"2BF255467A978F","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":419619,"discussion_content":"å“ˆå“ˆï¼Œé‚£ä¸æ˜¯inner class","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1529631146,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":13248,"user_name":"è™é£","can_delete":false,"product_type":"c1","uid":1053075,"ip_address":"","ucode":"601B864214C4F8","user_header":"https://static001.geekbang.org/account/avatar/00/10/11/93/8b41390b.jpg","comment_is_top":false,"comment_ctime":1529468189,"is_pvip":true,"discussion_count":0,"race_medal":0,"score":"1529468189","product_id":100006701,"comment_content":"copyonwriteArrayListå¾ªç¯æ’å…¥å¤§é‡æ•°æ®æ—¶ï¼ˆæ¯”å¦‚100ä¸‡ä¸ªï¼‰ æ•ˆç‡å¾ˆä½ï¼Œå› ä¸ºå®ƒå½¢æˆäº†100ä¸‡æ¬¡å¿«ç…§ï¼Œé‚£ä»ç†è®ºä¸Šæ¥è¯´ï¼Œæœ‰æ²¡æœ‰å¯èƒ½å½¢æˆä¸€æ¬¡å¿«ç…§æ’100ä¸‡æ¡æ•°æ®å‘¢ï¼Ÿ","like_count":0}]}