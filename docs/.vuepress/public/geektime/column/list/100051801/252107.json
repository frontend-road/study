{"id":252107,"title":"21 | çŸ¥è¯†ä¸²è®²ï¼ˆä¸Šï¼‰ï¼šå¸¦ä½ å¼€å‘ä¸€ä¸ªä¹¦åº—åº”ç”¨","content":"<p>ä½ å¥½ï¼Œæˆ‘æ˜¯Chronoã€‚</p><p>åˆ°ä»Šå¤©ä¸ºæ­¢ï¼Œè¯¾ç¨‹é‡Œçš„C++çŸ¥è¯†å°±å…¨éƒ¨è®²å®Œäº†ã€‚å‰é¢æˆ‘ä»¬æ€»å…±å­¦ä¹ äº†å››å¤§æ¨¡å—ï¼Œæˆ‘å†å¸¦ä½ åšä¸€ä¸ªç®€ç•¥çš„å›é¡¾ã€‚</p><p>åœ¨â€œæ¦‚è®ºâ€å•å…ƒï¼Œæˆ‘å¸¦ä½ ä»å®è§‚çš„å±‚é¢ä¸Šé‡æ–°è®¤è¯†äº†C++ï¼Œè®²äº†å®ƒçš„å››ä¸ªç”Ÿå‘½å‘¨æœŸå’Œäº”ä¸ªç¼–ç¨‹èŒƒå¼ï¼Œåˆ†åˆ«ä»‹ç»äº†åœ¨ç¼–ç é˜¶æ®µã€é¢„å¤„ç†é˜¶æ®µã€ç¼–è¯‘é˜¶æ®µï¼ŒC++èƒ½å¤Ÿåšå“ªäº›äº‹æƒ…ï¼Œæ¥ç€åˆé‡ç‚¹è¯´äº†åœ¨C++é‡Œï¼Œè¿ç”¨å“ªäº›ç‰¹æ€§æ‰èƒ½æ›´å¥½åœ°å®è·µé¢å‘å¯¹è±¡ç¼–ç¨‹ã€‚</p><p>åœ¨â€œè¯­è¨€ç‰¹æ€§â€å•å…ƒï¼Œæˆ‘ä»¬ä¸€èµ·ç ”ç©¶äº†è‡ªåŠ¨ç±»å‹æ¨å¯¼ã€å¸¸é‡ã€æ™ºèƒ½æŒ‡é’ˆã€å¼‚å¸¸ã€å‡½æ•°å¼ç¼–ç¨‹è¿™äº”ä¸ªç‰¹æ€§ã€‚è¿™äº›ç‰¹æ€§æ˜¯â€œç°ä»£â€C++åŒºåˆ«äºâ€œä¼ ç»Ÿâ€C++çš„å…³é”®ï¼ŒæŒæ¡äº†å®ƒä»¬ï¼Œä½ å°±èƒ½å¤Ÿå†™å‡ºæ¸…æ™°ã€æ˜“è¯»ã€å®‰å…¨çš„ä»£ç ã€‚</p><p>åœ¨â€œæ ‡å‡†åº“â€å•å…ƒï¼Œæˆ‘ä»‹ç»äº†å­—ç¬¦ä¸²ã€å®¹å™¨ã€ç®—æ³•å’Œå¹¶å‘ã€‚å®ƒä»¬æ˜¯C++æ ‡å‡†åº“ä¸­æœ€æ ¸å¿ƒçš„éƒ¨åˆ†ï¼Œä¹Ÿæ˜¯ç°ä»£C++å’Œæ³›å‹ç¼–ç¨‹çš„æœ€ä½³åº”ç”¨å’ŒèŒƒä¾‹ã€‚å­¦ä¼šäº†æ ‡å‡†åº“ï¼Œä½ æ‰èƒ½è¯´æ˜¯çœŸæ­£ç†è§£äº†C++ã€‚</p><p>åœ¨â€œæŠ€èƒ½è¿›é˜¶â€å•å…ƒï¼Œæˆ‘ä¸ºä½ æŒ‘é€‰å‡ºäº†ä¸€äº›ç¬¬ä¸‰æ–¹å·¥å…·ï¼ŒåŒ…æ‹¬åºåˆ—åŒ–ã€ç½‘ç»œé€šä¿¡ã€è„šæœ¬è¯­è¨€å’Œæ€§èƒ½åˆ†æï¼Œå®ƒä»¬å¾ˆå¥½åœ°è¡¥å……å®Œå–„äº†C++è¯­è¨€å’Œæ ‡å‡†åº“ï¼Œå…å»äº†æˆ‘ä»¬â€œè‡ªå·±é€ è½®å­â€çš„éº»çƒ¦ï¼Œè®©æˆ‘ä»¬æŠŠç²¾åŠ›é›†ä¸­åœ¨å®ç°ä¸šåŠ¡é€»è¾‘ä¸Šã€‚</p><p>é™¤äº†ä¸Šé¢çš„è¿™â€œåå…«èˆ¬æ­¦è‰ºâ€ï¼Œæˆ‘è¿˜è°ˆäº†è°ˆèƒ½å¤Ÿå¸®ä½ æ›´å¥½åœ°è¿ç”¨C++çš„è®¾è®¡æ¨¡å¼å’Œè®¾è®¡åŸåˆ™ï¼Œä»‹ç»äº†å‡ ä¸ªæ¯”è¾ƒé‡è¦ã€å¸¸ç”¨çš„æ¨¡å¼ï¼Œå¸Œæœ›ä½ åœ¨ä»Šåçš„å®é™…å¼€å‘å·¥ä½œä¸­ï¼Œèƒ½å¤Ÿæœ‰æ„è¯†åœ°å†™å‡ºçµæ´»ã€å¯æ‰©å±•çš„ä»£ç ã€‚</p><!-- [[[read_end]]] --><p>è¿™ä¹ˆå›é¡¾ä¸‹æ¥ï¼Œå†…å®¹è¿˜çœŸæ˜¯ä¸å°‘å•Šã€‚</p><p>ä¸ºäº†è®©ä½ æ›´å¥½åœ°æŠŠè¿™äº›çŸ¥è¯†èä¼šè´¯é€šï¼Œæ¥ä¸‹æ¥æˆ‘ä¼šå†ç”¨ä¸¤èŠ‚è¯¾çš„æ—¶é—´ï¼Œä»éœ€æ±‚ã€è®¾è®¡ï¼Œåˆ°å¼€å‘ç¼–ç ã€ç¼–è¯‘è¿è¡Œï¼Œå†åŠ ä¸Šä¸€äº›æˆ‘è‡ªå·±çš„å®ç”¨å°æŠ€å·§ï¼Œè¯¦ç»†è®²è§£ä¸€ä¸ªC++ç¨‹åºçš„å®é™…å¼€å‘è¿‡ç¨‹ï¼ŒæŠŠçŸ¥è¯†ç‚¹éƒ½ä¸²è”èµ·æ¥ã€‚</p><p>è™½ç„¶è¯´æ˜¯â€œä¸²è®²â€ï¼Œä½†æ˜¯ä½ åªè¦å­¦è¿‡äº†å‰é¢çš„å†…å®¹ï¼Œå°±å¯ä»¥è·Ÿç€æˆ‘åšå‡ºè¿™ä¸ªä¹¦åº—ç¨‹åºã€‚ä¸è¿‡ï¼Œæˆ‘æ‹…å¿ƒæœ‰äº›çŸ¥è¯†ç‚¹ä½ å¯èƒ½å¿˜è®°äº†ï¼Œæ‰€ä»¥ï¼Œæ¶‰åŠåˆ°å…·ä½“çš„çŸ¥è¯†ç‚¹æ—¶ï¼Œæˆ‘ä¼šç»™ä½ æ ‡æ³¨å‡ºæ˜¯åœ¨å“ªä¸€èŠ‚ï¼Œä½ å¯ä»¥éšæ—¶å›å»å¤ä¹ ä¸€ä¸‹ã€‚</p><h2>é¡¹ç›®è®¾è®¡</h2><p>é‚£ä¹ˆï¼Œè¯¥ç”¨ä¸ªä»€ä¹ˆæ ·çš„ä¾‹å­æ¥ä¸²è®²C++çš„è¿™äº›çŸ¥è¯†ç‚¹å‘¢ï¼Ÿ</p><p>è¯´å®è¯ï¼Œæ‰¾å‡ºä¸€ä¸ªåˆé€‚çš„ä¾‹å­çœŸçš„å¾ˆéš¾ã€‚å› ä¸ºå¤§å¤šæ•°C++å®é™…é¡¹ç›®éƒ½å¾ˆå¤§ã€å¾ˆåº•å±‚ï¼Œè¿˜æœ‰å„ç§ä¾èµ–æˆ–è€…å†…éƒ¨åº“ï¼Œä¸å¥½ç›´æ¥å­¦ä¹ ç ”ç©¶ã€‚</p><p>æ‰€ä»¥æˆ‘å†ä¸‰è€ƒè™‘ï¼Œå†³å®šå€Ÿé‰´ä¸€ä¸‹  <em>C++ Primer</em> é‡Œçš„ä¹¦åº—ä¾‹å­ï¼Œä¿®æ”¹ä¸€ä¸‹å®ƒçš„éœ€æ±‚ï¼Œç„¶åå®Œå…¨é‡æ–°å¼€å‘ï¼Œä½œä¸ºæˆ‘ä»¬è¿™ä¸ªè¯¾ç¨‹çš„ç»¼åˆç¤ºä¾‹ã€‚</p><p>å…ˆä»‹ç»ä¸€ä¸‹å’±ä»¬è¿™ä¸ªä¹¦åº—ç¨‹åºã€‚ç®€å•æ¥è¯´ï¼Œå°±æ˜¯é”€å”®è®°å½•ç®¡ç†ï¼Œä»å¤šä¸ªæ¸ é“æŠŠä¹¦å·ã€é”€å”®å†Œæ•°ã€é”€å”®é¢éƒ½æ±‡æ€»èµ·æ¥ï¼Œåšä¸ªç»Ÿè®¡åˆ†æï¼Œå†æŠŠæ•°æ®å®šæœŸä¸ŠæŠ¥åˆ°åå°ã€‚</p><p><em>C++ Primer</em>  é‡Œçš„ä¹¦åº—ç¨‹åºæ˜¯æœ¬åœ°è¿è¡Œçš„ï¼Œä¸ºäº†æ¼”ç¤ºè¯¾ç¨‹é‡Œè®²åˆ°çš„çš„C++ç‰¹æ€§ï¼Œæˆ‘æŠŠå®ƒæ”¹æˆäº†ç½‘ç»œç‰ˆã€‚ä¸è¿‡ï¼Œæ‹“æ‰‘ç»“æ„å¹¶ä¸å¤æ‚ï¼Œæˆ‘ç”»äº†å¼ å›¾ï¼Œä½ å¯ä»¥çœ‹ä¸€ä¸‹ã€‚</p><p><img src=\"https://static001.geekbang.org/resource/image/62/97/62632ba7426af7731902c83724504097.png?wh=3306*2825\" alt=\"\"></p><p>é¡¹ç›®çš„å‰æœŸéœ€æ±‚å°±ç®—æ˜¯å®šä¸‹æ¥äº†ï¼Œæ¥ç€å°±è¦å¼€å§‹åšè®¾è®¡äº†ï¼Œè¿™å°±è¦ç”¨åˆ°è®¾è®¡æ¨¡å¼å’Œè®¾è®¡åŸåˆ™çš„çŸ¥è¯†äº†ï¼ˆ<a href=\"https://time.geekbang.org/column/article/248880\">ç¬¬19è®²</a>ã€<a href=\"https://time.geekbang.org/column/article/248883\">ç¬¬20è®²</a>ï¼‰ã€‚</p><p>ä¸è¿‡è¿™ä¸ªç³»ç»Ÿè¿˜æ˜¯æ¯”è¾ƒç®€å•çš„ï¼Œä¸éœ€è¦ç”¨ä»€ä¹ˆå¤æ‚çš„åˆ†ææ‰‹æ®µï¼Œå°±èƒ½å¤Ÿå¾—å‡ºè®¾è®¡ï¼Œä¸»è¦åº”ç”¨çš„æ˜¯å•ä¸€èŒè´£åŸåˆ™ã€æ¥å£éš”ç¦»åŸåˆ™å’ŒåŒ…è£…å¤–è§‚æ¨¡å¼ã€‚è¿™é‡Œæˆ‘ä¹Ÿç”»äº†ä¸€ä¸ªUMLå›¾ï¼Œå¯ä»¥å¸®åŠ©ä½ ç†è§£ç¨‹åºçš„æ¶æ„ã€‚</p><p><img src=\"https://static001.geekbang.org/resource/image/f0/ef/f08637cf6b49316c230d058cb2a9f5ef.jpg?wh=792*525\" alt=\"\"></p><p>ä¸‹é¢æˆ‘å°±å¯¹ç…§è¿™ä¸ªUMLç±»å›¾ï¼Œç»“åˆå¼€å‘æ€è·¯å’Œæºç ï¼Œä»”ç»†è¯´ä¸€ä¸‹å…·ä½“çš„C++å¼€å‘ï¼Œå®Œæ•´çš„æºç éƒ½æ”¾åœ¨äº†<a href=\"https://github.com/chronolaw/cpp_study/tree/master/section5\">GitHub</a>ä¸Šï¼Œè¯¾ä¸‹å¯ä»¥ä»”ç»†åœ°çœ‹ä¸€ä¸‹ã€‚</p><h2>æ ¸å¿ƒå¤´æ–‡ä»¶</h2><p>é¦–å…ˆè¦è¯´çš„æ˜¯æˆ‘å†™C++é¡¹ç›®çš„ä¸€ä¸ªä¹ æƒ¯ï¼Œå®šä¹‰æ ¸å¿ƒå¤´æ–‡ä»¶ï¼š<strong>cpplang.hpp</strong>ã€‚å®ƒé›†ä¸­äº†C++æ ‡å‡†å¤´å’Œè¯­è¨€ç›¸å…³çš„å®šä¹‰ï¼Œè¢«ç”¨äºå…¶ä»–æ‰€æœ‰çš„æºæ–‡ä»¶ã€‚</p><p>æ³¨æ„ï¼Œåœ¨å†™å®ƒçš„æ—¶å€™ï¼Œæœ€å¥½è¦æœ‰æ–‡ä»¶å¤´æ³¨é‡Šï¼ˆ<a href=\"https://time.geekbang.org/column/article/233689\">ç¬¬2è®²</a>ï¼‰ï¼Œè€Œä¸”è¦æœ‰â€œInclude guardâ€ï¼ˆ<a href=\"https://time.geekbang.org/column/article/233711\">ç¬¬3è®²</a>ï¼‰ï¼Œå°±åƒä¸‹é¢è¿™æ ·ï¼š</p><pre><code>// Copyright (c) 2020 by Chrono\n\n#ifndef _CPP_LANG_HPP        // Include guard\n#define _CPP_LANG_HPP        // Include guard\n\n#include &lt;cassert&gt;           // C++æ ‡å‡†å¤´æ–‡ä»¶\n...\n\n#endif  //_CPP_LANG_HPP\n</code></pre><p>åœ¨æ ¸å¿ƒå¤´æ–‡ä»¶é‡Œï¼Œæˆ‘ä»¬è¿˜å¯ä»¥åˆ©ç”¨é¢„å¤„ç†ç¼–ç¨‹ï¼Œä½¿ç”¨å®å®šä¹‰ã€æ¡ä»¶ç¼–è¯‘æ¥å±è”½æ“ä½œç³»ç»Ÿã€è¯­è¨€ç‰ˆæœ¬çš„å·®å¼‚ï¼Œå¢å¼ºç¨‹åºçš„å…¼å®¹æ€§ã€‚</p><p>æ¯”å¦‚ï¼Œè¿™é‡Œæˆ‘å°±æ£€æŸ¥äº†C++çš„ç‰ˆæœ¬å·ï¼Œç„¶åå®šä¹‰äº†ç®€åŒ–ç‰ˆçš„â€œdeprecatedâ€å’Œâ€œstatic_assertâ€ï¼š</p><pre><code>// must be C++11 or later\n#if __cplusplus &lt; 201103\n#   error &quot;C++ is too old&quot;\n#endif  // __cplusplus &lt; 201103\n\n// [[deprecated]]\n#if __cplusplus &gt;= 201402\n#   define  CPP_DEPRECATED [[deprecated]]\n#else\n#   define  CPP_DEPRECATED [[gnu::deprecated]]\n#endif  // __cplusplus &gt;= 201402\n\n// static_assert\n#if __cpp_static_assert &gt;= 201411\n#   define STATIC_ASSERT(x) static_assert(x)\n#else\n#   define STATIC_ASSERT(x) static_assert(x, #x)\n#endif\n</code></pre><h2>è‡ªæ—‹é”</h2><p>æœ‰äº†æ ¸å¿ƒå¤´æ–‡ä»¶ä¹‹åï¼Œæˆ‘ä»¬çš„C++ç¨‹åºå°±æœ‰äº†ä¸€ä¸ªå¾ˆå¥½çš„èµ·ç‚¹ï¼Œå°±å¯ä»¥è€ƒè™‘å¼•å…¥å¤šçº¿ç¨‹ï¼Œæé«˜ååé‡ï¼Œå‡å°‘é˜»å¡ã€‚</p><p>åœ¨å¤šçº¿ç¨‹é‡Œä¿æŠ¤æ•°æ®ä¸€èˆ¬è¦ç”¨åˆ°äº’æ–¥é‡ï¼ˆMutexï¼‰ï¼Œä½†å®ƒçš„ä»£ä»·å¤ªé«˜ï¼Œæ‰€ä»¥æˆ‘è®¾è®¡äº†ä¸€ä¸ªè‡ªæ—‹é”ï¼Œå®ƒä½¿ç”¨äº†åŸå­å˜é‡ï¼Œæ‰€ä»¥æˆæœ¬ä½ï¼Œæ•ˆç‡é«˜ï¼ˆ<a href=\"https://time.geekbang.org/column/article/245259\">ç¬¬14è®²</a>ï¼‰ã€‚</p><p>è‡ªæ—‹é”è¢«å°è£…ä¸ºä¸€ä¸ªSpinLockç±»ï¼Œæ‰€ä»¥å°±è¦éµå¾ªä¸€äº›C++é‡Œå¸¸ç”¨çš„é¢å‘å¯¹è±¡çš„è®¾è®¡å‡†åˆ™ï¼ˆ<a href=\"https://time.geekbang.org/column/article/235301\">ç¬¬5è®²</a>ã€<a href=\"https://time.geekbang.org/column/article/248880\">ç¬¬19è®²</a>ï¼‰ï¼Œæ¯”å¦‚ç”¨finalç¦æ­¢ç»§æ‰¿ã€ç”¨default/deleteæ˜¾å¼æ ‡è®°æ„é€ /ææ„å‡½æ•°ã€æˆå‘˜å˜é‡åˆå§‹åŒ–ã€ç±»å‹åˆ«åï¼Œç­‰ç­‰ï¼Œä½ å¯ä»¥çœ‹çœ‹ä»£ç ï¼š</p><pre><code>class SpinLock final                        // è‡ªæ—‹é”ç±»\n{\npublic:\n    using this_type   = SpinLock;          // ç±»å‹åˆ«å\n    using atomic_type = std::atomic_flag;\npublic:\n    SpinLock() = default;                 // é»˜è®¤æ„é€ å‡½æ•°\n   ~SpinLock() = default;\n\n    SpinLock(const this_type&amp;) = delete;  // ç¦æ­¢æ‹·è´\n    SpinLock&amp; operator=(const this_type&amp;) = delete;\nprivate:\n    atomic_type m_lock {false};            // æˆå‘˜å˜é‡åˆå§‹åŒ–\n};\n</code></pre><p>åœ¨ç¼–å†™æˆå‘˜å‡½æ•°çš„æ—¶å€™ï¼Œä¸ºäº†å°½é‡é«˜æ•ˆï¼Œéœ€è¦ç»™å‡½æ•°éƒ½åŠ ä¸Šnoexceptä¿®é¥°ï¼Œè¡¨ç¤ºç»ä¸ä¼šæŠ›å‡ºå¼‚å¸¸ï¼ˆ<a href=\"https://time.geekbang.org/column/article/240292\">ç¬¬9è®²</a>ï¼‰ï¼š</p><pre><code>public:\n  void lock() noexcept              // è‡ªæ—‹é”å®šï¼Œç»ä¸æŠ›å‡ºå¼‚å¸¸\n  {\n    for(;;) {                      // æ— é™å¾ªç¯\n      if (!m_lock.test_and_set()) { // åŸå­å˜é‡çš„TASæ“ä½œ\n          return;                  // TASæˆåŠŸåˆ™é”å®š\n      }\n      std::this_thread::yield();   // TASå¤±è´¥åˆ™è®©å‡ºçº¿ç¨‹\n    }\n  }\n\n  void unlock() noexcept           // è§£é™¤è‡ªæ—‹é”å®šï¼Œç»ä¸æŠ›å‡ºå¼‚å¸¸\n  {\n    m_lock.clear();\n  }\n</code></pre><p>ä¸ºäº†ä¿è¯å¼‚å¸¸å®‰å…¨ï¼Œåœ¨ä»»ä½•æ—¶å€™éƒ½ä¸ä¼šæ­»é”ï¼Œè¿˜éœ€è¦åˆ©ç”¨RAIIæŠ€æœ¯å†ç¼–å†™ä¸€ä¸ªLockGuardç±»ã€‚å®ƒåœ¨æ„é€ æ—¶é”å®šï¼Œåœ¨ææ„æ—¶è§£é”ï¼Œè¿™ä¸¤ä¸ªå‡½æ•°ä¹Ÿåº”è¯¥ç”¨noexceptæ¥ä¼˜åŒ–ï¼š</p><pre><code>class SpinLockGuard final                      // è‡ªæ—‹é”RAIIç±»ï¼Œè‡ªåŠ¨è§£é”\n{\npublic:\n    using this_type      = SpinLockGuard;      // ç±»å‹åˆ«å\n    using spin_lock_type = SpinLock;\npublic:\n    SpinLockGuard(const this_type&amp;) = delete;  // ç¦æ­¢æ‹·è´\n    SpinLockGuard&amp; operator=(const this_type&amp;) = delete;\npublic:\n    SpinLockGuard(spin_lock_type&amp; lock) noexcept\n        : m_lock(lock)\n    {\n        m_lock.lock();\n    }\n\n   ~SpinLockGuard() noexcept\n   {\n       m_lock.unlock();\n   }\nprivate:\n    spin_lock_type&amp; m_lock;\n};\n</code></pre><p>è¿™æ ·è‡ªæ—‹é”å°±å®Œæˆäº†ï¼Œæœ‰äº†å®ƒå°±å¯ä»¥åœ¨å¤šçº¿ç¨‹åº”ç”¨é‡Œä¿æŠ¤å…±äº«çš„æ•°æ®ï¼Œé¿å…æ•°æ®ç«äº‰ã€‚</p><h2>ç½‘ç»œé€šä¿¡</h2><p>è‡ªæ—‹é”æ¯”è¾ƒç®€å•ï¼Œä½†å¤šçº¿ç¨‹åªæ˜¯ä¹¦åº—ç¨‹åºçš„åŸºæœ¬ç‰¹æ€§ï¼Œå®ƒçš„æ ¸å¿ƒå…³é”®è¯æ˜¯â€œç½‘ç»œâ€ï¼Œæ‰€ä»¥ä¸‹é¢å°±æ¥çœ‹çœ‹æœåŠ¡é‡Œçš„â€œé‡å¤´â€éƒ¨åˆ†ï¼šç½‘ç»œé€šä¿¡ã€‚</p><p>æ­£å¦‚æˆ‘ä¹‹å‰è¯´çš„ï¼Œåœ¨ç°ä»£C++é‡Œï¼Œåº”å½“é¿å…ç›´æ¥ä½¿ç”¨åŸç”ŸSocketæ¥ç¼–å†™ç½‘ç»œé€šä¿¡ç¨‹åºï¼ˆ<a href=\"https://time.geekbang.org/column/article/245900\">ç¬¬16è®²</a>ï¼‰ã€‚è¿™é‡Œæˆ‘é€‰æ‹©ZMQä½œä¸ºåº•å±‚é€šä¿¡åº“ï¼Œå®ƒä¸ä»…æ–¹ä¾¿æ˜“ç”¨ï¼Œè€Œä¸”èƒ½å¤Ÿä¿è¯æ¶ˆæ¯ä¸ä¸¢å¤±ã€å®Œæ•´å¯é åœ°é€è¾¾ç›®çš„åœ°ã€‚</p><p>ç¨‹åºé‡Œä½¿ç”¨ZmqContextç±»æ¥å°è£…åº•å±‚æ¥å£ï¼ˆåŒ…è£…å¤–è§‚ï¼‰ï¼Œå®ƒæ˜¯ä¸€ä¸ªæ¨¡æ¿ç±»ï¼Œæ•´æ•°æ¨¡æ¿å‚æ•°ç”¨æ¥æŒ‡å®šçº¿ç¨‹æ•°ï¼Œåœ¨ç¼–è¯‘é˜¶æ®µå°±å›ºå®šäº†ZMQçš„å¤šçº¿ç¨‹å¤„ç†èƒ½åŠ›ã€‚</p><p>å¯¹äºZMQå¿…éœ€çš„è¿è¡Œç¯å¢ƒå˜é‡ï¼ˆå•ä»¶ï¼‰ï¼Œæˆ‘ä½¿ç”¨äº†ä¸€ä¸ªå°æŠ€å·§ï¼š<strong>ä»¥é™æ€æˆå‘˜å‡½æ•°æ¥ä»£æ›¿é™æ€æˆå‘˜å˜é‡</strong>ã€‚è¿™æ ·å°±ç»•è¿‡äº†C++çš„è¯­è¨€é™åˆ¶ï¼Œä¸å¿…åœ¨å®ç°æ–‡ä»¶â€œ*.cppâ€é‡Œå†å†™ä¸€éå˜é‡å®šä¹‰ï¼Œå…¨éƒ¨çš„ä»£ç éƒ½å¯ä»¥é›†ä¸­åœ¨hppå¤´æ–‡ä»¶é‡Œï¼š</p><pre><code>template&lt;int thread_num = 1&gt;        // ä½¿ç”¨æ•´æ•°æ¨¡æ¿å‚æ•°æ¥æŒ‡å®šçº¿ç¨‹æ•°\nclass ZmqContext final\n{\npublic:\n    static                          // é™æ€æˆå‘˜å‡½æ•°ä»£æ›¿é™æ€æˆå‘˜å˜é‡\n    zmq_context_type&amp; context()\n    {\n        static zmq_context_type ctx(thread_num);\n        return ctx;\n    }\n};\n</code></pre><p>ç„¶åï¼Œæˆ‘ä»¬è¦å®ç°ä¸¤ä¸ªé™æ€å·¥å‚å‡½æ•°ï¼Œåˆ›å»ºæ”¶å‘æ•°æ®çš„Socketå¯¹è±¡ã€‚</p><p>è¿™é‡Œè¦æ³¨æ„ï¼Œå¦‚æœä½ çœ‹zmq.hppçš„æºç ï¼Œå°±ä¼šå‘ç°ï¼Œå®ƒçš„å†…éƒ¨å®é™…ä¸Šæ˜¯ä½¿ç”¨äº†å¼‚å¸¸æ¥å¤„ç†é”™è¯¯çš„ã€‚æ‰€ä»¥ï¼Œè¿™é‡Œæˆ‘ä»¬ä¸èƒ½åœ¨å‡½æ•°åé¢åŠ ä¸Šnoexceptä¿®é¥°ï¼ŒåŒæ—¶ä¹Ÿå°±æ„å‘³ç€ï¼Œåœ¨ä½¿ç”¨ZMQçš„æ—¶å€™ï¼Œå¿…é¡»è¦è€ƒè™‘å¼‚å¸¸å¤„ç†ã€‚</p><pre><code>public: \n  static\n  zmq_socket_type recv_sock(int hwm = 1000)    // åˆ›å»ºæ¥æ”¶Socket\n  {\n    zmq_socket_type sock(context(), ZMQ_PULL); // å¯èƒ½æŠ›å‡ºå¼‚å¸¸\n    \n    sock.setsockopt(ZMQ_RCVHWM, hwm);\n\n    return sock;\n  }\n\n  static\n  zmq_socket_type send_sock(int hwm = 1000)   // åˆ›å»ºå‘é€Socket\n  {\n    zmq_socket_type sock(context(), ZMQ_PUSH); // å¯èƒ½æŠ›å‡ºå¼‚å¸¸\n\n    sock.setsockopt(ZMQ_SNDHWM, hwm);\n\n    return sock;\n  }\n</code></pre><p>ç°åœ¨ï¼Œæœ‰äº†ZmqContextç±»ï¼Œä¹¦åº—ç¨‹åºçš„ç½‘ç»œåŸºç¡€ä¹Ÿå°±æ­å»ºå‡ºæ¥äº†ï¼Œåé¢å°±å¯ä»¥ç”¨å®ƒæ¥æ”¶å‘æ•°æ®äº†ã€‚</p><h2>é…ç½®æ–‡ä»¶è§£æ</h2><p>æ¥ä¸‹æ¥ï¼Œæˆ‘è¦è¯´çš„æ˜¯è§£æé…ç½®æ–‡ä»¶çš„ç±»Configã€‚</p><p>å¤§å¤šæ•°ç¨‹åºéƒ½ä¼šç”¨åˆ°é…ç½®æ–‡ä»¶æ¥ä¿å­˜è¿è¡Œæ—¶çš„å„ç§å‚æ•°ï¼Œå¸¸è§çš„æ ¼å¼æœ‰INIã€XMLã€JSONï¼Œç­‰ç­‰ã€‚ä½†æˆ‘é€šå¸¸ä¼šé€‰æ‹©æŠŠLuaåµŒå…¥C++ï¼Œç”¨Luaè„šæœ¬å†™é…ç½®æ–‡ä»¶ï¼ˆ<a href=\"https://time.geekbang.org/column/article/242603\">ç¬¬17è®²</a>ï¼‰ã€‚</p><p>è¿™ä¹ˆåšçš„å¥½å¤„åœ¨å“ªé‡Œå‘¢ï¼Ÿ</p><p>Luaæ˜¯ä¸€ä¸ªå®Œå¤‡çš„ç¼–ç¨‹è¯­è¨€ï¼Œæ‰€ä»¥å†™èµ·æ¥å°±éå¸¸è‡ªç”±çµæ´»ï¼Œæ¯”å¦‚æ·»åŠ ä»»æ„çš„æ³¨é‡Šï¼Œæ•°å­—å¯ä»¥å†™æˆâ€œm Ã— nâ€çš„è¿ç®—å½¢å¼ã€‚è€ŒINIã€XMLè¿™äº›é…ç½®æ ¼å¼åªæ˜¯çº¯ç²¹çš„æ•°æ®ï¼Œå¾ˆéš¾åšåˆ°è¿™æ ·ï¼Œå¾ˆå¤šæ—¶å€™éœ€è¦åœ¨ç¨‹åºé‡Œåšä¸€äº›è½¬æ¢å·¥ä½œã€‚</p><p>å¦å¤–ï¼Œåœ¨Luaè„šæœ¬é‡Œï¼Œæˆ‘ä»¬è¿˜èƒ½åŸºäºLuaç¯å¢ƒå†™ä¸€äº›å‡½æ•°ï¼Œæ ¡éªŒæ•°æ®çš„æœ‰æ•ˆæ€§ï¼Œæˆ–è€…é‡‡é›†ç³»ç»Ÿä¿¡æ¯ï¼Œå®ç°åŠ¨æ€é…ç½®ã€‚</p><p>æ€»è€Œè¨€ä¹‹ï¼Œå°±æ˜¯æŠŠLuaå½“ä½œä¸€ä¸ªâ€œå¯ç¼–ç¨‹çš„é…ç½®è¯­è¨€â€ï¼Œè®©é…ç½®â€œæ´»èµ·æ¥â€ã€‚</p><p>ç»™ä½ çœ‹ä¸€ä¸‹é…ç½®æ–‡ä»¶çš„ä»£ç å§ï¼Œé‡Œé¢åŒ…å«äº†å‡ ä¸ªç®€å•çš„å€¼ï¼Œé…ç½®äº†æœåŠ¡å™¨çš„åœ°å€ã€æ—¶é—´é—´éš”ã€ç¼“å†²åŒºå¤§å°ç­‰ä¿¡æ¯ï¼š</p><pre><code>config = {\n\n    -- should be same as client\n    -- you could change it to ipc\n    zmq_ipc_addr = &quot;tcp://127.0.0.1:5555&quot;,\n\n    -- see http_study's lua code\n    http_addr = &quot;http://localhost/cpp_study?token=cpp@2020&quot;,\n\n    time_interval = 5,  -- seconds\n\n    max_buf_size = 4 * 1024,\n}\n</code></pre><p>Configç±»ä½¿ç”¨shared_ptræ¥ç®¡ç†Luaè™šæ‹Ÿæœºï¼ˆ<a href=\"https://time.geekbang.org/column/article/245905\">ç¬¬17è®²</a>ï¼‰ï¼Œå› ä¸ºå°è£…åœ¨ç±»é‡Œï¼Œæ‰€ä»¥ï¼Œä½ è¦æ³¨æ„ç±»å‹åˆ«åå’Œæˆå‘˜å˜é‡åˆå§‹åŒ–çš„ç”¨æ³•ï¼ˆ<a href=\"https://time.geekbang.org/column/article/235301\">ç¬¬5è®²</a>ï¼‰ï¼š</p><pre><code>class Config final                  // å°è£…è¯»å–Luaé…ç½®æ–‡ä»¶\n{\npublic:\n    using vm_type      = std::shared_ptr&lt;lua_State&gt;;   // ç±»å‹åˆ«å\n    using value_type   = luabridge::LuaRef;\npublic:\n    Config() noexcept               // æ„é€ å‡½æ•°\n    {\n        assert(m_vm);\n        luaL_openlibs(m_vm.get());  // æ‰“å¼€LuaåŸºæœ¬åº“\n    }\n   ~Config() = default;             // é»˜è®¤ææ„å‡½æ•°\nprivate:\n    vm_type     m_vm                 // ç±»å‹åˆ«åå®šä¹‰Luaè™šæ‹Ÿæœº\n      {luaL_newstate(), lua_close};  // æˆå‘˜å˜é‡åˆå§‹åŒ–\n};\n</code></pre><p>åŠ è½½Luaè„šæœ¬çš„æ—¶å€™è¿˜è¦æ³¨æ„ä¸€ç‚¹ï¼Œå¤–éƒ¨çš„è„šæœ¬æœ‰å¯èƒ½ä¼šå†™é”™ï¼Œå¯¼è‡´Luaè§£æå¤±è´¥ã€‚ä½†å› ä¸ºè¿™ä¸ªé—®é¢˜æå°‘å‡ºç°ï¼Œè€Œä¸”ä¸€å‡ºç°å°±å¾ˆä¸¥é‡ï¼Œæ²¡æœ‰é…ç½®å°±æ— æ³•èµ°åç»­çš„æµç¨‹ï¼Œæ‰€ä»¥éå¸¸é€‚åˆç”¨å¼‚å¸¸æ¥å¤„ç†ï¼ˆ<a href=\"https://time.geekbang.org/column/article/240292\">ç¬¬9è®²</a>ï¼‰ã€‚</p><p>load()å‡½æ•°ä¸ä¼šæ”¹å˜è™šæ‹Ÿæœºæˆå‘˜å˜é‡ï¼Œæ‰€ä»¥åº”è¯¥ç”¨constä¿®é¥°ï¼Œæ˜¯ä¸€ä¸ªå¸¸å‡½æ•°ï¼š</p><pre><code>public:\n  void load(string_view_type filename) const  // è§£æé…ç½®æ–‡ä»¶\n  {\n    auto status = luaL_dofile(m_vm.get(), filename.c_str());\n\n    if (status != 0) {                       // å‡ºé”™å°±æŠ›å‡ºå¼‚å¸¸\n        throw std::runtime_error(&quot;failed to parse config&quot;);\n    }\n  }\n</code></pre><p>ä¸ºäº†è®¿é—®Luaé…ç½®æ–‡ä»¶é‡Œçš„å€¼ï¼Œæˆ‘å†³å®šé‡‡ç”¨â€œkey1.key2â€è¿™æ ·ç®€å•çš„ä¸¤çº§å½¢å¼ï¼Œæœ‰ç‚¹åƒINIçš„å°èŠ‚ï¼Œè¿™ä¹Ÿæ­£å¥½å¯¹åº”Luaé‡Œçš„è¡¨ç»“æ„ã€‚</p><p>æƒ³è¦è§£æå‡ºå­—ç¬¦ä¸²é‡Œçš„å‰åä¸¤ä¸ªkeyï¼Œå¯ä»¥ä½¿ç”¨æ­£åˆ™è¡¨è¾¾å¼ï¼ˆ<a href=\"https://time.geekbang.org/column/article/242603\">ç¬¬11è®²</a>ï¼‰ï¼Œç„¶åå†å»æŸ¥è¯¢Luaè¡¨ã€‚</p><p>å› ä¸ºæ„é€ æ­£åˆ™è¡¨è¾¾å¼çš„æˆæœ¬å¾ˆé«˜ï¼Œæ‰€ä»¥æˆ‘æŠŠæ­£åˆ™å¯¹è±¡éƒ½å®šä¹‰ä¸ºæˆå‘˜å˜é‡ï¼Œè€Œä¸æ˜¯å‡½æ•°é‡Œçš„å±€éƒ¨å˜é‡ã€‚</p><p>æ­£åˆ™çš„åŒ¹é…ç»“æœï¼ˆm_whatï¼‰æ˜¯â€œä¸´æ—¶â€çš„ï¼Œä¸ä¼šå½±å“å¸¸é‡æ€§ï¼Œæ‰€ä»¥è¦ç»™å®ƒåŠ ä¸Šmutableä¿®é¥°ã€‚</p><pre><code>private:\n  const   regex_type  m_reg {R&quot;(^(\\w+)\\.(\\w+)$)&quot;};\n  mutable match_type  m_what;              // æ³¨æ„æ˜¯mutable\n</code></pre><p>åœ¨C++æ­£åˆ™åº“çš„å¸®åŠ©ä¸‹ï¼Œå¤„ç†å­—ç¬¦ä¸²å°±å¤ªè½»æ¾äº†ï¼Œæ‹¿åˆ°ä¸¤ä¸ªkeyï¼Œå†è°ƒç”¨LuaBridgeå°±å¯ä»¥è·å¾—Luaè„šæœ¬é‡Œçš„é…ç½®é¡¹ã€‚</p><p>ä¸è¿‡ï¼Œä¸ºäº†è¿›ä¸€æ­¥ç®€åŒ–å®¢æˆ·ä»£ç ï¼Œæˆ‘æŠŠget()å‡½æ•°æ”¹æˆäº†æ¨¡æ¿å‡½æ•°ï¼Œæ˜¾å¼è½¬æ¢æˆintã€stringç­‰C++æ ‡å‡†ç±»å‹ï¼Œå¯è¯»æ€§ã€å¯ç»´æŠ¤æ€§ä¼šæ›´å¥½ã€‚</p><pre><code>public:\n  template&lt;typename T&gt;                    // è½¬æ¢é…ç½®å€¼çš„ç±»å‹\n  T get(string_view_type key) const      // constå¸¸å‡½æ•°\n  {\n    if (!std::regex_match(key, m_what, m_reg)) {  // æ­£åˆ™åŒ¹é…\n        throw std::runtime_error(&quot;config key error&quot;);// æ ¼å¼é”™è¯¯æŠ›å¼‚å¸¸\n    }\n\n    auto w1 = m_what[1].str();            // å–å‡ºä¸¤ä¸ªkey\n    auto w2 = m_what[2].str();\n\n    auto v = getGlobal(                  // è·å–Luaè¡¨\n                m_vm.get(), w1.c_str());\n\n    return LuaRef_cast&lt;T&gt;(v[w2]);        // å–è¡¨é‡Œçš„å€¼ï¼Œå†åšç±»å‹è½¬æ¢\n  }\n</code></pre><p>åˆ°è¿™é‡Œå‘¢ï¼ŒConfigç±»ä¹Ÿå°±å®Œæˆäº†ï¼Œå¯ä»¥è½»æ¾è§£æLuaæ ¼å¼çš„é…ç½®æ–‡ä»¶ã€‚</p><h2>å°ç»“</h2><p>ä»Šå¤©ï¼Œæˆ‘ç”¨ä¸€ä¸ªä¹¦åº—ç¨‹åºä½œä¸ºä¾‹å­ï¼ŒæŠŠå‰é¢çš„çŸ¥è¯†ç‚¹éƒ½ä¸²è”èµ·æ¥ï¼Œåº”ç”¨åˆ°äº†è¿™ä¸ªâ€œåŠçœŸå®â€çš„é¡¹ç›®é‡Œï¼Œå®Œæˆäº†UMLç±»å›¾é‡Œçš„å¤–å›´éƒ¨åˆ†ã€‚ä½ ä¹Ÿå¯ä»¥æŠŠåˆšæ‰è¯´çš„æ ¸å¿ƒå¤´æ–‡ä»¶ã€è‡ªæ—‹é”ã€Luaé…ç½®æ–‡ä»¶è¿™äº›ç”¨æ³•æ”¾åˆ°è‡ªå·±çš„å®é™…é¡¹ç›®é‡Œå»è¯•è¯•ã€‚</p><p>ç®€å•å°ç»“ä¸€ä¸‹ä»Šå¤©çš„å†…å®¹ï¼š</p><ol>\n<li>åœ¨é¡¹ç›®èµ·å§‹é˜¶æ®µï¼Œåº”è¯¥è®¤çœŸåšéœ€æ±‚åˆ†æï¼Œç„¶ååº”ç”¨è®¾è®¡æ¨¡å¼å’Œè®¾è®¡åŸåˆ™ï¼Œå¾—å‡ºçµæ´»ã€å¯æ‰©å±•çš„é¢å‘å¯¹è±¡ç³»ç»Ÿï¼›</li>\n<li>C++é¡¹ç›®é‡Œæœ€å¥½è¦æœ‰ä¸€ä¸ªæ ¸å¿ƒå¤´æ–‡ä»¶ï¼ˆcpplang.hppï¼‰ï¼Œé›†ä¸­å®šä¹‰æ‰€æœ‰æ ‡å‡†å¤´å’Œè¯­è¨€ç‰¹æ€§ï¼Œè§„èŒƒæºæ–‡ä»¶é‡Œçš„C++ä½¿ç”¨æ–¹å¼ï¼›</li>\n<li>ä½¿ç”¨åŸå­å˜é‡ï¼ˆatomicï¼‰å¯ä»¥å®ç°è‡ªæ—‹é”ï¼Œæ¯”äº’æ–¥é‡çš„æˆæœ¬è¦ä½ï¼Œæ›´é«˜æ•ˆï¼›</li>\n<li>ä½¿ç”¨ZMQå¯ä»¥ç®€åŒ–ç½‘ç»œé€šä¿¡ï¼Œä½†è¦æ³¨æ„å®ƒä½¿ç”¨äº†å¼‚å¸¸æ¥å¤„ç†é”™è¯¯ï¼›</li>\n<li>ä½¿ç”¨Luaè„šæœ¬ä½œä¸ºé…ç½®æ–‡ä»¶çš„å¥½å¤„å¾ˆå¤šï¼Œæ˜¯â€œå¯ç¼–ç¨‹çš„é…ç½®æ–‡ä»¶â€ï¼›</li>\n<li>åœ¨ç¼–å†™ä»£ç æ—¶è¦ç†è§£ã€ç”¨å¥½C++ç‰¹æ€§ï¼Œæ°å½“åœ°ä½¿ç”¨finalã€defaultã€constç­‰å…³é”®å­—ï¼Œè®©ä»£ç æ›´å®‰å…¨ã€æ›´å¯è¯»ï¼Œæœ‰åˆ©äºå°†æ¥çš„ç»´æŠ¤ã€‚</li>\n</ol><p>ä»Šå¤©ï¼Œæˆ‘ä»¬åˆ†æäº†éœ€æ±‚ï¼Œè®¾è®¡å‡ºäº†æ¶æ„ï¼Œå¼€å‘äº†ä¸€äº›å·¥å…·ç±»ï¼Œä½†è¿˜æ²¡æœ‰æ¶‰åŠä¸šåŠ¡é€»è¾‘ä»£ç ï¼Œä¸‹èŠ‚è¯¾ï¼Œæˆ‘ä¼šå¸¦ä½ çœ‹çœ‹å®¹å™¨ã€ç®—æ³•ã€çº¿ç¨‹ï¼Œè¿˜æœ‰lambdaè¡¨è¾¾å¼çš„å®è·µåº”ç”¨ï¼Œçœ‹çœ‹å®ƒä»¬æ˜¯æ€ä¹ˆæœåŠ¡äºå…·ä½“ä¸šåŠ¡çš„ã€‚</p><h2>è¯¾ä¸‹ä½œä¸š</h2><p>æœ€åæ˜¯è¯¾ä¸‹ä½œä¸šæ—¶é—´ï¼Œç»™ä½ ç•™ä¸€ä¸ªæ€è€ƒé¢˜ï¼šä½ èƒ½è¯´å‡ºï¼Œç¨‹åºé‡Œæ˜¯æ€ä¹ˆåº”ç”¨è®¾è®¡æ¨¡å¼å’Œè®¾è®¡åŸåˆ™çš„å—ï¼Ÿ</p><p>æ¬¢è¿ä½ åœ¨ç•™è¨€åŒºå†™ä¸‹ä½ çš„æ€è€ƒå’Œç­”æ¡ˆï¼Œå¦‚æœè§‰å¾—ä»Šå¤©çš„å†…å®¹å¯¹ä½ æœ‰æ‰€å¸®åŠ©ï¼Œä¹Ÿæ¬¢è¿åˆ†äº«ç»™ä½ çš„æœ‹å‹ã€‚æˆ‘ä»¬ä¸‹èŠ‚è¯¾è§ã€‚</p><p><img src=\"https://static001.geekbang.org/resource/image/9b/e9/9b2d2c8285643a9202d822639fffe8e9.png?wh=3000*2795\" alt=\"\"></p>","neighbors":{"left":{"article_title":"20 | è®¾è®¡æ¨¡å¼ï¼ˆä¸‹ï¼‰ï¼šC++æ˜¯æ€ä¹ˆåº”ç”¨è®¾è®¡æ¨¡å¼çš„ï¼Ÿ","id":248883},"right":{"article_title":"22 | çŸ¥è¯†ä¸²è®²ï¼ˆä¸‹ï¼‰ï¼šå¸¦ä½ å¼€å‘ä¸€ä¸ªä¹¦åº—åº”ç”¨","id":252118}},"comments":[{"had_liked":false,"id":229745,"user_name":"yadandan","can_delete":false,"product_type":"c1","uid":1015510,"ip_address":"","ucode":"E81B3151E34D13","user_header":"http://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTJ0ZckW8sqfW8lyWuge29zK8cQ6nY57SQqpwicPEOibicbgOLDX554xHa6OafsSeojRNy5V3wvbTibG6g/132","comment_is_top":false,"comment_ctime":1593136427,"is_pvip":false,"replies":[{"id":"84769","content":"C++è¦æ±‚é™æ€æˆå‘˜å˜é‡å¿…é¡»åœ¨cppæ–‡ä»¶é‡Œå®šä¹‰å®ç°ï¼Œå¤´æ–‡ä»¶é‡Œåªæ˜¯å£°æ˜ã€‚<br><br>è€Œåœ¨é™æ€æˆå‘˜å‡½æ•°é‡Œå£°æ˜é™æ€å˜é‡ï¼Œå†ä»¥å‡½æ•°è¿”å›å€¼çš„å½¢å¼æ¥ä½¿ç”¨ï¼Œå°±ä¸éœ€è¦åœ¨cppé‡Œé‡å¤å†™ä¸€éï¼Œåªè¦åœ¨å¤´æ–‡ä»¶é‡Œå†™å°±è¡Œäº†ã€‚<br><br>è¯¾ç¨‹çš„ç¤ºä¾‹ä»£ç å°±æ˜¯è¿™æ ·çš„ï¼Œä½ ä¹Ÿå¯ä»¥è‡ªå·±æ¨¡ä»¿ç€è¯•ä¸€ä¸‹ï¼Œç”¨é™æ€æˆå‘˜å‡½æ•°ä»£æ›¿é™æ€æˆå‘˜å˜é‡ã€‚","user_name":"ä½œè€…å›å¤","user_name_real":"ç½—å‰‘é”‹","uid":"1181974","ctime":1593138414,"ip_address":"","comment_id":229745,"utype":1}],"discussion_count":3,"race_medal":0,"score":"57427711275","product_id":100051801,"comment_content":"è€å¸ˆæ‚¨å¥½ï¼Œâ€œè¿™æ ·å°±ç»•è¿‡äº† C++ çš„è¯­è¨€é™åˆ¶ï¼Œä¸å¿…åœ¨å®ç°æ–‡ä»¶â€œ*.cppâ€é‡Œå†å†™ä¸€éå˜é‡å®šä¹‰ï¼Œå…¨éƒ¨çš„ä»£ç éƒ½å¯ä»¥é›†ä¸­åœ¨ hpp å¤´æ–‡ä»¶é‡Œâ€ï¼Œè¿™å¥è¯æ€ä¹ˆç†è§£ï¼Œèƒ½ä¸¾ä¸ªä¾‹å­å—ï¼Ÿ","like_count":13,"discussions":[{"author":{"id":1181974,"avatar":"https://static001.geekbang.org/account/avatar/00/12/09/16/1161017c.jpg","nickname":"ç½—å‰‘é”‹","note":"","ucode":"95678C988F24AB","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":499623,"discussion_content":"C++è¦æ±‚é™æ€æˆå‘˜å˜é‡å¿…é¡»åœ¨cppæ–‡ä»¶é‡Œå®šä¹‰å®ç°ï¼Œå¤´æ–‡ä»¶é‡Œåªæ˜¯å£°æ˜ã€‚\n\nè€Œåœ¨é™æ€æˆå‘˜å‡½æ•°é‡Œå£°æ˜é™æ€å˜é‡ï¼Œå†ä»¥å‡½æ•°è¿”å›å€¼çš„å½¢å¼æ¥ä½¿ç”¨ï¼Œå°±ä¸éœ€è¦åœ¨cppé‡Œé‡å¤å†™ä¸€éï¼Œåªè¦åœ¨å¤´æ–‡ä»¶é‡Œå†™å°±è¡Œäº†ã€‚\n\nè¯¾ç¨‹çš„ç¤ºä¾‹ä»£ç å°±æ˜¯è¿™æ ·çš„ï¼Œä½ ä¹Ÿå¯ä»¥è‡ªå·±æ¨¡ä»¿ç€è¯•ä¸€ä¸‹ï¼Œç”¨é™æ€æˆå‘˜å‡½æ•°ä»£æ›¿é™æ€æˆå‘˜å˜é‡ã€‚","likes_number":2,"is_delete":false,"is_hidden":false,"ctime":1593138414,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1421242,"avatar":"https://static001.geekbang.org/account/avatar/00/15/af/ba/62fac9e1.jpg","nickname":"ç¾½æ›¦","note":"","ucode":"9767ECB4F8F201","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":564461,"discussion_content":"C++è¦æ±‚é™æ€æˆå‘˜å˜é‡å¿…é¡»åœ¨cppæ–‡ä»¶é‡Œå®šä¹‰å®ç°ï¼Œå¤´æ–‡ä»¶é‡Œåªæ˜¯å£°æ˜ã€‚","likes_number":1,"is_delete":false,"is_hidden":false,"ctime":1650250479,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1015510,"avatar":"http://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTJ0ZckW8sqfW8lyWuge29zK8cQ6nY57SQqpwicPEOibicbgOLDX554xHa6OafsSeojRNy5V3wvbTibG6g/132","nickname":"yadandan","note":"","ucode":"E81B3151E34D13","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":287777,"discussion_content":"è°¢è°¢è€å¸ˆè€å¿ƒè§£ç­”ï¼","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1593531965,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":228997,"user_name":"reverse","can_delete":false,"product_type":"c1","uid":1240138,"ip_address":"","ucode":"0B546E540DF096","user_header":"https://static001.geekbang.org/account/avatar/00/12/ec/4a/40a2ba79.jpg","comment_is_top":false,"comment_ctime":1592877286,"is_pvip":false,"replies":[{"id":"84432","content":"umlå…¶å®å¹¶ä¸éš¾ï¼Œä¹Ÿæ²¡æœ‰å¿…è¦å®Œå…¨å­¦é€šå­¦ç²¾ï¼Œæœ¬è´¨ä¸Šå°±æ˜¯ä¸ªç”»å›¾ã€‚<br><br>å…ˆå­¦ä¼šæœ€åŸºæœ¬çš„ç±»å›¾ã€æ—¶åºå›¾ï¼Œå…¶ä»–çš„å¯ä»¥åœ¨å®è·µä¸­æ…¢æ…¢å­¦ã€‚","user_name":"ä½œè€…å›å¤","user_name_real":"ç½—å‰‘é”‹","uid":"1181974","ctime":1592878539,"ip_address":"","comment_id":228997,"utype":1}],"discussion_count":2,"race_medal":0,"score":"44542550246","product_id":100051801,"comment_content":"å…³äºUMLå›¾ æƒ³å­¦çš„åŒå­¦å¯ä»¥çœ‹ä¸€ä¸‹ã€ŠUMLå¤§è±¡ã€‹","like_count":10,"discussions":[{"author":{"id":1181974,"avatar":"https://static001.geekbang.org/account/avatar/00/12/09/16/1161017c.jpg","nickname":"ç½—å‰‘é”‹","note":"","ucode":"95678C988F24AB","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":499290,"discussion_content":"umlå…¶å®å¹¶ä¸éš¾ï¼Œä¹Ÿæ²¡æœ‰å¿…è¦å®Œå…¨å­¦é€šå­¦ç²¾ï¼Œæœ¬è´¨ä¸Šå°±æ˜¯ä¸ªç”»å›¾ã€‚\n\nå…ˆå­¦ä¼šæœ€åŸºæœ¬çš„ç±»å›¾ã€æ—¶åºå›¾ï¼Œå…¶ä»–çš„å¯ä»¥åœ¨å®è·µä¸­æ…¢æ…¢å­¦ã€‚","likes_number":1,"is_delete":false,"is_hidden":false,"ctime":1592878539,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1240138,"avatar":"https://static001.geekbang.org/account/avatar/00/12/ec/4a/40a2ba79.jpg","nickname":"reverse","note":"","ucode":"0B546E540DF096","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":285609,"discussion_content":"æ´»å­¦æ´»ç”¨æœ€é‡è¦ï¼Œ å¦‚æœæœ‰åŒå­¦æƒ³æ·±å…¥å­¦ä¹  ï¼Œå¯ä»¥å¤§è‡´ä¸Šçœ‹ä¸€ä¸‹ä¸»è¦çš„éƒ¨åˆ†ï¼Œå°±åƒè€å¸ˆè¯´çš„é‚£æ ·ï¼ˆï¿£ãƒ¼ï¿£ï¼‰ãƒ~~ãƒâ˜†â€™.ãƒ».ãƒ»:â˜…å—¯å“¼","likes_number":1,"is_delete":false,"is_hidden":false,"ctime":1592892052,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":229482,"user_name":"K. D.","can_delete":false,"product_type":"c1","uid":1914230,"ip_address":"","ucode":"7A1EC6B64D1EAF","user_header":"https://static001.geekbang.org/account/avatar/00/1d/35/76/951b0daf.jpg","comment_is_top":false,"comment_ctime":1593010786,"is_pvip":false,"replies":[{"id":"84726","content":"ä½ ç†è§£çš„å¾ˆå¯¹ï¼Œä¸¤è€…çš„åŒºåˆ«å°±åœ¨è¿™é‡Œï¼Œè‡ªæ—‹é”çš„å¥½å¤„æ˜¯ä¸ä¼šè®©å‡ºcpuï¼Œbusy waitingï¼Œè¿™åœ¨å°ç­‰å¾…æ—¶çš„ä»£ä»·å°±æ¯”è¾ƒä½ï¼Œå¯ä»¥å……åˆ†åˆ©ç”¨cpuã€‚è€Œmutexä¼šè®©çº¿ç¨‹sleepï¼Œæš‚æ—¶è®©å‡ºcpuç»™å…¶ä»–çº¿ç¨‹ï¼Œè¿™å°±æœ‰ç‚¹æµªè´¹ã€‚<br><br>å…·ä½“è¯¥ç”¨å“ªä¸ªè¿˜æ˜¯è¦çœ‹åº”ç”¨åœºæ™¯ï¼Œåœ¨è¿™é‡Œæˆ‘ç”¨è‡ªæ—‹é”åªæ˜¯ä¸ºäº†æ¼”ç¤ºatomicçš„ç”¨æ³•ã€‚","user_name":"ä½œè€…å›å¤","user_name_real":"ç½—å‰‘é”‹","uid":"1181974","ctime":1593047574,"ip_address":"","comment_id":229482,"utype":1}],"discussion_count":3,"race_medal":0,"score":"27362814562","product_id":100051801,"comment_content":"è€å¸ˆä½ å¥½ï¼Œæˆ‘ä¸Šç½‘æŸ¥äº†ä¸€ä¸‹spin lockï¼ˆè‡ªæ—‹é”ï¼‰å’Œmutexï¼ˆäº’æ–¥é”ï¼‰çš„åŒºåˆ«ï¼Œè‡ªæ—‹é”æ˜¯ä¼šè®©çº¿ç¨‹busy waitingï¼Œè€Œäº’æ–¥é”åˆ™æ˜¯è®©çº¿ç¨‹sleepï¼Œä»cpuçš„å ç”¨è§’åº¦ï¼Œæ˜¯å¦sleepæ˜¯æ›´å¥½çš„ï¼Ÿbusy waitingæ„Ÿè§‰æ›´åŠ cpu intensiveã€‚","like_count":7,"discussions":[{"author":{"id":1181974,"avatar":"https://static001.geekbang.org/account/avatar/00/12/09/16/1161017c.jpg","nickname":"ç½—å‰‘é”‹","note":"","ucode":"95678C988F24AB","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":499500,"discussion_content":"ä½ ç†è§£çš„å¾ˆå¯¹ï¼Œä¸¤è€…çš„åŒºåˆ«å°±åœ¨è¿™é‡Œï¼Œè‡ªæ—‹é”çš„å¥½å¤„æ˜¯ä¸ä¼šè®©å‡ºcpuï¼Œbusy waitingï¼Œè¿™åœ¨å°ç­‰å¾…æ—¶çš„ä»£ä»·å°±æ¯”è¾ƒä½ï¼Œå¯ä»¥å……åˆ†åˆ©ç”¨cpuã€‚è€Œmutexä¼šè®©çº¿ç¨‹sleepï¼Œæš‚æ—¶è®©å‡ºcpuç»™å…¶ä»–çº¿ç¨‹ï¼Œè¿™å°±æœ‰ç‚¹æµªè´¹ã€‚\n\nå…·ä½“è¯¥ç”¨å“ªä¸ªè¿˜æ˜¯è¦çœ‹åº”ç”¨åœºæ™¯ï¼Œåœ¨è¿™é‡Œæˆ‘ç”¨è‡ªæ—‹é”åªæ˜¯ä¸ºäº†æ¼”ç¤ºatomicçš„ç”¨æ³•ã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1593047574,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1628867,"avatar":"http://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTIicr82CnrdEjibibAvyeKRQHszSzIAqoCWxN0kqC442XcjEae6S9j6NDtKLpg4Da4CUQQeUFUicWqiaDw/132","nickname":"æœ‰å­¦è¯†çš„å…”å­","note":"","ucode":"D1D654B1562FC9","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":286156,"discussion_content":"å¯¹è‡ªæ—‹é”å’Œäº’æ–¥é”ï¼Œæˆ‘ä¹Ÿæœ‰ç±»ä¼¼çš„ç–‘é—®ã€‚\næˆ‘è§‰å¾—é™¤äº†ä¸Šè¿°å› ç´ å¤–ï¼Œè¿˜å¾—æŠŠç³»ç»Ÿçš„çº¿ç¨‹è°ƒåº¦ç¨‹åºè€ƒè™‘è¿›æ¥ï¼Œè™½ç„¶è‡ªæ—‹é”ä¼šä½¿å¾—çº¿ç¨‹ä¸ºäº†é”ä¸åœåœ°è½®è¯¢ï¼Œä½†å½“è¯¥çº¿ç¨‹çš„è¢«è°ƒåº¦ç¨‹åºåˆ†é…æ—¶é—´ç‰‡è€—å°½æ—¶ï¼Œè°ƒåº¦ç¨‹åºä¼šåˆ‡æ¢è¯¥çº¿ç¨‹ï¼Œä¸è‡³äºcpuåªä¸ºè¯¥çº¿ç¨‹å·¥ä½œè€Œé˜»å¡å…¶ä»–çº¿ç¨‹çš„å·¥ä½œã€‚å› æ­¤ï¼Œå‡ºç°è¿™ç§æƒ…å†µï¼Œå¸¦æ¥çš„è´Ÿé¢å½±å“æ˜¯æœ‰é™çš„ã€‚","likes_number":1,"is_delete":false,"is_hidden":false,"ctime":1593076599,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":1,"child_discussions":[{"author":{"id":2417723,"avatar":"https://static001.geekbang.org/account/avatar/00/24/e4/3b/f1b9d6bf.jpg","nickname":"è”¡ä¿Šè´¤","note":"","ucode":"A856D094E3F4A3","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":1628867,"avatar":"http://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTIicr82CnrdEjibibAvyeKRQHszSzIAqoCWxN0kqC442XcjEae6S9j6NDtKLpg4Da4CUQQeUFUicWqiaDw/132","nickname":"æœ‰å­¦è¯†çš„å…”å­","note":"","ucode":"D1D654B1562FC9","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":388212,"discussion_content":"å¹¶å‘æ•°é‡é«˜ä¸”ç­‰å¾…æ—¶é—´é•¿çš„æ—¶å€™è‡ªæ—‹é”å¯¹cpuçš„æ¶ˆè€—å°±æ¯”è¾ƒå¯è§‚äº†ï¼Œä¸€ä¸ªçº¿ç¨‹çš„æ—¶é—´ç‰‡åˆ°äº†å°±åˆ‡æ¢åˆ°å…¶ä»–çº¿ç¨‹å»è‡ªæ—‹ï¼Œæ€»çš„æ¥çœ‹ä¸€å¤§å †çº¿ç¨‹éƒ½åœ¨è‡ªæ—‹ï¼Œå…¶ä»–ä»»åŠ¡çš„è®¡ç®—èµ„æºå°±ä¼šå—åˆ°æŒ¤å…‘","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1628656505,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":286156,"ip_address":""},"score":388212,"extra":""}]}]},{"had_liked":false,"id":228958,"user_name":"æ³¡æ³¡é¾™","can_delete":false,"product_type":"c1","uid":1208655,"ip_address":"","ucode":"8D43010FA3DC2C","user_header":"https://static001.geekbang.org/account/avatar/00/12/71/4f/bce0d5bc.jpg","comment_is_top":false,"comment_ctime":1592870098,"is_pvip":true,"replies":[{"id":"84412","content":"<br>1.è¿™ä¸ªå°±æ˜¯åŸºæœ¬çš„éœ€æ±‚åˆ†æäº†ï¼Œç®€å•æ¥è¯´ï¼Œå°±æ˜¯æå–å‡ºéœ€æ±‚é‡Œçš„åè¯å’ŒåŠ¨è¯ï¼Œè½¬åŒ–æˆç›¸åº”çš„ç±»ï¼Œæ¯”å¦‚é”€å”®è®°å½•ã€é…ç½®æ–‡ä»¶ã€é”ã€XXä¸»å¾ªç¯ã€‚<br><br>2.UMLå›¾æœ‰å¾ˆå¤šç§ï¼Œè¿™é‡Œç”¨åˆ°çš„æ˜¯ç±»å›¾ï¼Œè¡¨ç¤ºçš„æ˜¯ç±»ä¹‹é—´çš„å…³ç³»ï¼Œéœ€è¦ç†è§£UMLçš„åŸºæœ¬è¯­è¨€è¦ç´ ï¼Œæ¯”å¦‚èšåˆã€è”ç³»ç­‰ï¼Œç„¶åå¯ä»¥éšä¾¿é€‰ä¸€ä¸ªç±»ä½œä¸ºèµ·ç‚¹ï¼Œåƒçˆ¬è™«ä¸€æ ·ï¼Œæ²¿ç€å…³ç³»é“¾æ¥å»çœ‹å®ƒç›¸å…³çš„ç±»ï¼Œé€æ­¥å»ç†è§£è¿™äº›ç±»æ˜¯å¦‚ä½•é…åˆå·¥ä½œçš„ã€‚","user_name":"ä½œè€…å›å¤","user_name_real":"ç½—å‰‘é”‹","uid":"1181974","ctime":1592873899,"ip_address":"","comment_id":228958,"utype":1}],"discussion_count":1,"race_medal":2,"score":"5887837394","product_id":100051801,"comment_content":"è€å¸ˆèƒ½å¦è¯´è¯´éœ€æ±‚åˆ°UMLå›¾çš„è¿‡ç¨‹ï¼Œæ˜¯æ€ä¹ˆæŠŠéœ€æ±‚æåˆ°UMLçš„ã€‚è¿˜æœ‰å°±æ˜¯ç»™ä¸€å¼ UMLå›¾ï¼Œåº”è¯¥æ€ä¹ˆçœ‹ï¼Ÿ","like_count":1,"discussions":[{"author":{"id":1181974,"avatar":"https://static001.geekbang.org/account/avatar/00/12/09/16/1161017c.jpg","nickname":"ç½—å‰‘é”‹","note":"","ucode":"95678C988F24AB","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":499275,"discussion_content":"\n1.è¿™ä¸ªå°±æ˜¯åŸºæœ¬çš„éœ€æ±‚åˆ†æäº†ï¼Œç®€å•æ¥è¯´ï¼Œå°±æ˜¯æå–å‡ºéœ€æ±‚é‡Œçš„åè¯å’ŒåŠ¨è¯ï¼Œè½¬åŒ–æˆç›¸åº”çš„ç±»ï¼Œæ¯”å¦‚é”€å”®è®°å½•ã€é…ç½®æ–‡ä»¶ã€é”ã€XXä¸»å¾ªç¯ã€‚\n\n2.UMLå›¾æœ‰å¾ˆå¤šç§ï¼Œè¿™é‡Œç”¨åˆ°çš„æ˜¯ç±»å›¾ï¼Œè¡¨ç¤ºçš„æ˜¯ç±»ä¹‹é—´çš„å…³ç³»ï¼Œéœ€è¦ç†è§£UMLçš„åŸºæœ¬è¯­è¨€è¦ç´ ï¼Œæ¯”å¦‚èšåˆã€è”ç³»ç­‰ï¼Œç„¶åå¯ä»¥éšä¾¿é€‰ä¸€ä¸ªç±»ä½œä¸ºèµ·ç‚¹ï¼Œåƒçˆ¬è™«ä¸€æ ·ï¼Œæ²¿ç€å…³ç³»é“¾æ¥å»çœ‹å®ƒç›¸å…³çš„ç±»ï¼Œé€æ­¥å»ç†è§£è¿™äº›ç±»æ˜¯å¦‚ä½•é…åˆå·¥ä½œçš„ã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1592873899,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":356453,"user_name":"æˆ‘æ˜¯ä¸€åªå°å°é¸Ÿ","can_delete":false,"product_type":"c1","uid":1339366,"ip_address":"åŒ—äº¬","ucode":"13348E2AC10F06","user_header":"https://static001.geekbang.org/account/avatar/00/14/6f/e6/357e80e9.jpg","comment_is_top":false,"comment_ctime":1662339582,"is_pvip":true,"replies":[{"id":"129770","content":"å…¶å®è¿™ä¸ªå’Œhppæ²¡æœ‰å¿…ç„¶å…³ç³»ï¼Œç”¨.h + .cppä¹Ÿä¼šæœ‰åŒæ ·çš„é—®é¢˜ï¼Œåªè¦ç±»è®¾è®¡åˆç†ï¼Œç”¨å¥½è®¾è®¡æ¨¡å¼ï¼Œä¸è¦å‡ºç°é¢æ¡ç±»ï¼Œä¸€ä¸¤åƒè¡Œçš„æºæ–‡ä»¶ä¹Ÿæ˜¯å¯ä»¥æ¥å—çš„ï¼Œå¦‚æœå†å¤§å°±è¦è€ƒè™‘é‡æ„äº†ã€‚","user_name":"ä½œè€…å›å¤","user_name_real":"ç¼–è¾‘","uid":"1181974","ctime":1662346625,"ip_address":"åŒ—äº¬","comment_id":356453,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1662339582","product_id":100051801,"comment_content":"è€å¸ˆï¼Œæ‚¨å¥½ï¼Œæœ‰ä¸ªé—®é¢˜è¯·æ•™ä¸‹ï¼Œåªä½¿ç”¨.hppï¼Œå¦‚æœå‡½æ•°æ¥å£æ¯”è¾ƒå¤šï¼Œæ˜“è¯»æ€§æ€ä¹ˆä¿è¯ã€‚åˆ°æ—¶å€™ä¸€ä¸ªhppæ–‡ä»¶ï¼Œä¼šä¸ä¼šå‡ºç°1000+","like_count":0,"discussions":[{"author":{"id":1181974,"avatar":"https://static001.geekbang.org/account/avatar/00/12/09/16/1161017c.jpg","nickname":"ç½—å‰‘é”‹","note":"","ucode":"95678C988F24AB","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":586571,"discussion_content":"å…¶å®è¿™ä¸ªå’Œhppæ²¡æœ‰å¿…ç„¶å…³ç³»ï¼Œç”¨.h + .cppä¹Ÿä¼šæœ‰åŒæ ·çš„é—®é¢˜ï¼Œåªè¦ç±»è®¾è®¡åˆç†ï¼Œç”¨å¥½è®¾è®¡æ¨¡å¼ï¼Œä¸è¦å‡ºç°é¢æ¡ç±»ï¼Œä¸€ä¸¤åƒè¡Œçš„æºæ–‡ä»¶ä¹Ÿæ˜¯å¯ä»¥æ¥å—çš„ï¼Œå¦‚æœå†å¤§å°±è¦è€ƒè™‘é‡æ„äº†ã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1662346625,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"åŒ—äº¬"},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":307391,"user_name":"Geek_6427cc","can_delete":false,"product_type":"c1","uid":2687340,"ip_address":"","ucode":"E068345365B611","user_header":"https://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTI6bWC6dlUWtJBNHX12ZQ7a7Jp6iamGECic0oLzzlo2QqKmorwbGcsKaZbCDLdm4R9ProCcVX79sx4Q/132","comment_is_top":false,"comment_ctime":1629079816,"is_pvip":false,"replies":[{"id":"111310","content":"LuaRef_castæ˜¯lua bridgeè‡ªå·±çš„ç±»å‹è½¬æ¢å‡½æ•°ï¼ŒæŠŠluaæ•°æ®è½¬æ¢C++æ•°æ®ã€‚","user_name":"ä½œè€…å›å¤","user_name_real":"ç½—å‰‘é”‹","uid":"1181974","ctime":1629091732,"ip_address":"","comment_id":307391,"utype":1}],"discussion_count":2,"race_medal":0,"score":"1629079816","product_id":100051801,"comment_content":"è€å¸ˆæ‚¨å¥½ï¼Œgetæ¨¡æ¿å‡½æ•°çš„è¿”å›å€¼ä¸æ˜¯å¾ˆæ‡‚ï¼Œä¸æ˜ç™½LuaRef_castæ˜¯ä»€ä¹ˆï¼Œç±»å‹è½¬æ¢ä¸æ˜¯åªæœ‰é‚£å››ä¸ªæ–¹æ³•å—","like_count":0,"discussions":[{"author":{"id":1181974,"avatar":"https://static001.geekbang.org/account/avatar/00/12/09/16/1161017c.jpg","nickname":"ç½—å‰‘é”‹","note":"","ucode":"95678C988F24AB","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":525136,"discussion_content":"LuaRef_castæ˜¯lua bridgeè‡ªå·±çš„ç±»å‹è½¬æ¢å‡½æ•°ï¼ŒæŠŠluaæ•°æ®è½¬æ¢C++æ•°æ®ã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1629091732,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":2687340,"avatar":"https://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTI6bWC6dlUWtJBNHX12ZQ7a7Jp6iamGECic0oLzzlo2QqKmorwbGcsKaZbCDLdm4R9ProCcVX79sx4Q/132","nickname":"Geek_6427cc","note":"","ucode":"E068345365B611","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":390369,"discussion_content":"å¥½çš„è°¢è°¢è€å¸ˆ","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1629804203,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":291653,"user_name":"Geek_8866d4","can_delete":false,"product_type":"c1","uid":2435064,"ip_address":"","ucode":"34EAED72C2FAD0","user_header":"https://thirdwx.qlogo.cn/mmopen/vi_32/ia5NFICdEuzaQ8Vib0depvkB6UmxPBFib51aClSJYfCIa7tn2nXauddwxDvbxYuQ9UeRGVICLfTtDJysnDJ5EfQcg/132","comment_is_top":false,"comment_ctime":1620400407,"is_pvip":false,"replies":[{"id":"105630","content":"æˆ‘æµ‹è¯•äº†ä¸€ä¸‹ï¼Œæ²¡æœ‰é‡ç°ä½ è¯´çš„è¿™ä¸ªé—®é¢˜ï¼Œæ˜¯ä¸æ˜¯ä½¿ç”¨çš„æ ‡å‡†ä¸å¯¹ï¼Œç¼–è¯‘æ—¶åŠ ä¸Š-std=c++14å†è¯•è¯•ã€‚","user_name":"ä½œè€…å›å¤","user_name_real":"ç½—å‰‘é”‹","uid":"1181974","ctime":1620435690,"ip_address":"","comment_id":291653,"utype":1}],"discussion_count":3,"race_medal":0,"score":"1620400407","product_id":100051801,"comment_content":"&#47;home&#47;wuchaochao&#47;c++&#47;cpp_study&#47;section5&#47;client.cpp:36:20: error: non-local lambda expression cannot have a capture-default<br>   36 | auto make_sales = [=](const auto&amp; id, auto s, auto r)<br>è€å¸ˆ ï¼Œæˆ‘åœ¨ç¼–è¯‘æ‚¨çš„æºç çš„æ—¶å€™æŠ¥é”™<br>","like_count":0,"discussions":[{"author":{"id":1181974,"avatar":"https://static001.geekbang.org/account/avatar/00/12/09/16/1161017c.jpg","nickname":"ç½—å‰‘é”‹","note":"","ucode":"95678C988F24AB","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":519533,"discussion_content":"æˆ‘æµ‹è¯•äº†ä¸€ä¸‹ï¼Œæ²¡æœ‰é‡ç°ä½ è¯´çš„è¿™ä¸ªé—®é¢˜ï¼Œæ˜¯ä¸æ˜¯ä½¿ç”¨çš„æ ‡å‡†ä¸å¯¹ï¼Œç¼–è¯‘æ—¶åŠ ä¸Š-std=c++14å†è¯•è¯•ã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1620435690,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":2435064,"avatar":"https://thirdwx.qlogo.cn/mmopen/vi_32/ia5NFICdEuzaQ8Vib0depvkB6UmxPBFib51aClSJYfCIa7tn2nXauddwxDvbxYuQ9UeRGVICLfTtDJysnDJ5EfQcg/132","nickname":"Geek_8866d4","note":"","ucode":"34EAED72C2FAD0","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":372840,"discussion_content":"ä¸‹é¢æ‰¾ä¸åˆ°åº“çš„é—®é¢˜è§£å†³äº†ï¼Œæ˜¯å› ä¸ºæ²¡æœ‰è¿›è¡Œupgradeï¼Œå®‰è£…æ‚¨çš„æ–¹å¼ç¼–è¯‘srv.cppæ–‡ä»¶å¹´èƒ½å¤ŸæˆåŠŸçš„è¿è¡Œï¼Œä½†æ˜¯ä¸Šé¢çš„é—®é¢˜è¿˜æ˜¯å­˜åœ¨","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1620474729,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":2435064,"avatar":"https://thirdwx.qlogo.cn/mmopen/vi_32/ia5NFICdEuzaQ8Vib0depvkB6UmxPBFib51aClSJYfCIa7tn2nXauddwxDvbxYuQ9UeRGVICLfTtDJysnDJ5EfQcg/132","nickname":"Geek_8866d4","note":"","ucode":"34EAED72C2FAD0","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":372821,"discussion_content":"ç½—è€å¸ˆï¼Œæˆ‘è¿™ä¸ªç¼–è¯‘çš„æ—¶å€™å‡ºç°äº†å„ç§å¥‡æ€ªçš„é—®é¢˜ï¼Œæˆ‘åœ¨section5ä¸­makeç”±CMakeList.txtç”Ÿæˆçš„makefileæ–‡ä»¶çš„æ—¶å€™ï¼Œå‡ºç°äº†ollect2: error: ld returned 1 exit status\nmake[2]: *** [CMakeFiles/srv.dir/build.make:84ï¼šsrv] é”™è¯¯ 1\nmake[2]: ç¦»å¼€ç›®å½•â€œ/home/wuchaochao/c++/cpp_study/section5â€\nmake[1]: *** [CMakeFiles/Makefile2:107ï¼šCMakeFiles/srv.dir/all] é”™è¯¯ 2\nmake[1]: ç¦»å¼€ç›®å½•â€œ/home/wuchaochao/c++/cpp_study/section5â€\nmake: *** [Makefile:118ï¼šall] é”™è¯¯ 2\nè¿™æ ·çš„é”™è¯¯\næˆ‘ä¿®æ”¹äº†ä½ çš„CMakeList.txtæ–‡ä»¶ï¼Œå¢åŠ äº†ç¼–è¯‘çš„è·¯å¾„add_compile_options(-std=c++14 -I../common -I../common/include -I/usr/local/include/luajit-2.1 -lluajit-5.1 -ldl -lzmq -lpthread -lcpr -lcurl)å¦‚æœä¸æ‰‹åŠ¨åˆ¶å®šåº“çš„è·¯å¾„ä¼šæŠ¥é”™ï¼Œæ‰¾ä¸åˆ°å¤´æ–‡ä»¶\nåé¢æŠ¥é”™ä¹‹åï¼Œæˆ‘å•ç‹¬å®‰è£…æ‚¨æ³¨è§£ä¸Šçš„æ–¹å¼ç¼–è¯‘äº†srv.cppè¿™ä¸ªæ–‡ä»¶ï¼Œç¼–è¯‘æ²¡æœ‰é—®é¢˜ï¼Œä½†æ˜¯è¿è¡Œå°±æŠ¥é”™äº†\nerror while loading shared libraries: libcpr.so.1: cannot open shared object file: No such file or directory\nå‘Šè¯‰æˆ‘ç¼ºå°‘libcpr.so.1è¿™åº“æ–‡ä»¶ï¼Œä½†æ˜¯æˆ‘å·²ç»å®‰è£…ç»™å‡ºçš„å®‰è£…æ–¹å¼å®‰è£…äº†cprè¿™ä¸ªåº“ï¼Œç°åœ¨ä¸çŸ¥é“è¯¥æ€ä¹ˆè§£å†³","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1620470434,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":256927,"user_name":"å¤§ç†ŠğŸ»","can_delete":false,"product_type":"c1","uid":1622742,"ip_address":"","ucode":"06E0E4082C5985","user_header":"https://static001.geekbang.org/account/avatar/00/18/c2/d6/d3d7371b.jpg","comment_is_top":false,"comment_ctime":1603785937,"is_pvip":false,"replies":[{"id":"93549","content":"æˆ‘è§‰å¾—å¯èƒ½æ˜¯ç¼–è¯‘å™¨çš„é—®é¢˜ï¼Œè¯•ç€ç”¨é«˜ç‰ˆæœ¬çš„gccï¼Œæˆ–è€…åœ¨æ‰“å¥½åŒ…çš„dockerç¯å¢ƒé‡Œè¯•è¯•ã€‚","user_name":"ä½œè€…å›å¤","user_name_real":"ç½—å‰‘é”‹","uid":"1181974","ctime":1603839055,"ip_address":"","comment_id":256927,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1603785937","product_id":100051801,"comment_content":"æˆå‘˜å˜é‡åˆå§‹åŒ–<br>const regex_type m_reg {R&quot;(^(\\w+)\\.(\\w+)$)&quot;};<br>è¿è¡Œæ—¶ä¸€ç›´æŠ¥é”™ <br>regex_error: The parser did not consume the entire regular expression.","like_count":0,"discussions":[{"author":{"id":1181974,"avatar":"https://static001.geekbang.org/account/avatar/00/12/09/16/1161017c.jpg","nickname":"ç½—å‰‘é”‹","note":"","ucode":"95678C988F24AB","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":508167,"discussion_content":"æˆ‘è§‰å¾—å¯èƒ½æ˜¯ç¼–è¯‘å™¨çš„é—®é¢˜ï¼Œè¯•ç€ç”¨é«˜ç‰ˆæœ¬çš„gccï¼Œæˆ–è€…åœ¨æ‰“å¥½åŒ…çš„dockerç¯å¢ƒé‡Œè¯•è¯•ã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1603839055,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":237628,"user_name":"é”¦é²¤","can_delete":false,"product_type":"c1","uid":1343717,"ip_address":"","ucode":"B9F1495E39F00A","user_header":"https://static001.geekbang.org/account/avatar/00/14/80/e5/251d89b5.jpg","comment_is_top":false,"comment_ctime":1595905253,"is_pvip":false,"replies":[{"id":"87798","content":"åº”è¯¥æŒ‡çš„æ˜¯call_onceå§ã€‚<br><br>ä¸æ˜¯è¿™æ ·ç”¨çš„ï¼Œè¿™é‡Œåˆ©ç”¨çš„æ˜¯RAIIæŠ€æœ¯ï¼Œæ¯æ¬¡åˆ°è¿™é‡Œéƒ½ä¼šæ„é€ ä¸€ä¸ªguardå¯¹è±¡ï¼Œæ¥è·å–é”å†è‡ªåŠ¨é‡Šæ”¾é”ï¼Œå¦‚æœç”¨call_onceå°±é”™äº†ã€‚","user_name":"ä½œè€…å›å¤","user_name_real":"ç½—å‰‘é”‹","uid":"1181974","ctime":1595913682,"ip_address":"","comment_id":237628,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1595905253","product_id":100051801,"comment_content":"SpinLockGuard çš„å®ä¾‹åŒ–æ˜¯å¦è¦ç”¨åˆ°å‰é¢ç« èŠ‚é‡Œé¢è®²åˆ°çš„make_onceè¡¨ç¤ºåªä¼šå®ä¾‹åŒ–ä¸€æ¬¡ï¼Ÿ","like_count":0,"discussions":[{"author":{"id":1181974,"avatar":"https://static001.geekbang.org/account/avatar/00/12/09/16/1161017c.jpg","nickname":"ç½—å‰‘é”‹","note":"","ucode":"95678C988F24AB","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":502486,"discussion_content":"åº”è¯¥æŒ‡çš„æ˜¯call_onceå§ã€‚\n\nä¸æ˜¯è¿™æ ·ç”¨çš„ï¼Œè¿™é‡Œåˆ©ç”¨çš„æ˜¯RAIIæŠ€æœ¯ï¼Œæ¯æ¬¡åˆ°è¿™é‡Œéƒ½ä¼šæ„é€ ä¸€ä¸ªguardå¯¹è±¡ï¼Œæ¥è·å–é”å†è‡ªåŠ¨é‡Šæ”¾é”ï¼Œå¦‚æœç”¨call_onceå°±é”™äº†ã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1595913682,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":236290,"user_name":"Geek_hope","can_delete":false,"product_type":"c1","uid":2052423,"ip_address":"","ucode":"8B30F9D92CF0A4","user_header":"","comment_is_top":false,"comment_ctime":1595385960,"is_pvip":false,"replies":[{"id":"87321","content":"try_lockåªæ˜¯å°è¯•é”å®šï¼Œä¸ä¼šé˜»å¡ï¼Œè€Œlockæ˜¯é˜»å¡ç›´è‡³é”å®šï¼Œä¸¤ä¸ªçš„ä½¿ç”¨åœºæ™¯ä¸åŒã€‚","user_name":"ä½œè€…å›å¤","user_name_real":"ç½—å‰‘é”‹","uid":"1181974","ctime":1595396226,"ip_address":"","comment_id":236290,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1595385960","product_id":100051801,"comment_content":"è€å¸ˆæ‚¨å¥½ï¼Œè¯·é—®SpinLock ç±»é‡Œé¢è¿˜æœ‰ä¸€ä¸ª try_lock å‘¢ï¼Ÿä¸æ˜¯lock æˆå‘˜å‡½æ•°å·²ç»é”å®šäº†å—ï¼Ÿ","like_count":0,"discussions":[{"author":{"id":1181974,"avatar":"https://static001.geekbang.org/account/avatar/00/12/09/16/1161017c.jpg","nickname":"ç½—å‰‘é”‹","note":"","ucode":"95678C988F24AB","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":502016,"discussion_content":"try_lockåªæ˜¯å°è¯•é”å®šï¼Œä¸ä¼šé˜»å¡ï¼Œè€Œlockæ˜¯é˜»å¡ç›´è‡³é”å®šï¼Œä¸¤ä¸ªçš„ä½¿ç”¨åœºæ™¯ä¸åŒã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1595396226,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":235273,"user_name":"henry","can_delete":false,"product_type":"c1","uid":1019455,"ip_address":"","ucode":"D2744C559ADFD0","user_header":"https://static001.geekbang.org/account/avatar/00/0f/8e/3f/1f529b26.jpg","comment_is_top":false,"comment_ctime":1594957075,"is_pvip":true,"replies":[{"id":"86878","content":"æ˜¯çš„ï¼Œéƒ½çœ‹zmq.hppçš„æºç äº†ï¼Œå¾ˆè®¤çœŸå•Šã€‚<br><br>æœ‰äº†å³å€¼å’Œè½¬ç§»æ„é€ ï¼Œåœ¨C++é‡Œè¿”å›å¯¹è±¡ç¡®å®çœäº†å¾ˆå¤šåŠ›æ°”ã€‚","user_name":"ä½œè€…å›å¤","user_name_real":"ç½—å‰‘é”‹","uid":"1181974","ctime":1594962264,"ip_address":"","comment_id":235273,"utype":1}],"discussion_count":2,"race_medal":0,"score":"1594957075","product_id":100051801,"comment_content":"è€å¸ˆæ‚¨å¥½ï¼ZmqContext ç±»ä¸­çš„ä¸¤ä¸ªå·¥å‚æ–¹æ³• recv_sock,send_sock, è¿”å›å€¼æ˜¯zmq::socket_tçš„å¯¹è±¡ï¼Œé‡Œé¢çš„ä¸´æ—¶å¯¹è±¡sockææ„æ—¶ä¸ç”¨æ‹…å¿ƒzmq_close å…³é—­äº†_handleï¼Œæ˜¯å› ä¸ºzmq::socket_tå®ç°äº†ç§»åŠ¨æ„é€ å‡½æ•°ï¼Œä¸´æ—¶å¯¹è±¡sockçš„_handleåˆ«è½¬ç§»äº†ï¼Œè‡ªå·±çš„_handleå·²ç»æ˜¯null_pträº†å¯¹å§ã€‚<br>è¦æ˜¯æˆ‘è‡ªå·±å®ç°è¿™ä¸ªä»£ç çš„è¯ï¼Œä¼°è®¡è¿˜æ˜¯ä¼šç”¨æ™ºèƒ½æŒ‡é’ˆçš„æ–¹å¼ã€‚æ—¶åˆ»æ³¨æ„æ„é€ å’Œææ„ç»†èŠ‚æ„Ÿè§‰æŒºéº»çƒ¦çš„ã€‚","like_count":0,"discussions":[{"author":{"id":1181974,"avatar":"https://static001.geekbang.org/account/avatar/00/12/09/16/1161017c.jpg","nickname":"ç½—å‰‘é”‹","note":"","ucode":"95678C988F24AB","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":501669,"discussion_content":"æ˜¯çš„ï¼Œéƒ½çœ‹zmq.hppçš„æºç äº†ï¼Œå¾ˆè®¤çœŸå•Šã€‚\n\næœ‰äº†å³å€¼å’Œè½¬ç§»æ„é€ ï¼Œåœ¨C++é‡Œè¿”å›å¯¹è±¡ç¡®å®çœäº†å¾ˆå¤šåŠ›æ°”ã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1594962264,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1019455,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/8e/3f/1f529b26.jpg","nickname":"henry","note":"","ucode":"D2744C559ADFD0","race_medal":0,"user_type":1,"is_pvip":true},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":291827,"discussion_content":"å¥½çš„ï¼Œè°¢è°¢ï¼\nå³å€¼å¼•ç”¨ï¼Œè½¬ç§»æ„é€ ï¼Œè½¬ç§»èµ‹å€¼ï¼Œè¿™äº›æ¦‚å¿µè¿˜å¾—å¤šç†è§£ç†è§£ï¼Œè¦ä¸ç„¶ç”¨åˆ°è¿™æ–¹é¢çš„æ—¶å€™æ€»è§‰å¾—ä¸è¸å®ã€‚æ“¦æ±—ï¼","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1594963103,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":231337,"user_name":"Ryan24G","can_delete":false,"product_type":"c1","uid":1631292,"ip_address":"","ucode":"EA1E134C18DA80","user_header":"https://static001.geekbang.org/account/avatar/00/18/e4/3c/dfcb86df.jpg","comment_is_top":false,"comment_ctime":1593654068,"is_pvip":true,"replies":[{"id":"85418","content":"è¿™ä¸ªä¹Ÿç®—æ˜¯æˆ‘C++å¼€å‘çš„ä¸€ä¸ªä¹ æƒ¯äº†ï¼Œç»Ÿä¸€çš„å¤´æ–‡ä»¶å®šä¹‰ï¼Œç”¨èµ·æ¥æ¯”è¾ƒçœäº‹ã€‚","user_name":"ä½œè€…å›å¤","user_name_real":"ç½—å‰‘é”‹","uid":"1181974","ctime":1593655656,"ip_address":"","comment_id":231337,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1593654068","product_id":100051801,"comment_content":"çªç„¶è¹¦å‡ºä¸ª .hpp æ–‡ä»¶å‡ºæ¥äº†....","like_count":0,"discussions":[{"author":{"id":1181974,"avatar":"https://static001.geekbang.org/account/avatar/00/12/09/16/1161017c.jpg","nickname":"ç½—å‰‘é”‹","note":"","ucode":"95678C988F24AB","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":500266,"discussion_content":"è¿™ä¸ªä¹Ÿç®—æ˜¯æˆ‘C++å¼€å‘çš„ä¸€ä¸ªä¹ æƒ¯äº†ï¼Œç»Ÿä¸€çš„å¤´æ–‡ä»¶å®šä¹‰ï¼Œç”¨èµ·æ¥æ¯”è¾ƒçœäº‹ã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1593655656,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":229685,"user_name":"heylypp","can_delete":false,"product_type":"c1","uid":1994958,"ip_address":"","ucode":"CBD72BA764ACA1","user_header":"https://static001.geekbang.org/account/avatar/00/1e/70/ce/168b803b.jpg","comment_is_top":false,"comment_ctime":1593097940,"is_pvip":false,"replies":[{"id":"84760","content":"åœ¨gccç¼–è¯‘çš„æ—¶å€™æ‰‹å·¥æŒ‡å®šä¸€ä¸‹luajitçš„è·¯å¾„å§ï¼Œå‚è€ƒæºç é‡Œçš„æ³¨é‡Šã€‚","user_name":"ä½œè€…å›å¤","user_name_real":"ç½—å‰‘é”‹","uid":"1181974","ctime":1593127442,"ip_address":"","comment_id":229685,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1593097940","product_id":100051801,"comment_content":"è€å¸ˆæ‚¨å¥½ï¼Œåœ¨ç¼–è¯‘æ‚¨ä»“åº“é‡Œçš„section5æ—¶ï¼Œå‡ºç°å¦‚ä¸‹æŠ¥é”™ï¼ˆä½¿ç”¨çš„æ˜¯openresty&#47;luajit2ï¼Œå¹¶å°†è·¯å¾„å†™å…¥&#47;etc&#47;profileï¼‰ï¼Œä¸çŸ¥å¦‚ä½•è§£å†³<br> fatal error: luajit.h: No such file or directory<br> #include &lt;luajit.h&gt;<br>","like_count":0,"discussions":[{"author":{"id":1181974,"avatar":"https://static001.geekbang.org/account/avatar/00/12/09/16/1161017c.jpg","nickname":"ç½—å‰‘é”‹","note":"","ucode":"95678C988F24AB","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":499591,"discussion_content":"åœ¨gccç¼–è¯‘çš„æ—¶å€™æ‰‹å·¥æŒ‡å®šä¸€ä¸‹luajitçš„è·¯å¾„å§ï¼Œå‚è€ƒæºç é‡Œçš„æ³¨é‡Šã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1593127442,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":229632,"user_name":"æœ‰å­¦è¯†çš„å…”å­","can_delete":false,"product_type":"c1","uid":1628867,"ip_address":"","ucode":"D1D654B1562FC9","user_header":"http://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTIicr82CnrdEjibibAvyeKRQHszSzIAqoCWxN0kqC442XcjEae6S9j6NDtKLpg4Da4CUQQeUFUicWqiaDw/132","comment_is_top":false,"comment_ctime":1593079085,"is_pvip":false,"replies":[{"id":"84746","content":"è®¾è®¡ä¹Ÿè¦æŒæ¡ä¸€ä¸ªåº¦ï¼Œå¤§å‹ã€é•¿æœŸé¡¹ç›®å°±è¦å¤šåšè®¾è®¡ï¼Œå°å‹é¡¹ç›®ã€è¿­ä»£å‹çš„çŸ­æœŸé¡¹ç›®å°±å¯ä»¥é€‚å½“ç®€åŒ–ï¼Œåœ¨æˆæœ¬ä¸æ¶æ„ä¹‹é—´æ‰¾åˆ°æŠ˜ä¸­ã€‚<br><br>ä½†é¡¹ç›®ä¸€èˆ¬åˆ°ä¸­åæœŸï¼Œéƒ½å…ä¸äº†è¶Šåšè¶Šå¤§ï¼Œæ‰€ä»¥å°±è¦åŠæ—¶é‡æ„ä¼˜åŒ–è®¾è®¡ï¼Œå¦åˆ™å°±ä¼šç§¯ç´¯å¾ˆå¤šæŠ€æœ¯å€ºã€‚","user_name":"ä½œè€…å›å¤","user_name_real":"ç½—å‰‘é”‹","uid":"1181974","ctime":1593086062,"ip_address":"","comment_id":229632,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1593079085","product_id":100051801,"comment_content":"åœ¨åˆ†æéœ€æ±‚ï¼ŒåŸºäºä¸€äº›è®¾è®¡åŸåˆ™SOLIDå’Œé¢å‘å¯¹è±¡çš„æ€æƒ³ç­‰ï¼ŒæŠŠéœ€æ±‚æŠ½è±¡æˆå„ç§ç‹¬ç«‹æ¨¡å—ï¼ŒåŸºäºæ­¤è¿è¡Œè¯­è¨€ç‰¹æ€§å’Œè®¾è®¡æ¨¡å¼ï¼Œä½¿å¾—ä¿è¯ä»£ç å¯è¯»æ€§å’Œå¯æ‰©å±•æ€§ã€‚<br>ä¸ªäººè§‰å¾—å‰æœŸç¨‹åºä¸ç”¨è¿‡åº¦è®¾è®¡ï¼Œå¿…è¦çš„æ¨¡å—åˆ’åˆ†ç»“åˆç»§æ‰¿ç»„åˆä»¥åŠè¯­è¨€ç‰¹æ€§çš„æ–¹å¼ï¼Œå³å¯å®Œæˆå‰æœŸåŸå‹å¼€å‘ã€‚","like_count":0,"discussions":[{"author":{"id":1181974,"avatar":"https://static001.geekbang.org/account/avatar/00/12/09/16/1161017c.jpg","nickname":"ç½—å‰‘é”‹","note":"","ucode":"95678C988F24AB","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":499573,"discussion_content":"è®¾è®¡ä¹Ÿè¦æŒæ¡ä¸€ä¸ªåº¦ï¼Œå¤§å‹ã€é•¿æœŸé¡¹ç›®å°±è¦å¤šåšè®¾è®¡ï¼Œå°å‹é¡¹ç›®ã€è¿­ä»£å‹çš„çŸ­æœŸé¡¹ç›®å°±å¯ä»¥é€‚å½“ç®€åŒ–ï¼Œåœ¨æˆæœ¬ä¸æ¶æ„ä¹‹é—´æ‰¾åˆ°æŠ˜ä¸­ã€‚\n\nä½†é¡¹ç›®ä¸€èˆ¬åˆ°ä¸­åæœŸï¼Œéƒ½å…ä¸äº†è¶Šåšè¶Šå¤§ï¼Œæ‰€ä»¥å°±è¦åŠæ—¶é‡æ„ä¼˜åŒ–è®¾è®¡ï¼Œå¦åˆ™å°±ä¼šç§¯ç´¯å¾ˆå¤šæŠ€æœ¯å€ºã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1593086062,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]}]}