{"id":107477,"title":"37 | é«˜é€Ÿç¼“å­˜ï¼ˆä¸Šï¼‰ï¼šâ€œ4æ¯«ç§’â€ç©¶ç«Ÿå€¼å¤šå°‘é’±ï¼Ÿ","content":"<p>åœ¨è¿™ä¸€èŠ‚å†…å®¹å¼€å§‹ä¹‹å‰ï¼Œæˆ‘ä»¬å…ˆæ¥çœ‹ä¸€ä¸ª3è¡Œçš„å°ç¨‹åºã€‚ä½ å¯ä»¥çŒœä¸€çŒœï¼Œè¿™ä¸ªç¨‹åºé‡Œçš„å¾ªç¯1å’Œå¾ªç¯2ï¼Œè¿è¡Œæ‰€èŠ±è´¹çš„æ—¶é—´ä¼šå·®å¤šå°‘ï¼Ÿä½ å¯ä»¥å…ˆæ€è€ƒå‡ åˆ†é’Ÿï¼Œç„¶åå†çœ‹æˆ‘ä¸‹é¢çš„è§£é‡Šã€‚</p><pre><code>int[] arr = new int[64 * 1024 * 1024];\n\n\n// å¾ªç¯1\nfor (int i = 0; i &lt; arr.length; i++) arr[i] *= 3;\n\n\n// å¾ªç¯2\nfor (int i = 0; i &lt; arr.length; i += 16) arr[i] *= 3\n</code></pre><p>åœ¨è¿™æ®µJavaç¨‹åºä¸­ï¼Œæˆ‘ä»¬é¦–å…ˆæ„é€ äº†ä¸€ä¸ª64Ã—1024Ã—1024å¤§å°çš„æ•´å‹æ•°ç»„ã€‚åœ¨å¾ªç¯1é‡Œï¼Œæˆ‘ä»¬éå†æ•´ä¸ªæ•°ç»„ï¼Œå°†æ•°ç»„ä¸­æ¯ä¸€é¡¹çš„å€¼å˜æˆäº†åŸæ¥çš„3å€ï¼›åœ¨å¾ªç¯2é‡Œï¼Œæˆ‘ä»¬æ¯éš”16ä¸ªç´¢å¼•è®¿é—®ä¸€ä¸ªæ•°ç»„å…ƒç´ ï¼Œå°†è¿™ä¸€é¡¹çš„å€¼å˜æˆäº†åŸæ¥çš„3å€ã€‚</p><p>æŒ‰é“ç†æ¥è¯´ï¼Œå¾ªç¯2åªè®¿é—®å¾ªç¯1ä¸­1/16çš„æ•°ç»„å…ƒç´ ï¼Œåªè¿›è¡Œäº†å¾ªç¯1ä¸­1/16çš„ä¹˜æ³•è®¡ç®—ï¼Œé‚£å¾ªç¯2èŠ±è´¹çš„æ—¶é—´åº”è¯¥æ˜¯å¾ªç¯1çš„1/16å·¦å³ã€‚ä½†æ˜¯å®é™…ä¸Šï¼Œå¾ªç¯1åœ¨æˆ‘çš„ç”µè„‘ä¸Šè¿è¡Œéœ€è¦50æ¯«ç§’ï¼Œå¾ªç¯2åªéœ€è¦46æ¯«ç§’ã€‚è¿™ä¸¤ä¸ªå¾ªç¯èŠ±è´¹æ—¶é—´ä¹‹å·®åœ¨15%ä¹‹å†…ã€‚</p><p>ä¸ºä»€ä¹ˆä¼šæœ‰è¿™15%çš„å·®å¼‚å‘¢ï¼Ÿè¿™å’Œæˆ‘ä»¬ä»Šå¤©è¦è®²çš„CPU Cacheæœ‰å…³ã€‚ä¹‹å‰æˆ‘ä»¬çœ‹åˆ°äº†å†…å­˜å’Œç¡¬ç›˜ä¹‹é—´å­˜åœ¨çš„å·¨å¤§æ€§èƒ½å·®å¼‚ã€‚åœ¨CPUçœ¼é‡Œï¼Œå†…å­˜ä¹Ÿæ…¢å¾—ä¸è¡Œã€‚äºæ˜¯ï¼Œèªæ˜çš„å·¥ç¨‹å¸ˆä»¬å°±åœ¨CPUé‡Œé¢åµŒå…¥äº†CPU Cacheï¼ˆé«˜é€Ÿç¼“å­˜ï¼‰ï¼Œæ¥è§£å†³è¿™ä¸€é—®é¢˜ã€‚</p><h2>æˆ‘ä»¬ä¸ºä»€ä¹ˆéœ€è¦é«˜é€Ÿç¼“å­˜?</h2><p>æŒ‰ç…§<a href=\"https://zh.wikipedia.org/wiki/%E6%91%A9%E5%B0%94%E5%AE%9A%E5%BE%8B\">æ‘©å°”å®šå¾‹</a>ï¼ŒCPUçš„è®¿é—®é€Ÿåº¦æ¯18ä¸ªæœˆä¾¿ä¼šç¿»ä¸€ç•ªï¼Œç›¸å½“äºæ¯å¹´å¢é•¿60%ã€‚å†…å­˜çš„è®¿é—®é€Ÿåº¦è™½ç„¶ä¹Ÿåœ¨ä¸æ–­å¢é•¿ï¼Œå´è¿œæ²¡æœ‰è¿™ä¹ˆå¿«ï¼Œæ¯å¹´åªå¢é•¿7%å·¦å³ã€‚è€Œè¿™ä¸¤ä¸ªå¢é•¿é€Ÿåº¦çš„å·®å¼‚ï¼Œä½¿å¾—CPUæ€§èƒ½å’Œå†…å­˜è®¿é—®æ€§èƒ½çš„å·®è·ä¸æ–­æ‹‰å¤§ã€‚åˆ°ä»Šå¤©æ¥çœ‹ï¼Œä¸€æ¬¡å†…å­˜çš„è®¿é—®ï¼Œå¤§çº¦éœ€è¦120ä¸ªCPU Cycleï¼Œè¿™ä¹Ÿæ„å‘³ç€ï¼Œåœ¨ä»Šå¤©ï¼ŒCPUå’Œå†…å­˜çš„è®¿é—®é€Ÿåº¦å·²ç»æœ‰äº†120å€çš„å·®è·ã€‚</p><!-- [[[read_end]]] --><p>å¦‚æœæ‹¿æˆ‘ä»¬ç°å®ç”Ÿæ´»æ¥æ‰“ä¸ªæ¯”æ–¹çš„è¯ï¼ŒCPUçš„é€Ÿåº¦å¥½æ¯”é£é©°ç”µæ£çš„é«˜é“ï¼Œæ¯å°æ—¶350å…¬é‡Œï¼Œç„¶è€Œï¼Œå®ƒå´åªèƒ½ç­‰ç€æ—è¾¹è…¿è„šä¸å¤ªçµä¾¿çš„è€å¤ªå¤ªï¼Œä¹Ÿå°±æ˜¯å†…å­˜ï¼Œä»¥æ¯å°æ—¶3å…¬é‡Œçš„é€Ÿåº¦ç¼“æ…¢æ­¥è¡Œã€‚å› ä¸ºCPUéœ€è¦æ‰§è¡Œçš„æŒ‡ä»¤ã€éœ€è¦è®¿é—®çš„æ•°æ®ï¼Œéƒ½åœ¨è¿™ä¸ªé€Ÿåº¦ä¸åˆ°è‡ªå·±1%çš„å†…å­˜é‡Œã€‚</p><p><img src=\"https://static001.geekbang.org/resource/image/4f/4b/4fc459f42a67d3949402865a998bf34b.png?wh=1142*607\" alt=\"\"></p><center><span class=\"reference\">éšç€æ—¶é—´å˜è¿ï¼ŒCPUå’Œå†…å­˜ä¹‹é—´çš„æ€§èƒ½å·®è·è¶Šæ¥è¶Šå¤§</span></center><p>ä¸ºäº†å¼¥è¡¥ä¸¤è€…ä¹‹é—´çš„æ€§èƒ½å·®å¼‚ï¼Œæˆ‘ä»¬èƒ½çœŸå®åœ°æŠŠCPUçš„æ€§èƒ½æå‡ç”¨èµ·æ¥ï¼Œè€Œä¸æ˜¯è®©å®ƒåœ¨é‚£å„¿ç©ºè½¬ï¼Œæˆ‘ä»¬åœ¨ç°ä»£CPUä¸­å¼•å…¥äº†é«˜é€Ÿç¼“å­˜ã€‚</p><p>ä»CPU Cacheè¢«åŠ å…¥åˆ°ç°æœ‰çš„CPUé‡Œå¼€å§‹ï¼Œå†…å­˜ä¸­çš„æŒ‡ä»¤ã€æ•°æ®ï¼Œä¼šè¢«åŠ è½½åˆ°L1-L3 Cacheä¸­ï¼Œè€Œä¸æ˜¯ç›´æ¥ç”±CPUè®¿é—®å†…å­˜å»æ‹¿ã€‚åœ¨95%çš„æƒ…å†µä¸‹ï¼ŒCPUéƒ½åªéœ€è¦è®¿é—®L1-L3 Cacheï¼Œä»é‡Œé¢è¯»å–æŒ‡ä»¤å’Œæ•°æ®ï¼Œè€Œæ— éœ€è®¿é—®å†…å­˜ã€‚è¦æ³¨æ„çš„æ˜¯ï¼Œè¿™é‡Œæˆ‘ä»¬è¯´çš„CPU Cacheæˆ–è€…L1/L3 Cacheï¼Œä¸æ˜¯ä¸€ä¸ªå•çº¯çš„ã€æ¦‚å¿µä¸Šçš„ç¼“å­˜ï¼ˆæ¯”å¦‚ä¹‹å‰æˆ‘ä»¬è¯´çš„æ‹¿å†…å­˜ä½œä¸ºç¡¬ç›˜çš„ç¼“å­˜ï¼‰ï¼Œè€Œæ˜¯æŒ‡ç‰¹å®šçš„ç”±SRAMç»„æˆçš„ç‰©ç†èŠ¯ç‰‡ã€‚</p><p>è¿™é‡Œæ˜¯ä¸€å¼ Intel CPUçš„æ”¾å¤§ç…§ç‰‡ã€‚è¿™é‡Œé¢å¤§ç‰‡çš„é•¿æ–¹å½¢èŠ¯ç‰‡ï¼Œå°±æ˜¯è¿™ä¸ªCPUä½¿ç”¨çš„20MBçš„L3 Cacheã€‚</p><p><img src=\"https://static001.geekbang.org/resource/image/c1/15/c1dc0e3453f469fc4607557dab9d5215.jpg?wh=1142*1147\" alt=\"\"></p><center><span class=\"reference\">ç°ä»£CPUä¸­å¤§é‡çš„ç©ºé—´å·²ç»è¢«SRAMå æ®ï¼Œå›¾ä¸­ç”¨çº¢è‰²æ¡†å‡ºçš„éƒ¨åˆ†å°±æ˜¯CPUçš„L3 CacheèŠ¯ç‰‡</span></center><p>åœ¨è¿™ä¸€è®²ä¸€å¼€å§‹çš„ç¨‹åºé‡Œï¼Œè¿è¡Œç¨‹åºçš„æ—¶é—´ä¸»è¦èŠ±åœ¨äº†å°†å¯¹åº”çš„æ•°æ®ä»å†…å­˜ä¸­è¯»å–å‡ºæ¥ï¼ŒåŠ è½½åˆ°CPU Cacheé‡Œã€‚CPUä»å†…å­˜ä¸­è¯»å–æ•°æ®åˆ°CPU Cacheçš„è¿‡ç¨‹ä¸­ï¼Œæ˜¯ä¸€å°å—ä¸€å°å—æ¥è¯»å–æ•°æ®çš„ï¼Œè€Œä¸æ˜¯æŒ‰ç…§å•ä¸ªæ•°ç»„å…ƒç´ æ¥è¯»å–æ•°æ®çš„ã€‚è¿™æ ·ä¸€å°å—ä¸€å°å—çš„æ•°æ®ï¼Œåœ¨CPU Cacheé‡Œé¢ï¼Œæˆ‘ä»¬æŠŠå®ƒå«ä½œCache Lineï¼ˆç¼“å­˜å—ï¼‰ã€‚</p><p>åœ¨æˆ‘ä»¬æ—¥å¸¸ä½¿ç”¨çš„IntelæœåŠ¡å™¨æˆ–è€…PCé‡Œï¼ŒCache Lineçš„å¤§å°é€šå¸¸æ˜¯64å­—èŠ‚ã€‚è€Œåœ¨ä¸Šé¢çš„å¾ªç¯2é‡Œé¢ï¼Œæˆ‘ä»¬æ¯éš”16ä¸ªæ•´å‹æ•°è®¡ç®—ä¸€æ¬¡ï¼Œ16ä¸ªæ•´å‹æ•°æ­£å¥½æ˜¯64ä¸ªå­—èŠ‚ã€‚äºæ˜¯ï¼Œå¾ªç¯1å’Œå¾ªç¯2ï¼Œéœ€è¦æŠŠåŒæ ·æ•°é‡çš„Cache Lineæ•°æ®ä»å†…å­˜ä¸­è¯»å–åˆ°CPU Cacheä¸­ï¼Œæœ€ç»ˆä¸¤ä¸ªç¨‹åºèŠ±è´¹çš„æ—¶é—´å°±å·®åˆ«ä¸å¤§äº†ã€‚</p><p>çŸ¥é“äº†ä¸ºä»€ä¹ˆéœ€è¦CPU Cacheï¼Œæ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬å°±æ¥çœ‹ä¸€çœ‹ï¼ŒCPUç©¶ç«Ÿæ˜¯å¦‚ä½•è®¿é—®CPU Cacheçš„ï¼Œä»¥åŠCPU Cacheæ˜¯å¦‚ä½•ç»„ç»‡æ•°æ®ï¼Œä½¿å¾—CPUå¯ä»¥æ‰¾åˆ°è‡ªå·±æƒ³è¦è®¿é—®çš„æ•°æ®çš„ã€‚å› ä¸ºCacheä½œä¸ºâ€œç¼“å­˜â€çš„æ„æ€ï¼Œåœ¨å¾ˆå¤šåˆ«çš„å­˜å‚¨è®¾å¤‡é‡Œé¢éƒ½ä¼šç”¨åˆ°ã€‚ä¸ºäº†é¿å…ä½ æ··æ·†ï¼Œåœ¨è¡¨ç¤ºæŠ½è±¡çš„â€œç¼“å­˜â€œæ¦‚å¿µæ—¶ï¼Œç”¨ä¸­æ–‡çš„â€œç¼“å­˜â€ï¼›å¦‚æœæ˜¯CPU Cacheï¼Œæˆ‘ä¼šç”¨â€œé«˜é€Ÿç¼“å­˜â€œæˆ–è€…è‹±æ–‡çš„â€œCacheâ€ï¼Œæ¥è¡¨ç¤ºã€‚</p><h2>Cacheçš„æ•°æ®ç»“æ„å’Œè¯»å–è¿‡ç¨‹æ˜¯ä»€ä¹ˆæ ·çš„ï¼Ÿ</h2><p>ç°ä»£CPUè¿›è¡Œæ•°æ®è¯»å–çš„æ—¶å€™ï¼Œæ— è®ºæ•°æ®æ˜¯å¦å·²ç»å­˜å‚¨åœ¨Cacheä¸­ï¼ŒCPUå§‹ç»ˆä¼šé¦–å…ˆè®¿é—®Cacheã€‚åªæœ‰å½“CPUåœ¨Cacheä¸­æ‰¾ä¸åˆ°æ•°æ®çš„æ—¶å€™ï¼Œæ‰ä¼šå»è®¿é—®å†…å­˜ï¼Œå¹¶å°†è¯»å–åˆ°çš„æ•°æ®å†™å…¥Cacheä¹‹ä¸­ã€‚å½“æ—¶é—´å±€éƒ¨æ€§åŸç†èµ·ä½œç”¨åï¼Œè¿™ä¸ªæœ€è¿‘åˆšåˆšè¢«è®¿é—®çš„æ•°æ®ï¼Œä¼šå¾ˆå¿«å†æ¬¡è¢«è®¿é—®ã€‚è€ŒCacheçš„è®¿é—®é€Ÿåº¦è¿œè¿œå¿«äºå†…å­˜ï¼Œè¿™æ ·ï¼ŒCPUèŠ±åœ¨ç­‰å¾…å†…å­˜è®¿é—®ä¸Šçš„æ—¶é—´å°±å¤§å¤§å˜çŸ­äº†ã€‚</p><p><img src=\"https://static001.geekbang.org/resource/image/3a/cc/3a6fcfd1155e03f4f2781dbb6ddaf6cc.png?wh=1142*579\" alt=\"\"></p><p>è¿™æ ·çš„è®¿é—®æœºåˆ¶ï¼Œå’Œæˆ‘ä»¬è‡ªå·±åœ¨å¼€å‘åº”ç”¨ç³»ç»Ÿçš„æ—¶å€™ï¼Œâ€œä½¿ç”¨å†…å­˜ä½œä¸ºç¡¬ç›˜çš„ç¼“å­˜â€çš„é€»è¾‘æ˜¯ä¸€æ ·çš„ã€‚åœ¨å„ç±»åŸºå‡†æµ‹è¯•ï¼ˆBenchmarkï¼‰å’Œå®é™…åº”ç”¨åœºæ™¯ä¸­ï¼ŒCPU Cacheçš„å‘½ä¸­ç‡é€šå¸¸èƒ½è¾¾åˆ°95%ä»¥ä¸Šã€‚</p><p>é—®é¢˜æ¥äº†ï¼ŒCPUå¦‚ä½•çŸ¥é“è¦è®¿é—®çš„å†…å­˜æ•°æ®ï¼Œå­˜å‚¨åœ¨Cacheçš„å“ªä¸ªä½ç½®å‘¢ï¼Ÿæ¥ä¸‹æ¥ï¼Œæˆ‘å°±ä»æœ€åŸºæœ¬çš„<strong>ç›´æ¥æ˜ å°„Cache</strong>ï¼ˆDirect Mapped Cacheï¼‰è¯´èµ·ï¼Œå¸¦ä½ æ¥çœ‹æ•´ä¸ªCacheçš„æ•°æ®ç»“æ„å’Œè®¿é—®é€»è¾‘ã€‚</p><p>åœ¨å¼€å¤´çš„3è¡Œå°ç¨‹åºé‡Œæˆ‘è¯´è¿‡ï¼ŒCPUè®¿é—®å†…å­˜æ•°æ®ï¼Œæ˜¯ä¸€å°å—ä¸€å°å—æ•°æ®æ¥è¯»å–çš„ã€‚å¯¹äºè¯»å–å†…å­˜ä¸­çš„æ•°æ®ï¼Œæˆ‘ä»¬é¦–å…ˆæ‹¿åˆ°çš„æ˜¯æ•°æ®æ‰€åœ¨çš„<strong>å†…å­˜å—</strong>ï¼ˆBlockï¼‰çš„åœ°å€ã€‚è€Œç›´æ¥æ˜ å°„Cacheé‡‡ç”¨çš„ç­–ç•¥ï¼Œå°±æ˜¯ç¡®ä¿ä»»ä½•ä¸€ä¸ªå†…å­˜å—çš„åœ°å€ï¼Œå§‹ç»ˆæ˜ å°„åˆ°ä¸€ä¸ªå›ºå®šçš„CPU Cacheåœ°å€ï¼ˆCache Lineï¼‰ã€‚è€Œè¿™ä¸ªæ˜ å°„å…³ç³»ï¼Œé€šå¸¸ç”¨modè¿ç®—ï¼ˆæ±‚ä½™è¿ç®—ï¼‰æ¥å®ç°ã€‚ä¸‹é¢æˆ‘ä¸¾ä¸ªä¾‹å­å¸®ä½ ç†è§£ä¸€ä¸‹ã€‚</p><p>æ¯”å¦‚è¯´ï¼Œæˆ‘ä»¬çš„ä¸»å†…å­˜è¢«åˆ†æˆ0ï½31å·è¿™æ ·32ä¸ªå—ã€‚æˆ‘ä»¬ä¸€å…±æœ‰8ä¸ªç¼“å­˜å—ã€‚ç”¨æˆ·æƒ³è¦è®¿é—®ç¬¬21å·å†…å­˜å—ã€‚å¦‚æœ21å·å†…å­˜å—å†…å®¹åœ¨ç¼“å­˜å—ä¸­çš„è¯ï¼Œå®ƒä¸€å®šåœ¨5å·ç¼“å­˜å—ï¼ˆ21 mod 8 = 5ï¼‰ä¸­ã€‚</p><p><img src=\"https://static001.geekbang.org/resource/image/52/22/522eade51bbfad19fd25eb4f3ce80f22.png?wh=1142*793\" alt=\"\"></p><center><span class=\"reference\">Cacheé‡‡ç”¨modçš„æ–¹å¼ï¼ŒæŠŠå†…å­˜å—æ˜ å°„åˆ°å¯¹åº”çš„CPU Cacheä¸­</span></center><p>å®é™…è®¡ç®—ä¸­ï¼Œæœ‰ä¸€ä¸ªå°å°çš„æŠ€å·§ï¼Œé€šå¸¸æˆ‘ä»¬ä¼šæŠŠç¼“å­˜å—çš„æ•°é‡è®¾ç½®æˆ2çš„Næ¬¡æ–¹ã€‚è¿™æ ·åœ¨è®¡ç®—å–æ¨¡çš„æ—¶å€™ï¼Œå¯ä»¥ç›´æ¥å–åœ°å€çš„ä½Nä½ï¼Œä¹Ÿå°±æ˜¯äºŒè¿›åˆ¶é‡Œé¢çš„åå‡ ä½ã€‚æ¯”å¦‚è¿™é‡Œçš„8ä¸ªç¼“å­˜å—ï¼Œå°±æ˜¯2çš„3æ¬¡æ–¹ã€‚é‚£ä¹ˆï¼Œåœ¨å¯¹21å–æ¨¡çš„æ—¶å€™ï¼Œå¯ä»¥å¯¹21çš„2è¿›åˆ¶è¡¨ç¤º10101å–åœ°å€çš„ä½ä¸‰ä½ï¼Œä¹Ÿå°±æ˜¯101ï¼Œå¯¹åº”çš„5ï¼Œå°±æ˜¯å¯¹åº”çš„ç¼“å­˜å—åœ°å€ã€‚</p><p><img src=\"https://static001.geekbang.org/resource/image/ca/80/caadd2728b5cfcd2bd704103570f3a80.png?wh=1142*762\" alt=\"\"></p><p>å–Blockåœ°å€çš„ä½ä½ï¼Œå°±èƒ½å¾—åˆ°å¯¹åº”çš„Cache Lineåœ°å€ï¼Œé™¤äº†21å·å†…å­˜å—å¤–ï¼Œ13å·ã€5å·ç­‰å¾ˆå¤šå†…å­˜å—çš„æ•°æ®ï¼Œéƒ½å¯¹åº”ç€5å·ç¼“å­˜å—ä¸­ã€‚æ—¢ç„¶å¦‚æ­¤ï¼Œå‡å¦‚ç°åœ¨CPUæƒ³è¦è¯»å–21å·å†…å­˜å—ï¼Œåœ¨è¯»å–åˆ°5å·ç¼“å­˜å—çš„æ—¶å€™ï¼Œæˆ‘ä»¬æ€ä¹ˆçŸ¥é“é‡Œé¢çš„æ•°æ®ï¼Œç©¶ç«Ÿæ˜¯ä¸æ˜¯21å·å¯¹åº”çš„æ•°æ®å‘¢ï¼ŸåŒæ ·ï¼Œå»ºè®®ä½ å€ŸåŠ©ç°æœ‰çŸ¥è¯†ï¼Œå…ˆè‡ªå·±æ€è€ƒä¸€ä¸‹ï¼Œç„¶åå†çœ‹æˆ‘ä¸‹é¢çš„åˆ†æï¼Œè¿™æ ·ä¼šå°è±¡æ¯”è¾ƒæ·±åˆ»ã€‚</p><p>è¿™ä¸ªæ—¶å€™ï¼Œåœ¨å¯¹åº”çš„ç¼“å­˜å—ä¸­ï¼Œæˆ‘ä»¬ä¼šå­˜å‚¨ä¸€ä¸ª<strong>ç»„æ ‡è®°</strong>ï¼ˆTagï¼‰ã€‚è¿™ä¸ªç»„æ ‡è®°ä¼šè®°å½•ï¼Œå½“å‰ç¼“å­˜å—å†…å­˜å‚¨çš„æ•°æ®å¯¹åº”çš„å†…å­˜å—ï¼Œè€Œç¼“å­˜å—æœ¬èº«çš„åœ°å€è¡¨ç¤ºè®¿é—®åœ°å€çš„ä½Nä½ã€‚å°±åƒä¸Šé¢çš„ä¾‹å­ï¼Œ21çš„ä½3ä½101ï¼Œç¼“å­˜å—æœ¬èº«çš„åœ°å€å·²ç»æ¶µç›–äº†å¯¹åº”çš„ä¿¡æ¯ã€å¯¹åº”çš„ç»„æ ‡è®°ï¼Œæˆ‘ä»¬åªéœ€è¦è®°å½•21å‰©ä½™çš„é«˜2ä½çš„ä¿¡æ¯ï¼Œä¹Ÿå°±æ˜¯10å°±å¯ä»¥äº†ã€‚</p><p>é™¤äº†ç»„æ ‡è®°ä¿¡æ¯ä¹‹å¤–ï¼Œç¼“å­˜å—ä¸­è¿˜æœ‰ä¸¤ä¸ªæ•°æ®ã€‚ä¸€ä¸ªè‡ªç„¶æ˜¯ä»ä¸»å†…å­˜ä¸­åŠ è½½æ¥çš„å®é™…å­˜æ”¾çš„æ•°æ®ï¼Œå¦ä¸€ä¸ªæ˜¯<strong>æœ‰æ•ˆä½</strong>ï¼ˆvalid bitï¼‰ã€‚å•¥æ˜¯æœ‰æ•ˆä½å‘¢ï¼Ÿå®ƒå…¶å®å°±æ˜¯ç”¨æ¥æ ‡è®°ï¼Œå¯¹åº”çš„ç¼“å­˜å—ä¸­çš„æ•°æ®æ˜¯å¦æ˜¯æœ‰æ•ˆçš„ï¼Œç¡®ä¿ä¸æ˜¯æœºå™¨åˆšåˆšå¯åŠ¨æ—¶å€™çš„ç©ºæ•°æ®ã€‚å¦‚æœæœ‰æ•ˆä½æ˜¯0ï¼Œæ— è®ºå…¶ä¸­çš„ç»„æ ‡è®°å’ŒCache Lineé‡Œçš„æ•°æ®å†…å®¹æ˜¯ä»€ä¹ˆï¼ŒCPUéƒ½ä¸ä¼šç®¡è¿™äº›æ•°æ®ï¼Œè€Œè¦ç›´æ¥è®¿é—®å†…å­˜ï¼Œé‡æ–°åŠ è½½æ•°æ®ã€‚</p><p>CPUåœ¨è¯»å–æ•°æ®çš„æ—¶å€™ï¼Œå¹¶ä¸æ˜¯è¦è¯»å–ä¸€æ•´ä¸ªBlockï¼Œè€Œæ˜¯è¯»å–ä¸€ä¸ªä»–éœ€è¦çš„æ•°æ®ç‰‡æ®µã€‚è¿™æ ·çš„æ•°æ®ï¼Œæˆ‘ä»¬å«ä½œCPUé‡Œçš„ä¸€ä¸ªå­—ï¼ˆWordï¼‰ã€‚å…·ä½“æ˜¯å“ªä¸ªå­—ï¼Œå°±ç”¨è¿™ä¸ªå­—åœ¨æ•´ä¸ªBlocké‡Œé¢çš„ä½ç½®æ¥å†³å®šã€‚è¿™ä¸ªä½ç½®ï¼Œæˆ‘ä»¬å«ä½œåç§»é‡ï¼ˆOffsetï¼‰ã€‚</p><p>æ€»ç»“ä¸€ä¸‹ï¼Œ<strong>ä¸€ä¸ªå†…å­˜çš„è®¿é—®åœ°å€ï¼Œæœ€ç»ˆåŒ…æ‹¬é«˜ä½ä»£è¡¨çš„ç»„æ ‡è®°ã€ä½ä½ä»£è¡¨çš„ç´¢å¼•ï¼Œä»¥åŠåœ¨å¯¹åº”çš„Data Blockä¸­å®šä½å¯¹åº”å­—çš„ä½ç½®åç§»é‡ã€‚</strong></p><p><img src=\"https://static001.geekbang.org/resource/image/13/d4/1313fe1e4eb3b5c949284c8b215af8d4.png?wh=1142*638\" alt=\"\"></p><center><span class=\"reference\">å†…å­˜åœ°å€åˆ°Cache Lineçš„å…³ç³»</span></center><p>è€Œå†…å­˜åœ°å€å¯¹åº”åˆ°Cacheé‡Œçš„æ•°æ®ç»“æ„ï¼Œåˆ™å¤šäº†ä¸€ä¸ªæœ‰æ•ˆä½å’Œå¯¹åº”çš„æ•°æ®ï¼Œç”±â€œ<strong>ç´¢å¼• + æœ‰æ•ˆä½</strong>  <strong>+ ç»„æ ‡è®° + æ•°æ®</strong>â€ç»„æˆã€‚å¦‚æœå†…å­˜ä¸­çš„æ•°æ®å·²ç»åœ¨CPU Cacheé‡Œäº†ï¼Œé‚£ä¸€ä¸ªå†…å­˜åœ°å€çš„è®¿é—®ï¼Œå°±ä¼šç»å†è¿™æ ·4ä¸ªæ­¥éª¤ï¼š</p><ol>\n<li>æ ¹æ®å†…å­˜åœ°å€çš„ä½ä½ï¼Œè®¡ç®—åœ¨Cacheä¸­çš„ç´¢å¼•ï¼›</li>\n<li>åˆ¤æ–­æœ‰æ•ˆä½ï¼Œç¡®è®¤Cacheä¸­çš„æ•°æ®æ˜¯æœ‰æ•ˆçš„ï¼›</li>\n<li>å¯¹æ¯”å†…å­˜è®¿é—®åœ°å€çš„é«˜ä½ï¼Œå’ŒCacheä¸­çš„ç»„æ ‡è®°ï¼Œç¡®è®¤Cacheä¸­çš„æ•°æ®å°±æ˜¯æˆ‘ä»¬è¦è®¿é—®çš„å†…å­˜æ•°æ®ï¼Œä»Cache Lineä¸­è¯»å–åˆ°å¯¹åº”çš„æ•°æ®å—ï¼ˆData Blockï¼‰ï¼›</li>\n<li>æ ¹æ®å†…å­˜åœ°å€çš„Offsetä½ï¼Œä»Data Blockä¸­ï¼Œè¯»å–å¸Œæœ›è¯»å–åˆ°çš„å­—ã€‚</li>\n</ol><p>å¦‚æœåœ¨2ã€3è¿™ä¸¤ä¸ªæ­¥éª¤ä¸­ï¼ŒCPUå‘ç°ï¼ŒCacheä¸­çš„æ•°æ®å¹¶ä¸æ˜¯è¦è®¿é—®çš„å†…å­˜åœ°å€çš„æ•°æ®ï¼Œé‚£CPUå°±ä¼šè®¿é—®å†…å­˜ï¼Œå¹¶æŠŠå¯¹åº”çš„Block Dataæ›´æ–°åˆ°Cache Lineä¸­ï¼ŒåŒæ—¶æ›´æ–°å¯¹åº”çš„æœ‰æ•ˆä½å’Œç»„æ ‡è®°çš„æ•°æ®ã€‚</p><p>å¥½äº†ï¼Œè®²åˆ°è¿™é‡Œï¼Œç›¸ä¿¡ä½ æ˜ç™½ç°ä»£CPUï¼Œæ˜¯å¦‚ä½•é€šè¿‡ç›´æ¥æ˜ å°„Cacheï¼Œæ¥å®šä½ä¸€ä¸ªå†…å­˜è®¿é—®åœ°å€åœ¨Cacheä¸­çš„ä½ç½®äº†ã€‚å…¶å®ï¼Œé™¤äº†ç›´æ¥æ˜ å°„Cacheä¹‹å¤–ï¼Œæˆ‘ä»¬å¸¸è§çš„ç¼“å­˜æ”¾ç½®ç­–ç•¥è¿˜æœ‰å…¨ç›¸è¿Cacheï¼ˆFully Associative Cacheï¼‰ã€ç»„ç›¸è¿Cacheï¼ˆSet Associative Cacheï¼‰ã€‚è¿™å‡ ç§ç­–ç•¥çš„æ•°æ®ç»“æ„éƒ½æ˜¯ç›¸ä¼¼çš„ï¼Œç†è§£äº†æœ€ç®€å•çš„ç›´æ¥æ˜ å°„Cacheï¼Œå…¶ä»–çš„ç­–ç•¥ä½ å¾ˆå®¹æ˜“å°±èƒ½ç†è§£äº†ã€‚</p><h2>å‡å°‘4æ¯«ç§’ï¼Œå…¬å¸æŒ£äº†å¤šå°‘é’±?</h2><p>åˆšæ‰æˆ‘èŠ±äº†å¾ˆå¤šç¯‡å¹…ï¼Œè®²äº†CPUå’Œå†…å­˜ä¹‹é—´çš„æ€§èƒ½å·®å¼‚ï¼Œä»¥åŠæˆ‘ä»¬å¦‚ä½•é€šè¿‡CPU Cacheæ¥å°½å¯èƒ½è§£å†³è¿™ä¸¤è€…ä¹‹é—´çš„æ€§èƒ½é¸¿æ²Ÿã€‚ä½ å¯èƒ½è¦é—®äº†ï¼Œè¿™æ ·åšçš„æ„ä¹‰å’Œä»·å€¼ç©¶ç«Ÿæ˜¯ä»€ä¹ˆï¼Ÿæ¯•ç«Ÿï¼Œä¸€æ¬¡å†…å­˜çš„è®¿é—®ï¼Œåªä¸è¿‡éœ€è¦100çº³ç§’è€Œå·²ã€‚1ç§’é’Ÿæ—¶é—´å†…ï¼Œè¶³æœ‰1000ä¸‡ä¸ª100çº³ç§’ã€‚åˆ«ç€æ€¥ï¼Œæˆ‘ä»¬å…ˆæ¥çœ‹ä¸€ä¸ªæ•…äº‹ã€‚</p><p>2008å¹´ï¼Œä¸€å®¶å«ä½œSpread Networksçš„é€šä¿¡å…¬å¸èŠ±è´¹3äº¿ç¾å…ƒï¼Œåšäº†ä¸€ä¸ªå…‰ç¼†å»ºè®¾é¡¹ç›®ã€‚ç›®æ ‡æ˜¯å»ºè®¾ä¸€æ¡ä»èŠåŠ å“¥åˆ°æ–°æ³½è¥¿ï¼Œæ€»é•¿1331å…¬é‡Œçš„å…‰ç¼†çº¿è·¯ã€‚å»ºè®¾è¿™æ¡çº¿è·¯çš„ç›®çš„ï¼Œå…¶å®æ˜¯ä¸ºäº†å°†ä¸¤åœ°ä¹‹é—´åŸæœ‰çš„ç½‘ç»œè®¿é—®å»¶æ—¶ï¼Œä»17æ¯«ç§’é™ä½åˆ°13æ¯«ç§’ã€‚</p><p>ä½ å¯èƒ½ä¼šè¯´ï¼Œä»…ä»…ç¼©çŸ­äº†4æ¯«ç§’æ—¶é—´å•Šï¼Œå´èŠ±è´¹3ä¸ªäº¿ï¼ŒçœŸçš„å€¼å—ï¼Ÿä¸ºè¿™4æ¯«ç§’æ—¶é—´ä¹°å•çš„ï¼Œå…¶å®æ˜¯ä¸€æ‰¹é«˜é¢‘äº¤æ˜“å…¬å¸ã€‚å®ƒä»¬ä»¥5å¹´1400ä¸‡ç¾å…ƒçš„ä»·æ ¼ï¼Œä½¿ç”¨è¿™æ¡çº¿è·¯ã€‚åˆ©ç”¨è¿™çŸ­çŸ­çš„4æ¯«ç§’çš„æ—¶é—´ä¼˜åŠ¿ï¼Œè¿™äº›å…¬å¸é€šè¿‡é«˜æ€§èƒ½çš„è®¡ç®—æœºç¨‹åºï¼Œåœ¨èŠåŠ å“¥å’Œæ–°æ³½è¥¿ä¸¤åœ°çš„äº¤æ˜“æ‰€è¿›è¡Œé«˜é¢‘å¥—åˆ©ï¼Œä»¥è·å¾—æ¯å¹´ä»¥10äº¿ç¾å…ƒè®¡çš„åˆ©æ¶¦ã€‚ç°åœ¨ä½ è¿˜è§‰å¾—è¿™ä¸ªä¸å€¼å¾—å—ï¼Ÿ</p><p>å…¶å®ï¼Œåªè¦350å¾®ç§’çš„å·®å¼‚ï¼Œå°±è¶³å¤Ÿé«˜é¢‘äº¤æ˜“å…¬å¸ç”¨æ¥è¿›è¡Œæ— é£é™©å¥—åˆ©äº†ã€‚è€Œ350å¾®ç§’ï¼Œå¦‚æœç”¨æ¥è¿›è¡Œ100çº³ç§’ä¸€æ¬¡çš„å†…å­˜è®¿é—®ï¼Œå¤§çº¦åªå¤Ÿè¿›è¡Œ3500æ¬¡ã€‚è€Œå¼•å…¥CPU Cacheä¹‹åï¼Œæˆ‘ä»¬å¯ä»¥è¿›è¡Œçš„æ•°æ®è®¿é—®æ¬¡æ•°ï¼Œæå‡äº†æ•°åå€ï¼Œä½¿å¾—å„ç§äº¤æ˜“ç­–ç•¥æˆä¸ºå¯èƒ½ã€‚</p><h2>æ€»ç»“å»¶ä¼¸</h2><p>å¾ˆå¤šæ—¶å€™ï¼Œç¨‹åºçš„æ€§èƒ½ç“¶é¢ˆï¼Œæ¥è‡ªä½¿ç”¨DRAMèŠ¯ç‰‡çš„å†…å­˜è®¿é—®é€Ÿåº¦ã€‚</p><p>æ ¹æ®æ‘©å°”å®šå¾‹ï¼Œè‡ªä¸Šä¸–çºª80å¹´ä»£ä»¥æ¥ï¼ŒCPUå’Œå†…å­˜çš„æ€§èƒ½é¸¿æ²Ÿè¶Šæ‹‰è¶Šå¤§ã€‚äºæ˜¯ï¼Œç°ä»£CPUçš„è®¾è®¡è€…ä»¬ï¼Œç›´æ¥åœ¨CPUä¸­åµŒå…¥äº†ä½¿ç”¨æ›´é«˜æ€§èƒ½çš„SRAMèŠ¯ç‰‡çš„Cacheï¼Œæ¥å¼¥è¡¥è¿™ä¸€æ€§èƒ½å·®å¼‚ã€‚é€šè¿‡å·§å¦™åœ°å°†å†…å­˜åœ°å€ï¼Œæ‹†åˆ†æˆâ€œç´¢å¼•+ç»„æ ‡è®°+åç§»é‡â€çš„æ–¹å¼ï¼Œä½¿å¾—æˆ‘ä»¬å¯ä»¥å°†å¾ˆå¤§çš„å†…å­˜åœ°å€ï¼Œæ˜ å°„åˆ°å¾ˆå°çš„CPU Cacheåœ°å€é‡Œã€‚è€ŒCPU Cacheå¸¦æ¥çš„æ¯«ç§’ä¹ƒè‡³å¾®ç§’çº§åˆ«çš„æ€§èƒ½å·®å¼‚ï¼Œåˆèƒ½å¸¦æ¥å·¨å¤§çš„å•†ä¸šåˆ©ç›Šï¼Œåå¤šå¹´å‰çš„é«˜é¢‘äº¤æ˜“è¡Œä¸šå°±æ˜¯æœ€å¥½çš„ä¾‹å­ã€‚</p><p>åœ¨ææ¸…æ¥šä»å†…å­˜åŠ è½½æ•°æ®åˆ°Cacheï¼Œä»¥åŠä»Cacheé‡Œè¯»å–åˆ°æƒ³è¦çš„æ•°æ®ä¹‹åï¼Œæˆ‘ä»¬åˆè¦é¢ä¸´ä¸€ä¸ªæ–°çš„æŒ‘æˆ˜äº†ã€‚CPUä¸ä»…è¦è¯»æ•°æ®ï¼Œè¿˜éœ€è¦å†™æ•°æ®ï¼Œæˆ‘ä»¬ä¸èƒ½åªæŠŠæ•°æ®å†™å…¥åˆ°Cacheé‡Œé¢å°±ç»“æŸäº†ã€‚ä¸‹ä¸€è®²ï¼Œæˆ‘ä»¬å°±æ¥ä»”ç»†è®²è®²ï¼ŒCPUè¦å†™å…¥æ•°æ®çš„æ—¶å€™ï¼Œæ€ä¹ˆæ—¢ä¸ç‰ºç‰²æ€§èƒ½ï¼Œåˆèƒ½ä¿è¯æ•°æ®çš„ä¸€è‡´æ€§ã€‚</p><h2>æ¨èé˜…è¯»</h2><p>å¦‚æœä½ å­¦æœ‰ä½™åŠ›ï¼Œè¿™é‡Œæœ‰ä¸¤ç¯‡æ–‡ç« æ¨èç»™ä½ é˜…è¯»ã€‚</p><p>å¦‚æœæƒ³æ·±å…¥äº†è§£CPUå’Œå†…å­˜ä¹‹é—´çš„è®¿é—®æ€§èƒ½ï¼Œä½ å¯ä»¥é˜…è¯»<a href=\"https://people.freebsd.org/~lstewart/articles/cpumemory.pdf\">What Every Programmer Should Know About Memory</a>ã€‚</p><p>ç°ä»£CPUå·²ç»å¾ˆå°‘ä½¿ç”¨ç›´æ¥æ˜ å°„Cacheäº†ï¼Œé€šå¸¸ç”¨çš„æ˜¯ç»„ç›¸è¿Cacheï¼ˆset associative cacheï¼‰ï¼Œæƒ³è¦äº†è§£ç»„ç›¸è¿Cacheï¼Œä½ å¯ä»¥é˜…è¯»ã€Šè®¡ç®—æœºç»„æˆä¸è®¾è®¡ï¼šç¡¬ä»¶/è½¯ä»¶æ¥å£ã€‹çš„5.4.1å°èŠ‚ã€‚</p><h2>è¯¾åæ€è€ƒ</h2><p>å¯¹äºäºŒç»´æ•°ç»„çš„è®¿é—®ï¼ŒæŒ‰è¡Œè¿­ä»£å’ŒæŒ‰åˆ—è¿­ä»£çš„è®¿é—®æ€§èƒ½æ˜¯ä¸€æ ·çš„å—ï¼Ÿä½ å¯ä»¥å†™ä¸€ä¸ªç¨‹åºæµ‹è¯•ä¸€ä¸‹ï¼Œå¹¶æ€è€ƒä¸€ä¸‹åŸå› ã€‚</p><p>æ¬¢è¿æŠŠä½ æ€è€ƒçš„ç»“æœå†™åœ¨ç•™è¨€åŒºã€‚å¦‚æœè§‰å¾—æœ‰æ”¶è·ï¼Œä½ ä¹Ÿå¯ä»¥æŠŠè¿™ç¯‡æ–‡ç« åˆ†äº«ç»™ä½ çš„æœ‹å‹ï¼Œå’Œä»–ä¸€èµ·è®¨è®ºå’Œå­¦ä¹ ã€‚</p>","comments":[{"had_liked":false,"id":164678,"user_name":"ç‹åŠ æ­¦","can_delete":false,"product_type":"c1","uid":1665471,"ip_address":"","ucode":"DDCFE578C6C428","user_header":"https://static001.geekbang.org/account/avatar/00/19/69/bf/50a824a4.jpg","comment_is_top":false,"comment_ctime":1577071192,"is_pvip":false,"replies":[{"id":"68137","content":"HashåŒå­¦ï¼Œ<br><br>ä½ å¥½ï¼Œç†è§£æ­£ç¡®ï¼","user_name":"ä½œè€…å›å¤","user_name_real":"å¾æ–‡æµ©","uid":"1053568","ctime":1580651141,"ip_address":"","comment_id":164678,"utype":1}],"discussion_count":4,"race_medal":0,"score":"216325435992","product_id":100026001,"comment_content":"æˆ‘çš„ç”µè„‘æµ‹è¯•çš„ç»“æœ<br> int[][] arr = new int[10000][10000];<br>æŒ‰è¡Œè¿­ä»£â€”â€”<br>280æ¯«ç§’<br>æŒ‰åˆ—è¿­ä»£â€”â€”<br>1180æ¯«ç§’<br><br>åˆ†æåŸå› â€”â€”<br>1ã€é¦–é€‰æ•°ç»„çš„å­˜å‚¨æ–¹å¼æ˜¯è¿ç»­çš„ï¼Œåœ¨å†…å­˜ä¸­æ˜¯æŒ‰ç…§è¡Œæ¥å­˜å‚¨çš„ï¼Œéå†çš„æ—¶å€™ä¹Ÿæ˜¯ä¸€ä¸ªä¸€ä¸ªçš„å¾€åéå†<br><br>2ã€æ ¹æ®è€å¸ˆè®²çš„ï¼ŒCPUä»å†…å­˜è¯»å–æ•°æ®åˆ°CPU Cache ï¼Œæ˜¯æŒ‰ç…§ä¸€å°å—ä¸€å°å—çš„æ–¹å¼è¯»å–çš„ï¼Œå®ƒçš„ç‰©ç†å†…å­˜æ˜¯è¿ç»­çš„ï¼Œå‡ ä¹æ˜¯åŒè¡Œä¸åŒåˆ—ï¼Œå¦‚æœè¯´æˆ‘ä»¬æ˜¯æŒ‰ç…§åˆ—æ¥è¿­ä»£çš„è¯ï¼Œé‚£ä¹ˆå°±ä¼šå¯¼è‡´å­˜å‚¨å¿«æ— æ³•ä½¿ç”¨ï¼Œæˆ‘ä»¬å°±ä¸å¾—ä¸ä»å†…å­˜ä¸­è¯»å–æ•°æ®ï¼Œè€Œåœ¨å†…å­˜ä¸­ç›´æ¥è¯»å–æ•°æ®å’Œä»é«˜é€Ÿç¼“å­˜ä¸­ç›´æ¥è¯»å–æ•°æ®çš„æ•ˆç‡é‚£å¯ä¸æ˜¯ä¸€èˆ¬çš„å·®è·ï¼Œæ‰€ä»¥è¯´æŒ‰ç…§è¡Œæ¥è¿­ä»£è¯ï¼Œæˆ‘ä»¬å°±å¯ä»¥å¾ˆå¥½çš„åˆ©ç”¨çš„æ•°æ®å—ï¼Œä»é«˜é€Ÿç¼“å­˜ä¸­æ¥è¯»å–æ•°æ®ï¼Œä»è€Œæ‰€èŠ±è´¹çš„æ—¶é—´ä¹Ÿå°±æ¯”æŒ‰ç…§åˆ—æ¥è¿­ä»£æ‰€èŠ±è´¹çš„æ—¶é—´å°‘ï¼<br><br>è¿™æ˜¯æˆ‘çš„è§è§£ï¼Œæœ‰ä¸å¯¹çš„åœ°æ–¹ï¼Œè¿˜æœ›è€å¸ˆæŒ‡æ­£ï¼<br>","like_count":51,"discussions":[{"author":{"id":1053568,"avatar":"https://static001.geekbang.org/account/avatar/00/10/13/80/8de66543.jpg","nickname":"å¾æ–‡æµ©","note":"","ucode":"1D39AC564172E9","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":478862,"discussion_content":"HashåŒå­¦ï¼Œ\n\nä½ å¥½ï¼Œç†è§£æ­£ç¡®ï¼","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1580651141,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":2415283,"avatar":"https://static001.geekbang.org/account/avatar/00/24/da/b3/35859560.jpg","nickname":"CiaoğŸŒš","note":"","ucode":"B048EC8A4A4D77","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":349722,"discussion_content":"hmmm æ€ä¹ˆæˆ‘è·‘ç€ æŒ‰åˆ—è¿­ä»£åè€Œå¿«å‘¢ã€‚ã€‚ã€‚","likes_number":2,"is_delete":false,"is_hidden":false,"ctime":1613480993,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":2354332,"avatar":"https://static001.geekbang.org/account/avatar/00/23/ec/9c/b4acd768.jpg","nickname":"Sarah","note":"","ucode":"FDC8A0D30EAE28","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":379568,"discussion_content":"æˆ‘ç”¨C#è¯•çš„äºŒç»´æ•°ç»„ï¼š\næŒ‰è¡Œè¿­ä»£399ms,\næŒ‰åˆ—è¿­ä»£826ms","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1623985055,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1297523,"avatar":"https://static001.geekbang.org/account/avatar/00/13/cc/73/9c41a7ee.jpg","nickname":"é›·è’™å¾·å¼ ","note":"","ucode":"0104F5818EA7F3","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":290763,"discussion_content":"æŒ‰ç…§CSAPPç¬¬å…­ç« çš„è§£é‡Šï¼ŒæŒ‰è¡Œè¿­ä»£çš„æ­¥é•¿ä¸º1, æŒ‰åˆ—è¿­ä»£çš„æ­¥é•¿æ˜¯åˆ—çš„Nå€ï¼Œå› æ­¤æ›´è€—æ—¶","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1594601602,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":115233,"user_name":"æ–æ³¢é‚£å¥‘","can_delete":false,"product_type":"c1","uid":1464006,"ip_address":"","ucode":"85E2EBC01392B1","user_header":"https://static001.geekbang.org/account/avatar/00/16/56/c6/0b449bc6.jpg","comment_is_top":false,"comment_ctime":1563514468,"is_pvip":false,"discussion_count":1,"race_medal":0,"score":"117527631460","product_id":100026001,"comment_content":"ä¸€èˆ¬äºŒç»´æ•°ç»„åœ¨å†…å­˜ä¸­å­˜æ”¾æ˜¯æŒ‰è¡Œä¼˜å…ˆå­˜æ”¾çš„ æ‰€ä»¥åœ¨åŠ è½½æ•°æ®æ—¶å€™å°±ä¼šæŠŠä¸€è¡Œæ•°æ®åŠ è½½è¿›cacheé‡Œ è¿™æ ·cacheçš„å‘½ä¸­ç‡å°±å¤§å¤§æé«˜ å¦‚æœæŒ‰åˆ—è¿­ä»£ cacheå°±å¾ˆéš¾åå­—ä»è€Œcpuå°±è¦ç»å¸¸ä»å†…å­˜ä¸­è¯»æ•°æ® å¦‚æœæ•°æ®é‡ä¸å¤§çš„è¯ä¸¤ç§æ–¹å¼å¯èƒ½æ²¡ä»€ä¹ˆæ„Ÿè§‰ ä¸€æ—¦æ•°æ®é‡å¾ˆå¤§çš„è¯æŒ‰è¡Œè¿­ä»£çš„é€Ÿåº¦å°±èƒ½æ„Ÿè§‰å‡ºæ¥äº†","like_count":27,"discussions":[{"author":{"id":1484184,"avatar":"https://static001.geekbang.org/account/avatar/00/16/a5/98/a65ff31a.jpg","nickname":"djfhchdh","note":"","ucode":"E71D75328CE398","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":2398,"discussion_content":"æŒ‰ç…§è¡Œè¿­ä»£ï¼Œæ°å¥½ç¬¦åˆç©ºé—´å±€éƒ¨æ€§","likes_number":5,"is_delete":false,"is_hidden":false,"ctime":1563537416,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":137056,"user_name":"å‰ç«¯è¥¿ç“œå“¥","can_delete":false,"product_type":"c1","uid":1248576,"ip_address":"","ucode":"150130C34CD1C1","user_header":"https://static001.geekbang.org/account/avatar/00/13/0d/40/f70e5653.jpg","comment_is_top":false,"comment_ctime":1569586725,"is_pvip":false,"replies":[{"id":"52596","content":"FstaråŒå­¦ä½ å¥½ï¼Œ<br><br>37å’Œ38è®²é‡Œè®²äº†æ€ä¹ˆåšç»„ç›¸è¿çš„ç¼“å­˜åŠ è½½è¿‡ç¨‹ï¼Œåé¢çš„MESIåè®®éƒ¨åˆ†é‡Œä¹Ÿæœ‰æ€ä¹ˆåšå†™å…¥çš„é«˜é€Ÿç¼“å­˜åŒæ­¥é—®é¢˜ï¼Œå¯ä»¥ä»”ç»†çœ‹ä¸€ä¸‹ã€‚","user_name":"ä½œè€…å›å¤","user_name_real":"å¾æ–‡æµ©","uid":"1053568","ctime":1569650765,"ip_address":"","comment_id":137056,"utype":1}],"discussion_count":1,"race_medal":0,"score":"23044423205","product_id":100026001,"comment_content":"æœ‰ç‚¹åƒå“ˆå¸Œè¡¨ã€‚é‚£å¦‚æœè¯»å–çš„å¤šä¸ªå†…å­˜æ•°æ®çš„åœ°å€éƒ½æŒ‡å‘åŒä¸€ä¸ªç¼“å­˜å—æ€ä¹ˆåŠï¼Ÿç›´æ¥è¦†ç›–æ‰ï¼Ÿ","like_count":5,"discussions":[{"author":{"id":1053568,"avatar":"https://static001.geekbang.org/account/avatar/00/10/13/80/8de66543.jpg","nickname":"å¾æ–‡æµ©","note":"","ucode":"1D39AC564172E9","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":468921,"discussion_content":"FstaråŒå­¦ä½ å¥½ï¼Œ\n\n37å’Œ38è®²é‡Œè®²äº†æ€ä¹ˆåšç»„ç›¸è¿çš„ç¼“å­˜åŠ è½½è¿‡ç¨‹ï¼Œåé¢çš„MESIåè®®éƒ¨åˆ†é‡Œä¹Ÿæœ‰æ€ä¹ˆåšå†™å…¥çš„é«˜é€Ÿç¼“å­˜åŒæ­¥é—®é¢˜ï¼Œå¯ä»¥ä»”ç»†çœ‹ä¸€ä¸‹ã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1569650765,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":134642,"user_name":"å°å…ˆç”Ÿ","can_delete":false,"product_type":"c1","uid":1055214,"ip_address":"","ucode":"E5F2052E0323C0","user_header":"https://static001.geekbang.org/account/avatar/00/10/19/ee/e395a35e.jpg","comment_is_top":false,"comment_ctime":1568884933,"is_pvip":false,"replies":[{"id":"52619","content":"å°å…ˆç”ŸåŒå­¦ï¼Œ<br><br>ä½ å¥½ï¼Œåç§»é‡æ˜¯åœ¨å†…å­˜åœ°å€çš„è®¿é—®è¯·æ±‚é‡Œçš„ï¼Œå¹¶ä¸ä¼šå­˜åœ¨æ˜ å°„å…³ç³»é‡Œï¼Œä¸éœ€è¦é¢„å…ˆå­˜å•Šã€‚","user_name":"ä½œè€…å›å¤","user_name_real":"å¾æ–‡æµ©","uid":"1053568","ctime":1569656113,"ip_address":"","comment_id":134642,"utype":1}],"discussion_count":3,"race_medal":0,"score":"18748754117","product_id":100026001,"comment_content":"æˆ‘æœ‰ä¸ªç–‘é—®ï¼š<br>å†…å­˜ä¸­è¯»å–æ•°æ®ï¼Œä¹Ÿæ˜¯æŒ‰ç…§ä¸€å—ä¸€å—æ¥çš„ã€‚<br>é‚£ä¸€ä¸ªå†…å­˜åœ°å€æ˜¯æ€ä¹ˆå­˜å‚¨å¯¹åº”å­—çš„ä½ç½®åç§»é‡ã€‚é‚£å®ƒå¾—å­˜å¤šå°‘åç§»é‡å•Šï¼Ÿ","like_count":4,"discussions":[{"author":{"id":1053568,"avatar":"https://static001.geekbang.org/account/avatar/00/10/13/80/8de66543.jpg","nickname":"å¾æ–‡æµ©","note":"","ucode":"1D39AC564172E9","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":467841,"discussion_content":"å°å…ˆç”ŸåŒå­¦ï¼Œ\n\nä½ å¥½ï¼Œåç§»é‡æ˜¯åœ¨å†…å­˜åœ°å€çš„è®¿é—®è¯·æ±‚é‡Œçš„ï¼Œå¹¶ä¸ä¼šå­˜åœ¨æ˜ å°„å…³ç³»é‡Œï¼Œä¸éœ€è¦é¢„å…ˆå­˜å•Šã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1569656113,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1250807,"avatar":"https://static001.geekbang.org/account/avatar/00/13/15/f7/744720a2.jpg","nickname":"DriveMan_é‚±ä½³æº","note":"","ucode":"A4C83BF07DEE7A","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":20030,"discussion_content":"cpuè¯»å–å†…å­˜æ•°æ®ï¼Œæ˜¯ä»¥é¡µ4kbä¸ºå•ä½æ¥è¯»å†™çš„ï¼Œcacheä»å†…å­˜è¯»å–æ‰æ˜¯ä¸€å—ä¸€å—çš„ï¼Œæ¯å—ä»¥64bitä¸ºå•ä½","likes_number":1,"is_delete":false,"is_hidden":false,"ctime":1569250141,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":1,"child_discussions":[{"author":{"id":1361746,"avatar":"https://static001.geekbang.org/account/avatar/00/14/c7/52/c5adf218.jpg","nickname":"å–œæ¬¢åœ°çƒçš„é˜¿åŸ¹åŒå­¦","note":"","ucode":"5F97037585F857","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":1250807,"avatar":"https://static001.geekbang.org/account/avatar/00/13/15/f7/744720a2.jpg","nickname":"DriveMan_é‚±ä½³æº","note":"","ucode":"A4C83BF07DEE7A","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":347229,"discussion_content":"å¥½åƒä¸å¯¹å•Šï¼Œ Linux ä¼šé»˜è®¤ä»¥é¡µ4kb ä¸ºå•ä½ç®¡ç†å†…å­˜ï¼Œä½†æ˜¯CPUè¯»å–å†…å­˜æ•°æ®ï¼Œä¸æ˜¯ä»¥é¡µ4kbä¸ºå•ä½è¿›è¡Œè¯»å–ã€‚è€Œæ˜¯ä»¥Cache line(64bit)ä¸ºå•ä½è¿›è¡Œè¯»å–çš„ï¼Œå…·ä½“è¯»å¤šå°‘ï¼Œå¹¶ä¸ç¡®å®šå•Šã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1612178700,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":20030,"ip_address":""},"score":347229,"extra":""}]}]},{"had_liked":false,"id":256946,"user_name":"å°¼å¤æ‹‰æ–¯","can_delete":false,"product_type":"c1","uid":2026074,"ip_address":"","ucode":"82EE35B505C09A","user_header":"","comment_is_top":false,"comment_ctime":1603790665,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"14488692553","product_id":100026001,"comment_content":"8ä¸ªç¼“å­˜å— åº”è¯¥æ˜¯cake line 0 åˆ°cake line 7 é€”ä¸­å¤šäº†ä¸€ä¸ªcake line 8","like_count":4},{"had_liked":false,"id":283833,"user_name":"æäºŒæœ¨","can_delete":false,"product_type":"c1","uid":1103091,"ip_address":"","ucode":"30E03BB84ADB27","user_header":"https://static001.geekbang.org/account/avatar/00/10/d4/f3/129d6dfe.jpg","comment_is_top":false,"comment_ctime":1615950115,"is_pvip":true,"discussion_count":0,"race_medal":0,"score":"10205884707","product_id":100026001,"comment_content":"æˆ‘ä»¬ä¸ºä»€ä¹ˆéœ€è¦é«˜é€Ÿç¼“å­˜?<br>CPU çš„é€Ÿåº¦å¥½æ¯”é£é©°ç”µæ£çš„é«˜é“ï¼Œè€Œå†…å­˜åƒè„šä¸å¤ªçµä¾¿çš„è€å¤ªå¤ªï¼Œé€Ÿåº¦ä¸åŒ¹é…<br>Cache çš„æ•°æ®ç»“æ„å’Œè¯»å–è¿‡ç¨‹æ˜¯ä»€ä¹ˆæ ·çš„<br>   ç°ä»£ CPU è¿›è¡Œæ•°æ®è¯»å–çš„æ—¶å€™ï¼Œæ— è®ºæ•°æ®æ˜¯å¦å·²ç»å­˜å‚¨åœ¨ Cache ä¸­ï¼ŒCPU å§‹ç»ˆä¼šé¦–å…ˆè®¿é—® Cacheã€‚åªæœ‰å½“ CPU åœ¨ Cache ä¸­æ‰¾ä¸åˆ°æ•°æ®çš„æ—¶å€™ï¼Œæ‰ä¼šå»è®¿é—®å†…å­˜ï¼Œå¹¶å°†è¯»å–åˆ°çš„æ•°æ®å†™å…¥ Cache ä¹‹ä¸­<br><br>   ç¼“å­˜æ”¾ç½®ç­–ç•¥<br>    1) é€šè¿‡ç›´æ¥æ˜ å°„Cacheï¼Œ<br>        CPUè®¿é—®å†…å­˜æ•°æ®ï¼Œæ˜¯ä¸€å°å—ä¸€å°å—æ•°æ®æ¥è¯»å–çš„ã€‚å¯¹äºè¯»å–å†…å­˜ä¸­çš„æ•°æ®ï¼Œæˆ‘ä»¬é¦–å…ˆæ‹¿åˆ°çš„æ˜¯æ•°æ®æ‰€åœ¨çš„å†…å­˜å—ï¼ˆBlockï¼‰çš„åœ°å€ã€‚è€Œç›´æ¥æ˜ å°„Cacheé‡‡ç”¨çš„ç­–ç•¥ï¼Œå°±æ˜¯ç¡®ä¿ä»»ä½•ä¸€ä¸ªå†…å­˜å—çš„åœ°å€ï¼Œå§‹ç»ˆæ˜ å°„åˆ°ä¸€ä¸ªå›ºå®šçš„CPU Cacheåœ°å€ï¼ˆCache Lineï¼‰ã€‚è€Œè¿™ä¸ªæ˜ å°„å…³ç³»ï¼Œé€šå¸¸ç”¨ mod è¿ç®—ï¼ˆæ±‚ä½™è¿ç®—ï¼‰æ¥å®ç°ã€‚<br>    æ¯”å¦‚è¯´ï¼Œæˆ‘ä»¬çš„ä¸»å†…å­˜è¢«åˆ†æˆ 0ï½31 å·è¿™æ · 32 ä¸ªå—ã€‚æˆ‘ä»¬ä¸€å…±æœ‰ 8 ä¸ªç¼“å­˜å—ã€‚ç”¨æˆ·æƒ³è¦è®¿é—®ç¬¬ 21 å·å†…å­˜å—ã€‚å¦‚æœ 21 å·å†…å­˜å—å†…å®¹åœ¨ç¼“å­˜å—ä¸­çš„è¯ï¼Œå®ƒä¸€å®šåœ¨ 5 å·ç¼“å­˜å—ï¼ˆ21 mod 8 = 5ï¼‰ä¸­<br>    ä¸€ä¸ªå†…å­˜çš„è®¿é—®åœ°å€ï¼Œæœ€ç»ˆåŒ…æ‹¬é«˜ä½ä»£è¡¨çš„ç»„æ ‡è®°ã€ä½ä½ä»£è¡¨çš„ç´¢å¼•ï¼Œä»¥åŠåœ¨å¯¹åº”çš„Data Blockä¸­å®šä½å¯¹åº”å­—çš„ä½ç½®åç§»é‡<br><br>2) å…¨ç›¸è¿ Cacheï¼ˆFully Associative Cacheï¼‰ã€<br> ä¸€ä¸ªå¿«å¯ä»¥æ”¾ç½®åœ¨cacheä¸­çš„ä»»ä½•ä½ç½®ï¼Œä½†æ˜¯åœ¨æ£€ç´¢cacheä¸­æ‰€æœ‰é¡¹ï¼Œä¸ºäº†ä½¿æ£€ç´¢æ›´åŠ æœ‰æ•ˆï¼Œå®ƒæ˜¯ç”±ä¸€ä¸ªä¸cacheä¸­æ¯ä¸ªé¡¹éƒ½ç›¸å…³çš„æ¯”è¾ƒå™¨å¹¶è¡Œå®Œæˆï¼Œè¿™äº›æ¯”è¾ƒå™¨åŠ å¤§äº†ç¡¬ä»¶å¼€ä¸‹ï¼Œå› è€Œå…¨ç›¸è¿åªé€‚åˆå—è¾ƒå°‘çš„cache<br>3) ç»„ç›¸è¿ Cacheï¼ˆSet Associative Cacheï¼‰<br>     ä»‹äºç›´æ¥æ˜ å°„å’Œå…¨ç›¸è¿ä¹‹é—´çš„è®¾è®¡æ˜¯ç»„ç›¸è¿ï¼Œåœ¨ç»„ç›¸è¿cacheä¸­ï¼Œæ¯ä¸ªå—å¯è¢«æ”¾ç½®çš„ä½ç½®æ•°æ˜¯å›ºå®šçš„ã€‚æ¯ä¸ªå—æœ‰nä¸ªä½ç½®å¯æ”¾çš„cacheè¢«ç§°ä½œä¸ºnè·¯ç»„ç›¸è¿cacheã€‚ä¸€ä¸ªnè·¯ç»„ç›¸è”cacheç”±å¾ˆå¤šä¸ªç»„æ„æˆï¼Œæ¯ä¸ªç»„ä¸­æœ‰nå—ï¼Œæ ¹æ®ç´¢å¼•åŸŸï¼Œå­˜å‚¨å™¨ä¸­çš„æ¯ä¸ªå—å¯¹åº”åˆ°cacheä¸­å”¯ä¸€ç»„ï¼Œå¹¶ä¸”å¯ä»¥æ”¾åœ¨è¿™ä¸ªç»„ä¸­çš„ä»»ä½•ä¸€ä¸ªä½ç½®ä¸Šã€‚","like_count":2},{"had_liked":false,"id":226332,"user_name":"Monday","can_delete":false,"product_type":"c1","uid":1250907,"ip_address":"","ucode":"77B9BACC783598","user_header":"https://static001.geekbang.org/account/avatar/00/13/16/5b/83a35681.jpg","comment_is_top":false,"comment_ctime":1592039627,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"10181974219","product_id":100026001,"comment_content":"ç»†ç»†å“æ¥ï¼ŒçœŸæœ‰å‘³","like_count":2},{"had_liked":false,"id":138250,"user_name":"coldpark","can_delete":false,"product_type":"c1","uid":1058331,"ip_address":"","ucode":"D1B0F343B384F8","user_header":"https://static001.geekbang.org/account/avatar/00/10/26/1b/4caf36bd.jpg","comment_is_top":false,"comment_ctime":1570114126,"is_pvip":false,"discussion_count":1,"race_medal":0,"score":"10160048718","product_id":100026001,"comment_content":"è¯·é—®å¦‚æœ5å·é«˜é€Ÿç¼“å­˜å—è¦åŒæ—¶å­˜å‚¨5å’Œ21å·å†…å­˜çš„æ•°æ®ï¼Œç»„æ ‡è®°æ€ä¹ˆå¡«å†™å‘¢ï¼Ÿ","like_count":2,"discussions":[{"author":{"id":1147711,"avatar":"https://static001.geekbang.org/account/avatar/00/11/83/3f/bc2ea80d.jpg","nickname":"é™Œ.å¯’å“²","note":"","ucode":"B7079FF211D712","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":94853,"discussion_content":"ä¸èƒ½åŒæ—¶å­˜å‚¨ï¼Œå­˜å‚¨ä¸€ä¸ªæ–°çš„ï¼Œæ—§çš„å°±å¤‡è¦†ç›–äº†","likes_number":2,"is_delete":false,"is_hidden":false,"ctime":1576994966,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":115529,"user_name":"Geek_JaneJane","can_delete":false,"product_type":"c1","uid":1483298,"ip_address":"","ucode":"E1AE83FE46CB96","user_header":"","comment_is_top":false,"comment_ctime":1563612950,"is_pvip":false,"discussion_count":4,"race_medal":0,"score":"10153547542","product_id":100026001,"comment_content":"è¯·é—®å¾è€å¸ˆï¼Œä¸ºä»€ä¹ˆæˆ‘åœ¨Pythonä¸Šæ‰§è¡Œ3è¡Œå°ç¨‹åºä¸æ˜¯é‚£ä¸ªæ•ˆæœå‘¢ï¼Ÿ<br>```<br>import time<br><br>a = [0]*64*1024*1024<br>start = int(time.time()*1000)<br>for i in range(0, len(a)):<br>    a[i] *= 3<br>print &#39;1,&#39;, int(time.time()*1000) - start<br><br>start = int(time.time()*1000)<br>for j in range(0, len(a), 16):<br>    a[j] *= 3<br>print &#39;2,&#39;, int(time.time()*1000) - start<br><br>è¾“å‡ºï¼š<br>1, 11804<br>2, 538<br><br>```","like_count":2,"discussions":[{"author":{"id":1266043,"avatar":"https://static001.geekbang.org/account/avatar/00/13/51/7b/191a2112.jpg","nickname":"æ„¤æ€’çš„è™¾å¹²","note":"","ucode":"CEBD1B2BE7BCEE","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":84434,"discussion_content":"Javaä¸­int[]æ˜¯æ•°ç»„ï¼Œæ˜¯åœ¨å†…å­˜ä¸­åˆ†é…çš„è¿ç»­åŒºåŸŸï¼Œæ‰€ä»¥æµ‹è¯•æœ‰æ•ˆã€‚Pythoné‡Œä¼°è®¡æ˜¯é“¾è¡¨ï¼Œä¸æ˜¯è¿ç»­çš„ç©ºé—´ï¼Œæ‰€ä»¥ç»“æœå°±å’Œéå†çš„æ•°é‡æœ‰å…³äº†å§ï¼Œæ¢Javaè¯•è¯•ï¼Ÿ","likes_number":1,"is_delete":false,"is_hidden":false,"ctime":1576497211,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":2354332,"avatar":"https://static001.geekbang.org/account/avatar/00/23/ec/9c/b4acd768.jpg","nickname":"Sarah","note":"","ucode":"FDC8A0D30EAE28","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":379564,"discussion_content":"æˆ‘åœ¨C#ä¸­æµ‹è¯•ç»“æœæ˜¯ï¼š202msï¼Œ70msï¼Œç›¸å·®ä¹Ÿå¾ˆå¤§ï¼Œæµæ±—~","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1623983561,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1265741,"avatar":"https://static001.geekbang.org/account/avatar/00/13/50/4d/392f969b.jpg","nickname":"è’‹æ—ºFoo","note":"","ucode":"4325AB9674975C","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":4357,"discussion_content":"ä½ å¯ä»¥æŠŠå¾ªç¯1ä¸å¾ªç¯2åˆ†å¼€è¿è¡Œè¯•ä¸€ä¸‹","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1565334610,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":1,"child_discussions":[{"author":{"id":1483298,"avatar":"","nickname":"Geek_JaneJane","note":"","ucode":"E1AE83FE46CB96","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":1265741,"avatar":"https://static001.geekbang.org/account/avatar/00/13/50/4d/392f969b.jpg","nickname":"è’‹æ—ºFoo","note":"","ucode":"4325AB9674975C","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":15126,"discussion_content":"æ‚¨å¥½ï¼Œè°¢è°¢æ‚¨çš„è¯„è®ºï¼Œä½†æ˜¯æˆ‘åˆ†å¼€è¿è¡Œäº†è¿˜æ˜¯ä¸è¡Œï¼ŒåŸºæœ¬ä¸Šå°±æ˜¯16å€çš„å…³ç³»ã€‚è€Œä¸æ˜¯ç›¸å·®å¾ˆå°çš„é‚£ç§ã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1568806611,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":4357,"ip_address":""},"score":15126,"extra":""}]}]},{"had_liked":false,"id":115473,"user_name":"alexgzh","can_delete":false,"product_type":"c1","uid":1476632,"ip_address":"","ucode":"EE3228511C8B9B","user_header":"https://static001.geekbang.org/account/avatar/00/16/88/18/a88cdaf5.jpg","comment_is_top":false,"comment_ctime":1563596624,"is_pvip":false,"discussion_count":1,"race_medal":0,"score":"10153531216","product_id":100026001,"comment_content":"åˆ†èªè¨€, æœ‰çš„èªè¨€äºŒç¶­æ•¸çµ„æŒ‰ç…§è¡Œä¾†å­˜, ä¾‹å¦‚C++ A[2][2] å­˜æ”¾æ˜¯A[0][0] A[0][1] å­˜ç¬¬ä¸€è¡Œã€‚A[1][0] A[1][1] å­˜ç¬¬äºŒè¡Œï¼ŒæŒ‰ç…§è¡Œè¿­ä»£çš„æ–¹å¼å¿«ã€‚FortranæŒ‰ç…§åˆ—ä¾†å­˜ï¼ŒæŒ‰ç…§åˆ—è¿­ä»£å¿«ã€‚","like_count":2,"discussions":[{"author":{"id":1052528,"avatar":"https://static001.geekbang.org/account/avatar/00/10/0f/70/c8680841.jpg","nickname":"Joe Black","note":"","ucode":"21FE222A286445","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":161951,"discussion_content":"å¥½åƒmatlabä¹Ÿæ˜¯æŒ‰ç…§åˆ—å­˜çš„","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1580949865,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":252264,"user_name":"Magic","can_delete":false,"product_type":"c1","uid":1272047,"ip_address":"","ucode":"FD9CEDAA419EB0","user_header":"https://static001.geekbang.org/account/avatar/00/13/68/ef/6264ca3d.jpg","comment_is_top":false,"comment_ctime":1602217774,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"5897185070","product_id":100026001,"comment_content":"æŒ‰è¡Œè¿­ä»£åˆšå¥½åŒ¹é…ç©ºé—´å±€éƒ¨æ€§åŸç†ï¼Œå› æ­¤æ€§èƒ½æ›´å¥½","like_count":1},{"had_liked":false,"id":216804,"user_name":"devil","can_delete":false,"product_type":"c1","uid":1259625,"ip_address":"","ucode":"BB6090411BAA23","user_header":"https://static001.geekbang.org/account/avatar/00/13/38/69/864569a4.jpg","comment_is_top":false,"comment_ctime":1589346324,"is_pvip":false,"discussion_count":3,"race_medal":0,"score":"5884313620","product_id":100026001,"comment_content":"cache lineæ˜ å°„æ˜¯æ ¹æ®ç‰©ç†åœ°å€è¿˜æ˜¯è™šæ‹Ÿåœ°å€ï¼Ÿ","like_count":1,"discussions":[{"author":{"id":1009527,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/67/77/c1310aad.jpg","nickname":"å‰‘è¡£æ¸…é£","note":"","ucode":"470CD81F6612F4","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":333671,"discussion_content":"æœ‰ä¸‰ç§ï¼ŒVIVTã€VIPTã€PIPTï¼Œå…·ä½“çš„å¯ä»¥å¯ä»¥å‚è€ƒä¸‹ https://zhuanlan.zhihu.com/p/107096130?tdsourcetag=s_pctim_aiomsg","likes_number":1,"is_delete":false,"is_hidden":false,"ctime":1607589993,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1029376,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/b5/00/4093f39a.jpg","nickname":"æ¨èµ›","note":"","ucode":"E26AF8930F78E6","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":381416,"discussion_content":"è™šæ‹Ÿåœ°å€,æœ€ç»ˆæœ‰mmuè½¬æˆç‰©ç†åœ°å€. ","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1625044957,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1810189,"avatar":"http://thirdwx.qlogo.cn/mmopen/vi_32/ZHw73tgCqGKhvticUWGRz4icgicu4hFWfKtacoFJeItH7maNuNUmjnEgDTJvOibwUWgGV0p6guNPibMVWDV4BUmEmlA/132","nickname":"Ethan","note":"","ucode":"75F613D58909DB","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":300949,"discussion_content":"æˆ‘è§‰å¾—æ˜¯è™šæ‹Ÿåœ°å€ï¼ŒCPUè¯»å–å†…å­˜çš„æ—¶å€™ç”¨çš„æ˜¯è™šæ‹Ÿåœ°å€ï¼Œç„¶åæ˜ å°„åˆ°CPU Cacheçš„ä¸­ä¹Ÿå½“ç„¶æ˜¯è™šæ‹Ÿåœ°å€","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1598337568,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":215826,"user_name":"æ›™å…‰","can_delete":false,"product_type":"c1","uid":1476450,"ip_address":"","ucode":"04D65BF7F19845","user_header":"https://static001.geekbang.org/account/avatar/00/16/87/62/f99b5b05.jpg","comment_is_top":false,"comment_ctime":1589112138,"is_pvip":false,"discussion_count":1,"race_medal":0,"score":"5884079434","product_id":100026001,"comment_content":"&quot;Cache Line çš„å¤§å°é€šå¸¸æ˜¯ 64 å­—èŠ‚ã€‚è€Œåœ¨ä¸Šé¢çš„å¾ªç¯ 2 é‡Œé¢ï¼Œæˆ‘ä»¬æ¯éš” 16 ä¸ªæ•´å‹æ•°è®¡ç®—ä¸€æ¬¡ï¼Œ16 ä¸ªæ•´å‹æ•°æ­£å¥½æ˜¯ 64 ä¸ªå­—èŠ‚ã€‚äºæ˜¯ï¼Œå¾ªç¯ 1 å’Œå¾ªç¯ 2ï¼Œéœ€è¦æŠŠåŒæ ·æ•°é‡çš„ Cache Line æ•°æ®ä»å†…å­˜ä¸­è¯»å–åˆ° CPU Cache ä¸­ï¼Œæœ€ç»ˆä¸¤ä¸ªç¨‹åºèŠ±è´¹çš„æ—¶é—´å°±å·®åˆ«ä¸å¤§äº†ã€‚&quot;<br>-------------------------<br>Cache é‡Œçš„æ•°æ®ç»“æ„ï¼Œå¤šäº†ä¸€ä¸ªæœ‰æ•ˆä½å’Œå¯¹åº”çš„æ•°æ®ï¼Œç”±â€œç´¢å¼• + æœ‰æ•ˆä½ + ç»„æ ‡è®° + æ•°æ®â€ï¼Œå¦‚æœè¯´cache lineå†…ä¿å­˜64å­—èŠ‚éƒ½æ˜¯æ•°æ®ï¼Œâ€œç´¢å¼• â€æ˜¯cache lineçš„ç´¢å¼•ï¼Œé‚£â€œæœ‰æ•ˆä½ + ç»„æ ‡è®° â€å­˜æ”¾åœ¨å“ªå‘¢ï¼Ÿæ˜¯ä¸æ˜¯è¯´ä¸€ä¸ªcache lineä¸èƒ½å­˜æ”¾64å­—èŠ‚çš„æ•°æ®ï¼Ÿ <br>æˆ‘çš„ç†è§£æ˜¯64å­—èŠ‚æ˜¯data blockçš„å¤§å°ï¼Œæ‰€ä»¥ä¸€ä¸ªcache lineä¼šå¤§äº64å­—èŠ‚","like_count":1,"discussions":[{"author":{"id":1254093,"avatar":"https://static001.geekbang.org/account/avatar/00/13/22/cd/d8a5eedf.jpg","nickname":"ä»»é¢–æ–°","note":"","ucode":"00442DC59B4F83","race_medal":0,"user_type":1,"is_pvip":true},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":583259,"discussion_content":"åŒæ ·æœ‰è¿™ä¸ªç–‘é—®ï¼Œ64å­—èŠ‚æ˜¯å¦åŒ…å«æœ‰æ•ˆä½å’Œç»„æ ‡è®°ï¼Œè§‰å¾—åº”è¯¥æ˜¯ä¸åŒ…å«æ‰å¯¹","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1660003920,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":"æ±Ÿè‹"},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":142797,"user_name":"å¤šè¥„ä¸¸","can_delete":false,"product_type":"c1","uid":1074310,"ip_address":"","ucode":"1AA1497C5A293C","user_header":"https://static001.geekbang.org/account/avatar/00/10/64/86/f5a9403a.jpg","comment_is_top":false,"comment_ctime":1571537890,"is_pvip":false,"discussion_count":3,"race_medal":0,"score":"5866505186","product_id":100026001,"comment_content":"è€å¸ˆ é‚£volatileçš„ä½œç”¨ æ˜¯ä¸æ˜¯å°±æ˜¯æŠŠcacheä¸­çš„æœ‰æ•ˆä½ ç½®ä¸º0äº†å‘¢ï¼Ÿ <br><br>æ³è¯·è€å¸ˆè§£ç­”ï¼ è°¢è°¢è€å¸ˆï¼","like_count":1,"discussions":[{"author":{"id":1149084,"avatar":"https://static001.geekbang.org/account/avatar/00/11/88/9c/cbc463e6.jpg","nickname":"ä»°æœ›æ˜Ÿç©º","note":"","ucode":"A9E46C9FDB3275","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":296890,"discussion_content":"è¿™ç§è¯´æ³•ä¸å¯¹ï¼ŒCPUè¦è®¿é—®volatileå…³é”®å­—ä¿®é¥°çš„æ•°æ®ï¼Œç›´æ¥å¿½ç•¥Cacheçš„å­˜åœ¨ï¼Œç›´æ¥ä»å†…å­˜ä¸­è·å–","likes_number":1,"is_delete":false,"is_hidden":false,"ctime":1596696179,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1001893,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/49/a5/e4c1c2d4.jpg","nickname":"å°æ–‡åŒå­¦","note":"","ucode":"48F2AEB989C12A","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":258257,"discussion_content":"volatile çš„ä½œç”¨å¹¶æ²¡æœ‰è¿™ä¹ˆç®€å•ã€‚è¦ä¿è¯å¤šä¸ªCPUå¯¹æŸä¸ªåœ°å€çš„å˜é‡æ•°æ®ä¸€è‡´ï¼Œvolatile ä¿®é¥°äº†wåœ°å€ï¼Œè¦ä¿è¯wåœ°å€æœ‰ä¸¤ä¸ªç‰¹æ€§ï¼š\n1ã€ç¼“å­˜é”å®šã€‚å°±æ˜¯è¦æ”¾ç½®CPUåŒæ—¶å¯¹wåœ°å€è¿›è¡Œä¿®æ”¹ã€‚\n2ã€å¤šCPUçš„é«˜é€Ÿç¼“å­˜å¤±æ•ˆã€‚è¿™å°±æ˜¯ volatile ï¼Œè¿™æ˜¯ä¸€ç§ CPU ç¼“å­˜ä¸€è‡´æ€§åè®®å®ç°ã€‚\næˆ‘å¯èƒ½è¯´å¾—ä¸å®Œå…¨å¯¹ï¼Œå¯ä»¥å‚è€ƒä¸€ä¸‹ã€ŠJava å¹¶å‘ç¼–ç¨‹ä¹‹ç¾ã€‹P10é¡µ æ–¹è…¾é£è‘—","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1588671017,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1310798,"avatar":"https://static001.geekbang.org/account/avatar/00/14/00/4e/be2b206b.jpg","nickname":"å´å°æ™º","note":"","ucode":"C7C9F58B5C9F7B","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":40527,"discussion_content":"+1 ï¼Œå¸Œæœ›è€å¸ˆè§£ç­”","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1572229879,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":138244,"user_name":"J.D.Chi","can_delete":false,"product_type":"c1","uid":1035855,"ip_address":"","ucode":"34812AEF95C7AB","user_header":"https://static001.geekbang.org/account/avatar/00/0f/ce/4f/3a89d29a.jpg","comment_is_top":false,"comment_ctime":1570112535,"is_pvip":false,"discussion_count":3,"race_medal":0,"score":"5865079831","product_id":100026001,"comment_content":"å›¾é‡Œ Cache Line 0 ~ Cache Line 8 ä¸æ˜¯ 9 ä¸ªå†…å­˜å—å—ï¼Ÿ","like_count":1,"discussions":[{"author":{"id":1147453,"avatar":"https://static001.geekbang.org/account/avatar/00/11/82/3d/356fc3d6.jpg","nickname":"å¿†æ°´å¯’","note":"","ucode":"E3F86BD8AA8903","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":312615,"discussion_content":"è€å¸ˆæ‰‹è¯¯ï¼Œæ²¡æ³¨æ„åˆ°","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1602748563,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1476675,"avatar":"https://static001.geekbang.org/account/avatar/00/16/88/43/31641bf0.jpg","nickname":"å¸ƒæœ—è€ç†Š","note":"","ucode":"A8AF82550AFF9C","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":207073,"discussion_content":"07","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1584458959,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1012528,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/73/30/fd602742.jpg","nickname":"å¤§é©¬çŒ´","note":"","ucode":"E3482CBDF43CDE","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":73808,"discussion_content":"ä½ çŸ¥é“çš„å¤ªå¤šäº†","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1575597924,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":120387,"user_name":"Giacomo","can_delete":false,"product_type":"c1","uid":1478055,"ip_address":"","ucode":"BE5B1E68BCDBB3","user_header":"https://static001.geekbang.org/account/avatar/00/16/8d/a7/2176bbc5.jpg","comment_is_top":false,"comment_ctime":1564863575,"is_pvip":false,"discussion_count":2,"race_medal":0,"score":"5859830871","product_id":100026001,"comment_content":"è€å¸ˆæˆ‘æƒ³é—®ä¸€ä¸‹ï¼Œæˆ‘è®°å¾—ä¹‹å‰æˆ‘ä»¬å­¦è¿‡ï¼Œå†…å­˜é‡Œæœ‰åˆ†æ®µå’Œåˆ†é¡µï¼Œé‚£è¿™é‡Œçš„åˆ†å—å’Œä¹‹å‰çš„é¡µæœ‰æ²¡æœ‰ä»€ä¹ˆå…³ç³»ï¼Ÿ","like_count":1,"discussions":[{"author":{"id":1250807,"avatar":"https://static001.geekbang.org/account/avatar/00/13/15/f7/744720a2.jpg","nickname":"DriveMan_é‚±ä½³æº","note":"","ucode":"A4C83BF07DEE7A","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":20028,"discussion_content":"å†…å­˜é‡Œçš„æœ€å°å­˜å‚¨å•ä½æ˜¯é¡µå¤§å°ä¸º4kï¼Œè¿™é‡Œçš„åˆ†å—æ˜¯cacheè®¿é—®å†…å­˜çš„æœ€å°å•ä½ä¸€å—64bit","likes_number":1,"is_delete":false,"is_hidden":false,"ctime":1569249796,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":1,"child_discussions":[{"author":{"id":1478055,"avatar":"https://static001.geekbang.org/account/avatar/00/16/8d/a7/2176bbc5.jpg","nickname":"Giacomo","note":"","ucode":"BE5B1E68BCDBB3","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":1250807,"avatar":"https://static001.geekbang.org/account/avatar/00/13/15/f7/744720a2.jpg","nickname":"DriveMan_é‚±ä½³æº","note":"","ucode":"A4C83BF07DEE7A","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":26420,"discussion_content":"é‚£è¿™ä¸ªå—ä¹Ÿæ˜¯é¡µé‡Œé¢è¢«åˆ†å¥½çš„å†…å­˜åŒºåŸŸå’¯","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1570601856,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":20028,"ip_address":""},"score":26420,"extra":""}]}]},{"had_liked":false,"id":356835,"user_name":"Geek_beb011","can_delete":false,"product_type":"c1","uid":1371637,"ip_address":"æ¹–åŒ—","ucode":"A6C50FF0200020","user_header":"http://thirdwx.qlogo.cn/mmopen/vi_32/DYAIOgq83epZFcPycr00N0OqicmnhvESmxG9n8icZJwFRd7QJLRkxYJlRSiaXr6xSsIo8b9OyhoickRUqA2aKspH7Q/132","comment_is_top":false,"comment_ctime":1662626109,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1662626109","product_id":100026001,"comment_content":"Cache Lineçš„å†…å­˜å¤§å°åº”è¯¥è¦ç­‰äºBlockå§ï¼Ÿ","like_count":0},{"had_liked":false,"id":324313,"user_name":"é¢œå¦‚ç‰","can_delete":false,"product_type":"c1","uid":2856239,"ip_address":"","ucode":"C55FDAE3559054","user_header":"https://static001.geekbang.org/account/avatar/00/2b/95/2f/d88950a1.jpg","comment_is_top":false,"comment_ctime":1638367273,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1638367273","product_id":100026001,"comment_content":"Cacheç¼“å­˜çš„å¦‚æœæ˜¯åœ°å€ï¼Œé‚£ä¹ˆä¸æ˜¯åŒæ ·éœ€è¦è®¿é—®å†…å­˜å˜›ï¼Ÿè¿™æ ·Cacheå¿«åœ¨å“ªé‡Œå‘¢ï¼Ÿ<br>","like_count":0},{"had_liked":false,"id":317897,"user_name":"èµµæ—­åœ†","can_delete":false,"product_type":"c1","uid":2763465,"ip_address":"","ucode":"32B1FF87B69AF9","user_header":"https://static001.geekbang.org/account/avatar/00/2a/2a/c9/52bbbfc7.jpg","comment_is_top":false,"comment_ctime":1635042515,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1635042515","product_id":100026001,"comment_content":"å¯¹æ¯”å†…å­˜è®¿é—®åœ°å€çš„é«˜ä½ï¼Œå’Œ Cache ä¸­çš„ç»„æ ‡è®°ï¼Œç¡®è®¤ Cache ä¸­çš„æ•°æ®å°±æ˜¯æˆ‘ä»¬è¦è®¿é—®çš„å†…å­˜æ•°æ®ï¼Œä» Cache Line ä¸­è¯»å–åˆ°å¯¹åº”çš„æ•°æ®å—ï¼ˆData Blockï¼‰<br>cache line 64kb ä¸­æ‰¾ä¸åˆ°è¦åç§»çš„æ•°æ®æ€ä¹ˆå¤„ç†ï¼Ÿ","like_count":0},{"had_liked":false,"id":311514,"user_name":"Geek_f4fb8b","can_delete":false,"product_type":"c1","uid":2756819,"ip_address":"","ucode":"32114B90BF7060","user_header":"","comment_is_top":false,"comment_ctime":1631264453,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1631264453","product_id":100026001,"comment_content":"func TestIterateArr(t *testing.T) {<br>\tarr := new([10000][10000]int)<br><br>\tret := 0<br>\tstart := time.Now()<br>\tfor i, _ := range arr {<br>\t\tfor j, _ := range arr[i] {<br>\t\t\tret += arr[i][j]<br>\t\t}<br>\t}<br>\tfmt.Printf(&quot;line time spent:%f\\n&quot;, time.Since(start).Seconds())<br><br>\tstart2 := time.Now()<br>\tfor i, _ := range arr {<br>\t\tfor j, _ := range arr[i] {<br>\t\t\tret += arr[j][i]<br>\t\t}<br>\t}<br>\tfmt.Printf(&quot;column time spent:%f\\n&quot;, time.Since(start2).Seconds())<br>}<br>=== RUN   TestIterateArr<br>line time spent:0.027328<br>column time spent:0.026382<br>--- PASS: TestIterateArr (0.06s)<br>å·®åˆ«ä¸å¤§?","like_count":0},{"had_liked":false,"id":280260,"user_name":"çº¢è–¯æ¿æ —","can_delete":false,"product_type":"c1","uid":2413071,"ip_address":"","ucode":"236BE91291A575","user_header":"https://static001.geekbang.org/account/avatar/00/24/d2/0f/8f14c85b.jpg","comment_is_top":false,"comment_ctime":1614145032,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1614145032","product_id":100026001,"comment_content":"æ•°ç»„åœ¨å†…å­˜ä¸­æŒ‰è¡Œè¿ç»­å­˜å‚¨ï¼Œä»å†…å­˜ä¸­è¯»å–æ•°æ®åˆ°cpu cacheæŒ‰blockè¯»å–ã€‚å¦‚æœæ˜¯æŒ‰è¡Œè¿­ä»£èƒ½å¢åŠ CPU cacheçš„å‘½ä¸­ç‡ï¼Œç©ºé—´å±€éƒ¨åˆ©ç”¨ç‡é«˜","like_count":0},{"had_liked":false,"id":272981,"user_name":"ä»Šå¤œç§‹é£å’Œ","can_delete":false,"product_type":"c1","uid":1434066,"ip_address":"","ucode":"453C8197FFC81D","user_header":"https://static001.geekbang.org/account/avatar/00/15/e1/d2/42ad2c87.jpg","comment_is_top":false,"comment_ctime":1610376253,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1610376253","product_id":100026001,"comment_content":"cacheline çš„æœ‰æ•ˆä½æŒ‡çš„æ˜¯å½“å‰æ¯ä¸ªæ‰€åŠ è½½çš„å†…å­˜å—çš„æ•°æ®æ˜¯å¦æœ‰æ•ˆçš„ç ï¼Œå¦‚æœæœ‰å¤šä¸ªå†…å­˜å—ï¼Œåˆ™æ¯ä¸ªå†…å­˜å—éƒ½æœ‰è‡ªå·±çš„æœ‰æ•ˆä½æ ‡è®°","like_count":0},{"had_liked":false,"id":240720,"user_name":"Eleven","can_delete":false,"product_type":"c1","uid":1168452,"ip_address":"","ucode":"FB4A0C8CA732BE","user_header":"https://static001.geekbang.org/account/avatar/00/11/d4/44/0ec958f4.jpg","comment_is_top":false,"comment_ctime":1597044683,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1597044683","product_id":100026001,"comment_content":"è¿™ä¸ªæ—¶å€™ï¼Œåœ¨å¯¹åº”çš„ç¼“å­˜å—ä¸­ï¼Œæˆ‘ä»¬ä¼šå­˜å‚¨ä¸€ä¸ªç»„æ ‡è®°ï¼ˆTagï¼‰ã€‚è¿™ä¸ªç»„æ ‡è®°ä¼šè®°å½•ï¼Œå½“å‰ç¼“å­˜å—å†…å­˜å‚¨çš„æ•°æ®å¯¹åº”çš„å†…å­˜å—ï¼Œè€Œç¼“å­˜å—æœ¬èº«çš„åœ°å€è¡¨ç¤ºè®¿é—®åœ°å€çš„ä½ N ä½ã€‚å°±åƒä¸Šé¢çš„ä¾‹å­ï¼Œ21 çš„ä½ 3 ä½ 101ï¼Œç¼“å­˜å—æœ¬èº«çš„åœ°å€å·²ç»æ¶µç›–äº†å¯¹åº”çš„ä¿¡æ¯ã€å¯¹åº”çš„ç»„æ ‡è®°ï¼Œæˆ‘ä»¬åªéœ€è¦è®°å½• 21 å‰©ä½™çš„é«˜ 2 ä½çš„ä¿¡æ¯ï¼Œä¹Ÿå°±æ˜¯ 10 å°±å¯ä»¥äº†ã€‚<br><br>è¿™æ®µè¯æœ€åçš„é¡¿å·å’Œé€—å·æ˜¯ä¸æ˜¯æœ‰é—®é¢˜ï¼Ÿ<br>åº”è¯¥æ”¹æˆï¼š<br>ç¼“å­˜å—æœ¬èº«çš„åœ°å€å·²ç»æ¶µç›–äº†å¯¹åº”çš„ä¿¡æ¯ï¼Œå¯¹åº”çš„ç»„æ ‡è®°æˆ‘ä»¬åªéœ€è¦è®°å½• 21 å‰©ä½™çš„é«˜ 2 ä½çš„ä¿¡æ¯ï¼Œä¹Ÿå°±æ˜¯ 10 å°±å¯ä»¥äº†ã€‚<br><br>ä¼šå®³æ­»äººçš„ï¼çœ‹åŠå¤©æ€»è§‰å¾—ä¸å¯¹ï¼","like_count":0},{"had_liked":false,"id":222429,"user_name":"å¤šè¥„ä¸¸","can_delete":false,"product_type":"c1","uid":1074310,"ip_address":"","ucode":"1AA1497C5A293C","user_header":"https://static001.geekbang.org/account/avatar/00/10/64/86/f5a9403a.jpg","comment_is_top":false,"comment_ctime":1590805007,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1590805007","product_id":100026001,"comment_content":"æŒ‰è¡Œéå†ï¼Œå¯ä»¥å°†æ¯æ¬¡åŠ è½½åˆ°cacheä¸­çš„æ•°æ®å—éå†å®Œä¹‹åï¼Œå†åŠ è½½æ•°ç»„åœ¨å†…å­˜ä¸­çš„ä¸‹ä¸€ä¸ªå†…å­˜å—ã€‚<br>æŒ‰åˆ—éå†ï¼Œæ¯æ¬¡å°†åŠ è½½åˆ°cacheä¸­çš„æ•°æ®å—åªéå†ä¸€ä¸ªå…ƒç´ ï¼Œè€Œä¸æ˜¯åƒæŒ‰åˆ—éå†ä¸€æ ·ä»å¤´è‡³å°¾éå†å®Œæ‰€æœ‰è¡Œå…ƒç´ ï¼Œå°±éœ€è¦åŠ è½½ä¸‹ä¸€ä¸ªåˆ—å…ƒç´ æ‰€åœ¨çš„è¡Œåœ¨å†…å­˜ä¸­çš„ç‰©ç†å—ã€‚<br>è¿™æ ·ï¼Œæ¯ä¸ªè¡Œå°±è¦åŠ è½½è¿™ä¸ªè¡Œæ‰€å¯¹åº”çš„è¡Œå…ƒç´ ä¸ªæ•°æ¬¡ï¼Œå°†æ—¶é—´å®Œå…¨æµªè´¹åœ¨äº†æ•°æ®ä¸æ–­é‡å¤çš„ä»å†…å­˜åŠ è½½åˆ°cacheä¸Šã€‚ä»è€Œå¯¼è‡´ï¼šåˆ—éå†çš„æ—¶é—´åœ¨å¤§é‡å…ƒç´ çš„æƒ…å†µä¸‹ï¼Œè¿œè¿œé«˜äºè¡Œéå†ã€‚","like_count":0},{"had_liked":false,"id":197430,"user_name":"é›·åˆš","can_delete":false,"product_type":"c1","uid":1655725,"ip_address":"","ucode":"115FE2BE1AAB61","user_header":"http://thirdwx.qlogo.cn/mmopen/vi_32/pTD8nS0SsORKiaRD3wB0NK9Bpd0wFnPWtYLPfBRBhvZ68iaJErMlM2NNSeEibwQfY7GReILSIYZXfT9o8iaicibcyw3g/132","comment_is_top":false,"comment_ctime":1585377320,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1585377320","product_id":100026001,"comment_content":"è¦æƒ³ç¡®å®šä¸€ä¸ªå†…å­˜åœ°å€åœ¨ç¼“å­˜ä¸­çš„æ˜ å°„å…³ç³»ï¼Œä¸»è¦æ˜¯ç¡®å®šç´¢å¼•å·å’Œåç§»é‡ã€‚ CPU Cache ç›´æ¥æ˜ å°„ç±»ä¼¼ HashMapï¼Œä¹Ÿæ˜¯é€šè¿‡æ±‚ä½™æ¥å»ºç«‹æ˜ å°„å…³ç³»ï¼Œå½“ç„¶ä¹Ÿæ— æ³•é¿å…å“ˆå¸Œç¢°æ’ã€‚CPU åˆ¤æ–­è¿™æ˜¯ä¸æ˜¯æˆ‘ä»¬æƒ³è¦è®¿é—®çš„æ•°æ®æ—¶ï¼Œæœ€ç®€å•çš„åŠæ³•å½“ç„¶æ˜¯åœ¨ç¼“å­˜ä¸­å­˜å‚¨å®Œæ•´çœŸå®çš„ç‰©ç†å†…å­˜åœ°å€ï¼Œä½†è¿™æ ·å¤ªæµªè´¹ç©ºé—´äº†ï¼ŒCPU åšäº†ä¸€ä¸ªæŠ˜ä¸­ï¼Œç”¨é«˜ä½ä»£è¡¨ç»„æ ‡è®°ï¼Œä½ä½ä»£è¡¨ç´¢å¼•å·ã€‚æœ€ç»ˆé€šè¿‡ &quot;ç´¢å¼• + ç»„æ ‡è®° + åç§»é‡&quot; æ¥å»ºç«‹æ˜ å°„å…³ç³»ã€‚","like_count":0},{"had_liked":false,"id":186092,"user_name":"ä¸‰ä»¶äº‹","can_delete":false,"product_type":"c1","uid":1055819,"ip_address":"","ucode":"BCC867C8961A24","user_header":"https://static001.geekbang.org/account/avatar/00/10/1c/4b/2e5df06f.jpg","comment_is_top":false,"comment_ctime":1583755348,"is_pvip":false,"discussion_count":3,"race_medal":0,"score":"1583755348","product_id":100026001,"comment_content":"â€œè€Œåœ¨ä¸Šé¢çš„å¾ªç¯ 2 é‡Œé¢ï¼Œæˆ‘ä»¬æ¯éš” 16 ä¸ªæ•´å‹æ•°è®¡ç®—ä¸€æ¬¡ï¼Œ16 ä¸ªæ•´å‹æ•°æ­£å¥½æ˜¯ 64 ä¸ªå­—èŠ‚ã€‚äºæ˜¯ï¼Œå¾ªç¯ 1 å’Œå¾ªç¯ 2ï¼Œéœ€è¦æŠŠåŒæ ·æ•°é‡çš„ Cache Line æ•°æ®ä»å†…å­˜ä¸­è¯»å–åˆ° CPU Cache ä¸­ï¼Œæœ€ç»ˆä¸¤ä¸ªç¨‹åºèŠ±è´¹çš„æ—¶é—´å°±å·®åˆ«ä¸å¤§äº†ã€‚â€<br><br>æ²¡å¤ªæ˜ç™½ä¸ºå•¥16ä¸ªæ•´å‹æ•°æ­£å¥½æ˜¯64ä¸ªå­—èŠ‚ï¼Œå°±ä¼šä¸¤ä¸ªç¨‹åºèŠ±è´¹çš„æ—¶é—´å·®åˆ«ä¸å¤§äº†ï¼Ÿ","like_count":0,"discussions":[{"author":{"id":1441830,"avatar":"https://static001.geekbang.org/account/avatar/00/16/00/26/a80010f0.jpg","nickname":"JL","note":"","ucode":"07BD8069AE2CBD","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":240059,"discussion_content":"&#34;16ä¸ªæ•´å‹æ•°æ­£å¥½æ˜¯64ä¸ªå­—èŠ‚&#34;, 64bytes æ­£å¥½æ˜¯cache lineçš„å¤§å°ã€‚æ¯æ¬¡éƒ½æ˜¯æŒ‰cache line ä¸ºå•ä½loadçš„ï¼Œæ‰€ä»¥ è·³è·ƒä¸€ä¸ªint å’Œ è·³è·ƒ16ä¸ªintï¼Œå¯¹äºcpuæ¥è¯´éƒ½æ˜¯ load ä¸€ä¸ªcache lineï¼Œ æ‰€ä»¥æ—¶é—´å¤§è‡´ç›¸åŒã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1587322324,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":2,"child_discussions":[{"author":{"id":1730160,"avatar":"https://wx.qlogo.cn/mmopen/vi_32/O3Uf8dibBnKKzibgEhvvKs9vic0dBavSJzn79fZVtH0AxcUT09bvOAYvr2f7vecmwiao7BBGgE5p8lXHSoBMdmQuBw/132","nickname":"èµµ","note":"","ucode":"EAC4390FD95EF9","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":1441830,"avatar":"https://static001.geekbang.org/account/avatar/00/16/00/26/a80010f0.jpg","nickname":"JL","note":"","ucode":"07BD8069AE2CBD","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":312595,"discussion_content":"æŒ‰ç…§ä½ çš„æ„æ€æ¥è¯´ï¼Œæˆ‘æ„Ÿè§‰è·³è·ƒ1~16ä¸ªintï¼Œå¯¹äºCPUéƒ½æ˜¯æ²¡æœ‰åŒºåˆ«çš„ï¼Œåªæœ‰è¶…è¿‡16ä¸ªintï¼ŒCPU  load  çš„ cache line  æ•°é‡æ‰ä¼šå‡å°‘ï¼Œä¸çŸ¥é“æˆ‘ç†è§£çš„æ˜¯å¦æ­£ç¡®ï¼Ÿ ","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1602743622,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":240059,"ip_address":""},"score":312595,"extra":""},{"author":{"id":1441830,"avatar":"https://static001.geekbang.org/account/avatar/00/16/00/26/a80010f0.jpg","nickname":"JL","note":"","ucode":"07BD8069AE2CBD","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":1730160,"avatar":"https://wx.qlogo.cn/mmopen/vi_32/O3Uf8dibBnKKzibgEhvvKs9vic0dBavSJzn79fZVtH0AxcUT09bvOAYvr2f7vecmwiao7BBGgE5p8lXHSoBMdmQuBw/132","nickname":"èµµ","note":"","ucode":"EAC4390FD95EF9","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":327383,"discussion_content":"ä¸è®°å¾—èƒŒæ™¯æ˜¯ä»€ä¹ˆäº†ã€‚ æ•ˆç‡æé«˜æ˜¯å› ä¸º cacheline loadä¸€æ¬¡ èƒ½å¤„ç†å¤šä¸ªint è¿˜æ˜¯ æ¯æ¬¡load cachheline åªèƒ½å¤„ç†ä¸€ä¸ªintã€‚ å¦‚æœè¿ç»­ä¸¤ä¸ªint è·¨åº¦è¿‡å¤§ è‚¯å®šæ˜¯è¦load ä¸¤æ¬¡ï¼Œå¦‚æœ ä¸¤ä¸ªintç´§æŒ¨ç€ï¼Œé‚£å¾ˆå¯èƒ½load ä¸€æ¬¡å°±å¤Ÿäº†ã€‚ ","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1605815676,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":312595,"ip_address":""},"score":327383,"extra":""}]}]},{"had_liked":false,"id":182805,"user_name":"æ·±æ°´è“","can_delete":false,"product_type":"c1","uid":1637933,"ip_address":"","ucode":"3E3B195DE54DE1","user_header":"https://static001.geekbang.org/account/avatar/00/18/fe/2d/e23fc6ee.jpg","comment_is_top":false,"comment_ctime":1582868903,"is_pvip":false,"discussion_count":1,"race_medal":0,"score":"1582868903","product_id":100026001,"comment_content":"å…¶å®ä¸ºä»€ä¹ˆå†…å­˜çš„å‘å±•é€Ÿåº¦ä¸€ç›´éƒ½æ¯”CPUçš„å‘å±•é€Ÿåº¦æ…¢å‘¢ï¼Ÿè€Œä¸”ä¹Ÿéšç€CPUçš„å¿«é€Ÿå‘å±•ï¼ŒCPUçš„é€Ÿåº¦è¿œè¿œå¿«ä¸å†…å­˜çš„æ—¶å€™ï¼Œä¸ºä»€ä¹ˆä¸èƒ½ç»§ç»­å¢åŠ å†…å­˜çš„é€šé“æ•°å‘¢ï¼Ÿç”šè‡³åœ¨ä¸€æ¡å†…å­˜çš„æ¥å£ä¸­å®ç°å¤šæ¡å†…å­˜é€šé“ã€‚","like_count":0,"discussions":[{"author":{"id":1009527,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/67/77/c1310aad.jpg","nickname":"å‰‘è¡£æ¸…é£","note":"","ucode":"470CD81F6612F4","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":333672,"discussion_content":"å¯ä»¥çœ‹çœ‹ NUMA","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1607590284,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":179552,"user_name":"Geek_aa8017","can_delete":false,"product_type":"c1","uid":1748911,"ip_address":"","ucode":"286195887103C2","user_header":"","comment_is_top":false,"comment_ctime":1582030508,"is_pvip":false,"discussion_count":1,"race_medal":0,"score":"1582030508","product_id":100026001,"comment_content":"é«˜é€Ÿç¼“å­˜æ¯æ¬¡éƒ½æ˜¯ä»å†…å­˜ä¸­è¯»å–ä¸€ä¸ªå—çš„æ•°æ®ï¼Œè¿™ä¸ªå—æœ‰64å­—èŠ‚ï¼Œå‡å¦‚ä¸€ä¸ªæ•´å‹æ˜¯4ä¸ªå­—èŠ‚ï¼Œé‚£ä¹ˆè¿™ä¸ªå—å¯ä»¥æ”¾16ä¸ªæ•°ï¼Œè¯»å®Œè¿™16ä¸ªæ•°æ—¶é«˜é€Ÿç¼“å­˜æ‰ä¼šåˆå»å†…å­˜è¯»ä¸‹ä¸€ä¸ªå—å—ï¼Ÿ","like_count":0,"discussions":[{"author":{"id":1149084,"avatar":"https://static001.geekbang.org/account/avatar/00/11/88/9c/cbc463e6.jpg","nickname":"ä»°æœ›æ˜Ÿç©º","note":"","ucode":"A9E46C9FDB3275","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":296892,"discussion_content":"æ˜¯çš„ï¼Œå½“è¯»å®ŒåCPUæ ¸å†ä»Cacheä¸­è·å–æ•°æ®æ—¶ä¼šå‘ç”ŸCache Missï¼Œè¿™æ—¶ä¼šä»å†…å­˜ä¸­é‡æ–°è¯»å–64å­—èŠ‚çš„æ•°æ®åˆ°Cacheä¸­","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1596696476,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":163427,"user_name":"once","can_delete":false,"product_type":"c1","uid":1453187,"ip_address":"","ucode":"033281FC1DAB37","user_header":"https://static001.geekbang.org/account/avatar/00/16/2c/83/f85ba9cd.jpg","comment_is_top":false,"comment_ctime":1576720115,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1576720115","product_id":100026001,"comment_content":"è€å¸ˆä½ å¥½ ç¬¬17ç« ä¸­ä½ å¯¹cpu cycleçš„å®šä¹‰æ˜¯        æ‰€ä»¥æˆ‘ä»¬ä¸€èˆ¬æŠŠä»å†…å­˜é‡Œé¢è¯»å–ä¸€æ¡æŒ‡ä»¤çš„æœ€çŸ­æ—¶é—´ï¼Œç§°ä¸º CPU å‘¨æœŸã€‚           ä½†æ˜¯è¿™ç« é‡Œè¯´å†…å­˜è®¿é—®ä¸€èˆ¬éœ€è¦120ä¸ªcpu cycleã€‚æ„Ÿè§‰æˆ‘å¯¹cpuå‘¨æœŸçš„æ¦‚å¿µåˆå«ç³Šä¸æ¸…äº†","like_count":0},{"had_liked":false,"id":143614,"user_name":"éšå¿ƒè€Œè‡³","can_delete":false,"product_type":"c1","uid":1097836,"ip_address":"","ucode":"31866865255101","user_header":"https://static001.geekbang.org/account/avatar/00/10/c0/6c/29be1864.jpg","comment_is_top":false,"comment_ctime":1571744661,"is_pvip":false,"discussion_count":1,"race_medal":0,"score":"1571744661","product_id":100026001,"comment_content":"è®²çš„éå¸¸é€å½»èµã€‚<br>è¯¾åä¹ é¢˜ï¼Œç”±äºäºŒç»´æ•°ç»„åœ¨å†…å­˜ä¸­æ˜¯æŒ‰ç…§è¡Œå­˜æ”¾çš„ã€‚æŒ‰è¡Œéå†ï¼Œä¸‹ä¸€æ¡æ•°æ®å¤§æ¦‚ç‡åœ¨Cache lineä¸­ï¼Œå› è€Œè€—æ—¶è¾ƒçŸ­ã€‚<br>public class ArrCacheLineTest {<br>    public static void main(String[] args){<br>        int[][] arr = new int[6400][6400];<br>        long start = System.currentTimeMillis();<br>        int sum = 0;<br>        for(int i=0; i&lt;arr.length; i++){<br>            for(int j=0; j&lt;arr[i].length; j++){<br>               sum += arr[i][j];<br>            }<br>        }<br>        &#47;&#47;31ms, ç”±äºæ•°æ®æ˜¯æŒ‰ç…§è¡Œæ”¾çš„ï¼ŒæŒ‰è¡Œéå†ï¼Œä¸‹ä¸€æ¡æ•°æ®å¤§æ¦‚åœ¨Cache lineä¸­ï¼Œå› è€Œè€—æ—¶è¾ƒçŸ­ã€‚<br>        System.out.println(&quot;sum &quot;+ sum  +&quot; time =&quot;+(System.currentTimeMillis() - start));<br>        for(int i=0; i&lt;arr.length; i++){<br>            for(int j=0; j&lt;arr[i].length; j++){<br>                sum += arr[j][i];<br>            }<br>        }<br>        &#47;&#47;1610<br>        System.out.println(&quot;sum &quot;+ sum  +&quot; time =&quot;+(System.currentTimeMillis() - start));<br>    }<br>}","like_count":1,"discussions":[{"author":{"id":1136133,"avatar":"https://static001.geekbang.org/account/avatar/00/11/56/05/152830ea.jpg","nickname":"ç©ºäº¦éç©º","note":"","ucode":"6F144ADA082550","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":590203,"discussion_content":"è°¢è°¢åˆ†äº«","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1665614325,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":"æ±Ÿè‹"},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":130208,"user_name":"æ´»çš„æ½‡æ´’","can_delete":false,"product_type":"c1","uid":1238830,"ip_address":"","ucode":"666C30CA894754","user_header":"https://static001.geekbang.org/account/avatar/00/12/e7/2e/1522a7d6.jpg","comment_is_top":false,"comment_ctime":1567403709,"is_pvip":false,"discussion_count":2,"race_medal":0,"score":"1567403709","product_id":100026001,"comment_content":"â€œå¯¹è‡ªå·±ç‹ ä¸€ç‚¹ï¼Œå‘ç°è¿˜æ˜¯æœ‰æ½œåŠ›å¯æŒ–â€<br><br>day37 å¤©ç¬”è®°ï¼šhttps:&#47;&#47;www.cnblogs.com&#47;luoahong&#47;p&#47;11359393.html","like_count":0,"discussions":[{"author":{"id":1012528,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/73/30/fd602742.jpg","nickname":"å¤§é©¬çŒ´","note":"","ucode":"E3482CBDF43CDE","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":71996,"discussion_content":"å†œå¤«å±±æ³‰å•Š","likes_number":1,"is_delete":false,"is_hidden":false,"ctime":1575467966,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":1,"child_discussions":[{"author":{"id":2119325,"avatar":"https://static001.geekbang.org/account/avatar/00/20/56/9d/4b2a7d29.jpg","nickname":"ryanxw","note":"","ucode":"0B91EAC8D06EED","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":1012528,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/73/30/fd602742.jpg","nickname":"å¤§é©¬çŒ´","note":"","ucode":"E3482CBDF43CDE","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":533255,"discussion_content":"è¿™ä¸ªäººå±å®æ˜¯æœ‰ç‚¹é—®é¢˜ï¼Œæ¯ç« éƒ½ç…§æ¬ï¼Œä¸çŸ¥é“å›¾å•¥ï¼Œå“ˆå“ˆ","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1637825580,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":71996,"ip_address":""},"score":533255,"extra":"{\"user_type\":1}"}]}]},{"had_liked":false,"id":129988,"user_name":"ç„°ç«","can_delete":false,"product_type":"c1","uid":1244606,"ip_address":"","ucode":"D3353B386DE3B5","user_header":"https://static001.geekbang.org/account/avatar/00/12/fd/be/079c78c7.jpg","comment_is_top":false,"comment_ctime":1567347755,"is_pvip":true,"discussion_count":0,"race_medal":0,"score":"1567347755","product_id":100026001,"comment_content":"ç²¾å¦™~~","like_count":0},{"had_liked":false,"id":115449,"user_name":"coder","can_delete":false,"product_type":"c1","uid":1399673,"ip_address":"","ucode":"929E3FFD14EFC8","user_header":"https://static001.geekbang.org/account/avatar/00/15/5b/79/d55044ac.jpg","comment_is_top":false,"comment_ctime":1563590518,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1563590518","product_id":100026001,"comment_content":"å¾è€å¸ˆï¼Œä½ å¥½ï¼Œè¯·æ•™æ‚¨ä¸€ä¸ªé—®é¢˜ï¼šå¯¹äºæŒ‡ä»¤è·Ÿæ•°æ®åˆ†å¼€çš„å“ˆå¼—æ¶æ„ï¼Œæ•°æ®cacheæŒ‰ç…§æ–‡ä¸­æçš„é‚£å‡ ç§æ–¹å¼å¾ˆå¥½ç†è§£ï¼Œ<br>é‚£ä¹ˆæŒ‡ä»¤cacheä¹Ÿæ˜¯æŒ‰ç…§å…¨ç›¸è”ï¼Œç»„ç›¸è”çš„æ–¹å¼ç®¡ç†çš„å—ï¼Ÿ","like_count":0},{"had_liked":false,"id":115415,"user_name":"å—å±±","can_delete":false,"product_type":"c1","uid":1119593,"ip_address":"","ucode":"94656FE4A6C378","user_header":"https://static001.geekbang.org/account/avatar/00/11/15/69/187b9968.jpg","comment_is_top":false,"comment_ctime":1563584621,"is_pvip":true,"discussion_count":0,"race_medal":0,"score":"1563584621","product_id":100026001,"comment_content":"æŒ‰è¡Œï¼Œ1ï¼Œç©ºé—´å±€éƒ¨æ€§ã€‚2ï¼Œæé«˜ä½¿ç”¨cache lineå‘½ä¸­ç‡<br>æ—¶é—´å°±æ˜¯é‡‘é’±ï¼ï¼ï¼","like_count":0},{"had_liked":false,"id":115247,"user_name":"è®¸ç«¥ç«¥","can_delete":false,"product_type":"c1","uid":1003005,"ip_address":"","ucode":"4B799C0C6BC678","user_header":"https://static001.geekbang.org/account/avatar/00/0f/4d/fd/0aa0e39f.jpg","comment_is_top":false,"comment_ctime":1563517837,"is_pvip":false,"discussion_count":1,"race_medal":0,"score":"1563517837","product_id":100026001,"comment_content":"è€å¸ˆä½ å¥½ï¼Œå†…å­˜åœ°å€çš„è¡¨ç¤ºå½¢å¼å¯ä»¥è¯´ä¸€ä¸‹å—ï¼Œä¸æ˜¯è¿˜æœ‰æ“ä½œç³»ç»Ÿçš„è™šæ‹Ÿå†…å­˜åœ°å€å—ï¼Œè¿™ä¸€å—æ˜¯æ€ä¹ˆç›´æ¥æ˜ å°„çš„ï¼Ÿ","like_count":0,"discussions":[{"author":{"id":1484184,"avatar":"https://static001.geekbang.org/account/avatar/00/16/a5/98/a65ff31a.jpg","nickname":"djfhchdh","note":"","ucode":"E71D75328CE398","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":2397,"discussion_content":"æˆ‘æ„Ÿè§‰è¿™é‡Œçš„å†…å­˜åœ°å€åº”è¯¥æ˜¯ç‰©ç†åœ°å€äº†","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1563537271,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":115236,"user_name":"gigglesun","can_delete":false,"product_type":"c1","uid":1012912,"ip_address":"","ucode":"7AE6C7DCE06063","user_header":"","comment_is_top":false,"comment_ctime":1563515750,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1563515750","product_id":100026001,"comment_content":"æ¯”å¦‚æˆ‘æœ‰ä¸€ä¸ªintå˜é‡çš„åœ°å€ï¼Œå‡è®¾æ˜¯32ä½ï¼Œå»å–å®ƒçš„å€¼ï¼Œæ€ä¹ˆä»ç¼“å­˜è·å¾—ï¼Ÿè¿™ä¸ªè¿‡ç¨‹æ˜¯ä»€ä¹ˆï¼Œæ„Ÿè§‰ç¼ºäº†offsetçš„ä¿¡æ¯å‘€","like_count":0},{"had_liked":false,"id":115191,"user_name":"humor","can_delete":false,"product_type":"c1","uid":1181867,"ip_address":"","ucode":"9B48C4C7BEC92C","user_header":"https://static001.geekbang.org/account/avatar/00/12/08/ab/caec7bca.jpg","comment_is_top":false,"comment_ctime":1563504680,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1563504680","product_id":100026001,"comment_content":"æŒ‰è¡Œå¿«ï¼ŒæŒ‰è¡Œå¯ä»¥å……åˆ†åˆ©ç”¨CPU cacheä¸€æ¬¡åŠ è½½çš„å†…å­˜ï¼ŒæŒ‰åˆ—çš„è¯CPU cacheåˆ©ç”¨ç‡æ¯”è¾ƒä½ã€‚ä¸€æ¬¡åŠ è½½16ä¸ªæ•´æ•°ï¼Œé€Ÿåº¦å¤§æ¦‚ç›¸å·®16å€å§","like_count":0},{"had_liked":false,"id":115180,"user_name":"Linuxer","can_delete":false,"product_type":"c1","uid":1153978,"ip_address":"","ucode":"272D9D8089C3D6","user_header":"https://static001.geekbang.org/account/avatar/00/11/9b/ba/333b59e5.jpg","comment_is_top":false,"comment_ctime":1563504032,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1563504032","product_id":100026001,"comment_content":"æœ‰ä¸€ä¸ªé—®é¢˜è¯·æ•™ï¼Œè¦è¡¨ç¤ºcacheçš„ç´¢å¼•å’Œåç§»3ä¸ªä½ä¸å¤Ÿå•Šï¼Œè‡³å°‘è¦ä¸ƒä½å•Š","like_count":0},{"had_liked":false,"id":115169,"user_name":"Linuxer","can_delete":false,"product_type":"c1","uid":1153978,"ip_address":"","ucode":"272D9D8089C3D6","user_header":"https://static001.geekbang.org/account/avatar/00/11/9b/ba/333b59e5.jpg","comment_is_top":false,"comment_ctime":1563502658,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1563502658","product_id":100026001,"comment_content":"ä¸€è¡Œä¸€è¡Œå¤„ç†ï¼Œé«˜é€Ÿç¼“å­˜å‘½ä¸­ç‡æ›´é«˜å§","like_count":0},{"had_liked":false,"id":115092,"user_name":"å®‰æ’","can_delete":false,"product_type":"c1","uid":1260026,"ip_address":"","ucode":"F78CFA9624CAEF","user_header":"https://static001.geekbang.org/account/avatar/00/13/39/fa/a7edbc72.jpg","comment_is_top":false,"comment_ctime":1563493775,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1563493775","product_id":100026001,"comment_content":"cacheå’Œmmuä½ç½®å…³ç³»æ˜¯æ€ä¹ˆæ ·çš„ï¼Ÿå“ªä¸ªåœ¨å‰å“ªä¸ªåœ¨åï¼Ÿ","like_count":1}]}