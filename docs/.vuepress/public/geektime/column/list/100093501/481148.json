{"id":481148,"title":"åŠ é¤ï½œå¦‚ä½•æ‹‰å–ç§æœ‰çš„Go Moduleï¼Ÿ","content":"<p>ä½ å¥½ï¼Œæˆ‘æ˜¯Tony Baiã€‚</p><p>æˆ‘ä»¬è¿™é—¨è¯¾ç¨‹ä¸Šçº¿ä»¥æ¥æ”¶åˆ°äº†åŒå­¦ä»¬çš„ä¼—å¤šç•™è¨€ä¸çƒ­çƒˆåé¦ˆï¼Œåœ¨è¿™äº›ç•™è¨€å’Œåé¦ˆä¸­ï¼Œæœ‰å…³Go Moduleçš„é—®é¢˜å æ¯”æ¯”è¾ƒå¤§ï¼Œå…¶ä¸­åˆä»¥ä¸‹é¢è¿™ä¸¤ä¸ªé—®é¢˜æ¯”è¾ƒçªå‡ºï¼š</p><ul>\n<li>åœ¨æŸmoduleå°šæœªå‘å¸ƒåˆ°ç±»ä¼¼GitHubè¿™æ ·çš„ç½‘ç«™å‰ï¼Œå¦‚ä½•importè¿™ä¸ªæœ¬åœ°çš„moduleï¼Ÿ</li>\n<li>å¦‚ä½•æ‹‰å–ç§æœ‰moduleï¼Ÿ</li>\n</ul><p>å€Ÿè¿™æ¬¡åŠ é¤æœºä¼šï¼Œä»Šå¤©æˆ‘å°±é’ˆå¯¹è¿™ä¸¤ä¸ªé—®é¢˜å’Œä½ èŠèŠæˆ‘çŸ¥é“çš„ä¸€äº›è§£å†³æ–¹æ¡ˆã€‚</p><p>é¦–å…ˆæˆ‘ä»¬å…ˆæ¥çœ‹ç¬¬ä¸€ä¸ªé—®é¢˜ï¼šå¦‚ä½•å¯¼å…¥æœ¬åœ°çš„moduleã€‚</p><h2>å¯¼å…¥æœ¬åœ°module</h2><p>åœ¨å‰é¢çš„06å’Œ07è®²ï¼Œæˆ‘ä»¬å·²ç»ç³»ç»Ÿè®²è§£äº†Go Moduleæ„å»ºæ¨¡å¼ã€‚Go Moduleä»Go 1.11ç‰ˆæœ¬å¼€å§‹å¼•å…¥åˆ°Goä¸­ï¼Œç°åœ¨å®ƒå·²ç»æˆä¸ºäº†Goè¯­è¨€çš„ä¾èµ–ç®¡ç†ä¸æ„å»ºçš„æ ‡å‡†ï¼Œå› æ­¤ï¼Œæˆ‘ä¹Ÿä¸€ç›´å»ºè®®ä½ å½»åº•æŠ›å¼ƒGopathæ„å»ºæ¨¡å¼ï¼Œå…¨é¢æ‹¥æŠ±Go Moduleæ„å»ºæ¨¡å¼ã€‚å¹¶ä¸”ï¼Œè¿™é—¨è¯¾ä¸­çš„æ‰€æœ‰ä¾‹å­å’Œå®æˆ˜å°é¡¹ç›®ï¼Œæˆ‘ä½¿ç”¨çš„éƒ½æ˜¯Go Moduleæ„å»ºæ¨¡å¼ã€‚</p><p>å½“æˆ‘ä»¬çš„é¡¹ç›®ä¾èµ–å·²å‘å¸ƒåœ¨GitHubç­‰ä»£ç æ‰˜ç®¡ç«™ç‚¹çš„å…¬å…±Go Moduleæ—¶ï¼ŒGoå‘½ä»¤å·¥å…·å¯ä»¥å¾ˆå¥½åœ°å®Œæˆä¾èµ–ç‰ˆæœ¬é€‰æ‹©ä»¥åŠGo Moduleæ‹‰å–çš„å·¥ä½œã€‚</p><p><strong>ä¸è¿‡ï¼Œå¦‚æœæˆ‘ä»¬çš„é¡¹ç›®ä¾èµ–çš„æ˜¯æœ¬åœ°æ­£åœ¨å¼€å‘ã€å°šæœªå‘å¸ƒåˆ°å…¬å…±ç«™ç‚¹ä¸Šçš„Go Moduleï¼Œé‚£ä¹ˆæˆ‘ä»¬åº”è¯¥å¦‚ä½•åšå‘¢ï¼Ÿ</strong>æˆ‘ä»¬æ¥çœ‹ä¸€ä¸ªä¾‹å­ã€‚</p><!-- [[[read_end]]] --><p>å‡è®¾ä½ æœ‰ä¸€ä¸ªé¡¹ç›®ï¼Œè¿™ä¸ªé¡¹ç›®ä¸­çš„module aä¾èµ–module bï¼Œè€Œmodule bæ˜¯ä½ å¦å¤–ä¸€ä¸ªé¡¹ç›®ä¸­çš„moduleï¼Œå®ƒæœ¬æ¥æ˜¯è¦å‘å¸ƒåˆ°<code>github.com/user/b</code>ä¸Šçš„ã€‚</p><p>ä½†æ­¤æ—¶æ­¤åˆ»ï¼Œmodule bè¿˜æ²¡æœ‰å‘å¸ƒåˆ°å…¬å…±æ‰˜ç®¡ç«™ç‚¹ä¸Šï¼Œå®ƒæºç è¿˜åœ¨ä½ çš„å¼€å‘æœºå™¨ä¸Šã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œgoå‘½ä»¤æ— æ³•åœ¨<code>github.com/user/b</code>ä¸Šæ‰¾åˆ°å¹¶æ‹‰å–module açš„ä¾èµ–module bï¼Œè¿™æ—¶ï¼Œå¦‚æœä½ é’ˆå¯¹module aæ‰€åœ¨é¡¹ç›®ä½¿ç”¨go mod tidyå‘½ä»¤ï¼Œå°±ä¼šæ”¶åˆ°ç±»ä¼¼ä¸‹é¢è¿™æ ·çš„æŠ¥é”™ä¿¡æ¯ï¼š</p><pre><code class=\"language-plain\">$go mod tidy\ngo: finding module for package github.com/user/b\ngithub.com/user/a imports\n    github.com/user/b: cannot find module providing package github.com/user/b: module github.com/user/b: reading https://goproxy.io/github.com/user/b/@v/list: 404 Not Found\n    server response:\n    not found: github.com/user/b@latest: terminal prompts disabled\n    Confirm the import path was entered correctly.\n    If this is a private repository, see https://golang.org/doc/faq#git_https for additional information.\n</code></pre><p>è¿™ä¸ªæ—¶å€™ï¼Œæˆ‘ä»¬å°±å¯ä»¥å€ŸåŠ©<strong>go.modçš„replaceæŒ‡ç¤ºç¬¦</strong>ï¼Œæ¥è§£å†³è¿™ä¸ªé—®é¢˜ã€‚è§£å†³çš„æ­¥éª¤æ˜¯è¿™æ ·çš„ã€‚</p><p>é¦–å…ˆï¼Œæˆ‘ä»¬éœ€è¦åœ¨module açš„go.modä¸­çš„requireå—ä¸­ï¼Œæ‰‹å·¥åŠ ä¸Šè¿™ä¸€æ¡ï¼ˆè¿™ä¹Ÿå¯ä»¥é€šè¿‡go mod editå‘½ä»¤å®ç°ï¼‰ï¼š</p><pre><code class=\"language-plain\">require github.com/user/b v1.0.0\n</code></pre><p>æ³¨æ„äº†ï¼Œè¿™é‡Œçš„v1.0.0ç‰ˆæœ¬å·æ˜¯ä¸€ä¸ªâ€œå‡ç‰ˆæœ¬å·â€ï¼Œç›®çš„æ˜¯æ»¡è¶³go.modä¸­requireå—çš„è¯­æ³•è¦æ±‚ã€‚</p><p>ç„¶åï¼Œæˆ‘ä»¬å†åœ¨module açš„go.modä¸­ä½¿ç”¨replaceï¼Œå°†ä¸Šé¢å¯¹module b v1.0.0çš„ä¾èµ–ï¼Œæ›¿æ¢ä¸ºæœ¬åœ°è·¯å¾„ä¸Šçš„module b:</p><pre><code class=\"language-plain\">replace github.com/user/b v1.0.0 =&gt; module bçš„æœ¬åœ°æºç è·¯å¾„\n</code></pre><p>è¿™æ ·ä¿®æ”¹ä¹‹åï¼Œgoå‘½ä»¤å°±ä¼šè®©module aä¾èµ–ä½ æœ¬åœ°æ­£åœ¨å¼€å‘ã€å°šæœªå‘å¸ƒåˆ°ä»£ç æ‰˜ç®¡ç½‘ç«™çš„module bçš„æºç äº†ã€‚</p><p>è€Œä¸”ï¼Œå¦‚æœmodule bå·²ç»æäº¤åˆ°ç±»GitHubçš„ç«™ç‚¹ä¸Šï¼Œä½†module bçš„ä½œè€…æ­£åœ¨æœ¬åœ°å¼€å‘æ–°ç‰ˆæœ¬ï¼Œé‚£ä¹ˆä¸Šé¢è¿™ç§æ–¹æ³•ï¼Œä¹ŸåŒæ ·é€‚åˆmodule bçš„ä½œè€…åœ¨æœ¬åœ°æµ‹è¯•éªŒè¯module bçš„æœ€æ–°ç‰ˆæœ¬æºç ã€‚</p><p>è™½ç„¶â€œä¼ªé€ â€go.modæ–‡ä»¶å†…å®¹ï¼Œå¯ä»¥è§£å†³ä¸Šè¿°è¿™ä¸¤ä¸ªåœºæ™¯ä¸­çš„é—®é¢˜ï¼Œä½†æ˜¾ç„¶è¿™ç§æ–¹æ³•ä¹Ÿæ˜¯<strong>æœ‰â€œç‘•ç–µâ€çš„</strong>ã€‚</p><p>é¦–å…ˆï¼Œè¿™ä¸ªæ–¹æ³•ä¸­ï¼ŒrequireæŒ‡ç¤ºç¬¦å°†<code>github.com/user/b v1.0.0</code>æ›¿æ¢ä¸ºä¸€ä¸ªæœ¬åœ°è·¯å¾„ä¸‹çš„module bçš„æºç ç‰ˆæœ¬ï¼Œä½†è¿™ä¸ª<strong>æœ¬åœ°è·¯å¾„</strong>æ˜¯å› å¼€å‘è€…ç¯å¢ƒè€Œå¼‚çš„ã€‚</p><p>å‰é¢è¯¾ç¨‹ä¸­æˆ‘ä»¬è®²è¿‡ï¼Œgo.modæ–‡ä»¶é€šå¸¸æ˜¯è¦ä¸Šä¼ åˆ°ä»£ç æœåŠ¡å™¨ä¸Šçš„ï¼Œè¿™å°±æ„å‘³ç€ï¼Œå¦å¤–ä¸€ä¸ªå¼€å‘äººå‘˜ä¸‹è½½äº†è¿™ä»½ä»£ç åï¼Œæå¤§å¯èƒ½æ˜¯æ— æ³•æˆåŠŸç¼–è¯‘çš„ï¼Œä»–è¦æƒ³å®Œæˆmodule açš„ç¼–è¯‘ï¼Œå°±å¾—å°†replaceåé¢çš„æœ¬åœ°è·¯å¾„æ”¹ä¸ºé€‚é…è‡ªå·±ç¯å¢ƒä¸‹çš„è·¯å¾„ã€‚</p><p>äºæ˜¯ï¼Œæ¯å½“å¼€å‘äººå‘˜pullä»£ç åï¼Œç¬¬ä¸€ä»¶äº‹å°±æ˜¯è¦ä¿®æ”¹module açš„go.modä¸­çš„replaceå—ï¼Œæ¯æ¬¡ä¸Šä¼ ä»£ç å‰ï¼Œå¯èƒ½ä¹Ÿè¦å°†replaceè·¯å¾„å¤åŸï¼Œè¿™æ˜¯ä¸€ä¸ªå¾ˆç³Ÿå¿ƒçš„äº‹æƒ…ã€‚ä½†å³ä¾¿å¦‚æ­¤ï¼Œç›®å‰Goç‰ˆæœ¬ï¼ˆæœ€æ–°ä¸ºGo 1.17.xï¼‰ä¹Ÿæ²¡æœ‰ä¸€ä¸ªå®Œç¾çš„åº”å¯¹æ–¹æ¡ˆã€‚</p><p>é’ˆå¯¹è¿™ä¸ªé—®é¢˜ï¼ŒGoæ ¸å¿ƒå›¢é˜Ÿåœ¨Goç¤¾åŒºçš„å¸®åŠ©ä¸‹ï¼Œåœ¨é¢„è®¡2022å¹´2æœˆå‘å¸ƒçš„Go 1.18ç‰ˆæœ¬ä¸­åŠ å…¥äº†Goå·¥ä½œåŒºï¼ˆGo workspaceï¼Œä¹Ÿè¯‘ä½œGoå·¥ä½œç©ºé—´ï¼‰è¾…åŠ©æ„å»ºæœºåˆ¶ã€‚</p><p>åŸºäºè¿™ä¸ªæœºåˆ¶ï¼Œæˆ‘ä»¬å¯ä»¥å°†å¤šä¸ªæœ¬åœ°è·¯å¾„æ”¾å…¥åŒä¸€ä¸ªworkspaceä¸­ï¼Œè¿™æ ·ï¼Œåœ¨è¿™ä¸ªworkspaceä¸‹å„ä¸ªmoduleçš„æ„å»ºå°†ä¼˜å…ˆä½¿ç”¨workspaceä¸‹çš„moduleçš„æºç ã€‚å·¥ä½œåŒºé…ç½®æ•°æ®ä¼šæ”¾åœ¨ä¸€ä¸ªåä¸ºgo.workçš„æ–‡ä»¶ä¸­ï¼Œè¿™ä¸ªæ–‡ä»¶æ˜¯å¼€å‘è€…ç¯å¢ƒç›¸å…³çš„ï¼Œå› æ­¤å¹¶ä¸éœ€è¦æäº¤åˆ°æºç æœåŠ¡å™¨ä¸Šï¼Œè¿™å°±è§£å†³äº†ä¸Šé¢â€œä¼ªé€ go.modâ€æ–¹æ¡ˆå¸¦æ¥çš„é‚£äº›é—®é¢˜ã€‚</p><p>ä¸è¿‡ï¼ŒGo 1.18ç‰ˆæœ¬å°šæœªå‘å¸ƒï¼Œæˆ‘è¿™é‡Œå°±ä¸å†æ·±å…¥è®²è§£äº†Go workspaceæœºåˆ¶äº†ï¼Œå¦‚æœä½ æœ‰å…´è¶£ï¼Œå¯ä»¥å»ä¸‹è½½Go 1.18 Beta1ç‰ˆæœ¬æŠ¢å…ˆä½“éªŒã€‚</p><p>æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬å†æ¥çœ‹çœ‹æ‹‰å–ç§æœ‰moduleçš„å¯è¡Œè§£å†³æ–¹æ¡ˆã€‚</p><h2>æ‹‰å–ç§æœ‰moduleçš„éœ€æ±‚ä¸å‚è€ƒæ–¹æ¡ˆ</h2><p>Go 1.11ç‰ˆæœ¬å¼•å…¥Go Moduleæ„å»ºæ¨¡å¼åï¼Œç”¨Goå‘½ä»¤æ‹‰å–é¡¹ç›®ä¾èµ–çš„å…¬å…±Go Moduleï¼Œå·²ä¸å†æ˜¯â€œç—›ç‚¹â€ï¼Œæˆ‘ä»¬åªéœ€è¦åœ¨æ¯ä¸ªå¼€å‘æœºä¸Šä¸ºç¯å¢ƒå˜é‡GOPROXYï¼Œé…ç½®ä¸€ä¸ªé«˜æ•ˆå¥½ç”¨çš„å…¬å…±GOPROXYæœåŠ¡ï¼Œå°±å¯ä»¥è½»æ¾æ‹‰å–æ‰€æœ‰å…¬å…±Go Moduleäº†ï¼š</p><p><img src=\"https://static001.geekbang.org/resource/image/eb/31/eb6dfca9868738a55162323ccf45ba31.png?wh=621x451\" alt=\"å›¾ç‰‡\"></p><p>ä½†éšç€å…¬å¸å†…Goä½¿ç”¨è€…å’ŒGoé¡¹ç›®çš„å¢å¤šï¼Œâ€œé‡é€ è½®å­â€çš„é—®é¢˜å°±å‡ºç°äº†ã€‚æŠ½å–å…¬å…±ä»£ç æ”¾å…¥ä¸€ä¸ªç‹¬ç«‹çš„ã€å¯è¢«å¤ç”¨çš„å†…éƒ¨ç§æœ‰ä»“åº“æˆä¸ºäº†å¿…ç„¶ï¼Œè¿™æ ·æˆ‘ä»¬å°±<strong>æœ‰äº†æ‹‰å–ç§æœ‰Go Moduleçš„éœ€æ±‚ã€‚</strong></p><p>ä¸€äº›å…¬å¸æˆ–ç»„ç»‡çš„æ‰€æœ‰ä»£ç ï¼Œéƒ½æ”¾åœ¨å…¬å…±vcsæ‰˜ç®¡æœåŠ¡å•†é‚£é‡Œï¼ˆæ¯”å¦‚github.comï¼‰ï¼Œç§æœ‰Go Moduleåˆ™ç›´æ¥æ”¾åœ¨å¯¹åº”çš„å…¬å…±vcsæœåŠ¡çš„private repositoryï¼ˆç§æœ‰ä»“åº“ï¼‰ä¸­ã€‚å¦‚æœä½ çš„å…¬å¸ä¹Ÿæ˜¯è¿™æ ·ï¼Œé‚£ä¹ˆæ‹‰å–æ‰˜ç®¡åœ¨å…¬å…±vcsç§æœ‰ä»“åº“ä¸­çš„ç§æœ‰Go Moduleï¼Œä¹Ÿå¾ˆå®¹æ˜“ï¼Œè§ä¸‹å›¾ï¼š</p><p><img src=\"https://static001.geekbang.org/resource/image/d6/yy/d6b950bddc40aaa48601e2a75159b8yy.png?wh=656x361\" alt=\"å›¾ç‰‡\"></p><p>ä¹Ÿå°±æ˜¯è¯´ï¼Œåªè¦æˆ‘ä»¬åœ¨æ¯ä¸ªå¼€å‘æœºä¸Šï¼Œé…ç½®å…¬å…±GOPROXYæœåŠ¡æ‹‰å–å…¬å…±Go Moduleï¼ŒåŒæ—¶å†æŠŠç§æœ‰ä»“åº“é…ç½®åˆ°GOPRIVATEç¯å¢ƒå˜é‡ï¼Œå°±å¯ä»¥äº†ã€‚è¿™æ ·ï¼Œæ‰€æœ‰ç§æœ‰moduleçš„æ‹‰å–ï¼Œéƒ½ä¼šç›´è¿ä»£ç æ‰˜ç®¡æœåŠ¡å™¨ï¼Œä¸ä¼šèµ°GOPROXYä»£ç†æœåŠ¡ï¼Œä¹Ÿä¸ä¼šå»GOSUMDBæœåŠ¡å™¨åšGoåŒ…çš„hashå€¼æ ¡éªŒã€‚</p><p>å½“ç„¶ï¼Œè¿™ä¸ªæ–¹æ¡ˆæœ‰ä¸€ä¸ªå‰æï¼Œé‚£å°±æ˜¯æ¯ä¸ªå¼€å‘äººå‘˜éƒ½éœ€è¦å…·æœ‰è®¿é—®å…¬å…±vcsæœåŠ¡ä¸Šçš„ç§æœ‰Go Moduleä»“åº“çš„æƒé™ï¼Œå‡­è¯çš„å½¢å¼ä¸é™ï¼Œå¯ä»¥æ˜¯basic authçš„userå’Œpasswordï¼Œä¹Ÿå¯ä»¥æ˜¯personal access tokenï¼ˆç±»ä¼¼GitHubé‚£ç§ï¼‰ï¼Œåªè¦æŒ‰ç…§å…¬å…±vcsçš„èº«ä»½è®¤è¯è¦æ±‚æä¾›å°±å¯ä»¥äº†ã€‚</p><p>ä¸è¿‡ï¼Œæ›´å¤šçš„å…¬å¸/ç»„ç»‡ï¼Œå¯èƒ½ä¼šå°†ç§æœ‰Go Moduleæ”¾åœ¨å…¬å¸/ç»„ç»‡å†…éƒ¨çš„vcsï¼ˆä»£ç ç‰ˆæœ¬æ§åˆ¶ï¼‰æœåŠ¡å™¨ä¸Šï¼Œå°±åƒä¸‹é¢å›¾ä¸­æ‰€ç¤ºï¼š</p><p><img src=\"https://static001.geekbang.org/resource/image/19/54/191c16d8ee23f926ae1bcc323af67b54.png?wh=776x341\" alt=\"å›¾ç‰‡\"></p><p>é‚£ä¹ˆè¿™ç§æƒ…å†µï¼Œæˆ‘ä»¬è¯¥å¦‚ä½•è®©Goå‘½ä»¤ï¼Œè‡ªåŠ¨æ‹‰å–å†…éƒ¨æœåŠ¡å™¨ä¸Šçš„ç§æœ‰Go Moduleå‘¢ï¼Ÿè¿™é‡Œç»™å‡ºä¸¤ä¸ªå‚è€ƒæ–¹æ¡ˆã€‚</p><p><strong>ç¬¬ä¸€ä¸ªæ–¹æ¡ˆæ˜¯é€šè¿‡ç›´è¿ç»„ç»‡å…¬å¸å†…éƒ¨çš„ç§æœ‰Go ModuleæœåŠ¡å™¨æ‹‰å–ã€‚</strong></p><p><img src=\"https://static001.geekbang.org/resource/image/4b/9b/4b18a305f8982678844a7904186c8d9b.png?wh=1056x381\" alt=\"å›¾ç‰‡\"></p><p>åœ¨è¿™ä¸ªæ–¹æ¡ˆä¸­ï¼Œæˆ‘ä»¬çœ‹åˆ°ï¼Œå…¬å¸å†…éƒ¨ä¼šæ­å»ºä¸€ä¸ªå†…éƒ¨goproxyæœåŠ¡ï¼ˆä¹Ÿå°±æ˜¯ä¸Šå›¾ä¸­çš„in-house goproxyï¼‰ã€‚è¿™æ ·åšæœ‰ä¸¤ä¸ªç›®çš„ï¼Œä¸€æ˜¯ä¸ºé‚£äº›æ— æ³•ç›´æ¥è®¿é—®å¤–ç½‘çš„å¼€å‘æœºå™¨ï¼Œä»¥åŠciæœºå™¨æä¾›æ‹‰å–å¤–éƒ¨Go Moduleçš„é€”å¾„ï¼ŒäºŒæ¥ï¼Œç”±äºin-house goproxyçš„cacheçš„å­˜åœ¨ï¼Œè¿™æ ·åšè¿˜å¯ä»¥åŠ é€Ÿå…¬å…±Go Moduleçš„æ‹‰å–æ•ˆç‡ã€‚</p><p>å¦å¤–ï¼Œå¯¹äºç§æœ‰Go Moduleï¼Œå¼€å‘æœºåªéœ€è¦å°†å®ƒé…ç½®åˆ°GOPRIVATEç¯å¢ƒå˜é‡ä¸­å°±å¯ä»¥äº†ï¼Œè¿™æ ·ï¼ŒGoå‘½ä»¤åœ¨æ‹‰å–ç§æœ‰Go Moduleæ—¶ï¼Œå°±ä¸ä¼šå†èµ°GOPROXYï¼Œè€Œä¼šé‡‡ç”¨ç›´æ¥è®¿é—®vcsï¼ˆå¦‚ä¸Šå›¾ä¸­çš„git.yourcompany.comï¼‰çš„æ–¹å¼æ‹‰å–ç§æœ‰Go Moduleã€‚</p><p>è¿™ä¸ªæ–¹æ¡ˆååˆ†é€‚åˆå†…éƒ¨æœ‰å®Œå¤‡ITåŸºç¡€è®¾æ–½çš„å…¬å¸ã€‚è¿™ç±»å‹çš„å…¬å¸å†…éƒ¨çš„vcsæœåŠ¡å™¨éƒ½å¯ä»¥é€šè¿‡åŸŸåè®¿é—®ï¼ˆæ¯”å¦‚git.yourcompany.com/user/repoï¼‰ï¼Œå› æ­¤ï¼Œå…¬å¸å†…éƒ¨å‘˜å·¥å¯ä»¥åƒè®¿é—®å…¬å…±vcsæœåŠ¡é‚£æ ·ï¼Œè®¿é—®å†…éƒ¨vcsæœåŠ¡å™¨ä¸Šçš„ç§æœ‰Go Moduleã€‚</p><p><strong>ç¬¬äºŒç§æ–¹æ¡ˆï¼Œæ˜¯å°†å¤–éƒ¨Go Moduleä¸ç§æœ‰Go Moduleéƒ½äº¤ç»™å†…éƒ¨ç»Ÿä¸€çš„GOPROXYæœåŠ¡å»å¤„ç†ï¼š</strong></p><p><img src=\"https://static001.geekbang.org/resource/image/81/d2/8109cbaca802a189fa60c1140016f2d2.png?wh=1021x481\" alt=\"å›¾ç‰‡\"></p><p>åœ¨è¿™ç§æ–¹æ¡ˆä¸­ï¼Œå¼€å‘è€…åªéœ€è¦æŠŠGOPROXYé…ç½®ä¸ºin-house goproxyï¼Œå°±å¯ä»¥ç»Ÿä¸€æ‹‰å–å¤–éƒ¨Go Moduleä¸ç§æœ‰Go Moduleã€‚</p><p>ä½†ç”±äºgoå‘½ä»¤é»˜è®¤ä¼šå¯¹æ‰€æœ‰é€šè¿‡goproxyæ‹‰å–çš„Go Moduleï¼Œè¿›è¡Œsumæ ¡éªŒï¼ˆé»˜è®¤åˆ°sum.golang.org)ï¼Œè€Œæˆ‘ä»¬çš„ç§æœ‰Go Moduleåœ¨å…¬å…±suméªŒè¯serverä¸­åˆæ²¡æœ‰æ•°æ®è®°å½•ã€‚å› æ­¤ï¼Œå¼€å‘è€…éœ€è¦å°†ç§æœ‰Go Moduleå¡«åˆ°GONOSUMDBç¯å¢ƒå˜é‡ä¸­ï¼Œè¿™æ ·ï¼Œgoå‘½ä»¤å°±ä¸ä¼šå¯¹å…¶è¿›è¡Œsumæ ¡éªŒäº†ã€‚</p><p>ä¸è¿‡è¿™ç§æ–¹æ¡ˆæœ‰ä¸€å¤„è¦æ³¨æ„ï¼šin-house goproxyéœ€è¦æ‹¥æœ‰å¯¹æ‰€æœ‰private moduleæ‰€åœ¨repoçš„è®¿é—®æƒé™ï¼Œæ‰èƒ½ä¿è¯æ¯ä¸ªç§æœ‰Go Moduleéƒ½æ‹‰å–æˆåŠŸã€‚</p><p>ä½ å¯ä»¥å¯¹æ¯”ä¸€ä¸‹ä¸Šé¢è¿™ä¸¤ä¸ªå‚è€ƒæ–¹æ¡ˆï¼Œçœ‹çœ‹ä½ æ›´å€¾å‘äºå“ªä¸€ä¸ªï¼Œæˆ‘æ¨èç¬¬äºŒä¸ªæ–¹æ¡ˆã€‚åœ¨ç¬¬äºŒä¸ªæ–¹æ¡ˆä¸­ï¼Œæˆ‘ä»¬å¯ä»¥<strong>å°†æ‰€æœ‰å¤æ‚æ€§éƒ½äº¤ç»™in-house goproxyè¿™ä¸ªèŠ‚ç‚¹</strong>ï¼Œå¼€å‘äººå‘˜å¯ä»¥æ— å·®åˆ«åœ°æ‹‰å–å…¬å…±moduleä¸ç§æœ‰moduleï¼Œå¿ƒæ™ºè´Ÿæ‹…é™åˆ°æœ€ä½ã€‚</p><p>é‚£ä¹ˆæˆ‘ä»¬è¯¥æ€ä¹ˆå®ç°è¿™ä¸ªæ–¹æ¡ˆå‘¢ï¼Ÿæ¥ä¸‹æ¥æˆ‘å°±æ¥åˆ†æä¸€ä¸ªå¯è¡Œçš„å®ç°æ€è·¯ä¸å…·ä½“æ­¥éª¤ã€‚</p><h2>ç»Ÿä¸€Goproxyæ–¹æ¡ˆçš„å®ç°æ€è·¯ä¸æ­¥éª¤</h2><p>æˆ‘ä»¬å…ˆä¸ºåç»­çš„æ–¹æ¡ˆå®ç°å‡†å¤‡ä¸€ä¸ªç¤ºä¾‹ç¯å¢ƒï¼Œå®ƒçš„æ‹“æ‰‘å¦‚ä¸‹å›¾ï¼š</p><p><img src=\"https://static001.geekbang.org/resource/image/89/35/89f7d377ab4688b635aa82c203aac935.png?wh=1018x482\" alt=\"å›¾ç‰‡\"></p><h3>é€‰æ‹©ä¸€ä¸ªGOPROXYå®ç°</h3><p><a href=\"https://pkg.go.dev/cmd/go@master#hdr-Module_proxy_protocol\">Go module proxyåè®®è§„èŒƒ</a>å‘å¸ƒåï¼ŒGoç¤¾åŒºå‡ºç°äº†å¾ˆå¤šæˆç†Ÿçš„Goproxyå¼€æºå®ç°ï¼Œæ¯”å¦‚æœ‰æœ€åˆçš„<a href=\"https://github.com/gomods/athens\">athens</a>ï¼Œè¿˜æœ‰å›½å†…çš„ä¸¤ä¸ªä¼˜ç§€çš„å¼€æºå®ç°ï¼š<a href=\"https://github.com/goproxy/goproxy\">goproxy.cn</a>å’Œ<a href=\"https://github.com/goproxyio/goproxy\">goproxy.io</a>ç­‰ã€‚å…¶ä¸­ï¼Œgoproxy.ioåœ¨å®˜æ–¹ç«™ç‚¹ç»™å‡ºäº†<a href=\"https://goproxy.io/zh/docs/enterprise.html\">ä¼ä¸šå†…éƒ¨éƒ¨ç½²çš„æ–¹æ³•</a>ï¼Œæ‰€ä»¥ä»Šå¤©æˆ‘ä»¬å°±åŸºäºgoproxy.ioæ¥å®ç°æˆ‘ä»¬çš„æ–¹æ¡ˆã€‚</p><p>æˆ‘ä»¬åœ¨ä¸Šå›¾ä¸­çš„in-house goproxyèŠ‚ç‚¹ä¸Šæ‰§è¡Œè¿™å‡ ä¸ªæ­¥éª¤å®‰è£…goproxyï¼š</p><pre><code class=\"language-plain\">$mkdir ~/.bin/goproxy\n$cd ~/.bin/goproxy\n$git clone https://github.com/goproxyio/goproxy.git\n$cd goproxy\n$make\n</code></pre><p>ç¼–è¯‘åï¼Œæˆ‘ä»¬ä¼šåœ¨å½“å‰çš„binç›®å½•ï¼ˆ~/.bin/goproxy/goproxy/binï¼‰ä¸‹çœ‹åˆ°åä¸ºgoproxyçš„å¯æ‰§è¡Œæ–‡ä»¶ã€‚</p><p>ç„¶åï¼Œæˆ‘ä»¬å»ºç«‹goproxy cacheç›®å½•ï¼š</p><pre><code class=\"language-plain\">$mkdir /root/.bin/goproxy/goproxy/bin/cache\n</code></pre><p>å†å¯åŠ¨goproxyï¼š</p><pre><code class=\"language-plain\">$./goproxy -listen=0.0.0.0:8081 -cacheDir=/root/.bin/goproxy/goproxy/bin/cache -proxy https://goproxy.io\ngoproxy.io: ProxyHost https://goproxy.io\n</code></pre><p>å¯åŠ¨åï¼Œgoproxyä¼šåœ¨8081ç«¯å£ä¸Šç›‘å¬ï¼ˆå³ä¾¿ä¸æŒ‡å®šï¼Œgoproxyçš„é»˜è®¤ç«¯å£ä¹Ÿæ˜¯8081ï¼‰ï¼ŒæŒ‡å®šçš„ä¸Šæ¸¸goproxyæœåŠ¡ä¸ºgoproxy.ioã€‚</p><p>ä¸è¿‡è¦æ³¨æ„ä¸‹ï¼šgoproxyçš„è¿™ä¸ªå¯åŠ¨å‚æ•°å¹¶ä¸æ˜¯æœ€ç»ˆç‰ˆæœ¬çš„ï¼Œè¿™é‡Œæˆ‘ä»…ä»…æƒ³éªŒè¯ä¸€ä¸‹goproxyæ˜¯å¦èƒ½æŒ‰é¢„æœŸå·¥ä½œã€‚æˆ‘ä»¬ç°åœ¨å°±æ¥å®é™…éªŒè¯ä¸€ä¸‹ã€‚</p><p>é¦–å…ˆï¼Œæˆ‘ä»¬åœ¨å¼€å‘æœºä¸Šé…ç½®GOPROXYç¯å¢ƒå˜é‡æŒ‡å‘10.10.20.20:8081ï¼š</p><pre><code class=\"language-plain\">// .bashrc\nexport GOPROXY=http://10.10.20.20:8081\n</code></pre><p>ç”Ÿæ•ˆç¯å¢ƒå˜é‡åï¼Œæ‰§è¡Œä¸‹é¢å‘½ä»¤ï¼š</p><pre><code class=\"language-plain\">$go get github.com/pkg/errors\n</code></pre><p>ç»“æœå’Œæˆ‘ä»¬é¢„æœŸçš„ä¸€è‡´ï¼Œå¼€å‘æœºé¡ºåˆ©ä¸‹è½½äº†github.com/pkg/errorsåŒ…ã€‚æˆ‘ä»¬å¯ä»¥åœ¨goproxyä¾§ï¼Œçœ‹åˆ°äº†ç›¸åº”çš„æ—¥å¿—ï¼š</p><pre><code class=\"language-plain\">goproxy.io: ------ --- /github.com/pkg/@v/list [proxy]\ngoproxy.io: ------ --- /github.com/pkg/errors/@v/list [proxy]\ngoproxy.io: ------ --- /github.com/@v/list [proxy]\ngoproxy.io: 0.146s 404 /github.com/@v/list\ngoproxy.io: 0.156s 404 /github.com/pkg/@v/list\ngoproxy.io: 0.157s 200 /github.com/pkg/errors/@v/list\n</code></pre><p>åœ¨goproxyçš„cacheç›®å½•ä¸‹ï¼Œæˆ‘ä»¬ä¹Ÿçœ‹åˆ°äº†ä¸‹è½½å¹¶ç¼“å­˜çš„github.com/pkg/errorsåŒ…ï¼š</p><pre><code class=\"language-plain\">$cd /root/.bin/goproxy/goproxy/bin/cache\n$tree\n.\nâ””â”€â”€ pkg\n    â””â”€â”€ mod\n        â””â”€â”€ cache\n            â””â”€â”€ download\n                â””â”€â”€ github.com\n                    â””â”€â”€ pkg\n                        â””â”€â”€ errors\n                            â””â”€â”€ @v\n                                â””â”€â”€ list\n\n8 directories, 1 file\n</code></pre><p>è¿™å°±æ ‡å¿—ç€æˆ‘ä»¬çš„goproxyæœåŠ¡æ­å»ºæˆåŠŸï¼Œå¹¶å¯ä»¥æ­£å¸¸è¿ä½œäº†ã€‚</p><h3>è‡ªå®šä¹‰åŒ…å¯¼å…¥è·¯å¾„å¹¶å°†å…¶æ˜ å°„åˆ°å†…éƒ¨çš„vcsä»“åº“</h3><p>ä¸€èˆ¬å…¬å¸å¯èƒ½æ²¡æœ‰ä¸ºvcsæœåŠ¡å™¨åˆ†é…åŸŸåï¼Œæˆ‘ä»¬ä¹Ÿä¸èƒ½åœ¨Goç§æœ‰åŒ…çš„å¯¼å…¥è·¯å¾„ä¸­æ”¾å…¥ipåœ°å€ï¼Œå› æ­¤æˆ‘ä»¬éœ€è¦ç»™æˆ‘ä»¬çš„ç§æœ‰Go Moduleè‡ªå®šä¹‰ä¸€ä¸ªè·¯å¾„ï¼Œæ¯”å¦‚ï¼šmycompany.com/go/module1ã€‚æˆ‘ä»¬ç»Ÿä¸€å°†ç§æœ‰Go Moduleæ”¾åœ¨mycompany.com/goä¸‹é¢çš„ä»£ç ä»“åº“ä¸­ã€‚</p><p>é‚£ä¹ˆï¼Œæ¥ä¸‹æ¥çš„é—®é¢˜å°±æ˜¯ï¼Œå½“goproxyå»æ‹‰å–mycompany.com/go/module1æ—¶ï¼Œåº”è¯¥å¾—åˆ°mycompany.com/go/module1å¯¹åº”çš„å†…éƒ¨vcsä¸Šmodule1 ä»“åº“çš„åœ°å€ï¼Œè¿™æ ·ï¼Œgoproxyæ‰èƒ½ä»å†…éƒ¨vcsä»£ç æœåŠ¡å™¨ä¸Šä¸‹è½½module1å¯¹åº”çš„ä»£ç ï¼Œå…·ä½“çš„è¿‡ç¨‹å¦‚ä¸‹ï¼š</p><p><img src=\"https://static001.geekbang.org/resource/image/1f/20/1f6fd2d693f78c77e60f118cf081c020.jpg?wh=1980x1080\" alt=\"\"></p><p>é‚£ä¹ˆæˆ‘ä»¬å¦‚ä½•å®ç°ä¸ºç§æœ‰moduleè‡ªå®šä¹‰åŒ…å¯¼å…¥è·¯å¾„ï¼Œå¹¶å°†å®ƒæ˜ å°„åˆ°å†…éƒ¨çš„vcsä»“åº“å‘¢ï¼Ÿ</p><p>å…¶å®æ–¹æ¡ˆä¸æ­¢ä¸€ç§ï¼Œè¿™é‡Œæˆ‘ä½¿ç”¨äº†Googleäº‘å¼€æºçš„ä¸€ä¸ªåä¸º<a href=\"https://github.com/GoogleCloudPlatform/govanityurls\">govanityurls</a>çš„å·¥å…·ï¼Œæ¥ä¸ºç§æœ‰moduleè‡ªå®šä¹‰åŒ…å¯¼å…¥è·¯å¾„ã€‚ç„¶åï¼Œç»“åˆgovanityurlså’Œnginxï¼Œæˆ‘ä»¬å°±å¯ä»¥å°†ç§æœ‰Go Moduleçš„å¯¼å…¥è·¯å¾„æ˜ å°„ä¸ºå…¶åœ¨vcsä¸Šçš„ä»£ç ä»“åº“çš„çœŸå®åœ°å€ã€‚å…·ä½“åŸç†ä½ å¯ä»¥çœ‹ä¸€ä¸‹è¿™å¼ å›¾ï¼š</p><p><img src=\"https://static001.geekbang.org/resource/image/b0/bd/b0eb4b4d2785d8f1a3af78b76e2b5dbd.jpg?wh=1980x1080\" alt=\"\"></p><p>é¦–å…ˆï¼Œgoproxyè¦æƒ³ä¸æŠŠæ”¶åˆ°çš„æ‹‰å–ç§æœ‰Go Moduleï¼ˆmycompany.com/go/module1ï¼‰çš„è¯·æ±‚è½¬å‘ç»™å…¬å…±ä»£ç†ï¼Œéœ€è¦åœ¨å…¶å¯åŠ¨å‚æ•°ä¸Šåšä¸€äº›æ‰‹è„šï¼Œæ¯”å¦‚ä¸‹é¢è¿™ä¸ªå°±æ˜¯ä¿®æ”¹åçš„goproxyå¯åŠ¨å‘½ä»¤ï¼š</p><pre><code class=\"language-plain\">$./goproxy -listen=0.0.0.0:8081 -cacheDir=/root/.bin/goproxy/goproxy/bin/cache -proxy https://goproxy.io -exclude \"mycompany.com/go\"\n</code></pre><p>è¿™æ ·ï¼Œå‡¡æ˜¯ä¸-excludeåé¢çš„å€¼åŒ¹é…çš„Go Moduleæ‹‰å–è¯·æ±‚ï¼Œgoproxyéƒ½ä¸ä¼šè½¬ç»™goproxy.ioï¼Œè€Œæ˜¯ç›´æ¥è¯·æ±‚Go Moduleçš„â€œæºç«™â€ã€‚</p><p>è€Œä¸Šé¢è¿™å¼ å›¾ä¸­è¦åšçš„ï¼Œå°±æ˜¯å°†è¿™ä¸ªâ€œæºç«™â€çš„åœ°å€ï¼Œè½¬æ¢ä¸ºä¼ä¸šå†…éƒ¨vcsæœåŠ¡ä¸­çš„ä¸€ä¸ªä»“åº“åœ°å€ã€‚ç„¶åæˆ‘ä»¬å‡è®¾mycompany.comè¿™ä¸ªåŸŸåå¹¶ä¸å­˜åœ¨ï¼ˆå¾ˆå¤šå°å…¬å¸æ²¡æœ‰å†…éƒ¨åŸŸåè§£æèƒ½åŠ›ï¼‰ï¼Œä»å›¾ä¸­æˆ‘ä»¬å¯ä»¥çœ‹åˆ°ï¼Œæˆ‘ä»¬ä¼šåœ¨goproxyæ‰€åœ¨èŠ‚ç‚¹çš„/etc/hostsä¸­åŠ ä¸Šè¿™æ ·ä¸€æ¡è®°å½•ï¼š</p><pre><code class=\"language-plain\">127.0.0.1 mycompany.com\n</code></pre><p>è¿™æ ·åšäº†åï¼Œgoproxyå‘å‡ºçš„åˆ°mycompany.comçš„è¯·æ±‚å®é™…ä¸Šæ˜¯å‘å‘äº†æœ¬æœºã€‚è€Œä¸Šé¢è¿™å›¾ä¸­æ˜¾ç¤ºï¼Œç›‘å¬æœ¬æœº80ç«¯å£çš„æ­£æ˜¯nginxï¼Œnginxå…³äºmycompany.comè¿™ä¸€ä¸»æœºçš„é…ç½®å¦‚ä¸‹ï¼š</p><pre><code class=\"language-plain\">// /etc/nginx/conf.d/gomodule.conf\n\nserver {\n        listen 80;\n        server_name mycompany.com;\n\n        location /go {\n                proxy_pass http://127.0.0.1:8080;\n                proxy_redirect off;\n                proxy_set_header Host $host;\n                proxy_set_header X-Real-IP $remote_addr;\n                proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;\n\n                proxy_http_version 1.1;\n                proxy_set_header Upgrade $http_upgrade;\n                proxy_set_header Connection \"upgrade\";\n        }\n}\n</code></pre><p>æˆ‘ä»¬çœ‹åˆ°ï¼Œå¯¹äºè·¯å¾„ä¸ºmycompany.com/go/xxxçš„è¯·æ±‚ï¼Œnginxå°†è¯·æ±‚è½¬å‘ç»™äº†127.0.0.1:8080ï¼Œè€Œè¿™ä¸ªæœåŠ¡åœ°å€æ°æ°å°±æ˜¯govanityurlså·¥å…·ç›‘å¬çš„åœ°å€ã€‚</p><p>govanityurlsè¿™ä¸ªå·¥å…·ï¼Œæ˜¯å‰Goæ ¸å¿ƒå¼€å‘å›¢é˜Ÿæˆå‘˜<a href=\"https://rakyll.org\">Jaana B.Dogan</a>å¼€æºçš„ä¸€ä¸ªå·¥å…·ï¼Œè¿™ä¸ªå·¥å…·å¯ä»¥å¸®åŠ©Gopherå¿«é€Ÿå®ç°è‡ªå®šä¹‰GoåŒ…çš„go getå¯¼å…¥è·¯å¾„ã€‚</p><p>govanityurlsæœ¬èº«ï¼Œå°±å¥½æ¯”ä¸€ä¸ªâ€œå¯¼èˆªâ€æœåŠ¡å™¨ã€‚å½“goå‘½ä»¤å‘è‡ªå®šä¹‰åŒ…åœ°å€å‘èµ·è¯·æ±‚æ—¶ï¼Œå®é™…ä¸Šæ˜¯å°†è¯·æ±‚å‘é€ç»™äº†govanityurlsæœåŠ¡ï¼Œä¹‹åï¼Œgovanityurlsä¼šå°†è¯·æ±‚ä¸­çš„åŒ…æ‰€åœ¨ä»“åº“çš„çœŸå®åœ°å€ï¼ˆä»vanity.yamlé…ç½®æ–‡ä»¶ä¸­è¯»å–ï¼‰è¿”å›ç»™goå‘½ä»¤ï¼Œåç»­goå‘½ä»¤å†ä»çœŸå®çš„ä»“åº“åœ°å€è·å–åŒ…æ•°æ®ã€‚</p><blockquote>\n<p>æ³¨ï¼šgovanityurlsçš„å®‰è£…æ–¹æ³•å¾ˆç®€å•ï¼Œç›´æ¥go install/go get github.com/GoogleCloudPlatform/govanityurlså°±å¯ä»¥äº†ã€‚<br>\nåœ¨æˆ‘ä»¬çš„ç¤ºä¾‹ä¸­ï¼Œvanity.yamlçš„é…ç½®å¦‚ä¸‹ï¼š</p>\n</blockquote><pre><code class=\"language-plain\">host: mycompany.com\n\npaths:\n  /go/module1:\n      repo: ssh://admin@10.10.30.30/module1\n      vcs: git\n</code></pre><p>ä¹Ÿå°±æ˜¯è¯´ï¼Œå½“govanityurlsæ”¶åˆ°nginxè½¬å‘çš„è¯·æ±‚åï¼Œä¼šå°†è¯·æ±‚ä¸vanity.yamlä¸­é…ç½®çš„moduleè·¯å¾„ç›¸åŒ¹é…ï¼Œå¦‚æœåŒ¹é…okï¼Œå°±ä¼šå°†è¯¥moduleçš„çœŸå®repoåœ°å€ï¼Œé€šè¿‡goå‘½ä»¤æœŸæœ›çš„åº”ç­”æ ¼å¼è¿”å›ã€‚åœ¨è¿™é‡Œæˆ‘ä»¬çœ‹åˆ°ï¼Œmodule1å¯¹åº”çš„çœŸå®vcsä¸Šçš„ä»“åº“åœ°å€ä¸ºï¼šssh://admin@10.10.30.30/module1ã€‚</p><p>æ‰€ä»¥ï¼Œgoproxyä¼šæ”¶åˆ°è¿™ä¸ªåœ°å€ï¼Œå¹¶å†æ¬¡å‘è¿™ä¸ªçœŸå®åœ°å€å‘èµ·è¯·æ±‚ï¼Œå¹¶æœ€ç»ˆå°†module1ç¼“å­˜åˆ°æœ¬åœ°cacheå¹¶è¿”å›ç»™å®¢æˆ·ç«¯ã€‚</p><h3>å¼€å‘æœº(å®¢æˆ·ç«¯)çš„è®¾ç½®</h3><p>å‰é¢ç¤ºä¾‹ä¸­ï¼Œæˆ‘ä»¬å·²ç»å°†å¼€å‘æœºçš„GOPROXYç¯å¢ƒå˜é‡ï¼Œè®¾ç½®ä¸ºgoproxyçš„æœåŠ¡åœ°å€ã€‚ä½†æˆ‘ä»¬è¯´è¿‡ï¼Œå‡¡æ˜¯é€šè¿‡GOPROXYæ‹‰å–çš„Go Moduleï¼Œgoå‘½ä»¤éƒ½ä¼šé»˜è®¤æŠŠå®ƒçš„sumå€¼æ”¾åˆ°å…¬å…±GOSUMæœåŠ¡å™¨ä¸Šå»æ ¡éªŒã€‚</p><p>ä½†æˆ‘ä»¬å®è´¨ä¸Šæ‹‰å–çš„æ˜¯ç§æœ‰Go Moduleï¼ŒGOSUMæœåŠ¡å™¨ä¸Šå¹¶æ²¡æœ‰æˆ‘ä»¬çš„Go Moduleçš„sumæ•°æ®ã€‚è¿™æ ·å°±ä¼šå¯¼è‡´go buildå‘½ä»¤æŠ¥é”™ï¼Œæ— æ³•ç»§ç»­æ„å»ºè¿‡ç¨‹ã€‚</p><p>å› æ­¤ï¼Œå¼€å‘æœºå®¢æˆ·ç«¯è¿˜éœ€è¦å°†mycompany.com/goï¼Œä½œä¸ºä¸€ä¸ªå€¼è®¾ç½®åˆ°GONOSUMDBç¯å¢ƒå˜é‡ä¸­ï¼š</p><pre><code class=\"language-plain\">export GONOSUMDB=mycompany.com/go\n</code></pre><p>è¿™ä¸ªç¯å¢ƒå˜é‡é…ç½®ä¸€æ—¦ç”Ÿæ•ˆï¼Œå°±ç›¸å½“äºå‘Šè¯‰goå‘½ä»¤ï¼Œå‡¡æ˜¯ä¸mycompany.com/goåŒ¹é…çš„Go Moduleï¼Œéƒ½ä¸éœ€è¦åœ¨åšsumæ ¡éªŒäº†ã€‚</p><p>åˆ°è¿™é‡Œï¼Œæˆ‘ä»¬å°±å®ç°äº†æ‹‰å–ç§æœ‰Go Moduleçš„æ–¹æ¡ˆã€‚</p><h3>æ–¹æ¡ˆçš„â€œä¸è¶³â€</h3><p>å½“ç„¶è¿™ä¸ªæ–¹æ¡ˆå¹¶ä¸æ˜¯å®Œç¾çš„ï¼Œå®ƒä¹Ÿæœ‰è‡ªå·±çš„ä¸è¶³çš„åœ°æ–¹ï¼š</p><p><strong>ç¬¬ä¸€ç‚¹ï¼šå¼€å‘è€…è¿˜æ˜¯éœ€è¦é¢å¤–é…ç½®GONOSUMDBå˜é‡ã€‚</strong></p><p>ç”±äºGoå‘½ä»¤é»˜è®¤ä¼šå¯¹ä»GOPROXYæ‹‰å–çš„Go Moduleè¿›è¡Œsumæ ¡éªŒï¼Œå› æ­¤æˆ‘ä»¬éœ€è¦å°†ç§æœ‰Go Moduleé…ç½®åˆ°GONOSUMDBç¯å¢ƒå˜é‡ä¸­ï¼Œè¿™å°±ç»™å¼€å‘è€…å¸¦æ¥äº†ä¸€ä¸ªå°å°çš„â€œè´Ÿæ‹…â€ã€‚</p><p>å¯¹äºè¿™ä¸ªé—®é¢˜ï¼Œæˆ‘çš„è§£å†³å»ºè®®æ˜¯ï¼šå…¬å¸å†…éƒ¨å¯ä»¥å°†ç§æœ‰goé¡¹ç›®éƒ½æ”¾åœ¨ä¸€ä¸ªç‰¹å®šåŸŸåä¸‹ï¼Œè¿™æ ·å°±ä¸éœ€è¦ä¸ºæ¯ä¸ªgoç§æœ‰é¡¹ç›®å•ç‹¬å¢åŠ GONOSUMDBé…ç½®äº†ï¼Œåªéœ€è¦é…ç½®ä¸€æ¬¡å°±å¯ä»¥äº†ã€‚</p><p><strong>ç¬¬äºŒç‚¹ï¼šæ–°å¢ç§æœ‰Go Moduleï¼Œvanity.yamléœ€è¦æ‰‹å·¥åŒæ­¥æ›´æ–°ã€‚</strong></p><p>è¿™æ˜¯è¿™ä¸ªæ–¹æ¡ˆæœ€ä¸çµæ´»çš„åœ°æ–¹äº†ï¼Œç”±äºç›®å‰govanityurlsåŠŸèƒ½æœ‰é™ï¼Œé’ˆå¯¹æ¯ä¸ªç§æœ‰Go Moduleï¼Œæˆ‘ä»¬å¯èƒ½éƒ½éœ€è¦å•ç‹¬é…ç½®å®ƒå¯¹åº”çš„vcsä»“åº“åœ°å€ï¼Œä»¥åŠè·å–æ–¹å¼ï¼ˆgitã€svn or hgï¼‰ã€‚</p><p>å…³äºè¿™ä¸€ç‚¹ï¼Œæˆ‘çš„å»ºè®®æ˜¯ï¼šåœ¨ä¸€ä¸ªvcsä»“åº“ä¸­ç®¡ç†å¤šä¸ªç§æœ‰Go Moduleã€‚ç›¸æ¯”äºæœ€åˆgoå®˜æ–¹å»ºè®®çš„ä¸€ä¸ªrepoåªç®¡ç†ä¸€ä¸ªmoduleï¼Œæ–°ç‰ˆæœ¬çš„goåœ¨<a href=\"https://go.dev/doc/modules/managing-source#multiple-module-source\">ä¸€ä¸ªrepoä¸‹ç®¡ç†å¤šä¸ªGo Module</a>æ–¹é¢ï¼Œå·²ç»æœ‰äº†é•¿è¶³çš„è¿›æ­¥ï¼Œæˆ‘ä»¬å·²ç»å¯ä»¥é€šè¿‡repoçš„tagæ¥åŒºåˆ«åŒä¸€ä¸ªrepoä¸‹çš„ä¸åŒGo Moduleã€‚</p><p>ä¸è¿‡å¯¹äºä¸€ä¸ªå…¬å¸æˆ–ç»„ç»‡æ¥è¯´ï¼Œè¿™ç‚¹é¢å¤–å·¥ä½œä¸å¾—åˆ°çš„æ”¶ç›Šç›¸æ¯”ï¼Œåº”è¯¥ä¹Ÿä¸ç®—ä»€ä¹ˆï¼</p><p><strong>ç¬¬ä¸‰ç‚¹ï¼šæ— æ³•åˆ’åˆ†æƒé™ã€‚</strong></p><p>åœ¨è®²è§£ä¸Šé¢çš„æ–¹æ¡ˆçš„æ—¶å€™æˆ‘ä»¬ä¹Ÿæåˆ°è¿‡ï¼Œgoproxyæ‰€åœ¨èŠ‚ç‚¹éœ€è¦å…·å¤‡è®¿é—®æ‰€æœ‰ç§æœ‰Go Moduleæ‰€åœ¨vcs repoçš„æƒé™ï¼Œä½†åˆæ— æ³•å¯¹goå¼€å‘è€…ç«¯åšå‡ºæœ‰å·®åˆ«æˆæƒï¼Œè¿™æ ·ï¼Œåªè¦æ˜¯goproxyèƒ½æ‹‰å–åˆ°çš„ç§æœ‰Go Moduleï¼Œgoå¼€å‘è€…éƒ½èƒ½æ‹‰å–åˆ°ã€‚</p><p>ä¸è¿‡å¯¹äºå¤šæ•°å…¬å¸è€Œè¨€ï¼Œå†…éƒ¨æ‰€æœ‰æºç åŸåˆ™ä¸Šéƒ½æ˜¯ä¼ä¸šå†…éƒ¨å…¬å¼€çš„ï¼Œè¿™ä¸ªé—®é¢˜ä¼¼ä¹ä¹Ÿä¸å¤§ã€‚å¦‚æœè§‰å¾—è¿™æ˜¯ä¸ªé—®é¢˜ï¼Œé‚£ä¹ˆåªèƒ½ä½¿ç”¨å‰é¢æåˆ°çš„ç¬¬ä¸€ä¸ªæ–¹æ¡ˆï¼Œä¹Ÿå°±æ˜¯ç›´è¿ç§æœ‰Go Moduleçš„æºç æœåŠ¡å™¨çš„æ–¹æ¡ˆäº†ã€‚</p><h2>å°ç»“</h2><p>å¥½äº†ï¼Œä»Šå¤©çš„åŠ é¤è®²åˆ°è¿™é‡Œå°±ç»“æŸäº†ã€‚ä»Šå¤©æˆ‘ä»¬é’ˆå¯¹å‰æœŸä¸“æ åé¦ˆè¾ƒå¤šçš„æœ‰å…³Go Moduleçš„ä¸¤ä¸ªé—®é¢˜ï¼Œè¿›è¡Œäº†é€ä¸€åˆ†æï¼Œç»™å‡ºäº†å„è‡ªçš„å¯è¡Œçš„æ–¹æ¡ˆã€‚</p><p>é’ˆå¯¹å¯¼å…¥æœ¬åœ°Go Moduleçš„é—®é¢˜ï¼Œåœ¨Go 1.18ç‰ˆæœ¬æœªå‘å¸ƒä¹‹å‰ï¼Œæœ€å¥½çš„æ–¹æ³•å°±æ˜¯ä½¿ç”¨replaceâ€œå¤§æ³•â€ï¼Œé€šè¿‡â€œä¼ªé€ â€çš„go.modè®©goå‘½ä»¤ä¼˜å…ˆä½¿ç”¨é¡¹ç›®ä¾èµ–çš„Go Moduleçš„æœ¬åœ°ç‰ˆæœ¬ã€‚ä¸è¿‡è¿™ä¸ªæ–¹æ¡ˆï¼Œä¹Ÿä¼šç»™å¼€å‘äººå‘˜åä½œæ–¹é¢å¸¦å»ä¸€äº›é¢å¤–è´Ÿæ‹…ï¼Œè¦æƒ³å®Œç¾è§£å†³è¿™ä¸€é—®é¢˜ï¼Œè¿˜éœ€è¦ç­‰å¾…åŠ å…¥äº†Goå·¥ä½œåŒºæœºåˆ¶çš„Go 1.18ç‰ˆæœ¬ã€‚</p><p>æ— è®ºå¤§å‚å°å‚ï¼Œå¯¹Goçš„ä½¿ç”¨é€æ¸æ·±å…¥ï¼Œæ¥çº³Goçš„äººä»¥åŠGoé¡¹ç›®é€æ¸å¢å¤šåï¼Œæ‹‰å–ç§æœ‰Go Moduleè¿™æ ·çš„é—®é¢˜è‚¯å®šä¼šæ‘†åˆ°æ¡Œé¢ä¸Šæ¥ã€‚è¿™ä¸€è®²æˆ‘ä»¬ä»‹ç»äº†ç›´è¿ç§æœ‰Go Moduleæºç æœåŠ¡å™¨å’Œä½¿ç”¨ç»Ÿä¸€GOPROXYä»£ç†ä¸¤ç§æ–¹æ¡ˆï¼Œæˆ‘æ¨èä½ ä½¿ç”¨ç¬¬äºŒç§æ–¹æ¡ˆï¼Œå¯ä»¥é™ä½å¼€å‘äººå‘˜æ‹‰å–ç§æœ‰moduleçš„å¿ƒæ™ºè´Ÿæ‹…ã€‚</p><h2>æ€è€ƒé¢˜</h2><p>é’ˆå¯¹æˆ‘ä»¬è¿™ä¸€è®²æåˆ°çš„ä¸¤ä¸ªé—®é¢˜ï¼Œä½ æ˜¯å¦æœ‰è‡ªå·±çš„ä¸åŒçš„è§£å†³æ–¹æ¡ˆå‘¢ï¼Ÿå¦‚æœæœ‰ï¼Œæ¬¢è¿åœ¨ç•™è¨€åŒºåˆ†äº«ä¸€ä¸‹ä½ é‡‡ç”¨çš„æ–¹æ¡ˆã€‚</p><p>æ¬¢è¿æŠŠè¿™ä¸€èŠ‚è¯¾åˆ†äº«ç»™æ›´å¤šæ„Ÿå…´è¶£çš„æœ‹å‹ã€‚æˆ‘æ˜¯Tony Baiï¼Œæˆ‘ä»¬ä¸‹èŠ‚è¯¾è§ã€‚</p>","neighbors":{"left":{"article_title":"åŠ é¤ï½œèŠèŠGo 1.17ç‰ˆæœ¬çš„é‚£äº›æ–°ç‰¹æ€§","id":469274},"right":{"article_title":"åŠ é¤ï½œä½œä¸ºGo Moduleçš„ä½œè€…ï¼Œä½ åº”è¯¥çŸ¥é“çš„å‡ ä»¶äº‹","id":484604}},"comments":[{"had_liked":false,"id":331680,"user_name":"ç½—æ°","can_delete":false,"product_type":"c1","uid":1320487,"ip_address":"","ucode":"96BAFAA147341F","user_header":"https://static001.geekbang.org/account/avatar/00/14/26/27/eba94899.jpg","comment_is_top":false,"comment_ctime":1642721739,"is_pvip":false,"replies":[{"id":"121274","content":"è¿™å—çš„ç¡®ç»™gopherä»¬å¸¦æ¥ä¸å°‘â€œå›°æ‰°â€ã€‚","user_name":"ä½œè€…å›å¤","comment_id":331680,"uid":"1026224","ip_address":"","utype":1,"ctime":1642914498,"user_name_real":"ç¼–è¾‘"}],"discussion_count":1,"race_medal":2,"score":"18822590923","product_id":100093501,"comment_content":"ä¸€ç›´ä½¿ç”¨çš„éƒ½æ˜¯ replaceï¼Œè¿˜å¥½æˆ‘ä»¬çš„ä»£ç ä¸æ˜¯å¤ªå¤šï¼Œäººå‘˜ä¹Ÿå°‘ï¼Œè¿˜æ²¡æœ‰è‡ªå·±é€ å‡ºæ¯”è¾ƒå¥½ç”¨çš„è½®å­ï¼Œæ‰€ä»¥ replace çš„éƒ½æ˜¯æœ¬ä»“åº“å†…çš„ä»£ç ï¼Œä»“åº“å†…åŒ…å«å…¬å…±åº“å’ŒæœåŠ¡ã€‚æœŸå¾… 1.18 èƒ½å°½å¯èƒ½é™ä½å¼€å‘è€…çš„å¿ƒæ™ºè´Ÿæ‹…ï¼Œreplace æˆ‘åˆšå¼€å§‹ç”¨çš„æ—¶å€™ï¼Œç†è§£èµ·æ¥è¿˜æ˜¯éå¸¸è´¹åŠ²çš„ã€‚è™½ç„¶æ¯” gopath å¥½äº†ä¸å°‘ï¼Œä½†æ˜¯ go åœ¨å¼•åŒ…çš„è¿™ä¸€å—ç›¸æ¯”ç®€å•å“²å­¦è¿˜æ˜¯ä¸å¤Ÿå‹å¥½ã€‚","like_count":4,"discussions":[{"author":{"id":1026224,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/a8/b0/6f87ab08.jpg","nickname":"Tony Bai","note":"","ucode":"B6B08985F6FA89","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":547860,"discussion_content":"è¿™å—çš„ç¡®ç»™gopherä»¬å¸¦æ¥ä¸å°‘â€œå›°æ‰°â€ã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1642914498,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":332771,"user_name":"lesserror","can_delete":false,"product_type":"c1","uid":1351076,"ip_address":"","ucode":"25A54D1165FCF6","user_header":"https://static001.geekbang.org/account/avatar/00/14/9d/a4/e481ae48.jpg","comment_is_top":false,"comment_ctime":1643593063,"is_pvip":false,"replies":[{"id":"121642","content":"æ„Ÿè°¢é•¿æœŸä»¥æ¥çš„æ”¯æŒã€‚ä»ä¸“æ çš„ç•™è¨€æƒ…å†µæ¥çœ‹ï¼Œä½ ä¹Ÿæ˜¯æ•´ä¸ªä¸“æ å­¦ä¹ æœ€è®¤çœŸçš„ç«¥é‹äº†ï¼Œå¥½åƒä¹Ÿæ²¡æœ‰ä¹‹ä¸€:)ã€‚<br>1. GOPRIVATE=corporate1.com&#47;repo1&#47;module1, corporate2.com&#47;repo2&#47;module2ï¼Œä¸€ä¸ªé€—å·åˆ†éš”çš„moduleå‰ç¼€åˆ—è¡¨ï¼Œå…·ä½“å¯ä»¥çœ‹ä¸€ä¸‹ https:&#47;&#47;go.dev&#47;ref&#47;mod<br>2. 10.10.20.20æ˜¯ä¸¾ä¾‹ä¸­çš„å†…ç½‘ æœåŠ¡å™¨åœ°å€ï¼Œæ ¹æ®ç¯å¢ƒè‡ªè¡Œè®¾å®šã€‚è‡³äºä½ é‡åˆ°çš„é”™è¯¯ï¼Œä½ çœ‹çœ‹è®¾ç½®çš„GOPROXXYç¯å¢ƒå˜é‡æ˜¯å¦okï¼Ÿæ˜¯å¦è®¾ç½®åˆ°ä½ æœ¬åœ°goproxyæœåŠ¡æ‰€ç›‘å¬çš„ç«¯å£äº†ï¼Ÿå¦å¤–ä½ çš„æœºå™¨è®¿é—®goproxy.ioæ˜¯å¦æ˜¯okçš„ï¼Ÿ<br>3. gerritæ˜¯googleå¼€æºçš„ä»£ç reviewå·¥å…·ï¼Œå¯ä¸git serveré›†æˆï¼Œè¿™é‡Œä½ å°±æŠŠå®ƒå½“åšä¸€ä¸ªæ™®é€šçš„git serverå°±è¡Œäº†ã€‚","user_name":"ä½œè€…å›å¤","comment_id":332771,"uid":"1026224","ip_address":"","utype":1,"ctime":1643688890,"user_name_real":"ç¼–è¾‘"}],"discussion_count":1,"race_medal":0,"score":"5938560359","product_id":100093501,"comment_content":"å¤§ç™½è€å¸ˆçš„æ¯ç¯‡æ–‡ç« ï¼Œæˆ‘éƒ½ä¼šè®¤çœŸç ”è¯»å‡ éã€‚è¿™ä¸ªä¸“æ ä¸‹æ¥ï¼Œè‡ªå·±è®¤ä¸ºå¯¹Goæœ‰äº†å…¨é¢çš„è®¤è¯†ã€‚æœ‰å‡ ä¸ªå°é—®é¢˜ï¼Œè¿˜è¯·è§£ç­”ã€‚<br><br>1. æ–‡ä¸­ï¼šexport GOPRIVATE = {private module list}ï¼Œâ€œprivate module listâ€ è¿™é‡Œçš„é…ç½®å¤§æ¦‚æ˜¯ä»€ä¹ˆæ ·å­çš„å‘¢ï¼Ÿ<br><br>2. è€å¸ˆï¼Œå®‰è£…goproxyè¿™é‡Œï¼Œè¿™ä¸ªåœ°å€ï¼šhttp:&#47;&#47;10.10.20.20:8081 æ˜¯ä¸æ˜¯ç›¸å½“äºè‡ªå·±æ­å»ºçš„å†…ç½‘ æœåŠ¡å™¨åœ°å€ï¼Œæ¯ä¸ªäººçš„éƒ½å¯èƒ½ä¸åŒï¼Ÿ æˆ‘ç”¨æœ¬åœ° 127.0.0.1åœ°å€æ¥å®‰è£…æµ‹è¯•ï¼Œå‡ºç°äº†è¿™ä¸ªé”™è¯¯ï¼šgoproxy.io: http: proxy error: dial tcp: lookup goproxy.iogoproxy.io: no such host &#47; goproxy.io: 0.460s 502 &#47;github.com&#47;pkg&#47;errors&#47;@v&#47;list<br><br>3. ç»Ÿä¸€ Goproxy æ–¹æ¡ˆçš„å®ç°æ‹“æ‰‘å›¾ä¸­çš„ gerrit git æœåŠ¡å™¨ï¼ˆ10.10.30.30ï¼‰è¿™é‡Œçš„ â€œgerritâ€ ä»£è¡¨ä»€ä¹ˆæ„æ€å‘¢ï¼Ÿ","like_count":1,"discussions":[{"author":{"id":1026224,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/a8/b0/6f87ab08.jpg","nickname":"Tony Bai","note":"","ucode":"B6B08985F6FA89","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":549174,"discussion_content":"æ„Ÿè°¢é•¿æœŸä»¥æ¥çš„æ”¯æŒã€‚ä»ä¸“æ çš„ç•™è¨€æƒ…å†µæ¥çœ‹ï¼Œä½ ä¹Ÿæ˜¯æ•´ä¸ªä¸“æ å­¦ä¹ æœ€è®¤çœŸçš„ç«¥é‹äº†ï¼Œå¥½åƒä¹Ÿæ²¡æœ‰ä¹‹ä¸€:)ã€‚\n1. GOPRIVATE=corporate1.com/repo1/module1, corporate2.com/repo2/module2ï¼Œä¸€ä¸ªé€—å·åˆ†éš”çš„moduleå‰ç¼€åˆ—è¡¨ï¼Œå…·ä½“å¯ä»¥çœ‹ä¸€ä¸‹ https://go.dev/ref/mod\n2. 10.10.20.20æ˜¯ä¸¾ä¾‹ä¸­çš„å†…ç½‘ æœåŠ¡å™¨åœ°å€ï¼Œæ ¹æ®ç¯å¢ƒè‡ªè¡Œè®¾å®šã€‚è‡³äºä½ é‡åˆ°çš„é”™è¯¯ï¼Œä½ çœ‹çœ‹è®¾ç½®çš„GOPROXXYç¯å¢ƒå˜é‡æ˜¯å¦okï¼Ÿæ˜¯å¦è®¾ç½®åˆ°ä½ æœ¬åœ°goproxyæœåŠ¡æ‰€ç›‘å¬çš„ç«¯å£äº†ï¼Ÿå¦å¤–ä½ çš„æœºå™¨è®¿é—®goproxy.ioæ˜¯å¦æ˜¯okçš„ï¼Ÿ\n3. gerritæ˜¯googleå¼€æºçš„ä»£ç reviewå·¥å…·ï¼Œå¯ä¸git serveré›†æˆï¼Œè¿™é‡Œä½ å°±æŠŠå®ƒå½“åšä¸€ä¸ªæ™®é€šçš„git serverå°±è¡Œäº†ã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1643688890,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":331672,"user_name":"å“ˆå“ˆå“ˆå“ˆå“ˆ","can_delete":false,"product_type":"c1","uid":2828322,"ip_address":"","ucode":"0350A8A8A3DD74","user_header":"https://static001.geekbang.org/account/avatar/00/2b/28/22/ebc770dc.jpg","comment_is_top":false,"comment_ctime":1642697413,"is_pvip":false,"replies":[{"id":"121600","content":"ğŸ‘","user_name":"ä½œè€…å›å¤","comment_id":331672,"uid":"1026224","ip_address":"","utype":1,"ctime":1643537105,"user_name_real":"ç¼–è¾‘"}],"discussion_count":1,"race_medal":0,"score":"5937664709","product_id":100093501,"comment_content":"å¥½è€¶%*%","like_count":1,"discussions":[{"author":{"id":1026224,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/a8/b0/6f87ab08.jpg","nickname":"Tony Bai","note":"","ucode":"B6B08985F6FA89","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":549058,"discussion_content":"ğŸ‘","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1643537105,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":355221,"user_name":"å¤©å¤©å‘ä¸Š","can_delete":false,"product_type":"c1","uid":1282639,"ip_address":"åŒ—äº¬","ucode":"D0914D4FD82272","user_header":"https://static001.geekbang.org/account/avatar/00/13/92/4f/ff04156a.jpg","comment_is_top":false,"comment_ctime":1661181488,"is_pvip":true,"replies":[{"id":"129277","content":"ğŸ‘","user_name":"ä½œè€…å›å¤","comment_id":355221,"uid":"1026224","ip_address":"åŒ—äº¬","utype":1,"ctime":1661304513,"user_name_real":"ç¼–è¾‘"}],"discussion_count":1,"race_medal":0,"score":"1661181488","product_id":100093501,"comment_content":"å†…éƒ¨é‡‡ç”¨äº†æ–¹æ¡ˆäºŒï¼ŒGitlabæ‰˜ç®¡çš„å…¬å…±åº“","like_count":0,"discussions":[{"author":{"id":1026224,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/a8/b0/6f87ab08.jpg","nickname":"Tony Bai","note":"","ucode":"B6B08985F6FA89","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":585038,"discussion_content":"ğŸ‘","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1661304513,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"åŒ—äº¬"},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":348856,"user_name":"é”‹å­","can_delete":false,"product_type":"c1","uid":1681459,"ip_address":"","ucode":"89FFA85BDB1C99","user_header":"https://static001.geekbang.org/account/avatar/00/19/a8/33/b71635c1.jpg","comment_is_top":false,"comment_ctime":1655466511,"is_pvip":false,"replies":[{"id":"127026","content":"å¦‚ä½ æåˆ°çš„ï¼Œå¦‚æœè¦å¼•ç”¨moduleBï¼Œé‚£ä¹ˆå°±åº”è¯¥ä½¿ç”¨moduleBçš„go.modä¸­çš„module pathã€‚","user_name":"ä½œè€…å›å¤","comment_id":348856,"uid":"1026224","ip_address":"","utype":1,"ctime":1655702990,"user_name_real":"ç¼–è¾‘"}],"discussion_count":1,"race_medal":0,"score":"1655466511","product_id":100093501,"comment_content":"å¥½åƒæ‡‚äº†ï¼Œåˆå¥½åƒæ²¡æ‡‚ã€‚ å¯¹äºgo.modçš„moduleåå­—æœ‰å•¥æ„ä¹‰ä¸ï¼Ÿ æ˜¯å¦å¯ä»¥éšä¾¿å–ï¼Œè¿˜æ˜¯ä¼šå½±å“ä»€ä¹ˆï¼Ÿ æ¯”å¦‚æˆ‘è¦å¼•ç”¨çš„moduleBï¼Œé‚£è¿™ä¸ªmoduleBæ˜¯åœ¨å“ªé‡Œå®šä¹‰çš„ï¼Ÿ æ˜¯moduleBçš„go.modé‡Œé…çš„åå­—è¿˜æ˜¯è·¯å¾„åå­—ï¼Ÿ ","like_count":0,"discussions":[{"author":{"id":1026224,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/a8/b0/6f87ab08.jpg","nickname":"Tony Bai","note":"","ucode":"B6B08985F6FA89","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":576611,"discussion_content":"å¦‚ä½ æåˆ°çš„ï¼Œå¦‚æœè¦å¼•ç”¨moduleBï¼Œé‚£ä¹ˆå°±åº”è¯¥ä½¿ç”¨moduleBçš„go.modä¸­çš„module pathã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1655702991,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":347410,"user_name":"ç“œç‰›","can_delete":false,"product_type":"c1","uid":2273620,"ip_address":"","ucode":"5EB7D2F4400A70","user_header":"https://static001.geekbang.org/account/avatar/00/22/b1/54/6d663b95.jpg","comment_is_top":false,"comment_ctime":1653999144,"is_pvip":false,"replies":[{"id":"126664","content":"åœ¨ä¸è€ƒè™‘goproxyçš„æƒ…å†µä¸‹ï¼Œgo getä¼šç›´æ¥å»è®¿é—®rsc.io&#47;xxxå•Šã€‚ä½†æ˜¯æ˜¾ç„¶rsc.io&#47;xxxä¸Šçš„æœåŠ¡ä¼šå°†è¯¥go moduleçš„çœŸå®åœ°å€github.com&#47;rsc&#47;xxxè¿”å›ç»™go getï¼Œgo getæ‹¿åˆ°çœŸå®åœ°å€åï¼Œä¼šç»§ç»­åˆ°çœŸå®åœ°å€ä¸Šå»è·å–go moduleã€‚<br><br>æœ¬ç¯‡åŠ é¤ä¸­çš„â€œè‡ªå®šä¹‰åŒ…å¯¼å…¥è·¯å¾„å¹¶å°†å…¶æ˜ å°„åˆ°å†…éƒ¨çš„ vcs ä»“åº“â€ä¸€èŠ‚è¯´çš„å°±æ˜¯è¿™ä¸ªäº‹æƒ…ã€‚","user_name":"ä½œè€…å›å¤","comment_id":347410,"uid":"1026224","ip_address":"","utype":1,"ctime":1654063629,"user_name_real":"ç¼–è¾‘"}],"discussion_count":2,"race_medal":0,"score":"1653999144","product_id":100093501,"comment_content":"æƒ³é—®ä¸€ä¸‹é‚£ç§égithubçš„ä»“åº“ï¼Œæ¯”å¦‚Russ Coxçš„ä¸ªäººåŸŸåï¼ˆå¥½åƒæ˜¯rsc.ioï¼Ÿï¼‰ä½œä¸ºå‰ç¼€çš„moduleæ˜¯å¦‚ä½•å®ç°çš„ï¼Œgo getçš„æœç´¢è·¯å¾„æ˜¯æ€æ ·çš„ï¼Ÿ","like_count":0,"discussions":[{"author":{"id":1026224,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/a8/b0/6f87ab08.jpg","nickname":"Tony Bai","note":"","ucode":"B6B08985F6FA89","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":574436,"discussion_content":"åœ¨ä¸è€ƒè™‘goproxyçš„æƒ…å†µä¸‹ï¼Œgo getä¼šç›´æ¥å»è®¿é—®rsc.io/xxxå•Šã€‚ä½†æ˜¯æ˜¾ç„¶rsc.io/xxxä¸Šçš„æœåŠ¡ä¼šå°†è¯¥go moduleçš„çœŸå®åœ°å€github.com/rsc/xxxè¿”å›ç»™go getï¼Œgo getæ‹¿åˆ°çœŸå®åœ°å€åï¼Œä¼šç»§ç»­åˆ°çœŸå®åœ°å€ä¸Šå»è·å–go moduleã€‚\n\næœ¬ç¯‡åŠ é¤ä¸­çš„â€œè‡ªå®šä¹‰åŒ…å¯¼å…¥è·¯å¾„å¹¶å°†å…¶æ˜ å°„åˆ°å†…éƒ¨çš„ vcs ä»“åº“â€ä¸€èŠ‚è¯´çš„å°±æ˜¯è¿™ä¸ªäº‹æƒ…ã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1654063629,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":2273620,"avatar":"https://static001.geekbang.org/account/avatar/00/22/b1/54/6d663b95.jpg","nickname":"ç“œç‰›","note":"","ucode":"5EB7D2F4400A70","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":574400,"discussion_content":"è¿˜æœ‰ä¸ªé—®é¢˜æ¯”å¦‚ä¸Šä¼ åˆ°githubï¼Œä½†æ˜¯go.modé‡Œçš„module pathè·Ÿä»“åº“githubåœ°å€ä¸ä¸€æ ·ï¼Œèƒ½è¢«æ­£å¸¸ä¸‹è½½åˆ°å—ï¼Ÿä¸€ç›´ä¸å¤ªæ˜ç™½module pathè·Ÿgithubæœ‰å•¥å…³ç³»ï¼Œçœ‹å®Œè¿™ç¯‡æ–‡ç« è¿˜æ˜¯ä¸æ˜ç™½","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1654044707,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":341059,"user_name":"å¼ ç”³å‚²","can_delete":false,"product_type":"c1","uid":1182372,"ip_address":"","ucode":"22D46BC529BA8A","user_header":"https://static001.geekbang.org/account/avatar/00/12/0a/a4/828a431f.jpg","comment_is_top":false,"comment_ctime":1649319147,"is_pvip":true,"replies":[{"id":"124698","content":"ğŸ‘","user_name":"ä½œè€…å›å¤","comment_id":341059,"uid":"1026224","ip_address":"","utype":1,"ctime":1649388929,"user_name_real":"ç¼–è¾‘"}],"discussion_count":1,"race_medal":1,"score":"1649319147","product_id":100093501,"comment_content":"å…¬å¸é‡Œæ­£å¥½ç”¨åˆ°äº†ç§æœ‰ä»“åº“çš„æ­å»ºï¼ŒäºŒåˆ·ä¸€ä¸‹ï¼Œè€å¸ˆçš„æ¯ç¯‡æ–‡ç« éƒ½æ˜¯ç²¾å“ã€‚","like_count":0,"discussions":[{"author":{"id":1026224,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/a8/b0/6f87ab08.jpg","nickname":"Tony Bai","note":"","ucode":"B6B08985F6FA89","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":560553,"discussion_content":"ğŸ‘","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1649388929,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]}]}