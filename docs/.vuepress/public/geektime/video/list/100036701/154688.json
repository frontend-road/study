{"id":154688,"title":"18 | Nettyçš„é‚£äº›â€œé”â€äº‹","content":"<p><strong>è¯¾ä»¶å’ŒDemoåœ°å€</strong><br>\n<a href=\"https://gitee.com/geektime-geekbang/geek_netty\">https://gitee.com/geektime-geekbang/geek_netty</a></p>","comments":[{"had_liked":false,"id":151472,"user_name":"Geek_cyy","can_delete":false,"product_type":"c3","uid":1561474,"ip_address":"","ucode":"5FAB0E666F4F08","user_header":"http://thirdwx.qlogo.cn/mmopen/vi_32/HZn8Cl8PFrzRNaePhfAMCtiankNG4yf9VmRukH3gzVtsOogq5n4b9ZAFNHThniaXmsibibX17wTZ8kCvKkibges8efA/132","comment_is_top":false,"comment_ctime":1573726697,"is_pvip":false,"replies":[{"id":59060,"content":"pipelineï¼šå·¥å‚çš„æµæ°´çº¿\neventloop: æ“ä½œæµæ°´çº¿å·¥åºçš„å®é™…å¹²æ´»çš„å·¥äºº\nchannel:  å¤šå¥—æµæ°´çº¿ï¼Œä¸€ä¸ªchannelé…ä¸€å¥—æµæ°´çº¿ï¼ˆpipelineï¼‰ã€‚å·¥äººï¼ˆeventloopï¼‰å…±äº«ã€‚","user_name":"ä½œè€…å›å¤","user_name_real":"Geek_9bc307","uid":1638649,"ctime":1574302662,"ip_address":"","comment_id":151472,"utype":1}],"discussion_count":1,"race_medal":0,"score":2,"product_id":100036701,"comment_content":"è€å¸ˆï¼Œé‚£pipelineï¼Œeventloopï¼Œchannelä¹‹é—´çš„å…³ç³»å‘¢ï¼Ÿ","like_count":23,"discussions":[{"author":{"id":1638649,"avatar":"https://static001.geekbang.org/account/avatar/00/19/00/f9/44a3e5bd.jpg","nickname":"å‚…å¥","note":"","ucode":"5EA8BB26F5B036","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":474486,"discussion_content":"pipelineï¼šå·¥å‚çš„æµæ°´çº¿\neventloop: æ“ä½œæµæ°´çº¿å·¥åºçš„å®é™…å¹²æ´»çš„å·¥äºº\nchannel:  å¤šå¥—æµæ°´çº¿ï¼Œä¸€ä¸ªchannelé…ä¸€å¥—æµæ°´çº¿ï¼ˆpipelineï¼‰ã€‚å·¥äººï¼ˆeventloopï¼‰å…±äº«ã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1574302662,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":156672,"user_name":"å†¬æ¸æš–","can_delete":false,"product_type":"c3","uid":1586800,"ip_address":"","ucode":"907E41AAE9A36C","user_header":"https://static001.geekbang.org/account/avatar/00/18/36/70/00122b24.jpg","comment_is_top":false,"comment_ctime":1574934019,"is_pvip":false,"replies":[{"id":60135,"content":"å“ˆå“ˆï¼Œå› ä¸ºç›´æ’­è¯´äº†ï¼Œäº‰å–ç¬¦åˆ996ï¼Œæ‰€ä»¥è®¡åˆ’9ç‚¹è¯´å®Œï¼Œæœ€åå¥½åƒ9ç‚¹05ç»“æŸäº†ï¼Œæˆ‘ä¼šæŠŠpptå‘¨æœ«é‡æ–°æ•´ç†å¥½(ç›´æ’­æ—¶çš„pptè¦æ±‚å³ä¸‹ç•™ä¸ªå¤´åƒç©ºç™½ï¼Œæ‰€ä»¥ä¸å¤ªå¥½çœ‹)ï¼Œä¸‹å‘¨æŒ‚git repoä¸Šã€‚","user_name":"ä½œè€…å›å¤","user_name_real":"å‚…å¥","uid":1638649,"ctime":1574936300,"ip_address":"","comment_id":156672,"utype":1}],"discussion_count":1,"race_medal":0,"score":2,"product_id":100036701,"comment_content":"æ‹¿volatileæ¥è¯´çº¿ç¨‹çš„åŒæ­¥æ ¸å¿ƒä¸‰è¦ç´ \nâ—å¯è§æ€§ï¼šå¯¹ä¸€ä¸ªvolatileå˜é‡çš„è¯»ï¼Œæ€»æ˜¯èƒ½çœ‹åˆ°(ä»»æ„çº¿ç¨‹)å¯¹è¿™ä¸ªvolatileå˜é‡æœ€åçš„å†™å…¥ã€‚\nâ—åŸå­æ€§ï¼šå¯¹ä»»æ„å•ä¸ªvolatileå˜é‡çš„è¯»&#47;å†™å…·æœ‰åŸå­æ€§ï¼Œä½†ç±»ä¼¼äºvolatile++è¿™ç§å¤åˆæ“ä½œä¸å…·æœ‰åŸå­æ€§(1è¯» 2åŠ  3èµ‹å€¼)ã€‚\nâ—æœ‰åºæ€§,æ˜¯ä¿è¯çº¿ç¨‹å†…ä¸²è¡Œè¯­ä¹‰ï¼Œé¿å…JVMæŒ‡ä»¤é‡æ’ç­‰ã€‚\n\né”åˆ†ç±»\nå¯¹ç«äº‰è¿™æŠŠé”çš„æ€åº¦ï¼šä¹è§‚(JUCä¸‹é¢çš„åŸå­ç±»)å’Œæ‚²è§‚(( Synchronized)\nèƒ½å¦ä¿è¯æ¯ä¸ªçº¿ç¨‹éƒ½èƒ½æ‹¿åˆ°é”ï¼šèƒ½å°±æ˜¯å…¬å¹³(å¤„ç†æ•°æ®å°çš„å¥½)ï¼Œä¸èƒ½å°±ä¸å…¬å¹³(æ•°æ®å¤§æ€§èƒ½é«˜)\nèƒ½ä¸èƒ½é€’å½’è°ƒç”¨çš„ï¼šå¯é‡å…¥é”å’Œä¸å¯é‡å…¥é”(å¯èƒ½ä¼šæ­»é”ï¼Œè€Œä¸”çº¿ç¨‹è°ƒåº¦åˆ‡æ¢æ˜¯å¾ˆè€—èµ„æº)\næ˜¯å¦åªèƒ½è¢«ä¸€ä¸ªçº¿ç¨‹æŒæœ‰ï¼šèƒ½å°±æ˜¯ç‹¬äº«ï¼Œä¸èƒ½å°±æ˜¯å…±äº«é”\né”çš„çŠ¶æ€ï¼šæ— é”çŠ¶æ€ã€åå‘é”çŠ¶æ€ã€è½»é‡çº§é”çŠ¶æ€ã€é‡é‡çº§é”çŠ¶æ€\nçœ‹é”çš„æ–¹å¼ï¼šè‡ªé€‰é”(å‚»å±Œå¼è½®è¯¢é—®èƒ½ä¸èƒ½ç”¨)\n\n\n\né”çš„å¯¹è±¡å’ŒèŒƒå›´ï¼Œå¯ä»¥å½±å“åˆ°é”çš„ç²’åº¦\nçœ‹äº†ä¸‹æ‚¨ä¸¾å¾—ä¾‹å­ï¼Œå°±ç±»ä¼¼äºjavaçš„try cathchå§ï¼Ÿä¸ç”¨å§æ•´ä¸ªæ–¹æ³•éƒ½ç»™å«ä½ï¼Œåœ¨éœ€è¦çš„åœ°æ–¹æ‰åˆ†å¼€try\n\nåŸå­long(volatile long)å’Œå¯¹è±¡å¤§Long(AtomicLong)åŒºåˆ«\nå¤§Longå› ä¸ºæ˜¯å¯¹è±¡ é™¤äº†å€¼ï¼Œè¿˜å¸¦äº†ä¸€äº›ä¿¡æ¯ï¼Œæ¯”å¦‚hashä¹‹äº›çš„å¯¹è±¡å¤´ï¼Œè¿˜æœ‰å¼•ç”¨åœ°å€\n\nnettyä¼šæ ¹æ®jdkçš„ç‰ˆæœ¬æ¥é€‰æ‹©æ›´ä¼˜çš„æ–¹æ³•ï¼ˆè·Ÿjvmè°ƒä¼˜ä¸€æ ·ï¼‰ï¼Œæ¯”å¦‚æ–°ç‰ˆçš„jdk(ä»¥jdk8ä¸ºç•Œé™)æœ‰æ›´å¥½çš„ï¼Œå®ƒå°±å¸®ä½ ç”¨jdkè‡ªå¸¦çš„ã€‚æ¯”å¦‚ä½ çš„jdkç‰ˆæœ¬å¤ªä½äº†ï¼Œnettyå°±ä¼šæŠŠæ–°ç‰ˆjdkçš„æ–¹æ³•å¤åˆ¶è¿›å»(å˜ç›¸ç»™ä½ å‡çº§äº†jdk)\n\nchannelçš„å±€éƒ¨ä¸²è¡Œï¼Œå§Channelã€outbound&#47;inboundã€handlerè¿™ä¸‰ä¸ªå¼„æˆä¸€ä¸ªâ€œç±»â€ï¼Œç„¶åå§è¿™ä¸ªç±»å«åšäº‹ä»¶å¤„ç†\n\n\nNettyåº”ç”¨åœºæ™¯ä¸‹:å±€éƒ¨ä¸²è¡Œ+æ•´ä½“å¹¶è¡Œï¼ˆå°‘ä¸ªçº¿ç¨‹å¯¹å°‘ä¸ªäº‹ä»¶ï¼‰&gt;ä¸€ä¸ªé˜Ÿåˆ—+å¤šä¸ªçº¿ç¨‹æ¨¡å¼: (å…¨éƒ¨çº¿ç¨‹å¯¹åº”å…¨éƒ¨çš„äº‹ä»¶)\nâ—é™ä½ç”¨æˆ·å¼€å‘éš¾åº¦ã€ é€»è¾‘ç®€å•ã€æå‡å¤„ç†æ€§èƒ½\nâ—é¿å…é”å¸¦æ¥çš„ä¸Šä¸‹æ–‡åˆ‡æ¢å’Œå¹¶å‘ä¿æŠ¤ç­‰é¢å¤–å¼€é”€(çº¿ç¨‹ä¹‹é—´åˆ‡æ¢çš„)\n\nä¸Šæ¬¡çœ‹ä½ ç•™è¨€è¯´æœ‰ä¸ªäºŒåå¤šåˆ†é’Ÿçš„è§†é¢‘ï¼ŒåŸæ¥å°±æ˜¯åœ¨è¿™é‡Œï¼Œå“ˆå“ˆ\næœ¬æ¥å‘¨äºŒå‡†å¤‡å»çœ‹ä½ ç›´æ’­çš„ï¼Œåˆ°åç‚¹å¤šä¸€å¿™å®Œã€‚ã€‚çœ‹ä½ å´ä¸‹çº¿äº†ã€‚ã€‚","like_count":7,"discussions":[{"author":{"id":1638649,"avatar":"https://static001.geekbang.org/account/avatar/00/19/00/f9/44a3e5bd.jpg","nickname":"å‚…å¥","note":"","ucode":"5EA8BB26F5B036","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":476193,"discussion_content":"å“ˆå“ˆï¼Œå› ä¸ºç›´æ’­è¯´äº†ï¼Œäº‰å–ç¬¦åˆ996ï¼Œæ‰€ä»¥è®¡åˆ’9ç‚¹è¯´å®Œï¼Œæœ€åå¥½åƒ9ç‚¹05ç»“æŸäº†ï¼Œæˆ‘ä¼šæŠŠpptå‘¨æœ«é‡æ–°æ•´ç†å¥½(ç›´æ’­æ—¶çš„pptè¦æ±‚å³ä¸‹ç•™ä¸ªå¤´åƒç©ºç™½ï¼Œæ‰€ä»¥ä¸å¤ªå¥½çœ‹)ï¼Œä¸‹å‘¨æŒ‚git repoä¸Šã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1574936300,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":144855,"user_name":"ç°è‰²","can_delete":false,"product_type":"c3","uid":1178135,"ip_address":"","ucode":"869B400BBD520D","user_header":"https://static001.geekbang.org/account/avatar/00/11/fa/17/d0b8135f.jpg","comment_is_top":false,"comment_ctime":1572076295,"is_pvip":false,"replies":[{"id":57866,"content":"ä¸ä¼šå¢åŠ ä¸Šä¸‹æ–‡åˆ‡æ¢ï¼Œç­‰äºè¯´ï¼Œæœ¬æ¥1ä¸ªæˆ¿é—´ï¼Œ1æŠŠé”ï¼Œç°åœ¨æŠŠæˆ¿é—´å åœ°æå°äº†ï¼Œé”çš„æ¬¡æ•°è¿˜æ˜¯æ²¡æœ‰ä»€ä¹ˆå˜åŒ–çš„ï¼Œåªæ˜¯è…¾å‡ºäº†æ›´å¤šçš„éç«äº‰çš„ç©ºé—´ç»™æˆ‘ä»¬ç”¨äº†ã€‚","user_name":"ä½œè€…å›å¤","user_name_real":"Geek_9bc307","uid":1638649,"ctime":1573549383,"ip_address":"","comment_id":144855,"utype":1}],"discussion_count":5,"race_medal":0,"score":2,"product_id":100036701,"comment_content":"é™ä½é”çš„ç²’åº¦ï¼Œé€šå¸¸ä¼šå¢åŠ äº†åŠ é”çš„æ¬¡æ•°ï¼Œå¢åŠ ä¸Šä¸‹æ–‡åˆ‡æ¢æ¬¡æ•°ï¼Œé‚£ä¹ˆé€šè¿‡é™ä½é”çš„ç²’åº¦ï¼Œæ¥æå‡æ€§èƒ½çš„åšæ³•ï¼Œæ˜¯å¦éœ€è¦æƒè¡¡ä¸€ä¸‹å‘¢ï¼Ÿ","like_count":6,"discussions":[{"author":{"id":1638649,"avatar":"https://static001.geekbang.org/account/avatar/00/19/00/f9/44a3e5bd.jpg","nickname":"å‚…å¥","note":"","ucode":"5EA8BB26F5B036","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":472139,"discussion_content":"ä¸ä¼šå¢åŠ ä¸Šä¸‹æ–‡åˆ‡æ¢ï¼Œç­‰äºè¯´ï¼Œæœ¬æ¥1ä¸ªæˆ¿é—´ï¼Œ1æŠŠé”ï¼Œç°åœ¨æŠŠæˆ¿é—´å åœ°æå°äº†ï¼Œé”çš„æ¬¡æ•°è¿˜æ˜¯æ²¡æœ‰ä»€ä¹ˆå˜åŒ–çš„ï¼Œåªæ˜¯è…¾å‡ºäº†æ›´å¤šçš„éç«äº‰çš„ç©ºé—´ç»™æˆ‘ä»¬ç”¨äº†ã€‚","likes_number":1,"is_delete":false,"is_hidden":false,"ctime":1573549383,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1886331,"avatar":"https://static001.geekbang.org/account/avatar/00/1c/c8/7b/153181d7.jpg","nickname":"å¤œè¾‰","note":"","ucode":"9421385F51FF9E","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":338944,"discussion_content":"è€å¸ˆè¯¾ä¸Šä¸¾çš„ä¾‹å­æ˜¯å¯¹ä¸¤ä¸ªä¸åŒçš„å®ä¾‹è¿›è¡ŒåŠ é”ï¼Œç›¸å¯¹ç‹¬ç«‹ï¼Œå› æ­¤å‡å°‘äº†é”çš„ç²’åº¦","likes_number":1,"is_delete":false,"is_hidden":false,"ctime":1609433478,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1024294,"avatar":"http://thirdwx.qlogo.cn/mmopen/vi_32/PiajxSqBRaELZPnUAiajaR5C25EDLWeJURggyiaOP5GGPe2qlwpQcm5e3ybib8OsP4tvddFDLVRSNNGL5I3SFPJHsA/132","nickname":"null","note":"","ucode":"F9039EFED6B55D","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":316784,"discussion_content":"åŠ é”æ¬¡æ•°æ˜¯å¢åŠ äº†ï¼Œç†è§£å¦‚ä¸‹ï¼š\n\npublic synchronized void m() {\n    ...\n    ...\n}\nè¿™é‡ŒåªåŠ ä¸€æ¬¡é”ã€‚\n\npublic void m(){\n......\n    synchronized(x) {}\n......\n    synchronized(y) {}\n}\nè¿™é‡ŒåŠ äº†ä¸¤æ¬¡é”ã€‚\n\nä½†æ˜¯é”çš„æ—¶é—´çŸ­äº†ï¼Œæé«˜äº†æ–¹æ³•m() çš„å¹¶å‘èƒ½åŠ›ã€‚ç±»æ¯”æ•°æ®åº“ä¸­çš„é•¿äº‹åŠ¡æ‹†è§£ä¸ºå¤šä¸ªçŸ­äº‹åŠ¡ã€‚\n\nä¸€èˆ¬æƒ…å†µä¸‹ï¼Œå¦‚æœçº¿ç¨‹è·å–åˆ°xçš„monitorï¼Œå¾€ä¸‹æ‰§è¡Œæ—¶ï¼Œåº”è¯¥ä¹Ÿä¼šå¤§æ¦‚ç‡è·å–åˆ° y çš„ monitorã€‚\nä½†æç«¯æƒ…å†µä¸‹ï¼Œå¦‚æœºå™¨è¿‡è½½çš„æƒ…å†µä¸‹ï¼Œåº”è¯¥ä¼šå¢åŠ ä¸Šä¸‹æ–‡åˆ‡æ¢çš„æ¬¡æ•°ã€‚\n\nä»¥ä¸Šåˆ†æï¼Œå‡æ— æ•°æ®æ”¯æ’‘ï¼Œä»…æ˜¯ä¸ªäººç†è§£ğŸ¤ªğŸ¤ª","likes_number":2,"is_delete":false,"is_hidden":false,"ctime":1603455938,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1107484,"avatar":"https://static001.geekbang.org/account/avatar/00/10/e6/1c/9d3744ee.jpg","nickname":"ç¨‹åºå‘˜ä¿Šè¾¾","note":"","ucode":"2573037D7C82C8","race_medal":0,"user_type":1,"is_pvip":true},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":546909,"discussion_content":"è¿™å—éœ€è¦æ·±å…¥ç†è§£ä¸€ä¸‹ã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1642468532,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1741153,"avatar":"","nickname":"Geek_Th","note":"","ucode":"D09996D9DAA9A7","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":74848,"discussion_content":"å¯ä»¥ä¸å¯è¿™æ ·ç†è§£ ç²’åº¦å°äº† è¿˜æ²¡åˆè§ç«äº‰ å°±å·²ç»é‡Šæ”¾é”äº†","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1575696563,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":154669,"user_name":"cookie.joo","can_delete":false,"product_type":"c3","uid":1588893,"ip_address":"","ucode":"764AEA3729FE6C","user_header":"https://static001.geekbang.org/account/avatar/00/18/3e/9d/33db96a7.jpg","comment_is_top":false,"comment_ctime":1574504618,"is_pvip":false,"replies":[{"id":59376,"content":"\nä½ è¿™æ ·ç›´æ¥å†™2å¥ä»£ç ï¼š\n        Object o = new Object();\n        o.wait();\nå°±æŠ¥é”™äº†ï¼š\nException in thread &quot;main&quot; java.lang.IllegalMonitorStateException\n\tat java.lang.Object.wait(Native Method)\n\tat java.lang.Object.wait(Object.java:502)\n\tat Test.main(Test.java:6)\nè¦æ±‚è·å–ç›‘è§†å™¨é”ï¼Œæ‰€ä»¥è¿™æ ·ï¼š\n\nsynchronizedï¼ˆobjectï¼‰{\n...............\n}\næ‰€ä»¥æ‰è¯´ç”¨èµ·æ¥ä¸èˆ’æœã€‚","user_name":"ä½œè€…å›å¤","user_name_real":"Geek_9bc307","uid":1638649,"ctime":1574516900,"ip_address":"","comment_id":154669,"utype":1}],"discussion_count":1,"race_medal":0,"score":2,"product_id":100036701,"comment_content":"è¯·é—®ä¸€ä¸‹ä¸ºä»€ä¹ˆè¯´Objectçš„wati()å’Œnotify()ç­‰æ–¹æ³•è¦åœ¨ç›‘è§†å™¨é‡Œé¢å‘¢ï¼Ÿè¿™ä¸ªç‚¹å¯ä»¥è¯´æ˜ä¸€ä¸‹å—ï¼Ÿæˆ‘ä¹Ÿæ˜¯ç¬¬ä¸€æ¬¡å¬è¿‡è¿™è¯´æ³•ã€‚ç›¼å¤ï¼Œè°¢è°¢","like_count":5,"discussions":[{"author":{"id":1638649,"avatar":"https://static001.geekbang.org/account/avatar/00/19/00/f9/44a3e5bd.jpg","nickname":"å‚…å¥","note":"","ucode":"5EA8BB26F5B036","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":475542,"discussion_content":"\nä½ è¿™æ ·ç›´æ¥å†™2å¥ä»£ç ï¼š\n        Object o = new Object();\n        o.wait();\nå°±æŠ¥é”™äº†ï¼š\nException in thread &amp;quot;main&amp;quot; java.lang.IllegalMonitorStateException\n\tat java.lang.Object.wait(Native Method)\n\tat java.lang.Object.wait(Object.java:502)\n\tat Test.main(Test.java:6)\nè¦æ±‚è·å–ç›‘è§†å™¨é”ï¼Œæ‰€ä»¥è¿™æ ·ï¼š\n\nsynchronizedï¼ˆobjectï¼‰{\n...............\n}\næ‰€ä»¥æ‰è¯´ç”¨èµ·æ¥ä¸èˆ’æœã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1574516900,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":143954,"user_name":"å°ä¸ç‚¹","can_delete":false,"product_type":"c3","uid":1351860,"ip_address":"","ucode":"C307D44A185C34","user_header":"https://static001.geekbang.org/account/avatar/00/14/a0/b4/5173f1af.jpg","comment_is_top":false,"comment_ctime":1571813564,"is_pvip":false,"replies":[{"id":55676,"content":"å› ä¸ºè¿™ä¸ªåœ°æ–¹éƒ½æ˜¯è¯»ï¼Œæ²¡æœ‰äººå»ä¿®æ”¹","user_name":"ä½œè€…å›å¤","user_name_real":"Geek_9bc307","uid":1638649,"ctime":1571923503,"ip_address":"","comment_id":143954,"utype":1}],"discussion_count":1,"race_medal":0,"score":2,"product_id":100036701,"comment_content":"è€å¸ˆä¸ºå•¥options0()å’Œattrs0()æ²¡æœ‰çº¿ç¨‹å®‰å…¨é—®é¢˜","like_count":3,"discussions":[{"author":{"id":1638649,"avatar":"https://static001.geekbang.org/account/avatar/00/19/00/f9/44a3e5bd.jpg","nickname":"å‚…å¥","note":"","ucode":"5EA8BB26F5B036","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":471760,"discussion_content":"å› ä¸ºè¿™ä¸ªåœ°æ–¹éƒ½æ˜¯è¯»ï¼Œæ²¡æœ‰äººå»ä¿®æ”¹","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1571923503,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":143917,"user_name":"å°ä¸ç‚¹","can_delete":false,"product_type":"c3","uid":1351860,"ip_address":"","ucode":"C307D44A185C34","user_header":"https://static001.geekbang.org/account/avatar/00/14/a0/b4/5173f1af.jpg","comment_is_top":false,"comment_ctime":1571806915,"is_pvip":false,"replies":[{"id":55543,"content":"è·ç¦»æœ€åä¸æ˜¯ä¸è¿œäº†ä¹ˆï¼ğŸ˜‚","user_name":"ä½œè€…å›å¤","user_name_real":"Geek_9bc307","uid":1638649,"ctime":1571815881,"ip_address":"","comment_id":143917,"utype":1}],"discussion_count":1,"race_medal":0,"score":2,"product_id":100036701,"comment_content":"æ‰“å¡æ‰“å¡ï¼Œå¸Œæœ›èƒ½åšæŒåˆ°æœ€å","like_count":1,"discussions":[{"author":{"id":1638649,"avatar":"https://static001.geekbang.org/account/avatar/00/19/00/f9/44a3e5bd.jpg","nickname":"å‚…å¥","note":"","ucode":"5EA8BB26F5B036","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":471745,"discussion_content":"è·ç¦»æœ€åä¸æ˜¯ä¸è¿œäº†ä¹ˆï¼ğŸ˜‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1571815881,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":177519,"user_name":"Sonny721","can_delete":false,"product_type":"c3","uid":1104291,"ip_address":"","ucode":"C95DD306BFBE54","user_header":"https://static001.geekbang.org/account/avatar/00/10/d9/a3/2856b5b5.jpg","comment_is_top":false,"comment_ctime":1581409565,"is_pvip":false,"replies":[{"id":69669,"content":"Handleræ˜¯å•å®ä¾‹è¿˜æ˜¯å¤šå®ä¾‹çš„ï¼Ÿ\n\nå¯ä»¥æ˜¯å•ä¾‹ï¼Œä¹Ÿå¯ä»¥æ˜¯å¤šä¾‹ï¼Œæ ¹æ®éœ€æ±‚æ¥ï¼šå¦‚ä½•æŠ‰æ‹©ï¼Œåœ¨githubé‡Œçš„è¯¾ç¨‹èµ„æ–™ï¼šç›´æ’­é‚£ä¸ªppté‡Œé¢æœ‰è¯¦ç»†ä»‹ç»ã€‚\n\nåœ¨Handlerä¸­å¦‚ä½•å¤„ç†å¹¶å‘é—®é¢˜ï¼Ÿ\næ²¡æœ‰ä»€ä¹ˆç‰¹æ®ŠæŠ€å·§ï¼Œå°±æ˜¯javaè‡ªå¸¦çš„é‚£äº›é”&#47;threadlocalä¹‹ç±»çš„ä½¿ç”¨äº†ï¼Œå“ªäº›äº‰ç”¨ä¿æŠ¤å“ªäº›ï¼","user_name":"ä½œè€…å›å¤","user_name_real":"stroller","uid":1638649,"ctime":1582004324,"ip_address":"","comment_id":177519,"utype":1}],"discussion_count":1,"race_medal":0,"score":2,"product_id":100036701,"comment_content":"è€å¸ˆæ‚¨å¥½ï¼ŒHandleræ˜¯å•å®ä¾‹è¿˜æ˜¯å¤šå®ä¾‹çš„ï¼Ÿåœ¨Handlerä¸­å¦‚ä½•å¤„ç†å¹¶å‘é—®é¢˜ï¼Ÿ","like_count":0,"discussions":[{"author":{"id":1638649,"avatar":"https://static001.geekbang.org/account/avatar/00/19/00/f9/44a3e5bd.jpg","nickname":"å‚…å¥","note":"","ucode":"5EA8BB26F5B036","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":483452,"discussion_content":"Handleræ˜¯å•å®ä¾‹è¿˜æ˜¯å¤šå®ä¾‹çš„ï¼Ÿ\n\nå¯ä»¥æ˜¯å•ä¾‹ï¼Œä¹Ÿå¯ä»¥æ˜¯å¤šä¾‹ï¼Œæ ¹æ®éœ€æ±‚æ¥ï¼šå¦‚ä½•æŠ‰æ‹©ï¼Œåœ¨githubé‡Œçš„è¯¾ç¨‹èµ„æ–™ï¼šç›´æ’­é‚£ä¸ªppté‡Œé¢æœ‰è¯¦ç»†ä»‹ç»ã€‚\n\nåœ¨Handlerä¸­å¦‚ä½•å¤„ç†å¹¶å‘é—®é¢˜ï¼Ÿ\næ²¡æœ‰ä»€ä¹ˆç‰¹æ®ŠæŠ€å·§ï¼Œå°±æ˜¯javaè‡ªå¸¦çš„é‚£äº›é”/threadlocalä¹‹ç±»çš„ä½¿ç”¨äº†ï¼Œå“ªäº›äº‰ç”¨ä¿æŠ¤å“ªäº›ï¼","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1582004324,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":385559,"user_name":"wallacefw","can_delete":false,"product_type":"c3","uid":1168686,"ip_address":"ç¾å›½","ucode":"9EC56A542D9927","user_header":"https://static001.geekbang.org/account/avatar/00/11/d5/2e/7ace1d94.jpg","comment_is_top":false,"comment_ctime":1702902831,"is_pvip":false,"replies":null,"discussion_count":0,"race_medal":0,"score":2,"product_id":100036701,"comment_content":"æ‰“å¡åˆ°è¿™é‡Œ","like_count":0},{"had_liked":false,"id":315925,"user_name":"å—è¶…å‡¡","can_delete":false,"product_type":"c3","uid":2678558,"ip_address":"","ucode":"A2A160D483BBB0","user_header":"","comment_is_top":false,"comment_ctime":1634049621,"is_pvip":false,"replies":null,"discussion_count":0,"race_medal":0,"score":2,"product_id":100036701,"comment_content":"åŠ é”å¤šçš„è¯jvmæœ¬èº«ä¹Ÿæœ‰é”ç²—è¯çš„ä¼˜åŒ–ï¼Œä¼šè¢«ä¼˜åŒ–å—\n","like_count":0},{"had_liked":false,"id":255919,"user_name":"null","can_delete":false,"product_type":"c3","uid":1024294,"ip_address":"","ucode":"F9039EFED6B55D","user_header":"http://thirdwx.qlogo.cn/mmopen/vi_32/PiajxSqBRaELZPnUAiajaR5C25EDLWeJURggyiaOP5GGPe2qlwpQcm5e3ybib8OsP4tvddFDLVRSNNGL5I3SFPJHsA/132","comment_is_top":false,"comment_ctime":1603456432,"is_pvip":false,"replies":null,"discussion_count":1,"race_medal":0,"score":2,"product_id":100036701,"comment_content":"è€å¸ˆï¼Œæ‚¨å¥½ï¼è¯·æ•™ä¸€ä¸‹ï¼Œåœ¨è®¡ç®—AtomicLong vs long çš„å ç”¨ç©ºé—´æ—¶ï¼Œä¸ºä»€ä¹ˆä¸è®¡ç®— AtomicLongFieldUpdater å¯¹è±¡æ‰€å ç”¨çš„ç©ºé—´å–ï¼Ÿ\n\n64ä½çš„ç³»ç»Ÿï¼š\nlongï¼š8 byte\nAtomic*Updaterï¼š 16 bytes å¯¹è±¡å¤´ + 8bytes å¼•ç”¨\n\n8+16+8ï¼Œå’ŒAtomicLong å ç”¨ç©ºé—´ä¸€æ ·å–ï¼\n\nä¸è¿‡ Updater æ˜¯ static å¯¹è±¡ï¼Œå½“åˆ›å»ºå¤šä¸ª ChannelOutboundBuffer å¯¹è±¡æ—¶ï¼ŒUpdater ä¹Ÿæ˜¯åªå ä¸€ä»½ç©ºé—´ï¼Œè€ŒAtomicLong å°±æ¯ä¸ªå¯¹è±¡å ä¸€ä»½ç©ºé—´ã€‚","like_count":0,"discussions":[{"author":{"id":1670039,"avatar":"https://static001.geekbang.org/account/avatar/00/19/7b/97/950082a4.jpg","nickname":"fish","note":"","ucode":"EBC306460F2962","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":361001,"discussion_content":"çœ‹æƒ…å†µæ›´æ›¿","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1616577119,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":230801,"user_name":"N","can_delete":false,"product_type":"c3","uid":1133657,"ip_address":"","ucode":"3791619172D64F","user_header":"https://static001.geekbang.org/account/avatar/00/11/4c/59/c75cb36d.jpg","comment_is_top":false,"comment_ctime":1593497942,"is_pvip":false,"replies":null,"discussion_count":1,"race_medal":0,"score":3,"product_id":100036701,"comment_content":"è€å¸ˆæ‚¨å¥½ï¼Œæœ‰ä¸ªåœ°æ–¹ä¸æ˜¯å¾ˆæ‡‚ï¼Œå°±æ˜¯é”æœ¬èº«çš„å¤§å°å¯¹ç©ºé—´å ç”¨çœŸçš„æœ‰å¿…è¦å…³æ³¨å—ï¼Ÿä»…ä»…ä¸åˆ°24ä¸ªbytes","like_count":0,"discussions":[{"author":{"id":1107484,"avatar":"https://static001.geekbang.org/account/avatar/00/10/e6/1c/9d3744ee.jpg","nickname":"ç¨‹åºå‘˜ä¿Šè¾¾","note":"","ucode":"2573037D7C82C8","race_medal":0,"user_type":1,"is_pvip":true},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":546913,"discussion_content":"Nettyæ³¨é‡çš„æ˜¯é«˜æ€§èƒ½ï¼Œæ‰€ä»¥æ‰ä¼šæœ‰è¿™äº›ä¼˜åŒ–ï¼Œä¸€ä¸ªé”é™ä½24bytesï¼Œä¸€èˆ¬éƒ½æ˜¯æ•°åä¸‡çš„è¿æ¥ï¼Œé‚£è¿™ä¸ªæ•°å€¼å°±ä¼šè¢«æ”¾å¤§äº†ã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1642469320,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":188619,"user_name":"å‡ å­—å‡‰äº†ç§‹ä¸¶","can_delete":false,"product_type":"c3","uid":1178503,"ip_address":"","ucode":"B1B7A3726AD4E5","user_header":"https://static001.geekbang.org/account/avatar/00/11/fb/87/9c2dc94f.jpg","comment_is_top":false,"comment_ctime":1584374699,"is_pvip":false,"replies":null,"discussion_count":1,"race_medal":0,"score":3,"product_id":100036701,"comment_content":"è€å¸ˆï¼Œè¯·é—®ä¸€ä¸‹ï¼Œä¸€ä¸ªé˜Ÿåˆ— + å¤šä¸ªçº¿ç¨‹ä¸ºå•¥ä¼šæœ‰é”çš„ä¸Šä¸‹æ–‡åˆ‡æ¢ï¼Œ æ¯ä¸ªçº¿ç¨‹æ¶ˆè´¹é˜Ÿåˆ—é‡Œçš„æ¶ˆæ¯ï¼Œä¹Ÿæ˜¯ä¸²è¡Œçš„ï¼Œé”çš„ä¸Šä¸‹æ–‡åˆ‡æ¢å‘ç”Ÿåœ¨å“ª","like_count":0,"discussions":[{"author":{"id":1107484,"avatar":"https://static001.geekbang.org/account/avatar/00/10/e6/1c/9d3744ee.jpg","nickname":"ç¨‹åºå‘˜ä¿Šè¾¾","note":"","ucode":"2573037D7C82C8","race_medal":0,"user_type":1,"is_pvip":true},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":546914,"discussion_content":"å‘ç”Ÿåœ¨é˜Ÿåˆ—æ•°æ®çš„äº‰æŠ¢ä¸Šï¼Œè¿™å—éœ€è¦åŠ é”ï¼Œå¦åˆ™ä¼šä¸€ä¸ªæ•°æ®è¢«å¤šä¸ªçº¿ç¨‹æ¶ˆè´¹ã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1642469415,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":179219,"user_name":"æœå“²å¤«","can_delete":false,"product_type":"c3","uid":1547065,"ip_address":"","ucode":"5409A1B64336AD","user_header":"https://static001.geekbang.org/account/avatar/00/17/9b/39/5a15138c.jpg","comment_is_top":false,"comment_ctime":1581938890,"is_pvip":false,"replies":null,"discussion_count":0,"race_medal":0,"score":3,"product_id":100036701,"comment_content":"è€å¸ˆé—®ä¸€ä¸ªé—®é¢˜ï¼Œæ‚¨è¯´linuxé»˜è®¤ä½¿å…³é—­keepaliveçš„ä¸ºä»€ä¹ˆåœ¨ä½ çš„sampleç¨‹åºä¸­clientæ‰§è¡Œå®Œæ²¡æœ‰æ–­å¼€è¿æ¥å‘¢ï¼Ÿ","like_count":0},{"had_liked":false,"id":154049,"user_name":"ææ˜¥æ’","can_delete":false,"product_type":"c3","uid":1033066,"ip_address":"","ucode":"F2DCA19EC66DC1","user_header":"https://static001.geekbang.org/account/avatar/00/0f/c3/6a/3272e095.jpg","comment_is_top":false,"comment_ctime":1574355971,"is_pvip":false,"replies":null,"discussion_count":0,"race_medal":0,"score":3,"product_id":100036701,"comment_content":"æœåŠ¡å‘˜å›ºå®šåŒ…å¢ï¼Œç±»ä¼¼äºNGINXä¸­çš„äº²æ ¸ç‰¹æ€§affinityï¼Œé¿å…ç«äº‰å’Œåˆ‡æ¢","like_count":0}]}