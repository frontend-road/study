{"id":200155,"title":"45 | 数据库迁移方式及工具","content":"<p><strong>课件和Demo地址</strong><br>\n<a href=\"https://gitee.com/geektime-geekbang/geektime-mongodb-course\">https://gitee.com/geektime-geekbang/geektime-mongodb-course</a></p>","comments":[{"had_liked":false,"id":179788,"user_name":"qbit","can_delete":false,"product_type":"c3","uid":1262927,"ip_address":"","ucode":"96C70A1E47B93D","user_header":"https://static001.geekbang.org/account/avatar/00/13/45/4f/f94caf47.jpg","comment_is_top":false,"comment_ctime":1582099537,"is_pvip":false,"replies":[{"id":70073,"content":"谢谢你的提醒。我忘了加个步骤就是要在CSV文件里添加headerline.","user_name":"作者回复","user_name_real":"远航的TJ 唐建法","uid":1260017,"ctime":1582343704,"ip_address":"","comment_id":179788,"utype":1}],"discussion_count":1,"race_medal":0,"score":2,"product_id":100040001,"comment_content":"视频里面好像有点小问题，mysqldump 导出时 cat 没有 headerline，mongoimport 时又加了 headerline 参数。","like_count":7,"discussions":[{"author":{"id":1260017,"avatar":"https://static001.geekbang.org/account/avatar/00/13/39/f1/6d18a4d1.jpg","nickname":"远航的TJ 唐建法","note":"","ucode":"0719807390250A","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":484399,"discussion_content":"谢谢你的提醒。我忘了加个步骤就是要在CSV文件里添加headerline.","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1582343704,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":201901,"user_name":"xibuhaohao","can_delete":false,"product_type":"c3","uid":1935390,"ip_address":"","ucode":"7C47D0B29AE978","user_header":"","comment_is_top":false,"comment_ctime":1585875324,"is_pvip":false,"replies":[{"id":78485,"content":"这个mongoimport不支持，需要用外部工具。","user_name":"作者回复","user_name_real":"远航的TJ 唐建法","uid":1260017,"ctime":1587879078,"ip_address":"","comment_id":201901,"utype":1}],"discussion_count":1,"race_medal":0,"score":2,"product_id":100040001,"comment_content":"老师，有个问题请教，mongoimport导入csv文件，怎样把csv中的数据，导入为数组或者多层嵌套模式？","like_count":0,"discussions":[{"author":{"id":1260017,"avatar":"https://static001.geekbang.org/account/avatar/00/13/39/f1/6d18a4d1.jpg","nickname":"远航的TJ 唐建法","note":"","ucode":"0719807390250A","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":490451,"discussion_content":"这个mongoimport不支持，需要用外部工具。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1587879078,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":382150,"user_name":"wahaha","can_delete":false,"product_type":"c3","uid":1008747,"ip_address":"上海","ucode":"EAD5AEE19ECF8B","user_header":"http://thirdwx.qlogo.cn/mmopen/vi_32/WFX7G7hO480BopLPxhY0DqTtDicUCgNHnk4XP1gJfsv37DCRvK9mwRTDHdQX4y0MTdp8DWsnxmkBsmw2Fdtib7MQ/132","comment_is_top":false,"comment_ctime":1696774663,"is_pvip":false,"replies":null,"discussion_count":0,"race_medal":0,"score":2,"product_id":100040001,"comment_content":"老师，请问从mongo A库把数据迁移到B库，在线服务，访问需要平滑从A切换到B，有没有什么好的方式？","like_count":0},{"had_liked":false,"id":266826,"user_name":"注意力$","can_delete":false,"product_type":"c3","uid":1142316,"ip_address":"","ucode":"7FB3399A1EAB72","user_header":"https://static001.geekbang.org/account/avatar/00/11/6e/2c/e2f3cfc0.jpg","comment_is_top":false,"comment_ctime":1607498889,"is_pvip":false,"replies":null,"discussion_count":1,"race_medal":0,"score":2,"product_id":100040001,"comment_content":"   请问关于MongoDB 5分片环境，把其中的一个片的一个节点迁移到新机器上，每个分片的架构是主从arbiter，需要把其中的从库切换到新机器上，变更当天切换，现在每个分片以4个节点的方式运行（主从从arbiter），变更当天，再切换剔除其中一个节点，变更前这样4个节点运行会不会有问题啊？变更当天需要登录mongos更新分片信息吗？期待老师的答复","like_count":0,"discussions":[{"author":{"id":1142316,"avatar":"https://static001.geekbang.org/account/avatar/00/11/6e/2c/e2f3cfc0.jpg","nickname":"注意力$","note":"","ucode":"7FB3399A1EAB72","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":333571,"discussion_content":"到时候更换了节点，需要登录mongos更新分片信息吗？ 执行 db.getSiblingDB(&#34;config&#34;).shards.save({_id:&#34;shard1&#34;,host:&#34;rep1/ip:27000,ip:27000,ip:27000”}); 期待老师的答复","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1607566042,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]}]}