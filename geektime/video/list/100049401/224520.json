{"id":224520,"title":"12 | 安装与部署：如何安装Istio？它都支持哪些环境和部署方式？","content":"<p><strong>课件和Demo地址</strong><br>\n<a href=\"https://gitee.com/geektime-geekbang/geektime-servicemesh\">https://gitee.com/geektime-geekbang/geektime-servicemesh</a></p>","comments":[{"had_liked":false,"id":290184,"user_name":"奋发图强的小强","can_delete":false,"product_type":"c3","uid":1067389,"ip_address":"","ucode":"94DBC995685F19","user_header":"https://static001.geekbang.org/account/avatar/00/10/49/7d/9d74a8b3.jpg","comment_is_top":false,"comment_ctime":1619421853,"is_pvip":false,"replies":[{"id":106171,"content":"虚拟机和主机不通，先通过桥接让它们内互相访问","user_name":"作者回复","user_name_real":"马若飞","uid":1046394,"ctime":1621343612,"ip_address":"","comment_id":290184,"utype":1}],"discussion_count":1,"race_medal":0,"score":2,"product_id":100049401,"comment_content":"老师，我用的是istio1.9版本，部署在cvm上，按照官网上https:&#47;&#47;istio.io&#47;latest&#47;zh&#47;docs&#47;setup&#47;getting-started&#47;上安装， 最后在安装的机器上curl &quot;http:&#47;&#47;$GATEWAY_URL&#47;productpage&quot; 是返回页面内容，但在浏览器上无法访问，外面机器ping minikube ip 也是不通的，求指导","like_count":2,"discussions":[{"author":{"id":1046394,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/f7/7a/55618020.jpg","nickname":"马若飞","note":"","ucode":"3D0327329A10AE","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":519132,"discussion_content":"虚拟机和主机不通，先通过桥接让它们内互相访问","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1621343612,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":261641,"user_name":"Harold","can_delete":false,"product_type":"c3","uid":1168849,"ip_address":"","ucode":"313F3F5869E76B","user_header":"https://static001.geekbang.org/account/avatar/00/11/d5/d1/42de06de.jpg","comment_is_top":false,"comment_ctime":1605456223,"is_pvip":false,"replies":[{"id":95463,"content":"1.8 已经出了，建议用最新版。核心内容没有变化，不影响学习。不过最近半年istio团队一直在优化安装流程，1.7的安装和1.5不太一样，变的更简单了，你可以看看官方文档安装。","user_name":"作者回复","user_name_real":"马若飞","uid":1046394,"ctime":1605971026,"ip_address":"","comment_id":261641,"utype":1}],"discussion_count":1,"race_medal":0,"score":2,"product_id":100049401,"comment_content":"老师，目前最新的是1.7版本，针对学习课程来说是不是安装1.5版本比较好，这两个版本间改动大吗。","like_count":2,"discussions":[{"author":{"id":1046394,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/f7/7a/55618020.jpg","nickname":"马若飞","note":"","ucode":"3D0327329A10AE","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":509551,"discussion_content":"1.8 已经出了，建议用最新版。核心内容没有变化，不影响学习。不过最近半年istio团队一直在优化安装流程，1.7的安装和1.5不太一样，变的更简单了，你可以看看官方文档安装。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1605971026,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":239194,"user_name":"彬少","can_delete":false,"product_type":"c3","uid":1460396,"ip_address":"","ucode":"B4A7FDC62C48B1","user_header":"https://static001.geekbang.org/account/avatar/00/16/48/ac/045a2ccb.jpg","comment_is_top":false,"comment_ctime":1596456175,"is_pvip":false,"replies":[{"id":88512,"content":"赞������\n就是说之前改profile的思路是对的，只是没改到位对吧？","user_name":"作者回复","user_name_real":"马若飞","uid":1046394,"ctime":1596619191,"ip_address":"","comment_id":239194,"utype":1}],"discussion_count":1,"race_medal":0,"score":2,"product_id":100049401,"comment_content":"经过探索实践，回来回答一下半个月前自己提的问题。分享一下成功实践，太不容易了。。。\n问题：istio1.5（helm方式安装），现在要升级到istio1.6.4（istioctl方式安装），需要的组件和demo一致，而且要添加一些自定义端口并改为NodePort的方式暴露。\n实践：\n1、自定义端口，修改manifests&#47;profiles&#47;demo.yaml，添加自定义端口\n2、私有仓库镜像，修改manifests&#47;profiles&#47;demo.yaml中的hub，image，repository（前面虽然有些看起来像是镜像的全局变量定义但实际没有用）\n3、从1.5版本升级的话需要删除istio-galley，kubectl delete validatingwebhookconfiguration istio-galley\n4、执行安装，istioctl manifest apply --set profile=demo --charts=&#47;home&#47;appadmin&#47;istio&#47;istio-1.6.4&#47;manifests&#47; --set values.gateways.istio-ingressgateway.type=NodePort --set values.global.jwtPolicy=first-party-jwt","like_count":2,"discussions":[{"author":{"id":1046394,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/f7/7a/55618020.jpg","nickname":"马若飞","note":"","ucode":"3D0327329A10AE","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":503017,"discussion_content":"赞������\n就是说之前改profile的思路是对的，只是没改到位对吧？","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1596619191,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":234869,"user_name":"彬少","can_delete":false,"product_type":"c3","uid":1460396,"ip_address":"","ucode":"B4A7FDC62C48B1","user_header":"https://static001.geekbang.org/account/avatar/00/16/48/ac/045a2ccb.jpg","comment_is_top":false,"comment_ctime":1594815545,"is_pvip":false,"replies":[{"id":87114,"content":"1.6我还没验证。从官方文档（https:&#47;&#47;istio.io&#47;latest&#47;docs&#47;setup&#47;install&#47;istioctl&#47;）看用了--charts就不需要再用 --set profile=demo了，去掉并使用install试试：istioctl install --charts=manifests&#47;\n如果还不行，我觉得还是可以通过helm upgrade去安装\n","user_name":"作者回复","user_name_real":"马若飞","uid":1046394,"ctime":1595233369,"ip_address":"","comment_id":234869,"utype":1}],"discussion_count":1,"race_medal":0,"score":2,"product_id":100049401,"comment_content":"老师，我们以前用istio1.5（helm方式安装），现在要升级到istio1.6.4（istioctl方式安装），需要的组件和demo一致，而且要添加一些自定义端口并改为NodePort的方式暴露。我是通过修改demo.yaml添加自定义端口，并使用命令istioctl manifest apply --set profile=demo --charts=&#47;home&#47;appadmin&#47;istio-1.6.4&#47;manifests&#47;  --set values.gateways.istio-ingressgateway.type=NodePort安装的，功能也验证通过。\n现在希望把镜像改为通过自己私有harbor获取，修改了下面几处配置，按上述命令安装后，镜像依然是外网的镜像仓库获取。\n1) 修改manifest.yaml\n2) manifests&#47;profiles&#47;default.yaml，修改spec hub\n3) manifests&#47;profiles&#47;demo.yaml，添加spec hub\n4) manifests&#47;charts&#47;istio-telemetry下grafana, kiali, prometheus的镜像\n请教老师这个问题该如何处理？","like_count":2,"discussions":[{"author":{"id":1046394,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/f7/7a/55618020.jpg","nickname":"马若飞","note":"","ucode":"3D0327329A10AE","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":501532,"discussion_content":"1.6我还没验证。从官方文档（https://istio.io/latest/docs/setup/install/istioctl/）看用了--charts就不需要再用 --set profile=demo了，去掉并使用install试试：istioctl install --charts=manifests/\n如果还不行，我觉得还是可以通过helm upgrade去安装\n","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1595233369,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":213232,"user_name":"之一","can_delete":false,"product_type":"c3","uid":1462396,"ip_address":"","ucode":"45307FBDBEA953","user_header":"https://static001.geekbang.org/account/avatar/00/16/50/7c/f1203495.jpg","comment_is_top":false,"comment_ctime":1588338011,"is_pvip":false,"replies":[{"id":79150,"content":"默认是admin, 进入页面应该可以设置","user_name":"作者回复","user_name_real":"马若飞","uid":1046394,"ctime":1588424044,"ip_address":"","comment_id":213232,"utype":1}],"discussion_count":2,"race_medal":0,"score":2,"product_id":100049401,"comment_content":"kiali 老师，这个kiali 自动打开 就是登录界面，这账号哪里设置的呢","like_count":2,"discussions":[{"author":{"id":1046394,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/f7/7a/55618020.jpg","nickname":"马若飞","note":"","ucode":"3D0327329A10AE","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":493717,"discussion_content":"默认是admin, 进入页面应该可以设置","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1588424044,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1462396,"avatar":"https://static001.geekbang.org/account/avatar/00/16/50/7c/f1203495.jpg","nickname":"之一","note":"","ucode":"45307FBDBEA953","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":255743,"discussion_content":"嗯，admin/admin 进去了，谢谢！","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1588426427,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":224013,"user_name":"小猪","can_delete":false,"product_type":"c3","uid":1201662,"ip_address":"","ucode":"EAD6A4876CEF3B","user_header":"https://static001.geekbang.org/account/avatar/00/12/55/fe/ab541300.jpg","comment_is_top":false,"comment_ctime":1591256325,"is_pvip":false,"replies":[{"id":82574,"content":"用 kube config 让本地可以查看集群，然后通过port-forward 端口转发到本机看。\n","user_name":"作者回复","user_name_real":"马若飞","uid":1046394,"ctime":1591335778,"ip_address":"","comment_id":224013,"utype":1}],"discussion_count":1,"race_medal":0,"score":2,"product_id":100049401,"comment_content":"老师，我的k8s和istio是部署在服务器上，不是在本机localhost，这种情况部署完Gateway以后，应该怎么访问示例的网页呢？","like_count":1,"discussions":[{"author":{"id":1046394,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/f7/7a/55618020.jpg","nickname":"马若飞","note":"","ucode":"3D0327329A10AE","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":497337,"discussion_content":"用 kube config 让本地可以查看集群，然后通过port-forward 端口转发到本机看。\n","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1591335778,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":210285,"user_name":"ranger","can_delete":false,"product_type":"c3","uid":1000242,"ip_address":"","ucode":"01C26E1DEF77FE","user_header":"https://static001.geekbang.org/account/avatar/00/0f/43/32/3eeac151.jpg","comment_is_top":false,"comment_ctime":1587714119,"is_pvip":false,"replies":[{"id":78430,"content":"&quot;我希望基于profile=demo基础上将istio-ingressgateway设置为ClusterIP，供本地端口导出使用。&quot;  -- 如果我理解没错的话，你是要把ingressgateway作为入口网关，让外部可以访问网格内的服务？ 如果是这样的话不需要动ingress，添加gateway并在selector设置它就可以了。后面网关一课中会介绍。","user_name":"作者回复","user_name_real":"马若飞","uid":1046394,"ctime":1587808598,"ip_address":"","comment_id":210285,"utype":1}],"discussion_count":1,"race_medal":0,"score":2,"product_id":100049401,"comment_content":"IstioOperator 配置profile=demo用于本地测试，默认istio-ingressgateway使用的svc 是LoadBalancer，本地无法将入口到处使用，我希望基于profile=demo基础上将istio-ingressgateway设置为ClusterIP，供本地端口导出使用。我现在通过 istioctl manifest apply --set profile=demo --set values.gateways.istio-ingressgateway.type=ClusterIP 安装后，遇到的问题是istio-ingressgateway的svc消失了，应该怎么订制istio配置才能达到效果？","like_count":1,"discussions":[{"author":{"id":1046394,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/f7/7a/55618020.jpg","nickname":"马若飞","note":"","ucode":"3D0327329A10AE","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":492992,"discussion_content":"&amp;quot;我希望基于profile=demo基础上将istio-ingressgateway设置为ClusterIP，供本地端口导出使用。&amp;quot;  -- 如果我理解没错的话，你是要把ingressgateway作为入口网关，让外部可以访问网格内的服务？ 如果是这样的话不需要动ingress，添加gateway并在selector设置它就可以了。后面网关一课中会介绍。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1587808598,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":326915,"user_name":"DZZ","can_delete":false,"product_type":"c3","uid":1516167,"ip_address":"","ucode":"C8E4C4B089BCE2","user_header":"https://static001.geekbang.org/account/avatar/00/17/22/87/e7bd2acf.jpg","comment_is_top":false,"comment_ctime":1639748576,"is_pvip":false,"replies":[{"id":119988,"content":"sidecar 支持在vm部署，但组成一个mesh还是需要k8s做底层","user_name":"作者回复","user_name_real":"编辑","uid":1046394,"ctime":1641380297,"ip_address":"","comment_id":326915,"utype":1}],"discussion_count":1,"race_medal":0,"score":2,"product_id":100049401,"comment_content":"老师 能否不使用k8s部署 ，直接在虚拟机安装部署istio进行使用","like_count":0,"discussions":[{"author":{"id":1046394,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/f7/7a/55618020.jpg","nickname":"马若飞","note":"","ucode":"3D0327329A10AE","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":544020,"discussion_content":"sidecar 支持在vm部署，但组成一个mesh还是需要k8s做底层","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1641380297,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":326375,"user_name":"bearlu","can_delete":false,"product_type":"c3","uid":1030862,"ip_address":"","ucode":"14F260C8B24E27","user_header":"https://static001.geekbang.org/account/avatar/00/0f/ba/ce/fd45714f.jpg","comment_is_top":false,"comment_ctime":1639489447,"is_pvip":true,"replies":[{"id":119990,"content":"查看一下gateway和对应的Virtualservice是否配置正确","user_name":"作者回复","user_name_real":"编辑","uid":1046394,"ctime":1641380413,"ip_address":"","comment_id":326375,"utype":1}],"discussion_count":3,"race_medal":0,"score":2,"product_id":100049401,"comment_content":"老师。为什么输入在浏览器输入localhost&#47;productpage访问失败","like_count":0,"discussions":[{"author":{"id":1046394,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/f7/7a/55618020.jpg","nickname":"马若飞","note":"","ucode":"3D0327329A10AE","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":544023,"discussion_content":"查看一下gateway和对应的Virtualservice是否配置正确","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1641380414,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1002201,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/4a/d9/75dd7cf9.jpg","nickname":"Mew151","note":"","ucode":"D4793F5874F345","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":626325,"discussion_content":"如果你用的是 minikube ，执行 minikube tunnel 后再试一下","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1692799751,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":"北京","group_id":0},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1739621,"avatar":"https://static001.geekbang.org/account/avatar/00/1a/8b/65/0f1f9a10.jpg","nickname":"小Y","note":"","ucode":"24A43BB71805F8","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":559403,"discussion_content":"这个后来怎么解决呀？我也是同样的问题","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1648736453,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":321356,"user_name":"读书破万卷","can_delete":false,"product_type":"c3","uid":2223611,"ip_address":"","ucode":"2C60C6C83E9D37","user_header":"https://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTIiam52mLdqzU8o08ibSxTWySR2uOcF1iaMMSxPicPh4r8oiaYs0ib2eJvyQDyA9cBp9hXf32Alo4ljtDRw/132","comment_is_top":false,"comment_ctime":1636810411,"is_pvip":false,"replies":[{"id":119991,"content":"describe pod 看看报什么错","user_name":"作者回复","user_name_real":"编辑","uid":1046394,"ctime":1641380487,"ip_address":"","comment_id":321356,"utype":1}],"discussion_count":1,"race_medal":0,"score":2,"product_id":100049401,"comment_content":"NAME                             READY   UP-TO-DATE   AVAILABLE   AGE\ndeployment.apps&#47;details-v1       0&#47;1     0            0           92s\ndeployment.apps&#47;productpage-v1   0&#47;1     0            0           91s\ndeployment.apps&#47;ratings-v1       0&#47;1     0            0           91s\ndeployment.apps&#47;reviews-v1       0&#47;1     0            0           91s\ndeployment.apps&#47;reviews-v2       0&#47;1     0            0           91s\ndeployment.apps&#47;reviews-v3       0&#47;1     0            0           91s\n 我部署  bookinfo 然后一直是这样","like_count":0,"discussions":[{"author":{"id":1046394,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/f7/7a/55618020.jpg","nickname":"马若飞","note":"","ucode":"3D0327329A10AE","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":544024,"discussion_content":"describe pod 看看报什么错","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1641380487,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":303070,"user_name":"Geek_e1d25e","can_delete":false,"product_type":"c3","uid":1637705,"ip_address":"","ucode":"6C30CDE3CB18C4","user_header":"","comment_is_top":false,"comment_ctime":1626578333,"is_pvip":false,"replies":[{"id":110123,"content":"集群权限问题，先确定你的kubeconfig正常","user_name":"作者回复","user_name_real":"马若飞","uid":1046394,"ctime":1627354168,"ip_address":"","comment_id":303070,"utype":1}],"discussion_count":1,"race_medal":0,"score":3,"product_id":100049401,"comment_content":"老师，我执行istioctl version报错。\nunable to retrieve Pods: Get &quot;http:&#47;&#47;localhost:8080&#47;api&#47;v1&#47;namespaces&#47;istio-system&#47;pods?fieldSelector=status.phase%3DRunning&amp;labelSelector=app%3Distiod&quot;: dial tcp 127.0.0.1:8080: connect: connection refused\n1.10.3","like_count":0,"discussions":[{"author":{"id":1046394,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/f7/7a/55618020.jpg","nickname":"马若飞","note":"","ucode":"3D0327329A10AE","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":523544,"discussion_content":"集群权限问题，先确定你的kubeconfig正常","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1627354168,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":294033,"user_name":"💰💰💰","can_delete":false,"product_type":"c3","uid":2580393,"ip_address":"","ucode":"BAF5D7DBE496FA","user_header":"https://static001.geekbang.org/account/avatar/00/27/5f/a9/18573ff6.jpg","comment_is_top":false,"comment_ctime":1621690910,"is_pvip":false,"replies":[{"id":108522,"content":"浏览器可能有限制，不行就换个环境测试","user_name":"作者回复","user_name_real":"马若飞","uid":1046394,"ctime":1624534906,"ip_address":"","comment_id":294033,"utype":1}],"discussion_count":1,"race_medal":0,"score":3,"product_id":100049401,"comment_content":"老师，katacoda ingressgateway的external ip已经有了，为什么在我本地还是访问不到book info的页面呢，在controlplane也是能正常curl的","like_count":0,"discussions":[{"author":{"id":1046394,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/f7/7a/55618020.jpg","nickname":"马若飞","note":"","ucode":"3D0327329A10AE","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":520476,"discussion_content":"浏览器可能有限制，不行就换个环境测试","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1624534906,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":291490,"user_name":"Geek_518c5c","can_delete":false,"product_type":"c3","uid":1298230,"ip_address":"","ucode":"83B79CE18EF920","user_header":"http://thirdwx.qlogo.cn/mmopen/vi_32/DYAIOgq83eqT3pba9RQEXAOHiaOMm3ibSicngJj3LAHaAQ9pa5N1I6A4RwNQ97LQeFAnLkQgaXBjHpW9xPYQVTaIA/132","comment_is_top":false,"comment_ctime":1620305967,"is_pvip":false,"replies":[{"id":106168,"content":"是的","user_name":"作者回复","user_name_real":"马若飞","uid":1046394,"ctime":1621343225,"ip_address":"","comment_id":291490,"utype":1}],"discussion_count":1,"race_medal":0,"score":3,"product_id":100049401,"comment_content":"istio安装的时候，是不是先要有k8s\n","like_count":0,"discussions":[{"author":{"id":1046394,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/f7/7a/55618020.jpg","nickname":"马若飞","note":"","ucode":"3D0327329A10AE","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":519482,"discussion_content":"是的","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1621343225,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":278284,"user_name":"jacky","can_delete":false,"product_type":"c3","uid":2105773,"ip_address":"","ucode":"CF3638E2177182","user_header":"https://static001.geekbang.org/account/avatar/00/20/21/ad/734464b7.jpg","comment_is_top":false,"comment_ctime":1612856718,"is_pvip":false,"replies":[{"id":101055,"content":"查看一下ingresgateway pod的log，这种情况大概率和role没有创建好有关。删掉这个pod让他重新创建看看","user_name":"作者回复","user_name_real":"马若飞","uid":1046394,"ctime":1612863089,"ip_address":"","comment_id":278284,"utype":1}],"discussion_count":3,"race_medal":0,"score":3,"product_id":100049401,"comment_content":"通过helm安装完istio1.8.3, engress和ingress是not ready\nkubectl -n istio-system get po\nNAME                                    READY   STATUS    RESTARTS   AGE\nistio-egressgateway-7458cfbf-g84n5      0&#47;1     Running   0          21m\nistio-ingressgateway-55f5d4fdbd-5wfnn   0&#47;1     Running   0          21m\nistiod-745cbbb898-d6xsk                 1&#47;1     Running   0          21m\n\nkubectl describe pod -n istio-system istio-ingressgateway-55f5d4fdbd-5wfnn 有如下错误\n  Warning  Unhealthy  26m (x22 over 27m)     kubelet            Readiness probe failed: Get &quot;http:&#47;&#47;172.20.2.13:15021&#47;healthz&#47;ready&quot;: dial tcp 172.20.2.13:15021: connect: connection refused\n  Warning  Unhealthy  2m34s (x718 over 26m)  kubelet            Readiness probe failed: HTTP probe failed with statuscode: 503\n\n请问如何解决？","like_count":0,"discussions":[{"author":{"id":1046394,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/f7/7a/55618020.jpg","nickname":"马若飞","note":"","ucode":"3D0327329A10AE","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":515336,"discussion_content":"查看一下ingresgateway pod的log，这种情况大概率和role没有创建好有关。删掉这个pod让他重新创建看看","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1612863089,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":2105773,"avatar":"https://static001.geekbang.org/account/avatar/00/20/21/ad/734464b7.jpg","nickname":"jacky","note":"","ucode":"CF3638E2177182","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":349107,"discussion_content":"谢谢老师回复。删pod没有用。ingressgateway pod的部分log如下. 貌似和证书有关，请问要怎么解决？\n```\n2021-02-09T15:36:12.766504Z\twarn\tsecretfetcher\tfailed load server cert/key pair from secret sh.helm.release.v1.istio-egress.v1: server cert or private key is empty\n2021-02-09T15:36:12.766509Z\tinfo\tsecretfetcher\tsecret sh.helm.release.v1.istio-egress.v1 does not change, skip update\n2021-02-09T15:36:24.969454Z\terror\txdsproxy\tfailed to create upstream grpc client: rpc error: code = Unavailable desc = connection error: desc = &#34;transport: Error while dialing dial tcp: i/o timeout&#34;\n\n```","likes_number":1,"is_delete":false,"is_hidden":false,"ctime":1612885820,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":2105773,"avatar":"https://static001.geekbang.org/account/avatar/00/20/21/ad/734464b7.jpg","nickname":"jacky","note":"","ucode":"CF3638E2177182","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":349179,"discussion_content":"采用istio1.9.0好了，怀疑是装的k8s和istio1.8.3不匹配导致的","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1612951033,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":263672,"user_name":"Geek_83ce75","can_delete":false,"product_type":"c3","uid":2337333,"ip_address":"","ucode":"7681A61A3A5E54","user_header":"https://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTJ4tTBGPc96I8bq8hviagXXYT3xf1LAt4JDGF7Cs2aicXwgScbbFWtW6eDUicvWzYNQ1WOjA7PluCjGQ/132","comment_is_top":false,"comment_ctime":1606214477,"is_pvip":false,"replies":[{"id":95655,"content":"你用的什么版本？1.7之上的版本应该是不支持manifest apply这个语法了","user_name":"作者回复","user_name_real":"马若飞","uid":1046394,"ctime":1606225047,"ip_address":"","comment_id":263672,"utype":1}],"discussion_count":2,"race_medal":0,"score":3,"product_id":100049401,"comment_content":"istioctl manifest apply --set profile=demo\nError: unknown flag: --set\n\n这个是什么原因啊？？？？","like_count":0,"discussions":[{"author":{"id":1046394,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/f7/7a/55618020.jpg","nickname":"马若飞","note":"","ucode":"3D0327329A10AE","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":510265,"discussion_content":"你用的什么版本？1.7之上的版本应该是不支持manifest apply这个语法了","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1606225047,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":2037440,"avatar":"https://static001.geekbang.org/account/avatar/00/1f/16/c0/753248c0.jpg","nickname":"MonsterSquad","note":"","ucode":"D13ABF4B906A8B","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":347655,"discussion_content":"## 试试这个命令\n`istioctl install --set profile=demo -y`\n> 我直接安装最新的istio了1.8.2","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1612274513,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":251384,"user_name":"科精","can_delete":false,"product_type":"c3","uid":1808339,"ip_address":"","ucode":"338E135702DD7B","user_header":"https://static001.geekbang.org/account/avatar/00/1b/97/d3/239aa4d5.jpg","comment_is_top":false,"comment_ctime":1601517593,"is_pvip":false,"replies":[{"id":92162,"content":"你这是describe里event的信息吗？探针检查失败了。先装一下default profile，看看istiod是否正常，然后再用demo装","user_name":"作者回复","user_name_real":"马若飞","uid":1046394,"ctime":1602231089,"ip_address":"","comment_id":251384,"utype":1}],"discussion_count":3,"race_medal":0,"score":3,"product_id":100049401,"comment_content":"istio-egressgateway 和 istio-ingressgateway这些 pod起不来，版本1.5.1。日志：probe failed: HTTP probe failed with statuscode: 503","like_count":0,"discussions":[{"author":{"id":1046394,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/f7/7a/55618020.jpg","nickname":"马若飞","note":"","ucode":"3D0327329A10AE","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":506474,"discussion_content":"你这是describe里event的信息吗？探针检查失败了。先装一下default profile，看看istiod是否正常，然后再用demo装","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1602231089,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1808339,"avatar":"https://static001.geekbang.org/account/avatar/00/1b/97/d3/239aa4d5.jpg","nickname":"科精","note":"","ucode":"338E135702DD7B","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":311280,"discussion_content":"重新装的default profile","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1602296763,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1808339,"avatar":"https://static001.geekbang.org/account/avatar/00/1b/97/d3/239aa4d5.jpg","nickname":"科精","note":"","ucode":"338E135702DD7B","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":311279,"discussion_content":"我发现它还是起不来，看了一下日志\nEnvoy proxy is NOT ready: config not received from Pilot (is Pilot running?): cds updates: 0 successful, 0 rejected; lds updates: 0 successful, 0 rejected\n网上找了一下说pod与sidecar的什么代理没与kube-dns对其，我看了一下IP地址都是一样的，\n我参考的是这篇：https://segmentfault.com/a/1190000020301822\n但仍然没用","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1602296692,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":249513,"user_name":"Francis","can_delete":false,"product_type":"c3","uid":1145834,"ip_address":"","ucode":"DC3F69EED29A5D","user_header":"https://static001.geekbang.org/account/avatar/00/11/7b/ea/70bf7e98.jpg","comment_is_top":false,"comment_ctime":1600679273,"is_pvip":false,"replies":[{"id":92166,"content":"看上去是把istiod分配到你的node4上了，你得看看这个node为什么不能访问","user_name":"作者回复","user_name_real":"马若飞","uid":1046394,"ctime":1602232415,"ip_address":"","comment_id":249513,"utype":1}],"discussion_count":1,"race_medal":0,"score":3,"product_id":100049401,"comment_content":"Events:\n  Type     Reason     Age                            From                 Message\n  ----     ------     ----                           ----                 -------\n  Normal   Scheduled  &lt;unknown&gt;                      default-scheduler    Successfully assigned istio-system&#47;istiod-77df9b78f8-dkgww to kube-node4\n  Normal   Pulled     &lt;invalid&gt;                      kubelet, kube-node4  Container image &quot;docker.io&#47;istio&#47;pilot:1.7.2&quot; already present on machine\n  Normal   Created    &lt;invalid&gt;                      kubelet, kube-node4  Created container discovery\n  Normal   Started    &lt;invalid&gt;                      kubelet, kube-node4  Started container discovery\n  Warning  Unhealthy  &lt;invalid&gt; (x3 over &lt;invalid&gt;)  kubelet, kube-node4  Readiness probe failed: Get http:&#47;&#47;10.20.195.54:8080&#47;ready: dial tcp 10.20.195.54:8080: connect: connection refused\n老师，istiod报这个错，该怎么解决？麻烦看看，谢谢","like_count":0,"discussions":[{"author":{"id":1046394,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/f7/7a/55618020.jpg","nickname":"马若飞","note":"","ucode":"3D0327329A10AE","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":505940,"discussion_content":"看上去是把istiod分配到你的node4上了，你得看看这个node为什么不能访问","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1602232415,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":249428,"user_name":"Francis","can_delete":false,"product_type":"c3","uid":1145834,"ip_address":"","ucode":"DC3F69EED29A5D","user_header":"https://static001.geekbang.org/account/avatar/00/11/7b/ea/70bf7e98.jpg","comment_is_top":false,"comment_ctime":1600654121,"is_pvip":false,"replies":[{"id":92167,"content":"1.7就是只有3个：https:&#47;&#47;istio.io&#47;latest&#47;docs&#47;setup&#47;additional-setup&#47;config-profiles&#47;\n要安装其他组件用这种方式istioctl manifest apply --set addonComponents.grafana.enabled=true\n","user_name":"作者回复","user_name_real":"马若飞","uid":1046394,"ctime":1602232888,"ip_address":"","comment_id":249428,"utype":1}],"discussion_count":3,"race_medal":0,"score":3,"product_id":100049401,"comment_content":"老师，为啥我用demo部署的只有三个pod\n[root@kube-master1 istio-1.7.2]# istioctl manifest install --set profile=demo                        \nDetected that your cluster does not support third party JWT authentication. Falling back to less secure first party JWT. See https:&#47;&#47;istio.io&#47;docs&#47;ops&#47;best-practices&#47;security&#47;#configure-third-party-service-account-tokens for details.\n✔ Istio core installed                                                                                                                                              \n✔ Istiod installed                                                                                                                                                  \n✔ Ingress gateways installed                                                                                                                                        \n✔ Egress gateways installed                                                                                                                                         \n✔ Installation complete                                                                                                                                             [root@kube-master1 istio-1.7.2]# kubectl get pods -n istio-system                                    \nNAME                                    READY   STATUS    RESTARTS   AGE\nistio-egressgateway-fbb7dc4f4-jvt4r     1&#47;1     Running   0          2m9s\nistio-ingressgateway-5f84fcdd69-lkf4m   1&#47;1     Running   0          2m9s\nistiod-77df9b78f8-kthr6                 1&#47;1     Running   0          2m23s\n[root@kube-master1 istio-1.7.2]# ","like_count":0,"discussions":[{"author":{"id":1046394,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/f7/7a/55618020.jpg","nickname":"马若飞","note":"","ucode":"3D0327329A10AE","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":505927,"discussion_content":"1.7就是只有3个：https://istio.io/latest/docs/setup/additional-setup/config-profiles/\n要安装其他组件用这种方式istioctl manifest apply --set addonComponents.grafana.enabled=true\n","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1602232888,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1686247,"avatar":"https://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTIuhXBviaVUj8PEIoAjdmnMMUkzI1xVUvxm2icu3DWkszjmLVkXjKGF2RpAER8ztklyVhTCTvnxxfgQ/132","nickname":"无需昵称","note":"","ucode":"CD0C2D8E611C32","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":319226,"discussion_content":"问题解决了，执行 kubectl apply -f samples/addons -n istio-system 就好！","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1603966448,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1686247,"avatar":"https://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTIuhXBviaVUj8PEIoAjdmnMMUkzI1xVUvxm2icu3DWkszjmLVkXjKGF2RpAER8ztklyVhTCTvnxxfgQ/132","nickname":"无需昵称","note":"","ucode":"CD0C2D8E611C32","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":319199,"discussion_content":"老师，我用着种方式安装了grafana后，再去安装prometheus的时候，结果grafana 又被删掉了，怎么可以同时添加两个呢？","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1603961894,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":244225,"user_name":"会飞的猪少爷","can_delete":false,"product_type":"c3","uid":1102699,"ip_address":"","ucode":"4D1968923152C2","user_header":"https://static001.geekbang.org/account/avatar/00/10/d3/6b/b7df8877.jpg","comment_is_top":false,"comment_ctime":1598434348,"is_pvip":false,"replies":[{"id":89988,"content":"你部署的命令能贴出来看看吗？kubectl apply -f samples&#47;bookinfo&#47;platform&#47;kube&#47;bookinfo.yaml\n是用这个部署的吗？ 你kubectl get all 看看都有什么。\n\n另外pod没有和注入没关系，你这个看上去根本没部署上，或者就是部署到了别的namespace。 建议你都检查一下。具体步骤参考：https:&#47;&#47;istio.io&#47;v1.5&#47;docs&#47;examples&#47;bookinfo&#47;\n","user_name":"作者回复","user_name_real":"马若飞","uid":1046394,"ctime":1598523936,"ip_address":"","comment_id":244225,"utype":1}],"discussion_count":3,"race_medal":0,"score":3,"product_id":100049401,"comment_content":"老师我按照例子进行了部署测试，试验环境是在本地服务器上搭建的，一共开了4个节点，1个master3个node节点，部署的K8S版本是1.18.2，Istio部署的版本是1.5.8，但是在部署bookinfo项目的时候，用命令kubectl get pod始终是No resources found in default namespace.查看了istio-inject也设置了enable，就是查不到pod，能指点一下么，谢谢","like_count":0,"discussions":[{"author":{"id":1046394,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/f7/7a/55618020.jpg","nickname":"马若飞","note":"","ucode":"3D0327329A10AE","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":504526,"discussion_content":"你部署的命令能贴出来看看吗？kubectl apply -f samples/bookinfo/platform/kube/bookinfo.yaml\n是用这个部署的吗？ 你kubectl get all 看看都有什么。\n\n另外pod没有和注入没关系，你这个看上去根本没部署上，或者就是部署到了别的namespace。 建议你都检查一下。具体步骤参考：https://istio.io/v1.5/docs/examples/bookinfo/\n","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1598523936,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":2780736,"avatar":"https://static001.geekbang.org/account/avatar/00/2a/6e/40/88b24990.jpg","nickname":"松饼","note":"","ucode":"86286F3D329483","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":629842,"discussion_content":"我遇到同样问题，看不到pod，原因是k8s版本和istio版本不兼容。可以去官网文档看一下适配的版本。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1697720464,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":"北京","group_id":0},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":2105773,"avatar":"https://static001.geekbang.org/account/avatar/00/20/21/ad/734464b7.jpg","nickname":"jacky","note":"","ucode":"CF3638E2177182","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":349099,"discussion_content":"我也是发现bookinfo的pod看不到，但svc能看到，且deployment的ready都是不可用。后来我将namespace的default的istio-inject label删除了，就能看到pod了，这时deployment的ready是可用了。感觉是加istio-inject label导致的。还在摸索中。你的namespace istio-system上的istio-inject label是disabled吗？我的是","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1612884812,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":243933,"user_name":"java","can_delete":false,"product_type":"c3","uid":1698192,"ip_address":"","ucode":"C79FCDD9B61303","user_header":"https://static001.geekbang.org/account/avatar/00/19/e9/90/0ad18371.jpg","comment_is_top":false,"comment_ctime":1598330996,"is_pvip":false,"replies":[{"id":89892,"content":"这是自动注入失败了，但你给的信息不全,建议按以下步骤查一下：\n1. 确定istio-system下的pod都正常启动；\n2. describe 一下istiod，看看event有什么；\n3. kubectl get namespace -L istio-injection 查一下bookinfo所在ns是否enable了；\n4. 查一下kube-apiserver的log；\n根据官网文档看看是否有对应的情况：https:&#47;&#47;istio.io&#47;latest&#47;zh&#47;docs&#47;ops&#47;common-problems&#47;injection&#47;\n\n另外在istio的issue里也有人说是CNI flannel和calico的问题，你也可以参考下","user_name":"作者回复","user_name_real":"马若飞","uid":1046394,"ctime":1598436468,"ip_address":"","comment_id":243933,"utype":1}],"discussion_count":3,"race_medal":0,"score":3,"product_id":100049401,"comment_content":"请问老师个问题 \n我部署booinfo后,Error creating: Internal error occurred: failed calling webhook &quot;sidecar-injector.istio.io&quot;: Post https:&#47;&#47;istiod.istio-system.svc:443&#47;inject?timeout=30s: dial tcp 10.1.210.113:443: connect: connection timed out\n\n之后按照上面的评论 kubectl -n istio-system rollout restart deployment istiod\n\n但是还是没有启动起来..尴尬\n\nk8s的管控台上显示 \nScaled up replica set productpage-v1-76589d9fdc to 1.","like_count":0,"discussions":[{"author":{"id":1046394,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/f7/7a/55618020.jpg","nickname":"马若飞","note":"","ucode":"3D0327329A10AE","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":504436,"discussion_content":"这是自动注入失败了，但你给的信息不全,建议按以下步骤查一下：\n1. 确定istio-system下的pod都正常启动；\n2. describe 一下istiod，看看event有什么；\n3. kubectl get namespace -L istio-injection 查一下bookinfo所在ns是否enable了；\n4. 查一下kube-apiserver的log；\n根据官网文档看看是否有对应的情况：https://istio.io/latest/zh/docs/ops/common-problems/injection/\n\n另外在istio的issue里也有人说是CNI flannel和calico的问题，你也可以参考下","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1598436468,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1145834,"avatar":"https://static001.geekbang.org/account/avatar/00/11/7b/ea/70bf7e98.jpg","nickname":"Francis","note":"","ucode":"DC3F69EED29A5D","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":307529,"discussion_content":"大佬，你这个问题解决了吗 ？我这边也是这个问题，不知道怎么搞","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1600678018,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1698192,"avatar":"https://static001.geekbang.org/account/avatar/00/19/e9/90/0ad18371.jpg","nickname":"java","note":"","ucode":"C79FCDD9B61303","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":305836,"discussion_content":"手动安装就可以,自动安装就不行... 手动安装没问题,自动就报错.....不知道有没有同学和我一样\n1.pod都是正常启动的\n2.event是空\n3.已经enable\n4.kubectl -n istio-system get pod -listio=sidecar-injector\n命令返回空!! 老师 是这里有问题吗? sidecar-injector需要部署pod吗?\n我安装的weave插件,没有用flannel","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1600093300,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":237735,"user_name":"liang","can_delete":false,"product_type":"c3","uid":1095263,"ip_address":"","ucode":"7A2A1276055E7C","user_header":"https://static001.geekbang.org/account/avatar/00/10/b6/5f/f0d125ca.jpg","comment_is_top":false,"comment_ctime":1595938599,"is_pvip":false,"replies":[{"id":88182,"content":"目前所有组件都整合为一个单体，只有一个进程，一般不需要，控制面不会有太大压力。如果集群规模很大，可以尝试设置多个做负载均衡","user_name":"作者回复","user_name_real":"马若飞","uid":1046394,"ctime":1596280665,"ip_address":"","comment_id":237735,"utype":1}],"discussion_count":1,"race_medal":0,"score":4,"product_id":100049401,"comment_content":"老师您好，想咨询一下isito所有组件是否需要部署高可用多个pods。","like_count":0,"discussions":[{"author":{"id":1046394,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/f7/7a/55618020.jpg","nickname":"马若飞","note":"","ucode":"3D0327329A10AE","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":502521,"discussion_content":"目前所有组件都整合为一个单体，只有一个进程，一般不需要，控制面不会有太大压力。如果集群规模很大，可以尝试设置多个做负载均衡","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1596280665,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":236188,"user_name":"天堂中人","can_delete":false,"product_type":"c3","uid":1742153,"ip_address":"","ucode":"02F11C403873D5","user_header":"http://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTIGFiaPwXdawaw33pJlIQLGvxsly9GGYHPkjicX4Pdz2fiaPnd27C2elcmC6bIiaxmjbsV3AicT3c4Zbyw/132","comment_is_top":false,"comment_ctime":1595340690,"is_pvip":false,"replies":[{"id":87526,"content":"看上去注入标签已经生效了，你看看bookinfo的pod是不是都变成了2&#47;2。\n然后重启下istiod：\nkubectl -n istio-system rollout restart deployment istiod","user_name":"作者回复","user_name_real":"马若飞","uid":1046394,"ctime":1595572466,"ip_address":"","comment_id":236188,"utype":1}],"discussion_count":1,"race_medal":0,"score":4,"product_id":100049401,"comment_content":"请问老师 部署 bookinfo的时候出现以下错误，应该怎么解决 \t\nError creating: Internal error occurred: failed calling webhook &quot;sidecar-injector.istio.io&quot;: Post https:&#47;&#47;istiod.istio-system.svc:443&#47;inject?timeout=30s: context deadline exceeded\n先采用的自动注入，然后报错 \nerror: &#39;istio-injection&#39; already has a value (enabled), and --overwrite is false\n然后采用手工注入。注入完成后依然报错 \n","like_count":0,"discussions":[{"author":{"id":1046394,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/f7/7a/55618020.jpg","nickname":"马若飞","note":"","ucode":"3D0327329A10AE","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":501977,"discussion_content":"看上去注入标签已经生效了，你看看bookinfo的pod是不是都变成了2/2。\n然后重启下istiod：\nkubectl -n istio-system rollout restart deployment istiod","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1595572466,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":231504,"user_name":"周洪","can_delete":false,"product_type":"c3","uid":1098979,"ip_address":"","ucode":"00F877BDF2A594","user_header":"https://static001.geekbang.org/account/avatar/00/10/c4/e3/1075b5cf.jpg","comment_is_top":false,"comment_ctime":1593691219,"is_pvip":false,"replies":[{"id":85717,"content":"你的集群是什么环境？证书过期，可能是节点时间不一致导致。查一下node的date，不一致用ntpdate更新下。网上有相关的解决方案。","user_name":"作者回复","user_name_real":"马若飞","uid":1046394,"ctime":1593951250,"ip_address":"","comment_id":231504,"utype":1}],"discussion_count":3,"race_medal":0,"score":4,"product_id":100049401,"comment_content":"老师，我在跑istio官网的bookinfo demo应用的时候，有时会出现 Error creating: Internal error occurred: failed calling webhook &quot;sidecar-injector.istio.io&quot;: Post https:&#47;&#47;istiod.istio-system.svc:443&#47;inject?timeout=30s: x509: certificate has expired or is not yet valid 这个错误，请问是怎么回事。这个现象是节点不可用之后，重新回复可用之后，replicaset几天总是创建失败，我describe之后看到这个错误日志了","like_count":0,"discussions":[{"author":{"id":1046394,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/f7/7a/55618020.jpg","nickname":"马若飞","note":"","ucode":"3D0327329A10AE","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":500323,"discussion_content":"你的集群是什么环境？证书过期，可能是节点时间不一致导致。查一下node的date，不一致用ntpdate更新下。网上有相关的解决方案。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1593951250,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1098979,"avatar":"https://static001.geekbang.org/account/avatar/00/10/c4/e3/1075b5cf.jpg","nickname":"周洪","note":"","ucode":"00F877BDF2A594","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":289438,"discussion_content":"确实是系统时间不一致的问题，我自己后来发现解决了","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1594100648,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1098979,"avatar":"https://static001.geekbang.org/account/avatar/00/10/c4/e3/1075b5cf.jpg","nickname":"周洪","note":"","ucode":"00F877BDF2A594","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":288275,"discussion_content":"并且我看到istiod里面有这样的日志， http: TLS handshake error from 10.122.241.64:17677: remote error: tls: bad certificate","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1593699422,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":231411,"user_name":"Geek_66dcc6","can_delete":false,"product_type":"c3","uid":1317851,"ip_address":"","ucode":"0EC9C087C5008B","user_header":"","comment_is_top":false,"comment_ctime":1593671213,"is_pvip":false,"replies":[{"id":85714,"content":"local环境不支持三方的jwt，安装的时候加上 \n--set jwtpolicy=first-party-jwt","user_name":"作者回复","user_name_real":"马若飞","uid":1046394,"ctime":1593949684,"ip_address":"","comment_id":231411,"utype":1}],"discussion_count":2,"race_medal":0,"score":4,"product_id":100049401,"comment_content":"老师，有一个问题：\nDetected that your cluster does not support third party JWT authentication. Falling back to less secure first party JWT. See https:&#47;&#47;istio.io&#47;docs&#47;ops&#47;best-practices&#47;security&#47;#configure-third-party-service-account-tokens for details.\n这个应该是serviceaccount 挂载的问题，我的环境是本地的环境\nClient Version: version.Info{Major:&quot;1&quot;, Minor:&quot;13&quot;, GitVersion:&quot;v1.13.0&quot;, GitCommit:&quot;ddf47ac13c1a9483ea035a79cd7c10005ff21a6d&quot;, GitTreeState:&quot;clean&quot;, BuildDate:&quot;2018-12-03T21:04:45Z&quot;, GoVersion:&quot;go1.11.2&quot;, Compiler:&quot;gc&quot;, Platform:&quot;linux&#47;amd64&quot;}\nServer Version: version.Info{Major:&quot;1&quot;, Minor:&quot;17&quot;, GitVersion:&quot;v1.17.4&quot;, GitCommit:&quot;8d8aa39598534325ad77120c120a22b3a990b5ea&quot;, GitTreeState:&quot;clean&quot;, BuildDate:&quot;2020-03-12T20:55:23Z&quot;, GoVersion:&quot;go1.13.8&quot;, Compiler:&quot;gc&quot;, Platform:&quot;linux&#47;amd64&quot;}\n有尝试用错误信息中的链接中所示做，但是没有成功，老师这个是什么问题？","like_count":0,"discussions":[{"author":{"id":1046394,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/f7/7a/55618020.jpg","nickname":"马若飞","note":"","ucode":"3D0327329A10AE","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":500293,"discussion_content":"local环境不支持三方的jwt，安装的时候加上 \n--set jwtpolicy=first-party-jwt","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1593949684,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1317851,"avatar":"","nickname":"Geek_66dcc6","note":"","ucode":"0EC9C087C5008B","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":288974,"discussion_content":"我加上了那条命令了，不过我看老师的安装时候也有这条信息的呢","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1593949803,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":231166,"user_name":"天堂中人","can_delete":false,"product_type":"c3","uid":1742153,"ip_address":"","ucode":"02F11C403873D5","user_header":"http://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTIGFiaPwXdawaw33pJlIQLGvxsly9GGYHPkjicX4Pdz2fiaPnd27C2elcmC6bIiaxmjbsV3AicT3c4Zbyw/132","comment_is_top":false,"comment_ctime":1593598147,"is_pvip":false,"replies":[{"id":85712,"content":"正常啊，这就是demo里所有组件","user_name":"作者回复","user_name_real":"马若飞","uid":1046394,"ctime":1593946010,"ip_address":"","comment_id":231166,"utype":1}],"discussion_count":1,"race_medal":0,"score":4,"product_id":100049401,"comment_content":"老师 我运行安装后 运行kubectl get pods -n istio-system 里面只有七个pods 是怎么回事\n```\n[root@k8s-server-master01-10 istio-1.6.4]# kubectl get pods -n istio-system\nNAME                                   READY   STATUS    RESTARTS   AGE\ngrafana-b54bb57b9-csn5z                1&#47;1     Running   0          3m20s\nistio-egressgateway-85df88d97b-x9r85   1&#47;1     Running   0          3m51s\nistio-ingressgateway-fd7d896bd-pfr28   1&#47;1     Running   0          3m51s\nistio-tracing-9dd6c4f7c-vxp8t          1&#47;1     Running   0          3m20s\nistiod-5dbd57dff8-8cd26                1&#47;1     Running   0          3m55s\nkiali-d45468dc4-fftjc                  1&#47;1     Running   0          3m19s\nprometheus-7bdc59c94d-wj8jn            2&#47;2     Running   0          3m19s\n```","like_count":0,"discussions":[{"author":{"id":1046394,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/f7/7a/55618020.jpg","nickname":"马若飞","note":"","ucode":"3D0327329A10AE","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":500185,"discussion_content":"正常啊，这就是demo里所有组件","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1593946010,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":228823,"user_name":"疯狂埃里克","can_delete":false,"product_type":"c3","uid":1099882,"ip_address":"","ucode":"1BD274519202B0","user_header":"https://static001.geekbang.org/account/avatar/00/10/c8/6a/ab820630.jpg","comment_is_top":false,"comment_ctime":1592818159,"is_pvip":false,"replies":[{"id":84647,"content":"自动注入这样就可以了：kubectl label namespace default istio-injection=enabled\n","user_name":"作者回复","user_name_real":"马若飞","uid":1046394,"ctime":1592985127,"ip_address":"","comment_id":228823,"utype":1}],"discussion_count":1,"race_medal":0,"score":4,"product_id":100049401,"comment_content":"kubectl label namespace default istio-injection=enable --overwrite=true namespace&#47;default labeled\nerror: all resources must be specified before label changes: namespace&#47;default\nistio 1.6.1版本下执行报这个错，请教老师怎么处理","like_count":0,"discussions":[{"author":{"id":1046394,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/f7/7a/55618020.jpg","nickname":"马若飞","note":"","ucode":"3D0327329A10AE","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":499204,"discussion_content":"自动注入这样就可以了：kubectl label namespace default istio-injection=enabled\n","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1592985127,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":228138,"user_name":"小猪","can_delete":false,"product_type":"c3","uid":1201662,"ip_address":"","ucode":"EAD6A4876CEF3B","user_header":"https://static001.geekbang.org/account/avatar/00/12/55/fe/ab541300.jpg","comment_is_top":false,"comment_ctime":1592565268,"is_pvip":false,"replies":[{"id":84653,"content":"加上 --charts 到你改的文件试试。\nhttps:&#47;&#47;istio.io&#47;latest&#47;docs&#47;reference&#47;commands&#47;istioctl&#47;#istioctl-manifest","user_name":"作者回复","user_name_real":"马若飞","uid":1046394,"ctime":1592985570,"ip_address":"","comment_id":228138,"utype":1}],"discussion_count":1,"race_medal":0,"score":4,"product_id":100049401,"comment_content":"老师，我使用本地私有kubernetes集群和私有harbor仓库部署istio，把镜像全部拉到本地harbor仓库。修改istio的manifest.yaml文件里的docker: docker.io&#47;istio为本地仓库，使用istioctl manifest apply --set profile=demo命令部署，但是启动的pod仍然使用外网的镜像名字。如何才能修改让他使用本地镜像呢？","like_count":0,"discussions":[{"author":{"id":1046394,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/f7/7a/55618020.jpg","nickname":"马若飞","note":"","ucode":"3D0327329A10AE","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":498933,"discussion_content":"加上 --charts 到你改的文件试试。\nhttps://istio.io/latest/docs/reference/commands/istioctl/#istioctl-manifest","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1592985570,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":224690,"user_name":"大手小手","can_delete":false,"product_type":"c3","uid":1122498,"ip_address":"","ucode":"F0C0B472FFC94A","user_header":"https://static001.geekbang.org/account/avatar/00/11/20/c2/d3a7399a.jpg","comment_is_top":false,"comment_ctime":1591508768,"is_pvip":false,"replies":[{"id":82778,"content":"安装一次即可","user_name":"作者回复","user_name_real":"马若飞","uid":1046394,"ctime":1591599472,"ip_address":"","comment_id":224690,"utype":1}],"discussion_count":2,"race_medal":0,"score":4,"product_id":100049401,"comment_content":"请问在本地VM中部署 K8S后;是在所有节点安装istio 么?还是只需要在主节点安装部署呢?","like_count":0,"discussions":[{"author":{"id":1046394,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/f7/7a/55618020.jpg","nickname":"马若飞","note":"","ucode":"3D0327329A10AE","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":497570,"discussion_content":"安装一次即可","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1591599472,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1043738,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/ed/1a/269eb3d6.jpg","nickname":"cfanbo","note":"","ucode":"39D8D71453E575","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":384029,"discussion_content":"在哪个节点安装一次，任意节点？","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1626339602,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":223955,"user_name":"小猪","can_delete":false,"product_type":"c3","uid":1201662,"ip_address":"","ucode":"EAD6A4876CEF3B","user_header":"https://static001.geekbang.org/account/avatar/00/12/55/fe/ab541300.jpg","comment_is_top":false,"comment_ctime":1591241301,"is_pvip":false,"replies":[{"id":82577,"content":"修改安装目录下的manifest.yaml文件：\ndocker: docker.io&#47;istio","user_name":"作者回复","user_name_real":"马若飞","uid":1046394,"ctime":1591336502,"ip_address":"","comment_id":223955,"utype":1}],"discussion_count":1,"race_medal":0,"score":4,"product_id":100049401,"comment_content":"部署这个示例时，istio sidecar启动默认是下面的镜像，我想改成默认使用我本地私有harbor库里的对应镜像，请问老师从哪里可以修改这个镜像的默认配置\n\tistio-proxy\t  docker.io&#47;istio&#47;proxyv2:1.5.4\t\n        istio-init    docker.io&#47;istio&#47;proxyv2:1.5.4","like_count":0,"discussions":[{"author":{"id":1046394,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/f7/7a/55618020.jpg","nickname":"马若飞","note":"","ucode":"3D0327329A10AE","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":497313,"discussion_content":"修改安装目录下的manifest.yaml文件：\ndocker: docker.io/istio","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1591336502,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":222564,"user_name":"小猪","can_delete":false,"product_type":"c3","uid":1201662,"ip_address":"","ucode":"EAD6A4876CEF3B","user_header":"https://static001.geekbang.org/account/avatar/00/12/55/fe/ab541300.jpg","comment_is_top":false,"comment_ctime":1590835073,"is_pvip":false,"replies":[{"id":82138,"content":"分布式实验室发了一篇1.6的翻译。也可以看看我发的1.6解读文章，迈向极简主义","user_name":"作者回复","user_name_real":"马若飞","uid":1046394,"ctime":1590915048,"ip_address":"","comment_id":222564,"utype":1}],"discussion_count":1,"race_medal":0,"score":4,"product_id":100049401,"comment_content":"老师能否讲讲目前最新版本istio1.6对比istio1.5的改进和新增功能？","like_count":0,"discussions":[{"author":{"id":1046394,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/f7/7a/55618020.jpg","nickname":"马若飞","note":"","ucode":"3D0327329A10AE","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":496845,"discussion_content":"分布式实验室发了一篇1.6的翻译。也可以看看我发的1.6解读文章，迈向极简主义","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1590915048,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":221396,"user_name":"天堂中人","can_delete":false,"product_type":"c3","uid":1742153,"ip_address":"","ucode":"02F11C403873D5","user_header":"http://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTIGFiaPwXdawaw33pJlIQLGvxsly9GGYHPkjicX4Pdz2fiaPnd27C2elcmC6bIiaxmjbsV3AicT3c4Zbyw/132","comment_is_top":false,"comment_ctime":1590490686,"is_pvip":false,"replies":[{"id":81820,"content":"安装命令是什么？你先执行 istioctl verify-install看看集群环境有没有不合条件的","user_name":"作者回复","user_name_real":"马若飞","uid":1046394,"ctime":1590641335,"ip_address":"","comment_id":221396,"utype":1}],"discussion_count":2,"race_medal":0,"score":5,"product_id":100049401,"comment_content":"安装的时候 出现以下错误 版本是1.6.0\n\n Egress gateways encountered an error: failed to wait for resource: resources not ready after 5m0s: timed out waiting for the condition\nDeployment&#47;istio-system&#47;istio-egressgateway\n✘ Ingress gateways encountered an error: failed to wait for resource: resources not ready after 5m0s: timed out waiting for the condition\nDeployment&#47;istio-system&#47;istio-ingressgateway\n","like_count":0,"discussions":[{"author":{"id":1046394,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/f7/7a/55618020.jpg","nickname":"马若飞","note":"","ucode":"3D0327329A10AE","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":496444,"discussion_content":"安装命令是什么？你先执行 istioctl verify-install看看集群环境有没有不合条件的","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1590641335,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":1,"child_discussions":[{"author":{"id":2057873,"avatar":"","nickname":"Geek_ce83de","note":"","ucode":"CAF38034F3186C","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":1046394,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/f7/7a/55618020.jpg","nickname":"马若飞","note":"","ucode":"3D0327329A10AE","race_medal":0,"user_type":2,"is_pvip":false},"discussion":{"id":596414,"discussion_content":"老师，我也遇到一样的问题，好久了，麻烦问下可能什么原因\n\n[root@k8s-master-102 istio-1.12.1]# istioctl verify-install\n2 Istio control planes detected, checking --revision &#34;default&#34; only\nerror while fetching revision : control plane revision &#34;&#34; not found\n1 Istio injectors detected\nError: Istio present but verify-install needs an IstioOperator or manifest for comparison. Supply flag --filename &lt;yaml&gt;\n[root@k8s-master-102 istio-1.12.1]# istioctl install --set profile=demo --set values.global.jwtPolicy=first-party-jwt\nDetected that your cluster does not support third party JWT authentication. Falling back to less secure first party JWT. See https://istio.io/v1.12/docs/ops/best-practices/security/#configure-third-party-service-account-tokens for details.\n! values.global.jwtPolicy is deprecated; use Values.global.jwtPolicy=third-party-jwt. See http://istio.io/latest/docs/ops/best-practices/security/#configure-third-party-service-account-tokens for more information instead\nThis will install the Istio 1.12.1 demo profile with [&#34;Istio core&#34; &#34;Istiod&#34; &#34;Ingress gateways&#34; &#34;Egress gateways&#34;] components into the cluster. Proceed? (y/N) y\n✔ Istio core installed\n✘ Istiod encountered an error: failed to wait for resource: resources not ready after 5m0s: timed out waiting for the condition\n  Deployment/istio-system/istiod (container failed to start: ImagePullBackOff: Back-off pulling image &#34;docker.io/istio/pilot:1.12.1&#34;)\n- Processing resources for Egress gateways, Ingress gateways. Waiting for Deployment/istio-system/istio-egressgateway, Deplo...","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1670952339,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":496444,"ip_address":"广东","group_id":0},"score":596414,"extra":""}]}]},{"had_liked":false,"id":221180,"user_name":"光","can_delete":false,"product_type":"c3","uid":1284618,"ip_address":"","ucode":"BDA7F41566E4FE","user_header":"https://static001.geekbang.org/account/avatar/00/13/9a/0a/6c74e932.jpg","comment_is_top":false,"comment_ctime":1590421344,"is_pvip":false,"replies":[{"id":81672,"content":"公有云的话可以提工单让他们帮忙看看。\n没遇到过这个错误，不过感觉像是没有权限导致，可能与ServiceAccount、 RBAC没有创建或者不合理有关。","user_name":"作者回复","user_name_real":"马若飞","uid":1046394,"ctime":1590508740,"ip_address":"","comment_id":221180,"utype":1}],"discussion_count":3,"race_medal":0,"score":5,"product_id":100049401,"comment_content":"我现在安装istio 出现了个问题。\n环境是阿里云K8S 1.16 版本的。\n问题： \nistio 版本1.6 的：.&#47;bin&#47;istioctl verify-install  安装检查时候出现：Error: could not load IstioOperator from cluster: the server could not find the requested resource.  Use --filename\n查了些资料没有头绪。而且我用istio 1.5.x 版本，这个步骤又是正常的。希望老师可以给点思路。","like_count":0,"discussions":[{"author":{"id":1046394,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/f7/7a/55618020.jpg","nickname":"马若飞","note":"","ucode":"3D0327329A10AE","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":496373,"discussion_content":"公有云的话可以提工单让他们帮忙看看。\n没遇到过这个错误，不过感觉像是没有权限导致，可能与ServiceAccount、 RBAC没有创建或者不合理有关。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1590508740,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1284618,"avatar":"https://static001.geekbang.org/account/avatar/00/13/9a/0a/6c74e932.jpg","nickname":"光","note":"","ucode":"BDA7F41566E4FE","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":277588,"discussion_content":"In 1.5.x and earlier, &#34;istioctl verify-install&#34; did two things. If it had an argument it verified that Istio was installed, if it didn&#39;t it verified if Istio could be installed.\n\nThis doesn&#39;t work for multiple control planes and was confusing.\n\nWith this PR:\nWe now have &#34;istioctl x precheck&#34;, which does the existing pre-Istio-install cluster compatibility check.\nThe existing check now supports multiple control planes -- you can ask if your cluster is compatible with an IOP, even if Istio is already installed.\nThe existing &#34;istioctl verify-install&#34; does not do pre-install check.\n\nThis is just the basic support. We don&#39;t check compatibility with the IOP flags except for &#34;revision&#34; and &#34;namespace&#34;. We don&#39;t support --set to modify the IOP being checked. If there is interest I will do those in a follow-up.","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1591075728,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1284618,"avatar":"https://static001.geekbang.org/account/avatar/00/13/9a/0a/6c74e932.jpg","nickname":"光","note":"","ucode":"BDA7F41566E4FE","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":277586,"discussion_content":"我查了下1.6这里改成另外一个命令./istioctl experimental precheck","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1591075298,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":219527,"user_name":"K.","can_delete":false,"product_type":"c3","uid":1954559,"ip_address":"","ucode":"B387B48E579309","user_header":"http://thirdwx.qlogo.cn/mmopen/vi_32/UWgaH51h9hqyiaC32ayibwwaHBo4sphYibbsMcwRmBh66JWc1eicADxgibnVLcibdyw1fdMQeibrCicuZEyIUUQfycn4RA/132","comment_is_top":false,"comment_ctime":1590036416,"is_pvip":false,"replies":[{"id":81821,"content":"进去报错的pod，查看一下event里的错是什么\nkubectl describe pod 名字 ","user_name":"作者回复","user_name_real":"马若飞","uid":1046394,"ctime":1590641432,"ip_address":"","comment_id":219527,"utype":1}],"discussion_count":1,"race_medal":0,"score":5,"product_id":100049401,"comment_content":"老师，我在部署bookinfo的时候提示init:crashloopbackoff","like_count":0,"discussions":[{"author":{"id":1046394,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/f7/7a/55618020.jpg","nickname":"马若飞","note":"","ucode":"3D0327329A10AE","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":495841,"discussion_content":"进去报错的pod，查看一下event里的错是什么\nkubectl describe pod 名字 ","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1590641432,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":219146,"user_name":"k8svip","can_delete":false,"product_type":"c3","uid":1043470,"ip_address":"","ucode":"89F02243735432","user_header":"https://static001.geekbang.org/account/avatar/00/0f/ec/0e/d64d4663.jpg","comment_is_top":false,"comment_ctime":1589955528,"is_pvip":false,"replies":[{"id":81070,"content":"是不是本地的k8s环境？可能是token挂载失败，尝试重新安装一下，加上这个参数：--set values.global.jwtPolicy=first-party-jwt","user_name":"作者回复","user_name_real":"马若飞","uid":1046394,"ctime":1590037353,"ip_address":"","comment_id":219146,"utype":1}],"discussion_count":1,"race_medal":0,"score":5,"product_id":100049401,"comment_content":"[root@master01 istio]# kubectl describe pods istiod-f898d89b4-d7x8r -n istio-system\n.......\nNormal   Scheduled    13m                   default-scheduler  Successfully assigned istio-system&#47;istiod-f898d89b4-d7x8r to node01\n  Warning  FailedMount  7m17s                 kubelet, node01    Unable to attach or mount volumes: unmounted volumes=[istio-token], unattached volumes=[istio-pilot-service-account-token-46vgl config-volume istio-token local-certs cacerts inject istiod]: timed out waiting for the condition\n  Warning  FailedMount  5m1s (x2 over 9m31s)  kubelet, node01    Unable to attach or mount volumes: unmounted volumes=[istio-token], unattached volumes=[config-volume istio-token local-certs cacerts inject istiod istio-pilot-service-account-token-46vgl]: timed out waiting for the condition\n  Warning  FailedMount  2m47s (x2 over 11m)   kubelet, node01    Unable to attach or mount volumes: unmounted volumes=[istio-token], unattached volumes=[cacerts inject istiod istio-pilot-service-account-token-46vgl config-volume istio-token local-certs]: timed out waiting for the condition\n  Warning  FailedMount  91s (x14 over 13m)    kubelet, node01    MountVolume.SetUp failed for volume &quot;istio-token&quot; : failed to fetch token: the server could not find the requested resource\n  Warning  FailedMount  29s                   kubelet, node01    Unable to attach or mount volumes: unmounted volumes=[istio-token], unattached volumes=[istiod istio-pilot-service-account-token-46vgl config-volume istio-token local-certs cacerts inject]: timed out waiting for the condition\n\n老师这是怎么回事？","like_count":0,"discussions":[{"author":{"id":1046394,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/f7/7a/55618020.jpg","nickname":"马若飞","note":"","ucode":"3D0327329A10AE","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":495697,"discussion_content":"是不是本地的k8s环境？可能是token挂载失败，尝试重新安装一下，加上这个参数：--set values.global.jwtPolicy=first-party-jwt","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1590037353,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":214948,"user_name":"yuwenyutian","can_delete":false,"product_type":"c3","uid":1951985,"ip_address":"","ucode":"759704A717E9B8","user_header":"","comment_is_top":false,"comment_ctime":1588855617,"is_pvip":false,"replies":[{"id":79671,"content":"什么系统，linux吗？试试安一下这个：apt install xdg-utils","user_name":"作者回复","user_name_real":"马若飞","uid":1046394,"ctime":1588948637,"ip_address":"","comment_id":214948,"utype":1}],"discussion_count":2,"race_medal":0,"score":5,"product_id":100049401,"comment_content":"初始安装完istio进行检查\n打开kiali dashboard，打开不了浏览器，是什么问题？\n[root@master istio-1.5.2]# istioctl dashboard  kiali\nhttp:&#47;&#47;localhost:20001&#47;kiali\nFailed to open browser; open http:&#47;&#47;localhost:20001&#47;kiali in your browser.","like_count":0,"discussions":[{"author":{"id":1046394,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/f7/7a/55618020.jpg","nickname":"马若飞","note":"","ucode":"3D0327329A10AE","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":494253,"discussion_content":"什么系统，linux吗？试试安一下这个：apt install xdg-utils","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1588948637,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1940377,"avatar":"https://static001.geekbang.org/account/avatar/00/1d/9b/99/883c7244.jpg","nickname":"谭婧杰","note":"","ucode":"FC9531E3142FDA","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":299047,"discussion_content":"我按老师的下了 xdg-utils 错是不报了 但是访问不了\n","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1597545552,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":213398,"user_name":"一卡","can_delete":false,"product_type":"c3","uid":1326027,"ip_address":"","ucode":"45FA21D22F17E9","user_header":"https://static001.geekbang.org/account/avatar/00/14/3b/cb/9db2c6c0.jpg","comment_is_top":false,"comment_ctime":1588402266,"is_pvip":false,"replies":[{"id":79149,"content":"gateway 的配置执行了吗","user_name":"作者回复","user_name_real":"马若飞","uid":1046394,"ctime":1588423989,"ip_address":"","comment_id":213398,"utype":1}],"discussion_count":3,"race_medal":0,"score":5,"product_id":100049401,"comment_content":"老师还有那个http:&#47;&#47;localhost&#47;productpage访问不了，不知道怎么回事","like_count":0,"discussions":[{"author":{"id":1046394,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/f7/7a/55618020.jpg","nickname":"马若飞","note":"","ucode":"3D0327329A10AE","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":493767,"discussion_content":"gateway 的配置执行了吗","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1588423989,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1326027,"avatar":"https://static001.geekbang.org/account/avatar/00/14/3b/cb/9db2c6c0.jpg","nickname":"一卡","note":"","ucode":"45FA21D22F17E9","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":255863,"discussion_content":"执行了，不过我在playground里安装的，你说的那个选择view host on page，我不知道在哪里设置","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1588430523,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1326027,"avatar":"https://static001.geekbang.org/account/avatar/00/14/3b/cb/9db2c6c0.jpg","nickname":"一卡","note":"","ucode":"45FA21D22F17E9","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":255484,"discussion_content":"还有第一次sidecar忘记自动注入了，后面再敲那个命令就不行了，怎么办？","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1588404639,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":210801,"user_name":"路上的小崔哥","can_delete":false,"product_type":"c3","uid":1824856,"ip_address":"","ucode":"5E887E82E7581C","user_header":"http://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTIo6NhMeI7wDLw8blkCOklsJmNQc67L3LfHxvdtjACJztGbr7RSUFHicNnajHEWXbwKulAhbHUz7tw/132","comment_is_top":false,"comment_ctime":1587826608,"is_pvip":false,"replies":[{"id":78503,"content":"国内网络问题，只能翻墙了。。。","user_name":"作者回复","user_name_real":"马若飞","uid":1046394,"ctime":1587894996,"ip_address":"","comment_id":210801,"utype":1}],"discussion_count":2,"race_medal":0,"score":5,"product_id":100049401,"comment_content":"老师你好，我在安装istio过程中（执行了 `istioctl manifest apply --set profile=demo` 命令），之后会一直有 `Waiting for resources to become ready...` 这样的日志刷出来直到超时。请问下这个他在等待什么资源呢，另外要怎么解决呢？（我是在本地安装了minikube的）","like_count":0,"discussions":[{"author":{"id":1046394,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/f7/7a/55618020.jpg","nickname":"马若飞","note":"","ucode":"3D0327329A10AE","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":493112,"discussion_content":"国内网络问题，只能翻墙了。。。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1587894996,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":2057873,"avatar":"","nickname":"Geek_ce83de","note":"","ucode":"CAF38034F3186C","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":596420,"discussion_content":"[root@k8s-master-102 istio-1.12.1]# istioctl manifest apply --set profile=demo --charts=/kingdom/istio-1.12.1/manifests/ --set values.gateways.istio-ingressgateway.type=NodePort --set values.global.jwtPolicy=first-party-jwt\nDetected that your cluster does not support third party JWT authentication. Falling back to less secure first party JWT. See https://istio.io/v1.12/docs/ops/best-practices/security/#configure-third-party-service-account-tokens for details.\n! values.global.jwtPolicy is deprecated; use Values.global.jwtPolicy=third-party-jwt. See http://istio.io/latest/docs/ops/best-practices/security/#configure-third-party-service-account-tokens for more information instead\nThis will install the Istio 1.12.1 demo profile with [&#34;Istio core&#34; &#34;Istiod&#34; &#34;Ingress gateways&#34; &#34;Egress gateways&#34;] components into the cluster. Proceed? (y/N) y\n✔ Istio core installed\n✘ Istiod encountered an error: failed to wait for resource: resources not ready after 5m0s: timed out waiting for the condition\n  Deployment/istio-system/istiod (container failed to start: ImagePullBackOff: Back-off pulling image &#34;docker.io/istio/pilot:1.12.1&#34;)\n  Processing resources for Egress gateways, Ingress gateways. Waiting for Deployment/istio-system/istio-egressgateway, Deplo...\n\n请问这个也是网络问题吗？","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1670953041,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":"广东","group_id":0},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":210591,"user_name":"LindaWang","can_delete":false,"product_type":"c3","uid":1800128,"ip_address":"","ucode":"45368868C3980B","user_header":"https://static001.geekbang.org/account/avatar/00/1b/77/c0/22872965.jpg","comment_is_top":false,"comment_ctime":1587793120,"is_pvip":false,"replies":[{"id":78425,"content":"点击console页标签的加号，有 view http port on host 这样的选择，会打开一个对外暴露的网页，网址类似：https:&#47;&#47;2886795275-8080-ollie07.environments.katacoda.com&#47;。把中间的8080端口改成80，最后加上productpage就可以访问了。\n不过katacoda的网络不太稳定，时不时就不能用。建议有条件还在本地测试。","user_name":"作者回复","user_name_real":"马若飞","uid":1046394,"ctime":1587806584,"ip_address":"","comment_id":210591,"utype":1}],"discussion_count":2,"race_medal":0,"score":5,"product_id":100049401,"comment_content":"在katacoda上部署bookinfo sample，是不是没法通过网页去访问呢？","like_count":0,"discussions":[{"author":{"id":1046394,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/f7/7a/55618020.jpg","nickname":"马若飞","note":"","ucode":"3D0327329A10AE","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":493062,"discussion_content":"点击console页标签的加号，有 view http port on host 这样的选择，会打开一个对外暴露的网页，网址类似：https://2886795275-8080-ollie07.environments.katacoda.com/。把中间的8080端口改成80，最后加上productpage就可以访问了。\n不过katacoda的网络不太稳定，时不时就不能用。建议有条件还在本地测试。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1587806584,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1326027,"avatar":"https://static001.geekbang.org/account/avatar/00/14/3b/cb/9db2c6c0.jpg","nickname":"一卡","note":"","ucode":"45FA21D22F17E9","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":255527,"discussion_content":"请问这个在哪里设置，我找不到哇？\n： 点击console页标签的加号，有 view http port on host 这样的选择","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1588408241,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":210586,"user_name":"LindaWang","can_delete":false,"product_type":"c3","uid":1800128,"ip_address":"","ucode":"45368868C3980B","user_header":"https://static001.geekbang.org/account/avatar/00/1b/77/c0/22872965.jpg","comment_is_top":false,"comment_ctime":1587792352,"is_pvip":false,"replies":[{"id":78426,"content":"这个我没试过。用另外一个回复中教你的试试看。道理相同","user_name":"作者回复","user_name_real":"马若飞","uid":1046394,"ctime":1587806678,"ip_address":"","comment_id":210586,"utype":1}],"discussion_count":3,"race_medal":0,"score":5,"product_id":100049401,"comment_content":"老师，使用katacoda 是不是无法查看dashboard呢？\nmaster $ istioctl dashboard kiali\nhttp:&#47;&#47;localhost:20001&#47;kiali\nFailed to open browser; open http:&#47;&#47;localhost:20001&#47;kiali in your browser. 手动也是打不开的","like_count":0,"discussions":[{"author":{"id":1046394,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/f7/7a/55618020.jpg","nickname":"马若飞","note":"","ucode":"3D0327329A10AE","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":493059,"discussion_content":"这个我没试过。用另外一个回复中教你的试试看。道理相同","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1587806678,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1351023,"avatar":"https://static001.geekbang.org/account/avatar/00/14/9d/6f/bc1e5108.jpg","nickname":"吴封斌","note":"","ucode":"1E970AAC279F05","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":379011,"discussion_content":"我的报错和你一样，如何解决？谢谢","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1623589256,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1951985,"avatar":"","nickname":"yuwenyutian","note":"","ucode":"759704A717E9B8","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":260220,"discussion_content":"我的报错和你一样，如何解决？","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1588855705,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":213137,"user_name":"hhhh","can_delete":false,"product_type":"c3","uid":1256101,"ip_address":"","ucode":"9E87017424B382","user_header":"https://static001.geekbang.org/account/avatar/00/13/2a/a5/625c0a2e.jpg","comment_is_top":false,"comment_ctime":1588310644,"is_pvip":false,"replies":null,"discussion_count":0,"race_medal":0,"score":5,"product_id":100049401,"comment_content":"使用windows docker desktop安装kubernetes，可以参考阿里云提供的这个方法：https:&#47;&#47;github.com&#47;AliyunContainerService&#47;k8s-for-docker-desktop，解决拉镜像的问题。","like_count":2},{"had_liked":false,"id":349497,"user_name":"半缘君","can_delete":false,"product_type":"c3","uid":1140265,"ip_address":"","ucode":"1266C4E35180A2","user_header":"https://static001.geekbang.org/account/avatar/00/11/66/29/8b471f9d.jpg","comment_is_top":false,"comment_ctime":1655998405,"is_pvip":false,"replies":null,"discussion_count":0,"race_medal":0,"score":6,"product_id":100049401,"comment_content":"搭一个环境要半条命~","like_count":1},{"had_liked":false,"id":340737,"user_name":"Sam Fu","can_delete":false,"product_type":"c3","uid":1112676,"ip_address":"","ucode":"EA285A4943271F","user_header":"https://static001.geekbang.org/account/avatar/00/10/fa/64/457325e6.jpg","comment_is_top":false,"comment_ctime":1649087335,"is_pvip":false,"replies":null,"discussion_count":1,"race_medal":0,"score":6,"product_id":100049401,"comment_content":"1. 安装istio\n整个安装过程可以参考[https:&#47;&#47;juejin.cn&#47;post&#47;6991461413721997320]\n\n2. 安装demo profile\nistioctl manifest install --set profile=demo\n\n3. 安装 istio Dashboard安装\nkubectl apply -f samples&#47;addons\nkubectl proxy\nistioctl dashboard kiali\n\n4. 部署BookInfo\n4.1. 注入sidecar\nkubectl label namespace default istio-injection=enabled --overwrite=true\n4.2. 部署应用\nkubectl apply -f samples&#47;bookinfo&#47;platform&#47;kube&#47;bookinfo.yaml\n4.3. 创建 Ingress 网关\nkubectl apply -f samples&#47;bookinfo&#47;networking&#47;bookinfo-gateway.yaml\n访问bookinfo: http:&#47;&#47;localhost&#47;productpage","like_count":1,"discussions":[{"author":{"id":1222354,"avatar":"https://static001.geekbang.org/account/avatar/00/12/a6/d2/ebe20bb5.jpg","nickname":"阿棠","note":"","ucode":"4C62FF98BCD925","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":587359,"discussion_content":"你能使用http://localhost/productpage访问吗？","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1662992820,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":"广东","group_id":0},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":331970,"user_name":"阿尔伯特波","can_delete":false,"product_type":"c3","uid":2876787,"ip_address":"","ucode":"60B86EE085190D","user_header":"https://static001.geekbang.org/account/avatar/00/2b/e5/73/622e9438.jpg","comment_is_top":false,"comment_ctime":1642928737,"is_pvip":false,"replies":null,"discussion_count":13,"race_medal":0,"score":6,"product_id":100049401,"comment_content":"在k8s集群上安装istio，k8s版本是1.18，安装的istio版本是1.12.2，完全是按照官方文档来的，但是失败了好多次:\n``` \n[root@k8s-master ~]# istioctl install --set profile=demo -y\nDetected that your cluster does not support third party JWT authentication. Falling back to less secure first party JWT. See https:&#47;&#47;istio.io&#47;v1.12&#47;docs&#47;ops&#47;best-practices&#47;security&#47;#configure-third-party-service-account-tokens for details.\n! values.global.jwtPolicy is deprecated; use Values.global.jwtPolicy=third-party-jwt. See http:&#47;&#47;istio.io&#47;latest&#47;docs&#47;ops&#47;best-practices&#47;security&#47;#configure-third-party-service-account-tokens for more information instead\n✔ Istio core installed\n✔ Istiod installed\n✘ Egress gateways encountered an error: failed to wait for resource: resources not ready after 5m0s: timed out waiting for the conditionsystem&#47;istio-ingressgateway\n  Deployment&#47;istio-system&#47;istio-egressgateway (containers with unready status: [istio-proxy])\n✘ Ingress gateways encountered an error: failed to wait for resource: resources not ready after 5m0s: timed out waiting for the condition\n  Deployment&#47;istio-system&#47;istio-ingressgateway (containers with unready status: [istio-proxy])\n- Pruning removed resources                                                                                                                                                                                   Error: failed to install manifests: errors occurred during operation\n```\n大佬能帮忙看看吗？","like_count":1,"discussions":[{"author":{"id":2057873,"avatar":"","nickname":"Geek_ce83de","note":"","ucode":"CAF38034F3186C","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":596415,"discussion_content":"请问这个问题解决了吗","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1670952412,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":"广东","group_id":0},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":2903993,"avatar":"","nickname":"Geek_d41283","note":"","ucode":"704FEBC7B04997","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":586048,"discussion_content":"你好 我内存是32G的 然后用的是amd的也是这个错 有一样的吗","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1661946932,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":"四川","group_id":0},"score":2,"extra":"","child_discussion_number":1,"child_discussions":[{"author":{"id":2057873,"avatar":"","nickname":"Geek_ce83de","note":"","ucode":"CAF38034F3186C","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":2903993,"avatar":"","nickname":"Geek_d41283","note":"","ucode":"704FEBC7B04997","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":596417,"discussion_content":"你好，请问你解决了吗","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1670952490,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":586048,"ip_address":"广东","group_id":0},"score":596417,"extra":""}]},{"author":{"id":2536298,"avatar":"https://static001.geekbang.org/account/avatar/00/26/b3/6a/eb6f9010.jpg","nickname":"当下","note":"","ucode":"F3A63634B1F5FB","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":584747,"discussion_content":"有可能是虚拟机内存不足 https://stackoverflow.com/questions/64373346/istioctl-install-fails-with-multiple-timeouts/64470097#64470097","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1661079071,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":"广东","group_id":0},"score":2,"extra":"","child_discussion_number":1,"child_discussions":[{"author":{"id":2057873,"avatar":"","nickname":"Geek_ce83de","note":"","ucode":"CAF38034F3186C","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":2536298,"avatar":"https://static001.geekbang.org/account/avatar/00/26/b3/6a/eb6f9010.jpg","nickname":"当下","note":"","ucode":"F3A63634B1F5FB","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":596418,"discussion_content":"16G够不","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1670952717,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":584747,"ip_address":"广东","group_id":0},"score":596418,"extra":""}]},{"author":{"id":1354850,"avatar":"https://static001.geekbang.org/account/avatar/00/14/ac/62/37912d51.jpg","nickname":"东方奇骥","note":"","ucode":"DEE7085F7E55A4","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":571363,"discussion_content":"你好，解决了吗？我也遇到了这个问题","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1652183345,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"","child_discussion_number":1,"child_discussions":[{"author":{"id":2057873,"avatar":"","nickname":"Geek_ce83de","note":"","ucode":"CAF38034F3186C","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":1354850,"avatar":"https://static001.geekbang.org/account/avatar/00/14/ac/62/37912d51.jpg","nickname":"东方奇骥","note":"","ucode":"DEE7085F7E55A4","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":596419,"discussion_content":"请问你解决了吗","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1670952736,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":571363,"ip_address":"广东","group_id":0},"score":596419,"extra":""}]},{"author":{"id":1130122,"avatar":"https://static001.geekbang.org/account/avatar/00/11/3e/8a/891b0e58.jpg","nickname":"wnz27","note":"","ucode":"BC9ACB6B7C6FD9","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":550806,"discussion_content":"我这的我知道了，我是因为arm64的原因，你看你CPU架构，我给官方提了个issue，他们不支持arm","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1644740482,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1130122,"avatar":"https://static001.geekbang.org/account/avatar/00/11/3e/8a/891b0e58.jpg","nickname":"wnz27","note":"","ucode":"BC9ACB6B7C6FD9","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":550125,"discussion_content":"老师能给回复一下么，找了社区感觉也不知道在说啥","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1644391122,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1130122,"avatar":"https://static001.geekbang.org/account/avatar/00/11/3e/8a/891b0e58.jpg","nickname":"wnz27","note":"","ucode":"BC9ACB6B7C6FD9","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":550124,"discussion_content":"verify-install 之后我的原因是这个：exceeded its progress deadline","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1644391056,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1130122,"avatar":"https://static001.geekbang.org/account/avatar/00/11/3e/8a/891b0e58.jpg","nickname":"wnz27","note":"","ucode":"BC9ACB6B7C6FD9","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":550123,"discussion_content":"一样，","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1644391034,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"","child_discussion_number":2,"child_discussions":[{"author":{"id":2057873,"avatar":"","nickname":"Geek_ce83de","note":"","ucode":"CAF38034F3186C","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":1130122,"avatar":"https://static001.geekbang.org/account/avatar/00/11/3e/8a/891b0e58.jpg","nickname":"wnz27","note":"","ucode":"BC9ACB6B7C6FD9","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":596416,"discussion_content":"请问这个问题解决了吗","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1670952421,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":550123,"ip_address":"广东","group_id":0},"score":596416,"extra":""},{"author":{"id":1130122,"avatar":"https://static001.geekbang.org/account/avatar/00/11/3e/8a/891b0e58.jpg","nickname":"wnz27","note":"","ucode":"BC9ACB6B7C6FD9","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":2057873,"avatar":"","nickname":"Geek_ce83de","note":"","ucode":"CAF38034F3186C","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":600226,"discussion_content":"我是cpu架构问题，我换了个机器就好了，看我后面20号的留言","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1674121007,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":596416,"ip_address":"重庆","group_id":0},"score":600226,"extra":""}]}]},{"had_liked":false,"id":381589,"user_name":"写给三月","can_delete":false,"product_type":"c3","uid":1214026,"ip_address":"山东","ucode":"F9DCF7C9B76AC5","user_header":"https://static001.geekbang.org/account/avatar/00/12/86/4a/0370f832.jpg","comment_is_top":false,"comment_ctime":1695479638,"is_pvip":false,"replies":null,"discussion_count":0,"race_medal":0,"score":6,"product_id":100049401,"comment_content":"老师，我看不懂你的localhost&#47;productpage 这个，你是怎么配置的？","like_count":0},{"had_liked":false,"id":381498,"user_name":"9527","can_delete":false,"product_type":"c3","uid":1072765,"ip_address":"江苏","ucode":"9EE129A1AA306B","user_header":"https://static001.geekbang.org/account/avatar/00/10/5e/7d/ec2fc152.jpg","comment_is_top":false,"comment_ctime":1695295289,"is_pvip":false,"replies":null,"discussion_count":0,"race_medal":0,"score":6,"product_id":100049401,"comment_content":"老师，我是在 Kind 里面安装的，已经配置了 静态路由，两个集群可以互相通信。 \n然后根据 https:&#47;&#47;istio.io&#47;latest&#47;zh&#47;docs&#47;setup&#47;install&#47;multicluster&#47;primary-remote_multi-network&#47; 这个文档部署到最后一步 `开放 cluster2 中的服务` 的时候，报错：\nerror: resource mapping not found for name: &quot;cross-network-gateway&quot; namespace: &quot;&quot; from &quot;samples&#47;multicluster&#47;expose-services.yaml&quot;: no matches for kind &quot;Gateway&quot; in version &quot;networking.istio.io&#47;v1alpha3&quot;\nensure CRDs are installed first\n\n这个文档是跨网络部署主从模式的 istio，在从集群没有看到相关的 crd 或者 apiservice","like_count":0},{"had_liked":false,"id":380770,"user_name":"吃鸡不费力","can_delete":false,"product_type":"c3","uid":1593429,"ip_address":"广东","ucode":"0C019B225FDA5B","user_header":"https://static001.geekbang.org/account/avatar/00/18/50/55/a2d97a96.jpg","comment_is_top":false,"comment_ctime":1694118116,"is_pvip":false,"replies":null,"discussion_count":1,"race_medal":0,"score":6,"product_id":100049401,"comment_content":"老师，我是在本地的多台虚拟机用k3s搭建的集群，按您的操作运行了bookinfo后访问productpage出现404，输入kubectl get ing没有查到网关，请问istio的网关要怎么查","like_count":0,"discussions":[{"author":{"id":1593429,"avatar":"https://static001.geekbang.org/account/avatar/00/18/50/55/a2d97a96.jpg","nickname":"吃鸡不费力","note":"","ucode":"0C019B225FDA5B","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":627407,"discussion_content":"按照官网上的操作external-ip处于pending状态，则可以使用节点端口代替，最终访问正确。\nq1:这里的节点端口是指k8s集群的work node吗\nq2:为什么会没有外部负载均衡器，是不是需要另外装一个","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1694119889,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":"广东","group_id":0},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":380769,"user_name":"吃鸡不费力","can_delete":false,"product_type":"c3","uid":1593429,"ip_address":"广东","ucode":"0C019B225FDA5B","user_header":"https://static001.geekbang.org/account/avatar/00/18/50/55/a2d97a96.jpg","comment_is_top":false,"comment_ctime":1694113832,"is_pvip":false,"replies":null,"discussion_count":0,"race_medal":0,"score":6,"product_id":100049401,"comment_content":"对istio版本有一些疑惑，我看评论区都有1.9的版本可是我进去github发现安装的版本最新只有1.19.0","like_count":0},{"had_liked":false,"id":362778,"user_name":"zhou","can_delete":false,"product_type":"c3","uid":1087243,"ip_address":"浙江","ucode":"E1CE8575B3F106","user_header":"https://static001.geekbang.org/account/avatar/00/10/97/0b/a943bcb3.jpg","comment_is_top":false,"comment_ctime":1668868870,"is_pvip":false,"replies":null,"discussion_count":0,"race_medal":0,"score":6,"product_id":100049401,"comment_content":"执行 kubectl apply -f samples&#47;bookinfo&#47;networking&#47;bookinfo-gateway.yaml，提示：\nError from server (InternalError): error when creating &quot;samples&#47;bookinfo&#47;networking&#47;bookinfo-gateway.yaml&quot;: Internal error occurred: failed calling webhook &quot;validation.istio.io&quot;: failed to call webhook: Post &quot;https:&#47;&#47;istiod.istio-system.svc:443&#47;validate?timeout=10s&quot;: dial tcp 10.106.183.154:443: connect: connection refused","like_count":0},{"had_liked":false,"id":357149,"user_name":"阿棠","can_delete":false,"product_type":"c3","uid":1222354,"ip_address":"广东","ucode":"4C62FF98BCD925","user_header":"https://static001.geekbang.org/account/avatar/00/12/a6/d2/ebe20bb5.jpg","comment_is_top":false,"comment_ctime":1662993331,"is_pvip":false,"replies":null,"discussion_count":0,"race_medal":0,"score":6,"product_id":100049401,"comment_content":"老师，http:&#47;&#47;localhost&#47;productpage无法访问，要做什么配置吗？\nminikube: v1.25.2\nkubernetes: v1.22.12\nistio: v1.12.9\n按照官网的方式，这2步都执行了，\nkubectl apply -f samples&#47;bookinfo&#47;platform&#47;kube&#47;bookinfo.yaml\nkubectl apply -f samples&#47;bookinfo&#47;networking&#47;bookinfo-gateway.yaml\n可以通过echo &quot;http:&#47;&#47;$GATEWAY_URL&#47;productpage&quot;这个地址访问，\n但是不能像你那样通过http:&#47;&#47;localhost&#47;productpage访问","like_count":0},{"had_liked":false,"id":353203,"user_name":"小Y","can_delete":false,"product_type":"c3","uid":1739621,"ip_address":"北京","ucode":"24A43BB71805F8","user_header":"https://static001.geekbang.org/account/avatar/00/1a/8b/65/0f1f9a10.jpg","comment_is_top":false,"comment_ctime":1659258393,"is_pvip":false,"replies":null,"discussion_count":2,"race_medal":0,"score":6,"product_id":100049401,"comment_content":"老师，我是mac本地安装的，使用了docker-desktop，和aliyun的k8s-for-docker-desktop\n\nk8s: 1.24.1\nistio: 1.14.1\n\n我按照所讲 安装配置了，没有任何错误。\n\n但是访问 localhost&#47;productpage或127.0.0.1:80&#47;productpage或localhost:80&#47;productpage都是404 Not Found(ngingx)，实在是没有头绪，应该怎么办？求助","like_count":0,"discussions":[{"author":{"id":1222354,"avatar":"https://static001.geekbang.org/account/avatar/00/12/a6/d2/ebe20bb5.jpg","nickname":"阿棠","note":"","ucode":"4C62FF98BCD925","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":587360,"discussion_content":"解决了吗？","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1662992873,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":"广东","group_id":0},"score":2,"extra":"","child_discussion_number":1,"child_discussions":[{"author":{"id":1739621,"avatar":"https://static001.geekbang.org/account/avatar/00/1a/8b/65/0f1f9a10.jpg","nickname":"小Y","note":"","ucode":"24A43BB71805F8","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":1222354,"avatar":"https://static001.geekbang.org/account/avatar/00/12/a6/d2/ebe20bb5.jpg","nickname":"阿棠","note":"","ucode":"4C62FF98BCD925","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":624786,"discussion_content":"没 ","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1690907651,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":587360,"ip_address":"广东","group_id":0},"score":624786,"extra":""}]}]},{"had_liked":false,"id":350808,"user_name":"夏敝安","can_delete":false,"product_type":"c3","uid":2403557,"ip_address":"","ucode":"7966113C968872","user_header":"","comment_is_top":false,"comment_ctime":1657229888,"is_pvip":false,"replies":null,"discussion_count":0,"race_medal":0,"score":7,"product_id":100049401,"comment_content":"katacoda关闭了","like_count":0},{"had_liked":false,"id":349590,"user_name":"半缘君","can_delete":false,"product_type":"c3","uid":1140265,"ip_address":"","ucode":"1266C4E35180A2","user_header":"https://static001.geekbang.org/account/avatar/00/11/66/29/8b471f9d.jpg","comment_is_top":false,"comment_ctime":1656126259,"is_pvip":false,"replies":null,"discussion_count":1,"race_medal":0,"score":7,"product_id":100049401,"comment_content":"最害怕的就是跟着教程走，结果发现，老师能访问的，我访问不了，然后发现之后的所有实验都做不了。","like_count":0,"discussions":[{"author":{"id":1739621,"avatar":"https://static001.geekbang.org/account/avatar/00/1a/8b/65/0f1f9a10.jpg","nickname":"小Y","note":"","ucode":"24A43BB71805F8","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":582142,"discussion_content":"我就是。。访问不到。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1659258098,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":"北京","group_id":0},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":349588,"user_name":"半缘君","can_delete":false,"product_type":"c3","uid":1140265,"ip_address":"","ucode":"1266C4E35180A2","user_header":"https://static001.geekbang.org/account/avatar/00/11/66/29/8b471f9d.jpg","comment_is_top":false,"comment_ctime":1656125947,"is_pvip":false,"replies":null,"discussion_count":1,"race_medal":0,"score":7,"product_id":100049401,"comment_content":"访问直接用localhost，是因为是mac吗？ 云服务器访问的时候，直接访问http:&#47;&#47;xxx.xxx.xxx.xxx:80&#47;productpage 就能访问吗？ 服务暴露的端口是怎么对外公开的，服务器上curl 访问localhost为什么不行？","like_count":0,"discussions":[{"author":{"id":1739621,"avatar":"https://static001.geekbang.org/account/avatar/00/1a/8b/65/0f1f9a10.jpg","nickname":"小Y","note":"","ucode":"24A43BB71805F8","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":582143,"discussion_content":"请问后续有什么进展嘛，我也是mac本地搭建的。 我访问就是404，安装过程都没有报错。 求助","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1659258134,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":"北京","group_id":0},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":348078,"user_name":"ileruza","can_delete":false,"product_type":"c3","uid":1336951,"ip_address":"","ucode":"C3D83DF4230109","user_header":"https://static001.geekbang.org/account/avatar/00/14/66/77/194ba21d.jpg","comment_is_top":false,"comment_ctime":1654705935,"is_pvip":false,"replies":null,"discussion_count":0,"race_medal":0,"score":7,"product_id":100049401,"comment_content":"装istio一定要先装flannel吗？","like_count":0},{"had_liked":false,"id":347557,"user_name":"Mew151","can_delete":false,"product_type":"c3","uid":1002201,"ip_address":"","ucode":"D4793F5874F345","user_header":"https://static001.geekbang.org/account/avatar/00/0f/4a/d9/75dd7cf9.jpg","comment_is_top":false,"comment_ctime":1654154309,"is_pvip":false,"replies":null,"discussion_count":0,"race_medal":0,"score":7,"product_id":100049401,"comment_content":"老师，想问一下，我用的是k8s v1.23.6和Istio v1.14.0，在安装完Istio之后，执行命令kubectl get po -n istio-system，发现svclb-istio-ingressgateway一直是pending状态，请问是什么原因？\n\n ~&#47;Downloads&#47;DevEnvironment&#47;istio-1.14.0  k get po -n istio-system\nNAME                                    READY   STATUS    RESTARTS        AGE\nsvclb-istio-ingressgateway-wqcdd        0&#47;5     Pending   0               81m\njaeger-78cb4f7d4b-mw6pw                 1&#47;1     Running   1 (5m24s ago)   32m\nkiali-6b455fd9f9-4j2vj                  1&#47;1     Running   1 (5m24s ago)   32m\nistiod-65fcd8b554-h6tmw                 1&#47;1     Running   1 (5m24s ago)   82m\nistio-egressgateway-869744fbfb-slws2    1&#47;1     Running   1 (5m24s ago)   81m\nprometheus-7cc96d969f-ndt6b             2&#47;2     Running   2 (5m24s ago)   32m\nistio-ingressgateway-6f78479f54-7kfd2   1&#47;1     Running   1 (5m24s ago)   81m\ngrafana-67f5ccd9d7-2lhsr                1&#47;1     Running   1 (5m24s ago)   32m","like_count":0},{"had_liked":false,"id":346253,"user_name":"depeng","can_delete":false,"product_type":"c3","uid":1806602,"ip_address":"","ucode":"B58055EF99053C","user_header":"https://static001.geekbang.org/account/avatar/00/1b/91/0a/384abf62.jpg","comment_is_top":false,"comment_ctime":1652947641,"is_pvip":false,"replies":null,"discussion_count":0,"race_medal":0,"score":7,"product_id":100049401,"comment_content":"使用katacoda搭建的k8s和istio，在部署完gateway之后，应该怎么才能访问到网页？","like_count":0},{"had_liked":false,"id":345391,"user_name":"感谢曾经的我","can_delete":false,"product_type":"c3","uid":2898711,"ip_address":"","ucode":"2F89CF64E96772","user_header":"https://static001.geekbang.org/account/avatar/00/2c/3b/17/e2e4e689.jpg","comment_is_top":false,"comment_ctime":1652251015,"is_pvip":false,"replies":null,"discussion_count":0,"race_medal":0,"score":7,"product_id":100049401,"comment_content":"老师，我在注入sidecar的阶段，通过describe查看有一个警告，Warning  Unhealthy  44s (x6 over 49s)  kubelet            Readiness probe failed: Get &quot;http:&#47;&#47;10.244.1.123:15021&#47;healthz&#47;ready&quot;: dial tcp 10.244.1.123:15021: connect: connection refused\n；进到pod里面也确实没有监听15021，是正常的吗？","like_count":0},{"had_liked":false,"id":340736,"user_name":"Sam Fu","can_delete":false,"product_type":"c3","uid":1112676,"ip_address":"","ucode":"EA285A4943271F","user_header":"https://static001.geekbang.org/account/avatar/00/10/fa/64/457325e6.jpg","comment_is_top":false,"comment_ctime":1649086557,"is_pvip":false,"replies":null,"discussion_count":1,"race_medal":0,"score":7,"product_id":100049401,"comment_content":"安装的最新版本的istio demo，找不到kiali了","like_count":0,"discussions":[{"author":{"id":1336951,"avatar":"https://static001.geekbang.org/account/avatar/00/14/66/77/194ba21d.jpg","nickname":"ileruza","note":"","ucode":"C3D83DF4230109","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":575652,"discussion_content":"kubectl apply -f samples/addons","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1655003953,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":333230,"user_name":"偏执","can_delete":false,"product_type":"c3","uid":2747448,"ip_address":"","ucode":"928B5092DBB6E9","user_header":"https://static001.geekbang.org/account/avatar/00/29/ec/38/a4ddd17b.jpg","comment_is_top":false,"comment_ctime":1644223278,"is_pvip":false,"replies":null,"discussion_count":0,"race_medal":0,"score":7,"product_id":100049401,"comment_content":"老师，我是在阿里云上部署的k8s和istio，kilai在服务器上curl 120.0.0.1:20001可以访问。阿里云安全组20001端口号也配置了，但我用浏览器公网ip+20001访问失败，请问是怎么回事呢？另外公网ip+prodcuetpage也无法访问。","like_count":0},{"had_liked":false,"id":320248,"user_name":"读书破万卷","can_delete":false,"product_type":"c3","uid":2223611,"ip_address":"","ucode":"2C60C6C83E9D37","user_header":"https://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTIiam52mLdqzU8o08ibSxTWySR2uOcF1iaMMSxPicPh4r8oiaYs0ib2eJvyQDyA9cBp9hXf32Alo4ljtDRw/132","comment_is_top":false,"comment_ctime":1636172627,"is_pvip":false,"replies":null,"discussion_count":0,"race_medal":0,"score":7,"product_id":100049401,"comment_content":"kubectl get  deployment \nNAME             READY   UP-TO-DATE   AVAILABLE   AGE\ndetails-v1       0&#47;1     0            0           59m\nproductpage-v1   0&#47;1     0            0           59m\nratings-v1       0&#47;1     0            0           59m\nreviews-v1       0&#47;1     0            0           59m\nreviews-v2       0&#47;1     0            0           59m\nreviews-v3       0&#47;1     0            0           59m\n 老师 我安装bookinfo  一直处于这样","like_count":0},{"had_liked":false,"id":231414,"user_name":"Geek_66dcc6","can_delete":false,"product_type":"c3","uid":1317851,"ip_address":"","ucode":"0EC9C087C5008B","user_header":"","comment_is_top":false,"comment_ctime":1593671360,"is_pvip":false,"replies":null,"discussion_count":0,"race_medal":0,"score":8,"product_id":100049401,"comment_content":"我安装的是istio 1.6 版本，用命令istioctl install --set profile=demo --set values.global.jwtPolicy=first-party-jwt","like_count":0}]}