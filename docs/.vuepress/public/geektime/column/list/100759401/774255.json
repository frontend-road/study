{"id":774255,"title":"12ï½œè‡ªå®šä¹‰æŒ‡æ ‡ï¼šå¦‚ä½•é€šè¿‡è‡ªå®šä¹‰æŒ‡æ ‡ï¼Œç›‘æ§å‰ç«¯é¡µé¢æ›´å¤šçŠ¶æ€","content":"<p>ä½ å¥½ï¼Œæˆ‘æ˜¯ä¸‰æ¡¥ã€‚</p><p>è¿™èŠ‚è¯¾ï¼Œæˆ‘ä»¬ç»§ç»­å­¦ä¹ å‰ç«¯å…¨é“¾è·¯çš„å¦ä¸€ç§é“¾è·¯æ—¥å¿—ï¼Œè‡ªå®šä¹‰æ—¥å¿—ã€‚</p><p>é€šå¸¸æ¥è¯´ï¼Œæˆ‘ä»¬ä¼šåœ¨ä¸šåŠ¡ä»£ç é‡Œä¸»åŠ¨è¾“å‡ºä¸€äº›æ—¥å¿—ï¼Œé€šè¿‡æ—¥å¿—è¿½è¸ªå¯èƒ½å‘ç”Ÿçš„å¼‚å¸¸æˆ–æµç¨‹ä»¥å¤–çš„åœ°æ–¹ã€‚</p><p>å¦‚æœè¯´ï¼Œè¯·æ±‚ç±»æ—¥å¿—ã€èµ„æºç±»æ—¥å¿—ã€è„šæœ¬å¼‚å¸¸ç±»æ—¥å¿—æ˜¯å…¨é“¾è·¯ä¸­æœ€åŸºç¡€åº•å±‚çš„æ—¥å¿—ï¼Œé‚£ä¹ˆè‡ªå®šä¹‰æ—¥å¿—å°±æ˜¯æ›´æ¥è¿‘ä¸šåŠ¡çš„é“¾è·¯æ—¥å¿—ã€‚å®ƒçš„å®ç°åŸç†ç±»ä¼¼äºå°è£…consoleå¯¹è±¡ï¼Œä¹Ÿæ˜¯ä¸ºä¸šåŠ¡æä¾›äº†ä¸€ä¸ªé“¾è·¯æ—¥å¿—çš„å‡½æ•°ã€‚</p><h2>ä¸ºä»€ä¹ˆè¦åšå…¨é“¾è·¯çš„è‡ªå®šä¹‰åŸ‹ç‚¹</h2><p>å¾ˆå¤šå‰ç«¯åŒå­¦éƒ½å–œæ¬¢åœ¨ä¸šåŠ¡é€»è¾‘ä»£ç ä¸­ä½¿ç”¨ <code>console.log</code> æ¥æ‰“å°æ—¥å¿—ä¿¡æ¯ï¼Œä»è€Œè°ƒè¯•å’Œå®šä½é—®é¢˜ï¼Œå› ä¸ºè¿™ç§æ—¥å¿—èƒ½å¤Ÿè¦†ç›–å‰ç«¯ä¸šåŠ¡é€»è¾‘é‡Œå¾ˆå¤šç‰¹æ®Šçš„åœºæ™¯ã€‚</p><p>è¿™ä¹ˆåšæœ‰ä»€ä¹ˆé—®é¢˜å—ï¼Ÿæˆ‘ä»¬å…ˆæ¥çœ‹ä¸€ä¸ªå¾ˆæœ‰ä»£è¡¨æ€§çš„ä¾‹å­ã€‚</p><pre><code class=\"language-typescript\">try {\n&nbsp; const jsonstr = '{\"name\": \"å‰ç«¯å…¨é“¾è·¯ä¼˜åŒ–å®æˆ˜\", \"course\": 30, \"source\": \"geekbang\"}'\n&nbsp; var data = JSON.parse(jsonstr);\n&nbsp; console.log(data.name);\n&nbsp; console.log(data.course);\n} catch (err) {\n&nbsp; console.error(err);\n}\n</code></pre><p>ä¸Šé¢çš„ä»£ç ä½¿ç”¨äº† <code>JSON.parse</code> å‡½æ•°ï¼Œå°†ä¸€ä¸ªjsonå­—ç¬¦ä¸²è§£æä¸ºJSONå¯¹è±¡ã€‚è¦çŸ¥é“ï¼Œä¾‹å­ä¸­å±•ç¤ºçš„å­—ç¬¦ä¸²æ˜¯ä¸€ä¸ªæ ‡å‡†jsonå­—ç¬¦ä¸²ï¼Œå¯¹äº <code>parse</code> å‡½æ•°è€Œè¨€ï¼Œå®ƒæ˜¯èƒ½æ­£å¸¸è§£æå‡ºæ¥çš„ã€‚</p><!-- [[[read_end]]] --><p>æˆ‘ä»¬çŸ¥é“ï¼Œä»»ä½•ä¸€ä¸ªå‡½æ•°çš„è¿è¡Œå¿…ç„¶æ¶‰åŠè¾“å…¥å’Œè¾“å‡ºä¸¤ä¸ªè¿‡ç¨‹ï¼Œè€Œä¸”æ•°æ®çš„è¾“å…¥å¾€å¾€æ˜¯ä¸å¯é çš„ã€‚<code>JSON.parse</code> å‡½æ•°åŒç†ï¼Œå¦‚æœè¾“å…¥çš„å­—ç¬¦ä¸²ä¸ç¬¦åˆJSONå¯¹è±¡çš„æ ¼å¼è¦æ±‚ï¼Œä»£ç å°±ä¼šæŠ›å‡ºä¸€ä¸ª <code>SyntaxError</code> å¼‚å¸¸ã€‚</p><p>å…¶å®ï¼Œåœ¨çœŸå®çš„å‰ç«¯é¡¹ç›®é‡Œï¼Œåƒ <code>JSON.parse</code> è¿™æ ·çš„å‡½æ•°é€»è¾‘éå¸¸å¤šã€‚é€šå¸¸æƒ…å†µä¸‹ï¼Œæ•°æ®è¾“å…¥æ¥è‡ªä¸¤ä¸ªæ–¹é¢ï¼Œä¸€ä¸ªæ˜¯åç«¯æ¥å£æä¾›çš„æ•°æ®ï¼Œå¦ä¸€ä¸ªå°±æ˜¯æ¥è‡ªç”¨æˆ·è¾“å…¥ï¼Œä¾‹å¦‚è¡¨å•æ•°æ®ã€‚å¦‚æœæˆ‘ä»¬ä¸æ ¡éªŒè¿™æ ·è¾“å…¥é”™è¯¯çš„é€»è¾‘ï¼Œåªè¦JavaScriptä»£ç æŠ¥é”™ï¼Œå°±æ²¡æ³•å¾€ä¸‹æ‰§è¡Œï¼Œç¨‹åºä¹Ÿä¼šç›´æ¥å´©æºƒã€‚è¿™æ˜¯æˆ‘ä»¬ä¸æ„¿æ„çœ‹åˆ°çš„æƒ…å†µã€‚</p><p>æˆ‘ä»¬å†å›æ¥åˆ†æä¸Šé¢çš„ä»£ç ï¼Œè™½ç„¶ä»£ç ä¸­ä½¿ç”¨äº†try-catchæ¥æ•è·ä»£ç çš„å¼‚å¸¸æƒ…å†µï¼Œä½†æˆ‘ä»¬å¹¶æ²¡æœ‰åœ¨catchä¸­ç»™å‡ºå‘ç”Ÿå¼‚å¸¸æ—¶çš„å¤„ç†æœºåˆ¶ï¼Œåªæ˜¯å¶å°”ä¼šä½¿ç”¨ <code>console.log</code> è¾“å‡ºerrorä¿¡æ¯ã€‚</p><p>è™½ç„¶è¿›å…¥catchäº‹ä»¶çš„æ¦‚ç‡éå¸¸ä½ï¼Œä½†åªè¦æ˜¯è¿›å…¥äº†å¼‚å¸¸ï¼Œå°±è‚¯å®šæ˜¯æˆ‘ä»¬æ²¡æœ‰é¢„æƒ³åˆ°çš„æƒ…å†µã€‚å¯¹äºè¿™äº›ç‰¹æ®Šæƒ…å†µï¼Œæˆ‘ä»¬å¯ä»¥åœ¨å…¨é“¾è·¯é‡Œé¢é€šè¿‡æ—¥å¿—è®°å½•ä¸‹æ¥ï¼Œå¸®åŠ©æˆ‘ä»¬åˆ†æç”¨æˆ·çš„çœŸå®æƒ…å†µï¼Œæ”¹å–„äº§å“çš„ç”¨æˆ·ä½“éªŒã€‚</p><p>æ€»ä¹‹ï¼Œ<strong>è¦æå‰å‘ç°æ½œåœ¨çš„ä¸šåŠ¡é—®é¢˜</strong>ï¼Œ<strong>æ”¹å–„äº§å“çš„ç”¨æˆ·ä½“éªŒï¼Œè‡ªå®šä¹‰é“¾è·¯æ—¥å¿—æ˜¯å‰ç«¯å…¨é“¾è·¯å¿…ä¸å¯å°‘çš„æ—¥å¿—ç±»å‹ã€‚</strong></p><p>æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬å°±æ¥å®ç°è‡ªå®šä¹‰é“¾è·¯æ—¥å¿—çš„åŸºæœ¬å‡½æ•°ã€‚</p><h2>å®ç°é€šç”¨è‡ªå®šä¹‰é“¾è·¯æ—¥å¿—</h2><p>åœ¨å‰é¢çš„è¯¾ç¨‹é‡Œï¼Œæˆ‘ä»¬å·²ç»å®šä¹‰äº†å…¨é“¾è·¯çš„åŸºæœ¬æ•°æ®ç»“æ„ã€‚å…¶ä¸­è‡ªå®šä¹‰é“¾è·¯æ—¥å¿—çš„æ•°æ®ç±»å‹æ˜¯ <code>TraceDataLog</code> ã€‚è¿™æ¬¡ï¼Œæˆ‘ä»¬å°±ä»¥è¿™ç§æ•°æ®ç»“æ„ç±»å‹å®ç°é€šç”¨è‡ªå®šä¹‰æ—¥å¿—å‡½æ•°ã€‚</p><h3>é€šç”¨åº•å±‚æ—¥å¿—å‡½æ•°</h3><p>æˆ‘ä»¬é¦–å…ˆåˆ›å»ºä¸€ä¸ªåä¸º <code>log</code> çš„å‡½æ•°ï¼Œå‚æ•°ä¸º <code>TraceDataLog</code> æ•°æ®ç±»å‹ã€‚è¿™ä¹ˆåšçš„ç›®çš„æ˜¯æ ¹æ®ä¸šåŠ¡çš„å®é™…æƒ…å†µæ„é€  <code>TraceDataLog</code> æ•°æ®ï¼Œä¾‹å¦‚ <code>level</code> ã€ <code>type</code> ã€ <code>message</code> ã€ <code>name</code> ç­‰å­—æ®µå€¼ã€‚åœ¨ <code>log</code> å‡½æ•°å†…éƒ¨ï¼Œæˆ‘ä»¬åªéœ€å…³æ³¨å­˜å‚¨ç”¨æˆ·è¡Œä¸ºå’Œå‘é€æ—¥å¿—ä¸¤é¡¹ä»»åŠ¡å°±å¥½ã€‚</p><p>å…·ä½“å®ç°çš„ä»£ç å‚è€ƒå¦‚ä¸‹ã€‚</p><pre><code class=\"language-typescript\">// src/baseTrace.ts\n\nexport class BaseTrace implements BaseTraceInterface {\n\tpublic log(log: TraceDataLog) {\n\t&nbsp; this.saveBreadcrumb({\n\t&nbsp; &nbsp; name: 'customer-log',\n\t&nbsp; &nbsp; level: log.level,\n\t&nbsp; &nbsp; type: dataTypes2BreadcrumbsType(log.type),\n\t&nbsp; &nbsp; category: dataCategory2BreadcrumbsCategory(log.type),\n\t&nbsp; &nbsp; message: log.message,\n\t&nbsp; &nbsp; time: getTimestamp(),\n\t&nbsp; })\n\t&nbsp; this.send(log)\n\t}\n}\n\n</code></pre><p>æˆ‘ä»¬æ¥çœ‹ä¸‹ <code>log</code> å‡½æ•°ä»£ç ï¼Œåœ¨å­˜å‚¨ç”¨æˆ·è¡Œä¸ºçš„æ•°æ®ä¸­ï¼Œtypeå’Œcategoryä¸¤ä¸ªå­—æ®µéƒ½éœ€è¦é€šè¿‡é¢å¤–çš„å‡½æ•°è½¬æ¢æˆåˆé€‚çš„å€¼ï¼Œç¡®ä¿ç¬¦åˆæ•°æ®çš„ä¸€è‡´æ€§ã€‚</p><p>å¦å¤–ï¼Œ <code>log</code> å‡½æ•°çš„å…¥å‚å‚æ•°æ˜¯ä¸€ä¸ªå®Œæ•´çš„æ—¥å¿—æ•°æ®å¯¹è±¡ã€‚è¿™æ ·çš„å…¥å‚å­˜åœ¨ä¸€ä¸ªé—®é¢˜ï¼Œå°±æ˜¯è°ƒç”¨logå‡½æ•°å‰ï¼Œè¿˜è¦æ„é€ ä¸€ä¸ªå®Œæ•´çš„æ—¥å¿—æ•°æ®å¯¹è±¡ï¼Œç„¶åä½ ä¼šå‘ç°ï¼Œå¯¹äºä¸šåŠ¡æ¥è¯´ï¼Œä½¿ç”¨ <code>log</code> å‡½æ•°è¿™ä»¶äº‹æƒ…å˜å¾—æ›´å¤æ‚äº†ã€‚</p><p>å› æ­¤ï¼Œæˆ‘ä»¬ä»¥ <code>log</code> å‡½æ•°ä¸ºåŸºç¡€ï¼Œå®ç°3ä¸ªé¢„è®¾ä¸åŒçº§åˆ«çš„è‡ªå®šä¹‰æ—¥å¿—å‡½æ•°ï¼Œå®ƒä»¬åˆ†åˆ«æ˜¯æ™®é€šæ—¥å¿—infoï¼Œå‘Šè­¦æ—¥å¿—warningï¼Œé”™è¯¯æ—¥å¿—errorã€‚æœ‰äº†è¿™3ä¸ªçº§åˆ«çš„è‡ªå®šä¹‰æ—¥å¿—ï¼Œä¸šåŠ¡é€»è¾‘å°±èƒ½ä»¥æœ€å°ä»£ç é‡æ¥å…¥é“¾è·¯æ—¥å¿—ã€‚</p><h3>æ™®é€šæ—¥å¿—å‡½æ•°</h3><p>æ™®é€šæ—¥å¿—å‡½æ•°çš„åŠŸèƒ½æ˜¯è®°å½•ä¸šåŠ¡é€»è¾‘ä¸­æ™®é€šçº§åˆ«çš„æ—¥å¿—ä¿¡æ¯ï¼Œå¯ä»¥ç”¨æ¥è°ƒè¯•ä¸šåŠ¡æ—¥å¿—ã€è‡ªå®šä¹‰catchæ—¥å¿—ã€‚</p><p>é¦–å…ˆæˆ‘ä»¬å®šä¹‰ä¸€ä¸ªåä¸º <code>info</code> çš„å‡½æ•°ï¼Œå®ƒæä¾›äº†ä¸¤ä¸ªå…¥å‚å‚æ•°ï¼šmessageå’Œtagã€‚<code>message</code>å‚æ•°æ˜¯ç”¨äºè®°å½•æ—¥å¿—ä¿¡æ¯çš„ï¼Œè€Œ <code>tag</code> å‚æ•°æ˜¯ä¸ºäº†åŒºåˆ†ä¸åŒçš„æ—¥å¿—è€Œæä¾›çš„æ‰“æ ‡ç­¾çš„åŠŸèƒ½ï¼Œå½“ç„¶è¿™ä¸ªå‚æ•°æ˜¯éå¿…é¡»çš„ï¼Œå¯ä»¥è‡ªç”±é€‰æ‹©ã€‚</p><p>å…·ä½“å®ç°çš„ä»£ç å‚è€ƒå¦‚ä¸‹ã€‚</p><pre><code class=\"language-typescript\">// src/baseTrace.ts\n\nexport class BaseTrace implements BaseTraceInterface {\n&nbsp; public info(message: string, tag?: string) {\n&nbsp; &nbsp; this.log({\n&nbsp; &nbsp; &nbsp; name: 'customer-log',\n&nbsp; &nbsp; &nbsp; type: TraceDataTypes.LOG,\n&nbsp; &nbsp; &nbsp; level: TraceDataSeverity.Info,\n&nbsp; &nbsp; &nbsp; message,\n&nbsp; &nbsp; &nbsp; time: getTimestamp(),\n&nbsp; &nbsp; &nbsp; dataId: hashCode(`${message}|${tag || ''}`),\n&nbsp; &nbsp; &nbsp; tag,\n&nbsp; &nbsp; })\n&nbsp; }\n}\n</code></pre><h3>å‘Šè­¦æ—¥å¿—å‡½æ•°</h3><p>å‘Šè­¦æ—¥å¿—ä¼šè®°å½•ä¸šåŠ¡é€»è¾‘é‡Œéœ€è¦é‡ç‚¹å…³æ³¨çš„åœ°æ–¹ã€‚ä¸»è¦é¢„è­¦æ•°æ®æ ¡éªŒå¤±è´¥è¿™ç±»åœºæ™¯ã€‚å¦‚æœæ ¡éªŒå¤±è´¥ï¼Œæˆ‘ä»¬å°±å¯ä»¥è€ƒè™‘ä¸ŠæŠ¥å‘Šè­¦ç±»å‹æ—¥å¿—äº†ã€‚</p><p><code>warn</code> æ—¥å¿—å‡½æ•°è·Ÿ <code>info</code> å‡½æ•°çš„å®ç°åŸç†æ˜¯ç›¸åŒçš„ï¼Œå”¯ä¸€çš„åŒºåˆ«æ˜¯levelå±æ€§ä½¿ç”¨çš„æ˜¯ <code>warning</code> å€¼ã€‚</p><p>å…·ä½“å®ç°çš„ä»£ç å‚è€ƒå¦‚ä¸‹ã€‚</p><pre><code class=\"language-typescript\">// src/baseTrace.ts\n\nexport class BaseTrace implements BaseTraceInterface {\n\n\tpublic warn(message: string, tag?: string) {\n&nbsp; &nbsp; this.log({\n&nbsp; &nbsp; &nbsp; name: 'customer-log',\n&nbsp; &nbsp; &nbsp; type: TraceDataTypes.LOG,\n&nbsp; &nbsp; &nbsp; level: TraceDataSeverity.Warning,\n&nbsp; &nbsp; &nbsp; message,\n&nbsp; &nbsp; &nbsp; time: getTimestamp(),\n&nbsp; &nbsp; &nbsp; dataId: hashCode(`${message}|${tag || ''}`),\n&nbsp; &nbsp; &nbsp; tag,\n&nbsp; &nbsp; })\n&nbsp; }\n}\n</code></pre><h3>é”™è¯¯æ—¥å¿—å‡½æ•°</h3><p>é”™è¯¯æ—¥å¿—å‡½æ•°çš„ä¸»è¦ä½œç”¨æ˜¯æ•è·å¹¶è®°å½•ä¸šåŠ¡é€»è¾‘ä¸­å‡ºç°çš„ä»£ç å¼‚å¸¸ã€‚å®ƒèƒ½å¤Ÿè¯¦ç»†è®°å½•å¼‚å¸¸ä¿¡æ¯ï¼ŒåŒ…æ‹¬ä½†ä¸é™äºJSONè§£æé”™è¯¯ï¼Œä»¥åŠé€šè¿‡try-catchè¯­å¥æ•è·çš„å¼‚å¸¸æƒ…å†µã€‚é€šå¸¸æ¥è¯´ï¼Œåœ¨ä»£ç ä¸­ä¸ŠæŠ¥è¿™ç§ç±»å‹çš„æ—¥å¿—ï¼Œè‚¯å®šæ˜¯ä¸šåŠ¡å‡ºç°äº†ä¸€äº›é—®é¢˜ã€‚æ‰€ä»¥åè¿‡æ¥çœ‹ï¼Œæ¯å½“å‡ºç°çº¿ä¸Šé—®é¢˜çš„æ—¶å€™ï¼Œè‡ªå®šä¹‰çš„é”™è¯¯æ—¥å¿—å¿…å®šæ˜¯æˆ‘ä»¬é‡ç‚¹å…³æ³¨çš„åœ°æ–¹ã€‚</p><p>é”™è¯¯æ—¥å¿—å‡½æ•°ä¸ <code>info</code> å’Œ <code>warn</code> å‡½æ•°çš„å®ç°åŸºæœ¬ä¸Šä¸€æ ·ï¼Œå”¯ä¸€åŒºåˆ«æ˜¯levelå±æ€§ç›´æ¥ä½¿ç”¨ <code>error</code> å€¼ã€‚å…·ä½“å®ç°çš„ä»£ç å‚è€ƒå¦‚ä¸‹ã€‚</p><pre><code class=\"language-typescript\">// src/baseTrace.ts\n\nexport class BaseTrace implements BaseTraceInterface {\n&nbsp;&nbsp;\n&nbsp; public error(message: string, tag?: string) {\n&nbsp; &nbsp; this.log({\n&nbsp; &nbsp; &nbsp; name: 'customer-error',\n&nbsp; &nbsp; &nbsp; type: TraceDataTypes.LOG,\n&nbsp; &nbsp; &nbsp; level: TraceDataSeverity.Error,\n&nbsp; &nbsp; &nbsp; message,\n&nbsp; &nbsp; &nbsp; time: getTimestamp(),\n&nbsp; &nbsp; &nbsp; dataId: hashCode(`${message}|${tag || ''}`),\n&nbsp; &nbsp; &nbsp; tag,\n&nbsp; &nbsp; })\n&nbsp; }\n}\n</code></pre><h3>dataIdå±æ€§çš„ç‰¹ç‚¹</h3><p>ä½ å¯èƒ½å·²ç»æ³¨æ„åˆ°ï¼Œè¿™ä¸‰ä¸ªæ—¥å¿—å‡½æ•°éƒ½ä½¿ç”¨äº†ç›¸åŒçš„ç®—æ³•ç”Ÿæˆ <code>dataId</code> å±æ€§å€¼ï¼Œä¹Ÿå°±æ˜¯ <code>message</code> å’Œ <code>tag</code> ä¸¤ä¸ªå‚æ•°å€¼æ‹¼æ¥ç»„åˆï¼Œç„¶åä½¿ç”¨ <code>hashCode</code> å‡½æ•°è½¬æ¢æˆæ–°å­—ç¬¦ä¸²ã€‚</p><p>è¿™ä¸ªç®—æ³•æœ‰ä¸€ä¸ªç‰¹ç‚¹ï¼Œå°±æ˜¯ä¼šå‡ºç°é‡å¤å€¼ã€‚è¿™æ ·è®¾è®¡çš„åŸå› æ˜¯ä»€ä¹ˆå‘¢ï¼Ÿ</p><p>è¿™æ˜¯å› ä¸ºï¼Œåœ¨å‰ç«¯é¡¹ç›®ä¸­ï¼Œå¦‚æœæŸä¸€æ®µä¸šåŠ¡é€»è¾‘é‡Œé¢‘ç¹å‡ºç°åŒæ ·çš„é”™è¯¯ï¼Œä¾‹å¦‚100ä¸ªç”¨æˆ·ä¸­æœ‰10ä¸ªéƒ½æŠ›å‡ºäº†åŒæ ·çš„å¼‚å¸¸ï¼Œé‚£å°±è‡³å°‘ä¼šå‡ºç°10ä¸ªç›¸åŒdataIdçš„æ—¥å¿—ã€‚è¿™è¯´æ˜è¿™æ®µä»£ç é€»è¾‘å­˜åœ¨é—®é¢˜ï¼Œè¿™æ—¶å°±éœ€è¦æŠ•å…¥æ—¶é—´æ’æŸ¥åŸå› äº†ã€‚</p><h2>å¦‚ä½•ç”¨å¥½è‡ªå®šä¹‰é“¾è·¯åŸ‹ç‚¹ï¼Ÿ</h2><p>å¥½äº†ã€‚å­¦å®Œäº†å¦‚ä½•å®šä¹‰é€šç”¨çš„è‡ªå®šä¹‰æ—¥å¿—å‡½æ•°åï¼Œé‚£æ€ä¹ˆç”¨å‘¢ï¼Ÿåœ¨ä»€ä¹ˆåœºæ™¯ä¸‹è°ƒç”¨å‘¢ï¼Ÿ</p><p>å¾ˆå¤šå‰ç«¯åŒå­¦å¯¹è‡ªå·±å®ç°çš„ä»£ç å’Œé€»è¾‘éƒ½è¿‡äºè‡ªä¿¡ï¼Œå¾ˆå°‘è€ƒè™‘åˆ°å‡ºç°é€»è¾‘å¼‚å¸¸æ—¶çš„æµç¨‹å’Œå¤„ç†æ–¹æ¡ˆã€‚æœ€å¤šå°±æ˜¯ä¸ºäº†è°ƒè¯•é—®é¢˜è€Œå¢åŠ  <code>console.log</code> æ—¥å¿—ã€‚è¿™æ—¶å€™ä½ ä¼šå‘ç°ï¼Œå‰ç«¯å¼‚å¸¸é—®é¢˜æŠ›å‡ºæ¥äº†ï¼Œä½†æ—¥å¿—ç¡®åœ¨ç”¨æˆ·æ‰‹ä¸Šï¼Œæ²¡æ³•æä¾›ç»™å‰ç«¯åŒå­¦ï¼Œç‰¹åˆ«æ˜¯ä½¿ç”¨ <code>JSON.parse</code> è½¬æ¢æ ¼å¼çš„é—®é¢˜ã€‚</p><h3>JSONè½¬æ¢æ ¼å¼é—®é¢˜</h3><p>å‰é¢æœ‰ä¸€æ®µç¤ºä¾‹ä»£ç ï¼Œæˆ‘æ˜¯ç”¨try-catchæ•è·çš„ <code>JSON.parse</code> å‡½æ•°è§£æå¼‚å¸¸ã€‚ç›¸ä¿¡å¾ˆå¤šå‰ç«¯åŒå­¦éƒ½ä¼šæœ‰æ„è¯†åœ°å»å¢åŠ æ•è·çš„æ—¥å¿—è¾“å‡ºï¼Œä½†åœ¨çœŸå®é¡¹ç›®ä¸­ï¼Œè¿™éƒ¨åˆ†è¿˜æ˜¯ä¼šä¸çŸ¥ä¸è§‰åœ°è¢«å¿½ç•¥ã€‚</p><p>ä¾‹å¦‚ä¸‹é¢çš„ä»£ç ã€‚</p><pre><code class=\"language-typescript\">data.forEach((item: string) =&gt; {\n\tarr.push(JSON.parse(item));\n});\n</code></pre><p>ä½ ä¸€å®šèƒ½çœ‹å¾—æ‡‚ä¸Šé¢çš„ä»£ç ï¼Œè€Œä¸”å¤§æ¦‚ç‡ä¹Ÿå†™è¿‡ç±»ä¼¼çš„ä»£ç ï¼Œç›´æ¥åœ¨ <code>push</code> å‡½æ•°çš„å‚æ•°ä¸Šè°ƒç”¨ <code>JSON.parse</code> å‡½æ•°ï¼Œä¸åšä»»ä½•çš„try-catchå®¹é”™å¤„ç†ï¼Œå› ä¸ºè¿™æ ·å†™çœŸçš„å¾ˆæ–¹ä¾¿å¾ˆç®€æ´ã€‚è¿™æ ·çš„å†™æ³•ä¼šå¯¼è‡´ä»€ä¹ˆé—®é¢˜ï¼Ÿ</p><p>ç­”æ¡ˆæ˜¯ï¼Œå½“ <code>JSON.parse</code> æ— æ³•è§£ææ•°æ®æ—¶ï¼Œä¼šç›´æ¥æŠ›å‡º <code>SyntaxError</code> ï¼Œå¯¼è‡´ <code>forEach</code> é€»è¾‘æ— æ³•æ­£å¸¸è¿è¡Œã€‚</p><p>æ‰€ä»¥ï¼Œä½¿ç”¨JSON.parseå‡½æ•°æ—¶ï¼Œæˆ‘ä»¬ä¸èƒ½å› ä¸ºæ–¹ä¾¿å°±å¿½ç•¥å®¹é”™å¤„ç†ã€‚æ­£ç¡®çš„åšæ³•æ˜¯å•ç‹¬ç”¨ä¸€è¡Œä»£ç å»è§£æJSONæ•°æ®ï¼Œå¹¶åœ¨catchä¸­å¢åŠ ä¸ŠæŠ¥é”™è¯¯æ—¥å¿—ã€‚</p><p>çœ‹ä¸‹ç¤ºä¾‹ä»£ç ã€‚</p><pre><code class=\"language-typescript\">// test.js\n// ç¬¬äºŒæ¡å­—ç¬¦ä¸²æ˜¯ä¸ç¬¦åˆJSONæ ¼å¼çš„å­—ç¬¦ä¸²\nconst data = [\n&nbsp; '{\"name\": \"å‰ç«¯å…¨é“¾è·¯ä¼˜åŒ–å®æˆ˜\", \"course\": 30, \"source\": \"geekbang\"}',\n&nbsp; '{\"name\": \"å‰ç«¯å…¨é“¾è·¯ä¼˜åŒ–å®æˆ˜\", \"course\": 30, \"source\"}',\n&nbsp; '{\"name\": \"å‰ç«¯å…¨é“¾è·¯ä¼˜åŒ–å®æˆ˜\", \"course\": 30, \"source\": \"geekbang\"}',\n]\nconst arr = []\n&nbsp;&nbsp;\ndata.forEach(item =&gt; {\n&nbsp; try {\n&nbsp; &nbsp; const itemObj&nbsp; = JSON.parse(item)\n&nbsp; &nbsp; arr.push(itemObj)\n&nbsp; } catch (err) {\n\tconsole.error(err)\n    // é€šè¿‡è‡ªå®šä¹‰é“¾è·¯æ—¥å¿—å‡½æ•°ä¸ŠæŠ¥åˆ°æœåŠ¡å™¨\n&nbsp; &nbsp; traceSDK.error(err.message, 'forEach|JSON.parse')\n&nbsp; }\n});\n\nconsole.log(arr)\n\n// SyntaxError: Expected ':' after property name in JSON at position 44 (line 1 column 45)\n//&nbsp; &nbsp; at JSON.parse (&lt;anonymous&gt;)\n//&nbsp; &nbsp; at auth:16:29\n//&nbsp; &nbsp; at Array.forEach (&lt;anonymous&gt;)\n//&nbsp; &nbsp; at test:14:8\n//test:22 (2) [{â€¦}, {â€¦}]\n</code></pre><h3>å–å€¼çš„é—®é¢˜</h3><p>é™¤äº† <code>JSON.parse</code> è¿™ç§JavaScriptå†…ç½®å‡½æ•°å¤–ï¼Œå‰ç«¯åŒå­¦åœ¨åšä¸šåŠ¡æ—¶è¿˜ä¼šå°è£…å¤§é‡å‡½æ•°æ¥æé«˜ä¸šåŠ¡é€»è¾‘çš„å¤ç”¨ã€‚ä¸€ä¸ªæœ€å…¸å‹çš„ä¾‹å­æ˜¯å‰ç«¯åŒå­¦ä½¿ç”¨ <code>localStorage</code> ç‰¹æ€§åšå¢åˆ æ”¹çš„é€»è¾‘ã€‚</p><p>æˆ‘ä»¬å…ˆæ¥çœ‹ä¸‹æœ€å¸¸è§çš„ä½¿ç”¨ <code>localStorage</code> çš„ä¾‹å­ã€‚</p><pre><code class=\"language-typescript\">function recommendCourseList() {\n&nbsp; const result = localStorage.getItem('userInfo')\n&nbsp; try {\n&nbsp; &nbsp; const resObj = JSON.parse(result)\n&nbsp; &nbsp; const list = getRecommendCourseList(resObj.userId);\n&nbsp; &nbsp; return list\n&nbsp; } catch (err) {\n&nbsp; &nbsp; console.error(err)\n&nbsp; &nbsp; return []\n&nbsp; }\n&nbsp; return []&nbsp;\n}\n</code></pre><p>åœ¨è¿™æ®µä»£ç é‡Œï¼Œæœ‰ä¸‰ä¸ªå…³é”®ä»£ç é€»è¾‘ï¼Œä¸€ä¸ªæ˜¯ä½¿ç”¨ <code>localstorage.getItem</code> è¯»å– <code>userInfo</code> æ•°æ®ï¼Œå¦ä¸€ä¸ªæ˜¯ä½¿ç”¨ <code>JSON.parse</code> è§£æJSONå¯¹è±¡ <code>resObj</code> ï¼Œæœ€åæ˜¯æŠŠ<code>resObj</code>å¯¹è±¡çš„ <code>userId</code> ä¼ ç»™ <code>getRecommendCourseList</code> å‡½æ•°è·å–æ¨èè¯¾ç¨‹åˆ—è¡¨ã€‚</p><p>åœ¨è¿™é‡Œï¼Œ <code>JSON.parse</code> çš„é—®é¢˜å’Œ <code>getRecommendCourseList</code> çš„å®ç°é€»è¾‘è¿™ä¸¤ä¸ªåœ°æ–¹å°±ä¸å†æ¢è®¨ã€‚æˆ‘ä»¬æ¥é‡ç‚¹çœ‹çœ‹ <code>localStorage.getItem</code> å¸¦æ¥äº†ä»€ä¹ˆé—®é¢˜ï¼Ÿ</p><p>æˆ‘ä»¬å…ˆç†è§£ä¸‹ <code>localStorage.getItem</code> çš„ä½œç”¨ï¼Œ <code>localStorage</code> æ˜¯æµè§ˆå™¨æä¾›çš„ä¸€ç§åœ¨å®¢æˆ·ç«¯å­˜å‚¨æ•°æ®çš„æœºåˆ¶ï¼Œå®ƒå¯ä»¥åœ¨å®¢æˆ·ç«¯å­˜å‚¨æˆ–è¯»å–æ•°æ®ï¼Œåœ¨ä¸€äº›ç®€å•çš„ç”¨æˆ·é…ç½®æˆ–æœ¬åœ°ç¼“å­˜æ•°æ®ç­‰åœºæ™¯éƒ½ä¼šç”¨åˆ°ã€‚è€ŒgetItemå°±æ˜¯è¯»å–æ•°æ®çš„æ–¹æ³•ã€‚</p><p>æ—¢ç„¶æ•°æ®æ˜¯å­˜å‚¨åœ¨æµè§ˆå™¨æœ¬åœ°ï¼Œä¹Ÿå°±æ˜¯è¯´è¿˜å¾—éœ€è¦ç¨‹åºä¸»åŠ¨åœ°å­˜å‚¨æ‰ä¼šæœ‰æ•°æ®ã€‚é‚£æˆ‘ä»¬å‡è®¾ï¼Œåœ¨è¯»å–æ•°æ®ä¹‹å‰ï¼Œå°±æ²¡æœ‰è¢«å­˜å‚¨èµ·æ¥ï¼Œåç»­çš„ä½¿ç”¨æ•°æ®é€»è¾‘åº”è¯¥æ€ä¹ˆå…¼å®¹å‘¢ï¼Ÿ</p><p>æˆ‘ä»¬å…ˆæ¥åˆ†æä¸‹åœºæ™¯ã€‚</p><p>ä»ä¸Šé¢çš„ä»£ç é€»è¾‘æ¥çœ‹ï¼Œ<code>getItem</code> è¯»å–æ•°æ®å­˜åœ¨ä¸å¯é¢„ä¼°çš„è¾“å‡ºç»“æœï¼Œæ˜¯å› ä¸ºæˆ‘ä»¬æ²¡æœ‰åšå®¹é”™å¤„ç†å—ï¼Ÿé‚£åç»­çš„é€»è¾‘æ˜¯æˆ‘ä»¬é¢„æƒ³è¦çš„ç»“æœå—ï¼Ÿ</p><p>æ¢ä¸ªè§’åº¦ï¼Œä»ä¸šåŠ¡é€»è¾‘æ¥çœ‹ï¼Œä¸ºä»€ä¹ˆgetItemè·å–ä¸åˆ°æ•°æ®å‘¢ï¼Ÿæ˜¯å› ä¸ºæˆ‘ä»¬çš„é€»è¾‘ä¸å¤Ÿä¸¥è°¨å—ï¼Ÿè¿˜æ˜¯è¯´æˆ‘ä»¬å…è®¸å®ƒå­˜åœ¨ç©ºå€¼å‘¢ï¼Ÿ</p><p>åœ¨æˆ‘çœ‹æ¥ï¼Œæˆ‘ä»¬æ— æ³•ç”¨ä»»ä½•æ•°æ®æˆ–è¯æ®æ¥è¯æ˜æˆ‘ä»¬çŒœæµ‹çš„é—®é¢˜ã€‚å”¯ä¸€èƒ½åšçš„å°±æ˜¯åœ¨çœŸå®çš„ç¯å¢ƒå’Œç”¨æˆ·è¡Œä¸ºä¸‹æ•è·é—®é¢˜çš„è¯æ®ï¼Œæ‰èƒ½çŸ¥é“å¦‚ä½•è§£å†³ã€‚ä¸ç®¡æ€æ ·ï¼Œä½¿ç”¨<code>localStorage.getItem</code> æ–¹æ³•è·å–æ•°æ®éƒ½æ˜¯ä¸å¯ä¿¡ä»»çš„ï¼Œææœ‰å¯èƒ½è¿”å›undefinedã€‚å¦‚æœè¿”å›å€¼æ˜¯undefinedï¼Œé‚£è¿è¡ŒJSON.parseå°±æ˜¯ä¸å¯é¢„æœŸçš„ç»“æœäº†ã€‚</p><p>ç°åœ¨ï¼Œæˆ‘ä»¬å°è¯•æ¥ä¼˜åŒ–ä¸Šé¢çš„ä»£ç ï¼Œè®©ä»£ç å‡ºç°å¼‚å¸¸æ—¶ï¼Œä¾æ—§èƒ½æ•è·åˆ°ç°åœºçš„ä¿¡æ¯ã€‚</p><p>ç¬¬ä¸€æ­¥å°±æ˜¯æŠŠ <code>localStorage.getItem</code> ä¹Ÿä¸€å¹¶æ”¾åˆ°try-catché‡Œã€‚</p><pre><code class=\"language-typescript\">function recommendCourseList() {\n&nbsp; try {\n\tconst result = localStorage.getItem('userInfo')\n&nbsp; &nbsp; const resObj = JSON.parse(result)\n&nbsp; &nbsp; const list = getRecommendCourseList(resObj.userId);\n&nbsp; &nbsp; return list\n&nbsp; } catch (err) {\n&nbsp; &nbsp; console.error(err)\n&nbsp; &nbsp; // é€šè¿‡è‡ªå®šä¹‰é“¾è·¯æ—¥å¿—å‡½æ•°ä¸ŠæŠ¥åˆ°æœåŠ¡å™¨\n&nbsp; &nbsp; traceSDK.error(err.message, 'recommendCourseList')\n&nbsp; &nbsp; return []\n&nbsp; }\n&nbsp; return []&nbsp;\n}\n</code></pre><p>å¥½äº†ï¼Œæˆ‘ä»¬ç¨å¾®ç§»ä¸€ä¸‹ä½ç½®åï¼Œå°±æš‚æ—¶è§£å†³äº†å‰é¢çš„é—®é¢˜ã€‚ä¸è¿‡ï¼Œ<code>localStorage</code> é€»è¾‘å’Œ <code>JSON.parse</code> é€»è¾‘éƒ½æ”¾åœ¨åŒä¸€ä¸ªtry-catché‡Œï¼Œåœ¨çœŸå®çš„ç¯å¢ƒä¸‹ï¼Œå®ƒä»¬ä¿©éƒ½æœ‰å¯èƒ½å› ä¸ºè¾“å…¥çš„ä¸ç¡®å®šæ€§å¯¼è‡´å¼‚å¸¸æŠ¥é”™ã€‚è¿™æ ·æˆ‘ä»¬å°±å¾ˆéš¾åˆ¤æ–­ç©¶ç«Ÿæ˜¯å“ªä¸€è¡Œä»£ç æŠ¥é”™çš„ï¼Œæ˜¯å“ªä¸ªä½ç½®çš„è¾“å…¥å¯¼è‡´çš„é—®é¢˜ã€‚</p><p>æ‰€ä»¥ï¼Œç¬¬äºŒæ­¥ä¼˜åŒ–æ˜¯å°è£… <code>localStorage.getItem</code>ï¼Œè®©è¯¥å‡½æ•°èƒ½åœ¨æ›´å¤šåœºæ™¯ä¸‹æ¥å…¥å…¨é“¾è·¯çš„ç›‘è§†èŒƒå›´ã€‚</p><pre><code class=\"language-typescript\">function getItem(key: string) {\n&nbsp; try {\n&nbsp; &nbsp; const result = localStorage.getItem(key)\n&nbsp; &nbsp; if (result === undefined) {\n&nbsp; &nbsp; &nbsp; console.warn(`GET KEY[${key}] Not Found.`)\n&nbsp; &nbsp; &nbsp; return null\n&nbsp; &nbsp; }\n&nbsp; &nbsp; return result\n&nbsp; } catch (err) {\n&nbsp; &nbsp; console.warn(`GET KEY[${key}] error. message: ${err.message}`)\n\t&nbsp; traceSDK.warn(`GET KEY[${key}] error. message: ${err.message}`)\n&nbsp; &nbsp; return null\n&nbsp; }\n}\n</code></pre><p>ç¬¬ä¸‰æ­¥ä¼˜åŒ–ï¼Œå°±æ˜¯å¤„ç† <code>recommendCourseList</code> å‡½æ•°å†…æ•°æ®çš„å®¹é”™å¤„ç†ï¼Œè®©æˆ‘ä»¬èƒ½å¤Ÿå®æ—¶äº†è§£çœŸå®å¼‚å¸¸æƒ…å†µã€‚</p><pre><code class=\"language-typescript\">function recommendCourseList() {\n&nbsp; const result = getItem('userInfo')\n&nbsp; if (result !== null) {\n&nbsp; &nbsp; try {\n&nbsp; &nbsp; &nbsp; const resObj = JSON.parse(result)\n&nbsp; &nbsp; &nbsp; const list = getRecommendCourseList(resObj.userId);\n&nbsp; &nbsp; &nbsp; return list\n&nbsp; &nbsp; } catch (err) {\n&nbsp; &nbsp; &nbsp; console.error(err)\n&nbsp; &nbsp; &nbsp; // é€šè¿‡è‡ªå®šä¹‰é“¾è·¯æ—¥å¿—å‡½æ•°ä¸ŠæŠ¥åˆ°æœåŠ¡å™¨\n&nbsp; &nbsp; &nbsp; traceSDK.error(err.message, 'recommendCourseList|JSON.parse')\n&nbsp; &nbsp; &nbsp; return []\n&nbsp; &nbsp; }\n&nbsp; }\n&nbsp; console.warn('get[userInfo] value is null. ')\n&nbsp; traceSDK.warn('get[userInfo] value is null. ', 'recommendCourseList|getUserInfo')\n&nbsp; return []&nbsp;\n}\n</code></pre><p>ç»è¿‡ä¼˜åŒ–ä¹‹åï¼Œ <code>recommendCourseList</code> å‡½æ•°çš„é€»è¾‘å·²ç»åœ¨æˆ‘ä»¬çš„å…¨é“¾è·¯ç›‘æ§èŒƒå›´å†…ã€‚</p><p>å› ä¸ºå…¨é“¾è·¯æ—¥å¿—éƒ½èƒ½è¦†ç›–åˆ°æ¯ä¸ªé€»è¾‘åœºæ™¯ï¼Œä¾‹å¦‚è¾“å…¥è¾“å‡ºçš„å¼‚å¸¸ï¼Œæœ‰ifå°±å¿…é¡»æœ‰elseï¼Œå†…ç½®å‡½æ•°çš„é”™è¯¯æŠ›å‡ºç­‰ç­‰ã€‚</p><h3>Promiseçš„rejectå‡½æ•°</h3><p>æ­¤å¤–ï¼Œè¿˜å­˜åœ¨ä¸€ç§ç‰¹æ®Šçš„æƒ…å†µï¼Œå°±æ˜¯å¼‚æ­¥å‡½æ•°çš„åº”ç”¨åœºæ™¯ã€‚é€šå¸¸ï¼Œæˆ‘ä»¬ä¼šç”¨Promiseå¯¹è±¡æ¥è§£å†³å¼‚æ­¥çš„é—®é¢˜ã€‚Promiseå¯¹è±¡æ˜¯JavaScriptä¸­å¤„ç†å¼‚æ­¥æ“ä½œçš„ä¸€ç§æœºåˆ¶ï¼Œå®ƒå¯ä»¥å¸®åŠ©æˆ‘ä»¬æ›´å¥½åœ°å¤„ç†å¼‚æ­¥é€»è¾‘ã€‚</p><p>æˆ‘ä»¬éƒ½çŸ¥é“ï¼Œåœ¨å¤„ç†å¼‚æ­¥ä¸šåŠ¡é€»è¾‘çš„è¿‡ç¨‹ä¸­ï¼ŒPromiseè¦é¢å¯¹è®¸å¤šå¤æ‚çš„æƒ…å†µã€‚æœ‰äº›æƒ…å†µå¿…é¡»ä½¿ç”¨ <code>reject</code> æŠ›å‡ºå¤±è´¥ã€å¼‚å¸¸ç­‰çŠ¶æ€ï¼Œæ‰èƒ½å¤Ÿè®©ä¸šåŠ¡æ ¹æ®å®é™…æƒ…å†µä½œå‡ºé€»è¾‘çš„è°ƒæ•´ã€‚</p><p>æ—¢ç„¶è¿™ç§å¼‚å¸¸ã€å¤±è´¥å­˜åœ¨æ¦‚ç‡æ€§é—®é¢˜ï¼Œæˆ‘ä»¬å°±éœ€è¦ç›‘æ§è¿™äº›æ¦‚ç‡é—®é¢˜ï¼Œææ—©å‘ç°å¹¶ä¿®å¤ã€‚æ€ä¹ˆåšå‘¢ï¼Ÿæœ€ç®€å•çš„æ–¹æ³•å°±æ˜¯å¢åŠ é“¾è·¯æ—¥å¿—ï¼Œä¾‹å¦‚ä¸‹é¢ä»£ç ã€‚</p><pre><code class=\"language-typescript\">const example = new Promise(function(resolve, reject) {\n&nbsp; try {\n&nbsp; &nbsp; throw new Error('test');\n&nbsp; } catch(e) {\n&nbsp; &nbsp; reject(e);\n&nbsp; }\n})\n\nexample.catch(function(error) {\n&nbsp; console.log(error);\n&nbsp; traceSDK.warn(err.message, 'Promise|example|catch')\n});\n</code></pre><p>ä»ä¸Šè¿°ä»£ç å¯ä»¥çœ‹åˆ°ï¼Œå…¶å®ç°åœ¨çš„é€»è¾‘åªé’ˆå¯¹äº†å½“å‰çš„Promiseå¯¹è±¡ï¼Œä½†å¹¶éæ¯ä¸ªä¸šåŠ¡Promiseé€»è¾‘éƒ½ä¼šå®šä¹‰catchäº‹ä»¶ã€‚é‚£ä¸‹ä¸€ä¸ªé—®é¢˜å°±æ˜¯ï¼Œæ€ä¹ˆæ‰èƒ½æ•è·æ‰€æœ‰æœªå®šä¹‰catchäº‹ä»¶çš„å¼‚æ­¥é—®é¢˜å‘¢ï¼Ÿ</p><p>æˆ‘ä»¬å¯ä»¥é€šè¿‡ç›‘å¬unhandlerrejectionäº‹ä»¶æ¥è¾¾åˆ°æ•è·è¿™äº›å¼‚æ­¥é—®é¢˜ï¼Œå…·ä½“å®ç°çš„ä»£ç å¦‚ä¸‹ã€‚</p><pre><code class=\"language-typescript\">window.addEventListener('unhandledrejection', function(event) {\n&nbsp; console.warn('Unhandled Promise Rejection:', event.reason);\n  traceSDK.warn(event.reason, 'Promise|example|catch')\n});\n</code></pre><h3>æ›´å¤šä¸šåŠ¡åœºæ™¯</h3><p>äº‹å®ä¸Šï¼Œä¸€ä¸ªå¤§å‹çš„å‰ç«¯åº”ç”¨ï¼Œä¸æ­¢ä¸Šé¢ä¸¾ä¾‹çš„ä¸‰ç§ä»£ç é€»è¾‘åœºæ™¯ã€‚</p><p>é¦–å…ˆæ˜¯<strong>æ ¸å¿ƒä¸šåŠ¡æµç¨‹</strong>ã€‚â€œæ ¸å¿ƒâ€çš„å®šä¹‰æ˜¯åªè¦è¿™æ®µä»£ç æŠ¥é”™æˆ–è€…æ˜¯å‡½æ•°è¿è¡ŒæŠ¥é”™éƒ½ä¼šå¯¼è‡´JavaScriptè„šæœ¬æ‰§è¡Œä¸­æ–­ï¼ŒåŠŸèƒ½æ— æ³•ç»§ç»­ä½¿ç”¨ã€‚è¿™ç§æƒ…å†µå°±å¿…é¡»åšå¥½é“¾è·¯æ—¥å¿—åŸ‹ç‚¹å·¥ä½œï¼Œå®æ—¶ç›‘æ§è„šæœ¬è¿è¡Œçš„çŠ¶æ€ã€‚</p><p>ç¬¬äºŒå°±æ˜¯<strong>ä½¿ç”¨ç¬¬ä¸‰æ–¹JavaScriptåº“æˆ–SDK</strong>ï¼Œä¾‹å¦‚å‰ç«¯å’ŒAppåŸç”Ÿçš„é€šè®¯SDKï¼Œå°ç¨‹åºä¹Ÿä¼šä½¿ç”¨ä¸€äº›åŸç”Ÿæ–¹æ³•ã€‚ä¾èµ–å¤–éƒ¨çš„äº¤äº’å¾€å¾€æ˜¯é—®é¢˜å‡ºç°æœ€é¢‘ç¹çš„åœ°æ–¹ï¼Œå› æ­¤æˆ‘ä»¬ä¹Ÿå¿…é¡»è¦åšå¥½é“¾è·¯æ—¥å¿—åŸ‹ç‚¹ï¼Œä¿è¯æ’æŸ¥é—®é¢˜æ—¶èƒ½å¤Ÿé€šè¿‡æ—¥å¿—åˆ¤æ–­é—®é¢˜çš„å®é™…æƒ…å†µã€‚</p><p>ç¬¬ä¸‰æ˜¯å‰ç«¯é¡µé¢æœ‰å¤§é‡çš„<strong>å…¨å±€äº‹ä»¶å’Œå…ƒç´ äº‹ä»¶</strong>ï¼Œä¾‹å¦‚è§¦å±äº‹ä»¶ <code>touchstart</code> å’Œ <code>touchend</code>ã€é¡µé¢æ˜¾ç¤ºä¸éšè—çš„ <code>pageHide</code> å’Œ <code>pageShow</code> äº‹ä»¶ï¼Œè¿˜æœ‰é¡µé¢æ»šåŠ¨äº‹ä»¶ <code>onScroll</code> ç­‰ç­‰ã€‚è¿™äº›äº‹ä»¶éƒ½ä¼šå½±å“ç”¨æˆ·çš„ä½¿ç”¨ä½“éªŒï¼Œæˆ‘å»ºè®®æ ¹æ®å®é™…æƒ…å†µå»åŸ‹ç‚¹é“¾è·¯æ—¥å¿—ï¼Œé€šè¿‡ç›‘æ§äº‹ä»¶å¸®åŠ©æå‰å‘ç°é—®é¢˜ã€‚</p><h2>æ€»ç»“</h2><p>è¿™èŠ‚è¯¾æˆ‘ä»¬é‡ç‚¹å­¦ä¹ äº†å‰ç«¯å…¨é“¾è·¯çš„è‡ªå®šä¹‰é“¾è·¯æ—¥å¿—ï¼Œå®ƒèƒ½é€šè¿‡åŸ‹ç‚¹ç›‘æ§é¡µé¢æˆ–åŠŸèƒ½çš„çŠ¶æ€ï¼Œå¸®åŠ©å‰ç«¯åŒå­¦åœ¨ä¸šåŠ¡é€»è¾‘ä¸­æå‰å‘ç°é—®é¢˜ã€‚</p><p>åœ¨è¯¾ç¨‹é‡Œï¼Œæˆ‘ä»¬é€šè¿‡å®ç°é€šç”¨çš„æ—¥å¿—å‡½æ•°å’Œä¸åŒç­‰çº§çš„æ—¥å¿—å‡½æ•°ä¸¤ç§æ–¹å¼ï¼Œè®©å‰ç«¯åŒå­¦å¯ä»¥åœ¨ä¸åŒçš„ä¸šåŠ¡åœºæ™¯ä¸‹è°ƒç”¨æ—¥å¿—å‡½æ•°ã€‚åŒæ—¶ï¼Œæˆ‘è¿˜ä¸¾äº†ä¸‰ç§æœ€å¸¸è§çš„ä¸šåŠ¡åœºæ™¯æ¡ˆä¾‹ï¼Œå¸®åŠ©ä½ äº†è§£è‡ªå®šä¹‰æ—¥å¿—å‡½æ•°çš„ä½¿ç”¨æ–¹æ³•ã€‚</p><p>å‰ç«¯å…¨é“¾è·¯çš„è‡ªå®šä¹‰æ—¥å¿—å‡½æ•°ï¼Œæ˜¯å¸®åŠ©ä¸šåŠ¡é€»è¾‘å‘ç°é—®é¢˜è€Œå­˜åœ¨çš„ã€‚æˆ‘ä»¬åœ¨å®ç°ä¸šåŠ¡é€»è¾‘æ—¶ï¼Œä¸èƒ½æ€»æ˜¯å…³å¿ƒåŠŸèƒ½æ˜¯å¦‚ä½•å®ç°çš„ï¼Œè¿˜å¿…é¡»å…³æ³¨åŠŸèƒ½çš„éæ­£å¸¸æµç¨‹çŠ¶æ€ä»¥åŠå¼‚å¸¸æƒ…å†µçš„å½±å“èŒƒå›´ã€‚</p><p>å½“ç„¶ï¼Œæœ‰æ—¶å€™æˆ‘ä»¬ä¸å¯èƒ½ä¸€ä¸‹å­å°±æŠŠåŠŸèƒ½çš„å®ç°æƒ³å¾—å¾ˆé€ï¼Œç‰¹åˆ«æ˜¯ç»è¿‡å¤šæ¬¡è¿­ä»£çš„åŒä¸€ä»½ä»£ç ï¼Œæ›´éœ€è¦é€šè¿‡åŸ‹ç‚¹æ¥ç›‘æ§å®ƒï¼Œç¡®ä¿æˆ‘ä»¬ä»£ç çš„è´¨é‡èƒ½ç»è¿‡ä¸šåŠ¡çš„è€ƒéªŒã€‚</p><p>éœ€è¦å†æ¬¡å¼ºè°ƒçš„æ˜¯ï¼Œåœ¨å…¨é“¾è·¯è‡ªå®šä¹‰æ—¥å¿—åŸ‹ç‚¹æ–¹æ¡ˆé‡Œï¼Œæˆ‘ä»¬ä¸èƒ½åªå…³æ³¨é”™è¯¯åŸ‹ç‚¹ï¼Œéæ­£å¸¸æµç¨‹ã€å¼‚å¸¸æ•è·å’Œæ ¸å¿ƒé€»è¾‘ä¹Ÿæ˜¯å…¨é“¾è·¯ç›‘æ§çš„é‡è¦ç»„æˆéƒ¨åˆ†ã€‚</p><h2>æ€è€ƒé¢˜</h2><p>ç°åœ¨ç•™ç»™ä½ ä¸€é“æ€è€ƒé¢˜ã€‚ä½ ç°åœ¨è´Ÿè´£çš„å‰ç«¯é¡¹ç›®ä¸­ï¼Œè¿˜æœ‰å“ªäº›ä¸šåŠ¡åœºæ™¯éœ€è¦é€šè¿‡é“¾è·¯æ—¥å¿—é‡ç‚¹ç›‘æ§å‘¢ï¼Ÿä½ åº”è¯¥å¦‚ä½•ä¼˜åŒ–è¿™äº›ä¸šåŠ¡åœºæ™¯å’Œé“¾è·¯æ—¥å¿—ä¹‹é—´çš„é€»è¾‘å…³ç³»å‘¢ï¼Ÿä¸å¦¨å°è¯•ä¸‹ã€‚</p><p>æ¬¢è¿ä½ åœ¨ç•™è¨€åŒºå’Œæˆ‘äº¤æµã€‚å¦‚æœè§‰å¾—æœ‰æ‰€æ”¶è·ï¼Œä¹Ÿå¯ä»¥æŠŠè¯¾ç¨‹åˆ†äº«ç»™æ›´å¤šçš„æœ‹å‹ä¸€èµ·å­¦ä¹ ã€‚æˆ‘ä»¬ä¸‹èŠ‚è¯¾è§ï¼</p>","neighbors":{"left":{"article_title":"11ï½œç”¨æˆ·è¡Œä¸ºæŒ‡æ ‡ï¼šå¦‚ä½•æœ‰æ•ˆç›‘å¬ç”¨æˆ·äº¤äº’è¡Œä¸ºï¼Ÿ","id":772186},"right":{"article_title":"13ï½œå…³è”åç«¯ï¼šå¦‚ä½•é€šè¿‡SkywalkingæŠŠæ¥å£å…³è”åˆ°åç«¯æœåŠ¡ï¼Ÿ","id":774278}},"comments":[{"had_liked":false,"id":392579,"user_name":"è‹æœæœ","can_delete":false,"product_type":"c1","uid":2852467,"ip_address":"åŒ—äº¬","ucode":"12A62ED032F345","user_header":"https://static001.geekbang.org/account/avatar/00/2b/86/73/5190bbde.jpg","comment_is_top":true,"comment_ctime":1721270752,"is_pvip":false,"replies":null,"discussion_count":0,"race_medal":0,"score":2,"product_id":100759401,"comment_content":"å®Œæ•´æºç å…¥å£ï¼š\nhttps:&#47;&#47;github.com&#47;sankyutang&#47;fontend-trace-geekbang-course","like_count":0},{"had_liked":false,"id":390652,"user_name":"westfall","can_delete":false,"product_type":"c1","uid":1632773,"ip_address":"ä¸Šæµ·","ucode":"F3F5CB7DF695FC","user_header":"https://static001.geekbang.org/account/avatar/00/18/ea/05/9976b871.jpg","comment_is_top":false,"comment_ctime":1715857201,"is_pvip":false,"replies":[{"id":142515,"content":"ç¡®å®ä¼šæœ‰çš„ï¼Œæœ‰äº›æ“ä½œç³»ç»Ÿä¼šè¢«é­”æ”¹ï¼Œç”šè‡³ä»¥å®‰å…¨ä¸ºç†ç”±ï¼Œåˆ å‡ä¸å°‘å†…ç½®ç‰¹æ€§ã€‚","user_name":"ä½œè€…å›å¤","user_name_real":"ç¼–è¾‘","uid":1327155,"ctime":1719819984,"ip_address":"å¹¿ä¸œ","comment_id":390652,"utype":1}],"discussion_count":1,"race_medal":0,"score":2,"product_id":100759401,"comment_content":"è¯´å‡ºæ¥ä½ å¯èƒ½ä¸ä¿¡ï¼Œéƒ½ 2024 å¹´äº†ï¼Œè¿˜æœ‰ä¸€äº›å®‰å“æ‰‹æœºè‡ªå¸¦çš„æµè§ˆå™¨ä¸æ”¯æŒ localStorage","like_count":0,"discussions":[{"author":{"id":1327155,"avatar":"https://static001.geekbang.org/account/avatar/00/14/40/33/11e434ba.jpg","nickname":"ä¸‰æ©‹sankyu ğŸ©","note":"","ucode":"2129405EA8D3D7","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":647302,"discussion_content":"ç¡®å®ä¼šæœ‰çš„ï¼Œæœ‰äº›æ“ä½œç³»ç»Ÿä¼šè¢«é­”æ”¹ï¼Œç”šè‡³ä»¥å®‰å…¨ä¸ºç†ç”±ï¼Œåˆ å‡ä¸å°‘å†…ç½®ç‰¹æ€§ã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1719819984,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"å¹¿ä¸œ","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2,\"source\":0}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":395506,"user_name":"Ryan","can_delete":false,"product_type":"c1","uid":1687571,"ip_address":"æ¹–åŒ—","ucode":"A316CBB3CAB97B","user_header":"https://static001.geekbang.org/account/avatar/00/19/c0/13/52cd5ea8.jpg","comment_is_top":false,"comment_ctime":1730993621,"is_pvip":false,"replies":null,"discussion_count":0,"race_medal":0,"score":2,"product_id":100759401,"comment_content":"æƒ³é—®ä¸€ä¸‹è€å¸ˆï¼Œè¿™ä¸ªè¯¾æœ‰åšå‰ç«¯å¼‚å¸¸å›æ”¾å—ï¼Ÿå¾ˆæƒ³å­¦ä¹ è¿™å—æ€ä¹ˆåšï¼Œå®æ—¶å½•å±è‚¯å®šä¸è¡Œã€","like_count":0},{"had_liked":false,"id":392035,"user_name":"zer0fire","can_delete":false,"product_type":"c1","uid":1468410,"ip_address":"å››å·","ucode":"F51772844B1534","user_header":"https://static001.geekbang.org/account/avatar/00/16/67/fa/720f57fa.jpg","comment_is_top":false,"comment_ctime":1719802654,"is_pvip":false,"replies":null,"discussion_count":0,"race_medal":0,"score":2,"product_id":100759401,"comment_content":"è€å¸ˆæ˜¯å¦æœ‰ç©ºç”»ä¸€ä¸‹æ¶æ„è„‘å›¾å—ï¼Ÿæˆ–è€…è´´ä¸€ä¸‹ github åœ°å€ï¼Ÿæ„Ÿè§‰ç°åœ¨è´´çš„ä»£ç è™½ç„¶å·²ç»è®©æˆ‘å­¦åˆ°å¾ˆå¤šäº†ï¼Œä½†æ˜¯ç¼ºä¹ç»Ÿä¸€çš„è§†è§’ï¼Œæœ‰ç‚¹çç¢","like_count":0}]}