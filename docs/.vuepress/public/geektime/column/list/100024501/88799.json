{"id":88799,"title":"11 | çƒ­ç‚¹é—®é¢˜ç­”ç–‘ï¼ˆä¸€ï¼‰ï¼šåŸºç¡€æ¨¡å—é—®é¢˜ç­”ç–‘","content":"<p>ä½ å¥½ï¼Œæˆ‘æ˜¯æˆ´é“­ã€‚</p><p>ä¸“æ ä¸Šçº¿ä»¥æ¥ï¼Œæˆ‘é€šè¿‡è¯„è®ºåŒºæ”¶åˆ°äº†å¾ˆå¤šåŒå­¦æå‡ºçš„é—®é¢˜ã€å»ºè®®ã€å¿ƒå¾—å’Œç»éªŒï¼Œå½“ç„¶æçš„é—®é¢˜å±…å¤šã€‚è™½ç„¶æˆ‘æœªåœ¨è¯„è®ºåŒºå¯¹æ¯æ¡ç•™è¨€åšå‡ºå›å¤ï¼Œä½†æ˜¯æˆ‘å¯¹å¤§å®¶æå‡ºçš„é—®é¢˜å´éƒ½ä¸€ä¸€è®°å½•äº†ä¸‹æ¥ï¼Œç­‰å¾…è¿™æ¬¡ç­”ç–‘æ–‡ç« çš„åˆ°æ¥ã€‚å…¶å®ï¼Œä¸å…‰æ˜¯åœ¨ç•™è¨€åŒºï¼Œä¹Ÿæœ‰ä¸€äº›æœ‹å‹é€šè¿‡ç§ä¿¡è·Ÿæˆ‘åé¦ˆäº†å­¦ä¹ ä¸“æ é‡åˆ°çš„é—®é¢˜ã€‚</p><p>æ‰€ä»¥ï¼Œä»Šå¤©æˆ‘å°±å€Ÿæ­¤æœºä¼šï¼Œæ±‡æ€»å¹¶æ•´ç†äº†å‡ ä¸ªå…¸å‹å¹¶é‡è¦çš„é—®é¢˜ï¼Œå’Œä½ è¯¦ç»†è¯´ä¸€è¯´ï¼Œå¸Œæœ›å¯ä»¥è§£ç­”ä½ åœ¨å­¦ä¹ å‰é¢10ç¯‡æ–‡ç« æ—¶çš„ä¸€äº›å›°æƒ‘ã€‚</p><h2>åŠ¨æ€åº“åŠ è½½æ–¹å¼çš„ç›¸å…³é—®é¢˜</h2><p>@äº”å­æ£‹åœ¨çœ‹å®Œç¬¬5ç¯‡æ–‡ç« â€œ<a href=\"https://time.geekbang.org/column/article/86840\">é“¾æ¥å™¨ï¼šç¬¦å·æ˜¯æ€ä¹ˆç»‘å®šåˆ°åœ°å€ä¸Šçš„ï¼Ÿ</a>â€åï¼Œå…³äºåŠ¨æ€åº“æ˜¯å¦å‚ä¸é“¾æ¥çš„é—®é¢˜ï¼Œé€šè¿‡ç§ä¿¡å’Œæˆ‘åé¦ˆäº†ä»–çš„è§‚ç‚¹ã€‚ä»–æŒ‡å‡ºï¼šåŠ¨æ€åº“ä¹Ÿæ˜¯è¦å‚ä¸é“¾æ¥çš„ï¼Œä¸ç„¶å°±æ²¡æ³•çŸ¥é“å‡½æ•°çš„æ ‡è®°åœ¨å“ªå„¿ã€‚</p><p>ä¸ºäº†å¸®åŠ©å¤§å®¶ç†è§£è¿™ä¸ªé—®é¢˜ï¼Œæˆ‘æŠŠä¸è¿™ä¸ªé—®é¢˜ç›¸å…³çš„å†…å®¹ï¼Œå†å’Œä½ å±•å¼€ä¸€ä¸‹ã€‚</p><p>æˆ‘åœ¨æ–‡ç« ä¸­ï¼Œæ˜¯è¿™ä¹ˆé˜è¿°è¿™éƒ¨åˆ†å†…å®¹çš„ï¼š</p><blockquote>\n<p>Mach-O æ–‡ä»¶æ˜¯ç¼–è¯‘åçš„äº§ç‰©ï¼Œè€ŒåŠ¨æ€åº“åœ¨è¿è¡Œæ—¶æ‰ä¼šè¢«é“¾æ¥ï¼Œå¹¶æ²¡å‚ä¸ Mach-Oæ–‡ä»¶çš„ç¼–è¯‘å’Œé“¾æ¥ï¼Œæ‰€ä»¥ Mach-Oæ–‡ä»¶ä¸­å¹¶æ²¡æœ‰åŒ…å«åŠ¨æ€åº“é‡Œçš„ç¬¦å·å®šä¹‰ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œè¿™äº›ç¬¦å·ä¼šæ˜¾ç¤ºä¸ºâ€œæœªå®šä¹‰â€ï¼Œä½†å®ƒä»¬çš„åå­—å’Œå¯¹åº”çš„åº“çš„è·¯å¾„ä¼šè¢«è®°å½•ä¸‹æ¥ã€‚è¿è¡Œæ—¶é€šè¿‡ dlopen å’Œ dlsym å¯¼å…¥åŠ¨æ€åº“æ—¶ï¼Œå…ˆæ ¹æ®è®°å½•çš„åº“è·¯å¾„æ‰¾åˆ°å¯¹åº”çš„åº“ï¼Œå†é€šè¿‡è®°å½•çš„åå­—ç¬¦å·æ‰¾åˆ°ç»‘å®šçš„åœ°å€ã€‚</p>\n</blockquote><!-- [[[read_end]]] --><p>ç»†ç»†æƒ³æ¥ï¼Œè¿™ç§è¯´æ³•å¹¶ä¸ä¸¥è°¨ã€‚å…³äºè¿™ä¸ªé—®é¢˜ï¼Œæ›´ä¸¥è°¨çš„è¯´æ³•åº”è¯¥æ˜¯ï¼ŒåŠ è½½åŠ¨æ€åº“çš„æ–¹å¼æœ‰ä¸¤ç§ï¼š</p><ul>\n<li>ä¸€ç§æ˜¯ï¼Œåœ¨ç¨‹åºå¼€å§‹è¿è¡Œæ—¶é€šè¿‡ dyld åŠ¨æ€åŠ è½½ã€‚é€šè¿‡ dyld åŠ è½½çš„åŠ¨æ€åº“éœ€è¦åœ¨ç¼–è¯‘æ—¶è¿›è¡Œé“¾æ¥ï¼Œé“¾æ¥æ—¶ä¼šåšæ ‡è®°ï¼Œç»‘å®šçš„åœ°å€åœ¨åŠ è½½åå†å†³å®šã€‚</li>\n<li>ç¬¬äºŒç§æ˜¯ï¼Œæ˜¾å¼è¿è¡Œæ—¶é“¾æ¥ï¼ˆExplicit Runtime Linkingï¼‰ï¼Œå³åœ¨è¿è¡Œæ—¶é€šè¿‡åŠ¨æ€é“¾æ¥å™¨æä¾›çš„ API dlopen å’Œ dlsym æ¥åŠ è½½ã€‚è¿™ç§æ–¹å¼ï¼Œåœ¨ç¼–è¯‘æ—¶æ˜¯ä¸éœ€è¦å‚ä¸é“¾æ¥çš„ã€‚ï»¿<br>\nï»¿ä¸è¿‡ï¼Œé€šè¿‡è¿™ç§è¿è¡Œæ—¶åŠ è½½è¿œç¨‹åŠ¨æ€åº“çš„Appï¼Œè‹¹æœå…¬å¸æ˜¯ä¸å…è®¸ä¸Šçº¿ App Store çš„ï¼Œæ‰€ä»¥åªèƒ½ç”¨äºçº¿ä¸‹è°ƒè¯•ç¯èŠ‚ã€‚å…³äºè¿™ç§æ–¹å¼çš„é€‚ç”¨åœºæ™¯ï¼Œæˆ‘ä¹Ÿå·²ç»åœ¨æ–‡ç« ç¬¬6ç¯‡æ–‡ç« â€œ<a href=\"https://time.geekbang.org/column/article/87188\">App å¦‚ä½•é€šè¿‡æ³¨å…¥åŠ¨æ€åº“çš„æ–¹å¼å®ç°æé€Ÿç¼–è¯‘è°ƒè¯•ï¼Ÿ</a>â€ä¸­å’Œä½ ä¸¾ä¾‹è¯´æ˜è¿‡ï¼Œä½ å¯ä»¥å†å›é¡¾ä¸‹ç›¸å…³å†…å®¹ã€‚</li>\n</ul><p>åœ¨ç¬¬5ç¯‡æ–‡ç« ä¸­ï¼Œæˆ‘å°†åŠ¨æ€åº“çš„è¿™ä¸¤ç§åŠ è½½æ–¹å¼æ··åœ¨ä¸€èµ·è¯´äº†ï¼Œè®©ä½ æ„Ÿåˆ°äº›è®¸å›°æƒ‘ï¼Œæ‰€ä»¥åœ¨è¿™é‡Œæˆ‘ç‰¹åœ°åšä¸ªè¡¥å……è¯´æ˜ã€‚</p><p>æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬å°±å†çœ‹çœ‹ç¬¬6ç¯‡æ–‡ç« åçš„ç•™è¨€ã€‚è¿™ç¯‡æ–‡ç« ç•™è¨€åŒºçš„é—®é¢˜é›†ä¸­åœ¨ï¼šé¡¹ç›®ä¸­ä½¿ç”¨äº†CocoaPodsæ¥å¼€å‘ç»„ä»¶ï¼Œåœ¨ä½¿ç”¨InjectionIIIè°ƒè¯•æ—¶ï¼Œé‡åˆ°äº†ä¿®æ”¹æºç æ— æ³•è¿›è¡Œæ³¨å…¥çš„é—®é¢˜ã€‚</p><p>åœ¨è¿™é‡Œï¼Œæˆ‘é¦–å…ˆè¦æ„Ÿè°¢@manajayåŒå­¦åœ¨ InjectionIII çš„ issue é‡Œæ‰¾åˆ°äº†ç›¸å…³çš„è§£ç­”ï¼Œå¹¶åˆ†äº«åˆ°äº†ç•™è¨€åŒºã€‚</p><p>å…¶å®ï¼Œ<strong>å…³äº InjectionIII çš„è¿™éƒ¨åˆ†å†…å®¹ï¼Œæˆ‘æ›´å¸Œæœ›ä½ èƒ½å¤Ÿäº†è§£ InjectionIII çš„å·¥ä½œåŸç†ï¼Œä»è€ŒåŠ æ·±å¯¹è¿è¡Œæ—¶åŠ¨æ€åº“åŠ è½½åŸç†çš„ç†è§£ã€‚</strong>ç„¶åï¼Œæ ¹æ®è‡ªå·±çš„å·¥ç¨‹æƒ…å†µåŠ¨æ‰‹æ”¹é€ æˆ–è€…ç›´æ¥é€ ä¸ªæ–°è½®å­ï¼Œæˆ‘ç›¸ä¿¡ä¼šæå¤§åœ°æå‡ä½ çš„æŠ€æœ¯æ°´å¹³ï¼Œè‡³å°‘æ¯”ç›´æ¥ä½¿ç”¨å·²æœ‰è½®å­çš„æ•ˆæœè¦å¥½å¾—å¤šã€‚</p><p>æ‰€ä»¥ï¼Œè¿˜æ˜¯å›åˆ°æˆ‘åœ¨<a href=\"https://time.geekbang.org/column/article/85318\">å¼€ç¯‡è¯</a>ä¸­å’Œä½ æåˆ°çš„è§‚ç‚¹ï¼šåŠ¨æ‰‹å°±ä¼šç¢°åˆ°é—®é¢˜ï¼Œå°±ä¼šæ€è€ƒï¼Œè¿™ä¸ªä¸»åŠ¨è¿‡ç¨‹ä¼šåŠ æ·±ä½ çš„è®°å¿†ï¼Œè¿™æ ·åé¢å†ç¢°åˆ°é—®é¢˜æ—¶ï¼Œä½ ä¼šæ›´å®¹æ˜“å°†ç›¸å…³çŸ¥è¯†ä¸²è”èµ·æ¥ï¼Œå½¢æˆåˆ›æ–°å¼çš„æ€è€ƒã€‚ä½†å¦‚æœä½ åœ¨ç¢°åˆ°å›°éš¾æ—¶ï¼Œå°±é€‰æ‹©æ”¾å¼ƒé‚£å¿…å®šä¼šæŠ±æœ‰é—æ†¾ã€‚</p><p>åœ¨ç¬¬8ç¯‡æ–‡ç« â€œ<a href=\"https://time.geekbang.org/column/article/87844\">å¦‚ä½•åˆ©ç”¨ Clang ä¸º App æè´¨ï¼Ÿ</a>â€ä¸­ï¼Œ@é¹å“¥åŒå­¦åœ¨è¯„è®ºåŒºé—®äº†æˆ‘è¿™æ ·ä¸€ä¸ªé—®é¢˜ï¼š</p><blockquote>\n<p>åœ¨ç¬¬1ç¯‡æ–‡ç« â€œ<a href=\"https://time.geekbang.org/column/article/85326\">å»ºç«‹ä½ è‡ªå·±çš„iOSå¼€å‘çŸ¥è¯†ä½“ç³»</a>â€ä¸­ï¼Œä½ æåˆ°å¯¹æŸä¸€é¢†åŸŸçš„çŸ¥è¯†è¦åšåˆ°ç²¾é€šçš„ç¨‹åº¦ï¼Œè€Œä¸èƒ½åªæ˜¯äº†è§£ã€‚é‚£ä¹ˆï¼Œä½ åœ¨è¿™ä¸ªä¸“æ ä¸­æåˆ°äº†è¿™ä¹ˆå¤šå†…å®¹ï¼Œæˆ‘åº”è¯¥é€‰æ‹©å“ªäº›å†…å®¹å»æ·±å…¥ç ”ç©¶å‘¢ï¼Ÿè¿˜æ˜¯è¯´æ‰€æœ‰çš„å†…å®¹ï¼Œæˆ‘éƒ½éœ€è¦å»æ·±å…¥ç ”ç©¶ï¼Ÿ</p>\n</blockquote><p>æˆ‘ç»™å‡ºçš„å›ç­”æ˜¯ï¼Œæ ¹æ®å·¥ä½œéœ€è¦æ¥é€‰æ‹©ã€‚æ¯”å¦‚è¯´ï¼Œå¦‚æœè°ƒè¯•é€Ÿåº¦çš„é—®é¢˜ï¼Œç¡®å®æ˜¯ä½ ç›®å‰å·¥ä½œä¸­é¢ä¸´çš„æœ€å¤§æŒ‘æˆ˜ï¼Œé‚£æˆ‘è§‰å¾—ä½ å°±åº”è¯¥åœ¨è¿™ä¸ªç‚¹ä¸Šæ·±æŒ–ï¼Œå¹¶å‹‡æ•¢åœ°å…‹æœå…¶ä¸­é‡åˆ°çš„å›°éš¾ï¼Œå°±åƒæˆ‘ä¸Šæ¬¡é€šè¿‡â€œæå®¢æ—¶é—´â€çš„å¹³å°ç›´æ’­æ—¶ï¼Œå’Œä½ åˆ†äº«çš„æˆ‘è‡ªå·±å­¦ç”»ç”»çš„ç»å†ä¸€æ ·ï¼ŒæŒ‘æˆ˜ç´ æçš„è¿‡ç¨‹ç¡®å®å¾ˆç—›è‹¦ï¼Œä½†æŒºè¿‡æ¥äº†ä¹‹åæˆ‘ä¼šå¾ˆå—ç›Šå¹¶äº«å—è‡ªå·±çš„è¿›æ­¥ã€‚å¯¹æˆ‘ä»¬è¿™ç§æ‰‹è‰ºäººæ¥è¯´ï¼Œä¸æ–­æŒ‘æˆ˜æ‰èƒ½ä¸æ–­è¿›æ­¥ã€‚</p><p>æœ€è¿‘æˆ‘åœ¨çœ‹ä¸€ä¸ªè±†ç“£è¯„åˆ†éå¸¸é«˜çš„æ—¥å‰§ã€ŠåŒ—å›½ä¹‹æ‹ã€‹ï¼Œåœ¨ç¬¬3é›†â€œå†³å¿ƒâ€é‡Œï¼Œä¸€ä½è€çˆ·çˆ·åœ¨åŒ—æµ·é“é€åˆ«æœ‹å‹æ—¶è¯´äº†ä¸€ç•ªè¯ï¼Œæˆ‘è§‰å¾—ç‰¹åˆ«æœ‰åŠ›é‡ã€‚æ‰€ä»¥ï¼Œæˆ‘æŠŠè¿™æ®µè¯æ”¾åœ¨è¿™é‡Œå’Œä½ å…±å‹‰ï¼š</p><blockquote>\n<p>ä¸å¯æ€è®®å•Šï¼Œè™½ç„¶æ˜¯æµè¡Œæ­Œæ›²ï¼Œä¸è¿‡å‘¢ã€‚å¬åˆ°è¿™é¦–æ­Œï¼Œè¿™æ­Œæµè¡Œèµ·æ¥ï¼Œè®©äººå›æƒ³èµ·é‚£ä¸ªæ—¶ä»£çš„å¾€äº‹ã€‚é‚£å¹´å‘ç”Ÿäº†å¾ˆä¸¥é‡çš„å†»ç¾ï¼Œå†åŠ ä¸Šå†œä¸šæœºæ¢°çš„å¼•è¿›ï¼Œå†œåœºçš„ç»è¥æ–¹å¼æ…¢æ…¢ä¸ä¸€æ ·äº†ã€‚ä¸€èµ·æ¥å¼€è’çš„ä¼™ä¼´ä»¬ï¼Œæ”¶æ‹¾è¡Œæï¼Œä¸€ä¸ªä¸€ä¸ªåœ°ä»éº“ä¹¡ç¦»å¼€äº†ã€‚é‚£æ˜¯11æœˆå•Šï¼Œäº²å¯†çš„ä¼™ä¼´ä»¬ï¼Œå››å®¶ä¸€èµ·æ”¾å¼ƒäº†å†œåœºï¼Œé‚£ä¸ªæ—¶å€™ï¼Œæˆ‘ï¼Œå½“ç„¶è¦æ¥é€è¡Œï¼Œç¨€ç¨€è½è½åœ°ä¸‹èµ·äº†é›ªï¼Œé‚£æ—¶æµè¡ŒåŒ—å²›ä¸‰éƒï¼Œæœ‰å››å®¶è¦ç¦»å¼€ï¼Œæ¥é€è¡Œçš„åªæœ‰æˆ‘å’Œè€å©†ä¸¤ä¸ªäººï¼Œå¤§å®¶éƒ½ä¸€å¥è¯ä¹Ÿä¸è¯´ã€‚ä¸è¿‡ï¼Œé‚£ä¸ªæ—¶å€™ï¼Œæˆ‘çœŸæƒ³æŠŠå¿ƒé‡Œæƒ³çš„è¯´å‡ºæ¥ã€‚ä½ ä»¬ï¼Œè¿™ä¹ˆåšè¡Œå—ï¼Ÿè¿™æ˜¯è¾“äº†ä¹‹åé€ƒè·‘å•Šï¼ŒäºŒåå¤šå¹´æ¥ä¸€ç›´åœ¨ä¸€èµ·åŠªåŠ›ï¼Œä½ ä»¬çš„å¿ƒé…¸ã€æ‚²å“€ã€æ‚”æ¨ï¼Œä¸€åˆ‡çš„ä¸€åˆ‡ï¼Œæˆ‘è‡ªä»¥ä¸ºéƒ½äº†è§£ã€‚å› æ­¤ï¼Œæˆ‘æ²¡æœ‰å¯¹åˆ«äººè¯´ä¸‰é“å››ï¼Œæ²¡æœ‰å¯¹åˆ«äººè‡ªä»¥ä¸ºæ˜¯åœ°æŒ‡æŒ‡ç‚¹ç‚¹ã€‚å¯æ˜¯ï¼Œè¯´è¿™å¥è¯çš„æƒåˆ©æˆ‘è¿˜æ˜¯æœ‰çš„ï¼Œä½ ä»¬å¤±è´¥äº†é€ƒè·‘äº†ï¼ŒèƒŒå›äº†æˆ‘ä»¬ã€‚é€ƒè·‘äº†ï¼Œè¿™ä¸€ç‚¹ï¼Œä½ ä»¬ç»™æˆ‘å¥½å¥½è®°ä½ã€‚</p>\n</blockquote><p>å¥½äº†ï¼Œæˆ‘ä»¬ç°åœ¨ç»§ç»­å›åˆ°ä¸“æ æ–‡ç« ä¸Šå§ã€‚</p><p>Appå¯åŠ¨æ—¶é€šè¿‡ dyld åŠ è½½åŠ¨æ€åº“ï¼Œå°±æ˜¯è¿è¡Œæ—¶åŠ¨æ€åº“åŠ è½½åœ¨Appå¯åŠ¨é€Ÿåº¦ä¼˜åŒ–ä¸Šçš„ä¸€ä¸ªåº”ç”¨åœºæ™¯ã€‚åœ¨ä¸“æ çš„ç¬¬2ç¯‡æ–‡ç« â€œ<a href=\"https://time.geekbang.org/column/article/85331\">App å¯åŠ¨é€Ÿåº¦æ€ä¹ˆåšä¼˜åŒ–ä¸ç›‘æ§ï¼Ÿ</a>â€ä¸­ï¼Œæˆ‘å’Œä½ åˆ†äº«äº†åŠ¨æ€åº“åŠ è½½åçš„ç›‘æ§å’Œä¼˜åŒ–ï¼Œæ–‡åçš„è¯„è®ºåŒºå°±æœ‰å¾ˆå¤šåŒå­¦æåˆ°äº†ï¼Œæƒ³è¦å¤šäº†è§£äº›åŠ¨æ€åº“åŠ è½½æ–¹é¢çš„ä¼˜åŒ–ã€‚</p><p>å…³äºAppå¼€å§‹å¯åŠ¨åˆ° main å‡½æ•°ä¹‹é—´çš„ dyld å†…éƒ¨ç»†èŠ‚ï¼Œæˆ‘æ¨èä½ å»çœ‹è‹¹æœå…¬å¸çš„ WWDC 2016 Session 406 <a href=\"https://developer.apple.com/videos/play/wwdc2016/406/\">Optimizing App Startup Time</a>è§†é¢‘ã€‚è¿™ä¸ªè§†é¢‘é‡Œé¢ï¼Œä¸ä»…è¯¦ç»†å‰–æäº† dyldï¼Œè¿˜æä¾›äº†æ„å»ºä»£ç çš„æœ€ä½³å®è·µã€‚</p><p>é™¤æ­¤ä¹‹å¤–ï¼Œâ€œ<a href=\"https://blog.automatic.com/how-we-cut-our-ios-apps-launch-time-in-half-with-this-one-cool-trick-7aca2011e2ea\">How we cut our iOS appâ€™s launch time in half (with this one cool trick)</a>â€è¿™ç¯‡åšå®¢ï¼Œä¹Ÿæ˜¯ä¸ªä¸é”™çš„é˜…è¯»èµ„æ–™ã€‚å…‰çœ‹åå­—å°±å¾ˆå¸å¼•äººäº†ï¼Œå¯¹å§ã€‚</p><p>å…³äºApp å¯åŠ¨é€Ÿåº¦çš„è¯é¢˜ï¼Œå¾ˆå¤šåŒå­¦è¿˜æå‡ºäº†å…¶ä»–é—®é¢˜ï¼ŒåŒ…æ‹¬å¾ˆå¤šå…³äºè¯¾åä½œä¸šçš„é—®é¢˜ã€‚æ‰€ä»¥æ¥ä¸‹æ¥ï¼Œæˆ‘å°±é’ˆå¯¹è¿™ä¸ªè¯é¢˜å†ä¸“é—¨åšä¸ªç­”ç–‘å§ã€‚</p><h2>App å¯åŠ¨é€Ÿåº¦çš„ç›¸å…³é—®é¢˜</h2><p>ä¸“æ çš„ç¬¬2ç¯‡æ–‡ç« â€œ<a href=\"https://time.geekbang.org/column/article/85331\">App å¯åŠ¨é€Ÿåº¦æ€ä¹ˆåšä¼˜åŒ–ä¸ç›‘æ§ï¼Ÿ</a>â€ä¸­çš„å¤§éƒ¨åˆ†é—®é¢˜ï¼Œæˆ‘éƒ½ç›´æ¥åœ¨è¯„è®ºåŒºå›å¤äº†ã€‚ä¸‹é¢çš„ç­”ç–‘å†…å®¹ï¼Œæˆ‘ä¸»è¦æ˜¯é’ˆå¯¹è¯¾åä½œä¸šå’Œæ±‡ç¼–éƒ¨åˆ†ï¼Œç»Ÿä¸€åšä¸‹å›å¤ã€‚</p><h3>å…³äºè¯¾åä½œä¸š</h3><p>åœ¨è¿™ç¯‡æ–‡ç« æœ€åï¼Œæˆ‘ç•™ä¸‹çš„è¯¾åä½œä¸šæ˜¯ï¼š</p><blockquote>\n<p>æŒ‰ç…§ä»Šå¤©æ–‡ä¸­æåˆ°çš„ Time Profiler å·¥å…·æ£€æŸ¥æ–¹æ³•è€—æ—¶çš„åŸç†ï¼Œä½ æ¥åŠ¨æ‰‹å®ç°ä¸€ä¸ªæ–¹æ³•è€—æ—¶æ£€æŸ¥å·¥å…·å§ã€‚</p>\n</blockquote><p>è™½ç„¶è¿™ä¸ªé—®é¢˜çš„æ€è·¯ï¼Œæˆ‘å·²ç»åœ¨æ–‡ç« ä¸­æåˆ°äº†ï¼Œä½†è¿˜æ˜¯æœ‰å¾ˆå¤šåŒå­¦æ„Ÿè§‰æ— ä»ä¸‹æ‰‹ã€‚æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬å°±å†ä¸€èµ·æ¥çœ‹çœ‹è¿™ä¸ªæ€è€ƒé¢˜å§ã€‚</p><p>å…³äºå®ç°æ€è·¯ï¼Œæ–‡ä¸­æœ‰æ€ä¹ˆä¸€æ®µæ–‡å­—ï¼š</p><blockquote>\n<p>å®šæ—¶æŠ“å–ä¸»çº¿ç¨‹ä¸Šçš„æ–¹æ³•è°ƒç”¨å †æ ˆï¼Œè®¡ç®—ä¸€æ®µæ—¶é—´é‡Œå„ä¸ªæ–¹æ³•çš„è€—æ—¶ã€‚</p>\n</blockquote><p>ç°åœ¨ï¼Œæˆ‘ä»¬å†ä¸€èµ·çœ‹ä¸€ä¸‹è¿™ä¸ªå®ç°æ€è·¯ï¼ˆæˆ‘åŸæœ¬æœªåœ¨æ–‡ä¸­è¯¦ç»†å±•å¼€ï¼Œæ˜¯å¸Œæœ›å¤šç•™ç‚¹æ€è€ƒç©ºé—´ç»™ä½ ï¼‰ã€‚åŠ¨æ‰‹å†™è€—æ—¶æ£€æŸ¥å·¥å…·æ—¶ï¼Œé¦–å…ˆéœ€è¦å¼€å¯ä¸€ä¸ªå®šæ—¶å™¨ï¼Œæ¥å®šæ—¶è·å–æ–¹æ³•è°ƒç”¨å †æ ˆã€‚ä¸€æ®µæ—¶é—´å†…æ–¹æ³•è°ƒç”¨å †æ ˆç›¸åŒï¼Œé‚£ä¹ˆè¿™æ®µæ—¶é—´ï¼Œå°±æ˜¯è¿™ä¸ªæ–¹æ³•è°ƒç”¨å †æ ˆçš„æ ˆé¡¶æ–¹æ³•è€—æ—¶ã€‚</p><p><strong>è¿™ä¸ªè§£é¢˜æ€è·¯é‡Œå¾ˆå…³é”®çš„ä¸€æ­¥ï¼Œä¹Ÿæ˜¯ä½ æœ€å®¹æ˜“å¿½è§†çš„ä¸€æ­¥ï¼Œå°±æ˜¯åº”è¯¥æ€ä¹ˆåšå¥½è·å–æ–¹æ³•è°ƒç”¨å †æ ˆã€‚</strong></p><p>callstackSymbols æ˜¯ä¸€ç§è·å–æ–¹æ³•è°ƒç”¨æ ˆçš„æ–¹æ³•ï¼Œä½†æ˜¯åªèƒ½è·å–å½“å‰çº¿ç¨‹çš„è°ƒç”¨æ ˆï¼Œä¸ºäº†æŠŠå¯¹ä¸»çº¿ç¨‹çš„å½±å“é™åˆ°æœ€å°ï¼Œè·å–å½“å‰çº¿ç¨‹è°ƒç”¨æ ˆçš„å·¥ä½œå°±éœ€è¦åœ¨å…¶ä»–çº¿ç¨‹å»åšã€‚æ‰€ä»¥ï¼Œ<strong>è¿™ä¸ªè§£é¢˜æ€è·¯å°±éœ€è¦æ¢æˆï¼š</strong>ä½¿ç”¨ç³»ç»Ÿæä¾›çš„ task_threads å»è·å–æ‰€æœ‰çº¿ç¨‹ï¼Œä½¿ç”¨thread_info å¾—åˆ°å„ä¸ªçº¿ç¨‹çš„è¯¦ç»†ä¿¡æ¯ï¼Œä½¿ç”¨thread_get_state æ–¹æ³•å»è·å–çº¿ç¨‹æ ˆé‡Œçš„æ‰€æœ‰æ ˆæŒ‡é’ˆã€‚</p><p>å¦‚æœæ¥ä¸‹æ¥ç«‹åˆ»è¿›è¡Œç¬¦å·åŒ–å»è·å–æ–¹æ³•åï¼Œé‚£ä¹ˆå°±éœ€è¦å» __LINKEDIT segment é‡ŒæŸ¥æ‰¾æ ˆæŒ‡é’ˆåœ°å€æ‰€å¯¹åº”ç¬¦å·è¡¨çš„ç¬¦å·ï¼Œç‰¹åˆ«å½“ä½ è®¾ç½®çš„æ—¶é—´éš”è¾ƒå°çš„æ—¶å€™ï¼Œç¬¦å·åŒ–è¿‡ç¨‹ä¼šæŒç»­æ¶ˆè€—è¾ƒå¤šçš„CPUèµ„æºï¼Œä»è€Œå½±å“ä¸»çº¿ç¨‹ã€‚</p><p>æ‰€ä»¥ï¼Œè·å–åˆ°æ ˆæŒ‡é’ˆåï¼Œæˆ‘ä»¬å¯ä»¥ä¸ç”¨ç«‹åˆ»åšç¬¦å·åŒ–ï¼Œè€Œæ˜¯å…ˆä½¿ç”¨ä¸€ä¸ªç»“æ„ä½“å°†æ ˆåœ°å€è®°å½•ä¸‹æ¥ï¼Œæœ€åå†ç»Ÿä¸€ç¬¦å·åŒ–ï¼Œå°†å¯¹ä¸»çº¿ç¨‹çš„å½±å“é™åˆ°æœ€ä½ï¼Œè¿™æ ·è·å–çš„æ•°æ®ä¹Ÿä¼šæ›´åŠ å‡†ç¡®ã€‚</p><p>æˆ‘ä»¬å¯ä»¥æŠŠè®°å½•æ ˆåœ°å€çš„ç»“æ„ä½“è®¾è®¡ä¸ºé€šç”¨å›æº¯ç»“æ„ï¼Œä»£ç å¦‚ä¸‹ï¼š</p><pre><code>typedef struct SMStackFrame {\n    const struct SMStackFrame *const previous;\n    const uintptr_t return_address;\n} SMStackFrame;\n</code></pre><p>åœ¨è¿™æ®µä»£ç ä¸­ï¼Œ previous è®°å½•çš„æ˜¯ä¸Šä¸€ä¸ªæ ˆæŒ‡é’ˆçš„åœ°å€ã€‚è€ƒè™‘ CPU æ€§èƒ½ï¼Œè®°å½•å †æ ˆçš„æ•°é‡ä¹Ÿä¸å¿…å¾ˆå¤šï¼Œå–æœ€è¿‘å‡ æ¡å³å¯ã€‚é€šè¿‡æ ˆåŸºåœ°å€æŒ‡é’ˆè·å–å½“å‰æ ˆæŒ‡é’ˆåœ°å€çš„å…³é”®ä»£ç å¦‚ä¸‹ï¼š</p><pre><code>// æ ˆåœ°å€åˆå§‹åŒ–\nSMStackFrame stackFrame = {0};\n// æ ˆåŸºåœ°å€æŒ‡é’ˆ\nconst uintptr_t framePointer = smMachStackBasePointerByCPU(&amp;machineContext);\nif (framePointer == 0 || smMemCopySafely((void *)framePointer, &amp;stackFrame, sizeof(stackFrame)) != KERN_SUCCESS) {\n    return @&quot;Fail frame pointer&quot;;\n}\n// ä¸‹é¢çš„8è¡¨ç¤ºå †æ ˆæ•°é‡\nfor (; i &lt; 8; i++) {\n\t// è®°å½•æ ˆåœ°å€\n    buffer[i] = stackFrame.return_address;\n    if (buffer[i] == 0 || stackFrame.previous == 0 || smMemCopySafely(stackFrame.previous, &amp;stackFrame, sizeof(stackFrame)) != KERN_SUCCESS) {\n        break;\n    }\n}\n</code></pre><h3>å…³äºæ±‡ç¼–ä»£ç çš„å­¦ä¹ </h3><p>é™¤äº†è¯¾åä½œä¸šï¼Œåœ¨è¿™ç¯‡æ–‡ç« çš„è¯„è®ºåŒºä¸­é—®åˆ°çš„æœ€å¤šçš„é—®é¢˜å°±æ˜¯objc_msgSend æ±‡ç¼–çš„éƒ¨åˆ†ã€‚@è¥¿äº¬å¯Œè´µå…”åœ¨è¯„è®ºåŒºç•™è¨€è¯´åˆ°ï¼š</p><blockquote>\n<p>çœ‹å®Œè¿™ç¯‡æ–‡ç« æˆ‘è†¨èƒ€äº†ï¼Œéƒ½æ•¢å»ç¿»çœ‹ objc_msgSendçš„æºç æ–‡ä»¶äº†ã€‚å—¯ï¼Œä¸å‡ºæ„æ–™ï¼Œä¸€å¥æ²¡çœ‹æ‡‚ã€‚</p>\n</blockquote><p>æˆ‘æƒ³è¦è¯´çš„æ˜¯ï¼Œæ±‡ç¼–å¹¶ä¸æ˜¯å¿…å­¦æŠ€èƒ½ï¼Œæˆ‘ä»¬åœ¨æ—¥å¸¸çš„ä¸šåŠ¡å¼€å‘å·¥ä½œä¸­ä¹Ÿå¾ˆå°‘ä¼šç”¨åˆ°ã€‚è€Œä¸”ï¼Œç°åœ¨ç¼–è¯‘å™¨å¯¹é«˜çº§è¯­è¨€çš„ä¼˜åŒ–å·²ç»åšå¾—éå¸¸å¥½äº†ï¼Œæ‰‹å†™å‡ºæ¥çš„æ±‡ç¼–ä»£ç æ€§èƒ½ä¸ä¸€å®šå°±ä¼šæ›´å¥½ã€‚å¦‚æœä½ çš„å·¥ä½œä¸æ¶‰åŠåˆ°é€†å‘å’Œå®‰å…¨é¢†åŸŸçš„è¯ï¼Œèƒ½å¤Ÿçœ‹æ‡‚æ±‡ç¼–ä»£ç å°±éå¸¸ä¸é”™äº†ã€‚</p><p>ä½†æ˜¯ï¼Œå¯¹äºé€†å‘å’Œå®‰å…¨é¢†åŸŸæ¥è¯´ï¼ŒæŒæ¡æ±‡ç¼–æŠ€èƒ½è¿˜æ˜¯å¾ˆæœ‰å¿…è¦çš„ã€‚<strong>å¦‚æœä½ æƒ³å­¦æ±‡ç¼–è¯­è¨€çš„è¯ï¼ŒåŒæ ·ä¹Ÿéœ€è¦åŠ¨æ‰‹å»ç¼–å†™å’Œè°ƒè¯•ä»£ç ï¼Œä½¿ç”¨ Xcodeå·¥å…·ä¹Ÿæ²¡æœ‰é—®é¢˜ã€‚åœ¨å¼€å§‹å­¦ä¹ æ—¶ï¼Œä½ å¯ä»¥æŒ‰ç…§æ•™ç¨‹è¾¹å­¦è¾¹å†™ï¼Œå…¶å®å°±å’Œå­¦ä¹ å…¶ä»–ç¼–ç¨‹è¯­è¨€çš„è¿‡ç¨‹ä¸€æ ·ã€‚</strong></p><p>è€Œå…·ä½“åˆ° objc_msgSend æºç çš„å‰–æï¼Œä½ å¯ä»¥å‚è€ƒ Mike Ash çš„ â€œ<a href=\"https://www.mikeash.com/pyblog/friday-qa-2017-06-30-dissecting-objc_msgsend-on-arm64.html\">Dissecting objc_msgSend on ARM64</a>â€è¿™ç¯‡åšå®¢ï¼Œè¯¦ç»†è®²è¿°äº†objc_msgSend çš„ ARM64 æ±‡ç¼–ä»£ç ã€‚ç­‰ä½ çœ‹å®Œè¿™ç¯‡åšå®¢ä»¥åï¼Œå†æ¥çœ‹æˆ‘ä»¬è¿™ç¯‡æ–‡ç« ä¸­çš„æ±‡ç¼–ä»£ç å°±ä¸€å®šä¼šè§‰å¾—è½»æ¾å¾ˆå¤šã€‚</p><h2>å…³äºClangçš„ç›¸å…³é—®é¢˜</h2><p>ä¸“æ å·²ç»æ›´æ–°çš„ç¬¬7~ç¬¬10è¿™4ç¯‡æ–‡ç« ä¸­ï¼Œéƒ½æ¶‰åŠåˆ°äº†Clangçš„çŸ¥è¯†ä»¥åŠåº”ç”¨ï¼Œæ‰€ä»¥æˆ‘åœ¨è¿™é‡Œå•ç‹¬åˆ—å‡ºäº†ä¸€ä¸ªé—®é¢˜ï¼Œå’Œä½ ä¸€èµ·è§£å†³å…³äºClangçš„ç›¸å…³é—®é¢˜ã€‚</p><p>å…¶å®ï¼Œæˆ‘åœ¨ç¬¬7ç¯‡æ–‡ç« â€œ<a href=\"https://time.geekbang.org/column/article/87477\">Clangã€Infer å’Œ OCLint ï¼Œæˆ‘ä»¬åº”è¯¥ä½¿ç”¨è°æ¥åšé™æ€åˆ†æï¼Ÿ</a>â€ä¸­ï¼Œä»‹ç»çš„3æ¬¾é™æ€åˆ†æå·¥å…·éƒ½ç”¨åˆ°äº†Clangï¼Œè€Œä¸”Clang æœ¬èº«ä¹Ÿæä¾›äº† LibTooling è¿™ç§å¼ºå¤§çš„ C++ æ¥å£æ¥æ–¹ä¾¿å®šåˆ¶ç‹¬ç«‹çš„å·¥å…·ã€‚</p><p>å½“ç„¶äº†ï¼ŒClang çš„çŸ¥è¯†ä¹Ÿæ˜¯éœ€è¦æŠ•å…¥å¤§é‡ç²¾åŠ›æ‰èƒ½æŒæ¡å¥½ã€‚é‚£ä¹ˆï¼Œä½ å¯èƒ½ä¼šé—®ï¼Œæˆ‘æŒæ¡è¿™äº›ååº•å±‚çš„çŸ¥è¯†æœ‰ä»€ä¹ˆç”¨å‘¢ï¼Œå¥½åƒä¹Ÿè§£å†³ä¸äº†æˆ‘åœ¨ç°å®å¼€å‘å·¥ä½œä¸­é‡åˆ°çš„é—®é¢˜å•Šï¼Ÿ</p><p><strong>åœ¨æˆ‘çœ‹æ¥ï¼Œä½ åªæœ‰æŒæ¡äº†æŸä¸ªæ–¹é¢çš„çŸ¥è¯†ï¼Œåœ¨å·¥ä½œä¸­ç¢°åˆ°é—®é¢˜æ—¶æ‰èƒ½å¤Ÿæƒ³åˆ°ç”¨è¿™ä¸ªçŸ¥è¯†å»è§£å†³é—®é¢˜ã€‚å¦‚æœä½ éƒ½ä¸çŸ¥é“æœ‰è¿™ä¹ˆä¸€ç§æ–¹æ³•ï¼Œåˆæ€ä¹ˆä¼šç”¨å®ƒå»è§£å†³è‡ªå·±çš„é—®é¢˜å‘¢ï¼Ÿ</strong></p><p>å°±æ¯”å¦‚è¯´ï¼Œä½ æŒæ¡äº†Clangçš„çŸ¥è¯†ï¼Œé‚£åœ¨ç ”ç©¶<a href=\"https://time.geekbang.org/column/article/87925\">æ— ä¾µå…¥çš„åŸ‹ç‚¹æ–¹æ¡ˆ</a>åº”è¯¥å¦‚ä½•å®ç°æ—¶ï¼Œä½ æ‰èƒ½å¯èƒ½ä¼šæƒ³åˆ°ç”¨Clangçš„LibTooling æ¥å¼€å‘ä¸€ä¸ªç‹¬ç«‹çš„å·¥å…·ï¼Œä¸“é—¨ä»¥é™æ€æ–¹å¼æ’å…¥åŸ‹ç‚¹çš„ä»£ç ï¼›åªæœ‰æŒæ¡äº†Clangçš„çŸ¥è¯†ï¼Œå½“ä½ åœ¨é¢å¯¹ä»£ç é‡è¾¾åˆ°ç™¾ä¸‡è¡Œçš„<a href=\"https://time.geekbang.org/column/article/88573\">AppåŒ…ç˜¦èº«éœ€æ±‚</a>æ—¶ï¼Œæ‰ä¼šæƒ³åˆ°é€šè¿‡ Clang é™æ€åˆ†ææ¥å¼€å‘å·¥å…·ï¼Œå»æ£€æŸ¥æ— ç”¨çš„æ–¹æ³•å’Œç±»ã€‚</p><p>å½“ä½ æŒæ¡äº† Clang çš„ç›¸å…³çŸ¥è¯†åï¼Œç¼–è¯‘å‰ç«¯çš„æŠ€æœ¯ä¹Ÿå°±æŒæ¡å¾—å·®ä¸å¤šäº†ï¼›åœ¨ç†è§£äº†ç¼–è¯‘å‰ç«¯çš„è¯æ³•åˆ†æå’Œè¯­æ³•åˆ†æçš„å¥—è·¯åï¼Œè„±ç¦» Clang çš„æ¥å£å®Œæˆç¬¬8ç¯‡æ–‡ç« â€œ<a href=\"https://time.geekbang.org/column/article/87844\">å¦‚ä½•åˆ©ç”¨ Clang ä¸º App æè´¨ï¼Ÿ</a>â€çš„è¯¾åä½œä¸šï¼Œä¹Ÿå°±æ²¡ä»€ä¹ˆéš¾åº¦äº†ã€‚</p><p>åœ¨å®Œæˆè¿™ä¸ªè¯¾åä½œä¸šä¹‹å‰ï¼Œä½ ä¹Ÿå¯ä»¥å…ˆçœ‹çœ‹ç‹å åœ¨2012å¹´çš„ä¸€ç¯‡åšå®¢â€œ<a href=\"http://www.yinwang.org/blog-cn/2012/08/01/interpreter\">æ€æ ·å†™ä¸€ä¸ªè§£é‡Šå™¨</a>â€ã€‚çœ‹å®Œåè¿™ç¯‡åšå®¢åï¼Œä½ ä¸€å®šä¼šæœ‰æ’¸èµ·è¢–å­åŠ æ²¹å¹²çš„å†²åŠ²å„¿ã€‚</p><p>å…³äºç¬¬8ç¯‡æ–‡ç« çš„è¯¾åä½œä¸šï¼Œå¦‚æœä½ è¿˜æœ‰å…¶ä»–ä¸æ˜ç™½çš„åœ°æ–¹ï¼Œæ¬¢è¿ç»§ç»­ç»™æˆ‘ç•™è¨€ã€‚</p><h2>å°ç»“</h2><p>ä¸“æ æ›´æ–°è‡³ä»Šï¼Œå·²ç»å‘å¸ƒäº†10ç¯‡æ–‡ç« ï¼Œå¤§å®¶åœ¨è¯„è®ºåŒºç•™ä¸‹å¾ˆå¤šé«˜è´¨é‡çš„ç•™è¨€ï¼Œè®©æˆ‘éå¸¸æ„ŸåŠ¨ï¼Œåœ¨è¿™é‡Œæˆ‘ä¹Ÿè¦æ„Ÿè°¢ä½ çš„æ”¯æŒä¸é¼“åŠ±ã€‚</p><p>è¿™10ç¯‡æ–‡ç« å­¦ä¹ ä¸‹æ¥ï¼Œä½ å¯èƒ½ä¼šè§‰å¾—è¿™äº›æ–‡ç« so easyï¼Œä¹Ÿå¯èƒ½ä¼šè§‰å¾—è¿™äº›æ–‡ç« ç¡®å®å¸®ä½ è§£å†³äº†å·¥ä½œä¸­é‡åˆ°çš„å›°æƒ‘ï¼Œè¿˜å¯èƒ½ä¼šè§‰å¾—è¿™äº›æ–‡ç« å¤ªéš¾å•ƒäº†ä½†ä¾æ—§åœ¨åŠªåŠ›å­¦ä¹ ä¸­ï¼Œæˆ‘æƒ³è¦å’Œä½ è¯´çš„å°±æ˜¯ï¼šæœ‰çš„çŸ¥è¯†å­¦èµ·æ¥å¾ˆéš¾ï¼Œä½†æ˜¯å†åšæŒä¸€ä¸‹ï¼Œå¹¶ä¸æ–­é‡å¤ï¼Œåªè¦èƒ½æ¯”æ˜¨å¤©çš„è‡ªå·±è¿›æ­¥ä¸€ç‚¹ç‚¹ï¼Œç»ˆç©¶å¯ä»¥æŒæ¡ä½ æƒ³è¦çš„çŸ¥è¯†ã€‚</p><p>æ‰€ä»¥ï¼Œåœ¨ä»Šå¤©è¿™ç¯‡ç­”ç–‘æ–‡ç« ï¼Œä¹Ÿæ˜¯æˆ‘ä»¬ä¸“æ çš„ç¬¬ä¸€ç¯‡ç­”ç–‘æ–‡ç« ä¸­ï¼Œæˆ‘ä¸æ‰“ç®—å¤§è€Œå…¨åœ°å»å›å¤å¤ªå¤šçš„é—®é¢˜ï¼Œåªæ˜¯ç”„é€‰äº†å…¶ä¸­å…¶ä¸­éå¸¸é‡è¦ã€æ ¸å¿ƒçš„å‡ ä¸ªé—®é¢˜ï¼Œå’Œä½ å†ä¸€èµ·å·©å›ºä¸‹æˆ‘ä»¬æ‰€å­¦çš„çŸ¥è¯†ï¼Œå¹¶å’Œä½ åˆ†äº«ä¸€äº›æˆ‘çš„å­¦ä¹ æ–¹æ³•ã€‚</p><p>å¸Œæœ›é€šè¿‡ä»Šå¤©è¿™ç¯‡æ–‡ç« ï¼Œå¯ä»¥å¸®ä½ ææ˜ç™½é‚£äº›è®©ä½ å›°æƒ‘çš„çŸ¥è¯†ç‚¹ï¼Œé€æ­¥åœ°å»ºç«‹èµ·è‡ªå·±çš„çŸ¥è¯†ä½“ç³»ã€‚å¦‚æœä½ è¿˜æœ‰å…¶ä»–çš„é—®é¢˜ï¼Œæ¬¢è¿ä½ ç»™æˆ‘ç•™è¨€ã€‚</p><p>æœ€åï¼Œè™½ç„¶è¿™æ˜¯ç¯‡ç­”ç–‘æ–‡ç« ï¼Œè¿˜æ˜¯è¦ç•™ç»™ä½ ä¸€ä¸ªå°å°çš„æ€è€ƒé¢˜ã€‚</p><p>ç‹å çš„åšå®¢æ–‡ç« ä¸­ï¼Œé™¤äº†æˆ‘åœ¨å‰é¢æåˆ°çš„â€œæ€æ ·å†™ä¸€ä¸ªè§£é‡Šå™¨â€å¤–ï¼Œå…¶ä»–æ–‡ç« ä¹Ÿéƒ½å¯ä»¥å¸®åŠ©ä½ å¼€é˜”çœ¼ç•Œï¼Œéå¸¸å€¼å¾—ä¸€çœ‹ã€‚åœ¨çœ‹å®Œä»–çš„åšå®¢åï¼Œä½ ä¼šå‘ç°ä»–å¯¹ç¼–ç¨‹è¯­è¨€æœ¬è´¨çš„ç†è§£éå¸¸é€å½»ï¼Œè€Œä½ è‡ªå·±ä¹Ÿèƒ½ä»ä¸­å—ç›Šè‰¯å¤šã€‚</p><p>æˆ‘åœ¨çœ‹å®Œä»–æ‰€æœ‰çš„åšå®¢æ–‡ç« ä¹‹åï¼Œå¯¹å¾ˆå¤šçŸ¥è¯†æœ‰äº†æ›´æ·±çš„ç†è§£ï¼Œä½†åŒæ—¶çŸ¥è¯†é‡ä¹Ÿéå¸¸å¤§ï¼Œæ— æ³•ä¸€æ—¶éƒ½æ¶ˆåŒ–æ‰ï¼Œæ„Ÿè§‰éœ€è¦å­¦ä¹ çš„åœ°æ–¹è¿˜æœ‰å¾ˆå¤šã€‚æ‰€ä»¥ï¼Œæˆ‘å½“æ—¶çš„æ„Ÿè§‰å°±æ˜¯é…¸ç”œè‹¦è¾£å’¸äº”å‘³ä¿±å…¨ã€‚ä¸çŸ¥é“ä½ çœ‹å®Œä»–çš„æ–‡ç« åï¼Œä¼šæœ‰ä»€ä¹ˆæ„Ÿè§‰å‘¢ï¼Ÿæˆ‘ä»¬å°±æŠŠè¿™ä¸ªè¯é¢˜ä½œä¸ºä»Šå¤©æ–‡ç« çš„æ€è€ƒé¢˜ï¼Œè¯·ä½ åœ¨è¯„è®ºåŒºåˆ†äº«ä¸€ä¸‹ä½ çš„é˜…åæ„Ÿå§ã€‚</p><p>æ„Ÿè°¢ä½ çš„æ”¶å¬ï¼Œæ¬¢è¿ä½ åœ¨è¯„è®ºåŒºç»™æˆ‘ç•™è¨€åˆ†äº«ä½ çš„è§‚ç‚¹ï¼Œä¹Ÿæ¬¢è¿æŠŠå®ƒåˆ†äº«ç»™æ›´å¤šçš„æœ‹å‹ä¸€èµ·é˜…è¯»ã€‚</p><p></p>","comments":[{"had_liked":false,"id":82894,"user_name":"Mad Mark","can_delete":false,"product_type":"c1","uid":1440938,"ip_address":"","ucode":"0E1F8C91237989","user_header":"https://static001.geekbang.org/account/avatar/00/15/fc/aa/290bc8db.jpg","comment_is_top":false,"comment_ctime":1554344926,"is_pvip":false,"replies":[{"id":"29995","content":"èµ","user_name":"ä½œè€…å›å¤","user_name_real":"æˆ´é“­","uid":"1140280","ctime":1554397380,"ip_address":"","comment_id":82894,"utype":1}],"discussion_count":3,"race_medal":0,"score":"48798985182","product_id":100024501,"comment_content":"å…³äºMike Ashçš„é‚£ç¯‡objc_msgSendæ–‡ç« ï¼Œæˆ‘å†™è¿‡ä¸€ç¯‡è¯‘æ–‡ http:&#47;&#47;madmark.cc&#47;2017&#47;08&#47;01&#47;ARM64_objc-msgSend&#47;","like_count":11,"discussions":[{"author":{"id":1140280,"avatar":"https://static001.geekbang.org/account/avatar/00/11/66/38/f9999b2b.jpg","nickname":"æˆ´é“­","note":"","ucode":"D61E685F962387","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":445769,"discussion_content":"èµ","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1554397380,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1932704,"avatar":"https://static001.geekbang.org/account/avatar/00/1d/7d/a0/323dea01.jpg","nickname":"Donkeyman","note":"","ucode":"A24ED814252FC5","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":387383,"discussion_content":"å·²ç»æ‰“ä¸å¼€äº†","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1628146307,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":1,"child_discussions":[{"author":{"id":1440938,"avatar":"https://static001.geekbang.org/account/avatar/00/15/fc/aa/290bc8db.jpg","nickname":"Mad Mark","note":"","ucode":"0E1F8C91237989","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":1932704,"avatar":"https://static001.geekbang.org/account/avatar/00/1d/7d/a0/323dea01.jpg","nickname":"Donkeyman","note":"","ucode":"A24ED814252FC5","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":414769,"discussion_content":"https://clot.github.io/å‰–æARM64ä¸‹çš„objc_msgSend åŸŸåæ¢äº†","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1636892153,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":387383,"ip_address":""},"score":414769,"extra":""}]}]},{"had_liked":false,"id":82794,"user_name":"ç»å½±","can_delete":false,"product_type":"c1","uid":1341899,"ip_address":"","ucode":"B96CD7B6516293","user_header":"https://static001.geekbang.org/account/avatar/00/14/79/cb/3fb26f09.jpg","comment_is_top":false,"comment_ctime":1554308990,"is_pvip":false,"replies":[{"id":"29993","content":"åœ¨åé¢å­¦ä¹ èµ„æ–™æ¨èç¯‡é‡Œæˆ‘ä¼šç»Ÿä¸€æ•´ç†å¥½æ¨èç»™å¤§å®¶å“ˆ","user_name":"ä½œè€…å›å¤","user_name_real":"æˆ´é“­","uid":"1140280","ctime":1554397323,"ip_address":"","comment_id":82794,"utype":1}],"discussion_count":1,"race_medal":0,"score":"35914047358","product_id":100024501,"comment_content":"å¯ä»¥åˆ†äº«å¤šä¸€äº›æ‚¨å…³æ³¨çš„åšå®¢æˆ–åšä¸»å—ï¼Ÿ","like_count":8,"discussions":[{"author":{"id":1140280,"avatar":"https://static001.geekbang.org/account/avatar/00/11/66/38/f9999b2b.jpg","nickname":"æˆ´é“­","note":"","ucode":"D61E685F962387","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":445724,"discussion_content":"åœ¨åé¢å­¦ä¹ èµ„æ–™æ¨èç¯‡é‡Œæˆ‘ä¼šç»Ÿä¸€æ•´ç†å¥½æ¨èç»™å¤§å®¶å“ˆ","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1554397323,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":83446,"user_name":"æ—¶é—´éƒ½å»å“ªäº†","can_delete":false,"product_type":"c1","uid":1002729,"ip_address":"","ucode":"F1A52A55218C0B","user_header":"https://static001.geekbang.org/account/avatar/00/0f/4c/e9/6c5191ea.jpg","comment_is_top":false,"comment_ctime":1554603851,"is_pvip":false,"replies":[{"id":"30162","content":"æ–°é¡¹ç›®ç”¨ Swiftã€‚ä¸ç”¨çŠ¹è±«","user_name":"ä½œè€…å›å¤","user_name_real":"æˆ´é“­","uid":"1140280","ctime":1554617291,"ip_address":"","comment_id":83446,"utype":1}],"discussion_count":1,"race_medal":0,"score":"14439505739","product_id":100024501,"comment_content":"è¯·é—®ä¸€ä¸ªæ–°é¡¹ç›®åœ¨è¿™ä¸ªæ—¶é—´ç‚¹ç”¨OCè¿˜æ˜¯swiftå‘¢?èƒ½è¯´è¯´ä¸¤è€…åº”è¯¥å¦‚ä½•é€‰æ‹©å‘¢?","like_count":3,"discussions":[{"author":{"id":1140280,"avatar":"https://static001.geekbang.org/account/avatar/00/11/66/38/f9999b2b.jpg","nickname":"æˆ´é“­","note":"","ucode":"D61E685F962387","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":446027,"discussion_content":"æ–°é¡¹ç›®ç”¨ Swiftã€‚ä¸ç”¨çŠ¹è±«","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1554617291,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":87818,"user_name":"è´°å","can_delete":false,"product_type":"c1","uid":1504587,"ip_address":"","ucode":"447E7E048CEFAD","user_header":"https://static001.geekbang.org/account/avatar/00/16/f5/4b/67495ca4.jpg","comment_is_top":false,"comment_ctime":1555723606,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"10145658198","product_id":100024501,"comment_content":"å ç¥æ˜¯coderçš„ä¸‰å¤§æµªæ¼«ä¹‹ä¸€ç¼–è¯‘åŸç†ä¸–ç•Œé¡¶çº§çš„å¤§ç¥","like_count":2},{"had_liked":false,"id":84640,"user_name":"melody","can_delete":false,"product_type":"c1","uid":1468451,"ip_address":"","ucode":"E9A7B8BCB9DB5F","user_header":"http://thirdwx.qlogo.cn/mmopen/vi_32/DYAIOgq83er5UDwD5Gcpic1nQBZ1c2toZBtZsicVcaKItoiaHymUIopxcGkkVMcFEQP7DMDWibNZpzvfEWN8egKN9g/132","comment_is_top":false,"comment_ctime":1554888723,"is_pvip":false,"replies":[{"id":"30722","content":" å®˜æ–¹æ–‡æ¡£ç›´æ¥å°±åœ¨å®˜ç½‘æœç´¢ã€‚å‘ç°å¥½çš„åšå®¢æ–‡ç« ä¼šè®¢é˜…åšä¸»çš„åšå®¢äº†ï¼Œé€šè¿‡ RSS é˜…è¯»å™¨çœ‹ã€‚","user_name":"ä½œè€…å›å¤","user_name_real":"æˆ´é“­","uid":"1140280","ctime":1555140114,"ip_address":"","comment_id":84640,"utype":1}],"discussion_count":1,"race_medal":0,"score":"10144823315","product_id":100024501,"comment_content":"æƒ³é—®ä¸‹æ‚¨å¹³æ—¶éƒ½åˆ©ç”¨ä»€ä¹ˆé€”å¾„å»è·å–ä¸€äº›ä¼˜è´¨è‹¹æœçš„å®˜æ–¹æ–‡æ¡£å’Œåšå®¢å†…å®¹å‘¢ï¼Ÿ","like_count":2,"discussions":[{"author":{"id":1140280,"avatar":"https://static001.geekbang.org/account/avatar/00/11/66/38/f9999b2b.jpg","nickname":"æˆ´é“­","note":"","ucode":"D61E685F962387","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":446411,"discussion_content":" å®˜æ–¹æ–‡æ¡£ç›´æ¥å°±åœ¨å®˜ç½‘æœç´¢ã€‚å‘ç°å¥½çš„åšå®¢æ–‡ç« ä¼šè®¢é˜…åšä¸»çš„åšå®¢äº†ï¼Œé€šè¿‡ RSS é˜…è¯»å™¨çœ‹ã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1555140114,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":82890,"user_name":"addSubviewå·¥ç¨‹å¸ˆ","can_delete":false,"product_type":"c1","uid":1460344,"ip_address":"","ucode":"C6BA3241A410A3","user_header":"https://static001.geekbang.org/account/avatar/00/16/48/78/cead201c.jpg","comment_is_top":false,"comment_ctime":1554344234,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"10144278826","product_id":100024501,"comment_content":"èƒ½ä»‹ç»ä¸‹iOSè®¾è®¡æ¶æ„å˜›MVVMå•¥çš„æœ€è¿‘é¢è¯•è¢«é—®çš„å¤šäº†","like_count":2},{"had_liked":false,"id":86575,"user_name":"æ²§æµ·è¡ŒèˆŸ","can_delete":false,"product_type":"c1","uid":1453759,"ip_address":"","ucode":"CB2C6986BC99F5","user_header":"https://static001.geekbang.org/account/avatar/00/16/2e/bf/26485326.jpg","comment_is_top":false,"comment_ctime":1555402024,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"5850369320","product_id":100024501,"comment_content":"çœ‹å®Œç¬¬äºŒç¯‡å°±åœ¨åŠ¨æ‰‹å†™hook objc_msg_sendçš„ä»£ç ï¼Œè¿™æ˜¯å­¦ä¹ æ±‡ç¼–ä¸­è®°å½•çš„ä¸€äº›arm64æ±‡ç¼–çŸ¥è¯†https:&#47;&#47;github.com&#47;wzpziyi1&#47;Arm64-<br>æœ‰éœ€è¦çš„ç«¥é‹å¯ä»¥çœ‹çœ‹ã€‚<br>åœ¨å­¦ä¹ è¿‡ç¨‹ä¸­ï¼Œå‘ç°ä¸€ä¸ªé—®é¢˜ï¼ˆæˆ–è€…è¯´æˆ‘ä»¥ä¸ºçš„bugï¼‰ã€‚<br>åœ¨æˆ´è€å¸ˆçš„ä»£ç ä¸­ï¼Œhook objc_msgSendä¹‹å‰ä¿å­˜ä¸ªå¯„å­˜å™¨çš„çŠ¶æ€æ—¶ï¼Œå¹¶æœªä¿å­˜å‘é‡å¯„å­˜å™¨çš„çŠ¶æ€ï¼š<br>&quot;stp q6, q7, [sp, #-32]!\\n&quot; \\<br>&quot;stp q4, q5, [sp, #-32]!\\n&quot; \\<br>&quot;stp q2, q3, [sp, #-32]!\\n&quot; \\<br>&quot;stp q0, q1, [sp, #-32]!\\n&quot; \\<br>&quot;stp x8, x9, [sp, #-16]!\\n&quot; \\<br>&quot;stp x6, x7, [sp, #-16]!\\n&quot; \\<br>&quot;stp x4, x5, [sp, #-16]!\\n&quot; \\<br>&quot;stp x2, x3, [sp, #-16]!\\n&quot; \\<br>&quot;stp x0, x1, [sp, #-16]!\\n&quot; \\<br><br>åªæ˜¯ä¿å­˜äº†é€šç”¨å¯„å­˜å™¨x0--x9å¯„å­˜å™¨çš„å€¼ï¼Œåœ¨è°ƒè¯•ä»£ç æ—¶ï¼Œå‘ç°è¿™æ ·çš„cä»£ç ï¼š<br>struct TestOne {<br>    double a;<br>    double b;<br>    double number;<br>    double type;<br>}TestOne;<br><br>void test(struct TestOne x) {<br>    x.a = 10;<br>    x.b = 20;<br>    x.number = 2;<br>    x.type = 11;<br>}<br><br>void call() {<br>    struct TestOne x = {0,0,0,0};<br>    test(x);<br>}<br><br>è½¬æˆarm64æ±‡ç¼–æ—¶ï¼Œç»“æ„ä½“çš„å€¼æ˜¯ä¿å­˜åœ¨å‘é‡å¯„å­˜å™¨d0--d4ä¸­çš„ï¼š<br>_test:                                  ; @test<br>\tfmov\td4, #11.00000000<br>\tfmov\td5, #2.00000000<br>\tfmov\td6, #20.00000000<br>\tfmov\td7, #10.00000000<br>\tstr\td0, [sp]<br>\tstr\td1, [sp, #8]<br>\tstr\td2, [sp, #16]<br>\tstr\td3, [sp, #24]<br>\tstr\td7, [sp]<br>\tstr\td6, [sp, #8]<br>\tstr\td5, [sp, #16]<br>\tstr\td4, [sp, #24]<br>\tadd\tsp, sp, #32             ; =32<br>\tret<br><br><br>_call:                                  ; @call<br>\tsub\tsp, sp, #48             ; =48<br>\tstp\tx29, x30, [sp, #32]     ; 8-byte Folded Spill<br>\tadd\tx29, sp, #32            ; =32<br>\tmov\tx8, #0<br>\tstr\tx8, [sp, #24]<br>\tstr\tx8, [sp, #16]<br>\tstr\tx8, [sp, #8]<br>\tstr\tx8, [sp]<br>\tldr\td3, [sp, #24]<br>\tldr\td2, [sp, #16]<br>\tldr\td1, [sp, #8]<br>\tldr\td0, [sp]<br>\tbl\t_test<br>\tldp\tx29, x30, [sp, #32]     ; 8-byte Folded Reload<br>\tadd\tsp, sp, #48             ; =48<br>\tret<br><br>å¦‚æœåœ¨é¡¹ç›®ä¸­ï¼Œæœ‰å¼€å‘ç«¥é‹ç›´æ¥è¿™ä¹ˆå†™ï¼š<br>- (void)doSomething:(struct TestOne)test;<br>é‚£ä¹ˆhook objc_msgSendæ—¶æ²¡ä¿å­˜çš„å‘é‡å¯„å­˜å™¨çš„çŠ¶æ€ï¼Œä¼šå‡ºç°é—®é¢˜çš„å§ï¼Ÿ","like_count":1},{"had_liked":false,"id":84712,"user_name":"é™ˆé˜¿ç¥¨","can_delete":false,"product_type":"c1","uid":1239984,"ip_address":"","ucode":"4781AE97748533","user_header":"https://static001.geekbang.org/account/avatar/00/12/eb/b0/2af13c30.jpg","comment_is_top":false,"comment_ctime":1554897079,"is_pvip":false,"discussion_count":2,"race_medal":0,"score":"5849864375","product_id":100024501,"comment_content":"å°†ä»£ç ç¼–å†™æˆåŠ¨æ€åº“ï¼Œå¯ä¸å¯ä»¥å‡å°‘å¯åŠ¨æ—¶é—´ï¼Ÿ","like_count":1,"discussions":[{"author":{"id":1639608,"avatar":"http://thirdwx.qlogo.cn/mmopen/vi_32/DYAIOgq83eoIZjOicTEoUfU7SemmXXzwM65EWuNM8Xxzpg6xYQsuugxXGhziaxVVygSnu9h1FlPwR5bADO1Zxo1g/132","nickname":"å…«æˆ’","note":"","ucode":"1F4C69E516641E","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":305099,"discussion_content":"ä¼šå¢åŠ ","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1599785964,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1471806,"avatar":"https://static001.geekbang.org/account/avatar/00/16/75/3e/71b16443.jpg","nickname":"Struggle","note":"","ucode":"C769D8FFD9C1B6","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":271099,"discussion_content":"è¦æ˜¯æƒ³å‡å°‘å¯åŠ¨æ—¶é—´ï¼Œé™æ€åº“æ¯”åŠ¨æ€åº“è¦å¥½ã€‚ç„¶ååŠ¨æ€åº“æ•°é‡å°‘æ¯”åŠ¨æ€åº“æ•°é‡å¤šè¦å¥½ï¼Œå°±æ˜¯åŠ¨æ€åº“åˆå¹¶","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1590076246,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":82881,"user_name":"FR","can_delete":false,"product_type":"c1","uid":1389632,"ip_address":"","ucode":"6892FCB222B465","user_header":"https://static001.geekbang.org/account/avatar/00/15/34/40/a84b6612.jpg","comment_is_top":false,"comment_ctime":1554342982,"is_pvip":true,"discussion_count":0,"race_medal":0,"score":"5849310278","product_id":100024501,"comment_content":"å»ºè®®å¤šå‘ä¸€äº›ç›¸å…³çš„èµ„æ–™é“¾æ¥","like_count":1},{"had_liked":false,"id":82845,"user_name":"å…ƒå…ƒ","can_delete":false,"product_type":"c1","uid":1455337,"ip_address":"","ucode":"2BD85A37BBC2F2","user_header":"https://static001.geekbang.org/account/avatar/00/16/34/e9/238acb66.jpg","comment_is_top":false,"comment_ctime":1554339054,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"5849306350","product_id":100024501,"comment_content":"æ‰«äº†ä¸€çœ¼æˆ‘å¤§è„‘å‘Šè¯‰æˆ‘å±é™©æˆ‘å°±ç‚¹äº†back","like_count":1},{"had_liked":false,"id":82798,"user_name":"Geek_e1d503","can_delete":false,"product_type":"c1","uid":1459864,"ip_address":"","ucode":"5670711B17AB0B","user_header":"http://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTIOThWTmnhVX65gbpDVUJicQ1GO5YscfIiaLNicyNPz4eHDz1GwWlteJxRovgyjcfNwiaqFtic8Oibkat9g/132","comment_is_top":false,"comment_ctime":1554310998,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"5849278294","product_id":100024501,"comment_content":"è€å¸ˆæ‚¨å¥½ï¼Œæˆ‘æƒ³é—®ä¸‹å¹¶å‘é‡å¤§ã€æ—¥æ´»é‡å¤§çš„appè¯¥æ³¨æ„å“ªäº›å•Šï¼Œå®ƒçš„æ¶æ„å’Œæ€§èƒ½ä¸Šè¯¥æ³¨æ„å“ªäº›ï¼Ÿæœ‰æ²¡æœ‰ç›¸å…³èµ„æ–™å¯ä»¥æ¨èçœ‹ä¸‹çš„ï¼Ÿ","like_count":1},{"had_liked":false,"id":335951,"user_name":"Geek_e360c6","can_delete":false,"product_type":"c1","uid":2924796,"ip_address":"","ucode":"E151123B5979AC","user_header":"","comment_is_top":false,"comment_ctime":1645784930,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1645784930","product_id":100024501,"comment_content":"æ¯å¤©å¹²è´§æ»¡æ»¡","like_count":0},{"had_liked":false,"id":116579,"user_name":"IAMCJ","can_delete":false,"product_type":"c1","uid":1040766,"ip_address":"","ucode":"4C4F6ECDAC563E","user_header":"https://static001.geekbang.org/account/avatar/00/0f/e1/7e/b4b259c7.jpg","comment_is_top":false,"comment_ctime":1563874708,"is_pvip":false,"replies":[{"id":"42876","content":"åšæ ‡è®°","user_name":"ä½œè€…å›å¤","user_name_real":"æˆ´é“­","uid":"1140280","ctime":1563984707,"ip_address":"","comment_id":116579,"utype":1}],"discussion_count":2,"race_medal":0,"score":"1563874708","product_id":100024501,"comment_content":"â€œä¸€ç§æ˜¯ï¼Œåœ¨ç¨‹åºå¼€å§‹è¿è¡Œæ—¶é€šè¿‡ dyld åŠ¨æ€åŠ è½½ã€‚é€šè¿‡ dyld åŠ è½½çš„åŠ¨æ€åº“éœ€è¦åœ¨ç¼–è¯‘æ—¶è¿›è¡Œé“¾æ¥ï¼Œé“¾æ¥æ—¶ä¼šåšæ ‡è®°ï¼Œç»‘å®šçš„åœ°å€åœ¨åŠ è½½åå†å†³å®šâ€<br><br>æ‰€ä»¥å¤§éƒ¨åˆ†åŠ¨æ€åº“æ˜¯ä¼šåœ¨ç¼–è¯‘çš„æ—¶å€™é“¾æ¥æ˜¯å—ï¼Ÿè¿™ä¸ªæ—¶å€™çš„â€œé“¾æ¥â€æ˜¯å¹¶æ²¡æœ‰ç»‘å®šåœ°å€å—ï¼Ÿé‚£è¿™ä¸ªâ€œé“¾æ¥â€ä¸»è¦åšäº†ä»€ä¹ˆå†…å®¹å‘¢ï¼Ÿ","like_count":0,"discussions":[{"author":{"id":1140280,"avatar":"https://static001.geekbang.org/account/avatar/00/11/66/38/f9999b2b.jpg","nickname":"æˆ´é“­","note":"","ucode":"D61E685F962387","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":459598,"discussion_content":"åšæ ‡è®°","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1563984707,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1040766,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/e1/7e/b4b259c7.jpg","nickname":"IAMCJ","note":"","ucode":"4C4F6ECDAC563E","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":2917,"discussion_content":"åœ¨ç¼–è¯‘é“¾æ¥çš„æ—¶å€™ï¼Œå¯æ‰§è¡Œæ–‡ä»¶å†…æ ‡è®°ä¸ŠåŠ¨æ€åº“çš„å¼•ç”¨ï¼Œåœ¨è¿è¡Œæ—¶åŠ è½½ç©åŠ¨æ€åº“ä¹‹åï¼Œå†å»å’Œå¯æ‰§è¡Œæ–‡ä»¶å†…çš„ç¬¦å·ç»‘å®šèµ·æ¥æ˜¯å§","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1564039307,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":98541,"user_name":"å®‰è¾¾","can_delete":false,"product_type":"c1","uid":1457358,"ip_address":"","ucode":"9410F696734DB5","user_header":"https://static001.geekbang.org/account/avatar/00/16/3c/ce/fb018173.jpg","comment_is_top":false,"comment_ctime":1559021609,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1559021609","product_id":100024501,"comment_content":"è€å¸ˆï¼Œæˆ‘æƒ³é—®ä¸‹ vm_read_overwrite è·å–åˆ°çš„æ˜¯ä¸æ˜¯å‡½æ•°è¿”å›çš„è™šæ‹Ÿåœ°å€ï¼Œæˆ‘åœ¨ç ”ç©¶æ‰“å°æ ˆå’Œç¬¦å·è§£æä»£ç ï¼Œå¾ˆå›°æƒ‘çš„æ˜¯å„ç§ Slide åç§»ï¼Œä¸€ä¼šå„¿åŠ ä¸€ä¼šå„¿å‡ï¼Œå¯¹äºæ•´ä¸ªæµç¨‹ï¼Œè·å–å‡½æ•°è¿”å›åœ°å€-&gt;æ‰¾åˆ° Image -&gt; æ‰¾åˆ° Segment -&gt; æ‰¾åˆ°ç¬¦å·è¡¨ -&gt; æ‰¾åˆ°ç¬¦å·ï¼Œè¿™å…¶ä¸­æ˜¯ä¸æ˜¯æ ¹æœ¬ä¸éœ€è¦çŸ¥é“å‡½æ•°åœ¨ç‰©ç†å†…å­˜çœŸå®çš„åœ°å€ï¼Œä»å¤´åˆ°å°¾å°±ç”¨çš„è™šæ‹Ÿåœ°å€ï¼Ÿ","like_count":0},{"had_liked":false,"id":84145,"user_name":"é›é¹äº®","can_delete":false,"product_type":"c1","uid":1179992,"ip_address":"","ucode":"A7E394043295B9","user_header":"https://static001.geekbang.org/account/avatar/00/12/01/58/98719136.jpg","comment_is_top":false,"comment_ctime":1554793594,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1554793594","product_id":100024501,"comment_content":"æˆ‘ç°åœ¨åœ¨åŸºäºclangå¼€å‘ï¼Œç›®æ ‡æ˜¯æ˜¯è®©ocæ”¯æŒAnnotationæ³¨è§£åŠŸèƒ½ï¼Œä½†æ˜¯å¼€æºçš„clangç‰ˆæœ¬è¦ä½äºXcodeä¸­é»˜è®¤çš„clangä¸¤ä¸ªç‰ˆæœ¬ï¼Œè€Œä¸”Xcode10è¿˜ä½¿ç”¨New Build Systemï¼Œæœ‰äº›ç¼–è¯‘å‚æ•°ä¹Ÿä¸å…¼å®¹ï¼Œè›‹ç–¼â€¦","like_count":0},{"had_liked":false,"id":83210,"user_name":"è´°é›¶å£¹ç–","can_delete":false,"product_type":"c1","uid":1457684,"ip_address":"","ucode":"6AD46BEE2F6E03","user_header":"https://static001.geekbang.org/account/avatar/00/16/3e/14/6883d313.jpg","comment_is_top":false,"comment_ctime":1554464464,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1554464464","product_id":100024501,"comment_content":"æå‡ºè¿™äº›é—®é¢˜çš„æœ‰ä¸ªæ¯”è¾ƒå¤§çš„åŸå› æ˜¯è®¡ç®—æœºç¼–ç¨‹çš„åŸºç¡€é—®é¢˜æ²¡æ‰“å¥½ï¼Œæˆ–è€…ä¸æ˜¯ç§‘ç­å‡ºèº«ä¸”æ²¡æœ‰ç³»ç»Ÿå­¦ä¹ è¿‡çš„ã€‚","like_count":0},{"had_liked":false,"id":83120,"user_name":"Xcode","can_delete":false,"product_type":"c1","uid":1486793,"ip_address":"","ucode":"A02514CE1B6408","user_header":"","comment_is_top":false,"comment_ctime":1554429973,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1554429973","product_id":100024501,"comment_content":"è°¢è°¢æˆ´è€å¸ˆå¥‰ä¸Šç²¾å½©çš„è¯¾ç¨‹ï¼Œå¤ªéœ€è¦è¿™ç§åŸåˆ›ï¼Œæ·±åº¦å¹¿åº¦å¹¶å­˜çš„å¹²è´§ï¼Œæ­£åœ¨å­¦ä¹ ä¸­","like_count":0},{"had_liked":false,"id":83061,"user_name":"ç†Š","can_delete":false,"product_type":"c1","uid":1406020,"ip_address":"","ucode":"C794160A03DD8B","user_header":"https://static001.geekbang.org/account/avatar/00/15/74/44/6d80dc8b.jpg","comment_is_top":false,"comment_ctime":1554388466,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1554388466","product_id":100024501,"comment_content":"å¯ä»¥åˆ†äº«å¤šä¸€äº›æ‚¨çš„å­¦ä¹ æ–¹æ³•ä¹ˆï¼Ÿä»¥åŠèƒ½å¦åˆ†äº«ä¸‹æ‚¨å…³æ³¨çš„ä¸€äº›å¤§ç¥çš„åšå®¢ï¼Œgithubå¤§ç¥ä¹ˆï¼Ÿéå¸¸æ„Ÿè°¢","like_count":0},{"had_liked":false,"id":82865,"user_name":"HeminWon","can_delete":false,"product_type":"c1","uid":1453537,"ip_address":"","ucode":"BBAA4983A16131","user_header":"http://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTJnx7B5U2PNYX8Ps0uAA3St9d1NGAaMJOrMbknWganEM0GxXHIdLCWvLXZRO1Tvs6YiaEnem2oN73g/132","comment_is_top":false,"comment_ctime":1554340856,"is_pvip":false,"replies":[{"id":"29994","content":"èµ","user_name":"ä½œè€…å›å¤","user_name_real":"æˆ´é“­","uid":"1140280","ctime":1554397341,"ip_address":"","comment_id":82865,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1554340856","product_id":100024501,"comment_content":"æˆ´é“­è€å¸ˆğŸ‘ŠğŸ¼åŒ—å›½ä¹‹æ‹æˆ‘æ­£å¥½å…¨éƒ¨çœ‹å®Œ","like_count":0,"discussions":[{"author":{"id":1140280,"avatar":"https://static001.geekbang.org/account/avatar/00/11/66/38/f9999b2b.jpg","nickname":"æˆ´é“­","note":"","ucode":"D61E685F962387","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":445753,"discussion_content":"èµ","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1554397341,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":82850,"user_name":"å¼ è’™","can_delete":false,"product_type":"c1","uid":1035858,"ip_address":"","ucode":"CF8727F5DCFD55","user_header":"https://static001.geekbang.org/account/avatar/00/0f/ce/52/4f1911b5.jpg","comment_is_top":false,"comment_ctime":1554339481,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1554339481","product_id":100024501,"comment_content":"å­¦ä¹ äº†ï¼Œè°¢è°¢","like_count":0}]}