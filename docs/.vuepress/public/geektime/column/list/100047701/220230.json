{"id":220230,"title":"12 | å¼‚å¸¸å¤„ç†ï¼šåˆ«è®©è‡ªå·±åœ¨å‡ºé—®é¢˜çš„æ—¶å€™å˜ä¸ºçå­","content":"<p>ä½ å¥½ï¼Œæˆ‘æ˜¯æœ±æ™”ã€‚ä»Šå¤©ï¼Œæˆ‘æ¥å’Œä½ èŠèŠå¼‚å¸¸å¤„ç†å®¹æ˜“è¸©çš„å‘ã€‚</p><p>åº”ç”¨ç¨‹åºé¿å…ä¸äº†å‡ºå¼‚å¸¸ï¼Œæ•è·å’Œå¤„ç†å¼‚å¸¸æ˜¯è€ƒéªŒç¼–ç¨‹åŠŸåŠ›çš„ä¸€ä¸ªç²¾ç»†æ´»ã€‚ä¸€äº›ä¸šåŠ¡é¡¹ç›®ä¸­ï¼Œæˆ‘æ›¾çœ‹åˆ°å¼€å‘åŒå­¦åœ¨å¼€å‘ä¸šåŠ¡é€»è¾‘æ—¶ä¸è€ƒè™‘ä»»ä½•å¼‚å¸¸å¤„ç†ï¼Œé¡¹ç›®æ¥è¿‘å®Œæˆæ—¶å†é‡‡ç”¨â€œæµæ°´çº¿â€çš„æ–¹å¼è¿›è¡Œå¼‚å¸¸å¤„ç†ï¼Œä¹Ÿå°±æ˜¯ç»Ÿä¸€ä¸ºæ‰€æœ‰æ–¹æ³•æ‰“ä¸Štryâ€¦catchâ€¦æ•è·æ‰€æœ‰å¼‚å¸¸è®°å½•æ—¥å¿—ï¼Œæœ‰äº›æŠ€å·§çš„åŒå­¦å¯èƒ½ä¼šä½¿ç”¨AOPæ¥è¿›è¡Œç±»ä¼¼çš„â€œç»Ÿä¸€å¼‚å¸¸å¤„ç†â€ã€‚</p><p>å…¶å®ï¼Œè¿™ç§å¤„ç†å¼‚å¸¸çš„æ–¹å¼éå¸¸ä¸å¯å–ã€‚é‚£ä¹ˆä»Šå¤©ï¼Œæˆ‘å°±å’Œä½ åˆ†äº«ä¸‹ä¸å¯å–çš„åŸå› ã€ä¸å¼‚å¸¸å¤„ç†ç›¸å…³çš„å‘å’Œæœ€ä½³å®è·µã€‚</p><h2>æ•è·å’Œå¤„ç†å¼‚å¸¸å®¹æ˜“çŠ¯çš„é”™</h2><p>â€œç»Ÿä¸€å¼‚å¸¸å¤„ç†â€æ–¹å¼æ­£æ˜¯æˆ‘è¦è¯´çš„ç¬¬ä¸€ä¸ªé”™ï¼š<strong>ä¸åœ¨ä¸šåŠ¡ä»£ç å±‚é¢è€ƒè™‘å¼‚å¸¸å¤„ç†ï¼Œä»…åœ¨æ¡†æ¶å±‚é¢ç²—çŠ·æ•è·å’Œå¤„ç†å¼‚å¸¸</strong>ã€‚</p><p>ä¸ºäº†ç†è§£é”™åœ¨ä½•å¤„ï¼Œæˆ‘ä»¬å…ˆæ¥çœ‹çœ‹å¤§å¤šæ•°ä¸šåŠ¡åº”ç”¨éƒ½é‡‡ç”¨çš„ä¸‰å±‚æ¶æ„ï¼š</p><ul>\n<li>Controllerå±‚è´Ÿè´£ä¿¡æ¯æ”¶é›†ã€å‚æ•°æ ¡éªŒã€è½¬æ¢æœåŠ¡å±‚å¤„ç†çš„æ•°æ®é€‚é…å‰ç«¯ï¼Œè½»ä¸šåŠ¡é€»è¾‘ï¼›</li>\n<li>Serviceå±‚è´Ÿè´£æ ¸å¿ƒä¸šåŠ¡é€»è¾‘ï¼ŒåŒ…æ‹¬å„ç§å¤–éƒ¨æœåŠ¡è°ƒç”¨ã€è®¿é—®æ•°æ®åº“ã€ç¼“å­˜å¤„ç†ã€æ¶ˆæ¯å¤„ç†ç­‰ï¼›</li>\n<li>Repositoryå±‚è´Ÿè´£æ•°æ®è®¿é—®å®ç°ï¼Œä¸€èˆ¬æ²¡æœ‰ä¸šåŠ¡é€»è¾‘ã€‚</li>\n</ul><p><img src=\"https://static001.geekbang.org/resource/image/2f/61/2f2cfbd86efd3bc140400bcaf2985361.png?wh=1304*1284\" alt=\"\"></p><p>æ¯å±‚æ¶æ„çš„å·¥ä½œæ€§è´¨ä¸åŒï¼Œä¸”ä»ä¸šåŠ¡æ€§è´¨ä¸Šå¼‚å¸¸å¯èƒ½åˆ†ä¸ºä¸šåŠ¡å¼‚å¸¸å’Œç³»ç»Ÿå¼‚å¸¸ä¸¤å¤§ç±»ï¼Œè¿™å°±å†³å®šäº†å¾ˆéš¾è¿›è¡Œç»Ÿä¸€çš„å¼‚å¸¸å¤„ç†ã€‚æˆ‘ä»¬ä»åº•å‘ä¸Šçœ‹ä¸€ä¸‹ä¸‰å±‚æ¶æ„ï¼š</p><!-- [[[read_end]]] --><ul>\n<li>Repositoryå±‚å‡ºç°å¼‚å¸¸æˆ–è®¸å¯ä»¥å¿½ç•¥ï¼Œæˆ–è®¸å¯ä»¥é™çº§ï¼Œæˆ–è®¸éœ€è¦è½¬åŒ–ä¸ºä¸€ä¸ªå‹å¥½çš„å¼‚å¸¸ã€‚å¦‚æœä¸€å¾‹æ•è·å¼‚å¸¸ä»…è®°å½•æ—¥å¿—ï¼Œå¾ˆå¯èƒ½ä¸šåŠ¡é€»è¾‘å·²ç»å‡ºé”™ï¼Œè€Œç”¨æˆ·å’Œç¨‹åºæœ¬èº«å®Œå…¨æ„ŸçŸ¥ä¸åˆ°ã€‚</li>\n<li>Serviceå±‚å¾€å¾€æ¶‰åŠæ•°æ®åº“äº‹åŠ¡ï¼Œå‡ºç°å¼‚å¸¸åŒæ ·ä¸é€‚åˆæ•è·ï¼Œå¦åˆ™äº‹åŠ¡æ— æ³•è‡ªåŠ¨å›æ»šã€‚æ­¤å¤–Serviceå±‚æ¶‰åŠä¸šåŠ¡é€»è¾‘ï¼Œæœ‰äº›ä¸šåŠ¡é€»è¾‘æ‰§è¡Œä¸­é‡åˆ°ä¸šåŠ¡å¼‚å¸¸ï¼Œå¯èƒ½éœ€è¦åœ¨å¼‚å¸¸åè½¬å…¥åˆ†æ”¯ä¸šåŠ¡æµç¨‹ã€‚å¦‚æœä¸šåŠ¡å¼‚å¸¸éƒ½è¢«æ¡†æ¶æ•è·äº†ï¼Œä¸šåŠ¡åŠŸèƒ½å°±ä¼šä¸æ­£å¸¸ã€‚</li>\n<li>å¦‚æœä¸‹å±‚å¼‚å¸¸ä¸Šå‡åˆ°Controllerå±‚è¿˜æ˜¯æ— æ³•å¤„ç†çš„è¯ï¼ŒControllerå±‚å¾€å¾€ä¼šç»™äºˆç”¨æˆ·å‹å¥½æç¤ºï¼Œæˆ–æ˜¯æ ¹æ®æ¯ä¸€ä¸ªAPIçš„å¼‚å¸¸è¡¨è¿”å›æŒ‡å®šçš„å¼‚å¸¸ç±»å‹ï¼ŒåŒæ ·æ— æ³•å¯¹æ‰€æœ‰å¼‚å¸¸ä¸€è§†åŒä»ã€‚</li>\n</ul><p>å› æ­¤ï¼Œæˆ‘ä¸å»ºè®®åœ¨æ¡†æ¶å±‚é¢è¿›è¡Œå¼‚å¸¸çš„è‡ªåŠ¨ã€ç»Ÿä¸€å¤„ç†ï¼Œå°¤å…¶ä¸è¦éšæ„æ•è·å¼‚å¸¸ã€‚ä½†ï¼Œæ¡†æ¶å¯ä»¥åšå…œåº•å·¥ä½œã€‚å¦‚æœå¼‚å¸¸ä¸Šå‡åˆ°æœ€ä¸Šå±‚é€»è¾‘è¿˜æ˜¯æ— æ³•å¤„ç†çš„è¯ï¼Œå¯ä»¥ä»¥ç»Ÿä¸€çš„æ–¹å¼è¿›è¡Œå¼‚å¸¸è½¬æ¢ï¼Œæ¯”å¦‚é€šè¿‡@RestControllerAdvice + @ExceptionHandlerï¼Œæ¥æ•è·è¿™äº›â€œæœªå¤„ç†â€å¼‚å¸¸ï¼š</p><ul>\n<li>å¯¹äºè‡ªå®šä¹‰çš„ä¸šåŠ¡å¼‚å¸¸ï¼Œä»¥Warnçº§åˆ«çš„æ—¥å¿—è®°å½•å¼‚å¸¸ä»¥åŠå½“å‰URLã€æ‰§è¡Œæ–¹æ³•ç­‰ä¿¡æ¯åï¼Œæå–å¼‚å¸¸ä¸­çš„é”™è¯¯ç å’Œæ¶ˆæ¯ç­‰ä¿¡æ¯ï¼Œè½¬æ¢ä¸ºåˆé€‚çš„APIåŒ…è£…ä½“è¿”å›ç»™APIè°ƒç”¨æ–¹ï¼›</li>\n<li>å¯¹äºæ— æ³•å¤„ç†çš„ç³»ç»Ÿå¼‚å¸¸ï¼Œä»¥Errorçº§åˆ«çš„æ—¥å¿—è®°å½•å¼‚å¸¸å’Œä¸Šä¸‹æ–‡ä¿¡æ¯ï¼ˆæ¯”å¦‚URLã€å‚æ•°ã€ç”¨æˆ·IDï¼‰åï¼Œè½¬æ¢ä¸ºæ™®é€‚çš„â€œæœåŠ¡å™¨å¿™ï¼Œè¯·ç¨åå†è¯•â€å¼‚å¸¸ä¿¡æ¯ï¼ŒåŒæ ·ä»¥APIåŒ…è£…ä½“è¿”å›ç»™è°ƒç”¨æ–¹ã€‚</li>\n</ul><p>æ¯”å¦‚ï¼Œä¸‹é¢è¿™æ®µä»£ç çš„åšæ³•ï¼š</p><pre><code>@RestControllerAdvice\n@Slf4j\npublic class RestControllerExceptionHandler {\n    private static int GENERIC_SERVER_ERROR_CODE = 2000;\n    private static String GENERIC_SERVER_ERROR_MESSAGE = &quot;æœåŠ¡å™¨å¿™ï¼Œè¯·ç¨åå†è¯•&quot;;\n\n    @ExceptionHandler\n    public APIResponse handle(HttpServletRequest req, HandlerMethod method, Exception ex) {\n        if (ex instanceof BusinessException) {\n            BusinessException exception = (BusinessException) ex;\n            log.warn(String.format(&quot;è®¿é—® %s -&gt; %s å‡ºç°ä¸šåŠ¡å¼‚å¸¸ï¼&quot;, req.getRequestURI(), method.toString()), ex);\n            return new APIResponse(false, null, exception.getCode(), exception.getMessage());\n        } else {\n            log.error(String.format(&quot;è®¿é—® %s -&gt; %s å‡ºç°ç³»ç»Ÿå¼‚å¸¸ï¼&quot;, req.getRequestURI(), method.toString()), ex);\n            return new APIResponse(false, null, GENERIC_SERVER_ERROR_CODE, GENERIC_SERVER_ERROR_MESSAGE);\n        }\n    }\n}\n</code></pre><p>å‡ºç°è¿è¡Œæ—¶ç³»ç»Ÿå¼‚å¸¸åï¼Œå¼‚å¸¸å¤„ç†ç¨‹åºä¼šç›´æ¥æŠŠå¼‚å¸¸è½¬æ¢ä¸ºJSONè¿”å›ç»™è°ƒç”¨æ–¹ï¼š</p><p><img src=\"https://static001.geekbang.org/resource/image/c2/84/c215e78f1b23583393649fa89efe9f84.png?wh=774*308\" alt=\"\"></p><p>è¦åšå¾—æ›´å¥½ï¼Œä½ å¯ä»¥æŠŠç›¸å…³å‡ºå…¥å‚ã€ç”¨æˆ·ä¿¡æ¯åœ¨è„±æ•åè®°å½•åˆ°æ—¥å¿—ä¸­ï¼Œæ–¹ä¾¿å‡ºç°é—®é¢˜æ—¶æ ¹æ®ä¸Šä¸‹æ–‡è¿›ä¸€æ­¥æ’æŸ¥ã€‚</p><p>ç¬¬äºŒä¸ªé”™ï¼Œ<strong>æ•è·äº†å¼‚å¸¸åç›´æ¥ç”Ÿå</strong>ã€‚åœ¨ä»»ä½•æ—¶å€™ï¼Œæˆ‘ä»¬æ•è·äº†å¼‚å¸¸éƒ½ä¸åº”è¯¥ç”Ÿåï¼Œä¹Ÿå°±æ˜¯ç›´æ¥ä¸¢å¼ƒå¼‚å¸¸ä¸è®°å½•ã€ä¸æŠ›å‡ºã€‚è¿™æ ·çš„å¤„ç†æ–¹å¼è¿˜ä¸å¦‚ä¸æ•è·å¼‚å¸¸ï¼Œå› ä¸ºè¢«ç”Ÿåæ‰çš„å¼‚å¸¸ä¸€æ—¦å¯¼è‡´Bugï¼Œå°±å¾ˆéš¾åœ¨ç¨‹åºä¸­æ‰¾åˆ°è››ä¸é©¬è¿¹ï¼Œä½¿å¾—Bugæ’æŸ¥å·¥ä½œéš¾ä¸ŠåŠ éš¾ã€‚</p><p>é€šå¸¸æƒ…å†µä¸‹ï¼Œç”Ÿåå¼‚å¸¸çš„åŸå› ï¼Œå¯èƒ½æ˜¯ä¸å¸Œæœ›è‡ªå·±çš„æ–¹æ³•æŠ›å‡ºå—æ£€å¼‚å¸¸ï¼Œåªæ˜¯ä¸ºäº†æŠŠå¼‚å¸¸â€œå¤„ç†æ‰â€è€Œæ•è·å¹¶ç”Ÿåå¼‚å¸¸ï¼Œä¹Ÿå¯èƒ½æ˜¯æƒ³å½“ç„¶åœ°è®¤ä¸ºå¼‚å¸¸å¹¶ä¸é‡è¦æˆ–ä¸å¯èƒ½äº§ç”Ÿã€‚ä½†ä¸ç®¡æ˜¯ä»€ä¹ˆåŸå› ï¼Œä¸ç®¡æ˜¯ä½ è®¤ä¸ºå¤šä¹ˆä¸é‡è¦çš„å¼‚å¸¸ï¼Œéƒ½ä¸åº”è¯¥ç”Ÿåï¼Œå“ªæ€•æ˜¯ä¸€ä¸ªæ—¥å¿—ä¹Ÿå¥½ã€‚</p><p>ç¬¬ä¸‰ä¸ªé”™ï¼Œ<strong>ä¸¢å¼ƒå¼‚å¸¸çš„åŸå§‹ä¿¡æ¯</strong>ã€‚æˆ‘ä»¬æ¥çœ‹ä¸¤ä¸ªä¸å¤ªåˆé€‚çš„å¼‚å¸¸å¤„ç†æ–¹å¼ï¼Œè™½ç„¶æ²¡æœ‰å®Œå…¨ç”Ÿåå¼‚å¸¸ï¼Œä½†ä¹Ÿä¸¢å¤±äº†å®è´µçš„å¼‚å¸¸ä¿¡æ¯ã€‚</p><p>æ¯”å¦‚æœ‰è¿™ä¹ˆä¸€ä¸ªä¼šæŠ›å‡ºå—æ£€å¼‚å¸¸çš„æ–¹æ³•readFileï¼š</p><pre><code>private void readFile() throws IOException {\n\tFiles.readAllLines(Paths.get(&quot;a_file&quot;));\n}\n</code></pre><p>åƒè¿™æ ·è°ƒç”¨readFileæ–¹æ³•ï¼Œæ•è·å¼‚å¸¸åï¼Œå®Œå…¨ä¸è®°å½•åŸå§‹å¼‚å¸¸ï¼Œç›´æ¥æŠ›å‡ºä¸€ä¸ªè½¬æ¢åå¼‚å¸¸ï¼Œå¯¼è‡´å‡ºäº†é—®é¢˜ä¸çŸ¥é“IOExceptionå…·ä½“æ˜¯å“ªé‡Œå¼•èµ·çš„ï¼š</p><pre><code>@GetMapping(&quot;wrong1&quot;)\npublic void wrong1(){\n    try {\n        readFile();\n    } catch (IOException e) {\n        //åŸå§‹å¼‚å¸¸ä¿¡æ¯ä¸¢å¤±  \n        throw new RuntimeException(&quot;ç³»ç»Ÿå¿™è¯·ç¨åå†è¯•&quot;);\n    }\n}\n</code></pre><p>æˆ–è€…æ˜¯è¿™æ ·ï¼Œåªè®°å½•äº†å¼‚å¸¸æ¶ˆæ¯ï¼Œå´ä¸¢å¤±äº†å¼‚å¸¸çš„ç±»å‹ã€æ ˆç­‰é‡è¦ä¿¡æ¯ï¼š</p><pre><code>catch (IOException e) {\n    //åªä¿ç•™äº†å¼‚å¸¸æ¶ˆæ¯ï¼Œæ ˆæ²¡æœ‰è®°å½•\n    log.error(&quot;æ–‡ä»¶è¯»å–é”™è¯¯, {}&quot;, e.getMessage());\n    throw new RuntimeException(&quot;ç³»ç»Ÿå¿™è¯·ç¨åå†è¯•&quot;);\n}\n</code></pre><p>ç•™ä¸‹çš„æ—¥å¿—æ˜¯è¿™æ ·çš„ï¼Œçœ‹å®Œä¸€è„¸èŒ«ç„¶ï¼ŒåªçŸ¥é“æ–‡ä»¶è¯»å–é”™è¯¯çš„æ–‡ä»¶åï¼Œè‡³äºä¸ºä»€ä¹ˆè¯»å–é”™è¯¯ã€æ˜¯ä¸å­˜åœ¨è¿˜æ˜¯æ²¡æƒé™ï¼Œå®Œå…¨ä¸çŸ¥é“ã€‚</p><pre><code>[12:57:19.746] [http-nio-45678-exec-1] [ERROR] [.g.t.c.e.d.HandleExceptionController:35  ] - æ–‡ä»¶è¯»å–é”™è¯¯, a_file\n</code></pre><p>è¿™ä¸¤ç§å¤„ç†æ–¹å¼éƒ½ä¸å¤ªåˆç†ï¼Œå¯ä»¥æ”¹ä¸ºå¦‚ä¸‹æ–¹å¼ï¼š</p><pre><code>catch (IOException e) {\n    log.error(&quot;æ–‡ä»¶è¯»å–é”™è¯¯&quot;, e);\n    throw new RuntimeException(&quot;ç³»ç»Ÿå¿™è¯·ç¨åå†è¯•&quot;);\n}\n</code></pre><p>æˆ–è€…ï¼ŒæŠŠåŸå§‹å¼‚å¸¸ä½œä¸ºè½¬æ¢åæ–°å¼‚å¸¸çš„causeï¼ŒåŸå§‹å¼‚å¸¸ä¿¡æ¯åŒæ ·ä¸ä¼šä¸¢ï¼š</p><pre><code>catch (IOException e) {\n    throw new RuntimeException(&quot;ç³»ç»Ÿå¿™è¯·ç¨åå†è¯•&quot;, e);\n}\n</code></pre><p>å…¶å®ï¼ŒJDKå†…éƒ¨ä¹Ÿä¼šçŠ¯ç±»ä¼¼çš„é”™ã€‚ä¹‹å‰æˆ‘é‡åˆ°ä¸€ä¸ªä½¿ç”¨JDK10çš„åº”ç”¨å¶å‘å¯åŠ¨å¤±è´¥çš„æ¡ˆä¾‹ï¼Œæ—¥å¿—ä¸­å¯ä»¥çœ‹åˆ°å‡ºç°ç±»ä¼¼çš„é”™è¯¯ä¿¡æ¯ï¼š</p><pre><code>Caused by: java.lang.SecurityException: Couldn't parse jurisdiction policy files in: unlimited\n\tat java.base/javax.crypto.JceSecurity.setupJurisdictionPolicies(JceSecurity.java:355)\n\tat java.base/javax.crypto.JceSecurity.access$000(JceSecurity.java:73)\n\tat java.base/javax.crypto.JceSecurity$1.run(JceSecurity.java:109)\n\tat java.base/javax.crypto.JceSecurity$1.run(JceSecurity.java:106)\n\tat java.base/java.security.AccessController.doPrivileged(Native Method)\n\tat java.base/javax.crypto.JceSecurity.&lt;clinit&gt;(JceSecurity.java:105)\n\t... 20 more\n</code></pre><p>æŸ¥çœ‹JDK JceSecurityç±»setupJurisdictionPoliciesæ–¹æ³•æºç ï¼Œå‘ç°å¼‚å¸¸eæ²¡æœ‰è®°å½•ï¼Œä¹Ÿæ²¡æœ‰ä½œä¸ºæ–°æŠ›å‡ºå¼‚å¸¸çš„causeï¼Œå½“æ—¶è¯»å–æ–‡ä»¶å…·ä½“å‡ºç°ä»€ä¹ˆå¼‚å¸¸ï¼ˆæƒé™é—®é¢˜åˆæˆ–æ˜¯IOé—®é¢˜ï¼‰å¯èƒ½æ°¸è¿œéƒ½æ— æ³•çŸ¥é“äº†ï¼Œå¯¹é—®é¢˜å®šä½é€ æˆäº†å¾ˆå¤§å›°æ‰°ï¼š</p><p><img src=\"https://static001.geekbang.org/resource/image/b8/65/b8b581f6130211a19ed66490dbcd0465.png?wh=1926*1124\" alt=\"\"></p><p>ç¬¬å››ä¸ªé”™ï¼Œ<strong>æŠ›å‡ºå¼‚å¸¸æ—¶ä¸æŒ‡å®šä»»ä½•æ¶ˆæ¯</strong>ã€‚æˆ‘è§è¿‡ä¸€äº›ä»£ç ä¸­çš„å·æ‡’åšæ³•ï¼Œç›´æ¥æŠ›å‡ºæ²¡æœ‰messageçš„å¼‚å¸¸ï¼š</p><pre><code>throw new RuntimeException();\n</code></pre><p>è¿™ä¹ˆå†™çš„åŒå­¦å¯èƒ½è§‰å¾—æ°¸è¿œä¸ä¼šèµ°åˆ°è¿™ä¸ªé€»è¾‘ï¼Œæ°¸è¿œä¸ä¼šå‡ºç°è¿™æ ·çš„å¼‚å¸¸ã€‚ä½†ï¼Œè¿™æ ·çš„å¼‚å¸¸å´å‡ºç°äº†ï¼Œè¢«ExceptionHandleræ‹¦æˆªåˆ°åè¾“å‡ºäº†ä¸‹é¢çš„æ—¥å¿—ä¿¡æ¯ï¼š</p><pre><code>[13:25:18.031] [http-nio-45678-exec-3] [ERROR] [c.e.d.RestControllerExceptionHandler:24  ] - è®¿é—® /handleexception/wrong3 -&gt; org.geekbang.time.commonmistakes.exception.demo1.HandleExceptionController#wrong3(String) å‡ºç°ç³»ç»Ÿå¼‚å¸¸ï¼\njava.lang.RuntimeException: null\n...\n</code></pre><p>è¿™é‡Œçš„nulléå¸¸å®¹æ˜“å¼•èµ·è¯¯è§£ã€‚æŒ‰ç…§ç©ºæŒ‡é’ˆé—®é¢˜æ’æŸ¥åŠå¤©æ‰å‘ç°ï¼Œå…¶å®æ˜¯å¼‚å¸¸çš„messageä¸ºç©ºã€‚</p><p>æ€»ä¹‹ï¼Œå¦‚æœä½ æ•è·äº†å¼‚å¸¸æ‰“ç®—å¤„ç†çš„è¯ï¼Œ<strong>é™¤äº†é€šè¿‡æ—¥å¿—æ­£ç¡®è®°å½•å¼‚å¸¸åŸå§‹ä¿¡æ¯å¤–ï¼Œé€šå¸¸è¿˜æœ‰ä¸‰ç§å¤„ç†æ¨¡å¼</strong>ï¼š</p><ul>\n<li>è½¬æ¢ï¼Œå³è½¬æ¢æ–°çš„å¼‚å¸¸æŠ›å‡ºã€‚å¯¹äºæ–°æŠ›å‡ºçš„å¼‚å¸¸ï¼Œæœ€å¥½å…·æœ‰ç‰¹å®šçš„åˆ†ç±»å’Œæ˜ç¡®çš„å¼‚å¸¸æ¶ˆæ¯ï¼Œè€Œä¸æ˜¯éšä¾¿æŠ›ä¸€ä¸ªæ— å…³æˆ–æ²¡æœ‰ä»»ä½•ä¿¡æ¯çš„å¼‚å¸¸ï¼Œå¹¶æœ€å¥½é€šè¿‡causeå…³è”è€å¼‚å¸¸ã€‚</li>\n<li>é‡è¯•ï¼Œå³é‡è¯•ä¹‹å‰çš„æ“ä½œã€‚æ¯”å¦‚è¿œç¨‹è°ƒç”¨æœåŠ¡ç«¯è¿‡è½½è¶…æ—¶çš„æƒ…å†µï¼Œç›²ç›®é‡è¯•ä¼šè®©é—®é¢˜æ›´ä¸¥é‡ï¼Œéœ€è¦è€ƒè™‘å½“å‰æƒ…å†µæ˜¯å¦é€‚åˆé‡è¯•ã€‚</li>\n<li>æ¢å¤ï¼Œå³å°è¯•è¿›è¡Œé™çº§å¤„ç†ï¼Œæˆ–ä½¿ç”¨é»˜è®¤å€¼æ¥æ›¿ä»£åŸå§‹æ•°æ®ã€‚</li>\n</ul><p>ä»¥ä¸Šï¼Œå°±æ˜¯é€šè¿‡catchæ•è·å¤„ç†å¼‚å¸¸çš„ä¸€äº›æœ€ä½³å®è·µã€‚</p><h2>å°å¿ƒfinallyä¸­çš„å¼‚å¸¸</h2><p>æœ‰äº›æ—¶å€™ï¼Œæˆ‘ä»¬å¸Œæœ›ä¸ç®¡æ˜¯å¦é‡åˆ°å¼‚å¸¸ï¼Œé€»è¾‘å®Œæˆåéƒ½è¦é‡Šæ”¾èµ„æºï¼Œè¿™æ—¶å¯ä»¥ä½¿ç”¨finallyä»£ç å—è€Œè·³è¿‡ä½¿ç”¨catchä»£ç å—ã€‚</p><p>ä½†è¦åƒä¸‡å°å¿ƒfinallyä»£ç å—ä¸­çš„å¼‚å¸¸ï¼Œå› ä¸ºèµ„æºé‡Šæ”¾å¤„ç†ç­‰æ”¶å°¾æ“ä½œåŒæ ·ä¹Ÿå¯èƒ½å‡ºç°å¼‚å¸¸ã€‚æ¯”å¦‚ä¸‹é¢è¿™æ®µä»£ç ï¼Œæˆ‘ä»¬åœ¨finallyä¸­æŠ›å‡ºä¸€ä¸ªå¼‚å¸¸ï¼š</p><pre><code>@GetMapping(&quot;wrong&quot;)\npublic void wrong() {\n    try {\n        log.info(&quot;try&quot;);\n        //å¼‚å¸¸ä¸¢å¤±\n        throw new RuntimeException(&quot;try&quot;);\n    } finally {\n        log.info(&quot;finally&quot;);\n        throw new RuntimeException(&quot;finally&quot;);\n    }\n}\n</code></pre><p>æœ€ååœ¨æ—¥å¿—ä¸­åªèƒ½çœ‹åˆ°finallyä¸­çš„å¼‚å¸¸ï¼Œ<strong>è™½ç„¶tryä¸­çš„é€»è¾‘å‡ºç°äº†å¼‚å¸¸ï¼Œä½†å´è¢«finallyä¸­çš„å¼‚å¸¸è¦†ç›–äº†</strong>ã€‚è¿™æ˜¯éå¸¸å±é™©çš„ï¼Œç‰¹åˆ«æ˜¯finallyä¸­å‡ºç°çš„å¼‚å¸¸æ˜¯å¶å‘çš„ï¼Œå°±ä¼šåœ¨éƒ¨åˆ†æ—¶å€™è¦†ç›–tryä¸­çš„å¼‚å¸¸ï¼Œè®©é—®é¢˜æ›´ä¸æ˜æ˜¾ï¼š</p><pre><code>[13:34:42.247] [http-nio-45678-exec-1] [ERROR] [.a.c.c.C.[.[.[/].[dispatcherServlet]:175 ] - Servlet.service() for servlet [dispatcherServlet] in context with path [] threw exception [Request processing failed; nested exception is java.lang.RuntimeException: finally] with root cause\njava.lang.RuntimeException: finally\n</code></pre><p>è‡³äºå¼‚å¸¸ä¸ºä»€ä¹ˆè¢«è¦†ç›–ï¼ŒåŸå› ä¹Ÿå¾ˆç®€å•ï¼Œå› ä¸ºä¸€ä¸ªæ–¹æ³•æ— æ³•å‡ºç°ä¸¤ä¸ªå¼‚å¸¸ã€‚ä¿®å¤æ–¹å¼æ˜¯ï¼Œfinallyä»£ç å—è‡ªå·±è´Ÿè´£å¼‚å¸¸æ•è·å’Œå¤„ç†ï¼š</p><pre><code>@GetMapping(&quot;right&quot;)\npublic void right() {\n    try {\n        log.info(&quot;try&quot;);\n        throw new RuntimeException(&quot;try&quot;);\n    } finally {\n        log.info(&quot;finally&quot;);\n        try {\n            throw new RuntimeException(&quot;finally&quot;);\n        } catch (Exception ex) {\n            log.error(&quot;finally&quot;, ex);\n        }\n    }\n}\n</code></pre><p>æˆ–è€…å¯ä»¥æŠŠtryä¸­çš„å¼‚å¸¸ä½œä¸ºä¸»å¼‚å¸¸æŠ›å‡ºï¼Œä½¿ç”¨addSuppressedæ–¹æ³•æŠŠfinallyä¸­çš„å¼‚å¸¸é™„åŠ åˆ°ä¸»å¼‚å¸¸ä¸Šï¼š</p><pre><code>@GetMapping(&quot;right2&quot;)\npublic void right2() throws Exception {\n    Exception e = null;\n    try {\n        log.info(&quot;try&quot;);\n        throw new RuntimeException(&quot;try&quot;);\n    } catch (Exception ex) {\n        e = ex;\n    } finally {\n        log.info(&quot;finally&quot;);\n        try {\n            throw new RuntimeException(&quot;finally&quot;);\n        } catch (Exception ex) {\n            if (e!= null) {\n                e.addSuppressed(ex);\n            } else {\n                e = ex;\n            }\n        }\n    }\n    throw e;\n}\n</code></pre><p>è¿è¡Œæ–¹æ³•å¯ä»¥å¾—åˆ°å¦‚ä¸‹å¼‚å¸¸ä¿¡æ¯ï¼Œå…¶ä¸­åŒæ—¶åŒ…å«äº†ä¸»å¼‚å¸¸å’Œè¢«å±è”½çš„å¼‚å¸¸ï¼š</p><pre><code>java.lang.RuntimeException: try\n\tat org.geekbang.time.commonmistakes.exception.finallyissue.FinallyIssueController.right2(FinallyIssueController.java:69)\n\tat sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\n\t...\n\tSuppressed: java.lang.RuntimeException: finally\n\t\tat org.geekbang.time.commonmistakes.exception.finallyissue.FinallyIssueController.right2(FinallyIssueController.java:75)\n\t\t... 54 common frames omitted\n</code></pre><p>å…¶å®è¿™æ­£æ˜¯try-with-resourcesè¯­å¥çš„åšæ³•ï¼Œå¯¹äºå®ç°äº†AutoCloseableæ¥å£çš„èµ„æºï¼Œå»ºè®®ä½¿ç”¨try-with-resourcesæ¥é‡Šæ”¾èµ„æºï¼Œå¦åˆ™ä¹Ÿå¯èƒ½ä¼šäº§ç”Ÿåˆšæ‰æåˆ°çš„ï¼Œé‡Šæ”¾èµ„æºæ—¶å‡ºç°çš„å¼‚å¸¸è¦†ç›–ä¸»å¼‚å¸¸çš„é—®é¢˜ã€‚æ¯”å¦‚å¦‚ä¸‹æˆ‘ä»¬å®šä¹‰ä¸€ä¸ªæµ‹è¯•èµ„æºï¼Œå…¶readå’Œcloseæ–¹æ³•éƒ½ä¼šæŠ›å‡ºå¼‚å¸¸ï¼š</p><pre><code>public class TestResource implements AutoCloseable {\n    public void read() throws Exception{\n        throw new Exception(&quot;read error&quot;);\n    }\n    @Override\n    public void close() throws Exception {\n        throw new Exception(&quot;close error&quot;);\n    }\n}\n</code></pre><p>ä½¿ç”¨ä¼ ç»Ÿçš„try-finallyè¯­å¥ï¼Œåœ¨tryä¸­è°ƒç”¨readæ–¹æ³•ï¼Œåœ¨finallyä¸­è°ƒç”¨closeæ–¹æ³•ï¼š</p><pre><code>@GetMapping(&quot;useresourcewrong&quot;)\npublic void useresourcewrong() throws Exception {\n    TestResource testResource = new TestResource();\n    try {\n        testResource.read();\n    } finally {\n        testResource.close();\n    }\n}\n</code></pre><p>å¯ä»¥çœ‹åˆ°ï¼ŒåŒæ ·å‡ºç°äº†finallyä¸­çš„å¼‚å¸¸è¦†ç›–äº†tryä¸­å¼‚å¸¸çš„é—®é¢˜ï¼š</p><pre><code>java.lang.Exception: close error\n\tat org.geekbang.time.commonmistakes.exception.finallyissue.TestResource.close(TestResource.java:10)\n\tat org.geekbang.time.commonmistakes.exception.finallyissue.FinallyIssueController.useresourcewrong(FinallyIssueController.java:27)\n</code></pre><p>è€Œæ”¹ä¸ºtry-with-resourcesæ¨¡å¼ä¹‹åï¼š</p><pre><code>@GetMapping(&quot;useresourceright&quot;)\npublic void useresourceright() throws Exception {\n    try (TestResource testResource = new TestResource()){\n        testResource.read();\n    }\n}\n</code></pre><p>tryå’Œfinallyä¸­çš„å¼‚å¸¸ä¿¡æ¯éƒ½å¯ä»¥å¾—åˆ°ä¿ç•™ï¼š</p><pre><code>java.lang.Exception: read error\n\tat org.geekbang.time.commonmistakes.exception.finallyissue.TestResource.read(TestResource.java:6)\n\t...\n\tSuppressed: java.lang.Exception: close error\n\t\tat org.geekbang.time.commonmistakes.exception.finallyissue.TestResource.close(TestResource.java:10)\n\t\tat org.geekbang.time.commonmistakes.exception.finallyissue.FinallyIssueController.useresourceright(FinallyIssueController.java:35)\n\t\t... 54 common frames omitted\n</code></pre><h2>åƒä¸‡åˆ«æŠŠå¼‚å¸¸å®šä¹‰ä¸ºé™æ€å˜é‡</h2><p>æ—¢ç„¶æˆ‘ä»¬é€šå¸¸ä¼šè‡ªå®šä¹‰ä¸€ä¸ªä¸šåŠ¡å¼‚å¸¸ç±»å‹ï¼Œæ¥åŒ…å«æ›´å¤šçš„å¼‚å¸¸ä¿¡æ¯ï¼Œæ¯”å¦‚å¼‚å¸¸é”™è¯¯ç ã€å‹å¥½çš„é”™è¯¯æç¤ºç­‰ï¼Œé‚£å°±éœ€è¦åœ¨ä¸šåŠ¡é€»è¾‘å„å¤„ï¼Œæ‰‹åŠ¨æŠ›å‡ºå„ç§ä¸šåŠ¡å¼‚å¸¸æ¥è¿”å›æŒ‡å®šçš„é”™è¯¯ç æè¿°ï¼ˆæ¯”å¦‚å¯¹äºä¸‹å•æ“ä½œï¼Œç”¨æˆ·ä¸å­˜åœ¨è¿”å›2001ï¼Œå•†å“ç¼ºè´§è¿”å›2002ç­‰ï¼‰ã€‚</p><p>å¯¹äºè¿™äº›å¼‚å¸¸çš„é”™è¯¯ä»£ç å’Œæ¶ˆæ¯ï¼Œæˆ‘ä»¬æœŸæœ›èƒ½å¤Ÿç»Ÿä¸€ç®¡ç†ï¼Œè€Œä¸æ˜¯æ•£è½åœ¨ç¨‹åºå„å¤„å®šä¹‰ã€‚è¿™ä¸ªæƒ³æ³•å¾ˆå¥½ï¼Œä½†ç¨æœ‰ä¸æ…å°±å¯èƒ½ä¼šå‡ºç°æŠŠå¼‚å¸¸å®šä¹‰ä¸ºé™æ€å˜é‡çš„å‘ã€‚</p><p>æˆ‘åœ¨æ•‘ç«æ’æŸ¥æŸé¡¹ç›®ç”Ÿäº§é—®é¢˜æ—¶ï¼Œé‡åˆ°äº†ä¸€ä»¶éå¸¸è¯¡å¼‚çš„äº‹æƒ…ï¼šæˆ‘å‘ç°å¼‚å¸¸å †ä¿¡æ¯æ˜¾ç¤ºçš„æ–¹æ³•è°ƒç”¨è·¯å¾„ï¼Œåœ¨å½“å‰å…¥å‚çš„æƒ…å†µä¸‹æ ¹æœ¬ä¸å¯èƒ½äº§ç”Ÿï¼Œé¡¹ç›®çš„ä¸šåŠ¡é€»è¾‘åˆå¾ˆå¤æ‚ï¼Œå°±å§‹ç»ˆæ²¡å¾€å¼‚å¸¸ä¿¡æ¯æ˜¯é”™çš„è¿™æ–¹é¢æƒ³ï¼Œæ€»è§‰å¾—æ˜¯å› ä¸ºæŸä¸ªåˆ†æ”¯æµç¨‹å¯¼è‡´ä¸šåŠ¡æ²¡æœ‰æŒ‰ç…§æœŸæœ›çš„æµç¨‹è¿›è¡Œã€‚</p><p><strong>ç»è¿‡è‰°éš¾çš„æ’æŸ¥ï¼Œæœ€ç»ˆå®šä½åˆ°åŸå› æ˜¯æŠŠå¼‚å¸¸å®šä¹‰ä¸ºäº†é™æ€å˜é‡ï¼Œå¯¼è‡´å¼‚å¸¸æ ˆä¿¡æ¯é”™ä¹±</strong>ï¼Œç±»ä¼¼äºå®šä¹‰ä¸€ä¸ªExceptionsç±»æ¥æ±‡æ€»æ‰€æœ‰çš„å¼‚å¸¸ï¼ŒæŠŠå¼‚å¸¸å­˜æ”¾åœ¨é™æ€å­—æ®µä¸­ï¼š</p><pre><code>public class Exceptions {\n    public static BusinessException ORDEREXISTS = new BusinessException(&quot;è®¢å•å·²ç»å­˜åœ¨&quot;, 3001);\n...\n}\n</code></pre><p>æŠŠå¼‚å¸¸å®šä¹‰ä¸ºé™æ€å˜é‡ä¼šå¯¼è‡´å¼‚å¸¸ä¿¡æ¯å›ºåŒ–ï¼Œè¿™å°±å’Œå¼‚å¸¸çš„æ ˆä¸€å®šæ˜¯éœ€è¦æ ¹æ®å½“å‰è°ƒç”¨æ¥åŠ¨æ€è·å–ç›¸çŸ›ç›¾ã€‚</p><p>æˆ‘ä»¬å†™æ®µä»£ç æ¥æ¨¡æ‹Ÿä¸‹è¿™ä¸ªé—®é¢˜ï¼šå®šä¹‰ä¸¤ä¸ªæ–¹æ³•createOrderWrongå’ŒcancelOrderWrongæ–¹æ³•ï¼Œå®ƒä»¬å†…éƒ¨éƒ½ä¼šé€šè¿‡Exceptionsç±»æ¥è·å¾—ä¸€ä¸ªè®¢å•ä¸å­˜åœ¨çš„å¼‚å¸¸ï¼›å…ˆåè°ƒç”¨ä¸¤ä¸ªæ–¹æ³•ï¼Œç„¶åæŠ›å‡ºã€‚</p><pre><code>@GetMapping(&quot;wrong&quot;)\npublic void wrong() {\n    try {\n        createOrderWrong();\n    } catch (Exception ex) {\n        log.error(&quot;createOrder got error&quot;, ex);\n    }\n    try {\n        cancelOrderWrong();\n    } catch (Exception ex) {\n        log.error(&quot;cancelOrder got error&quot;, ex);\n    }\n}\n\nprivate void createOrderWrong() {\n    //è¿™é‡Œæœ‰é—®é¢˜\n    throw Exceptions.ORDEREXISTS;\n}\n\nprivate void cancelOrderWrong() {\n    //è¿™é‡Œæœ‰é—®é¢˜\n    throw Exceptions.ORDEREXISTS;\n}\n</code></pre><p>è¿è¡Œç¨‹åºåçœ‹åˆ°å¦‚ä¸‹æ—¥å¿—ï¼ŒcancelOrder got errorçš„æç¤ºå¯¹åº”äº†createOrderWrongæ–¹æ³•ã€‚æ˜¾ç„¶ï¼ŒcancelOrderWrongæ–¹æ³•åœ¨å‡ºé”™åæŠ›å‡ºçš„å¼‚å¸¸ï¼Œå…¶å®æ˜¯createOrderWrongæ–¹æ³•å‡ºé”™çš„å¼‚å¸¸ï¼š</p><pre><code>[14:05:25.782] [http-nio-45678-exec-1] [ERROR] [.c.e.d.PredefinedExceptionController:25  ] - cancelOrder got error\norg.geekbang.time.commonmistakes.exception.demo2.BusinessException: è®¢å•å·²ç»å­˜åœ¨\n\tat org.geekbang.time.commonmistakes.exception.demo2.Exceptions.&lt;clinit&gt;(Exceptions.java:5)\n\tat org.geekbang.time.commonmistakes.exception.demo2.PredefinedExceptionController.createOrderWrong(PredefinedExceptionController.java:50)\n\tat org.geekbang.time.commonmistakes.exception.demo2.PredefinedExceptionController.wrong(PredefinedExceptionController.java:18)\n</code></pre><p>ä¿®å¤æ–¹å¼å¾ˆç®€å•ï¼Œæ”¹ä¸€ä¸‹Exceptionsç±»çš„å®ç°ï¼Œé€šè¿‡ä¸åŒçš„æ–¹æ³•æŠŠæ¯ä¸€ç§å¼‚å¸¸éƒ½newå‡ºæ¥æŠ›å‡ºå³å¯ï¼š</p><pre><code>public class Exceptions {\n    public static BusinessException orderExists(){\n        return new BusinessException(&quot;è®¢å•å·²ç»å­˜åœ¨&quot;, 3001);\n    }\n}\n</code></pre><h2>æäº¤çº¿ç¨‹æ± çš„ä»»åŠ¡å‡ºäº†å¼‚å¸¸ä¼šæ€ä¹ˆæ ·ï¼Ÿ</h2><p>åœ¨<a href=\"https://time.geekbang.org/column/article/210337\">ç¬¬3è®²</a>ä»‹ç»çº¿ç¨‹æ± æ—¶æˆ‘æåˆ°ï¼Œçº¿ç¨‹æ± å¸¸ç”¨ä½œå¼‚æ­¥å¤„ç†æˆ–å¹¶è¡Œå¤„ç†ã€‚é‚£ä¹ˆï¼ŒæŠŠä»»åŠ¡æäº¤åˆ°çº¿ç¨‹æ± å¤„ç†ï¼Œä»»åŠ¡æœ¬èº«å‡ºç°å¼‚å¸¸æ—¶ä¼šæ€æ ·å‘¢ï¼Ÿ</p><p>æˆ‘ä»¬æ¥çœ‹ä¸€ä¸ªä¾‹å­ï¼šæäº¤10ä¸ªä»»åŠ¡åˆ°çº¿ç¨‹æ± å¼‚æ­¥å¤„ç†ï¼Œç¬¬5ä¸ªä»»åŠ¡æŠ›å‡ºä¸€ä¸ªRuntimeExceptionï¼Œæ¯ä¸ªä»»åŠ¡å®Œæˆåéƒ½ä¼šè¾“å‡ºä¸€è¡Œæ—¥å¿—ï¼š</p><pre><code>@GetMapping(&quot;execute&quot;)\npublic void execute() throws InterruptedException {\n\n    String prefix = &quot;test&quot;;\n    ExecutorService threadPool = Executors.newFixedThreadPool(1, new ThreadFactoryBuilder().setNameFormat(prefix+&quot;%d&quot;).get());\n    //æäº¤10ä¸ªä»»åŠ¡åˆ°çº¿ç¨‹æ± å¤„ç†ï¼Œç¬¬5ä¸ªä»»åŠ¡ä¼šæŠ›å‡ºè¿è¡Œæ—¶å¼‚å¸¸\n    IntStream.rangeClosed(1, 10).forEach(i -&gt; threadPool.execute(() -&gt; {\n        if (i == 5) throw new RuntimeException(&quot;error&quot;);\n        log.info(&quot;I'm done : {}&quot;, i);\n    }));\n\n    threadPool.shutdown();\n    threadPool.awaitTermination(1, TimeUnit.HOURS);\n}\n</code></pre><p>è§‚å¯Ÿæ—¥å¿—å¯ä»¥å‘ç°ä¸¤ç‚¹ï¼š</p><pre><code>...\n[14:33:55.990] [test0] [INFO ] [e.d.ThreadPoolAndExceptionController:26  ] - I'm done : 4\nException in thread &quot;test0&quot; java.lang.RuntimeException: error\n\tat org.geekbang.time.commonmistakes.exception.demo3.ThreadPoolAndExceptionController.lambda$null$0(ThreadPoolAndExceptionController.java:25)\n\tat java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)\n\tat java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)\n\tat java.lang.Thread.run(Thread.java:748)\n[14:33:55.990] [test1] [INFO ] [e.d.ThreadPoolAndExceptionController:26  ] - I'm done : 6\n...\n</code></pre><ul>\n<li>ä»»åŠ¡1åˆ°4æ‰€åœ¨çš„çº¿ç¨‹æ˜¯test0ï¼Œä»»åŠ¡6å¼€å§‹è¿è¡Œåœ¨çº¿ç¨‹test1ã€‚ç”±äºæˆ‘çš„çº¿ç¨‹æ± é€šè¿‡çº¿ç¨‹å·¥å‚ä¸ºçº¿ç¨‹ä½¿ç”¨ç»Ÿä¸€çš„å‰ç¼€teståŠ ä¸Šè®¡æ•°å™¨è¿›è¡Œå‘½åï¼Œå› æ­¤<strong>ä»çº¿ç¨‹åçš„æ”¹å˜å¯ä»¥çŸ¥é“å› ä¸ºå¼‚å¸¸çš„æŠ›å‡ºè€çº¿ç¨‹é€€å‡ºäº†ï¼Œçº¿ç¨‹æ± åªèƒ½é‡æ–°åˆ›å»ºä¸€ä¸ªçº¿ç¨‹</strong>ã€‚å¦‚æœæ¯ä¸ªå¼‚æ­¥ä»»åŠ¡éƒ½ä»¥å¼‚å¸¸ç»“æŸï¼Œé‚£ä¹ˆçº¿ç¨‹æ± å¯èƒ½å®Œå…¨èµ·ä¸åˆ°çº¿ç¨‹é‡ç”¨çš„ä½œç”¨ã€‚</li>\n<li>å› ä¸ºæ²¡æœ‰æ‰‹åŠ¨æ•è·å¼‚å¸¸è¿›è¡Œå¤„ç†ï¼ŒThreadGroupå¸®æˆ‘ä»¬è¿›è¡Œäº†æœªæ•è·å¼‚å¸¸çš„é»˜è®¤å¤„ç†ï¼Œå‘æ ‡å‡†é”™è¯¯è¾“å‡ºæ‰“å°äº†å‡ºç°å¼‚å¸¸çš„çº¿ç¨‹åç§°å’Œå¼‚å¸¸ä¿¡æ¯ã€‚<strong>æ˜¾ç„¶ï¼Œè¿™ç§æ²¡æœ‰ä»¥ç»Ÿä¸€çš„é”™è¯¯æ—¥å¿—æ ¼å¼è®°å½•é”™è¯¯ä¿¡æ¯æ‰“å°å‡ºæ¥çš„å½¢å¼ï¼Œå¯¹ç”Ÿäº§çº§ä»£ç æ˜¯ä¸åˆé€‚çš„</strong>ï¼ŒThreadGroupçš„ç›¸å…³æºç å¦‚ä¸‹æ‰€ç¤ºï¼š</li>\n</ul><pre><code>public void uncaughtException(Thread t, Throwable e) {\n        if (parent != null) {\n            parent.uncaughtException(t, e);\n        } else {\n            Thread.UncaughtExceptionHandler ueh =\n                Thread.getDefaultUncaughtExceptionHandler();\n            if (ueh != null) {\n                ueh.uncaughtException(t, e);\n            } else if (!(e instanceof ThreadDeath)) {\n                System.err.print(&quot;Exception in thread \\&quot;&quot;\n                                 + t.getName() + &quot;\\&quot; &quot;);\n                e.printStackTrace(System.err);\n            }\n        }\n    }\n</code></pre><p>ä¿®å¤æ–¹å¼æœ‰2æ­¥ï¼š</p><ol>\n<li>ä»¥executeæ–¹æ³•æäº¤åˆ°çº¿ç¨‹æ± çš„å¼‚æ­¥ä»»åŠ¡ï¼Œæœ€å¥½åœ¨ä»»åŠ¡å†…éƒ¨åšå¥½å¼‚å¸¸å¤„ç†ï¼›</li>\n<li>è®¾ç½®è‡ªå®šä¹‰çš„å¼‚å¸¸å¤„ç†ç¨‹åºä½œä¸ºä¿åº•ï¼Œæ¯”å¦‚åœ¨å£°æ˜çº¿ç¨‹æ± æ—¶è‡ªå®šä¹‰çº¿ç¨‹æ± çš„æœªæ•è·å¼‚å¸¸å¤„ç†ç¨‹åºï¼š</li>\n</ol><pre><code>new ThreadFactoryBuilder()\n\t.setNameFormat(prefix+&quot;%d&quot;)\n\t.setUncaughtExceptionHandler((thread, throwable)-&gt; log.error(&quot;ThreadPool {} got exception&quot;, thread, throwable))\n\t.get()\n</code></pre><p>æˆ–è€…è®¾ç½®å…¨å±€çš„é»˜è®¤æœªæ•è·å¼‚å¸¸å¤„ç†ç¨‹åºï¼š</p><pre><code>static {\n    Thread.setDefaultUncaughtExceptionHandler((thread, throwable)-&gt; log.error(&quot;Thread {} got exception&quot;, thread, throwable));\n}\n</code></pre><p>é€šè¿‡çº¿ç¨‹æ± ExecutorServiceçš„executeæ–¹æ³•æäº¤ä»»åŠ¡åˆ°çº¿ç¨‹æ± å¤„ç†ï¼Œå¦‚æœå‡ºç°å¼‚å¸¸ä¼šå¯¼è‡´çº¿ç¨‹é€€å‡ºï¼Œæ§åˆ¶å°è¾“å‡ºä¸­å¯ä»¥çœ‹åˆ°å¼‚å¸¸ä¿¡æ¯ã€‚é‚£ä¹ˆï¼ŒæŠŠexecuteæ–¹æ³•æ”¹ä¸ºsubmitï¼Œçº¿ç¨‹è¿˜ä¼šé€€å‡ºå—ï¼Œå¼‚å¸¸è¿˜èƒ½è¢«å¤„ç†ç¨‹åºæ•è·åˆ°å—ï¼Ÿ</p><p><strong>ä¿®æ”¹ä»£ç åé‡æ–°æ‰§è¡Œç¨‹åºå¯ä»¥çœ‹åˆ°å¦‚ä¸‹æ—¥å¿—ï¼Œè¯´æ˜çº¿ç¨‹æ²¡é€€å‡ºï¼Œå¼‚å¸¸ä¹Ÿæ²¡è®°å½•è¢«ç”Ÿåäº†ï¼š</strong></p><pre><code>[15:44:33.769] [test0] [INFO ] [e.d.ThreadPoolAndExceptionController:47  ] - I'm done : 1\n[15:44:33.770] [test0] [INFO ] [e.d.ThreadPoolAndExceptionController:47  ] - I'm done : 2\n[15:44:33.770] [test0] [INFO ] [e.d.ThreadPoolAndExceptionController:47  ] - I'm done : 3\n[15:44:33.770] [test0] [INFO ] [e.d.ThreadPoolAndExceptionController:47  ] - I'm done : 4\n[15:44:33.770] [test0] [INFO ] [e.d.ThreadPoolAndExceptionController:47  ] - I'm done : 6\n[15:44:33.770] [test0] [INFO ] [e.d.ThreadPoolAndExceptionController:47  ] - I'm done : 7\n[15:44:33.770] [test0] [INFO ] [e.d.ThreadPoolAndExceptionController:47  ] - I'm done : 8\n[15:44:33.771] [test0] [INFO ] [e.d.ThreadPoolAndExceptionController:47  ] - I'm done : 9\n[15:44:33.771] [test0] [INFO ] [e.d.ThreadPoolAndExceptionController:47  ] - I'm done : 10\n</code></pre><p>ä¸ºä»€ä¹ˆä¼šè¿™æ ·å‘¢ï¼Ÿ</p><p>æŸ¥çœ‹FutureTaskæºç å¯ä»¥å‘ç°ï¼Œåœ¨æ‰§è¡Œä»»åŠ¡å‡ºç°å¼‚å¸¸ä¹‹åï¼Œå¼‚å¸¸å­˜åˆ°äº†ä¸€ä¸ªoutcomeå­—æ®µä¸­ï¼Œåªæœ‰åœ¨è°ƒç”¨getæ–¹æ³•è·å–FutureTaskç»“æœçš„æ—¶å€™ï¼Œæ‰ä¼šä»¥ExecutionExceptionçš„å½¢å¼é‡æ–°æŠ›å‡ºå¼‚å¸¸ï¼š</p><pre><code>public void run() {\n...\n    try {\n        Callable&lt;V&gt; c = callable;\n        if (c != null &amp;&amp; state == NEW) {\n            V result;\n            boolean ran;\n            try {\n                result = c.call();\n                ran = true;\n            } catch (Throwable ex) {\n                result = null;\n                ran = false;\n                setException(ex);\n            }\n...\n}\n\nprotected void setException(Throwable t) {\n    if (UNSAFE.compareAndSwapInt(this, stateOffset, NEW, COMPLETING)) {\n        outcome = t;\n        UNSAFE.putOrderedInt(this, stateOffset, EXCEPTIONAL); // final state\n        finishCompletion();\n    }\n}\n\npublic V get() throws InterruptedException, ExecutionException {\n    int s = state;\n    if (s &lt;= COMPLETING)\n        s = awaitDone(false, 0L);\n    return report(s);\n}\n\nprivate V report(int s) throws ExecutionException {\n    Object x = outcome;\n    if (s == NORMAL)\n        return (V)x;\n    if (s &gt;= CANCELLED)\n        throw new CancellationException();\n    throw new ExecutionException((Throwable)x);\n}\n</code></pre><p>ä¿®æ”¹åçš„ä»£ç å¦‚ä¸‹æ‰€ç¤ºï¼Œæˆ‘ä»¬æŠŠsubmitè¿”å›çš„Futureæ”¾åˆ°äº†Listä¸­ï¼Œéšåéå†Listæ¥æ•è·æ‰€æœ‰ä»»åŠ¡çš„å¼‚å¸¸ã€‚è¿™ä¹ˆåšç¡®å®åˆä¹æƒ…ç†ã€‚æ—¢ç„¶æ˜¯ä»¥submitæ–¹å¼æ¥æäº¤ä»»åŠ¡ï¼Œé‚£ä¹ˆæˆ‘ä»¬åº”è¯¥å…³å¿ƒä»»åŠ¡çš„æ‰§è¡Œç»“æœï¼Œå¦åˆ™åº”è¯¥ä»¥executeæ¥æäº¤ä»»åŠ¡ï¼š</p><pre><code>List&lt;Future&gt; tasks = IntStream.rangeClosed(1, 10).mapToObj(i -&gt; threadPool.submit(() -&gt; {\n    if (i == 5) throw new RuntimeException(&quot;error&quot;);\n    log.info(&quot;I'm done : {}&quot;, i);\n})).collect(Collectors.toList());\n\ntasks.forEach(task-&gt; {\n    try {\n        task.get();\n    } catch (Exception e) {\n        log.error(&quot;Got exception&quot;, e);\n    }\n});\n</code></pre><p>æ‰§è¡Œè¿™æ®µç¨‹åºå¯ä»¥çœ‹åˆ°å¦‚ä¸‹çš„æ—¥å¿—è¾“å‡ºï¼š</p><pre><code>[15:44:13.543] [http-nio-45678-exec-1] [ERROR] [e.d.ThreadPoolAndExceptionController:69  ] - Got exception\njava.util.concurrent.ExecutionException: java.lang.RuntimeException: error\n</code></pre><h2>é‡ç‚¹å›é¡¾</h2><p>åœ¨ä»Šå¤©çš„æ–‡ç« ä¸­ï¼Œæˆ‘ä»‹ç»äº†å¤„ç†å¼‚å¸¸å®¹æ˜“çŠ¯çš„å‡ ä¸ªé”™å’Œæœ€ä½³å®è·µã€‚</p><p>ç¬¬ä¸€ï¼Œæ³¨æ„æ•è·å’Œå¤„ç†å¼‚å¸¸çš„æœ€ä½³å®è·µã€‚é¦–å…ˆï¼Œä¸åº”è¯¥ç”¨AOPå¯¹æ‰€æœ‰æ–¹æ³•è¿›è¡Œç»Ÿä¸€å¼‚å¸¸å¤„ç†ï¼Œå¼‚å¸¸è¦ä¹ˆä¸æ•è·ä¸å¤„ç†ï¼Œè¦ä¹ˆæ ¹æ®ä¸åŒçš„ä¸šåŠ¡é€»è¾‘ã€ä¸åŒçš„å¼‚å¸¸ç±»å‹è¿›è¡Œç²¾ç»†åŒ–ã€é’ˆå¯¹æ€§å¤„ç†ï¼›å…¶æ¬¡ï¼Œå¤„ç†å¼‚å¸¸åº”è¯¥æœç»ç”Ÿåï¼Œå¹¶ç¡®ä¿å¼‚å¸¸æ ˆä¿¡æ¯å¾—åˆ°ä¿ç•™ï¼›æœ€åï¼Œå¦‚æœéœ€è¦é‡æ–°æŠ›å‡ºå¼‚å¸¸çš„è¯ï¼Œè¯·ä½¿ç”¨å…·æœ‰æ„ä¹‰çš„å¼‚å¸¸ç±»å‹å’Œå¼‚å¸¸æ¶ˆæ¯ã€‚</p><p>ç¬¬äºŒï¼ŒåŠ¡å¿…å°å¿ƒfinallyä»£ç å—ä¸­èµ„æºå›æ”¶é€»è¾‘ï¼Œç¡®ä¿finallyä»£ç å—ä¸å‡ºç°å¼‚å¸¸ï¼Œå†…éƒ¨æŠŠå¼‚å¸¸å¤„ç†å®Œæ¯•ï¼Œé¿å…finallyä¸­çš„å¼‚å¸¸è¦†ç›–tryä¸­çš„å¼‚å¸¸ï¼›æˆ–è€…è€ƒè™‘ä½¿ç”¨addSuppressedæ–¹æ³•æŠŠfinallyä¸­çš„å¼‚å¸¸é™„åŠ åˆ°tryä¸­çš„å¼‚å¸¸ä¸Šï¼Œç¡®ä¿ä¸»å¼‚å¸¸ä¿¡æ¯ä¸ä¸¢å¤±ã€‚æ­¤å¤–ï¼Œä½¿ç”¨å®ç°äº†AutoCloseableæ¥å£çš„èµ„æºï¼ŒåŠ¡å¿…ä½¿ç”¨try-with-resourcesæ¨¡å¼æ¥ä½¿ç”¨èµ„æºï¼Œç¡®ä¿èµ„æºå¯ä»¥æ­£ç¡®é‡Šæ”¾ï¼Œä¹ŸåŒæ—¶ç¡®ä¿å¼‚å¸¸å¯ä»¥æ­£ç¡®å¤„ç†ã€‚</p><p>ç¬¬ä¸‰ï¼Œè™½ç„¶åœ¨ç»Ÿä¸€çš„åœ°æ–¹å®šä¹‰æ”¶å£æ‰€æœ‰çš„ä¸šåŠ¡å¼‚å¸¸æ˜¯ä¸€ä¸ªä¸é”™çš„å®è·µï¼Œä½†åŠ¡å¿…ç¡®ä¿å¼‚å¸¸æ˜¯æ¯æ¬¡newå‡ºæ¥çš„ï¼Œè€Œä¸èƒ½ä½¿ç”¨ä¸€ä¸ªé¢„å…ˆå®šä¹‰çš„staticå­—æ®µå­˜æ”¾å¼‚å¸¸ï¼Œå¦åˆ™å¯èƒ½ä¼šå¼•èµ·æ ˆä¿¡æ¯çš„é”™ä¹±ã€‚</p><p>ç¬¬å››ï¼Œç¡®ä¿æ­£ç¡®å¤„ç†äº†çº¿ç¨‹æ± ä¸­ä»»åŠ¡çš„å¼‚å¸¸ï¼Œå¦‚æœä»»åŠ¡é€šè¿‡executeæäº¤ï¼Œé‚£ä¹ˆå‡ºç°å¼‚å¸¸ä¼šå¯¼è‡´çº¿ç¨‹é€€å‡ºï¼Œå¤§é‡çš„å¼‚å¸¸ä¼šå¯¼è‡´çº¿ç¨‹é‡å¤åˆ›å»ºå¼•èµ·æ€§èƒ½é—®é¢˜ï¼Œæˆ‘ä»¬åº”è¯¥å°½å¯èƒ½ç¡®ä¿ä»»åŠ¡ä¸å‡ºå¼‚å¸¸ï¼ŒåŒæ—¶è®¾ç½®é»˜è®¤çš„æœªæ•è·å¼‚å¸¸å¤„ç†ç¨‹åºæ¥å…œåº•ï¼›å¦‚æœä»»åŠ¡é€šè¿‡submitæäº¤æ„å‘³ç€æˆ‘ä»¬å…³å¿ƒä»»åŠ¡çš„æ‰§è¡Œç»“æœï¼Œåº”è¯¥é€šè¿‡æ‹¿åˆ°çš„Futureè°ƒç”¨å…¶getæ–¹æ³•æ¥è·å¾—ä»»åŠ¡è¿è¡Œç»“æœå’Œå¯èƒ½å‡ºç°çš„å¼‚å¸¸ï¼Œå¦åˆ™å¼‚å¸¸å¯èƒ½å°±è¢«ç”Ÿåäº†ã€‚</p><p>ä»Šå¤©ç”¨åˆ°çš„ä»£ç ï¼Œæˆ‘éƒ½æ”¾åœ¨äº†GitHubä¸Šï¼Œä½ å¯ä»¥ç‚¹å‡»<a href=\"https://github.com/JosephZhu1983/java-common-mistakes\">è¿™ä¸ªé“¾æ¥</a>æŸ¥çœ‹ã€‚</p><h2>æ€è€ƒä¸è®¨è®º</h2><ol>\n<li>å…³äºåœ¨finallyä»£ç å—ä¸­æŠ›å‡ºå¼‚å¸¸çš„å‘ï¼Œå¦‚æœåœ¨finallyä»£ç å—ä¸­è¿”å›å€¼ï¼Œä½ è§‰å¾—ç¨‹åºä¼šä»¥tryæˆ–catchä¸­è¿”å›å€¼ä¸ºå‡†ï¼Œè¿˜æ˜¯ä»¥finallyä¸­çš„è¿”å›å€¼ä¸ºå‡†å‘¢ï¼Ÿ</li>\n<li>å¯¹äºæ‰‹åŠ¨æŠ›å‡ºçš„å¼‚å¸¸ï¼Œä¸å»ºè®®ç›´æ¥ä½¿ç”¨Exceptionæˆ–RuntimeExceptionï¼Œé€šå¸¸å»ºè®®å¤ç”¨JDKä¸­çš„ä¸€äº›æ ‡å‡†å¼‚å¸¸ï¼Œæ¯”å¦‚<a href=\"https://docs.oracle.com/javase/8/docs/api/java/lang/IllegalArgumentException.html\">IllegalArgumentException</a>ã€<a href=\"https://docs.oracle.com/javase/8/docs/api/java/lang/IllegalStateException.html\">IllegalStateException</a>ã€<a href=\"https://docs.oracle.com/javase/8/docs/api/java/lang/UnsupportedOperationException.html\">UnsupportedOperationException</a>ï¼Œä½ èƒ½è¯´è¯´å®ƒä»¬çš„é€‚ç”¨åœºæ™¯ï¼Œå¹¶åˆ—å‡ºæ›´å¤šå¸¸ç”¨å¼‚å¸¸å—ï¼Ÿ</li>\n</ol><p>ä¸çŸ¥é“é’ˆå¯¹å¼‚å¸¸å¤„ç†ï¼Œä½ è¿˜é‡åˆ°è¿‡ä»€ä¹ˆå‘ï¼Œè¿˜æœ‰ä»€ä¹ˆæœ€ä½³å®è·µçš„å¿ƒå¾—å—ï¼Ÿæˆ‘æ˜¯æœ±æ™”ï¼Œæ¬¢è¿åœ¨è¯„è®ºåŒºä¸æˆ‘ç•™è¨€åˆ†äº«ï¼Œä¹Ÿæ¬¢è¿ä½ æŠŠè¿™ç¯‡æ–‡ç« åˆ†äº«ç»™ä½ çš„æœ‹å‹æˆ–åŒäº‹ï¼Œä¸€èµ·äº¤æµã€‚</p>","comments":[{"had_liked":false,"id":202995,"user_name":"Darren","can_delete":false,"product_type":"c1","uid":1254968,"ip_address":"","ucode":"CCD2B2C492BE9A","user_header":"https://static001.geekbang.org/account/avatar/00/13/26/38/ef063dc2.jpg","comment_is_top":false,"comment_ctime":1586099401,"is_pvip":true,"replies":[{"id":"75895","content":"ğŸ‘ğŸ»ï¼Œä½ æ€»ç»“äº†æ¯”è¾ƒé‡è¦çš„ä¸¤ç‚¹ï¼ŒJVMé‡‡ç”¨å¼‚å¸¸è¡¨æ§åˆ¶try-catchçš„è·³è½¬é€»è¾‘ï¼›å¯¹äºfinallyä¸­çš„ä»£ç å—å…¶å®æ˜¯å¤åˆ¶åˆ°tryå’Œcatchä¸­çš„returnå’Œthrowä¹‹å‰çš„æ–¹å¼æ¥å¤„ç†çš„ã€‚","user_name":"ä½œè€…å›å¤","user_name_real":"æœ±æ™”","uid":"1001470","ctime":1586136360,"ip_address":"","comment_id":202995,"utype":1}],"discussion_count":16,"race_medal":0,"score":"388133156041","product_id":100047701,"comment_content":"è¿™ç¯‡æ–‡ç« æ”¶è·å¾ˆå¤§ï¼Œå› ä¸ºæˆ‘ä»¬ç°åœ¨çš„ç³»ç»Ÿå°±æ˜¯ç”¨çš„ç»Ÿä¸€å¼‚å¸¸å¤„ç†ï¼Œä½¿ç”¨çš„å°±æ˜¯è€å¸ˆæåˆ°çš„å…œåº•å¼‚å¸¸ï¼Œå°±æ˜¯ç®€å•çš„åˆ†ä¸ºä¸šåŠ¡å¼‚å¸¸å’Œéä¸šåŠ¡å¼‚å¸¸ï¼Œæç¤ºè¯­ä¸åŒè€Œå·²ã€‚<br>è¯•ç€å›ç­”ä¸‹é—®é¢˜ï¼š<br>ç¬¬ä¸€ä¸ªé—®é¢˜ï¼š<br>è‚¯å®šæ˜¯ä»¥finallyè¯­å¥å—ä¸ºå‡†ã€‚<br>åŸå› ï¼šé¦–å…ˆéœ€è¦æ˜ç™½çš„æ˜¯åœ¨ç¼–è¯‘ç”Ÿæˆçš„å­—èŠ‚ç ä¸­ï¼Œæ¯ä¸ªæ–¹æ³•éƒ½é™„å¸¦ä¸€ä¸ªå¼‚å¸¸è¡¨ã€‚å¼‚å¸¸è¡¨ä¸­çš„æ¯ä¸€ä¸ªæ¡ç›®ä»£è¡¨ä¸€ä¸ªå¼‚å¸¸å¤„ç†å™¨ï¼Œå¹¶ä¸”ç”± from æŒ‡é’ˆã€to æŒ‡é’ˆã€target æŒ‡é’ˆä»¥åŠæ‰€æ•è·çš„å¼‚å¸¸ç±»å‹æ„æˆã€‚è¿™äº›æŒ‡é’ˆçš„å€¼æ˜¯å­—èŠ‚ç ç´¢å¼•ï¼ˆbytecode indexï¼Œbciï¼‰ï¼Œç”¨ä»¥å®šä½å­—èŠ‚ç ã€‚å…¶ä¸­ï¼Œfrom æŒ‡é’ˆå’Œ to æŒ‡é’ˆæ ‡ç¤ºäº†è¯¥å¼‚å¸¸å¤„ç†å™¨æ‰€ç›‘æ§çš„èŒƒå›´ï¼Œä¾‹å¦‚ try ä»£ç å—æ‰€è¦†ç›–çš„èŒƒå›´ã€‚target æŒ‡é’ˆåˆ™æŒ‡å‘å¼‚å¸¸å¤„ç†å™¨çš„èµ·å§‹ä½ç½®ï¼Œä¾‹å¦‚ catch ä»£ç å—çš„èµ·å§‹ä½ç½®ï¼›<br>å½“ç¨‹åºè§¦å‘å¼‚å¸¸æ—¶ï¼ŒJava è™šæ‹Ÿæœºä¼šä»ä¸Šè‡³ä¸‹éå†å¼‚å¸¸è¡¨ä¸­çš„æ‰€æœ‰æ¡ç›®ã€‚å½“è§¦å‘å¼‚å¸¸çš„å­—èŠ‚ç çš„ç´¢å¼•å€¼åœ¨æŸä¸ªå¼‚å¸¸è¡¨æ¡ç›®çš„ç›‘æ§èŒƒå›´å†…ï¼ŒJava è™šæ‹Ÿæœºä¼šåˆ¤æ–­æ‰€æŠ›å‡ºçš„å¼‚å¸¸å’Œè¯¥æ¡ç›®æƒ³è¦æ•è·çš„å¼‚å¸¸æ˜¯å¦åŒ¹é…ã€‚å¦‚æœåŒ¹é…ï¼ŒJava è™šæ‹Ÿæœºä¼šå°†æ§åˆ¶æµè½¬ç§»è‡³è¯¥æ¡ç›® target æŒ‡é’ˆæŒ‡å‘çš„å­—èŠ‚ç ã€‚å¦‚æœéå†å®Œæ‰€æœ‰å¼‚å¸¸è¡¨æ¡ç›®ï¼ŒJava è™šæ‹Ÿæœºä»æœªåŒ¹é…åˆ°å¼‚å¸¸å¤„ç†å™¨ï¼Œé‚£ä¹ˆå®ƒä¼šå¼¹å‡ºå½“å‰æ–¹æ³•å¯¹åº”çš„ Java æ ˆå¸§ï¼Œå¹¶ä¸”åœ¨è°ƒç”¨è€…ï¼ˆcallerï¼‰ä¸­é‡å¤ä¸Šè¿°æ“ä½œã€‚åœ¨æœ€åæƒ…å†µä¸‹ï¼ŒJava è™šæ‹Ÿæœºéœ€è¦éå†å½“å‰çº¿ç¨‹ Java æ ˆä¸Šæ‰€æœ‰æ–¹æ³•çš„å¼‚å¸¸è¡¨ã€‚æ‰€ä»¥å¼‚å¸¸æ“ä½œæ˜¯ä¸€ä¸ªéå¸¸è€—è´¹æ€§èƒ½çš„æ“ä½œï¼›<br>finally ä»£ç å—çš„åŸç†æ˜¯å¤åˆ¶ finally ä»£ç å—çš„å†…å®¹ï¼Œåˆ†åˆ«æ”¾åœ¨ try-catch ä»£ç å—æ‰€æœ‰æ­£å¸¸æ‰§è¡Œè·¯å¾„ä»¥åŠå¼‚å¸¸æ‰§è¡Œè·¯å¾„çš„å‡ºå£ä¸­ã€‚æ‰€ä»¥ä¸ç®¡æ˜¯æ˜¯æ­£å¸¸è¿˜æ˜¯å¼‚å¸¸æ‰§è¡Œï¼Œfinallyéƒ½æ˜¯æœ€åæ‰§è¡Œçš„ï¼Œæ‰€ä»¥è‚¯å®šæ˜¯finallyè¯­å¥å—ä¸­ä¸ºå‡†ã€‚<br><br>ç¬¬äºŒä¸ªé—®é¢˜ï¼š<br>IllegalArgumentExceptionï¼šä¸åˆæ³•çš„å‚æ•°å¼‚å¸¸ï¼Œæ¯”å¦‚è¯´é™åˆ¶ä¸èƒ½ä¸ºç©ºæˆ–è€…æœ‰æŒ‡å®šçš„å‘å°èŒƒå›´ï¼Œè°ƒç”¨æ–¹æ²¡æœ‰æŒ‰ç…§è§„å®šä¼ é€’å‚æ•°ï¼Œå°±å¯ä»¥æŠ›å‡ºè¿™ä¸ªå¼‚å¸¸ï¼›<br>IllegalStateExceptionï¼šå¦‚æœæœ‰çŠ¶æ€æµè½¬çš„æ¦‚å¿µåœ¨é‡Œé¢ï¼ˆæ¯”å¦‚çŠ¶æ€æœºï¼‰ï¼ŒçŠ¶æ€åªèƒ½ä»A-&gt;B-&gt;C,è‹¥çŠ¶æ€ç›´æ¥ä»A-&gt;C,å°±å¯ä»¥æŠ›å‡ºè¯¥å¼‚å¸¸ï¼›<br>UnsupportedOperationExceptionï¼šä¸æ”¯æŒè¯¥æ“ä½œå¼‚å¸¸ï¼Œæ¯”å¦‚éæŠ½è±¡çˆ¶ç±»ä¸­æœ‰ä¸ªæ–¹æ³•ï¼Œå­ç±»å¿…é¡»å®ç°ï¼Œçˆ¶ç±»ä¸­çš„æ–¹æ³•å°±å¯ä»¥æŠ›å‡ºæ¬¡å¼‚å¸¸ã€‚è€å¸ˆåœ¨é›†åˆå‘ä¸­æåˆ°çš„Arrays.asList è¿”å›çš„ List å¹¶ä¸æ˜¯æˆ‘ä»¬æœŸæœ›çš„ java.util.ArrayListï¼Œè€Œæ˜¯ Arrays çš„å†…éƒ¨ç±» ArrayListã€‚ArrayList å†…éƒ¨ç±»ç»§æ‰¿è‡ª AbstractList ç±»ï¼Œå¹¶æ²¡æœ‰è¦†å†™çˆ¶ç±»çš„ add æ–¹æ³•ï¼Œè€Œçˆ¶ç±»ä¸­ add æ–¹æ³•çš„å®ç°ï¼Œå°±æ˜¯æŠ›å‡º UnsupportedOperationExceptionã€‚<br>","like_count":91,"discussions":[{"author":{"id":1001470,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/47/fe/d0e25d57.jpg","nickname":"æœ±æ™”","note":"","ucode":"0B7F0BADE6AAB8","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":490725,"discussion_content":"ğŸ‘ğŸ»ï¼Œä½ æ€»ç»“äº†æ¯”è¾ƒé‡è¦çš„ä¸¤ç‚¹ï¼ŒJVMé‡‡ç”¨å¼‚å¸¸è¡¨æ§åˆ¶try-catchçš„è·³è½¬é€»è¾‘ï¼›å¯¹äºfinallyä¸­çš„ä»£ç å—å…¶å®æ˜¯å¤åˆ¶åˆ°tryå’Œcatchä¸­çš„returnå’Œthrowä¹‹å‰çš„æ–¹å¼æ¥å¤„ç†çš„ã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1586136360,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1188891,"avatar":"https://static001.geekbang.org/account/avatar/00/12/24/1b/7aa4d93d.jpg","nickname":"ç›’å­","note":"","ucode":"2A95F1121109B1","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":245690,"discussion_content":"å¯¹äºfinallyä¸­çš„ä»£ç å—å…¶å®æ˜¯å¤åˆ¶åˆ°tryå’Œcatchä¸­çš„returnå’Œthrowä¹‹å‰çš„æ–¹å¼æ¥å¤„ç†çš„ã€‚å¯¹äºè¿™å¥è¯å¯èƒ½è¿˜ä¸å¤Ÿå‡†ç¡®ï¼›ä¸‹é¢çœ‹ä¸¤ä¸ªç¤ºä¾‹ï¼š\n\npublic static int t1 () {\n        int i = 1;\n        try {\n            return i;\n        }finally {\n            ++i;\n        }\n    }\n\npublic static int t2 () {\n        int i = 1;\n        try {\n            return i;\n        }finally {\n            return ++i;\n        }\n    }\n\nt1 æ–¹æ³•è¿”å›çš„æ˜¯ 1ï¼Œ t2 æ–¹æ³•è¿”å›çš„æ˜¯ 2ï¼› åŸå› æ˜¯åœ¨è¿›å…¥ finally ä»£ç å—å‰ï¼Œä¼šè®°å½•è¿”å›ç»“æœï¼Œfinally å¯¹è¿”å›ç»“æœçš„æ“ä½œä¸å½±å“æ­¤å‰è®°å½•çš„å€¼ï¼›ä½†æ˜¯å¦‚æœ åœ¨ finally ä¸­return å°±ä¼šè¦†ç›–æ­¤å‰ä¿å­˜çš„è¿”å›å€¼ï¼›","likes_number":7,"is_delete":false,"is_hidden":false,"ctime":1587691945,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":5,"child_discussions":[{"author":{"id":1254968,"avatar":"https://static001.geekbang.org/account/avatar/00/13/26/38/ef063dc2.jpg","nickname":"Darren","note":"","ucode":"CCD2B2C492BE9A","race_medal":0,"user_type":1,"is_pvip":true},"reply_author":{"id":1188891,"avatar":"https://static001.geekbang.org/account/avatar/00/12/24/1b/7aa4d93d.jpg","nickname":"ç›’å­","note":"","ucode":"2A95F1121109B1","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":249823,"discussion_content":"public static void main(String[] args) {\n\n        System.out.println(t1());\n\n    }\n    public static User t1 () {\n        User user = new User();\n        user.setAge(12);\n        try {\n            return user;\n        }finally {\n            user.setName(&#34;zhangsan&#34;);\n        }\n    }\n\n\nè¾“å‡ºï¼šUser{age=12, name=&#39;zhangsan&#39;}\n\næ˜ç™½äº†å—ï¼Ÿ  intæ˜¯åŸºæœ¬æ•°æ®ç±»å‹ï¼Œæ˜¯å€¼ä¼ é€’ï¼Œä½ çš„t1ä¸­ï¼Œiæœ€åæ˜¯2ï¼Œä½†æ˜¯1å·²ç»è¢«è¿”å›å›å»äº†ï¼Œå¹¶ä¸”æ˜¯å€¼è¿”å›å¹¶ä¸æ˜¯å¼•ç”¨ï¼Œå› æ­¤ä½ çš„t1æ–¹æ³•æµ‹è¯•æœ¬èº«æ˜¯æœ‰é—®é¢˜çš„ã€‚","likes_number":8,"is_delete":false,"is_hidden":false,"ctime":1587965381,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":245690,"ip_address":""},"score":249823,"extra":""},{"author":{"id":1188891,"avatar":"https://static001.geekbang.org/account/avatar/00/12/24/1b/7aa4d93d.jpg","nickname":"ç›’å­","note":"","ucode":"2A95F1121109B1","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":1254968,"avatar":"https://static001.geekbang.org/account/avatar/00/13/26/38/ef063dc2.jpg","nickname":"Darren","note":"","ucode":"CCD2B2C492BE9A","race_medal":0,"user_type":1,"is_pvip":true},"discussion":{"id":250168,"discussion_content":"æ„Ÿè°¢è§£ç­”ï¼Œæˆ‘ç†è§£ä½ çš„æ„æ€ï¼›å…¶å®æˆ‘æƒ³æŒ‡å‡ºï¼Œè¿›å…¥ finally ä¹‹å‰çš„return çš„å¯¹è±¡æ˜¯ç¼“å­˜å¥½çš„ï¼› ä¾‹å¦‚ä¸‹é¢ä¾‹å­è¿”å›çš„è¿˜æ˜¯\n\nUser{name=&#39;z3&#39;, age=12}\n\npublic static User t1 () {\n        User user = new User(&#34;z3&#34;,12);\n        try {\n            return user;\n        } finally {\n            user = new User(&#34;l4&#34;, 13);\n        }\n    }","likes_number":3,"is_delete":false,"is_hidden":false,"ctime":1587995478,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":249823,"ip_address":""},"score":250168,"extra":""},{"author":{"id":1254968,"avatar":"https://static001.geekbang.org/account/avatar/00/13/26/38/ef063dc2.jpg","nickname":"Darren","note":"","ucode":"CCD2B2C492BE9A","race_medal":0,"user_type":1,"is_pvip":true},"reply_author":{"id":1188891,"avatar":"https://static001.geekbang.org/account/avatar/00/12/24/1b/7aa4d93d.jpg","nickname":"ç›’å­","note":"","ucode":"2A95F1121109B1","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":250422,"discussion_content":"æ˜¯çš„ï¼Œä½ è¿™ç§å†™æ³•ï¼Œå¼€å‘å·¥å…·ä¼šæé†’æ— æ•ˆè¯­å¥çš„ï¼Œæˆ‘è¯´ä¸‹æˆ‘çš„ç†è§£ï¼Œä¸ºå•¥è¿™å—ä¼šä¸ç”Ÿæ•ˆï¼Œuserå˜é‡æœ¬èº«å…¶å®æ˜¯ä¸€ä¸ªåœ°å€ï¼Œä¹Ÿå°±æ˜¯cè¯­éŸ³çš„æŒ‡é’ˆï¼Œæœ¬è´¨ä¸Šå°±æ˜¯å†…å­˜åœ°å€ï¼Œä¹Ÿå°±æ˜¯ä¸€ä¸ªæ•°å­—ï¼Œåœ¨returnçš„æ—¶å€™ï¼Œuserçš„åœ°å€è¢«è¿”å›ï¼Œè¢«è°ƒç”¨è€…æ¥å—ï¼Œè°ƒç”¨è€…æ­¤æ—¶å°±æ˜¯è¿™ä¸ªæŒ‡é’ˆï¼Œåœ¨finallyä¸­ï¼Œä½ åœ¨ç»™userèµ‹å€¼ï¼Œæ­¤æ—¶useræŒ‡å‘çš„åœ°å€ä¹Ÿè¿”å›çš„é‚£ä¸ªå·²ç»å®Œå…¨ä¸ä¸€æ ·äº†ï¼Œæ²¡æœ‰å…³ç³»äº†ï¼Œè¿™å°±æ˜¯finallyè¯­å¥çœ‹èµ·æ¥åº”è¯¥ç”Ÿæ•ˆä½†æ²¡ç”Ÿæ•ˆçš„åŸå› ã€‚","likes_number":6,"is_delete":false,"is_hidden":false,"ctime":1588001830,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":250168,"ip_address":""},"score":250422,"extra":""}]},{"author":{"id":2002306,"avatar":"http://thirdwx.qlogo.cn/mmopen/vi_32/DYAIOgq83erx6pib1rW5tReUYQzQmNJjjmecb7iasr9gf34IB45tXc5f2qksoqVhUkQHr08icTyBduiaVjy1sI7wKQ/132","nickname":"èœåˆ€","note":"","ucode":"AABE26A96C2729","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":291817,"discussion_content":"è¿™ä¸æ˜¯æ·±å…¥ç†è§£Javaè™šæ‹Ÿæœºä¸­çš„å†…å®¹å—ğŸ˜„","likes_number":1,"is_delete":false,"is_hidden":false,"ctime":1594962029,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1055054,"avatar":"https://static001.geekbang.org/account/avatar/00/10/19/4e/d411cfab.jpg","nickname":"ä¸€ä¼š","note":"","ucode":"4B1F0508ABFBCB","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":223955,"discussion_content":"å§æ§½ ç‰›é€¼  åŸè°…æœ¬äººæ²¡æ–‡åŒ– ","likes_number":1,"is_delete":false,"is_hidden":false,"ctime":1586263931,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":1,"child_discussions":[{"author":{"id":1254968,"avatar":"https://static001.geekbang.org/account/avatar/00/13/26/38/ef063dc2.jpg","nickname":"Darren","note":"","ucode":"CCD2B2C492BE9A","race_medal":0,"user_type":1,"is_pvip":true},"reply_author":{"id":1055054,"avatar":"https://static001.geekbang.org/account/avatar/00/10/19/4e/d411cfab.jpg","nickname":"ä¸€ä¼š","note":"","ucode":"4B1F0508ABFBCB","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":224536,"discussion_content":"å¤šåœ¨æå®¢æ—¶é—´å‘†ä¸€å‘†ï¼Œå°±æœ‰æ–‡åŒ–äº†ğŸ˜‚","likes_number":3,"is_delete":false,"is_hidden":false,"ctime":1586313936,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":223955,"ip_address":""},"score":224536,"extra":""}]},{"author":{"id":1194238,"avatar":"https://static001.geekbang.org/account/avatar/00/12/38/fe/988bf0d9.jpg","nickname":"ç©ºç©ºå¦‚ä¹Ÿ","note":"","ucode":"342F3A2C8A3C11","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":222623,"discussion_content":"ææ€–å¦‚æ–¯ å¼º","likes_number":1,"is_delete":false,"is_hidden":false,"ctime":1586164117,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":1,"child_discussions":[{"author":{"id":1254968,"avatar":"https://static001.geekbang.org/account/avatar/00/13/26/38/ef063dc2.jpg","nickname":"Darren","note":"","ucode":"CCD2B2C492BE9A","race_medal":0,"user_type":1,"is_pvip":true},"reply_author":{"id":1194238,"avatar":"https://static001.geekbang.org/account/avatar/00/12/38/fe/988bf0d9.jpg","nickname":"ç©ºç©ºå¦‚ä¹Ÿ","note":"","ucode":"342F3A2C8A3C11","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":222653,"discussion_content":"æ˜¯æ–—ç ´è‹ç©¹è§ç‚å—ğŸ˜‚ğŸ˜‚ğŸ˜‚","likes_number":3,"is_delete":false,"is_hidden":false,"ctime":1586166389,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":222623,"ip_address":""},"score":222653,"extra":""}]},{"author":{"id":1528941,"avatar":"https://wx.qlogo.cn/mmopen/vi_32/BCIyymNXUd0gicELBmOnzJptrXZM9Fo95w8nhzvyuibC8icCsrmSBAZBicfrRgLL71ZiaCWnxxaDtJ2hp3b3nWEsRUA/132","nickname":"Geek_6e3c24","note":"","ucode":"076F5E2C271BF2","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":392610,"discussion_content":"ç™¾åº¦äº†ä¸€å †è¯  è´´å‡ºæ¥","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1631070354,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1336475,"avatar":"https://static001.geekbang.org/account/avatar/00/14/64/9b/0b578b08.jpg","nickname":"J.Smile","note":"","ucode":"C4D98DFDBF7584","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":270612,"discussion_content":"é«˜æ‰‹","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1590029687,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1052859,"avatar":"https://static001.geekbang.org/account/avatar/00/10/10/bb/f1061601.jpg","nickname":"Demon.Lee","note":"","ucode":"7F0E5493A8E345","race_medal":1,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":227883,"discussion_content":"ğŸ‘ğŸ‘ğŸ‘ğŸ‘","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1586517360,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1211223,"avatar":"https://static001.geekbang.org/account/avatar/00/12/7b/57/a9b04544.jpg","nickname":"QQæ€ª","note":"","ucode":"1A39B8433D9208","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":226018,"discussion_content":"ç‰›çš®ï¼Œç‰›çš®","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1586415705,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":233750,"user_name":"æ‰ç´§ç»·å¸¦","can_delete":false,"product_type":"c1","uid":1316667,"ip_address":"","ucode":"4EDB38E21C12BB","user_header":"https://static001.geekbang.org/account/avatar/00/14/17/3b/37bcd31e.jpg","comment_is_top":false,"comment_ctime":1594436423,"is_pvip":false,"replies":[{"id":"86321","content":"è¿™æ˜¯ä¸€ä¸ªå¾ˆå¸¸è§çš„éœ€æ±‚ï¼Œä½¿ç”¨HttpServletRequestWrapperå³å¯ï¼Œå‚è€ƒ https:&#47;&#47;github.com&#47;JosephZhu1983&#47;appinfocenter&#47;blob&#47;master&#47;client&#47;src&#47;main&#47;java&#47;me&#47;josephzhu&#47;appinfocenter&#47;client&#47;DumpFilter.java","user_name":"ä½œè€…å›å¤","user_name_real":"æœ±æ™”","uid":"1001470","ctime":1594520884,"ip_address":"","comment_id":233750,"utype":1}],"discussion_count":1,"race_medal":0,"score":"87493782343","product_id":100047701,"comment_content":"è€å¸ˆï¼Œä¸ºäº†ä¾¿äºå®šä½å¼‚å¸¸è¯·æ±‚bugï¼Œæˆ‘å¸Œæœ›urlè¯·æ±‚åç«¯å‡ºç°å¼‚å¸¸åï¼Œæ¡†æ¶æ‹¦æˆªæ‰“å°å‡ºè¯·æ±‚çš„å‚æ•°ä¿¡æ¯ï¼Œå› ä¸ºbodyé‡Œçš„å‚æ•°åœ¨æµä¸­ï¼Œåªèƒ½æ¶ˆè´¹ä¸€æ¬¡ï¼Œæƒ³è¦åœ¨å‡ºé”™åæ‰“å°ï¼Œå¿…é¡»è¦æå‰å¤åˆ¶å‡ºä¸€ä»½ä¿å­˜ã€‚è€å¸ˆæœ‰ä»€ä¹ˆå¥½çš„å®è·µå—ï¼Ÿ","like_count":21,"discussions":[{"author":{"id":1001470,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/47/fe/d0e25d57.jpg","nickname":"æœ±æ™”","note":"","ucode":"0B7F0BADE6AAB8","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":501153,"discussion_content":"è¿™æ˜¯ä¸€ä¸ªå¾ˆå¸¸è§çš„éœ€æ±‚ï¼Œä½¿ç”¨HttpServletRequestWrapperå³å¯ï¼Œå‚è€ƒ https://github.com/JosephZhu1983/appinfocenter/blob/master/client/src/main/java/me/josephzhu/appinfocenter/client/DumpFilter.java","likes_number":1,"is_delete":false,"is_hidden":false,"ctime":1594520884,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":203298,"user_name":"æ¢¦å€šæ æ†","can_delete":false,"product_type":"c1","uid":1095857,"ip_address":"","ucode":"BDEB97F2822445","user_header":"http://thirdwx.qlogo.cn/mmopen/vi_32/bvj76PmeUvW8kokyu91IZWuRATKmabibDWbzAj2TajeEic7WvKCJOLaOh6jibEmdQ36EO3sBUZ0HibAiapsrZo64U8w/132","comment_is_top":false,"comment_ctime":1586168045,"is_pvip":false,"replies":[{"id":"75963","content":"å—¯ï¼ŒåŸå› æ˜¯ï¼š<br>1ã€idæ˜¯æ•°å­—å‹ï¼Œä¼ å…¥çš„1,2,3,4,5,6,7,8,9çš„å¹¶ä¸èƒ½è½¬æ¢ä¸ºæ•°å­—ï¼Œæ‰€ä»¥æˆªæ–­ä¸º1ï¼ˆç¬¬ä¸€ä¸ªé€—å·ä¹‹å‰çš„æ•°å­—ï¼‰<br>2ã€zhangsan,lisi,wangwuæ•´ä¸ªå½“åšä¸€ä¸ªå­—ç¬¦ä¸²æ¥æŸ¥è¯¢äº†ï¼Œæ‰€ä»¥æ•°æ®åº“ä¸­æ ¹æœ¬æŸ¥ä¸åˆ°name=&#39;zhangsan,lisi,wangwu&#39;è¿™æ ·çš„è®°å½•","user_name":"ä½œè€…å›å¤","user_name_real":"æœ±æ™”","uid":"1001470","ctime":1586179088,"ip_address":"","comment_id":203298,"utype":1}],"discussion_count":3,"race_medal":0,"score":"70305644781","product_id":100047701,"comment_content":"é‡åˆ°ä¸€ä¸ªå‘(ä¹Ÿå¯ä»¥è¯´ä¸ç†è§£)ï¼Œå’Œè¯¥ç¯‡æ–‡ç« æ²¡å…³ç³»ï¼Œåé¦ˆä¸€ä¸‹<br><br>mysql å ä½ç¬¦é—®é¢˜<br>prepare sqltpl from &#39;select id,name from table1 where id in (?)&#39;;<br>set @a=&#39;1,2,3,4,5,6,7,8,9&#39;;<br>execute  sqltpl using @a;<br><br>ç»“æœï¼šåªè¾“å‡ºç¬¬ä¸€æ¡ç¬¦åˆæ¡ä»¶çš„è®°å½•<br><br>prepare sqltpl from &#39;select name from table1 where name in (?)&#39;;<br>set @a=&#39;zhangsan,lisi,wangwu&#39;;<br>execute  sqltpl using @a;<br>ç»“æœæ²¡æœ‰è®°å½•","like_count":17,"discussions":[{"author":{"id":1001470,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/47/fe/d0e25d57.jpg","nickname":"æœ±æ™”","note":"","ucode":"0B7F0BADE6AAB8","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":490822,"discussion_content":"å—¯ï¼ŒåŸå› æ˜¯ï¼š\n1ã€idæ˜¯æ•°å­—å‹ï¼Œä¼ å…¥çš„1,2,3,4,5,6,7,8,9çš„å¹¶ä¸èƒ½è½¬æ¢ä¸ºæ•°å­—ï¼Œæ‰€ä»¥æˆªæ–­ä¸º1ï¼ˆç¬¬ä¸€ä¸ªé€—å·ä¹‹å‰çš„æ•°å­—ï¼‰\n2ã€zhangsan,lisi,wangwuæ•´ä¸ªå½“åšä¸€ä¸ªå­—ç¬¦ä¸²æ¥æŸ¥è¯¢äº†ï¼Œæ‰€ä»¥æ•°æ®åº“ä¸­æ ¹æœ¬æŸ¥ä¸åˆ°name=&amp;#39;zhangsan,lisi,wangwu&amp;#39;è¿™æ ·çš„è®°å½•","likes_number":2,"is_delete":false,"is_hidden":false,"ctime":1586179088,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":1,"child_discussions":[{"author":{"id":2015438,"avatar":"https://static001.geekbang.org/account/avatar/00/1e/c0/ce/eb1b4ae1.jpg","nickname":"å¯åœˆå¯ä¸¶","note":"","ucode":"EB527E176EDE91","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":1001470,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/47/fe/d0e25d57.jpg","nickname":"æœ±æ™”","note":"","ucode":"0B7F0BADE6AAB8","race_medal":0,"user_type":2,"is_pvip":false},"discussion":{"id":582789,"discussion_content":"è¿™å‡ å¤©çœ‹ä¸‹æ¥è€å¸ˆçœŸçš„å¾ˆæœ‰è€å¿ƒ","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1659676115,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":490822,"ip_address":"å¹¿ä¸œ"},"score":582789,"extra":""}]},{"author":{"id":1095857,"avatar":"http://thirdwx.qlogo.cn/mmopen/vi_32/bvj76PmeUvW8kokyu91IZWuRATKmabibDWbzAj2TajeEic7WvKCJOLaOh6jibEmdQ36EO3sBUZ0HibAiapsrZo64U8w/132","nickname":"æ¢¦å€šæ æ†","note":"","ucode":"BDEB97F2822445","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":222879,"discussion_content":"soga,å¤šè°¢è€å¸ˆ","likes_number":1,"is_delete":false,"is_hidden":false,"ctime":1586179171,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":202434,"user_name":"è¡Œè€…","can_delete":false,"product_type":"c1","uid":1063734,"ip_address":"","ucode":"EA31201A7C5AE1","user_header":"https://static001.geekbang.org/account/avatar/00/10/3b/36/2d61e080.jpg","comment_is_top":false,"comment_ctime":1585988097,"is_pvip":false,"replies":[{"id":"75613","content":"åˆ›å»ºå¼‚å¸¸çš„æ—¶å€™ä¸€æ¬¡æ€§fillInStackTraceäº†ï¼Œé™¤éè¿™æ ·ï¼š<br><br>BusinessException ex =  Exceptions.ORDEREXISTS;<br>ex.fillInStackTrace();<br>throw ex;<br><br><br>ï¼ˆè¿™æ ·åŒæ ·ä¸æ˜¯çº¿ç¨‹å®‰å…¨çš„ï¼‰","user_name":"ä½œè€…å›å¤","user_name_real":"æœ±æ™”","uid":"1001470","ctime":1585995225,"ip_address":"","comment_id":202434,"utype":1}],"discussion_count":5,"race_medal":0,"score":"61715530241","product_id":100047701,"comment_content":"è€å¸ˆï¼Œå…³äº åƒä¸‡åˆ«æŠŠå¼‚å¸¸å®šä¹‰ä¸ºé™æ€å˜é‡ï¼Œéº»çƒ¦åˆ†æä¸‹ä¸ºä»€ä¹ˆcancelOrderRightæŠ›å‡ºçš„å¼‚å¸¸ä¿¡æ¯æŒ‡å‘createOrderWrongæ‰€åœ¨çš„è¡Œ~","like_count":14,"discussions":[{"author":{"id":1001470,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/47/fe/d0e25d57.jpg","nickname":"æœ±æ™”","note":"","ucode":"0B7F0BADE6AAB8","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":490583,"discussion_content":"åˆ›å»ºå¼‚å¸¸çš„æ—¶å€™ä¸€æ¬¡æ€§fillInStackTraceäº†ï¼Œé™¤éè¿™æ ·ï¼š\n\nBusinessException ex =  Exceptions.ORDEREXISTS;\nex.fillInStackTrace();\nthrow ex;\n\n\nï¼ˆè¿™æ ·åŒæ ·ä¸æ˜¯çº¿ç¨‹å®‰å…¨çš„ï¼‰","likes_number":1,"is_delete":false,"is_hidden":false,"ctime":1585995225,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1203576,"avatar":"https://static001.geekbang.org/account/avatar/00/12/5d/78/f011d586.jpg","nickname":"é‡è§é˜³å…‰","note":"","ucode":"378E5D37B3CD0E","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":221412,"discussion_content":"æ„Ÿè§‰æ²¡çœ‹æ‡‚å•Š","likes_number":1,"is_delete":false,"is_hidden":false,"ctime":1586007808,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":1,"child_discussions":[{"author":{"id":1139413,"avatar":"https://static001.geekbang.org/account/avatar/00/11/62/d5/1f5c5ab6.jpg","nickname":"å¤§å¤§å¤§ç†Šmyeh","note":"","ucode":"4832C2E7CEB151","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":1203576,"avatar":"https://static001.geekbang.org/account/avatar/00/12/5d/78/f011d586.jpg","nickname":"é‡è§é˜³å…‰","note":"","ucode":"378E5D37B3CD0E","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":227543,"discussion_content":"å°±æ˜¯Exceptions.ORDEREXISTSå¼‚å¸¸åˆå§‹åŒ–çš„æ—¶å€™å·²ç»å®šæ­»äº†å †æ ˆå¼‚å¸¸æ˜¯æŒ‡å‘at org.geekbang.time.commonmistakes.exception.predefinedexception.PredefinedExceptionController.createOrderWrong(PredefinedExceptionController.java:56)è¿™ä¸€è¡Œçš„ï¼Œä»¥åæ— è®ºæ˜¯å“ªé‡Œï¼ˆcancelOrderæ–¹æ³•ï¼‰æŠ›å‡ºè¿™ä¸ªå¼‚å¸¸ï¼Œåœ¨æ—¥å¿—ä¸­è¾“å‡ºçš„å †æ ˆå¼‚å¸¸éƒ½ä¸ç¬¬ä¸€æ¬¡ä¸€æ ·ã€‚","likes_number":7,"is_delete":false,"is_hidden":false,"ctime":1586499313,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":221412,"ip_address":""},"score":227543,"extra":""}]},{"author":{"id":1876823,"avatar":"https://thirdwx.qlogo.cn/mmopen/vi_32/X4ib36ADEvj76XaKD4OUY9k15KqWCAVCwibPicBxz6BBUfDrVolpYInn8zFOw3JBPtVw3L4Lkibaf2eLPemwGKzAXA/132","nickname":"Geek_427d0c","note":"","ucode":"D7A04138C4B8CB","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":399134,"discussion_content":"æˆ‘æŠŠè¿™ä¸ªä»£ç æ”¾åœ¨äº†ä¸€ä¸ªJavaæ–‡ä»¶é‡Œæ‰§è¡Œï¼Œå¹¶æ²¡æœ‰å‡ºç°äº¤æ›¿çš„æƒ…å†µã€‚å°±æ˜¯å¾ˆæ­£å¸¸çš„æ ˆä¿¡æ¯","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1632910236,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1079495,"avatar":"https://static001.geekbang.org/account/avatar/00/10/78/c7/083a3a0b.jpg","nickname":"æ–°ä¸–ç•Œ","note":"","ucode":"4473DC1505F158","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":379347,"discussion_content":"static åœ¨ç±»åŠ è½½å™¨çš„æ—¶å€™å·²ç»åˆå§‹åŒ–äº†å›ºå®šçš„å¼‚å¸¸ï¼Œå¹¶ä¸”åœ¨ä½¿ç”¨ä¸­ä¸ä¼šæ”¹å˜ï¼Œæ‰€ä»¥æ— è®ºå¦‚ä½•æŠ›å‡ºï¼Œæœ€åå°±åªæ˜¯ç¬¬ä¸€æ¬¡åˆå§‹åŒ–æ—¶å€™çš„å¼‚å¸¸ï¼Œå¦‚æœå¤§å®¶ä¸æ˜ç™½ï¼Œæˆ‘ä¸¾ä¸ªæœ€ç®€å•çš„ä¾‹å­\nåœ¨ PredefinedExceptionControllerä¸­ æ·»åŠ ä¸€ä¸ªé™æ€å—\nstatic  {\n        Exceptions exceptions = new Exceptions();\n    }\n\n\nè¿™æ—¶å€™ä¼šåœ¨åŠ è½½ç±»çš„æ—¶å€™åˆå§‹åŒ–ï¼š \n    public static BusinessException ORDER_EXISTS = new BusinessException(&#34;è®¢å•å·²å­˜åœ¨&#34;,3001); è¿™å¥è¯ï¼Œè¿™ä¸ªå¼‚å¸¸å°±ä¼šæŠ¥åˆ›å»ºå¯¹è±¡å¼‚å¸¸ï¼Œå¦‚ä¸‹\n\n2021-06-16 18:10:58 [com.xs.micro.study.exception.ExceptionTestController] :36-[ERROR] [service:study-base,TraceId:] cancelOrder got error\ncom.xs.micro.study.exception.BusinessException: è®¢å•å·²å­˜åœ¨\n\tat com.xs.micro.study.exception.Exceptions.<clinit>(Exceptions.java:13)\n\tat com.xs.micro.study.exception.ExceptionTestController.<clinit>(ExceptionTestController.java:22)\n\tat sun.reflect.NativeConstructorAccessorImpl.newInstance0(Native Method)\n\tat sun.reflect.NativeConstructorAccessorImpl.newInstance(NativeConstructorAccessorImpl.java:62)\n\tat sun.reflect.DelegatingConstructorAccessorImpl.newInstance(DelegatingConstructorAccessorImpl.java:45)\n\tat java.lang.reflect.Constructor.newInstance(Constructor.java:423)\n\tat org.springframework.beans.BeanUtils.instantiateClass(BeanUtils.java:200)\n\tat org.springframework.beans.factory.support.SimpleInstantiationStrategy.instantiate(SimpleInstantiationStrategy.java:87)\n\tat org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.instantiateBean(AbstractAutowireCapableBeanFactory.java:1312)\n\tat org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.createBeanInstance(AbstractAutowireCapableBeanFactory.java:1214)\n","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1623838340,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":202448,"user_name":"è¡Œè€…","can_delete":false,"product_type":"c1","uid":1063734,"ip_address":"","ucode":"EA31201A7C5AE1","user_header":"https://static001.geekbang.org/account/avatar/00/10/3b/36/2d61e080.jpg","comment_is_top":false,"comment_ctime":1585990082,"is_pvip":false,"replies":[{"id":"75608","content":"ä¸é”™","user_name":"ä½œè€…å›å¤","user_name_real":"æœ±æ™”","uid":"1001470","ctime":1585993670,"ip_address":"","comment_id":202448,"utype":1}],"discussion_count":1,"race_medal":0,"score":"53125597634","product_id":100047701,"comment_content":"IllegalArgumentException: å…¥å‚é”™è¯¯ï¼Œæ¯”å¦‚å‚æ•°ç±»å‹intè¾“å…¥stringã€‚<br>IllegalStateException: çŠ¶æ€é”™è¯¯ï¼Œæ¯”å¦‚è®¢å•å·²ç»æ”¯ä»˜å®Œæˆï¼ŒäºŒæ¬¡è¯·æ±‚æ”¯ä»˜æ¥å£ã€‚<br>UnsupportedOperationException: ä¸æ”¯æŒæ“ä½œé”™è¯¯ï¼Œæ¯”å¦‚å¯¹ä¸€ç¬”ä¸èƒ½é€€æ¬¾çš„è®¢å•é€€æ¬¾ã€‚<br>å…¶ä»–å¼‚å¸¸<br>SecurityException: æƒé™é”™è¯¯ï¼Œæ¯”å¦‚æœªç™»é™†ç”¨æˆ·è°ƒç”¨ä¿®æ”¹ç”¨æˆ·ä¿¡æ¯æ¥å£ã€‚","like_count":13,"discussions":[{"author":{"id":1001470,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/47/fe/d0e25d57.jpg","nickname":"æœ±æ™”","note":"","ucode":"0B7F0BADE6AAB8","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":490586,"discussion_content":"ä¸é”™","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1585993670,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":202809,"user_name":"ç»ˆç»“è€…999å·","can_delete":false,"product_type":"c1","uid":1055854,"ip_address":"","ucode":"33ADE61580B6DD","user_header":"https://static001.geekbang.org/account/avatar/00/10/1c/6e/6c5f5734.jpg","comment_is_top":false,"comment_ctime":1586072540,"is_pvip":true,"replies":[{"id":"75794","content":"å°±æ˜¯Throwableçš„stacktraceåªæ˜¯åœ¨å…¶newå‡ºæ¥çš„æ—¶å€™æ‰åˆå§‹åŒ–ï¼ˆè°ƒç”¨fillInStackTraceæ–¹æ³•ï¼‰æ˜¯ä¸€æ¬¡æ€§çš„ï¼ˆé™¤éä½ æ‰‹åŠ¨è°ƒç”¨é‚£ä¸ªæ–¹æ³•ï¼‰ï¼Œè€ŒégetStackTraceçš„æ—¶å€™å»è·å¾—stacktraceï¼Œæ¯•ç«Ÿæˆ‘ä»¬å…³å¿ƒçš„æ˜¯å¼‚å¸¸æŠ›å‡ºæ—¶çš„æ ˆã€‚","user_name":"ä½œè€…å›å¤","user_name_real":"æœ±æ™”","uid":"1001470","ctime":1586077045,"ip_address":"","comment_id":202809,"utype":1}],"discussion_count":2,"race_medal":0,"score":"31650843612","product_id":100047701,"comment_content":"å…³äºè¡Œè€…çš„é—®é¢˜ï¼Œè¯·è€å¸ˆå†è§£é‡Šä¸€ä¸‹å¯ä»¥å—ï¼Ÿè²Œä¼¼æ²¡æœ‰çœ‹æ‡‚é‚£ä¸ªå›å¤ï¼Œä»€ä¹ˆå«ä¸€æ¬¡æ€§fillstacktraceï¼Ÿ","like_count":8,"discussions":[{"author":{"id":1001470,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/47/fe/d0e25d57.jpg","nickname":"æœ±æ™”","note":"","ucode":"0B7F0BADE6AAB8","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":490692,"discussion_content":"å°±æ˜¯Throwableçš„stacktraceåªæ˜¯åœ¨å…¶newå‡ºæ¥çš„æ—¶å€™æ‰åˆå§‹åŒ–ï¼ˆè°ƒç”¨fillInStackTraceæ–¹æ³•ï¼‰æ˜¯ä¸€æ¬¡æ€§çš„ï¼ˆé™¤éä½ æ‰‹åŠ¨è°ƒç”¨é‚£ä¸ªæ–¹æ³•ï¼‰ï¼Œè€ŒégetStackTraceçš„æ—¶å€™å»è·å¾—stacktraceï¼Œæ¯•ç«Ÿæˆ‘ä»¬å…³å¿ƒçš„æ˜¯å¼‚å¸¸æŠ›å‡ºæ—¶çš„æ ˆã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1586077045,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1079495,"avatar":"https://static001.geekbang.org/account/avatar/00/10/78/c7/083a3a0b.jpg","nickname":"æ–°ä¸–ç•Œ","note":"","ucode":"4473DC1505F158","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":379349,"discussion_content":"static åœ¨ç±»åŠ è½½å™¨çš„æ—¶å€™å·²ç»åˆå§‹åŒ–äº†å›ºå®šçš„å¼‚å¸¸ï¼Œå¹¶ä¸”åœ¨ä½¿ç”¨ä¸­ä¸ä¼šæ”¹å˜ï¼Œæ‰€ä»¥æ— è®ºå¦‚ä½•æŠ›å‡ºï¼Œæœ€åå°±åªæ˜¯ç¬¬ä¸€æ¬¡åˆå§‹åŒ–æ—¶å€™çš„å¼‚å¸¸ï¼Œå¦‚æœå¤§å®¶ä¸æ˜ç™½ï¼Œæˆ‘ä¸¾ä¸ªæœ€ç®€å•çš„ä¾‹å­\nåœ¨ PredefinedExceptionControllerä¸­ æ·»åŠ ä¸€ä¸ªé™æ€å—\nstatic {\n        Exceptions exceptions = new Exceptions();\n    }\n\n\nè¿™æ—¶å€™ä¼šåœ¨åŠ è½½ç±»çš„æ—¶å€™åˆå§‹åŒ–ï¼š\n    public static BusinessException ORDER_EXISTS = new BusinessException(&#34;è®¢å•å·²å­˜åœ¨&#34;,3001); è¿™å¥è¯ï¼Œè¿™ä¸ªå¼‚å¸¸å°±ä¼šæŠ¥åˆ›å»ºå¯¹è±¡å¼‚å¸¸ï¼Œå¦‚ä¸‹\n\n2021-06-16 18:10:58 [com.xs.micro.study.exception.ExceptionTestController] :36-[ERROR] [service:study-base,TraceId:] cancelOrder got error\ncom.xs.micro.study.exception.BusinessException: è®¢å•å·²å­˜åœ¨\nat com.xs.micro.study.exception.Exceptions.<clinit>(Exceptions.java:13)\nat com.xs.micro.study.exception.ExceptionTestController.<clinit>(ExceptionTestController.java:22)\nat sun.reflect.NativeConstructorAccessorImpl.newInstance0(Native Method)\nat sun.reflect.NativeConstructorAccessorImpl.newInstance(NativeConstructorAccessorImpl.java:62)\nat sun.reflect.DelegatingConstructorAccessorImpl.newInstance(DelegatingConstructorAccessorImpl.java:45)\nat java.lang.reflect.Constructor.newInstance(Constructor.java:423)\nat org.springframework.beans.BeanUtils.instantiateClass(BeanUtils.java:200)\nat org.springframework.beans.factory.support.SimpleInstantiationStrategy.instantiate(SimpleInstantiationStrategy.java:87)\nat org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.instantiateBean(AbstractAutowireCapableBeanFactory.java:1312)\nat org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.createBeanInstance(AbstractAutowireCapableBeanFactory.java:1214)","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1623838693,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":202437,"user_name":"æ¢¦å€šæ æ†","can_delete":false,"product_type":"c1","uid":1095857,"ip_address":"","ucode":"BDEB97F2822445","user_header":"http://thirdwx.qlogo.cn/mmopen/vi_32/bvj76PmeUvW8kokyu91IZWuRATKmabibDWbzAj2TajeEic7WvKCJOLaOh6jibEmdQ36EO3sBUZ0HibAiapsrZo64U8w/132","comment_is_top":false,"comment_ctime":1585988796,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"23060825276","product_id":100047701,"comment_content":"ç°åœ¨å‡ºé—®é¢˜å°±æ˜¯çå­ï¼Œä¸€ç‚¹ä¸€ç‚¹çš„æ—¥å¿—çš„æ‰“ï¼Œä¸Šçº¿ï¼Œå“ï¼Œè¿™å“ªæ˜¯ä¸ªåˆæ ¼çš„RDå‘€","like_count":6},{"had_liked":false,"id":202965,"user_name":"å°æ°","can_delete":false,"product_type":"c1","uid":1166969,"ip_address":"","ucode":"09E29168D53178","user_header":"https://static001.geekbang.org/account/avatar/00/11/ce/79/673f4268.jpg","comment_is_top":false,"comment_ctime":1586094529,"is_pvip":true,"replies":[{"id":"75890","content":"ä»”ç»†è§‚å¯Ÿä¸€ä¸‹æ ˆï¼Œæ•°æ®ä¸²äº†ï¼Œå–æ¶ˆè®¢å•çš„å¼‚å¸¸æ ˆæ˜¾ç¤ºäº†ä¸‹å•çš„æ–¹æ³•","user_name":"ä½œè€…å›å¤","user_name_real":"æœ±æ™”","uid":"1001470","ctime":1586133746,"ip_address":"","comment_id":202965,"utype":1}],"discussion_count":1,"race_medal":0,"score":"14470996417","product_id":100047701,"comment_content":"è€å¸ˆï¼Œçœ‹ä¸æ‡‚é‚£ä¸ªå¼‚å¸¸å®šä¹‰ä¸ºé™æ€å˜é‡çš„ä¾‹å­ï¼Œå¼‚å¸¸æ‰“å°çš„æ˜¯å †æ ˆä¿¡æ¯ï¼Œå †æ ˆä¿¡æ¯å¿…é¡»æ˜¯å¯¹è±¡æ˜¯è¿™ä¸ªæ„æ€å—ï¼Ÿ","like_count":3,"discussions":[{"author":{"id":1001470,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/47/fe/d0e25d57.jpg","nickname":"æœ±æ™”","note":"","ucode":"0B7F0BADE6AAB8","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":490718,"discussion_content":"ä»”ç»†è§‚å¯Ÿä¸€ä¸‹æ ˆï¼Œæ•°æ®ä¸²äº†ï¼Œå–æ¶ˆè®¢å•çš„å¼‚å¸¸æ ˆæ˜¾ç¤ºäº†ä¸‹å•çš„æ–¹æ³•","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1586133746,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":202319,"user_name":"åŠªåŠ›å¥‹æ–—çš„Pisces","can_delete":false,"product_type":"c1","uid":1336441,"ip_address":"","ucode":"AD4F8909CF190A","user_header":"https://static001.geekbang.org/account/avatar/00/14/64/79/f1e1ca76.jpg","comment_is_top":false,"comment_ctime":1585967638,"is_pvip":true,"discussion_count":0,"race_medal":0,"score":"14470869526","product_id":100047701,"comment_content":"1.å¾—çœ‹finallyé‡Œé¢æ˜¯æ€ä¹ˆå¤„ç†çš„äº†ï¼Œé™¤éfinallyæ²¡æœ‰æ‰§è¡Œåˆ°ï¼Œæˆ–è€…æ˜¯finallyé‡Œé¢æŠ¥é”™äº†ï¼Œä¸ç„¶éƒ½æ˜¯æŒ‰ç…§finallyé‡Œé¢çš„è¿”å›å€¼åšæœ€ç»ˆçš„è¿”å›å§","like_count":3},{"had_liked":false,"id":202268,"user_name":"æ—­ä¸œ(Frank)","can_delete":false,"product_type":"c1","uid":1024486,"ip_address":"","ucode":"176FA629800062","user_header":"https://static001.geekbang.org/account/avatar/00/0f/a1/e6/50da1b2d.jpg","comment_is_top":false,"comment_ctime":1585952273,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"14470854161","product_id":100047701,"comment_content":"è®¢å•å­˜åœ¨å¼‚å¸¸ï¼Œè¿™ä¸ªä¾‹å­å®é™…å¼€å‘ä¸­çœŸéœ€è¦åŒºåˆ†å—ï¼Ÿä¸ªäººè§‰å¾—æ— æ•ˆå‚æ•°çš„ä¾‹å­æ›´å¥½äº›","like_count":3},{"had_liked":false,"id":301013,"user_name":"walleæ–Œ","can_delete":false,"product_type":"c1","uid":1062848,"ip_address":"","ucode":"0DB3243004951F","user_header":"http://thirdwx.qlogo.cn/mmopen/vi_32/DYAIOgq83ersGSic8ib7OguJv6CJiaXY0s4n9C7Z51sWxTTljklFpq3ZAIWXoFTPV5oLo0GMTkqW5sYJRRnibNqOJQ/132","comment_is_top":false,"comment_ctime":1625485184,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"5920452480","product_id":100047701,"comment_content":"æ²¡æœ‰å›ç­”è€å¸ˆçš„é—®é¢˜ï¼Œè€Œæ˜¯å¯¹å¼‚å¸¸å¤„ç†æœ‰ä¸€äº›å…¶ä»–çœ‹æ³•<br>1ã€log.errorä¿ç•™ç°åœºï¼Œlog.error(&quot;xxx error:&quot; + reqString,e)<br>2ã€ä»¥æ ‡å‡†è¿”å›ï¼Œè¿”å›é”™è¯¯ï¼Œä¾›ä¸Šå±‚å¤„ç†ï¼ŒæŒ‰ç…§æ ‡å‡†è¿”å›çš„æ­£ç¡®ä¸ä¸å¦è¿”å›<br>3ã€æ ‡å‡†è¿”å›ï¼Œé™¤äº†ä¸€èˆ¬çš„æ˜¯å¦æ­£ç¡®ï¼Œé”™è¯¯ç ï¼Œé”™è¯¯ä¿¡æ¯ï¼Œå¢åŠ å¦‚ä¸‹2ç‚¹ï¼Œæ–¹ä¾¿å¿«é€Ÿæ’æŸ¥é—®é¢˜<br>1ï¼‰ã€è¯¦ç»†é”™è¯¯ï¼Œé™„å¸¦é”™è¯¯çš„å‰200ã€å¯é…ç½®ã€‘ä¿¡æ¯ï¼Œä¸”å¯¹å¤–ç½‘å…³å¯ä»¥è€ƒè™‘è¿‡æ»¤æ­¤å­—æ®µ<br>2ï¼‰ã€å…¨é“¾è·¯è·Ÿè¸ªå­—æ®µ<br>ç›´æ¥æŠŠå…¨é“¾è·¯è·Ÿè¸ªå­—æ®µæš´éœ²å‡ºæ¥ï¼Œå¯¹äºå¼‚å¸¸æ’åœºåŠ é€Ÿæ’æŸ¥ã€‚è€Œä¸”æœ‰äº†è¯¦ç»†é”™è¯¯å­—æ®µï¼Œå…¶å®ä¸€çœ¼å°±èƒ½çœ‹å‡ºå’‹å›äº‹äº†ï¼Œä¸€èˆ¬çš„é”™è¯¯ã€‚","like_count":1},{"had_liked":false,"id":207682,"user_name":"yan_12345","can_delete":false,"product_type":"c1","uid":1904542,"ip_address":"","ucode":"7F2D3230C1621A","user_header":"http://thirdwx.qlogo.cn/mmopen/vi_32/t1IeXCJODYdTt2RPGqx2zDjVX4N1FrxCWqQFfico2wVfetel8vcQYax1ASJHagACzdGCiaUbzlbjjfwtZa5G5TSQ/132","comment_is_top":false,"comment_ctime":1587136278,"is_pvip":false,"replies":[{"id":"77568","content":"æœ‰æ„ä¹‰ï¼ŒæŠŠåå‘äºåº•å±‚çš„å¼‚å¸¸è½¬æ¢ä¸ºé«˜å±‚å¼‚å¸¸ã€‚æ¢å¥è¯è¯´æŠŠåå‘äºå†…éƒ¨å¤„ç†è‡ªå·±æ‰èƒ½ç†è§£çš„å¼‚å¸¸è½¬æ¢ä¸ºä¸€ä¸ªå¤–éƒ¨å¯ä»¥ç†è§£çš„å¼‚å¸¸æŠ›å‡ºã€‚","user_name":"ä½œè€…å›å¤","user_name_real":"æœ±æ™”","uid":"1001470","ctime":1587167755,"ip_address":"","comment_id":207682,"utype":1}],"discussion_count":1,"race_medal":0,"score":"5882103574","product_id":100047701,"comment_content":"è€å¸ˆï¼Œåœ¨ä¸šåŠ¡ä»£ç å½“ä¸­ï¼Œåœ¨catchä¹‹åï¼Œåœ¨ä»€ä¹ˆæƒ…å†µä¸‹éœ€è¦é‡æ–°æŠ›å‡ºæ–°çš„å¼‚å¸¸ï¼Œè¿™æ ·åšæœ‰ä»€ä¹ˆæ„ä¹‰å’Œä½œç”¨ï¼Ÿ","like_count":1,"discussions":[{"author":{"id":1001470,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/47/fe/d0e25d57.jpg","nickname":"æœ±æ™”","note":"","ucode":"0B7F0BADE6AAB8","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":492208,"discussion_content":"æœ‰æ„ä¹‰ï¼ŒæŠŠåå‘äºåº•å±‚çš„å¼‚å¸¸è½¬æ¢ä¸ºé«˜å±‚å¼‚å¸¸ã€‚æ¢å¥è¯è¯´æŠŠåå‘äºå†…éƒ¨å¤„ç†è‡ªå·±æ‰èƒ½ç†è§£çš„å¼‚å¸¸è½¬æ¢ä¸ºä¸€ä¸ªå¤–éƒ¨å¯ä»¥ç†è§£çš„å¼‚å¸¸æŠ›å‡ºã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1587167755,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":205346,"user_name":"çœ‹ä¸åˆ°deé¢œè‰²","can_delete":false,"product_type":"c1","uid":1162714,"ip_address":"","ucode":"88348CCAE81931","user_header":"https://static001.geekbang.org/account/avatar/00/11/bd/da/3d76ea74.jpg","comment_is_top":false,"comment_ctime":1586595703,"is_pvip":false,"replies":[{"id":"76708","content":"æœ‰æ”¶è´§å°±å¥½ã€‚statis-&gt;staticã€‚","user_name":"ä½œè€…å›å¤","user_name_real":"æœ±æ™”","uid":"1001470","ctime":1586603083,"ip_address":"","comment_id":205346,"utype":1}],"discussion_count":1,"race_medal":0,"score":"5881562999","product_id":100047701,"comment_content":"å¥½æ–‡ï¼Œç›®å‰ç”Ÿäº§ç¯å¢ƒå°±å­˜åœ¨å‡ºç°å¼‚å¸¸åªå‘ä¸Šè¿”å›e.getMessage()ï¼Œå¯¼è‡´å‡ºç°é¢„æœŸå¤–çš„é—®é¢˜æ—¶ä¸€è„¸æ‡µé€¼ï¼Œè¿™å—æ—¥åä¸€å®šè¦æ³¨æ„ã€‚statis Exceptionè¿™å—å­¦ä¹ åˆ°äº†ï¼Œå¯¹æ—¥åé—­å‘æœ‰å¾ˆå¤§å¸®åŠ©ã€‚é€šè¿‡è¿™ç¯‡æ–‡ç« è¿˜å­¦åˆ°äº†try-with-resourcesè¯­æ³•ï¼Œæ”¶è´§é¢‡ä¸°ã€‚","like_count":1,"discussions":[{"author":{"id":1001470,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/47/fe/d0e25d57.jpg","nickname":"æœ±æ™”","note":"","ucode":"0B7F0BADE6AAB8","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":491454,"discussion_content":"æœ‰æ”¶è´§å°±å¥½ã€‚statis-&amp;gt;staticã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1586603083,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":204755,"user_name":"skying","can_delete":false,"product_type":"c1","uid":1041865,"ip_address":"","ucode":"E7CFF50AB64BB1","user_header":"https://static001.geekbang.org/account/avatar/00/0f/e5/c9/1061582b.jpg","comment_is_top":false,"comment_ctime":1586450012,"is_pvip":true,"replies":[{"id":"76521","content":"å¼‚å¸¸å¤„ç†ç¨‹åºåªæ˜¯ä½œä¸ºä¿åº•å‡ºäº†å¼‚å¸¸å¯ä»¥è‡ªå·±æ¥å¤„ç†ï¼Œä¸èƒ½é˜²æ­¢å¼‚å¸¸äº§ç”Ÿã€‚<br><br>æ–‡ä¸­ä¿®å¤æ–¹å¼æœ‰ 2 æ­¥ï¼Œç¬¬ä¸€æ­¥æ˜¯æ¯”è¾ƒé‡è¦çš„ï¼šä»¥ execute æ–¹æ³•æäº¤åˆ°çº¿ç¨‹æ± çš„å¼‚æ­¥ä»»åŠ¡ï¼Œæœ€å¥½åœ¨ä»»åŠ¡å†…éƒ¨åšå¥½å¼‚å¸¸å¤„ç†ï¼›è®¾ç½®è‡ªå®šä¹‰çš„å¼‚å¸¸å¤„ç†ç¨‹åºä½œä¸ºä¿åº•ï¼Œæ¯”å¦‚åœ¨å£°æ˜çº¿ç¨‹æ± æ—¶è‡ªå®šä¹‰çº¿ç¨‹æ± çš„æœªæ•è·å¼‚å¸¸å¤„ç†ç¨‹åºï¼š","user_name":"ä½œè€…å›å¤","user_name_real":"æœ±æ™”","uid":"1001470","ctime":1586479519,"ip_address":"","comment_id":204755,"utype":1}],"discussion_count":4,"race_medal":0,"score":"5881417308","product_id":100047701,"comment_content":"ä½ å¥½ï¼Œå…³äº æäº¤åˆ°çº¿ç¨‹æ± çš„çº¿ç¨‹å‘ç”Ÿå¼‚å¸¸çš„åœºæ™¯ã€‚<br>æˆ‘æœ¬åœ°ç¯å¢ƒ æ·»åŠ äº†UncaughtExceptionHandlerï¼Œä½†åç»­çš„5æ¬¡å¾ªç¯ä¸­ï¼Œæ‰“å°çš„çº¿ç¨‹è¿˜æ˜¯test1.<br><br>æœ¬åœ°ç¯å¢ƒ:spring boot2.2.5+undertow","like_count":1,"discussions":[{"author":{"id":1001470,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/47/fe/d0e25d57.jpg","nickname":"æœ±æ™”","note":"","ucode":"0B7F0BADE6AAB8","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":491275,"discussion_content":"å¼‚å¸¸å¤„ç†ç¨‹åºåªæ˜¯ä½œä¸ºä¿åº•å‡ºäº†å¼‚å¸¸å¯ä»¥è‡ªå·±æ¥å¤„ç†ï¼Œä¸èƒ½é˜²æ­¢å¼‚å¸¸äº§ç”Ÿã€‚\n\næ–‡ä¸­ä¿®å¤æ–¹å¼æœ‰ 2 æ­¥ï¼Œç¬¬ä¸€æ­¥æ˜¯æ¯”è¾ƒé‡è¦çš„ï¼šä»¥ execute æ–¹æ³•æäº¤åˆ°çº¿ç¨‹æ± çš„å¼‚æ­¥ä»»åŠ¡ï¼Œæœ€å¥½åœ¨ä»»åŠ¡å†…éƒ¨åšå¥½å¼‚å¸¸å¤„ç†ï¼›è®¾ç½®è‡ªå®šä¹‰çš„å¼‚å¸¸å¤„ç†ç¨‹åºä½œä¸ºä¿åº•ï¼Œæ¯”å¦‚åœ¨å£°æ˜çº¿ç¨‹æ± æ—¶è‡ªå®šä¹‰çº¿ç¨‹æ± çš„æœªæ•è·å¼‚å¸¸å¤„ç†ç¨‹åºï¼š","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1586479519,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1001470,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/47/fe/d0e25d57.jpg","nickname":"æœ±æ™”","note":"","ucode":"0B7F0BADE6AAB8","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":228591,"discussion_content":"å¯ä»¥å®Œæ•´å¸–ä¸€ä¸‹ä½ çš„ä»£ç å’Œè¾“å‡ºï¼Œè¾“å‡ºtest1æ˜¯å¯¹çš„ï¼Œè€çš„çº¿ç¨‹æ˜¯test0","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1586565407,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1001470,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/47/fe/d0e25d57.jpg","nickname":"æœ±æ™”","note":"","ucode":"0B7F0BADE6AAB8","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":228145,"discussion_content":"æ˜¯executeè¿˜æ˜¯submit?","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1586526480,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1041865,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/e5/c9/1061582b.jpg","nickname":"skying","note":"","ucode":"E7CFF50AB64BB1","race_medal":0,"user_type":1,"is_pvip":true},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":227362,"discussion_content":"@ä½œè€…ï¼Œä½ å¥½ï¼Œåœ¨è®¾ç½®è‡ªå®šä¹‰çš„å¼‚å¸¸å¤„ç†ç¨‹åºä½œä¸ºä¿åº•åï¼Œåé¢çš„çº¿ç¨‹æ˜¯ä»çº¿ç¨‹æ± ä¸­å– è¿˜æ˜¯ åˆ›å»ºæ–°çš„ çº¿ç¨‹å‘¢\nå°±è¿™ä¸€ç‚¹ æˆ‘ä¸å¤ªç†è§£ï¼Œæœ¬åœ°demoå‡ºçš„ç»“æœå’Œä½ çš„ä¸“æ ä¸Šçš„ ä¸ä¸€è‡´ã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1586485684,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":350733,"user_name":"Geek_d3928c","can_delete":false,"product_type":"c1","uid":2450893,"ip_address":"","ucode":"7CB09FD1F7CB23","user_header":"https://thirdwx.qlogo.cn/mmopen/vi_32/L8EpqHoAnmvkzCIsdOkv5QvhIzu5tMaF2FDusXShqukv5ZBkS8DbicWaErjnYydibiaqBrs70wQ8P6axvC2FbWpbQ/132","comment_is_top":false,"comment_ctime":1657123987,"is_pvip":true,"discussion_count":0,"race_medal":0,"score":"1657123987","product_id":100047701,"comment_content":"try-with-resourcesè¯­å¥èƒ½å¤Ÿå¸®ä½ è‡ªåŠ¨è°ƒç”¨èµ„æºçš„close()å‡½æ•°å…³é—­èµ„æºä¸ç”¨åˆ°finallyå—.,åœ¨tryå…³é”®å­—åé¢çš„( )é‡Œnewä¸€äº›éœ€è¦è‡ªåŠ¨å…³é—­çš„èµ„æºã€‚","like_count":1},{"had_liked":false,"id":332415,"user_name":"èŠ±ä¸‹çœ ","can_delete":false,"product_type":"c1","uid":1183854,"ip_address":"","ucode":"F14C138BF7AEA7","user_header":"https://static001.geekbang.org/account/avatar/00/12/10/6e/a21968a9.jpg","comment_is_top":false,"comment_ctime":1643242051,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1643242051","product_id":100047701,"comment_content":"å¼‚å¸¸ä»¥ä¸ºè‡ªå·±ç†è§£äº†ï¼Œçœ‹å®Œè¿™èŠ‚è¯¾ï¼Œæ”¶è·æ»¡æ»¡ï¼Œç‘æ€æ‹œ<br>1ã€åˆ‡è®°ç”Ÿåå¼‚å¸¸ï¼Œå¹¶ä¸”è®°å½•å †æ ˆä¿¡æ¯<br>2ã€å¼‚å¸¸æ¶ˆæ¯æœ‰æ„ä¹‰<br>3ã€å¼‚å¸¸è¦†ç›–<br>4ã€çº¿ç¨‹æ± å¼‚å¸¸ï¼Œä¸ºçº¿ç¨‹èµ·åå­—å¥½å®šä½é—®é¢˜ï¼Œæ³¨æ„å¼‚å¸¸åçº¿ç¨‹æ˜¯å¦é€€å‡ºç­‰","like_count":0},{"had_liked":false,"id":319120,"user_name":"åˆ˜å¿—é¹","can_delete":false,"product_type":"c1","uid":2546103,"ip_address":"","ucode":"FBA7FA3A392D22","user_header":"","comment_is_top":false,"comment_ctime":1635595999,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1635595999","product_id":100047701,"comment_content":"æˆ‘çš„å¼‚å¸¸å¤„ç†é€šå¸¸è¿™ä¹ˆåšï¼š1ï¼š è‡ªå®šä¹‰å¼‚å¸¸ï¼ŒåŒ…æ‹¬ä¸­è‹±æ–‡message, codeã€‚2ï¼š serviceæ‰‹åŠ¨æŠ›å‡ºä¸šåŠ¡å¼‚å¸¸ï¼Œ controller ä¸æ•è·ï¼› 3ï¼šæ¡†æ¶ç»Ÿä¸€å¤„ç†ã€‚<br><br>è¿™æ ·è¿”å›çš„messageï¼Œå…¶å®ä¹Ÿæ˜¯serviceæŠ›å‡ºçš„å¼‚å¸¸æ¶ˆæ¯ã€‚  ","like_count":0},{"had_liked":false,"id":315263,"user_name":"é¥­ç²’","can_delete":false,"product_type":"c1","uid":1153455,"ip_address":"","ucode":"4C3220B0D43997","user_header":"https://static001.geekbang.org/account/avatar/00/11/99/af/d29273e2.jpg","comment_is_top":false,"comment_ctime":1633773929,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1633773929","product_id":100047701,"comment_content":"ä¸ºä»€ä¹ˆæˆ‘æµ‹è¯•æ—¶ï¼Œexecute æ–¹å¼å³ä½¿åŠ äº†å¼‚å¸¸æ•è·å¤„ç†ï¼Œçº¿ç¨‹è¿˜æ˜¯ä¼šé€€å‡ºé‡å»ºï¼Ÿ","like_count":0},{"had_liked":false,"id":314239,"user_name":"Geek_427d0c","can_delete":false,"product_type":"c1","uid":1876823,"ip_address":"","ucode":"D7A04138C4B8CB","user_header":"https://thirdwx.qlogo.cn/mmopen/vi_32/X4ib36ADEvj76XaKD4OUY9k15KqWCAVCwibPicBxz6BBUfDrVolpYInn8zFOw3JBPtVw3L4Lkibaf2eLPemwGKzAXA/132","comment_is_top":false,"comment_ctime":1632908552,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1632908552","product_id":100047701,"comment_content":"ä¸çŸ¥é“æ˜¯ä»€ä¹ˆåŸå› ï¼Œä¸‹è¿°ä»£ç ï¼Œæ²¡æœ‰å‡ºç°è€å¸ˆçš„é™æ€Exceptionçš„ç°è±¡ã€‚æ‰“å°çš„errorå †æ ˆä¿¡æ¯çœ‹åˆ°è¿˜æ˜¯å¾ˆæ­£å¸¸çš„ã€‚<br>package com.example.demo;<br><br>import lombok.extern.slf4j.Slf4j;<br><br>&#47;**<br> * Created by wensi on 2021-09-09<br> *&#47;<br>@Slf4j<br>public class Test {<br>    public static BusinessException ORDEREXISTS = new BusinessException(&quot;è®¢å•å·²ç»å­˜åœ¨&quot;);<br><br>    public static void main(String[] args) throws InterruptedException {<br>        new Test().wrong();<br>    }<br><br>    public void wrong() {<br>        try {<br>            createOrderWrong();<br>        } catch (Exception ex) {<br>            log.error(&quot;createOrder got error&quot;, ex);<br>        }<br>        try {<br>            cancelOrderWrong();<br>        } catch (Exception ex) {<br>            log.error(&quot;cancelOrder got error&quot;, ex);<br>        }<br>    }<br><br>    private void createOrderWrong() { &#47;&#47;è¿™é‡Œæœ‰é—®é¢˜<br>        throw Test.ORDEREXISTS;<br>    }<br><br>    private void cancelOrderWrong() { &#47;&#47;è¿™é‡Œæœ‰é—®é¢˜<br>        throw Test.ORDEREXISTS;<br>    }<br>}<br>","like_count":0},{"had_liked":false,"id":309118,"user_name":"Vince","can_delete":false,"product_type":"c1","uid":2689860,"ip_address":"","ucode":"53CB603F3034EC","user_header":"https://static001.geekbang.org/account/avatar/00/29/0b/44/c6487b93.jpg","comment_is_top":false,"comment_ctime":1629948953,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1629948953","product_id":100047701,"comment_content":"çœŸå¥½ï¼Œå—ç›ŠåŒªæµ…ï¼Œç›´æ¥å°±è¯»äº†2éï¼Œæˆ‘è¿˜å¾—å’Œå°ä¼™ä¼´åˆ†äº«ä¸€ä¸‹æ”¶è·","like_count":0},{"had_liked":false,"id":264970,"user_name":"å…­çŸ³","can_delete":false,"product_type":"c1","uid":2302562,"ip_address":"","ucode":"D0891B58CA5EB1","user_header":"https://thirdwx.qlogo.cn/mmopen/vi_32/DYAIOgq83eoqJGUoKZDx52g82wux57lgo1qH64wGRIumic6Twzb94hEmzmvdeNdw5ibiaMbicOGzlsLt9pXFQJbI7w/132","comment_is_top":false,"comment_ctime":1606724339,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1606724339","product_id":100047701,"comment_content":"ç›´æ¥æŠŠå¼‚å¸¸å®Œå…¨æŠ›å‡ºå¾ˆå¤šæ—¶å€™ä¼šæœ‰å®‰å…¨é—®é¢˜å§ï¼Œæ”»å‡»è€…å¯ä»¥æ ¹æ®å¼‚å¸¸ç±»å‹å’Œæè¿°è¿›è¡Œæ”»å‡»ï¼Œæœ‰æ—¶å€™è¿™ç§æ–¹å¼å¹¶ä¸å¥½ã€‚æ‰€ä»¥æœ‰äº›å…¬å¸å†…éƒ¨çš„è§„èŒƒä¸­æ˜ç¡®è¦æ±‚é’ˆå¯¹å‡ ç§ç‰¹æ®Šçš„å¼‚å¸¸ä¸å…è®¸ç›´æ¥æŠ›å‡ºï¼Œæœ€å¥½çš„æ–¹å¼æ˜¯è®°å½•æ—¥å¿—ï¼Œæ—¥å¿—ä¸­è¿›è¡Œè¯´æ˜ã€‚","like_count":0},{"had_liked":false,"id":248390,"user_name":"jacy","can_delete":false,"product_type":"c1","uid":1103456,"ip_address":"","ucode":"0022A8759DDCE6","user_header":"https://static001.geekbang.org/account/avatar/00/10/d6/60/f21b2164.jpg","comment_is_top":false,"comment_ctime":1600144817,"is_pvip":false,"discussion_count":0,"race_medal":1,"score":"1600144817","product_id":100047701,"comment_content":"æ€»ç»“ï¼š<br>1ã€ä¸šåŠ¡å¼‚å¸¸å»ºè®®è‡ªè¡Œæ•è·ï¼Œå…¨å±€å¼‚å¸¸æœ€å¥½æ˜¯ç”¨äºå…œåº•ã€‚<br>2ã€ä¸è¦ç”Ÿåå¼‚å¸¸ã€‚<br>3ã€å°å¿ƒfinallyå¼‚å¸¸è¦†ç›–ï¼Œå¯èƒ½ä¼šå¯¼è‡´ä½ å¯¹é—®é¢˜çš„è¯¯åˆ¤ï¼Œå¯ä»¥ä½¿ç”¨try-with-resourcesç ´è§£ï¼Œtry-with-resourcesä¼šsuppressedfinallyä¸­çš„å¼‚å¸¸ã€‚<br>4ã€å¼‚å¸¸æ ˆæ˜¯è·Ÿæ®å½“å‰ä¸Šä¸‹æ–‡ç”Ÿæˆï¼Œä¸å¯ç”¨staticå®šä¹‰å¼‚å¸¸ï¼Œå¦åˆ™ä¼šå¯¼è‡´å¼‚å¸¸æ ˆå›ºåŒ–ï¼Œä»è€Œå½±å“é—®é¢˜å®šä½ï¼ˆè®¤ä¸ºæ˜¯èµ°åˆ°å…¶ä»–åˆ†æ”¯äº†ï¼‰ã€‚<br>5ã€çº¿ç¨‹æ± executeæŠ›å¼‚å¸¸å¦‚æœä¸å¤„ç†ï¼Œä¼šå¯¼è‡´çº¿ç¨‹é€€å‡ºï¼Œç„¶åçº¿ç¨‹æ± æŒ‰coreçº¿ç¨‹æ•°æ®é‡å»ºç¼ºå¤±çš„çº¿ç¨‹ã€‚å¦‚æœä¸€ç›´æŠ›å¼‚å¸¸å¯¼è‡´é‡å»ºï¼Œé‚£çº¿ç¨‹æ± è·Ÿæœ¬å°±èµ·ä¸åˆ°çº¿æ± é‡ç”¨çš„ä½œç”¨ã€‚submitæŠ›å¼‚å¸¸å¦‚æœä¸å¤„ç†ï¼Œä¼šè¢«ç”Ÿåï¼Œgetæ—¶å¯ä»¥æ•è·åˆ°å¼‚å¸¸ã€‚<br><br>é—®é¢˜ï¼š<br>1ã€finally returnä¼šè¦†ç›–returnç»“æœï¼Œå› ä¸ºä¼šé‡å†™ä¸€æ¬¡æ ˆè¿”å›åœ°å€çš„å€¼ã€‚<br>2ã€ç²¾ç¡®çš„å¼‚å¸¸èƒ½æ–¹ä¾¿å®šä½é—®é¢˜ã€‚","like_count":0},{"had_liked":false,"id":245441,"user_name":"Geek_fe5e8a","can_delete":false,"product_type":"c1","uid":2103563,"ip_address":"","ucode":"B4CC300397BD6A","user_header":"https://thirdwx.qlogo.cn/mmopen/vi_32/dgox0m94vr6w2Vxk0N6651pyL5wKWicqgwIxU9iahlIn5LKeFfQJDjzUoQKM8WNibS7Yuxyulmic1Xxfia5ibFc6ia0Hw/132","comment_is_top":false,"comment_ctime":1598945861,"is_pvip":false,"replies":[{"id":"90346","content":"å¯ä»¥çœ‹ä¸‹å®˜ç½‘çš„ä»‹ç»ï¼Œä¸“æ æ˜¯è¯´å‘ç‚¹çš„ï¼Œå¹¶ä¸æ˜¯ä»‹ç»å„ç§çŸ¥è¯†ç‚¹","user_name":"ä½œè€…å›å¤","user_name_real":"æœ±æ™”","uid":"1001470","ctime":1599019456,"ip_address":"","comment_id":245441,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1598945861","product_id":100047701,"comment_content":"è€å¸ˆèƒ½ä¸èƒ½è®²è®²lombokçš„æ³¨è§£@SneakyThrows ","like_count":0,"discussions":[{"author":{"id":1001470,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/47/fe/d0e25d57.jpg","nickname":"æœ±æ™”","note":"","ucode":"0B7F0BADE6AAB8","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":504880,"discussion_content":"å¯ä»¥çœ‹ä¸‹å®˜ç½‘çš„ä»‹ç»ï¼Œä¸“æ æ˜¯è¯´å‘ç‚¹çš„ï¼Œå¹¶ä¸æ˜¯ä»‹ç»å„ç§çŸ¥è¯†ç‚¹","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1599019456,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":241446,"user_name":"æå’Œæ¡ƒ","can_delete":false,"product_type":"c1","uid":1015877,"ip_address":"","ucode":"97E66953070EE0","user_header":"https://static001.geekbang.org/account/avatar/00/0f/80/45/d719f7df.jpg","comment_is_top":false,"comment_ctime":1597298190,"is_pvip":false,"discussion_count":1,"race_medal":0,"score":"1597298190","product_id":100047701,"comment_content":"1ã€ä»¥finallyçš„è¿”å›å€¼ä¸ºå‡†ã€‚æ­¤å¤„å¼•å‡ºå¦ä¸€ä¸ªå¼‚å¸¸ç‚¹ï¼Œåœ¨tryé‡Œé¢è¿”å›çš„å€¼åœ¨finallyä¸­è¢«ä¿®æ”¹ï¼Œè¿”å›çš„æ˜¯tryä¸­çš„ç»“æœè¿˜æ˜¯finallyçš„ï¼Ÿç­”æ¡ˆæ˜¯tryã€‚<br>2ã€å¼‚å¸¸ä½¿ç”¨å¦‚IllegalArgumentExceptionã€IllegalStateExceptionã€UnsupportedOperationExceptionæ˜¯ä¸ºäº†æ›´ç²¾ç»†åŒ–å¼‚å¸¸çš„ç±»å‹ã€‚å¦‚IllegalArgumentExceptionæ˜¯éæ³•å‚æ•°å¼‚å¸¸ï¼Œå¯ä»¥åœ¨æ ¡éªŒå‚æ•°æ—¶ä½¿ç”¨ã€‚IllegalStateExceptionå¯ä»¥åœ¨å½“å‰éæ­£å¸¸çŠ¶æ€ä¸‹æŠ›å‡ºã€‚UnsupportedOperationExceptionæ˜¯åœ¨ä¸æ”¯æŒæŸä¸ªæ“ä½œæ—¶æŠ›å‡ºï¼Œå¦‚Arrays.asList()çš„add\\removeç­‰æ–¹æ³•","like_count":0,"discussions":[{"author":{"id":1750549,"avatar":"https://static001.geekbang.org/account/avatar/00/1a/b6/15/e2cfd10d.jpg","nickname":"ImYoursÂ°","note":"","ucode":"51F653129034C9","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":376036,"discussion_content":"ä½ è¯´çš„ç¬¬ä¸€ä¸ªæ²¡æœ‰getåˆ°ï¼Œæœ‰ä¾‹å­è¯´æ˜å—ï¼Ÿ","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1621935359,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":235706,"user_name":"James","can_delete":false,"product_type":"c1","uid":1134861,"ip_address":"","ucode":"48B0F2A334D1C1","user_header":"https://static001.geekbang.org/account/avatar/00/11/51/0d/fc1652fe.jpg","comment_is_top":false,"comment_ctime":1595156196,"is_pvip":false,"discussion_count":1,"race_medal":0,"score":"1595156196","product_id":100047701,"comment_content":"æäº¤çº¿ç¨‹æ± çš„ä»»åŠ¡ä»£ç ä¸­ä½¿ç”¨åˆ°redissionä»£ç   new ThreadFactoryBuilder();<br>å¯ä»¥ä½¿ç”¨è‡ªå®šä¹‰å·¥å‚ç±»æ›¿æ¢<br>    class MySelfThreadFactory implements ThreadFactory {<br>        String namePrefix;<br>        AtomicInteger threadNumber = new AtomicInteger(1);<br><br>        public MySelfThreadFactory(String namePrefix){<br>            this.namePrefix = namePrefix;<br>        }<br>        @Override<br>        public Thread newThread(Runnable r) {<br>            Thread t = new Thread(r, namePrefix + threadNumber.getAndIncrement());<br>            return t;<br>        }<br>    }<br>","like_count":0,"discussions":[{"author":{"id":1461075,"avatar":"https://static001.geekbang.org/account/avatar/00/16/4b/53/f797f031.jpg","nickname":"æ— é“win","note":"","ucode":"0C026BB03A53EA","race_medal":0,"user_type":1,"is_pvip":true},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":305193,"discussion_content":"GuavaåŒ…é‡Œé¢ä¹Ÿæœ‰è¿™ä¸ªbuilderçš„ï¼Œçœ‹apiä¸æ–‡ç« ä¸­ç”¨çš„ä¸€è‡´ã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1599813803,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":235700,"user_name":"James","can_delete":false,"product_type":"c1","uid":1134861,"ip_address":"","ucode":"48B0F2A334D1C1","user_header":"https://static001.geekbang.org/account/avatar/00/11/51/0d/fc1652fe.jpg","comment_is_top":false,"comment_ctime":1595153935,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1595153935","product_id":100047701,"comment_content":"ä¸ºå•¥æäº¤çº¿ç¨‹æ± çš„ä»»åŠ¡é‚£éƒ¨åˆ†ä»£ç éœ€è¦ç”¨åˆ°redis jaråŒ…çš„ä¸œè¥¿.<br>è¿˜å¾—å®‰è£…ä¸ªredis = =","like_count":0},{"had_liked":false,"id":235339,"user_name":"é’å±±","can_delete":false,"product_type":"c1","uid":1131070,"ip_address":"","ucode":"749BAD1834AC0F","user_header":"https://static001.geekbang.org/account/avatar/00/11/42/3e/1d9c257f.jpg","comment_is_top":false,"comment_ctime":1594978090,"is_pvip":false,"discussion_count":0,"race_medal":1,"score":"1594978090","product_id":100047701,"comment_content":"å…¶å®ä½¿ç”¨å…¨å±€æ•è·å¼‚å¸¸ï¼Œè½¬æ¢ä¸ºè‡ªå®šä¹‰å¼‚å¸¸ ä¸éœ€è¦JDK ä¸­çš„ä¸€äº›æ ‡å‡†å¼‚å¸¸å»æ“ä½œã€‚","like_count":0},{"had_liked":false,"id":232666,"user_name":"Geek_96815d","can_delete":false,"product_type":"c1","uid":2011773,"ip_address":"","ucode":"8D3CAF4AE9831A","user_header":"","comment_is_top":false,"comment_ctime":1594083589,"is_pvip":false,"replies":[{"id":"85903","content":"ç¨‹åºä¸­æ–­æ˜¯æŒ‡ï¼Ÿ","user_name":"ä½œè€…å›å¤","user_name_real":"æœ±æ™”","uid":"1001470","ctime":1594100203,"ip_address":"","comment_id":232666,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1594083589","product_id":100047701,"comment_content":"execute ä½¿ç”¨æ‰§è¡Œå‡ºç°å¼‚å¸¸ï¼Œç¨‹åºä¾ç„¶æ²¡æœ‰ä¸­æ–­","like_count":0,"discussions":[{"author":{"id":1001470,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/47/fe/d0e25d57.jpg","nickname":"æœ±æ™”","note":"","ucode":"0B7F0BADE6AAB8","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":500730,"discussion_content":"ç¨‹åºä¸­æ–­æ˜¯æŒ‡ï¼Ÿ","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1594100203,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":223796,"user_name":"Joker","can_delete":false,"product_type":"c1","uid":1156592,"ip_address":"","ucode":"126AF848001A1E","user_header":"https://static001.geekbang.org/account/avatar/00/11/a5/f0/8648c464.jpg","comment_is_top":false,"comment_ctime":1591182568,"is_pvip":false,"replies":[{"id":"82417","content":"1 æŠ›å‡ºå¼‚å¸¸éœ€è¦è®¾ç½®æ¶ˆæ¯ 2 ä¸å»ºè®®æ•è·èŒƒå›´è¿™ä¹ˆå¤§çš„å¼‚å¸¸","user_name":"ä½œè€…å›å¤","user_name_real":"æœ±æ™”","uid":"1001470","ctime":1591188014,"ip_address":"","comment_id":223796,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1591182568","product_id":100047701,"comment_content":"   @GetMapping(&quot;wrong3&quot;)<br>    public void wrong3(@RequestParam(&quot;orderId&quot;) String orderId) {<br>        try {<br>            readFile();<br>        } catch (Exception e) {<br>            log.error(&quot;æ–‡ä»¶è¯»å–é”™è¯¯&quot;, e);<br>            throw new RuntimeException();<br>        }<br>    }<br><br>---<br>è€å¸ˆæˆ‘åœ¨é¡¹ç›®ä¸­å‘ç°è¿™ä¸ªä¹Ÿæ˜¯é”™çš„ï¼Œæ˜¯å› ä¸ºç”¨ `Exception` ä»£æ›¿äº†IOExceptionå—ï¼Ÿ<br>è¿˜æ˜¯å› ä¸ºæŠ›å‡ºå¼‚å¸¸ throw new RuntimeException() è¿™é‡Œæ²¡æœ‰ä»»ä½•æç¤ºæ¶ˆæ¯ï¼Œæ‰€ä»¥æ˜¯é”™è¯¯çš„ç”¨æ³•ï¼Ÿ","like_count":0,"discussions":[{"author":{"id":1001470,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/47/fe/d0e25d57.jpg","nickname":"æœ±æ™”","note":"","ucode":"0B7F0BADE6AAB8","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":497242,"discussion_content":"1 æŠ›å‡ºå¼‚å¸¸éœ€è¦è®¾ç½®æ¶ˆæ¯ 2 ä¸å»ºè®®æ•è·èŒƒå›´è¿™ä¹ˆå¤§çš„å¼‚å¸¸","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1591188014,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":218053,"user_name":"å¤©å¤©å‘ä¸Š","can_delete":false,"product_type":"c1","uid":1242455,"ip_address":"","ucode":"0CCCA6F4DCC480","user_header":"https://static001.geekbang.org/account/avatar/00/12/f5/57/ce10fb1b.jpg","comment_is_top":false,"comment_ctime":1589704790,"is_pvip":false,"replies":[{"id":"80654","content":"æ˜¯","user_name":"ä½œè€…å›å¤","user_name_real":"æœ±æ™”","uid":"1001470","ctime":1589716717,"ip_address":"","comment_id":218053,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1589704790","product_id":100047701,"comment_content":"è€å¸ˆï¼ŒæŠŠå¼‚å¸¸å®šä¹‰ä¸ºé™æ€å˜é‡åï¼ŒcancelOrderWrongçš„å¼‚å¸¸å †æ ˆå´æ˜¯createOrderWrongçš„ï¼Œæ˜¯å› ä¸ºcreateOrderWrongçš„å¼‚å¸¸ä¿¡æ¯æ˜¯å…ˆè°ƒç”¨çš„ï¼Œç”±äºå¼‚å¸¸æ˜¯staicçš„ï¼Œå¯¼è‡´ä¹‹åæ‰€æœ‰è¯¥å¼‚å¸¸å †æ ˆéƒ½æ˜¯createOrderWrongçš„å—ï¼Ÿ","like_count":0,"discussions":[{"author":{"id":1001470,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/47/fe/d0e25d57.jpg","nickname":"æœ±æ™”","note":"","ucode":"0B7F0BADE6AAB8","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":495336,"discussion_content":"æ˜¯","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1589716717,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":215555,"user_name":"Seven.Linæ¾¤è€¿","can_delete":false,"product_type":"c1","uid":1181192,"ip_address":"","ucode":"4CAB732CD6F149","user_header":"https://static001.geekbang.org/account/avatar/00/12/06/08/855abb02.jpg","comment_is_top":false,"comment_ctime":1589015681,"is_pvip":false,"replies":[{"id":"79794","content":"åå‘åº•å±‚çš„æœåŠ¡ä½¿ç”¨CEè¿˜æ˜¯æœ‰å¥½å¤„çš„ï¼Œè¿™ä¸ªè¿™æ˜¯ä¸€ä¸ªè¯­æ³•ï¼Œè¿˜æ˜¯çœ‹ç”¨çš„äººæ€ä¹ˆå»ç”¨å¥½ã€‚ä»»ä½•æŠ€æœ¯ï¼Œå¼ºç®¡æ§æœ‰å¼ºç®¡æ§çš„å¥½å¤„ï¼Œå¼±ç®¡æ§æœ‰å¼±ç®¡æ§çš„å¥½å¤„ï¼Œæ²¡æœ‰ç»å¯¹å¯¹é”™ã€‚","user_name":"ä½œè€…å›å¤","user_name_real":"æœ±æ™”","uid":"1001470","ctime":1589017523,"ip_address":"","comment_id":215555,"utype":1}],"discussion_count":2,"race_medal":0,"score":"1589015681","product_id":100047701,"comment_content":"è€å¸ˆï¼Œæˆ‘æƒ³è¯·å‡ä¸‹ä½ å¯¹Javaä¸­çš„Checked Exceptionå’ŒUnChecked Exceptionçš„çœ‹æ³•ï¼Ÿæˆ‘ä¸ªäººç¼–ç¨‹ä¹ æƒ¯ä¸Šä¸å–œæ¬¢ä½¿ç”¨Checked Exceptionï¼Œæˆ‘è®¤ä¸ºå¯¹ç¼–ç¨‹ä¸å‹å¥½ï¼Œè€Œä¸”æ— è®ºå‡ºç°ä»€ä¹ˆå¼‚å¸¸éƒ½æ˜¯å¯¹æ­£å¸¸çš„é€»è¾‘é€ æˆå½±å“ï¼Œå¥½åƒChecked Exceptionç›¸å¯¹äºUnChecked Exceptionæ²¡å•¥ä¼˜ç‚¹ï¼Œæœ‰çš„è¯ä¹Ÿå°±æ˜¯å‘Šè¯‰è°ƒç”¨è€…æœ‰å¼‚å¸¸è€Œå·²ï¼Œä½†æ˜¯å¼‚å¸¸è¿˜æ˜¯å¾—å¤„ç†==ã€","like_count":0,"discussions":[{"author":{"id":1001470,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/47/fe/d0e25d57.jpg","nickname":"æœ±æ™”","note":"","ucode":"0B7F0BADE6AAB8","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":494475,"discussion_content":"åå‘åº•å±‚çš„æœåŠ¡ä½¿ç”¨CEè¿˜æ˜¯æœ‰å¥½å¤„çš„ï¼Œè¿™ä¸ªè¿™æ˜¯ä¸€ä¸ªè¯­æ³•ï¼Œè¿˜æ˜¯çœ‹ç”¨çš„äººæ€ä¹ˆå»ç”¨å¥½ã€‚ä»»ä½•æŠ€æœ¯ï¼Œå¼ºç®¡æ§æœ‰å¼ºç®¡æ§çš„å¥½å¤„ï¼Œå¼±ç®¡æ§æœ‰å¼±ç®¡æ§çš„å¥½å¤„ï¼Œæ²¡æœ‰ç»å¯¹å¯¹é”™ã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1589017523,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1181192,"avatar":"https://static001.geekbang.org/account/avatar/00/12/06/08/855abb02.jpg","nickname":"Seven.Linæ¾¤è€¿","note":"","ucode":"4CAB732CD6F149","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":261878,"discussion_content":"å¤šè°¢è€å¸ˆï¼Œç¡®å®æ˜¯ï¼Œå­˜åœ¨å³æ˜¯åˆç†çš„ã€‚å„ä¸ªæ¡†æ¶ä¹Ÿæœ‰è‡ªå·±çš„é£æ ¼ï¼ŒSpringå°±æ¯”è¾ƒå¯¹ç¼–ç¨‹å‹å¥½ï¼Œä½¿ç”¨çš„æ¯”è¾ƒå¤šçš„UE","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1589017900,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":209570,"user_name":"yan_12345","can_delete":false,"product_type":"c1","uid":1904542,"ip_address":"","ucode":"7F2D3230C1621A","user_header":"http://thirdwx.qlogo.cn/mmopen/vi_32/t1IeXCJODYdTt2RPGqx2zDjVX4N1FrxCWqQFfico2wVfetel8vcQYax1ASJHagACzdGCiaUbzlbjjfwtZa5G5TSQ/132","comment_is_top":false,"comment_ctime":1587567335,"is_pvip":false,"replies":[{"id":"78216","content":"æŠŠåå‘äºåº•å±‚çš„å¼‚å¸¸è½¬æ¢ä¸ºé«˜å±‚å¼‚å¸¸ã€‚æ¢å¥è¯è¯´æŠŠåå‘äºå†…éƒ¨å¤„ç†è‡ªå·±æ‰èƒ½ç†è§£çš„å¼‚å¸¸è½¬æ¢ä¸ºä¸€ä¸ªå¤–éƒ¨å¯ä»¥ç†è§£çš„å¼‚å¸¸æŠ›å‡ºã€‚<br><br>å¼‚å¸¸æ˜¯å¦æœ‰ç”¨å’Œæ˜¯å¦æ˜¯å—æ£€å¼‚å¸¸æ²¡å…³ç³»ï¼Œç°åœ¨çœ‹æ¥å—æ£€å¼‚å¸¸çš„è®¾å®šä¸ä¸€å®šæ˜¯ä¸€ä¸ªæ­£ç¡®çš„è®¾è®¡ã€‚","user_name":"ä½œè€…å›å¤","user_name_real":"æœ±æ™”","uid":"1001470","ctime":1587599987,"ip_address":"","comment_id":209570,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1587567335","product_id":100047701,"comment_content":"è€å¸ˆï¼Œè¯·æ•™ä¸€ä¸ªé—®é¢˜ï¼Œåœ¨å¹³å¸¸çš„ä¸šåŠ¡ä»£ç å½“ä¸­ï¼Œçœ‹åˆ°åœ¨catchå¼‚å¸¸ä¹‹åï¼Œä¼šæŠ›å‡ºè¿è¡Œæ—¶å¼‚å¸¸RuntimeExceptionï¼Œè¿™ç§å¼‚å¸¸ä¸æ˜¯æ£€æŸ¥å¼‚å¸¸ï¼Œä¸éœ€è¦å¼ºåˆ¶æ•è·ï¼Œé‚£é‡æ–°æŠ›å‡ºè¿™ç§å¼‚å¸¸æœ‰ä»€ä¹ˆä½œç”¨ï¼Œ","like_count":0,"discussions":[{"author":{"id":1001470,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/47/fe/d0e25d57.jpg","nickname":"æœ±æ™”","note":"","ucode":"0B7F0BADE6AAB8","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":492834,"discussion_content":"æŠŠåå‘äºåº•å±‚çš„å¼‚å¸¸è½¬æ¢ä¸ºé«˜å±‚å¼‚å¸¸ã€‚æ¢å¥è¯è¯´æŠŠåå‘äºå†…éƒ¨å¤„ç†è‡ªå·±æ‰èƒ½ç†è§£çš„å¼‚å¸¸è½¬æ¢ä¸ºä¸€ä¸ªå¤–éƒ¨å¯ä»¥ç†è§£çš„å¼‚å¸¸æŠ›å‡ºã€‚\n\nå¼‚å¸¸æ˜¯å¦æœ‰ç”¨å’Œæ˜¯å¦æ˜¯å—æ£€å¼‚å¸¸æ²¡å…³ç³»ï¼Œç°åœ¨çœ‹æ¥å—æ£€å¼‚å¸¸çš„è®¾å®šä¸ä¸€å®šæ˜¯ä¸€ä¸ªæ­£ç¡®çš„è®¾è®¡ã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1587599987,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":208591,"user_name":"æ¢é“å±±","can_delete":false,"product_type":"c1","uid":1233214,"ip_address":"","ucode":"36249D99DD8D5D","user_header":"https://static001.geekbang.org/account/avatar/00/12/d1/3e/77c6ba5e.jpg","comment_is_top":false,"comment_ctime":1587387638,"is_pvip":false,"replies":[{"id":"77933","content":"ä¸å¤ªæ˜ç™½ä½ çš„é—®é¢˜ï¼Œâ€œå¦‚æœ MbeUserproduct è¿™ä¸ªå®ä½“ä¸­çš„å±æ€§æœ‰@NotNull ç­‰æ³¨è§£ï¼Œé‚£ä¹ˆé€šè¿‡æ·»åŠ @Validå¯ä»¥åœ¨å…¨å±€å¼‚å¸¸ä¸­æ•è·åˆ°å±æ€§å¼‚å¸¸ä¿¡æ¯ï¼ˆ400ï¼‰â€ è¿™ç§å¤„ç†æ–¹å¼æœ‰ä»€ä¹ˆé—®é¢˜å—ï¼Ÿ","user_name":"ä½œè€…å›å¤","user_name_real":"æœ±æ™”","uid":"1001470","ctime":1587388929,"ip_address":"","comment_id":208591,"utype":1}],"discussion_count":3,"race_medal":0,"score":"1587387638","product_id":100047701,"comment_content":"è€å¸ˆå¥½ï¼Œæˆ‘ä»¬é¡¹ç›®æ˜¯ç”¨SpringMVCçš„ï¼Œä¹Ÿæ˜¯ä½¿ç”¨ç»Ÿä¸€å¼‚å¸¸å¤„ç†ï¼Œåœ¨å®é™…é¡¹ç›®ä¸­é‡åˆ°äº†ä¸ªæ¯”è¾ƒæ£˜æ‰‹çš„é—®é¢˜ã€‚RespEntity&lt;Map&lt;String, String&gt;&gt; create(@RequestBody @Valid Useproduct useproduct, HttpServletRequest request) throws Exception { ã€‚ã€‚ã€‚}  å¦‚æœ MbeUserproduct è¿™ä¸ªå®ä½“ä¸­çš„å±æ€§æœ‰@NotNull ç­‰æ³¨è§£ï¼Œé‚£ä¹ˆé€šè¿‡æ·»åŠ @Validå¯ä»¥åœ¨å…¨å±€å¼‚å¸¸ä¸­æ•è·åˆ°å±æ€§å¼‚å¸¸ä¿¡æ¯ï¼ˆ400ï¼‰ï¼›å¦‚æœå±æ€§ä¸­æ²¡æœ‰æ·»åŠ æ­¤ç±»çš„æ³¨è§£ï¼Œé‚£ä¹ˆå°±ä¸ä¼šè¿›å…¥å…¨å±€çš„å¼‚å¸¸å¤„ç†ç±»ä¸­ï¼Œå‰ç«¯è™½ç„¶ä¼šæ”¶åˆ°400çš„å“åº”çŠ¶æ€ï¼Œä½†æ˜¯æ²¡æœ‰å…·ä½“çš„é”™è¯¯ä¿¡æ¯ã€‚<br><br>è€å¸ˆï¼Œå¯¹äºè¿™ç±»é—®é¢˜è¯¥æ€ä¹ˆå¤„ç†ï¼","like_count":0,"discussions":[{"author":{"id":1001470,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/47/fe/d0e25d57.jpg","nickname":"æœ±æ™”","note":"","ucode":"0B7F0BADE6AAB8","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":492528,"discussion_content":"ä¸å¤ªæ˜ç™½ä½ çš„é—®é¢˜ï¼Œâ€œå¦‚æœ MbeUserproduct è¿™ä¸ªå®ä½“ä¸­çš„å±æ€§æœ‰@NotNull ç­‰æ³¨è§£ï¼Œé‚£ä¹ˆé€šè¿‡æ·»åŠ @Validå¯ä»¥åœ¨å…¨å±€å¼‚å¸¸ä¸­æ•è·åˆ°å±æ€§å¼‚å¸¸ä¿¡æ¯ï¼ˆ400ï¼‰â€ è¿™ç§å¤„ç†æ–¹å¼æœ‰ä»€ä¹ˆé—®é¢˜å—ï¼Ÿ","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1587388929,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1001470,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/47/fe/d0e25d57.jpg","nickname":"æœ±æ™”","note":"","ucode":"0B7F0BADE6AAB8","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":241229,"discussion_content":"æœ€å¥½è´´ä¸€ä¸‹å®Œæ•´ä»£ç ï¼Œç›´æ¥åœ¨åº•å±‚å°±æŠ›å‡ºçš„å¼‚å¸¸ï¼Œæ˜¯ä»€ä¹ˆå¼‚å¸¸å‘¢ï¼Ÿ","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1587396618,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1233214,"avatar":"https://static001.geekbang.org/account/avatar/00/12/d1/3e/77c6ba5e.jpg","nickname":"æ¢é“å±±","note":"","ucode":"36249D99DD8D5D","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":240881,"discussion_content":"å°±æ˜¯å®ä½“é‡Œé¢çš„å±æ€§å¦‚æœæ²¡æœ‰æ·»åŠ @NotNullç­‰æ³¨è§£çš„è¯ï¼Œé‚£ä¹ˆå¼‚å¸¸æ— æ³•åœ¨å…¨å±€å¼‚å¸¸ç±»é‡Œé¢æ•è·ï¼Œç›´æ¥åœ¨åº•å±‚å°±æŠ›å‡ºäº†","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1587390615,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":204953,"user_name":"Demon.Lee","can_delete":false,"product_type":"c1","uid":1052859,"ip_address":"","ucode":"7F0E5493A8E345","user_header":"https://static001.geekbang.org/account/avatar/00/10/10/bb/f1061601.jpg","comment_is_top":false,"comment_ctime":1586499333,"is_pvip":false,"replies":[{"id":"76596","content":"å°±åƒä½ æ–¹æ¡ˆä¸€è¯´çš„ï¼Œç†è®ºä¸Šå¦‚æœå¼‚å¸¸ã€DTOå’ŒAPIéƒ½å®šä¹‰åœ¨ä¸€ä¸ªjaråŒ…é‡Œé¢ï¼Œå®¢æˆ·ç«¯æœåŠ¡ç«¯å…±äº«ï¼Œé‚£ä¹ˆå®¢æˆ·ç«¯å®Œå…¨æ˜¯å¯ä»¥æŠ›å‡ºè¿™æ ·çš„è‡ªå®šä¹‰å¼‚å¸¸çš„ï¼Œdubboæˆ‘ä¸æ˜¯å¾ˆç†Ÿæ‚‰ï¼Œä½ å¯ä»¥ç ”ç©¶ä¸€ä¸‹ï¼Œæˆ‘è§‰å¾—dubboåº”è¯¥å¯ä»¥è‡ªåŠ¨å®ç°ï¼Œè€Œä¸æ˜¯éœ€è¦ä½ åœ¨ExceptionFilteré‡Œé¢è‡ªå·±å»è¿™ä¹ˆå®ç°ï¼ˆçœ‹ https:&#47;&#47;github.com&#47;apache&#47;dubbo&#47;blob&#47;47ee52d122fb6f0462ed99530cfe462c591feac8&#47;dubbo-rpc&#47;dubbo-rpc-api&#47;src&#47;main&#47;java&#47;org&#47;apache&#47;dubbo&#47;rpc&#47;filter&#47;ExceptionFilter.java ä¸­çš„ç¡®ä¹Ÿæ˜¯è¿™æ ·å®ç°çš„ï¼‰ã€‚<br><br>æˆ‘æ¯”è¾ƒå»ºè®®ä¸è¦ç»†åŒ–å®šä¹‰è¿™ä¹ˆå¤šæœåŠ¡ç«¯è‡ªå·±çš„å¼‚å¸¸ï¼Œå¯¹äºRPCåŒºåˆ†ä¸šåŠ¡å¼‚å¸¸å’Œç³»ç»Ÿå¼‚å¸¸è¶³å¤Ÿäº†ï¼Œå®šä¹‰ä¸¤ä¸ªå¤§ç±»å³å¯","user_name":"ä½œè€…å›å¤","user_name_real":"æœ±æ™”","uid":"1001470","ctime":1586504268,"ip_address":"","comment_id":204953,"utype":1}],"discussion_count":2,"race_medal":1,"score":"1586499333","product_id":100047701,"comment_content":"è€å¸ˆï¼Œå…³äºjavaå¾®æœåŠ¡ä¹‹é—´é€šè¿‡rpcè°ƒç”¨çš„å¼‚å¸¸å¤„ç†é—®é¢˜ï¼Œè¯·æ•™ä¸‹ï¼Œå…ˆè¯´å£°è°¢è°¢ã€‚<br>æˆ‘ä»¬ä½¿ç”¨äº†dubboä½œä¸ºrpcè°ƒç”¨çš„æ¡†æ¶ï¼Œä½†æ˜¯å¾®æœåŠ¡Aè°ƒç”¨å¾®æœåŠ¡Bæ—¶æŠ›å‡ºäº†ä¸šåŠ¡å¼‚å¸¸ï¼ˆæ¯”å¦‚xxxBusinessExceptionï¼‰ï¼Œ<br>è¿™äº›å¼‚å¸¸éƒ½æ˜¯å¾®æœåŠ¡Bè‡ªå®šä¹‰çš„ï¼ˆxxxBusinessException extends ApplicationExceptionï¼Œè€ŒApplicationExceptionæ˜¯extends RuntimeExceptionï¼‰ï¼Œ<br>ä½†æ˜¯è¿”å›åˆ°å¾®æœåŠ¡Aæ—¶ï¼Œéƒ½è¢«è½¬æˆäº†RuntimeExceptionã€‚ç»æŸ¥ï¼Œæ˜¯å› ä¸ºdubboæ¡†æ¶ä¸­é€šè¿‡ExceptionFilteræŠŠå¼‚å¸¸è¿›è¡Œäº†å¤„ç†ï¼Œé˜²æ­¢å®¢æˆ·ç«¯æ— æ³•è¯†åˆ«è€ŒæŠ¥é”™ã€‚<br>ä½†æ˜¯æˆ‘å…¶å®æƒ³è¦çš„æ˜¯è¿™äº›å¼‚å¸¸é‡Œé¢çš„errorCodeå’ŒerrorMsgï¼Œç°åœ¨éƒ½æ²¡æœ‰äº†ã€‚æˆ‘ç°åœ¨æœ‰ä¸¤ç§ä¼˜åŒ–æ€è·¯ï¼š<br>1. å¾®æœåŠ¡Aå’ŒBéƒ½ä¾èµ–è¿™ä¸ªApplicationExceptionï¼Œç„¶åé‡å†™dubboæ¡†æ¶ä¸­çš„ExceptionFilterï¼ŒæŠ›å‡ºApplicationExceptionï¼Œ<br>è¿™æ ·å¾®æœåŠ¡Aå°±å¯ä»¥é€šè¿‡è¿™ä¸ªå¼‚å¸¸è·å–åˆ°errorCodeå’ŒerrorMsgç­‰ä¿¡æ¯ï¼›<br>2. æŠŠRPCçš„è¿”å›ç»“æœç”±è¿”å›ä¸šåŠ¡DTOï¼Œæ”¹æˆè¿”å›ä¸€ä¸ªæ ‡å‡†çš„APIResponseï¼ˆå³{&quot;success&quot;: false, &quot;data&quot;: åŸæ¥çš„ä¸šåŠ¡DTOï¼Œ &quot;errorCode&quot;ï¼š1111, &quot;errorMsg&quot;: &quot;xxxx&quot;}ï¼‰;<br><br>è€å¸ˆè§‰å¾—å¦‚ä½•ï¼Œæœ‰ä»€ä¹ˆæ›´å¥½çš„è¡Œä¸šå®è·µä¹ˆ<br>","like_count":0,"discussions":[{"author":{"id":1001470,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/47/fe/d0e25d57.jpg","nickname":"æœ±æ™”","note":"","ucode":"0B7F0BADE6AAB8","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":491336,"discussion_content":"å°±åƒä½ æ–¹æ¡ˆä¸€è¯´çš„ï¼Œç†è®ºä¸Šå¦‚æœå¼‚å¸¸ã€DTOå’ŒAPIéƒ½å®šä¹‰åœ¨ä¸€ä¸ªjaråŒ…é‡Œé¢ï¼Œå®¢æˆ·ç«¯æœåŠ¡ç«¯å…±äº«ï¼Œé‚£ä¹ˆå®¢æˆ·ç«¯å®Œå…¨æ˜¯å¯ä»¥æŠ›å‡ºè¿™æ ·çš„è‡ªå®šä¹‰å¼‚å¸¸çš„ï¼Œdubboæˆ‘ä¸æ˜¯å¾ˆç†Ÿæ‚‰ï¼Œä½ å¯ä»¥ç ”ç©¶ä¸€ä¸‹ï¼Œæˆ‘è§‰å¾—dubboåº”è¯¥å¯ä»¥è‡ªåŠ¨å®ç°ï¼Œè€Œä¸æ˜¯éœ€è¦ä½ åœ¨ExceptionFilteré‡Œé¢è‡ªå·±å»è¿™ä¹ˆå®ç°ï¼ˆçœ‹ https://github.com/apache/dubbo/blob/47ee52d122fb6f0462ed99530cfe462c591feac8/dubbo-rpc/dubbo-rpc-api/src/main/java/org/apache/dubbo/rpc/filter/ExceptionFilter.java ä¸­çš„ç¡®ä¹Ÿæ˜¯è¿™æ ·å®ç°çš„ï¼‰ã€‚\n\næˆ‘æ¯”è¾ƒå»ºè®®ä¸è¦ç»†åŒ–å®šä¹‰è¿™ä¹ˆå¤šæœåŠ¡ç«¯è‡ªå·±çš„å¼‚å¸¸ï¼Œå¯¹äºRPCåŒºåˆ†ä¸šåŠ¡å¼‚å¸¸å’Œç³»ç»Ÿå¼‚å¸¸è¶³å¤Ÿäº†ï¼Œå®šä¹‰ä¸¤ä¸ªå¤§ç±»å³å¯","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1586504268,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1242455,"avatar":"https://static001.geekbang.org/account/avatar/00/12/f5/57/ce10fb1b.jpg","nickname":"å¤©å¤©å‘ä¸Š","note":"","ucode":"0CCCA6F4DCC480","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":267995,"discussion_content":"dubboçš„å¯¹å¤–æš´éœ²çš„æ¥å£ä¸Šå¦‚æœå£°æ˜äº†xxxBusinessExceptionå¼‚å¸¸ï¼Œé‚£ä¹ˆåœ¨è°ƒç”¨æ–¹å¼å¯ä»¥æ‹¿åˆ°è¿™ä¸ªçœŸå®çš„å¼‚å¸¸ä¿¡æ¯çš„ã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1589721487,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":204952,"user_name":"å¤§å¤§å¤§ç†Šmyeh","can_delete":false,"product_type":"c1","uid":1139413,"ip_address":"","ucode":"4832C2E7CEB151","user_header":"https://static001.geekbang.org/account/avatar/00/11/62/d5/1f5c5ab6.jpg","comment_is_top":false,"comment_ctime":1586499181,"is_pvip":false,"replies":[{"id":"76587","content":"ä½ çš„ç†è§£æ²¡é”™ï¼Œä¸è¿‡ï¼Œæ–‡ä¸­è´´å‡ºçš„ä»£ç éƒ¨åˆ†å·²ç»è¶³ä»¥è¯´æ˜é—®é¢˜<br><br>cancelOrder got error è¿™ä¸ªæç¤ºå¯¹åº”æ ˆä¸­çš„ PredefinedExceptionController.createOrderWrongæ–¹æ³•ï¼Œå¯ä»¥çœ‹åˆ°é”™ä¹±<br><br>[14:05:25.782] [http-nio-45678-exec-1] [ERROR] [.c.e.d.PredefinedExceptionController:25  ] - cancelOrder got error<br>org.geekbang.time.commonmistakes.exception.demo2.BusinessException: è®¢å•å·²ç»å­˜åœ¨<br>  at org.geekbang.time.commonmistakes.exception.demo2.Exceptions.&lt;clinit&gt;(Exceptions.java:5)<br>  at org.geekbang.time.commonmistakes.exception.demo2.PredefinedExceptionController.createOrderWrong(PredefinedExceptionController.java:50)<br>  at org.geekbang.time.commonmistakes.exception.demo2.PredefinedExceptionController.wrong(PredefinedExceptionController.java:18)<br><br>ç•™è¨€åŒºè²Œä¼¼ä¸æ”¯æŒmd","user_name":"ä½œè€…å›å¤","user_name_real":"æœ±æ™”","uid":"1001470","ctime":1586503101,"ip_address":"","comment_id":204952,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1586499181","product_id":100047701,"comment_content":"å…³äºâ€œæŠŠå¼‚å¸¸å®šä¹‰ä¸ºé™æ€å˜é‡â€çš„é”™è¯¯ç¤ºä¾‹ï¼Œå»ºè®®æŠŠå †æ ˆè´´å…¨ï¼Œä¸è¦ä»…è´´ä¸‹åŠéƒ¨åˆ†ï¼Œå¯èƒ½æ˜¯æ°´å¹³åŸå› ï¼Œæˆ‘æ˜¯è¿è¡Œäº†ä¸€ä¸‹æ‚¨çš„ä»£ç æ‰ç†è§£åé¢çš„é‚£æ®µè§£é‡Šã€‚<br><br>å…¶å®æ‚¨æƒ³è¯´çš„æ˜¯ï¼Œå¦‚æœæŠŠå¼‚å¸¸å®šä¹‰ä¸ºé™æ€å˜é‡ï¼Œé‚£ä¹ˆä»¥åæ¯æ¬¡è°ƒç”¨è¿™ä¸ªé™æ€å˜é‡çš„å¼‚å¸¸ï¼Œå®ƒçš„å †æ ˆä¿¡æ¯éƒ½æ˜¯ç¬¬ä¸€æ¬¡è°ƒç”¨è¯¥å¼‚å¸¸æ—¶çš„å †æ ˆä¿¡æ¯ï¼Œä¼šå¼•èµ·æ’æŸ¥æ—¶çš„å¾ˆå¤§å›°éš¾ã€‚<br><br>ï¼ˆé¡ºä¾¿æµ‹è¯•ä¸€ä¸‹ç•™è¨€çš„markdownï¼‰<br><br>````java<br>14:06:35.916 [main] ERROR org.geekbang.time.commonmistakes.exception.predefinedexception.PredefinedExceptionController - createOrder got error<br>org.geekbang.time.commonmistakes.exception.predefinedexception.BusinessException: è®¢å•å·²ç»å­˜åœ¨<br>\tat org.geekbang.time.commonmistakes.exception.predefinedexception.Exceptions.&lt;clinit&gt;(Exceptions.java:5)<br>\tat org.geekbang.time.commonmistakes.exception.predefinedexception.PredefinedExceptionController.createOrderWrong(PredefinedExceptionController.java:56)<br>\tat org.geekbang.time.commonmistakes.exception.predefinedexception.PredefinedExceptionController.main(PredefinedExceptionController.java:29)<br>14:06:35.919 [main] ERROR org.geekbang.time.commonmistakes.exception.predefinedexception.PredefinedExceptionController - cancelOrder got error<br>org.geekbang.time.commonmistakes.exception.predefinedexception.BusinessException: è®¢å•å·²ç»å­˜åœ¨<br>\tat org.geekbang.time.commonmistakes.exception.predefinedexception.Exceptions.&lt;clinit&gt;(Exceptions.java:5)<br>\tat org.geekbang.time.commonmistakes.exception.predefinedexception.PredefinedExceptionController.createOrderWrong(PredefinedExceptionController.java:56)<br>\tat org.geekbang.time.commonmistakes.exception.predefinedexception.PredefinedExceptionController.main(PredefinedExceptionController.java:29)<br>````<br>","like_count":0,"discussions":[{"author":{"id":1001470,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/47/fe/d0e25d57.jpg","nickname":"æœ±æ™”","note":"","ucode":"0B7F0BADE6AAB8","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":491335,"discussion_content":"ä½ çš„ç†è§£æ²¡é”™ï¼Œä¸è¿‡ï¼Œæ–‡ä¸­è´´å‡ºçš„ä»£ç éƒ¨åˆ†å·²ç»è¶³ä»¥è¯´æ˜é—®é¢˜\n\ncancelOrder got error è¿™ä¸ªæç¤ºå¯¹åº”æ ˆä¸­çš„ PredefinedExceptionController.createOrderWrongæ–¹æ³•ï¼Œå¯ä»¥çœ‹åˆ°é”™ä¹±\n\n[14:05:25.782] [http-nio-45678-exec-1] [ERROR] [.c.e.d.PredefinedExceptionController:25  ] - cancelOrder got error\norg.geekbang.time.commonmistakes.exception.demo2.BusinessException: è®¢å•å·²ç»å­˜åœ¨\n  at org.geekbang.time.commonmistakes.exception.demo2.Exceptions.&amp;lt;clinit&amp;gt;(Exceptions.java:5)\n  at org.geekbang.time.commonmistakes.exception.demo2.PredefinedExceptionController.createOrderWrong(PredefinedExceptionController.java:50)\n  at org.geekbang.time.commonmistakes.exception.demo2.PredefinedExceptionController.wrong(PredefinedExceptionController.java:18)\n\nç•™è¨€åŒºè²Œä¼¼ä¸æ”¯æŒmd","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1586503101,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]}]}