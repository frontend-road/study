{"id":461718,"title":"19 | 实战痛点5：如何打包发布你的Vue 3应用？","content":"<p>你好，我是大圣。</p><p>在实战痛点4这一讲中，我们一起学习了Vue 3项目的性能优化策略。今天，我们来聊一下项目上线前的最后一步，就是如何把开发好的代码部署到线上。</p><p>对于这个问题，你可能脱口而出：“使用<code>npm run build</code>就好了呀”。这样做只是在本地把代码打包，如果想要在线上也可以访问这些代码，那么还需要加上部署的过程。所以在下面，我先给你介绍一下当前这个时代的前端代码在部署的时候，有哪些难点和问题需要处理。</p><h2>代码部署难点</h2><p>在jQuery时代之前，前端项目中所有的内容都是一些简单的静态资源。那个时候，网站还没有部署的概念，网站上线前，我们直接把开发完的项目打包发给运维，再由运维把代码直接上传到服务器的网站根目录下解压缩，这样就完成了项目的部署。</p><p>后来的jQuery时代，项目的入口页面被后端管理，模板部署到了后端，CSS、JavaScript和图片等静态资源依然是打包到后端之后，再解压处理。但现在，我们对前端的性能和稳定性的要求也越来越高，jQuery时代的那种简单的部署模式就不足以应对性能优化、持续部署等一系列的情境。</p><p>现在前端所处的时代，我们主要会面临后面这些代码部署难点：首先是，如何高效地利用项目中的文件缓存；然后是，如何能够让整个项目的上线部署过程自动化，尽可能避免人力的介入，从而提高上线的稳定性；最后，项目上线之后，如果发现有重大Bug，我们就要考虑如何尽快回滚代码。</p><!-- [[[read_end]]] --><p>当我们面对这些代码部署上的难点，特别是在团队协作的项目中遇到时，我们就可以考虑对项目进行自动化部署了，这样代码部署的速度和稳定性会给项目研发效率带来很好的提升。</p><h2>项目上线前的自动化部署</h2><p>下图所示的，是大部分团队部署项目时的逻辑 。实际上，大部分前端开发者都会认为，完成图示中的打包压缩这一步，也就是开发完项目之后，代码推送到GitHub后，就算完成任务了。但是，打包代码之后，把代码上传服务器也是这一步，对于前端开发者来说，是很少能接触到，但却是很重要的一步。</p><p><img src=\"https://static001.geekbang.org/resource/image/45/a9/4565abf4f599cc187d65d421d3cb8ba9.jpg?wh=1800x758\" alt=\"图片\"></p><p>所以，对于如何把打包好的代码上传到服务器这个问题，就值得我们去好好探究，琢磨出一个好的解决方案。</p><p>首先，我们需要一台独立的机器去进行打包和构建的操作，这台机器需要独立于所有开发环境，这样做是为了保证打包环境的稳定；之后，在部署任务启动的时候，我们需要拉取远程的代码，并且切换到需要部署的分支，然后锁定Node版本进行依赖安装、单元测试、ESLint等代码检查工作；最后，在这台机器上，执行经过编译产出的打包后的代码，并打包上传代码到CDN和静态服务器。当然了，完成这些操作之后，还要能通过脚本自动通过内部沟通软件通知团队项目构建的结果。</p><p>但是在项目部署的过程中，迎面而来的可能是下面这些问题：在什么操作系统环境中执行项目的构建？由谁触发构建？如何管理前面所述的把代码上传CDN时，CDN账户的权限？如何自动化执行部署的全过程，如果每次都由人工执行，就得消耗一个人力守着编译打包了，而且较为容易引发问题，比如测试的步骤遗漏或部署顺序出错。那么如何提升构建速率，就成了部署功能中需要解决的重要问题。</p><p>为了解决上面这些问题，业界提出了一些解决方案：比如，采用能保证环境一致性的Docker；自动化构建触发可以通过GitHub Actions；GitHub的actions功能相当于给我们提供了一个免费的服务器，可以很方便地监控代码的推送、安装依赖、代码编译自动上传到服务器。</p><p><img src=\"https://static001.geekbang.org/resource/image/a7/dc/a7b8b0005f6003e91d17eb18149b9ddc.jpg?wh=2251x1206\" alt=\"\"></p><p>上图所展示的，就是我们使用了GitHub Actions部署项目之后的项目开发流程。现在静态资源管理已经完成，也实现了自动化部署。提交代码之后，我们的项目就可以自动推送到服务器，这样，网站的第一次上线也就算成功了。</p><h2>项目上线后的自动化部署</h2><p>前端项目的自动化部署完成后，我们可以保证上线的稳定性，但是后续的持续上线怎么办？直接发到生产环境，会面临极大的风险。但如果不直接发布到生产环境，我们就不能在本地和测试的前端环境去连接生产环境的数据库。</p><p>所以我们需要一个<strong>预发布的（Pre）环境</strong>，这个环境只能让测试和开发人员访问，除了访问地址的环节不同，其他所有环节都和生产环境保持一致，从而提供最真实的回归测试环境。</p><p>这个时候，我们会遇见下面这些问题，首先，如果我们确定项目下个版本在下周一零点发布，那我们就只能晚上12点准时守在电脑前，等待结果吗？如果npm安装依赖失败，或者上线后发现了重大Bug，那就只能迎接用户的吐槽吗？</p><p>其次，<strong>随着node_modules的体积越来越大，构建时间会越来越长</strong>。如果每次构建都需要30分钟甚至更长时间的话，那么，即使Bug是在项目刚上线时就发现的，并且你也秒级响应，并修复了Bug，但在重新部署项目时，我们也需要等服务器慢慢编译。这个时候，时间就是金钱，如果你在修复Bug和重新部署项目上，耗费了过多的时间，那么就会导致项目故障时间过长的问题。</p><p>为了解决上面说到的这些问题，我们需要一种机制，能够让我们在发现问题之后，尽快地将版本进行回滚，并且在回滚的操作过程中，尽可能不需要人力的介入。所以，我们需要静态资源的版本管理，具体来说，就是让每个历史版本的资源都能保留下来，并且有一个唯一的版本号，如果发生了故障，能够瞬间切换版本。这个过程由具体的代码实现之后，我们只需要点击回滚的版本号，系统就会自动恢复到上线前的版本。</p><p>在这种机制下，如果你的业务流量特别大，每秒都有大量用户访问和使用，那么直接全量上线的操作就会被禁止。为了减少上线时，部署操作对用户造成的影响，我们需要先选择一部分用户去做灰度测试，也就是说，上线后的项目的访问权限，暂时只对这些用户开放。或者，你也可以做一些AB测试，比如给北京的同学推送Vue课，给上海的同学推荐React课等等。我们需要做的，就是把不同版本的代码分开打包，互不干涉。之后，我们再设计部署的机器和机房去适配不同的用户。</p><p>在Gtihub中，我们可以使用actions去配置打包的功能，下面的代码是actions的配置文件。在这个配置文件中，我们使用Ubuntu作为服务器的打包环境，然后拉取GitHub中最新的master分支代码，并且把Node版本固定为14.7.6，执行npm install安装代码所需依赖后，再执行npm run build进行代码打包压缩。在下面的代码中，我们就通过GitHub Actions自动化打包了一份准备上线的代码。</p><pre><code class=\"language-json\">name: 打包应用的actions\non:\n&nbsp; push: # 监听代码时间\n&nbsp; &nbsp; branches:\n&nbsp; &nbsp; &nbsp; - master  # master分支代码推送的时候激活当前action\njobs:\n&nbsp; build:\n&nbsp; &nbsp; # runs-on 操作系统\n&nbsp; &nbsp; runs-on: ubuntu-latest\n&nbsp; &nbsp; steps:\n&nbsp; &nbsp; &nbsp; - name: 迁出代码\n&nbsp; &nbsp; &nbsp; &nbsp; uses: actions/checkout@master\n&nbsp; &nbsp; &nbsp; # 安装Node\n&nbsp; &nbsp; &nbsp; - name: 安装Node\n&nbsp; &nbsp; &nbsp; &nbsp; uses: actions/setup-node@v1\n&nbsp; &nbsp; &nbsp; &nbsp; with:\n&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; node-version: 14.7.6\n&nbsp; &nbsp; &nbsp; # 安装依赖\n&nbsp; &nbsp; &nbsp; - name: 安装依赖\n&nbsp; &nbsp; &nbsp; &nbsp; run: npm install\n&nbsp; &nbsp; &nbsp; # 打包\n&nbsp; &nbsp; &nbsp; - name: 打包\n&nbsp; &nbsp; &nbsp; &nbsp; run: npm run build\n\n</code></pre><p>然后，我们需要配置上线服务器和GitHub Actions服务器的信任关系，通过SSH密钥可以实现免登录直接部署。我们直接把build之后的代码打包压缩，通过SSH直接上传到服务器上，并且要进行代码文件版本的管理，就完成了代码的部署。</p><p>最后一步，就是部署成功后的结果通知了。现在办公软件钉钉和飞书都提供了相关的推送结果，我们可以随时通过群机器人接口把消息推送到群内，关于钉钉机器人的适用文档，你直接看官方的<a href=\"https://developers.dingtalk.com/document/robots/custom-robot-access?spm=ding_open_doc.document.0.0.7f875e59yR79vi#topic-2026027\">开发文档</a>就可以了，我们需要做的是把版本号、部署日期、发起人等信息推送到对应接口，这样就完成了自动化部署的操作。</p><p>这一过程涉及服务器、钉钉开发文档、GitHub Actions，浏览器和本地代码环境多个场景的转换，这一讲我们先重点学习整体部署需要的思路和注意事项，实际的部署操作过程，你可以看这个视频的实操演示：</p><p><video poster=\"https://media001.geekbang.org/ed3b398d459c408fa94b201ea77df981/snapshots/dd5b06a466184dafbfd430c89ab80626-00005.jpg\" preload=\"none\" controls=\"\"><source src=\"https://media001.geekbang.org/customerTrans/7e27d07d27d407ebcc195a0e78395f55/439b1827-17f2a7b67d9-0000-0000-01d-dbacd.mp4\" type=\"video/mp4\"><source src=\" https://media001.geekbang.org/153349e6f74646e8a48a6d4c68ca71bb/db3f145c657346ad84ef883fe3ed191c-030f581fc35ef3d283ec34bfd950d657-sd.m3u8\" type=\"application/x-mpegURL\"></video></p><h2>总结</h2><p>今天的主要内容就讲完了，我们来总结一下今天学到的内容吧。首先，我们讲解了前端部署这一过程的难点，包括怎么处理缓存、怎么自动化部署等等。在部署上，我们需要尽可能减少人力的参与，做到整个过程都用代码可控。</p><p>之后，在前端自动化部署这一部分，我们着重讲到了代码的打包上传和项目的部署，其中需要你重点注意的是项目的部署。为了解决如何部署代码到线上这一问题，我们需要一个独立的部署系统，有了独立的部署系统之后，我们可以把整个部署上线的过程自动化。借助GitHub的Actions，我们可以很方便地使用actions自带的服务去进行发布环节的版本确认、依赖安装、代码打包和上传的工作。</p><h2>思考题</h2><p>最后留一个思考题吧，你现在负责的项目中，发布和部署这个流程里有哪些环节可以优化呢？欢迎在评论区留言讨论，我们下一讲再见！</p>","neighbors":{"left":{"article_title":"加餐01｜什么是好的项目？","id":460565},"right":{"article_title":"加餐02｜深入TypeScript","id":462533}},"comments":[{"had_liked":false,"id":324125,"user_name":"cwang","can_delete":false,"product_type":"c1","uid":1465246,"ip_address":"","ucode":"04CB9F4CA2CEAD","user_header":"https://static001.geekbang.org/account/avatar/00/16/5b/9e/a8dec12d.jpg","comment_is_top":false,"comment_ctime":1638318604,"is_pvip":false,"discussion_count":4,"race_medal":0,"score":"40293024268","product_id":100094401,"comment_content":"这节课得好好琢磨琢磨，因为就如大圣老师说的，项目上线部署很重要，但确实大家容易忽略的一面。有时候，我们辛苦开发，不就是最后上线给用户使用嘛，如果最后一个环节做不好，那前面的99步都是失败，且不被认可的。<br><br>我自己的项目打包经历，算是经历了这样的一个“草莽时代”。以前写.net的，views全在asp.net模板里面，然后mvc架构提供model和controller支持。最后通过服务器上的IIS完成项目入口设置，部署工作。<br><br>再后来，我转型大前端，就是大圣老师讲得，先本地项目打包，然后发给服务器管理员。他打包解压后通知我，我们在测试。<br><br>现在的这家公司，前端项目独立部署了，但依然是把自己负责的那块上传代码仓库，负责人审查代码后，再在远程服务器拉取最新分支代码，构建编译完成项目上线工作。<br><br>通过今天的讲解，我们的水平依然处于“草莽”时代呀！这就特别期待大圣老师的视频讲解了。🤙🤙🤙","like_count":9,"discussions":[{"author":{"id":1222886,"avatar":"https://static001.geekbang.org/account/avatar/00/12/a8/e6/54a24332.jpg","nickname":"peterpc","note":"","ucode":"48663EB8299D8A","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":536298,"discussion_content":"我也是.net逐步扩展到前端，现在是java .net vue k8s都得搞，卷的火热","likes_number":2,"is_delete":false,"is_hidden":false,"ctime":1638755258,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1489106,"avatar":"https://static001.geekbang.org/account/avatar/00/16/b8/d2/2819b016.jpg","nickname":"pyh","note":"","ucode":"D50D34084B31D3","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":540811,"discussion_content":"看来以前做.net 转前端的不少啊 。我也是.net转前端","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1640174786,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":2817674,"avatar":"https://static001.geekbang.org/account/avatar/00/2a/fe/8a/8b5f5a66.jpg","nickname":"下一个起跑点","note":"","ucode":"5EDC478AE4CBA2","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":539910,"discussion_content":"大圣老师有案例讲解吗？","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1639873138,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1465246,"avatar":"https://static001.geekbang.org/account/avatar/00/16/5b/9e/a8dec12d.jpg","nickname":"cwang","note":"","ucode":"04CB9F4CA2CEAD","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":536720,"discussion_content":"太多了，忙的过来不","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1638855818,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":324232,"user_name":"Whisper","can_delete":false,"product_type":"c1","uid":1035520,"ip_address":"","ucode":"E695519E18E413","user_header":"https://static001.geekbang.org/account/avatar/00/0f/cd/00/998ad719.jpg","comment_is_top":false,"comment_ctime":1638345123,"is_pvip":false,"discussion_count":2,"race_medal":0,"score":"27408148899","product_id":100094401,"comment_content":"只想说一句：买大圣的课太值了！期待后续录屏实操演示！","like_count":6,"discussions":[{"author":{"id":2893706,"avatar":"https://static001.geekbang.org/account/avatar/00/2c/27/8a/d65e34c4.jpg","nickname":"木子初秋","note":"","ucode":"6DDCB55232E1B3","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":551691,"discussion_content":"那真是大赞了","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1645083599,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1196402,"avatar":"https://static001.geekbang.org/account/avatar/00/12/41/72/ecc49429.jpg","nickname":"Danny1","note":"","ucode":"BBD581B38D8470","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":535881,"discussion_content":"我刚评论了 要是视频演示就好了  就听到后续会录成视频","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1638589732,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":325075,"user_name":"海贼刺客","can_delete":false,"product_type":"c1","uid":2363410,"ip_address":"","ucode":"FE1096272186D1","user_header":"https://thirdwx.qlogo.cn/mmopen/vi_32/ry20aMia1d7Tmtx0UiapibTuzmnzv3Ih5Sz2apEWSUlPC8lib0ic5oJsegEA9tZDoawrl1NdCryHohldyv9iaV5haviaw/132","comment_is_top":false,"comment_ctime":1638800291,"is_pvip":false,"replies":[{"id":"118326","content":"我最近赶稿子，赶完稿子我会录视频演示每一步的操作，最终实现github actions的自动化部署  , 我自己的个人项目也是用的这个方式来实现，感兴趣可以先看下这里actions配置<br>https:&#47;&#47;github.com&#47;shengxinjing&#47;it-roadmap&#47;tree&#47;main&#47;.github&#47;workflows","user_name":"作者回复","comment_id":325075,"uid":"1003715","ip_address":"","utype":1,"ctime":1639398220,"user_name_real":"编辑"}],"discussion_count":1,"race_medal":0,"score":"23113636771","product_id":100094401,"comment_content":"自动化部署在哪可以学","like_count":5,"discussions":[{"author":{"id":1003715,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/50/c3/0aa50246.jpg","nickname":"花果山大圣","note":"","ucode":"25C0A36D628037","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":538314,"discussion_content":"我最近赶稿子，赶完稿子我会录视频演示每一步的操作，最终实现github actions的自动化部署  , 我自己的个人项目也是用的这个方式来实现，感兴趣可以先看下这里actions配置\nhttps://github.com/shengxinjing/it-roadmap/tree/main/.github/workflows","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1639398220,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":328086,"user_name":"🍁","can_delete":false,"product_type":"c1","uid":1533237,"ip_address":"","ucode":"C3DBE6AEACA9F7","user_header":"https://static001.geekbang.org/account/avatar/00/17/65/35/92b0f8ef.jpg","comment_is_top":false,"comment_ctime":1640521914,"is_pvip":false,"replies":[{"id":"120870","content":"action是github自带的，gitlab有自己系统内类似的机制，还可以对接jenkins","user_name":"作者回复","comment_id":328086,"uid":"1003715","ip_address":"","utype":1,"ctime":1642342719,"user_name_real":"编辑"}],"discussion_count":4,"race_medal":0,"score":"10230456506","product_id":100094401,"comment_content":"老师，像actions这种部署，是不是只能用于个人项目。比如公司用gitlib还能用actions这种么","like_count":2,"discussions":[{"author":{"id":1003715,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/50/c3/0aa50246.jpg","nickname":"花果山大圣","note":"","ucode":"25C0A36D628037","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":546581,"discussion_content":"action是github自带的，gitlab有自己系统内类似的机制，还可以对接jenkins","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1642342719,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":2,"child_discussions":[{"author":{"id":1019807,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/8f/9f/e49b68ea.jpg","nickname":"幽弥狂","note":"","ucode":"5AECEA7D6ADF33","race_medal":0,"user_type":1,"is_pvip":true},"reply_author":{"id":1003715,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/50/c3/0aa50246.jpg","nickname":"花果山大圣","note":"","ucode":"25C0A36D628037","race_medal":0,"user_type":2,"is_pvip":false},"discussion":{"id":571420,"discussion_content":"我发现了你的 PH 书签，哈哈哈哈哈哈哈哈哈哈","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1652197998,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":546581,"ip_address":""},"score":571420,"extra":""},{"author":{"id":1019807,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/8f/9f/e49b68ea.jpg","nickname":"幽弥狂","note":"","ucode":"5AECEA7D6ADF33","race_medal":0,"user_type":1,"is_pvip":true},"reply_author":{"id":1003715,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/50/c3/0aa50246.jpg","nickname":"花果山大圣","note":"","ucode":"25C0A36D628037","race_medal":0,"user_type":2,"is_pvip":false},"discussion":{"id":571422,"discussion_content":"记得 COMMAND + SHIFT + B","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1652198051,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":546581,"ip_address":""},"score":571422,"extra":""}]},{"author":{"id":2358446,"avatar":"","nickname":"Geek_7426cf","note":"","ucode":"1A6A0E36CFA153","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":550143,"discussion_content":"gitlab + jenkins 很香 我们就是gitlab+jenkins+docker+k8s实现自动化部署","likes_number":1,"is_delete":false,"is_hidden":false,"ctime":1644393372,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":325405,"user_name":"T1M","can_delete":false,"product_type":"c1","uid":1089929,"ip_address":"","ucode":"0F152FE9A2BC10","user_header":"https://static001.geekbang.org/account/avatar/00/10/a1/89/3c865bd0.jpg","comment_is_top":false,"comment_ctime":1638947356,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"5933914652","product_id":100094401,"comment_content":"这一讲确实戳到了实战中项目上线问题的痛点。期待能看到更加详细的视频讲解。<br>","like_count":1},{"had_liked":false,"id":324100,"user_name":"哎哟迪奥","can_delete":false,"product_type":"c1","uid":1632501,"ip_address":"","ucode":"ED90376DD0279E","user_header":"https://static001.geekbang.org/account/avatar/00/18/e8/f5/d851eb46.jpg","comment_is_top":false,"comment_ctime":1638295621,"is_pvip":false,"replies":[{"id":"118359","content":"课程设计里主要会使用actions来做","user_name":"作者回复","comment_id":324100,"uid":"1003715","ip_address":"","utype":1,"ctime":1639400744,"user_name_real":"编辑"}],"discussion_count":1,"race_medal":0,"score":"5933262917","product_id":100094401,"comment_content":"搞个部署平台，一键部署，还能监控，比如jekins持续集成。","like_count":1,"discussions":[{"author":{"id":1003715,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/50/c3/0aa50246.jpg","nickname":"花果山大圣","note":"","ucode":"25C0A36D628037","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":538358,"discussion_content":"课程设计里主要会使用actions来做","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1639400744,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":351014,"user_name":"这个需求做不了","can_delete":false,"product_type":"c1","uid":1133464,"ip_address":"","ucode":"2BC0A306550D45","user_header":"https://static001.geekbang.org/account/avatar/00/11/4b/98/20ff3f6a.jpg","comment_is_top":false,"comment_ctime":1657453287,"is_pvip":true,"discussion_count":0,"race_medal":0,"score":"1657453287","product_id":100094401,"comment_content":"你们的项目部署在github上？？？vuecli的部署路径也没讲呢？？相对路径和绝对路径??","like_count":0},{"had_liked":false,"id":347742,"user_name":"MIKE LIU","can_delete":false,"product_type":"c1","uid":2859387,"ip_address":"","ucode":"ADD9672A6D7A80","user_header":"https://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTK2ibcQVCzwThRQWhAVVDHjiaaCOXqrYKC2qlM9iaAVrSZcpJmPAPBHoPiapG9pPYbjf4NtvNOVfrLOtw/132","comment_is_top":false,"comment_ctime":1654388762,"is_pvip":false,"discussion_count":1,"race_medal":0,"score":"1654388762","product_id":100094401,"comment_content":"老师，请教一下，怎么样能将访问github的方式快一些，本地配置了&#47;etc&#47;hosts文件对应的github地址，还是很慢哦。一定要翻墙吗","like_count":0,"discussions":[{"author":{"id":2338500,"avatar":"https://static001.geekbang.org/account/avatar/00/23/ae/c4/eafb9ba1.jpg","nickname":"长寿","note":"","ucode":"5FBDF9E65D2F3F","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":582059,"discussion_content":"建议科学上网，外面还是有很多一手资源的","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1659172144,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":"陕西"},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":347526,"user_name":"Geek_e2c59e","can_delete":false,"product_type":"c1","uid":2708942,"ip_address":"","ucode":"14B60545ABB9F4","user_header":"https://thirdwx.qlogo.cn/mmopen/vi_32/VzjUV1Io39wvVzLpdyF2ibIodS1JpTiaDKosSQSWDMgSjhxrWUSQYwUzK3cSeJW5Zz3zwLlDnyKcX1QAib9TCcvAw/132","comment_is_top":false,"comment_ctime":1654129514,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1654129514","product_id":100094401,"comment_content":"如何高效的利用项目中的文件缓存，似乎没有说","like_count":0},{"had_liked":false,"id":343674,"user_name":"YK菌","can_delete":false,"product_type":"c1","uid":2857882,"ip_address":"","ucode":"0D484DB48E854B","user_header":"https://static001.geekbang.org/account/avatar/00/2b/9b/9a/7c87614b.jpg","comment_is_top":false,"comment_ctime":1650978339,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1650978339","product_id":100094401,"comment_content":"收获满满~ 刚好最近也在用vuepress写博客，可以试试github actions的自动化部署了","like_count":0},{"had_liked":false,"id":334995,"user_name":"心若水，则长安","can_delete":false,"product_type":"c1","uid":1380860,"ip_address":"","ucode":"4D7AE6552A65A4","user_header":"https://static001.geekbang.org/account/avatar/00/15/11/fc/80256cc8.jpg","comment_is_top":false,"comment_ctime":1645246228,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1645246228","product_id":100094401,"comment_content":"这是一个公司体系性的问题，前端、后端、测试、运维等等都在这个体系中，作为一名普通开发者我们能做的很少，但也需要了解这个体系的结构以及适当给出优化建议","like_count":0},{"had_liked":false,"id":331567,"user_name":"夹克","can_delete":false,"product_type":"c1","uid":1232529,"ip_address":"","ucode":"1E7FE8AA25C3FC","user_header":"https://static001.geekbang.org/account/avatar/00/12/ce/91/3675b275.jpg","comment_is_top":false,"comment_ctime":1642657543,"is_pvip":true,"discussion_count":0,"race_medal":0,"score":"1642657543","product_id":100094401,"comment_content":"部署实际上并非是单一的前端范畴，而是一个项目级别的话题，不仅仅包括前端，还有后端，测试灰度等<br>推荐看看devops 流程，先了解大致的内功心法，然后结合实际项目的特点因地制宜的采取优化措施","like_count":0},{"had_liked":false,"id":326059,"user_name":"搁浅","can_delete":false,"product_type":"c1","uid":2785990,"ip_address":"","ucode":"30B90CCC572019","user_header":"https://static001.geekbang.org/account/avatar/00/2a/82/c6/983e6c13.jpg","comment_is_top":false,"comment_ctime":1639357948,"is_pvip":false,"replies":[{"id":"118307","content":"课程里暂时没设计nuxt的内容哈","user_name":"作者回复","comment_id":326059,"uid":"1003715","ip_address":"","utype":1,"ctime":1639396583,"user_name_real":"编辑"}],"discussion_count":1,"race_medal":0,"score":"1639357948","product_id":100094401,"comment_content":"大圣老师我只想说后面有没有nuxt.ha部署 因为这个好多坑呀！","like_count":0,"discussions":[{"author":{"id":1003715,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/50/c3/0aa50246.jpg","nickname":"花果山大圣","note":"","ucode":"25C0A36D628037","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":538291,"discussion_content":"课程里暂时没设计nuxt的内容哈","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1639396583,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":325929,"user_name":"Geek_bb9113","can_delete":false,"product_type":"c1","uid":2815754,"ip_address":"","ucode":"84D32DDBE4B086","user_header":"","comment_is_top":false,"comment_ctime":1639237551,"is_pvip":false,"replies":[{"id":"118311","content":"基于github actions自己也可以试试  ","user_name":"作者回复","comment_id":325929,"uid":"1003715","ip_address":"","utype":1,"ctime":1639396825,"user_name_real":"编辑"}],"discussion_count":1,"race_medal":0,"score":"1639237551","product_id":100094401,"comment_content":"项目部署的我自己是学习公司的，走的是阿里云的云效自动化部署，每次都是一键发布，感觉还是挺好的。","like_count":0,"discussions":[{"author":{"id":1003715,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/50/c3/0aa50246.jpg","nickname":"花果山大圣","note":"","ucode":"25C0A36D628037","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":538297,"discussion_content":"基于github actions自己也可以试试  ","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1639396825,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":325721,"user_name":"一块小砖头","can_delete":false,"product_type":"c1","uid":1848314,"ip_address":"","ucode":"4FA84F57FDEC18","user_header":"","comment_is_top":false,"comment_ctime":1639106552,"is_pvip":false,"replies":[{"id":"118314","content":"npm run build之后打包的内容，每个文件名的hash值就是用来处理缓存的，确保代码修改之后的文件名会修改","user_name":"作者回复","comment_id":325721,"uid":"1003715","ip_address":"","utype":1,"ctime":1639397011,"user_name_real":"编辑"}],"discussion_count":2,"race_medal":0,"score":"1639106552","product_id":100094401,"comment_content":"处理缓存  讲到了么？","like_count":0,"discussions":[{"author":{"id":1003715,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/50/c3/0aa50246.jpg","nickname":"花果山大圣","note":"","ucode":"25C0A36D628037","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":538300,"discussion_content":"npm run build之后打包的内容，每个文件名的hash值就是用来处理缓存的，确保代码修改之后的文件名会修改","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1639397011,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":1,"child_discussions":[{"author":{"id":1848314,"avatar":"","nickname":"一块小砖头","note":"","ucode":"4FA84F57FDEC18","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":1003715,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/50/c3/0aa50246.jpg","nickname":"花果山大圣","note":"","ucode":"25C0A36D628037","race_medal":0,"user_type":2,"is_pvip":false},"discussion":{"id":538301,"discussion_content":"了解","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1639397064,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":538300,"ip_address":""},"score":538301,"extra":""}]}]},{"had_liked":false,"id":324726,"user_name":"王大丫","can_delete":false,"product_type":"c1","uid":2120921,"ip_address":"","ucode":"8D440D8CE884E1","user_header":"https://static001.geekbang.org/account/avatar/00/20/5c/d9/f92794ed.jpg","comment_is_top":false,"comment_ctime":1638590050,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1638590050","product_id":100094401,"comment_content":"这种带文档讲解很清晰，讲的也很细致，期待后边的视屏。","like_count":0},{"had_liked":false,"id":324720,"user_name":"Danny1","can_delete":false,"product_type":"c1","uid":1196402,"ip_address":"","ucode":"BBD581B38D8470","user_header":"https://static001.geekbang.org/account/avatar/00/12/41/72/ecc49429.jpg","comment_is_top":false,"comment_ctime":1638589679,"is_pvip":false,"replies":[{"id":"118335","content":"这个赶完稿子我会录制的，使用actions配置去自动化部署","user_name":"作者回复","comment_id":324720,"uid":"1003715","ip_address":"","utype":1,"ctime":1639398721,"user_name_real":"编辑"}],"discussion_count":1,"race_medal":0,"score":"1638589679","product_id":100094401,"comment_content":"这一讲是视频操作演示就好了","like_count":0,"discussions":[{"author":{"id":1003715,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/50/c3/0aa50246.jpg","nickname":"花果山大圣","note":"","ucode":"25C0A36D628037","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":538325,"discussion_content":"这个赶完稿子我会录制的，使用actions配置去自动化部署","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1639398721,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":324668,"user_name":"于良骥","can_delete":false,"product_type":"c1","uid":1757371,"ip_address":"","ucode":"BB2FC8A10DFDAF","user_header":"https://static001.geekbang.org/account/avatar/00/1a/d0/bb/86e86d71.jpg","comment_is_top":false,"comment_ctime":1638532343,"is_pvip":false,"replies":[{"id":"118353","content":"新增一个scripts ：    &quot;build:dev&quot;: &quot;vue-tsc --noEmit &amp;&amp; vite build --mode=development&quot;,<br>这样就可以打包出一个可以用devtools的版本用来调试","user_name":"作者回复","comment_id":324668,"uid":"1003715","ip_address":"","utype":1,"ctime":1639400306,"user_name_real":"编辑"}],"discussion_count":2,"race_medal":0,"score":"1638532343","product_id":100094401,"comment_content":"大圣老师，vite打包之后生产环境报错应该怎么调试呢？","like_count":0,"discussions":[{"author":{"id":1003715,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/50/c3/0aa50246.jpg","nickname":"花果山大圣","note":"","ucode":"25C0A36D628037","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":538351,"discussion_content":"新增一个scripts ：    &#34;build:dev&#34;: &#34;vue-tsc --noEmit &amp;&amp; vite build --mode=development&#34;,\n这样就可以打包出一个可以用devtools的版本用来调试","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1639400307,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1023296,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/9d/40/c6568531.jpg","nickname":"帅迪","note":"","ucode":"19365E67027D34","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":549180,"discussion_content":"学习了","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1643696882,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":324297,"user_name":"Geek_d47f78","can_delete":false,"product_type":"c1","uid":2839286,"ip_address":"","ucode":"97445B933473DA","user_header":"","comment_is_top":false,"comment_ctime":1638363925,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1638363925","product_id":100094401,"comment_content":"平时工作中很少接触到，期待后面的视频","like_count":0},{"had_liked":false,"id":324171,"user_name":"醉月","can_delete":false,"product_type":"c1","uid":1375462,"ip_address":"","ucode":"530B4412FEDBE4","user_header":"https://static001.geekbang.org/account/avatar/00/14/fc/e6/2cff4a89.jpg","comment_is_top":false,"comment_ctime":1638325891,"is_pvip":false,"replies":[{"id":"118358","content":"后面会直接用视频发布，这一讲确实文字不好表达","user_name":"作者回复","comment_id":324171,"uid":"1003715","ip_address":"","utype":1,"ctime":1639400732,"user_name_real":"编辑"}],"discussion_count":1,"race_medal":0,"score":"1638325891","product_id":100094401,"comment_content":"又一节可以展开的课","like_count":0,"discussions":[{"author":{"id":1003715,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/50/c3/0aa50246.jpg","nickname":"花果山大圣","note":"","ucode":"25C0A36D628037","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":538357,"discussion_content":"后面会直接用视频发布，这一讲确实文字不好表达","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1639400732,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":324149,"user_name":"james","can_delete":false,"product_type":"c1","uid":1232771,"ip_address":"","ucode":"AC42035106E5B9","user_header":"http://thirdwx.qlogo.cn/mmopen/vi_32/yyibGRYCArsUNBfCAEAibua09Yb9D5AdO8TkCmXymhAepibqmlz0hzg06ggBLxyvXicnjqFVGr7zYF0rQoZ0aXCBAg/132","comment_is_top":false,"comment_ctime":1638322854,"is_pvip":false,"replies":[{"id":"118034","content":"其实最简单的方式就是打包也用esbuild，不过打包时间其实并不是核心痛点，不会影响研发效率","user_name":"作者回复","user_name_real":"编辑","uid":"1003715","ctime":1638882184,"ip_address":"","comment_id":324149,"utype":1}],"discussion_count":1,"race_medal":1,"score":"1638322854","product_id":100094401,"comment_content":"Vite 工程，生产环境打包耗时有点久（7～8分钟），老师有什么优化方案建议的吗？","like_count":0,"discussions":[{"author":{"id":1003715,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/50/c3/0aa50246.jpg","nickname":"花果山大圣","note":"","ucode":"25C0A36D628037","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":536845,"discussion_content":"其实最简单的方式就是打包也用esbuild，不过打包时间其实并不是核心痛点，不会影响研发效率","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1638882184,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":324123,"user_name":"轻度","can_delete":false,"product_type":"c1","uid":2822968,"ip_address":"","ucode":"B4FFCBE4C44158","user_header":"https://static001.geekbang.org/account/avatar/00/2b/13/38/fcd05270.jpg","comment_is_top":false,"comment_ctime":1638318163,"is_pvip":false,"replies":[{"id":"118361","content":"还没涉及到组件库的发布内部，这一部分写出来其实有点像官方文档","user_name":"作者回复","user_name_real":"编辑","uid":"1003715","ctime":1639400802,"ip_address":"","comment_id":324123,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1638318163","product_id":100094401,"comment_content":"又学到了许多，后面有没有关于怎么自己构建v3组件库并发布到npm相关的课程吗","like_count":0,"discussions":[{"author":{"id":1003715,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/50/c3/0aa50246.jpg","nickname":"花果山大圣","note":"","ucode":"25C0A36D628037","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":538360,"discussion_content":"还没涉及到组件库的发布内部，这一部分写出来其实有点像官方文档","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1639400802,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":324117,"user_name":"Johnson","can_delete":false,"product_type":"c1","uid":1326108,"ip_address":"","ucode":"C6B6FF9EA4CC60","user_header":"https://static001.geekbang.org/account/avatar/00/14/3c/1c/47e5b7aa.jpg","comment_is_top":false,"comment_ctime":1638315760,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1638315760","product_id":100094401,"comment_content":"这个确实是实战痛点，对于软件项目来说，能实现自动化部署和需要时回退，这个太重要了","like_count":0},{"had_liked":false,"id":324116,"user_name":"海阔天空","can_delete":false,"product_type":"c1","uid":1327016,"ip_address":"","ucode":"16C87A0052A08B","user_header":"https://static001.geekbang.org/account/avatar/00/14/3f/a8/8da58e53.jpg","comment_is_top":false,"comment_ctime":1638315519,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1638315519","product_id":100094401,"comment_content":"老师说得很好，不同版本的代码分开打包，互不干涉。我们现在的项目中也在逐步引用微前端技术。整合前端架构。","like_count":0},{"had_liked":false,"id":324111,"user_name":"费城的二鹏","can_delete":false,"product_type":"c1","uid":1101293,"ip_address":"","ucode":"DE768A0CC3053D","user_header":"https://static001.geekbang.org/account/avatar/00/10/cd/ed/825d84ee.jpg","comment_is_top":false,"comment_ctime":1638314183,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1638314183","product_id":100094401,"comment_content":"我们的部署只支持测试地址与生产地址，不支持泳道环境，也就不能针对特性分支进行测试。","like_count":0}]}