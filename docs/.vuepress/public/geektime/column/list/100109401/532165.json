{"id":532165,"title":"49｜RESTful Web Service（13）：如何Spike Sub-Resource Locator？","content":"<p>你好，我是徐昊。今天我们继续使用TDD的方式实现RESTful Web Services。</p><h2>回顾架构愿景与任务列表</h2><p>目前我们Spike得到的代码如下：</p><pre><code>static class Router implements ResourceRouter {\n    private Runtime runtime;        \n    private List&lt;Resource&gt; rootResources;\n        \n    public Router(Runtime runtime, List&lt;Resource&gt; rootResources) {\n        this.runtime = runtime;\n        this.rootResources = rootResources;\n    }\n\n    @Override\n    public OutboundResponse dispatch(HttpServletRequest request, ResourceContext resourceContext) {\n        ResourceMethod resourceMethod = rootResources.stream().map(root -&gt; root.matches(request.getServletPath(), new String[0], null))\n                .filter(Optional::isPresent).findFirst().get().get();\n        try {\n            GenericEntity entity = resourceMethod.call(resourceContext, null);;\n            return (OutboundResponse) Response.ok(entity).build();\n        } catch (Exception e) {\n            throw new RuntimeException(e);\n        }\n    }\n}\n</code></pre><h2>视频演示</h2><p>那么进入今天的环节：</p><p><video poster=\"https://media001.geekbang.org/f274055dda2247f090883cd26c4d397b/snapshots/7d2195da49e44a4ab505ccbf708c8f59-00005.jpg\" preload=\"none\" controls=\"\"><source src=\"https://media001.geekbang.org/customerTrans/7e27d07d27d407ebcc195a0e78395f55/2fd81cc1-18199e64c04-0000-0000-01d-dbacd.mp4\" type=\"video/mp4\"><source src=\" https://media001.geekbang.org/f308712601d94af5be933c472de143d5/8eb1e1eabe2646a18c951740b5aa944f-19129b2e2946ab5eb1ed0ea4ccaa71f5-sd.m3u8\" type=\"application/x-mpegURL\"></video></p><p>到此为止，我们完成了Spike的工作，目前的架构愿景为：</p><p><img src=\"https://static001.geekbang.org/resource/image/bf/65/bfec2474efc36df7230f839c2bce1f65.jpg?wh=1920x1080\" alt=\"\"></p><p><img src=\"https://static001.geekbang.org/resource/image/a5/d2/a5e7fyy80e85b80a482a8768281df6d2.jpg?wh=8000x4500\" alt=\"\"></p><h2>思考题</h2><p>在进入下节课之前，希望你能认真思考如下两个问题。</p><ol>\n<li>在当前架构愿景下，要如何分解任务？</li>\n<li>学到这里，你对我们的课程有什么建议或反馈吗？很想听听你的声音。</li>\n</ol><p>欢迎把你的想法分享在留言区，也欢迎把你的项目代码分享出来。相信经过你的思考与实操，学习效果会更好！</p><!-- [[[read_end]]] -->","neighbors":{"left":{"article_title":"48｜RESTful Web Services（12）：如何调整接口和架构愿景？","id":532164},"right":{"article_title":"50｜RESTful Web Services（14）：分解任务与Setup测试","id":535249}},"comments":[]}