{"id":76675,"title":"22 | ç­”ç–‘ï¼ˆä¸‰ï¼‰ï¼šæ–‡ä»¶ç³»ç»Ÿä¸ç£ç›˜çš„åŒºåˆ«æ˜¯ä»€ä¹ˆï¼Ÿ","content":"<p>ä½ å¥½ï¼Œæˆ‘æ˜¯å€ªæœ‹é£ã€‚</p><p>ä¸“æ æ›´æ–°è‡³ä»Šï¼Œå››å¤§åŸºç¡€æ¨¡å—çš„ç¬¬äºŒä¸ªæ¨¡å—â€”â€”å†…å­˜æ€§èƒ½ç¯‡ï¼Œæˆ‘ä»¬å°±å·²ç»å­¦å®Œäº†ã€‚å¾ˆå¼€å¿ƒä½ è¿˜æ²¡æœ‰æ‰é˜Ÿï¼Œä»ç„¶åœ¨ç§¯æå­¦ä¹ å’Œå®è·µæ“ä½œï¼Œå¹¶ä¸”çƒ­æƒ…åœ°ç•™è¨€ä¸è®¨è®ºã€‚</p><p>è¿™äº›ç•™è¨€ä¸­ï¼Œæˆ‘éå¸¸é«˜å…´çœ‹åˆ°ï¼Œå¾ˆå¤šåŒå­¦ç”¨å­¦è¿‡çš„æ¡ˆä¾‹æ€è·¯ï¼Œè§£å†³äº†å®é™…å·¥ä½œä¸­çš„æ€§èƒ½é—®é¢˜ã€‚æˆ‘ä¹Ÿéå¸¸æ„Ÿè°¢ espzestã€å¤§ç”œèœã€Smile ç­‰ç§¯ææ€è€ƒçš„åŒå­¦ï¼ŒæŒ‡å‡ºäº†æ–‡ç« ä¸­æŸäº›ä¸å½“æˆ–è€…ä¸ä¸¥è°¨çš„åœ°æ–¹ã€‚å¦å¤–ï¼Œè¿˜æœ‰æˆ‘æ¥ä¹Ÿã€JohnT3eã€ç™½åç­‰åŒå­¦ï¼Œç§¯æåœ¨ç•™è¨€åŒºè®¨è®ºå­¦ä¹ å’Œå®è·µä¸­çš„é—®é¢˜ï¼Œä¹Ÿåˆ†äº«äº†å®è´µçš„ç»éªŒï¼Œåœ¨è¿™é‡Œä¹Ÿéå¸¸æ„Ÿè°¢ä½ ä»¬ã€‚</p><p>ä»Šå¤©æ˜¯æ€§èƒ½ä¼˜åŒ–çš„ç¬¬ä¸‰æœŸã€‚ç…§ä¾‹ï¼Œæˆ‘ä»å†…å­˜æ¨¡å—çš„ç•™è¨€ä¸­æ‘˜å‡ºäº†ä¸€äº›å…¸å‹é—®é¢˜ï¼Œä½œä¸ºä»Šå¤©çš„ç­”ç–‘å†…å®¹ï¼Œé›†ä¸­å›å¤ã€‚ä¸ºäº†ä¾¿äºä½ å­¦ä¹ ç†è§£ï¼Œå®ƒä»¬å¹¶ä¸æ˜¯ä¸¥æ ¼æŒ‰ç…§æ–‡ç« é¡ºåºæ’åˆ—çš„ã€‚</p><p>æ¯ä¸ªé—®é¢˜ï¼Œæˆ‘éƒ½é™„ä¸Šäº†ç•™è¨€åŒºæé—®çš„æˆªå±ã€‚å¦‚æœä½ éœ€è¦å›é¡¾å†…å®¹åŸæ–‡ï¼Œå¯ä»¥æ‰«ææ¯ä¸ªé—®é¢˜å³ä¸‹æ–¹çš„äºŒç»´ç æŸ¥çœ‹ã€‚</p><h2>é—®é¢˜1ï¼šå†…å­˜å›æ”¶ä¸OOM</h2><p>è™è™çš„è¿™ä¸ªé—®é¢˜ï¼Œå®é™…ä¸ŠåŒ…æ‹¬å››ä¸ªå­é—®é¢˜ï¼Œå³ï¼Œ</p><ul>\n<li>\n<p>æ€ä¹ˆç†è§£ LRU å†…å­˜å›æ”¶ï¼Ÿ</p>\n</li>\n<li>\n<p>å›æ”¶åçš„å†…å­˜åˆåˆ°å“ªé‡Œå»äº†ï¼Ÿ</p>\n</li>\n<li>\n<p>OOM æ˜¯æŒ‰ç…§è™šæ‹Ÿå†…å­˜è¿˜æ˜¯å®é™…å†…å­˜æ¥æ‰“åˆ†ï¼Ÿ</p>\n</li>\n<li>\n<p>æ€ä¹ˆä¼°è®¡åº”ç”¨ç¨‹åºçš„æœ€å°å†…å­˜ï¼Ÿ</p>\n</li>\n</ul><p><img src=\"https://static001.geekbang.org/resource/image/90/36/905b15ee0df924038befe0e61ce81436.png?wh=900*1581\" alt=\"\"></p><p>å…¶å®åœ¨ Linux <a href=\"https://time.geekbang.org/column/article/74272\">å†…å­˜çš„åŸç†ç¯‡</a>å’Œ <a href=\"https://time.geekbang.org/column/article/75797\">Swap åŸç†ç¯‡</a>ä¸­æˆ‘æ›¾ç»è®²åˆ°ï¼Œä¸€æ—¦å‘ç°å†…å­˜ç´§å¼ ï¼Œç³»ç»Ÿä¼šé€šè¿‡ä¸‰ç§æ–¹å¼å›æ”¶å†…å­˜ã€‚æˆ‘ä»¬æ¥å¤ä¹ ä¸€ä¸‹ï¼Œè¿™ä¸‰ç§æ–¹å¼åˆ†åˆ«æ˜¯ ï¼š</p><!-- [[[read_end]]] --><ul>\n<li>\n<p>åŸºäº LRUï¼ˆLeast Recently Usedï¼‰ç®—æ³•ï¼Œå›æ”¶ç¼“å­˜ï¼›</p>\n</li>\n<li>\n<p>åŸºäº Swap æœºåˆ¶ï¼Œå›æ”¶ä¸å¸¸è®¿é—®çš„åŒ¿åé¡µï¼›</p>\n</li>\n<li>\n<p>åŸºäº OOMï¼ˆOut of Memoryï¼‰æœºåˆ¶ï¼Œæ€æ‰å ç”¨å¤§é‡å†…å­˜çš„è¿›ç¨‹ã€‚</p>\n</li>\n</ul><p>å‰ä¸¤ç§æ–¹å¼ï¼Œç¼“å­˜å›æ”¶å’Œ Swap å›æ”¶ï¼Œå®é™…ä¸Šéƒ½æ˜¯åŸºäº LRU ç®—æ³•ï¼Œä¹Ÿå°±æ˜¯ä¼˜å…ˆå›æ”¶ä¸å¸¸è®¿é—®çš„å†…å­˜ã€‚LRU å›æ”¶ç®—æ³•ï¼Œå®é™…ä¸Šç»´æŠ¤ç€ active å’Œ inactive ä¸¤ä¸ªåŒå‘é“¾è¡¨ï¼Œå…¶ä¸­ï¼š</p><ul>\n<li>\n<p>active è®°å½•æ´»è·ƒçš„å†…å­˜é¡µï¼›</p>\n</li>\n<li>\n<p>inactive è®°å½•éæ´»è·ƒçš„å†…å­˜é¡µã€‚</p>\n</li>\n</ul><p>è¶Šæ¥è¿‘é“¾è¡¨å°¾éƒ¨ï¼Œå°±è¡¨ç¤ºå†…å­˜é¡µè¶Šä¸å¸¸è®¿é—®ã€‚è¿™æ ·ï¼Œåœ¨å›æ”¶å†…å­˜æ—¶ï¼Œç³»ç»Ÿå°±å¯ä»¥æ ¹æ®æ´»è·ƒç¨‹åº¦ï¼Œä¼˜å…ˆå›æ”¶ä¸æ´»è·ƒçš„å†…å­˜ã€‚</p><p>æ´»è·ƒå’Œéæ´»è·ƒçš„å†…å­˜é¡µï¼ŒæŒ‰ç…§ç±»å‹çš„ä¸åŒï¼Œåˆåˆ†åˆ«åˆ†ä¸ºæ–‡ä»¶é¡µå’ŒåŒ¿åé¡µï¼Œå¯¹åº”ç€ç¼“å­˜å›æ”¶å’Œ Swap å›æ”¶ã€‚</p><p>å½“ç„¶ï¼Œä½ å¯ä»¥ä» /proc/meminfo ä¸­ï¼ŒæŸ¥è¯¢å®ƒä»¬çš„å¤§å°ï¼Œæ¯”å¦‚ï¼š</p><pre><code># grepè¡¨ç¤ºåªä¿ç•™åŒ…å«activeçš„æŒ‡æ ‡ï¼ˆå¿½ç•¥å¤§å°å†™ï¼‰\n# sortè¡¨ç¤ºæŒ‰ç…§å­—æ¯é¡ºåºæ’åº\n$ cat /proc/meminfo | grep -i active | sort\nActive(anon):     167976 kB\nActive(file):     971488 kB\nActive:          1139464 kB\nInactive(anon):      720 kB\nInactive(file):  2109536 kB\nInactive:        2110256 kB\n</code></pre><p>ç¬¬ä¸‰ç§æ–¹å¼ï¼ŒOOM æœºåˆ¶æŒ‰ç…§ oom_score ç»™è¿›ç¨‹æ’åºã€‚oom_score è¶Šå¤§ï¼Œè¿›ç¨‹å°±è¶Šå®¹æ˜“è¢«ç³»ç»Ÿæ€æ­»ã€‚</p><p>å½“ç³»ç»Ÿå‘ç°å†…å­˜ä¸è¶³ä»¥åˆ†é…æ–°çš„å†…å­˜è¯·æ±‚æ—¶ï¼Œå°±ä¼šå°è¯•<a href=\"https://time.geekbang.org/column/article/75797\">ç›´æ¥å†…å­˜å›æ”¶</a>ã€‚è¿™ç§æƒ…å†µä¸‹ï¼Œå¦‚æœå›æ”¶å®Œæ–‡ä»¶é¡µå’ŒåŒ¿åé¡µåï¼Œå†…å­˜å¤Ÿç”¨äº†ï¼Œå½“ç„¶çš†å¤§æ¬¢å–œï¼ŒæŠŠå›æ”¶å›æ¥çš„å†…å­˜åˆ†é…ç»™è¿›ç¨‹å°±å¯ä»¥äº†ã€‚ä½†å¦‚æœå†…å­˜è¿˜æ˜¯ä¸è¶³ï¼ŒOOMå°±è¦ç™»åœºäº†ã€‚</p><p>OOM å‘ç”Ÿæ—¶ï¼Œä½ å¯ä»¥åœ¨ dmesg ä¸­çœ‹åˆ° Out of memory çš„ä¿¡æ¯ï¼Œä»è€ŒçŸ¥é“æ˜¯å“ªäº›è¿›ç¨‹è¢« OOM æ€æ­»äº†ã€‚æ¯”å¦‚ï¼Œä½ å¯ä»¥æ‰§è¡Œä¸‹é¢çš„å‘½ä»¤ï¼ŒæŸ¥è¯¢ OOM æ—¥å¿—ï¼š</p><pre><code>$ dmesg | grep -i &quot;Out of memory&quot;\nOut of memory: Kill process 9329 (java) score 321 or sacrifice child\n</code></pre><p>å½“ç„¶äº†ï¼Œå¦‚æœä½ ä¸å¸Œæœ›åº”ç”¨ç¨‹åºè¢« OOM æ€æ­»ï¼Œå¯ä»¥è°ƒæ•´è¿›ç¨‹çš„ oom_score_adjï¼Œå‡å° OOM åˆ†å€¼ï¼Œè¿›è€Œé™ä½è¢«æ€æ­»çš„æ¦‚ç‡ã€‚æˆ–è€…ï¼Œä½ è¿˜å¯ä»¥å¼€å¯å†…å­˜çš„ overcommitï¼Œå…è®¸è¿›ç¨‹ç”³è¯·è¶…è¿‡ç‰©ç†å†…å­˜çš„è™šæ‹Ÿå†…å­˜ï¼ˆè¿™å„¿å®é™…ä¸Šå‡è®¾çš„æ˜¯ï¼Œè¿›ç¨‹ä¸ä¼šç”¨å…‰ç”³è¯·åˆ°çš„è™šæ‹Ÿå†…å­˜ï¼‰ã€‚</p><p>è¿™ä¸‰ç§æ–¹å¼ï¼Œæˆ‘ä»¬å°±å¤ä¹ å®Œäº†ã€‚æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬å›åˆ°å¼€å§‹çš„å››ä¸ªé—®é¢˜ï¼Œç›¸ä¿¡ä½ è‡ªå·±å·²ç»æœ‰äº†ç­”æ¡ˆã€‚</p><ol>\n<li>\n<p>LRU ç®—æ³•çš„åŸç†åˆšæ‰å·²ç»æåˆ°äº†ï¼Œè¿™é‡Œä¸å†é‡å¤ã€‚</p>\n</li>\n<li>\n<p>å†…å­˜å›æ”¶åï¼Œä¼šè¢«é‡æ–°æ”¾åˆ°æœªä½¿ç”¨å†…å­˜ä¸­ã€‚è¿™æ ·ï¼Œæ–°çš„è¿›ç¨‹å°±å¯ä»¥è¯·æ±‚ã€ä½¿ç”¨å®ƒä»¬ã€‚</p>\n</li>\n<li>\n<p>OOM è§¦å‘çš„æ—¶æœºåŸºäºè™šæ‹Ÿå†…å­˜ã€‚æ¢å¥è¯è¯´ï¼Œè¿›ç¨‹åœ¨ç”³è¯·å†…å­˜æ—¶ï¼Œå¦‚æœç”³è¯·çš„è™šæ‹Ÿå†…å­˜åŠ ä¸ŠæœåŠ¡å™¨å®é™…å·²ç”¨çš„å†…å­˜ä¹‹å’Œï¼Œæ¯”æ€»çš„ç‰©ç†å†…å­˜è¿˜å¤§ï¼Œå°±ä¼šè§¦å‘ OOMã€‚</p>\n</li>\n<li>\n<p>è¦ç¡®å®šä¸€ä¸ªè¿›ç¨‹æˆ–è€…å®¹å™¨çš„æœ€å°å†…å­˜ï¼Œæœ€ç®€å•çš„æ–¹æ³•å°±æ˜¯è®©å®ƒè¿è¡Œèµ·æ¥ï¼Œå†é€šè¿‡ ps æˆ–è€… smap ï¼ŒæŸ¥çœ‹å®ƒçš„å†…å­˜ä½¿ç”¨æƒ…å†µã€‚ä¸è¿‡è¦æ³¨æ„ï¼Œè¿›ç¨‹åˆšå¯åŠ¨æ—¶ï¼Œå¯èƒ½è¿˜æ²¡å¼€å§‹å¤„ç†å®é™…ä¸šåŠ¡ï¼Œä¸€æ—¦å¼€å§‹å¤„ç†å®é™…ä¸šåŠ¡ï¼Œå°±ä¼šå ç”¨æ›´å¤šå†…å­˜ã€‚æ‰€ä»¥ï¼Œè¦è®°å¾—ç»™å†…å­˜ç•™ä¸€å®šçš„ä½™é‡ã€‚</p>\n</li>\n</ol><h2>é—®é¢˜2: æ–‡ä»¶ç³»ç»Ÿä¸ç£ç›˜çš„åŒºåˆ«</h2><p>æ–‡ä»¶ç³»ç»Ÿå’Œç£ç›˜çš„åŸç†ï¼Œæˆ‘å°†åœ¨ä¸‹ä¸€ä¸ªæ¨¡å—ä¸­è®²è§£ï¼Œå®ƒä»¬è·Ÿå†…å­˜çš„å…³ç³»ä¹Ÿååˆ†å¯†åˆ‡ã€‚ä¸è¿‡ï¼Œåœ¨å­¦ä¹ Buffer å’Œ Cache çš„åŸç†æ—¶ï¼Œæˆ‘æ›¾æåˆ°ï¼ŒBuffer ç”¨äºç£ç›˜ï¼Œè€Œ Cache ç”¨äºæ–‡ä»¶ã€‚å› æ­¤ï¼Œæœ‰ä¸å°‘åŒå­¦å›°æƒ‘äº†ï¼Œæ¯”å¦‚ JJ ç•™è¨€ä¸­çš„è¿™ä¸¤ä¸ªé—®é¢˜ã€‚</p><ul>\n<li>\n<p>è¯»å†™æ–‡ä»¶æœ€ç»ˆä¹Ÿæ˜¯è¯»å†™ç£ç›˜ï¼Œåˆ°åº•è¦æ€ä¹ˆåŒºåˆ†ï¼Œæ˜¯è¯»å†™æ–‡ä»¶è¿˜æ˜¯è¯»å†™ç£ç›˜å‘¢ï¼Ÿ</p>\n</li>\n<li>\n<p>è¯»å†™ç£ç›˜éš¾é“å¯ä»¥ä¸ç»è¿‡æ–‡ä»¶ç³»ç»Ÿå—ï¼Ÿ</p>\n</li>\n</ul><p><img src=\"https://static001.geekbang.org/resource/image/6a/b1/6ac5f2e0bf43098a3ba2d14f057eeeb1.png?wh=900*1050\" alt=\"\"></p><p>å¦‚æœä½ ä¹Ÿæœ‰ç›¸åŒçš„ç–‘é—®ï¼Œä¸»è¦è¿˜æ˜¯æ²¡ææ¸…æ¥šï¼Œç£ç›˜å’Œæ–‡ä»¶çš„åŒºåˆ«ã€‚æˆ‘åœ¨â€œ<a href=\"https://time.geekbang.org/column/article/74633\">æ€ä¹ˆç†è§£å†…å­˜ä¸­çš„Bufferå’ŒCache</a>â€æ–‡ç« çš„ç•™è¨€åŒºç®€å•å›å¤è¿‡ï¼Œä¸è¿‡æ‹…å¿ƒæœ‰åŒå­¦æ²¡æœ‰çœ‹åˆ°ï¼Œæ‰€ä»¥åœ¨è¿™é‡Œé‡æ–°è®²ä¸€ä¸‹ã€‚</p><p>ç£ç›˜æ˜¯ä¸€ä¸ªå­˜å‚¨è®¾å¤‡ï¼ˆç¡®åˆ‡åœ°è¯´æ˜¯å—è®¾å¤‡ï¼‰ï¼Œå¯ä»¥è¢«åˆ’åˆ†ä¸ºä¸åŒçš„ç£ç›˜åˆ†åŒºã€‚è€Œåœ¨ç£ç›˜æˆ–è€…ç£ç›˜åˆ†åŒºä¸Šï¼Œè¿˜å¯ä»¥å†åˆ›å»ºæ–‡ä»¶ç³»ç»Ÿï¼Œå¹¶æŒ‚è½½åˆ°ç³»ç»Ÿçš„æŸä¸ªç›®å½•ä¸­ã€‚è¿™æ ·ï¼Œç³»ç»Ÿå°±å¯ä»¥é€šè¿‡è¿™ä¸ªæŒ‚è½½ç›®å½•ï¼Œæ¥è¯»å†™æ–‡ä»¶ã€‚</p><p>æ¢å¥è¯è¯´ï¼Œç£ç›˜æ˜¯å­˜å‚¨æ•°æ®çš„å—è®¾å¤‡ï¼Œä¹Ÿæ˜¯æ–‡ä»¶ç³»ç»Ÿçš„è½½ä½“ã€‚æ‰€ä»¥ï¼Œæ–‡ä»¶ç³»ç»Ÿç¡®å®è¿˜æ˜¯è¦é€šè¿‡ç£ç›˜ï¼Œæ¥ä¿è¯æ•°æ®çš„æŒä¹…åŒ–å­˜å‚¨ã€‚</p><p>ä½ åœ¨å¾ˆå¤šåœ°æ–¹éƒ½ä¼šçœ‹åˆ°è¿™å¥è¯ï¼Œ Linux ä¸­ä¸€åˆ‡çš†æ–‡ä»¶ã€‚æ¢å¥è¯è¯´ï¼Œä½ å¯ä»¥é€šè¿‡ç›¸åŒçš„æ–‡ä»¶æ¥å£ï¼Œæ¥è®¿é—®ç£ç›˜å’Œæ–‡ä»¶ï¼ˆæ¯”å¦‚ openã€readã€writeã€close ç­‰ï¼‰ã€‚</p><ul>\n<li>\n<p>æˆ‘ä»¬é€šå¸¸è¯´çš„â€œæ–‡ä»¶â€ï¼Œå…¶å®æ˜¯æŒ‡æ™®é€šæ–‡ä»¶ã€‚</p>\n</li>\n<li>\n<p>è€Œç£ç›˜æˆ–è€…åˆ†åŒºï¼Œåˆ™æ˜¯æŒ‡å—è®¾å¤‡æ–‡ä»¶ã€‚</p>\n</li>\n</ul><p>ä½ å¯ä»¥æ‰§è¡Œ â€œls -l &lt;è·¯å¾„&gt;â€ æŸ¥çœ‹å®ƒä»¬çš„åŒºåˆ«ã€‚å¦‚æœä¸æ‡‚ls è¾“å‡ºçš„å«ä¹‰ï¼Œåˆ«å¿˜äº†manä¸€ä¸‹å°±å¯ä»¥ã€‚æ‰§è¡Œ man ls å‘½ä»¤ï¼Œä»¥åŠ info â€˜(coreutils) ls invocationâ€™ å‘½ä»¤ï¼Œå°±å¯ä»¥æŸ¥åˆ°äº†ã€‚</p><p>åœ¨è¯»å†™æ™®é€šæ–‡ä»¶æ—¶ï¼ŒI/O è¯·æ±‚ä¼šé¦–å…ˆç»è¿‡æ–‡ä»¶ç³»ç»Ÿï¼Œç„¶åç”±æ–‡ä»¶ç³»ç»Ÿè´Ÿè´£ï¼Œæ¥ä¸ç£ç›˜è¿›è¡Œäº¤äº’ã€‚è€Œåœ¨è¯»å†™å—è®¾å¤‡æ–‡ä»¶æ—¶ï¼Œä¼šè·³è¿‡æ–‡ä»¶ç³»ç»Ÿï¼Œç›´æ¥ä¸ç£ç›˜äº¤äº’ï¼Œä¹Ÿå°±æ˜¯æ‰€è°“çš„â€œè£¸I/Oâ€ã€‚</p><p>è¿™ä¸¤ç§è¯»å†™æ–¹å¼ä½¿ç”¨çš„ç¼“å­˜è‡ªç„¶ä¸åŒã€‚æ–‡ä»¶ç³»ç»Ÿç®¡ç†çš„ç¼“å­˜ï¼Œå…¶å®å°±æ˜¯ Cache çš„ä¸€éƒ¨åˆ†ã€‚è€Œè£¸ç£ç›˜çš„ç¼“å­˜ï¼Œç”¨çš„æ­£æ˜¯Bufferã€‚</p><p>æ›´å¤šå…³äºæ–‡ä»¶ç³»ç»Ÿã€ç£ç›˜ä»¥åŠ I/O çš„åŸç†ï¼Œä½ å…ˆä¸è¦ç€æ€¥ï¼Œå¾€åæˆ‘ä»¬éƒ½ä¼šè®²åˆ°ã€‚</p><h2>é—®é¢˜3: å¦‚ä½•ç»Ÿè®¡æ‰€æœ‰è¿›ç¨‹çš„ç‰©ç†å†…å­˜ä½¿ç”¨é‡</h2><p>è¿™å…¶å®æ˜¯ <a href=\"https://time.geekbang.org/column/article/74633\">æ€ä¹ˆç†è§£å†…å­˜ä¸­çš„Bufferå’ŒCache</a> çš„è¯¾åæ€è€ƒé¢˜ï¼Œæ— åè€å’ã€Griffinã€JohnT3e ç­‰å°‘æ•°å‡ ä¸ªåŒå­¦ï¼Œéƒ½ç»™å‡ºäº†ä¸€äº›æ€è·¯ã€‚</p><p>æ¯”å¦‚ï¼Œæ— åè€å’åŒå­¦çš„æ–¹æ³•ï¼Œæ˜¯æŠŠæ‰€æœ‰è¿›ç¨‹çš„ RSS å…¨éƒ¨ç´¯åŠ ï¼š</p><p><img src=\"https://static001.geekbang.org/resource/image/ba/64/baa48809addf1f7b4d7c280f4ce03764.png?wh=900*1713\" alt=\"\"></p><p>è¿™ç§æ–¹æ³•ï¼Œå®é™…ä¸Šå¯¼è‡´ä¸å°‘åœ°æ–¹ä¼šè¢«é‡å¤è®¡ç®—ã€‚RSS è¡¨ç¤ºå¸¸é©»å†…å­˜ï¼ŒæŠŠè¿›ç¨‹ç”¨åˆ°çš„å…±äº«å†…å­˜ä¹Ÿç®—äº†è¿›å»ã€‚æ‰€ä»¥ï¼Œç›´æ¥ç´¯åŠ ä¼šå¯¼è‡´å…±äº«å†…å­˜è¢«é‡å¤è®¡ç®—ï¼Œä¸èƒ½å¾—åˆ°å‡†ç¡®çš„ç­”æ¡ˆã€‚</p><p>ç•™è¨€ä¸­å¥½å‡ ä¸ªåŒå­¦çš„ç­”æ¡ˆéƒ½æœ‰ç±»ä¼¼é—®é¢˜ã€‚ä½ å¯ä»¥é‡æ–°æ£€æŸ¥ä¸€ä¸‹è‡ªå·±çš„æ–¹æ³•ï¼Œå¼„æ¸…æ¥šæ¯ä¸ªæŒ‡æ ‡çš„å®šä¹‰å’ŒåŸç†ï¼Œé˜²æ­¢é‡å¤è®¡ç®—ã€‚</p><p>å½“ç„¶ï¼Œä¹Ÿæœ‰åŒå­¦çš„æ€è·¯éå¸¸æ­£ç¡®ï¼Œæ¯”å¦‚ JohnT3e æåˆ°çš„ï¼Œè¿™ä¸ªé—®é¢˜çš„å…³é”®åœ¨äºç†è§£ PSS çš„å«ä¹‰ã€‚</p><p><img src=\"https://static001.geekbang.org/resource/image/f5/1c/f5c56462ba5c821de1454a9c021e0f1c.png?wh=900*1050\" alt=\"\"></p><p>ä½ å½“ç„¶å¯ä»¥é€šè¿‡ stackexchange ä¸Šçš„<a href=\"https://unix.stackexchange.com/questions/33381/getting-information-about-a-process-memory-usage-from-proc-pid-smaps\">é“¾æ¥</a>æ‰¾åˆ°ç­”æ¡ˆï¼Œä¸è¿‡ï¼Œæˆ‘è¿˜æ˜¯æ›´æ¨èï¼Œç›´æ¥æŸ¥ proc æ–‡ä»¶ç³»ç»Ÿçš„<a href=\"https://www.kernel.org/doc/Documentation/filesystems/proc.txt\">æ–‡æ¡£</a>ï¼š</p><blockquote>\n<p>The â€œproportional set sizeâ€ (PSS) of a process is the count of pages it has in memory, where each page is divided by the number of processes sharing <a href=\"http://it.%20So\">it. So</a> if a process has 1000 pages all to itself, and 1000 shared with one other process, its PSS will be 1500.</p>\n</blockquote><p>è¿™é‡Œæˆ‘ç®€å•è§£é‡Šä¸€ä¸‹ï¼Œæ¯ä¸ªè¿›ç¨‹çš„PSS ï¼Œæ˜¯æŒ‡æŠŠå…±äº«å†…å­˜å¹³åˆ†åˆ°å„ä¸ªè¿›ç¨‹åï¼Œå†åŠ ä¸Šè¿›ç¨‹æœ¬èº«çš„éå…±äº«å†…å­˜å¤§å°çš„å’Œã€‚</p><p>å°±åƒæ–‡æ¡£ä¸­çš„è¿™ä¸ªä¾‹å­ï¼Œä¸€ä¸ªè¿›ç¨‹çš„éå…±äº«å†…å­˜ä¸º  1000 é¡µï¼Œå®ƒå’Œå¦ä¸€ä¸ªè¿›ç¨‹çš„å…±äº«è¿›ç¨‹ä¹Ÿæ˜¯  1000 é¡µï¼Œé‚£ä¹ˆå®ƒçš„PSS=1000/2+1000=1500 é¡µã€‚</p><p>è¿™æ ·ï¼Œä½ å°±å¯ä»¥ç›´æ¥ç´¯åŠ  PSS ï¼Œä¸ç”¨æ‹…å¿ƒå…±äº«å†…å­˜é‡å¤è®¡ç®—çš„é—®é¢˜äº†ã€‚</p><p>æ¯”å¦‚ï¼Œä½ å¯ä»¥è¿è¡Œä¸‹é¢çš„å‘½ä»¤æ¥è®¡ç®—ï¼š</p><pre><code># ä½¿ç”¨grepæŸ¥æ‰¾PssæŒ‡æ ‡åï¼Œå†ç”¨awkè®¡ç®—ç´¯åŠ å€¼\n$ grep Pss /proc/[1-9]*/smaps | awk '{total+=$2}; END {printf &quot;%d kB\\n&quot;, total }'\n391266 kB\n</code></pre><h2>é—®é¢˜4: CentOSç³»ç»Ÿä¸­å¦‚ä½•å®‰è£… bcc-tools</h2><p>å¾ˆå¤šåŒå­¦ç•™è¨€è¯´ç”¨çš„æ˜¯ CentOS ç³»ç»Ÿã€‚è™½ç„¶æˆ‘åœ¨æ–‡ç« ä¸­ä¹Ÿç»™å‡ºäº†ä¸€ä¸ª<a href=\"https://github.com/iovisor/bcc/issues/462\">å‚è€ƒæ–‡æ¡£</a>ï¼Œä¸è¿‡ bcc-tools å·¥å…·å®‰è£…èµ·æ¥è¿˜æ˜¯æœ‰äº›å›°éš¾ã€‚</p><p>æ¯”å¦‚ç™½ååŒå­¦ç•™è¨€è¡¨ç¤ºï¼Œç½‘ç»œä¸Šçš„æ•™ç¨‹ä¸å¤ªå®Œæ•´ï¼Œæ­¥éª¤æœ‰äº›ä¹±ï¼š</p><p><img src=\"https://static001.geekbang.org/resource/image/03/91/036cde548f2455e3d80b6b1c50e33c91.png?wh=900*1050\" alt=\"\"></p><p>ä¸è¿‡ï¼Œç™½åå’Œæ¸¡æ¸¡é¸Ÿ_linuxåŒå­¦åœ¨æ¢ç´¢å®è·µåï¼Œç•™è¨€åˆ†äº«äº†ä»–ä»¬çš„ç»éªŒï¼Œæ„Ÿè°¢ä½ ä»¬çš„åˆ†äº«ã€‚</p><p><img src=\"https://static001.geekbang.org/resource/image/8b/17/8b80a335c3fa543226f42dcb2c506017.png?wh=900*1050\" alt=\"\"><img src=\"https://static001.geekbang.org/resource/image/f3/0d/f34b80fc9f7eefc928959bfb41ce590d.png?wh=900*2157\" alt=\"\"></p><p>åœ¨è¿™é‡Œï¼Œæˆ‘ä¹Ÿç»Ÿä¸€å›å¤ä¸€ä¸‹ï¼Œåœ¨ CentOS ä¸­å®‰è£… bcc-tools çš„æ­¥éª¤ã€‚ä»¥ CentOS 7 ä¸ºä¾‹ï¼Œæ•´ä¸ªå®‰è£…ä¸»è¦å¯ä»¥åˆ†ä¸¤æ­¥ã€‚</p><p>ç¬¬ä¸€æ­¥ï¼Œå‡çº§å†…æ ¸ã€‚ä½ å¯ä»¥è¿è¡Œä¸‹é¢çš„å‘½ä»¤æ¥æ“ä½œï¼š</p><pre><code># å‡çº§ç³»ç»Ÿ\nyum update -y\n\n# å®‰è£…ELRepo\nrpm --import https://www.elrepo.org/RPM-GPG-KEY-elrepo.org\nrpm -Uvh https://www.elrepo.org/elrepo-release-7.0-3.el7.elrepo.noarch.rpm\n\n# å®‰è£…æ–°å†…æ ¸\nyum remove -y kernel-headers kernel-tools kernel-tools-libs\nyum --enablerepo=&quot;elrepo-kernel&quot; install -y kernel-ml kernel-ml-devel kernel-ml-headers kernel-ml-tools kernel-ml-tools-libs kernel-ml-tools-libs-devel\n\n# æ›´æ–°Grubåé‡å¯\ngrub2-mkconfig -o /boot/grub2/grub.cfg\ngrub2-set-default 0\nreboot\n\n# é‡å¯åç¡®è®¤å†…æ ¸ç‰ˆæœ¬å·²å‡çº§ä¸º4.20.0-1.el7.elrepo.x86_64\nuname -r\n</code></pre><p>ç¬¬äºŒæ­¥ï¼Œå®‰è£… bcc-toolsï¼š</p><pre><code># å®‰è£…bcc-tools\nyum install -y bcc-tools\n\n# é…ç½®PATHè·¯å¾„\nexport PATH=$PATH:/usr/share/bcc/tools\n\n# éªŒè¯å®‰è£…æˆåŠŸ\ncachestat \n</code></pre><h2>é—®é¢˜5: å†…å­˜æ³„æ¼æ¡ˆä¾‹çš„ä¼˜åŒ–æ–¹æ³•</h2><p>è¿™æ˜¯æˆ‘åœ¨ <a href=\"https://time.geekbang.org/column/article/75670\">å†…å­˜æ³„æ¼äº†ï¼Œæˆ‘è¯¥å¦‚ä½•å®šä½å’Œå¤„ç†</a> ä¸­ç•™çš„ä¸€ä¸ªæ€è€ƒé¢˜ã€‚è¿™ä¸ªé—®é¢˜æ˜¯è¿™æ ·çš„ï¼š</p><p>åœ¨å†…å­˜æ³„æ¼æ¡ˆä¾‹çš„æœ€åï¼Œæˆ‘ä»¬é€šè¿‡å¢åŠ  free() è°ƒç”¨ï¼Œé‡Šæ”¾äº†å‡½æ•° fibonacci() åˆ†é…çš„å†…å­˜ï¼Œä¿®å¤äº†å†…å­˜æ³„æ¼çš„é—®é¢˜ã€‚å°±è¿™ä¸ªæ¡ˆä¾‹è€Œè¨€ï¼Œè¿˜æœ‰æ²¡æœ‰å…¶ä»–æ›´å¥½çš„ä¿®å¤æ–¹æ³•å‘¢ï¼Ÿ</p><p>å¾ˆå¤šåŒå­¦ç•™è¨€å†™ä¸‹äº†è‡ªå·±çš„æƒ³æ³•ï¼Œéƒ½å¾ˆä¸é”™ã€‚è¿™é‡Œï¼Œæˆ‘é‡ç‚¹è¡¨æ‰¬ä¸‹éƒ­æ±Ÿä¼ŸåŒå­¦ï¼Œä»–ç»™å‡ºçš„æ–¹æ³•éå¸¸å¥½ï¼š</p><p><img src=\"https://static001.geekbang.org/resource/image/75/e4/757c532b561d142306c435a57277cae4.png?wh=900*2112\" alt=\"\"></p><p>ä»–çš„æ€è·¯æ˜¯ä¸ç”¨åŠ¨æ€å†…å­˜åˆ†é…çš„æ–¹æ³•ï¼Œè€Œæ˜¯ç”¨æ•°ç»„æ¥æš‚å­˜è®¡ç®—ç»“æœã€‚è¿™æ ·å°±å¯ä»¥ç”±ç³»ç»Ÿè‡ªåŠ¨ç®¡ç†è¿™äº›æ ˆå†…å­˜ï¼Œä¹Ÿä¸å­˜åœ¨å†…å­˜æ³„æ¼çš„é—®é¢˜äº†ã€‚</p><p>è¿™ç§å‡å°‘åŠ¨æ€å†…å­˜åˆ†é…çš„æ€è·¯ï¼Œé™¤äº†å¯ä»¥è§£å†³å†…å­˜æ³„æ¼é—®é¢˜ï¼Œå…¶å®ä¹Ÿæ˜¯å¸¸ç”¨çš„å†…å­˜ä¼˜åŒ–æ–¹æ³•ã€‚æ¯”å¦‚ï¼Œåœ¨éœ€è¦å¤§é‡å†…å­˜çš„åœºæ™¯ä¸­ï¼Œä½ å°±å¯ä»¥è€ƒè™‘ç”¨æ ˆå†…å­˜ã€å†…å­˜æ± ã€HugePage ç­‰æ–¹æ³•ï¼Œæ¥ä¼˜åŒ–å†…å­˜çš„åˆ†é…å’Œç®¡ç†ã€‚</p><p>é™¤äº†è¿™äº”ä¸ªé—®é¢˜ï¼Œè¿˜æœ‰ä¸€ç‚¹æˆ‘ä¹Ÿæƒ³è¯´ä¸€ä¸‹ã€‚å¾ˆå¤šåŒå­¦åœ¨è¯´å·¥å…·çš„ç‰ˆæœ¬é—®é¢˜ï¼Œçš„ç¡®ï¼Œç”Ÿäº§ç¯å¢ƒä¸­çš„ Linux ç‰ˆæœ¬å¾€å¾€éƒ½æ¯”è¾ƒä½ï¼Œå¯¼è‡´å¾ˆå¤šæ–°å·¥å…·ä¸èƒ½åœ¨ç”Ÿäº§ç¯å¢ƒä¸­ç›´æ¥ä½¿ç”¨ã€‚</p><p>ä¸è¿‡ï¼Œè¿™å¹¶ä¸ä»£è¡¨æˆ‘ä»¬å°±æ— èƒ½ä¸ºåŠ›äº†ã€‚æ¯•ç«Ÿï¼Œç³»ç»Ÿçš„åŸç†éƒ½æ˜¯å¤§åŒå°å¼‚çš„ã€‚è¿™å…¶å®ä¹Ÿæ˜¯æˆ‘ä¸€ç›´å¼ºè°ƒçš„è§‚ç‚¹ã€‚</p><ul>\n<li>\n<p>åœ¨å­¦ä¹ æ—¶ï¼Œæœ€å¥½å…ˆç”¨æœ€æ–°çš„ç³»ç»Ÿå’Œå·¥å…·ï¼Œå®ƒä»¬å¯ä»¥ä¸ºä½ æä¾›æ›´ç®€å•ç›´è§‚çš„ç»“æœï¼Œå¸®ä½ æ›´å¥½çš„ç†è§£ç³»ç»Ÿçš„åŸç†ã€‚</p>\n</li>\n<li>\n<p>åœ¨ä½ æŒæ¡äº†è¿™äº›åŸç†åï¼Œå›è¿‡å¤´æ¥ï¼Œå†å»ç†è§£æ—§ç‰ˆæœ¬ç³»ç»Ÿä¸­çš„å·¥å…·å’ŒåŸç†ï¼Œä½ ä¼šå‘ç°ï¼Œå³ä¾¿æ—§ç‰ˆæœ¬ä¸­çš„å¾ˆå¤šå·¥å…·å¹¶ä¸æ˜¯é‚£ä¹ˆå¥½ç”¨ï¼Œä½†æ˜¯åŸç†å’ŒæŒ‡æ ‡æ˜¯ç±»ä¼¼çš„ï¼Œä½ ä¾ç„¶å¯ä»¥è½»æ¾æŒæ¡å®ƒä»¬çš„ä½¿ç”¨æ–¹æ³•ã€‚</p>\n</li>\n</ul><p>æœ€åï¼Œæ¬¢è¿ç»§ç»­åœ¨ç•™è¨€åŒºå†™ä¸‹ä½ çš„ç–‘é—®ï¼Œæˆ‘ä¼šæŒç»­ä¸æ–­åœ°è§£ç­”ã€‚æˆ‘çš„ç›®çš„ä¸å˜ï¼Œå¸Œæœ›å¯ä»¥å’Œä½ ä¸€èµ·ï¼ŒæŠŠæ–‡ç« çš„çŸ¥è¯†å˜æˆä½ çš„èƒ½åŠ›ï¼Œæˆ‘ä»¬ä¸ä»…ä»…åœ¨å®æˆ˜ä¸­æ¼”ç»ƒï¼Œä¹Ÿè¦åœ¨äº¤æµä¸­è¿›æ­¥ã€‚</p><p></p>","comments":[{"had_liked":false,"id":58068,"user_name":"ç™½å","can_delete":false,"product_type":"c1","uid":1315666,"ip_address":"","ucode":"FC9BACFCA6E8C1","user_header":"https://static001.geekbang.org/account/avatar/00/14/13/52/db1b01fc.jpg","comment_is_top":false,"comment_ctime":1546990133,"is_pvip":false,"replies":[{"id":"20987","content":"ğŸ˜Š k8såˆ«å¿˜äº†è®¾ç½®å¥½å†…å­˜èµ„æºçš„è¯·æ±‚å’Œé™åˆ¶","user_name":"ä½œè€…å›å¤","comment_id":58068,"uid":"1001282","ip_address":"","utype":1,"ctime":1547027505,"user_name_real":"å€ªæœ‹é£"}],"discussion_count":2,"race_medal":0,"score":"65971499573","product_id":100020901,"comment_content":"è‡ªå·±è·‘è™šæ‹Ÿæœºè·‘çš„k8så°é›†ç¾¤ï¼ŒnodeèŠ‚ç‚¹è·‘çš„é•œåƒå¤ªå¤šï¼Œå°±ç‰¹åˆ«å¡ï¼Œçœ‹é›†ç¾¤æƒ…å†µå‘ç°å¥½å¤špodéƒ½æ­»äº†ï¼Œçœ‹è™šæ‹Ÿæœºä¸Šé¢å°±å†™åˆ°oomè‡ªåŠ¨æ€è¿›ç¨‹äº†ï¼Œä»¥å‰ä»æ²¡é‡åˆ°è¿‡oomï¼Œè¿™æ¬¡ä¸€ä¸‹å°±çŸ¥é“æ€ä¹ˆå›äº‹äº†","like_count":15,"discussions":[{"author":{"id":1001282,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/47/42/5b55bd1a.jpg","nickname":"å€ªæœ‹é£","note":"","ucode":"F0FAC195CDE7AC","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":435889,"discussion_content":"ğŸ˜Š k8såˆ«å¿˜äº†è®¾ç½®å¥½å†…å­˜èµ„æºçš„è¯·æ±‚å’Œé™åˆ¶","likes_number":1,"is_delete":false,"is_hidden":false,"ctime":1547027505,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1302228,"avatar":"https://static001.geekbang.org/account/avatar/00/13/de/d4/b83c4185.jpg","nickname":"David.cui","note":"","ucode":"AB46F310403612","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":589394,"discussion_content":"BccæŠ˜è…¾ä¸€ä¸‹åˆæœ€ç»ˆæ²¡æœ‰æå®š","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1664807289,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":"æ²³åŒ—"},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":58972,"user_name":"wykkx","can_delete":false,"product_type":"c1","uid":1122358,"ip_address":"","ucode":"ABCDF49E7A95C8","user_header":"https://static001.geekbang.org/account/avatar/00/11/20/36/b3e2f1d5.jpg","comment_is_top":false,"comment_ctime":1547263143,"is_pvip":false,"replies":[{"id":"22295","content":"1.æ˜¯çš„ï¼›2. swapéƒ½æ»¡äº†ï¼Œè¯´æ˜å†…å­˜ä¹Ÿè€—å°½äº†å‘€ï¼Œè¿™æ—¶å€™å°±è¦OOMäº†","user_name":"ä½œè€…å›å¤","comment_id":58972,"uid":"1001282","ip_address":"","utype":1,"ctime":1548248182,"user_name_real":"å€ªæœ‹é£"}],"discussion_count":2,"race_medal":0,"score":"57381837991","product_id":100020901,"comment_content":"è€å¸ˆæ‚¨å¥½ï¼Œè¯·æ•™ä¸€ä¸ªé—®é¢˜ï¼Œæ‚¨è¯´åŒ¿åé¡µå›æ”¶æ˜¯ä½¿ç”¨swapæœºåˆ¶ï¼Œé‚£ä¹ˆè¿™é‡Œæœ‰å‡ ä¸ªé—®é¢˜ï¼šä¸€æ˜¯å¦‚æœæˆ‘çš„ç³»ç»Ÿä¸å¼€å¯swapï¼ˆç°åœ¨å¾ˆå¤šç³»ç»Ÿéƒ½æ˜¯ä¸å¼€å¯swapçš„ï¼Œå°¤å…¶æ˜¯webç±»åº”ç”¨ï¼Œä¸ºäº†æå‡å“åº”æ—¶é—´ï¼‰ï¼Œé‚£ä¹ˆåŒ¿åé¡µè¿˜æ€ä¹ˆå›æ”¶ï¼ŸäºŒæ˜¯å³ä½¿æˆ‘å¼€å¯äº†swapï¼ŒåŒ¿åé¡µè¢«æ”¾åˆ°äº†swapä¸Šï¼Œé‚£ä¹ˆswapæ˜¯å¦‚ä½•æ¸…ç†è¿™äº›åŒ¿åé¡µçš„ï¼Œæ€»ä¸èƒ½ä¸€è‡´ä¿å­˜è¿™äº›åŒ¿åé¡µå§ã€‚è°¢è°¢è€å¸ˆ<br>2019-01-10<br>î˜ˆ ä½œè€…å›å¤<br>1. ä¸å¼€swapï¼Œæ²¡æ³•å›æ”¶<br>2. å–å†³äºè¿™äº›é¡µçš„å®é™…è®¿é—®æƒ…å†µï¼Œåªè¦ä¸€è®¿é—®ï¼Œå°±ä¼šæ¢å…¥åˆ°å†…å­˜ä¸­<br>---------è¿½é—®-------------------------<br>é¦–å…ˆè°¢è°¢è€å¸ˆçš„é—®ç­”ï¼Œå¯èƒ½æ˜¯æˆ‘æ²¡æœ‰æè¿°æ¸…æ¥šã€‚ä¸€æ˜¯ï¼Œå¦‚æœæŒ‰ç…§è€å¸ˆè¯´çš„â€œä¸å¼€swapï¼Œæ²¡æ³•å›æ”¶â€é‚£ä¹ˆæˆ‘ç³»ç»Ÿäº§ç”Ÿçš„å¤§é‡åŒ¿åé¡µæ€ä¹ˆåŠï¼Ÿæ˜¯ä¸æ˜¯ä¸€ç›´åœ¨å†…å­˜é‡Œï¼Œä¸èƒ½è¢«å›æ”¶ï¼Ÿç›´åˆ°å¼•å‘oomï¼ŒæŠŠè¿™ä¸ªè¿›ç¨‹å¹²æ‰ï¼Ÿï¼›äºŒæ˜¯â€œ å–å†³äºè¿™äº›é¡µçš„å®é™…è®¿é—®æƒ…å†µï¼Œåªè¦ä¸€è®¿é—®ï¼Œå°±ä¼šæ¢å…¥åˆ°å†…å­˜ä¸­â€å¦‚æœè¿™äº›è¢«æ¢åˆ°swapä¸Šçš„åŒ¿åé¡µé‡å¾ˆå¤§ ï¼ŒæŠŠswapéƒ½å†™æ»¡äº†ï¼Œè¿™ä¸ªæ—¶å€™æ˜¯æ€ä¹ˆé€‰æ‹©ä»swapé‡Œæ¸…ç†å“ªäº›åŒ¿åé¡µå‘¢ï¼Ÿ","like_count":13,"discussions":[{"author":{"id":1001282,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/47/42/5b55bd1a.jpg","nickname":"å€ªæœ‹é£","note":"","ucode":"F0FAC195CDE7AC","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":436262,"discussion_content":"1.æ˜¯çš„ï¼›2. swapéƒ½æ»¡äº†ï¼Œè¯´æ˜å†…å­˜ä¹Ÿè€—å°½äº†å‘€ï¼Œè¿™æ—¶å€™å°±è¦OOMäº†","likes_number":1,"is_delete":false,"is_hidden":false,"ctime":1548248182,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1068361,"avatar":"https://static001.geekbang.org/account/avatar/00/10/4d/49/28e73b9c.jpg","nickname":"æ˜ç¿¼","note":"","ucode":"E77F86BEB3D5C1","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":536045,"discussion_content":"ç¬¬ä¸€ä¸ªé—®é¢˜ä¸å¼€å¯ï¼Œé‚£å°±ç¨‹åºè‡ªå·±ç®¡ç†æˆ–jvm è™šæ‹Ÿæœºç®¡ç†äº†ï¼Œä¸å¯èƒ½ç­‰ç€Pom","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1638663806,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":83235,"user_name":"é™³å…ˆæ£®","can_delete":false,"product_type":"c1","uid":1229006,"ip_address":"","ucode":"0F7AC617E3FE90","user_header":"https://static001.geekbang.org/account/avatar/00/12/c0/ce/fc41ad5e.jpg","comment_is_top":false,"comment_ctime":1554475007,"is_pvip":false,"replies":[{"id":"30186","content":"ğŸ‘è°¢è°¢åˆ†äº«","user_name":"ä½œè€…å›å¤","comment_id":83235,"uid":"1001282","ip_address":"","utype":1,"ctime":1554638412,"user_name_real":"å€ªæœ‹é£"}],"discussion_count":3,"race_medal":0,"score":"31619246079","product_id":100020901,"comment_content":"å¾ˆå¤šåŒå­¦è£…bccå·¥å…·çš„æ—¶å€™éƒ½æç¤ºæ‰¾ä¸åˆ°åŠ¨æ€åº“ä¹‹ç±»çš„ï¼Œç»è¿‡æœ¬äººäº²æµ‹æ˜¯å› ä¸ºæ²¡æœ‰å®‰è£…åŒ¹é…æ–°å†…æ ¸ç‰ˆæœ¬çš„å†…æ ¸å¤´åŒ…ã€‚æˆ‘çš„ç³»ç»Ÿcentos7.3æ›´æ–°äº†ä¹‹åå†…æ ¸æ˜¯5.0.5ç‰ˆæœ¬çš„ï¼Œå‡å®Œä¹‹åä¸€ç›´æç¤ºç¼ºå°‘åº“æ–‡ä»¶ï¼Œæˆ‘çš„åšæ³•æ˜¯<br>rpm -qa |grep kerner,å…ˆæŸ¥æ‰¾ç³»ç»Ÿå†…æ ¸ç‰ˆæœ¬ï¼Œç½‘ä¸ŠæŸ¥æ‰¾ç›¸åº”çš„åŒ¹é…kerner-develåŒ…ï¼ŒåŠæ—¶æ²¡æœ‰ç›¸åŒç‰ˆæœ¬ä¹Ÿä¸è¦ç´§ï¼Œæ¯”å¦‚5.0.5-1çš„ç‰ˆæœ¬å°±æ˜¯æˆ‘ç³»ç»Ÿçš„ç‰ˆæœ¬ç½‘ä¸Šæ‰¾äº†æ²¡æœ‰è¿™ä¸ªç‰ˆæœ¬å¯¹åº”çš„kerner-develåŒ…ä½†æ˜¯ä¸çŸ¥é“ä¸ºä»€ä¹ˆå‡çº§äº†ä¼šå®‰è£…è¿™ä¸ªç‰ˆæœ¬ï¼Œæˆ‘ç³»ç»Ÿå‡çº§å‰centos7.3ï¼Œå‡çº§å7.6ã€‚æˆ‘å°±ä¸‹è½½äº†5.0.5-3å¹¶å®‰è£…ï¼Œç„¶åç‰ˆæœ¬çš„ï¼Œæ‰¾åˆ°å¯¹åº”çš„åŒ…ç‰ˆæœ¬ï¼Œrpm -ql åŒ…ç‰ˆæœ¬ï¼Œåšä¸ªè½¯è¿æ¥å°±OKã€‚è‡³æ­¤bccå·²ç»å®‰è£…å®Œæˆã€‚åšä¸ºä¸€ä¸ªlinuxè¿ç»´æˆ‘éƒ½è£…äº†2å¤©ï¼Œå¯æƒ³è€ŒçŸ¥å¤§å®¶ã€‚æ­¤æ–¹æ³•äº²æµ‹centos7.3","like_count":7,"discussions":[{"author":{"id":1001282,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/47/42/5b55bd1a.jpg","nickname":"å€ªæœ‹é£","note":"","ucode":"F0FAC195CDE7AC","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":445932,"discussion_content":"ğŸ‘è°¢è°¢åˆ†äº«","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1554638412,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1611745,"avatar":"https://static001.geekbang.org/account/avatar/00/18/97/e1/0f4d90ff.jpg","nickname":"ä¹–ï¼Œæ‘¸æ‘¸å¤´","note":"","ucode":"BD92741A11D3CD","race_medal":0,"user_type":1,"is_pvip":true},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":3992,"discussion_content":"æ²¡çœ‹æ‡‚ï¼Œä¸‹è½½5.0.5-3 æ˜¯kernerçš„ç‰ˆæœ¬è¿˜æ˜¯ kernerl-develçš„ç‰ˆæœ¬ï¼Œè½¯è¿æ¥ï¼Œæ˜¯åšé‚£ä¸ªé“¾æ¥ï¼Œèƒ½å¦å†å†™æ¸…æ¥šä¸€ç‚¹","likes_number":1,"is_delete":false,"is_hidden":false,"ctime":1565050501,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1316840,"avatar":"https://static001.geekbang.org/account/avatar/00/14/17/e8/f74f4a59.jpg","nickname":"patience","note":"","ucode":"D7BDBFBA979D9E","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":4694,"discussion_content":"åœ¨è¿™é‡Œ http://mirror.rc.usf.edu/compute_lock/elrepo/kernel/el7/x86_64/RPMS/æ‰¾ä¸€ä¸ª 4.1-4.20 çš„å†…æ ¸ç‰ˆæœ¬å®‰è£…å°±å¥½äº†ï¼Œ5.0 çš„ä¼šæœ‰ bug https://github.com/iovisor/bcc/issues/2329 ","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1565665001,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":59298,"user_name":"å¥½å¥½å­¦ä¹ ","can_delete":false,"product_type":"c1","uid":1258789,"ip_address":"","ucode":"63A002997462E3","user_header":"https://static001.geekbang.org/account/avatar/00/13/35/25/bab760a1.jpg","comment_is_top":false,"comment_ctime":1547347778,"is_pvip":false,"replies":[{"id":"21521","content":"smemæ˜¯å¯ä»¥çš„ğŸ‘ï¼Œä¸è¿‡è¦æ³¨æ„è®¡ç®— PSS è€Œä¸æ˜¯ RSS","user_name":"ä½œè€…å›å¤","comment_id":59298,"uid":"1001282","ip_address":"","utype":1,"ctime":1547448037,"user_name_real":"å€ªæœ‹é£"}],"discussion_count":1,"race_medal":0,"score":"31612118850","product_id":100020901,"comment_content":"å†…å­˜ç»Ÿè®¡è¿™æ ·ä¹Ÿå¯ä»¥å§smem|awk &#39;{total+=$7};END{printf &quot;%d kb&#47;n&quot;,total}&#39;","like_count":7,"discussions":[{"author":{"id":1001282,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/47/42/5b55bd1a.jpg","nickname":"å€ªæœ‹é£","note":"","ucode":"F0FAC195CDE7AC","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":436319,"discussion_content":"smemæ˜¯å¯ä»¥çš„ğŸ‘ï¼Œä¸è¿‡è¦æ³¨æ„è®¡ç®— PSS è€Œä¸æ˜¯ RSS","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1547448037,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":187462,"user_name":"yann [æ‰¬] :æ›¹åŒå­¦","can_delete":false,"product_type":"c1","uid":1199315,"ip_address":"","ucode":"C449253263E796","user_header":"https://static001.geekbang.org/account/avatar/00/12/4c/d3/365fe5a1.jpg","comment_is_top":false,"comment_ctime":1584115189,"is_pvip":false,"discussion_count":1,"race_medal":0,"score":"14469017077","product_id":100020901,"comment_content":"centos å®‰è£…æ–¹æ³•å®‰è£…å®Œäº†ï¼Œcachestatå¯ä»¥ï¼Œmemleak ä¸èƒ½ä½¿ç”¨ï¼Œbpf textæŠ¥é”™","like_count":3,"discussions":[{"author":{"id":1298046,"avatar":"http://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTKZicicibGibtR5zAia782Ajc5I5BN3F3tjAdlibATIknHv67gbxeH21N7B6vbgwLjYb1miaLKhqicptB5ibYw/132","nickname":"é˜¿é£","note":"","ucode":"F8B1FC8521264D","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":280743,"discussion_content":"æˆ‘ä¹Ÿæ˜¯","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1591607793,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":240911,"user_name":"J.Smile","can_delete":false,"product_type":"c1","uid":1336475,"ip_address":"","ucode":"C4D98DFDBF7584","user_header":"https://static001.geekbang.org/account/avatar/00/14/64/9b/0b578b08.jpg","comment_is_top":false,"comment_ctime":1597115170,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"10187049762","product_id":100020901,"comment_content":"å°ç»“ï¼š<br>â‘  å†…å­˜ç´§å¼ æ—¶çš„å›æ”¶ä¸‰æ–¹å¼ï¼šLRU+Swap+OOM<br>â‘¡ å†…å­˜é¡µæ ¹æ®ç±»å‹åˆ†ä¸ºï¼šæ–‡ä»¶é¡µï¼ˆå¯¹åº”ç¼“å­˜å›æ”¶ï¼‰å’ŒåŒ¿åé¡µ(å¯¹åº”swapå›æ”¶)ã€‚<br>â‘¢OOMæ–¹å¼å†…å­˜å›æ”¶<br>-- å¦‚æœå›æ”¶å®Œæ–‡ä»¶é¡µå’ŒåŒ¿åé¡µåï¼Œå†…å­˜å¤Ÿç”¨äº†ï¼Œçš†å¤§æ¬¢å–œï¼ŒæŠŠå›æ”¶å›æ¥çš„å†…å­˜åˆ†é…ç»™è¿›ç¨‹å°±å¯ä»¥äº†ã€‚ä½†å¦‚æœå†…å­˜è¿˜æ˜¯ä¸è¶³ï¼ŒOOM å°±è¦èµ·ä½œç”¨äº†ã€‚<br>-- OOM è§¦å‘çš„æ—¶æœºåŸºäºè™šæ‹Ÿå†…å­˜ã€‚æ¢å¥è¯è¯´ï¼Œè¿›ç¨‹åœ¨ç”³è¯·å†…å­˜æ—¶ï¼Œå¦‚æœç”³è¯·çš„è™šæ‹Ÿå†…å­˜åŠ ä¸ŠæœåŠ¡å™¨å®é™…å·²ç”¨çš„å†…å­˜ä¹‹å’Œï¼Œæ¯”æ€»çš„ç‰©ç†å†…å­˜è¿˜å¤§ï¼Œå°±ä¼šè§¦å‘ OOMã€‚<br>â‘£ç£ç›˜ä¸æ–‡ä»¶çš„åŒºåˆ«å’Œè”ç³»<br>- ç£ç›˜æ˜¯å­˜å‚¨æ•°æ®çš„å—è®¾å¤‡ï¼Œä¹Ÿæ˜¯æ–‡ä»¶ç³»ç»Ÿçš„è½½ä½“ã€‚æ‰€ä»¥ï¼Œæ–‡ä»¶ç³»ç»Ÿç¡®å®è¿˜æ˜¯è¦é€šè¿‡ç£ç›˜ï¼Œæ¥ä¿è¯æ•°æ®çš„æŒä¹…åŒ–å­˜å‚¨ã€‚<br>- åœ¨è¯»å†™æ™®é€šæ–‡ä»¶æ—¶ï¼ŒI&#47;O è¯·æ±‚ä¼šé¦–å…ˆç»è¿‡æ–‡ä»¶ç³»ç»Ÿï¼Œç„¶åç”±æ–‡ä»¶ç³»ç»Ÿè´Ÿè´£ï¼Œæ¥ä¸ç£ç›˜è¿›è¡Œäº¤äº’ã€‚è€Œåœ¨è¯»å†™å—è®¾å¤‡æ–‡ä»¶æ—¶ï¼Œä¼šè·³è¿‡æ–‡ä»¶ç³»ç»Ÿï¼Œç›´æ¥ä¸ç£ç›˜äº¤äº’ï¼Œä¹Ÿå°±æ˜¯æ‰€è°“çš„â€œè£¸ I&#47;Oâ€ã€‚<br>- æ–‡ä»¶ç³»ç»Ÿç®¡ç†çš„ç¼“å­˜ï¼Œå…¶å®å°±æ˜¯ Cache çš„ä¸€éƒ¨åˆ†ã€‚è€Œè£¸ç£ç›˜çš„ç¼“å­˜ï¼Œç”¨çš„æ­£æ˜¯ Bufferã€‚","like_count":2},{"had_liked":false,"id":204846,"user_name":"è«å","can_delete":false,"product_type":"c1","uid":1007254,"ip_address":"","ucode":"E28F2602BA25DD","user_header":"https://static001.geekbang.org/account/avatar/00/0f/5e/96/a03175bc.jpg","comment_is_top":false,"comment_ctime":1586482172,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"10176416764","product_id":100020901,"comment_content":"OOMè§¦å‘çš„æ—¶æœºåŸºäºè™šæ‹Ÿå†…å­˜ã€‚ä¸èµåŒè¿™ä¸€è¯´æ³•ï¼ŒOOMæ˜¯åœ¨å†…æ ¸é¡µä¸­æ–­å¹¶å°è¯•åˆ†é…ç‰©ç†é¡µå·¥ç¨‹ä¸­è§¦å‘çš„ï¼Œä¸»è¦ä¾æ®rssè¿›è¡Œåˆ¤æ–­ã€‚<br><br>ä¸¾ä¸ªç®€å•ä¾‹å­ï¼šå®¹å™¨é™åˆ¶100Mï¼Œappä¸€æ¬¡æ€§malloc 500Mï¼Œç›¸å½“äºç”³è¯·500Mè™šæ‹Ÿå†…å­˜ï¼Œä½†ä¸ä¼šè§¦å‘OOMï¼Œç„¶åé€å­—èŠ‚å†™å…¥ï¼Œä¸æ–­è§¦å‘é¡µä¸­æ–­åˆ†é…ç‰©ç†å†…å­˜ï¼Œå½“åˆ†é…çš„ç‰©ç†å†…å­˜è¾¾åˆ°100Mæ—¶è§¦å‘OOMã€‚","like_count":2},{"had_liked":false,"id":176883,"user_name":"é£˜äº‘","can_delete":false,"product_type":"c1","uid":1446494,"ip_address":"","ucode":"C6FE0310D6853C","user_header":"https://static001.geekbang.org/account/avatar/00/16/12/5e/77b67a85.jpg","comment_is_top":false,"comment_ctime":1581215144,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"10171149736","product_id":100020901,"comment_content":"è€å¸ˆ ï¼Œä¸€ä¸ªè¿›ç¨‹çš„ oom score åˆ°åº•æ˜¯æ ¹æ®ä»€ä¹ˆè®¡ç®—çš„å¹¶æ²¡æœ‰è¯´ï¼Œ æˆ–è€…æ²¡æœ‰è¯´æ¸…æ¥šï¼Œè¯´æ˜ç™½","like_count":2},{"had_liked":false,"id":75252,"user_name":"å¹³å®‰å–œä¹","can_delete":false,"product_type":"c1","uid":1102350,"ip_address":"","ucode":"B97D8944B0B035","user_header":"https://static001.geekbang.org/account/avatar/00/10/d2/0e/26bf35a4.jpg","comment_is_top":false,"comment_ctime":1552370437,"is_pvip":false,"replies":[{"id":"27485","content":"è°¢è°¢åˆ†äº«","user_name":"ä½œè€…å›å¤","comment_id":75252,"uid":"1001282","ip_address":"","utype":1,"ctime":1552399584,"user_name_real":"å€ªæœ‹é£"}],"discussion_count":2,"race_medal":0,"score":"10142305029","product_id":100020901,"comment_content":"æ‰“å¡ï¼š<br>bcc-tools install(centos6.9)  å·²å°è¯•å¯ä»¥é¡ºåˆ©å®‰è£… <br>https:&#47;&#47;blog.csdn.net&#47;luckgl&#47;article&#47;details&#47;88355074","like_count":2,"discussions":[{"author":{"id":1001282,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/47/42/5b55bd1a.jpg","nickname":"å€ªæœ‹é£","note":"","ucode":"F0FAC195CDE7AC","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":442838,"discussion_content":"è°¢è°¢åˆ†äº«","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1552399584,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1202375,"avatar":"https://static001.geekbang.org/account/avatar/00/12/58/c7/a65f5080.jpg","nickname":"Lucky  Guy","note":"","ucode":"44B4688D764475","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":264519,"discussion_content":"æœ€è¿‘åˆšå¥½æœ‰éœ€æ±‚ï¼Œåœ¨CentOS6.9å®‰è£…è¿™ä¸ªå·¥å…·åŒ…ï¼Œæœ‰æ—¶é—´è¯•è¯•ï¼Œå¤šè°¢äº†ï¼","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1589331838,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":58080,"user_name":"ninuxer","can_delete":false,"product_type":"c1","uid":1243135,"ip_address":"","ucode":"5394ADAF2667D6","user_header":"https://wx.qlogo.cn/mmopen/vi_32/PiajxSqBRaEKQMM4m7NHuicr55aRiblTSEWIYe0QqbpyHweaoAbG7j2v7UUElqqeP3Ihrm3UfDPDRb1Hv8LvPwXqA/132","comment_is_top":false,"comment_ctime":1546994410,"is_pvip":false,"replies":[{"id":"20986","content":"ğŸ‘","user_name":"ä½œè€…å›å¤","comment_id":58080,"uid":"1001282","ip_address":"","utype":1,"ctime":1547027463,"user_name_real":"å€ªæœ‹é£"}],"discussion_count":1,"race_medal":0,"score":"10136929002","product_id":100020901,"comment_content":"æ‰“å¡day23<br>å–œæ¬¢ä¸€ç¯‡æ–‡ç« çœ‹ä¸¤æ¬¡ï¼Œç¬¬ä¸€æ¬¡çœ‹ï¼Œç¬¬äºŒæ¬¡æ˜¯å®è·µçš„æ—¶å€™å†çœ‹ä¸€é","like_count":2,"discussions":[{"author":{"id":1001282,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/47/42/5b55bd1a.jpg","nickname":"å€ªæœ‹é£","note":"","ucode":"F0FAC195CDE7AC","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":435897,"discussion_content":"ğŸ‘","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1547027463,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":326517,"user_name":"linker","can_delete":false,"product_type":"c1","uid":1803259,"ip_address":"","ucode":"6C5799F2FC2C82","user_header":"https://static001.geekbang.org/account/avatar/00/1b/83/fb/621adceb.jpg","comment_is_top":false,"comment_ctime":1639550942,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"5934518238","product_id":100020901,"comment_content":"å¤§ä½¬ï¼Œå…³äºoomçš„å‡ºå‘æ—¶æœºï¼Œæˆ‘è¿™è¾¹åšäº†å®éªŒæµ‹è¯•ï¼Œmallocåˆ†é…å¤±è´¥æ˜¯è¿”å›NULL,å¹¶ä¸”è®¾ç½®errno=12(å†…å­˜ä¸è¶³)ã€‚ä½†æ˜¯ä¸ä¼šå‡ºå‘oom. åªæœ‰å½“read &#47; writeè°ƒç”¨æ—¶ï¼Œdo_page_faultæ˜ å°„ä¸åˆ°é¡µè¡¨æ‰å‡ºå‘oom","like_count":1},{"had_liked":false,"id":259093,"user_name":"Geek_f702be","can_delete":false,"product_type":"c1","uid":1143067,"ip_address":"","ucode":"8E3B5F393C4266","user_header":"http://thirdwx.qlogo.cn/mmopen/vi_32/DYAIOgq83epumnXjMLYzHkGFhAraIiaAMXpotuUR9PCexBWl25tRLFAvpzs03Hfse4Y1lyeWuryz6z80Fd8AXiaw/132","comment_is_top":false,"comment_ctime":1604629454,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"5899596750","product_id":100020901,"comment_content":"ä¸Šä¸€èŠ‚æåˆ°å¸¸é©»å†…å­˜æ˜¯è¿›ç¨‹å®é™…ä½¿ç”¨çš„ç‰©ç†å†…å­˜ï¼Œä¸è¿‡ï¼Œå®ƒä¸åŒ…æ‹¬ Swap å’Œå…±äº«å†…å­˜ã€‚<br>è¿™ä¸€èŠ‚è¯´RSS è¡¨ç¤ºå¸¸é©»å†…å­˜ï¼ŒæŠŠè¿›ç¨‹ç”¨åˆ°çš„å…±äº«å†…å­˜ä¹Ÿç®—äº†è¿›å»ã€‚æ‰€ä»¥ï¼Œç›´æ¥ç´¯åŠ ä¼šå¯¼è‡´å…±äº«å†…å­˜è¢«é‡å¤è®¡ç®—ï¼Œä¸èƒ½å¾—åˆ°å‡†ç¡®çš„ç­”æ¡ˆ<br>è¿™æ˜¯ä¸æ˜¯å‰åçŸ›ç›¾äº†","like_count":1},{"had_liked":false,"id":91911,"user_name":"cuikt","can_delete":false,"product_type":"c1","uid":1242702,"ip_address":"","ucode":"9A1DB426CEFEEA","user_header":"https://static001.geekbang.org/account/avatar/00/12/f6/4e/0066303c.jpg","comment_is_top":false,"comment_ctime":1557132277,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"5852099573","product_id":100020901,"comment_content":"bcc-tool ç¡®å®å‰å®³ï¼Œæ— å¥ˆç”Ÿæˆç¯å¢ƒä¸å¯èƒ½è½»æ˜“å‡çº§å†…æ ¸ï¼Œåªèƒ½å­¦ä¹ ä½¿ç”¨ã€‚","like_count":1},{"had_liked":false,"id":78671,"user_name":"Hï¼†HH","can_delete":false,"product_type":"c1","uid":1313162,"ip_address":"","ucode":"A52204F4E4115F","user_header":"https://static001.geekbang.org/account/avatar/00/14/09/8a/842981e0.jpg","comment_is_top":false,"comment_ctime":1553215891,"is_pvip":false,"replies":[{"id":"28750","content":"çœ‹é”™è¯¯æ˜¯æ‰¾ä¸åˆ°ä¾èµ–çš„åŠ¨æ€é“¾æ¥åº“ï¼Œå¯ä»¥è¯•è¯•ä¿®å¤å®‰è£… libstdc++","user_name":"ä½œè€…å›å¤","comment_id":78671,"uid":"1001282","ip_address":"","utype":1,"ctime":1553317237,"user_name_real":"å€ªæœ‹é£"}],"discussion_count":1,"race_medal":0,"score":"5848183187","product_id":100020901,"comment_content":"è€å¸ˆï¼Œåˆå§‹ç³»ç»Ÿç‰ˆæœ¬æ˜¯centos7.3ï¼ŒæŒ‰ç…§ä½ ç»™çš„å®‰è£…bcc-toolsæ­¥éª¤å®‰è£…å®Œåè¿˜æ˜¯å‡ºç°äº†ä»¥ä¸‹æŠ¥é”™ï¼Œè¯·é—®è€å¸ˆæ€ä¹ˆå›äº‹å‘€<br>[root@server tools]# .&#47;cachetop <br>Traceback (most recent call last):<br>  File &quot;.&#47;cachetop&quot;, line 21, in &lt;module&gt;<br>    from bcc import BPF<br>  File &quot;&#47;usr&#47;lib&#47;python2.7&#47;site-packages&#47;bcc&#47;__init__.py&quot;, line 27, in &lt;module&gt;<br>    from .libbcc import lib, bcc_symbol, bcc_symbol_option, _SYM_CB_TYPE<br>  File &quot;&#47;usr&#47;lib&#47;python2.7&#47;site-packages&#47;bcc&#47;libbcc.py&quot;, line 17, in &lt;module&gt;<br>    lib = ct.CDLL(&quot;libbcc.so.0&quot;, use_errno=True)<br>  File &quot;&#47;usr&#47;lib64&#47;python2.7&#47;ctypes&#47;__init__.py&quot;, line 360, in __init__<br>    self._handle = _dlopen(self._name, mode)<br>OSError: &#47;opt&#47;lampp&#47;lib&#47;libstdc++.so.6: version `GLIBCXX_3.4.14&#39; not found (required by &#47;lib64&#47;libbcc.so.0)<br>[root@server tools]# uname -r<br>5.0.3-1.el7.elrepo.x86_64<br>[root@server tools]# cat &#47;etc&#47;redhat-release <br>CentOS Linux release 7.6.1810 (Core) ","like_count":1,"discussions":[{"author":{"id":1001282,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/47/42/5b55bd1a.jpg","nickname":"å€ªæœ‹é£","note":"","ucode":"F0FAC195CDE7AC","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":444186,"discussion_content":"çœ‹é”™è¯¯æ˜¯æ‰¾ä¸åˆ°ä¾èµ–çš„åŠ¨æ€é“¾æ¥åº“ï¼Œå¯ä»¥è¯•è¯•ä¿®å¤å®‰è£… libstdc++","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1553317237,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":58124,"user_name":"åˆ’æ—¶ä»£","can_delete":false,"product_type":"c1","uid":1061454,"ip_address":"","ucode":"9554CE2F83B77F","user_header":"http://thirdwx.qlogo.cn/mmopen/vi_32/2o1Izf2YyJSnnI0ErZ51pYRlnrmibqUTaia3tCU1PjMxuwyXSKOLUYiac2TQ5pd5gNGvS81fVqKWGvDsZLTM8zhWg/132","comment_is_top":false,"comment_ctime":1547000169,"is_pvip":false,"replies":[{"id":"21156","content":"ä»€ä¹ˆè¿›ç¨‹ï¼Ÿ","user_name":"ä½œè€…å›å¤","comment_id":58124,"uid":"1001282","ip_address":"","utype":1,"ctime":1547125032,"user_name_real":"å€ªæœ‹é£"}],"discussion_count":1,"race_medal":0,"score":"5841967465","product_id":100020901,"comment_content":"è€å¸ˆï¼Œåœ¨â€œå¦‚ä½•ç»Ÿè®¡æ‰€æœ‰è¿›ç¨‹çš„ç‰©ç†å†…å­˜ä½¿ç”¨é‡â€çš„é—®é¢˜ä¸­ï¼Œæˆ‘æ›¾å°è¯•å°†&#47;proc&#47;[pid]&#47;smapsä¸­çš„é¡¹Pssç›¸åŠ ï¼Œä½†å‘ç°ä¸€ä¸ªè¿›ç¨‹ä¸­æœ‰å¤šä¸ªåœ°å€æ®µçš„Pssä¸º0kBï¼Œè€ŒRssæ˜¯ä¸ä¸º0kBçš„ï¼Œè¯¥åŒºåŸŸå ç”¨äº†ç‰©ç†å†…å­˜å´æ²¡æœ‰è®¡ç®—åœ¨Psså†…ï¼Œè¡¨ç¤ºä¸å¤ªç†è§£ï¼Ÿ","like_count":1,"discussions":[{"author":{"id":1001282,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/47/42/5b55bd1a.jpg","nickname":"å€ªæœ‹é£","note":"","ucode":"F0FAC195CDE7AC","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":435917,"discussion_content":"ä»€ä¹ˆè¿›ç¨‹ï¼Ÿ","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1547125032,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":360255,"user_name":"ç§‹ç‰ç™½ç‹¼","can_delete":false,"product_type":"c1","uid":1649642,"ip_address":"æµ™æ±Ÿ","ucode":"12CCEFAA49B17A","user_header":"https://static001.geekbang.org/account/avatar/00/19/2b/ea/bb9fabd7.jpg","comment_is_top":false,"comment_ctime":1666342289,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1666342289","product_id":100020901,"comment_content":"å€ªè€å¸ˆ ä½ å¥½ æˆ‘æ˜¯ä¸€åè¿ç»´å·¥ç¨‹å¸ˆï¼Œé€šè¿‡çœ‹ä½ çš„è¿™ä¸ªæŠ€æœ¯ä¸“æ  è®©æˆ‘åœ¨äº†è§£ç³»ç»Ÿè¿è¡Œæœºåˆ¶å’Œå¯¹æ€§èƒ½é—®é¢˜æ’é™¤è§£å†³æ–¹é¢éƒ½æœ‰äº†å¾ˆå¤§çš„æé«˜ï¼çœŸå¿ƒæ„Ÿè°¢ï¼","like_count":0},{"had_liked":false,"id":336555,"user_name":"Geek_982ffd","can_delete":false,"product_type":"c1","uid":2821365,"ip_address":"","ucode":"220B8AAA747F02","user_header":"","comment_is_top":false,"comment_ctime":1646211818,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1646211818","product_id":100020901,"comment_content":"å…³äºbccå·¥å…·çš„å®‰è£…  ä»…4.1å†…æ ¸åŠä»¥ä¸Šæ”¯æŒ  æ›´è¿›ä¸€æ­¥å»ºè®®å†…æ ¸ç‰ˆæœ¬4.6åŠä»¥ä¸Šç‰ˆæœ¬   Centos7æºç å®‰è£…ï¼šhttps:&#47;&#47;github.com&#47;iovisor&#47;bcc&#47;blob&#47;master&#47;INSTALL.md#centos---source   å…¶ä»–å‘è¡Œç‰ˆå®‰è£…ä¹Ÿå¯ä»¥åœ¨è¯¥é“¾æ¥ä¸­æ‰¾åˆ°ã€‚    æœ€é‡è¦çš„æ˜¯ æ–‡ä¸­å‡ºç°çš„bccåŒ…githubé“¾æ¥å‡ºç°äº† åœ¨ç¼–è¯‘å®‰è£…æ—¶æœ‰ å¤´æ–‡ä»¶ä¸å…¨çš„æç¤º   å¼ºçƒˆå»ºè®®é€‰æ‹©è¯¥é“¾æ¥ä¸‹è½½æœ€æ–°ç‰ˆæœ¬bcc 0.24 ï¼š  https:&#47;&#47;github.com&#47;iovisor&#47;bcc&#47;releases   (å…¼å®¹æœ€æ–°å†…æ ¸ç‰ˆæœ¬5.16)é¿å…æ­¤ç±»é”™è¯¯ã€‚   ","like_count":0},{"had_liked":false,"id":324912,"user_name":"lfn","can_delete":false,"product_type":"c1","uid":1026593,"ip_address":"","ucode":"2E1558C6A12A89","user_header":"https://static001.geekbang.org/account/avatar/00/0f/aa/21/6c3ba9af.jpg","comment_is_top":false,"comment_ctime":1638713160,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1638713160","product_id":100020901,"comment_content":"2021-12-05æ‰“å¡ã€‚","like_count":0},{"had_liked":false,"id":313236,"user_name":"å®å…¸","can_delete":false,"product_type":"c1","uid":2616028,"ip_address":"","ucode":"63953F36596C28","user_header":"https://static001.geekbang.org/account/avatar/00/27/ea/dc/aa699264.jpg","comment_is_top":false,"comment_ctime":1632321193,"is_pvip":true,"discussion_count":0,"race_medal":0,"score":"1632321193","product_id":100020901,"comment_content":"é—®é¢˜ 5: å†…å­˜æ³„æ¼æ¡ˆä¾‹çš„ä¼˜åŒ–æ–¹æ³• ä¸­ï¼Œå°†å †æ”¹æˆæ ˆã€‚åœ¨å‡½æ•°è¿”å›çš„æ—¶å€™æ ˆç©ºé—´çš„å±€éƒ¨å˜é‡ä¸æ˜¯é‡Šæ”¾äº†å—ï¼Ÿ","like_count":0},{"had_liked":false,"id":286343,"user_name":"babala","can_delete":false,"product_type":"c1","uid":1856958,"ip_address":"","ucode":"F0F06865D328A6","user_header":"https://static001.geekbang.org/account/avatar/00/1c/55/be/23b0fa67.jpg","comment_is_top":false,"comment_ctime":1617262728,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1617262728","product_id":100020901,"comment_content":"é²²é¹çš„cpu920åŸºäºarmçš„ç³»ç»Ÿï¼Œå¥½åƒç¼–è¯‘å®‰è£…bc-toolså’Œpcstatç­‰éƒ½é‡åˆ°å„ç§é—®é¢˜ï¼Œæœ‰æ²¡ç›¸åº”çš„è§£å†³æ–¹æ³•ï¼Ÿ","like_count":0},{"had_liked":false,"id":267577,"user_name":"Jasman","can_delete":false,"product_type":"c1","uid":2051085,"ip_address":"","ucode":"C5221E477219A8","user_header":"http://thirdwx.qlogo.cn/mmopen/vi_32/DYAIOgq83erGLUqIRJ2gJamFq0SbJksGTNOeHnAQzWZknhRaWFDt5vh1mPpZ9eZdrfvn0bzcRqTZo0yjMW3Ugw/132","comment_is_top":false,"comment_ctime":1607832904,"is_pvip":false,"discussion_count":1,"race_medal":0,"score":"1607832904","product_id":100020901,"comment_content":"è¯·é—®è€å¸ˆï¼Œæˆ‘åœ¨ä¸€å°æœåŠ¡å™¨ä¸Šæ¨¡æ‹Ÿoomåœºæ™¯ï¼Œå…ˆå¯åŠ¨ä¸€ä¸ªç¨‹åºoom_swap(ç”³è¯·1.2Gå†…å­˜ï¼Œå¹¶ä¸”è®¿é—®å†…å­˜äº†),å†å¯åŠ¨ä¸€ä¸ªoom_bkilled(ä¸æ–­çš„ç”³è¯·100MBçš„å†…å­˜ï¼‰ï¼Œä¹Ÿçœ‹åˆ°oom_swapçš„å†…å­˜å…¨éƒ¨swapå‡ºå»äº†(&#47;proc&#47;pid&#47;status SwapæŸ¥çœ‹çš„), ä½†æ˜¯oom_bkilled è¾¾åˆ°ç‰©ç†å†…å­˜+swapä¸Šçº¿åï¼Œåªæ˜¯æŠ¥ç”³è¯·å¤±è´¥ï¼Œæ²¡æœ‰è¢«oom_kill ,è¯·é—®å¯èƒ½æ˜¯ä»€ä¹ˆåŸå› å•Šï¼Ÿ","like_count":0,"discussions":[{"author":{"id":1643161,"avatar":"","nickname":"Geek_048a7e","note":"","ucode":"7DA71767433EE7","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":547129,"discussion_content":"ä¸ä¸€å®šæ˜¯oomç”³è¯·å†…å­˜çš„ç¨‹åºå§ï¼Œæœ‰å¯èƒ½åˆ«çš„ç¨‹åºè¢«oomäº†ï¼Ÿ","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1642555796,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":224968,"user_name":"é˜¿é£","can_delete":false,"product_type":"c1","uid":1298046,"ip_address":"","ucode":"F8B1FC8521264D","user_header":"http://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTKZicicibGibtR5zAia782Ajc5I5BN3F3tjAdlibATIknHv67gbxeH21N7B6vbgwLjYb1miaLKhqicptB5ibYw/132","comment_is_top":false,"comment_ctime":1591606126,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1591606126","product_id":100020901,"comment_content":"ç³»ç»Ÿï¼šcentos7.6 æ›´æ–°äº†å†…æ ¸ï¼Œæ‰§è¡Œcachetopæ²¡é—®é¢˜ï¼Œæ‰§è¡Œmemleakä¼šæŠ¥é”™ï¼šFailed to compile BPF textã€‚ ä¸€ç›´æ‰¾ä¸åˆ°è§£å†³åŠæ³•","like_count":0},{"had_liked":false,"id":224315,"user_name":"å°å­¦ç”Ÿ","can_delete":false,"product_type":"c1","uid":1804356,"ip_address":"","ucode":"0DBB26031234FB","user_header":"https://static001.geekbang.org/account/avatar/00/1b/88/44/87cc5c0f.jpg","comment_is_top":false,"comment_ctime":1591343631,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1591343631","product_id":100020901,"comment_content":"æˆ‘centos7.6 å†…æ ¸3.10.0-957.el7.x86_64 ç›´æ¥yumå®‰è£…çš„bcc   ","like_count":0},{"had_liked":false,"id":189461,"user_name":"åˆ˜å‹æ·™","can_delete":false,"product_type":"c1","uid":1620058,"ip_address":"","ucode":"97F3A69A308313","user_header":"","comment_is_top":false,"comment_ctime":1584519237,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1584519237","product_id":100020901,"comment_content":"D9 æ‰“å¡","like_count":0},{"had_liked":false,"id":148807,"user_name":"hana","can_delete":false,"product_type":"c1","uid":1600146,"ip_address":"","ucode":"CC1368CC17BC4B","user_header":"https://static001.geekbang.org/account/avatar/00/18/6a/92/0877ed15.jpg","comment_is_top":false,"comment_ctime":1573089347,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1573089347","product_id":100020901,"comment_content":"æ‰“å¡","like_count":0},{"had_liked":false,"id":133077,"user_name":"é£æ¸…æ‰¬","can_delete":false,"product_type":"c1","uid":1047043,"ip_address":"","ucode":"651F1390B64953","user_header":"https://static001.geekbang.org/account/avatar/00/0f/fa/03/619e3e48.jpg","comment_is_top":false,"comment_ctime":1568348333,"is_pvip":true,"discussion_count":0,"race_medal":0,"score":"1568348333","product_id":100020901,"comment_content":"é—®é¢˜äº”æˆ‘è®¤ä¸ºæœ‰é—®é¢˜ï¼Œä¸çŸ¥é“æ˜¯ä¸æ˜¯ç†è§£é”™äº†ã€‚<br>æœ€å¼€å§‹å†™æ³•å­˜åœ¨å†…å­˜æ³„éœ²ï¼Œæˆ‘è®¤ä¸ºä¹Ÿæ˜¯æœ‰é—®é¢˜çš„ï¼Œè¿”å›å€¼æ˜¯vï¼Œç±»å‹long long *,é‚£ä¹ˆè§£å¼•ç”¨æ‹¿åˆ°çš„è¿˜æ˜¯long long,å¦å¤–å¤šç”³è¯·çš„1023ä¸ªlong long æœ‰å•¥ç”¨????<br><br>éƒ­æ±Ÿä¼Ÿçš„è§£æ³•ï¼Œæ˜¯ä¸€ä¸ªlong long v[1024],è¿”å›å€¼ç±»å‹long long,è¿”å›ä»€ä¹ˆ?è¿”å›v[0]å—ï¼Œé‚£å‰©ä¸‹çš„å­˜çš„ä»€ä¹ˆ?","like_count":0},{"had_liked":false,"id":129971,"user_name":"é¥­ç²’","can_delete":false,"product_type":"c1","uid":1153455,"ip_address":"","ucode":"4C3220B0D43997","user_header":"https://static001.geekbang.org/account/avatar/00/11/99/af/d29273e2.jpg","comment_is_top":false,"comment_ctime":1567344743,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1567344743","product_id":100020901,"comment_content":"åŸæ¥æ›´æ–°å†…æ ¸åå¯ä»¥ç›´æ¥yumå®‰è£…bccï¼Œä¸ç”¨æŒ¨ä¸ªå®‰è£…llvmç­‰ä¾èµ–å¤ªå¥½äº†ï¼Œèµã€‚","like_count":0},{"had_liked":false,"id":108511,"user_name":"JJj","can_delete":false,"product_type":"c1","uid":1196463,"ip_address":"","ucode":"EA53F2CEAFCFF1","user_header":"https://static001.geekbang.org/account/avatar/00/12/41/af/4307867a.jpg","comment_is_top":false,"comment_ctime":1561789569,"is_pvip":false,"replies":[{"id":"40449","content":"åº”è¯¥æ˜¯buff&#47;cache+usedï¼Œå‚è€ƒé—®é¢˜1çš„ç¬¬ä¸‰ç§æ–¹å¼ï¼Œå…ˆå°è¯•å›æ”¶å†…å­˜ç„¶åæ‰æ˜¯OOM","user_name":"ä½œè€…å›å¤","user_name_real":"å€ªæœ‹é£","uid":"1001282","ctime":1562510688,"ip_address":"","comment_id":108511,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1561789569","product_id":100020901,"comment_content":"OOM è§¦å‘çš„æ—¶æœºåŸºäºè™šæ‹Ÿå†…å­˜ã€‚æ¢å¥è¯è¯´ï¼Œè¿›ç¨‹åœ¨ç”³è¯·å†…å­˜æ—¶ï¼Œå¦‚æœç”³è¯·çš„è™šæ‹Ÿå†…å­˜åŠ ä¸ŠæœåŠ¡å™¨å®é™…å·²ç”¨çš„å†…å­˜ä¹‹å’Œ---è¿™é‡Œçš„å®é™…å·²ä½¿ç”¨å†…å­˜æ˜¯ä¸æ˜¯å¯¹åº”freeé‡Œé¢çš„used","like_count":0,"discussions":[{"author":{"id":1001282,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/47/42/5b55bd1a.jpg","nickname":"å€ªæœ‹é£","note":"","ucode":"F0FAC195CDE7AC","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":456018,"discussion_content":"åº”è¯¥æ˜¯buff/cache+usedï¼Œå‚è€ƒé—®é¢˜1çš„ç¬¬ä¸‰ç§æ–¹å¼ï¼Œå…ˆå°è¯•å›æ”¶å†…å­˜ç„¶åæ‰æ˜¯OOM","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1562510688,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":92499,"user_name":"å°æ¾æ¾","can_delete":false,"product_type":"c1","uid":1298152,"ip_address":"","ucode":"B9B5FFE7CAA548","user_header":"https://static001.geekbang.org/account/avatar/00/13/ce/e8/12cb8e99.jpg","comment_is_top":false,"comment_ctime":1557285351,"is_pvip":true,"replies":[{"id":"33111","content":"è¯·å‚è€ƒ 19 | æ¡ˆä¾‹ç¯‡ï¼šä¸ºä»€ä¹ˆç³»ç»Ÿçš„Swapå˜é«˜äº†","user_name":"ä½œè€…å›å¤","user_name_real":"å€ªæœ‹é£","uid":"1001282","ctime":1557324389,"ip_address":"","comment_id":92499,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1557285351","product_id":100020901,"comment_content":"è€å¸ˆï¼Œè¯·æ•™ä¸ªé—®é¢˜ã€‚ æ–‡ä»¶é¡µå’ŒåŒ¿åé¡µæ˜¯ä»€ä¹ˆå‘¢ï¼Ÿ çœ‹ä¹¦ä¸Šè¯´çš„å¾ˆæ‡µï¼Œå¸Œæœ›è€å¸ˆèƒ½ä¸¾ä¸ªå®é™…ç”¨é€”çš„ä¾‹å­è®²è§£ä¸‹ã€‚","like_count":0,"discussions":[{"author":{"id":1001282,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/47/42/5b55bd1a.jpg","nickname":"å€ªæœ‹é£","note":"","ucode":"F0FAC195CDE7AC","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":449287,"discussion_content":"è¯·å‚è€ƒ 19 | æ¡ˆä¾‹ç¯‡ï¼šä¸ºä»€ä¹ˆç³»ç»Ÿçš„Swapå˜é«˜äº†","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1557324389,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":67843,"user_name":"LotusChing","can_delete":false,"product_type":"c1","uid":1284801,"ip_address":"","ucode":"C59F179B528BD3","user_header":"https://static001.geekbang.org/account/avatar/00/13/9a/c1/60e65a44.jpg","comment_is_top":false,"comment_ctime":1550295747,"is_pvip":false,"replies":[{"id":"24051","content":"åœæ­¢è¿›ç¨‹åå½“ç„¶æ˜¯ä¼šé‡Šæ”¾è¿›ç¨‹æ‰€å ç”¨çš„å†…å­˜ã€‚æˆ‘è¯´çš„æ˜¯è¿›ç¨‹ä¸€ç›´åœ¨è¿è¡Œä¸­çš„æ—¶å€™ï¼Œè¿›ç¨‹è‡ªå·±åˆ†é…çš„å†…å­˜åªèƒ½è¿›ç¨‹è‡ªå·±æ¥é‡Šæ”¾ï¼Œæˆ–è€…ç­‰ç€è¿›ç¨‹æ¨å‡ºåç”±ç³»ç»Ÿé‡Šæ”¾ã€‚","user_name":"ä½œè€…å›å¤","user_name_real":"å€ªæœ‹é£","uid":"1001282","ctime":1550326655,"ip_address":"","comment_id":67843,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1550295747","product_id":100020901,"comment_content":"è€å¸ˆï¼Œæ‚¨å¯¹wykkxåŒå­¦é—®é¢˜çš„å›ç­”æˆ‘æœ‰äº›ä¸ç†è§£ï¼Œ&quot;ä¸å¼€swapï¼Œæ²¡æ³•å›æ”¶åŒ¿åé¡µã€‚&quot;ï¼Œæˆ‘è‡ªå·±ç”¨tomcatå®¹å™¨åšäº†ä¸ªå°å®éªŒã€‚<br><br>ç¯å¢ƒï¼šUbuntu 14.04.1 LTS, Trusty Tahrï¼Œ3.13.0-128-genericï¼Œdocker 17.12.0-ceï¼Œtomcat:8-alpine<br><br>æˆ‘çš„ç¯å¢ƒæ²¡æœ‰å¯ç”¨swap(freeçœ‹åˆ°çš„éƒ½æ˜¯0)ï¼Œé€šè¿‡å¯åœtomcatå®¹å™¨ï¼Œå¹¶è§‚å¯Ÿ&#47;proc&#47;zoneinfoã€&#47;proc&#47;meminfoä¸­anonç›¸å…³åŒ¿åé¡µç›¸å…³æŒ‡æ ‡ï¼Œå‘ç°è¿™äº›æŒ‡æ ‡æ•°å€¼ä¼šéšç€å¯åœå®¹å™¨ä¸Šä¸‹æµ®åŠ¨ã€‚<br><br>è¿™æ ·ï¼Œæ˜¯ä¸æ˜¯è¯´æ˜åº”ç”¨å ç”¨çš„åŒ¿åé¡µåªæœ‰åœ¨é€€å‡ºæ—¶é‡Šæ”¾ï¼Ÿé‚£åº”ç”¨è¿è¡Œè¿‡ç¨‹ä¸­ä½¿ç”¨åˆ°çš„å†…å­˜å¦‚ä½•é‡Šæ”¾å‘¢ï¼Ÿé€šè¿‡GCä¹ˆï¼Ÿ<br><br>å¸Œæœ›è€å¸ˆèƒ½æŠ½ç©ºå›å¤ä¸‹å…³äºæˆ‘ä»¬çš„è¿™ä¸ªé—®é¢˜ä¹ˆï¼Œæ„Ÿè°¢ï¼","like_count":0,"discussions":[{"author":{"id":1001282,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/47/42/5b55bd1a.jpg","nickname":"å€ªæœ‹é£","note":"","ucode":"F0FAC195CDE7AC","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":439396,"discussion_content":"åœæ­¢è¿›ç¨‹åå½“ç„¶æ˜¯ä¼šé‡Šæ”¾è¿›ç¨‹æ‰€å ç”¨çš„å†…å­˜ã€‚æˆ‘è¯´çš„æ˜¯è¿›ç¨‹ä¸€ç›´åœ¨è¿è¡Œä¸­çš„æ—¶å€™ï¼Œè¿›ç¨‹è‡ªå·±åˆ†é…çš„å†…å­˜åªèƒ½è¿›ç¨‹è‡ªå·±æ¥é‡Šæ”¾ï¼Œæˆ–è€…ç­‰ç€è¿›ç¨‹æ¨å‡ºåç”±ç³»ç»Ÿé‡Šæ”¾ã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1550326655,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":66977,"user_name":"å¦‚æœ","can_delete":false,"product_type":"c1","uid":1320638,"ip_address":"","ucode":"138A3EEEE50850","user_header":"","comment_is_top":false,"comment_ctime":1550050377,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1550050377","product_id":100020901,"comment_content":"day22ï¼Œæ‰“å¡","like_count":0},{"had_liked":false,"id":65036,"user_name":"è¶…","can_delete":false,"product_type":"c1","uid":1131107,"ip_address":"","ucode":"B20F7A2370792C","user_header":"https://static001.geekbang.org/account/avatar/00/11/42/63/a08003a6.jpg","comment_is_top":false,"comment_ctime":1549008962,"is_pvip":false,"replies":[{"id":"23056","content":"ä½¿ç”¨å®¹å™¨çš„è¯ï¼Œå†…å­˜å¯èƒ½è¿˜å—åˆ°cgroupsçš„é™åˆ¶ã€‚è¿™æ—¶å€™å®¹å™¨OOMåªä»£è¡¨å®¹å™¨çš„å†…å­˜è¾¾åˆ°äº†limitï¼Œä¸ä»£è¡¨ç³»ç»Ÿå†…å­˜ä½¿ç”¨æƒ…å†µã€‚å¦å¤–ï¼Œè¿›ç¨‹çš„å†…å­˜ä½¿ç”¨ä¸ä¸€å®šæ˜¯é£™å‡ï¼Œè¿˜æœ‰å¯èƒ½ç¼“æ…¢å¢é•¿ï¼ˆå…¶å®å¤§éƒ¨åˆ†å†…å­˜æ³„æ¼éƒ½æ˜¯è¿™æ ·ï¼‰.<br><br>%commitè·Ÿfreeæ²¡æœ‰å¯¹åº”å…³ç³»ï¼Œcommitæ˜¯ä¸€ä¸ªåŠ¨æ€è®¡ç®—å‡ºæ¥çš„ä¼°è®¡å€¼","user_name":"ä½œè€…å›å¤","user_name_real":"å€ªæœ‹é£","uid":"1001282","ctime":1549024455,"ip_address":"","comment_id":65036,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1549008962","product_id":100020901,"comment_content":"æˆ‘çš„ç°è±¡æ˜¯32GæœåŠ¡å™¨ free è¿˜æœ‰2gå¤šå‡ºç°oomï¼Œä½†å¹¶æ²¡æœ‰å®¹å™¨çš„å†…å­˜å‡é«˜ã€‚<br>è¿›ç¨‹ç”³è¯·çš„è™šæ‹Ÿå†…å­˜ + æœåŠ¡å™¨å·²ç”¨çš„å†…å­˜(åŒ…æ‹¬buf&#47;cache) &gt; ç‰©ç†å†…å­˜ çš„æ—¶å€™ä¼šè§¦å‘OOM<br><br>é‚£ä»¬æˆ‘ä¸ªäººç†è§£OOM å‘ç”Ÿä»¥åä¼šå‡ºç°æŸä¸ªè¿›ç¨‹å†…å­˜é£™å‡çš„æƒ…å†µï¼Œä½†ä»OOMå¯¹åº”çš„æ—¶é—´ä¸Šæ¥çœ‹ï¼Œç›‘æ§æ²¡æœ‰å‘ç°æŸä¸ªå®¹å™¨è¿›ç¨‹é£™å‡ã€‚ ä¸çŸ¥é“æ˜¯ä¸ºä»€ä¹ˆï¼Ÿ  <br><br><br><br>ubuntu 16.04<br>sar -r -S 1 %commit ä¸ free -g é‡Œé¢åˆè¯¥å¦‚ä½•å¯¹åº”å‘¢ï¼Ÿ","like_count":0,"discussions":[{"author":{"id":1001282,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/47/42/5b55bd1a.jpg","nickname":"å€ªæœ‹é£","note":"","ucode":"F0FAC195CDE7AC","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":438288,"discussion_content":"ä½¿ç”¨å®¹å™¨çš„è¯ï¼Œå†…å­˜å¯èƒ½è¿˜å—åˆ°cgroupsçš„é™åˆ¶ã€‚è¿™æ—¶å€™å®¹å™¨OOMåªä»£è¡¨å®¹å™¨çš„å†…å­˜è¾¾åˆ°äº†limitï¼Œä¸ä»£è¡¨ç³»ç»Ÿå†…å­˜ä½¿ç”¨æƒ…å†µã€‚å¦å¤–ï¼Œè¿›ç¨‹çš„å†…å­˜ä½¿ç”¨ä¸ä¸€å®šæ˜¯é£™å‡ï¼Œè¿˜æœ‰å¯èƒ½ç¼“æ…¢å¢é•¿ï¼ˆå…¶å®å¤§éƒ¨åˆ†å†…å­˜æ³„æ¼éƒ½æ˜¯è¿™æ ·ï¼‰.\n\n%commitè·Ÿfreeæ²¡æœ‰å¯¹åº”å…³ç³»ï¼Œcommitæ˜¯ä¸€ä¸ªåŠ¨æ€è®¡ç®—å‡ºæ¥çš„ä¼°è®¡å€¼","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1549024455,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":65029,"user_name":"marvinren","can_delete":false,"product_type":"c1","uid":1325147,"ip_address":"","ucode":"F7F7EEE0ED7588","user_header":"https://static001.geekbang.org/account/avatar/00/14/38/5b/26539a0b.jpg","comment_is_top":false,"comment_ctime":1549006977,"is_pvip":false,"replies":[{"id":"23052","content":"ä¸ä¼šçš„ï¼Œswapå›æ”¶çš„æ˜¯åŒ¿åé¡µ","user_name":"ä½œè€…å›å¤","user_name_real":"å€ªæœ‹é£","uid":"1001282","ctime":1549023915,"ip_address":"","comment_id":65029,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1549006977","product_id":100020901,"comment_content":"æˆ‘æœ‰ä¸ªé—®é¢˜æœ‰ç‚¹æ²¡å¼„æ˜ç™½ï¼Œä»å®éªŒè§’åº¦ä¸Šè®²ï¼Œè¿›å…¥cacheå’Œbufferçš„æ–‡ä»¶é¡µï¼Œä¹Ÿä¼šä¼šè¢«swapå›æ”¶ï¼Œå¯¹ä¹ˆï¼Ÿ","like_count":0,"discussions":[{"author":{"id":1001282,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/47/42/5b55bd1a.jpg","nickname":"å€ªæœ‹é£","note":"","ucode":"F0FAC195CDE7AC","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":438285,"discussion_content":"ä¸ä¼šçš„ï¼Œswapå›æ”¶çš„æ˜¯åŒ¿åé¡µ","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1549023915,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":60731,"user_name":"wykkx","can_delete":false,"product_type":"c1","uid":1122358,"ip_address":"","ucode":"ABCDF49E7A95C8","user_header":"https://static001.geekbang.org/account/avatar/00/11/20/36/b3e2f1d5.jpg","comment_is_top":false,"comment_ctime":1547539061,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1547539061","product_id":100020901,"comment_content":"è€å¸ˆæ‚¨å¥½ï¼Œæ‰“æ‰°äº†ï¼Œæˆ‘è¿½é—®çš„å†…å®¹éº»çƒ¦æ‚¨æŠ½ç©ºå›ç­”ä¸‹ï¼š<br>---------è¿½é—®-------------------------<br>é¦–å…ˆè°¢è°¢è€å¸ˆçš„é—®ç­”ï¼Œå¯èƒ½æ˜¯æˆ‘æ²¡æœ‰æè¿°æ¸…æ¥šã€‚ä¸€æ˜¯ï¼Œå¦‚æœæŒ‰ç…§è€å¸ˆè¯´çš„â€œä¸å¼€swapï¼Œæ²¡æ³•å›æ”¶â€é‚£ä¹ˆæˆ‘ç³»ç»Ÿäº§ç”Ÿçš„å¤§é‡åŒ¿åé¡µæ€ä¹ˆåŠï¼Ÿæ˜¯ä¸æ˜¯ä¸€ç›´åœ¨å†…å­˜é‡Œï¼Œä¸èƒ½è¢«å›æ”¶ï¼Ÿç›´åˆ°å¼•å‘oomï¼ŒæŠŠè¿™ä¸ªè¿›ç¨‹å¹²æ‰ï¼Ÿï¼›äºŒæ˜¯â€œ å–å†³äºè¿™äº›é¡µçš„å®é™…è®¿é—®æƒ…å†µï¼Œåªè¦ä¸€è®¿é—®ï¼Œå°±ä¼šæ¢å…¥åˆ°å†…å­˜ä¸­â€å¦‚æœè¿™äº›è¢«æ¢åˆ°swapä¸Šçš„åŒ¿åé¡µé‡å¾ˆå¤§ ï¼ŒæŠŠswapéƒ½å†™æ»¡äº†ï¼Œè¿™ä¸ªæ—¶å€™æ˜¯æ€ä¹ˆé€‰æ‹©ä»swapé‡Œæ¸…ç†å“ªäº›åŒ¿åé¡µå‘¢ï¼Ÿ<br>è°¢è°¢","like_count":0},{"had_liked":false,"id":60481,"user_name":"ddel_07","can_delete":false,"product_type":"c1","uid":1295801,"ip_address":"","ucode":"34FEA2CB2B96CD","user_header":"https://static001.geekbang.org/account/avatar/00/13/c5/b9/e592d576.jpg","comment_is_top":false,"comment_ctime":1547477752,"is_pvip":false,"replies":[{"id":"22301","content":"æ ˆæº¢å‡ºç¨‹åºä¼šç›´æ¥æŠ¥é”™çš„","user_name":"ä½œè€…å›å¤","user_name_real":"å€ªæœ‹é£","uid":"1001282","ctime":1548248742,"ip_address":"","comment_id":60481,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1547477752","product_id":100020901,"comment_content":"è€å¸ˆï¼Œæœ‰æ²¡æœ‰æ£€æŸ¥æ ˆæº¢å‡ºçš„å·¥å…·ï¼Ÿå› ä¸ºä¹‹å‰æœ‰ä¸€ä¸ªå¾ˆæ·±è°ƒç”¨æ ˆçš„å‡½æ•°å‘ç”Ÿäº†å…¥å‚ä¸å¯è®¿é—®çš„æ®µé”™è¯¯ï¼Œæ‰€ä»¥æƒ³æŸ¥æŸ¥æ˜¯ä¸æ˜¯å¯èƒ½æ˜¯æ ˆæº¢å‡ºäº†ï¼Œä½†ä¸€ç›´æ²¡æ‰¾åˆ°åˆé€‚çš„å·¥å…·ã€‚","like_count":0,"discussions":[{"author":{"id":1001282,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/47/42/5b55bd1a.jpg","nickname":"å€ªæœ‹é£","note":"","ucode":"F0FAC195CDE7AC","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":436522,"discussion_content":"æ ˆæº¢å‡ºç¨‹åºä¼šç›´æ¥æŠ¥é”™çš„","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1548248742,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":58776,"user_name":"solar","can_delete":false,"product_type":"c1","uid":1316091,"ip_address":"","ucode":"D5BE087E264401","user_header":"http://thirdwx.qlogo.cn/mmopen/vi_32/dwehJHP4ycAfDb9MoudXb4QSt7YgmISqwwsa928XZ6aTWqwWh0kx0iatjocSibLa7iajXmbGlJ5svegY3P6LfKJ0w/132","comment_is_top":false,"comment_ctime":1547191435,"is_pvip":true,"replies":[{"id":"22292","content":"cacheæ˜¯ç³»ç»Ÿçº§çš„ï¼Œç›´æ¥çœ‹çš„è¯ï¼Œçœ‹ä¸å‡ºå“ªäº›è¿›ç¨‹å¯¼è‡´çš„ã€‚å¯ä»¥å€ŸåŠ© vmstat&#47;cachetop&#47;slabtop ç»¼åˆè§‚æµ‹","user_name":"ä½œè€…å›å¤","user_name_real":"å€ªæœ‹é£","uid":"1001282","ctime":1548247979,"ip_address":"","comment_id":58776,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1547191435","product_id":100020901,"comment_content":"æˆ‘æƒ³è¯·æ•™ä¸€ä¸ªé—®é¢˜ï¼Œåœ¨æˆ‘çš„ç³»ç»Ÿä¸­ï¼Œ64Gçš„å†…å­˜åŸºæœ¬è¢«è€—å°½ï¼Œä½†æ˜¯æœ‰14ä¸ªGçš„cacheï¼Œæˆ‘æƒ³æŸ¥è¯¢åˆ°åº•æ˜¯å“ªä¸ªè¿›ç¨‹ä½¿ç”¨äº†è¿™ä¹ˆå¤šçš„cacheï¼Œå¦‚ä½•æŸ¥è¯¢å‘¢ï¼Ÿæˆ‘ä½¿ç”¨top,smemç­‰å·¥å…·ï¼Œéƒ½çœ‹ä¸åˆ°åˆ°åº•æ˜¯å“ªä¸ªè¿›ç¨‹ä½¿ç”¨è¿™ä¹ˆå¤šçš„cacheï¼Œè¯·æŒ‡æ•™å¦‚ä½•æŸ¥è¯¢ã€‚","like_count":0,"discussions":[{"author":{"id":1001282,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/47/42/5b55bd1a.jpg","nickname":"å€ªæœ‹é£","note":"","ucode":"F0FAC195CDE7AC","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":436208,"discussion_content":"cacheæ˜¯ç³»ç»Ÿçº§çš„ï¼Œç›´æ¥çœ‹çš„è¯ï¼Œçœ‹ä¸å‡ºå“ªäº›è¿›ç¨‹å¯¼è‡´çš„ã€‚å¯ä»¥å€ŸåŠ© vmstat/cachetop/slabtop ç»¼åˆè§‚æµ‹","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1548247979,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":58691,"user_name":"Brownç¾Šç¾Š","can_delete":false,"product_type":"c1","uid":1315332,"ip_address":"","ucode":"354EC478E57DEE","user_header":"https://static001.geekbang.org/account/avatar/00/14/12/04/5837b21c.jpg","comment_is_top":false,"comment_ctime":1547176605,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1547176605","product_id":100020901,"comment_content":"æ‰“å¡ä¸€ä¸‹","like_count":0},{"had_liked":false,"id":58588,"user_name":"äºŒä¸‰å­ä¹Ÿ","can_delete":false,"product_type":"c1","uid":1245787,"ip_address":"","ucode":"69C7D86583277D","user_header":"https://static001.geekbang.org/account/avatar/00/13/02/5b/ce326cfc.jpg","comment_is_top":false,"comment_ctime":1547125241,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1547125241","product_id":100020901,"comment_content":"Flag<br>è¿˜å¥½æ²¡æ‰é˜Ÿï¼Œè¿™ç§å®šæœŸçš„ç­”ç–‘ä¸æ€»ç»“è¶…èµã€‚","like_count":0},{"had_liked":false,"id":58538,"user_name":"æˆ‘æ¥ä¹Ÿ","can_delete":false,"product_type":"c1","uid":1205253,"ip_address":"","ucode":"773D6104F56767","user_header":"https://static001.geekbang.org/account/avatar/00/12/64/05/6989dce6.jpg","comment_is_top":false,"comment_ctime":1547107470,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1547107470","product_id":100020901,"comment_content":"[D22æ‰“å¡]<br>é€šè¿‡å­¦ä¹  å†…å­˜æ€§èƒ½ç¯‡ å¯¹linuxå†…å­˜çš„åˆ†é…æœ‰äº†æ›´æ·±å…¥çš„ç†è§£.<br>å‡†å¤‡ç”¨å­¦ä¹ çš„çŸ¥è¯†æ¥åˆ†æç”Ÿäº§ç¯å¢ƒä¸­çš„ä¸€ä¸ªå†…å­˜é—®é¢˜:<br>æŸä¸ªè¿›ç¨‹(C+LUA)å†…å­˜æŒç»­å‡é«˜,céƒ¨åˆ†çš„å†…å­˜æ˜¯ç¨‹åºå¯åŠ¨æ—¶å°±ç”³è¯·å¥½äº†çš„,è¿è¡Œè¿‡ç¨‹ä¸­ä¸ä¼šæœ‰æ˜æ˜¾å˜åŒ–.<br>luaä¸­é€šè¿‡è°ƒç”¨ collectgarbage(&#39;count&#39;)  å’Œ   collectgarbage(&#39;collect&#39;) æ¯”è¾ƒå›æ”¶å‰å’Œå›æ”¶åçš„å†…å­˜.<br>å¯åŠ¨æ—¶æ•´ä¸ªç¨‹åºçš„å®é™…å ç”¨å†…å­˜100M, è·‘ä¸äº†ä¸€å¤©, å®é™…å†…å­˜å°±å‡åˆ°äº†400M+,è€ŒLUAä¸­æ‰“å°çš„å†…å­˜ä¹Ÿæ‰70M+.<br>è™½ç„¶ä¹Ÿäº†è§£luaè™šæ‹Ÿæœºé‡Šæ”¾çš„å†…å­˜,å¹¶ä¸ä¼šåŠæ—¶çš„è¢«ç¨‹åºé‡Šæ”¾, ä½†è¿™å¤šå‡ºæ¥çš„200Må†…å­˜ä¸çŸ¥é“æ¶ˆè€—åœ¨ä»€ä¹ˆåœ°æ–¹äº†.<br>ä¸€å°æœºå™¨ä¸Š,åå‡ ä¸ªè¿›ç¨‹éƒ½è¿™æ ·,æ€»æ¶ˆè€—çš„å†…å­˜å°±æ¯”è¾ƒå¯è§‚äº†.<br><br>æœŸå¾…æ¥ä¸‹æ¥çš„ I&#47;O æ€§èƒ½ç¯‡.<br>æœ€è¿‘å‡ å¤©å¤ªå¿™äº†, æ˜¨å¤©å‡ºçš„æ–‡ç« ç°åœ¨æ‰æœ‰æ—¶é—´çœ‹.<br>","like_count":0},{"had_liked":false,"id":58421,"user_name":"wykkx","can_delete":false,"product_type":"c1","uid":1122358,"ip_address":"","ucode":"ABCDF49E7A95C8","user_header":"https://static001.geekbang.org/account/avatar/00/11/20/36/b3e2f1d5.jpg","comment_is_top":false,"comment_ctime":1547081007,"is_pvip":false,"replies":[{"id":"21150","content":"1. ä¸å¼€swapï¼Œæ²¡æ³•å›æ”¶<br>2. å–å†³äºè¿™äº›é¡µçš„å®é™…è®¿é—®æƒ…å†µï¼Œåªè¦ä¸€è®¿é—®ï¼Œå°±ä¼šæ¢å…¥åˆ°å†…å­˜ä¸­","user_name":"ä½œè€…å›å¤","user_name_real":"å€ªæœ‹é£","uid":"1001282","ctime":1547124277,"ip_address":"","comment_id":58421,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1547081007","product_id":100020901,"comment_content":"è€å¸ˆæ‚¨å¥½ï¼Œè¯·æ•™ä¸€ä¸ªé—®é¢˜ï¼Œæ‚¨è¯´åŒ¿åé¡µå›æ”¶æ˜¯ä½¿ç”¨swapæœºåˆ¶ï¼Œé‚£ä¹ˆè¿™é‡Œæœ‰å‡ ä¸ªé—®é¢˜ï¼šä¸€æ˜¯å¦‚æœæˆ‘çš„ç³»ç»Ÿä¸å¼€å¯swapï¼ˆç°åœ¨å¾ˆå¤šç³»ç»Ÿéƒ½æ˜¯ä¸å¼€å¯swapçš„ï¼Œå°¤å…¶æ˜¯webç±»åº”ç”¨ï¼Œä¸ºäº†æå‡å“åº”æ—¶é—´ï¼‰ï¼Œé‚£ä¹ˆåŒ¿åé¡µè¿˜æ€ä¹ˆå›æ”¶ï¼ŸäºŒæ˜¯å³ä½¿æˆ‘å¼€å¯äº†swapï¼ŒåŒ¿åé¡µè¢«æ”¾åˆ°äº†swapä¸Šï¼Œé‚£ä¹ˆswapæ˜¯å¦‚ä½•æ¸…ç†è¿™äº›åŒ¿åé¡µçš„ï¼Œæ€»ä¸èƒ½ä¸€è‡´ä¿å­˜è¿™äº›åŒ¿åé¡µå§ã€‚è°¢è°¢è€å¸ˆ","like_count":0,"discussions":[{"author":{"id":1001282,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/47/42/5b55bd1a.jpg","nickname":"å€ªæœ‹é£","note":"","ucode":"F0FAC195CDE7AC","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":436056,"discussion_content":"1. ä¸å¼€swapï¼Œæ²¡æ³•å›æ”¶\n2. å–å†³äºè¿™äº›é¡µçš„å®é™…è®¿é—®æƒ…å†µï¼Œåªè¦ä¸€è®¿é—®ï¼Œå°±ä¼šæ¢å…¥åˆ°å†…å­˜ä¸­","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1547124277,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":58414,"user_name":"Bruce","can_delete":false,"product_type":"c1","uid":1130514,"ip_address":"","ucode":"31D1CACDCA6AA6","user_header":"https://static001.geekbang.org/account/avatar/00/11/40/12/b0206f40.jpg","comment_is_top":false,"comment_ctime":1547078320,"is_pvip":false,"replies":[{"id":"21152","content":"é™¤äº†CPUã€Memï¼Œè¿˜æœ‰ I&#47;O å’Œç½‘ç»œï¼Œå…·ä½“æ€ä¹ˆåˆ†æè¿˜è¦çœ‹ä½ ç¢°åˆ°äº†ä»€ä¹ˆé—®é¢˜ã€‚cpuå’Œmemå˜åŒ–ä¸å¤§çœ‹èµ·æ¥æ˜¯ä¸ªå¥½äº‹å‘€","user_name":"ä½œè€…å›å¤","user_name_real":"å€ªæœ‹é£","uid":"1001282","ctime":1547124490,"ip_address":"","comment_id":58414,"utype":1}],"discussion_count":2,"race_medal":0,"score":"1547078320","product_id":100020901,"comment_content":"è€å¸ˆå¥½ï¼Œå·¥ä½œä¸­é‡åˆ°è¿™æ ·æƒ…æ™¯ï¼š  ä¸€ä¸ªæœåŠ¡è·‘åœ¨Linuxä¸Šï¼Œ å®¢æˆ·ç«¯é€šè¿‡httpå’ŒæœåŠ¡ç«¯é€šä¿¡ï¼Œä¸ç®¡å®¢æˆ·ç«¯æ€ä¹ˆå¢åŠ ï¼ŒæœåŠ¡ç«¯çš„cpu memå§‹ç»ˆå˜åŒ–ä¸å¤§ï¼Œ è¿™ç§æƒ…å†µä¸‹æƒ³å¬å¬è€å¸ˆå¹³æ—¶ä¸€èˆ¬æ˜¯æ€ä¹ˆç³»ç»Ÿæ€§debugçš„","like_count":0,"discussions":[{"author":{"id":1001282,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/47/42/5b55bd1a.jpg","nickname":"å€ªæœ‹é£","note":"","ucode":"F0FAC195CDE7AC","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":436053,"discussion_content":"é™¤äº†CPUã€Memï¼Œè¿˜æœ‰ I/O å’Œç½‘ç»œï¼Œå…·ä½“æ€ä¹ˆåˆ†æè¿˜è¦çœ‹ä½ ç¢°åˆ°äº†ä»€ä¹ˆé—®é¢˜ã€‚cpuå’Œmemå˜åŒ–ä¸å¤§çœ‹èµ·æ¥æ˜¯ä¸ªå¥½äº‹å‘€","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1547124490,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1959822,"avatar":"https://static001.geekbang.org/account/avatar/00/1d/e7/8e/318cfde0.jpg","nickname":"Spoon","note":"","ucode":"2FF9193AD482C2","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":338601,"discussion_content":"å¤§æ¦‚ç‡ç“¶é¢ˆæ˜¯I/O","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1609321115,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":58148,"user_name":"Adam","can_delete":false,"product_type":"c1","uid":1305633,"ip_address":"","ucode":"338BA720880E4F","user_header":"https://static001.geekbang.org/account/avatar/00/13/ec/21/b0fe1bfd.jpg","comment_is_top":false,"comment_ctime":1547002698,"is_pvip":false,"replies":[{"id":"20984","content":"ğŸ˜Š è°¢è°¢","user_name":"ä½œè€…å›å¤","user_name_real":"å€ªæœ‹é£","uid":"1001282","ctime":1547027355,"ip_address":"","comment_id":58148,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1547002698","product_id":100020901,"comment_content":"è¿™ä¸ªä¸“æ ï¼Œå¯¹äºè¿ç»´åŒå­¦æ¥è¯´çœŸæ˜¯å¤ªæ£’äº†ã€‚","like_count":0,"discussions":[{"author":{"id":1001282,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/47/42/5b55bd1a.jpg","nickname":"å€ªæœ‹é£","note":"","ucode":"F0FAC195CDE7AC","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":435928,"discussion_content":"ğŸ˜Š è°¢è°¢","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1547027355,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":58086,"user_name":"é£é£˜ï¼Œå¾ç‹¬æ€","can_delete":false,"product_type":"c1","uid":1131032,"ip_address":"","ucode":"4DF0E7DC22EE53","user_header":"https://static001.geekbang.org/account/avatar/00/11/42/18/edc1b373.jpg","comment_is_top":false,"comment_ctime":1546995163,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1546995163","product_id":100020901,"comment_content":"æ‰“å¡","like_count":0}]}