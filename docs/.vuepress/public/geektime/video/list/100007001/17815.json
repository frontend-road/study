{"id":17815,"title":"97 | 网关集成 Hystrix (Code Review)","content":"无","comments":[{"had_liked":false,"id":51283,"user_name":"超","can_delete":false,"product_type":"c3","uid":1048159,"ip_address":"","ucode":"554F5C30D1B1B2","user_header":"","comment_is_top":false,"comment_ctime":1545146231,"is_pvip":false,"replies":[{"id":18694,"content":"自定义post filter，截获response，根据需要定制异常，再返回前端。","user_name":"作者回复","user_name_real":"杨波","uid":1030344,"ctime":1545223145,"ip_address":"","comment_id":51283,"utype":1}],"discussion_count":1,"race_medal":0,"score":2,"product_id":100007001,"comment_content":"如果zuul网关集成hystrix后调服务A异常，如果A没做异常处理，会通过zuul直接返回前端，这样很不好的，如果要在zuul网关层做处理，返回一个有好的错误提示，怎么做比较好呢","like_count":3,"discussions":[{"author":{"id":1030344,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/b8/c8/c94d38a7.jpg","nickname":"杨波","note":"","ucode":"FA3418BB703BCA","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":433379,"discussion_content":"自定义post filter，截获response，根据需要定制异常，再返回前端。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1545223145,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":52376,"user_name":"王盛武","can_delete":false,"product_type":"c3","uid":1182516,"ip_address":"","ucode":"DE7EF246D3DCE8","user_header":"https://static001.geekbang.org/account/avatar/00/12/0b/34/f41d73a4.jpg","comment_is_top":false,"comment_ctime":1545371928,"is_pvip":false,"replies":[{"id":19113,"content":"我们做系统架构有个职责单一，关注分离原则，一个系统不可能样样都做，公网访问安全问题是运维层要解决的问题。","user_name":"作者回复","user_name_real":"杨波","uid":1030344,"ctime":1545399286,"ip_address":"","comment_id":52376,"utype":1}],"discussion_count":1,"race_medal":0,"score":2,"product_id":100007001,"comment_content":"如果有多IDC， turbine聚合多个点的话，通过公网访问， 有泄露数据隐私哦\n出来IP白名单，还好的解决办法嚒？","like_count":1,"discussions":[{"author":{"id":1030344,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/b8/c8/c94d38a7.jpg","nickname":"杨波","note":"","ucode":"FA3418BB703BCA","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":433851,"discussion_content":"我们做系统架构有个职责单一，关注分离原则，一个系统不可能样样都做，公网访问安全问题是运维层要解决的问题。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1545399286,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":175421,"user_name":"Xg huang","can_delete":false,"product_type":"c3","uid":1016995,"ip_address":"","ucode":"9680FA95DE3553","user_header":"","comment_is_top":false,"comment_ctime":1580715304,"is_pvip":false,"replies":[{"id":68194,"content":"信号量(semaphore)的maxConcurrentRequests其实并不是以秒为单位的。信号量机制是这样的：每当有一个请求调用进入，信号量就减1，如果这个请求完成退出，信号量就加1。如果信号量设成100，表示同时可进入的最大请求数是100，也就是调用进入但是还没有返回的请求数，最大只能是100个。如果有100个请求已经进入，但是都还没有返回，那么这个时候信号量就变成0，如果这个时候第101个请求过来，就不允许进入了调用了，会被拒绝。这就是最大并发请求数的含义。","user_name":"作者回复","user_name_real":"杨波","uid":1030344,"ctime":1580733580,"ip_address":"","comment_id":175421,"utype":1}],"discussion_count":2,"race_medal":0,"score":2,"product_id":100007001,"comment_content":"请教一下波波老师，max concurrent requests  这个参数所指的并发量是以秒为单位吗？","like_count":0,"discussions":[{"author":{"id":1030344,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/b8/c8/c94d38a7.jpg","nickname":"杨波","note":"","ucode":"FA3418BB703BCA","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":482724,"discussion_content":"信号量(semaphore)的maxConcurrentRequests其实并不是以秒为单位的。信号量机制是这样的：每当有一个请求调用进入，信号量就减1，如果这个请求完成退出，信号量就加1。如果信号量设成100，表示同时可进入的最大请求数是100，也就是调用进入但是还没有返回的请求数，最大只能是100个。如果有100个请求已经进入，但是都还没有返回，那么这个时候信号量就变成0，如果这个时候第101个请求过来，就不允许进入了调用了，会被拒绝。这就是最大并发请求数的含义。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1580733580,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1016995,"avatar":"","nickname":"Xg huang","note":"","ucode":"9680FA95DE3553","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":160202,"discussion_content":"好的，明白了。\n\n原来信号量是跟系统的处理能力和请求数量有关。\n\n谢谢老师🙏","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1580779039,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":293955,"user_name":"独孤九剑","can_delete":false,"product_type":"c3","uid":2230909,"ip_address":"","ucode":"6C1253E2B8C1D4","user_header":"https://static001.geekbang.org/account/avatar/00/22/0a/7d/ac715471.jpg","comment_is_top":false,"comment_ctime":1621648883,"is_pvip":false,"replies":null,"discussion_count":0,"race_medal":0,"score":2,"product_id":100007001,"comment_content":"信号量本质是共享资源计数器S，有两种操作：P(S),V(S)","like_count":0}]}