{"id":781899,"title":"22｜条件类型概要","content":"","comments":[{"had_liked":false,"id":391638,"user_name":"Aiming","can_delete":false,"product_type":"c3","uid":1521669,"ip_address":"江苏","ucode":"66292B32F9960A","user_header":"https://static001.geekbang.org/account/avatar/00/17/38/05/7beecd5d.jpg","comment_is_top":true,"comment_ctime":1718709158,"is_pvip":false,"replies":null,"discussion_count":0,"race_medal":0,"score":2,"product_id":100761001,"comment_content":"既如此，写个标准答案吧。—— 其实在27讲里写的AllKeys，就是类似的处理。不过27讲里检测的是`... extends never`，而不是这里的`true extends ...`。大家可以对照着看看。\n\n```typescript\ntype Keys&lt;T, P = PropertyKey&gt; = keyof {\n    [k in keyof T as\n        true extends (P extends k ? true : never) ? never : k]: any\n};\n\ntype Signs&lt;T&gt; = Exclude&lt;keyof T, Keys&lt;T&gt;&gt;;\n```","like_count":1},{"had_liked":false,"id":393352,"user_name":"Geek_aeb936","can_delete":false,"product_type":"c3","uid":3887128,"ip_address":"日本","ucode":"863338D4895F25","user_header":"","comment_is_top":false,"comment_ctime":1723578841,"is_pvip":false,"replies":[{"id":142858,"content":"不算。U必须有两个条件，一是是“类型参数”，例如范型参数或者推断参数名；二是裸的、不加其它运算的作为extends的左侧运算数。","user_name":"作者回复","user_name_real":"编辑","uid":1521669,"ctime":1723617652,"ip_address":"江苏","comment_id":393352,"utype":1}],"discussion_count":1,"race_medal":0,"score":2,"product_id":100761001,"comment_content":"老师好\ntype U = &quot;a&quot; | 2;\ntype X41 = U extends string ? &#39;true&#39; : &#39;false&#39;; &#47;&#47; type X41 = &quot;false&quot;\n这样算是裸类型参数传入吗？\n这样看起来是没有进行分布式运算？","like_count":0,"discussions":[{"author":{"id":1521669,"avatar":"https://static001.geekbang.org/account/avatar/00/17/38/05/7beecd5d.jpg","nickname":"Aiming","note":"","ucode":"66292B32F9960A","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":649583,"discussion_content":"不算。U必须有两个条件，一是是“类型参数”，例如范型参数或者推断参数名；二是裸的、不加其它运算的作为extends的左侧运算数。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1723617652,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"江苏","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2,\"source\":0}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":391570,"user_name":"Jack Q","can_delete":false,"product_type":"c3","uid":1160078,"ip_address":"广东","ucode":"A7DBC311884FFA","user_header":"https://static001.geekbang.org/account/avatar/00/11/b3/8e/1c564eb2.jpg","comment_is_top":false,"comment_ctime":1718551456,"is_pvip":false,"replies":[{"id":142405,"content":":)\n\n在留言里给了个标准答案。","user_name":"作者回复","user_name_real":"编辑","uid":1521669,"ctime":1718709181,"ip_address":"江苏","comment_id":391570,"utype":1}],"discussion_count":1,"race_medal":0,"score":2,"product_id":100761001,"comment_content":"type T = {\n  [K: string | symbol | number]: string | number;\n  a: string;\n  b: number;\n  c: 1;\n  2: 3;\n  [Symbol.iterator]:&#39;3&#39;;\n}\n&#47;&#47; Signs&lt;T&gt; 和 Keys&lt;T&gt;\n\ntype Equal&lt;primitive, index&gt; = index extends primitive ? primitive extends index ? true : false : false;\n&#47;&#47; index -&gt; string | number | symbol\ntype IsIndex&lt;k&gt; = Equal&lt;string | number | symbol, k&gt;;\n\ntype Signs&lt;T extends Record&lt;string | string | number, any&gt;&gt; = Exclude&lt;keyof {\n  [k in keyof T as (\n    true extends IsIndex&lt;k&gt; ? k : never\n  )]: T[k];\n}, never&gt;\n\ntype signs = Signs&lt;T&gt;\n\n&#47;&#47; key: 非 index 即是key\ntype Keys&lt;T extends Record&lt;string | string | number, any&gt;&gt; = keyof ({\n  [k in keyof T as (\n    true extends IsIndex&lt;k&gt; ? never : k\n  )]: T[k];\n})\ntype keys = Keys&lt;T&gt;","like_count":0,"discussions":[{"author":{"id":1521669,"avatar":"https://static001.geekbang.org/account/avatar/00/17/38/05/7beecd5d.jpg","nickname":"Aiming","note":"","ucode":"66292B32F9960A","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":646771,"discussion_content":":)\n\n在留言里给了个标准答案。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1718709181,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"江苏","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2,\"source\":0}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":391526,"user_name":"fatme","can_delete":false,"product_type":"c3","uid":1034451,"ip_address":"广东","ucode":"75A805D2BB2AD1","user_header":"https://static001.geekbang.org/account/avatar/00/0f/c8/d3/3020ae46.jpg","comment_is_top":false,"comment_ctime":1718429150,"is_pvip":false,"replies":[{"id":142375,"content":"：）\n\nIsOneOfUnionAssignableTo中的false分支应该返回never。思考下为什么呵~ \n","user_name":"作者回复","user_name_real":"编辑","uid":1521669,"ctime":1718519165,"ip_address":"江苏","comment_id":391526,"utype":1}],"discussion_count":1,"race_medal":0,"score":2,"product_id":100761001,"comment_content":"IsIndexSignaturePrimitiveType&lt;&gt; 的简便实现：\n&#47;&#47;&#47;&#47; 简便实现\ntype IsOneOfUnionAssignableTo&lt;Union, T&gt; = Union extends T ? true : false;\ntype IsIndexSignaturePrimitiveType2&lt;T&gt; = IsOneOfUnionAssignableTo&lt;string | number | symbol, T&gt;;","like_count":0,"discussions":[{"author":{"id":1521669,"avatar":"https://static001.geekbang.org/account/avatar/00/17/38/05/7beecd5d.jpg","nickname":"Aiming","note":"","ucode":"66292B32F9960A","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":646671,"discussion_content":"：）\n\nIsOneOfUnionAssignableTo中的false分支应该返回never。思考下为什么呵~ \n","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1718519166,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"江苏","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2,\"source\":0}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":391332,"user_name":"fatme","can_delete":false,"product_type":"c3","uid":1034451,"ip_address":"广东","ucode":"75A805D2BB2AD1","user_header":"https://static001.geekbang.org/account/avatar/00/0f/c8/d3/3020ae46.jpg","comment_is_top":false,"comment_ctime":1718011295,"is_pvip":false,"replies":[{"id":142330,"content":"正确。+1分\n可以尝试寻求一下更简洁的写法，包括IsIndexSignaturePrimitiveType&lt;&gt;。","user_name":"作者回复","user_name_real":"编辑","uid":1521669,"ctime":1718116902,"ip_address":"江苏","comment_id":391332,"utype":1}],"discussion_count":3,"race_medal":0,"score":2,"product_id":100761001,"comment_content":"type T22_8 = {\n    [k: string|symbol|number]: string | number;\n    a: string;\n    b: number;\n    c: 1;\n}\ntype Signs&lt;T&gt; = Exclude&lt;keyof {\n    [k in keyof T as (\n        true extends IsIndexSignaturePrimitiveType&lt;k&gt; ? k : never\n    )]: T[k];\n}, never&gt;;\ntype Keys&lt;T&gt; = keyof {\n    [k in keyof T as (\n        true extends IsIndexSignaturePrimitiveType&lt;k&gt; ? never : k\n    )]: T[k];\n}\ntype signs = Signs&lt;T22_8&gt;;\ntype keys = Keys&lt;T22_8&gt;;","like_count":0,"discussions":[{"author":{"id":1521669,"avatar":"https://static001.geekbang.org/account/avatar/00/17/38/05/7beecd5d.jpg","nickname":"Aiming","note":"","ucode":"66292B32F9960A","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":646500,"discussion_content":"正确。+1分\n可以尝试寻求一下更简洁的写法，包括IsIndexSignaturePrimitiveType&lt;&gt;。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1718116903,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"江苏","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2,\"source\":0}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1034451,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/c8/d3/3020ae46.jpg","nickname":"fatme","note":"","ucode":"75A805D2BB2AD1","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":646545,"discussion_content":"修改实现 IsIndexSignaturePrimitiveType&lt;&gt; 的代码：\ntype IsAssignable&lt;T_1, T_2&gt; = T_1 extends T_2 ? true : false;\ntype IsSameType&lt;T_1, T_2&gt; = IsAssignable&lt;T_1, T_2&gt; &amp; IsAssignable&lt;T_2, T_1&gt;;\ntype IsIndexSignaturePrimitiveType&lt;T&gt; = IsSameType&lt;T, string&gt; | IsSameType&lt;T, number&gt; | IsSameType&lt;T, symbol&gt;;","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1718185735,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":"广东","group_id":0},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1034451,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/c8/d3/3020ae46.jpg","nickname":"fatme","note":"","ucode":"75A805D2BB2AD1","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":646480,"discussion_content":"漏了下面代码：\ntype IsIndexSignaturePrimitiveType&lt;T&gt; = string extends T ? true : (number extends T ? true : (symbol extends T ? true : false));","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1718074828,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":"广东","group_id":0},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]}]}