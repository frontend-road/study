{"id":417164,"title":"02 | RDDä¸ç¼–ç¨‹æ¨¡å‹ï¼šå»¶è¿Ÿè®¡ç®—æ˜¯æ€ä¹ˆå›äº‹ï¼Ÿ","content":"<p>ä½ å¥½ï¼Œæˆ‘æ˜¯å´ç£Šã€‚</p><p>åœ¨ä¸Šä¸€è®²ï¼Œæˆ‘ä»¬ä¸€èµ·å¼€å‘äº†ä¸€ä¸ªWord Countå°åº”ç”¨ï¼Œå¹¶æŠŠå®ƒæ•²å…¥åˆ°spark-shellä¸­å»æ‰§è¡Œã€‚Word Countçš„è®¡ç®—æ­¥éª¤éå¸¸ç®€å•ï¼Œé¦–å…ˆæ˜¯è¯»å–æ•°æ®æºï¼Œç„¶åæ˜¯åšåˆ†è¯ï¼Œæœ€ååšåˆ†ç»„è®¡æ•°ã€å¹¶æŠŠè¯é¢‘æœ€é«˜çš„å‡ ä¸ªè¯æ±‡æ‰“å°åˆ°å±å¹•ä¸Šã€‚</p><p>å¦‚æœä½ ä¹ŸåŠ¨æ‰‹å®è·µäº†è¿™ä¸ªç¤ºä¾‹ï¼Œä½ å¯èƒ½ä¼šå‘ç°ï¼Œåœ¨spark-shellçš„REPLé‡Œï¼Œæ‰€æœ‰ä»£ç éƒ½æ˜¯ç«‹å³è¿”å›ã€ç¬é—´å°±æ‰§è¡Œå®Œæ¯•äº†ï¼Œç›¸æ¯”ä¹‹ä¸‹ï¼Œåªæœ‰æœ€åä¸€è¡Œä»£ç ï¼ŒèŠ±äº†å¥½é•¿æ—¶é—´æ‰åœ¨å±å¹•ä¸Šæ‰“å°å‡ºtheã€Sparkã€aã€andå’Œofè¿™å‡ ä¸ªå•è¯ã€‚</p><p>é’ˆå¯¹è¿™ä¸ªç°è±¡ï¼Œä½ å¯èƒ½ä¼šè§‰å¾—å¾ˆå¥‡æ€ªï¼šâ€œè¯»å–æ•°æ®æºã€åˆ†ç»„è®¡æ•°åº”è¯¥æ˜¯æœ€è€—æ—¶çš„æ­¥éª¤ï¼Œä¸ºä»€ä¹ˆå®ƒä»¬ç¬é—´å°±è¿”å›äº†å‘¢ï¼Ÿæ‰“å°å•è¯åº”è¯¥æ˜¯ç¬é—´çš„äº‹ï¼Œä¸ºä»€ä¹ˆè¿™ä¸€æ­¥åè€Œæ˜¯æœ€è€—æ—¶çš„å‘¢ï¼Ÿâ€è¦è§£ç­”è¿™ä¸ªç–‘æƒ‘ï¼Œæˆ‘ä»¬è¿˜æ˜¯å¾—ä»RDDè¯´èµ·ã€‚</p><h2>ä»€ä¹ˆæ˜¯RDD</h2><p>ä¸ºä»€ä¹ˆéè¦ä»RDDè¯´èµ·å‘¢ï¼Ÿé¦–å…ˆï¼ŒRDDæ˜¯æ„å»ºSparkåˆ†å¸ƒå¼å†…å­˜è®¡ç®—å¼•æ“çš„åŸºçŸ³ï¼Œå¾ˆå¤šSparkæ ¸å¿ƒæ¦‚å¿µä¸æ ¸å¿ƒç»„ä»¶ï¼Œå¦‚DAGå’Œè°ƒåº¦ç³»ç»Ÿéƒ½è¡ç”Ÿè‡ªRDDã€‚å› æ­¤ï¼Œæ·±å…¥ç†è§£RDDæœ‰åˆ©äºä½ æ›´å…¨é¢ã€ç³»ç»Ÿåœ°å­¦ä¹  Spark çš„å·¥ä½œåŸç†ã€‚</p><p>å…¶æ¬¡ï¼Œå°½ç®¡RDD APIä½¿ç”¨é¢‘ç‡è¶Šæ¥è¶Šä½ï¼Œç»å¤§å¤šæ•°äººä¹Ÿéƒ½å·²ç»ä¹ æƒ¯äºDataFrameå’ŒDataset APIï¼Œä½†æ˜¯ï¼Œæ— è®ºé‡‡ç”¨å“ªç§APIæˆ–æ˜¯å“ªç§å¼€å‘è¯­è¨€ï¼Œä½ çš„åº”ç”¨åœ¨Sparkå†…éƒ¨æœ€ç»ˆéƒ½ä¼šè½¬åŒ–ä¸ºRDDä¹‹ä¸Šçš„åˆ†å¸ƒå¼è®¡ç®—ã€‚æ¢å¥è¯è¯´ï¼Œå¦‚æœä½ æƒ³è¦å¯¹Sparkä½œä¸šæœ‰æ›´å¥½çš„æŠŠæ¡ï¼Œå‰ææ˜¯ä½ è¦å¯¹RDDè¶³å¤Ÿäº†è§£ã€‚</p><!-- [[[read_end]]] --><p>æ—¢ç„¶RDDå¦‚æ­¤é‡è¦ï¼Œé‚£ä¹ˆå®ƒåˆ°åº•æ˜¯ä»€ä¹ˆå‘¢ï¼Ÿç”¨ä¸€å¥è¯æ¥æ¦‚æ‹¬ï¼Œ<strong>RDDæ˜¯ä¸€ç§æŠ½è±¡ï¼Œæ˜¯Sparkå¯¹äºåˆ†å¸ƒå¼æ•°æ®é›†çš„æŠ½è±¡ï¼Œå®ƒç”¨äºå›Šæ‹¬æ‰€æœ‰å†…å­˜ä¸­å’Œç£ç›˜ä¸­çš„åˆ†å¸ƒå¼æ•°æ®å®ä½“</strong>ã€‚</p><p>åœ¨<a href=\"https://time.geekbang.org/column/article/415209\">ä¸Šä¸€è®²</a>ä¸­ï¼Œæˆ‘ä»¬æŠŠRDDçœ‹ä½œæ˜¯æ•°ç»„ï¼Œå’±ä»¬ä¸å¦¨å»¶ç»­è¿™ä¸ªæ€è·¯ï¼Œé€šè¿‡å¯¹æ¯”RDDä¸æ•°ç»„ä¹‹é—´çš„å·®å¼‚è®¤è¯†ä¸€ä¸‹RDDã€‚</p><p>æˆ‘åˆ—äº†ä¸€ä¸ªè¡¨ï¼Œåšäº†ä¸€ä¸‹RDDå’Œæ•°ç»„å¯¹æ¯”ï¼Œä½ å¯ä»¥å…ˆæ‰«ä¸€çœ¼ï¼š</p><p><img src=\"https://static001.geekbang.org/resource/image/71/76/7149ddfb053edfed4397ee27dc09b376.jpg?wh=1369x718\" alt=\"\" title=\"RDDä¸æ•°ç»„çš„å¯¹æ¯”\"></p><p>æˆ‘åœ¨è¡¨ä¸­ä»å››ä¸ªæ–¹é¢å¯¹æ•°ç»„å’ŒRDDè¿›è¡Œäº†å¯¹æ¯”ï¼Œç°åœ¨æˆ‘æ¥è¯¦ç»†è§£é‡Šä¸€ä¸‹ã€‚</p><p>é¦–å…ˆï¼Œå°±æ¦‚å¿µæœ¬èº«æ¥è¯´ï¼Œæ•°ç»„æ˜¯å®ä½“ï¼Œå®ƒæ˜¯ä¸€ç§å­˜å‚¨åŒç±»å…ƒç´ çš„æ•°æ®ç»“æ„ï¼Œè€ŒRDDæ˜¯ä¸€ç§æŠ½è±¡ï¼Œå®ƒæ‰€å›Šæ‹¬çš„æ˜¯åˆ†å¸ƒå¼è®¡ç®—ç¯å¢ƒä¸­çš„åˆ†å¸ƒå¼æ•°æ®é›†ã€‚</p><p>å› æ­¤ï¼Œè¿™ä¸¤è€…ç¬¬äºŒæ–¹é¢çš„ä¸åŒå°±æ˜¯åœ¨æ´»åŠ¨èŒƒå›´ï¼Œæ•°ç»„çš„â€œæ´»åŠ¨èŒƒå›´â€å¾ˆçª„ï¼Œä»…é™äºå•ä¸ªè®¡ç®—èŠ‚ç‚¹çš„æŸä¸ªè¿›ç¨‹å†…ï¼Œè€ŒRDDä»£è¡¨çš„æ•°æ®é›†æ˜¯è·¨è¿›ç¨‹ã€è·¨èŠ‚ç‚¹çš„ï¼Œå®ƒçš„â€œæ´»åŠ¨èŒƒå›´â€æ˜¯æ•´ä¸ªé›†ç¾¤ã€‚</p><p>è‡³äºæ•°ç»„å’ŒRDDçš„ç¬¬ä¸‰ä¸ªä¸åŒï¼Œåˆ™æ˜¯åœ¨æ•°æ®å®šä½æ–¹é¢ã€‚åœ¨æ•°ç»„ä¸­ï¼Œæ‰¿è½½æ•°æ®çš„åŸºæœ¬å•å…ƒæ˜¯å…ƒç´ ï¼Œè€ŒRDDä¸­æ‰¿è½½æ•°æ®çš„åŸºæœ¬å•å…ƒæ˜¯æ•°æ®åˆ†ç‰‡ã€‚åœ¨åˆ†å¸ƒå¼è®¡ç®—ç¯å¢ƒä¸­ï¼Œä¸€ä»½å®Œæ•´çš„æ•°æ®é›†ï¼Œä¼šæŒ‰ç…§æŸç§è§„åˆ™åˆ‡å‰²æˆå¤šä»½æ•°æ®åˆ†ç‰‡ã€‚è¿™äº›æ•°æ®åˆ†ç‰‡è¢«å‡åŒ€åœ°åˆ†å‘ç»™é›†ç¾¤å†…ä¸åŒçš„è®¡ç®—èŠ‚ç‚¹å’Œæ‰§è¡Œè¿›ç¨‹ï¼Œä»è€Œå®ç°åˆ†å¸ƒå¼å¹¶è¡Œè®¡ç®—ã€‚</p><p>é€šè¿‡ä»¥ä¸Šå¯¹æ¯”ï¼Œä¸éš¾å‘ç°ï¼Œ<strong>æ•°æ®åˆ†ç‰‡</strong>ï¼ˆPartitionsï¼‰æ˜¯RDDæŠ½è±¡çš„é‡è¦å±æ€§ä¹‹ä¸€ã€‚åœ¨åˆæ­¥è®¤è¯†äº†RDDä¹‹åï¼Œæ¥ä¸‹æ¥å’±ä»¬æ¢ä¸ªè§†è§’ï¼Œä»RDDçš„é‡è¦å±æ€§å‡ºå‘ï¼Œå»è¿›ä¸€æ­¥æ·±å…¥ç†è§£RDDã€‚è¦æƒ³åƒé€RDDï¼Œæˆ‘ä»¬å¿…é¡»æŒæ¡å®ƒçš„4å¤§å±æ€§ï¼š</p><ul>\n<li>partitionsï¼šæ•°æ®åˆ†ç‰‡</li>\n<li>partitionerï¼šåˆ†ç‰‡åˆ‡å‰²è§„åˆ™</li>\n<li>dependenciesï¼šRDDä¾èµ–</li>\n<li>computeï¼šè½¬æ¢å‡½æ•°</li>\n</ul><p>å¦‚æœå•ä»ç†è®ºå‡ºå‘ã€ç…§æœ¬å®£ç§‘åœ°å»è®²è¿™4å¤§å±æ€§ï¼Œæœªå…è¿‡äºæ¯ç‡¥ã€ä¹å‘³ã€æ²¡æ„æ€ï¼æ‰€ä»¥ï¼Œæˆ‘ä»¬ä»ä¸€ä¸ªåˆ¶ä½œè–¯ç‰‡çš„æ•…äº‹å¼€å§‹ï¼Œå»æ›´å¥½åœ°ç†è§£RDDçš„4å¤§å±æ€§ã€‚</p><h2>ä»è–¯ç‰‡çš„åŠ å·¥æµç¨‹çœ‹RDDçš„4å¤§å±æ€§</h2><p>åœ¨å¾ˆä¹…å¾ˆä¹…ä»¥å‰ï¼Œæœ‰ä¸ªç”Ÿäº§æ¡¶è£…è–¯ç‰‡çš„å·¥åŠï¼Œå·¥åŠçš„è§„æ¨¡è¾ƒå°ï¼Œå·¥è‰ºä¹Ÿæ¯”è¾ƒåŸå§‹ã€‚ä¸ºäº†å……åˆ†åˆ©ç”¨æ¯ä¸€é¢—åœŸè±†ã€é™ä½ç”Ÿäº§æˆæœ¬ï¼Œå·¥åŠä½¿ç”¨ 3 æ¡æµæ°´çº¿æ¥åŒæ—¶ç”Ÿäº§ 3 ç§ä¸åŒå°ºå¯¸çš„æ¡¶è£…è–¯ç‰‡ã€‚3 æ¡æµæ°´çº¿å¯ä»¥åŒæ—¶åŠ å·¥ 3 é¢—åœŸè±†ï¼Œæ¯æ¡æµæ°´çº¿çš„ä½œä¸šæµç¨‹éƒ½æ˜¯ä¸€æ ·çš„ï¼Œåˆ†åˆ«æ˜¯æ¸…æ´—ã€åˆ‡ç‰‡ã€çƒ˜ç„™ã€åˆ†å‘å’Œè£…æ¡¶ã€‚å…¶ä¸­ï¼Œåˆ†å‘ç¯èŠ‚ç”¨äºåŒºåˆ†å°ã€ä¸­ã€å¤§å· 3 ç§è–¯ç‰‡ï¼Œ3 ç§ä¸åŒå°ºå¯¸çš„è–¯ç‰‡åˆ†åˆ«è¢«å‘å¾€ç¬¬ 1ã€2ã€3 æ¡æµæ°´çº¿ã€‚å…·ä½“æµç¨‹å¦‚ä¸‹å›¾æ‰€ç¤ºã€‚</p><p><img src=\"https://static001.geekbang.org/resource/image/4f/da/4fc5769e03f68eae79ea92fbb4756bda.jpg?wh=1920x586\" alt=\"å›¾ç‰‡\" title=\"RDDçš„ç”Ÿæ´»åŒ–ç±»æ¯”\"></p><p>å¥½äº†ï¼Œæ•…äº‹è®²å®Œäº†ã€‚é‚£å¦‚æœæˆ‘ä»¬æŠŠæ¯ä¸€æ¡æµæ°´çº¿çœ‹ä½œæ˜¯åˆ†å¸ƒå¼è¿è¡Œç¯å¢ƒçš„è®¡ç®—èŠ‚ç‚¹ï¼Œç”¨è–¯ç‰‡ç”Ÿäº§çš„æµç¨‹å»ç±»æ¯” Spark åˆ†å¸ƒå¼è®¡ç®—ï¼Œä¼šæœ‰å“ªäº›æœ‰è¶£çš„å‘ç°å‘¢ï¼Ÿ</p><p>æ˜¾ç„¶ï¼Œè¿™é‡Œçš„æ¯ä¸€ç§é£Ÿæå½¢æ€ï¼Œå¦‚â€œå¸¦æ³¥åœŸè±†â€ã€â€œå¹²å‡€åœŸè±†â€ã€â€œåœŸè±†ç‰‡â€ç­‰ï¼Œéƒ½å¯ä»¥çœ‹æˆæ˜¯ä¸€ä¸ªä¸ªRDDã€‚è€Œ<strong>è–¯ç‰‡çš„åˆ¶ä½œè¿‡ç¨‹ï¼Œå®é™…ä¸Šå°±æ˜¯ä¸åŒé£Ÿæå½¢æ€çš„è½¬æ¢è¿‡ç¨‹</strong>ã€‚</p><p>èµ·åˆï¼Œå·¥äººä»¬ä»éº»è¢‹ä¸­æŠŠâ€œå¸¦æ³¥åœŸè±†â€åŠ è½½åˆ°æµæ°´çº¿ï¼Œè¿™äº›åœŸè±†ç»è¿‡æ¸…æ´—ä¹‹åï¼Œæ‘‡èº«ä¸€å˜ï¼Œæˆäº†â€œå¹²å‡€åœŸè±†â€ã€‚æ¥ä¸‹æ¥ï¼Œæµæ°´çº¿ä¸Šçš„åˆ‡ç‰‡æœºå†æŠŠâ€œå¹²å‡€åœŸè±†â€åˆ‡æˆâ€œåœŸè±†ç‰‡â€ï¼Œç„¶åç´§æ¥ç€æŠŠè¿™äº›åœŸè±†ç‰‡æ”¾è¿›çƒ¤ç®±ã€‚æœ€ç»ˆï¼ŒåœŸè±†ç‰‡çƒ¤ç†Ÿä¹‹åï¼Œå°±å˜æˆäº†å¯ä»¥æ”¾å¿ƒé£Ÿç”¨çš„å³é£Ÿè–¯ç‰‡ã€‚</p><p>é€šè¿‡åˆ†ææˆ‘ä»¬ä¸éš¾å‘ç°ï¼Œä¸åŒé£Ÿæå½¢æ€ä¹‹é—´çš„è½¬æ¢è¿‡ç¨‹ï¼Œä¸Word Countä¸­ä¸åŒRDDä¹‹é—´çš„è½¬æ¢è¿‡ç¨‹å¦‚å‡ºä¸€è¾™ã€‚</p><p>æ‰€ä»¥æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬å°±ç»“åˆè–¯ç‰‡çš„åˆ¶ä½œæµç¨‹ï¼Œå»ç†è§£RDDçš„4å¤§å±æ€§ã€‚</p><p>é¦–å…ˆï¼Œå’±ä»¬æ²¿ç€çºµå‘ï¼Œä¹Ÿå°±æ˜¯ä»ä¸Šåˆ°ä¸‹çš„æ–¹å‘ï¼Œå»è§‚å¯Ÿä¸Šå›¾ä¸­åœŸè±†å·¥åŠçš„åˆ¶ä½œå·¥è‰ºã€‚</p><p><img src=\"https://static001.geekbang.org/resource/image/4f/da/4fc5769e03f68eae79ea92fbb4756bda.jpg?wh=1920x586\" alt=\"å›¾ç‰‡\" title=\"RDDçš„ç”Ÿæ´»åŒ–ç±»æ¯”\"></p><p>æˆ‘ä»¬å¯ä»¥çœ‹åˆ°å¯¹äºæ¯ä¸€ç§é£Ÿæå½¢æ€æ¥è¯´ï¼Œæµæ°´çº¿ä¸Šéƒ½æœ‰å¤šä¸ªå®ç‰©ä¸ä¹‹å¯¹åº”ï¼Œæ¯”å¦‚ï¼Œâ€œå¸¦æ³¥åœŸè±†â€æ˜¯ä¸€ç§é£Ÿæå½¢æ€ï¼Œæµæ°´çº¿ä¸Šæ€»å…±æœ‰3é¢—â€œè„å…®å…®â€çš„åœŸè±†åŒå±äºè¿™ä¸€å½¢æ€ã€‚</p><p>å¦‚æœæŠŠâ€œå¸¦æ³¥åœŸè±†â€çœ‹æˆæ˜¯RDDçš„è¯ï¼Œé‚£ä¹ˆRDDçš„partitionså±æ€§ï¼Œå›Šæ‹¬çš„æ­£æ˜¯éº»è¢‹é‡Œé‚£ä¸€é¢—é¢—è„å…®å…®çš„åœŸè±†ã€‚åŒç†ï¼Œæµæ°´çº¿ä¸Šæ‰€æœ‰æ´—å‡€çš„åœŸè±†ï¼Œä¸€åŒæ„æˆäº†â€œå¹²å‡€åœŸè±†â€RDDçš„partitionså±æ€§ã€‚</p><p>æˆ‘ä»¬å†æ¥çœ‹RDDçš„partitionerå±æ€§ï¼Œè¿™ä¸ªå±æ€§å®šä¹‰äº†æŠŠåŸå§‹æ•°æ®é›†åˆ‡å‰²æˆæ•°æ®åˆ†ç‰‡çš„åˆ‡å‰²è§„åˆ™ã€‚åœ¨åœŸè±†å·¥åŠçš„ä¾‹å­ä¸­ï¼Œâ€œå¸¦æ³¥åœŸè±†â€RDDçš„åˆ‡å‰²è§„åˆ™æ˜¯éšæœºæ‹¿å–ï¼Œä¹Ÿå°±æ˜¯ä»éº»è¢‹ä¸­éšæœºæ‹¿å–ä¸€é¢—è„å…®å…®çš„åœŸè±†æ”¾åˆ°æµæ°´çº¿ä¸Šã€‚åé¢çš„é£Ÿæå½¢æ€ï¼Œå¦‚â€œå¹²å‡€åœŸè±†â€ã€â€œåœŸè±†ç‰‡â€å’Œâ€œå³é£Ÿè–¯ç‰‡â€ï¼Œåˆ™æ²¿ç”¨äº†â€œå¸¦æ³¥åœŸè±†â€RDDçš„åˆ‡å‰²è§„åˆ™ã€‚æ¢å¥è¯è¯´ï¼Œåç»­çš„è¿™äº›RDDï¼Œåˆ†åˆ«ç»§æ‰¿äº†å‰ä¸€ä¸ªRDDçš„partitionerå±æ€§ã€‚</p><p>è¿™é‡Œé¢ä¸ä¼—ä¸åŒçš„æ˜¯â€œåˆ†å‘çš„å³é£Ÿè–¯ç‰‡â€ã€‚æ˜¾ç„¶ï¼Œâ€œåˆ†å‘çš„å³é£Ÿè–¯ç‰‡â€æ˜¯é€šè¿‡å¯¹â€œå³é£Ÿè–¯ç‰‡â€æŒ‰ç…§å¤§ã€ä¸­ã€å°å·åšåˆ†å‘å¾—åˆ°çš„ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œå¯¹äºâ€œåˆ†å‘çš„å³é£Ÿè–¯ç‰‡â€æ¥è¯´ï¼Œå®ƒçš„partitionerå±æ€§ï¼Œé‡æ–°å®šä¹‰äº†è¿™ä¸ªRDDæ•°æ®åˆ†ç‰‡çš„åˆ‡å‰²è§„åˆ™ï¼Œä¹Ÿå°±æ˜¯æŠŠå…ˆå‰RDDçš„æ•°æ®åˆ†ç‰‡æ‰“æ•£ï¼ŒæŒ‰ç…§è–¯ç‰‡å°ºå¯¸é‡æ–°æ„å»ºæ•°æ®åˆ†ç‰‡ã€‚</p><p>ç”±è¿™ä¸ªä¾‹å­æˆ‘ä»¬å¯ä»¥çœ‹å‡ºï¼Œæ•°æ®åˆ†ç‰‡çš„åˆ†å¸ƒï¼Œæ˜¯ç”±RDDçš„partitionerå†³å®šçš„ã€‚å› æ­¤ï¼ŒRDDçš„partitionså±æ€§ï¼Œä¸å®ƒçš„partitionerå±æ€§æ˜¯å¼ºç›¸å…³çš„ã€‚</p><p>æ¨ªçœ‹æˆå²­ä¾§æˆå³°ï¼Œå¾ˆå¤šäº‹æƒ…æ¢ä¸ªè§†è§’çœ‹ï¼Œç›¸è²Œå¯èƒ½ä¼šå®Œå…¨ä¸åŒã€‚æ‰€ä»¥æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬æ¨ªå‘åœ°ï¼Œä¹Ÿå°±æ˜¯æ²¿ç€ä»å·¦è‡³å³çš„æ–¹å‘ï¼Œå†æ¥è§‚å¯ŸåœŸè±†å·¥åŠçš„åˆ¶ä½œå·¥è‰ºã€‚</p><p><img src=\"https://static001.geekbang.org/resource/image/4f/da/4fc5769e03f68eae79ea92fbb4756bda.jpg?wh=1920x586\" alt=\"å›¾ç‰‡\" title=\"RDDçš„ç”Ÿæ´»åŒ–ç±»æ¯”\"></p><p>ä¸éš¾å‘ç°ï¼Œæµæ°´çº¿ä¸Šçš„æ¯ä¸€ç§é£Ÿæå½¢æ€ï¼Œéƒ½æ˜¯ä¸Šä¸€ç§é£Ÿæå½¢æ€åœ¨æŸç§æ“ä½œä¸‹è¿›è¡Œè½¬æ¢å¾—åˆ°çš„ã€‚æ¯”å¦‚ï¼Œâ€œåœŸè±†ç‰‡â€ä¾èµ–çš„é£Ÿæå½¢æ€æ˜¯â€œå¹²å‡€åœŸè±†â€ï¼Œè¿™ä¸­é—´ç”¨äºè½¬æ¢çš„æ“ä½œæ˜¯â€œåˆ‡ç‰‡â€è¿™ä¸ªåŠ¨ä½œã€‚å›é¡¾Word Countå½“ä¸­RDDä¹‹é—´çš„è½¬æ¢å…³ç³»ï¼Œæˆ‘ä»¬ä¹Ÿä¼šå‘ç°ç±»ä¼¼çš„ç°è±¡ã€‚</p><p><img src=\"https://static001.geekbang.org/resource/image/af/6d/af93e6f10b85df80a7d56a6c1965a36d.jpg?wh=1920x512\" alt=\"å›¾ç‰‡\" title=\"Word Countä¸­çš„RDDè½¬æ¢\"></p><p>åœ¨æ•°æ®å½¢æ€çš„è½¬æ¢è¿‡ç¨‹ä¸­ï¼Œæ¯ä¸ªRDDéƒ½ä¼šé€šè¿‡dependencieså±æ€§æ¥è®°å½•å®ƒæ‰€ä¾èµ–çš„å‰ä¸€ä¸ªã€æˆ–æ˜¯å¤šä¸ªRDDï¼Œç®€ç§°â€œçˆ¶RDDâ€ã€‚ä¸æ­¤åŒæ—¶ï¼ŒRDDä½¿ç”¨computeå±æ€§ï¼Œæ¥è®°å½•ä»çˆ¶RDDåˆ°å½“å‰RDDçš„è½¬æ¢æ“ä½œã€‚</p><p>æ‹¿Word Countå½“ä¸­çš„wordRDDæ¥ä¸¾ä¾‹ï¼Œå®ƒçš„çˆ¶RDDæ˜¯lineRDDï¼Œå› æ­¤ï¼Œå®ƒçš„dependencieså±æ€§è®°å½•çš„æ˜¯lineRDDã€‚ä»lineRDDåˆ°wordRDDçš„è½¬æ¢ï¼Œå…¶æ‰€ä¾èµ–çš„æ“ä½œæ˜¯flatMapï¼Œå› æ­¤ï¼ŒwordRDDçš„computeå±æ€§ï¼Œè®°å½•çš„æ˜¯flatMapè¿™ä¸ªè½¬æ¢å‡½æ•°ã€‚</p><p>æ€»ç»“ä¸‹æ¥ï¼Œè–¯ç‰‡çš„åŠ å·¥æµç¨‹ï¼Œä¸RDDçš„æ¦‚å¿µå’Œ4å¤§å±æ€§æ˜¯ä¸€ä¸€å¯¹åº”çš„ï¼š</p><ul>\n<li>ä¸åŒçš„é£Ÿæå½¢æ€ï¼Œå¦‚å¸¦æ³¥åœŸè±†ã€åœŸè±†ç‰‡ã€å³é£Ÿè–¯ç‰‡ç­‰ç­‰ï¼Œå¯¹åº”çš„å°±æ˜¯RDDæ¦‚å¿µï¼›</li>\n<li>åŒä¸€ç§é£Ÿæå½¢æ€åœ¨ä¸åŒæµæ°´çº¿ä¸Šçš„å…·ä½“å®ç‰©ï¼Œå°±æ˜¯ RDD çš„ partitions å±æ€§ï¼›</li>\n<li>é£ŸææŒ‰ç…§ä»€ä¹ˆè§„åˆ™è¢«åˆ†é…åˆ°å“ªæ¡æµæ°´çº¿ï¼Œå¯¹åº”çš„å°±æ˜¯ RDD çš„ partitioner å±æ€§ï¼›</li>\n<li>æ¯ä¸€ç§é£Ÿæå½¢æ€éƒ½ä¼šä¾èµ–ä¸Šä¸€ç§å½¢æ€ï¼Œè¿™ç§ä¾èµ–å…³ç³»å¯¹åº”çš„æ˜¯ RDD ä¸­çš„ dependencies å±æ€§ï¼›</li>\n<li>ä¸åŒç¯èŠ‚çš„åŠ å·¥æ–¹æ³•å¯¹åº” RDDçš„ compute å±æ€§ã€‚</li>\n</ul><p>åœ¨ä½ ç†è§£äº†RDDçš„4å¤§å±æ€§ä¹‹åï¼Œè¿˜éœ€è¦è¿›ä¸€æ­¥äº†è§£RDDçš„ç¼–ç¨‹æ¨¡å‹å’Œå»¶è¿Ÿè®¡ç®—ã€‚ç¼–ç¨‹æ¨¡å‹æŒ‡å¯¼æˆ‘ä»¬å¦‚ä½•è¿›è¡Œä»£ç å®ç°ï¼Œè€Œå»¶è¿Ÿè®¡ç®—æ˜¯Sparkåˆ†å¸ƒå¼è¿è¡Œæœºåˆ¶çš„åŸºç¡€ã€‚åªæœ‰ææ˜ç™½ç¼–ç¨‹æ¨¡å‹ä¸å»¶è¿Ÿè®¡ç®—ï¼Œä½ æ‰èƒ½æµç•…åœ°åœ¨Sparkä¹‹ä¸Šåšåº”ç”¨å¼€å‘ï¼Œåœ¨å®ç°ä¸šåŠ¡é€»è¾‘çš„åŒæ—¶ï¼Œé¿å…åŸ‹ä¸‹æ€§èƒ½éšæ‚£ã€‚</p><h2>ç¼–ç¨‹æ¨¡å‹ä¸å»¶è¿Ÿè®¡ç®—</h2><p>ä½ è¿˜è®°å¾—æˆ‘åœ¨ä¸Šä¸€è®²çš„æœ€åï¼Œç»™ä½ ç•™çš„ä¸€é“æ€è€ƒé¢˜å—ï¼šmapã€filterã€flatMapå’ŒreduceByKeyè¿™äº›ç®—å­ï¼Œæœ‰å“ªäº›å…±åŒç‚¹ï¼Ÿç°åœ¨æˆ‘ä»¬æ¥æ­æ™“ç­”æ¡ˆï¼š</p><p>é¦–å…ˆï¼Œè¿™4ä¸ªç®—å­éƒ½æ˜¯ä½œç”¨ï¼ˆApplyï¼‰åœ¨RDDä¹‹ä¸Šã€ç”¨æ¥åšRDDä¹‹é—´çš„è½¬æ¢ã€‚æ¯”å¦‚ï¼ŒflatMapä½œç”¨åœ¨lineRDDä¹‹ä¸Šï¼ŒæŠŠlineRDDè½¬æ¢ä¸ºwordRDDã€‚</p><p>å…¶æ¬¡ï¼Œè¿™äº›ç®—å­æœ¬èº«æ˜¯å‡½æ•°ï¼Œè€Œä¸”å®ƒä»¬çš„å‚æ•°ä¹Ÿæ˜¯å‡½æ•°ã€‚å‚æ•°æ˜¯å‡½æ•°ã€æˆ–è€…è¿”å›å€¼æ˜¯å‡½æ•°çš„å‡½æ•°ï¼Œæˆ‘ä»¬æŠŠè¿™ç±»å‡½æ•°ç»Ÿç§°ä¸ºâ€œ<strong>é«˜é˜¶å‡½æ•°</strong>â€ï¼ˆHigher-order Functionsï¼‰ã€‚æ¢å¥è¯è¯´ï¼Œè¿™4ä¸ªç®—å­ï¼Œéƒ½æ˜¯é«˜é˜¶å‡½æ•°ã€‚</p><p>å…³äºé«˜é˜¶å‡½æ•°çš„ä½œç”¨ä¸ä¼˜åŠ£åŠ¿ï¼Œæˆ‘ä»¬ç•™åˆ°åé¢å†å»å±•å¼€ã€‚è¿™é‡Œï¼Œæˆ‘ä»¬å…ˆä¸“æ³¨åœ¨RDDç®—å­çš„ç¬¬ä¸€ä¸ªå…±æ€§ï¼š<strong>RDDè½¬æ¢</strong>ã€‚</p><p>RDDæ˜¯Sparkå¯¹äºåˆ†å¸ƒå¼æ•°æ®é›†çš„æŠ½è±¡ï¼Œ<strong>æ¯ä¸€ä¸ªRDDéƒ½ä»£è¡¨ç€ä¸€ç§åˆ†å¸ƒå¼æ•°æ®å½¢æ€</strong>ã€‚æ¯”å¦‚lineRDDï¼Œå®ƒè¡¨ç¤ºæ•°æ®åœ¨é›†ç¾¤ä¸­ä»¥è¡Œï¼ˆLineï¼‰çš„å½¢å¼å­˜åœ¨ï¼›è€ŒwordRDDåˆ™æ„å‘³ç€æ•°æ®çš„å½¢æ€æ˜¯å•è¯ï¼Œåˆ†å¸ƒåœ¨è®¡ç®—é›†ç¾¤ä¸­ã€‚</p><p>ç†è§£äº†RDDï¼Œé‚£ä»€ä¹ˆæ˜¯RDDè½¬æ¢å‘¢ï¼Ÿåˆ«ç€æ€¥ï¼Œæˆ‘æ¥ä»¥ä¸Šæ¬¡Word Countçš„å®ç°ä»£ç ä¸ºä¾‹ï¼Œæ¥ç»™ä½ è®²ä¸€ä¸‹ã€‚ä»¥ä¸‹æ˜¯æˆ‘ä»¬ä¸Šæ¬¡ç”¨çš„ä»£ç ï¼š</p><pre><code class=\"language-scala\">import org.apache.spark.rdd.RDD\nval rootPath: String = _\nval file: String = s\"${rootPath}/wikiOfSpark.txt\"\n// è¯»å–æ–‡ä»¶å†…å®¹\nval lineRDD: RDD[String] = spark.sparkContext.textFile(file)\n// ä»¥è¡Œä¸ºå•ä½åšåˆ†è¯\nval wordRDD: RDD[String] = lineRDD.flatMap(line =&gt; line.split(\" \"))\nval cleanWordRDD: RDD[String] = wordRDD.filter(word =&gt; !word.equals(\"\"))\n// æŠŠRDDå…ƒç´ è½¬æ¢ä¸ºï¼ˆKeyï¼ŒValueï¼‰çš„å½¢å¼\nval kvRDD: RDD[(String, Int)] = cleanWordRDD.map(word =&gt; (word, 1))\n// æŒ‰ç…§å•è¯åšåˆ†ç»„è®¡æ•°\nval wordCounts: RDD[(String, Int)] = kvRDD.reduceByKey((x, y) =&gt; x + y)\n// æ‰“å°è¯é¢‘æœ€é«˜çš„5ä¸ªè¯æ±‡\nwordCounts.map{case (k, v) =&gt; (v, k)}.sortByKey(false).take(5)\n</code></pre><p>å›é¡¾Word Countç¤ºä¾‹ï¼Œæˆ‘ä»¬ä¼šå‘ç°ï¼ŒWord Countçš„å®ç°è¿‡ç¨‹ï¼Œå®é™…ä¸Šå°±æ˜¯ä¸åŒRDDä¹‹é—´çš„ä¸€ä¸ªè½¬æ¢è¿‡ç¨‹ã€‚ä»”ç»†è§‚å¯Ÿæˆ‘ä»¬ä¼šå‘ç°ï¼ŒWord Countç¤ºä¾‹ä¸­ä¸€å…±æœ‰4æ¬¡RDDçš„è½¬æ¢ï¼Œæˆ‘æ¥å…·ä½“è§£é‡Šä¸€ä¸‹ï¼š</p><p>èµ·åˆï¼Œæˆ‘ä»¬é€šè¿‡è°ƒç”¨textFile APIç”ŸæˆlineRDDï¼Œç„¶åç”¨flatMapç®—å­æŠŠlineRDDè½¬æ¢ä¸ºwordRDDï¼›<br>\næ¥ä¸‹æ¥ï¼Œfilterç®—å­å¯¹wordRDDåšè¿‡æ»¤ï¼Œå¹¶æŠŠå®ƒè½¬æ¢ä¸ºä¸å¸¦ç©ºä¸²çš„cleanWordRDDï¼›<br>\nç„¶åï¼Œä¸ºäº†åç»­çš„èšåˆè®¡ç®—ï¼Œmapç®—å­æŠŠcleanWordRDDåˆè½¬æ¢æˆå…ƒç´ ä¸ºï¼ˆKeyï¼ŒValueï¼‰å¯¹çš„kvRDDï¼›<br>\næœ€ç»ˆï¼Œæˆ‘ä»¬è°ƒç”¨reduceByKeyåšåˆ†ç»„èšåˆï¼ŒæŠŠkvRDDä¸­çš„Valueä»1è½¬æ¢ä¸ºå•è¯è®¡æ•°ã€‚</p><p>è¿™4æ­¥è½¬æ¢çš„è¿‡ç¨‹å¦‚ä¸‹å›¾æ‰€ç¤ºï¼š</p><p><img src=\"https://static001.geekbang.org/resource/image/af/6d/af93e6f10b85df80a7d56a6c1965a36d.jpg?wh=1920x512\" alt=\"å›¾ç‰‡\" title=\"Word Countä¸­çš„RDDè½¬æ¢\"></p><p>æˆ‘ä»¬åˆšåˆšè¯´è¿‡ï¼ŒRDDä»£è¡¨çš„æ˜¯åˆ†å¸ƒå¼æ•°æ®å½¢æ€ï¼Œå› æ­¤ï¼Œ<strong>RDDåˆ°RDDä¹‹é—´çš„è½¬æ¢ï¼Œæœ¬è´¨ä¸Šæ˜¯æ•°æ®å½¢æ€ä¸Šçš„è½¬æ¢ï¼ˆTransformationsï¼‰</strong>ã€‚</p><p>åœ¨RDDçš„ç¼–ç¨‹æ¨¡å‹ä¸­ï¼Œä¸€å…±æœ‰ä¸¤ç§ç®—å­ï¼ŒTransformationsç±»ç®—å­å’ŒActionsç±»ç®—å­ã€‚å¼€å‘è€…éœ€è¦ä½¿ç”¨Transformationsç±»ç®—å­ï¼Œå®šä¹‰å¹¶æè¿°æ•°æ®å½¢æ€çš„è½¬æ¢è¿‡ç¨‹ï¼Œç„¶åè°ƒç”¨Actionsç±»ç®—å­ï¼Œå°†è®¡ç®—ç»“æœæ”¶é›†èµ·æ¥ã€æˆ–æ˜¯ç‰©åŒ–åˆ°ç£ç›˜ã€‚</p><p>åœ¨è¿™æ ·çš„ç¼–ç¨‹æ¨¡å‹ä¸‹ï¼ŒSparkåœ¨è¿è¡Œæ—¶çš„è®¡ç®—è¢«åˆ’åˆ†ä¸ºä¸¤ä¸ªç¯èŠ‚ã€‚</p><ol>\n<li>åŸºäºä¸åŒæ•°æ®å½¢æ€ä¹‹é—´çš„è½¬æ¢ï¼Œæ„å»º<strong>è®¡ç®—æµå›¾</strong>ï¼ˆDAGï¼ŒDirected Acyclic Graphï¼‰ï¼›</li>\n<li>é€šè¿‡Actionsç±»ç®—å­ï¼Œä»¥<strong>å›æº¯çš„æ–¹å¼å»è§¦å‘æ‰§è¡Œ</strong>è¿™ä¸ªè®¡ç®—æµå›¾ã€‚</li>\n</ol><p>æ¢å¥è¯è¯´ï¼Œå¼€å‘è€…è°ƒç”¨çš„å„ç±»Transformationsç®—å­ï¼Œå¹¶ä¸ç«‹å³æ‰§è¡Œè®¡ç®—ï¼Œå½“ä¸”ä»…å½“å¼€å‘è€…è°ƒç”¨Actionsç®—å­æ—¶ï¼Œä¹‹å‰è°ƒç”¨çš„è½¬æ¢ç®—å­æ‰ä¼šä»˜è¯¸æ‰§è¡Œã€‚åœ¨ä¸šå†…ï¼Œè¿™æ ·çš„è®¡ç®—æ¨¡å¼æœ‰ä¸ªä¸“é—¨çš„æœ¯è¯­ï¼Œå«ä½œâ€œ<strong>å»¶è¿Ÿè®¡ç®—</strong>â€ï¼ˆLazy Evaluationï¼‰ã€‚</p><p>å»¶è¿Ÿè®¡ç®—å¾ˆå¥½åœ°è§£é‡Šäº†æœ¬è®²å¼€å¤´çš„é—®é¢˜ï¼šä¸ºä»€ä¹ˆWord Countåœ¨æ‰§è¡Œçš„è¿‡ç¨‹ä¸­ï¼Œåªæœ‰æœ€åä¸€è¡Œä»£ç ä¼šèŠ±è´¹å¾ˆé•¿æ—¶é—´ï¼Œè€Œå‰é¢çš„ä»£ç éƒ½æ˜¯ç¬é—´æ‰§è¡Œå®Œæ¯•çš„å‘¢ï¼Ÿ</p><p>è¿™é‡Œçš„ç­”æ¡ˆæ­£æ˜¯Sparkçš„å»¶è¿Ÿè®¡ç®—ã€‚flatMapã€filterã€mapè¿™äº›ç®—å­ï¼Œä»…ç”¨äºæ„å»ºè®¡ç®—æµå›¾ï¼Œå› æ­¤ï¼Œå½“ä½ åœ¨spark-shellä¸­æ•²å…¥è¿™äº›ä»£ç æ—¶ï¼Œspark-shellä¼šç«‹å³è¿”å›ã€‚åªæœ‰åœ¨ä½ æ•²å…¥æœ€åé‚£è¡ŒåŒ…å«takeçš„ä»£ç æ—¶ï¼ŒSparkæ‰ä¼šè§¦å‘æ‰§è¡Œä»å¤´åˆ°å°¾çš„è®¡ç®—æµç¨‹ï¼Œæ‰€ä»¥ç›´è§‚åœ°çœ‹ä¸Šå»ï¼Œæœ€åä¸€è¡Œä»£ç æ˜¯æœ€è€—æ—¶çš„ã€‚</p><p>Sparkç¨‹åºçš„æ•´ä¸ªè¿è¡Œæµç¨‹å¦‚ä¸‹å›¾æ‰€ç¤ºï¼š</p><p><img src=\"https://static001.geekbang.org/resource/image/6f/7b/6f82b4a35cdfb526d837d23675yy477b.jpg?wh=1920x472\" alt=\"å›¾ç‰‡\" title=\"å»¶è¿Ÿè®¡ç®—\"></p><p>ä½ å¯èƒ½ä¼šé—®ï¼šâ€œåœ¨RDDçš„å¼€å‘æ¡†æ¶ä¸‹ï¼Œå“ªäº›ç®—å­å±äºTransformationsç®—å­ï¼Œå“ªäº›ç®—å­æ˜¯Actionsç®—å­å‘¢ï¼Ÿâ€</p><p>æˆ‘ä»¬éƒ½çŸ¥é“ï¼ŒSparkæœ‰å¾ˆå¤šç®—å­ï¼Œ<a href=\"https://spark.apache.org/docs/latest/rdd-programming-guide.html\">Sparkå®˜ç½‘</a>æä¾›äº†å®Œæ•´çš„RDDç®—å­é›†åˆï¼Œä¸è¿‡å¯¹äºè¿™äº›ç®—å­ï¼Œå®˜ç½‘æ›´å¤šåœ°æ˜¯é‡‡ç”¨ä¸€ç§ç½—åˆ—çš„æ–¹å¼å»å‘ˆç°çš„ï¼Œæ²¡æœ‰è¿›è¡Œåˆ†ç±»ï¼Œçœ‹å¾—äººçœ¼èŠ±ç¼­ä¹±ã€æ˜æ˜æ¬²ç¡ã€‚å› æ­¤ï¼Œæˆ‘æŠŠå¸¸ç”¨çš„RDDç®—å­è¿›è¡Œäº†å½’ç±»ï¼Œå¹¶æ•´ç†åˆ°äº†ä¸‹é¢çš„è¡¨æ ¼ä¸­ï¼Œä¾›ä½ éšæ—¶æŸ¥é˜…ã€‚</p><p><img src=\"https://static001.geekbang.org/resource/image/4f/fa/4f277fdda5a4b34b3e2yyb6f570a08fa.jpg?wh=1773x1364\" alt=\"å›¾ç‰‡\" title=\"å›¾ç‰‡æ•´ç†è‡ªï¼šhttps://spark.apache.org/docs/latest/rdd-programming-guide.html\"></p><p>ç»“åˆæ¯ä¸ªç®—å­çš„åˆ†ç±»ã€ç”¨é€”å’Œé€‚ç”¨åœºæ™¯ï¼Œè¿™å¼ è¡¨æ ¼å¯ä»¥å¸®ä½ æ›´å¿«ã€æ›´é«˜æ•ˆåœ°é€‰æ‹©åˆé€‚çš„ç®—å­æ¥å®ç°ä¸šåŠ¡é€»è¾‘ã€‚å¯¹äºè¡¨æ ¼ä¸­ä¸ç†Ÿæ‚‰çš„ç®—å­ï¼Œæ¯”å¦‚aggregateByKeyï¼Œä½ å¯ä»¥ç»“åˆå®˜ç½‘çš„ä»‹ç»ä¸è§£é‡Šï¼Œæˆ–æ˜¯è¿›ä¸€æ­¥æŸ¥é˜…ç½‘ä¸Šçš„ç›¸å…³èµ„æ–™ï¼Œæœ‰çš„æ”¾çŸ¢åœ°å»æ·±å…¥ç†è§£ã€‚é‡è¦çš„ç®—å­ï¼Œæˆ‘ä»¬ä¼šåœ¨ä¹‹åçš„è¯¾é‡Œè¯¦ç»†è§£é‡Šã€‚</p><h2>é‡ç‚¹å›é¡¾</h2><p>ä»Šå¤©è¿™ä¸€è®²ï¼Œæˆ‘ä»¬é‡ç‚¹è®²è§£äº†RDDçš„ç¼–ç¨‹æ¨¡å‹ä¸å»¶è¿Ÿè®¡ç®—ï¼Œå¹¶é€šè¿‡åœŸè±†å·¥åŠçš„ç±»æ¯”ä»‹ç»äº†ä»€ä¹ˆæ˜¯RDDã€‚<strong>RDDæ˜¯Sparkå¯¹äºåˆ†å¸ƒå¼æ•°æ®é›†çš„æŠ½è±¡ï¼Œå®ƒç”¨äºå›Šæ‹¬æ‰€æœ‰å†…å­˜ä¸­å’Œç£ç›˜ä¸­çš„åˆ†å¸ƒå¼æ•°æ®å®ä½“</strong>ã€‚å¯¹äºRDDï¼Œä½ è¦é‡ç‚¹æŒæ¡å®ƒçš„4å¤§å±æ€§ï¼Œè¿™æ˜¯æˆ‘ä»¬åç»­å­¦ä¹ çš„é‡è¦åŸºç¡€ï¼š</p><ul>\n<li>partitionsï¼šæ•°æ®åˆ†ç‰‡</li>\n<li>partitionerï¼šåˆ†ç‰‡åˆ‡å‰²è§„åˆ™</li>\n<li>dependenciesï¼šRDDä¾èµ–</li>\n<li>computeï¼šè½¬æ¢å‡½æ•°</li>\n</ul><p>æ·±å…¥ç†è§£RDDä¹‹åï¼Œä½ éœ€è¦ç†Ÿæ‚‰RDDçš„ç¼–ç¨‹æ¨¡å‹ã€‚åœ¨RDDçš„ç¼–ç¨‹æ¨¡å‹ä¸­ï¼Œå¼€å‘è€…éœ€è¦ä½¿ç”¨Transformationsç±»ç®—å­ï¼Œå®šä¹‰å¹¶æè¿°æ•°æ®å½¢æ€çš„è½¬æ¢è¿‡ç¨‹ï¼Œç„¶åè°ƒç”¨Actionsç±»ç®—å­ï¼Œå°†è®¡ç®—ç»“æœæ”¶é›†èµ·æ¥ã€æˆ–æ˜¯ç‰©åŒ–åˆ°ç£ç›˜ã€‚</p><p>è€Œå»¶è¿Ÿè®¡ç®—æŒ‡çš„æ˜¯ï¼Œå¼€å‘è€…è°ƒç”¨çš„å„ç±»Transformationsç®—å­ï¼Œå¹¶ä¸ä¼šç«‹å³æ‰§è¡Œè®¡ç®—ï¼Œå½“ä¸”ä»…å½“å¼€å‘è€…è°ƒç”¨Actionsç®—å­æ—¶ï¼Œä¹‹å‰è°ƒç”¨çš„è½¬æ¢ç®—å­æ‰ä¼šä»˜è¯¸æ‰§è¡Œã€‚</p><h2>æ¯è¯¾ä¸€ç»ƒ</h2><p>å¯¹äºWord Countçš„è®¡ç®—æµå›¾ä¸åœŸè±†å·¥åŠçš„æµæ°´çº¿å·¥è‰ºï¼Œå°½ç®¡çœ‹ä¸Šå»æ¯«ä¸ç›¸å…³ï¼Œé£é©¬ç‰›ä¸ç›¸åŠï¼Œä¸è¿‡ï¼Œä½ ä¸å¦¨èŠ±ç‚¹æ—¶é—´æƒ³ä¸€æƒ³ï¼Œå®ƒä»¬ä¹‹é—´æœ‰å“ªäº›åŒºåˆ«å’Œè”ç³»ï¼Ÿ</p><p>æ¬¢è¿ä½ æŠŠç­”æ¡ˆåˆ†äº«åˆ°è¯„è®ºåŒºï¼Œæˆ‘åœ¨è¯„è®ºåŒºç­‰ä½ ï¼Œä¹Ÿæ¬¢è¿ä½ æŠŠè¿™ä¸€è®²åˆ†äº«ç»™æ›´å¤šçš„æœ‹å‹å’ŒåŒäº‹ï¼Œæˆ‘ä»¬ä¸‹ä¸€è®²è§ï¼</p>","neighbors":{"left":{"article_title":"01ï½œSparkï¼šä»â€œå¤§æ•°æ®çš„Hello Worldâ€å¼€å§‹","id":415209},"right":{"article_title":"03 | RDDå¸¸ç”¨ç®—å­ï¼ˆä¸€ï¼‰ï¼šRDDå†…éƒ¨çš„æ•°æ®è½¬æ¢","id":418079}},"comments":[{"had_liked":false,"id":318572,"user_name":"cfwseven","can_delete":false,"product_type":"c1","uid":2705659,"ip_address":"","ucode":"D7A23FE58153D0","user_header":"https://static001.geekbang.org/account/avatar/00/29/48/fb/7b27bccb.jpg","comment_is_top":false,"comment_ctime":1635337252,"is_pvip":true,"replies":[{"id":"115569","content":"å¥½é—®é¢˜~<br><br>ä¸¥è°¨çš„è¯´ï¼Œä¸æ˜¯è¦æŠŠactionç®—å­è®¾ç½®æˆå»¶è¿Ÿè®¡ç®—ï¼Œè€Œæ˜¯Sparkåœ¨å®ç°ä¸Šï¼Œé€‰æ‹©äº†Lazy evaluationè¿™ç§è®¡ç®—æ¨¡å¼ã€‚<br><br>TensorFlowåŒæ ·ä¹Ÿé‡‡ç”¨äº†ç±»ä¼¼çš„è®¡ç®—æ¨¡å¼ã€‚è¿™ç§æ¨¡å¼æœ‰ä»€ä¹ˆå¥½å¤„ã€æˆ–è€…è¯´æ”¶ç›Šå‘¢ï¼Ÿ<br><br>æˆ‘çš„ç†è§£æ˜¯ï¼šä¼˜åŒ–ç©ºé—´ã€‚<br><br>å’ŒEager evaluationä¸ä¸€æ ·ï¼Œlazy evaluationå…ˆæ„å»ºè®¡ç®—å›¾ï¼Œç­‰éƒ½æ„å»ºå®Œäº†ï¼Œåœ¨ä»˜è¯¸æ‰§è¡Œã€‚è¿™æ ·ä¸€æ¥ï¼Œä¸­é—´å°±å¯ä»¥æ‰“ä¸ªæ—¶é—´å·®ï¼Œå¼•æ“æœ‰è¶³å¤Ÿçš„æ—¶é—´å’Œç©ºé—´ï¼Œå¯¹ç”¨æˆ·ä»£ç åšä¼˜åŒ–ï¼Œä»è€Œè®©åº”ç”¨çš„æ‰§è¡Œæ€§èƒ½åœ¨ç”¨æˆ·æ— æ„ŸçŸ¥çš„æƒ…å†µä¸‹ï¼Œåšåˆ°æœ€å¥½ã€‚<br><br>æ¢ä¸ªè§’åº¦è¯´ï¼Œå¼•æ“é€‰æ‹©lazy evaluationï¼Œå…¶å®æ˜¯æ³¨é‡â€œç”¨æˆ·ä½“éªŒâ€ï¼ˆå¼€å‘è€…ï¼‰çš„ä¸€ç§æ€åº¦~","user_name":"ä½œè€…å›å¤","user_name_real":"å´ç£Š","uid":"1043100","ctime":1635424669,"ip_address":"","comment_id":318572,"utype":1}],"discussion_count":2,"race_medal":0,"score":"100419585060","product_id":100090001,"comment_content":"ä½œè€…å¤§å¤§èƒ½è¯´ä¸€ä¸‹ï¼Œä¸ºä»€ä¹ˆactionç®—å­è¦è®¾ç½®æˆå»¶è¿Ÿè®¡ç®—å—","like_count":24,"discussions":[{"author":{"id":1043100,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/ea/9c/230061e7.jpg","nickname":"å´ç£Š","note":"","ucode":"136DC8CF1B10DC","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":529303,"discussion_content":"å¥½é—®é¢˜~\n\nä¸¥è°¨çš„è¯´ï¼Œä¸æ˜¯è¦æŠŠactionç®—å­è®¾ç½®æˆå»¶è¿Ÿè®¡ç®—ï¼Œè€Œæ˜¯Sparkåœ¨å®ç°ä¸Šï¼Œé€‰æ‹©äº†Lazy evaluationè¿™ç§è®¡ç®—æ¨¡å¼ã€‚\n\nTensorFlowåŒæ ·ä¹Ÿé‡‡ç”¨äº†ç±»ä¼¼çš„è®¡ç®—æ¨¡å¼ã€‚è¿™ç§æ¨¡å¼æœ‰ä»€ä¹ˆå¥½å¤„ã€æˆ–è€…è¯´æ”¶ç›Šå‘¢ï¼Ÿ\n\næˆ‘çš„ç†è§£æ˜¯ï¼šä¼˜åŒ–ç©ºé—´ã€‚\n\nå’ŒEager evaluationä¸ä¸€æ ·ï¼Œlazy evaluationå…ˆæ„å»ºè®¡ç®—å›¾ï¼Œç­‰éƒ½æ„å»ºå®Œäº†ï¼Œåœ¨ä»˜è¯¸æ‰§è¡Œã€‚è¿™æ ·ä¸€æ¥ï¼Œä¸­é—´å°±å¯ä»¥æ‰“ä¸ªæ—¶é—´å·®ï¼Œå¼•æ“æœ‰è¶³å¤Ÿçš„æ—¶é—´å’Œç©ºé—´ï¼Œå¯¹ç”¨æˆ·ä»£ç åšä¼˜åŒ–ï¼Œä»è€Œè®©åº”ç”¨çš„æ‰§è¡Œæ€§èƒ½åœ¨ç”¨æˆ·æ— æ„ŸçŸ¥çš„æƒ…å†µä¸‹ï¼Œåšåˆ°æœ€å¥½ã€‚\n\næ¢ä¸ªè§’åº¦è¯´ï¼Œå¼•æ“é€‰æ‹©lazy evaluationï¼Œå…¶å®æ˜¯æ³¨é‡â€œç”¨æˆ·ä½“éªŒâ€ï¼ˆå¼€å‘è€…ï¼‰çš„ä¸€ç§æ€åº¦~","likes_number":1,"is_delete":false,"is_hidden":false,"ctime":1635424669,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":2705659,"avatar":"https://static001.geekbang.org/account/avatar/00/29/48/fb/7b27bccb.jpg","nickname":"cfwseven","note":"","ucode":"D7A23FE58153D0","race_medal":0,"user_type":1,"is_pvip":true},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":410602,"discussion_content":"è°¢è°¢è€å¸ˆè§£ç­”ã€‚\nâ€”â€”lazy evaluationå…ˆæ„å»ºè®¡ç®—å›¾ï¼Œç­‰éƒ½æ„å»ºå®Œäº†ï¼Œåœ¨ä»˜è¯¸æ‰§è¡Œ\nä¸çŸ¥é“æˆ‘è¿™æ ·çš„ç†è§£å¯¹ä¸å¯¹ï¼šé€šè¿‡Lazy evaluationï¼Œå°±å¯ä»¥ä¸ä¿å­˜RDDè®¡ç®—é“¾çš„ä¸­é—´ç»“æœï¼Œä¸­é—´ç»“æœè¢«ä¸‹ä¸€ä¸ªRDDç®—å­è®¡ç®—åå³æŠ›ï¼Œå¯ä»¥èŠ‚çº¦å¤§é‡å†…å­˜","likes_number":1,"is_delete":false,"is_hidden":false,"ctime":1635737735,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":311847,"user_name":"GACÂ·DU","can_delete":false,"product_type":"c1","uid":1385403,"ip_address":"","ucode":"7847FBE1C13740","user_header":"https://static001.geekbang.org/account/avatar/00/15/23/bb/a1a61f7c.jpg","comment_is_top":false,"comment_ctime":1631503112,"is_pvip":true,"replies":[{"id":"113020","content":"Perfect~","user_name":"ä½œè€…å›å¤","user_name_real":"å´ç£Š","uid":"1043100","ctime":1631544146,"ip_address":"","comment_id":311847,"utype":1}],"discussion_count":1,"race_medal":0,"score":"61761045256","product_id":100090001,"comment_content":"ä»ä¸¤è€…çš„æ•´ä½“æµç¨‹æ¥çœ‹ï¼Œç»“æœéƒ½æ˜¯ä¸å¯é€†çš„ï¼Œä½†æ˜¯WordCountå¯ä»¥è®¾ç½®Cacheå’ŒCheckpointï¼Œæ–¹ä¾¿åŠ é€Ÿè®¿é—®å’Œæ•…éšœä¿®å¤ï¼Œè€ŒåœŸè±†åŠ å·¥æµç¨‹å´ä¸å¯ä»¥ã€‚åœŸè±†åŠ å·¥æµç¨‹æ˜¯DAGçš„æ¦‚å›¾ã€‚","like_count":15,"discussions":[{"author":{"id":1043100,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/ea/9c/230061e7.jpg","nickname":"å´ç£Š","note":"","ucode":"136DC8CF1B10DC","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":526771,"discussion_content":"Perfect~","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1631544146,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":330512,"user_name":"å®‡","can_delete":false,"product_type":"c1","uid":2890898,"ip_address":"","ucode":"5E507B438D6B0A","user_header":"https://static001.geekbang.org/account/avatar/00/2c/1c/92/dcbad687.jpg","comment_is_top":false,"comment_ctime":1642003512,"is_pvip":true,"replies":[{"id":"120665","content":"å¥½é—®é¢˜ï¼Œä¸è¿‡è€å¼Ÿè¿™æ˜¯å…¸å‹çš„å•æœºæ€ç»´ï¼Œä¸ºä»€ä¹ˆè¿™ä¹ˆè¯´å‘¢ï¼Ÿ<br>åœ¨è¿‡ç¨‹ç¼–ç¨‹é‡Œé¢ï¼Œæ¸…æ´—ã€åˆ‡å‰²ã€çƒ˜çƒ¤ï¼Œæ˜¯ç‹¬ç«‹çš„æ“ä½œï¼Œå„è‡ªè€—æ—¶ä¸åŒï¼Œç¡®å®å¯ä»¥è®¡ç®—å‡ºæ¥ï¼Œä¸åŒç¯èŠ‚çš„è€—æ—¶ã€‚<br>ä½†æ˜¯åœ¨Sparké‡Œé¢ï¼Œæˆ‘ä»¬åŸºæœ¬ä¸Šæ²¡æœ‰åŠæ³•åŒºåˆ†è¿™äº›ä¸åŒæ“ä½œçš„ç‹¬ç«‹è€—æ—¶ã€‚<br>1ï¼‰ä¸€æ–¹é¢æ˜¯ï¼Œåœ¨åˆ†å¸ƒå¼ç¯å¢ƒä¸­ï¼ŒæŸä¸€ä¸ªæ“ä½œçš„è€—æ—¶ï¼Œéœ€è¦çœ‹å…¨å±€èŠ‚ç‚¹çš„ç»Ÿè®¡å€¼ï¼Œè€Œä¸æ˜¯æŸä¸ªæœºå™¨ä¸Šçš„æ‰§è¡Œæ—¶é—´<br>2ï¼‰å†è€…ï¼Œåœ¨Sparké‡Œé¢ï¼ŒåŒä¸€ä¸ªStageé‡Œé¢çš„æ“ä½œï¼Œæ¯”å¦‚è¿™é‡Œçš„æ¸…æ´—ã€åˆ‡å‰²è¿˜æœ‰çƒ˜çƒ¤ï¼Œä»–ä»¬å…¶å®ä¼šè¢«Whole Stage Code Generationä¼˜åŒ–ä¸ºä¸€ä»½ä»£ç ï¼Œåœ¨è¿™ä¸€ä»½ä»£ç é‡Œé¢ï¼Œä¸ä¼šåœ¨åŒºåˆ†è¿™äº›ä¸åŒçš„æ“ä½œäº†ï¼Œæ‰€ä»¥å¯¹äºä»–ä»¬å„è‡ªçš„æ‰§è¡Œæ—¶é—´ï¼Œæ›´æ˜¯æ— ä»è®¡ç®—äº†ã€‚è€å¼Ÿå¯ä»¥é‡ç‚¹å…³æ³¨åé¢è¯¾ç¨‹éƒ¨åˆ†çš„è°ƒåº¦ç³»ç»Ÿå’ŒTungstenä¼˜åŒ–ï¼Œæ¥ç†Ÿæ‚‰è¿™äº›ç»†èŠ‚ã€‚<br><br>å®é™…ä¸Šï¼Œåœ¨Sparké‡Œé¢ï¼Œæˆ‘ä»¬å¾€å¾€ä¸ä¼šç‰¹åˆ«å…³æ³¨æŸç§æ“ä½œçš„è€—æ—¶ï¼Œè€Œä¸»è¦æ˜¯å…³æ³¨å“ªé‡Œæ˜¯Shuffleï¼Œå“ªé‡Œæœ‰æ•°æ®é›†é¢‘ç¹è®¿é—®ã€æ‰«æçš„ç°è±¡ï¼Œè¿™äº›æ‰æ˜¯Sparkä¸»è¦çš„æ€§èƒ½ç“¶é¢ˆ","user_name":"ä½œè€…å›å¤","user_name_real":"ç¼–è¾‘","uid":"1043100","ctime":1642243110,"ip_address":"","comment_id":330512,"utype":1}],"discussion_count":1,"race_medal":0,"score":"23116839992","product_id":100090001,"comment_content":"æ€æ ·çŸ¥é“ç¨‹åºé‡Œå“ªä¸ªç®—å­æœ€è€—æ—¶ï¼Œç°åœ¨è–¯ç‰‡ç”Ÿäº§é€Ÿåº¦å¾ˆæ…¢ï¼Œæˆ‘æƒ³çŸ¥é“æœ€è€—æ—¶ç”Ÿäº§ç¯èŠ‚æ˜¯å“ªä¸ªï¼ˆæ¸…æ´—ï¼Œåˆ‡å‰²ï¼Œè¿˜æ˜¯çƒ˜çƒ¤ï¼‰ï¼Ÿ","like_count":6,"discussions":[{"author":{"id":1043100,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/ea/9c/230061e7.jpg","nickname":"å´ç£Š","note":"","ucode":"136DC8CF1B10DC","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":546229,"discussion_content":"å¥½é—®é¢˜ï¼Œä¸è¿‡è€å¼Ÿè¿™æ˜¯å…¸å‹çš„å•æœºæ€ç»´ï¼Œä¸ºä»€ä¹ˆè¿™ä¹ˆè¯´å‘¢ï¼Ÿ\nåœ¨è¿‡ç¨‹ç¼–ç¨‹é‡Œé¢ï¼Œæ¸…æ´—ã€åˆ‡å‰²ã€çƒ˜çƒ¤ï¼Œæ˜¯ç‹¬ç«‹çš„æ“ä½œï¼Œå„è‡ªè€—æ—¶ä¸åŒï¼Œç¡®å®å¯ä»¥è®¡ç®—å‡ºæ¥ï¼Œä¸åŒç¯èŠ‚çš„è€—æ—¶ã€‚\nä½†æ˜¯åœ¨Sparké‡Œé¢ï¼Œæˆ‘ä»¬åŸºæœ¬ä¸Šæ²¡æœ‰åŠæ³•åŒºåˆ†è¿™äº›ä¸åŒæ“ä½œçš„ç‹¬ç«‹è€—æ—¶ã€‚\n1ï¼‰ä¸€æ–¹é¢æ˜¯ï¼Œåœ¨åˆ†å¸ƒå¼ç¯å¢ƒä¸­ï¼ŒæŸä¸€ä¸ªæ“ä½œçš„è€—æ—¶ï¼Œéœ€è¦çœ‹å…¨å±€èŠ‚ç‚¹çš„ç»Ÿè®¡å€¼ï¼Œè€Œä¸æ˜¯æŸä¸ªæœºå™¨ä¸Šçš„æ‰§è¡Œæ—¶é—´\n2ï¼‰å†è€…ï¼Œåœ¨Sparké‡Œé¢ï¼ŒåŒä¸€ä¸ªStageé‡Œé¢çš„æ“ä½œï¼Œæ¯”å¦‚è¿™é‡Œçš„æ¸…æ´—ã€åˆ‡å‰²è¿˜æœ‰çƒ˜çƒ¤ï¼Œä»–ä»¬å…¶å®ä¼šè¢«Whole Stage Code Generationä¼˜åŒ–ä¸ºä¸€ä»½ä»£ç ï¼Œåœ¨è¿™ä¸€ä»½ä»£ç é‡Œé¢ï¼Œä¸ä¼šåœ¨åŒºåˆ†è¿™äº›ä¸åŒçš„æ“ä½œäº†ï¼Œæ‰€ä»¥å¯¹äºä»–ä»¬å„è‡ªçš„æ‰§è¡Œæ—¶é—´ï¼Œæ›´æ˜¯æ— ä»è®¡ç®—äº†ã€‚è€å¼Ÿå¯ä»¥é‡ç‚¹å…³æ³¨åé¢è¯¾ç¨‹éƒ¨åˆ†çš„è°ƒåº¦ç³»ç»Ÿå’ŒTungstenä¼˜åŒ–ï¼Œæ¥ç†Ÿæ‚‰è¿™äº›ç»†èŠ‚ã€‚\n\nå®é™…ä¸Šï¼Œåœ¨Sparké‡Œé¢ï¼Œæˆ‘ä»¬å¾€å¾€ä¸ä¼šç‰¹åˆ«å…³æ³¨æŸç§æ“ä½œçš„è€—æ—¶ï¼Œè€Œä¸»è¦æ˜¯å…³æ³¨å“ªé‡Œæ˜¯Shuffleï¼Œå“ªé‡Œæœ‰æ•°æ®é›†é¢‘ç¹è®¿é—®ã€æ‰«æçš„ç°è±¡ï¼Œè¿™äº›æ‰æ˜¯Sparkä¸»è¦çš„æ€§èƒ½ç“¶é¢ˆ","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1642243111,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":312403,"user_name":"ç‡ƒæ–™å–·å°„å™¨","can_delete":false,"product_type":"c1","uid":1238914,"ip_address":"","ucode":"E6D3C5CA41481A","user_header":"https://static001.geekbang.org/account/avatar/00/12/e7/82/b6e56904.jpg","comment_is_top":false,"comment_ctime":1631787048,"is_pvip":false,"replies":[{"id":"113199","content":"å¾ˆæ£’çš„è§†è§’~ ä¸€ä¸ªæ˜¯å»¶è¿Ÿè®¡ç®—ï¼ˆLazy evaluationï¼‰ï¼Œä¸€ä¸ªæ˜¯â€œåŠæ—©æ±‚å€¼â€ï¼ˆEarly evaluationï¼‰","user_name":"ä½œè€…å›å¤","user_name_real":"å´ç£Š","uid":"1043100","ctime":1631804265,"ip_address":"","comment_id":312403,"utype":1}],"discussion_count":2,"race_medal":0,"score":"18811656232","product_id":100090001,"comment_content":"ä»ä¸¤è€…ä¸åŒç‚¹çœ‹ï¼Œworkdcountåˆ‡åˆ‡å®å®ä¸ºå»¶è¿Ÿè®¡ç®—ï¼Œè€ŒåœŸè±†å·¥åŠçš„æµç¨‹ä¸ºåˆ‡å®å‘ç”Ÿçš„ã€‚","like_count":4,"discussions":[{"author":{"id":1043100,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/ea/9c/230061e7.jpg","nickname":"å´ç£Š","note":"","ucode":"136DC8CF1B10DC","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":526963,"discussion_content":"å¾ˆæ£’çš„è§†è§’~ ä¸€ä¸ªæ˜¯å»¶è¿Ÿè®¡ç®—ï¼ˆLazy evaluationï¼‰ï¼Œä¸€ä¸ªæ˜¯â€œåŠæ—©æ±‚å€¼â€ï¼ˆEarly evaluationï¼‰","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1631804265,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1056982,"avatar":"https://static001.geekbang.org/account/avatar/00/10/20/d6/b9513db0.jpg","nickname":"kingcall","note":"","ucode":"508884DC684B5B","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":408696,"discussion_content":"åœŸè±†å·¥åŠæ²¡æœ‰å»¶è¿Ÿè®¡ç®—","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1635304588,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":319302,"user_name":"zx","can_delete":false,"product_type":"c1","uid":2831221,"ip_address":"","ucode":"D9661199636B50","user_header":"","comment_is_top":false,"comment_ctime":1635736777,"is_pvip":false,"replies":[{"id":"116037","content":"å’Œpartitionså±æ€§æ— å…³å“ˆ~ ä¸è¿‡ï¼Œåœ¨reduceByKeyæŠ›å¼‚å¸¸ï¼Œå€’æ˜¯æœ‰ç‚¹æ„æ€ï¼Œè¿™è¯´æ˜Sparkåœ¨è¿™ä¸ªç¯èŠ‚ï¼Œæ£€æŸ¥äº†æ–‡ä»¶è·¯å¾„å¹¶æŠ¥é”™ã€‚ä¸è¿‡ï¼Œæ£€æŸ¥è·¯å¾„ä¸ä»£è¡¨triggeræ‰§è¡Œå“ˆï¼ŒçœŸæ­£çš„è§¦å‘æ‰§è¡Œï¼Œè¿˜æ˜¯è¦ç­‰åˆ°Actioné‚£ä¸€æ­¥~","user_name":"ä½œè€…å›å¤","user_name_real":"å´ç£Š","uid":"1043100","ctime":1636093865,"ip_address":"","comment_id":319302,"utype":1}],"discussion_count":1,"race_medal":0,"score":"14520638665","product_id":100090001,"comment_content":"è®¡ç®—wordcountçš„æ—¶å€™æ–‡ä»¶è·¯å¾„å†™é”™äº†ï¼Œä½†æ˜¯å´æ˜¯åœ¨reduceByKeyè¿™ä¸€æ­¥æŠ¥é”™ï¼Œè¿™æ­¥å¹¶ä¸æ˜¯actionç®—å­ï¼Œè¿™æ˜¯å’Œpartitionså±æ€§æœ‰å…³å—","like_count":4,"discussions":[{"author":{"id":1043100,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/ea/9c/230061e7.jpg","nickname":"å´ç£Š","note":"","ucode":"136DC8CF1B10DC","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":529583,"discussion_content":"å’Œpartitionså±æ€§æ— å…³å“ˆ~ ä¸è¿‡ï¼Œåœ¨reduceByKeyæŠ›å¼‚å¸¸ï¼Œå€’æ˜¯æœ‰ç‚¹æ„æ€ï¼Œè¿™è¯´æ˜Sparkåœ¨è¿™ä¸ªç¯èŠ‚ï¼Œæ£€æŸ¥äº†æ–‡ä»¶è·¯å¾„å¹¶æŠ¥é”™ã€‚ä¸è¿‡ï¼Œæ£€æŸ¥è·¯å¾„ä¸ä»£è¡¨triggeræ‰§è¡Œå“ˆï¼ŒçœŸæ­£çš„è§¦å‘æ‰§è¡Œï¼Œè¿˜æ˜¯è¦ç­‰åˆ°Actioné‚£ä¸€æ­¥~","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1636093865,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":316199,"user_name":"welldo","can_delete":false,"product_type":"c1","uid":1598796,"ip_address":"","ucode":"D38E75364CD2E3","user_header":"https://static001.geekbang.org/account/avatar/00/18/65/4c/f7f86496.jpg","comment_is_top":false,"comment_ctime":1634196885,"is_pvip":false,"replies":[{"id":"114584","content":"ä»»ä½•ä¸€ä¸ªåˆ†å¸ƒå¼æ•°æ®é›†ï¼ŒRDDä¹Ÿå¥½ã€DataFrameã€Datasetä¹Ÿå¥½ï¼Œéƒ½æ˜¯æœ‰åˆ†åŒºã€å¹¶è¡Œåº¦ã€åˆ†åŒºå™¨è¿™äº›ä¸ªæ¦‚å¿µçš„å“ˆï¼Œè·Ÿæ˜¯å¦Shuffleæ²¡æœ‰å…³ç³»<br><br>Shuffleåªæ˜¯æ”¹å˜äº†åŸå§‹æ•°æ®é›†çš„åˆ†åŒºæ–¹å¼ï¼Œè€Œå·²ã€‚<br><br>å¯¹äºHDFSã€S3ä¸Šçš„åˆ†å¸ƒå¼æ•°æ®é›†ï¼ŒåŸå§‹çš„åˆ†åŒºæ•°ï¼Œæˆ–è€…è¯´å¹¶è¡Œåº¦ï¼Œå°±æ˜¯HDFSã€S3ä¸­æ–‡ä»¶åŸå§‹çš„åˆ†åŒºæ•°ï¼ŒäºŒè€…ä¸€è‡´ã€‚<br><br>å¯¹äºé‚£äº›åœ¨Driverç«¯è¯»çš„å•æœºæ–‡ä»¶ã€æˆ–æ˜¯åˆ›å»ºçš„æ•°æ®é›†ï¼Œå¯ä»¥äººä¸ºæŒ‡å®šåˆ†åŒºæ•°ï¼ˆå¹¶è¡Œåº¦ï¼‰ï¼Œæ¯”å¦‚parallelizeã€‚<br><br>æ€»ä¹‹ï¼Œä¸ç®¡æ˜¯å“ªç±»æ•°æ®ï¼Œæ•°æ®é›†ä¸€æ—¦è¿›å…¥Sparkï¼Œæ˜¯ä¸€å®šæœ‰å¹¶è¡Œåº¦ã€åˆ†åŒºæ•°è¿™ä¸ªæ¦‚å¿µçš„ï¼Œå“ªæ€•å¹¶è¡Œåº¦æ˜¯1ã€‚<br><br>è€å¼Ÿè¿˜è¦å¥½å¥½æ¶ˆåŒ–ä¸€ä¸‹è¿™äº›â€œåœŸè±†â€å•Šï¼Œå“ˆå“ˆ~","user_name":"ä½œè€…å›å¤","user_name_real":"å´ç£Š","uid":"1043100","ctime":1634292516,"ip_address":"","comment_id":316199,"utype":1}],"discussion_count":3,"race_medal":0,"score":"10224131477","product_id":100090001,"comment_content":"&quot;æˆ‘ä»¬å†æ¥çœ‹ RDD çš„ partitioner å±æ€§ï¼Œè¿™ä¸ªå±æ€§å®šä¹‰äº†æŠŠåŸå§‹æ•°æ®é›†åˆ‡å‰²æˆæ•°æ®åˆ†ç‰‡çš„åˆ‡å‰²è§„åˆ™ã€‚åœ¨åœŸè±†å·¥åŠçš„ä¾‹å­ä¸­ï¼Œâ€œå¸¦æ³¥åœŸè±†â€RDD çš„åˆ‡å‰²è§„åˆ™æ˜¯éšæœºæ‹¿å–ï¼Œä¹Ÿå°±æ˜¯ä»éº»è¢‹ä¸­éšæœºæ‹¿å–ä¸€é¢—è„å…®å…®çš„åœŸè±†æ”¾åˆ°æµæ°´çº¿ä¸Šã€‚åé¢çš„é£Ÿæå½¢æ€ï¼Œå¦‚â€œå¹²å‡€åœŸè±†â€ã€â€œåœŸè±†ç‰‡â€å’Œâ€œå³é£Ÿè–¯ç‰‡â€ï¼Œåˆ™æ²¿ç”¨äº†â€œå¸¦æ³¥åœŸè±†â€RDD çš„åˆ‡å‰²è§„åˆ™ã€‚æ¢å¥è¯è¯´ï¼Œåç»­çš„è¿™äº› RDDï¼Œåˆ†åˆ«ç»§æ‰¿äº†å‰ä¸€ä¸ª RDD çš„ partitioner å±æ€§ã€‚&quot;<br>-----------------------<br>è€å¸ˆ, çœ‹å®Œè¿™æ®µè¯å’ŒåœŸè±†æµæ°´çº¿çš„å›¾ç‰‡, æˆ‘æœ‰å‡ ä¸ªç–‘é—®.<br><br>1. rddåˆ†ä¸º&lt;value&gt;ç±»å‹å’Œ&lt;key,value&gt;ç±»å‹ï¼Œæ•°æ®åˆ†åŒºæ–¹å¼åªä½œç”¨äº&lt;Keyï¼ŒValue&gt;å½¢å¼çš„æ•°æ®ã€‚<br>å¹¶ä¸”åˆšå¼€å§‹æ²¡æœ‰ä»»ä½•åˆ†åŒºæ–¹å¼ï¼Œç›´åˆ°é‡åˆ°åŒ…å«shuffleçš„ç®—å­æ—¶ï¼Œæ‰ä¼šä½¿ç”¨â€œåˆ†åŒºæ–¹å¼â€ï¼Œæ¯”å¦‚hashåˆ†åŒºã€‚<br><br>é—®é¢˜1ï¼šé‚£ä¹ˆï¼Œä¸€å¨æ•°æ®ï¼Œåœ¨æˆä¸º&lt;key,value&gt;ç±»å‹çš„rddçš„æ—¶å€™ï¼ˆå‡å¦‚4ç‰‡ï¼‰ï¼Œåˆ†ç‰‡æ–¹å¼ï¼Œæ˜¯ä¸æ˜¯å¹³å‡åˆ†æˆ4ä»½å‘¢ï¼Ÿ<br><br>2. &lt;value&gt;ç±»å‹çš„rddï¼Œæ²¡æœ‰åˆ†åŒºå™¨ï¼Œé‚£ä¹ˆå®ƒåˆšåˆšç”Ÿæˆçš„æ—¶å€™ï¼Œä¹Ÿæ˜¯å¹³å‡åˆ†å—ï¼Ÿ","like_count":3,"discussions":[{"author":{"id":1043100,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/ea/9c/230061e7.jpg","nickname":"å´ç£Š","note":"","ucode":"136DC8CF1B10DC","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":528309,"discussion_content":"ä»»ä½•ä¸€ä¸ªåˆ†å¸ƒå¼æ•°æ®é›†ï¼ŒRDDä¹Ÿå¥½ã€DataFrameã€Datasetä¹Ÿå¥½ï¼Œéƒ½æ˜¯æœ‰åˆ†åŒºã€å¹¶è¡Œåº¦ã€åˆ†åŒºå™¨è¿™äº›ä¸ªæ¦‚å¿µçš„å“ˆï¼Œè·Ÿæ˜¯å¦Shuffleæ²¡æœ‰å…³ç³»\n\nShuffleåªæ˜¯æ”¹å˜äº†åŸå§‹æ•°æ®é›†çš„åˆ†åŒºæ–¹å¼ï¼Œè€Œå·²ã€‚\n\nå¯¹äºHDFSã€S3ä¸Šçš„åˆ†å¸ƒå¼æ•°æ®é›†ï¼ŒåŸå§‹çš„åˆ†åŒºæ•°ï¼Œæˆ–è€…è¯´å¹¶è¡Œåº¦ï¼Œå°±æ˜¯HDFSã€S3ä¸­æ–‡ä»¶åŸå§‹çš„åˆ†åŒºæ•°ï¼ŒäºŒè€…ä¸€è‡´ã€‚\n\nå¯¹äºé‚£äº›åœ¨Driverç«¯è¯»çš„å•æœºæ–‡ä»¶ã€æˆ–æ˜¯åˆ›å»ºçš„æ•°æ®é›†ï¼Œå¯ä»¥äººä¸ºæŒ‡å®šåˆ†åŒºæ•°ï¼ˆå¹¶è¡Œåº¦ï¼‰ï¼Œæ¯”å¦‚parallelizeã€‚\n\næ€»ä¹‹ï¼Œä¸ç®¡æ˜¯å“ªç±»æ•°æ®ï¼Œæ•°æ®é›†ä¸€æ—¦è¿›å…¥Sparkï¼Œæ˜¯ä¸€å®šæœ‰å¹¶è¡Œåº¦ã€åˆ†åŒºæ•°è¿™ä¸ªæ¦‚å¿µçš„ï¼Œå“ªæ€•å¹¶è¡Œåº¦æ˜¯1ã€‚\n\nè€å¼Ÿè¿˜è¦å¥½å¥½æ¶ˆåŒ–ä¸€ä¸‹è¿™äº›â€œåœŸè±†â€å•Šï¼Œå“ˆå“ˆ~","likes_number":1,"is_delete":false,"is_hidden":false,"ctime":1634292516,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1056982,"avatar":"https://static001.geekbang.org/account/avatar/00/10/20/d6/b9513db0.jpg","nickname":"kingcall","note":"","ucode":"508884DC684B5B","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":408700,"discussion_content":"hive çš„åˆ†åŒºå°±æ˜¯hdfs çš„åˆ†åŒºï¼Œè¯»å–kafka çš„æ—¶å€™å°±æ˜¯kafka çš„åˆ†åŒºï¼Œè¯»å–socket çš„æ—¶å€™æ˜¯æŒ‰ç…§æ—¶é—´åˆ†å‰²çš„","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1635304745,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1598796,"avatar":"https://static001.geekbang.org/account/avatar/00/18/65/4c/f7f86496.jpg","nickname":"welldo","note":"","ucode":"D38E75364CD2E3","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":404871,"discussion_content":"è€å¸ˆï¼Œæˆ‘æ²¡æœ‰è¡¨è¾¾æ¸…æ¥šï¼Œæˆ‘é‡æ–°æé—®ä¸€ä¸‹ï¼Œè€å¸ˆå‹¿è§æ€ªã€‚\n\n1. åœ¨å†…éƒ¨æ•°æ®ä¸Šåˆ›å»ºrdd<key,value>ï¼Œæ¯”å¦‚parallelize ç®—å­ï¼Œå¹¶ä¸”ç”¨numSlicesæ‰‹åŠ¨æŒ‡å®šåˆ†åŒºæ•°ï¼›è¿™ä¸ªæ—¶å€™æˆ‘æŸ¥çœ‹åˆ†åŒºå™¨rdd.partitionerï¼Œç»“æœæ˜¯NONE\né—®é¢˜1ï¼š æ­¤æ—¶æ•°æ®æ˜¯å¦‚ä½•åˆ†åŒºçš„å‘¢ï¼Ÿæ˜¯å¹³å‡åˆ†å—ï¼Ÿ\né—®é¢˜2ï¼šé‡æ–°åˆ†åŒºï¼ˆæ‰‹åŠ¨partitionBy æˆ–è€…é‡åˆ°shuffleï¼‰æ”¹å˜æ•°æ®çš„åˆ†å¸ƒæ—¶ï¼Œæ‰ä¼šçœŸæ­£ä½¿ç”¨hashåˆ†åŒºå™¨ã€è‡ªå®šä¹‰åˆ†åŒºå™¨ï¼ˆæŒ‰ç…§è–¯ç‰‡å¤§å°åˆ†ï¼‰ï¼Œå¯¹å—ï¼Ÿ\n\n2. åœ¨å†…éƒ¨æ•°æ®ä¸Šåˆ›å»ºrdd<value>ï¼Œå¹¶ä¸”ç”¨numSlicesæ‰‹åŠ¨æŒ‡å®šåˆ†åŒºæ•°ï¼›\né—®é¢˜3ï¼šè¿™ç±»rddæ²¡æœ‰åˆ†åŒºå™¨ï¼Œé‚£å®ƒåˆæ˜¯å’‹åˆ†åŒºçš„å‘¢ï¼Ÿ\n\n3. æ€»ç»“ä¸€ä¸‹è€å¸ˆå›ç­”çš„ç¬¬ä¸‰æ®µï¼Œ\né€šè¿‡apiä»å¤–éƒ¨æ•°æ®ï¼ˆæ¯”å¦‚hiveï¼‰åˆ›å»ºrddæ—¶ï¼Œhiveå’‹åˆ†åŒºçš„ï¼Œåˆ°äº†sparkä¸­å°±æ˜¯å’‹åˆ†åŒºçš„ï¼Œå¯¹å—ï¼Ÿ\n\n\n\n","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1634442341,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":312635,"user_name":"LJK","can_delete":false,"product_type":"c1","uid":1199213,"ip_address":"","ucode":"12B2441099FF1D","user_header":"https://static001.geekbang.org/account/avatar/00/12/4c/6d/c20f2d5a.jpg","comment_is_top":false,"comment_ctime":1631911988,"is_pvip":false,"replies":[{"id":"113277","content":"æ˜¯çš„ï¼Œæ„Ÿè°¢æé†’~","user_name":"ä½œè€…å›å¤","user_name_real":"å´ç£Š","uid":"1043100","ctime":1631932757,"ip_address":"","comment_id":312635,"utype":1}],"discussion_count":1,"race_medal":0,"score":"10221846580","product_id":100090001,"comment_content":"Actionä¸­æ¼äº†ä¸€ä¸ªreduceï¼Œä»Šå¤©æ‰æ³¨æ„åˆ°reduceByKeyæ˜¯transformationè€Œreduceæ˜¯action","like_count":2,"discussions":[{"author":{"id":1043100,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/ea/9c/230061e7.jpg","nickname":"å´ç£Š","note":"","ucode":"136DC8CF1B10DC","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":527057,"discussion_content":"æ˜¯çš„ï¼Œæ„Ÿè°¢æé†’~","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1631932757,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":354730,"user_name":"Geek_a25305","can_delete":false,"product_type":"c1","uid":3144933,"ip_address":"ä¸­å›½å°æ¹¾","ucode":"3A7A91A5D53F0F","user_header":"","comment_is_top":false,"comment_ctime":1660723065,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1660723065","product_id":100090001,"comment_content":"å¤§ç¥ä½ å¥½ æˆ‘æœ‰ä¸ªé—®é¢˜:<br><br><br>å¦‚æœæŠŠâ€œå¸¦æ³¥åœŸè±†â€çœ‹æˆæ˜¯ RDD çš„è¯ï¼Œé‚£ä¹ˆ RDD çš„ partitions å±æ€§ï¼Œå›Šæ‹¬çš„æ­£æ˜¯éº»è¢‹é‡Œé‚£ä¸€é¢—é¢—è„å…®å…®çš„åœŸè±†ã€‚åŒç†ï¼Œæµæ°´çº¿ä¸Šæ‰€æœ‰æ´—å‡€çš„åœŸè±†ï¼Œä¸€åŒæ„æˆäº†â€œå¹²å‡€åœŸè±†â€RDD çš„ partitions å±æ€§ã€‚<br><br>è¿™å¥è¯, æ˜¯ä¸æ˜¯è¦æ”¹æˆ:<br><br>å›Šæ‹¬çš„æ­£æ˜¯éº»è¢‹é‡Œæ¯ä¸€é¢—è„å…®å…®çš„åœŸè±†ã€‚","like_count":0},{"had_liked":false,"id":348817,"user_name":"äºšæ—","can_delete":false,"product_type":"c1","uid":1018972,"ip_address":"","ucode":"4A5A6D24314B79","user_header":"https://static001.geekbang.org/account/avatar/00/0f/8c/5c/3f164f66.jpg","comment_is_top":false,"comment_ctime":1655433536,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1655433536","product_id":100090001,"comment_content":"RDDè¿™ç§æŠ½è±¡ï¼Œå¹³æ—¶åœ¨IDEAè¿™ç§å¼€å‘ç¯å¢ƒä¸­ï¼Œå°æ‰¹é‡æ•°æ®åº”è¯¥å¯ä»¥debug å§","like_count":0},{"had_liked":false,"id":346579,"user_name":"Geek_757cbc","can_delete":false,"product_type":"c1","uid":2943897,"ip_address":"","ucode":"ECE10235F88FEA","user_header":"","comment_is_top":false,"comment_ctime":1653250731,"is_pvip":true,"discussion_count":1,"race_medal":0,"score":"1653250731","product_id":100090001,"comment_content":"æ—¢ç„¶sparkçš„transformationä¸ä¼šç«‹å³è®¡ç®—ä¸ºä»€ä¹ˆä¼šç«‹å³è¿”å›ï¼Œè¿˜æ˜¯ä¸å¤ªç†è§£ï¼Œéš¾é“è¿”å›çš„ç»“æœä¸æ˜¯è®¡ç®—ä¹‹åçš„ç»“æœå—","like_count":0,"discussions":[{"author":{"id":2758010,"avatar":"https://thirdwx.qlogo.cn/mmopen/vi_32/w74m73icotZZEiasC6VzRUytfkFkgyYCGAcz16oBWuMXueWOxxVuAnH6IHaZFXkj5OqwlVO1fnocvn9gGYh8gGcw/132","nickname":"Geek_995b78","note":"","ucode":"F9BD1C78366081","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":585364,"discussion_content":"æˆ‘çš„ç†è§£æ˜¯ï¼Œtransformè¿”å›çš„æ˜¯è®¡ç®—é€»è¾‘ï¼Œè€Œactionè¿”å›çš„æ˜¯è®¡ç®—ç»“æœï¼Œæ˜¯çœŸæ­£ç»è¿‡è®¡ç®—çš„","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1661500441,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":"æ²³å—"},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":335033,"user_name":"ç”°å¤§ä¾ ","can_delete":false,"product_type":"c1","uid":1517333,"ip_address":"","ucode":"9D6026D5B6167C","user_header":"https://static001.geekbang.org/account/avatar/00/17/27/15/abf4f787.jpg","comment_is_top":false,"comment_ctime":1645261826,"is_pvip":true,"replies":[{"id":"122824","content":"ç†è§£çš„éå¸¸åˆ°ä½ï¼Œæ²¡æœ‰ä»»ä½•é—®é¢˜~ æ»¡åˆ†ğŸ’¯","user_name":"ä½œè€…å›å¤","user_name_real":"ç¼–è¾‘","uid":"1043100","ctime":1645889606,"ip_address":"","comment_id":335033,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1645261826","product_id":100090001,"comment_content":"ä½œè€…å¤§å¤§æœ‰ä¸ªé—®é¢˜é—®ä¸€ä¸‹<br>è¿™é‡Œçš„ä¾èµ–å…³ç³»æœ‰ä¸ªæ¯”è¾ƒæ˜æ˜¾çš„å·®åˆ«<br>1.mapè®¡ç®—æ˜¯ä¸€ä¸ªæ•°æ®åˆ†ç‰‡ä¾èµ–äºå‰ä¸€ä¸ªRDDâ€œæ•°æ®åˆ†ç‰‡â€ï¼Œå°±æ˜¯è¯´åœ¨åŒä¸€ä¸ªåˆ†ç‰‡ä¸Šå¯ä»¥è¿ç»­è®¡ç®—ç›´åˆ°reduceä¹‹å‰<br>2.reduceè®¡ç®—æ˜¯ä¾èµ–å…³ç³»å‰é¢ä¸€ä¸ªRDDçš„æ‰€æœ‰çš„æ•°æ®é›† sparkå®é™…è®¡ç®—çš„æ—¶å€™è¦ç­‰å‰é¢æ‰€æœ‰çš„mapè®¡ç®—å®Œæˆæ‰èƒ½è¿›è¡Œreduceæ“ä½œ<br><br>ä¸Šé¢çš„æˆ‘çš„ä¸¤ä¸ªç†è§£æ˜¯å¦æœ‰åå·®ï¼Ÿ","like_count":1,"discussions":[{"author":{"id":1043100,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/ea/9c/230061e7.jpg","nickname":"å´ç£Š","note":"","ucode":"136DC8CF1B10DC","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":553464,"discussion_content":"ç†è§£çš„éå¸¸åˆ°ä½ï¼Œæ²¡æœ‰ä»»ä½•é—®é¢˜~ æ»¡åˆ†ğŸ’¯","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1645889606,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":323155,"user_name":"Eazow","can_delete":false,"product_type":"c1","uid":1346402,"ip_address":"","ucode":"D81D8FF2B2FF0D","user_header":"http://thirdwx.qlogo.cn/mmopen/vi_32/bmgpp5wc8GLmOdHNQccSgrunK0VdIicB6rpTHXCTF5xEkm2YvPHOX2DwNt2EqTzJ70JD41h0u5qW4R0yXRY1ZCg/132","comment_is_top":false,"comment_ctime":1637745431,"is_pvip":true,"replies":[{"id":"117284","content":"draw.ioï¼Œæœ‰åœ¨çº¿ç‰ˆï¼Œä¹Ÿæœ‰APP~","user_name":"ä½œè€…å›å¤","user_name_real":"ç¼–è¾‘","uid":"1043100","ctime":1637806505,"ip_address":"","comment_id":323155,"utype":1}],"discussion_count":2,"race_medal":0,"score":"1637745431","product_id":100090001,"comment_content":"è¯·é—®åœŸè±†å·¥åŠå›¾æ˜¯ç”¨ä»€ä¹ˆç”»æ»´é‚£ï¼Ÿ","like_count":0,"discussions":[{"author":{"id":1043100,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/ea/9c/230061e7.jpg","nickname":"å´ç£Š","note":"","ucode":"136DC8CF1B10DC","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":533163,"discussion_content":"draw.ioï¼Œæœ‰åœ¨çº¿ç‰ˆï¼Œä¹Ÿæœ‰APP~","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1637806505,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":1,"child_discussions":[{"author":{"id":1346402,"avatar":"http://thirdwx.qlogo.cn/mmopen/vi_32/bmgpp5wc8GLmOdHNQccSgrunK0VdIicB6rpTHXCTF5xEkm2YvPHOX2DwNt2EqTzJ70JD41h0u5qW4R0yXRY1ZCg/132","nickname":"Eazow","note":"","ucode":"D81D8FF2B2FF0D","race_medal":0,"user_type":1,"is_pvip":true},"reply_author":{"id":1043100,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/ea/9c/230061e7.jpg","nickname":"å´ç£Š","note":"","ucode":"136DC8CF1B10DC","race_medal":0,"user_type":2,"is_pvip":false},"discussion":{"id":533449,"discussion_content":"è°¢è°¢ç£Šå“¥","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1637857358,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":533163,"ip_address":""},"score":533449,"extra":"{\"user_type\":1}"}]}]},{"had_liked":false,"id":316614,"user_name":"xuchuan","can_delete":false,"product_type":"c1","uid":1954690,"ip_address":"","ucode":"3967199AA078C7","user_header":"https://static001.geekbang.org/account/avatar/00/1d/d3/82/c3e57eb3.jpg","comment_is_top":false,"comment_ctime":1634453519,"is_pvip":false,"replies":[{"id":"114643","content":"èµğŸ‘ï¼Œæ­£è§£~","user_name":"ä½œè€…å›å¤","user_name_real":"å´ç£Š","uid":"1043100","ctime":1634479617,"ip_address":"","comment_id":316614,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1634453519","product_id":100090001,"comment_content":"éƒ½æ˜¯æ¥æ–™åŠ å·¥ï¼Œç›®æ ‡éƒ½æ˜¯é«˜æ•ˆç‡ç”Ÿäº§ã€‚","like_count":0,"discussions":[{"author":{"id":1043100,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/ea/9c/230061e7.jpg","nickname":"å´ç£Š","note":"","ucode":"136DC8CF1B10DC","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":528434,"discussion_content":"èµğŸ‘ï¼Œæ­£è§£~","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1634479617,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]}]}