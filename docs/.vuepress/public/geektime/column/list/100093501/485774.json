{"id":485774,"title":"å¤§å’–åŠ©é˜µï½œå¤§æ˜ï¼šGoæ³›å‹ï¼Œæ³›äº†ï¼Œä½†æ²¡æœ‰å®Œå…¨æ³›","content":"<p>ä½ å¥½ï¼Œæˆ‘æ˜¯å¤§æ˜ï¼Œä¸€ä¸ªä¸“æ³¨äºä¸­é—´ä»¶ç ”å‘çš„å¼€æºçˆ±å¥½è€…ã€‚</p><p>æˆ‘ä»¬éƒ½çŸ¥é“ï¼ŒGo æ³›å‹å·²ç»æ—¥æ¸æˆç†Ÿï¼Œè·ç¦»å‘å¸ƒæ­£å¼ç‰ˆæœ¬å·²ç»ä¸è¿œäº†ã€‚ç›®å‰å·²ç»æœ‰å¾ˆå¤šçš„å¼€å‘è€…å¼€å§‹æ¢ç´¢æ³›å‹ä¼šå¯¹ Go ç¼–ç¨‹å¸¦æ¥ä»€ä¹ˆå½±å“ã€‚æ¯”å¦‚è¯´ï¼Œç›®å‰æˆ‘ä»¬æ¯”è¾ƒè‚¯å®šçš„æ˜¯æ³›å‹èƒ½å¤Ÿè§£å†³è¿™ä¸€ç±»çš„ç—›ç‚¹ï¼š</p><ul>\n<li>æ•°å­¦è®¡ç®—ï¼šå†™å‡ºé€šç”¨çš„æ–¹æ³•æ¥æ“ä½œ  <code>int</code> ã€ <code>float</code> ç±»å‹ï¼›</li>\n<li>é›†åˆç±»å‹ï¼šä¾‹å¦‚ç”¨æ³›å‹æ¥å†™å †ã€æ ˆã€é˜Ÿåˆ—ç­‰ã€‚è™½ç„¶å¤§éƒ¨åˆ†ç±»ä¼¼çš„éœ€æ±‚å¯ä»¥é€šè¿‡ <code>slice</code> å’Œ  <code>channel</code> æ¥è§£å†³ï¼Œä½†æ˜¯å§‹ç»ˆæœ‰ä¸€äº›æƒ…å†µéš¾ä»¥é¿å…è¦è®¾è®¡ç‰¹æ®Šçš„é›†åˆç±»å‹ï¼Œå¦‚æœ‰åº <code>Set</code> å’Œä¼˜å…ˆçº§é˜Ÿåˆ—ï¼›</li>\n<li><code>slice</code> å’Œ  <code>map</code> çš„è¾…åŠ©æ–¹æ³•ï¼šå…¸å‹çš„å¦‚ map-reduce APIï¼›</li>\n</ul><p>ä½†æ˜¯è‡³ä»Šè¿˜æ˜¯æ²¡æœ‰äººè®¨è®º Go æ³›å‹çš„é™åˆ¶ï¼Œä»¥åŠè¿™äº›é™åˆ¶ä¼šå¦‚ä½•å½±å“æˆ‘ä»¬è§£å†³é—®é¢˜ã€‚</p><p>æ‰€ä»¥ä»Šå¤©æˆ‘å°†é‡ç‚¹è®¨è®ºè¿™ä¸ªé—®é¢˜ï¼Œä¸è¿‡å› ä¸ºç›®å‰æˆ‘ä¸»è¦æ˜¯åœ¨è®¾è®¡å’Œå¼€å‘ä¸­é—´ä»¶ï¼Œæ‰€ä»¥æˆ‘ä¼šä¾§é‡äºä¸­é—´ä»¶æ¥è¿›è¡Œè®¨è®ºï¼Œå½“ç„¶ä¹Ÿä¼šæ¶‰åŠä¸šåŠ¡å¼€å‘çš„å†…å®¹ã€‚ä½ å¯ä»¥ç»“åˆè‡ªå·±äº†è§£çš„ Go æ³›å‹å’Œç°æœ‰çš„ç¼–ç¨‹æ¨¡å¼æ¥å­¦ä¹ è¿™äº›é™åˆ¶ï¼Œä»è€Œåœ¨å°†æ¥ Go æ³›å‹æ­£å¼å‘å¸ƒä¹‹åé¿å¼€è¿™äº›é™åˆ¶ï¼Œå†™å‡ºä¼˜é›…çš„ Go æ³›å‹ä»£ç ã€‚</p><p>è¯ä¸å¤šè¯´ï¼Œæˆ‘ä»¬ç°åœ¨å¼€å§‹è®¨è®ºç¬¬ä¸€ç‚¹ï¼šGoæ³›å‹å­˜åœ¨å“ªäº›å±€é™ã€‚</p><h2>Go æ³›å‹çš„å±€é™</h2><p>åœ¨æ—©æœŸæ³›å‹è¿˜å¤„äºææ¡ˆé˜¶æ®µçš„æ—¶å€™ï¼Œæˆ‘å°±å°è¯•è¿‡åˆ©ç”¨æ³›å‹æ¥è®¾è®¡ä¸­é—´ä»¶ã€‚å½“ç„¶ï¼Œå³ä¾¿åˆ°ç°åœ¨ï¼Œæˆ‘å¯¹æ³›å‹çš„åº”ç”¨ä¾æ—§æç•™åœ¨å°è¯•é˜¶æ®µã€‚æ ¹æ®æˆ‘ä¸€å¹´å¤šçš„ä¸æ–­å°è¯•ï¼Œä»¥åŠæˆ‘è‡ªå·±å¯¹ä¸­é—´ä»¶å¼€å‘çš„ç†è§£ï¼Œç›®å‰æˆ‘è®¤ä¸ºå½±å“æœ€å¤§çš„ä¸‰ä¸ªå±€é™æ˜¯ï¼š</p><!-- [[[read_end]]] --><ul>\n<li>Go æ¥å£å’Œç»“æ„ä½“ä¸æ”¯æŒæ³›å‹æ–¹æ³•ï¼›</li>\n<li>æ³›å‹çº¦æŸä¸èƒ½ä½œä¸ºç±»å‹å£°æ˜ï¼›</li>\n<li>æ³›å‹çº¦æŸåªèƒ½æ˜¯æ¥å£ï¼Œè€Œä¸èƒ½æ˜¯ç»“æ„ä½“ã€‚</li>\n</ul><p>æ¥ä¸‹æ¥æˆ‘ä»¬å°±æ¥é€ä¸ªåˆ†æã€‚</p><h3><strong>Go æ¥å£å’Œç»“æ„ä½“ä¸æ”¯æŒæ³›å‹æ–¹æ³•</strong></h3><p>è¿™é‡Œéœ€è¦æˆ‘ä»¬æ³¨æ„çš„æ˜¯ï¼Œè™½ç„¶ Go æ¥å£æˆ–è€…ç»“æ„ä½“ä¸å…è®¸å£°æ˜æ³›å‹æ–¹æ³•ï¼Œä½†Go æ¥å£æˆ–è€…ç»“æ„ä½“å¯ä»¥æ˜¯æ³›å‹ã€‚</p><p>åœ¨åŸæ¥æ²¡æœ‰æ³›å‹çš„æ—¶å€™ï¼Œå¦‚æœè¦è®¾è®¡ä¸€ä¸ªå¯ä»¥å¤„ç†ä»»æ„ç±»å‹çš„æ¥å£ï¼Œæˆ‘ä»¬åªèƒ½ä½¿ç”¨ <code>interface{}</code> ï¼Œä¾‹å¦‚ï¼š</p><pre><code class=\"language-plain\">type Orm interface {\n   Insert(data ...interface{}) (sql.Result, error)\n}\n</code></pre><p>åœ¨è¿™ç§æ¨¡å¼ä¸‹ï¼Œç”¨æˆ·å¯ä»¥è¾“å…¥ä»»ä½•æ•°æ®ã€‚ä½†æ˜¯å¦‚æœç”¨æˆ·æ··ç”¨ä¸åŒç±»å‹ï¼Œä¾‹å¦‚ <code>Insert(&amp;User{},&amp;Order{})</code> ï¼Œå°±ä¼šå¯¼è‡´æ’å…¥å¤±è´¥ï¼Œè€Œç¼–è¯‘å™¨å¹¶ä¸èƒ½å¸®åŠ©ç”¨æˆ·æ£€æµ‹åˆ°è¿™ç§é”™è¯¯ã€‚</p><p>ä»åˆ©ç”¨ ORM è¯»å†™æ•°æ®åº“çš„åœºæ™¯æ¥çœ‹ï¼Œæˆ‘ä»¬æ˜¯å¸Œæœ›é™åˆ¶ä½  data å‚æ•°åªèƒ½æ˜¯å•ä¸€ç±»å‹çš„å¤šä¸ªå®ä¾‹ã€‚é‚£ä¹ˆåœ¨å¼•å…¥äº†æ³›å‹ä¹‹åï¼Œæˆ‘ä»¬å¯ä»¥å£°æ˜ä¸€ä¸ªæ³›å‹æ¥å£æ¥è¾¾æˆè¿™ç§çº¦æŸï¼š</p><pre><code class=\"language-plain\">type Orm[T any] interface {\n   Insert(data ...T) (sql.Result, error)\n}\n</code></pre><p>åœ¨è¿™ä¸ªæ¥å£é‡Œé¢ï¼Œæˆ‘ä»¬å£°æ˜äº†ä¸€ä¸ªæ³›å‹æ¥å£ <code>Orm</code> ï¼Œå®ƒå«æœ‰ä¸€ä¸ªç±»å‹å‚æ•°  <code>T</code> ï¼Œé€šè¿‡ <code>T</code> æˆ‘ä»¬ç¡®ä¿åœ¨ <code>Insert</code> é‡Œé¢ï¼Œç”¨æˆ·ä¼ å…¥çš„éƒ½æ˜¯åŒä¸€ä¸ªç±»å‹çš„ä¸åŒå®ä¾‹ã€‚</p><p>ç„¶è€Œè¿™ç§è®¾è®¡ä¹Ÿæ˜¯æœ‰é—®é¢˜çš„ï¼š<strong>æˆ‘ä»¬éœ€è¦åˆ›å»ºå¾ˆå¤šä¸ª</strong><code>Orm</code><strong>å®ä¾‹</strong>ã€‚ä¾‹å¦‚æ’å…¥ <code>User</code> çš„å®ä¾‹å’Œæ’å…¥ <code>Order</code> çš„å®ä¾‹ï¼š</p><pre><code class=\"language-plain\">var userOrm Orm[User]\nvar orderOrm Orm[Order]\n</code></pre><p>ä¹Ÿå°±æ˜¯è¯´ï¼Œæˆ‘ä»¬çš„åº”ç”¨æœ‰å¤šå°‘ä¸ªæ¨¡å‹ï¼Œå°±è¦å£°æ˜å¤šå°‘ä¸ª <code>Orm</code> çš„å®ä¾‹ã€‚</p><p>è¿™æ˜¾ç„¶æ˜¯ä¸å¯æ¥å—çš„ã€‚å› ä¸ºæˆ‘ä»¬è®¤ä¸º <code>Orm</code> åº”è¯¥æ˜¯ä¸€ä¸ªå¯ä»¥æ“ä½œä»»æ„æ¨¡å‹çš„æ¥å£ï¼Œä¹Ÿå°±æ˜¯ä¸€ä¸ª  <code>Orm</code> å®ä¾‹æ—¢å¯ä»¥ç”¨äºæ“ä½œ <code>User</code> ï¼Œä¹Ÿå¯ä»¥ç”¨äºæ“ä½œ <code>Order</code> ã€‚æ¢è¨€ä¹‹ï¼Œæˆ‘ä»¬å¹¶ä¸èƒ½æŠŠç±»å‹å‚æ•°å£°æ˜åœ¨ <code>Orm</code> è¿™æ ·ä¸€ä¸ªæ¥å£ä¸Šã€‚</p><p>é‚£ä¹ˆæˆ‘ä»¬åº”è¯¥å£°æ˜åœ¨å“ªé‡Œå‘¢ï¼Ÿ æ˜¾ç„¶ï¼Œæˆ‘ä»¬åº”è¯¥å£°æ˜åœ¨æ–¹æ³•ä¸Šï¼š</p><pre><code class=\"language-go\">type Orm interface {\n   Insert[T any](data ...T) (sql.Result, error)\n}\n</code></pre><p>ä¹ä¸€çœ‹ï¼Œè¿™ç§å£°æ˜æ–¹å¼å®Œå…¨èƒ½å¤Ÿè¾¾åˆ°æˆ‘ä»¬çš„ç›®æ ‡ï¼Œç”¨æˆ·ç”¨èµ·æ¥åªéœ€è¦ï¼š</p><pre><code class=\"language-go\">orm.Insert[*User](&amp;User{}, &amp;User{})\norm.Insert[*Order](&amp;Order{}, &amp;Order{})\n</code></pre><p>ç„¶è€Œï¼Œå¦‚æœæˆ‘ä»¬å°è¯•ç¼–è¯‘ï¼Œå°±ä¼šå¾—åˆ°é”™è¯¯ï¼š</p><pre><code class=\"language-shell\">interface method cannot have type parameters\n</code></pre><p>ä¹Ÿä¸ä»…ä»…æ˜¯æ¥å£ä¼šè¿™æ ·ï¼Œå³ä¾¿æˆ‘ä»¬ç›´æ¥åšæˆç»“æ„ä½“ï¼š</p><pre><code class=\"language-go\">type orm struct {\n}\nfunc (o orm) Insert[T any](data ...T) (sql.Result, error) {\n    //...\n}\n</code></pre><p>æˆ‘ä»¬ä¾æ—§ä¼šå¾—åˆ°ä¸€ä¸ªç±»ä¼¼çš„é”™è¯¯ï¼š</p><pre><code class=\"language-go\">invalid AST: method must have no type parameters\n</code></pre><p>å®é™…ä¸Šï¼Œæ“ä½œä»»æ„ç±»å‹çš„æ¥å£å¾ˆå¸¸è§ï¼Œç‰¹åˆ«æ˜¯å¯¹äºæä¾›å®¢æˆ·ç«¯åŠŸèƒ½çš„ä¸­é—´ä»¶æ¥è¯´ï¼Œå°¤å…¶å¸¸è§ã€‚ä¾‹å¦‚ï¼Œå¦‚æœæˆ‘ä»¬è®¾è®¡ä¸€ä¸ª HTTP å®¢æˆ·ç«¯çš„ä¸­é—´ä»¶ï¼Œæˆ‘ä»¬å¯èƒ½å¸Œæœ›æ˜¯ï¼š</p><pre><code class=\"language-go\">type HttpClient interface {\n   Get[T any](url string) (T, error)\n}\n</code></pre><p>è¿™æ ·ï¼Œç”¨æˆ·å¯ä»¥ç”¨ <code>client.Get[User](\"/user/123\")</code> å¾—åˆ°ä¸€ä¸ª  <code>User</code> çš„å®ä¾‹ã€‚<br>\nåˆæ¯”å¦‚ï¼Œå¦‚æœæˆ‘ä»¬è¦è®¾è®¡ä¸€ä¸ªç¼“å­˜å®¢æˆ·ç«¯ï¼š</p><pre><code class=\"language-go\">type CacheClient interface {\n   Get[T any](key string) (T, error)\n}\n</code></pre><p>ä½†æ˜¯ï¼Œæ˜¾ç„¶å®ƒä»¬éƒ½æ— æ³•é€šè¿‡ç¼–è¯‘ã€‚</p><p>å› æ­¤ï¼Œæˆ‘ä»¬å¯ä»¥è¯´ï¼Œ<strong>è¿™ä¸ªé™åˆ¶å¯¹æ‰€æœ‰çš„å®¢æˆ·ç«¯ç±»åº”ç”¨éƒ½å¾ˆä¸å‹å¥½</strong>ã€‚è¿™äº›å®¢æˆ·ç«¯åŒ…æ‹¬ Redisã€Kafka ç­‰å„ç§ä¸­é—´ä»¶ï¼Œä¹ŸåŒ…æ‹¬è¿™æåˆ°çš„ HTTPã€ORM ç­‰æ¡†æ¶ã€‚</p><h3><strong>æ³›å‹çº¦æŸä¸èƒ½ä½œä¸ºç±»å‹å£°æ˜</strong></h3><p>åœ¨æ³›å‹é‡Œé¢ï¼Œæœ‰ä¸€ä¸ªå¾ˆé‡è¦çš„æ¦‚å¿µâ€œçº¦æŸâ€ã€‚æˆ‘ä»¬ä½¿ç”¨çº¦æŸæ¥å£°æ˜ç±»å‹å‚æ•°è¦æ»¡è¶³çš„æ¡ä»¶ã€‚ä¸€ä¸ªå…¸å‹çš„ Go çº¦æŸï¼Œå¯ä»¥æ˜¯ä¸€ä¸ªæ™®é€šçš„æ¥å£ï¼Œä¹Ÿå¯ä»¥æ˜¯å¤šä¸ªç±»å‹çš„ç»„åˆï¼Œä¾‹å¦‚ï¼š</p><pre><code class=\"language-go\">type Integer interface {\n   int | int64 | int32 | int16 | int8\n}\n</code></pre><p>çœ‹åˆ°è¿™ç§è¯­æ³•ï¼Œæˆ‘ä»¬è‡ªç„¶ä¼šæƒ³åˆ°åœ¨ä¸­é—´ä»¶å¼€å‘ä¸­ï¼Œç»å¸¸ä¼šæœ‰è¿™ä¹ˆä¸€ç§æƒ…å†µï¼šæˆ‘ä»¬æŸä¸ªæ–¹æ³•æ¥æ”¶å¤šç§ç±»å‹çš„çš„å‚æ•°ï¼Œä½†æ˜¯å®ƒä»¬åˆæ²¡æœ‰å®ç°å…±åŒçš„æ¥å£ã€‚<br>\nä¾‹å¦‚ï¼Œæˆ‘ä»¬ç°åœ¨è¦è®¾è®¡ä¸€ä¸ª SQL çš„  <code>Builder</code> ï¼Œç”¨äºæ„é€   <code>SQL</code> ã€‚é‚£ä¹ˆåœ¨è®¾è®¡  <code>SELECT XXX</code> è¿™ä¸ªéƒ¨åˆ†çš„æ—¶å€™ï¼Œæœ€åŸºæœ¬ï¼Œä¹Ÿæ˜¯æœ€åŸºæœ¬çš„åšæ³•å°±æ˜¯ç›´æ¥ä¼  <code>string</code> ï¼š</p><pre><code class=\"language-go\">type Selector struct {\n   columns []string\n}\nfunc (s *Selector) Select(cols ...string) *Selector {\n   s.columns = cols\n   return s\n}\n\n</code></pre><p>ä½†æ˜¯è¿™ç§è®¾è®¡å­˜åœ¨ä¸€ä¸ªé—®é¢˜ï¼Œå°±æ˜¯<strong>ç”¨æˆ·å¦‚æœè¦ä½¿ç”¨èšåˆå‡½æ•°çš„è¯ï¼Œéœ€è¦è‡ªå·±æ‰‹åŠ¨æ‹¼æ¥</strong>ï¼Œä¾‹å¦‚ <code>Select(\"AVG(age)\")</code> ã€‚è€Œå®é™…ä¸Šï¼Œæˆ‘ä»¬å¸Œæœ›èƒ½å¤Ÿå¸®åŠ©ç”¨æˆ·å®Œæˆè¿™ä¸ªè¿‡ç¨‹ï¼Œå°†èšåˆå‡½æ•°ä¹Ÿå˜æˆä¸€ä¸ªæ–¹æ³•è°ƒç”¨ï¼š</p><pre><code class=\"language-go\">type Aggregate struct {\n   fun   string\n   col   string\n   alias string\n}\nfunc Avg(col string) Aggregate {\n   return Aggregate{\n      fun: \"AVG\",\n      col: col,\n   }\n}\nfunc (a Aggregate) As(alias string) Aggregate {\n   return Aggregate{\n      fun:   a.fun,\n      col:   a.col,\n      alias: alias,\n   }\n}\n</code></pre><p>ä½¿ç”¨èµ·æ¥å¦‚ï¼š <code>Select(Avg(\"age\").As(\"avg_age\"), \"name\")</code> ï¼Œè¿™æ ·æˆ‘ä»¬å°±èƒ½å¸®åŠ©æ£€æµ‹ä¼ å…¥çš„åˆ—åæ˜¯å¦æ­£ç¡®ï¼Œè€Œä¸”ç”¨æˆ·å¯ä»¥é¿å¼€å­—ç¬¦ä¸²æ‹¼æ¥ä¹‹ç±»çš„é—®é¢˜ã€‚</p><p>åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œ <code>Select</code> æ–¹æ³•å¿…é¡»è¦æ¥æ”¶ä¸¤ç§è¾“å…¥ï¼š <code>string</code> å’Œ <code>Aggregate</code> ã€‚åœ¨æ²¡æœ‰æ³›å‹çš„æƒ…å†µä¸‹ï¼Œå¤§å¤šæ•°æ—¶å€™æˆ‘ä»¬éƒ½æ˜¯ç›´æ¥ä½¿ç”¨ <code>interface</code> æ¥ä½œä¸ºå‚æ•°ï¼Œå¹¶ä¸”ç»“åˆ <code>switch-case</code> æ¥åˆ¤æ–­ï¼š</p><pre><code class=\"language-go\">type Selector struct {\n   columns []Aggregate\n}\nfunc (s *Selector) Select(cols ...interface{}) *Selector {\n   for _, col := range cols {\n      switch c := col.(type) {\n      case string:\n         s.columns = append(s.columns, Aggregate{col: c})\n      case Aggregate:\n         s.columns = append(s.columns, c)\n      default:\n         panic(\"invalid type\")\n      }\n   }\n   return s\n}\n</code></pre><p>ä½†æ˜¯è¿™ç§ç”¨æ³•å­˜åœ¨ä¸€ä¸ªé—®é¢˜ï¼Œå°±æ˜¯æ— æ³•åœ¨ç¼–è¯‘æœŸæ£€æŸ¥ç”¨æˆ·è¾“å…¥çš„ç±»å‹æ˜¯å¦æ­£ç¡®ï¼Œåªæœ‰åœ¨è¿è¡ŒæœŸ <code>default</code> åˆ†æ”¯å‘ç”Ÿ <code>panic</code> æ—¶æˆ‘ä»¬æ‰èƒ½çŸ¥é“ã€‚</p><p>ç‰¹åˆ«æ˜¯ï¼Œå¦‚æœç”¨æˆ·æœ¬æ„æ˜¯ä¼ ä¸€ä¸ª <code>var cols []string</code> ï¼Œç»“æœå†™æˆäº† <code>Select(cols)</code> è€Œä¸æ˜¯  <code>Select(cols...)</code> ï¼Œé‚£ä¹ˆå°±ä¼šå‡ºç° <code>panic</code> ï¼Œè€Œç¼–è¯‘å™¨ä¸æ¯«ä¸èƒ½å¸®æˆ‘ä»¬é¿å…è¿™ç§ä½çº§é”™è¯¯ã€‚</p><p>é‚£ä¹ˆï¼Œç»“åˆæˆ‘ä»¬çš„æ³›å‹çº¦æŸï¼Œä¼¼ä¹æˆ‘ä»¬å¯ä»¥è€ƒè™‘å†™æˆè¿™æ ·ï¼š</p><pre><code class=\"language-go\">type Selectable interface {\n   string | Aggregate\n}\ntype Selector struct {\n   columns []Selectable\n}\nfunc (s *Selector) Select(cols ...Selectable) *Selector {\n   panic(\"implement me\")\n}\n</code></pre><p>åˆ©ç”¨ <code>Selectable</code> çº¦æŸï¼Œæˆ‘ä»¬é™åˆ¶ä½äº†ç±»å‹åªèƒ½æ˜¯ <code>string</code> æˆ–è€…  <code>Aggregate</code> ã€‚é‚£ä¹ˆç”¨æˆ·å¯ä»¥ç›´æ¥ä½¿ç”¨ <code>string</code> ï¼Œä¾‹å¦‚ <code>Select(\"name\", Avg(\"age\")</code> ã€‚</p><p>çœ‹èµ·æ¥éå¸¸å®Œç¾ï¼Œç”¨æˆ·äº«å—åˆ°äº†ç¼–è¯‘æœŸæ£€æŸ¥ï¼Œåˆä¸ä¼šå‡ºç° <code>panic</code> çš„é—®é¢˜ã€‚</p><p>ç„¶è€Œï¼Œè¿™ä¾æ—§æ˜¯ä¸è¡Œçš„ï¼Œç¼–è¯‘çš„æ—¶å€™ä¼šç›´æ¥æŠ¥é”™ï¼š</p><pre><code class=\"language-shell\">interface contains type constraints\n</code></pre><p>ä¹Ÿå°±æ˜¯è¯´ï¼Œæ³›å‹çº¦æŸä¸èƒ½è¢«ç”¨äºåšå‚æ•°ï¼Œå®ƒåªèƒ½å’Œæ³›å‹ç»“åˆåœ¨ä¸€èµ·ä½¿ç”¨ï¼Œ<strong>è¿™å°±å¯¼è‡´æˆ‘ä»¬å¹¶ä¸èƒ½ç”¨æ³›å‹çš„çº¦æŸï¼Œæ¥è§£å†³æŸä¸ªæ¥å£å¯ä»¥å¤„ç†æœ‰é™å¤šç§ç±»å‹è¾“å…¥çš„é—®é¢˜</strong>ã€‚æ‰€ä»¥é•¿æœŸæ¥çœ‹ï¼Œ <code>interface{}</code> è¿™ç§å‚æ•°ç±»å‹è¿˜ä¼šå¹¿æ³›å­˜åœ¨äºæ‰€æœ‰ä¸­é—´ä»¶çš„è®¾è®¡ä¸­ã€‚</p><h3>æ³›å‹çº¦æŸåªèƒ½æ˜¯æ¥å£ï¼Œè€Œä¸èƒ½æ˜¯ç»“æ„ä½“</h3><p>ä¼—æ‰€å‘¨çŸ¥ï¼ŒGo é‡Œé¢æœ‰ä¸€ä¸ªç‰¹æ€§æ˜¯ç»„åˆã€‚å› æ­¤åœ¨æ³›å‹å¼•å…¥çš„æ—¶å€™ï¼Œæˆ‘ä»¬å¯èƒ½ä¼šè€ƒè™‘èƒ½å¦ç”¨æ³›å‹çš„çº¦æŸæ¥é™åˆ¶å…·ä½“ç±»å‹å¿…é¡»ç»„åˆäº†æŸä¸ªç±»å‹ã€‚</p><p>ä¾‹å¦‚ï¼š</p><pre><code class=\"language-go\">type BaseEntity struct {\n   Id int64\n}\nfunc Insert[Entity BaseEntity](e *Entity) {\n   \n}\ntype myEntity struct {\n   BaseEntity\n   Name string\n}\n</code></pre><p>åœ¨å®é™…ä¸­è¿™ä¹Ÿæ˜¯ä¸€ä¸ªå¾ˆå¸¸è§çš„åœºæ™¯ï¼Œå³æˆ‘ä»¬åœ¨ ORM æ“ä½œçš„æ—¶å€™å¸Œæœ›å®ä½“ç±»å¿…é¡»ç»„åˆ <code>BaseEntity</code> ï¼Œè¿™ä¸ª <code>BaseEntity</code> ä¸Šä¼šå®šä¹‰ä¸€äº›å…¬å…±å­—æ®µå’Œå…¬å…±æ–¹æ³•ã€‚</p><p>ä¸è¿‡ï¼ŒåŒæ ·çš„ï¼ŒGo æ³›å‹ä¸æ”¯æŒè¿™ç§ç”¨æ³•ã€‚Go æ³›å‹çº¦æŸå¿…é¡»æ˜¯ä¸€ä¸ªæ¥å£ï¼Œè€Œä¸èƒ½æ˜¯ä¸€ä¸ªç»“æ„ä½“ï¼Œå› æ­¤ä¸Šé¢è¿™æ®µä»£ç ä¼šæŠ¥é”™ï¼š</p><pre><code class=\"language-go\">myEntity does not implement BaseEntity\n</code></pre><p>ä¸è¿‡ï¼Œç›®å‰æ³›å‹è¿˜æ²¡æœ‰å®Œå…¨æ”¯æŒå¥½ï¼Œæ‰€ä»¥è¿™ä¸ªæŠ¥é”™ä¿¡æ¯å¹¶ä¸å¤Ÿå‡†ç¡®ï¼Œæ›´åŠ å‡†ç¡®çš„ä¿¡æ¯åº”è¯¥æ˜¯æŒ‡å‡º <code>BaseEntity</code> åªèƒ½ä¸ºæ¥å£ã€‚</p><p>è¿™ä¸ªé™åˆ¶å½±å“ä¹Ÿå¾ˆå¤§ï¼Œ<strong>å®ƒç›´æ¥å µæ­»äº†æˆ‘ä»¬è®¾è®¡å…±äº«å­—æ®µçš„æ³›å‹æ–¹æ³•çš„é“è·¯</strong>ã€‚è€Œä¸”ï¼Œå®ƒå¯¹äºä¸šåŠ¡å¼€å‘çš„å½±å“è¦æ¯”å¯¹ä¸­é—´ä»¶å¼€å‘çš„å½±å“æ›´å¤§ï¼Œå› ä¸ºä¸šåŠ¡å¼€å‘ä¼šç»å¸¸é‡åˆ°å¿…é¡»è¦å…±äº«æŸäº›æ•°æ®çš„åœºæ™¯ï¼Œä¾‹å¦‚è¿™é‡Œçš„ ORM ä¾‹å­ï¼Œè¿˜æœ‰å‰ç«¯æ¥æ”¶å‚æ•°çš„åœºæ™¯ç­‰ã€‚</p><h2>ç»•å¼€é™åˆ¶çš„æ€è·¯</h2><p>ä»å‰é¢çš„åˆ†ææ¥çœ‹ï¼Œè¿™äº›é™åˆ¶å½±å“å¹¿æ³›ï¼Œè€Œä¸”é™åˆ¶äº†æ³›å‹çš„è¿›ä¸€æ­¥åº”ç”¨ã€‚ä½†æ˜¯ï¼Œæˆ‘ä»¬å¯ä»¥å°è¯•ä½¿ç”¨ä¸€äº›åˆ«çš„æ‰‹æ®µæ¥ç»•å¼€è¿™äº›é™åˆ¶ã€‚</p><h3>Builder æ¨¡å¼</h3><p>å‰é¢æåˆ°ï¼Œå› ä¸º Go æ³›å‹é™åˆ¶äº†æ¥å£æˆ–è€…ç»“æ„ä½“ï¼Œè®©å®ƒä»¬ä¸èƒ½æœ‰æ³›å‹æ–¹æ³•ï¼Œæ‰€ä»¥å¯¹å®¢æˆ·ç«¯ç±»çš„ä¸­é—´ä»¶ API è®¾è®¡å¾ˆä¸å‹å¥½ã€‚</p><p>ä½†æ˜¯ï¼Œæˆ‘ä»¬å¯ä»¥å°è¯•ç”¨ <code>Builder</code> æ¨¡å¼æ¥è§£å†³è¿™ä¸ªé—®é¢˜ã€‚ç°åœ¨æˆ‘ä»¬å›åˆ°å‰é¢è¯´çš„ HTTP å®¢æˆ·ç«¯çš„ä¾‹å­è¯•è¯•çœ‹ï¼Œè¿™ä¸ªä¾‹å­æˆ‘ä»¬å¯ä»¥è®¾è®¡æˆï¼š</p><pre><code class=\"language-go\">type HttpClient struct {\n   endpoint string\n}\ntype GetBuilder[T any] struct {\n   client *HttpClient\n   path   string\n}\nfunc (g *GetBuilder[T]) Path(path string) *GetBuilder[T] {\n   g.path = path\n   return g\n}\nfunc (g *GetBuilder[T]) Do() T {\n   // çœŸå®å‘å‡º HTTP è¯·æ±‚\n   url := g.client.endpoint + g.path\n}\nfunc NewGetRequest[T any](client *HttpClient) *GetBuilder {\n   return &amp;GetBuilder[T]{client: client}\n}\n</code></pre><p>è€Œæœ€å¼€å§‹æƒ³åˆ©ç”¨æ³›å‹çš„æ—¶å€™ï¼Œæˆ‘ä»¬æ˜¯å¸Œæœ›å°†æ³›å‹å®šä¹‰åœ¨æ–¹æ³•çº§åˆ«ä¸Šï¼š</p><pre><code class=\"language-go\">type HttpClient interface {\n   Get[T any](url string) (T, error)\n}\n</code></pre><p>ä¸¤è€…æœ€å¤§çš„ä¸åŒå°±åœ¨äº <code>NewGetRequest</code> æ˜¯ä¸€ç§è¿‡ç¨‹å¼çš„è®¾è®¡ã€‚åœ¨ <code>Builder</code> è®¾è®¡ä¹‹ä¸‹ï¼Œ <code>HttpClient</code> è¢«è§†ä½œå„ç§é…ç½®çš„è½½ä½“ï¼Œè€Œä¸æ˜¯ä¸€ä¸ªçœŸå®å‘å‡ºè¯·æ±‚çš„å®¢æˆ·ç«¯ã€‚å¦‚æœä½ æœ‰ Java ä¹‹ç±»é¢å‘å¯¹è±¡çš„ç¼–ç¨‹è¯­è¨€çš„ä½¿ç”¨èƒŒæ™¯ï¼Œé‚£ä¹ˆä½ ä¼šå¾ˆä¸ä¹ æƒ¯è¿™ç§å†™æ³•ã€‚</p><p>å½“ç„¶æˆ‘ä»¬å¯ä»¥å°† <code>HttpClient</code> åšæˆçœŸçš„å®¢æˆ·ç«¯ï¼Œè€ŒæŠŠ <code>GetBuilder</code> çœ‹æˆæ˜¯ä¸€å±‚æ³›å‹çš„çš®ï¼š</p><pre><code class=\"language-go\">func (g *GetBuilder[T]) Do() T {\n   var t T\n   g.client.get(g.path, &amp;t)\n   return t\n}\n</code></pre><p>æ— è®ºå“ªä¸€ç§ï¼Œæœ¬è´¨ä¸Šéƒ½æ˜¯åˆ©ç”¨äº†è¿‡ç¨‹å¼çš„å†™æ³•ï¼Œæ ¸å¿ƒéƒ½æ˜¯ Client + Builderã€‚é‚£ä¹ˆåœ¨å°†æ¥è®¾è®¡å„ç§å®¢æˆ·ç«¯ä¸­é—´ä»¶çš„æ—¶å€™ï¼Œä½ å°±å¯ä»¥è€ƒè™‘å°è¯•è¿™ç§è§£å†³æ€è·¯ã€‚</p><h3>æ ‡è®°æ¥å£</h3><p>æ ‡è®°æ¥å£è¿™ç§æ–¹æ¡ˆï¼Œå¯ä»¥ç”¨æ¥è§£å†³æ³›å‹çº¦æŸä¸èƒ½ç”¨ä½œç±»å‹å£°æ˜çš„é™åˆ¶ã€‚é¡¾åæ€ä¹‰ï¼Œæ ‡è®°æ¥å£ï¼ˆtag interfaceæˆ–è€… marker interfaceï¼‰å°±æ˜¯æ‰“ä¸€ä¸ªæ ‡è®°ï¼Œæœ¬èº«å¹¶ä¸å…·å¤‡æ„ä¹‰ã€‚è¿™ç§æ€è·¯åœ¨åˆ«çš„è¯­è¨€é‡Œé¢ä¹Ÿå¾ˆå¸¸è§ï¼Œæ¯”å¦‚è¯´ Java <code>shardingsphere</code> é‡Œé¢å°±æœ‰ä¸€ä¸ª  <code>OptionalSPI</code> çš„æ ‡è®°æ¥å£ï¼š</p><pre><code class=\"language-go\">public interface OptionalSPI {\n}\n</code></pre><p>å®ƒä»€ä¹ˆæ–¹æ³•éƒ½æ²¡æœ‰ï¼Œåªæ˜¯è¯´å®ç°äº†è¿™ä¸ªæ¥å£çš„ SPI éƒ½æ˜¯â€œå¯é€‰çš„â€ã€‚</p><p>Go é‡Œé¢å°±ä¸èƒ½ç”¨ç©ºæ¥å£ä½œä¸ºæ ‡è®°æ¥å£ï¼Œå¦åˆ™æ‰€æœ‰ç»“æ„ä½“éƒ½å¯ä»¥è¢«è®¤ä¸ºå®ç°äº†æ ‡ç­¾æ¥å£ï¼ŒGoä¸­å¿…é¡»è¦è‡³å°‘å£°æ˜ä¸€ä¸ªç§æœ‰æ–¹æ³•ã€‚ä¾‹å¦‚æˆ‘ä»¬å‰é¢è®¨è®ºçš„ <code>SELECT</code> æ—¢å¯ä»¥æ˜¯åˆ—ï¼Œä¹Ÿå¯ä»¥æ˜¯èšåˆå‡½æ•°çš„é—®é¢˜ï¼Œæˆ‘ä»¬å°±å¯ä»¥å°è¯•å£°æ˜ä¸€ä¸ªæ¥å£ï¼š</p><pre><code class=\"language-go\">type Selectable interface {\n   aggr()\n}\ntype Column string\nfunc (c Column) aggr() {}\ntype Aggregate struct {}\nfunc (c Aggregate) aggr() {}\n\nfunc (s *Selector) Select(cols ...Selectable) *Selector {\n   panic(\"implement me\")\n}\n</code></pre><p>è¿™é‡Œï¼Œ <code>Selectable</code> å°±æ˜¯ä¸€ä¸ªæ ‡è®°æ¥å£ã€‚å®ƒçš„æ–¹æ³• <code>aggr</code> æ²¡æœ‰ä»»ä½•çš„å«ä¹‰ï¼Œå®ƒå°±æ˜¯ç”¨äºé™å®š  <code>Select</code> æ–¹æ³•åªèƒ½æ¥æ”¶ç‰¹å®šç±»å‹çš„è¾“å…¥ã€‚</p><p>ä½†æ˜¯ç”¨èµ·æ¥å…¶å®ä¹Ÿä¸æ˜¯å¾ˆæ–¹ä¾¿ï¼Œæ¯”å¦‚ä½ çœ‹è¿™å¥ä»£ç ï¼š <code>Select(Column(\"name\"), Avg(\"avg_id\"))</code> ã€‚å³ä¾¿ä½ å®Œå…¨ä¸ç”¨èšåˆå‡½æ•°ï¼Œä½ ä¹Ÿå¾—ç”¨ <code>Column</code> æ¥ä¼ å…¥åˆ—ï¼Œè€Œä¸èƒ½ç›´æ¥ä¼ é€’å­—ç¬¦ä¸²ã€‚ä½†æ˜¯ç›¸æ¯”ä¹‹å‰æ¥æ”¶ <code>interface{}</code> ä½œä¸ºè¾“å…¥ï¼Œå°±è¦å¥½å¾ˆå¤šäº†ï¼Œè‡³å°‘å—åˆ°äº†ç¼–è¯‘å™¨å¯¹ç±»å‹çš„æ£€æŸ¥ã€‚</p><h3>Getter/Setter æ¥å£</h3><p>Getter/Setter å¯ä»¥ç”¨äºè§£å†³æ³›å‹çº¦æŸåªèƒ½æ˜¯æ¥å£è€Œä¸èƒ½æ˜¯ç»“æ„ä½“çš„é™åˆ¶ï¼Œä½†æ˜¯å®ƒå¹¶ä¸é‚£ä¹ˆä¼˜é›…ã€‚</p><p>æ ¸å¿ƒæ€è·¯åœ¨äºï¼Œæˆ‘ä»¬ç»™æ‰€æœ‰çš„å­—æ®µéƒ½åŠ ä¸Š <code>Get/Set</code> æ–¹æ³•ï¼Œå¹¶ä¸”æå–å‡ºæ¥ä½œä¸ºä¸€ä¸ªæ¥å£ã€‚ä¾‹å¦‚ï¼š</p><pre><code class=\"language-go\">type Entity interface {\n   Id() int64\n   SetId(id int64)\n}\ntype BaseEntity struct {\n   id int64\n}\nfunc (b *BaseEntity) Id() int64 {\n   return b.id\n}\nfunc (b *BaseEntity) SetId(id int64) {\n   b.id = id\n}\n</code></pre><p>é‚£ä¹ˆæˆ‘ä»¬æ‰€æœ‰çš„ ORM æ“ä½œéƒ½å¯ä»¥é™åˆ¶åˆ°è¯¥ç±»å‹ä¸Šï¼š</p><pre><code class=\"language-go\">type myEntity struct {\n   BaseEntity\n}\nfunc Insert[E Entity](e *E) {\n}\n</code></pre><p>çœ‹ç€è¿™æ®µä»£ç ï¼ŒJava èƒŒæ™¯çš„åŒå­¦åº”è¯¥ä¼šè§‰å¾—å¾ˆçœ¼ç†Ÿï¼Œä½†æ˜¯åœ¨ Go é‡Œé¢æ›´åŠ ä¹ æƒ¯äºç›´æ¥è®¿é—®å­—æ®µï¼Œè€Œä¸æ˜¯ä½¿ç”¨ Getter/Setterã€‚</p><p>ä½†æ˜¯å¦‚æœåªæ˜¯å°‘é‡ä½¿ç”¨ï¼Œå¹¶ä¸”ç»“åˆç»„åˆç‰¹æ€§ï¼Œé‚£ä¹ˆæ•ˆæœä¹Ÿè¿˜ç®—ä¸é”™ã€‚ä¾‹å¦‚åœ¨æˆ‘ä»¬çš„ä¾‹å­é‡Œé¢ï¼Œé€šè¿‡ç»„åˆ <code>BaseEntity</code> ï¼Œæˆ‘ä»¬è§£å†³äº†æ‰€æœ‰çš„ç»“æ„ä½“éƒ½è¦å®ç°ä¸€é  <code>Entity</code> æ¥å£çš„é—®é¢˜ã€‚</p><h2>æ€»ç»“</h2><p>æˆ‘ä»¬è¿™é‡Œè®¨è®ºäº†ä¸‰ä¸ªæ³›å‹çš„é™åˆ¶ï¼š</p><ul>\n<li>Go æ¥å£å’Œç»“æ„ä½“ä¸æ”¯æŒæ³›å‹æ–¹æ³•ï¼›</li>\n<li>æ³›å‹çº¦æŸä¸èƒ½ä½œä¸ºç±»å‹å£°æ˜ï¼›</li>\n<li>æ³›å‹çº¦æŸåªèƒ½æ˜¯æ¥å£ï¼Œè€Œä¸èƒ½æ˜¯ç»“æ„ä½“ã€‚</li>\n</ul><p>å¹¶ä¸”è®¨è®ºäº†ä¸‰ä¸ªå¯¹åº”çš„ã€å¯è¡Œçš„è§£å†³æ€è·¯ï¼š</p><ul>\n<li>Builder æ¨¡å¼ï¼›</li>\n<li>æ ‡è®°æ¥å£ï¼›</li>\n<li>Getter/Setter æ¥å£ã€‚</li>\n</ul><p>ä»æˆ‘ä¸ªäººçœ‹æ¥ï¼Œè¿™äº›è§£å†³æ€è·¯åªèƒ½ç®—æ˜¯æ•ˆæœä¸é”™ï¼Œä½†æ˜¯ä¸å¤Ÿä¼˜é›…ã€‚æ‰€ä»¥æˆ‘è¿˜æ˜¯å¾ˆæœŸç›¼ Go å°†æ¥èƒ½å¤Ÿæ”¾å¼€è¿™ç§é™åˆ¶ã€‚æ¯•ç«Ÿåœ¨è¿™ä¸‰ä¸ªçº¦æŸä¹‹ä¸‹ï¼ŒGo æ³›å‹ä½¿ç”¨åœºæ™¯è¿‡äºå—é™ã€‚</p><p>ä»æˆ‘ä¸ªäººçš„å·¥ä½œç»å†å‡ºå‘ï¼Œæˆ‘è§‰å¾—å¯¹äºå¤§å¤šæ•°ä¸­é—´ä»¶æ¥è¯´ï¼Œå¯ä»¥ä½¿ç”¨æ³›å‹æ¥æä¾›å¯¹ç”¨æˆ·å‹å¥½çš„ APIï¼Œä½†æ˜¯å¯¹äºå†…éƒ¨å®ç°æ¥è¯´ï¼Œä½¿ç”¨æ³›å‹çš„æ”¶ç›Šéå¸¸æœ‰é™ã€‚å¦‚æœç°åœ¨å·²æœ‰çš„ä»£ç é£æ ¼å°±æ˜¯è¿‡ç¨‹å¼çš„ï¼Œé‚£ä¹ˆä½ å°±å¯ä»¥å°è¯•ç”¨æ³›å‹å°†å®ƒå®Œå…¨é‡æ„ä¸€ç•ªã€‚</p><p>æ€»çš„æ¥è¯´ï¼Œæˆ‘å¯¹ Go æ³›å‹çš„æ™®åŠæŒæœ‰ä¸€ç§æ¯”è¾ƒæ‚²è§‚çš„æ€åº¦ã€‚æˆ‘é¢„è®¡æ³›å‹ä»å‡ºæ¥åˆ°å¤§è§„æ¨¡åº”ç”¨è¿˜æœ‰ä¸€æ®µéå¸¸é¥è¿œçš„è·ç¦»ï¼Œç”šè‡³æœ‰äº›å…¬å¸å¯èƒ½åœ¨é•¿æ—¶é—´å†…ä¸ºäº†ä¿æŒä»£ç é£æ ¼ç»Ÿä¸€ï¼Œè€Œç¦ç”¨æ³›å‹ç‰¹æ€§ã€‚</p><h2>æ€è€ƒé¢˜</h2><ol>\n<li>å¦‚æœä½ æ˜¯ä¸­é—´ä»¶å¼€å‘ï¼Œä½ è§‰å¾— Go æ³›å‹å‡ºæ¥ä¹‹åï¼Œä½ ä¼šç”¨æ³›å‹æ¥æ”¹é€ ä½ ç»´æŠ¤çš„é¡¹ç›®å—ï¼Ÿ</li>\n<li>å¦‚æœä½ ç”¨äº†ä¸€äº›å¼€æºè½¯ä»¶ï¼Œä½ ä¼šå¸Œæœ›å®ƒä»¬çš„ç»´æŠ¤è€…æš´éœ²æ³›å‹ API ç»™ä½ å—ï¼Ÿ</li>\n<li>ä»ä½ çš„ä¸ªäººç»éªŒå‡ºå‘ï¼Œä½ ä¼šå¸Œæœ› Go æ³›å‹æ”¾å¼€è¿™äº›é™åˆ¶å—ï¼Ÿ</li>\n</ol><p>æ¬¢è¿åœ¨ç•™è¨€åŒºåˆ†äº«ä½ çš„çœ‹æ³•ï¼Œæˆ‘ä»¬ä¸€èµ·è®¨è®ºã€‚</p>","comments":[{"had_liked":false,"id":341566,"user_name":"yandongxiao","can_delete":false,"product_type":"c1","uid":1017700,"ip_address":"","ucode":"D397F4DB0109C8","user_header":"https://static001.geekbang.org/account/avatar/00/0f/87/64/3882d90d.jpg","comment_is_top":false,"comment_ctime":1649693227,"is_pvip":false,"replies":[{"id":124882,"content":"ğŸ‘ ä¹‹å‰Goå›¢é˜Ÿåšä¸ªspeakï¼Œä¹Ÿå†™è¿‡blogï¼Œä»‹ç»è¯¥å¦‚ä½•ç”¨æ³›å‹ï¼Œä»¥åŠä¸è¦æ»¥ç”¨æ³›å‹ã€‚","user_name":"ä½œè€…å›å¤","user_name_real":"ç¼–è¾‘","uid":1026224,"ctime":1649902992,"ip_address":"","comment_id":341566,"utype":1}],"discussion_count":1,"race_medal":0,"score":2,"product_id":100093501,"comment_content":"ä¸çŸ¥é“æ˜¯ä»å“ªé‡Œçœ‹åˆ°çš„ã€‚\n\nä»€ä¹ˆæ—¶å€™è¦ä½¿ç”¨æ³›å‹ï¼Ÿ\n1. write code do not design types. å…ˆå†™å‡½æ•°ï¼Œåˆ«ç€æ€¥ä¸€ä¸Šæ¥å°±å†™æ³›å‹ï¼Œå‡½æ•°æ³›å‹åŒ–æ˜¯æ¯”è¾ƒç®€å•çš„ã€‚\n2. Functions that work on slices, maps, and channels of any element type. é‚£äº›ä¸åœ¨ä¹å®¹å™¨å†…çš„å…ƒç´ ç±»å‹çš„å‡½æ•°ã€‚\n3. general purpose data structï¼Œç®—æ³•ï¼Œä¾‹å¦‚ï¼Œé“¾è¡¨ã€äºŒå‰æ ‘ç­‰ã€‚\n4. when a method looks the same for all typesã€‚å½“ä½ å‘ç°ä½ ä¸å¾—ä¸å®ç°ä¸€æ®µé‡å¤çš„é€»è¾‘æ—¶ï¼Œå°±å¯ä»¥è€ƒè™‘æ³›å‹ã€‚\n","like_count":4},{"had_liked":false,"id":335413,"user_name":"æ´›ä¹¦","can_delete":false,"product_type":"c1","uid":2421848,"ip_address":"","ucode":"4F1C41E4679879","user_header":"https://static001.geekbang.org/account/avatar/00/24/f4/58/383cd3a0.jpg","comment_is_top":false,"comment_ctime":1645511838,"is_pvip":false,"replies":[{"id":122580,"content":"æ®æˆ‘è¯´çŸ¥ä¸æ˜¯æ ‡æ–°ç«‹å¼‚ã€‚è¿™å’Œgoç¼–è¯‘å™¨è§£æ&lt;&gt;çš„äºŒä¹‰æ€§æœ‰å…³ã€‚goç¼–è¯‘å™¨åªæ‰«æä¸€éä»£ç ï¼Œæ— æ³•åœ¨ä¸Šä¸‹æ–‡ä¸­åˆ¤æ–­&lt;&gt;ç©¶ç«Ÿæ˜¯å•¥ï¼Œæ˜¯æ³›å‹å£°æ˜è¿˜æ˜¯å¤§å°äºå·ã€‚","user_name":"ä½œè€…å›å¤","user_name_real":"ç¼–è¾‘","uid":1026224,"ctime":1645594144,"ip_address":"","comment_id":335413,"utype":1}],"discussion_count":1,"race_medal":0,"score":2,"product_id":100093501,"comment_content":"æœ€ä¸å¯æ¥å—çš„æ˜¯ä½¿ç”¨[]ä½œä¸ºæ³›å‹ç±»å‹å£°æ˜,\n[] æœ¬èº«å·²ç»ä½œä¸ºslice,array,mapçš„ç´¢å¼•æ“ä½œç¬¦,è€Œä¸”å¤§å¤šæ•°äººéƒ½æœ‰åˆ«çš„è¯­è¨€å¼€å‘çš„ç»éªŒ,ä¸‹æ„è¯†ä¼šæŠŠ[]å½“ä½œä¸‹è¡¨è§£é‡Š. è¿™æ‰æ˜¯å¿ƒæ™ºè´Ÿæ‹…. è€Œä½¿ç”¨&lt;&gt;å°±æ²¡æœ‰è¿™ä¸ªé—®é¢˜.\næ ‡æ–°ç«‹å¼‚?","like_count":0,"discussions":[{"author":{"id":1026224,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/a8/b0/6f87ab08.jpg","nickname":"Tony Bai","note":"","ucode":"B6B08985F6FA89","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":562880,"discussion_content":"ğŸ‘ ä¹‹å‰Goå›¢é˜Ÿåšä¸ªspeakï¼Œä¹Ÿå†™è¿‡blogï¼Œä»‹ç»è¯¥å¦‚ä½•ç”¨æ³›å‹ï¼Œä»¥åŠä¸è¦æ»¥ç”¨æ³›å‹ã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1649902993,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":359778,"user_name":"pike","can_delete":false,"product_type":"c1","uid":2872523,"ip_address":"ä¸Šæµ·","ucode":"14C33D4DECE376","user_header":"https://static001.geekbang.org/account/avatar/00/2b/d4/cb/65cc1192.jpg","comment_is_top":false,"comment_ctime":1665871406,"is_pvip":false,"replies":null,"discussion_count":0,"race_medal":0,"score":2,"product_id":100093501,"comment_content":"å½“ä½ è¦ä¸ºä¸åŒçš„ç±»å‹å†™ç›¸åŒé€»è¾‘çš„ä»£ç ï¼Œæ³›","like_count":0},{"had_liked":false,"id":335415,"user_name":"æ´›ä¹¦","can_delete":false,"product_type":"c1","uid":2421848,"ip_address":"","ucode":"4F1C41E4679879","user_header":"https://static001.geekbang.org/account/avatar/00/24/f4/58/383cd3a0.jpg","comment_is_top":false,"comment_ctime":1645512169,"is_pvip":false,"replies":null,"discussion_count":0,"race_medal":0,"score":2,"product_id":100093501,"comment_content":"\ntype Vector[T any] []T\ntype Vector&lt;T any&gt; []T\n\ntype Vector[T any] [][]T\ntype Vector&lt;T any] [][]T\n\nå­°ä¼˜å­°åŠ£,ä¸éš¾çœ‹å‡º,ä¸æ˜ç™½ä¸ºä»€ä¹ˆå¤´é“çš„é‡‡ç”¨[]åŒ…è£¹æ³›å‹å£°æ˜, æ ‡æ–°ç«‹å¼‚?","like_count":0},{"had_liked":false,"id":333788,"user_name":"ç½—æ°","can_delete":false,"product_type":"c1","uid":1320487,"ip_address":"","ucode":"96BAFAA147341F","user_header":"https://static001.geekbang.org/account/avatar/00/14/26/27/eba94899.jpg","comment_is_top":false,"comment_ctime":1644536414,"is_pvip":false,"replies":null,"discussion_count":0,"race_medal":0,"score":2,"product_id":100093501,"comment_content":"çœ‹èµ·æ¥é™åˆ¶è¿˜æ˜¯éå¸¸å¤šï¼Œä¸è¿‡å¯¹æˆ‘è€Œè¨€ï¼Œæ³›å‹å‡ ä¹éƒ½æ²¡æœ‰ä½¿ç”¨åœºæ™¯ã€‚","like_count":0},{"had_liked":false,"id":341566,"user_name":"yandongxiao","can_delete":false,"product_type":"c1","uid":1017700,"ip_address":"","ucode":"D397F4DB0109C8","user_header":"https://static001.geekbang.org/account/avatar/00/0f/87/64/3882d90d.jpg","comment_is_top":false,"comment_ctime":1649693227,"is_pvip":false,"replies":[{"id":124882,"content":"ğŸ‘ ä¹‹å‰Goå›¢é˜Ÿåšä¸ªspeakï¼Œä¹Ÿå†™è¿‡blogï¼Œä»‹ç»è¯¥å¦‚ä½•ç”¨æ³›å‹ï¼Œä»¥åŠä¸è¦æ»¥ç”¨æ³›å‹ã€‚","user_name":"ä½œè€…å›å¤","user_name_real":"ç¼–è¾‘","uid":1026224,"ctime":1649902992,"ip_address":"","comment_id":341566,"utype":1}],"discussion_count":1,"race_medal":0,"score":2,"product_id":100093501,"comment_content":"ä¸çŸ¥é“æ˜¯ä»å“ªé‡Œçœ‹åˆ°çš„ã€‚\n\nä»€ä¹ˆæ—¶å€™è¦ä½¿ç”¨æ³›å‹ï¼Ÿ\n1. write code do not design types. å…ˆå†™å‡½æ•°ï¼Œåˆ«ç€æ€¥ä¸€ä¸Šæ¥å°±å†™æ³›å‹ï¼Œå‡½æ•°æ³›å‹åŒ–æ˜¯æ¯”è¾ƒç®€å•çš„ã€‚\n2. Functions that work on slices, maps, and channels of any element type. é‚£äº›ä¸åœ¨ä¹å®¹å™¨å†…çš„å…ƒç´ ç±»å‹çš„å‡½æ•°ã€‚\n3. general purpose data structï¼Œç®—æ³•ï¼Œä¾‹å¦‚ï¼Œé“¾è¡¨ã€äºŒå‰æ ‘ç­‰ã€‚\n4. when a method looks the same for all typesã€‚å½“ä½ å‘ç°ä½ ä¸å¾—ä¸å®ç°ä¸€æ®µé‡å¤çš„é€»è¾‘æ—¶ï¼Œå°±å¯ä»¥è€ƒè™‘æ³›å‹ã€‚\n","like_count":4,"discussions":[{"author":{"id":1026224,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/a8/b0/6f87ab08.jpg","nickname":"Tony Bai","note":"","ucode":"B6B08985F6FA89","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":562880,"discussion_content":"ğŸ‘ ä¹‹å‰Goå›¢é˜Ÿåšä¸ªspeakï¼Œä¹Ÿå†™è¿‡blogï¼Œä»‹ç»è¯¥å¦‚ä½•ç”¨æ³›å‹ï¼Œä»¥åŠä¸è¦æ»¥ç”¨æ³›å‹ã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1649902993,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":335413,"user_name":"æ´›ä¹¦","can_delete":false,"product_type":"c1","uid":2421848,"ip_address":"","ucode":"4F1C41E4679879","user_header":"https://static001.geekbang.org/account/avatar/00/24/f4/58/383cd3a0.jpg","comment_is_top":false,"comment_ctime":1645511838,"is_pvip":false,"replies":[{"id":122580,"content":"æ®æˆ‘è¯´çŸ¥ä¸æ˜¯æ ‡æ–°ç«‹å¼‚ã€‚è¿™å’Œgoç¼–è¯‘å™¨è§£æ&lt;&gt;çš„äºŒä¹‰æ€§æœ‰å…³ã€‚goç¼–è¯‘å™¨åªæ‰«æä¸€éä»£ç ï¼Œæ— æ³•åœ¨ä¸Šä¸‹æ–‡ä¸­åˆ¤æ–­&lt;&gt;ç©¶ç«Ÿæ˜¯å•¥ï¼Œæ˜¯æ³›å‹å£°æ˜è¿˜æ˜¯å¤§å°äºå·ã€‚","user_name":"ä½œè€…å›å¤","user_name_real":"ç¼–è¾‘","uid":1026224,"ctime":1645594144,"ip_address":"","comment_id":335413,"utype":1}],"discussion_count":1,"race_medal":0,"score":2,"product_id":100093501,"comment_content":"æœ€ä¸å¯æ¥å—çš„æ˜¯ä½¿ç”¨[]ä½œä¸ºæ³›å‹ç±»å‹å£°æ˜,\n[] æœ¬èº«å·²ç»ä½œä¸ºslice,array,mapçš„ç´¢å¼•æ“ä½œç¬¦,è€Œä¸”å¤§å¤šæ•°äººéƒ½æœ‰åˆ«çš„è¯­è¨€å¼€å‘çš„ç»éªŒ,ä¸‹æ„è¯†ä¼šæŠŠ[]å½“ä½œä¸‹è¡¨è§£é‡Š. è¿™æ‰æ˜¯å¿ƒæ™ºè´Ÿæ‹…. è€Œä½¿ç”¨&lt;&gt;å°±æ²¡æœ‰è¿™ä¸ªé—®é¢˜.\næ ‡æ–°ç«‹å¼‚?","like_count":0,"discussions":[{"author":{"id":1026224,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/a8/b0/6f87ab08.jpg","nickname":"Tony Bai","note":"","ucode":"B6B08985F6FA89","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":552777,"discussion_content":"æ®æˆ‘è¯´çŸ¥ä¸æ˜¯æ ‡æ–°ç«‹å¼‚ã€‚è¿™å’Œgoç¼–è¯‘å™¨è§£æ&lt;&gt;çš„äºŒä¹‰æ€§æœ‰å…³ã€‚goç¼–è¯‘å™¨åªæ‰«æä¸€éä»£ç ï¼Œæ— æ³•åœ¨ä¸Šä¸‹æ–‡ä¸­åˆ¤æ–­&lt;&gt;ç©¶ç«Ÿæ˜¯å•¥ï¼Œæ˜¯æ³›å‹å£°æ˜è¿˜æ˜¯å¤§å°äºå·ã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1645594144,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":359778,"user_name":"pike","can_delete":false,"product_type":"c1","uid":2872523,"ip_address":"ä¸Šæµ·","ucode":"14C33D4DECE376","user_header":"https://static001.geekbang.org/account/avatar/00/2b/d4/cb/65cc1192.jpg","comment_is_top":false,"comment_ctime":1665871406,"is_pvip":false,"replies":null,"discussion_count":0,"race_medal":0,"score":2,"product_id":100093501,"comment_content":"å½“ä½ è¦ä¸ºä¸åŒçš„ç±»å‹å†™ç›¸åŒé€»è¾‘çš„ä»£ç ï¼Œæ³›","like_count":0},{"had_liked":false,"id":335415,"user_name":"æ´›ä¹¦","can_delete":false,"product_type":"c1","uid":2421848,"ip_address":"","ucode":"4F1C41E4679879","user_header":"https://static001.geekbang.org/account/avatar/00/24/f4/58/383cd3a0.jpg","comment_is_top":false,"comment_ctime":1645512169,"is_pvip":false,"replies":null,"discussion_count":0,"race_medal":0,"score":2,"product_id":100093501,"comment_content":"\ntype Vector[T any] []T\ntype Vector&lt;T any&gt; []T\n\ntype Vector[T any] [][]T\ntype Vector&lt;T any] [][]T\n\nå­°ä¼˜å­°åŠ£,ä¸éš¾çœ‹å‡º,ä¸æ˜ç™½ä¸ºä»€ä¹ˆå¤´é“çš„é‡‡ç”¨[]åŒ…è£¹æ³›å‹å£°æ˜, æ ‡æ–°ç«‹å¼‚?","like_count":0},{"had_liked":false,"id":333788,"user_name":"ç½—æ°","can_delete":false,"product_type":"c1","uid":1320487,"ip_address":"","ucode":"96BAFAA147341F","user_header":"https://static001.geekbang.org/account/avatar/00/14/26/27/eba94899.jpg","comment_is_top":false,"comment_ctime":1644536414,"is_pvip":false,"replies":null,"discussion_count":0,"race_medal":0,"score":2,"product_id":100093501,"comment_content":"çœ‹èµ·æ¥é™åˆ¶è¿˜æ˜¯éå¸¸å¤šï¼Œä¸è¿‡å¯¹æˆ‘è€Œè¨€ï¼Œæ³›å‹å‡ ä¹éƒ½æ²¡æœ‰ä½¿ç”¨åœºæ™¯ã€‚","like_count":0,"discussions":[{"author":{"id":1026224,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/a8/b0/6f87ab08.jpg","nickname":"Tony Bai","note":"","ucode":"B6B08985F6FA89","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":552777,"discussion_content":"æ®æˆ‘è¯´çŸ¥ä¸æ˜¯æ ‡æ–°ç«‹å¼‚ã€‚è¿™å’Œgoç¼–è¯‘å™¨è§£æ&lt;&gt;çš„äºŒä¹‰æ€§æœ‰å…³ã€‚goç¼–è¯‘å™¨åªæ‰«æä¸€éä»£ç ï¼Œæ— æ³•åœ¨ä¸Šä¸‹æ–‡ä¸­åˆ¤æ–­&lt;&gt;ç©¶ç«Ÿæ˜¯å•¥ï¼Œæ˜¯æ³›å‹å£°æ˜è¿˜æ˜¯å¤§å°äºå·ã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1645594144,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]}]}