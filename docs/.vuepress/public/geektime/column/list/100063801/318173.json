{"id":318173,"title":"11 | å®¹å™¨æ–‡ä»¶ç³»ç»Ÿï¼šæˆ‘åœ¨å®¹å™¨ä¸­è¯»å†™æ–‡ä»¶æ€ä¹ˆå˜æ…¢äº†ï¼Ÿ","content":"<p>ä½ å¥½ï¼Œæˆ‘æ˜¯ç¨‹è¿œã€‚ä»è¿™ä¸€è®²å¼€å§‹ï¼Œæˆ‘ä»¬è¿›å…¥å®¹å™¨å­˜å‚¨è¿™ä¸ªæ¨¡å—ã€‚</p><p>è¿™ä¸€æ¨¡å—æˆ‘ä»¬æ‰€è®²çš„å†…å®¹ï¼Œéƒ½å’Œå®¹å™¨é‡Œçš„æ–‡ä»¶è¯»å†™å¯†åˆ‡ç›¸å…³ã€‚å› ä¸ºæ‰€æœ‰çš„å®¹å™¨çš„è¿è¡Œéƒ½éœ€è¦ä¸€ä¸ªå®¹å™¨æ–‡ä»¶ç³»ç»Ÿï¼Œé‚£ä¹ˆæˆ‘ä»¬å°±ä»å®¹å™¨æ–‡ä»¶ç³»ç»Ÿå…ˆå¼€å§‹è®²èµ·ã€‚</p><p>é‚£æˆ‘ä»¬è¿˜æ˜¯å’Œä»¥å‰ä¸€æ ·ï¼Œå…ˆæ¥çœ‹çœ‹æˆ‘ä¹‹å‰ç¢°åˆ°äº†ä»€ä¹ˆé—®é¢˜ã€‚</p><p>è¿™ä¸ªé—®é¢˜å…·ä½“æ˜¯æˆ‘ä»¬åœ¨å®¿ä¸»æœºä¸Šï¼ŒæŠŠLinuxä»ubuntu18.04å‡çº§åˆ°ubuntu20.04ä¹‹åå‘ç°çš„ã€‚</p><p>åœ¨æˆ‘ä»¬åšäº†å®¿ä¸»æœºçš„å‡çº§åï¼Œå¯åŠ¨äº†ä¸€ä¸ªå®¹å™¨ï¼Œåœ¨å®¹å™¨é‡Œç”¨fioè¿™ä¸ªç£ç›˜æ€§èƒ½æµ‹è¯•å·¥å…·ï¼Œæƒ³çœ‹ä¸€ä¸‹å®¹å™¨é‡Œæ–‡ä»¶çš„è¯»å†™æ€§èƒ½ã€‚ç»“æœæˆ‘ä»¬å¾ˆæƒŠè®¶åœ°å‘ç°ï¼Œåœ¨ubuntu 20.04å®¿ä¸»æœºä¸Šçš„å®¹å™¨ä¸­æ–‡ä»¶è¯»å†™çš„æ€§èƒ½åªæœ‰ubuntu18.04å®¿ä¸»æœºä¸Šçš„1/8å·¦å³äº†ï¼Œé‚£è¿™æ˜¯æ€ä¹ˆå›äº‹å‘¢ï¼Ÿ</p><h2>é—®é¢˜å†ç°</h2><p>è¿™é‡Œæˆ‘æé†’ä¸€ä¸‹ä½ ï¼Œå› ä¸ºæ¶‰åŠåˆ°ä¸¤ä¸ªLinuxçš„è™šæ‹Ÿæœºï¼Œé—®é¢˜å†ç°è¿™é‡Œæˆ‘ä¸ºä½ åˆ—å‡ºäº†å…³é”®çš„ç»“æœè¾“å‡ºæˆªå›¾ï¼Œä¸æ–¹ä¾¿æ“ä½œçš„åŒå­¦å¯ä»¥é‡ç‚¹çœ‹å…¶ä¸­çš„æ€è·¯ã€‚</p><p>æˆ‘ä»¬å¯ä»¥å…ˆå¯åŠ¨ä¸€ä¸ªubuntu18.04çš„è™šæ‹Ÿæœºï¼Œå®ƒçš„Linuxå†…æ ¸ç‰ˆæœ¬æ˜¯4.15çš„ï¼Œç„¶ååœ¨è™šæ‹Ÿæœºä¸Šç”¨å‘½ä»¤ <code>docker run -it ubuntu:18.04 bash</code> å¯åŠ¨ä¸€ä¸ªå®¹å™¨ï¼Œæ¥ç€åœ¨å®¹å™¨é‡Œè¿è¡Œfioè¿™æ¡å‘½ä»¤ï¼Œçœ‹ä¸€ä¸‹åœ¨å®¹å™¨ä¸­è¯»å–æ–‡ä»¶çš„æ€§èƒ½ã€‚</p><pre><code># fio -direct=1 -iodepth=64 -rw=read -ioengine=libaio -bs=4k -size=10G -numjobs=1  -name=./fio.test\n</code></pre><!-- [[[read_end]]] --><p>è¿™é‡Œæˆ‘ç»™ä½ è§£é‡Šä¸€ä¸‹fioå‘½ä»¤ä¸­çš„å‡ ä¸ªä¸»è¦å‚æ•°ï¼š</p><p>ç¬¬ä¸€ä¸ªå‚æ•°æ˜¯\"-direct=1\"ï¼Œä»£è¡¨é‡‡ç”¨ébuffered I/Oæ–‡ä»¶è¯»å†™çš„æ–¹å¼ï¼Œé¿å…æ–‡ä»¶è¯»å†™è¿‡ç¨‹ä¸­å†…å­˜ç¼“å†²å¯¹æ€§èƒ½çš„å½±å“ã€‚</p><p>æ¥ç€æˆ‘ä»¬æ¥çœ‹è¿™\"-iodepth=64\"å’Œ\"-ioengine=libaio\"è¿™ä¸¤ä¸ªå‚æ•°ï¼Œè¿™é‡ŒæŒ‡æ–‡ä»¶è¯»å†™é‡‡ç”¨å¼‚æ­¥I/Oï¼ˆAsync I/Oï¼‰çš„æ–¹å¼ï¼Œä¹Ÿå°±æ˜¯è¿›ç¨‹å¯ä»¥å‘èµ·å¤šä¸ªI/Oè¯·æ±‚ï¼Œå¹¶ä¸”ä¸ç”¨é˜»å¡åœ°ç­‰å¾…I/Oçš„å®Œæˆã€‚ç¨åç­‰I/Oå®Œæˆä¹‹åï¼Œè¿›ç¨‹ä¼šæ”¶åˆ°é€šçŸ¥ã€‚</p><p>è¿™ç§å¼‚æ­¥I/Oå¾ˆé‡è¦ï¼Œå› ä¸ºå®ƒå¯ä»¥æå¤§åœ°æé«˜æ–‡ä»¶è¯»å†™çš„æ€§èƒ½ã€‚åœ¨è¿™é‡Œæˆ‘ä»¬è®¾ç½®äº†åŒæ—¶å‘å‡º64ä¸ªI/Oè¯·æ±‚ã€‚</p><p>ç„¶åæ˜¯\"-rw=readï¼Œ-bs=4kï¼Œ-size=10G\"ï¼Œè¿™å‡ ä¸ªå‚æ•°æŒ‡è¿™ä¸ªæµ‹è¯•æ˜¯ä¸ªè¯»æ–‡ä»¶æµ‹è¯•ï¼Œæ¯æ¬¡è¯»4KBå¤§å°æ•°å—ï¼Œæ€»å…±è¯»10GBçš„æ•°æ®ã€‚</p><p>æœ€åä¸€ä¸ªå‚æ•°æ˜¯\"-numjobs=1\"ï¼ŒæŒ‡åªæœ‰ä¸€ä¸ªè¿›ç¨‹/çº¿ç¨‹åœ¨è¿è¡Œã€‚</p><p>æ‰€ä»¥ï¼Œè¿™æ¡fioå‘½ä»¤è¡¨ç¤ºæˆ‘ä»¬é€šè¿‡å¼‚æ­¥æ–¹å¼è¯»å–äº†10GBçš„ç£ç›˜æ–‡ä»¶ï¼Œç”¨æ¥è®¡ç®—æ–‡ä»¶çš„è¯»å–æ€§èƒ½ã€‚</p><p>é‚£æˆ‘ä»¬çœ‹åˆ°åœ¨ubuntu 18.04ï¼Œå†…æ ¸4.15ä¸Šçš„å®¹å™¨I/Oæ€§èƒ½æ˜¯584MB/sçš„å¸¦å®½ï¼ŒIOPSï¼ˆI/O per secondï¼‰æ˜¯150Kå·¦å³ã€‚</p><p><img src=\"https://static001.geekbang.org/resource/image/5d/5e/5df788a1c7fb9f5677557d6cb15c995e.png?wh=1920*257\" alt=\"\"></p><p>åŒæ ·æˆ‘ä»¬å†å¯åŠ¨ä¸€ä¸ªubuntu 20.04ï¼Œå†…æ ¸5.4çš„è™šæ‹Ÿæœºï¼Œç„¶ååœ¨å®ƒçš„ä¸Šé¢ä¹Ÿå¯åŠ¨ä¸€ä¸ªå®¹å™¨ã€‚</p><p>æˆ‘ä»¬è¿è¡Œ <code>docker run -it ubuntu:20.04 bash</code> ï¼Œæ¥ç€åœ¨å®¹å™¨ä¸­ä½¿ç”¨åŒæ ·çš„fioå‘½ä»¤ï¼Œå¯ä»¥çœ‹åˆ°å®ƒçš„I/Oæ€§èƒ½æ˜¯70MBå¸¦å®½ï¼ŒIOPSæ˜¯18Kå·¦å³ã€‚å®è·µè¯æ˜ï¼Œè¿™çš„ç¡®æ¯”è€ç‰ˆæœ¬çš„ubuntu 18.04å·®äº†å¾ˆå¤šã€‚</p><p><img src=\"https://static001.geekbang.org/resource/image/90/f1/90aff20c885286d4b6b5aed7b017a9f1.png?wh=1920*256\" alt=\"\"></p><h2>çŸ¥è¯†è¯¦è§£</h2><h3>å¦‚ä½•ç†è§£å®¹å™¨æ–‡ä»¶ç³»ç»Ÿï¼Ÿ</h3><p>åˆšæ‰æˆ‘ä»¬å¯¹æ¯”äº†å‡çº§å‰åçš„å®¹å™¨è¯»å†™æ€§èƒ½å·®å¼‚ï¼Œé‚£æƒ³è¦åˆ†æåˆšåˆšè¯´çš„è¿™ä¸ªæ€§èƒ½çš„å·®å¼‚ï¼Œæˆ‘ä»¬éœ€è¦å…ˆç†è§£å®¹å™¨çš„æ–‡ä»¶ç³»ç»Ÿã€‚</p><p>æˆ‘ä»¬åœ¨å®¹å™¨é‡Œï¼Œè¿è¡Œ  <code>df</code> å‘½ä»¤ï¼Œä½ å¯ä»¥çœ‹åˆ°åœ¨å®¹å™¨ä¸­æ ¹ç›®å½•(/)çš„æ–‡ä»¶ç³»ç»Ÿç±»å‹æ˜¯\"overlay\"ï¼Œå®ƒä¸æ˜¯æˆ‘ä»¬åœ¨æ™®é€šLinuxèŠ‚ç‚¹ä¸Šçœ‹åˆ°çš„Ext4æˆ–è€…XFSä¹‹ç±»å¸¸è§çš„æ–‡ä»¶ç³»ç»Ÿã€‚</p><p>é‚£ä¹ˆçœ‹åˆ°è¿™é‡Œä½ è‚¯å®šæƒ³é—®ï¼ŒOverlayæ˜¯ä¸€ä¸ªä»€ä¹ˆæ ·çš„æ–‡ä»¶ç³»ç»Ÿå‘¢ï¼Œå®¹å™¨ä¸ºä»€ä¹ˆè¦ç”¨è¿™ç§æ–‡ä»¶ç³»ç»Ÿï¼Ÿåˆ«æ€¥ï¼Œæˆ‘ä¼šä¸€æ­¥ä¸€æ­¥å¸¦ä½ åˆ†æã€‚</p><p><img src=\"https://static001.geekbang.org/resource/image/2f/b0/2fed851ba2df3232efbdca1d1cce19b0.png?wh=1554*144\" alt=\"\"></p><p>åœ¨è¯´å®¹å™¨æ–‡ä»¶ç³»ç»Ÿå‰ï¼Œæˆ‘ä»¬å…ˆæ¥æƒ³è±¡ä¸€ä¸‹å¦‚æœæ²¡æœ‰æ–‡ä»¶ç³»ç»Ÿç®¡ç†çš„è¯ä¼šæ€æ ·ã€‚å‡è®¾æœ‰è¿™ä¹ˆä¸€ä¸ªåœºæ™¯ï¼Œåœ¨ä¸€ä¸ªå®¿ä¸»æœºä¸Šéœ€è¦è¿è¡Œ100ä¸ªå®¹å™¨ã€‚</p><p>åœ¨æˆ‘ä»¬è¿™ä¸ªè¯¾ç¨‹çš„<a href=\"https://time.geekbang.org/column/article/308108\">ç¬¬ä¸€è®²</a>é‡Œï¼Œæˆ‘ä»¬å°±è¯´è¿‡æ¯ä¸ªå®¹å™¨éƒ½éœ€è¦ä¸€ä¸ªé•œåƒï¼Œè¿™ä¸ªé•œåƒå°±æŠŠå®¹å™¨ä¸­ç¨‹åºéœ€è¦è¿è¡Œçš„äºŒè¿›åˆ¶æ–‡ä»¶ï¼Œåº“æ–‡ä»¶ï¼Œé…ç½®æ–‡ä»¶ï¼Œå…¶ä»–çš„ä¾èµ–æ–‡ä»¶ç­‰å…¨éƒ¨éƒ½æ‰“åŒ…æˆä¸€ä¸ªé•œåƒæ–‡ä»¶ã€‚</p><p>å¦‚æœæ²¡æœ‰ç‰¹åˆ«çš„å®¹å™¨æ–‡ä»¶ç³»ç»Ÿï¼Œåªæ˜¯æ™®é€šçš„Ext4æˆ–è€…XFSæ–‡ä»¶ç³»ç»Ÿï¼Œé‚£ä¹ˆæ¯æ¬¡å¯åŠ¨ä¸€ä¸ªå®¹å™¨ï¼Œå°±éœ€è¦æŠŠä¸€ä¸ªé•œåƒæ–‡ä»¶ä¸‹è½½å¹¶ä¸”å­˜å‚¨åœ¨å®¿ä¸»æœºä¸Šã€‚</p><p>æˆ‘ä¸¾ä¸ªä¾‹å­å¸®ä½ ç†è§£ï¼Œæ¯”å¦‚è¯´ï¼Œå‡è®¾ä¸€ä¸ªé•œåƒæ–‡ä»¶çš„å¤§å°æ˜¯500MBï¼Œé‚£ä¹ˆ100ä¸ªå®¹å™¨çš„è¯ï¼Œå°±éœ€è¦ä¸‹è½½500MB*100= 50GBçš„æ–‡ä»¶ï¼Œå¹¶ä¸”å ç”¨50GBçš„ç£ç›˜ç©ºé—´ã€‚</p><p>å¦‚æœä½ å†åˆ†æä¸€ä¸‹è¿™50GBé‡Œçš„å†…å®¹ï¼Œä½ ä¼šå‘ç°ï¼Œåœ¨ç»å¤§éƒ¨åˆ†çš„æ“ä½œç³»ç»Ÿé‡Œï¼Œåº“æ–‡ä»¶éƒ½æ˜¯å·®ä¸å¤šçš„ã€‚è€Œä¸”ï¼Œåœ¨å®¹å™¨è¿è¡Œçš„æ—¶å€™ï¼Œè¿™ç±»æ–‡ä»¶ä¹Ÿä¸ä¼šè¢«æ”¹åŠ¨ï¼ŒåŸºæœ¬ä¸Šéƒ½æ˜¯åªè¯»çš„ã€‚</p><p>ç‰¹åˆ«æ˜¯è¿™æ ·çš„æƒ…å†µï¼šå‡å¦‚è¿™100ä¸ªå®¹å™¨é•œåƒéƒ½æ˜¯åŸºäº\"ubuntu:18.04\"çš„ï¼Œæ¯ä¸ªå®¹å™¨é•œåƒåªæ˜¯é¢å¤–å¤åˆ¶äº†50MBå·¦å³è‡ªå·±çš„åº”ç”¨ç¨‹åºåˆ°\"ubuntu: 18.04\"é‡Œï¼Œé‚£ä¹ˆå°±æ˜¯è¯´åœ¨æ€»å…±50GBçš„æ•°æ®é‡Œï¼Œæœ‰90%çš„æ•°æ®æ˜¯å†—ä½™çš„ã€‚</p><p>è®²åˆ°è¿™é‡Œï¼Œä½ ä¸éš¾æ¨æµ‹å‡ºç†æƒ³çš„æƒ…å†µåº”è¯¥æ˜¯ä»€ä¹ˆæ ·çš„ï¼Ÿ</p><p>æ²¡é”™ï¼Œå½“ç„¶æ˜¯åœ¨ä¸€ä¸ªå®¿ä¸»æœºä¸Šåªè¦ä¸‹è½½å¹¶ä¸”å­˜å‚¨å­˜ä¸€ä»½\"ubuntu:18.04\"ï¼Œæ‰€æœ‰åŸºäº\"ubuntu:18.04\"é•œåƒçš„å®¹å™¨éƒ½å¯ä»¥å…±äº«è¿™ä¸€ä»½é€šç”¨çš„éƒ¨åˆ†ã€‚è¿™æ ·è®¾ç½®çš„è¯ï¼Œä¸åŒå®¹å™¨å¯åŠ¨çš„æ—¶å€™ï¼Œåªéœ€è¦ä¸‹è½½è‡ªå·±ç‹¬ç‰¹çš„ç¨‹åºéƒ¨åˆ†å°±å¯ä»¥ã€‚å°±åƒä¸‹é¢è¿™å¼ å›¾å±•ç¤ºçš„è¿™æ ·ã€‚</p><p><img src=\"https://static001.geekbang.org/resource/image/c0/3f/c0119d9d2af9cf7386db13467027003f.jpg?wh=1594*852\" alt=\"\"></p><p><strong>æ­£æ˜¯ä¸ºäº†æœ‰æ•ˆåœ°å‡å°‘ç£ç›˜ä¸Šå†—ä½™çš„é•œåƒæ•°æ®ï¼ŒåŒæ—¶å‡å°‘å†—ä½™çš„é•œåƒæ•°æ®åœ¨ç½‘ç»œä¸Šçš„ä¼ è¾“ï¼Œé€‰æ‹©ä¸€ç§é’ˆå¯¹äºå®¹å™¨çš„æ–‡ä»¶ç³»ç»Ÿæ˜¯å¾ˆæœ‰å¿…è¦çš„ï¼Œè€Œè¿™ç±»çš„æ–‡ä»¶ç³»ç»Ÿè¢«ç§°ä¸ºUnionFSã€‚</strong></p><p>UnionFSè¿™ç±»æ–‡ä»¶ç³»ç»Ÿå®ç°çš„ä¸»è¦åŠŸèƒ½æ˜¯æŠŠå¤šä¸ªç›®å½•ï¼ˆå¤„äºä¸åŒçš„åˆ†åŒºï¼‰ä¸€èµ·æŒ‚è½½ï¼ˆmountï¼‰åœ¨ä¸€ä¸ªç›®å½•ä¸‹ã€‚è¿™ç§å¤šç›®å½•æŒ‚è½½çš„æ–¹å¼ï¼Œæ­£å¥½å¯ä»¥è§£å†³æˆ‘ä»¬åˆšæ‰è¯´çš„å®¹å™¨é•œåƒçš„é—®é¢˜ã€‚</p><p>æ¯”å¦‚ï¼Œæˆ‘ä»¬å¯ä»¥æŠŠubuntu18.04è¿™ä¸ªåŸºç¡€é•œåƒçš„æ–‡ä»¶æ”¾åœ¨ä¸€ä¸ªç›®å½•ubuntu18.04/ä¸‹ï¼Œå®¹å™¨è‡ªå·±é¢å¤–çš„ç¨‹åºæ–‡ä»¶app_1_binæ”¾åœ¨app_1/ç›®å½•ä¸‹ã€‚</p><p>ç„¶åï¼Œæˆ‘ä»¬æŠŠè¿™ä¸¤ä¸ªç›®å½•æŒ‚è½½åˆ°container_1/è¿™ä¸ªç›®å½•ä¸‹ï¼Œä½œä¸ºå®¹å™¨1çœ‹åˆ°çš„æ–‡ä»¶ç³»ç»Ÿï¼›å¯¹äºå®¹å™¨2ï¼Œå°±å¯ä»¥æŠŠubuntu18.04/å’Œapp_2/ä¸¤ä¸ªç›®å½•ä¸€èµ·æŒ‚è½½åˆ°container_2çš„ç›®å½•ä¸‹ã€‚</p><p>è¿™æ ·åœ¨èŠ‚ç‚¹ä¸Šæˆ‘ä»¬åªè¦ä¿ç•™ä¸€ä»½ubuntu18.04çš„æ–‡ä»¶å°±å¯ä»¥äº†ã€‚</p><p><img src=\"https://static001.geekbang.org/resource/image/44/27/449669a1aaa8c631d7768369b275ed27.jpg?wh=1620*806\" alt=\"\"></p><h3>OverlayFS</h3><p>UnionFSç±»ä¼¼çš„æœ‰å¾ˆå¤šç§å®ç°ï¼ŒåŒ…æ‹¬åœ¨Dockeré‡Œæœ€æ—©ä½¿ç”¨çš„AUFSï¼Œè¿˜æœ‰ç›®å‰æˆ‘ä»¬ä½¿ç”¨çš„OverlayFSã€‚å‰é¢æˆ‘ä»¬åœ¨è¿è¡Œ<code>df</code>çš„æ—¶å€™ï¼Œçœ‹åˆ°çš„æ–‡ä»¶ç³»ç»Ÿç±»å‹\"overlay\"æŒ‡çš„å°±æ˜¯OverlayFSã€‚</p><p>åœ¨Linuxå†…æ ¸3.18ç‰ˆæœ¬ä¸­ï¼ŒOverlayFSä»£ç æ­£å¼åˆå…¥Linuxå†…æ ¸çš„ä¸»åˆ†æ”¯ã€‚åœ¨è¿™ä¹‹åï¼ŒOverlayFSä¹Ÿå°±é€æ¸æˆä¸ºå„ä¸ªä¸»æµLinuxå‘è¡Œç‰ˆæœ¬é‡Œç¼ºçœä½¿ç”¨çš„å®¹å™¨æ–‡ä»¶ç³»ç»Ÿäº†ã€‚</p><p>ç½‘ä¸ŠJulia Evansæœ‰ä¸ª<a href=\"https://jvns.ca/blog/2019/11/18/how-containers-work--overlayfs/\">blog</a>ï¼Œé‡Œé¢æœ‰ä¸ªçš„OverlayFSä½¿ç”¨çš„ä¾‹å­ï¼Œå¾ˆç®€å•ï¼Œæˆ‘ä»¬ä¹Ÿæ‹¿è¿™ä¸ªä¾‹å­æ¥ç†è§£ä¸€ä¸‹OverlayFSçš„ä¸€äº›åŸºæœ¬æ¦‚å¿µã€‚</p><p>ä½ å¯ä»¥å…ˆæ‰§è¡Œä¸€ä¸‹è¿™ä¸€ç»„å‘½ä»¤ã€‚</p><pre><code class=\"language-shell\">#!/bin/bash\n\numount ./merged\nrm upper lower merged work -r\n\nmkdir upper lower merged work\necho \"I'm from lower!\" &gt; lower/in_lower.txt\necho \"I'm from upper!\" &gt; upper/in_upper.txt\n# `in_both` is in both directories\necho \"I'm from lower!\" &gt; lower/in_both.txt\necho \"I'm from upper!\" &gt; upper/in_both.txt\n\nsudo mount -t overlay overlay \\\n -o lowerdir=./lower,upperdir=./upper,workdir=./work \\\n ./merged\n</code></pre><p>æˆ‘ä»¬å¯ä»¥çœ‹åˆ°ï¼ŒOverlayFSçš„ä¸€ä¸ªmountå‘½ä»¤ç‰µæ¶‰åˆ°å››ç±»ç›®å½•ï¼Œåˆ†åˆ«æ˜¯lowerï¼Œupperï¼Œmergedå’Œworkï¼Œé‚£å®ƒä»¬æ˜¯ä»€ä¹ˆå…³ç³»å‘¢ï¼Ÿ</p><p>æˆ‘ä»¬çœ‹ä¸‹é¢è¿™å¼ å›¾ï¼Œè¿™å’Œå‰é¢UnionFSçš„å·¥ä½œç¤ºæ„å›¾å¾ˆåƒï¼Œä¹Ÿä¸å¥‡æ€ªï¼ŒOverlayFSå°±æ˜¯UnionFSçš„ä¸€ç§å®ç°ã€‚æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬ä»ä¸‹å¾€ä¸Šä¾æ¬¡çœ‹çœ‹æ¯ä¸€å±‚çš„åŠŸèƒ½ã€‚</p><p>é¦–å…ˆï¼Œæœ€ä¸‹é¢çš„\"lower/\"ï¼Œä¹Ÿå°±æ˜¯è¢«mountä¸¤å±‚ç›®å½•ä¸­åº•ä¸‹çš„è¿™å±‚ï¼ˆlowerdirï¼‰ã€‚</p><p>åœ¨OverlayFSä¸­ï¼Œæœ€åº•ä¸‹è¿™ä¸€å±‚é‡Œçš„æ–‡ä»¶æ˜¯ä¸ä¼šè¢«ä¿®æ”¹çš„ï¼Œä½ å¯ä»¥è®¤ä¸ºå®ƒæ˜¯åªè¯»çš„ã€‚æˆ‘è¿˜æƒ³æé†’ä½ ä¸€ç‚¹ï¼Œåœ¨è¿™ä¸ªä¾‹å­é‡Œæˆ‘ä»¬åªæœ‰ä¸€ä¸ªlower/ç›®å½•ï¼Œä¸è¿‡OverlayFSæ˜¯æ”¯æŒå¤šä¸ªlowerdirçš„ã€‚</p><p>ç„¶åæˆ‘ä»¬çœ‹\"uppder/\"ï¼Œå®ƒæ˜¯è¢«mountä¸¤å±‚ç›®å½•ä¸­ä¸Šé¢çš„è¿™å±‚ ï¼ˆupperdirï¼‰ã€‚åœ¨OverlayFSä¸­ï¼Œå¦‚æœæœ‰æ–‡ä»¶çš„åˆ›å»ºï¼Œä¿®æ”¹ï¼Œåˆ é™¤æ“ä½œï¼Œé‚£ä¹ˆéƒ½ä¼šåœ¨è¿™ä¸€å±‚åæ˜ å‡ºæ¥ï¼Œå®ƒæ˜¯å¯è¯»å†™çš„ã€‚</p><p>æ¥ç€æ˜¯æœ€ä¸Šé¢çš„\"merged\"  ï¼Œå®ƒæ˜¯æŒ‚è½½ç‚¹ï¼ˆmount pointï¼‰ç›®å½•ï¼Œä¹Ÿæ˜¯ç”¨æˆ·çœ‹åˆ°çš„ç›®å½•ï¼Œç”¨æˆ·çš„å®é™…æ–‡ä»¶æ“ä½œåœ¨è¿™é‡Œè¿›è¡Œã€‚</p><p>å…¶å®è¿˜æœ‰ä¸€ä¸ª\"work/\"ï¼Œè¿™ä¸ªç›®å½•æ²¡æœ‰åœ¨è¿™ä¸ªå›¾é‡Œï¼Œå®ƒåªæ˜¯ä¸€ä¸ªå­˜æ”¾ä¸´æ—¶æ–‡ä»¶çš„ç›®å½•ï¼ŒOverlayFSä¸­å¦‚æœæœ‰æ–‡ä»¶ä¿®æ”¹ï¼Œå°±ä¼šåœ¨ä¸­é—´è¿‡ç¨‹ä¸­ä¸´æ—¶å­˜æ”¾æ–‡ä»¶åˆ°è¿™é‡Œã€‚</p><p><img src=\"https://static001.geekbang.org/resource/image/ca/5d/ca894a91e0171a027ba0ded6cdf2a95d.jpg?wh=1438*840\" alt=\"\"></p><p>ä»è¿™ä¸ªä¾‹å­æˆ‘ä»¬å¯ä»¥çœ‹åˆ°ï¼ŒOverlayFSä¼šmountä¸¤å±‚ç›®å½•ï¼Œåˆ†åˆ«æ˜¯lowerå±‚å’Œupperå±‚ï¼Œè¿™ä¸¤å±‚ç›®å½•ä¸­çš„æ–‡ä»¶éƒ½ä¼šæ˜ å°„åˆ°æŒ‚è½½ç‚¹ä¸Šã€‚</p><p>ä»æŒ‚è½½ç‚¹çš„è§†è§’çœ‹ï¼Œupperå±‚çš„æ–‡ä»¶ä¼šè¦†ç›–lowerå±‚çš„æ–‡ä»¶ï¼Œæ¯”å¦‚\"in_both.txt\"è¿™ä¸ªæ–‡ä»¶ï¼Œåœ¨lowerå±‚å’Œupperå±‚éƒ½æœ‰ï¼Œä½†æ˜¯æŒ‚è½½ç‚¹merged/é‡Œçœ‹åˆ°çš„åªæ˜¯upperå±‚é‡Œçš„in_both.txt.</p><p>å¦‚æœæˆ‘ä»¬åœ¨merged/ç›®å½•é‡Œåšæ–‡ä»¶æ“ä½œï¼Œå…·ä½“åŒ…æ‹¬è¿™ä¸‰ç§ã€‚</p><p>ç¬¬ä¸€ç§ï¼Œæ–°å»ºæ–‡ä»¶ï¼Œè¿™ä¸ªæ–‡ä»¶ä¼šå‡ºç°åœ¨upper/ ç›®å½•ä¸­ã€‚</p><p>ç¬¬äºŒç§æ˜¯åˆ é™¤æ–‡ä»¶ï¼Œå¦‚æœæˆ‘ä»¬åˆ é™¤\"in_upper.txt\"ï¼Œé‚£ä¹ˆè¿™ä¸ªæ–‡ä»¶ä¼šåœ¨upper/ç›®å½•ä¸­æ¶ˆå¤±ã€‚å¦‚æœåˆ é™¤\"in_lower.txt\", åœ¨ lower/ç›®å½•é‡Œçš„\"in_lower.txt\"æ–‡ä»¶ä¸ä¼šæœ‰å˜åŒ–ï¼Œåªæ˜¯åœ¨ upper/ç›®å½•ä¸­å¢åŠ äº†ä¸€ä¸ªç‰¹æ®Šæ–‡ä»¶æ¥å‘Šè¯‰OverlayFSï¼Œ\"in_lower.txt'è¿™ä¸ªæ–‡ä»¶ä¸èƒ½å‡ºç°åœ¨merged/é‡Œäº†ï¼Œè¿™å°±è¡¨ç¤ºå®ƒå·²ç»è¢«åˆ é™¤äº†ã€‚</p><p><img src=\"https://static001.geekbang.org/resource/image/f3/2a/f3813b984193e3aebebe1b5104f75e2a.png?wh=1026*470\" alt=\"\"></p><p>è¿˜æœ‰ä¸€ç§æ“ä½œæ˜¯ä¿®æ”¹æ–‡ä»¶ï¼Œç±»ä¼¼å¦‚æœä¿®æ”¹\"in_lower.txt\"ï¼Œé‚£ä¹ˆå°±ä¼šåœ¨upper/ç›®å½•ä¸­æ–°å»ºä¸€ä¸ª\"in_lower.txt\"æ–‡ä»¶ï¼ŒåŒ…å«æ›´æ–°çš„å†…å®¹ï¼Œè€Œåœ¨lower/ä¸­çš„åŸæ¥çš„å®é™…æ–‡ä»¶\"in_lower.txt\"ä¸ä¼šæ”¹å˜ã€‚</p><p>é€šè¿‡è¿™ä¸ªä¾‹å­ï¼Œæˆ‘ä»¬çŸ¥é“äº†OverlayFSæ˜¯æ€ä¹ˆå·¥ä½œäº†ã€‚é‚£ä¹ˆæˆ‘ä»¬å¯ä»¥å†æƒ³ä¸€æƒ³ï¼Œæ€ä¹ˆæŠŠå®ƒè¿ç”¨åˆ°å®¹å™¨çš„é•œåƒæ–‡ä»¶ä¸Šï¼Ÿ</p><p>å…¶å®ä¹Ÿä¸éš¾ï¼Œä»ç³»ç»Ÿçš„mountsä¿¡æ¯ä¸­ï¼Œæˆ‘ä»¬å¯ä»¥çœ‹åˆ°Dockeræ˜¯æ€ä¹ˆç”¨OverlayFSæ¥æŒ‚è½½é•œåƒæ–‡ä»¶çš„ã€‚å®¹å™¨é•œåƒæ–‡ä»¶å¯ä»¥åˆ†æˆå¤šä¸ªå±‚ï¼ˆlayerï¼‰ï¼Œæ¯å±‚å¯ä»¥å¯¹åº”OverlayFSé‡Œlowerdirçš„ä¸€ä¸ªç›®å½•ï¼Œlowerdiræ”¯æŒå¤šä¸ªç›®å½•ï¼Œä¹Ÿå°±å¯ä»¥æ”¯æŒå¤šå±‚çš„é•œåƒæ–‡ä»¶ã€‚</p><p>åœ¨å®¹å™¨å¯åŠ¨åï¼Œå¯¹é•œåƒæ–‡ä»¶ä¸­ä¿®æ”¹å°±ä¼šè¢«ä¿å­˜åœ¨upperdiré‡Œäº†ã€‚</p><p><img src=\"https://static001.geekbang.org/resource/image/55/26/55a7059809afdd3d51e5a6b3f5c83626.png?wh=1920*368\" alt=\"\"></p><h2>è§£å†³é—®é¢˜</h2><p>åœ¨ç†è§£äº†å®¹å™¨ä½¿ç”¨çš„OverlayFSæ–‡ä»¶ç³»ç»Ÿåï¼Œæˆ‘ä»¬å†å›åˆ°å¼€å§‹çš„é—®é¢˜ï¼Œä¸ºä»€ä¹ˆåœ¨å®¿ä¸»æœºå‡çº§ä¹‹åï¼Œåœ¨å®¹å™¨é‡Œè¯»å†™æ–‡ä»¶çš„æ€§èƒ½é™ä½äº†ï¼Ÿç°åœ¨æˆ‘ä»¬è‡³å°‘åº”è¯¥çŸ¥é“ï¼Œåœ¨å®¹å™¨ä¸­è¯»å†™æ–‡ä»¶æ€§èƒ½é™ä½äº†ï¼Œé‚£ä¹ˆåº”è¯¥æ˜¯OverlayFSçš„æ€§èƒ½åœ¨æ–°çš„ubuntu20.04ä¸­é™ä½äº†ã€‚</p><p>è¦æ‰¾åˆ°é—®é¢˜çš„æ ¹å› ï¼Œæˆ‘ä»¬è¿˜éœ€è¦è¿›ä¸€æ­¥çš„debugã€‚å¯¹äºæ€§èƒ½é—®é¢˜ï¼Œæˆ‘ä»¬éœ€è¦ä½¿ç”¨Linuxä¸‹çš„perfå·¥å…·æ¥æŸ¥çœ‹ä¸€ä¸‹ï¼Œå…·ä½“æ€ä¹ˆä½¿ç”¨perfæ¥è§£å†³é—®é¢˜ï¼Œæˆ‘ä»¬ä¼šåœ¨åé¢è®²è§£ã€‚</p><p>è¿™é‡Œä½ åªè¦çœ‹ä¸€ä¸‹ç»“æœå°±å¯ä»¥äº†ï¼Œè‡ªä¸‹è€Œä¸Šæ˜¯å‡½æ•°çš„ä¸€ä¸ªè°ƒç”¨é¡ºåºã€‚é€šè¿‡perfå·¥å…·ï¼Œæˆ‘ä»¬å¯ä»¥æ¯”è¾ƒåœ¨å®¹å™¨ä¸­è¿è¡Œfioçš„æ—¶å€™ï¼Œubuntu 18.04å’Œubuntu 20.04åœ¨å†…æ ¸å‡½æ•°è°ƒç”¨ä¸Šçš„ä¸åŒã€‚</p><p><img src=\"https://static001.geekbang.org/resource/image/6d/7a/6d970f9cf76bd0875ff3e505900b1b7a.png?wh=698*540\" alt=\"\" title=\"ubuntu 18.04 (Linuxå†…æ ¸4.15)ç¯å¢ƒä¸‹ä½¿ç”¨perfè¾“å‡ºçš„å‡½æ•°è°ƒç”¨ç»“æœ\"></p><p><img src=\"https://static001.geekbang.org/resource/image/46/1f/466cd0da98f4170111c5ce2436f2ed1f.png?wh=1920*437\" alt=\"\" title=\"ubuntu 20.04 (Linuxå†…æ ¸ 5.4)ç¯å¢ƒä¸‹ä½¿ç”¨perfè¾“å‡ºçš„å‡½æ•°è°ƒç”¨ç»“æœ\"></p><p>æˆ‘ä»¬ä»ç³»ç»Ÿè°ƒç”¨æ¡†æ¶ä¹‹åçš„å‡½æ•°aio_read()å¼€å§‹æ¯”è¾ƒï¼šLinuxå†…æ ¸4.15é‡Œaio_read()ä¹‹åè°ƒç”¨çš„æ˜¯xfs_file_read_iter()ï¼Œè€Œåœ¨Linux å†…æ ¸5.4é‡Œï¼Œaio_read()ä¹‹åè°ƒç”¨çš„æ˜¯ovl_read_iter()è¿™ä¸ªå‡½æ•°ï¼Œä¹‹åå†è°ƒç”¨xfs_file_read_iter()ã€‚</p><p>è¿™æ ·æˆ‘ä»¬å°±å¯ä»¥å»æŸ¥çœ‹ä¸€ä¸‹ï¼Œåœ¨å†…æ ¸4.15ä¹‹åæ–°åŠ å…¥çš„è¿™ä¸ªå‡½æ•°ovl_read_iter()çš„ä»£ç ã€‚</p><p>æŸ¥çœ‹<a href=\"https://lwn.net/Articles/755889/\">ä»£ç </a>åæˆ‘ä»¬å°±èƒ½æ˜ç™½ï¼ŒLinuxä¸ºäº†å®Œå–„OverlayFSï¼Œå¢åŠ äº†OverlayFSè‡ªå·±çš„read/writeå‡½æ•°æ¥å£ï¼Œä»è€Œä¸å†ç›´æ¥è°ƒç”¨OverlayFSåç«¯æ–‡ä»¶ç³»ç»Ÿï¼ˆæ¯”å¦‚XFSï¼ŒExt4ï¼‰çš„è¯»å†™æ¥å£ã€‚ä½†æ˜¯å®ƒåªå®ç°äº†åŒæ­¥I/Oï¼ˆsync I/Oï¼‰ï¼Œå¹¶æ²¡æœ‰å®ç°å¼‚æ­¥I/Oã€‚</p><p>è€Œåœ¨fioåšæ–‡ä»¶ç³»ç»Ÿæ€§èƒ½æµ‹è¯•çš„æ—¶å€™ä½¿ç”¨çš„æ˜¯å¼‚æ­¥I/Oï¼Œè¿™æ ·æ‰å¯ä»¥å¾—åˆ°æ–‡ä»¶ç³»ç»Ÿçš„æ€§èƒ½æœ€å¤§å€¼ã€‚æ‰€ä»¥ï¼Œåœ¨å†…æ ¸5.4ä¸Šå°±æ— æ³•å¯¹OverlayFSæµ‹å‡ºæœ€é«˜çš„æ€§èƒ½æŒ‡æ ‡äº†ã€‚</p><p>åœ¨Linuxå†…æ ¸5.6ç‰ˆæœ¬ä¸­ï¼Œè¿™ä¸ªé—®é¢˜å·²ç»é€šè¿‡ä¸‹é¢çš„è¿™ä¸ªè¡¥ä¸ç»™è§£å†³äº†ï¼Œæœ‰å…´è¶£çš„åŒå­¦å¯ä»¥çœ‹ä¸€ä¸‹ã€‚</p><pre><code class=\"language-shell\">commit 2406a307ac7ddfd7effeeaff6947149ec6a95b4e\nAuthor: Jiufei Xue &lt;jiufei.xue@linux.alibaba.com&gt;\nDate:   Wed Nov 20 17:45:26 2019 +0800\n \n    ovl: implement async IO routines\n \n    A performance regression was observed since linux v4.19 with aio test using\n    fio with iodepth 128 on overlayfs.  The queue depth of the device was\n    always 1 which is unexpected.\n \n    After investigation, it was found that commit 16914e6fc7e1 (\"ovl: add\n    ovl_read_iter()\") and commit 2a92e07edc5e (\"ovl: add ovl_write_iter()\")\n    resulted in vfs_iter_{read,write} being called on underlying filesystem,\n    which always results in syncronous IO.\n \n    Implement async IO for stacked reading and writing.  This resolves the\n    performance regresion.\n \n    This is implemented by allocating a new kiocb for submitting the AIO\n    request on the underlying filesystem.  When the request is completed, the\n    new kiocb is freed and the completion callback is called on the original\n    iocb.\n \n    Signed-off-by: Jiufei Xue &lt;jiufei.xue@linux.alibaba.com&gt;\n    Signed-off-by: Miklos Szeredi &lt;mszeredi@redhat.com&gt;\n</code></pre><h2>é‡ç‚¹æ€»ç»“</h2><p>è¿™ä¸€è®²ï¼Œæˆ‘ä»¬æœ€ä¸»è¦çš„å†…å®¹æ˜¯ç†è§£å®¹å™¨æ–‡ä»¶ç³»ç»Ÿã€‚ä¸ºä»€ä¹ˆè¦æœ‰å®¹å™¨è‡ªå·±çš„æ–‡ä»¶ç³»ç»Ÿï¼Ÿå¾ˆé‡è¦çš„ä¸€ç‚¹æ˜¯<strong>å‡å°‘ç›¸åŒé•œåƒæ–‡ä»¶åœ¨åŒä¸€ä¸ªèŠ‚ç‚¹ä¸Šçš„æ•°æ®å†—ä½™ï¼Œå¯ä»¥èŠ‚çœç£ç›˜ç©ºé—´ï¼Œä¹Ÿå¯ä»¥å‡å°‘é•œåƒæ–‡ä»¶ä¸‹è½½å ç”¨çš„ç½‘ç»œèµ„æºã€‚</strong></p><p>ä½œä¸ºå®¹å™¨æ–‡ä»¶ç³»ç»Ÿï¼ŒUnionFSé€šè¿‡å¤šä¸ªç›®å½•æŒ‚è½½çš„æ–¹å¼å·¥ä½œã€‚OverlayFSå°±æ˜¯UnionFSçš„ä¸€ç§å®ç°ï¼Œæ˜¯ç›®å‰ä¸»æµLinuxå‘è¡Œç‰ˆæœ¬ä¸­ç¼ºçœä½¿ç”¨çš„å®¹å™¨æ–‡ä»¶ç³»ç»Ÿã€‚</p><p>OverlayFSä¹Ÿæ˜¯æŠŠå¤šä¸ªç›®å½•åˆå¹¶æŒ‚è½½ï¼Œè¢«æŒ‚è½½çš„ç›®å½•åˆ†ä¸ºä¸¤å¤§ç±»ï¼šlowerdirå’Œupperdirã€‚</p><p>lowerdirå…è®¸æœ‰å¤šä¸ªç›®å½•ï¼Œåœ¨è¢«æŒ‚è½½åï¼Œè¿™äº›ç›®å½•é‡Œçš„æ–‡ä»¶éƒ½æ˜¯ä¸ä¼šè¢«ä¿®æ”¹æˆ–è€…åˆ é™¤çš„ï¼Œä¹Ÿå°±æ˜¯åªè¯»çš„ï¼›upperdiråªæœ‰ä¸€ä¸ªï¼Œä¸è¿‡è¿™ä¸ªç›®å½•æ˜¯å¯è¯»å†™çš„ï¼ŒæŒ‚è½½ç‚¹ç›®å½•ä¸­çš„æ‰€æœ‰æ–‡ä»¶ä¿®æ”¹éƒ½ä¼šåœ¨upperdirä¸­åæ˜ å‡ºæ¥ã€‚</p><p>å®¹å™¨çš„é•œåƒæ–‡ä»¶ä¸­å„å±‚æ­£å¥½ä½œä¸ºOverlayFSçš„lowerdirçš„ç›®å½•ï¼Œç„¶ååŠ ä¸Šä¸€ä¸ªç©ºçš„upperdirä¸€èµ·æŒ‚è½½å¥½åï¼Œå°±ç»„æˆäº†å®¹å™¨çš„æ–‡ä»¶ç³»ç»Ÿã€‚</p><p>OverlayFSåœ¨Linuxå†…æ ¸ä¸­è¿˜åœ¨ä¸æ–­çš„å®Œå–„ï¼Œæ¯”å¦‚æˆ‘ä»¬åœ¨è¿™ä¸€è®²çœ‹åˆ°çš„åœ¨kenel 5.4ä¸­å¯¹å¼‚æ­¥I/Oæ“ä½œçš„ç¼ºå¤±ï¼Œè¿™ä¹Ÿæ˜¯æˆ‘ä»¬åœ¨ä½¿ç”¨å®¹å™¨æ–‡ä»¶ç³»ç»Ÿçš„æ—¶å€™éœ€è¦æ³¨æ„çš„ã€‚</p><h2>æ€è€ƒé¢˜</h2><p>åœ¨è¿™ä¸€è®²OverlayFSçš„<a href=\"https://github.com/chengyli/training/blob/main/filesystem/overlayfs/test_overlayfs.sh\">ä¾‹å­</a>çš„åŸºç¡€ä¸Šï¼Œå»ºç«‹2ä¸ªlowerdirçš„ç›®å½•ï¼Œå¹¶ä¸”åœ¨ç›®å½•ä¸­å»ºç«‹ç›¸åŒæ–‡ä»¶åçš„æ–‡ä»¶ï¼Œç„¶åä¸€èµ·åšä¸€ä¸ªoverlay mountï¼Œçœ‹çœ‹ä¼šå‘ç”Ÿä»€ä¹ˆï¼Ÿ</p><p>æ¬¢è¿åœ¨ç•™è¨€åŒºå’Œæˆ‘åˆ†äº«ä½ çš„æ€è€ƒå’Œç–‘é—®ã€‚å¦‚æœè¿™ç¯‡æ–‡ç« è®©ä½ æœ‰æ‰€æ”¶è·ï¼Œä¹Ÿæ¬¢è¿åˆ†äº«ç»™ä½ çš„åŒäº‹ã€æœ‹å‹ï¼Œä¸€èµ·å­¦ä¹ æ¢è®¨ã€‚</p>","neighbors":{"left":{"article_title":"10 | Swapï¼šå®¹å™¨å¯ä»¥ä½¿ç”¨Swapç©ºé—´å—ï¼Ÿ","id":317216},"right":{"article_title":"12 | å®¹å™¨æ–‡ä»¶Quotaï¼šå®¹å™¨ä¸ºä»€ä¹ˆæŠŠå®¿ä¸»æœºçš„ç£ç›˜å†™æ»¡äº†ï¼Ÿ","id":318978}},"comments":[{"had_liked":false,"id":266760,"user_name":"è°¢å“ˆå“ˆ","can_delete":false,"product_type":"c1","uid":2326880,"ip_address":"","ucode":"5AADE70B5AFE27","user_header":"https://static001.geekbang.org/account/avatar/00/23/81/60/71ed6ac7.jpg","comment_is_top":false,"comment_ctime":1607480889,"is_pvip":false,"replies":[{"id":"96950","content":"èµï¼","user_name":"ä½œè€…å›å¤","user_name_real":"CY","uid":"2070138","ctime":1607613510,"ip_address":"","comment_id":266760,"utype":1}],"discussion_count":2,"race_medal":0,"score":"53147088441","product_id":100063801,"comment_content":"ç»è¿‡å®éªŒç¡®è®¤ï¼Œåªä¼šåœ¨mergeå³è”åˆæŒ‚è½½ç‚¹é‡Œç”Ÿæˆä¸€ä¸ªæ–‡ä»¶åï¼Œä¹Ÿå°±æ˜¯è¯´overlayæ–‡ä»¶ç³»ç»Ÿä¸ºäº†çœå­˜å‚¨ç©ºé—´æ˜¯åšäº†åŒåæ–‡ä»¶åˆå¹¶ä¼˜åŒ–çš„","like_count":13,"discussions":[{"author":{"id":2070138,"avatar":"https://static001.geekbang.org/account/avatar/00/1f/96/7a/8a14d008.jpg","nickname":"CY","note":"","ucode":"4AF98230985918","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":511377,"discussion_content":"èµï¼","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1607613510,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":2028953,"avatar":"","nickname":"Geek3340","note":"","ucode":"C64D302CD53513","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":333565,"discussion_content":"ä¸ªäººç†è§£ï¼Œåº”è¯¥ä¸æ˜¯åšäº†åŒåæ–‡ä»¶çš„ä¼˜åŒ–å§ï¼Œæ—¢ç„¶æ˜¯å †å ï¼Œè‚¯å®šæ˜¯æœ‰å…ˆåé¡ºåºçš„ï¼ŒåŒæ˜¯lowerdirï¼Œä¸Šé¢çš„é‚£ä¸€å±‚ä¸­çš„æ–‡ä»¶ä¼šè¦†ç›–ä¸‹å±‚çš„åŒåæ–‡ä»¶","likes_number":4,"is_delete":false,"is_hidden":false,"ctime":1607564319,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":266991,"user_name":"Geek3340","can_delete":false,"product_type":"c1","uid":2028953,"ip_address":"","ucode":"C64D302CD53513","user_header":"","comment_is_top":false,"comment_ctime":1607564631,"is_pvip":false,"replies":[{"id":"96949","content":"aufsçš„ä»£ç ä»æ¥å°±æ²¡æœ‰è¿›å…¥Linuxå†…æ ¸çš„ä¸»å¹²ã€‚","user_name":"ä½œè€…å›å¤","user_name_real":"CY","uid":"2070138","ctime":1607613462,"ip_address":"","comment_id":266991,"utype":1}],"discussion_count":1,"race_medal":0,"score":"35967302999","product_id":100063801,"comment_content":"è€å¸ˆæåˆ°çš„aufsï¼Œæ˜¯å®Œå…¨è¢«åºŸå¼ƒå—ï¼Ÿaufsçš„åºŸå¼ƒæ˜¯æŒ‡åœ¨å†…æ ¸å±‚çš„åºŸå¼ƒå—ï¼Ÿä¹‹å‰å®‰è£…dockeræ—¶ï¼Œæ—¶å¯ä»¥é…ç½®ä½¿ç”¨aufs è¿˜æ˜¯overlay2ï¼Œä¹Ÿå°±æ˜¯è¯´å†…æ ¸å±‚è¿˜æœªå®Œå…¨å»é™¤å¯¹aufsçš„æ”¯æŒå—ï¼Ÿ","like_count":8,"discussions":[{"author":{"id":2070138,"avatar":"https://static001.geekbang.org/account/avatar/00/1f/96/7a/8a14d008.jpg","nickname":"CY","note":"","ucode":"4AF98230985918","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":511472,"discussion_content":"aufsçš„ä»£ç ä»æ¥å°±æ²¡æœ‰è¿›å…¥Linuxå†…æ ¸çš„ä¸»å¹²ã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1607613462,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":267010,"user_name":"ä¸Šé‚ªå¿˜å·","can_delete":false,"product_type":"c1","uid":1276588,"ip_address":"","ucode":"1C4459917B038D","user_header":"http://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTIz9dKN1C8rKQoaVtmEGdzObhlia6zAfTsPYOm4ibz39VjTbu7Aia1LyeedHR26b6nxUtcCufpichcYgw/132","comment_is_top":false,"comment_ctime":1607568605,"is_pvip":false,"replies":[{"id":"96952","content":"@ä¸Šé‚ªå¿˜å·<br>å¾ˆå¥½çš„æµ‹è¯•æ­¥éª¤ã€‚æˆ‘å†é—®ä¸€ä¸ªé—®é¢˜ï¼Œâ€œmerged&#47;in_lower.txt â€é‡Œçš„å€¼æœ‰å¯èƒ½æ˜¯&quot;I&#39;m from lower2!&quot;å—ï¼Ÿ","user_name":"ä½œè€…å›å¤","user_name_real":"CY","uid":"2070138","ctime":1607613697,"ip_address":"","comment_id":267010,"utype":1}],"discussion_count":5,"race_medal":0,"score":"14492470493","product_id":100063801,"comment_content":"å®éªŒè¿‡ç¨‹å¦‚ä¸‹ï¼Œç»“æœæ˜¯lower1ç›®å½•ä¸­çš„æ–‡ä»¶è¦†ç›–äº†lower2ä¸­åŒåçš„æ–‡ä»¶ã€‚<br>[root@localhost ~]# cat overlay.sh <br>#!&#47;bin&#47;bash<br><br>umount .&#47;merged<br>rm upper lower1 lower2 merged work -r<br><br>mkdir upper lower1 lower2 merged work<br>echo &quot;I&#39;m from lower1!&quot; &gt; lower1&#47;in_lower.txt<br>echo &quot;I&#39;m from lower2!&quot; &gt; lower2&#47;in_lower.txt<br>echo &quot;I&#39;m from upper!&quot; &gt; upper&#47;in_upper.txt<br># `in_both` is in both directories<br>echo &quot;I&#39;m from lower1!&quot; &gt; lower1&#47;in_both.txt<br>echo &quot;I&#39;m from lower2!&quot; &gt; lower2&#47;in_both.txt<br>echo &quot;I&#39;m from upper!&quot; &gt; upper&#47;in_both.txt<br><br>sudo mount -t overlay overlay \\<br> -o lowerdir=.&#47;lower1:.&#47;lower2,upperdir=.&#47;upper,workdir=.&#47;work \\<br> .&#47;merged<br>[root@localhost ~]# sh overlay.sh <br>[root@localhost ~]# cat merged&#47;in_lower.txt <br>I&#39;m from lower1!<br>","like_count":3,"discussions":[{"author":{"id":2070138,"avatar":"https://static001.geekbang.org/account/avatar/00/1f/96/7a/8a14d008.jpg","nickname":"CY","note":"","ucode":"4AF98230985918","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":511484,"discussion_content":"@ä¸Šé‚ªå¿˜å·\nå¾ˆå¥½çš„æµ‹è¯•æ­¥éª¤ã€‚æˆ‘å†é—®ä¸€ä¸ªé—®é¢˜ï¼Œâ€œmerged/in_lower.txt â€é‡Œçš„å€¼æœ‰å¯èƒ½æ˜¯&amp;quot;I&amp;#39;m from lower2!&amp;quot;å—ï¼Ÿ","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1607613697,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1276588,"avatar":"http://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTIz9dKN1C8rKQoaVtmEGdzObhlia6zAfTsPYOm4ibz39VjTbu7Aia1LyeedHR26b6nxUtcCufpichcYgw/132","nickname":"ä¸Šé‚ªå¿˜å·","note":"","ucode":"1C4459917B038D","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":334015,"discussion_content":"æ‰§è¡Œå¦‚ä¸‹å‘½ä»¤å³å¯ï¼Œåº”è¯¥æ˜¯ä¼˜å…ˆçº§é—®é¢˜ï¼Œç¬¬ä¸€ä¸ªæŒ‚è½½çš„ç›®å½•ä¼˜å…ˆçº§æ¯”è¾ƒé«˜\nsudo mount -t overlay overlay \\\n -o lowerdir=./lower2:./lower1,upperdir=./upper,workdir=./work \\\n ./merged","likes_number":4,"is_delete":false,"is_hidden":false,"ctime":1607693729,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1227784,"avatar":"https://static001.geekbang.org/account/avatar/00/12/bc/08/c43f85d9.jpg","nickname":"IOVE.-Minn","note":"","ucode":"9C637EEEF64057","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":392858,"discussion_content":"è¯·é—®ä¸‹è€å¸ˆï¼Œå¤šä¸ªlowerç›¸åŒåç§°çš„æ–‡ä»¶ï¼Œä½†æ˜¯å†…å®¹ä¸ä¸€æ ·ï¼Œå®ƒåœ¨mergedé‡Œé¢æ˜¯æ˜¯æ€ä¹ˆé€‰å–çš„å‘¢ï¼Ÿ","likes_number":1,"is_delete":false,"is_hidden":false,"ctime":1631156146,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1311299,"avatar":"https://static001.geekbang.org/account/avatar/00/14/02/43/1c2fb7b3.jpg","nickname":"Bourne","note":"","ucode":"1286279F70B13F","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":387126,"discussion_content":"å¦‚æœlowerdiræ”¹æˆ./lower2:./lower1ï¼Œmergedé‡Œçš„in_lower.txtå°±æ˜¯./lower2é‡Œæ–‡ä»¶çš„å†…å®¹ï¼Œçœ‹æ¥è·Ÿlowerdirçš„æŒ‚åœ¨é¡ºåºæœ‰å…³","likes_number":1,"is_delete":false,"is_hidden":false,"ctime":1627998746,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":2314854,"avatar":"https://static001.geekbang.org/account/avatar/00/23/52/66/3e4d4846.jpg","nickname":"includestdio.h","note":"","ucode":"5027BACE9319CD","race_medal":1,"user_type":1,"is_pvip":true},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":575188,"discussion_content":"[root@VM-0-7-centos overlay_test]# sudo mount -t overlay overlay  -o lowerdir=./lower2:./lower1,upperdir=./upper,workdir=./work  ./merged\n\n[root@VM-0-7-centos overlay_test]# cd merged/\n\n[root@VM-0-7-centos merged]# cat in_lower.txt \nI&#39;m from lower2","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1654657953,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":266834,"user_name":"æµæµªåœ°çƒ","can_delete":false,"product_type":"c1","uid":1498137,"ip_address":"","ucode":"25210DCD353F97","user_header":"https://static001.geekbang.org/account/avatar/00/16/dc/19/c058bcbf.jpg","comment_is_top":false,"comment_ctime":1607501064,"is_pvip":false,"replies":[{"id":"96954","content":"@æµæµªåœ°çƒ<br>å®¹å™¨é•œåƒä¸­åªæœ‰rootfsæ²¡æœ‰Linuxå†…æ ¸æ˜¯å¯¹çš„ã€‚<br><br>åœ¨æ–‡ç« é‡Œï¼Œå®¿ä¸»æœºå†…æ ¸å‡çº§åï¼Œæ— è®ºå®¹å™¨çš„é•œåƒæ˜¯å¦å‡çº§ï¼Œéƒ½ä¼šæœ‰è¿™ä¸ªé—®é¢˜ã€‚æ–‡ä¸­çš„é—®é¢˜æ˜¯overlayfså¼•èµ·çš„ï¼Œå’Œé•œåƒä¸­çš„æ–‡ä»¶æ²¡æœ‰å…³ç³»ã€‚","user_name":"ä½œè€…å›å¤","user_name_real":"CY","uid":"2070138","ctime":1607614852,"ip_address":"","comment_id":266834,"utype":1}],"discussion_count":3,"race_medal":0,"score":"14492402952","product_id":100063801,"comment_content":"å’Œè€å¸ˆæ¢è®¨ä¸€ä¸ªé—®é¢˜ï¼Œæœ¬æ–‡ä¸­æè¿°çš„ç°è±¡ï¼Œä¸€ä¸ªé‡è¦çš„åŸå› æ˜¯å®¹å™¨é•œåƒé‡Œåªæœ‰rootfsï¼Œæ²¡æœ‰linuxå†…æ ¸ï¼Œå®¿ä¸»æœºä¸Šçš„æ‰€æœ‰å®¹å™¨æ˜¯å…±ç”¨å®¿ä¸»æœºå†…æ ¸çš„ã€‚æ‰€ä»¥ï¼Œå½“å®¿ä¸»æœºå†…æ ¸ç‰ˆæœ¬å‡çº§åï¼Œå®¹å™¨é•œåƒå¹¶æ²¡æœ‰ç›¸åº”çš„å‡çº§ï¼Œä¹Ÿä¼šäº§ç”Ÿè¿™ä¸ªé—®é¢˜ï¼Œæ–‡ä¸­å¹¶æ²¡æœ‰å¯¹è¿™ä¸ªçŸ¥è¯†è¦ç‚¹è¯´æ˜ã€‚ä¸çŸ¥é“æˆ‘çš„ç†è§£æ˜¯å¦æ­£ç¡®","like_count":3,"discussions":[{"author":{"id":2070138,"avatar":"https://static001.geekbang.org/account/avatar/00/1f/96/7a/8a14d008.jpg","nickname":"CY","note":"","ucode":"4AF98230985918","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":511405,"discussion_content":"@æµæµªåœ°çƒ\nå®¹å™¨é•œåƒä¸­åªæœ‰rootfsæ²¡æœ‰Linuxå†…æ ¸æ˜¯å¯¹çš„ã€‚\n\nåœ¨æ–‡ç« é‡Œï¼Œå®¿ä¸»æœºå†…æ ¸å‡çº§åï¼Œæ— è®ºå®¹å™¨çš„é•œåƒæ˜¯å¦å‡çº§ï¼Œéƒ½ä¼šæœ‰è¿™ä¸ªé—®é¢˜ã€‚æ–‡ä¸­çš„é—®é¢˜æ˜¯overlayfså¼•èµ·çš„ï¼Œå’Œé•œåƒä¸­çš„æ–‡ä»¶æ²¡æœ‰å…³ç³»ã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1607614852,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1048555,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/ff/eb/c3880313.jpg","nickname":"ç“¶è£…ç«ç®­","note":"","ucode":"F0B7C3F1CA2042","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":341601,"discussion_content":"æ²¡æœ‰linuxå†…æ ¸è¿™å¥è¯çš„æ„æ€ä½ æ²¡æœ‰å®Œå…¨ç†è§£ï¼Œæƒ³ä¸€æƒ³namespaceéš”ç¦»äº†å“ªäº›ä¸œè¥¿ã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1610460102,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":2028953,"avatar":"","nickname":"Geek3340","note":"","ucode":"C64D302CD53513","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":333566,"discussion_content":"å¥½é—®é¢˜ï¼Œåº”è¯¥æ˜¯è¿™ä¸ªæ€è·¯ï¼Œå¸Œæœ›è€å¸ˆèƒ½è®²è§£ä¸‹ï¼Œä¹Ÿæ˜¯æˆ‘æƒ³äº†è§£çš„ã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1607564385,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":268440,"user_name":"å§œå§œ","can_delete":false,"product_type":"c1","uid":1120332,"ip_address":"","ucode":"1DAD620C8E9F31","user_header":"https://static001.geekbang.org/account/avatar/00/11/18/4c/e12f3b41.jpg","comment_is_top":false,"comment_ctime":1608196408,"is_pvip":false,"replies":[{"id":"97456","content":"@å§œå§œ<br>å¯ä»¥ç”¨æ–‡æ¡£ä¸­çš„è„šæœ¬ç¨å¾®ä¿®æ”¹ä¸€ä¸‹ï¼Œå°±å¯ä»¥éªŒè¯äº†","user_name":"ä½œè€…å›å¤","user_name_real":"CY","uid":"2070138","ctime":1608215499,"ip_address":"","comment_id":268440,"utype":1}],"discussion_count":1,"race_medal":0,"score":"10198131000","product_id":100063801,"comment_content":"æ€è€ƒé¢˜ï¼š<br>æˆ‘è®¤ä¸ºåœ¨å¤šä¸ªlowerä¹‹é—´å‡ºç°åŒåæ–‡ä»¶ï¼Œåœ¨mergeä¸­ä¹Ÿæ˜¯ä¸Šå±‚lowerè¦†ç›–ä¸‹å±‚lowerã€‚<br><br>ä¸ªäººç†è§£:<br>â€œmergeå±‚â€ç›¸å½“äºæä¾›ç»™ç”¨æˆ·è¿›è¡Œäº¤äº’çš„è§†å›¾å±‚; <br>â€œupperå±‚â€ç›¸å½“äºå­˜å‚¨å®é™…å‘ç”Ÿå˜åŠ¨çš„åœ°æ–¹; <br>â€œlowerå±‚â€æ˜¯ä¸å˜çš„ï¼Œç”¨æˆ·é€šè¿‡mergeå±‚è§†å›¾å¯¹lowerå±‚æ–‡ä»¶çš„æ‰€æœ‰æ“ä½œï¼Œéƒ½è¢«é‡å®šå‘åˆ°â€œupperå±‚â€äº†ï¼Œç‰¹æ®Šçš„æ˜¯åˆ é™¤æ“ä½œï¼Œä¼šåœ¨upperå±‚ç”Ÿæˆä¸€ä¸ªç‰¹æ®Šçš„cç±»å‹çš„æ–‡ä»¶æ¥ä»£è¡¨è¯¥æ–‡ä»¶è¢«åˆ ã€‚<br>ç”¨æˆ·äº¤äº’æ—¶åªèƒ½å¯¹mergeå±‚çš„è§†å›¾æ¥æ“ä½œã€‚<br>åœ¨mergeå±‚çš„è§†å›¾ä¸­ï¼Œä¸Šå±‚è¦†ç›–ä¸‹å±‚åŒåæ–‡ä»¶ï¼Œä¸Šä¸‹å…³ç³»ä¸åªæ˜¯upperå’Œlowerä¹‹é—´ï¼Œå³ä¾¿åœ¨å¤šä¸ªlowerå±‚ä¸­ï¼Œä¹Ÿæ˜¯ä¸Šå±‚è¦†ç›–ä¸‹å±‚ã€‚<br><br>ä»¥ä¸Šè§‚ç‚¹çº¯å±æˆ‘çš„çŒœæµ‹ï¼Œå› ä¸ºè¿˜æ²¡æ¥å¾—åŠéªŒè¯ï¼Œå¦‚æœæœ‰è¯¯è¯·å¸®å¿™æŒ‡å‡º","like_count":2,"discussions":[{"author":{"id":2070138,"avatar":"https://static001.geekbang.org/account/avatar/00/1f/96/7a/8a14d008.jpg","nickname":"CY","note":"","ucode":"4AF98230985918","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":511945,"discussion_content":"@å§œå§œ\nå¯ä»¥ç”¨æ–‡æ¡£ä¸­çš„è„šæœ¬ç¨å¾®ä¿®æ”¹ä¸€ä¸‹ï¼Œå°±å¯ä»¥éªŒè¯äº†","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1608215499,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":268240,"user_name":"æ°´è’¸è›‹","can_delete":false,"product_type":"c1","uid":1809160,"ip_address":"","ucode":"6F7F853A4BF901","user_header":"https://static001.geekbang.org/account/avatar/00/1b/9b/08/27ac7ecd.jpg","comment_is_top":false,"comment_ctime":1608110680,"is_pvip":false,"replies":[{"id":"97459","content":"@æ°´è’¸è›‹<br>å®¹å™¨å’Œå®¿ä¸»æœºæ˜¯å…±äº«å†…æ ¸çš„ã€‚ä¸é€šçš„Linuxç‰ˆæœ¬å†…æ ¸ä¸ä¸€æ ·ã€‚","user_name":"ä½œè€…å›å¤","user_name_real":"CY","uid":"2070138","ctime":1608216249,"ip_address":"","comment_id":268240,"utype":1}],"discussion_count":1,"race_medal":0,"score":"10198045272","product_id":100063801,"comment_content":"è€å¸ˆï¼Œæˆ‘æ²¡æƒ³é€šå®¹å™¨æ—¢ç„¶æœ‰å†…æ ¸æ–‡ä»¶ä¸ºä»€ä¹ˆä¼šä¾èµ–å®¿ä¸»æœºçš„å†…æ ¸ï¼Œå¦‚æœä¾èµ–å®¿ä¸»æœºå†…æ ¸é‚£è¿˜è¦å®¹å™¨çš„å†…æ ¸å¹²ä»€ä¹ˆå‘¢ï¼Œè¿™ä¹ˆå¤šä¸åŒçš„linuxç‰ˆæœ¬éš¾é“å†…æ ¸ç‰ˆæœ¬éƒ½æ˜¯ä¸€æ ·çš„ï¼Ÿ","like_count":2,"discussions":[{"author":{"id":2070138,"avatar":"https://static001.geekbang.org/account/avatar/00/1f/96/7a/8a14d008.jpg","nickname":"CY","note":"","ucode":"4AF98230985918","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":511884,"discussion_content":"@æ°´è’¸è›‹\nå®¹å™¨å’Œå®¿ä¸»æœºæ˜¯å…±äº«å†…æ ¸çš„ã€‚ä¸é€šçš„Linuxç‰ˆæœ¬å†…æ ¸ä¸ä¸€æ ·ã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1608216249,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":267556,"user_name":"Alery","can_delete":false,"product_type":"c1","uid":1156557,"ip_address":"","ucode":"08F3F49181E67B","user_header":"https://static001.geekbang.org/account/avatar/00/11/a5/cd/3aff5d57.jpg","comment_is_top":false,"comment_ctime":1607828055,"is_pvip":false,"replies":[{"id":"97320","content":"å¦‚æœä»¥volumeçš„æ–¹å¼æŒ‚è½½åˆ°å®¹å™¨ä¸­ï¼Œé‚£ä¹ˆå®ƒå°±ä¸æ˜¯ä»¥overlayfsçš„æ–‡ä»¶ç³»ç»Ÿã€‚<br>æ€§èƒ½æ˜¯å¦å½±å“è¦çœ‹volumeç›®å½•çš„ä½ç½®åœ¨å“ªä¸ªç‰©ç†ç£ç›˜ä¸Šï¼Œå’Œå®ƒå…±äº«ç‰©ç†ç£ç›˜çš„æœ‰å“ªäº›è¯»å†™è¿›ç¨‹ã€‚","user_name":"ä½œè€…å›å¤","user_name_real":"CY","uid":"2070138","ctime":1608041510,"ip_address":"","comment_id":267556,"utype":1}],"discussion_count":1,"race_medal":0,"score":"10197762647","product_id":100063801,"comment_content":"è€å¸ˆï¼Œå‡å¦‚æˆ‘å°†ä¸€ä¸ªå·(å®¿ä¸»æœºä¸Šçš„æŸä¸ªç›®å½•)æŒ‚åœ¨åˆ°å®¹å™¨æ–‡ä»¶ç³»ç»Ÿä¸­çš„æŸä¸ªç›®å½•ï¼Œæˆ‘åœ¨å®¹å™¨ä¸­å¯¹è¿™ä¸ªå·ä¸­çš„æ•°æ®åšè¯»å†™æ“ä½œï¼Œå› ä¸ºè¿™ä¸ªæŒ‚è½½è·¯å¾„ä¹Ÿæ˜¯å®¹å™¨æ–‡ä»¶ç³»ç»Ÿçš„ä¸€éƒ¨åˆ†ï¼Œæ€§èƒ½æ˜¯ä¸æ˜¯ä¹Ÿæ˜¯ä¼šæœ‰å½±å“çš„ï¼Ÿ","like_count":2,"discussions":[{"author":{"id":2070138,"avatar":"https://static001.geekbang.org/account/avatar/00/1f/96/7a/8a14d008.jpg","nickname":"CY","note":"","ucode":"4AF98230985918","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":511678,"discussion_content":"å¦‚æœä»¥volumeçš„æ–¹å¼æŒ‚è½½åˆ°å®¹å™¨ä¸­ï¼Œé‚£ä¹ˆå®ƒå°±ä¸æ˜¯ä»¥overlayfsçš„æ–‡ä»¶ç³»ç»Ÿã€‚\næ€§èƒ½æ˜¯å¦å½±å“è¦çœ‹volumeç›®å½•çš„ä½ç½®åœ¨å“ªä¸ªç‰©ç†ç£ç›˜ä¸Šï¼Œå’Œå®ƒå…±äº«ç‰©ç†ç£ç›˜çš„æœ‰å“ªäº›è¯»å†™è¿›ç¨‹ã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1608041510,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":267008,"user_name":"ç¾ç¾","can_delete":false,"product_type":"c1","uid":1148422,"ip_address":"","ucode":"44CC95C45AF345","user_header":"https://static001.geekbang.org/account/avatar/00/11/86/06/72b01bb7.jpg","comment_is_top":false,"comment_ctime":1607568481,"is_pvip":false,"replies":[{"id":"96948","content":"å®¹å™¨äº‘å¹³å°é‡Œï¼Œk8sè‚¯å®šæ˜¯ä¸»æµï¼Œç”¨äº†k8s, åŸºæœ¬å°±ä¸éœ€è¦è¦dockeräº†ï¼Œå¯åŠ¨å®¹å™¨çš„ç¨‹åºè‚¯å®šæ˜¯è¶Šç®€å•è¶Šå¥½ã€‚<br>æˆ‘ä»¬åœ¨2019å¹´åˆå°±ä¸ç”¨dockeräº†ã€‚","user_name":"ä½œè€…å›å¤","user_name_real":"CY","uid":"2070138","ctime":1607613386,"ip_address":"","comment_id":267008,"utype":1}],"discussion_count":2,"race_medal":0,"score":"10197503073","product_id":100063801,"comment_content":"æƒ³å’Œè€å¸ˆæ¢è®¨ä¸€ä¸ªéæŠ€æœ¯é—®é¢˜ï¼Œè€å¸ˆå¯¹å½“å‰k8så’Œdockerçš„ç›¸çˆ±ç›¸æ€æœ‰ä»€ä¹ˆçœ‹æ³•ï¼Ÿè€å¸ˆè§‰å¾—æœªæ¥dockerå¸‚åœºä¼šè¢«podmanå–ä»£å—ï¼Ÿå¦‚æœä¼šçš„è¯ï¼Œè¿™ä¸ªè¿‡ç¨‹å¤§æ¦‚è¦å¤šä¹…","like_count":2,"discussions":[{"author":{"id":2070138,"avatar":"https://static001.geekbang.org/account/avatar/00/1f/96/7a/8a14d008.jpg","nickname":"CY","note":"","ucode":"4AF98230985918","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":511482,"discussion_content":"å®¹å™¨äº‘å¹³å°é‡Œï¼Œk8sè‚¯å®šæ˜¯ä¸»æµï¼Œç”¨äº†k8s, åŸºæœ¬å°±ä¸éœ€è¦è¦dockeräº†ï¼Œå¯åŠ¨å®¹å™¨çš„ç¨‹åºè‚¯å®šæ˜¯è¶Šç®€å•è¶Šå¥½ã€‚\næˆ‘ä»¬åœ¨2019å¹´åˆå°±ä¸ç”¨dockeräº†ã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1607613386,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1747388,"avatar":"https://static001.geekbang.org/account/avatar/00/1a/a9/bc/d3e25886.jpg","nickname":"GCC?","note":"","ucode":"D6EF58F8D595FB","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":334553,"discussion_content":"k8s1.20ç‰ˆæœ¬å·²ç»ä½“ç°å‡ºæ¥äº†","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1607878457,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":271983,"user_name":"æ¨è‰é”‹","can_delete":false,"product_type":"c1","uid":2360336,"ip_address":"","ucode":"F7BCA581CE64B8","user_header":"","comment_is_top":false,"comment_ctime":1609901467,"is_pvip":false,"replies":[{"id":"98648","content":"tmpfsåªæ˜¯ç”¨æ¥å­˜æ”¾ä¸€äº›ä¸´æ—¶æ–‡ä»¶çš„å†…å­˜æ–‡ä»¶ç³»ç»Ÿï¼Œæ¯”å¦‚&#47;tmpç›®å½•å¯ä»¥ä½¿ç”¨tmpfsã€‚<br>","user_name":"ä½œè€…å›å¤","user_name_real":"CY","uid":"2070138","ctime":1609941947,"ip_address":"","comment_id":271983,"utype":1}],"discussion_count":1,"race_medal":0,"score":"5904868763","product_id":100063801,"comment_content":"centos 7.3 å®¹å™¨èŠ‚ç‚¹tmpfsæ–‡ä»¶ç±»å‹ä¸ Overlayfsæ–‡ä»¶ç±»å‹çš„åŒºåˆ«","like_count":1,"discussions":[{"author":{"id":2070138,"avatar":"https://static001.geekbang.org/account/avatar/00/1f/96/7a/8a14d008.jpg","nickname":"CY","note":"","ucode":"4AF98230985918","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":513109,"discussion_content":"tmpfsåªæ˜¯ç”¨æ¥å­˜æ”¾ä¸€äº›ä¸´æ—¶æ–‡ä»¶çš„å†…å­˜æ–‡ä»¶ç³»ç»Ÿï¼Œæ¯”å¦‚/tmpç›®å½•å¯ä»¥ä½¿ç”¨tmpfsã€‚\n","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1609941947,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":269962,"user_name":"Geek_c2089d","can_delete":false,"product_type":"c1","uid":1489545,"ip_address":"","ucode":"C66D345042525F","user_header":"http://thirdwx.qlogo.cn/mmopen/vi_32/4Lprf2mIWpJOPibgibbFCicMtp5bpIibyLFOnyOhnBGbusrLZC0frG0FGWqdcdCkcKunKxqiaOHvXbCFE7zKJ8TmvIA/132","comment_is_top":false,"comment_ctime":1608863702,"is_pvip":false,"replies":[{"id":"98022","content":"å®¹å™¨ä¸åƒè™šæ‹Ÿæœºï¼Œä¸èƒ½åŠ¨æ€çš„æŒ‚è½½volume.","user_name":"ä½œè€…å›å¤","user_name_real":"CY","uid":"2070138","ctime":1609082569,"ip_address":"","comment_id":269962,"utype":1}],"discussion_count":3,"race_medal":0,"score":"5903830998","product_id":100063801,"comment_content":"è€å¸ˆï¼Œæˆ‘æƒ³è¯·æ•™ä¸€ä¸ªé—®é¢˜ï¼Œå°±æ˜¯å·²ç»åˆ›å»ºçš„å®¹å™¨ï¼Œæ€ä¹ˆèƒ½æ–°å¢ä¸€ä¸ªæŒ‚è½½ç›®å½•ï¼","like_count":1,"discussions":[{"author":{"id":2070138,"avatar":"https://static001.geekbang.org/account/avatar/00/1f/96/7a/8a14d008.jpg","nickname":"CY","note":"","ucode":"4AF98230985918","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":512465,"discussion_content":"å®¹å™¨ä¸åƒè™šæ‹Ÿæœºï¼Œä¸èƒ½åŠ¨æ€çš„æŒ‚è½½volume.","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1609082569,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1218501,"avatar":"https://static001.geekbang.org/account/avatar/00/12/97/c5/84491beb.jpg","nickname":"ç½—å³°","note":"","ucode":"5F3D6AF8F28322","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":393036,"discussion_content":"è€å¸ˆï¼Œå¥½åƒå¯ä»¥çš„å•Šï¼Œæˆ‘å¯åŠ¨ä¸€ä¸ªå®¹å™¨ï¼Œç„¶åmount nfsï¼Œè®°å¾—ç”Ÿæ•ˆçš„ã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1631235030,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":2058258,"avatar":"https://static001.geekbang.org/account/avatar/00/1f/68/12/031a05c3.jpg","nickname":"Aå…å¸…å«å“¥","note":"","ucode":"76D2522E602AEF","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":392868,"discussion_content":"ä¸èƒ½åŠ¨æ€æŒ‚è½½volumeï¼Œkubevirté‡Œé¢çƒ­åŠ ç›˜çš„é€»è¾‘å°±å¾ˆå¥‡æ€ªï¼Œåˆ©ç”¨äº†empty-diråšçƒ­é”®ç›˜æ“ä½œã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1631159024,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":266745,"user_name":"closer","can_delete":false,"product_type":"c1","uid":1368990,"ip_address":"","ucode":"69F38480DF8491","user_header":"https://static001.geekbang.org/account/avatar/00/14/e3/9e/b26da70d.jpg","comment_is_top":false,"comment_ctime":1607477714,"is_pvip":false,"replies":[{"id":"96955","content":"@closer<br>æˆ‘æ²¡æœ‰ç†è§£ä½ çš„æµ‹è¯•ç¯å¢ƒæ¯”è¾ƒï¼Œ<br>æˆ‘çš„ç†è§£æ˜¯openstackä¸Šåº”è¯¥æ˜¯è¿è¡Œkvmçš„VMçš„ï¼Œè¿™ä¸ªå’Œä½ è¯´çš„&quot;åœ¨ä¼ ç»Ÿkvmæ¶æ„ä¸Šé¢&quot;ï¼Œ æ˜¯ä»€ä¹ˆå·®åˆ«ï¼Ÿ","user_name":"ä½œè€…å›å¤","user_name_real":"CY","uid":"2070138","ctime":1607615012,"ip_address":"","comment_id":266745,"utype":1}],"discussion_count":1,"race_medal":0,"score":"5902445010","product_id":100063801,"comment_content":"è¯·æ•™è€å¸ˆä¸€ä¸ªå…³äºå®¹å™¨çœŸå®çš„ç”Ÿäº§é—®é¢˜ï¼Œæˆ‘ä»¬åœ¨fioåœ¨openstackåšæ€§èƒ½æµ‹è¯•ioengine labiao å’Œ<br>psync çš„IOPS å·®è·å·¨å¤§ã€‚ä½†æ˜¯åœ¨ä¼ ç»Ÿkvmæ¶æ„ä¸Šé¢labiao psyncçš„IOPSå·®ä¸å¤šã€‚å¯¼è‡´åœ¨openstackä¸Šé¢çš„å®¹å™¨ç£ç›˜è¯»å†™éƒ½å¾ˆæ…¢ã€‚è¿™ä¸ªç¡®å®æ˜¯openstackçš„é—®é¢˜å¼•èµ·çš„å—ï¼Ÿåº•å±‚ç¡¬ä»¶é…ç½®éƒ½ç›¸åŒçš„æ¡ä»¶ä¸‹","like_count":1,"discussions":[{"author":{"id":2070138,"avatar":"https://static001.geekbang.org/account/avatar/00/1f/96/7a/8a14d008.jpg","nickname":"CY","note":"","ucode":"4AF98230985918","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":511372,"discussion_content":"@closer\næˆ‘æ²¡æœ‰ç†è§£ä½ çš„æµ‹è¯•ç¯å¢ƒæ¯”è¾ƒï¼Œ\næˆ‘çš„ç†è§£æ˜¯openstackä¸Šåº”è¯¥æ˜¯è¿è¡Œkvmçš„VMçš„ï¼Œè¿™ä¸ªå’Œä½ è¯´çš„&amp;quot;åœ¨ä¼ ç»Ÿkvmæ¶æ„ä¸Šé¢&amp;quot;ï¼Œ æ˜¯ä»€ä¹ˆå·®åˆ«ï¼Ÿ","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1607615012,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":356340,"user_name":"JianXu","can_delete":false,"product_type":"c1","uid":1033219,"ip_address":"ä¸Šæµ·","ucode":"2A61BDBB573BDC","user_header":"https://static001.geekbang.org/account/avatar/00/0f/c4/03/f753fda7.jpg","comment_is_top":false,"comment_ctime":1662177805,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1662177805","product_id":100063801,"comment_content":"çœ‹åˆ°è¿™ç¯‡æ–‡ç« å°±ä¼šè®©æˆ‘æƒ³èµ· OS image çš„ CICD.  ","like_count":0},{"had_liked":false,"id":354940,"user_name":"äº‹å·²è‡³æ­¤å¼€å§‹æ’¤é€€","can_delete":false,"product_type":"c1","uid":2901316,"ip_address":"å¹¿ä¸œ","ucode":"1076FDF53DA81D","user_header":"https://static001.geekbang.org/account/avatar/00/2c/45/44/8df79d3c.jpg","comment_is_top":false,"comment_ctime":1660896704,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1660896704","product_id":100063801,"comment_content":"è¿™è®²è®²çš„è¿˜å¯ä»¥","like_count":0},{"had_liked":false,"id":335353,"user_name":"shk1230","can_delete":false,"product_type":"c1","uid":1701572,"ip_address":"","ucode":"9E39279C23FF8F","user_header":"https://static001.geekbang.org/account/avatar/00/19/f6/c4/e14686d4.jpg","comment_is_top":false,"comment_ctime":1645465624,"is_pvip":true,"discussion_count":0,"race_medal":0,"score":"1645465624","product_id":100063801,"comment_content":"æ€è€ƒé¢˜ï¼šå¦‚æœæ–‡ä»¶åç›¸åŒï¼Œæ–‡ä»¶å†…å®¹ä¸åŒä¹Ÿæ˜¯ä¸€æ ·å—","like_count":0},{"had_liked":false,"id":308719,"user_name":"tianfeiyu","can_delete":false,"product_type":"c1","uid":1157786,"ip_address":"","ucode":"E65E6841AD5D7F","user_header":"https://static001.geekbang.org/account/avatar/00/11/aa/9a/92d2df36.jpg","comment_is_top":false,"comment_ctime":1629770784,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1629770784","product_id":100063801,"comment_content":"è€å¸ˆï¼Œä½ ä¸Šé¢è¯´çš„ï¼š<br>â€œLinux ä¸ºäº†å®Œå–„ OverlayFSï¼Œå¢åŠ äº† OverlayFS è‡ªå·±çš„ read&#47;write å‡½æ•°æ¥å£ï¼Œä»è€Œä¸å†ç›´æ¥è°ƒç”¨ OverlayFS åç«¯æ–‡ä»¶ç³»ç»Ÿï¼ˆæ¯”å¦‚ XFSï¼ŒExt4ï¼‰çš„è¯»å†™æ¥å£â€<br>OverlayFS è‡ªå·±çš„ read&#47;write å‡½æ•°æ¥å£å’Œç›´æ¥è°ƒç”¨åç«¯æ–‡ä»¶ç³»ç»Ÿçš„å…·ä½“æœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿæˆ‘ç†è§£OverlayFSæœ¬æ¥å°±æ˜¯å­˜åœ¨äºåç«¯æ–‡ä»¶ç³»ç»Ÿä¸Šï¼ŒOverlayFSè‡ªå·±çš„ read&#47;writeå‡½æ•°æ¥å£æœ€ç»ˆè¿˜æ˜¯è¦è°ƒç”¨åç«¯æ–‡ä»¶ç³»ç»Ÿçš„read&#47;writeå‡½æ•°æ¥å£ã€‚","like_count":0},{"had_liked":false,"id":305422,"user_name":"ğŸ­","can_delete":false,"product_type":"c1","uid":2384580,"ip_address":"","ucode":"E5CA01ACAEDFC1","user_header":"https://static001.geekbang.org/account/avatar/00/24/62/c4/be92518b.jpg","comment_is_top":false,"comment_ctime":1627966752,"is_pvip":false,"replies":[{"id":"110970","content":"æ˜¯overlayfsçš„","user_name":"ä½œè€…å›å¤","user_name_real":"CY","uid":"2070138","ctime":1628600449,"ip_address":"","comment_id":305422,"utype":1}],"discussion_count":2,"race_medal":0,"score":"1627966752","product_id":100063801,"comment_content":"è€å¸ˆï¼Œåœ¨å®¹å™¨é‡Œä¿®æ”¹æ•°æ®ï¼Œæ•°æ®ä¼šå­˜åœ¨upper dirï¼Œé‡å¯å®¹å™¨ï¼Œæ”¹ç›®å½•ä¸‹æ•°æ®æ²¡æœ‰äº†ï¼Œè¿™ä¸ªåŠ¨ä½œæ˜¯dockerå®ç°çš„è¿˜æ˜¯overlayfsè‡ªèº«çš„åŠŸèƒ½","like_count":0,"discussions":[{"author":{"id":2070138,"avatar":"https://static001.geekbang.org/account/avatar/00/1f/96/7a/8a14d008.jpg","nickname":"CY","note":"","ucode":"4AF98230985918","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":524382,"discussion_content":"æ˜¯overlayfsçš„","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1628600449,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":2608728,"avatar":"https://static001.geekbang.org/account/avatar/00/27/ce/58/71ed845f.jpg","nickname":"Dexter","note":"","ucode":"909CABC4AC4AC9","race_medal":0,"user_type":1,"is_pvip":true},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":407817,"discussion_content":"è¿½é—®ä¸€ä¸‹ï¼Œä¸ºä»€ä¹ˆè¿™ä¸ªæ–‡ä»¶ä¼šæ²¡æœ‰äº†ï¼Ÿ","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1635125776,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":286691,"user_name":"Unknown","can_delete":false,"product_type":"c1","uid":1254489,"ip_address":"","ucode":"5FBF3D1044CA20","user_header":"https://static001.geekbang.org/account/avatar/00/13/24/59/e9867100.jpg","comment_is_top":false,"comment_ctime":1617502382,"is_pvip":true,"replies":[{"id":"104446","content":"ubuntu 20.04 æŒºå¥½ã€‚","user_name":"ä½œè€…å›å¤","user_name_real":"CY","uid":"2070138","ctime":1618058511,"ip_address":"","comment_id":286691,"utype":1}],"discussion_count":2,"race_medal":0,"score":"1617502382","product_id":100063801,"comment_content":"é‚£æ˜¯å¦å®¹å™¨ä¸å»ºè®®ç”¨ubuntu 20.04 lts?","like_count":0,"discussions":[{"author":{"id":2070138,"avatar":"https://static001.geekbang.org/account/avatar/00/1f/96/7a/8a14d008.jpg","nickname":"CY","note":"","ucode":"4AF98230985918","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":518064,"discussion_content":"ubuntu 20.04 æŒºå¥½ã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1618058511,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1254489,"avatar":"https://static001.geekbang.org/account/avatar/00/13/24/59/e9867100.jpg","nickname":"Unknown","note":"","ucode":"5FBF3D1044CA20","race_medal":0,"user_type":1,"is_pvip":true},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":364570,"discussion_content":"è¯·é—®ä½œè€…æœ€ç»ˆæ˜¯æ€ä¹ˆè§£å†³è¿™ä¸ªé—®é¢˜ï¼Ÿå‡çº§5.6å†…æ ¸ï¼Ÿ","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1617523685,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":267449,"user_name":"Helios","can_delete":false,"product_type":"c1","uid":1380758,"ip_address":"","ucode":"BE6B98EE8F0D09","user_header":"http://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTKJrOl63enWXCRxN0SoucliclBme0qrRb19ATrWIOIvibKIz8UAuVgicBMibIVUznerHnjotI4dm6ibODA/132","comment_is_top":false,"comment_ctime":1607749757,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1607749757","product_id":100063801,"comment_content":"ç›¸åŒæ–‡ä»¶ååªä¼šä¿ç•™ä¸€ä¸ªï¼Œæ–‡ä»¶å†…å®¹ä¸åŒåº”è¯¥æ˜¯æŒ‰ç…§é¡ºåºäº†å§","like_count":0},{"had_liked":false,"id":266723,"user_name":"è‰¯å‡¯å°”","can_delete":false,"product_type":"c1","uid":1806492,"ip_address":"","ucode":"8204DA338BA8F4","user_header":"https://static001.geekbang.org/account/avatar/00/1b/90/9c/288e4db2.jpg","comment_is_top":false,"comment_ctime":1607472235,"is_pvip":true,"replies":[{"id":"96951","content":"@è‰¯å‡¯å°”<br>å¯ä»¥åŠ¨æ‰‹è¯•è¯•ã€‚","user_name":"ä½œè€…å›å¤","user_name_real":"CY","uid":"2070138","ctime":1607613565,"ip_address":"","comment_id":266723,"utype":1}],"discussion_count":2,"race_medal":0,"score":"1607472235","product_id":100063801,"comment_content":"æ€è€ƒé¢˜ï¼šåœ¨è¿™ä¸€è®² OverlayFS çš„ä¾‹å­çš„åŸºç¡€ä¸Šï¼Œå»ºç«‹ 2 ä¸ª lowerdir çš„ç›®å½•ï¼Œå¹¶ä¸”åœ¨ç›®å½•ä¸­å»ºç«‹ç›¸åŒæ–‡ä»¶åçš„æ–‡ä»¶ï¼Œç„¶åä¸€èµ·åšä¸€ä¸ª overlay mountï¼Œçœ‹çœ‹ä¼šå‘ç”Ÿä»€ä¹ˆï¼Ÿ<br><br>åšäº† overlay mountä¹‹åï¼Œåªèƒ½çœ‹åˆ°ä¸Šé¢é‚£ä¸€å±‚lowerdirç›®å½•ä¸­çš„åŒåæ–‡ä»¶ï¼Œæ˜¯è¿™æ ·å—","like_count":0,"discussions":[{"author":{"id":2070138,"avatar":"https://static001.geekbang.org/account/avatar/00/1f/96/7a/8a14d008.jpg","nickname":"CY","note":"","ucode":"4AF98230985918","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":511362,"discussion_content":"@è‰¯å‡¯å°”\nå¯ä»¥åŠ¨æ‰‹è¯•è¯•ã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1607613565,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":2029081,"avatar":"","nickname":"Geek_db0249","note":"","ucode":"F7E89B8CF1387E","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":335719,"discussion_content":"overlay2ä¼šæŠ¥\ndocker: Error response from daemon: Duplicate mount point: /test.\nSee &#39;docker run --help&#39;.\n","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1608283476,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]}]}