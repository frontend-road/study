{"id":127774,"title":"76 | 本地测试Kubernetes环境搭建","content":"<ul>\n<li>\n<p>代码：<a href=\"https://gitee.com/geektime-geekbang/staffjoy\">https://gitee.com/geektime-geekbang/staffjoy</a></p>\n</li>\n<li>\n<p>课件：<a href=\"https://pan.baidu.com/s/1Q7eP3yZ1Vm8J2nhle5RzTQ\">https://pan.baidu.com/s/1Q7eP3yZ1Vm8J2nhle5RzTQ</a> 提取码: 1aeh</p>\n</li>\n</ul>","comments":[{"had_liked":false,"id":143817,"user_name":"吃胖了再减肥再吃再健身之谜之不瘦","can_delete":false,"product_type":"c3","uid":1588087,"ip_address":"","ucode":"BDDB3BA9D23F3A","user_header":"","comment_is_top":false,"comment_ctime":1571795018,"is_pvip":false,"replies":[{"id":55564,"content":"你好，课程的镜像(服务+单页)都在官方docker hub上：\nhttps:&#47;&#47;hub.docker.com&#47;u&#47;boboweike","user_name":"作者回复","user_name_real":"杨波","uid":1030344,"ctime":1571830779,"ip_address":"","comment_id":143817,"utype":1}],"discussion_count":1,"race_medal":0,"score":2,"product_id":100031401,"comment_content":"波波老师，我本地docker-compose build生成镜像，其他项目都OK，就剩两个前端的工程死都生成不了，不知道是否网络问题，我VPN也用了，还是不行，能否提供下这两个镜像的dockerhub地址给我，我直接放到本地docker环境里跑算了，麻烦了！","like_count":2,"discussions":[{"author":{"id":1030344,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/b8/c8/c94d38a7.jpg","nickname":"杨波","note":"","ucode":"FA3418BB703BCA","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":471703,"discussion_content":"你好，课程的镜像(服务+单页)都在官方docker hub上：\nhttps://hub.docker.com/u/boboweike","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1571830779,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":247755,"user_name":"张伟明","can_delete":false,"product_type":"c3","uid":1229314,"ip_address":"","ucode":"E101C8E2833004","user_header":"https://static001.geekbang.org/account/avatar/00/12/c2/02/f20e09c5.jpg","comment_is_top":false,"comment_ctime":1599819406,"is_pvip":false,"replies":[{"id":91019,"content":"你的k8s应该没有安装好，建议参考AliyunContainerService的方式重新安装：\nhttps:&#47;&#47;github.com&#47;AliyunContainerService&#47;k8s-for-docker-desktop\n\n我的B站空间上也有一个安装视频，可以参考：\nhttps:&#47;&#47;www.bilibili.com&#47;video&#47;BV16E411N7hU\n\n如还有问题，看mac系统日志：\nhttps:&#47;&#47;www.howtogeek.com&#47;356942&#47;how-to-view-the-system-log-on-a-mac&#47;\n搜docker或者kubernetes的错误日志信息，根据错误日志再定位问题。\n\n","user_name":"作者回复","user_name_real":"杨波","uid":1030344,"ctime":1599919173,"ip_address":"","comment_id":247755,"utype":1}],"discussion_count":1,"race_medal":0,"score":2,"product_id":100031401,"comment_content":"波波老师，您好，Mac 电脑已经安装好 Docker，在启用 Kubernetes 后，检查是否安装成功，一直提示Unable to connect to the server: EOF，如何解决？CPU，内存这些都调整过了。","like_count":1,"discussions":[{"author":{"id":1030344,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/b8/c8/c94d38a7.jpg","nickname":"杨波","note":"","ucode":"FA3418BB703BCA","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":505487,"discussion_content":"你的k8s应该没有安装好，建议参考AliyunContainerService的方式重新安装：\nhttps://github.com/AliyunContainerService/k8s-for-docker-desktop\n\n我的B站空间上也有一个安装视频，可以参考：\nhttps://www.bilibili.com/video/BV16E411N7hU\n\n如还有问题，看mac系统日志：\nhttps://www.howtogeek.com/356942/how-to-view-the-system-log-on-a-mac/\n搜docker或者kubernetes的错误日志信息，根据错误日志再定位问题。\n\n","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1599919173,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":193411,"user_name":"arch","can_delete":false,"product_type":"c3","uid":1078931,"ip_address":"","ucode":"A69EBFE0520B85","user_header":"https://static001.geekbang.org/account/avatar/00/10/76/93/2e9bf8ab.jpg","comment_is_top":false,"comment_ctime":1584892060,"is_pvip":true,"replies":[{"id":74048,"content":"嗯，有能力可以用vagant启虚拟机自建k8s玩","user_name":"作者回复","user_name_real":"杨波","uid":1030344,"ctime":1585058305,"ip_address":"","comment_id":193411,"utype":1}],"discussion_count":1,"race_medal":0,"score":2,"product_id":100031401,"comment_content":"本地环境可以通过用vagrant起多个虚拟机，在上面部署k8s，搭建集群。用minikube等不能改东西太难受了","like_count":1,"discussions":[{"author":{"id":1030344,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/b8/c8/c94d38a7.jpg","nickname":"杨波","note":"","ucode":"FA3418BB703BCA","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":488557,"discussion_content":"嗯，有能力可以用vagant启虚拟机自建k8s玩","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1585058305,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":166920,"user_name":"jacky","can_delete":false,"product_type":"c3","uid":1049177,"ip_address":"","ucode":"A0BD06E2ABF520","user_header":"https://static001.geekbang.org/account/avatar/00/10/02/59/989f65c8.jpg","comment_is_top":false,"comment_ctime":1577631146,"is_pvip":false,"replies":[{"id":64904,"content":"谢谢支持！有计划做本课程的后续扩展课程，敬请期待。\n\n建议：建设和运维一套生产级的K8s集群，技术门槛高，人力和硬件等资源投入大，如果不是中大规模互联网公司，一般不建议自建K8s集群，建议直接用公有云提供的K8s集群，比如阿里云K8s。","user_name":"作者回复","user_name_real":"杨波","uid":1030344,"ctime":1577704050,"ip_address":"","comment_id":166920,"utype":1}],"discussion_count":2,"race_medal":0,"score":2,"product_id":100031401,"comment_content":"波波老师，请问什么时候方便讲一下生产环境的部署方式。只有你的讲解最为深入浅出，让人百听不厌。","like_count":1,"discussions":[{"author":{"id":1030344,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/b8/c8/c94d38a7.jpg","nickname":"杨波","note":"","ucode":"FA3418BB703BCA","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":479677,"discussion_content":"谢谢支持！有计划做本课程的后续扩展课程，敬请期待。\n\n建议：建设和运维一套生产级的K8s集群，技术门槛高，人力和硬件等资源投入大，如果不是中大规模互联网公司，一般不建议自建K8s集群，建议直接用公有云提供的K8s集群，比如阿里云K8s。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1577704050,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1049177,"avatar":"https://static001.geekbang.org/account/avatar/00/10/02/59/989f65c8.jpg","nickname":"jacky","note":"","ucode":"A0BD06E2ABF520","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":115752,"discussion_content":"你能否出个视频，解决k8s生产级别的使用。我们团队能给的也就是一个k8s运维人员，机器最多3台。我们的客户主要是工控软件，大部分客户是集团国企客户，上云不现实","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1578032694,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":131521,"user_name":"东方奇骥","can_delete":false,"product_type":"c3","uid":1354850,"ip_address":"","ucode":"DEE7085F7E55A4","user_header":"https://static001.geekbang.org/account/avatar/00/14/ac/62/37912d51.jpg","comment_is_top":false,"comment_ctime":1567780075,"is_pvip":false,"replies":[{"id":50473,"content":"你好，本地Docker Desktop for Mac&#47;Win中的K8s是简化版，不可配置，master住在容器中(kubectl get po --namespace=kube-system)，节点只有一个就是本机。","user_name":"作者回复","user_name_real":"杨波","uid":1030344,"ctime":1568028372,"ip_address":"","comment_id":131521,"utype":1}],"discussion_count":1,"race_medal":0,"score":2,"product_id":100031401,"comment_content":"波波老师，请教一下，只是部署好master节点就可以了吗？work节点不用部署？","like_count":1,"discussions":[{"author":{"id":1030344,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/b8/c8/c94d38a7.jpg","nickname":"杨波","note":"","ucode":"FA3418BB703BCA","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":466500,"discussion_content":"你好，本地Docker Desktop for Mac/Win中的K8s是简化版，不可配置，master住在容器中(kubectl get po --namespace=kube-system)，节点只有一个就是本机。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1568028372,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":293634,"user_name":"正是那朵玫瑰","can_delete":false,"product_type":"c3","uid":1048261,"ip_address":"","ucode":"73D630B654573F","user_header":"https://static001.geekbang.org/account/avatar/00/0f/fe/c5/3467cf94.jpg","comment_is_top":false,"comment_ctime":1621473109,"is_pvip":false,"replies":[{"id":107622,"content":"测试环境一般由公司运维搭建，根据公司测试环境硬件，按照官方文档搭建，利用kops之类的工具可以简化安装。当然有条件可以上公有云(例如aliyun)的k8s环境。","user_name":"作者回复","user_name_real":"杨波","uid":1030344,"ctime":1622992352,"ip_address":"","comment_id":293634,"utype":1}],"discussion_count":1,"race_medal":0,"score":2,"product_id":100031401,"comment_content":"一般开发测试的k8s环境用什么搭建呢？","like_count":0,"discussions":[{"author":{"id":1030344,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/b8/c8/c94d38a7.jpg","nickname":"杨波","note":"","ucode":"FA3418BB703BCA","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":520300,"discussion_content":"测试环境一般由公司运维搭建，根据公司测试环境硬件，按照官方文档搭建，利用kops之类的工具可以简化安装。当然有条件可以上公有云(例如aliyun)的k8s环境。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1622992352,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":218337,"user_name":"B","can_delete":false,"product_type":"c3","uid":1337340,"ip_address":"","ucode":"542EE1046B116B","user_header":"https://static001.geekbang.org/account/avatar/00/14/67/fc/e4ee44b7.jpg","comment_is_top":false,"comment_ctime":1589783878,"is_pvip":false,"replies":[{"id":80879,"content":"可以尝试把这个dashboard的源码(https:&#47;&#47;github.com&#47;kubernetes&#47;dashboard&#47;releases&#47;tag&#47;v2.0.0)下载到本地，\n\n再进入目录：aio&#47;deploy\n\n再运行：kubectl apply -f recommended.yaml\n\n","user_name":"作者回复","user_name_real":"杨波","uid":1030344,"ctime":1589898906,"ip_address":"","comment_id":218337,"utype":1}],"discussion_count":1,"race_medal":0,"score":2,"product_id":100031401,"comment_content":"安装dashboard时一直报这个：The connection to the server raw.githubusercontent.com was refused - did you specify the right host or port?\n","like_count":0,"discussions":[{"author":{"id":1030344,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/b8/c8/c94d38a7.jpg","nickname":"杨波","note":"","ucode":"FA3418BB703BCA","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":495436,"discussion_content":"可以尝试把这个dashboard的源码(https://github.com/kubernetes/dashboard/releases/tag/v2.0.0)下载到本地，\n\n再进入目录：aio/deploy\n\n再运行：kubectl apply -f recommended.yaml\n\n","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1589898906,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":345777,"user_name":"torchlight","can_delete":false,"product_type":"c3","uid":1586169,"ip_address":"","ucode":"1E05FD0360BEF3","user_header":"https://static001.geekbang.org/account/avatar/00/18/33/f9/658f5bd2.jpg","comment_is_top":false,"comment_ctime":1652589082,"is_pvip":false,"replies":null,"discussion_count":0,"race_medal":0,"score":2,"product_id":100031401,"comment_content":"波波老师，不知道是不是版本的问题，kubenetes dashboard2.5.1 现在没有在kube-system这个命名空间，就在kubenetes-dashboard这个命名空间，可以用kubectl get pods -A进行验证","like_count":1},{"had_liked":false,"id":344943,"user_name":"wahaha","can_delete":false,"product_type":"c3","uid":1008747,"ip_address":"","ucode":"EAD5AEE19ECF8B","user_header":"http://thirdwx.qlogo.cn/mmopen/vi_32/WFX7G7hO480BopLPxhY0DqTtDicUCgNHnk4XP1gJfsv37DCRvK9mwRTDHdQX4y0MTdp8DWsnxmkBsmw2Fdtib7MQ/132","comment_is_top":false,"comment_ctime":1651889747,"is_pvip":false,"replies":null,"discussion_count":0,"race_medal":0,"score":2,"product_id":100031401,"comment_content":"问老师一个问题，所有的feignclient都定义在了api里面，请问如何定义fallback？","like_count":0}]}