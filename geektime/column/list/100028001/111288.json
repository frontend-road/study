{"id":111288,"title":"30 | ç”Ÿäº§è€…æ¶ˆè´¹è€…æ¨¡å¼ï¼šç”µå•†åº“å­˜è®¾è®¡ä¼˜åŒ–","content":"<p>ä½ å¥½ï¼Œæˆ‘æ˜¯åˆ˜è¶…ã€‚</p><p>ç”Ÿäº§è€…æ¶ˆè´¹è€…æ¨¡å¼ï¼Œåœ¨ä¹‹å‰çš„ä¸€äº›æ¡ˆä¾‹ä¸­ï¼Œæˆ‘ä»¬æ˜¯æœ‰ä½¿ç”¨è¿‡çš„ï¼Œç›¸ä¿¡ä½ æœ‰ä¸€å®šçš„äº†è§£ã€‚è¿™ä¸ªæ¨¡å¼æ˜¯ä¸€ä¸ªååˆ†ç»å…¸çš„å¤šçº¿ç¨‹å¹¶å‘åä½œæ¨¡å¼ï¼Œç”Ÿäº§è€…ä¸æ¶ˆè´¹è€…æ˜¯é€šè¿‡ä¸€ä¸ªä¸­é—´å®¹å™¨æ¥è§£å†³å¼ºè€¦åˆå…³ç³»ï¼Œå¹¶ä»¥æ­¤æ¥å®ç°ä¸åŒçš„ç”Ÿäº§ä¸æ¶ˆè´¹é€Ÿåº¦ï¼Œä»è€Œè¾¾åˆ°ç¼“å†²çš„æ•ˆæœã€‚</p><p>ä½¿ç”¨ç”Ÿäº§è€…æ¶ˆè´¹è€…æ¨¡å¼ï¼Œå¯ä»¥æé«˜ç³»ç»Ÿçš„æ€§èƒ½å’Œååé‡ï¼Œä»Šå¤©æˆ‘ä»¬å°±æ¥çœ‹çœ‹è¯¥æ¨¡å¼çš„å‡ ç§å®ç°æ–¹å¼ï¼Œè¿˜æœ‰å…¶åœ¨ç”µå•†åº“å­˜ä¸­çš„åº”ç”¨ã€‚</p><h2>Objectçš„wait/notify/notifyAllå®ç°ç”Ÿäº§è€…æ¶ˆè´¹è€…</h2><p>åœ¨<a href=\"https://time.geekbang.org/column/article/102974\">ç¬¬16è®²</a>ä¸­ï¼Œæˆ‘å°±æ›¾ä»‹ç»è¿‡ä½¿ç”¨Objectçš„wait/notify/notifyAllå®ç°ç”Ÿäº§è€…æ¶ˆè´¹è€…æ¨¡å¼ï¼Œè¿™ç§æ–¹å¼æ˜¯åŸºäºObjectçš„wait/notify/notifyAllä¸å¯¹è±¡ç›‘è§†å™¨ï¼ˆMonitorï¼‰å®ç°çº¿ç¨‹é—´çš„ç­‰å¾…å’Œé€šçŸ¥ã€‚</p><p>è¿˜æœ‰ï¼Œåœ¨<a href=\"https://time.geekbang.org/column/article/101244\">ç¬¬12è®²</a>ä¸­æˆ‘ä¹Ÿè¯¦ç»†è®²è§£è¿‡Monitorçš„å·¥ä½œåŸç†ï¼Œå€Ÿæ­¤æˆ‘ä»¬å¯ä»¥å¾—çŸ¥ï¼Œè¿™ç§æ–¹å¼å®ç°çš„ç”Ÿäº§è€…æ¶ˆè´¹è€…æ¨¡å¼æ˜¯åŸºäºå†…æ ¸æ¥å®ç°çš„ï¼Œæœ‰å¯èƒ½ä¼šå¯¼è‡´å¤§é‡çš„ä¸Šä¸‹æ–‡åˆ‡æ¢ï¼Œæ‰€ä»¥æ€§èƒ½å¹¶ä¸æ˜¯æœ€ç†æƒ³çš„ã€‚</p><h2>Lockä¸­Conditionçš„await/signal/signalAllå®ç°ç”Ÿäº§è€…æ¶ˆè´¹è€…</h2><p>ç›¸å¯¹Objectç±»æä¾›çš„wait/notify/notifyAllæ–¹æ³•å®ç°çš„ç”Ÿäº§è€…æ¶ˆè´¹è€…æ¨¡å¼ï¼Œæˆ‘æ›´æ¨èä½¿ç”¨java.util.concurrentåŒ…æä¾›çš„Lock &amp;&amp; Conditionå®ç°çš„ç”Ÿäº§è€…æ¶ˆè´¹è€…æ¨¡å¼ã€‚</p><!-- [[[read_end]]] --><p>åœ¨æ¥å£Conditionç±»ä¸­å®šä¹‰äº†await/signal/signalAll æ–¹æ³•ï¼Œå…¶ä½œç”¨ä¸Objectçš„wait/notify/notifyAllæ–¹æ³•ç±»ä¼¼ï¼Œè¯¥æ¥å£ç±»ä¸æ˜¾ç¤ºé”Locké…åˆï¼Œå®ç°å¯¹çº¿ç¨‹çš„é˜»å¡å’Œå”¤é†’æ“ä½œã€‚</p><p>æˆ‘åœ¨<a href=\"https://time.geekbang.org/column/article/101651\">ç¬¬13è®²</a>ä¸­è¯¦ç»†è®²åˆ°äº†æ˜¾ç¤ºé”ï¼Œæ˜¾ç¤ºé”ReentrantLockæˆ–ReentrantReadWriteLockéƒ½æ˜¯åŸºäºAQSå®ç°çš„ï¼Œè€Œåœ¨AQSä¸­æœ‰ä¸€ä¸ªå†…éƒ¨ç±»ConditionObjectå®ç°äº†Conditionæ¥å£ã€‚</p><p>æˆ‘ä»¬çŸ¥é“AQSä¸­å­˜åœ¨ä¸€ä¸ªåŒæ­¥é˜Ÿåˆ—ï¼ˆCLHé˜Ÿåˆ—ï¼‰ï¼Œå½“ä¸€ä¸ªçº¿ç¨‹æ²¡æœ‰è·å–åˆ°é”æ—¶å°±ä¼šè¿›å…¥åˆ°åŒæ­¥é˜Ÿåˆ—ä¸­è¿›è¡Œé˜»å¡ï¼Œå¦‚æœè¢«å”¤é†’åè·å–åˆ°é”ï¼Œåˆ™ç§»é™¤åŒæ­¥é˜Ÿåˆ—ã€‚</p><p>é™¤æ­¤ä¹‹å¤–ï¼ŒAQSä¸­è¿˜å­˜åœ¨ä¸€ä¸ªæ¡ä»¶é˜Ÿåˆ—ï¼Œé€šè¿‡addWaiteræ–¹æ³•ï¼Œå¯ä»¥å°†await()æ–¹æ³•è°ƒç”¨çš„çº¿ç¨‹æ”¾å…¥åˆ°æ¡ä»¶é˜Ÿåˆ—ä¸­ï¼Œçº¿ç¨‹è¿›å…¥ç­‰å¾…çŠ¶æ€ã€‚å½“è°ƒç”¨signalä»¥åŠsignalAll æ–¹æ³•åï¼Œçº¿ç¨‹å°†ä¼šè¢«å”¤é†’ï¼Œå¹¶ä»æ¡ä»¶é˜Ÿåˆ—ä¸­åˆ é™¤ï¼Œä¹‹åè¿›å…¥åˆ°åŒæ­¥é˜Ÿåˆ—ä¸­ã€‚æ¡ä»¶é˜Ÿåˆ—æ˜¯é€šè¿‡ä¸€ä¸ªå•å‘é“¾è¡¨å®ç°çš„ï¼Œæ‰€ä»¥Conditionæ”¯æŒå¤šä¸ªç­‰å¾…é˜Ÿåˆ—ã€‚</p><p>ç”±ä¸Šå¯çŸ¥ï¼ŒLockä¸­Conditionçš„await/signal/signalAllå®ç°çš„ç”Ÿäº§è€…æ¶ˆè´¹è€…æ¨¡å¼ï¼Œæ˜¯åŸºäºJavaä»£ç å±‚å®ç°çš„ï¼Œæ‰€ä»¥åœ¨æ€§èƒ½å’Œæ‰©å±•æ€§æ–¹é¢éƒ½æ›´æœ‰ä¼˜åŠ¿ã€‚</p><p>ä¸‹é¢æ¥çœ‹ä¸€ä¸ªæ¡ˆä¾‹ï¼Œæˆ‘ä»¬é€šè¿‡ä¸€æ®µä»£ç æ¥å®ç°ä¸€ä¸ªå•†å“åº“å­˜çš„ç”Ÿäº§å’Œæ¶ˆè´¹ã€‚</p><pre><code>public class LockConditionTest {\n\n\tprivate LinkedList&lt;String&gt; product = new LinkedList&lt;String&gt;();\n\n\tprivate int maxInventory = 10; // æœ€å¤§åº“å­˜\n\n\tprivate Lock lock = new ReentrantLock();// èµ„æºé”\n\n\tprivate Condition condition = lock.newCondition();// åº“å­˜éæ»¡å’Œéç©ºæ¡ä»¶\n\n\t/**\n\t * æ–°å¢å•†å“åº“å­˜\n\t * @param e\n\t */\n\tpublic void produce(String e) {\n\t\tlock.lock();\n\t\ttry {\n\t\t\twhile (product.size() == maxInventory) {\n\t\t\t\tcondition.await();\n\t\t\t}\n\n\t\t\tproduct.add(e);\n\t\t\tSystem.out.println(&quot;æ”¾å…¥ä¸€ä¸ªå•†å“åº“å­˜ï¼Œæ€»åº“å­˜ä¸ºï¼š&quot; + product.size());\n\t\t\tcondition.signalAll();\n\n\t\t} catch (Exception ex) {\n\t\t\tex.printStackTrace();\n\t\t} finally {\n\t\t\tlock.unlock();\n\t\t}\n\t}\n\n\t/**\n\t * æ¶ˆè´¹å•†å“\n\t * @return\n\t */\n\tpublic String consume() {\n\t\tString result = null;\n\t\tlock.lock();\n\t\ttry {\n\t\t\twhile (product.size() == 0) {\n\t\t\t\tcondition.await();\n\t\t\t}\n\n\t\t\tresult = product.removeLast();\n\t\t\tSystem.out.println(&quot;æ¶ˆè´¹ä¸€ä¸ªå•†å“ï¼Œæ€»åº“å­˜ä¸ºï¼š&quot; + product.size());\n\t\t\tcondition.signalAll();\n\n\t\t} catch (Exception e) {\n\t\t\te.printStackTrace();\n\t\t} finally {\n\t\t\tlock.unlock();\n\t\t}\n\n\t\treturn result;\n\t}\n\n\t/**\n\t * ç”Ÿäº§è€…\n\t * @author admin\n\t *\n\t */\n\tprivate class Producer implements Runnable {\n\n\t\tpublic void run() {\n\t\t\tfor (int i = 0; i &lt; 20; i++) {\n\t\t\t\tproduce(&quot;å•†å“&quot; + i);\n\t\t\t}\n\t\t}\n\n\t}\n\n\t/**\n\t * æ¶ˆè´¹è€…\n\t * @author admin\n\t *\n\t */\n\tprivate class Customer implements Runnable {\n\n\t\tpublic void run() {\n\t\t\tfor (int i = 0; i &lt; 20; i++) {\n\t\t\t\tconsume();\n\t\t\t}\n\t\t}\n\t}\n\n\tpublic static void main(String[] args) {\n\n\t\tLockConditionTest lc = new LockConditionTest();\n\t\tnew Thread(lc.new Producer()).start();\n\t\tnew Thread(lc.new Customer()).start();\n\t\tnew Thread(lc.new Producer()).start();\n\t\tnew Thread(lc.new Customer()).start();\n\n\t}\n}\n</code></pre><p>çœ‹å®Œæ¡ˆä¾‹ï¼Œè¯·ä½ æ€è€ƒä¸‹ï¼Œæˆ‘ä»¬å¯¹æ­¤è¿˜æœ‰ä¼˜åŒ–çš„ç©ºé—´å—ï¼Ÿ</p><p>ä»ä»£ç ä¸­åº”è¯¥ä¸éš¾å‘ç°ï¼Œç”Ÿäº§è€…å’Œæ¶ˆè´¹è€…éƒ½åœ¨ç«äº‰åŒä¸€æŠŠé”ï¼Œè€Œå®é™…ä¸Šä¸¤è€…æ²¡æœ‰åŒæ­¥å…³ç³»ï¼Œç”±äºConditionèƒ½å¤Ÿæ”¯æŒå¤šä¸ªç­‰å¾…é˜Ÿåˆ—ä»¥åŠä¸å“åº”ä¸­æ–­ï¼Œ æ‰€ä»¥æˆ‘ä»¬å¯ä»¥å°†ç”Ÿäº§è€…å’Œæ¶ˆè´¹è€…çš„ç­‰å¾…æ¡ä»¶å’Œé”èµ„æºåˆ†ç¦»ï¼Œä»è€Œè¿›ä¸€æ­¥ä¼˜åŒ–ç³»ç»Ÿå¹¶å‘æ€§èƒ½ï¼Œä»£ç å¦‚ä¸‹ï¼š</p><pre><code>\tprivate LinkedList&lt;String&gt; product = new LinkedList&lt;String&gt;();\n\tprivate AtomicInteger inventory = new AtomicInteger(0);//å®æ—¶åº“å­˜\n\n\tprivate int maxInventory = 10; // æœ€å¤§åº“å­˜\n\n\tprivate Lock consumerLock = new ReentrantLock();// èµ„æºé”\n\tprivate Lock productLock = new ReentrantLock();// èµ„æºé”\n\n\tprivate Condition notEmptyCondition = consumerLock.newCondition();// åº“å­˜æ»¡å’Œç©ºæ¡ä»¶\n\tprivate Condition notFullCondition = productLock.newCondition();// åº“å­˜æ»¡å’Œç©ºæ¡ä»¶\n\n\t/**\n\t * æ–°å¢å•†å“åº“å­˜\n\t * @param e\n\t */\n\tpublic void produce(String e) {\n\t\tproductLock.lock();\n\t\ttry {\n\t\t\twhile (inventory.get() == maxInventory) {\n\t\t\t\tnotFullCondition.await();\n\t\t\t}\n\n\t\t\tproduct.add(e);\n\t\t\t\n\t\t\tSystem.out.println(&quot;æ”¾å…¥ä¸€ä¸ªå•†å“åº“å­˜ï¼Œæ€»åº“å­˜ä¸ºï¼š&quot; + inventory.incrementAndGet());\n\t\t\t\n\t\t\tif(inventory.get()&lt;maxInventory) {\n\t\t\t\tnotFullCondition.signalAll();\n\t\t\t}\n\n\t\t} catch (Exception ex) {\n\t\t\tex.printStackTrace();\n\t\t} finally {\n\t\t\tproductLock.unlock();\n\t\t}\n\t\t\n\t\tif(inventory.get()&gt;0) {\n\t\t\ttry {\n\t\t\t\tconsumerLock.lockInterruptibly();\n\t\t\t\tnotEmptyCondition.signalAll();\n\t\t\t} catch (InterruptedException e1) {\n\t\t\t\t// TODO Auto-generated catch block\n\t\t\t\te1.printStackTrace();\n\t\t\t}finally {\n\t\t\t\tconsumerLock.unlock();\n\t\t\t}\n\t\t}\n\t\t\n\t}\n\n\t/**\n\t * æ¶ˆè´¹å•†å“\n\t * @return\n\t */\n\tpublic String consume() {\n\t\tString result = null;\n\t\tconsumerLock.lock();\n\t\ttry {\n\t\t\twhile (inventory.get() == 0) {\n\t\t\t\tnotEmptyCondition.await();\n\t\t\t}\n\n\t\t\tresult = product.removeLast();\n\t\t\tSystem.out.println(&quot;æ¶ˆè´¹ä¸€ä¸ªå•†å“ï¼Œæ€»åº“å­˜ä¸ºï¼š&quot; + inventory.decrementAndGet());\n\t\t\t\n\t\t\tif(inventory.get()&gt;0) {\n\t\t\t\tnotEmptyCondition.signalAll();\n\t\t\t}\n\t\t} catch (Exception e) {\n\t\t\te.printStackTrace();\n\t\t} finally {\n\t\t\tconsumerLock.unlock();\n\t\t}\n\t\t\n\t\tif(inventory.get()&lt;maxInventory) {\n\t\t\t\n\t\t\ttry {\n\t\t\t\tproductLock.lockInterruptibly();\n\t\t\t\tnotFullCondition.signalAll();\n\t\t\t} catch (InterruptedException e1) {\n\t\t\t\t// TODO Auto-generated catch block\n\t\t\t\te1.printStackTrace();\n\t\t\t}finally {\n\t\t\t\tproductLock.unlock();\n\t\t\t}\n\t\t}\n\t\treturn result;\n\t}\n\t/**\n\t * ç”Ÿäº§è€…\n\t * @author admin\n\t *\n\t */\n\tprivate class Producer implements Runnable {\n\n\t\tpublic void run() {\n\t\t\tfor (int i = 0; i &lt; 20; i++) {\n\t\t\t\tproduce(&quot;å•†å“&quot; + i);\n\t\t\t}\n\t\t}\n\t}\n\n\t/**\n\t * æ¶ˆè´¹è€…\n\t * @author admin\n\t *\n\t */\n\tprivate class Customer implements Runnable {\n\n\t\tpublic void run() {\n\t\t\tfor (int i = 0; i &lt; 20; i++) {\n\t\t\t\tconsume();\n\t\t\t}\n\t\t}\n\t}\n\n\tpublic static void main(String[] args) {\n\n\t\tLockConditionTest2 lc = new LockConditionTest2();\n\t\tnew Thread(lc.new Producer()).start();\n\t\tnew Thread(lc.new Customer()).start();\n\n\t}\n}\n</code></pre><p>æˆ‘ä»¬åˆ†åˆ«åˆ›å»º  productLock ä»¥åŠ  consumerLock  ä¸¤ä¸ªé”èµ„æºï¼Œå‰è€…æ§åˆ¶ç”Ÿäº§è€…çº¿ç¨‹å¹¶è¡Œæ“ä½œï¼Œåè€…æ§åˆ¶æ¶ˆè´¹è€…çº¿ç¨‹å¹¶å‘è¿è¡Œï¼›åŒæ—¶ä¹Ÿè®¾ç½®ä¸¤ä¸ªæ¡ä»¶å˜é‡ï¼Œä¸€ä¸ªæ˜¯notEmptyConditionï¼Œè´Ÿè´£æ§åˆ¶æ¶ˆè´¹è€…çº¿ç¨‹çŠ¶æ€ï¼Œä¸€ä¸ªæ˜¯notFullConditionï¼Œè´Ÿè´£æ§åˆ¶ç”Ÿäº§è€…çº¿ç¨‹çŠ¶æ€ã€‚è¿™æ ·ä¼˜åŒ–åï¼Œå¯ä»¥å‡å°‘æ¶ˆè´¹è€…ä¸ç”Ÿäº§è€…çš„ç«äº‰ï¼Œå®ç°ä¸¤è€…å¹¶å‘æ‰§è¡Œã€‚</p><p>æˆ‘ä»¬è¿™é‡Œæ˜¯åŸºäºLinkedListæ¥å­˜å–åº“å­˜çš„ï¼Œè™½ç„¶LinkedListæ˜¯éçº¿ç¨‹å®‰å…¨ï¼Œä½†æˆ‘ä»¬æ–°å¢æ˜¯æ“ä½œå¤´éƒ¨ï¼Œè€Œæ¶ˆè´¹æ˜¯æ“ä½œé˜Ÿåˆ—çš„å°¾éƒ¨ï¼Œç†è®ºä¸Šæ¥è¯´æ²¡æœ‰çº¿ç¨‹å®‰å…¨é—®é¢˜ã€‚è€Œåº“å­˜çš„å®é™…æ•°é‡inventoryæ˜¯åŸºäºAtomicIntegerï¼ˆCASé”ï¼‰çº¿ç¨‹å®‰å…¨ç±»å®ç°çš„ï¼Œæ—¢å¯ä»¥ä¿è¯åŸå­æ€§ï¼Œä¹Ÿå¯ä»¥ä¿è¯æ¶ˆè´¹è€…å’Œç”Ÿäº§è€…ä¹‹é—´æ˜¯å¯è§çš„ã€‚</p><h2>BlockingQueueå®ç°ç”Ÿäº§è€…æ¶ˆè´¹è€…</h2><p>ç›¸å¯¹å‰ä¸¤ç§å®ç°æ–¹å¼ï¼ŒBlockingQueueå®ç°æ˜¯æœ€ç®€å•æ˜äº†çš„ï¼Œä¹Ÿæ˜¯æœ€å®¹æ˜“ç†è§£çš„ã€‚</p><p>å› ä¸ºBlockingQueueæ˜¯çº¿ç¨‹å®‰å…¨çš„ï¼Œä¸”ä»é˜Ÿåˆ—ä¸­è·å–æˆ–è€…ç§»é™¤å…ƒç´ æ—¶ï¼Œå¦‚æœé˜Ÿåˆ—ä¸ºç©ºï¼Œè·å–æˆ–ç§»é™¤æ“ä½œåˆ™éœ€è¦ç­‰å¾…ï¼Œç›´åˆ°é˜Ÿåˆ—ä¸ä¸ºç©ºï¼›åŒæ—¶ï¼Œå¦‚æœå‘é˜Ÿåˆ—ä¸­æ·»åŠ å…ƒç´ ï¼Œå‡è®¾æ­¤æ—¶é˜Ÿåˆ—æ— å¯ç”¨ç©ºé—´ï¼Œæ·»åŠ æ“ä½œä¹Ÿéœ€è¦ç­‰å¾…ã€‚æ‰€ä»¥BlockingQueueéå¸¸é€‚åˆç”¨æ¥å®ç°ç”Ÿäº§è€…æ¶ˆè´¹è€…æ¨¡å¼ã€‚è¿˜æ˜¯ä»¥ä¸€ä¸ªæ¡ˆä¾‹æ¥çœ‹ä¸‹å®ƒçš„ä¼˜åŒ–ï¼Œä»£ç å¦‚ä¸‹ï¼š</p><pre><code>public class BlockingQueueTest {\n\n\tprivate int maxInventory = 10; // æœ€å¤§åº“å­˜\n\n\tprivate BlockingQueue&lt;String&gt; product = new LinkedBlockingQueue&lt;&gt;(maxInventory);//ç¼“å­˜é˜Ÿåˆ—\n\n\t/**\n\t * æ–°å¢å•†å“åº“å­˜\n\t * @param e\n\t */\n\tpublic void produce(String e) {\n\t\ttry {\n\t\t\tproduct.put(e);\n\t\t\tSystem.out.println(&quot;æ”¾å…¥ä¸€ä¸ªå•†å“åº“å­˜ï¼Œæ€»åº“å­˜ä¸ºï¼š&quot; + product.size());\n\t\t} catch (InterruptedException e1) {\n\t\t\t// TODO Auto-generated catch block\n\t\t\te1.printStackTrace();\n\t\t}\n\t}\n\n\t/**\n\t * æ¶ˆè´¹å•†å“\n\t * @return\n\t */\n\tpublic String consume() {\n\t\tString result = null;\n\t\ttry {\n\t\t\tresult = product.take();\n\t\t\tSystem.out.println(&quot;æ¶ˆè´¹ä¸€ä¸ªå•†å“ï¼Œæ€»åº“å­˜ä¸ºï¼š&quot; + product.size());\n\t\t} catch (InterruptedException e) {\n\t\t\t// TODO Auto-generated catch block\n\t\t\te.printStackTrace();\n\t\t}\n\n\t\treturn result;\n\t}\n\n\t/**\n\t * ç”Ÿäº§è€…\n\t * @author admin\n\t *\n\t */\n\tprivate class Producer implements Runnable {\n\n\t\tpublic void run() {\n\t\t\tfor (int i = 0; i &lt; 20; i++) {\n\t\t\t\tproduce(&quot;å•†å“&quot; + i);\n\t\t\t}\n\t\t}\n\n\t}\n\n\t/**\n\t * æ¶ˆè´¹è€…\n\t * @author admin\n\t *\n\t */\n\tprivate class Customer implements Runnable {\n\n\t\tpublic void run() {\n\t\t\tfor (int i = 0; i &lt; 20; i++) {\n\t\t\t\tconsume();\n\t\t\t}\n\t\t}\n\t}\n\n\tpublic static void main(String[] args) {\n\n\t\tBlockingQueueTest lc = new BlockingQueueTest();\n\t\tnew Thread(lc.new Producer()).start();\n\t\tnew Thread(lc.new Customer()).start();\n\t\tnew Thread(lc.new Producer()).start();\n\t\tnew Thread(lc.new Customer()).start();\n\n\t}\n}\n</code></pre><p>åœ¨è¿™ä¸ªæ¡ˆä¾‹ä¸­ï¼Œæˆ‘ä»¬åˆ›å»ºäº†ä¸€ä¸ªLinkedBlockingQueueï¼Œå¹¶è®¾ç½®é˜Ÿåˆ—å¤§å°ã€‚ä¹‹åæˆ‘ä»¬åˆ›å»ºä¸€ä¸ªæ¶ˆè´¹æ–¹æ³•consume()ï¼Œæ–¹æ³•é‡Œé¢è°ƒç”¨LinkedBlockingQueueä¸­çš„take()æ–¹æ³•ï¼Œæ¶ˆè´¹è€…é€šè¿‡è¯¥æ–¹æ³•è·å–å•†å“ï¼Œå½“é˜Ÿåˆ—ä¸­å•†å“æ•°é‡ä¸ºé›¶æ—¶ï¼Œæ¶ˆè´¹è€…å°†è¿›å…¥ç­‰å¾…çŠ¶æ€ï¼›æˆ‘ä»¬å†åˆ›å»ºä¸€ä¸ªç”Ÿäº§æ–¹æ³•produce()ï¼Œæ–¹æ³•é‡Œé¢è°ƒç”¨LinkedBlockingQueueä¸­çš„put()æ–¹æ³•ï¼Œç”Ÿäº§æ–¹é€šè¿‡è¯¥æ–¹æ³•å¾€é˜Ÿåˆ—ä¸­æ”¾å•†å“ï¼Œå¦‚æœé˜Ÿåˆ—æ»¡äº†ï¼Œç”Ÿäº§è€…å°±å°†è¿›å…¥ç­‰å¾…çŠ¶æ€ã€‚</p><h2>ç”Ÿäº§è€…æ¶ˆè´¹è€…ä¼˜åŒ–ç”µå•†åº“å­˜è®¾è®¡</h2><p>äº†è§£å®Œç”Ÿäº§è€…æ¶ˆè´¹è€…æ¨¡å¼çš„å‡ ç§å¸¸è§å®ç°æ–¹å¼ï¼Œæ¥ä¸‹æ¥æˆ‘ä»¬å°±å…·ä½“çœ‹çœ‹è¯¥æ¨¡å¼æ˜¯å¦‚ä½•ä¼˜åŒ–ç”µå•†åº“å­˜è®¾è®¡çš„ã€‚</p><p>ç”µå•†ç³»ç»Ÿä¸­ç»å¸¸ä¼šæœ‰æŠ¢è´­æ´»åŠ¨ï¼Œåœ¨è¿™ç±»ä¿ƒé”€æ´»åŠ¨ä¸­ï¼ŒæŠ¢è´­å•†å“çš„åº“å­˜å®é™…æ˜¯å­˜åœ¨åº“å­˜è¡¨ä¸­çš„ã€‚ä¸ºäº†æé«˜æŠ¢è´­æ€§èƒ½ï¼Œæˆ‘ä»¬é€šå¸¸ä¼šå°†åº“å­˜å­˜æ”¾åœ¨ç¼“å­˜ä¸­ï¼Œé€šè¿‡ç¼“å­˜ä¸­çš„åº“å­˜æ¥å®ç°åº“å­˜çš„ç²¾ç¡®æ‰£å‡ã€‚åœ¨æäº¤è®¢å•å¹¶ä»˜æ¬¾ä¹‹åï¼Œæˆ‘ä»¬è¿˜éœ€è¦å†å»æ‰£é™¤æ•°æ®åº“ä¸­çš„åº“å­˜ã€‚å¦‚æœé‡åˆ°ç¬æ—¶é«˜å¹¶å‘ï¼Œæˆ‘ä»¬è¿˜éƒ½å»æ“ä½œæ•°æ®åº“çš„è¯ï¼Œé‚£ä¹ˆåœ¨å•è¡¨å•åº“çš„æƒ…å†µä¸‹ï¼Œæ•°æ®åº“å°±å¾ˆå¯èƒ½ä¼šå‡ºç°æ€§èƒ½ç“¶é¢ˆã€‚</p><p>è€Œæˆ‘ä»¬åº“å­˜è¡¨å¦‚æœè¦å®ç°åˆ†åº“åˆ†è¡¨ï¼ŒåŠ¿å¿…ä¼šå¢åŠ ä¸šåŠ¡çš„å¤æ‚åº¦ã€‚è¯•æƒ³ä¸€ä¸ªå•†å“çš„åº“å­˜åˆ†åˆ«åœ¨ä¸åŒåº“çš„è¡¨ä¸­ï¼Œæˆ‘ä»¬åœ¨æ‰£é™¤åº“å­˜æ—¶ï¼Œåˆè¯¥å¦‚ä½•åˆ¤æ–­å»å“ªä¸ªåº“ä¸­æ‰£é™¤å‘¢ï¼Ÿ</p><p>å¦‚æœéšæ„æ‰£é™¤è¡¨ä¸­åº“å­˜ï¼Œé‚£ä¹ˆå°±ä¼šå‡ºç°æœ‰äº›è¡¨å·²ç»æ‰£å®Œäº†ï¼Œæœ‰äº›è¡¨ä¸­è¿˜æœ‰åº“å­˜çš„æƒ…å†µï¼Œè¿™æ ·çš„æ“ä½œæ˜¾ç„¶æ˜¯ä¸åˆç†çš„ï¼Œæ­¤æ—¶å°±éœ€è¦é¢å¤–å¢åŠ é€»è¾‘åˆ¤æ–­æ¥è§£å†³é—®é¢˜ã€‚</p><p>åœ¨ä¸åˆ†åº“åˆ†è¡¨çš„æƒ…å†µä¸‹ï¼Œä¸ºäº†æé«˜è®¢å•ä¸­æ‰£é™¤åº“å­˜ä¸šåŠ¡çš„æ€§èƒ½ä»¥åŠååé‡ï¼Œæˆ‘ä»¬å°±å¯ä»¥é‡‡ç”¨ç”Ÿäº§è€…æ¶ˆè´¹è€…æ¨¡å¼æ¥å®ç°ç³»ç»Ÿçš„æ€§èƒ½ä¼˜åŒ–ã€‚</p><p>åˆ›å»ºè®¢å•ç­‰äºç”Ÿäº§è€…ï¼Œå­˜æ”¾è®¢å•çš„é˜Ÿåˆ—åˆ™æ˜¯ç¼“å†²å®¹å™¨ï¼Œè€Œä»é˜Ÿåˆ—ä¸­æ¶ˆè´¹è®¢å•åˆ™æ˜¯æ•°æ®åº“æ‰£é™¤åº“å­˜æ“ä½œã€‚å…¶ä¸­å­˜æ”¾è®¢å•çš„é˜Ÿåˆ—å¯ä»¥æå¤§é™åº¦åœ°ç¼“å†²é«˜å¹¶å‘ç»™æ•°æ®åº“å¸¦æ¥çš„å‹åŠ›ã€‚</p><p>æˆ‘ä»¬è¿˜å¯ä»¥åŸºäºæ¶ˆæ¯é˜Ÿåˆ—æ¥å®ç°ç”Ÿäº§è€…æ¶ˆè´¹è€…æ¨¡å¼ï¼Œå¦‚ä»ŠRabbitMQã€RocketMQéƒ½å®ç°äº†äº‹åŠ¡ï¼Œæˆ‘ä»¬åªéœ€è¦å°†è®¢å•é€šè¿‡äº‹åŠ¡æäº¤åˆ°MQä¸­ï¼Œæ‰£é™¤åº“å­˜çš„æ¶ˆè´¹æ–¹åªéœ€è¦é€šè¿‡æ¶ˆè´¹MQæ¥é€æ­¥æ“ä½œæ•°æ®åº“å³å¯ã€‚</p><h2>æ€»ç»“</h2><p>ä½¿ç”¨ç”Ÿäº§è€…æ¶ˆè´¹è€…æ¨¡å¼æ¥ç¼“å†²é«˜å¹¶å‘æ•°æ®åº“æ‰£é™¤åº“å­˜å‹åŠ›ï¼Œç±»ä¼¼è¿™æ ·çš„ä¾‹å­å…¶å®è¿˜æœ‰å¾ˆå¤šã€‚</p><p>ä¾‹å¦‚ï¼Œæˆ‘ä»¬å¹³æ—¶ä½¿ç”¨æ¶ˆæ¯é˜Ÿåˆ—æ¥åšé«˜å¹¶å‘æµé‡å‰Šå³°ï¼Œä¹Ÿæ˜¯åŸºäºè¿™ä¸ªåŸç†ã€‚æŠ¢è´­å•†å“æ—¶ï¼Œå¦‚æœæ‰€æœ‰çš„æŠ¢è´­è¯·æ±‚éƒ½ç›´æ¥è¿›å…¥åˆ¤æ–­æ˜¯å¦æœ‰åº“å­˜å’Œå†»ç»“ç¼“å­˜åº“å­˜ç­‰é€»è¾‘ä¸šåŠ¡ä¸­ï¼Œç”±äºè¿™äº›é€»è¾‘ä¸šåŠ¡æ“ä½œä¼šå¢åŠ èµ„æºæ¶ˆè€—ï¼Œå°±å¯èƒ½ä¼šå‹å®åº”ç”¨æœåŠ¡ã€‚æ­¤æ—¶ï¼Œä¸ºäº†ä¿è¯ç³»ç»Ÿèµ„æºä½¿ç”¨çš„åˆç†æ€§ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡ä¸€ä¸ªæ¶ˆæ¯é˜Ÿåˆ—æ¥ç¼“å†²ç¬æ—¶çš„é«˜å¹¶å‘è¯·æ±‚ã€‚</p><p>ç”Ÿäº§è€…æ¶ˆè´¹è€…æ¨¡å¼é™¤äº†å¯ä»¥åšç¼“å†²ä¼˜åŒ–ç³»ç»Ÿæ€§èƒ½ä¹‹å¤–ï¼Œå®ƒè¿˜å¯ä»¥åº”ç”¨åœ¨å¤„ç†ä¸€äº›æ‰§è¡Œä»»åŠ¡æ—¶é—´æ¯”è¾ƒé•¿çš„åœºæ™¯ä¸­ã€‚</p><p>ä¾‹å¦‚å¯¼å‡ºæŠ¥è¡¨ä¸šåŠ¡ï¼Œç”¨æˆ·åœ¨å¯¼å‡ºä¸€ç§æ¯”è¾ƒå¤§çš„æŠ¥è¡¨æ—¶ï¼Œé€šå¸¸éœ€è¦ç­‰å¾…å¾ˆé•¿æ—¶é—´ï¼Œè¿™æ ·çš„ç”¨æˆ·ä½“éªŒæ˜¯éå¸¸å·®çš„ã€‚é€šå¸¸æˆ‘ä»¬å¯ä»¥å›ºå®šä¸€äº›æŠ¥è¡¨å†…å®¹ï¼Œæ¯”å¦‚ç”¨æˆ·ç»å¸¸éœ€è¦åœ¨ä»Šå¤©å¯¼å‡ºæ˜¨å¤©çš„é”€é‡æŠ¥è¡¨ï¼Œæˆ–è€…åœ¨æœˆåˆå¯¼å‡ºä¸Šä¸ªæœˆçš„æŠ¥è¡¨ï¼Œæˆ‘ä»¬å°±å¯ä»¥æå‰å°†æŠ¥è¡¨å¯¼å‡ºåˆ°æœ¬åœ°æˆ–å†…å­˜ä¸­ï¼Œè¿™æ ·ç”¨æˆ·å°±å¯ä»¥åœ¨å¾ˆçŸ­çš„æ—¶é—´å†…ç›´æ¥ä¸‹è½½æŠ¥è¡¨äº†ã€‚</p><h2>æ€è€ƒé¢˜</h2><p>æˆ‘ä»¬å¯ä»¥ç”¨ç”Ÿäº§è€…æ¶ˆè´¹è€…æ¨¡å¼æ¥å®ç°ç¬æ—¶é«˜å¹¶å‘çš„æµé‡å‰Šå³°ï¼Œç„¶è€Œè¿™æ ·åšè™½ç„¶ç¼“è§£äº†æ¶ˆè´¹æ–¹çš„å‹åŠ›ï¼Œä½†ç”Ÿäº§æ–¹åˆ™ä¼šå› ä¸ºç¬æ—¶é«˜å¹¶å‘ï¼Œè€Œå‘ç”Ÿå¤§é‡çº¿ç¨‹é˜»å¡ã€‚é¢å¯¹è¿™æ ·çš„æƒ…å†µï¼Œä½ çŸ¥é“æœ‰ä»€ä¹ˆæ–¹å¼å¯ä»¥ä¼˜åŒ–çº¿ç¨‹é˜»å¡æ‰€å¸¦æ¥çš„æ€§èƒ½é—®é¢˜å—ï¼Ÿ</p><p>æœŸå¾…åœ¨ç•™è¨€åŒºçœ‹åˆ°ä½ çš„è§è§£ã€‚ä¹Ÿæ¬¢è¿ä½ ç‚¹å‡»â€œè¯·æœ‹å‹è¯»â€ï¼ŒæŠŠä»Šå¤©çš„å†…å®¹åˆ†äº«ç»™èº«è¾¹çš„æœ‹å‹ï¼Œé‚€è¯·ä»–ä¸€èµ·è®¨è®ºã€‚</p><p></p>","comments":[{"had_liked":false,"id":119210,"user_name":"Jxin","can_delete":false,"product_type":"c1","uid":1251111,"ip_address":"","ucode":"4C03928388C413","user_header":"https://static001.geekbang.org/account/avatar/00/13/17/27/ec30d30a.jpg","comment_is_top":false,"comment_ctime":1564537569,"is_pvip":false,"replies":[{"id":"44000","content":"çœ‹æ¥æœ‰å®æˆ˜ç»éªŒğŸ‘ğŸ»","user_name":"ä½œè€…å›å¤","user_name_real":"åˆ˜è¶…","uid":"1228576","ctime":1564713010,"ip_address":"","comment_id":119210,"utype":1}],"discussion_count":3,"race_medal":0,"score":"104643752673","product_id":100028001,"comment_content":"1.ç”Ÿäº§æ¶ˆè´¹æ¨¡å¼ç”¨ä¿¡å·é‡ä¹Ÿèƒ½ç©ã€‚<br>2.ç”Ÿäº§è€…è¿™è¾¹çš„ä¼˜åŒ–æ€è·¯åº”è¯¥æ˜¯æé«˜å“åº”é€Ÿåº¦å’Œå¢åŠ èµ„æºã€‚æé«˜å“åº”é€Ÿåº¦å°±æ˜¯å°½é‡é™ä½ç”Ÿäº§é€»è¾‘çš„è€—æ—¶ï¼Œå¢åŠ èµ„æºå°±æ˜¯æ ¹æ®ä¸šåŠ¡é‡ä¸ºè¯¥ç”Ÿäº§è€…å•ç‹¬çº¿ç¨‹æ± å¹¶è°ƒæ•´çº¿ç¨‹æ•°ã€‚è‡³äºé™æµå’Œä»¤ç‰Œæ¡¶æ„Ÿè§‰éƒ½æ˜¯é™çº§å¤„ç†ï¼Œå±äºè§„é¿é˜»å¡åœºæ™¯è€Œéè§£å†³é˜»å¡åœºæ™¯ï¼Œåº”è¯¥ä¸åœ¨ç­”æ¡ˆèŒƒå›´å†…å§ã€‚<br>3.å¯¹äºè¿›ç¨‹å†…ç”Ÿäº§æ¶ˆè´¹æ¨¡å¼ï¼Œå¤§è§„æ¨¡ï¼Œé‡å¤§çš„æ•°æ®æœ¬èº«å°±ä¸é€‚åˆï¼Œæ¯•ç«Ÿå†…å­˜ç©ºé—´æœ‰é™ï¼Œæ¶ˆæ¯å †ç§¯æœ‰é™ï¼Œæ‰€ä»¥é‡çº§è¾¾åˆ°ä¸€å®šæŒ‡æ ‡å°±é‡‡ç”¨è·¨è¿›ç¨‹æ–¹å¼ï¼Œæ¯”å¦‚kafkaå’Œrocketmqã€‚åŒæ—¶ï¼Œè¿›ç¨‹å†…ç”Ÿäº§æ¶ˆè´¹æ¨¡å¼ï¼Œå¼‚å¸¸è¦å¤„ç†å¥½ï¼Œä¸ç„¶å¯èƒ½ä¼šå‡ºç°æ¶ˆæ¯å †ç§¯å’Œè„æ•°æ®ï¼Œæ¯•ç«Ÿmqçš„æ¶ˆè´¹ç¡®è®¤å’Œé‡è¯•æœºåˆ¶éƒ½æ˜¯å¼€ç®±å³ç”¨ï¼Œè€Œæˆ‘ä»¬å¾—è‡ªå·±å®ç°å’ŒæŠŠå…³ã€‚","like_count":24,"discussions":[{"author":{"id":1228576,"avatar":"https://static001.geekbang.org/account/avatar/00/12/bf/20/19d42715.jpg","nickname":"åˆ˜è¶…","note":"","ucode":"CD56F93596E818","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":460788,"discussion_content":"çœ‹æ¥æœ‰å®æˆ˜ç»éªŒğŸ‘ğŸ»","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1564713010,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1134861,"avatar":"https://static001.geekbang.org/account/avatar/00/11/51/0d/fc1652fe.jpg","nickname":"James","note":"","ucode":"48B0F2A334D1C1","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":350458,"discussion_content":"6","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1613882521,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1015483,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/7e/bb/947c329a.jpg","nickname":"ç¨‹åºå‘˜å°è·ƒ","note":"","ucode":"25BB96E0791A60","race_medal":0,"user_type":1,"is_pvip":true},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":323251,"discussion_content":"æ¯æ¬¡è¯„è®ºåŒºçœ‹åˆ°è€å“¥çš„ç•™è¨€ï¼Œå°±å¾ˆäº«å—å•Š","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1604907256,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":118779,"user_name":"æ¨ä¿Š","can_delete":false,"product_type":"c1","uid":1158214,"ip_address":"","ucode":"3CAE634618D924","user_header":"https://static001.geekbang.org/account/avatar/00/11/ac/46/7e24bad6.jpg","comment_is_top":false,"comment_ctime":1564447140,"is_pvip":true,"replies":[{"id":"43740","content":"å¯¹çš„","user_name":"ä½œè€…å›å¤","user_name_real":"åˆ˜è¶…","uid":"1228576","ctime":1564542177,"ip_address":"","comment_id":118779,"utype":1}],"discussion_count":2,"race_medal":0,"score":"74578891172","product_id":100028001,"comment_content":"æˆ‘çš„ç†è§£æ˜¯åº“å­˜æ”¾ç¼“å­˜ï¼Œç”¨æˆ·æäº¤è®¢å•åœ¨ç¼“å­˜æ‰£å‡åº“å­˜ï¼Œç”¨æˆ·ç«¯èƒ½å¤Ÿå¿«é€Ÿè¿”å›æ˜¾ç¤ºè®¢å•æäº¤æˆåŠŸå¹¶æ”¯ä»˜ï¼Œç„¶ååªæœ‰æ”¯ä»˜æˆåŠŸä¹‹åæ‰ä¼šåˆ©ç”¨é˜Ÿåˆ—å®é™…çš„æ‰£å‡æ•°æ®åº“åº“å­˜æ˜¯å—ï¼Ÿè¦æ˜¯ä¸æ”¯ä»˜ä¼šåœ¨ç¼“å­˜è¡¥å›åº“å­˜å§ï¼Œåº”è¯¥ä¼šé™æ—¶æ”¯ä»˜å§","like_count":17,"discussions":[{"author":{"id":1228576,"avatar":"https://static001.geekbang.org/account/avatar/00/12/bf/20/19d42715.jpg","nickname":"åˆ˜è¶…","note":"","ucode":"CD56F93596E818","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":460572,"discussion_content":"å¯¹çš„","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1564542177,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":2410612,"avatar":"","nickname":"Geek_abe867","note":"","ucode":"4F562F79520464","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":342800,"discussion_content":"è¿™æ ·å¦‚ä½•æ§åˆ¶è¶…å–å‘¢ï¼Ÿæ•°æ®åº“çš„ç¼“å­˜æ²¡æœ‰æ‰£é™¤","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1610815368,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":119036,"user_name":"QQæ€ª","can_delete":false,"product_type":"c1","uid":1211223,"ip_address":"","ucode":"1A39B8433D9208","user_header":"https://static001.geekbang.org/account/avatar/00/12/7b/57/a9b04544.jpg","comment_is_top":false,"comment_ctime":1564492062,"is_pvip":false,"replies":[{"id":"43733","content":"å¤§å®¶éƒ½ä¸€è‡´æƒ³åˆ°äº†é™æµï¼Œé™æµæ˜¯éå¸¸å¿…è¦çš„ï¼Œæ— è®ºæˆ‘ä»¬çš„ç¨‹åºä¼˜åŒ–çš„å¦‚ä½•ï¼Œè¿˜æ˜¯æœ‰ä¸Šé™çš„ï¼Œé™æµåˆ™æ˜¯ä¸€ç§å…œåº•ç­–ç•¥ã€‚<br><br>é™¤äº†è¿™ä¸ªï¼Œæˆ‘ä»¬è¿˜å¯ä»¥ä½¿ç”¨åç¨‹æ¥ä¼˜åŒ–çº¿ç¨‹ç”±äºé˜»å¡ç­‰å¾…å¸¦æ¥çš„ä¸Šä¸‹æ–‡åˆ‡æ¢æ€§èƒ½é—®é¢˜ï¼Œå¯ä»¥å›é¡¾ç¬¬19è®²ï¼Œæˆ‘ä»¬ä¹Ÿç”¨åç¨‹å®ç°è¿‡ç”Ÿäº§è€…æ¶ˆè´¹è€…æ¨¡å¼ã€‚","user_name":"ä½œè€…å›å¤","user_name_real":"åˆ˜è¶…","uid":"1228576","ctime":1564541134,"ip_address":"","comment_id":119036,"utype":1}],"discussion_count":5,"race_medal":0,"score":"40219197726","product_id":100028001,"comment_content":"åœ¨ç½‘å…³å±‚ä¸­æŠŠè¯·æ±‚æ”¾å…¥åˆ°mqä¸­ï¼Œåç«¯æœåŠ¡ä»æ¶ˆè´¹é˜Ÿåˆ—ä¸­æ¶ˆè´¹æ¶ˆæ¯å¹¶å¤„ç†ï¼›æˆ–è€…ç”¨æœ‰å›ºå®šå®¹é‡çš„æ¶ˆè´¹é˜Ÿåˆ—çš„ä»¤ç‰Œæ¡¶ï¼Œä»¤ç‰Œå‘ç”Ÿå™¨é¢„ä¼°é¢„è®¡çš„å¤„ç†èƒ½åŠ›ï¼ŒåŒ€é€Ÿç”Ÿäº§æ”¾å…¥ä»¤ç‰Œé˜Ÿåˆ—ä¸­ï¼Œæ»¡äº†ç›´æ¥ä¸¢å¼ƒï¼Œç½‘å…³æ”¶åˆ°è¯·æ±‚ä¹‹åæ¶ˆè´¹ä¸€ä¸ªä»¤ç‰Œï¼Œè·å¾—ä»¤ç‰Œçš„è¯·æ±‚æ‰èƒ½è¿›è¡Œåç«¯ç§’æ€è¯·æ±‚ï¼Œåä¹‹ç›´æ¥è¿”å›ç§’æ€å¤±è´¥","like_count":9,"discussions":[{"author":{"id":1228576,"avatar":"https://static001.geekbang.org/account/avatar/00/12/bf/20/19d42715.jpg","nickname":"åˆ˜è¶…","note":"","ucode":"CD56F93596E818","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":460720,"discussion_content":"å¤§å®¶éƒ½ä¸€è‡´æƒ³åˆ°äº†é™æµï¼Œé™æµæ˜¯éå¸¸å¿…è¦çš„ï¼Œæ— è®ºæˆ‘ä»¬çš„ç¨‹åºä¼˜åŒ–çš„å¦‚ä½•ï¼Œè¿˜æ˜¯æœ‰ä¸Šé™çš„ï¼Œé™æµåˆ™æ˜¯ä¸€ç§å…œåº•ç­–ç•¥ã€‚\n\né™¤äº†è¿™ä¸ªï¼Œæˆ‘ä»¬è¿˜å¯ä»¥ä½¿ç”¨åç¨‹æ¥ä¼˜åŒ–çº¿ç¨‹ç”±äºé˜»å¡ç­‰å¾…å¸¦æ¥çš„ä¸Šä¸‹æ–‡åˆ‡æ¢æ€§èƒ½é—®é¢˜ï¼Œå¯ä»¥å›é¡¾ç¬¬19è®²ï¼Œæˆ‘ä»¬ä¹Ÿç”¨åç¨‹å®ç°è¿‡ç”Ÿäº§è€…æ¶ˆè´¹è€…æ¨¡å¼ã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1564541134,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1211223,"avatar":"https://static001.geekbang.org/account/avatar/00/12/7b/57/a9b04544.jpg","nickname":"QQæ€ª","note":"","ucode":"1A39B8433D9208","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":3505,"discussion_content":"å­¦ä»¥è‡´ç”¨","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1564541184,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1364034,"avatar":"https://static001.geekbang.org/account/avatar/00/14/d0/42/6fd01fb9.jpg","nickname":"æˆ‘å·²ç»è®¾ç½®äº†æ˜µç§°","note":"","ucode":"ED672C5EBDBDC4","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":3485,"discussion_content":"å“ˆå“ˆ","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1564533489,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1259218,"avatar":"https://static001.geekbang.org/account/avatar/00/13/36/d2/c7357723.jpg","nickname":"å‘æ¡æ©™å­ ã€‚","note":"","ucode":"ED076F4534FFED","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":3476,"discussion_content":"è€å“¥ ä½ è¿™æ˜¯æŠŠmqè€å¸ˆçš„ä¸“æ å†…å®¹ç›´æ¥æ¬è¿‡æ¥äº†å§","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1564527774,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":1,"child_discussions":[{"author":{"id":1157430,"avatar":"https://static001.geekbang.org/account/avatar/00/11/a9/36/972f7abf.jpg","nickname":"æœ¨åˆ»","note":"","ucode":"0A3226FEE3983B","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":1259218,"avatar":"https://static001.geekbang.org/account/avatar/00/13/36/d2/c7357723.jpg","nickname":"å‘æ¡æ©™å­ ã€‚","note":"","ucode":"ED076F4534FFED","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":3545,"discussion_content":"å“ˆå“ˆå“ˆï¼Œæˆ‘è¯´æ€ä¹ˆçœ‹ç€è¿™ä¹ˆçœ¼ç†Ÿ","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1564566054,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":3476,"ip_address":""},"score":3545,"extra":""}]}]},{"had_liked":false,"id":265821,"user_name":"æ°´æµ´æ¸…é£","can_delete":false,"product_type":"c1","uid":1133926,"ip_address":"","ucode":"36EF5179E6F952","user_header":"https://static001.geekbang.org/account/avatar/00/11/4d/66/28742ad4.jpg","comment_is_top":false,"comment_ctime":1607043965,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"14491945853","product_id":100028001,"comment_content":"ç”Ÿäº§è€…ç«¯çš„ä¼˜åŒ–ï¼š<br>1ã€å‡å°‘å¤„ç†é€»è¾‘ï¼ŒåŠ å¿«å“åº”é€Ÿåº¦<br>2ã€å¯¹é˜Ÿåˆ—å¢åŠ åˆ†ç‰‡<br>3ã€å¢åŠ é™æµ<br>4ã€åç¨‹","like_count":3},{"had_liked":false,"id":119304,"user_name":"JasonK","can_delete":false,"product_type":"c1","uid":1184135,"ip_address":"","ucode":"14BB7522FAECE7","user_header":"https://static001.geekbang.org/account/avatar/00/12/11/87/43744994.jpg","comment_is_top":false,"comment_ctime":1564555323,"is_pvip":false,"replies":[{"id":"44488","content":"å¯¼è‡´CPUé£™å‡åªæ˜¯ä¸€ä¸ªæ€§èƒ½çš„ç›´æ¥è¡¨ç°ï¼Œæ˜¯ä¸æ˜¯æœ‰å¯¹è±¡ä¸€ç›´åœ¨åˆ›å»ºï¼Œæ‰€ä»¥å¯¼è‡´ä¸€ç›´åœ¨GCã€‚å»ºè®®æ‰“å¼€dumpæ—¥å¿—æŸ¥çœ‹å…·ä½“çš„å†…å­˜ä½¿ç”¨æƒ…å†µä»¥åŠå¯¹è±¡çš„åˆ›å»ºåˆ†å¸ƒæƒ…å†µã€‚","user_name":"ä½œè€…å›å¤","user_name_real":"åˆ˜è¶…","uid":"1228576","ctime":1565056905,"ip_address":"","comment_id":119304,"utype":1}],"discussion_count":3,"race_medal":0,"score":"14449457211","product_id":100028001,"comment_content":"ä½ å¥½ï¼Œåˆ˜è€å¸ˆï¼Œæœ€è¿‘ç”Ÿäº§ä¸Šä¸€ä¸ªæœåŠ¡ï¼Œè€æ˜¯åŠå¤œcpué£™å‡ï¼Œå¯¼è‡´æœåŠ¡æ­»æ‰ï¼Œæ’æŸ¥é—®é¢˜çœ‹äº†ä¸‹ï¼Œéƒ½æ˜¯GC task thread#15 (ParallelGCï¼‰ çº¿ç¨‹å ç”¨CPUèµ„æºï¼Œè¿™æ˜¯ä¸ºä»€ä¹ˆï¼Ÿè€Œä¸”åŒæ ·çš„æœåŠ¡æˆ‘å¸ƒäº†ä¸¤å°æœºå™¨ï¼Œä¸€å°æœåŠ¡ä¼šæ­»æ‰ï¼Œä¸€å°ä¸ä¼šã€‚è¯·è€å¸ˆè§£æƒ‘ã€‚","like_count":3,"discussions":[{"author":{"id":1228576,"avatar":"https://static001.geekbang.org/account/avatar/00/12/bf/20/19d42715.jpg","nickname":"åˆ˜è¶…","note":"","ucode":"CD56F93596E818","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":460836,"discussion_content":"å¯¼è‡´CPUé£™å‡åªæ˜¯ä¸€ä¸ªæ€§èƒ½çš„ç›´æ¥è¡¨ç°ï¼Œæ˜¯ä¸æ˜¯æœ‰å¯¹è±¡ä¸€ç›´åœ¨åˆ›å»ºï¼Œæ‰€ä»¥å¯¼è‡´ä¸€ç›´åœ¨GCã€‚å»ºè®®æ‰“å¼€dumpæ—¥å¿—æŸ¥çœ‹å…·ä½“çš„å†…å­˜ä½¿ç”¨æƒ…å†µä»¥åŠå¯¹è±¡çš„åˆ›å»ºåˆ†å¸ƒæƒ…å†µã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1565056905,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1542987,"avatar":"https://static001.geekbang.org/account/avatar/00/17/8b/4b/fa52d222.jpg","nickname":"è¡Œåˆ™å°†è‡³","note":"","ucode":"DB972F2DF059C4","race_medal":1,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":12619,"discussion_content":"æŒ‰ç…§è€å¸ˆè¯´çš„åšå°±è¡Œã€‚æŠŠGCæ—¥å¿—dumpä¸‹æ¥ï¼Œç„¶åä½¿ç”¨Eclipseçš„MATå·¥å…·æŸ¥çœ‹ï¼ŒåŸºæœ¬ä¸Šå°±å®šä½ä¸ªå·®ä¸å¤š","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1568556085,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1116864,"avatar":"https://static001.geekbang.org/account/avatar/00/11/0a/c0/401c240e.jpg","nickname":"æ’’æ—¦çš„å •è½","note":"","ucode":"15F6AA41EE556F","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":3546,"discussion_content":"ä¼šä¸ä¼šæ˜¯å®šæ—¶ä»»åŠ¡çš„åŸå› ","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1564566085,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":119044,"user_name":"æ˜ç¿¼","can_delete":false,"product_type":"c1","uid":1068361,"ip_address":"","ucode":"E77F86BEB3D5C1","user_header":"https://static001.geekbang.org/account/avatar/00/10/4d/49/28e73b9c.jpg","comment_is_top":false,"comment_ctime":1564492981,"is_pvip":false,"replies":[{"id":"43731","content":"è¿™é‡ŒåŒæ­¥æ›´æ–°ä¸‹ï¼Œæ–°å¢äº†ä»¥ä¸‹ä»£ç ä½œä¸ºå®æ—¶åº“å­˜ï¼š<br>private AtomicInteger inventory = new AtomicInteger(0);<br><br>æˆ‘ä»¬è¿™é‡Œæ˜¯åŸºäºLinkedListæ¥å­˜å–åº“å­˜çš„ï¼Œè™½ç„¶LinkedListæ˜¯éçº¿ç¨‹å®‰å…¨ï¼Œä½†æˆ‘ä»¬æ–°å¢æ˜¯æ“ä½œå¤´éƒ¨ï¼Œè€Œæ¶ˆè´¹åˆ™æ˜¯æ“ä½œé˜Ÿåˆ—çš„å°¾éƒ¨ï¼Œç†è®ºä¸Šæ¥è¯´æ²¡æœ‰çº¿ç¨‹å®‰å…¨é—®é¢˜ã€‚è€Œåº“å­˜çš„å®é™…æ•°é‡inventoryæ˜¯åŸºäºAtomicIntegerï¼ˆCASé”ï¼‰çº¿ç¨‹å®‰å…¨ç±»å®ç°ï¼Œå³å¯ä»¥ä¿è¯åŸå­æ€§ï¼Œä¹Ÿå¯ä»¥ä¿è¯æ¶ˆè´¹è€…å’Œç”Ÿäº§è€…ä¹‹é—´æ˜¯å¯è§çš„ã€‚","user_name":"ä½œè€…å›å¤","user_name_real":"åˆ˜è¶…","uid":"1228576","ctime":1564540568,"ip_address":"","comment_id":119044,"utype":1}],"discussion_count":2,"race_medal":0,"score":"14449394869","product_id":100028001,"comment_content":"è€å¸ˆï¼Œç”Ÿäº§è€…å’Œæ¶ˆè´¹è€…çš„é”åˆ†å¼€æ²¡é—®é¢˜å—ï¼Ÿéƒ½æ˜¯ç”¨çš„åŒä¸€ä¸ªé˜Ÿåˆ—ï¼Ÿ","like_count":3,"discussions":[{"author":{"id":1228576,"avatar":"https://static001.geekbang.org/account/avatar/00/12/bf/20/19d42715.jpg","nickname":"åˆ˜è¶…","note":"","ucode":"CD56F93596E818","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":460723,"discussion_content":"è¿™é‡ŒåŒæ­¥æ›´æ–°ä¸‹ï¼Œæ–°å¢äº†ä»¥ä¸‹ä»£ç ä½œä¸ºå®æ—¶åº“å­˜ï¼š\nprivate AtomicInteger inventory = new AtomicInteger(0);\n\næˆ‘ä»¬è¿™é‡Œæ˜¯åŸºäºLinkedListæ¥å­˜å–åº“å­˜çš„ï¼Œè™½ç„¶LinkedListæ˜¯éçº¿ç¨‹å®‰å…¨ï¼Œä½†æˆ‘ä»¬æ–°å¢æ˜¯æ“ä½œå¤´éƒ¨ï¼Œè€Œæ¶ˆè´¹åˆ™æ˜¯æ“ä½œé˜Ÿåˆ—çš„å°¾éƒ¨ï¼Œç†è®ºä¸Šæ¥è¯´æ²¡æœ‰çº¿ç¨‹å®‰å…¨é—®é¢˜ã€‚è€Œåº“å­˜çš„å®é™…æ•°é‡inventoryæ˜¯åŸºäºAtomicIntegerï¼ˆCASé”ï¼‰çº¿ç¨‹å®‰å…¨ç±»å®ç°ï¼Œå³å¯ä»¥ä¿è¯åŸå­æ€§ï¼Œä¹Ÿå¯ä»¥ä¿è¯æ¶ˆè´¹è€…å’Œç”Ÿäº§è€…ä¹‹é—´æ˜¯å¯è§çš„ã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1564540568,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1937062,"avatar":"https://static001.geekbang.org/account/avatar/00/1d/8e/a6/c3286b61.jpg","nickname":"Javaå’å¢™å·¥ç¨‹å¸ˆ","note":"","ucode":"E76AE44A9C76AE","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":304082,"discussion_content":"ç›¸å½“äºæ˜¯ä¿©é˜Ÿåˆ—","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1599464302,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":118768,"user_name":"ç½—æ´²","can_delete":false,"product_type":"c1","uid":1263417,"ip_address":"","ucode":"68133E38A25C17","user_header":"https://static001.geekbang.org/account/avatar/00/13/47/39/0ce1aa62.jpg","comment_is_top":false,"comment_ctime":1564446496,"is_pvip":false,"replies":[{"id":"43741","content":"èµï¼Œå¾ˆå¥½çš„å‚è€ƒä¾‹å­","user_name":"ä½œè€…å›å¤","user_name_real":"åˆ˜è¶…","uid":"1228576","ctime":1564542235,"ip_address":"","comment_id":118768,"utype":1}],"discussion_count":2,"race_medal":0,"score":"14449348384","product_id":100028001,"comment_content":"ç”Ÿäº§æ–¹çš„é«˜å¹¶å‘ä¼˜åŒ–ï¼Œæˆ‘ä»¬å¯ä»¥å‚è€ƒä¸‹tomcatçš„è®¾è®¡ï¼Œtomcatè®¾è®¡äº†çº¿ç¨‹æ± æ¥è¿›è¡Œè¯·æ±‚æ¥æ”¶ï¼Œæœ‰æœ€å°çº¿ç¨‹æ•°ï¼Œæœ€å¤§çº¿ç¨‹æ•°ï¼ŒåŒæ—¶è¿˜æœ‰ä¸€ä¸ªæœ‰ç•Œçš„å·¥ä½œé˜Ÿåˆ—ï¼Œæ¥æ¥æ”¶è¶…è¿‡çº¿ç¨‹æ•°çš„è¯·æ±‚ï¼Œå½“å·¥ä½œé˜Ÿåˆ—æ»¡äº†åå¯ä»¥é€‰æ‹©æ‹’ç»æˆ–è€…ä¸¢å¼ƒå¤„ç†ã€‚","like_count":3,"discussions":[{"author":{"id":1228576,"avatar":"https://static001.geekbang.org/account/avatar/00/12/bf/20/19d42715.jpg","nickname":"åˆ˜è¶…","note":"","ucode":"CD56F93596E818","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":460565,"discussion_content":"èµï¼Œå¾ˆå¥½çš„å‚è€ƒä¾‹å­","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1564542235,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1259218,"avatar":"https://static001.geekbang.org/account/avatar/00/13/36/d2/c7357723.jpg","nickname":"å‘æ¡æ©™å­ ã€‚","note":"","ucode":"ED076F4534FFED","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":3477,"discussion_content":"ç»“åˆäº†tomcatä¸“æ çš„çŸ¥è¯† æ˜¯ä¸ªå¥½æ–¹æ³•","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1564527982,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":118826,"user_name":"æ’’æ—¦çš„å •è½","can_delete":false,"product_type":"c1","uid":1116864,"ip_address":"","ucode":"15F6AA41EE556F","user_header":"https://static001.geekbang.org/account/avatar/00/11/0a/c0/401c240e.jpg","comment_is_top":false,"comment_ctime":1564450118,"is_pvip":false,"replies":[{"id":"43739","content":"å¯ä»¥çš„ï¼Œå¾ˆé€šç”¨çš„ä¸€ç§è§£å†³æ–¹æ¡ˆ","user_name":"ä½œè€…å›å¤","user_name_real":"åˆ˜è¶…","uid":"1228576","ctime":1564541676,"ip_address":"","comment_id":118826,"utype":1}],"discussion_count":1,"race_medal":0,"score":"10154384710","product_id":100028001,"comment_content":"ç½‘å…³ä¸æœåŠ¡ä¹‹é—´å¢åŠ ä»¤ç‰Œæ¡¶  æˆ–è€…mq ä»¥ä¿æŠ¤ç§’æ€æœåŠ¡ä¸ä¼šè¢«å¤§çš„æµé‡å‹å® å¯ä»¥ä¹ˆ","like_count":2,"discussions":[{"author":{"id":1228576,"avatar":"https://static001.geekbang.org/account/avatar/00/12/bf/20/19d42715.jpg","nickname":"åˆ˜è¶…","note":"","ucode":"CD56F93596E818","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":460600,"discussion_content":"å¯ä»¥çš„ï¼Œå¾ˆé€šç”¨çš„ä¸€ç§è§£å†³æ–¹æ¡ˆ","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1564541676,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":341312,"user_name":"å§¬î€´","can_delete":false,"product_type":"c1","uid":1284730,"ip_address":"","ucode":"968079E564FD2F","user_header":"https://static001.geekbang.org/account/avatar/00/13/9a/7a/dd08bc09.jpg","comment_is_top":false,"comment_ctime":1649515920,"is_pvip":true,"discussion_count":0,"race_medal":0,"score":"5944483216","product_id":100028001,"comment_content":"removeFirst()ï¼Œç»™æœ‰ç¼˜äººã€‚","like_count":1},{"had_liked":false,"id":270811,"user_name":"æƒ˜ é—»","can_delete":false,"product_type":"c1","uid":1181650,"ip_address":"","ucode":"C5909F034BF072","user_header":"https://static001.geekbang.org/account/avatar/00/12/07/d2/0d7ee298.jpg","comment_is_top":false,"comment_ctime":1609288003,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"5904255299","product_id":100028001,"comment_content":"æˆ‘ä»¬ä¼šæŠŠå¤šä¸ªæŠ¥è¡¨ä»»åŠ¡éƒ½ä¸€å¹¶æ”¾åˆ°ç¼“å†²é˜Ÿåˆ—ä¸­ç”±æ¶ˆè´¹è€…ç¨‹åºå¼‚æ­¥å®Œæˆ,è¿™æ ·ä¸ä¼šåŒæ—¶æ‰§è¡Œå ç”¨ç³»ç»Ÿå¤§é‡æ€§èƒ½.ä¹Ÿä¸éœ€è¦æ“ä½œäººé€ä¸ªç­‰å¾….","like_count":1},{"had_liked":false,"id":142688,"user_name":"2102","can_delete":false,"product_type":"c1","uid":1070298,"ip_address":"","ucode":"A67068F2A3157E","user_header":"https://static001.geekbang.org/account/avatar/00/10/54/da/e2e5ddf7.jpg","comment_is_top":false,"comment_ctime":1571458867,"is_pvip":false,"replies":[{"id":"55136","content":"å¢åŠ æ¶ˆè´¹è€…æ˜¯ä¸€ç§æ–¹å¼","user_name":"ä½œè€…å›å¤","user_name_real":"åˆ˜è¶…","uid":"1228576","ctime":1571471611,"ip_address":"","comment_id":142688,"utype":1}],"discussion_count":1,"race_medal":0,"score":"5866426163","product_id":100028001,"comment_content":"å¢åŠ æ¶ˆè´¹è€…","like_count":1,"discussions":[{"author":{"id":1228576,"avatar":"https://static001.geekbang.org/account/avatar/00/12/bf/20/19d42715.jpg","nickname":"åˆ˜è¶…","note":"","ucode":"CD56F93596E818","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":471228,"discussion_content":"å¢åŠ æ¶ˆè´¹è€…æ˜¯ä¸€ç§æ–¹å¼","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1571471611,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":132940,"user_name":"é’±","can_delete":false,"product_type":"c1","uid":1009652,"ip_address":"","ucode":"2C92A243A463D4","user_header":"https://static001.geekbang.org/account/avatar/00/0f/67/f4/9a1feb59.jpg","comment_is_top":false,"comment_ctime":1568279882,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"5863247178","product_id":100028001,"comment_content":"è¯¾åæ€è€ƒåŠé—®é¢˜<br>æˆ‘ä»¬å¯ä»¥ç”¨ç”Ÿäº§è€…æ¶ˆè´¹è€…æ¨¡å¼æ¥å®ç°ç¬æ—¶é«˜å¹¶å‘çš„æµé‡å‰Šå³°ï¼Œç„¶è€Œè¿™æ ·åšè™½ç„¶ç¼“è§£äº†æ¶ˆè´¹æ–¹çš„å‹åŠ›ï¼Œä½†ç”Ÿäº§æ–¹åˆ™ä¼šå› ä¸ºç¬æ—¶é«˜å¹¶å‘ï¼Œè€Œå‘ç”Ÿå¤§é‡çº¿ç¨‹é˜»å¡ã€‚é¢å¯¹è¿™æ ·çš„æƒ…å†µï¼Œä½ çŸ¥é“æœ‰ä»€ä¹ˆæ–¹å¼å¯ä»¥ä¼˜åŒ–çº¿ç¨‹é˜»å¡æ‰€å¸¦æ¥çš„æ€§èƒ½é—®é¢˜å—ï¼Ÿ<br>1ï¼šå‡å°‘ç”Ÿäº§è€…çš„æµé‡å‹åŠ›â€”â€”é™æµ<br>2ï¼šè§†ä¸šåŠ¡åœºæ™¯è€Œå®šåˆ¤æ–­æ˜¯å¦å¯ä»¥æ‹’ç»éƒ¨åˆ†å¤šä½™æµé‡<br>3ï¼šä½¿ç”¨å·¥ä¸šçº§æ¶ˆæ¯é˜Ÿåˆ—ä¸­é—´ä»¶<br>4ï¼šåŠ ç¼“å­˜<br>5ï¼šåŠ æœºå™¨","like_count":1},{"had_liked":false,"id":122196,"user_name":"æ€â˜åŠ°â˜œå»","can_delete":false,"product_type":"c1","uid":1221562,"ip_address":"","ucode":"1941131ECD1A15","user_header":"https://static001.geekbang.org/account/avatar/00/12/a3/ba/89adac9b.jpg","comment_is_top":false,"comment_ctime":1565315141,"is_pvip":false,"replies":[{"id":"50398","content":"å»ºè®®å†ç­‰ç­‰å®˜æ–¹çš„åæˆç»„ä»¶ï¼Œæˆ–æ”¹ç”¨goå®ç°ï¼Œç›®å‰Javaçš„ä¸€äº›ç¬¬ä¸‰æ–¹å¼€æºç»„ä»¶çš„ç”Ÿäº§ç¯å¢ƒçš„å®è·µä»¥åŠæ€§èƒ½éªŒè¯æœ‰å¾…è€ƒéªŒï¼Œå¦‚æœä¸ä»‹æ„å½“å°ç™½é¼ ï¼Œä¹Ÿå¯ä»¥è¯•è¯•è¿™äº›ç¬¬ä¸‰æ–¹åæˆç»„ä»¶ã€‚","user_name":"ä½œè€…å›å¤","user_name_real":"åˆ˜è¶…","uid":"1228576","ctime":1567948176,"ip_address":"","comment_id":122196,"utype":1}],"discussion_count":1,"race_medal":0,"score":"5860282437","product_id":100028001,"comment_content":"è€å¸ˆï¼Œæˆ‘çœ‹åˆ°ä½ ä¸Šé¢è¯´ç”¨åç¨‹æ¥ä¼˜åŒ–ï¼æˆ‘ä»¬è¿™è¾¹æœ‰ä¸ªæœåŠ¡å±äºä¸šåŠ¡ç½‘å…³ï¼Œè¦èšåˆå¤šä¸ªä¸‹æœ‰çš„æ•°æ®ï¼Œæ¶‰åŠå¤§é‡çš„ç½‘ç»œioï¼Œä¹‹å‰æ˜¯ä½¿ç”¨å¤šçº¿ç¨‹å¹¶è¡Œè°ƒç”¨å¤šä¸ªä¸‹æœ‰ï¼Œç°åœ¨å‘ç°çº¿ç¨‹è¶Šæ¥è¶Šå¤šï¼Œé‡åˆ°äº†ç“¶é¢ˆï¼å¸Œæœ›ç”¨åç¨‹æ¥æ”¹è¿›æ–¹æ¡ˆï½ä½†æ˜¯æˆ‘åœ¨ç½‘ä¸Šæ‰¾åˆ°çš„ä¸€äº›javaåç¨‹å¼€æºç»„ä»¶ï¼Œæ–‡æ¡£å’Œç”Ÿæ€éƒ½ä¸æ˜¯å¾ˆå¥å…¨ï¼Œå¸Œæœ›è€å¸ˆèƒ½ç»™å‡ºä¸€äº›å»ºè®®ï½ éå¸¸æ„Ÿè°¢","like_count":1,"discussions":[{"author":{"id":1228576,"avatar":"https://static001.geekbang.org/account/avatar/00/12/bf/20/19d42715.jpg","nickname":"åˆ˜è¶…","note":"","ucode":"CD56F93596E818","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":462143,"discussion_content":"å»ºè®®å†ç­‰ç­‰å®˜æ–¹çš„åæˆç»„ä»¶ï¼Œæˆ–æ”¹ç”¨goå®ç°ï¼Œç›®å‰Javaçš„ä¸€äº›ç¬¬ä¸‰æ–¹å¼€æºç»„ä»¶çš„ç”Ÿäº§ç¯å¢ƒçš„å®è·µä»¥åŠæ€§èƒ½éªŒè¯æœ‰å¾…è€ƒéªŒï¼Œå¦‚æœä¸ä»‹æ„å½“å°ç™½é¼ ï¼Œä¹Ÿå¯ä»¥è¯•è¯•è¿™äº›ç¬¬ä¸‰æ–¹åæˆç»„ä»¶ã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1567948176,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":120107,"user_name":"ä¸€ä¸ªå–ç«æŸ´çš„è€ç”·äºº","can_delete":false,"product_type":"c1","uid":1181265,"ip_address":"","ucode":"1227638C457F49","user_header":"https://static001.geekbang.org/account/avatar/00/12/06/51/1d24ead6.jpg","comment_is_top":false,"comment_ctime":1564793127,"is_pvip":false,"replies":[{"id":"71182","content":"å¯è¡Œ","user_name":"ä½œè€…å›å¤","user_name_real":"åˆ˜è¶…","uid":"1228576","ctime":1583158171,"ip_address":"","comment_id":120107,"utype":1}],"discussion_count":2,"race_medal":0,"score":"5859760423","product_id":100028001,"comment_content":"å•†å“ä»æ•°æ®åº“å‹å…¥redis<br>ç¼“å­˜ã€‚<br>åŒæ—¶åº“å­˜å‹å…¥redisï¼Œç”¨å•†å“IDä½œä¸ºkeyï¼Œç”¨listæ¨¡æ‹Ÿé˜Ÿåˆ—ã€1001ï¼Œ1001ï¼Œ1001ã€‘ç”¨å•†å“ğŸ†”åšé˜Ÿåˆ—å…ƒç´ ï¼Œ100ä»¶åº“å­˜ï¼Œé‚£å°±å­˜100ä¸ªğŸ†”åœ¨é˜Ÿåˆ—ä¸­ï¼Œæ‰£åº“å­˜çš„æ—¶å€™ï¼Œåˆ¤æ–­é˜Ÿåˆ—å¤§å°ï¼Œå¯ä»¥é˜²æ­¢è¶…å–ã€‚æ‰€æœ‰éƒ½æ˜¯é redisçš„å•çº¿ç¨‹åŸå­æ“ä½œä¿è¯ï¼Œå¯è¡Œä¸","like_count":1,"discussions":[{"author":{"id":1228576,"avatar":"https://static001.geekbang.org/account/avatar/00/12/bf/20/19d42715.jpg","nickname":"åˆ˜è¶…","note":"","ucode":"CD56F93596E818","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":461201,"discussion_content":"å¯è¡Œ","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1583158171,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1014665,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/7b/89/34f2cbcc.jpg","nickname":"æ¨å®‡","note":"","ucode":"EB74DF6E269F03","race_medal":0,"user_type":1,"is_pvip":true},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":36665,"discussion_content":"Redisè‡ªå¸¦å‡ä¸€çš„æ–¹æ³•ï¼Œç”¨æ•°å­—å²‚ä¸æ˜¯æ›´å¥½","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1571401285,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":119047,"user_name":"nightmare","can_delete":false,"product_type":"c1","uid":1056314,"ip_address":"","ucode":"EF2E51C2122A86","user_header":"https://static001.geekbang.org/account/avatar/00/10/1e/3a/5b21c01c.jpg","comment_is_top":false,"comment_ctime":1564493131,"is_pvip":false,"replies":[{"id":"43732","content":"é™æµæ˜¯ä¸€ç§æ–¹å¼ï¼Œçº¿ç¨‹æ± å…¶å®ä¹Ÿæ˜¯ä¸€ç§é™æµæ‰‹æ®µã€‚æˆ‘ä»¬åœ¨ä¹‹å‰åç¨‹è¿™ä¸€è®²ä¸­ï¼Œå…¶å®ä¹Ÿç”¨åç¨‹ä»£æ›¿çº¿ç¨‹å®ç°äº†ç”Ÿäº§è€…æ¶ˆè´¹è€…æ¨¡å¼ï¼Œè¿™ä¹Ÿä¸ä¹æ˜¯ä¸€ç§ä¼˜åŒ–æ–¹å¼ã€‚","user_name":"ä½œè€…å›å¤","user_name_real":"åˆ˜è¶…","uid":"1228576","ctime":1564540877,"ip_address":"","comment_id":119047,"utype":1}],"discussion_count":1,"race_medal":0,"score":"5859460427","product_id":100028001,"comment_content":"å¯ä»¥åœ¨ç½‘å…³é€šè¿‡ä»¤ç‰Œæ¡¶ç®—æ³•é™æµï¼ŒçœŸæ­£æ‰§è¡Œçš„ç”Ÿäº§è€…ä¸€æ–¹ä½¿ç”¨çº¿ç¨‹æ± æ¥ä¼˜åŒ–","like_count":1,"discussions":[{"author":{"id":1228576,"avatar":"https://static001.geekbang.org/account/avatar/00/12/bf/20/19d42715.jpg","nickname":"åˆ˜è¶…","note":"","ucode":"CD56F93596E818","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":460726,"discussion_content":"é™æµæ˜¯ä¸€ç§æ–¹å¼ï¼Œçº¿ç¨‹æ± å…¶å®ä¹Ÿæ˜¯ä¸€ç§é™æµæ‰‹æ®µã€‚æˆ‘ä»¬åœ¨ä¹‹å‰åç¨‹è¿™ä¸€è®²ä¸­ï¼Œå…¶å®ä¹Ÿç”¨åç¨‹ä»£æ›¿çº¿ç¨‹å®ç°äº†ç”Ÿäº§è€…æ¶ˆè´¹è€…æ¨¡å¼ï¼Œè¿™ä¹Ÿä¸ä¹æ˜¯ä¸€ç§ä¼˜åŒ–æ–¹å¼ã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1564540877,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":356926,"user_name":"åŸæ¸¸é›ªäºº","can_delete":false,"product_type":"c1","uid":1063805,"ip_address":"ä¸Šæµ·","ucode":"C432C9577B420C","user_header":"https://static001.geekbang.org/account/avatar/00/10/3b/7d/6376926b.jpg","comment_is_top":false,"comment_ctime":1662708442,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1662708442","product_id":100028001,"comment_content":"åœ¨ä¸æ»¡ä¹Ÿä¸ç©ºçš„æƒ…å†µä¸‹ï¼Œ2æŠŠé”ç›¸å½“äºæ˜¯å¹¶è¡Œæ“ä½œLinkedListï¼Œç¡®å®šä¸ä¼šæŠ›å‡ºConcurrentModificationExceptionä¹ˆï¼Ÿ<br><br>åŠ ä¸Šprivate AtomicInteger inventory = new AtomicInteger(0);å¯ä»¥çœ‹å‡ºä½œè€…æ˜¯æƒ³ç”¨è¿™ä¸ªæ¥ä¿è¯å¤šçº¿ç¨‹çš„å¯è§æ€§ï¼Œä½†æ˜¯è¿™ä¸èƒ½ä¿è¯å¹¶å‘æ¡ä»¶ä¸‹çš„ç«äº‰é—®é¢˜ã€‚æ¯”å¦‚ç”Ÿäº§è€…é‡Œçš„if(inventory.get()&gt;0) è¿™ä¸ªåˆ¤æ–­ï¼Œå°±æœ‰å¯èƒ½å› ä¸ºæ¶ˆè´¹è€…åœ¨æ¶ˆè´¹å¯¼è‡´åˆ¤æ–­åï¼Œå®é™…ä¸Šinventory.get() ä¼šç­‰äº0<br><br>æ„Ÿè§‰ç¤ºä¾‹ä»£ç æœ‰å¾ˆå¤§çš„çº¿ç¨‹å®‰å…¨éšæ‚£ã€‚æ­£ç¡®çš„åšæ³•åº”è¯¥æ˜¯ç”¨ä¸€ä¸ªé”ï¼Œå¤šä¸ªconditionçš„æ–¹å¼å®ç°ã€‚","like_count":0},{"had_liked":false,"id":301895,"user_name":"å¹³æ°‘äººä¹‹åŠ©","can_delete":false,"product_type":"c1","uid":2658705,"ip_address":"","ucode":"5CCEC0BAC08AEC","user_header":"https://static001.geekbang.org/account/avatar/00/28/91/91/428a27a3.jpg","comment_is_top":false,"comment_ctime":1625964436,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1625964436","product_id":100028001,"comment_content":"ç”¨Asynå’Œçº¿ç¨‹æ± åšèµ„æºæŠŠæ§ï¼Œå®é™…ä¸Šå…¥å£åº”è¯¥å°±åšå¥½é™æµæ“ä½œï¼Œä»»ä½•ç³»ç»Ÿéƒ½ä¸å¯èƒ½å¯¹ä»˜æ‰€æœ‰çš„æ´ªå³°æµé‡åšååº”ã€‚","like_count":0},{"had_liked":false,"id":270809,"user_name":"æƒ˜ é—»","can_delete":false,"product_type":"c1","uid":1181650,"ip_address":"","ucode":"C5909F034BF072","user_header":"https://static001.geekbang.org/account/avatar/00/12/07/d2/0d7ee298.jpg","comment_is_top":false,"comment_ctime":1609287819,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1609287819","product_id":100028001,"comment_content":"é€šå¸¸æˆ‘ä»¬å¯ä»¥å›ºå®šä¸€äº›æŠ¥è¡¨å†…å®¹ï¼Œæ¯”å¦‚ç”¨æˆ·ç»å¸¸éœ€è¦åœ¨ä»Šå¤©å¯¼å‡ºæ˜¨å¤©çš„é”€é‡æŠ¥è¡¨ï¼Œæˆ–è€…åœ¨æœˆåˆå¯¼å‡ºä¸Šä¸ªæœˆçš„æŠ¥è¡¨ï¼Œæˆ‘ä»¬å°±å¯ä»¥æå‰å°†æŠ¥è¡¨å¯¼å‡ºåˆ°æœ¬åœ°æˆ–å†…å­˜ä¸­ï¼Œè¿™æ ·ç”¨æˆ·å°±å¯ä»¥åœ¨å¾ˆçŸ­çš„æ—¶é—´å†…ç›´æ¥ä¸‹è½½æŠ¥è¡¨äº†ã€‚<br>è€å¸ˆè¿™é‡Œè¯´çš„è¿™ä¸ªæ¡ˆä¾‹å’Œç”Ÿäº§è€…æ¶ˆè´¹è€…æœ‰è”ç³»å—?çœ‹èµ·æ¥åªéœ€è¦æå‰ç”Ÿæˆå°±å¯ä»¥äº†.åšä¸€ä¸ªå®šæ—¶ä»»åŠ¡,ä¸å°±å¯ä»¥åœ¨ç”¨æˆ·æŸ¥çœ‹ä¹‹å‰å›ºå®šå®ç°å®Œæˆå—.ä¸ºä»€ä¹ˆè¿™é‡Œä¼šç”¨åˆ°ç”Ÿäº§è€…å’Œæ¶ˆè´¹è€…å‘¢","like_count":0},{"had_liked":false,"id":189276,"user_name":"å†¬é£å‘å·¦å¹","can_delete":false,"product_type":"c1","uid":1066928,"ip_address":"","ucode":"376C45C5134F93","user_header":"https://static001.geekbang.org/account/avatar/00/10/47/b0/a9b77a1e.jpg","comment_is_top":false,"comment_ctime":1584494782,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1584494782","product_id":100028001,"comment_content":"è€å¸ˆï¼Œç”Ÿäº§è€…å’Œæ¶ˆè´¹è€…çš„ç­‰å¾…æ¡ä»¶å’Œé”èµ„æºåˆ†ç¦»çš„é‚£ä¸ªä¾‹å­ä¸­ï¼Œç”Ÿäº§è€…æ”¾å…¥ä¸€ä¸ªå…ƒç´ åï¼Œä¸ºä»€ä¹ˆä¸æ˜¯æ‰§è¡ŒnotEmptyCondition.signaAllé€šçŸ¥æ¶ˆè´¹è€…å‘¢ï¼Ÿï¼Ÿï¼Ÿ","like_count":0},{"had_liked":false,"id":158657,"user_name":"å¥‹æ–—çš„å°ç™½é¼ ","can_delete":false,"product_type":"c1","uid":1743483,"ip_address":"","ucode":"752BB901FFB7CE","user_header":"http://thirdwx.qlogo.cn/mmopen/vi_32/icHicAP9M4M4DIjAvlj5FDdFxIeA0pR3J15QdvVjXQXbznwunDN8OvrYqnsFchtBTNrZCCfGTE2RpPzIxjkvFAKg/132","comment_is_top":false,"comment_ctime":1575428585,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1575428585","product_id":100028001,"comment_content":"è€å¸ˆï¼Œæ‚¨é‚£ä¸ªç¬¬äºŒä¸ªç”Ÿäº§è€…æ¶ˆè´¹è€…æ¨¡å¼å®ç°æˆ‘è¿è¡Œäº†ä¼šå‡ºç°çº¿ç¨‹å®‰å…¨é—®é¢˜çš„ï¼Œè€Œä¸”çº¿ç¨‹è¿˜ä¸€ç›´é˜»å¡åœæ­¢ä¸äº†è¿è¡Œï¼Œæˆ‘æ„Ÿè§‰æ‚¨çš„æœ¬æ„æ˜¯æƒ³å®ç°å’ŒLinkedBlockingQueueä¸€æ ·çš„æ¨¡å¼ï¼Œä¸¤æŠŠé”ï¼Œæ‚¨æµ‹è¯•æ—¶æ²¡å‡ºç°é—®é¢˜è¿‡å—ï¼Ÿ","like_count":0},{"had_liked":false,"id":154915,"user_name":"neohope","can_delete":false,"product_type":"c1","uid":1043475,"ip_address":"","ucode":"C0268F6E7E2B6E","user_header":"https://static001.geekbang.org/account/avatar/00/0f/ec/13/49e98289.jpg","comment_is_top":false,"comment_ctime":1574596059,"is_pvip":true,"discussion_count":0,"race_medal":0,"score":"1574596059","product_id":100028001,"comment_content":"çœ‹å¤§å®¶éƒ½æåˆ°äº†ç”¨ä»¤ç‰Œç­’å’ŒMQåšé™æµå’Œç†”æ–­ã€‚å…¶å®å½“å¹¶å‘é‡æ›´å¤§æ—¶ï¼Œè¿˜æœ‰ä¸€ç§æ–¹å¼ï¼Œä½†è¦ç‰ºç‰²ä¸€å®šçš„å…¬å¹³æ€§ã€‚é¦–å…ˆæ ¹æ®ä¸€äº›ç›¸å¯¹å…¬å¹³çš„è§„åˆ™ï¼Œäº‹å…ˆåšä¸€æ¬¡èµ„æºåˆ†é…ã€‚ä¹Ÿå°±æ˜¯å¯¹ç”¨æˆ·åˆ†ç»„ï¼Œé¢„å…ˆåˆ†é…ä¸€éƒ¨åˆ†èµ„æºï¼Œæ¯ç»„ç”¨æˆ·æŠ¢å¤ºç»„å†…èµ„æºã€‚","like_count":0},{"had_liked":false,"id":151020,"user_name":"è€ƒä¼‘","can_delete":false,"product_type":"c1","uid":1053955,"ip_address":"","ucode":"968DFC00D6D0CF","user_header":"https://static001.geekbang.org/account/avatar/00/10/15/03/c0fe1dbf.jpg","comment_is_top":false,"comment_ctime":1573643831,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1573643831","product_id":100028001,"comment_content":"è¯·é—®è€å¸ˆï¼Œç”µå•†åº“å­˜çš„å¹¶å‘é—®é¢˜æ˜¯å¦å¯ä»¥ä½¿ç”¨CountDownLatchæ¥å®ç°å‘¢ï¼Œæ„Ÿè§‰å®ç°èµ·æ¥æ›´ç®€å•ï¼Œæ¯•ç«Ÿåº“å­˜åªæ˜¯ä¸€ä¸ªæ•°é‡ï¼Œä¸å¿…ç”¨ä¸€ä¸ªæ•°ç»„æ¥è¡¨ç¤ºã€‚","like_count":0},{"had_liked":false,"id":135524,"user_name":"ç™½ä¸­ç™½","can_delete":false,"product_type":"c1","uid":1616954,"ip_address":"","ucode":"95F9DABEBEFAAA","user_header":"http://thirdwx.qlogo.cn/mmopen/vi_32/ODqoBdTKsL1jW4m72BZ0ibECEtWPq0N1tAIlbzjsq6mcJiavT2CKtx0ejpIqQdHbRXdMWH0I1jpI2ZiawFIkF1icsQ/132","comment_is_top":false,"comment_ctime":1569203386,"is_pvip":false,"replies":[{"id":"53074","content":"LinkedListæ˜¯éçº¿ç¨‹å®‰å…¨å®¹å™¨ï¼Œå­˜åœ¨çº¿ç¨‹å®‰å…¨é—®é¢˜çš„","user_name":"ä½œè€…å›å¤","user_name_real":"åˆ˜è¶…","uid":"1228576","ctime":1569981587,"ip_address":"","comment_id":135524,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1569203386","product_id":100028001,"comment_content":"LinkedList çš„ add å’Œ removeLast æ–¹æ³•éƒ½æœ‰å¯èƒ½æ“ä½œ first å¼•ç”¨ï¼Œå­˜åœ¨çº¿ç¨‹å®‰å…¨é—®é¢˜å§ï¼Ÿ","like_count":0,"discussions":[{"author":{"id":1228576,"avatar":"https://static001.geekbang.org/account/avatar/00/12/bf/20/19d42715.jpg","nickname":"åˆ˜è¶…","note":"","ucode":"CD56F93596E818","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":468230,"discussion_content":"LinkedListæ˜¯éçº¿ç¨‹å®‰å…¨å®¹å™¨ï¼Œå­˜åœ¨çº¿ç¨‹å®‰å…¨é—®é¢˜çš„","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1569981587,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":133404,"user_name":"è¡Œåˆ™å°†è‡³","can_delete":false,"product_type":"c1","uid":1542987,"ip_address":"","ucode":"DB972F2DF059C4","user_header":"https://static001.geekbang.org/account/avatar/00/17/8b/4b/fa52d222.jpg","comment_is_top":false,"comment_ctime":1568553192,"is_pvip":false,"discussion_count":0,"race_medal":1,"score":"1568553192","product_id":100028001,"comment_content":"lockInterruptibly()ã€‚è€å¸ˆï¼Œä¸ºå•¥è¦ç”¨è¿™ä¸ªAPIï¼Œä¸ç”¨lockã€‚æˆ‘æŸ¥äº†ä¸€ä¸‹ï¼Œä¸¤è€…çš„åŒºåˆ«æ˜¯ï¼šå‰è€…ä¾§é‡äºä¸­æ–­ï¼Œåè€…ä¾§é‡äºè·å–é”ã€‚è¿™ä¸ªåœ°æ–¹ï¼Œæ‚¨æ˜¯æ€ä¹ˆè€ƒè™‘çš„å‘¢?","like_count":0},{"had_liked":false,"id":123147,"user_name":"åå¤§æ°å‡ºé’å¹´","can_delete":false,"product_type":"c1","uid":1559178,"ip_address":"","ucode":"BAB4AA12604CF6","user_header":"http://thirdwx.qlogo.cn/mmopen/vi_32/a5U0nqaicLy5ZJkESxBd5lMicNQcTTDK8vURyyWiabHxic7vS1VVk7HWTZg6ltyWJ3n9jb3Gq554ibfjsf7bv1v1Sdw/132","comment_is_top":false,"comment_ctime":1565615315,"is_pvip":false,"discussion_count":1,"race_medal":0,"score":"1565615315","product_id":100028001,"comment_content":"è€å¸ˆï¼Œä¼˜åŒ–ReentrantLocké‚£é‡Œæ˜¯ä¸æ˜¯æœ‰é—®é¢˜å‘¢ï¼Œproductçš„ä¿®æ”¹æ”¾åœ¨ä¸¤ä¸ªä¸åŒçš„é”ä¸‹ï¼Œå°±æ˜¯è¯´å¯èƒ½ä¼šåŒæ—¶æœ‰ä¸¤ä¸ªçº¿ç¨‹ä¼šä¿®æ”¹productè¿™ä¸ªlistï¼Œè¿™æ ·æ˜¯å¦è¿åäº†æœ‰åºæ€§ã€‚<br>è€Œä¸”æˆ‘å°è¯•æ— é™å¾ªç¯è¿è¡Œç”Ÿäº§è€…æ¶ˆè´¹è€…çº¿ç¨‹ï¼Œå‘ç°è¿è¡Œä¹…äº†ä¼šå‡ºé”™çš„ï¼Œå¸Œæœ›è€å¸ˆè®²è§£ä¸€ä¸‹ã€‚","like_count":0,"discussions":[{"author":{"id":1445320,"avatar":"https://static001.geekbang.org/account/avatar/00/16/0d/c8/fdfd768b.jpg","nickname":"æå¿—å¡","note":"","ucode":"CCABC7E5CC5421","race_medal":0,"user_type":1,"is_pvip":true},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":329348,"discussion_content":"æˆ‘ä¹Ÿé‡åˆ°äº†","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1606369745,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":122764,"user_name":"K","can_delete":false,"product_type":"c1","uid":1118374,"ip_address":"","ucode":"69831D1EFC083C","user_header":"https://static001.geekbang.org/account/avatar/00/11/10/a6/4d2c933e.jpg","comment_is_top":false,"comment_ctime":1565515255,"is_pvip":false,"replies":[{"id":"45087","content":"è¿™æœ‰ä¸€ä¸ªlocké”ï¼Œä¸ä¼šåŒæ—¶è¿›æ¥ä¸¤ä¸ªçº¿ç¨‹ã€‚","user_name":"ä½œè€…å›å¤","user_name_real":"åˆ˜è¶…","uid":"1228576","ctime":1565573346,"ip_address":"","comment_id":122764,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1565515255","product_id":100028001,"comment_content":"è€å¸ˆå¥½ï¼Œæˆ‘æœ‰ä¸ªé—®é¢˜ï¼Œå°±æ˜¯å®é™…çš„inventoryä¼šä¸ä¼šè¶…è¿‡maxInventoryå•Šï¼Ÿ<br><br>productLock.lock();\t<br>try {\t<br>\twhile (inventory.get() == maxInventory){ &#47;&#47;3<br>\t\tnotFullCondition.await();<br>\t}<br>\tproduct.add(e);\t&#47;&#47;1<br><br>\t&#47;&#47;producerè¢«å”¤é†’äº†ä»¥åï¼Œæ‰§è¡Œå®Œ1ï¼Œè¿˜æ²¡æ‰§è¡Œ2ï¼Œè¿™ä¸ªæ—¶å€™æ—¶é—´ç‰‡ç”¨å®Œäº†ï¼Œæ‰€ä»¥å…ˆåœæ­¢äº†ã€‚<br>\t&#47;&#47;ç„¶åå¦å¤–çš„çº¿ç¨‹è¢«å”¤é†’äº†ï¼Œåœ¨3å¤„çš„åˆ¤æ–­é€»è¾‘ï¼Œï¼ˆä¸Šä¸€ä¸ªçº¿ç¨‹å¹¶æ²¡æœ‰inventory.incr()ï¼Œæ‰€ä»¥whileæ¡ä»¶ä¸æ»¡è¶³ï¼Œä¸å¾ªç¯ï¼‰<br>\t&#47;&#47;çº¿ç¨‹2å·æ‰§è¡Œå®Œä»£ç 1ï¼Œ2ã€‚<br>\t&#47;&#47;å½“ä¹‹å‰ä¸€ä¸ªçº¿ç¨‹1å·é†’è¿‡æ¥ï¼Œä»–ä¹Ÿä¼šç»§ç»­æ‰§è¡Œä»£ç 2ã€‚è¿™ä¸æ˜¯ç›¸å½“äºï¼Œå®é™…çš„inventory è‚¯å®šè¶…è¿‡äº†maxInventoryå—ï¼Ÿ<br><br>\tSystem.out.println(&quot; æ”¾å…¥ä¸€ä¸ªå•†å“åº“å­˜ï¼Œæ€»åº“å­˜ä¸ºï¼š&quot; + inventory.incrementAndGet());\t&#47;&#47;2<br><br>\t&#47;&#47;åé¢çš„é€»è¾‘<br>\t...","like_count":0,"discussions":[{"author":{"id":1228576,"avatar":"https://static001.geekbang.org/account/avatar/00/12/bf/20/19d42715.jpg","nickname":"åˆ˜è¶…","note":"","ucode":"CD56F93596E818","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":462394,"discussion_content":"è¿™æœ‰ä¸€ä¸ªlocké”ï¼Œä¸ä¼šåŒæ—¶è¿›æ¥ä¸¤ä¸ªçº¿ç¨‹ã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1565573346,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":119398,"user_name":"æ™“æ°","can_delete":false,"product_type":"c1","uid":1441546,"ip_address":"","ucode":"1174C88EEBF8A6","user_header":"https://static001.geekbang.org/account/avatar/00/15/ff/0a/12faa44e.jpg","comment_is_top":false,"comment_ctime":1564578581,"is_pvip":false,"replies":[{"id":"44009","content":"æ˜¯çš„ï¼Œå¯ä»¥åŸºäºæ¶ˆæ¯é˜Ÿåˆ—æˆ–redisç¼“å­˜æ¥å®ç°ã€‚","user_name":"ä½œè€…å›å¤","user_name_real":"åˆ˜è¶…","uid":"1228576","ctime":1564714931,"ip_address":"","comment_id":119398,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1564578581","product_id":100028001,"comment_content":"è¯·é—®è€å¸ˆåœ¨åˆ†å¸ƒå¼æ¶æ„ä¸­ï¼Œä½¿ç”¨lockå’Œblockqueueå®ç°ç”Ÿäº§è€…æ¶ˆè´¹è€…æ˜¯ä¸æ˜¯ä¸é€‚ç”¨äº†","like_count":0,"discussions":[{"author":{"id":1228576,"avatar":"https://static001.geekbang.org/account/avatar/00/12/bf/20/19d42715.jpg","nickname":"åˆ˜è¶…","note":"","ucode":"CD56F93596E818","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":460887,"discussion_content":"æ˜¯çš„ï¼Œå¯ä»¥åŸºäºæ¶ˆæ¯é˜Ÿåˆ—æˆ–redisç¼“å­˜æ¥å®ç°ã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1564714931,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":119162,"user_name":"æˆ‘å·²ç»è®¾ç½®äº†æ˜µç§°","can_delete":false,"product_type":"c1","uid":1364034,"ip_address":"","ucode":"ED672C5EBDBDC4","user_header":"https://static001.geekbang.org/account/avatar/00/14/d0/42/6fd01fb9.jpg","comment_is_top":false,"comment_ctime":1564533277,"is_pvip":false,"replies":[{"id":"43998","content":"æ˜¯çš„","user_name":"ä½œè€…å›å¤","user_name_real":"åˆ˜è¶…","uid":"1228576","ctime":1564712930,"ip_address":"","comment_id":119162,"utype":1}],"discussion_count":2,"race_medal":0,"score":"1564533277","product_id":100028001,"comment_content":"kafkaä¹Ÿæœ‰äº‹åŠ¡æ¶ˆæ¯","like_count":0,"discussions":[{"author":{"id":1228576,"avatar":"https://static001.geekbang.org/account/avatar/00/12/bf/20/19d42715.jpg","nickname":"åˆ˜è¶…","note":"","ucode":"CD56F93596E818","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":460769,"discussion_content":"æ˜¯çš„","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1564712930,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1542987,"avatar":"https://static001.geekbang.org/account/avatar/00/17/8b/4b/fa52d222.jpg","nickname":"è¡Œåˆ™å°†è‡³","note":"","ucode":"DB972F2DF059C4","race_medal":1,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":12621,"discussion_content":"éš”å£çš„èƒ¡å¤•å¤§ç¥è¯´ï¼škafkaçš„0.11ç‰ˆæœ¬å¼€å§‹æ”¯æŒäº‹åŠ¡äº†ï¼Œä½†æ˜¯ä¸å¤ªå¥½æ§åˆ¶å‘¢","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1568556233,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":118899,"user_name":"æ­£åœ¨å‡è‚¥çš„èƒ–ç±½ã€‚","can_delete":false,"product_type":"c1","uid":1033728,"ip_address":"","ucode":"99E2E4DF599236","user_header":"https://static001.geekbang.org/account/avatar/00/0f/c6/00/683bb4f0.jpg","comment_is_top":false,"comment_ctime":1564460974,"is_pvip":false,"replies":[{"id":"43736","content":"æ¯”è¾ƒå¸¸ç”¨çš„æ‰‹æ®µå°±æ˜¯ä½¿ç”¨åˆ†å¸ƒå¼é”æ¥å®ç°ï¼Œåœ¨40è®²ä¸­æˆ‘ä»¬ä¼šè¯¦ç»†ä»‹ç»ã€‚","user_name":"ä½œè€…å›å¤","user_name_real":"åˆ˜è¶…","uid":"1228576","ctime":1564541249,"ip_address":"","comment_id":118899,"utype":1}],"discussion_count":2,"race_medal":0,"score":"1564460974","product_id":100028001,"comment_content":"1.å¦‚æœæŠŠåº“å­˜æ”¾åˆ°ç¼“å­˜ä¸­ï¼Œä¸‹è®¢å•å»ç¼“å­˜æ‰£å‡åº“å­˜æ•°é‡ï¼Œå¦‚ä½•æ˜¯ä¿è¯æ•°æ®ä¸€è‡´æ€§ï¼Ÿå¸Œæœ›è€å¸ˆèƒ½è¯¦ç»†è®²è§£ä¸‹ï¼Ÿ","like_count":0,"discussions":[{"author":{"id":1228576,"avatar":"https://static001.geekbang.org/account/avatar/00/12/bf/20/19d42715.jpg","nickname":"åˆ˜è¶…","note":"","ucode":"CD56F93596E818","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":460648,"discussion_content":"æ¯”è¾ƒå¸¸ç”¨çš„æ‰‹æ®µå°±æ˜¯ä½¿ç”¨åˆ†å¸ƒå¼é”æ¥å®ç°ï¼Œåœ¨40è®²ä¸­æˆ‘ä»¬ä¼šè¯¦ç»†ä»‹ç»ã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1564541249,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1018623,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/8a/ff/1d283c53.jpg","nickname":"hawk","note":"","ucode":"996900C53B90F7","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":10235,"discussion_content":"40è®²ä¸­ï¼Œè¿™ä¸ªé—®é¢˜æœ‰æåˆ°å—ï¼Œâ€œå¦‚æœæŠŠåº“å­˜æ”¾åˆ°ç¼“å­˜ä¸­ï¼Œä¸‹è®¢å•å»ç¼“å­˜æ‰£å‡åº“å­˜æ•°é‡ï¼Œå¦‚ä½•æ˜¯ä¿è¯æ•°æ®ä¸€è‡´æ€§â€","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1568278439,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":118828,"user_name":"ä¸€é“é˜³å…‰","can_delete":false,"product_type":"c1","uid":1239557,"ip_address":"","ucode":"F35207CCCEC6E2","user_header":"https://static001.geekbang.org/account/avatar/00/12/ea/05/c0d8014d.jpg","comment_is_top":false,"comment_ctime":1564450207,"is_pvip":false,"replies":[{"id":"43738","content":"å—¯ï¼Œå¯ä»¥é€šè¿‡è¶…æ—¶æ¥é¿å…é•¿æ—¶é—´é˜»å¡ç­‰å¾…ã€‚","user_name":"ä½œè€…å›å¤","user_name_real":"åˆ˜è¶…","uid":"1228576","ctime":1564541598,"ip_address":"","comment_id":118828,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1564450207","product_id":100028001,"comment_content":"å¯¹äºæ–‡ä¸­çš„æ¡ˆä¾‹ï¼Œå¯ä»¥ç”¨tryLockæ–¹æ³•ï¼Œç»™å®šä¸€ä¸ªè¶…æ—¶æ—¶é—´ï¼Œè¶…è¿‡æ—¶é—´è¿˜æœªè·å–åˆ°é”ï¼Œå°±è¿”å›ä¸€ä¸ªé”™è¯¯æç¤ºä¿¡æ¯ã€‚","like_count":0,"discussions":[{"author":{"id":1228576,"avatar":"https://static001.geekbang.org/account/avatar/00/12/bf/20/19d42715.jpg","nickname":"åˆ˜è¶…","note":"","ucode":"CD56F93596E818","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":460601,"discussion_content":"å—¯ï¼Œå¯ä»¥é€šè¿‡è¶…æ—¶æ¥é¿å…é•¿æ—¶é—´é˜»å¡ç­‰å¾…ã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1564541598,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":118772,"user_name":"-W.LI-","can_delete":false,"product_type":"c1","uid":1210699,"ip_address":"","ucode":"3556786538664F","user_header":"https://static001.geekbang.org/account/avatar/00/12/79/4b/740f91ca.jpg","comment_is_top":false,"comment_ctime":1564446733,"is_pvip":false,"replies":[{"id":"43744","content":"æ€è€ƒçš„å¾ˆå…¨é¢","user_name":"ä½œè€…å›å¤","user_name_real":"åˆ˜è¶…","uid":"1228576","ctime":1564542445,"ip_address":"","comment_id":118772,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1564446733","product_id":100028001,"comment_content":"è¯¾åä¹ é¢˜:ç”Ÿäº§è€…ä¹Ÿç”¨MQç¼“å†²ï¼Œåœ¨æ¥å…¥å±‚åšé™æµæ§åˆ¶æµé‡ã€‚å®¢æˆ·ç«¯å¢åŠ éªŒè¯ç ç­‰æ“ä½œï¼Œé˜²åˆ·ã€‚æœåŠ¡å™¨çš„è®¡ç®—èƒ½åŠ›ï¼Œæœ€å¤§ååé‡æ˜¯æœ‰é™çš„ã€‚çœŸè¦ä¸€ç›´é‚£ä¹ˆå¤§é‡å°±åªèƒ½åŠ æœåŠ¡å™¨äº†ï¼Œåªæ˜¯ç¬æ—¶å°±ç”¨MQåšæµé‡å‰Šå³°ï¼Œæˆ–è€…æé«˜ç”¨æˆ·é—¨æ§›å®¢æˆ·ç«¯é™åˆ¶å‡å°‘æ— æ•ˆè¯·æ±‚(å„ç§çº¬åº¦è¿›è¡Œæ§åˆ¶)ã€‚åªèƒ½æƒ³åˆ°è¿™ä¹ˆç‚¹äº†<br>ç”Ÿäº§è€…æ¶ˆè´¹è€…æ¨¡å‹ä½œç”¨:<br>1.ç”Ÿäº§è€…å’Œæ¶ˆè´¹è€…è§£è€¦<br>2.é€šè¿‡ç¼“å†²ï¼Œå‰Šå³°ï¼Œ<br>3.ç”Ÿäº§è€…å’Œæ¶ˆè´¹ååé‡åˆ†åˆ«è°ƒæ§(ç”Ÿäº§è€…å°‘åªåŠ ç”Ÿäº§è€…å°±å¥½)<br>4....","like_count":0,"discussions":[{"author":{"id":1228576,"avatar":"https://static001.geekbang.org/account/avatar/00/12/bf/20/19d42715.jpg","nickname":"åˆ˜è¶…","note":"","ucode":"CD56F93596E818","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":460567,"discussion_content":"æ€è€ƒçš„å¾ˆå…¨é¢","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1564542445,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":118761,"user_name":"undifined","can_delete":false,"product_type":"c1","uid":1068920,"ip_address":"","ucode":"449CB4CD2DC089","user_header":"https://static001.geekbang.org/account/avatar/00/10/4f/78/c3d8ecb0.jpg","comment_is_top":false,"comment_ctime":1564446265,"is_pvip":false,"replies":[{"id":"44486","content":"æˆ‘ç†è§£çš„è¿™ä¸ªåº”è¯¥æ˜¯åº“å­˜çš„å¯¹å®æ—¶æ€§è¦æ±‚ä¸é«˜å§ã€‚å¦‚æœå¯¹åº“å­˜çš„å®æ—¶æ€§è¦æ±‚ä¸é«˜ï¼Œå¯ä»¥å»ºè®®ç¬¬ä¸‰æ–¹å¹³å°å¼€æ”¾æ‰¹é‡æ›´æ–°åº“å­˜æ¥å£ï¼Œå¹¶ä¸”å›ºå®šä¸€ä¸ªæ›´æ–°å‘¨æœŸã€‚","user_name":"ä½œè€…å›å¤","user_name_real":"åˆ˜è¶…","uid":"1228576","ctime":1565056528,"ip_address":"","comment_id":118761,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1564446265","product_id":100028001,"comment_content":"ç”Ÿäº§æ–¹å¯ä»¥ä½¿ç”¨å¼‚æ­¥çš„æ–¹å¼ï¼Œæ”¶åˆ°è¯·æ±‚åç›´æ¥å‘å‡º MQï¼ŒåŒæ—¶åº”å½“æ·»åŠ é™æµç†”æ–­ç­‰ä¿æŠ¤æªæ–½<br><br>è€å¸ˆæˆ‘è¿˜æœ‰ä¸€ä¸ªé—®é¢˜ï¼Œæˆ‘ä»¬éœ€è¦å‘ç¬¬ä¸‰æ–¹å¹³å°åŒæ­¥åº“å­˜ï¼Œä½†æ˜¯ç¬¬ä¸‰æ–¹æœ‰é™æµï¼Œè€Œä¸” API æ”¶è´¹ï¼Œç›®å‰æ˜¯å°†å•†å“ IDæ”¾åˆ°ä¸€ä¸ªå»¶æ—¶é˜Ÿåˆ—ï¼Œå¦‚æœæœ‰ç›¸åŒçš„ IDï¼Œä¸€åˆ†é’Ÿå†…åªä¼šåŒæ­¥ä¸€æ¬¡ï¼Œè€å¸ˆæœ‰æ›´å¥½çš„åŠæ³•å—ï¼Œè°¢è°¢è€å¸ˆ","like_count":0,"discussions":[{"author":{"id":1228576,"avatar":"https://static001.geekbang.org/account/avatar/00/12/bf/20/19d42715.jpg","nickname":"åˆ˜è¶…","note":"","ucode":"CD56F93596E818","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":460563,"discussion_content":"æˆ‘ç†è§£çš„è¿™ä¸ªåº”è¯¥æ˜¯åº“å­˜çš„å¯¹å®æ—¶æ€§è¦æ±‚ä¸é«˜å§ã€‚å¦‚æœå¯¹åº“å­˜çš„å®æ—¶æ€§è¦æ±‚ä¸é«˜ï¼Œå¯ä»¥å»ºè®®ç¬¬ä¸‰æ–¹å¹³å°å¼€æ”¾æ‰¹é‡æ›´æ–°åº“å­˜æ¥å£ï¼Œå¹¶ä¸”å›ºå®šä¸€ä¸ªæ›´æ–°å‘¨æœŸã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1565056528,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":118758,"user_name":"-W.LI-","can_delete":false,"product_type":"c1","uid":1210699,"ip_address":"","ucode":"3556786538664F","user_header":"https://static001.geekbang.org/account/avatar/00/12/79/4b/740f91ca.jpg","comment_is_top":false,"comment_ctime":1564445862,"is_pvip":false,"replies":[{"id":"43730","content":"è¿™é‡ŒåŒæ­¥æ›´æ–°ä¸‹ï¼Œæ–°å¢äº†ä»¥ä¸‹ä»£ç ä½œä¸ºå®æ—¶åº“å­˜ï¼š<br>private AtomicInteger inventory = new AtomicInteger(0);<br><br>æˆ‘ä»¬è¿™é‡Œæ˜¯åŸºäºLinkedListæ¥å­˜å–åº“å­˜çš„ï¼Œè™½ç„¶LinkedListæ˜¯éçº¿ç¨‹å®‰å…¨ï¼Œä½†æˆ‘ä»¬æ–°å¢æ˜¯æ“ä½œå¤´éƒ¨ï¼Œè€Œæ¶ˆè´¹åˆ™æ˜¯æ“ä½œé˜Ÿåˆ—çš„å°¾éƒ¨ï¼Œç†è®ºä¸Šæ¥è¯´æ²¡æœ‰çº¿ç¨‹å®‰å…¨é—®é¢˜ã€‚è€Œåº“å­˜çš„å®é™…æ•°é‡inventoryæ˜¯åŸºäºAtomicIntegerï¼ˆCASé”ï¼‰çº¿ç¨‹å®‰å…¨ç±»å®ç°ï¼Œå³å¯ä»¥ä¿è¯åŸå­æ€§ï¼Œä¹Ÿå¯ä»¥ä¿è¯æ¶ˆè´¹è€…å’Œç”Ÿäº§è€…ä¹‹é—´æ˜¯å¯è§çš„ã€‚","user_name":"ä½œè€…å›å¤","user_name_real":"åˆ˜è¶…","uid":"1228576","ctime":1564540525,"ip_address":"","comment_id":118758,"utype":1}],"discussion_count":2,"race_medal":0,"score":"1564445862","product_id":100028001,"comment_content":"è€å¸ˆå¥½ï¼Œç”Ÿäº§è€…æ¶ˆè´¹è€…æ¨¡å‹é‡Œé¢ï¼Œåˆ†å¼€ä¸¤ä¸ªé”çš„æ—¶å€™ è´¡çŒ®å˜é‡private LinkedList&lt;String&gt; product = new LinkedList&lt;String&gt;();éœ€è¦ï¼‹volatileä¿è¯å¯è§æ€§ä¹ˆ?ï¼Œæ¡ä»¶åˆ¤æ–­ç­‰å€¼åˆ¤æ–­å¥½è¿˜æ˜¯èŒƒå›´åˆ¤æ–­å¥½?","like_count":0,"discussions":[{"author":{"id":1228576,"avatar":"https://static001.geekbang.org/account/avatar/00/12/bf/20/19d42715.jpg","nickname":"åˆ˜è¶…","note":"","ucode":"CD56F93596E818","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":460561,"discussion_content":"è¿™é‡ŒåŒæ­¥æ›´æ–°ä¸‹ï¼Œæ–°å¢äº†ä»¥ä¸‹ä»£ç ä½œä¸ºå®æ—¶åº“å­˜ï¼š\nprivate AtomicInteger inventory = new AtomicInteger(0);\n\næˆ‘ä»¬è¿™é‡Œæ˜¯åŸºäºLinkedListæ¥å­˜å–åº“å­˜çš„ï¼Œè™½ç„¶LinkedListæ˜¯éçº¿ç¨‹å®‰å…¨ï¼Œä½†æˆ‘ä»¬æ–°å¢æ˜¯æ“ä½œå¤´éƒ¨ï¼Œè€Œæ¶ˆè´¹åˆ™æ˜¯æ“ä½œé˜Ÿåˆ—çš„å°¾éƒ¨ï¼Œç†è®ºä¸Šæ¥è¯´æ²¡æœ‰çº¿ç¨‹å®‰å…¨é—®é¢˜ã€‚è€Œåº“å­˜çš„å®é™…æ•°é‡inventoryæ˜¯åŸºäºAtomicIntegerï¼ˆCASé”ï¼‰çº¿ç¨‹å®‰å…¨ç±»å®ç°ï¼Œå³å¯ä»¥ä¿è¯åŸå­æ€§ï¼Œä¹Ÿå¯ä»¥ä¿è¯æ¶ˆè´¹è€…å’Œç”Ÿäº§è€…ä¹‹é—´æ˜¯å¯è§çš„ã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1564540525,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1259218,"avatar":"https://static001.geekbang.org/account/avatar/00/13/36/d2/c7357723.jpg","nickname":"å‘æ¡æ©™å­ ã€‚","note":"","ucode":"ED076F4534FFED","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":3478,"discussion_content":"å¯è§è¡Œä¸èƒ½ä¿è¯åŸå­æ€§","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1564528044,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":118732,"user_name":"Zed","can_delete":false,"product_type":"c1","uid":1184951,"ip_address":"","ucode":"09947C76F55A46","user_header":"https://static001.geekbang.org/account/avatar/00/12/14/b7/bb6a1fd4.jpg","comment_is_top":false,"comment_ctime":1564443465,"is_pvip":false,"replies":[{"id":"43696","content":"æ˜¯çš„ï¼Œé™æµæ˜¯ä¸€ç§ä¼˜åŒ–æ–¹å¼","user_name":"ä½œè€…å›å¤","user_name_real":"åˆ˜è¶…","uid":"1228576","ctime":1564536367,"ip_address":"","comment_id":118732,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1564443465","product_id":100028001,"comment_content":"æˆ‘è§‰å¾—å¯ä»¥é€šè¿‡çº¿ç¨‹æ± æ§åˆ¶é™æµã€‚","like_count":0,"discussions":[{"author":{"id":1228576,"avatar":"https://static001.geekbang.org/account/avatar/00/12/bf/20/19d42715.jpg","nickname":"åˆ˜è¶…","note":"","ucode":"CD56F93596E818","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":460549,"discussion_content":"æ˜¯çš„ï¼Œé™æµæ˜¯ä¸€ç§ä¼˜åŒ–æ–¹å¼","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1564536367,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]}]}