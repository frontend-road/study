{"id":109331,"title":"38 | é«˜é€Ÿç¼“å­˜ï¼ˆä¸‹ï¼‰ï¼šä½ ç¡®å®šä½ çš„æ•°æ®æ›´æ–°äº†ä¹ˆï¼Ÿ","content":"<p>åœ¨æˆ‘å·¥ä½œçš„åå‡ å¹´é‡Œï¼Œå†™äº†å¾ˆå¤šJavaçš„ç¨‹åºã€‚åŒæ—¶ï¼Œæˆ‘ä¹Ÿé¢è¯•è¿‡å¤§é‡çš„Javaå·¥ç¨‹å¸ˆã€‚å¯¹äºä¸€äº›è¡¨ç¤ºè‡ªå·±æ·±å…¥äº†è§£å’Œæ“…é•¿å¤šçº¿ç¨‹çš„åŒå­¦ï¼Œæˆ‘ç»å¸¸ä¼šé—®è¿™æ ·ä¸€ä¸ªé¢è¯•é¢˜ï¼šâ€œ<strong>volatileè¿™ä¸ªå…³é”®å­—æœ‰ä»€ä¹ˆä½œç”¨ï¼Ÿ</strong>â€å¦‚æœä½ æˆ–è€…ä½ çš„æœ‹å‹å†™è¿‡Javaç¨‹åºï¼Œä¸å¦¨æ¥ä¸€èµ·è¯•ç€å›ç­”ä¸€ä¸‹è¿™ä¸ªé—®é¢˜ã€‚</p><p>å°±æˆ‘é¢è¯•è¿‡çš„å·¥ç¨‹å¸ˆè€Œè¨€ï¼Œå³ä½¿æ˜¯å·¥ä½œäº†å¤šå¹´çš„Javaå·¥ç¨‹å¸ˆï¼Œä¹Ÿå¾ˆå°‘æœ‰äººèƒ½å‡†ç¡®è¯´å‡ºvolatileè¿™ä¸ªå…³é”®å­—çš„å«ä¹‰ã€‚è¿™é‡Œé¢æœ€å¸¸è§çš„ç†è§£é”™è¯¯æœ‰ä¸¤ä¸ªï¼Œä¸€ä¸ªæ˜¯æŠŠvolatileå½“æˆä¸€ç§é”æœºåˆ¶ï¼Œè®¤ä¸ºç»™å˜é‡åŠ ä¸Šäº†volatileï¼Œå°±å¥½åƒæ˜¯ç»™å‡½æ•°åŠ äº†sychronizedå…³é”®å­—ä¸€æ ·ï¼Œä¸åŒçš„çº¿ç¨‹å¯¹äºç‰¹å®šå˜é‡çš„è®¿é—®ä¼šå»åŠ é”ï¼›å¦ä¸€ä¸ªæ˜¯æŠŠvolatileå½“æˆä¸€ç§åŸå­åŒ–çš„æ“ä½œæœºåˆ¶ï¼Œè®¤ä¸ºåŠ äº†volatileä¹‹åï¼Œå¯¹äºä¸€ä¸ªå˜é‡çš„è‡ªå¢çš„æ“ä½œå°±ä¼šå˜æˆåŸå­æ€§çš„äº†ã€‚</p><pre><code>// ä¸€ç§é”™è¯¯çš„ç†è§£ï¼Œæ˜¯æŠŠvolatileå…³é”®è¯ï¼Œå½“æˆæ˜¯ä¸€ä¸ªé”ï¼Œå¯ä»¥æŠŠlong/doubleè¿™æ ·çš„æ•°çš„æ“ä½œè‡ªåŠ¨åŠ é”\nprivate volatile long synchronizedValue = 0;\n\n// å¦ä¸€ç§é”™è¯¯çš„ç†è§£ï¼Œæ˜¯æŠŠvolatileå…³é”®è¯ï¼Œå½“æˆå¯ä»¥è®©æ•´æ•°è‡ªå¢çš„æ“ä½œä¹Ÿå˜æˆåŸå­æ€§çš„\nprivate volatile int atomicInt = 0;\namoticInt++;\n</code></pre><p>äº‹å®ä¸Šï¼Œè¿™ä¸¤ç§ç†è§£éƒ½æ˜¯å®Œå…¨é”™è¯¯çš„ã€‚å¾ˆå¤šå·¥ç¨‹å¸ˆå®¹æ˜“æŠŠvolatileå…³é”®å­—ï¼Œå½“æˆå’Œé”æˆ–è€…æ•°æ®æ•°æ®åŸå­æ€§ç›¸å…³çš„çŸ¥è¯†ç‚¹ã€‚è€Œå®é™…ä¸Šï¼Œvolatileå…³é”®å­—çš„æœ€æ ¸å¿ƒçŸ¥è¯†ç‚¹ï¼Œè¦å…³ç³»åˆ°Javaå†…å­˜æ¨¡å‹ï¼ˆJMMï¼ŒJava Memory Modelï¼‰ä¸Šã€‚</p><p>è™½ç„¶JMMåªæ˜¯Javaè™šæ‹Ÿæœºè¿™ä¸ªè¿›ç¨‹çº§è™šæ‹Ÿæœºé‡Œçš„ä¸€ä¸ªå†…å­˜æ¨¡å‹ï¼Œä½†æ˜¯è¿™ä¸ªå†…å­˜æ¨¡å‹ï¼Œå’Œè®¡ç®—æœºç»„æˆé‡Œçš„CPUã€é«˜é€Ÿç¼“å­˜å’Œä¸»å†…å­˜ç»„åˆåœ¨ä¸€èµ·çš„ç¡¬ä»¶ä½“ç³»éå¸¸ç›¸ä¼¼ã€‚ç†è§£äº†JMMï¼Œå¯ä»¥è®©ä½ å¾ˆå®¹æ˜“ç†è§£è®¡ç®—æœºç»„æˆé‡ŒCPUã€é«˜é€Ÿç¼“å­˜å’Œä¸»å†…å­˜ä¹‹é—´çš„å…³ç³»ã€‚</p><!-- [[[read_end]]] --><h2>â€œéšèº«â€çš„å˜é‡</h2><p>æˆ‘ä»¬å…ˆæ¥ä¸€èµ·çœ‹ä¸€æ®µJavaç¨‹åºã€‚è¿™æ˜¯ä¸€æ®µç»å…¸çš„volatileä»£ç ï¼Œæ¥è‡ªçŸ¥åçš„Javaå¼€å‘è€…ç½‘ç«™<a href=\"https://dzone.com/articles/java-volatile-keyword-0\">dzone.com</a>ï¼Œåç»­æˆ‘ä»¬ä¼šä¿®æ”¹è¿™æ®µä»£ç æ¥è¿›è¡Œå„ç§å°å®éªŒã€‚</p><pre><code>public class VolatileTest {\n    private static volatile int COUNTER = 0;\n\n    public static void main(String[] args) {\n        new ChangeListener().start();\n        new ChangeMaker().start();\n    }\n\n    static class ChangeListener extends Thread {\n        @Override\n        public void run() {\n            int threadValue = COUNTER;\n            while ( threadValue &lt; 5){\n                if( threadValue!= COUNTER){\n                    System.out.println(&quot;Got Change for COUNTER : &quot; + COUNTER + &quot;&quot;);\n                    threadValue= COUNTER;\n                }\n            }\n        }\n    }\n\n    static class ChangeMaker extends Thread{\n        @Override\n        public void run() {\n            int threadValue = COUNTER;\n            while (COUNTER &lt;5){\n                System.out.println(&quot;Incrementing COUNTER to : &quot; + (threadValue+1) + &quot;&quot;);\n                COUNTER = ++threadValue;\n                try {\n                    Thread.sleep(500);\n                } catch (InterruptedException e) { e.printStackTrace(); }\n            }\n        }\n    }\n}\n</code></pre><p>æˆ‘ä»¬å…ˆæ¥çœ‹çœ‹è¿™ä¸ªç¨‹åºåšäº†ä»€ä¹ˆã€‚åœ¨è¿™ä¸ªç¨‹åºé‡Œï¼Œæˆ‘ä»¬å…ˆå®šä¹‰äº†ä¸€ä¸ªvolatileçš„intç±»å‹çš„å˜é‡ï¼ŒCOUNTERã€‚</p><p>ç„¶åï¼Œæˆ‘ä»¬åˆ†åˆ«å¯åŠ¨äº†ä¸¤ä¸ªå•ç‹¬çš„çº¿ç¨‹ï¼Œä¸€ä¸ªçº¿ç¨‹æˆ‘ä»¬å«ChangeListenerã€‚å¦ä¸€ä¸ªçº¿ç¨‹ï¼Œæˆ‘ä»¬å«ChangeMakerã€‚</p><p>ChangeListenerè¿™ä¸ªçº¿ç¨‹è¿è¡Œçš„ä»»åŠ¡å¾ˆç®€å•ã€‚å®ƒå…ˆå–åˆ°COUNTERå½“å‰çš„å€¼ï¼Œç„¶åä¸€ç›´ç›‘å¬ç€è¿™ä¸ªCOUNTERçš„å€¼ã€‚ä¸€æ—¦COUNTERçš„å€¼å‘ç”Ÿäº†å˜åŒ–ï¼Œå°±æŠŠæ–°çš„å€¼é€šè¿‡printlnæ‰“å°å‡ºæ¥ã€‚ç›´åˆ°COUNTERçš„å€¼è¾¾åˆ°5ä¸ºæ­¢ã€‚è¿™ä¸ªç›‘å¬çš„è¿‡ç¨‹ï¼Œé€šè¿‡ä¸€ä¸ªæ°¸ä¸åœæ­‡çš„whileå¾ªç¯çš„å¿™ç­‰å¾…æ¥å®ç°ã€‚</p><p>ChangeMakerè¿™ä¸ªçº¿ç¨‹è¿è¡Œçš„ä»»åŠ¡åŒæ ·å¾ˆç®€å•ã€‚å®ƒåŒæ ·æ˜¯å–åˆ°COUNTERçš„å€¼ï¼Œåœ¨COUNTERå°äº5çš„æ—¶å€™ï¼Œæ¯éš”500æ¯«ç§’ï¼Œå°±è®©COUNTERè‡ªå¢1ã€‚åœ¨è‡ªå¢ä¹‹å‰ï¼Œé€šè¿‡printlnæ–¹æ³•æŠŠè‡ªå¢åçš„å€¼æ‰“å°å‡ºæ¥ã€‚</p><p>æœ€åï¼Œåœ¨mainå‡½æ•°é‡Œï¼Œæˆ‘ä»¬åˆ†åˆ«å¯åŠ¨è¿™ä¸¤ä¸ªçº¿ç¨‹ï¼Œæ¥çœ‹ä¸€çœ‹è¿™ä¸ªç¨‹åºçš„æ‰§è¡Œæƒ…å†µã€‚ç¨‹åºçš„è¾“å‡ºç»“æœå¹¶ä¸è®©äººæ„å¤–ã€‚ChangeMakerå‡½æ•°ä¼šä¸€æ¬¡ä¸€æ¬¡å°†COUNTERä»0å¢åŠ åˆ°5ã€‚å› ä¸ºè¿™ä¸ªè‡ªå¢æ˜¯æ¯500æ¯«ç§’ä¸€æ¬¡ï¼Œè€ŒChangeListenerå»ç›‘å¬COUNTERæ˜¯å¿™ç­‰å¾…çš„ï¼Œæ‰€ä»¥æ¯ä¸€æ¬¡è‡ªå¢éƒ½ä¼šè¢«ChangeListenerç›‘å¬åˆ°ï¼Œç„¶åå¯¹åº”çš„ç»“æœå°±ä¼šè¢«æ‰“å°å‡ºæ¥ã€‚</p><pre><code>Incrementing COUNTER to : 1\nGot Change for COUNTER : 1\nIncrementing COUNTER to : 2\nGot Change for COUNTER : 2\nIncrementing COUNTER to : 3\nGot Change for COUNTER : 3\nIncrementing COUNTER to : 4\nGot Change for COUNTER : 4\nIncrementing COUNTER to : 5\nGot Change for COUNTER : 5\n</code></pre><p>è¿™ä¸ªæ—¶å€™ï¼Œæˆ‘ä»¬å°±å¯ä»¥æ¥åšä¸€ä¸ªå¾ˆæœ‰æ„æ€çš„å®éªŒã€‚å¦‚æœæˆ‘ä»¬æŠŠä¸Šé¢çš„ç¨‹åºå°å°åœ°ä¿®æ”¹ä¸€è¡Œä»£ç ï¼ŒæŠŠæˆ‘ä»¬å®šä¹‰COUNTERè¿™ä¸ªå˜é‡çš„æ—¶å€™ï¼Œè®¾ç½®çš„volatileå…³é”®å­—ç»™å»æ‰ï¼Œä¼šå‘ç”Ÿä»€ä¹ˆäº‹æƒ…å‘¢ï¼Ÿä½ å¯ä»¥è‡ªå·±å…ˆè¯•ä¸€è¯•ï¼Œçœ‹ç»“æœæ˜¯å¦ä¼šè®©ä½ å¤§åƒä¸€æƒŠã€‚</p><pre><code>private static int COUNTER = 0;\n</code></pre><p>æ²¡é”™ï¼Œä½ ä¼šå‘ç°ï¼Œæˆ‘ä»¬çš„ChangeMakerè¿˜æ˜¯èƒ½æ­£å¸¸å·¥ä½œçš„ï¼Œæ¯éš”500msä»ç„¶èƒ½å¤Ÿå¯¹COUNTERè‡ªå¢1ã€‚ä½†æ˜¯ï¼Œå¥‡æ€ªçš„äº‹æƒ…åœ¨ChangeListenerä¸Šå‘ç”Ÿäº†ï¼Œæˆ‘ä»¬çš„ChangeListenerä¸å†å·¥ä½œäº†ã€‚åœ¨ChangeListenerçœ¼é‡Œï¼Œå®ƒä¼¼ä¹ä¸€ç›´è§‰å¾—COUNTERçš„å€¼è¿˜æ˜¯ä¸€å¼€å§‹çš„0ã€‚ä¼¼ä¹COUNTERçš„å˜åŒ–ï¼Œå¯¹äºæˆ‘ä»¬çš„ChangeListenerå½»åº•â€œéšèº«â€äº†ã€‚</p><pre><code>Incrementing COUNTER to : 1\nIncrementing COUNTER to : 2\nIncrementing COUNTER to : 3\nIncrementing COUNTER to : 4\nIncrementing COUNTER to : 5\n</code></pre><p>è¿™ä¸ªæœ‰æ„æ€çš„å°ç¨‹åºè¿˜æ²¡æœ‰ç»“æŸï¼Œæˆ‘ä»¬å¯ä»¥å†å¯¹ç¨‹åºåšä¸€äº›å°å°çš„ä¿®æ”¹ã€‚æˆ‘ä»¬ä¸å†è®©ChangeListenerè¿›è¡Œå®Œå…¨çš„å¿™ç­‰å¾…ï¼Œè€Œæ˜¯åœ¨whileå¾ªç¯é‡Œé¢ï¼Œå°å°åœ°ç­‰å¾…ä¸Š5æ¯«ç§’ï¼Œçœ‹çœ‹ä¼šå‘ç”Ÿä»€ä¹ˆæƒ…å†µã€‚</p><pre><code>static class ChangeListener extends Thread {\n    @Override\n    public void run() {\n        int threadValue = COUNTER;\n        while ( threadValue &lt; 5){\n            if( threadValue!= COUNTER){\n                System.out.println(&quot;Sleep 5ms, Got Change for COUNTER : &quot; + COUNTER + &quot;&quot;);\n                threadValue= COUNTER;\n            }\n            try {\n                Thread.sleep(5);\n            } catch (InterruptedException e) { e.printStackTrace(); }\n        }\n    }\n}\n</code></pre><p>å¥½äº†ï¼Œä¸çŸ¥é“ä½ æœ‰æ²¡æœ‰è‡ªå·±åŠ¨æ‰‹è¯•ä¸€è¯•å‘¢ï¼Ÿåˆä¸€ä¸ªä»¤äººæƒŠå¥‡çš„ç°è±¡è¦å‘ç”Ÿäº†ã€‚è™½ç„¶æˆ‘ä»¬çš„COUNTERå˜é‡ï¼Œä»ç„¶æ²¡æœ‰è®¾ç½®volatileè¿™ä¸ªå…³é”®å­—ï¼Œä½†æ˜¯æˆ‘ä»¬çš„ChangeListenerä¼¼ä¹â€œç¡é†’äº†â€ã€‚åœ¨é€šè¿‡Thread.sleep(5)åœ¨æ¯ä¸ªå¾ªç¯é‡Œâ€œç¡ä¸Šâ€œ5æ¯«ç§’ä¹‹åï¼ŒChangeListeneråˆèƒ½å¤Ÿæ­£å¸¸å–åˆ°COUNTERçš„å€¼äº†ã€‚</p><pre><code>Incrementing COUNTER to : 1\nSleep 5ms, Got Change for COUNTER : 1\nIncrementing COUNTER to : 2\nSleep 5ms, Got Change for COUNTER : 2\nIncrementing COUNTER to : 3\nSleep 5ms, Got Change for COUNTER : 3\nIncrementing COUNTER to : 4\nSleep 5ms, Got Change for COUNTER : 4\nIncrementing COUNTER to : 5\nSleep 5ms, Got Change for COUNTER : 5\n</code></pre><p>è¿™äº›æœ‰æ„æ€çš„ç°è±¡ï¼Œå…¶å®æ¥è‡ªäºæˆ‘ä»¬çš„Javaå†…å­˜æ¨¡å‹ä»¥åŠå…³é”®å­—volatileçš„å«ä¹‰ã€‚<strong>é‚£volatileå…³é”®å­—ç©¶ç«Ÿä»£è¡¨ä»€ä¹ˆå«ä¹‰å‘¢ï¼Ÿå®ƒä¼šç¡®ä¿æˆ‘ä»¬å¯¹äºè¿™ä¸ªå˜é‡çš„è¯»å–å’Œå†™å…¥ï¼Œéƒ½ä¸€å®šä¼šåŒæ­¥åˆ°ä¸»å†…å­˜é‡Œï¼Œè€Œä¸æ˜¯ä»Cacheé‡Œé¢è¯»å–ã€‚</strong>è¯¥æ€ä¹ˆç†è§£è¿™ä¸ªè§£é‡Šå‘¢ï¼Ÿæˆ‘ä»¬é€šè¿‡åˆšæ‰çš„ä¾‹å­æ¥è¿›è¡Œåˆ†æã€‚</p><p>åˆšåˆšç¬¬ä¸€ä¸ªä½¿ç”¨äº†volatileå…³é”®å­—çš„ä¾‹å­é‡Œï¼Œå› ä¸ºæ‰€æœ‰æ•°æ®çš„è¯»å’Œå†™éƒ½æ¥è‡ªä¸»å†…å­˜ã€‚é‚£ä¹ˆè‡ªç„¶åœ°ï¼Œæˆ‘ä»¬çš„ChangeMakerå’ŒChangeListenerä¹‹é—´ï¼Œçœ‹åˆ°çš„COUNTERå€¼å°±æ˜¯ä¸€æ ·çš„ã€‚</p><p>åˆ°äº†ç¬¬äºŒæ®µè¿›è¡Œå°å°ä¿®æ”¹çš„æ—¶å€™ï¼Œæˆ‘ä»¬å»æ‰äº†volatileå…³é”®å­—ã€‚è¿™ä¸ªæ—¶å€™ï¼ŒChangeListeneråˆæ˜¯ä¸€ä¸ªå¿™ç­‰å¾…çš„å¾ªç¯ï¼Œå®ƒå°è¯•ä¸åœåœ°è·å–COUNTERçš„å€¼ï¼Œè¿™æ ·å°±ä¼šä»å½“å‰çº¿ç¨‹çš„â€œCacheâ€é‡Œé¢è·å–ã€‚äºæ˜¯ï¼Œè¿™ä¸ªçº¿ç¨‹å°±æ²¡æœ‰æ—¶é—´ä»ä¸»å†…å­˜é‡Œé¢åŒæ­¥æ›´æ–°åçš„COUNTERå€¼ã€‚è¿™æ ·ï¼Œå®ƒå°±ä¸€ç›´å¡æ­»åœ¨COUNTER=0çš„æ­»å¾ªç¯ä¸Šäº†ã€‚</p><p>è€Œåˆ°äº†æˆ‘ä»¬å†æ¬¡ä¿®æ”¹çš„ç¬¬ä¸‰æ®µä»£ç é‡Œé¢ï¼Œè™½ç„¶è¿˜æ˜¯æ²¡æœ‰ä½¿ç”¨volatileå…³é”®å­—ï¼Œä½†æ˜¯çŸ­çŸ­5msçš„Thead.Sleepç»™äº†è¿™ä¸ªçº¿ç¨‹å–˜æ¯ä¹‹æœºã€‚æ—¢ç„¶è¿™ä¸ªçº¿ç¨‹æ²¡æœ‰è¿™ä¹ˆå¿™äº†ï¼Œå®ƒä¹Ÿå°±æœ‰æœºä¼šæŠŠæœ€æ–°çš„æ•°æ®ä»ä¸»å†…å­˜åŒæ­¥åˆ°è‡ªå·±çš„é«˜é€Ÿç¼“å­˜é‡Œé¢äº†ã€‚äºæ˜¯ï¼ŒChangeListeneråœ¨ä¸‹ä¸€æ¬¡æŸ¥çœ‹COUNTERå€¼çš„æ—¶å€™ï¼Œå°±èƒ½çœ‹åˆ°ChangeMakeré€ æˆçš„å˜åŒ–äº†ã€‚</p><p>è™½ç„¶Javaå†…å­˜æ¨¡å‹æ˜¯ä¸€ä¸ªéš”ç¦»äº†ç¡¬ä»¶å®ç°çš„è™šæ‹Ÿæœºå†…çš„æŠ½è±¡æ¨¡å‹ï¼Œä½†æ˜¯å®ƒç»™äº†æˆ‘ä»¬ä¸€ä¸ªå¾ˆå¥½çš„â€œç¼“å­˜åŒæ­¥â€é—®é¢˜çš„ç¤ºä¾‹ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œå¦‚æœæˆ‘ä»¬çš„æ•°æ®ï¼Œåœ¨ä¸åŒçš„çº¿ç¨‹æˆ–è€…CPUæ ¸é‡Œé¢å»æ›´æ–°ï¼Œå› ä¸ºä¸åŒçš„çº¿ç¨‹æˆ–CPUæ ¸æœ‰ç€è‡ªå·±å„è‡ªçš„ç¼“å­˜ï¼Œå¾ˆæœ‰å¯èƒ½åœ¨Açº¿ç¨‹çš„æ›´æ–°ï¼Œåˆ°Bçº¿ç¨‹é‡Œé¢æ˜¯çœ‹ä¸è§çš„ã€‚</p><h2>CPUé«˜é€Ÿç¼“å­˜çš„å†™å…¥</h2><p>äº‹å®ä¸Šï¼Œæˆ‘ä»¬å¯ä»¥æŠŠJavaå†…å­˜æ¨¡å‹å’Œè®¡ç®—æœºç»„æˆé‡Œçš„CPUç»“æ„å¯¹ç…§èµ·æ¥çœ‹ã€‚</p><p>æˆ‘ä»¬ç°åœ¨ç”¨çš„Intel CPUï¼Œé€šå¸¸éƒ½æ˜¯å¤šæ ¸çš„çš„ã€‚æ¯ä¸€ä¸ªCPUæ ¸é‡Œé¢ï¼Œéƒ½æœ‰ç‹¬ç«‹å±äºè‡ªå·±çš„L1ã€L2çš„Cacheï¼Œç„¶åå†æœ‰å¤šä¸ªCPUæ ¸å…±ç”¨çš„L3çš„Cacheã€ä¸»å†…å­˜ã€‚</p><p>å› ä¸ºCPU Cacheçš„è®¿é—®é€Ÿåº¦è¦æ¯”ä¸»å†…å­˜å¿«å¾ˆå¤šï¼Œè€Œåœ¨CPU Cacheé‡Œé¢ï¼ŒL1/L2çš„Cacheä¹Ÿè¦æ¯”L3çš„Cacheå¿«ã€‚æ‰€ä»¥ï¼Œä¸Šä¸€è®²æˆ‘ä»¬å¯ä»¥çœ‹åˆ°ï¼ŒCPUå§‹ç»ˆéƒ½æ˜¯å°½å¯èƒ½åœ°ä»CPU Cacheä¸­å»è·å–æ•°æ®ï¼Œè€Œä¸æ˜¯æ¯ä¸€æ¬¡éƒ½è¦ä»ä¸»å†…å­˜é‡Œé¢å»è¯»å–æ•°æ®ã€‚</p><p><img src=\"https://static001.geekbang.org/resource/image/07/41/0723f72f3016fede96b545e2898c0541.jpeg?wh=1546*1126\" alt=\"\"></p><p>è¿™ä¸ªå±‚çº§ç»“æ„ï¼Œå°±å¥½åƒæˆ‘ä»¬åœ¨Javaå†…å­˜æ¨¡å‹é‡Œé¢ï¼Œæ¯ä¸€ä¸ªçº¿ç¨‹éƒ½æœ‰å±äºè‡ªå·±çš„çº¿ç¨‹æ ˆã€‚çº¿ç¨‹åœ¨è¯»å–COUNTERçš„æ•°æ®çš„æ—¶å€™ï¼Œå…¶å®æ˜¯ä»æœ¬åœ°çš„çº¿ç¨‹æ ˆçš„Cacheå‰¯æœ¬é‡Œé¢è¯»å–æ•°æ®ï¼Œè€Œä¸æ˜¯ä»ä¸»å†…å­˜é‡Œé¢è¯»å–æ•°æ®ã€‚å¦‚æœæˆ‘ä»¬å¯¹äºæ•°æ®ä»…ä»…åªæ˜¯è¯»ï¼Œé—®é¢˜è¿˜ä¸å¤§ã€‚æˆ‘ä»¬åœ¨ä¸Šä¸€è®²é‡Œï¼Œå·²ç»çœ‹åˆ°Cache Lineçš„ç»„æˆï¼Œä»¥åŠå¦‚ä½•ä»å†…å­˜é‡Œé¢æŠŠå¯¹åº”çš„æ•°æ®åŠ è½½åˆ°Cacheé‡Œã€‚</p><p>ä½†æ˜¯ï¼Œå¯¹äºæ•°æ®ï¼Œæˆ‘ä»¬ä¸å…‰è¦è¯»ï¼Œè¿˜è¦å»å†™å…¥ä¿®æ”¹ã€‚è¿™ä¸ªæ—¶å€™ï¼Œæœ‰ä¸¤ä¸ªé—®é¢˜æ¥äº†ã€‚</p><p><strong>ç¬¬ä¸€ä¸ªé—®é¢˜æ˜¯ï¼Œå†™å…¥Cacheçš„æ€§èƒ½ä¹Ÿæ¯”å†™å…¥ä¸»å†…å­˜è¦å¿«ï¼Œé‚£æˆ‘ä»¬å†™å…¥çš„æ•°æ®ï¼Œåˆ°åº•åº”è¯¥å†™åˆ°Cacheé‡Œè¿˜æ˜¯ä¸»å†…å­˜å‘¢ï¼Ÿå¦‚æœæˆ‘ä»¬ç›´æ¥å†™å…¥åˆ°ä¸»å†…å­˜é‡Œï¼ŒCacheé‡Œçš„æ•°æ®æ˜¯å¦ä¼šå¤±æ•ˆå‘¢ï¼Ÿ</strong>ä¸ºäº†è§£å†³è¿™äº›ç–‘é—®ï¼Œä¸‹é¢æˆ‘è¦ç»™ä½ ä»‹ç»ä¸¤ç§å†™å…¥ç­–ç•¥ã€‚</p><h3>å†™ç›´è¾¾ï¼ˆWrite-Throughï¼‰</h3><p><img src=\"https://static001.geekbang.org/resource/image/8b/d3/8b9ad674953bf36680e815247de235d3.jpeg?wh=1006*1996\" alt=\"\"></p><p>æœ€ç®€å•çš„ä¸€ç§å†™å…¥ç­–ç•¥ï¼Œå«ä½œå†™ç›´è¾¾ï¼ˆWrite-Throughï¼‰ã€‚åœ¨è¿™ä¸ªç­–ç•¥é‡Œï¼Œæ¯ä¸€æ¬¡æ•°æ®éƒ½è¦å†™å…¥åˆ°ä¸»å†…å­˜é‡Œé¢ã€‚åœ¨å†™ç›´è¾¾çš„ç­–ç•¥é‡Œé¢ï¼Œå†™å…¥å‰ï¼Œæˆ‘ä»¬ä¼šå…ˆå»åˆ¤æ–­æ•°æ®æ˜¯å¦å·²ç»åœ¨Cacheé‡Œé¢äº†ã€‚å¦‚æœæ•°æ®å·²ç»åœ¨Cacheé‡Œé¢äº†ï¼Œæˆ‘ä»¬å…ˆæŠŠæ•°æ®å†™å…¥æ›´æ–°åˆ°Cacheé‡Œé¢ï¼Œå†å†™å…¥åˆ°ä¸»å†…å­˜é‡Œé¢ï¼›å¦‚æœæ•°æ®ä¸åœ¨Cacheé‡Œï¼Œæˆ‘ä»¬å°±åªæ›´æ–°ä¸»å†…å­˜ã€‚</p><p>å†™ç›´è¾¾çš„è¿™ä¸ªç­–ç•¥å¾ˆç›´è§‚ï¼Œä½†æ˜¯é—®é¢˜ä¹Ÿå¾ˆæ˜æ˜¾ï¼Œé‚£å°±æ˜¯è¿™ä¸ªç­–ç•¥å¾ˆæ…¢ã€‚æ— è®ºæ•°æ®æ˜¯ä¸æ˜¯åœ¨Cacheé‡Œé¢ï¼Œæˆ‘ä»¬éƒ½éœ€è¦æŠŠæ•°æ®å†™åˆ°ä¸»å†…å­˜é‡Œé¢ã€‚è¿™ä¸ªæ–¹å¼å°±æœ‰ç‚¹å„¿åƒæˆ‘ä»¬ä¸Šé¢ç”¨volatileå…³é”®å­—ï¼Œå§‹ç»ˆéƒ½è¦æŠŠæ•°æ®åŒæ­¥åˆ°ä¸»å†…å­˜é‡Œé¢ã€‚</p><h3>å†™å›ï¼ˆWrite-Backï¼‰</h3><p><img src=\"https://static001.geekbang.org/resource/image/67/0d/67053624d6aa2a5c27c295e1fda4890d.jpeg?wh=1540*2986\" alt=\"\"></p><p>è¿™ä¸ªæ—¶å€™ï¼Œæˆ‘ä»¬å°±æƒ³äº†ï¼Œæ—¢ç„¶æˆ‘ä»¬å»è¯»æ•°æ®ä¹Ÿæ˜¯é»˜è®¤ä»Cacheé‡Œé¢åŠ è½½ï¼Œèƒ½å¦ä¸ç”¨æŠŠæ‰€æœ‰çš„å†™å…¥éƒ½åŒæ­¥åˆ°ä¸»å†…å­˜é‡Œå‘¢ï¼Ÿåªå†™å…¥CPU Cacheé‡Œé¢æ˜¯ä¸æ˜¯å¯ä»¥ï¼Ÿ</p><p>å½“ç„¶æ˜¯å¯ä»¥çš„ã€‚åœ¨CPU Cacheçš„å†™å…¥ç­–ç•¥é‡Œï¼Œè¿˜æœ‰ä¸€ç§ç­–ç•¥å°±å«ä½œå†™å›ï¼ˆWrite-Backï¼‰ã€‚è¿™ä¸ªç­–ç•¥é‡Œï¼Œæˆ‘ä»¬ä¸å†æ˜¯æ¯æ¬¡éƒ½æŠŠæ•°æ®å†™å…¥åˆ°ä¸»å†…å­˜ï¼Œè€Œæ˜¯åªå†™åˆ°CPU Cacheé‡Œã€‚åªæœ‰å½“CPU Cacheé‡Œé¢çš„æ•°æ®è¦è¢«â€œæ›¿æ¢â€çš„æ—¶å€™ï¼Œæˆ‘ä»¬æ‰æŠŠæ•°æ®å†™å…¥åˆ°ä¸»å†…å­˜é‡Œé¢å»ã€‚</p><p>å†™å›ç­–ç•¥çš„è¿‡ç¨‹æ˜¯è¿™æ ·çš„ï¼šå¦‚æœå‘ç°æˆ‘ä»¬è¦å†™å…¥çš„æ•°æ®ï¼Œå°±åœ¨CPU Cacheé‡Œé¢ï¼Œé‚£ä¹ˆæˆ‘ä»¬å°±åªæ˜¯æ›´æ–°CPU Cacheé‡Œé¢çš„æ•°æ®ã€‚åŒæ—¶ï¼Œæˆ‘ä»¬ä¼šæ ‡è®°CPU Cacheé‡Œçš„è¿™ä¸ªBlockæ˜¯è„ï¼ˆDirtyï¼‰çš„ã€‚æ‰€è°“è„çš„ï¼Œå°±æ˜¯æŒ‡è¿™ä¸ªæ—¶å€™ï¼Œæˆ‘ä»¬çš„CPU Cacheé‡Œé¢çš„è¿™ä¸ªBlockçš„æ•°æ®ï¼Œå’Œä¸»å†…å­˜æ˜¯ä¸ä¸€è‡´çš„ã€‚</p><p>å¦‚æœæˆ‘ä»¬å‘ç°ï¼Œæˆ‘ä»¬è¦å†™å…¥çš„æ•°æ®æ‰€å¯¹åº”çš„Cache Blocké‡Œï¼Œæ”¾çš„æ˜¯åˆ«çš„å†…å­˜åœ°å€çš„æ•°æ®ï¼Œé‚£ä¹ˆæˆ‘ä»¬å°±è¦çœ‹ä¸€çœ‹ï¼Œé‚£ä¸ªCache Blocké‡Œé¢çš„æ•°æ®æœ‰æ²¡æœ‰è¢«æ ‡è®°æˆè„çš„ã€‚å¦‚æœæ˜¯è„çš„è¯ï¼Œæˆ‘ä»¬è¦å…ˆæŠŠè¿™ä¸ªCache Blocké‡Œé¢çš„æ•°æ®ï¼Œå†™å…¥åˆ°ä¸»å†…å­˜é‡Œé¢ã€‚ç„¶åï¼Œå†æŠŠå½“å‰è¦å†™å…¥çš„æ•°æ®ï¼Œå†™å…¥åˆ°Cacheé‡Œï¼ŒåŒæ—¶æŠŠCache Blockæ ‡è®°æˆè„çš„ã€‚å¦‚æœBlocké‡Œé¢çš„æ•°æ®æ²¡æœ‰è¢«æ ‡è®°æˆè„çš„ï¼Œé‚£ä¹ˆæˆ‘ä»¬ç›´æ¥æŠŠæ•°æ®å†™å…¥åˆ°Cacheé‡Œé¢ï¼Œç„¶åå†æŠŠCache Blockæ ‡è®°æˆè„çš„å°±å¥½äº†ã€‚</p><p>åœ¨ç”¨äº†å†™å›è¿™ä¸ªç­–ç•¥ä¹‹åï¼Œæˆ‘ä»¬åœ¨åŠ è½½å†…å­˜æ•°æ®åˆ°Cacheé‡Œé¢çš„æ—¶å€™ï¼Œä¹Ÿè¦å¤šå‡ºä¸€æ­¥åŒæ­¥è„Cacheçš„åŠ¨ä½œã€‚å¦‚æœåŠ è½½å†…å­˜é‡Œé¢çš„æ•°æ®åˆ°Cacheçš„æ—¶å€™ï¼Œå‘ç°Cache Blocké‡Œé¢æœ‰è„æ ‡è®°ï¼Œæˆ‘ä»¬ä¹Ÿè¦å…ˆæŠŠCache Blocké‡Œçš„æ•°æ®å†™å›åˆ°ä¸»å†…å­˜ï¼Œæ‰èƒ½åŠ è½½æ•°æ®è¦†ç›–æ‰Cacheã€‚</p><p>å¯ä»¥çœ‹åˆ°ï¼Œåœ¨å†™å›è¿™ä¸ªç­–ç•¥é‡Œï¼Œå¦‚æœæˆ‘ä»¬å¤§é‡çš„æ“ä½œï¼Œéƒ½èƒ½å¤Ÿå‘½ä¸­ç¼“å­˜ã€‚é‚£ä¹ˆå¤§éƒ¨åˆ†æ—¶é—´é‡Œï¼Œæˆ‘ä»¬éƒ½ä¸éœ€è¦è¯»å†™ä¸»å†…å­˜ï¼Œè‡ªç„¶æ€§èƒ½ä¼šæ¯”å†™ç›´è¾¾çš„æ•ˆæœå¥½å¾ˆå¤šã€‚</p><p>ç„¶è€Œï¼Œæ— è®ºæ˜¯å†™å›è¿˜æ˜¯å†™ç›´è¾¾ï¼Œå…¶å®éƒ½è¿˜æ²¡æœ‰è§£å†³æˆ‘ä»¬åœ¨ä¸Šé¢volatileç¨‹åºç¤ºä¾‹ä¸­é‡åˆ°çš„é—®é¢˜ï¼Œä¹Ÿå°±æ˜¯<strong>å¤šä¸ªçº¿ç¨‹ï¼Œæˆ–è€…æ˜¯å¤šä¸ªCPUæ ¸çš„ç¼“å­˜ä¸€è‡´æ€§çš„é—®é¢˜ã€‚è¿™ä¹Ÿå°±æ˜¯æˆ‘ä»¬åœ¨å†™å…¥ä¿®æ”¹ç¼“å­˜åï¼Œéœ€è¦è§£å†³çš„ç¬¬äºŒä¸ªé—®é¢˜ã€‚</strong></p><p>è¦è§£å†³è¿™ä¸ªé—®é¢˜ï¼Œæˆ‘ä»¬éœ€è¦å¼•å…¥ä¸€ä¸ªæ–°çš„æ–¹æ³•ï¼Œå«ä½œMESIåè®®ã€‚è¿™æ˜¯ä¸€ä¸ªç»´æŠ¤ç¼“å­˜ä¸€è‡´æ€§åè®®ã€‚è¿™ä¸ªåè®®ä¸ä»…å¯ä»¥ç”¨åœ¨CPU Cacheä¹‹é—´ï¼Œä¹Ÿå¯ä»¥å¹¿æ³›ç”¨äºå„ç§éœ€è¦ä½¿ç”¨ç¼“å­˜ï¼ŒåŒæ—¶ç¼“å­˜ä¹‹é—´éœ€è¦åŒæ­¥çš„åœºæ™¯ä¸‹ã€‚ä»Šå¤©çš„å†…å®¹å·®ä¸å¤šäº†ï¼Œæˆ‘ä»¬æ”¾åœ¨ä¸‹ä¸€è®²ï¼Œä»”ç»†è®²è§£ç¼“å­˜ä¸€è‡´æ€§é—®é¢˜ã€‚</p><h2>æ€»ç»“å»¶ä¼¸</h2><p>æœ€åï¼Œæˆ‘ä»¬ä¸€èµ·æ¥å›é¡¾ä¸€ä¸‹è¿™ä¸€è®²çš„çŸ¥è¯†ç‚¹ã€‚é€šè¿‡ä¸€ä¸ªä½¿ç”¨Javaç¨‹åºä¸­ä½¿ç”¨volatileå…³é”®å­—ç¨‹åºï¼Œæˆ‘ä»¬å¯ä»¥çœ‹åˆ°ï¼Œåœ¨æœ‰ç¼“å­˜çš„æƒ…å†µä¸‹ä¼šé‡åˆ°ä¸€è‡´æ€§é—®é¢˜ã€‚volatileè¿™ä¸ªå…³é”®å­—å¯ä»¥ä¿éšœæˆ‘ä»¬å¯¹äºæ•°æ®çš„è¯»å†™éƒ½ä¼šåˆ°è¾¾ä¸»å†…å­˜ã€‚</p><p>è¿›ä¸€æ­¥åœ°ï¼Œæˆ‘ä»¬å¯ä»¥çœ‹åˆ°ï¼ŒJavaå†…å­˜æ¨¡å‹å’ŒCPUã€CPU Cacheä»¥åŠä¸»å†…å­˜çš„ç»„ç»‡ç»“æ„éå¸¸ç›¸ä¼¼ã€‚åœ¨CPU Cacheé‡Œï¼Œå¯¹äºæ•°æ®çš„å†™å…¥ï¼Œæˆ‘ä»¬ä¹Ÿæœ‰å†™ç›´è¾¾å’Œå†™å›è¿™ä¸¤ç§è§£å†³æ–¹æ¡ˆã€‚å†™ç›´è¾¾æŠŠæ‰€æœ‰çš„æ•°æ®éƒ½ç›´æ¥å†™å…¥åˆ°ä¸»å†…å­˜é‡Œé¢ï¼Œç®€å•ç›´è§‚ï¼Œä½†æ˜¯æ€§èƒ½å°±ä¼šå—é™äºå†…å­˜çš„è®¿é—®é€Ÿåº¦ã€‚è€Œå†™å›åˆ™é€šå¸¸åªæ›´æ–°ç¼“å­˜ï¼Œåªæœ‰åœ¨éœ€è¦æŠŠç¼“å­˜é‡Œé¢çš„è„æ•°æ®äº¤æ¢å‡ºå»çš„æ—¶å€™ï¼Œæ‰æŠŠæ•°æ®åŒæ­¥åˆ°ä¸»å†…å­˜é‡Œã€‚åœ¨ç¼“å­˜ç»å¸¸ä¼šå‘½ä¸­çš„æƒ…å†µä¸‹ï¼Œæ€§èƒ½æ›´å¥½ã€‚</p><p>ä½†æ˜¯ï¼Œé™¤äº†é‡‡ç”¨è¯»å†™éƒ½ç›´æ¥è®¿é—®ä¸»å†…å­˜çš„åŠæ³•ä¹‹å¤–ï¼Œå¦‚ä½•è§£å†³ç¼“å­˜ä¸€è‡´æ€§çš„é—®é¢˜ï¼Œæˆ‘ä»¬è¿˜æ˜¯æ²¡æœ‰è§£ç­”ã€‚è¿™ä¸ªé—®é¢˜çš„è§£å†³æ–¹æ¡ˆï¼Œæˆ‘ä»¬æ”¾åˆ°ä¸‹ä¸€è®²æ¥è¯¦ç»†è§£è¯´ã€‚</p><h2>æ¨èé˜…è¯»</h2><p>å¦‚æœä½ æ˜¯ä¸€ä¸ªJavaç¨‹åºå‘˜ï¼Œæˆ‘æ¨èä½ å»è¯»ä¸€è¯» <a href=\"https://www.ibm.com/developerworks/java/library/j-jtp03304/index.html\">Fixing Java Memory Model</a> è¿™ç¯‡æ–‡ç« ã€‚è¯»å®Œè¿™äº›å†…å®¹ï¼Œç›¸ä¿¡ä½ ä¼šå¯¹Javaé‡Œçš„å†…å­˜æ¨¡å‹å’Œå¤šçº¿ç¨‹åŸç†æœ‰æ›´æ·±å…¥çš„äº†è§£ï¼Œå¹¶ä¸”ä¹Ÿèƒ½æ›´å¥½åœ°å’Œæˆ‘ä»¬è®¡ç®—æœºåº•å±‚çš„ç¡¬ä»¶æ¶æ„è”ç³»èµ·æ¥ã€‚</p><p>å¯¹äºè®¡ç®—æœºç»„æˆçš„CPUé«˜é€Ÿç¼“å­˜çš„å†™æ“ä½œå¤„ç†ï¼Œä½ ä¹Ÿå¯ä»¥è¯»ä¸€è¯»ã€Šè®¡ç®—æœºç»„æˆä¸è®¾è®¡ï¼šç¡¬ä»¶/è½¯ä»¶æ¥å£ã€‹çš„5.3.3å°èŠ‚ã€‚</p><h2>è¯¾åæ€è€ƒ</h2><p>æœ€åï¼Œç»™ä½ ç•™ä¸€é“æ€è€ƒé¢˜ã€‚æ—¢ç„¶volatileå…³é”®å­—ï¼Œä¼šè®©æ‰€æœ‰çš„æ•°æ®å†™å…¥éƒ½è¦åˆ°ä¸»å†…å­˜ã€‚ä½ å¯ä»¥è¯•ç€å†™ä¸€ä¸ªå°çš„ç¨‹åºï¼Œçœ‹çœ‹ä½¿ç”¨volatileå…³é”®å­—å’Œä¸ä½¿ç”¨volatileå…³é”®å­—ï¼Œåœ¨æ•°æ®å†™å…¥çš„æ€§èƒ½ä¸Šä¼šä¸ä¼šæœ‰å·®å¼‚ï¼Œä»¥åŠè¿™ä¸ªå·®å¼‚åˆ°åº•ä¼šæœ‰å¤šå¤§ã€‚</p><p>æ¬¢è¿æŠŠä½ å†™çš„ç¨‹åºåˆ†äº«åˆ°ç•™è¨€åŒºã€‚å¦‚æœæœ‰å›°éš¾ï¼Œä½ ä¹Ÿå¯ä»¥æŠŠè¿™ä¸ªé—®é¢˜åˆ†äº«ç»™ä½ æœ‹å‹ï¼Œæ‹‰ä¸Šä»–ä¸€èµ·è®¨è®ºå®Œæˆï¼Œå¹¶åœ¨ç•™è¨€åŒºå†™ä¸‹ä½ ä»¬è®¨è®ºåçš„ç»“æœã€‚</p><p></p>","neighbors":{"left":{"article_title":"37 | é«˜é€Ÿç¼“å­˜ï¼ˆä¸Šï¼‰ï¼šâ€œ4æ¯«ç§’â€ç©¶ç«Ÿå€¼å¤šå°‘é’±ï¼Ÿ","id":107477},"right":{"article_title":"39 | MESIåè®®ï¼šå¦‚ä½•è®©å¤šæ ¸CPUçš„é«˜é€Ÿç¼“å­˜ä¿æŒä¸€è‡´ï¼Ÿ","id":109874}},"comments":[{"had_liked":false,"id":116195,"user_name":"LDxy","can_delete":false,"product_type":"c1","uid":1188710,"ip_address":"","ucode":"956432CE7B7761","user_header":"https://static001.geekbang.org/account/avatar/00/12/23/66/413c0bb5.jpg","comment_is_top":false,"comment_ctime":1563800798,"is_pvip":false,"discussion_count":6,"race_medal":0,"score":"568499483870","product_id":100026001,"comment_content":"volatileå…³é”®å­—åœ¨ç”¨Cè¯­è¨€ç¼–å†™åµŒå…¥å¼è½¯ä»¶é‡Œé¢ç”¨å¾—å¾ˆå¤šï¼Œä¸ä½¿ç”¨volatileå…³é”®å­—çš„ä»£ç æ¯”ä½¿ç”¨volatileå…³é”®å­—çš„ä»£ç æ•ˆç‡è¦é«˜ä¸€äº›ï¼Œä½†å°±æ— æ³•ä¿è¯æ•°æ®çš„ä¸€è‡´æ€§ã€‚volatileçš„æœ¬æ„æ˜¯å‘Šè¯‰ç¼–è¯‘å™¨ï¼Œæ­¤å˜é‡çš„å€¼æ˜¯æ˜“å˜çš„ï¼Œæ¯æ¬¡è¯»å†™è¯¥å˜é‡çš„å€¼æ—¶åŠ¡å¿…ä»è¯¥å˜é‡çš„å†…å­˜åœ°å€ä¸­è¯»å–æˆ–å†™å…¥ï¼Œä¸èƒ½ä¸ºäº†æ•ˆç‡ä½¿ç”¨å¯¹ä¸€ä¸ªâ€œä¸´æ—¶â€å˜é‡çš„è¯»å†™æ¥ä»£æ›¿å¯¹è¯¥å˜é‡çš„ç›´æ¥è¯»å†™ã€‚ç¼–è¯‘å™¨çœ‹åˆ°äº†volatileå…³é”®å­—ï¼Œå°±ä¸€å®šä¼šç”Ÿæˆå†…å­˜è®¿é—®æŒ‡ä»¤ï¼Œæ¯æ¬¡è¯»å†™è¯¥å˜é‡å°±ä¸€å®šä¼šæ‰§è¡Œå†…å­˜è®¿é—®æŒ‡ä»¤ç›´æ¥è¯»å†™è¯¥å˜é‡ã€‚è‹¥æ˜¯æ²¡æœ‰volatileå…³é”®å­—ï¼Œç¼–è¯‘å™¨ä¸ºäº†æ•ˆç‡ï¼Œåªä¼šåœ¨å¾ªç¯å¼€å§‹å‰ä½¿ç”¨è¯»å†…å­˜æŒ‡ä»¤å°†è¯¥å˜é‡è¯»åˆ°å¯„å­˜å™¨ä¸­ï¼Œä¹‹ååœ¨å¾ªç¯å†…éƒ½æ˜¯ç”¨å¯„å­˜å™¨è®¿é—®æŒ‡ä»¤æ¥æ“ä½œè¿™ä¸ªâ€œä¸´æ—¶â€å˜é‡ï¼Œåœ¨å¾ªç¯ç»“æŸåå†ä½¿ç”¨å†…å­˜å†™æŒ‡ä»¤å°†è¿™ä¸ªå¯„å­˜å™¨ä¸­çš„â€œä¸´æ—¶â€å˜é‡å†™å›å†…å­˜ã€‚åœ¨è¿™ä¸ªè¿‡ç¨‹ä¸­ï¼Œå¦‚æœå†…å­˜ä¸­çš„è¿™ä¸ªå˜é‡è¢«åˆ«çš„å› ç´ ï¼ˆå…¶ä»–çº¿ç¨‹ã€ä¸­æ–­å‡½æ•°ã€ä¿¡å·å¤„ç†å‡½æ•°ã€DMAæ§åˆ¶å™¨ã€å…¶ä»–ç¡¬ä»¶è®¾å¤‡ï¼‰æ‰€æ”¹å˜äº†ï¼Œå°±äº§ç”Ÿæ•°æ®ä¸ä¸€è‡´çš„é—®é¢˜ã€‚å¦å¤–ï¼Œå¯„å­˜å™¨è®¿é—®æŒ‡ä»¤çš„é€Ÿåº¦è¦æ¯”å†…å­˜è®¿é—®æŒ‡ä»¤çš„é€Ÿåº¦å¿«ï¼Œè¿™é‡Œè¯´çš„å†…å­˜ä¹ŸåŒ…æ‹¬ç¼“å­˜ï¼Œä¹Ÿå°±æ˜¯è¯´å†…å­˜è®¿é—®æŒ‡ä»¤å®é™…ä¸Šä¹Ÿæœ‰å¯èƒ½è®¿é—®çš„æ˜¯ç¼“å­˜é‡Œçš„æ•°æ®ï¼Œä½†å³ä¾¿å¦‚æ­¤ï¼Œè¿˜æ˜¯ä¸å¦‚è®¿é—®å¯„å­˜å™¨å¿«çš„ã€‚ç¼“å­˜å¯¹äºç¼–è¯‘å™¨ä¹Ÿæ˜¯é€æ˜çš„ï¼Œç¼–è¯‘å™¨ä½¿ç”¨å†…å­˜è¯»å†™æŒ‡ä»¤æ—¶åªä¼šè®¤ä¸ºæ˜¯åœ¨è¯»å†™å†…å­˜ï¼Œå†…å­˜å’Œç¼“å­˜é—´çš„æ•°æ®åŒæ­¥ç”±CPUä¿è¯ã€‚","like_count":133,"discussions":[{"author":{"id":1510495,"avatar":"https://static001.geekbang.org/account/avatar/00/17/0c/5f/4cbcbfb9.jpg","nickname":"hello","note":"","ucode":"C6FC61A90F202B","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":375381,"discussion_content":"L123ç¼“å­˜å’Œå¯„å­˜å™¨ä¸ä¸€æ ·ï¼Œå¯„å­˜å™¨æ˜¯ç¨‹åºå¯ä»¥æ“ä½œçš„ï¼ŒL123æ˜¯å¯¹ç¨‹åºé€æ˜çš„ï¼Œç¨‹åºæ˜¯è®¿é—®ä¸åˆ°çš„ã€‚æ‰€ä»¥ç¼–è¯‘å™¨æ˜¯å¦‚ä½•é€šè¿‡å…³é”®å­—volatileæ¥æ§åˆ¶ç”¨ä¸ç”¨L123ç¼“å­˜çš„å‘¢ï¼Ÿ\nç­”æ¡ˆæ˜¯å†…å­˜å±éšœæŒ‡ä»¤ï¼Œåœ¨è®¿é—®è¿™ä¸ªå˜é‡å‰åæ’å…¥å†…å­˜å±éšœæŒ‡ä»¤ï¼Œè¿«ä½¿cpuä¸ä½¿ç”¨L123ç¼“å­˜ã€‚","likes_number":7,"is_delete":false,"is_hidden":false,"ctime":1621598435,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":2459923,"avatar":"https://static001.geekbang.org/account/avatar/00/25/89/13/0d3c5008.jpg","nickname":"æœ€å¥½ä¸è¿‡","note":"","ucode":"C7DBCD08402DF8","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":374150,"discussion_content":"è®°ä½ï¼Œè¿™é‡Œè¯´çš„æ˜¯C/C++ä¸­çš„volatileï¼Œå’Œjavaä¸­çš„volatileæ˜¯æœ‰åŒºåˆ«çš„\n\nå¯¹äº C#/Java ï¼Œ`volatile`å‘Šè¯‰ç¼–è¯‘å™¨æ°¸è¿œä¸è¦ç¼“å­˜å˜é‡çš„å€¼ï¼Œå› ä¸ºå˜é‡çš„å€¼å¯èƒ½ä¼šè¶…å‡ºç¨‹åºæœ¬èº«çš„èŒƒå›´ã€‚ç„¶åï¼Œå¦‚æœå˜é‡â€œåœ¨å…¶æ§åˆ¶èŒƒå›´ä¹‹å¤–â€æ›´æ”¹ï¼Œç¼–è¯‘å™¨å°†é¿å…å¯èƒ½å¯¼è‡´é—®é¢˜çš„ä»»ä½•ä¼˜åŒ–ã€‚\n\nåœ¨** C/C++ ** ä¸­ï¼Œå¼€å‘åµŒå…¥å¼ç³»ç»Ÿæˆ–è®¾å¤‡é©±åŠ¨ç¨‹åº(éœ€è¦è¯»å–æˆ–å†™å…¥å†…å­˜æ˜ å°„çš„ç¡¬ä»¶è®¾å¤‡)æ—¶éœ€è¦`volatile`ã€‚ç‰¹å®šè®¾å¤‡å¯„å­˜å™¨çš„å†…å®¹å¯ä»¥éšæ—¶æ›´æ”¹ï¼Œå› æ­¤æ‚¨éœ€è¦ä½¿ç”¨`volatile`å…³é”®å­—æ¥ç¡®ä¿ç¼–è¯‘å™¨ä¸ä¼šå¯¹æ­¤ç±»è®¿é—®è¿›è¡Œä¼˜åŒ–ã€‚","likes_number":7,"is_delete":false,"is_hidden":false,"ctime":1621043129,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1254656,"avatar":"https://static001.geekbang.org/account/avatar/00/13/25/00/3afbab43.jpg","nickname":"88591","note":"","ucode":"04CE3E46455185","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":78931,"discussion_content":"ç†è§£volatile å…³é”®ä¸¤ç‚¹ï¼Œ1ã€è½¯ä»¶åªèƒ½æ§åˆ¶cpu å¯„å­˜å™¨å€¼çš„æ˜¯å¦æ›´æ–° 2ã€å¯„å­˜å™¨çš„å€¼æ¥æºï¼ˆç¼“å­˜ï¼Œå†…å­˜ï¼‰å’Œå»å¤„ï¼ˆç¼“å­˜ï¼Œå†…å­˜ï¼‰ç”±ç¡¬ä»¶æ§åˆ¶ï¼Œå¹¶ä¸”ç”±ç¡¬ä»¶éœ€è¦ä¿è¯ç¼“å­˜ä¸€è‡´æ€§ã€‚","likes_number":4,"is_delete":false,"is_hidden":false,"ctime":1576033852,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1243906,"avatar":"https://static001.geekbang.org/account/avatar/00/12/fb/02/1b74615c.jpg","nickname":"æ ‘å†›","note":"","ucode":"7BC6F00B94FB2F","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":296943,"discussion_content":"ä½ è¯´çš„éå¸¸å¥½ï¼Œæˆ‘è§‰å¾—è€å¸ˆè®²çš„æ˜¯é”™çš„ï¼Œvolatileä¸æ˜¯ç©ºéš™Cacheçš„ï¼Œè€Œä¸”å‘Šè¯‰ç¼–è¯‘å™¨ä¸èƒ½ä¼˜åŒ–è¿™ä¸ªå˜é‡ã€‚","likes_number":2,"is_delete":false,"is_hidden":false,"ctime":1596709692,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1181650,"avatar":"https://static001.geekbang.org/account/avatar/00/12/07/d2/0d7ee298.jpg","nickname":"æƒ˜ é—»","note":"","ucode":"C5909F034BF072","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":389477,"discussion_content":"å“¦çœ‹åˆ° ç¼“å­˜å’Œå†…å­˜çš„æ•°æ®åŒæ­¥å·²ç»ç”±cpuä¿è¯äº†\n","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1629288808,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1181650,"avatar":"https://static001.geekbang.org/account/avatar/00/12/07/d2/0d7ee298.jpg","nickname":"æƒ˜ é—»","note":"","ucode":"C5909F034BF072","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":389476,"discussion_content":"å†…å­˜ä¹ŸåŒ…æ‹¬ç¼“å­˜ï¼Ÿã€‚ã€‚ã€‚   é‚£ä¹ˆvolatileå…³é”®å­—çš„å†…å­˜è®¿é—®æŒ‡ä»¤ä¹Ÿæ˜¯ä¼šè®¿é—®ç¼“å­˜ï¼Ÿï¼Ÿï¼Ÿé‚£volatileæ˜¯å¦‚ä½•ä¿è¯å€¼æœ€æ–°çš„å‘¢ï¼Ÿ ä½ è¯´çš„å†…å­˜è®¿é—®æŒ‡ä»¤åŒ…æ‹¬çš„ç¼“å­˜æ˜¯å¦å•æŒ‡çš„cpuå…±äº«çš„l3ç¼“å­˜ï¼Ÿ","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1629288728,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":163970,"user_name":"KnightÂ²ÂºÂ¹â¸","can_delete":false,"product_type":"c1","uid":1089754,"ip_address":"","ucode":"BDCB830B6A730F","user_header":"https://static001.geekbang.org/account/avatar/00/10/a0/da/4f50f1b2.jpg","comment_is_top":false,"comment_ctime":1576836232,"is_pvip":false,"replies":[{"id":"68662","content":"KnightÂ²ÂºÂ¹â¸åŒå­¦ï¼Œ<br><br>ä½ å¥½ï¼Œä½ è¯´çš„æœ‰é“ç†ï¼Œæˆ‘å»ä¿®æ”¹ä¸€ä¸‹ã€‚","user_name":"ä½œè€…å›å¤","user_name_real":"å¾æ–‡æµ©","uid":"1053568","ctime":1581238397,"ip_address":"","comment_id":163970,"utype":1}],"discussion_count":7,"race_medal":0,"score":"319404416136","product_id":100026001,"comment_content":"Java sleep è§£é‡Šæœ‰é—®é¢˜ï¼Œsleep å¹¶ä¸æ˜¯è¯´çº¿ç¨‹æœ‰æ—¶é—´å»ä¸»å†…å­˜ä¸­è¯»å–å˜é‡ï¼Œè€Œæ˜¯ sleep çš„çº¿ç¨‹ä¼šè®©å‡ºcpuï¼Œçº¿ç¨‹è¢«å”¤é†’åæ‰ä¼šå»é‡æ–°åŠ è½½å˜é‡ã€‚","like_count":75,"discussions":[{"author":{"id":1089754,"avatar":"https://static001.geekbang.org/account/avatar/00/10/a0/da/4f50f1b2.jpg","nickname":"KnightÂ²ÂºÂ¹â¸","note":"","ucode":"BDCB830B6A730F","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":164931,"discussion_content":"æˆ‘å¹¶ä¸æ˜¯ç§‘ç­å‡ºèº«ï¼Œè€å¸ˆè¿™é—¨è¯¾ç¨‹è®©æˆ‘å—ç›ŠåŒªæµ…ï¼Œå› ä¸ºJavaæ¥è§¦çš„æ¯”è¾ƒå¤šï¼Œæ°å¥½äº†è§£è¿™ä¸ªç‚¹ã€‚","likes_number":2,"is_delete":false,"is_hidden":false,"ctime":1581240238,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":2,"child_discussions":[{"author":{"id":1512642,"avatar":"https://static001.geekbang.org/account/avatar/00/17/14/c2/46ebe3a0.jpg","nickname":"ä¾§è€³å€¾å¬","note":"","ucode":"5BF2A2440B54F0","race_medal":0,"user_type":1,"is_pvip":true},"reply_author":{"id":1089754,"avatar":"https://static001.geekbang.org/account/avatar/00/10/a0/da/4f50f1b2.jpg","nickname":"KnightÂ²ÂºÂ¹â¸","note":"","ucode":"BDCB830B6A730F","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":263900,"discussion_content":"æˆ‘è§‰å¾—ä½œè€…è¡¨è¾¾çš„ä¹Ÿæ²¡æœ‰é”™ï¼Œä»MESIåè®®çš„è§’åº¦çœ‹å¾…è¿™ä¸ªé—®é¢˜ï¼Œé¦–å…ˆä¸¤ä¸ªCPUåˆå§‹cache lineéƒ½æ˜¯Sï¼Œå½“Aä¿®æ”¹cacheä¸­çš„å€¼å‰ï¼Œä¼šå°†Bä¸­çš„cacheä¿®æ”¹ä¸ºIï¼Œç„¶åAä¸­çš„çŠ¶æ€ä¿®æ”¹ä¸ºMï¼Œå‡è®¾æ­¤æ—¶Bé‡æ–°ä»å†…å­˜åŠ è½½æ•°æ®ï¼Œé‚£ä¹ˆAå°±åº”è¯¥å°†cacheä¸­çš„æ•°æ®åŒæ­¥åˆ°ä¸»å­˜ï¼ŒBåº”è¯¥è¯»å‡ºæ¥çš„å€¼æ˜¯æœ€æ–°çš„ã€‚ä½†æ˜¯å®é™…æ˜¯Bè¿›å…¥äº†æ­»å¾ªç¯çŠ¶æ€ï¼Œä¹Ÿå°±æ˜¯è¯´Bå¹¶æ²¡æœ‰ä»ä¸»å­˜é‡æ–°åŠ è½½æ•°æ®ï¼Œæ‰€ä»¥ä½œè€…çš„è¯´æ³•ä¹Ÿå°±è¯´çš„é€šäº†ï¼Œæ­¤æ—¶Bçš„åˆ©ç”¨ç‡åº”è¯¥æ˜¯100%ï¼ŒCPUç¡®å®æ²¡æœ‰ä½™åŠ›å»å¤„ç†æ€»çº¿å‘é€è¿‡æ¥çš„å°†cache lineä¿®æ”¹ä¸ºæ— æ•ˆçš„ä¿¡å·ï¼ŒBçš„çŠ¶æ€åº”è¯¥ä¸€ç›´éƒ½æ˜¯S","likes_number":1,"is_delete":false,"is_hidden":false,"ctime":1589263667,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":164931,"ip_address":""},"score":263900,"extra":""},{"author":{"id":2026074,"avatar":"","nickname":"å°¼å¤æ‹‰æ–¯","note":"","ucode":"82EE35B505C09A","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":1089754,"avatar":"https://static001.geekbang.org/account/avatar/00/10/a0/da/4f50f1b2.jpg","nickname":"KnightÂ²ÂºÂ¹â¸","note":"","ucode":"BDCB830B6A730F","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":319835,"discussion_content":"    static class ChangeListener extends Thread {\n        @Override\n        public void run() {\n            Integer i = Integer.MAX_VALUE;\n            int threadValue = COUNTER;\n            while (threadValue < 5){\n                if(threadValue!= COUNTER){\n                    System.out.println(&#34;Got Change for COUNTER : &#34; + COUNTER + &#34;&#34;);\n                    threadValue= COUNTER;\n                }else{\n                   i--;\n                }\n            }\n        }\n    }\n\nè¿™ä¸ªæ€ä¹ˆè§£é‡Š","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1604133617,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":164931,"ip_address":""},"score":319835,"extra":""}]},{"author":{"id":1304195,"avatar":"http://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTKtlEYuHnR8VdRkNPcmkIqTM9DKahpcpicDdBvcmBWMIAAhBrd0QNWvl09slqrzB5TibryVcIfPmb7Q/132","nickname":"raisecomer","note":"","ucode":"32EA488E46471F","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":106279,"discussion_content":"ä¸è¿‡ï¼Œåœ¨ç¬¬äºŒæ®µä»£ç ä¸­ï¼Œlistenerçº¿ç¨‹çš„æ—¶é—´ç‰‡è¿è¡Œå®Œäº†ï¼Œä¼šè¢«è®©å‡ºCPUï¼Œç­‰å®ƒæœ‰æœºä¼šé‡æ–°è·å¾—CPUæ—¶ï¼Œä¹Ÿæœ‰å¯èƒ½é‡æ–°åŠ è½½counterå˜é‡ï¼Œè¿™æ ·çš„è¯ï¼Œç¬¬äºŒæ®µä»£ç ä¹Ÿèƒ½æ­£ç¡®è·å¾—counterä¿®æ”¹åçš„å€¼ï¼Œä¸å¤ªæ˜ç™½ç¬¬äºŒå’Œç¬¬ä¸‰æ®µä»£ç çš„ä¸ºä½•ä¸ä¸€è‡´ã€‚","likes_number":2,"is_delete":false,"is_hidden":false,"ctime":1577527426,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1053568,"avatar":"https://static001.geekbang.org/account/avatar/00/10/13/80/8de66543.jpg","nickname":"å¾æ–‡æµ©","note":"","ucode":"1D39AC564172E9","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":478599,"discussion_content":"KnightÂ²ÂºÂ¹â¸åŒå­¦ï¼Œ\n\nä½ å¥½ï¼Œä½ è¯´çš„æœ‰é“ç†ï¼Œæˆ‘å»ä¿®æ”¹ä¸€ä¸‹ã€‚","likes_number":1,"is_delete":false,"is_hidden":false,"ctime":1581238397,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":2676330,"avatar":"https://static001.geekbang.org/account/avatar/00/28/d6/6a/1d844a27.jpg","nickname":"å†²å†²å†²","note":"","ucode":"4DA7596B5AFD51","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":580016,"discussion_content":"ä¸å¯¹å§ï¼Œå®˜æ–¹æ–‡æ¡£è¯´äº†sleepä¹‹åä¸ä¼šç¼“å­˜çš„\n In particular, the compiler does not have to flush writes cached in registers out to shared memory before a call to Thread.sleep or Thread.yield, nor does the compiler have to reload values cached in registers after a call to Thread.sleep or Thread.yield.","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1657807366,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":1,"child_discussions":[{"author":{"id":1390669,"avatar":"https://wx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTLAK6F4BFT5ewhJEeZrjmRx5HxP8tvnNpJcpLlotHiadp0s6aL3d7LfMHEuQP6tibu80wUy8micVu4oQ/132","nickname":"InfoQ_e077cb303519","note":"","ucode":"2CCA309DB2EF46","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":2676330,"avatar":"https://static001.geekbang.org/account/avatar/00/28/d6/6a/1d844a27.jpg","nickname":"å†²å†²å†²","note":"","ucode":"4DA7596B5AFD51","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":580604,"discussion_content":"å“¥ä»¬æ–‡æ¡£æ˜¯å“ªé‡Œçš„","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1658286598,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":580016,"ip_address":""},"score":580604,"extra":""}]}]},{"had_liked":false,"id":116097,"user_name":"æ—ä¸‰æ ","can_delete":false,"product_type":"c1","uid":1012832,"ip_address":"","ucode":"E667F986D07DC6","user_header":"https://static001.geekbang.org/account/avatar/00/0f/74/60/0403b575.jpg","comment_is_top":false,"comment_ctime":1563785494,"is_pvip":true,"discussion_count":8,"race_medal":0,"score":"78873196822","product_id":100026001,"comment_content":"åå¤çœ‹äº†å‡ æ¬¡å†™å›ç­–ç•¥ï¼Œæ‰çœ‹æ˜ç™½ã€‚ä¸»è¦æ˜¯â€œå¦‚æœæˆ‘ä»¬å‘ç°ï¼Œæˆ‘ä»¬è¦å†™å…¥çš„æ•°æ®æ‰€å¯¹åº”çš„ Cache Block é‡Œï¼Œæ”¾çš„æ˜¯åˆ«çš„å†…å­˜åœ°å€çš„æ•°æ®â€è¿™å¥ã€‚åŒä¸€ä¸ªcacheåœ°å€å¯èƒ½è¢«å¤šä¸ªè¿›ç¨‹ä½¿ç”¨ï¼Œä½¿ç”¨å‰éœ€è¦ç¡®è®¤æ˜¯å¦æ˜¯è‡ªå·±çš„æ•°æ®ï¼Œæ˜¯çš„è¯ï¼Œç›´æ¥å†™ï¼Œä¸æ˜¯è‡ªå·±çš„è€Œä¸”è¢«æ ‡è®°ä¸ºè„æ•°æ®ï¼Œéœ€è¦åŒæ­¥å›ä¸»å†…å­˜ã€‚è€å¸ˆï¼Œæˆ‘ç†è§£çš„å¯¹å§ï¼Ÿ","like_count":19,"discussions":[{"author":{"id":1147711,"avatar":"https://static001.geekbang.org/account/avatar/00/11/83/3f/bc2ea80d.jpg","nickname":"é™Œ.å¯’å“²","note":"","ucode":"B7079FF211D712","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":94860,"discussion_content":"åˆ«çš„å†…å­˜åœ°å€çš„æ•°æ®ï¼Œå¹¶ä¸æ˜¯æŒ‡åˆ«çš„è¿›ç¨‹ï¼Œç¼“å­˜æ˜¯å†…å­˜åœ°å€å–æ¨¡å¾—åˆ°çš„ï¼Œå°±åŒä¸€ä¸ªè¿›ç¨‹ç”šè‡³åŒä¸€ä¸ªçº¿ç¨‹ï¼Œéƒ½æœ‰å¯èƒ½é‡åˆ°åˆ«çš„å†…å­˜åœ°å€çš„æ•°æ®å•Šï¼Œçœ‹è¿‡ä¸Šä¸€ç¯‡åº”è¯¥å°±å¾ˆæ¸…æ¥š","likes_number":3,"is_delete":false,"is_hidden":false,"ctime":1576995801,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":1,"child_discussions":[{"author":{"id":1181650,"avatar":"https://static001.geekbang.org/account/avatar/00/12/07/d2/0d7ee298.jpg","nickname":"æƒ˜ é—»","note":"","ucode":"C5909F034BF072","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":1147711,"avatar":"https://static001.geekbang.org/account/avatar/00/11/83/3f/bc2ea80d.jpg","nickname":"é™Œ.å¯’å“²","note":"","ucode":"B7079FF211D712","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":389475,"discussion_content":"ç¡®å®","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1629288412,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":94860,"ip_address":""},"score":389475,"extra":""}]},{"author":{"id":1795371,"avatar":"https://static001.geekbang.org/account/avatar/00/1b/65/2b/446ef7b6.jpg","nickname":"è®¸å…ˆæ£®","note":"","ucode":"1F42D4A6B5C6AF","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":138495,"discussion_content":"æ˜¯è‡ªå·±çš„ï¼Œç›´æ¥è¦†ç›–ï¼Œå¹¶æ ‡è®°ä¸ºè„ï¼›ä¸æ˜¯è‡ªå·±çš„å¹¶ä¸”æ˜¯è„æ ‡è®°ï¼Œä¸¢åˆ°ä¸»å†…å­˜å»ï¼ŒæŠŠè‡ªå·±çš„è¦†ç›–è¿›æ¥ï¼Œæ ‡è®°ä¸ºè„ã€‚å¦‚æœä¸æ˜¯è‡ªå·±ä½†æ˜¯æ²¡æœ‰è„æ ‡è®°æ–‡ä¸­æ²¡è¯´ï¼Œæˆ‘è§‰å¾—åº”è¯¥ç›´æ¥è¦†ç›–ï¼Œå¹¶æ ‡è®°ä¸ºè„ã€‚","likes_number":1,"is_delete":false,"is_hidden":false,"ctime":1579248226,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":4,"child_discussions":[{"author":{"id":1514292,"avatar":"https://static001.geekbang.org/account/avatar/00/17/1b/34/4d8c5694.jpg","nickname":"Movan","note":"","ucode":"D5A2E9E2E7A439","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":1795371,"avatar":"https://static001.geekbang.org/account/avatar/00/1b/65/2b/446ef7b6.jpg","nickname":"è®¸å…ˆæ£®","note":"","ucode":"1F42D4A6B5C6AF","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":270775,"discussion_content":"å¦‚æœä¸æ˜¯è‡ªå·±ä½†æ˜¯æ²¡æœ‰è„æ ‡è®°->åº”è¯¥æŠŠå†…å­˜ä¸­çš„æ•°æ®è¯»å–åˆ°cache blockå§ï¼Œç„¶åå†å†™å…¥æ•°æ®åˆ°cache blockå§ï¼Œä¸Šé¢çš„æµç¨‹å›¾é‡Œå†™äº†","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1590052267,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":138495,"ip_address":""},"score":270775,"extra":""},{"author":{"id":1367877,"avatar":"http://thirdwx.qlogo.cn/mmopen/vi_32/VqgchrJWswwSLmxf1ict6icDDlZG5wChBEiaiblnJAQEdu1nYtB4EZq07mibUurOSDFr16dho6DhGyOpIW4eib57lK8Q/132","nickname":"ç®­æŒ‡æµäº‘","note":"","ucode":"21571A7D60B10D","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":1514292,"avatar":"https://static001.geekbang.org/account/avatar/00/17/1b/34/4d8c5694.jpg","nickname":"Movan","note":"","ucode":"D5A2E9E2E7A439","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":352774,"discussion_content":"å¦‚æœä¸æ˜¯è‡ªå·±çš„æ²¡æœ‰æ ‡è®°è„ï¼Œè¯´æ˜ç¼“å­˜ä¸­çš„æ•°æ®å’Œå†…å­˜ä¸­çš„æ•°æ®æ˜¯ä¸€è‡´çš„ã€‚å°†éœ€è¦å†™å…¥çš„æ•°æ®ç›´æ¥åœ¨ç¼“å­˜ä¸­è¦†ç›–ï¼Œæ ‡è®°ä¸ºè„å°±è¡Œäº†ï¼Œä¸ºä»€ä¹ˆéœ€è¦æŠŠå†…å­˜ä¸­çš„æ•°æ®è¯»å–åˆ°ç¼“å­˜ä¸­ï¼Œç„¶åå†è¿›è¡Œè¦†ç›–ï¼Œæ ‡è®°ä¸ºè„å‘¢ï¼Ÿ","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1614846454,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":270775,"ip_address":""},"score":352774,"extra":""},{"author":{"id":1123043,"avatar":"https://static001.geekbang.org/account/avatar/00/11/22/e3/510b69f9.jpg","nickname":"benny","note":"","ucode":"E2F30AF0C808D9","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":1367877,"avatar":"http://thirdwx.qlogo.cn/mmopen/vi_32/VqgchrJWswwSLmxf1ict6icDDlZG5wChBEiaiblnJAQEdu1nYtB4EZq07mibUurOSDFr16dho6DhGyOpIW4eib57lK8Q/132","nickname":"ç®­æŒ‡æµäº‘","note":"","ucode":"21571A7D60B10D","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":532230,"discussion_content":"åŒæ ·çš„ç–‘é—®","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1637560790,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":352774,"ip_address":""},"score":532230,"extra":"{\"user_type\":1}"}]},{"author":{"id":1074310,"avatar":"https://static001.geekbang.org/account/avatar/00/10/64/86/f5a9403a.jpg","nickname":"å¤šè¥„ä¸¸","note":"","ucode":"1AA1497C5A293C","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":37184,"discussion_content":"æˆ‘ä¹Ÿæœ‰åŒæ ·çš„ç–‘é—®","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1571540021,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":164748,"user_name":"ç‹åŠ æ­¦","can_delete":false,"product_type":"c1","uid":1665471,"ip_address":"","ucode":"DDCFE578C6C428","user_header":"https://static001.geekbang.org/account/avatar/00/19/69/bf/50a824a4.jpg","comment_is_top":false,"comment_ctime":1577085748,"is_pvip":false,"replies":[{"id":"68141","content":"HashåŒå­¦ï¼Œ<br><br>ğŸ‘ï¼ŒåŠ æ²¹ï¼Œä»å®è·µä¸­æœ‰æ‰€ä½“ä¼šæ˜¯æœ€å¥½çš„å­¦ä¹ æ–¹æ³•ã€‚","user_name":"ä½œè€…å›å¤","user_name_real":"å¾æ–‡æµ©","uid":"1053568","ctime":1580651930,"ip_address":"","comment_id":164748,"utype":1}],"discussion_count":2,"race_medal":0,"score":"70296562484","product_id":100026001,"comment_content":"ä¸åŠ volatitleå…³é”®å­—<br><br> private static int num = 1;<br>    public static void main(String[] args) {<br>        int[] arr = new int[8000000];<br>        for (int i = 0; i &lt; 8000000; i++) {<br>            arr[i] = num;<br>            num++;<br>        }<br>è¿è¡Œæ—¶é—´ä¸ºï¼š28æ¯«ç§’<br><br>åŠ äº†å…³é”®å­—<br>private static volatile int num = 1;<br>    public static void main(String[] args) {<br>        int[] arr = new int[8000000];<br>        for (int i = 0; i &lt; 8000000; i++) {<br>            arr[i] = num;<br>            num++;<br>        }<br><br>è¿è¡Œçš„æ—¶é—´ä¸º128æ¯«ç§’","like_count":16,"discussions":[{"author":{"id":1053568,"avatar":"https://static001.geekbang.org/account/avatar/00/10/13/80/8de66543.jpg","nickname":"å¾æ–‡æµ©","note":"","ucode":"1D39AC564172E9","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":478881,"discussion_content":"HashåŒå­¦ï¼Œ\n\nğŸ‘ï¼ŒåŠ æ²¹ï¼Œä»å®è·µä¸­æœ‰æ‰€ä½“ä¼šæ˜¯æœ€å¥½çš„å­¦ä¹ æ–¹æ³•ã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1580651930,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":2354332,"avatar":"https://static001.geekbang.org/account/avatar/00/23/ec/9c/b4acd768.jpg","nickname":"Sarah","note":"","ucode":"FDC8A0D30EAE28","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":379574,"discussion_content":"åœ¨C#é‡Œï¼ŒåŠ ä¸åŠ volatileéƒ½æ˜¯20ms","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1623988054,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":232965,"user_name":"è¥¿é—¨å¹ç‰›","can_delete":false,"product_type":"c1","uid":1508990,"ip_address":"","ucode":"E5D3624DDE1E83","user_header":"https://static001.geekbang.org/account/avatar/00/17/06/7e/735968e2.jpg","comment_is_top":false,"comment_ctime":1594178422,"is_pvip":false,"discussion_count":1,"race_medal":0,"score":"35953916790","product_id":100026001,"comment_content":"volatile å…³é”®å­—å»æ‰ï¼Œå˜é‡çš„æ›´æ–°æ˜¯å…ˆä»å†…å­˜ä¸­æŠŠå˜é‡åŠ è½½åˆ°è‡ªå·±çš„ç¼“å­˜ï¼Œ ChangeMaker çº¿ç¨‹æŠŠå˜é‡COUNTER = 0 åŠ è½½åˆ°è‡ªå·±çš„ç¼“å­˜ï¼Œå¹¶åœ¨è‡ªå·±çš„ç¼“å­˜å†…æ›´æ–°ã€‚ChangeMaker æ¯æ¬¡æ›´æ–°å®Œæˆåï¼Œä¼šè¿›è¡Œsleepï¼Œæ­¤æ—¶å›æŠŠæ›´æ–°çš„æ•°æ®åŒæ­¥åˆ°å†…å­˜ä¸­ã€‚è€Œ ChangeListener çº¿ç¨‹ï¼Œä¹Ÿæ˜¯å…ˆä»å†…å­˜ä¸­è·å–æ•°æ®ï¼Œå› ä¸ºä»–è‡ªå·±çš„ç¼“å­˜å†…æ²¡æœ‰è¯¥å˜é‡ã€‚ChangeListener çº¿ç¨‹ï¼Œç¬¬ä¸€æ¬¡ä»å†…å­˜ä¸­è¯»å–åˆ°çš„å˜é‡å€¼æ˜¯0ï¼Œå› ä¸ºè½¦æ­¤æ—¶ ChangeMaker çº¿ç¨‹å¯¹å˜é‡çš„æ›´æ–°è¿˜æ²¡æœ‰åŒæ­¥åˆ°å†…å­˜ï¼ŒChangeListener çº¿ç¨‹ä»å†…å­˜è¯»å–åˆ°0ï¼Œå¹¶æŠŠè¯¥å€¼åŠ è½½åˆ°ç¼“å­˜ï¼Œä¹‹åè¿›è¡Œå¾ªç¯ï¼Œæ¯æ¬¡å¾ªç¯éƒ½æ˜¯ä»è‡ªå·±çš„ç¼“å­˜ä¸­è¯»å–æ•°æ®ï¼Œæ‰€ä»¥ChangeListenerçº¿ç¨‹ä»æ¯æ¬¡å¾ªç¯ä»ç¼“å­˜ä¸­è·å–çš„å˜é‡å€¼æ˜¯0ï¼›<br>ChangeListener çº¿ç¨‹ä¿®æ”¹ä¸ºåœ¨å¾ªç¯å†…Thread.sleep(5)ã€‚çº¿ç¨‹ä¼‘çœ ç»“æŸåï¼Œæ¯æ¬¡ä¼‘çœ ç»“æŸï¼Œçº¿ç¨‹éƒ½ä¼šåœ¨ä»å†…å­˜ä¸­åœ¨è¯»å–ä¸€æ¬¡æ•°æ®ï¼Œè¿™æ—¶ä¼‘çœ æ—¶é—´ä¸º5ç§’ï¼Œåˆšå¥½ChangeMaker çº¿ç¨‹æ¯æ¬¡æ›´æ–°ä¹Ÿä¼‘çœ 5ç§’ï¼Œè¿™æ—¶ï¼ŒChangeMakerçº¿ç¨‹å¯¹å˜é‡çš„æ›´æ–°ï¼Œåœ¨åŒæ­¥åˆ°å†…å­˜åï¼Œåˆšå¥½è¢«ChangeListener çº¿ç¨‹è¯»å–åˆ°ï¼›<br>æ‰€ä»¥ï¼Œèƒ½å¾—å‡ºç»“è®ºï¼Œsleepä¹‹åï¼Œçº¿ç¨‹æœ‰è¶³å¤Ÿçš„æ—¶é—´å°†ç¼“å­˜åŒæ­¥åˆ°å†…å­˜ï¼Œå¦‚æœæ²¡æœ‰sleepï¼Œçº¿ç¨‹ä¸€ç›´åœ¨æ‰§è¡Œï¼Œå°±æ²¡æœ‰æ—¶é—´å°†ç¼“å­˜æ•°æ®åŒæ­¥åˆ°å†…å­˜ï¼ŒåŒæ—¶ï¼Œæ¯æ¬¡sleepä¹‹åï¼Œçº¿ç¨‹éƒ½ä¼šä»å†…å­˜ä¸­åœ¨è¯»å–ä¸€æ¬¡æ•°æ®åˆ°ç¼“å­˜ï¼Œè€Œä¸æ˜¯sleepä¹‹åï¼Œè¿˜æ˜¯è¯»å–è‡ªå·±çš„ç¼“å­˜æ•°æ®ã€‚<br>Java å†…å­˜æ¨¡å‹æ˜¯ä¸€ä¸ªéš”ç¦»äº†ç¡¬ä»¶å®ç°çš„è™šæ‹Ÿæœºå†…çš„æŠ½è±¡æ¨¡å‹ï¼Œä¸åŒçš„çº¿ç¨‹æˆ– CPU æ ¸æœ‰ç€è‡ªå·±å„è‡ªçš„ç¼“å­˜ï¼Œç¼“å­˜ä¼šå¯¼è‡´å¯è§æ€§é—®é¢˜ï¼Œå¯è§æ€§æ˜¯å¹¶å‘bugçš„æºå¤´ä¹‹ä¸€ã€‚æ‰€ä»¥javaå¼•å…¥volatileå…³é”®å­—ï¼Œèƒ½è§£å†³ç¼“å­˜å¸¦æ¥çš„çº¿ç¨‹ä¹‹é—´å¯è§æ€§çš„é—®é¢˜ã€‚javaå†…å­˜æ¨¡å‹ä¸­è§„å®šï¼Œä¸€ä¸ªçº¿ç¨‹å¯¹volatileä¿®é¥°å˜é‡çš„å†™æ“ä½œå…ˆå‘ä¸å¦ä¸€çº¿ç¨‹å¯¹äºè¯¥å˜é‡çš„è¯»æ“ä½œï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œé’ˆå¯¹volatileä¿®é¥°çš„å˜é‡ï¼Œä¸€ä¸ªçº¿ç¨‹è¦æƒ³è¯»å–åˆ°åˆ«çš„çº¿ç¨‹æ›´æ–°åçš„æ•°æ®ï¼Œå°±å¿…é¡»ä»å†…å­˜ä¸­è¯»å–ï¼Œè€Œä¸€ä¸ªçº¿ç¨‹çš„å†™æ“ä½œè¦æƒ³è¢«åˆ«çš„çº¿ç¨‹çœ‹åˆ°ï¼Œå°±å¿…é¡»ä¿è¯åœ¨æ›´æ–°å®Œä¹‹åï¼ŒåŒæ­¥åˆ°å†…å­˜ä¸­ã€‚æ‰€ä»¥volatileå…³é”®å­—çš„ä½œç”¨ï¼Œå°±æ˜¯ç¡®ä¿å˜é‡çš„è¯»å–å’Œå†™å…¥ï¼Œä¸€å®šä¼šåŒæ­¥åˆ°ä¸»å†…å­˜ï¼Œè€Œä¸åŸºäºcpuç¼“å­˜ä¸­çš„æ•°æ®è¿›è¡Œè¯»å–å’Œå†™å…¥ã€‚<br>è¦å®ç°å¯¹volatileä¿®é¥°çš„å˜é‡ï¼Œæ¯æ¬¡çš„è¯»å–å’Œå†™å…¥ï¼Œä¸€å®šä¼šåŒæ­¥åˆ°ä¸»å†…å­˜ã€‚javaçš„å®ç°æ–¹æ¡ˆæ˜¯åˆ©ç”¨å†…å­˜å±éšœæ¥å®ç°ï¼Œè€Œå†…å­˜å±éšœçš„å®ç°ï¼Œæ˜¯åŸºäºcpuæŒ‡ä»¤æ¥å®ç°çš„ã€‚ç»è¿‡volatileä¿®é¥°çš„å˜é‡ã€‚åœ¨ç»è¿‡jvmè§£é‡Šå™¨è§£é‡Šæˆæœºå™¨ç åï¼Œéƒ½ä¼šæ’å…¥ä¸€å†™å†…å­˜å±éšœçš„cpuæŒ‡ä»¤ï¼Œè¿™äº›cpuæŒ‡ä»¤çš„ä½œç”¨å°±æ˜¯ç¡®ä¿ï¼Œæ¯æ¬¡å¯¹volatileä¿®é¥°çš„å˜é‡çš„æ›´æ–°ï¼Œéƒ½å¿…é¡»åŒæ­¥åˆ°å†…å­˜ï¼Œè€Œæ¯æ¬¡è¯»å–volatileä¿®é¥°çš„å˜é‡ï¼Œéƒ½å¿…é¡»ä»å†…å­˜ä¸­è·å–ï¼Œè€Œä¸æ˜¯ç›´æ¥ä»cpuç¼“å­˜è·å–ã€‚<br>æ‰€ä»¥Javaå†…å­˜æ¨¡å‹éš”ç¦»äº†å…·ä½“çš„ç¡¬ä»¶å®ç°ï¼Œè¿™äº›å†…å­˜å±éšœçš„æŒ‡ä»¤éƒ½æ˜¯jvmåœ¨è§£é‡Šæ‰§è¡Œçš„æ—¶å€™åŠ ä¸Šçš„ï¼Œç¨‹åºå‘˜åªéœ€è¦åœ¨ä»£ç ä¸­ç”¨volatile ä¿®é¥°å³å¯ï¼Œè‡³äºvolatile åº•å±‚çš„å®ç°ï¼Œéƒ½æ˜¯åŸºäº java çš„å†…å­˜æ¨¡å¼å®ç°çš„ã€‚","like_count":8,"discussions":[{"author":{"id":1628434,"avatar":"https://static001.geekbang.org/account/avatar/00/18/d9/12/71db1407.jpg","nickname":"L","note":"","ucode":"A5CB3F1B4975BE","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":541029,"discussion_content":"è¥¿é—¨å¹~ç‰›","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1640238465,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":226369,"user_name":"Monday","can_delete":false,"product_type":"c1","uid":1250907,"ip_address":"","ucode":"77B9BACC783598","user_header":"https://static001.geekbang.org/account/avatar/00/13/16/5b/83a35681.jpg","comment_is_top":false,"comment_ctime":1592051346,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"27361855122","product_id":100026001,"comment_content":"ç®€è€Œè¨€ä¹‹ï¼Œvolatileå˜é‡å°±æ˜¯ç¦ç”¨Cache ","like_count":6},{"had_liked":false,"id":143620,"user_name":"æ›™å…‰","can_delete":false,"product_type":"c1","uid":1476450,"ip_address":"","ucode":"04D65BF7F19845","user_header":"https://static001.geekbang.org/account/avatar/00/16/87/62/f99b5b05.jpg","comment_is_top":false,"comment_ctime":1571746187,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"23046582667","product_id":100026001,"comment_content":"çœ‹äº†åé¢MESIåè®®çš„ä»‹ç»ï¼Œåè€Œå¯¹æœ¬ç« ç¤ºä¾‹ç¨‹åºæœ‰ç–‘é—®ï¼Œç¨‹åº(2)ä¸­ï¼Œè™½ç„¶å»æ‰äº†volatileçš„å…³é”®å­—ï¼Œä½†ChangeListeneråº”è¯¥æ¥æ”¶åˆ°â€œå†™å¤±æ•ˆâ€çš„å¹¿æ’­ï¼Œç„¶åä¸­æ–­å¿™ç­‰ï¼Œå†å»å†…å­˜è·å–æœ€æ–°æ•°æ®ã€‚é‚£æœ‰æ²¡æœ‰å¹¿æ’­åˆ°ChangeListenerçš„cpu cacheå‘¢ï¼Ÿ æœ¬äººi5-8250U, ChangeListeneréœ€è¦è‡³å°‘å¤§äºç­‰äºThread.sleep(495)æ‰èƒ½å’Œç¨‹åº(1)çš„æµ‹è¯•ç»“æœä¸€æ ·ï¼Œè¿™æ˜¯å’‹å›äº‹ï¼Ÿ","like_count":5},{"had_liked":false,"id":240004,"user_name":"æ ‘å†›","can_delete":false,"product_type":"c1","uid":1243906,"ip_address":"","ucode":"7BC6F00B94FB2F","user_header":"https://static001.geekbang.org/account/avatar/00/12/fb/02/1b74615c.jpg","comment_is_top":false,"comment_ctime":1596710300,"is_pvip":false,"discussion_count":3,"race_medal":0,"score":"18776579484","product_id":100026001,"comment_content":"è€å¸ˆï¼Œè¿™è®²é‡Œå¯¹volatileçš„è§£é‡Šæ˜¯å®Œå…¨é”™çš„ï¼Œcacheä»CPUçš„è§’åº¦æ¥çœ‹ï¼Œå¯¹ç¨‹åºå‘˜æ˜¯é€æ˜çš„ï¼Œä»è½¯ä»¶çœ‹è¿‡å»ä¸ä¼šå­˜åœ¨ä¸ä¸€è‡´çš„æƒ…å†µï¼Œåªæœ‰åœ¨å¤šmasterè®¿é—®çš„æ—¶å€™æ‰ä¼šå…³å¿ƒï¼Œæ¯”å¦‚DMAç­‰ã€‚è¿™é‡Œçš„ä¸ä¸€è‡´ä¸æ˜¯ç”±cacheé€ æˆçš„ï¼Œè€Œæ˜¯ç¼–è¯‘å™¨å¯¹å˜é‡ä¼˜åŒ–é€ æˆçš„ï¼Œå¿™ç­‰å¾…ä¸­ï¼Œå¦‚æœæ²¡æœ‰volatileå…³é”®å­—ï¼Œç¼–è¯‘å™¨è®¤ä¸ºè¿™ä¸ªå˜é‡ä¸ä¼šè¢«æ”¹å˜ï¼Œåˆ†é…ä¸€ä¸ªä¸´æ—¶å˜é‡ï¼Œä¸€èˆ¬å°±æ˜¯ä¸€ä¸ªå¯„å­˜å™¨ï¼Œæ¯æ¬¡è®¿é—®éƒ½ç›´æ¥è®¿é—®å¯„å­˜å™¨ï¼Œè€Œä¸å»è®¿é—®çœŸå®çš„åœ°å€é€ æˆçš„","like_count":4,"discussions":[{"author":{"id":2970895,"avatar":"https://thirdwx.qlogo.cn/mmopen/vi_32/o60fbNDEphdEwdxID9CzuK5Oy37xX9jNnSPGNkPTbEC9qfZ0icOCj4JiavEoj2H1XEsosDulT6iaKBCJGzt1DtCmQ/132","nickname":"Geek_d88316","note":"","ucode":"76D40D5B6316BB","race_medal":0,"user_type":1,"is_pvip":true},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":572027,"discussion_content":"cè¯­è¨€ä¸­å¯ä»¥çœ‹æ±‡ç¼–ï¼Œå°±æ˜¯ä¼˜åŒ–æˆå¯„å­˜å™¨ä¸­äº†ï¼Œå¹¶ä¸æ˜¯æ–‡ä¸­è¯´çš„æ²¡æœ‰æ—¶é—´å»æ›´æ–°","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1652568564,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":2325145,"avatar":"https://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTKkF14X58pdmTgBWwWzxVicJ0LQjNXiceL3xSj73eC4AZheyIPtf8tyqTicbP4VXia1TmDlm9rlCNCuDQ/132","nickname":"Geek_c2c8d1","note":"","ucode":"60B48691C86D6C","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":385490,"discussion_content":"volatile å…³é”®å­—ä¸ç®¡æ˜¯ä»åµŒå…¥å¼Cè¿˜æ˜¯ä»Javaé‡Œé¢è®²ï¼Œå…¶æ ¸å¿ƒå°±æ˜¯ä¸ºäº†å»ä¿è¯å¯¹å…±äº«æ•°æ®çš„æ“ä½œï¼Œèƒ½å¤Ÿå†™å›å†…å­˜ï¼Œè€Œä¸æ˜¯å¿«é€Ÿçš„è¯»å–å¯„å­˜å™¨æˆ–ç¼“å­˜ï¼Œå¯¼è‡´æ•°æ®ä¸ä¸€è‡´è€Œäº§ç”Ÿçš„é—®é¢˜ï¼Œä¸ªäººè§‰å¾—è¿™é‡Œçš„è§£é‡Šå¹¶æ²¡æœ‰é—®é¢˜ã€‚å¯¹ç¨‹åºå‘˜æ¥è¯´ï¼Œå°±ç®—æ˜¯Cç¨‹åºå‘˜ï¼Œä½ èƒ½å¤Ÿæ“çºµåˆ°çš„å†…å­˜ä¹Ÿåªèƒ½åˆ°ä¸»å†…å­˜ï¼Œè€ŒCPUå†…éƒ¨çš„å¯„å­˜å™¨ å’Œ ç¼“å­˜ï¼Œé™¤éæ˜¯CPUç‰¹å®šå¼€æ”¾ç»™ä½ ï¼Œå¦åˆ™ä½ æ˜¯çœ‹ä¸è§çš„ã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1627095413,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":2224677,"avatar":"https://static001.geekbang.org/account/avatar/00/21/f2/25/da66d3bb.jpg","nickname":"3","note":"","ucode":"262F048333F064","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":354892,"discussion_content":"å¯¹ç¨‹åºå‘˜ä¸æ˜¯é€æ˜çš„ æ˜¯æœ‰cpuæŒ‡ä»¤æ§åˆ¶çš„ï¼Œè€Œä¸”ä½ è¯´çš„volatieå¯„å­˜å™¨ æ˜¯æŒ‡cè¯­è¨€çš„volatileå§","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1615358584,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":116084,"user_name":"é˜¿é”‹","can_delete":false,"product_type":"c1","uid":1127761,"ip_address":"","ucode":"7AF449ABA89242","user_header":"https://static001.geekbang.org/account/avatar/00/11/35/51/c616f95a.jpg","comment_is_top":false,"comment_ctime":1563783337,"is_pvip":false,"discussion_count":5,"race_medal":0,"score":"14448685225","product_id":100026001,"comment_content":"ä¸Šé¢çš„æµç¨‹å›¾ä¸­ï¼Œæœ‰ä¸€æ­¥æ˜¯ä»ä¸»å†…å­˜è¯»å–æ•°æ®åˆ°cache block æˆ‘è§‰å¾—è¿™ä¸€æ­¥æ˜¯å¤šä½™çš„ï¼Œå› ä¸ºä¸‹é¢æ¥ä¸‹æ¥çš„ä¸€æ­¥æ˜¯å†™å…¥æ•°æ®åˆ°cache blockï¼Œä¹‹åéƒ½è¦å†™å…¥æ–°æ•°æ®äº†ï¼Œä¸ºå•¥è¿˜è¦è¯»ï¼Œä¸ç†è§£ï¼Ÿ","like_count":3,"discussions":[{"author":{"id":1517311,"avatar":"http://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTJEbZZ65d5ibzjadyKq6Odjs5eeSJGwxnfBAv7gKjp6vG5GUdz9YrXq54KZeAEsS1OfahWVZurXODg/132","nickname":"Akizuki","note":"","ucode":"2B48169ED18AC7","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":3140,"discussion_content":"ä¸æ˜¯å¤šä½™çš„ï¼Œå†™å…¥çš„æ•°æ®å¯èƒ½åªæ˜¯ cache block çš„ä¸€å°éƒ¨åˆ†","likes_number":9,"is_delete":false,"is_hidden":false,"ctime":1564217366,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":3,"child_discussions":[{"author":{"id":1124948,"avatar":"https://static001.geekbang.org/account/avatar/00/11/2a/54/c9990105.jpg","nickname":"bro.","note":"","ucode":"D65283CD869804","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":1517311,"avatar":"http://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTJEbZZ65d5ibzjadyKq6Odjs5eeSJGwxnfBAv7gKjp6vG5GUdz9YrXq54KZeAEsS1OfahWVZurXODg/132","nickname":"Akizuki","note":"","ucode":"2B48169ED18AC7","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":3328,"discussion_content":"ä¸å¯èƒ½å§ï¼Œå¦‚æœä¸æ˜¯åŒä¸€ä¸ªç¼“å­˜å—çš„æ•°æ®ï¼Œæ¯ä¸€ä¸ªç¼“å­˜å—è¿˜éœ€è¦ç»´æŠ¤å˜›ï¼Œæ˜¾ç„¶æ˜¯ä¸èƒ½å†ç»†åˆ†å—äº†å§","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1564397289,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":3140,"ip_address":""},"score":3328,"extra":""},{"author":{"id":1030816,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/ba/a0/f03d20cd.jpg","nickname":"likun","note":"","ucode":"9145ED059CCC6D","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":1517311,"avatar":"http://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTJEbZZ65d5ibzjadyKq6Odjs5eeSJGwxnfBAv7gKjp6vG5GUdz9YrXq54KZeAEsS1OfahWVZurXODg/132","nickname":"Akizuki","note":"","ucode":"2B48169ED18AC7","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":85792,"discussion_content":"èµ","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1576575783,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":3140,"ip_address":""},"score":85792,"extra":""},{"author":{"id":2270904,"avatar":"","nickname":"102447","note":"","ucode":"82B85EFB6AB052","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":1517311,"avatar":"http://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTJEbZZ65d5ibzjadyKq6Odjs5eeSJGwxnfBAv7gKjp6vG5GUdz9YrXq54KZeAEsS1OfahWVZurXODg/132","nickname":"Akizuki","note":"","ucode":"2B48169ED18AC7","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":332591,"discussion_content":"ç‰›é€¼,è¿™ä¸ªç†è§£èƒ½åŠ›äº†å¾—ï¼ï¼ï¼","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1607266958,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":3140,"ip_address":""},"score":332591,"extra":""}]},{"author":{"id":1795371,"avatar":"https://static001.geekbang.org/account/avatar/00/1b/65/2b/446ef7b6.jpg","nickname":"è®¸å…ˆæ£®","note":"","ucode":"1F42D4A6B5C6AF","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":138500,"discussion_content":"æˆ‘ä¹Ÿè§‰å¾—æ˜¯å¤šä½™çš„ã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1579248468,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":257794,"user_name":"é™é™è†å¬","can_delete":false,"product_type":"c1","uid":1263932,"ip_address":"","ucode":"0A8600CB928EFE","user_header":"https://static001.geekbang.org/account/avatar/00/13/49/3c/5d54c510.jpg","comment_is_top":false,"comment_ctime":1604132359,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"10194066951","product_id":100026001,"comment_content":"è€å¸ˆï¼Œä¸å¸¦valotileçš„å…³é”®å­—æœªæ›´æ–°ï¼Œæ˜¯javaç¼–è¯‘å™¨ï¼Œjitåšçš„ä¼˜åŒ–ï¼Œjitä¼šè®¤ä¸ºæ•°æ®æ²¡æœ‰å˜æ›´ï¼Œä¼˜åŒ–æˆä¸å†å»è·Ÿcpuäº¤äº’è¯»å–æ•°æ®äº†ï¼Œå°±æ˜¯è¯´æ²¡å¸¦valotileçš„å˜é‡ï¼Œæ•°æ®åªè¯»å–äº†ä¸€æ¬¡","like_count":2},{"had_liked":false,"id":225349,"user_name":"Qç½—","can_delete":false,"product_type":"c1","uid":1792098,"ip_address":"","ucode":"E797378F4DA1F4","user_header":"https://static001.geekbang.org/account/avatar/00/1b/58/62/346dd248.jpg","comment_is_top":false,"comment_ctime":1591720789,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"10181655381","product_id":100026001,"comment_content":"è®²è§£æ€è·¯æ¸…æ™°ï¼Œå¹¶ä¸”å¾ˆå®ç”¨ï¼Œâ€œæ‰€è°“è„çš„ï¼Œå°±æ˜¯æŒ‡è¿™ä¸ªæ—¶å€™ï¼Œæˆ‘ä»¬çš„ CPU Cache é‡Œé¢çš„è¿™ä¸ª Block çš„æ•°æ®ï¼Œå’Œä¸»å†…å­˜æ˜¯ä¸ä¸€è‡´çš„ã€‚â€è¿™ä¸ªè§£é‡Šå¾ˆåˆ°ä½ã€‚","like_count":3},{"had_liked":false,"id":197673,"user_name":"o_O","can_delete":false,"product_type":"c1","uid":1257283,"ip_address":"","ucode":"7C469AE3DA323B","user_header":"https://static001.geekbang.org/account/avatar/00/13/2f/43/e24212bb.jpg","comment_is_top":false,"comment_ctime":1585391034,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"10175325626","product_id":100026001,"comment_content":"thread sleepåšä¸Šä¸‹æ–‡åˆ‡æ¢éš¾é“ä¸ä¼šä¿ç•™ç¼“å­˜ä¸­çš„æ•°æ®å—ï¼Œå¦‚æœä¿å­˜äº†ä¸‹æ¬¡æ¢å¤ä¸è¿˜æ˜¯è„æ•°æ®å—ï¼Œä»€ä¹ˆæ—¶å€™ä»å†…å­˜è¯»å–çš„å‘¢ï¼Ÿ","like_count":1},{"had_liked":false,"id":172672,"user_name":"è®¸å…ˆæ£®","can_delete":false,"product_type":"c1","uid":1795371,"ip_address":"","ucode":"1F42D4A6B5C6AF","user_header":"https://static001.geekbang.org/account/avatar/00/1b/65/2b/446ef7b6.jpg","comment_is_top":false,"comment_ctime":1579249033,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"10169183625","product_id":100026001,"comment_content":"æ€»ç»“å†™å›ï¼šå¦‚æœè¦å†™å…¥çš„æ•°æ®å°±åœ¨CPUé«˜é€Ÿç¼“å­˜ä¸­ï¼Œåˆ™ç›´æ¥è¦†ç›–ï¼Œå¹¶æ ‡è®°ä¸ºè„ï¼›å¦‚æœä¸åœ¨ï¼Œå»æ‰¾åˆ°å¯¹åº”çš„é«˜é€Ÿç¼“å­˜å—ï¼›æ‰¾åˆ°ä¹‹åï¼Œå¦‚æœå‘ç°é«˜é€Ÿç¼“å­˜å—è¢«æ ‡è®°è„ï¼Œåˆ™æŠŠé‡Œé¢çš„æ•°æ®â€œä¸¢åˆ°â€å†…ä¸­å»ï¼Œè…¾å‡ºä½ç½®ï¼Œç„¶åè¦†ç›–æ–°æ•°æ®è¿›å»ï¼Œå¹¶ä¸”æ ‡è®°ä¸ºè„ï¼›å¦‚æœå‘ç°é«˜é€Ÿç¼“å­˜å—æ²¡æœ‰è¢«æ ‡è®°ä¸ºè„ï¼Œåˆ™ä¸ç®¡ä¸‰ä¸ƒäºŒåä¸€ï¼Œç®¡ä½ åŸæ¥æ•°æ®åœ¨å†…å­˜æœ‰æ²¡æœ‰â€œå¤‡ä»½â€ï¼Œæˆ‘ç›´æ¥è¦†ç›–æ–°æ•°æ®è¿›å»ï¼Œå¹¶ä¸”æ¯”è¾ƒä¸ºè„ã€‚","like_count":1},{"had_liked":false,"id":143636,"user_name":"éšå¿ƒè€Œè‡³","can_delete":false,"product_type":"c1","uid":1097836,"ip_address":"","ucode":"31866865255101","user_header":"https://static001.geekbang.org/account/avatar/00/10/c0/6c/29be1864.jpg","comment_is_top":false,"comment_ctime":1571749445,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"10161684037","product_id":100026001,"comment_content":"æ¯”å¦‚ï¼Œä¸‹é¢çš„ç¨‹åºï¼Œvolatileå˜é‡count æ¯æ¬¡éƒ½è¦å†™å›åˆ°å†…å­˜ï¼ˆMemoryï¼‰ä¸­ï¼Œè€Œsumæ˜¯çº¿ç¨‹æ ˆçš„æœ¬åœ°å˜é‡ï¼Œ æ¯æ¬¡éƒ½åªä¼šå†™åˆ°çº¿ç¨‹æ ˆä¸­ï¼ˆå¯ä»¥å¯¹åº”CPU Cacheï¼‰ã€‚æ‰€ä»¥æœ€åadd()&#47;add2()æ–¹æ³•çš„è€—æ—¶ï¼Œè¿‘ä¼¼äºMemoryè®¿é—®é€Ÿåº¦&#47;CPU Cacheè®¿é—®é€Ÿåº¦ã€‚<br>public class VolatilePerformanceTest {<br>    private static volatile int count =0;<br><br>    &#47;**<br>     * count++æ³¨æ„å¹¶ä¸æ˜¯åŸå­æ“ä½œã€‚<br>     *&#47;<br>    public static void add(){<br>        for(long i=0; i&lt; 100000000; i++){<br>            count++;<br>        }<br>    }<br>    public static void add2(){<br>        int sum = 0;<br>        for(int i=0; i&lt; 100000000; i++){<br>            sum++;<br>        }<br>    }<br><br>    public static void main(String[] args){<br>        long start =System.currentTimeMillis();<br>        &#47;&#47;753 ms<br>        add();<br>        System.out.println(System.currentTimeMillis() - start);<br>        start= System.currentTimeMillis();<br>        &#47;&#47;7ms<br>        add2();<br>        System.out.println(System.currentTimeMillis() - start);<br>    }<br>}","like_count":2},{"had_liked":false,"id":117114,"user_name":"WL","can_delete":false,"product_type":"c1","uid":1173771,"ip_address":"","ucode":"6277DCD776B87E","user_header":"https://static001.geekbang.org/account/avatar/00/11/e9/0b/1171ac71.jpg","comment_is_top":false,"comment_ctime":1563970890,"is_pvip":false,"discussion_count":4,"race_medal":0,"score":"10153905482","product_id":100026001,"comment_content":"è¯·é—®è€å¸ˆåœ¨å†™å›ç­–ç•¥ä¸­æ£€æŸ¥Cache Blockæ˜¯ä¸æ˜¯åˆ«çš„å†…å­˜åœ°å€çš„æ•°æ®æ˜¯å•¥æ„æ€, ä¸€ä¸ªcache blockä¸æ˜¯å¯¹åº”ä¸€ä¸ªå†…å­˜blockå—?","like_count":2,"discussions":[{"author":{"id":1683063,"avatar":"http://thirdwx.qlogo.cn/mmopen/vi_32/QYKSUV20DMgBHAPLfgngdw4N8FHRCSBLCJueVRu9Ya1Ba2x4icx70zoVVFOZtG1K6TkHj5CFbuztQhRFyCjWXHQ/132","nickname":"zaab","note":"","ucode":"EE846895FF0C85","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":30604,"discussion_content":"è¿™ä¸ªcache block æ˜¯CPUçš„ç¼“å­˜ï¼Œä½ å¾—ç†è§£ä¸ºä»€ä¹ˆè¦ç”¨å†™å›ç­–ç•¥ï¼Œ ä¸ºäº†ä¸ç”¨æ¯æ¬¡æ•°æ®æ›´æ–°éƒ½å»æ“ä½œä¸»å­˜ï¼Œè¿™æ ·å°±å¯ä»¥æé«˜æ•ˆç‡ã€‚æ—¶é—´å±€éƒ¨æ€§ï¼Œ ä¸€ä¸ªæ•°æ®è®¿é—®äº†çŸ­æ—¶é—´ä¼šè¢«å†æ¬¡è®¿é—®ã€‚æ¯”å¦‚æˆ‘ä»¬æ‹¿æ•°æ®ç¼“å­˜æœ‰å°±æ‹¿ç¼“å­˜çš„ï¼Œä¸ç”¨æ¯æ¬¡éƒ½åˆ°æ•°æ®åº“æ‹¿ï¼Œå› ä¸ºæ¯æ¬¡éƒ½ä»æ•°æ®åº“æ‹¿ï¼Œå¯¹æ¯”ç¼“å­˜æ¥è¯´å¤ªæ…¢äº†ã€‚","likes_number":1,"is_delete":false,"is_hidden":false,"ctime":1570845886,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1795371,"avatar":"https://static001.geekbang.org/account/avatar/00/1b/65/2b/446ef7b6.jpg","nickname":"è®¸å…ˆæ£®","note":"","ucode":"1F42D4A6B5C6AF","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":138498,"discussion_content":"ç¬¬ä¸€ï¼Œå›¾é‡Œçš„Cache Blockæ˜¯ç¼“å­˜å—ã€‚ç¬¬äºŒï¼Œä¸Šä¸€èŠ‚å°±è¯´äº†ï¼Œ13ã€21ã€29çš„å†…å­˜å—éƒ½å¯¹åº”é«˜é€Ÿç¼“å­˜å—5ï¼Œå¤šå¯¹1çš„å…³ç³»ã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1579248384,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1240270,"avatar":"","nickname":"æ¢…åŠå¸å¿","note":"","ucode":"702F019BA3356C","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":51993,"discussion_content":"ä¸æ˜¯ å¯ä»¥å¯¹åº”å¤šä¸ª æ¯”å¦‚ä¸Šä¸€èŠ‚å¤šå¯¹ä¸€","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1573981433,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":1,"child_discussions":[{"author":{"id":1147461,"avatar":"https://static001.geekbang.org/account/avatar/00/11/82/45/981ac8ab.jpg","nickname":"lcp","note":"","ucode":"3C9975BFF7654E","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":1240270,"avatar":"","nickname":"æ¢…åŠå¸å¿","note":"","ucode":"702F019BA3356C","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":138308,"discussion_content":"ä¸Šä¸€èŠ‚è¯´çš„åº”è¯¥æ˜¯ï¼šå¤šä¸ª cache block å¯¹åº”ä¸€ä¸ª cache lineï¼Œcache block æ˜¯åœ¨å†…å­˜é‡Œé¢çš„å­˜å‚¨å•ä½","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1579235058,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":51993,"ip_address":""},"score":138308,"extra":""}]}]},{"had_liked":false,"id":116059,"user_name":"humor","can_delete":false,"product_type":"c1","uid":1181867,"ip_address":"","ucode":"9B48C4C7BEC92C","user_header":"https://static001.geekbang.org/account/avatar/00/12/08/ab/caec7bca.jpg","comment_is_top":false,"comment_ctime":1563779819,"is_pvip":false,"discussion_count":2,"race_medal":0,"score":"10153714411","product_id":100026001,"comment_content":"å†™å›çš„å†…å­˜å†™å…¥ç­–ç•¥çš„é‚£å¼ å›¾ä¸­ï¼Œä¸ºä»€ä¹ˆä¼šæœ‰ä»ä¸»å†…å­˜è¯»å–æ•°æ®åˆ°cache blockè¿™ä¸€æ­¥å‘¢ï¼Ÿåæ­£è¯»å…¥äº†ä¸»å†…å­˜çš„æ•°æ®ä¹Ÿè¦è¢«å½“å‰çš„æ•°æ®è¦†ç›–æ‰çš„","like_count":2,"discussions":[{"author":{"id":1795371,"avatar":"https://static001.geekbang.org/account/avatar/00/1b/65/2b/446ef7b6.jpg","nickname":"è®¸å…ˆæ£®","note":"","ucode":"1F42D4A6B5C6AF","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":138501,"discussion_content":"å…¶å®ä½œè€…æƒ³è¡¨è¾¾çš„æ„æ€åº”è¯¥æ˜¯ä»å†…å­˜è¯»å–æƒ³å†™å…¥çš„æ–°æ•°æ®è¦†ç›–è¿›æ¥ï¼Œåé¢â€œå†™å…¥æ•°æ®åˆ°é«˜é€Ÿç¼“å­˜ä¸­â€é‡å¤äº†ï¼Œæ„Ÿè§‰æœ‰ç‚¹å¤šä½™ï¼Œå®¹æ˜“è¯¯å¯¼äºº","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1579248613,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1475340,"avatar":"https://static001.geekbang.org/account/avatar/00/16/83/0c/b9e39db4.jpg","nickname":"éŸ©ä¿Šè‡£","note":"","ucode":"D6A15C025570D5","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":37239,"discussion_content":"åŒé—®ï¼Œè€Œä¸”å¦‚æœæ˜¯è¯¥cache blockæ²¡æœ‰è¢«æ ‡ä¸ºè„çš„è¯ï¼Œä¸ºå•¥è¿˜è¦ä»ä¸»å†…å­˜å†å†™å…¥ä¸€éæ•°æ®ï¼Ÿ","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1571556006,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":277082,"user_name":"ano","can_delete":false,"product_type":"c1","uid":1783342,"ip_address":"","ucode":"7DE64BDFA78550","user_header":"https://static001.geekbang.org/account/avatar/00/1b/36/2e/376a3551.jpg","comment_is_top":false,"comment_ctime":1612255789,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"5907223085","product_id":100026001,"comment_content":"volatileä¸ºä»€ä¹ˆä¸ ä»cpuçš„ L3 cacheé‡Œè¯»å†™ï¼ŸL3 cacheæ˜¯å¤šä¸ªcoreå…±äº«çš„ï¼ŒåŒæ ·å¯ä»¥è§£å†³è¿™ä¸ªå¹¶å‘çš„é—®é¢˜","like_count":1},{"had_liked":false,"id":240361,"user_name":"ä»°æœ›æ˜Ÿç©º","can_delete":false,"product_type":"c1","uid":1149084,"ip_address":"","ucode":"A9E46C9FDB3275","user_header":"https://static001.geekbang.org/account/avatar/00/11/88/9c/cbc463e6.jpg","comment_is_top":false,"comment_ctime":1596876769,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"5891844065","product_id":100026001,"comment_content":"å¯¹æœªä½¿ç”¨volatileä¿®é¥°çš„å…±äº«å˜é‡ï¼ŒChangeMakeråœ¨å…¶Cacheä¸­å¯¹è¯¥å˜é‡è¿›è¡Œä¿®æ”¹ï¼Œè¦æƒ³åœ¨ChangeListenerèƒ½ç›‘å¬åˆ°ï¼Œå¦‚ä¸‹ä¸¤ä¸ªæ¡ä»¶ç¼ºä¸€ä¸å¯ï¼š<br>1ã€ChangeMakerä¸­å¯¹å˜é‡ä¿®æ”¹åï¼Œå¿…é¡»è°ƒç”¨sleepï¼Œè¿™æ ·å½“å‰CPUæ ¸æ‰æœ‰ç©ºé—²æ—¶é—´å°†ä¿®æ”¹åçš„å˜é‡å€¼åŒæ­¥åˆ°ä¸»å†…å­˜ã€‚<br>2ã€ChangeListeneråœ¨è¯»å˜é‡çš„è¿‡ç¨‹ä¸­ï¼Œä¹Ÿå¿…é¡»sleepï¼Œè¿™æ ·å½“å‰CPUæ ¸æ‰æœ‰ç©ºé—²æ—¶é—´ä»ä¸»å†…å­˜ä¸­é‡æ–°åŠ è½½å˜é‡å€¼ã€‚<br>è¯´åˆ°åº•ï¼Œè¿™ä¹Ÿæ˜¯JMMçš„ä¸€ç§ç­–ç•¥","like_count":1},{"had_liked":false,"id":232599,"user_name":"Dovelol","can_delete":false,"product_type":"c1","uid":1253384,"ip_address":"","ucode":"9B5DDF7720F307","user_header":"https://static001.geekbang.org/account/avatar/00/13/20/08/bc06bc69.jpg","comment_is_top":false,"comment_ctime":1594046325,"is_pvip":false,"discussion_count":1,"race_medal":0,"score":"5889013621","product_id":100026001,"comment_content":"è€å¸ˆå¥½ï¼Œæƒ³é—®ä¸€ä¸‹ï¼Œjavaå†…å­˜æ¨¡å‹é‡Œé¢çš„æ¯ä¸ªçº¿ç¨‹çš„ç¼“å­˜æ˜¯ä¸æ˜¯å°±æ˜¯cpuçš„cacheå‘¢ï¼Ÿè¿˜æ˜¯è¯´javaä¹Ÿå®ç°äº†ä¸€å¥—ç±»ä¼¼äºcpuï¼Œl1cacheçš„æ¨¡å‹ï¼Ÿ","like_count":1,"discussions":[{"author":{"id":1810189,"avatar":"http://thirdwx.qlogo.cn/mmopen/vi_32/ZHw73tgCqGKhvticUWGRz4icgicu4hFWfKtacoFJeItH7maNuNUmjnEgDTJvOibwUWgGV0p6guNPibMVWDV4BUmEmlA/132","nickname":"Ethan","note":"","ucode":"75F613D58909DB","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":301260,"discussion_content":"åŒé—®ï¼ï¼æœ›è§£ç­”","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1598454203,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":172668,"user_name":"è®¸å…ˆæ£®","can_delete":false,"product_type":"c1","uid":1795371,"ip_address":"","ucode":"1F42D4A6B5C6AF","user_header":"https://static001.geekbang.org/account/avatar/00/1b/65/2b/446ef7b6.jpg","comment_is_top":false,"comment_ctime":1579248768,"is_pvip":false,"replies":[{"id":"68074","content":"è®¸å…ˆæ£®åŒå­¦ï¼Œ<br><br>æ˜¯çš„ï¼Œè¿™é‡ŒæŒ‡çš„æ˜¯Cacheï¼Œä¸æ˜¯ä¸»å†…å­˜ã€‚","user_name":"ä½œè€…å›å¤","user_name_real":"å¾æ–‡æµ©","uid":"1053568","ctime":1580631262,"ip_address":"","comment_id":172668,"utype":1}],"discussion_count":1,"race_medal":0,"score":"5874216064","product_id":100026001,"comment_content":"æ–‡ä¸­æœ‰å†™ï¼šâ€œå†™å›ç­–ç•¥çš„è¿‡ç¨‹æ˜¯è¿™æ ·çš„ï¼šå¦‚æœå‘ç°æˆ‘ä»¬è¦å†™å…¥çš„æ•°æ®ï¼Œå°±åœ¨ CPU Cache é‡Œé¢ï¼Œé‚£ä¹ˆæˆ‘ä»¬å°±åªæ˜¯æ›´æ–° CPU Cache é‡Œé¢çš„æ•°æ®ã€‚åŒæ—¶ï¼Œæˆ‘ä»¬ä¼šæ ‡è®° CPU Cache é‡Œçš„è¿™ä¸ª Block æ˜¯è„ï¼ˆDirtyï¼‰çš„ã€‚æ‰€è°“è„çš„ï¼Œå°±æ˜¯æŒ‡è¿™ä¸ªæ—¶å€™ï¼Œæˆ‘ä»¬çš„ CPU Cache é‡Œé¢çš„è¿™ä¸ª Block çš„æ•°æ®ï¼Œå’Œä¸»å†…å­˜æ˜¯ä¸ä¸€è‡´çš„ã€‚â€<br>æ‰€ä»¥å›¾é‡Œçš„Cache BlockæŒ‡çš„æ˜¯CPUé«˜é€Ÿç¼“å­˜å—ï¼Œä¸æ˜¯å†…å­˜å—ã€‚","like_count":1,"discussions":[{"author":{"id":1053568,"avatar":"https://static001.geekbang.org/account/avatar/00/10/13/80/8de66543.jpg","nickname":"å¾æ–‡æµ©","note":"","ucode":"1D39AC564172E9","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":481812,"discussion_content":"è®¸å…ˆæ£®åŒå­¦ï¼Œ\n\næ˜¯çš„ï¼Œè¿™é‡ŒæŒ‡çš„æ˜¯Cacheï¼Œä¸æ˜¯ä¸»å†…å­˜ã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1580631262,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":161982,"user_name":"èŠ±æ™¨å°‘å¹´","can_delete":false,"product_type":"c1","uid":1098987,"ip_address":"","ucode":"6AA3537A6BA10E","user_header":"https://static001.geekbang.org/account/avatar/00/10/c4/eb/2285a345.jpg","comment_is_top":false,"comment_ctime":1576423240,"is_pvip":false,"replies":[{"id":"68138","content":"ğŸ™ è°¢è°¢æ”¯æŒ","user_name":"ä½œè€…å›å¤","user_name_real":"å¾æ–‡æµ©","uid":"1053568","ctime":1580651171,"ip_address":"","comment_id":161982,"utype":1}],"discussion_count":1,"race_medal":0,"score":"5871390536","product_id":100026001,"comment_content":"è®²å¾—å¥½å•Šï¼Œé€å½»","like_count":1,"discussions":[{"author":{"id":1053568,"avatar":"https://static001.geekbang.org/account/avatar/00/10/13/80/8de66543.jpg","nickname":"å¾æ–‡æµ©","note":"","ucode":"1D39AC564172E9","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":477937,"discussion_content":"ğŸ™ è°¢è°¢æ”¯æŒ","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1580651171,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":350513,"user_name":"ä¸€é ­è »ç‰›","can_delete":false,"product_type":"c1","uid":1209653,"ip_address":"","ucode":"887E596A1DBF2D","user_header":"https://static001.geekbang.org/account/avatar/00/12/75/35/a0c15ca8.jpg","comment_is_top":false,"comment_ctime":1656980344,"is_pvip":true,"discussion_count":0,"race_medal":1,"score":"1656980344","product_id":100026001,"comment_content":"è€å¸ˆè®²çš„å¾ˆå¥½ å”¯ä¸€å°±æ˜¯ä¸è¯¥ç”¨Javaæ¥è·ç¦» å¢åŠ äº†ç†è§£çš„å¤æ‚ç¨‹åº¦","like_count":1},{"had_liked":false,"id":343532,"user_name":"å°æ°","can_delete":false,"product_type":"c1","uid":2853200,"ip_address":"","ucode":"BBDF8E9F348F65","user_header":"https://static001.geekbang.org/account/avatar/00/2b/89/50/aee9fdab.jpg","comment_is_top":false,"comment_ctime":1650894470,"is_pvip":true,"discussion_count":0,"race_medal":0,"score":"1650894470","product_id":100026001,"comment_content":"public class testVolatileRunTime {<br>    private static  int COUNTER = 0;<br>    public static void main(String[] args) {<br>        long starTime = System.currentTimeMillis();<br>        &#47;&#47;è®¡ç®—å¾ªç¯è¯»å†™COUNTERçš„æ—¶é—´<br>        int[] arr = new int[8000000];<br>        for (int i = 0; i &lt; 8000000; i++) {<br>           arr[i] = COUNTER;<br>           COUNTER++;<br>        }<br>        long endTime = System.currentTimeMillis();<br>        long Time = endTime - starTime;<br>        System.out.println(Time);<br>    }<br>}<br>å»ºè®®å¤§å®¶å»è·‘ä¸€ä¸‹ã€‚å·®åˆ«è¿˜æ˜¯å¾ˆå¤§çš„","like_count":0},{"had_liked":false,"id":336626,"user_name":"jameswu","can_delete":false,"product_type":"c1","uid":2907330,"ip_address":"","ucode":"A3537F45B0EB57","user_header":"https://static001.geekbang.org/account/avatar/00/2c/5c/c2/d17cc923.jpg","comment_is_top":false,"comment_ctime":1646265829,"is_pvip":true,"discussion_count":0,"race_medal":0,"score":"1646265829","product_id":100026001,"comment_content":"æ•´ä¸ªè®²çš„æŒºå¥½çš„ï¼Œä½†æ˜¯volatileçš„ä¾‹å­ä¸å¥½ã€‚volatileæ˜¯å‘Šè¯‰ç¼–è¯‘å™¨ä¼˜åŒ–ç”¨çš„â€¦æ¯æ¬¡ç¼–è¯‘å™¨çœ‹åˆ°å®ƒä¿®é¥°çš„å˜é‡æ—¶ï¼Œéƒ½ä¼šç”Ÿæˆdptrï¼Œä»å†…å­˜æ‹¿æ•°ï¼Œè€Œä¸æ˜¯å¯„å­˜å™¨","like_count":0},{"had_liked":false,"id":313936,"user_name":"æ˜“é£","can_delete":false,"product_type":"c1","uid":2630424,"ip_address":"","ucode":"32AC28754237F7","user_header":"https://static001.geekbang.org/account/avatar/00/28/23/18/4284361f.jpg","comment_is_top":false,"comment_ctime":1632747355,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1632747355","product_id":100026001,"comment_content":"getç¼“å­˜ä¸€è‡´æ€§é—®é¢˜â€¦","like_count":0},{"had_liked":false,"id":301424,"user_name":"Geek_d60492","can_delete":false,"product_type":"c1","uid":2599089,"ip_address":"","ucode":"9A79B12F0D3D63","user_header":"https://static001.geekbang.org/account/avatar/00/27/a8/b1/092b658f.jpg","comment_is_top":false,"comment_ctime":1625672213,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1625672213","product_id":100026001,"comment_content":"å†™ç›´è¾¾åœ¨ç¼“å­˜å‘½ä¸­çš„å‰æä¸‹å¯ä»¥ç†è§£ä¸ºCPUåŒæ—¶å‘Cacheå’Œä¸»å­˜å†™å…¥å—ï¼Ÿå¦‚æœæ˜¯çš„è¯ä¸ºäº†æé«˜CPUæ‰§è¡Œæ•ˆç‡æ˜¯å¦å¯ä»¥å°†å†™ä¸»å­˜è¿‡ç¨‹é€šè¿‡å¼‚æ­¥ç¼“å†²åŒºçš„æ–¹å¼å†™å›å‘¢ï¼Ÿ","like_count":0},{"had_liked":false,"id":296245,"user_name":"è½ç»£","can_delete":false,"product_type":"c1","uid":1755477,"ip_address":"","ucode":"60955E14C39C6B","user_header":"https://static001.geekbang.org/account/avatar/00/1a/c9/55/0e627a31.jpg","comment_is_top":false,"comment_ctime":1622858471,"is_pvip":false,"discussion_count":2,"race_medal":0,"score":"1622858471","product_id":100026001,"comment_content":"L1æŒ‡ä»¤ç¼“å­˜å’ŒL1æ•°æ®ç¼“å­˜ä¸ºä»€ä¹ˆä¸èƒ½åˆå¹¶å‘¢","like_count":0,"discussions":[{"author":{"id":2806043,"avatar":"https://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTLBFkSq1oiaEMRjtyyv4ZpCI0OuaSsqs04ODm0OkZF6QhsAh3SvqhxibS2n7PLAVZE3QRSn5Hic0DyXg/132","nickname":"ddh","note":"","ucode":"8E852375365F16","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":540424,"discussion_content":"å‰é¢è®²cpuçš„æ—¶å€™æœ‰è®²ï¼Œ ä½†æ˜¯æˆ‘ä¹Ÿä¸ç†è§£","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1640056440,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1061803,"avatar":"https://static001.geekbang.org/account/avatar/00/10/33/ab/d8ba4242.jpg","nickname":"å“’å“’å“’","note":"","ucode":"9378AD329F8AE0","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":383119,"discussion_content":"æˆ‘ç†è§£åˆ†å¼€è¿˜æ˜¯ä¸ºäº†æ•ˆç‡ã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1625910514,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":281434,"user_name":"mghio","can_delete":false,"product_type":"c1","uid":1213078,"ip_address":"","ucode":"74883EDE4FD0DC","user_header":"https://static001.geekbang.org/account/avatar/00/12/82/96/aa795685.jpg","comment_is_top":false,"comment_ctime":1614749889,"is_pvip":true,"discussion_count":0,"race_medal":0,"score":"1614749889","product_id":100026001,"comment_content":"MacBook Pro (13-inch, 2020, Two Thunderbolt 3 ports)ï¼Œå¤„ç†å™¨ï¼š1.4 GHz å››æ ¸ Intel Core i5 ä½¿ç”¨ Java çš„ volatile å…³é”®å­—æ²¡æœ‰è¿™ä¸ªæ•ˆæœï¼Œå¦ JDK ç‰ˆæœ¬ä¸ºï¼šopenjdk 11.","like_count":0},{"had_liked":false,"id":253659,"user_name":"Ishmael","can_delete":false,"product_type":"c1","uid":1312115,"ip_address":"","ucode":"87CAF00A0BB25A","user_header":"https://static001.geekbang.org/account/avatar/00/14/05/73/89148275.jpg","comment_is_top":false,"comment_ctime":1602820197,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1602820197","product_id":100026001,"comment_content":"æ€»çº¿è¿™ä¸ªæ¦‚å¿µ å¥½åƒå°±æ˜¯EventBuså§ æœç„¶è½¯ç¡¬ä¸åˆ†å®¶","like_count":0},{"had_liked":false,"id":239985,"user_name":"ä»°æœ›æ˜Ÿç©º","can_delete":false,"product_type":"c1","uid":1149084,"ip_address":"","ucode":"A9E46C9FDB3275","user_header":"https://static001.geekbang.org/account/avatar/00/11/88/9c/cbc463e6.jpg","comment_is_top":false,"comment_ctime":1596706831,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1596706831","product_id":100026001,"comment_content":"å†™å›çš„åœºæ™¯å¦‚ä¸‹ï¼š<br>æ•°æ®Aå‡†å¤‡å†™å›åˆ°Cache Lineï¼Œå°±è¯´æ˜ä¹‹å‰ä»å†…å­˜ä¸­è¢«åŠ è½½åˆ°Cache Lineï¼Œå› æ­¤è¯¥Cache Lineè‚¯å®šä¸ä¸ºç©ºï¼Œè‡³äºå…¶ä¸­çš„æ•°æ®ï¼Œæœ‰å¦‚ä¸‹ä¸¤ç§æƒ…å†µï¼š<br>1ã€å­˜æ”¾çš„æ˜¯æ•°æ®A<br>CPUç›´æ¥å°†Aå†™å…¥åˆ°Cache Lineï¼Œå¹¶æ ‡è®°è¯¥æ•°æ®ä¸ºè„ã€‚è„çš„æ„æ€æ˜¯ï¼Œè¯¥æ•°æ®åœ¨Cache Lineå’Œå†…å­˜ä¸­ä¸æ˜¯ä¸€è‡´çš„ã€‚<br><br>2ã€å­˜æ”¾çš„æ˜¯å…¶å®ƒæ•°æ®Bï¼Œè¿™æ—¶åˆåˆ†ä¸ºå¦‚ä¸‹ä¸¤ç§æƒ…å†µï¼š<br>     2.1ã€Bä¸ºè„<br>            å°†Bå†™å…¥å†…å­˜ï¼Œä¿è¯å†…å­˜ä¸­çš„Bæ˜¯æœ€æ–°çš„å€¼ã€‚ç„¶åæ‰ä¼šå°†Aå†™å…¥åˆ° <br>            Cache Lineï¼Œå¹¶æ ‡è®°ä½è„ã€‚<br>     2.2ã€Bä¸ä¸ºè„<br>             ä¸ä¸ºè„å°±è¯´æ˜å†…å­˜ä¸­çš„Bçš„å€¼å°±æ˜¯æœ€æ–°çš„ï¼Œå°±æ²¡å¿…è¦é‡æ–°å†™å…¥åˆ°å†…å­˜ã€‚æ­¤æ—¶åªéœ€è¦å°†Aå†™å…¥åˆ° Cache Lineï¼Œå¹¶æ ‡è®°ä½è„ã€‚<br><br>","like_count":0},{"had_liked":false,"id":239128,"user_name":"ä»°æœ›æ˜Ÿç©º","can_delete":false,"product_type":"c1","uid":1149084,"ip_address":"","ucode":"A9E46C9FDB3275","user_header":"https://static001.geekbang.org/account/avatar/00/11/88/9c/cbc463e6.jpg","comment_is_top":false,"comment_ctime":1596442349,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1596442349","product_id":100026001,"comment_content":"public class VolatileTest {<br>    private static volatile int withVolatileSum = 0;<br>    private static int withoutVolatileSum = 0;<br><br>    public static void main(String[] args) {<br>        withVolatile();<br>        withoutVolatile();<br>    }<br><br>    public static void withVolatile() {<br>        long start = System.currentTimeMillis();<br>        for (int i = 0; i &lt; 10000; i++) {<br>            for (int j = 0; j &lt; 10000; j++) {<br>                withVolatileSum += 1;<br>            }<br>        }<br>        System.out.println(System.currentTimeMillis() - start);<br>    }<br><br>    public static void withoutVolatile() {<br>        long start = System.currentTimeMillis();<br>        for (int i = 0; i &lt; 10000; i++) {<br>            for (int j = 0; j &lt; 10000; j++) {<br>                withoutVolatileSum += 1;<br>            }<br>        }<br>        System.out.println(System.currentTimeMillis() - start);<br>    }<br><br>}<br>è¿è¡Œç»“æœï¼š<br>729<br>13<br>å·®åˆ«å¾ˆå¤§","like_count":0},{"had_liked":false,"id":226370,"user_name":"Monday","can_delete":false,"product_type":"c1","uid":1250907,"ip_address":"","ucode":"77B9BACC783598","user_header":"https://static001.geekbang.org/account/avatar/00/13/16/5b/83a35681.jpg","comment_is_top":false,"comment_ctime":1592051559,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1592051559","product_id":100026001,"comment_content":"public class VolatileTest3 {<br>    private static volatile int COUNTER = 0;<br>    static int count = 0;<br>    static int size = 100000000;<br><br>    public static void main(String[] args) {<br><br>        long start2 = System.currentTimeMillis();<br>        for (int i = 0; i &lt; size; i++) {<br>            COUNTER = i;<br>        }<br>        System.out.println(&quot; volatile è€—æ—¶ï¼š&quot; + (System.currentTimeMillis() - start2));<br><br>        long start = System.currentTimeMillis();<br>        for (int i = 0; i &lt; size; i++) {<br>            count = i;<br>        }<br>        System.out.println(&quot; é volatile è€—æ—¶ï¼š&quot; + (System.currentTimeMillis() - start));<br><br>    }<br><br>}<br><br><br><br> volatile è€—æ—¶ï¼š672<br> é volatile è€—æ—¶ï¼š8","like_count":0},{"had_liked":false,"id":222553,"user_name":"å¤šè¥„ä¸¸","can_delete":false,"product_type":"c1","uid":1074310,"ip_address":"","ucode":"1AA1497C5A293C","user_header":"https://static001.geekbang.org/account/avatar/00/10/64/86/f5a9403a.jpg","comment_is_top":false,"comment_ctime":1590833346,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1590833346","product_id":100026001,"comment_content":"\t&#47;&#47; increacing counter to 1.<br>\t&#47;&#47;increacing counter to 2.<br>\t&#47;&#47;increacing counter to 3.<br>\t&#47;&#47;increacing counter to 4.<br>\t&#47;&#47;increacing counter to 5.<br>\t&#47;&#47;got change for counter: 1.\t<br><br><br>\t&#47;&#47; è€å¸ˆï¼Œ æˆ‘ counter ç”¨ volatile ä¿®é¥°, åŒæ—¶ï¼Œæˆ‘å»æ‰äº† ChangeListener å’Œ ChangeMaker ä¸­çš„ æ‰€æœ‰sleepæ“ä½œï¼Œ å†æ— å…¶ä»–ä¿®æ”¹ã€‚<br>\t&#47;&#47; çº¿ç¨‹æœ€ç»ˆéƒ½æ­£ç¡®é€€å‡ºäº†ï¼Œ ä½†ç»“æœ ChangeMaker çœ‹åˆ°äº†å¢åŠ åˆ° 1ï¼Œ 2ï¼Œ 3ï¼Œ 4ï¼Œ 5 çš„è¿‡ç¨‹<br>\t&#47;&#47; è€Œ ChangeListener åªçœ‹åˆ°äº† 1ï¼Œ è¯·é—®è€å¸ˆ ä¸ºä»€ä¹ˆChangeListener åªçœ‹åˆ°äº† 1 å°±é€€å‡ºäº†ï¼Ÿ","like_count":0},{"had_liked":false,"id":217604,"user_name":"é™ˆé‡‘é¾™","can_delete":false,"product_type":"c1","uid":1571152,"ip_address":"","ucode":"684F1C733A6C27","user_header":"https://static001.geekbang.org/account/avatar/00/17/f9/50/d0ea075b.jpg","comment_is_top":false,"comment_ctime":1589544394,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1589544394","product_id":100026001,"comment_content":"æƒŠå–œå•Šï¼Œä½œä¸ºä¸€ä¸ªåŠè·¯å‡ºå®¶çš„ç¨‹åºå‘˜ï¼Œä¸€ç›´æ²¡ç†è§£volatileå…³é”®å­—çš„å«ä¹‰ï¼Œä»Šå¤©å¬è€å¸ˆä¸€è®²ï¼Œè±ç„¶å¼€æœ—ã€‚","like_count":0},{"had_liked":false,"id":187191,"user_name":"ä¿¡é•¿","can_delete":false,"product_type":"c1","uid":1746710,"ip_address":"","ucode":"294D19040C09C0","user_header":"https://static001.geekbang.org/account/avatar/00/1a/a7/16/b2ff3f70.jpg","comment_is_top":false,"comment_ctime":1584057423,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1584057423","product_id":100026001,"comment_content":"è¿™ä¸€ç« æˆ‘çœ‹å¾—ç‰¹åˆ«æ…¢ï¼Œå› ä¸ºï¼Œå†™å¾—å¤ªå¥½äº†ï¼Œå­¦åˆ°å¾ˆå¤šçŸ¥è¯†","like_count":0},{"had_liked":false,"id":181440,"user_name":"jason0606","can_delete":false,"product_type":"c1","uid":1215860,"ip_address":"","ucode":"0081C861734359","user_header":"https://static001.geekbang.org/account/avatar/00/12/8d/74/3bb89151.jpg","comment_is_top":false,"comment_ctime":1582541269,"is_pvip":false,"discussion_count":1,"race_medal":0,"score":"1582541269","product_id":100026001,"comment_content":"å†™å›ç­–ç•¥é‡Œé¢ï¼Œå‡å¦‚è¯»å–åˆ°çš„cache blockæ˜¯å¹²å‡€çš„ï¼Œä¸ºä»€ä¹ˆè¿˜è¦ä»ä¸»å†…å­˜é‡Œé¢è¯»å–ä¸€æ¬¡æ•°æ®ï¼Œç„¶åå†å»è¦†ç›–ä»–ï¼Ÿ å¸Œæœ›è€å¸ˆèƒ½å¤Ÿè®²è§£ä¸‹","like_count":0,"discussions":[{"author":{"id":1476675,"avatar":"https://static001.geekbang.org/account/avatar/00/16/88/43/31641bf0.jpg","nickname":"å¸ƒæœ—è€ç†Š","note":"","ucode":"A8AF82550AFF9C","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":207937,"discussion_content":"ç¼“å­˜æ˜¯ä¸€å¯¹å¤šçš„ï¼Œåªæœ‰åœ¨ç¼“å­˜åœ°å€è·Ÿå°†è¦å†™å…¥æ•°æ®åœ°å€ç›¸åŒçš„æƒ…å†µä¸‹æ‰èƒ½ç›´æ¥å†™ï¼Œå¹¶æ ‡è®°ä¸ºè„ï¼›å½“åœ°å€ä¸ä¸€è‡´å°±åˆ†ä¸¤ç§æƒ…å†µï¼Œç¬¬ä¸€ç§æ˜¯ç¼“å­˜çš„å…¶ä»–å†…å­˜å¿«çš„æ•°æ®ï¼Œéœ€è¦å°†å…¶å…ˆæ”¾å›å†…å­˜ï¼Œç„¶ååŒæ­¥è‡ªå·±å†…å­˜å’Œç¼“å­˜åœ°å€ï¼Œç„¶åå†™å…¥å’Œæ›´æ”¹æ•°æ®ï¼Œç¬¬äºŒç§æ˜¯é‡Œé¢å•¥éƒ½æ²¡æœ‰ï¼Œéœ€è¦å°†ç¼“å­˜çš„ä¿¡æ¯è·Ÿå†…å­˜åŒæ­¥ï¼Œç„¶åå†™å…¥æ•°æ®ã€‚","likes_number":1,"is_delete":false,"is_hidden":false,"ctime":1584526281,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":179921,"user_name":"Geek_aa8017","can_delete":false,"product_type":"c1","uid":1748911,"ip_address":"","ucode":"286195887103C2","user_header":"","comment_is_top":false,"comment_ctime":1582121977,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1582121977","product_id":100026001,"comment_content":"JMMä¸­çš„çº¿ç¨‹æ ˆå†…å­˜æ˜¯å¯¹åº”åˆ°ç‰©ç†çš„CPU Cacheå—","like_count":0},{"had_liked":false,"id":156606,"user_name":"czh","can_delete":false,"product_type":"c1","uid":1159078,"ip_address":"","ucode":"649FE5C9269D69","user_header":"https://static001.geekbang.org/account/avatar/00/11/af/a6/3f15ba2f.jpg","comment_is_top":false,"comment_ctime":1574921776,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1574921776","product_id":100026001,"comment_content":"1.è¿™ç¯‡æ–‡ç« è®¨è®ºçš„æ˜¯å•ä¸ªçº¿ç¨‹æ•°æ®ä¸€è‡´æ€§é—®é¢˜ã€‚ï¼ˆä¸‹ä¸€èŠ‚ï¼Œå¤šä¸ªçº¿ç¨‹ï¼Œæˆ–è€…æ˜¯å¤šä¸ª CPU æ ¸çš„ç¼“å­˜ä¸€è‡´æ€§çš„é—®é¢˜ï¼‰<br>2.çŸ¥è¯†ç‚¹ï¼švolatile å…³é”®å­—ç©¶ç«Ÿä»£è¡¨ä»€ä¹ˆå«ä¹‰å‘¢ï¼Ÿå®ƒä¼šç¡®ä¿æˆ‘ä»¬å¯¹äºè¿™ä¸ªå˜é‡çš„è¯»å–å’Œå†™å…¥ï¼Œéƒ½ä¸€å®šä¼šåŒæ­¥åˆ°ä¸»å†…å­˜é‡Œï¼Œè€Œä¸æ˜¯ä» Cache é‡Œé¢è¯»å–ã€‚","like_count":0},{"had_liked":false,"id":152843,"user_name":"è¿½é£ç­çš„äºº","can_delete":false,"product_type":"c1","uid":1488020,"ip_address":"","ucode":"2993D60F94C396","user_header":"https://static001.geekbang.org/account/avatar/00/16/b4/94/2796de72.jpg","comment_is_top":false,"comment_ctime":1574087898,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1574087898","product_id":100026001,"comment_content":"volatileå…³é”®å­—ä¼šè®©æ•°æ®éƒ½å†™å…¥ä¸»å†…å­˜ï¼Œåœ¨å¤šçº¿ç¨‹ä¸­ä¸€ä¸ªçº¿ç¨‹çš„å˜é‡ä½¿ç”¨æ­¤å…³é”®å­—æ›´æ”¹äº†å˜é‡ä¹‹åï¼Œå¯¹å…¶ä»–çº¿ç¨‹è¿™ä¸ªæ”¹å˜å¯æ„ŸçŸ¥çš„ã€‚write throughæ–¹å¼æ˜¯æ— è®ºç¼“å­˜ä¸­æœ‰æ²¡æœ‰æ•°æ®éƒ½æ›´æ–°åˆ°ä¸»å†…å­˜ã€‚write back æ˜¯æ›´æ–°ç¼“å­˜ï¼Œå½“éœ€è¦æŠŠç¼“å­˜ä¸­çš„è„æ•°æ®äº¤æ¢å‡ºå»æ—¶ï¼Œæ•°æ®æ—¶æ‰ä¼šæ›´æ–°åˆ°ä¸»å†…å­˜","like_count":0},{"had_liked":false,"id":126429,"user_name":"æ´»çš„æ½‡æ´’","can_delete":false,"product_type":"c1","uid":1238830,"ip_address":"","ucode":"666C30CA894754","user_header":"https://static001.geekbang.org/account/avatar/00/12/e7/2e/1522a7d6.jpg","comment_is_top":false,"comment_ctime":1566386115,"is_pvip":false,"discussion_count":3,"race_medal":0,"score":"1566386115","product_id":100026001,"comment_content":"åŸºç¡€ä¸ç‰¢ã€åœ°æ´å±±æ‘‡ã€æˆ‘æ¥è¡¥åŸºç¡€å•¦ï¼š<br>day38 ç¬”è®°ï¼šhttps:&#47;&#47;www.cnblogs.com&#47;luoahong&#47;p&#47;11353749.html","like_count":0,"discussions":[{"author":{"id":1112415,"avatar":"https://static001.geekbang.org/account/avatar/00/10/f9/5f/b0a125a9.jpg","nickname":"chp","note":"","ucode":"F0A2442230CD45","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":383436,"discussion_content":"åˆ«æŠ„è¢­äº†ã€‚ã€‚ã€‚ã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1626095362,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1149084,"avatar":"https://static001.geekbang.org/account/avatar/00/11/88/9c/cbc463e6.jpg","nickname":"ä»°æœ›æ˜Ÿç©º","note":"","ucode":"A9E46C9FDB3275","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":296953,"discussion_content":"è¿™æ ·çœŸçš„å¥½å—","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1596712798,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1053921,"avatar":"https://static001.geekbang.org/account/avatar/00/10/14/e1/ee5705a2.jpg","nickname":"Zend","note":"","ucode":"80EBB0B6772E27","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":82708,"discussion_content":"ä½ è¿™æ˜¯æŠŠè€å¸ˆçš„æŠ„ä¸€éï¼Œä½ åˆ«äººè¿˜éœ€è¦è®¢é˜…è€å¸ˆçš„ä¸“åˆ©å—","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1576369476,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":119808,"user_name":"ãƒ¾(â—Â°âˆ‡Â°â—)ï¾‰ï¾","can_delete":false,"product_type":"c1","uid":1044175,"ip_address":"","ucode":"89545632BDA56E","user_header":"http://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTJOBwR7MCVqwZbPA5RQ2mjUjd571jUXUcBCE7lY5vSMibWn8D5S4PzDZMaAhRPdnRBqYbVOBTJibhJg/132","comment_is_top":false,"comment_ctime":1564706732,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1564706732","product_id":100026001,"comment_content":"volatile ä¼šç›´æ¥å†™å†…å­˜å—ï¼Ÿä¼šä¸ä¼šç›´æ¥å†™l3","like_count":0},{"had_liked":false,"id":117112,"user_name":"WL","can_delete":false,"product_type":"c1","uid":1173771,"ip_address":"","ucode":"6277DCD776B87E","user_header":"https://static001.geekbang.org/account/avatar/00/11/e9/0b/1171ac71.jpg","comment_is_top":false,"comment_ctime":1563970729,"is_pvip":false,"discussion_count":1,"race_medal":0,"score":"1563970729","product_id":100026001,"comment_content":"è¯·é—®è€å¸ˆè¿™èŠ‚è¯¾å‡ºç°çš„cache blockå’Œä¸ŠèŠ‚è¯¾çš„å†…å­˜ bolckæ˜¯ä¸æ˜¯ä¸€ä¸ªæ¦‚å¿µ?","like_count":0,"discussions":[{"author":{"id":1795371,"avatar":"https://static001.geekbang.org/account/avatar/00/1b/65/2b/446ef7b6.jpg","nickname":"è®¸å…ˆæ£®","note":"","ucode":"1F42D4A6B5C6AF","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":138502,"discussion_content":"ä¸æ˜¯ï¼Œå›¾é‡Œçš„cache blockæ˜¯ç¼“å­˜å—ï¼Œç¡®å®ä¸ä¸¥è°¨ã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1579248641,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":116171,"user_name":"é äººå“å»èµ¢","can_delete":false,"product_type":"c1","uid":1301286,"ip_address":"","ucode":"7A20F9EBE847E1","user_header":"https://static001.geekbang.org/account/avatar/00/13/db/26/54f2c164.jpg","comment_is_top":false,"comment_ctime":1563797393,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1563797393","product_id":100026001,"comment_content":"è€å¸ˆä½ å¥½ï¼Œä½œç±»æ¯”çš„è¯ï¼Œæ˜¯ä¸æ˜¯Javaä¸»å†…å­˜å¯¹åº”çš„æ˜¯CPUçš„3çº§ç¼“å­˜ã€‚å¤šä¸ªçº¿ç¨‹å¤šä¸ªCPUæœ€ååœ¨L3ä¸Šè¯»æ•°æ®æ˜¯ä¸€è‡´æ€§çš„?æœŸå¾…åé¢çš„ç¼“å­˜ä¸€è‡´æ€§çš„ç»´æŠ¤ï¼Œä¼šä¸ä¼šå‡ºè¡Œè„è¯»è„å†™çš„æƒ…å†µã€‚","like_count":0},{"had_liked":false,"id":116057,"user_name":"humor","can_delete":false,"product_type":"c1","uid":1181867,"ip_address":"","ucode":"9B48C4C7BEC92C","user_header":"https://static001.geekbang.org/account/avatar/00/12/08/ab/caec7bca.jpg","comment_is_top":false,"comment_ctime":1563779511,"is_pvip":false,"discussion_count":1,"race_medal":0,"score":"1563779511","product_id":100026001,"comment_content":"è€å¸ˆå¥½ï¼ŒJMMä¸­çš„çº¿ç¨‹æ ˆå†…å­˜æ˜¯å¯¹åº”åˆ°CPU Cacheå—ï¼Ÿä»¥åŠJMMçš„ä¸»å†…å­˜å¯¹åº”åˆ°ç¡¬ä»¶çš„ä¸»å†…å­˜å—ï¼ŸJMMå’Œcpu cpu cache ä¸»å†…å­˜ä¹‹é—´çš„å…³ç³»æ˜¯ç›¸ä¼¼çš„ï¼Œè¿˜æ˜¯å°±æ˜¯åŒä¸€ä¸ªä¸œè¥¿å‘¢ï¼Ÿ","like_count":0,"discussions":[{"author":{"id":1243901,"avatar":"https://static001.geekbang.org/account/avatar/00/12/fa/fd/ec24cba7.jpg","nickname":"fcbçš„é±¼","note":"","ucode":"88667EBF09CEC0","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":161752,"discussion_content":"jmmçš„çº¿ç¨‹æ ˆåªä¾›å½“å‰çº¿ç¨‹ä½¿ç”¨ï¼Œæ‰€ä»¥å¯ä»¥ç†è§£ä¸ºå¯¹åº”åˆ°cpuçš„cache.å…¶ä¸»å†…å­˜å¯¹å’Œcpuçš„ä¸»å†…å­˜æ˜¯ä¸€ä¸ªä¸œè¥¿ï¼Œåªä¸è¿‡æ˜¯2ç§åœºæ™¯ä¸‹çš„ä¸åŒå«æ³•ã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1580916381,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":116040,"user_name":"è®¸ç«¥ç«¥","can_delete":false,"product_type":"c1","uid":1003005,"ip_address":"","ucode":"4B799C0C6BC678","user_header":"https://static001.geekbang.org/account/avatar/00/0f/4d/fd/0aa0e39f.jpg","comment_is_top":false,"comment_ctime":1563777175,"is_pvip":false,"discussion_count":2,"race_medal":0,"score":"1563777175","product_id":100026001,"comment_content":"ç¨‹åºæ²¡æœ‰å†™ï¼Œæˆ‘ç®€ç­”ä¸€ä¸‹ï¼Œå¦‚æœä¸ä½¿ç”¨volatileå…³é”®å­—ï¼Œç›¸å½“äºä½¿ç”¨å†™ç›´è¾¾ï¼Œæ²¡æœ‰ä½¿ç”¨cpu cacheã€‚æ€§èƒ½åº”è¯¥ç›¸å·®ä¸€ä¸ªæ•°é‡çº§ã€‚","like_count":0,"discussions":[{"author":{"id":1240126,"avatar":"https://static001.geekbang.org/account/avatar/00/12/ec/3e/885ec1d2.jpg","nickname":"å®‹ä¸è‚¥","note":"","ucode":"32B34AF579C91C","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":2650,"discussion_content":"ç¡®å®è¯´åäº†","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1563844664,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1484184,"avatar":"https://static001.geekbang.org/account/avatar/00/16/a5/98/a65ff31a.jpg","nickname":"djfhchdh","note":"","ucode":"E71D75328CE398","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":2610,"discussion_content":"å¤§å“¥ï¼Œè¯´åäº†å§","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1563786692,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":116031,"user_name":"æ–æ³¢é‚£å¥‘","can_delete":false,"product_type":"c1","uid":1464006,"ip_address":"","ucode":"85E2EBC01392B1","user_header":"https://static001.geekbang.org/account/avatar/00/16/56/c6/0b449bc6.jpg","comment_is_top":false,"comment_ctime":1563774595,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1563774595","product_id":100026001,"comment_content":"åœ¨jdk5ä¹‹å‰ç”±äºjavaçš„ä¹±åºæ‰§è¡Œå¯¼è‡´volatileå…³é”®å­—è¿˜æ˜¯æœ‰å¯èƒ½ä¸å¯è§çš„ åæ¥å¼•å…¥äº†happen-beforeè§„åˆ™ æ‰è®©volatileå…·æœ‰å¯è§æ€§ ä½†æ˜¯volatileå¹¶ä¸å…·æœ‰åŸå­æ€§ ä¹Ÿå°±æ˜¯è·Ÿç®¡ç¨‹ï¼ˆsynchronizedï¼‰è¿˜æ˜¯æœ‰åŒºåˆ«çš„","like_count":0},{"had_liked":false,"id":115851,"user_name":"D","can_delete":false,"product_type":"c1","uid":1027596,"ip_address":"","ucode":"5BB4D16FE39BFF","user_header":"https://static001.geekbang.org/account/avatar/00/0f/ae/0c/f39f847a.jpg","comment_is_top":false,"comment_ctime":1563757647,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1563757647","product_id":100026001,"comment_content":"è¿™ä¸ªç¼“å­˜æ¨¡å‹åªé€‚ç”¨äºJavaå—ï¼Œå…¶ä»–è¯­éŸ³å‘¢ï¼Œè€å¸ˆå¯å¦å¼•ç”³ä¸€ä¸‹","like_count":0},{"had_liked":false,"id":115848,"user_name":"-W.LI-","can_delete":false,"product_type":"c1","uid":1210699,"ip_address":"","ucode":"3556786538664F","user_header":"https://static001.geekbang.org/account/avatar/00/12/79/4b/740f91ca.jpg","comment_is_top":false,"comment_ctime":1563757482,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1563757482","product_id":100026001,"comment_content":"è€å¸ˆå¥½!å†™å›çš„ä¼˜åŠ¿æ˜¯å¤šæ¬¡å±€éƒ¨å‘½ä¸­çš„æ—¶å€™å¯ä»¥æ‰“åŒ…å†™å›å‡å°‘å¼€é”€æ˜¯ä¹ˆ?","like_count":0}]}