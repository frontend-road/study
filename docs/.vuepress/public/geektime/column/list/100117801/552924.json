{"id":552924,"title":"11ï½œæ‰‹å†™CPUï¼ˆå…­ï¼‰ï¼šå¦‚ä½•è®©æˆ‘ä»¬çš„CPUè·‘èµ·æ¥ï¼Ÿ","content":"<p>ä½ å¥½ï¼Œæˆ‘æ˜¯LMOSã€‚</p><p>é€šè¿‡å‰é¢å‡ èŠ‚è¯¾çš„å­¦ä¹ ï¼Œæˆ‘ä»¬å·²ç»å®Œæˆäº†MiniCPUäº”çº§æµæ°´çº¿çš„æ¨¡å—è®¾è®¡ï¼Œç°åœ¨è·ç¦»å®ç°ä¸€ä¸ªå®Œæ•´çš„MiniCPUä¹Ÿå°±ä¸€æ­¥ä¹‹é¥ã€‚</p><p>è¿˜å·®å“ªäº›å·¥ä½œæ²¡å®Œæˆå‘¢ï¼Ÿè¿˜è®°å¾—æˆ‘ä»¬åœ¨ç¬¬å…­èŠ‚è¯¾è®¾è®¡çš„MiniCPUæ¶æ„å›¾å—ï¼Ÿå›æƒ³ä¸€ä¸‹ï¼Œæˆ‘ä»¬å·²ç»è®¾è®¡å®Œæˆçš„äº”çº§æµæ°´çº¿ï¼Œéƒ½åŒ…å«ä¸‹å›¾çš„å“ªäº›æ¨¡å—ï¼Ÿ</p><p><img src=\"https://static001.geekbang.org/resource/image/31/dd/31b586c344cd7d0127775e7ff63711dd.jpg?wh=1920x1289\" alt=\"å›¾ç‰‡\"></p><p>ä¸Šå›¾çš„CPUæ ¸å¿ƒæ¨¡å—ï¼Œä¹Ÿå°±æ˜¯CPU CoreåŒ…å«çš„æ¨¡å—çš„è®¾è®¡ï¼Œè¿™äº›æˆ‘ä»¬å·²ç»åœ¨å‰é¢å‡ èŠ‚è¯¾é‡Œå®Œæˆäº†ã€‚é™¤äº†äº”çº§æµæ°´çº¿çš„æ¨¡å—ï¼Œæˆ‘ä»¬è¿˜è®¾è®¡äº†ç”¨äºä¿å­˜æ“ä½œæ•°å’Œè¿ç®—ç»“æœçš„é€šç”¨å¯„å­˜å™¨ç»„ï¼Œè®¾è®¡äº†è§£å†³æ•°æ®å†’é™©é—®é¢˜çš„forwardingæ¨¡å—ï¼Œä»¥åŠè§£å†³æ§åˆ¶å†’é™©é—®é¢˜çš„hazardæ¨¡å—ã€‚</p><p>æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬è¿˜éœ€è¦æå®šä¸€äº›å¤–å›´ç»„ä»¶ï¼Œä¹Ÿå°±æ˜¯å›¾é‡Œè™šçº¿æ¡†å¤–çš„ç³»ç»Ÿæ€»çº¿ã€ROMã€RAMã€è¾“å…¥è¾“å‡ºç«¯å£GPIOï¼ˆGPIOæ¯”è¾ƒç®€å•ï¼Œè¯¾ç¨‹é‡Œæ²¡ä¸“é—¨è®²ï¼‰å’ŒUARTæ¨¡å—ã€‚</p><p>å­¦å®Œè¿™èŠ‚è¯¾ï¼Œæˆ‘ä»¬å°±å¯ä»¥æŠŠè¿™ä¸ªCPUè¿è¡Œèµ·æ¥äº†ï¼Œæœ€ç»ˆæˆ‘è¿˜ä¼šå¸¦ä½ åœ¨è¿™ä¸ªCPUä¸Šè·‘ä¸€ä¸ªRISC-Vç‰ˆæœ¬çš„Hello Worldç¨‹åºï¼ˆè¯¾ç¨‹ä»£ç ä»<a href=\"https://gitee.com/lmos/Geek-time-computer-foundation\">è¿™é‡Œ</a>ä¸‹è½½ï¼‰ï¼Œæ˜¯ä¸æ˜¯å¾ˆæœŸå¾…ï¼Ÿè¯ä¸å¤šè¯´ï¼Œæˆ‘ä»¬è¿™å°±å¼€å§‹ï¼</p><h2>ç³»ç»Ÿæ€»çº¿è®¾è®¡</h2><p>é¦–å…ˆï¼Œè®©æˆ‘ä»¬çœ‹çœ‹CPUçš„ç³»ç»Ÿæ€»çº¿ã€‚</p><p>æ€»çº¿æ˜¯è¿æ¥å¤šä¸ªéƒ¨ä»¶çš„ä¿¡æ¯ä¼ è¾“çº¿ï¼Œå®ƒæ˜¯å„éƒ¨ä»¶å…±äº«çš„ä¼ è¾“ä»‹è´¨ã€‚åœ¨æŸä¸€æ—¶åˆ»ï¼Œåªå…è®¸æœ‰ä¸€ä¸ªéƒ¨ä»¶å‘æ€»çº¿å‘é€ä¿¡æ¯ï¼Œè€Œå¤šä¸ªéƒ¨ä»¶å¯ä»¥åŒæ—¶ä»æ€»çº¿ä¸Šæ¥æ”¶ç›¸åŒçš„ä¿¡æ¯ã€‚MiniCPUçš„ç³»ç»Ÿæ€»çº¿ç”¨æ¥è¿æ¥CPUå†…æ ¸ä¸å¤–è®¾ï¼Œå®Œæˆä¿¡æ¯ä¼ è¾“çš„åŠŸèƒ½ã€‚</p><!-- [[[read_end]]] --><p>ç³»ç»Ÿæ€»çº¿åœ¨æ•´ä¸ªMiniCPUä¸­æ˜¯ä¸€ä¸ªå¾ˆå…³é”®çš„æ¨¡å—ã€‚ä½ å¯ä»¥è¿™æ ·ç†è§£ï¼Œæ€»çº¿å°±æ˜¯CPUå†…æ ¸è·Ÿå…¶ä»–å¤–è®¾éƒ¨ä»¶çš„â€œè”ç»œå‘˜â€ã€‚ä¸¾å‡ ä¸ªä¾‹å­ï¼Œæ€»çº¿å¯ä»¥ä»ROMä¸­è¯»å–æŒ‡ä»¤ï¼Œå†äº¤ç»™CPUå»æ‰§è¡Œï¼›CPUè¿è¡Œç¨‹åºæ—¶çš„å˜é‡ï¼Œä¹Ÿä¼šäº¤ç”±æ€»çº¿ä¿å­˜åˆ°RAMä¸­ï¼›ç”¨æ¥å®ç°èŠ¯ç‰‡ä¸å¤–éƒ¨é€šä¿¡çš„UARTæ¨¡å—ï¼Œä¹Ÿéœ€è¦é€šè¿‡æ€»çº¿è·ŸCPUè¿›è¡Œä¿¡æ¯äº¤æ¢â€¦â€¦</p><p>é‚£æ€»çº¿çš„ä»£ç å…·ä½“è¦æ€ä¹ˆè®¾è®¡å‘¢ï¼Ÿæˆ‘å…ˆå±•ç¤ºä¸€ä¸‹å†™å¥½çš„æ•´ä½“ä»£ç ï¼Œå†å¸¦ä½ å…·ä½“åˆ†æã€‚</p><pre><code class=\"language-verilog\">module sys_bus (\n    // cpu -&gt; imem\n    input  [31:0] cpu_imem_addr,\n    output [31:0] cpu_imem_data,\n    output [31:0] imem_addr,            \t\n    input  [31:0] imem_data, \n  \n    // cpu -&gt; bus\n    input  [31:0] cpu_dmem_addr,        \n    input  [31:0] cpu_dmem_data_in,     \n    input         cpu_dmem_wen,        \n    output reg [31:0] cpu_dmem_data_out,\n  \n    // bus -&gt; ram \n    input  [31:0] dmem_read_data,     \n    output [31:0] dmem_write_data,    \n    output [31:0] dmem_addr,           \n    output reg    dmem_wen,\n  \n    // bus -&gt; rom \n    input  [31:0] dmem_rom_read_data,\n    output [31:0] dmem_rom_addr, \n  \n    // bus -&gt; uart\n    input  [31:0] uart_read_data,   \n    output [31:0] uart_write_data,   \n    output [31:0] uart_addr,         \n    output reg    uart_wen\n);\n    assign imem_addr = cpu_imem_addr;\n    assign cpu_imem_data = imem_data;\n    assign dmem_addr = cpu_dmem_addr;\n    assign dmem_write_data = cpu_dmem_data_in;\n    assign dmem_rom_addr = cpu_dmem_addr;\n    assign uart_addr = cpu_dmem_addr;\n    assign uart_write_data = cpu_dmem_data_in;\n\n    always @(*) begin\n        case (cpu_dmem_addr[31:28])\n            4'h0: begin\t\t\t\t\t\t\t\t//ROM\n                cpu_dmem_data_out &lt;= dmem_rom_read_data;\n                dmem_wen &lt;= 0;\n                uart_wen &lt;= 0;\n            end\n            4'h1: begin     \t\t\t\t\t// RAM\n                dmem_wen &lt;= cpu_dmem_wen;\n                cpu_dmem_data_out &lt;= dmem_read_data;\n                uart_wen &lt;= 0;\n            end\n            4'h2: begin     \t\t\t\t\t// uart io\n                uart_wen &lt;= cpu_dmem_wen;\n                cpu_dmem_data_out &lt;= uart_read_data;\n                dmem_wen &lt;= 0;\n            end\n            default:   begin\n                dmem_wen &lt;= 0;\n                uart_wen &lt;= 0;\n                cpu_dmem_data_out &lt;= 0;\n            end\n        endcase\n    end\nendmodule\n</code></pre><p>è¿™é‡Œæˆ‘ä»¬è®¾è®¡çš„ç³»ç»Ÿæ€»çº¿å…¶å®æ˜¯ä¸€ä¸ª<strong>â€œä¸€å¯¹å¤šâ€</strong>çš„ç»“æ„ï¼Œä¹Ÿå¯ä»¥è¯´æ˜¯â€œä¸€ä¸»å¤šä»â€ç»“æ„ï¼Œå°±æ˜¯ä¸€ä¸ªCPUå†…æ ¸ä½œä¸ºä¸»è®¾å¤‡ï¼ˆMasterï¼‰ï¼Œå¤šä¸ªå¤–è®¾ä½œä¸ºä»è®¾å¤‡ï¼ˆSlaveï¼‰ã€‚<br>\n<img src=\"https://static001.geekbang.org/resource/image/ac/0e/ac1d4cf173d140225fff21f2c9fedb0e.jpg?wh=1920x1166\" alt=\"å›¾ç‰‡\"></p><p>CPUå†…æ ¸å…·æœ‰ç³»ç»Ÿæ€»çº¿çš„æ§åˆ¶æƒï¼Œå®ƒå¯ä»¥é€šè¿‡ç³»ç»Ÿæ€»çº¿ï¼Œå‘èµ·å¯¹å¤–è®¾çš„è®¿é—®ï¼Œè€Œå¤–è®¾åªèƒ½å“åº”ä»CPUå†…æ ¸å‘æ¥çš„å„ç§æ€»çº¿å‘½ä»¤ã€‚å› æ­¤ï¼Œæ¯ä¸ªå¤–è®¾éƒ½éœ€è¦æœ‰ä¸€ä¸ªå›ºå®šçš„åœ°å€ï¼Œä½œä¸ºCPUè®¿é—®ç‰¹å®šå¤–è®¾çš„æ ‡è¯†ã€‚</p><p>ä»¥ä¸‹å°±æ˜¯ç»™ä»è®¾å¤‡åˆ†é…çš„åœ°å€ç©ºé—´ï¼š</p><blockquote>\n<p>// è®¾å¤‡åœ°å€ç©ºé—´<br>\n// 0x0000_0000 -ROM (word to byte )<br>\n// 0x1000_0000 -RAM (word to byte )<br>\n// 0x2000_0000 -uart   (word to byte )<br>\n// 0x3000_0000 -other(word to byte )</p>\n</blockquote><p>ä»ä»£ç çš„ç¬¬39ï½60è¡Œä¹Ÿå¯ä»¥çœ‹åˆ°ï¼Œæ€»çº¿æ ¹æ®åœ°å€çš„<strong>é«˜4 bitçš„å€¼</strong>ï¼Œå°±å¯ä»¥åˆ¤æ–­å‡ºCPUè®¿é—®çš„æ˜¯å“ªä¸ªä»è®¾å¤‡ã€‚</p><p>å½“ï¼ˆcpu_dmem_addr[31:28] = 4â€™h0 ï¼‰æ—¶ï¼ŒCPUè®¿é—®çš„æ˜¯ROMï¼ŒæŠŠä»ROMè¿”å›çš„æ•°æ®èµ‹ç»™æ€»çº¿ï¼›å½“ï¼ˆcpu_dmem_addr[31:28] = 4â€™h1 ï¼‰æ—¶ï¼ŒCPUè®¿é—®çš„æ˜¯RAMï¼ŒæŠŠCPUçš„å†™ä½¿èƒ½cpu_dmem_wenèµ‹ç»™RAMçš„å†™ä½¿èƒ½ä¿¡å·dmem_wenï¼ŒåŒæ—¶æŠŠä»RAMè¿”å›çš„æ•°æ®èµ‹ç»™æ€»çº¿ï¼›å½“ï¼ˆcpu_dmem_addr[31:28] = 4â€™h2 ï¼‰æ—¶ï¼ŒCPUè®¿é—®çš„æ˜¯ä¸²è¡Œé€šä¿¡æ¨¡å—UARTï¼ŒæŠŠCPUçš„å†™ä½¿èƒ½cpu_dmem_wenèµ‹ç»™uartçš„å†™ä½¿èƒ½ä¿¡å·uart_wenï¼ŒåŒæ—¶æŠŠä»UARTè¿”å›çš„æ•°æ®èµ‹ç»™æ€»çº¿ã€‚è¿™å°±æ˜¯MiniCPUæ€»çº¿çš„å·¥ä½œè¿‡ç¨‹ã€‚</p><h2>åªè¯»å­˜å‚¨å™¨ROMçš„å®ç°</h2><p>æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬çœ‹çœ‹è¿æ¥åœ¨æ€»çº¿ä¸Šçš„å­˜å‚¨å™¨è¦å¦‚ä½•å®ç°ã€‚</p><p>ROMæ˜¯ä¸ªç¼©å†™ï¼Œå®ƒè¡¨ç¤ºåªè¯»å­˜å‚¨å™¨ï¼ˆRead Only Memoryï¼‰ã€‚ROMå…·æœ‰éæ˜“å¤±æ€§çš„ç‰¹ç‚¹ã€‚ä»€ä¹ˆæ˜¯éæ˜“å¤±æ€§å‘¢ï¼Ÿè¯´ç™½äº†å°±æ˜¯åœ¨ç³»ç»Ÿæ–­ç”µçš„æƒ…å†µä¸‹ï¼Œä»ç„¶å¯ä»¥ä¿å­˜æ•°æ®ã€‚</p><p>æ­£æ˜¯å› ä¸ºè¿™ä¸€ç‰¹ç‚¹ï¼ŒROMå¾ˆé€‚åˆç”¨æ¥å­˜æ”¾è®¡ç®—æœºçš„ç¨‹åºã€‚ç”±äºå†å²åŸå› ï¼Œè™½ç„¶ç°åœ¨ä½¿ç”¨çš„ROMä¸­ï¼Œæœ‰äº›ç±»å‹ä¸ä»…æ˜¯å¯ä»¥è¯»ï¼Œè¿˜å¯ä»¥å†™ï¼Œä½†æˆ‘ä»¬è¿˜æ˜¯ä¹ æƒ¯æ€§åœ°æŠŠå®ƒä»¬ç§°ä½œåªè¯»å­˜å‚¨å™¨ã€‚æ¯”å¦‚ï¼Œç°åœ¨ç”µå­ç³»ç»Ÿä¸­å¸¸ç”¨çš„EEPROMã€NOR flash ã€Nand flashç­‰ï¼Œéƒ½å¯ä»¥å½’ç±»ä¸ºROMã€‚</p><p>åœ¨æˆ‘ä»¬çš„MiniCPUä¸­ï¼Œç›®å‰æ²¡æœ‰çœŸæ­£ä½¿ç”¨ä¸Šè¿°çš„ROMä½œä¸ºæŒ‡ä»¤å­˜å‚¨å™¨ã€‚è®©æˆ‘ä»¬çœ‹çœ‹MiniCPUä¸­å®ç°ROMåŠŸèƒ½çš„ä»£ç ï¼Œå†ç›¸åº”åˆ†ææˆ‘ä»¬çš„è®¾è®¡æ€è·¯ã€‚</p><pre><code class=\"language-verilog\">module imem (\n    input  [11:0] addr1,\n    output [31:0] imem_o1,\n    input  [11:0] addr2,\n    output [31:0] imem_o2\n);\n    reg [31:0] imem_reg[0:4096];\n\n    assign imem_o1 = imem_reg[addr1];\n    assign imem_o2 = imem_reg[addr2];\n\nendmodule\n</code></pre><p>ä¸ºäº†æ–¹ä¾¿å­¦ä¹ å’Œä»¿çœŸï¼Œæˆ‘ä»¬ä½¿ç”¨äº†å¯„å­˜å™¨ï¼ˆregï¼‰ä¸´æ—¶å®šä¹‰äº†ä¸€ä¸ªæŒ‡ä»¤å­˜å‚¨å™¨imemï¼Œå¹¶åœ¨ä»¿çœŸçš„é¡¶å±‚ï¼ˆtb_top.vï¼‰ä½¿ç”¨äº†$readmemhï¼ˆï¼‰å‡½æ•°ï¼ŒæŠŠç¼–è¯‘å¥½çš„äºŒè¿›åˆ¶æŒ‡ä»¤è¯»å…¥åˆ°imemä¸­ï¼Œä»¥ä¾¿CPUå†…éƒ¨è¯»å–å¹¶æ‰§è¡Œè¿™äº›æŒ‡ä»¤ã€‚è¿™é‡Œæˆ‘ä»¬è®¾ç½®çš„å­˜å‚¨å™¨åœ¨åŠŸèƒ½ä¸Šæ˜¯åªè¯»çš„ã€‚</p><p>ä»¥ä¸‹å°±æ˜¯ä»¿çœŸçš„é¡¶å±‚ï¼ˆtb_top.vï¼‰è°ƒç”¨$readmemhï¼ˆï¼‰å‡½æ•°çš„è¯­å¥ã€‚</p><pre><code class=\"language-verilog\">$readmemh(`HEXFILE, MiniCPU.u_imem.imem_reg);\n</code></pre><p>å‡½æ•°é‡Œé¢æœ‰ä¸¤ä¸ªå‚æ•°ï¼Œä¸€ä¸ªæ˜¯å­˜æ”¾äºŒè¿›åˆ¶æŒ‡ä»¤çš„æ–‡ä»¶ï¼ˆHEXFILEï¼‰ï¼Œå¦ä¸€ä¸ªå°±æ˜¯å®ç°ROMåŠŸèƒ½çš„å¯„å­˜å™¨ï¼ˆimem_regï¼‰ã€‚è¿™æ¡è¯­å¥å¯ä»¥åœ¨æˆ‘ä»¬å¯åŠ¨CPUä»¿çœŸæ—¶ï¼ŒæŠŠäºŒè¿›åˆ¶çš„æŒ‡ä»¤ä¸€æ¬¡æ€§è¯»å…¥åˆ°imemä¸­ï¼Œè¿™æ ·CPUè¿è¡Œçš„è¿‡ç¨‹ä¸­å°±å¯ä»¥å–imemä¸­çš„æŒ‡ä»¤å»æ‰§è¡Œäº†ã€‚</p><h2>éšæœºè®¿é—®å­˜å‚¨å™¨RAM</h2><p>é™¤äº†å­˜æ”¾æŒ‡ä»¤çš„ROMï¼Œæˆ‘ä»¬è¿˜éœ€è¦ä¸€ä¸ªå­˜æ”¾å˜é‡å’Œæ•°æ®çš„RAMï¼ˆRandom Access Memoryï¼‰ã€‚</p><p>RAMå’Œç‰¹ç‚¹è·ŸROMæ­£å¥½ç›¸åï¼Œå®ƒæ˜¯æ˜“å¤±æ€§å­˜å‚¨å™¨ï¼Œé€šå¸¸éƒ½æ˜¯åœ¨æ‰ç”µä¹‹åå°±ä¼šä¸¢å¤±æ•°æ®ã€‚ä½†æ˜¯å®ƒå…·æœ‰è¯»å†™é€Ÿåº¦å¿«çš„ä¼˜åŠ¿ï¼Œæ‰€ä»¥é€šå¸¸ç”¨ä½œCPUçš„é«˜é€Ÿç¼“å­˜ã€‚</p><p>RAMä¹‹æ‰€ä»¥å«åšéšæœºè®¿é—®å­˜å‚¨å™¨ï¼Œæ˜¯å› ä¸ºä¸åŒçš„åœ°å€å¯ä»¥åœ¨ç›¸åŒçš„æ—¶é—´å†…éšæœºè¯»å†™ã€‚è¿™æ˜¯ç”±RAMçš„ç»“æ„å†³å®šçš„ï¼ŒRAMä½¿ç”¨å­˜å‚¨é˜µåˆ—æ¥å­˜å‚¨æ•°æ®ï¼Œåªè¦ç»™å‡ºè¡Œåœ°å€å’Œåˆ—åœ°å€ï¼Œå°±èƒ½ç¡®å®šç›®æ ‡æ•°æ®ï¼Œè€Œä¸”è¿™ä¸€è¿‡ç¨‹å’Œç›®æ ‡æ•°æ®æ‰€å¤„çš„ç‰©ç†ä½ç½®æ— å…³ã€‚</p><p>å’ŒROMä¸€æ ·ï¼Œä¸ºäº†æ–¹ä¾¿å¯¹è®¾è®¡çš„MiniCPUè¿›è¡Œä»¿çœŸéªŒè¯ï¼Œæˆ‘ä»¬è¿˜æ˜¯ç”¨å¯„å­˜å™¨ï¼ˆregï¼‰ä¸´æ—¶æ„å»ºäº†ä¸€ä¸ªæ•°æ®å­˜å‚¨å™¨dmemï¼Œä½œä¸ºMiniCPUä¸­çš„RAMä½¿ç”¨ã€‚è™½ç„¶ä¸´æ—¶æ„å»ºçš„å­˜å‚¨å™¨å’Œå®é™…çš„ROMæœ‰ç‚¹å·®åˆ«ï¼Œä½†æˆ‘ä»¬è¿˜åœ¨åˆæœŸå­¦ä¹ é˜¶æ®µï¼Œè¿™å·²ç»è¶³å¤Ÿäº†ã€‚</p><p>ä¸‹é¢å°±æ˜¯å®ç°RAMåŠŸèƒ½çš„æ•°æ®å­˜å‚¨å™¨dmemçš„ä»£ç ï¼š</p><pre><code class=\"language-verilog\">module dmem(\n    input [11:0] addr,\n    input we,\n    input [31:0] din,\n    input clk,\n\n    output reg [31:0] dout\n);\n    reg [31:0] dmem_reg[0:4095];\n    \n    always @(posedge clk) begin\n        if(we) begin\n            dmem_reg[addr] &lt;= din;\n        end\n            dout &lt;= dmem_reg[addr];\n    end\nendmodule\n</code></pre><p>ä»£ç çš„ç¬¬11~16è¡Œå¯ä»¥çœ‹åˆ°ï¼Œæˆ‘ä»¬ä½¿ç”¨äº†æ—¶é’Ÿä¿¡å·clkï¼Œè¯´æ˜è¿™é‡Œçš„dmemå®ç°çš„æ˜¯ä¸€ä¸ªæ—¶é’ŸåŒæ­¥RAMã€‚è€Œä¸”å½“å†™ä½¿èƒ½ä¿¡å·ï¼ˆweï¼‰ä¸ºâ€œ1â€æ—¶ï¼Œæ‰èƒ½å¾€RAMé‡Œå†™æ•°æ®ï¼Œå¦åˆ™åªèƒ½è¯»å–æ•°æ®ã€‚</p><h2>å¤–è®¾UARTè®¾è®¡</h2><p>ä¸ºäº†è®©MiniCPUèƒ½å’Œå…¶ä»–ç”µå­è®¾å¤‡è¿›è¡Œé€šä¿¡ï¼Œæˆ‘ä»¬è¿˜è¦è®¾è®¡UARTæ¨¡å—ã€‚</p><p>åŒæ ·åœ°ï¼Œè®¾è®¡ä»£ç ä¹‹å‰æˆ‘å…ˆå¸¦ä½ å¿«é€Ÿäº†è§£ä¸€ä¸‹UARTæ˜¯ä»€ä¹ˆï¼Œå®ƒçš„å·¥ä½œåŸç†æ˜¯æ€æ ·çš„ã€‚</p><p>UARTçš„å…¨ç§°å«é€šç”¨å¼‚æ­¥æ”¶å‘ä¼ è¾“å™¨ï¼ˆUniversal Asynchronous Receiver/Transmitterï¼‰ï¼Œå®ƒæ˜¯ä¸€ç§ä¸²è¡Œã€å¼‚æ­¥ã€å…¨åŒå·¥çš„é€šä¿¡åè®®ï¼Œæ˜¯ç”µå­è®¾å¤‡é—´è¿›è¡Œå¼‚æ­¥é€šä¿¡çš„å¸¸ç”¨æ¨¡å—ã€‚</p><p>UARTè´Ÿè´£å¯¹ç³»ç»Ÿæ€»çº¿çš„å¹¶è¡Œæ•°æ®å’Œä¸²è¡Œå£ä¸Šçš„ä¸²è¡Œæ•°æ®è¿›è¡Œè½¬æ¢ï¼Œé€šä¿¡åŒæ–¹é‡‡ç”¨ç›¸åŒçš„æ³¢ç‰¹ç‡ã€‚åœ¨ä¸ä½¿ç”¨æ—¶é’Ÿä¿¡å·çº¿çš„æƒ…å†µä¸‹ï¼Œä»…ç”¨ä¸€æ ¹æ•°æ®å‘é€ä¿¡å·çº¿å’Œä¸€æ ¹æ•°æ®æ¥æ”¶ä¿¡å·çº¿ï¼ˆRxå’ŒTxï¼‰å°±å¯ä»¥å®Œæˆä¸¤ä¸ªè®¾å¤‡é—´çš„é€šä¿¡ï¼Œå› æ­¤æˆ‘ä»¬ä¹ŸæŠŠUARTç§°ä¸ºå¼‚æ­¥ä¸²è¡Œé€šä¿¡ã€‚</p><p>ä¸²è¡Œé€šä¿¡æ˜¯æŒ‡ï¼Œåˆ©ç”¨ä¸€æ¡ä¼ è¾“çº¿å°†æ•°æ®æŒ‰é¡ºåºä¸€ä½ä½ä¼ é€çš„è¿‡ç¨‹ã€‚UARTçš„å‘é€æ¨¡å—ä¼šæŠŠæ¥è‡ªCPUæ€»çº¿çš„å¹¶è¡Œæ•°æ®è½¬æ¢ä¸ºä¸²è¡Œæ•°æ®ï¼Œå†ä»¥ä¸²è¡Œæ–¹å¼å°†å…¶å‘é€åˆ°å¦ä¸€ä¸ªè®¾å¤‡çš„UARTæ¥æ”¶ç«¯ã€‚ç„¶åç”±UARTçš„æ¥æ”¶æ¨¡å—æŠŠä¸²è¡Œæ•°æ®è½¬æ¢ä¸ºå¹¶è¡Œæ•°æ®ï¼Œä»¥ä¾¿æ¥æ”¶è®¾å¤‡å­˜å‚¨å’Œä½¿ç”¨è¿™äº›æ•°æ®ã€‚</p><p>UARTçš„æ•°æ®ä¼ è¾“æ ¼å¼å¦‚ä¸‹å›¾æ‰€ç¤ºï¼š</p><p><img src=\"https://static001.geekbang.org/resource/image/e7/c2/e7308850a0d185b3ccdde6b7ef4806c2.jpg?wh=1920x872\" alt=\"å›¾ç‰‡\"></p><p>ä»å›¾é‡Œæˆ‘ä»¬å¯ä»¥çœ‹åˆ°ï¼ŒUARTä¼ è¾“æ•°æ®åŒ…æ‹¬èµ·å§‹ä½ã€æ•°æ®ä½ã€å¥‡å¶æ ¡éªŒä½ã€åœæ­¢ä½å’Œç©ºé—²ä½ã€‚UARTæ•°æ®ä¼ è¾“çº¿é€šå¸¸åœ¨ä¸ä¼ è¾“æ•°æ®æ—¶ä¿æŒåœ¨é«˜ç”µå¹³ã€‚</p><p>è¿™ä¹ˆå¤šåè¯æ˜¯ä¸æ˜¯æœ‰ç‚¹åº”æ¥ä¸æš‡ï¼Ÿæˆ‘æŒ¨ä¸ªè§£é‡Šä¸€ä¸‹ï¼Œä½ å°±æ¸…æ¥šäº†ã€‚</p><ul>\n<li><strong>èµ·å§‹ä½</strong>æ˜¯åœ¨æ•°æ®çº¿ä¸Šå…ˆå‘å‡ºä¸€ä¸ªé€»è¾‘ä½ç”µå¹³â€œ0â€ä¿¡å·ï¼Œè¡¨ç¤ºæ•°æ®ä¼ è¾“çš„å¼€å§‹ã€‚</li>\n<li><strong>æ•°æ®ä½</strong>æ˜¯ç”±5~8ä½é€»è¾‘é«˜ä½ç”µå¹³è¡¨ç¤ºçš„â€œ1â€æˆ–â€œ0â€ä¿¡å·ã€‚</li>\n<li><strong>æ ¡éªŒä½</strong>åœ¨ä¼ è¾“çš„æ•°æ®ä½çš„åé¢åŠ 1bitï¼Œè¡¨ç¤ºâ€œ1â€çš„ä½æ•°åº”ä¸ºå¶æ•°ï¼ˆå¶æ ¡éªŒï¼‰æˆ–å¥‡æ•°ï¼ˆå¥‡æ ¡éªŒï¼‰ã€‚</li>\n<li><strong>åœæ­¢ä½</strong>æ˜¯ä¸€ä¸ªæ•°æ®ä½å®½çš„1å€ã€1.5å€ã€æˆ–è€…2å€çš„é«˜ç”µå¹³ä¿¡å·ï¼Œå®ƒæ˜¯ä¸€æ¬¡æ•°æ®ä¼ è¾“çš„ç»“æŸæ ‡å¿—ã€‚</li>\n<li><strong>ç©ºé—²ä½</strong>æ˜¯æ•°æ®ä¼ è¾“çº¿å¤„äºé€»è¾‘é«˜ç”µå¹³çŠ¶æ€ï¼Œè¡¨ç¤ºå½“å‰çº¿è·¯ä¸Šå¤„äºç©ºé—²çŠ¶æ€ï¼Œæ²¡æœ‰æ•°æ®ä¼ é€ã€‚</li>\n</ul><p>è·Ÿæ•°æ®å‘é€ä¿¡å·çº¿TXã€æ•°æ®æ¥æ”¶ä¿¡å·çº¿RXç›¸å¯¹åº”ï¼Œæˆ‘ä»¬çš„UARTä¹Ÿåˆ†åˆ«è®¾è®¡äº†å‘é€æ¨¡å—ï¼ˆuart_txï¼‰å’Œæ¥æ”¶æ¨¡å—ï¼ˆuart_rxï¼‰ã€‚å¦‚æœä½ æƒ³äº†è§£å…·ä½“çš„åŠŸèƒ½å®ç°ï¼Œå¯ä»¥è¯¾åæŸ¥çœ‹æˆ‘ä»¬çš„MiniCPUçš„<a href=\"https://gitee.com/lmos/Geek-time-computer-foundation/tree/master/lesson06~11/mini_cpu\">é¡¹ç›®ä»£ç </a>ã€‚</p><p>è¿™é‡Œåªæ”¾å‡ºæ¥å‘é€æ¨¡å—çš„ç«¯å£ä¿¡å·ï¼Œå¦‚ä¸‹æ‰€ç¤ºï¼š</p><pre><code class=\"language-verilog\">module uart_tx(\ninput           clk         , // Top level system clock input.\ninput           resetn      , // Asynchronous active low reset.\noutput          uart_txd    , // UART transmit pin.\noutput          uart_tx_busy, // Module busy sending previous item.\ninput           uart_tx_en  , // Send the data on uart_tx_data\ninput   [7:0]   uart_tx_data  // The data to be sent\n);\n</code></pre><p>UARTæ¥æ”¶æ¨¡å—çš„ç«¯å£ä¿¡å·å¦‚ä¸‹ï¼š</p><pre><code class=\"language-verilog\">module uart_rx(\ninput         clk          , // Top level system clock input.\ninput         resetn       , // Asynchronous active low reset.\ninput         uart_rxd     , // UART Recieve pin.\ninput         uart_rx_en   , // Recieve enable\noutput        uart_rx_break, // Did we get a BREAK message?\noutput        uart_rx_valid, // Valid data recieved and available.\noutput reg  [7:0] uart_rx_data   // The recieved data.\n);\n</code></pre><p>ç«¯å£ä¿¡å·çš„ä»£ç ä½ ç»“åˆä¸Šé¢çš„æ³¨é‡Šå¾ˆå®¹æ˜“å°±èƒ½ç†è§£ï¼Œåé¢CPUè·‘ç¨‹åºçš„æ—¶å€™å°±ä¼šç”¨åˆ°è¿™éƒ¨åˆ†çš„åŠŸèƒ½ã€‚</p><h2>åœ¨CPUä¸Šè·‘ä¸ªHello World</h2><p>å¥½ï¼Œç°åœ¨æ¥åˆ°æˆ‘ä»¬çš„æœ€åä¸€ä¸ªç¯èŠ‚ï¼Œç¼–å†™ç¨‹åºï¼Œå¹¶æŠŠå®ƒæ”¾åˆ°æˆ‘ä»¬çš„MiniCPUä¸Šè·‘èµ·æ¥ã€‚</p><p>ä¸ºäº†èƒ½æ›´ç›´è§‚çœ‹åˆ°CPUçš„è¿è¡Œæ•ˆæœï¼Œè¿™é‡Œæˆ‘ä»¬ä½¿ç”¨RISC-Væ±‡ç¼–æŒ‡ä»¤ï¼Œè®¾è®¡äº†ä¸€æ®µç”¨UARTå‘é€â€œHello MiniCPU!â€å­—ç¬¦ä¸²çš„ä»£ç ï¼Œç„¶åè®©ä¸²å£æ¥æ”¶ç«¯æŠŠå‘é€çš„å­—ç¬¦ä¸²åœ¨ç”µè„‘ä¸Šæ‰“å°å‡ºæ¥ã€‚</p><p>å…·ä½“çš„ä»£ç å¦‚ä¸‹ï¼š</p><pre><code class=\"language-plain\">#\t\tAssembly&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Description\nmain:&nbsp; &nbsp;\n&nbsp; &nbsp; &nbsp; &nbsp; li&nbsp; &nbsp; &nbsp; x2, 0x20000000&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; # uart address\n&nbsp; &nbsp; &nbsp; &nbsp; li&nbsp; &nbsp; &nbsp; x6,&nbsp; 0x1500&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;#x6 &lt;== 0x1500, delay 1ms\n&nbsp; &nbsp; &nbsp; &nbsp; addi&nbsp; &nbsp; x7, x0, 0&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;#x7 &lt;== 0\n\n&nbsp; &nbsp; &nbsp; &nbsp; addi&nbsp; &nbsp; x5, x0, 0x48&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; #x5 &lt;== \"H\"\n&nbsp; &nbsp; &nbsp; &nbsp; sw&nbsp; &nbsp; &nbsp; x5, 0(x2)&nbsp;&nbsp;\n\ndelay1: addi&nbsp; &nbsp; x7, x7, 1&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;#x7 &lt;== x7 + 1\n&nbsp; &nbsp; &nbsp; &nbsp; bne&nbsp; &nbsp; &nbsp;x7, x6, delay1&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; #x6 != x7&nbsp;\n&nbsp; &nbsp; &nbsp; &nbsp; addi&nbsp; &nbsp; x7, x0, 0&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;#x7 &lt;== 0\n&nbsp; &nbsp; &nbsp; &nbsp; addi&nbsp; &nbsp; x5, x0, 0x65&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; #x5 &lt;== \"e\"\n&nbsp; &nbsp; &nbsp; &nbsp; sw&nbsp; &nbsp; &nbsp; x5, 0(x2)&nbsp;&nbsp;\n\ndelay2: addi&nbsp; &nbsp; x7, x7, 1&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;#x7 &lt;== x7 + 1\n&nbsp; &nbsp; &nbsp; &nbsp; bne&nbsp; &nbsp; &nbsp;x7, x6, delay2&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;#x6 != x7\n&nbsp; &nbsp; &nbsp; &nbsp; addi&nbsp; &nbsp; x7, x0, 0&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;#x7 &lt;== 0\n&nbsp; &nbsp; &nbsp; &nbsp; addi&nbsp; &nbsp; x5, x0, 0x6c&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; #x5 &lt;== \"l\"\n&nbsp; &nbsp; &nbsp; &nbsp; sw&nbsp; &nbsp; &nbsp; x5, 0(x2)&nbsp;\n\ndelay3: addi&nbsp; &nbsp; x7, x7, 1&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;#x7 &lt;== x7 + 1\n&nbsp; &nbsp; &nbsp; &nbsp; bne&nbsp; &nbsp; &nbsp;x7, x6, delay3&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;#x6 != x7\n&nbsp; &nbsp; &nbsp; &nbsp; addi&nbsp; &nbsp; x7, x0, 0&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;#x7 &lt;== 0\n&nbsp; &nbsp; &nbsp; &nbsp; addi&nbsp; &nbsp; x5, x0, 0x6c&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; #x5 &lt;== \"l\"\n&nbsp; &nbsp; &nbsp; &nbsp; sw&nbsp; &nbsp; &nbsp; x5, 0(x2)&nbsp;&nbsp;\n\n  â€¦â€¦â€¦â€¦  //ç”±äºä»£ç è¾ƒé•¿ï¼Œç»“æ„ç›¸ä¼¼ï¼Œè¿™é‡Œçœç•¥äº†ä¸€éƒ¨åˆ†ï¼Œå®Œæ•´ä»£ç ä½ å¯ä»¥ä»Giteeä¸Šè·å–\n\ndelay13: addi&nbsp; &nbsp; x7, x7, 1&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;#x7 &lt;== x7 + 1\n&nbsp; &nbsp; &nbsp; &nbsp; bne&nbsp; &nbsp; &nbsp;x7, x6, delay13&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;#x6 != x7\n&nbsp; &nbsp; &nbsp; &nbsp; addi&nbsp; &nbsp; x7, x0, 0&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;#x7 &lt;== 0\n&nbsp; &nbsp; &nbsp; &nbsp; addi&nbsp; &nbsp; x5, x0, 0x21&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; #x5 &lt;== \"!\"\n&nbsp; &nbsp; &nbsp; &nbsp; sw&nbsp; &nbsp; &nbsp; x5, 0(x2)&nbsp;\n\nend:&nbsp; &nbsp; j&nbsp; &nbsp; &nbsp; &nbsp;end\n\n&nbsp; &nbsp; &nbsp; &nbsp; ret\n</code></pre><p>æœ‰äº†ä»£ç ï¼Œæˆ‘ä»¬è¿˜éœ€è¦æŠŠå®ƒç¼–è¯‘æˆèƒ½åœ¨CPUä¸Šè¿è¡Œçš„æœºå™¨ç ï¼Œæ‰èƒ½æŠŠå®ƒæ”¾åœ¨CPUä¸Šè·‘ã€‚</p><p>ä¸‹é¢çš„ä»£ç å°±æ˜¯æ”¾åœ¨è¯¾ç¨‹ä»£ç ä¸­çš„Makefileï¼Œä½œç”¨æ˜¯ç¼–è¯‘æ±‡ç¼–ä»£ç ï¼Œè¿˜æœ‰å®šä¹‰å¥½CPUä»¿çœŸéœ€è¦ç”¨åˆ°çš„ä¸€äº›å‘½åè§„åˆ™ã€‚</p><pre><code class=\"language-makefile\">SOURCE_TB := ./tb/tb_top.v\nTMP_DIR := ./tmp\nSOURCE := ./rtl.f\nTARGET := ${TMP_DIR}/tb_top.o\n\nTEST_HEX := ./sim/asm/build/test.dat\n\n# ç¼–è¯‘æ±‡ç¼–ç¨‹åºï¼Œè¾“å‡ºäºŒè¿›åˆ¶æŒ‡ä»¤\nasm:\n\tmake -C ./sim/asm \n\tpython ./sim/asm/word2byte.py\n\n# å¯¹CPUè¿›è¡Œä»¿çœŸ\ncpu:\n\trm -f ${TMP_DIR}/*\n\tcp ${SOURCE_TB} ${TMP_DIR}\n\tsed -i 's#.hex#${TEST_HEX}#' ${TMP_DIR}/tb_top.v\n\tiverilog -f ${SOURCE} -o ${TARGET}\n\tvvp ${TARGET}\n\n# æŸ¥çœ‹æ³¢å½¢\nwave:\n\tgtkwave ${TMP_DIR}/tb_top.vcd &amp;\n\n# æ¸…é™¤ä¸´æ—¶æ–‡ä»¶\nclean:\n\tmake -C ./sim/asm clean\n\trm ./tmp/* -rf\n</code></pre><p>ä»Makefileçš„ä»£ç ä¸­å¯ä»¥çœ‹åˆ°ï¼Œæˆ‘ä»¬ä¸€å…±å®šä¹‰äº†4ä¸ªç›®æ ‡å‘½ä»¤ï¼Œå®ƒä»¬çš„ä½œç”¨åˆ†åˆ«æ˜¯å®Œæˆæ±‡ç¼–ç¨‹åºç¼–è¯‘çš„ï¼ˆasmï¼‰å‘½ä»¤ã€æ‰§è¡ŒMiniCPUä»¿çœŸçš„ï¼ˆcpuï¼‰å‘½ä»¤ã€ç”¨è½¯ä»¶GTKwaveæ‰“å¼€ä»¿çœŸåçš„æ³¢å½¢ï¼ˆwaveï¼‰å‘½ä»¤ï¼Œä»¥åŠæ¸…é™¤ä»¿çœŸè¿‡ç¨‹ä¸­äº§ç”Ÿçš„ä¸´æ—¶æ–‡ä»¶çš„ï¼ˆcleanï¼‰å‘½ä»¤ã€‚</p><p>é€šè¿‡åœ¨ç»ˆç«¯ä¸Šæ‰§è¡Œâ€œmake asmâ€å‘½ä»¤ï¼Œä¾¿å¯ä»¥æŠŠä¸Šé¢è®¾è®¡çš„æ±‡ç¼–ç¨‹åºç¼–è¯‘æˆäºŒè¿›åˆ¶æŒ‡ä»¤test.datã€‚ç„¶åæˆ‘ä»¬å†è¾“å…¥â€œmake cpuâ€å‘½ä»¤å°±å¯åŠ¨MiniCPUçš„ä»¿çœŸäº†ï¼Œè¿è¡Œç»“æœå¦‚ä¸‹å›¾æ‰€ç¤ºï¼š</p><p><img src=\"https://static001.geekbang.org/resource/image/93/77/93a1c6c0c1e71cb4cc6f5bffbc86f577.jpg?wh=1920x1043\" alt=\"å›¾ç‰‡\"></p><p>åˆ°æ­¤ï¼Œæˆ‘ä»¬çš„MiniCPUå°±è®¾è®¡å®Œæˆå•¦ï¼ç¥è´ºä½ ä¸€è·¯è¿›è¡Œåˆ°è¿™é‡Œã€‚çœ‹åˆ°é¡µé¢ä¸Šè¾“å‡ºHello MiniCPUçš„æ—¶å€™ï¼Œæ˜¯ä¸æ˜¯æ„Ÿè§‰è¿˜æŒºå¥½ç©çš„ï¼Ÿ</p><p>å¦‚æœä½ è§‰å¾—æ„çŠ¹æœªå°½ï¼Œè¿˜å¯ä»¥åœ¨é¡¹ç›®æ–‡ä»¶å¤¹é‡Œçš„â€œ./mini_cpu/sim/asm/src/miniCPU_sim.asmâ€è¿™ä¸ªæ–‡ä»¶ä¸­ç¼–å†™ä½ è‡ªå·±çš„RISC-Væ±‡ç¼–ç¨‹åºï¼Œç„¶åå°±å¯ä»¥åœ¨æˆ‘ä»¬çš„MiniCPUä¸Šç©å‡ºæ›´å¤šèŠ±æ ·äº†ã€‚</p><h2>é‡ç‚¹å›é¡¾</h2><p>è¿™èŠ‚è¯¾ï¼Œæˆ‘ä»¬æŠŠMiniCPUçš„å‡ ä¸ªå¤–éƒ¨æ¨¡å—è®¾è®¡å®Œæˆï¼Œè¿™å‡ ä¸ªæ¨¡å—æ˜¯è®©CPUâ€œè·‘èµ·æ¥â€çš„å¿…è¦ç»„ä»¶ã€‚</p><p><img src=\"https://static001.geekbang.org/resource/image/31/dd/31b586c344cd7d0127775e7ff63711dd.jpg?wh=1920x1289\" alt=\"å›¾ç‰‡\"></p><p>æˆ‘ä»¬é¦–å…ˆè®¾è®¡äº†MiniCPUçš„ç³»ç»Ÿæ€»çº¿ã€‚æœ‰äº†å®ƒï¼Œå°±èƒ½è¿æ¥CPUå†…æ ¸ä¸å¤–è®¾ï¼Œå®Œæˆä¿¡æ¯ä¼ è¾“çš„åŠŸèƒ½ï¼Œç›¸å½“äºCPUå†…æ ¸ä¸å¤–éƒ¨è®¾å¤‡çš„ä¸€åº§æ¡¥æ¢ã€‚</p><p>æ¥ä¸‹æ¥çš„æ¨¡å—å°±æ˜¯ROMå’ŒRAMã€‚ROMæ˜¯å­˜æ”¾CPUæŒ‡ä»¤çš„åªè¯»å­˜å‚¨å™¨ã€‚ä¸ºäº†æ–¹ä¾¿å­¦ä¹ å’Œä»¿çœŸï¼Œæˆ‘ä»¬é€šè¿‡å¯„å­˜å™¨ä¸´æ—¶å®šä¹‰äº†ä¸€ä¸ªæŒ‡ä»¤å­˜å‚¨å™¨ï¼Œç„¶ååœ¨ä»¿çœŸçš„é¡¶å±‚ä½¿ç”¨äº†$readmemhå‡½æ•°ï¼ŒæŠŠç¼–è¯‘å¥½çš„äºŒè¿›åˆ¶æŒ‡ä»¤è¯»å…¥åˆ°æŒ‡ä»¤å­˜å‚¨å™¨ä¸­ï¼Œè¿™æ ·CPUè¿è¡Œæ—¶å°±å¯ä»¥è¯»å–å’Œæ‰§è¡Œè¿™äº›æŒ‡ä»¤äº†ã€‚</p><p>RAMç”¨æ¥å­˜æ”¾æ•°æ®ï¼Œå®ƒåœ¨æ‰ç”µä¹‹åä¼šä¸¢å¤±æ•°æ®ï¼Œä½†æ˜¯è¯»å†™é€Ÿåº¦å¿«ï¼Œé€šå¸¸ç”¨æ¥ä½œä¸ºCPUçš„é«˜é€Ÿç¼“å­˜ã€‚è·ŸROMçš„å®ç°æ€è·¯ä¸€æ ·ï¼Œæˆ‘ä»¬è¿˜æ˜¯ç”¨å¯„å­˜å™¨ä¸´æ—¶æ„å»ºäº†ä¸€ä¸ªæ•°æ®å­˜å‚¨å™¨dmemï¼Œä½œä¸ºMiniCPUä¸­çš„RAMä½¿ç”¨ã€‚</p><p>ä¸ºäº†è®©MiniCPUèƒ½å’Œå…¶ä»–è®¾å¤‡é€šä¿¡ï¼Œæˆ‘ä»¬è¿˜è®¾è®¡äº†å¼‚æ­¥ä¸²è¡Œé€šä¿¡æ¨¡å—UARTï¼Œå®ƒç”¨ä¸€æ ¹æ•°æ®å‘é€ä¿¡å·çº¿å’Œä¸€æ ¹æ•°æ®æ¥æ”¶ä¿¡å·çº¿å°±å¯ä»¥å®Œæˆä¸¤ä¸ªè®¾å¤‡é—´çš„é€šä¿¡ã€‚</p><p>MiniCPUè®¾è®¡å¥½äº†ä¹‹åï¼Œæˆ‘ä»¬è¿›å…¥è¿è¡Œè°ƒè¯•ç¯èŠ‚ï¼Œç”¨RISC-VæŒ‡ä»¤ç¼–å†™äº†ä¸€æ®µç”¨UARTå‘é€â€œHello MiniCPU!â€å­—ç¬¦ä¸²çš„æ±‡ç¼–ç¨‹åºï¼Œç„¶åè®©ä¸²å£æ¥æ”¶ç«¯æŠŠå‘é€çš„å­—ç¬¦ä¸²åœ¨ç”µè„‘ä¸Šæ‰“å°å‡ºæ¥ã€‚å¦‚æœå­—ç¬¦ä¸²æ˜¾ç¤ºæ­£å¸¸ï¼Œè¯´æ˜æˆ‘ä»¬çš„miniCPUå·²ç»å¯ä»¥æ­£å¸¸è¿è¡Œäº†ã€‚</p><p>åˆ°è¿™é‡Œï¼Œæˆ‘ä»¬RISC-Vå¤„ç†å™¨çš„å®ç°å°±å…¨éƒ¨å®Œæˆäº†ã€‚è¿™èŠ‚è¯¾è¦ç‚¹ï¼Œä½ å¯ä»¥å‚è€ƒä¸‹é¢çš„å¯¼å›¾ã€‚</p><p><img src=\"https://static001.geekbang.org/resource/image/54/83/54b5250d3992644cf27ebe953fb44283.jpg?wh=1920x2109\" alt=\"å›¾ç‰‡\"></p><p>ä½ æœ‰å…´è¶£çš„è¯ï¼Œè¿˜å¯ä»¥è¯¾ååšæ›´å¤šçš„æ¢ç´¢ï¼Œæ¯”å¦‚ç»™å®ƒæ·»åŠ æ›´å¤šçš„RISCVæŒ‡ä»¤åŠŸèƒ½ï¼Œåœ¨CPUæ€»çº¿ä¸ŠæŒ‚è½½æ›´å¤šçš„å¤–è®¾â€¦â€¦åé¢çš„è¯¾ç¨‹é‡Œï¼Œæˆ‘ä¼šå¸¦ä½ å­¦ä¹ æ›´å¤šçš„RISC-VæŒ‡ä»¤ï¼Œæ•¬è¯·æœŸå¾…ï¼</p><h2>æ€è€ƒé¢˜</h2><p>è®¡ç®—æœºä¸¤å¤§ä½“ç³»ç»“æ„åˆ†åˆ«æ˜¯å†¯è¯ºä¾æ›¼ä½“ç³»ç»“æ„å’Œå“ˆå¼—ä½“ç³»ç»“æ„ï¼Œè¯·é—®æˆ‘ä»¬çš„MiniCPUå±äºå“ªä¸€ç§ä½“ç³»ç»“æ„å‘¢ï¼Ÿ</p><p>æœŸå¾…ä½ åœ¨ç•™è¨€åŒºè·Ÿæˆ‘äº¤æµäº’åŠ¨ï¼Œè¯´è¯´è¿™ä¸ªæ¨¡å—å­¦ä¹ ä¸‹æ¥çš„æ„Ÿå—ï¼Œå¦‚æœè§‰å¾—æ‰‹å†™CPUå¾ˆé…·ï¼Œåˆ«å¿˜äº†åˆ†äº«ç»™èº«è¾¹æ›´å¤šçš„æœ‹å‹ã€‚</p>","comments":[{"had_liked":false,"id":354918,"user_name":"mantra","can_delete":false,"product_type":"c1","uid":1389310,"ip_address":"","ucode":"81705795D01642","user_header":"https://static001.geekbang.org/account/avatar/00/15/32/fe/c2179924.jpg","comment_is_top":true,"comment_ctime":1660880514,"is_pvip":false,"replies":[{"id":129096,"content":"1.mini CPUçš„è®²è§£å‘Šä¸€æ®µè½äº†ï¼Œç›®å‰ä¸“æ é‡Œæ²¡è®¡åˆ’åç»­æ‰©å±•ï¼Œæœ‰ä»€ä¹ˆæƒ³æ³•å»ºè®®å¯ä»¥è¯´è¯´ï¼Œè¿™æ ·LMOSä¹Ÿèƒ½çœ‹åˆ°ã€‚\n\nåé¢å¯ä»¥çœ‹çœ‹å¤§ä¼™å„¿å®é™…å­¦ä¹ æƒ…å†µï¼Œä¹Ÿæ¬¢è¿è‡ªèå’ŒLMOSå›¢é˜Ÿçš„åœ¨å¼€æºCosmos Psié‡ŒæŠ˜è…¾æ›´å¤šä¸œè¥¿ã€‚é¡¹ç›®é“¾æ¥ï¼ˆåˆå§‹é˜¶æ®µï¼Œæœªæ¥å¯æœŸï¼‰ https:&#47;&#47;github.com&#47;CosmosPsi&#47;CosmosDocs ï¼Œæ„Ÿè§‰ä¸é”™è®°å¾—staræ”¯æŒä¸‹ï¼\n\n2.ç¯å¢ƒæ­å»ºä¸‹å‘¨ä¸€ã€ä¸‰å‘å¸ƒï¼Œä¸€å…±ä¸¤èŠ‚è¯¾è®²è§£äº¤å‰ç¼–è¯‘ç¯å¢ƒé…ç½®ï¼Œé™¤äº†ä½ è¯´GCCï¼Œåº”è¯¥è¿˜ç”¨åˆ°äº†Deepinã€‚\n\n3.è¯¾ç¨‹è®¾è®¡çš„æ—¶å€™ï¼Œè€ƒè™‘åˆ°åŒå­¦ä»¬æ°´å¹³å‚å·®ä¸é½ï¼Œä¸ºäº†å°½é‡è®©å¤§å®¶è·Ÿä¸Šè€å¸ˆæ­¥ä¼ï¼Œæœ‰æ‰€æ”¶è·ã€‚åé¢çš„è¯¾ç¨‹è·Ÿmin_cpu æ²¡æœ‰ç›´æ¥çš„â€œä¾èµ–â€æ€§ã€‚æ„æ€å°±æ˜¯ï¼Œå‰é¢æ‰‹å†™CPUä½ è§‰å¾—æ¯”è¾ƒéš¾ï¼Œæš‚æ—¶è¿˜è¾¾ä¸åˆ°æ‰‹å†™å‡ºCPUçš„ç¨‹åº¦ï¼Œä¹Ÿå¹¶ä¸å½±å“å­¦ä¹ åç»­å†…å®¹ã€‚\n\né¢˜å¤–è¯ï¼šå½“ç„¶å•¦ï¼Œä½ ç¡¬ä»¶å’Œè¯­è¨€éƒ½æŒæ¡äº†ï¼Œé‚£æ›´å¥½ã€‚å‰æœŸåšç”¨æˆ·è°ƒç ”çš„æ—¶å€™ï¼Œæœ‰ä¸ªåŒå­¦æåˆ°ä¸€ä¸ªæ€è·¯ï¼šå¦‚æœæŠŠæ‰§å¯æ‰§è¡Œç¨‹åºåæ±‡ç¼–ï¼Œç„¶åé€šè¿‡CPUæ–¹é’ˆæˆ–å…¶ä»–æ‰‹æ®µæ‰§è¡Œè€…å¯æ‰§è¡Œç¨‹åºï¼Œæˆ‘ä»¬çœ‹çœ‹CPUçš„æŒ‡ä»¤æµæ˜¯å•¥æ ·ï¼Œå°±èƒ½å¸®ä½ æŠŠCPUå’Œæ±‡ç¼–ä¸²è”èµ·æ¥äº†ã€‚","user_name":"ç¼–è¾‘å›å¤","user_name_real":"ç¼–è¾‘","uid":1501385,"ctime":1660884625,"ip_address":"","comment_id":354918,"utype":2}],"discussion_count":1,"race_medal":0,"score":2,"product_id":100117801,"comment_content":"è¯¢é—®å°ç¼–ä¸€ä¸ªå°é—®é¢˜ï¼šå­¦åˆ°æ­¤å¤„ mini_cpu å°ç»“äº†ï¼Œè¿˜æœ‰åç»­çš„æ‰©å±•å—ï¼Ÿåç»­ â€œRISC-V æŒ‡ä»¤ç²¾è®²ï¼ˆXï¼‰â€ ç³»åˆ—æ˜¯åœ¨ GCC + QEMU ç¯å¢ƒå®ç°å—ï¼Ÿä¼šå’Œ min_cpu æœ‰å…³è”å—ï¼Ÿè°¢è°¢ï¼","like_count":1,"discussions":[{"author":{"id":1501385,"avatar":"https://static001.geekbang.org/account/avatar/00/16/e8/c9/59bcd490.jpg","nickname":"å¬æ°´çš„æ¹–","note":"","ucode":"B1759F90165D81","race_medal":0,"user_type":8,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":584504,"discussion_content":"1.mini CPUçš„è®²è§£å‘Šä¸€æ®µè½äº†ï¼Œç›®å‰ä¸“æ é‡Œæ²¡è®¡åˆ’åç»­æ‰©å±•ï¼Œæœ‰ä»€ä¹ˆæƒ³æ³•å»ºè®®å¯ä»¥è¯´è¯´ï¼Œè¿™æ ·LMOSä¹Ÿèƒ½çœ‹åˆ°ã€‚\n\nåé¢å¯ä»¥çœ‹çœ‹å¤§ä¼™å„¿å®é™…å­¦ä¹ æƒ…å†µï¼Œä¹Ÿæ¬¢è¿è‡ªèå’ŒLMOSå›¢é˜Ÿçš„åœ¨å¼€æºCosmos Psié‡ŒæŠ˜è…¾æ›´å¤šä¸œè¥¿ã€‚é¡¹ç›®é“¾æ¥ï¼ˆåˆå§‹é˜¶æ®µï¼Œæœªæ¥å¯æœŸï¼‰ https://github.com/CosmosPsi/CosmosDocs ï¼Œæ„Ÿè§‰ä¸é”™è®°å¾—staræ”¯æŒä¸‹ï¼\n\n2.ç¯å¢ƒæ­å»ºä¸‹å‘¨ä¸€ã€ä¸‰å‘å¸ƒï¼Œä¸€å…±ä¸¤èŠ‚è¯¾è®²è§£äº¤å‰ç¼–è¯‘ç¯å¢ƒé…ç½®ï¼Œé™¤äº†ä½ è¯´GCCï¼Œåº”è¯¥è¿˜ç”¨åˆ°äº†Deepinã€‚\n\n3.è¯¾ç¨‹è®¾è®¡çš„æ—¶å€™ï¼Œè€ƒè™‘åˆ°åŒå­¦ä»¬æ°´å¹³å‚å·®ä¸é½ï¼Œä¸ºäº†å°½é‡è®©å¤§å®¶è·Ÿä¸Šè€å¸ˆæ­¥ä¼ï¼Œæœ‰æ‰€æ”¶è·ã€‚åé¢çš„è¯¾ç¨‹è·Ÿmin_cpu æ²¡æœ‰ç›´æ¥çš„â€œä¾èµ–â€æ€§ã€‚æ„æ€å°±æ˜¯ï¼Œå‰é¢æ‰‹å†™CPUä½ è§‰å¾—æ¯”è¾ƒéš¾ï¼Œæš‚æ—¶è¿˜è¾¾ä¸åˆ°æ‰‹å†™å‡ºCPUçš„ç¨‹åº¦ï¼Œä¹Ÿå¹¶ä¸å½±å“å­¦ä¹ åç»­å†…å®¹ã€‚\n\né¢˜å¤–è¯ï¼šå½“ç„¶å•¦ï¼Œä½ ç¡¬ä»¶å’Œè¯­è¨€éƒ½æŒæ¡äº†ï¼Œé‚£æ›´å¥½ã€‚å‰æœŸåšç”¨æˆ·è°ƒç ”çš„æ—¶å€™ï¼Œæœ‰ä¸ªåŒå­¦æåˆ°ä¸€ä¸ªæ€è·¯ï¼šå¦‚æœæŠŠæ‰§å¯æ‰§è¡Œç¨‹åºåæ±‡ç¼–ï¼Œç„¶åé€šè¿‡CPUæ–¹é’ˆæˆ–å…¶ä»–æ‰‹æ®µæ‰§è¡Œè€…å¯æ‰§è¡Œç¨‹åºï¼Œæˆ‘ä»¬çœ‹çœ‹CPUçš„æŒ‡ä»¤æµæ˜¯å•¥æ ·ï¼Œå°±èƒ½å¸®ä½ æŠŠCPUå’Œæ±‡ç¼–ä¸²è”èµ·æ¥äº†ã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1660884625,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":8}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":355421,"user_name":"Liu Zheng","can_delete":false,"product_type":"c1","uid":3081103,"ip_address":"æ¹–åŒ—","ucode":"14E78E879FEA05","user_header":"https://static001.geekbang.org/account/avatar/00/2f/03/8f/38038fb5.jpg","comment_is_top":false,"comment_ctime":1661350983,"is_pvip":false,"replies":[{"id":129439,"content":"å¯¹ ","user_name":"ä½œè€…å›å¤","user_name_real":"ç¼–è¾‘","uid":1345199,"ctime":1661677509,"ip_address":"æ¹–åŒ—","comment_id":355421,"utype":1}],"discussion_count":1,"race_medal":0,"score":2,"product_id":100117801,"comment_content":"éœ€è¦æŒ‡å‡ºä¸€ä¸‹ï¼Œå¦‚æœåŒå­¦ç”¨13è®²é‡Œçš„æ–¹æ³•å®‰è£…toolchainçš„è¯ï¼Œéœ€è¦ä½œä»¥ä¸‹ä¿®æ”¹æ‰èƒ½è·‘å‡ºhello worldæ¥ï¼š\n1. åœ¨`sim&#47;asm&#47;Makefile`ä¸­ï¼Œéœ€è¦æŠŠæ‰€æœ‰çš„`riscv32`éƒ½æ›¿æ¢æˆ`riscv64`ã€‚è¯¦æƒ…è§12è®²é‡Œé¢çš„multilibéƒ¨åˆ†ã€‚\n2. å¦‚æœä½ å’Œæˆ‘ä¸€æ ·ç”¨çš„æ˜¯ubuntu 20.04ï¼Œé‚£ä¹ˆéœ€è¦`mini_cpu&#47;Makefile`é‡Œé¢ï¼ŒæŠŠ`python`æ¢æˆ`python3`ã€‚å› ä¸ºé»˜è®¤ubuntu20.04å¼€å§‹å·²ç»æ²¡æœ‰`python`äº†ã€‚","like_count":3,"discussions":[{"author":{"id":1345199,"avatar":"https://static001.geekbang.org/account/avatar/00/14/86/af/99219321.jpg","nickname":"LMOS","note":"","ucode":"B037712C8B8B3C","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":585558,"discussion_content":"å¯¹ ","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1661677509,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"æ¹–åŒ—","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":355182,"user_name":"likejjj","can_delete":false,"product_type":"c1","uid":1285612,"ip_address":"æ¹–åŒ—","ucode":"005BF873B32EA1","user_header":"http://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTKy9XSxDLRibViazIs1wzhEmIQqMlhcoKhTXNvxXkaPGIveib8B9ibvpdkZxABKFIc4iaSMrkTh7EfWjtg/132","comment_is_top":false,"comment_ctime":1661158008,"is_pvip":false,"replies":[{"id":129445,"content":"ä¸å»ºè®®","user_name":"ä½œè€…å›å¤","user_name_real":"ç¼–è¾‘","uid":1345199,"ctime":1661677816,"ip_address":"æ¹–åŒ—","comment_id":355182,"utype":1}],"discussion_count":3,"race_medal":0,"score":2,"product_id":100117801,"comment_content":"å¯ä»¥åœ¨fpgaä¸Šé¢è·‘è¿™ä¸ªcpuä¸ï¼Ÿ","like_count":1,"discussions":[{"author":{"id":1345199,"avatar":"https://static001.geekbang.org/account/avatar/00/14/86/af/99219321.jpg","nickname":"LMOS","note":"","ucode":"B037712C8B8B3C","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":585565,"discussion_content":"ä¸å»ºè®®","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1661677816,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"æ¹–åŒ—","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":2089797,"avatar":"https://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTLbTk9yliaYgyfZxQic2p1k8C6AnzNZIic3Idh4vAX5lVicLIo6ZODqABp6y97viakp1hkXIDmocAAUib0w/132","nickname":"Geek_b49420","note":"","ucode":"2C09ECAFCE6B41","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":586999,"discussion_content":"éœ€è¦åšå“ªäº›è°ƒæ•´å‘¢","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1662680344,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":"åŒ—äº¬","group_id":0},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":2685179,"avatar":"https://static001.geekbang.org/account/avatar/00/28/f8/fb/b3ef94fc.jpg","nickname":"é˜¿ç™½","note":"","ucode":"15A30369FCC689","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":585521,"discussion_content":"éœ€è¦åšä¸€äº›é€‚é…","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1661652544,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":"å¹¿ä¸œ","group_id":0},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":354966,"user_name":"é’ç‰ç™½éœ²","can_delete":false,"product_type":"c1","uid":2619436,"ip_address":"æ¹–åŒ—","ucode":"96FE2D4D2B94A0","user_header":"https://static001.geekbang.org/account/avatar/00/27/f8/2c/92969c48.jpg","comment_is_top":false,"comment_ctime":1660919093,"is_pvip":false,"replies":[{"id":129163,"content":"æ”¯æŒ ","user_name":"ä½œè€…å›å¤","user_name_real":"ç¼–è¾‘","uid":1345199,"ctime":1661051177,"ip_address":"æ¹–åŒ—","comment_id":354966,"utype":1}],"discussion_count":1,"race_medal":0,"score":2,"product_id":100117801,"comment_content":"æ‰“ç®—å†™ä¸ªæ±‡ç¼–æä¸€ä¸‹ï¼","like_count":1,"discussions":[{"author":{"id":1345199,"avatar":"https://static001.geekbang.org/account/avatar/00/14/86/af/99219321.jpg","nickname":"LMOS","note":"","ucode":"B037712C8B8B3C","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":584679,"discussion_content":"æ”¯æŒ ","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1661051178,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"æ¹–åŒ—","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":358333,"user_name":"ğŸ˜‡","can_delete":false,"product_type":"c1","uid":3068400,"ip_address":"æ¹–åŒ—","ucode":"594695757BAD99","user_header":"https://static001.geekbang.org/account/avatar/00/2e/d1/f0/0eafdb8e.jpg","comment_is_top":false,"comment_ctime":1664204312,"is_pvip":false,"replies":[{"id":130473,"content":"ç«‹å³æ•°","user_name":"ä½œè€…å›å¤","user_name_real":"ç¼–è¾‘","uid":1345199,"ctime":1664596425,"ip_address":"æ¹–åŒ—","comment_id":358333,"utype":1}],"discussion_count":1,"race_medal":0,"score":2,"product_id":100117801,"comment_content":"æ€»çº¿ä½ çš„cpu--&gt;imemçš„imemæ˜¯å•¥æ„æ€å•Š","like_count":0,"discussions":[{"author":{"id":1345199,"avatar":"https://static001.geekbang.org/account/avatar/00/14/86/af/99219321.jpg","nickname":"LMOS","note":"","ucode":"B037712C8B8B3C","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":589256,"discussion_content":"ç«‹å³æ•°","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1664596426,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"æ¹–åŒ—","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":355675,"user_name":"ğŸ˜‡","can_delete":false,"product_type":"c1","uid":3068400,"ip_address":"æ¹–åŒ—","ucode":"594695757BAD99","user_header":"https://static001.geekbang.org/account/avatar/00/2e/d1/f0/0eafdb8e.jpg","comment_is_top":false,"comment_ctime":1661623000,"is_pvip":false,"replies":[{"id":129431,"content":"æ²¡æœ‰ é…ç½®å¥½ ç¼–è¯‘å™¨ ","user_name":"ä½œè€…å›å¤","user_name_real":"ç¼–è¾‘","uid":1345199,"ctime":1661677012,"ip_address":"æ¹–åŒ—","comment_id":355675,"utype":1}],"discussion_count":2,"race_medal":0,"score":2,"product_id":100117801,"comment_content":"è€å¸ˆä½ å¥½ï¼Œæˆ‘çš„è¿è¡Œmake asmåæ˜¾ç¤º\nmake -C .&#47;sim&#47;asm \nmake[1]: è¿›å…¥ç›®å½•â€œ&#47;home&#47;qianq&#47;mini_cpu&#47;sim&#47;asmâ€\n+ AS src&#47;miniCPU_sim.asm build&#47;miniCPU_sim.o\nmake[1]: riscv32-unknown-elf-as: Command not found\nMakefile:27: recipe for target &#39;build&#47;miniCPU_sim.o&#39; failed\nmake[1]: *** [build&#47;miniCPU_sim.o] Error 127\nmake[1]: ç¦»å¼€ç›®å½•â€œ&#47;home&#47;qianq&#47;mini_cpu&#47;sim&#47;asmâ€\nMakefile:11: recipe for target &#39;asm&#39; failed\nmake: *** [asm] Error 2\nè¯·é—®è¿™ä¸ªå‡ºé”™æ˜¯ä»€ä¹ˆåŸå› å‘¢","like_count":0,"discussions":[{"author":{"id":1345199,"avatar":"https://static001.geekbang.org/account/avatar/00/14/86/af/99219321.jpg","nickname":"LMOS","note":"","ucode":"B037712C8B8B3C","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":585550,"discussion_content":"æ²¡æœ‰ é…ç½®å¥½ ç¼–è¯‘å™¨ ","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1661677012,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"æ¹–åŒ—","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":1,"child_discussions":[{"author":{"id":3068400,"avatar":"https://static001.geekbang.org/account/avatar/00/2e/d1/f0/0eafdb8e.jpg","nickname":"ğŸ˜‡","note":"","ucode":"594695757BAD99","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":1345199,"avatar":"https://static001.geekbang.org/account/avatar/00/14/86/af/99219321.jpg","nickname":"LMOS","note":"","ucode":"B037712C8B8B3C","race_medal":0,"user_type":2,"is_pvip":false},"discussion":{"id":585784,"discussion_content":"æŒ‰ç…§12è®²çš„å†…å®¹é…ç½®å¯ä»¥å—","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1661826250,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":585550,"ip_address":"ç¦å»º","group_id":0},"score":585784,"extra":""}]}]},{"had_liked":false,"id":355138,"user_name":"Liu Zheng","can_delete":false,"product_type":"c1","uid":3081103,"ip_address":"æ¹–åŒ—","ucode":"14E78E879FEA05","user_header":"https://static001.geekbang.org/account/avatar/00/2f/03/8f/38038fb5.jpg","comment_is_top":false,"comment_ctime":1661132160,"is_pvip":false,"replies":[{"id":129453,"content":"è¦æ”¹ä»£ç  çš„ ","user_name":"ä½œè€…å›å¤","user_name_real":"ç¼–è¾‘","uid":1345199,"ctime":1661678400,"ip_address":"æ¹–åŒ—","comment_id":355138,"utype":1}],"discussion_count":2,"race_medal":0,"score":2,"product_id":100117801,"comment_content":"è€å¸ˆï¼Œæƒ³é—®ä¸€ä¸‹ï¼Œè¿™é‡Œæ±‡ç¼–ä»£ç é‡Œé¢æ²¡å‘é€ä¸€ä¸ªå­—ç¬¦å»¶æ—¶1msæ˜¯ä¸ºäº†åŒ¹é…uartçš„æ³¢ç‰¹ç‡å—ï¼Ÿè¯·é—®è¿™ä¸ªmini cpuçš„ä¸²å£çš„æ³¢ç‰¹ç‡æ˜¯åœ¨å“ªé‡ŒæŒ‡æ˜çš„å•Šï¼Ÿæ˜¯å›ºå®šåœ¨uartçš„verilogä»£ç çš„æŸä¸ªåœ°æ–¹äº†å—ï¼Ÿ","like_count":0,"discussions":[{"author":{"id":1345199,"avatar":"https://static001.geekbang.org/account/avatar/00/14/86/af/99219321.jpg","nickname":"LMOS","note":"","ucode":"B037712C8B8B3C","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":585573,"discussion_content":"è¦æ”¹ä»£ç  çš„ ","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1661678400,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"æ¹–åŒ—","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1358045,"avatar":"https://static001.geekbang.org/account/avatar/00/14/b8/dd/37726c34.jpg","nickname":"å°é©¬å“¥","note":"","ucode":"B2C0FF38F8C9BC","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":636338,"discussion_content":"è¿™æ ·çš„å›å¤ååº”äº†è¯¾ç¨‹ä½œè€…çš„ä»€ä¹ˆæ€åº¦å‘¢","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1705968450,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":"åŒ—äº¬","group_id":0},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":355026,"user_name":"äº‘æµ·","can_delete":false,"product_type":"c1","uid":3014434,"ip_address":"æ¹–åŒ—","ucode":"DFD02716F95B2D","user_header":"https://static001.geekbang.org/account/avatar/00/2d/ff/22/dadbadb2.jpg","comment_is_top":false,"comment_ctime":1660985189,"is_pvip":false,"replies":[{"id":129162,"content":"è¦å®‰è£… riscvå·¥å…·é“¾\n","user_name":"ä½œè€…å›å¤","user_name_real":"ç¼–è¾‘","uid":1345199,"ctime":1661051167,"ip_address":"æ¹–åŒ—","comment_id":355026,"utype":1}],"discussion_count":1,"race_medal":0,"score":2,"product_id":100117801,"comment_content":"ä¸ºä»€ä¹ˆæˆ‘è¿è¡Œ make asm çš„æ—¶å€™å‡ºç°è¿™æ ·çš„errorï¼Ÿè°¢è°¢\n\nmake -C .&#47;sim&#47;asm \nmake[1]: Entering directory &#39;&#47;home&#47;yh&#47;ws&#47;riscv&#47;Geek-time-computer-foundation&#47;lesson06~11&#47;mini_cpu&#47;sim&#47;asm&#39;\n+ AS src&#47;miniCPU_sim.asm build&#47;miniCPU_sim.o\nmake[1]: riscv32-unknown-elf-as: Command not found\nMakefile:27: recipe for target &#39;build&#47;miniCPU_sim.o&#39; failed\nmake[1]: *** [build&#47;miniCPU_sim.o] Error 127\nmake[1]: Leaving directory &#39;&#47;home&#47;yh&#47;ws&#47;riscv&#47;Geek-time-computer-foundation&#47;lesson06~11&#47;mini_cpu&#47;sim&#47;asm&#39;\nMakefile:11: recipe for target &#39;asm&#39; failed\nmake: *** [asm] Error 2\n","like_count":0,"discussions":[{"author":{"id":1345199,"avatar":"https://static001.geekbang.org/account/avatar/00/14/86/af/99219321.jpg","nickname":"LMOS","note":"","ucode":"B037712C8B8B3C","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":584678,"discussion_content":"è¦å®‰è£… riscvå·¥å…·é“¾\n","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1661051167,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"æ¹–åŒ—","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":354907,"user_name":"TableBear","can_delete":false,"product_type":"c1","uid":1673990,"ip_address":"","ucode":"A2C0562EEA2725","user_header":"https://static001.geekbang.org/account/avatar/00/19/8b/06/fb3be14a.jpg","comment_is_top":false,"comment_ctime":1660876756,"is_pvip":false,"replies":[{"id":129094,"content":"æ…¢æ…¢æ¥ï¼Œä¸ç§¯è·¬æ­¥æ— ä»¥è‡³åƒé‡Œã€‚æœ‰å•¥å…·ä½“çš„é—®é¢˜ï¼Œä¹Ÿå¯ä»¥å‘å‡ºæ¥ï½","user_name":"ç¼–è¾‘å›å¤","user_name_real":"ç¼–è¾‘","uid":1501385,"ctime":1660877956,"ip_address":"","comment_id":354907,"utype":2}],"discussion_count":1,"race_medal":0,"score":2,"product_id":100117801,"comment_content":"å¥½éš¾o(â•¥ï¹â•¥)o","like_count":0,"discussions":[{"author":{"id":1501385,"avatar":"https://static001.geekbang.org/account/avatar/00/16/e8/c9/59bcd490.jpg","nickname":"å¬æ°´çš„æ¹–","note":"","ucode":"B1759F90165D81","race_medal":0,"user_type":8,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":584492,"discussion_content":"æ…¢æ…¢æ¥ï¼Œä¸ç§¯è·¬æ­¥æ— ä»¥è‡³åƒé‡Œã€‚æœ‰å•¥å…·ä½“çš„é—®é¢˜ï¼Œä¹Ÿå¯ä»¥å‘å‡ºæ¥ï½","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1660877956,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":8}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":354904,"user_name":"è‹æµéƒå®“","can_delete":false,"product_type":"c1","uid":2729645,"ip_address":"æ¹–åŒ—","ucode":"AD07BD9CE03047","user_header":"https://static001.geekbang.org/account/avatar/00/29/a6/ad/e65aec4c.jpg","comment_is_top":false,"comment_ctime":1660875993,"is_pvip":false,"replies":[{"id":129167,"content":"å˜¿å˜¿","user_name":"ä½œè€…å›å¤","user_name_real":"ç¼–è¾‘","uid":1345199,"ctime":1661051251,"ip_address":"æ¹–åŒ—","comment_id":354904,"utype":1}],"discussion_count":1,"race_medal":0,"score":2,"product_id":100117801,"comment_content":"å“ˆä½›ç»“æ„ï¼Ÿ","like_count":0,"discussions":[{"author":{"id":1345199,"avatar":"https://static001.geekbang.org/account/avatar/00/14/86/af/99219321.jpg","nickname":"LMOS","note":"","ucode":"B037712C8B8B3C","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":584683,"discussion_content":"å˜¿å˜¿","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1661051251,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"æ¹–åŒ—","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":387854,"user_name":"èŒƒå»·ä¸œ","can_delete":false,"product_type":"c1","uid":2872395,"ip_address":"å¹¿ä¸œ","ucode":"30E3454EB3424E","user_header":"https://static001.geekbang.org/account/avatar/00/2b/d4/4b/ec621442.jpg","comment_is_top":false,"comment_ctime":1708685927,"is_pvip":false,"replies":null,"discussion_count":0,"race_medal":0,"score":3,"product_id":100117801,"comment_content":"è·‘é€šè¿™ä¸ªæ¡ˆä¾‹ï¼Œéœ€è¦ç”¨ubuntuæˆ–centosçš„è™šæ‹Ÿæœºï¼Ÿéœ€è¦å®‰è£…ä»€ä¹ˆå·¥å…·ï¼Ÿ\n\nè¿™äº›èƒ½ä¸èƒ½è¡¥å……è¯´ä¸€ä¸‹ï¼›","like_count":0},{"had_liked":false,"id":381006,"user_name":"æ°¢åŸå­","can_delete":false,"product_type":"c1","uid":1102860,"ip_address":"åŒ—äº¬","ucode":"13F32E1229C0D1","user_header":"https://static001.geekbang.org/account/avatar/00/10/d4/0c/4decd1aa.jpg","comment_is_top":false,"comment_ctime":1694579455,"is_pvip":false,"replies":null,"discussion_count":0,"race_medal":0,"score":3,"product_id":100117801,"comment_content":"è®¡ç®—æœºä¸¤å¤§ä½“ç³»ç»“æ„åˆ†åˆ«æ˜¯å†¯è¯ºä¾æ›¼ä½“ç³»ç»“æ„å’Œå“ˆå¼—ä½“ç³»ç»“æ„ï¼Œå¯ä»¥è‡ªå·±è®¾è®¡ç¬¬ä¸‰ä¸ªä½“ç³»ç»“æ„å—ï¼Ÿ","like_count":0}]}