{"id":206281,"title":"06 | RPCå®æˆ˜ï¼šå‰–ægRPCæºç ï¼ŒåŠ¨æ‰‹å®ç°ä¸€ä¸ªå®Œæ•´çš„RPC","content":"<p>ä½ å¥½ï¼Œæˆ‘æ˜¯ä½•å°é”‹ã€‚ä¸Šä¸€è®²æˆ‘åˆ†äº«äº†åŠ¨æ€ä»£ç†ï¼Œå…¶ä½œç”¨æ€»ç»“èµ·æ¥å°±æ˜¯ä¸€å¥è¯ï¼šâ€œæˆ‘ä»¬å¯ä»¥é€šè¿‡åŠ¨æ€ä»£ç†æŠ€æœ¯ï¼Œå±è”½ RPC è°ƒç”¨çš„ç»†èŠ‚ï¼Œä»è€Œè®©ä½¿ç”¨è€…èƒ½å¤Ÿé¢å‘æ¥å£ç¼–ç¨‹ã€‚â€</p><p>åˆ°ä»Šå¤©ä¸ºæ­¢ï¼Œæˆ‘ä»¬å·²ç»æŠŠ RPC é€šä¿¡è¿‡ç¨‹ä¸­è¦ç”¨åˆ°çš„æ‰€æœ‰åŸºç¡€çŸ¥è¯†éƒ½è®²äº†ä¸€éï¼Œä½†è¿™äº›å†…å®¹å¤šå±äºç†è®ºã€‚<strong>è¿™ä¸€è®²æˆ‘ä»¬å°±æ¥å®æˆ˜ä¸€ä¸‹ï¼Œçœ‹çœ‹å…·ä½“è½å®åˆ°ä»£ç ä¸Šï¼Œæˆ‘ä»¬åº”è¯¥æ€ä¹ˆå®ç°ä¸€ä¸ª RPC æ¡†æ¶ï¼Ÿ</strong></p><p>ä¸ºäº†èƒ½è®©å’±ä»¬å¿«é€Ÿè¾¾æˆå…±è¯†ï¼Œæˆ‘é€‰æ‹©å‰–æ gRPC æºç ï¼ˆæºç åœ°å€ï¼š<a href=\"https://github.com/grpc/grpc-java\">https://github.com/grpc/grpc-java</a>ï¼‰ã€‚é€šè¿‡åˆ†æ gRPC çš„é€šä¿¡è¿‡ç¨‹ï¼Œæˆ‘ä»¬å¯ä»¥æ¸…æ¥šåœ°çŸ¥é“åœ¨ gRPC é‡Œé¢è¿™äº›çŸ¥è¯†ç‚¹æ˜¯æ€ä¹ˆè½åœ°åˆ°å…·ä½“ä»£ç ä¸Šçš„ã€‚</p><p>gRPC æ˜¯ç”± Google å¼€å‘å¹¶ä¸”å¼€æºçš„ä¸€æ¬¾é«˜æ€§èƒ½ã€è·¨è¯­è¨€çš„ RPC æ¡†æ¶ï¼Œå½“å‰æ”¯æŒ Cã€Java å’Œ Go ç­‰è¯­è¨€ï¼Œå½“å‰ Java ç‰ˆæœ¬æœ€æ–° Release ç‰ˆä¸º 1.27.0ã€‚gRPC æœ‰å¾ˆå¤šç‰¹ç‚¹ï¼Œæ¯”å¦‚è·¨è¯­è¨€ï¼Œé€šä¿¡åè®®æ˜¯åŸºäºæ ‡å‡†çš„ HTTP/2 è®¾è®¡çš„ï¼Œåºåˆ—åŒ–æ”¯æŒ PBï¼ˆProtocol Bufferï¼‰å’Œ JSONï¼Œæ•´ä¸ªè°ƒç”¨ç¤ºä¾‹å¦‚ä¸‹å›¾æ‰€ç¤ºï¼š</p><p><img src=\"https://static001.geekbang.org/resource/image/86/0d/8671942cd89feea3a2544d3530da450d.jpg?wh=3183*1769\" alt=\"\" title=\"gRPCè°ƒç”¨ç¤ºä¾‹å›¾\"></p><p>å¦‚æœä½ æƒ³å¿«é€Ÿåœ°äº†è§£ä¸€ä¸ªå…¨æ–°æ¡†æ¶çš„å·¥ä½œåŸç†ï¼Œæˆ‘ä¸ªäººè®¤ä¸ºæœ€å¿«çš„æ–¹å¼å°±æ˜¯ä»ä½¿ç”¨ç¤ºä¾‹å¼€å§‹ï¼Œæ‰€ä»¥ç°åœ¨æˆ‘ä»¬å°±ä»¥æœ€ç®€å•çš„ HelloWord ä¸ºä¾‹å¼€å§‹äº†è§£ã€‚</p><p>åœ¨è¿™ä¸ªä¾‹å­é‡Œé¢ï¼Œæˆ‘ä»¬ä¼šå®šä¹‰ä¸€ä¸ª say æ–¹æ³•ï¼Œè°ƒç”¨æ–¹é€šè¿‡ gRPC è°ƒç”¨æœåŠ¡æä¾›æ–¹ï¼Œç„¶åæœåŠ¡æä¾›æ–¹ä¼šè¿”å›ä¸€ä¸ªå­—ç¬¦ä¸²ç»™è°ƒç”¨æ–¹ã€‚</p><!-- [[[read_end]]] --><p>ä¸ºäº†ä¿è¯è°ƒç”¨æ–¹å’ŒæœåŠ¡æä¾›æ–¹èƒ½å¤Ÿæ­£å¸¸é€šä¿¡ï¼Œæˆ‘ä»¬éœ€è¦å…ˆçº¦å®šä¸€ä¸ªé€šä¿¡è¿‡ç¨‹ä¸­çš„å¥‘çº¦ï¼Œä¹Ÿå°±æ˜¯æˆ‘ä»¬åœ¨ Java  é‡Œé¢è¯´çš„å®šä¹‰ä¸€ä¸ªæ¥å£ï¼Œè¿™ä¸ªæ¥å£é‡Œé¢åªä¼šåŒ…å«ä¸€ä¸ª say æ–¹æ³•ã€‚åœ¨ gRPC é‡Œé¢å®šä¹‰æ¥å£æ˜¯é€šè¿‡å†™ Protocol Buffer ä»£ç ï¼Œä»è€ŒæŠŠæ¥å£çš„å®šä¹‰ä¿¡æ¯é€šè¿‡ Protocol Buffer è¯­ä¹‰è¡¨è¾¾å‡ºæ¥ã€‚HelloWord çš„ Protocol Buffer ä»£ç å¦‚ä¸‹æ‰€ç¤ºï¼š</p><pre><code>syntax = &quot;proto3&quot;;\n\noption java_multiple_files = true;\noption java_package = &quot;io.grpc.hello&quot;;\noption java_outer_classname = &quot;HelloProto&quot;;\noption objc_class_prefix = &quot;HLW&quot;;\n\npackage hello;\n\nservice HelloService{\nrpc Say(HelloRequest) returns (HelloReply) {}\n}\n\nmessage HelloRequest {\nstring name = 1;\n}\n\nmessage HelloReply {\nstring message = 1;\n}\n</code></pre><p>æœ‰äº†è¿™æ®µä»£ç ï¼Œæˆ‘ä»¬å°±å¯ä»¥ä¸ºå®¢æˆ·ç«¯å’ŒæœåŠ¡å™¨ç«¯ç”Ÿæˆæ¶ˆæ¯å¯¹è±¡å’Œ RPC åŸºç¡€ä»£ç ã€‚æˆ‘ä»¬å¯ä»¥åˆ©ç”¨ Protocol Buffer çš„ç¼–è¯‘å™¨ protocï¼Œå†é…åˆ gRPC Java æ’ä»¶ï¼ˆprotoc-gen-grpc-javaï¼‰ï¼Œé€šè¿‡å‘½ä»¤è¡Œ protoc3 åŠ ä¸Š plugin å’Œ proto ç›®å½•åœ°å€å‚æ•°ï¼Œæˆ‘ä»¬å°±å¯ä»¥ç”Ÿæˆæ¶ˆæ¯å¯¹è±¡å’Œ gRPC é€šä¿¡æ‰€éœ€è¦çš„åŸºç¡€ä»£ç ã€‚å¦‚æœä½ çš„é¡¹ç›®æ˜¯ Maven å·¥ç¨‹çš„è¯ï¼Œä½ è¿˜å¯ä»¥ç›´æ¥é€‰æ‹©ä½¿ç”¨ Maven  æ’ä»¶æ¥ç”ŸæˆåŒæ ·çš„ä»£ç ã€‚</p><h2>å‘é€åŸç†</h2><p>ç”Ÿæˆå®ŒåŸºç¡€ä»£ç ä»¥åï¼Œæˆ‘ä»¬å°±å¯ä»¥åŸºäºç”Ÿæˆçš„ä»£ç å†™ä¸‹è°ƒç”¨ç«¯ä»£ç ï¼Œå…·ä½“å¦‚ä¸‹ï¼š</p><pre><code>package io.grpc.hello;\n\nimport io.grpc.ManagedChannel;\nimport io.grpc.ManagedChannelBuilder;\nimport io.grpc.StatusRuntimeException;\n\n\nimport java.util.concurrent.TimeUnit;\n\npublic class HelloWorldClient {\n\n    private final ManagedChannel channel;\n    private final HelloServiceGrpc.HelloServiceBlockingStub blockingStub;\n    /**\n    * æ„å»ºChannelè¿æ¥\n    **/\n    public HelloWorldClient(String host, int port) {\n        this(ManagedChannelBuilder.forAddress(host, port)\n                .usePlaintext()\n                .build());\n    }\n\n    /**\n    * æ„å»ºStubç”¨äºå‘è¯·æ±‚\n    **/\n    HelloWorldClient(ManagedChannel channel) {\n        this.channel = channel;\n        blockingStub = HelloServiceGrpc.newBlockingStub(channel);\n    }\n    \n    /**\n    * è°ƒç”¨å®Œæ‰‹åŠ¨å…³é—­\n    **/\n    public void shutdown() throws InterruptedException {\n        channel.shutdown().awaitTermination(5, TimeUnit.SECONDS);\n    }\n\n \n    /**\n    * å‘é€rpcè¯·æ±‚\n    **/\n    public void say(String name) {\n        // æ„å»ºå…¥å‚å¯¹è±¡\n        HelloRequest request = HelloRequest.newBuilder().setName(name).build();\n        HelloReply response;\n        try {\n            // å‘é€è¯·æ±‚\n            response = blockingStub.say(request);\n        } catch (StatusRuntimeException e) {\n            return;\n        }\n        System.out.println(response);\n    }\n\n    public static void main(String[] args) throws Exception {\n            HelloWorldClient client = new HelloWorldClient(&quot;127.0.0.1&quot;, 50051);\n            try {\n                client.say(&quot;world&quot;);\n            } finally {\n                client.shutdown();\n            }\n    }\n}\n</code></pre><p><strong>è°ƒç”¨ç«¯ä»£ç å¤§è‡´åˆ†æˆä¸‰ä¸ªæ­¥éª¤ï¼š</strong></p><ul>\n<li>é¦–å…ˆç”¨ host å’Œ port ç”Ÿæˆ channel è¿æ¥ï¼›</li>\n<li>ç„¶åç”¨å‰é¢ç”Ÿæˆçš„ HelloService gRPC åˆ›å»º Stub ç±»ï¼›</li>\n<li>æœ€åæˆ‘ä»¬å¯ä»¥ç”¨ç”Ÿæˆçš„è¿™ä¸ª Stub è°ƒç”¨ say æ–¹æ³•å‘èµ·çœŸæ­£çš„ RPC è°ƒç”¨ï¼Œåç»­å…¶å®ƒçš„ RPC é€šä¿¡ç»†èŠ‚å°±å¯¹æˆ‘ä»¬ä½¿ç”¨è€…é€æ˜äº†ã€‚</li>\n</ul><p>ä¸ºäº†èƒ½çœ‹æ¸…æ¥šé‡Œé¢å…·ä½“å‘ç”Ÿäº†ä»€ä¹ˆï¼Œæˆ‘ä»¬éœ€è¦è¿›å…¥åˆ° ClientCalls.blockingUnaryCall æ–¹æ³•é‡Œé¢çœ‹ä¸‹é€»è¾‘ç»†èŠ‚ã€‚ä½†æ˜¯ä¸ºäº†é¿å…å¤ªå¤šçš„ç»†èŠ‚å½±å“ä½ ç†è§£æ•´ä½“æµç¨‹ï¼Œæˆ‘åœ¨ä¸‹é¢è¿™å¼ å›¾ä¸­åªç”»ä¸‹äº†æœ€é‡è¦çš„éƒ¨åˆ†ã€‚</p><p><img src=\"https://static001.geekbang.org/resource/image/57/5d/57c7d1c005c1d426ccee48a84e286b5d.jpg?wh=5429*1517\" alt=\"\" title=\"æ•´ä½“æµç¨‹å›¾\"></p><p>æˆ‘ä»¬å¯ä»¥çœ‹åˆ°ï¼Œåœ¨è°ƒç”¨ç«¯ä»£ç é‡Œé¢ï¼Œæˆ‘ä»¬åªéœ€è¦ä¸€è¡Œï¼ˆç¬¬48è¡Œï¼‰ä»£ç å°±å¯ä»¥å‘èµ·ä¸€ä¸ª RPC è°ƒç”¨ï¼Œè€Œå…·ä½“è¿™ä¸ªè¯·æ±‚æ˜¯æ€ä¹ˆå‘é€åˆ°æœåŠ¡æä¾›è€…é‚£ç«¯çš„å‘¢ï¼Ÿè¿™å¯¹äºæˆ‘ä»¬ gRPC ä½¿ç”¨è€…æ¥è¯´æ˜¯å®Œå…¨é€æ˜çš„ï¼Œæˆ‘ä»¬åªè¦å…³æ³¨æ˜¯æ€ä¹ˆåˆ›å»ºå‡º stub å¯¹è±¡çš„å°±å¯ä»¥äº†ã€‚</p><p>æ¯”å¦‚å…¥å‚æ˜¯ä¸€ä¸ªå­—ç¬¦å¯¹è±¡ï¼ŒgRPC æ˜¯æ€ä¹ˆæŠŠè¿™ä¸ªå¯¹è±¡ä¼ è¾“åˆ°æœåŠ¡æä¾›æ–¹çš„å‘¢ï¼Ÿå› ä¸ºåœ¨<a href=\"https://time.geekbang.org/column/article/202779\">[ç¬¬ 03 è®²]</a> ä¸­æˆ‘ä»¬è¯´è¿‡ï¼Œåªæœ‰äºŒè¿›åˆ¶æ‰èƒ½åœ¨ç½‘ç»œä¸­ä¼ è¾“ï¼Œä½†æ˜¯ç›®å‰è°ƒç”¨ç«¯ä»£ç çš„å…¥å‚æ˜¯ä¸€ä¸ªå­—ç¬¦å¯¹è±¡ï¼Œé‚£åœ¨ gRPC é‡Œé¢æˆ‘ä»¬æ˜¯æ€ä¹ˆæŠŠå¯¹è±¡è½¬æˆäºŒè¿›åˆ¶æ•°æ®çš„å‘¢ï¼Ÿ</p><p>å›åˆ°ä¸Šé¢æµç¨‹å›¾çš„ç¬¬3æ­¥ï¼Œåœ¨ writePayload ä¹‹å‰ï¼ŒClientCallImpl é‡Œé¢æœ‰ä¸€è¡Œä»£ç å°±æ˜¯ method.streamRequest(message)ï¼Œçœ‹æ–¹æ³•ç­¾åæˆ‘ä»¬å¤§æ¦‚å°±çŸ¥é“å®ƒæ˜¯ç”¨æ¥æŠŠå¯¹è±¡è½¬æˆä¸€ä¸ª InputStreamï¼Œæœ‰äº† InputStream æˆ‘ä»¬å°±å¾ˆå®¹æ˜“è·å¾—å…¥å‚å¯¹è±¡çš„äºŒè¿›åˆ¶æ•°æ®ã€‚è¿™ä¸ªæ–¹æ³•è¿”å›å€¼å¾ˆæœ‰æ„æ€ï¼Œå°±æ˜¯ä¸ºå•¥ä¸ç›´æ¥è¿”å›æˆ‘ä»¬æƒ³è¦çš„äºŒè¿›åˆ¶æ•°ç»„ï¼Œè€Œæ˜¯è¿”å›ä¸€ä¸ª InputStream å¯¹è±¡å‘¢ï¼Ÿä½ å¯ä»¥å…ˆåœä¸‹æ¥æƒ³ä¸‹åŸå› ï¼Œæˆ‘ä»¬ä¼šåœ¨æœ€åç»§ç»­è®¨è®ºè¿™ä¸ªé—®é¢˜ã€‚</p><p>æˆ‘ä»¬æ¥ç€çœ‹ streamRequest æ–¹æ³•çš„æ‹¥æœ‰è€… method æ˜¯ä¸ªä»€ä¹ˆå¯¹è±¡ï¼Ÿæˆ‘ä»¬å¯ä»¥çœ‹åˆ° method æ˜¯ MethodDescriptor å¯¹è±¡å…³è”çš„ä¸€ä¸ªå®ä¾‹ï¼Œè€Œ MethodDescriptor æ˜¯ç”¨æ¥å­˜æ”¾è¦è°ƒç”¨ RPC æœåŠ¡çš„æ¥å£åã€æ–¹æ³•åã€æœåŠ¡è°ƒç”¨çš„æ–¹å¼ä»¥åŠè¯·æ±‚å’Œå“åº”çš„åºåˆ—åŒ–å’Œååºåˆ—åŒ–å®ç°ç±»ã€‚</p><p>å¤§ç™½è¯è¯´å°±æ˜¯ï¼ŒMethodDescriptor æ˜¯ç”¨æ¥å­˜å‚¨ä¸€äº› RPC è°ƒç”¨è¿‡ç¨‹ä¸­çš„å…ƒæ•°æ®ï¼Œè€Œåœ¨ MethodDescriptor é‡Œé¢ requestMarshaller æ˜¯åœ¨ç»‘å®šè¯·æ±‚çš„æ—¶å€™ç”¨æ¥åºåˆ—åŒ–æ–¹å¼å¯¹è±¡çš„ï¼Œæ‰€ä»¥å½“æˆ‘ä»¬è°ƒç”¨ method.streamRequest(message) çš„æ—¶å€™ï¼Œå®é™…æ˜¯è°ƒç”¨ requestMarshaller.stream(requestMessage) æ–¹æ³•ï¼Œè€Œ requestMarshaller é‡Œé¢ä¼šç»‘å®šä¸€ä¸ª Parserï¼Œè¿™ä¸ª Parser æ‰çœŸæ­£åœ°æŠŠå¯¹è±¡è½¬æˆäº† InputStream å¯¹è±¡ã€‚</p><p>è®²å®Œåºåˆ—åŒ–åœ¨ gRPC é‡Œé¢çš„åº”ç”¨åï¼Œæˆ‘ä»¬å†æ¥çœ‹ä¸‹åœ¨ gRPC é‡Œé¢æ˜¯æ€ä¹ˆå®Œæˆè¯·æ±‚æ•°æ®â€œæ–­å¥â€çš„ï¼Œå°±æ˜¯æˆ‘ä»¬åœ¨<a href=\"https://time.geekbang.org/column/article/199651\">[ç¬¬ 02 è®²]</a> ä¸­è¯´çš„é‚£ä¸ªé—®é¢˜â€”â€”äºŒè¿›åˆ¶æµç»è¿‡ç½‘ç»œä¼ è¾“åï¼Œæ€ä¹ˆæ­£ç¡®åœ°è¿˜åŸè¯·æ±‚å‰è¯­ä¹‰ï¼Ÿ</p><p>æˆ‘ä»¬åœ¨ gRPC æ–‡æ¡£ä¸­å¯ä»¥çœ‹åˆ°ï¼ŒgRPC çš„é€šä¿¡åè®®æ˜¯åŸºäºæ ‡å‡†çš„ HTTP/2 è®¾è®¡çš„ï¼Œè€Œ HTTP/2 ç›¸å¯¹äºå¸¸ç”¨çš„ HTTP/1.X æ¥è¯´ï¼Œå®ƒæœ€å¤§çš„ç‰¹ç‚¹å°±æ˜¯å¤šè·¯å¤ç”¨ã€åŒå‘æµï¼Œè¯¥æ€ä¹ˆç†è§£è¿™ä¸ªç‰¹ç‚¹å‘¢ï¼Ÿè¿™å°±å¥½æ¯”æˆ‘ä»¬ç”Ÿæ´»ä¸­çš„å•è¡Œé“å’ŒåŒè¡Œé“ï¼ŒHTTP/1.X å°±æ˜¯å•è¡Œé“ï¼ŒHTTP/2 å°±æ˜¯åŒè¡Œé“ã€‚</p><p>é‚£æ—¢ç„¶åœ¨è¯·æ±‚æ”¶åˆ°åéœ€è¦è¿›è¡Œè¯·æ±‚â€œæ–­å¥â€ï¼Œé‚£è‚¯å®šå°±éœ€è¦åœ¨å‘é€çš„æ—¶å€™æŠŠæ–­å¥çš„ç¬¦å·åŠ ä¸Šï¼Œæˆ‘ä»¬çœ‹ä¸‹åœ¨ gRPC é‡Œé¢æ˜¯æ€ä¹ˆåŠ çš„ï¼Ÿ</p><p>å› ä¸º gRPC æ˜¯åŸºäº HTTP/2 åè®®ï¼Œè€Œ HTTP/2 ä¼ è¾“åŸºæœ¬å•ä½æ˜¯ Frameï¼ŒFrame æ ¼å¼æ˜¯ä»¥å›ºå®š 9 å­—èŠ‚é•¿åº¦çš„ headerï¼Œåé¢åŠ ä¸Šä¸å®šé•¿çš„ payload ç»„æˆï¼Œåè®®æ ¼å¼å¦‚ä¸‹å›¾æ‰€ç¤ºï¼š</p><p><img src=\"https://static001.geekbang.org/resource/image/d5/75/d5554644aefe5aaab42718d75a47de75.jpg?wh=3796*1143\" alt=\"\"></p><p>é‚£åœ¨ gRPC é‡Œé¢å°±å˜æˆæ€ä¹ˆæ„é€ ä¸€ä¸ª HTTP/2 çš„ Frame äº†ã€‚</p><p>ç°åœ¨å›çœ‹æˆ‘ä»¬ä¸Šé¢é‚£ä¸ªæµç¨‹å›¾çš„ç¬¬ 4 æ­¥ï¼Œåœ¨ write åˆ° Netty é‡Œé¢ä¹‹å‰ï¼Œæˆ‘ä»¬çœ‹åˆ°åœ¨ MessageFramer.writePayload æ–¹æ³•é‡Œé¢ä¼šé—´æ¥è°ƒç”¨ writeKnownLengthUncompressed æ–¹æ³•ï¼Œè¯¥æ–¹æ³•è¦åšçš„ä¸¤ä»¶äº‹æƒ…å°±æ˜¯æ„é€  Frame Header å’Œ Frame Bodyï¼Œç„¶åå†æŠŠæ„é€ çš„ Frame å‘é€åˆ° NettyClientHandlerï¼Œæœ€åå°† Frame å†™å…¥åˆ° HTTP/2 Stream ä¸­ï¼Œå®Œæˆè¯·æ±‚æ¶ˆæ¯çš„å‘é€ã€‚</p><h2>æ¥æ”¶åŸç†</h2><p>è®²å®Œ gRPC çš„è¯·æ±‚å‘é€åŸç†ï¼Œæˆ‘ä»¬å†æ¥çœ‹ä¸‹æœåŠ¡æä¾›æ–¹æ”¶åˆ°è¯·æ±‚åä¼šæ€ä¹ˆå¤„ç†ï¼Ÿæˆ‘ä»¬è¿˜æ˜¯æ¥ç€å‰é¢çš„é‚£ä¸ªä¾‹å­ï¼Œå…ˆçœ‹ä¸‹æœåŠ¡æä¾›æ–¹ä»£ç ï¼Œå…·ä½“å¦‚ä¸‹ï¼š</p><pre><code>static class HelloServiceImpl extends HelloServiceGrpc.HelloServiceImplBase {\n\n  @Override\n  public void say(HelloRequest req, StreamObserver&lt;HelloReply&gt; responseObserver) {\n    HelloReply reply = HelloReply.newBuilder().setMessage(&quot;Hello &quot; + req.getName()).build();\n    responseObserver.onNext(reply);\n    responseObserver.onCompleted();\n  }\n}\n</code></pre><p>ä¸Šé¢ HelloServiceImpl ç±»æ˜¯æŒ‰ç…§ gRPC ä½¿ç”¨æ–¹å¼å®ç°äº† HelloService æ¥å£é€»è¾‘ï¼Œä½†æ˜¯å¯¹äºè°ƒç”¨è€…æ¥è¯´å¹¶ä¸èƒ½æŠŠå®ƒè°ƒç”¨è¿‡æ¥ï¼Œå› ä¸ºæˆ‘ä»¬æ²¡æœ‰æŠŠè¿™ä¸ªæ¥å£å¯¹å¤–æš´éœ²ï¼Œåœ¨ gRPC é‡Œé¢æˆ‘ä»¬æ˜¯é‡‡ç”¨ Build æ¨¡å¼å¯¹åº•å±‚æœåŠ¡è¿›è¡Œç»‘å®šï¼Œå…·ä½“ä»£ç å¦‚ä¸‹ï¼š</p><pre><code>package io.grpc.hello;\n\nimport io.grpc.Server;\nimport io.grpc.ServerBuilder;\nimport io.grpc.stub.StreamObserver;\n\nimport java.io.IOException;\n\n\npublic class HelloWorldServer {\n\n  private Server server;\n\n  /**\n  * å¯¹å¤–æš´éœ²æœåŠ¡\n  **/\n  private void start() throws IOException {\n    int port = 50051;\n    server = ServerBuilder.forPort(port)\n        .addService(new HelloServiceImpl())\n        .build()\n        .start();\n    Runtime.getRuntime().addShutdownHook(new Thread() {\n      @Override\n      public void run() {\n        HelloWorldServer.this.stop();\n      }\n    });\n  }\n\n  /**\n  * å…³é—­ç«¯å£\n  **/\n  private void stop() {\n    if (server != null) {\n      server.shutdown();\n    }\n  }\n\n  /**\n  * ä¼˜é›…å…³é—­\n  **/\n  private void blockUntilShutdown() throws InterruptedException {\n    if (server != null) {\n      server.awaitTermination();\n    }\n  }\n\n\n  public static void main(String[] args) throws IOException, InterruptedException {\n    final HelloWorldServer server = new HelloWorldServer();\n    server.start();\n    server.blockUntilShutdown();\n  }\n  \n}\n</code></pre><p>æœåŠ¡å¯¹å¤–æš´éœ²çš„ç›®çš„æ˜¯è®©è¿‡æ¥çš„è¯·æ±‚åœ¨è¢«è¿˜åŸæˆä¿¡æ¯åï¼Œèƒ½æ‰¾åˆ°å¯¹åº”æ¥å£çš„å®ç°ã€‚åœ¨è¿™ä¹‹å‰ï¼Œæˆ‘ä»¬éœ€è¦å…ˆä¿è¯èƒ½æ­£å¸¸æ¥æ”¶è¯·æ±‚ï¼Œé€šä¿—åœ°è®²å°±æ˜¯è¦å…ˆå¼€å¯ä¸€ä¸ª TCP ç«¯å£ï¼Œè®©è°ƒç”¨æ–¹å¯ä»¥å»ºç«‹è¿æ¥ï¼Œå¹¶æŠŠäºŒè¿›åˆ¶æ•°æ®å‘é€åˆ°è¿™ä¸ªè¿æ¥é€šé“é‡Œé¢ï¼Œè¿™é‡Œä¾ç„¶åªå±•ç¤ºæœ€é‡è¦çš„éƒ¨åˆ†ã€‚</p><p><img src=\"https://static001.geekbang.org/resource/image/b4/cd/b43a3fb6d6929bb862893aebd7cd40cd.jpg?wh=4614*1541\" alt=\"\"></p><p>è¿™å››ä¸ªæ­¥éª¤æ˜¯ç”¨æ¥å¼€å¯ä¸€ä¸ª Netty Serverï¼Œå¹¶ç»‘å®šç¼–è§£ç é€»è¾‘çš„ï¼Œå¦‚æœä½ æš‚æ—¶çœ‹ä¸æ‡‚ï¼Œæ²¡å…³ç³»çš„ï¼Œæˆ‘ä»¬å¯ä»¥å…ˆå¿½ç•¥ç»†èŠ‚ã€‚æˆ‘ä»¬é‡ç‚¹çœ‹ä¸‹ NettyServerHandler å°±è¡Œäº†ï¼Œåœ¨è¿™ä¸ª Handler  é‡Œé¢ä¼šç»‘å®šä¸€ä¸ª FrameListenerï¼ŒgRPC ä¼šåœ¨è¿™ä¸ª Listener é‡Œé¢å¤„ç†æ”¶åˆ°æ•°æ®è¯·æ±‚çš„ Header å’Œ Bodyï¼Œå¹¶ä¸”ä¹Ÿä¼šå¤„ç† Pingã€RST å‘½ä»¤ç­‰ï¼Œå…·ä½“æµç¨‹å¦‚ä¸‹å›¾æ‰€ç¤ºï¼š</p><p><img src=\"https://static001.geekbang.org/resource/image/98/f5/98d0ecec8e2c9b75159e86253c6c3cf5.jpg?wh=4606*1527\" alt=\"\"></p><p>åœ¨æ”¶åˆ° Header æˆ–è€… Body äºŒè¿›åˆ¶æ•°æ®åï¼ŒNettyServerHandler ä¸Šç»‘å®šçš„FrameListener ä¼šæŠŠè¿™äº›äºŒè¿›åˆ¶æ•°æ®è½¬åˆ° MessageDeframer é‡Œé¢ï¼Œä»è€Œå®ç° gRPC åè®®æ¶ˆæ¯çš„è§£æ ã€‚</p><p>é‚£ä½ å¯èƒ½ä¼šé—®ï¼Œè¿™äº› Header å’Œ Body æ•°æ®æ˜¯æ€ä¹ˆåˆ†ç¦»å‡ºæ¥çš„å‘¢ï¼ŸæŒ‰ç…§æˆ‘ä»¬å‰é¢è¯´çš„ï¼Œè°ƒç”¨æ–¹å‘è¿‡æ¥çš„æ˜¯ä¸€ä¸²äºŒè¿›åˆ¶æ•°æ®ï¼Œè¿™å°±æ˜¯æˆ‘ä»¬å‰é¢å¼€å¯ Netty Server çš„æ—¶å€™ç»‘å®š Default HTTP/2FrameReader çš„ä½œç”¨ï¼Œå®ƒèƒ½å¸®åŠ©æˆ‘ä»¬æŒ‰ç…§ HTTP/2 åè®®çš„æ ¼å¼è‡ªåŠ¨åˆ‡åˆ†å‡º Header å’Œ Body æ•°æ®æ¥ï¼Œè€Œå¯¹æˆ‘ä»¬ä¸Šå±‚åº”ç”¨ gRPC  æ¥è¯´ï¼Œå®ƒå¯ä»¥ç›´æ¥æ‹¿æ‹†åˆ†åçš„æ•°æ®æ¥ç”¨ã€‚</p><h2>æ€»ç»“</h2><p>è¿™æ˜¯æˆ‘ä»¬åŸºç¡€ç¯‡çš„æœ€åä¸€è®²ï¼Œæˆ‘ä»¬é‡‡ç”¨å‰–æ gRPC æºç çš„æ–¹å¼æ¥å­¦ä¹ å¦‚ä½•å®ç°ä¸€ä¸ªå®Œæ•´çš„ RPCã€‚å½“ç„¶æ•´ä¸ª gRPC çš„ä»£ç é‡å¯æ¯”è¿™å¤šå¾—å¤šï¼Œä½†ä»Šå¤©çš„ä¸»è¦ç›®å°±æ˜¯æƒ³è®©ä½ æŠŠå‰é¢æ‰€å­¦çš„åºåˆ—åŒ–ã€åè®®ç­‰æ–¹é¢çš„çŸ¥è¯†è½å®åˆ°å…·ä½“ä»£ç ä¸Šï¼Œæ‰€ä»¥æˆ‘ä»¬è¿™å„¿åªåˆ†æäº† gRPC æ”¶å‘è¯·æ±‚ä¸¤ä¸ªè¿‡ç¨‹ã€‚</p><p>å®ç°äº†è¿™ä¸¤ä¸ªè¿‡ç¨‹ï¼Œæˆ‘ä»¬å°±å¯ä»¥å®Œæˆä¸€ä¸ªç‚¹å¯¹ç‚¹çš„ RPC åŠŸèƒ½ï¼Œä½†åœ¨å®é™…ä½¿ç”¨çš„æ—¶å€™ï¼Œæˆ‘ä»¬çš„æœåŠ¡æä¾›æ–¹é€šå¸¸éƒ½æ˜¯ä»¥ä¸€ä¸ªé›†ç¾¤çš„æ–¹å¼å¯¹å¤–æä¾›æœåŠ¡çš„ï¼Œæ‰€ä»¥åœ¨ gRPC é‡Œé¢ä½ è¿˜å¯ä»¥çœ‹åˆ°è´Ÿè½½å‡è¡¡ã€æœåŠ¡å‘ç°ç­‰åŠŸèƒ½ã€‚è€Œä¸” gRPC é‡‡ç”¨çš„æ˜¯ HTTP/2 åè®®ï¼Œæˆ‘ä»¬è¿˜å¯ä»¥é€šè¿‡ Stream æ–¹å¼æ¥è°ƒç”¨æœåŠ¡ï¼Œä»¥æå‡è°ƒç”¨æ€§èƒ½ã€‚</p><p>æ€»çš„æ¥è¯´ï¼Œå…¶å®æˆ‘ä»¬å¯ä»¥ç®€å•åœ°è®¤ä¸º<strong>gRPC å°±æ˜¯é‡‡ç”¨ HTTP/2 åè®®ï¼Œå¹¶ä¸”é»˜è®¤é‡‡ç”¨ PB åºåˆ—åŒ–æ–¹å¼çš„ä¸€ç§ RPC</strong>ï¼Œå®ƒå……åˆ†åˆ©ç”¨äº† HTTP/2 çš„å¤šè·¯å¤ç”¨ç‰¹æ€§ï¼Œä½¿å¾—æˆ‘ä»¬å¯ä»¥åœ¨åŒä¸€æ¡é“¾è·¯ä¸ŠåŒå‘å‘é€ä¸åŒçš„ Stream æ•°æ®ï¼Œä»¥è§£å†³ HTTP/1.X å­˜åœ¨çš„æ€§èƒ½é—®é¢˜ã€‚</p><h2>è¯¾åæ€è€ƒ</h2><p>æˆ‘ä»¬è®²åˆ°ï¼Œåœ¨ gRPC è°ƒç”¨çš„æ—¶å€™ï¼Œæˆ‘ä»¬æœ‰ä¸€ä¸ªå…³é”®æ­¥éª¤å°±æ˜¯æŠŠå¯¹è±¡è½¬æˆå¯ä¼ è¾“çš„äºŒè¿›åˆ¶ï¼Œä½†æ˜¯åœ¨ gRPC é‡Œé¢ï¼Œæˆ‘ä»¬å¹¶æ²¡æœ‰ç›´æ¥è½¬æˆäºŒè¿›åˆ¶æ•°ç»„ï¼Œè€Œæ˜¯è¿”å›ä¸€ä¸ª InputStreamï¼Œä½ çŸ¥é“è¿™æ ·åšçš„å¥½å¤„æ˜¯ä»€ä¹ˆå—ï¼Ÿ</p><p>æ¬¢è¿ç•™è¨€å’Œæˆ‘åˆ†äº«ä½ çš„ç­”æ¡ˆï¼Œä¹Ÿæ¬¢è¿ä½ æŠŠæ–‡ç« åˆ†äº«ç»™ä½ çš„æœ‹å‹ï¼Œé‚€è¯·ä»–åŠ å…¥å­¦ä¹ ã€‚æˆ‘ä»¬ä¸‹èŠ‚è¯¾å†è§ï¼</p>","neighbors":{"left":{"article_title":"05 | åŠ¨æ€ä»£ç†ï¼šé¢å‘æ¥å£ç¼–ç¨‹ï¼Œå±è”½RPCå¤„ç†æµç¨‹","id":205910},"right":{"article_title":"07 | æ¶æ„è®¾è®¡ï¼šè®¾è®¡ä¸€ä¸ªçµæ´»çš„RPCæ¡†æ¶","id":207137}},"comments":[{"had_liked":false,"id":183982,"user_name":"é›¨éœ–é“ƒå£°å£°æ…¢","can_delete":false,"product_type":"c1","uid":1052607,"ip_address":"","ucode":"656D98310C6DA3","user_header":"https://static001.geekbang.org/account/avatar/00/10/0f/bf/ee93c4cf.jpg","comment_is_top":false,"comment_ctime":1583196662,"is_pvip":false,"replies":[{"id":"71620","content":"æ²¡é”™ï¼Œé¿å…äºŒæ¬¡æ‹·è´","user_name":"ä½œè€…å›å¤","comment_id":183982,"uid":"1541007","ip_address":"","utype":1,"ctime":1583621635,"user_name_real":"ä½•å°é”‹"}],"discussion_count":4,"race_medal":0,"score":"280756070902","product_id":100046201,"comment_content":"InputStreamå°è£…äº†åº•å±‚ä¼ è¾“çš„å­—èŠ‚ç¼“å†²åŒºå®ç°ï¼Œå®ƒé€šå¸¸æ˜¯ä¸€ç»„é€šè¿‡æŒ‡é’ˆè¿æ¥èµ·æ¥çš„å†…å­˜å—çš„é›†åˆï¼Œè¿™äº›å†…å­˜å—ç”±ç½‘ç»œçš„é›¶æ‹·è´è·å–çš„ã€‚ç”±äºä¸èƒ½ä¿è¯èƒ½å¤Ÿä»å†…å­˜å—ä¸­è·å–ä¸€ä¸ªbyte[]ï¼Œæˆ‘ä»¬ä¸èƒ½ä¼ é€’ä¸€ä¸ªç®€å•çš„byte[]æˆ–byte[][]ï¼Œå¹¶ä¸”å¯èƒ½éœ€è¦ä¸€ä¸ªç›®æ ‡byte[]æ¥ä»ç¼“å†²åŒºä¸­è·å–æ•°æ®ã€‚<br>å¦å¤–byte[]çš„ç¼ºç‚¹æ˜¯éœ€è¦ä»ç¼“å†²åŒºä¸­å¤åˆ¶ä¸€ä¸ªå¤§çš„ã€è¿ç»­çš„æ•°æ®ï¼Œè€Œå®é™…ä¸Šæ²¡æœ‰ä»€ä¹ˆæ–¹æ³•å¯ä»¥ä½¿å®ƒæ‰§è¡Œå¾—æ›´å¥½ã€‚å½“ä½¿ç”¨å‹ç¼©æ—¶ï¼Œæˆ‘ä»¬ä¹Ÿä¸çŸ¥é“æ¶ˆæ¯æœªå‹ç¼©çš„é•¿åº¦ï¼Œå®ƒæ˜¯åŠ¨æ€è§£å‹ç¼©çš„ã€‚","like_count":66,"discussions":[{"author":{"id":1541007,"avatar":"https://static001.geekbang.org/account/avatar/00/17/83/8f/8471d633.jpg","nickname":"ä½•å°é”‹","note":"","ucode":"E9B3B4A1B75D8B","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":485839,"discussion_content":"æ²¡é”™ï¼Œé¿å…äºŒæ¬¡æ‹·è´","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1583621635,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":2524569,"avatar":"https://static001.geekbang.org/account/avatar/00/26/85/99/171b34d2.jpg","nickname":"Zmha_","note":"","ucode":"6DCF245FF797F8","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":375315,"discussion_content":"åº”è¯¥æ˜¯è‹±æ–‡ç¿»è¯‘çš„â€¦â€¦","likes_number":1,"is_delete":false,"is_hidden":false,"ctime":1621572731,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1181650,"avatar":"https://static001.geekbang.org/account/avatar/00/12/07/d2/0d7ee298.jpg","nickname":"æƒ˜ é—»","note":"","ucode":"C5909F034BF072","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":347101,"discussion_content":"ä»€ä¹ˆæ˜¯æ²¡æœ‰åŠæ³•ä½¿å®ƒæ‰§è¡Œçš„æ›´å¥½ã€‚ã€‚ã€‚æ²¡çœ‹æ‡‚è¿™æ˜¯è‹±æ–‡ç¿»è¯‘è¿‡æ¥çš„å—","likes_number":1,"is_delete":false,"is_hidden":false,"ctime":1612151738,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":2718510,"avatar":"","nickname":"jack123","note":"","ucode":"873D0046EF39D6","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":401400,"discussion_content":"ç±»ä¼¼äºä¼ æŒ‡é’ˆå’Œä¼ å€¼çš„åŒºåˆ«","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1633658820,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":199272,"user_name":"tulip","can_delete":false,"product_type":"c1","uid":1739012,"ip_address":"","ucode":"44BB22410A848D","user_header":"https://static001.geekbang.org/account/avatar/00/1a/89/04/c1474869.jpg","comment_is_top":false,"comment_ctime":1585485499,"is_pvip":true,"discussion_count":2,"race_medal":0,"score":"117549602491","product_id":100046201,"comment_content":"è€å¸ˆå¯ä»¥å‡ºä¸€æœŸgo çš„å˜›","like_count":27,"discussions":[{"author":{"id":1739012,"avatar":"https://static001.geekbang.org/account/avatar/00/1a/89/04/c1474869.jpg","nickname":"tulip","note":"","ucode":"44BB22410A848D","race_medal":0,"user_type":1,"is_pvip":true},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":333843,"discussion_content":"è‡ªå·±ç”¨golangå®ç°äº†ä¸€ä¸ªç®€å•ç‰ˆçš„https://github.com/Mrliu8023/easyrpc","likes_number":2,"is_delete":false,"is_hidden":false,"ctime":1607649485,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1187577,"avatar":"https://static001.geekbang.org/account/avatar/00/12/1e/f9/bfb54326.jpg","nickname":"ç‹®é”…è‰º","note":"","ucode":"1B4AD130F9D0CA","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":266434,"discussion_content":"golangç‰ˆæœ¬ï¼Œæ¨èå‚è€ƒä¸€ä¸‹https://promacanthus.netlify.app/%E5%BC%80%E5%8F%91%E6%A1%86%E6%9E%B6/grpc/07-golang%E5%BF%AB%E9%80%9F%E5%85%A5%E9%97%A8/  ","likes_number":2,"is_delete":false,"is_hidden":false,"ctime":1589513234,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":183733,"user_name":"æ–°ä¸–ç•Œ","can_delete":false,"product_type":"c1","uid":1079495,"ip_address":"","ucode":"4473DC1505F158","user_header":"https://static001.geekbang.org/account/avatar/00/10/78/c7/083a3a0b.jpg","comment_is_top":false,"comment_ctime":1583121323,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"57417696171","product_id":100046201,"comment_content":"è€å¸ˆèƒ½å¦æŠŠä»£ç æäº¤åˆ°githubä¸Šï¼Œæˆ‘ä»¬å¯ä»¥ä¸‹è½½ä¸‹æ¥è·‘ä¸€è·‘ï¼Œçœ‹ä¸€çœ‹","like_count":13},{"had_liked":false,"id":184919,"user_name":"æ¥¼ä¸‹å°é»‘å“¥","can_delete":false,"product_type":"c1","uid":1014680,"ip_address":"","ucode":"453B099B0EE52E","user_header":"https://static001.geekbang.org/account/avatar/00/0f/7b/98/8f1aecf4.jpg","comment_is_top":false,"comment_ctime":1583453220,"is_pvip":false,"discussion_count":1,"race_medal":0,"score":"40238158884","product_id":100046201,"comment_content":"ç½‘ä¸Šæœç´¢èµ„æ–™æŸ¥åˆ°ï¼Œåˆ†äº«ä¸€ä¸‹ï¼š<br>A stream also has the advantage that you don&#39;t have to have all bytes in memory at the same time, which is convenient if the size of the data is large and can easily be handled in small chunks.","like_count":9,"discussions":[{"author":{"id":1655940,"avatar":"https://static001.geekbang.org/account/avatar/00/19/44/84/4da14994.jpg","nickname":"å‘†ç“œ","note":"","ucode":"C98C7B224D0640","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":360308,"discussion_content":"ç¿»è¯‘ï¼šæµçš„å¦ä¸€ä¸ªä¼˜ç‚¹æ˜¯ï¼Œæ‚¨ä¸å¿…åŒæ—¶å°†æ‰€æœ‰å­—èŠ‚éƒ½å­˜å‚¨åœ¨å†…å­˜ä¸­ï¼Œå¦‚æœæ•°æ®çš„å¤§å°å¾ˆå¤§ï¼Œå¹¶ä¸”å¯ä»¥å¾ˆå®¹æ˜“åœ°ä»¥å°å—çš„å½¢å¼å¤„ç†ï¼Œè¿™æ˜¯å¾ˆæ–¹ä¾¿çš„ã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1616416335,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":183771,"user_name":"è¶…å¨ä¸¶","can_delete":false,"product_type":"c1","uid":1180753,"ip_address":"","ucode":"1A18DE885D3C44","user_header":"https://static001.geekbang.org/account/avatar/00/12/04/51/da465a93.jpg","comment_is_top":false,"comment_ctime":1583132175,"is_pvip":false,"replies":[{"id":"71623","content":"streamä¼ è¾“æ˜¯å»ºç«‹åœ¨å¤šè·¯å¤ç”¨çš„åŸºç¡€ä¸Š","user_name":"ä½œè€…å›å¤","comment_id":183771,"uid":"1541007","ip_address":"","utype":1,"ctime":1583621898,"user_name_real":"ä½•å°é”‹"}],"discussion_count":1,"race_medal":0,"score":"35942870543","product_id":100046201,"comment_content":"éš¾é“http2çš„æ ¸å¿ƒå®ç°ä¸å°±æ˜¯åŸºäºæµå®ç°ï¼Ÿ","like_count":8,"discussions":[{"author":{"id":1541007,"avatar":"https://static001.geekbang.org/account/avatar/00/17/83/8f/8471d633.jpg","nickname":"ä½•å°é”‹","note":"","ucode":"E9B3B4A1B75D8B","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":485774,"discussion_content":"streamä¼ è¾“æ˜¯å»ºç«‹åœ¨å¤šè·¯å¤ç”¨çš„åŸºç¡€ä¸Š","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1583621898,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":333571,"user_name":"æ ¸æ¡ƒ","can_delete":false,"product_type":"c1","uid":1385204,"ip_address":"","ucode":"7AB05270CBCCCB","user_header":"https://static001.geekbang.org/account/avatar/00/15/22/f4/9fd6f8f0.jpg","comment_is_top":false,"comment_ctime":1644409144,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"27414212920","product_id":100046201,"comment_content":"è¿™é‡Œè¯´ä¸€ä¸‹å¯¹inpustreamçš„ç†è§£ã€‚é¦–å…ˆè¦ç†è§£ï¼Œå½“ç½‘å¡æ¥æ”¶åˆ°æ•°æ®ä¹‹åæ˜¯å­˜æ”¾åˆ°ç¼“å†²åŒºçš„ï¼Œè¿™é‡Œå…¶å®å·²ç»åˆ†é…è¿‡ç©ºé—´äº†ã€‚è€Œä¸Šå±‚åº”ç”¨æƒ³æ‹¿åˆ°è¿™äº›æ•°æ®ï¼Œå¯ä»¥å†æ¬¡åˆ†é…ä¸€æ®µç©ºé—´ï¼Œç„¶åæŠŠæ•°æ®ä»ç¼“å†²åŒºå¤åˆ¶åˆ°è¿™é‡Œï¼Œä½†æ˜¯è¿™æ ·å°±å¤šäº†ä¸€æ¬¡å¤åˆ¶äº†ã€‚è€Œä¸ºäº†è§£å†³è¿™ä¸ªé—®é¢˜ï¼Œinputstreamæœ¬è´¨ä¸Šå°±æ˜¯ä¸€æ®µæŒ‡é’ˆï¼ŒæŒ‡å‘äº†ç¼“å†²åŒºçš„æ•°æ®ï¼Œé‚£æ ·å¯ä»¥ç›´æ¥ä½¿ç”¨è¿™æ®µåœ°å€çš„æ•°æ®ã€‚ä¸ç®¡ç”¨ä»€ä¹ˆè¯­è¨€å®ç°ï¼Œæœ¬è´¨æ€æƒ³éƒ½æ˜¯ç±»ä¼¼çš„ã€‚","like_count":6},{"had_liked":false,"id":186391,"user_name":"å››å–œ","can_delete":false,"product_type":"c1","uid":1071389,"ip_address":"","ucode":"C5EBED19C0F332","user_header":"https://static001.geekbang.org/account/avatar/00/10/59/1d/c89abcd8.jpg","comment_is_top":false,"comment_ctime":1583834075,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"27353637851","product_id":100046201,"comment_content":"åˆ†äº«ä¸€ä¸‹Pythonçš„Tutorialï¼š<br><br>gRPC Basics - Pythonï¼šhttps:&#47;&#47;grpc.io&#47;docs&#47;tutorials&#47;basic&#47;python&#47;<br><br>gRPC Python Quick Startï¼šhttps:&#47;&#47;grpc.io&#47;docs&#47;quickstart&#47;python&#47;","like_count":6},{"had_liked":false,"id":183844,"user_name":"å¿†æ°´å¯’","can_delete":false,"product_type":"c1","uid":1147453,"ip_address":"","ucode":"E3F86BD8AA8903","user_header":"https://static001.geekbang.org/account/avatar/00/11/82/3d/356fc3d6.jpg","comment_is_top":false,"comment_ctime":1583144668,"is_pvip":false,"replies":[{"id":"71625","content":"æ˜¯çš„ï¼Œä¾‹å­é‡Œé¢çš„éœ€è¦åœ¨å®¢æˆ·ç«¯ç­‰å¾…","user_name":"ä½œè€…å›å¤","comment_id":183844,"uid":"1541007","ip_address":"","utype":1,"ctime":1583622117,"user_name_real":"ä½•å°é”‹"}],"discussion_count":1,"race_medal":0,"score":"27352948444","product_id":100046201,"comment_content":"è€å¸ˆï¼Œæœ‰ä¸ªç–‘é—®ã€‚æŒ‰é“ç†å®¢æˆ·ç«¯å‘èµ·ä¸€æ¬¡rpcè°ƒç”¨ï¼Œé€šè¿‡åºåˆ—åŒ–ã€ç½‘ç»œä¼ è¾“ã€æœåŠ¡ç«¯å¤„ç†å†å“åº”ï¼Œè¿™æœŸé—´æœ‰æ—¶é—´å·®çš„ã€‚ä¸Šé¢å®¢æˆ·ç«¯ä»£ç é™¤éæ˜¯é˜»å¡çš„ï¼Œå¦åˆ™ä¸å¯èƒ½ç«‹é©¬å¾—åˆ°ç»“æœå§ã€‚","like_count":6,"discussions":[{"author":{"id":1541007,"avatar":"https://static001.geekbang.org/account/avatar/00/17/83/8f/8471d633.jpg","nickname":"ä½•å°é”‹","note":"","ucode":"E9B3B4A1B75D8B","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":485798,"discussion_content":"æ˜¯çš„ï¼Œä¾‹å­é‡Œé¢çš„éœ€è¦åœ¨å®¢æˆ·ç«¯ç­‰å¾…","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1583622117,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":184363,"user_name":"é£ç¿”","can_delete":false,"product_type":"c1","uid":1068571,"ip_address":"","ucode":"65AF6AF292DAD6","user_header":"https://static001.geekbang.org/account/avatar/00/10/4e/1b/f4b786b9.jpg","comment_is_top":false,"comment_ctime":1583298669,"is_pvip":true,"replies":[{"id":"71618","content":"å†…éƒ¨åº”ç”¨ä¹‹é—´é€šä¿¡æ›´å¼ºè°ƒæ€§èƒ½","user_name":"ä½œè€…å›å¤","comment_id":184363,"uid":"1541007","ip_address":"","utype":1,"ctime":1583621330,"user_name_real":"ä½•å°é”‹"}],"discussion_count":5,"race_medal":0,"score":"10173233261","product_id":100046201,"comment_content":"è€å¸ˆ æœ‰è¯´æ³•æ˜¯å†…éƒ¨è°ƒç”¨ç”¨rpc å¤–éƒ¨ç”¨http è¿™æ˜¯ä¸ºä»€ä¹ˆå‘€","like_count":2,"discussions":[{"author":{"id":1541007,"avatar":"https://static001.geekbang.org/account/avatar/00/17/83/8f/8471d633.jpg","nickname":"ä½•å°é”‹","note":"","ucode":"E9B3B4A1B75D8B","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":485988,"discussion_content":"å†…éƒ¨åº”ç”¨ä¹‹é—´é€šä¿¡æ›´å¼ºè°ƒæ€§èƒ½","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1583621330,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1438037,"avatar":"https://static001.geekbang.org/account/avatar/00/15/f1/55/8ac4f169.jpg","nickname":"é™ˆå›½æ—","note":"","ucode":"83D12F3E79F197","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":196044,"discussion_content":"å¤§èƒ†æ¥å›ç­”ä¸‹ï¼Œä¸€èµ·å­¦ä¹ ã€‚\n1. ç›®å‰äº’è”ç½‘äº§å“é¢å‘ç”¨æˆ·çš„å½¢æ€å¤§éƒ¨åˆ†æ˜¯APP+ç½‘é¡µçš„å½¢å¼ï¼Œè¿™ç§æƒ…å†µä¸‹APPæˆ–ç½‘é¡µæˆ‘ä»¬ç§°ä¹‹ä¸ºå®¢æˆ·ç«¯ã€‚è¿™ç§åœºæ™¯ä¸‹å®¢æˆ·ç«¯è·ŸæœåŠ¡ç«¯äº¤äº’å¤§éƒ¨åˆ†æ˜¯é‡‡ç”¨ HTTP åè®®ï¼Œç›®å‰ç”¨çš„æœ€å¤šçš„æ˜¯ HTTP 1.1 ç‰ˆæœ¬ï¼Œè¿™å°±æ˜¯æ‰€è°“çš„ã€å¤–éƒ¨ã€‘ã€‚ä¸ºä»€ä¹ˆç”¨ HTTP å‘¢ï¼Ÿæœ€ä¸»è¦çš„åŸå› æ˜¯ HTTP åè®®å·²ç»å¾ˆæˆç†Ÿäº†ï¼Œè€Œä¸”åè®®æ— çŠ¶æ€ã€æ˜æ–‡ä¼ è¾“ï¼Œå¯¹äºå®¢æˆ·ç«¯æ¥è¯´éå¸¸ä¼˜å¥½ã€‚\n2. çŸ¥é“äº†å¤–éƒ¨çš„å®šä¹‰åï¼Œã€å†…éƒ¨ã€‘çš„å®šä¹‰å°±å¾ˆå¥½ç†è§£ï¼Œæ‰€è°“å†…éƒ¨å°±æ˜¯æŒ‡æœåŠ¡ç«¯å†…éƒ¨ä¹‹é—´æœåŠ¡è°ƒç”¨ï¼Œå¸¸ç”¨äºå¾®æœåŠ¡ä¹‹é—´æœåŠ¡è°ƒç”¨ã€‚ä¸ºä»€ä¹ˆæœåŠ¡ä¹‹é—´ç”¨RPCï¼Œå…¶å®æœ¬è´¨é—®é¢˜å°±æ˜¯ä¸ºä»€ä¹ˆå†…éƒ¨è°ƒç”¨ä¸ç”¨HTTPåè®®ï¼Ÿæˆ‘ä»¬çŸ¥é“æœåŠ¡å†…éƒ¨è°ƒç”¨å¯¹æ€§èƒ½è¦æ±‚æ˜¯æ¯”è¾ƒé«˜çš„ï¼Œé€šå¸¸æœåŠ¡å†…éƒ¨è°ƒç”¨QPSæ¯”å¤–éƒ¨é«˜å¯èƒ½ä¸æ­¢ä¸€ä¸ªé‡çº§ã€‚ä¸ºäº†æé«˜æ€§èƒ½ï¼Œæˆ‘ä»¬å°±éœ€è¦å°½é‡å‡å°‘æœåŠ¡è°ƒç”¨ä¹‹é—´çš„æ•°æ®ä¼ è¾“ï¼Œå¹¶ä¸”èƒ½å¤Ÿè‡ªå®šä¹‰åè®®ã€‚ æ˜¾ç„¶ HTTP åè®®ä¸å¤ªç¬¦åˆè¿™ä¸ªéœ€æ±‚ï¼Œå½“ç„¶å¦‚æœè°ƒç”¨é‡ä¸å¤§ç”¨ HTTP æ˜¯æœ€æ–¹ä¾¿çš„ï¼Œå¦‚æœé‡å¤§ä¸€èˆ¬éƒ½æ˜¯é€‰æ‹© RPC åè®®ã€‚ç›®å‰RPCåè®®æ²¡æœ‰æ˜ç¡®çš„å…¬è®¤æ ‡å‡†ï¼Œæ‰€ä»¥ä¸€èˆ¬å¤§å‚éƒ½ä¼šè‡ªå·±å®ç°","likes_number":8,"is_delete":false,"is_hidden":false,"ctime":1583328525,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":2826205,"avatar":"","nickname":"hillwater","note":"","ucode":"FB16D5FCE8C7E6","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":589810,"discussion_content":"å¤–éƒ¨æˆ‘ä»¬ä¹Ÿç”¨ç§æœ‰åè®®çš„rpcï¼Œä¸»è¦ä¹Ÿæ˜¯ç”¨äºå¤§æµé‡ã€‚å°æµé‡restå¤Ÿäº†","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1665319913,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":"ä¸Šæµ·"},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1009422,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/67/0e/c77ad9b1.jpg","nickname":"eason2017","note":"","ucode":"E070BA624FA490","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":215542,"discussion_content":"ç½‘ç»œé—®é¢˜ï¼Œæœºæˆ¿å†…ç½‘ç¨³å®šï¼Œæ‰€ä»¥ï¼Œæ€§èƒ½è¶Šå¿«è¶Šå¥½ã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1585351814,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1318915,"avatar":"https://thirdwx.qlogo.cn/mmopen/vi_32/DYAIOgq83eo2SjCeylLv0P3Glle5277kA4b8cAuxr1NrC0njPKEqzSpB8IEicHB29GicFFwG1qiaxs4hxRiaBmoibVw/132","nickname":"é˜³ä»”","note":"","ucode":"4907A3750CEAD6","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":197779,"discussion_content":"å¤–éƒ¨ä½ æƒ³ç”¨rpcä¹Ÿå¯ä»¥çš„hhhï¼Œä½†æ˜¯rpcæ˜¯åŸºäºtcpipï¼Œç°åœ¨å›½å†…å…¬ç½‘ipé‚£ä¹ˆå°‘ï¼Œé—®é¢˜æ˜¯å®¢æˆ·ç«¯ä¸ä¼šæœ‰å…¬ç½‘ipçš„å§ï¼Œè¿™ä¸ªåªæ˜¯ä¸ªçŒœæƒ³ï¼Œå¸Œæœ›æœ‰ç¼˜äººèƒ½è§£ç­”ä¸€ä¸‹","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1583436757,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":347039,"user_name":"HzÂº","can_delete":false,"product_type":"c1","uid":2407065,"ip_address":"","ucode":"8EC62B8F7F2163","user_header":"https://static001.geekbang.org/account/avatar/00/24/ba/99/da85915f.jpg","comment_is_top":false,"comment_ctime":1653637144,"is_pvip":true,"discussion_count":0,"race_medal":0,"score":"5948604440","product_id":100046201,"comment_content":"æ„Ÿè§‰å¯¹Javaä¸ç†Ÿæ‚‰çš„åŒå­¦ï¼Œä¸å¤ªå‹å¥½","like_count":1},{"had_liked":false,"id":198663,"user_name":"eason2017","can_delete":false,"product_type":"c1","uid":1009422,"ip_address":"","ucode":"E070BA624FA490","user_header":"https://static001.geekbang.org/account/avatar/00/0f/67/0e/c77ad9b1.jpg","comment_is_top":false,"comment_ctime":1585462859,"is_pvip":false,"replies":[{"id":"74949","content":"å¯ä»¥çœ‹ä¸‹grpcå®˜ç½‘æˆ–è€…æœç´¢ä¸€ä¸‹","user_name":"ä½œè€…å›å¤","comment_id":198663,"uid":"1541007","ip_address":"","utype":1,"ctime":1585570861,"user_name_real":"ä½•å°é”‹"}],"discussion_count":2,"race_medal":0,"score":"5880430155","product_id":100046201,"comment_content":"è€å¸ˆå¥½ï¼Œå¯ä»¥æŠŠ ä¸ºå®¢æˆ·ç«¯å’ŒæœåŠ¡å™¨ç«¯ç”Ÿæˆæ¶ˆæ¯å¯¹è±¡å’Œ RPC åŸºç¡€ä»£ç  çš„å‘½ä»¤æä¾›å‡ºæ¥å—ï¼Ÿè°¢è°¢ã€‚","like_count":1,"discussions":[{"author":{"id":1541007,"avatar":"https://static001.geekbang.org/account/avatar/00/17/83/8f/8471d633.jpg","nickname":"ä½•å°é”‹","note":"","ucode":"E9B3B4A1B75D8B","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":489737,"discussion_content":"å¯ä»¥çœ‹ä¸‹grpcå®˜ç½‘æˆ–è€…æœç´¢ä¸€ä¸‹","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1585570861,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1009422,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/67/0e/c77ad9b1.jpg","nickname":"eason2017","note":"","ucode":"E070BA624FA490","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":217566,"discussion_content":"è°¢è°¢è€å¸ˆï¼Œæˆ‘æ˜¨å¤©æ†‹äº†å¾ˆä¹…ï¼Œæ†‹å‡ºæ¥äº†","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1585570907,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":183654,"user_name":"cricket1981","can_delete":false,"product_type":"c1","uid":1001715,"ip_address":"","ucode":"758262F5958DA4","user_header":"https://static001.geekbang.org/account/avatar/00/0f/48/f3/f1034ffd.jpg","comment_is_top":false,"comment_ctime":1583108146,"is_pvip":false,"replies":[{"id":"71638","content":"åœ¨ä¼ è¾“å±‚ä¹Ÿéœ€è¦ç”¨streamï¼Œé¿å…äºŒæ¬¡æ‹·è´","user_name":"ä½œè€…å›å¤","comment_id":183654,"uid":"1541007","ip_address":"","utype":1,"ctime":1583626445,"user_name_real":"ä½•å°é”‹"}],"discussion_count":1,"race_medal":0,"score":"5878075442","product_id":100046201,"comment_content":"ä»¥æµçš„æ–¹å¼å¤„ç†è¯·æ±‚æ•°æ®ï¼Œé€‚åˆè¯·æ±‚æ•°æ®æ•°æ®é‡å¤§æƒ…å†µã€‚å¥½æ¯”Saxå’ŒDomåŒºåˆ«ã€‚","like_count":1,"discussions":[{"author":{"id":1541007,"avatar":"https://static001.geekbang.org/account/avatar/00/17/83/8f/8471d633.jpg","nickname":"ä½•å°é”‹","note":"","ucode":"E9B3B4A1B75D8B","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":485742,"discussion_content":"åœ¨ä¼ è¾“å±‚ä¹Ÿéœ€è¦ç”¨streamï¼Œé¿å…äºŒæ¬¡æ‹·è´","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1583626445,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":359672,"user_name":"Geek_757cbc","can_delete":false,"product_type":"c1","uid":2943897,"ip_address":"ä¸Šæµ·","ucode":"ECE10235F88FEA","user_header":"","comment_is_top":false,"comment_ctime":1665740152,"is_pvip":true,"discussion_count":0,"race_medal":0,"score":"1665740152","product_id":100046201,"comment_content":"static class HelloServiceImpl æŠ¥é”™ï¼Œå»æ‰staticè°ƒè¯•æˆåŠŸ","like_count":0},{"had_liked":false,"id":316773,"user_name":"å¢¨ç™½","can_delete":false,"product_type":"c1","uid":2259490,"ip_address":"","ucode":"D884B9C0056C80","user_header":"https://static001.geekbang.org/account/avatar/00/22/7a/22/45307c91.jpg","comment_is_top":false,"comment_ctime":1634548268,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1634548268","product_id":100046201,"comment_content":"è€å¸ˆhttpclientåº•å±‚ä¹Ÿæ˜¯åŸºäºsocketå°è£…ï¼Œä¸ºä»€ä¹ˆæ²¡æœ‰åŸºäºFileChannelimpé›¶æ‹·è´çš„å®ç°","like_count":0},{"had_liked":false,"id":239683,"user_name":"Di Yu","can_delete":false,"product_type":"c1","uid":1248429,"ip_address":"","ucode":"9AC55943F7D5D1","user_header":"https://static001.geekbang.org/account/avatar/00/13/0c/ad/d1ab1995.jpg","comment_is_top":false,"comment_ctime":1596615281,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1596615281","product_id":100046201,"comment_content":"gRPCçœ‹èµ·æ¥æ²¡æœ‰ç”¨åˆ°åŠ¨æ€ä»£ç†å—ï¼Ÿåœ¨è°ƒç”¨ç«¯ä»£ç é‡Œè¾¹æˆ‘ä»¬æ‰‹åŠ¨çš„å»ºç«‹äº†channelï¼Œç„¶åæ‰‹åŠ¨çš„call blockingStub.say(request)ã€‚è¿™æ˜¯ä¸ºäº†æ›´å¥½çš„æ€§èƒ½å§ï¼Ÿå¦‚æœè¦ç”¨åŠ¨æ€ä»£ç†ï¼Œé‚£æˆ‘ä»¬ä¼šæŠŠå»ºç«‹channelç­‰äº‹æƒ…æ”¾åˆ°ä»£ç†ç±»é‡Œè¾¹ï¼Œè¿™æ ·è°ƒç”¨ç«¯ä»£ç å°±ç®€åŒ–ä¸€äº›äº†ï¼Œè¿™æ ·ç†è§£å¯¹å—ï¼Ÿ","like_count":0},{"had_liked":false,"id":216733,"user_name":"é’±","can_delete":false,"product_type":"c1","uid":1009652,"ip_address":"","ucode":"2C92A243A463D4","user_header":"https://static001.geekbang.org/account/avatar/00/0f/67/f4/9a1feb59.jpg","comment_is_top":false,"comment_ctime":1589333904,"is_pvip":false,"replies":[{"id":"80445","content":"ğŸ‘","user_name":"ä½œè€…å›å¤","comment_id":216733,"uid":"1541007","ip_address":"","utype":1,"ctime":1589500679,"user_name_real":"ä½•å°é”‹"}],"discussion_count":1,"race_medal":0,"score":"1589333904","product_id":100046201,"comment_content":"æˆ‘ä»¬è®²åˆ°ï¼Œåœ¨ gRPC è°ƒç”¨çš„æ—¶å€™ï¼Œæˆ‘ä»¬æœ‰ä¸€ä¸ªå…³é”®æ­¥éª¤å°±æ˜¯æŠŠå¯¹è±¡è½¬æˆå¯ä¼ è¾“çš„äºŒè¿›åˆ¶ï¼Œä½†æ˜¯åœ¨ gRPC é‡Œé¢ï¼Œæˆ‘ä»¬å¹¶æ²¡æœ‰ç›´æ¥è½¬æˆäºŒè¿›åˆ¶æ•°ç»„ï¼Œè€Œæ˜¯è¿”å›ä¸€ä¸ª InputStreamï¼Œä½ çŸ¥é“è¿™æ ·åšçš„å¥½å¤„æ˜¯ä»€ä¹ˆå—ï¼Ÿ<br><br>è¿™ä¸ªä¸çŸ¥é“å“ğŸ˜‚<br>çŒœæµ‹æ˜¯ä¸ºæ€§èƒ½æ•…ï¼Œçœ‹è¯„è®ºåŒºçš„è®¨è®ºï¼ŒçŒœæµ‹æ˜¯æ­£ç¡®çš„ï¼Œä¸è¿‡ç»†èŠ‚è¿˜æ˜¯ä¸å¤ªæ¸…æ¥šï¼Œéœ€è¦åè¡¥ä¸€ä¸‹ã€‚<br><br>Inputstreamâ€”â€”é¿å…äºŒæ¬¡æ‹·è´ï¼ˆåºåˆ—åŒ–ï¼‹encodeï¼‰â€”â€”æ›´é«˜çš„æ€§èƒ½ã€‚","like_count":0,"discussions":[{"author":{"id":1541007,"avatar":"https://static001.geekbang.org/account/avatar/00/17/83/8f/8471d633.jpg","nickname":"ä½•å°é”‹","note":"","ucode":"E9B3B4A1B75D8B","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":494927,"discussion_content":"ğŸ‘","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1589500679,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":211679,"user_name":"å¯†ç 123456","can_delete":false,"product_type":"c1","uid":1126593,"ip_address":"","ucode":"9889463CC0EA71","user_header":"https://static001.geekbang.org/account/avatar/00/11/30/c1/2dde6700.jpg","comment_is_top":false,"comment_ctime":1587995289,"is_pvip":false,"replies":[{"id":"79140","content":"åºåˆ—åŒ–å’Œencode","user_name":"ä½œè€…å›å¤","comment_id":211679,"uid":"1541007","ip_address":"","utype":1,"ctime":1588407425,"user_name_real":"ä½•å°é”‹"}],"discussion_count":1,"race_medal":0,"score":"1587995289","product_id":100046201,"comment_content":"ä¸ºä»€ä¹ˆèƒ½é¿å…äºŒæ¬¡æ‹·è´ï¼Ÿ","like_count":0,"discussions":[{"author":{"id":1541007,"avatar":"https://static001.geekbang.org/account/avatar/00/17/83/8f/8471d633.jpg","nickname":"ä½•å°é”‹","note":"","ucode":"E9B3B4A1B75D8B","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":493332,"discussion_content":"åºåˆ—åŒ–å’Œencode","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1588407425,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":184934,"user_name":"èš‚èšå†…æ¨+v","can_delete":false,"product_type":"c1","uid":1050508,"ip_address":"","ucode":"24B10AEE54B3FD","user_header":"https://static001.geekbang.org/account/avatar/00/10/07/8c/0d886dcc.jpg","comment_is_top":false,"comment_ctime":1583455323,"is_pvip":false,"replies":[{"id":"71617","content":"grpcæ˜¯ç”¨http2æ¥ä¼ è¾“çš„","user_name":"ä½œè€…å›å¤","comment_id":184934,"uid":"1541007","ip_address":"","utype":1,"ctime":1583621139,"user_name_real":"ä½•å°é”‹"}],"discussion_count":1,"race_medal":0,"score":"1583455323","product_id":100046201,"comment_content":"è¿™æ ·è·ŸHTTP2æœ‰ä»€ä¹ˆåŒºåˆ«å‘¢","like_count":0,"discussions":[{"author":{"id":1541007,"avatar":"https://static001.geekbang.org/account/avatar/00/17/83/8f/8471d633.jpg","nickname":"ä½•å°é”‹","note":"","ucode":"E9B3B4A1B75D8B","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":486177,"discussion_content":"grpcæ˜¯ç”¨http2æ¥ä¼ è¾“çš„","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1583621139,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":183931,"user_name":"Jackey","can_delete":false,"product_type":"c1","uid":1063751,"ip_address":"","ucode":"125DE81993FEDD","user_header":"https://static001.geekbang.org/account/avatar/00/10/3b/47/f6c772a1.jpg","comment_is_top":false,"comment_ctime":1583163701,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1583163701","product_id":100046201,"comment_content":"ç²¾å½©","like_count":0},{"had_liked":false,"id":183640,"user_name":"é«˜æº","can_delete":false,"product_type":"c1","uid":1048887,"ip_address":"","ucode":"751B41FD38EF7D","user_header":"https://static001.geekbang.org/account/avatar/00/10/01/37/12e4c9c9.jpg","comment_is_top":false,"comment_ctime":1583102838,"is_pvip":false,"discussion_count":1,"race_medal":0,"score":"1583102838","product_id":100046201,"comment_content":"æˆ‘çŒœçš„æ˜¯ç½‘ç»œå­—èŠ‚åºé—®é¢˜å§ğŸ˜Š","like_count":0,"discussions":[{"author":{"id":2062475,"avatar":"http://thirdwx.qlogo.cn/mmopen/vi_32/bxaaILnBnJSZFCicMjePPueyEWzQfQBPETvW0l8rX7fPgT7o0ojVrtuoqDiaa2ibAk28USKia4CDzYu1HzjoIUZ8Gw/132","nickname":"è¿½æ±‚","note":"","ucode":"2E3F5A57F89FA1","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":292758,"discussion_content":"è€å¸ˆï¼ŒgRPCæ”¯æŒå¾®ä¿¡å°ç¨‹ç«¯å—ï¼Ÿ è¿˜æœ‰thriftæ”¯æŒå¾®ä¿¡å°ç¨‹åºç«¯å—ï¼Ÿ è°¢è°¢","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1595322036,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]}]}