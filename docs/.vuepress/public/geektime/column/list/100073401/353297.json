{"id":353297,"title":"03 | RDDï¼šä¸ºä»€ä¹ˆä½ å¿…é¡»è¦ç†è§£å¼¹æ€§åˆ†å¸ƒå¼æ•°æ®é›†ï¼Ÿ","content":"<p>ä½ å¥½ï¼Œæˆ‘æ˜¯å´ç£Šã€‚</p><p>ä»ä»Šå¤©å¼€å§‹ï¼Œæˆ‘ä»¬è¿›å…¥åŸç†ç¯‡çš„å­¦ä¹ ã€‚æˆ‘ä¼šä»¥æ€§èƒ½è°ƒä¼˜ä¸ºå¯¼å‘ï¼Œç»™ä½ è¯¦ç»†è®²è®²Sparkä¸­çš„æ ¸å¿ƒæ¦‚å¿µRDDå’ŒDAGï¼Œä»¥åŠé‡è¦ç»„ä»¶è°ƒåº¦ç³»ç»Ÿã€å­˜å‚¨ç³»ç»Ÿå’Œå†…å­˜ç®¡ç†ã€‚è¿™èŠ‚è¯¾ï¼Œå’±ä»¬å…ˆæ¥è¯´è¯´RDDã€‚</p><p>RDDå¯ä»¥è¯´æ˜¯Sparkä¸­æœ€åŸºç¡€çš„æ¦‚å¿µäº†ï¼Œä½¿ç”¨Sparkçš„å¼€å‘è€…æƒ³å¿…å¯¹RDDéƒ½ä¸é™Œç”Ÿï¼Œç”šè‡³æèµ·RDDï¼Œä½ çš„è€³æœµå¯èƒ½éƒ½å·²ç»å¬å‡ºèŒ§å­äº†ã€‚ä¸è¿‡ï¼Œéšç€Sparkå¼€å‘APIçš„æ¼”è¿›å’Œå‘å±•ï¼Œç°åœ¨ä¸Šæ‰‹å¼€å‘åŸºæœ¬éƒ½æ˜¯DataFrameæˆ–Dataset APIã€‚æ‰€ä»¥å¾ˆå¤šåˆå­¦è€…ä¼šè®¤ä¸ºï¼Œâ€œåæ­£RDD APIåŸºæœ¬éƒ½æ²¡äººç”¨äº†ï¼Œæˆ‘ä¹Ÿæ²¡å¿…è¦å¼„æ˜ç™½RDDåˆ°åº•æ˜¯ä»€ä¹ˆã€‚â€</p><p>çœŸçš„æ˜¯è¿™æ ·çš„å—ï¼Ÿå½“ç„¶ä¸æ˜¯ã€‚</p><h2>RDDä¸ºä½•å¦‚æ­¤é‡è¦</h2><p>é¦–å…ˆï¼ŒRDDä½œä¸ºSparkå¯¹äºåˆ†å¸ƒå¼æ•°æ®æ¨¡å‹çš„æŠ½è±¡ï¼Œæ˜¯æ„å»ºSparkåˆ†å¸ƒå¼å†…å­˜è®¡ç®—å¼•æ“çš„åŸºçŸ³ã€‚å¾ˆå¤šSparkæ ¸å¿ƒæ¦‚å¿µä¸æ ¸å¿ƒç»„ä»¶ï¼Œå¦‚DAGå’Œè°ƒåº¦ç³»ç»Ÿéƒ½è¡ç”Ÿè‡ªRDDã€‚<strong>å› æ­¤ï¼Œæ·±å…¥ç†è§£RDDæœ‰åˆ©äºä½ æ›´å…¨é¢ã€ç³»ç»Ÿåœ°å­¦ä¹ Sparkçš„å·¥ä½œåŸç†ã€‚</strong></p><p>å…¶æ¬¡ï¼Œå°½ç®¡RDD APIä½¿ç”¨é¢‘ç‡è¶Šæ¥è¶Šä½ï¼Œç»å¤§å¤šæ•°äººä¹Ÿéƒ½å·²ç»ä¹ æƒ¯äºDataFrameå’ŒDataset APIï¼Œä½†æ˜¯ï¼Œæ— è®ºé‡‡ç”¨å“ªç§APIæˆ–æ˜¯å“ªç§å¼€å‘è¯­è¨€ï¼Œä½ çš„åº”ç”¨åœ¨Sparkå†…éƒ¨æœ€ç»ˆéƒ½ä¼šè½¬åŒ–ä¸ºRDDä¹‹ä¸Šçš„åˆ†å¸ƒå¼è®¡ç®—ã€‚æ¢å¥è¯è¯´ï¼Œ<strong>å¦‚æœä½ æƒ³è¦åœ¨è¿è¡Œæ—¶åˆ¤æ–­åº”ç”¨çš„æ€§èƒ½ç“¶é¢ˆï¼Œå‰ææ˜¯ä½ è¦å¯¹RDDè¶³å¤Ÿäº†è§£</strong>ã€‚è¿˜è®°å¾—å—ï¼Ÿå®šä½æ€§èƒ½ç“¶é¢ˆæ˜¯Sparkæ€§èƒ½è°ƒä¼˜çš„ç¬¬ä¸€æ­¥ã€‚</p><!-- [[[read_end]]] --><p>ä¸ä»…å¦‚æ­¤ï¼Œå¯¹äºRDDä¸æ±‚ç”šè§£è¿˜æœ‰å¯èƒ½å¸¦æ¥æ½œåœ¨çš„æ€§èƒ½éšæ‚£ï¼Œæ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬å°±ä»ä¸€ä¸ªåä¾‹å…¥æ‰‹ï¼Œä¸€èµ·æ¥åˆ†æä¸€ä¸‹ã€‚</p><p>è¿˜è®°å¾—ï¼Œæˆ‘ä»¬åœ¨ç¬¬1è®²ä¸­è®²è¿‡çš„æ•°æ®è¿‡æ»¤ä¸èšåˆçš„åä¾‹å—ï¼Ÿé€šè¿‡è¿™ä¸ªä¾‹å­æˆ‘ä»¬æ˜ç™½äº†æ€§èƒ½è°ƒä¼˜çš„å¿…è¦æ€§ã€‚é‚£è¿™ä¸ªä¾‹å­å’ŒRDDæœ‰ä»€ä¹ˆå…³ç³»å‘¢ï¼Ÿ</p><p>åˆ«ç€æ€¥ï¼Œæˆ‘ä»¬å…ˆæ¥å›é¡¾ä¸€ä¸‹è¿™ä¸ªæ¡ˆä¾‹ä¸­çš„ä»£ç å®ç°ï¼Œå»æŒ–æ˜å¼€å‘è€…é‡‡ç”¨è¿™ç§å®ç°æ–¹å¼çš„æ·±å±‚åŸå› ã€‚</p><pre><code>  //å®ç°æ–¹æ¡ˆ1 â€”â€” åä¾‹\ndef createInstance(factDF: DataFrame, startDate: String, endDate: String): DataFrame = {\nval instanceDF = factDF\n    .filter(col(&quot;eventDate&quot;) &gt; lit(startDate) &amp;&amp; col(&quot;eventDate&quot;) &lt;= lit(endDate))\n    .groupBy(&quot;dim1&quot;, &quot;dim2&quot;, &quot;dim3&quot;, &quot;event_date&quot;)\n    .agg(&quot;sum(value) as sum_value&quot;)\ninstanceDF\n}\n \npairDF.collect.foreach{\ncase (startDate: String, endDate: String) =&gt;\n    val instance = createInstance(factDF, startDate, endDate)\n    val outPath = s&quot;${rootPath}/endDate=${endDate}/startDate=${startDate}&quot;\n    instance.write.parquet(outPath)\n} \n\n</code></pre><p>åœ¨è¿™æ®µä»£ç ä¸­ï¼ŒcreateInstanceçš„ä¸»è¦é€»è¾‘æ˜¯æŒ‰ç…§æ—¶é—´æ¡ä»¶å¯¹factDFè¿›è¡Œè¿‡æ»¤ï¼Œè¿”å›æ±‡æ€»çš„ä¸šåŠ¡ç»Ÿè®¡é‡ï¼Œç„¶åpairDFå¾ªç¯éå†æ¯ä¸€å¯¹å¼€å§‹æ—¶é—´å’Œç»“æŸæ—¶é—´ï¼Œå¾ªç¯è°ƒç”¨createInstanceè·å–æ±‡æ€»ç»“æœå¹¶è½ç›˜ã€‚æˆ‘ä»¬åœ¨<a href=\"https://time.geekbang.org/column/article/352035\">ç¬¬1è¯¾</a>ä¸­åˆ†æè¿‡ï¼Œè¿™ä»½ä»£ç çš„ä¸»è¦é—®é¢˜åœ¨äºå›Šæ‹¬ä¸Šåƒä¸‡è¡Œæ•°æ®çš„factDFè¢«åå¤æ‰«æäº†å‡ ç™¾æ¬¡ï¼Œè€Œä¸”æ˜¯å…¨é‡æ‰«æï¼Œä»è€Œæ‹–å®äº†ç«¯åˆ°ç«¯çš„æ‰§è¡Œæ€§èƒ½ã€‚</p><p>é‚£ä¹ˆï¼Œæˆ‘ä»¬ä¸ç¦è¦é—®ï¼šå¼€å‘è€…ç©¶ç«Ÿä¸ºä»€ä¹ˆä¼šæƒ³åˆ°ç”¨è¿™ç§ä½æ•ˆçš„æ–¹å¼å»å®ç°ä¸šåŠ¡é€»è¾‘å‘¢ï¼Ÿæˆ–è€…è¯´ï¼Œæ˜¯ä»€ä¹ˆå†…é©±å› ç´ è®©å¼€å‘è€…è‡ªç„¶è€Œç„¶åœ°é‡‡ç”¨è¿™ç§å®ç°æ–¹å¼å‘¢ï¼Ÿ</p><p>è®©æˆ‘ä»¬è·³å‡ºSparkã€è·³å‡ºè¿™ä¸ªä¸“æ ï¼ŒæŠŠè‡ªå·±ç½®èº«äºä¸€é—´æ•™å®¤å†…ï¼šé»‘æ¿å‰ï¼Œè€å¸ˆæ­£åœ¨è®²è§£ã€ŠXXè¯­è¨€ç¼–ç¨‹ã€‹ï¼Œæ—è¾¹æ˜¯ä½ çš„åŒå­¦ï¼Œä»–è¾¹å¬è€å¸ˆè®²è¯¾ï¼Œè¾¹ç¿»çœ‹ç€æ¡Œä¸Šçš„è¯¾æœ¬ã€‚è¿™ä¸ªåœºæ™¯ç†Ÿä¸ç†Ÿæ‚‰ï¼Ÿäº²ä¸äº²åˆ‡ï¼Ÿå›æƒ³ä¸€ä¸‹ï¼Œè€å¸ˆè®²çš„ã€ä¹¦æœ¬ä¸Šæ•™çš„å’Œæˆ‘ä»¬ç¤ºä¾‹ä¸­çš„ä»£ç ï¼Œæ˜¯ä¸æ˜¯æå…¶ç±»ä¼¼ï¼Ÿ</p><p>æ²¡é”™ï¼æˆ‘ä»¬çš„å¤§è„‘ï¼Œå·²ç»ä¹ æƒ¯äº†forå¾ªç¯ï¼Œä¹ æƒ¯äº†ç”¨å‡½æ•°å¤„ç†å˜é‡ã€å°è£…è®¡ç®—é€»è¾‘ï¼Œä¹ æƒ¯äº†é¢å‘è¿‡ç¨‹çš„ç¼–ç¨‹æ¨¡å¼ã€‚åœ¨åˆ†å¸ƒå¼è®¡ç®—å‡ºç°ä»¥å‰ï¼Œæˆ‘ä»¬éƒ½æ˜¯è¿™ä¹ˆå¼€å‘çš„ï¼Œè€å¸ˆä¹Ÿæ˜¯è¿™ä¹ˆè®²çš„ï¼Œä¹¦æœ¬ä¸Šä¹Ÿæ˜¯è¿™ä¹ˆæ•™çš„ï¼Œæ²¡æ¯›ç—…ã€‚</p><p>å› æ­¤æˆ‘è®¤ä¸ºï¼Œå¼€å‘è€…ä¹‹æ‰€ä»¥ä¼šé€‰æ‹©ä¸Šé¢çš„å®ç°æ–¹å¼ï¼Œæ ¹æœ¬åŸå› åœ¨äºä»–æŠŠfactDFå½“æˆäº†ä¸€ä¸ªæ™®é€šå˜é‡ï¼Œä¸€ä¸ªä¸createInstanceå‡½æ•°ä¸­startDateã€endDateåŒç­‰åœ°ä½çš„å½¢å‚ï¼Œä»–å¹¶æ²¡æœ‰æ„è¯†åˆ°ï¼ŒfactDFå®é™…ä¸Šæ˜¯ä¸€ä¸ªåºå¤§çš„ã€æ¨ªè·¨æ‰€æœ‰è®¡ç®—èŠ‚ç‚¹çš„åˆ†å¸ƒå¼æ•°æ®é›†åˆï¼Œæ›´æ²¡æœ‰æ„è¯†åˆ°ï¼Œåœ¨åˆ†å¸ƒå¼è¿è¡Œç¯å¢ƒä¸­ï¼Œå¤–é¢çš„forå¾ªç¯ä¼šå¯¼è‡´è¿™ä¸ªåºå¤§çš„æ•°æ®é›†è¢«åå¤åœ°å…¨é‡æ‰«æã€‚</p><p>è¿™ç§å¯¹äºåˆ†å¸ƒå¼è®¡ç®—è®¤çŸ¥æ–¹é¢çš„ç¼ºå¤±ï¼Œç©¶å…¶ç¼˜ç”±ï¼Œè¿˜æ˜¯æˆ‘ä»¬å¯¹Sparkæ ¸å¿ƒæ¦‚å¿µRDDçš„ç†è§£ä¸å¤Ÿé€å½»ã€‚æ‰€ä»¥ä½ çœ‹ï¼Œæ·±å…¥ç†è§£RDDè¿˜æ˜¯å¾ˆæœ‰å¿…è¦çš„ï¼Œ<strong>å¯¹äºRDDä¸€çŸ¥åŠè§£ï¼Œææœ‰å¯èƒ½åœ¨åº”ç”¨å¼€å‘çš„è¿‡ç¨‹ä¸­ï¼Œä¸çŸ¥ä¸è§‰åœ°ç•™ä¸‹æ½œåœ¨çš„æ€§èƒ½éšæ‚£</strong>ã€‚</p><h2>æ·±å…¥ç†è§£RDD</h2><p>æ—¢ç„¶RDDå¦‚æ­¤é‡è¦ï¼Œå®ƒç©¶ç«Ÿæ˜¯ä»€ä¹ˆå‘¢ï¼Ÿ2010å¹´ï¼Œåœ¨ä¸€ä¸ªå¤œé»‘é£é«˜çš„å¤œæ™šï¼ŒMateiç­‰äººå‘è¡¨äº†ä¸€ç¯‡åä¸ºã€ŠSpark: Cluster Computing with Working Setsã€‹çš„è®ºæ–‡å¹¶é¦–æ¬¡æå‡ºäº†RDDçš„æ¦‚å¿µã€‚RDDï¼Œå…¨ç§°Resilient Distributed Datasetsï¼Œç¿»è¯‘è¿‡æ¥å°±æ˜¯å¼¹æ€§åˆ†å¸ƒå¼æ•°æ®é›†ã€‚æœ¬è´¨ä¸Šï¼Œå®ƒæ˜¯å¯¹äºæ•°æ®æ¨¡å‹çš„æŠ½è±¡ï¼Œç”¨äºå›Šæ‹¬æ‰€æœ‰å†…å­˜ä¸­å’Œç£ç›˜ä¸­çš„åˆ†å¸ƒå¼æ•°æ®å®ä½“ã€‚</p><p>å¦‚æœå°±è¿™ä¹ˆä»ç†è®ºå‡ºå‘ã€ç…§æœ¬å®£ç§‘åœ°è®²ä¸‹å»ï¼Œæœªå…è¿‡äºæ¯ç‡¥ã€ä¹å‘³ã€æ²¡æ„æ€ï¼ä¸å¦‚ï¼Œæˆ‘å…ˆæ¥ç»™ä½ è®²ä¸ªæ•…äº‹ã€‚</p><h3>ä»è–¯ç‰‡çš„åŠ å·¥æµç¨‹çœ‹RDD</h3><p>åœ¨å¾ˆä¹…å¾ˆä¹…ä»¥å‰ï¼Œæœ‰ä¸ªç”Ÿäº§æ¡¶è£…è–¯ç‰‡çš„å·¥åŠï¼Œå·¥åŠçš„è§„æ¨¡è¾ƒå°ï¼Œå·¥è‰ºä¹Ÿæ¯”è¾ƒåŸå§‹ã€‚ä¸ºäº†å……åˆ†åˆ©ç”¨æ¯ä¸€é¢—åœŸè±†ã€é™ä½ç”Ÿäº§æˆæœ¬ï¼Œå·¥åŠä½¿ç”¨ 3 æ¡æµæ°´çº¿æ¥åŒæ—¶ç”Ÿäº§ 3 ç§ä¸åŒå°ºå¯¸çš„æ¡¶è£…è–¯ç‰‡ã€‚3 æ¡æµæ°´çº¿å¯ä»¥åŒæ—¶åŠ å·¥ 3 é¢—åœŸè±†ï¼Œæ¯æ¡æµæ°´çº¿çš„ä½œä¸šæµç¨‹éƒ½æ˜¯ä¸€æ ·çš„ï¼Œåˆ†åˆ«æ˜¯æ¸…æ´—ã€åˆ‡ç‰‡ã€çƒ˜ç„™ã€åˆ†å‘å’Œè£…æ¡¶ã€‚å…¶ä¸­ï¼Œåˆ†å‘ç¯èŠ‚ç”¨äºåŒºåˆ†å°ã€ä¸­ã€å¤§å· 3 ç§è–¯ç‰‡ï¼Œ3ç§ä¸åŒå°ºå¯¸çš„è–¯ç‰‡åˆ†åˆ«è¢«å‘å¾€ç¬¬1ã€2ã€3æ¡æµæ°´çº¿ã€‚å…·ä½“æµç¨‹å¦‚ä¸‹å›¾æ‰€ç¤ºã€‚</p><p><img src=\"https://static001.geekbang.org/resource/image/3c/6e/3c7ff059e50f3dc70bf4yy082c31956e.jpg?wh=9021*2316\" alt=\"\" title=\"RDDçš„ç”Ÿæ´»åŒ–ç±»æ¯”\"></p><p>çœ‹å¾—å‡ºæ¥ï¼Œè¿™å®¶å·¥åŠåˆ¶ä½œå·¥è‰ºè™½ç„¶ç®€å•ï¼Œå€’ä¹Ÿè›®æœ‰ç« æ³•ã€‚ä»å¤´è‡³å°¾ï¼Œé™¤äº†åˆ†å‘ç¯èŠ‚ï¼Œ3 æ¡æµæ°´çº¿æ²¡æœ‰ä»»ä½•äº¤é›†ã€‚åœ¨åˆ†å‘ç¯èŠ‚ä¹‹å‰ï¼Œæ¯æ¡æµæ°´çº¿éƒ½æ˜¯ä¸“å¿ƒè‡´å¿—ã€å„é¡¾å„åœ°å¼€å±•å·¥ä½œï¼šæŠŠåœŸè±†é£ŸæåŠ è½½åˆ°æµæ°´çº¿ä¸Šï¼Œå†è¿›è¡Œæ¸…æ´—ã€åˆ‡ç‰‡ã€çƒ˜ç„™ï¼›åœ¨åˆ†å‘ç¯èŠ‚ä¹‹åï¼Œ3 æ¡æµæ°´çº¿ä¹Ÿæ˜¯å„è‡ªè£…æ¡¶ï¼Œäº’ä¸å¹²æ¶‰ã€äº’ä¸å½±å“ã€‚æµæ°´çº¿çš„ä½œä¸šæ–¹å¼æä¾›äº†è¾ƒå¼ºçš„å®¹é”™èƒ½åŠ›ï¼Œå¦‚æœæŸä¸ªåŠ å·¥ç¯èŠ‚å‡ºé”™ï¼Œå·¥äººä»¬åªéœ€è¦å¾€å‡ºé”™çš„æµæ°´çº¿ä¸Šé‡æ–°åŠ è½½ä¸€é¢—æ–°çš„åœŸè±†ï¼Œæ•´ä¸ªæµæ°´çº¿å°±èƒ½å¤Ÿæ¢å¤ç”Ÿäº§ã€‚</p><p>å¥½äº†ï¼Œæ•…äº‹è®²å®Œäº†ã€‚å¦‚æœæˆ‘ä»¬æŠŠæ¯ä¸€æ¡æµæ°´çº¿çœ‹ä½œæ˜¯åˆ†å¸ƒå¼è¿è¡Œç¯å¢ƒçš„è®¡ç®—èŠ‚ç‚¹ï¼Œç”¨è–¯ç‰‡ç”Ÿäº§çš„æµç¨‹å»ç±»æ¯”Sparkåˆ†å¸ƒå¼è®¡ç®—ï¼Œä¼šæœ‰å“ªäº›æœ‰è¶£çš„å‘ç°å‘¢ï¼Ÿ</p><p>ä»”ç»†è§‚å¯Ÿï¼Œæˆ‘ä»¬å‘ç°ï¼š<strong>åˆšä»åœ°é‡ŒæŒ–å‡ºæ¥çš„åœŸè±†é£Ÿæã€æ¸…æ´—è¿‡åçš„å¹²å‡€åœŸè±†ã€ç”Ÿè–¯ç‰‡ã€çƒ¤ç†Ÿçš„è–¯ç‰‡ï¼Œæµæ°´çº¿ä¸Šè¿™äº›é£Ÿæçš„ä¸åŒå½¢æ€ï¼Œå°±åƒæ˜¯Sparkä¸­RDDå¯¹äºä¸åŒæ•°æ®é›†åˆçš„æŠ½è±¡</strong>ã€‚</p><p>æ²¿ç€æµæ°´çº¿çš„çºµæ·±æ–¹å‘ï¼Œä¹Ÿå°±æ˜¯å›¾ä¸­ä»å·¦å‘å³çš„æ–¹å‘ï¼Œæ¯ä¸€ç§é£Ÿæå½¢æ€éƒ½æ˜¯åœ¨å‰ä¸€ç§é£Ÿæä¹‹ä¸Šç”¨ç›¸åº”çš„åŠ å·¥æ–¹æ³•è¿›è¡Œå¤„ç†å¾—åˆ°çš„ã€‚<strong>æ¯ç§é£Ÿæå½¢æ€éƒ½ä¾èµ–äºå‰ä¸€ç§é£Ÿæï¼Œè¿™å°±åƒæ˜¯RDDä¸­dependencieså±æ€§è®°å½•çš„ä¾èµ–å…³ç³»ï¼Œè€Œä¸åŒç¯èŠ‚çš„åŠ å·¥æ–¹æ³•ï¼Œå¯¹åº”çš„åˆšå¥½å°±æ˜¯RDDçš„computeå±æ€§ã€‚</strong></p><p>æ¨ªçœ‹æˆå²­ä¾§æˆå³°ï¼Œå†è®©æˆ‘ä»¬ä»æ¨ªå‘çš„è§’åº¦æ¥é‡æ–°å®¡è§†ä¸Šé¢çš„åœŸè±†åŠ å·¥æµç¨‹ï¼Œä¹Ÿå°±æ˜¯å›¾ä¸­ä»ä¸Šè‡³ä¸‹çš„æ–¹å‘ï¼Œè®©æˆ‘ä»¬æŠŠç›®å…‰é›†ä¸­åœ¨æµæ°´çº¿å¼€ç«¯é‚£3é¢—å¸¦æ³¥çš„åœŸè±†ä¸Šã€‚è¿™3é¢—åœŸè±†æ‰ä»åœ°é‡ŒæŒ–å‡ºæ¥ï¼Œæ˜¯åŸå§‹çš„é£Ÿæå½¢æ€ï¼Œæ­£ç­‰å¾…æ¸…æ´—ã€‚å¦‚å›¾æ‰€ç¤ºï¼Œæˆ‘ä»¬æŠŠè¿™ç§é£Ÿæå½¢æ€æ ‡è®°ä¸ºpotatosRDDï¼Œé‚£ä¹ˆï¼Œ<strong>è¿™é‡Œçš„æ¯ä¸€é¢—åœŸè±†å°±æ˜¯RDDä¸­çš„æ•°æ®åˆ†ç‰‡ï¼Œ3é¢—åœŸè±†ä¸€èµ·å¯¹åº”çš„å°±æ˜¯RDDçš„partitionså±æ€§</strong>ã€‚</p><p><img src=\"https://static001.geekbang.org/resource/image/a2/c8/a2f8bc7bf10c31fedb85196f33f44fc8.jpg?wh=9021*2373\" alt=\"\"></p><p>å¸¦æ³¥åœŸè±†ç»è¿‡æ¸…æ´—ã€åˆ‡ç‰‡å’Œçƒ˜ç„™ä¹‹åï¼ŒæŒ‰ç…§å¤§å°ä¸ªå„¿è¢«åˆ†å‘åˆ°ä¸‹æ¸¸çš„3æ¡æµæ°´çº¿ä¸Šï¼Œè¿™3æ¡æµæ°´çº¿ä¸Šæ‰¿è½½çš„RDDè®°ä¸ºshuffledBakedChipsRDDã€‚å¾ˆæ˜æ˜¾ï¼Œè¿™ä¸ªRDDå¯¹äºpartitionsçš„åˆ’åˆ†æ˜¯æœ‰è®²ç©¶çš„ï¼Œæ ¹æ®å°ºå¯¸çš„ä¸åŒï¼Œå³é£Ÿè–¯ç‰‡ä¼šè¢«åˆ’åˆ†åˆ°ä¸åŒçš„æ•°æ®åˆ†ç‰‡ä¸­ã€‚<strong>åƒè¿™ç§æ•°æ®åˆ†ç‰‡åˆ’åˆ†è§„åˆ™ï¼Œå¯¹åº”çš„å°±æ˜¯RDDä¸­çš„partitionerå±æ€§ã€‚</strong> åœ¨åˆ†å¸ƒå¼è¿è¡Œç¯å¢ƒä¸­ï¼Œpartitionerå±æ€§å®šä¹‰äº†RDDæ‰€å°è£…çš„åˆ†å¸ƒå¼æ•°æ®é›†å¦‚ä½•åˆ’åˆ†æˆæ•°æ®åˆ†ç‰‡ã€‚</p><p>æ€»çš„æ¥è¯´ï¼Œæˆ‘ä»¬å‘ç°ï¼Œè–¯ç‰‡ç”Ÿäº§çš„æµç¨‹å’ŒSparkåˆ†å¸ƒå¼è®¡ç®—æ˜¯ä¸€ä¸€å¯¹åº”çš„ï¼Œä¸€å…±å¯ä»¥æ€»ç»“ä¸º6ç‚¹ï¼š</p><ul>\n<li>åœŸè±†å·¥åŠçš„æ¯æ¡æµæ°´çº¿å°±åƒæ˜¯åˆ†å¸ƒå¼ç¯å¢ƒä¸­çš„è®¡ç®—èŠ‚ç‚¹ï¼›</li>\n<li>ä¸åŒçš„é£Ÿæå½¢æ€ï¼Œå¦‚å¸¦æ³¥çš„åœŸè±†ã€åœŸè±†åˆ‡ç‰‡ã€çƒ˜çƒ¤çš„åœŸè±†ç‰‡ç­‰ç­‰ï¼Œå¯¹åº”çš„å°±æ˜¯RDDï¼›</li>\n<li>æ¯ä¸€ç§é£Ÿæå½¢æ€éƒ½ä¼šä¾èµ–ä¸Šä¸€ç§å½¢æ€ï¼Œå¦‚çƒ¤ç†Ÿçš„åœŸè±†ç‰‡ä¾èµ–ä¸Šä¸€ä¸ªæ­¥éª¤çš„ç”ŸåœŸè±†åˆ‡ç‰‡ã€‚è¿™ç§ä¾èµ–å…³ç³»å¯¹åº”çš„å°±æ˜¯RDDä¸­çš„dependencieså±æ€§ï¼›</li>\n<li>ä¸åŒç¯èŠ‚çš„åŠ å·¥æ–¹æ³•å¯¹åº”RDDçš„computeå±æ€§ï¼›</li>\n<li>åŒä¸€ç§é£Ÿæå½¢æ€åœ¨ä¸åŒæµæ°´çº¿ä¸Šçš„å…·ä½“å®ç‰©ï¼Œå°±æ˜¯RDDçš„partitionså±æ€§ï¼›</li>\n<li>é£ŸææŒ‰ç…§ä»€ä¹ˆè§„åˆ™è¢«åˆ†é…åˆ°å“ªæ¡æµæ°´çº¿ï¼Œå¯¹åº”çš„å°±æ˜¯RDDçš„partitionerå±æ€§ã€‚</li>\n</ul><p>ä¸çŸ¥é“åœŸè±†å·¥åŠçš„ç±»æ¯”ï¼Œæœ‰æ²¡æœ‰å¸®ä½ é€æ¸å‹¾å‹’å‡ºRDDçš„æœ¬æ¥é¢è²Œå‘¢ï¼Ÿè¯ä»˜å‰è¨€ï¼Œæ¥ä¸‹æ¥ï¼Œå’±ä»¬æ¥ä¸€æœ¬æ­£ç»åœ°èŠèŠRDDã€‚</p><h3>RDDçš„æ ¸å¿ƒç‰¹å¾å’Œå±æ€§</h3><p>é€šè¿‡åˆšæ‰çš„ä¾‹å­ï¼Œæˆ‘ä»¬çŸ¥é“RDDå…·æœ‰4å¤§å±æ€§ï¼Œ<strong>åˆ†åˆ«æ˜¯partitionsã€partitionerã€dependencieså’Œcomputeå±æ€§ã€‚æ­£å› ä¸ºæœ‰äº†è¿™4å¤§å±æ€§çš„å­˜åœ¨ï¼Œè®©RDDå…·æœ‰åˆ†å¸ƒå¼å’Œå®¹é”™æ€§è¿™ä¸¤å¤§æœ€çªå‡ºçš„ç‰¹æ€§ã€‚</strong>è¦æƒ³æ·±å…¥ç†è§£RDDï¼Œæˆ‘ä»¬ä¸å¦¨ä»å®ƒçš„æ ¸å¿ƒç‰¹æ€§å’Œå±æ€§å…¥æ‰‹ã€‚</p><p><strong>é¦–å…ˆï¼Œæˆ‘ä»¬æ¥çœ‹partitionsã€partitionerå±æ€§ã€‚</strong></p><p>åœ¨åˆ†å¸ƒå¼è¿è¡Œç¯å¢ƒä¸­ï¼ŒRDDå°è£…çš„æ•°æ®åœ¨ç‰©ç†ä¸Šæ•£è½åœ¨ä¸åŒè®¡ç®—èŠ‚ç‚¹çš„å†…å­˜æˆ–æ˜¯ç£ç›˜ä¸­ï¼Œè¿™äº›æ•£è½çš„æ•°æ®è¢«ç§°â€œæ•°æ®åˆ†ç‰‡â€ï¼ŒRDDçš„åˆ†åŒºè§„åˆ™å†³å®šäº†å“ªäº›æ•°æ®åˆ†ç‰‡åº”è¯¥æ•£è½åˆ°å“ªäº›èŠ‚ç‚¹ä¸­å»ã€‚RDDçš„partitionså±æ€§å¯¹åº”ç€RDDåˆ†å¸ƒå¼æ•°æ®å®ä½“ä¸­æ‰€æœ‰çš„æ•°æ®åˆ†ç‰‡ï¼Œè€Œpartitionerå±æ€§åˆ™å®šä¹‰äº†åˆ’åˆ†æ•°æ®åˆ†ç‰‡çš„åˆ†åŒºè§„åˆ™ï¼Œå¦‚æŒ‰å“ˆå¸Œå–æ¨¡æˆ–æ˜¯æŒ‰åŒºé—´åˆ’åˆ†ç­‰ã€‚</p><p>ä¸éš¾å‘ç°ï¼Œpartitionså’Œpartitionerå±æ€§åˆ»ç”»çš„æ˜¯RDDåœ¨è·¨èŠ‚ç‚¹æ–¹å‘ä¸Šçš„æ¨ªå‘æ‰©å±•ï¼Œæ‰€ä»¥æˆ‘ä»¬æŠŠå®ƒä»¬å«åšRDDçš„â€œæ¨ªå‘å±æ€§â€ã€‚</p><p><strong>ç„¶åï¼Œæˆ‘ä»¬å†æ¥è¯´è¯´dependencieså’Œcomputeå±æ€§ã€‚</strong></p><p>åœ¨Sparkä¸­ï¼Œä»»ä½•ä¸€ä¸ª RDD éƒ½ä¸æ˜¯å‡­ç©ºäº§ç”Ÿçš„ï¼Œæ¯ä¸ª RDD éƒ½æ˜¯åŸºäºæŸç§è®¡ç®—é€»è¾‘ä»æŸä¸ªâ€œæ•°æ®æºâ€è½¬æ¢è€Œæ¥ã€‚RDDçš„dependencieså±æ€§è®°å½•äº†ç”ŸæˆRDD æ‰€éœ€çš„â€œæ•°æ®æºâ€ï¼Œæœ¯è¯­å«åšçˆ¶ä¾èµ–ï¼ˆæˆ–çˆ¶RDDï¼‰ï¼Œcomputeæ–¹æ³•åˆ™å°è£…äº†ä»çˆ¶ RDDåˆ°å½“å‰RDDè½¬æ¢çš„è®¡ç®—é€»è¾‘ã€‚</p><p>åŸºäºæ•°æ®æºå’Œè½¬æ¢é€»è¾‘ï¼Œæ— è®ºRDDæœ‰ä»€ä¹ˆå·®æ± ï¼ˆå¦‚èŠ‚ç‚¹å®•æœºé€ æˆéƒ¨åˆ†æ•°æ®åˆ†ç‰‡ä¸¢å¤±ï¼‰ï¼Œåœ¨dependencieså±æ€§è®°å½•çš„çˆ¶RDDä¹‹ä¸Šï¼Œéƒ½å¯ä»¥é€šè¿‡æ‰§è¡Œcomputeå°è£…çš„è®¡ç®—é€»è¾‘å†æ¬¡å¾—åˆ°å½“å‰çš„RDDï¼Œå¦‚ä¸‹å›¾æ‰€ç¤ºã€‚</p><p><img src=\"https://static001.geekbang.org/resource/image/fb/91/fba28ce0c70b4c5553505911663aa491.jpg?wh=5496*1251\" alt=\"\" title=\"åŸºäºdependencieså’Œcomputeå±æ€§å¾—åˆ°å½“å‰RDD\"></p><p>ç”±dependencieså’Œcomputeå±æ€§æä¾›çš„å®¹é”™èƒ½åŠ›ï¼Œä¸ºSparkåˆ†å¸ƒå¼å†…å­˜è®¡ç®—çš„ç¨³å®šæ€§æ‰“ä¸‹äº†åšå®çš„åŸºç¡€ï¼Œè¿™ä¹Ÿæ­£æ˜¯RDDå‘½åä¸­Resilientçš„ç”±æ¥ã€‚æ¥ç€è§‚å¯Ÿä¸Šå›¾ï¼Œæˆ‘ä»¬ä¸éš¾å‘ç°ï¼Œä¸åŒçš„RDDé€šè¿‡dependencieså’Œcomputeå±æ€§é“¾æ¥åœ¨ä¸€èµ·ï¼Œé€æ¸å‘çºµæ·±å»¶å±•ï¼Œæ„å»ºäº†ä¸€å¼ è¶Šæ¥è¶Šæ·±çš„æœ‰å‘æ— ç¯å›¾ï¼Œä¹Ÿå°±æ˜¯æˆ‘ä»¬å¸¸è¯´çš„DAGã€‚</p><p>ç”±æ­¤å¯è§ï¼Œdependencieså±æ€§å’Œcomputeå±æ€§è´Ÿè´£RDDåœ¨çºµæ·±æ–¹å‘ä¸Šçš„å»¶å±•ï¼Œå› æ­¤æˆ‘ä»¬ä¸å¦¨æŠŠè¿™ä¸¤ä¸ªå±æ€§ç§°ä¸ºâ€œçºµå‘å±æ€§â€ã€‚</p><p>æ€»çš„æ¥è¯´ï¼Œ<strong>RDDçš„4å¤§å±æ€§åˆå¯ä»¥åˆ’åˆ†ä¸ºä¸¤ç±»ï¼Œæ¨ªå‘å±æ€§å’Œçºµå‘å±æ€§ã€‚å…¶ä¸­ï¼Œæ¨ªå‘å±æ€§é”šå®šæ•°æ®åˆ†ç‰‡å®ä½“ï¼Œå¹¶è§„å®šäº†æ•°æ®åˆ†ç‰‡åœ¨åˆ†å¸ƒå¼é›†ç¾¤ä¸­å¦‚ä½•åˆ†å¸ƒï¼›çºµå‘å±æ€§ç”¨äºåœ¨çºµæ·±æ–¹å‘æ„å»ºDAGï¼Œé€šè¿‡æä¾›é‡æ„RDDçš„å®¹é”™èƒ½åŠ›ä¿éšœå†…å­˜è®¡ç®—çš„ç¨³å®šæ€§</strong>ã€‚</p><p>åŒæ—¶ï¼Œä¸ºäº†å¸®åŠ©ä½ è®°å¿†ï¼Œæˆ‘æŠŠè¿™4å¤§æ ¸å¿ƒå±æ€§çš„åŸºæœ¬æ¦‚å¿µå’Œåˆ†ç±»æ€»ç»“åœ¨äº†å¦‚ä¸‹çš„è¡¨æ ¼ä¸­ï¼Œä½ å¯ä»¥çœ‹ä¸€çœ‹ã€‚</p><p><img src=\"https://static001.geekbang.org/resource/image/ca/1e/ca6ef660c2b7f3777e244a535020191e.jpeg?wh=1920*875\" alt=\"\"></p><p>é™¤æ­¤ä¹‹å¤–ï¼Œæˆ‘è¿˜æƒ³å†å¤šè¯´ä¸¤å¥ã€‚åœ¨è¿™èŠ‚è¯¾å¼€å¤´çš„åä¾‹ä¸­ï¼Œæˆ‘ä»¬åˆ†æäº†å¼€å‘è€…é‡‡ç”¨foreachè¯­å¥å¾ªç¯éå†åˆ†å¸ƒå¼æ•°æ®é›†çš„æ·±å±‚æ¬¡åŸå› ã€‚<strong>è¿™ç§ä¸å‡æ€ç´¢åœ°ç›´å…¥é¢å‘è¿‡ç¨‹ç¼–ç¨‹ã€å¿½ç•¥æˆ–æ— è§†åˆ†å¸ƒå¼æ•°æ®å®ä½“çš„ç¼–ç¨‹æ¨¡å¼ï¼Œæˆ‘å°†å…¶ç§°ä¸ºå•æœºæ€ç»´æ¨¡å¼</strong>ã€‚</p><p>åœ¨å­¦ä¹ äº†RDDæ¨ªå‘çš„partitionså±æ€§å’Œçºµå‘çš„dependencieså±æ€§ä¹‹åï¼Œå¦‚æœä½ èƒ½æŠŠå®ƒä»¬ç‰¢è®°äºå¿ƒï¼Œé‚£ä¹ˆåœ¨é¢‘ç¹è°ƒç”¨æˆ–å¼•ç”¨è¿™ä¸ªRDDä¹‹å‰ï¼Œä½ è‡ªç„¶ä¼šæƒ³åˆ°å®ƒæ‰€å›Šæ‹¬çš„æ•°æ®é›†åˆï¼Œå¾ˆæœ‰å¯èƒ½åœ¨å…¨èŠ‚ç‚¹èŒƒå›´å†…è¢«åå¤æ‰«æã€åå¤è®¡ç®—ã€‚è¿™ç§ä¸‹æ„è¯†çš„åæ€ä¼šé©±ä½¿ä½ å°è¯•æ¢ç´¢å…¶ä»–æ›´ä¼˜çš„å®ç°æ–¹å¼ï¼Œä»è€Œè·³å‡ºå•æœºæ€ç»´æ¨¡å¼ã€‚å› æ­¤ï¼Œ<strong>æ·±å…¥ç†è§£RDDï¼Œä¹Ÿæœ‰åˆ©äºä½ è·³å‡ºå•æœºæ€ç»´æ¨¡å¼ï¼Œé¿å…åœ¨åº”ç”¨ä»£ç ä¸­ç•™ä¸‹æ€§èƒ½éšæ‚£</strong>ã€‚</p><h2>å°ç»“</h2><p>ä»Šå¤©ï¼Œæˆ‘å¸¦ä½ å­¦ä¹ äº†RDDçš„é‡è¦æ€§ï¼Œä»¥åŠå®ƒçš„2å¤§æ ¸å¿ƒç‰¹æ€§å’Œ4å¤§å±æ€§ã€‚</p><p>é¦–å…ˆï¼Œæ·±å…¥ç†è§£RDDå¯¹å¼€å‘è€…æ¥è¯´æœ‰ç™¾åˆ©è€Œæ— ä¸€å®³ï¼ŒåŸå› æœ‰å¦‚ä¸‹3ç‚¹ï¼š</p><ul>\n<li>Sparkå¾ˆå¤šæ ¸å¿ƒæ¦‚å¿µéƒ½è¡ç”Ÿè‡ªRDDï¼Œå¼„æ‡‚RDDï¼Œæœ‰åˆ©äºä½ å…¨é¢åœ°å­¦ä¹ Sparkï¼›</li>\n<li>ç‰¢è®°RDDçš„å…³é”®ç‰¹æ€§å’Œæ ¸å¿ƒå±æ€§ï¼Œæœ‰åˆ©äºä½ åœ¨è¿è¡Œæ—¶æ›´å¥½åœ°å®šä½æ€§èƒ½ç“¶é¢ˆï¼Œè€Œç“¶é¢ˆå®šä½ï¼Œæ°æ°æ˜¯æ€§èƒ½è°ƒä¼˜çš„å‰æï¼›</li>\n<li><strong>æ·±å…¥ç†è§£RDDæœ‰åˆ©äºä½ è·³å‡ºå•æœºæ€ç»´æ¨¡å¼ï¼Œé¿å…åœ¨åº”ç”¨ä»£ç ä¸­ç•™ä¸‹æ€§èƒ½éšæ‚£ã€‚</strong></li>\n</ul><p>å…³äºRDDçš„ç‰¹æ€§ä¸æ ¸å¿ƒå±æ€§ï¼Œåªè¦ä½ æŠŠå¦‚ä¸‹2ç‚¹ç‰¢è®°äºå¿ƒï¼Œæˆ‘ç›¸ä¿¡åœ¨ä¸çŸ¥ä¸è§‰ä¸­ä½ è‡ªç„¶ä¼šç»•è¿‡å¾ˆå¤šæ€§èƒ½ä¸Šçš„å‘ï¼š</p><ul>\n<li>æ¨ªå‘å±æ€§partitionså’Œpartitioneré”šå®šæ•°æ®åˆ†ç‰‡å®ä½“ï¼Œå¹¶ä¸”è§„å®šäº†æ•°æ®åˆ†ç‰‡åœ¨åˆ†å¸ƒå¼é›†ç¾¤ä¸­å¦‚ä½•åˆ†å¸ƒï¼›</li>\n<li>çºµå‘å±æ€§dependencieså’Œcomputeç”¨äºåœ¨çºµæ·±æ–¹å‘æ„å»ºDAGï¼Œé€šè¿‡æä¾›é‡æ„RDDçš„å®¹é”™èƒ½åŠ›ä¿éšœå†…å­˜è®¡ç®—çš„ç¨³å®šæ€§ã€‚</li>\n</ul><h2>æ¯æ—¥ä¸€ç»ƒ</h2><ol>\n<li>\n<p>åœ¨æ—¥å¸¸çš„å¼€å‘å·¥ä½œä¸­ï¼Œä½ é‡åˆ°è¿‡â€œå•æœºæ€ç»´æ¨¡å¼â€å—ï¼Ÿæœ‰å“ªäº›å‘¢ï¼Ÿ</p>\n</li>\n<li>\n<p>é™¤äº†æˆ‘ä»¬ä»Šå¤©è®²çš„4å¤§å±æ€§ï¼ŒRDDè¿˜æœ‰ä¸ªå¾ˆé‡è¦çš„å±æ€§ï¼špreferredLocationsã€‚æŒ‰ç…§ç»éªŒï¼Œä½ è®¤ä¸ºåœ¨å“ªäº›æƒ…å†µä¸‹ï¼ŒpreferredLocationså¾ˆé‡è¦ï¼Œä¼šæå‡I/Oæ•ˆç‡ï¼Œåˆåœ¨å“ªäº›ç¯å¢ƒä¸­ä¸èµ·ä½œç”¨å‘¢ï¼Ÿä¸ºä»€ä¹ˆï¼Ÿ</p>\n</li>\n</ol><p>æœŸå¾…åœ¨ç•™è¨€åŒºçœ‹åˆ°ä½ çš„æ€è€ƒï¼Œä¹Ÿæ¬¢è¿ä½ åˆ†äº«å·¥ä½œä¸­é‡åˆ°è¿‡çš„â€œå•æœºæ€ç»´æ¨¡å¼â€ï¼Œæˆ‘ä»¬ä¸‹èŠ‚è¯¾è§ï¼</p>","neighbors":{"left":{"article_title":"02 | æ€§èƒ½è°ƒä¼˜çš„æœ¬è´¨ï¼šè°ƒä¼˜çš„æ‰‹æ®µäº”èŠ±å…«é—¨ï¼Œè¯¥ä»å“ªé‡Œå…¥æ‰‹ï¼Ÿ","id":352577},"right":{"article_title":"04 | DAGä¸æµæ°´çº¿ï¼šåˆ°åº•å•¥å«â€œå†…å­˜è®¡ç®—â€ï¼Ÿ","id":353808}},"comments":[{"had_liked":false,"id":284226,"user_name":"Shockang","can_delete":false,"product_type":"c1","uid":1263546,"ip_address":"","ucode":"B871D731F6E6B1","user_header":"https://static001.geekbang.org/account/avatar/00/13/47/ba/d36340c1.jpg","comment_is_top":false,"comment_ctime":1616127303,"is_pvip":false,"replies":[{"id":"103121","content":"ä¸é”™çš„æŠ€å·§ï½","user_name":"ä½œè€…å›å¤","user_name_real":"å´ç£Š","uid":"1043100","ctime":1616162293,"ip_address":"","comment_id":284226,"utype":1}],"discussion_count":1,"race_medal":0,"score":"212069524807","product_id":100073401,"comment_content":"RDDçš„5å¤§ç‰¹æ€§æ€»ç»“èµ·æ¥å°±æ˜¯ï¼š3ä¸ªåˆ—è¡¨ï¼Œ2ä¸ªå‡½æ•°ã€‚3ä¸ªåˆ—è¡¨æ˜¯åˆ†åŒºåˆ—è¡¨ï¼Œä¾èµ–åˆ—è¡¨å’Œä¼˜å…ˆä½ç½®åˆ—è¡¨ï¼›2ä¸ªå‡½æ•°å°±æ˜¯ï¼šè®¡ç®—å‡½æ•°å’Œåˆ†åŒºå‡½æ•°ã€‚æˆ‘è¿™æ ·æ€»ç»“æ˜¯ä¸ºäº†æ–¹ä¾¿è®°å¿†çš„ï¼Œåˆ†äº«ç»™å¤§å®¶ï¼","like_count":50,"discussions":[{"author":{"id":1043100,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/ea/9c/230061e7.jpg","nickname":"å´ç£Š","note":"","ucode":"136DC8CF1B10DC","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":517278,"discussion_content":"ä¸é”™çš„æŠ€å·§ï½","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1616162293,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":285432,"user_name":"Zå®‡é”¤é”¤","can_delete":false,"product_type":"c1","uid":2188142,"ip_address":"","ucode":"7DB36E986A7A51","user_header":"https://static001.geekbang.org/account/avatar/00/21/63/6e/6b971571.jpg","comment_is_top":false,"comment_ctime":1616812583,"is_pvip":true,"replies":[{"id":"103591","content":"66666666666666666 x 10çš„6æ¬¡å¹‚ï¼Œå…¨åœºä½ æœ€6ï½","user_name":"ä½œè€…å›å¤","user_name_real":"å´ç£Š","uid":"1043100","ctime":1616816666,"ip_address":"","comment_id":285432,"utype":1}],"discussion_count":3,"race_medal":0,"score":"78926223911","product_id":100073401,"comment_content":"RDDçš„å››å¤§ç‰¹æ€§ï¼šä¸¤æ¨ªä¸¤çºµä¸€æ¼‚ç§»ã€‚ä¸¤çºµåœŸè±†æ¯ä¸€ä¸ªç”Ÿäº§çº¿çš„æµè½¬å°±æ˜¯çˆ¶RDDåˆ°å­RDDçš„æµè½¬ï¼Œå…¶ä¸­çš„æµè½¬æ–¹æ³•å°±æ˜¯computeç®—å­ã€‚ä¸¤æ¨ªï¼šå°±æ˜¯åœŸè±†å’ŒåœŸè±†ç‰‡ä¹‹é—´çš„å·¥å…·ï¼Œåˆ‡å‡ºæ¥çš„åœŸè±†ç‰‡å°±æ˜¯partitions,æ€ä¹ˆåˆ‡åœŸè±†ç‰‡å°±æ˜¯partitonerã€‚æ¼‚ç§»å°±æ˜¯prefered location,é€‰æ‹©åœ¨å“ªä¸ªRDDä¸Šå–æ•°æ®ã€‚","like_count":19,"discussions":[{"author":{"id":1043100,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/ea/9c/230061e7.jpg","nickname":"å´ç£Š","note":"","ucode":"136DC8CF1B10DC","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":517673,"discussion_content":"66666666666666666 x 10çš„6æ¬¡å¹‚ï¼Œå…¨åœºä½ æœ€6ï½","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1616816666,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":2068627,"avatar":"https://static001.geekbang.org/account/avatar/00/1f/90/93/5e94be87.jpg","nickname":"é’æ„Ÿ","note":"","ucode":"50FE1DD4EAEB78","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":402503,"discussion_content":"ä¼˜ç§€è¯¾ä»£è¡¨ï¼ï¼ï¼","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1633886106,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1634643,"avatar":"http://thirdwx.qlogo.cn/mmopen/vi_32/JWSOxD8l9gLAcL1OL1hwSdXeibUfw56J9ngPxwrqOvibRT6zNuJR0oW3Vw4ymDGrua1xlWk7kOEEZZ7Ero44o8ibw/132","nickname":"Michealkz","note":"","ucode":"6DCD497FA5B3AA","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":363233,"discussion_content":"å¤§é”¤ğŸ‘","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1617153283,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":284751,"user_name":"sparkjoy","can_delete":false,"product_type":"c1","uid":1000179,"ip_address":"","ucode":"827B3116EED3B8","user_header":"https://static001.geekbang.org/account/avatar/00/0f/42/f3/e945e4ac.jpg","comment_is_top":false,"comment_ctime":1616460341,"is_pvip":false,"replies":[{"id":"103307","content":"æ­£è§£ï½","user_name":"ä½œè€…å›å¤","user_name_real":"å´ç£Š","uid":"1043100","ctime":1616474670,"ip_address":"","comment_id":284751,"utype":1}],"discussion_count":4,"race_medal":0,"score":"53156067893","product_id":100073401,"comment_content":"preferredLocationsä¸èµ·ä½œç”¨çš„åœºæ™¯æœ‰ä¸€ç§æ˜¯å­˜ç®—åˆ†ç¦»çš„åœºæ™¯ï¼Œè®¡ç®—èŠ‚ç‚¹åœ¨k8sé›†ç¾¤é‡Œï¼Œè¿œç¨‹è¯»å–åˆ†å¸ƒå¼æ–‡ä»¶ç³»ç»Ÿï¼Œä¾‹å¦‚hdfsæˆ–è€…cephç­‰ï¼Œå¯èƒ½æ¥å…¥ä¸‡å…†SDNç½‘ç»œèƒ½å¤Ÿæœ‰ä¸€äº›æ”¶ç›Š","like_count":13,"discussions":[{"author":{"id":1043100,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/ea/9c/230061e7.jpg","nickname":"å´ç£Š","note":"","ucode":"136DC8CF1B10DC","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":517454,"discussion_content":"æ­£è§£ï½","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1616474670,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1043100,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/ea/9c/230061e7.jpg","nickname":"å´ç£Š","note":"","ucode":"136DC8CF1B10DC","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":362598,"discussion_content":"èƒ½ä¿è¯node_localä»¥ä¸Šçš„çº§åˆ«ï¼Œå°±æ˜¯â€œæ•°æ®ä¸åŠ¨ä»£ç åŠ¨â€ï¼›ä¿è¯ä¸äº†ï¼Œå°±æ˜¯æ•°æ®åŠ¨\n","likes_number":3,"is_delete":false,"is_hidden":false,"ctime":1616989635,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1581245,"avatar":"https://static001.geekbang.org/account/avatar/00/18/20/bd/5656b5d7.jpg","nickname":"èµ°åˆ€å£ ğŸ’°","note":"","ucode":"C7E2B812A4A02C","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":362199,"discussion_content":"æ²¡ç†è§£ï¼Œå­˜ç®—åˆ†ç¦»ï¼Œæ„å‘³ç€æ•°æ®å‘è®¡ç®—ç§»åŠ¨ã€‚ä½ éœ€è¦å…ˆæŠŠhdfsçš„æ•°æ®è¯»åˆ°k8sé›†ç¾¤ä¸Šã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1616889633,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":2188142,"avatar":"https://static001.geekbang.org/account/avatar/00/21/63/6e/6b971571.jpg","nickname":"Zå®‡é”¤é”¤","note":"","ucode":"7DB36E986A7A51","race_medal":0,"user_type":1,"is_pvip":true},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":361957,"discussion_content":"é‚£è¿™æ ·å­ æ•°æ®ä¸å°±ç§»åŠ¨äº†ã€‚ã€‚æ²¡æœ‰ç§»åŠ¨è®¡ç®—ã€‚ã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1616812640,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":313353,"user_name":"sparkjoy","can_delete":false,"product_type":"c1","uid":1000179,"ip_address":"","ucode":"827B3116EED3B8","user_header":"https://static001.geekbang.org/account/avatar/00/0f/42/f3/e945e4ac.jpg","comment_is_top":false,"comment_ctime":1632387143,"is_pvip":false,"replies":[{"id":"113541","content":"å…¥å£å…¶å®éƒ½æ˜¯runJobï¼Œdriveré¦–å…ˆåˆ›å»ºå¹¶æäº¤æœ€åä¸€ä¸ªstageã€‚ç„¶åä¾æ¬¡å‘å‰å›æº¯ï¼Œè¾¹åˆ›å»ºstageè¾¹æäº¤ï¼Œç›´åˆ°æœ€å‰é¢çš„stageã€‚<br><br>å…·ä½“çš„ä»£ç è°ƒç”¨ï¼Œå¯ä»¥çœ‹çœ‹infoQçš„é‚£ç¯‡ã€ŠæƒåŠ›çš„æ¸¸æˆï¼šSparkè°ƒåº¦ç³»ç»Ÿã€‹ã€‚é“¾æ¥æˆ‘å›å¤´å¸®ä½ æœæœï¼Œé‚£ç¯‡ä»£ç è·¯å¾„å†™çš„éå¸¸æ¸…æ¥šï½<br><br>é“¾æ¥ï¼šhttps:&#47;&#47;www.infoq.cn&#47;article&#47;5aOHzQIaXX6NlHriLtSI","user_name":"ä½œè€…å›å¤","user_name_real":"å´ç£Š","uid":"1043100","ctime":1632484531,"ip_address":"","comment_id":313353,"utype":1}],"discussion_count":1,"race_medal":0,"score":"18812256327","product_id":100073401,"comment_content":"è€å¸ˆï¼Œsparkæ˜¯æƒ°æ€§è®¡ç®—ï¼Œactionç®—å­æ‰èƒ½çœŸæ­£è§¦å‘ç®—å­çš„è®¡ç®—é€»è¾‘ï¼Œé‚£ä¹ˆDAGï¼ˆrddçš„å®ä¾‹åŒ–ä»¥åŠdependencyå¯¹è±¡çš„åˆ›å»ºï¼‰æ˜¯ä»€ä¹ˆæ—¶å€™æ„å»ºçš„å‘¢ï¼Ÿæ²¡æ‰¾åˆ°DAGåˆ›å»ºçš„ä»£ç å…¥å£","like_count":5,"discussions":[{"author":{"id":1043100,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/ea/9c/230061e7.jpg","nickname":"å´ç£Š","note":"","ucode":"136DC8CF1B10DC","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":527323,"discussion_content":"å…¥å£å…¶å®éƒ½æ˜¯runJobï¼Œdriveré¦–å…ˆåˆ›å»ºå¹¶æäº¤æœ€åä¸€ä¸ªstageã€‚ç„¶åä¾æ¬¡å‘å‰å›æº¯ï¼Œè¾¹åˆ›å»ºstageè¾¹æäº¤ï¼Œç›´åˆ°æœ€å‰é¢çš„stageã€‚\n\nå…·ä½“çš„ä»£ç è°ƒç”¨ï¼Œå¯ä»¥çœ‹çœ‹infoQçš„é‚£ç¯‡ã€ŠæƒåŠ›çš„æ¸¸æˆï¼šSparkè°ƒåº¦ç³»ç»Ÿã€‹ã€‚é“¾æ¥æˆ‘å›å¤´å¸®ä½ æœæœï¼Œé‚£ç¯‡ä»£ç è·¯å¾„å†™çš„éå¸¸æ¸…æ¥šï½\n\né“¾æ¥ï¼šhttps://www.infoq.cn/article/5aOHzQIaXX6NlHriLtSI","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1632484531,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":298050,"user_name":"æ…¢æ…¢å¢","can_delete":false,"product_type":"c1","uid":1329566,"ip_address":"","ucode":"853D399100D83B","user_header":"http://thirdwx.qlogo.cn/mmopen/vi_32/IcDlyK6DaBrssVGlmosXnahdJ4bwCesjXa98iaapSDozBiagZTqSCok6iaktu2wOibvpNv9Pd6nfwMg7N7KTSTzYRw/132","comment_is_top":false,"comment_ctime":1623896777,"is_pvip":false,"replies":[{"id":"108251","content":"666ï¼Œæ²¡é”™ï¼Œå°±æ˜¯å®¹é”™èƒ½åŠ›~","user_name":"ä½œè€…å›å¤","user_name_real":"å´ç£Š","uid":"1043100","ctime":1624008498,"ip_address":"","comment_id":298050,"utype":1}],"discussion_count":1,"race_medal":0,"score":"14508798665","product_id":100073401,"comment_content":"è¯»äº†ä¸¤éï¼Œå¼€å§‹ä¸å¤ªç†è§£å®¹é”™å’ŒResilient æœ‰ä»€ä¹ˆå…³ç³»ï¼Œè¯»äº†ä¸¤éï¼Œæœ‰ç‚¹æ„Ÿè§‰äº†ï¼šå¼¹æ€§æè¿°ç‰©ä½“åœ¨å‹ç¼©å’Œæ‹‰ä¼¸ä¹‹åå…·å¤‡æ¢å¤åŸçŠ¶çš„èƒ½åŠ›ã€‚ç±»æ¯”RDDï¼Œrddå› ä¸ºä¾èµ–å’Œcomputeï¼Œå…·å¤‡äº†é”™è¯¯æ¢å¤èƒ½åŠ›ï¼ŒæŠŠè¿™ä¸ªæ€§è´¨ç§°ä¹‹ä¸ºå¼¹æ€§ã€‚","like_count":4,"discussions":[{"author":{"id":1043100,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/ea/9c/230061e7.jpg","nickname":"å´ç£Š","note":"","ucode":"136DC8CF1B10DC","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":522000,"discussion_content":"666ï¼Œæ²¡é”™ï¼Œå°±æ˜¯å®¹é”™èƒ½åŠ›~","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1624008498,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":285547,"user_name":"èµ°åˆ€å£ ğŸ’°","can_delete":false,"product_type":"c1","uid":1581245,"ip_address":"","ucode":"C7E2B812A4A02C","user_header":"https://static001.geekbang.org/account/avatar/00/18/20/bd/5656b5d7.jpg","comment_is_top":false,"comment_ctime":1616890355,"is_pvip":false,"replies":[{"id":"103658","content":"æ˜¯çš„ï¼Œä¸èƒ½å•çº¯æ ¹æ®åˆ†åŒºæ•°å®Œæˆåˆ¤æ–­ã€‚<br><br>çœ‹ç®—å­ï¼Œåˆ†ç±»è®¨è®ºã€‚ä¸€ç±»ç®—å­ä¼šç›´æ¥è®°å½•å®½çª„ä¾èµ–å…³ç³»ï¼Œå¦ä¸€ç±»ç®—å­é€šè¿‡åˆ¤æ–­partitionerä¸çˆ¶ä¾èµ–æ˜¯å¦ä¸€è‡´æ¥å†³å®šã€‚<br><br>ä½ å¯ä»¥åœ¨æºç çš„RDDç›®å½•ä¸‹æŸ¥ä¸€æŸ¥ï¼Œå“ªäº›ç®—å­å±äºç¬¬ä¸€ç±»ï¼Œå“ªäº›å±äºç¬¬äºŒç±»ï½","user_name":"ä½œè€…å›å¤","user_name_real":"å´ç£Š","uid":"1043100","ctime":1616979436,"ip_address":"","comment_id":285547,"utype":1}],"discussion_count":1,"race_medal":0,"score":"14501792243","product_id":100073401,"comment_content":"è€å¸ˆï¼Œè¯·æ•™ä¸ªé—®é¢˜ï¼Œå…³äºå®½çª„ä¾èµ–åˆ’åˆ†ã€‚ç½‘ä¸Šå¾ˆå¤šæ–‡ç« æ˜¯æ ¹æ®çˆ¶å­rddåˆ†åŒºæ•°é‡åˆ’åˆ†çš„ï¼Œä½†æˆ‘è¿™æ ·ä¸å¯¹ã€‚æ¯”å¦‚cartsianç®—å­ï¼Œå®ƒçˆ¶rddä¸€ä¸ªåˆ†åŒºå¯¹åº”å­rddå¤šä¸ªåˆ†åŒºï¼Œå¯å®ƒæ˜¯çª„ä¾èµ–ã€‚<br>å®½çª„ä¾èµ–åˆ’åˆ†ä¾æ®åˆ°åº•æ˜¯å•¥ï¼Ÿ","like_count":3,"discussions":[{"author":{"id":1043100,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/ea/9c/230061e7.jpg","nickname":"å´ç£Š","note":"","ucode":"136DC8CF1B10DC","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":517706,"discussion_content":"æ˜¯çš„ï¼Œä¸èƒ½å•çº¯æ ¹æ®åˆ†åŒºæ•°å®Œæˆåˆ¤æ–­ã€‚\n\nçœ‹ç®—å­ï¼Œåˆ†ç±»è®¨è®ºã€‚ä¸€ç±»ç®—å­ä¼šç›´æ¥è®°å½•å®½çª„ä¾èµ–å…³ç³»ï¼Œå¦ä¸€ç±»ç®—å­é€šè¿‡åˆ¤æ–­partitionerä¸çˆ¶ä¾èµ–æ˜¯å¦ä¸€è‡´æ¥å†³å®šã€‚\n\nä½ å¯ä»¥åœ¨æºç çš„RDDç›®å½•ä¸‹æŸ¥ä¸€æŸ¥ï¼Œå“ªäº›ç®—å­å±äºç¬¬ä¸€ç±»ï¼Œå“ªäº›å±äºç¬¬äºŒç±»ï½","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1616979436,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":315421,"user_name":"é’æ„Ÿ","can_delete":false,"product_type":"c1","uid":2068627,"ip_address":"","ucode":"50FE1DD4EAEB78","user_header":"https://static001.geekbang.org/account/avatar/00/1f/90/93/5e94be87.jpg","comment_is_top":false,"comment_ctime":1633886388,"is_pvip":false,"replies":[{"id":"114408","content":"å“ˆå“ˆï¼Œä¸€èµ·åŠ æ²¹~","user_name":"ä½œè€…å›å¤","user_name_real":"å´ç£Š","uid":"1043100","ctime":1633961929,"ip_address":"","comment_id":315421,"utype":1}],"discussion_count":1,"race_medal":0,"score":"10223820980","product_id":100073401,"comment_content":"åˆšå¼€å§‹å¬çš„æ—¶å€™ï¼šâ€œä»€ä¹ˆåœŸè±†å·¥åŠï¼Ÿä»€ä¹ˆåœŸè±†ç‰‡ï¼Œä»€ä¹ˆå½¢æ€ï¼Œä»€ä¹ˆæµæ°´çº¿ï¼Œä»€ä¹ˆåŠ å·¥æ–¹æ³•ï¼Ÿâ€è¿™éƒ½æ˜¯å•¥å•Šã€‚ã€‚å†å¾€åå¬ï¼Œæˆ‘çš„å¤©ï¼ï¼è¿™å½¢å®¹æ¯”å–»ä¹Ÿå¤ªè´´åˆ‡äº†å§ï¼ï¼ğŸ‘ï¼Œè™½ç„¶å·²æ˜¯æ·±å¤œï¼Œä½†è¿˜æ˜¯ä»åºŠä¸Šèµ·äº†èµ·æ¥ï¼Œè¾¹åƒè–¯ç‰‡è¾¹å¬ï¼Œæˆ‘è¦å¬ä¸€å®¿ï¼Œæˆ‘è¦å­¦ä¹ ï¼ï¼ï¼ğŸ™ˆ","like_count":2,"discussions":[{"author":{"id":1043100,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/ea/9c/230061e7.jpg","nickname":"å´ç£Š","note":"","ucode":"136DC8CF1B10DC","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":527970,"discussion_content":"å“ˆå“ˆï¼Œä¸€èµ·åŠ æ²¹~","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1633961929,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":285431,"user_name":"Zå®‡é”¤é”¤","can_delete":false,"product_type":"c1","uid":2188142,"ip_address":"","ucode":"7DB36E986A7A51","user_header":"https://static001.geekbang.org/account/avatar/00/21/63/6e/6b971571.jpg","comment_is_top":false,"comment_ctime":1616812173,"is_pvip":true,"replies":[{"id":"103592","content":"å¯ä»¥çš„ï¼Œç›¸å½“ç²¾è¾Ÿï½","user_name":"ä½œè€…å›å¤","user_name_real":"å´ç£Š","uid":"1043100","ctime":1616816782,"ip_address":"","comment_id":285431,"utype":1}],"discussion_count":2,"race_medal":0,"score":"10206746765","product_id":100073401,"comment_content":"# å…³äºRDDçš„å•æœºæ€ç»´æ¨¡å¼<br>## RDDä¸­çš„é›†åˆæ’åºé—®é¢˜<br>RDD.collect.sort<br>","like_count":2,"discussions":[{"author":{"id":1043100,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/ea/9c/230061e7.jpg","nickname":"å´ç£Š","note":"","ucode":"136DC8CF1B10DC","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":517672,"discussion_content":"å¯ä»¥çš„ï¼Œç›¸å½“ç²¾è¾Ÿï½","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1616816782,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":2068627,"avatar":"https://static001.geekbang.org/account/avatar/00/1f/90/93/5e94be87.jpg","nickname":"é’æ„Ÿ","note":"","ucode":"50FE1DD4EAEB78","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":402504,"discussion_content":"è¿˜æ˜¯ä½ ï¼Œè¯¾ä»£è¡¨å°±ä½ æ¥å½“å§ğŸ‘","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1633886604,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":284361,"user_name":"zxk","can_delete":false,"product_type":"c1","uid":1221195,"ip_address":"","ucode":"4BB2BD9D2BCD04","user_header":"https://static001.geekbang.org/account/avatar/00/12/a2/4b/b72f724f.jpg","comment_is_top":false,"comment_ctime":1616211724,"is_pvip":false,"replies":[{"id":"103153","content":"æ­£è§£ï¼Œèƒ½ä¸¾ä¾‹è¯´æ˜å—ï¼Ÿ","user_name":"ä½œè€…å›å¤","user_name_real":"å´ç£Š","uid":"1043100","ctime":1616283516,"ip_address":"","comment_id":284361,"utype":1}],"discussion_count":3,"race_medal":0,"score":"10206146316","product_id":100073401,"comment_content":"preferredLocationsï¼Œä½œä¸šå°½å¯èƒ½åœ¨åœ¨æ•°æ®æ‰€åœ¨èŠ‚ç‚¹ä¸Šè¿è¡Œï¼Œæˆ–è€…åŒä¸ªæœºæ¶ä¸‹ç­‰æƒ…å†µï¼Œéƒ½å¯ä»¥æå‡ I&#47;O æ•ˆç‡ã€‚<br>å½“æ•°æ®ä¸ç®¡è½åœ¨å“ªä¸ªèŠ‚ç‚¹ï¼Œéƒ½éœ€è¦ä»è¿œç«¯æ‹‰å–æ•°æ®æ—¶ï¼Œè¿™æ—¶å€™ä½œç”¨å¯èƒ½å°±ä¸æ˜¯é‚£ä¹ˆå¤§ã€‚","like_count":2,"discussions":[{"author":{"id":1043100,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/ea/9c/230061e7.jpg","nickname":"å´ç£Š","note":"","ucode":"136DC8CF1B10DC","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":517319,"discussion_content":"æ­£è§£ï¼Œèƒ½ä¸¾ä¾‹è¯´æ˜å—ï¼Ÿ","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1616283516,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1043100,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/ea/9c/230061e7.jpg","nickname":"å´ç£Š","note":"","ucode":"136DC8CF1B10DC","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":360925,"discussion_content":"ç®—çš„ï¼Œä¸è¿‡ç°åœ¨kafkaå’Œsparkä¹Ÿå¯ä»¥åœ¨ç‰©ç†ä¸Šshareä¸€ä¸ªé›†ç¾¤ï¼Œåœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œnode_localè¿˜æ˜¯å¯ä»¥æœ‰çš„å“ˆ~ å„è‡ªç‹¬ç«‹éƒ¨ç½²çš„è¯ï¼Œå°±æ²¡åŠæ³•ä¿è¯node_locaçš„æœ¬åœ°æ€§äº†","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1616557938,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1137879,"avatar":"https://static001.geekbang.org/account/avatar/00/11/5c/d7/e4673fde.jpg","nickname":"October","note":"","ucode":"CEDA78F4A5F8B1","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":360766,"discussion_content":"spark streaming è¿kafkaç®—ä¸€ä¸ªä¾‹å­å—","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1616512636,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":284252,"user_name":"L3nvy","can_delete":false,"product_type":"c1","uid":1271157,"ip_address":"","ucode":"0B74B27C121D56","user_header":"https://static001.geekbang.org/account/avatar/00/13/65/75/f9d7e8b7.jpg","comment_is_top":false,"comment_ctime":1616140069,"is_pvip":false,"replies":[{"id":"103120","content":"1. ç®—çš„ï¼Œéå¸¸å¥½çš„å•æœºæ€ç»´æ¡ˆä¾‹ï¼Œå‡¡æ˜¯ä¸Šæ¥å°±é¢å‘è¿‡ç¨‹ï¼ŒæŠŠåˆ†å¸ƒå¼æ•°æ®é›†rddã€dataframeã€datasetå½“æˆæ™®é€šå•æœºå˜é‡çš„ï¼Œéƒ½æ˜¯å•æœºæ€ç»´çš„ä¸€ç§è¡¨ç°ã€‚ä¸åœçš„è°ƒactionï¼Œæˆ‘æ€€ç–‘æ˜¯æƒ³è¿«åˆ‡åœ°çœ‹åˆ°è®¡ç®—ç»“æœï¼Œå¿½ç•¥äº†actionä¼šè§¦å‘dagå›æº¯ã€‚<br><br>2.æ²¡é”™ï¼é€šè¿‡jdbcè¿œç¨‹è®¿é—®dbé€šå¸¸æ²¡åŠæ³•ä¿è¯æœ¬åœ°æ€§ï¼Œæ²¿ç€è®¡ç®—å’Œå­˜å‚¨åˆ†ç¦»çš„æ€è·¯ï¼Œå†æƒ³ä¸€æƒ³ï¼Œè¿˜æœ‰å…¶ä»–æ¡ˆä¾‹å—ï¼Ÿ","user_name":"ä½œè€…å›å¤","user_name_real":"å´ç£Š","uid":"1043100","ctime":1616162259,"ip_address":"","comment_id":284252,"utype":1}],"discussion_count":8,"race_medal":0,"score":"10206074661","product_id":100073401,"comment_content":"1. â€œå•æœºæ¨¡å¼â€ï¼Œä¸çŸ¥é“ç®—ä¸ç®—ã€‚ä¸çŸ¥é“Sparkå¯ä»¥å¼€å¤šçº¿ç¨‹è§¦å‘actionç®—å­ï¼ŒåŒæ—¶æäº¤å¤šä¸ªä¸ç›¸å…³çš„ä½œä¸šï¼ŒSpark UIåŒæ—¶è¿è¡Œçš„jobæ‹‰æ»¡ : )ã€‚ä¹‹å‰ä»£ç éƒ½æ˜¯æŒ‰é¢å‘è¿‡ç¨‹çš„æ€ç»´ä¸€æ­¥ä¸€æ­¥å†™çš„ã€‚<br>2. å¤„ç†æ•°æ®æºçš„æ—¶å€™ï¼Œjdbcï¼Œè¯»å–æœ¬åœ°æ–‡ä»¶ä¸èµ·ä½œç”¨<br>","like_count":2,"discussions":[{"author":{"id":1043100,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/ea/9c/230061e7.jpg","nickname":"å´ç£Š","note":"","ucode":"136DC8CF1B10DC","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":517286,"discussion_content":"1. ç®—çš„ï¼Œéå¸¸å¥½çš„å•æœºæ€ç»´æ¡ˆä¾‹ï¼Œå‡¡æ˜¯ä¸Šæ¥å°±é¢å‘è¿‡ç¨‹ï¼ŒæŠŠåˆ†å¸ƒå¼æ•°æ®é›†rddã€dataframeã€datasetå½“æˆæ™®é€šå•æœºå˜é‡çš„ï¼Œéƒ½æ˜¯å•æœºæ€ç»´çš„ä¸€ç§è¡¨ç°ã€‚ä¸åœçš„è°ƒactionï¼Œæˆ‘æ€€ç–‘æ˜¯æƒ³è¿«åˆ‡åœ°çœ‹åˆ°è®¡ç®—ç»“æœï¼Œå¿½ç•¥äº†actionä¼šè§¦å‘dagå›æº¯ã€‚\n\n2.æ²¡é”™ï¼é€šè¿‡jdbcè¿œç¨‹è®¿é—®dbé€šå¸¸æ²¡åŠæ³•ä¿è¯æœ¬åœ°æ€§ï¼Œæ²¿ç€è®¡ç®—å’Œå­˜å‚¨åˆ†ç¦»çš„æ€è·¯ï¼Œå†æƒ³ä¸€æƒ³ï¼Œè¿˜æœ‰å…¶ä»–æ¡ˆä¾‹å—ï¼Ÿ","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1616162259,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1271157,"avatar":"https://static001.geekbang.org/account/avatar/00/13/65/75/f9d7e8b7.jpg","nickname":"L3nvy","note":"","ucode":"0B74B27C121D56","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":361003,"discussion_content":"pythonæè¿°ä¸‹\nrddList: List[RDD]\nexecutor = ThreadPoolExecutor()\nfor rdd in rddList:\n    executor.submit(lambda rdd: rdd.count(), rdd)\n\nç±»ä¼¼è¿™æ ·å¼€çº¿ç¨‹å»æäº¤ï¼Œdriverç«¯çš„ä»£ç ç»§ç»­å¾€ä¸‹æ‰§è¡Œï¼Œç»§ç»­è§¦å‘actionç®—å­æäº¤ä½œä¸š","likes_number":1,"is_delete":false,"is_hidden":false,"ctime":1616577361,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":2,"child_discussions":[{"author":{"id":1043100,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/ea/9c/230061e7.jpg","nickname":"å´ç£Š","note":"","ucode":"136DC8CF1B10DC","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":1271157,"avatar":"https://static001.geekbang.org/account/avatar/00/13/65/75/f9d7e8b7.jpg","nickname":"L3nvy","note":"","ucode":"0B74B27C121D56","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":362596,"discussion_content":"ç®€ç›´å¤ªç²¾é«“äº†ï¼è¶…çº§å…¸å‹çš„å•æœºæ€ç»´ï¼Œè¿™ä¸ªä¾‹å­ç®€ç›´å¤ªè´´åˆ‡äº†ï¼","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1616989510,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":361003,"ip_address":""},"score":362596,"extra":""},{"author":{"id":2028277,"avatar":"https://static001.geekbang.org/account/avatar/00/1e/f2/f5/b82f410d.jpg","nickname":"Unknown element","note":"","ucode":"34A129800D0238","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":1271157,"avatar":"https://static001.geekbang.org/account/avatar/00/13/65/75/f9d7e8b7.jpg","nickname":"L3nvy","note":"","ucode":"0B74B27C121D56","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":534420,"discussion_content":"ä½ å¥½ è¯·é—®ä¸ºä»€ä¹ˆè¯´è¿™ä¸ªä¾‹å­æ˜¯å•æœºæ¨¡å¼çš„å†™æ³•å‘¢","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1638185053,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":361003,"ip_address":""},"score":534420,"extra":""}]},{"author":{"id":2431882,"avatar":"https://thirdwx.qlogo.cn/mmopen/vi_32/DYAIOgq83epKgrcbDrMyBJjITP9YabicyialvkVzgPqIyQGNIW8U8EZsJZsw9bHrotkkBEEMjicUWv7jictZZDgLvA/132","nickname":"Geek_1ea676","note":"","ucode":"C95D2F6044ED30","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":371875,"discussion_content":"å¤§ä½¬ï¼Œä½ å¥½ï¼Œ2.jdbcï¼Œè¯»å–æœ¬åœ°æ–‡ä»¶ä¸èµ·ä½œç”¨ï¼Œå¯ä»¥å±•å¼€è®²è®²å—ï¼Ÿä¸ºä»€ä¹ˆjdbcè¯»å–æœ¬åœ°æ–‡ä»¶ä¼šä¸èµ·ä½œç”¨ï¼Ÿ","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1620031878,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":1,"child_discussions":[{"author":{"id":1043100,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/ea/9c/230061e7.jpg","nickname":"å´ç£Š","note":"","ucode":"136DC8CF1B10DC","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":2431882,"avatar":"https://thirdwx.qlogo.cn/mmopen/vi_32/DYAIOgq83epKgrcbDrMyBJjITP9YabicyialvkVzgPqIyQGNIW8U8EZsJZsw9bHrotkkBEEMjicUWv7jictZZDgLvA/132","nickname":"Geek_1ea676","note":"","ucode":"C95D2F6044ED30","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":377038,"discussion_content":"æˆ‘ä¹‹å‰çœ‹é”™äº†ï¼Œåº”è¯¥æ˜¯ï¼šé€šè¿‡jdbcè¿œç¨‹è®¿é—®dbé€šå¸¸æ²¡åŠæ³•ä¿è¯æœ¬åœ°æ€§ï¼›ä½†æ˜¯è¯»å–æœ¬åœ°æ–‡ä»¶æ˜¯å¯ä»¥çš„ï¼Œä¹‹å‰æ²¡çœ‹åˆ°â€œæœ¬åœ°æ–‡ä»¶â€è¿™å‡ ä¸ªå­—ï¼Œä¸€çœ‹åˆ°jdbcå°±å…ˆå…¥ä¸ºä¸»åœ°æƒ³åˆ°è¿œç¨‹è¯»å–æ•°æ®åº“ï¼Œæˆ‘çš„é”…~","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1622470912,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":371875,"ip_address":""},"score":377038,"extra":""}]},{"author":{"id":2536938,"avatar":"https://static001.geekbang.org/account/avatar/00/26/b5/ea/c3c5753f.jpg","nickname":"ImSoo","note":"","ucode":"6A5F66C323E9CF","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":360999,"discussion_content":"æƒ³é—®ä¸€ä¸‹ï¼Œâ€œSparkå¯ä»¥å¼€å¤šçº¿ç¨‹è§¦å‘actionç®—å­â€è¿™å¥è¯æ€ä¹ˆç†è§£ï¼Œä¸å¤ªæ˜ç™½","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1616577009,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":1,"child_discussions":[{"author":{"id":1271157,"avatar":"https://static001.geekbang.org/account/avatar/00/13/65/75/f9d7e8b7.jpg","nickname":"L3nvy","note":"","ucode":"0B74B27C121D56","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":2536938,"avatar":"https://static001.geekbang.org/account/avatar/00/26/b5/ea/c3c5753f.jpg","nickname":"ImSoo","note":"","ucode":"6A5F66C323E9CF","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":361015,"discussion_content":"î˜\n\npythonæè¿°ä¸‹\nrddList: List[RDD]\nexecutor = ThreadPoolExecutor()\nfor rdd in rddList:\nÂ Â Â Â executor.submit(lambda rdd: rdd.count(), rdd)\n\nç±»ä¼¼è¿™æ ·å¼€çº¿ç¨‹å»æäº¤ï¼Œdriverç«¯çš„ä»£ç ç»§ç»­å¾€ä¸‹æ‰§è¡Œï¼Œç»§ç»­è§¦å‘actionç®—å­æäº¤ä½œä¸š","likes_number":1,"is_delete":false,"is_hidden":false,"ctime":1616580129,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":360999,"ip_address":""},"score":361015,"extra":""}]}]},{"had_liked":false,"id":286167,"user_name":"æ—å»ºæ—","can_delete":false,"product_type":"c1","uid":2531593,"ip_address":"","ucode":"FE0CAF61D12708","user_header":"","comment_is_top":false,"comment_ctime":1617175102,"is_pvip":false,"replies":[{"id":"103897","content":"å¯¹ï¼Œæ˜¯è¿™ä¸ªé“ç†ï¼Œä¸è¿‡è¦è€ƒè™‘ï¼Œæœ‰äº›æƒ…å†µï¼Œå¯ä»¥æ•°æ®ä¸åŠ¨ä»£ç åŠ¨ï¼Œæœ‰äº›æƒ…å†µï¼Œå°±å¿…é¡»è¦åŠ¨æ•°æ®äº†ã€‚è¿™ä¹Ÿæ˜¯è¿™ä¸ªé—®é¢˜æƒ³è¦å¤§å®¶å»æ·±å…¥æ€è€ƒçš„ï¼Œè¦åˆ†ç±»è®¨è®ºã€‚","user_name":"ä½œè€…å›å¤","user_name_real":"å´ç£Š","uid":"1043100","ctime":1617239263,"ip_address":"","comment_id":286167,"utype":1}],"discussion_count":1,"race_medal":0,"score":"5912142398","product_id":100073401,"comment_content":"preferredLocationsï¼šå¯ä»¥ç†è§£ä¸ºæœ€ä½³ä½ç½®ï¼Œç§»åŠ¨è®¡ç®—ä¸ç§»åŠ¨æ•°æ®ï¼Œæ•°æ®åœ¨å“ªå°±åœ¨å“ªè®¡ç®—ï¼Œå‡å°‘IO","like_count":1,"discussions":[{"author":{"id":1043100,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/ea/9c/230061e7.jpg","nickname":"å´ç£Š","note":"","ucode":"136DC8CF1B10DC","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":517890,"discussion_content":"å¯¹ï¼Œæ˜¯è¿™ä¸ªé“ç†ï¼Œä¸è¿‡è¦è€ƒè™‘ï¼Œæœ‰äº›æƒ…å†µï¼Œå¯ä»¥æ•°æ®ä¸åŠ¨ä»£ç åŠ¨ï¼Œæœ‰äº›æƒ…å†µï¼Œå°±å¿…é¡»è¦åŠ¨æ•°æ®äº†ã€‚è¿™ä¹Ÿæ˜¯è¿™ä¸ªé—®é¢˜æƒ³è¦å¤§å®¶å»æ·±å…¥æ€è€ƒçš„ï¼Œè¦åˆ†ç±»è®¨è®ºã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1617239263,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":285310,"user_name":"Insomnia","can_delete":false,"product_type":"c1","uid":1751214,"ip_address":"","ucode":"5986A48988D6E3","user_header":"https://static001.geekbang.org/account/avatar/00/1a/b8/ae/085484e7.jpg","comment_is_top":false,"comment_ctime":1616733001,"is_pvip":false,"replies":[{"id":"103562","content":"æ²¡é”™ï¼Œç†è§£çš„éå¸¸åˆ°ä½ï¼æœ¬è´¨ä¸Šå°±æ˜¯è¿™ä¹ˆä¸ªè¿‡ç¨‹ã€‚<br><br>å½“ç„¶yarnä¹Ÿæœ‰yarn clientå’Œyarn clusteræ¨¡å¼å“ˆï¼Œä¸è¿‡æœ¬è´¨ä¸ŠåŒºåˆ«ä¸å¤§ï¼Œæ— éæ˜¯app master &#47; driveræ”¾å“ªçš„é—®é¢˜ï¼Œéƒ½é€‚ç”¨ä½ è¯´çš„é‚£ä¸ªè¿‡ç¨‹ã€‚","user_name":"ä½œè€…å›å¤","user_name_real":"å´ç£Š","uid":"1043100","ctime":1616758215,"ip_address":"","comment_id":285310,"utype":1}],"discussion_count":1,"race_medal":0,"score":"5911700297","product_id":100073401,"comment_content":"è€å¸ˆ, æˆ‘è¿™ä¹ˆç†è§£ä¸çŸ¥é“å¯¹ä¸å¯¹? <br>å½“ä¸‹æ¯”è¾ƒæµè¡Œçš„è®¡ç®—æ¡†æ¶ Spark&#47;Flink, å¦‚æœä½¿ç”¨ Yarn æ¥è°ƒåº¦è®¡ç®—ä»»åŠ¡, å¯¹äº Yarn è€Œè¨€, æœ¬åœ°çš„ Spark&#47;Flink éƒ½å¯ä»¥çœ‹ä½œæ˜¯ Yarn çš„å®¢æˆ·ç«¯, è€Œå¯¹äºç”¨æˆ·è€Œè¨€, ç¼–å†™çš„ job éƒ½å¯ä»¥çœ‹åšæ˜¯æœ¬åœ°çš„ Spark&#47;Flink çš„å®¢æˆ·ç«¯,  ä»–ä»¬å…±åŒçš„æœ¬è´¨éƒ½æ˜¯ä½¿ç”¨æœ¬åœ° Spark&#47;Flink, å°†ç”¨æˆ·çš„ job è§£æå¹¶ä¼˜åŒ–æˆç‰©ç†æ‰§è¡Œè®¡åˆ’, ç„¶åæäº¤åˆ° Yarn ä¸Šéƒ¨ç½²æ‰§è¡Œ","like_count":1,"discussions":[{"author":{"id":1043100,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/ea/9c/230061e7.jpg","nickname":"å´ç£Š","note":"","ucode":"136DC8CF1B10DC","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":517641,"discussion_content":"æ²¡é”™ï¼Œç†è§£çš„éå¸¸åˆ°ä½ï¼æœ¬è´¨ä¸Šå°±æ˜¯è¿™ä¹ˆä¸ªè¿‡ç¨‹ã€‚\n\nå½“ç„¶yarnä¹Ÿæœ‰yarn clientå’Œyarn clusteræ¨¡å¼å“ˆï¼Œä¸è¿‡æœ¬è´¨ä¸ŠåŒºåˆ«ä¸å¤§ï¼Œæ— éæ˜¯app master / driveræ”¾å“ªçš„é—®é¢˜ï¼Œéƒ½é€‚ç”¨ä½ è¯´çš„é‚£ä¸ªè¿‡ç¨‹ã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1616758215,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":285191,"user_name":"Geek_d794f8","can_delete":false,"product_type":"c1","uid":2485585,"ip_address":"","ucode":"1E20DA4FF8B800","user_header":"https://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTIiaeebUYxl7e4jicPshDRKMbiculHUjKgZZ2ygDibn2S7bbsjeqYIdsEUdVyoryKNa43ZGnDQmWjv3ibQ/132","comment_is_top":false,"comment_ctime":1616661846,"is_pvip":false,"replies":[{"id":"103475","content":"åè¿‡æ¥è¯´å¯èƒ½æ›´åˆé€‚ï¼Œä½ æœ‰ä¸ªyarné›†ç¾¤ï¼Œé‚£ä¹ˆå°±å¯ä»¥æ‹¿æ¥ç»™sparkåº”ç”¨è°ƒåº¦èµ„æºï¼Œç”šè‡³ä¸éœ€è¦é¢å¤–éƒ¨ç½²ä»€ä¹ˆâ€œsparkâ€é›†ç¾¤ã€‚ä¸€èˆ¬è¯´sparké›†ç¾¤ï¼Œé€šå¸¸æŒ‡çš„æ˜¯å·¥ä½œåœ¨standaloneè°ƒåº¦æ¨¡å¼ä¸‹çš„é›†ç¾¤ã€‚å½“ç„¶ï¼Œå¦‚æœä½ æœ¬èº«æœ‰ä¸€ä¸ªstandaloneçš„sparké›†ç¾¤ï¼Œæƒ³æ¢ç”¨yarnåšèµ„æºè°ƒåº¦ï¼Œé‚£ä¹ˆå°±åƒä½ è¯´çš„ï¼Œyarnè¦å’Œsparkéƒ¨ç½²åœ¨åŒä¸€ä¸ªé›†ç¾¤ã€‚","user_name":"ä½œè€…å›å¤","user_name_real":"å´ç£Š","uid":"1043100","ctime":1616672383,"ip_address":"","comment_id":285191,"utype":1}],"discussion_count":1,"race_medal":0,"score":"5911629142","product_id":100073401,"comment_content":"è€å¸ˆï¼Œå¦‚æœè®¡ç®—å’Œå­˜å‚¨åˆ†ç¦»ï¼Œæ¯”å¦‚è®¡ç®—é›†ç¾¤Aï¼Œå­˜å‚¨é›†ç¾¤Bï¼Œä¸”sparkè®¡ç®—åŸºäºyarnè°ƒåº¦ï¼Œé‚£ä¹ˆæ˜¯ä¸æ˜¯ï¼Œyarné›†ç¾¤å¿…é¡»éƒ¨ç½²åœ¨é›†ç¾¤Aä¸Šï¼Ÿ","like_count":1,"discussions":[{"author":{"id":1043100,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/ea/9c/230061e7.jpg","nickname":"å´ç£Š","note":"","ucode":"136DC8CF1B10DC","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":517610,"discussion_content":"åè¿‡æ¥è¯´å¯èƒ½æ›´åˆé€‚ï¼Œä½ æœ‰ä¸ªyarné›†ç¾¤ï¼Œé‚£ä¹ˆå°±å¯ä»¥æ‹¿æ¥ç»™sparkåº”ç”¨è°ƒåº¦èµ„æºï¼Œç”šè‡³ä¸éœ€è¦é¢å¤–éƒ¨ç½²ä»€ä¹ˆâ€œsparkâ€é›†ç¾¤ã€‚ä¸€èˆ¬è¯´sparké›†ç¾¤ï¼Œé€šå¸¸æŒ‡çš„æ˜¯å·¥ä½œåœ¨standaloneè°ƒåº¦æ¨¡å¼ä¸‹çš„é›†ç¾¤ã€‚å½“ç„¶ï¼Œå¦‚æœä½ æœ¬èº«æœ‰ä¸€ä¸ªstandaloneçš„sparké›†ç¾¤ï¼Œæƒ³æ¢ç”¨yarnåšèµ„æºè°ƒåº¦ï¼Œé‚£ä¹ˆå°±åƒä½ è¯´çš„ï¼Œyarnè¦å’Œsparkéƒ¨ç½²åœ¨åŒä¸€ä¸ªé›†ç¾¤ã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1616672383,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":343287,"user_name":"é¢å¯¹ç–¾é£å§","can_delete":false,"product_type":"c1","uid":1340357,"ip_address":"","ucode":"6BEBC7CAC7C45A","user_header":"https://static001.geekbang.org/account/avatar/00/14/73/c5/d0880e7a.jpg","comment_is_top":false,"comment_ctime":1650763558,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1650763558","product_id":100073401,"comment_content":"Rdd ç‰¹æ€§ï¼Œåˆ†å¸ƒå¼ã€å®¹é”™æ€§å¼¹æ€§ã€è®¡ç®—é è¿‘å­˜å‚¨","like_count":0},{"had_liked":false,"id":338527,"user_name":"Stony.ä¿®è¡Œåƒ§","can_delete":false,"product_type":"c1","uid":1061277,"ip_address":"","ucode":"0F2368F7D93E4A","user_header":"https://static001.geekbang.org/account/avatar/00/10/31/9d/daad92d2.jpg","comment_is_top":false,"comment_ctime":1647550118,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1647550118","product_id":100073401,"comment_content":"é¢è¯•å½’æ¥ï¼ŒäºŒåˆ·RDD","like_count":0},{"had_liked":false,"id":310519,"user_name":"tony","can_delete":false,"product_type":"c1","uid":1254277,"ip_address":"","ucode":"D5BBFBEB576BE5","user_header":"https://static001.geekbang.org/account/avatar/00/13/23/85/e19f8833.jpg","comment_is_top":false,"comment_ctime":1630718212,"is_pvip":false,"replies":[{"id":"112553","content":"å¯¹ï¼Œä¸»è¦æ˜¯ä»å­˜å‚¨ã€è®¡ç®—åˆ†ç¦»çš„è§’åº¦è€ƒè™‘è¿™ä¸ªé—®é¢˜ï¼Œä¸€æ—¦ä¸¤è€…åˆ†ç¦»ï¼ŒpreferecneLocationså°±æ²¡æœ‰æ„ä¹‰äº†~","user_name":"ä½œè€…å›å¤","user_name_real":"å´ç£Š","uid":"1043100","ctime":1630852611,"ip_address":"","comment_id":310519,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1630718212","product_id":100073401,"comment_content":"çº¯ç®—åˆ†ç¦» æœ‰ è®¡ç®—èŠ‚ç‚¹+ossï¼Œæ‰€æœ‰è®¡ç®—èŠ‚ç‚¹ä»ossè®¿é—®æ•°æ®ï¼Œç½‘ç»œioä»£ä»·å·®ä¸å¤šã€‚ä¸ºäº†åŠ é€Ÿè®¡ç®—èŠ‚ç‚¹è®¿é—®é€Ÿåº¦ï¼Œè¿˜ä¼šåœ¨è®¡ç®—èŠ‚ç‚¹ä¸ŠåŠ ä¸ªç¼“å­˜ã€‚<br><br>æ‰€ä»¥å½“è®¡ç®—èŠ‚ç‚¹è®¿é—®æ•°æ®ä¸åœ¨cacheï¼Œé‚£ä¹ˆpreferecneLocationsåº”è¯¥å°±ä¸èµ·ä»€ä¹ˆä½œç”¨äº†ã€‚è¿™ä¹ˆç†è§£å¯¹å—ï¼Ÿ","like_count":0,"discussions":[{"author":{"id":1043100,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/ea/9c/230061e7.jpg","nickname":"å´ç£Š","note":"","ucode":"136DC8CF1B10DC","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":526261,"discussion_content":"å¯¹ï¼Œä¸»è¦æ˜¯ä»å­˜å‚¨ã€è®¡ç®—åˆ†ç¦»çš„è§’åº¦è€ƒè™‘è¿™ä¸ªé—®é¢˜ï¼Œä¸€æ—¦ä¸¤è€…åˆ†ç¦»ï¼ŒpreferecneLocationså°±æ²¡æœ‰æ„ä¹‰äº†~","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1630852611,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":300881,"user_name":"ä¸€ç¾¤å­¤å„¿","can_delete":false,"product_type":"c1","uid":2039833,"ip_address":"","ucode":"9A9460DCBED4BB","user_header":"https://thirdwx.qlogo.cn/mmopen/vi_32/DYAIOgq83erqPQcbrNpo7UcKiaDpNbPaaV1A2TIprO7ryaVL3XaG89zhP5uibv7HuApkQDoaibPS7JGnNqP4ykFIg/132","comment_is_top":false,"comment_ctime":1625415521,"is_pvip":false,"replies":[{"id":"109048","content":"RDDæ˜¯æ•°æ®æŠ½è±¡ï¼Œå®ƒå¯¹æ ‡çš„æ˜¯åˆ†å¸ƒå¼æ•°æ®é›†ï¼Œé€šè¿‡å±æ€§æ¥åˆ»ç”»æ•°æ®é›†ã€‚ä½ çš„codeé‡Œé¢ï¼Œå®šä¹‰äº†å¤šå°‘ä¸ªRDDï¼Œå°±æœ‰å¤šå°‘ä¸ªRDDã€‚","user_name":"ä½œè€…å›å¤","user_name_real":"å´ç£Š","uid":"1043100","ctime":1625526200,"ip_address":"","comment_id":300881,"utype":1}],"discussion_count":2,"race_medal":0,"score":"1625415521","product_id":100073401,"comment_content":"RDDé‡Œé¢è£…çš„æ˜¯æ•°æ®å—? ä¸€ä¸ªsparkä»»åŠ¡æœ‰å‡ ä¸ªRDD?<br>","like_count":0,"discussions":[{"author":{"id":1043100,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/ea/9c/230061e7.jpg","nickname":"å´ç£Š","note":"","ucode":"136DC8CF1B10DC","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":522839,"discussion_content":"RDDæ˜¯æ•°æ®æŠ½è±¡ï¼Œå®ƒå¯¹æ ‡çš„æ˜¯åˆ†å¸ƒå¼æ•°æ®é›†ï¼Œé€šè¿‡å±æ€§æ¥åˆ»ç”»æ•°æ®é›†ã€‚ä½ çš„codeé‡Œé¢ï¼Œå®šä¹‰äº†å¤šå°‘ä¸ªRDDï¼Œå°±æœ‰å¤šå°‘ä¸ªRDDã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1625526200,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":2861352,"avatar":"","nickname":"é˜¿ç‹¸å¼Ÿå¼Ÿçš„åŒ…å­åº—","note":"","ucode":"0CCF598B029075","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":548833,"discussion_content":"RDDæ˜¯ä¸€ç§æ•°æ®ç»“æ„ï¼Œå®šä¹‰äº†: æ•°æ®ä»å“ªå–ï¼Œæ€ä¹ˆå–ï¼Œå–äº†æ€ä¹ˆç”¨ï¼Œä¸Šçº§æ˜¯è°","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1643419322,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":290945,"user_name":"xuchuan","can_delete":false,"product_type":"c1","uid":1954690,"ip_address":"","ucode":"3967199AA078C7","user_header":"https://static001.geekbang.org/account/avatar/00/1d/d3/82/c3e57eb3.jpg","comment_is_top":false,"comment_ctime":1619870337,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1619870337","product_id":100073401,"comment_content":"ç®€å•æ˜“æ‡‚ï¼Œå•æœºæ€ç»´å’Œåˆ†å¸ƒå¼æ€ç»´æ¨¡å¼æ€»ç»“åˆ°ä½","like_count":0},{"had_liked":false,"id":290923,"user_name":"aof","can_delete":false,"product_type":"c1","uid":1062864,"ip_address":"","ucode":"5815D63C4926BC","user_header":"https://static001.geekbang.org/account/avatar/00/10/37/d0/26975fba.jpg","comment_is_top":false,"comment_ctime":1619861687,"is_pvip":false,"replies":[{"id":"105436","content":"ç¬¬ä¸€ä¸ªå–å†³äºè®¡ç®—åœºæ™¯å“ˆï¼Œåœ¨é«˜é˜¶å‡½æ•°ä¸­ä½¿ç”¨è‡ªå®šä¹‰æ•°æ®ç»“æ„ã€æˆ–æ˜¯è¾…åŠ©æ€§çš„æ•°æ®ç»“æ„æ¥å®Œæˆè®¡ç®—ï¼Œå€’ä¸ä¸€å®šå°±æ˜¯å•æœºæ€ç»´~<br><br>å¯¹äºpreferredLocationsã€æˆ–è€…Taskçš„æœ¬åœ°æ€§çº§åˆ«æ¥è¯´ï¼Œæ‰€æœ‰Executorsåˆ†å¸ƒåˆ°åŒä¸€ä¸ªèŠ‚ç‚¹ï¼Œå€’ä¸æ˜¯å…³é”®ã€‚å¯ä»¥æ²¿ç€è®¡ç®—ã€å­˜å‚¨åˆ†ç¦»çš„æ€è·¯ï¼Œå†æƒ³ä¸€æƒ³~ ä¸è¿‡ä½ è¯´çš„è¿™ç§æƒ…å†µï¼Œè®©æˆ‘æƒ³èµ·äº†YARNçš„Label Based Schedulingï¼Œå°±æ˜¯åœ¨åšèµ„æºè°ƒåº¦çš„æ—¶å€™ï¼Œå¯ä»¥æŒ‡å®šå…·ä½“ç”¨å“ªäº›ç‰©ç†èŠ‚ç‚¹çš„èµ„æºã€‚","user_name":"ä½œè€…å›å¤","user_name_real":"å´ç£Š","uid":"1043100","ctime":1619946821,"ip_address":"","comment_id":290923,"utype":1}],"discussion_count":2,"race_medal":0,"score":"1619861687","product_id":100073401,"comment_content":"1. å•æœºæ€ç»´ï¼Œåœ¨RDD&#47;Datasetåé¢çš„mapå‡½æ•°ä¸­ä½¿ç”¨äº†HashMapï¼Œå“ˆå“ˆ<br>2. é™¤äº†è®¡ç®—åˆ†ç¦»ã€å•èŠ‚ç‚¹è®¡ç®—ä¹‹å¤–ï¼Œè¿˜æœ‰ä¸€ç§æƒ…å†µï¼Œæ¯”å¦‚æˆ‘ç”³è¯·äº†5ä¸ªExecutorï¼Œä½†å› ä¸ºèµ„æºçš„é—®é¢˜ï¼Œå¯¼è‡´è¿™5ä¸ªExecutorå…¨éƒ¨å¯åœ¨äº†åŒä¸€ä¸ªèŠ‚ç‚¹ä¸Šã€‚","like_count":0,"discussions":[{"author":{"id":1043100,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/ea/9c/230061e7.jpg","nickname":"å´ç£Š","note":"","ucode":"136DC8CF1B10DC","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":519326,"discussion_content":"ç¬¬ä¸€ä¸ªå–å†³äºè®¡ç®—åœºæ™¯å“ˆï¼Œåœ¨é«˜é˜¶å‡½æ•°ä¸­ä½¿ç”¨è‡ªå®šä¹‰æ•°æ®ç»“æ„ã€æˆ–æ˜¯è¾…åŠ©æ€§çš„æ•°æ®ç»“æ„æ¥å®Œæˆè®¡ç®—ï¼Œå€’ä¸ä¸€å®šå°±æ˜¯å•æœºæ€ç»´~\n\nå¯¹äºpreferredLocationsã€æˆ–è€…Taskçš„æœ¬åœ°æ€§çº§åˆ«æ¥è¯´ï¼Œæ‰€æœ‰Executorsåˆ†å¸ƒåˆ°åŒä¸€ä¸ªèŠ‚ç‚¹ï¼Œå€’ä¸æ˜¯å…³é”®ã€‚å¯ä»¥æ²¿ç€è®¡ç®—ã€å­˜å‚¨åˆ†ç¦»çš„æ€è·¯ï¼Œå†æƒ³ä¸€æƒ³~ ä¸è¿‡ä½ è¯´çš„è¿™ç§æƒ…å†µï¼Œè®©æˆ‘æƒ³èµ·äº†YARNçš„Label Based Schedulingï¼Œå°±æ˜¯åœ¨åšèµ„æºè°ƒåº¦çš„æ—¶å€™ï¼Œå¯ä»¥æŒ‡å®šå…·ä½“ç”¨å“ªäº›ç‰©ç†èŠ‚ç‚¹çš„èµ„æºã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1619946821,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1062864,"avatar":"https://static001.geekbang.org/account/avatar/00/10/37/d0/26975fba.jpg","nickname":"aof","note":"","ucode":"5815D63C4926BC","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":371781,"discussion_content":"ç¬¬ä¸€ä¸ªæ˜¯æˆ‘åœ¨map()å‡½æ•°å¤–é¢å£°æ˜äº†ä¸€ä¸ªhashmapï¼Œç„¶ååœ¨map()å‡½æ•°å†…éƒ¨ä½¿ç”¨äº†è¿™ä¸ªhashmapã€‚\n\nç¬¬äºŒä¸ªå¤šè°¢è€å¸ˆæ‹“å±•ï¼Œä¹‹å‰å®‰è£…CDHä¹‹åï¼Œé…ç½®è¿‡YARNçš„é˜Ÿåˆ—èµ„æºéš”ç¦»ï¼Œä½†æ˜¯node labelè¿™ä¸ªç¡®å®æ²¡æœ‰ç”¨è¿‡ï¼Œå»æŸ¥äº†ä¸€ä¸‹å®˜ç½‘ï¼šhttps://hadoop.apache.org/docs/stable/hadoop-yarn/hadoop-yarn-site/NodeLabel.html","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1619967065,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":285045,"user_name":"å¼¦æ–­è§…çŸ¥éŸ³","can_delete":false,"product_type":"c1","uid":1283398,"ip_address":"","ucode":"6234916B97268C","user_header":"https://static001.geekbang.org/account/avatar/00/13/95/46/1cd5ab5f.jpg","comment_is_top":false,"comment_ctime":1616591112,"is_pvip":false,"replies":[{"id":"103474","content":"è¿™ç§ä¸ç®—å“ˆï¼Œå¯ä»¥æ²¿ç€è®¡ç®—å­˜å‚¨åˆ†ç¦»çš„æ€è·¯å†æƒ³æƒ³ï½","user_name":"ä½œè€…å›å¤","user_name_real":"å´ç£Š","uid":"1043100","ctime":1616671884,"ip_address":"","comment_id":285045,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1616591112","product_id":100073401,"comment_content":"preferredLocationsä¸èµ·ä½œç”¨æƒ…å†µä¹‹ä¸€ï¼Œæ¯”å¦‚æœ‰å•ç‹¬æœºå™¨ä½œä¸ºé›†ç¾¤çš„å®¢æˆ·ç«¯ï¼Œç„¶åæäº¤çš„ä»»åŠ¡åœ¨é›†ç¾¤çš„å®¢æˆ·ç«¯ä¸Šè¿è¡Œï¼Œè¿™ç§æƒ…å†µç®—ä¸ç®—ï¼Ÿ","like_count":0,"discussions":[{"author":{"id":1043100,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/ea/9c/230061e7.jpg","nickname":"å´ç£Š","note":"","ucode":"136DC8CF1B10DC","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":517563,"discussion_content":"è¿™ç§ä¸ç®—å“ˆï¼Œå¯ä»¥æ²¿ç€è®¡ç®—å­˜å‚¨åˆ†ç¦»çš„æ€è·¯å†æƒ³æƒ³ï½","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1616671884,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":284191,"user_name":"è€A","can_delete":false,"product_type":"c1","uid":1806678,"ip_address":"","ucode":"6B3BB0851583BD","user_header":"https://static001.geekbang.org/account/avatar/00/1b/91/56/f714ad14.jpg","comment_is_top":false,"comment_ctime":1616117999,"is_pvip":false,"replies":[{"id":"103122","content":"è¿™å—ç¡®å®æœ‰ç‚¹éš¾ï¼Œå› ä¸ºæˆ‘ä»¬è¿˜æ²¡è®²åˆ°è°ƒåº¦ç³»ç»Ÿï¼Œä¹Ÿè¿˜æ²¡ç»†è®²localityã€‚å†æƒ³ä¸€æƒ³ï¼Œæ²¿ç€è®¡ç®—å’Œå­˜å‚¨ç‰©ç†åˆ†ç¦»çš„æ€è·¯å“ˆï½","user_name":"ä½œè€…å›å¤","user_name_real":"å´ç£Š","uid":"1043100","ctime":1616162465,"ip_address":"","comment_id":284191,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1616117999","product_id":100073401,"comment_content":"preferredLocations ä¸èµ·ä½œç”¨ï¼Œåº”è¯¥åœ¨æ•°æ®æºæ˜¯å•èŠ‚ç‚¹æƒ…å†µï¼Œæ¯”å¦‚socketæ•°æ®æºï¼Œè¿˜æœ‰å°±æ˜¯è¯»å–hdfsçš„æ•°æ®å—æ¯”è¾ƒå°ä¸è¶³ä¸€ä¸ªsplitåˆ†ç‰‡128Mçš„æƒ…å†µï¼Œè¿˜æœ‰å°±æ˜¯å¤§çš„å‹ç¼©æ•°æ®å—ï¼Œæ¯”å¦‚snappyå‹ç¼©ï¼Œè¿™ç§å‹ç¼©ä¸æ”¯æŒåˆ‡åˆ†çš„æƒ…å†µã€‚","like_count":0,"discussions":[{"author":{"id":1043100,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/ea/9c/230061e7.jpg","nickname":"å´ç£Š","note":"","ucode":"136DC8CF1B10DC","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":517265,"discussion_content":"è¿™å—ç¡®å®æœ‰ç‚¹éš¾ï¼Œå› ä¸ºæˆ‘ä»¬è¿˜æ²¡è®²åˆ°è°ƒåº¦ç³»ç»Ÿï¼Œä¹Ÿè¿˜æ²¡ç»†è®²localityã€‚å†æƒ³ä¸€æƒ³ï¼Œæ²¿ç€è®¡ç®—å’Œå­˜å‚¨ç‰©ç†åˆ†ç¦»çš„æ€è·¯å“ˆï½","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1616162465,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]}]}