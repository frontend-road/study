{"id":100502,"title":"08 | 键入网址再按下回车，后面究竟发生了什么？","content":"<p>经过上一讲的学习，你是否已经在自己的电脑上搭建好了“最小化”的HTTP实验环境呢？</p><p>我相信你的答案一定是“Yes”，那么，让我们立刻开始“螺蛳壳里做道场”，在这个实验环境里看一下HTTP协议工作的全过程。</p><h2>使用IP地址访问Web服务器</h2><p>首先我们运行www目录下的“start”批处理程序，启动本机的OpenResty服务器，启动后可以用“list”批处理确认服务是否正常运行。</p><p>然后我们打开Wireshark，选择“HTTP TCP port(80)”过滤器，再鼠标双击“Npcap loopback Adapter”，开始抓取本机127.0.0.1地址上的网络数据。</p><p>第三步，在Chrome浏览器的地址栏里输入“<a href=\"http://127.0.0.1/\">http://127.0.0.1/</a>”，再按下回车键，等欢迎页面显示出来后Wireshark里就会有捕获的数据包，如下图所示。</p><p><img src=\"https://static001.geekbang.org/resource/image/86/b0/86e3c635e9a9ab0abd523c01fc181cb0.png?wh=3000*1681\" alt=\"\"></p><p>如果你还没有搭好实验环境，或者捕获与本文里的不一致也没关系。我把这次捕获的数据存成了pcap包，文件名是“08-1”，放到了GitHub上，你可以下载到本地后再用Wireshark打开，完全精确“重放”刚才的HTTP传输过程。</p><h2>抓包分析</h2><p>在Wireshark里你可以看到，这次一共抓到了11个包（这里用了滤包功能，滤掉了3个包，原本是14个包），耗时0.65秒，下面我们就来一起分析一下\"键入网址按下回车\"后数据传输的全过程。</p><!-- [[[read_end]]] --><p>通过前面“破冰篇”的讲解，你应该知道HTTP协议是运行在TCP/IP基础上的，依靠TCP/IP协议来实现数据的可靠传输。所以浏览器要用HTTP协议收发数据，<span class=\"orange\">首先要做的就是建立TCP连接</span>。</p><p>因为我们在地址栏里直接输入了IP地址“127.0.0.1”，而Web服务器的默认端口是80，所以浏览器就要依照TCP协议的规范，使用“三次握手”建立与Web服务器的连接。</p><p>对应到Wireshark里，就是最开始的三个抓包，浏览器使用的端口是52085，服务器使用的端口是80，经过SYN、SYN/ACK、ACK的三个包之后，浏览器与服务器的TCP连接就建立起来了。</p><p>有了可靠的TCP连接通道后，HTTP协议就可以开始工作了。于是，浏览器按照HTTP协议规定的格式，通过TCP发送了一个“GET / HTTP/1.1”请求报文，也就是Wireshark里的第四个包。至于包的内容具体是什么现在先不用管，我们下一讲再说。</p><p>随后，Web服务器回复了第五个包，在TCP协议层面确认：“刚才的报文我已经收到了”，不过这个TCP包HTTP协议是看不见的。</p><p>Web服务器收到报文后在内部就要处理这个请求。同样也是依据HTTP协议的规定，解析报文，看看浏览器发送这个请求想要干什么。</p><p>它一看，原来是要求获取根目录下的默认文件，好吧，那我就从磁盘上把那个文件全读出来，再拼成符合HTTP格式的报文，发回去吧。这就是Wireshark里的第六个包“HTTP/1.1 200 OK”，底层走的还是TCP协议。</p><p>同样的，浏览器也要给服务器回复一个TCP的ACK确认，“你的响应报文收到了，多谢”，即第七个包。</p><p>这时浏览器就收到了响应数据，但里面是什么呢？所以也要解析报文。一看，服务器给我的是个HTML文件，好，那我就调用排版引擎、JavaScript引擎等等处理一下，然后在浏览器窗口里展现出了欢迎页面。</p><p>这之后还有两个来回，共四个包，重复了相同的步骤。这是浏览器自动请求了作为网站图标的“favicon.ico”文件，与我们输入的网址无关。但因为我们的实验环境没有这个文件，所以服务器在硬盘上找不到，返回了一个“404 Not Found”。</p><p>至此，“键入网址再按下回车”的全过程就结束了。</p><p>我为这个过程画了一个交互图，你可以对照着看一下。不过要提醒你，图里TCP关闭连接的“四次挥手”在抓包里没有出现，这是因为HTTP/1.1长连接特性，默认不会立即关闭连接。</p><p><img src=\"https://static001.geekbang.org/resource/image/8a/19/8a5bddd3d8046daf7032c7d60a3d1a19.png?wh=3000*5051\" alt=\"\"></p><p>再简要叙述一下这次最简单的浏览器HTTP请求过程：</p><ol>\n<li>浏览器从地址栏的输入中获得服务器的IP地址和端口号；</li>\n<li>浏览器用TCP的三次握手与服务器建立连接；</li>\n<li>浏览器向服务器发送拼好的报文；</li>\n<li>服务器收到报文后处理请求，同样拼好报文再发给浏览器；</li>\n<li>浏览器解析报文，渲染输出页面。</li>\n</ol><h2>使用域名访问Web服务器</h2><p>刚才我们是在浏览器地址栏里直接输入IP地址，但绝大多数情况下，我们是不知道服务器IP地址的，使用的是域名，那么改用域名后这个过程会有什么不同吗？</p><p>还是实际动手试一下吧，把地址栏的输入改成“<a href=\"http://www.chrono.com\">http://www.chrono.com</a>”，重复Wireshark抓包过程，你会发现，好像没有什么不同，浏览器上同样显示出了欢迎界面，抓到的包也同样是11个：先是三次握手，然后是两次HTTP传输。</p><p>这里就出现了一个问题：浏览器是如何从网址里知道“www.chrono.com”的IP地址就是“127.0.0.1”的呢？</p><p>还记得我们之前讲过的DNS知识吗？浏览器看到了网址里的“www.chrono.com”，发现它不是数字形式的IP地址，那就肯定是域名了，于是就会发起域名解析动作，通过访问一系列的域名解析服务器，试图把这个域名翻译成TCP/IP协议里的IP地址。</p><p>不过因为域名解析的全过程实在是太复杂了，如果每一个域名都要大费周折地去网上查一下，那我们上网肯定会慢得受不了。</p><p>所以，在域名解析的过程中会有多级的缓存，浏览器首先看一下自己的缓存里有没有，如果没有就向操作系统的缓存要，还没有就检查本机域名解析文件hosts，也就是上一讲中我们修改的“C:\\WINDOWS\\system32\\drivers\\etc\\hosts”。</p><p>刚好，里面有一行映射关系“127.0.0.1 www.chrono.com”，于是浏览器就知道了域名对应的IP地址，就可以愉快地建立TCP连接发送HTTP请求了。</p><p>我把这个过程也画出了一张图，但省略了TCP/IP协议的交互部分，里面的浏览器多出了一个访问hosts文件的动作，也就是本机的DNS解析。</p><p><img src=\"https://static001.geekbang.org/resource/image/57/1b/5717c967b8d46e5ba438e1d8ed605a1b.png?wh=3000*1681\" alt=\"\"></p><h2>真实的网络世界</h2><p>通过上面两个在“最小化”环境里的实验，你是否已经对HTTP协议的工作流程有了基本的认识呢？</p><p>第一个实验是最简单的场景，只有两个角色：浏览器和服务器，浏览器可以直接用IP地址找到服务器，两者直接建立TCP连接后发送HTTP报文通信。</p><p>第二个实验在浏览器和服务器之外增加了一个DNS的角色，浏览器不知道服务器的IP地址，所以必须要借助DNS的域名解析功能得到服务器的IP地址，然后才能与服务器通信。</p><p>真实的互联网世界要比这两个场景要复杂的多，我利用下面的这张图来做一个详细的说明。</p><p><img src=\"https://static001.geekbang.org/resource/image/df/6d/df4696154fc8837e33117d8d6ab1776d.png?wh=3000*1681\" alt=\"\"></p><p>如果你用的是电脑台式机，那么你可能会使用带水晶头的双绞线连上网口，由交换机接入固定网络。如果你用的是手机、平板电脑，那么你可能会通过蜂窝网络、WiFi，由电信基站、无线热点接入移动网络。</p><p>接入网络的同时，网络运行商会给你的设备分配一个IP地址，这个地址可能是静态分配的，也可能是动态分配的。静态IP就始终不变，而动态IP可能你下次上网就变了。</p><p>假设你要访问的是Apple网站，显然你是不知道它的真实IP地址的，在浏览器里只能使用域名“www.apple.com”访问，那么接下来要做的必然是域名解析。这就要用DNS协议开始从操作系统、本地DNS、根DNS、顶级DNS、权威DNS的层层解析，当然这中间有缓存，可能不会费太多时间就能拿到结果。</p><p>别忘了互联网上还有另外一个重要的角色CDN，它也会在DNS的解析过程中“插上一脚”。DNS解析可能会给出CDN服务器的IP地址，这样你拿到的就会是CDN服务器而不是目标网站的实际地址。</p><p>因为CDN会缓存网站的大部分资源，比如图片、CSS样式表，所以有的HTTP请求就不需要再发到Apple，CDN就可以直接响应你的请求，把数据发给你。</p><p>由PHP、Java等后台服务动态生成的页面属于“动态资源”，CDN无法缓存，只能从目标网站获取。于是你发出的HTTP请求就要开始在互联网上的“漫长跋涉”，经过无数的路由器、网关、代理，最后到达目的地。</p><p>目标网站的服务器对外表现的是一个IP地址，但为了能够扛住高并发，在内部也是一套复杂的架构。通常在入口是负载均衡设备，例如四层的LVS或者七层的Nginx，在后面是许多的服务器，构成一个更强更稳定的集群。</p><p>负载均衡设备会先访问系统里的缓存服务器，通常有memory级缓存Redis和disk级缓存Varnish，它们的作用与CDN类似，不过是工作在内部网络里，把最频繁访问的数据缓存几秒钟或几分钟，减轻后端应用服务器的压力。</p><p>如果缓存服务器里也没有，那么负载均衡设备就要把请求转发给应用服务器了。这里就是各种开发框架大显神通的地方了，例如Java的Tomcat/Netty/Jetty，Python的Django，还有PHP、Node.js、Golang等等。它们又会再访问后面的MySQL、PostgreSQL、MongoDB等数据库服务，实现用户登录、商品查询、购物下单、扣款支付等业务操作，然后把执行的结果返回给负载均衡设备，同时也可能给缓存服务器里也放一份。</p><p>应用服务器的输出到了负载均衡设备这里，请求的处理就算是完成了，就要按照原路再走回去，还是要经过许多的路由器、网关、代理。如果这个资源允许缓存，那么经过CDN的时候它也会做缓存，这样下次同样的请求就不会到达源站了。</p><p>最后网站的响应数据回到了你的设备，它可能是HTML、JSON、图片或者其他格式的数据，需要由浏览器解析处理才能显示出来，如果数据里面还有超链接，指向别的资源，那么就又要重走一遍整个流程，直到所有的资源都下载完。</p><h2>小结</h2><p>今天我们在本机的环境里做了两个简单的实验，学习了HTTP协议请求-应答的全过程，在这里做一个小结。</p><ol>\n<li><span class=\"orange\">HTTP协议基于底层的TCP/IP协议，所以必须要用IP地址建立连接；</span></li>\n<li><span class=\"orange\">如果不知道IP地址，就要用DNS协议去解析得到IP地址，否则就会连接失败；</span></li>\n<li><span class=\"orange\">建立TCP连接后会顺序收发数据，请求方和应答方都必须依据HTTP规范构建和解析报文；</span></li>\n<li><span class=\"orange\"> 为了减少响应时间，整个过程中的每一个环节都会有缓存，能够实现“短路”操作；</span></li>\n<li><span class=\"orange\">虽然现实中的HTTP传输过程非常复杂，但理论上仍然可以简化成实验里的“两点”模型。</span></li>\n</ol><h2>课下作业</h2><ol>\n<li>你能试着解释一下在浏览器里点击页面链接后发生了哪些事情吗？</li>\n<li>这一节课里讲的都是正常的请求处理流程，如果是一个不存在的域名，那么浏览器的工作流程会是怎么样的呢？</li>\n</ol><p>欢迎你把自己的答案写在留言区，与我和其他同学一起讨论。如果你觉得有所收获，也欢迎把文章分享给你的朋友。</p><p><img src=\"https://static001.geekbang.org/resource/image/8e/56/8ef903c86d3ef548a9536bd4345f0156.png?wh=1769*2190\" alt=\"unpreview\"></p><p></p>","neighbors":{"left":{"article_title":"07 | 自己动手，搭建HTTP实验环境","id":100124},"right":{"article_title":"09 | HTTP报文是什么样子的？","id":100513}},"comments":[{"had_liked":false,"id":103617,"user_name":"-W.LI-","can_delete":false,"product_type":"c1","uid":1210699,"ip_address":"","ucode":"3556786538664F","user_header":"https://static001.geekbang.org/account/avatar/00/12/79/4b/740f91ca.jpg","comment_is_top":false,"comment_ctime":1560477755,"is_pvip":false,"replies":[{"id":"37499","content":"说的非常详细。","user_name":"作者回复","comment_id":103617,"uid":"1181974","ip_address":"","utype":1,"ctime":1560481584,"user_name_real":"chrono"}],"discussion_count":2,"race_medal":0,"score":"362337730619","product_id":100029001,"comment_content":"浏览器判断是不是ip地址，不是就进行域名解析，依次通过浏览器缓存，系统缓存，host文件，还是没找到的请求DNS服务器获取IP解析(解析失败的浏览器尝试换别的DNS服务器，最终失败的进入错误页面)，有可能获取到CDN服务器IP地址，访问CDN时先看是否缓存了，缓存了响应用户，无法缓存，缓存失效或者无缓存，回源到服务器。经过防火墙外网网管路由到nginx接入层。ng缓存中存在的直接放回，不存在的负载到web服务器。web服务器接受到请后处理，路径不存在404。存在的返回结果(服务器中也会有redis,ehcache(堆内外缓存)，disk等缓存策略)。原路返回，CDN加入缓存响应用户。","like_count":84,"discussions":[{"author":{"id":1181974,"avatar":"https://static001.geekbang.org/account/avatar/00/12/09/16/1161017c.jpg","nickname":"罗剑锋","note":"","ucode":"95678C988F24AB","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":453942,"discussion_content":"说的非常详细。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1560481584,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1549835,"avatar":"https://static001.geekbang.org/account/avatar/00/17/a6/0b/d296c751.jpg","nickname":"果果","note":"","ucode":"447E3A8A76FBD7","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":69320,"discussion_content":"我现在有点糊涂，浏览器的强缓存和协商缓存呢如果命中强缓存，直接从本地取数据，不发送请求。如果命中协商缓存，是不是直接发送http请求。您解释的这个是不是有一个前提，第一次请求或者发送的请求no-store，才会出现域名解释的事情。如果面试该怎么回答","likes_number":2,"is_delete":false,"is_hidden":false,"ctime":1575280877,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":121264,"user_name":"温木","can_delete":false,"product_type":"c1","uid":1507210,"ip_address":"","ucode":"EAB6EDD6EDFE96","user_header":"","comment_is_top":false,"comment_ctime":1565090185,"is_pvip":false,"replies":[{"id":"44561","content":"dns请求是专门的dns协议，使用udp发送，因为是udp所以不需要建立连接。","user_name":"作者回复","comment_id":121264,"uid":"1181974","ip_address":"","utype":1,"ctime":1565092093,"user_name_real":"chrono"}],"discussion_count":1,"race_medal":0,"score":"181953716617","product_id":100029001,"comment_content":"老师，我有一个问题请教。<br>DNS域名解析不需要发请求，建立连接吗？本地缓存的dns除外。<br>比如我第一次访问一个域名abc.com,那这第一次不是需要从dns服务器上拿真正的IP吗，去拿IP的这个过程不是应该也是一个请求吗？这个请求又是什么请求呢？","like_count":42,"discussions":[{"author":{"id":1181974,"avatar":"https://static001.geekbang.org/account/avatar/00/12/09/16/1161017c.jpg","nickname":"罗剑锋","note":"","ucode":"95678C988F24AB","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":461712,"discussion_content":"dns请求是专门的dns协议，使用udp发送，因为是udp所以不需要建立连接。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1565092093,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":103548,"user_name":"郭凯强","can_delete":false,"product_type":"c1","uid":1188524,"ip_address":"","ucode":"002F58C3640560","user_header":"https://static001.geekbang.org/account/avatar/00/12/22/ac/fc8e435a.jpg","comment_is_top":false,"comment_ctime":1560472559,"is_pvip":false,"replies":[{"id":"37481","content":"回答的比较全面。<br><br>这里面还有个长连接的问题，后面会讲，如果连接还是本站就不会有建连过程，直接用已有的连接发请求。","user_name":"作者回复","comment_id":103548,"uid":"1181974","ip_address":"","utype":1,"ctime":1560474521,"user_name_real":"chrono"}],"discussion_count":4,"race_medal":0,"score":"108934654959","product_id":100029001,"comment_content":"作业:<br>1. 浏览器判断这个链接是要在当前页面打开还是新开标签页，然后走一遍本文中的访问过程:拿到ip地址和端口号，建立tcp&#47;ip链接，发送请求报文，接收服务器返回并渲染。<br>2. 先查浏览器缓存，然后是系统缓存-＞hosts文件-＞局域网域名服务器-＞广域网域名服务器-＞顶级域名服务器-＞根域名服务器。这个时间通常要很久，最终找不到以后，返回一个报错页面，chrome是ERR_CONNECTION_ABORTED","like_count":25,"discussions":[{"author":{"id":1181974,"avatar":"https://static001.geekbang.org/account/avatar/00/12/09/16/1161017c.jpg","nickname":"罗剑锋","note":"","ucode":"95678C988F24AB","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":453914,"discussion_content":"回答的比较全面。\n\n这里面还有个长连接的问题，后面会讲，如果连接还是本站就不会有建连过程，直接用已有的连接发请求。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1560474521,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1085349,"avatar":"https://static001.geekbang.org/account/avatar/00/10/8f/a5/eb15586d.jpg","nickname":"looping","note":"","ucode":"D2F2474122779B","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":540219,"discussion_content":"第二步不对，先根域名，再顶级，再二级这样的","likes_number":1,"is_delete":false,"is_hidden":false,"ctime":1639992959,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1518132,"avatar":"https://static001.geekbang.org/account/avatar/00/17/2a/34/3308ef2d.jpg","nickname":"Vickey Cheung","note":"","ucode":"D5DF3F9F647826","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":14969,"discussion_content":"如果链接的不是本站 会先走关闭本站连接的四次挥手过程吗？","likes_number":1,"is_delete":false,"is_hidden":false,"ctime":1568792090,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":2060068,"avatar":"https://static001.geekbang.org/account/avatar/00/1f/6f/24/6a5cd563.jpg","nickname":"秦辉","note":"","ucode":"E6F5F2B108E4FC","race_medal":0,"user_type":1,"is_pvip":true},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":576786,"discussion_content":"host没有不是要访问非权威域名服务器吗","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1655791013,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":103810,"user_name":"极客时间","can_delete":false,"product_type":"c1","uid":1015564,"ip_address":"","ucode":"AF7565BB5EF164","user_header":"https://static001.geekbang.org/account/avatar/00/0f/7f/0c/392ce255.jpg","comment_is_top":false,"comment_ctime":1560519211,"is_pvip":false,"replies":[{"id":"37563","content":"因为http&#47;1连接传输效率低，所以浏览器一般会对同一个域名发起多个连接提高效率，这个52086就是开的第二个连接，但在抓包中只是打开了，还没有传输。<br><br>到后面讲长连接的时候你就会明白了。","user_name":"作者回复","comment_id":103810,"uid":"1181974","ip_address":"","utype":1,"ctime":1560551287,"user_name_real":"chrono"}],"discussion_count":4,"race_medal":0,"score":"96049799723","product_id":100029001,"comment_content":"老师 我有个疑问，第四个包到第六个包，为什么又进行了一次tcp连接呢，而且这个端口号是52086，这个是浏览器的特性吗，仔细比对文章发现这个问题啊","like_count":22,"discussions":[{"author":{"id":1181974,"avatar":"https://static001.geekbang.org/account/avatar/00/12/09/16/1161017c.jpg","nickname":"罗剑锋","note":"","ucode":"95678C988F24AB","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":454007,"discussion_content":"因为http/1连接传输效率低，所以浏览器一般会对同一个域名发起多个连接提高效率，这个52086就是开的第二个连接，但在抓包中只是打开了，还没有传输。\n\n到后面讲长连接的时候你就会明白了。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1560551287,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":2448960,"avatar":"https://static001.geekbang.org/account/avatar/00/25/5e/40/dee7906c.jpg","nickname":"张欣","note":"","ucode":"557C42848C77E6","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":365232,"discussion_content":"随后，Web 服务器回复了第五个包，在 TCP 协议层面确认：“刚才的报文我已经收到了”，不过这个 TCP 包 HTTP 协议是看不见的。\n上面有说这个","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1617755152,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1622655,"avatar":"https://static001.geekbang.org/account/avatar/00/18/c2/7f/7b22f12b.jpg","nickname":"乔","note":"","ucode":"1286F8742B4A01","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":299389,"discussion_content":"刚想问这个问题","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1597671253,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1260246,"avatar":"https://static001.geekbang.org/account/avatar/00/13/3a/d6/485590bd.jpg","nickname":"赵健","note":"","ucode":"553E417EE92EFB","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":1214,"discussion_content":"老师，您好，我自己抓了包，发现第二个tcp链接是第六个到第八个包，而不是第四个到第六个包，所以这个顺序是不固定的吧","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1562405438,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":104552,"user_name":"肥low","can_delete":false,"product_type":"c1","uid":1043480,"ip_address":"","ucode":"A158AFAAB8C742","user_header":"https://static001.geekbang.org/account/avatar/00/0f/ec/18/bf7254d3.jpg","comment_is_top":false,"comment_ctime":1560775698,"is_pvip":false,"replies":[{"id":"37863","content":"非常详细，赞！！","user_name":"作者回复","comment_id":104552,"uid":"1181974","ip_address":"","utype":1,"ctime":1560820237,"user_name_real":"chrono"}],"discussion_count":5,"race_medal":0,"score":"57395350546","product_id":100029001,"comment_content":"1、如果域名不是ip，需要走域名解析成ip的逻辑，优先级顺序为: 1 浏览器缓存 &gt; 2 本地hosts &gt; 3 系统缓存 &gt; 4 根域名 &gt; 5 顶级dns服务器(如 com) &gt;  6 二级dns服务器(baidu.com) &gt; 7 三级dns服务器(www.baidu.com)，如果客户端指向的dns服务器为非官方的如 8.8.8.8，那在第4步之前可能还有一层cache,当然最后解析的ip有可能是cdn的，如果cdn失效了就直接穿透到源ip，当然这个服务器这一部分可能做了四层负载均衡的设置，所以有可能每次获取的服务器ip都不一祥，也有可能到了服务器ngx层做了七层转发，所以虽然获得的ip一样，但是内部可能转发给了很多内网服务器<br><br>2、通过中间各种路由器的转发，找到了最终服务器，进行tcp三次握手，数据请求，请求分两种一种是uri请求，一种是浏览器咸吃萝卜淡操心的请求网站图标ico的资源请求，然后服务端收到请求后进行请求分析，最终返回http报文，再通过tcp这个连接隧道返回给用户端，用户端收到后再告诉服务端已经收到结果的信号(ack)，然后客户端有一套解析规则，如果是html，可能还有额外的外部连接请求，是跟刚才的请求流程是同理的(假设是http1.1)，只不过没有了tcp三次握手的过程，最终用户看到了百度的搜索页面。当然如果dns没解析成功，浏览器直接就报错了，不会继续请求接下来的资源","like_count":13,"discussions":[{"author":{"id":1181974,"avatar":"https://static001.geekbang.org/account/avatar/00/12/09/16/1161017c.jpg","nickname":"罗剑锋","note":"","ucode":"95678C988F24AB","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":454321,"discussion_content":"非常详细，赞！！","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1560820237,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1202089,"avatar":"https://static001.geekbang.org/account/avatar/00/12/57/a9/9abbe7a4.jpg","nickname":"神三元","note":"","ucode":"0FB2E7C0683599","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":133597,"discussion_content":"你写错了，系统缓存在hosts前面，老师咋不指正一下","likes_number":3,"is_delete":false,"is_hidden":false,"ctime":1578973840,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":1,"child_discussions":[{"author":{"id":2010313,"avatar":"https://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTJH3dribPS9AibkGhjN0giaWAa45SD8lCxkStyQrJibl7CPJRDNicvicwM224tHd3gLq2wvWbMAQ70IF6IA/132","nickname":"X青年","note":"","ucode":"E6EB3CCA7DB1C8","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":1202089,"avatar":"https://static001.geekbang.org/account/avatar/00/12/57/a9/9abbe7a4.jpg","nickname":"神三元","note":"","ucode":"0FB2E7C0683599","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":373742,"discussion_content":"对，老师应该及时纠正错误，不能总是赞的鼓励，学习错就应该及时指出","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1620863195,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":133597,"ip_address":""},"score":373742,"extra":""}]},{"author":{"id":1079206,"avatar":"https://static001.geekbang.org/account/avatar/00/10/77/a6/cbdd5056.jpg","nickname":"木子的昼夜","note":"","ucode":"7F025051769E43","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":1206,"discussion_content":"应该是先系统缓存 再本地hosts文件吧  ","likes_number":2,"is_delete":false,"is_hidden":false,"ctime":1562402589,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1216377,"avatar":"https://static001.geekbang.org/account/avatar/00/12/8f/79/766c3f20.jpg","nickname":"LH","note":"","ucode":"9ADE270D1E66B7","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":352967,"discussion_content":"应该是先系统缓存 再本地hosts文件","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1614930100,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":103535,"user_name":"极客时间","can_delete":false,"product_type":"c1","uid":1015564,"ip_address":"","ucode":"AF7565BB5EF164","user_header":"https://static001.geekbang.org/account/avatar/00/0f/7f/0c/392ce255.jpg","comment_is_top":false,"comment_ctime":1560471923,"is_pvip":false,"replies":[{"id":"37485","content":"本地dns你的理解是正确的。<br><br>万网是个域名注册的代理机构，最终域名还是要由dns系统来解析。<br><br>百度的理解基本正确，在真正服务器前面是dns负载均衡。","user_name":"作者回复","comment_id":103535,"uid":"1181974","ip_address":"","utype":1,"ctime":1560474922,"user_name_real":"chrono"}],"discussion_count":4,"race_medal":0,"score":"53100079475","product_id":100029001,"comment_content":"我有几个小疑问没搞明白，万望老师解答, 在进行DNS解析的时候，操作系统和本地DNS是如何处理的呢？<br>我的理解是本地系统有可能有缓存，DNS解析前先查看本地有没有缓存，如果没有缓存，再进行本地DNS解析，本地DNS解析就是查找系统里面的hosts文件的对应关系。不知道这里理解的对不对。<br><br>还有一个疑问。<br>什么是权威DNS呢，我一般是在万网购买域名，然后用A记录解析到我的服务器，这个A记录提交到哪里保存了呢，这里的万网扮演的是什么角色呢？它和权威DNS有关系吗？<br><br>上次我提到了一个问题，就是域名和ip的对应关系，没接触这个课程以前，我的理解是一个域名只能解析到一个ip地址，但是一个ip地址可以绑定多个域名，就像一个人只有一个身份证号码，但是可以有多个名字，但是我在用ping命令 ping‘ baidu.com’ 时，发现 可以返回不同的ip，结合本课程前面的文章，我理解是百度自己的服务器本质是一台DNS服务器，用DNS做了负载均衡，当我访问baidu.com时，域名解析过程中，有一个环节是到达了百度的DNS服务器，然后DNS服务器根据负载均衡操作，再将我的请求转发给目标服务器。不知道理解的对不对，或者哪里有偏差。","like_count":12,"discussions":[{"author":{"id":1181974,"avatar":"https://static001.geekbang.org/account/avatar/00/12/09/16/1161017c.jpg","nickname":"罗剑锋","note":"","ucode":"95678C988F24AB","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":453910,"discussion_content":"本地dns你的理解是正确的。\n\n万网是个域名注册的代理机构，最终域名还是要由dns系统来解析。\n\n百度的理解基本正确，在真正服务器前面是dns负载均衡。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1560474922,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1286588,"avatar":"https://static001.geekbang.org/account/avatar/00/13/a1/bc/ef0f26fa.jpg","nickname":"首富手记","note":"","ucode":"879DED4078303C","race_medal":0,"user_type":1,"is_pvip":true},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":357266,"discussion_content":"DNS 扛不住的问题你应该不需要考虑，他不一定是一台 DNS 服务，你想一下你的网站后面都不太可能是一台机器，那么 负责 DNS 解析的服务器肯定也不是一台  嘿嘿","likes_number":1,"is_delete":false,"is_hidden":false,"ctime":1615774450,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1315367,"avatar":"https://static001.geekbang.org/account/avatar/00/14/12/27/32746bbf.jpg","nickname":"大头","note":"","ucode":"C1FB2C8A0FB0C0","race_medal":0,"user_type":1,"is_pvip":true},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":290744,"discussion_content":"现在一个域名可以绑定多个ip 。是dns自动做的负载均衡，具体什么算法就不太清楚了","likes_number":1,"is_delete":false,"is_hidden":false,"ctime":1594598589,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":1,"child_discussions":[{"author":{"id":1977474,"avatar":"https://static001.geekbang.org/account/avatar/00/1e/2c/82/98e2b82a.jpg","nickname":"Reborn 2.0","note":"","ucode":"BA506E7455D91C","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":1315367,"avatar":"https://static001.geekbang.org/account/avatar/00/14/12/27/32746bbf.jpg","nickname":"大头","note":"","ucode":"C1FB2C8A0FB0C0","race_medal":0,"user_type":1,"is_pvip":true},"discussion":{"id":335124,"discussion_content":"谢谢, 我刚想问如果流量大了域名绑定IP的那台DNS服务器也会扛不住.","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1608099669,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":290744,"ip_address":""},"score":335124,"extra":""}]}]},{"had_liked":false,"id":119048,"user_name":"四月的紫色花","can_delete":false,"product_type":"c1","uid":1564190,"ip_address":"","ucode":"67863848E5D766","user_header":"https://static001.geekbang.org/account/avatar/00/17/de/1e/ca04d2c5.jpg","comment_is_top":false,"comment_ctime":1564493759,"is_pvip":false,"replies":[{"id":"43680","content":"回答的很认真，鼓励一下。<br><br>第二个问题后面有误，因为dns解析失败，根本没有进入http处理流程，所以不会有4xx之类的错误，而是dns解析错误信息。","user_name":"作者回复","comment_id":119048,"uid":"1181974","ip_address":"","utype":1,"ctime":1564534811,"user_name_real":"chrono"}],"discussion_count":2,"race_medal":0,"score":"40219199423","product_id":100029001,"comment_content":"1.你能试着解释一下在浏览器里点击页面链接后发生了哪些事情吗？<br>浏览器点击页面请求后，正常网络中都是域名，那么浏览器会先用DNS解析一下，拿到服务器的ip和端口，去请求服务器前会先找一下缓存，浏览器自己的缓存-操作系统缓存-本地缓存（Hosts），都没有的话就会到根域名服务器-顶级-权威，当然中间可能有类似CDN这样的代理，那它就可以取CDN中的服务器地址，总的来说，其实就是个“走近道”的过程，就近原则，在DNS不错的情况下，先从离自己近的查起，再一级一级往下。<br>2.这一节课里讲的都是正常的请求处理流程，如果是一个不存在的域名，那么浏览器的工作流程会是怎么样的呢？<br>如果是一个不存在的域名，那浏览器还是会从DNS那解析一下，发现，自己，操作系统，本地的缓存都没有，CDN里也没有，根域名，顶级域名，权威域名，非权威域名里<br>都没有，那它就放弃了，不会建立链接，返回错误码，可能是4××类的客户端请求错误。","like_count":9,"discussions":[{"author":{"id":1181974,"avatar":"https://static001.geekbang.org/account/avatar/00/12/09/16/1161017c.jpg","nickname":"罗剑锋","note":"","ucode":"95678C988F24AB","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":460727,"discussion_content":"回答的很认真，鼓励一下。\n\n第二个问题后面有误，因为dns解析失败，根本没有进入http处理流程，所以不会有4xx之类的错误，而是dns解析错误信息。","likes_number":1,"is_delete":false,"is_hidden":false,"ctime":1564534811,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1564190,"avatar":"https://static001.geekbang.org/account/avatar/00/17/de/1e/ca04d2c5.jpg","nickname":"四月的紫色花","note":"","ucode":"67863848E5D766","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":3498,"discussion_content":"感谢老师的鼓励和指正，对哦，类似4××这些错误码是HTTP的响应嘛，这个都没建立连接，更不可能进入http处理流程，当然是不会返回HTTP的错误码了。。明白了，感谢老师！","likes_number":1,"is_delete":false,"is_hidden":false,"ctime":1564539137,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":107705,"user_name":"陈1016","can_delete":false,"product_type":"c1","uid":1135968,"ip_address":"","ucode":"08DCE4EC43F35A","user_header":"http://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTIIHZoKST18pSvJjHNnkCA0ibJTmzWLAIraB8T3RIkCBrt52xplc97sFiczYG9c2FkTpFsHzbibJIZYg/132","comment_is_top":false,"comment_ctime":1561598160,"is_pvip":false,"replies":[{"id":"38990","content":"√","user_name":"作者回复","comment_id":107705,"uid":"1181974","ip_address":"","utype":1,"ctime":1561611993,"user_name_real":"chrono"}],"discussion_count":2,"race_medal":0,"score":"31626369232","product_id":100029001,"comment_content":"第一个问题的回答：浏览器缓存、系统缓存、hosts文件、野生DNS服务器（本地DNS服务器）、根DNS、顶级DNS、权威DNS、本地（附近）CDN、源站。","like_count":7,"discussions":[{"author":{"id":1181974,"avatar":"https://static001.geekbang.org/account/avatar/00/12/09/16/1161017c.jpg","nickname":"罗剑锋","note":"","ucode":"95678C988F24AB","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":455632,"discussion_content":"√","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1561611993,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1977474,"avatar":"https://static001.geekbang.org/account/avatar/00/1e/2c/82/98e2b82a.jpg","nickname":"Reborn 2.0","note":"","ucode":"BA506E7455D91C","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":335125,"discussion_content":"请问DNS会自动解析到本地（附近）CDN么?","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1608099830,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":156380,"user_name":"keep it simple","can_delete":false,"product_type":"c1","uid":1574739,"ip_address":"","ucode":"72B8DC00247C9E","user_header":"https://static001.geekbang.org/account/avatar/00/18/07/53/05aa9573.jpg","comment_is_top":false,"comment_ctime":1574863853,"is_pvip":false,"replies":[{"id":"60186","content":"<br>1.tcp收发数据有超时机制，超时没有响应就会断开连接，当然这个就不是正常的结束连接。<br><br>2.tcp收发有超时，连接本身没有超时机制，http使用keepalive在tcp上实现了连接保活。<br><br>3.tcp建连是在操作系统内核里实现的，有一个处理队列，如果并发的请求太多，就会排队等待。<br><br>4.这些问题涉及的都是tcp比较底层的细节，我也不能很好的解释清楚，建议再去参考其他的资料，sorry。","user_name":"作者回复","comment_id":156380,"uid":"1181974","ip_address":"","utype":1,"ctime":1574988684,"user_name_real":"chrono"}],"discussion_count":1,"race_medal":0,"score":"27344667629","product_id":100029001,"comment_content":"老师，学习这一章萌生出几个问题：<br>1.如果在TCP连接保持的情况下某一方突然断电了，没有机会进行TCP 四次挥手，会出现什么情况呢？<br>2.如果不主动关浏览器，TCP连接好像一直存在着，会有超时时间吗？中间是否会保活？<br>3.若server端负载较高，当它收到client的SYN包时，是否要过一段时间才会回应SYN,ACK？","like_count":6,"discussions":[{"author":{"id":1181974,"avatar":"https://static001.geekbang.org/account/avatar/00/12/09/16/1161017c.jpg","nickname":"罗剑锋","note":"","ucode":"95678C988F24AB","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":476088,"discussion_content":"\n1.tcp收发数据有超时机制，超时没有响应就会断开连接，当然这个就不是正常的结束连接。\n\n2.tcp收发有超时，连接本身没有超时机制，http使用keepalive在tcp上实现了连接保活。\n\n3.tcp建连是在操作系统内核里实现的，有一个处理队列，如果并发的请求太多，就会排队等待。\n\n4.这些问题涉及的都是tcp比较底层的细节，我也不能很好的解释清楚，建议再去参考其他的资料，sorry。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1574988684,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":225060,"user_name":"Maske","can_delete":false,"product_type":"c1","uid":1696847,"ip_address":"","ucode":"A19BB41A47E852","user_header":"https://static001.geekbang.org/account/avatar/00/19/e4/4f/df6d810d.jpg","comment_is_top":false,"comment_ctime":1591626430,"is_pvip":true,"replies":[{"id":"82874","content":"说的非常好！","user_name":"作者回复","comment_id":225060,"uid":"1181974","ip_address":"","utype":1,"ctime":1591664984,"user_name_real":"罗剑锋"}],"discussion_count":1,"race_medal":0,"score":"23066462910","product_id":100029001,"comment_content":"1.如果链接地址是域名开头的，浏览器会开始DNS解析动作。解析优先级依次为：浏览器缓存 &gt; 操作系统缓存 &gt; 本机hosts文件 &gt; “野生DNS服务器” &gt;核心DNS服务器（ 根级DNS  &gt; 顶级DNS &gt; 权威DNS） ；将域名解析为正确的ip地址之后，通过三次握手与服务器建立tcp&#47;ip连接；浏览器发送请求报文，服务器接收并处理请求，返回响应报文，浏览器开始解析html文档，在这过程中又会发起一些http请求，进行图片、css、js等静态资源的获取，以及ajax请求获取json数据。同时，浏览器相关引擎开始绘制dom视图，执行js脚本，完成页面的初始化直到所有代码执行完毕。<br>2.如1中所说DNS解析顺序，当请求DNS服务器进行域名解析时，发现没有找到对应的ip，会导致解析失败，无法建立tcp&#47;ip链接，导致浏览器建立连接时间过长，最终建立连接失败，浏览器停止建立连接动作。","like_count":5,"discussions":[{"author":{"id":1181974,"avatar":"https://static001.geekbang.org/account/avatar/00/12/09/16/1161017c.jpg","nickname":"罗剑锋","note":"","ucode":"95678C988F24AB","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":497716,"discussion_content":"说的非常好！","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1591664984,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":124646,"user_name":"乐雨","can_delete":false,"product_type":"c1","uid":1228003,"ip_address":"","ucode":"FE7D7CCFDC1989","user_header":"https://static001.geekbang.org/account/avatar/00/12/bc/e3/6267bf06.jpg","comment_is_top":false,"comment_ctime":1565937059,"is_pvip":false,"replies":[{"id":"45771","content":"hosts文件相当于是一个简易的dns解析器（KV格式），而操作系统缓存则是在内存里，访问缓存要比访问磁盘快的多。<br><br>所以解析dns都要先找缓存，没有才去访问解析器（hosts、dns服务器等）。","user_name":"作者回复","comment_id":124646,"uid":"1181974","ip_address":"","utype":1,"ctime":1565943594,"user_name_real":"chrono"}],"discussion_count":1,"race_medal":0,"score":"18745806243","product_id":100029001,"comment_content":"操作系统缓存是指什么？我理解就是hosts文件，为什么dns解析时分成了两步？","like_count":4,"discussions":[{"author":{"id":1181974,"avatar":"https://static001.geekbang.org/account/avatar/00/12/09/16/1161017c.jpg","nickname":"罗剑锋","note":"","ucode":"95678C988F24AB","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":463260,"discussion_content":"hosts文件相当于是一个简易的dns解析器（KV格式），而操作系统缓存则是在内存里，访问缓存要比访问磁盘快的多。\n\n所以解析dns都要先找缓存，没有才去访问解析器（hosts、dns服务器等）。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1565943594,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":125047,"user_name":"徐徐","can_delete":false,"product_type":"c1","uid":1031687,"ip_address":"","ucode":"960ED2B42DD486","user_header":"https://static001.geekbang.org/account/avatar/00/0f/be/07/9593e031.jpg","comment_is_top":false,"comment_ctime":1566051975,"is_pvip":true,"replies":[{"id":"46608","content":"<br>1.这是浏览器建立了两个并发连接，没有访问favicon也是正常的，跟浏览器有关。<br><br>2.这个应该是服务器主动关闭连接。<br><br>3.课程里的示例是挑选了一个最典型的场景，并不是所有的请求响应都会按照这个来。","user_name":"作者回复","comment_id":125047,"uid":"1181974","ip_address":"","utype":1,"ctime":1566365969,"user_name_real":"chrono"}],"discussion_count":1,"race_medal":0,"score":"14450953863","product_id":100029001,"comment_content":"你好，罗老师<br>我在本地测试了一下，结果有点不解<br>1、浏览器上访问了一次127.0.0.1，发起了两次：三次握手，四次握手；但没有访问&#47;favicon.ico；对应端口分别是52181-&gt;80、52182-&gt;80。<br>2、52181在四次挥手是服务端先发起了：[FIN,ACK]，客户端：[ACK],[FIN,ACK]，服务端：[ACK]，和你画的四次挥手顺序不对，52182和52181四次挥手顺序保持一致。","like_count":3,"discussions":[{"author":{"id":1181974,"avatar":"https://static001.geekbang.org/account/avatar/00/12/09/16/1161017c.jpg","nickname":"罗剑锋","note":"","ucode":"95678C988F24AB","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":463414,"discussion_content":"\n1.这是浏览器建立了两个并发连接，没有访问favicon也是正常的，跟浏览器有关。\n\n2.这个应该是服务器主动关闭连接。\n\n3.课程里的示例是挑选了一个最典型的场景，并不是所有的请求响应都会按照这个来。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1566365969,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":121328,"user_name":"ZeroIce","can_delete":false,"product_type":"c1","uid":1305369,"ip_address":"","ucode":"30133BA83CE349","user_header":"https://static001.geekbang.org/account/avatar/00/13/eb/19/0d990b03.jpg","comment_is_top":false,"comment_ctime":1565100514,"is_pvip":false,"replies":[{"id":"44586","content":"80是rfc标准里定义的默认端口，而8000&#47;8080则是其他“约定俗成”的端口，原因大概是与80形式接近，比较容易理解和记忆。","user_name":"作者回复","comment_id":121328,"uid":"1181974","ip_address":"","utype":1,"ctime":1565131711,"user_name_real":"chrono"}],"discussion_count":1,"race_medal":0,"score":"10155035106","product_id":100029001,"comment_content":"老师，我有个疑问：为什么HTTP协议会常用80、8000、8080端口？而不是其他端口？","like_count":2,"discussions":[{"author":{"id":1181974,"avatar":"https://static001.geekbang.org/account/avatar/00/12/09/16/1161017c.jpg","nickname":"罗剑锋","note":"","ucode":"95678C988F24AB","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":461743,"discussion_content":"80是rfc标准里定义的默认端口，而8000/8080则是其他“约定俗成”的端口，原因大概是与80形式接近，比较容易理解和记忆。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1565131711,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":119710,"user_name":"张德","can_delete":false,"product_type":"c1","uid":1101929,"ip_address":"","ucode":"31FE63E8725EFC","user_header":"https://static001.geekbang.org/account/avatar/00/10/d0/69/5dbdc245.jpg","comment_is_top":false,"comment_ctime":1564660596,"is_pvip":false,"replies":[{"id":"43959","content":"看来学http不仅对于参加工作的同学有用的，对于还在象牙塔里的同学也有用啊。","user_name":"作者回复","comment_id":119710,"uid":"1181974","ip_address":"","utype":1,"ctime":1564707769,"user_name_real":"chrono"}],"discussion_count":3,"race_medal":0,"score":"10154595188","product_id":100029001,"comment_content":"我记得有一年北大计算机专业的考研就有这一个题  😄","like_count":2,"discussions":[{"author":{"id":1181974,"avatar":"https://static001.geekbang.org/account/avatar/00/12/09/16/1161017c.jpg","nickname":"罗剑锋","note":"","ucode":"95678C988F24AB","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":461030,"discussion_content":"看来学http不仅对于参加工作的同学有用的，对于还在象牙塔里的同学也有用啊。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1564707769,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1305369,"avatar":"https://static001.geekbang.org/account/avatar/00/13/eb/19/0d990b03.jpg","nickname":"ZeroIce","note":"","ucode":"30133BA83CE349","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":4086,"discussion_content":"你考研过北大？可否加个微信： a1872121156","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1565100780,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":1,"child_discussions":[{"author":{"id":1101929,"avatar":"https://static001.geekbang.org/account/avatar/00/10/d0/69/5dbdc245.jpg","nickname":"张德","note":"","ucode":"31FE63E8725EFC","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":1305369,"avatar":"https://static001.geekbang.org/account/avatar/00/13/eb/19/0d990b03.jpg","nickname":"ZeroIce","note":"","ucode":"30133BA83CE349","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":7599,"discussion_content":"菜鸡一个  当年数学太差没有考上  后来就工作了 小伙子加油吧  刚看见😳","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1567581742,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":4086,"ip_address":""},"score":7599,"extra":""}]}]},{"had_liked":false,"id":113383,"user_name":"一缕绒花","can_delete":false,"product_type":"c1","uid":1262693,"ip_address":"","ucode":"243E55DDDE36A0","user_header":"https://static001.geekbang.org/account/avatar/00/13/44/65/53582e07.jpg","comment_is_top":false,"comment_ctime":1562989434,"is_pvip":false,"replies":[{"id":"41307","content":"那就是没有使用长连接，每次都重连服务器，所以有三次握手。<br><br>你可以试试打开页面后不要关闭，刷新看看，这样就不会有握手信息，而是直接发请求。","user_name":"作者回复","comment_id":113383,"uid":"1181974","ip_address":"","utype":1,"ctime":1563002206,"user_name_real":"chrono"}],"discussion_count":1,"race_medal":1,"score":"10152924026","product_id":100029001,"comment_content":"老师我想请教您一个问题，为什么我用wireshare抓包做上面的实验，每次都会重复一遍三次握手的过程","like_count":2,"discussions":[{"author":{"id":1181974,"avatar":"https://static001.geekbang.org/account/avatar/00/12/09/16/1161017c.jpg","nickname":"罗剑锋","note":"","ucode":"95678C988F24AB","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":458194,"discussion_content":"那就是没有使用长连接，每次都重连服务器，所以有三次握手。\n\n你可以试试打开页面后不要关闭，刷新看看，这样就不会有握手信息，而是直接发请求。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1563002206,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":103867,"user_name":"隰有荷","can_delete":false,"product_type":"c1","uid":1357944,"ip_address":"","ucode":"2BE9A32AB28963","user_header":"https://static001.geekbang.org/account/avatar/00/14/b8/78/2828195b.jpg","comment_is_top":false,"comment_ctime":1560556911,"is_pvip":false,"replies":[{"id":"37580","content":"今天的这讲是简化的说法，没有那么精确，完整的dns解析以第6讲为准。<br><br>另外，dns解析通常是先到非权威dns，然后是根dns-&gt;顶级dns-&gt;权威dns，你可以再回顾一下。","user_name":"作者回复","comment_id":103867,"uid":"1181974","ip_address":"","utype":1,"ctime":1560560471,"user_name_real":"chrono"}],"discussion_count":1,"race_medal":0,"score":"10150491503","product_id":100029001,"comment_content":"老师，文中在讲解请求Apple网站的例子时，说到：<br>&quot;这就要用 DNS 协议开始从操作系统、本地 DNS、根 DNS、顶级 DNS、权威 DNS 的层层解析&quot;。<br>而我看前几天的内容总结的是，请求会在进入网络后先到达非权威DNS、权威DNS、顶级…、最后才是到达根DNS去解析，那么本文怎么是先从根DNS开始的呢？","like_count":2,"discussions":[{"author":{"id":1181974,"avatar":"https://static001.geekbang.org/account/avatar/00/12/09/16/1161017c.jpg","nickname":"罗剑锋","note":"","ucode":"95678C988F24AB","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":454032,"discussion_content":"今天的这讲是简化的说法，没有那么精确，完整的dns解析以第6讲为准。\n\n另外，dns解析通常是先到非权威dns，然后是根dns-&amp;gt;顶级dns-&amp;gt;权威dns，你可以再回顾一下。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1560560471,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":294616,"user_name":"学不动了","can_delete":false,"product_type":"c1","uid":1235562,"ip_address":"","ucode":"6855C982ECC3A8","user_header":"https://static001.geekbang.org/account/avatar/00/12/da/6a/6b96edbd.jpg","comment_is_top":false,"comment_ctime":1622019172,"is_pvip":true,"replies":[{"id":"106984","content":"这个就是tcp层的知识了，根据当前网络的状况，调整数据收发的速度。","user_name":"作者回复","comment_id":294616,"uid":"1181974","ip_address":"","utype":1,"ctime":1622081931,"user_name_real":"罗剑锋"}],"discussion_count":1,"race_medal":0,"score":"5916986468","product_id":100029001,"comment_content":"在抓包的工程中，wireshark出现：<br>1.红色的RST&#47;ACK的包，<br>2.三次握手之后立马发送了[TCP Window Update]<br>对于问题1，查到的资料说是RST是复位标识，异常关闭连接<br>问题2，就没有找到明确的答案，麻烦老师解答下 为什么三次握手之后又发送了一个[TCP Window Update] ？","like_count":1,"discussions":[{"author":{"id":1181974,"avatar":"https://static001.geekbang.org/account/avatar/00/12/09/16/1161017c.jpg","nickname":"罗剑锋","note":"","ucode":"95678C988F24AB","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":520737,"discussion_content":"这个就是tcp层的知识了，根据当前网络的状况，调整数据收发的速度。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1622081931,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":282364,"user_name":"Geek_Maggie","can_delete":false,"product_type":"c1","uid":1609708,"ip_address":"","ucode":"3B74088B2C7B93","user_header":"https://static001.geekbang.org/account/avatar/00/18/8f/ec/c30b45d4.jpg","comment_is_top":false,"comment_ctime":1615206778,"is_pvip":false,"replies":[{"id":"102543","content":"说的很好。","user_name":"作者回复","comment_id":282364,"uid":"1181974","ip_address":"","utype":1,"ctime":1615246677,"user_name_real":"罗剑锋"}],"discussion_count":1,"race_medal":0,"score":"5910174074","product_id":100029001,"comment_content":"作业1： 在浏览器里点击页面链接后发生了哪些事情吗？<br>1. 页面链接是一个个URL，点击链接相当于在浏览器输入目标服务器的IP及端口后按下回车（有时候是域名及端口。端口http默认是80，https默认是443，这两个端口默认不写。）<br>2. 此时浏览器作为user agent发起http请求，这时候会先和目标服务器通过“三次握手”建立TCP连接<br>3. 建立连接后，服务器接收到浏览器的报文，解析浏览器发起的请求要访问什么资源。如果报文解析正确，知晓浏览器要访问的资源，则返回http返回码和所请求内容；如其他情况，返回其他http状态码进行告知。<br>4. 浏览器接收返回的信息，使用http模板引擎、JS、CSS等引擎将静态网页和资源渲染出来。<br>5. 如果是链接是带域名的，在建立TCP连接前，会进行域名解析的步骤：先访问本地缓存（浏览器缓存，然后是操作系统缓存、host文件）找不到则再逐级DNS（野生DNS服务器-根-顶级-权威）查找。域名如果是CDN的域名，可能先访问CDN的缓存资源，找不到再去源站。<br><br>作业2. 如果是一个不存在的域名，那么浏览器的工作流程会是怎么样的呢？<br>不存在的域名也会去解析，先执行域名解析的步骤：先访问本地缓存（浏览器缓存，然后是操作系统缓存、host文件）找不到则再逐级DNS（野生DNS服务器-根-顶级-权威），都执行完还是找不到就报错。","like_count":1,"discussions":[{"author":{"id":1181974,"avatar":"https://static001.geekbang.org/account/avatar/00/12/09/16/1161017c.jpg","nickname":"罗剑锋","note":"","ucode":"95678C988F24AB","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":516717,"discussion_content":"说的很好。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1615246677,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":155195,"user_name":"nora","can_delete":false,"product_type":"c1","uid":1206539,"ip_address":"","ucode":"3A3EABF27D0261","user_header":"https://static001.geekbang.org/account/avatar/00/12/69/0b/780b0aac.jpg","comment_is_top":false,"comment_ctime":1574659984,"is_pvip":false,"replies":[{"id":"59542","content":"<br>1.不会，因为一次请求已经完成了，这种错误计算机不会认为是dns错误，因为处理流程都是正确的，只是得到的ip地址数据错误。<br><br>2.可以手动改hosts，强行指定正确的ip，或者等待dns服务恢复正常，后者在dns被污染的时候就很难说了。","user_name":"作者回复","comment_id":155195,"uid":"1181974","ip_address":"","utype":1,"ctime":1574663605,"user_name_real":"chrono"}],"discussion_count":2,"race_medal":0,"score":"5869627280","product_id":100029001,"comment_content":"有个疑问是，如果DNS解析得到的IP已经失效，并不是当前最新的IP，会发生什么呢？<br>作者回复: 那就会在tcp层次发生连接失败，或者连接到了错误的其他网站。<br><br>老师，接这个问题，提出两个疑问<br>1. 发生链接错误时，会重新进行DNS解析嘛？<br>2. 假如连接到了错误的IP，那么什么时候会更新成为正确的IP呢？或者有什么办法可以更正DNS的解析错误","like_count":1,"discussions":[{"author":{"id":1181974,"avatar":"https://static001.geekbang.org/account/avatar/00/12/09/16/1161017c.jpg","nickname":"罗剑锋","note":"","ucode":"95678C988F24AB","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":475685,"discussion_content":"\n1.不会，因为一次请求已经完成了，这种错误计算机不会认为是dns错误，因为处理流程都是正确的，只是得到的ip地址数据错误。\n\n2.可以手动改hosts，强行指定正确的ip，或者等待dns服务恢复正常，后者在dns被污染的时候就很难说了。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1574663605,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1206539,"avatar":"https://static001.geekbang.org/account/avatar/00/12/69/0b/780b0aac.jpg","nickname":"nora","note":"","ucode":"3A3EABF27D0261","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":62073,"discussion_content":"谢谢老师，赞👍","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1574816187,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":137314,"user_name":"错夕","can_delete":false,"product_type":"c1","uid":1111184,"ip_address":"","ucode":"7452E1D7B38236","user_header":"https://static001.geekbang.org/account/avatar/00/10/f4/90/00e44acd.jpg","comment_is_top":false,"comment_ctime":1569686872,"is_pvip":false,"replies":[{"id":"52770","content":"<br>1.如果输入的不是ip地址，那么必然会做dns解析，否则没有ip就无法访问。而dns解析有可能会直接从缓存里取，不一定会走到解析服务器。<br><br>2.必须要有tcp连接，因为互联网和http就建立在tcp&#47;ip之上。<br><br>3.这个与客户端有关，如果用的是curl这样的命令行就没有渲染。<br><br>4.短连接会立即关闭连接，而长连接会保持较长的时间，直到客户端或者服务器某一方主动断开连接。","user_name":"作者回复","comment_id":137314,"uid":"1181974","ip_address":"","utype":1,"ctime":1569720197,"user_name_real":"chrono"}],"discussion_count":1,"race_medal":0,"score":"5864654168","product_id":100029001,"comment_content":"关于浏览器回车发生了什么我觉得应该关注的是<br>1.是否一定会进行DNS解析如果有缓存这个时候该怎么办<br>2.是否一定会进行TCP链接<br>3.收到服务器相应报文一定会解析dom进行渲染吗？如果返回304呢<br>4.TCP链接何时关闭","like_count":1,"discussions":[{"author":{"id":1181974,"avatar":"https://static001.geekbang.org/account/avatar/00/12/09/16/1161017c.jpg","nickname":"罗剑锋","note":"","ucode":"95678C988F24AB","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":469030,"discussion_content":"\n1.如果输入的不是ip地址，那么必然会做dns解析，否则没有ip就无法访问。而dns解析有可能会直接从缓存里取，不一定会走到解析服务器。\n\n2.必须要有tcp连接，因为互联网和http就建立在tcp/ip之上。\n\n3.这个与客户端有关，如果用的是curl这样的命令行就没有渲染。\n\n4.短连接会立即关闭连接，而长连接会保持较长的时间，直到客户端或者服务器某一方主动断开连接。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1569720197,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":135884,"user_name":"qiezitx","can_delete":false,"product_type":"c1","uid":1664274,"ip_address":"","ucode":"AEA470E33B4C19","user_header":"https://static001.geekbang.org/account/avatar/00/19/65/12/98fe9d80.jpg","comment_is_top":false,"comment_ctime":1569292489,"is_pvip":false,"replies":[{"id":"52143","content":"<br>1.如果uri里没有端口号，默认用80或者8080、443，但如果在这两个端口上不提供http服务，那浏览器就猜不出来，只能用户手动输入。比如后面安全篇里，就用了442等端口，必须手动输入。<br><br>2.实验出真知。<br><br>3.有的时候浏览器也不会发favicon请求，可能已经缓存了，这跟浏览器的工作流程有关，不必太在意。","user_name":"作者回复","user_name_real":"chrono","uid":"1181974","ctime":1569373594,"ip_address":"","comment_id":135884,"utype":1}],"discussion_count":1,"race_medal":0,"score":"5864259785","product_id":100029001,"comment_content":"作业<br>1、浏览器判断是否输入的是ip地址，不是的话就进行DNS解析：浏览器缓存-&gt;操作系统缓存（看到老师后面的解释是缓存)-&gt;host文件-&gt;根DNS-&gt;顶级DNS-&gt;权威DNS；如果是就开始访问的过程：拿到ip和端口号-&gt;3次握手建立TCP连接-&gt;发送请求-&gt;服务端返回结果-&gt;浏览器解析渲染。<br>这里有几个课外小贴士的实验和疑问：<br>1、ip要么直接输入要么通过DNS解析拿到，但端口号呢？默认端口号不行的时候，会尝试其他候选么？<br>2、经试验，确实有缓存，刷新访问会返回304 not Modified<br>3、经试验，没抓到favicon.ico的流程，chrome可能秘密发送了🐶<br><br>2、同留言：属于dns解析错误","like_count":1,"discussions":[{"author":{"id":1181974,"avatar":"https://static001.geekbang.org/account/avatar/00/12/09/16/1161017c.jpg","nickname":"罗剑锋","note":"","ucode":"95678C988F24AB","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":468367,"discussion_content":"\n1.如果uri里没有端口号，默认用80或者8080、443，但如果在这两个端口上不提供http服务，那浏览器就猜不出来，只能用户手动输入。比如后面安全篇里，就用了442等端口，必须手动输入。\n\n2.实验出真知。\n\n3.有的时候浏览器也不会发favicon请求，可能已经缓存了，这跟浏览器的工作流程有关，不必太在意。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1569373594,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":123286,"user_name":"Cris","can_delete":false,"product_type":"c1","uid":1473520,"ip_address":"","ucode":"F8A287134F1078","user_header":"https://static001.geekbang.org/account/avatar/00/16/7b/f0/269139d5.jpg","comment_is_top":false,"comment_ctime":1565657083,"is_pvip":false,"replies":[{"id":"45268","content":"是tcp里的握手包。","user_name":"作者回复","user_name_real":"chrono","uid":"1181974","ctime":1565658113,"ip_address":"","comment_id":123286,"utype":1}],"discussion_count":1,"race_medal":0,"score":"5860624379","product_id":100029001,"comment_content":"老师图里的SYN和ACK是什么意思？","like_count":1,"discussions":[{"author":{"id":1181974,"avatar":"https://static001.geekbang.org/account/avatar/00/12/09/16/1161017c.jpg","nickname":"罗剑锋","note":"","ucode":"95678C988F24AB","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":462610,"discussion_content":"是tcp里的握手包。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1565658113,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":103934,"user_name":"Geek_Wison","can_delete":false,"product_type":"c1","uid":1504371,"ip_address":"","ucode":"2CD880F07FDD57","user_header":"http://thirdwx.qlogo.cn/mmopen/vi_32/DYAIOgq83er4HlmmWfWicNmo3x3HKaOwz3ibcicDFlV5xILbILKGFCXbnaLf2fZRARfBdVBC5NhIPmXxaxA0T9Jhg/132","comment_is_top":false,"comment_ctime":1560568390,"is_pvip":false,"replies":[{"id":"37597","content":"这个是wireshark重新修改了起始值，方便查看，我觉得这个不用太在意，毕竟我们研究的是http这样的应用层协议。","user_name":"作者回复","user_name_real":"chrono","uid":"1181974","ctime":1560568985,"ip_address":"","comment_id":103934,"utype":1}],"discussion_count":1,"race_medal":0,"score":"5855535686","product_id":100029001,"comment_content":"老师，你好。我记得以前在教材里面，客户端在与服务器端建立TCP连接的时候，会发送一个SYN置为1的TCP报文段。但是在wireshark里面我看到的第一条TCP报文段怎么SYN=0？","like_count":1,"discussions":[{"author":{"id":1181974,"avatar":"https://static001.geekbang.org/account/avatar/00/12/09/16/1161017c.jpg","nickname":"罗剑锋","note":"","ucode":"95678C988F24AB","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":454062,"discussion_content":"这个是wireshark重新修改了起始值，方便查看，我觉得这个不用太在意，毕竟我们研究的是http这样的应用层协议。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1560568985,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":103627,"user_name":"业余草","can_delete":false,"product_type":"c1","uid":1126538,"ip_address":"","ucode":"99BDC1E629049D","user_header":"https://static001.geekbang.org/account/avatar/00/11/30/8a/b5ca7286.jpg","comment_is_top":false,"comment_ctime":1560478677,"is_pvip":false,"replies":[{"id":"37502","content":"thanks.","user_name":"作者回复","user_name_real":"chrono","uid":"1181974","ctime":1560485309,"ip_address":"","comment_id":103627,"utype":1}],"discussion_count":1,"race_medal":0,"score":"5855445973","product_id":100029001,"comment_content":"老师很有责任感！期待后面的内容！","like_count":1,"discussions":[{"author":{"id":1181974,"avatar":"https://static001.geekbang.org/account/avatar/00/12/09/16/1161017c.jpg","nickname":"罗剑锋","note":"","ucode":"95678C988F24AB","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":453945,"discussion_content":"thanks.","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1560485309,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":103483,"user_name":"xing.org1^","can_delete":false,"product_type":"c1","uid":1374066,"ip_address":"","ucode":"C68AEA172B1623","user_header":"https://static001.geekbang.org/account/avatar/00/14/f7/72/2d35f80c.jpg","comment_is_top":false,"comment_ctime":1560448795,"is_pvip":false,"replies":[{"id":"37480","content":"现在的http都是长连接，不会立即断开连接，尽量复用，因为握手和挥手的成本太高了。","user_name":"作者回复","user_name_real":"chrono","uid":"1181974","ctime":1560474414,"ip_address":"","comment_id":103483,"utype":1}],"discussion_count":2,"race_medal":1,"score":"5855416091","product_id":100029001,"comment_content":"老师请问，输入一个地址按下回车，浏览器把页面请求发送出去，服务器响应后返回html，浏览器在接受到html后就会立即发生四次挥手吗？还是说会延迟一会，遇到link、img等这些带外链的标签后继续去发送请求(省去dns解析和ip寻址？)，最终确定html中没有外链请求了才会断开链接呢？","like_count":1,"discussions":[{"author":{"id":1181974,"avatar":"https://static001.geekbang.org/account/avatar/00/12/09/16/1161017c.jpg","nickname":"罗剑锋","note":"","ucode":"95678C988F24AB","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":453891,"discussion_content":"现在的http都是长连接，不会立即断开连接，尽量复用，因为握手和挥手的成本太高了。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1560474414,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1308653,"avatar":"http://thirdwx.qlogo.cn/mmopen/vi_32/0PT9LxT8D6micyk0YbPuGQElQIeSax7puBBTXJDicJDhUHNibrbJPjEPJBRklVmcKG1PB7YV8JNh0BpsJjSicfibT5A/132","nickname":"Wendy","note":"","ucode":"398DDC96B178F7","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":7166,"discussion_content":"这个连接时间可以在web服务器上定义，比如nginx、apache、tomcat","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1567411416,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":360176,"user_name":"Geek_ce298e","can_delete":false,"product_type":"c1","uid":3194500,"ip_address":"上海","ucode":"7CD207C3521546","user_header":"https://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTKyNezT33TyZSmRvE8jriaFTyLfT45YbNZ5Dic3Vp5UaTAxFYaJdCfId0DELiaZMSmaWwic413eYVjPgg/132","comment_is_top":false,"comment_ctime":1666254795,"is_pvip":true,"replies":[{"id":"131016","content":"这个技术叫GLSB，cdn厂商会把后端域名解析成cdn服务器的域名，感兴趣可以搜一下。","user_name":"作者回复","user_name_real":"编辑","uid":"1181974","ctime":1666316029,"ip_address":"上海","comment_id":360176,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1666254795","product_id":100029001,"comment_content":"DNS服务器是怎么知道被请求的页面资源是被缓存在哪个CDN服务器上的？","like_count":0,"discussions":[{"author":{"id":1181974,"avatar":"https://static001.geekbang.org/account/avatar/00/12/09/16/1161017c.jpg","nickname":"罗剑锋","note":"","ucode":"95678C988F24AB","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":591129,"discussion_content":"这个技术叫GLSB，cdn厂商会把后端域名解析成cdn服务器的域名，感兴趣可以搜一下。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1666316029,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"上海"},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":357581,"user_name":"Freedom","can_delete":false,"product_type":"c1","uid":2007214,"ip_address":"北京","ucode":"1011E1FACC9BF6","user_header":"https://thirdwx.qlogo.cn/mmopen/vi_32/WIBqQagDENcUl8teFVTopEVSu6xpKcM0oVZeAhGaH6b71WgvUZLExx56I52Hibbbg4ibHgPLYMcU5XL3fGa9rZ4g/132","comment_is_top":false,"comment_ctime":1663419438,"is_pvip":false,"replies":[{"id":"130156","content":"是建立了两个连接，获取html和icon文件。","user_name":"作者回复","user_name_real":"编辑","uid":"1181974","ctime":1663456413,"ip_address":"北京","comment_id":357581,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1663419438","product_id":100029001,"comment_content":"老师，为什么我抓包过程有两次三次握手的过程","like_count":0,"discussions":[{"author":{"id":1181974,"avatar":"https://static001.geekbang.org/account/avatar/00/12/09/16/1161017c.jpg","nickname":"罗剑锋","note":"","ucode":"95678C988F24AB","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":588007,"discussion_content":"是建立了两个连接，获取html和icon文件。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1663456413,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"北京"},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":355564,"user_name":"纳兰容若","can_delete":false,"product_type":"c1","uid":1605876,"ip_address":"北京","ucode":"2E1EA2CDFDA1A9","user_header":"https://static001.geekbang.org/account/avatar/00/18/80/f4/564209ea.jpg","comment_is_top":false,"comment_ctime":1661498904,"is_pvip":true,"replies":[{"id":"129422","content":"感觉不对，应该是有两个请求才对，多试几次看看。","user_name":"作者回复","user_name_real":"编辑","uid":"1181974","ctime":1661600503,"ip_address":"北京","comment_id":355564,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1661498904","product_id":100029001,"comment_content":"老师您好 有个问题想请教一下 <br>我在用wireshark抓包（127.0.0.1）时，没有显示网页成功的那两个http的包，只有显示找不到图标失败的http包，这个正常么","like_count":0,"discussions":[{"author":{"id":1181974,"avatar":"https://static001.geekbang.org/account/avatar/00/12/09/16/1161017c.jpg","nickname":"罗剑锋","note":"","ucode":"95678C988F24AB","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":585496,"discussion_content":"感觉不对，应该是有两个请求才对，多试几次看看。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1661600503,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"北京"},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":355089,"user_name":"成为优秀的程序员","can_delete":false,"product_type":"c1","uid":2275516,"ip_address":"北京","ucode":"6D9080A2B225AE","user_header":"https://static001.geekbang.org/account/avatar/00/22/b8/bc/d2d547c9.jpg","comment_is_top":false,"comment_ctime":1661072010,"is_pvip":true,"replies":[{"id":"129227","content":"这个是tcp协议的规定，必须要这么做。","user_name":"作者回复","user_name_real":"编辑","uid":"1181974","ctime":1661144352,"ip_address":"北京","comment_id":355089,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1661072010","product_id":100029001,"comment_content":"为什么接收到请求之后，要单独回一个ACK呀？不能放在响应里面会ACK吗？","like_count":0,"discussions":[{"author":{"id":1181974,"avatar":"https://static001.geekbang.org/account/avatar/00/12/09/16/1161017c.jpg","nickname":"罗剑锋","note":"","ucode":"95678C988F24AB","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":584810,"discussion_content":"这个是tcp协议的规定，必须要这么做。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1661144353,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"北京"},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":353305,"user_name":"奕晨","can_delete":false,"product_type":"c1","uid":3000956,"ip_address":"北京","ucode":"59E240369BC1DC","user_header":"https://static001.geekbang.org/account/avatar/00/2d/ca/7c/98193e9e.jpg","comment_is_top":false,"comment_ctime":1659342011,"is_pvip":true,"replies":[{"id":"128450","content":"great","user_name":"作者回复","user_name_real":"编辑","uid":"1181974","ctime":1659358799,"ip_address":"北京","comment_id":353305,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1659342011","product_id":100029001,"comment_content":"1. 你能试着解释一下在浏览器里点击页面链接后发生了哪些事情吗？<br>     1. 地址栏输入链接地址，查找对应的网址对应的IP地址<br>          根据是否缓存中有对应的IP，解析出IP地址<br>      2. 根据IP地址，建立TCP&#47;IP 链接<br>      3. 浏览器发送请求<br>      4. 服务器响应请求<br>2. 如果是一个不存在的域名，那么浏览器的工作流程会是怎么样的呢？<br>    DNS解析IP，会失败，就不会建立TCP&#47;IP连接<br>   ","like_count":0,"discussions":[{"author":{"id":1181974,"avatar":"https://static001.geekbang.org/account/avatar/00/12/09/16/1161017c.jpg","nickname":"罗剑锋","note":"","ucode":"95678C988F24AB","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":582304,"discussion_content":"great","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1659358799,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"北京"},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":350780,"user_name":"joff","can_delete":false,"product_type":"c1","uid":3048755,"ip_address":"","ucode":"EA6172E23057CA","user_header":"https://static001.geekbang.org/account/avatar/00/2e/85/33/bbe2700f.jpg","comment_is_top":false,"comment_ctime":1657187189,"is_pvip":false,"replies":[{"id":"127621","content":"<br>1.本地有缓存当然不会发出网络请求，也就没有tcp连接。<br><br>2.只有缓存过期了，或者强制刷新才会去发请求。","user_name":"作者回复","user_name_real":"编辑","uid":"1181974","ctime":1657188960,"ip_address":"","comment_id":350780,"utype":1}],"discussion_count":2,"race_medal":0,"score":"1657187189","product_id":100029001,"comment_content":"老师 我有两个个问题困惑很久了<br>1.浏览器命中强缓存还会建立tcp连接吗<br>2.浏览器命中强缓存，但请求的服务器已经被更改，那浏览器是读取本地缓存还是重新请求服务器","like_count":0,"discussions":[{"author":{"id":1181974,"avatar":"https://static001.geekbang.org/account/avatar/00/12/09/16/1161017c.jpg","nickname":"罗剑锋","note":"","ucode":"95678C988F24AB","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":579136,"discussion_content":"\n1.本地有缓存当然不会发出网络请求，也就没有tcp连接。\n\n2.只有缓存过期了，或者强制刷新才会去发请求。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1657188961,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1480732,"avatar":"https://static001.geekbang.org/account/avatar/00/16/98/1c/d7a1439e.jpg","nickname":"KaKaKa","note":"","ucode":"07D1980A71F321","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":587755,"discussion_content":"浏览器会根据请求头的 cache-control 字段去判断，内容变了，重新请求，内容不变，过期了，更新缓存信息（协商缓存）","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1663253082,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":"广东"},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":340336,"user_name":"Mandone","can_delete":false,"product_type":"c1","uid":1116017,"ip_address":"","ucode":"FE236389CEF200","user_header":"https://static001.geekbang.org/account/avatar/00/11/07/71/d3049207.jpg","comment_is_top":false,"comment_ctime":1648767730,"is_pvip":true,"replies":[{"id":"124549","content":"看请求链路了，应该是先到cdn，然后再到反向代理的Nginx。","user_name":"作者回复","user_name_real":"编辑","uid":"1181974","ctime":1648989212,"ip_address":"","comment_id":340336,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1648767730","product_id":100029001,"comment_content":"如果请求到服务端中间加了cd和nginx那是要先经过哪一个呢","like_count":0,"discussions":[{"author":{"id":1181974,"avatar":"https://static001.geekbang.org/account/avatar/00/12/09/16/1161017c.jpg","nickname":"罗剑锋","note":"","ucode":"95678C988F24AB","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":559818,"discussion_content":"看请求链路了，应该是先到cdn，然后再到反向代理的Nginx。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1648989212,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":338860,"user_name":"Dexter","can_delete":false,"product_type":"c1","uid":2608728,"ip_address":"","ucode":"909CABC4AC4AC9","user_header":"https://static001.geekbang.org/account/avatar/00/27/ce/58/71ed845f.jpg","comment_is_top":false,"comment_ctime":1647764868,"is_pvip":true,"replies":[{"id":"124063","content":"就是请求网站的小图标，注意观察一下浏览器的标签页。","user_name":"作者回复","user_name_real":"编辑","uid":"1181974","ctime":1648081024,"ip_address":"","comment_id":338860,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1647764868","product_id":100029001,"comment_content":"什么是favicon.ico请求？","like_count":0,"discussions":[{"author":{"id":1181974,"avatar":"https://static001.geekbang.org/account/avatar/00/12/09/16/1161017c.jpg","nickname":"罗剑锋","note":"","ucode":"95678C988F24AB","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":558057,"discussion_content":"就是请求网站的小图标，注意观察一下浏览器的标签页。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1648081024,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":338232,"user_name":"Geek_76c9ea","can_delete":false,"product_type":"c1","uid":1399621,"ip_address":"","ucode":"9B8D0D140134BA","user_header":"","comment_is_top":false,"comment_ctime":1647382920,"is_pvip":true,"replies":[{"id":"123729","content":"一般不会从根dns找，通常在本地dns服务器就可以得到缓存过的ip地址。","user_name":"作者回复","user_name_real":"编辑","uid":"1181974","ctime":1647562413,"ip_address":"","comment_id":338232,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1647382920","product_id":100029001,"comment_content":"客户端根据域名，检查客户端缓存，系统缓存，host文件，没有找到的话，请求dns服务器，从根，顶级，权威，查找主机ip地址，然后经过传输层tcp，和服务器3次握手，建立连接，发送报文给服务器，服务器解析后，根据需求传回数据，浏览器得到数据后，开始渲染","like_count":0,"discussions":[{"author":{"id":1181974,"avatar":"https://static001.geekbang.org/account/avatar/00/12/09/16/1161017c.jpg","nickname":"罗剑锋","note":"","ucode":"95678C988F24AB","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":556871,"discussion_content":"一般不会从根dns找，通常在本地dns服务器就可以得到缓存过的ip地址。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1647562413,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":336277,"user_name":"郭强","can_delete":false,"product_type":"c1","uid":2924454,"ip_address":"","ucode":"06963BC3F4CAB7","user_header":"https://thirdwx.qlogo.cn/mmopen/vi_32/9wVIQxDlyqicpBTwenl38noqFGrsOgdJ70eywrgsNzbJJcOEc5z5HWfRDcfd0dyOuiaiaKOInSRCpTxuYNtoXvJiaw/132","comment_is_top":false,"comment_ctime":1646045640,"is_pvip":false,"replies":[{"id":"122917","content":"great","user_name":"作者回复","user_name_real":"编辑","uid":"1181974","ctime":1646114933,"ip_address":"","comment_id":336277,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1646045640","product_id":100029001,"comment_content":"浏览器缓存、系统缓存、hosts文件、本地DNS服务器、根DNS、顶级DNS、权威DNS、本地CDN、源站","like_count":0,"discussions":[{"author":{"id":1181974,"avatar":"https://static001.geekbang.org/account/avatar/00/12/09/16/1161017c.jpg","nickname":"罗剑锋","note":"","ucode":"95678C988F24AB","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":553834,"discussion_content":"great","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1646114933,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":331655,"user_name":"镜花.水月","can_delete":false,"product_type":"c1","uid":2529101,"ip_address":"","ucode":"DC86DA7BB888F3","user_header":"https://static001.geekbang.org/account/avatar/00/26/97/4d/636e5160.jpg","comment_is_top":false,"comment_ctime":1642688469,"is_pvip":true,"replies":[{"id":"121358","content":"hosts不是缓存，用户可编辑，系统缓存是某个特定地方（内存、磁盘）的文件，用户不可编辑，而且有时效。","user_name":"作者回复","user_name_real":"编辑","uid":"1181974","ctime":1643068601,"ip_address":"","comment_id":331655,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1642688469","product_id":100029001,"comment_content":"TCP三次握手<br>          第一次：发送端发送一个含【SYN】指令的报文给接收端；建立发送端到接收端的通信通道，【SYN】指令是用来验证建立是否顺序<br>          第二次：接收端回应一个含【SYN】和【ACK】指令的报文给发送端，发送端接收到【SYN】知道第一次建立的通信通道(从发送端到接收端)正常；【ACK】指令是用来验证从接收端到发送端通信通道的建立是否顺利<br>此时发送端接收到【ACK】说明通道正常，但接收端自己还不知道<br>               第三次发送端发送一个含【ACK】指令给接收端，接收端接收到发送端来的【ACK】得知第二次建立的通信通道正常(从接收端到发送端)<br> <br>1.你能试着解释一下在浏览器里点击页面链接后发生了哪些事情吗？<br>解析URL, 浏览器得知地址不是数字形式的将会进行DNS的域名解析操作，进行一层层的解析。顺序：浏览器本地缓存--&gt; 操作系统缓存 ---&gt; 本机缓存hosts文件 --&gt; 根DNS --&gt; 顶级DNS  ---&gt; 权威DNS。解析完IP地址将会去寻找IP对应的服务器，有可能在CDN中会有缓存到该IP地址的资源可直接将资源获取。前提是静态资源，像Java,PHP,YPthon等动态生成的资源将无法缓存，只能一层一层的寻找。<br><br>2.如果是一个不存在的域名，那么浏览器的工作流程会是怎么样的呢？<br>      地址URL肯定会进行解析，DNS的解析和寻址都会进行，如果这几个都部进行的话，就无法确定这个地址是否真的不存在，还有存在。<br>DNS解析流程大概一样一样的：浏览器缓存-&gt;系统缓存--&gt;本地hosts文件--&gt;局域网域名服务器-&gt;广域网域名服务器-&gt;顶级域名服务器-&gt;根域名服务器-顶级域名服务器。最终找不到就会抛出相关的异常信息&quot;无法访问此网站&quot;, 等等<br> 对了，老师，有一个问题想请教一下：系统缓存的IP地址和本地hosts文件有什么区别？","like_count":0,"discussions":[{"author":{"id":1181974,"avatar":"https://static001.geekbang.org/account/avatar/00/12/09/16/1161017c.jpg","nickname":"罗剑锋","note":"","ucode":"95678C988F24AB","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":548167,"discussion_content":"hosts不是缓存，用户可编辑，系统缓存是某个特定地方（内存、磁盘）的文件，用户不可编辑，而且有时效。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1643068601,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":329625,"user_name":"咔唧啾唧","can_delete":false,"product_type":"c1","uid":1951652,"ip_address":"","ucode":"5188ED2DC3A70A","user_header":"https://static001.geekbang.org/account/avatar/00/1d/c7/a4/c066b2f8.jpg","comment_is_top":false,"comment_ctime":1641451885,"is_pvip":false,"replies":[{"id":"120271","content":"汗，这个当初确实是欠考虑，随便弄了个名字，现在改起来也比较麻烦了。<br>可以试着自己改一下源码里的Nginx配置文件。","user_name":"作者回复","user_name_real":"编辑","uid":"1181974","ctime":1641813850,"ip_address":"","comment_id":329625,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1641451885","product_id":100029001,"comment_content":"一不小心没有修改hosts，然后访问了http:&#47;&#47;www.chrono.com这个地址，地址怕不是有毒，吓得我抓紧关了。老师以后可以选一个正常点的地址做测试吗……","like_count":0,"discussions":[{"author":{"id":1181974,"avatar":"https://static001.geekbang.org/account/avatar/00/12/09/16/1161017c.jpg","nickname":"罗剑锋","note":"","ucode":"95678C988F24AB","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":545047,"discussion_content":"汗，这个当初确实是欠考虑，随便弄了个名字，现在改起来也比较麻烦了。\n可以试着自己改一下源码里的Nginx配置文件。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1641813850,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":328242,"user_name":"刘敏","can_delete":false,"product_type":"c1","uid":1417888,"ip_address":"","ucode":"AB3FB7D7093D71","user_header":"https://static001.geekbang.org/account/avatar/00/15/a2/a0/df09ef0f.jpg","comment_is_top":false,"comment_ctime":1640617845,"is_pvip":false,"replies":[{"id":"119596","content":"great","user_name":"作者回复","user_name_real":"编辑","uid":"1181974","ctime":1640731829,"ip_address":"","comment_id":328242,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1640617845","product_id":100029001,"comment_content":"1. 你能试着解释一下在浏览器里点击页面链接后发生了哪些事情吗？<br>（1）如果是域名访问，需要进行DNS域名解析转换成IP,因为http协议是基于tcp&#47;ip协议的，需要用ip地址进行连接。<br>（2）域名解析后得到了IP地址，与该ip地址建立TCP&#47;IP连接，这个过程涉及到三次握手。<br>（3）建立连接之后，请求方发送http请求（双方都需要遵守http协议）<br>（4）服务器收到请求并进行处理<br>（5）服务器将处理结果返回给客户端<br>（6）客户端根据返回的结果进行页面渲染，展示给客户<br>（7）关闭TCP&#47;IP连接（不是立刻关闭，因为http&#47;1.1的长链接属性）这里涉及到四次挥手确认的过程。<br><br>2. 这一节课里讲的都是正常的请求处理流程，如果是一个不存在的域名，那么浏览器的工作流程会是怎么样的呢？<br>（1）输入一个不存在的地址并回车<br>（2）查找浏览器DNS缓存是否存在映射关系<br>（3）查找操作系统DNS缓存是否存在映射关系<br>（4）查找hosts文件是否存在映射关系<br>（5）查找本地DNS是否存在映射关系（一般是网络提供商）<br>（6）查找根DNS服务器<br>（7）查找顶级DNS服务器如.com<br>（8）查找权威DNS服务器 存在.com<br>（9）如果权威DNS服务器没有找到，应该会返回一个错误信息，浏览器对应展示‘无法访问此网站’","like_count":0,"discussions":[{"author":{"id":1181974,"avatar":"https://static001.geekbang.org/account/avatar/00/12/09/16/1161017c.jpg","nickname":"罗剑锋","note":"","ucode":"95678C988F24AB","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":542335,"discussion_content":"great","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1640731829,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":310461,"user_name":"维他命","can_delete":false,"product_type":"c1","uid":1954783,"ip_address":"","ucode":"FA62363F61B87E","user_header":"https://static001.geekbang.org/account/avatar/00/1d/d3/df/34fd4ebf.jpg","comment_is_top":false,"comment_ctime":1630661369,"is_pvip":false,"replies":[{"id":"112478","content":"great","user_name":"作者回复","user_name_real":"罗剑锋","uid":"1181974","ctime":1630675673,"ip_address":"","comment_id":310461,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1630661369","product_id":100029001,"comment_content":"从浏览器输入URL后，浏览器首先会对 URL 进行解析，解析出使用的协议、主机域名、目标资源的路径，然后封装一个 HTTP 的请求报文。接着进行域名解析，顺序是：浏览器缓存 -&gt; 操作系统缓存 -&gt; host 文件 -&gt; 本地 dns 服务器 -&gt; 根域名服务器 -&gt; 顶级域名服务器 -&gt; 权威域名服务器 -&gt; 返回 ip 地址。之后将 HTTP 请求报文和 IP 地址交给系统的协议栈处理。首先是交给 TCP 模块，TCP 首先会进行三次握手连接。连接成功后，就将 HTTP 请求报文经过封装并发送给服务器，服务器对报文进行解析，然后封装一个 HTTP 响应报文返回给客户端，客户端通过浏览器的 HTML 排版引擎和 JS 引擎，将数据显示在页面上。注意点：如果请求的是静态数据，那么 DNS 解析就有可能解析到一个 CDN 服务器的地址，然后查看是否有缓存，有的化直接返回，如果没有，再将请求转发到源服务器。","like_count":0,"discussions":[{"author":{"id":1181974,"avatar":"https://static001.geekbang.org/account/avatar/00/12/09/16/1161017c.jpg","nickname":"罗剑锋","note":"","ucode":"95678C988F24AB","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":526244,"discussion_content":"great","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1630675673,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":303147,"user_name":"赵孔磊","can_delete":false,"product_type":"c1","uid":1393960,"ip_address":"","ucode":"63FD48D069A5FD","user_header":"https://static001.geekbang.org/account/avatar/00/15/45/28/16360d2e.jpg","comment_is_top":false,"comment_ctime":1626618291,"is_pvip":false,"replies":[{"id":"109728","content":"需要了解一些tcp、网络协议的基础知识，在前面的破冰篇有简单的介绍。<br><br>http是运行在tcp之上的，所以浏览器要先与服务器建立tcp连接，调用的是socket api，然后再用tcp来收发数据。","user_name":"作者回复","user_name_real":"罗剑锋","uid":"1181974","ctime":1626660394,"ip_address":"","comment_id":303147,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1626618291","product_id":100029001,"comment_content":"老师 浏览器 http 如何与 tcp 建立连接的？是通过 scoket 吗？ ","like_count":0,"discussions":[{"author":{"id":1181974,"avatar":"https://static001.geekbang.org/account/avatar/00/12/09/16/1161017c.jpg","nickname":"罗剑锋","note":"","ucode":"95678C988F24AB","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":523565,"discussion_content":"需要了解一些tcp、网络协议的基础知识，在前面的破冰篇有简单的介绍。\n\nhttp是运行在tcp之上的，所以浏览器要先与服务器建立tcp连接，调用的是socket api，然后再用tcp来收发数据。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1626660394,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":297675,"user_name":"includestdio.h","can_delete":false,"product_type":"c1","uid":2314854,"ip_address":"","ucode":"5027BACE9319CD","user_header":"https://static001.geekbang.org/account/avatar/00/23/52/66/3e4d4846.jpg","comment_is_top":false,"comment_ctime":1623725983,"is_pvip":true,"replies":[{"id":"108090","content":"great。","user_name":"作者回复","user_name_real":"罗剑锋","uid":"1181974","ctime":1623728277,"ip_address":"","comment_id":297675,"utype":1}],"discussion_count":1,"race_medal":4,"score":"1623725983","product_id":100029001,"comment_content":"域名解析：浏览器缓存 操作系统缓存 hosts DNS缓存查询 DNS根域名服务器查询，哪个环节查到从哪个环节短路<br>TCP三次握手：跟解析出来的IP建立连接 <br>浏览器拼接报文发送请求<br>服务端处理请求，拼接报文返回响应结果<br>浏览器根据响应结果对页面进行渲染<br><br>如果是不存在的域名，在走完域名解析的各个环节后，会返回找不到IP地址的报错","like_count":0,"discussions":[{"author":{"id":1181974,"avatar":"https://static001.geekbang.org/account/avatar/00/12/09/16/1161017c.jpg","nickname":"罗剑锋","note":"","ucode":"95678C988F24AB","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":521901,"discussion_content":"great。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1623728277,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":285694,"user_name":"高超","can_delete":false,"product_type":"c1","uid":2531666,"ip_address":"","ucode":"124826ACFCC339","user_header":"","comment_is_top":false,"comment_ctime":1616982504,"is_pvip":false,"replies":[{"id":"103776","content":"great。","user_name":"作者回复","user_name_real":"罗剑锋","uid":"1181974","ctime":1617067578,"ip_address":"","comment_id":285694,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1616982504","product_id":100029001,"comment_content":"第一题<br>点击链接判断是域名还是IP，如果是域名需要dns协议解析成IP地址。顺序依次是，浏览器缓存-系统缓存- hosts文件-野生的dns服务器-根服务器-顶级服务器-权威服务器。获得IP地址后。通过tcp&#47;IP协议建立链接<br>","like_count":0,"discussions":[{"author":{"id":1181974,"avatar":"https://static001.geekbang.org/account/avatar/00/12/09/16/1161017c.jpg","nickname":"罗剑锋","note":"","ucode":"95678C988F24AB","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":517758,"discussion_content":"great。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1617067578,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":282689,"user_name":"刘杰","can_delete":false,"product_type":"c1","uid":2460800,"ip_address":"","ucode":"5B3A55700D6063","user_header":"https://static001.geekbang.org/account/avatar/00/25/8c/80/7310baac.jpg","comment_is_top":false,"comment_ctime":1615365589,"is_pvip":false,"replies":[{"id":"102629","content":"基本正确，不过在dns的解析过程中少了访问本地dns的步骤，通常本地dns就可以得到ip地址，不用再去从根dns查找。","user_name":"作者回复","user_name_real":"罗剑锋","uid":"1181974","ctime":1615422344,"ip_address":"","comment_id":282689,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1615365589","product_id":100029001,"comment_content":"1、在浏览器里点击页面链接，首先会DNS会进行域名解析，先从浏览器缓存中查找是否有缓存该域名对应的IP，如果没有，则依次从操作系统、本地电脑的hosts文件、根DNS、顶级DNS、权威DNS中进行查找，将域名解析成IP之后，则进行TCP连接（三次握手），之后向服务器发送请求，服务器响应请求，渲染页面，期间如果CDN缓存了该页面，那么CDN会代替服务器响应浏览器的请求。<br>2、首先会DNS会进行域名解析，先从浏览器缓存中查找是否有缓存该域名对应的IP，如果没有，则依次从操作系统、本地电脑的hosts文件、根DNS、顶级DNS、权威DNS中进行查找，如果都没有找到，则无法正常建立TCP连接，请求失败","like_count":0,"discussions":[{"author":{"id":1181974,"avatar":"https://static001.geekbang.org/account/avatar/00/12/09/16/1161017c.jpg","nickname":"罗剑锋","note":"","ucode":"95678C988F24AB","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":516811,"discussion_content":"基本正确，不过在dns的解析过程中少了访问本地dns的步骤，通常本地dns就可以得到ip地址，不用再去从根dns查找。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1615422344,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":282406,"user_name":"ragnarok","can_delete":false,"product_type":"c1","uid":2327861,"ip_address":"","ucode":"070CDD0213DF65","user_header":"https://static001.geekbang.org/account/avatar/00/23/85/35/439274c7.jpg","comment_is_top":false,"comment_ctime":1615215956,"is_pvip":false,"replies":[{"id":"102541","content":"一般来说，我们本地访问的都是“野生”dns，由它再去发起解析动作。因为它在本地，速度快，除非你手动指定一个dns服务器的地址。","user_name":"作者回复","user_name_real":"罗剑锋","uid":"1181974","ctime":1615246632,"ip_address":"","comment_id":282406,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1615215956","product_id":100029001,"comment_content":"Hi all，问一下，当我访问一个全新的域名时（尤其是我自己刚刚从域名服务商那里新注册的一个域名），显然浏览器dns缓存、操作系统dns缓存、本地hosts文件，以及操作系统设置的野生DNS都是找不到它的记录的，这时我要去访问根域名服务器了。那么访问根域名服务器这个动作是谁发出的呢？是我本地浏览器吗？还是我设置的那个野生DNS服务器代为去访问呢？<br>换句话说，如果这时我wireshark抓包，能否看到发向根域名服务器的DNS、ICMP等报文呢？还是只能看到与野生DNS的通信呢（它背后再去联系根服务器）？","like_count":0,"discussions":[{"author":{"id":1181974,"avatar":"https://static001.geekbang.org/account/avatar/00/12/09/16/1161017c.jpg","nickname":"罗剑锋","note":"","ucode":"95678C988F24AB","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":516734,"discussion_content":"一般来说，我们本地访问的都是“野生”dns，由它再去发起解析动作。因为它在本地，速度快，除非你手动指定一个dns服务器的地址。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1615246632,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":280705,"user_name":"🔥是希文er啊","can_delete":false,"product_type":"c1","uid":1349886,"ip_address":"","ucode":"0BA75A0646164C","user_header":"https://static001.geekbang.org/account/avatar/00/14/98/fe/4d112a94.jpg","comment_is_top":false,"comment_ctime":1614323327,"is_pvip":false,"replies":[{"id":"101910","content":"可以看后面的答疑篇，在docker环境里用tcpdump抓包。","user_name":"作者回复","user_name_real":"罗剑锋","uid":"1181974","ctime":1614342971,"ip_address":"","comment_id":280705,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1614323327","product_id":100029001,"comment_content":"macos上安装抓包软件都没有Npcap loopback Adapter这个选项","like_count":0,"discussions":[{"author":{"id":1181974,"avatar":"https://static001.geekbang.org/account/avatar/00/12/09/16/1161017c.jpg","nickname":"罗剑锋","note":"","ucode":"95678C988F24AB","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":516187,"discussion_content":"可以看后面的答疑篇，在docker环境里用tcpdump抓包。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1614342971,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":279507,"user_name":"前端4","can_delete":false,"product_type":"c1","uid":2362447,"ip_address":"","ucode":"1FA60422E4E742","user_header":"","comment_is_top":false,"comment_ctime":1613809593,"is_pvip":false,"replies":[{"id":"101607","content":"nice","user_name":"作者回复","user_name_real":"罗剑锋","uid":"1181974","ctime":1613961461,"ip_address":"","comment_id":279507,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1613809593","product_id":100029001,"comment_content":"1. 根据域名解析出域名对应的ip地址（浏览器缓存-》操作系统缓存-》本机映射文件hosts-》非权威域名服务器-》根域名服务器-》顶级域名服务器-》二级域名服务器-》权威域名服务器）；<br>2.用户端拿到ip后，与ip对应的服务器建立连接（TCP三次握手）；<br>3.客户端向服务器发起请求；<br>4.服务器端处理请求，并发送响应数据；<br>5.浏览器解析响应报文，渲染页面；","like_count":0,"discussions":[{"author":{"id":1181974,"avatar":"https://static001.geekbang.org/account/avatar/00/12/09/16/1161017c.jpg","nickname":"罗剑锋","note":"","ucode":"95678C988F24AB","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":515760,"discussion_content":"nice","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1613961461,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":276334,"user_name":"乘风破浪","can_delete":false,"product_type":"c1","uid":2406841,"ip_address":"","ucode":"937AF15F3FEBDC","user_header":"https://static001.geekbang.org/account/avatar/00/24/b9/b9/9e4d7aa4.jpg","comment_is_top":false,"comment_ctime":1611887938,"is_pvip":false,"replies":[{"id":"100300","content":"这个应该是和操作系统的具体实现手法有关了，访问磁盘效率低，所以会用缓存，不过大致的步骤是没错的。","user_name":"作者回复","user_name_real":"罗剑锋","uid":"1181974","ctime":1611896235,"ip_address":"","comment_id":276334,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1611887938","product_id":100029001,"comment_content":"把这个过程也画出了一张图，但省略了 TCP&#47;IP 协议的交互部分，里面的浏览器多出了一个访问 hosts 文件的动作，也就是本机的 DNS 解析<br>---window10实测发现，window启动的时候会加载hosts里的条目到操作系统dns缓存，并且设置一个长达几天的ttl，它应该是静态记录，不会被flushdns删除，<br>所以一般而言，并不会访问hosts文件。<br>我在hosts里新加一条记录，如<br>127.0.0.1  www.aaa.com<br>然后在浏览器里测试www.aaa.com，结果无法访问<br>所以，我怀疑，系统做dns查询时并不会真的去检索hosts文件，而只是启动时将hosts的条目加载到系统dns缓存。<br>---希望有能力的同学能解释一下。<br>","like_count":0,"discussions":[{"author":{"id":1181974,"avatar":"https://static001.geekbang.org/account/avatar/00/12/09/16/1161017c.jpg","nickname":"罗剑锋","note":"","ucode":"95678C988F24AB","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":514669,"discussion_content":"这个应该是和操作系统的具体实现手法有关了，访问磁盘效率低，所以会用缓存，不过大致的步骤是没错的。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1611896235,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":272704,"user_name":"乘风破浪","can_delete":false,"product_type":"c1","uid":2406841,"ip_address":"","ucode":"937AF15F3FEBDC","user_header":"https://static001.geekbang.org/account/avatar/00/24/b9/b9/9e4d7aa4.jpg","comment_is_top":false,"comment_ctime":1610241935,"is_pvip":false,"replies":[{"id":"98895","content":"用git clone的方式吧，别在网站上用浏览器下载，这种方法虽然比较原始，但很可靠。","user_name":"作者回复","user_name_real":"罗剑锋","uid":"1181974","ctime":1610331601,"ip_address":"","comment_id":272704,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1610241935","product_id":100029001,"comment_content":"郁闷，罗老师，github的wireshark抓包下不了<br>用本地dns中继，dns都解析不了<br>换8.8.8.8，dns可以解析，但连接被abort<br>老师是否考虑用中国特色的各类云盘，提供抓包下载？或针对我的这个情况，还有什么办法？<br><br>无法访问此网站网址为 https:&#47;&#47;raw.githubusercontent.com&#47;chronolaw&#47;http_study&#47;master&#47;wireshark&#47;08-1.pcapng 的网页可能暂时无法连接，或者它已永久性地移动到了新网址。<br>ERR_CONNECTION_ABORTED<br>","like_count":0,"discussions":[{"author":{"id":1181974,"avatar":"https://static001.geekbang.org/account/avatar/00/12/09/16/1161017c.jpg","nickname":"罗剑锋","note":"","ucode":"95678C988F24AB","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":513360,"discussion_content":"用git clone的方式吧，别在网站上用浏览器下载，这种方法虽然比较原始，但很可靠。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1610331601,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":272623,"user_name":"乘风破浪","can_delete":false,"product_type":"c1","uid":2406841,"ip_address":"","ucode":"937AF15F3FEBDC","user_header":"https://static001.geekbang.org/account/avatar/00/24/b9/b9/9e4d7aa4.jpg","comment_is_top":false,"comment_ctime":1610179170,"is_pvip":false,"replies":[{"id":"98896","content":"学习态度太认真了，great！","user_name":"作者回复","user_name_real":"罗剑锋","uid":"1181974","ctime":1610331837,"ip_address":"","comment_id":272623,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1610179170","product_id":100029001,"comment_content":"实验的几个总结：<br>favicon.ico问题，貌似是chrome偷摸自动发的一个http请求，源文件里没有，所以报404，再刷新就不请求了<br>304问题，刷新一次，用了浏览器缓存，所以报304<br>ctrl+f5强制刷新，可以看到200,404<br>2个tcp连接问题，还是favicon.ico的问题，chrome开了2个tcp连接，源端口号不同，注意区分<br>wireshark过滤问题，缺省的过滤弹性不够好，可以用下面2个过滤策略<br>看tcp包<br>ip.addr==127.0.0.1 and tcp<br>只看http包<br>ip.addr==127.0.0.1 and http<br><br>辅助http连接验证可以用netstat<br>netstat -ano | find &quot;127.0.0.1:80&quot;<br><br><br>","like_count":0,"discussions":[{"author":{"id":1181974,"avatar":"https://static001.geekbang.org/account/avatar/00/12/09/16/1161017c.jpg","nickname":"罗剑锋","note":"","ucode":"95678C988F24AB","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":513329,"discussion_content":"学习态度太认真了，great！","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1610331837,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":265619,"user_name":"CoffeeMilk","can_delete":false,"product_type":"c1","uid":1522119,"ip_address":"","ucode":"EC3B6AD4FD392A","user_header":"https://static001.geekbang.org/account/avatar/00/17/39/c7/cf40613f.jpg","comment_is_top":false,"comment_ctime":1606962986,"is_pvip":false,"replies":[{"id":"96548","content":"从现象来看，Nginx应该是成功启动了，只是域名解析的问题。<br><br>Windows的我不是太熟悉，按理只要改hosts就可以了，试试“万能的重启”，或者改用Linux或docker环境，参考答疑篇。","user_name":"作者回复","user_name_real":"罗剑锋","uid":"1181974","ctime":1606965757,"ip_address":"","comment_id":265619,"utype":1}],"discussion_count":2,"race_medal":0,"score":"1606962986","product_id":100029001,"comment_content":"老师您好，我这边在搭建好HTTP实验环境后，遇到了一些问题，需要麻烦老师给解答一下，十分感谢。<br>1、问题说明：我这边在使用“最小化”的 HTTP 实验环境搭建成功后（使用了8091端口），也使用【start.bat】成功启动了，且在浏览器输入【127.0.0.1:8091】实现了访问和抓包，且本机的hosts也按照要求正确配置；但是输入【http:&#47;&#47;www.chrono.com】后却显示【ERR_INTERNET_DISCONNECTED】请问该如何解决？","like_count":0,"discussions":[{"author":{"id":1181974,"avatar":"https://static001.geekbang.org/account/avatar/00/12/09/16/1161017c.jpg","nickname":"罗剑锋","note":"","ucode":"95678C988F24AB","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":510999,"discussion_content":"从现象来看，Nginx应该是成功启动了，只是域名解析的问题。\n\nWindows的我不是太熟悉，按理只要改hosts就可以了，试试“万能的重启”，或者改用Linux或docker环境，参考答疑篇。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1606965757,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1522119,"avatar":"https://static001.geekbang.org/account/avatar/00/17/39/c7/cf40613f.jpg","nickname":"CoffeeMilk","note":"","ucode":"EC3B6AD4FD392A","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":332029,"discussion_content":"已经解决，解决方法如下：\n①修改本机host文件，我原来配置host文件时给IP地址添加了端口号，去除IP地址的端口号。\n②在网址后面添加端口号8091即【http://www.chrono.com:8091】。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1607048859,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":244317,"user_name":"xing.org1^","can_delete":false,"product_type":"c1","uid":1374066,"ip_address":"","ucode":"C68AEA172B1623","user_header":"https://static001.geekbang.org/account/avatar/00/14/f7/72/2d35f80c.jpg","comment_is_top":false,"comment_ctime":1598459324,"is_pvip":false,"replies":[{"id":"89969","content":"http的真实处理情况确实是非常复杂的，建议一开始不要这么来，容易晕，先逐个分解，把各自的简单场景弄清楚了，然后再综合起来看。","user_name":"作者回复","user_name_real":"罗剑锋","uid":"1181974","ctime":1598492200,"ip_address":"","comment_id":244317,"utype":1}],"discussion_count":2,"race_medal":1,"score":"1598459324","product_id":100029001,"comment_content":"老师，如果加上强缓存和协商缓存，该在流程的哪个阶段啊？协缓应该也会发请求的吧……好懵啊哈哈，这个题真的太能拓展了","like_count":0,"discussions":[{"author":{"id":1181974,"avatar":"https://static001.geekbang.org/account/avatar/00/12/09/16/1161017c.jpg","nickname":"罗剑锋","note":"","ucode":"95678C988F24AB","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":504547,"discussion_content":"http的真实处理情况确实是非常复杂的，建议一开始不要这么来，容易晕，先逐个分解，把各自的简单场景弄清楚了，然后再综合起来看。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1598492200,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1374066,"avatar":"https://static001.geekbang.org/account/avatar/00/14/f7/72/2d35f80c.jpg","nickname":"xing.org1^","note":"","ucode":"C68AEA172B1623","race_medal":1,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":301577,"discussion_content":"好的","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1598579457,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":243852,"user_name":"出卖灵魂的教练Kerry","can_delete":false,"product_type":"c1","uid":1807943,"ip_address":"","ucode":"8C64517DA556FE","user_header":"https://static001.geekbang.org/account/avatar/00/1b/96/47/93838ff7.jpg","comment_is_top":false,"comment_ctime":1598312409,"is_pvip":true,"replies":[{"id":"89835","content":"我觉得http和rpc差得还是比较多的。<br><br>http是通信协议，而rpc是编程里的概念，强调的是传入参数返回结果的函数调用，虽然grpc就是基于http&#47;2，但两者有联系还是差异很大。<br><br>http的协议只管传输数据，而rpc框架要做的事情就多的很，比如连接保活、服务发现、服务注册、负载均衡等等。<br><br>可以说rpc是建立在http等通信协议之上的。","user_name":"作者回复","user_name_real":"罗剑锋","uid":"1181974","ctime":1598316866,"ip_address":"","comment_id":243852,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1598312409","product_id":100029001,"comment_content":"老师，你好。有人说http从某种意义上可以说是rpc，是否同意？如果是那为什么不直接使用http，而是有各种rpc框架呢？","like_count":0,"discussions":[{"author":{"id":1181974,"avatar":"https://static001.geekbang.org/account/avatar/00/12/09/16/1161017c.jpg","nickname":"罗剑锋","note":"","ucode":"95678C988F24AB","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":504414,"discussion_content":"我觉得http和rpc差得还是比较多的。\n\nhttp是通信协议，而rpc是编程里的概念，强调的是传入参数返回结果的函数调用，虽然grpc就是基于http/2，但两者有联系还是差异很大。\n\nhttp的协议只管传输数据，而rpc框架要做的事情就多的很，比如连接保活、服务发现、服务注册、负载均衡等等。\n\n可以说rpc是建立在http等通信协议之上的。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1598316866,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":242333,"user_name":"乔","can_delete":false,"product_type":"c1","uid":1622655,"ip_address":"","ucode":"1286F8742B4A01","user_header":"https://static001.geekbang.org/account/avatar/00/18/c2/7f/7b22f12b.jpg","comment_is_top":false,"comment_ctime":1597673950,"is_pvip":false,"replies":[{"id":"89458","content":"这个是tcp协议里的调整收发数据速度的“窗口”，具体可以找tcp相关的资料看。","user_name":"作者回复","user_name_real":"罗剑锋","uid":"1181974","ctime":1597712030,"ip_address":"","comment_id":242333,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1597673950","product_id":100029001,"comment_content":"我自己抓包的过程中，有时候会看到 [TCP Window Update]的包，请问老师这是什么包？","like_count":0,"discussions":[{"author":{"id":1181974,"avatar":"https://static001.geekbang.org/account/avatar/00/12/09/16/1161017c.jpg","nickname":"罗剑锋","note":"","ucode":"95678C988F24AB","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":503982,"discussion_content":"这个是tcp协议里的调整收发数据速度的“窗口”，具体可以找tcp相关的资料看。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1597712030,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":240022,"user_name":"迷路的猴子","can_delete":false,"product_type":"c1","uid":1605016,"ip_address":"","ucode":"E64300CD4FB1D0","user_header":"https://static001.geekbang.org/account/avatar/00/18/7d/98/2d1932c9.jpg","comment_is_top":false,"comment_ctime":1596717750,"is_pvip":true,"replies":[{"id":"88641","content":"good","user_name":"作者回复","user_name_real":"罗剑锋","uid":"1181974","ctime":1596761942,"ip_address":"","comment_id":240022,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1596717750","product_id":100029001,"comment_content":"http完整请求<br>1.浏览器访问请求目标<br>2.如果是域名、先经过域名解析（浏览器缓存，系统缓存，本地hosts文件，dns系统查找）成ip地址（有可能是CDN地址）<br>3.创建tcp连接<br>4.http请求到服务器<br>5.服务器返回资源","like_count":0,"discussions":[{"author":{"id":1181974,"avatar":"https://static001.geekbang.org/account/avatar/00/12/09/16/1161017c.jpg","nickname":"罗剑锋","note":"","ucode":"95678C988F24AB","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":503309,"discussion_content":"good","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1596761942,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":236650,"user_name":"马哲富","can_delete":false,"product_type":"c1","uid":1107917,"ip_address":"","ucode":"D6BDDFE3CC07ED","user_header":"https://static001.geekbang.org/account/avatar/00/10/e7/cd/08088f14.jpg","comment_is_top":false,"comment_ctime":1595490669,"is_pvip":false,"replies":[{"id":"87527","content":"是的，准确地说，应该是http的客户端。","user_name":"作者回复","user_name_real":"罗剑锋","uid":"1181974","ctime":1595572896,"ip_address":"","comment_id":236650,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1595490669","product_id":100029001,"comment_content":"老师好，是浏览器在向DNS服务器发送请求么?","like_count":0,"discussions":[{"author":{"id":1181974,"avatar":"https://static001.geekbang.org/account/avatar/00/12/09/16/1161017c.jpg","nickname":"罗剑锋","note":"","ucode":"95678C988F24AB","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":502163,"discussion_content":"是的，准确地说，应该是http的客户端。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1595572896,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":235992,"user_name":"雄鹰","can_delete":false,"product_type":"c1","uid":1786819,"ip_address":"","ucode":"67E0C4BDE7F6F2","user_header":"https://static001.geekbang.org/account/avatar/00/1b/43/c3/2c53acd7.jpg","comment_is_top":false,"comment_ctime":1595285565,"is_pvip":true,"replies":[{"id":"87194","content":"重复两次，就说明有两次tcp握手，也就是说客户端与服务器建立了两个tcp连接，这是浏览器为了提高传输效率而多开的连接，看后面的课程就会明白。<br><br>可以用wireshark的追踪流功能，只看一个连接的数据，这样会比较清楚。","user_name":"作者回复","user_name_real":"罗剑锋","uid":"1181974","ctime":1595293729,"ip_address":"","comment_id":235992,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1595285565","product_id":100029001,"comment_content":"老师你好：我的实验，为什么第1到第3个包（浏览器端口不一样）重复了两次，且没有第7个到第10个包，接下来到第11个到第14个包了？（这个若能上传截图的话，就更清晰了）,Wireshark 选择的是：Adapter for loopback traffic capture","like_count":0,"discussions":[{"author":{"id":1181974,"avatar":"https://static001.geekbang.org/account/avatar/00/12/09/16/1161017c.jpg","nickname":"罗剑锋","note":"","ucode":"95678C988F24AB","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":501913,"discussion_content":"重复两次，就说明有两次tcp握手，也就是说客户端与服务器建立了两个tcp连接，这是浏览器为了提高传输效率而多开的连接，看后面的课程就会明白。\n\n可以用wireshark的追踪流功能，只看一个连接的数据，这样会比较清楚。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1595293729,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":235258,"user_name":"宝仔","can_delete":false,"product_type":"c1","uid":1013493,"ip_address":"","ucode":"A0F17DFF99DB21","user_header":"https://static001.geekbang.org/account/avatar/00/0f/76/f5/e3f5bd8d.jpg","comment_is_top":false,"comment_ctime":1594953075,"is_pvip":true,"replies":[{"id":"86877","content":"这个是wireshark的功能，意思是过滤掉不相关的包，只看感兴趣的数据，看图片上面，有个tcp stream eq 0就是。","user_name":"作者回复","user_name_real":"罗剑锋","uid":"1181974","ctime":1594962018,"ip_address":"","comment_id":235258,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1594953075","product_id":100029001,"comment_content":"老师问下，你文章里提到你使用了滤包功能，滤掉了三个包，我有个疑问：为什么滤掉，滤掉的三个包是什么包，怎么滤的？","like_count":0,"discussions":[{"author":{"id":1181974,"avatar":"https://static001.geekbang.org/account/avatar/00/12/09/16/1161017c.jpg","nickname":"罗剑锋","note":"","ucode":"95678C988F24AB","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":501660,"discussion_content":"这个是wireshark的功能，意思是过滤掉不相关的包，只看感兴趣的数据，看图片上面，有个tcp stream eq 0就是。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1594962018,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":226157,"user_name":"潇潇雨歇","can_delete":false,"product_type":"c1","uid":1251429,"ip_address":"","ucode":"4BD52BF0F0A084","user_header":"https://static001.geekbang.org/account/avatar/00/13/18/65/35361f02.jpg","comment_is_top":false,"comment_ctime":1591965668,"is_pvip":false,"replies":[{"id":"83334","content":"对，可以再参考后面讲cdn的那节课，理解cdn在http请求中的作用。","user_name":"作者回复","user_name_real":"罗剑锋","uid":"1181974","ctime":1592023611,"ip_address":"","comment_id":226157,"utype":1}],"discussion_count":2,"race_medal":0,"score":"1591965668","product_id":100029001,"comment_content":"点击链接后，是域名的话会进行解析，按浏览器缓存-系统缓存-hosts-非权威服务器-根域名服务器-顶级域名服务器-权威域名服务器，中途若有cdn服务器会进行访问。之后发送请求，建立tcp连接，再后面就是浏览器渲染页面了。","like_count":0,"discussions":[{"author":{"id":1181974,"avatar":"https://static001.geekbang.org/account/avatar/00/12/09/16/1161017c.jpg","nickname":"罗剑锋","note":"","ucode":"95678C988F24AB","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":498128,"discussion_content":"对，可以再参考后面讲cdn的那节课，理解cdn在http请求中的作用。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1592023611,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1251429,"avatar":"https://static001.geekbang.org/account/avatar/00/13/18/65/35361f02.jpg","nickname":"潇潇雨歇","note":"","ucode":"4BD52BF0F0A084","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":282593,"discussion_content":"好的，cdn这块的知识确实不是很了解","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1592023657,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":224742,"user_name":"爱学习不害怕","can_delete":false,"product_type":"c1","uid":1245504,"ip_address":"","ucode":"BE325C02E4C92F","user_header":"https://static001.geekbang.org/account/avatar/00/13/01/40/a203a3b9.jpg","comment_is_top":false,"comment_ctime":1591525412,"is_pvip":false,"replies":[{"id":"82757","content":"在实验环境是没有cdn的，只是http的缓存功能，cdn是一个专门的缓存代理服务，可以参考后面的课程。","user_name":"作者回复","user_name_real":"罗剑锋","uid":"1181974","ctime":1591577747,"ip_address":"","comment_id":224742,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1591525412","product_id":100029001,"comment_content":"多次刷新127.0.0.1抓包结果，服务端返回给客户端的http报文的状态码是304，已经利用了缓存。请问此时就是利用到了cdn缓存吗？","like_count":0,"discussions":[{"author":{"id":1181974,"avatar":"https://static001.geekbang.org/account/avatar/00/12/09/16/1161017c.jpg","nickname":"罗剑锋","note":"","ucode":"95678C988F24AB","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":497591,"discussion_content":"在实验环境是没有cdn的，只是http的缓存功能，cdn是一个专门的缓存代理服务，可以参考后面的课程。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1591577747,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":220086,"user_name":"fe_lance","can_delete":false,"product_type":"c1","uid":1684926,"ip_address":"","ucode":"A8EE722AF966A8","user_header":"https://static001.geekbang.org/account/avatar/00/19/b5/be/41e0ed5a.jpg","comment_is_top":false,"comment_ctime":1590152060,"is_pvip":false,"replies":[{"id":"81242","content":"三次握手是重新开了一个连接，没有用上一次的长连接，这也是有可能的，浏览器并发了多个连接，恰好用到了这个新的。","user_name":"作者回复","user_name_real":"chrono","uid":"1181974","ctime":1590157253,"ip_address":"","comment_id":220086,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1590152060","product_id":100029001,"comment_content":"老师，问个问题，我自己在实践的时候，第二次HTTP 返的是304。<br>那么，如果是我本地已经访问过127.0.0.1 了，这个时候再抓包，是不是就不需要三次握手了直接，进入第四个包？  但是我抓包的结果却是从三次握手开始，求解答","like_count":0,"discussions":[{"author":{"id":1181974,"avatar":"https://static001.geekbang.org/account/avatar/00/12/09/16/1161017c.jpg","nickname":"罗剑锋","note":"","ucode":"95678C988F24AB","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":496044,"discussion_content":"三次握手是重新开了一个连接，没有用上一次的长连接，这也是有可能的，浏览器并发了多个连接，恰好用到了这个新的。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1590157253,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":219830,"user_name":"韩俊臣","can_delete":false,"product_type":"c1","uid":1475340,"ip_address":"","ucode":"D6A15C025570D5","user_header":"https://static001.geekbang.org/account/avatar/00/16/83/0c/b9e39db4.jpg","comment_is_top":false,"comment_ctime":1590108522,"is_pvip":false,"replies":[{"id":"81160","content":"先要选好过滤器，不然会有很多无关的包。","user_name":"作者回复","user_name_real":"chrono","uid":"1181974","ctime":1590109109,"ip_address":"","comment_id":219830,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1590108522","product_id":100029001,"comment_content":"老师你好，我把您说的文件下下来后，开启wireshark之后，为啥一直在刷包出来，根本不止14个","like_count":0,"discussions":[{"author":{"id":1181974,"avatar":"https://static001.geekbang.org/account/avatar/00/12/09/16/1161017c.jpg","nickname":"罗剑锋","note":"","ucode":"95678C988F24AB","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":495953,"discussion_content":"先要选好过滤器，不然会有很多无关的包。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1590109109,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":218420,"user_name":"我母鸡啊！","can_delete":false,"product_type":"c1","uid":1633705,"ip_address":"","ucode":"7BFB14BC99E978","user_header":"https://static001.geekbang.org/account/avatar/00/18/ed/a9/662318ab.jpg","comment_is_top":false,"comment_ctime":1589800085,"is_pvip":false,"replies":[{"id":"80791","content":"第二个回答不太正确，找不到域名，就无法建立tcp连接，会报连接失败，404是http请求发送成功但没有内容。","user_name":"作者回复","user_name_real":"chrono","uid":"1181974","ctime":1589849510,"ip_address":"","comment_id":218420,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1589800085","product_id":100029001,"comment_content":"1.点击链接，应该也是一个域名，也要进过dns的解析，换成ip，走tcp连接，接通够http报文传输信息。<br>2.会dns一层一层的查找，最后404报错","like_count":0,"discussions":[{"author":{"id":1181974,"avatar":"https://static001.geekbang.org/account/avatar/00/12/09/16/1161017c.jpg","nickname":"罗剑锋","note":"","ucode":"95678C988F24AB","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":495452,"discussion_content":"第二个回答不太正确，找不到域名，就无法建立tcp连接，会报连接失败，404是http请求发送成功但没有内容。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1589849510,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":218025,"user_name":"do it","can_delete":false,"product_type":"c1","uid":1309911,"ip_address":"","ucode":"E0753912E8F2AF","user_header":"https://static001.geekbang.org/account/avatar/00/13/fc/d7/b102034a.jpg","comment_is_top":false,"comment_ctime":1589698475,"is_pvip":false,"replies":[{"id":"80656","content":"good<br>","user_name":"作者回复","user_name_real":"chrono","uid":"1181974","ctime":1589717340,"ip_address":"","comment_id":218025,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1589698475","product_id":100029001,"comment_content":"作业<br>1、你能试着解释一下在浏览器里点击页面链接后发生了哪些事情吗？<br>1.1、判断地址栏输入的是否是IP，不是则先进行域名解析<br>1.2、通过域名解析获取的IP，发起TCP&#47;IP连接<br>1.3、浏览器组织报文，并发送给服务器<br>1.4、服务器接收报文，解析并返回结果<br>1.5、浏览器接收数据，渲染展示数据<br><br>2、这一节课里讲的都是正常的请求处理流程，如果是一个不存在的域名，那么浏览器的工作流程会是怎么样的呢？<br>2.1、进行域名解析(浏览器缓存-&gt;系统缓存-&gt;本机host-&gt;根-&gt;顶级-&gt;权威)<br>2.1、没有找到对应的IP，返回域名解析错误","like_count":0,"discussions":[{"author":{"id":1181974,"avatar":"https://static001.geekbang.org/account/avatar/00/12/09/16/1161017c.jpg","nickname":"罗剑锋","note":"","ucode":"95678C988F24AB","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":495327,"discussion_content":"good\n","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1589717340,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":216415,"user_name":"放下","can_delete":false,"product_type":"c1","uid":1397434,"ip_address":"","ucode":"1AD911B1E23BDB","user_header":"https://static001.geekbang.org/account/avatar/00/15/52/ba/412b05c1.jpg","comment_is_top":false,"comment_ctime":1589254911,"is_pvip":false,"replies":[{"id":"80084","content":"这个应该是第5讲的内容吧，可以再去复习一下，后面的很多同学答复可以参考。","user_name":"作者回复","user_name_real":"chrono","uid":"1181974","ctime":1589259767,"ip_address":"","comment_id":216415,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1589254911","product_id":100029001,"comment_content":"老师好，能仔细讲讲四层负载均衡与七层负载均衡的区别吗，我对这块一直都是一知半解，很模糊","like_count":0,"discussions":[{"author":{"id":1181974,"avatar":"https://static001.geekbang.org/account/avatar/00/12/09/16/1161017c.jpg","nickname":"罗剑锋","note":"","ucode":"95678C988F24AB","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":494806,"discussion_content":"这个应该是第5讲的内容吧，可以再去复习一下，后面的很多同学答复可以参考。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1589259767,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":216230,"user_name":"小透明","can_delete":false,"product_type":"c1","uid":1800358,"ip_address":"","ucode":"C6FA81B934B5B2","user_header":"http://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTLGxbhxqUsd5OmhxuLM3pGSqib8nqoW0bDNozTLSzz4RyM3rJpCRWW86icYeXBzdLeib3vfILJAicGNbg/132","comment_is_top":false,"comment_ctime":1589207741,"is_pvip":false,"replies":[{"id":"80051","content":"这个可能需要检查一下wireshark的设置了，安装一下最新版本试试，或者网上搜索一下。<br><br>HTTP TCP port(80)是最基本的过滤器，不应该出错的。","user_name":"作者回复","user_name_real":"chrono","uid":"1181974","ctime":1589246175,"ip_address":"","comment_id":216230,"utype":1}],"discussion_count":2,"race_medal":0,"score":"1589207741","product_id":100029001,"comment_content":"你好，输入了HTTP TCP port(80) ，显示我无效捕获过滤器","like_count":0,"discussions":[{"author":{"id":1181974,"avatar":"https://static001.geekbang.org/account/avatar/00/12/09/16/1161017c.jpg","nickname":"罗剑锋","note":"","ucode":"95678C988F24AB","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":494724,"discussion_content":"这个可能需要检查一下wireshark的设置了，安装一下最新版本试试，或者网上搜索一下。\n\nHTTP TCP port(80)是最基本的过滤器，不应该出错的。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1589246175,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1800358,"avatar":"http://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTLGxbhxqUsd5OmhxuLM3pGSqib8nqoW0bDNozTLSzz4RyM3rJpCRWW86icYeXBzdLeib3vfILJAicGNbg/132","nickname":"小透明","note":"","ucode":"C6FA81B934B5B2","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":263769,"discussion_content":"好的，谢谢","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1589246222,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":214305,"user_name":"KaKaKa","can_delete":false,"product_type":"c1","uid":1480732,"ip_address":"","ucode":"07D1980A71F321","user_header":"https://static001.geekbang.org/account/avatar/00/16/98/1c/d7a1439e.jpg","comment_is_top":false,"comment_ctime":1588711322,"is_pvip":false,"replies":[{"id":"79351","content":"回答的很好，不过第一个问题只说了一半，只有dns解析，后面的建立tcp连接发送数据可以再看一下课程正文。","user_name":"作者回复","user_name_real":"罗剑锋","uid":"1181974","ctime":1588726419,"ip_address":"","comment_id":214305,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1588711322","product_id":100029001,"comment_content":"1.你能试着解释一下在浏览器里点击页面链接后发生了哪些事情吗？<br>拿到要跳转的链接 =&gt; 判断到是域名 =&gt; 进行dns 解析流程 =&gt; 查看浏览器缓存 =&gt; 查看系统缓存 =&gt; 查看 hosts 文件 =&gt; 查看非权威域名服务器，如果还没有，则由其向根域名服务器发起请求查看 =&gt; 顶级域名服务器 =&gt; 权威域名服务器（中间如果有一步解析失败，浏览器就会显示 dns 解析失败）<br><br>2.这一节课里讲的都是正常的请求处理流程，如果是一个不存在的域名，那么浏览器的工作流程会是怎么样的呢？<br>域名去解析时，在上述各种缓存中以及域名服务器中找不到，则会显示 dns 解析失败<br>","like_count":0,"discussions":[{"author":{"id":1181974,"avatar":"https://static001.geekbang.org/account/avatar/00/12/09/16/1161017c.jpg","nickname":"罗剑锋","note":"","ucode":"95678C988F24AB","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":494019,"discussion_content":"回答的很好，不过第一个问题只说了一半，只有dns解析，后面的建立tcp连接发送数据可以再看一下课程正文。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1588726419,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":207505,"user_name":"珈蓝白塔","can_delete":false,"product_type":"c1","uid":1131137,"ip_address":"","ucode":"FADBA4B1EC768D","user_header":"https://static001.geekbang.org/account/avatar/00/11/42/81/788cd471.jpg","comment_is_top":false,"comment_ctime":1587095289,"is_pvip":false,"replies":[{"id":"77512","content":"1&#47;2&#47;3不说了。<br><br>4，是这样的。一个域名可以对应多个 IP，一个 IP 可以对应多个域名。前者是DNS解析，后者是虚拟主机（虚拟host），技术上还是有区别的。<br><br>5，IP真正来说应该是网卡，也就是mac地址，所以服务器上插多个网卡就可以有多个ip。ip地址和物理机不完全等同。<br><br>6，有不清楚的可以再问。","user_name":"作者回复","user_name_real":"chrono","uid":"1181974","ctime":1587108727,"ip_address":"","comment_id":207505,"utype":1}],"discussion_count":2,"race_medal":0,"score":"1587095289","product_id":100029001,"comment_content":"请教前辈一个问题，就是物理机器，IP 地址，域名，主机（Host）之间的关系。<br>1. 域名也就是主机名（Host）<br>2.域名解析可以返回多个 IP 地址，即一个域名可以对应多个 IP<br>3.在第七讲自己动手搭建实验环境中，127.0.0.1 这个 IP 地址映射到 3 个域名，即一个 IP 可以对应多个域名<br>4.结合2和3，域名和 IP 地址是多对多的关系吗，不对啊<br>5.一台物理机只能有一个 IP 吗<br>有点迷糊了，尤其是第 4 点，希望前辈有时间指点一下，万分感谢","like_count":0,"discussions":[{"author":{"id":1181974,"avatar":"https://static001.geekbang.org/account/avatar/00/12/09/16/1161017c.jpg","nickname":"罗剑锋","note":"","ucode":"95678C988F24AB","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":492151,"discussion_content":"1/2/3不说了。\n\n4，是这样的。一个域名可以对应多个 IP，一个 IP 可以对应多个域名。前者是DNS解析，后者是虚拟主机（虚拟host），技术上还是有区别的。\n\n5，IP真正来说应该是网卡，也就是mac地址，所以服务器上插多个网卡就可以有多个ip。ip地址和物理机不完全等同。\n\n6，有不清楚的可以再问。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1587108727,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1131137,"avatar":"https://static001.geekbang.org/account/avatar/00/11/42/81/788cd471.jpg","nickname":"珈蓝白塔","note":"","ucode":"FADBA4B1EC768D","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":236674,"discussion_content":"啊，收到！明白啦~","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1587114797,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":203391,"user_name":"勇敢黄瓜","can_delete":false,"product_type":"c1","uid":1150783,"ip_address":"","ucode":"3B6005B4A2CAB8","user_header":"https://static001.geekbang.org/account/avatar/00/11/8f/3f/684f858e.jpg","comment_is_top":false,"comment_ctime":1586183265,"is_pvip":false,"replies":[{"id":"76035","content":"回答的很好。<br><br>第三步有点问题，不是重新组装url，而是用ip地址建立连接，发送http请求，url还是会包含在http请求头里。","user_name":"作者回复","user_name_real":"chrono","uid":"1181974","ctime":1586221841,"ip_address":"","comment_id":203391,"utype":1}],"discussion_count":2,"race_medal":0,"score":"1586183265","product_id":100029001,"comment_content":"1. 你能试着解释一下在浏览器里点击页面链接后发生了哪些事情吗？<br>浏览器点击连接后，发生如下过程：<br>1) 浏览器收到点击事件里面的url，将url解析，得到协议(http)，域名，端口，路径；<br>2) 浏览器根据以下顺序尝试获得域名对应的ip：本地dns client缓存(如有) -&gt; &#47;etc&#47;hosts -&gt; 网络适配器配置的dns服务器(如果是linux则是&#47;etc&#47;resolv.conf) ，到dns服务器这层，dns服务器会进行如下步骤获取解析记录：本地记录-&gt;根dns -&gt; 顶级dns -&gt; 权威dns；<br>3) 如果浏览器获取ip成功，那么会将ip地址替换域名，重新组装url，然后往该ip地址发出请求，内容就是url；<br>4) 发送完成后，浏览器就等待回复，收到服务端的回复后，将对应数据展示到页面上；<br><br>这一节课里讲的都是正常的请求处理流程，如果是一个不存在的域名，那么浏览器的工作流程会是怎么样的呢？<br><br>1)  浏览器按照如下顺序尝试获得域名对应的ip：本地dns client缓存(如有) -&gt; &#47;etc&#47;hosts -&gt; 网络适配器配置的dns服务器(如果是linux则是&#47;etc&#47;resolv.conf) ，到dns服务器这层，dns服务器会进行如下步骤获取解析记录：本地记录-&gt;根dns -&gt; 顶级dns -&gt; 权威dns；<br>2) 如果走完所有步骤都无法获取解析记录，那么浏览器会返回无法访问的信息给用户(如chrome会返回一个&quot;DNS_PROBE_FINISHED_NXDOMAIN&quot;)，而不会发出http请求；","like_count":0,"discussions":[{"author":{"id":1181974,"avatar":"https://static001.geekbang.org/account/avatar/00/12/09/16/1161017c.jpg","nickname":"罗剑锋","note":"","ucode":"95678C988F24AB","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":490853,"discussion_content":"回答的很好。\n\n第三步有点问题，不是重新组装url，而是用ip地址建立连接，发送http请求，url还是会包含在http请求头里。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1586221841,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1150783,"avatar":"https://static001.geekbang.org/account/avatar/00/11/8f/3f/684f858e.jpg","nickname":"勇敢黄瓜","note":"","ucode":"3B6005B4A2CAB8","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":224223,"discussion_content":"感谢chrono老师的解答，还想请教下，url应该是包含在请求报文的请求行里面，对吗","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1586272900,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":197319,"user_name":"Change","can_delete":false,"product_type":"c1","uid":1161260,"ip_address":"","ucode":"FB60D2378C9F02","user_header":"https://static001.geekbang.org/account/avatar/00/11/b8/2c/0f7baf3a.jpg","comment_is_top":false,"comment_ctime":1585367651,"is_pvip":false,"replies":[{"id":"74820","content":"好像之前有过回答，是浏览器建立了多个连接，用来提高收发效率，可参考后面讲的长连接。","user_name":"作者回复","user_name_real":"chrono","uid":"1181974","ctime":1585532307,"ip_address":"","comment_id":197319,"utype":1}],"discussion_count":1,"race_medal":2,"score":"1585367651","product_id":100029001,"comment_content":"老师，为什么是14个包，我看了一下那三个包是又建立了一次握手，但是是不同的端口，这是什么原因呢？","like_count":0,"discussions":[{"author":{"id":1181974,"avatar":"https://static001.geekbang.org/account/avatar/00/12/09/16/1161017c.jpg","nickname":"罗剑锋","note":"","ucode":"95678C988F24AB","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":489494,"discussion_content":"好像之前有过回答，是浏览器建立了多个连接，用来提高收发效率，可参考后面讲的长连接。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1585532307,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":195358,"user_name":"钱","can_delete":false,"product_type":"c1","uid":1009652,"ip_address":"","ucode":"2C92A243A463D4","user_header":"https://static001.geekbang.org/account/avatar/00/0f/67/f4/9a1feb59.jpg","comment_is_top":false,"comment_ctime":1585183431,"is_pvip":false,"replies":[{"id":"74249","content":"<br>1.tcp没有请求一说。小的http可能一来一回就两个tcp包，大的http报文就需要很多包了。<br><br>2&#47;3，需要去看tcp协议，一下子说不清楚。<br><br>4，多了一层，就多了一点成本，还有请求应答模式，自然就没有底层的效率高了。<br><br>5&#47;6，问题太大，也许你看完整个专栏会有自己的见解。<br><br>7，可以看最后的总结篇，在各个节点去排查，主要是依靠经验，毕竟网络环境千差万别。","user_name":"作者回复","user_name_real":"chrono","uid":"1181974","ctime":1585184793,"ip_address":"","comment_id":195358,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1585183431","product_id":100029001,"comment_content":"此篇不但实用而且实惠，面试常客，不过后面还会继续问几个问题的，不知老师是否可以简答一下。<br>1：一次HTTP请求由几次TCP请求完成？<br>2：TCP的建连为什么是三次握手？<br>3：TCP的断连为什么是四次挥手？<br>4：为什么说HTTP比TCP性能差一些？<br>5：HTTP和TCP的优缺点是什么？<br>6：HTTP和TCP的应用场景是什么？为什么这么用？<br>如果这些都能清晰的搞清楚对于排查各种网络问题将会有很大的帮助，另外，老师能简单分享一下请求超时的问题吗？这种问题相当常见，不过常常不了了之，因为错过时间点很难分析，分析了很难验证，即使找到原因也很难解决，只能说什么网络抖动或当时出现了GC影响的，后面就没有下文了，后面还会重复反复出现，请问老师遇到这种问题有没有根治的方法？","like_count":0,"discussions":[{"author":{"id":1181974,"avatar":"https://static001.geekbang.org/account/avatar/00/12/09/16/1161017c.jpg","nickname":"罗剑锋","note":"","ucode":"95678C988F24AB","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":489041,"discussion_content":"\n1.tcp没有请求一说。小的http可能一来一回就两个tcp包，大的http报文就需要很多包了。\n\n2/3，需要去看tcp协议，一下子说不清楚。\n\n4，多了一层，就多了一点成本，还有请求应答模式，自然就没有底层的效率高了。\n\n5/6，问题太大，也许你看完整个专栏会有自己的见解。\n\n7，可以看最后的总结篇，在各个节点去排查，主要是依靠经验，毕竟网络环境千差万别。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1585184793,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":194293,"user_name":"Celine","can_delete":false,"product_type":"c1","uid":1926366,"ip_address":"","ucode":"63D5F2E8FB2130","user_header":"http://thirdwx.qlogo.cn/mmopen/vi_32/DYAIOgq83erwIgbTd3oy4GzkdCUBmz8lHGIIWBwoSIfibgQzwDlQuvTrLlqwTh7p99NBJIsu98ziaYoroQCSENwA/132","comment_is_top":false,"comment_ctime":1585046767,"is_pvip":false,"replies":[{"id":"74076","content":"good。","user_name":"作者回复","user_name_real":"chrono","uid":"1181974","ctime":1585098192,"ip_address":"","comment_id":194293,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1585046767","product_id":100029001,"comment_content":"1:浏览器先判断是否是ip地址，如果不是就进行域名解析，查浏览器缓存，操作系统，host文件，根域名，顶级域名，权威域名逐级获取ip地址，获取到ip地址以后(也有可能获取不到，获取不到就返回错误信息)根据tcp协议经过三次握手建立tcp连接，然后传输http报文，如果服务器设置了CDN则dns可能返回cdn的ip，如果cdn中有缓存直接返回缓存数据，如果没有则继续访问源服务器，高并发情况下，源服务器的入口是负载均衡设备，负载均衡设备会先访问缓存服务器，看有没有缓存，如果没有就访问应用服务器，得到真正的访问资源，然后原路返回，如果资源可以被缓存，原路返回的过程中留一份给缓存，最终回到浏览器<br>","like_count":0,"discussions":[{"author":{"id":1181974,"avatar":"https://static001.geekbang.org/account/avatar/00/12/09/16/1161017c.jpg","nickname":"罗剑锋","note":"","ucode":"95678C988F24AB","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":488807,"discussion_content":"good。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1585098192,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":181052,"user_name":"ican_只会0到9","can_delete":false,"product_type":"c1","uid":1029473,"ip_address":"","ucode":"9EE33C42EE519D","user_header":"https://static001.geekbang.org/account/avatar/00/0f/b5/61/9802a552.jpg","comment_is_top":false,"comment_ctime":1582466704,"is_pvip":false,"replies":[{"id":"70238","content":"据我所知favicon.ico好像只能在浏览器上显示图标，这个好像已经是历史习惯了，其他的没什么用处。","user_name":"作者回复","user_name_real":"chrono","uid":"1181974","ctime":1582507404,"ip_address":"","comment_id":181052,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1582466704","product_id":100029001,"comment_content":"老师，你好：<br>浏览器除了秘密发送favicon.ico 这个请求，作为收藏夹的特殊显示标识，请问还有其他的什么作用吗？","like_count":0,"discussions":[{"author":{"id":1181974,"avatar":"https://static001.geekbang.org/account/avatar/00/12/09/16/1161017c.jpg","nickname":"罗剑锋","note":"","ucode":"95678C988F24AB","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":484899,"discussion_content":"据我所知favicon.ico好像只能在浏览器上显示图标，这个好像已经是历史习惯了，其他的没什么用处。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1582507404,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":179016,"user_name":"Davie Li","can_delete":false,"product_type":"c1","uid":1081882,"ip_address":"","ucode":"E72126F9413C8A","user_header":"https://static001.geekbang.org/account/avatar/00/10/82/1a/8ac9bd45.jpg","comment_is_top":false,"comment_ctime":1581873990,"is_pvip":false,"replies":[{"id":"69485","content":"<br>1.域名解析可以返回多个ip。<br><br>2.hosts写死ip，就不会走dns，如果这个ip是cdn的那么就会走cdn，否则就回源站。","user_name":"作者回复","user_name_real":"chrono","uid":"1181974","ctime":1581910101,"ip_address":"","comment_id":179016,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1581873990","product_id":100029001,"comment_content":"老师，一个域名解析的ip是唯一的吗？cdn多台机器ip肯定不唯一啊，拿到资源的时候时候肯定拿的不是同一个机器的啊，如果我在hosts文件写死IP域名，这样cdn还有用吗","like_count":0,"discussions":[{"author":{"id":1181974,"avatar":"https://static001.geekbang.org/account/avatar/00/12/09/16/1161017c.jpg","nickname":"罗剑锋","note":"","ucode":"95678C988F24AB","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":484063,"discussion_content":"\n1.域名解析可以返回多个ip。\n\n2.hosts写死ip，就不会走dns，如果这个ip是cdn的那么就会走cdn，否则就回源站。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1581910101,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":178431,"user_name":"dongge","can_delete":false,"product_type":"c1","uid":1008016,"ip_address":"","ucode":"CEFE4D0CC42907","user_header":"https://static001.geekbang.org/account/avatar/00/0f/61/90/de8c61a0.jpg","comment_is_top":false,"comment_ctime":1581688234,"is_pvip":true,"replies":[{"id":"69239","content":" <br>这个不应该吧，loopback是本地地址，不需要外网环境，这方面不太了解了。","user_name":"作者回复","user_name_real":"chrono","uid":"1181974","ctime":1581731964,"ip_address":"","comment_id":178431,"utype":1}],"discussion_count":2,"race_medal":0,"score":"1581688234","product_id":100029001,"comment_content":"使用无线网需要监视无线（以太网3）才能得到文章中需要监视 lookback 显示的环境。为什么呢？","like_count":0,"discussions":[{"author":{"id":1181974,"avatar":"https://static001.geekbang.org/account/avatar/00/12/09/16/1161017c.jpg","nickname":"罗剑锋","note":"","ucode":"95678C988F24AB","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":483818,"discussion_content":" \n这个不应该吧，loopback是本地地址，不需要外网环境，这方面不太了解了。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1581731964,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1008016,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/61/90/de8c61a0.jpg","nickname":"dongge","note":"","ucode":"CEFE4D0CC42907","race_medal":0,"user_type":1,"is_pvip":true},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":213453,"discussion_content":"报告罗老师，浏览器被劫持了。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1585096113,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":174453,"user_name":"Ronnyz","can_delete":false,"product_type":"c1","uid":1488280,"ip_address":"","ucode":"9F34527B1D343D","user_header":"https://static001.geekbang.org/account/avatar/00/16/b5/98/ffaf2aca.jpg","comment_is_top":false,"comment_ctime":1580215253,"is_pvip":false,"replies":[{"id":"67816","content":"great。","user_name":"作者回复","user_name_real":"chrono","uid":"1181974","ctime":1580266433,"ip_address":"","comment_id":174453,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1580215253","product_id":100029001,"comment_content":"点击链接后：域名 --&gt; ip和端口号(解析过程为浏览器缓存、系统缓存、host、DNS服务器)，此时如果失败就是第二问的情况，返回dns解析错误信息；查询成果则建立tcp&#47;ip连接，发送GET请求，服务器接收请求，路径正确的话就返回给浏览器。","like_count":0,"discussions":[{"author":{"id":1181974,"avatar":"https://static001.geekbang.org/account/avatar/00/12/09/16/1161017c.jpg","nickname":"罗剑锋","note":"","ucode":"95678C988F24AB","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":482406,"discussion_content":"great。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1580266433,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":174059,"user_name":"人艰不拆","can_delete":false,"product_type":"c1","uid":1388618,"ip_address":"","ucode":"00427E82223338","user_header":"https://static001.geekbang.org/account/avatar/00/15/30/4a/bcc3f82a.jpg","comment_is_top":false,"comment_ctime":1579937262,"is_pvip":false,"replies":[{"id":"67684","content":"说了吧，要选择http port 80过滤器，再仔细看一下。","user_name":"作者回复","user_name_real":"chrono","uid":"1181974","ctime":1579950427,"ip_address":"","comment_id":174059,"utype":1}],"discussion_count":2,"race_medal":0,"score":"1579937262","product_id":100029001,"comment_content":"怎么都不说清楚要打个tcp.port==80过滤一下，一下就几千上万条人都懵逼了，折腾半天","like_count":0,"discussions":[{"author":{"id":1181974,"avatar":"https://static001.geekbang.org/account/avatar/00/12/09/16/1161017c.jpg","nickname":"罗剑锋","note":"","ucode":"95678C988F24AB","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":482286,"discussion_content":"说了吧，要选择http port 80过滤器，再仔细看一下。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1579950427,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1039904,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/de/20/03130a39.jpg","nickname":"沧海一声笑","note":"","ucode":"5297F2F4736B63","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":234925,"discussion_content":"说了的 自己不看清楚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1587006045,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":174058,"user_name":"人艰不拆","can_delete":false,"product_type":"c1","uid":1388618,"ip_address":"","ucode":"00427E82223338","user_header":"https://static001.geekbang.org/account/avatar/00/15/30/4a/bcc3f82a.jpg","comment_is_top":false,"comment_ctime":1579935801,"is_pvip":false,"replies":[{"id":"67685","content":"开篇就说了，要选择过滤器，不然肯定会抓出很多无关的包。","user_name":"作者回复","user_name_real":"chrono","uid":"1181974","ctime":1579950467,"ip_address":"","comment_id":174058,"utype":1}],"discussion_count":2,"race_medal":0,"score":"1579935801","product_id":100029001,"comment_content":"网址都没输就抓了几百个的只有我一个吗，只有十一个是怎么做到的<br>","like_count":0,"discussions":[{"author":{"id":1181974,"avatar":"https://static001.geekbang.org/account/avatar/00/12/09/16/1161017c.jpg","nickname":"罗剑锋","note":"","ucode":"95678C988F24AB","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":482285,"discussion_content":"开篇就说了，要选择过滤器，不然肯定会抓出很多无关的包。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1579950467,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1435733,"avatar":"https://static001.geekbang.org/account/avatar/00/15/e8/55/92f82281.jpg","nickname":"MClink","note":"","ucode":"F479190923355C","race_medal":0,"user_type":1,"is_pvip":true},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":227113,"discussion_content":"兄弟，看文字认真点，学习不能浮躁","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1586450756,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":168348,"user_name":"极客时间","can_delete":false,"product_type":"c1","uid":1015564,"ip_address":"","ucode":"AF7565BB5EF164","user_header":"https://static001.geekbang.org/account/avatar/00/0f/7f/0c/392ce255.jpg","comment_is_top":false,"comment_ctime":1578052320,"is_pvip":false,"replies":[{"id":"65550","content":"通常来说是tcp，但有的时候可能走的是unix domain  socket（本机），在http&#47;3里又会是udp。","user_name":"作者回复","user_name_real":"chrono","uid":"1181974","ctime":1578272771,"ip_address":"","comment_id":168348,"utype":1}],"discussion_count":2,"race_medal":0,"score":"1578052320","product_id":100029001,"comment_content":"http请求本质是不是tcp请求 ","like_count":0,"discussions":[{"author":{"id":1181974,"avatar":"https://static001.geekbang.org/account/avatar/00/12/09/16/1161017c.jpg","nickname":"罗剑锋","note":"","ucode":"95678C988F24AB","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":480200,"discussion_content":"通常来说是tcp，但有的时候可能走的是unix domain  socket（本机），在http/3里又会是udp。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1578272771,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1110437,"avatar":"https://static001.geekbang.org/account/avatar/00/10/f1/a5/6cc9f728.jpg","nickname":"秋天的透明雨🌧️","note":"","ucode":"9363B49BFA6C14","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":288389,"discussion_content":"请问老师，如果走unix domain socket, 是不是就不走网络协议栈了？","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1593740549,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":166807,"user_name":"Khirye","can_delete":false,"product_type":"c1","uid":1080985,"ip_address":"","ucode":"6C54C126FA54B8","user_header":"https://static001.geekbang.org/account/avatar/00/10/7e/99/c4302030.jpg","comment_is_top":false,"comment_ctime":1577603634,"is_pvip":false,"replies":[{"id":"64847","content":"在08-1过滤掉的是4&#47;5&#47;6三个包，是52086&lt;=&gt;80端口的另一个连接。<br><br>在这个抓包里浏览器与服务器建立了两个连接，但只使用了52085收发数据，而第二个52086连接虽然建立了但并没有发生通信，为了叙述清楚就给过滤了。","user_name":"作者回复","user_name_real":"chrono","uid":"1181974","ctime":1577667800,"ip_address":"","comment_id":166807,"utype":1}],"discussion_count":2,"race_medal":0,"score":"1577603634","product_id":100029001,"comment_content":"请问老师，过滤掉的那三个包的具体含义是什么呢？","like_count":0,"discussions":[{"author":{"id":1181974,"avatar":"https://static001.geekbang.org/account/avatar/00/12/09/16/1161017c.jpg","nickname":"罗剑锋","note":"","ucode":"95678C988F24AB","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":479630,"discussion_content":"在08-1过滤掉的是4/5/6三个包，是52086&amp;lt;=&amp;gt;80端口的另一个连接。\n\n在这个抓包里浏览器与服务器建立了两个连接，但只使用了52085收发数据，而第二个52086连接虽然建立了但并没有发生通信，为了叙述清楚就给过滤了。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1577667800,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1080985,"avatar":"https://static001.geekbang.org/account/avatar/00/10/7e/99/c4302030.jpg","nickname":"Khirye","note":"","ucode":"6C54C126FA54B8","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":111107,"discussion_content":"为啥会建立两个连接呢？","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1577780567,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":166806,"user_name":"Khirye","can_delete":false,"product_type":"c1","uid":1080985,"ip_address":"","ucode":"6C54C126FA54B8","user_header":"https://static001.geekbang.org/account/avatar/00/10/7e/99/c4302030.jpg","comment_is_top":false,"comment_ctime":1577603351,"is_pvip":false,"replies":[{"id":"64844","content":"只看第0号tcp流的数据，可以搜索wireshark相关的资料了解更多的表达式语法。","user_name":"作者回复","user_name_real":"chrono","uid":"1181974","ctime":1577667686,"ip_address":"","comment_id":166806,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1577603351","product_id":100029001,"comment_content":"老师，我想问一下，wireshark中的filter里的tcp.stream eq 0是什么含义呢？","like_count":0,"discussions":[{"author":{"id":1181974,"avatar":"https://static001.geekbang.org/account/avatar/00/12/09/16/1161017c.jpg","nickname":"罗剑锋","note":"","ucode":"95678C988F24AB","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":479629,"discussion_content":"只看第0号tcp流的数据，可以搜索wireshark相关的资料了解更多的表达式语法。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1577667686,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":164253,"user_name":"Wr","can_delete":false,"product_type":"c1","uid":1713790,"ip_address":"","ucode":"738B316AA2AD66","user_header":"https://static001.geekbang.org/account/avatar/00/1a/26/7e/823c083e.jpg","comment_is_top":false,"comment_ctime":1576917093,"is_pvip":false,"replies":[{"id":"62545","content":"态度认真，赞！","user_name":"作者回复","user_name_real":"chrono","uid":"1181974","ctime":1577062718,"ip_address":"","comment_id":164253,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1576917093","product_id":100029001,"comment_content":"1.  浏览器从地址栏的输入中获得服务器的 IP 地址和端口号；<br>2. 浏览器用 TCP 的三次握手与服务器建立连接；<br>3. 浏览器向服务器发送拼好的报文；<br>4. 服务器收到报文后处理请求，同样拼好报文再发给浏览器；<br>5. 浏览器解析报文，渲染输出页面。<br><br>不存在的域名：<br>1.  浏览器从地址栏的输入中获得服务器的域名；<br>2. 解析域名（浏览器缓存-&gt;host-&gt;局域网&#47;广域网缓存-&gt;根域名服务器-&gt;顶级域名-&gt;权威域名）<br>","like_count":0,"discussions":[{"author":{"id":1181974,"avatar":"https://static001.geekbang.org/account/avatar/00/12/09/16/1161017c.jpg","nickname":"罗剑锋","note":"","ucode":"95678C988F24AB","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":478695,"discussion_content":"态度认真，赞！","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1577062718,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":159498,"user_name":"尔冬橙","can_delete":false,"product_type":"c1","uid":1225224,"ip_address":"","ucode":"0B013A49BC18DA","user_header":"https://static001.geekbang.org/account/avatar/00/12/b2/08/92f42622.jpg","comment_is_top":false,"comment_ctime":1575639023,"is_pvip":false,"replies":[{"id":"61053","content":"是的，因为http&#47;1.1默认使用长连接，没有关闭连接，所以不需要再次握手，可参考后面的课程。","user_name":"作者回复","user_name_real":"chrono","uid":"1181974","ctime":1575852396,"ip_address":"","comment_id":159498,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1575639023","product_id":100029001,"comment_content":"老师，如果我点击wireshark停止按钮再次抓报，好像就不是从3次握手开始了、<br>","like_count":0,"discussions":[{"author":{"id":1181974,"avatar":"https://static001.geekbang.org/account/avatar/00/12/09/16/1161017c.jpg","nickname":"罗剑锋","note":"","ucode":"95678C988F24AB","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":477079,"discussion_content":"是的，因为http/1.1默认使用长连接，没有关闭连接，所以不需要再次握手，可参考后面的课程。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1575852396,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":159099,"user_name":"ddq432","can_delete":false,"product_type":"c1","uid":1131034,"ip_address":"","ucode":"C84F5727BA37B5","user_header":"https://static001.geekbang.org/account/avatar/00/11/42/1a/de91a790.jpg","comment_is_top":false,"comment_ctime":1575537829,"is_pvip":false,"replies":[{"id":"60895","content":"网站需要提交给dns服务商更改，根服务器不管理具体域名，只管理顶级域名。","user_name":"作者回复","user_name_real":"chrono","uid":"1181974","ctime":1575594277,"ip_address":"","comment_id":159099,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1575537829","product_id":100029001,"comment_content":"一个域名下的ip变了，根服务器是怎么知道的呢","like_count":0,"discussions":[{"author":{"id":1181974,"avatar":"https://static001.geekbang.org/account/avatar/00/12/09/16/1161017c.jpg","nickname":"罗剑锋","note":"","ucode":"95678C988F24AB","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":476947,"discussion_content":"网站需要提交给dns服务商更改，根服务器不管理具体域名，只管理顶级域名。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1575594277,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":157910,"user_name":"果果","can_delete":false,"product_type":"c1","uid":1549835,"ip_address":"","ucode":"447E3A8A76FBD7","user_header":"https://static001.geekbang.org/account/avatar/00/17/a6/0b/d296c751.jpg","comment_is_top":false,"comment_ctime":1575280909,"is_pvip":false,"replies":[{"id":"60580","content":"是的，在这里还没有涉及HTTP的缓存，讲的是无缓存（或者说是第一次请求）时的情况。","user_name":"作者回复","user_name_real":"chrono","uid":"1181974","ctime":1575336762,"ip_address":"","comment_id":157910,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1575280909","product_id":100029001,"comment_content":"我现在有点糊涂，浏览器的强缓存和协商缓存呢如果命中强缓存，直接从本地取数据，不发送请求。如果命中协商缓存，是不是直接发送http请求。您解释的这个是不是有一个前提，第一次请求或者发送的请求no-store，才会出现域名解释的事情。如果面试该怎么回答","like_count":0,"discussions":[{"author":{"id":1181974,"avatar":"https://static001.geekbang.org/account/avatar/00/12/09/16/1161017c.jpg","nickname":"罗剑锋","note":"","ucode":"95678C988F24AB","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":476572,"discussion_content":"是的，在这里还没有涉及HTTP的缓存，讲的是无缓存（或者说是第一次请求）时的情况。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1575336762,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":157458,"user_name":"Nicholas","can_delete":false,"product_type":"c1","uid":1205374,"ip_address":"","ucode":"2FC42B9C579452","user_header":"https://static001.geekbang.org/account/avatar/00/12/64/7e/ea984339.jpg","comment_is_top":false,"comment_ctime":1575168408,"is_pvip":false,"replies":[{"id":"60446","content":"http协议是基于tcp栈的，上层是http，下层是tcp，在wireshark里可以展开堆栈，可以用鼠标试着点点。","user_name":"作者回复","user_name_real":"chrono","uid":"1181974","ctime":1575248408,"ip_address":"","comment_id":157458,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1575168408","product_id":100029001,"comment_content":"老师好，文中写到：通过TCP发送了一个“GET &#47; HTTP&#47;1.1”请求报文。但是我通过下载您提供的文件“08-1.pacpng”，在Wireshark中看到显示协议是HTTP，这是为什么？","like_count":0,"discussions":[{"author":{"id":1181974,"avatar":"https://static001.geekbang.org/account/avatar/00/12/09/16/1161017c.jpg","nickname":"罗剑锋","note":"","ucode":"95678C988F24AB","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":476430,"discussion_content":"http协议是基于tcp栈的，上层是http，下层是tcp，在wireshark里可以展开堆栈，可以用鼠标试着点点。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1575248408,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":154969,"user_name":"keep it simple","can_delete":false,"product_type":"c1","uid":1574739,"ip_address":"","ucode":"72B8DC00247C9E","user_header":"https://static001.geekbang.org/account/avatar/00/18/07/53/05aa9573.jpg","comment_is_top":false,"comment_ctime":1574606776,"is_pvip":false,"replies":[{"id":"59499","content":"首包时间TTFB（Time To First Byte）不是指ack，而是响应数据的第一个字节到达客户端的时间，包括服务器的处理时间和网络传输时间。可参考第39讲。<br><br>首包时间长表示服务器响应慢，原因可能是服务器压力大或者是网络问题。","user_name":"作者回复","user_name_real":"chrono","uid":"1181974","ctime":1574643586,"ip_address":"","comment_id":154969,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1574606776","product_id":100029001,"comment_content":"老师，请教下在TCP建连后，浏览器发GET，然后服务器回一个TCP层面的ACK，这个包就是通常所说的“首包时间”吗？我大概知道首包时间长通常是服务器性能不行了，这样理解正确吗，为什么？","like_count":0,"discussions":[{"author":{"id":1181974,"avatar":"https://static001.geekbang.org/account/avatar/00/12/09/16/1161017c.jpg","nickname":"罗剑锋","note":"","ucode":"95678C988F24AB","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":475627,"discussion_content":"首包时间TTFB（Time To First Byte）不是指ack，而是响应数据的第一个字节到达客户端的时间，包括服务器的处理时间和网络传输时间。可参考第39讲。\n\n首包时间长表示服务器响应慢，原因可能是服务器压力大或者是网络问题。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1574643586,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":154736,"user_name":"lesserror","can_delete":false,"product_type":"c1","uid":1351076,"ip_address":"","ucode":"25A54D1165FCF6","user_header":"https://static001.geekbang.org/account/avatar/00/14/9d/a4/e481ae48.jpg","comment_is_top":false,"comment_ctime":1574525844,"is_pvip":false,"replies":[{"id":"59501","content":"mac上我用的是tcpdump，mac版的wireshark没用过，抱歉了。","user_name":"作者回复","user_name_real":"chrono","uid":"1181974","ctime":1574643654,"ip_address":"","comment_id":154736,"utype":1}],"discussion_count":6,"race_medal":0,"score":"1574525844","product_id":100029001,"comment_content":"老师，Mac版本的wireshark我始终没有找到这个“Npcap loopback Adapter”，有点不服气，在这里卡了好久，老师你下载一个Mac版本的wireshark试试看，奇怪了。希望老师看见了，回复一下。多谢了。","like_count":0,"discussions":[{"author":{"id":1181974,"avatar":"https://static001.geekbang.org/account/avatar/00/12/09/16/1161017c.jpg","nickname":"罗剑锋","note":"","ucode":"95678C988F24AB","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":475568,"discussion_content":"mac上我用的是tcpdump，mac版的wireshark没用过，抱歉了。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1574643654,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1110437,"avatar":"https://static001.geekbang.org/account/avatar/00/10/f1/a5/6cc9f728.jpg","nickname":"秋天的透明雨🌧️","note":"","ucode":"9363B49BFA6C14","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":288384,"discussion_content":"Mac的Wireshark里边是Loopback:lo0, 没有的话更新到最新版本，当前是3.2.5","likes_number":1,"is_delete":false,"is_hidden":false,"ctime":1593739849,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1338328,"avatar":"https://static001.geekbang.org/account/avatar/00/14/6b/d8/2aed993f.jpg","nickname":"Lim Guo","note":"","ucode":"06E2394883A2D7","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":221739,"discussion_content":"我也没有找到，弄了一两天了，卡在这里都不知道怎么往下走，你有什么解决办法吗？","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1586054863,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":2,"child_discussions":[{"author":{"id":1351076,"avatar":"https://static001.geekbang.org/account/avatar/00/14/9d/a4/e481ae48.jpg","nickname":"lesserror","note":"","ucode":"25A54D1165FCF6","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":1338328,"avatar":"https://static001.geekbang.org/account/avatar/00/14/6b/d8/2aed993f.jpg","nickname":"Lim Guo","note":"","ucode":"06E2394883A2D7","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":221772,"discussion_content":"好像没解决……","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1586059607,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":221739,"ip_address":""},"score":221772,"extra":""},{"author":{"id":1066805,"avatar":"https://static001.geekbang.org/account/avatar/00/10/47/35/23458b15.jpg","nickname":"德古拉","note":"","ucode":"F6105053E89FC5","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":1338328,"avatar":"https://static001.geekbang.org/account/avatar/00/14/6b/d8/2aed993f.jpg","nickname":"Lim Guo","note":"","ucode":"06E2394883A2D7","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":286379,"discussion_content":"Loopback:lo0 ","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1593153275,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":221739,"ip_address":""},"score":286379,"extra":""}]},{"author":{"id":1351076,"avatar":"https://static001.geekbang.org/account/avatar/00/14/9d/a4/e481ae48.jpg","nickname":"lesserror","note":"","ucode":"25A54D1165FCF6","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":57818,"discussion_content":"没事，老师😂😂","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1574643958,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":154168,"user_name":"nora","can_delete":false,"product_type":"c1","uid":1206539,"ip_address":"","ucode":"3A3EABF27D0261","user_header":"https://static001.geekbang.org/account/avatar/00/12/69/0b/780b0aac.jpg","comment_is_top":false,"comment_ctime":1574386682,"is_pvip":false,"replies":[{"id":"59265","content":"那就会在tcp层次发生连接失败，或者连接到了错误的其他网站。","user_name":"作者回复","user_name_real":"chrono","uid":"1181974","ctime":1574409633,"ip_address":"","comment_id":154168,"utype":1}],"discussion_count":2,"race_medal":0,"score":"1574386682","product_id":100029001,"comment_content":"有个疑问是，如果DNS解析得到的IP已经失效，并不是当前最新的IP，会发生什么呢？<br>","like_count":0,"discussions":[{"author":{"id":1181974,"avatar":"https://static001.geekbang.org/account/avatar/00/12/09/16/1161017c.jpg","nickname":"罗剑锋","note":"","ucode":"95678C988F24AB","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":475392,"discussion_content":"那就会在tcp层次发生连接失败，或者连接到了错误的其他网站。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1574409633,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1206539,"avatar":"https://static001.geekbang.org/account/avatar/00/12/69/0b/780b0aac.jpg","nickname":"nora","note":"","ucode":"3A3EABF27D0261","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":58226,"discussion_content":"那么 \n1. 发生链接错误时，会重新进行DNS解析嘛？\n2. 假如连接到了错误的IP，那么什么时候会更新成为正确的IP呢？或者有什么办法可以更正DNS的解析错误","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1574659719,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":152871,"user_name":"LL","can_delete":false,"product_type":"c1","uid":1712102,"ip_address":"","ucode":"1E4E6CF7A050BF","user_header":"https://static001.geekbang.org/account/avatar/00/1a/1f/e6/2c51b961.jpg","comment_is_top":false,"comment_ctime":1574092385,"is_pvip":false,"replies":[{"id":"58727","content":"“拦截”发生在域名解析阶段，所以浏览器与cdn也是通过http&#47;https协议连接的，只是这个时候连接的不是源站，而是cdn服务器，可以参考一下第37讲。","user_name":"作者回复","user_name_real":"chrono","uid":"1181974","ctime":1574125051,"ip_address":"","comment_id":152871,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1574092385","product_id":100029001,"comment_content":"资源被cdn拦截，HTTPS能校验通过吗?","like_count":0,"discussions":[{"author":{"id":1181974,"avatar":"https://static001.geekbang.org/account/avatar/00/12/09/16/1161017c.jpg","nickname":"罗剑锋","note":"","ucode":"95678C988F24AB","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":474970,"discussion_content":"“拦截”发生在域名解析阶段，所以浏览器与cdn也是通过http/https协议连接的，只是这个时候连接的不是源站，而是cdn服务器，可以参考一下第37讲。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1574125051,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":131703,"user_name":"Bayes","can_delete":false,"product_type":"c1","uid":1539608,"ip_address":"","ucode":"2F83B2EFCE6B5D","user_header":"https://static001.geekbang.org/account/avatar/00/17/7e/18/c3ed4650.jpg","comment_is_top":false,"comment_ctime":1567857936,"is_pvip":false,"replies":[{"id":"50413","content":"感谢补充。","user_name":"作者回复","user_name_real":"chrono","uid":"1181974","ctime":1567991220,"ip_address":"","comment_id":131703,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1567857936","product_id":100029001,"comment_content":"如果抓包的时候返回304，可以在Chrome浏览器里使用ctrl+F5刷新","like_count":0,"discussions":[{"author":{"id":1181974,"avatar":"https://static001.geekbang.org/account/avatar/00/12/09/16/1161017c.jpg","nickname":"罗剑锋","note":"","ucode":"95678C988F24AB","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":466580,"discussion_content":"感谢补充。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1567991220,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":110637,"user_name":"潘会大","can_delete":false,"product_type":"c1","uid":1015004,"ip_address":"","ucode":"41085C621B8BEF","user_header":"https://static001.geekbang.org/account/avatar/00/0f/7c/dc/d9fa47b1.jpg","comment_is_top":false,"comment_ctime":1562308738,"is_pvip":false,"replies":[{"id":"40215","content":"是的。","user_name":"作者回复","user_name_real":"chrono","uid":"1181974","ctime":1562318836,"ip_address":"","comment_id":110637,"utype":1}],"discussion_count":3,"race_medal":0,"score":"1562308738","product_id":100029001,"comment_content":"老师你好，缓存Redis，是在应用服务器与数据库之间的环节吧","like_count":0,"discussions":[{"author":{"id":1181974,"avatar":"https://static001.geekbang.org/account/avatar/00/12/09/16/1161017c.jpg","nickname":"罗剑锋","note":"","ucode":"95678C988F24AB","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":456980,"discussion_content":"是的。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1562318836,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1308653,"avatar":"http://thirdwx.qlogo.cn/mmopen/vi_32/0PT9LxT8D6micyk0YbPuGQElQIeSax7puBBTXJDicJDhUHNibrbJPjEPJBRklVmcKG1PB7YV8JNh0BpsJjSicfibT5A/132","nickname":"Wendy","note":"","ucode":"398DDC96B178F7","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":7167,"discussion_content":"redis没有固定的位置。在应用服务器之前的，叫前端页面缓存。在应用服务器之后的，叫后端数据缓存","likes_number":1,"is_delete":false,"is_hidden":false,"ctime":1567411910,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1015004,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/7c/dc/d9fa47b1.jpg","nickname":"潘会大","note":"","ucode":"41085C621B8BEF","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":7867,"discussion_content":"谢谢","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1567693954,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":106710,"user_name":"王二宝","can_delete":false,"product_type":"c1","uid":1042241,"ip_address":"","ucode":"E147D6E597EF5B","user_header":"https://static001.geekbang.org/account/avatar/00/0f/e7/41/2ea1f5dc.jpg","comment_is_top":false,"comment_ctime":1561376814,"is_pvip":false,"replies":[{"id":"38691","content":"总结的很好！","user_name":"作者回复","user_name_real":"chrono","uid":"1181974","ctime":1561430391,"ip_address":"","comment_id":106710,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1561376814","product_id":100029001,"comment_content":"HTTP 协议基于底层的 TCP&#47;IP 协议，所以必须要用 IP 地址建立连接； 如果不知道 IP 地址，就要用 DNS 协议去解析得到 IP 地址，否则就会连接失败； 建立 TCP 连接后会顺序收发数据，请求方和应答方都必须依据 HTTP 规范构建和解析报文； 为了减少响应时间，整个过程中的每一个环节都会有缓存，能够实现“短路”操作； 虽然现实中的 HTTP 传输过程非常复杂，但理论上仍然可以简化成实验里的“两点”模型。<br>","like_count":0,"discussions":[{"author":{"id":1181974,"avatar":"https://static001.geekbang.org/account/avatar/00/12/09/16/1161017c.jpg","nickname":"罗剑锋","note":"","ucode":"95678C988F24AB","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":455189,"discussion_content":"总结的很好！","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1561430391,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":106706,"user_name":"梓航(﹏)","can_delete":false,"product_type":"c1","uid":1027773,"ip_address":"","ucode":"8ECA3C994D697C","user_header":"https://static001.geekbang.org/account/avatar/00/0f/ae/bd/d12f8907.jpg","comment_is_top":false,"comment_ctime":1561375420,"is_pvip":true,"replies":[{"id":"38689","content":"tcp连接是用socket api打开的，只要不调用close，就会一直打开，在打开的时间里就可以收发数据。<br><br>keepalive只是个“指示”，告诉客户端这个连接不会立即调用close关闭，它是对应连接的，与线程无关。<br><br>后面还会专门讲连接管理。","user_name":"作者回复","user_name_real":"chrono","uid":"1181974","ctime":1561430377,"ip_address":"","comment_id":106706,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1561375420","product_id":100029001,"comment_content":"老师，我不明白 tcp 三次握手后的连接是怎么保持住的？还有 http 头里面的 keep alive，它怎么就让连接 hold 住了的？是一个连接对应一个线程还是怎么回事？","like_count":0,"discussions":[{"author":{"id":1181974,"avatar":"https://static001.geekbang.org/account/avatar/00/12/09/16/1161017c.jpg","nickname":"罗剑锋","note":"","ucode":"95678C988F24AB","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":455185,"discussion_content":"tcp连接是用socket api打开的，只要不调用close，就会一直打开，在打开的时间里就可以收发数据。\n\nkeepalive只是个“指示”，告诉客户端这个连接不会立即调用close关闭，它是对应连接的，与线程无关。\n\n后面还会专门讲连接管理。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1561430377,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":105105,"user_name":"没有梦想的咸🐠","can_delete":false,"product_type":"c1","uid":1564548,"ip_address":"","ucode":"6678DD4222CF17","user_header":"https://static001.geekbang.org/account/avatar/00/17/df/84/f7b759d9.jpg","comment_is_top":false,"comment_ctime":1560918355,"is_pvip":false,"replies":[{"id":"38085","content":"你在GitHub上的包我下载后用wireshark无法打开，不知道是用那个版本抓的。<br><br>过滤设置成“tcp port 80”，如果还不行再断网试试。","user_name":"作者回复","user_name_real":"chrono","uid":"1181974","ctime":1560923872,"ip_address":"","comment_id":105105,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1560918355","product_id":100029001,"comment_content":"设置过滤器了   过滤后还是会出现不对浏览器做操作就有tcp包","like_count":0,"discussions":[{"author":{"id":1181974,"avatar":"https://static001.geekbang.org/account/avatar/00/12/09/16/1161017c.jpg","nickname":"罗剑锋","note":"","ucode":"95678C988F24AB","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":454561,"discussion_content":"你在GitHub上的包我下载后用wireshark无法打开，不知道是用那个版本抓的。\n\n过滤设置成“tcp port 80”，如果还不行再断网试试。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1560923872,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":105101,"user_name":"没有梦想的咸🐠","can_delete":false,"product_type":"c1","uid":1564548,"ip_address":"","ucode":"6678DD4222CF17","user_header":"https://static001.geekbang.org/account/avatar/00/17/df/84/f7b759d9.jpg","comment_is_top":false,"comment_ctime":1560917071,"is_pvip":false,"replies":[{"id":"38082","content":"需要设置过滤器，否则会抓到很多无关的包。","user_name":"作者回复","user_name_real":"chrono","uid":"1181974","ctime":1560917817,"ip_address":"","comment_id":105101,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1560917071","product_id":100029001,"comment_content":"老师，我在开启抓包后即使不对浏览器做任何操作都会有包出现，而且我抓包总有psh的包出现，这是为什么呢？我查资料也没看懂，我抓的包放在了这，希望老师有时间可以帮我解答一下https:&#47;&#47;github.com&#47;zcl-zcl6&#47;N_QUEENS.git","like_count":0,"discussions":[{"author":{"id":1181974,"avatar":"https://static001.geekbang.org/account/avatar/00/12/09/16/1161017c.jpg","nickname":"罗剑锋","note":"","ucode":"95678C988F24AB","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":454559,"discussion_content":"需要设置过滤器，否则会抓到很多无关的包。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1560917817,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":104532,"user_name":"肖大妞","can_delete":false,"product_type":"c1","uid":1426644,"ip_address":"","ucode":"2AD2F8684FDCF8","user_header":"https://static001.geekbang.org/account/avatar/00/15/c4/d4/5c8fb1cb.jpg","comment_is_top":false,"comment_ctime":1560773111,"is_pvip":false,"replies":[{"id":"37860","content":"这个跟浏览器有关，有的浏览器可能不会发get favicon.ico的操作。","user_name":"作者回复","user_name_real":"chrono","uid":"1181974","ctime":1560819981,"ip_address":"","comment_id":104532,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1560773111","product_id":100029001,"comment_content":"在Mac下实验了一下，发现在http&#47;1.1 200之后紧跟着一个ack就结束了，并没有后续的getimage的操作，是因为nginx.conf里没配对应的server和location吗","like_count":0,"discussions":[{"author":{"id":1181974,"avatar":"https://static001.geekbang.org/account/avatar/00/12/09/16/1161017c.jpg","nickname":"罗剑锋","note":"","ucode":"95678C988F24AB","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":454311,"discussion_content":"这个跟浏览器有关，有的浏览器可能不会发get favicon.ico的操作。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1560819981,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":104450,"user_name":"无名","can_delete":false,"product_type":"c1","uid":1110113,"ip_address":"","ucode":"2D2E877CF97138","user_header":"https://static001.geekbang.org/account/avatar/00/10/f0/61/68462a07.jpg","comment_is_top":false,"comment_ctime":1560757017,"is_pvip":false,"replies":[{"id":"37857","content":"因为我们的实验环境很简单，所以虽然建立了两个连接但有一个是空闲的，相当于“备用”。<br><br>如果是大网站，那么这些连接就都会用于传输数据。","user_name":"作者回复","user_name_real":"chrono","uid":"1181974","ctime":1560819880,"ip_address":"","comment_id":104450,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1560757017","product_id":100029001,"comment_content":"抓包结果显示我进行了两趟三次握手，看客户端端口，是两个，也就是建立了2个连接。但没有明白为何一个请求要建立2个连接。看后面的包，都用都是第一个连接，那第一个连接为何握手成功了不用，而是再此建立连接。","like_count":0,"discussions":[{"author":{"id":1181974,"avatar":"https://static001.geekbang.org/account/avatar/00/12/09/16/1161017c.jpg","nickname":"罗剑锋","note":"","ucode":"95678C988F24AB","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":454276,"discussion_content":"因为我们的实验环境很简单，所以虽然建立了两个连接但有一个是空闲的，相当于“备用”。\n\n如果是大网站，那么这些连接就都会用于传输数据。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1560819880,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":104378,"user_name":"壹笙☞漂泊","can_delete":false,"product_type":"c1","uid":1092577,"ip_address":"","ucode":"3A0B8EC881665C","user_header":"https://static001.geekbang.org/account/avatar/00/10/ab/e1/f6b921fa.jpg","comment_is_top":false,"comment_ctime":1560741065,"is_pvip":false,"replies":[{"id":"37801","content":"dns的解析要注意，应该是根DNS-&gt;顶级DNS","user_name":"作者回复","user_name_real":"chrono","uid":"1181974","ctime":1560747202,"ip_address":"","comment_id":104378,"utype":1}],"discussion_count":2,"race_medal":0,"score":"1560741065","product_id":100029001,"comment_content":"答题：<br>1、在页面点击连接，和直接访问一个连接，流程是相同的<br>2、输入一个不存在域名，首先会进行DNS解析，经过浏览器缓存 - 系统缓存 - host - 局域网DNS - 广域网DNS - 顶级DNS - 根DNS之后找不到对应的ip地址，会返回个报错页面<br><br>总结：<br>输入域名访问：<br>1、解析域名，找到对应的ip地址<br>    浏览器本地DNS缓存-&gt;系统缓存-&gt;本地host文件-&gt;局域网DNS-&gt;广域网DNS-&gt;顶级DNS-&gt;根DNS<br>2、通过ip地址和端口号，与服务器建立连接——三次握手<br>    SYN-&gt;(SYN&#47;ACK)-&gt;ACK<br>3、浏览器向服务器发送拼好的报文——第四个包<br>4、服务器收到请求后返回确认报文——第五个包<br>5、服务器解析请求内容，并将对应的结果拼成http格式的报文，发给浏览器——第六个包<br>6、浏览器收到报文后，返回给服务器一个确认报文——第七个包<br>7、关闭连接——四次挥手<br>    FIN-&gt;ACK-&gt;FIN-&gt;ACK","like_count":0,"discussions":[{"author":{"id":1181974,"avatar":"https://static001.geekbang.org/account/avatar/00/12/09/16/1161017c.jpg","nickname":"罗剑锋","note":"","ucode":"95678C988F24AB","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":454248,"discussion_content":"dns的解析要注意，应该是根DNS-&amp;gt;顶级DNS","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1560747202,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1079206,"avatar":"https://static001.geekbang.org/account/avatar/00/10/77/a6/cbdd5056.jpg","nickname":"木子的昼夜","note":"","ucode":"7F025051769E43","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":1208,"discussion_content":"应该会有7 但是现在http都是长连接 为了尽可能的复用 所以就没有四次挥手了   老师说","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1562403144,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":104337,"user_name":"无名","can_delete":false,"product_type":"c1","uid":1110113,"ip_address":"","ucode":"2D2E877CF97138","user_header":"https://static001.geekbang.org/account/avatar/00/10/f0/61/68462a07.jpg","comment_is_top":false,"comment_ctime":1560733823,"is_pvip":false,"replies":[{"id":"37782","content":"dns缓存有有效期，过期了就会去上级dns更新。","user_name":"作者回复","user_name_real":"chrono","uid":"1181974","ctime":1560736359,"ip_address":"","comment_id":104337,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1560733823","product_id":100029001,"comment_content":"DNS对于域名的解析流程是： 先查浏览器缓存，然后是系统缓存-＞hosts文件-＞局域网域名服务器-＞广域网域名服务器-＞顶级域名服务器-＞根域名服务器（郭凯强总结）。<br>这个比较清楚，老师能讲一下域名数据一致性的问题吗？如域名对应的主机地址变了，那这些缓存又是怎么知道自己的缓存已经无效了的？","like_count":0,"discussions":[{"author":{"id":1181974,"avatar":"https://static001.geekbang.org/account/avatar/00/12/09/16/1161017c.jpg","nickname":"罗剑锋","note":"","ucode":"95678C988F24AB","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":454233,"discussion_content":"dns缓存有有效期，过期了就会去上级dns更新。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1560736359,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":104291,"user_name":"利","can_delete":false,"product_type":"c1","uid":1346711,"ip_address":"","ucode":"561249904EEED5","user_header":"https://static001.geekbang.org/account/avatar/00/14/8c/97/f00593ab.jpg","comment_is_top":false,"comment_ctime":1560729324,"is_pvip":false,"replies":[{"id":"37770","content":"这个属于tcp，不在本专栏范围内，而且三次握手也并不是必要的，比如quic就没有这样。","user_name":"作者回复","user_name_real":"chrono","uid":"1181974","ctime":1560734038,"ip_address":"","comment_id":104291,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1560729324","product_id":100029001,"comment_content":"老师，能不能讲下3次握手建立连接的，优越性和必要性","like_count":0,"discussions":[{"author":{"id":1181974,"avatar":"https://static001.geekbang.org/account/avatar/00/12/09/16/1161017c.jpg","nickname":"罗剑锋","note":"","ucode":"95678C988F24AB","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":454210,"discussion_content":"这个属于tcp，不在本专栏范围内，而且三次握手也并不是必要的，比如quic就没有这样。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1560734038,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":104208,"user_name":"rock_","can_delete":false,"product_type":"c1","uid":1513632,"ip_address":"","ucode":"A1D70CD69A8BD4","user_header":"https://static001.geekbang.org/account/avatar/00/17/18/a0/cf26f9f2.jpg","comment_is_top":false,"comment_ctime":1560681366,"is_pvip":false,"replies":[{"id":"37731","content":"是的，你可以试试。","user_name":"作者回复","user_name_real":"chrono","uid":"1181974","ctime":1560686129,"ip_address":"","comment_id":104208,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1560681366","product_id":100029001,"comment_content":"关闭浏览器是不是就和服务器断开了tcp连接，就可以看到四次挥手的包？","like_count":0,"discussions":[{"author":{"id":1181974,"avatar":"https://static001.geekbang.org/account/avatar/00/12/09/16/1161017c.jpg","nickname":"罗剑锋","note":"","ucode":"95678C988F24AB","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":454172,"discussion_content":"是的，你可以试试。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1560686129,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":104113,"user_name":"1821000","can_delete":false,"product_type":"c1","uid":1336282,"ip_address":"","ucode":"A0091F5980347C","user_header":"","comment_is_top":false,"comment_ctime":1560655187,"is_pvip":false,"replies":[{"id":"37679","content":"可能是你的过滤没设置好，用tcp port 80，这样就不会显示其他非http的包。","user_name":"作者回复","user_name_real":"chrono","uid":"1181974","ctime":1560670436,"ip_address":"","comment_id":104113,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1560655187","product_id":100029001,"comment_content":"老师您好，我自己抓包出来，和你演示的实例不一样。没有HTTP,TCP的包，到是有SSDP,ARP,NBNS,BROWSER 包,在本地访问127.0.0.1 源地址显示是169.254.40.202 ，目的地址显示是239.225.225.250， 我使用的抓包网卡是NpCAP loopback Adapter 网卡，有时候您讲的和我实际操作出来的完全不一样。让人很崩溃，我也只是我看到的是真实的。","like_count":0,"discussions":[{"author":{"id":1181974,"avatar":"https://static001.geekbang.org/account/avatar/00/12/09/16/1161017c.jpg","nickname":"罗剑锋","note":"","ucode":"95678C988F24AB","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":454130,"discussion_content":"可能是你的过滤没设置好，用tcp port 80，这样就不会显示其他非http的包。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1560670436,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":103852,"user_name":"Bryan","can_delete":false,"product_type":"c1","uid":1037208,"ip_address":"","ucode":"BA9D6A278609F3","user_header":"https://static001.geekbang.org/account/avatar/00/0f/d3/98/60d13550.jpg","comment_is_top":false,"comment_ctime":1560535484,"is_pvip":true,"replies":[{"id":"37579","content":"并发多个连接，提高数据传输效率，第17讲会说。","user_name":"作者回复","user_name_real":"chrono","uid":"1181974","ctime":1560560245,"ip_address":"","comment_id":103852,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1560535484","product_id":100029001,"comment_content":"不过为什么要建立一个52086呢... 完全想不明白它的意义","like_count":0,"discussions":[{"author":{"id":1181974,"avatar":"https://static001.geekbang.org/account/avatar/00/12/09/16/1161017c.jpg","nickname":"罗剑锋","note":"","ucode":"95678C988F24AB","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":454023,"discussion_content":"并发多个连接，提高数据传输效率，第17讲会说。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1560560245,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":103778,"user_name":"djfhchdh","can_delete":false,"product_type":"c1","uid":1484184,"ip_address":"","ucode":"E71D75328CE398","user_header":"https://static001.geekbang.org/account/avatar/00/16/a5/98/a65ff31a.jpg","comment_is_top":false,"comment_ctime":1560508618,"is_pvip":false,"replies":[{"id":"37550","content":"不客气，有问题随时提。","user_name":"作者回复","user_name_real":"chrono","uid":"1181974","ctime":1560517228,"ip_address":"","comment_id":103778,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1560508618","product_id":100029001,"comment_content":"感谢罗老师的答疑解惑，学习了","like_count":0,"discussions":[{"author":{"id":1181974,"avatar":"https://static001.geekbang.org/account/avatar/00/12/09/16/1161017c.jpg","nickname":"罗剑锋","note":"","ucode":"95678C988F24AB","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":454000,"discussion_content":"不客气，有问题随时提。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1560517228,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":103777,"user_name":"古夜","can_delete":false,"product_type":"c1","uid":1341612,"ip_address":"","ucode":"0A82D3CFCEDF07","user_header":"https://static001.geekbang.org/account/avatar/00/14/78/ac/e5e6e7f3.jpg","comment_is_top":false,"comment_ctime":1560507981,"is_pvip":false,"replies":[{"id":"37548","content":"这里回复没办法贴图，看不到抓包不好界定，有更多的疑问可以去GitHub上提issue。<br><br>另外，你这种反复实验的精神值得表扬，多在实验环境里折腾吧，弄懂了为止。","user_name":"作者回复","user_name_real":"chrono","uid":"1181974","ctime":1560516690,"ip_address":"","comment_id":103777,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1560507981","product_id":100029001,"comment_content":"我又在断网情况下重试了一次，<br>还是两次三次握手，<br>但是有了图标请求以及404，我之前试的时候有写源ip和目标ip过滤，但我觉得这个对图标请求没影响啊，都是在本地的，怎么会没抓到呢？","like_count":0,"discussions":[{"author":{"id":1181974,"avatar":"https://static001.geekbang.org/account/avatar/00/12/09/16/1161017c.jpg","nickname":"罗剑锋","note":"","ucode":"95678C988F24AB","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":453999,"discussion_content":"这里回复没办法贴图，看不到抓包不好界定，有更多的疑问可以去GitHub上提issue。\n\n另外，你这种反复实验的精神值得表扬，多在实验环境里折腾吧，弄懂了为止。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1560516690,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":103776,"user_name":"古夜","can_delete":false,"product_type":"c1","uid":1341612,"ip_address":"","ucode":"0A82D3CFCEDF07","user_header":"https://static001.geekbang.org/account/avatar/00/14/78/ac/e5e6e7f3.jpg","comment_is_top":false,"comment_ctime":1560507740,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1560507740","product_id":100029001,"comment_content":"并且我这里没有你说的图标传输啊","like_count":0},{"had_liked":false,"id":103774,"user_name":"古夜","can_delete":false,"product_type":"c1","uid":1341612,"ip_address":"","ucode":"0A82D3CFCEDF07","user_header":"https://static001.geekbang.org/account/avatar/00/14/78/ac/e5e6e7f3.jpg","comment_is_top":false,"comment_ctime":1560507574,"is_pvip":false,"replies":[{"id":"37547","content":"看一下握手的端口号，应该是建立了两个连接。<br><br>2和3，都是tcp的ack，就是tcp的回包确认，你理解的是对的。","user_name":"作者回复","user_name_real":"chrono","uid":"1181974","ctime":1560516597,"ip_address":"","comment_id":103774,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1560507574","product_id":100029001,"comment_content":"关于抓包分析那块，讲真，我的情况是这样的，我反复实验了几次：<br>环境: chrome，win10，其他都和老师一样的<br>步骤：访问127.0.0.1<br>结果：抓包结果显示我进行了两趟三次握手（1），之后是一次http请求，然后服务器返回一个ack包（2），然后服务器返回html文档，<br>然后浏览器给服务器发了一个ack包（3）<br><br>分析: <br>1，不明白是为什么，为什么要两次三次握手？？？？<br>2，是服务器告诉浏览器，我接受到你的请求的意思吗？<br>3，是浏览器告诉服务器，我收到你发的数据了的意思吗？<br><br>不知道我说的对不对，麻烦老师解惑😬<br>","like_count":0,"discussions":[{"author":{"id":1181974,"avatar":"https://static001.geekbang.org/account/avatar/00/12/09/16/1161017c.jpg","nickname":"罗剑锋","note":"","ucode":"95678C988F24AB","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":453998,"discussion_content":"看一下握手的端口号，应该是建立了两个连接。\n\n2和3，都是tcp的ack，就是tcp的回包确认，你理解的是对的。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1560516597,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":103751,"user_name":"Bryan","can_delete":false,"product_type":"c1","uid":1037208,"ip_address":"","ucode":"BA9D6A278609F3","user_header":"https://static001.geekbang.org/account/avatar/00/0f/d3/98/60d13550.jpg","comment_is_top":false,"comment_ctime":1560502942,"is_pvip":true,"replies":[{"id":"37528","content":"这个是浏览器与服务器建立的另一个连接，用的端口号是52086，但并没有传输数据，实际收发用的是52085。","user_name":"作者回复","user_name_real":"chrono","uid":"1181974","ctime":1560505013,"ip_address":"","comment_id":103751,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1560502942","product_id":100029001,"comment_content":"编号 4-6 的包（图中没有，但是自己能抓到、给的 wireshark 文件中也有）是做什么用的呢？","like_count":0,"discussions":[{"author":{"id":1181974,"avatar":"https://static001.geekbang.org/account/avatar/00/12/09/16/1161017c.jpg","nickname":"罗剑锋","note":"","ucode":"95678C988F24AB","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":453990,"discussion_content":"这个是浏览器与服务器建立的另一个连接，用的端口号是52086，但并没有传输数据，实际收发用的是52085。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1560505013,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":103585,"user_name":"Amark","can_delete":false,"product_type":"c1","uid":1121326,"ip_address":"","ucode":"E5F48633654002","user_header":"https://static001.geekbang.org/account/avatar/00/11/1c/2e/93812642.jpg","comment_is_top":false,"comment_ctime":1560474944,"is_pvip":false,"replies":[{"id":"37492","content":"这个太底层了，建议看一下极客时间里另一个讲网络协议的专栏。<br><br>后面的问题，看网络路由选择了，如果刚好走到那里也是有可能的。","user_name":"作者回复","user_name_real":"chrono","uid":"1181974","ctime":1560479154,"ip_address":"","comment_id":103585,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1560474944","product_id":100029001,"comment_content":"老师能不能详细讲讲，集线器，交换机，网关，以及这个传输过程，我有一个问题，如果在北京访问一台在深圳的服务器，这个过程有没有可能经过武汉某家大型互联网公司的局域网，对网络不要了解","like_count":0,"discussions":[{"author":{"id":1181974,"avatar":"https://static001.geekbang.org/account/avatar/00/12/09/16/1161017c.jpg","nickname":"罗剑锋","note":"","ucode":"95678C988F24AB","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":453931,"discussion_content":"这个太底层了，建议看一下极客时间里另一个讲网络协议的专栏。\n\n后面的问题，看网络路由选择了，如果刚好走到那里也是有可能的。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1560479154,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":103557,"user_name":"djfhchdh","can_delete":false,"product_type":"c1","uid":1484184,"ip_address":"","ucode":"E71D75328CE398","user_header":"https://static001.geekbang.org/account/avatar/00/16/a5/98/a65ff31a.jpg","comment_is_top":false,"comment_ctime":1560472985,"is_pvip":false,"replies":[{"id":"37484","content":"域名解析失败就不会发起tcp建连。","user_name":"作者回复","user_name_real":"chrono","uid":"1181974","ctime":1560474698,"ip_address":"","comment_id":103557,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1560472985","product_id":100029001,"comment_content":"域名不存在，dns解析失败，tcp连接建立失败","like_count":0,"discussions":[{"author":{"id":1181974,"avatar":"https://static001.geekbang.org/account/avatar/00/12/09/16/1161017c.jpg","nickname":"罗剑锋","note":"","ucode":"95678C988F24AB","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":453919,"discussion_content":"域名解析失败就不会发起tcp建连。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1560474698,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":103553,"user_name":"djfhchdh","can_delete":false,"product_type":"c1","uid":1484184,"ip_address":"","ucode":"E71D75328CE398","user_header":"https://static001.geekbang.org/account/avatar/00/16/a5/98/a65ff31a.jpg","comment_is_top":false,"comment_ctime":1560472780,"is_pvip":false,"replies":[{"id":"37482","content":"如果是其他的网站，也就是“外链”，就必须建立新的连接。","user_name":"作者回复","user_name_real":"chrono","uid":"1181974","ctime":1560474555,"ip_address":"","comment_id":103553,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1560472780","product_id":100029001,"comment_content":"点击链接，就是一次http过程，只不过不用再建立tcp连接了，因为http1.1的长连接特性。","like_count":0,"discussions":[{"author":{"id":1181974,"avatar":"https://static001.geekbang.org/account/avatar/00/12/09/16/1161017c.jpg","nickname":"罗剑锋","note":"","ucode":"95678C988F24AB","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":453917,"discussion_content":"如果是其他的网站，也就是“外链”，就必须建立新的连接。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1560474555,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":103533,"user_name":"Geek_d4dee7","can_delete":false,"product_type":"c1","uid":1241569,"ip_address":"","ucode":"636908D6F43C6D","user_header":"http://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTLw9fVyja3eQLGQenLf5EqVaxGQoibo7rq8A7IRjlXED9FhicKukcn0ibCCtiaBqpEib4ZEIWfFOkiaGMSQ/132","comment_is_top":false,"comment_ctime":1560471804,"is_pvip":false,"replies":[{"id":"37483","content":"收到html后浏览器会解析，发现这些链接后就再发请求。具体的加载次序是浏览器自己决定的，排版引擎比较复杂，通常都是边接收边加载。","user_name":"作者回复","user_name_real":"chrono","uid":"1181974","ctime":1560474663,"ip_address":"","comment_id":103533,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1560471804","product_id":100029001,"comment_content":"浏览器接受到服务器返回的html 后 html 用到的css js  图片或者视频链接是什么时候再次发送请求到服务器的呢？是一边接受一边加载这些资源还是完全接收后再根据页面中出现的顺序有序加载？<br>","like_count":0,"discussions":[{"author":{"id":1181974,"avatar":"https://static001.geekbang.org/account/avatar/00/12/09/16/1161017c.jpg","nickname":"罗剑锋","note":"","ucode":"95678C988F24AB","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":453909,"discussion_content":"收到html后浏览器会解析，发现这些链接后就再发请求。具体的加载次序是浏览器自己决定的，排版引擎比较复杂，通常都是边接收边加载。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1560474663,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":103491,"user_name":"红军","can_delete":false,"product_type":"c1","uid":1182247,"ip_address":"","ucode":"DE3FCE0ACDF620","user_header":"https://static001.geekbang.org/account/avatar/00/12/0a/27/f6215028.jpg","comment_is_top":false,"comment_ctime":1560463974,"is_pvip":false,"replies":[{"id":"37475","content":"对，我一时说顺嘴了，sorry，感谢指正。","user_name":"作者回复","user_name_real":"chrono","uid":"1181974","ctime":1560474195,"ip_address":"","comment_id":103491,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1560463974","product_id":100029001,"comment_content":"请教个问题，LVS是工作在IP层的吧，为什么是四层？🙏","like_count":0,"discussions":[{"author":{"id":1181974,"avatar":"https://static001.geekbang.org/account/avatar/00/12/09/16/1161017c.jpg","nickname":"罗剑锋","note":"","ucode":"95678C988F24AB","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":453896,"discussion_content":"对，我一时说顺嘴了，sorry，感谢指正。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1560474195,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]}]}