{"id":93954,"title":"24 | iOS中图片的展示：UIImage与UIImageView的应用","content":"<p><strong>PDF 课件和源代码下载地址：</strong></p><p><a href=\"https://gitee.com/geektime-geekbang/geektime-ios-course\">https://gitee.com/geektime-geekbang/geektime-ios-course</a></p>","comments":[{"had_liked":false,"id":99126,"user_name":"VHJM","can_delete":false,"product_type":"c3","uid":1040549,"ip_address":"","ucode":"B8319C44989612","user_header":"https://static001.geekbang.org/account/avatar/00/0f/e0/a5/da168c0d.jpg","comment_is_top":false,"comment_ctime":1559146820,"is_pvip":false,"replies":[{"id":35669,"content":"两个小问题哈\n1. 那张图片名称是 “timg” .. 我之后修改下\n2.使用imageNamed这个函数，对于png图片是可以忽略扩展名的，其它类型的图片需要加上扩展名，这张图片是jpeg的，所以应该是[UIImage imageNamed:@&quot;icon.bundle&#47;timg.jpeg&quot;]，相关的文档可以在https:&#47;&#47;developer.apple.com&#47;documentation&#47;uikit&#47;uiimage&#47;1624146-imagenamed中看到，在讲解的demo中都加入了扩展名，建议也都加上哈。\n3. 具体本地图片都管理和适配，在后续都课程中会有单独讲解","user_name":"作者回复","user_name_real":"dequanzhu","uid":1041455,"ctime":1559196052,"ip_address":"","comment_id":99126,"utype":1}],"discussion_count":1,"race_medal":0,"score":2,"product_id":100025901,"comment_content":"https:&#47;&#47;github.com&#47;plusend&#47;SampleApp&#47;tree&#47;master&#47;SampleApp\n\n这个是我的代码，麻烦老师了。","like_count":2,"discussions":[{"author":{"id":1041455,"avatar":"http://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTKJ3dLlYr6tznfnZXJNsD7Jw48BVnFSib3RO3VWEN0pgebRY1jaR8YXLQ6iaAjTsFiamOWSA3UPAa37A/132","nickname":"Geek_e7jq8k","note":"","ucode":"352964E5D793DA","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":451978,"discussion_content":"两个小问题哈\n1. 那张图片名称是 “timg” .. 我之后修改下\n2.使用imageNamed这个函数，对于png图片是可以忽略扩展名的，其它类型的图片需要加上扩展名，这张图片是jpeg的，所以应该是[UIImage imageNamed:@&amp;quot;icon.bundle/timg.jpeg&amp;quot;]，相关的文档可以在https://developer.apple.com/documentation/uikit/uiimage/1624146-imagenamed中看到，在讲解的demo中都加入了扩展名，建议也都加上哈。\n3. 具体本地图片都管理和适配，在后续都课程中会有单独讲解","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1559196052,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":216929,"user_name":"JackYang","can_delete":false,"product_type":"c3","uid":1957314,"ip_address":"","ucode":"4496BA8A4BA888","user_header":"","comment_is_top":false,"comment_ctime":1589370674,"is_pvip":false,"replies":[{"id":81393,"content":"view是414，展示出来的cell宽度也是414。为什么在你log中打印出来的是320呢，因为这个是一个初始化的默认状态。当我们使用initWithStyle创建cell的时候，是没有给cell赋值frame的，所以系统会分配给cell 320的默认宽度，而cell初始化结束，即将进入willdisplay的时候，系统内部会对cell进行frame的重新赋值，我们可以重写cell的 setFrame方法并加上断点，可以看到cell 在init的时候默认设置了320，之后系统函数_configCellForDisplay时会再次的setFrame为正确的宽度414,这也就印证了，我们在cellForRowAtIndexPath这个函数中取到的宽度是错误的，但是在willDisplayCell这个delegate中取到的cell宽度是正确的。以上其实也是我们使用UITableView需要注意的一个问题，就是我们的复杂UI计算和布局，其实尽量应该写在willDisplayCell而不是cellForRowAtIndexPath。当然简单一致的逻辑是没区别的，同时我们也可以在cell的setFrame中重新触发layout来避免这个问题。","user_name":"作者回复","user_name_real":"zzz","uid":1041455,"ctime":1590296943,"ip_address":"","comment_id":216929,"utype":1}],"discussion_count":1,"race_medal":0,"score":2,"product_id":100025901,"comment_content":"老师，你好，在加载图片的时候遇到了一个问题：\n用模拟器iphone11，在tableView中打印的屏幕宽度 self.view.frame.size.width是 414 ，但是在cell中增加image的时候打印cell的宽度却是320， 更神奇的是此时设置 cell 背景颜色运行出来却是充满一行的（按道理说不是应该是320的宽度颜色吗？），不知道什么原因\n\n        [self.contentView addSubview:({\n            \n            self.rightImageView = [[UIImageView alloc]init];\n            self.rightImageView.frame = CGRectMake(320, 10, 80, 80);\n            self.rightImageView.backgroundColor = [UIColor redColor];\n            self.contentView.backgroundColor = [UIColor greenColor];  &#47;&#47;cell背景充满一行\n             NSLog(@&quot;cell.contentView------&gt;%f&quot;,self.contentView.frame.size.width);&#47;&#47; 打印宽度 320\n             NSLog(@&quot;cell.contentView------&gt;%f&quot;,self.frame.size.width);  &#47;&#47; 打印宽度 320\n            self.rightImageView;\n            \n            })];\n        \n","like_count":1,"discussions":[{"author":{"id":1041455,"avatar":"http://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTKJ3dLlYr6tznfnZXJNsD7Jw48BVnFSib3RO3VWEN0pgebRY1jaR8YXLQ6iaAjTsFiamOWSA3UPAa37A/132","nickname":"Geek_e7jq8k","note":"","ucode":"352964E5D793DA","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":494987,"discussion_content":"view是414，展示出来的cell宽度也是414。为什么在你log中打印出来的是320呢，因为这个是一个初始化的默认状态。当我们使用initWithStyle创建cell的时候，是没有给cell赋值frame的，所以系统会分配给cell 320的默认宽度，而cell初始化结束，即将进入willdisplay的时候，系统内部会对cell进行frame的重新赋值，我们可以重写cell的 setFrame方法并加上断点，可以看到cell 在init的时候默认设置了320，之后系统函数_configCellForDisplay时会再次的setFrame为正确的宽度414,这也就印证了，我们在cellForRowAtIndexPath这个函数中取到的宽度是错误的，但是在willDisplayCell这个delegate中取到的cell宽度是正确的。以上其实也是我们使用UITableView需要注意的一个问题，就是我们的复杂UI计算和布局，其实尽量应该写在willDisplayCell而不是cellForRowAtIndexPath。当然简单一致的逻辑是没区别的，同时我们也可以在cell的setFrame中重新触发layout来避免这个问题。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1590296943,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":212890,"user_name":"夏小鹏吖~","can_delete":false,"product_type":"c3","uid":1630134,"ip_address":"","ucode":"AF8997628A1489","user_header":"https://static001.geekbang.org/account/avatar/00/18/df/b6/1bfda79b.jpg","comment_is_top":false,"comment_ctime":1588233449,"is_pvip":false,"replies":[{"id":81375,"content":"在OC中， @property 修饰的其实就是我们常说的实例变量。当然和其它语言的实例变量一样，我们可以在类的内部任何的函数中来使用和修改它。当然对于OC中，使用@property编译器会自动添加实例变量的setter和getter方法等等。在自动生成方法的同时，也提供了多种关键字来控制变量的一些额外的特性，比如readonly、readwrite、assign、weak等等，通常不特殊声明使用的都是默认的关键字，有特殊情况的时候我们才会使用，比如我们不想持有一个外部对象的时候，就会使用weak关键字。具体深入的了解可以看下https:&#47;&#47;developer.apple.com&#47;library&#47;archive&#47;releasenotes&#47;ObjectiveC&#47;ModernizationObjC&#47;AdoptingModernObjective-C&#47;AdoptingModernObjective-C.html ","user_name":"作者回复","user_name_real":"zzz","uid":1041455,"ctime":1590287925,"ip_address":"","comment_id":212890,"utype":1}],"discussion_count":1,"race_medal":0,"score":2,"product_id":100025901,"comment_content":"我不明白  为什么要修饰这几个property title source time comment 什么时候适合修饰呢 什么时候不用修饰呢","like_count":0,"discussions":[{"author":{"id":1041455,"avatar":"http://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTKJ3dLlYr6tznfnZXJNsD7Jw48BVnFSib3RO3VWEN0pgebRY1jaR8YXLQ6iaAjTsFiamOWSA3UPAa37A/132","nickname":"Geek_e7jq8k","note":"","ucode":"352964E5D793DA","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":493640,"discussion_content":"在OC中， @property 修饰的其实就是我们常说的实例变量。当然和其它语言的实例变量一样，我们可以在类的内部任何的函数中来使用和修改它。当然对于OC中，使用@property编译器会自动添加实例变量的setter和getter方法等等。在自动生成方法的同时，也提供了多种关键字来控制变量的一些额外的特性，比如readonly、readwrite、assign、weak等等，通常不特殊声明使用的都是默认的关键字，有特殊情况的时候我们才会使用，比如我们不想持有一个外部对象的时候，就会使用weak关键字。具体深入的了解可以看下https://developer.apple.com/library/archive/releasenotes/ObjectiveC/ModernizationObjC/AdoptingModernObjective-C/AdoptingModernObjective-C.html ","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1590287925,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":122328,"user_name":"RamboPan","can_delete":false,"product_type":"c3","uid":1137809,"ip_address":"","ucode":"7C025C957C0E0E","user_header":"https://static001.geekbang.org/account/avatar/00/11/5c/91/8b11819e.jpg","comment_is_top":false,"comment_ctime":1565340081,"is_pvip":false,"replies":[{"id":45371,"content":"加一下imageView的clipsToBounds属性哈，如果图片大于ImageView，是需要裁剪掉的","user_name":"作者回复","user_name_real":"dequanzhu","uid":1041455,"ctime":1565765207,"ip_address":"","comment_id":122328,"utype":1}],"discussion_count":1,"race_medal":0,"score":2,"product_id":100025901,"comment_content":"老师你好，我试了下，UIViewContentModeScaleAspectFill ,发现 ImageView 加载图片之后变成长方形了，我给 frame 设置的长宽是正方形的。\n\n我后面尝试切换为 UIViewContentModeScaleToFill,UIViewContentModeScaleAspectFit,发现加载图片时都是正方形。\n\n代码片段：\n\n……\n@property(nonatomic,strong,readwrite) UIImageView * icon;\n\n……\nself.icon = [[UIImageView alloc] init];\nself.icon.frame = CGRectMake(250, 15, 70, 70);\nself.icon.contentMode = UIViewContentModeScaleAspectFill;\nself.icon.backgroundColor = [UIColor redColor];\n\n……\nself.icon.image = [UIImage imageNamed:@&quot;icon.bundle&#47;Resident_Evil6.jpg&quot;];\n&#47;&#47;用时间label 右边位置\nself.icon.frame = CGRectMake(self.timeLabel.frame.origin.x +\n                                    self.timeLabel.frame.size.width + 15,\n                                 15, 70, 70);","like_count":0,"discussions":[{"author":{"id":1041455,"avatar":"http://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTKJ3dLlYr6tznfnZXJNsD7Jw48BVnFSib3RO3VWEN0pgebRY1jaR8YXLQ6iaAjTsFiamOWSA3UPAa37A/132","nickname":"Geek_e7jq8k","note":"","ucode":"352964E5D793DA","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":462209,"discussion_content":"加一下imageView的clipsToBounds属性哈，如果图片大于ImageView，是需要裁剪掉的","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1565765207,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":95918,"user_name":"VHJM","can_delete":false,"product_type":"c3","uid":1040549,"ip_address":"","ucode":"B8319C44989612","user_header":"https://static001.geekbang.org/account/avatar/00/0f/e0/a5/da168c0d.jpg","comment_is_top":false,"comment_ctime":1558256681,"is_pvip":false,"replies":[{"id":35563,"content":"方便上传下代码哈，我帮看看","user_name":"作者回复","user_name_real":"dequanzhu","uid":1041455,"ctime":1559135058,"ip_address":"","comment_id":95918,"utype":1}],"discussion_count":1,"race_medal":0,"score":2,"product_id":100025901,"comment_content":"请问老师，这个 icon.bundle 直接从 github 的demo 中复制一份就可以了吗？\n之前我用 Xcode 9 + ios11 的模拟器所有的图片引用都不能正确显示。\n今天我升级了 Xcode 10 + ios12 的模拟器也不行，然后我把 icon.bundle 删了又导入进去以后，tabbar 上的图片可以正常显示了，但是 time.jpeg 还是不行，老师能猜到原因吗？","like_count":0,"discussions":[{"author":{"id":1041455,"avatar":"http://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTKJ3dLlYr6tznfnZXJNsD7Jw48BVnFSib3RO3VWEN0pgebRY1jaR8YXLQ6iaAjTsFiamOWSA3UPAa37A/132","nickname":"Geek_e7jq8k","note":"","ucode":"352964E5D793DA","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":450640,"discussion_content":"方便上传下代码哈，我帮看看","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1559135058,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":363920,"user_name":"Geek_2acdf0","can_delete":false,"product_type":"c3","uid":2183236,"ip_address":"北京","ucode":"5225553244D7B8","user_header":"https://thirdwx.qlogo.cn/mmopen/vi_32/PiajxSqBRaEIibTsbF7sWqgEib2NzRzu6KKgxOIia56KDlMzgoQPJADBnuDnK0RN2RZRjkhczJ4ib0kzcpw0knbYGRA/132","comment_is_top":false,"comment_ctime":1670339716,"is_pvip":false,"replies":null,"discussion_count":1,"race_medal":0,"score":2,"product_id":100025901,"comment_content":"如何将自己的图片加入工程？icon.bundle 是怎么添加进工程中的？另外jpg在磁盘中应该存在什么位置？","like_count":0,"discussions":[{"author":{"id":1039549,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/dc/bd/ea9c16b8.jpg","nickname":"莫比斯","note":"","ucode":"FC467871C8CA7D","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":616889,"discussion_content":"在你的工程目录里，右键simpleApp，选择add files to simpleApp；这样建立关联关系以后，引入就能正常使用啦","likes_number":1,"is_delete":false,"is_hidden":false,"ctime":1683179273,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":"北京","group_id":0},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":302675,"user_name":"Geek_98wavm","can_delete":false,"product_type":"c3","uid":2621085,"ip_address":"","ucode":"F8994CE6184B49","user_header":"","comment_is_top":false,"comment_ctime":1626330248,"is_pvip":false,"replies":null,"discussion_count":0,"race_medal":0,"score":2,"product_id":100025901,"comment_content":"这种addSubView的写法倒是没见过，swift应该没有类似的写法","like_count":0}]}