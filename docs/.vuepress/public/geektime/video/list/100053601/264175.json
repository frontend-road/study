{"id":264175,"title":"29 | CQRS/CDC技术在Netflix的实践","content":"<p><strong>课件和Demo地址</strong><br>\n<a href=\"https://gitee.com/geektime-geekbang/geektime-distributed\">https://gitee.com/geektime-geekbang/geektime-distributed</a></p>","comments":[{"had_liked":false,"id":241888,"user_name":"Geek_zbvt62","can_delete":false,"product_type":"c3","uid":1046714,"ip_address":"","ucode":"81EA27ADD9EC1A","user_header":"https://static001.geekbang.org/account/avatar/00/0f/f8/ba/d28174a9.jpg","comment_is_top":false,"comment_ctime":1597487192,"is_pvip":false,"replies":[{"id":89495,"content":"dblog是一个通用的数据捕获CDC框架，和canel类似。\n\ncanel主要支持mysql数据库，dblog不经支持mysql，也支持其它数据库。另外，dblog不仅支持增量同步，还支持全量dump，而且增量和全量可以交替进行，这个功能在不停机数据同步&#47;迁移方面很有用。\n\n","user_name":"作者回复","user_name_real":"杨波","uid":1030344,"ctime":1597768382,"ip_address":"","comment_id":241888,"utype":1}],"discussion_count":1,"race_medal":0,"score":2,"product_id":100053601,"comment_content":"\ndblog和canal类似么？\n我看图中从delta connector输出的数据已经是事件了，就是说delta connector是带有业务逻辑的应用？","like_count":2,"discussions":[{"author":{"id":1030344,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/b8/c8/c94d38a7.jpg","nickname":"杨波","note":"","ucode":"FA3418BB703BCA","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":503867,"discussion_content":"dblog是一个通用的数据捕获CDC框架，和canel类似。\n\ncanel主要支持mysql数据库，dblog不经支持mysql，也支持其它数据库。另外，dblog不仅支持增量同步，还支持全量dump，而且增量和全量可以交替进行，这个功能在不停机数据同步/迁移方面很有用。\n\n","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1597768382,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":237196,"user_name":"robincoin","can_delete":false,"product_type":"c3","uid":1053243,"ip_address":"","ucode":"BA89BCEA1D6B9D","user_header":"https://static001.geekbang.org/account/avatar/00/10/12/3b/969eedf2.jpg","comment_is_top":false,"comment_ctime":1595733768,"is_pvip":false,"replies":[{"id":87654,"content":"这个要看netflix的具体场景吧，我个人认为如果变更影响的movie不多，查询出来更新一下开销也不大，如果影响movice很多，那么一般需要后台任务异步去批量更新。","user_name":"作者回复","user_name_real":"杨波","uid":1030344,"ctime":1595763769,"ip_address":"","comment_id":237196,"utype":1}],"discussion_count":1,"race_medal":0,"score":2,"product_id":100053601,"comment_content":"如果vendor service里面有可变字段怎么处理，也就是movie数据没有变更，但是关联的vendor变更了，而且vendor对movie一般是一对多关系，是不是要把所有的movie都查询出来更新下？","like_count":1,"discussions":[{"author":{"id":1030344,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/b8/c8/c94d38a7.jpg","nickname":"杨波","note":"","ucode":"FA3418BB703BCA","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":502333,"discussion_content":"这个要看netflix的具体场景吧，我个人认为如果变更影响的movie不多，查询出来更新一下开销也不大，如果影响movice很多，那么一般需要后台任务异步去批量更新。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1595763769,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":236775,"user_name":"飞翔","can_delete":false,"product_type":"c3","uid":1068571,"ip_address":"","ucode":"65AF6AF292DAD6","user_header":"https://static001.geekbang.org/account/avatar/00/10/4e/1b/f4b786b9.jpg","comment_is_top":false,"comment_ctime":1595545361,"is_pvip":false,"replies":[{"id":87611,"content":"在这个例子中，delta app对movie service发送过来的变更数据，需要调用Deal&#47;Talent&#47;Vendor等其它Service进行填充(Enrichment)，也就是填充一些额外的字段，生成更完整的movie信息，然后再发送到movie search index服务去建立索引。这里主要是填充一些额外字段，不能算聚合join。","user_name":"作者回复","user_name_real":"杨波","uid":1030344,"ctime":1595691253,"ip_address":"","comment_id":236775,"utype":1}],"discussion_count":1,"race_medal":0,"score":2,"product_id":100053601,"comment_content":"老师 delta application 聚合好数据之后 发送到moive search index 服务嘛 然后存储到moive search index 服务的数据库里？","like_count":1,"discussions":[{"author":{"id":1030344,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/b8/c8/c94d38a7.jpg","nickname":"杨波","note":"","ucode":"FA3418BB703BCA","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":502201,"discussion_content":"在这个例子中，delta app对movie service发送过来的变更数据，需要调用Deal/Talent/Vendor等其它Service进行填充(Enrichment)，也就是填充一些额外的字段，生成更完整的movie信息，然后再发送到movie search index服务去建立索引。这里主要是填充一些额外字段，不能算聚合join。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1595691253,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":338629,"user_name":"冬风向左吹","can_delete":false,"product_type":"c3","uid":1066928,"ip_address":"","ucode":"376C45C5134F93","user_header":"https://static001.geekbang.org/account/avatar/00/10/47/b0/a9b77a1e.jpg","comment_is_top":false,"comment_ctime":1647607645,"is_pvip":false,"replies":null,"discussion_count":0,"race_medal":0,"score":2,"product_id":100053601,"comment_content":"2022年了，不知道这个开源的dblog叫什么名字","like_count":0}]}