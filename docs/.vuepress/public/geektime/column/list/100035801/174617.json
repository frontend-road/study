{"id":174617,"title":"31 | 应用性能管理：用户的使用体验应该如何监控？","content":"<p>你好，我是唐扬。</p><p>上一节课中，我带你了解了服务端监控搭建的过程。有了监控报表之后，你的团队在维护垂直电商系统时，就可以更早地发现问题，也有直观的工具辅助你们分析排查问题了。</p><p>不过你很快发现，有一些问题，服务端的监控报表无法排查，甚至无法感知。比如，有用户反馈创建订单失败，但是从服务端的报表来看，并没有什么明显的性能波动，从存储在Elasticsearch里的原始日志中，甚至没有找到这次创建订单的请求。这有可能是客户端有Bug，或者网络抖动导致创建订单的请求并没有发送到服务端。</p><p>再比如，有些用户会反馈，使用长城宽带打开商品详情页面特别慢，甚至出现DNS解析失败的情况。<strong>那么，当我们遇到这类问题时，要如何排查和优化呢？</strong></p><p>这里面涉及一个概念叫应用性能管理（Application Performance Management，简称APM），<strong>它的含义是：</strong>对应用各个层面做全方位的监测，期望及时发现可能存在的问题，并加以解决，从而提升系统的性能和可用性。</p><p>你是不是觉得和之前讲到的服务端监控很相似？其实，服务端监控的核心关注点是后端服务的性能和可用性，而应用性能管理的核心关注点是终端用户的使用体验。也就是说，你需要衡量从客户端请求发出开始，到响应数据返回到客户端为止，这个端到端的整体链路上的性能情况。</p><!-- [[[read_end]]] --><p>如果你能做到这一点，那么无论是订单创建问题的排查，还是长城宽带用户页面打开缓慢的问题，都可以通过这套监控来发现和排查。<strong>那么，如何搭建这么一套端到端的监控体系呢？</strong></p><h2>如何搭建APM系统</h2><p>与搭建服务端监控系统类似，在搭建端到端的应用性能管理系统时，我们也可以从数据的采集、存储和展示几个方面来思考。</p><p>首先，在数据采集方面，我们可以采用类似Agent的方式，在客户端上植入SDK，由SDK负责采集信息，并且经过采样之后，通过一个固定的接口定期发送给服务端。这个固定接口和服务端，我们可以称为APM通道服务。</p><p>虽然客户端需要监控的指标很多，比如监控网络情况、监控客户端卡顿情况、垃圾收集数据等等，但我们可以定义一种通用的数据采集格式。</p><p>比如在我之前的公司里，采集的数据包含下面几个部分，SDK将这几部分数据转换成JSON格式后，就可以发送给APM通道服务了。<strong>这几部分数据格式，你可以在搭建自己的APM系统时直接拿来参考。</strong></p><ul>\n<li>系统部分：包括数据协议的版本号，以及下面提到的消息头、端消息体、业务消息体的长度；</li>\n<li>消息头：主要包括应用的标识（appkey），消息生成的时间戳，消息的签名以及消息体加密的秘钥；</li>\n<li>端消息体：主要存储客户端的一些相关信息，主要有客户端版本号、SDK版本号、IDFA、IDFV、IMEI、机器型号、渠道号、运营商、网络类型、操作系统类型、国家、地区、经纬度等等。由于这些信息有些比较敏感，所以我们一般会对信息加密；</li>\n<li>业务消息体：也就是真正要采集的数据，这些数据也需要加密。</li>\n</ul><p><strong>加密的方法是这样的：</strong>我们首先会分配给这个应用一对RSA公钥和私钥，然后SDK在启动的时候，先请求一个策略服务，获取RSA公钥。在加密时，客户端会随机生成一个对称加密的秘钥Key，端消息体和业务消息体都会使用这个秘钥来加密。那么数据发到APM通道服务后，要如何解密呢？</p><p>客户端会使用RSA的公钥对秘钥加密，存储在消息头里面（也就是上面提到的，消息体加密秘钥），然后APM通道服务使用RSA秘钥解密得到秘钥，就可以解密得到端消息体和业务消息体的内容了。</p><p>最后，我们把消息头、端消息体、业务消息体还有消息头中的时间戳组装起来，用MD5生成摘要后，存储在消息头中（也就是消息的签名）。这样，APM通道服务在接收到消息后，可以使用同样的算法生成摘要，并且与发送过来的摘要比对，以防止消息被篡改。</p><p>数据被采集到APM通道服务之后，我们先对JSON消息做解析，得到具体的数据，然后发送到消息队列里面。从消息队列里面消费到数据之后，会写一份数据到Elasticsearch中，作为原始数据保存起来，再写一份到统计平台，以形成客户端的报表。</p><p><img src=\"https://static001.geekbang.org/resource/image/50/5b/50fe40212d09940e1c5c1b860163a15b.jpg?wh=1142*361\" alt=\"\"></p><p>有了这套APM通道服务，我们就可以将从客户端上采集到的信息，通过统一的方式上报到服务端做集中处理。这样一来，你就可以收集到客户端上的性能数据和业务数据，能够及时地发现问题了。</p><p>那么问题来了：虽然你搭建了客户端监控系统，但是在我们电商系统客户端中可以收集到用户网络数据、卡顿数据等等，你是要把这些信息都监控到位，还是有所侧重呢？要知道，监控的信息不明确，会给问题排查带来不便，而这就是我们接下来探究的问题，也就是你到底需要监控用户的哪些信息。</p><h2>需要监控用户的哪些信息</h2><p>在我看来，搭建端到端的监控体系的首要目标，是解决如何监控客户端网络的问题，这是因为我们遇到的客户端问题，<strong>大部分的原因还是出在客户端网络上。</strong></p><p>在中国复杂的网络环境下，大的运营商各行其是，各自为政，在不同的地区的链路质量各有不同，而小的运营商又鱼龙混杂，服务质量得不到保障。我给你说一个典型的问题。</p><p>之前在讲解DNS时，我曾经提到在做DNS解析的时候，为了缩短查询的链路，首先会查询运营商的Local DNS。但是，Local DNS这个东西很不靠谱，有些小的运营商为了节省流量，他会把一些域名解析到内容缓存服务器上，甚至会解析到广告或者钓鱼网站上去，这就是域名劫持。</p><p>也有一些运营商比较懒，自己不去解析域名，而是把解析请求转发到别的运营商上，这就导致权威DNS收到请求的来源IP的运营商是不正确的。这样一来，解析的IP和请求源，会来自不同的运营商，形成跨网的流量，导致DNS解析时间过长。这些需要我们实时监控，以尽快地发现问题，反馈给运营商来解决。</p><p><strong>那么，我们如何采集网络数据呢？</strong>一般来说，我们会用埋点的方式，将网络请求的每一个步骤耗时情况、是否发生错误都打印下来，我以安卓系统为例，解释一下是如何做的。</p><p>安卓一般会使用OkHttpClient来请求接口数据，而OkHttpClient提供了EventListner接口，可以让调用者接收到网络请求事件，比如，开始解析DNS事件，解析DNS结束的事件等等。那么你就可以埋点计算出一次网络请求的各个阶段的耗时情况。我写了一段具体的示例代码，计算了一次请求的DNS解析时间，你可以拿去参考。</p><pre><code>public class HttpEventListener extends EventListener {\n\n    final static AtomicLong nextCallId = new AtomicLong(1L);\n    private final long callId;\n    private long dnsStartTime;\n\n    private HttpUrl url ;\n\n    public HttpEventListener(HttpUrl url) {\n        this.callId = nextCallId.getAndIncrement(); //初始化唯一标识这次请求的ID\n        this.url = url;\n    }\n    \n    @Override\n    public void dnsStart(Call call, String domainName) {\n        super.dnsStart(call, domainName);\n        this.dnsStartTime = System.nanoTime(); //记录dns开始时间\n    }\n\n    @Override\n    public void dnsEnd(Call call, String domainName, List&lt;InetAddress&gt; inetAddressList) {\n        super.dnsEnd(call, domainName, inetAddressList);\n        System.out.println(&quot;url： &quot; + url.host() + &quot;, Dns time: &quot; + (System.nanoTime() - dnsStartTime)); //计算dns解析的时间\n    }\n}\n</code></pre><p>有了这个EventListner，你就可以在初始化HttpClient的时候把它注入进去，代码如下：</p><pre><code>OkHttpClient.Builder builder = new OkHttpClient.Builder()\n        .eventListenerFactory(new Factory() {\n            @Override\n            public EventListener create(Call call) {\n                return new HttpEventListener(call.request().url());\n            }\n        });\n</code></pre><p>这样，我们可以得出一次请求过程中经历的一系列过程的时间，其中主要包括下面几项。</p><ol>\n<li>等待时间：异步调用时，请求会首先缓存在本地的队列里面，由专门的I/O线程负责，那么在I/O线程真正处理请求之前，会有一个等待的时间。</li>\n<li>DNS时间：域名解析时间。</li>\n<li>握手时间：TCP三次握手的时间。</li>\n<li>SSL时间：如果服务是HTTPS服务，那么就会有一个SSL认证的时间。</li>\n<li>发送时间：请求包被发送出去的时间。</li>\n<li>首包时间：服务端处理后，客户端收到第一个响应包的时间。</li>\n<li>包接收时间：我们接收到所有数据的时间。</li>\n</ol><p><img src=\"https://static001.geekbang.org/resource/image/33/ba/33c2f9e1182813fadc0f6b8066379fba.jpg?wh=1142*294\" alt=\"\"></p><p>有了这些数据之后，我们可以通过上面提到的APM通道服务发送给服务端，这样服务端和客户端的同学，就可以从Elasticsearch中查询到原始的数据，也可以对数据做一些聚合处理、统计分析之后，形成客户端请求监控的报表。这样，我们就可以有针对性地对HTTP请求的某一个过程做优化了。</p><p>而对于用户网络的监控，可以给你带来三方面的价值。</p><p>首先，这种用户网络监控的所有监控数据均来自客户端，是用户访问数据实时上报，因此能够准确、真实、实时地反映用户操作体验。</p><p>再者，它是我们性能优化的指向标，业务架构改造、服务性能优化、网络优化等任何优化行为时，可以反馈用户性能数据，引导业务正向优化接口性能、可用性等指标。</p><p>最后，它也能帮助我们监控CDN链路质量。之前的CDN的监控严重依赖CDN厂商，这有一个问题是：CDN无法从端上获取到全链路的监控数据，有些时候，客户端到CDN的链路出了问题，CDN厂商是感知不到的，而客户端监控弥补了这方面的缺陷，并且可以通过告警机制督促CDN及时优化调整问题线路。</p><p>除了上报网络数据之外，我们还可以上报一些异常事件的数据，比如你的垂直电商系统可能会遇到以下一些异常情况：</p><ul>\n<li>登录失败；</li>\n<li>下单失败；</li>\n<li>浏览商品信息失败</li>\n<li>评论列表加载不出来；</li>\n<li>无法评分留言；</li>\n<li>…</li>\n</ul><p>你在业务逻辑的代码中，都可以检测到这些异常数据，当然，也可以通过APM通道服务上传到服务端，这样方便服务端和客户端的同学一起来排查问题，也能给你的版本灰度提供数据的支持。</p><p>总的来说，如果说搭建的系统是骨架，那么具体监控的数据就是灵魂，因为数据是监控的主体内容，系统只是呈现数据的载体。所以，你需要在系统运维的过程中不断完善对数据的收集，这也是对你的监控系统不断升级完善的过程。</p><h2>课程小结</h2><p>以上就是本节课的全部内容了。本节课，我主要带你了解了如何搭建一个端到端的APM监控系统，你需要了解的重点是：</p><p>1.从客户端采集到的数据可以用通用的消息格式，上传到APM服务端，服务端将数据存入到Elasticsearch中，以提供原始日志的查询，也可以依据这些数据形成客户端的监控报表；</p><p>2.用户网络数据是我们排查客户端，和服务端交互过程的重要数据，你可以通过代码的植入，来获取到这些数据；</p><p>3.无论是网络数据，还是异常数据，亦或是卡顿、崩溃、流量、耗电量等数据，你都可以通过把它们封装成APM消息格式，上传到APM服务端，这些用户在客户端上留下的踪迹可以帮助你更好地优化用户的使用体验。</p><p><strong>总而言之，监测和优化用户的使用体验是应用性能管理的最终目标。</strong>然而，服务端的开发人员往往会陷入一个误区，认为我们将服务端的监控做好，保证接口性能和可用性足够好就好了。事实上，接口的响应时间只是我们监控系统中很小的一部分，搭建一套端到端的全链路的监控体系，才是你的监控系统的最终形态。</p><h2>一课一思</h2><p>在实际的工作中，你的团队是如何通过监控，发现客户端上的问题的呢？欢迎在留言区与我分享你的经验。</p><p>最后，感谢你的阅读，如果这篇文章让你有所收获，也欢迎你将它分享给更多的朋友。</p>","comments":[{"had_liked":false,"id":216110,"user_name":"mghio","can_delete":false,"product_type":"c1","uid":1213078,"ip_address":"","ucode":"74883EDE4FD0DC","user_header":"https://static001.geekbang.org/account/avatar/00/12/82/96/aa795685.jpg","comment_is_top":false,"comment_ctime":1589191062,"is_pvip":true,"replies":[{"id":"82721","content":"这倒是，客户端监控可以借助第三方","user_name":"作者回复","user_name_real":"唐扬","uid":"1448977","ctime":1591538737,"ip_address":"","comment_id":216110,"utype":1}],"discussion_count":2,"race_medal":0,"score":"57423765910","product_id":100035801,"comment_content":"小公司一般能把服务端的监控搞起来就已经不错了","like_count":14,"discussions":[{"author":{"id":1448977,"avatar":"https://static001.geekbang.org/account/avatar/00/16/1c/11/4b45993d.jpg","nickname":"唐扬","note":"","ucode":"1AF4C4A4DBC6EF","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":494672,"discussion_content":"这倒是，客户端监控可以借助第三方","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1591538737,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1104850,"avatar":"https://static001.geekbang.org/account/avatar/00/10/db/d2/e29f8834.jpg","nickname":"lidashuang","note":"","ucode":"560ABE8032760E","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":300284,"discussion_content":"一般都用现成的，比如newrelic","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1598010526,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":158995,"user_name":"qinsi","can_delete":false,"product_type":"c1","uid":1667175,"ip_address":"","ucode":"090D9C4068FF12","user_header":"https://static001.geekbang.org/account/avatar/00/19/70/67/0c1359c2.jpg","comment_is_top":false,"comment_ctime":1575512383,"is_pvip":true,"discussion_count":10,"race_medal":0,"score":"35935250751","product_id":100035801,"comment_content":"敏感信息加密的目的是什么呢？如果是要防止泄露给网络上的中间人的话走加密协议如https是不是就可以了？","like_count":9,"discussions":[{"author":{"id":1009098,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/65/ca/38dcd55a.jpg","nickname":"lupguo","note":"","ucode":"1B55A01DF78647","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":230206,"discussion_content":"应该是从性能考虑，http采用短连接，apm定期上报有通信链路建立的开销，基于长连接可以规避这块问题，只是需要自己实现相关的通信链路建立和维护。","likes_number":2,"is_delete":false,"is_hidden":false,"ctime":1586736059,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":2404949,"avatar":"","nickname":"Geek_fc1417","note":"","ucode":"6D84E02A937FB9","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":347462,"discussion_content":"https的简化版","likes_number":1,"is_delete":false,"is_hidden":false,"ctime":1612236438,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1015754,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/7f/ca/ea85bfdd.jpg","nickname":"helloworld","note":"","ucode":"00DF2FEC58D2E6","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":293222,"discussion_content":"同样的疑问：通过HTTPS进行传输的话，是不是可以省去很多自定义的加密解密工作 ?","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1595485673,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1391144,"avatar":"https://static001.geekbang.org/account/avatar/00/15/3a/28/cf707831.jpg","nickname":"与狼共舞","note":"","ucode":"02AC04B43F0194","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":226735,"discussion_content":"HTTPS对性能也有影响","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1586440518,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1129838,"avatar":"https://static001.geekbang.org/account/avatar/00/11/3d/6e/60680aa4.jpg","nickname":"Li Yao","note":"","ucode":"703E1E5505F70D","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":199846,"discussion_content":"或者是因为不想让人看到上传了什么信息，包括用户本人？","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1583632697,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":1,"child_discussions":[{"author":{"id":1667175,"avatar":"https://static001.geekbang.org/account/avatar/00/19/70/67/0c1359c2.jpg","nickname":"qinsi","note":"","ucode":"090D9C4068FF12","race_medal":0,"user_type":1,"is_pvip":true},"reply_author":{"id":1129838,"avatar":"https://static001.geekbang.org/account/avatar/00/11/3d/6e/60680aa4.jpg","nickname":"Li Yao","note":"","ucode":"703E1E5505F70D","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":199977,"discussion_content":"可能是为了防黑产吧。如果黑产知道了客户端会收集哪些信息，就会设法伪造这些信息以躲过风控。","likes_number":3,"is_delete":false,"is_hidden":false,"ctime":1583641384,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":199846,"ip_address":""},"score":199977,"extra":""}]},{"author":{"id":1661704,"avatar":"https://static001.geekbang.org/account/avatar/00/19/5b/08/b0b0db05.jpg","nickname":"丁丁历险记","note":"","ucode":"A43829E454C067","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":104689,"discussion_content":"https 不够的，不要太相信任何客户端。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1577446936,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":3,"child_discussions":[{"author":{"id":1667175,"avatar":"https://static001.geekbang.org/account/avatar/00/19/70/67/0c1359c2.jpg","nickname":"qinsi","note":"","ucode":"090D9C4068FF12","race_medal":0,"user_type":1,"is_pvip":true},"reply_author":{"id":1661704,"avatar":"https://static001.geekbang.org/account/avatar/00/19/5b/08/b0b0db05.jpg","nickname":"丁丁历险记","note":"","ucode":"A43829E454C067","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":108402,"discussion_content":"如果是指暴露给客户端本地的中间人的话是不是更没必要加密了？因为你的客户端能获取的敏感信息(如上面提到的设备硬件相关信息等)本地的中间人不通过你的客户端也是能获取的","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1577630037,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":104689,"ip_address":""},"score":108402,"extra":""},{"author":{"id":1046302,"avatar":"http://thirdwx.qlogo.cn/mmopen/vi_32/3XbCueYYVWTiclv8T5tFpwiblOxLphvSZxL4ujMdqVMibZnOiaFK2C5nKRGv407iaAsrI0CDICYVQJtiaITzkjfjbvrQ/132","nickname":"有铭","note":"","ucode":"2C7CB36CA5C04C","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":1661704,"avatar":"https://static001.geekbang.org/account/avatar/00/19/5b/08/b0b0db05.jpg","nickname":"丁丁历险记","note":"","ucode":"A43829E454C067","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":221028,"discussion_content":"你有没有仔细看它的加密方式，和https的加密方式一模一样，公钥私钥，约定对称秘钥，然后用对称秘钥加密解密","likes_number":2,"is_delete":false,"is_hidden":false,"ctime":1585965861,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":104689,"ip_address":""},"score":221028,"extra":""},{"author":{"id":2273620,"avatar":"https://static001.geekbang.org/account/avatar/00/22/b1/54/6d663b95.jpg","nickname":"瓜牛","note":"","ucode":"5EB7D2F4400A70","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":1661704,"avatar":"https://static001.geekbang.org/account/avatar/00/19/5b/08/b0b0db05.jpg","nickname":"丁丁历险记","note":"","ucode":"A43829E454C067","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":339016,"discussion_content":"还是没明白，既然跟https加密过程一模一样，那为啥还要搞这一套，不是徒增耗时吗？","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1609475824,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":104689,"ip_address":""},"score":339016,"extra":""}]}]},{"had_liked":false,"id":160607,"user_name":"longslee","can_delete":false,"product_type":"c1","uid":1465986,"ip_address":"","ucode":"C24E32E5B1B6F5","user_header":"https://static001.geekbang.org/account/avatar/00/16/5e/82/438c8534.jpg","comment_is_top":false,"comment_ctime":1575985296,"is_pvip":false,"replies":[{"id":"61405","content":"这个确实是的，不过可以把日志暂存一下，等网络通畅了再发送","user_name":"作者回复","user_name_real":"唐扬","uid":"1448977","ctime":1576116897,"ip_address":"","comment_id":160607,"utype":1}],"discussion_count":1,"race_medal":0,"score":"31640756368","product_id":100035801,"comment_content":"打卡。老师，我们也常做客户端问题分析，主要是浏览器，有跟头痛的问题是：如果客户端是因为网络不畅，本身这是应该被监控的，但是由于网络不畅连监控日志都发不出来，数据都丢了我们没法分析了。","like_count":8,"discussions":[{"author":{"id":1448977,"avatar":"https://static001.geekbang.org/account/avatar/00/16/1c/11/4b45993d.jpg","nickname":"唐扬","note":"","ucode":"1AF4C4A4DBC6EF","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":477431,"discussion_content":"这个确实是的，不过可以把日志暂存一下，等网络通畅了再发送","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1576116897,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":228254,"user_name":"L响","can_delete":false,"product_type":"c1","uid":1667491,"ip_address":"","ucode":"012AE7EE725911","user_header":"https://static001.geekbang.org/account/avatar/00/19/71/a3/b881f08c.jpg","comment_is_top":false,"comment_ctime":1592624291,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"10182558883","product_id":100035801,"comment_content":"我们游戏服务端写过一个APM，用来为游戏客户端服务，但那时不知道ES，遇到了数据存储量大的问题，还得分库分表，后来就放弃了，换成了第三方的APM。","like_count":3},{"had_liked":false,"id":173786,"user_name":"蓝士钦","can_delete":false,"product_type":"c1","uid":1229516,"ip_address":"","ucode":"726EB5C8EF1249","user_header":"https://static001.geekbang.org/account/avatar/00/12/c2/cc/ca22bb7c.jpg","comment_is_top":false,"comment_ctime":1579686418,"is_pvip":false,"replies":[{"id":"67347","content":"https协议来加密","user_name":"作者回复","user_name_real":"唐扬","uid":"1448977","ctime":1579690378,"ip_address":"","comment_id":173786,"utype":1}],"discussion_count":2,"race_medal":0,"score":"10169621010","product_id":100035801,"comment_content":"H5页面的接口请求如何加密，请问有没有好的方案","like_count":3,"discussions":[{"author":{"id":1448977,"avatar":"https://static001.geekbang.org/account/avatar/00/16/1c/11/4b45993d.jpg","nickname":"唐扬","note":"","ucode":"1AF4C4A4DBC6EF","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":482207,"discussion_content":"https协议来加密","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1579690378,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1104850,"avatar":"https://static001.geekbang.org/account/avatar/00/10/db/d2/e29f8834.jpg","nickname":"lidashuang","note":"","ucode":"560ABE8032760E","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":300285,"discussion_content":"不要发明加密算法","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1598010546,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":158575,"user_name":"健少","can_delete":false,"product_type":"c1","uid":1099365,"ip_address":"","ucode":"63439F8DC540F6","user_header":"https://static001.geekbang.org/account/avatar/00/10/c6/65/64d1eaed.jpg","comment_is_top":false,"comment_ctime":1575420278,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"10165354870","product_id":100035801,"comment_content":"感谢老师分享！对系统监控又有一个深刻理解👍🏻","like_count":2},{"had_liked":false,"id":185556,"user_name":"Li Yao","can_delete":false,"product_type":"c1","uid":1129838,"ip_address":"","ucode":"703E1E5505F70D","user_header":"https://static001.geekbang.org/account/avatar/00/11/3d/6e/60680aa4.jpg","comment_is_top":false,"comment_ctime":1583632941,"is_pvip":false,"discussion_count":1,"race_medal":0,"score":"5878600237","product_id":100035801,"comment_content":"“APM 通道服务在接收到消息后，可以使用同样的算法生成摘要，并且与发送过来的摘要比对，以防止消息被篡改。”<br>这一块有点不太明白，既然消息已被加密，为什么还有被篡改的可能呢？","like_count":0,"discussions":[{"author":{"id":2586341,"avatar":"","nickname":"石头","note":"","ucode":"EB3C9A277C7B0C","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":370206,"discussion_content":"如果你完全信任https，那这些都没必要了。\n不过既然加密了确实已经是不可读的数据了，除非在加密之前改参数。\n还存在一种情况1.就是我是黑产，如果我能劫持到别的用户请求，我可以把整个加密后的数据直接换成我自己的已被加密的串。\n情况2，可能怕人家不改这个加密的串，而是其他的参数，所以加签名\n\n一般参数签名是客户端都会默认用的。至于作者写的加密只是因为考虑到数据的敏感性。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1619328361,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":169162,"user_name":"👽","can_delete":false,"product_type":"c1","uid":1274117,"ip_address":"","ucode":"D313AF941B412D","user_header":"https://static001.geekbang.org/account/avatar/00/13/71/05/db554eba.jpg","comment_is_top":false,"comment_ctime":1578282031,"is_pvip":false,"replies":[{"id":"66153","content":"是的","user_name":"作者回复","user_name_real":"唐扬","uid":"1448977","ctime":1578670054,"ip_address":"","comment_id":169162,"utype":1}],"discussion_count":1,"race_medal":0,"score":"5873249327","product_id":100035801,"comment_content":"这节课说实话没太理解，是不是说客户端发生部分卡顿，但是不是由服务器造成时。<br>需要由客户端记录请求的信息，并上传给服务器？","like_count":2,"discussions":[{"author":{"id":1448977,"avatar":"https://static001.geekbang.org/account/avatar/00/16/1c/11/4b45993d.jpg","nickname":"唐扬","note":"","ucode":"1AF4C4A4DBC6EF","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":480443,"discussion_content":"是的","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1578670054,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":159583,"user_name":"Keith","can_delete":false,"product_type":"c1","uid":1193337,"ip_address":"","ucode":"B40774090714D1","user_header":"https://static001.geekbang.org/account/avatar/00/12/35/79/21647da2.jpg","comment_is_top":false,"comment_ctime":1575694455,"is_pvip":false,"replies":[{"id":"61435","content":"还好，只要在SDK里面做了采样和聚合，定期发送就好了","user_name":"作者回复","user_name_real":"唐扬","uid":"1448977","ctime":1576131935,"ip_address":"","comment_id":159583,"utype":1}],"discussion_count":1,"race_medal":0,"score":"5870661751","product_id":100035801,"comment_content":"APM SDK和APM服务之间不需要通过消息队列连接吗? 这样直接将APM服务暴露到客户端的请求中, 会不会存在性能风险?","like_count":2,"discussions":[{"author":{"id":1448977,"avatar":"https://static001.geekbang.org/account/avatar/00/16/1c/11/4b45993d.jpg","nickname":"唐扬","note":"","ucode":"1AF4C4A4DBC6EF","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":477106,"discussion_content":"还好，只要在SDK里面做了采样和聚合，定期发送就好了","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1576131935,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":215049,"user_name":"钱","can_delete":false,"product_type":"c1","uid":1009652,"ip_address":"","ucode":"2C92A243A463D4","user_header":"https://static001.geekbang.org/account/avatar/00/0f/67/f4/9a1feb59.jpg","comment_is_top":false,"comment_ctime":1588897809,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1588897809","product_id":100035801,"comment_content":"想法是好的，全链路都监控起来对于排查问题大有帮助，不知道目前业内有哪些公司这么实现了？<br>服务端能把全链路监控做的不错的还没见到过，思路大概就是这样了，采集日志——转存日志——解析日志——呈现日志——利用日志发现问题、定位问题、解决问题。","like_count":0},{"had_liked":false,"id":214752,"user_name":"天草二十六","can_delete":false,"product_type":"c1","uid":1360712,"ip_address":"","ucode":"3165EE3007527B","user_header":"https://static001.geekbang.org/account/avatar/00/14/c3/48/3a739da6.jpg","comment_is_top":false,"comment_ctime":1588813922,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1588813922","product_id":100035801,"comment_content":"大佬，别浅尝则止啊。端到端监控都自己开发的工作量很大，特别对于小公司来说。服务端应用监控是很多了，可也还有一些是apm监控不到的应用内部信息，又该怎么样","like_count":0},{"had_liked":false,"id":175032,"user_name":"勇敢的心","can_delete":false,"product_type":"c1","uid":1085309,"ip_address":"","ucode":"C7136797DB55FC","user_header":"https://static001.geekbang.org/account/avatar/00/10/8f/7d/90598e6d.jpg","comment_is_top":false,"comment_ctime":1580532813,"is_pvip":false,"replies":[{"id":"68357","content":"我觉得自己搭建好一些","user_name":"作者回复","user_name_real":"唐扬","uid":"1448977","ctime":1580872587,"ip_address":"","comment_id":175032,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1580532813","product_id":100035801,"comment_content":"关于APM服务，对于中于型公司来说是自己搭建合适？还是买现成的服务比较合适呢？","like_count":0,"discussions":[{"author":{"id":1448977,"avatar":"https://static001.geekbang.org/account/avatar/00/16/1c/11/4b45993d.jpg","nickname":"唐扬","note":"","ucode":"1AF4C4A4DBC6EF","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":482604,"discussion_content":"我觉得自己搭建好一些","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1580872587,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":174149,"user_name":"南山","can_delete":false,"product_type":"c1","uid":1119593,"ip_address":"","ucode":"94656FE4A6C378","user_header":"https://static001.geekbang.org/account/avatar/00/11/15/69/187b9968.jpg","comment_is_top":false,"comment_ctime":1580028338,"is_pvip":true,"replies":[{"id":"68368","content":"谢谢~","user_name":"作者回复","user_name_real":"唐扬","uid":"1448977","ctime":1580873384,"ip_address":"","comment_id":174149,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1580028338","product_id":100035801,"comment_content":"自己确实是只关注服务端，工作中也碰到过网络问题抓瞎的场景，现在至少有思路排查了，赞","like_count":0,"discussions":[{"author":{"id":1448977,"avatar":"https://static001.geekbang.org/account/avatar/00/16/1c/11/4b45993d.jpg","nickname":"唐扬","note":"","ucode":"1AF4C4A4DBC6EF","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":482309,"discussion_content":"谢谢~","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1580873384,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":158748,"user_name":"正在减肥的胖籽。","can_delete":false,"product_type":"c1","uid":1033728,"ip_address":"","ucode":"99E2E4DF599236","user_header":"https://static001.geekbang.org/account/avatar/00/0f/c6/00/683bb4f0.jpg","comment_is_top":false,"comment_ctime":1575446288,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1575446288","product_id":100035801,"comment_content":"有没有开源的amp监控的工具？主要想学习下AMP的设计思想。","like_count":1},{"had_liked":false,"id":158699,"user_name":"旅途","can_delete":false,"product_type":"c1","uid":1212902,"ip_address":"","ucode":"5022477E8E9441","user_header":"https://static001.geekbang.org/account/avatar/00/12/81/e6/6cafed37.jpg","comment_is_top":false,"comment_ctime":1575435990,"is_pvip":false,"replies":[{"id":"61443","content":"有些失败不是服务端导致的，是客户端逻辑导致的，所以要上报","user_name":"作者回复","user_name_real":"唐扬","uid":"1448977","ctime":1576132433,"ip_address":"","comment_id":158699,"utype":1}],"discussion_count":2,"race_medal":0,"score":"1575435990","product_id":100035801,"comment_content":"老师，上报的异常数据，下单失败等等，这些在日志中不是有吗，上报这些的目的是什么呢","like_count":1,"discussions":[{"author":{"id":1448977,"avatar":"https://static001.geekbang.org/account/avatar/00/16/1c/11/4b45993d.jpg","nickname":"唐扬","note":"","ucode":"1AF4C4A4DBC6EF","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":476817,"discussion_content":"有些失败不是服务端导致的，是客户端逻辑导致的，所以要上报","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1576132433,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1205253,"avatar":"https://static001.geekbang.org/account/avatar/00/12/64/05/6989dce6.jpg","nickname":"我来也","note":"","ucode":"773D6104F56767","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":71800,"discussion_content":"如果用户临时断开网络，虽然请求失败了，但服务端不可能有这类错误。","likes_number":1,"is_delete":false,"is_hidden":false,"ctime":1575458829,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":158625,"user_name":"liuyu5337","can_delete":false,"product_type":"c1","uid":1035015,"ip_address":"","ucode":"1E730D55D009F6","user_header":"https://static001.geekbang.org/account/avatar/00/0f/cb/07/e2df01d8.jpg","comment_is_top":false,"comment_ctime":1575424102,"is_pvip":true,"replies":[{"id":"61445","content":"硬编码的话，如果需要变更就比较麻烦","user_name":"作者回复","user_name_real":"唐扬","uid":"1448977","ctime":1576132710,"ip_address":"","comment_id":158625,"utype":1}],"discussion_count":2,"race_medal":0,"score":"1575424102","product_id":100035801,"comment_content":"我们首先会分配给这个应用，一对 RSA 公钥和私钥，然后 SDK 在启动的时候，先请求一个策略服务，获取 RSA 公钥。请问老师，分配的RSA公钥和密钥是应用启动时向服务器请求的还是写在应用(硬编码或者配置文件)里？如果是启动时请求服务端得到RSA公钥和密钥，如果应用没有网络，该怎么处理？","like_count":0,"discussions":[{"author":{"id":1448977,"avatar":"https://static001.geekbang.org/account/avatar/00/16/1c/11/4b45993d.jpg","nickname":"唐扬","note":"","ucode":"1AF4C4A4DBC6EF","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":476784,"discussion_content":"硬编码的话，如果需要变更就比较麻烦","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1576132710,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1205253,"avatar":"https://static001.geekbang.org/account/avatar/00/12/64/05/6989dce6.jpg","nickname":"我来也","note":"","ucode":"773D6104F56767","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":71812,"discussion_content":"我觉得分配给这个应用的rsa，是可以写在配置文件中。\n每个用户请求时再返回一个用户唯一的rsa公钥。\n一旦用户在当前版本中，请求成功过，就可以写在本地，不用每次获取。\n另外，这种监控数据，可以先在本地日志中保存，等网络状况恢复，或业务数据不忙时，再汇报。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1575459303,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":158605,"user_name":"老磨","can_delete":false,"product_type":"c1","uid":1067581,"ip_address":"","ucode":"5255F0CBAAEAEF","user_header":"https://static001.geekbang.org/account/avatar/00/10/4a/3d/07df0cb7.jpg","comment_is_top":false,"comment_ctime":1575422108,"is_pvip":false,"discussion_count":2,"race_medal":0,"score":"1575422108","product_id":100035801,"comment_content":"实际上我们都是傻瓜操作，把所有的用户操作全部记录下来，然后让ML系统去学习，然后自动设置警报，诶，再也不用自己去写log了，无脑操作","like_count":0,"discussions":[{"author":{"id":1333690,"avatar":"https://static001.geekbang.org/account/avatar/00/14/59/ba/58e439bc.jpg","nickname":"约拿","note":"","ucode":"62B32226F61B34","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":550515,"discussion_content":"原来ml是机器学习的意思呀","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1644574762,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1886331,"avatar":"https://static001.geekbang.org/account/avatar/00/1c/c8/7b/153181d7.jpg","nickname":"夜辉","note":"","ucode":"9421385F51FF9E","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":364907,"discussion_content":"发现ML系统学习设计的警报会不会存在一些隐藏的问题？","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1617639558,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":158598,"user_name":"水目沾","can_delete":false,"product_type":"c1","uid":1274495,"ip_address":"","ucode":"FDD1D15C277D58","user_header":"https://static001.geekbang.org/account/avatar/00/13/72/7f/5da093c5.jpg","comment_is_top":false,"comment_ctime":1575421552,"is_pvip":false,"replies":[{"id":"61446","content":"是的，看你统计的未读，可能是账号ID，也可能是设备ID","user_name":"作者回复","user_name_real":"唐扬","uid":"1448977","ctime":1576132766,"ip_address":"","comment_id":158598,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1575421552","product_id":100035801,"comment_content":"请问下agent的标识是如何生成的？就是用户的账号id吗？","like_count":0,"discussions":[{"author":{"id":1448977,"avatar":"https://static001.geekbang.org/account/avatar/00/16/1c/11/4b45993d.jpg","nickname":"唐扬","note":"","ucode":"1AF4C4A4DBC6EF","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":476778,"discussion_content":"是的，看你统计的未读，可能是账号ID，也可能是设备ID","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1576132766,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":158585,"user_name":"峰","can_delete":false,"product_type":"c1","uid":1390326,"ip_address":"","ucode":"527BB65559F0B0","user_header":"https://static001.geekbang.org/account/avatar/00/15/36/f6/d65b7302.jpg","comment_is_top":false,"comment_ctime":1575420959,"is_pvip":false,"discussion_count":1,"race_medal":0,"score":"1575420959","product_id":100035801,"comment_content":"听了后不知道可以用哪些开源组件实现上讲和本讲的链路搭建","like_count":0,"discussions":[{"author":{"id":1141858,"avatar":"https://static001.geekbang.org/account/avatar/00/11/6c/62/baf10fb2.jpg","nickname":"枫叶11","note":"","ucode":"9953B0CA7367E2","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":80888,"discussion_content":"同问。老师能不能分享下实际生产中常用监控组合的使用和注意点？","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1576202168,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]}]}