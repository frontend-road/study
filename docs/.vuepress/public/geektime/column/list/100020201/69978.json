{"id":69978,"title":"13 | åŒæ ·çš„æœ¬è´¨ï¼Œä¸ºä½•Sparkå¯ä»¥æ›´é«˜æ•ˆï¼Ÿ","content":"<p>ä¸Šä¸€æœŸæˆ‘ä»¬è®¨è®ºäº†Sparkçš„ç¼–ç¨‹æ¨¡å‹ï¼Œè¿™æœŸæˆ‘ä»¬èŠèŠ<span class=\"orange\">Sparkçš„æ¶æ„åŸç†</span>ã€‚å’ŒMapReduceä¸€æ ·ï¼Œ<strong>Sparkä¹Ÿéµå¾ªç§»åŠ¨è®¡ç®—æ¯”ç§»åŠ¨æ•°æ®æ›´åˆ’ç®—è¿™ä¸€å¤§æ•°æ®è®¡ç®—åŸºæœ¬åŸåˆ™</strong>ã€‚ä½†æ˜¯å’ŒMapReduceåƒµåŒ–çš„Mapä¸Reduceåˆ†é˜¶æ®µè®¡ç®—ç›¸æ¯”ï¼ŒSparkçš„è®¡ç®—æ¡†æ¶æ›´åŠ å¯Œæœ‰å¼¹æ€§å’Œçµæ´»æ€§ï¼Œè¿›è€Œæœ‰æ›´å¥½çš„è¿è¡Œæ€§èƒ½ã€‚</p><h2>Sparkçš„è®¡ç®—é˜¶æ®µ</h2><p>æˆ‘ä»¬å¯ä»¥å¯¹æ¯”æ¥çœ‹ã€‚é¦–å…ˆå’ŒMapReduceä¸€ä¸ªåº”ç”¨ä¸€æ¬¡åªè¿è¡Œä¸€ä¸ªmapå’Œä¸€ä¸ªreduceä¸åŒï¼ŒSparkå¯ä»¥æ ¹æ®åº”ç”¨çš„å¤æ‚ç¨‹åº¦ï¼Œåˆ†å‰²æˆæ›´å¤šçš„è®¡ç®—é˜¶æ®µï¼ˆstageï¼‰ï¼Œè¿™äº›è®¡ç®—é˜¶æ®µç»„æˆä¸€ä¸ªæœ‰å‘æ— ç¯å›¾DAGï¼ŒSparkä»»åŠ¡è°ƒåº¦å™¨å¯ä»¥æ ¹æ®DAGçš„ä¾èµ–å…³ç³»æ‰§è¡Œè®¡ç®—é˜¶æ®µã€‚</p><p>è¿˜è®°å¾—åœ¨ä¸Šä¸€æœŸï¼Œæˆ‘ä¸¾äº†ä¸€ä¸ªæ¯”è¾ƒé€»è¾‘å›å½’æœºå™¨å­¦ä¹ æ€§èƒ½çš„ä¾‹å­ï¼Œå‘ç°Sparkæ¯”MapReduceå¿«100å¤šå€ã€‚å› ä¸ºæŸäº›æœºå™¨å­¦ä¹ ç®—æ³•å¯èƒ½éœ€è¦è¿›è¡Œå¤§é‡çš„è¿­ä»£è®¡ç®—ï¼Œäº§ç”Ÿæ•°ä¸‡ä¸ªè®¡ç®—é˜¶æ®µï¼Œè¿™äº›è®¡ç®—é˜¶æ®µåœ¨ä¸€ä¸ªåº”ç”¨ä¸­å¤„ç†å®Œæˆï¼Œè€Œä¸æ˜¯åƒMapReduceé‚£æ ·éœ€è¦å¯åŠ¨æ•°ä¸‡ä¸ªåº”ç”¨ï¼Œå› æ­¤æå¤§åœ°æé«˜äº†è¿è¡Œæ•ˆç‡ã€‚</p><p>æ‰€è°“DAGä¹Ÿå°±æ˜¯æœ‰å‘æ— ç¯å›¾ï¼Œå°±æ˜¯è¯´ä¸åŒé˜¶æ®µçš„ä¾èµ–å…³ç³»æ˜¯æœ‰å‘çš„ï¼Œè®¡ç®—è¿‡ç¨‹åªèƒ½æ²¿ç€ä¾èµ–å…³ç³»æ–¹å‘æ‰§è¡Œï¼Œè¢«ä¾èµ–çš„é˜¶æ®µæ‰§è¡Œå®Œæˆä¹‹å‰ï¼Œä¾èµ–çš„é˜¶æ®µä¸èƒ½å¼€å§‹æ‰§è¡Œï¼ŒåŒæ—¶ï¼Œè¿™ä¸ªä¾èµ–å…³ç³»ä¸èƒ½æœ‰ç¯å½¢ä¾èµ–ï¼Œå¦åˆ™å°±æˆä¸ºæ­»å¾ªç¯äº†ã€‚ä¸‹é¢è¿™å¼ å›¾æè¿°äº†ä¸€ä¸ªå…¸å‹çš„Sparkè¿è¡ŒDAGçš„ä¸åŒé˜¶æ®µã€‚</p><!-- [[[read_end]]] --><p><img src=\"https://static001.geekbang.org/resource/image/c8/db/c8cf515c664b478e51058565e0d4a8db.png?wh=1296*712\" alt=\"\"></p><p>ä»å›¾ä¸Šçœ‹ï¼Œæ•´ä¸ªåº”ç”¨è¢«åˆ‡åˆ†æˆ3ä¸ªé˜¶æ®µï¼Œé˜¶æ®µ3éœ€è¦ä¾èµ–é˜¶æ®µ1å’Œé˜¶æ®µ2ï¼Œé˜¶æ®µ1å’Œé˜¶æ®µ2äº’ä¸ä¾èµ–ã€‚Sparkåœ¨æ‰§è¡Œè°ƒåº¦çš„æ—¶å€™ï¼Œå…ˆæ‰§è¡Œé˜¶æ®µ1å’Œé˜¶æ®µ2ï¼Œå®Œæˆä»¥åï¼Œå†æ‰§è¡Œé˜¶æ®µ3ã€‚å¦‚æœæœ‰æ›´å¤šçš„é˜¶æ®µï¼ŒSparkçš„ç­–ç•¥ä¹Ÿæ˜¯ä¸€æ ·çš„ã€‚åªè¦æ ¹æ®ç¨‹åºåˆå§‹åŒ–å¥½DAGï¼Œå°±å»ºç«‹äº†ä¾èµ–å…³ç³»ï¼Œç„¶åæ ¹æ®ä¾èµ–å…³ç³»é¡ºåºæ‰§è¡Œå„ä¸ªè®¡ç®—é˜¶æ®µï¼ŒSparkå¤§æ•°æ®åº”ç”¨çš„è®¡ç®—å°±å®Œæˆäº†ã€‚</p><p>ä¸Šå›¾è¿™ä¸ªDAGå¯¹åº”çš„Sparkç¨‹åºä¼ªä»£ç å¦‚ä¸‹ã€‚</p><pre><code>rddB = rddA.groupBy(key)\nrddD = rddC.map(func)\nrddF = rddD.union(rddE)\nrddG = rddB.join(rddF)\n</code></pre><p>æ‰€ä»¥ï¼Œä½ å¯ä»¥çœ‹åˆ°Sparkä½œä¸šè°ƒåº¦æ‰§è¡Œçš„æ ¸å¿ƒæ˜¯DAGï¼Œæœ‰äº†DAGï¼Œæ•´ä¸ªåº”ç”¨å°±è¢«åˆ‡åˆ†æˆå“ªäº›é˜¶æ®µï¼Œæ¯ä¸ªé˜¶æ®µçš„ä¾èµ–å…³ç³»ä¹Ÿå°±æ¸…æ¥šäº†ã€‚ä¹‹åå†æ ¹æ®æ¯ä¸ªé˜¶æ®µè¦å¤„ç†çš„æ•°æ®é‡ç”Ÿæˆç›¸åº”çš„ä»»åŠ¡é›†åˆï¼ˆTaskSetï¼‰ï¼Œæ¯ä¸ªä»»åŠ¡éƒ½åˆ†é…ä¸€ä¸ªä»»åŠ¡è¿›ç¨‹å»å¤„ç†ï¼ŒSparkå°±å®ç°äº†å¤§æ•°æ®çš„åˆ†å¸ƒå¼è®¡ç®—ã€‚</p><p>å…·ä½“æ¥çœ‹çš„è¯ï¼Œè´Ÿè´£Sparkåº”ç”¨DAGç”Ÿæˆå’Œç®¡ç†çš„ç»„ä»¶æ˜¯DAGSchedulerï¼ŒDAGScheduleræ ¹æ®ç¨‹åºä»£ç ç”ŸæˆDAGï¼Œç„¶åå°†ç¨‹åºåˆ†å‘åˆ°åˆ†å¸ƒå¼è®¡ç®—é›†ç¾¤ï¼ŒæŒ‰è®¡ç®—é˜¶æ®µçš„å…ˆåå…³ç³»è°ƒåº¦æ‰§è¡Œã€‚</p><p>é‚£ä¹ˆSparkåˆ’åˆ†è®¡ç®—é˜¶æ®µçš„ä¾æ®æ˜¯ä»€ä¹ˆå‘¢ï¼Ÿæ˜¾ç„¶å¹¶ä¸æ˜¯RDDä¸Šçš„æ¯ä¸ªè½¬æ¢å‡½æ•°éƒ½ä¼šç”Ÿæˆä¸€ä¸ªè®¡ç®—é˜¶æ®µï¼Œæ¯”å¦‚ä¸Šé¢çš„ä¾‹å­æœ‰4ä¸ªè½¬æ¢å‡½æ•°ï¼Œä½†æ˜¯åªæœ‰3ä¸ªé˜¶æ®µã€‚</p><p>ä½ å¯ä»¥å†è§‚å¯Ÿä¸€ä¸‹ä¸Šé¢çš„DAGå›¾ï¼Œå…³äºè®¡ç®—é˜¶æ®µçš„åˆ’åˆ†ä»å›¾ä¸Šå°±èƒ½çœ‹å‡ºè§„å¾‹ï¼Œå½“RDDä¹‹é—´çš„è½¬æ¢è¿æ¥çº¿å‘ˆç°å¤šå¯¹å¤šäº¤å‰è¿æ¥çš„æ—¶å€™ï¼Œå°±ä¼šäº§ç”Ÿæ–°çš„é˜¶æ®µã€‚ä¸€ä¸ªRDDä»£è¡¨ä¸€ä¸ªæ•°æ®é›†ï¼Œå›¾ä¸­æ¯ä¸ªRDDé‡Œé¢éƒ½åŒ…å«å¤šä¸ªå°å—ï¼Œæ¯ä¸ªå°å—ä»£è¡¨RDDçš„ä¸€ä¸ªåˆ†ç‰‡ã€‚</p><p>ä¸€ä¸ªæ•°æ®é›†ä¸­çš„å¤šä¸ªæ•°æ®åˆ†ç‰‡éœ€è¦è¿›è¡Œåˆ†åŒºä¼ è¾“ï¼Œå†™å…¥åˆ°å¦ä¸€ä¸ªæ•°æ®é›†çš„ä¸åŒåˆ†ç‰‡ä¸­ï¼Œè¿™ç§æ•°æ®åˆ†åŒºäº¤å‰ä¼ è¾“çš„æ“ä½œï¼Œæˆ‘ä»¬åœ¨MapReduceçš„è¿è¡Œè¿‡ç¨‹ä¸­ä¹Ÿçœ‹åˆ°è¿‡ã€‚</p><p><img src=\"https://static001.geekbang.org/resource/image/d6/c7/d64daa9a621c1d423d4a1c13054396c7.png?wh=1316*772\" alt=\"\"></p><p>æ˜¯çš„ï¼Œè¿™å°±æ˜¯shuffleè¿‡ç¨‹ï¼ŒSparkä¹Ÿéœ€è¦é€šè¿‡shuffleå°†æ•°æ®è¿›è¡Œé‡æ–°ç»„åˆï¼Œç›¸åŒKeyçš„æ•°æ®æ”¾åœ¨ä¸€èµ·ï¼Œè¿›è¡Œèšåˆã€å…³è”ç­‰æ“ä½œï¼Œå› è€Œæ¯æ¬¡shuffleéƒ½äº§ç”Ÿæ–°çš„è®¡ç®—é˜¶æ®µã€‚è¿™ä¹Ÿæ˜¯ä¸ºä»€ä¹ˆè®¡ç®—é˜¶æ®µä¼šæœ‰ä¾èµ–å…³ç³»ï¼Œå®ƒéœ€è¦çš„æ•°æ®æ¥æºäºå‰é¢ä¸€ä¸ªæˆ–å¤šä¸ªè®¡ç®—é˜¶æ®µäº§ç”Ÿçš„æ•°æ®ï¼Œå¿…é¡»ç­‰å¾…å‰é¢çš„é˜¶æ®µæ‰§è¡Œå®Œæ¯•æ‰èƒ½è¿›è¡Œshuffleï¼Œå¹¶å¾—åˆ°æ•°æ®ã€‚</p><p>è¿™é‡Œéœ€è¦ä½ ç‰¹åˆ«æ³¨æ„çš„æ˜¯ï¼Œ<strong>è®¡ç®—é˜¶æ®µåˆ’åˆ†çš„ä¾æ®æ˜¯shuffleï¼Œä¸æ˜¯è½¬æ¢å‡½æ•°çš„ç±»å‹</strong>ï¼Œæœ‰çš„å‡½æ•°æœ‰æ—¶å€™æœ‰shuffleï¼Œæœ‰æ—¶å€™æ²¡æœ‰ã€‚æ¯”å¦‚ä¸Šå›¾ä¾‹å­ä¸­RDD Bå’ŒRDD Fè¿›è¡Œjoinï¼Œå¾—åˆ°RDD Gï¼Œè¿™é‡Œçš„RDD Féœ€è¦è¿›è¡Œshuffleï¼ŒRDD Bå°±ä¸éœ€è¦ã€‚</p><p><img src=\"https://static001.geekbang.org/resource/image/4e/8b/4e5c79d1ad7152bc8ab8bc350cf6778b.png?wh=508*644\" alt=\"\"></p><p>å› ä¸ºRDD Båœ¨å‰é¢ä¸€ä¸ªé˜¶æ®µï¼Œé˜¶æ®µ1çš„shuffleè¿‡ç¨‹ä¸­ï¼Œå·²ç»è¿›è¡Œäº†æ•°æ®åˆ†åŒºã€‚åˆ†åŒºæ•°ç›®å’Œåˆ†åŒºKeyä¸å˜ï¼Œå°±ä¸éœ€è¦å†è¿›è¡Œshuffleã€‚</p><p><img src=\"https://static001.geekbang.org/resource/image/46/25/4650b622d9c6ed5f65670482cc8ca325.png?wh=558*222\" alt=\"\"></p><p>è¿™ç§ä¸éœ€è¦è¿›è¡Œshuffleçš„ä¾èµ–ï¼Œåœ¨Sparké‡Œè¢«ç§°ä½œçª„ä¾èµ–ï¼›ç›¸åçš„ï¼Œéœ€è¦è¿›è¡Œshuffleçš„ä¾èµ–ï¼Œè¢«ç§°ä½œå®½ä¾èµ–ã€‚è·ŸMapReduceä¸€æ ·ï¼Œshuffleä¹Ÿæ˜¯Sparkæœ€é‡è¦çš„ä¸€ä¸ªç¯èŠ‚ï¼Œåªæœ‰é€šè¿‡shuffleï¼Œç›¸å…³æ•°æ®æ‰èƒ½äº’ç›¸è®¡ç®—ï¼Œæ„å»ºèµ·å¤æ‚çš„åº”ç”¨é€»è¾‘ã€‚</p><p>åœ¨ä½ ç†Ÿæ‚‰Sparké‡Œçš„shuffleæœºåˆ¶åæˆ‘ä»¬å›åˆ°ä»Šå¤©æ–‡ç« çš„æ ‡é¢˜ï¼ŒåŒæ ·éƒ½è¦ç»è¿‡shuffleï¼Œä¸ºä»€ä¹ˆSparkå¯ä»¥æ›´é«˜æ•ˆå‘¢ï¼Ÿ</p><p>å…¶å®ä»æœ¬è´¨ä¸Šçœ‹ï¼ŒSparkå¯ä»¥ç®—ä½œæ˜¯ä¸€ç§MapReduceè®¡ç®—æ¨¡å‹çš„ä¸åŒå®ç°ã€‚Hadoop MapReduceç®€å•ç²—æš´åœ°æ ¹æ®shuffleå°†å¤§æ•°æ®è®¡ç®—åˆ†æˆMapå’ŒReduceä¸¤ä¸ªé˜¶æ®µï¼Œç„¶åå°±ç®—å®Œäº‹äº†ã€‚è€ŒSparkæ›´ç»†è…»ä¸€ç‚¹ï¼Œå°†å‰ä¸€ä¸ªçš„Reduceå’Œåä¸€ä¸ªçš„Mapè¿æ¥èµ·æ¥ï¼Œå½“ä½œä¸€ä¸ªé˜¶æ®µæŒç»­è®¡ç®—ï¼Œå½¢æˆä¸€ä¸ªæ›´åŠ ä¼˜é›…ã€é«˜æ•ˆçš„è®¡ç®—æ¨¡å‹ï¼Œè™½ç„¶å…¶æœ¬è´¨ä¾ç„¶æ˜¯Mapå’ŒReduceã€‚ä½†æ˜¯è¿™ç§å¤šä¸ªè®¡ç®—é˜¶æ®µä¾èµ–æ‰§è¡Œçš„æ–¹æ¡ˆå¯ä»¥æœ‰æ•ˆå‡å°‘å¯¹HDFSçš„è®¿é—®ï¼Œå‡å°‘ä½œä¸šçš„è°ƒåº¦æ‰§è¡Œæ¬¡æ•°ï¼Œå› æ­¤æ‰§è¡Œé€Ÿåº¦ä¹Ÿæ›´å¿«ã€‚</p><p>å¹¶ä¸”å’ŒHadoop MapReduceä¸»è¦ä½¿ç”¨ç£ç›˜å­˜å‚¨shuffleè¿‡ç¨‹ä¸­çš„æ•°æ®ä¸åŒï¼ŒSparkä¼˜å…ˆä½¿ç”¨å†…å­˜è¿›è¡Œæ•°æ®å­˜å‚¨ï¼ŒåŒ…æ‹¬RDDæ•°æ®ã€‚é™¤éæ˜¯å†…å­˜ä¸å¤Ÿç”¨äº†ï¼Œå¦åˆ™æ˜¯å°½å¯èƒ½ä½¿ç”¨å†…å­˜ï¼Œ è¿™ä¹Ÿæ˜¯Sparkæ€§èƒ½æ¯”Hadoopé«˜çš„å¦ä¸€ä¸ªåŸå› ã€‚</p><h2>Sparkçš„ä½œä¸šç®¡ç†</h2><p>æˆ‘åœ¨ä¸“æ ä¸Šä¸€æœŸæåˆ°ï¼ŒSparké‡Œé¢çš„RDDå‡½æ•°æœ‰ä¸¤ç§ï¼Œä¸€ç§æ˜¯è½¬æ¢å‡½æ•°ï¼Œè°ƒç”¨ä»¥åå¾—åˆ°çš„è¿˜æ˜¯ä¸€ä¸ªRDDï¼ŒRDDçš„è®¡ç®—é€»è¾‘ä¸»è¦é€šè¿‡è½¬æ¢å‡½æ•°å®Œæˆã€‚</p><p>å¦ä¸€ç§æ˜¯actionå‡½æ•°ï¼Œè°ƒç”¨ä»¥åä¸å†è¿”å›RDDã€‚æ¯”å¦‚<strong>count</strong>()å‡½æ•°ï¼Œè¿”å›RDDä¸­æ•°æ®çš„å…ƒç´ ä¸ªæ•°ï¼›<strong>saveAsTextFile</strong>(path)ï¼Œå°†RDDæ•°æ®å­˜å‚¨åˆ°pathè·¯å¾„ä¸‹ã€‚Sparkçš„DAGScheduleråœ¨é‡åˆ°shuffleçš„æ—¶å€™ï¼Œä¼šç”Ÿæˆä¸€ä¸ªè®¡ç®—é˜¶æ®µï¼Œåœ¨é‡åˆ°actionå‡½æ•°çš„æ—¶å€™ï¼Œä¼šç”Ÿæˆä¸€ä¸ªä½œä¸šï¼ˆjobï¼‰ã€‚</p><p>RDDé‡Œé¢çš„æ¯ä¸ªæ•°æ®åˆ†ç‰‡ï¼ŒSparkéƒ½ä¼šåˆ›å»ºä¸€ä¸ªè®¡ç®—ä»»åŠ¡å»å¤„ç†ï¼Œæ‰€ä»¥ä¸€ä¸ªè®¡ç®—é˜¶æ®µä¼šåŒ…å«å¾ˆå¤šä¸ªè®¡ç®—ä»»åŠ¡ï¼ˆtaskï¼‰ã€‚</p><p>å…³äºä½œä¸šã€è®¡ç®—é˜¶æ®µã€ä»»åŠ¡çš„ä¾èµ–å’Œæ—¶é—´å…ˆåå…³ç³»ä½ å¯ä»¥é€šè¿‡ä¸‹å›¾çœ‹åˆ°ã€‚</p><p><img src=\"https://static001.geekbang.org/resource/image/2b/d0/2bf9e431bbd543165588a111513567d0.png?wh=668*188\" alt=\"\"></p><p>å›¾ä¸­æ¨ªè½´æ–¹å‘æ˜¯æ—¶é—´ï¼Œçºµè½´æ–¹å‘æ˜¯ä»»åŠ¡ã€‚ä¸¤æ¡ç²—é»‘çº¿ä¹‹é—´æ˜¯ä¸€ä¸ªä½œä¸šï¼Œä¸¤æ¡ç»†çº¿ä¹‹é—´æ˜¯ä¸€ä¸ªè®¡ç®—é˜¶æ®µã€‚ä¸€ä¸ªä½œä¸šè‡³å°‘åŒ…å«ä¸€ä¸ªè®¡ç®—é˜¶æ®µã€‚æ°´å¹³æ–¹å‘çº¢è‰²çš„çº¿æ˜¯ä»»åŠ¡ï¼Œæ¯ä¸ªé˜¶æ®µç”±å¾ˆå¤šä¸ªä»»åŠ¡ç»„æˆï¼Œè¿™äº›ä»»åŠ¡ç»„æˆä¸€ä¸ªä»»åŠ¡é›†åˆã€‚</p><p>DAGScheduleræ ¹æ®ä»£ç ç”ŸæˆDAGå›¾ä»¥åï¼ŒSparkçš„ä»»åŠ¡è°ƒåº¦å°±ä»¥ä»»åŠ¡ä¸ºå•ä½è¿›è¡Œåˆ†é…ï¼Œå°†ä»»åŠ¡åˆ†é…åˆ°åˆ†å¸ƒå¼é›†ç¾¤çš„ä¸åŒæœºå™¨ä¸Šæ‰§è¡Œã€‚</p><h2>Sparkçš„æ‰§è¡Œè¿‡ç¨‹</h2><p>Sparkæ”¯æŒStandaloneã€Yarnã€Mesosã€Kubernetesç­‰å¤šç§éƒ¨ç½²æ–¹æ¡ˆï¼Œå‡ ç§éƒ¨ç½²æ–¹æ¡ˆåŸç†ä¹Ÿéƒ½ä¸€æ ·ï¼Œåªæ˜¯ä¸åŒç»„ä»¶è§’è‰²å‘½åä¸åŒï¼Œä½†æ˜¯æ ¸å¿ƒåŠŸèƒ½å’Œè¿è¡Œæµç¨‹éƒ½å·®ä¸å¤šã€‚</p><p><img src=\"https://static001.geekbang.org/resource/image/16/db/164e9460133d7744d0315a876e7b6fdb.png?wh=596*286\" alt=\"\"></p><p>ä¸Šé¢è¿™å¼ å›¾æ˜¯Sparkçš„è¿è¡Œæµç¨‹ï¼Œæˆ‘ä»¬ä¸€æ­¥ä¸€æ­¥æ¥çœ‹ã€‚</p><p>é¦–å…ˆï¼ŒSparkåº”ç”¨ç¨‹åºå¯åŠ¨åœ¨è‡ªå·±çš„JVMè¿›ç¨‹é‡Œï¼Œå³Driverè¿›ç¨‹ï¼Œå¯åŠ¨åè°ƒç”¨SparkContextåˆå§‹åŒ–æ‰§è¡Œé…ç½®å’Œè¾“å…¥æ•°æ®ã€‚SparkContextå¯åŠ¨DAGScheduleræ„é€ æ‰§è¡Œçš„DAGå›¾ï¼Œåˆ‡åˆ†æˆæœ€å°çš„æ‰§è¡Œå•ä½ä¹Ÿå°±æ˜¯è®¡ç®—ä»»åŠ¡ã€‚</p><p>ç„¶åDriverå‘Cluster Managerè¯·æ±‚è®¡ç®—èµ„æºï¼Œç”¨äºDAGçš„åˆ†å¸ƒå¼è®¡ç®—ã€‚Cluster Manageræ”¶åˆ°è¯·æ±‚ä»¥åï¼Œå°†Driverçš„ä¸»æœºåœ°å€ç­‰ä¿¡æ¯é€šçŸ¥ç»™é›†ç¾¤çš„æ‰€æœ‰è®¡ç®—èŠ‚ç‚¹Workerã€‚</p><p>Workeræ”¶åˆ°ä¿¡æ¯ä»¥åï¼Œæ ¹æ®Driverçš„ä¸»æœºåœ°å€ï¼Œè·ŸDriveré€šä¿¡å¹¶æ³¨å†Œï¼Œç„¶åæ ¹æ®è‡ªå·±çš„ç©ºé—²èµ„æºå‘Driveré€šæŠ¥è‡ªå·±å¯ä»¥é¢†ç”¨çš„ä»»åŠ¡æ•°ã€‚Driveræ ¹æ®DAGå›¾å¼€å§‹å‘æ³¨å†Œçš„Workeråˆ†é…ä»»åŠ¡ã€‚</p><p>Workeræ”¶åˆ°ä»»åŠ¡åï¼Œå¯åŠ¨Executorè¿›ç¨‹å¼€å§‹æ‰§è¡Œä»»åŠ¡ã€‚Executorå…ˆæ£€æŸ¥è‡ªå·±æ˜¯å¦æœ‰Driverçš„æ‰§è¡Œä»£ç ï¼Œå¦‚æœæ²¡æœ‰ï¼Œä»Driverä¸‹è½½æ‰§è¡Œä»£ç ï¼Œé€šè¿‡Javaåå°„åŠ è½½åå¼€å§‹æ‰§è¡Œã€‚</p><h2>å°ç»“</h2><p>æ€»ç»“æ¥è¯´ï¼ŒSparkæœ‰ä¸‰ä¸ªä¸»è¦ç‰¹æ€§ï¼š<strong>RDDçš„ç¼–ç¨‹æ¨¡å‹æ›´ç®€å•ï¼ŒDAGåˆ‡åˆ†çš„å¤šé˜¶æ®µè®¡ç®—è¿‡ç¨‹æ›´å¿«é€Ÿï¼Œä½¿ç”¨å†…å­˜å­˜å‚¨ä¸­é—´è®¡ç®—ç»“æœæ›´é«˜æ•ˆ</strong>ã€‚è¿™ä¸‰ä¸ªç‰¹æ€§ä½¿å¾—Sparkç›¸å¯¹Hadoop MapReduceå¯ä»¥æœ‰æ›´å¿«çš„æ‰§è¡Œé€Ÿåº¦ï¼Œä»¥åŠæ›´ç®€å•çš„ç¼–ç¨‹å®ç°ã€‚</p><p>Sparkçš„å‡ºç°å’Œæµè¡Œå…¶å®ä¹Ÿæœ‰æŸç§å¿…ç„¶æ€§ï¼Œæ˜¯å¤©æ—¶ã€åœ°åˆ©ã€äººå’Œçš„å…±åŒä½œç”¨ã€‚é¦–å…ˆï¼ŒSparkåœ¨2012å¹´å·¦å³å¼€å§‹æµè¡Œï¼Œé‚£æ—¶å†…å­˜çš„å®¹é‡æå‡å’Œæˆæœ¬é™ä½å·²ç»æ¯”MapReduceå‡ºç°çš„åå¹´å‰å¼ºäº†ä¸€ä¸ªæ•°é‡çº§ï¼ŒSparkä¼˜å…ˆä½¿ç”¨å†…å­˜çš„æ¡ä»¶å·²ç»æˆç†Ÿï¼›å…¶æ¬¡ï¼Œä½¿ç”¨å¤§æ•°æ®è¿›è¡Œæœºå™¨å­¦ä¹ çš„éœ€æ±‚è¶Šæ¥è¶Šå¼ºçƒˆï¼Œä¸å†æ˜¯æ—©å…ˆå¹´é‚£ç§æ•°æ®åˆ†æçš„ç®€å•è®¡ç®—éœ€æ±‚ã€‚è€Œæœºå™¨å­¦ä¹ çš„ç®—æ³•å¤§å¤šéœ€è¦å¾ˆå¤šè½®è¿­ä»£ï¼ŒSparkçš„stageåˆ’åˆ†ç›¸æ¯”Mapå’ŒReduceçš„ç®€å•åˆ’åˆ†ï¼Œæœ‰æ›´åŠ å‹å¥½çš„ç¼–ç¨‹ä½“éªŒå’Œæ›´é«˜æ•ˆçš„æ‰§è¡Œæ•ˆç‡ã€‚äºæ˜¯Sparkæˆä¸ºå¤§æ•°æ®è®¡ç®—æ–°çš„ç‹è€…ä¹Ÿå°±ä¸è¶³ä¸ºå¥‡äº†ã€‚</p><h2>æ€è€ƒé¢˜</h2><p>Sparkçš„æµè¡Œç¦»ä¸å¼€å®ƒæˆåŠŸçš„å¼€æºè¿ä½œï¼Œå¼€æºå¹¶ä¸æ˜¯æŠŠæºä»£ç ä¸¢åˆ°GitHubä¸Šå…¬å¼€å°±ä¸‡äº‹å¤§å‰äº†ï¼Œä¸€ä¸ªæˆåŠŸçš„å¼€æºé¡¹ç›®éœ€è¦å¸å¼•å¤§é‡é«˜è´¨é‡å¼€å‘è€…å‚ä¸å…¶ä¸­ï¼Œè¿˜éœ€è¦å¾ˆå¤šç”¨æˆ·ä½¿ç”¨æ‰èƒ½å½¢æˆå½±å“åŠ›ã€‚</p><p>Sparkå¼€å‘å›¢é˜Ÿä¸ºSparkå¼€æºè¿ä½œè¿›è¡Œäº†å¤§é‡çš„å•†ä¸šå’Œéå•†ä¸šæ´»åŠ¨ï¼Œä½ äº†è§£è¿™äº›æ´»åŠ¨æœ‰å“ªäº›å—ï¼Ÿå‡å¦‚ä½ æ‰€åœ¨çš„å…¬å¸æƒ³è¦å¼€æºè‡ªå·±çš„è½¯ä»¶ï¼Œç”¨äºæå‡è‡ªå·±å…¬å¸çš„æŠ€æœ¯ç«äº‰åŠ›å’Œå½±å“åŠ›ï¼Œå¦‚æœæ˜¯ä½ è´Ÿè´£äººï¼Œä½ åº”è¯¥å¦‚ä½•è¿ä½œï¼Ÿ</p><p>æ¬¢è¿ä½ å†™ä¸‹è‡ªå·±çš„æ€è€ƒæˆ–ç–‘é—®ï¼Œä¸æˆ‘å’Œå…¶ä»–åŒå­¦ä¸€èµ·è®¨è®ºã€‚</p>","neighbors":{"left":{"article_title":"12 | æˆ‘ä»¬å¹¶æ²¡æœ‰è§‰å¾—MapReduceé€Ÿåº¦æ…¢ï¼Œç›´åˆ°Sparkå‡ºç°","id":69822},"right":{"article_title":"14 | BigTableçš„å¼€æºå®ç°ï¼šHBase","id":70253}},"comments":[{"had_liked":false,"id":53884,"user_name":"vivi","can_delete":false,"product_type":"c1","uid":1316902,"ip_address":"","ucode":"17A9A72EC95315","user_header":"http://thirdwx.qlogo.cn/mmopen/vi_32/oNyD409Hg3iaSaMpF3ibn35FstWN3AHnQaJf7LaIqkrsvHZcd8lYbOicDiaU1NcicoERz5kC3YKM4iaYsXpHBYEVW6yw/132","comment_is_top":false,"comment_ctime":1545748148,"is_pvip":false,"replies":[{"id":"19546","content":"ğŸ‘ğŸ»","user_name":"ä½œè€…å›å¤","comment_id":53884,"uid":"1007349","ip_address":"","utype":1,"ctime":1545786780,"user_name_real":"ææ™ºæ…§"}],"discussion_count":1,"race_medal":0,"score":"280718622388","product_id":100020201,"comment_content":"æ‡‚äº†åŸç†ï¼Œå®æˆ˜å…¶å®å¾ˆç®€å•ï¼Œä¸ç”¨æ€¥ç€å­¦éƒ¨ç½²å•Šï¼Œæ“ä½œï¼ŒåŸç†æ‡‚äº†ï¼Œæ‰èƒ½ç”¨å¥½ï¼Œæˆ‘è§‰å¾—è®²å¾—å¾ˆå¥½","like_count":66,"discussions":[{"author":{"id":1007349,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/5e/f5/018907ac.jpg","nickname":"ææ™ºæ…§","note":"","ucode":"8C9980C438AFD1","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":434278,"discussion_content":"ğŸ‘ğŸ»","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1545786780,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":160064,"user_name":"å¼ å°å–µ","can_delete":false,"product_type":"c1","uid":1708090,"ip_address":"","ucode":"2CD5003020D751","user_header":"https://static001.geekbang.org/account/avatar/00/1a/10/3a/053852ee.jpg","comment_is_top":false,"comment_ctime":1575862570,"is_pvip":false,"discussion_count":1,"race_medal":0,"score":"160489652522","product_id":100020201,"comment_content":"æŠŠ12|13åå¤è¯»äº†4ã€5éï¼Œä»¥ä¸‹æ˜¯æˆ‘çš„æ„Ÿæ‚Ÿ<br>Sparkå†æ¬¡ç†è§£ï¼š<br>\t1ï¼šSparkè®¡ç®—æ¡†æ¶ç¼–ç¨‹å’Œè¿è¡Œé€Ÿåº¦æ¯”MapReduceæ›´åŠ çš„ç®€å•å’Œå¿«<br>\tç¼–ç¨‹æ›´ç®€å•ï¼šSparkç¼–ç¨‹å…³æ³¨çš„æ•°æ®æ˜¯RDDï¼ŒRDDæ˜¯ä¸ªæŠ½è±¡çš„ï¼Œæ¯”è¾ƒä¸å¥½ç†è§£ï¼Œæˆ‘çš„ç†è§£RDDæ˜¯ä¸€æ¬¡è®¡ç®—é˜¶æ®µä¸­ è¦æ“ä½œçš„æ‰€æœ‰çš„æ•°æ®çš„æŠ½è±¡ï¼Œè™½ç„¶å®ƒä»¬æ˜¯åˆ†ç‰‡çš„ï¼Œå¹¶ä¸”åˆ†å¸ƒåœ¨HDFSçš„ä»»æ„èŠ‚ç‚¹ä¸Šï¼Œä½†æ˜¯æ¦‚å¿µä¸Šï¼Œæˆ‘ä»¬æ˜¯é’ˆå¯¹è¿™ä¸ªæŠ½è±¡çš„RDDç¼–ç¨‹çš„ã€‚ä½¿ç”¨Scalaç¼–ç¨‹ï¼Œwordcountåªéœ€è¦ä¸‰è¡Œä»£ç ï¼Œå¾ˆç®€å•æ˜¯å§ï¼Œä½†æ˜¯èƒŒåçš„æ•´ä½“çš„è®¡ç®—è¿‡ç¨‹æ˜¯ç›¸å½“çš„å¤æ‚çš„ã€‚è¿™æ ·çœ‹æˆ‘ä»¬åœ¨MapReduceä¸­çš„ç¼–ç¨‹è¦æ˜¯å…³æ³¨æ‰€æœ‰çš„æ•°æ®çš„ï¼Œé»˜è®¤ä¸ºmapçš„æ•°æ®è¾“å…¥çš„æ•°æ®æ˜¯æ•´ä¸ªè¦å¤„ç†çš„æ•°æ®ï¼Œå¹¶ä¸æ˜¯è¯´ï¼Œå…¶ä»–çš„åº”ç”¨å°±ä¸çŸ¥é“äº†ï¼Œæ¯•ç«Ÿæˆ‘ä»¬ä¹Ÿå¯ä»¥åœ¨ä»£ç ä¸­æ„ŸçŸ¥åˆ°åœ¨æ–‡ä»¶ä¸­çš„åç§»é‡è¿™ç§ä¸œè¥¿ã€‚<br>\té€Ÿåº¦æ›´å¿«ï¼šMapReduceæš´åŠ›çš„æŠŠè®¡ç®—é˜¶æ®µåˆ†ä¸ºä¸¤ä¸ªé˜¶æ®µï¼ŒMapå’ŒReduceé˜¶æ®µï¼Œ å¦‚æœä¸€ä¸ªåº”ç”¨çš„è®¡ç®—å®ç°åªæœ‰ä¸¤ä¸ªé˜¶æ®µï¼Œé‚£ä¹ˆMapReduceè®¡ç®—æ¡†æ¶çš„é€Ÿåº¦ä¸ä¼šæ¯”Sparkæ…¢å¤šå°‘ï¼Œæ…¢çš„åœ°æ–¹åªæ˜¯åœ¨äºSparkæ˜¯ä¸ç»è¿‡è½ç›˜çš„æ“ä½œçš„ï¼Œç›´æ¥åœ¨å†…å­˜ä¸­å­˜å‚¨ï¼Œä½†æ˜¯å¦‚æœä¸€ä¸ªåº”ç”¨çš„è®¡ç®—é˜¶æ®µå˜å¾—å¾ˆå¤šçš„è¯ï¼Œæ¯”å¦‚æœºå™¨å­¦ä¹ ä¸­çš„è¿­ä»£è®¡ç®—ï¼Œé‚£ä¹ˆä½¿ç”¨MapReduceçš„å°±éå¸¸æ…¢äº†ï¼Œå¦‚æœè¿™ä¸ªåº”ç”¨çš„è®¡ç®—åˆ†ä¸º10000ä¸ªè®¡ç®—é˜¶æ®µï¼Œå¦‚æœç”¨MapReduceå®ç°ï¼Œå°±éœ€è¦å¯åŠ¨5000æ¬¡ç›¸å…³çš„åº”ç”¨ï¼Œé€Ÿåº¦å¾ˆæ…¢ï¼Œå¹¶ä¸”ç¼–ç ä¼šå¾ˆéº»çƒ¦ï¼Œå¦‚æœ æ˜¯Sparkï¼Œé‚£ä¹ˆåœ¨ä¸€æ¬¡åº”ç”¨å°±å¯ä»¥è§£å†³è¯¥é—®é¢˜ã€‚<br><br>Sparkçš„å¤šä¸ªè®¡ç®—é˜¶æ®µçš„ç†è§£ï¼š<br>\tç›¸æ¯”äºMapReduceåªæœ‰ä¸¤ä¸ªè®¡ç®—é˜¶æ®µï¼Œ Sparkç†è®ºä¸Šå¯ä»¥æœ‰æ— é™ä¸ªè®¡ç®—é˜¶æ®µï¼Œ è¿™ä¹Ÿæ˜¯Sparkçš„é€Ÿåº¦çš„ä¼˜åŠ¿<br>\tSparkçš„è®¡ç®—é˜¶æ®µçš„è¡¨ç¤ºä¸­ï¼ŒDAGï¼ˆæœ‰å‘æ— ç¯å›¾ï¼‰æ˜¯Sparkçš„å…³é”®ï¼ŒDAGå¯ä»¥å¾ˆå¥½çš„è¡¨ç¤ºæ¯ä¸ªè®¡ç®—é˜¶æ®µçš„å…³ç³»ï¼Œæˆ–è€…è¯´ä¾èµ–ä¹¦åº<br>\té‚£ä¹ˆDAGæ˜¯è°ç”Ÿæˆçš„å‘¢ï¼Œæ˜¯æ ¹æ®ä»€ä¹ˆç”Ÿæˆçš„å‘¢ï¼Ÿ<br>\t\tDAGæ˜¯æœ‰Sparkè®¡ç®—æ¡†æ¶æ ¹æ®ç”¨äºæ‰€å†™çš„ä»£ç ç”Ÿæˆçš„ï¼Œé‚£æ€ä¹ˆä¾æ®ä»£ç çš„ä»€ä¹ˆç”Ÿæˆçš„å‘¢ï¼Ÿ<br>\t\t\tç±»æ¯”MapReduceçš„ä¸¤ä¸ªè®¡ç®—é˜¶æ®µï¼Œä¸¤ä¸ªé˜¶æ®µä¹‹é—´çš„è¿‡åº¦æ˜¯ä»€ä¹ˆï¼Ÿæ˜¯shuffleï¼ŒSparkä¹Ÿæ˜¯æ ¹æ®Sparkä¸­çš„ä»£ç ä¸­çš„è½¬æ¢å‡½æ•°æ˜¯å¦æ˜¯æœ‰shuffleæ“ä½œè¿›è¡Œåˆ’åˆ†é˜¶æ®µçš„ï¼<br>\tæˆ‘çš„ç†è§£ï¼ŒSparkçš„æ¯ä¸ªè®¡ç®—é˜¶æ®µå¯ä»¥ç±»æ¯”MapReduceä¸­çš„Mapé˜¶æ®µæˆ–è€…Reduceé˜¶æ®µã€‚ä¸åŒçš„æ˜¯ï¼ŒSparkè®¡ç®—é˜¶æ®µå…³æ³¨çš„æ˜¯RDDï¼Œä½†æ˜¯åˆæœ‰ç›¸åŒçš„ç‚¹ï¼ŒRDDä¸­çš„æ•°æ®ç»„æˆä¹Ÿæ˜¯ä¸€ç‰‡ä¸€ç‰‡çš„ï¼ŒSparkä¸­çš„æœ€å°çš„ä»»åŠ¡ä¹Ÿå°±æ˜¯å¯¹äºç‰‡çš„è®¡ç®—ï¼ŒåŸç†å’ŒMapReduceä¸€æ ·ï¼ŒSparkä¸­çš„ç‰‡å’ŒMapReduceä¸­çš„ç‰‡æ˜¯é€šä¸€ä¸ªä¸œè¥¿ï¼Œæ¯ä¸ªç‰‡éƒ½æ˜¯åˆ†å¸ƒäºHDFSä¸Šçš„ï¼Œå¯¹äºæ¯ä¸ªç‰‡çš„è®¡ç®—å¤§æ¦‚ç‡ä¹Ÿæ˜¯åœ¨ç‰‡æ‰€åœ¨çš„è®¡ç®—èŠ‚ç‚¹çš„ã€‚æ‰€ä»¥Sparkçš„è®¡ç®—ä¹Ÿæ˜¯åˆ†å¸ƒå¼ï¼Œå¹¶ä¸”åŸç†å’ŒMapReduceæ˜¯ä¸€æ ·çš„ã€‚<br><br>Sparkä¸­RDDä¸Šçš„æ“ä½œå‡½æ•°ï¼šRDDä¸Šçš„æ“ä½œå‡½æ•°åˆ†ä¸ºä¸¤ç§ç±»å‹ï¼Œä¸€ç§æ˜¯è½¬æ¢å‡½æ•°ï¼Œå¦ä¸€ç§æ˜¯actionå‡½æ•°<br>\tè½¬æ¢å‡½æ•°ï¼šSparkç¼–ç¨‹ä¸­å¯¹äºRDDçš„æ“ä½œåŸºæœ¬æ˜¯ç”¨è½¬æ¢å‡½æ•°æ¥å®Œæˆçš„ï¼Œè½¬æ¢å‡½æ•°æ˜¯è®¡ç®—RDDï¼Œè½¬æ¢å‡½æ•°åˆåˆ†ä¸ºä¸¤ç§<br>\t\tåªæ˜¯æ”¹å˜RDDå†…å®¹çš„è½¬æ¢å‡½æ•°ï¼šç±»ä¼¼mapï¼Œfilterå‡½æ•°ï¼ŒRDDæœ¬èº«ç‰©ç†ä¸Šæ²¡æœ‰å˜åŒ–ï¼Œæ‰€æœ‰çš„æ“ä½œéƒ½æ˜¯é’ˆå¯¹äºå½“å‰çš„åˆ†ç‰‡<br>\t\tä¼šæ–°ç”ŸæˆRDDè½¬æ¢å‡½æ•°ï¼šç±»ä¼¼äºreduceByKeyè¿™ç§å‡½æ•°ï¼Œä¼šç»„åˆkeyç”Ÿæˆæ–°çš„RDDï¼ˆæ‰€æœ‰çš„ä¼šç”Ÿæˆæ–°çš„RDDçš„å‡½æ•°éƒ½å¯ä»¥ä½œä¸º è®¡ç®—é˜¶æ®µçš„åˆ†å‰²å‡½æ•°å—ï¼Ÿï¼‰<br>\tactionå‡½æ•°ï¼šacitonå‡½æ•°å¯¹äºRDDçš„æ“ä½œæ²¡æœ‰è¿”å›å€¼ï¼Œæˆ–è€…è¯´ä¸ä¼šæ”¹å˜RDDçš„å†…å®¹ï¼Œæ¯”å¦‚rdd.saveToPathç­‰ç­‰<br><br>Sparkä¸­ä¸€äº›å…³äºåº”ç”¨çš„ç”Ÿå‘½å‘¨æœŸä¸­çš„è¿‡ç¨‹çš„åè¯ã€æ¦‚å¿µï¼š<br>\tSparkä¸­çš„RDDå‡½æ•°ä¸»è¦æœ‰ä¸¤ç§ï¼Œä¸€æ˜¯è½¬æ¢å‡½æ•°ï¼Œè°ƒç”¨è½¬æ¢å‡½æ•°å¯ä»¥è¿”å›ä¸€ä¸ªRDDï¼ˆäº§ç”Ÿæ–°çš„RDDï¼Ÿ&#47;ä¼šshuffleçš„å‡½æ•°åˆ†å‰²è®¡ç®—é˜¶æ®µï¼‰ï¼ŒRDDçš„è®¡ç®—é€»è¾‘ä¸»è¦æ˜¯ç”±è½¬æ¢å‡½æ•°å®Œæˆ<br><br>\tå¦ä¸€ç§æ˜¯actionå‡½æ•°ï¼Œè°ƒç”¨è¿™ç§å‡½æ•°ä¸è¿”å›RDDï¼ŒDAGScheduleråœ¨é‡åˆ°shuffleçš„æ—¶å€™ç”Ÿæˆä¸€ä¸ªæ–°çš„è®¡ç®—é˜¶æ®µï¼Œåœ¨é‡åˆ°actionå‡½æ•°çš„æ—¶å€™ï¼Œäº§ç”Ÿä¸€ä¸ªä½œä¸šã€‚ï¼ˆæˆ‘ç†è§£å¯ä»¥ç±»ä¼¼äºï¼Œä¸€æ¬¡MapReduceç¨‹åºå¯¹åº”Sparkä¸­çš„ä¸€ä¸ªä½œä¸šï¼‰<br>\tåœ¨æ¯ä¸ªè®¡ç®—é˜¶æ®µéƒ½æ˜¯é’ˆå¯¹RDDï¼ˆåŒ…å«å¾ˆå¤šç‰‡ï¼‰çš„è®¡ç®—ï¼Œæ¯ä¸ªåˆ†ç‰‡Sparkéƒ½ä¼šåˆ›å»ºä¸€ä¸ªè®¡ç®—ä»»åŠ¡å»å¤„ç†ï¼Œæ‰€ä»¥æ¯ä¸ªè®¡ç®—é˜¶æ®µä¼šåŒ…å«å¾ˆå¤šä¸ªè®¡ç®—ä»»åŠ¡","like_count":38,"discussions":[{"author":{"id":2836611,"avatar":"https://thirdwx.qlogo.cn/mmopen/vi_32/WN351R6WwfnlILLdnH4xsUTJCG2mYFRuibdNHBJFicTHXGiaR3lxBYGmagJhicibRWFPB7fGYnDrtV9GFQtwDo1d73A/132","nickname":"é»„è°¦æ•","note":"","ucode":"057CB1810E2366","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":537425,"discussion_content":"ä½ å¥½ç§‘ä»£è¡¨ã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1639057720,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":43871,"user_name":"è½å¶é£é€çš„æ‹","can_delete":false,"product_type":"c1","uid":1046429,"ip_address":"","ucode":"F9A95DB28BCF1E","user_header":"https://static001.geekbang.org/account/avatar/00/0f/f7/9d/be04b331.jpg","comment_is_top":false,"comment_ctime":1543315488,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"151867170848","product_id":100020201,"comment_content":"æ€»ç»“ï¼šSparkçš„ä¼˜ç‚¹å°±æ˜¯èƒ½å¤ŸåŠ¨æ€æ ¹æ®è®¡ç®—é€»è¾‘çš„å¤æ‚åº¦è¿›è¡Œä¸æ–­çš„æ‹†åˆ†å­ä»»åŠ¡ï¼Œè€Œå®ç°åœ¨ä¸€ä¸ªåº”ç”¨ä¸­å¤„ç†æ‰€æœ‰çš„é€»è¾‘ï¼Œè€Œä¸åƒMapReduceéœ€è¦å¯åŠ¨å¤šä¸ªåº”ç”¨è¿›è¡Œè®¡ç®—ã€‚","like_count":35},{"had_liked":false,"id":44340,"user_name":"My dream","can_delete":false,"product_type":"c1","uid":1077733,"ip_address":"","ucode":"2FEFB344230C17","user_header":"https://static001.geekbang.org/account/avatar/00/10/71/e5/bcdc382a.jpg","comment_is_top":false,"comment_ctime":1543411543,"is_pvip":false,"discussion_count":7,"race_medal":0,"score":"91737724759","product_id":100020201,"comment_content":"è€å¸ˆï¼Œä½ è®²çš„ç†è®ºçœ‹çš„æˆ‘å¤´æ™•è„‘èƒ€çš„ï¼Œèƒ½ä¸èƒ½è®²ç‚¹å®æˆ˜æ“ä½œï¼Œæ­å»ºsparkç¯å¢ƒï¼Œé€šè¿‡æ¡ˆä¾‹æ¥è®²çš„è¯ï¼Œå¯¹äºæˆ‘ä»¬è¿™äº›åˆå­¦å­¦ç”Ÿæ¥è¯´æ˜¯æœ€ç›´è§‚ï¼Œæœ€å®¹æ˜“å¼„æ˜ç™½å®ƒä¸ºä»€ä¹ˆä¼šé‚£ä¹ˆå¿«ï¼Œåƒä½ è¿™æ ·ä¸€å‘³çš„è®²ç†è®ºï¼Œä¸è®²å®æˆ˜ï¼Œæˆ‘ä»¬å®åœ¨æ˜¯å¸æ”¶ä¸äº†ï¼Œç†è§£ä¸äº†ä½ è®²çš„è¿™äº›çŸ¥è¯†ç‚¹","like_count":21,"discussions":[{"author":{"id":1142315,"avatar":"https://static001.geekbang.org/account/avatar/00/11/6e/2b/301bd439.jpg","nickname":"RXTM","note":"","ucode":"A308B87945E44D","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":8355,"discussion_content":"ä¸Šæ¥è®²å®æˆ˜ï¼Œæ‰æ˜¯ä»€ä¹ˆéƒ½å­¦ä¸ä¼šã€‚å®æˆ˜å¯ä»¥éšæ—¶ç¿»æ–‡æ¡£ï¼ŒåŸç†ä¸ææ¸…æ¥šï¼Œå®æˆ˜å®Œäº†ä¹Ÿä¸çŸ¥é“æ€ä¹ˆå›äº‹ã€‚","likes_number":12,"is_delete":false,"is_hidden":false,"ctime":1567939009,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1544726,"avatar":"https://static001.geekbang.org/account/avatar/00/17/92/16/558ff49c.jpg","nickname":"ctfå°ç™½","note":"","ucode":"C0326909867DE4","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":176013,"discussion_content":"å¯èƒ½æœ‰ç‚¹å®æˆ˜ç»éªŒä¼šæ›´å®¹æ˜“ç†è§£è¿™ç¯‡æ–‡ç« ï¼Œ ç½‘ä¸Šè®²å¦‚ä½•æ­å»ºè¿™äº›çš„æ–‡ç« å…¶å®å¾ˆå¤šï¼Œä½†è¿™æ ·æ¦‚æ‹¬è®²åŸç†çš„çœŸçš„å¾ˆå°‘ï¼ŒæŠŠé‡è¦çŸ¥è¯†ç‚¹ç†å‡ºæ¥çš„ä¸å¤šã€‚æˆ‘è‡ªå·±å·²ç»æœ‰è¿‡å¤§æ•°æ®çš„ç»éªŒï¼Œç°åœ¨å†æ¥çœ‹è§‰å¾—è®²çš„å¾ˆå¥½ï¼Œå¤§å®¶æœ‰æœºä¼šä¸Šæ‰‹å®è·µä»¥åï¼Œå†å›æ¥çœ‹ä¹Ÿè®¸ä¼šæœ‰æ›´å¤šä½“ä¼š","likes_number":2,"is_delete":false,"is_hidden":false,"ctime":1582014650,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":2859880,"avatar":"https://static001.geekbang.org/account/avatar/00/2b/a3/68/e913d823.jpg","nickname":"*å…¶","note":"","ucode":"B1B0A47CEDECC3","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":543341,"discussion_content":"å®æˆ˜+ç†è®ºæ›´é€‚åˆï¼Œå¯ä»¥å…ˆç”¨HDP+ambariæ­å»ºä¸€ä¸ªHadoopé›†ç¾¤ï¼Œåœ¨è¯¾ç¨‹ä¸Šäº†è§£åŸç†ï¼Œå†å…·ä½“å®æˆ˜ï¼Œæ¯•ç«Ÿå®æˆ˜ä¹Ÿç¦»ä¸å¼€ç†è®ºæŒ‡å¯¼ï¼Œä¸ç„¶å°±åªä¼šä½¿ç”¨å·¥å…·äº†","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1641096369,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1077636,"avatar":"https://static001.geekbang.org/account/avatar/00/10/71/84/4b33817f.jpg","nickname":"50åŒ…é‚®è§£å›æ„","note":"","ucode":"BFC08A518F24B3","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":372946,"discussion_content":"å“ˆå“ˆéš”ä¸¤å¤©æœ‰ç©ºå°±ç¿»å›æ¥çœ‹ä¸€éï¼Œè¿™æ ·é—´æ–­åœ°æ¶ˆåŒ–ç€ç†è§£ï¼Œçœ‹ä¸¤ä¸‰éå°±èƒ½ç†è§£çš„æ›´å¥½å•¦","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1620535702,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1339820,"avatar":"https://static001.geekbang.org/account/avatar/00/14/71/ac/8295e3e7.jpg","nickname":"ä¹¦å¿†æ±Ÿå—","note":"","ucode":"90776A7CE06D66","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":257323,"discussion_content":"å¯ä»¥çœ‹çœ‹ã€ŠSparkæƒå¨æŒ‡å—ã€‹ï¼Œè¿™æœ¬ä¹¦å¯¹å…¥é—¨è€…éå¸¸å‹å¥½ï¼š\næœ‰ä»€ä¹ˆå…³äº Spark çš„ä¹¦æ¨èï¼Ÿ - ä¹¦å¿†æ±Ÿå—çš„å›ç­” - çŸ¥ä¹\nhttps://www.zhihu.com/question/23655827/answer/1039397401","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1588558670,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1140643,"avatar":"https://static001.geekbang.org/account/avatar/00/11/67/a3/bdd14fdc.jpg","nickname":"lei Shi","note":"","ucode":"AA28B0567A68C9","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":217150,"discussion_content":"å®æˆ˜çš„èµ„æ–™æ°¸è¿œæ¯”ç†è®ºçš„çŸ¥è¯†å¤š","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1585502772,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1708090,"avatar":"https://static001.geekbang.org/account/avatar/00/1a/10/3a/053852ee.jpg","nickname":"å¼ å°å–µ","note":"","ucode":"2CD5003020D751","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":73928,"discussion_content":"ä¹‹å‰çš„æ¯èŠ‚è¯¾å¬å¾—éƒ½æŒºå¥½ï¼Œä½†æ˜¯è¿™ç« èŠ‚æˆ‘å¬çš„ä¹Ÿæ˜¯äº‘é‡Œé›¾é‡Œï¼Œæˆ‘è§‰å¾—å¥½å¤šçš„ç–‘é—®ç‚¹ï¼Œæ²¡æœ‰ä¸€ä¸ªå®é™…çš„ä¾‹å­ï¼Œä¸åƒä¹‹å‰è®²MapReduceçš„æ—¶å€™ï¼Œç”¨Word countåšä¾‹å­ä¸²æ•´ä¸ªå·¥ä½œæµç¨‹ã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1575611750,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":44002,"user_name":"scorpiozj","can_delete":false,"product_type":"c1","uid":1031677,"ip_address":"","ucode":"C66EA76809F9BF","user_header":"https://static001.geekbang.org/account/avatar/00/0f/bd/fd/3f5d5db5.jpg","comment_is_top":false,"comment_ctime":1543364252,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"91737677468","product_id":100020201,"comment_content":"ç§»åŠ¨è®¡ç®—æ¯”ç§»åŠ¨æ•°æ®åˆ’ç®— æ€»ç»“çš„çœŸå¥½ å¾ˆå¤šè®¾è®¡ä»”ç»†æƒ³ä¸€æƒ³éƒ½æ˜¯å›´ç»•è¿™ä¸ªä¸­å¿ƒ<br><br>å…³äºå¼€æº<br>1 å‡†å¤‡å¥½è¯¦ç»†çš„ä½¿ç”¨ apiæ–‡æ¡£å¹¶æä¾›ç¤ºä¾‹<br>2 æ’°å†™è®¾è®¡æ€è·¯ å’Œç«å“æ¯”è¾ƒçš„ä¼˜åŠ¿ ä»¥åŠåˆ›æ–°ç‚¹<br>3 æå‰è”ç³»è‹¥å¹²å›¢é˜Ÿä½¿ç”¨äº§å“ å¹¶è¯·ä»–ä»¬æä¾›çœŸå®çš„æé«˜æ•ˆç‡çš„æ•°æ®æŠ¥å‘Š<br>4 è”ç³»å…¬å…³å›¢é˜Ÿåœ¨çŸ¥åæŠ€æœ¯è®ºå›æ¨å¹¿<br>5 æˆç«‹å›¢é˜Ÿ åŠæ—¶å“åº”å¼€å‘è€…ç–‘é—® éœ€æ±‚å’Œprç­‰","like_count":21},{"had_liked":false,"id":43879,"user_name":"çº¯æ´çš„æ†æ¶","can_delete":false,"product_type":"c1","uid":1130512,"ip_address":"","ucode":"5E9757DE6F45DF","user_header":"https://static001.geekbang.org/account/avatar/00/11/40/10/b6bf3c3c.jpg","comment_is_top":false,"comment_ctime":1543316811,"is_pvip":true,"replies":[{"id":"15682","content":"å¼•ç”¨æ¥¼ä¸‹çš„è¯„è®ºå›å¤<br><br>è½å¶é£é€çš„æ‹<br>æ€»ç»“ï¼šSparkçš„ä¼˜ç‚¹å°±æ˜¯èƒ½å¤ŸåŠ¨æ€æ ¹æ®è®¡ç®—é€»è¾‘çš„å¤æ‚åº¦è¿›è¡Œä¸æ–­çš„æ‹†åˆ†å­ä»»åŠ¡ï¼Œè€Œå®ç°åœ¨ä¸€ä¸ªåº”ç”¨ä¸­å¤„ç†æ‰€æœ‰çš„é€»è¾‘ï¼Œè€Œä¸åƒMapReduceéœ€è¦å¯åŠ¨å¤šä¸ªåº”ç”¨è¿›è¡Œè®¡ç®—ã€‚","user_name":"ä½œè€…å›å¤","comment_id":43879,"uid":"1007349","ip_address":"","utype":1,"ctime":1543329670,"user_name_real":"ææ™ºæ…§"}],"discussion_count":4,"race_medal":0,"score":"48787957067","product_id":100020201,"comment_content":"è¿™ä¸¤å¤©çš„å†…å®¹å¯¹æˆ‘æ¥è¯´æœ‰äº›å¤æ‚ï¼Œå¾ˆå¤šçŸ¥è¯†ç‚¹æ²¡æœ‰ç†è§£é€ã€‚é’ˆå¯¹â€œè€Œ Spark æ›´ç»†è…»ä¸€ç‚¹ï¼Œå°†å‰ä¸€ä¸ªçš„ Reduce å’Œåä¸€ä¸ªçš„ Map è¿æ¥èµ·æ¥ï¼Œå½“ä½œä¸€ä¸ªé˜¶æ®µæŒç»­è®¡ç®—ï¼Œå½¢æˆä¸€ä¸ªæ›´åŠ ä¼˜é›…ã€é«˜æ•ˆåœ°è®¡ç®—æ¨¡å‹â€ã€‚è¿™å¥è¯ä¸­â€œå°†å‰ä¸€ä¸ªçš„ Reduce å’Œåä¸€ä¸ªçš„ Map è¿æ¥èµ·æ¥â€åœ¨ç»†èŠ‚ä¸Šè¯¥å¦‚ä½•ç†è§£ï¼Œè¿™ä¹Ÿæ˜¯æ˜æ˜¾çš„ä¸²è¡Œè¿‡ç¨‹ï¼Œæ„Ÿè§‰ä¸ä¼šæ¯”ä¼ ç»Ÿçš„MapReduceå¿«ï¼Ÿæ˜¯å› ä¸ºä¸åŒé˜¶æ®µä¹‹é—´æœ‰å¯èƒ½å¹¶è¡Œä¹ˆï¼Ÿ","like_count":11,"discussions":[{"author":{"id":1007349,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/5e/f5/018907ac.jpg","nickname":"ææ™ºæ…§","note":"","ucode":"8C9980C438AFD1","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":430533,"discussion_content":"å¼•ç”¨æ¥¼ä¸‹çš„è¯„è®ºå›å¤\n\nè½å¶é£é€çš„æ‹\næ€»ç»“ï¼šSparkçš„ä¼˜ç‚¹å°±æ˜¯èƒ½å¤ŸåŠ¨æ€æ ¹æ®è®¡ç®—é€»è¾‘çš„å¤æ‚åº¦è¿›è¡Œä¸æ–­çš„æ‹†åˆ†å­ä»»åŠ¡ï¼Œè€Œå®ç°åœ¨ä¸€ä¸ªåº”ç”¨ä¸­å¤„ç†æ‰€æœ‰çš„é€»è¾‘ï¼Œè€Œä¸åƒMapReduceéœ€è¦å¯åŠ¨å¤šä¸ªåº”ç”¨è¿›è¡Œè®¡ç®—ã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1543329670,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":2028938,"avatar":"https://static001.geekbang.org/account/avatar/00/1e/f5/8a/dc9a23a1.jpg","nickname":"ç»­è´¹ä¸“ç”¨","note":"","ucode":"1B585A131B64B4","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":364605,"discussion_content":"è¿˜æ˜¯æ²¡æ˜ç™½+1 æˆ‘ç†è§£sparkæ›´å¿«æ˜¯ç”±äºmapå’Œreduceåœ¨sparkä¸­æ˜¯ä½œä¸ºä¸€ä¸ªæ•´ä½“stageè¿è¡Œçš„ï¼Œæ²¡æœ‰è½ç›˜ï¼Œç›´æ¥å­˜å‚¨åœ¨å†…å­˜ä¸­ï¼›ä½†æ˜¯æ˜¯å¦å¯åŠ¨å¤šä¸ªåº”ç”¨æ˜¯ä»€ä¹ˆæ„æ€å‘¢ï¼Ÿ","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1617533949,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":1,"child_discussions":[{"author":{"id":1763486,"avatar":"http://thirdwx.qlogo.cn/mmopen/vi_32/DYAIOgq83eqwURicicejDP5IlicpyCYxlfzufmGLjvb07WwibTSjdH1V9WfyALhicDxF6l0pq1LgAtroWkxChetsO5Q/132","nickname":"Geek_4c72df","note":"","ucode":"361CE31F4976C3","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":2028938,"avatar":"https://static001.geekbang.org/account/avatar/00/1e/f5/8a/dc9a23a1.jpg","nickname":"ç»­è´¹ä¸“ç”¨","note":"","ucode":"1B585A131B64B4","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":587734,"discussion_content":"æˆ‘ç†è§£è¿™é‡Œæ˜¯è¯´ï¼Œå‡å¦‚ä¸¤ä¸ªmapReduceé˜¶æ®µæ˜¯æœ‰ä¾èµ–å…³ç³»çš„ã€‚mapReduceä¼šä¸²è¡Œæ‰§è¡Œï¼Œèµ·ä¸¤ä¸ªåº”ç”¨ã€‚è€Œåœ¨sparkä¼šè¢«åˆ’åˆ†åˆ°åŒä¸€ä¸ªstageæ‰§è¡Œï¼Œå‰ä¸€ä¸ªç»“æœå‡ºæ¥åä¼šç›´æ¥æ‰§è¡Œä¸‹ä¸€ä¸ªï¼Œä¸­é—´ç»“æœå­˜å‚¨åœ¨å†…å­˜ä¸­ï¼Œè¿™æ ·æ•´ä½“æ•ˆç‡é«˜å¾ˆå¤šã€‚é™¤éå½“å‰æ•°æ®çš„è®¡ç®—è¿‡ç¨‹ç»“æŸï¼Œéœ€è¦å¼•å…¥/joinæ–°æ•°æ®è¿›è¡Œshuffleè€Œå¯åŠ¨æ–°çš„stageï¼Œå¦åˆ™å¯ä»¥ä¸€ç›´è®¡ç®—ï¼Œè€Œä¸ç”¨é‡æ–°å¯åŠ¨åœ¨è¯»å–å¤„ç†ã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1663244902,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":364605,"ip_address":"åŒ—äº¬"},"score":587734,"extra":""}]},{"author":{"id":2062252,"avatar":"","nickname":"å¸¸æŒ¯å","note":"","ucode":"D61B40E1CCEFD5","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":293035,"discussion_content":"è¿˜æ˜¯æ²¡æ˜ç™½","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1595419232,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":47870,"user_name":"ming","can_delete":false,"product_type":"c1","uid":1054341,"ip_address":"","ucode":"63135A86598E64","user_header":"https://static001.geekbang.org/account/avatar/00/10/16/85/e4d53282.jpg","comment_is_top":false,"comment_ctime":1544240908,"is_pvip":false,"replies":[{"id":"17355","content":"æ•°æ®åˆ†å¸ƒåˆ æ‰ï¼Œè°¢è°¢æŒ‡æ­£ã€‚","user_name":"ä½œè€…å›å¤","comment_id":47870,"uid":"1007349","ip_address":"","utype":1,"ctime":1544488868,"user_name_real":"ææ™ºæ…§"}],"discussion_count":1,"race_medal":0,"score":"31609011980","product_id":100020201,"comment_content":"è€å¸ˆï¼Œæœ‰ä¸€å¥è¯æˆ‘ä¸å¤ªç†è§£ï¼Œè¯·è€å¸ˆæŒ‡å¯¼ã€‚â€œDAGScheduler æ ¹æ®ä»£ç å’Œæ•°æ®åˆ†å¸ƒç”Ÿæˆ DAG å›¾â€ã€‚æ ¹æ®ä»£ç ç”Ÿäº§DAGå›¾æˆ‘ç†è§£ï¼Œä½†æ˜¯ä¸ºä»€ä¹ˆç”ŸæˆDAGå›¾è¿˜è¦æ ¹æ®æ•°æ®åˆ†å¸ƒç”Ÿæˆï¼Œæ•°æ®åˆ†å¸ƒä¸åŒï¼Œç”Ÿæˆçš„DAGå›¾ä¹Ÿä¼šä¸åŒå—ï¼Ÿ","like_count":7,"discussions":[{"author":{"id":1007349,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/5e/f5/018907ac.jpg","nickname":"ææ™ºæ…§","note":"","ucode":"8C9980C438AFD1","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":431919,"discussion_content":"æ•°æ®åˆ†å¸ƒåˆ æ‰ï¼Œè°¢è°¢æŒ‡æ­£ã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1544488868,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":43991,"user_name":"å‘¨æ´‹èˆŸ","can_delete":false,"product_type":"c1","uid":1252433,"ip_address":"","ucode":"EA2BC9E38FC35B","user_header":"https://static001.geekbang.org/account/avatar/00/13/1c/51/dc21bb08.jpg","comment_is_top":false,"comment_ctime":1543363007,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"31608134079","product_id":100020201,"comment_content":"æ¯ä¸€ç¯‡æ–‡ç« éƒ½è®¤çœŸçš„è¯»äº†ï¼Œæœ‰äº›ä¸œè¥¿è¿˜æ²¡çœŸæ­£çš„å»åœ¨å®é™…å·¥ä½œä¸­ä½“ä¼šåˆ°ï¼Œä½†è¿™ç§æ€ç»´çš„å¯å‘è¿˜æ˜¯å—ç›ŠåŒªæµ…ã€‚","like_count":7},{"had_liked":false,"id":71628,"user_name":"å¼ é£","can_delete":false,"product_type":"c1","uid":1405598,"ip_address":"","ucode":"836F612B8E9C8A","user_header":"https://static001.geekbang.org/account/avatar/00/15/72/9e/69606254.jpg","comment_is_top":false,"comment_ctime":1551402844,"is_pvip":false,"replies":[{"id":"26258","content":"1 Sparkçš„mapå’Œreduceçš„åˆ’åˆ†è¦æ›´ä¼˜é›…ä¸€ç‚¹ï¼Œæ¯”å¦‚å®½ä¾èµ–å’Œçª„ä¾èµ–ï¼Œç¼–ç¨‹ä¸Šçœ‹ä¸å‡ºæ˜æ˜¾çš„mapå’Œreduceï¼Œè¿™ç§ä¼˜é›…è¿˜æœ‰å¾ˆå¤šï¼Œå¤šå†™ä¸€äº›sparkå’ŒMapReduceç¨‹åºå°±èƒ½æ„Ÿå—åˆ°ã€‚<br><br>2 å¦‚æœå†…å­˜å¤Ÿç”¨ï¼ŒSparkå‡ ä¹æ€»æ˜¯ä½¿ç”¨å†…å­˜ã€‚<br><br>3 å¯ä»¥è¿™ä¹ˆç†è§£ã€‚","user_name":"ä½œè€…å›å¤","comment_id":71628,"uid":"1007349","ip_address":"","utype":1,"ctime":1551662859,"user_name_real":"ææ™ºæ…§"}],"discussion_count":1,"race_medal":0,"score":"27321206620","product_id":100020201,"comment_content":"1.â€œè€Œ Spark æ›´ç»†è…»ä¸€ç‚¹ï¼Œå°†å‰ä¸€ä¸ªçš„ Reduce å’Œåä¸€ä¸ªçš„ Map è¿æ¥èµ·æ¥ï¼Œå½“ä½œä¸€ä¸ªé˜¶æ®µæŒç»­è®¡ç®—ï¼Œå½¢æˆä¸€ä¸ªæ›´åŠ ä¼˜é›…ã€é«˜æ•ˆåœ°è®¡ç®—æ¨¡å‹â€ï¼Œstageä¹‹é—´æ˜¯ä¸²è¡Œçš„ï¼Œå³ä¾¿å‰ä¸€ä¸ªçš„reduceå’Œåä¸€ä¸ªçš„mapè¿æ¥èµ·æ¥ï¼Œä¹Ÿæ˜¯è¦ä»å‰ä¸€ä¸ªstageçš„è®¡ç®—èŠ‚ç‚¹çš„ç£ç›˜ä¸Šæ‹‰å–æ•°æ®çš„ï¼Œè¿™è·Ÿmapreduceçš„è®¡ç®—æ˜¯ä¸€æ ·çš„ï¼Œè€å¸ˆæ‰€è¯´çš„é«˜æ•ˆåœ¨è¿™é‡Œæ˜¯æ€ä¹ˆæç°çš„å‘¢ï¼Ÿ<br>2. sparkçš„å†…å­˜è®¡ç®—ä¸»è¦ä½“ç°åœ¨shuffleè¿‡ç¨‹ï¼Œä¸‹ä¸€ä¸ªstageæ‹‰å–ä¸Šä¸€ä¸ªstageçš„æ•°æ®çš„æ—¶å€™æ›´å¤šçš„ä½¿ç”¨å†…å­˜ï¼Œåœ¨è¿™é‡ŒåŒºåˆ†å‡ºä¸mapreduceè®¡ç®—çš„ä¸åŒï¼Œåˆ«çš„è¿˜æœ‰ä»€ä¹ˆé˜¶æ®µæ¯”mapreduceæ›´ä¾èµ–å†…å­˜çš„å—ï¼Ÿ <br>3.æˆ‘æ˜¯ä¸æ˜¯å¯ä»¥è¿™æ ·ç†è§£ï¼Œå¦‚æœåªæœ‰mapé˜¶æ®µçš„è¯ï¼Œå³ä¾¿è®¡ç®—é‡å¾ˆå¤§ï¼Œmapreduceä¸sparkçš„è®¡ç®—é€Ÿåº¦ä¸Šä¹Ÿæ²¡æœ‰å¤ªå¤§çš„åŒºåˆ«ï¼Ÿ<br>å¯èƒ½é—®é¢˜é—®çš„ä¸å¤Ÿæ¸…æ™°ï¼Œå¸Œæœ›è€å¸ˆè§£ç­”ä¸€ä¸‹ã€‚","like_count":6,"discussions":[{"author":{"id":1007349,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/5e/f5/018907ac.jpg","nickname":"ææ™ºæ…§","note":"","ucode":"8C9980C438AFD1","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":441241,"discussion_content":"1 Sparkçš„mapå’Œreduceçš„åˆ’åˆ†è¦æ›´ä¼˜é›…ä¸€ç‚¹ï¼Œæ¯”å¦‚å®½ä¾èµ–å’Œçª„ä¾èµ–ï¼Œç¼–ç¨‹ä¸Šçœ‹ä¸å‡ºæ˜æ˜¾çš„mapå’Œreduceï¼Œè¿™ç§ä¼˜é›…è¿˜æœ‰å¾ˆå¤šï¼Œå¤šå†™ä¸€äº›sparkå’ŒMapReduceç¨‹åºå°±èƒ½æ„Ÿå—åˆ°ã€‚\n\n2 å¦‚æœå†…å­˜å¤Ÿç”¨ï¼ŒSparkå‡ ä¹æ€»æ˜¯ä½¿ç”¨å†…å­˜ã€‚\n\n3 å¯ä»¥è¿™ä¹ˆç†è§£ã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1551662859,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":73489,"user_name":"æµ·","can_delete":false,"product_type":"c1","uid":1349556,"ip_address":"","ucode":"49BD7F2F4603F0","user_header":"https://static001.geekbang.org/account/avatar/00/14/97/b4/2ec7a386.jpg","comment_is_top":false,"comment_ctime":1551916996,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"23026753476","product_id":100020201,"comment_content":"å¯¹äºhbaseå’Œé«˜é€Ÿå‘å±•çš„esï¼Œä¸çŸ¥é“æ‚¨æ€ä¹ˆçœ‹ï¼Œä»–ä»¬çš„ä¼˜ç¼ºç‚¹æ˜¯ä»€ä¹ˆï¼Ÿ","like_count":5},{"had_liked":false,"id":43886,"user_name":"è¿½æ¢¦å°ä¹","can_delete":false,"product_type":"c1","uid":1035507,"ip_address":"","ucode":"82AB8A7F98389D","user_header":"https://static001.geekbang.org/account/avatar/00/0f/cc/f3/5e4b0315.jpg","comment_is_top":false,"comment_ctime":1543318034,"is_pvip":false,"replies":[{"id":"15683","content":"æ¯ä¸ªä»»åŠ¡ä¸€ä¸ªè¿›ç¨‹<br><br>å¾ˆå¤šçº¢è‰²çº¿æ¡ï¼Œæ¯æ¡çº¿ä»£è¡¨ä¸€ä¸ªä»»åŠ¡<br><br>cacheç†è§£æˆå­˜å‚¨rddçš„å†…å­˜","user_name":"ä½œè€…å›å¤","comment_id":43886,"uid":"1007349","ip_address":"","utype":1,"ctime":1543329787,"user_name_real":"ææ™ºæ…§"}],"discussion_count":2,"race_medal":0,"score":"23018154514","product_id":100020201,"comment_content":"è€å¸ˆï¼Œæˆ‘æƒ³è¯·æ•™å‡ ä¸ªé—®é¢˜ï¼š<br>1ã€â€œæ ¹æ®æ¯ä¸ªé˜¶æ®µè¦å¤„ç†çš„æ•°æ®é‡ç”Ÿæˆç›¸åº”çš„ä»»åŠ¡é›†åˆï¼ˆTaskSetï¼‰ï¼Œæ¯ä¸ªä»»åŠ¡éƒ½åˆ†é…ä¸€ä¸ªä»»åŠ¡è¿›ç¨‹å»å¤„ç†â€ï¼Œæ˜¯ä¸€ä¸ªä»»åŠ¡é›†åˆTaskSetå¯åŠ¨ä¸€ä¸ªè¿›ç¨‹ï¼ŒtaskSeté‡Œé¢çš„ä»»åŠ¡æ˜¯ç”¨çº¿ç¨‹è®¡ç®—å—ï¼Ÿè¿˜æ˜¯æ¯ä¸ªTaskSeté‡Œé¢çš„ä»»åŠ¡å¯åŠ¨ä¸€ä¸ªè¿›ç¨‹ï¼Ÿ<br><br>2ã€task-time å›¾ä¸­çº¢è‰²å¯†é›†çš„è¡¨ç¤ºä»€ä¹ˆï¼Ÿ<br><br>3ã€Spark çš„æ‰§è¡Œè¿‡ç¨‹ çš„å›¾ä¸­ Executor ä¸­çš„ Cache æ˜¯è¡¨ç¤ºå†…å­˜å—ï¼Ÿtaskå’ŒExecutorä¸æ˜¯åœ¨å†…å­˜ä¸­çš„å—ï¼Ÿ","like_count":5,"discussions":[{"author":{"id":1007349,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/5e/f5/018907ac.jpg","nickname":"ææ™ºæ…§","note":"","ucode":"8C9980C438AFD1","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":430537,"discussion_content":"æ¯ä¸ªä»»åŠ¡ä¸€ä¸ªè¿›ç¨‹\n\nå¾ˆå¤šçº¢è‰²çº¿æ¡ï¼Œæ¯æ¡çº¿ä»£è¡¨ä¸€ä¸ªä»»åŠ¡\n\ncacheç†è§£æˆå­˜å‚¨rddçš„å†…å­˜","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1543329787,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1327497,"avatar":"https://static001.geekbang.org/account/avatar/00/14/41/89/77d3e613.jpg","nickname":"bookchan","note":"","ucode":"6C40EEAC767E25","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":255152,"discussion_content":"å›¾é‡Œé¢æ²¡æœ‰æ˜¾ç¤ºstageæ˜¯å¹¶è¡Œæ‰§è¡Œçš„ï¼ŒçœŸå®æƒ…å†µæ˜¯ä¸æ˜¯å¯ä»¥å¹¶è¡Œæ‰§è¡Œï¼Ÿ","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1588382180,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":72687,"user_name":"è½å¶é£é€çš„æ‹","can_delete":false,"product_type":"c1","uid":1046429,"ip_address":"","ucode":"F9A95DB28BCF1E","user_header":"https://static001.geekbang.org/account/avatar/00/0f/f7/9d/be04b331.jpg","comment_is_top":false,"comment_ctime":1551694496,"is_pvip":false,"discussion_count":1,"race_medal":0,"score":"18731563680","product_id":100020201,"comment_content":"ç°åœ¨å›è¿‡å¤´çœ‹ï¼ŒSparkçš„ç¼–ç¨‹æ¨¡å‹å…¶å®ç±»ä¼¼Java8çš„Steamç¼–ç¨‹æ¨¡å‹","like_count":4,"discussions":[{"author":{"id":1121459,"avatar":"https://static001.geekbang.org/account/avatar/00/11/1c/b3/6d10ba4f.jpg","nickname":"Running Man","note":"","ucode":"4DD2F6AF71327E","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":52099,"discussion_content":"å‡½æ•°å¼ç¼–ç¨‹","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1573995143,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":45037,"user_name":"ç™½é¸½","can_delete":false,"product_type":"c1","uid":1182064,"ip_address":"","ucode":"BDA54B54F653B4","user_header":"https://static001.geekbang.org/account/avatar/00/12/09/70/6b6382ca.jpg","comment_is_top":false,"comment_ctime":1543541069,"is_pvip":false,"replies":[{"id":"16227","content":"æ•´ä¸ªjar","user_name":"ä½œè€…å›å¤","comment_id":45037,"uid":"1007349","ip_address":"","utype":1,"ctime":1543676373,"user_name_real":"ææ™ºæ…§"}],"discussion_count":1,"race_medal":0,"score":"18723410253","product_id":100020201,"comment_content":"Executor ä» Diver ä¸‹è½½æ‰§è¡Œä»£ç ï¼Œæ˜¯æ•´ä¸ªç¨‹åº jaråŒ…?è¿˜æ˜¯ä»… Executor è®¡ç®—ä»»åŠ¡å¯¹åº”çš„ä¸€æ®µè®¡ç®—ç¨‹åºï¼ˆç»SparkSessionåˆå§‹åŒ–åçš„ï¼‰?","like_count":4,"discussions":[{"author":{"id":1007349,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/5e/f5/018907ac.jpg","nickname":"ææ™ºæ…§","note":"","ucode":"8C9980C438AFD1","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":430905,"discussion_content":"æ•´ä¸ªjar","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1543676373,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":43667,"user_name":"å¤šè¥„ä¸¸","can_delete":false,"product_type":"c1","uid":1074310,"ip_address":"","ucode":"1AA1497C5A293C","user_header":"https://static001.geekbang.org/account/avatar/00/10/64/86/f5a9403a.jpg","comment_is_top":false,"comment_ctime":1543279317,"is_pvip":false,"replies":[{"id":"15647","content":"æœ‰äº›é—®é¢˜ä¸ä¸€å®šè¦å¾—åˆ°ç­”æ¡ˆæˆ–è€…å›ç­”å‡ºæ¥ï¼Œåªæ˜¯å…³æ³¨åˆ°äº†æ€è€ƒä¸€ä¸‹ï¼Œå°±ä¼šæœ‰æ”¶è·ï½","user_name":"ä½œè€…å›å¤","comment_id":43667,"uid":"1007349","ip_address":"","utype":1,"ctime":1543304645,"user_name_real":"ææ™ºæ…§"}],"discussion_count":1,"race_medal":0,"score":"18723148501","product_id":100020201,"comment_content":"å•Šã€è€å¸ˆç°åœ¨çš„æé—®éƒ½å¥½å¤§ï¼Œæˆ‘ç°åœ¨æ˜¯è€è™åƒå¤©æ— ä»ä¸‹çˆªå•Š ^_^","like_count":4,"discussions":[{"author":{"id":1007349,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/5e/f5/018907ac.jpg","nickname":"ææ™ºæ…§","note":"","ucode":"8C9980C438AFD1","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":430454,"discussion_content":"æœ‰äº›é—®é¢˜ä¸ä¸€å®šè¦å¾—åˆ°ç­”æ¡ˆæˆ–è€…å›ç­”å‡ºæ¥ï¼Œåªæ˜¯å…³æ³¨åˆ°äº†æ€è€ƒä¸€ä¸‹ï¼Œå°±ä¼šæœ‰æ”¶è·ï½","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1543304645,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":119241,"user_name":"weiruan85","can_delete":false,"product_type":"c1","uid":1069949,"ip_address":"","ucode":"8CFD7B198759E3","user_header":"https://thirdwx.qlogo.cn/mmopen/vi_32/Ng7NIuMhg8E3U6DjwJlTKFcEYsTtFJkiag22G13JXSiaobpibfI6MicKg93VNqQnG7Rkvl2OfCsAaSksCAVbNDp8zw/132","comment_is_top":false,"comment_ctime":1564542316,"is_pvip":false,"replies":[{"id":"43887","content":"èµ","user_name":"ä½œè€…å›å¤","comment_id":119241,"uid":"1007349","ip_address":"","utype":1,"ctime":1564645675,"user_name_real":"ææ™ºæ…§"}],"discussion_count":1,"race_medal":0,"score":"14449444204","product_id":100020201,"comment_content":"1.å®Œå¤‡çš„æŠ€æœ¯è¯´æ˜æ–‡æ¡£æ˜¯å¿…é¡»çš„ï¼Œæ¯”å¦‚ä½¿ç”¨åœºæ™¯ï¼Œå¸¸è§é—®é¢˜ï¼Œç¯å¢ƒæ­å»ºï¼Œæ ¸å¿ƒæŠ€æœ¯çš„åŸç†ç­‰ã€‚<br>2.è¾“å‡ºçœŸå®ç­‰ä½¿ç”¨æ¡ˆä¾‹ï¼Œä»¥åŠç»™è§£å†³å®é™…é—®é¢˜å¸¦æ¥ç­‰å¥½å¤„ï¼Œæ¯”å¦‚å¦‚æœæ²¡æœ‰æˆ‘ä»¬çš„å¼€æºæ–¹æ¡ˆæ˜¯æ€ä¹ˆå®ç°çš„ï¼Œæœ‰äº†è¿™ä¸ªæ–¹æ¡ˆæ˜¯æ€ä¹ˆå®ç°çš„ï¼Œå·®å¼‚æ˜¯ä»€ä¹ˆ<br>3.å•†ä¸šæ¨å¹¿ï¼Œæ‰¾ä¸šç•Œæœ‰åçš„å…¬å¸ç«™å°ï¼Œæˆ–è€…æœ‰åçš„æŠ€æœ¯å¤§ç‰›åšå®£ä¼ ï¼ˆå¤´ç¾Šæ•ˆåº”ï¼‰<br>4.å½’æ ¹ç»“åº•ï¼Œè¿˜æ˜¯å¾—æœ‰å¼€åˆ›æ€§çš„æŠ€æœ¯ï¼Œèƒ½è§£å†³ç°å®ä¸­çš„æŸä¸€ç±»é—®é¢˜ã€‚","like_count":3,"discussions":[{"author":{"id":1007349,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/5e/f5/018907ac.jpg","nickname":"ææ™ºæ…§","note":"","ucode":"8C9980C438AFD1","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":460802,"discussion_content":"èµ","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1564645675,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":59934,"user_name":"Yezhiwei","can_delete":false,"product_type":"c1","uid":1005157,"ip_address":"","ucode":"31E8E33688CBEC","user_header":"https://static001.geekbang.org/account/avatar/00/0f/56/65/22a37a8e.jpg","comment_is_top":false,"comment_ctime":1547431924,"is_pvip":false,"replies":[{"id":"21593","content":"ğŸ‘ğŸ‘ğŸ‘","user_name":"ä½œè€…å›å¤","comment_id":59934,"uid":"1007349","ip_address":"","utype":1,"ctime":1547523597,"user_name_real":"ææ™ºæ…§"}],"discussion_count":1,"race_medal":0,"score":"14432333812","product_id":100020201,"comment_content":"è¿™é‡Œæ˜¯å­¦ä¹ è¿‡ç¨‹ä¸­åšçš„ä¸€äº›æ€»ç»“<br><br>https:&#47;&#47;mp.weixin.qq.com&#47;s&#47;OyPRXAu9hR1KWIbvc20y1g","like_count":3,"discussions":[{"author":{"id":1007349,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/5e/f5/018907ac.jpg","nickname":"ææ™ºæ…§","note":"","ucode":"8C9980C438AFD1","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":436418,"discussion_content":"ğŸ‘ğŸ‘ğŸ‘","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1547523597,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":119233,"user_name":"weiruan85","can_delete":false,"product_type":"c1","uid":1069949,"ip_address":"","ucode":"8CFD7B198759E3","user_header":"https://thirdwx.qlogo.cn/mmopen/vi_32/Ng7NIuMhg8E3U6DjwJlTKFcEYsTtFJkiag22G13JXSiaobpibfI6MicKg93VNqQnG7Rkvl2OfCsAaSksCAVbNDp8zw/132","comment_is_top":false,"comment_ctime":1564540429,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"10154475021","product_id":100020201,"comment_content":"  å®¢æˆ·ï¼šæˆ‘æƒ³ç»™æ•°æ®åº“ä¸­çš„ä¸€å¼ å…³é”®è¡¨æ·»åŠ å‡ ä¸ªç´¢å¼•ï¼Œå¯¹ç”Ÿäº§æœ‰æ²¡æœ‰å½±å“<br>  feyï¼šä¸ºä»€ä¹ˆè¦åŠ ç´¢å¼•å‘¢ï¼Œæ˜¯å¼ ä»€ä¹ˆè¡¨<br>  å®¢æˆ·ï¼šç³»ç»Ÿä¸­çš„æµæ°´è¡¨ï¼ŒæŸ¥è¯¢æ¯”è¾ƒæ…¢<br>  feyï¼šæ•°æ®é‡å¤§æ¦‚å¤šå¤§<br>  å®¢æˆ·ï¼šæœ‰5000ä¸‡<br>  feyï¼šå­˜å‚¨äº†å¤šä¹…çš„æ•°æ®å‘¢<br>  å®¢æˆ·ï¼šå­˜äº†å°†è¿‘2å¹´çš„æ•°æ®äº†<br>  feyï¼šæŒ‰ç…§ä¸šåŠ¡åº”è¯¥ä¿å­˜å¤šä¹…çš„æ•°æ®å‘¢<br>  å®¢æˆ·ï¼š3ä¸ªæœˆ<br>  feyï¼šé‚£æˆ‘ä»¬æ˜¯ä¸æ˜¯åº”è¯¥å…ˆæŠŠå†å²æ•°æ®è¿›è¡Œå½’æ¡£ï¼Œç„¶ååœ¨æ·»åŠ ç´¢å¼•å‘¢ã€‚<br>  å®¢æˆ·ï¼šå¯¹ï¼Œå¯ä»¥å…ˆåšæ•°æ®çš„å½’æ¡£ã€‚<br>  ","like_count":2},{"had_liked":false,"id":90637,"user_name":"å†°à¾‚é•‡à¾‚å¯à¾‚ä¹à¾‚","can_delete":false,"product_type":"c1","uid":1455996,"ip_address":"","ucode":"A19F24BA1178FB","user_header":"https://static001.geekbang.org/account/avatar/00/16/37/7c/b6bc6024.jpg","comment_is_top":false,"comment_ctime":1556593360,"is_pvip":false,"replies":[{"id":"32706","content":"å¯ä»¥è¿™æ ·ç†è§£ã€‚<br><br>MRæ¨¡å‹æœ¬èº«ä¸åŒ…å«DAGï¼Œéœ€è¦å¤–éƒ¨å·¥å…·åŸºäºMRæ„å»ºDAGå®ç°å¤æ‚çš„è®¡ç®—ï¼Œæ¯”å¦‚Hiveã€‚<br>Sparkçš„è®¡ç®—æ¨¡å‹æœ¬èº«å°±æ˜¯åŒ…å«DAGã€‚","user_name":"ä½œè€…å›å¤","comment_id":90637,"uid":"1007349","ip_address":"","utype":1,"ctime":1557020405,"user_name_real":"ææ™ºæ…§"}],"discussion_count":1,"race_medal":0,"score":"10146527952","product_id":100020201,"comment_content":"ä¹‹å‰è®²mræ—¶å€™ä¹Ÿæœ‰æåˆ°ç”Ÿæˆdagï¼Œsparkè¿™é‡Œä¹Ÿæ˜¯dagï¼ŒäºŒè€…çš„å·®å¼‚æ˜¯mrä¸­ï¼Œmap reduceä¸ºä¸€ç»„æ“ä½œ(å¯èƒ½æ²¡æœ‰reduce)çš„ä¸€ä¸ªjob jobä¹‹é—´æ˜¯ä¾èµ–å…³ç³»ï¼Œè€Œsparkå¹¶éç®€å•ä¾ç…§m råˆ’åˆ†è€Œæ˜¯é’ˆå¯¹æ•°æ®çš„å¤„ç†æƒ…å†µï¼Œå¦‚æœrååˆ°ä¸‹ä¸€ä¸ªmæ˜¯çª„ä¾èµ–ï¼Œåˆ™å±äºåŒä¸€ä¸ªstageï¼Œå±äºä¸€ä¸ªæµç¨‹ï¼Œè¿™æ ·ç†è§£å¯¹å—ï¼Ÿ","like_count":2,"discussions":[{"author":{"id":1007349,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/5e/f5/018907ac.jpg","nickname":"ææ™ºæ…§","note":"","ucode":"8C9980C438AFD1","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":448604,"discussion_content":"å¯ä»¥è¿™æ ·ç†è§£ã€‚\n\nMRæ¨¡å‹æœ¬èº«ä¸åŒ…å«DAGï¼Œéœ€è¦å¤–éƒ¨å·¥å…·åŸºäºMRæ„å»ºDAGå®ç°å¤æ‚çš„è®¡ç®—ï¼Œæ¯”å¦‚Hiveã€‚\nSparkçš„è®¡ç®—æ¨¡å‹æœ¬èº«å°±æ˜¯åŒ…å«DAGã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1557020405,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":57874,"user_name":"å°¼ç³¯ç±³","can_delete":false,"product_type":"c1","uid":1282819,"ip_address":"","ucode":"04D1B63F3801AE","user_header":"","comment_is_top":false,"comment_ctime":1546933565,"is_pvip":false,"replies":[{"id":"20871","content":"âˆš","user_name":"ä½œè€…å›å¤","comment_id":57874,"uid":"1007349","ip_address":"","utype":1,"ctime":1546939107,"user_name_real":"ææ™ºæ…§"}],"discussion_count":1,"race_medal":0,"score":"10136868157","product_id":100020201,"comment_content":"1ã€DAGScheduleræ ¹æ®åº”ç”¨æ„é€ æ‰§è¡Œçš„DAGï¼šæ˜¯ä¸æ˜¯ä¸€ä¸ªåº”ç”¨ä¾¿æ„é€ ä¸€ä¸ªDAG<br>2ã€DAGåˆ’åˆ†å‡ºè®¡ç®—é˜¶æ®µ<br>3ã€æ¯ä¸ªè®¡ç®—é˜¶æ®µï¼Œæ ¹æ®è¦å¤„ç†çš„æ•°æ®é‡ï¼Œä¸ºæ¯ä¸ªæ•°æ®åˆ†ç‰‡ç”Ÿæˆä¸€ä¸ªå¯¹åº”çš„ä»»åŠ¡ï¼Œè¿™äº›ä»»åŠ¡ç»„æˆä¸€ä¸ªä»»åŠ¡é›†åˆ<br>4ã€æ¯ä¸ªä»»åŠ¡åˆ†é…ä¸€ä¸ªè¿›ç¨‹<br>5ã€åˆ†å¸ƒå¼è®¡ç®—ï¼šæŸä¸ªè®¡ç®—é˜¶æ®µï¼Œå…¶æŸä¸ªä»»åŠ¡çš„è¿›ç¨‹åœ¨é›†ç¾¤æŸå¤„æ‰§è¡Œè®¡ç®—<br>6ã€æ‰§è¡Œactionå‡½æ•°ä¾¿ç”Ÿæˆä½œä¸šï¼šä¾æ®DAGè®¡ç®—ï¼Œæ˜¯ä¸æ˜¯ä¾¿å¯ä»¥ç”Ÿæˆå¤šä¸ªä½œä¸š<br><br>æˆ‘è¿™ä¹ˆç†è§£å¯ä»¥å—ï¼Ÿ","like_count":2,"discussions":[{"author":{"id":1007349,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/5e/f5/018907ac.jpg","nickname":"ææ™ºæ…§","note":"","ucode":"8C9980C438AFD1","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":435803,"discussion_content":"âˆš","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1546939107,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":49827,"user_name":"Richard","can_delete":false,"product_type":"c1","uid":1316758,"ip_address":"","ucode":"893F958B9DD161","user_header":"https://static001.geekbang.org/account/avatar/00/14/17/96/846fc11b.jpg","comment_is_top":false,"comment_ctime":1544776619,"is_pvip":false,"replies":[{"id":"18000","content":"SQLçš„æ‰§è¡Œè®¡åˆ’å’Œsparkçš„dagï¼Œéƒ½æ˜¯æ‰§è¡Œæè¿°ï¼Œå¯ä»¥ç”¨æ–‡æœ¬æŸ¥çœ‹çš„ï¼Œä¸åŒ…æ‹¬æ‰§è¡Œä»£ç ã€‚<br><br>workerä¸‹è½½åº”ç”¨ç¨‹åºçš„jaråŒ…ï¼Œåå°„åŠ è½½æ‰§è¡Œã€‚ç¬¬ä¸‰æ¨¡å—sparkæºç ä¼˜åŒ–æœ‰è¯¦ç»†æè¿°ã€‚","user_name":"ä½œè€…å›å¤","comment_id":49827,"uid":"1007349","ip_address":"","utype":1,"ctime":1544843570,"user_name_real":"ææ™ºæ…§"}],"discussion_count":1,"race_medal":0,"score":"10134711211","product_id":100020201,"comment_content":"â€œDAGScheduler æ ¹æ®ç¨‹åºä»£ç ç”Ÿæˆ DAGï¼Œç„¶åå°†ç¨‹åºåˆ†å‘åˆ°åˆ†å¸ƒå¼è®¡ç®—é›†ç¾¤ï¼ŒæŒ‰è®¡ç®—é˜¶æ®µçš„å…ˆåå…³ç³»è°ƒåº¦æ‰§è¡Œã€‚Worker æ”¶åˆ°ä»»åŠ¡åï¼Œå¯åŠ¨ Executor è¿›ç¨‹å¼€å§‹æ‰§è¡Œä»»åŠ¡ã€‚Executor å…ˆæ£€æŸ¥è‡ªå·±æ˜¯å¦æœ‰ Driver çš„æ‰§è¡Œä»£ç ï¼Œå¦‚æœæ²¡æœ‰ï¼Œä» Driver ä¸‹è½½æ‰§è¡Œä»£ç ï¼Œé€šè¿‡ Java åå°„åŠ è½½åå¼€å§‹æ‰§è¡Œã€‚â€ é’ˆå¯¹è¿™ä¸€æ®µè¯ï¼Œæˆ‘æƒ³å¤šè¯·æ•™è€å¸ˆä¸€äº›ï¼Œæˆ‘ç†è§£çš„DAGScheduler æ ¹æ®ç¨‹åºä»£ç ç”Ÿæˆ DAGï¼Œç±»ä¼¼äºå…³ç³»å‹æ•°æ®åº“ä¼˜åŒ–å™¨æ ¹æ®SQLç”Ÿæˆæ‰§è¡Œè®¡åˆ’ï¼Œç„¶åsparkè®¡ç®—å¼•æ“æ ¹æ®è¿™äº›è®¡åˆ’å»åšè®¡ç®—ï¼Œæˆ‘çš„ç–‘æƒ‘çš„æ˜¯ï¼šDAGå·²ç»æ˜¯æ ¹æ®ä»£ç ç”Ÿæˆçš„äº†ï¼Œé‚£Worker è¿˜è¦ä» Driver ä¸‹è½½æ‰§è¡Œä»£ç å»æ‰§è¡Œï¼Œæˆ‘æ— æ³•æƒ³è±¡workeræ˜¯å¦‚ä½•æ‰§è¡Œä»£ç çš„ï¼Œèƒ½å¦å¸®å¿™è§£ç–‘ä¸€ä¸‹ï¼Ÿ","like_count":2,"discussions":[{"author":{"id":1007349,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/5e/f5/018907ac.jpg","nickname":"ææ™ºæ…§","note":"","ucode":"8C9980C438AFD1","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":432784,"discussion_content":"SQLçš„æ‰§è¡Œè®¡åˆ’å’Œsparkçš„dagï¼Œéƒ½æ˜¯æ‰§è¡Œæè¿°ï¼Œå¯ä»¥ç”¨æ–‡æœ¬æŸ¥çœ‹çš„ï¼Œä¸åŒ…æ‹¬æ‰§è¡Œä»£ç ã€‚\n\nworkerä¸‹è½½åº”ç”¨ç¨‹åºçš„jaråŒ…ï¼Œåå°„åŠ è½½æ‰§è¡Œã€‚ç¬¬ä¸‰æ¨¡å—sparkæºç ä¼˜åŒ–æœ‰è¯¦ç»†æè¿°ã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1544843570,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":44117,"user_name":"felix","can_delete":false,"product_type":"c1","uid":1086157,"ip_address":"","ucode":"DF514D0BB9B508","user_header":"https://static001.geekbang.org/account/avatar/00/10/92/cd/d39e568c.jpg","comment_is_top":false,"comment_ctime":1543370071,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"10133304663","product_id":100020201,"comment_content":"è€å¸ˆæœ‰äº†è§£è¿‡å¾®è½¯sql server analysis serviceçš„tabularå—ï¼Œå†…å­˜å‹åˆ—å¼å­˜å‚¨çš„æ•°æ®åº“ï¼Œæ•°æ®å‹ç¼©æ¯”å¾ˆé«˜ã€‚å¦‚æœå…‰åšæ•°æ®åº“æŸ¥è¯¢çš„è¯ï¼Œæ¯”sparkè¿˜å¿«å¾ˆå¤šï¼Œå› ä¸ºsparkè¿˜è¦æŠŠæ•°æ®loadè¿›å†…å­˜ã€‚æˆ‘ä»¬è‡ªå·±å†™äº†ä¸€ä¸ªæœåŠ¡æ¥åˆ†å¸ƒèšåˆï¼Œè¿˜ç”¨redisä»¥ç»´åº¦ä¸ºkeyåšç¼“å­˜ã€‚","like_count":2},{"had_liked":false,"id":43982,"user_name":"Jack Zhu","can_delete":false,"product_type":"c1","uid":1266238,"ip_address":"","ucode":"8425B570880F28","user_header":"https://static001.geekbang.org/account/avatar/00/13/52/3e/a0614b62.jpg","comment_is_top":false,"comment_ctime":1543361247,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"10133295839","product_id":100020201,"comment_content":"1.ç¡®å®šåšå¼€æºçš„å•†ä¸šæ¨¡å¼ï¼Œæ˜¯ç¾Šæ¯›å‡ºåœ¨çŒªèº«ä¸Šï¼Œè¿˜æ˜¯é€å°ç¾Šæ¨å¤§ç¾Šç­‰ç­‰<br>2.ç¡®å®šç»„ç»‡æŠ•å…¥äººå‘˜<br>3.å»ºç«‹ç¤¾åŒºï¼Œå®šæœŸtogetherè®¨è®ºï¼Œä¸ºè¿­ä»£ç‰ˆæœ¬åšè®¡åˆ’<br>4.åšä¸€äº›å¿…è¦å•†ä¸šæ¨å¹¿å’Œå…è´¹å®¢æˆ·æœåŠ¡","like_count":2},{"had_liked":false,"id":43696,"user_name":"Riordon","can_delete":false,"product_type":"c1","uid":1127497,"ip_address":"","ucode":"E2F6855B5FE5F9","user_header":"https://static001.geekbang.org/account/avatar/00/11/34/49/6b27feb1.jpg","comment_is_top":false,"comment_ctime":1543281858,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"10133216450","product_id":100020201,"comment_content":"ä¸ºä½•Sparkå¯ä»¥æ›´é«˜æ•ˆï¼Ÿ<br>1ï¼‰MRä½¿ç”¨å¤šè¿›ç¨‹æ¨¡å‹ï¼ŒSparkä½¿ç”¨å¤šçº¿ç¨‹æ¨¡å‹ï¼Œè¿™æ ·Sparkæ„å»ºä¸€ä¸ªå¯é‡ç”¨çš„èµ„æºæ± ï¼Œè€ŒMRå¾€å¾€ä¸ä¼šï¼ŒMRä¼šè€—è´¹æ›´å¤šçš„æ„å»ºèµ„æºæ± çš„å¯åŠ¨æ—¶é—´ï¼ŒSparkåœ¨è¿›ç¨‹å†…çº¿ç¨‹ä¼šç«äº‰èµ„æºï¼Œå¯¼è‡´Sparkç›¸æ¯”MRä¸ç¨³å®šï¼›<br>2ï¼‰å¯¹äºå¤šæ¬¡è¯»å–çš„ä¸­é—´ç»“æœå¯ä»¥Cacheï¼Œé¿å…å¤šæ¬¡è¯»ç›˜ï¼Œå¯¹äºè¿­ä»£è®¡ç®—å‹å¥½ï¼›<br>å¦å¤–shuffleè¿‡ç¨‹ï¼Œè²Œä¼¼ä¸ç®¡æ˜¯MRè¿˜æ˜¯Sparkéƒ½æ˜¯éœ€è¦å†™ç›˜çš„å§<br>","like_count":2},{"had_liked":false,"id":138558,"user_name":"æ˜Ÿä¸€","can_delete":false,"product_type":"c1","uid":1103829,"ip_address":"","ucode":"EF550131FAE1BF","user_header":"https://static001.geekbang.org/account/avatar/00/10/d7/d5/6fbf1070.jpg","comment_is_top":false,"comment_ctime":1570335236,"is_pvip":false,"replies":[{"id":"53684","content":"æ˜¯çš„ï¼Œæ¯”å¦‚å¤æ‚çš„SQLï¼Œå°±ä¼šç”Ÿæˆå¤šä¸ªjobï¼Œä¹Ÿå°±æ˜¯å¤šä¸ªmap reduceè¿‡ç¨‹ã€‚","user_name":"ä½œè€…å›å¤","user_name_real":"ææ™ºæ…§","uid":"1007349","ctime":1570602715,"ip_address":"","comment_id":138558,"utype":1}],"discussion_count":1,"race_medal":0,"score":"5865302532","product_id":100020201,"comment_content":"è€å¸ˆæ‚¨å¥½ï¼Œè¯·é—®ä¸€ä¸‹ï¼Œå¯¹äºå¤æ‚çš„å¤šé˜¶æ®µè®¡ç®—ï¼ŒHadoop MapReduceæ˜¯éœ€è¦è¿›è¡Œå¤šæ¬¡map reduce è¿‡ç¨‹å—ï¼Œè€Œä¸”æ¯æ¬¡mapå’Œreduceä¹‹é—´ä¸€å®šä¼šè¿›è¡Œshuffleï¼ˆä¸»è¦ä½¿ç”¨ç£ç›˜è¿›è¡Œå­˜å‚¨ï¼‰ï¼Œæ‰€ä»¥ç›¸æ¯”Sparkæ‰æ›´åŠ ä½æ•ˆï¼Œä¸çŸ¥é“æˆ‘ç†è§£çš„æ­£ç¡®å˜›ï¼Œè¯·æŒ‡æ•™","like_count":2,"discussions":[{"author":{"id":1007349,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/5e/f5/018907ac.jpg","nickname":"ææ™ºæ…§","note":"","ucode":"8C9980C438AFD1","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":469570,"discussion_content":"æ˜¯çš„ï¼Œæ¯”å¦‚å¤æ‚çš„SQLï¼Œå°±ä¼šç”Ÿæˆå¤šä¸ªjobï¼Œä¹Ÿå°±æ˜¯å¤šä¸ªmap reduceè¿‡ç¨‹ã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1570602715,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":109390,"user_name":"ç¾Šå°çœ‹","can_delete":false,"product_type":"c1","uid":1488453,"ip_address":"","ucode":"90F58F80A75520","user_header":"https://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTJYEdMwBDUC6gYrUoI7092ocWJPyw1aP8xNOFXxOv7LEw1xj5a4icDibV7pd9vN45lXicXYjB7oYXVqg/132","comment_is_top":false,"comment_ctime":1562029301,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"5856996597","product_id":100020201,"comment_content":"sparkçš„æœ‰å‘æ— ç¯å›¾ï¼Œå°†ä¸€ä¸ªé˜¶æ®µçš„è¾“å‡ºï¼Œç›´æ¥ç»™åˆ°å¦ä¸€ä¸ªé˜¶æ®µçš„è¾“å…¥ï¼Œä¸éœ€è¦å†æ¬¡å¯åŠ¨åº”ç”¨ï¼Œé¿å…å¤šæ¬¡è®¿é—®HDFSï¼Œé¿å…å¤šæ¬¡è°ƒåº¦ï¼Œå°¤å…¶æ˜¯æœºå™¨å­¦ä¹ ï¼Œä¸Šä¸‡æ¬¡è¿­ä»£çš„åœºæ™¯ï¼Œä¸”ä¼˜å…ˆä½¿ç”¨å†…å­˜å­˜å‚¨ä¸­é—´ç»“æœã€‚","like_count":1},{"had_liked":false,"id":69284,"user_name":"forever","can_delete":false,"product_type":"c1","uid":1142325,"ip_address":"","ucode":"AAA930B496D5A0","user_header":"https://static001.geekbang.org/account/avatar/00/11/6e/35/11008e02.jpg","comment_is_top":false,"comment_ctime":1550711839,"is_pvip":false,"replies":[{"id":"24788","content":"åœ¨å†…å­˜è®¡ç®—ã€‚<br><br>shuffleè‚¯å®šè¦ç§»åŠ¨æ•°æ®çš„ã€‚","user_name":"ä½œè€…å›å¤","user_name_real":"ææ™ºæ…§","uid":"1007349","ctime":1550813208,"ip_address":"","comment_id":69284,"utype":1}],"discussion_count":2,"race_medal":0,"score":"5845679135","product_id":100020201,"comment_content":"è€å¸ˆsparkæ˜¯å†…å­˜è®¡ç®—ï¼Œæ˜¯æŠŠæ•°æ®éƒ½æ‹¿åˆ°å†…å­˜ç®—å—ï¼Œshuffleçš„æ—¶å€™ï¼Œå¦‚æœä¸¤ä¸ªçˆ¶rddä¸åœ¨åŒä¸€ä¸ªworkèŠ‚ç‚¹ï¼Œæ˜¯ä¸æ˜¯éœ€è¦æŠŠä¸åŒèŠ‚ç‚¹çš„æ•°æ®ç§»åŠ¨åˆ°å…¶ä¸­ä¸€ä¸ªèŠ‚ç‚¹å†…å­˜é‡Œï¼Œåšèšåˆã€‚è¿™æ˜¯ä¸æ˜¯ä¹Ÿæ˜¯ç§»åŠ¨æ•°æ®","like_count":1,"discussions":[{"author":{"id":1007349,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/5e/f5/018907ac.jpg","nickname":"ææ™ºæ…§","note":"","ucode":"8C9980C438AFD1","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":440041,"discussion_content":"åœ¨å†…å­˜è®¡ç®—ã€‚\n\nshuffleè‚¯å®šè¦ç§»åŠ¨æ•°æ®çš„ã€‚","likes_number":1,"is_delete":false,"is_hidden":false,"ctime":1550813208,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1020557,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/92/8d/0c820dfe.jpg","nickname":"é©¬è¸é£æœº747","note":"","ucode":"BE94F887A7D077","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":24757,"discussion_content":"å€Ÿæ¥¼è¡¥å……æé—®ï¼šå¦‚æœè®¡ç®—è¿‡ç¨‹ä¸­å†…å­˜èµ„æºä¸å¤Ÿç”¨äº†ï¼Œæ˜¯ä¼šåˆ©ç”¨ç£ç›˜è¿›è¡Œä¸­é—´è¿‡ç¨‹çš„æ•°æ®å­˜å‚¨å’Œè¯»å†™å—ï¼Ÿè¿™ä¸ªè¿‡ç¨‹åˆæ˜¯æ€æ ·çš„å¤„ç†æœºåˆ¶å‘¢ï¼Ÿ","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1570254894,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":67298,"user_name":"chenssy","can_delete":false,"product_type":"c1","uid":1074196,"ip_address":"","ucode":"CB5AF27229E2D1","user_header":"https://static001.geekbang.org/account/avatar/00/10/64/14/c980c239.jpg","comment_is_top":false,"comment_ctime":1550126553,"is_pvip":false,"replies":[{"id":"23911","content":"ä½œä¸ºåº”ç”¨å¯ä»¥è·³è¿‡MapReduceï¼Œä½†æ˜¯ä½œä¸ºå­¦ä¹ ï¼Œæœ€å¥½ä¸è¦è·³è¿‡ã€‚MapReduceæ›´ç®€å•ï¼Œæ›´ç›´æ¥è¡¨è¾¾äº†å¤§æ•°æ®è®¡ç®—çš„æ ¸å¿ƒæ€æƒ³ã€‚","user_name":"ä½œè€…å›å¤","user_name_real":"ææ™ºæ…§","uid":"1007349","ctime":1550201189,"ip_address":"","comment_id":67298,"utype":1}],"discussion_count":1,"race_medal":0,"score":"5845093849","product_id":100020201,"comment_content":"è€å¸ˆä½ å¥½ï¼Œæ˜¯å¦å¯ä»¥è¿‡æ»¤æ‰MapReduceï¼Œç›´æ¥å­¦ä¹  spark","like_count":1,"discussions":[{"author":{"id":1007349,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/5e/f5/018907ac.jpg","nickname":"ææ™ºæ…§","note":"","ucode":"8C9980C438AFD1","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":439136,"discussion_content":"ä½œä¸ºåº”ç”¨å¯ä»¥è·³è¿‡MapReduceï¼Œä½†æ˜¯ä½œä¸ºå­¦ä¹ ï¼Œæœ€å¥½ä¸è¦è·³è¿‡ã€‚MapReduceæ›´ç®€å•ï¼Œæ›´ç›´æ¥è¡¨è¾¾äº†å¤§æ•°æ®è®¡ç®—çš„æ ¸å¿ƒæ€æƒ³ã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1550201189,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":49887,"user_name":"æ—éª¥","can_delete":false,"product_type":"c1","uid":1005101,"ip_address":"","ucode":"2E9BFD8E5DF1DB","user_header":"https://static001.geekbang.org/account/avatar/00/0f/56/2d/e6b9dd0f.jpg","comment_is_top":false,"comment_ctime":1544785113,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"5839752409","product_id":100020201,"comment_content":"å¸Œæœ›èƒ½è®²è®²å®é™…æ€ä¹ˆæ“ä½œã€‚","like_count":1},{"had_liked":false,"id":48013,"user_name":"è¶³è¿¹","can_delete":false,"product_type":"c1","uid":1105779,"ip_address":"","ucode":"38134D1A6B8DC2","user_header":"https://static001.geekbang.org/account/avatar/00/10/df/73/4a4ce2b5.jpg","comment_is_top":false,"comment_ctime":1544321684,"is_pvip":false,"replies":[{"id":"17343","content":"å®è·µä¸­ï¼Œsparkç”¨ä¸€èˆ¬yarnå¯åŠ¨åˆ†å‘ï¼Œä¸éœ€è¦è‡ªå·±å®‰è£…","user_name":"ä½œè€…å›å¤","user_name_real":"ææ™ºæ…§","uid":"1007349","ctime":1544488251,"ip_address":"","comment_id":48013,"utype":1}],"discussion_count":1,"race_medal":0,"score":"5839288980","product_id":100020201,"comment_content":"è€å¸ˆï¼Œæ ¹æ®å¤§æ•°æ®æŠ€æœ¯ï¼Œç¨‹åºç§»åŠ¨ï¼Œæ•°æ®ä¸åŠ¨çš„åŸç†ã€‚æ˜¯ä¸æ˜¯åº”è¯¥åœ¨æ¯ä¸ªDataNodeèŠ‚ç‚¹ä¸Šé¢å®‰è£…Sparkå‘¢ï¼Ÿ","like_count":1,"discussions":[{"author":{"id":1007349,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/5e/f5/018907ac.jpg","nickname":"ææ™ºæ…§","note":"","ucode":"8C9980C438AFD1","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":431988,"discussion_content":"å®è·µä¸­ï¼Œsparkç”¨ä¸€èˆ¬yarnå¯åŠ¨åˆ†å‘ï¼Œä¸éœ€è¦è‡ªå·±å®‰è£…","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1544488251,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":43649,"user_name":"sunlight001","can_delete":false,"product_type":"c1","uid":1126975,"ip_address":"","ucode":"A72C4274D5DE8A","user_header":"https://static001.geekbang.org/account/avatar/00/11/32/3f/fa4ac035.jpg","comment_is_top":false,"comment_ctime":1543276117,"is_pvip":false,"replies":[{"id":"15648","content":"è°¢è°¢æ”¯æŒï½","user_name":"ä½œè€…å›å¤","user_name_real":"ææ™ºæ…§","uid":"1007349","ctime":1543304754,"ip_address":"","comment_id":43649,"utype":1}],"discussion_count":1,"race_medal":0,"score":"5838243413","product_id":100020201,"comment_content":"è€å¸ˆï¼Œå¤šå‡ºå‡ æœ¬ä¹¦å§ï¼Œæˆ‘ä¿è¯å…¨ä¹°â˜ºï¼Œè¿™ä¸ªä¸“æ çœŸå€¼ï¼","like_count":2,"discussions":[{"author":{"id":1007349,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/5e/f5/018907ac.jpg","nickname":"ææ™ºæ…§","note":"","ucode":"8C9980C438AFD1","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":430445,"discussion_content":"è°¢è°¢æ”¯æŒï½","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1543304754,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":355588,"user_name":"å”æ–¹åˆš","can_delete":false,"product_type":"c1","uid":3046392,"ip_address":"å¹¿ä¸œ","ucode":"93DA58C3DCCF1B","user_header":"https://thirdwx.qlogo.cn/mmopen/vi_32/ugib9sF9icd9dhibQoAA025hibbD5zgZTiaddLoeEH457hrkBBhtQK6qknTWt270rHCtBZqeqsbibtHghgjdkPx3DyIw/132","comment_is_top":false,"comment_ctime":1661514745,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1661514745","product_id":100020201,"comment_content":"ä¸çŸ¥é“ç†è§£çš„å¯¹ä¸å¯¹ï¼Œsparkæ¯”mrå¿«çš„åŸå› æœ‰ä¸¤ç‚¹ï¼š<br>ä¸€æ˜¯å¤šä¸ªstageåœ¨ä¸€ä¸ªjobä¸­ï¼Œmréœ€è¦æ‹†åˆ†æˆå¤šä¸ªjobã€‚æœ‰ä¸ªç–‘é—®â“å¦‚æœå¤§å®¶éƒ½æ˜¯å•jobï¼Œsparkå’Œmrçš„é€Ÿåº¦æ˜¯ä¸æ˜¯å°±å·®ä¸å¤šäº†ï¼Ÿ<br>äºŒæ˜¯sparkçš„ä¸­é—´ç»“æœä¸éœ€è¦è½ç›˜ï¼Œè¿™ä¸ªä¸­é—´ç»“æœæ˜¯æŒ‡çš„shufleå—ï¼Ÿä½†æ˜¯æˆ‘åœ¨æå®¢æ—¶é—´çš„å¦ä¸€ä¸ªè€å¸ˆçš„sparkæ•™ç¨‹é‡Œé¢çœ‹åˆ°è¯´sparkçš„shuffleç»“æœä¹Ÿæ˜¯è¦è½ç›˜çš„ï¼Œè€Œä¸”ä¹Ÿåˆ†ä¸ºæ•°æ®æ–‡ä»¶å’Œç´¢å¼•æ–‡ä»¶ã€‚ä¸çŸ¥é“å“ªä¸ªæ˜¯å¯¹çš„ï¼Ÿè¿˜æ˜¯è¯´sparkä¼˜å…ˆä½¿ç”¨å†…å­˜ï¼Œå†…å­˜ä¸å¤Ÿäº†æ‰è½ç›˜ã€‚<br>å¸Œæœ›è€å¸ˆèƒ½è§£æƒ‘ï¼Œè¿™ä¸ªé—®é¢˜å›°æ‰°å¾ˆä¹…äº†ï¼Œè€Œä¸”ä¸€èˆ¬å¤§å®¶åªè¯´sparkæ˜¯å†…å­˜è®¡ç®—æ‰€ä»¥å¿«ï¼Œè¿™ä¸ªå›ç­”å¤ªç®€å•äº†ï¼Œè¿˜æ˜¯æ²¡æ³•è§£å†³å¿ƒä¸­çš„ç–‘é—®","like_count":0},{"had_liked":false,"id":340961,"user_name":"æå‹‡","can_delete":false,"product_type":"c1","uid":1303796,"ip_address":"","ucode":"7BC9DE501890D4","user_header":"https://static001.geekbang.org/account/avatar/00/13/e4/f4/96fa9deb.jpg","comment_is_top":false,"comment_ctime":1649247149,"is_pvip":true,"replies":[{"id":"124668","content":"åŸæ–‡ï¼šå› ä¸º RDD B åœ¨å‰é¢ä¸€ä¸ªé˜¶æ®µï¼Œé˜¶æ®µ 1 çš„ shuffle è¿‡ç¨‹ä¸­ï¼Œå·²ç»è¿›è¡Œäº†æ•°æ®åˆ†åŒºã€‚åˆ†åŒºæ•°ç›®å’Œåˆ†åŒº Key ä¸å˜ï¼Œå°±ä¸éœ€è¦å†è¿›è¡Œ shuffleã€‚","user_name":"ä½œè€…å›å¤","user_name_real":"ç¼–è¾‘","uid":"1007349","ctime":1649296061,"ip_address":"","comment_id":340961,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1649247149","product_id":100020201,"comment_content":"è€å¸ˆï¼Œæœ‰ä¸ªé—®é¢˜æƒ³å’¨è¯¢ä¸€ä¸‹ï¼Œåœ¨rddBå’ŒRDDF joinçš„è¿‡ç¨‹ä¸­ï¼ŒRDDBæ˜¯çª„ä¾èµ–ï¼ŒRDDFæ˜¯å®½ä¾èµ–ã€‚ä¹Ÿå°±æ˜¯è¯´RDDBç›´æ¥å¹³ç§»åˆ°ä¸‹ä¸€ä¸ªRDDä¸­ï¼Œè€ŒRDDFä¼šå¯¹RDDBå­˜åœ¨çš„åˆ†ç‰‡åšæ•°æ®äº¤å‰ã€‚è¿™é‡Œæˆ‘æœ‰ä¸ªé—®é¢˜ï¼Œä¸ºä»€ä¹ˆæ˜¯RDDFåšæ•°æ®å¹³ç§»è€Œä¸æ˜¯RDDBå‘¢ï¼Ÿæœ‰ä»€ä¹ˆè§„åˆ™å¯éµå¾ªçš„ä¹ˆï¼Ÿ","like_count":0,"discussions":[{"author":{"id":1007349,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/5e/f5/018907ac.jpg","nickname":"ææ™ºæ…§","note":"","ucode":"8C9980C438AFD1","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":560353,"discussion_content":"åŸæ–‡ï¼šå› ä¸º RDD B åœ¨å‰é¢ä¸€ä¸ªé˜¶æ®µï¼Œé˜¶æ®µ 1 çš„ shuffle è¿‡ç¨‹ä¸­ï¼Œå·²ç»è¿›è¡Œäº†æ•°æ®åˆ†åŒºã€‚åˆ†åŒºæ•°ç›®å’Œåˆ†åŒº Key ä¸å˜ï¼Œå°±ä¸éœ€è¦å†è¿›è¡Œ shuffleã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1649296061,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":330475,"user_name":"piboye","can_delete":false,"product_type":"c1","uid":1066752,"ip_address":"","ucode":"7CFD8712857A85","user_header":"https://static001.geekbang.org/account/avatar/00/10/47/00/3202bdf0.jpg","comment_is_top":false,"comment_ctime":1641990294,"is_pvip":true,"replies":[{"id":"120576","content":"å¯¹","user_name":"ä½œè€…å›å¤","user_name_real":"ç¼–è¾‘","uid":"1007349","ctime":1642071590,"ip_address":"","comment_id":330475,"utype":1}],"discussion_count":2,"race_medal":0,"score":"1641990294","product_id":100020201,"comment_content":"æ„Ÿè§‰Spark è¿™ä¸ªDriver è·Ÿä¹‹å‰çš„ä¸œè¥¿éƒ½ä¸ä¸€æ ·äº†ï¼Œ è¿™ä¸ªDriver æ˜¯åœ¨Cluster ä¹‹å¤–çš„æ„Ÿè§‰ï¼Œ Cluster Mannger æ˜¯ èµ„æºçš„ æä¾›è€…ã€‚ Job çš„ç®¡ç†å’Œæ‰§è¡Œå®Œå…¨æ˜¯åœ¨é›†ç¾¤å¤–çš„Driver è‡ªå·±å¤„ç†ï¼Œä¸çŸ¥é“è¿™é‡Œç†è§£å¯¹ä¸ï¼Ÿ","like_count":0,"discussions":[{"author":{"id":1007349,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/5e/f5/018907ac.jpg","nickname":"ææ™ºæ…§","note":"","ucode":"8C9980C438AFD1","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":545887,"discussion_content":"å¯¹","likes_number":1,"is_delete":false,"is_hidden":false,"ctime":1642071590,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":1,"child_discussions":[{"author":{"id":1066752,"avatar":"https://static001.geekbang.org/account/avatar/00/10/47/00/3202bdf0.jpg","nickname":"piboye","note":"","ucode":"7CFD8712857A85","race_medal":0,"user_type":1,"is_pvip":true},"reply_author":{"id":1007349,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/5e/f5/018907ac.jpg","nickname":"ææ™ºæ…§","note":"","ucode":"8C9980C438AFD1","race_medal":0,"user_type":2,"is_pvip":false},"discussion":{"id":546125,"discussion_content":"è°¢è°¢è€å¸ˆ","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1642172064,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":545887,"ip_address":""},"score":546125,"extra":""}]}]},{"had_liked":false,"id":330470,"user_name":"piboye","can_delete":false,"product_type":"c1","uid":1066752,"ip_address":"","ucode":"7CFD8712857A85","user_header":"https://static001.geekbang.org/account/avatar/00/10/47/00/3202bdf0.jpg","comment_is_top":false,"comment_ctime":1641989221,"is_pvip":true,"replies":[{"id":"120575","content":"driveråœ¨sparké›†ç¾¤ä¹‹å¤–ï¼Œä¸å—sparké›†ç¾¤ç®¡ç†","user_name":"ä½œè€…å›å¤","user_name_real":"ç¼–è¾‘","uid":"1007349","ctime":1642071494,"ip_address":"","comment_id":330470,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1641989221","product_id":100020201,"comment_content":"è€å¸ˆdriverä¹Ÿæ˜¯è¿è¡Œåœ¨sparké›†ç¾¤ä¸­å—ï¼Ÿè¿˜æ˜¯åªæ˜¯å®¢æˆ·ç«¯çš„æœºå™¨ä¸Šï¼Ÿ","like_count":0,"discussions":[{"author":{"id":1007349,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/5e/f5/018907ac.jpg","nickname":"ææ™ºæ…§","note":"","ucode":"8C9980C438AFD1","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":545886,"discussion_content":"driveråœ¨sparké›†ç¾¤ä¹‹å¤–ï¼Œä¸å—sparké›†ç¾¤ç®¡ç†","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1642071495,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":312101,"user_name":"é’±é¹ Allen","can_delete":false,"product_type":"c1","uid":2518863,"ip_address":"","ucode":"7E95E82C0717DA","user_header":"https://static001.geekbang.org/account/avatar/00/26/6f/4f/3cf1e9c4.jpg","comment_is_top":false,"comment_ctime":1631625281,"is_pvip":true,"discussion_count":0,"race_medal":0,"score":"1631625281","product_id":100020201,"comment_content":"Sparkçš„é«˜æ•ˆä½“ç°åœ¨å‡å°‘ç›´æ¥å¯¹HDFSçš„è®¿é—®å’Œå°†ä½¿ç”¨å†…å­˜å­˜å‚¨ã€‚<br>Sparkä¸¤ç±»å‡½æ•°ï¼Œè½¬æ¢å‡½æ•°ä»ä¸€ä¸ªRDDå¦å¤–ä¸€ä¸ªï¼Œactionå‡½æ•°ä¸è¿”å›RDDï¼Œç”Ÿæˆjob.","like_count":0},{"had_liked":false,"id":307665,"user_name":"è®¸çµ","can_delete":false,"product_type":"c1","uid":1059926,"ip_address":"","ucode":"0296EC9929B570","user_header":"https://static001.geekbang.org/account/avatar/00/10/2c/56/ff7a9730.jpg","comment_is_top":false,"comment_ctime":1629193954,"is_pvip":true,"replies":[{"id":"111467","content":"k8sç›¸å½“äºyarnï¼Œåªæ˜¯åšèµ„æºç®¡ç†ï¼Œæ•°æ®è®¿é—®è¿˜æ˜¯sparkè‡ªå·±æ§åˆ¶çš„ã€‚","user_name":"ä½œè€…å›å¤","user_name_real":"ææ™ºæ…§","uid":"1007349","ctime":1629268325,"ip_address":"","comment_id":307665,"utype":1}],"discussion_count":2,"race_medal":0,"score":"1629193954","product_id":100020201,"comment_content":"è€å¸ˆï¼Œè¿™é‡Œæœ‰ä¸€ä¸ªç–‘é—®: å¦‚æœsparkç”¨k8séƒ¨ç½²ï¼Œsparkæ˜¯æ€ä¹ˆä¸hdfsåä½œçš„å‘¢ï¼Ÿå¦‚ä½•åšåˆ°ç§»åŠ¨è®¡ç®—è€Œä¸æ˜¯ç§»åŠ¨æ•°æ®ï¼Œhadoopä¹Ÿè¦ç”¨k8séƒ¨ç½²å—ï¼Ÿ","like_count":0,"discussions":[{"author":{"id":1007349,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/5e/f5/018907ac.jpg","nickname":"ææ™ºæ…§","note":"","ucode":"8C9980C438AFD1","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":525233,"discussion_content":"k8sç›¸å½“äºyarnï¼Œåªæ˜¯åšèµ„æºç®¡ç†ï¼Œæ•°æ®è®¿é—®è¿˜æ˜¯sparkè‡ªå·±æ§åˆ¶çš„ã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1629268325,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1059926,"avatar":"https://static001.geekbang.org/account/avatar/00/10/2c/56/ff7a9730.jpg","nickname":"è®¸çµ","note":"","ucode":"0296EC9929B570","race_medal":0,"user_type":1,"is_pvip":true},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":390816,"discussion_content":"è€å¸ˆè¡¥å……é—®ä¸€ä¸‹ï¼šè¿™æ ·æ˜¯ä¸æ˜¯æŒ‡ï¼Œåªè¦k8sçš„spark worknodeä¸hadoopçš„datanodeéƒ¨ç½²åœ¨åŒä¸€ä¸ªèŠ‚ç‚¹ä¸Šå°±å¯ä»¥äº†ï¼Ÿ","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1630056576,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":258214,"user_name":"è‰¾åˆ©ç‰¹-G","can_delete":false,"product_type":"c1","uid":1195204,"ip_address":"","ucode":"8C4DA0ABE77CDC","user_header":"https://static001.geekbang.org/account/avatar/00/12/3c/c4/4ee2968a.jpg","comment_is_top":false,"comment_ctime":1604326952,"is_pvip":false,"replies":[{"id":"94245","content":"ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½","user_name":"ä½œè€…å›å¤","user_name_real":"ææ™ºæ…§","uid":"1007349","ctime":1604629925,"ip_address":"","comment_id":258214,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1604326952","product_id":100020201,"comment_content":"æˆ‘å…¥èŒäº†Clouderaï¼Œè™½ç„¶è‚¡ç¥¨è®©äººæ„Ÿè§‰æ²®ä¸§ï¼Œæˆ‘è§‰å¾—äº§å“å’ŒæŠ€æœ¯è¿˜æ˜¯æŒºå¥½çš„ã€‚<br>å…³äºå¼€æºäº§å“å¦‚ä½•æå‡å½±å“åŠ›ï¼Œæˆ‘è§‰å¾—è¦å’Œå…¬æœ‰äº‘æå¥½å…³ç³»ä»¥åŠå½“å‰æœ€ç«çš„è¡Œä¸šå¼€æºè½¯ä»¶åˆä½œã€‚å½“ç„¶ï¼Œè¿™ä¹Ÿæ˜¯ç°åœ¨çœ‹åˆ°k8sè¿™ä¹ˆç«ä¹‹åçš„é©¬åç‚®å•¦ï½","like_count":0,"discussions":[{"author":{"id":1007349,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/5e/f5/018907ac.jpg","nickname":"ææ™ºæ…§","note":"","ucode":"8C9980C438AFD1","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":508582,"discussion_content":"ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1604629925,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":245240,"user_name":"æŠ±å°æ˜Ÿ","can_delete":false,"product_type":"c1","uid":1504652,"ip_address":"","ucode":"BA7B0DAFDA4AF5","user_header":"https://static001.geekbang.org/account/avatar/00/16/f5/8c/82fb5890.jpg","comment_is_top":false,"comment_ctime":1598873733,"is_pvip":true,"discussion_count":0,"race_medal":0,"score":"1598873733","product_id":100020201,"comment_content":"è¿™ç¯‡æˆ‘ä¹Ÿçœ‹äº†å¾ˆä¹…ï¼Œç»“åˆSparkæµç¨‹è¾¹è¿è¡Œè¾¹çœ‹çš„ï¼Œåé¢çœ‹æ‡‚ä¸€ç‚¹äº†ï¼Œè®²çš„å¾ˆå¥½ï¼Œå°±æ˜¯RDDæµç¨‹é‚£å—è¿˜è¦å†è®²æ¸…æ¥šä¸€ç‚¹å°±å¥½äº†ã€‚<br><br>ä¸Šä¸€èŠ‚å’Œè¿™ä¸€èŠ‚è¯´ï¼šä»£ç ä¸­çš„RDDæ²¡æœ‰ç»è¿‡shuffleï¼Œç‰©ç†ä¸Šå°±ä¸ä¼šç”Ÿæˆæ–°çš„RDD<br><br>é‚£ä¹ˆå½“RDDè½¬æ¢æ—¶ï¼Œæ•°æ®é‡ä¸ä¸€æ ·çš„æ—¶å€™ï¼Œæ˜¯å¦ä¼šç”Ÿæˆæ–°çš„RDDï¼Ÿ<br>æˆ‘ä¸å¤ªæ˜ç™½<br>æ¯”å¦‚RDD Då’ŒEç”ŸæˆFï¼Œæ²¡æœ‰ç»è¿‡shuffleï¼Œæ˜¯å¦ç‰©ç†ä¸Šä¼šç”Ÿæˆæ–°çš„RDDï¼Ÿ<br>","like_count":0},{"had_liked":false,"id":200037,"user_name":"è‰è£¡èŒ","can_delete":false,"product_type":"c1","uid":1241514,"ip_address":"","ucode":"E11C630ABA4370","user_header":"https://static001.geekbang.org/account/avatar/00/12/f1/aa/c29def94.jpg","comment_is_top":false,"comment_ctime":1585535610,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1585535610","product_id":100020201,"comment_content":"å¼€æºè‡ªå·±çš„è½¯ä»¶ï¼Œç”¨äºæå‡è‡ªå·±å…¬å¸çš„æŠ€æœ¯ç«äº‰åŠ›å’Œå½±å“åŠ›ï¼Œå¦‚æœæ˜¯ä½ è´Ÿè´£äººï¼Œä½ åº”è¯¥å¦‚ä½•è¿ä½œï¼Ÿ<br><br>1.æ˜ç¡®æˆ‘ä»¬å¼€æºè½¯ä»¶ä¸å¸‚é¢ä¸Šä¸»æµçš„çš„æ ¸å¿ƒä¼˜åŠ¿ã€‚<br>2.å¦‚æœè‡ªå·±æ˜¯å¤§å‚ï¼Œåˆ™å¯ä»¥ç”¨è‡ªå·±çš„å“ç‰ŒèƒŒä¹¦ã€‚<br>3.ä¸»åŠ¨æä¾›æŠ€æœ¯æ”¯æŒï¼Œæ‰¾åˆä½œä¼™ä¼´å…¬å¸äº§å“çº¿ï¼Œä»¥æ›´é«˜çš„æŠ€æœ¯æŒ‡æ ‡ã€æ›´é•¿çš„æŠ€æœ¯æ”¯æŒæœŸç­‰ä¸ºæ¡ä»¶ï¼Œä½¿ç”¨å¼€æºè½¯ä»¶æä¾›æœåŠ¡å®ç°ã€‚æˆåŠŸåå¯ä½œä¸ºå®£ä¼ èƒŒä¹¦ã€‚<br>4.å»ºç«‹å®˜æ–¹ç¤¾åŒºæŠ€æœ¯æ”¯æŒï¼ŒGithubä»“åº“ç»´æŠ¤å›¢é˜Ÿã€‚<br>5.å®šæœŸå¼€å±•æŠ€æœ¯è®ºå›ã€‚<br><br>ççŒœçš„â†‘","like_count":0},{"had_liked":false,"id":196101,"user_name":"Geek_b8928e","can_delete":false,"product_type":"c1","uid":1926597,"ip_address":"","ucode":"96E4ABE3F2F145","user_header":"","comment_is_top":false,"comment_ctime":1585235630,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1585235630","product_id":100020201,"comment_content":"Spark æœ‰ä¸‰ä¸ªä¸»è¦ç‰¹æ€§ï¼šRDD çš„ç¼–ç¨‹æ¨¡å‹æ›´ç®€å•ï¼ŒDAG åˆ‡åˆ†çš„å¤šé˜¶æ®µè®¡ç®—è¿‡ç¨‹æ›´å¿«é€Ÿï¼Œä½¿ç”¨å†…å­˜å­˜å‚¨ä¸­é—´è®¡ç®—ç»“æœæ›´é«˜æ•ˆ","like_count":0},{"had_liked":false,"id":143259,"user_name":"åŠç“¶é†‹","can_delete":false,"product_type":"c1","uid":1282746,"ip_address":"","ucode":"8C898E244D0417","user_header":"https://static001.geekbang.org/account/avatar/00/13/92/ba/9833f06f.jpg","comment_is_top":false,"comment_ctime":1571657825,"is_pvip":true,"discussion_count":0,"race_medal":0,"score":"1571657825","product_id":100020201,"comment_content":"æˆ‘å‘ç°æœ‰äº›ç‚¹ä¹‹å‰çœ‹çš„æ—¶å€™å¹¶ä¸æ¸…æ¥šï¼Œåšäº†å‡ ä¸ªDemoåæ‰çœŸæ­£çš„ç†è§£äº†è€å¸ˆçš„æ„æ€ã€‚ä¹‹å‰è€å¸ˆè®²çš„5-20-2å¾ˆå—ç›Šï¼","like_count":0},{"had_liked":false,"id":142692,"user_name":"æå‡¯","can_delete":false,"product_type":"c1","uid":1304705,"ip_address":"","ucode":"FA57F4645D0639","user_header":"https://static001.geekbang.org/account/avatar/00/13/e8/81/6692218b.jpg","comment_is_top":false,"comment_ctime":1571460432,"is_pvip":false,"replies":[{"id":"55269","content":"æ¯ä¸ªä»»åŠ¡ä¸€ä¸ªè¿›ç¨‹ï¼Œä½†æ˜¯è¿™ä¸ªè¿›ç¨‹æ˜¯å¦éœ€è¦å¯åŠ¨ï¼Œè¦çœ‹Sparkçš„éƒ¨ç½²æ–¹å¼ã€‚","user_name":"ä½œè€…å›å¤","user_name_real":"ææ™ºæ…§","uid":"1007349","ctime":1571626552,"ip_address":"","comment_id":142692,"utype":1}],"discussion_count":1,"race_medal":1,"score":"1571460432","product_id":100020201,"comment_content":"ä¹‹åå†æ ¹æ®æ¯ä¸ªé˜¶æ®µè¦å¤„ç†çš„æ•°æ®é‡ç”Ÿæˆç›¸åº”çš„ä»»åŠ¡é›†åˆï¼ˆTaskSetï¼‰ï¼Œæ¯ä¸ªä»»åŠ¡éƒ½åˆ†é…ä¸€ä¸ªä»»åŠ¡è¿›ç¨‹å»å¤„ç†ï¼ŒSpark å°±å®ç°äº†å¤§æ•°æ®çš„åˆ†å¸ƒå¼è®¡ç®—ã€‚<br>æˆ‘æœ‰ç‚¹ä¸æ˜ç™½ï¼Œæ¯ä¸ªä»»åŠ¡ä¸åº”è¯¥æ˜¯ä¸€ä¸ªçº¿ç¨‹å¤„ç†å—ï¼Ÿéš¾é“ä½ è¿™ä¸ªä»»åŠ¡æ˜¯æŒ‡ä»»åŠ¡é›†åˆï¼Œæ‰€ä»¥è¦å¯åŠ¨ä¸€ä¸ªè¿›åŸï¼Ÿ","like_count":0,"discussions":[{"author":{"id":1007349,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/5e/f5/018907ac.jpg","nickname":"ææ™ºæ…§","note":"","ucode":"8C9980C438AFD1","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":471230,"discussion_content":"æ¯ä¸ªä»»åŠ¡ä¸€ä¸ªè¿›ç¨‹ï¼Œä½†æ˜¯è¿™ä¸ªè¿›ç¨‹æ˜¯å¦éœ€è¦å¯åŠ¨ï¼Œè¦çœ‹Sparkçš„éƒ¨ç½²æ–¹å¼ã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1571626552,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":138562,"user_name":"æ˜Ÿä¸€","can_delete":false,"product_type":"c1","uid":1103829,"ip_address":"","ucode":"EF550131FAE1BF","user_header":"https://static001.geekbang.org/account/avatar/00/10/d7/d5/6fbf1070.jpg","comment_is_top":false,"comment_ctime":1570336780,"is_pvip":false,"replies":[{"id":"53683","content":"æ˜¯çš„ï¼Œåé¢sparkæ€§èƒ½ä¼˜åŒ–è¿˜ä¼šç»§ç»­è¯¦ç»†è®¨è®ºè¿™äº›æ€§èƒ½æ›²çº¿ã€‚","user_name":"ä½œè€…å›å¤","user_name_real":"ææ™ºæ…§","uid":"1007349","ctime":1570602655,"ip_address":"","comment_id":138562,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1570336780","product_id":100020201,"comment_content":"è€å¸ˆæ‚¨å¥½ï¼Œè¯·æ•™ä¸€ä¸‹ï¼Œä¸Šé¢å…³äºä½œä¸šã€è®¡ç®—é˜¶æ®µã€ä»»åŠ¡çš„ä¾èµ–å’Œæ—¶é—´å…³ç³»å›¾ä¸­ï¼Œè¯´åˆ°ï¼Œä¸¤æ¡ç²—é»‘çº¿ä¹‹é—´æ˜¯ä¸€ä¸ªä½œä¸šï¼Œä¸¤æ¡ç»†çº¿ç›´æ¥æ˜¯ä¸€ä¸ªè®¡ç®—é˜¶æ®µï¼Œé‚£ä¸¤ä¸ªç»†çº¿ä¹‹é—´å¤¹äº†ä¸€æ¡ç²—é»‘çº¿è¿™ä¸ªæ€ä¹ˆç®—ã€‚ã€‚æˆ‘çš„ç†è§£æ˜¯åˆ†å±ä¸¤ä¸ªä½œä¸šçš„å„ä¸€ä¸ªè®¡ç®—é˜¶æ®µï¼Œä¸çŸ¥é“æˆ‘çš„ç†è§£æ­£ç¡®å˜›","like_count":0,"discussions":[{"author":{"id":1007349,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/5e/f5/018907ac.jpg","nickname":"ææ™ºæ…§","note":"","ucode":"8C9980C438AFD1","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":469572,"discussion_content":"æ˜¯çš„ï¼Œåé¢sparkæ€§èƒ½ä¼˜åŒ–è¿˜ä¼šç»§ç»­è¯¦ç»†è®¨è®ºè¿™äº›æ€§èƒ½æ›²çº¿ã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1570602655,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":137193,"user_name":"é’±","can_delete":false,"product_type":"c1","uid":1009652,"ip_address":"","ucode":"2C92A243A463D4","user_header":"https://static001.geekbang.org/account/avatar/00/0f/67/f4/9a1feb59.jpg","comment_is_top":false,"comment_ctime":1569643231,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1569643231","product_id":100020201,"comment_content":"å¦‚æœæ˜¯æˆ‘è´Ÿè´£äººï¼Œæˆ‘ä¼šè¿™æ ·è¿ä½œï¼š<br>1ï¼šè®©æˆ‘ä»¬çš„æ ¸å¿ƒå¼€å‘äººå‘˜åœ¨æå®¢æ—¶é—´å¼€ä¸€ä¸ªä¸“æ ï¼Œè®²è§£ç±»ä¼¼çš„äº§å“ï¼Œç„¶åä¸æ–­çš„æåŠæˆ‘ä»¬å°†è¦å¼€æºçš„é¡¹ç›®ï¼Œå¹¶å¤§æ¦‚è®²è§£ä¸€ä¸‹å¥¹çš„ç‰›é€¼ä¹‹å¤„ï¼Œå¥½åƒæ­£åœ¨è¿™ä¹ˆåš<br>2ï¼šé¦–å…ˆï¼Œç¡®è®¤å¼€æºçš„é¡¹ç›®ç¡®å®å·²ç»åœ¨å…¬å¸å†…æä¾›äº†è®¸å¤šçš„ä»·å€¼ä¹…ç»è€ƒéªŒï¼Œç„¶åå°±å…ˆåœ¨å…¬å¸å†…é€ åŠ¿ï¼Œä½¿äººäººéƒ½æ˜¯å®£ä¼ å¤§ä½¿<br>3ï¼šåšå¥½å¼€æºçš„å‰æå·¥ä½œï¼Œæ¯”å¦‚ï¼šå¼€æºé‚£ä¸€éƒ¨åˆ†ã€æ€ä¹ˆè¾¾åˆ°ç›®æ ‡ã€ç”¨ä¾‹ã€ä»‹ç»ã€ç‰¹æ€§ã€ä»£ç éƒ½å‡†å¤‡å¥½<br>4ï¼šèŠ±é’±æ‰¾å¾®ä¿¡å¾®åšè‡ªåª’ä½“çŸ¥ä¹åšå®¢ç­‰åœ°æ–¹å®£ä¼ <br>5ï¼šåšåˆ†äº«å°¤å…¶æ˜¯å¤§å‹çš„äº’è”ç½‘å¤§ä¼š<br>6ï¼šå¼€è®¾ä½¿ç”¨æ•™ç¨‹éŸ³é¢‘è§†é¢‘æ–‡æœ¬<br>7ï¼šè¯·å¤§ä¸€ç‚¹å…¬å¸ä½¿ç”¨ç«™å°ï¼Œè¯·æœ‰å½±å“åŠ›çš„æŠ€æœ¯å¤§å’–ç«™å°æ¯”å¦‚ï¼šæ™ºæ…§è€å¸ˆï¼Œæœ‰é’±å°±å¥½åŠäº‹ï¼Œå¦‚æœå…¬å¸å°èµ„é‡‘å°‘ï¼Œé‚£å°±é äº§å“æœ¬èº«çš„èƒ½é‡åŠ æ—¶é—´çš„ç§¯ç´¯","like_count":0},{"had_liked":false,"id":136593,"user_name":"é²Â·æœ¬","can_delete":false,"product_type":"c1","uid":1209939,"ip_address":"","ucode":"F1DEB30C21B48E","user_header":"https://static001.geekbang.org/account/avatar/00/12/76/53/21d62a23.jpg","comment_is_top":false,"comment_ctime":1569477432,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1569477432","product_id":100020201,"comment_content":"ä¸€ç¯‡æ–‡ç« æ¯”äººå®¶ä¸€æœ¬ä¹¦è®²çš„éƒ½é€šé€","like_count":0},{"had_liked":false,"id":105429,"user_name":"ä¹æ¯…","can_delete":false,"product_type":"c1","uid":1348052,"ip_address":"","ucode":"6361ADC9B0E8D5","user_header":"https://static001.geekbang.org/account/avatar/00/14/91/d4/3785c799.jpg","comment_is_top":false,"comment_ctime":1560997906,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1560997906","product_id":100020201,"comment_content":"Sparkè¿™ä¸ªRDDæ„Ÿè§‰å’Œç¥ç»ç½‘ç»œå¾ˆåƒå•Š","like_count":0},{"had_liked":false,"id":102689,"user_name":"åˆ©","can_delete":false,"product_type":"c1","uid":1346711,"ip_address":"","ucode":"561249904EEED5","user_header":"https://static001.geekbang.org/account/avatar/00/14/8c/97/f00593ab.jpg","comment_is_top":false,"comment_ctime":1560297347,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1560297347","product_id":100020201,"comment_content":"ä½ å¥½ï¼Œsparkçš„æ–‡ä»¶ç³»ç»Ÿç”¨çš„å•¥ï¼Ÿhdfsä¹ˆ","like_count":0},{"had_liked":false,"id":96986,"user_name":"å‘¨å°æ¡¥","can_delete":false,"product_type":"c1","uid":1062408,"ip_address":"","ucode":"80875AE7675695","user_header":"https://static001.geekbang.org/account/avatar/00/10/36/08/e3ed94b8.jpg","comment_is_top":false,"comment_ctime":1558569975,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1558569975","product_id":100020201,"comment_content":"èšåˆæ“ä½œæ˜¯å®ƒæœ€å¤§çš„ç¼ºç‚¹ã€‚","like_count":0},{"had_liked":false,"id":96979,"user_name":"å‘¨å°æ¡¥","can_delete":false,"product_type":"c1","uid":1062408,"ip_address":"","ucode":"80875AE7675695","user_header":"https://static001.geekbang.org/account/avatar/00/10/36/08/e3ed94b8.jpg","comment_is_top":false,"comment_ctime":1558569329,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1558569329","product_id":100020201,"comment_content":"æ‹¥æœ‰å¤§å‚çš„æ”¯æŒï¼Œæ˜¯æœ€å¥½çš„æ¨å¹¿ã€‚","like_count":0},{"had_liked":false,"id":85786,"user_name":"çº³å…°æ®‹å¾·","can_delete":false,"product_type":"c1","uid":1134022,"ip_address":"","ucode":"2CCEA4539748B4","user_header":"https://static001.geekbang.org/account/avatar/00/11/4d/c6/d4e85081.jpg","comment_is_top":false,"comment_ctime":1555232791,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1555232791","product_id":100020201,"comment_content":"spark on yarnçš„æ—¶å€™ æ‰§è¡Œè¿‡ç¨‹ä¸­ å“ªäº›datanodeå¯ä»¥å¯åŠ¨executor åˆ†åˆ«å¯åŠ¨å‡ ä¸ª åº”è¯¥æ˜¯resourcemanageræ§åˆ¶çš„å§ï¼Ÿè€å¸ˆè¯´çš„ åº”è¯¥æ˜¯åˆ°äº†taskå±‚é¢ï¼Œworkerå»è®¤é¢†taskï¼Ÿä¸çŸ¥é“æˆ‘æ˜¯å¦ç†è§£æœ‰è¯¯ã€‚","like_count":0},{"had_liked":false,"id":80091,"user_name":"ç é—ªé—ª","can_delete":false,"product_type":"c1","uid":1300447,"ip_address":"","ucode":"45BE0D586A3839","user_header":"http://thirdwx.qlogo.cn/mmopen/vi_32/DYAIOgq83eov38ZkwCyNoBdr5drgX0cp2eOGCv7ibkhUIqCvcnFk8FyUIS6K4gHXIXh0fu7TB67jaictdDlic4OwQ/132","comment_is_top":false,"comment_ctime":1553604075,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1553604075","product_id":100020201,"comment_content":"ä¹‹å‰å‡ èŠ‚è¯¾éƒ½èƒ½çœ‹æ‡‚ï¼Œåˆ°sparkè¿™èŠ‚çªç„¶æ„Ÿè§‰é—¨æ§›å¾ˆé«˜ï¼Œä¸å¥½çœ‹æ‡‚å…¥é—¨ï¼›è¯·é—®æè€å¸ˆï¼Œæœ‰ä»€ä¹ˆæ–¹æ³•æ›´å®¹æ˜“çœ‹æ‡‚ï¼Œæˆ–è€…å…¥é—¨sparkå—","like_count":0},{"had_liked":false,"id":63157,"user_name":"æ¸”å¤«","can_delete":false,"product_type":"c1","uid":1019289,"ip_address":"","ucode":"6BF08FD8923E45","user_header":"https://static001.geekbang.org/account/avatar/00/0f/8d/99/f886543d.jpg","comment_is_top":false,"comment_ctime":1548291374,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1548291374","product_id":100020201,"comment_content":"æˆ‘è§‰å¾—å¼€æºæˆåŠŸçš„ä¸€ä¸ªé‡è¦å‰æè¦æœ‰ç»å…¸çš„ä½¿ç”¨æ¡ˆä¾‹ï¼Œç¡®å®èƒ½è§£å†³å½“ä¸‹çš„è½¯ä»¶å¼€å‘çš„ä¸€äº›ç—›ç‚¹ï¼Œé‚£å¥¹å°±ä¸€å®šèƒ½æˆåŠŸâ€”â€”å°±åƒRoRä¹‹äºRuby","like_count":0},{"had_liked":false,"id":62158,"user_name":"eldon","can_delete":false,"product_type":"c1","uid":1368116,"ip_address":"","ucode":"3165FDE0FACB9A","user_header":"http://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTLeKdLZTWmcxDE7AUnM90naTbDzynshqzILrQAweQXicGgvdg1gImWxeZabiay9LVLsnOCfjj2nZaBA/132","comment_is_top":false,"comment_ctime":1547964311,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1547964311","product_id":100020201,"comment_content":"å¼€æºåŸæ¥ä¹Ÿä¼šå¯¹å…¬å¸æœ‰è¿™ä¹ˆå¤šå¥½å¤„ï¼Œæœ¬å­¦ç”Ÿå—ç›ŠåŒªæµ…","like_count":0},{"had_liked":false,"id":58817,"user_name":"Stream","can_delete":false,"product_type":"c1","uid":1044489,"ip_address":"","ucode":"CEBB83F7768736","user_header":"https://static001.geekbang.org/account/avatar/00/0f/f0/09/fc34d3bd.jpg","comment_is_top":false,"comment_ctime":1547199997,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1547199997","product_id":100020201,"comment_content":"å°±æ˜¯åº”è¯¥è¿™æ ·è®²åŸç†ï¼Œæœ€å¥½èƒ½æ›´ç»†èŠ‚ä¸€äº›ï¼Œæ¯”å¦‚åŸå§‹æ•°æ®æ˜¯HDFSä¸€ä¸ª12ä¸ªåˆ†åŒºï¼ŒDAGæ—¶æè¿°ä»”ç»†æ•°æ®çš„æµè¡Œå’Œè½¬åŒ–å®Œçš„ç»“æœï¼Œè¿™æ ·æ›´å…·ä½“ã€‚è‡³äºæ“ä½œç›´æ¥çœ‹å®˜ç½‘äºŒä¸‹å°±ä¼šäº†ï¼Œå†å°±æ˜¯ä¸æ–­çš„å®è·µã€‚","like_count":0},{"had_liked":false,"id":57803,"user_name":"æœ¨ç™½","can_delete":false,"product_type":"c1","uid":1194009,"ip_address":"","ucode":"BEC459430B293C","user_header":"https://static001.geekbang.org/account/avatar/00/12/38/19/c8d72c61.jpg","comment_is_top":false,"comment_ctime":1546913957,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1546913957","product_id":100020201,"comment_content":"å…³äºå¼€æºè½¯ä»¶çš„è¿ä½œï¼Œæˆ‘æ²¡æœ‰æ¥è§¦è¿‡ä½†æ˜¯å¯ä»¥çŒœä¸€ä¸‹ï¼Œä¸ä¸€å®šå¯¹ã€‚å°±åƒä¸€ä¸ªå•†ä¸šè½¯ä»¶ä¸€æ ·ï¼Œé¦–å…ˆéœ€è¦ç§¯ç´¯åŸå§‹ç”¨æˆ·ï¼Œè¿™ä¸ªé˜¶æ®µå°±é¦–å…ˆå¯ä»¥å‘æ­£åœ¨ä½¿ç”¨ç›¸å…³æŠ€æœ¯çš„å…¬å¸çš„å‘˜å·¥æ¨å¹¿ï¼Œè¯·ä»–ä»¬æ¥è¯•ç”¨ï¼Œè¿™ä¸ªæ¨å¹¿å¯ä»¥æ˜¯çº¿ä¸Šçš„ï¼Œä½¿ç”¨å†…æµ‹æˆ–è€…é‚€è¯·ç çš„å½¢å¼åœ¨ç¤¾åŒºæˆ–è€…è®ºå›é‚€è¯·ï¼Œä¹Ÿå¯ä»¥ç™»é—¨åšè¯•ç”¨å®£è®²ï¼Œå¸å¼•ç”¨æˆ·ã€‚è¿™æ‰¹ç”¨æˆ·å¯èƒ½GitHubä¸Šè¿›è¡Œç›¸å…³è®¨è®ºï¼Œç„¶åå¸å¼•æ›´å¤šçš„ç”¨æˆ·ã€‚è¿˜å¯ä»¥èµåŠ©é¢†åŸŸç›¸å…³çš„å­¦æœ¯ä¼šè®®ã€‚å½“ç”¨æˆ·é‡è¾¾åˆ°ä¸€å®šçš„è§„æ¨¡ã€è½¯ä»¶è¾ƒä¸ºæˆç†Ÿã€åœ¨å®éªŒå®¤ç¯å¢ƒä¸‹èƒ½å¤Ÿè§£å†³ä¸€äº›é—®é¢˜çš„æ—¶å€™å°±å¯ä»¥å¬å¼€è‡ªå·±çš„å­¦æœ¯ä¼šè®®ï¼Œå¸å¼•æŠ•ç¨¿ï¼Œæ‰©å¤§å½±å“åŠ›ã€‚ç­‰ç­‰ç­‰ç­‰ã€‚","like_count":0},{"had_liked":false,"id":57799,"user_name":"æœ¨ç™½","can_delete":false,"product_type":"c1","uid":1194009,"ip_address":"","ucode":"BEC459430B293C","user_header":"https://static001.geekbang.org/account/avatar/00/12/38/19/c8d72c61.jpg","comment_is_top":false,"comment_ctime":1546913396,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1546913396","product_id":100020201,"comment_content":"æˆ‘æœ‰å°‘é‡çš„sparkä½¿ç”¨ç»éªŒï¼Œå¹¶ä¸”ä¹Ÿäº†è§£è¿‡æœ¬ç« æ‰€æ¶‰åŠåˆ°çš„åŸç†ï¼Œä½†æ˜¯çœ‹èµ·æ¥è¿˜æ˜¯æœ‰ç‚¹è´¹åŠ²ï¼Œæ‰€ä»¥æˆ‘è§‰å¾—å¦‚æœçœŸçš„æ˜¯åˆå­¦è€…çš„è¯ï¼Œçœ‹èµ·æ¥åªä¼šæ›´è´¹åŠ²ã€‚ä»æœ€è¿‘ä¸¤ç¯‡çš„ç•™è¨€æ¥çœ‹æˆ‘è¿™ç§æ¨æ–­ä¹Ÿä¸æ— é“ç†ã€‚æˆ‘è§‰å¾—è€å¸ˆè¿˜æ˜¯éœ€è¦åœ¨æŸäº›åœ°æ–¹æ›´åŠ è¯¦ç»†ä¸€ç‚¹ï¼Œæ¯”å¦‚åœ¨ä¸¾ä¾‹å­çš„æ—¶å€™ç”¨å…·ä½“çš„æ•°æ®å»ä»£æ›¿å°æ–¹å—æ‰€è¡¨ç¤ºçš„æ•°æ®åˆ†ç‰‡ã€‚ä½†æ˜¯æ€»ä½“æ¥è¯´è€å¸ˆè¿˜æ˜¯è®²å¾—å¾ˆå¥½çš„ã€‚","like_count":0},{"had_liked":false,"id":57166,"user_name":"ç‹è¶…","can_delete":false,"product_type":"c1","uid":1295135,"ip_address":"","ucode":"DFAD7F33369F64","user_header":"https://static001.geekbang.org/account/avatar/00/13/c3/1f/f1b88ff9.jpg","comment_is_top":false,"comment_ctime":1546670183,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1546670183","product_id":100020201,"comment_content":"è¯·æ•™è€å¸ˆï¼Œçœ‹åˆ°ä¸€ä¸ªè§‚ç‚¹ï¼Œä»¥å‰ç§»åŠ¨è®¡ç®—æ¯”ç§»åŠ¨æ•°æ®æ›´å¥½ã€‚ä½†æ˜¯ç°åœ¨æœ‰ä¸€äº›æ–°çš„å˜åŒ–ï¼Œæ¯”å¦‚æ•°æ®çš„ç§»åŠ¨é€Ÿåº¦æˆæœ¬æ¯”å‡ å¹´å‰ä½å¾ˆå¤šï¼Œè€ŒHadoopæ¡†æ¶ä¸‹è®¡ç®—èµ„æºï¼ˆç›¸å¯¹äºå­˜å‚¨èµ„æºï¼‰æµªè´¹è¾ƒå¤šï¼Œå› ä¸ºè®¡ç®—å’Œå­˜å‚¨èµ„æºæ˜¯é…æ¯”çš„ï¼Œæ‰€ä»¥ä¼ ç»Ÿçš„Hadoopæ²¡æœ‰é‚£ä¹ˆä¼˜äº†ã€‚è¯·æ•™è€å¸ˆæ˜¯è¿™æ ·å—ï¼Œä»¥åŠæ›´ä¼˜çš„è§£å†³æ–¹æ¡ˆæ˜¯ä»€ä¹ˆï¼Ÿè°¢è°¢ï¼","like_count":0},{"had_liked":false,"id":46706,"user_name":"ming","can_delete":false,"product_type":"c1","uid":1054341,"ip_address":"","ucode":"63135A86598E64","user_header":"https://static001.geekbang.org/account/avatar/00/10/16/85/e4d53282.jpg","comment_is_top":false,"comment_ctime":1543973174,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1543973174","product_id":100020201,"comment_content":"sparkç›¸æ¯”mapreduceï¼Œ1ã€ä½¿ç”¨å¤šä¸ªmapå’ŒreduceæŒ‰ç…§ä¸šåŠ¡éœ€æ±‚ç»„åˆæˆæ›´åŠ é«˜æ•ˆã€çµæ´»çš„é˜¶æ®µã€‚2ã€èƒ½ä½¿ç”¨å†…å­˜äº¤äº’æ•°æ®çš„å°±ä¸ä½¿ç”¨ç£ç›˜ï¼Œé€Ÿåº¦æ›´å¿«ã€‚","like_count":0},{"had_liked":false,"id":46499,"user_name":"äºšäºš","can_delete":false,"product_type":"c1","uid":1215843,"ip_address":"","ucode":"C318200897EBAF","user_header":"https://static001.geekbang.org/account/avatar/00/12/8d/63/0ce0afee.jpg","comment_is_top":false,"comment_ctime":1543930781,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1543930781","product_id":100020201,"comment_content":"sparkçš„ä¸­é—´æ•°æ®éƒ½å­˜å‚¨åœ¨å†…å­˜ä¸­ï¼Œshuffleè¿‡ç¨‹ä¹Ÿæ˜¯åœ¨å†…å­˜ä¸­å¤„ç†çš„ï¼Œåˆ†å¸ƒå¼æƒ…å†µä¸‹ï¼Œå†…å­˜ä¹Ÿè¦å®ç°åˆ†å¸ƒå¼å§ï¼Œæ¯”å¦‚redisé›†ç¾¤ï¼Œä¸ç„¶å¤šä¸ªæœºå™¨ä¹‹é—´å°±ä¸èƒ½ç›´æ¥é€šè¿‡å†…å­˜è¿›è¡Œæ•°æ®ä¼ è¾“ï¼Œä¸çŸ¥é“sparkæ˜¯æ€ä¹ˆå¤„ç†çš„","like_count":0},{"had_liked":false,"id":45615,"user_name":"æ°ä¹‹7","can_delete":false,"product_type":"c1","uid":1297232,"ip_address":"","ucode":"F7DA2E21085332","user_header":"https://static001.geekbang.org/account/avatar/00/13/cb/50/66d0bd7f.jpg","comment_is_top":false,"comment_ctime":1543722374,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1543722374","product_id":100020201,"comment_content":"é€šè¿‡æœ¬èŠ‚çš„å­¦ä¹ ï¼Œäº†è§£äº†Sparkçš„æ¶æ„åŸç†ï¼ŒSparké€šè¿‡äº§ç”Ÿå¤šé˜¶æ®µçš„æœ‰å‘æ— ç¯å›¾DAGï¼Œè®©å‰ä¸€ä¸ªé˜¶æ®µçš„reduceå’Œåä¸€é˜¶æ®µçš„Mapè¿æ¥èµ·æ¥ï¼Œæœ‰é™å‡å°‘å¯¹HDFSçš„è®¿é—®ï¼Œè¿™æ ·å¯ä»¥è®©è®¡ç®—é€Ÿåº¦åŠ å¿«ã€‚åœ¨Sparkäº§ç”Ÿçš„æ—¶é—´ç‚¹ä¸Šï¼Œå¯ä»¥è®©Sparkç”¨å†…å­˜å­˜å‚¨ï¼Œè€Œä¸æ˜¯Mapreduceçš„ç£ç›˜å­˜å‚¨ï¼ŒåŠ å¿«äº†è¯»å†™é€Ÿåº¦ã€‚ç¼–ç¨‹æ¨¡å‹ä¸Šçš„ä¼˜åŠ¿ï¼Œä¹Ÿè®©Sparkæ›´èƒœmapreduceã€‚","like_count":0},{"had_liked":false,"id":45181,"user_name":"ray","can_delete":false,"product_type":"c1","uid":1056436,"ip_address":"","ucode":"76DAA3FACF49E2","user_header":"https://static001.geekbang.org/account/avatar/00/10/1e/b4/93966675.jpg","comment_is_top":false,"comment_ctime":1543557388,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1543557388","product_id":100020201,"comment_content":"è€å¸ˆèƒ½å¦ç†è®ºè®²å®Œåï¼Œæœ‰ä¸€äº›å®è·µè¯¾ã€‚ä½œä¸ºåˆå­¦è€…ï¼Œåªæ˜¯å°†ç†è®ºæ„Ÿè§‰æœ‰ç‚¹æ¯ç‡¥å’Œå¿ƒé‡Œæ²¡åº•ã€‚","like_count":0},{"had_liked":false,"id":43892,"user_name":"å¾€äº‹éšé£ï¼Œé¡ºå…¶è‡ªç„¶","can_delete":false,"product_type":"c1","uid":1235692,"ip_address":"","ucode":"F266EC6B143E38","user_header":"https://static001.geekbang.org/account/avatar/00/12/da/ec/779c1a78.jpg","comment_is_top":false,"comment_ctime":1543319160,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1543319160","product_id":100020201,"comment_content":"Spark çš„å¹¿æ’­å˜é‡å®ç°æœºåˆ¶æ˜¯ä»€ä¹ˆ","like_count":0},{"had_liked":false,"id":43887,"user_name":"è¿½æ¢¦å°ä¹","can_delete":false,"product_type":"c1","uid":1035507,"ip_address":"","ucode":"82AB8A7F98389D","user_header":"https://static001.geekbang.org/account/avatar/00/0f/cc/f3/5e4b0315.jpg","comment_is_top":false,"comment_ctime":1543318123,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1543318123","product_id":100020201,"comment_content":"è€å¸ˆï¼Œæˆ‘æƒ³è¯·æ•™å‡ ä¸ªé—®é¢˜ï¼š<br>1ã€â€œæ ¹æ®æ¯ä¸ªé˜¶æ®µè¦å¤„ç†çš„æ•°æ®é‡ç”Ÿæˆç›¸åº”çš„ä»»åŠ¡é›†åˆï¼ˆTaskSetï¼‰ï¼Œæ¯ä¸ªä»»åŠ¡éƒ½åˆ†é…ä¸€ä¸ªä»»åŠ¡è¿›ç¨‹å»å¤„ç†â€ï¼Œæ˜¯ä¸€ä¸ªä»»åŠ¡é›†åˆTaskSetå¯åŠ¨ä¸€ä¸ªè¿›ç¨‹ï¼ŒtaskSeté‡Œé¢çš„ä»»åŠ¡æ˜¯ç”¨çº¿ç¨‹è®¡ç®—å—ï¼Ÿè¿˜æ˜¯æ¯ä¸ªTaskSeté‡Œé¢çš„ä»»åŠ¡å¯åŠ¨ä¸€ä¸ªè¿›ç¨‹ï¼Ÿ<br><br>2ã€task-time å›¾ä¸­çº¢è‰²å¯†é›†çš„è¡¨ç¤ºä»€ä¹ˆï¼Ÿ<br><br>3ã€Spark çš„æ‰§è¡Œè¿‡ç¨‹ çš„å›¾ä¸­ Executor ä¸­çš„ Cache æ˜¯è¡¨ç¤ºå†…å­˜å—ï¼ŸCacheã€taskå’ŒExecutorä¹‹é—´çš„å…³ç³»æ˜¯ä»€ä¹ˆï¼Ÿ","like_count":0},{"had_liked":false,"id":43672,"user_name":"å´ç§‘ğŸ€","can_delete":false,"product_type":"c1","uid":1112547,"ip_address":"","ucode":"8F2C317887A323","user_header":"https://static001.geekbang.org/account/avatar/00/10/f9/e3/2529c7dd.jpg","comment_is_top":false,"comment_ctime":1543279816,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1543279816","product_id":100020201,"comment_content":"å‚åŠ è¿‡spark meetingupï¼Œå…è´¹äº¤æµçš„å¹³å°ã€‚ç°åœ¨sparkæºç éƒ½è¢«databricksè¿™ä¸ªå•†ä¸šå…¬å¸æŠŠæŒäº†å§","like_count":0}]}