{"id":104630,"title":"60 | 使用Notification接收和处理播放状态通知","content":"<p><strong>PDF 课件和源代码下载地址：</strong></p><p><a href=\"https://gitee.com/geektime-geekbang/geektime-ios-course\">https://gitee.com/geektime-geekbang/geektime-ios-course</a></p>","comments":[{"had_liked":false,"id":111647,"user_name":"Xin","can_delete":false,"product_type":"c3","uid":1018074,"ip_address":"","ucode":"3744B19740B19C","user_header":"https://static001.geekbang.org/account/avatar/00/0f/88/da/e96b657f.jpg","comment_is_top":false,"comment_ctime":1562577778,"is_pvip":false,"replies":[{"id":41470,"content":"是的。iOS9之后Apple内部的逻辑实现都变成了ARC。但是“谁创建谁销毁，谁分配谁释放”，习惯上就是显式的将这些逻辑都写出来。当然都是可以的。","user_name":"作者回复","user_name_real":"dequanzhu","uid":1041455,"ctime":1563165976,"ip_address":"","comment_id":111647,"utype":1}],"discussion_count":1,"race_medal":0,"score":2,"product_id":100025901,"comment_content":"iOS 9 以后通知不是不用手动移除了会自动置空吧","like_count":3,"discussions":[{"author":{"id":1041455,"avatar":"http://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTKJ3dLlYr6tznfnZXJNsD7Jw48BVnFSib3RO3VWEN0pgebRY1jaR8YXLQ6iaAjTsFiamOWSA3UPAa37A/132","nickname":"Geek_e7jq8k","note":"","ucode":"352964E5D793DA","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":457402,"discussion_content":"是的。iOS9之后Apple内部的逻辑实现都变成了ARC。但是“谁创建谁销毁，谁分配谁释放”，习惯上就是显式的将这些逻辑都写出来。当然都是可以的。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1563165976,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":225883,"user_name":"Geek_b7eb88","can_delete":false,"product_type":"c3","uid":1573715,"ip_address":"","ucode":"0EB46381D9B1CB","user_header":"","comment_is_top":false,"comment_ctime":1591882849,"is_pvip":false,"replies":[{"id":84689,"content":"这个理解也是不对的。invalidate作为timer的一个方法，调用会导致timer从当前的runloop中移除，这个timer之后就不会继续起作用。这个时候self.timer还继续指向这个无效的timer。当然在dealloc的时候自然也会被ARC回收。而self.timer=nil的作用是保证在访问self.timer的时候返回nil，会减少timer本身的引用计数之后被ARC机制回收。两个语句的作用和意义是完全不一样的，虽然由于ARC的作用在内存管理这方面效果是类似的。","user_name":"作者回复","user_name_real":"zzz","uid":1041455,"ctime":1593002314,"ip_address":"","comment_id":225883,"utype":1}],"discussion_count":2,"race_medal":0,"score":2,"product_id":100025901,"comment_content":"我印象我们有次视频内存泄露，是因为playerItem没释放，item=nil好像不能释放掉它，好像需要调用一个clean方法才可以。类似于timer需要调用invalidate才可以释放。","like_count":0,"discussions":[{"author":{"id":1041455,"avatar":"http://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTKJ3dLlYr6tznfnZXJNsD7Jw48BVnFSib3RO3VWEN0pgebRY1jaR8YXLQ6iaAjTsFiamOWSA3UPAa37A/132","nickname":"Geek_e7jq8k","note":"","ucode":"352964E5D793DA","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":498026,"discussion_content":"这个理解也是不对的。invalidate作为timer的一个方法，调用会导致timer从当前的runloop中移除，这个timer之后就不会继续起作用。这个时候self.timer还继续指向这个无效的timer。当然在dealloc的时候自然也会被ARC回收。而self.timer=nil的作用是保证在访问self.timer的时候返回nil，会减少timer本身的引用计数之后被ARC机制回收。两个语句的作用和意义是完全不一样的，虽然由于ARC的作用在内存管理这方面效果是类似的。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1593002314,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1573715,"avatar":"","nickname":"Geek_b7eb88","note":"","ucode":"0EB46381D9B1CB","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":282261,"discussion_content":"[player.currentItem cancelPendingSeeks];\n[player.currentItem.asset cancelLoading];","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1591932269,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":342770,"user_name":"zeek","can_delete":false,"product_type":"c3","uid":1675172,"ip_address":"","ucode":"21E19CB1A77181","user_header":"https://static001.geekbang.org/account/avatar/00/19/8f/a4/8da83afb.jpg","comment_is_top":false,"comment_ctime":1650453597,"is_pvip":false,"replies":null,"discussion_count":0,"race_medal":0,"score":2,"product_id":100025901,"comment_content":"请问 声明一个变量XX 后引用\n_XX跟self.XX 请问有什么区别？\n用哪一个好","like_count":0},{"had_liked":false,"id":273781,"user_name":"Mr.zhou","can_delete":false,"product_type":"c3","uid":2324910,"ip_address":"","ucode":"5992DA35742D85","user_header":"https://static001.geekbang.org/account/avatar/00/23/79/ae/daeddde4.jpg","comment_is_top":false,"comment_ctime":1610676362,"is_pvip":false,"replies":null,"discussion_count":0,"race_medal":0,"score":2,"product_id":100025901,"comment_content":"老师，我这边注册AVPlayerItemDidPlayToEndTimeNotification的回调方法同一时间连续调了四次。这个是什么原因","like_count":0}]}