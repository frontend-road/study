{"id":804972,"title":"08ï½œç¨‹åºè®¿é—®æ•°æ®åº“å†…å­˜æº¢å‡ºæ€ä¹ˆè§£å†³ï¼Ÿ","content":"<p>ä½ å¥½ï¼Œæˆ‘æ˜¯ä¿Šè¾¾ã€‚</p><p>ä¸çŸ¥é“ä½ å¹³æ—¶ä½¿ç”¨å„ç§è¯­è¨€ç¼–å†™ç¨‹åºè®¿é—®æ•°æ®åº“çš„æ—¶å€™ï¼Œæœ‰æ²¡æœ‰é‡åˆ°è¿‡å†…å­˜æ–¹é¢çš„é—®é¢˜ï¼Œç¡®åˆ‡åœ°è®²ï¼Œæ˜¯åº”ç”¨ç¨‹åºè®¿é—®æ•°æ®åº“æ—¶ï¼Œæ¶ˆè€—äº†å¤§é‡çš„å†…å­˜ï¼Œç”šè‡³å¯¼è‡´æ•´ä¸ªæœåŠ¡å™¨çš„å†…å­˜éƒ½è€—å°½äº†ã€‚</p><p>ä½œä¸ºä¸€åæ•°æ®åº“çš„ç”¨æˆ·ï¼Œæˆ‘åŸå…ˆä¹Ÿå†™è¿‡ä¸€äº›ç®€å•çš„ç¨‹åºï¼Œç”¨æ¥åŒæ­¥æ•°æ®ã€‚ä»£ç çš„æ ¸å¿ƒé€»è¾‘å¾ˆç®€å•ï¼Œå°±æ˜¯åˆ°æºåº“æ‰§è¡ŒSELECTè¯­å¥æŸ¥è¯¢æ•°æ®ï¼Œæ¯æ¬¡è¯»å–ä¸€è¡Œæ•°æ®ï¼Œç„¶ååˆ°ç›®æ ‡åº“æ‰§è¡ŒINSERTå†™å…¥æ•°æ®ï¼Œå°±åƒä¸‹é¢è¿™æ®µç®€å•çš„Pythonä»£ç æ‰€å±•ç¤ºçš„ã€‚</p><pre><code class=\"language-go\">import MySQLdb\n\ndef copy_table(src_conn, dest_conn):\n    sql_select = 'select * from src_tab'\n    sql_insert = \"insert into dest_tab values(%s,%s,%s)\"\n    cur = src_conn.cursor()\n    cur.execute(sql_select)\n    row = cur.fetchone()\n    while row:\n        insert_row(dest_conn, sql_insert, row)\n        row = cur.fetchone()\n\ndef insert_row(dbconn, sql, data):\n    cur = dbconn.cursor()\n    cur.execute(sql, data)\n    dbconn.commit()\n\nif __name__ == '__main__':\n    src_conn = MySQLdb.connect(host='src_host', port=3306, user='user_01', passwd='somepass', db='src_db');\n    dest_conn = MySQLdb.connect(host='dest_host', port=3306, user='user_01', passwd='somepass', db='dest_db');\n\n    copy_table(src_conn,dest_conn )\n</code></pre><!-- [[[read_end]]] --><p>ä¸Šé¢è¿™æ®µä»£ç æ²¡æœ‰åšå¼‚å¸¸å¤„ç†ï¼Œä¹Ÿæ²¡æœ‰é‡‡ç”¨æ‰¹é‡å†™å…¥æ¥æé«˜æ€§èƒ½ï¼Œä½†æ˜¯åœ¨ä¸å‡ºå¼‚å¸¸çš„æƒ…å†µä¸‹ï¼Œæ˜¯å¯ä»¥æ‰§è¡Œçš„ã€‚ç›´åˆ°åæ¥å‘ç°äº†ä¸€ä¸ªä¸¥é‡çš„é—®é¢˜ã€‚å¦‚æœæºè¡¨æ•°æ®é‡å¾ˆå¤§ï¼Œé‚£ä¹ˆæ‰§è¡Œè¿™æ®µä»£ç æ—¶ï¼Œç¨‹åºä¼šæ¶ˆè€—å¤§é‡çš„å†…å­˜ï¼Œä½¿ç”¨topå‘½ä»¤å¯ä»¥è§‚å¯Ÿåˆ°è¿›ç¨‹ä½¿ç”¨çš„å†…å­˜æŒç»­ä¸Šæ¶¨ï¼Œä½†æ˜¯åœ¨ç›®æ ‡è¡¨ä¸­å´æŸ¥ä¸åˆ°ä»»ä½•æ–°æ’å…¥çš„æ•°æ®ã€‚</p><p>ä¸ºä»€ä¹ˆä¼šè¿™æ ·å‘¢ï¼Ÿè¿™ä¸€è®²æˆ‘ä»¬å°±æ¥å¥½å¥½åœ°åˆ†æä¸€ä¸‹è¿™ä¸ªé—®é¢˜ã€‚</p><h2>å†…å­˜åˆ†æ</h2><p>åœ¨ä¸Šé¢è¿™ä¸ªä¾‹å­ä¸­ï¼Œä»£ç éå¸¸ç®€å•ï¼Œå› æ­¤æˆ‘ä»¬æ¯”è¾ƒå®¹æ˜“æƒ³åˆ°å†…å­˜ä½¿ç”¨é‡é«˜å¯èƒ½è·Ÿæºè¡¨æ•°æ®é‡å¤šæœ‰å…³ç³»ã€‚ä½†æ˜¯åœ¨å®é™…åœºæ™¯ä¸­ï¼Œä»£ç å¯èƒ½ä¼šå¾ˆå¤æ‚ï¼Œä½ é¦–å…ˆéœ€è¦ææ¸…æ¥šå†…å­˜åˆ°åº•æ¶ˆè€—åœ¨å“ªé‡Œäº†ã€‚æ¥ä¸‹æ¥æˆ‘ä»¥ä¸€ä¸ªçœŸå®çš„Javaç¨‹åºä¸ºä¾‹ï¼Œæ¼”ç¤ºå¦‚ä½•è¿›è¡Œå†…å­˜åˆ†æã€‚ä¹‹æ‰€ä»¥é€‰ç”¨Javaï¼Œä¸»è¦æ˜¯å› ä¸ºJavaåœ¨ä¼ä¸šçº§åº”ç”¨ä¸­è¿ç”¨å¾ˆå¹¿æ³›ï¼Œè€Œä¸”ç›¸å…³çš„é…å¥—å·¥å…·ä¹Ÿæ¯”è¾ƒå®Œå–„ã€‚</p><p>æˆ‘ä»¬å¯ä»¥ä½¿ç”¨Heapdumpæ¥åˆ†æJavaç¨‹åºçš„å†…å­˜ä½¿ç”¨æƒ…å†µï¼Œä»Heapdumpä¸­å¯ä»¥åˆ†æå‡ºç¨‹åºçš„å¾ˆå¤šä¿¡æ¯ï¼ŒåŒ…æ‹¬ï¼š</p><ul>\n<li>å„ç§ç±»å‹å¯¹è±¡çš„æ•°é‡ã€å ç”¨çš„ç©ºé—´</li>\n<li>å¯¹è±¡ä¹‹é—´çš„å¼•ç”¨å…³ç³»</li>\n<li>å¯¹è±¡å±æ€§çš„å€¼</li>\n<li>çº¿ç¨‹çš„è°ƒç”¨æ ˆ</li>\n</ul><p>æˆ‘ä»¬ä½¿ç”¨MATï¼ˆMemory Analyzer Toolï¼‰æ¥åˆ†æJavaçš„Heapdumpæ–‡ä»¶ã€‚é¦–å…ˆéœ€è¦è·å–Javaç¨‹åºçš„Heapdumpï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨jmapç­‰å·¥å…·æ¥ç”ŸæˆHeapdumpï¼Œå…·ä½“çš„æ–¹æ³•è¿™é‡Œå°±ä¸å±•å¼€äº†ã€‚è·å–åˆ°Dumpæ–‡ä»¶åï¼Œä½¿ç”¨MATæ‰“å¼€ã€‚å¦‚æœç”Ÿæˆçš„Dumpæ–‡ä»¶æ¯”è¾ƒå¤§ï¼Œæ‰“å¼€å¯èƒ½éœ€è¦æ¯”è¾ƒå¤šçš„æ—¶é—´ã€‚</p><h3>æ€»è§ˆé¡µ</h3><p>æ‰“å¼€Dumpæ–‡ä»¶åï¼Œä»æ€»è§ˆé¡µé¢å¯ä»¥çœ‹åˆ°å†…å­˜æ¶ˆè€—æœ€é«˜çš„é‚£äº›å¯¹è±¡ã€‚åœ¨æˆ‘ä»¬è¿™ä¸ªDumpæ–‡ä»¶ä¸­ï¼Œå†…å­˜å ç”¨æœ€é«˜çš„æ˜¯JDBC42ResultSetï¼Œä»åå­—æˆ‘ä»¬çŒœæµ‹è¿™åº”è¯¥æ˜¯ä»æ•°æ®åº“å–å›çš„ç»“æœé›†ã€‚</p><p><img src=\"https://static001.geekbang.org/resource/image/fe/36/fe4156114f5b6f2379f09acb02330b36.png?wh=1108x768\" alt=\"å›¾ç‰‡\"></p><h3>Dominator Tree</h3><p>è¿›å…¥Dominator Treeæ¨¡å—ï¼ŒæŸ¥çœ‹å†…å­˜å ç”¨æœ€é«˜çš„å¯¹è±¡ã€‚è¿™é‡Œæˆ‘ä»¬ä¸»è¦å…³æ³¨çš„æ˜¯Retained Heapè¿™ä¸€åˆ—ï¼Œä¹Ÿå°±æ˜¯å¯¹è±¡æœ¬èº«åŠ ä¸Šè¯¥å¯¹è±¡å¼•ç”¨çš„å…¶ä»–å¯¹è±¡å ç”¨çš„å†…å­˜æ€»å’Œã€‚æˆ‘ä»¬çš„Dumpæ–‡ä»¶ä¸­ï¼Œä¸»è¦æ˜¯JDBC42ResultSetå’ŒThreadå¯¹è±¡ï¼Œæ€»å…±å ç”¨äº†è¶…è¿‡90%çš„å†…å­˜ã€‚</p><p><img src=\"https://static001.geekbang.org/resource/image/eb/17/eb49c6309060715ac7d94dd070a7f617.png?wh=1676x572\" alt=\"å›¾ç‰‡\"></p><h3>å¯¹è±¡å±æ€§</h3><p>å±•å¼€å¯¹è±¡ï¼Œæˆ‘ä»¬å‘ç°JDBC42ResultSetå†…å­˜ä½¿ç”¨è¿™ä¹ˆé«˜çš„åŸå› æ˜¯é‡Œé¢æœ‰ä¸€ä¸ªelementDataæ•°ç»„ï¼Œè¿™ä¸ªæ•°ç»„é‡Œæœ‰80å¤šä¸‡ä¸ªå¯¹è±¡ï¼Œæˆ‘ä»¬çŒœæµ‹è¿™äº›å¯¹è±¡å¯¹åº”æ•°æ®åº“è¿”å›çš„è®°å½•ã€‚</p><p><img src=\"https://static001.geekbang.org/resource/image/9b/d2/9b773e239557624566e5ac3304023ed2.png?wh=1676x602\" alt=\"å›¾ç‰‡\"></p><h3>æŸ¥çœ‹å¯¹è±¡å¼•ç”¨</h3><p>æ¥ä¸‹æ¥æˆ‘ä»¬å¸Œæœ›èƒ½æ‰¾åˆ°è¿™æ˜¯å“ªä¸ªSQLæŸ¥è¯¢å¾—åˆ°çš„æ•°æ®ã€‚ç‚¹å‡»é¼ æ ‡å³é”®ï¼Œæ‰“å¼€â€œList objectsâ€ä¸‹çš„â€œwith outgoing referencesâ€èœå•é¡µã€‚</p><p><img src=\"https://static001.geekbang.org/resource/image/a8/4d/a892ee029b2d591ccb241899707f3f4d.png?wh=1678x574\" alt=\"å›¾ç‰‡\"></p><p>è¿›å…¥list_objectsèœå•é¡µï¼Œæˆ‘ä»¬å‘ç°åœ¨owningStatementå±æ€§ä¸­ï¼Œå¯ä»¥æ‰¾åˆ°åŸå§‹çš„SQLè¯­å¥æ–‡æœ¬ã€‚ä»physicalConnectionå±æ€§ä¸­ï¼Œæˆ‘ä»¬è¿˜èƒ½çœ‹åˆ°æ•°æ®åº“è¿æ¥çš„ç›¸å…³å±æ€§ã€‚åˆ°è¿™é‡Œæˆ‘ä»¬å°±å·²ç»å®šä½åˆ°äº†å…·ä½“çš„SQLè¯­å¥ã€‚</p><p><img src=\"https://static001.geekbang.org/resource/image/34/84/342b98604ea1119b20e5a4615e140884.png?wh=1600x850\" alt=\"å›¾ç‰‡\"></p><h3>åˆ†æè°ƒç”¨å †</h3><p>Threadå¯¹è±¡ä¹Ÿå ç”¨äº†æ¯”è¾ƒå¤šçš„å†…å­˜ï¼Œå±•å¼€åå¯ä»¥çœ‹åˆ°å…¶ä¸­ä¹Ÿæœ‰ä¸€ä¸ªé•¿åº¦ä¸º20å¤šä¸‡çš„elementDataæ•°ç»„ï¼ŒelementDataé‡Œé¢å­˜çš„æ˜¯ä¸šåŠ¡çš„å¯¹è±¡ï¼Œè·Ÿæ•°æ®åº“ä¸­çš„è®°å½•ç›¸å¯¹åº”ã€‚</p><p><img src=\"https://static001.geekbang.org/resource/image/36/65/3655f074a5e708963d871c08c2672b65.png?wh=1652x412\" alt=\"å›¾ç‰‡\"></p><p>ä¸ºäº†åˆ†æè¿™äº›å¯¹è±¡æ˜¯å“ªä¸ªSQLæŸ¥è¯¢å¾—åˆ°çš„ï¼Œæˆ‘ä»¬éœ€è¦åˆ†æçº¿ç¨‹çš„è°ƒç”¨æ ˆï¼Œæ‰“å¼€â€œJava Basicsâ€ä¸‹çš„â€œThread Overview and Stacksâ€èœå•ã€‚</p><p><img src=\"https://static001.geekbang.org/resource/image/63/a8/63628d44a6bfc29e1d355c6057b00da8.png?wh=1750x748\" alt=\"å›¾ç‰‡\"></p><p>åœ¨thread_overviewèœå•é¡µä¸­ï¼Œæˆ‘ä»¬å¯ä»¥çœ‹åˆ°çº¿ç¨‹çš„è°ƒç”¨æ ˆã€‚å†…å­˜ä¸»è¦ç”±handleResultSetçš„å±€éƒ¨å˜é‡å ç”¨ï¼Œè€ŒSQLè¯­å¥å¯èƒ½æ˜¯åœ¨SimpleExecutor.doQueryæ–¹æ³•ä¸­å‘èµ·çš„ã€‚</p><p><img src=\"https://static001.geekbang.org/resource/image/b9/c9/b9e0991c30208ff834e5507865bae8c9.png?wh=1666x650\" alt=\"å›¾ç‰‡\"></p><p>ç‚¹å¼€doQueryï¼Œæˆ‘ä»¬æ‰¾åˆ°äº†ä»£ç ä¸­æ‰§è¡Œçš„SQLè¯­å¥ã€‚ç‚¹å¼€statementè¿˜å¯ä»¥çœ‹åˆ°ä¼ ç»™SQLçš„å…·ä½“å‚æ•°ã€‚</p><p><img src=\"https://static001.geekbang.org/resource/image/c3/cd/c39dfbc64436e36cc93df346a82e97cd.png?wh=1698x726\" alt=\"å›¾ç‰‡\"></p><p>æˆ‘ä»¬æ¼”ç¤ºäº†ä»Heapdumpæ–‡ä»¶ä¸­å®šä½SQLè¯­å¥çš„ä¸€äº›æ–¹æ³•ã€‚ä¸€æ¡SQLçš„æ‰§è¡Œç»“æœï¼Œåœ¨ç¨‹åºä¸­å¯èƒ½ä¼šå­˜å‚¨ä¸¤æ¬¡ï¼Œä¸€æ¬¡ä»¥JDBCResultSetçš„æ–¹å¼å­˜å‚¨ï¼Œä¸€æ¬¡ä»¥åº”ç”¨ç¨‹åºå¯¹è±¡çš„æ–¹å¼å­˜å‚¨ã€‚æ‰¾åˆ°SQLè¯­å¥åï¼Œå°±å¯ä»¥ä»ä¸šåŠ¡çš„è§’åº¦è¿›è¡Œåˆ†æï¼ŒSQLè¯­å¥æ˜¯å¦åˆç†ã€æ˜¯å¦å¯ä»¥ä¼˜åŒ–ã€‚</p><p>æ¥ä¸‹æ¥æˆ‘ä»¬æ¥å›ç­”è¿™ä¸€è®²å¼€å¤´æå‡ºçš„é‚£ä¸ªé—®é¢˜ï¼šä¸ºä»€ä¹ˆä»ä»£ç é€»è¾‘ä¸Šçœ‹ï¼Œæ¯æ¬¡åªå¤„ç†äº†ä¸€è¡Œè®°å½•ï¼Œä½†æ˜¯ç¨‹åºå´å ç”¨äº†å¤§é‡å†…å­˜ï¼Œå°±å¥½åƒå°†æ‰€æœ‰è¿”å›çš„è®°å½•éƒ½ç¼“å­˜åˆ°äº†å†…å­˜ä¸­ï¼Ÿ</p><p>ä¸ºæ­¤æˆ‘ä»¬å…ˆæ¥åˆ†æä¸€ä¸ªæ™®é€šçš„SELECTè¯­å¥å®Œæ•´çš„æ‰§è¡Œæµç¨‹ã€‚</p><h2>SELECTè¯­å¥æ˜¯æ€ä¹ˆæ‰§è¡Œçš„ï¼Ÿ</h2><p>æˆ‘ä»¬ä»¥æœ€ç®€å•çš„ä¸€æ¡SQLä¸ºä¾‹ï¼Œæ¥è¯´æ˜SQLçš„æ‰§è¡Œæ­¥éª¤ã€‚æˆ‘ä»¬å‡å®šsrc_tabä½¿ç”¨InnoDBå­˜å‚¨å¼•æ“ã€‚</p><pre><code class=\"language-go\">select * from src_tab;\n</code></pre><p><img src=\"https://static001.geekbang.org/resource/image/1a/77/1a856f01500ff56c5cd75d93baebyy77.png?wh=1920x754\" alt=\"å›¾ç‰‡\"></p><p>SELECTè¯­å¥çš„å®Œæ•´æ‰§è¡Œæµç¨‹å¤§è‡´ä¸Šå¯ä»¥åˆ†ä¸ºä¸‹é¢è¿™å‡ ä¸ªæ­¥éª¤ï¼š</p><ol>\n<li>å®¢æˆ·ç«¯æäº¤SQLè¯­å¥ã€‚å®¢æˆ·ç«¯é©±åŠ¨ç¨‹åºå°†SQLè¯­å¥æ‰“åŒ…ï¼Œå‘é€ç»™æœåŠ¡å™¨ã€‚</li>\n<li>æ•°æ®åº“æœåŠ¡ç«¯æ¥æ”¶åˆ°å®¢æˆ·ç«¯å‘èµ·è¯·æ±‚ï¼Œè§£æSQLæ–‡æœ¬ï¼Œç”Ÿæˆæ‰§è¡Œè®¡åˆ’ï¼Œå¹¶å¼€å§‹æ‰§è¡ŒSQLè¯­å¥ã€‚æ‰§è¡Œæ—¶ï¼Œéœ€è¦åˆ°å­˜å‚¨å¼•æ“è·å–æ•°æ®ã€‚</li>\n<li>InnoDBå­˜å‚¨å¼•æ“ä¸­ï¼Œæ•°æ®å­˜æ”¾åœ¨æ•°æ®é¡µé¢ä¸­ï¼Œæ•°æ®é¡µç¼“å­˜åˆ°Buffer Poolä¸­ã€‚</li>\n<li>å¦‚æœæ•°æ®é¡µè¿˜æ²¡æœ‰ç¼“å­˜åˆ°Buffer Poolä¸­ï¼Œå°±éœ€è¦å‘èµ·IOæ“ä½œï¼Œä»æ–‡ä»¶ç³»ç»Ÿä¸­è¯»å–æ•´ä¸ªé¡µé¢è¿›è¡Œç¼“å­˜ã€‚</li>\n<li>æœ€ç»ˆInnoDBå­˜å‚¨å¼•æ“å°†ä¸€è¡Œæ•°æ®è¿”å›ç»™SQLå¼•æ“ã€‚</li>\n<li>SQLå¼•æ“å°†ä¸€è¡Œè®°å½•æ‰“åŒ…ï¼Œå‘é€ç»™å®¢æˆ·ç«¯ã€‚</li>\n<li>æ•°æ®åŒ…é€šè¿‡TCPåè®®ä¼ è¾“åˆ°å®¢æˆ·ç«¯ã€‚</li>\n<li>å®¢æˆ·ç«¯è¯»å–ç½‘ç»œåŒ…ï¼Œè§£æå‡ºä¸€è¡Œè®°å½•ã€‚</li>\n</ol><p>è¿™é‡Œéœ€è¦æ³¨æ„çš„æ˜¯ï¼ŒSQLå¼€å§‹æ‰§è¡Œåï¼ŒSQLå¼•æ“ä¼šæŒç»­ä»å­˜å‚¨å¼•æ“ä¸­è·å–æ•°æ®ï¼Œæ¯è¯»å–åˆ°ä¸€è¡Œè®°å½•ï¼Œå°±æŠŠè®°å½•é€šè¿‡ç½‘ç»œå‘é€ç»™å®¢æˆ·ç«¯ï¼Œç›´åˆ°æ‰€æœ‰çš„æ•°æ®éƒ½æŸ¥è¯¢å®Œæˆã€‚æ‰€æœ‰æ•°æ®éƒ½å‘é€å®Œæˆåï¼ŒæœåŠ¡ç«¯è¿˜è¦å‘é€ä¸€ä¸ªç»“æŸæ ‡è®°ï¼Œå‘Šè¯‰å®¢æˆ·ç«¯è¿™ä¸ªSQLçš„æ‰€æœ‰ç»“æœéƒ½å·²ç»å‘é€äº†ã€‚</p><h3>MySQLå®¢æˆ·ç«¯æœåŠ¡ç«¯äº¤äº’åè®®</h3><p>MySQLå®¢æˆ·ç«¯å’ŒæœåŠ¡ç«¯ä¹‹é—´çš„äº¤äº’éµå¾ªä¸€å®šçš„åè®®ï¼Œåè®®çš„åŸºæœ¬æ ¼å¼å¦‚ä¸‹å›¾æ‰€ç¤ºï¼š</p><p><img src=\"https://static001.geekbang.org/resource/image/b6/d7/b68682f2fff463f5a041d120b38c98d7.png?wh=1920x463\" alt=\"å›¾ç‰‡\"></p><p>lengthä¸º3ä¸ªå­—èŠ‚ï¼Œæ ‡è¯†åŒ…çš„é•¿åº¦ï¼Œä¸€ä¸ªåŒ…æœ€å¤§é•¿åº¦ä¸º16Mã€‚è¶…è¿‡16Mçš„éƒ¨åˆ†éœ€è¦æ‹†æˆå¤šä¸ªåŒ…ï¼Œseqæ˜¯åŒ…çš„åºå·ï¼Œpayloadæ˜¯å…·ä½“çš„åè®®æ•°æ®ã€‚å¯¹äºä¸€ä¸ªSELECTæŸ¥è¯¢è¯­å¥ï¼Œå®¢æˆ·ç«¯å‘é€çš„è¯·æ±‚åŒ…æ ¼å¼å¤§è‡´ä¸Šå°±æ˜¯ä¸‹é¢å›¾ç‰‡ä¸­å±•ç¤ºçš„è¿™æ ·ã€‚å…¶ä¸­commandæ˜¯å‘½ä»¤çš„ç±»å‹ï¼Œç›®å‰MySQLä¸­æ€»å…±å®šä¹‰äº†å‡ åç§ç±»å‹ï¼Œå¯¹äºæŸ¥è¯¢è¯­å¥ï¼Œcommandæ˜¯COM_QUERYã€‚</p><p><img src=\"https://static001.geekbang.org/resource/image/4c/b0/4c205d45ae2f946f38766e6c48e683b0.png?wh=1920x505\" alt=\"å›¾ç‰‡\"></p><p>æœåŠ¡ç«¯è¿”å›çš„åŒ…å¤§è‡´å¯ä»¥åˆ†ä¸ºä¸‰ç§ç±»å‹ã€‚</p><ul>\n<li>ç»“æœé›†</li>\n</ul><p>ç»“æœé›†æ•°æ®åŒ…ç”±å…ƒæ•°æ®ã€è¡Œè®°å½•ã€ç»“æŸæ ‡è®°è¿™å‡ éƒ¨åˆ†ç»„æˆã€‚å…ƒæ•°æ®å®é™…ä¸Šæ˜¯ä¸€ä¸ªå­—æ®µåˆ—è¡¨ï¼Œå‘Šè¯‰ä½ è¿”å›çš„æ•°æ®ç”±å“ªå‡ ä¸ªå­—æ®µç»„æˆã€‚è¡Œè®°å½•ä»æ•°æ®åº“ä¸­æŸ¥è¯¢å¾—åˆ°ï¼Œç»“æœé›†ä¸­å¯èƒ½åŒ…å«0è¡Œæˆ–å¤šè¡Œè®°å½•ï¼Œæ¯è¡Œè®°å½•ç”±å¤šä¸ªå­—æ®µç»„æˆã€‚</p><p><img src=\"https://static001.geekbang.org/resource/image/67/d4/67b21df1d7320d6d5186078995df86d4.png?wh=2698x568\" alt=\"\"></p><ul>\n<li>OK_Packet</li>\n</ul><p>OK_Packetæ ‡å¿—ç€ä¸€ä¸ªè¯­å¥çš„ç»“æŸï¼ŒåŒ…é‡Œé¢ä¹ŸåŒ…å«äº†ä¸€äº›é¢å¤–çš„ä¿¡æ¯ï¼Œæ¯”å¦‚SQLå½±å“äº†å¤šå°‘è¡Œæ•°æ®ï¼ŒSQLæ‰§è¡Œæ˜¯å¦æœ‰Warningã€‚</p><p><img src=\"https://static001.geekbang.org/resource/image/2f/e2/2f502d9bf4cc92b5e14bc4cc3b21aee2.png?wh=1920x441\" alt=\"å›¾ç‰‡\"></p><ul>\n<li>Err_Packet</li>\n</ul><p>å¦‚æœSQLæ‰§è¡Œè¿‡ç¨‹ä¸­å‡ºé”™äº†ï¼ŒæœåŠ¡ç«¯ä¼šè¿”å›ä¸€ä¸ªErr_Packetï¼ŒåŒ…æ‹¬é”™è¯¯ç¼–å·å’Œé”™è¯¯æ¶ˆæ¯ã€‚</p><p><img src=\"https://static001.geekbang.org/resource/image/34/1c/34a115365e5535e56c6a337b732f151c.png?wh=1920x481\" alt=\"å›¾ç‰‡\"></p><h3>SQLå¼•æ“çš„æ ¸å¿ƒé€»è¾‘</h3><p>MySQLä¼˜åŒ–å™¨ç”Ÿæˆçš„æ‰§è¡Œè®¡åˆ’ï¼Œäº¤ç»™SQLå¼•æ“æ‰§è¡Œã€‚SQLå¼•æ“çš„æ ¸å¿ƒæ˜¯ä¸€ä¸ªå¤§çš„å¾ªç¯ï¼Œæ ¹æ®æ‰§è¡Œè®¡åˆ’ä¸­çš„æ­¥éª¤ï¼Œä»è¡¨æˆ–ç´¢å¼•ä¸­è·å–æ•°æ®ã€‚åœ¨æœ€ç®€å•çš„æƒ…å†µä¸‹ï¼ŒæŸ¥è¯¢åªæ¶‰åŠä¸€ä¸ªè¡¨ï¼ŒSQLå¼•æ“è°ƒç”¨å­˜å‚¨å¼•æ“æ¥å£ï¼Œå¦‚æœæ­£å¸¸åœ°è·å–åˆ°äº†è®°å½•ï¼Œå°±æŠŠè®°å½•æ‰“åŒ…ï¼Œå‘é€ç»™å®¢æˆ·ç«¯ï¼Œç„¶åå†ç»§ç»­è°ƒç”¨å­˜å‚¨å¼•æ“æ¥å£ï¼Œè·å–ä¸‹ä¸€è¡Œè®°å½•ã€‚å¤„ç†å®Œæ‰€æœ‰è®°å½•åï¼Œå‘é€OK_Packetï¼Œå‘Šè¯‰å®¢æˆ·ç«¯æ‰€æœ‰æ•°æ®éƒ½å·²ç»å‘é€å®Œæˆã€‚</p><p><img src=\"https://static001.geekbang.org/resource/image/1d/d7/1df7a3cfd2c0be7e2dc43dd04e78f3d7.png?wh=1920x1224\" alt=\"å›¾ç‰‡\"></p><h3>å­˜å‚¨å¼•æ“æ¥å£</h3><p>SQLå¼•æ“è°ƒç”¨å­˜å‚¨å¼•æ“æ¥å£æ—¶ï¼Œæ¯æ¬¡è°ƒç”¨æœ€å¤šåªè·å–ä¸€è¡Œè®°å½•ï¼ŒSQLå¼•æ“ä¼šæä¾›ä¸€æ®µä¸´æ—¶å†…å­˜ç”¨æ¥å­˜æ”¾è¿™ä¸€è¡Œè®°å½•ã€‚å­˜å‚¨å¼•æ“è·å–åˆ°è®°å½•åï¼Œè¿›è¡Œå¿…è¦çš„æ ¼å¼è½¬æ¢åï¼Œå°†è®°å½•å†™åˆ°SQLå¼•æ“æä¾›çš„ä¸´æ—¶å†…å­˜ä¸­ã€‚</p><h3>å®¢æˆ·ç«¯è·å–æ•°æ®</h3><p>MySQLçš„å®¢æˆ·ç«¯é©±åŠ¨è·å–æ•°æ®æ—¶ï¼Œæœ‰ä¸¤ç§ä¸åŒçš„æ–¹å¼ã€‚ä¸€ç§æ–¹å¼æ˜¯å°†æ‰€æœ‰çš„è®°å½•éƒ½ç¼“å­˜åœ¨æœ¬åœ°å†…å­˜ä¸­ï¼Œç„¶åå†å°†ç»“æœé›†äº¤ç»™åº”ç”¨ç¨‹åºå¤„ç†ã€‚MySQL C APIä¸­ï¼Œmysql_store_resultå°±æ˜¯è¿™æ ·å¤„ç†SQLè¿”å›çš„æ•°æ®çš„ã€‚</p><p>è¿™ä¸€è®²å¼€å¤´çš„ä¾‹å­ä¸­ï¼Œcur.execute()è¿™ä¸€è¡Œä»£ç æ‰§è¡Œå®Œæˆåï¼ŒæœåŠ¡ç«¯å‘é€è¿‡æ¥çš„æ‰€æœ‰æ•°æ®å°±å·²ç»å…¨éƒ¨å­˜æ”¾åœ¨å®¢æˆ·ç«¯çš„å†…å­˜ä¸­äº†ã€‚åç»­å†æ‰§è¡Œcur.fetchone()æ—¶ï¼Œå®é™…ä¸Šåªæ˜¯ä»æœ¬åœ°ç¼“å­˜çš„ç»“æœé›†ä¸­å–æ•°æ®ã€‚æ‰€ä»¥å½“æºè¡¨çš„æ•°æ®é‡å¾ˆå¤§æ—¶ï¼Œç¨‹åºä¼šæ¶ˆè€—å¤§é‡çš„å†…å­˜ï¼Œç”šè‡³å¼•èµ·å†…å­˜æº¢å‡ºã€‚</p><pre><code class=\"language-go\">def copy_table(src_conn, dest_conn):\n    sql_select = 'select * from src_tab'\n    sql_insert = \"insert into dest_tab values(%s,%s,%s)\"\n    cur = src_conn.cursor()\n    cur.execute(sql_select)\n    row = cur.fetchone()\n    while row:\n        insert_row(dest_conn, sql_insert, row)\n        row = cur.fetchone()\n</code></pre><p>å®¢æˆ·ç«¯è¿˜æœ‰å¦å¤–ä¸€ç§å¤„ç†æ–¹å¼ï¼Œå¦‚æœä½ ä¸æƒ³ä¸€æ¬¡æ€§ç¼“å­˜æœåŠ¡ç«¯è¿”å›çš„æ‰€æœ‰è®°å½•ï¼Œå¯ä»¥è°ƒç”¨C API mysql_use_resultï¼Œè°ƒç”¨è¿™ä¸ªå‡½æ•°å¹¶ä¸ä¼šçœŸæ­£ä»ç½‘ç»œè¯»å–è®°å½•ï¼Œåªæ˜¯åˆå§‹åŒ–äº†ä¸€äº›æ•°æ®ç»“æ„ã€‚ä½ éœ€è¦è°ƒç”¨mysql_fetch_rowï¼Œæ¯è°ƒç”¨ä¸€æ¬¡å°±è·å–ä¸€è¡Œè®°å½•ï¼Œè¿™å°±æ˜¯æµå¼å¤„ç†ã€‚æˆ‘ä»¬ä»¥ä¸‹é¢è¿™æ®µPythonä»£ç ä¸ºä¾‹æ¥æ¼”ç¤ºæµå¼å¤„ç†ã€‚æ³¨æ„ä»£ç ä¸­ä½¿ç”¨äº†MySQLdb.cursors.SSCursorï¼Œè¿™æ ·å½“æ‰§è¡Œcur.execute()æ—¶ï¼Œä¸ä¼šä»ç½‘ç»œä¸­è¯»å–è®°å½•ï¼Œåªæœ‰åç»­æ‰§è¡Œcur.fetchone()çš„æ—¶å€™ï¼Œæ‰ä»ç½‘ç»œä¸­è¯»å–ä¸€è¡Œè®°å½•ã€‚</p><pre><code class=\"language-go\">&gt;&gt;&gt; import MySQLdb\n&gt;&gt;&gt; import MySQLdb.cursors\n&gt;&gt;&gt; import time\n\n&gt;&gt;&gt; conn = MySQLdb.connect(host='172.16.121.234',port=3306,user='user_01', passwd='somepass',db='src_db')\n&gt;&gt;&gt; cur = conn.cursor(cursorclass=MySQLdb.cursors.SSCursor)\n&gt;&gt;&gt; cur.execute('select * from tab3')\n18446744073709551615L\n\n&gt;&gt;&gt; row = cur.fetchone()\n</code></pre><p>å¦‚æœæˆ‘ä»¬ä½¿ç”¨tcpdumpå¯¹MySQLè¿›è¡ŒæŠ“åŒ…åˆ†æï¼Œä¼šå‘ç°æ‰§è¡Œcur.execute()è¿™ä¸€è¡Œä»£ç åï¼ŒæœåŠ¡ç«¯å‘å®¢æˆ·ç«¯å‘é€äº†ä¸€äº›æ•°æ®åå°±åœæ­¢å‘é€äº†ï¼Œè¿™ä¸ªæ—¶å€™å®¢æˆ·ç«¯çš„TCPæ¥æ”¶çª—å£ä¸º0ã€‚</p><pre><code class=\"language-go\">tcpdump -i any  port 3306 -t -nnnn\n</code></pre><p><img src=\"https://static001.geekbang.org/resource/image/fa/47/fa221e0184157ff091b34e0fcffb7b47.png?wh=1920x563\" alt=\"å›¾ç‰‡\"></p><p>å¦‚æœå®¢æˆ·ç«¯åœ¨net_write_timeoutè®¾ç½®çš„æ—¶é—´å†…éƒ½æ²¡æœ‰è¯»å–æ•°æ®ï¼ŒæœåŠ¡ç«¯çš„ç½‘ç»œå†™æ“ä½œä¼šè¶…æ—¶ï¼Œè¿™ä¸ªæ—¶å€™å®¢æˆ·ç«¯å¦‚æœå†æ¬¡è·å–æ•°æ®ï¼Œä¼šå‘ç°è¿æ¥å·²ç»è¢«æ–­å¼€äº†ã€‚</p><pre><code class=\"language-go\">&gt;&gt;&gt; time.sleep(60)\n&gt;&gt;&gt; row = cur.fetchone()\n&gt;&gt;&gt; while row:\n...     row = cur.fetchone()\n...\nException _mysql_exceptions.OperationalError: (2013, 'Lost connection to MySQL server during query')\n</code></pre><p>ä½¿ç”¨æµå¼å¤„ç†è¿˜æœ‰ä¸€ä¸ªå‰¯ä½œç”¨ï¼Œå°±æ˜¯æ‰§è¡Œä¸€ä¸ªSQLåï¼Œå¿…é¡»å…ˆå¤„ç†å®Œå½“å‰SQLè¿”å›çš„ç»“æœé›†ä¸­æ‰€æœ‰çš„è®°å½•ï¼Œæ‰èƒ½æ‰§è¡Œä¸‹ä¸€ä¸ªSQLï¼Œå¦åˆ™ä¼šæŠ¥é”™â€œCommands out of syncâ€ã€‚</p><pre><code class=\"language-go\">&gt;&gt;&gt; cur = conn.cursor(cursorclass=MySQLdb.cursors.SSCursor)\n&gt;&gt;&gt; cur.execute('select * from tab3')\n18446744073709551615L\n\n&gt;&gt;&gt; cur.execute('select 1')\n_mysql_exceptions.ProgrammingError: (2014, \"Commands out of sync; you can't run this command now\")\n</code></pre><p>å¦‚æœä½ ä½¿ç”¨äº†JDBCï¼Œé»˜è®¤çš„ç»“æœé›†å¤„ç†æ–¹å¼å’Œmysql_store_resultä¸€æ ·ï¼Œä¼šå°†æœåŠ¡ç«¯å‘é€çš„æ‰€æœ‰æ•°æ®éƒ½æ”¾åˆ°å†…å­˜ä¸­ï¼Œè¿™ä¹Ÿæ˜¯æˆ‘ä»¬ä»å‰é¢Heapdumpä¸­çœ‹åˆ°çš„é‚£æ ·ã€‚å¦‚æœç»“æœé›†å¤ªå¤§ï¼Œä½ ä¸æƒ³å°†æ‰€æœ‰è®°å½•éƒ½æ”¾åˆ°å†…å­˜ä¸­ï¼Œå¯ä»¥é‡‡ç”¨æµå¼å¤„ç†ï¼Œéœ€è¦åœ¨createStatementæ—¶ä¼ å…¥å‡ ä¸ªå‚æ•°ï¼Œå…·ä½“ä½¿ç”¨æ–¹æ³•ä½ å¯ä»¥å‚è€ƒ<a href=\"https://dev.mysql.com/doc/connector-j/en/connector-j-reference-implementation-notes.html\">å®˜æ–¹æ–‡æ¡£</a>ã€‚</p><pre><code class=\"language-go\">Statement stmt = conn.createStatement(java.sql.ResultSet.TYPE_FORWARD_ONLY,\n              java.sql.ResultSet.CONCUR_READ_ONLY);\nstmt.setFetchSize(Integer.MIN_VALUE);\n</code></pre><p>ä½¿ç”¨è¿™ç§æ–¹å¼æ‰§è¡Œå®Œä¸€ä¸ªSQLçš„æ—¶å€™ï¼Œéœ€è¦å°†å½“å‰çš„stmtå…³é—­åï¼Œæ‰èƒ½åˆ›å»ºä¸‹ä¸€ä¸ªStatementï¼Œå¦åˆ™ä¼šæŠ›å‡ºä¸‹é¢è¿™æ ·çš„å¼‚å¸¸ã€‚</p><pre><code class=\"language-go\">java.sql.SQLException: Streaming result set com.mysql.cj.protocol.a.result.ResultsetRowsStreaming@1e1a0406 is still active. No statements may be issued when any streaming result sets are open and in use on a given connection. Ensure that you have called .close() on any active streaming result sets before attempting more queries.\n</code></pre><p>æˆ‘ä»¬çœ‹åˆ°ï¼Œä¸ç®¡æ˜¯C APIè¿˜æ˜¯Java APIï¼Œåœ¨å¤„ç†ç»“æœé›†çš„æ—¶å€™ï¼Œé»˜è®¤è¡Œä¸ºéƒ½æ˜¯å°†æ•°æ®å…¨éƒ¨åŠ è½½åˆ°å†…å­˜ä¸­ã€‚å½“è¿”å›çš„è®°å½•æ•°ä¸å¤šæ—¶ï¼Œè¿™ç§å¤„ç†æ–¹å¼æ˜¯æ¯”è¾ƒåˆç†çš„ï¼Œå› ä¸ºè¿™æ ·å¯ä»¥å°½å¿«åœ°è·å–æ‰€æœ‰æ•°æ®ï¼Œè¿™æ ·åœ¨æœåŠ¡ç«¯ï¼ŒSQLä¹Ÿèƒ½åŠæ—¶å®Œæˆã€‚ä½†å¦‚æœç»“æœé›†å¤ªå¤§ï¼Œè¿™æ ·åšå°±å¯èƒ½ä¼šå¯¼è‡´å®¢æˆ·ç«¯å†…å­˜æº¢å‡ºï¼Œè¿™æ—¶ä½ å¯ä»¥ä½¿ç”¨æµå¼å¤„ç†ï¼Œä¸€æ¬¡åªè¯»å–ä¸€è¡Œè®°å½•ã€‚æœ‰ä¸€ç‚¹éœ€è¦æ³¨æ„ï¼Œè¯»å–è®°å½•åè¦å°½å¿«å®Œæˆä¸šåŠ¡å¤„ç†ï¼Œå¹¶åŠæ—¶è¯»å–ä¸‹ä¸€è¡Œè®°å½•ã€‚</p><p>æœåŠ¡ç«¯é€šè¿‡TCPåè®®å‘é€æ•°æ®ï¼Œè¿™äº›æ•°æ®ä¼šå…ˆè¿›å…¥åˆ°å®¢æˆ·ç«¯æ‰€åœ¨æœºå™¨çš„TCP Bufferä¸­ã€‚å¦‚æœå®¢æˆ·ç«¯æ²¡æœ‰åŠæ—¶å°†æ•°æ®ä»TCP Bufferä¸­å–èµ°ï¼ŒTCP Bufferå¾ˆå¿«å°±ä¼šç”¨å®Œï¼Œè¿™æ—¶å®¢æˆ·ç«¯å°±ä¼šå‘Šè¯‰æœåŠ¡ç«¯ï¼Œæˆ‘è¿™è¾¹TCP Bufferå·²ç»æ»¡äº†ï¼Œä½ å…ˆä¸è¦å‘é€æ•°æ®è¿‡æ¥äº†ã€‚è¿™å®é™…ä¸Šæ˜¯é€šè¿‡TCPåè®®ä¸­çš„Window Sizeæ¥å®ç°çš„ã€‚</p><p>å®¢æˆ·ç«¯TCPæ¥æ”¶çª—å£å¤§å°ä¸º0æ—¶ï¼ŒæœåŠ¡ç«¯å‘é€æ•°æ®æ—¶å°±ä¼šè¢«é˜»å¡ã€‚MySQLé€šè¿‡å‚æ•°net_write_timeoutæ¥è®¾ç½®ç½‘ç»œå‘é€è¶…æ—¶æ—¶é—´ï¼Œè¯¥å‚æ•°é»˜è®¤ä¸º60ç§’ã€‚å¦‚æœæœåŠ¡ç«¯å‘é€æ•°æ®æ—¶é˜»å¡æ—¶é—´è¶…è¿‡äº†è¿™ä¸ªè®¾ç½®ï¼Œå°±ä¼šå°†è¿æ¥æ–­å¼€ã€‚</p><h2>æ€»ç»“æ—¶åˆ»</h2><p>è¿™ä¸€è®²ä¸­ï¼Œæˆ‘ä»¬ä¸€èµ·å­¦ä¹ äº†MySQLå®¢æˆ·ç«¯å’ŒæœåŠ¡ç«¯çš„äº¤äº’è¿‡ç¨‹ï¼Œåˆ†æäº†MySQLå¤„ç†ç»“æœé›†çš„ä¸¤ç§æ–¹å¼ï¼Œä»¥åŠæŸ¥è¯¢å¤§è¡¨ä¸ºä»€ä¹ˆä¼šå¼•èµ·å®¢æˆ·ç«¯å†…å­˜æº¢å‡ºã€‚</p><p>å¯¹äºJavaç¨‹åºï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨Heapdumpåˆ†æï¼Œæ‰¾åˆ°è¿”å›å¤§é‡æ•°æ®çš„é‚£äº›SQLã€‚å¦‚æœä¸šåŠ¡ä¸­æœ‰SQLè¿”å›äº†å¤ªå¤šçš„æ•°æ®ï¼Œä¸€èˆ¬æˆ‘å»ºè®®å…ˆä»ä¸šåŠ¡ä¸Šè¿›è¡Œåˆ†æï¼Œä¸šåŠ¡æ˜¯å¦çœŸçš„éœ€è¦æŸ¥è¯¢è¿™ä¹ˆå¤šæ•°æ®ï¼Ÿæ˜¯ä¸æ˜¯å¯ä»¥å°†SQLæ”¹å†™æˆåˆ†é¡µçš„æ–¹å¼ï¼Œä¸€æ¬¡åªæŸ¥è¯¢ä¸€éƒ¨åˆ†æ•°æ®ï¼Ÿ</p><p>å¦‚æœä½ çš„åº”ç”¨åœºæ™¯å°±æ˜¯éœ€è¦æŸ¥è¯¢å¤§é‡çš„æ•°æ®ï¼Œä¹Ÿä¸æ–¹ä¾¿ä½¿ç”¨åˆ†é¡µSQLï¼Œæ¯”å¦‚ä½ å¯èƒ½åœ¨å†™ä¸€ä¸ªç±»ä¼¼mysqldumpçš„æ•°æ®å¯¼å‡ºå·¥å…·ï¼Œå¯ä»¥é‡‡ç”¨æµå¼å¤„ç†ã€‚ä¸è¿‡é‡‡ç”¨æµå¼å¤„ç†æ—¶ï¼Œéœ€è¦å°½å¿«å°†æ•°æ®ä»TCP Bufferä¸­å–å‡ºï¼Œå¦åˆ™ä¼šå¯¼è‡´æœåŠ¡ç«¯å‘é€æ•°æ®è¢«é˜»å¡ï¼Œå¦‚æœé˜»å¡æ—¶é—´è¶…è¿‡net_write_timeoutï¼Œè¿˜ä¼šå¯¼è‡´è¿æ¥ä¸­æ–­ã€‚å³ä½¿è¿æ¥æ²¡æœ‰ä¸­æ–­ï¼Œä¹Ÿä¼šå¯¼è‡´æœåŠ¡ç«¯å‘é€æ•°æ®çš„æ•ˆç‡é™ä½ï¼Œå¢åŠ SQLçš„æ‰§è¡Œæ—¶é—´ï¼Œå¦‚æœSQLè¿˜æŒæœ‰é”ï¼Œè¿™ä¼šå¼•èµ·æ›´å¤§çš„æ€§èƒ½é—®é¢˜ã€‚</p><h2>æ€è€ƒé¢˜</h2><p>æºåº“ä¸­æœ‰ä¸€ä¸ªå¤§è¡¨ï¼Œè¡¨ç»“æ„å®šä¹‰å¦‚ä¸‹ï¼š</p><pre><code class=\"language-go\">create table big_table(\n    col1 varchar(32) not null,\n    col2 varchar(32) not null,\n    col3 varchar(32) not null,\n    col4 varchar(256),\n    col5 varchar(256),\n    ....\n    col10 varchar(512),\n    primary key(col1, col2, col3)\n) engine=innodb;\n</code></pre><p>è¿™ä¸ªè¡¨æ€»å…±æœ‰3000ä¸‡è¡Œæ•°æ®ï¼Œå¹³å‡è¡Œé•¿åº¦å¤§çº¦ä¸º2Kã€‚ç°åœ¨éœ€è¦å°†è¿™ä¸ªè¡¨å¤åˆ¶åˆ°ç›®æ ‡åº“ã€‚æºåº“å’Œç›®æ ‡åº“éƒ½æ˜¯MySQLã€‚æœ‰ä¸€å°4æ ¸8Gçš„ä¸­è½¬æœºå™¨ä¾›ä½ ä½¿ç”¨ã€‚è¯·é—®ä½ ä¼šæ€ä¹ˆè§£å†³è¿™ä¸ªéœ€æ±‚ï¼Ÿå¦‚æœè¦ä½ å†™ä¸€æ®µç¨‹åºæ¥å®Œæˆè¿™ä¸ªä»»åŠ¡ï¼Œéœ€è¦æ³¨æ„ä»€ä¹ˆï¼Ÿå¦‚ä½•æé«˜æ•°æ®å¤åˆ¶çš„é€Ÿåº¦ï¼Ÿ</p><p>æœŸå¾…ä½ çš„æ€è€ƒï¼Œæ¬¢è¿åœ¨ç•™è¨€åŒºä¸­ä¸æˆ‘äº¤æµã€‚å¦‚æœä»Šå¤©çš„è¯¾ç¨‹è®©ä½ æœ‰æ‰€æ”¶è·ï¼Œä¹Ÿæ¬¢è¿è½¬å‘ç»™æœ‰éœ€è¦çš„æœ‹å‹ã€‚æˆ‘ä»¬ä¸‹èŠ‚è¯¾å†è§ï¼</p>","neighbors":{"left":{"article_title":"07ï½œä¹±ç æ˜¯æ€ä¹ˆäº§ç”Ÿçš„ï¼Œä»¥åŠå¦‚ä½•é¿å…ï¼Ÿ","id":804947},"right":{"article_title":"09ï½œMySQLå¦‚ä½•å¿«é€Ÿå¯¼å…¥å¯¼å‡ºæ•°æ®ï¼Ÿï¼ˆä¸Šï¼‰","id":804980}},"comments":[{"had_liked":false,"id":394433,"user_name":"TheOne","can_delete":false,"product_type":"c1","uid":1582134,"ip_address":"åŒ—äº¬","ucode":"2A359780156A8B","user_header":"https://static001.geekbang.org/account/avatar/00/18/24/36/0829cbdc.jpg","comment_is_top":false,"comment_ctime":1726795465,"is_pvip":false,"replies":[{"id":143205,"content":"é€»è¾‘ä¸Šçœ‹ï¼Œserverç«¯æ˜¯å¤„ç†å®Œä¸€è¡Œè®°å½•ï¼Œå°±å‘é€ä¸€è¡Œè®°å½•ã€‚åœ¨å®ç°ä¸Šï¼Œserverç«¯æœ‰ä¸€ä¸ªç½‘ç»œç¼“å­˜ï¼ˆå¤§å°ç”±å‚æ•°net_buffer_lengthæŒ‡å®šï¼‰ï¼Œbufferå¡«å……æ»¡äº†å†é€šè¿‡TCPå‘é€ç»™å®¢æˆ·ç«¯ã€‚\n\næ‰€ä»¥è¯´serviceå±‚å…ˆæš‚å­˜èµ·æ¥ä¹Ÿæ˜¯å¯¹çš„ï¼Œæ¯”è¾ƒç²¾ç¡®ã€‚ğŸ‘ğŸ‘","user_name":"ä½œè€…å›å¤","user_name_real":"ç¼–è¾‘","uid":3898827,"ctime":1727055466,"ip_address":"æµ™æ±Ÿ","comment_id":394433,"utype":1}],"discussion_count":1,"race_medal":0,"score":2,"product_id":100799401,"comment_content":"è€å¸ˆï¼Œmysql çš„å®¢æˆ·ç«¯å’ŒæœåŠ¡ç«¯ä¹‹é—´ä¹Ÿæ˜¯ tcp è¿æ¥çš„å§ï¼Œå­˜å‚¨å¼•æ“æ‹¿åˆ°ä¸€è¡Œåï¼Œç»™åˆ° service å±‚ï¼Œservice åº”è¯¥ä¼šå…ˆæš‚å­˜èµ·æ¥ï¼Œè¾¾åˆ°ä¸€ä¸ªé˜ˆå€¼ä¹‹åï¼Œä¸€èµ·å‘ç»™å®¢æˆ·ç«¯å§\n\nåº”è¯¥ä¸æ˜¯å­˜å‚¨å¼•æ“è¿”å›ä¸€è¡Œï¼Œå°±ç»™å®¢æˆ·ç«¯å‘ä¸€è¡Œå§","like_count":2,"discussions":[{"author":{"id":3898827,"avatar":"https://static001.geekbang.org/account/avatar/00/3b/7d/cb/fa3dae58.jpg","nickname":"ä¿Šè¾¾","note":"","ucode":"F79BF9651AD086","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":651542,"discussion_content":"é€»è¾‘ä¸Šçœ‹ï¼Œserverç«¯æ˜¯å¤„ç†å®Œä¸€è¡Œè®°å½•ï¼Œå°±å‘é€ä¸€è¡Œè®°å½•ã€‚åœ¨å®ç°ä¸Šï¼Œserverç«¯æœ‰ä¸€ä¸ªç½‘ç»œç¼“å­˜ï¼ˆå¤§å°ç”±å‚æ•°net_buffer_lengthæŒ‡å®šï¼‰ï¼Œbufferå¡«å……æ»¡äº†å†é€šè¿‡TCPå‘é€ç»™å®¢æˆ·ç«¯ã€‚\n\næ‰€ä»¥è¯´serviceå±‚å…ˆæš‚å­˜èµ·æ¥ä¹Ÿæ˜¯å¯¹çš„ï¼Œæ¯”è¾ƒç²¾ç¡®ã€‚ğŸ‘ğŸ‘","likes_number":1,"is_delete":false,"is_hidden":false,"ctime":1727055467,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"æµ™æ±Ÿ","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2,\"source\":0}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":394692,"user_name":"Geek_e5f2f5","can_delete":false,"product_type":"c1","uid":2997459,"ip_address":"åŒ—äº¬","ucode":"ED160E1D56DB40","user_header":"https://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTIpF5euTNx3GAoUaONzbxsg8MgVlwvnxZtAXsVGQPZSiamicibrcvvVIIBvkHskXsxX4icibAqCdfbiblJQ/132","comment_is_top":false,"comment_ctime":1727621477,"is_pvip":false,"replies":[{"id":143284,"content":"MySQL Serverç«¯å’Œå­˜å‚¨å¼•æ“ä¹‹é—´ï¼Œä»¥ä¸€è¡Œæ•°æ®ä¸ºå•ä½ï¼Œè¿›è¡Œäº¤äº’ã€‚handleræ¥å£ä¸Šå°±æ˜¯è¿™ä¹ˆè®¾è®¡çš„å§ã€‚","user_name":"ä½œè€…å›å¤","user_name_real":"ç¼–è¾‘","uid":3898827,"ctime":1727686749,"ip_address":"æµ™æ±Ÿ","comment_id":394692,"utype":1}],"discussion_count":1,"race_medal":0,"score":2,"product_id":100799401,"comment_content":"ä¸ºå•¥è°ƒç”¨å¼•æ“æ¥å£æ—¶ï¼Œæœ€å¤šåªèƒ½æŸ¥è¯¢å‡ºä¸€è¡Œæ•°æ®å‘€ï¼Ÿä¸€æ¬¡æŸ¥è¯¢å‡ºå¤šä¸ªæ•°æ®æ˜¾ç„¶æ•ˆç‡æ›´å¥½å‘€","like_count":0,"discussions":[{"author":{"id":3898827,"avatar":"https://static001.geekbang.org/account/avatar/00/3b/7d/cb/fa3dae58.jpg","nickname":"ä¿Šè¾¾","note":"","ucode":"F79BF9651AD086","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":651906,"discussion_content":"MySQL Serverç«¯å’Œå­˜å‚¨å¼•æ“ä¹‹é—´ï¼Œä»¥ä¸€è¡Œæ•°æ®ä¸ºå•ä½ï¼Œè¿›è¡Œäº¤äº’ã€‚handleræ¥å£ä¸Šå°±æ˜¯è¿™ä¹ˆè®¾è®¡çš„å§ã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1727686749,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"æµ™æ±Ÿ","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2,\"source\":0}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":394043,"user_name":"dream","can_delete":false,"product_type":"c1","uid":1117793,"ip_address":"é‡åº†","ucode":"65B33D32FA8BE9","user_header":"https://static001.geekbang.org/account/avatar/00/11/0e/61/ae68f8eb.jpg","comment_is_top":false,"comment_ctime":1725612701,"is_pvip":false,"replies":[{"id":143068,"content":"æ˜¯çš„ï¼Œå‘½ä»¤é‡å¤ç²˜è´´äº†ã€‚è°¢è°¢æŒ‡æ­£ã€‚","user_name":"ä½œè€…å›å¤","user_name_real":"ç¼–è¾‘","uid":3898827,"ctime":1725862963,"ip_address":"æµ™æ±Ÿ","comment_id":394043,"utype":1}],"discussion_count":1,"race_medal":0,"score":2,"product_id":100799401,"comment_content":"æ–‡ç« ä¸­çš„æŠ“åŒ…å‘½ä»¤ `tcpdump -i any  port 3306 -t -nnnntcpdump -i any  port 3306 -t -nnnn` åº”è¯¥ç²˜è´´äº†ä¸¤æ¬¡...\n\nå®é™…ä¸Šçš„æŠ“åŒ…å‘½ä»¤åº”è¯¥æ˜¯:    tcpdump -i any port 3306 -t -nnnn","like_count":0,"discussions":[{"author":{"id":3898827,"avatar":"https://static001.geekbang.org/account/avatar/00/3b/7d/cb/fa3dae58.jpg","nickname":"ä¿Šè¾¾","note":"","ucode":"F79BF9651AD086","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":650908,"discussion_content":"æ˜¯çš„ï¼Œå‘½ä»¤é‡å¤ç²˜è´´äº†ã€‚è°¢è°¢æŒ‡æ­£ã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1725862964,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"æµ™æ±Ÿ","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2,\"source\":0}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":394041,"user_name":"dream","can_delete":false,"product_type":"c1","uid":1117793,"ip_address":"é‡åº†","ucode":"65B33D32FA8BE9","user_header":"https://static001.geekbang.org/account/avatar/00/11/0e/61/ae68f8eb.jpg","comment_is_top":false,"comment_ctime":1725608127,"is_pvip":false,"replies":[{"id":143043,"content":"è¿™ä¸ªæ–¹æ³•åº”è¯¥æ˜¯å¯è¡Œçš„ã€‚\nä¸è¿‡ 3G &#47; 2K åº”è¯¥æœ‰150å¤šä¸‡ã€‚","user_name":"ä½œè€…å›å¤","user_name_real":"ç¼–è¾‘","uid":3898827,"ctime":1725616276,"ip_address":"æµ™æ±Ÿ","comment_id":394041,"utype":1}],"discussion_count":1,"race_medal":0,"score":2,"product_id":100799401,"comment_content":"æ€è€ƒé¢˜:\n\næ¯”å¦‚ç”¨ä¸€ä¸ª java ç¨‹åºæ¥å¤„ç†ã€‚\n\nä¸€ä¸ªçº¿ç¨‹ä»æºè¡¨è¯»å–æ•°æ®(ä½¿ç”¨ jdbc æµå¼è¯»å–)ï¼Œè¯»å–å‡ºæ¥çš„æ•°æ®ä¿å­˜åˆ°æœ¬åœ°çš„ä¸€ä¸ªçº¿ç¨‹å®‰å…¨çš„é˜Ÿåˆ—ä¸­ï¼Œ8G çš„æœºå™¨ï¼Œå¤§æ¦‚å¯ä»¥æ‹¿å‡º 3g æ¥å­˜å‚¨ï¼Œä¹Ÿå°±æ˜¯ 3g&#47;2kï¼Œå¤§æ¦‚å¯ä»¥å­˜å‚¨ 1500 æ¡æ•°æ®ï¼Œä¹Ÿå°±æ˜¯ä¿è¯é˜Ÿåˆ—é•¿åº¦æœ€å¤§ä¸è¦è¶…è¿‡ 1500ã€‚\n\nå¦å¤–å¯åŠ¨ä¸‰ä¸ªçº¿ç¨‹ï¼Œä»æœ¬åœ°é˜Ÿåˆ—ä¸­æ¶ˆè´¹æ•°æ®ï¼Œä»»æ„ä¸€ä¸ªçº¿ç¨‹æ¶ˆè´¹æ»¡ 1000 æ¡ï¼Œå°±å¾€ç›®æ ‡æ•°æ®åº“è¿›è¡Œæ‰¹é‡å†™æ“ä½œã€‚\n\nåœ¨è¯»çº¿ç¨‹å®Œæˆåï¼Œç”¨ä¸€ä¸ªå˜é‡æ ‡è¯†ä¸€ä¸‹ï¼Œå†™çº¿ç¨‹ä»æœ¬åœ°é˜Ÿåˆ—ä¸­æ¶ˆè´¹ä¸åˆ°æ•°æ®å°±ç›´æ¥å†™æ•°æ®åº“ã€‚\n\n***\n\nå¦‚æœä¸Šé¢çš„åˆ†æä¸­ï¼Œæ‰¹é‡å†™æ¯”è¯»çš„é€Ÿåº¦æ›´å¿«ï¼Œå¯ä»¥è€ƒè™‘ç”¨ä¸¤ä¸ªçº¿ç¨‹æ¥è¯»ï¼Œä¸¤ä¸ªçº¿ç¨‹æ¥å†™ã€‚\n\nå…·ä½“æ“ä½œè¿˜æ˜¯å’Œä¸Šé¢ä¸€è‡´ï¼Œä½†æ˜¯è¯»å–çš„æ—¶å€™å°è¯•æŠŠ sql ä¸­çš„æ¡ä»¶æŒ‰ç…§ä¸»é”®åˆ†æˆå°½é‡ç›¸ç­‰çš„ä¸¤éƒ¨åˆ†ï¼Œä¸€ä¸ªçº¿ç¨‹è¯»å–ä¸€éƒ¨åˆ†","like_count":0,"discussions":[{"author":{"id":3898827,"avatar":"https://static001.geekbang.org/account/avatar/00/3b/7d/cb/fa3dae58.jpg","nickname":"ä¿Šè¾¾","note":"","ucode":"F79BF9651AD086","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":650792,"discussion_content":"è¿™ä¸ªæ–¹æ³•åº”è¯¥æ˜¯å¯è¡Œçš„ã€‚\nä¸è¿‡ 3G / 2K åº”è¯¥æœ‰150å¤šä¸‡ã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1725616276,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"æµ™æ±Ÿ","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2,\"source\":0}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":394016,"user_name":"ä¸€æœ¬ä¹¦","can_delete":false,"product_type":"c1","uid":2767251,"ip_address":"æ¹–åŒ—","ucode":"4C07047F052BB4","user_header":"https://static001.geekbang.org/account/avatar/00/2a/39/93/f0247cf8.jpg","comment_is_top":false,"comment_ctime":1725552359,"is_pvip":true,"replies":[{"id":143040,"content":"åº”è¯¥æ˜¯EOF_Packetè¢«åºŸå¼ƒäº†ã€‚\n\næŒ‰æ–‡æ¡£çš„æè¿°ï¼ŒOK_Packet headerè®¾ç½®ä¸ºFEæ—¶è¡¨ç¤ºEOFã€‚\nThese rules distinguish whether the packet represents OK or EOF:\nOK: header = 0 and length of packet &gt; 7\nEOF: header = 0xfe and length of packet &lt; 9\n\nä¹Ÿå¯ä»¥ä½¿ç”¨gdbï¼Œåœ¨net_send_okå’Œnet_send_eofä¸Šè®¾ç½®æ–­ç‚¹ï¼Œæˆ‘æµ‹è¯•ä¸‹æ¥ï¼Œè¯­å¥ç»“æŸæ—¶è°ƒç”¨çš„æ˜¯net_send_okã€‚\n\nå¦å¤–è¿˜å¯ä»¥å°è¯•ç”¨wiresharkåˆ†æä¸€ä¸‹åŒ…çš„æ ¼å¼ã€‚","user_name":"ä½œè€…å›å¤","user_name_real":"ç¼–è¾‘","uid":3898827,"ctime":1725615473,"ip_address":"æµ™æ±Ÿ","comment_id":394016,"utype":1}],"discussion_count":1,"race_medal":0,"score":2,"product_id":100799401,"comment_content":"https:&#47;&#47;dev.mysql.com&#47;doc&#47;dev&#47;mysql-server&#47;latest&#47;page_protocol_basic_ok_packet.htmlä¸­æœ‰As of MySQL 5.7.5, OK packets are also used to indicate EOF, and EOF packets are deprecated.ï¼Œhttps:&#47;&#47;dev.mysql.com&#47;doc&#47;dev&#47;mysql-server&#47;latest&#47;page_protocol_basic_eof_packet.htmlä¸­æœ‰Due to changes in MySQL 5.7 in the OK_Packet packets (such as session state tracking), and to avoid repeating the changes in the EOF_Packet packet, the OK_Packet is deprecated as of MySQL 5.7.5.ï¼Œåˆ°åº•å“ªä¸ªè¢«åºŸå¼ƒäº†å‘¢ï¼Ÿï¼ˆæå®¢æ—¶é—´ä¸èƒ½åˆ é™¤ç•™è¨€é‡æ–°ç¼–è¾‘ï¼Œæ²¡å®Œå…¨æƒ³å¥½å†é—®ï¼Œæœ‰ç‚¹æ‰“æ‰°è€å¸ˆäº†ä¸å¥½æ„æ€ï¼‰","like_count":0,"discussions":[{"author":{"id":3898827,"avatar":"https://static001.geekbang.org/account/avatar/00/3b/7d/cb/fa3dae58.jpg","nickname":"ä¿Šè¾¾","note":"","ucode":"F79BF9651AD086","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":650789,"discussion_content":"åº”è¯¥æ˜¯EOF_Packetè¢«åºŸå¼ƒäº†ã€‚\n\næŒ‰æ–‡æ¡£çš„æè¿°ï¼ŒOK_Packet headerè®¾ç½®ä¸ºFEæ—¶è¡¨ç¤ºEOFã€‚\nThese rules distinguish whether the packet represents OK or EOF:\nOK: header = 0 and length of packet &gt; 7\nEOF: header = 0xfe and length of packet &lt; 9\n\nä¹Ÿå¯ä»¥ä½¿ç”¨gdbï¼Œåœ¨net_send_okå’Œnet_send_eofä¸Šè®¾ç½®æ–­ç‚¹ï¼Œæˆ‘æµ‹è¯•ä¸‹æ¥ï¼Œè¯­å¥ç»“æŸæ—¶è°ƒç”¨çš„æ˜¯net_send_okã€‚\n\nå¦å¤–è¿˜å¯ä»¥å°è¯•ç”¨wiresharkåˆ†æä¸€ä¸‹åŒ…çš„æ ¼å¼ã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1725615473,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"æµ™æ±Ÿ","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2,\"source\":0}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":394008,"user_name":"123","can_delete":false,"product_type":"c1","uid":2662872,"ip_address":"æµ™æ±Ÿ","ucode":"5A343B568B9524","user_header":"https://static001.geekbang.org/account/avatar/00/28/a1/d8/42252c48.jpg","comment_is_top":false,"comment_ctime":1725528111,"is_pvip":false,"replies":[{"id":143044,"content":"åˆ†æ‰¹å¤„ç†æ˜¯ä¸€ä¸ªå¾ˆå¥½çš„æ–¹æ³•ã€‚\n\nçº æ­£ä¸€ç‚¹ï¼Œæµå¼å¤„ç†æ—¶ï¼ŒæœåŠ¡ç«¯å¹¶ä¸éœ€è¦æ‰¿è½½é¢å¤–çš„å†…å­˜ã€‚ä¸ç®¡å®¢æˆ·ç«¯ç”¨å“ªç§æ–¹å¼ï¼Œæ•°æ®éƒ½ä¼šå…ˆç¼“å­˜åˆ°InnoDB Bufferä¸­ï¼ŒæœåŠ¡ç«¯ä»buffer pageä¸­è§£æè¡Œè®°å½•ï¼Œè§£æä¸€è¡Œï¼Œå‘é€ä¸€è¡Œï¼Œä¸éœ€è¦åœ¨æœåŠ¡ç«¯æŠŠæ‰€æœ‰çš„è®°å½•ç¼“å­˜åœ¨å¦å¤–çš„åœ°æ–¹ã€‚\n","user_name":"ä½œè€…å›å¤","user_name_real":"ç¼–è¾‘","uid":3898827,"ctime":1725616550,"ip_address":"æµ™æ±Ÿ","comment_id":394008,"utype":1}],"discussion_count":1,"race_medal":0,"score":2,"product_id":100799401,"comment_content":"æ€è€ƒé¢˜ï¼š\n3000 ä¸‡è¡Œæ•°æ®ï¼Œå¹³å‡è¡Œé•¿åº¦å¤§çº¦ä¸º2K =&gt; 2k*3000w â‰ˆ 57Gï¼Œæ‰€ä»¥è‚¯å®šæ˜¯éœ€è¦è¿›è¡Œåˆ†æ‰¹è·å–å­˜å‚¨çš„\n\nå¦‚æœä½¿ç”¨æµå¼è·å–ï¼Œåœ¨å®¢æˆ·ç«¯ä¸ä¼šæœ‰å¤ªå¤§çš„å‹åŠ›ï¼Œä½†æ˜¯æ•°æ®é‡è¿‡å¤§ï¼ŒæœåŠ¡ç«¯éœ€è¦æ‰¿è½½è¿™äº›å†…å­˜ä½¿ç”¨ï¼Œå†µä¸”å½“å‰è¿æ¥ä¸èƒ½æ–­å¼€ï¼Œåˆå› ä¸ºæ•°æ®é‡å¤§ï¼Œå¯èƒ½é€ æˆè¶…æ—¶ï¼Œéœ€è¦é…ç½®ä¸‹å¯¹åº”çš„è¿æ¥æ—¶é—´ï¼›\n\nä½¿ç”¨é»˜è®¤é…ç½®ï¼Œå°±éœ€è¦æŒæ¡å¥½æ•°æ®é‡ï¼Œæ¯æ¬¡è·å–å¤šå°‘æ¡ï¼Œä¸èƒ½å°†å†…å­˜æ‰“æ»¡ã€‚é€šè¿‡å¤šçº¿ç¨‹å¹¶è®¾ç½®å¥½åç§»é‡çš„æ–¹å¼æ¥ä¿è¯æ•°æ®ä¸ä¼šè¢«é‡å¤æ’å…¥ï¼Œä¾‹å¦‚æ‰¹é‡ä¸€æ¬¡æ’å…¥50000æ¡ï¼Œå¤šçº¿ç¨‹å¹¶è¡Œæ’å…¥ã€‚ä½†æ˜¯æ‰¹é‡æ’å…¥çš„å€¼ä¸èƒ½è®¾ç½®çš„å¤ªå°ï¼Œä¸ç„¶å°±æ²¡æœ‰æ„ä¹‰ï¼Œè¿˜æ˜¯è¦æ‰¿æ‹…ç½‘ç»œã€äº‹åŠ¡æäº¤ã€ç´¢å¼•æ›´æ–°ç­‰å¼€é”€ã€‚æœ€ç»ˆè¿˜æ˜¯è¦æ ¹æ®ç›®æ ‡åº“çš„å†™èƒ½åŠ›æ¥å†³å®šï¼Œå¯ä»¥æµ‹è¯•ä¸‹ç›®æ ‡åº“å¯¹åº”çš„å†™å…¥æ€§èƒ½ï¼Œåœ¨å†³å®šå¹¶å‘æ’å…¥å¤šå°‘æ¡åˆé€‚ã€‚","like_count":0,"discussions":[{"author":{"id":3898827,"avatar":"https://static001.geekbang.org/account/avatar/00/3b/7d/cb/fa3dae58.jpg","nickname":"ä¿Šè¾¾","note":"","ucode":"F79BF9651AD086","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":650793,"discussion_content":"åˆ†æ‰¹å¤„ç†æ˜¯ä¸€ä¸ªå¾ˆå¥½çš„æ–¹æ³•ã€‚\n\nçº æ­£ä¸€ç‚¹ï¼Œæµå¼å¤„ç†æ—¶ï¼ŒæœåŠ¡ç«¯å¹¶ä¸éœ€è¦æ‰¿è½½é¢å¤–çš„å†…å­˜ã€‚ä¸ç®¡å®¢æˆ·ç«¯ç”¨å“ªç§æ–¹å¼ï¼Œæ•°æ®éƒ½ä¼šå…ˆç¼“å­˜åˆ°InnoDB Bufferä¸­ï¼ŒæœåŠ¡ç«¯ä»buffer pageä¸­è§£æè¡Œè®°å½•ï¼Œè§£æä¸€è¡Œï¼Œå‘é€ä¸€è¡Œï¼Œä¸éœ€è¦åœ¨æœåŠ¡ç«¯æŠŠæ‰€æœ‰çš„è®°å½•ç¼“å­˜åœ¨å¦å¤–çš„åœ°æ–¹ã€‚\n","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1725616550,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"æµ™æ±Ÿ","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2,\"source\":0}","child_discussion_number":0,"child_discussions":[]}]}]}