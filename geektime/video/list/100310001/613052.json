{"id":613052,"title":"53｜小试牛刀：如何利用函数实现电商购物车功能？","content":"<p><strong>课后习题</strong><br>\n请你继续完善购物车程序，新建另一个列表，按要求实现库存功能：</p><ul>\n<li>当某个商品被添加进购物车时，该商品库存减少。</li>\n<li>当某个商品在购物车中减少数量时，该商品库存增加。</li>\n<li>当商品库存为 0 时，不再允许增加购物车中该商品数量。</li>\n</ul><p><strong>课程代码、课件及其他相关资料地址</strong><br>\n<a href=\"https://gitee.com/wilsonyin/zero-basics-python\">https://gitee.com/wilsonyin/zero-basics-python</a></p>","comments":[{"had_liked":false,"id":393250,"user_name":"流云箴逝水","can_delete":false,"product_type":"c3","uid":1383402,"ip_address":"福建","ucode":"CF34A0B046B75D","user_header":"https://static001.geekbang.org/account/avatar/00/15/1b/ea/c065fda1.jpg","comment_is_top":false,"comment_ctime":1723282010,"is_pvip":false,"replies":[{"id":143109,"content":"是的， 我提供一份学员优秀代码，供你参考\nhttps:&#47;&#47;gitee.com&#47;wilsonyin&#47;zero-basics-python&#47;blob&#47;master&#47;%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99&#47;53.py","user_name":"作者回复","user_name_real":"编辑","uid":1056235,"ctime":1726220938,"ip_address":"广东","comment_id":393250,"utype":1}],"discussion_count":1,"race_medal":0,"score":2,"product_id":100310001,"comment_content":"购物车代码在哪里？是需要手打吗","like_count":0,"discussions":[{"author":{"id":1056235,"avatar":"https://static001.geekbang.org/account/avatar/00/10/1d/eb/b2123759.jpg","nickname":"尹会生","note":"","ucode":"D1093DBD093617","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":651106,"discussion_content":"是的， 我提供一份学员优秀代码，供你参考\nhttps://gitee.com/wilsonyin/zero-basics-python/blob/master/%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/53.py","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1726220939,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"广东","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2,\"source\":0}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":367711,"user_name":"yanyu-xin","can_delete":false,"product_type":"c3","uid":1899757,"ip_address":"广东","ucode":"3AA389F9E4C236","user_header":"","comment_is_top":false,"comment_ctime":1675492516,"is_pvip":false,"replies":null,"discussion_count":0,"race_medal":0,"score":2,"product_id":100310001,"comment_content":"# 库存: {商品1编码：[数量，库存位置编码1]}\nstocks = {1000:[6, 1234], \n          1001:[3, 2345],\n          1002:[20,1356]}  \n\ndef clean_Cart():\n    &quot;&quot;&quot; 清空购物车&quot;&quot;&quot;\n    for product_id, p_num in cart.items(): \n        cart_stocks(p_id, p_num) # 购物车放回库存\n    cart.clear() # 清空购物车\n    return\n\ndef cart_stocks(p_id, p_num):\n    &quot;&quot;&quot; 购物车商品返回库存&quot;&quot;&quot;\n    for i in range(p_num) : \n        stocks_add(p_id)\n    return\n\ndef stocks_del(p_id):\n    &quot;&quot;&quot; 库存减少一件商品&quot;&quot;&quot;\n    stocks[p_id][0] -= 1 \n    return\n\ndef stocks_add(p_id):\n    &quot;&quot;&quot; 库存增加一件商品&quot;&quot;&quot;\n    if p_id in stocks : # 库存有\n        stocks[p_id][0] += 1\n    else : # 库存没\n        iof = [1, 4567] # 新入库商品数量为1，存放位置编码4567\n        stocks.setdefault(p_id,iof)\n    return\n\ndef stocks_produce(p_id,p_num) :\n    &quot;&quot;&quot; 当商品库存为0,或不存在,返回False&quot;&quot;&quot;\n        if p_id in stocks: # 库存有\n        num1 = stocks[p_id][0]\n        if (num1 &lt; p_num) or (num1 == 0) :  # 库存数量对否\n            return False\n        return True # 有库存，数量足够\n    else : # 库存资料没有找到\n        return False\n\ndef add_Products(p_id,p_num):\n    &quot;&quot;&quot; 购物车增加产品，库存减少产品 &quot;&quot;&quot;\n    if stocks_produce(p_id,p_num) : # 判断准备减少的库存商品、数量是否正确\n        for product in range(p_num): # 逐一增加减少\n            addProduct(p_id) # 购物车增加一件\n            stocks_del(p_id) # 库存减少一件\n    else:\n        print(f&#39;减少库存的商品出错。商品：{p_id} ,数量：{p_num}&#39;)\n    return\n\ndef car_produce(p_id,p_num):\n    &quot;&quot;&quot; 减少的购物车商品不在购物车或数量多于购物车为False&quot;&quot;&quot;\n    if (p_id in cart) :\n        if cart[p_id] &gt;= p_num:\n            return True\n    return False\n\ndef del_Products(p_id,p_num):\n    &quot;&quot;&quot; 购物车减少产品，库存增加产品&quot;&quot;&quot;\n    if car_produce(p_id,p_num) :  # 减少的购物车商品、数量是否正确\n        for product in range(p_num): \n            delProduct(p_id) # 购物车减少\n            stocks_add(p_id) # 库存增加\n    else:\n        print(f&#39;减少购物车出错。商品：{p_id} ,数量：{p_num}&#39;)\n    return","like_count":2},{"had_liked":false,"id":386661,"user_name":"TTWP","can_delete":false,"product_type":"c3","uid":1666002,"ip_address":"美国","ucode":"5E846E87149448","user_header":"https://static001.geekbang.org/account/avatar/00/19/6b/d2/d787046f.jpg","comment_is_top":false,"comment_ctime":1705303224,"is_pvip":false,"replies":null,"discussion_count":1,"race_medal":0,"score":2,"product_id":100310001,"comment_content":"视频中演示的代码，循环里面&quot;return&quot;后面跟着的“break”是不是多余的？“return”后是不是本来就会退出函数？","like_count":1,"discussions":[{"author":{"id":3838010,"avatar":"","nickname":"8000tank","note":"","ucode":"C5DC98A0EB57CE","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":649145,"discussion_content":"老师在课程里说了“break其实是多余的，只是提供一个思路”了……","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1722863633,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":"北京","group_id":0},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":364573,"user_name":"Matthew","can_delete":false,"product_type":"c3","uid":2843865,"ip_address":"江苏","ucode":"96093089773740","user_header":"https://thirdwx.qlogo.cn/mmopen/vi_32/PiajxSqBRaEKSVuNarJuDhBSvHY0giaq6yriceEBKiaKuc04wCYWOuso50noqDexaPJJibJN7PHwvcQppnzsDia1icZkw/132","comment_is_top":false,"comment_ctime":1671156686,"is_pvip":false,"replies":null,"discussion_count":1,"race_medal":0,"score":2,"product_id":100310001,"comment_content":"# 商品\nproducts = [[1000, &quot;iphone&quot;, &quot;phone&quot;, 12000],\n           [1001, &quot;ipad&quot;, &quot;pad&quot;, 15000],\n           [1002, &quot;macbook&quot;, &quot;laptop&quot;, 20000]]\n# 购物车 &quot;product_id&quot;:&quot;product_number&quot;\ncart = {1000:5, 1001:2}\n# 库存\nstocks = {1000:10, 1001:20, 1002:30}\n\ndef idtoname(product_id):\n    &quot;&quot;&quot; product_id to product_name &quot;&quot;&quot;\n    for product in products:\n        if product[0] == product_id:\n            return product[1]\n            break\n\ndef idtoprice(product_id):\n    &quot;&quot;&quot; product_id to product_price &quot;&quot;&quot;\n    for product in products:\n        if product[0] == product_id:\n            return product[3]\n            break\n\ndef showCart():\n    &quot;&quot;&quot; 展示购物车里的商品 &quot;&quot;&quot;\n    totalMoney = 0\n    for product in cart:\n        print(f&quot;购买商品 { idtoname(product) } 的数量为 {cart[product]}&quot;)\n        totalMoney += idtoprice(product)*cart[product]\n\n    print(f&quot;总费用为: {totalMoney}&quot;)\n\n# 修改增加商品函数的代码\ndef addProduct(product_id, product_number):\n    &quot;&quot;&quot;增加新商品，或已有商品数量&quot;&quot;&quot;\n    if product_number &lt;= stocks[product_id]: \n        if product_id in cart.keys():\n            cart[product_id] += product_number\n        else:\n            cart[product_id] = product_number\n        \n        stocks[product_id] -= product_number\n\n        print(f&quot;商品 {idtoname(product_id)} 成功添加进购物车 {product_number} 个！&quot;)\n    else:\n        print(f&quot;商品 {idtoname(product_id)} 库存不足，无法添加！&quot;)\n\n# 修改减少商品函数的代码\ndef delProduct(product_id):\n    &quot;&quot;&quot;减少已有商品数量&quot;&quot;&quot;\n    if product_id in cart.keys():\n        cart[product_id] -= 1\n        if cart[product_id] == 0:\n            cart.pop(product_id)\n\n        stocks[product_id] += 1\n        \n        print(f&quot;购物车中的商品 {idtoname(product_id)} 成功减少 1 个！&quot;)\n    else:\n        print(f&quot;商品编号 {idtoname(product_id)} 在购物车中不存在，无法删减！&quot;)\n\ndef cleanCart():\n    &quot;&quot;&quot;清空购物车&quot;&quot;&quot;\n    cart.clear()","like_count":1,"discussions":[{"author":{"id":1159983,"avatar":"https://static001.geekbang.org/account/avatar/00/11/b3/2f/d08a1363.jpg","nickname":"聪少 Jeff","note":"","ucode":"C791ACA9B47679","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":600052,"discussion_content":"你写有代码很好，值得学习。我有一个问题，当要添加商品时，库存中没有这个商品的id，是否会报错呢？是否要在添加商品时判断一下库存是否存在这个商品呢？","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1673960401,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":"广东","group_id":0},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":395469,"user_name":"尹长拟","can_delete":false,"product_type":"c3","uid":3074007,"ip_address":"北京","ucode":"1EBD42B5BBD934","user_header":"","comment_is_top":false,"comment_ctime":1730898799,"is_pvip":false,"replies":null,"discussion_count":0,"race_medal":0,"score":2,"product_id":100310001,"comment_content":"# 商品数据库\nproducts = [[100,&#39;mate60pro&#39;,&#39;phone&#39;,6999,10],\n            [101,&#39;iphone16pro&#39;,&#39;phone&#39;,10999,10],\n            [102,&#39;ipad&#39;,&#39;pad&#39;,5999,10],\n            [103,&#39;studio display&#39;,&#39;display&#39;,11099,10]]\n             \n# 购物车商品数量\nshopping_cart = {}\n\n# ID 转换名称\ndef idtoname(product_id):\n    for i in products:\n        if i[0] == product_id:\n            return i[1]\n            break\n\n# ID 转换价格\ndef idtoprice(product_id):\n    for j in products:\n        if j[0] == product_id:\n            return j[3]\n            break\n\n# 计算总价\ndef showcart():\n    if not shopping_cart:\n        print(&quot;您的购物车为空，没有商品需要结算。&quot;)\n    \n    else:\n        totalMoney = 0\n        for n in shopping_cart:\n            print(f&quot;您购买的商品 {idtoname(n)} 的数量为 {shopping_cart[n]}&quot;)\n            totalMoney +=idtoprice(n) * shopping_cart[n]\n\n        print(f&quot;您需要付费的总费用为：{totalMoney}&quot;)\n\n# 增加购物车指定商品数量\ndef addproduct(product_id,product_number):\n    for i in range(len(products)):\n        if products[i][0] == product_id:\n            if products[i][4] &gt;= product_number:\n                if product_id in shopping_cart:\n                    shopping_cart[product_id] += product_number\n                else:\n                    shopping_cart[product_id] = product_number\n                \n                products[i][4] -= product_number\n                \n            else:\n                print(f&quot;您添加的宝贝数量超过了库存数量哦，库存数量为{products[i][4]}&quot;)\n                break\n    \n# 删除 1 个购物车指定商品数量\ndef delproduct(product_id):\n    for i in range(len(products)):\n        if products[i][0] == product_id:\n            if product_id in shopping_cart.keys():\n                shopping_cart[product_id] -= 1\n                if shopping_cart[product_id] == 0:\n                    shopping_cart.pop(product_id)\n                products[i][4] += 1\n                break\n        \n\n# 清空购物车商品\ndef cleancart():\n    shopping_cart.clear()\n\nshowcart()\n\nprint(products)","like_count":0},{"had_liked":false,"id":392423,"user_name":"Orion","can_delete":false,"product_type":"c3","uid":1415636,"ip_address":"上海","ucode":"66C89BCA050925","user_header":"https://static001.geekbang.org/account/avatar/00/15/99/d4/b8ca4d17.jpg","comment_is_top":false,"comment_ctime":1720877301,"is_pvip":false,"replies":null,"discussion_count":0,"race_medal":0,"score":2,"product_id":100310001,"comment_content":"products=[[1000,&quot;iphone&quot;,&quot;phone&quot;,1000,50],\n          [1001,&quot;Mac&quot;,&quot;PC&quot;,5000,50000],\n          [1002,&quot;iPad&quot;,&quot;pad&quot;,3000,50000]]\ncart={1000:2,1001:4}\n\n\ndef GetProductsName(product_id):\n    for i in products:\n      if i[0]==product_id:\n        return i[1]  \n        break\n\ndef GetProductsPrice(product_id):\n   for i in products:\n      if i[0]==product_id:\n        return i[3]  \n        break\n\ndef GetProductInventory(product_id):\n    for i in products:\n      if i[0]==product_id:\n        return i[4]  \n        break\n\n\ndef AddProductInventory(product_id,product_num):\n   for i in products:\n      if i[0] == product_id:\n         i[4] += product_num\n         break\n\ndef DelProductInventory(product_id,product_num):\n   for i in products:\n        if  i[0] == product_id:\n            if  product_num &lt;= i[4]:\n                i[4] -= product_num\n                break\n            else:\n                print(&quot;输入数量大于库存量无法删除&quot;)\n                break\n   \n\ndef AddProductToCart(product_id,product_num):\n    if  GetProductInventory(product_id) &gt;= product_num:\n        if  product_id in cart.keys():\n            cart[product_id]+=product_num\n        else:\n            cart[product_id]=product_num\n        DelProductInventory(product_id,product_num)\n    else:\n       print(&quot;库存不足，请重新选择添加商品的数量&quot;)\n\ndef DelProductToCart(product_id,product_num=1):\n    if  product_id in cart.keys():\n        cart[product_id]-=1\n        AddProductInventory(product_id,product_num)\n        if  cart[product_id] == 0:\n            cart.pop(product_id)\n    else:\n       print(&quot;商品已不再购物车中，无法删除&quot;)\n\ndef CartPay():\n    totalMoney=0\n    for i in cart:\n       totalMoney+=GetProductsPrice(i) * cart[i]\n       print(f&quot;购买的商品是{GetProductsName(i)}，商品数量是{cart[i]}&quot;)\n    print(f&quot;总价格是{totalMoney}&quot;)","like_count":0},{"had_liked":false,"id":384906,"user_name":"Geek_0c747b","can_delete":false,"product_type":"c3","uid":3790728,"ip_address":"广东","ucode":"7D7251D7B98B08","user_header":"","comment_is_top":false,"comment_ctime":1701772585,"is_pvip":false,"replies":null,"discussion_count":0,"race_medal":0,"score":2,"product_id":100310001,"comment_content":"products = [[&quot;10001&quot;, &quot;iphone 15 pro max&quot;, &quot;10000&quot;],\n            [&quot;10002&quot;, &quot;air pods&quot;, &quot;1000&quot;],\n             [&quot;10003&quot;, &quot;ipad&quot;, &quot;10000&quot;] ]\n\ncarts = {10001: 2, 10002:3}\n\ninventorys = [[&quot;10001&quot;, &quot;iphone 15 pro max&quot;, &quot;5&quot;],\n            [&quot;10002&quot;, &quot;air pods&quot;, &quot;3&quot;],\n             [&quot;10003&quot;, &quot;ipad&quot;, &quot;2&quot;] ]\n\ndef get_inventory(product_id):\n    inventory = 0\n    for item in inventorys:\n        if item[0] == product_id:\n            inventory = item[-1]\n            break\n    return int(inventory)\n\ndef update_inventory(product_id, inventory):\n    for item in inventorys:\n        if item[0] == product_id:\n            item[-1] = inventory\n            break\n\ndef addProduct(product_id, product_number):\n    if product_id in carts.keys():\n        inventory = get_inventory(product_id)\n        print(inventory)\n        if inventory != 0 and inventory - product_number &gt;=0:\n            carts[product_id] += product_number\n            update_inventory(product_id, inventory - product_number)\n        else:\n            print(f&quot;{product_id} 没有库存了&quot;)\n    else:\n        carts[product_id] = product_number\n\naddProduct(&#39;10001&#39;, 2)\nprint(carts)\nshowcarts()\n\ndef showcarts():\n    total_money = 0\n    for k in carts:\n        #print(k, carts[k])\n        for p in products:\n            if str(k) == p[0]:\n                print(f&quot;您购买了 {p[1]}, 数量为 {carts[k]}台&quot;)\n                total_money += int(p[2]) * carts[k]\n                \n            #print(p[0])\n\n    print(f&quot;总计: {str(total_money)} ￥&quot;)\nshowcarts()","like_count":0},{"had_liked":false,"id":382148,"user_name":"MarkG","can_delete":false,"product_type":"c3","uid":3675806,"ip_address":"山东","ucode":"454082595FE769","user_header":"https://static001.geekbang.org/account/avatar/00/38/16/9e/48621655.jpg","comment_is_top":false,"comment_ctime":1696768992,"is_pvip":false,"replies":null,"discussion_count":0,"race_medal":0,"score":2,"product_id":100310001,"comment_content":"# 库存\ninventorys = [\n    [1000, 2],\n    [1001, 3],\n    [1002, 4],\n]\n\n# 减少库存\ndef reduce_inventory(product_id, product_number):\n    for inventory in inventorys:\n        if inventory[0] == product_id:\n            if inventory[1] &lt; product_number:\n                print(f&quot;商品 {idtoname(product_id)} 库存不足&quot;)\n                break\n            \n            inventory[1] -= product_number\n            break\n\n# 增加库存\ndef add_inventory(product_id, product_number):\n    for inventory in inventorys:\n        if inventory[0] == product_id:\n            inventory[1] += product_number\n            break\n\n# 获得库存\ndef get_inventory(product_id):\n    for inventory in inventorys:\n        if inventory[0] == product_id:\n            return inventory[1]\n            break\n\n\ndef addProduct(product_id, product_number):\n    inventory = get_inventory(product_id)\n    if inventory == 0:\n        print(&quot;库存为0，不允许增加该商品&quot;)\n        return\n\n    if product_id in cart.keys():\n        cart[product_id] += product_number\n    else:\n        cart[product_id] = product_number\n\n    reduce_inventory(product_id, product_number)\n\n\ndef delProduct(product_id):\n    if product_id in cart.keys():\n        cart[product_id] -= 1\n        if cart[product_id] == 0:\n            cart.pop(product_id)\n        add_inventory(product_id, 1)\n\n\ndef showCart():\n    &quot;&quot;&quot; 展示购物车里的商品 &quot;&quot;&quot;\n    totalMoney = 0\n    for product_id in cart:\n        print(f&quot;购买商品 { idtoname(product_id) } 的数量为 {cart[product_id]}&quot;)\n        totalMoney += idtoprice(product_id)*cart[product_id]\n\n    print(f&quot;总费用为: {totalMoney}&quot;)\n    for inventory in inventorys:\n        print(f&quot;购买商品 { idtoname(inventory[0]) } 的库存为 {inventory[1]}&quot;)\n\n\ndef cleanCart():\n    cart.clear()\n\n# cleanCart()\n\n\n# 增加产品后\naddProduct(1002, 2)\nshowCart()\n\n# 展示如下\n库存为0，不允许增加该商品\n购买商品 iphone 的数量为 5\n购买商品 macbook 的数量为 31\n总费用为: 680000\n购买商品 iphone 的库存为 2\n购买商品 ipad 的库存为 3\n购买商品 macbook 的库存为 0","like_count":0},{"had_liked":false,"id":380508,"user_name":"acondess","can_delete":false,"product_type":"c3","uid":3628115,"ip_address":"浙江","ucode":"D9145C65C73AAC","user_header":"","comment_is_top":false,"comment_ctime":1693738722,"is_pvip":false,"replies":null,"discussion_count":0,"race_medal":0,"score":2,"product_id":100310001,"comment_content":"#运行新增逻辑 （单独一个cell，可循环使用）\nbool_test = Test_rep(pro_id = 1000,pro_num = 12,cart_temp = cart,rep_temp= rep_products,pro_tem=products)\nif bool_test:\n    add_pro(pro_id = 1000,pro_num = 12,cart_temp = cart,rep_temp= rep_products,pro_tem=products)\nshow_cart(cart)\n\n#运行减少逻辑 （单独一个cell，可循环使用）\nbool_test = Test_rep(pro_id = 1000,pro_num = -2,cart_temp = cart,rep_temp= rep_products,pro_tem=products)\nif bool_test:\n    add_pro(pro_id = 1000,pro_num = -2,cart_temp = cart,rep_temp= rep_products,pro_tem=products)\nshow_cart(cart)","like_count":0},{"had_liked":false,"id":380507,"user_name":"acondess","can_delete":false,"product_type":"c3","uid":3628115,"ip_address":"浙江","ucode":"D9145C65C73AAC","user_header":"","comment_is_top":false,"comment_ctime":1693738705,"is_pvip":false,"replies":null,"discussion_count":0,"race_medal":0,"score":2,"product_id":100310001,"comment_content":"# 判断库存是否存在商品、判断是否有库存\ndef Test_rep(pro_id:int,pro_num:int,cart_temp:dir,rep_temp:list,pro_tem:list):\n    # 判断库存是否存在商品、判断是否有库存\n    for product in rep_temp:\n        if pro_id == product[0]:\n            for pro_i in pro_tem:\n                if pro_i[0] == pro_id:\n                    print(f&quot;库存中存在{pro_i[1]}&quot;)\n                    if product[1] &gt;= pro_num:\n                        print(f&quot;库存中足够&quot;)\n                        return True\n                    else:\n                        print(f&quot;库存中存量不够&quot;)\n                        return False\n    return False\n\n# 购物车添加商品 参数：添加的id、数量、购物车、仓库\ndef add_pro(pro_id:int,pro_num:int,cart_temp:dir,rep_temp:list,pro_tem:list):\n    print(cart_temp)\n    # 减少商品 (在add_pro传参设置pro_num为负数，理解为减少商品，但是需要判断购物车中数量足够)\n    if  cart_temp!={} and pro_num &lt; 0 and  -pro_num &gt; cart_temp[pro_id]:\n        print(&quot;购物车中数量不足，无法减少对应数量&quot;)\n    else:\n        if pro_id in cart_temp:\n            cart_temp[pro_id] += pro_num\n        else:\n            cart_temp[pro_id] = pro_num\n            print(cart_temp)\n    \n        # 仓库减少对应数量商品\n        for product in rep_temp:\n            if pro_id == product[0]:\n                for pro_i in pro_tem:\n                    if pro_i[0] == pro_id:\n                        product[1] -= pro_num\n                        print(f&quot;库存中{pro_i[1]}的数量变为：{product[1]}&quot;)\n\n\n# 展示购物车商品及金额总计\ndef show_cart(cart_temp:dir):\n    totle_price=0\n    print(cart_temp)\n    for product in cart_temp:\n        totle_price += idtoprice(product) * cart_temp[product]\n        print(f&quot;购买的商品是：{idtoname(product)}\\t 购买的单价是：{idtoprice(product)} \\t 购买的数量是{cart_temp[product]}&quot;)\n    print(f&quot;总价为{totle_price}&quot;)","like_count":0},{"had_liked":false,"id":380506,"user_name":"acondess","can_delete":false,"product_type":"c3","uid":3628115,"ip_address":"浙江","ucode":"D9145C65C73AAC","user_header":"","comment_is_top":false,"comment_ctime":1693738696,"is_pvip":false,"replies":null,"discussion_count":0,"race_medal":0,"score":3,"product_id":100310001,"comment_content":"# 定义商品(列表)\nproducts  = [[1000,&quot;iphone&quot;,&quot;phone&quot;,12000],\n           [1001,&quot;ipad&quot;,&quot;pad&quot;,15000],\n           [1002,&quot;macbook&quot;,&quot;laptop&quot;,20000]]\n\n# 定义购物车（字典） &quot;product_id&quot;:&quot;prudoct_number&quot;\n# cart = {1000:2,1001:1}\n\n# 定义库存（列表） [id,库存数]\nrep_products = [[1000,10],\n               [1001,20],\n               [1002,5]]\n# 定义购物车（字典） &quot;product_id&quot;:&quot;prudoct_number&quot;\ncart = {}\n\n# 传入id导出名字函数方法\ndef idtoname(product_id):\n    for product in products:\n        if product[0] == product_id:\n            return product[1]\n            break\n        \n# 传入id导出单价函数方法\ndef idtoprice(product_id):\n    for product in products:\n        if product[0] == product_id:\n            return product[3]\n            break","like_count":0},{"had_liked":false,"id":378086,"user_name":"Geek_Mike","can_delete":false,"product_type":"c3","uid":3196376,"ip_address":"云南","ucode":"CFA942192C3B74","user_header":"https://static001.geekbang.org/account/avatar/00/30/c5/d8/c5509b9c.jpg","comment_is_top":false,"comment_ctime":1689742366,"is_pvip":false,"replies":null,"discussion_count":0,"race_medal":0,"score":3,"product_id":100310001,"comment_content":"products = [[1001, &#39;iPhone&#39;, &#39;phone&#39;, 10000],  \n            [1002, &#39;iPad&#39;, &#39;pad&#39;, 12000],  \n            [1003, &#39;MacBook&#39;, &#39;laptop&#39;, 15000]]  \n  \ncart = {1001: 10, 1002: 10, 1003: 10}\n\ninventory = {1001:90, 1002:90, 1003:90}  # 初始化商品库存  \n\n\ndef idtoname(P_id):  \n    for i in products:  \n        if i[0] == P_id:  \n            return i[1]    \n  \ndef idtoprice(P_id):  \n    for i in products:  \n        if i[0] == P_id:  \n            return i[3]    \n  \ndef showcart():  \n    TotalMoney = 0\n    print(&#39;当前购物车中的商品是：&#39;)  \n    for i in cart:  \n        print(f&#39;购买商品 {idtoname(i)} 的数量是 {cart[i]} 单价是 {idtoprice(i)}&#39;)  \n        TotalMoney += idtoprice(i) * cart[i]  \n    print(f&#39;总费用是 {TotalMoney}&#39;)  \n  \n\ndef showinventory():  \n    print(&#39;当前库存：&#39;)  \n    for i in inventory:  \n        print(f&#39;商品 {idtoname(i)} 的库存是 {inventory[i]}&#39;)  \n  \n\ndef addProduct(P_id, P_number):  \n    if P_id in cart.keys() and inventory[P_id] &lt; P_number:\n            print(f&#39;{idtoname(P_id)} 产品库存剩余 {inventory[P_id]}，库存不足无法添加到购物车&#39;) \n    elif P_id in cart.keys() and inventory[P_id] &gt;= P_number:\n            cart[P_id] += P_number       \n            inventory[P_id] -= P_number  # 库存相应减少\n\n  \ndef delProduct(P_id, P_number):  \n    if P_id in cart.keys() and cart[P_id] &lt; P_number:\n        print(f&#39;{idtoname(P_id)} 在购物车中只有 {cart[P_id]} 无法减少 {P_number} 个&#39;)\n    elif P_id in cart.keys() and cart[P_id] &gt;= P_number:\n        cart[P_id] -= P_number\n        inventory[P_id] += P_number  # 购物车中该商品数量减少，库存相应增加\n        if cart[P_id] == 0:\n            cart.pop(P_id)\n  \n  \ndef cleancart():  \n    for i in cart.keys():\n        inventory[i] += cart[I]  # 把购物车里的商品数量归还到库存\n    cart.clear()\n\n\nshowinventory()\nprint()\nshowcart()\nprint()\n\n# addProduct(1003,100)\n# showinventory()\n# print()\n# showcart()\n\n# delProduct(1001,10)\n# showinventory()\n# print()\n# showcart()\n\n# cleancart()\n# showinventory()\n# print()\n# showcart()","like_count":0},{"had_liked":false,"id":377062,"user_name":"Carl-Zhou","can_delete":false,"product_type":"c3","uid":1059947,"ip_address":"江苏","ucode":"F4C3C3157F9F62","user_header":"https://static001.geekbang.org/account/avatar/00/10/2c/6b/62430d15.jpg","comment_is_top":false,"comment_ctime":1687881486,"is_pvip":false,"replies":null,"discussion_count":0,"race_medal":0,"score":3,"product_id":100310001,"comment_content":"# 商品\nproducts = [[1000, &quot;iphone&quot;, &quot;phone&quot;, 12000],\n            [1001, &quot;ipad&quot;, &quot;pad&quot;, 15000],\n            [1002, &quot;macbook&quot;, &quot;laptop&quot;, 20000]]\n# 购物车 &quot;product_id&quot;:&quot;product_number&quot;\ncart = {1000: 5, 1001: 2}\n\n\ndef getProductIdAndNames():\n    &quot;&quot;&quot; 获取所有商品的id和name &quot;&quot;&quot;\n    return {product[0]: product[1] for product in products}\n\n\ndef showCart():\n    &quot;&quot;&quot; 展示购物车里的商品 以及总价&quot;&quot;&quot;\n    print(&quot;你的购物车里有以下商品：&quot;)\n    total_price = 0\n    for product_id, product_number in cart.items():\n        for product in products:\n            if product_id == product[0]:\n                total_price += product[3] * product_number\n                print(f&quot;商品编号：{product_id}，商品名称：{product[1]}，商品单价：{product[3]}，商品数量：{product_number}&quot;)\n    print(f&quot;总费用为: {total_price}&quot;)\n\n\ndef addProduct(product_id, product_number):\n    &quot;&quot;&quot; 添加商品到购物车 &quot;&quot;&quot;\n    # 判断商品是否存在\n    product_info = getProductIdAndNames()\n    if product_id not in product_info.keys():\n        print(f&quot;您添加的商品已下架！&quot;)\n        return\n    # 增加新商品，或已有商品数量\n    if product_id in cart:\n        cart[product_id] += product_number\n    else:\n        cart[product_id] = product_number\n    showCart()\n\ndef delProduct(product_id):\n    &quot;&quot;&quot;减少已有商品数量&quot;&quot;&quot;\n    # 判断商品是否存在\n    product_info = getProductIdAndNames()\n    if product_id not in product_info.keys():\n        print(f&quot;您要删除的商品不存在！&quot;)\n        return\n    # 减少商品数量\n    if product_id in cart:\n        cart[product_id] -= 1\n        if cart[product_id] == 0:\n            cart.pop(product_id)\n    showCart()","like_count":0},{"had_liked":false,"id":369588,"user_name":"GeekNeo","can_delete":false,"product_type":"c3","uid":1146405,"ip_address":"浙江","ucode":"1D355A9BEB8BEA","user_header":"https://static001.geekbang.org/account/avatar/00/11/7e/25/3932dafd.jpg","comment_is_top":false,"comment_ctime":1677687786,"is_pvip":false,"replies":null,"discussion_count":0,"race_medal":0,"score":3,"product_id":100310001,"comment_content":"# 接上\ndef clear_cart():\n    for product_id in cart.keys():\n        for stock in stocks:\n            if stock[0] == product_id:\n                stock[3] += cart[product_id]\n                return &quot;清空购物车，库存更新&quot;\n    cart.clear()\n\n# del_product(1001)\nadd_product(1002, 4)\nprint(cart)\nprint(stocks)\n# print(f&quot;产品: {id_to_name(1002)} 的价格为：{id_to_price(1002)}&quot;)\nshow_cart()","like_count":0},{"had_liked":false,"id":369587,"user_name":"GeekNeo","can_delete":false,"product_type":"c3","uid":1146405,"ip_address":"浙江","ucode":"1D355A9BEB8BEA","user_header":"https://static001.geekbang.org/account/avatar/00/11/7e/25/3932dafd.jpg","comment_is_top":false,"comment_ctime":1677687762,"is_pvip":false,"replies":null,"discussion_count":0,"race_medal":0,"score":3,"product_id":100310001,"comment_content":"products = [[1000, &quot;iPhone&quot;, &quot;Phone&quot;, 12000], [1001, &quot;iPad&quot;, &quot;Pad&quot;, 15000], [1002, &quot;MacBook&quot;, &quot;Laptop&quot;, 20000]]\nstocks = [[1000, &quot;iPhone&quot;, &quot;Phone&quot;, 50], [1001, &quot;iPad&quot;, &quot;Pad&quot;, 100], [1002, &quot;MacBook&quot;, &quot;Laptop&quot;, 120]]\ncart = {1000: 5, 1001: 2}\n\ndef id_to_name(product_id: int) -&gt; str:\n    for product in products:\n        if product[0] == product_id:\n            return product[1]\n\ndef id_to_price(product_id: int) -&gt; int:\n    for product in products:\n        if product[0] == product_id:\n            return product[3]\n\ndef stock_num(product_id: int) -&gt; str:\n    for stock in stocks:\n        if stock[0] == product_id:\n            return stock[3]\n\ndef stock_reduce(product_id: int, product_number: int) -&gt; str:\n    for stock in stocks:\n        if stock[0] == product_id:\n            stock[3] -= product_number\n            return &quot;库存更新&quot;\n\ndef stock_increase(product_id: int) -&gt; str:\n    for stock in stocks:\n        if stock[0] == product_id:\n            stock[3] += 1\n            return &quot;库存更新&quot;\n\ndef show_cart():\n    total_money = 0\n    for product in cart:\n        print(f&quot;购买商品 {id_to_name(product)} 的数量为 {cart[product]}&quot;)\n        total_money += id_to_price(product) * cart[product]\n\n    print(f&quot;总费用：{total_money}&quot;)\n\ndef add_product(product_id, product_number):\n    # 增加商品或已有商品\n    if product_number &lt;= stock_num(product_id):\n        if product_id in cart.keys():\n            cart[product_id] += product_number\n        else:\n            cart[product_id] = product_number\n        # 如果购物车种新增，那么库存就需要减少\n        stock_reduce(product_id, product_number)\n        print(f&quot;商品 {id_to_name(product_id)} 成功添加进购物车 {product_number} 个！&quot;)\n    else:\n        print(f&quot;商品 {id_to_name(product_id)} 库存不足，无法添加！&quot;)\n\ndef del_product(product_id):\n    if product_id in cart.keys():\n        cart[product_id] -= 1\n        stock_increase(product_id)\n        if cart[product_id] == 0:\n            cart.pop(product_id)","like_count":0},{"had_liked":false,"id":368573,"user_name":"朱雯","can_delete":false,"product_type":"c3","uid":1035744,"ip_address":"美国","ucode":"064C45FBF6B51F","user_header":"https://static001.geekbang.org/account/avatar/00/0f/cd/e0/c85bb948.jpg","comment_is_top":false,"comment_ctime":1676455463,"is_pvip":false,"replies":null,"discussion_count":0,"race_medal":0,"score":3,"product_id":100310001,"comment_content":"products = [[1000, &#39;iphone&#39;, &#39;phone&#39;, 12000],\n            [1001, &#39;ipad&#39;, &#39;pad&#39;, 15000],]\ncart = {1000: 5, 1001: 2}\nkucun = {1000: 10, 1001: 20, 1002: 5}\ndef idtoprice(proid):\n    for product in products:\n        if product[0] == proid:\n            return product[3]\ndef idtoname(proid):\n    for product in products:\n        if product[0] == proid:\n            return product[1]\ndef showCart():\n    total = 0\n    for product in cart:\n        print(f&quot;购买商品有{idtoname(product)},数量为{cart[product]}&quot;)\n        total += cart[product] * idtoprice(product)\n    print(f&quot;商品的总价为{total}&quot;)\ndef showKucun():\n    for product in kucun:\n        print(f&quot;库存商品有{idtoname(product)},数量为{kucun[product]}&quot;)\ndef selCart(proid, pronum):\n    if proid in cart.keys():\n        if cart[proid] &gt;= pronum:\n            return True\n    return False\ndef selKucun(proid, pronum):\n    if proid in kucun.keys():\n        if kucun[proid] &gt;= pronum:\n            return True\n    return False\ndef addCart(proid, pronum):\n    if proid in cart.keys():\n        cart[proid] += pronum\n    else:\n        cart[proid] = pronum\ndef addKucun(proid, pronum):\n    if proid in kucun.keys():\n        kucun[proid] += pronum\n    else:\n        kucun[proid] = pronum\ndef delKucun(proid, pronum):\n    if selKucun(proid, pronum):\n        kucun[proid] -= pronum\n        return True\n    else:\n        return False\ndef delCart(proid, pronum):\n    if selCart(proid, pronum):\n        cart[proid] -= pronum\n        return True\n    else:\n        return False\ndef clearCart(proid):\n    if proid in cart.keys():\n        if cart[proid] == 0:\n            del cart[proid]\ndef clearKucun(proid):\n    if proid in kucun.keys():\n        if kucun[proid] == 0:\n            del kucun[proid]\ndef addCarts(proid, pronum):\n    if not delKucun(proid, pronum):\n        return\n    addCart(proid, pronum)\n    clearKucun(proid)\ndef delCarts(proid, pronum):\n    if not delCart(proid, pronum):\n        return\n    addKucun(proid, pronum)\n    clearCart(proid)","like_count":0},{"had_liked":false,"id":364574,"user_name":"Matthew","can_delete":false,"product_type":"c3","uid":2843865,"ip_address":"江苏","ucode":"96093089773740","user_header":"https://thirdwx.qlogo.cn/mmopen/vi_32/PiajxSqBRaEKSVuNarJuDhBSvHY0giaq6yriceEBKiaKuc04wCYWOuso50noqDexaPJJibJN7PHwvcQppnzsDia1icZkw/132","comment_is_top":false,"comment_ctime":1671156700,"is_pvip":false,"replies":null,"discussion_count":0,"race_medal":0,"score":3,"product_id":100310001,"comment_content":"###########################################################\n## 1、初始化显示购物车\nshowCart()\n\n## 2、增加商品\n# 增加已有商品，没有超过库存\naddProduct(1000, 4)\n# 增加已有商品，超过库存\naddProduct(1001, 25)\n# 增加新商品\naddProduct(1002, 8)\n# 展示购物车\nshowCart()\n\n## 3、减少商品\n# 购物车中已存在的商品\ni = cart[1001]\nwhile i &gt; 0:\n    delProduct(1001)\n    i-=1\n# 购物车中不存在的商品\ndelProduct(1001)\n# 展示购物车\nshowCart()","like_count":0}]}