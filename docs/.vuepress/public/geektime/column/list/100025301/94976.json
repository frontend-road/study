{"id":94976,"title":"14 | å¼¹æ€§åˆ†å¸ƒå¼æ•°æ®é›†ï¼šSparkå¤§å¦çš„åœ°åŸºï¼ˆä¸‹ï¼‰","content":"<p>ä½ å¥½ï¼Œæˆ‘æ˜¯è”¡å…ƒæ¥ ã€‚</p><p>ä¸Šä¸€è®²æˆ‘ä»¬ä»‹ç»äº†å¼¹æ€§åˆ†å¸ƒå¼æ•°æ®é›†ï¼ˆRDDï¼‰çš„å®šä¹‰ã€ç‰¹æ€§ä»¥åŠç»“æ„ï¼Œå¹¶ä¸”æ·±å…¥è®¨è®ºäº†ä¾èµ–å…³ç³»ï¼ˆDependenciesï¼‰ã€‚</p><p>ä»Šå¤©è®©æˆ‘ä»¬ä¸€èµ·æ¥ç»§ç»­å­¦ä¹ RDDçš„å…¶ä»–ç‰¹æ€§ã€‚</p><h2>RDDçš„ç»“æ„</h2><p>é¦–å…ˆï¼Œæˆ‘æ¥ä»‹ç»ä¸€ä¸‹RDDç»“æ„ä¸­å…¶ä»–çš„å‡ ä¸ªçŸ¥è¯†ç‚¹ï¼šæ£€æŸ¥ç‚¹ï¼ˆCheckpointï¼‰ã€å­˜å‚¨çº§åˆ«ï¼ˆ Storage Levelï¼‰å’Œè¿­ä»£å‡½æ•°ï¼ˆIteratorï¼‰ã€‚</p><p><img src=\"https://static001.geekbang.org/resource/image/8c/1c/8cae25f4d16a34be77fd3e84133d6a1c.png?wh=1776*2263\" alt=\"\"></p><p>é€šè¿‡ä¸Šä¸€è®²ï¼Œä½ åº”è¯¥å·²ç»çŸ¥é“äº†ï¼ŒåŸºäºRDDçš„ä¾èµ–å…³ç³»ï¼Œå¦‚æœä»»æ„ä¸€ä¸ªRDDåœ¨ç›¸åº”çš„èŠ‚ç‚¹ä¸¢å¤±ï¼Œä½ åªéœ€è¦ä»ä¸Šä¸€æ­¥çš„RDDå‡ºå‘å†æ¬¡è®¡ç®—ï¼Œä¾¿å¯æ¢å¤è¯¥RDDã€‚</p><p>ä½†æ˜¯ï¼Œå¦‚æœä¸€ä¸ªRDDçš„ä¾èµ–é“¾æ¯”è¾ƒé•¿ï¼Œè€Œä¸”ä¸­é—´åˆæœ‰å¤šä¸ªRDDå‡ºç°æ•…éšœçš„è¯ï¼Œè¿›è¡Œæ¢å¤å¯èƒ½ä¼šéå¸¸è€—è´¹æ—¶é—´å’Œè®¡ç®—èµ„æºã€‚</p><p>è€Œæ£€æŸ¥ç‚¹ï¼ˆCheckpointï¼‰çš„å¼•å…¥ï¼Œå°±æ˜¯ä¸ºäº†ä¼˜åŒ–è¿™äº›æƒ…å†µä¸‹çš„æ•°æ®æ¢å¤ã€‚</p><p>å¾ˆå¤šæ•°æ®åº“ç³»ç»Ÿéƒ½æœ‰æ£€æŸ¥ç‚¹æœºåˆ¶ï¼Œåœ¨è¿ç»­çš„transactionåˆ—è¡¨ä¸­è®°å½•æŸå‡ ä¸ªtransactionåæ•°æ®çš„å†…å®¹ï¼Œä»è€ŒåŠ å¿«é”™è¯¯æ¢å¤ã€‚</p><p>RDDä¸­çš„æ£€æŸ¥ç‚¹çš„æ€æƒ³ä¸ä¹‹ç±»ä¼¼ã€‚</p><p>åœ¨è®¡ç®—è¿‡ç¨‹ä¸­ï¼Œå¯¹äºä¸€äº›è®¡ç®—è¿‡ç¨‹æ¯”è¾ƒè€—æ—¶çš„RDDï¼Œæˆ‘ä»¬å¯ä»¥å°†å®ƒç¼“å­˜è‡³ç¡¬ç›˜æˆ–HDFSä¸­ï¼Œæ ‡è®°è¿™ä¸ªRDDæœ‰è¢«æ£€æŸ¥ç‚¹å¤„ç†è¿‡ï¼Œå¹¶ä¸”æ¸…ç©ºå®ƒçš„æ‰€æœ‰ä¾èµ–å…³ç³»ã€‚åŒæ—¶ï¼Œç»™å®ƒæ–°å»ºä¸€ä¸ªä¾èµ–äºCheckpointRDDçš„ä¾èµ–å…³ç³»ï¼ŒCheckpointRDDå¯ä»¥ç”¨æ¥ä»ç¡¬ç›˜ä¸­è¯»å–RDDå’Œç”Ÿæˆæ–°çš„åˆ†åŒºä¿¡æ¯ã€‚</p><!-- [[[read_end]]] --><p>è¿™æ ·ï¼Œå½“æŸä¸ªå­RDDéœ€è¦é”™è¯¯æ¢å¤æ—¶ï¼Œå›æº¯è‡³è¯¥RDDï¼Œå‘ç°å®ƒè¢«æ£€æŸ¥ç‚¹è®°å½•è¿‡ï¼Œå°±å¯ä»¥ç›´æ¥å»ç¡¬ç›˜ä¸­è¯»å–è¿™ä¸ªRDDï¼Œè€Œæ— éœ€å†å‘å‰å›æº¯è®¡ç®—ã€‚</p><p>å­˜å‚¨çº§åˆ«ï¼ˆStorage Levelï¼‰æ˜¯ä¸€ä¸ªæšä¸¾ç±»å‹ï¼Œç”¨æ¥è®°å½•RDDæŒä¹…åŒ–æ—¶çš„å­˜å‚¨çº§åˆ«ï¼Œå¸¸ç”¨çš„æœ‰ä»¥ä¸‹å‡ ä¸ªï¼š</p><ul>\n<li>\n<p>MEMORY_ONLYï¼šåªç¼“å­˜åœ¨å†…å­˜ä¸­ï¼Œå¦‚æœå†…å­˜ç©ºé—´ä¸å¤Ÿåˆ™ä¸ç¼“å­˜å¤šå‡ºæ¥çš„éƒ¨åˆ†ã€‚è¿™æ˜¯RDDå­˜å‚¨çº§åˆ«çš„é»˜è®¤å€¼ã€‚</p>\n</li>\n<li>\n<p>MEMORY_AND_DISKï¼šç¼“å­˜åœ¨å†…å­˜ä¸­ï¼Œå¦‚æœç©ºé—´ä¸å¤Ÿåˆ™ç¼“å­˜åœ¨ç¡¬ç›˜ä¸­ã€‚</p>\n</li>\n<li>\n<p>DISK_ONLYï¼šåªç¼“å­˜åœ¨ç¡¬ç›˜ä¸­ã€‚</p>\n</li>\n<li>\n<p>MEMORY_ONLY_2å’ŒMEMORY_AND_DISK_2ç­‰ï¼šä¸ä¸Šé¢çš„çº§åˆ«åŠŸèƒ½ç›¸åŒï¼Œåªä¸è¿‡æ¯ä¸ªåˆ†åŒºåœ¨é›†ç¾¤ä¸­ä¸¤ä¸ªèŠ‚ç‚¹ä¸Šå»ºç«‹å‰¯æœ¬ã€‚</p>\n</li>\n</ul><p>è¿™å°±æ˜¯æˆ‘ä»¬åœ¨å‰æ–‡æåˆ°è¿‡çš„ï¼ŒSparkç›¸æ¯”äºHadoopåœ¨æ€§èƒ½ä¸Šçš„æå‡ã€‚æˆ‘ä»¬å¯ä»¥éšæ—¶æŠŠè®¡ç®—å¥½çš„RDDç¼“å­˜åœ¨å†…å­˜ä¸­ï¼Œä»¥ä¾¿ä¸‹æ¬¡è®¡ç®—æ—¶ä½¿ç”¨ï¼Œè¿™å¤§å¹…åº¦å‡å°äº†ç¡¬ç›˜è¯»å†™çš„å¼€é”€ã€‚</p><p>è¿­ä»£å‡½æ•°ï¼ˆIteratorï¼‰å’Œè®¡ç®—å‡½æ•°ï¼ˆComputeï¼‰æ˜¯ç”¨æ¥è¡¨ç¤ºRDDæ€æ ·é€šè¿‡çˆ¶RDDè®¡ç®—å¾—åˆ°çš„ã€‚</p><p>è¿­ä»£å‡½æ•°ä¼šé¦–å…ˆåˆ¤æ–­ç¼“å­˜ä¸­æ˜¯å¦æœ‰æƒ³è¦è®¡ç®—çš„RDDï¼Œå¦‚æœæœ‰å°±ç›´æ¥è¯»å–ï¼Œå¦‚æœæ²¡æœ‰ï¼Œå°±æŸ¥æ‰¾æƒ³è¦è®¡ç®—çš„RDDæ˜¯å¦è¢«æ£€æŸ¥ç‚¹å¤„ç†è¿‡ã€‚å¦‚æœæœ‰ï¼Œå°±ç›´æ¥è¯»å–ï¼Œå¦‚æœæ²¡æœ‰ï¼Œå°±è°ƒç”¨è®¡ç®—å‡½æ•°å‘ä¸Šé€’å½’ï¼ŒæŸ¥æ‰¾çˆ¶RDDè¿›è¡Œè®¡ç®—ã€‚</p><p>åˆ°ç°åœ¨ï¼Œç›¸ä¿¡ä½ å·²ç»å¯¹å¼¹æ€§åˆ†å¸ƒå¼æ•°æ®é›†çš„åŸºæœ¬ç»“æ„æœ‰äº†åˆæ­¥äº†è§£ã€‚ä½†æ˜¯å…‰ç†è§£RDDçš„ç»“æ„æ˜¯è¿œè¿œä¸å¤Ÿçš„ï¼Œæˆ‘ä»¬çš„ç»ˆæç›®æ ‡æ˜¯ä½¿ç”¨RDDè¿›è¡Œæ•°æ®å¤„ç†ã€‚</p><p>è¦ä½¿ç”¨RDDè¿›è¡Œæ•°æ®å¤„ç†ï¼Œä½ éœ€è¦å…ˆäº†è§£ä¸€äº›RDDçš„æ•°æ®æ“ä½œã€‚</p><p>åœ¨<a href=\"http://time.geekbang.org/column/article/94410\">ç¬¬12è®²</a>ä¸­ï¼Œæˆ‘æ›¾ç»æè¿‡ï¼Œç›¸æ¯”èµ·MapReduceåªæ”¯æŒä¸¤ç§æ•°æ®æ“ä½œï¼ŒSparkæ”¯æŒå¤§é‡çš„åŸºæœ¬æ“ä½œï¼Œä»è€Œå‡è½»äº†ç¨‹åºå‘˜çš„è´Ÿæ‹…ã€‚</p><p>æ¥ä¸‹æ¥ï¼Œè®©æˆ‘ä»¬è¿›ä¸€æ­¥äº†è§£åŸºäºRDDçš„å„ç§æ•°æ®æ“ä½œã€‚</p><h2>RDDçš„è½¬æ¢æ“ä½œ</h2><p>RDDçš„æ•°æ®æ“ä½œåˆ†ä¸ºä¸¤ç§ï¼šè½¬æ¢ï¼ˆTransformationï¼‰å’ŒåŠ¨ä½œï¼ˆActionï¼‰ã€‚</p><p>é¡¾åæ€ä¹‰ï¼Œè½¬æ¢æ˜¯ç”¨æ¥æŠŠä¸€ä¸ªRDDè½¬æ¢æˆå¦ä¸€ä¸ªRDDï¼Œè€ŒåŠ¨ä½œåˆ™æ˜¯é€šè¿‡è®¡ç®—è¿”å›ä¸€ä¸ªç»“æœã€‚</p><p>ä¸éš¾æƒ³åˆ°ï¼Œä¹‹å‰ä¸¾ä¾‹çš„mapã€filterã€groupByKeyç­‰éƒ½å±äºè½¬æ¢æ“ä½œã€‚</p><h3>Map</h3><p>mapæ˜¯æœ€åŸºæœ¬çš„è½¬æ¢æ“ä½œã€‚</p><p>ä¸MapReduceä¸­çš„mapä¸€æ ·ï¼Œå®ƒæŠŠä¸€ä¸ªRDDä¸­çš„æ‰€æœ‰æ•°æ®é€šè¿‡ä¸€ä¸ªå‡½æ•°ï¼Œæ˜ å°„æˆä¸€ä¸ªæ–°çš„RDDï¼Œä»»ä½•åŸRDDä¸­çš„å…ƒç´ åœ¨æ–°RDDä¸­éƒ½æœ‰ä¸”åªæœ‰ä¸€ä¸ªå…ƒç´ ä¸ä¹‹å¯¹åº”ã€‚</p><p>åœ¨è¿™ä¸€è®²ä¸­æåˆ°çš„æ‰€æœ‰çš„æ“ä½œï¼Œæˆ‘éƒ½ä¼šä½¿ç”¨ä»£ç ä¸¾ä¾‹ï¼Œå¸®åŠ©ä½ æ›´å¥½åœ°ç†è§£ã€‚</p><pre><code>rdd = sc.parallelize([&quot;b&quot;, &quot;a&quot;, &quot;c&quot;])\nrdd2 = rdd.map(lambda x: (x, 1)) // [('b', 1), ('a', 1), ('c', 1)]\n</code></pre><h3>Filter</h3><p>filterè¿™ä¸ªæ“ä½œï¼Œæ˜¯é€‰æ‹©åŸRDDé‡Œæ‰€æœ‰æ•°æ®ä¸­æ»¡è¶³æŸä¸ªç‰¹å®šæ¡ä»¶çš„æ•°æ®ï¼Œå»è¿”å›ä¸€ä¸ªæ–°çš„RDDã€‚å¦‚ä¸‹ä¾‹æ‰€ç¤ºï¼Œé€šè¿‡filterï¼Œåªé€‰å‡ºäº†æ‰€æœ‰çš„å¶æ•°ã€‚</p><pre><code>rdd = sc.parallelize([1, 2, 3, 4, 5])\nrdd2 = rdd.filter(lambda x: x % 2 == 0) // [2, 4]\n</code></pre><h3>mapPartitions</h3><p>mapPartitionsæ˜¯mapçš„å˜ç§ã€‚ä¸åŒäºmapçš„è¾“å…¥å‡½æ•°æ˜¯åº”ç”¨äºRDDä¸­æ¯ä¸ªå…ƒç´ ï¼ŒmapPartitionsçš„è¾“å…¥å‡½æ•°æ˜¯åº”ç”¨äºRDDçš„æ¯ä¸ªåˆ†åŒºï¼Œä¹Ÿå°±æ˜¯æŠŠæ¯ä¸ªåˆ†åŒºä¸­çš„å†…å®¹ä½œä¸ºæ•´ä½“æ¥å¤„ç†çš„ï¼Œæ‰€ä»¥è¾“å…¥å‡½æ•°çš„ç±»å‹æ˜¯Iterator[T] =&gt; Iterator[U]ã€‚</p><pre><code>rdd = sc.parallelize([1, 2, 3, 4], 2)\ndef f(iterator): yield sum(iterator)\nrdd2 = rdd.mapPartitions(f) // [3, 7]\n</code></pre><p>åœ¨mapPartitionsçš„ä¾‹å­ä¸­ï¼Œæˆ‘ä»¬é¦–å…ˆåˆ›å»ºäº†ä¸€ä¸ªæœ‰ä¸¤ä¸ªåˆ†åŒºçš„RDDã€‚mapPartitionsçš„è¾“å…¥å‡½æ•°æ˜¯å¯¹æ¯ä¸ªåˆ†åŒºå†…çš„å…ƒç´ æ±‚å’Œï¼Œæ‰€ä»¥è¿”å›çš„RDDåŒ…å«ä¸¤ä¸ªå…ƒç´ ï¼š1+2=3 å’Œ3+4=7ã€‚</p><h3>groupByKey</h3><p>groupByKeyå’ŒSQLä¸­çš„groupByç±»ä¼¼ï¼Œæ˜¯æŠŠå¯¹è±¡çš„é›†åˆæŒ‰æŸä¸ªKeyæ¥å½’ç±»ï¼Œè¿”å›çš„RDDä¸­æ¯ä¸ªKeyå¯¹åº”ä¸€ä¸ªåºåˆ—ã€‚</p><pre><code>rdd = sc.parallelize([(&quot;a&quot;, 1), (&quot;b&quot;, 1), (&quot;a&quot;, 2)])\nrdd.groupByKey().collect()\n//&quot;a&quot; [1, 2]\n//&quot;b&quot; [1]\n</code></pre><p>åœ¨æ­¤ï¼Œæˆ‘ä»¬åªåˆ—ä¸¾è¿™å‡ ä¸ªå¸¸ç”¨çš„ã€æœ‰ä»£è¡¨æ€§çš„æ“ä½œï¼Œå¯¹å…¶ä»–è½¬æ¢æ“ä½œæ„Ÿå…´è¶£çš„åŒå­¦å¯ä»¥å»è‡ªè¡ŒæŸ¥é˜…å®˜æ–¹çš„APIæ–‡æ¡£ã€‚</p><h2>RDDçš„åŠ¨ä½œæ“ä½œ</h2><p>è®©æˆ‘ä»¬å†æ¥çœ‹å‡ ä¸ªå¸¸ç”¨çš„åŠ¨ä½œæ“ä½œã€‚</p><h3>Collect</h3><p>RDDä¸­çš„åŠ¨ä½œæ“ä½œcollectä¸å‡½æ•°å¼ç¼–ç¨‹ä¸­çš„collectç±»ä¼¼ï¼Œå®ƒä¼šä»¥æ•°ç»„çš„å½¢å¼ï¼Œè¿”å›RDDçš„æ‰€æœ‰å…ƒç´ ã€‚éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œcollectæ“ä½œåªæœ‰åœ¨è¾“å‡ºæ•°ç»„æ‰€å«çš„æ•°æ®æ•°é‡è¾ƒå°æ—¶ä½¿ç”¨ï¼Œå› ä¸ºæ‰€æœ‰çš„æ•°æ®éƒ½ä¼šè½½å…¥åˆ°ç¨‹åºçš„å†…å­˜ä¸­ï¼Œå¦‚æœæ•°æ®é‡è¾ƒå¤§ï¼Œä¼šå ç”¨å¤§é‡JVMå†…å­˜ï¼Œå¯¼è‡´å†…å­˜æº¢å‡ºã€‚</p><pre><code>rdd = sc.parallelize([&quot;b&quot;, &quot;a&quot;, &quot;c&quot;])\nrdd.map(lambda x: (x, 1)).collect() // [('b', 1), ('a', 1), ('c', 1)]\n</code></pre><p>å®é™…ä¸Šï¼Œä¸Šè¿°è½¬æ¢æ“ä½œä¸­æ‰€æœ‰çš„ä¾‹å­ï¼Œæœ€åéƒ½éœ€è¦å°†RDDçš„å…ƒç´ collectæˆæ•°ç»„æ‰èƒ½å¾—åˆ°æ ‡è®°å¥½çš„è¾“å‡ºã€‚</p><h3>Reduce</h3><p>ä¸MapReduceä¸­çš„reduceç±»ä¼¼ï¼Œå®ƒä¼šæŠŠRDDä¸­çš„å…ƒç´ æ ¹æ®ä¸€ä¸ªè¾“å…¥å‡½æ•°èšåˆèµ·æ¥ã€‚</p><pre><code>from operator import add\nsc.parallelize([1, 2, 3, 4, 5]).reduce(add)  // 15\n</code></pre><h3>Count</h3><p>Countä¼šè¿”å›RDDä¸­å…ƒç´ çš„ä¸ªæ•°ã€‚</p><p>sc.parallelize([2, 3, 4]).count() // 3</p><h3>CountByKey</h3><p>ä»…é€‚ç”¨äºKey-Value pairç±»å‹çš„ RDDï¼Œè¿”å›å…·æœ‰æ¯ä¸ª key çš„è®¡æ•°çš„&lt;Key, Count&gt;çš„mapã€‚</p><pre><code>rdd = sc.parallelize([(&quot;a&quot;, 1), (&quot;b&quot;, 1), (&quot;a&quot;, 1)])\nsorted(rdd.countByKey().items()) // [('a', 2), ('b', 1)]\n</code></pre><p>è®²åˆ°è¿™ï¼Œä½ å¯èƒ½ä¼šé—®äº†ï¼Œä¸ºä»€ä¹ˆè¦åŒºåˆ†è½¬æ¢å’ŒåŠ¨ä½œå‘¢ï¼Ÿè™½ç„¶è½¬æ¢æ˜¯ç”Ÿæˆæ–°çš„RDDï¼ŒåŠ¨ä½œæ˜¯æŠŠRDDè¿›è¡Œè®¡ç®—ç”Ÿæˆä¸€ä¸ªç»“æœï¼Œå®ƒä»¬æœ¬è´¨ä¸Šä¸éƒ½æ˜¯è®¡ç®—å—ï¼Ÿ</p><p>è¿™æ˜¯å› ä¸ºï¼Œæ‰€æœ‰è½¬æ¢æ“ä½œéƒ½å¾ˆæ‡’ï¼Œå®ƒåªæ˜¯ç”Ÿæˆæ–°çš„RDDï¼Œå¹¶ä¸”è®°å½•ä¾èµ–å…³ç³»ã€‚</p><p>ä½†æ˜¯Sparkå¹¶ä¸ä¼šç«‹åˆ»è®¡ç®—å‡ºæ–°RDDä¸­å„ä¸ªåˆ†åŒºçš„æ•°å€¼ã€‚ç›´åˆ°é‡åˆ°ä¸€ä¸ªåŠ¨ä½œæ—¶ï¼Œæ•°æ®æ‰ä¼šè¢«è®¡ç®—ï¼Œå¹¶ä¸”è¾“å‡ºç»“æœç»™Driverã€‚</p><p>æ¯”å¦‚ï¼Œåœ¨ä¹‹å‰çš„ä¾‹å­ä¸­ï¼Œä½ å…ˆå¯¹RDDè¿›è¡Œmapè½¬æ¢ï¼Œå†è¿›è¡ŒcollectåŠ¨ä½œï¼Œè¿™æ—¶mapåç”Ÿæˆçš„RDDä¸ä¼šç«‹å³è¢«è®¡ç®—ã€‚åªæœ‰å½“æ‰§è¡Œåˆ°collectæ“ä½œæ—¶ï¼Œmapæ‰ä¼šè¢«è®¡ç®—ã€‚è€Œä¸”ï¼Œmapä¹‹åå¾—åˆ°çš„è¾ƒå¤§çš„æ•°æ®é‡å¹¶ä¸ä¼šä¼ ç»™Driverï¼Œåªæœ‰collectåŠ¨ä½œçš„ç»“æœæ‰ä¼šä¼ é€’ç»™Driverã€‚</p><p>è¿™ç§æƒ°æ€§æ±‚å€¼çš„è®¾è®¡ä¼˜åŠ¿æ˜¯ä»€ä¹ˆå‘¢ï¼Ÿè®©æˆ‘ä»¬æ¥çœ‹è¿™æ ·ä¸€ä¸ªä¾‹å­ã€‚</p><p>å‡è®¾ï¼Œä½ è¦ä»ä¸€ä¸ªå¾ˆå¤§çš„æ–‡æœ¬æ–‡ä»¶ä¸­ç­›é€‰å‡ºåŒ…å«æŸä¸ªè¯è¯­çš„è¡Œï¼Œç„¶åè¿”å›ç¬¬ä¸€ä¸ªè¿™æ ·çš„æ–‡æœ¬è¡Œã€‚ä½ éœ€è¦å…ˆè¯»å–æ–‡ä»¶textFile()ç”Ÿæˆrdd1ï¼Œç„¶åä½¿ç”¨filter()æ–¹æ³•ç”Ÿæˆrdd2ï¼Œæœ€åæ˜¯è¡ŒåŠ¨æ“ä½œfirst()ï¼Œè¿”å›ç¬¬ä¸€ä¸ªå…ƒç´ ã€‚</p><p>è¯»å–æ–‡ä»¶çš„æ—¶å€™ä¼šæŠŠæ‰€æœ‰çš„è¡Œéƒ½å­˜å‚¨èµ·æ¥ï¼Œä½†æˆ‘ä»¬é©¬ä¸Šå°±è¦ç­›é€‰å‡ºåªå…·æœ‰ç‰¹å®šè¯ç»„çš„è¡Œäº†ï¼Œç­‰ç­›é€‰å‡ºæ¥ä¹‹ååˆè¦æ±‚åªè¾“å‡ºç¬¬ä¸€ä¸ªã€‚è¿™æ ·æ˜¯ä¸æ˜¯å¤ªæµªè´¹å­˜å‚¨ç©ºé—´äº†å‘¢ï¼Ÿç¡®å®ã€‚</p><p>æ‰€ä»¥å®é™…ä¸Šï¼ŒSparkæ˜¯åœ¨è¡ŒåŠ¨æ“ä½œfirst()çš„æ—¶å€™å¼€å§‹çœŸæ­£çš„è¿ç®—ï¼šåªæ‰«æç¬¬ä¸€ä¸ªåŒ¹é…çš„è¡Œï¼Œä¸éœ€è¦è¯»å–æ•´ä¸ªæ–‡ä»¶ã€‚æ‰€ä»¥ï¼Œæƒ°æ€§æ±‚å€¼çš„è®¾è®¡å¯ä»¥è®©Sparkçš„è¿ç®—æ›´åŠ é«˜æ•ˆå’Œå¿«é€Ÿã€‚</p><p>è®©æˆ‘ä»¬æ€»ç»“ä¸€ä¸‹Sparkæ‰§è¡Œæ“ä½œçš„æµç¨‹å§ã€‚</p><p>Sparkåœ¨æ¯æ¬¡è½¬æ¢æ“ä½œçš„æ—¶å€™ï¼Œä½¿ç”¨äº†æ–°äº§ç”Ÿçš„ RDD æ¥è®°å½•è®¡ç®—é€»è¾‘ï¼Œè¿™æ ·å°±æŠŠä½œç”¨åœ¨ RDD ä¸Šçš„æ‰€æœ‰è®¡ç®—é€»è¾‘ä¸²èµ·æ¥ï¼Œå½¢æˆäº†ä¸€ä¸ªé“¾æ¡ã€‚å½“å¯¹ RDD è¿›è¡ŒåŠ¨ä½œæ—¶ï¼ŒSpark ä¼šä»è®¡ç®—é“¾çš„æœ€åä¸€ä¸ªRDDå¼€å§‹ï¼Œä¾æ¬¡ä»ä¸Šä¸€ä¸ªRDDè·å–æ•°æ®å¹¶æ‰§è¡Œè®¡ç®—é€»è¾‘ï¼Œæœ€åè¾“å‡ºç»“æœã€‚</p><h2>RDDçš„æŒä¹…åŒ–ï¼ˆç¼“å­˜ï¼‰</h2><p>æ¯å½“æˆ‘ä»¬å¯¹RDDè°ƒç”¨ä¸€ä¸ªæ–°çš„actionæ“ä½œæ—¶ï¼Œæ•´ä¸ªRDDéƒ½ä¼šä»å¤´å¼€å§‹è¿ç®—ã€‚å› æ­¤ï¼Œå¦‚æœæŸä¸ªRDDä¼šè¢«åå¤é‡ç”¨çš„è¯ï¼Œæ¯æ¬¡éƒ½ä»å¤´è®¡ç®—éå¸¸ä½æ•ˆï¼Œæˆ‘ä»¬åº”è¯¥å¯¹å¤šæ¬¡ä½¿ç”¨çš„RDDè¿›è¡Œä¸€ä¸ªæŒä¹…åŒ–æ“ä½œã€‚</p><p>Sparkçš„persist()å’Œcache()æ–¹æ³•æ”¯æŒå°†RDDçš„æ•°æ®ç¼“å­˜è‡³å†…å­˜æˆ–ç¡¬ç›˜ä¸­ï¼Œè¿™æ ·å½“ä¸‹æ¬¡å¯¹åŒä¸€RDDè¿›è¡ŒActionæ“ä½œæ—¶ï¼Œå¯ä»¥ç›´æ¥è¯»å–RDDçš„ç»“æœï¼Œå¤§å¹…æé«˜äº†Sparkçš„è®¡ç®—æ•ˆç‡ã€‚</p><pre><code>rdd = sc.parallelize([1, 2, 3, 4, 5])\nrdd1 = rdd.map(lambda x: x+5)\nrdd2 = rdd1.filter(lambda x: x % 2 == 0)\nrdd2.persist()\ncount = rdd2.count() // 3\nfirst = rdd2.first() // 6\nrdd2.unpersist()\n</code></pre><p>åœ¨æ–‡ä¸­çš„ä»£ç ä¾‹å­ä¸­ä½ å¯ä»¥çœ‹åˆ°ï¼Œæˆ‘ä»¬å¯¹RDD2è¿›è¡Œäº†å¤šä¸ªä¸åŒçš„actionæ“ä½œã€‚ç”±äºåœ¨ç¬¬å››è¡Œæˆ‘æŠŠRDD2çš„ç»“æœç¼“å­˜åœ¨å†…å­˜ä¸­ï¼Œæ‰€ä»¥Sparkæ— éœ€ä»ä¸€å¼€å§‹çš„rddå¼€å§‹ç®—èµ·äº†ï¼ˆæŒä¹…åŒ–å¤„ç†è¿‡çš„RDDåªæœ‰ç¬¬ä¸€æ¬¡æœ‰actionæ“ä½œæ—¶æ‰ä¼šä»æºå¤´è®¡ç®—ï¼Œä¹‹åå°±æŠŠç»“æœå­˜å‚¨ä¸‹æ¥ï¼Œæ‰€ä»¥åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œcountéœ€è¦ä»æºå¤´å¼€å§‹è®¡ç®—ï¼Œè€Œfirstä¸éœ€è¦ï¼‰ã€‚</p><p>åœ¨ç¼“å­˜RDDçš„æ—¶å€™ï¼Œå®ƒæ‰€æœ‰çš„ä¾èµ–å…³ç³»ä¹Ÿä¼šè¢«ä¸€å¹¶å­˜ä¸‹æ¥ã€‚æ‰€ä»¥æŒä¹…åŒ–çš„RDDæœ‰è‡ªåŠ¨çš„å®¹é”™æœºåˆ¶ã€‚å¦‚æœRDDçš„ä»»ä¸€åˆ†åŒºä¸¢å¤±äº†ï¼Œé€šè¿‡ä½¿ç”¨åŸå…ˆåˆ›å»ºå®ƒçš„è½¬æ¢æ“ä½œï¼Œå®ƒå°†ä¼šè¢«è‡ªåŠ¨é‡ç®—ã€‚</p><p>æŒä¹…åŒ–å¯ä»¥é€‰æ‹©ä¸åŒçš„å­˜å‚¨çº§åˆ«ã€‚æ­£å¦‚æˆ‘ä»¬è®²RDDçš„ç»“æ„æ—¶æåˆ°çš„ä¸€æ ·ï¼Œæœ‰MEMORY_ONLYï¼ŒMEMORY_AND_DISKï¼ŒDISK_ONLYç­‰ã€‚cache()æ–¹æ³•ä¼šé»˜è®¤å–MEMORY_ONLYè¿™ä¸€çº§åˆ«ã€‚</p><h2>å°ç»“</h2><p>Sparkåœ¨æ¯æ¬¡è½¬æ¢æ“ä½œçš„æ—¶å€™ä½¿ç”¨äº†æ–°äº§ç”Ÿçš„ RDD æ¥è®°å½•è®¡ç®—é€»è¾‘ï¼Œè¿™æ ·å°±æŠŠä½œç”¨åœ¨ RDD ä¸Šçš„æ‰€æœ‰è®¡ç®—é€»è¾‘ä¸²èµ·æ¥å½¢æˆäº†ä¸€ä¸ªé“¾æ¡ï¼Œä½†æ˜¯å¹¶ä¸ä¼šçœŸçš„å»è®¡ç®—ç»“æœã€‚å½“å¯¹ RDD è¿›è¡ŒåŠ¨ä½œActionæ—¶ï¼ŒSpark ä¼šä»è®¡ç®—é“¾çš„æœ€åä¸€ä¸ªRDDå¼€å§‹ï¼Œåˆ©ç”¨è¿­ä»£å‡½æ•°ï¼ˆIteratorï¼‰å’Œè®¡ç®—å‡½æ•°ï¼ˆComputeï¼‰ï¼Œä¾æ¬¡ä»ä¸Šä¸€ä¸ªRDDè·å–æ•°æ®å¹¶æ‰§è¡Œè®¡ç®—é€»è¾‘ï¼Œæœ€åè¾“å‡ºç»“æœã€‚</p><p>æ­¤å¤–ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡å°†ä¸€äº›éœ€è¦å¤æ‚è®¡ç®—å’Œç»å¸¸è°ƒç”¨çš„RDDè¿›è¡ŒæŒä¹…åŒ–å¤„ç†ï¼Œä»è€Œæå‡è®¡ç®—æ•ˆç‡ã€‚</p><h2>æ€è€ƒé¢˜</h2><p>å¯¹RDDè¿›è¡ŒæŒä¹…åŒ–æ“ä½œå’Œè®°å½•Checkpointï¼Œæœ‰ä»€ä¹ˆåŒºåˆ«å‘¢ï¼Ÿ</p><p>æ¬¢è¿ä½ æŠŠå¯¹å¼¹æ€§åˆ†å¸ƒå¼æ•°æ®é›†çš„ç–‘é—®å†™åœ¨ç•™è¨€åŒºï¼Œä¸æˆ‘å’Œå…¶ä»–åŒå­¦ä¸€èµ·è®¨è®ºã€‚å¦‚æœä½ è§‰å¾—æœ‰æ‰€æ”¶è·ï¼Œä¹Ÿæ¬¢è¿æŠŠæ–‡ç« åˆ†äº«ç»™ä½ çš„æœ‹å‹ã€‚</p><p></p>","neighbors":{"left":{"article_title":"13 | å¼¹æ€§åˆ†å¸ƒå¼æ•°æ®é›†ï¼šSparkå¤§å¦çš„åœ°åŸºï¼ˆä¸Šï¼‰","id":94974},"right":{"article_title":"15 | Spark SQLï¼šSparkæ•°æ®æŸ¥è¯¢çš„åˆ©å™¨","id":96256}},"comments":[{"had_liked":false,"id":95438,"user_name":"é”¦","can_delete":false,"product_type":"c1","uid":1468298,"ip_address":"","ucode":"CB0EB4B68C468B","user_header":"https://static001.geekbang.org/account/avatar/00/16/67/8a/babd74dc.jpg","comment_is_top":false,"comment_ctime":1558056466,"is_pvip":false,"replies":[{"id":"48533","content":"ğŸ‘ğŸ»","user_name":"ä½œè€…å›å¤","user_name_real":"Xinyue Li","uid":"1502409","ctime":1567392382,"ip_address":"","comment_id":95438,"utype":1}],"discussion_count":4,"race_medal":0,"score":"263551061522","product_id":100025301,"comment_content":"åŒºåˆ«åœ¨äºCheckpointä¼šæ¸…ç©ºè¯¥RDDçš„ä¾èµ–å…³ç³»ï¼Œå¹¶æ–°å»ºä¸€ä¸ªCheckpointRDDä¾èµ–å…³ç³»ï¼Œè®©è¯¥RDDä¾èµ–ï¼Œå¹¶ä¿å­˜åœ¨ç£ç›˜æˆ–HDFSæ–‡ä»¶ç³»ç»Ÿä¸­ï¼Œå½“æ•°æ®æ¢å¤æ—¶ï¼Œå¯é€šè¿‡CheckpointRDDè¯»å–RDDè¿›è¡Œæ•°æ®è®¡ç®—ï¼›æŒä¹…åŒ–RDDä¼šä¿å­˜ä¾èµ–å…³ç³»å’Œè®¡ç®—ç»“æœè‡³å†…å­˜ä¸­ï¼Œå¯ç”¨äºåç»­è®¡ç®—ã€‚","like_count":62,"discussions":[{"author":{"id":1502409,"avatar":"https://static001.geekbang.org/account/avatar/00/16/ec/c9/45bfcba3.jpg","nickname":"Xinyue Li","note":"","ucode":"0CB92610C8B9FC","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":450458,"discussion_content":"ğŸ‘ğŸ»","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1567392382,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":1}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1266620,"avatar":"https://static001.geekbang.org/account/avatar/00/13/53/bc/72baeee8.jpg","nickname":"æ—é»›ç‰","note":"","ucode":"F8507366012881","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":10952,"discussion_content":"è¯¾ä»£è¡¨è¯·åã€‚\nåä¼˜åŒ–ä¸å‰ä¼˜åŒ–çš„ä½¿ç”¨æ˜¯sparkè®¾è®¡çš„å·§å¦™ä¹‹å¤„ï¼Œæƒ°æ€§è®¡ç®—æœºåˆ¶ä½¿å¾—è®¡ç®—é€»è¾‘å¯ä»¥ä»åå‘å‰ï¼Œç”±æ¼æ–—å˜çº¿ä½“ï¼ŒèŠ‚çœäº†è¿è¡Œå¼€é”€ï¼›æŒä¹…åŒ–persistä¸æ£€æŸ¥ç‚¹checkpointæœºåˆ¶ç›¸å½“äºæˆ‘ä»¬å·²ç»ç¡®å®šè¿™æ­¥è¦åšï¼Œä¸”åšå¥½äº†ï¼Œä»¥åéƒ½å¯ä»¥åŸºäºç°æˆçš„ï¼Œè¿™ä¹Ÿæé«˜äº†è¿è¡Œæ•ˆç‡ã€‚","likes_number":1,"is_delete":false,"is_hidden":false,"ctime":1568342295,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1009644,"avatar":"http://thirdwx.qlogo.cn/mmopen/vi_32/DYAIOgq83erms9qcIFYZ4npgLYPu1QgxQyaXcj64ZBicNVeBRWcYUpCZ9p0BGsrEcX8heibMLCV4Gde4P9pf7PjA/132","nickname":"yanger2004","note":"","ucode":"0A2CD03EF31052","race_medal":0,"user_type":1,"is_pvip":true},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":574925,"discussion_content":"æŒä¹…åŒ–ä¹Ÿå¯ä»¥æ˜¯ç¡¬ç›˜çš„","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1654441144,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1581245,"avatar":"https://static001.geekbang.org/account/avatar/00/18/20/bd/5656b5d7.jpg","nickname":"èµ°åˆ€å£ ğŸ’°","note":"","ucode":"C7E2B812A4A02C","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":362195,"discussion_content":"ä½œè€…ä½ è¿™ä¹Ÿå‘ä¸ªğŸ‘ğŸ»ï¼Ÿä»–è¯´çš„æ ¹æœ¬ä¸å¯¹","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1616885247,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":95413,"user_name":"RocWay","can_delete":false,"product_type":"c1","uid":1088024,"ip_address":"","ucode":"377CD114BABBF7","user_header":"https://static001.geekbang.org/account/avatar/00/10/9a/18/3596069c.jpg","comment_is_top":false,"comment_ctime":1558054452,"is_pvip":false,"replies":[{"id":"48537","content":"è¿™ä½åŒå­¦çš„ç†è§£æ˜¯å¾ˆå‡†ç¡®çš„","user_name":"ä½œè€…å›å¤","user_name_real":"Xinyue Li","uid":"1502409","ctime":1567392564,"ip_address":"","comment_id":95413,"utype":1}],"discussion_count":1,"race_medal":0,"score":"113227204148","product_id":100025301,"comment_content":"ä¸»è¦åŒºåˆ«åº”è¯¥æ˜¯å¯¹ä¾èµ–é“¾çš„å¤„ç†ï¼š<br>checkpointåœ¨actionä¹‹åæ‰§è¡Œï¼Œç›¸å½“äºäº‹åŠ¡å®Œæˆåå¤‡ä»½ç»“æœã€‚æ—¢ç„¶ç»“æœæœ‰äº†ï¼Œä¹‹å‰çš„è®¡ç®—è¿‡ç¨‹ï¼Œä¹Ÿå°±æ˜¯RDDçš„ä¾èµ–é“¾ï¼Œä¹Ÿå°±ä¸éœ€è¦äº†ï¼Œæ‰€ä»¥ä¸å¿…ä¿å­˜ã€‚<br>ä½†æ˜¯cacheå’Œpersiståªæ˜¯ä¿å­˜å½“å‰RDDï¼Œå¹¶ä¸è¦æ±‚æ˜¯åœ¨actionä¹‹åè°ƒç”¨ã€‚ç›¸å½“äºäº‹åŠ¡çš„è®¡ç®—è¿‡ç¨‹ï¼Œè¿˜æ²¡æœ‰ç»“æœã€‚æ—¢ç„¶æ²¡æœ‰ç»“æœï¼Œå½“éœ€è¦æ¢å¤ã€é‡æ–°è®¡ç®—æ—¶å°±è¦é‡æ”¾è®¡ç®—è¿‡ç¨‹ï¼Œè‡ªç„¶ä¹‹å‰çš„ä¾èµ–é“¾ä¸èƒ½æ”¾å¼ƒï¼Œä¹Ÿéœ€è¦ä¿å­˜ä¸‹æ¥ã€‚éœ€è¦æ¢å¤æ—¶å°±è¦ä»æœ€åˆçš„æˆ–æœ€è¿‘çš„checkpointå¼€å§‹é‡æ–°è®¡ç®—ã€‚","like_count":27,"discussions":[{"author":{"id":1502409,"avatar":"https://static001.geekbang.org/account/avatar/00/16/ec/c9/45bfcba3.jpg","nickname":"Xinyue Li","note":"","ucode":"0CB92610C8B9FC","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":450448,"discussion_content":"è¿™ä½åŒå­¦çš„ç†è§£æ˜¯å¾ˆå‡†ç¡®çš„","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1567392564,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":1}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":95367,"user_name":"æ¶µ","can_delete":false,"product_type":"c1","uid":1502742,"ip_address":"","ucode":"BB8575DB13F1E0","user_header":"https://static001.geekbang.org/account/avatar/00/16/ee/16/742956ac.jpg","comment_is_top":false,"comment_ctime":1558044070,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"61687586214","product_id":100025301,"comment_content":"ä»ç›®çš„ä¸Šæ¥è¯´ï¼Œcheckpointç”¨äºæ•°æ®æ¢å¤ï¼ŒRDDæŒä¹…åŒ–ç”¨äºRDDçš„å¤šæ¬¡è®¡ç®—æ“ä½œçš„æ€§èƒ½ä¼˜åŒ–ï¼Œé¿å…é‡å¤è®¡ç®—ã€‚ä»å­˜å‚¨ä½ç½®ä¸Šçœ‹checkpointå‚¨å­˜åœ¨å¤–å­˜ä¸­ï¼ŒRDDå¯ä»¥æ ¹æ®å­˜å‚¨çº§åˆ«å­˜å‚¨åœ¨å†…å­˜æˆ–&#47;å’Œå¤–å­˜ä¸­ã€‚","like_count":14},{"had_liked":false,"id":102539,"user_name":"ç…å‰‘","can_delete":false,"product_type":"c1","uid":1504220,"ip_address":"","ucode":"4290D5C140F80F","user_header":"https://static001.geekbang.org/account/avatar/00/16/f3/dc/80b0cd23.jpg","comment_is_top":false,"comment_ctime":1560246932,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"31625018004","product_id":100025301,"comment_content":"1.è®¾ç½®checkpointæ—¶éœ€è¦æŒ‡å®šcheckpointçš„å­˜å‚¨ç›®å½•ï¼Œè€ŒæŒä¹…åŒ–ä¸ç®¡æ˜¯ç›´æ¥è°ƒç”¨cacheè¿˜æ˜¯é€šè¿‡persistæŒ‡å®šç¼“å­˜çº§åˆ«éƒ½ä¸éœ€è¦æŒ‡å®šå­˜å‚¨ç›®å½•ï¼Œç”±ç³»ç»Ÿè‡ªå·±æŒ‡å®š<br>2.checkpointæ˜¯å°†RDDå»é™¤ä¾èµ–å…³ç³»åå°†æ•°æ®ç›´æ¥å­˜å‚¨åˆ°ç£ç›˜ï¼Œä¸”ä¸€èˆ¬æ˜¯HDFSï¼Œå¸¦æœ‰å¤‡ä»½ï¼Œå› æ­¤ä¸å®¹æ˜“ä¸¢å¤±ï¼Œæ¢å¤æ—¶ç›´æ¥è·å–checkpointçš„æ•°æ®ï¼›è€ŒæŒä¹…åŒ–ä¸€èˆ¬æ˜¯ç›´æ¥cacheåˆ°å†…å­˜ã€‚æ•°æ®å®¹æ˜“ä¸¢å¤±ï¼Œå³ä¾¿æ˜¯é€šè¿‡è®¾ç½®MEMORY_AND_DISK_2ç­‰ç¼“å­˜çº§åˆ«è¾¾åˆ°å†…å­˜å’Œç£ç›˜éƒ½æœ‰å¤‡ä»½ï¼Œä¹Ÿä¼šåœ¨æ¯ä¸ªå¤‡ä»½ä¸­éƒ½ç¼“å­˜RDDçš„ä¾èµ–å…³ç³»ï¼Œé€ æˆä¸å¿…è¦çš„å†—ä½™","like_count":7},{"had_liked":false,"id":95503,"user_name":"hua168","can_delete":false,"product_type":"c1","uid":1065255,"ip_address":"","ucode":"CFF9A7E86EBA48","user_header":"https://static001.geekbang.org/account/avatar/00/10/41/27/3ff1a1d6.jpg","comment_is_top":false,"comment_ctime":1558067518,"is_pvip":false,"replies":[{"id":"48546","content":"å¦‚æœé™å®šä¸ºå•æœºå¤„ç†ï¼Œæˆ‘è§‰å¾—ä½ çš„ç¬¬äºŒä¸ªæ€è·¯æ˜¯å¯è¡Œçš„ï¼Œç¬¬ä¸€ä¸ªè¡Œä¸é€šã€‚","user_name":"ä½œè€…å›å¤","user_name_real":"Xinyue Li","uid":"1502409","ctime":1567393450,"ip_address":"","comment_id":95503,"utype":1}],"discussion_count":2,"race_medal":0,"score":"31622838590","product_id":100025301,"comment_content":"è€å¸ˆï¼Œæˆ‘æƒ³é—®ä¸‹ï¼Œå¦‚æœæ˜¯linux å‘½ä»¤åˆ†æå•æœº300G logæ—¥å¿—ï¼Œå†…å­˜åªæœ‰16Gï¼Œæ€æï¼Ÿ<br>å¦‚æœç”¨sparkæ€æƒ³ï¼Œï¼Œä»ioè¯»å¾ˆå¡ï¼Œç›´æ¥å†…å­˜çˆ†äº†ã€‚<br>å¦‚æœå…ˆåˆ†å‰²æ—¥å¿—ä¸º100ä»½ï¼Œå†ç”¨shellï¼Œä¸€ä¸‹10ä¸ªå¹¶å‘æ‰§è¡Œï¼Œæœ€åç»“æœåˆå¹¶ã€‚æ„Ÿè§‰è¿˜æ˜¯æœ‰ç‚¹æ…¢ã€‚","like_count":7,"discussions":[{"author":{"id":1502409,"avatar":"https://static001.geekbang.org/account/avatar/00/16/ec/c9/45bfcba3.jpg","nickname":"Xinyue Li","note":"","ucode":"0CB92610C8B9FC","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":450485,"discussion_content":"å¦‚æœé™å®šä¸ºå•æœºå¤„ç†ï¼Œæˆ‘è§‰å¾—ä½ çš„ç¬¬äºŒä¸ªæ€è·¯æ˜¯å¯è¡Œçš„ï¼Œç¬¬ä¸€ä¸ªè¡Œä¸é€šã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1567393450,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":1}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1129610,"avatar":"https://static001.geekbang.org/account/avatar/00/11/3c/8a/900ca88a.jpg","nickname":"test","note":"","ucode":"C57A175CBC6547","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":382810,"discussion_content":"æ€ä¹ˆå¹¶å‘ï¼Œå¹¶å‘ä¹Ÿè¦30g","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1625729796,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":95428,"user_name":"JohnT3e","can_delete":false,"product_type":"c1","uid":1063982,"ip_address":"","ucode":"CF4AAAC933529C","user_header":"http://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTLdWHFCr66TzHS2CpCkiaRaDIk3tU5sKPry16Q7ic0mZZdy8LOCYc38wOmyv5RZico7icBVeaPX8X2jcw/132","comment_is_top":false,"comment_ctime":1558055678,"is_pvip":false,"replies":[{"id":"48534","content":"è¿™ä½åŒå­¦çš„ç†è§£å¾ˆå‡†ç¡®","user_name":"ä½œè€…å›å¤","user_name_real":"Xinyue Li","uid":"1502409","ctime":1567392448,"ip_address":"","comment_id":95428,"utype":1}],"discussion_count":2,"race_medal":0,"score":"23032892158","product_id":100025301,"comment_content":"ä¸¤è€…åŒºåˆ«åœ¨äºä¾èµ–å…³ç³»æ˜¯å¦ä¿ç•™å§ã€‚checkpointçš„è¯ï¼Œæ£€æŸ¥ç‚¹ä¹‹å‰çš„å…³ç³»åº”è¯¥ä¸¢å¤±äº†ï¼Œä½†å…¶æ•°æ®å·²ç»æŒä¹…åŒ–äº†ï¼›è€Œpersistæˆ–è€…cacheä¿ç•™äº†è¿™ä¸ªä¾èµ–å…³ç³»ï¼Œå¦‚æœç¼“å­˜ç»“æœæœ‰ä¸¢å¤±ï¼Œå¯ä»¥é€šè¿‡è¿™ä¸ªå…³ç³»è¿›è¡Œrebuildã€‚","like_count":5,"discussions":[{"author":{"id":1502409,"avatar":"https://static001.geekbang.org/account/avatar/00/16/ec/c9/45bfcba3.jpg","nickname":"Xinyue Li","note":"","ucode":"0CB92610C8B9FC","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":450453,"discussion_content":"è¿™ä½åŒå­¦çš„ç†è§£å¾ˆå‡†ç¡®","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1567392448,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":1}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1129610,"avatar":"https://static001.geekbang.org/account/avatar/00/11/3c/8a/900ca88a.jpg","nickname":"test","note":"","ucode":"C57A175CBC6547","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":382835,"discussion_content":"ä¾èµ–å…³ç³»ä¿å­˜åœ¨å“ªé‡Œ","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1625736220,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":95632,"user_name":"æŒ–çŸ¿çš„å°æˆˆ","can_delete":false,"product_type":"c1","uid":1503917,"ip_address":"","ucode":"2078A85139BD5D","user_header":"http://thirdwx.qlogo.cn/mmopen/vi_32/9chAb6SjxFiapSeicsAsGqzziaNlhX9d5aEt8Z0gUNsZJ9dICaDHqAypGvjv4Bx3PryHnj7OFnOXFOp7Ik21CVXEA/132","comment_is_top":false,"comment_ctime":1558106075,"is_pvip":false,"replies":[{"id":"48532","content":"ç†è§£çš„å¾ˆå¯¹","user_name":"ä½œè€…å›å¤","user_name_real":"Xinyue Li","uid":"1502409","ctime":1567392341,"ip_address":"","comment_id":95632,"utype":1}],"discussion_count":1,"race_medal":0,"score":"18737975259","product_id":100025301,"comment_content":"1. å‰è€…ï¼špersistæˆ–è€…cacheé™¤äº†é™¤äº†æŒä¹…åŒ–è¯¥RDDå¤–ï¼Œè¿˜ä¼šä¿ç•™è¯¥RDDå‰é¢çš„ä¾èµ–å…³ç³»<br>2. åè€…ï¼šå°†è¯¥RDDä¿å­˜åˆ°ç£ç›˜ä¸Šï¼Œå¹¶æ¸…é™¤å‰é¢çš„ä¾èµ–å…³ç³»<br>æ„Ÿè§‰åè€…çš„å¼€é”€ä¼šå¤§å¾ˆå¤š","like_count":4,"discussions":[{"author":{"id":1502409,"avatar":"https://static001.geekbang.org/account/avatar/00/16/ec/c9/45bfcba3.jpg","nickname":"Xinyue Li","note":"","ucode":"0CB92610C8B9FC","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":450539,"discussion_content":"ç†è§£çš„å¾ˆå¯¹","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1567392341,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":1}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":95426,"user_name":"miwucc","can_delete":false,"product_type":"c1","uid":1326429,"ip_address":"","ucode":"7935BD907119AE","user_header":"https://static001.geekbang.org/account/avatar/00/14/3d/5d/ac666969.jpg","comment_is_top":false,"comment_ctime":1558055639,"is_pvip":false,"replies":[{"id":"48535","content":"å¹¶ä¸æ˜¯ï¼Œcheckpointä¼šå°†ä¸€äº›RDDçš„ç»“æœå­˜å…¥ç¡¬ç›˜ï¼Œä½†æ˜¯ä¸ä¼šä¿ç•™ä¾èµ–å…³ç³»ï¼›ç¼“å­˜å‡½æ•°æˆ–è€…æŒä¹…åŒ–å¤„ç†ä¼šä¿ç•™ä¾èµ–å…³ç³»ï¼Œæ‰€ä»¥é”™è¯¯æ¢å¤ä¼šæ›´æ–¹ä¾¿ã€‚","user_name":"ä½œè€…å›å¤","user_name_real":"Xinyue Li","uid":"1502409","ctime":1567392543,"ip_address":"","comment_id":95426,"utype":1}],"discussion_count":1,"race_medal":0,"score":"14442957527","product_id":100025301,"comment_content":"æ‰‹åŠ¨è°ƒç”¨ç¼“å­˜å‡½æ•°å’Œcheckpointæœ¬è´¨ä¸Šæ˜¯ä¸€æ ·çš„å§ã€‚å°±æ˜¯ä¸€ä¸ªæ‰‹åŠ¨æ§åˆ¶è½ç›˜æ—¶é—´ï¼Œä¸€ä¸ªè‡ªåŠ¨æ§åˆ¶ã€‚","like_count":3,"discussions":[{"author":{"id":1502409,"avatar":"https://static001.geekbang.org/account/avatar/00/16/ec/c9/45bfcba3.jpg","nickname":"Xinyue Li","note":"","ucode":"0CB92610C8B9FC","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":450451,"discussion_content":"å¹¶ä¸æ˜¯ï¼Œcheckpointä¼šå°†ä¸€äº›RDDçš„ç»“æœå­˜å…¥ç¡¬ç›˜ï¼Œä½†æ˜¯ä¸ä¼šä¿ç•™ä¾èµ–å…³ç³»ï¼›ç¼“å­˜å‡½æ•°æˆ–è€…æŒä¹…åŒ–å¤„ç†ä¼šä¿ç•™ä¾èµ–å…³ç³»ï¼Œæ‰€ä»¥é”™è¯¯æ¢å¤ä¼šæ›´æ–¹ä¾¿ã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1567392543,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":1}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":95401,"user_name":"å»–å¸ˆè™","can_delete":false,"product_type":"c1","uid":1485562,"ip_address":"","ucode":"1297068AE141DA","user_header":"https://static001.geekbang.org/account/avatar/00/16/aa/fa/3ad0a689.jpg","comment_is_top":false,"comment_ctime":1558053197,"is_pvip":false,"replies":[{"id":"48540","content":"ç¿»è¯‘ä¹Ÿæ˜¯ä¸ºäº†æ–¹ä¾¿è‹±æ–‡ä¸å¥½çš„åŒå­¦ç†è§£ï¼Œä½†æ˜¯æ¯ä¸ªåæ¬¡ç¬¬ä¸€æ¬¡å‡ºç°æˆ‘éƒ½ä¼šæ ‡å‡ºè‹±æ–‡ã€‚<br>","user_name":"ä½œè€…å›å¤","user_name_real":"Xinyue Li","uid":"1502409","ctime":1567392778,"ip_address":"","comment_id":95401,"utype":1}],"discussion_count":1,"race_medal":0,"score":"14442955085","product_id":100025301,"comment_content":"è®°ä¸å¤ªæ¸…é™¤äº†ï¼Œcheckpointæ¸…é™¤è¡€ç¼˜å…³ç³»ï¼Œä¸€èˆ¬ä¿å­˜åœ¨ç±»hdfsæ–‡ä»¶ç³»ç»Ÿï¼Œç›®çš„æ˜¯å®¹é”™ï¼Œç¼“å­˜æ˜¯ä¿ç•™è¡€ç¼˜å…³ç³»ï¼Œå¹¶ä¿å­˜åœ¨æœ¬æœºï¼Œçš„ç›®çš„æ˜¯æé«˜æ•ˆç‡ï¼ŒHigh performance Sparkä¹¦è®²å¾—å¾ˆè¯¦ç»†ã€‚<br><br>ç¬¬ä¸€æ¬¡é‡åˆ°æŠŠdriverç¿»è¯‘æˆé©±åŠ¨ç¨‹åºçš„ï¼Œä¸ªäººæ„Ÿè§‰è¿˜æ˜¯ä¿ç•™Driverï¼ŒActionä¸ºä½³ã€‚","like_count":3,"discussions":[{"author":{"id":1502409,"avatar":"https://static001.geekbang.org/account/avatar/00/16/ec/c9/45bfcba3.jpg","nickname":"Xinyue Li","note":"","ucode":"0CB92610C8B9FC","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":450442,"discussion_content":"ç¿»è¯‘ä¹Ÿæ˜¯ä¸ºäº†æ–¹ä¾¿è‹±æ–‡ä¸å¥½çš„åŒå­¦ç†è§£ï¼Œä½†æ˜¯æ¯ä¸ªåæ¬¡ç¬¬ä¸€æ¬¡å‡ºç°æˆ‘éƒ½ä¼šæ ‡å‡ºè‹±æ–‡ã€‚\n","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1567392778,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":1}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":95703,"user_name":"Peter","can_delete":false,"product_type":"c1","uid":1506885,"ip_address":"","ucode":"D2A0BB2F6A7236","user_header":"https://static001.geekbang.org/account/avatar/00/16/fe/45/c353f3da.jpg","comment_is_top":false,"comment_ctime":1558146043,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"10148080635","product_id":100025301,"comment_content":"åœ¨è®¡ç®—è¿‡ç¨‹ä¸­ï¼Œå¯¹äºä¸€äº›è®¡ç®—è¿‡ç¨‹æ¯”è¾ƒè€—æ—¶çš„ RDDï¼Œæˆ‘ä»¬å¯ä»¥å°†å®ƒç¼“å­˜è‡³ç¡¬ç›˜æˆ– HDFS ä¸­ï¼Œæ ‡è®°è¿™ä¸ª RDD æœ‰è¢«æ£€æŸ¥ç‚¹å¤„ç†è¿‡ï¼Œå¹¶ä¸”æ¸…ç©ºå®ƒçš„æ‰€æœ‰ä¾èµ–å…³ç³»ã€‚åŒæ—¶ï¼Œç»™å®ƒæ–°å»ºä¸€ä¸ªä¾èµ–äº CheckpointRDD çš„ä¾èµ–å…³ç³»ï¼ŒCheckpointRDD å¯ä»¥ç”¨æ¥ä»ç¡¬ç›˜ä¸­è¯»å– RDD å’Œç”Ÿæˆæ–°çš„åˆ†åŒºä¿¡æ¯ã€‚<br>","like_count":2},{"had_liked":false,"id":95410,"user_name":"Steven","can_delete":false,"product_type":"c1","uid":1141382,"ip_address":"","ucode":"BDE4911550BDE6","user_header":"https://static001.geekbang.org/account/avatar/00/11/6a/86/f1876812.jpg","comment_is_top":false,"comment_ctime":1558054130,"is_pvip":false,"replies":[{"id":"48576","content":"ä½ çš„è§‚å¯Ÿå¾ˆä»”ç»†ï¼Œè¿™é‡Œç¡®å®æ˜¯ç¬”è¯¯ã€‚æŒä¹…åŒ–å¤„ç†è¿‡çš„RDDåªæœ‰ç¬¬ä¸€æ¬¡æœ‰actionæ“ä½œæ—¶æ‰ä¼šä»æºå¤´è®¡ç®—ï¼Œä¹‹åå°±æŠŠç»“æœå­˜å‚¨ä¸‹æ¥ã€‚æ‰€ä»¥åœ¨è¿™ä¸ªä¾‹å­ä¸­Countéœ€è¦ä»æºå¤´å¼€å§‹è®¡ç®—ï¼Œè€Œfirstä¸éœ€è¦ã€‚","user_name":"ä½œè€…å›å¤","user_name_real":"Xinyue Li","uid":"1502409","ctime":1567411611,"ip_address":"","comment_id":95410,"utype":1}],"discussion_count":3,"race_medal":0,"score":"10147988722","product_id":100025301,"comment_content":"ç¼“å­˜äº†ä¹‹åï¼Œç¬¬ä¸€ä¸ªactionè¿˜æ˜¯éœ€è¦ä»å¤´è®¡ç®—çš„å§ï¼Ÿ &quot;æ‰€ä»¥æ— è®ºæ˜¯ count è¿˜æ˜¯ firstï¼ŒSpark éƒ½æ— éœ€ä»å¤´è®¡ç®—&quot;ï¼Œ è¿™å¥è¯æ˜¯ä¸æ˜¯æœ‰è¯¯ï¼Ÿ","like_count":2,"discussions":[{"author":{"id":1502409,"avatar":"https://static001.geekbang.org/account/avatar/00/16/ec/c9/45bfcba3.jpg","nickname":"Xinyue Li","note":"","ucode":"0CB92610C8B9FC","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":450446,"discussion_content":"ä½ çš„è§‚å¯Ÿå¾ˆä»”ç»†ï¼Œè¿™é‡Œç¡®å®æ˜¯ç¬”è¯¯ã€‚æŒä¹…åŒ–å¤„ç†è¿‡çš„RDDåªæœ‰ç¬¬ä¸€æ¬¡æœ‰actionæ“ä½œæ—¶æ‰ä¼šä»æºå¤´è®¡ç®—ï¼Œä¹‹åå°±æŠŠç»“æœå­˜å‚¨ä¸‹æ¥ã€‚æ‰€ä»¥åœ¨è¿™ä¸ªä¾‹å­ä¸­Countéœ€è¦ä»æºå¤´å¼€å§‹è®¡ç®—ï¼Œè€Œfirstä¸éœ€è¦ã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1567411611,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":1}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1086295,"avatar":"https://static001.geekbang.org/account/avatar/00/10/93/57/3ffdfc8d.jpg","nickname":"vigo","note":"","ucode":"036CEE5F3FABE7","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":25968,"discussion_content":"ç¼“å­˜ä¹‹åï¼Œç¬¬ä¸€ä¸ªactionè¿˜ä»å¤´è®¡ç®—çš„è®¾è®¡åŸå› ä¸ºä»€ä¹ˆå‘€ï¼Ÿ","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1570582006,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":1,"child_discussions":[{"author":{"id":1129610,"avatar":"https://static001.geekbang.org/account/avatar/00/11/3c/8a/900ca88a.jpg","nickname":"test","note":"","ucode":"C57A175CBC6547","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":1086295,"avatar":"https://static001.geekbang.org/account/avatar/00/10/93/57/3ffdfc8d.jpg","nickname":"vigo","note":"","ucode":"036CEE5F3FABE7","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":382840,"discussion_content":"å› ä¸ºè¿™ä¸ªæ—¶å€™è¿˜æ²¡æœ‰ç»“æœå•Šï¼Œæ‰€ä»¥è¦ç®—ä¸€ä¸‹ï¼Œç„¶åæŠŠè¿™ä¸ªç»“æœä¿å­˜ä¸‹ï¼Œåé¢çš„actionå°±åœ¨è¿™ä¸ªåŸºç¡€ä¸Šåš","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1625736876,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":25968,"ip_address":""},"score":382840,"extra":""}]}]},{"had_liked":false,"id":95403,"user_name":"cricket1981","can_delete":false,"product_type":"c1","uid":1001715,"ip_address":"","ucode":"758262F5958DA4","user_header":"https://static001.geekbang.org/account/avatar/00/0f/48/f3/f1034ffd.jpg","comment_is_top":false,"comment_ctime":1558053256,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"10147987848","product_id":100025301,"comment_content":"RDDçš„checkpointä¼šå¯¼è‡´å†™å…¥å¯é å­˜å‚¨çš„å¼€é”€ã€‚è¿™å¯èƒ½å¯¼è‡´RDDè¢«checkpointçš„é‚£äº›æ‰¹æ¬¡çš„å¤„ç†æ—¶é—´å¢åŠ ã€‚ç›¸åï¼Œcheckpointå¤ªè¿‡ä¸é¢‘ç¹ä¼šå¯¼è‡´è¡€ç»Ÿé“¾å¢é•¿å’Œä»»åŠ¡å¤§å°å¢åŠ ã€‚è¯·é—®è¯¥å¦‚ä½•è®¾ç½®åˆç†çš„checkpointæ—¶é—´é—´éš”å‘¢ï¼Ÿ","like_count":2},{"had_liked":false,"id":95402,"user_name":"jon","can_delete":false,"product_type":"c1","uid":1253287,"ip_address":"","ucode":"5768A34E292CAA","user_header":"https://static001.geekbang.org/account/avatar/00/13/1f/a7/d379ca4f.jpg","comment_is_top":false,"comment_ctime":1558053250,"is_pvip":false,"replies":[{"id":"48545","content":"ğŸ‘ğŸ»","user_name":"ä½œè€…å›å¤","user_name_real":"Xinyue Li","uid":"1502409","ctime":1567393360,"ip_address":"","comment_id":95402,"utype":1}],"discussion_count":1,"race_medal":0,"score":"10147987842","product_id":100025301,"comment_content":"checkpointä¸ä¼šå­˜å‚¨è¯¥rddå‰é¢çš„ä¾èµ–å…³ç³»ï¼Œå®ƒåé¢çš„rddéƒ½ä¾èµ–äºå®ƒã€‚<br>persistã€ cacheæ“ä½œä¼šå­˜å‚¨ä¾èµ–å…³ç³»ï¼Œå½“ä¸€ä¸ªåˆ†åŒºä¸¢å¤±åå¯ä»¥æ ¹æ®ä¾èµ–é‡æ–°è®¡ç®—ã€‚","like_count":2,"discussions":[{"author":{"id":1502409,"avatar":"https://static001.geekbang.org/account/avatar/00/16/ec/c9/45bfcba3.jpg","nickname":"Xinyue Li","note":"","ucode":"0CB92610C8B9FC","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":450443,"discussion_content":"ğŸ‘ğŸ»","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1567393360,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":1}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":95396,"user_name":"cricket1981","can_delete":false,"product_type":"c1","uid":1001715,"ip_address":"","ucode":"758262F5958DA4","user_header":"https://static001.geekbang.org/account/avatar/00/0f/48/f3/f1034ffd.jpg","comment_is_top":false,"comment_ctime":1558052495,"is_pvip":false,"replies":[{"id":"48544","content":"è¿™äº›æœºåˆ¶å¯¹å¼€å‘è€…å¹¶ä¸æ˜¯é€æ˜çš„ï¼Œå¼€å‘è€…å¯ä»¥æ‰‹åŠ¨è°ƒç”¨checkpointå’Œcacheæ–¹æ³•æ¥å­˜å‚¨RDDã€‚ä»–ä»¬çš„ä¸»è¦åŒºåˆ«æ˜¯æ˜¯å¦å­˜å‚¨ä¾èµ–å…³ç³»ã€‚","user_name":"ä½œè€…å›å¤","user_name_real":"Xinyue Li","uid":"1502409","ctime":1567393349,"ip_address":"","comment_id":95396,"utype":1}],"discussion_count":1,"race_medal":0,"score":"10147987087","product_id":100025301,"comment_content":"ç»ˆäºæ˜ç™½sparkæƒ°æ€§æ±‚å€¼çš„åŸç†äº†ã€‚æˆ‘ç†è§£å¯¹ RDD è¿›è¡ŒæŒä¹…åŒ–æ“ä½œå’Œè®°å½• Checkpointçš„åŒºåˆ«æ˜¯ï¼šå‰è€…æ˜¯å¼€å‘äººå‘˜ä¸ºäº†é¿å…é‡å¤è®¡ç®—ã€å‡å°‘é•¿é“¾è·¯è®¡ç®—æ—¶é—´è€Œä¸»åŠ¨å»ç¼“å­˜ä¸­é—´ç»“æœï¼Œè€Œåè€…æ˜¯sparkæ¡†æ¶ä¸ºäº†å®¹é”™è€Œæä¾›çš„ä¿å­˜ä¸­é—´ç»“æœæœºåˆ¶ï¼Œå®ƒå¯¹å¼€å‘äººå‘˜æ˜¯é€æ˜çš„ï¼Œæ— æ„ŸçŸ¥çš„ã€‚","like_count":2,"discussions":[{"author":{"id":1502409,"avatar":"https://static001.geekbang.org/account/avatar/00/16/ec/c9/45bfcba3.jpg","nickname":"Xinyue Li","note":"","ucode":"0CB92610C8B9FC","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":450441,"discussion_content":"è¿™äº›æœºåˆ¶å¯¹å¼€å‘è€…å¹¶ä¸æ˜¯é€æ˜çš„ï¼Œå¼€å‘è€…å¯ä»¥æ‰‹åŠ¨è°ƒç”¨checkpointå’Œcacheæ–¹æ³•æ¥å­˜å‚¨RDDã€‚ä»–ä»¬çš„ä¸»è¦åŒºåˆ«æ˜¯æ˜¯å¦å­˜å‚¨ä¾èµ–å…³ç³»ã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1567393349,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":1}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":247852,"user_name":"èŒ‚æ¨","can_delete":false,"product_type":"c1","uid":1181344,"ip_address":"","ucode":"8D8259E905DCA3","user_header":"https://static001.geekbang.org/account/avatar/00/12/06/a0/3da0e315.jpg","comment_is_top":false,"comment_ctime":1599893024,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"5894860320","product_id":100025301,"comment_content":"Sparkçš„è®¡ç®—æ˜¯æŒ‰ç…§Actionä¸ºå•ä½çš„ï¼Œå¤šæ¬¡çš„è½¬æ¢åœ¨ä¸€èµ·åªä¸ºäº†ç»„æˆä¸€ä¸ªå…¬å¼ï¼Œåªæœ‰çœŸæ­£æŠŠæ•°æ®èµ‹å€¼åœ¨å…¬å¼ä¸­å¹¶å†™ä¸Šç­‰å·äº†æ‰å»æ‰§è¡Œ(Action)","like_count":1},{"had_liked":false,"id":136338,"user_name":"å¤œå¾å¤œ","can_delete":false,"product_type":"c1","uid":1293142,"ip_address":"","ucode":"FC8729883EAD62","user_header":"https://static001.geekbang.org/account/avatar/00/13/bb/56/41cbcda2.jpg","comment_is_top":false,"comment_ctime":1569412108,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"5864379404","product_id":100025301,"comment_content":"æˆ‘æ˜¯å¦å¯ä»¥è¿™æ ·ç†è§£ï¼Œä½¿ç”¨checkpointï¼Œè€Œä¸æ˜¯ç”¨æŒä¹…åŒ–çš„RDDæ¥è¿›è¡Œæ•°æ®æ¢å¤ï¼Œæ˜¯å› ä¸ºå½“ä»æŸä¸€ä¸ªèŠ‚ç‚¹è¿›è¡Œå›æ”¾æ—¶ï¼Œcheckpointçš„è·¯å¾„æ¯”æŒä¹…åŒ–RDDçŸ­ï¼Œæ›´èƒ½èŠ‚çœæ—¶é—´ï¼Œä½†sparkçš„è¿™ç§æœºåˆ¶ä¹Ÿå†³å®šäº†å®ƒä¸æ”¯æŒç¡®å®šæ€§è®¡ç®—ã€‚","like_count":1},{"had_liked":false,"id":116076,"user_name":"refactor","can_delete":false,"product_type":"c1","uid":1058818,"ip_address":"","ucode":"EC8FF55FE6EC8E","user_header":"https://static001.geekbang.org/account/avatar/00/10/28/02/a6d7ece6.jpg","comment_is_top":false,"comment_ctime":1563782213,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"5858749509","product_id":100025301,"comment_content":"cache å’Œ checkpoint åŒºåˆ«ï¼š1.äº§ç”Ÿè¿‡ç¨‹ï¼Œcache æ˜¯ partition åˆ†åŒºè®¡ç®—å®Œåå°±æ‰§è¡Œï¼Œè€Œåè€…æ˜¯è¦æ•´ä¸ª rdd è®¡ç®—å®Œå†å»èµ·æ–°çš„ job å®Œæˆï¼Œæˆæœ¬æ›´å¤§ï¼›2.æ‰§è¡Œå®Œå cache æ— è®ºå­˜åœ¨å†…å­˜è¿˜æ˜¯ç¡¬ç›˜éƒ½ä¼šè¢«æ¸…ç†ï¼Œè€Œ åè€…ä¸ä¼šï¼Œé™¤éæ‰‹åŠ¨æ¸…ç†ï¼›3.cacheä¿å­˜ä¾èµ–å…³ç³»ï¼Œè€Œåè€…åˆ é™¤æ‰€æœ‰ä¾èµ–å…³ç³»ã€‚4.è¯»å–ä¸€ä¸ªåŒæ—¶è¢« cache å’Œ checkpoint å¤„ç†è¿‡çš„ rddï¼Œä¼šå…ˆè¯»å–å‰è€…ã€‚","like_count":1},{"had_liked":false,"id":95704,"user_name":"Peter","can_delete":false,"product_type":"c1","uid":1506885,"ip_address":"","ucode":"D2A0BB2F6A7236","user_header":"https://static001.geekbang.org/account/avatar/00/16/fe/45/c353f3da.jpg","comment_is_top":false,"comment_ctime":1558146120,"is_pvip":false,"replies":[{"id":"48539","content":"ğŸ‘ğŸ»","user_name":"ä½œè€…å›å¤","user_name_real":"Xinyue Li","uid":"1502409","ctime":1567392699,"ip_address":"","comment_id":95704,"utype":1}],"discussion_count":1,"race_medal":0,"score":"5853113416","product_id":100025301,"comment_content":"åœ¨ç¼“å­˜ RDD çš„æ—¶å€™ï¼Œå®ƒæ‰€æœ‰çš„ä¾èµ–å…³ç³»ä¹Ÿä¼šè¢«ä¸€å¹¶å­˜ä¸‹æ¥ã€‚æ‰€ä»¥æŒä¹…åŒ–çš„ RDD æœ‰è‡ªåŠ¨çš„å®¹é”™æœºåˆ¶ã€‚å¦‚æœ RDD çš„ä»»ä¸€åˆ†åŒºä¸¢å¤±äº†ï¼Œé€šè¿‡ä½¿ç”¨åŸå…ˆåˆ›å»ºå®ƒçš„è½¬æ¢æ“ä½œï¼Œå®ƒå°†ä¼šè¢«è‡ªåŠ¨é‡ç®—","like_count":1,"discussions":[{"author":{"id":1502409,"avatar":"https://static001.geekbang.org/account/avatar/00/16/ec/c9/45bfcba3.jpg","nickname":"Xinyue Li","note":"","ucode":"0CB92610C8B9FC","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":450565,"discussion_content":"ğŸ‘ğŸ»","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1567392699,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":1}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":95370,"user_name":"æ˜ç¿¼","can_delete":false,"product_type":"c1","uid":1068361,"ip_address":"","ucode":"E77F86BEB3D5C1","user_header":"https://static001.geekbang.org/account/avatar/00/10/4d/49/28e73b9c.jpg","comment_is_top":false,"comment_ctime":1558047467,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"5853014763","product_id":100025301,"comment_content":"checkpointç”¨çš„ä¸å¤šï¼Œæ˜¯ä¸æ˜¯å¯ä»¥å¯¹ç›®å‰æ‰€æœ‰çš„rddå‡ç¼“å­˜ï¼Œrddæ˜¯é’ˆå¯¹ç‰¹å®šrddç¼“å­˜","like_count":1},{"had_liked":false,"id":347800,"user_name":"yanger2004","can_delete":false,"product_type":"c1","uid":1009644,"ip_address":"","ucode":"0A2CD03EF31052","user_header":"http://thirdwx.qlogo.cn/mmopen/vi_32/DYAIOgq83erms9qcIFYZ4npgLYPu1QgxQyaXcj64ZBicNVeBRWcYUpCZ9p0BGsrEcX8heibMLCV4Gde4P9pf7PjA/132","comment_is_top":false,"comment_ctime":1654441338,"is_pvip":true,"discussion_count":0,"race_medal":0,"score":"1654441338","product_id":100025301,"comment_content":"persistå’Œcacheä»€ä¹ˆåŒºåˆ«ï¼Ÿ","like_count":0},{"had_liked":false,"id":252278,"user_name":"piboye","can_delete":false,"product_type":"c1","uid":1066752,"ip_address":"","ucode":"7CFD8712857A85","user_header":"https://static001.geekbang.org/account/avatar/00/10/47/00/3202bdf0.jpg","comment_is_top":false,"comment_ctime":1602222033,"is_pvip":true,"discussion_count":0,"race_medal":0,"score":"1602222033","product_id":100025301,"comment_content":"æ˜¯ä¸æ˜¯map&#47;reduceå¯ä»¥å¤„ç†æ›´å¤§è§„æ¨¡çš„æ•°æ®å•Šï¼Ÿ","like_count":0},{"had_liked":false,"id":195810,"user_name":"Eden2020","can_delete":false,"product_type":"c1","uid":1899158,"ip_address":"","ucode":"0DEE62F2335237","user_header":"https://static001.geekbang.org/account/avatar/00/1c/fa/96/4a7b7505.jpg","comment_is_top":false,"comment_ctime":1585216400,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1585216400","product_id":100025301,"comment_content":"checkpointä¼šæ¸…ç©ºä¾èµ–å…³ç³»ï¼ŒæŒä¹…åŒ–ä¸ä¼š","like_count":0},{"had_liked":false,"id":179371,"user_name":"ä½™æ³½é”‹","can_delete":false,"product_type":"c1","uid":1003207,"ip_address":"","ucode":"5AB1499746C003","user_header":"https://static001.geekbang.org/account/avatar/00/0f/4e/c7/8c2d0a3d.jpg","comment_is_top":false,"comment_ctime":1581991837,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1581991837","product_id":100025301,"comment_content":"è¯·é—®sparkå¯ä»¥æ”¯æŒå¤šè¡¨å¤´çš„æ•°æ®å—ï¼Ÿ","like_count":0},{"had_liked":false,"id":120269,"user_name":"éœ²å¨œ","can_delete":false,"product_type":"c1","uid":1289012,"ip_address":"","ucode":"CC3EF71EB30EE1","user_header":"https://static001.geekbang.org/account/avatar/00/13/ab/34/ef002163.jpg","comment_is_top":false,"comment_ctime":1564818111,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1564818111","product_id":100025301,"comment_content":"å¦‚æœä¸€ä¸ªDAGå›¾ä¸­å‡ºç°è±å½¢ç»“æ„ï¼Œæˆ‘æŒä¹…åŒ–ä¼šæé«˜æ•ˆç‡å—ï¼Ÿåœ¨ä¸€ä¸ªActionçš„DAGè¡€ç¼˜å›¾é‡Œï¼Œæœ‰ä¸ªçˆ¶RDDè¢«ä¸¤ä¸ªå­RDDä¾èµ–ã€‚","like_count":0},{"had_liked":false,"id":106701,"user_name":"æ·¹æ­»çš„å¤§è™¾","can_delete":false,"product_type":"c1","uid":1488430,"ip_address":"","ucode":"79DB76C60F8404","user_header":"https://static001.geekbang.org/account/avatar/00/16/b6/2e/096790e1.jpg","comment_is_top":false,"comment_ctime":1561374458,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1561374458","product_id":100025301,"comment_content":"æŒä¹…åŒ–åˆ°å†…å­˜å°±ä¸è¯´äº†ï¼Œç”¨å®Œå°±æ²¡äº†ã€‚å’ŒæŒä¹…åŒ–åˆ°ç¡¬ç›˜æ¯”ï¼Œcheckpointåªéœ€è¦æŒ‰éœ€åœ¨å…³é”®èŠ‚ç‚¹å‚¨å­˜ï¼ŒæŒä¹…åŒ–åˆ™æ‰€æœ‰æ“ä½œèŠ‚ç‚¹éƒ½ä¼š","like_count":0},{"had_liked":false,"id":100644,"user_name":"Flash","can_delete":false,"product_type":"c1","uid":1236163,"ip_address":"","ucode":"E285075C9E0B02","user_header":"https://static001.geekbang.org/account/avatar/00/12/dc/c3/e4ba51d5.jpg","comment_is_top":false,"comment_ctime":1559610240,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1559610240","product_id":100025301,"comment_content":"æ£€æŸ¥ç‚¹æ˜¯Sparkçš„ä¸€ä¸ªå®¹é”™æœºåˆ¶ï¼Œåº”è¯¥æ˜¯ä¼šè‡ªåŠ¨ç¼“å­˜é‚£äº›è®¡ç®—æ¯”è¾ƒè€—æ—¶çš„RDDï¼Œç¼“å­˜çš„æ˜¯è¿›è¡Œè®¡ç®—åŠ¨ä½œçš„RDDã€‚<br>æŒä¹…åŒ–æ˜¯Sparké’ˆå¯¹è½¬æ¢æ“ä½œçš„RDDè¿›è¡Œç¼“å­˜ï¼Œéœ€è¦å¼€å‘äººå‘˜æ‰‹åŠ¨è°ƒç”¨persistæˆ–cacheæ–¹æ³•ã€‚","like_count":0},{"had_liked":false,"id":99955,"user_name":"å¾å®","can_delete":false,"product_type":"c1","uid":1208822,"ip_address":"","ucode":"5B38BF576B1749","user_header":"https://static001.geekbang.org/account/avatar/00/12/71/f6/ad0ad3df.jpg","comment_is_top":false,"comment_ctime":1559371730,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1559371730","product_id":100025301,"comment_content":"çœ‹å›¾ä¸€spark sqlæ”¯æŒjdbcå—ï¼Ÿè€å¸ˆèƒ½ç»™ä¸ªé“¾æ¥ä¸ï¼Ÿ","like_count":0},{"had_liked":false,"id":97338,"user_name":"æ¸¡ç ","can_delete":false,"product_type":"c1","uid":1348536,"ip_address":"","ucode":"8FD8B863D1DA0C","user_header":"https://static001.geekbang.org/account/avatar/00/14/93/b8/6510592e.jpg","comment_is_top":false,"comment_ctime":1558658108,"is_pvip":false,"replies":[{"id":"48538","content":"æœ€ä¸»è¦çš„åŒºåˆ«æ˜¯æ˜¯å¦ä¿å­˜ä¾èµ–å…³ç³»ï¼Œcheckpointåªå­˜è®¡ç®—ç»“æœï¼Œä¸ä¿ç•™ä¾èµ–å…³ç³»ï¼›ä½†æ˜¯ç¼“å­˜åŒ–ä¼šä¿å­˜ä¾èµ–å…³ç³»ï¼Œæ–¹ä¾¿é”™è¯¯æ¢å¤ï¼Œå¼€é”€ç›¸å¯¹æ¯”è¾ƒå°ã€‚","user_name":"ä½œè€…å›å¤","user_name_real":"Xinyue Li","uid":"1502409","ctime":1567392671,"ip_address":"","comment_id":97338,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1558658108","product_id":100025301,"comment_content":"è®¾è®¡ä¸Šï¼Œåº”ç”¨åœºæ™¯ä¸åŒï¼Œcheckpointç”¨æ¥åšæ•…éšœæ¢å¤ï¼Œcacheä¸ºäº†é¿å…é‡å¤è®¡ç®—ã€‚å®ç°æŠ€æœ¯ä¸Šæˆ‘æ²¡åšæ·±å…¥äº†è§£ä¸æ¸…æ¥šï¼ŒçŒœæµ‹å­˜å‚¨æŠ€æœ¯ç±»ä¼¼ï¼Œå¯èƒ½checkpointä¼šé¢å¤–å¢åŠ ç”¨äºæ•…éšœæ¢å¤çš„ä¿¡æ¯","like_count":0,"discussions":[{"author":{"id":1502409,"avatar":"https://static001.geekbang.org/account/avatar/00/16/ec/c9/45bfcba3.jpg","nickname":"Xinyue Li","note":"","ucode":"0CB92610C8B9FC","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":451235,"discussion_content":"æœ€ä¸»è¦çš„åŒºåˆ«æ˜¯æ˜¯å¦ä¿å­˜ä¾èµ–å…³ç³»ï¼Œcheckpointåªå­˜è®¡ç®—ç»“æœï¼Œä¸ä¿ç•™ä¾èµ–å…³ç³»ï¼›ä½†æ˜¯ç¼“å­˜åŒ–ä¼šä¿å­˜ä¾èµ–å…³ç³»ï¼Œæ–¹ä¾¿é”™è¯¯æ¢å¤ï¼Œå¼€é”€ç›¸å¯¹æ¯”è¾ƒå°ã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1567392671,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":1}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":96743,"user_name":"æ—¶é—´æ˜¯æœ€çœŸçš„ç­”æ¡ˆ","can_delete":false,"product_type":"c1","uid":1183601,"ip_address":"","ucode":"B90F3EF769F865","user_header":"https://static001.geekbang.org/account/avatar/00/12/0f/71/9273e8a4.jpg","comment_is_top":false,"comment_ctime":1558495971,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1558495971","product_id":100025301,"comment_content":"checkpointç”¨äºæ•°æ®å›æ»šï¼ŒæŒä¹…åŒ–ç”¨äºè®¡ç®—","like_count":0},{"had_liked":false,"id":95710,"user_name":"lwenbin","can_delete":false,"product_type":"c1","uid":1202109,"ip_address":"","ucode":"05C4CC6BE0B56C","user_header":"https://static001.geekbang.org/account/avatar/00/12/57/bd/acf40fa0.jpg","comment_is_top":false,"comment_ctime":1558146705,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1558146705","product_id":100025301,"comment_content":"è€å¸ˆæ‚¨å¥½<br>ä¸Šé¢filter firstçš„ä¾‹å­é‡Œï¼Œå‡å¦‚Sparkä»æœ€åä¸€ä¸ª first RDDå¼€å§‹è®¡ç®—ï¼Œé€šçŸ¥å‰ä¸€ä¸ª filter RDDè¦ç»™æ•°æ®ï¼Œè¯·é—®filteræ˜¯å®Œå…¨è®¡ç®—å¥½äº†è¿˜æ˜¯åŸºäºæµå¼çš„æœ‰æ•°æ®å°±ç»™ï¼Ÿæˆ‘è§‰å¾—è‚¯å®šæ˜¯æœ‰æ•°æ®å°±ç»™ã€‚ä¸çŸ¥é“ç†è§£æ˜¯ä¸æ˜¯å¯¹ã€‚å¦‚æœæœ‰æ•°æ®å°±ç»™çš„è¯ï¼Œè¿™ä¸ªåº”è¯¥æ˜¯ä¾èµ–äºå…·ä½“actionçš„å§ï¼Œæ¯”å¦‚first sumå¯ä»¥ï¼Œä½†æ˜¯min maxè¿™ç§ä¸è¡Œã€‚è€å¸ˆèƒ½å¦æ›´æ·±å…¥çš„è¯´ä¸€ä¸‹è¿™äº›å¤„ç†æµç¨‹å•Šï¼Ÿ<br>è°¢è°¢ï¼","like_count":0},{"had_liked":false,"id":95450,"user_name":"aof","can_delete":false,"product_type":"c1","uid":1062864,"ip_address":"","ucode":"5815D63C4926BC","user_header":"https://static001.geekbang.org/account/avatar/00/10/37/d0/26975fba.jpg","comment_is_top":false,"comment_ctime":1558057853,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1558057853","product_id":100025301,"comment_content":"å»ºè®®è€å¸ˆæŠŠåŠ¨ä½œæ“ä½œç»Ÿä¸€ä¿®æ”¹ä¸ºactionæ“ä½œï¼Œé©±åŠ¨ç¨‹åºæ”¹ä¸ºdriverç«¯ã€‚","like_count":0}]}