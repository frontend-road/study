{"id":389596,"title":"15 | è·¯ç”±ç®¡ç†ï¼šä¸ºä»€ä¹ˆæ¯ä¸€ä¸ªå‰ç«¯åº”ç”¨éƒ½éœ€è¦ä½¿ç”¨è·¯ç”±æœºåˆ¶ï¼Ÿ","content":"<p>ä½ å¥½ï¼Œæˆ‘æ˜¯ç‹æ²›ã€‚ä»Šå¤©æˆ‘ä»¬æ¥èŠèŠå¦‚ä½•åœ¨ React ä¸­ä½¿ç”¨è·¯ç”±ç®¡ç†ã€‚</p><p>æ‰€è°“<strong>è·¯ç”±ç®¡ç†</strong>ï¼Œå°±æ˜¯<strong>è®©ä½ çš„é¡µé¢èƒ½å¤Ÿæ ¹æ® URL çš„å˜åŒ–è¿›è¡Œé¡µé¢çš„åˆ‡æ¢</strong>ï¼Œè¿™æ˜¯<strong>å‰ç«¯åº”ç”¨ä¸­ä¸€ä¸ªéå¸¸é‡è¦çš„æœºåˆ¶</strong>ï¼ŒåŒæ—¶ä¹Ÿæ˜¯ Web åº”ç”¨åŒºåˆ«äºæ¡Œé¢åº”ç”¨çš„ä¸€ä¸ªé‡è¦ç‰¹å¾ã€‚</p><p>æˆ‘ä»¬ä¹‹æ‰€ä»¥è¯´è·¯ç”±éå¸¸é‡è¦ï¼Œä¸»è¦ä½“ç°åœ¨ä¸¤ä¸ªæ–¹é¢ã€‚</p><p>ä¸€æ–¹é¢ï¼Œè·¯ç”±æœºåˆ¶æä¾›äº†æŒ‰é¡µé¢å»ç»„ç»‡æ•´ä¸ªåº”ç”¨ç¨‹åºçš„èƒ½åŠ›ï¼Œé¡µé¢ä¹‹é—´çš„äº¤äº’å¯ä»¥ä¸»è¦é€šè¿‡ URL æ¥è¿›è¡Œï¼Œä»è€Œå¯ä»¥è®©å„ä¸ªä¸šåŠ¡åŠŸèƒ½äº’ç›¸ç‹¬ç«‹ï¼Œå®ç°é€»è¾‘çš„è§£è€¦ã€‚</p><p>å¦ä¸€æ–¹é¢ï¼ŒURL çš„å…¨ç§°æ˜¯_Uniform Resource Locator_ï¼Œä¸­æ–‡æ„æ€æ˜¯â€œç»Ÿä¸€èµ„æºå®šä½ç¬¦â€ï¼Œè¡¨æ˜ URL æ˜¯ç”¨äºå”¯ä¸€çš„å®šä½æŸä¸ªèµ„æºçš„ã€‚</p><p>æ‰€ä»¥å¯¹äºèƒ½å¤Ÿé€šè¿‡å‰ç«¯åº”ç”¨å±•ç°çš„æ¯ä¸€ä¸ªèµ„æºï¼Œä½ éƒ½è¦è€ƒè™‘ URL æ˜¯å¦èƒ½å”¯ä¸€åœ°å®šä½åˆ°è¿™ä¸ªèµ„æºã€‚è¿™è¦æ±‚ URL ä¸ä»…èƒ½å®šä½åˆ°æŸä¸ªé¡µé¢ï¼Œè¿˜è¦èƒ½å®šä½åˆ°ä¸€äº›çŠ¶æ€ï¼Œæ¯”å¦‚å½“å‰çš„ Tab é¡µæ˜¯ä»€ä¹ˆï¼Œæˆ–è€…é¡µé¢åˆ—è¡¨åº”è¯¥æ˜¯ç¬¬å‡ é¡µï¼Œç­‰ç­‰ã€‚è€Œè·¯ç”±æœºåˆ¶ï¼Œå°±å¯ä»¥è®©ä½ åšåˆ°è¿™ä¸€ç‚¹ã€‚</p><p>æ‰€ä»¥ï¼Œå¯¹äºæ¯ä¸€ä¸ªå‰ç«¯åº”ç”¨ï¼Œæ— è®ºå¤§å°ï¼Œéƒ½åº”è¯¥è¦æœ‰è‡ªå·±çš„è·¯ç”±æœºåˆ¶ã€‚è€Œæˆ‘ä»¬åœ¨å¼€å‘æ¯ä¸€ä¸ªåŠŸèƒ½çš„æ—¶å€™ï¼Œåœ¨è®¾è®¡ä¹‹åˆå°±åº”è¯¥æ€è€ƒå½“å‰å®ç°çš„åŠŸèƒ½å’Œ URL æ˜¯å¦éœ€è¦æœ‰ä»€ä¹ˆè”ç³»ã€‚è¿™æ ·å°±å¯ä»¥è®© URL èƒ½å¤Ÿæ›´å‡†ç¡®åœ°å®šä½èµ„æºï¼Œè¿›è€Œæå‡ç”¨æˆ·ä½“éªŒã€‚åŒæ—¶ï¼Œç”±äºæˆ‘ä»¬å°†æŸäº›çŠ¶æ€é€šè¿‡ URL è¿›è¡Œäº†ç®¡ç†ï¼Œç›¸å…³çš„ä¸šåŠ¡é€»è¾‘è¯­ä¹‰ä¹Ÿä¼šæ›´åŠ æ˜ç¡®ã€‚</p><!-- [[[read_end]]] --><p>é‚£ä¹ˆåœ¨ä»Šå¤©è¿™èŠ‚è¯¾ï¼Œæˆ‘å°±ä¼šè·Ÿä½ å®Œæ•´åœ°ä»‹ç»å‰ç«¯è·¯ç”±çš„å·¥ä½œåŸç†ï¼Œä»¥åŠå…¸å‹çš„ä½¿ç”¨åœºæ™¯ï¼Œå¸®åŠ©ä½ èƒ½å¤Ÿåœ¨è‡ªå·±çš„åº”ç”¨ä¸­ç†Ÿç»ƒæŒæ¡è·¯ç”±çš„ä½¿ç”¨ã€‚</p><h2>ç†è§£è·¯ç”±çš„å·¥ä½œåŸç†ï¼šè‡ªå·±å®ç°ä¸€ä¸ªç®€å•çš„è·¯ç”±æœºåˆ¶</h2><p>åœ¨ React ä¸­çš„è·¯ç”±ç®¡ç†ï¼Œä¸€èˆ¬éƒ½ä¼šé€šè¿‡è·¯ç”±æ¡†æ¶ React Router å»å®ç°ã€‚å¯èƒ½å¾ˆå¤šåŒå­¦ä¸€å¬åˆ°â€œæ¡†æ¶â€ï¼Œä¸‹æ„è¯†åœ°å°±è§‰å¾—å®ƒçš„å®ç°éå¸¸å¤æ‚ã€‚å…¶å®ä¸ç„¶ï¼Œåœ¨ React ä¸­å®ç°ä¸€ä¸ªè‡ªå·±è·¯ç”±æ¡†æ¶éå¸¸å®¹æ˜“ï¼Œåªè¦<strong>åˆ©ç”¨æœ€åŸºç¡€çš„ React æœºåˆ¶</strong>å°±èƒ½å¤Ÿå®ç°ã€‚</p><p>æ‰€ä»¥æˆ‘ä»¬é¦–å…ˆå°±æ¥çœ‹çœ‹ï¼Œå¦‚æœè¦è‡ªå·±å®ç°è¿™æ ·ä¸€ä¸ªæœºåˆ¶åº”è¯¥å¦‚ä½•å»åšï¼Œè¿™æ ·ä½ å°±èƒ½å¤ŸçœŸæ­£ç†è§£ React Router è¿™æ ·çš„è·¯ç”±æ¡†æ¶çš„å·¥ä½œåŸç†äº†ã€‚ç†è§£äº†åŸç†ï¼Œä½ ä¹Ÿå°±èƒ½åœ¨ä½¿ç”¨æ—¶æ›´åŠ å¾—å¿ƒåº”æ‰‹ï¼Œé‡åˆ°é—®é¢˜ä¹Ÿèƒ½è‡ªä¸»è§£å†³ã€‚</p><p>åœ¨ä¸€ä¸ªå‰ç«¯åº”ç”¨ä¸­ï¼Œæ‰€è°“çš„<strong>é¡µé¢åˆ‡æ¢</strong>ï¼Œæˆ–è€…å¯¼èˆªï¼Œå…¶å®æ˜¯ä¸€ä¸ªé¡µé¢çš„å±€éƒ¨å†…å®¹è¦ä½¿ç”¨ä¸åŒçš„ç»„ä»¶å»å±•ç¤ºã€‚æ¯”å¦‚è¯´ä¸‹å›¾ï¼Œä¸€ä¸ªé¡µé¢é€šå¸¸ç”± headerã€siderã€content ç­‰éƒ¨åˆ†ç»„æˆï¼Œä½†æ˜¯åœ¨å®é™…çš„é¡µé¢åˆ‡æ¢çš„æ—¶å€™ï¼Œæ”¹å˜çš„å…¶å®æ˜¯ content éƒ¨åˆ†çš„å†…å®¹ã€‚</p><p><img src=\"https://static001.geekbang.org/resource/image/30/b4/30a22cb652713ee083e73f96b3b206b4.png?wh=928x532\" alt=\"\"></p><p>æ‰€ä»¥è¿™ä¹Ÿæ˜¯å’Œä¼ ç»Ÿçš„ Web åº”ç”¨ä¸ä¸€æ ·çš„åœ°æ–¹ï¼š</p><ul>\n<li>åœ¨æœåŠ¡å™¨ç«¯æ¸²æŸ“çš„é¡µé¢ä¸­ï¼Œæ¯ä¸ª URL çš„å˜åŒ–éƒ½æ˜¯å…¨éƒ¨é¡µé¢å†…å®¹çš„åˆ‡æ¢ã€‚</li>\n<li>è€Œåœ¨å‰ç«¯è·¯ç”±ç®¡ç†ä¸­ï¼Œåˆ™ä¸€èˆ¬åªåœ¨ä¸»å†…å®¹åŒºåŸŸ Content éƒ¨åˆ†å˜åŒ–ï¼Œ Header å’Œ Sider æ˜¯ä¸ä¼šå˜åŒ–çš„ã€‚</li>\n</ul><p>é‚£ä¹ˆï¼Œå®ç°è·¯ç”±æœºåˆ¶çš„<strong>æ ¸å¿ƒé€»è¾‘</strong>å°±æ˜¯<strong>æ ¹æ® URL è·¯å¾„è¿™ä¸ªçŠ¶æ€ï¼Œæ¥å†³å®šåœ¨ä¸»å†…å®¹åŒºåŸŸæ˜¾ç¤ºä»€ä¹ˆç»„ä»¶</strong><strong>ã€‚</strong>ç¤ºæ„çš„ä»£ç å¦‚ä¸‹ï¼š</p><pre><code>const MyRouter = ({ children }) =&gt; {\n  const routes = _.keyBy(\n    children.map((c) =&gt; c.props),\n    &quot;path&quot;,\n  );\n  const [hash] = useHash();\n  const Page = routes[hash.replace(&quot;#&quot;, &quot;&quot;)]?.component;\n  // å¦‚æœè·¯ç”±ä¸å­˜åœ¨å°±è¿”å› Not found.\n  return Page ? &lt;Page /&gt; : &quot;Not found.&quot;;\n};\n\n\nconst Route = () =&gt; null;\n</code></pre><p>è¿™æ ·ï¼Œæˆ‘ä»¬å°±ç®€å•å®ç°äº†ä¸€ä¸ª MyRouter è¿™æ ·çš„è·¯ç”±å®¹å™¨ç»„ä»¶ã€‚æˆ‘ä»¬é€šè¿‡ URL ä¸­çš„ hashï¼Œä¹Ÿå°±æ˜¯â€œ#â€åé¢çš„éƒ¨åˆ†æ¥å†³å®šå…·ä½“æ¸²æŸ“å“ªä¸ªç»„ä»¶åˆ°ä¸»åŒºåŸŸã€‚</p><p>åŒæ—¶æˆ‘ä»¬å®šä¹‰äº†ä¸€ä¸ªç©ºç»„ä»¶ Routeï¼Œæ¥æ¥æ”¶è·¯ç”±çš„å…·ä½“å‚æ•° path å’Œ componentï¼Œä»è€Œä»¥å£°æ˜å¼çš„æ–¹å¼å»å®šä¹‰è·¯ç”±ã€‚</p><p>é‚£ä¹ˆåœ¨ä½¿ç”¨çš„æ—¶å€™ï¼Œå°±å¯ä»¥ç”¨ä¸‹é¢çš„ä»£ç å®ç°ï¼š</p><pre><code>function SamplePages {\n  return (\n    &lt;div className=&quot;sample-pages&quot;&gt;\n      {/* å®šä¹‰äº†ä¾§è¾¹å¯¼èˆªæ  */}\n      &lt;div className=&quot;sider&quot;&gt;\n        &lt;a href=&quot;#page1&quot;&gt;Page 1&lt;/a&gt;\n        &lt;a href=&quot;#page2&quot;&gt;Page 2&lt;/a&gt;\n        &lt;a href=&quot;#page3&quot;&gt;Page 3&lt;/a&gt;\n        &lt;a href=&quot;#page4&quot;&gt;Page 4&lt;/a&gt;\n      &lt;/div&gt;\n      &lt;div className=&quot;exp-15-page-container&quot;&gt;\n        {/* å®šä¹‰è·¯ç”±é…ç½® */}\n        &lt;MyRouter&gt;\n          &lt;Route path=&quot;page1&quot; component={Page1} /&gt;\n          &lt;Route path=&quot;page2&quot; component={Page2} /&gt;\n          &lt;Route path=&quot;page3&quot; component={Page3} /&gt;\n          &lt;Route path=&quot;page4&quot; component={Page4} /&gt;\n        &lt;/MyRouter&gt;\n      &lt;/div&gt;\n    &lt;/&gt;\n  );\n};\n\n</code></pre><p>é€šè¿‡ä¸ªä¾‹å­ï¼Œä¸€æ–¹é¢ï¼Œä½ å°±æŒæ¡äº†ä¸€ä¸ªç®€å•è·¯ç”±æœºåˆ¶çš„å®ç°ï¼Œä»è€Œå¯ä»¥åœ¨ä¸€äº›ç®€å•çš„åº”ç”¨ä¸­ç›´æ¥ä½¿ç”¨ï¼Œé¿å…å¼•å…¥å¤ªå¤šä¾èµ–ã€‚</p><p>å¦ä¸€æ–¹é¢ï¼Œç†è§£äº†è·¯ç”±å®ç°çš„åŸç†ï¼Œä¹Ÿå°±èƒ½æ›´ä»å®¹åœ°å»ä½¿ç”¨æ›´å®Œå–„çš„ç¬¬ä¸‰æ–¹è·¯ç”±ç®¡ç†æ¡†æ¶äº†ã€‚å®Œæ•´çš„ä»£ç å’Œè¿è¡Œæ•ˆæœä½ ä¹Ÿå¯ä»¥é€šè¿‡æ–‡æœ«çš„é“¾æ¥æŸ¥çœ‹ã€‚</p><h2>ä½¿ç”¨ React Router</h2><p>React Router ä½œä¸º React å…¨å®¶æ¡¶ä¸‰å¤§æˆå‘˜ä¹‹ä¸€ï¼Œæ˜¯å‡ ä¹æ‰€æœ‰ React åº”ç”¨çš„å¿…å¤‡ã€‚è™½ç„¶åœ¨åˆšæ‰çš„ä¾‹å­ä¸­ï¼Œæˆ‘ä»¬è‡ªå·±å®ç°çš„æœºåˆ¶ä¹Ÿèƒ½ç®€å•åœ°è¿›è¡Œè·¯ç”±ç®¡ç†ã€‚</p><p>ä½†æ˜¯åœ¨å®é™…é¡¹ç›®ä¸­ï¼Œè¿˜æœ‰æ›´å¤šçš„æƒ…å†µéœ€è¦è€ƒè™‘ï¼Œæ¯”å¦‚è·¯ç”±åµŒå¥—ã€URL çš„æ¨¡å¼åŒ¹é…ã€å‚æ•°æå–ç­‰ã€‚è¿™äº›ç»†èŠ‚ä¸Šçš„è€ƒè™‘ï¼Œæ„å‘³ç€æˆ‘ä»¬è¦åšä¸€ä¸ªå®Œæ•´çš„è·¯ç”±æ¡†æ¶ï¼Œè¿˜æ˜¯éœ€è¦å¾ˆå¤§çš„å·¥ä½œé‡çš„ï¼Œæ‰€ä»¥ä½ å®Œå…¨å¯ä»¥ç”¨ React Router è¿™æ ·æ›´æˆç†Ÿçš„å¼€æºæ–¹æ¡ˆå»ç®¡ç†è·¯ç”±ï¼Œè€Œæ— é¡»è‡ªå·±å¼€å‘ã€‚</p><p>å¹¸è¿çš„æ˜¯ï¼ŒReact Router çš„ä½¿ç”¨éå¸¸ç®€å•ï¼Œå‡ ä¹ä¸éœ€è¦å­¦ä¹ æˆæœ¬ï¼Œä½ çœ‹ä¸€ä¸ªä½¿ç”¨çš„ä¾‹å­å°±æ˜ç™½äº†ã€‚</p><p>å¦‚æœä½ ç»†å¿ƒçš„è¯ä¼šå‘ç°ï¼Œæˆ‘ä»¬è¯¾ç¨‹çš„æ‰€æœ‰ç¤ºä¾‹é¡µé¢ï¼Œå°±æ˜¯ç”¨ React Router å»ç®¡ç†çš„ã€‚ä¸‹é¢å°±æ˜¯æˆ‘ä»¬è¯¾ç¨‹ App çš„æ ¹ç»„ä»¶ã€‚ä¸ºäº†ç¼©çŸ­è¿™é‡Œä»£ç çš„é•¿åº¦ï¼Œå°±ä»¥å®šä¹‰äº†ä¸¤è®²çš„ç¤ºä¾‹ä»£ç é¡µé¢è·¯ç”±ä¸ºä¾‹ï¼š</p><pre><code>\n// ä» react-router-dom å¼•å…¥è·¯ç”±æ¡†æ¶æä¾›çš„ä¸€äº›ç»„ä»¶\nimport { BrowserRouter, Switch, Route, Link } from &quot;react-router-dom&quot;;\n// å¼•å…¥äº†ä¸¤ä¸ªè¯¾ç¨‹ç¤ºä¾‹é¡µé¢\nimport Counter from &quot;./01/Counter&quot;;\nimport UserList from &quot;./01/UserList&quot;;\n\n\n// ä½¿ç”¨æ•°ç»„å®šä¹‰äº†é¡µé¢ç»„ä»¶å’Œå¯¼èˆªçš„æ ‡é¢˜ï¼Œä»è€Œæ–¹ä¾¿ä¸‹é¢çš„æ¸²æŸ“é€»è¾‘\nconst routes = [\n  [&quot;01 Counter&quot;, Counter],\n  [&quot;01 UserList&quot;, UserList],\n];\nfunction App() {\n  return (\n    &lt;BrowserRouter&gt;\n      &lt;div className=&quot;app&quot;&gt;\n        &lt;ul className=&quot;sider&quot;&gt;\n          {routes.map(([label]) =&gt; (\n            &lt;li&gt;\n              &lt;Link to={`/${label.replace(&quot; &quot;, &quot;/&quot;)}`}&gt;{label}&lt;/Link&gt;\n            &lt;/li&gt;\n          ))}\n        &lt;/ul&gt;\n        &lt;div id=&quot;pageContainer&quot; className=&quot;page-container&quot;&gt;\n          &lt;Switch&gt;\n            {routes.map(([label, Component]) =&gt; (\n              &lt;Route key={label} path={`/${label.replace(&quot; &quot;, &quot;/&quot;)}`}&gt;\n                &lt;Component /&gt;\n              &lt;/Route&gt;\n            ))}\n            {/* å®šä¹‰ä¸€ä¸ªé»˜è®¤çš„è·¯ç”± */}\n            &lt;Route path=&quot;/&quot; exact&gt;\n              &lt;h1&gt;Welcome!&lt;/h1&gt;\n            &lt;/Route&gt;\n            &lt;Route path=&quot;*&quot;&gt;Page not found.&lt;/Route&gt;\n          &lt;/Switch&gt;\n        &lt;/div&gt;\n      &lt;/div&gt;\n    &lt;/BrowserRouter&gt;\n  );\n}\n</code></pre><p>è¿™é‡Œéœ€è¦æ³¨æ„ï¼ŒReact Router <strong>ä¸ä»…æ”¯æŒæµè§ˆå™¨</strong>ï¼Œ<strong>è¿˜æ”¯æŒ React Nativeï¼Œä»¥åŠä¸€äº›ç”¨ Web å®ç°çš„ç§»åŠ¨ App</strong>ï¼Œæ‰€ä»¥å®ƒæä¾›äº†å¤šä¸ª npm æ¨¡å—ã€‚</p><p>ä»£ç é‡Œçœ‹åˆ°çš„ react-router-domï¼Œå…¶å®æ­£æ˜¯æ”¯æŒæµè§ˆå™¨çš„æ¨¡å—ã€‚æˆ‘ä»¬åœ¨å¼€å‘è¿è¡Œäºæµè§ˆå™¨çš„ Web App æ—¶ï¼Œåªè¦å¼•å…¥è¿™ä¸ªåŒ…å°±å¯ä»¥äº†ã€‚</p><p>åŒæ—¶ï¼Œæˆ‘ä»¬ä¹Ÿçœ‹åˆ°äº† BrowserRouterã€Linkã€Routeã€Switch ç­‰ç»„ä»¶çš„ç”¨æ³•ã€‚æ¥ä¸‹æ¥æˆ‘å°±ç®€å•è§£é‡Šä¸€ä¸‹ç»„ä»¶çš„ä½œç”¨ã€‚</p><p><strong>BrowserRouter</strong>ï¼šæ ‡è¯†ç”¨æ ‡å‡†çš„ URL è·¯å¾„å»ç®¡ç†è·¯ç”±ï¼Œæ¯”å¦‚ /my-page1 è¿™æ ·çš„æ ‡å‡† URL è·¯å¾„ã€‚é™¤æ­¤ä¹‹å¤–ï¼Œè¿˜æœ‰ MemoryRouterï¼Œè¡¨ç¤ºé€šè¿‡å†…å­˜ç®¡ç†è·¯ç”±ï¼›HashRouterï¼Œæ ‡è¯†é€šè¿‡ hash ç®¡ç†è·¯ç”±ã€‚æˆ‘ä»¬è‡ªå·±å®ç°çš„ä¾‹å­å…¶å®å°±æ˜¯ç”¨çš„ hash æ¥å®ç°è·¯ç”±ã€‚</p><p><strong>Link</strong>ï¼šå®šä¹‰ä¸€ä¸ªå¯¼èˆªé“¾æ¥ï¼Œç‚¹å‡»æ—¶å¯ä»¥æ— åˆ·æ–°åœ°æ”¹å˜é¡µé¢ URLï¼Œä»è€Œå®ç° React Router æ§åˆ¶çš„å¯¼èˆªã€‚</p><p><strong>Route</strong>: å®šä¹‰ä¸€æ¡è·¯ç”±è§„åˆ™ï¼Œå¯ä»¥æŒ‡å®šåŒ¹é…çš„è·¯å¾„ã€è¦æ¸²æŸ“çš„å†…å®¹ç­‰ç­‰ã€‚</p><p><strong>Switch</strong>ï¼šåœ¨é»˜è®¤æƒ…å†µä¸‹ï¼Œæ‰€æœ‰åŒ¹é…çš„ Route èŠ‚ç‚¹éƒ½ä¼šè¢«å±•ç¤ºï¼Œä½†æ˜¯ Switch æ ‡è®°å¯ä»¥ä¿è¯åªæœ‰ç¬¬ä¸€ä¸ªåŒ¹é…åˆ°çš„è·¯ç”±æ‰ä¼šè¢«æ¸²æŸ“ã€‚</p><p>è¿™æ ·ï¼Œæˆ‘ä»¬å°±ä½¿ç”¨äº† React Router æä¾›çš„æœ€åŸºç¡€çš„åŠŸèƒ½ï¼Œå®ç°äº†é¡µé¢çº§åˆ«çš„è·¯ç”±ç®¡ç†ã€‚</p><p>ä½†æ˜¯æˆ‘ä»¬è¦çŸ¥é“ï¼ŒReact Router çš„èƒ½åŠ›å¹¶ä¸æ­¢äºæ­¤ï¼Œå®ƒçš„åŠŸèƒ½éå¸¸å¼ºå¤§ã€‚æˆ‘å¼ºçƒˆå»ºè®®ä½ å»å®Œæ•´é˜…è¯»ä¸‹å®ƒçš„<a href=\"https://reactrouter.com/web/guides/quick-start\">å®˜æ–¹æ–‡æ¡£</a>ï¼Œå®ƒçš„æ–‡æ¡£éƒ½æ˜¯ç¤ºä¾‹çš„å½¢å¼ï¼Œå¹¶ä¸é•¿ï¼Œå¾ˆå®¹æ˜“çœ‹å®Œï¼Œè¿™æ ·ä½ å°±èƒ½å¤ŸçŸ¥é“å®ƒçš„æ‰€æœ‰èƒ½åŠ›ï¼Œä»è€Œåœ¨é‡åˆ°å…·ä½“éœ€æ±‚çš„æ—¶å€™çµæ´»è¿ç”¨ã€‚</p><p>é‚£ä¹ˆæ¥ä¸‹æ¥çš„å†…å®¹ï¼Œæˆ‘ä»¬å°±ä»¥ React Router ä¸ºåŸºç¡€ï¼Œæ¥çœ‹çœ‹è·¯ç”±ç®¡ç†æœ‰å“ªäº›å…·ä½“ä½¿ç”¨åœºæ™¯ã€‚ç›¸ä¿¡é€šè¿‡è¿™äº›ä¾‹å­ï¼Œä½ èƒ½å¤Ÿè¿›ä¸€æ­¥äº†è§£ React Router æä¾›çš„åŠŸèƒ½ã€‚</p><h2>ä½¿ç”¨åµŒå¥—è·¯ç”±ï¼šå®ç°äºŒçº§å¯¼èˆªé¡µé¢</h2><p>æ‰€è°“<strong>åµŒå¥—è·¯ç”±</strong>ï¼Œä¹Ÿç§°ä¸º<strong>å­è·¯ç”±</strong>ï¼Œå°±æ˜¯<strong>ä¸€ä¸ªé¡µé¢ç»„ä»¶å†…éƒ¨ï¼Œè¿˜éœ€è¦é€šè¿‡ URL ä¸Šçš„ä¿¡æ¯æ¥å†³å®šç»„ä»¶å†…éƒ¨æŸä¸ªåŒºåŸŸ<strong><strong>è¯¥</strong></strong>å¦‚ä½•æ˜¾ç¤º</strong>ã€‚</p><p>åµŒå¥—è·¯ç”±å¯¹åº”åˆ°ä¸šåŠ¡åŠŸèƒ½ï¼Œä¸€èˆ¬å°±æ˜¯ä¸€ä¸ªä¸¤çº§å¯¼èˆªé¡µé¢ã€‚æ¯”å¦‚å·¦è¾¹æ˜¯ä¾§è¾¹æ å¯¼èˆªï¼Œç”¨äºæ§åˆ¶å³ä¾§é¡µé¢çš„å±•ç¤ºã€‚è€Œå³ä¾§æŸä¸ªé¡µé¢å‘¢ï¼Œåˆè¦é€šè¿‡é¡¶éƒ¨èœå•æ¥æ§åˆ¶ç»„ä»¶çš„å±•ç¤ºã€‚ä¸‹é¢è¿™å¼ å›¾å°±å±•ç¤ºäº†è¿™æ ·ä¸€ä¸ªå¸ƒå±€ï¼š</p><p><img src=\"https://static001.geekbang.org/resource/image/df/f2/df6a499d5f70f0a6e550989b047c5cf2.png?wh=910x418\" alt=\"\"></p><p>è¿™å°±éœ€è¦è·¯ç”±æ¡†æ¶å…·å¤‡ä¸¤ä¸ªèƒ½åŠ›ï¼š</p><ol>\n<li><strong>èƒ½å¤Ÿæ¨¡ç³ŠåŒ¹é…</strong>ã€‚æ¯”å¦‚ /page1/general ã€/page1/profile è¿™æ ·ä¸¤ä¸ªè·¯ç”±ï¼Œéœ€è¦éƒ½èƒ½åŒ¹é…åˆ° Page1 è¿™æ ·ä¸€ä¸ªç»„ä»¶ã€‚ç„¶å Page1 å†…éƒ¨å‘¢ï¼Œå†æ ¹æ® general å’Œprofile è¿™ä¸¤ä¸ªå­è·¯ç”±å†³å®šå±•ç¤ºå“ªä¸ªå…·ä½“çš„é¡µé¢ã€‚</li>\n<li><strong>Route èƒ½å¤ŸåµŒå¥—ä½¿ç”¨</strong>ã€‚åœ¨æˆ‘ä»¬è‡ªå®šä¹‰ Route çš„ä¾‹å­ä¸­ï¼ŒRoute ç»„ä»¶ä»…ç”¨äºæ”¶é›†è·¯ç”±å®šä¹‰çš„ä¿¡æ¯ï¼Œä¸æ¸²æŸ“ä»»ä½•å†…å®¹ã€‚å¦‚æœéœ€è¦è·¯ç”±èƒ½åµŒå¥—ä½¿ç”¨ï¼Œé‚£å°±æ„å‘³ç€éœ€è¦åœ¨ Route ä¸‹è¿˜èƒ½åµŒå¥—ä½¿ç”¨ Routeã€‚è€Œè¿™åœ¨ React Router æ˜¯æä¾›æ”¯æŒçš„ã€‚</li>\n</ol><p>ä¸‹é¢çš„ä»£ç å°±å±•ç¤ºäº†åµŒå¥—è·¯ç”±çš„ç”¨æ³•ï¼š</p><pre><code>import { BrowserRouter, Route, Link } from &quot;react-router-dom&quot;;\n\n\nconst Page1 = () =&gt; {\n  return (\n    &lt;div className=&quot;exp-15-page1&quot;&gt;\n      &lt;div className=&quot;exp-15-page1-header&quot;&gt;\n        &lt;Link to=&quot;/page1/general&quot;&gt;General&lt;/Link&gt;\n        &lt;Link to=&quot;/page1/profile&quot;&gt;Profile&lt;/Link&gt;\n        &lt;Link to=&quot;/page1/settings&quot;&gt;Settings&lt;/Link&gt;\n      &lt;/div&gt;\n      &lt;div className=&quot;exp-15-page1-content&quot;&gt;\n        &lt;Route path=&quot;/page1/general&quot;&gt;General Page&lt;/Route&gt;\n        &lt;Route path=&quot;/page1/profile&quot;&gt;Profile Page&lt;/Route&gt;\n        &lt;Route path=&quot;/page1/settings&quot;&gt;Settings Page&lt;/Route&gt;\n      &lt;/div&gt;\n    &lt;/div&gt;\n  );\n};\nconst Page2 = () =&gt; &quot;Page 2&quot;;\nconst Page3 = () =&gt; &quot;Page 3&quot;;\n\n\nfunction NestedRouting() {\n  return (\n    &lt;BrowserRouter&gt;\n      &lt;h1&gt;Nested Routing&lt;/h1&gt;\n      &lt;div className=&quot;exp-15-nested-routing&quot;&gt;\n        &lt;div className=&quot;exp-15-sider&quot;&gt;\n          &lt;Link to=&quot;/page1&quot;&gt;Page 1&lt;/Link&gt;\n          &lt;Link to=&quot;/page2&quot;&gt;Page 2&lt;/Link&gt;\n          &lt;Link to=&quot;/page3&quot;&gt;Page 3&lt;/Link&gt;\n        &lt;/div&gt;\n        &lt;div className=&quot;exp-15-page-container&quot;&gt;\n          &lt;Route path=&quot;/page1&quot;&gt;&lt;Page1 /&gt;&lt;/Route&gt;\n          &lt;Route path=&quot;/page2&quot;&gt;&lt;Page2 /&gt;&lt;/Route&gt;\n          &lt;Route path=&quot;/page3&quot;&gt;&lt;Page3 /&gt;&lt;/Route&gt;\n        &lt;/div&gt;\n      &lt;/div&gt;\n    &lt;/BrowserRouter&gt;\n  );\n}\n\n</code></pre><p>å¯ä»¥çœ‹åˆ°ï¼Œæˆ‘ä»¬é¦–å…ˆåœ¨ NestedRouting ç»„ä»¶å†…éƒ¨å®šä¹‰äº†ä¸€çº§å¯¼èˆªï¼Œè®©ä»¥â€œ/page1â€å¼€å¤´çš„è·¯å¾„éƒ½ä½¿ç”¨ Page1 è¿™ä¸ªç»„ä»¶ï¼Œè€Œåœ¨ Page1 ç»„ä»¶å†…éƒ¨ï¼Œå°±ç»§ç»­ä½¿ç”¨ Route ç»„ä»¶æ¥å®šä¹‰äºŒçº§å¯¼èˆªã€‚é‚£ä¹ˆè¿™æ—¶å€™çš„è·¯å¾„ï¼Œå°±éƒ½æ˜¯ä»¥ â€œ/page1â€å¼€å¤´çš„ï¼Œæ¯”å¦‚ â€œ/page1/generalâ€ã€‚é€šè¿‡è¿™æ ·çš„æœºåˆ¶ï¼Œæˆ‘ä»¬å¾ˆå®¹æ˜“å°±å®Œæˆäº†äºŒçº§å¯¼èˆªè¿™æ ·ä¸€ä¸ªå¸¸ç”¨çš„é¡µé¢å¯¼èˆªæ¨¡å¼ã€‚</p><h2>åœ¨ URL ä¸­ä¿å­˜é¡µé¢çŠ¶æ€</h2><p>è¿™èŠ‚è¯¾ä¸€å¼€å§‹æˆ‘å°±æåˆ°äº†ï¼Œæ‹¥æœ‰ URL æ˜¯ Web åº”ç”¨å’Œä¼ ç»Ÿåº”ç”¨æœ€å¤§çš„ä¸€ä¸ªåŒºåˆ«ã€‚è¿™æ„å‘³è¿™ Web åº”ç”¨çš„å†…å®¹æ˜¯å¾ˆå®¹æ˜“åˆ†äº«çš„ï¼Œåªè¦å‘é€ä¸€ä¸ª URLï¼Œåˆ«äººå°±èƒ½å’Œæˆ‘ä»¬çœ‹åˆ°åŒæ ·çš„å†…å®¹ã€‚</p><p>æ‰€ä»¥åœ¨ Web åº”ç”¨ä¸­æˆ‘ä»¬ä¸€å®šè¦åˆ©ç”¨å¥½è¿™ä¸ªç‰¹æ€§ï¼Œä¸€æ–¹é¢å¯ä»¥<strong>æå‡ç”¨æˆ·ä½“éªŒï¼Œ<strong>å¦ä¸€æ–¹é¢ä¹Ÿå¯ä»¥</strong>ç®€åŒ–é¡µé¢ä¹‹é—´çš„äº¤äº’</strong>ã€‚</p><p>è¦åšåˆ°è¿™ä¸€ç‚¹ï¼Œå°±éœ€è¦èƒ½<strong>å°†é¡µé¢çš„ä¸€äº›çŠ¶æ€å­˜æ”¾åˆ° URL ä¸­</strong>ã€‚é‚£ä¹ˆåº•ä¸‹æˆ‘ä»¬å°±é€šè¿‡ä¸€ä¸ªä¾‹å­ï¼Œæ¥çœ‹çœ‹åº”è¯¥å¦‚ä½•åˆ©ç”¨ React Router æ¥ç®¡ç† URL ä¸­çš„å‚æ•°ã€‚ä¸‹é¢è¿™å¼ å›¾å°±å±•ç¤ºäº†è¿™æ ·ä¸€ä¸ªåœºæ™¯ï¼š</p><p><img src=\"https://static001.geekbang.org/resource/image/16/f3/16a96b05c671fa59e6c34a4983ba0cf3.png?wh=1178x674\" alt=\"\"></p><p>é¡µé¢ä¸Šæœ‰ä¸€ä¸ª Tabs ç»„ä»¶ï¼Œåœ¨ä¸¤ä¸ª Tab ä¸‹åˆ†åˆ«æœ‰ä¸¤ä¸ªå¯ä»¥åˆ†é¡µçš„è¡¨æ ¼ã€‚å¦‚æœè¦å°†é¡µé¢çš„å†…å®¹åˆ†äº«ç»™åˆ«äººï¼Œä¸€æ–¹é¢éœ€è¦å®šä½åˆ°å½“å‰å±•å¼€çš„æ˜¯å“ªä¸ª Tabï¼ŒåŒæ—¶è¿˜åº”è¯¥çŸ¥é“å½“å‰æ˜¯è¡¨æ ¼çš„ç¬¬å‡ é¡µï¼Œè¿™æ ·åˆ«äººé€šè¿‡è¿™ä¸ª URL æ‰èƒ½çœ‹åˆ°å’Œä½ ä¸€æ ·çš„å†…å®¹ã€‚æ‰€ä»¥æˆ‘ä»¬åªè¦å°†å½“å‰ Tab çŠ¶æ€ï¼Œå’Œé¡µç çš„çŠ¶æ€æ”¾åˆ° URL ä¸­ï¼Œå°±å¯ä»¥å®ç°è¿™æ ·çš„åŠŸèƒ½ã€‚</p><p>é‚£ä¹ˆå¦‚ä½•å»åšå‘¢ï¼Ÿé¦–å…ˆï¼Œæˆ‘ä»¬éœ€è¦<strong>åˆ©ç”¨ React Router çš„å‚æ•°åŠŸèƒ½æ¥å®šä¹‰ä¸€æ¡è·¯ç”±</strong>ï¼š</p><pre><code>&lt;Route path=&quot;/tabs-page/:activeTab&quot; component={TabsPage} /&gt;\n</code></pre><p>è¿™é‡Œå¯ä»¥çœ‹åˆ°ï¼ŒåŒ¹é…è·¯å¾„ä¸­å®šä¹‰å‚æ•°çš„æ–¹æ³•ï¼Œå°±æ˜¯ç”¨å†’å·å®šä¹‰ä¸€ä¸ªå‚æ•°åå­—ï¼Œè¿™æ ·å¦‚æœè®¿é—® \"/tabs-page/users\" è¿™æ ·çš„è·¯å¾„æ—¶ï¼Œâ€œusersâ€è¿™ä¸ªåå­—å°±å¯ä»¥é€šè¿‡ React Router æä¾›çš„ API æ‹¿åˆ°ã€‚è€Œå¯¹äºé¡µç ä¿¡æ¯ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡æŸ¥è¯¢å­—ç¬¦ä¸²å»å®ç°ã€‚</p><p>ä¸‹é¢çš„ä»£ç æ¼”ç¤ºäº†å®Œæ•´çš„å®ç°ï¼š</p><pre><code>import { useCallback } from &quot;react&quot;;\nimport { Tabs, Table } from &quot;antd&quot;;\nimport { useHistory, useParams } from &quot;react-router-dom&quot;;\nimport data from &quot;../10/data&quot;;\nimport { useSearchParam } from &quot;react-use&quot;;\n\n\nconst { TabPane } = Tabs;\n\n\nexport default () =&gt; {\n  // é€šè¿‡ React Router çš„ API è·å– activeTab è¿™ä¸ªå‚æ•°ä¿¡æ¯\n  const { activeTab = &quot;users&quot; } = useParams();\n  // é€šè¿‡æŸ¥è¯¢å­—ç¬¦ä¸²è·å–å½“å‰çš„é¡µç ä¿¡æ¯\n  const page = parseInt(useSearchParam(&quot;page&quot;), 10) || 1;\n  \n  // é€šè¿‡ React Router æä¾›çš„ history å¯¹è±¡æ¥æ“ä½œ URL\n  const history = useHistory();\n  const handleTabChange = useCallback(\n    (tab) =&gt; history.push(`/15/TabsPage/${tab}`),\n    [history],\n  );\n  // å®šä¹‰è¡¨æ ¼çš„ç¿»é¡µåŠŸèƒ½\n  const pagination = {\n    pageSize: 3,\n    current: page,\n    onChange: (p) =&gt; {\n      history.push(`/15/TabsPage/${activeTab}?page=${p}`);\n    },\n  };\n  return (\n    &lt;div&gt;\n      &lt;h1&gt;Tabs Page&lt;/h1&gt;\n      &lt;Tabs activeKey={activeTab} onChange={handleTabChange}&gt;\n        &lt;TabPane tab=&quot;Users&quot; key=&quot;users&quot;&gt;\n          &lt;Table\n            dataSource={data}\n            columns={[\n              { dataIndex: &quot;name&quot;, title: &quot;User Name&quot; },\n              { dataIndex: &quot;city&quot;, title: &quot;City&quot; },\n            ]}\n            pagination={pagination}\n          /&gt;\n        &lt;/TabPane&gt;\n        &lt;TabPane tab=&quot;Jobs&quot; key=&quot;jobs&quot;&gt;\n          &lt;Table\n            dataSource={data}\n            columns={[{ dataIndex: &quot;job&quot;, title: &quot;Job Title&quot; }]}\n            pagination={pagination}\n          /&gt;\n        &lt;/TabPane&gt;\n      &lt;/Tabs&gt;\n    &lt;/div&gt;\n  );\n}\n\n</code></pre><p>å€Ÿç”±è¿™æ ·çš„å®ç°ï¼Œæˆ‘ä»¬å°±å¯ä»¥é€šè¿‡ \"/tabs-page/users?page=2\" æ¥å”¯ä¸€çš„ç¡®å®šæŸä¸ªé¡µé¢å’Œé¡µé¢çš„çŠ¶æ€äº†ï¼Œè¿™æ ·çš„ URL æ˜¯æ›´è¯­ä¹‰åŒ–ï¼Œå¹¶ä¸”å¯è¢«åˆ†äº«çš„ã€‚</p><p>è¿˜æœ‰ç‰¹åˆ«éœ€è¦æ³¨æ„çš„ä¸€ç‚¹æ˜¯ï¼Œåœ¨è¿™ä¸ªå®ç°ä¸­ï¼Œæˆ‘ä»¬éµå¾ªäº†å”¯ä¸€æ•°æ®æºçš„åŸåˆ™ï¼Œé¿å…å®šä¹‰ä¸­é—´çŠ¶æ€å»å­˜å‚¨ tab å’Œé¡µç çš„ä¿¡æ¯ï¼Œè€Œæ˜¯ç›´æ¥å»æ“ä½œ URLï¼Œè¿™æ ·å¯ä»¥è®©ä»£ç é€»è¾‘æ›´åŠ æ¸…æ™°å’Œç›´è§‚ã€‚</p><h2>è·¯ç”±å±‚é¢å®ç°æƒé™æ§åˆ¶</h2><p>åœ¨ä¸€ä¸ªå‰ç«¯åº”ç”¨ä¸­ï¼Œè·¯ç”±æœºåˆ¶ä¸ä»…èƒ½å¤Ÿç®¡ç†æˆ‘ä»¬çš„å¯¼èˆªï¼Œå¦å¤–ä¸€ä¸ªå¸¸ç”¨çš„åœºæ™¯å°±æ˜¯è¿›è¡Œ<strong>æƒé™çš„æ§åˆ¶</strong>ã€‚æ¯”å¦‚è¯´ï¼Œåªæœ‰ç™»å½•äº†çš„ç”¨æˆ·æ‰èƒ½è®¿é—®æŸäº›é¡µé¢ï¼Œå¦åˆ™å°±ä¼šæ˜¾ç¤ºä¸ºâ€œæœªæˆæƒâ€ï¼Œå¹¶æç¤ºç™»å½•ã€‚é‚£ä¹ˆåº”è¯¥å¦‚ä½•åˆ©ç”¨ React Router å»å®ç°æƒé™æ§åˆ¶å‘¢ï¼Ÿ</p><p>æˆ‘ä»¬å®Œå…¨å¯ä»¥åˆ©ç”¨<strong>å‰ç«¯è·¯ç”±çš„åŠ¨æ€ç‰¹æ€§</strong>ã€‚ä½ å·²ç»çœ‹åˆ°äº†ï¼Œè·¯ç”±æ˜¯<strong>é€šè¿‡ JSX ä»¥å£°æ˜å¼çš„æ–¹å¼å»å®šä¹‰</strong>çš„ï¼Œè¿™å°±æ„å‘³ç€è·¯ç”±çš„å®šä¹‰è§„åˆ™æ˜¯å¯ä»¥æ ¹æ®æ¡ä»¶è¿›è¡Œå˜åŒ–çš„ï¼Œä¹Ÿå°±æ˜¯æ‰€è°“çš„åŠ¨æ€è·¯ç”±ã€‚</p><p>æ‰€ä»¥æˆ‘ä»¬åªéœ€è¦æ ¹æ®ç”¨æˆ·æ˜¯å¦ç™»å½•è¿™æ ·ä¸€ä¸ªçŠ¶æ€ï¼Œé€šè¿‡ Route ç»„ä»¶å»å£°æ˜ä¸åŒçš„è·¯ç”±å°±å¯ä»¥äº†ã€‚æ¯”å¦‚è¯´ä¸‹é¢çš„ä»£ç ï¼Œå°±å±•ç¤ºäº†æƒé™æ§åˆ¶åŠŸèƒ½åº”è¯¥å¦‚ä½•å®ç°ï¼š</p><pre><code>import { useState } from &quot;react&quot;;\nimport { Button } from &quot;antd&quot;;\nimport { Route, Link } from &quot;react-router-dom&quot;;\n\n\n// å®šä¹‰äº†ä¸¤ä¸ªç¤ºä¾‹é¡µé¢ç»„ä»¶\nconst Page1 = () =&gt; &quot;Page 1&quot;;\nconst Page2 = () =&gt; &quot;Page 2&quot;;\n\n\n// å®šä¹‰äº†ä¸€ä¸ªç»„ä»¶ç”¨æˆ·å±•ç¤ºæœªç™»å½•çŠ¶æ€\nconst UnauthedPage = () =&gt; (\n  &lt;span style={{ color: &quot;red&quot; }}&gt;Unauthorized, please log in first.&lt;/span&gt;\n);\nexport default () =&gt; {\n  // æ¨¡æ‹Ÿç”¨æˆ·æ˜¯å¦ç™»å½•çš„çŠ¶æ€ï¼Œé€šè¿‡ä¸€ä¸ªæŒ‰é’®è¿›è¡Œåˆ‡æ¢\n  const [loggedIn, setLoggedIn] = useState(false);\n  \n  // å®šä¹‰äº†ä¸¤å¥—è·¯ç”±ï¼Œä¸€å¥—ç”¨äºç™»å½•åï¼Œä¸€å¥—ç”¨äºæœªç™»å½•çŠ¶æ€\n  const routes = loggedIn\n    ? [\n        {\n          path: &quot;/15/RouterAuth&quot;,\n          component: Page1,\n        },\n        {\n          path: &quot;/15/RouterAuth/page1&quot;,\n          component: Page1,\n        },\n        {\n          path: &quot;/15/RouterAuth/page2&quot;,\n          component: Page2,\n        },\n      ]\n      // å¦‚æœæœªç™»å½•ï¼Œé‚£ä¹ˆå¯¹äºæ‰€æœ‰ /15/RouterAuth å¼€å¤´çš„è·¯å¾„ï¼Œæ˜¾ç¤ºæœªæˆæƒé¡µé¢\n    : [{ path: &quot;/15/RouterAuth&quot;, component: UnauthedPage }];\n\n\n  return (\n    &lt;div&gt;\n      &lt;h1&gt;Router Auth&lt;/h1&gt;\n      &lt;Button\n        type={loggedIn ? &quot;primary&quot; : &quot;&quot;}\n        onClick={() =&gt; setLoggedIn((v) =&gt; !v)}\n      &gt;\n        {loggedIn ? &quot;Log Out&quot; : &quot;Log In&quot;}\n      &lt;/Button&gt;\n\n\n      &lt;div className=&quot;exp-15-router-auth&quot;&gt;\n        &lt;div className=&quot;exp-15-sider&quot;&gt;\n          &lt;Link to=&quot;/15/RouterAuth/page1&quot;&gt;Page 1&lt;/Link&gt;\n          &lt;Link to=&quot;/15/RouterAuth/page2&quot;&gt;Page 2&lt;/Link&gt;\n        &lt;/div&gt;\n        &lt;div className=&quot;exp-15-page-container&quot;&gt;\n          {/* */}\n          {routes.map((r) =&gt; (\n            &lt;Route path={r.path} component={r.component} /&gt;\n          ))}\n        &lt;/div&gt;\n      &lt;/div&gt;\n    &lt;/div&gt;\n  );\n\n</code></pre><p>ä»£ç ä¸­æ ¸å¿ƒçš„æœºåˆ¶å°±åœ¨äºæˆ‘ä»¬æ ¹æ®ç™»å½•çŠ¶æ€ï¼Œåˆ›å»ºäº†ä¸åŒçš„è·¯ç”±è§„åˆ™ï¼Œè¿™æ ·å°±èƒ½åœ¨æºå¤´ä¸Šå¯¹æƒé™è¿›è¡Œé›†ä¸­æ§åˆ¶ï¼Œé¿å…ç”¨æˆ·æœªç»æˆæƒå°±è®¿é—®æŸäº›å—ä¿æŠ¤çš„é¡µé¢ã€‚</p><p>åŒæ—¶å‘¢ï¼Œå› ä¸ºåœ¨ç›¸åŒçš„ URL ä¸‹è¿›è¡Œäº†ä¿¡æ¯æç¤ºï¼Œé‚£ä¹ˆä¹Ÿå°±æ›´å®¹æ˜“å®ç°ç”¨æˆ·ç™»å½•åè¿˜èƒ½è¿”å›åŸé¡µé¢çš„åŠŸèƒ½ã€‚</p><h2>å°ç»“</h2><p>åœ¨è¿™èŠ‚è¯¾æˆ‘ä»¬ä¸»è¦ä»‹ç»äº†åœ¨ React åº”ç”¨ä¸­å¦‚ä½•è¿›è¡Œè·¯ç”±çš„ç®¡ç†ã€‚</p><p>é¦–å…ˆæˆ‘ä»¬äº†è§£äº†è·¯ç”±çš„é‡è¦æ€§ï¼Œå®ƒä¸ä»…èƒ½èµ·åˆ°å¯¼èˆªçš„ä½œç”¨ï¼Œè¿˜èƒ½å¸®åŠ©æˆ‘ä»¬æ›´å¥½åœ°ç»„ç»‡ä¸šåŠ¡æ¨¡å—çš„ä»£ç ã€‚</p><p>éšåæˆ‘ä»¬è‡ªå·±åŠ¨æ‰‹ï¼Œå®ç°äº†ä¸€ä¸ªç®€å•çš„è·¯ç”±æœºåˆ¶ï¼Œè®¤è¯†åˆ°è·¯ç”±åœ¨æœ¬è´¨ä¸Šå°±æ˜¯<strong>æ ¹æ®çŠ¶æ€æ¸²æŸ“ä¸åŒçš„ç»„ä»¶</strong>ã€‚æ³¨æ„ï¼Œè¿™é‡Œçš„çŠ¶æ€å°±æ˜¯ URL çš„è·¯å¾„ï¼Œè€Œç»„ä»¶åˆ™æ˜¯éœ€è¦å¯¼èˆªçš„é¡µé¢ã€‚ç†è§£äº†è¿™ä¸€ç‚¹ï¼Œä¹Ÿå°±èƒ½å¤Ÿç†è§£ä¸€äº›å¼€æºæ¡†æ¶çš„å…·ä½“å·¥ä½œåŸç†ï¼Œé‚£ä¹ˆä½ åœ¨ä½¿ç”¨æ—¶ä¹Ÿå°±ä¼šæ›´åŠ ä»å®¹ã€‚</p><p>æ¥ç€ï¼Œæˆ‘ä»¬ä»‹ç»äº† React ç”Ÿæ€ä¸­æœ€ä¸ºä¸»æµçš„ React Router æ¡†æ¶ï¼Œå®ƒæä¾›äº†å¾ˆå¤šçµæ´»çš„ APIï¼Œæ—¢å¯ä»¥è®©æˆ‘ä»¬å¯ä»¥å®ç°è·¯ç”±çš„å®šä¹‰å’Œé…ç½®ï¼Œæ¯”å¦‚çµæ´»çš„æ¨¡å¼åŒ¹é…ã€å‚æ•°ã€åµŒå¥—è·¯ç”±ç­‰ç­‰ï¼Œä¹Ÿèƒ½è®©æˆ‘ä»¬åœ¨å®é™…é¡¹ç›®ä¸­æ›´åŠ å®¹æ˜“åœ°å»å®ç°è·¯ç”±åŠŸèƒ½ã€‚</p><p>æœ€åï¼Œé€šè¿‡ä¸¤ä¸ªä¾‹å­ï¼Œæˆ‘ä»¬çœ‹åˆ°äº†è·¯ç”±æœºåˆ¶åœ¨æ•´ä¸ªå‰ç«¯åº”ç”¨ä¸­çš„ä½œç”¨ã€‚è¦çŸ¥é“ï¼Œå®ƒä¸ä»…ä»…å¯ä»¥èµ·åˆ°å¯¼èˆªçš„ä½œç”¨ï¼Œè¿˜èƒ½è¯­ä¹‰åŒ–åœ°æ ‡è¯†é¡µé¢çŠ¶æ€ï¼Œä»¥åŠè¿›è¡Œæƒé™æ§åˆ¶ã€‚å‰è€…æå‡äº†ç”¨æˆ·ä½“éªŒï¼Œè®©å‰ç«¯é¡µé¢çœŸæ­£åšåˆ°å¯åˆ†äº«ã€‚è€Œåè€…åˆ™èµ·åˆ°å…³æ³¨åˆ†ç¦»çš„ä½œç”¨ï¼Œé€šè¿‡å°†æƒé™æ§åˆ¶é€»è¾‘åœ¨è·¯ç”±å±‚é¢å®ç°ï¼Œå°±å¯ä»¥è®©è¿™éƒ¨åˆ†é€»è¾‘ç‹¬ç«‹å‡ºæ¥ï¼Œè€Œæ— é¡»å’Œä¸šåŠ¡é€»è¾‘å†™åœ¨ä¸€èµ·ï¼Œè®©ä»£ç æ›´å®¹æ˜“ç†è§£å’Œç»´æŠ¤ã€‚</p><h2>æ€è€ƒé¢˜</h2><p>æ–‡ä¸­æåˆ°åœ¨ URL ä¸­å­˜å‚¨æ›´å¤šçŠ¶æ€å¯ä»¥ç®€åŒ–é¡µé¢ä¹‹é—´çš„äº¤äº’ï¼Œé‚£ä¹ˆä¸ºä»€ä¹ˆè¯´å¯ä»¥ç®€åŒ–äº¤äº’å‘¢ï¼Ÿä½ èƒ½æƒ³åˆ°å“ªäº›åœºæ™¯å‘¢ï¼Ÿ</p><p>æ¬¢è¿æŠŠä½ çš„æƒ³æ³•å’Œæ€è€ƒåˆ†äº«åœ¨ç•™è¨€åŒºï¼Œæˆ‘ä¼šå’Œä½ äº¤æµã€‚åŒæ—¶ï¼Œæˆ‘ä¹Ÿä¼šæŠŠå…¶ä¸­ä¸€äº›ä¸é”™çš„å›ç­”åœ¨ç•™è¨€åŒºç½®é¡¶ï¼Œä¾›å¤§å®¶å­¦ä¹ è®¨è®ºã€‚</p>","comments":[{"had_liked":false,"id":299942,"user_name":"é™ˆå¥½äºº","can_delete":false,"product_type":"c1","uid":2007510,"ip_address":"","ucode":"AEB05BB66B5F75","user_header":"https://static001.geekbang.org/account/avatar/00/1e/a1/d6/64eee5af.jpg","comment_is_top":false,"comment_ctime":1624931238,"is_pvip":false,"discussion_count":2,"race_medal":0,"score":"61754473382","product_id":100079901,"comment_content":"ä»¥ä¸ºä½œè€…è¦ä»£é¢†å¤§ä¼™å®ç°ä¸€ä¸ªuseHistoryä¹‹ç±»çš„hookï¼Œæ²¡æƒ³åˆ°çœŸçš„åªæ˜¯è®²routeğŸ˜‚","like_count":14,"discussions":[{"author":{"id":2253782,"avatar":"https://static001.geekbang.org/account/avatar/00/22/63/d6/1eea4d74.jpg","nickname":"ç§‹æ¥“æš®éœæƒ‹ç´…æ›²","note":"","ucode":"090737A69E9696","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":381684,"discussion_content":"æŒ‚ç¾Šå¤´å–ç‹—è‚‰","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1625184927,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":2253782,"avatar":"https://static001.geekbang.org/account/avatar/00/22/63/d6/1eea4d74.jpg","nickname":"ç§‹æ¥“æš®éœæƒ‹ç´…æ›²","note":"","ucode":"090737A69E9696","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":381683,"discussion_content":"åŒæ„Ÿ","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1625184919,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":308765,"user_name":"Brave","can_delete":false,"product_type":"c1","uid":1378339,"ip_address":"","ucode":"4F66150D471D3B","user_header":"https://static001.geekbang.org/account/avatar/00/15/08/23/1cc7d190.jpg","comment_is_top":false,"comment_ctime":1629790411,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"18809659595","product_id":100079901,"comment_content":"èƒ½æƒ³åˆ°è¿™æ ·ä¸€äº›ä½¿ç”¨åœºæ™¯ï¼š<br>1.  ç™»å½•åçš„URLé‡å®šå‘é“¾æ¥<br>2. ä¸´æ—¶å­˜å‚¨ä¸‹ä¸€é¡µéœ€è¦çš„æ•°æ®<br>3. é˜²æ­¢é¡µé¢åˆ·æ–°å‚æ•°ä¸¢å¤±","like_count":4},{"had_liked":false,"id":299973,"user_name":"å‰ç«¯å°çŒª","can_delete":false,"product_type":"c1","uid":1764429,"ip_address":"","ucode":"DDC0F702986274","user_header":"https://static001.geekbang.org/account/avatar/00/1a/ec/4d/1551ed5f.jpg","comment_is_top":false,"comment_ctime":1624943886,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"10214878478","product_id":100079901,"comment_content":"æ¯”å¦‚é€šè¿‡Searchå»æŸ¥è¯¢å¹¶è¿”å›æ•°æ®re-renderçš„ç»“æœï¼Œå¦‚æœå¯ä»¥é€šè¿‡urlæŸ¥è¯¢å‚æ•°å»ç›‘å¬ï¼Œå°±ç®€åŒ–äº†äº¤äº’å§","like_count":2},{"had_liked":false,"id":302889,"user_name":"çªçª","can_delete":false,"product_type":"c1","uid":2462877,"ip_address":"","ucode":"FBD4EBA6ADB80C","user_header":"https://static001.geekbang.org/account/avatar/00/25/94/9d/0d8103ad.jpg","comment_is_top":false,"comment_ctime":1626423623,"is_pvip":false,"replies":[{"id":"109872","content":"å¯¹ umi å¹¶ä¸æ˜¯éå¸¸äº†è§£ï¼Œå¦‚æœä½ æŒ‡çš„çŠ¶æ€æ˜¯ url ä¸Šçš„ä¸€äº›å‚æ•°ï¼Œé‚£ä¹ˆå°±è¦çœ‹ umi æ˜¯å¦æ”¯æŒæ¨¡å¼åŒ¹é…çš„è·¯ç”±è§„åˆ™äº†ã€‚<br>","user_name":"ä½œè€…å›å¤","user_name_real":"Nate","uid":"1018676","ctime":1626855092,"ip_address":"","comment_id":302889,"utype":1}],"discussion_count":3,"race_medal":0,"score":"5921390919","product_id":100079901,"comment_content":"ä½ å¥½ï¼Œç‹è€å¸ˆï¼Œè¯·é—®å¦‚æœæˆ‘ä½¿ç”¨é˜¿é‡Œçš„Umiè¿›è¡Œé¡¹ç›®æ­å»ºï¼Œä½¿ç”¨é‡Œé¢çš„çº¦å®šå¼è·¯ç”±ï¼Œæ­¤æ—¶è¯¥æ€ä¹ˆç®¡ç†çŠ¶æ€å‘¢ï¼Ÿ","like_count":1,"discussions":[{"author":{"id":1018676,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/8b/34/61035278.jpg","nickname":"Nate","note":"","ucode":"844B4C20BB3D6E","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":523467,"discussion_content":"å¯¹ umi å¹¶ä¸æ˜¯éå¸¸äº†è§£ï¼Œå¦‚æœä½ æŒ‡çš„çŠ¶æ€æ˜¯ url ä¸Šçš„ä¸€äº›å‚æ•°ï¼Œé‚£ä¹ˆå°±è¦çœ‹ umi æ˜¯å¦æ”¯æŒæ¨¡å¼åŒ¹é…çš„è·¯ç”±è§„åˆ™äº†ã€‚\n","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1626855092,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":1,"child_discussions":[{"author":{"id":1374957,"avatar":"https://static001.geekbang.org/account/avatar/00/14/fa/ed/0742b854.jpg","nickname":"Jun Ma","note":"","ucode":"0C5E2AB51E6A83","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":1018676,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/8b/34/61035278.jpg","nickname":"Nate","note":"","ucode":"844B4C20BB3D6E","race_medal":0,"user_type":2,"is_pvip":false},"discussion":{"id":584662,"discussion_content":"å°±æ˜¯çº¦å®šçš„ æŸäº›æ–‡ä»¶ç›®å½•è·¯å¾„ä¼šè¢«umi è§£ææˆè·¯ç”±çš„è·¯å¾„ã€‚  \nå¸Œæœ›è€å¸ˆå¤šè®²è®²ï¼ŒåŠ¨æ€è·¯ç”±ï¼Œå½“ä¸‹ä¸»è¦çš„æƒé™æ§åˆ¶æ–¹æ¡ˆç­‰ç­‰ã€‚\nè·¯ç”±è¿™å—å¸Œæœ›è€å¸ˆå¤šè®²ä¸€ç‚¹ã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1661009765,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":523467,"ip_address":"å››å·"},"score":584662,"extra":""}]},{"author":{"id":1379485,"avatar":"https://static001.geekbang.org/account/avatar/00/15/0c/9d/6ab58353.jpg","nickname":"æå°èƒ–","note":"","ucode":"34E6D282BBEEA7","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":531083,"discussion_content":"å¯ä»¥è®¾ç½®æˆé…ç½®è·¯ç”±ï¼Œå…·ä½“å¯ä»¥çœ‹ä¸‹umiçš„è·¯ç”±æ–‡æ¡£ https://umijs.org/zh-CN/docs/routing","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1637223726,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"user_type\":1}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":300550,"user_name":"å©§å­é…±.","can_delete":false,"product_type":"c1","uid":2177627,"ip_address":"","ucode":"B47F87EFA8F8F5","user_header":"https://static001.geekbang.org/account/avatar/00/21/3a/5b/e59f76a6.jpg","comment_is_top":false,"comment_ctime":1625215812,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"5920183108","product_id":100079901,"comment_content":"è®²çš„å¾ˆæ£’ å­¦ä¹ äº†","like_count":1},{"had_liked":false,"id":300180,"user_name":"çˆ±åƒé±¼çš„å–µ","can_delete":false,"product_type":"c1","uid":2647534,"ip_address":"","ucode":"EC93613A6D3512","user_header":"https://static001.geekbang.org/account/avatar/00/28/65/ee/df736f73.jpg","comment_is_top":false,"comment_ctime":1625036671,"is_pvip":false,"replies":[{"id":"108840","content":"æš‚æ—¶æ²¡æœ‰å“¦ï½æœ‰é—®é¢˜å¯ä»¥åœ¨ç•™è¨€åŒºç»™è€å¸ˆç•™è¨€å‘ï¼","user_name":"ç¼–è¾‘å›å¤","user_name_real":"æè¾°æ´‹","uid":"2189689","ctime":1625052531,"ip_address":"","comment_id":300180,"utype":2}],"discussion_count":1,"race_medal":0,"score":"5920003967","product_id":100079901,"comment_content":"æœ‰å¾®ä¿¡ç¾¤å—","like_count":1,"discussions":[{"author":{"id":2189689,"avatar":"https://static001.geekbang.org/account/avatar/00/21/69/79/b4132042.jpg","nickname":"ğŸ‘","note":"","ucode":"DE34B3B14287D1","race_medal":0,"user_type":8,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":522670,"discussion_content":"æš‚æ—¶æ²¡æœ‰å“¦ï½æœ‰é—®é¢˜å¯ä»¥åœ¨ç•™è¨€åŒºç»™è€å¸ˆç•™è¨€å‘ï¼","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1625052531,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":4}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":355051,"user_name":"Jun Ma","can_delete":false,"product_type":"c1","uid":1374957,"ip_address":"å››å·","ucode":"0C5E2AB51E6A83","user_header":"https://static001.geekbang.org/account/avatar/00/14/fa/ed/0742b854.jpg","comment_is_top":false,"comment_ctime":1661009626,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1661009626","product_id":100079901,"comment_content":"æˆ‘è§‰å¾—è€å¸ˆ router è¿™å—å¯ä»¥è®²å¾—æ·±ä¸€ç‚¹ã€‚ <br>æ¯”å¦‚åŠ¨æ€è·¯ç”±ï¼Œ å½“ä¸‹çš„è·¯ç”±æƒé™æ§åˆ¶çš„æ–¹æ¡ˆï¼Œç­‰ç­‰","like_count":0},{"had_liked":false,"id":352587,"user_name":"lunar","can_delete":false,"product_type":"c1","uid":1197007,"ip_address":"","ucode":"4FC1E388AD98C6","user_header":"https://static001.geekbang.org/account/avatar/00/12/43/cf/118c4ef5.jpg","comment_is_top":false,"comment_ctime":1658797830,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1658797830","product_id":100079901,"comment_content":"æ‰¾äº†åŠå¤© Switchï¼Œæœ€åå‘ç°åœ¨ react-router-dom v6 ä»¥åç§»é™¤äº†ğŸ¥²","like_count":0},{"had_liked":false,"id":302327,"user_name":"å­™æ™“èƒ§","can_delete":false,"product_type":"c1","uid":1485409,"ip_address":"","ucode":"EA718004E6ED5E","user_header":"https://static001.geekbang.org/account/avatar/00/16/aa/61/d01028ad.jpg","comment_is_top":false,"comment_ctime":1626167153,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1626167153","product_id":100079901,"comment_content":"è€å¸ˆæ‚¨å¥½ï¼ŒåŠ¨æ€è·¯ç”±è¿˜æœ‰ä¸€ç§æƒ…å†µï¼Œæ˜¯ä»åç«¯è¯·æ±‚å›æ¥çš„ï¼Œè¿™ç§æœ‰æ¯”è¾ƒä¼˜é›…çš„å®ä¾‹ä»£ç å—ï¼Ÿæ±‚èµæ•™ï¼Œæ„Ÿè°¢ã€‚","like_count":0},{"had_liked":false,"id":301268,"user_name":"å›","can_delete":false,"product_type":"c1","uid":2688367,"ip_address":"","ucode":"D15FAFAA80A8FF","user_header":"https://static001.geekbang.org/account/avatar/00/29/05/6f/6a47d5b7.jpg","comment_is_top":false,"comment_ctime":1625617689,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1625617689","product_id":100079901,"comment_content":"æœ‰çš„æ—¶å€™ï¼Œhooksæˆ–è€…contextçš„çŠ¶æ€æ²¡æ³•åœ¨jsæ–‡ä»¶ä¸­ç”¨ï¼Œè¿™ä¸ªæ—¶å€™æˆ‘æ›´å€¾å‘classç®¡ç†çŠ¶æ€ï¼Œä½†è¿™æ ·è¿˜éœ€è¦ä¸€ä¸ªè§¦å‘re-renderçš„æœ‰æ•ˆæœºåˆ¶å§","like_count":0}]}