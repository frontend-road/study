{"id":144156,"title":"42 | å¦‚ä½•æ„å»ºé«˜æ•ˆçš„Flutter Appæ‰“åŒ…å‘å¸ƒç¯å¢ƒï¼Ÿ","content":"<p>ä½ å¥½ï¼Œæˆ‘æ˜¯é™ˆèˆªã€‚ä»Šå¤©ï¼Œæˆ‘ä»¬æ¥èŠä¸€èŠFlutteråº”ç”¨çš„äº¤ä»˜è¿™ä¸ªè¯é¢˜ã€‚</p><p>è½¯ä»¶é¡¹ç›®çš„äº¤ä»˜æ˜¯ä¸€ä¸ªå¤æ‚çš„è¿‡ç¨‹ï¼Œä»»ä½•åŸå› éƒ½æœ‰å¯èƒ½å¯¼è‡´äº¤ä»˜è¿‡ç¨‹å¤±è´¥ã€‚ä¸­å°å‹ç ”å‘å›¢é˜Ÿç»å¸¸é‡åˆ°çš„ä¸€ä¸ªç°è±¡æ˜¯ï¼ŒAppåœ¨å¼€å‘æµ‹è¯•æ—¶æ²¡æœ‰ä»»ä½•å¼‚å¸¸ï¼Œä½†ä¸€åˆ°æœ€åçš„æ‰“åŒ…æ„å»ºäº¤ä»˜æ—¶å°±é—®é¢˜é¢‘å‡ºã€‚æ‰€ä»¥ï¼Œæ¯åˆ°æ–°ç‰ˆæœ¬å‘å¸ƒæ—¶ï¼Œå¤§å®¶ä¸ä»…è¦ç­‰å€™æ‰“åŒ…ç»“æœï¼Œè¿˜ç»å¸¸éœ€è¦åŠ ç­ä¿®å¤ä¸´æ—¶å‡ºç°çš„é—®é¢˜ã€‚å¦‚æœæ²¡æœ‰å¾ˆå¥½åœ°çº¿ä¸Šåº”æ€¥ç­–ç•¥ï¼Œå³ä½¿æ‰“åŒ…æˆåŠŸï¼Œäº¤ä»˜å®Œæˆåè¿˜æ˜¯éå¸¸ç´§å¼ ã€‚</p><p>å¯ä»¥çœ‹åˆ°ï¼Œäº§å“äº¤ä»˜ä¸ä»…æ˜¯ä¸€ä¸ªä»¤å·¥ç¨‹å¸ˆå¤´ç–¼çš„è¿‡ç¨‹ï¼Œè¿˜æ˜¯ä¸€ä¸ªé«˜é£é™©åŠ¨ä½œã€‚å…¶å®ï¼Œå¤±è´¥å¹¶ä¸å¯æ€•ï¼Œå¯æ€•çš„æ˜¯æ¯æ¬¡å¤±è´¥çš„åŸå› éƒ½ä¸ä¸€æ ·ã€‚æ‰€ä»¥ï¼Œä¸ºäº†ä¿éšœå¯é äº¤ä»˜ï¼Œæˆ‘ä»¬éœ€è¦å…³æ³¨ä»æºä»£ç åˆ°å‘å¸ƒçš„æ•´ä¸ªæµç¨‹ï¼Œæä¾›ä¸€ç§å¯é çš„å‘å¸ƒæ”¯æ’‘ï¼Œç¡®ä¿Appæ˜¯ä»¥ä¸€ç§å¯é‡å¤çš„ã€è‡ªåŠ¨åŒ–çš„æ–¹å¼æ„å»ºå‡ºæ¥çš„ã€‚åŒæ—¶ï¼Œæˆ‘ä»¬è¿˜åº”è¯¥å°†æ‰“åŒ…è¿‡ç¨‹æå‰ï¼Œå°†æ„å»ºé¢‘ç‡åŠ å¿«ï¼Œå› ä¸ºè¿™æ ·ä¸ä»…å¯ä»¥å°½æ—©å‘ç°é—®é¢˜ï¼Œä¿®å¤æˆæœ¬ä¹Ÿä¼šæ›´ä½ï¼Œå¹¶ä¸”èƒ½æ›´å¥½åœ°ä¿è¯ä»£ç å˜æ›´èƒ½å¤Ÿé¡ºåˆ©å‘å¸ƒä¸Šçº¿ã€‚</p><p>å…¶å®ï¼Œè¿™æ­£æ˜¯æŒç»­äº¤ä»˜çš„æ€è·¯ã€‚</p><p>æ‰€è°“æŒç»­äº¤ä»˜ï¼ŒæŒ‡çš„æ˜¯å»ºç«‹ä¸€å¥—è‡ªåŠ¨ç›‘æµ‹æºä»£ç å˜æ›´ï¼Œå¹¶è‡ªåŠ¨å®æ–½æ„å»ºã€æµ‹è¯•ã€æ‰“åŒ…å’Œç›¸å…³æ“ä½œçš„æµç¨‹é“¾æœºåˆ¶ï¼Œä»¥ä¿è¯è½¯ä»¶å¯ä»¥æŒç»­ã€ç¨³å®šåœ°ä¿æŒåœ¨éšæ—¶å¯ä»¥å‘å¸ƒçš„çŠ¶æ€ã€‚ æŒç»­äº¤ä»˜å¯ä»¥è®©è½¯ä»¶çš„æ„å»ºã€æµ‹è¯•ä¸å‘å¸ƒå˜å¾—æ›´å¿«ã€æ›´é¢‘ç¹ï¼Œæ›´æ—©åœ°æš´éœ²é—®é¢˜å’Œé£é™©ï¼Œé™ä½è½¯ä»¶å¼€å‘çš„æˆæœ¬ã€‚</p><!-- [[[read_end]]] --><p>ä½ å¯èƒ½ä¼šè§‰å¾—ï¼Œå¤§å‹è½¯ä»¶å·¥ç¨‹é‡Œæ‰ä¼šç”¨åˆ°æŒç»­äº¤ä»˜ã€‚å…¶å®ä¸ç„¶ï¼Œé€šè¿‡è¿ç”¨ä¸€äº›å…è´¹çš„å·¥å…·å’Œå¹³å°ï¼Œä¸­å°å‹é¡¹ç›®ä¹Ÿèƒ½å¤Ÿäº«å—åˆ°å¼€å‘ä»»åŠ¡è‡ªåŠ¨åŒ–çš„ä¾¿åˆ©ã€‚è€ŒTravis CIå°±æ˜¯è¿™ç±»å·¥å…·ä¹‹ä¸­ï¼Œå¸‚åœºä»½é¢æœ€å¤§çš„ä¸€ä¸ªã€‚æ‰€ä»¥æ¥ä¸‹æ¥ï¼Œæˆ‘å°±ä»¥Travis CIä¸ºä¾‹ï¼Œä¸ä½ åˆ†äº«å¦‚ä½•ä¸ºFlutterå·¥ç¨‹å¼•å…¥æŒç»­äº¤ä»˜çš„èƒ½åŠ›ã€‚</p><h2>Travis CI</h2><p>Travis CI æ˜¯åœ¨çº¿æ‰˜ç®¡çš„æŒç»­äº¤ä»˜æœåŠ¡ï¼Œç”¨Travisæ¥è¿›è¡ŒæŒç»­äº¤ä»˜ï¼Œä¸éœ€è¦è‡ªå·±æ­æœåŠ¡å™¨ï¼Œåœ¨ç½‘é¡µä¸Šç‚¹å‡ ä¸‹å°±å¥½ï¼Œéå¸¸æ–¹ä¾¿ã€‚</p><p>Traviså’ŒGitHubæ˜¯ä¸€å¯¹é…åˆé»˜å¥‘çš„å·¥ä½œä¼™ä¼´ï¼Œåªè¦ä½ åœ¨Travisä¸Šç»‘å®šäº†GitHubä¸Šçš„é¡¹ç›®ï¼Œåç»­ä»»ä½•ä»£ç çš„å˜æ›´éƒ½ä¼šè¢«Travisè‡ªåŠ¨æŠ“å–ã€‚ç„¶åï¼ŒTravisä¼šæä¾›ä¸€ä¸ªè¿è¡Œç¯å¢ƒï¼Œæ‰§è¡Œæˆ‘ä»¬é¢„å…ˆåœ¨é…ç½®æ–‡ä»¶ä¸­å®šä¹‰å¥½çš„æµ‹è¯•å’Œæ„å»ºæ­¥éª¤ï¼Œå¹¶æœ€ç»ˆæŠŠè¿™æ¬¡å˜æ›´äº§ç”Ÿçš„æ„å»ºäº§ç‰©å½’æ¡£åˆ°GitHub Releaseä¸Šï¼Œå¦‚ä¸‹æ‰€ç¤ºï¼š</p><p><img src=\"https://static001.geekbang.org/resource/image/1e/85/1e416da5f8bd0295b75328c728b75e85.png?wh=1190*502\" alt=\"\"></p><center><span class=\"reference\">å›¾1 Travis CIæŒç»­äº¤ä»˜æµç¨‹ç¤ºæ„å›¾</span></center><p>å¯ä»¥çœ‹åˆ°ï¼Œé€šè¿‡Travisæä¾›çš„æŒç»­æ„å»ºäº¤ä»˜èƒ½åŠ›ï¼Œæˆ‘ä»¬å¯ä»¥ç›´æ¥çœ‹åˆ°æ¯æ¬¡ä»£ç çš„æ›´æ–°çš„å˜æ›´ç»“æœï¼Œè€Œä¸éœ€è¦ç´¯ç§¯åˆ°å‘å¸ƒå‰å†åšæ‰“åŒ…æ„å»ºã€‚è¿™æ ·ä¸ä»…å¯ä»¥æ›´æ—©åœ°å‘ç°é”™è¯¯ï¼Œå®šä½é—®é¢˜ä¹Ÿä¼šæ›´å®¹æ˜“ã€‚</p><p>è¦æƒ³ä¸ºé¡¹ç›®æä¾›æŒç»­äº¤ä»˜çš„èƒ½åŠ›ï¼Œæˆ‘ä»¬é¦–å…ˆéœ€è¦åœ¨Travisä¸Šç»‘å®šGitHubã€‚æˆ‘ä»¬æ‰“å¼€<a href=\"https://travis-ci.com/\">Traviså®˜ç½‘</a>ï¼Œä½¿ç”¨è‡ªå·±çš„GitHubè´¦å·æˆæƒç™»é™†å°±å¯ä»¥äº†ã€‚ç™»å½•å®Œæˆåé¡µé¢ä¸­ä¼šå‡ºç°ä¸€ä¸ªâ€œActivateâ€æŒ‰é’®ï¼Œç‚¹å‡»æŒ‰é’®ä¼šè·³å›åˆ°GitHubä¸­è¿›è¡Œé¡¹ç›®è®¿é—®æƒé™è®¾ç½®ã€‚æˆ‘ä»¬ä¿ç•™é»˜è®¤çš„è®¾ç½®ï¼Œç‚¹å‡»â€œApprove&amp;Installâ€å³å¯ã€‚</p><p><img src=\"https://static001.geekbang.org/resource/image/06/4a/0655107bfdbc132e9e1ab72dc42c194a.png?wh=2018*1242\" alt=\"\"></p><center><span class=\"reference\">å›¾2 æ¿€æ´»Githubé›†æˆ</span></center><p><img src=\"https://static001.geekbang.org/resource/image/a5/4d/a5512881dd0dd42dd845300302d8fb4d.png?wh=1214*1584\" alt=\"\"></p><center><span class=\"reference\">å›¾3 æˆæƒTravisè¯»å–é¡¹ç›®å˜æ›´è®°å½•</span></center><p>å®Œæˆæˆæƒä¹‹åï¼Œé¡µé¢ä¼šè·³è½¬åˆ°Travisã€‚Travisä¸»é¡µä¸Šä¼šåˆ—å‡ºGitHubä¸Šä½ çš„æ‰€æœ‰ä»“åº“ï¼Œä»¥åŠä½ æ‰€å±äºçš„ç»„ç»‡ï¼Œå¦‚ä¸‹å›¾æ‰€ç¤ºï¼š</p><p><img src=\"https://static001.geekbang.org/resource/image/6f/36/6ffd97d34bbbb496d95d11fbaf9b2d36.png?wh=2032*994\" alt=\"\"></p><center><span class=\"reference\">å›¾4 å®ŒæˆGithubé¡¹ç›®ç»‘å®š</span></center><p>å®Œæˆé¡¹ç›®ç»‘å®šåï¼Œæ¥ä¸‹æ¥å°±æ˜¯<strong>ä¸ºé¡¹ç›®å¢åŠ Travisé…ç½®æ–‡ä»¶</strong>äº†ã€‚é…ç½®çš„æ–¹æ³•ä¹Ÿå¾ˆç®€å•ï¼Œåªè¦åœ¨é¡¹ç›®çš„æ ¹ç›®å½•ä¸‹æ”¾ä¸€ä¸ªåä¸º.travis.ymlçš„æ–‡ä»¶å°±å¯ä»¥äº†ã€‚</p><p>.travis.ymlæ˜¯Travisçš„é…ç½®æ–‡ä»¶ï¼ŒæŒ‡å®šäº†Travisåº”è¯¥å¦‚ä½•åº”å¯¹ä»£ç å˜æ›´ã€‚ä»£ç commitä¸Šå»ä¹‹åï¼Œä¸€æ—¦Travisæ£€æµ‹åˆ°æ–°çš„å˜æ›´ï¼ŒTraviså°±ä¼šå»æŸ¥æ‰¾è¿™ä¸ªæ–‡ä»¶ï¼Œæ ¹æ®é¡¹ç›®ç±»å‹ï¼ˆlanguageï¼‰ç¡®å®šæ‰§è¡Œç¯èŠ‚ï¼Œç„¶åæŒ‰ç…§ä¾èµ–å®‰è£…ï¼ˆinstallï¼‰ã€æ„å»ºå‘½ä»¤ï¼ˆscriptï¼‰å’Œå‘å¸ƒï¼ˆdeployï¼‰è¿™ä¸‰å¤§æ­¥éª¤ï¼Œä¾æ¬¡æ‰§è¡Œé‡Œé¢çš„å‘½ä»¤ã€‚ä¸€ä¸ªTravisæ„å»ºä»»åŠ¡æµç¨‹å¦‚ä¸‹æ‰€ç¤ºï¼š</p><p><img src=\"https://static001.geekbang.org/resource/image/53/04/535659463b5bcc2bde187dcabfa5fc04.png?wh=1562*342\" alt=\"\"></p><center><span class=\"reference\">å›¾5 Traviså·¥ä½œæµ</span></center><p>å¯ä»¥çœ‹åˆ°ï¼Œä¸ºäº†æ›´ç²¾ç»†åœ°æ§åˆ¶æŒç»­æ„å»ºè¿‡ç¨‹ï¼ŒTravisè¿˜ä¸ºinstallã€scriptå’Œdeployæä¾›äº†å¯¹åº”çš„é’©å­ï¼ˆbefore_installã€before_scriptã€after_failureã€after_successã€before_deployã€after_deployã€after_scriptï¼‰ï¼Œå¯ä»¥å‰ç½®æˆ–åç½®åœ°æ‰§è¡Œä¸€äº›ç‰¹æ®Šæ“ä½œã€‚</p><p>å¦‚æœä½ çš„é¡¹ç›®æ¯”è¾ƒç®€å•ï¼Œæ²¡æœ‰å…¶ä»–çš„ç¬¬ä¸‰æ–¹ä¾èµ–ï¼Œä¹Ÿä¸éœ€è¦å‘å¸ƒåˆ°GitHub Releaseä¸Šï¼Œåªæ˜¯æƒ³çœ‹çœ‹æ„å»ºä¼šä¸ä¼šå¤±è´¥ï¼Œé‚£ä¹ˆä½ å¯ä»¥çœç•¥é…ç½®æ–‡ä»¶ä¸­çš„installå’Œdeployã€‚</p><h2>å¦‚ä½•ä¸ºé¡¹ç›®å¼•å…¥Travisï¼Ÿ</h2><p>å¯ä»¥çœ‹åˆ°ï¼Œä¸€ä¸ªæœ€ç®€å•çš„é…ç½®æ–‡ä»¶åªéœ€è¦æä¾›ä¸¤ä¸ªå­—æ®µï¼Œå³languageå’Œscriptï¼Œå°±å¯ä»¥è®©Traviså¸®ä½ è‡ªåŠ¨æ„å»ºäº†ã€‚ä¸‹é¢çš„ä¾‹å­æ¼”ç¤ºäº†å¦‚ä½•ä¸ºä¸€ä¸ªDartå‘½ä»¤è¡Œé¡¹ç›®å¼•å…¥Travisã€‚åœ¨ä¸‹é¢çš„é…ç½®æ–‡ä»¶ä¸­ï¼Œæˆ‘ä»¬å°†languageå­—æ®µè®¾ç½®ä¸ºDartï¼Œå¹¶åœ¨scriptå­—æ®µä¸­ï¼Œå°†dart_sample.dartå®šä¹‰ä¸ºç¨‹åºå…¥å£å¯åŠ¨è¿è¡Œï¼š</p><pre><code>#.travis.yml\nlanguage: dart\nscript:\n  - dart dart_sample.dart\n</code></pre><p>å°†è¿™ä¸ªæ–‡ä»¶æäº¤è‡³é¡¹ç›®ä¸­ï¼Œæˆ‘ä»¬å°±å®Œæˆäº†Travisçš„é…ç½®å·¥ä½œã€‚</p><p>Travisä¼šåœ¨æ¯æ¬¡ä»£ç æäº¤æ—¶è‡ªåŠ¨è¿è¡Œé…ç½®æ–‡ä»¶ä¸­çš„å‘½ä»¤ï¼Œå¦‚æœæ‰€æœ‰å‘½ä»¤éƒ½è¿”å›0ï¼Œå°±è¡¨ç¤ºéªŒè¯é€šè¿‡ï¼Œå®Œå…¨æ²¡æœ‰é—®é¢˜ï¼Œä½ çš„æäº¤è®°å½•å°±ä¼šè¢«æ ‡è®°ä¸Šä¸€ä¸ªç»¿è‰²çš„å¯¹å‹¾ã€‚åä¹‹ï¼Œå¦‚æœå‘½ä»¤è¿è¡Œè¿‡ç¨‹ä¸­å‡ºç°äº†å¼‚å¸¸ï¼Œåˆ™è¡¨ç¤ºéªŒè¯å¤±è´¥ï¼Œä½ çš„æäº¤è®°å½•å°±ä¼šè¢«æ ‡è®°ä¸Šä¸€ä¸ªçº¢è‰²çš„å‰ï¼Œè¿™æ—¶æˆ‘ä»¬å°±è¦ç‚¹å‡»çº¢å‹¾è¿›å…¥Travisæ„å»ºè¯¦æƒ…ï¼Œå»æŸ¥çœ‹å¤±è´¥åŸå› å¹¶å°½å¿«ä¿®å¤é—®é¢˜äº†ã€‚</p><p><img src=\"https://static001.geekbang.org/resource/image/97/90/97d9fa2c64e48ff50152c4b346372190.png?wh=768*290\" alt=\"\"></p><center><span class=\"reference\">å›¾6 ä»£ç å˜æ›´éªŒè¯</span></center><p>å¯ä»¥çœ‹åˆ°ï¼Œä¸ºä¸€ä¸ªå·¥ç¨‹å¼•å…¥è‡ªåŠ¨åŒ–ä»»åŠ¡çš„èƒ½åŠ›ï¼Œåªéœ€è¦æç‚¼å‡ºèƒ½å¤Ÿè®©å·¥ç¨‹è‡ªåŠ¨åŒ–è¿è¡Œéœ€è¦çš„å‘½ä»¤å°±å¯ä»¥äº†ã€‚</p><p>åœ¨<a href=\"https://time.geekbang.org/column/article/140079\">ç¬¬38ç¯‡æ–‡ç« </a>ä¸­ï¼Œæˆ‘ä¸ä½ ä»‹ç»äº†Flutterå·¥ç¨‹è¿è¡Œè‡ªåŠ¨åŒ–æµ‹è¯•ç”¨ä¾‹çš„å‘½ä»¤ï¼Œå³flutter testï¼Œæ‰€ä»¥å¦‚æœæˆ‘ä»¬è¦ä¸ºä¸€ä¸ªFlutterå·¥ç¨‹é…ç½®è‡ªåŠ¨åŒ–æµ‹è¯•ä»»åŠ¡ï¼Œç›´æ¥æŠŠè¿™ä¸ªå‘½ä»¤æ”¾ç½®åœ¨scriptå­—æ®µå°±å¯ä»¥äº†ã€‚</p><p>ä½†éœ€è¦æ³¨æ„çš„æ˜¯ï¼ŒTraviså¹¶æ²¡æœ‰å†…ç½®Flutterè¿è¡Œç¯å¢ƒï¼Œæ‰€ä»¥æˆ‘ä»¬è¿˜éœ€è¦åœ¨installå­—æ®µä¸­ï¼Œä¸ºè‡ªåŠ¨åŒ–ä»»åŠ¡å®‰è£…Flutter SDKã€‚ä¸‹é¢çš„ä¾‹å­æ¼”ç¤ºäº†<strong>å¦‚ä½•ä¸ºä¸€ä¸ªFlutterå·¥ç¨‹é…ç½®è‡ªåŠ¨åŒ–æµ‹è¯•èƒ½åŠ›</strong>ã€‚åœ¨ä¸‹é¢çš„é…ç½®æ–‡ä»¶ä¸­ï¼Œæˆ‘ä»¬å°†oså­—æ®µè®¾ç½®ä¸ºosxï¼Œåœ¨installå­—æ®µä¸­cloneäº†Flutter SDKï¼Œå¹¶å°†Flutterå‘½ä»¤è®¾ç½®ä¸ºç¯å¢ƒå˜é‡ã€‚æœ€åï¼Œæˆ‘ä»¬åœ¨scriptå­—æ®µä¸­åŠ ä¸Šflutter testå‘½ä»¤ï¼Œå°±å®Œæˆäº†é…ç½®å·¥ä½œï¼š</p><pre><code>os:\n  - osx\ninstall:\n  - git clone https://github.com/flutter/flutter.git\n  - export PATH=&quot;$PATH:`pwd`/flutter/bin&quot;\nscript:\n  - flutter doctor &amp;&amp; flutter test\n</code></pre><p>å…¶å®ï¼Œä¸ºFlutterå·¥ç¨‹çš„ä»£ç å˜æ›´å¼•å…¥è‡ªåŠ¨åŒ–æµ‹è¯•èƒ½åŠ›ç›¸å¯¹æ¯”è¾ƒå®¹æ˜“ï¼Œä½†è€ƒè™‘åˆ°Flutterçš„è·¨å¹³å°ç‰¹æ€§ï¼Œ<strong>è¦æƒ³åœ¨ä¸åŒå¹³å°ä¸ŠéªŒè¯å·¥ç¨‹è‡ªåŠ¨åŒ–æ„å»ºçš„èƒ½åŠ›ï¼ˆå³iOSå¹³å°æ„å»ºå‡ºipaåŒ…ã€Androidå¹³å°æ„å»ºå‡ºapkåŒ…ï¼‰åˆè¯¥å¦‚ä½•å¤„ç†å‘¢</strong>ï¼Ÿ</p><p>æˆ‘ä»¬éƒ½çŸ¥é“Flutteræ‰“åŒ…æ„å»ºçš„å‘½ä»¤æ˜¯flutter buildï¼Œæ‰€ä»¥åŒæ ·çš„ï¼Œæˆ‘ä»¬åªéœ€è¦æŠŠæ„å»ºiOSçš„å‘½ä»¤å’Œæ„å»ºAndroidçš„å‘½ä»¤æ”¾åˆ°scriptå­—æ®µé‡Œå°±å¯ä»¥äº†ã€‚ä½†è€ƒè™‘åˆ°è¿™ä¸¤æ¡æ„å»ºå‘½ä»¤æ‰§è¡Œæ—¶é—´ç›¸å¯¹è¾ƒé•¿ï¼Œæ‰€ä»¥æˆ‘ä»¬å¯ä»¥åˆ©ç”¨Travisæä¾›çš„å¹¶å‘ä»»åŠ¡é€‰é¡¹matrixï¼Œæ¥æŠŠiOSå’ŒAndroidçš„æ„å»ºæ‹†å¼€ï¼Œåˆ†åˆ«éƒ¨ç½²åœ¨ç‹¬ç«‹çš„æœºå™¨ä¸Šæ‰§è¡Œã€‚</p><p>ä¸‹é¢çš„ä¾‹å­æ¼”ç¤ºäº†å¦‚ä½•ä½¿ç”¨matrixåˆ†æ‹†æ„å»ºä»»åŠ¡ã€‚åœ¨ä¸‹é¢çš„ä»£ç ä¸­ï¼Œæˆ‘ä»¬å®šä¹‰äº†ä¸¤ä¸ªå¹¶å‘ä»»åŠ¡ï¼Œå³è¿è¡Œåœ¨Linuxä¸Šçš„Androidæ„å»ºä»»åŠ¡æ‰§è¡Œflutter build apkï¼Œå’Œè¿è¡Œåœ¨OS Xä¸Šçš„iOSæ„å»ºä»»åŠ¡flutter build iosã€‚</p><p>è€ƒè™‘åˆ°ä¸åŒå¹³å°çš„æ„å»ºä»»åŠ¡éœ€è¦æå‰å‡†å¤‡è¿è¡Œç¯å¢ƒï¼Œæ¯”å¦‚Androidæ„å»ºä»»åŠ¡éœ€è¦è®¾ç½®JDKã€å®‰è£…Android SDKå’Œæ„å»ºå·¥å…·ã€æ¥å—ç›¸åº”çš„å¼€å‘è€…åè®®ï¼Œè€ŒiOSæ„å»ºä»»åŠ¡åˆ™éœ€è¦è®¾ç½®Xcodeç‰ˆæœ¬ï¼Œå› æ­¤æˆ‘ä»¬åˆ†åˆ«åœ¨è¿™ä¸¤ä¸ªå¹¶å‘ä»»åŠ¡ä¸­æä¾›å¯¹åº”çš„é…ç½®é€‰é¡¹ã€‚</p><p>æœ€åéœ€è¦æ³¨æ„çš„æ˜¯ï¼Œç”±äºè¿™ä¸¤ä¸ªä»»åŠ¡éƒ½éœ€è¦ä¾èµ–Flutterç¯å¢ƒï¼Œæ‰€ä»¥installå­—æ®µå¹¶ä¸éœ€è¦æ‹†åˆ°å„è‡ªä»»åŠ¡ä¸­è¿›è¡Œé‡å¤è®¾ç½®ï¼š</p><pre><code>matrix:\n  include:\n    #å£°æ˜Androidè¿è¡Œç¯å¢ƒ\n    - os: linux\n      language: android\n      dist: trusty\n      licenses:\n        - 'android-sdk-preview-license-.+'\n        - 'android-sdk-license-.+'\n        - 'google-gdk-license-.+'\n      #å£°æ˜éœ€è¦å®‰è£…çš„Androidç»„ä»¶\n      android:\n        components:\n          - tools\n          - platform-tools\n          - build-tools-28.0.3\n          - android-28\n          - sys-img-armeabi-v7a-google_apis-28\n          - extra-android-m2repository\n          - extra-google-m2repository\n          - extra-google-android-support\n      jdk: oraclejdk8\n      sudo: false\n      addons:\n        apt:\n          sources:\n            - ubuntu-toolchain-r-test \n          packages:\n            - libstdc++6\n            - fonts-droid\n      #ç¡®ä¿sdkmanageræ˜¯æœ€æ–°çš„\n      before_script:\n        - yes | sdkmanager --update\n      script:\n        - yes | flutter doctor --android-licenses\n        - flutter doctor &amp;&amp; flutter -v build apk\n\n    #å£°æ˜iOSçš„è¿è¡Œç¯å¢ƒ\n    - os: osx\n      language: objective-c\n      osx_image: xcode10.2\n      script:\n        - flutter doctor &amp;&amp; flutter -v build ios --no-codesign\ninstall:\n    - git clone https://github.com/flutter/flutter.git\n    - export PATH=&quot;$PATH:`pwd`/flutter/bin&quot;\n</code></pre><h2>å¦‚ä½•å°†æ‰“åŒ…å¥½çš„äºŒè¿›åˆ¶æ–‡ä»¶è‡ªåŠ¨å‘å¸ƒå‡ºæ¥ï¼Ÿ</h2><p>åœ¨è¿™ä¸ªæ¡ˆä¾‹ä¸­ï¼Œæˆ‘ä»¬æ„å»ºä»»åŠ¡çš„å‘½ä»¤æ˜¯æ‰“åŒ…ï¼Œé‚£æ‰“åŒ…å¥½çš„äºŒè¿›åˆ¶æ–‡ä»¶å¯ä»¥è‡ªåŠ¨å‘å¸ƒå‡ºæ¥å—ï¼Ÿ</p><p>ç­”æ¡ˆæ˜¯è‚¯å®šçš„ã€‚æˆ‘ä»¬åªéœ€è¦ä¸ºè¿™ä¸¤ä¸ªæ„å»ºä»»åŠ¡å¢åŠ deployå­—æ®µï¼Œè®¾ç½®skip_cleanupå­—æ®µå‘Šè¯‰Travisåœ¨æ„å»ºå®Œæˆåä¸è¦æ¸…é™¤ç¼–è¯‘äº§ç‰©ï¼Œç„¶åé€šè¿‡fileå­—æ®µæŠŠè¦å‘å¸ƒçš„æ–‡ä»¶æŒ‡å®šå‡ºæ¥ï¼Œæœ€åå°±å¯ä»¥é€šè¿‡GitHubæä¾›çš„API tokenä¸Šä¼ åˆ°é¡¹ç›®ä¸»é¡µäº†ã€‚</p><p>ä¸‹é¢çš„ç¤ºä¾‹æ¼”ç¤ºäº†deployå­—æ®µçš„å…·ä½“ç”¨æ³•ï¼Œåœ¨ä¸‹é¢çš„ä»£ç ä¸­ï¼Œæˆ‘ä»¬è·å–åˆ°äº†scriptå­—æ®µæ„å»ºå‡ºçš„app-release.apkï¼Œå¹¶é€šè¿‡fileå­—æ®µå°†å…¶æŒ‡å®šä¸ºå¾…å‘å¸ƒçš„æ–‡ä»¶ã€‚è€ƒè™‘åˆ°å¹¶ä¸æ˜¯æ¯æ¬¡æ„å»ºéƒ½éœ€è¦è‡ªåŠ¨å‘å¸ƒï¼Œæ‰€ä»¥æˆ‘ä»¬åœ¨ä¸‹é¢çš„é…ç½®ä¸­ï¼Œå¢åŠ äº†oné€‰é¡¹ï¼Œå‘Šè¯‰Travisä»…åœ¨å¯¹åº”çš„ä»£ç æ›´æ–°æœ‰å…³è”tagæ—¶ï¼Œæ‰è‡ªåŠ¨å‘å¸ƒä¸€ä¸ªreleaseç‰ˆæœ¬ï¼š</p><pre><code>...\n#å£°æ˜æ„å»ºéœ€è¦æ‰§è¡Œçš„å‘½ä»¤\nscript:\n  - yes | flutter doctor --android-licenses\n  - flutter doctor &amp;&amp; flutter -v build apk\n#å£°æ˜éƒ¨ç½²çš„ç­–ç•¥ï¼Œå³ä¸Šä¼ apkè‡³github release\ndeploy:\n  provider: releases\n  api_key: xxxxx\n  file:\n    - build/app/outputs/apk/release/app-release.apk\n  skip_cleanup: true\n  on:\n    tags: true\n...\n</code></pre><p>éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œç”±äºæˆ‘ä»¬çš„é¡¹ç›®æ˜¯å¼€æºåº“ï¼Œå› æ­¤GitHubçš„API tokenä¸èƒ½æ˜æ–‡æ”¾åˆ°é…ç½®æ–‡ä»¶ä¸­ï¼Œéœ€è¦åœ¨Travisä¸Šé…ç½®ä¸€ä¸ªAPI tokençš„ç¯å¢ƒå˜é‡ï¼Œç„¶åæŠŠè¿™ä¸ªç¯å¢ƒå˜é‡è®¾ç½®åˆ°é…ç½®æ–‡ä»¶ä¸­ã€‚</p><p>æˆ‘ä»¬å…ˆæ‰“å¼€GitHubï¼Œç‚¹å‡»é¡µé¢å³ä¸Šè§’çš„ä¸ªäººå¤´åƒè¿›å…¥Settingsï¼Œéšåç‚¹å‡»Developer Settingsè¿›å…¥å¼€å‘è€…è®¾ç½®ã€‚</p><p><img src=\"https://static001.geekbang.org/resource/image/c1/87/c15f24234d621e6c1c1fa5f096acc587.png?wh=2004*1262\" alt=\"\"></p><center><span class=\"reference\">å›¾7 è¿›å…¥å¼€å‘è€…è®¾ç½®</span></center><p>åœ¨å¼€å‘è€…è®¾ç½®é¡µé¢ä¸­ï¼Œæˆ‘ä»¬ç‚¹å‡»å·¦ä¸‹è§’çš„Personal access tokensé€‰é¡¹ï¼Œç”Ÿæˆè®¿é—®tokenã€‚tokenè®¾ç½®é¡µé¢æä¾›äº†æ¯”è¾ƒä¸°å¯Œçš„è®¿é—®æƒé™æ§åˆ¶ï¼Œæ¯”å¦‚ä»“åº“é™åˆ¶ã€ç”¨æˆ·é™åˆ¶ã€è¯»å†™é™åˆ¶ç­‰ï¼Œè¿™é‡Œæˆ‘ä»¬é€‰æ‹©åªè®¿é—®å…¬å…±çš„ä»“åº“ï¼Œå¡«å¥½tokenåç§°cd_demoï¼Œç‚¹å‡»ç¡®è®¤ä¹‹åï¼ŒGitHubä¼šå°†tokençš„å†…å®¹å±•ç¤ºåœ¨é¡µé¢ä¸Šã€‚</p><p><img src=\"https://static001.geekbang.org/resource/image/1c/71/1c7ac4bd801f44f3940eff855b9e2171.png?wh=1600*904\" alt=\"\"></p><center><span class=\"reference\">å›¾8 ç”Ÿæˆè®¿é—®token</span></center><p>éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œè¿™ä¸ªtoken ä½ åªä¼šåœ¨GitHubä¸Šçœ‹åˆ°ä¸€æ¬¡ï¼Œé¡µé¢å…³äº†å°±å†ä¹Ÿæ‰¾ä¸åˆ°äº†ï¼Œæ‰€ä»¥æˆ‘ä»¬å…ˆæŠŠè¿™ä¸ªtokenå¤åˆ¶ä¸‹æ¥ã€‚</p><p><img src=\"https://static001.geekbang.org/resource/image/8e/ca/8ef0ba439f181596f516ec814d80c5ca.png?wh=1508*682\" alt=\"\"></p><center><span class=\"reference\">å›¾9 è®¿é—®tokenç•Œé¢</span></center><p>æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬æ‰“å¼€Travisä¸»é¡µï¼Œæ‰¾åˆ°æˆ‘ä»¬å¸Œæœ›é…ç½®è‡ªåŠ¨å‘å¸ƒçš„é¡¹ç›®ï¼Œç„¶åç‚¹å‡»å³ä¸Šè§’çš„More optionsé€‰æ‹©Settingsæ‰“å¼€é¡¹ç›®é…ç½®é¡µé¢ã€‚</p><p><img src=\"https://static001.geekbang.org/resource/image/4d/94/4d34efe29bb2135751f5aba3ffdc4694.png?wh=1746*656\" alt=\"\"></p><center><span class=\"reference\">å›¾10 æ‰“å¼€Travisé¡¹ç›®è®¾ç½®</span></center><p>åœ¨Environment Variableé‡Œï¼ŒæŠŠåˆšåˆšå¤åˆ¶çš„tokenæ”¹åä¸ºGITHUB_TOKENï¼ŒåŠ åˆ°ç¯å¢ƒå˜é‡å³å¯ã€‚</p><p><img src=\"https://static001.geekbang.org/resource/image/67/c7/67826feaefba3105368387e1cfefd5c7.png?wh=1678*236\" alt=\"\"></p><center><span class=\"reference\">å›¾11 åŠ å…¥Travisç¯å¢ƒå˜é‡</span></center><p>æœ€åï¼Œæˆ‘ä»¬åªè¦æŠŠé…ç½®æ–‡ä»¶ä¸­çš„api_keyæ›¿æ¢æˆ${GITHUB_TOKEN}å°±å¯ä»¥äº†ã€‚</p><pre><code>...\ndeploy:\n  api_key: ${GITHUB_TOKEN}\n...\n</code></pre><p>è¿™ä¸ªæ¡ˆä¾‹ä»‹ç»çš„æ˜¯Androidçš„æ„å»ºäº§ç‰©apkå‘å¸ƒã€‚è€Œå¯¹äºiOSè€Œè¨€ï¼Œæˆ‘ä»¬è¿˜éœ€è¦å¯¹å…¶æ„å»ºäº§ç‰©appç¨ä½œåŠ å·¥ï¼Œè®©å…¶å˜æˆæ›´é€šç”¨çš„ipaæ ¼å¼ä¹‹åæ‰èƒ½å‘å¸ƒã€‚è¿™é‡Œæˆ‘ä»¬å°±éœ€è¦ç”¨åˆ°deployçš„é’©å­before_deployå­—æ®µäº†ï¼Œè¿™ä¸ªå­—æ®µèƒ½å¤Ÿåœ¨æ­£å¼å‘å¸ƒå‰ï¼Œæ‰§è¡Œä¸€äº›ç‰¹å®šçš„äº§ç‰©åŠ å·¥å·¥ä½œã€‚</p><p>ä¸‹é¢çš„ä¾‹å­æ¼”ç¤ºäº†<strong>å¦‚ä½•é€šè¿‡before_deployå­—æ®µåŠ å·¥æ„å»ºäº§ç‰©</strong>ã€‚ç”±äºipaæ ¼å¼æ˜¯åœ¨appæ ¼å¼ä¹‹ä¸Šåšçš„ä¸€å±‚åŒ…è£…ï¼Œæ‰€ä»¥æˆ‘ä»¬æŠŠappæ–‡ä»¶æ‹·è´åˆ°Payloadåå†åšå‹ç¼©ï¼Œå°±å®Œæˆäº†å‘å¸ƒå‰çš„å‡†å¤‡å·¥ä½œï¼Œæ¥ä¸‹æ¥å°±å¯ä»¥åœ¨deployé˜¶æ®µæŒ‡å®šè¦å‘å¸ƒçš„æ–‡ä»¶ï¼Œæ­£å¼è¿›å…¥å‘å¸ƒç¯èŠ‚äº†ï¼š</p><pre><code>...\n#å¯¹å‘å¸ƒå‰çš„æ„å»ºäº§ç‰©è¿›è¡Œé¢„å¤„ç†ï¼Œæ‰“åŒ…æˆipa\nbefore_deploy:\n  - mkdir app &amp;&amp; mkdir app/Payload\n  - cp -r build/ios/iphoneos/Runner.app app/Payload\n  - pushd app &amp;&amp; zip -r -m app.ipa Payload  &amp;&amp; popd\n#å°†ipaä¸Šä¼ è‡³github release\ndeploy:\n  provider: releases\n  api_key: ${GITHUB_TOKEN}\n  file:\n    - app/app.ipa\n  skip_cleanup: true\n  on:\n    tags: true\n...\n</code></pre><p>å°†æ›´æ–°åçš„é…ç½®æ–‡ä»¶æäº¤è‡³GitHubï¼Œéšåæ‰“ä¸€ä¸ªtagã€‚ç­‰å¾…Travisæ„å»ºå®Œæ¯•åå¯ä»¥çœ‹åˆ°ï¼Œæˆ‘ä»¬çš„å·¥ç¨‹å·²ç»å…·å¤‡è‡ªåŠ¨å‘å¸ƒæ„å»ºäº§ç‰©çš„èƒ½åŠ›äº†ã€‚</p><p><img src=\"https://static001.geekbang.org/resource/image/36/25/362ff95d6f289e75bb238a06daf88d25.png?wh=1048*1158\" alt=\"\"></p><center><span class=\"reference\">å›¾12 Flutter Appå‘å¸ƒæ„å»ºäº§ç‰©</span></center><h2>å¦‚ä½•ä¸ºFlutter Moduleå·¥ç¨‹å¼•å…¥è‡ªåŠ¨å‘å¸ƒèƒ½åŠ›ï¼Ÿ</h2><p>è¿™ä¸ªä¾‹å­ä»‹ç»çš„æ˜¯ä¼ ç»Ÿçš„Flutter Appå·¥ç¨‹ï¼ˆå³çº¯Flutterå·¥ç¨‹ï¼‰ï¼Œ<strong>å¦‚æœæˆ‘ä»¬æƒ³ä¸ºFlutter Moduleå·¥ç¨‹ï¼ˆå³æ··åˆå¼€å‘çš„Flutterå·¥ç¨‹ï¼‰å¼•å…¥è‡ªåŠ¨å‘å¸ƒèƒ½åŠ›åˆè¯¥å¦‚ä½•è®¾ç½®å‘¢ï¼Ÿ</strong></p><p>å…¶å®ä¹Ÿå¹¶ä¸å¤æ‚ã€‚Moduleå·¥ç¨‹çš„Androidæ„å»ºäº§ç‰©æ˜¯aarï¼ŒiOSæ„å»ºäº§ç‰©æ˜¯Frameworkã€‚Androidäº§ç‰©çš„è‡ªåŠ¨å‘å¸ƒæ¯”è¾ƒç®€å•ï¼Œæˆ‘ä»¬ç›´æ¥å¤ç”¨apkçš„å‘å¸ƒï¼ŒæŠŠfileæ–‡ä»¶æŒ‡å®šä¸ºaaræ–‡ä»¶å³å¯ï¼›iOSçš„äº§ç‰©è‡ªåŠ¨å‘å¸ƒç¨ç¹çä¸€äº›ï¼Œéœ€è¦å°†Frameworkåšä¸€äº›ç®€å•çš„åŠ å·¥ï¼Œå°†å®ƒä»¬è½¬æ¢æˆPodæ ¼å¼ã€‚</p><p>ä¸‹é¢çš„ä¾‹å­æ¼”ç¤ºäº†Flutter Moduleçš„iOSäº§ç‰©æ˜¯å¦‚ä½•å®ç°è‡ªåŠ¨å‘å¸ƒçš„ã€‚ç”±äºPodæ ¼å¼æœ¬èº«åªæ˜¯åœ¨App.Frameworkå’ŒFlutter.Frameworkè¿™ä¸¤ä¸ªæ–‡ä»¶çš„åŸºç¡€ä¸Šåšçš„å°è£…ï¼Œæ‰€ä»¥æˆ‘ä»¬åªéœ€è¦æŠŠå®ƒä»¬æ‹·è´åˆ°ç»Ÿä¸€çš„ç›®å½•FlutterEngineä¸‹ï¼Œå¹¶å°†å£°æ˜äº†ç»„ä»¶å®šä¹‰çš„FlutterEngine.podspecæ–‡ä»¶æ”¾ç½®åœ¨æœ€å¤–å±‚ï¼Œæœ€åç»Ÿä¸€å‹ç¼©æˆzipæ ¼å¼å³å¯ã€‚</p><pre><code>...\n#å¯¹æ„å»ºäº§ç‰©è¿›è¡Œé¢„å¤„ç†ï¼Œå‹ç¼©æˆzipæ ¼å¼çš„ç»„ä»¶\nbefore_deploy:\n  - mkdir .ios/Outputs &amp;&amp; mkdir .ios/Outputs/FlutterEngine\n  - cp FlutterEngine.podspec .ios/Outputs/\n  - cp -r .ios/Flutter/App.framework/ .ios/Outputs/FlutterEngine/App.framework/\n  - cp -r .ios/Flutter/engine/Flutter.framework/ .ios/Outputs/FlutterEngine/Flutter.framework/\n  - pushd .ios/Outputs &amp;&amp; zip -r FlutterEngine.zip  ./ &amp;&amp; popd\ndeploy:\n  provider: releases\n  api_key: ${GITHUB_TOKEN}\n  file:\n    - .ios/Outputs/FlutterEngine.zip\n  skip_cleanup: true\n  on:\n    tags: true\n...\n</code></pre><p>å°†è¿™æ®µä»£ç æäº¤åå¯ä»¥çœ‹åˆ°ï¼ŒFlutter Moduleå·¥ç¨‹ä¹Ÿå¯ä»¥è‡ªåŠ¨çš„å‘å¸ƒåŸç”Ÿç»„ä»¶äº†ã€‚</p><p><img src=\"https://static001.geekbang.org/resource/image/80/0d/808aa463cec67002b26ad47a745f8a0d.png?wh=990*1140\" alt=\"\"></p><center><span class=\"reference\">å›¾13 Flutter Moduleå·¥ç¨‹å‘å¸ƒæ„å»ºäº§ç‰©</span></center><p>é€šè¿‡è¿™äº›ä¾‹å­æˆ‘ä»¬å¯ä»¥çœ‹åˆ°ï¼Œ<strong>ä»»åŠ¡é…ç½®çš„å…³é”®åœ¨äºæç‚¼å‡ºé¡¹ç›®è‡ªåŠ¨åŒ–è¿è¡Œéœ€è¦çš„å‘½ä»¤é›†åˆï¼Œå¹¶ç¡®è®¤å®ƒä»¬çš„æ‰§è¡Œé¡ºåºã€‚</strong>åªè¦æŠŠè¿™äº›å‘½ä»¤é›†åˆæŒ‰ç…§installã€scriptå’Œdeployä¸‰ä¸ªé˜¶æ®µå®‰ç½®å¥½ï¼Œæ¥ä¸‹æ¥çš„äº‹æƒ…å°±äº¤ç»™Traviså»å®Œæˆï¼Œæˆ‘ä»¬å®‰å¿ƒäº«å—æŒç»­äº¤ä»˜å¸¦æ¥çš„ä¾¿åˆ©å°±å¯ä»¥äº†ã€‚</p><h2>æ€»ç»“</h2><p>ä¿—è¯è¯´ï¼Œâ€œ90%çš„æ•…éšœéƒ½æ˜¯ç”±å˜æ›´å¼•èµ·çš„â€ï¼Œè¿™å‡¸æ˜¾äº†æŒç»­äº¤ä»˜å¯¹äºå‘å¸ƒç¨³å®šæ€§ä¿éšœçš„ä»·å€¼ã€‚é€šè¿‡å»ºç«‹æŒç»­äº¤ä»˜æµç¨‹é“¾æœºåˆ¶ï¼Œæˆ‘ä»¬å¯ä»¥å°†ä»£ç å˜æ›´ä¸è‡ªåŠ¨åŒ–æ‰‹æ®µå…³è”èµ·æ¥ï¼Œè®©æµ‹è¯•å’Œå‘å¸ƒå˜å¾—æ›´å¿«ã€æ›´é¢‘ç¹ï¼Œä¸ä»…å¯ä»¥ææ—©æš´éœ²é£é™©ï¼Œè¿˜èƒ½è®©è½¯ä»¶å¯ä»¥æŒç»­ç¨³å®šåœ°ä¿æŒåœ¨éšæ—¶å¯å‘å¸ƒçš„çŠ¶æ€ã€‚</p><p>åœ¨ä»Šå¤©çš„åˆ†äº«ä¸­ï¼Œæˆ‘ä¸ä½ ä»‹ç»äº†å¦‚ä½•é€šè¿‡Travis CIï¼Œä¸ºæˆ‘ä»¬çš„é¡¹ç›®å¼•å…¥æŒç»­äº¤ä»˜èƒ½åŠ›ã€‚Travisçš„è‡ªåŠ¨åŒ–ä»»åŠ¡çš„å·¥ä½œæµä¾é .travis.ymlé…ç½®æ–‡ä»¶é©±åŠ¨ï¼Œæˆ‘ä»¬å¯ä»¥åœ¨ç¡®è®¤å¥½æ„å»ºä»»åŠ¡éœ€è¦çš„å‘½ä»¤é›†åˆåï¼Œåœ¨è¿™ä¸ªé…ç½®æ–‡ä»¶ä¸­ä¾ç…§installã€scriptå’Œdeployè¿™3ä¸ªæ­¥éª¤æ‹†è§£æ‰§è¡Œè¿‡ç¨‹ã€‚å®Œæˆé¡¹ç›®çš„é…ç½®ä¹‹åï¼Œä¸€æ—¦Travisæ£€æµ‹åˆ°ä»£ç å˜æ›´ï¼Œå°±å¯ä»¥è‡ªåŠ¨æ‰§è¡Œä»»åŠ¡äº†ã€‚</p><p>ç®€å•æ¸…æ™°çš„å‘å¸ƒæµç¨‹æ˜¯è½¯ä»¶å¯é æ€§çš„å‰æã€‚å¦‚æœæˆ‘ä»¬åŒæ—¶å‘å¸ƒäº†100ä¸ªä»£ç å˜æ›´ï¼Œå¯¼è‡´Appæ€§èƒ½æ¶åŒ–äº†ï¼Œæˆ‘ä»¬å¯èƒ½éœ€è¦èŠ±è´¹å¤§é‡æ—¶é—´å’Œç²¾åŠ›ï¼Œå»å®šä½ç©¶ç«Ÿæ˜¯å“ªäº›å˜æ›´å½±å“äº†Appæ€§èƒ½ï¼Œä»¥åŠå®ƒä»¬æ˜¯å¦‚ä½•å½±å“çš„ã€‚è€Œå¦‚æœä»¥æŒç»­äº¤ä»˜çš„æ–¹å¼å‘å¸ƒAppï¼Œæˆ‘ä»¬èƒ½å¤Ÿä»¥æ›´å°çš„ç²’åº¦å»æµ‹é‡å’Œç†è§£ä»£ç å˜æ›´å¸¦æ¥çš„å½±å“ï¼Œæ˜¯æ”¹å–„è¿˜æ˜¯é€€åŒ–ï¼Œä»è€Œå¯ä»¥æ›´æ—©åœ°æ‰¾åˆ°é—®é¢˜ï¼Œæ›´æœ‰ä¿¡å¿ƒè¿›è¡Œæ›´å¿«çš„å‘å¸ƒã€‚</p><p><strong>éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œ</strong>åœ¨ä»Šå¤©çš„ç¤ºä¾‹åˆ†æä¸­ï¼Œæˆ‘ä»¬æ„å»ºçš„æ˜¯ä¸€ä¸ªæœªç­¾åçš„ipaæ–‡ä»¶ï¼Œè¿™æ„å‘³ç€æˆ‘ä»¬éœ€è¦å…ˆå®Œæˆç­¾åä¹‹åï¼Œæ‰èƒ½åœ¨çœŸå®çš„iOSè®¾å¤‡ä¸Šè¿è¡Œï¼Œæˆ–è€…å‘å¸ƒåˆ°App Storeã€‚</p><p>iOSçš„ä»£ç ç­¾åæ¶‰åŠç§é’¥å’Œå¤šé‡è¯ä¹¦çš„æ ¡éªŒï¼Œä»¥åŠå¯¹åº”çš„åŠ è§£å¯†æ­¥éª¤ï¼Œæ˜¯ä¸€ä¸ªç›¸å¯¹ç¹ççš„è¿‡ç¨‹ã€‚å¦‚æœæˆ‘ä»¬å¸Œæœ›åœ¨Travisä¸Šéƒ¨ç½²è‡ªåŠ¨åŒ–ç­¾åæ“ä½œï¼Œéœ€è¦å¯¼å‡ºå‘å¸ƒè¯ä¹¦ã€ç§é’¥å’Œæè¿°æ–‡ä»¶ï¼Œå¹¶æå‰å°†è¿™äº›æ–‡ä»¶æ‰“åŒ…æˆä¸€ä¸ªå‹ç¼©åŒ…åè¿›è¡ŒåŠ å¯†ï¼Œä¸Šä¼ è‡³ä»“åº“ã€‚</p><p>ç„¶åï¼Œæˆ‘ä»¬è¿˜éœ€è¦åœ¨before_installæ—¶ï¼Œå°†è¿™ä¸ªå‹ç¼©åŒ…è¿›è¡Œè§£å¯†ï¼Œå¹¶æŠŠè¯ä¹¦å¯¼åˆ°Travisè¿è¡Œç¯å¢ƒçš„é’¥åŒ™ä¸²ä¸­ï¼Œè¿™æ ·æ„å»ºè„šæœ¬å°±å¯ä»¥ä½¿ç”¨ä¸´æ—¶é’¥åŒ™ä¸²å¯¹äºŒè¿›åˆ¶æ–‡ä»¶è¿›è¡Œç­¾åäº†ã€‚å®Œæ•´çš„é…ç½®ï¼Œä½ å¯ä»¥å‚è€ƒæ‰‹æœºå†…ä¾§æœåŠ¡å‚å•†è’²å…¬è‹±æä¾›çš„<a href=\"https://www.pgyer.com/doc/view/travis_ios\">é›†æˆæ–‡æ¡£</a>äº†è§£è¿›ä¸€æ­¥çš„ç»†èŠ‚ã€‚</p><p>å¦‚æœä½ ä¸å¸Œæœ›å°†å‘å¸ƒè¯ä¹¦ã€ç§é’¥æš´éœ²ç»™Travisï¼Œä¹Ÿå¯ä»¥æŠŠæœªç­¾åçš„ipaåŒ…ä¸‹è½½ä¸‹æ¥ï¼Œè§£å‹åé€šè¿‡codesignå‘½ä»¤ï¼Œåˆ†åˆ«å¯¹App.Frameworkã€Flutter.Frameworkä»¥åŠRunnerè¿›è¡Œé‡ç­¾åæ“ä½œï¼Œç„¶åé‡æ–°å‹ç¼©æˆipaåŒ…å³å¯ã€‚<a href=\"https://www.yangshebing.com/2018/01/06/iOS%E9%80%86%E5%90%91%E5%BF%85%E5%A4%87%E7%BB%9D%E6%8A%80%E4%B9%8Bipa%E9%87%8D%E7%AD%BE%E5%90%8D/\">è¿™ç¯‡æ–‡ç« </a>ä»‹ç»äº†è¯¦ç»†çš„æ“ä½œæ­¥éª¤ï¼Œè¿™é‡Œæˆ‘ä»¬ä¹Ÿä¸å†èµ˜è¿°äº†ã€‚</p><p>æˆ‘æŠŠä»Šå¤©åˆ†äº«æ¶‰åŠçš„Travisé…ç½®ä¸Šä¼ åˆ°äº†GitHubï¼Œä½ å¯ä»¥æŠŠè¿™å‡ ä¸ªé¡¹ç›®<a href=\"https://github.com/cyndibaby905/08_Dart_Sample\">Dart_Sample</a>ã€<a href=\"https://github.com/cyndibaby905/28_module_page\">Module_Page</a>ã€<a href=\"https://github.com/cyndibaby905/39_crashy_demo\">Crashy_Demo</a>ä¸‹è½½ä¸‹æ¥ï¼Œè§‚å¯Ÿå®ƒä»¬çš„é…ç½®æ–‡ä»¶ï¼Œå¹¶åœ¨Travisç½‘ç«™ä¸ŠæŸ¥çœ‹å¯¹åº”çš„æ„å»ºè¿‡ç¨‹ï¼Œä»è€ŒåŠ æ·±ç†è§£ä¸è®°å¿†ã€‚</p><h2>æ€è€ƒé¢˜</h2><p>æœ€åï¼Œæˆ‘ç»™ä½ ç•™ä¸€é“æ€è€ƒé¢˜å§ã€‚</p><p>åœ¨Travisé…ç½®æ–‡ä»¶ä¸­ï¼Œå¦‚ä½•é€‰ç”¨ç‰¹å®šçš„Flutter SDKç‰ˆæœ¬ï¼ˆæ¯”å¦‚v1.5.4-hotfix.2ï¼‰å‘¢ï¼Ÿ</p><p>æ¬¢è¿ä½ åœ¨è¯„è®ºåŒºç»™æˆ‘ç•™è¨€åˆ†äº«ä½ çš„è§‚ç‚¹ï¼Œæˆ‘ä¼šåœ¨ä¸‹ä¸€ç¯‡æ–‡ç« ä¸­ç­‰å¾…ä½ ï¼æ„Ÿè°¢ä½ çš„æ”¶å¬ï¼Œä¹Ÿæ¬¢è¿ä½ æŠŠè¿™ç¯‡æ–‡ç« åˆ†äº«ç»™æ›´å¤šçš„æœ‹å‹ä¸€èµ·é˜…è¯»ã€‚</p><p></p>","comments":[{"had_liked":false,"id":138124,"user_name":"å¤§åœŸè±†","can_delete":false,"product_type":"c1","uid":1121636,"ip_address":"","ucode":"67445DC3EC9DB0","user_header":"https://static001.geekbang.org/account/avatar/00/11/1d/64/52a5863b.jpg","comment_is_top":false,"comment_ctime":1570035746,"is_pvip":true,"replies":[{"id":"53517","content":"è¦ææŒç»­äº¤ä»˜ï¼Œæœ€é‡è¦çš„å°±æ˜¯æŠ½è±¡å‡ºä»»åŠ¡å¯é‡å¤ã€å¯ç‹¬ç«‹è¿è¡Œçš„å…³é”®å‘½ä»¤è¡Œï¼Œå¹¶ç»„ç»‡æˆæ‰§è¡Œä»»åŠ¡ã€‚å‰©ä¸‹çš„æ— éå°±æ˜¯é…ç½®å‘½ä»¤è¡Œä»»åŠ¡çš„è¿è¡Œç¯å¢ƒã€åŠ å·¥è¿è¡Œäº§ç‰©ï¼ˆè¿™äº›æ­¥éª¤åˆå¯ä»¥æç‚¼å‡ºå‘½ä»¤è¡Œï¼‰ï¼Œå¹¶æŠŠä»£ç å˜æ›´ä¸å‘½ä»¤è¡Œä»»åŠ¡é€šè¿‡é’©å­å…³è”èµ·æ¥ã€‚è€Œè‡³äºè¿™äº›å‘½ä»¤è¡Œä»»åŠ¡çš„æ‰§è¡Œå®¹å™¨ï¼Œåˆ°åº•æ˜¯ä½¿ç”¨Travisè¿˜æ˜¯Jenkinsï¼Œå¹¶æ²¡æœ‰é‚£ä¹ˆé‡è¦äº†ã€‚<br>","user_name":"ä½œè€…å›å¤","user_name_real":"åœŸè±†ç›’å­","uid":"1088582","ctime":1570517422,"ip_address":"","comment_id":138124,"utype":1}],"discussion_count":3,"race_medal":0,"score":"18749904930","product_id":100031001,"comment_content":"è§„æ¨¡æœ€å¤§ï¼Œå¤§å®¶æœ€ç†Ÿæ‚‰çš„åº”è¯¥æ˜¯jenkinså§ğŸ˜„","like_count":5,"discussions":[{"author":{"id":1088582,"avatar":"https://static001.geekbang.org/account/avatar/00/10/9c/46/0b29b188.jpg","nickname":"åœŸè±†ç›’å­","note":"","ucode":"A910F88CAC0A87","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":469396,"discussion_content":"è¦ææŒç»­äº¤ä»˜ï¼Œæœ€é‡è¦çš„å°±æ˜¯æŠ½è±¡å‡ºä»»åŠ¡å¯é‡å¤ã€å¯ç‹¬ç«‹è¿è¡Œçš„å…³é”®å‘½ä»¤è¡Œï¼Œå¹¶ç»„ç»‡æˆæ‰§è¡Œä»»åŠ¡ã€‚å‰©ä¸‹çš„æ— éå°±æ˜¯é…ç½®å‘½ä»¤è¡Œä»»åŠ¡çš„è¿è¡Œç¯å¢ƒã€åŠ å·¥è¿è¡Œäº§ç‰©ï¼ˆè¿™äº›æ­¥éª¤åˆå¯ä»¥æç‚¼å‡ºå‘½ä»¤è¡Œï¼‰ï¼Œå¹¶æŠŠä»£ç å˜æ›´ä¸å‘½ä»¤è¡Œä»»åŠ¡é€šè¿‡é’©å­å…³è”èµ·æ¥ã€‚è€Œè‡³äºè¿™äº›å‘½ä»¤è¡Œä»»åŠ¡çš„æ‰§è¡Œå®¹å™¨ï¼Œåˆ°åº•æ˜¯ä½¿ç”¨Travisè¿˜æ˜¯Jenkinsï¼Œå¹¶æ²¡æœ‰é‚£ä¹ˆé‡è¦äº†ã€‚\n","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1570517422,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1023750,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/9f/06/287d77dd.jpg","nickname":"æ‰¿é¦™å¢¨å½±","note":"","ucode":"4D6A4D6E1ED29F","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":24241,"discussion_content":"è€Œä¸” Travis CI æœ‰ä¸ªé—®é¢˜åªèƒ½æ”¯æŒ Githubã€‚å†™è¿™ä¸€ç« ï¼Œå¤§æ¦‚æ˜¯ä¸“æ éœ€è¦ã€Œè‡ªåŠ¨æ‰“åŒ…ã€çš„å†…å®¹ï¼Œä»‹ç» Travis CI ä¸»è¦æ˜¯å› ä¸ºä½¿ç”¨å’Œé…ç½®ç®€å•ï¼Œæ¢æˆ jenkins æ— ç–‘å¯¹æ–‡ç« çš„å†…å®¹ä¸Šçš„è¦æ±‚è¦å¤æ‚å¾ˆå¤šã€‚","likes_number":1,"is_delete":false,"is_hidden":false,"ctime":1570068882,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1170708,"avatar":"https://static001.geekbang.org/account/avatar/00/11/dd/14/81c32e42.jpg","nickname":"szmichael","note":"","ucode":"632BF8E7821B36","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":25232,"discussion_content":"ä¸èƒ½è‡ªè¡Œéƒ¨ç½²æ‰“åŒ…ç¯å¢ƒï¼Ÿ","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1570459213,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":283770,"user_name":"bentley","can_delete":false,"product_type":"c1","uid":1019843,"ip_address":"","ucode":"D03483C6578D40","user_header":"https://static001.geekbang.org/account/avatar/00/0f/8f/c3/eb150080.jpg","comment_is_top":false,"comment_ctime":1615910483,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"5910877779","product_id":100031001,"comment_content":"è€å¸ˆèƒ½å‡ºä¸ªJenkinsçš„æ•™ç¨‹å—ï¼Ÿ","like_count":2},{"had_liked":false,"id":138901,"user_name":"Geek_a9f943","can_delete":false,"product_type":"c1","uid":1595468,"ip_address":"","ucode":"2F231425A03298","user_header":"","comment_is_top":false,"comment_ctime":1570501895,"is_pvip":false,"replies":[{"id":"53499","content":"å¯ä»¥ï¼Œå‚è€ƒä¸‹ç¬¬44ç¯‡åˆ†äº«","user_name":"ä½œè€…å›å¤","user_name_real":"åœŸè±†ç›’å­","uid":"1088582","ctime":1570505207,"ip_address":"","comment_id":138901,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1570501895","product_id":100031001,"comment_content":"Travisæ„å»ºçš„äº§ç‰©èƒ½å°†flutterä¸­çš„ç¬¬ä¸‰æ–¹ä¾èµ–ä¹Ÿä¸€èµ·æ„å»ºå‡ºæ¥å˜›ï¼Ÿ","like_count":0,"discussions":[{"author":{"id":1088582,"avatar":"https://static001.geekbang.org/account/avatar/00/10/9c/46/0b29b188.jpg","nickname":"åœŸè±†ç›’å­","note":"","ucode":"A910F88CAC0A87","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":469690,"discussion_content":"å¯ä»¥ï¼Œå‚è€ƒä¸‹ç¬¬44ç¯‡åˆ†äº«","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1570505207,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":138236,"user_name":"Carlo","can_delete":false,"product_type":"c1","uid":1001557,"ip_address":"","ucode":"7C3FF23B597506","user_header":"https://static001.geekbang.org/account/avatar/00/0f/48/55/48de9a24.jpg","comment_is_top":false,"comment_ctime":1570110749,"is_pvip":false,"replies":[{"id":"53523","content":"1ã€é™¤éä½ æ˜¯ç¡¬ä»¶å±æ€§æå¼ºçš„Appï¼Œä¸€èˆ¬æ²¡å•¥é—®é¢˜ï¼Œæ­£å¸¸Appæ‰€éœ€è¦çš„æ’ä»¶Pubä¸Šéƒ½æœ‰ã€‚<br>2ã€crashlyticä¸ŠæŠ¥çš„ä¸æ˜¯å´©æºƒä¿¡æ¯ï¼Œæ˜¯å¼‚å¸¸ä¿¡æ¯ï¼Œè¿™äº›ä¿¡æ¯å½“ç„¶æœ‰ç”¨å•Šï¼Œä¸€èˆ¬æ˜¯ä½ çš„Appå‡ºç°äº†æ§ä»¶å¼‚å¸¸ï¼Œå¦‚æœå †æ ˆé‡Œæ²¡æœ‰ä½ è‡ªå·±çš„æ–¹æ³•ï¼Œå¯ä»¥å¢åŠ å½“å‰é¡µé¢ä¸Šä¸‹æ–‡ï¼Œç”¨äºŒåˆ†æ³•æ’æŸ¥ä¸€ä¸‹","user_name":"ä½œè€…å›å¤","user_name_real":"åœŸè±†ç›’å­","uid":"1088582","ctime":1570518963,"ip_address":"","comment_id":138236,"utype":1}],"discussion_count":3,"race_medal":0,"score":"1570110749","product_id":100031001,"comment_content":"è¯·é—®ç°åœ¨æŠŠflutterç”¨åœ¨ç”Ÿäº§ç¯å¢ƒæœ€å¤§çš„é—®é¢˜æ˜¯ä»€ä¹ˆå‘¢ï¼Ÿ(æ²¡æœ‰è¶³å¤Ÿçš„plugin?æ¯”å¦‚facebook login)(æ²¡æœ‰å¥½çš„crashæŠ¥å‘Šç³»ç»Ÿï¼Ÿæ¯”å¦‚crashlyticsçš„å´©æºƒä¿¡æ¯åŸºæœ¬æ²¡ä»€ä¹ˆç”¨)","like_count":0,"discussions":[{"author":{"id":1088582,"avatar":"https://static001.geekbang.org/account/avatar/00/10/9c/46/0b29b188.jpg","nickname":"åœŸè±†ç›’å­","note":"","ucode":"A910F88CAC0A87","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":469449,"discussion_content":"1ã€é™¤éä½ æ˜¯ç¡¬ä»¶å±æ€§æå¼ºçš„Appï¼Œä¸€èˆ¬æ²¡å•¥é—®é¢˜ï¼Œæ­£å¸¸Appæ‰€éœ€è¦çš„æ’ä»¶Pubä¸Šéƒ½æœ‰ã€‚\n2ã€crashlyticä¸ŠæŠ¥çš„ä¸æ˜¯å´©æºƒä¿¡æ¯ï¼Œæ˜¯å¼‚å¸¸ä¿¡æ¯ï¼Œè¿™äº›ä¿¡æ¯å½“ç„¶æœ‰ç”¨å•Šï¼Œä¸€èˆ¬æ˜¯ä½ çš„Appå‡ºç°äº†æ§ä»¶å¼‚å¸¸ï¼Œå¦‚æœå †æ ˆé‡Œæ²¡æœ‰ä½ è‡ªå·±çš„æ–¹æ³•ï¼Œå¯ä»¥å¢åŠ å½“å‰é¡µé¢ä¸Šä¸‹æ–‡ï¼Œç”¨äºŒåˆ†æ³•æ’æŸ¥ä¸€ä¸‹","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1570518963,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1016375,"avatar":"http://thirdwx.qlogo.cn/mmopen/vi_32/DYAIOgq83erqwaa4MlBjfDRwwfyQHksv5AdiaG6EKoicYqToo09uxmjXWQmUOG0QPXKOXn6FLibLBtfvxLq2dNpDg/132","nickname":"jp1017","note":"","ucode":"2B03ECC05ED023","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":24718,"discussion_content":"åŸºæœ¬æ²¡ä»€ä¹ˆå¤§é—®é¢˜çš„ï¼Œè§£å†³ä¸äº†çš„å°±å†™ä¸ªæ’ä»¶åŸç”Ÿå®ç°","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1570247959,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":1,"child_discussions":[{"author":{"id":1001557,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/48/55/48de9a24.jpg","nickname":"Carlo","note":"","ucode":"7C3FF23B597506","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":1016375,"avatar":"http://thirdwx.qlogo.cn/mmopen/vi_32/DYAIOgq83erqwaa4MlBjfDRwwfyQHksv5AdiaG6EKoicYqToo09uxmjXWQmUOG0QPXKOXn6FLibLBtfvxLq2dNpDg/132","nickname":"jp1017","note":"","ucode":"2B03ECC05ED023","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":25419,"discussion_content":"å¥½çš„ã€‚æ²¡è¯•è¿‡å†™æ’ä»¶ã€‚å°è±¡ä¸­å†™æ’ä»¶æ¯”è¾ƒéš¾ã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1570525636,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":24718,"ip_address":""},"score":25419,"extra":""}]}]}]}