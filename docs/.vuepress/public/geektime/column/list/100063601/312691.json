{"id":312691,"title":"08 | MQTTï¼šåœ¨å®è·µä¸­æŒæ¡ä¸€ä¸ªé€šä¿¡åè®®","content":"<p>ä½ å¥½ï¼Œæˆ‘æ˜¯éƒ­æœæ–Œã€‚</p><p>åœ¨åŸºç¡€ç¯‡çš„<a href=\"https://time.geekbang.org/column/article/307518\">ç¬¬ 3 è®²</a>ä¸­ï¼Œæˆ‘ä»‹ç»äº†å‡ ç§ç‰©è”ç½‘ç³»ç»Ÿä¸­å¸¸ç”¨çš„ç½‘ç»œåè®®ã€‚å®ƒä»¬æ˜¯ç‰©è”ç½‘è®¾å¤‡ä¹‹é—´æ²Ÿé€šçš„â€œè¯­è¨€â€ï¼Œä½¿ç”¨åŒä¸€ç§è¯­è¨€ï¼ŒåŒæ–¹æ‰èƒ½é€šä¿¡æˆåŠŸã€‚</p><p>é‚£ä¹ˆï¼Œåœ¨è¿™ä¹ˆå¤šç½‘ç»œåè®®å½“ä¸­ï¼Œæœ€æµè¡Œçš„æ˜¯å“ªä¸€ç§å‘¢ï¼Ÿæ¯«æ— ç–‘é—®ï¼Œæ˜¯MQTTåè®®ï¼Œå®ƒç”šè‡³å·²ç»æˆä¸ºç‰©è”ç½‘ç³»ç»Ÿäº‹å®ä¸Šçš„ç½‘ç»œåè®®æ ‡å‡†ã€‚å¦‚æœä½ æƒ³ä»äº‹ç‰©è”ç½‘å¼€å‘ï¼Œå°±ä¸€å®šè¦æŒæ¡MQTTã€‚</p><p>æ‰€ä»¥è¿™ä¸€è®²ï¼Œæˆ‘å°±ä¼šå¸¦ä½ äº†è§£MQTTï¼Œåœ¨å®è·µä¸­ç†Ÿæ‚‰å®ƒçš„ç‰¹æ€§ã€‚</p><h2>ä½“éªŒMQTT</h2><p>ä¸ºäº†è®©ä½ å¯¹MQTTæœ‰ä¸€ä¸ªç›´è§‚çš„å°è±¡ï¼Œæˆ‘å…ˆå¸¦ä½ ä½“éªŒä¸€ä¸‹å®ƒçš„é€šä¿¡è¿‡ç¨‹ï¼Œ</p><p>ç¬¬ä¸€æ­¥æ˜¯å®‰è£… hbmqttï¼Œå®ƒæ˜¯ä¸€ä¸ªå¼€æºçš„åŸºäºPythonè¯­è¨€çš„ MQTT Broker  è½¯ä»¶ï¼Œæ­£å¥½åŒ…æ‹¬æˆ‘ä»¬éœ€è¦ä½¿ç”¨ä¸€äº›å·¥å…·ã€‚è·Ÿå…¶ä»–é€‰æ‹©ç›¸æ¯”ï¼Œè¿™ä¸ªè½¯ä»¶å®‰è£…èµ·æ¥éå¸¸æ–¹ä¾¿ï¼Œå› ä¸ºå®ƒåœ¨ Python çš„ PYPI è½¯ä»¶ä»“åº“ä¸­å°±æœ‰ï¼Œæ‰€ä»¥ä½ é€šè¿‡ pip å‘½ä»¤å°±å¯ä»¥å®‰è£…ã€‚è¿™ä¹Ÿæ˜¯é€‰æ‹©ä½¿ç”¨å®ƒçš„ä¸»è¦åŸå› ã€‚</p><p>ä¸è¿‡è¦æ³¨æ„çš„æ˜¯ï¼Œhbmqtt æ˜¯åŸºäºPython3å®ç°çš„ï¼Œå› æ­¤è¿™é‡Œä½¿ç”¨çš„æ˜¯ pip3 å·¥å…·ã€‚</p><pre><code>pip3 install hbmqtt\n</code></pre><p>å®‰è£…å®Œæˆåï¼Œæˆ‘ä»¬å°±å¯ä»¥ä½¿ç”¨ hbmqtt ä¸­æä¾›çš„  hbmqtt_sub å’Œ hbmqtt_pub è¿™ä¸¤ä¸ªå‘½ä»¤è¡Œå·¥å…·äº†ã€‚é€šè¿‡åå­—ï¼Œä½ åº”è¯¥ä¹Ÿå¯ä»¥çœ‹å‡º hbmqtt_sub å¯ä»¥å……å½“<strong>è®¢é˜…è€…</strong>çš„è§’è‰²ï¼›hbmqtt_pub å¯ä»¥ä½œä¸ºæ¶ˆæ¯çš„<strong>å‘å¸ƒè€…</strong>ã€‚</p><!-- [[[read_end]]] --><p>è‡³äºè®¢é˜…è€…å’Œå‘å¸ƒè€…ä¹‹é—´çš„ç»çºªäººï¼Œä¹Ÿå°±æ˜¯ MQTT Brokerï¼Œæˆ‘ä»¬ä½¿ç”¨  Eclipse å…è´¹å¼€æ”¾çš„åœ¨çº¿ <a href=\"https://mosquitto.org/\">Broker æœåŠ¡</a>ã€‚æ‰“å¼€é“¾æ¥ï¼Œä½ å¯ä»¥çœ‹åˆ°å…³äºç«¯å£çš„ä»‹ç»ä¿¡æ¯ï¼ŒåŠ å¯†å’ŒéåŠ å¯†æ–¹å¼éƒ½æ”¯æŒï¼Œè€Œä¸”è¿˜æœ‰åŸºäº Websocket çš„å®ç°ï¼Œè¿™å¯¹åŸºäºå‰ç«¯ç½‘é¡µçš„åº”ç”¨æ¥è¯´æ˜¯éå¸¸æœ‰åˆ©çš„ã€‚</p><p>æˆ‘ä»¬å…ˆä½¿ç”¨ 1883ç«¯å£çš„éåŠ å¯†æ–¹å¼ï¼Œç„¶åä¸ºæ¶ˆæ¯ä¼ è¾“ç¡®å®šä¸€ä¸ªä¸»é¢˜ï¼ˆTopicï¼‰ã€‚ä¸»é¢˜ç¡®å®šäº†æ¶ˆæ¯çš„ç±»åˆ«ï¼Œç”¨äºæ¶ˆæ¯è¿‡æ»¤ã€‚æ¯”å¦‚æˆ‘ä»¬å¾…ä¼šå„¿è¦æµ‹è¯•çš„æ¶ˆæ¯ï¼Œå±äºæå®¢æ—¶é—´å¹³å°çš„ç‰©è”ç½‘è¯¾ç¨‹ï¼Œæ‰€ä»¥ä¸»é¢˜å¯ä»¥è®¾ä¸ºâ€œ/geektime/iotâ€ã€‚</p><pre><code>/geektime/iot\n</code></pre><p>æ¥ç€ï¼Œæˆ‘ä»¬åœ¨ç”µè„‘çš„ç»ˆç«¯ç•Œé¢è¾“å…¥ä¸‹é¢çš„å‘½ä»¤ï¼Œå°±å¯ä»¥è®¢é˜…è¿™ä¸ªä¸»é¢˜æ¶ˆæ¯ï¼š</p><pre><code>hbmqtt_sub --url mqtt://mqtt.eclipse.org:1883 -t /geektime/iot\n</code></pre><p>å¦‚æœä½ æƒ³äº†è§£ä¸€äº›å‘½ä»¤çš„æ‰§è¡Œç»†èŠ‚ï¼Œå¯ä»¥åœ¨ä¸Šé¢çš„å‘½ä»¤ä¸­åŠ ä¸Š â€œ-dâ€ å‚æ•°ã€‚</p><p>ç°åœ¨ï¼Œæˆ‘ä»¬å¯åŠ¨å¦å¤–ä¸€ä¸ªç»ˆç«¯ç•Œé¢ï¼Œé€šè¿‡ hbmqtt_pub å‘å¸ƒä¸€ä¸ª â€œ/geektime/iotâ€ ä¸»é¢˜çš„æ¶ˆæ¯ï¼š</p><pre><code>hbmqtt_pub --url mqtt://mqtt.eclipse.org:1883 -t /geektime/iot -m Hello,World!\n</code></pre><p>é€šè¿‡ Eclipse çš„å¼€æ”¾ Broker ä½œä¸ºâ€œç»çºªäººâ€ï¼Œæ¶ˆæ¯è¢«ä¼ è¾“åˆ°äº†æˆ‘ä»¬é€šè¿‡ hbmqtt_sub è¿è¡Œçš„è®¢é˜…è€…é‚£é‡Œã€‚ä¸‹å›¾æ˜¯æˆ‘çš„ç»ˆç«¯ç•Œé¢ä¸Šè¿è¡Œçš„ç»“æœï¼Œä¸€ä¸ªå®Œæ•´çš„æ¶ˆæ¯ä¼ è¾“è¿‡ç¨‹å°±è¿™æ ·å®Œæˆäº†ã€‚</p><p><img src=\"https://static001.geekbang.org/resource/image/9a/ef/9a4fe3966ac303d5defde1bd8b7yy4ef.png?wh=1544*214\" alt=\"\"></p><h2>MQTT çš„ç”Ÿæ€å¾ˆå®Œå–„</h2><p>åˆæ­¥ä½“éªŒä¹‹åï¼Œä¸çŸ¥é“ä½ æ˜¯ä¸æ˜¯æœ‰è¿™æ ·çš„æ„Ÿè§‰ï¼šåŸæ¥ä½¿ç”¨MQTTä¹Ÿæ²¡æœ‰é‚£ä¹ˆéš¾å•Šï¼Ÿ</p><p>ç¡®å®ä¸éš¾ï¼Œç”šè‡³å¯ä»¥è¯´å¾ˆç®€å•ï¼Œè¿™ä¸»è¦å¾—ç›ŠäºMQTT åè®®å‡ºç°çš„æ—¶é—´å¾ˆä¹…è¿œã€‚å½“ç„¶ï¼Œæ—¶é—´ä¹…è¿œæœ¬èº«ä¸æ˜¯ä¼˜åŠ¿ï¼Œèƒ½åŠ›å¼ºæ‰æ˜¯ã€‚è¿™äº›é•¿æœŸçš„ä½¿ç”¨å’Œç§¯æ·€ä½¿å¾— MQTT çš„ç”Ÿæ€éå¸¸å®Œå–„ï¼Œè€Œç”Ÿæ€æ˜¯æŠ€æœ¯æ ‡å‡†èƒ½å¤Ÿä¸»å¯¼è¡Œä¸šçš„å…³é”®ã€‚æ‰€ä»¥ä½ åœ¨ä½¿ç”¨MQTTçš„æ—¶å€™ä¼šè§‰å¾—å¾ˆæ–¹ä¾¿ï¼Œå¯ä¾›æŒ‘é€‰çš„æ–¹æ¡ˆæœ‰å¾ˆå¤šã€‚</p><p>æ¯”å¦‚åœ¨ä¸Šé¢çš„ä½“éªŒä¸­ï¼Œä½ è¦å®‰è£… MQTTï¼Œå¯ä»¥ç›´æ¥æ‰¾åˆ° <a href=\"https://github.com/beerfactory/hbmqtt\">hbmqtt</a> è¿™æ ·çš„é¡¹ç›®æ‹¿æ¥ç”¨ã€‚å®ƒçš„èƒŒåæœ‰ Eclipse åŸºé‡‘ä¼šçš„æ”¯æŒã€‚</p><p>ç±»ä¼¼çš„ MQTT Broker  è½¯ä»¶ï¼Œä½ è¿˜å¯ä»¥é€‰æ‹©åŸºäºCè¯­è¨€çš„<a href=\"http://mosquitto.org/\">Mosquitto</a>ï¼ŒåŸºäºErlangè¯­è¨€çš„<a href=\"https://vernemq.com/\">VerneMQ</a>ç­‰ã€‚</p><p>è‡³äº MQTT çš„å®¢æˆ·ç«¯ï¼ˆClientï¼‰å®ç°ï¼Œä¹Ÿæœ‰æˆç†Ÿçš„ Pythonã€Cã€Java å’Œ JavaScript ç­‰å„ç§ç¼–ç¨‹è¯­è¨€çš„å¼€æºå®ç°ï¼Œä¾›ä½ å‚è€ƒã€ä½¿ç”¨ï¼Œæ¯”å¦‚<a href=\"http://www.eclipse.org/paho/\">Eclipse Pahoé¡¹ç›®</a>ã€‚</p><p>è€Œä¸”ï¼Œè¿˜æœ‰å¾ˆå¤šå•†ä¸šå…¬å¸åœ¨æŒç»­è¿è¥åŠŸèƒ½æ›´ä¸°å¯Œã€æ”¯æŒæ›´å®Œå¤‡çš„å•†ä¸šç‰ˆ Broker å®ç°ï¼Œæ¯”å¦‚æä¾›é«˜å¹¶å‘èƒ½åŠ›çš„é›†ç¾¤ç‰¹æ€§ã€æ–¹ä¾¿æ‹“å±•çš„æ’ä»¶æœºåˆ¶ç­‰ã€‚è¿™äº›ä¼šå¤§å¤§æé«˜æˆ‘ä»¬æŠ€æœ¯å¼€å‘è€…çš„å·¥ä½œæ•ˆç‡ã€‚æ¯”å¦‚ä¸­å›½ä¸€ä¸ªå›¢é˜Ÿå¼€å‘ã€ç»´æŠ¤çš„ <a href=\"https://www.emqx.io/\">EMQ X</a>ï¼Œå®ƒå·²ç»å®Œæ•´åœ°æ”¯æŒ MQTT5.0åè®®ã€‚</p><p>å¦å¤–ï¼Œç”Ÿæ€å®Œå–„è¿˜æœ‰ä¸€ä¸ªå¥½å¤„ï¼Œé‚£å°±æ˜¯ä½œä¸ºå¼€å‘è€…ï¼Œå½“ä½ é‡åˆ°éš¾é¢˜æ—¶ï¼Œå¯ä»¥å¾ˆæ–¹ä¾¿åœ°æ‰¾åˆ°å¾ˆå¤šç›¸å…³çš„èµ„æ–™ï¼›å°±ç®—èµ„æ–™è§£å†³ä¸äº†é—®é¢˜ï¼Œä½ è¿˜å¯ä»¥å»ç¤¾åŒºä¸­æé—®ï¼Œå¯»æ±‚é«˜æ‰‹çš„å¸®åŠ©ã€‚è¿™åœ¨å®é™…å·¥ä½œä¸­éå¸¸æœ‰ç”¨ã€‚é¡ºä¾¿æä¸€ä¸‹ï¼Œé™¤äº†è€ç‰Œçš„Stack Overflowï¼Œä½ è¿˜å¯ä»¥å…³æ³¨ä¸€ä¸‹ GitHub çš„ Issues æ¨¡å—ï¼Œå› ä¸ºåœ¨é‚£é‡Œå¯ä»¥æ‰¾åˆ°å¾ˆå¤šä¸“å®¶ã€‚</p><h2>MQTTè‡ªèº«çš„â€œåŸºå› â€å¾ˆå¼ºå¤§</h2><p>å½“ç„¶ï¼Œé˜¿é‡Œäº‘ã€åä¸ºäº‘ã€è…¾è®¯äº‘å’Œå¾®è½¯ Azure è¿™äº›å¤§å‚ï¼Œä¹‹æ‰€ä»¥ä¸çº¦è€ŒåŒåœ°é€‰æ‹© MQTT åè®®ä½œä¸ºç‰©è”ç½‘è®¾å¤‡çš„â€œç¬¬ä¸€è¯­è¨€â€ï¼Œä¸ä»…æ˜¯å› ä¸ºMQTTçš„ç”Ÿæ€å®Œå–„ï¼ŒMQTTåè®®æœ¬èº«çš„ä¼˜ç§€è®¾è®¡ä¹Ÿæ˜¯é‡è¦çš„å› ç´ ã€‚</p><p>å®ƒåœ¨è®¾è®¡ä¸Šçš„ä¼˜ç‚¹ä½“ç°åœ¨å“ªå‘¢ï¼Ÿæˆ‘æƒ³ä¸»è¦æœ‰äº”ä¸ªæ–¹é¢ï¼š</p><ol>\n<li>å¥‘åˆç‰©è”ç½‘å¤§éƒ¨åˆ†åº”ç”¨åœºæ™¯çš„<strong>å‘å¸ƒ-è®¢é˜…æ¨¡å¼</strong>ã€‚</li>\n<li>èƒ½å¤Ÿæ»¡è¶³ç‰©è”ç½‘ä¸­èµ„æºå—é™è®¾å¤‡éœ€è¦çš„<strong>è½»é‡çº§ç‰¹æ€§</strong>ã€‚</li>\n<li>æ—¶åˆ»å…³æ³¨ç‰©è”ç½‘è®¾å¤‡<strong>ä½åŠŸè€—éœ€æ±‚çš„ä¼˜åŒ–è®¾è®¡</strong>ã€‚</li>\n<li>é’ˆå¯¹ç‰©è”ç½‘ä¸­å¤šå˜çš„ç½‘ç»œç¯å¢ƒæä¾›çš„<strong>å¤šç§æœåŠ¡è´¨é‡ç­‰çº§</strong>ã€‚</li>\n<li>æ”¯æŒåœ¨ç‰©è”ç½‘åº”ç”¨ä¸­è¶Šæ¥è¶Šè¢«é‡è§†çš„<strong>æ•°æ®å®‰å…¨</strong>ã€‚</li>\n</ol><p>æ¥ä¸‹æ¥ï¼Œæˆ‘åˆ†åˆ«ä¸ºä½ å‰–æä¸€ä¸‹ã€‚</p><h3>å‘å¸ƒ-è®¢é˜…æ¨¡å¼</h3><p>åˆšæ‰æˆ‘ä»¬ä½“éªŒçš„é€šä¿¡è¿‡ç¨‹ï¼Œæ˜¯ä¸€ä¸ªå‘å¸ƒè€…å’Œä¸€ä¸ªè®¢é˜…è€…çš„æƒ…å†µã€‚åœ¨è¿™ä¹‹åï¼Œä½ å¯ä»¥å†æ‰“å¼€ä¸€ä¸ªç»ˆç«¯ç•Œé¢ï¼Œé‡å¤å’Œä¹‹å‰ä¸€æ ·çš„å‘½ä»¤ï¼Œå†å¯åŠ¨ä¸€ä¸ªè®¢é˜…è€…ã€‚</p><pre><code>hbmqtt_sub --url mqtt://mqtt.eclipse.org:1883 -t /geektime/iot\n</code></pre><p>ç°åœ¨ï¼Œè¿™ä¸¤ä¸ªè®¢é˜…è€…éƒ½è®¢é˜…äº†â€œ/geektime/iotâ€ ä¸»é¢˜çš„æ¶ˆæ¯ã€‚</p><p>ç„¶åï¼Œä½ å†æ¬¡ä½¿ç”¨ hbmqtt_pub å‘é€æ¶ˆæ¯ï¼Œå°±å¯ä»¥çœ‹åˆ°ä¸¤ä¸ªè®¢é˜…è€…éƒ½æ”¶åˆ°äº†åŒæ ·çš„æ¶ˆæ¯ï¼Œè¿™æ˜¯<strong>å‘å¸ƒ-è®¢é˜…æ¨¡å¼</strong>çš„å…¸å‹ç‰¹å¾ã€‚</p><p>å› ä¸ºé‡‡ç”¨äº†å‘å¸ƒ-è®¢é˜…æ¨¡å¼ï¼ŒMQTTåè®®å…·æœ‰å¾ˆå¤šä¼˜ç‚¹ï¼Œæ¯”å¦‚èƒ½è®©ä¸€ä¸ªä¼ æ„Ÿå™¨æ•°æ®è§¦å‘ä¸€ç³»åˆ—åŠ¨ä½œï¼›ç½‘ç»œä¸ç¨³å®šé€ æˆçš„ä¸´æ—¶ç¦»çº¿ä¸ä¼šå½±å“å·¥ä½œï¼›æ–¹ä¾¿æ ¹æ®éœ€æ±‚åŠ¨æ€è°ƒæ•´ç³»ç»Ÿè§„æ¨¡ç­‰ã€‚è¿™ä½¿å¾—å®ƒèƒ½æ»¡è¶³ç»å¤§éƒ¨åˆ†ç‰©è”ç½‘åœºæ™¯çš„éœ€æ±‚ã€‚</p><h3>è½»é‡çº§åè®®ï¼šå‡å°‘ä¼ è¾“æ•°æ®é‡</h3><p>MQTT æ˜¯ä¸€ä¸ª<strong>è½»é‡çº§</strong>çš„ç½‘ç»œåè®®ï¼Œè¿™ä¸€ç‚¹ä¹Ÿæ˜¯å®ƒåœ¨ç‰©è”ç½‘ç³»ç»Ÿä¸­æµè¡Œçš„é‡è¦åŸå› ã€‚æ¯•ç«Ÿç‰©è”ç½‘ä¸­å¤§é‡çš„éƒ½æ˜¯è®¡ç®—èµ„æºæœ‰é™ã€ç½‘ç»œå¸¦å®½ä½çš„è®¾å¤‡ã€‚</p><p>è¿™ç§â€œè½»é‡çº§â€ä½“ç°åœ¨ä¸¤ä¸ªæ–¹é¢ã€‚ä¸€æ–¹é¢ï¼ŒMQTT æ¶ˆæ¯é‡‡ç”¨<strong>äºŒè¿›åˆ¶çš„ç¼–ç æ ¼å¼</strong>ï¼Œè€Œä¸æ˜¯ HTTP åè®®é‚£æ ·çš„æ–‡æœ¬çš„è¡¨è¿°æ–¹å¼ã€‚</p><p>è¿™æœ‰ä»€ä¹ˆå¥½å¤„å‘¢ï¼Ÿé‚£å°±æ˜¯å¯ä»¥å……åˆ†åˆ©ç”¨å­—èŠ‚ä½ï¼Œåè®®å¤´å¯ä»¥å¾ˆç´§å‡‘ï¼Œä»è€Œå°½é‡<strong>å‡å°‘éœ€è¦é€šè¿‡ç½‘ç»œä¼ è¾“çš„æ•°æ®é‡</strong>ã€‚</p><p>æ¯”å¦‚ï¼Œæˆ‘ä»¬åˆ†æ HTTP çš„ä¸€ä¸ªè¯·æ±‚æŠ“åŒ…ï¼Œå®ƒçš„æ¶ˆæ¯å†…å®¹æ˜¯ä¸‹é¢è¿™æ ·çš„ï¼ˆæ³¨æ„ï¼šç©ºæ ¼å’Œå›è½¦ã€æ¢è¡Œç¬¦éƒ½æ˜¯æ¶ˆæ¯çš„ç»„æˆéƒ¨åˆ†ï¼‰ï¼š</p><pre><code>GET /account HTTP/1.1    &lt;--æ³¨é‡Šï¼šHTTPè¯·æ±‚è¡Œ\nHost: time.geekbang.com  &lt;--æ³¨é‡Šï¼šä»¥ä¸‹ä¸ºHTTPè¯·æ±‚å¤´éƒ¨\nUpgrade-Insecure-Requests: 1\nUser-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10.15; rv:81.0) Gecko/20100101 Firefox/81.0\nAccept: text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,*/*;q=0.8\nAccept-Encoding: gzip, deflate, sdch\nAccept-Language: zh-CN,zh;q=0.8,en;q=0.6\n                         &lt;--æ³¨é‡Šï¼šè¿™ä¸ªç©ºè¡Œæ˜¯å¿…é¡»çš„ï¼Œå³ä½¿ä¸‹é¢çš„è¯·æ±‚ä½“æ˜¯ç©ºçš„\n</code></pre><p>åœ¨HTTPåè®®ä¼ è¾“çš„è¿™æ®µæ–‡æœ¬ä¸­ï¼Œæ¯ä¸ªå­—ç¬¦éƒ½è¦å ç”¨  1 ä¸ªå­—èŠ‚ã€‚è€Œå¦‚æœä½¿ç”¨MQTTåè®®ï¼Œä¸€ä¸ªå­—èŠ‚å°±å¯ä»¥è¡¨ç¤ºå¾ˆå¤šå†…å®¹ã€‚ä¸‹é¢çš„å›¾ç‰‡å±•ç¤ºäº† MQTT çš„å›ºå®šå¤´çš„æ ¼å¼ï¼Œè¿™ä¸ªå›ºå®šå¤´åªæœ‰2ä¸ªå­—èŠ‚ï¼š</p><p><img src=\"https://static001.geekbang.org/resource/image/e0/03/e03f1b94406b4cf33d55c9361925e203.jpg?wh=2700*582\" alt=\"\"></p><p>ä½ å¯ä»¥çœ‹åˆ°ï¼Œç¬¬ä¸€ä¸ªå­—èŠ‚åˆ†æˆäº†é«˜ 4 ä½ï¼ˆ4ï½7ï¼‰å’Œä½ 4 ä½ï¼ˆ0ï½3ï¼‰ï¼›ä½  4  ä½æ˜¯æ•°æ®åŒ…æ ‡è¯†ä½ï¼Œå…¶ä¸­çš„æ¯ä¸€æ¯”ç‰¹ä½åˆå¯ä»¥è¡¨ç¤ºä¸åŒçš„å«ä¹‰ï¼›é«˜4ä½æ˜¯ä¸åŒæ•°æ®åŒ…ç±»å‹çš„æ ‡è¯†ä½ã€‚</p><p>ç¬¬äºŒä¸ªå­—èŠ‚è¡¨ç¤ºæ•°æ®åŒ…å¤´éƒ¨å’Œæ¶ˆæ¯ä½“çš„å­—èŠ‚å…±ä¸ªæ•°ï¼Œå…¶ä¸­æœ€é«˜ä½è¡¨ç¤ºæœ‰æ²¡æœ‰ç¬¬ä¸‰å­—èŠ‚å­˜åœ¨ï¼Œæ¥å’Œç¬¬äºŒä¸ªå­—èŠ‚ä¸€èµ·è¡¨ç¤ºå­—èŠ‚å…±ä¸ªæ•°ã€‚</p><p>å¦‚æœæœ‰ç¬¬ä¸‰ä¸ªå­—èŠ‚ï¼Œé‚£å®ƒçš„æœ€é«˜ä½è¡¨ç¤ºæ˜¯å¦æœ‰ç¬¬å››ä¸ªå­—èŠ‚ï¼Œæ¥å’Œç¬¬äºŒä¸ªå­—èŠ‚ã€ç¬¬ä¸‰ä¸ªå­—èŠ‚ä¸€èµ·è¡¨ç¤ºå­—èŠ‚æ€»ä¸ªæ•°ã€‚ä¾æ­¤ç±»æ¨ï¼Œè¿˜å¯èƒ½æœ‰ç¬¬å››ä¸ªå­—èŠ‚ã€ç¬¬äº”ä¸ªå­—èŠ‚ï¼Œä¸è¿‡è¿™ä¸ªè¡¨ç¤ºå¯å˜å¤´éƒ¨å’Œæ¶ˆæ¯ä½“çš„å­—èŠ‚ä¸ªæ•°çš„éƒ¨åˆ†ï¼Œæœ€å¤šä¹Ÿåªèƒ½åˆ°ç¬¬äº”ä¸ªå­—èŠ‚ï¼Œæ‰€ä»¥å¯ä»¥è¡¨ç¤ºçš„æœ€å¤§æ•°æ®åŒ…é•¿åº¦æœ‰256MBã€‚</p><p>æ¯”å¦‚ï¼Œä¸€ä¸ªè¯·æ±‚å»ºç«‹è¿æ¥çš„ CONNECT ç±»å‹æ•°æ®åŒ…ï¼Œå¤´éƒ¨éœ€è¦14ä¸ªå­—èŠ‚ï¼›å‘å¸ƒæ¶ˆæ¯çš„ PUBLISH ç±»å‹æ•°æ®åŒ…å¤´éƒ¨åªæœ‰2ï½4ä¸ªå­—èŠ‚ã€‚</p><p>è½»é‡çº§çš„å¦ä¸€æ–¹é¢ï¼Œä½“ç°åœ¨æ¶ˆæ¯çš„å…·ä½“<strong>äº¤äº’æµç¨‹è®¾è®¡éå¸¸ç®€å•</strong>ï¼Œæ‰€ä»¥MQTTçš„äº¤äº’æ¶ˆæ¯ç±»å‹ä¹Ÿéå¸¸å°‘ã€‚ä¸ºäº†æ–¹ä¾¿åé¢çš„è®²è§£ï¼Œæˆ‘åœ¨è¿™é‡Œæ•´ç†äº†ä¸€ä¸ªè¡¨æ ¼ï¼Œæ€»ç»“äº† MQTT ä¸åŒçš„æ•°æ®åŒ…ç±»å‹çš„åŠŸèƒ½å’Œå‘æ¶ˆæ¯çš„æµå‘ã€‚</p><p>ä»è¡¨æ ¼å¯ä»¥çœ‹å‡ºï¼ŒMQTT 3.1.1 ç‰ˆæœ¬ä¸€å…±å®šä¹‰äº†14ç§æ•°æ®åŒ…çš„ç±»å‹ï¼Œåœ¨ç¬¬ä¸€ä¸ªå­—èŠ‚çš„é«˜ 4 ä½ä¸­åˆ†åˆ«å¯¹åº”ä» 1 åˆ° 14 çš„æ•°å€¼ã€‚</p><p><img src=\"https://static001.geekbang.org/resource/image/5d/e4/5d22e10c5b00a10177d76055db93f3e4.jpg?wh=2700*1519\" alt=\"\"></p><h3>ä½åŠŸè€—ä¼˜åŒ–ï¼šèŠ‚çº¦ç”µé‡å’Œç½‘ç»œèµ„æº</h3><p>é™¤äº†è®©åè®®è¶³å¤Ÿè½»é‡ï¼ŒMQTTåè®®è¿˜å¾ˆæ³¨é‡<strong>ä½åŠŸè€—</strong>çš„ä¼˜åŒ–è®¾è®¡ï¼Œè¿™ä¸»è¦ä½“ç°åœ¨å¯¹èƒ½è€—å’Œé€šä¿¡æ¬¡æ•°çš„ä¼˜åŒ–ã€‚</p><p>æ¯”å¦‚ï¼ŒMQTT åè®®æœ‰ä¸€ä¸ª <strong>Keepalive æœºåˆ¶</strong>ã€‚å®ƒçš„ä½œç”¨æ˜¯ï¼Œåœ¨ Client å’Œ Broker çš„è¿æ¥ä¸­æ–­æ—¶ï¼Œè®©åŒæ–¹èƒ½åŠæ—¶å‘ç°ï¼Œå¹¶é‡æ–°å»ºç«‹ MQTT è¿æ¥ï¼Œä¿è¯ä¸»é¢˜æ¶ˆæ¯çš„å¯é ä¼ è¾“ã€‚</p><p>è¿™ä¸ªæœºåˆ¶å·¥ä½œçš„åŸç†æ˜¯ï¼šClient å’Œ Broker éƒ½åŸºäº Keepalive ç¡®å®šçš„æ—¶é—´é•¿åº¦ï¼Œæ¥åˆ¤æ–­ä¸€æ®µæ—¶é—´å†…æ˜¯å¦æœ‰æ¶ˆæ¯åœ¨åŒæ–¹ä¹‹é—´ä¼ è¾“ã€‚è¿™ä¸ª  Keepalive æ—¶é—´é•¿åº¦æ˜¯åœ¨Clientå»ºç«‹è¿æ¥æ—¶è®¾ç½®çš„ï¼Œå¦‚æœè¶…å‡ºè¿™ä¸ªæ—¶é—´é•¿åº¦ï¼ŒåŒæ–¹æ²¡æœ‰æ”¶åˆ°æ–°çš„æ•°æ®åŒ…ï¼Œé‚£ä¹ˆå°±åˆ¤å®šè¿æ¥æ–­å¼€ã€‚</p><p>è™½ç„¶Keepaliveè¦æ±‚ä¸€æ®µæ—¶é—´å†…å¿…é¡»æœ‰æ•°æ®åŒ…ä¼ è¾“ï¼Œä½†å®é™…æƒ…å†µæ˜¯ï¼ŒClient å’Œ Broker ä¸å¯èƒ½æ—¶æ—¶åˆ»åˆ»éƒ½åœ¨ä¼ è¾“ä¸»é¢˜æ¶ˆæ¯ï¼Œè¿™è¦æ€ä¹ˆåŠå‘¢ï¼Ÿ</p><p>MQTT åè®®çš„è§£å†³æ–¹æ¡ˆæ˜¯ï¼Œå®šä¹‰äº† PINGREQ å’Œ PINGRESP è¿™ä¸¤ç§æ¶ˆæ¯ç±»å‹ã€‚å®ƒä»¬éƒ½æ²¡æœ‰å¯å˜å¤´éƒ¨å’Œæ¶ˆæ¯ä½“ï¼Œä¹Ÿå°±æ˜¯è¯´éƒ½åªæœ‰  2  ä¸ªå­—èŠ‚å¤§å°ã€‚Client å’Œ Broker é€šè¿‡åˆ†åˆ«å‘é€ PINGREQ å’Œ PINGRESP æ¶ˆæ¯ï¼Œå°±èƒ½å¤Ÿæ»¡è¶³ Keepalive æœºåˆ¶çš„è¦æ±‚ã€‚</p><p>æˆ‘çŒœä½ ä¹Ÿæƒ³åˆ°äº†ï¼Œå¦‚æœè¦ä¸€ç›´è¿™æ ·â€œå‚»å‚»åœ°â€å®šæœŸå‘é€æ¶ˆæ¯ï¼Œé‚£ä¹Ÿå¤ªæµªè´¹ç”µé‡å’Œç½‘ç»œèµ„æºäº†ã€‚æ‰€ä»¥ï¼Œå¦‚æœåœ¨ Keepalive æ—¶é—´é•¿åº¦å†…ï¼ŒClient å’Œ Broker ä¹‹é—´æœ‰æ•°æ®ä¼ è¾“ï¼Œé‚£ä¹ˆ Keepalive æœºåˆ¶ä¹Ÿä¼šå°†å…¶è®¡ç®—åœ¨å†…ï¼Œè¿™æ ·å°±ä¸éœ€è¦å†é€šè¿‡å‘é€ PINGREQ å’Œ PINGRESP æ¶ˆæ¯æ¥åˆ¤æ–­äº†ã€‚</p><p>é™¤äº† Keepalive æœºåˆ¶ï¼ŒMQTT 5.0 ä¸­çš„<strong>é‡å¤ä¸»é¢˜ç‰¹æ€§</strong>ä¹Ÿèƒ½å¸®åŠ©æˆ‘ä»¬èŠ‚çœç½‘ç»œèµ„æºã€‚</p><p>Client åœ¨é‡å¤å‘é€ä¸€ä¸ªä¸»é¢˜çš„æ¶ˆæ¯æ—¶ï¼Œå¯ä»¥ä»ç¬¬äºŒæ¬¡å¼€å§‹ï¼Œå°†ä¸»é¢˜åé•¿åº¦è®¾ç½®ä¸º 0ï¼Œè¿™æ · Broker  ä¼šè‡ªåŠ¨æŒ‰ç…§ä¸Šæ¬¡çš„ä¸»é¢˜æ¥å¤„ç†æ¶ˆæ¯ã€‚è¿™ç§æƒ…å†µå¯¹ä¼ æ„Ÿå™¨è®¾å¤‡æ¥è¯´ååˆ†å¸¸è§ï¼Œæ‰€ä»¥è¿™ä¸ªç‰¹æ€§åœ¨å·¥ä½œä¸­å¾ˆæœ‰å®é™…æ„ä¹‰ã€‚</p><h3>3ç§QoSçº§åˆ«ï¼šå¯é é€šä¿¡</h3><p>é™¤äº†è®¡ç®—èµ„æºæœ‰é™ã€ç½‘ç»œå¸¦å®½ä½ï¼Œç‰©è”ç½‘è®¾å¤‡è¿˜ç»å¸¸é‡åˆ°ç½‘ç»œç¯å¢ƒä¸ç¨³å®šçš„é—®é¢˜ï¼Œå°¤å…¶æ˜¯åœ¨ç§»åŠ¨é€šä¿¡ã€å«æ˜Ÿé€šä¿¡è¿™æ ·çš„åœºæ™¯ä¸‹ã€‚æ¯”å¦‚å…±äº«å•è½¦ï¼Œå¦‚æœç”¨æˆ·å·²ç»é”è½¦çš„è¿™ä¸ªæ¶ˆæ¯ï¼Œä¸èƒ½å¯é åœ°ä¸Šä¼ åˆ°æœåŠ¡å™¨ï¼Œé‚£ä¹ˆè®¡è´¹å°±ä¼šå‡ºç°é”™è¯¯ï¼Œç»“æœå¼•èµ·ç”¨æˆ·çš„æŠ±æ€¨ã€‚è¿™æ ·æ€ä¹ˆåº”å¯¹å‘¢ï¼Ÿ</p><p>è¿™ä¸ªé—®é¢˜äº§ç”Ÿçš„èƒŒæ™¯å°±æ˜¯ä¸ç¨³å®šçš„é€šä¿¡æ¡ä»¶ï¼Œæ‰€ä»¥ MQTT åè®®è®¾è®¡äº†  3 ç§ä¸åŒçš„ QoS  ï¼ˆQuality of Serviceï¼ŒæœåŠ¡è´¨é‡ï¼‰çº§åˆ«ã€‚ä½ å¯ä»¥æ ¹æ®åœºæ™¯çµæ´»é€‰æ‹©ï¼Œåœ¨ä¸åŒç¯å¢ƒä¸‹ä¿è¯é€šä¿¡æ˜¯å¯é çš„ã€‚</p><p>è¿™ 3 ç§çº§åˆ«åˆ†åˆ«æ˜¯ï¼š</p><ol>\n<li>QoS 0ï¼Œè¡¨ç¤ºæ¶ˆæ¯<strong>æœ€å¤š</strong>æ”¶åˆ°ä¸€æ¬¡ï¼Œå³æ¶ˆæ¯å¯èƒ½ä¸¢å¤±ï¼Œä½†æ˜¯ä¸ä¼šé‡å¤ã€‚</li>\n<li>QoS 1ï¼Œè¡¨ç¤ºæ¶ˆæ¯<strong>è‡³å°‘</strong>æ”¶åˆ°ä¸€æ¬¡ï¼Œå³æ¶ˆæ¯ä¿è¯é€è¾¾ï¼Œä½†æ˜¯å¯èƒ½é‡å¤ã€‚</li>\n<li>QoS 2ï¼Œè¡¨ç¤ºæ¶ˆæ¯<strong>åªä¼š</strong>æ”¶åˆ°ä¸€æ¬¡ï¼Œå³æ¶ˆæ¯æœ‰ä¸”åªæœ‰ä¸€æ¬¡ã€‚</li>\n</ol><p><img src=\"https://static001.geekbang.org/resource/image/63/d1/63ced1e04d756yy9ae89c3c81c8ac9d1.jpg?wh=2700*1375\" alt=\"\"></p><p>æˆ‘ç”¨ä¸€å¼ å›¾å±•ç¤ºäº†å®ƒä»¬å„è‡ªçš„ç‰¹ç‚¹ã€‚å¯ä»¥çœ‹åˆ°ï¼ŒQoS 0 å’Œ QoS 1 çš„æµç¨‹ç›¸å¯¹æ¯”è¾ƒç®€å•ï¼›è€Œ QoS 2 ä¸ºäº†ä¿è¯æœ‰ä¸”åªæœ‰ä¸€æ¬¡çš„å¯é ä¼ è¾“ï¼Œæµç¨‹ç›¸å¯¹å¤æ‚äº›ã€‚</p><p>æ­£å¸¸æƒ…å†µä¸‹ï¼ŒQoS 2æœ‰PUBLISHã€PUBRECã€PUBREL å’Œ PUBCOMP 4 æ¬¡äº¤äº’ã€‚</p><p>è‡³äºâ€œä¸æ­£å¸¸çš„æƒ…å†µâ€ï¼Œå‘é€æ–¹å°±éœ€è¦é‡å¤å‘é€æ¶ˆæ¯ã€‚æ¯”å¦‚ä¸€æ®µæ—¶é—´å†…æ²¡æœ‰æ”¶åˆ° PUBREC æ¶ˆæ¯ï¼Œå°±éœ€è¦å†æ¬¡å‘é€PUBLISHæ¶ˆæ¯ã€‚ä¸è¿‡è¦æ³¨æ„ï¼Œè¿™æ—¶è¦æŠŠæ¶ˆæ¯ä¸­çš„ â€œé‡å¤â€æ ‡è¯†è®¾ç½®ä¸º1ï¼Œä»¥ä¾¿æ¥æ”¶æ–¹èƒ½æ­£ç¡®å¤„ç†ã€‚åŒæ ·åœ°ï¼Œå¦‚æœæ²¡æœ‰æ”¶åˆ° PUBCOMP æ¶ˆæ¯ï¼Œå‘é€æ–¹å°±éœ€è¦å†æ¬¡å‘é€PUBRELæ¶ˆæ¯ã€‚</p><p>å‰–æåˆ°è¿™é‡Œï¼ŒMQTTåè®®æœ¬èº«çš„ä¸»è¦ç‰¹æ€§æˆ‘å°±ä»‹ç»å®Œäº†ï¼Œæˆ‘ä»¬å·²ç»ä¸ºåœ¨å®æˆ˜ç¯‡ç¼–å†™ MQTT çš„ç›¸å…³é€šä¿¡ä»£ç åšå¥½äº†å‡†å¤‡ã€‚ä½†æ˜¯ï¼Œæˆ‘è¿˜æƒ³è·Ÿä½ è¡¥å……ä¸€ä¸ªè·Ÿç”Ÿäº§ç¯å¢ƒæœ‰å…³çš„çŸ¥è¯†ç‚¹ï¼Œé‚£å°±æ˜¯<strong>æ•°æ®å®‰å…¨ä¼ è¾“</strong>ã€‚</p><h3>å®‰å…¨ä¼ è¾“</h3><p>è¯´åˆ°å®‰å…¨ä¼ è¾“ï¼Œé¦–å…ˆæˆ‘ä»¬éœ€è¦éªŒè¯Clientæ˜¯å¦æœ‰æƒé™æ¥å…¥MQTT Brokerã€‚ä¸ºäº†æ§åˆ¶Clientçš„æ¥å…¥ï¼ŒMQTT æä¾›äº†<strong>ç”¨æˆ·å/å¯†ç </strong>çš„æœºåˆ¶ã€‚åœ¨å»ºç«‹è¿æ¥è¿‡ç¨‹ä¸­ï¼Œå®ƒå¯ä»¥é€šè¿‡åˆ¤æ–­ç”¨æˆ·åå’Œå¯†ç çš„æ­£ç¡®æ€§ï¼Œæ¥ç­›é€‰æœ‰æ•ˆè¿æ¥è¯·æ±‚ã€‚</p><p>ä½†æ˜¯å…‰é è¿™ä¸ªæœºåˆ¶ï¼Œè¿˜ä¸èƒ½ä¿è¯ç½‘ç»œé€šä¿¡è¿‡ç¨‹ä¸­çš„æ•°æ®å®‰å…¨ã€‚å› ä¸ºåœ¨æ˜æ–‡ä¼ è¾“çš„æ–¹å¼ä¸‹ï¼Œä¸æ­¢è®¾å¤‡æ•°æ®ï¼Œç”šè‡³ç”¨æˆ·åå’Œå¯†ç éƒ½å¯èƒ½è¢«å…¶ä»–äººä»ç½‘ç»œä¸Šæˆªè·è€Œå¯¼è‡´æ³„æ¼ï¼Œäºæ˜¯å…¶ä»–äººå°±å¯ä»¥ä¼ªè£…æˆåˆæ³•çš„è®¾å¤‡å‘é€æ•°æ®ã€‚æ‰€ä»¥ï¼Œæˆ‘ä»¬è¿˜éœ€è¦é€šä¿¡åŠ å¯†æŠ€æœ¯çš„æ”¯æŒã€‚</p><p>MQTT åè®®æ”¯æŒ <strong>SSL/TLS</strong> åŠ å¯†é€šä¿¡æ–¹å¼ã€‚é‡‡ç”¨SSL/TLSåŠ å¯†ä¹‹åï¼ŒMQTTå°†è½¬æ¢ä¸º MQTTSã€‚è¿™æœ‰ç‚¹ç±»ä¼¼äº HTTP å’Œ HTTPS çš„å…³ç³»ã€‚</p><p>æˆ‘ä»¬åªè¦å°†å‰é¢æµ‹è¯•çš„å‘½ä»¤ä¿®æ”¹ä¸€ä¸‹ï¼Œå°† â€œmqtt://â€ æ”¹ä¸º â€œmqtts://â€ï¼Œç«¯å£æ”¹ä¸º 8883ï¼Œå°±å¯ä»¥ç”¨SSL/TLS åŠ å¯†é€šä¿¡æ–¹å¼è¿æ¥åˆ° Eclipse æä¾›çš„å¼€æ”¾ Brokerã€‚ä½†æ˜¯æˆ‘æœ€è¿‘å‘ç°ï¼Œå®ƒçš„SSLè¯ä¹¦å·²ç»è¿‡æœŸäº†ï¼Œå› æ­¤è¿æ¥ä¼šå¤±è´¥ã€‚ï¼ˆä½ åœ¨å­¦ä¹ è¿™ä¸€è®²çš„æ—¶å€™ï¼Œå¯ä»¥å†è¯•è¯•ï¼Œä¸‡ä¸€åˆæ›´æ–°äº†å‘¢ï¼Ÿï¼‰</p><p>æ‰€ä»¥ï¼Œæˆ‘å†æä¾›å¦ä¸€ä¸ªæ–¹å¼ï¼Œä¾›ä½ æµ‹è¯•ä½¿ç”¨ã€‚</p><p>æˆ‘ä»¬è¾“å…¥â€œmqtts://test.mosquitto.org:8883â€ï¼ŒæŠŠå¼€æ”¾ Broker åˆ‡æ¢åˆ°<a href=\"https://test.mosquitto.org/\">è¿™ä¸ªé“¾æ¥</a>ï¼Œä»é“¾æ¥ä¸­ä¸‹è½½ä¸€ä¸ª<a href=\"https://test.mosquitto.org/ssl/mosquitto.org.crt\">å®¢æˆ·ç«¯è¯ä¹¦</a>ï¼Œç„¶åé€šè¿‡ä¸‹é¢çš„å‘½ä»¤è®¢é˜…ä¸»é¢˜æ¶ˆæ¯ï¼š</p><pre><code>hbmqtt_sub --url mqtts://test.mosquitto.org:8883 -t /geektime/iot --ca-file ~/Downloads/mosquitto.org.crt\n</code></pre><p>æ¥ç€ï¼Œæˆ‘ä»¬å†é€šè¿‡ä¸‹é¢çš„å‘½ä»¤æµ‹è¯•å‘å¸ƒæ¶ˆæ¯ï¼š</p><pre><code>hbmqtt_pub --url mqtts://test.mosquitto.org:8883 -t /geektime/iot -m Hello,World! --ca-file ~/Downloads/mosquitto.org.crt\n</code></pre><p>æœ€ååœ¨è¿è¡Œhbmqtt_subå‘½ä»¤çš„ç»ˆç«¯ï¼Œå°±å¯ä»¥çœ‹åˆ° Hello,World! çš„æ¶ˆæ¯ï¼š</p><p><img src=\"https://static001.geekbang.org/resource/image/b0/30/b04f873277f9dba5bfb7e9ff85d17630.png?wh=1400*262\" alt=\"\"></p><h2>å°ç»“</h2><p>æ€»ç»“ä¸€ä¸‹ï¼Œåœ¨è¿™ä¸€è®²ä¸­ï¼Œæˆ‘å¸¦ä½ ä½“éªŒäº†ä½¿ç”¨MQTTåè®®çš„é€šä¿¡è¿‡ç¨‹ï¼ŒåŒæ—¶ä¹Ÿä¸ºä½ ä»‹ç»äº† MQTT åè®®çš„å‡ ä¸ªç‰¹ç‚¹ã€‚</p><ol>\n<li>MQTTåè®®çš„ç”Ÿæ€å¾ˆå¥½ã€‚æ¯”å¦‚ï¼ŒMQTT åè®®çš„ä»£ç å®ç°éå¸¸ä¸°å¯Œï¼ŒC è¯­è¨€çš„æœ‰ Mosquittoï¼ŒPython è¯­è¨€æœ‰ Eclipse hbmqttï¼Œè€Œä¸”æœ‰å•†ä¸šå…¬å¸åœ¨è¿è¥ç›¸å…³è½¯ä»¶è§£å†³æ–¹æ¡ˆã€‚è¿™è¡¨æ˜ MQTT åè®®å¾ˆæˆç†Ÿã€‚</li>\n<li>MQTTåè®®é‡‡ç”¨äº†é€‚åˆç‰©è”ç½‘åº”ç”¨åœºæ™¯çš„å‘å¸ƒ-è®¢é˜…æ¨¡å¼ã€‚å½“ç„¶ï¼Œæˆ‘ä¹Ÿæåˆ°äº†MQTT 5.0  ä¸­åŒæ ·å¢åŠ äº†è¯·æ±‚-å“åº”æ¨¡å¼ï¼Œä¾¿äºéƒ¨åˆ†åœºæ™¯ä¸­çš„å¼€å‘ä½¿ç”¨ã€‚</li>\n<li>MQTT åè®®é‡‡ç”¨äºŒè¿›åˆ¶çš„æ¶ˆæ¯å†…å®¹ç¼–ç æ ¼å¼ï¼Œåè®®å¾ˆç²¾ç®€ï¼Œåè®®äº¤äº’ä¹Ÿç®€å•ï¼Œè¿™äº›ç‰¹ç‚¹ä¿è¯äº†ç½‘ç»œä¼ è¾“æµé‡å¾ˆå°ã€‚æ‰€ä»¥å®¢æˆ·ç«¯ï¼ˆåŒ…æ‹¬å‘å¸ƒè€…å’Œè®¢é˜…è€…è§’è‰²ï¼‰çš„ä»£ç å®ç°å¯ä»¥çŸ­å°ç²¾æ‚ï¼Œæ¯”å¦‚ C è¯­è¨€çš„å®ç°å¤§æ¦‚åªå 30KB çš„å­˜å‚¨ç©ºé—´ï¼ŒJava è¯­è¨€ä¹Ÿåªéœ€è¦ 100KB å·¦å³å¤§å°çš„ä»£ç ä½“ç§¯ã€‚</li>\n<li>MQTT åè®®åœ¨è®¾è®¡ä¸Šè€ƒè™‘äº†å¾ˆå¤šç‰©è”ç½‘è®¾å¤‡çš„ä½åŠŸè€—éœ€æ±‚ï¼Œæ¯”å¦‚Keepaliveæœºåˆ¶ä¸­ç²¾ç®€çš„PINGREQ å’Œ PINGRESP è¿™ä¸¤ç§æ¶ˆæ¯ç±»å‹ï¼Œè¿˜æœ‰ MQTT 5.0  ä¸­æ–°å¢åŠ çš„é‡å¤ä¸»é¢˜ç‰¹æ€§ã€‚è¿™ä¹Ÿå†æ¬¡å°è¯äº†MQTTçš„å®šä½éå¸¸æ˜ç¡®ï¼Œé‚£å°±æ˜¯ä¸“æ³¨äºç‰©è”ç½‘åœºæ™¯ã€‚</li>\n<li>MQTT åœ¨æ¶ˆæ¯çš„å¯é ä¼ è¾“å’Œå®‰å…¨æ€§ä¸Šï¼Œä¹Ÿæœ‰å®Œæ•´çš„æ”¯æŒï¼Œå¯ä»¥è¯´â€œç®€çº¦è€Œä¸ç®€å•â€ã€‚</li>\n</ol><p>å› æ­¤ï¼Œåœ¨ä½ ä¸ºç‰©è”ç½‘ç³»ç»Ÿé€‰æ‹©ç½‘ç»œåè®®æ—¶ï¼ŒMQTTå¯ä»¥ä½œä¸ºé‡ç‚¹è€ƒå¯Ÿå¯¹è±¡ã€‚åœ¨å®æˆ˜ç¯‡çš„åŠ¨æ‰‹å®éªŒä¸­ï¼Œæˆ‘ä»¬å°†ä½¿ç”¨MQTTåè®®ä¼ è¾“è®¾å¤‡æ•°æ®ï¼Œç›¸ä¿¡ä½ å·²ç»åšå¥½äº†å‡†å¤‡ã€‚</p><h2>æ€è€ƒé¢˜</h2><p>æœ€åï¼Œæˆ‘æƒ³ç»™ä½ ç•™ä¸€ä¸ªå®è·µä½œä¸šå’Œä¸€é“æ€è€ƒé¢˜ã€‚</p><p>åœ¨ä»‹ç» QoS ç­‰çº§çš„æ—¶å€™ï¼Œæˆ‘æ²¡æœ‰ç»“åˆç½‘ç»œæŠ“åŒ…æ¥è¯´æ˜æ¶ˆæ¯çš„äº¤äº’è¿‡ç¨‹ã€‚æ‰€ä»¥ï¼Œæˆ‘æƒ³è¯·ä½ åœ¨è¯¾åä½¿ç”¨ Wireshark å·¥å…·ï¼Œå®é™…åˆ†æä¸€ä¸‹å„ä¸ª QoS çº§åˆ«çš„æ•°æ®åŒ…ç±»å‹ã€‚</p><p>åŒæ—¶ï¼Œä¹Ÿè¯·ä½ æ€è€ƒä¸€ä¸‹ï¼Œå¦‚æœClient å‘å¸ƒæ¶ˆæ¯æ—¶é€‰æ‹©çš„ QoS ç­‰çº§æ˜¯1 ï¼Œè€Œè®¢é˜…è€…åœ¨è®¢é˜…è¿™ä¸ªä¸»é¢˜æ¶ˆæ¯æ—¶é€‰æ‹©çš„QoSç­‰çº§æ˜¯2 ï¼Œè¿™ç§æƒ…å†µä¸‹ Brokerä¼šæ€ä¹ˆå¤„ç†å‘¢ï¼Ÿ</p><p>æ¬¢è¿ä½ åœ¨ç•™è¨€åŒºå†™ä¸€å†™ä½ çš„å®è·µå’Œæ€è€ƒçš„ç»“æœï¼Œä¹Ÿæ¬¢è¿ä½ å°†è¿™ä¸€è®²åˆ†äº«ç»™ä½ çš„æœ‹å‹ä¸€èµ·äº¤æµå­¦ä¹ ã€‚</p>","comments":[{"had_liked":false,"id":295452,"user_name":"Justone","can_delete":false,"product_type":"c1","uid":1231299,"ip_address":"","ucode":"BB4C294E82764E","user_header":"https://static001.geekbang.org/account/avatar/00/12/c9/c3/18fce18c.jpg","comment_is_top":false,"comment_ctime":1622436338,"is_pvip":false,"discussion_count":3,"race_medal":0,"score":"74636880370","product_id":100063601,"comment_content":"1.  pip install hbmqtt åè¿è¡Œ hbmqtt_sub æˆ– hbmqtt_pub å‘½ä»¤ï¼ŒæŠ›å‡ºäº† ModuleNotFoundError: No module named &#39;websockets.protocol&#39;<br>2.  æŠ›å‡ºå¼‚å¸¸çš„ä»£ç æ˜¯ from websockets.protocol import, no module å¯èƒ½æ˜¯ç›¸åº”çš„ protocol.py æ–‡ä»¶ç¼ºå¤±<br>3.  è¿™æ—¶å¯ä»¥æ ¹æ®å‘½ä»¤è¡Œæç¤ºçš„é”™è¯¯è·¯å¾„ï¼Œls ä¸€ä¸‹ websockets æ–‡ä»¶å¤¹æœ‰ä»€ä¹ˆä¸œè¥¿ï¼Œä¼šå‘ç°æ²¡æœ‰ protocol.py æ–‡ä»¶<br>4.  åœ¨ç½‘ä¸Šæ£€ç´¢ websocketsï¼Œå‘ç°å®ƒæºç åœ¨ github ä¸­ï¼Œè¿™ä¸ª repo ç”¨ tag åŒºåˆ«ä¸åŒç‰ˆæœ¬ï¼Œé€šè¿‡å¯¹æ¯”å¯ä»¥å‘ç°ï¼Œåœ¨ websockets 9.0 ä¹‹åå»é™¤äº† protocol.py æ–‡ä»¶ï¼Œåœ¨ 8.1 ä»¥å‰è¿˜ä¿ç•™ç€ protocol.py<br>5.  è§£å†³æ€è·¯æœ‰ä¸¤ä¸ªï¼š<br>a.  ä¿®æ”¹ hbmqtt åº“çš„ adapters.py ä»£ç ï¼ˆå¯èƒ½è¿˜æœ‰å…¶å®ƒåœ°æ–¹è¦æ”¹ï¼‰<br>b.  é™ä½ websockets ç‰ˆæœ¬ï¼ˆpip uninstall websockets; pip install websockets==8.1; é—®é¢˜è§£å†³)","like_count":18,"discussions":[{"author":{"id":2674368,"avatar":"https://static001.geekbang.org/account/avatar/00/28/ce/c0/cf67c443.jpg","nickname":"æ—åœ£æ–Œ","note":"","ucode":"B7510F7BB89EC5","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":394289,"discussion_content":"hbmqttæ€§èƒ½å¦‚ä½• æœ‰æµ‹è¯•è¿‡ä¹ˆ","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1631808355,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":2305512,"avatar":"","nickname":"wo","note":"","ucode":"927DA4E1F4F355","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":388207,"discussion_content":"å¤ªæ„Ÿè°¢äº†","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1628652861,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":1,"child_discussions":[{"author":{"id":2674368,"avatar":"https://static001.geekbang.org/account/avatar/00/28/ce/c0/cf67c443.jpg","nickname":"æ—åœ£æ–Œ","note":"","ucode":"B7510F7BB89EC5","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":2305512,"avatar":"","nickname":"wo","note":"","ucode":"927DA4E1F4F355","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":394288,"discussion_content":"å…„å¼Ÿï¼Œä¹Ÿæ˜¯åœ¨ç ”ç©¶hbmqttå—","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1631808324,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":388207,"ip_address":""},"score":394288,"extra":""}]}]},{"had_liked":false,"id":268605,"user_name":"è¹","can_delete":false,"product_type":"c1","uid":1020356,"ip_address":"","ucode":"395C6C4191B091","user_header":"https://static001.geekbang.org/account/avatar/00/0f/91/c4/40609b81.jpg","comment_is_top":false,"comment_ctime":1608270550,"is_pvip":false,"replies":[{"id":"99473","content":"å¯¹ï¼Œä¹Ÿå¯ä»¥å°è¯•ç”¨mosquittoçš„åœ°å€","user_name":"ä½œè€…å›å¤","user_name_real":"éƒ­æœæ–Œ","uid":"2302171","ctime":1610864518,"ip_address":"","comment_id":268605,"utype":1}],"discussion_count":5,"race_medal":0,"score":"48852910806","product_id":100063601,"comment_content":"è€å¸ˆï¼Œæˆ‘è¯•äº†ä¸€ä¸‹ä½ ç»™çš„ä»£ç <br>hbmqtt_sub --url mqtt:&#47;&#47;mqtt.eclipse.org:1883 -t &#47;geektime&#47;iotï¼Œè¿™ä¸ªURLæœ‰é—®é¢˜mqtt.eclipse.orgæˆ‘æ€ä¹ˆä¹Ÿè¿ä¸ä¸Šï¼›ä½†æ˜¯æ¢æˆå®ƒé¡µé¢ä¸Šç»™çš„mqtt.eclipseprojects.ioå°±æ²¡æœ‰é—®é¢˜ã€‚è¿˜æœ‰python 3.9 ä¼¼ä¹é‡å†™äº†ä¸€äº›å…³äºlockçš„ä»£ç ï¼Œhbmqttä¼šæœ‰é—®é¢˜ï¼ŒPython 3.8å°±æ²¡é—®é¢˜ã€‚","like_count":11,"discussions":[{"author":{"id":2302171,"avatar":"https://static001.geekbang.org/account/avatar/00/23/20/db/b04f43dc.jpg","nickname":"éƒ­æœæ–Œ","note":"","ucode":"2969986E1B3851","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":511986,"discussion_content":"å¯¹ï¼Œä¹Ÿå¯ä»¥å°è¯•ç”¨mosquittoçš„åœ°å€","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1610864518,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1704988,"avatar":"https://static001.geekbang.org/account/avatar/00/1a/04/1c/15c00997.jpg","nickname":"9ambition","note":"","ucode":"E6463C18E8CF0B","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":349838,"discussion_content":"è¿™ä¸ªåŒå­¦è¯´çš„å¾ˆå¯¹ï¼Œmqttçš„æ¥å£ç½‘å€ä¸€å®šè¦æ‰“è€å¸ˆæ¨èçš„ioï¼Œä¸è¦ç›´æ¥å¤åˆ¶è€å¸ˆçš„ä»£ç ç”¨ï¼Œå¬è¿™ä¸ªåŒå­¦åšçš„å°±æ²¡é—®é¢˜äº†ã€‚","likes_number":1,"is_delete":false,"is_hidden":false,"ctime":1613572258,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":2413319,"avatar":"","nickname":"Geek_7dd590","note":"","ucode":"B70579B53EAEA5","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":342148,"discussion_content":"æ˜¯çš„ï¼Œç¢°åˆ°åŒæ ·é—®é¢˜äº†ï¼Œ3.9ä¸‹æ€ä¹ˆè§£å†³å•Šï¼Ÿ","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1610598065,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":2,"child_discussions":[{"author":{"id":1020356,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/91/c4/40609b81.jpg","nickname":"è¹","note":"","ucode":"395C6C4191B091","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":2413319,"avatar":"","nickname":"Geek_7dd590","note":"","ucode":"B70579B53EAEA5","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":342657,"discussion_content":"æˆ‘é‡æ–°å®‰è£…äº†3.8","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1610767015,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":342148,"ip_address":""},"score":342657,"extra":""},{"author":{"id":1130122,"avatar":"https://static001.geekbang.org/account/avatar/00/11/3e/8a/891b0e58.jpg","nickname":"wnz27","note":"","ucode":"BC9ACB6B7C6FD9","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":2413319,"avatar":"","nickname":"Geek_7dd590","note":"","ucode":"B70579B53EAEA5","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":413988,"discussion_content":"ä¸å…¼å®¹3.9 githubä¸Šæœ‰ä¸ªissueè¯´äº†","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1636629470,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":342148,"ip_address":""},"score":413988,"extra":""}]}]},{"had_liked":false,"id":269349,"user_name":"like_wind","can_delete":false,"product_type":"c1","uid":1755021,"ip_address":"","ucode":"2733C299AE56AE","user_header":"http://thirdwx.qlogo.cn/mmopen/vi_32/DYAIOgq83eolBabicK5OTVJJJlUA4wwRtwCohCb75ahtbiaopsicnG3HRQTBOVEUrRY1KYCRZH78cDweQllh0Jzeg/132","comment_is_top":false,"comment_ctime":1608619422,"is_pvip":false,"replies":[{"id":"99456","content":"ğŸ‘","user_name":"ä½œè€…å›å¤","user_name_real":"éƒ­æœæ–Œ","uid":"2302171","ctime":1610860467,"ip_address":"","comment_id":269349,"utype":1}],"discussion_count":1,"race_medal":0,"score":"35968357790","product_id":100063601,"comment_content":"è‡ªå·±ç”¨EMQ Xæ­å»ºäº†ä¸€ä¸ªbrokeræœåŠ¡å™¨ï¼Œæ”¶å‘æ¶ˆæ¯æˆåŠŸï¼Œæ”¯æŒå›½äº§è½¯ä»¶ï¼Œä¸è¿‡EMQæ–‡æ¡£çœŸçš„å¾ˆå…¨ã€‚é™„ä¸Šæ–‡æ¡£é“¾æ¥ï¼šhttps:&#47;&#47;docs.emqx.cn&#47;cn&#47;broker&#47;latest&#47;getting-started&#47;install.html","like_count":9,"discussions":[{"author":{"id":2302171,"avatar":"https://static001.geekbang.org/account/avatar/00/23/20/db/b04f43dc.jpg","nickname":"éƒ­æœæ–Œ","note":"","ucode":"2969986E1B3851","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":512245,"discussion_content":"ğŸ‘","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1610860467,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":288231,"user_name":"æ›™å…‰","can_delete":false,"product_type":"c1","uid":1476450,"ip_address":"","ucode":"04D65BF7F19845","user_header":"https://static001.geekbang.org/account/avatar/00/16/87/62/f99b5b05.jpg","comment_is_top":false,"comment_ctime":1618373250,"is_pvip":false,"replies":[{"id":"106675","content":"èµğŸ‘","user_name":"ä½œè€…å›å¤","user_name_real":"éƒ­æœæ–Œ","uid":"2302171","ctime":1621757376,"ip_address":"","comment_id":288231,"utype":1}],"discussion_count":1,"race_medal":0,"score":"14503275138","product_id":100063601,"comment_content":"æµ‹è¯•äº†ï¼Œå¦‚æœpubå’Œsubéƒ½æ˜¯2ï¼Œå°±æ˜¯2ç»„4æ¬¡äº¤äº’ã€‚å¦‚æœåªæœ‰pubä¸º2ï¼Œä¸€ç»„4æ¬¡äº¤äº’ã€‚ä½†å¦‚æœpubæ˜¯1ï¼Œsubä¸º2ï¼Œåˆ™æµ‹è¯•ç»“æœå’Œsubï¼Œpubéƒ½ä¸º1çš„æƒ…å†µä¸€æ ·ï¼Œsubå’Œbrokerä¹‹é—´ä¸æ˜¯4æ¬¡äº¤äº’ã€‚","like_count":4,"discussions":[{"author":{"id":2302171,"avatar":"https://static001.geekbang.org/account/avatar/00/23/20/db/b04f43dc.jpg","nickname":"éƒ­æœæ–Œ","note":"","ucode":"2969986E1B3851","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":518556,"discussion_content":"èµğŸ‘","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1621757376,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":268810,"user_name":"è¹","can_delete":false,"product_type":"c1","uid":1020356,"ip_address":"","ucode":"395C6C4191B091","user_header":"https://static001.geekbang.org/account/avatar/00/0f/91/c4/40609b81.jpg","comment_is_top":false,"comment_ctime":1608358449,"is_pvip":false,"discussion_count":3,"race_medal":0,"score":"14493260337","product_id":100063601,"comment_content":"è€å¸ˆç»™çš„æ€è€ƒé¢˜ï¼Œç”¨wiresharkè¯•äº†ä¸€ä¸‹ï¼Œç¬¬ä¸€æ¬¡ç”¨ï¼Œä¸å¤ªç¡®å®šç†è§£å®Œå…¨æ­£ç¡®â€”â€”æˆ‘æ„Ÿåˆ°éƒ½æ˜¯æŒ‰ç…§publisherçš„QoSç­‰çº§èµ°çš„ï¼š<br><br>å¦‚æœ Publisher QoS 1 (at least once)ï¼Œsubsciber QoS 2ï¼ˆexactly onceï¼‰ï¼Œæˆ‘çœ‹åˆ°çš„æ˜¯æœ‰ä¸¤æ¬¡Publish Messageï¼Œç„¶åä¸¤æ¬¡Publish Ackã€‚<br><br>å¦‚æœåè¿‡æ¥ï¼ŒPublisher QoS 2ï¼ˆexactly onceï¼‰ï¼Œsubsciber QoS 1 (at least once)ï¼Œæˆ‘çœ‹åˆ°çš„æƒ…å†µæ˜¯ä¼šæœ‰publishç¡®è®¤ï¼Œçœ‹åˆ°è¿™å‡ ä¸ªè¿ç»­åŠ¨ä½œPublish Message, Publish Received, Publish Release, Publish Complete, Publish Ack","like_count":3,"discussions":[{"author":{"id":1704988,"avatar":"https://static001.geekbang.org/account/avatar/00/1a/04/1c/15c00997.jpg","nickname":"9ambition","note":"","ucode":"E6463C18E8CF0B","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":349837,"discussion_content":"é—®ä¸€ä¸‹ï¼Œä½ æ€ä¹ˆç”¨wiresharkåšqosçš„å°è¯•çš„ï¼Ÿ","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1613571936,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":2,"child_discussions":[{"author":{"id":1020356,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/91/c4/40609b81.jpg","nickname":"è¹","note":"","ucode":"395C6C4191B091","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":1704988,"avatar":"https://static001.geekbang.org/account/avatar/00/1a/04/1c/15c00997.jpg","nickname":"9ambition","note":"","ucode":"E6463C18E8CF0B","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":355845,"discussion_content":"ä¸å¤ªæ‡‚è¿™ä¸ªé—®é¢˜ï¼Œå°±æ˜¯wiresharkçš„åŸºæœ¬ç”¨æ³•è€Œå·²","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1615480125,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":349837,"ip_address":""},"score":355845,"extra":""},{"author":{"id":1272580,"avatar":"https://static001.geekbang.org/account/avatar/00/13/6b/04/cea8eb77.jpg","nickname":"RG","note":"","ucode":"F9ADC5F2B23654","race_medal":0,"user_type":1,"is_pvip":true},"reply_author":{"id":1704988,"avatar":"https://static001.geekbang.org/account/avatar/00/1a/04/1c/15c00997.jpg","nickname":"9ambition","note":"","ucode":"E6463C18E8CF0B","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":578716,"discussion_content":"è¿˜æ˜¯ç”¨hbmqttå°è¯•çš„ï¼Œwiresharkå¯ä»¥æ‹¦æˆªæ•°æ®åŒ…ï¼Œå¯ä»¥çœ‹åˆ°hbmqttå…·ä½“å‘é€äº†ä»€ä¹ˆ","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1656987359,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":349837,"ip_address":""},"score":578716,"extra":""}]}]},{"had_liked":false,"id":264448,"user_name":"YueShi","can_delete":false,"product_type":"c1","uid":1625530,"ip_address":"","ucode":"8F7AFAE4641A7D","user_header":"https://static001.geekbang.org/account/avatar/00/18/cd/ba/3a348f2d.jpg","comment_is_top":false,"comment_ctime":1606469178,"is_pvip":true,"replies":[{"id":"95931","content":"æ¯”å¦‚å‘ç”Ÿæ˜¯ä¸»é¢˜æ˜¯â€œ&#47;geektime&#47;iotâ€ï¼Œç¬¬ä¸€æ¬¡éœ€è¦åœ¨ä¿¡æ¯ä½“ä¸­åŒ…å«è¿™ä¸ªä¸»é¢˜çš„å­—ç¬¦ï¼Œç¬¬äºŒæ¬¡å°±å¯ä»¥çœæ‰è¿™ä¸ªä¸»é¢˜åå­—äº†ã€‚","user_name":"ä½œè€…å›å¤","user_name_real":"éƒ­æœæ–Œ","uid":"2302171","ctime":1606567902,"ip_address":"","comment_id":264448,"utype":1}],"discussion_count":1,"race_medal":0,"score":"14491371066","product_id":100063601,"comment_content":"Client åœ¨é‡å¤å‘é€ä¸€ä¸ªä¸»é¢˜çš„æ¶ˆæ¯æ—¶ï¼Œå¯ä»¥ä»ç¬¬äºŒæ¬¡å¼€å§‹ï¼Œå°†ä¸»é¢˜åé•¿åº¦è®¾ç½®ä¸º 0ï¼Œè¿™æ · Broker ä¼šè‡ªåŠ¨æŒ‰ç…§ä¸Šæ¬¡çš„ä¸»é¢˜æ¥å¤„ç†æ¶ˆæ¯ã€‚è¿™ç§æƒ…å†µå¯¹ä¼ æ„Ÿå™¨è®¾å¤‡æ¥è¯´ååˆ†å¸¸è§ï¼Œæ‰€ä»¥è¿™ä¸ªç‰¹æ€§åœ¨å·¥ä½œä¸­å¾ˆæœ‰å®é™…æ„ä¹‰ã€‚<br><br>è¿™æ®µæ²¡æœ‰å¤ªæ‡‚, æœ‰è€å“¥ç»™æç¤ºä¸€ä¸‹å—? å¤šè°¢äº†","like_count":3,"discussions":[{"author":{"id":2302171,"avatar":"https://static001.geekbang.org/account/avatar/00/23/20/db/b04f43dc.jpg","nickname":"éƒ­æœæ–Œ","note":"","ucode":"2969986E1B3851","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":510568,"discussion_content":"æ¯”å¦‚å‘ç”Ÿæ˜¯ä¸»é¢˜æ˜¯â€œ/geektime/iotâ€ï¼Œç¬¬ä¸€æ¬¡éœ€è¦åœ¨ä¿¡æ¯ä½“ä¸­åŒ…å«è¿™ä¸ªä¸»é¢˜çš„å­—ç¬¦ï¼Œç¬¬äºŒæ¬¡å°±å¯ä»¥çœæ‰è¿™ä¸ªä¸»é¢˜åå­—äº†ã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1606567902,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":263795,"user_name":"ACK","can_delete":false,"product_type":"c1","uid":1922378,"ip_address":"","ucode":"C5D09B18DEF151","user_header":"https://static001.geekbang.org/account/avatar/00/1d/55/4a/8a841200.jpg","comment_is_top":false,"comment_ctime":1606268758,"is_pvip":false,"replies":[{"id":"95948","content":"è°¢è°¢ä½ çš„ç•™è¨€ï¼šï¼‰<br>","user_name":"ä½œè€…å›å¤","user_name_real":"éƒ­æœæ–Œ","uid":"2302171","ctime":1606570414,"ip_address":"","comment_id":263795,"utype":1}],"discussion_count":2,"race_medal":0,"score":"14491170646","product_id":100063601,"comment_content":"ä½œä¸ºæ™ºèƒ½é”åµŒå…¥å¼å¼€å‘è€…ï¼Œè§‰å¾—è€å¸ˆè®²çš„ä¸œè¥¿å¾ˆå—ç”¨ğŸ˜ƒ","like_count":3,"discussions":[{"author":{"id":2302171,"avatar":"https://static001.geekbang.org/account/avatar/00/23/20/db/b04f43dc.jpg","nickname":"éƒ­æœæ–Œ","note":"","ucode":"2969986E1B3851","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":510307,"discussion_content":"è°¢è°¢ä½ çš„ç•™è¨€ï¼šï¼‰\n","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1606570414,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1922378,"avatar":"https://static001.geekbang.org/account/avatar/00/1d/55/4a/8a841200.jpg","nickname":"ACK","note":"","ucode":"C5D09B18DEF151","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":328897,"discussion_content":"ç‰¹åˆ«æ˜¯å¼€å‘ WiFi è”ç½‘æ™ºèƒ½é”æ—¶","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1606268902,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":330113,"user_name":"äºˆæ­Œ","can_delete":false,"product_type":"c1","uid":2864780,"ip_address":"","ucode":"B9006EA4BBED20","user_header":"https://static001.geekbang.org/account/avatar/00/2b/b6/8c/d5019728.jpg","comment_is_top":false,"comment_ctime":1641801943,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"5936769239","product_id":100063601,"comment_content":"æŠ›å‡ºäº† ModuleNotFoundError: No module named &#39;websockets.protocol&#39;<br>å¯ä»¥ç”¨<br>pip install &quot;websockets==8.1&quot;<br>è§£å†³","like_count":1},{"had_liked":false,"id":279051,"user_name":"9ambition","can_delete":false,"product_type":"c1","uid":1704988,"ip_address":"","ucode":"E6463C18E8CF0B","user_header":"https://static001.geekbang.org/account/avatar/00/1a/04/1c/15c00997.jpg","comment_is_top":false,"comment_ctime":1613571906,"is_pvip":false,"replies":[{"id":"102058","content":"éœ€è¦å®é™…å®éªŒä¸€ä¸‹ï¼Œæµ‹è¯•è¿‡ç¨‹ä¸å¤ªå¤æ‚","user_name":"ä½œè€…å›å¤","user_name_real":"éƒ­æœæ–Œ","uid":"2302171","ctime":1614579837,"ip_address":"","comment_id":279051,"utype":1}],"discussion_count":1,"race_medal":0,"score":"5908539202","product_id":100063601,"comment_content":"é’ˆå¯¹æ€è€ƒé¢˜ï¼Œæˆ‘çš„å›ç­”æ˜¯è¿™æ ·å­çš„ï¼š<br>å¯¹äºå‘å¸ƒè€…ï¼ˆpubï¼‰ï¼Œé‡‡ç”¨QoS = 1ï¼Œä¹Ÿå°±æ„å‘³ç€å°±ç®—brokerå·²ç»æ”¶åˆ°æ­¤å‘å¸ƒè€…å‘é€çš„æ•°æ®ï¼Œå‘å¸ƒè€…è¿˜æ˜¯ä¼šé‡å¤ä¸€æ ·çš„æ•°å­—ï¼Œå¯¹äºå‘å¸ƒè€…æœ¬èº«æ¥è¯´å°±æ˜¯ä¸æƒ³è‡ªå·±å‘å‡ºçš„æ¯ä¸€æ¡ä¿¡æ¯è¢«é—æ¼ã€‚<br>å¯¹äºè®¢é˜…è€…ï¼ˆsubï¼‰ï¼Œé‡‡ç”¨QoS = 2, è¯´æ˜subåœ¨é¢å¯¹è®¢é˜…ä¸»é¢˜æ—¶ï¼Œæ¯ä¸€æ¬¡ä»brokerè·å¾—æ•°æ®å‰éƒ½ä¼šç»è¿‡publish, pubreck, pubrel, pubcompè¿™å››æ­¥åæ‰èƒ½ä»è®¢é˜…ä¸»é¢˜å¤„è·å¾—ä¸€æ¬¡æ•°æ®ã€‚<br>æ‰€ä»¥brokerçš„è¡Œä¸ºåªéœ€è¦ä»pub-brokerå’Œbroker-subä¸¤æ­¥çœ‹å°±å¯ä»¥ï¼š<br>å¯¹äºpub-brokerçš„éƒ¨åˆ†ï¼Œbrokeråªéœ€è¦è¿›è¡Œpubackæ¥ç¡®è®¤brokerå·²ç»æ”¶åˆ°pubå‘é€çš„æ•°æ®äº†ã€‚<br>å¯¹äºbroker-subçš„éƒ¨åˆ†ï¼Œbrokerä¸€å®šè¦å…ˆç¡®è®¤è‡ªå·±æ‰§è¡Œäº†ä»pubè·å¾—çš„æ•°æ®å‘å‡ºå»çš„è¡Œä¸ºï¼Œä¹Ÿå°±æ˜¯publishï¼Œæ¥ç€ç¡®è®¤æ”¶åˆ°subçš„å›å¤ï¼špubrecæ¥è¯´æ˜brokerç¡®å®æˆåŠŸæŠŠæ•°æ®å‘å‡ºå»äº†ï¼›æ¥ç€ç¡®è®¤brokerç¡®å®æŠŠæ•°æ®å‘å‡ºå»äº†ï¼Œä¹Ÿå°±æ˜¯pubrelï¼›æœ€åè®©subå›å¤pubcompæ¥è¯´æ˜subç¡®å®æ”¶åˆ°brokerå‘å‡ºçš„æ•°æ®äº†ã€‚å°±ç›¸å½“äºpublishå’Œpubrecæ˜¯ç¡®è®¤brokerå‘æ•°æ®çš„è¡Œä¸ºï¼Œpubrelå’Œpubcompæ˜¯ç¡®è®¤brokerçš„æ•°æ®å†…å®¹å·²ç»è¢«å‘é€å’Œè¢«subæ¥æ”¶ã€‚","like_count":1,"discussions":[{"author":{"id":2302171,"avatar":"https://static001.geekbang.org/account/avatar/00/23/20/db/b04f43dc.jpg","nickname":"éƒ­æœæ–Œ","note":"","ucode":"2969986E1B3851","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":515610,"discussion_content":"éœ€è¦å®é™…å®éªŒä¸€ä¸‹ï¼Œæµ‹è¯•è¿‡ç¨‹ä¸å¤ªå¤æ‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1614579837,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":264274,"user_name":"InfoQ_Albert","can_delete":false,"product_type":"c1","uid":1290413,"ip_address":"","ucode":"B4C16362EDC7A9","user_header":"https://wx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTIVlib8n4JZhIomleMIyJTrbhn81kXG39DhJzrFMwmwxFsHCkicsC4CmY5Ft8icmzibWzmvibsDKDP3ORQ/132","comment_is_top":false,"comment_ctime":1606401076,"is_pvip":false,"replies":[{"id":"95938","content":"greatï¼æ„Ÿè°¢ä½ çš„ç•™è¨€","user_name":"ä½œè€…å›å¤","user_name_real":"éƒ­æœæ–Œ","uid":"2302171","ctime":1606568936,"ip_address":"","comment_id":264274,"utype":1}],"discussion_count":2,"race_medal":0,"score":"5901368372","product_id":100063601,"comment_content":"ç»å®è·µSSL è¯ä¹¦å·²ç»å¯ç”¨ï¼Œåˆ©ç”¨mqttså‘å¸ƒå’Œè®¢é˜…æ¶ˆæ¯æˆåŠŸã€‚","like_count":1,"discussions":[{"author":{"id":2302171,"avatar":"https://static001.geekbang.org/account/avatar/00/23/20/db/b04f43dc.jpg","nickname":"éƒ­æœæ–Œ","note":"","ucode":"2969986E1B3851","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":510490,"discussion_content":"greatï¼æ„Ÿè°¢ä½ çš„ç•™è¨€","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1606568936,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":2674368,"avatar":"https://static001.geekbang.org/account/avatar/00/28/ce/c0/cf67c443.jpg","nickname":"æ—åœ£æ–Œ","note":"","ucode":"B7510F7BB89EC5","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":394285,"discussion_content":"æ‚¨å¥½ï¼Œä½ æµ‹è¯•çš„æ˜¯hbmqttä¹ˆ","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1631808151,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":350180,"user_name":"Geek_bobo","can_delete":false,"product_type":"c1","uid":1600334,"ip_address":"","ucode":"41088553477784","user_header":"","comment_is_top":false,"comment_ctime":1656640242,"is_pvip":true,"discussion_count":0,"race_medal":0,"score":"1656640242","product_id":100063601,"comment_content":"è€å¸ˆæ‚¨å¥½<br> <br>python3.10.0ï¼Œwebsockets==8.1ï¼Œè®¢é˜…ä¸»é¢˜æ—¶æŠ¥é”™ï¼š<br>TypeError: As of 3.10, the *loop* parameter was removed from Event() since it is no longer necessary<br><br>è¿™ä¸ªè¯¥å¦‚ä½•è§£å†³ï¼Œæˆ‘è‹¥å°†websocketså‡é«˜åˆä¼šæŠ¥â€œTypeError: As of 3.10, the *loop* parameter was removed from Event() since it is no longer necessaryâ€","like_count":0},{"had_liked":false,"id":343467,"user_name":"Geek_58fcf2","can_delete":false,"product_type":"c1","uid":2918421,"ip_address":"","ucode":"3B052EBC012E8B","user_header":"","comment_is_top":false,"comment_ctime":1650862906,"is_pvip":true,"discussion_count":0,"race_medal":0,"score":"1650862906","product_id":100063601,"comment_content":"å­¦ä¹ æ€»ç»“ï¼š<br>mqttåè®®<br>1.ç”Ÿæ€ä¸°å¯Œ<br>2.äºŒè¿›åˆ¶ä¼ è¾“<br>3.é€‚åˆç‰©è”ç½‘çš„æ¨¡å¼ï¼Œå‘å¸ƒä¸è®¢é˜…<br>3.ä½åŠŸè€—<br>4.å®‰å…¨","like_count":0},{"had_liked":false,"id":338170,"user_name":"icekiller","can_delete":false,"product_type":"c1","uid":1306801,"ip_address":"","ucode":"2EE80711505527","user_header":"https://static001.geekbang.org/account/avatar/00/13/f0/b1/2ec47baa.jpg","comment_is_top":false,"comment_ctime":1647334173,"is_pvip":true,"discussion_count":0,"race_medal":0,"score":"1647334173","product_id":100063601,"comment_content":"å®¢æˆ·ç«¯c,æœåŠ¡å™¨s<br>(pub0,sub0)(pub0,sub1)(pub0,sub2) ä¸€å‘ä¸€å›å…±2æ¡æ¶ˆæ¯<br><br>(pub1,sub1)(pub1,sub2) c(Publish Message)-&gt;s(Publish Ack)-&gt;s(Publish Message)-&gt;c(Publish Ack)å…±4æ¡æ¶ˆæ¯<br>(pub1,sub0) c(Publish Message)-&gt;s(Publish Ack)-&gt;s(Publish Message) å…±3æ¡æ¶ˆæ¯<br><br>(pub2,sub2) c(Publish Message)-&gt;s(Publish Received)-&gt;s(Publish Message)-&gt;c(Publish Release)-&gt;s(Publish Complete)-&gt;c(Publish Received)-&gt;s(Publish Release)-&gt;c(Pubish Complete) ä¸¤ç»„å…±8æ¡æ¶ˆæ¯<br>(pub2,sub1) c(Publish Message)-&gt;s(Publish Received)-&gt;s(Publish Message)-&gt;c(Publish Release)-&gt;s(Publish Complete)-&gt;c(Publish Ack)å…±6æ¡æ¶ˆæ¯<br>(pub2,sub0) c(Publish Message)-&gt;s(Publish Received)-&gt;s(Publish Message)-&gt;c(Publish Release)-&gt;s(Publish Complete)å…±5æ¡æ¶ˆæ¯<br>","like_count":0},{"had_liked":false,"id":335593,"user_name":"é˜¿ç”˜","can_delete":false,"product_type":"c1","uid":1057843,"ip_address":"","ucode":"BC93175B70E05D","user_header":"https://static001.geekbang.org/account/avatar/00/10/24/33/bcf37f50.jpg","comment_is_top":false,"comment_ctime":1645599191,"is_pvip":true,"discussion_count":0,"race_medal":0,"score":"1645599191","product_id":100063601,"comment_content":"æˆ‘çœ‹è€å¸ˆçš„æ•´ä¸ªè¯¾ç¨‹æ‰€æœ‰çš„è®¾å¤‡äº¤äº’éƒ½æ˜¯åŸºäºMQTTï¼Œä½†æ˜¯MQTTæœ¬è´¨ä¸Šæ˜¯ä¸€ä¸ªè®¢é˜…å‘å¸ƒæ¨¡å¼ï¼Œè€å¸ˆä¼šç”¨MQTTæ¥åšä¸€äº›éœ€è¦è¿”å›å€¼ï¼ˆæ¯”å¦‚æŸ¥è¯¢å‘½ä»¤ï¼Œæˆ–è€…ä¿®æ”¹å‘½ä»¤ä½†æ˜¯éœ€è¦çŸ¥é“æ‰§è¡ŒæˆåŠŸä¸å¦ï¼‰çš„å‘½ä»¤ä¸‹å‘å—ï¼Ÿ","like_count":0},{"had_liked":false,"id":330929,"user_name":"æ–°å‘³é“","can_delete":false,"product_type":"c1","uid":2227527,"ip_address":"","ucode":"979E3574082CE7","user_header":"https://static001.geekbang.org/account/avatar/00/21/fd/47/499339d1.jpg","comment_is_top":false,"comment_ctime":1642304528,"is_pvip":false,"replies":[{"id":"120883","content":"https:&#47;&#47;mosquitto.org&#47;","user_name":"ç¼–è¾‘å›å¤","user_name_real":"ç¼–è¾‘","uid":"1000473","ctime":1642383492,"ip_address":"","comment_id":330929,"utype":2}],"discussion_count":1,"race_medal":0,"score":"1642304528","product_id":100063601,"comment_content":"https:&#47;&#47;mqtt.eclipse.org&#47; æ‰“ä¸å¼€ã€‚","like_count":0,"discussions":[{"author":{"id":1000473,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/44/19/17fadc62.jpg","nickname":"éƒ­è•¾","note":"","ucode":"34F4C07D1C5FE8","race_medal":0,"user_type":8,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":546643,"discussion_content":"https://mosquitto.org/","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1642383493,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":8}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":330928,"user_name":"æ–°å‘³é“","can_delete":false,"product_type":"c1","uid":2227527,"ip_address":"","ucode":"979E3574082CE7","user_header":"https://static001.geekbang.org/account/avatar/00/21/fd/47/499339d1.jpg","comment_is_top":false,"comment_ctime":1642304305,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1642304305","product_id":100063601,"comment_content":"MQTTçš„å®¢æˆ·ç«¯å’Œbrokerä¹‹é—´çš„é€šä¿¡æ˜¯é•¿è¿æ¥å—ï¼Ÿ å¦‚æœå®¢æˆ·ç«¯æ–­å¼€è¿æ¥ï¼Œä»brokerå‘ç»™å®¢æˆ·ç«¯çš„æ¶ˆæ¯æ€ä¹ˆåˆ°è¾¾å®¢æˆ·ç«¯ï¼Ÿ ","like_count":0},{"had_liked":false,"id":321040,"user_name":"wnz27","can_delete":false,"product_type":"c1","uid":1130122,"ip_address":"","ucode":"BC9ACB6B7C6FD9","user_header":"https://static001.geekbang.org/account/avatar/00/11/3e/8a/891b0e58.jpg","comment_is_top":false,"comment_ctime":1636629524,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1636629524","product_id":100063601,"comment_content":"ä¸€ä¸ªè¯·æ±‚å»ºç«‹è¿æ¥çš„ CONNECT ç±»å‹æ•°æ®åŒ…ï¼Œå¤´éƒ¨éœ€è¦ 14 ä¸ªå­—èŠ‚ï¼›å‘å¸ƒæ¶ˆæ¯çš„ PUBLISH ç±»å‹æ•°æ®åŒ…å¤´éƒ¨åªæœ‰ 2ï½4 ä¸ªå­—èŠ‚ã€‚ <br>è¿™ä¸ªå’‹ç®—çš„å•Šè€å¸ˆ~~~~","like_count":0},{"had_liked":false,"id":320500,"user_name":"å¼€å¿ƒç‚¹æœ‹å‹ä»¬ï¼Œäººé—´ä¸å€¼å¾—","can_delete":false,"product_type":"c1","uid":1337568,"ip_address":"","ucode":"4C863AE8B75B2C","user_header":"https://static001.geekbang.org/account/avatar/00/14/68/e0/27d3cafe.jpg","comment_is_top":false,"comment_ctime":1636354731,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1636354731","product_id":100063601,"comment_content":"æœ‰ä¸ªç–‘é—®ï¼Œå¯¹äºå®é™…æƒ…å†µæ¥è¯´ï¼Œmqttçš„æœåŠ¡æ˜¯è¦å‘å¸ƒè€…å’Œè®¢é˜…è€…éƒ½èƒ½è®¿é—®å—ï¼Ÿæ˜¯ä¸æ˜¯è¦æš´éœ²åœ¨å…¬ç½‘ä¸Š","like_count":0},{"had_liked":false,"id":312460,"user_name":"æ—åœ£æ–Œ","can_delete":false,"product_type":"c1","uid":2674368,"ip_address":"","ucode":"B7510F7BB89EC5","user_header":"https://static001.geekbang.org/account/avatar/00/28/ce/c0/cf67c443.jpg","comment_is_top":false,"comment_ctime":1631807557,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1631807557","product_id":100063601,"comment_content":"python mqtt brokerï¼Œå°±ä¸€ç§hbmqttä¹ˆï¼Ÿæˆ‘æµ‹è¯•ï¼Œå‘ç°brokerå ç”¨çš„å†…å­˜è¶Šæ¥è¶Šå¤§ï¼Œè¿™ä¸ªæ€ä¹ˆå¤„ç†ï¼Ÿ","like_count":0},{"had_liked":false,"id":311536,"user_name":"å¥½å¥½å­¦ä¹ ","can_delete":false,"product_type":"c1","uid":2762093,"ip_address":"","ucode":"FD34284E7B3556","user_header":"https://thirdwx.qlogo.cn/mmopen/vi_32/wVt8rC9tr0qg3kM6FZViba1jAlyfYc8tGL4OmOEcaC6FRj6ewrgZjKg92iaxylVDvJziaQ8ia3bSXD95kNITKdvKvg/132","comment_is_top":false,"comment_ctime":1631272137,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1631272137","product_id":100063601,"comment_content":"å®Œå…¨çœ‹ä¸æ‡‚ï¼Œç‰©è”ç½‘å·¥ç¨‹æ²¡å­¦è¿‡æ€ä¹ˆåŠ(âŠ™oâŠ™)ï¼","like_count":0},{"had_liked":false,"id":299066,"user_name":"Theodore","can_delete":false,"product_type":"c1","uid":1055049,"ip_address":"","ucode":"0735C2A64295FC","user_header":"https://static001.geekbang.org/account/avatar/00/10/19/49/9452b2fd.jpg","comment_is_top":false,"comment_ctime":1624446873,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1624446873","product_id":100063601,"comment_content":"æ—¢ç„¶åº•å±‚ç”¨çš„æ˜¯wsåè®®ï¼Œé‚£å°±å¯ä»¥ç”¨charlesæŠ“åŒ…","like_count":0},{"had_liked":false,"id":293069,"user_name":"å¤šè¥„ä¸¸","can_delete":false,"product_type":"c1","uid":1074310,"ip_address":"","ucode":"1AA1497C5A293C","user_header":"https://static001.geekbang.org/account/avatar/00/10/64/86/f5a9403a.jpg","comment_is_top":false,"comment_ctime":1621181413,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1621181413","product_id":100063601,"comment_content":"â€”éç‰©è”ç½‘å¼€å‘è€…ï¼Œè¯•ç€çŒœä¸€ä¸‹ç¬¬äºŒé¢˜â€”<br><br>è¿™ç§æƒ…å†µä¸‹ï¼š<br>broker ä¼šæ ¹æ® publisher ä¸­å‘é€æ¶ˆæ¯çš„é‡å¤æ ‡è®°ä½ ä¸ subscriber ä½¿ç”¨çš„ qos2 åè®®è¿›è¡Œæ¯”è¾ƒåˆ¤æ–­ï¼Œä»è€Œç¡®ä¿åªå‘é€ä¸€æ¬¡å½“å‰æ¶ˆæ¯ç›´è‡³æˆåŠŸï¼›ä» pub æ–¹æ”¶åˆ°çš„é‡å¤æ¶ˆæ¯ï¼Œä¸ä¼šå†å°è¯•é‡å¤å‘é€ã€‚","like_count":0},{"had_liked":false,"id":290017,"user_name":"å‡è¡Œåƒ§","can_delete":false,"product_type":"c1","uid":1689188,"ip_address":"","ucode":"65461C8705ECDC","user_header":"https://static001.geekbang.org/account/avatar/00/19/c6/64/a8e09695.jpg","comment_is_top":false,"comment_ctime":1619322716,"is_pvip":false,"replies":[{"id":"106705","content":"è¿æ¥æœåŠ¡å™¨çš„é”™è¯¯ã€‚æœ‰æ›´è¯¦ç»†çš„ä¿¡æ¯å—ï¼Ÿ","user_name":"ä½œè€…å›å¤","user_name_real":"éƒ­æœæ–Œ","uid":"2302171","ctime":1621760817,"ip_address":"","comment_id":290017,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1619322716","product_id":100063601,"comment_content":"è€å¸ˆï¼Œé‡åˆ°é”™è¯¯MOSQ_ERR_EAIä»£è¡¨ä»€ä¹ˆæ„æ€ï¼Ÿ","like_count":0,"discussions":[{"author":{"id":2302171,"avatar":"https://static001.geekbang.org/account/avatar/00/23/20/db/b04f43dc.jpg","nickname":"éƒ­æœæ–Œ","note":"","ucode":"2969986E1B3851","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":519089,"discussion_content":"è¿æ¥æœåŠ¡å™¨çš„é”™è¯¯ã€‚æœ‰æ›´è¯¦ç»†çš„ä¿¡æ¯å—ï¼Ÿ","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1621760817,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":279779,"user_name":"å¤œå¾å¤œ","can_delete":false,"product_type":"c1","uid":1293142,"ip_address":"","ucode":"FC8729883EAD62","user_header":"https://static001.geekbang.org/account/avatar/00/13/bb/56/41cbcda2.jpg","comment_is_top":false,"comment_ctime":1613961798,"is_pvip":false,"replies":[{"id":"102051","content":"2çš„28æ¬¡æ–¹æ˜¯å¤šå°‘å‘¢ï¼Ÿ","user_name":"ä½œè€…å›å¤","user_name_real":"éƒ­æœæ–Œ","uid":"2302171","ctime":1614578665,"ip_address":"","comment_id":279779,"utype":1}],"discussion_count":2,"race_medal":0,"score":"1613961798","product_id":100063601,"comment_content":"å¦‚æœæœ‰ç¬¬ä¸‰ä¸ªå­—èŠ‚ï¼Œé‚£å®ƒçš„æœ€é«˜ä½è¡¨ç¤ºæ˜¯å¦æœ‰ç¬¬å››ä¸ªå­—èŠ‚ï¼Œæ¥å’Œç¬¬äºŒä¸ªå­—èŠ‚ã€ç¬¬ä¸‰ä¸ªå­—èŠ‚ä¸€èµ·è¡¨ç¤ºå­—èŠ‚æ€»ä¸ªæ•°ã€‚ä¾æ­¤ç±»æ¨ï¼Œè¿˜å¯èƒ½æœ‰ç¬¬å››ä¸ªå­—èŠ‚ã€ç¬¬äº”ä¸ªå­—èŠ‚ï¼Œä¸è¿‡è¿™ä¸ªè¡¨ç¤ºå¯å˜å¤´éƒ¨å’Œæ¶ˆæ¯ä½“çš„å­—èŠ‚ä¸ªæ•°çš„éƒ¨åˆ†ï¼Œæœ€å¤šä¹Ÿåªèƒ½åˆ°ç¬¬äº”ä¸ªå­—èŠ‚ï¼Œæ‰€ä»¥å¯ä»¥è¡¨ç¤ºçš„æœ€å¤§æ•°æ®åŒ…é•¿åº¦æœ‰ 256MBã€‚ è¿™ä¸ª256MBæ˜¯æ€ä¹ˆè®¡ç®—å‡ºæ¥çš„å‘¢ï¼Ÿæˆ‘ä¸å¤ªæ‡‚","like_count":0,"discussions":[{"author":{"id":2302171,"avatar":"https://static001.geekbang.org/account/avatar/00/23/20/db/b04f43dc.jpg","nickname":"éƒ­æœæ–Œ","note":"","ucode":"2969986E1B3851","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":515868,"discussion_content":"2çš„28æ¬¡æ–¹æ˜¯å¤šå°‘å‘¢ï¼Ÿ","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1614578665,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":2302541,"avatar":"https://static001.geekbang.org/account/avatar/00/23/22/4d/695c48fb.jpg","nickname":"åˆç›¸è¯†","note":"","ucode":"5F6CE62CE6D60F","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":352741,"discussion_content":"å“ˆå“ˆå“ˆï¼Œæˆ‘å½“æ—¶çœ‹åˆ°çš„æ—¶å€™å°±è‡ªå·±ç®—äº†ä¸€ä¸‹ï¼Œ2^28","likes_number":1,"is_delete":false,"is_hidden":false,"ctime":1614836600,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":279768,"user_name":"å¤§ç‹å«æˆ‘æ¥å·¡å±±","can_delete":false,"product_type":"c1","uid":1323223,"ip_address":"","ucode":"DC23F4F0444F4F","user_header":"https://static001.geekbang.org/account/avatar/00/14/30/d7/4999e677.jpg","comment_is_top":false,"comment_ctime":1613960385,"is_pvip":false,"replies":[{"id":"102052","content":"æ ¹æ®å‘å±•é˜¶æ®µæ¥ï¼Œæˆ‘ä»¬è¿˜æ²¡æœ‰åˆ°éœ€è¦è‡ªå·±å¼€å‘çš„é˜¶æ®µ","user_name":"ä½œè€…å›å¤","user_name_real":"éƒ­æœæ–Œ","uid":"2302171","ctime":1614578734,"ip_address":"","comment_id":279768,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1613960385","product_id":100063601,"comment_content":"è€å¸ˆ,ä½ ä»¬å…¬å¸åœ¨ç°å®ç¯å¢ƒä¸­mqtt broker æ˜¯ä½¿ç”¨ç±»ä¼¼emqè¿™ç±»æˆç†Ÿçš„è½¯ä»¶ä¹ˆ   è¿˜æ˜¯è‡ªå·±å¼€å‘?","like_count":0,"discussions":[{"author":{"id":2302171,"avatar":"https://static001.geekbang.org/account/avatar/00/23/20/db/b04f43dc.jpg","nickname":"éƒ­æœæ–Œ","note":"","ucode":"2969986E1B3851","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":515864,"discussion_content":"æ ¹æ®å‘å±•é˜¶æ®µæ¥ï¼Œæˆ‘ä»¬è¿˜æ²¡æœ‰åˆ°éœ€è¦è‡ªå·±å¼€å‘çš„é˜¶æ®µ","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1614578734,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":278909,"user_name":"å¤©å¾—ä¸€ä»¥æ¸…","can_delete":false,"product_type":"c1","uid":1139453,"ip_address":"","ucode":"5D64EFB882951A","user_header":"https://static001.geekbang.org/account/avatar/00/11/62/fd/711df44c.jpg","comment_is_top":false,"comment_ctime":1613456235,"is_pvip":true,"replies":[{"id":"102063","content":"åªè¦æ˜¯åŒä¸€ä¸ªmqttåè®®ç‰ˆæœ¬å°±è¡Œ","user_name":"ä½œè€…å›å¤","user_name_real":"éƒ­æœæ–Œ","uid":"2302171","ctime":1614580101,"ip_address":"","comment_id":278909,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1613456235","product_id":100063601,"comment_content":"ä¸åŒç‰ˆæœ¬çš„client brokerèƒ½åŒæ—¶åšè¡Œå—ï¼Ÿ","like_count":0,"discussions":[{"author":{"id":2302171,"avatar":"https://static001.geekbang.org/account/avatar/00/23/20/db/b04f43dc.jpg","nickname":"éƒ­æœæ–Œ","note":"","ucode":"2969986E1B3851","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":515555,"discussion_content":"åªè¦æ˜¯åŒä¸€ä¸ªmqttåè®®ç‰ˆæœ¬å°±è¡Œ","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1614580101,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":273001,"user_name":"ä¹ä¸‰","can_delete":false,"product_type":"c1","uid":1454691,"ip_address":"","ucode":"7D093ED7273CBE","user_header":"https://static001.geekbang.org/account/avatar/00/16/32/63/fa24f92e.jpg","comment_is_top":false,"comment_ctime":1610407417,"is_pvip":false,"replies":[{"id":"99219","content":"åœ¨ä¸€å¯¹å¤šä¸Šæœ‰ç›¸ä¼¼ä¹‹å¤„ï¼Œä½†ä¸æ˜¯ä¸€ä¸ªé¢†åŸŸçš„æ¦‚å¿µ","user_name":"ä½œè€…å›å¤","user_name_real":"éƒ­æœæ–Œ","uid":"2302171","ctime":1610777722,"ip_address":"","comment_id":273001,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1610407417","product_id":100063601,"comment_content":"å‘å¸ƒ è®¢é˜…æ¨¡å¼å¯ä»¥ç†è§£ä¸º è§‚å¯Ÿè€…æˆ–è€…é€šçŸ¥è®¾è®¡æ¨¡å¼å—ã€‚ï¼Œéƒ½æ˜¯ä¸€å¯¹å¤šçš„å…³ç³»ã€‚","like_count":0,"discussions":[{"author":{"id":2302171,"avatar":"https://static001.geekbang.org/account/avatar/00/23/20/db/b04f43dc.jpg","nickname":"éƒ­æœæ–Œ","note":"","ucode":"2969986E1B3851","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":513454,"discussion_content":"åœ¨ä¸€å¯¹å¤šä¸Šæœ‰ç›¸ä¼¼ä¹‹å¤„ï¼Œä½†ä¸æ˜¯ä¸€ä¸ªé¢†åŸŸçš„æ¦‚å¿µ","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1610777722,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":268411,"user_name":"è¹","can_delete":false,"product_type":"c1","uid":1020356,"ip_address":"","ucode":"395C6C4191B091","user_header":"https://static001.geekbang.org/account/avatar/00/0f/91/c4/40609b81.jpg","comment_is_top":false,"comment_ctime":1608184580,"is_pvip":false,"replies":[{"id":"99475","content":"å°è¯•ä¸€ä¸‹mosquittoçš„URL","user_name":"ä½œè€…å›å¤","user_name_real":"éƒ­æœæ–Œ","uid":"2302171","ctime":1610864699,"ip_address":"","comment_id":268411,"utype":1}],"discussion_count":6,"race_medal":0,"score":"1608184580","product_id":100063601,"comment_content":"æˆ‘ç”¨ä¸åŠ å¯†çš„mqttå‘å¸ƒ&#47;è®¢é˜…è¿ä¸ä¸Šbrokerï¼Œæ€»æ˜¯timeoutï¼Œè¯•äº†å¾ˆå¤šæ¬¡ï¼Œä¹Ÿåˆ°ç½‘ä¸Šæœäº†ä¸€ä¸‹ï¼Œä½†æ²¡æœ‰æ‰¾åˆ°è§£å†³åŠæ³•ã€‚æœ‰å…¶ä»–å°ä¼™ä¼´é‡åˆ°è¿™ä¸ªé—®é¢˜å—ï¼Ÿä¹Ÿæƒ³è¯·æ•™ä¸€ä¸‹è€å¸ˆã€‚<br>[2020-12-16 21:50:17,454] :: WARNING - MQTT connection failed: TimeoutError(60, &quot;Connect call failed (&#39;198.41.30.194&#39;, 1883)&quot;)<br>[2020-12-16 21:50:17,455] :: INFO - Finished processing state new exit callbacks.<br>[2020-12-16 21:50:17,456] :: INFO - Finished processing state disconnected enter callbacks.<br>[2020-12-16 21:50:17,456] :: WARNING - Connection failed: ConnectException(TimeoutError(60, &quot;Connect call failed (&#39;198.41.30.194&#39;, 1883)&quot;))<br>[2020-12-16 21:50:17,456] :: CRITICAL - connection to &#39;mqtt:&#47;&#47;mqtt.eclipse.org:1883&#39; failed: ConnectException(TimeoutError(60, &quot;Connect call failed (&#39;198.41.30.194&#39;, 1883)&quot;))","like_count":0,"discussions":[{"author":{"id":2302171,"avatar":"https://static001.geekbang.org/account/avatar/00/23/20/db/b04f43dc.jpg","nickname":"éƒ­æœæ–Œ","note":"","ucode":"2969986E1B3851","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":511937,"discussion_content":"å°è¯•ä¸€ä¸‹mosquittoçš„URL","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1610864699,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1020356,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/91/c4/40609b81.jpg","nickname":"è¹","note":"","ucode":"395C6C4191B091","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":335679,"discussion_content":"åˆå°è¯•äº†ä¸€ä¸‹ä¼¼ä¹æ˜¯è¿™ä¸ªurlæœ‰é—®é¢˜ï¼Œmqtt.eclipse.orgæˆ‘æ€ä¹ˆä¹Ÿè¿ä¸ä¸Šï¼›ä½†æ˜¯æ¢æˆå®ƒé¡µé¢ä¸Šç»™çš„mqtt.eclipseprojects.ioå°±æ²¡æœ‰é—®é¢˜ã€‚æˆ‘æŠŠè¿™ä¸ªé‡æ–°å‘ä¸ªè¯„è®ºã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1608270417,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1020356,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/91/c4/40609b81.jpg","nickname":"è¹","note":"","ucode":"395C6C4191B091","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":335678,"discussion_content":"å°è¯•äº†å¥½ä¹…ï¼Œä¸ºäº†ä¿é™©æŠŠPythonæ¢æˆäº†3.8ã€‚ä¸è¿‡æˆ‘è¿˜æ˜¯æ­»æ´»è¿è¡Œä¸äº†è€å¸ˆçš„ä»£ç ï¼š\nhbmqtt_sub --url mqtt://mqtt.eclipse.org:1883 -t /geektime/iotï¼Œæ€»æ˜¯timeoutã€‚çœ‹äº†ä¸€ä¸‹hbmqttçš„æ–‡æ¡£https://hbmqtt.readthedocs.io/en/latest/quickstart.htmlï¼Œç”¨å®ƒç»™çš„è¿™å¥hbmqtt_pub --url mqtt://test.mosquitto.org -t /test -m some_dataå°±å¯ä»¥ï¼Œæˆ‘çœ‹ä»–ç”¨çš„mosquittoä¹Ÿæ²¡æœ‰ç”¨ç«¯å£ï¼Œå®åœ¨æ˜¯ä¸çŸ¥é“ä¸ºä»€ä¹ˆä¼šæœ‰è¿™ç§æƒ…å†µ","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1608270057,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1020356,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/91/c4/40609b81.jpg","nickname":"è¹","note":"","ucode":"395C6C4191B091","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":335409,"discussion_content":"åˆç ”ç©¶åŠå¤©ï¼Œçœ‹åˆ°è¿™ä¸ªgithub issue: Python 3.9 Breaks HBMQTT: &#39;Lock&#39; object is not iterable https://github.com/beerfactory/hbmqtt/issues/223ï¼Œæ„Ÿè§‰å¯èƒ½å’Œæˆ‘çš„é—®é¢˜æœ‰ç‚¹å…³ç³»ï¼Œæ™šäº›æ—¶å€™æˆ‘å†ç ”ç©¶ä¸€ä¸‹","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1608187946,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":2,"child_discussions":[{"author":{"id":2674368,"avatar":"https://static001.geekbang.org/account/avatar/00/28/ce/c0/cf67c443.jpg","nickname":"æ—åœ£æ–Œ","note":"","ucode":"B7510F7BB89EC5","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":1020356,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/91/c4/40609b81.jpg","nickname":"è¹","note":"","ucode":"395C6C4191B091","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":394287,"discussion_content":"æ‚¨å¥½ï¼Œç ”ç©¶äº†å¦‚ä½•äº†ï¼Ÿ","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1631808248,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":335409,"ip_address":""},"score":394287,"extra":""},{"author":{"id":1020356,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/91/c4/40609b81.jpg","nickname":"è¹","note":"","ucode":"395C6C4191B091","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":2674368,"avatar":"https://static001.geekbang.org/account/avatar/00/28/ce/c0/cf67c443.jpg","nickname":"æ—åœ£æ–Œ","note":"","ucode":"B7510F7BB89EC5","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":394831,"discussion_content":"æˆ‘å¦å¤–ç•™äº†ä¸ªè¯„è®ºï¼Œç¡®å®æ˜¯ç‰ˆæœ¬é—®é¢˜","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1632094793,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":394287,"ip_address":""},"score":394831,"extra":""}]}]},{"had_liked":false,"id":266854,"user_name":"æ€€è‰è¯—","can_delete":false,"product_type":"c1","uid":1152145,"ip_address":"","ucode":"78F8B9B4628F15","user_header":"https://static001.geekbang.org/account/avatar/00/11/94/91/6d6ca42f.jpg","comment_is_top":false,"comment_ctime":1607506594,"is_pvip":true,"replies":[{"id":"97091","content":"æ˜¯brokerç»™è®¢é˜…è€…æ¨é€æ¶ˆæ¯ã€‚brokeråœ¨ä¸­é—´çš„ä½ç½®ã€‚","user_name":"ä½œè€…å›å¤","user_name_real":"éƒ­æœæ–Œ","uid":"2302171","ctime":1607756810,"ip_address":"","comment_id":266854,"utype":1}],"discussion_count":3,"race_medal":0,"score":"1607506594","product_id":100063601,"comment_content":"è€å¸ˆï¼Œæˆ‘çŸ¥é“MQTTåè®®5.0ç‰ˆæœ¬å®ç°äº†è¯·æ±‚åº”ç­”æ¨¡å¼ã€‚ä½†æ˜¯æˆ‘æƒ³è¯·æ•™ä¸‹ï¼Œåœ¨MQTTåè®®ä¸­ï¼Œè®¢é˜…è€…å¦‚ä½•ä¸»åŠ¨æ‹‰å–æ¶ˆè´¹ä¿¡æ¯ï¼Ÿ<br>éº»çƒ¦æ‚¨çœ‹è§è¿˜èƒ½å›ç­”ä¸‹ï¼Œè°¢è°¢","like_count":0,"discussions":[{"author":{"id":2302171,"avatar":"https://static001.geekbang.org/account/avatar/00/23/20/db/b04f43dc.jpg","nickname":"éƒ­æœæ–Œ","note":"","ucode":"2969986E1B3851","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":511412,"discussion_content":"æ˜¯brokerç»™è®¢é˜…è€…æ¨é€æ¶ˆæ¯ã€‚brokeråœ¨ä¸­é—´çš„ä½ç½®ã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1607756810,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1256330,"avatar":"http://thirdwx.qlogo.cn/mmopen/vi_32/PiajxSqBRaEIRm3kWsgiaEXjO0rr0Aiav7o89StFTFSXbLTkEmiaibmnw8EQTejibrtzKla0emibePT0R0KXjFRIpfXrQ/132","nickname":"zhang","note":"","ucode":"BFA19BED5A5322","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":338040,"discussion_content":"ä¸èƒ½ã€‚ä½†å¯ä»¥ä½¿ç”¨shadowã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1609159764,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1152145,"avatar":"https://static001.geekbang.org/account/avatar/00/11/94/91/6d6ca42f.jpg","nickname":"æ€€è‰è¯—","note":"","ucode":"78F8B9B4628F15","race_medal":0,"user_type":1,"is_pvip":true},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":336203,"discussion_content":"è¿™ä¸ªæˆ‘æ¸…æ¥šï¼Œå“ˆå“ˆã€‚æˆ‘å…¶å®æ˜¯æƒ³è¯·æ•™è®¢é˜…è€…å¯ä»¥ä¸»åŠ¨æ‹‰å–æ¶ˆè´¹ä¿¡æ¯ä¹ˆï¼Ÿ\nè¿˜æ˜¯è°¢è°¢è€å¸ˆå›ç­”","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1608527503,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":266806,"user_name":"å¤§ç‹å«æˆ‘æ¥å·¡å±±","can_delete":false,"product_type":"c1","uid":1323223,"ip_address":"","ucode":"DC23F4F0444F4F","user_header":"https://static001.geekbang.org/account/avatar/00/14/30/d7/4999e677.jpg","comment_is_top":false,"comment_ctime":1607493229,"is_pvip":false,"replies":[{"id":"97099","content":"hivemqæ˜¯Javaçš„ã€‚<br>ä»æ¶æ„çœ‹ï¼Œbrokerå’Œspringbootä¹‹é—´æœ€å¥½æœ‰æ¶ˆæ¯é˜Ÿåˆ—ï¼Œæ²¡æœ‰å¤ªç›´æ¥çš„å…³ç³»","user_name":"ä½œè€…å›å¤","user_name_real":"éƒ­æœæ–Œ","uid":"2302171","ctime":1607757519,"ip_address":"","comment_id":266806,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1607493229","product_id":100063601,"comment_content":"æœ‰javaç‰ˆæœ¬çš„ mqtt broker ä¹ˆ æœ€å¥½æ˜¯springbootå¼€ç®±å³ç”¨ï¼Œä¸”å¯å¼€å‘çš„é‚£ç§","like_count":0,"discussions":[{"author":{"id":2302171,"avatar":"https://static001.geekbang.org/account/avatar/00/23/20/db/b04f43dc.jpg","nickname":"éƒ­æœæ–Œ","note":"","ucode":"2969986E1B3851","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":511394,"discussion_content":"hivemqæ˜¯Javaçš„ã€‚\nä»æ¶æ„çœ‹ï¼Œbrokerå’Œspringbootä¹‹é—´æœ€å¥½æœ‰æ¶ˆæ¯é˜Ÿåˆ—ï¼Œæ²¡æœ‰å¤ªç›´æ¥çš„å…³ç³»","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1607757519,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":265508,"user_name":"Felix","can_delete":false,"product_type":"c1","uid":1018291,"ip_address":"","ucode":"5B3613FADC2E25","user_header":"https://static001.geekbang.org/account/avatar/00/0f/89/b3/446b877d.jpg","comment_is_top":false,"comment_ctime":1606918267,"is_pvip":false,"replies":[{"id":"96551","content":"å®é™…æŠ“åŒ…è¯•ä¸€ä¸‹ï¼Œä¸å¤æ‚ï¼ŒæŒæ¡çš„æ›´æ·±","user_name":"ä½œè€…å›å¤","user_name_real":"éƒ­æœæ–Œ","uid":"2302171","ctime":1606966615,"ip_address":"","comment_id":265508,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1606918267","product_id":100063601,"comment_content":"å‘å¸ƒç€é€‰æ‹©å¿½ç•¥PUBACK?<br>å¦‚æœåè¿‡æ¥ï¼Œå‘å¸ƒè€…é€‰æ‹©QoSç­‰çº§æ˜¯2ï¼Œè®¢é˜…è€…é€‰æ‹©QoSç­‰çº§æ˜¯1å‘¢ï¼Ÿå‘å¸ƒè€…å°±ä¼šé‡å¤å‘å¸ƒåŒæ ·çš„æ¶ˆæ¯ï¼Ÿ<br>â€”â€”â€”â€”â€”â€”â€”â€”<br>å¦‚æœ Client å‘å¸ƒæ¶ˆæ¯æ—¶é€‰æ‹©çš„ QoS ç­‰çº§æ˜¯ 1 ï¼Œè€Œè®¢é˜…è€…åœ¨è®¢é˜…è¿™ä¸ªä¸»é¢˜æ¶ˆæ¯æ—¶é€‰æ‹©çš„ QoS ç­‰çº§æ˜¯ 2 ï¼Œè¿™ç§æƒ…å†µä¸‹ Broker ä¼šæ€ä¹ˆå¤„ç†å‘¢ï¼Ÿ<br><br>","like_count":0,"discussions":[{"author":{"id":2302171,"avatar":"https://static001.geekbang.org/account/avatar/00/23/20/db/b04f43dc.jpg","nickname":"éƒ­æœæ–Œ","note":"","ucode":"2969986E1B3851","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":510957,"discussion_content":"å®é™…æŠ“åŒ…è¯•ä¸€ä¸‹ï¼Œä¸å¤æ‚ï¼ŒæŒæ¡çš„æ›´æ·±","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1606966615,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":263929,"user_name":"ilæli","can_delete":false,"product_type":"c1","uid":1338637,"ip_address":"","ucode":"2193A7E41DEC68","user_header":"https://static001.geekbang.org/account/avatar/00/14/6d/0d/71053329.jpg","comment_is_top":false,"comment_ctime":1606296193,"is_pvip":false,"replies":[{"id":"95945","content":"brokeråªæ˜¯ä¸­é—´äººï¼Œå¦‚ä½•ä¿è¯è®¢é˜…è€…å¯ä»¥QoS2å‘¢ï¼Ÿ<br>","user_name":"ä½œè€…å›å¤","user_name_real":"éƒ­æœæ–Œ","uid":"2302171","ctime":1606570233,"ip_address":"","comment_id":263929,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1606296193","product_id":100063601,"comment_content":"MQTT Broker æ ¹æ®å®¢æˆ·ç«¯å»ºç«‹è¿æ¥æ—¶é€‰æ‹©çš„QoSçº§åˆ«ä¸å®¢æˆ·ç«¯äº¤äº’ï¼Œä¹Ÿå³æ˜¯ä¸å‘å¸ƒæ¶ˆæ¯çš„ClientæŒ‰ç…§QoS=1 ï¼ˆè‡³å°‘ä¸€æ¬¡ï¼‰å¤„ç†ï¼Œbrokerå°†æ¶ˆæ¯æ¨é€ç»™è®¢é˜…è¿™ä¸ªä¸»é¢˜çš„Clienæ—¶é€‰æ‹© QoS=2ï¼ˆåªæœ‰ä¸€æ¬¡ï¼‰æ¥å¤„ç†","like_count":0,"discussions":[{"author":{"id":2302171,"avatar":"https://static001.geekbang.org/account/avatar/00/23/20/db/b04f43dc.jpg","nickname":"éƒ­æœæ–Œ","note":"","ucode":"2969986E1B3851","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":510352,"discussion_content":"brokeråªæ˜¯ä¸­é—´äººï¼Œå¦‚ä½•ä¿è¯è®¢é˜…è€…å¯ä»¥QoS2å‘¢ï¼Ÿ\n","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1606570233,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]}]}