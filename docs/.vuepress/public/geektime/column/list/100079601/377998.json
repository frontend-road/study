{"id":377998,"title":"01 | IAM系统概述：我们要实现什么样的 Go 项目？","content":"<p>你好，我是孔令飞。从今天开始我们进入课前准备阶段，我会用3讲的时间给你讲清楚，我们要实现的实战项目 IAM 应用长啥样、它能干什么，以及怎么把它部署到 Linux 服务器上。先和我一起扫除基础的障碍，你就能够更轻松地学习后面的课程了。</p><p>今天这一讲，我先来说说为什么选择 IAM 应用，它能实现什么功能，以及它的架构和使用流程。</p><h2>项目背景：为什么选择 IAM 系统作为实战项目？</h2><p>我们在做 Go 项目开发时，绕不开的一个话题是安全，如何保证 Go 应用的安全，是每个开发者都要解决的问题。虽然 Go 应用的安全包含很多方面，但大体可分为如下 2 类：</p><ul>\n<li><strong>服务自身的安全</strong>：为了保证服务的安全，需要禁止非法用户访问服务。这可以通过服务器层面和软件层面来解决。服务器层面可以通过物理隔离、网络隔离、防火墙等技术从底层保证服务的安全性，软件层面可以通过 HTTPS、用户认证等手段来加强服务的安全性。服务器层面一般由运维团队来保障，软件层面则需要开发者来保障。</li>\n<li><strong>服务资源的安全</strong>：服务内有很多资源，为了避免非法访问，开发者要避免 UserA 访问到 UserB 的资源，也即需要对资源进行授权。通常，我们可以通过资源授权系统来对资源进行授权。</li>\n</ul><p><strong>总的来说，为了保障Go应用的安全，我们需要对访问进行认证，对资源进行授权</strong>。那么，我们要如何实现访问认证和资源授权呢？</p><!-- [[[read_end]]] --><p>认证功能不复杂，我们可以通过 JWT （JSON Web Token）认证来实现。授权功能比较复杂，授权功能的复杂性使得它可以囊括很多 Go 开发技能点。因此，在这个专栏中，我将认证和授权的功能实现升级为 IAM 系统，通过讲解它的构建过程，给你讲清楚 Go 项目开发的全部流程。</p><h2>IAM 系统是什么？</h2><p>IAM（Identity and Access Management，身份识别与访问管理）系统是用 Go 语言编写的一个 Web 服务，用于给第三方用户提供访问控制服务。</p><p>IAM 系统可以帮用户解决的问题是：<strong>在特定的条件下，谁能够/不能够对哪些资源做哪些操作</strong>（<strong>Who</strong> is <strong>able</strong> to do <strong>what</strong> on <strong>something</strong> given some <strong>context</strong>），也即完成资源授权功能。</p><blockquote>\n<p><span class=\"reference\">提示：以后我们在提到 IAM 系统或者 IAM 时都是指代 IAM 应用。</span></p>\n</blockquote><p>那么，IAM 系统是如何进行资源授权的呢？下面，我们通过 IAM 系统的资源授权的流程，来看下它是如何工作的，整个过程可以分为 4 步。</p><p><img src=\"https://static001.geekbang.org/resource/image/ee/50/eed75fcd91d6e726ca74315d65193150.jpg?wh=2513*1134\" alt=\"\" title=\"IAM 系统的功能示意图\"></p><ol>\n<li>用户需要提供昵称、密码、邮箱、电话等信息注册并登录到 IAM 系统，这里是以用户名和密码作为唯一的身份标识来访问 IAM 系统，并且完成认证。</li>\n<li>因为访问 IAM 的资源授权接口是通过密钥（secretID/secretKey）的方式进行认证的，所以用户需要在 IAM 中创建属于自己的密钥资源。</li>\n<li>因为 IAM 通过授权策略完成授权，所以用户需要在 IAM 中创建授权策略。</li>\n<li>请求 IAM 提供的授权接口，IAM 会根据用户的请求内容和授权策略来决定一个授权请求是否被允许。</li>\n</ol><p>我们可以看到，在上面的流程中，IAM 使用到了 3 种系统资源：用户（User）、密钥（Secret）和策略（Policy），它们映射到程序设计中就是 3 种 RESTful 资源：</p><ul>\n<li>用户（User）：实现对用户的增、删、改、查、修改密码、批量修改等操作。</li>\n<li>密钥（Secret）：实现对密钥的增、删、改、查操作。</li>\n<li>策略（Policy）：实现对策略的增、删、改、查、批量删除操作。</li>\n</ul><h2>IAM 系统的架构长啥样？</h2><p>知道了 IAM 的功能之后，我们再来详细说说 IAM 系统的架构，架构图如下：</p><p><img src=\"https://static001.geekbang.org/resource/image/0a/42/0a5f6fd67af1eda1c690c8216dc5e042.jpg?wh=3197*2063\" alt=\"\" title=\"IAM 系统的完整架构\"></p><p>总的来说，IAM 架构中包括 9 大组件和 3 大数据库。我将这些组件和功能都总结在下面的表格中。这里面，我们主要记住5个核心组件，包括iam-apiserver、iam-authz-server、iam-pump、marmotedu-sdk-go和iamctl的功能，还有3个数据库Redis、MySQL和MongoDB的功能。</p><p><img src=\"https://static001.geekbang.org/resource/image/6c/71/6cdbde36255c7fb2d4f2e718c9077a71.jpeg?wh=1920*1043\" alt=\"\" title=\"前 5 个组件是我们需要实现的核心组件。[br]后 4 个组件是一些旁路组件，不影响项目的使用。[br]如果感兴趣，你可以自行实现\"></p><p>此外，IAM 系统为存储数据使用到的 3 种数据库的说明如下所示。<br>\n<img src=\"https://static001.geekbang.org/resource/image/e6/f2/e68c21e1991c74becc4b8a6a8bf5a8f2.jpeg?wh=1818*496\" alt=\"\"></p><h3>通过使用流程理解架构</h3><p>只看到这样的系统架构图和核心功能讲解，你可能还不清楚整个系统是如何协作，来最终完成资源授权的。所以接下来，我们通过详细讲解 IAM 系统的使用流程及其实现细节，来进一步加深你对 IAM 架构的理解。总的来说，我们可以通过 4 步去使用 IAM 系统的核心功能。</p><p><strong>第1步，创建平台资源。</strong></p><p>用户通过 iam-webconsole（RESTful API）或 iamctl（sdk marmotedu-sdk-go）客户端请求 iam-apiserver 提供的 RESTful API 接口完成用户、密钥、授权策略的增删改查，iam-apiserver 会将这些资源数据持久化存储在 MySQL 数据库中。而且，为了确保通信安全，客户端访问服务端都是通过 HTTPS 协议来访问的。</p><p><strong>第2步，请求 API 完成资源授权。</strong></p><p>用户可以通过请求 iam-authz-server 提供的 /v1/authz 接口进行资源授权，请求 /v1/authz 接口需要通过密钥认证，认证通过后 /v1/authz 接口会查询授权策略，从而决定资源请求是否被允许。</p><p>为了提高 /v1/authz 接口的性能，iam-authz-server 将密钥和策略信息缓存在内存中，以便实现快速查询。那密钥和策略信息是如何实现缓存的呢？</p><p>首先，iam-authz-server 通过调用 iam-apiserver 提供的 gRPC 接口，将密钥和授权策略信息缓存到内存中。同时，为了使内存中的缓存信息和 iam-apiserver 中的信息保持一致，当 iam-apiserver 中有密钥或策略被更新时，iam-apiserver 会往特定的 Redis Channel（iam-authz-server 也会订阅该 Channel）中发送 PolicyChanged 和 SecretChanged 消息。这样一来，当 iam-authz-server 监听到有新消息时就会获取并解析消息，根据消息内容判断是否需要重新调用 gRPC 接来获取密钥和授权策略信息，再更新到内存中。</p><p><strong>第3步，授权日志数据分析。</strong></p><p>iam-authz-server 会将授权日志上报到 Redis 高速缓存中，然后 iam-pump 组件会异步消费这些授权日志，再把清理后的数据保存在 MongoDB 中，供运营系统 iam-operating-system 查询。</p><p>这里还有一点你要注意：iam-authz-server 将授权日志保存在 Redis 高性能 key-value 数据库中，可以最大化减少写入延时。不保存在内存中是因为授权日志量我们没法预测，当授权日志量很大时，很可能会将内存耗尽，造成服务中断。</p><p><strong>第4步，运营平台授权数据展示。</strong></p><p>iam-operating-system 是 IAM 的运营系统，它可以通过查询 MongoDB 获取并展示运营数据，比如某个用户的授权/失败次数、授权失败时的授权信息等。此外，我们也可以通过 iam-operating-system 调用 iam-apiserver 服务来做些运营管理工作。比如，以上帝视角查看某个用户的授权策略供排障使用，或者调整用户可创建密钥的最大个数，再或者通过白名单的方式，让某个用户不受密钥个数限制的影响等等。</p><h3>IAM 软件架构模式</h3><p>在设计软件时，我们首先要做的就是选择一种软件架构模式，它对软件后续的开发方式、软件维护成本都有比较大的影响。因此，这里我也会和你简单聊聊 2 种最常用的软件架构模式，分别是前后端分离架构和 MVC 架构。</p><h4>前后端分离架构</h4><p>因为IAM 系统采用的就是前后端分离的架构，所以我们就以 IAM 的运营系统 iam-operating-system 为例来详细说说这个架构。一般来说，运营系统的功能可多可少，对于一些具有复杂功能的运营系统，我们可以采用前后端分离的架构。其中，<strong>前端负责页面的展示以及数据的加载和渲染，后端只负责返回前端需要的数据</strong>。</p><p>iam-operating-system 前后端分离架构如下图所示。</p><p><img src=\"https://static001.geekbang.org/resource/image/a2/76/a2e1f1cc135debd86611yya1f221c476.jpg?wh=2519*1447\" alt=\"\"></p><p>采用了前后端分离架构之后，当你通过浏览器请求前端 ops-webconsole 时，ops-webconsole 会先请求静态文件服务器加载静态文件，比如 HTML、CSS 和 JavaScript，然后它会执行 JavaScript，通过负载均衡请求后端数据，最后把后端返回的数据渲染到前端页面中。</p><p>采用前后端分离的架构，让前后端通过 RESTful API 通信，会带来以下5点好处：</p><ul>\n<li>可以让前、后端人员各自专注在自己业务的功能开发上，让专业的人做专业的事，来提高代码质量和开发效率</li>\n<li>前后端可并行开发和发布，这也能提高开发和发布效率，加快产品迭代速度</li>\n<li>前后端组件、代码分开，职责分明，可以增加代码的维护性和可读性，减少代码改动引起的 Bug 概率，同时也能快速定位 Bug</li>\n<li>前端 JavaScript 可以处理后台的数据，减少对后台服务器的压力</li>\n<li>可根据需要选择性水平扩容前端或者后端来节约成本</li>\n</ul><h4>MVC 架构</h4><p>但是，如果运营系统功能比较少，采用前后端分离框架的弊反而大于利，比如前后端分离要同时维护 2 个组件会导致部署更复杂，并且前后端分离将人员也分开了，这会增加一定程度的沟通成本。同时，因为代码中也需要实现前后端交互的逻辑，所以会引入一定的开发量。</p><p>这个时候，我们可以尝试直接采用 MVC 软件架构，MVC 架构如下图所示。</p><p><img src=\"https://static001.geekbang.org/resource/image/a2/eb/a23b8ba92705710c694fd7cb99812feb.jpg?wh=1753*869\" alt=\"\"></p><p>MVC 的全名是 Model View Controller，它是一种架构模式，分为 Model、View、Controller 三层，每一层的功能如下：</p><ul>\n<li>View（视图）：提供给用户的操作界面，用来处理数据的显示。</li>\n<li>Controller（控制器）：根据用户从 View 层输入的指令，选取 Model 层中的数据，然后对其进行相应的操作，产生最终结果。</li>\n<li>Model（模型）：应用程序中用于处理数据逻辑的部分。</li>\n</ul><p><strong>MVC 架构的好处是通过控制器层将视图层和模型层分离之后，当更改视图层代码后时，我们就不需要重新编译控制器层和模型层的代码了。</strong>同样，如果业务流程发生改变也只需要变更模型层的代码就可以。在实际开发中为了更好的 UI 效果，视图层需要经常变更，但是通过 MVC 架构，在变更视图层时，我们根本不需要对业务逻辑层的代码做任何变化，这不仅减少了风险还能提高代码变更和发布的效率。</p><p>除此之外，还有一种跟 MVC 比较相似的软件开发架构叫三层架构，它包括UI 层、BLL 层和DAL 层。其中，UI 层表示用户界面，BLL 层表示业务逻辑，DAL 层表示数据访问。在实际开发中很多人将 MVC 当成三层架构在用，比如说，很多人喜欢把软件的业务逻辑放在 Controller 层里，将数据库访问操作的代码放在 Model 层里，软件最终的代码放在 View 层里，就这样硬生生将 MVC 架构变成了伪三层架构。</p><p>这种代码不仅不伦不类，同时也失去了三层架构和 MVC 架构的核心优势，也就是：<strong>通过 Controller层将 Model层和 View层解耦，从而使代码更容易维护和扩展</strong>。因此在实际开发中，我们也要注意遵循 MVC 架构的开发规范，发挥 MVC 的核心价值。</p><h2>总结</h2><p>一个好的 Go 应用必须要保证应用的安全性，这可以通过认证和授权来保障。也因此认证和授权是开发一个 Go 项目必须要实现的功能。为了帮助你实现这 2 个功能，并借此机会学习 Go 项目开发，我将这 2 个功能升级为一个 IAM系统。通过讲解如何开发 IAM 系统，来教你如何开发 Go 项目。</p><p>因为后面的学习都是围绕 IAM 系统展开的，所以这一讲我们要重点掌握 IAM 的功能、架构和使用流程，我们可以通过 4 步使用流程来了解。</p><p>首先，用户通过调用 iam-apiserver 提供的 RESTful API 接口完成注册和登录系统，再调用接口创建密钥和授权策略。</p><p>创建完密钥对和授权策略之后，IAM 可以通过调用 iam-authz-server 的授权接口完成资源的授权。具体来说，iam-authz-server 通过 gRPC 接口获取 iam-apiserver 中存储的密钥和授权策略信息，通过 JWT 完成认证之后，再通过 <a href=\"https://github.com/ory/ladon\">ory/ladon</a> 包完成资源的授权。</p><p>接着，iam-pump 组件异步消费 Redis 中的数据，并持久化存储在 MongoDB 中，供 iam-operating-system 运营平台展示。</p><p>最后，IAM 相关的产品、研发人员可以通过 IAM 的运营系统 iam-operating-system 来查看 IAM 系统的使用情况，进行运营分析。例如某个用户的授权/失败次数、授权失败时的授权信息等。</p><p>另外，为了提高开发和访问效率，IAM 分别提供了 marmotedu-sdk-go SDK 和 iamctl 命令行工具，二者通过 HTTPS 协议访问 IAM 提供的 RESTful 接口。</p><h2>课后练习</h2><ol>\n<li>你在做 Go 项目开发时经常用到哪些技能点？有些技能点是 IAM 没有包含的？</li>\n<li>在你所接触的项目中，哪些是前后端分离架构，哪些是 MVC 架构呢？你觉得项目采用的架构是否合理呢？</li>\n</ol><p>期待在留言区看到你的思考和分享，我们下一讲见！</p>","comments":[{"had_liked":false,"id":294737,"user_name":"素衣绾绾","can_delete":false,"product_type":"c1","uid":1569366,"ip_address":"","ucode":"B07E55A6FB8D4A","user_header":"https://static001.geekbang.org/account/avatar/00/17/f2/56/131b4173.jpg","comment_is_top":false,"comment_ctime":1622078370,"is_pvip":false,"replies":[{"id":"106989","content":"专栏会介绍如何开发Go项目，demo项目只是专栏介绍的开发技术的一个落地项目。<br><br>二者是包含与被包含的关系，专栏包含了实战项目，Go开发方法和思路，一些知识点的讲解，以及我的一些研发经验和建议。<br><br>只看源码，你看到的仅仅是一个源码，但是很可能不了解源码背后的构建思路以及一些其它需要注意的地方，比如说只看源码，你仍然不知道开发规范，仍然不知道用了哪些设计模式和技巧。<br><br>所以建议以专栏学习为主，代码阅读为辅。通过代码去验证专栏的设计思路。","user_name":"作者回复","comment_id":294737,"uid":"1167883","ip_address":"","utype":1,"ctime":1622090087,"user_name_real":"CK1.0"}],"discussion_count":6,"race_medal":0,"score":"190600639394","product_id":100079601,"comment_content":"就是说，项目的源码已经完成，然后作者会在专栏中带着我们一起搭建一个web项目框架的雏形，也就是专栏中说的一些目录规范，api设计规范，错误包设计等，具体的功能代码，就是照着已经写好的代码挑选其中核心的功能进行讲解，是吗？","like_count":45,"discussions":[{"author":{"id":1503244,"avatar":"https://static001.geekbang.org/account/avatar/00/16/f0/0c/e79ec922.jpg","nickname":"零巧合","note":"","ucode":"0762219AB0BB02","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":391568,"discussion_content":"个人觉得课程叫“Go项目学习”更合适，实战这个词用烂了，该用不该用的时候都用，实在影响理解课程初衷和要求。不过，无论如何，这个课程对Go新手还是很有价值的，值报名费，老师也用心。","likes_number":2,"is_delete":false,"is_hidden":false,"ctime":1630513997,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1198097,"avatar":"https://static001.geekbang.org/account/avatar/00/12/48/11/420b6a25.jpg","nickname":"Hua.R","note":"","ucode":"E81C149CB60569","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":377283,"discussion_content":"我个人理解与你类似，专栏名字明显夸大，并不是从0搭建，而是在作者已经做好的一个（可能经过生产实践的）脚手架的基础上，写一个玩具。在此基础上介绍一些开发流程中的规范与注意事项。","likes_number":2,"is_delete":false,"is_hidden":false,"ctime":1622589470,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":3,"child_discussions":[{"author":{"id":1105161,"avatar":"https://static001.geekbang.org/account/avatar/00/10/dd/09/feca820a.jpg","nickname":"helloworld","note":"","ucode":"1EECCA0F43E278","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":1198097,"avatar":"https://static001.geekbang.org/account/avatar/00/12/48/11/420b6a25.jpg","nickname":"Hua.R","note":"","ucode":"E81C149CB60569","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":378349,"discussion_content":"很可以了","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1623169772,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":377283,"ip_address":""},"score":378349,"extra":""},{"author":{"id":2703567,"avatar":"https://static001.geekbang.org/account/avatar/00/29/40/cf/44ec55e7.jpg","nickname":"清水","note":"","ucode":"661A314193EC93","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":1198097,"avatar":"https://static001.geekbang.org/account/avatar/00/12/48/11/420b6a25.jpg","nickname":"Hua.R","note":"","ucode":"E81C149CB60569","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":386760,"discussion_content":"我也是感觉被骗，想退货各种联系不上客服，智商被侮辱了，这将近200块钱买个半成品的书！！！","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1627784437,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":377283,"ip_address":""},"score":386760,"extra":""},{"author":{"id":2665110,"avatar":"https://static001.geekbang.org/account/avatar/00/28/aa/96/09f19dc9.jpg","nickname":"神经蛙","note":"","ucode":"65E5A5747A5797","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":1198097,"avatar":"https://static001.geekbang.org/account/avatar/00/12/48/11/420b6a25.jpg","nickname":"Hua.R","note":"","ucode":"E81C149CB60569","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":573314,"discussion_content":"刚看完，算是以一个已完成的规模还算较大的项目为例，讲解各种软件工程问题。缺憾是没有一步一步带着写项目，但总体来说还是值得这个票价的。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1653342373,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":377283,"ip_address":""},"score":573314,"extra":""}]},{"author":{"id":1167883,"avatar":"https://static001.geekbang.org/account/avatar/00/11/d2/0b/cdd0787a.jpg","nickname":"孔令飞","note":"","ucode":"8363EA4BD0AAF0","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":520786,"discussion_content":"专栏会介绍如何开发Go项目，demo项目只是专栏介绍的开发技术的一个落地项目。\n\n二者是包含与被包含的关系，专栏包含了实战项目，Go开发方法和思路，一些知识点的讲解，以及我的一些研发经验和建议。\n\n只看源码，你看到的仅仅是一个源码，但是很可能不了解源码背后的构建思路以及一些其它需要注意的地方，比如说只看源码，你仍然不知道开发规范，仍然不知道用了哪些设计模式和技巧。\n\n所以建议以专栏学习为主，代码阅读为辅。通过代码去验证专栏的设计思路。","likes_number":1,"is_delete":false,"is_hidden":false,"ctime":1622090087,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":294634,"user_name":"tiny🌾","can_delete":false,"product_type":"c1","uid":1119851,"ip_address":"","ucode":"7A4DE00381D1F3","user_header":"https://static001.geekbang.org/account/avatar/00/11/16/6b/af7c7745.jpg","comment_is_top":false,"comment_ctime":1622028241,"is_pvip":true,"discussion_count":0,"race_medal":0,"score":"83226406865","product_id":100079601,"comment_content":"沙发，跟作者也算半个同事","like_count":19},{"had_liked":false,"id":295970,"user_name":"、荒唐_戏_","can_delete":false,"product_type":"c1","uid":1149297,"ip_address":"","ucode":"BF6E05A94272E4","user_header":"https://static001.geekbang.org/account/avatar/00/11/89/71/03a99e56.jpg","comment_is_top":false,"comment_ctime":1622686286,"is_pvip":false,"replies":[{"id":"107439","content":"iam系统主要完成认证和授权功能。<br>认证：用来判断是否是平台的合法用户，例如用户名和密码就是认证的一种方式<br>授权：用来判断，是否可以访问平台的某类资源。<br><br>认证和授权 2个功能可以抽象成一个系统，这个系统名我起名为iam。类似于aws的iam，腾讯云的cam和阿里云的ram。<br><br>建议你参考下腾讯云的cam以协助你理解：https:&#47;&#47;cloud.tencent.com&#47;document&#47;product&#47;599&#47;40011。<br><br>不难，花几分钟相信你就会理解了。","user_name":"作者回复","comment_id":295970,"uid":"1167883","ip_address":"","utype":1,"ctime":1622702243,"user_name_real":"CK1.0"}],"discussion_count":4,"race_medal":0,"score":"53162293838","product_id":100079601,"comment_content":"完蛋了，上来一个iam系统就没理解😓","like_count":12,"discussions":[{"author":{"id":1167883,"avatar":"https://static001.geekbang.org/account/avatar/00/11/d2/0b/cdd0787a.jpg","nickname":"孔令飞","note":"","ucode":"8363EA4BD0AAF0","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":521280,"discussion_content":"iam系统主要完成认证和授权功能。\n认证：用来判断是否是平台的合法用户，例如用户名和密码就是认证的一种方式\n授权：用来判断，是否可以访问平台的某类资源。\n\n认证和授权 2个功能可以抽象成一个系统，这个系统名我起名为iam。类似于aws的iam，腾讯云的cam和阿里云的ram。\n\n建议你参考下腾讯云的cam以协助你理解：https://cloud.tencent.com/document/product/599/40011。\n\n不难，花几分钟相信你就会理解了。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1622702243,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":1,"child_discussions":[{"author":{"id":2323868,"avatar":"https://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTIcFZomZ7SYnVlTwHADzicWQstFoQsDL4qdpKA6IypZWJPqknzQp1qDsp1IkltYbWhic5LVAf7HWFgQ/132","nickname":"Geek_1715a7","note":"","ucode":"D1DFFC10A75F74","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":1167883,"avatar":"https://static001.geekbang.org/account/avatar/00/11/d2/0b/cdd0787a.jpg","nickname":"孔令飞","note":"","ucode":"8363EA4BD0AAF0","race_medal":0,"user_type":2,"is_pvip":false},"discussion":{"id":531779,"discussion_content":"没记错的话腾讯云的cam是基于ABAC模型设计的，一开始看的时候差点懵逼了，还是有点复杂的","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1637413698,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":521280,"ip_address":""},"score":531779,"extra":"{\"user_type\":1}"}]},{"author":{"id":1000237,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/43/2d/af86d73f.jpg","nickname":"enjoylearning","note":"","ucode":"DCAF8538DEA277","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":590764,"discussion_content":"能实现多租户单点登录吗","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1666068760,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":"北京"},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":2055809,"avatar":"https://static001.geekbang.org/account/avatar/00/1f/5e/81/82709d6e.jpg","nickname":"码小呆","note":"","ucode":"44532D6ABF9340","race_medal":0,"user_type":1,"is_pvip":true},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":581228,"discussion_content":"类似用户中心吧","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1658644394,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":295783,"user_name":"Paualf","can_delete":false,"product_type":"c1","uid":1179425,"ip_address":"","ucode":"38E8A87193DBA6","user_header":"https://static001.geekbang.org/account/avatar/00/11/ff/21/77949293.jpg","comment_is_top":false,"comment_ctime":1622598682,"is_pvip":true,"discussion_count":1,"race_medal":0,"score":"53162206234","product_id":100079601,"comment_content":"在做项目的时候，项目间通信经常使用的是kafka这类消息队列，后台会经常用搜索功能，这部分数据都会放在了ES中如搜索，日志或者后台系统的一些搜索。IAM系统中使用了Redis做消息队列，使用了MongoDB去进行存储和查询，这些是我目前想到不一样的技能点。<br><br>现在接触的大部分项目都是前后端分离的架构，接触过有一些后台管理系统使用的MVC架构。我觉得使用前后端分离的架构更加的合理，这样关注点进行分离，让专业的人干专业的事情，这样确实像老师文章中说的，增加了人力和沟通成本。","like_count":12,"discussions":[{"author":{"id":2654005,"avatar":"https://static001.geekbang.org/account/avatar/00/28/7f/35/485be224.jpg","nickname":"楠","note":"","ucode":"D1D3D78A99E732","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":378677,"discussion_content":"同意 项目中确实使用kafka 作为作为消息队列比较多 还有就是日志一般我们也是放在es中 我们日志平台是用filebeat + kafka +logstash+es 这类 ","likes_number":2,"is_delete":false,"is_hidden":false,"ctime":1623330743,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":301887,"user_name":"小屎丸","can_delete":false,"product_type":"c1","uid":1062525,"ip_address":"","ucode":"BD7A1CDF2C92F1","user_header":"https://static001.geekbang.org/account/avatar/00/10/36/7d/0cfc0752.jpg","comment_is_top":false,"comment_ctime":1625937186,"is_pvip":false,"replies":[{"id":"109279","content":"1. mongodb带有数据聚合功能，在某些场景下可以实现复杂的数据统计<br>2. 而且字段增减随意，查询方便<br>3. IAM系统授权日志量不大，场景也不复杂，再加上，这里是想展示mongodb的教学，所以就采用了mongo","user_name":"作者回复","comment_id":301887,"uid":"1167883","ip_address":"","utype":1,"ctime":1626054518,"user_name_real":"CK1.0"}],"discussion_count":1,"race_medal":0,"score":"48870577442","product_id":100079601,"comment_content":"为啥选择 MongoDB 作为日志数据分析展示库，怎么考虑的？谢谢","like_count":11,"discussions":[{"author":{"id":1167883,"avatar":"https://static001.geekbang.org/account/avatar/00/11/d2/0b/cdd0787a.jpg","nickname":"孔令飞","note":"","ucode":"8363EA4BD0AAF0","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":523118,"discussion_content":"1. mongodb带有数据聚合功能，在某些场景下可以实现复杂的数据统计\n2. 而且字段增减随意，查询方便\n3. IAM系统授权日志量不大，场景也不复杂，再加上，这里是想展示mongodb的教学，所以就采用了mongo","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1626054518,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":301126,"user_name":"大菠萝","can_delete":false,"product_type":"c1","uid":1369115,"ip_address":"","ucode":"524996C082234F","user_header":"https://static001.geekbang.org/account/avatar/00/14/e4/1b/e8f5f5e4.jpg","comment_is_top":false,"comment_ctime":1625545870,"is_pvip":true,"replies":[{"id":"109226","content":"认证：authentication，缩写：authn<br>授权：authorization，缩写：authz","user_name":"作者回复","comment_id":301126,"uid":"1167883","ip_address":"","utype":1,"ctime":1625851525,"user_name_real":"CK1.0"}],"discussion_count":1,"race_medal":0,"score":"48870186126","product_id":100079601,"comment_content":"authz，这个名字有啥含义么？主要是这个z","like_count":12,"discussions":[{"author":{"id":1167883,"avatar":"https://static001.geekbang.org/account/avatar/00/11/d2/0b/cdd0787a.jpg","nickname":"孔令飞","note":"","ucode":"8363EA4BD0AAF0","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":522902,"discussion_content":"认证：authentication，缩写：authn\n授权：authorization，缩写：authz","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1625851525,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":299126,"user_name":"helloworld","can_delete":false,"product_type":"c1","uid":1105161,"ip_address":"","ucode":"1EECCA0F43E278","user_header":"https://static001.geekbang.org/account/avatar/00/10/dd/09/feca820a.jpg","comment_is_top":false,"comment_ctime":1624468537,"is_pvip":false,"replies":[{"id":"108635","content":"理解的没毛病，可以理解为一个授权webhook。","user_name":"作者回复","comment_id":299126,"uid":"1167883","ip_address":"","utype":1,"ctime":1624708861,"user_name_real":"CK1.0"}],"discussion_count":1,"race_medal":0,"score":"40279174201","product_id":100079601,"comment_content":"是不是可以理解为每一个使用iam系统作为认证和资源授权的业务应用，该业务应用的用户每次访问该业务应用的接口都要先经过iam系统，认证和资源鉴权通过后，才能继续访问该业务应用接口呢，也就是iam是业务应用的网关代理？","like_count":10,"discussions":[{"author":{"id":1167883,"avatar":"https://static001.geekbang.org/account/avatar/00/11/d2/0b/cdd0787a.jpg","nickname":"孔令飞","note":"","ucode":"8363EA4BD0AAF0","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":522337,"discussion_content":"理解的没毛病，可以理解为一个授权webhook。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1624708861,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":295907,"user_name":"老妖纣王","can_delete":false,"product_type":"c1","uid":1357582,"ip_address":"","ucode":"C07A398ADFC38E","user_header":"https://static001.geekbang.org/account/avatar/00/14/b7/0e/20ed751b.jpg","comment_is_top":false,"comment_ctime":1622636547,"is_pvip":false,"replies":[{"id":"107421","content":"1. 使用客户端用用户名登录后，证明客户端短时间是安全的，token默认有2小时的过期时间。<br><br>2. 这个刷新成本服务端还是能抗住的。如果token过期就只能重新登录了，至于多久过期，每个业务会根据需要自己选择，但很多开源软件一般默认2小时过期。<br><br>3. 密钥保存在客户端，需要客户端使用者去保证密钥不泄露，服务端也会保存一份密钥，用来对请求进行再加密，并和客户端传来的token对比，如果一致则请求通过。<br><br><br>","user_name":"作者回复","comment_id":295907,"uid":"1167883","ip_address":"","utype":1,"ctime":1622677616,"user_name_real":"CK1.0"}],"discussion_count":3,"race_medal":0,"score":"35982374915","product_id":100079601,"comment_content":"老师，您好，正好讲到iam系统有几个问题想请教你一下，在项目中使用认证授权，遇到几个疑惑的问题一直困扰着我？<br>假如APP是内部应用的场景，流程是用户通过登录API直接获取token，然后每次携带token进行请求，网关拦截进行token的认证。<br>（1）这里面token是保存在客户端的，是否安全？<br>（2）token是有有效期的，网上一般说失败了通过刷新token去刷新，（客户端模式）客户端定时请求去触发，如果客户端多的话，频繁地刷新token的请求，显然带来很大的网络开销？为了解决这个问题，我们通过请求然后判断token时间是否到了阈值，然后续签（服务端实现）。但是这个也有问题，如果长时间没有请求会导致token过期，就不能续签了。如果是像淘宝这种，感觉永远都不会退出的，是不是就是延长token的有效时间+服务端刷新。那么永久有效，需要刷新token吗？<br>（3）oauth2中有客户端概念，我认为客户端就是app，那么appId和秘钥是不是保存到了app应用端，这样会有安全问题吗？如果密码都保存在了app端，服务端还需要对秘钥验证吗？","like_count":8,"discussions":[{"author":{"id":1167883,"avatar":"https://static001.geekbang.org/account/avatar/00/11/d2/0b/cdd0787a.jpg","nickname":"孔令飞","note":"","ucode":"8363EA4BD0AAF0","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":521259,"discussion_content":"1. 使用客户端用用户名登录后，证明客户端短时间是安全的，token默认有2小时的过期时间。\n\n2. 这个刷新成本服务端还是能抗住的。如果token过期就只能重新登录了，至于多久过期，每个业务会根据需要自己选择，但很多开源软件一般默认2小时过期。\n\n3. 密钥保存在客户端，需要客户端使用者去保证密钥不泄露，服务端也会保存一份密钥，用来对请求进行再加密，并和客户端传来的token对比，如果一致则请求通过。\n\n\n","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1622677616,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1592279,"avatar":"https://static001.geekbang.org/account/avatar/00/18/4b/d7/f46c6dfd.jpg","nickname":"William Ning","note":"","ucode":"4DB8D05E69E5F3","race_medal":0,"user_type":1,"is_pvip":true},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":571850,"discussion_content":"OAuth是真的没看懂，需要去学习下～","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1652430112,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1249598,"avatar":"https://static001.geekbang.org/account/avatar/00/13/11/3e/925aa996.jpg","nickname":"HelloBug","note":"","ucode":"E61A4AD5C2F724","race_medal":0,"user_type":1,"is_pvip":true},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":544329,"discussion_content":"留言里说的淘宝是什么保持一直在线的呢？使用体验中，银行的应用是每次打开都会重新登录，但是淘宝APP，记忆中是第一次安装软件之后登录一次之后，就再也没有登录过，这里是什么原理呢？","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1641471935,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":299125,"user_name":"helloworld","can_delete":false,"product_type":"c1","uid":1105161,"ip_address":"","ucode":"1EECCA0F43E278","user_header":"https://static001.geekbang.org/account/avatar/00/10/dd/09/feca820a.jpg","comment_is_top":false,"comment_ctime":1624468184,"is_pvip":false,"replies":[{"id":"108636","content":"网关做的是接口鉴权，也就是哪个用户&#47;密钥可以访问哪个接口。而IAM做的是资源鉴权。例如淘宝中的iphone资源等","user_name":"作者回复","comment_id":299125,"uid":"1167883","ip_address":"","utype":1,"ctime":1624708906,"user_name_real":"CK1.0"}],"discussion_count":3,"race_medal":0,"score":"27394271960","product_id":100079601,"comment_content":"IAM能和网关结合使用吗，还是必须二选一呢","like_count":6,"discussions":[{"author":{"id":1167883,"avatar":"https://static001.geekbang.org/account/avatar/00/11/d2/0b/cdd0787a.jpg","nickname":"孔令飞","note":"","ucode":"8363EA4BD0AAF0","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":522336,"discussion_content":"网关做的是接口鉴权，也就是哪个用户/密钥可以访问哪个接口。而IAM做的是资源鉴权。例如淘宝中的iphone资源等","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1624708906,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1592279,"avatar":"https://static001.geekbang.org/account/avatar/00/18/4b/d7/f46c6dfd.jpg","nickname":"William Ning","note":"","ucode":"4DB8D05E69E5F3","race_medal":0,"user_type":1,"is_pvip":true},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":571852,"discussion_content":"FYI\n接口鉴权实现的是认证功能，IAM实现的是认证+授权","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1652430348,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":2536820,"avatar":"https://static001.geekbang.org/account/avatar/00/26/b5/74/cd80b9f4.jpg","nickname":"友","note":"","ucode":"972A4333A8B101","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":539472,"discussion_content":"可不可以理解为 我访问腾讯云cos的资源  没有权限就无法访问这意思 我作为cos的用户 我可以设置 资源访问策略 是私有写 公有读  或者私有读私有写","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1639725395,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":296976,"user_name":"Sch0ng","can_delete":false,"product_type":"c1","uid":1145554,"ip_address":"","ucode":"73F6113931B1AC","user_header":"https://static001.geekbang.org/account/avatar/00/11/7a/d2/4ba67c0c.jpg","comment_is_top":false,"comment_ctime":1623247001,"is_pvip":false,"replies":[{"id":"107882","content":"老哥，理解的很到位!","user_name":"作者回复","comment_id":296976,"uid":"1167883","ip_address":"","utype":1,"ctime":1623287807,"user_name_real":"CK1.0"}],"discussion_count":1,"race_medal":0,"score":"27393050777","product_id":100079601,"comment_content":"目标是go工程，IAM只是一个支点。对IAM暂且理解个大概，能跟得上后面的学习即可。学完整个专栏，go工程能力更完善即可，顺带理解IAM更多细节，岂不是美滋滋。","like_count":6,"discussions":[{"author":{"id":1167883,"avatar":"https://static001.geekbang.org/account/avatar/00/11/d2/0b/cdd0787a.jpg","nickname":"孔令飞","note":"","ucode":"8363EA4BD0AAF0","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":521667,"discussion_content":"老哥，理解的很到位!","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1623287807,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":294846,"user_name":"Nio","can_delete":false,"product_type":"c1","uid":1529642,"ip_address":"","ucode":"A1B8D3C01FB937","user_header":"https://static001.geekbang.org/account/avatar/00/17/57/2a/c6c95f37.jpg","comment_is_top":false,"comment_ctime":1622108888,"is_pvip":true,"replies":[{"id":"107035","content":"Nio理解的很正确!","user_name":"作者回复","comment_id":294846,"uid":"1167883","ip_address":"","utype":1,"ctime":1622114902,"user_name_real":"CK1.0"}],"discussion_count":1,"race_medal":4,"score":"27391912664","product_id":100079601,"comment_content":"IAM只是我们学习这个专栏的小工具，主要还是借助这个项目学习go语言项目的设计及思想以及具体实现，其中这些理论能力会体现在项目的各个实现细节中，是这个意思吧","like_count":6,"discussions":[{"author":{"id":1167883,"avatar":"https://static001.geekbang.org/account/avatar/00/11/d2/0b/cdd0787a.jpg","nickname":"孔令飞","note":"","ucode":"8363EA4BD0AAF0","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":520839,"discussion_content":"Nio理解的很正确!","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1622114902,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":300461,"user_name":"Fis.","can_delete":false,"product_type":"c1","uid":1711895,"ip_address":"","ucode":"6168F5A759C069","user_header":"https://static001.geekbang.org/account/avatar/00/1a/1f/17/f2a69e62.jpg","comment_is_top":false,"comment_ctime":1625185518,"is_pvip":false,"replies":[{"id":"108960","content":"sdk可以对接iam-apiserver和iam-authz-server。<br>authz和api server分离的优点，其实是：数据流和控制流的分离。<br><br>这样做的好处如下：<br><br>1. 控制流主要是用来做资源的CURD，如果控制流服务出故障，会影响用户的使用，但不会影响用户的业务。<br>2. 数据流出故障会影响用户的业务。<br><br>对于一个系统来说，影响用户业务是很严重的事情，而且我们日常变更最多的是控制流服务，控制流和数据流分离，使得我们发布变更控制流服务时，不会影响到数据流服务，也即不会影响用户的业务。","user_name":"作者回复","comment_id":300461,"uid":"1167883","ip_address":"","utype":1,"ctime":1625389334,"user_name_real":"CK1.0"}],"discussion_count":3,"race_medal":0,"score":"23100021998","product_id":100079601,"comment_content":"我理解authz是面向用户的借口，apiserver是核心处理模块，sdk不直接对接apiserver吗？authz和api server分离设计的优点是什么？另外authz从redis获取数据，那不是有可能读到过期数据？（比如当时写入请求还在写入mysql过程中，还没同步到redis）","like_count":5,"discussions":[{"author":{"id":1592279,"avatar":"https://static001.geekbang.org/account/avatar/00/18/4b/d7/f46c6dfd.jpg","nickname":"William Ning","note":"","ucode":"4DB8D05E69E5F3","race_medal":0,"user_type":1,"is_pvip":true},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":571866,"discussion_content":"\nFYI\nwaterjiao\n有两个问题，想咨询下，\n第一，当用户请求 API 完成资源授权时，如果这时他的权限和策略被更改了，但是由于iam-authz-server 监听消息慢导致了授权成功，对于这种情况，是不处理呢，还是增加机制保证呢？\n\n作者回复:\n1. 这种情况可以不用处理，因为iam-authz-server本身监听消息是毫秒级的。另外，既然之前是允许访问的，现在改成不允许访问，也就是说这几十毫秒的延时是可以接受的。","likes_number":1,"is_delete":false,"is_hidden":false,"ctime":1652434210,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1167883,"avatar":"https://static001.geekbang.org/account/avatar/00/11/d2/0b/cdd0787a.jpg","nickname":"孔令飞","note":"","ucode":"8363EA4BD0AAF0","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":522739,"discussion_content":"sdk可以对接iam-apiserver和iam-authz-server。\nauthz和api server分离的优点，其实是：数据流和控制流的分离。\n\n这样做的好处如下：\n\n1. 控制流主要是用来做资源的CURD，如果控制流服务出故障，会影响用户的使用，但不会影响用户的业务。\n2. 数据流出故障会影响用户的业务。\n\n对于一个系统来说，影响用户业务是很严重的事情，而且我们日常变更最多的是控制流服务，控制流和数据流分离，使得我们发布变更控制流服务时，不会影响到数据流服务，也即不会影响用户的业务。","likes_number":1,"is_delete":false,"is_hidden":false,"ctime":1625389334,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1711895,"avatar":"https://static001.geekbang.org/account/avatar/00/1a/1f/17/f2a69e62.jpg","nickname":"Fis.","note":"","ucode":"6168F5A759C069","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":382073,"discussion_content":"嗯嗯，谢谢老师。控制流也就是管理面故障的话，无法修改授权策略，但是还可以从redis查询授权策略。那还是上面的第二个问题，mysql和redis数据怎么确保同步，写mysql时候会给redis对应数据同步加锁吗？","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1625402472,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":296824,"user_name":"helloworld","can_delete":false,"product_type":"c1","uid":1105161,"ip_address":"","ucode":"1EECCA0F43E278","user_header":"https://static001.geekbang.org/account/avatar/00/10/dd/09/feca820a.jpg","comment_is_top":false,"comment_ctime":1623170397,"is_pvip":false,"replies":[{"id":"107880","content":"跟网关的认证功能是一样的，iam的认证功能也是参考了tyk网关的实现。<br><br>跟网关的鉴权还是有些区别，iam是对资源鉴权，网关是对api鉴权，就是谁能或不能调用哪个api接口。","user_name":"作者回复","comment_id":296824,"uid":"1167883","ip_address":"","utype":1,"ctime":1623287629,"user_name_real":"CK1.0"}],"discussion_count":1,"race_medal":0,"score":"23098006877","product_id":100079601,"comment_content":"iam这个认证与资源授权系统和网关的认证与鉴权功能有何本质区别呢","like_count":5,"discussions":[{"author":{"id":1167883,"avatar":"https://static001.geekbang.org/account/avatar/00/11/d2/0b/cdd0787a.jpg","nickname":"孔令飞","note":"","ucode":"8363EA4BD0AAF0","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":521598,"discussion_content":"跟网关的认证功能是一样的，iam的认证功能也是参考了tyk网关的实现。\n\n跟网关的鉴权还是有些区别，iam是对资源鉴权，网关是对api鉴权，就是谁能或不能调用哪个api接口。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1623287629,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":296146,"user_name":"dll","can_delete":false,"product_type":"c1","uid":1264401,"ip_address":"","ucode":"5773CBC8BFB91F","user_header":"https://static001.geekbang.org/account/avatar/00/13/4b/11/d7e08b5b.jpg","comment_is_top":false,"comment_ctime":1622776883,"is_pvip":true,"replies":[{"id":"107540","content":"管理员注册iam系统，并登录系统，创建密钥对和策略。密钥对分发给其他人，其他人通过密钥对进行资源授权，授权时填写自己的用户名就可以了。<br><br>Jwt是iam认证的方式","user_name":"作者回复","comment_id":296146,"uid":"1167883","ip_address":"","utype":1,"ctime":1622951899,"user_name_real":"CK1.0"}],"discussion_count":1,"race_medal":0,"score":"23097613363","product_id":100079601,"comment_content":"不太明白，怎么同意这个用户创建并给密钥对，并给到对应的权限策略，这个步骤不需要人来同意吗？如果谁都能注册自己选择权限，那不是很危险？这个aim和jwt有什么关系","like_count":5,"discussions":[{"author":{"id":1167883,"avatar":"https://static001.geekbang.org/account/avatar/00/11/d2/0b/cdd0787a.jpg","nickname":"孔令飞","note":"","ucode":"8363EA4BD0AAF0","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":521338,"discussion_content":"管理员注册iam系统，并登录系统，创建密钥对和策略。密钥对分发给其他人，其他人通过密钥对进行资源授权，授权时填写自己的用户名就可以了。\n\nJwt是iam认证的方式","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1622951899,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":296902,"user_name":"qiaocc","can_delete":false,"product_type":"c1","uid":1510656,"ip_address":"","ucode":"C8EAD84757D11C","user_header":"https://static001.geekbang.org/account/avatar/00/17/0d/00/d07ea760.jpg","comment_is_top":false,"comment_ctime":1623219581,"is_pvip":false,"replies":[{"id":"107881","content":"machinery  和 gocelery 了解下。","user_name":"作者回复","comment_id":296902,"uid":"1167883","ip_address":"","utype":1,"ctime":1623287776,"user_name_real":"CK1.0"}],"discussion_count":1,"race_medal":0,"score":"14508121469","product_id":100079601,"comment_content":"异步消费没有用过。 python里面有用过celery， go里面有类似的第三方包吗","like_count":3,"discussions":[{"author":{"id":1167883,"avatar":"https://static001.geekbang.org/account/avatar/00/11/d2/0b/cdd0787a.jpg","nickname":"孔令飞","note":"","ucode":"8363EA4BD0AAF0","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":521636,"discussion_content":"machinery  和 gocelery 了解下。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1623287776,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":295092,"user_name":"Vackine","can_delete":false,"product_type":"c1","uid":1139588,"ip_address":"","ucode":"8E412EE82D3B59","user_header":"https://static001.geekbang.org/account/avatar/00/11/63/84/f45c4af9.jpg","comment_is_top":false,"comment_ctime":1622214882,"is_pvip":false,"replies":[{"id":"107217","content":"一直保存在mysql数据库中，登录用户名密码登录系统获取临时密钥保存在客户端，默认2小时过期。后面的通信全都走https，通过认证，https，过期时间来保证安全性","user_name":"作者回复","comment_id":295092,"uid":"1167883","ip_address":"","utype":1,"ctime":1622435235,"user_name_real":"CK1.0"}],"discussion_count":1,"race_medal":0,"score":"14507116770","product_id":100079601,"comment_content":"iam 存储的密钥是创建了之后就是静态的一直存在mysql的么？会不会有密钥截获的风险？还是每个密钥有超时时间？","like_count":3,"discussions":[{"author":{"id":1167883,"avatar":"https://static001.geekbang.org/account/avatar/00/11/d2/0b/cdd0787a.jpg","nickname":"孔令飞","note":"","ucode":"8363EA4BD0AAF0","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":520946,"discussion_content":"一直保存在mysql数据库中，登录用户名密码登录系统获取临时密钥保存在客户端，默认2小时过期。后面的通信全都走https，通过认证，https，过期时间来保证安全性","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1622435235,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":294922,"user_name":"arch","can_delete":false,"product_type":"c1","uid":1078931,"ip_address":"","ucode":"A69EBFE0520B85","user_header":"https://static001.geekbang.org/account/avatar/00/10/76/93/64ed7385.jpg","comment_is_top":false,"comment_ctime":1622131087,"is_pvip":true,"replies":[{"id":"107142","content":"授权模型不一样。<br>CAM是ABAC。<br>IAM授权模型类似于RBAC和ACL","user_name":"作者回复","comment_id":294922,"uid":"1167883","ip_address":"","utype":1,"ctime":1622253828,"user_name_real":"CK1.0"}],"discussion_count":1,"race_medal":0,"score":"14507032975","product_id":100079601,"comment_content":"令飞老师，腾讯云的CAM和IAM系统有什么区别吗？","like_count":4,"discussions":[{"author":{"id":1167883,"avatar":"https://static001.geekbang.org/account/avatar/00/11/d2/0b/cdd0787a.jpg","nickname":"孔令飞","note":"","ucode":"8363EA4BD0AAF0","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":520872,"discussion_content":"授权模型不一样。\nCAM是ABAC。\nIAM授权模型类似于RBAC和ACL","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1622253828,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":310614,"user_name":"types","can_delete":false,"product_type":"c1","uid":2449777,"ip_address":"","ucode":"8B50927EF1804F","user_header":"https://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTLDUJyeq54fiaXAgF62tNeocO3lHsKT4mygEcNoZLnibg6ONKicMgCgUHSfgW8hrMUXlwpNSzR8MHZwg/132","comment_is_top":false,"comment_ctime":1630774223,"is_pvip":false,"replies":[{"id":"112565","content":"1. 在apiserver中创建密钥对，authz服务会自动将新创建的秘钥信息从apiserver中拉去，并缓存在authz的内存中。<br><br>jwt token可以使用iamctl jwt sign &lt;secretID&gt; &lt;secretKey&gt;来创建。<br>也可以通过网上的在线工具来创建<br>还可以自己编写jwt token生成代码。<br>jwt token的创建是有一定规则的，所以只要满足jwt token规则的工具都可以创建。<br><br>直接回答你的问题：jwt token由APP侧来创建<br><br>2. APP需要知道secretId和secretKey。<br>通过secretId和secretKey，再加上jwt token固定的生成规则，就可以创建jwt token用于请求。 ","user_name":"作者回复","comment_id":310614,"uid":"1167883","ip_address":"","utype":1,"ctime":1630862595,"user_name_real":"CK1.0"}],"discussion_count":1,"race_medal":0,"score":"10220708815","product_id":100079601,"comment_content":"关于秘钥对有几个问题不太明白<br>按照文中所讲，密钥对是在控制平面中创建<br>1. 根据后面的文章，数据流中（authz）是基于JWT认证的<br>请问秘钥对如何进行用于JWT，jwt token是谁负责创建的APP还是authz server<br>2. 秘钥对包含secretId，secretKey<br>请问APP包含密钥对的什么信息，是如何提供给APP的？","like_count":2,"discussions":[{"author":{"id":1167883,"avatar":"https://static001.geekbang.org/account/avatar/00/11/d2/0b/cdd0787a.jpg","nickname":"孔令飞","note":"","ucode":"8363EA4BD0AAF0","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":526291,"discussion_content":"1. 在apiserver中创建密钥对，authz服务会自动将新创建的秘钥信息从apiserver中拉去，并缓存在authz的内存中。\n\njwt token可以使用iamctl jwt sign &amp;lt;secretID&amp;gt; &amp;lt;secretKey&amp;gt;来创建。\n也可以通过网上的在线工具来创建\n还可以自己编写jwt token生成代码。\njwt token的创建是有一定规则的，所以只要满足jwt token规则的工具都可以创建。\n\n直接回答你的问题：jwt token由APP侧来创建\n\n2. APP需要知道secretId和secretKey。\n通过secretId和secretKey，再加上jwt token固定的生成规则，就可以创建jwt token用于请求。 ","likes_number":1,"is_delete":false,"is_hidden":false,"ctime":1630862595,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":301000,"user_name":"awmthink","can_delete":false,"product_type":"c1","uid":1331202,"ip_address":"","ucode":"742915BBCE7111","user_header":"https://static001.geekbang.org/account/avatar/00/14/50/02/cce1cf67.jpg","comment_is_top":false,"comment_ctime":1625480557,"is_pvip":false,"replies":[{"id":"109230","content":"1) 密钥对还不是JWT，密钥对包含secretId，secretKey。<br><br>secretKey可以用来签发Token（JWT），secretId可以使服务端根据secretId查找服务端保存的secretKey，反签发Token，对比2个token是否一致，完成认证。<br><br>2） 用密钥对访问授权接口，这里的密钥对可以签发JWT Token，iam-authz-server判断该Token是否能访问&#47;v1&#47;authz接口。如果能访问，接下来才会进行资源授权的流程。一个是认证，一个是资源授权。","user_name":"作者回复","comment_id":301000,"uid":"1167883","ip_address":"","utype":1,"ctime":1625852123,"user_name_real":"CK1.0"}],"discussion_count":1,"race_medal":0,"score":"10215415149","product_id":100079601,"comment_content":"老师，初步接触Web业务开发，对这一节中 IAM 系统的资源授权的流程图有2个疑问：<br>1) 步骤2中的创建密钥对，我理解其实就是JWT吧，只是一个token，和用户名一起构成了密钥对吗？<br>2) 图片步骤4，用密钥对去访问授权接口，这个不是用户直接访问吧，应该是用户用密钥对去访问资源时，由资源实时控制服务去调用authzServer来验证用户是否有权限来访问该资源？","like_count":2,"discussions":[{"author":{"id":1167883,"avatar":"https://static001.geekbang.org/account/avatar/00/11/d2/0b/cdd0787a.jpg","nickname":"孔令飞","note":"","ucode":"8363EA4BD0AAF0","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":522871,"discussion_content":"1) 密钥对还不是JWT，密钥对包含secretId，secretKey。\n\nsecretKey可以用来签发Token（JWT），secretId可以使服务端根据secretId查找服务端保存的secretKey，反签发Token，对比2个token是否一致，完成认证。\n\n2） 用密钥对访问授权接口，这里的密钥对可以签发JWT Token，iam-authz-server判断该Token是否能访问/v1/authz接口。如果能访问，接下来才会进行资源授权的流程。一个是认证，一个是资源授权。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1625852123,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":297030,"user_name":"helloworld","can_delete":false,"product_type":"c1","uid":1105161,"ip_address":"","ucode":"1EECCA0F43E278","user_header":"https://static001.geekbang.org/account/avatar/00/10/dd/09/feca820a.jpg","comment_is_top":false,"comment_ctime":1623288126,"is_pvip":false,"replies":[{"id":"107911","content":"可以的哦，它就是个微服务","user_name":"作者回复","comment_id":297030,"uid":"1167883","ip_address":"","utype":1,"ctime":1623321458,"user_name_real":"CK1.0"}],"discussion_count":1,"race_medal":0,"score":"10213222718","product_id":100079601,"comment_content":"iam可以用于微服务吗，就是n多个应用使用同一套iam为各自应用内的资源对用户授权","like_count":2,"discussions":[{"author":{"id":1167883,"avatar":"https://static001.geekbang.org/account/avatar/00/11/d2/0b/cdd0787a.jpg","nickname":"孔令飞","note":"","ucode":"8363EA4BD0AAF0","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":521689,"discussion_content":"可以的哦，它就是个微服务","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1623321458,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":296901,"user_name":"qiaocc","can_delete":false,"product_type":"c1","uid":1510656,"ip_address":"","ucode":"C8EAD84757D11C","user_header":"https://static001.geekbang.org/account/avatar/00/17/0d/00/d07ea760.jpg","comment_is_top":false,"comment_ctime":1623219536,"is_pvip":false,"replies":[{"id":"107879","content":"授权策略是一个策略，里面说明了，谁能&#47;不能对哪些资源做哪些操作。<br><br>对资源的授权，是一个动作，例如，小明删除密钥。<br><br>对资源的授权是通过验证授权策略来实现的","user_name":"作者回复","user_name_real":"CK1.0","uid":"1167883","ctime":1623287434,"ip_address":"","comment_id":296901,"utype":1}],"discussion_count":1,"race_medal":0,"score":"10213154128","product_id":100079601,"comment_content":"1. 授权策略 2. 对资源的授权， 这两个有什么区别呀，能举个例子吗？","like_count":3,"discussions":[{"author":{"id":1167883,"avatar":"https://static001.geekbang.org/account/avatar/00/11/d2/0b/cdd0787a.jpg","nickname":"孔令飞","note":"","ucode":"8363EA4BD0AAF0","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":521635,"discussion_content":"授权策略是一个策略，里面说明了，谁能/不能对哪些资源做哪些操作。\n\n对资源的授权，是一个动作，例如，小明删除密钥。\n\n对资源的授权是通过验证授权策略来实现的","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1623287434,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":294838,"user_name":"冯甜莉","can_delete":false,"product_type":"c1","uid":2640588,"ip_address":"","ucode":"9E874E134BBA4C","user_header":"https://static001.geekbang.org/account/avatar/00/28/4a/cc/f152373f.jpg","comment_is_top":false,"comment_ctime":1622106755,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"10212041347","product_id":100079601,"comment_content":"api-server提供全部的资源接口，基于api-server 公开RestFulApi完成授权存储sql，独立auth服务与api-server通过GRPC同步授权策略，完成资源授权；<br>肯定存在授权策略的构成多元需求带来的复杂性，资源授权占用内存及同步失败补偿措施，多台服务同步交互机制。","like_count":2},{"had_liked":false,"id":345332,"user_name":"六神丸","can_delete":false,"product_type":"c1","uid":2686828,"ip_address":"","ucode":"B6A9F1CE998427","user_header":"https://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTKcGxibqN07pL6hibEd7hn0orvr6JibNVYMHR1MCU05hGXMDtViaW7UVewnuRsw5PlbM9hf871rTJIDFw/132","comment_is_top":false,"comment_ctime":1652194810,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"5947162106","product_id":100079601,"comment_content":"老师，我浏览了您的回答：<br>其中说到iam是对资源鉴权，网关是对api鉴权；那么，如果我们的项目既要做api鉴权，又要做资源鉴权，这时需要怎么做？ <br>我想到的做法：<br>①前端登录两个系统，两个系统相互独立，使用两个jwt；②把api网关做在iam系统中，使用过一套jwt；<br>那种更合理？或者都不合理，大致需要怎么做？","like_count":1},{"had_liked":false,"id":307130,"user_name":"进化菌","can_delete":false,"product_type":"c1","uid":1276861,"ip_address":"","ucode":"B30A5F78BB4171","user_header":"https://static001.geekbang.org/account/avatar/00/13/7b/bd/ccb37425.jpg","comment_is_top":false,"comment_ctime":1628901732,"is_pvip":true,"discussion_count":0,"race_medal":5,"score":"5923869028","product_id":100079601,"comment_content":"用户身份识别和授权，几乎贯穿了后台开发的大部分项目。这不仅仅是一个golang的实战，还能重新思考权限控制的设计，赞！","like_count":2},{"had_liked":false,"id":299854,"user_name":"乳酸菌","can_delete":false,"product_type":"c1","uid":2435385,"ip_address":"","ucode":"29286DC24F8264","user_header":"https://static001.geekbang.org/account/avatar/00/25/29/39/59f9d41c.jpg","comment_is_top":false,"comment_ctime":1624884619,"is_pvip":false,"replies":[{"id":"108968","content":"重要区别：<br>MVC总的controller层不做具体的业务逻辑处理，主要用来做请求逻辑分发，可以把业务逻辑具体实现放在类似service这样的包中。在controller引用这个包。<br>三层架构中的BLL层，是用来做业务处理的。<br><br>还有其它区别，具体可以google下。","user_name":"作者回复","user_name_real":"CK1.0","uid":"1167883","ctime":1625391128,"ip_address":"","comment_id":299854,"utype":1}],"discussion_count":1,"race_medal":0,"score":"5919851915","product_id":100079601,"comment_content":"始终没有理解MVC 和三层架构的区别，老师有例子能加深理解吗？","like_count":1,"discussions":[{"author":{"id":1167883,"avatar":"https://static001.geekbang.org/account/avatar/00/11/d2/0b/cdd0787a.jpg","nickname":"孔令飞","note":"","ucode":"8363EA4BD0AAF0","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":522564,"discussion_content":"重要区别：\nMVC总的controller层不做具体的业务逻辑处理，主要用来做请求逻辑分发，可以把业务逻辑具体实现放在类似service这样的包中。在controller引用这个包。\n三层架构中的BLL层，是用来做业务处理的。\n\n还有其它区别，具体可以google下。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1625391128,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":297693,"user_name":"Geek_a4cca6","can_delete":false,"product_type":"c1","uid":2136813,"ip_address":"","ucode":"68B3E4FDECFFF0","user_header":"https://thirdwx.qlogo.cn/mmopen/vi_32/5GQZCecntmOibVjWkMWVnibqXEZhAYnFiaRkgfAUGdrQBWzfXjqsYteLee6afDEjvBLBVa5uvtWYTTicwO2jKia0zOw/132","comment_is_top":false,"comment_ctime":1623734826,"is_pvip":false,"replies":[{"id":"108118","content":"是先罗列知识点，再设计这个项目","user_name":"作者回复","user_name_real":"CK1.0","uid":"1167883","ctime":1623773735,"ip_address":"","comment_id":297693,"utype":1}],"discussion_count":2,"race_medal":0,"score":"5918702122","product_id":100079601,"comment_content":"看完这二章就有点小激动，如果真的有这么多知识点的话，以前做的项目最多也就接触到redis，sdk，老师将小的知识点弄成一个小项目来学习，这效果很好","like_count":1,"discussions":[{"author":{"id":1167883,"avatar":"https://static001.geekbang.org/account/avatar/00/11/d2/0b/cdd0787a.jpg","nickname":"孔令飞","note":"","ucode":"8363EA4BD0AAF0","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":521908,"discussion_content":"是先罗列知识点，再设计这个项目","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1623773735,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":2028811,"avatar":"https://static001.geekbang.org/account/avatar/00/1e/f5/0b/73628618.jpg","nickname":"兔嘟嘟","note":"","ucode":"5A9042B4C7670C","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":401248,"discussion_content":"估计就讲讲重点源码hhh","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1633611894,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":297661,"user_name":"zlel","can_delete":false,"product_type":"c1","uid":2139471,"ip_address":"","ucode":"D98D44B933D6D5","user_header":"https://static001.geekbang.org/account/avatar/00/20/a5/4f/772dd0f3.jpg","comment_is_top":false,"comment_ctime":1623719294,"is_pvip":false,"replies":[{"id":"108120","content":"不会的，不管是db还是redis非法用户是访问不到的","user_name":"作者回复","user_name_real":"CK1.0","uid":"1167883","ctime":1623773825,"ip_address":"","comment_id":297661,"utype":1}],"discussion_count":1,"race_medal":0,"score":"5918686590","product_id":100079601,"comment_content":"用户密钥除了db在中保存，也在redis中保存，这样会不会不太安全？","like_count":1,"discussions":[{"author":{"id":1167883,"avatar":"https://static001.geekbang.org/account/avatar/00/11/d2/0b/cdd0787a.jpg","nickname":"孔令飞","note":"","ucode":"8363EA4BD0AAF0","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":521897,"discussion_content":"不会的，不管是db还是redis非法用户是访问不到的","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1623773825,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":297652,"user_name":"大师兄","can_delete":false,"product_type":"c1","uid":2171383,"ip_address":"","ucode":"D245FED96F663A","user_header":"https://static001.geekbang.org/account/avatar/00/21/21/f7/aaa19872.jpg","comment_is_top":false,"comment_ctime":1623695988,"is_pvip":false,"replies":[{"id":"108121","content":"通过教同学开发一个iam系统来学习go项目开发","user_name":"作者回复","user_name_real":"CK1.0","uid":"1167883","ctime":1623773866,"ip_address":"","comment_id":297652,"utype":1}],"discussion_count":1,"race_medal":0,"score":"5918663284","product_id":100079601,"comment_content":"这个课程是教同学开发一个IAM系统还是对已有的IAM系统进行对接开发？","like_count":1,"discussions":[{"author":{"id":1167883,"avatar":"https://static001.geekbang.org/account/avatar/00/11/d2/0b/cdd0787a.jpg","nickname":"孔令飞","note":"","ucode":"8363EA4BD0AAF0","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":521893,"discussion_content":"通过教同学开发一个iam系统来学习go项目开发","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1623773866,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":297204,"user_name":"poettian","can_delete":false,"product_type":"c1","uid":1144021,"ip_address":"","ucode":"26EE408F908D12","user_header":"https://static001.geekbang.org/account/avatar/00/11/74/d5/de9641dc.jpg","comment_is_top":false,"comment_ctime":1623376451,"is_pvip":false,"replies":[{"id":"108018","content":"对的","user_name":"作者回复","user_name_real":"CK1.0","uid":"1167883","ctime":1623582893,"ip_address":"","comment_id":297204,"utype":1}],"discussion_count":1,"race_medal":0,"score":"5918343747","product_id":100079601,"comment_content":"对“授权”这两个字比较迷惑，文中的意思是指访问资源并做鉴权吗？","like_count":1,"discussions":[{"author":{"id":1167883,"avatar":"https://static001.geekbang.org/account/avatar/00/11/d2/0b/cdd0787a.jpg","nickname":"孔令飞","note":"","ucode":"8363EA4BD0AAF0","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":521760,"discussion_content":"对的","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1623582893,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":297190,"user_name":"西二旗啤酒王","can_delete":false,"product_type":"c1","uid":1005131,"ip_address":"","ucode":"E064F32437812C","user_header":"https://static001.geekbang.org/account/avatar/00/0f/56/4b/31369ca6.jpg","comment_is_top":false,"comment_ctime":1623371656,"is_pvip":false,"replies":[{"id":"108019","content":"访问iam-authz-server时生成token，做认证使用","user_name":"作者回复","user_name_real":"CK1.0","uid":"1167883","ctime":1623582965,"ip_address":"","comment_id":297190,"utype":1}],"discussion_count":1,"race_medal":0,"score":"5918338952","product_id":100079601,"comment_content":"有几个疑问，一个用户可以创建多个不同权限的秘钥对？密钥对的作用是什么？","like_count":1,"discussions":[{"author":{"id":1167883,"avatar":"https://static001.geekbang.org/account/avatar/00/11/d2/0b/cdd0787a.jpg","nickname":"孔令飞","note":"","ucode":"8363EA4BD0AAF0","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":521755,"discussion_content":"访问iam-authz-server时生成token，做认证使用","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1623582965,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":356067,"user_name":"season","can_delete":false,"product_type":"c1","uid":2894734,"ip_address":"浙江","ucode":"1CBBFCC58A245E","user_header":"https://static001.geekbang.org/account/avatar/00/2c/2b/8e/4d24c872.jpg","comment_is_top":false,"comment_ctime":1661944350,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1661944350","product_id":100079601,"comment_content":"三层架构 和 MVC 架构的区别是什么？  不太能区分这两个架构","like_count":0},{"had_liked":false,"id":353015,"user_name":"Jone_乔泓恺","can_delete":false,"product_type":"c1","uid":1407941,"ip_address":"陕西","ucode":"158154301D5E40","user_header":"https://static001.geekbang.org/account/avatar/00/15/7b/c5/35f92dad.jpg","comment_is_top":false,"comment_ctime":1659079899,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1659079899","product_id":100079601,"comment_content":"老师，有个问题请教下：比如，现在要做一个电商 app，其中有用户管理（iam），商品管理和订单管理等功能，那么 ，我的项目要怎么规范服务呢？是在一个项目中创建不同的服务（cmd）？还是分成一个 iam 项目和其他功能的项目？","like_count":0},{"had_liked":false,"id":352051,"user_name":"莫鸣之名","can_delete":false,"product_type":"c1","uid":1780608,"ip_address":"","ucode":"604202E40E9AA5","user_header":"https://static001.geekbang.org/account/avatar/00/1b/2b/80/2535381c.jpg","comment_is_top":false,"comment_ctime":1658366571,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1658366571","product_id":100079601,"comment_content":"老师，有学习的群吗？","like_count":0},{"had_liked":false,"id":351857,"user_name":"顺势而为","can_delete":false,"product_type":"c1","uid":2757858,"ip_address":"","ucode":"FE7D688D24823E","user_header":"https://static001.geekbang.org/account/avatar/00/2a/14/e2/f6f1627c.jpg","comment_is_top":false,"comment_ctime":1658231337,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1658231337","product_id":100079601,"comment_content":"1.这样的架构，容易扩展，但是如果是小项目来说，链路是否过长。","like_count":0},{"had_liked":false,"id":351856,"user_name":"顺势而为","can_delete":false,"product_type":"c1","uid":2757858,"ip_address":"","ucode":"FE7D688D24823E","user_header":"https://static001.geekbang.org/account/avatar/00/2a/14/e2/f6f1627c.jpg","comment_is_top":false,"comment_ctime":1658231307,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1658231307","product_id":100079601,"comment_content":"1.日志消费为什么没有kafka，MQ这些队列？<br>2.除了MVC之外的，M层是否要分数据库事务层client和逻辑处理层service？<br>","like_count":0},{"had_liked":false,"id":351855,"user_name":"顺势而为","can_delete":false,"product_type":"c1","uid":2757858,"ip_address":"","ucode":"FE7D688D24823E","user_header":"https://static001.geekbang.org/account/avatar/00/2a/14/e2/f6f1627c.jpg","comment_is_top":false,"comment_ctime":1658231190,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1658231190","product_id":100079601,"comment_content":"为什么要消费redis，存储到mongoDB中。而不是直接存储在数据库中，采用异步存储呢？异步可能带来什么问题？","like_count":0},{"had_liked":false,"id":346382,"user_name":"夜影","can_delete":false,"product_type":"c1","uid":1049179,"ip_address":"","ucode":"451BAD1DE17D67","user_header":"https://static001.geekbang.org/account/avatar/00/10/02/5b/2dd41066.jpg","comment_is_top":false,"comment_ctime":1653097141,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1653097141","product_id":100079601,"comment_content":"看不出前后端分离跟MVC有啥冲突，也不是非黑即白那种关系。一个是架构，一个是开发模式","like_count":0},{"had_liked":false,"id":345620,"user_name":"William Ning","can_delete":false,"product_type":"c1","uid":1592279,"ip_address":"","ucode":"4DB8D05E69E5F3","user_header":"https://static001.geekbang.org/account/avatar/00/18/4b/d7/f46c6dfd.jpg","comment_is_top":false,"comment_ctime":1652434812,"is_pvip":true,"discussion_count":0,"race_medal":0,"score":"1652434812","product_id":100079601,"comment_content":"本来是学习Go的，结果认证+授权，一直是理不清的，一直看评论学习～","like_count":0},{"had_liked":false,"id":344751,"user_name":"core","can_delete":false,"product_type":"c1","uid":2533350,"ip_address":"","ucode":"5E6CAB578C6DE0","user_header":"https://static001.geekbang.org/account/avatar/00/26/a7/e6/6692d7ef.jpg","comment_is_top":false,"comment_ctime":1651750565,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1651750565","product_id":100079601,"comment_content":"梦中情课","like_count":0},{"had_liked":false,"id":344200,"user_name":"maple-0406","can_delete":false,"product_type":"c1","uid":1197608,"ip_address":"","ucode":"7191D06449B6B6","user_header":"https://static001.geekbang.org/account/avatar/00/12/46/28/14ef7207.jpg","comment_is_top":false,"comment_ctime":1651368980,"is_pvip":true,"discussion_count":0,"race_medal":0,"score":"1651368980","product_id":100079601,"comment_content":"我们做的项目通常比较简单，属于go web开发， mysql存储即可。<br>感觉我们也比较像 伪三层架构，因为我们在开发过程中并没有明确定义，层与层之间的边界关系确定，还是依赖个人经验或者感觉。","like_count":0},{"had_liked":false,"id":342815,"user_name":"咆哮","can_delete":false,"product_type":"c1","uid":1019974,"ip_address":"","ucode":"845D25D9FD1AFB","user_header":"https://static001.geekbang.org/account/avatar/00/0f/90/46/c1ecf3b9.jpg","comment_is_top":false,"comment_ctime":1650471535,"is_pvip":true,"replies":[{"id":"125521","content":"会有的。可以使用CMQ、NSQ这些消息中间件","user_name":"作者回复","user_name_real":"编辑","uid":"1167883","ctime":1651078003,"ip_address":"","comment_id":342815,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1650471535","product_id":100079601,"comment_content":"对于IAM这种重要系统，使用redis 订阅这种方式是不是对稳定性和可靠性产生影响","like_count":0,"discussions":[{"author":{"id":1167883,"avatar":"https://static001.geekbang.org/account/avatar/00/11/d2/0b/cdd0787a.jpg","nickname":"孔令飞","note":"","ucode":"8363EA4BD0AAF0","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":568212,"discussion_content":"会有的。可以使用CMQ、NSQ这些消息中间件","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1651078003,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":341717,"user_name":"梯田","can_delete":false,"product_type":"c1","uid":1021683,"ip_address":"","ucode":"671236E62375D2","user_header":"https://static001.geekbang.org/account/avatar/00/0f/96/f3/a4a680da.jpg","comment_is_top":false,"comment_ctime":1649804016,"is_pvip":false,"discussion_count":1,"race_medal":0,"score":"1649804016","product_id":100079601,"comment_content":"我以前经常把authorization authentication这两个单词的意思搞混，ahthor（作者）授权，剩下那个就是认证","like_count":0,"discussions":[{"author":{"id":1000237,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/43/2d/af86d73f.jpg","nickname":"enjoylearning","note":"","ucode":"DCAF8538DEA277","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":590765,"discussion_content":"前者是认证，后者是授权吧","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1666069773,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":"北京"},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":341443,"user_name":"希波莱","can_delete":false,"product_type":"c1","uid":2821148,"ip_address":"","ucode":"FCC9C209FFD3BD","user_header":"https://static001.geekbang.org/account/avatar/00/2b/0c/1c/07610986.jpg","comment_is_top":false,"comment_ctime":1649612353,"is_pvip":true,"replies":[{"id":"125538","content":"完全可以！","user_name":"作者回复","user_name_real":"编辑","uid":"1167883","ctime":1651079102,"ip_address":"","comment_id":341443,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1649612353","product_id":100079601,"comment_content":"学完之后可以实现一个基本的web saas吗","like_count":0,"discussions":[{"author":{"id":1167883,"avatar":"https://static001.geekbang.org/account/avatar/00/11/d2/0b/cdd0787a.jpg","nickname":"孔令飞","note":"","ucode":"8363EA4BD0AAF0","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":568229,"discussion_content":"完全可以！","likes_number":1,"is_delete":false,"is_hidden":false,"ctime":1651079102,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":341350,"user_name":"一步","can_delete":false,"product_type":"c1","uid":1005391,"ip_address":"","ucode":"73CEA468CE70C3","user_header":"https://static001.geekbang.org/account/avatar/00/0f/57/4f/6fb51ff1.jpg","comment_is_top":false,"comment_ctime":1649561352,"is_pvip":true,"replies":[{"id":"125539","content":"教程后面有讲解。<br><br>感觉具体跟项目有关，没有标准的划分。","user_name":"作者回复","user_name_real":"编辑","uid":"1167883","ctime":1651079179,"ip_address":"","comment_id":341350,"utype":1}],"discussion_count":1,"race_medal":1,"score":"1649561352","product_id":100079601,"comment_content":"老师在文章中画了一下系统图，分为数据流 和控制流两部分。 想请教一下 数据流 和控制流 是怎么进行划分的？ 哪一部分归属数据流 ，其他的归属为什么控制流？","like_count":0,"discussions":[{"author":{"id":1167883,"avatar":"https://static001.geekbang.org/account/avatar/00/11/d2/0b/cdd0787a.jpg","nickname":"孔令飞","note":"","ucode":"8363EA4BD0AAF0","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":568230,"discussion_content":"教程后面有讲解。\n\n感觉具体跟项目有关，没有标准的划分。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1651079179,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":341319,"user_name":"W-T","can_delete":false,"product_type":"c1","uid":1088973,"ip_address":"","ucode":"834869DA80D95B","user_header":"https://static001.geekbang.org/account/avatar/00/10/9d/cd/c21a01dd.jpg","comment_is_top":false,"comment_ctime":1649518049,"is_pvip":true,"replies":[{"id":"125540","content":"微软的visio","user_name":"作者回复","user_name_real":"编辑","uid":"1167883","ctime":1651079188,"ip_address":"","comment_id":341319,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1649518049","product_id":100079601,"comment_content":"问一下老师，文章中画的架构流程图用的是哪款工具来着","like_count":0,"discussions":[{"author":{"id":1167883,"avatar":"https://static001.geekbang.org/account/avatar/00/11/d2/0b/cdd0787a.jpg","nickname":"孔令飞","note":"","ucode":"8363EA4BD0AAF0","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":568232,"discussion_content":"微软的visio","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1651079188,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":334583,"user_name":".҉҉҉҉҉҉҉҉.        Jhonor","can_delete":false,"product_type":"c1","uid":1355051,"ip_address":"","ucode":"1C46996FD9CEA9","user_header":"https://static001.geekbang.org/account/avatar/00/14/ad/2b/812bf4ac.jpg","comment_is_top":false,"comment_ctime":1645005973,"is_pvip":true,"replies":[{"id":"123443","content":"专栏后面会介绍","user_name":"作者回复","user_name_real":"编辑","uid":"1167883","ctime":1647039274,"ip_address":"","comment_id":334583,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1645005973","product_id":100079601,"comment_content":"有没有相关的书籍文章课程推荐一下，还没弄清楚iam的使用场景，如何使用。举个例子，我们自己研发了好几套系统，以前最痛苦的是每个系统都要给使用者开通账号，非常麻烦。希望可以实现一个账号，可以使用多个系统。一个账号即可以是用户，也可以是服务提供商","like_count":0,"discussions":[{"author":{"id":1167883,"avatar":"https://static001.geekbang.org/account/avatar/00/11/d2/0b/cdd0787a.jpg","nickname":"孔令飞","note":"","ucode":"8363EA4BD0AAF0","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":555703,"discussion_content":"专栏后面会介绍","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1647039275,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":331806,"user_name":"drawping","can_delete":false,"product_type":"c1","uid":1007204,"ip_address":"","ucode":"A5F0E179CBA217","user_header":"https://static001.geekbang.org/account/avatar/00/0f/5e/64/1becc599.jpg","comment_is_top":false,"comment_ctime":1642778833,"is_pvip":false,"replies":[{"id":"121269","content":"1. iam-apiserver和ops-apiserver是2个不同组件，ops-apiserver是服务于ops-webconsole <br>2. ops-webconsole直接调用ops-apiserver，再由ops-apiserver通过grpc调用iam-apiserver。<br><br>你的理解完全正确。","user_name":"作者回复","user_name_real":"编辑","uid":"1167883","ctime":1642867994,"ip_address":"","comment_id":331806,"utype":1}],"discussion_count":2,"race_medal":0,"score":"1642778833","product_id":100079601,"comment_content":"1.ima-apiserver和ops-apiserver是两个不同组件吗？ops-apiserver是否只服务于ops-webconsole？<br>2. 假如ops-webconsole有创建用户的功能，是调用ima-apiserver的接口，还是调用ops-apiserver，再由ops-apiserver通过RPC调用ima-apiserver创建？","like_count":0,"discussions":[{"author":{"id":1167883,"avatar":"https://static001.geekbang.org/account/avatar/00/11/d2/0b/cdd0787a.jpg","nickname":"孔令飞","note":"","ucode":"8363EA4BD0AAF0","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":547830,"discussion_content":"1. iam-apiserver和ops-apiserver是2个不同组件，ops-apiserver是服务于ops-webconsole \n2. ops-webconsole直接调用ops-apiserver，再由ops-apiserver通过grpc调用iam-apiserver。\n\n你的理解完全正确。","likes_number":1,"is_delete":false,"is_hidden":false,"ctime":1642867994,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":1,"child_discussions":[{"author":{"id":1007204,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/5e/64/1becc599.jpg","nickname":"drawping","note":"","ucode":"A5F0E179CBA217","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":1167883,"avatar":"https://static001.geekbang.org/account/avatar/00/11/d2/0b/cdd0787a.jpg","nickname":"孔令飞","note":"","ucode":"8363EA4BD0AAF0","race_medal":0,"user_type":2,"is_pvip":false},"discussion":{"id":547883,"discussion_content":"谢谢老师","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1642921080,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":547830,"ip_address":""},"score":547883,"extra":""}]}]},{"had_liked":false,"id":331136,"user_name":"骑着🚀看银河","can_delete":false,"product_type":"c1","uid":1074734,"ip_address":"","ucode":"8706A99A89F0CE","user_header":"https://static001.geekbang.org/account/avatar/00/10/66/2e/527b73c9.jpg","comment_is_top":false,"comment_ctime":1642440708,"is_pvip":true,"replies":[{"id":"121259","content":"淘宝应该是设置时间比较长","user_name":"作者回复","user_name_real":"编辑","uid":"1167883","ctime":1642867541,"ip_address":"","comment_id":331136,"utype":1}],"discussion_count":1,"race_medal":1,"score":"1642440708","product_id":100079601,"comment_content":"对于 @老妖纣王 同学提的淘宝登录token过期问题，按照老师的意思是token过期时间设置的很长了？","like_count":0,"discussions":[{"author":{"id":1167883,"avatar":"https://static001.geekbang.org/account/avatar/00/11/d2/0b/cdd0787a.jpg","nickname":"孔令飞","note":"","ucode":"8363EA4BD0AAF0","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":547819,"discussion_content":"淘宝应该是设置时间比较长","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1642867541,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":330867,"user_name":"waterjiao","can_delete":false,"product_type":"c1","uid":1283989,"ip_address":"","ucode":"74F2F75BF0CA6F","user_header":"https://static001.geekbang.org/account/avatar/00/13/97/95/aad51e9b.jpg","comment_is_top":false,"comment_ctime":1642236134,"is_pvip":true,"replies":[{"id":"120936","content":"1. 这种情况可以不用处理，因为iam-authz-server本身监听消息是毫秒级的。另外，既然之前是允许访问的，现在改成不允许访问，也就是说这几十毫秒的延时是可以接受的。<br>2. 资源是挂在用户名下，2个用户创建的资源必然是2个不同的资源。资源ID是惟一的，不同用户常见的资源ID是不一样的","user_name":"作者回复","user_name_real":"编辑","uid":"1167883","ctime":1642433538,"ip_address":"","comment_id":330867,"utype":1}],"discussion_count":1,"race_medal":1,"score":"1642236134","product_id":100079601,"comment_content":"有两个问题，想咨询下，第一，当用户请求 API 完成资源授权时，如果这时他的权限和策略被更改了，但是由于iam-authz-server 监听消息慢导致了授权成功，对于这种情况，是不处理呢，还是增加机制保证呢？第二，两个用户在创建平台资源时创建相同的资源，如何保证资源创建唯一，是对服务加锁呢，每次只处理一个请求，还是对资源加锁？","like_count":0,"discussions":[{"author":{"id":1167883,"avatar":"https://static001.geekbang.org/account/avatar/00/11/d2/0b/cdd0787a.jpg","nickname":"孔令飞","note":"","ucode":"8363EA4BD0AAF0","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":546831,"discussion_content":"1. 这种情况可以不用处理，因为iam-authz-server本身监听消息是毫秒级的。另外，既然之前是允许访问的，现在改成不允许访问，也就是说这几十毫秒的延时是可以接受的。\n2. 资源是挂在用户名下，2个用户创建的资源必然是2个不同的资源。资源ID是惟一的，不同用户常见的资源ID是不一样的","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1642433538,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":329687,"user_name":"HelloBug","can_delete":false,"product_type":"c1","uid":1249598,"ip_address":"","ucode":"E61A4AD5C2F724","user_header":"https://static001.geekbang.org/account/avatar/00/13/11/3e/925aa996.jpg","comment_is_top":false,"comment_ctime":1641469869,"is_pvip":true,"replies":[{"id":"120957","content":"属于大项目。<br><br>项目大小和组件数量、数据库数量没有关系。<br><br>其实项目大小也没有标准的定义。<br><br>这里之所说iam属于大项目，一方面iam承载的功能比较全，另一方面iam来自于规模比较大的企业级项目","user_name":"作者回复","user_name_real":"编辑","uid":"1167883","ctime":1642434898,"ip_address":"","comment_id":329687,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1641469869","product_id":100079601,"comment_content":"这个项目看组件数量的话感觉挺大的，数据库使用了三个，如果是高可用部署的话，数据库需要高可用，组件需要高可用，机器数量也挺多的。请问下老师，像这样一个IAM项目，从老师的角度来看，是属于什么规格的项目？大项目？小项目？没有大项目经验，麻烦老师讲解下项目大小和组件数、数据库数量的关系","like_count":0,"discussions":[{"author":{"id":1167883,"avatar":"https://static001.geekbang.org/account/avatar/00/11/d2/0b/cdd0787a.jpg","nickname":"孔令飞","note":"","ucode":"8363EA4BD0AAF0","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":546860,"discussion_content":"属于大项目。\n\n项目大小和组件数量、数据库数量没有关系。\n\n其实项目大小也没有标准的定义。\n\n这里之所说iam属于大项目，一方面iam承载的功能比较全，另一方面iam来自于规模比较大的企业级项目","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1642434899,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":329541,"user_name":"陈晓涛","can_delete":false,"product_type":"c1","uid":1588873,"ip_address":"","ucode":"E80D318348CA47","user_header":"https://static001.geekbang.org/account/avatar/00/18/3e/89/ccc2ebd9.jpg","comment_is_top":false,"comment_ctime":1641393110,"is_pvip":false,"replies":[{"id":"120958","content":"jwt可以设置token的过期时间。","user_name":"作者回复","user_name_real":"编辑","uid":"1167883","ctime":1642434945,"ip_address":"","comment_id":329541,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1641393110","product_id":100079601,"comment_content":"使jwt是无法是token过期的，那如果退出登录，怎么确保token失效，加上Redis保存token做清除和校验吗","like_count":0,"discussions":[{"author":{"id":1167883,"avatar":"https://static001.geekbang.org/account/avatar/00/11/d2/0b/cdd0787a.jpg","nickname":"孔令飞","note":"","ucode":"8363EA4BD0AAF0","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":546861,"discussion_content":"jwt可以设置token的过期时间。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1642434945,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":327261,"user_name":"coder","can_delete":false,"product_type":"c1","uid":1656956,"ip_address":"","ucode":"3A0940EBF94577","user_header":"https://static001.geekbang.org/account/avatar/00/19/48/7c/2aaf50e5.jpg","comment_is_top":false,"comment_ctime":1640016968,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1640016968","product_id":100079601,"comment_content":"很清晰，学到了这类架构模式。之前做系统都是日志也往mysql里面存，还没想到用mongodb这种方式，后面去了解一下","like_count":0},{"had_liked":false,"id":327228,"user_name":"推推。","can_delete":false,"product_type":"c1","uid":1990393,"ip_address":"","ucode":"457992FB234357","user_header":"https://static001.geekbang.org/account/avatar/00/1e/5e/f9/ca88bdb8.jpg","comment_is_top":false,"comment_ctime":1639991892,"is_pvip":true,"replies":[{"id":"119717","content":"授权接口是通过密钥（secretID&#47;secretKey)  ---- 这个其实是认证。<br><br>这些资源的授权是通过授权给其他账户的 ---- 这个使用了复杂的授权策略。<br><br>关于授权方法你可以参考下：27 | 权限模型：5大权限模型是如何进行资源授权的？","user_name":"作者回复","user_name_real":"编辑","uid":"1167883","ctime":1640827184,"ip_address":"","comment_id":327228,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1639991892","product_id":100079601,"comment_content":"关于第二步 访问 IAM 的资源授权接口是通过密钥（secretID&#47;secretKey)<br>我看华为云 腾讯云 这些资源的授权是通过授权给其他账户的 这是如何做到的呢 ？","like_count":0,"discussions":[{"author":{"id":1167883,"avatar":"https://static001.geekbang.org/account/avatar/00/11/d2/0b/cdd0787a.jpg","nickname":"孔令飞","note":"","ucode":"8363EA4BD0AAF0","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":542673,"discussion_content":"授权接口是通过密钥（secretID/secretKey)  ---- 这个其实是认证。\n\n这些资源的授权是通过授权给其他账户的 ---- 这个使用了复杂的授权策略。\n\n关于授权方法你可以参考下：27 | 权限模型：5大权限模型是如何进行资源授权的？","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1640827184,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":322886,"user_name":"Allen","can_delete":false,"product_type":"c1","uid":2851087,"ip_address":"","ucode":"63E53446007D1F","user_header":"https://static001.geekbang.org/account/avatar/00/2b/81/0f/f8ced7d9.jpg","comment_is_top":false,"comment_ctime":1637645490,"is_pvip":false,"replies":[{"id":"117695","content":"定时任务已经写好了，等编译修改上线","user_name":"作者回复","user_name_real":"编辑","uid":"1167883","ctime":1638363067,"ip_address":"","comment_id":322886,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1637645490","product_id":100079601,"comment_content":"定时任务这块也经常用到，但是好像没有涉及哦","like_count":0,"discussions":[{"author":{"id":1167883,"avatar":"https://static001.geekbang.org/account/avatar/00/11/d2/0b/cdd0787a.jpg","nickname":"孔令飞","note":"","ucode":"8363EA4BD0AAF0","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":535178,"discussion_content":"定时任务已经写好了，等编译修改上线","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1638363067,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":322522,"user_name":"yandongxiao","can_delete":false,"product_type":"c1","uid":1017700,"ip_address":"","ucode":"D397F4DB0109C8","user_header":"https://static001.geekbang.org/account/avatar/00/0f/87/64/3882d90d.jpg","comment_is_top":false,"comment_ctime":1637462347,"is_pvip":false,"replies":[{"id":"117685","content":"6666666","user_name":"作者回复","user_name_real":"编辑","uid":"1167883","ctime":1638362621,"ip_address":"","comment_id":322522,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1637462347","product_id":100079601,"comment_content":"总结：<br>1. 解释为什么选择IAM应用作为实战项目。<br>2. 站在使用者的角度，介绍 iam-apiserver 管理的资源：user、policy、secret。<br>3. 介绍 IAM 系统的整体架构。<br>4. 介绍前后端分离、MVC等软件架构模式。","like_count":0,"discussions":[{"author":{"id":1167883,"avatar":"https://static001.geekbang.org/account/avatar/00/11/d2/0b/cdd0787a.jpg","nickname":"孔令飞","note":"","ucode":"8363EA4BD0AAF0","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":535166,"discussion_content":"6666666","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1638362621,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":321140,"user_name":"徐付","can_delete":false,"product_type":"c1","uid":2840476,"ip_address":"","ucode":"8A7244F9DCCECF","user_header":"https://static001.geekbang.org/account/avatar/00/2b/57/9c/aaa09896.jpg","comment_is_top":false,"comment_ctime":1636686968,"is_pvip":false,"replies":[{"id":"116852","content":"哪方面的框架？web框架用的Gin。iam有超级管理员的","user_name":"作者回复","user_name_real":"编辑","uid":"1167883","ctime":1637061537,"ip_address":"","comment_id":321140,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1636686968","product_id":100079601,"comment_content":"IAM用的什么框架呢？ 用户的授权是否有超级管理员处理呢？ 期待后续的课程","like_count":0,"discussions":[{"author":{"id":1167883,"avatar":"https://static001.geekbang.org/account/avatar/00/11/d2/0b/cdd0787a.jpg","nickname":"孔令飞","note":"","ucode":"8363EA4BD0AAF0","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":530367,"discussion_content":"哪方面的框架？web框架用的Gin。iam有超级管理员的","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1637061537,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":320654,"user_name":"勃勃法雷尔","can_delete":false,"product_type":"c1","uid":2839608,"ip_address":"","ucode":"5551ECAD1D5CEF","user_header":"https://static001.geekbang.org/account/avatar/00/2b/54/38/21461ca7.jpg","comment_is_top":false,"comment_ctime":1636440434,"is_pvip":false,"replies":[{"id":"116862","content":"刚入行，确实比较难，加油。<br>如果写的太浅显，其实带不了什么核心价值。","user_name":"作者回复","user_name_real":"编辑","uid":"1167883","ctime":1637062428,"ip_address":"","comment_id":320654,"utype":1}],"discussion_count":3,"race_medal":0,"score":"1636440434","product_id":100079601,"comment_content":"作为一个C嵌入式过来看的工程师，基本看下去很艰难。大量不清楚的名词知识点，各种网络知识基本都被作者当成已知直接拿来就用了。为什么网络开发这边有这么多让人看不懂的名词，这也是在学习中一再困扰我的地方。也不太清楚作者还发语音是几个意思，完全看PPT就行了，何苦又念一遍。68倒是不贵，但是对于我这种跨行的小白来说，真的不太友好。","like_count":0,"discussions":[{"author":{"id":1167883,"avatar":"https://static001.geekbang.org/account/avatar/00/11/d2/0b/cdd0787a.jpg","nickname":"孔令飞","note":"","ucode":"8363EA4BD0AAF0","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":530379,"discussion_content":"刚入行，确实比较难，加油。\n如果写的太浅显，其实带不了什么核心价值。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1637062428,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":2833660,"avatar":"https://static001.geekbang.org/account/avatar/00/2b/3c/fc/c88d7f1a.jpg","nickname":"李小雪","note":"","ucode":"237916041CD3E3","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":582092,"discussion_content":"68？ 为什么涨价了？22 年 7 月 139。 通胀这么厉害吗？","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1659205412,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":"阿联酋"},"score":2,"extra":"","child_discussion_number":1,"child_discussions":[{"author":{"id":3177884,"avatar":"","nickname":"Geek_854810","note":"","ucode":"57791145B2B904","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":2833660,"avatar":"https://static001.geekbang.org/account/avatar/00/2b/3c/fc/c88d7f1a.jpg","nickname":"李小雪","note":"","ucode":"237916041CD3E3","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":587163,"discussion_content":"新用户首单有优惠券。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1662861307,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":582092,"ip_address":"上海"},"score":587163,"extra":""}]}]},{"had_liked":false,"id":316228,"user_name":"静心","can_delete":false,"product_type":"c1","uid":1335457,"ip_address":"","ucode":"EB264FA6519FDA","user_header":"https://static001.geekbang.org/account/avatar/00/14/60/a1/8f003697.jpg","comment_is_top":false,"comment_ctime":1634206913,"is_pvip":true,"discussion_count":0,"race_medal":5,"score":"1634206913","product_id":100079601,"comment_content":"在三层架构中，现在前端View层一般采用MVVM的架构，一般使用的是VueJs及ReactJs等框架。","like_count":0},{"had_liked":false,"id":315570,"user_name":"授人以🐟，不如授人以渔","can_delete":false,"product_type":"c1","uid":1193874,"ip_address":"","ucode":"BD53829E924B66","user_header":"https://static001.geekbang.org/account/avatar/00/12/37/92/961ba560.jpg","comment_is_top":false,"comment_ctime":1633921884,"is_pvip":true,"replies":[{"id":"114450","content":"ops-webconsole和ops-apiserver都属于运营系统，运营系统是前后端分离架构。<br><br>ops-apiserver：运营系统后端。<br>ops-webconsole：运营系统前端。<br><br> iam-authz-server和iam-apiserver本来就不是一个系统，强行合二为一，后期变更、升级等，都很麻烦。<br><br>拆分开，彼此独立开发、升级、部署，互不影响","user_name":"作者回复","user_name_real":"CK1.0","uid":"1167883","ctime":1634022509,"ip_address":"","comment_id":315570,"utype":1}],"discussion_count":2,"race_medal":0,"score":"1633921884","product_id":100079601,"comment_content":"孔老师，请问一些问题：「静态文件服务器一般由 Nginx 服务器实现，那什么是前端 ops-webconsole？前端 ops-webconsole 和后端 ops-apiserver 的关系是怎样的？」、在组件设计时，为什么将功能拆分成 iam-authz-server 和 iam-apiserver 组件，而不是合二为一？","like_count":0,"discussions":[{"author":{"id":1167883,"avatar":"https://static001.geekbang.org/account/avatar/00/11/d2/0b/cdd0787a.jpg","nickname":"孔令飞","note":"","ucode":"8363EA4BD0AAF0","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":528092,"discussion_content":"ops-webconsole和ops-apiserver都属于运营系统，运营系统是前后端分离架构。\n\nops-apiserver：运营系统后端。\nops-webconsole：运营系统前端。\n\n iam-authz-server和iam-apiserver本来就不是一个系统，强行合二为一，后期变更、升级等，都很麻烦。\n\n拆分开，彼此独立开发、升级、部署，互不影响","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1634022509,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1193874,"avatar":"https://static001.geekbang.org/account/avatar/00/12/37/92/961ba560.jpg","nickname":"授人以🐟，不如授人以渔","note":"","ucode":"BD53829E924B66","race_medal":0,"user_type":1,"is_pvip":true},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":403190,"discussion_content":"运营系统前端，是不是也是一个软件产品？或者就是一个客户端软件？","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1634029555,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":315267,"user_name":"芒果少侠","can_delete":false,"product_type":"c1","uid":1350159,"ip_address":"","ucode":"98D0BBB52BB80F","user_header":"https://static001.geekbang.org/account/avatar/00/14/9a/0f/da7ed75a.jpg","comment_is_top":false,"comment_ctime":1633775142,"is_pvip":true,"replies":[{"id":"114946","content":"6666 感谢分享！","user_name":"作者回复","user_name_real":"孔令飞","uid":"1167883","ctime":1634743516,"ip_address":"","comment_id":315267,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1633775142","product_id":100079601,"comment_content":"有一个介绍mvc和三层架构区别的文章：mvc和三层架构应该是维度上的差别，一个是设计模式，一个是软件架构。https:&#47;&#47;blog.csdn.net&#47;weixin_42153410&#47;article&#47;details&#47;90753696","like_count":0,"discussions":[{"author":{"id":1167883,"avatar":"https://static001.geekbang.org/account/avatar/00/11/d2/0b/cdd0787a.jpg","nickname":"孔令飞","note":"","ucode":"8363EA4BD0AAF0","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":527917,"discussion_content":"6666 感谢分享！","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1634743516,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":313174,"user_name":"随缘","can_delete":false,"product_type":"c1","uid":1333602,"ip_address":"","ucode":"0A787D3BC7A9A3","user_header":"https://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTI3C6aiaBgp29xyRr0cqdf6EDDlIukyTT5w9JxJeY4Vgouzr0o47wp4ibTutS0h8R8g4IC25FZ3icicDw/132","comment_is_top":false,"comment_ctime":1632301423,"is_pvip":false,"replies":[{"id":"113668","content":"为了从iam-apiserver中同步最新的策略信息到iam-authz-server中。<br><br>试想：如果iam-apiserver中新增了A策略，那么iam-authz-server首先需要能够感知到iam-apiserver中新增了A策略，然后才能从iam-apiserver中同步A策略。<br><br>订阅redis的channel就是为了能够感知到iam-apiserver中有新的策略被增加。当iam-apiserver中新增了A策略后，会向redis channel中发送一个消息，因为iam-authz-server订阅了相同的channel，所以iam-authz-server能够感知到这条消息，然后再调用iam-apiserver的接口重新从iam-apiserver中获取策略信息","user_name":"作者回复","user_name_real":"CK1.0","uid":"1167883","ctime":1632758311,"ip_address":"","comment_id":313174,"utype":1}],"discussion_count":2,"race_medal":0,"score":"1632301423","product_id":100079601,"comment_content":"有一点不懂, 求教老师<br>既然 iam-authz-server 已经把策略缓存在了内存中, 为什么还需要去订阅redis的变动, iam-apiserver 还需要把变动发送到redis中, 这两步分别是干嘛的?","like_count":0,"discussions":[{"author":{"id":1167883,"avatar":"https://static001.geekbang.org/account/avatar/00/11/d2/0b/cdd0787a.jpg","nickname":"孔令飞","note":"","ucode":"8363EA4BD0AAF0","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":527259,"discussion_content":"为了从iam-apiserver中同步最新的策略信息到iam-authz-server中。\n\n试想：如果iam-apiserver中新增了A策略，那么iam-authz-server首先需要能够感知到iam-apiserver中新增了A策略，然后才能从iam-apiserver中同步A策略。\n\n订阅redis的channel就是为了能够感知到iam-apiserver中有新的策略被增加。当iam-apiserver中新增了A策略后，会向redis channel中发送一个消息，因为iam-authz-server订阅了相同的channel，所以iam-authz-server能够感知到这条消息，然后再调用iam-apiserver的接口重新从iam-apiserver中获取策略信息","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1632758311,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1592279,"avatar":"https://static001.geekbang.org/account/avatar/00/18/4b/d7/f46c6dfd.jpg","nickname":"William Ning","note":"","ucode":"4DB8D05E69E5F3","race_medal":0,"user_type":1,"is_pvip":true},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":571863,"discussion_content":"FYI:\n这里Redis的作用是实现订阅分布功能～","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1652433220,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":305449,"user_name":"Nio","can_delete":false,"product_type":"c1","uid":1529642,"ip_address":"","ucode":"A1B8D3C01FB937","user_header":"https://static001.geekbang.org/account/avatar/00/17/57/2a/c6c95f37.jpg","comment_is_top":false,"comment_ctime":1627978173,"is_pvip":true,"replies":[{"id":"110636","content":"木有的","user_name":"作者回复","user_name_real":"CK1.0","uid":"1167883","ctime":1628165583,"ip_address":"","comment_id":305449,"utype":1}],"discussion_count":1,"race_medal":4,"score":"1627978173","product_id":100079601,"comment_content":"想问下文章中列举的4个旁路组件有相关的开源项目参考一下吗","like_count":0,"discussions":[{"author":{"id":1167883,"avatar":"https://static001.geekbang.org/account/avatar/00/11/d2/0b/cdd0787a.jpg","nickname":"孔令飞","note":"","ucode":"8363EA4BD0AAF0","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":524390,"discussion_content":"木有的","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1628165583,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":304080,"user_name":"天狼","can_delete":false,"product_type":"c1","uid":2415574,"ip_address":"","ucode":"4AF6A9B138B3EE","user_header":"https://static001.geekbang.org/account/avatar/00/24/db/d6/8d49bb77.jpg","comment_is_top":false,"comment_ctime":1627223315,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1627223315","product_id":100079601,"comment_content":"go小白。以前的项目都是基于wpf+mvvm，前后端相当分离。","like_count":0},{"had_liked":false,"id":299761,"user_name":"Geek_a4cca6","can_delete":false,"product_type":"c1","uid":2136813,"ip_address":"","ucode":"68B3E4FDECFFF0","user_header":"https://thirdwx.qlogo.cn/mmopen/vi_32/5GQZCecntmOibVjWkMWVnibqXEZhAYnFiaRkgfAUGdrQBWzfXjqsYteLee6afDEjvBLBVa5uvtWYTTicwO2jKia0zOw/132","comment_is_top":false,"comment_ctime":1624848552,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1624848552","product_id":100079601,"comment_content":"我们现在使用的是离线工具生成yaml文件，符合openapi3.0规范，开发有些也用makdown，现要求全部改掉","like_count":0},{"had_liked":false,"id":297830,"user_name":"顺～～","can_delete":false,"product_type":"c1","uid":1255372,"ip_address":"","ucode":"DEC837050D82AF","user_header":"https://static001.geekbang.org/account/avatar/00/13/27/cc/c4a8d2c7.jpg","comment_is_top":false,"comment_ctime":1623807225,"is_pvip":false,"replies":[{"id":"108142","content":"不是","user_name":"作者回复","user_name_real":"CK1.0","uid":"1167883","ctime":1623820488,"ip_address":"","comment_id":297830,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1623807225","product_id":100079601,"comment_content":"iam就是ldap吧","like_count":0,"discussions":[{"author":{"id":1167883,"avatar":"https://static001.geekbang.org/account/avatar/00/11/d2/0b/cdd0787a.jpg","nickname":"孔令飞","note":"","ucode":"8363EA4BD0AAF0","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":521944,"discussion_content":"不是","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1623820488,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":297363,"user_name":"yingsunjiu","can_delete":false,"product_type":"c1","uid":1032867,"ip_address":"","ucode":"D94720E48EF6B4","user_header":"","comment_is_top":false,"comment_ctime":1623484046,"is_pvip":false,"replies":[{"id":"108014","content":"控制流可以理解为管理面，数据流可以理解为业务面。这个没有标准的划分方法，根据业务会有一定区别。控制流挂了，不影响业务的正常使用，但是数据流挂了就会造成业务没法用","user_name":"作者回复","user_name_real":"CK1.0","uid":"1167883","ctime":1623582591,"ip_address":"","comment_id":297363,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1623484046","product_id":100079601,"comment_content":"没太理解架构图中的数据流和控制流是按什么区分的？能否再详细说下","like_count":0,"discussions":[{"author":{"id":1167883,"avatar":"https://static001.geekbang.org/account/avatar/00/11/d2/0b/cdd0787a.jpg","nickname":"孔令飞","note":"","ucode":"8363EA4BD0AAF0","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":521806,"discussion_content":"控制流可以理解为管理面，数据流可以理解为业务面。这个没有标准的划分方法，根据业务会有一定区别。控制流挂了，不影响业务的正常使用，但是数据流挂了就会造成业务没法用","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1623582591,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":296992,"user_name":"会飞的牛","can_delete":false,"product_type":"c1","uid":2022822,"ip_address":"","ucode":"7D18DCF111976A","user_header":"","comment_is_top":false,"comment_ctime":1623251778,"is_pvip":false,"replies":[{"id":"107909","content":"看起来像基于mvc架构的一种改进","user_name":"作者回复","user_name_real":"CK1.0","uid":"1167883","ctime":1623321403,"ip_address":"","comment_id":296992,"utype":1}],"discussion_count":2,"race_medal":0,"score":"1623251778","product_id":100079601,"comment_content":"问题2: 使用Laravel框架开发后台管理系统的时候典型的MVC模式，在实际项目中会加一层Service，框架实现在里面,Control只做调用，业务逻辑封闭在Service里面。<br>开发前端应用的时候，这时使用的是前后端分离模式。前端专注于页面效果与交互，后端负责提供RESTful API。","like_count":0,"discussions":[{"author":{"id":1167883,"avatar":"https://static001.geekbang.org/account/avatar/00/11/d2/0b/cdd0787a.jpg","nickname":"孔令飞","note":"","ucode":"8363EA4BD0AAF0","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":521676,"discussion_content":"看起来像基于mvc架构的一种改进","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1623321403,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1592279,"avatar":"https://static001.geekbang.org/account/avatar/00/18/4b/d7/f46c6dfd.jpg","nickname":"William Ning","note":"","ucode":"4DB8D05E69E5F3","race_medal":0,"user_type":1,"is_pvip":true},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":571864,"discussion_content":"个人想法，最主要就是为了逻辑复用，或者说代码复用。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1652433398,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":295567,"user_name":"","can_delete":false,"product_type":"c1","uid":1916093,"ip_address":"","ucode":"DD2D171393F828","user_header":"https://static001.geekbang.org/account/avatar/00/1d/3c/bd/ea0b59f6.jpg","comment_is_top":false,"comment_ctime":1622477288,"is_pvip":false,"replies":[{"id":"107353","content":"后端用mvc架构其实类似于分层架构 不适合go项目。业务层可以考虑做的更通用些，其功能可以做成控制台功能的超集","user_name":"作者回复","user_name_real":"CK1.0","uid":"1167883","ctime":1622522355,"ip_address":"","comment_id":295567,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1622477288","product_id":100079601,"comment_content":"现在很多项目都不管系统的规模都会直接前后端分开，而前或后端都会在mvc或 mvvm 的构架来实现。仅是有时会想，业务层是的逻辑是依据界面还是依据业务，总感觉界面有什么功能业务层就是什么样子的。","like_count":0,"discussions":[{"author":{"id":1167883,"avatar":"https://static001.geekbang.org/account/avatar/00/11/d2/0b/cdd0787a.jpg","nickname":"孔令飞","note":"","ucode":"8363EA4BD0AAF0","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":521132,"discussion_content":"后端用mvc架构其实类似于分层架构 不适合go项目。业务层可以考虑做的更通用些，其功能可以做成控制台功能的超集","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1622522355,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":295535,"user_name":"不负","can_delete":false,"product_type":"c1","uid":1238323,"ip_address":"","ucode":"147F5860711811","user_header":"https://static001.geekbang.org/account/avatar/00/12/e5/33/ff5c52ad.jpg","comment_is_top":false,"comment_ctime":1622465921,"is_pvip":true,"replies":[{"id":"107351","content":"可以这么理解，Model层封装了跟数据交互的代码。","user_name":"作者回复","user_name_real":"CK1.0","uid":"1167883","ctime":1622522096,"ip_address":"","comment_id":295535,"utype":1}],"discussion_count":1,"race_medal":1,"score":"1622465921","product_id":100079601,"comment_content":"MVC中Model是用于处理数据逻辑，这个不太理解，是指M层已拼装好数据等着Controller层来取吗？","like_count":0,"discussions":[{"author":{"id":1167883,"avatar":"https://static001.geekbang.org/account/avatar/00/11/d2/0b/cdd0787a.jpg","nickname":"孔令飞","note":"","ucode":"8363EA4BD0AAF0","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":521119,"discussion_content":"可以这么理解，Model层封装了跟数据交互的代码。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1622522096,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":295532,"user_name":"授人以🐟，不如授人以渔","can_delete":false,"product_type":"c1","uid":1193874,"ip_address":"","ucode":"BD53829E924B66","user_header":"https://static001.geekbang.org/account/avatar/00/12/37/92/961ba560.jpg","comment_is_top":false,"comment_ctime":1622465093,"is_pvip":true,"replies":[{"id":"107380","content":"没多大关系。ops-webconsole会从静态文件服务器上加载静态文件","user_name":"作者回复","user_name_real":"CK1.0","uid":"1167883","ctime":1622565387,"ip_address":"","comment_id":295532,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1622465093","product_id":100079601,"comment_content":"请问：静态文件服务器和 ops-apiserver 部署上的关系是怎样的的？","like_count":0,"discussions":[{"author":{"id":1167883,"avatar":"https://static001.geekbang.org/account/avatar/00/11/d2/0b/cdd0787a.jpg","nickname":"孔令飞","note":"","ucode":"8363EA4BD0AAF0","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":521117,"discussion_content":"没多大关系。ops-webconsole会从静态文件服务器上加载静态文件","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1622565387,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":295330,"user_name":"Wings","can_delete":false,"product_type":"c1","uid":1215464,"ip_address":"","ucode":"047167807048EC","user_header":"https://static001.geekbang.org/account/avatar/00/12/8b/e8/7f09a744.jpg","comment_is_top":false,"comment_ctime":1622369561,"is_pvip":false,"replies":[{"id":"107230","content":"老哥猜的很对哇，哈哈哈","user_name":"作者回复","user_name_real":"CK1.0","uid":"1167883","ctime":1622435719,"ip_address":"","comment_id":295330,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1622369561","product_id":100079601,"comment_content":"marmotedu是什么意思？土拨鼠教育？go教育？","like_count":0,"discussions":[{"author":{"id":1167883,"avatar":"https://static001.geekbang.org/account/avatar/00/11/d2/0b/cdd0787a.jpg","nickname":"孔令飞","note":"","ucode":"8363EA4BD0AAF0","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":521036,"discussion_content":"老哥猜的很对哇，哈哈哈","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1622435719,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":295038,"user_name":"冰菓","can_delete":false,"product_type":"c1","uid":1029281,"ip_address":"","ucode":"3BD4EBB877EE04","user_header":"https://static001.geekbang.org/account/avatar/00/0f/b4/a1/dbfae65d.jpg","comment_is_top":false,"comment_ctime":1622192524,"is_pvip":false,"replies":[{"id":"107135","content":"写在controller层。","user_name":"作者回复","user_name_real":"CK1.0","uid":"1167883","ctime":1622253340,"ip_address":"","comment_id":295038,"utype":1}],"discussion_count":3,"race_medal":0,"score":"1622192524","product_id":100079601,"comment_content":"想问一下mvc 架构下，业务逻辑写在哪里呢？","like_count":0,"discussions":[{"author":{"id":1167883,"avatar":"https://static001.geekbang.org/account/avatar/00/11/d2/0b/cdd0787a.jpg","nickname":"孔令飞","note":"","ucode":"8363EA4BD0AAF0","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":520923,"discussion_content":"写在controller层。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1622253340,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1338831,"avatar":"https://static001.geekbang.org/account/avatar/00/14/6d/cf/ec335526.jpg","nickname":"jc9090kkk","note":"","ucode":"6C992D07A2E78F","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":381158,"discussion_content":"一般mvc架构里，controller层只是逻辑入口，并不会把所有的逻辑都写在controller层，而是会把一些复杂的业务逻辑抽离出来，封装成类似services层或者logic层来做解耦，这样后期如果需要将特定的服务单独做独立部署，利用rpc实现服务调用，负担也不会太大，如果将所有的逻辑都耦合在controller里拓展性会很差","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1624932976,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1922171,"avatar":"https://static001.geekbang.org/account/avatar/00/1d/54/7b/780c04ff.jpg","nickname":"史努比","note":"","ucode":"20D1EC05778BC6","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":378818,"discussion_content":"那文中“如果业务流程发生改变也只需要变更模型层的代码就可以”这句话是不是写错了","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1623414541,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":294885,"user_name":"kkgo","can_delete":false,"product_type":"c1","uid":1199356,"ip_address":"","ucode":"AFCCBFD96CFA21","user_header":"https://static001.geekbang.org/account/avatar/00/12/4c/fc/0e887697.jpg","comment_is_top":false,"comment_ctime":1622121713,"is_pvip":false,"replies":[{"id":"107064","content":"每周更新3篇，不过我会加快更新进度","user_name":"作者回复","user_name_real":"CK1.0","uid":"1167883","ctime":1622161524,"ip_address":"","comment_id":294885,"utype":1}],"discussion_count":1,"race_medal":1,"score":"1622121713","product_id":100079601,"comment_content":"每天什么时候更新，更新时间持续多久？","like_count":0,"discussions":[{"author":{"id":1167883,"avatar":"https://static001.geekbang.org/account/avatar/00/11/d2/0b/cdd0787a.jpg","nickname":"孔令飞","note":"","ucode":"8363EA4BD0AAF0","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":520855,"discussion_content":"每周更新3篇，不过我会加快更新进度","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1622161524,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":294812,"user_name":"仰望星辰","can_delete":false,"product_type":"c1","uid":2063881,"ip_address":"","ucode":"58BA22362DA7A6","user_header":"https://static001.geekbang.org/account/avatar/00/1f/7e/09/f2f3fc24.jpg","comment_is_top":false,"comment_ctime":1622098687,"is_pvip":false,"replies":[{"id":"107038","content":"IAM：认证和授权系统。<br><br>绝大部分应用都需要认证和授权。不同语言有不同的实现方式。这里只是给出了Go的实现方法","user_name":"作者回复","user_name_real":"CK1.0","uid":"1167883","ctime":1622116140,"ip_address":"","comment_id":294812,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1622098687","product_id":100079601,"comment_content":"我可以理解为，IAM只是一种规范吗，与语言无关，每种语言都有相关的实现策略吗？","like_count":0,"discussions":[{"author":{"id":1167883,"avatar":"https://static001.geekbang.org/account/avatar/00/11/d2/0b/cdd0787a.jpg","nickname":"孔令飞","note":"","ucode":"8363EA4BD0AAF0","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":520822,"discussion_content":"IAM：认证和授权系统。\n\n绝大部分应用都需要认证和授权。不同语言有不同的实现方式。这里只是给出了Go的实现方法","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1622116140,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]}]}