{"id":97622,"title":"39 | æ¡ˆä¾‹åˆ†æï¼ˆäºŒï¼‰ï¼šé«˜æ€§èƒ½ç½‘ç»œåº”ç”¨æ¡†æ¶Netty","content":"<p>Nettyæ˜¯ä¸€ä¸ªé«˜æ€§èƒ½ç½‘ç»œåº”ç”¨æ¡†æ¶ï¼Œåº”ç”¨éå¸¸æ™®éï¼Œç›®å‰åœ¨Javaé¢†åŸŸé‡Œï¼ŒNettyåŸºæœ¬ä¸Šæˆä¸ºç½‘ç»œç¨‹åºçš„æ ‡é…äº†ã€‚Nettyæ¡†æ¶åŠŸèƒ½ä¸°å¯Œï¼Œä¹Ÿéå¸¸å¤æ‚ï¼Œä»Šå¤©æˆ‘ä»¬ä¸»è¦åˆ†æNettyæ¡†æ¶ä¸­çš„çº¿ç¨‹æ¨¡å‹ï¼Œè€Œ<strong>çº¿ç¨‹æ¨¡å‹ç›´æ¥å½±å“ç€ç½‘ç»œç¨‹åºçš„æ€§èƒ½</strong>ã€‚</p><p>åœ¨ä»‹ç»Nettyçš„çº¿ç¨‹æ¨¡å‹ä¹‹å‰ï¼Œæˆ‘ä»¬é¦–å…ˆéœ€è¦æŠŠé—®é¢˜ææ¸…æ¥šï¼Œäº†è§£ç½‘ç»œç¼–ç¨‹æ€§èƒ½çš„ç“¶é¢ˆåœ¨å“ªé‡Œï¼Œç„¶åå†çœ‹Nettyçš„çº¿ç¨‹æ¨¡å‹æ˜¯å¦‚ä½•è§£å†³è¿™ä¸ªé—®é¢˜çš„ã€‚</p><h2>ç½‘ç»œç¼–ç¨‹æ€§èƒ½çš„ç“¶é¢ˆ</h2><p>åœ¨<a href=\"https://time.geekbang.org/column/article/95098\">ã€Š33 | Thread-Per-Messageæ¨¡å¼ï¼šæœ€ç®€å•å®ç”¨çš„åˆ†å·¥æ–¹æ³•ã€‹</a>ä¸­ï¼Œæˆ‘ä»¬å†™è¿‡ä¸€ä¸ªç®€å•çš„ç½‘ç»œç¨‹åºechoï¼Œé‡‡ç”¨çš„æ˜¯é˜»å¡å¼I/Oï¼ˆBIOï¼‰ã€‚BIOæ¨¡å‹é‡Œï¼Œæ‰€æœ‰read()æ“ä½œå’Œwrite()æ“ä½œéƒ½ä¼šé˜»å¡å½“å‰çº¿ç¨‹çš„ï¼Œå¦‚æœå®¢æˆ·ç«¯å·²ç»å’ŒæœåŠ¡ç«¯å»ºç«‹äº†ä¸€ä¸ªè¿æ¥ï¼Œè€Œè¿Ÿè¿Ÿä¸å‘é€æ•°æ®ï¼Œé‚£ä¹ˆæœåŠ¡ç«¯çš„read()æ“ä½œä¼šä¸€ç›´é˜»å¡ï¼Œæ‰€ä»¥<strong>ä½¿ç”¨BIOæ¨¡å‹ï¼Œä¸€èˆ¬éƒ½ä¼šä¸ºæ¯ä¸ªsocketåˆ†é…ä¸€ä¸ªç‹¬ç«‹çš„çº¿ç¨‹</strong>ï¼Œè¿™æ ·å°±ä¸ä¼šå› ä¸ºçº¿ç¨‹é˜»å¡åœ¨ä¸€ä¸ªsocketä¸Šè€Œå½±å“å¯¹å…¶ä»–socketçš„è¯»å†™ã€‚BIOçš„çº¿ç¨‹æ¨¡å‹å¦‚ä¸‹å›¾æ‰€ç¤ºï¼Œæ¯ä¸€ä¸ªsocketéƒ½å¯¹åº”ä¸€ä¸ªç‹¬ç«‹çš„çº¿ç¨‹ï¼›ä¸ºäº†é¿å…é¢‘ç¹åˆ›å»ºã€æ¶ˆè€—çº¿ç¨‹ï¼Œå¯ä»¥é‡‡ç”¨çº¿ç¨‹æ± ï¼Œä½†æ˜¯socketå’Œçº¿ç¨‹ä¹‹é—´çš„å¯¹åº”å…³ç³»å¹¶ä¸ä¼šå˜åŒ–ã€‚</p><p><img src=\"https://static001.geekbang.org/resource/image/e7/e2/e712c37ea0483e9dde0d6efe76e687e2.png?wh=1138*393\" alt=\"\"></p><center><span class=\"reference\">BIOçš„çº¿ç¨‹æ¨¡å‹</span></center><!-- [[[read_end]]] --><p>BIOè¿™ç§çº¿ç¨‹æ¨¡å‹é€‚ç”¨äºsocketè¿æ¥ä¸æ˜¯å¾ˆå¤šçš„åœºæ™¯ï¼›ä½†æ˜¯ç°åœ¨çš„äº’è”ç½‘åœºæ™¯ï¼Œå¾€å¾€éœ€è¦æœåŠ¡å™¨èƒ½å¤Ÿæ”¯æ’‘åä¸‡ç”šè‡³ç™¾ä¸‡è¿æ¥ï¼Œè€Œåˆ›å»ºåä¸‡ç”šè‡³ä¸Šç™¾ä¸‡ä¸ªçº¿ç¨‹æ˜¾ç„¶å¹¶ä¸ç°å®ï¼Œæ‰€ä»¥BIOçº¿ç¨‹æ¨¡å‹æ— æ³•è§£å†³ç™¾ä¸‡è¿æ¥çš„é—®é¢˜ã€‚å¦‚æœä»”ç»†è§‚å¯Ÿï¼Œä½ ä¼šå‘ç°äº’è”ç½‘åœºæ™¯ä¸­ï¼Œè™½ç„¶è¿æ¥å¤šï¼Œä½†æ˜¯æ¯ä¸ªè¿æ¥ä¸Šçš„è¯·æ±‚å¹¶ä¸é¢‘ç¹ï¼Œæ‰€ä»¥çº¿ç¨‹å¤§éƒ¨åˆ†æ—¶é—´éƒ½åœ¨ç­‰å¾…I/Oå°±ç»ªã€‚ä¹Ÿå°±æ˜¯è¯´çº¿ç¨‹å¤§éƒ¨åˆ†æ—¶é—´éƒ½é˜»å¡åœ¨é‚£é‡Œï¼Œè¿™å®Œå…¨æ˜¯æµªè´¹ï¼Œå¦‚æœæˆ‘ä»¬èƒ½å¤Ÿè§£å†³è¿™ä¸ªé—®é¢˜ï¼Œé‚£å°±ä¸éœ€è¦è¿™ä¹ˆå¤šçº¿ç¨‹äº†ã€‚</p><p>é¡ºç€è¿™ä¸ªæ€è·¯ï¼Œæˆ‘ä»¬å¯ä»¥å°†çº¿ç¨‹æ¨¡å‹ä¼˜åŒ–ä¸ºä¸‹å›¾è¿™ä¸ªæ ·å­ï¼Œå¯ä»¥ç”¨ä¸€ä¸ªçº¿ç¨‹æ¥å¤„ç†å¤šä¸ªè¿æ¥ï¼Œè¿™æ ·çº¿ç¨‹çš„åˆ©ç”¨ç‡å°±ä¸Šæ¥äº†ï¼ŒåŒæ—¶æ‰€éœ€çš„çº¿ç¨‹æ•°é‡ä¹Ÿè·Ÿç€é™ä¸‹æ¥äº†ã€‚è¿™ä¸ªæ€è·¯å¾ˆå¥½ï¼Œå¯æ˜¯ä½¿ç”¨BIOç›¸å…³çš„APIæ˜¯æ— æ³•å®ç°çš„ï¼Œè¿™æ˜¯ä¸ºä»€ä¹ˆå‘¢ï¼Ÿå› ä¸ºBIOç›¸å…³çš„socketè¯»å†™æ“ä½œéƒ½æ˜¯é˜»å¡å¼çš„ï¼Œè€Œä¸€æ—¦è°ƒç”¨äº†é˜»å¡å¼APIï¼Œåœ¨I/Oå°±ç»ªå‰ï¼Œè°ƒç”¨çº¿ç¨‹ä¼šä¸€ç›´é˜»å¡ï¼Œä¹Ÿå°±æ— æ³•å¤„ç†å…¶ä»–çš„socketè¿æ¥äº†ã€‚</p><p><img src=\"https://static001.geekbang.org/resource/image/ea/1f/eafed0787b82b0b428e1ec0927029f1f.png?wh=1135*448\" alt=\"\"></p><center><span class=\"reference\">ç†æƒ³çš„çº¿ç¨‹æ¨¡å‹å›¾</span></center><p>å¥½åœ¨Javaé‡Œè¿˜æä¾›äº†éé˜»å¡å¼ï¼ˆNIOï¼‰APIï¼Œ<strong>åˆ©ç”¨éé˜»å¡å¼APIå°±èƒ½å¤Ÿå®ç°ä¸€ä¸ªçº¿ç¨‹å¤„ç†å¤šä¸ªè¿æ¥äº†</strong>ã€‚é‚£å…·ä½“å¦‚ä½•å®ç°å‘¢ï¼Ÿç°åœ¨æ™®ééƒ½æ˜¯<strong>é‡‡ç”¨Reactoræ¨¡å¼</strong>ï¼ŒåŒ…æ‹¬Nettyçš„å®ç°ã€‚æ‰€ä»¥ï¼Œè¦æƒ³ç†è§£Nettyçš„å®ç°ï¼Œæ¥ä¸‹æ¥æˆ‘ä»¬å°±éœ€è¦å…ˆäº†è§£ä¸€ä¸‹Reactoræ¨¡å¼ã€‚</p><h2>Reactoræ¨¡å¼</h2><p>ä¸‹é¢æ˜¯Reactoræ¨¡å¼çš„ç±»ç»“æ„å›¾ï¼Œå…¶ä¸­HandleæŒ‡çš„æ˜¯I/Oå¥æŸ„ï¼Œåœ¨Javaç½‘ç»œç¼–ç¨‹é‡Œï¼Œå®ƒæœ¬è´¨ä¸Šå°±æ˜¯ä¸€ä¸ªç½‘ç»œè¿æ¥ã€‚Event Handlerå¾ˆå®¹æ˜“ç†è§£ï¼Œå°±æ˜¯ä¸€ä¸ªäº‹ä»¶å¤„ç†å™¨ï¼Œå…¶ä¸­handle_event()æ–¹æ³•å¤„ç†I/Oäº‹ä»¶ï¼Œä¹Ÿå°±æ˜¯æ¯ä¸ªEvent Handlerå¤„ç†ä¸€ä¸ªI/O Handleï¼›get_handle()æ–¹æ³•å¯ä»¥è¿”å›è¿™ä¸ªI/Oçš„Handleã€‚Synchronous Event Demultiplexerå¯ä»¥ç†è§£ä¸ºæ“ä½œç³»ç»Ÿæä¾›çš„I/Oå¤šè·¯å¤ç”¨APIï¼Œä¾‹å¦‚POSIXæ ‡å‡†é‡Œçš„select()ä»¥åŠLinuxé‡Œé¢çš„epoll()ã€‚</p><p><img src=\"https://static001.geekbang.org/resource/image/a7/40/a7ba3c8d6c49e50d9288baf0c03fa240.png?wh=1142*571\" alt=\"\"></p><center><span class=\"reference\">Reactoræ¨¡å¼ç±»ç»“æ„å›¾</span></center><p>Reactoræ¨¡å¼çš„æ ¸å¿ƒè‡ªç„¶æ˜¯<strong>Reactorè¿™ä¸ªç±»</strong>ï¼Œå…¶ä¸­register_handler()å’Œremove_handler()è¿™ä¸¤ä¸ªæ–¹æ³•å¯ä»¥æ³¨å†Œå’Œåˆ é™¤ä¸€ä¸ªäº‹ä»¶å¤„ç†å™¨ï¼›<strong>handle_events()æ–¹å¼æ˜¯æ ¸å¿ƒ</strong>ï¼Œä¹Ÿæ˜¯Reactoræ¨¡å¼çš„å‘åŠ¨æœºï¼Œè¿™ä¸ªæ–¹æ³•çš„æ ¸å¿ƒé€»è¾‘å¦‚ä¸‹ï¼šé¦–å…ˆé€šè¿‡åŒæ­¥äº‹ä»¶å¤šè·¯é€‰æ‹©å™¨æä¾›çš„select()æ–¹æ³•ç›‘å¬ç½‘ç»œäº‹ä»¶ï¼Œå½“æœ‰ç½‘ç»œäº‹ä»¶å°±ç»ªåï¼Œå°±éå†äº‹ä»¶å¤„ç†å™¨æ¥å¤„ç†è¯¥ç½‘ç»œäº‹ä»¶ã€‚ç”±äºç½‘ç»œäº‹ä»¶æ˜¯æºæºä¸æ–­çš„ï¼Œæ‰€ä»¥åœ¨ä¸»ç¨‹åºä¸­å¯åŠ¨Reactoræ¨¡å¼ï¼Œéœ€è¦ä»¥ <code>while(true){}</code> çš„æ–¹å¼è°ƒç”¨handle_events()æ–¹æ³•ã€‚</p><pre><code>void Reactor::handle_events(){\n  //é€šè¿‡åŒæ­¥äº‹ä»¶å¤šè·¯é€‰æ‹©å™¨æä¾›çš„\n  //select()æ–¹æ³•ç›‘å¬ç½‘ç»œäº‹ä»¶\n  select(handlers);\n  //å¤„ç†ç½‘ç»œäº‹ä»¶\n  for(h in handlers){\n    h.handle_event();\n  }\n}\n// åœ¨ä¸»ç¨‹åºä¸­å¯åŠ¨äº‹ä»¶å¾ªç¯\nwhile (true) {\n  handle_events();\n</code></pre><h2>Nettyä¸­çš„çº¿ç¨‹æ¨¡å‹</h2><p>Nettyçš„å®ç°è™½ç„¶å‚è€ƒäº†Reactoræ¨¡å¼ï¼Œä½†æ˜¯å¹¶æ²¡æœ‰å®Œå…¨ç…§æ¬ï¼Œ<strong>Nettyä¸­æœ€æ ¸å¿ƒçš„æ¦‚å¿µæ˜¯äº‹ä»¶å¾ªç¯ï¼ˆEventLoopï¼‰</strong>ï¼Œå…¶å®ä¹Ÿå°±æ˜¯Reactoræ¨¡å¼ä¸­çš„Reactorï¼Œ<strong>è´Ÿè´£ç›‘å¬ç½‘ç»œäº‹ä»¶å¹¶è°ƒç”¨äº‹ä»¶å¤„ç†å™¨è¿›è¡Œå¤„ç†</strong>ã€‚åœ¨4.xç‰ˆæœ¬çš„Nettyä¸­ï¼Œç½‘ç»œè¿æ¥å’ŒEventLoopæ˜¯ç¨³å®šçš„å¤šå¯¹1å…³ç³»ï¼Œè€ŒEventLoopå’ŒJavaçº¿ç¨‹æ˜¯1å¯¹1å…³ç³»ï¼Œè¿™é‡Œçš„ç¨³å®šæŒ‡çš„æ˜¯å…³ç³»ä¸€æ—¦ç¡®å®šå°±ä¸å†å‘ç”Ÿå˜åŒ–ã€‚ä¹Ÿå°±æ˜¯è¯´ä¸€ä¸ªç½‘ç»œè¿æ¥åªä¼šå¯¹åº”å”¯ä¸€çš„ä¸€ä¸ªEventLoopï¼Œè€Œä¸€ä¸ªEventLoopä¹Ÿåªä¼šå¯¹åº”åˆ°ä¸€ä¸ªJavaçº¿ç¨‹ï¼Œæ‰€ä»¥<strong>ä¸€ä¸ªç½‘ç»œè¿æ¥åªä¼šå¯¹åº”åˆ°ä¸€ä¸ªJavaçº¿ç¨‹</strong>ã€‚</p><p>ä¸€ä¸ªç½‘ç»œè¿æ¥å¯¹åº”åˆ°ä¸€ä¸ªJavaçº¿ç¨‹ä¸Šï¼Œæœ‰ä»€ä¹ˆå¥½å¤„å‘¢ï¼Ÿæœ€å¤§çš„å¥½å¤„å°±æ˜¯å¯¹äºä¸€ä¸ªç½‘ç»œè¿æ¥çš„äº‹ä»¶å¤„ç†æ˜¯å•çº¿ç¨‹çš„ï¼Œè¿™æ ·å°±<strong>é¿å…äº†å„ç§å¹¶å‘é—®é¢˜</strong>ã€‚</p><p>Nettyä¸­çš„çº¿ç¨‹æ¨¡å‹å¯ä»¥å‚è€ƒä¸‹å›¾ï¼Œè¿™ä¸ªå›¾å’Œå‰é¢æˆ‘ä»¬æåˆ°çš„ç†æƒ³çš„çº¿ç¨‹æ¨¡å‹å›¾éå¸¸ç›¸ä¼¼ï¼Œæ ¸å¿ƒç›®æ ‡éƒ½æ˜¯ç”¨ä¸€ä¸ªçº¿ç¨‹å¤„ç†å¤šä¸ªç½‘ç»œè¿æ¥ã€‚</p><p><img src=\"https://static001.geekbang.org/resource/image/03/04/034756f1d76bb3af09e125de9f3c2f04.png?wh=1137*563\" alt=\"\"></p><center><span class=\"reference\">Nettyä¸­çš„çº¿ç¨‹æ¨¡å‹</span></center><p>Nettyä¸­è¿˜æœ‰ä¸€ä¸ªæ ¸å¿ƒæ¦‚å¿µæ˜¯<strong>EventLoopGroup</strong>ï¼Œé¡¾åæ€ä¹‰ï¼Œä¸€ä¸ªEventLoopGroupç”±ä¸€ç»„EventLoopç»„æˆã€‚å®é™…ä½¿ç”¨ä¸­ï¼Œä¸€èˆ¬éƒ½ä¼šåˆ›å»ºä¸¤ä¸ªEventLoopGroupï¼Œä¸€ä¸ªç§°ä¸ºbossGroupï¼Œä¸€ä¸ªç§°ä¸ºworkerGroupã€‚ä¸ºä»€ä¹ˆä¼šæœ‰ä¸¤ä¸ªEventLoopGroupå‘¢ï¼Ÿ</p><p>è¿™ä¸ªå’Œsocketå¤„ç†ç½‘ç»œè¯·æ±‚çš„æœºåˆ¶æœ‰å…³ï¼Œsocketå¤„ç†TCPç½‘ç»œè¿æ¥è¯·æ±‚ï¼Œæ˜¯åœ¨ä¸€ä¸ªç‹¬ç«‹çš„socketä¸­ï¼Œæ¯å½“æœ‰ä¸€ä¸ªTCPè¿æ¥æˆåŠŸå»ºç«‹ï¼Œéƒ½ä¼šåˆ›å»ºä¸€ä¸ªæ–°çš„socketï¼Œä¹‹åå¯¹TCPè¿æ¥çš„è¯»å†™éƒ½æ˜¯ç”±æ–°åˆ›å»ºå¤„ç†çš„socketå®Œæˆçš„ã€‚ä¹Ÿå°±æ˜¯è¯´<strong>å¤„ç†TCPè¿æ¥è¯·æ±‚å’Œè¯»å†™è¯·æ±‚æ˜¯é€šè¿‡ä¸¤ä¸ªä¸åŒçš„socketå®Œæˆçš„</strong>ã€‚ä¸Šé¢æˆ‘ä»¬åœ¨è®¨è®ºç½‘ç»œè¯·æ±‚çš„æ—¶å€™ï¼Œä¸ºäº†ç®€åŒ–æ¨¡å‹ï¼Œåªæ˜¯è®¨è®ºäº†è¯»å†™è¯·æ±‚ï¼Œè€Œæ²¡æœ‰è®¨è®ºè¿æ¥è¯·æ±‚ã€‚</p><p><strong>åœ¨Nettyä¸­ï¼ŒbossGroupå°±ç”¨æ¥å¤„ç†è¿æ¥è¯·æ±‚çš„ï¼Œè€ŒworkerGroupæ˜¯ç”¨æ¥å¤„ç†è¯»å†™è¯·æ±‚çš„</strong>ã€‚bossGroupå¤„ç†å®Œè¿æ¥è¯·æ±‚åï¼Œä¼šå°†è¿™ä¸ªè¿æ¥æäº¤ç»™workerGroupæ¥å¤„ç†ï¼Œ workerGroupé‡Œé¢æœ‰å¤šä¸ªEventLoopï¼Œé‚£æ–°çš„è¿æ¥ä¼šäº¤ç»™å“ªä¸ªEventLoopæ¥å¤„ç†å‘¢ï¼Ÿè¿™å°±éœ€è¦ä¸€ä¸ªè´Ÿè½½å‡è¡¡ç®—æ³•ï¼ŒNettyä¸­ç›®å‰ä½¿ç”¨çš„æ˜¯<strong>è½®è¯¢ç®—æ³•</strong>ã€‚</p><p>ä¸‹é¢æˆ‘ä»¬ç”¨Nettyé‡æ–°å®ç°ä»¥ä¸‹echoç¨‹åºçš„æœåŠ¡ç«¯ï¼Œè¿‘è·ç¦»æ„Ÿå—ä¸€ä¸‹Nettyã€‚</p><h2>ç”¨Nettyå®ç°Echoç¨‹åºæœåŠ¡ç«¯</h2><p>ä¸‹é¢çš„ç¤ºä¾‹ä»£ç åŸºäºNettyå®ç°äº†echoç¨‹åºæœåŠ¡ç«¯ï¼šé¦–å…ˆåˆ›å»ºäº†ä¸€ä¸ªäº‹ä»¶å¤„ç†å™¨ï¼ˆç­‰åŒäºReactoræ¨¡å¼ä¸­çš„äº‹ä»¶å¤„ç†å™¨ï¼‰ï¼Œç„¶ååˆ›å»ºäº†bossGroupå’ŒworkerGroupï¼Œå†ä¹‹ååˆ›å»ºå¹¶åˆå§‹åŒ–äº†ServerBootstrapï¼Œä»£ç è¿˜æ˜¯å¾ˆç®€å•çš„ï¼Œä¸è¿‡æœ‰ä¸¤ä¸ªåœ°æ–¹éœ€è¦æ³¨æ„ä¸€ä¸‹ã€‚</p><p>ç¬¬ä¸€ä¸ªï¼Œå¦‚æœNettybossGroupåªç›‘å¬ä¸€ä¸ªç«¯å£ï¼Œé‚£bossGroupåªéœ€è¦1ä¸ªEventLoopå°±å¯ä»¥äº†ï¼Œå¤šäº†çº¯å±æµªè´¹ã€‚</p><p>ç¬¬äºŒä¸ªï¼Œé»˜è®¤æƒ…å†µä¸‹ï¼ŒNettyä¼šåˆ›å»ºâ€œ2*CPUæ ¸æ•°â€ä¸ªEventLoopï¼Œç”±äºç½‘ç»œè¿æ¥ä¸EventLoopæœ‰ç¨³å®šçš„å…³ç³»ï¼Œæ‰€ä»¥äº‹ä»¶å¤„ç†å™¨åœ¨å¤„ç†ç½‘ç»œäº‹ä»¶çš„æ—¶å€™æ˜¯ä¸èƒ½æœ‰é˜»å¡æ“ä½œçš„ï¼Œå¦åˆ™å¾ˆå®¹æ˜“å¯¼è‡´è¯·æ±‚å¤§é¢ç§¯è¶…æ—¶ã€‚å¦‚æœå®åœ¨æ— æ³•é¿å…ä½¿ç”¨é˜»å¡æ“ä½œï¼Œé‚£å¯ä»¥é€šè¿‡çº¿ç¨‹æ± æ¥å¼‚æ­¥å¤„ç†ã€‚</p><pre><code>//äº‹ä»¶å¤„ç†å™¨\nfinal EchoServerHandler serverHandler \n  = new EchoServerHandler();\n//bossçº¿ç¨‹ç»„  \nEventLoopGroup bossGroup \n  = new NioEventLoopGroup(1); \n//workerçº¿ç¨‹ç»„  \nEventLoopGroup workerGroup \n  = new NioEventLoopGroup();\ntry {\n  ServerBootstrap b = new ServerBootstrap();\n  b.group(bossGroup, workerGroup)\n   .channel(NioServerSocketChannel.class)\n   .childHandler(new ChannelInitializer&lt;SocketChannel&gt;() {\n     @Override\n     public void initChannel(SocketChannel ch){\n       ch.pipeline().addLast(serverHandler);\n     }\n    });\n  //bindæœåŠ¡ç«¯ç«¯å£  \n  ChannelFuture f = b.bind(9090).sync();\n  f.channel().closeFuture().sync();\n} finally {\n  //ç»ˆæ­¢å·¥ä½œçº¿ç¨‹ç»„\n  workerGroup.shutdownGracefully();\n  //ç»ˆæ­¢bossçº¿ç¨‹ç»„\n  bossGroup.shutdownGracefully();\n}\n\n//socketè¿æ¥å¤„ç†å™¨\nclass EchoServerHandler extends \n    ChannelInboundHandlerAdapter {\n  //å¤„ç†è¯»äº‹ä»¶  \n  @Override\n  public void channelRead(\n    ChannelHandlerContext ctx, Object msg){\n      ctx.write(msg);\n  }\n  //å¤„ç†è¯»å®Œæˆäº‹ä»¶\n  @Override\n  public void channelReadComplete(\n    ChannelHandlerContext ctx){\n      ctx.flush();\n  }\n  //å¤„ç†å¼‚å¸¸äº‹ä»¶\n  @Override\n  public void exceptionCaught(\n    ChannelHandlerContext ctx,  Throwable cause) {\n      cause.printStackTrace();\n      ctx.close();\n  }\n}\n</code></pre><h2>æ€»ç»“</h2><p>Nettyæ˜¯ä¸€ä¸ªæ¬¾ä¼˜ç§€çš„ç½‘ç»œç¼–ç¨‹æ¡†æ¶ï¼Œæ€§èƒ½éå¸¸å¥½ï¼Œä¸ºäº†å®ç°é«˜æ€§èƒ½çš„ç›®æ ‡ï¼ŒNettyåšäº†å¾ˆå¤šä¼˜åŒ–ï¼Œä¾‹å¦‚ä¼˜åŒ–äº†ByteBufferã€æ”¯æŒé›¶æ‹·è´ç­‰ç­‰ï¼Œå’Œå¹¶å‘ç¼–ç¨‹ç›¸å…³çš„å°±æ˜¯å®ƒçš„çº¿ç¨‹æ¨¡å‹äº†ã€‚Nettyçš„çº¿ç¨‹æ¨¡å‹è®¾è®¡å¾—å¾ˆç²¾å·§ï¼Œæ¯ä¸ªç½‘ç»œè¿æ¥éƒ½å…³è”åˆ°äº†ä¸€ä¸ªçº¿ç¨‹ä¸Šï¼Œè¿™æ ·åšçš„å¥½å¤„æ˜¯ï¼šå¯¹äºä¸€ä¸ªç½‘ç»œè¿æ¥ï¼Œè¯»å†™æ“ä½œéƒ½æ˜¯å•çº¿ç¨‹æ‰§è¡Œçš„ï¼Œä»è€Œé¿å…äº†å¹¶å‘ç¨‹åºçš„å„ç§é—®é¢˜ã€‚</p><p>ä½ è¦æƒ³æ·±å…¥ç†è§£Nettyçš„çº¿ç¨‹æ¨¡å‹ï¼Œè¿˜éœ€è¦å¯¹ç½‘ç»œç›¸å…³çŸ¥è¯†æœ‰ä¸€å®šçš„ç†è§£ï¼Œå…³äºJava IOçš„æ¼”è¿›è¿‡ç¨‹ï¼Œä½ å¯ä»¥å‚è€ƒ<a href=\"http://gee.cs.oswego.edu/dl/cpjslides/nio.pdf\">Scalable IO in Java</a>ï¼Œè‡³äºTCP/IPç½‘ç»œç¼–ç¨‹çš„çŸ¥è¯†ä½ å¯ä»¥å‚è€ƒéŸ©å›½å°¹åœ£é›¨å†™çš„ç»å…¸æ•™ç¨‹â€”â€”ã€ŠTCP/IPç½‘ç»œç¼–ç¨‹ã€‹ã€‚</p><p>æ¬¢è¿åœ¨ç•™è¨€åŒºä¸æˆ‘åˆ†äº«ä½ çš„æƒ³æ³•ï¼Œä¹Ÿæ¬¢è¿ä½ åœ¨ç•™è¨€åŒºè®°å½•ä½ çš„æ€è€ƒè¿‡ç¨‹ã€‚æ„Ÿè°¢é˜…è¯»ï¼Œå¦‚æœä½ è§‰å¾—è¿™ç¯‡æ–‡ç« å¯¹ä½ æœ‰å¸®åŠ©çš„è¯ï¼Œä¹Ÿæ¬¢è¿æŠŠå®ƒåˆ†äº«ç»™æ›´å¤šçš„æœ‹å‹ã€‚</p><p></p>","comments":[{"had_liked":false,"id":98777,"user_name":"ç‹ç»´","can_delete":false,"product_type":"c1","uid":1001099,"ip_address":"","ucode":"3C1FE3153BBDA4","user_header":"https://static001.geekbang.org/account/avatar/00/0f/46/8b/97601f22.jpg","comment_is_top":false,"comment_ctime":1559093998,"is_pvip":true,"discussion_count":2,"race_medal":0,"score":"242077262574","product_id":100023901,"comment_content":"åˆ†äº«ä¸€ä¸‹æˆ‘ä¹‹å‰å­¦Nettyçš„å­¦ä¹ ç¬”è®°ï¼Œä¸»è¦æ˜¯æºç åˆ†æï¼šhttps:&#47;&#47;wangwei.one&#47;tags&#47;Netty&#47;","like_count":55,"discussions":[{"author":{"id":2756739,"avatar":"https://static001.geekbang.org/account/avatar/00/2a/10/83/0facd0eb.jpg","nickname":"åˆ©å¨å°”å…µé•¿","note":"","ucode":"FDE0BD5BFB1B4A","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":538226,"discussion_content":"æ„Ÿè°¢","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1639374375,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1214499,"avatar":"https://static001.geekbang.org/account/avatar/00/12/88/23/a0966b4d.jpg","nickname":"Tim Zhang","note":"","ucode":"4956AC5FE45EE1","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":274279,"discussion_content":"è¯·æ•™ä¸‹ï¼Œä½ çš„åšå®¢æ¨¡æ¿çš„åœ°å€èƒ½æä¾›ä¸‹å—","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1590561799,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":98455,"user_name":"é‚£åªç¾Š","can_delete":false,"product_type":"c1","uid":1104184,"ip_address":"","ucode":"9F2C0E12E7A463","user_header":"https://static001.geekbang.org/account/avatar/00/10/d9/38/853be0c3.jpg","comment_is_top":false,"comment_ctime":1559005914,"is_pvip":false,"replies":[{"id":"35269","content":"ğŸ‘æ„Ÿè°¢å›å¤ï¼","user_name":"ä½œè€…å›å¤","user_name_real":"ç‹å®ä»¤","uid":"1269969","ctime":1559044339,"ip_address":"","comment_id":98455,"utype":1}],"discussion_count":1,"race_medal":0,"score":"134702992090","product_id":100023901,"comment_content":"QQæ€ªï¼šNettyå¯ä»¥å…ˆä»ã€ŠNettyå®æˆ˜ã€‹å¼€å§‹ï¼Œè™½ç„¶ç¿»è¯‘å¾—ä¸€èˆ¬ï¼Œä½†æ˜¯å¯¹äºå®ƒçš„æ•´ä½“åŠå„ä¸ªç»„ä»¶ä½ éƒ½èƒ½äº†è§£åˆ°ï¼›å†å°±æ˜¯è°ƒè¯•æºç æ¥äº†è§£å®ƒäº†ï¼›æœ€ååº”ç”¨åˆ°é¡¹ç›®ä¸­å»å•¦ï¼Œæ¯”å¦‚å®ç°ä¸€ä¸ªç®€å•çš„RPCï¼Œä¸€ä¸ªIMä¹‹ç±»çš„","like_count":32,"discussions":[{"author":{"id":1269969,"avatar":"https://static001.geekbang.org/account/avatar/00/13/60/d1/8efa89ab.jpg","nickname":"ç‹å®ä»¤","note":"","ucode":"4FE19F5BC32FCA","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":451694,"discussion_content":"ğŸ‘æ„Ÿè°¢å›å¤ï¼","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1559044339,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":209708,"user_name":"ä¾§è€³å€¾å¬","can_delete":false,"product_type":"c1","uid":1512642,"ip_address":"","ucode":"5BF2A2440B54F0","user_header":"https://static001.geekbang.org/account/avatar/00/17/14/c2/46ebe3a0.jpg","comment_is_top":false,"comment_ctime":1587603553,"is_pvip":true,"discussion_count":3,"race_medal":0,"score":"104666818657","product_id":100023901,"comment_content":"ä½ å¦‚æœå¯¹java nioæ¯”è¾ƒäº†è§£çš„è¯ï¼Œåº”è¯¥å°±æ˜ç™½nettyçš„çº¿ç¨‹æ¨¡å‹ã€‚tomcatæ˜¯åœ¨æ”¶åˆ°è¯·æ±‚çš„æ—¶å€™ï¼Œä¸ºæ¯ä¸€ä¸ªè¯·æ±‚åˆ›å»ºä¸€ä¸ªçº¿ç¨‹å¤„ç†è¯¥æ¬¡è¯·æ±‚ï¼Œæ¶ˆè€—çš„æ˜¯æœåŠ¡å™¨çš„çº¿ç¨‹æ± ï¼Œå½“å¹¶å‘è¿æ¥æ•°å¤§çš„æ—¶å€™ï¼Œæ€§èƒ½ä¸‹é™å¾ˆå¿«ã€‚ngixç›¸è¾ƒäºtomcatçš„åŒºåˆ«å°±åœ¨äºå¤„ç†è¯·æ±‚è¿æ¥çš„çº¿ç¨‹åªæœ‰ä¸€ä¸ªï¼Œç›¸å½“äºä¸€ä¸ªåˆ†å‘å™¨ï¼Œåªè´Ÿè´£æ¥å—è¯·æ±‚ï¼Œä¸è´Ÿè´£å¤„ç†è¯·æ±‚ï¼Œè¿æ¥å»ºç«‹æˆåŠŸåï¼Œä¸ºè¯¥è¿æ¥åˆ†å‘ä¸€ä¸ªå·¥ä½œçº¿ç¨‹å¤„ç†è¯·æ±‚å’Œè¿”å›ç»“æœã€‚è¿™æ ·å­çš„è¯ï¼ŒæœåŠ¡å™¨çš„æœ€å¤§å¹¶å‘æ•°å°±æ²¡æœ‰äº†é™åˆ¶ï¼Œå—é™çš„å°±æ˜¯æœåŠ¡å™¨çš„ç¡¬ä»¶æ‰€èƒ½æ”¯æŒçš„æœ€å¤§å¹¶å‘ï¼Œè¿™ä¸€å—å¯ä»¥é€šè¿‡æ¨ªå‘æˆ–è€…çºµå‘æ‰©å±•æ¥è§£å†³ã€‚nettyçš„çº¿ç¨‹æ¨¡å‹ä¹Ÿæ˜¯å¦‚æ­¤ï¼Œä¸€ä¸ªè´Ÿè´£æ¥å—ï¼Œä¸€ä¸ªè´Ÿè´£å¤„ç†ï¼Œå°±æ˜¯ä¹‹å‰è®²è¿°çš„Work threadæ¨¡å¼","like_count":25,"discussions":[{"author":{"id":1144091,"avatar":"https://static001.geekbang.org/account/avatar/00/11/75/1b/8e3f2ee8.jpg","nickname":"é™†å¤§é”¤","note":"","ucode":"80C2AFEFC218AA","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":320276,"discussion_content":"æˆ‘çœ‹çš„tomcat9åšäº†ä¼˜åŒ–äº†ï¼Œæ–°æ¥ä»»åŠ¡ä¹Ÿæ˜¯æ”¾çº¿ç¨‹æ± ï¼Œä¸æ–°å»ºçº¿ç¨‹ï¼Œéƒ½ä¾èµ–çº¿ç¨‹æ± å¤„ç†ã€‚ä¹Ÿæ˜¯ä¸€ä¸ªçº¿ç¨‹æ¥å—è¯·æ±‚ï¼Œä¸€ä¸ªè´Ÿè´£åˆ†å‘ã€‚","likes_number":3,"is_delete":false,"is_hidden":false,"ctime":1604306710,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":2683430,"avatar":"https://static001.geekbang.org/account/avatar/00/28/f2/26/a8ac6b42.jpg","nickname":"å¬é£æœ‰ä¿¡","note":"","ucode":"2CCB467114FF5C","race_medal":0,"user_type":1,"is_pvip":true},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":392660,"discussion_content":"tomcatä¹Ÿæ˜¯çº¿ç¨‹æ± ","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1631091203,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1810156,"avatar":"","nickname":"poordickey","note":"","ucode":"2A436EC813AF97","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":340979,"discussion_content":"springbooté›†æˆäº†tomcat  ä¹Ÿå°±æ˜¯è¯´  æ”¯æŒçš„å¹¶å‘å¹¶ä¸ä¼šå¤ªé«˜  æ˜¯å§","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1610248768,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":98388,"user_name":"QQæ€ª","can_delete":false,"product_type":"c1","uid":1211223,"ip_address":"","ucode":"1A39B8433D9208","user_header":"https://static001.geekbang.org/account/avatar/00/12/7b/57/a9b04544.jpg","comment_is_top":false,"comment_ctime":1558974181,"is_pvip":false,"replies":[{"id":"35270","content":"çƒ­å¿ƒåŒå­¦å›å¤äº†ï¼Œæˆ‘å†åŠ ä¸€ç‚¹å°±æ˜¯æŠŠç½‘ç»œç¼–ç¨‹çš„åŸºç¡€æå¥½","user_name":"ä½œè€…å›å¤","user_name_real":"ç‹å®ä»¤","uid":"1269969","ctime":1559044628,"ip_address":"","comment_id":98388,"utype":1}],"discussion_count":1,"race_medal":0,"score":"65983483621","product_id":100023901,"comment_content":"è€å¸ˆï¼Œå­¦ä¹ nettyé™¤äº†å­¦ä¹ è€å¸ˆçš„ä¸“æ è¿˜æœ‰ä»€ä¹ˆä»å…¥é—¨åˆ°ä¸“ç²¾çš„å­¦ä¹ è·¯çº¿å—ï¼Ÿ","like_count":16,"discussions":[{"author":{"id":1269969,"avatar":"https://static001.geekbang.org/account/avatar/00/13/60/d1/8efa89ab.jpg","nickname":"ç‹å®ä»¤","note":"","ucode":"4FE19F5BC32FCA","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":451671,"discussion_content":"çƒ­å¿ƒåŒå­¦å›å¤äº†ï¼Œæˆ‘å†åŠ ä¸€ç‚¹å°±æ˜¯æŠŠç½‘ç»œç¼–ç¨‹çš„åŸºç¡€æå¥½","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1559044628,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":132170,"user_name":"å¢™è§’å„¿çš„èŠ±","can_delete":false,"product_type":"c1","uid":1258474,"ip_address":"","ucode":"EE5CAD76175CCF","user_header":"","comment_is_top":false,"comment_ctime":1568035548,"is_pvip":false,"replies":[{"id":"50591","content":"ğŸ˜„","user_name":"ä½œè€…å›å¤","user_name_real":"ç‹å®ä»¤","uid":"1269969","ctime":1568083340,"ip_address":"","comment_id":132170,"utype":1}],"discussion_count":1,"race_medal":0,"score":"40222741212","product_id":100023901,"comment_content":"è¿™æ˜¯æˆ‘è¯»è¿‡çš„æœ€å¥½çš„nettyåŸºæœ¬åŸç†ä»‹ç»","like_count":10,"discussions":[{"author":{"id":1269969,"avatar":"https://static001.geekbang.org/account/avatar/00/13/60/d1/8efa89ab.jpg","nickname":"ç‹å®ä»¤","note":"","ucode":"4FE19F5BC32FCA","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":466798,"discussion_content":"ğŸ˜„","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1568083340,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":98475,"user_name":"å‘¨æ²»æ…§","can_delete":false,"product_type":"c1","uid":1335293,"ip_address":"","ucode":"7D56C4E66BEE17","user_header":"https://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTKR3ibELhjgVicCNShZCBwvaDxibnzibggG4wUzVkS2mkDxUBZyIs87nDEdJ7PiahJBVoZcuhQ84RxAziag/132","comment_is_top":false,"comment_ctime":1559008193,"is_pvip":false,"discussion_count":5,"race_medal":0,"score":"27328811969","product_id":100023901,"comment_content":"æ²¡å¤ªæ˜ç™½nettyçš„çº¿ç¨‹æ¨¡å‹ï¼Œè€å¸ˆè¯´ä¸€ä¸ªsocketå¯¹åº”ä¸€ä¸ªJavaçº¿ç¨‹ï¼Œä¸€ä¸ªJavaçº¿ç¨‹å¯¹åº”ä¸€ä¸ªeventGroupï¼Œé‚£å›¾ä¸­ä¸åº”è¯¥æ˜¯ä¸€ä¸ªsocketå¯¹åº”ä¸€ä¸ªeventgroupå—","like_count":7,"discussions":[{"author":{"id":1226462,"avatar":"https://static001.geekbang.org/account/avatar/00/12/b6/de/95dc7537.jpg","nickname":"åŒ","note":"","ucode":"9A6A370DAD648E","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":951,"discussion_content":"ä»¥ä¸‹å†…å®¹å¹¶ä¸ç²¾ç¡®ï¼Œä½†æ˜¯å¯ä»¥å¸®åŠ©ä½ ç†è§£ï¼šä½ å¯ä»¥ç®€å•çš„ç†è§£eventGroupå°±æ˜¯ä¸€ä¸ªçº¿ç¨‹ï¼Œ1ä¸ªè¿æ¥åªèƒ½å¯¹åº”åˆ°ä¸€ä¸ªçº¿ç¨‹(eventGroup)ä¸Šï¼Œä½†æ˜¯åè¿‡æ¥ä¸€ä¸ªeventGroupå¯ä»¥åŒæ—¶å¤„ç†å¤šä¸ªè¿æ¥çš„ã€‚nettyçš„çº¿ç¨‹æ¨¡å‹è®¾è®¡å¾ˆä¼˜é›…çš„ï¼Œä¸²è¡ŒåŒ–çš„è®¾è®¡ï¼Œå°±æ˜¯ä¸ºäº†é¿å…ä¸Šä¸‹æ–‡åˆ‡æ¢å¼€é”€å’Œçº¿ç¨‹å®‰å…¨ç­‰ç³»åˆ—é—®é¢˜...","likes_number":3,"is_delete":false,"is_hidden":false,"ctime":1562203595,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":2,"child_discussions":[{"author":{"id":1010192,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/6a/10/4d2d6e64.jpg","nickname":"åŠ³åŠ¨ç»´æƒ","note":"","ucode":"1D5CEB96618E01","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":1226462,"avatar":"https://static001.geekbang.org/account/avatar/00/12/b6/de/95dc7537.jpg","nickname":"åŒ","note":"","ucode":"9A6A370DAD648E","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":102620,"discussion_content":"ä½ ç†è§£é”™äº†ï¼Œåœ¨nettyä¸­ä¸€ä¸ªsingleThreadEventExecutorï¼Œä¹Ÿå°±æ˜¯å„ç§EventLoopçš„åŸºç±»ï¼Œæ‰æ˜¯ç”±ä¸€ä¸ªçº¿ç¨‹æ”¯æ’‘ï¼Œå¯ä»¥å¾ˆæ˜æ˜¾çœ‹åˆ°è¯¥ç±»é‡Œæœ‰ä¸€ä¸ªThreadç±»å‹çš„æˆå‘˜å˜é‡ï¼Œè€ŒEventLoopGroupæ˜¯EventLoopçš„æ•°ç»„","likes_number":3,"is_delete":false,"is_hidden":false,"ctime":1577357129,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":951,"ip_address":""},"score":102620,"extra":""},{"author":{"id":1325994,"avatar":"https://static001.geekbang.org/account/avatar/00/14/3b/aa/e8dfcd7e.jpg","nickname":"AAA_å¶å­","note":"","ucode":"1E93617D308EE0","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":1226462,"avatar":"https://static001.geekbang.org/account/avatar/00/12/b6/de/95dc7537.jpg","nickname":"åŒ","note":"","ucode":"9A6A370DAD648E","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":296407,"discussion_content":"æ˜¯eventLoop  ä¸æ˜¯eventGroup","likes_number":1,"is_delete":false,"is_hidden":false,"ctime":1596533763,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":951,"ip_address":""},"score":296407,"extra":""}]},{"author":{"id":1810156,"avatar":"","nickname":"poordickey","note":"","ucode":"2A436EC813AF97","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":340980,"discussion_content":"ä½ æ²¡ç†è§£è€å¸ˆçš„è¯   ä½ é¡ºç€ç†è§£å°±å¯¹äº† å°±æ˜¯æ¯ä¸ªsocketçš„è¯·æ±‚ä¸€å®šåœ¨ä¸€ä¸ªeventLoopé‡Œ","likes_number":1,"is_delete":false,"is_hidden":false,"ctime":1610249218,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1226462,"avatar":"https://static001.geekbang.org/account/avatar/00/12/b6/de/95dc7537.jpg","nickname":"åŒ","note":"","ucode":"9A6A370DAD648E","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":950,"discussion_content":"1 ä¸ª NIO çº¿ç¨‹å¯ä»¥åŒæ—¶å¤„ç† N æ¡é“¾è·¯ï¼Œä½†æ˜¯ 1 ä¸ªé“¾è·¯åªå¯¹åº” 1 ä¸ª NIO çº¿ç¨‹ï¼Œé˜²æ­¢å‘ç”Ÿå¹¶å‘æ“ä½œé—®é¢˜ã€‚","likes_number":1,"is_delete":false,"is_hidden":false,"ctime":1562203135,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":169708,"user_name":"Monday","can_delete":false,"product_type":"c1","uid":1250907,"ip_address":"","ucode":"77B9BACC783598","user_header":"https://static001.geekbang.org/account/avatar/00/13/16/5b/83a35681.jpg","comment_is_top":false,"comment_ctime":1578408931,"is_pvip":false,"discussion_count":1,"race_medal":0,"score":"18758278115","product_id":100023901,"comment_content":"ç½‘ç»œç¼–ç¨‹å’Œæ–‡ä»¶æ“ä½œæ˜¯æˆ‘çš„ç–¼ï¼Œä»Šå¤©åˆç–¼äº†â€¦å¸Œæœ›ç–¼ç€ç–¼ç€å°±å¥½äº†","like_count":5,"discussions":[{"author":{"id":2288362,"avatar":"https://static001.geekbang.org/account/avatar/00/22/ea/ea/77a59153.jpg","nickname":"è€¶é©¬","note":"","ucode":"3A3CF67B016CDB","race_medal":0,"user_type":1,"is_pvip":true},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":547017,"discussion_content":"æ­£å¸¸å¤´ç–¼ ,ç»å¸¸çš„å¤´ç–¼","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1642496373,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":98619,"user_name":"Sunqc","can_delete":false,"product_type":"c1","uid":1473717,"ip_address":"","ucode":"2C54659635403F","user_header":"https://static001.geekbang.org/account/avatar/00/16/7c/b5/4a7a2bd4.jpg","comment_is_top":false,"comment_ctime":1559043291,"is_pvip":false,"replies":[{"id":"35298","content":"æ„Ÿè°¢ä¿¡ä»»ğŸ˜„å†™ä¸åŠ¨äº†ğŸ˜‚ğŸ˜‚ğŸ˜‚","user_name":"ä½œè€…å›å¤","user_name_real":"ç‹å®ä»¤","uid":"1269969","ctime":1559055556,"ip_address":"","comment_id":98619,"utype":1}],"discussion_count":2,"race_medal":0,"score":"18738912475","product_id":100023901,"comment_content":"æˆ‘æƒ³çŸ¥é“è€å¸ˆåç»­æœ‰å‘å¸ƒæ–°çš„è¯¾ç¨‹å—ï¼Œå–œæ¬¢ä½ çš„è¯¾ç¨‹","like_count":5,"discussions":[{"author":{"id":1269969,"avatar":"https://static001.geekbang.org/account/avatar/00/13/60/d1/8efa89ab.jpg","nickname":"ç‹å®ä»¤","note":"","ucode":"4FE19F5BC32FCA","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":451756,"discussion_content":"æ„Ÿè°¢ä¿¡ä»»ğŸ˜„å†™ä¸åŠ¨äº†ğŸ˜‚ğŸ˜‚ğŸ˜‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1559055556,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1225224,"avatar":"https://static001.geekbang.org/account/avatar/00/12/b2/08/92f42622.jpg","nickname":"å°”å†¬æ©™","note":"","ucode":"0B013A49BC18DA","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":2502,"discussion_content":"è€å¸ˆå¯ä»¥å†™ç½‘ç»œç¼–ç¨‹","likes_number":2,"is_delete":false,"is_hidden":false,"ctime":1563727892,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":99011,"user_name":"å¼ å¾·","can_delete":false,"product_type":"c1","uid":1101929,"ip_address":"","ucode":"31FE63E8725EFC","user_header":"https://static001.geekbang.org/account/avatar/00/10/d0/69/5dbdc245.jpg","comment_is_top":false,"comment_ctime":1559130109,"is_pvip":false,"replies":[{"id":"35577","content":"å¯¹ä½ æœ‰å¸®åŠ©å°±å¥½ğŸ˜„","user_name":"ä½œè€…å›å¤","user_name_real":"ç‹å®ä»¤","uid":"1269969","ctime":1559138926,"ip_address":"","comment_id":99011,"utype":1}],"discussion_count":1,"race_medal":0,"score":"14444031997","product_id":100023901,"comment_content":"è°¢è°¢è€å¸ˆè®²è¿™ä¸ªreactoræ¨¡å¼  æˆ‘æœ€è¿‘è¦ä¼˜åŒ–çš„ç³»ç»Ÿä¸»ä½“å°±æ˜¯é‡‡ç”¨è¿™ä¸ªæ¨¡å¼  ä»Šå¤©çœ‹äº†ä¸€å¤©éƒ½äº‘é‡Œé›¾é‡Œçš„  çœ‹åˆ°è¿™ç¯‡æ–‡ç« ç¬é—´æœ‰äº†ä¸€ç§æœ‰ç« å¯å¾ªçš„æ„Ÿè§‰","like_count":4,"discussions":[{"author":{"id":1269969,"avatar":"https://static001.geekbang.org/account/avatar/00/13/60/d1/8efa89ab.jpg","nickname":"ç‹å®ä»¤","note":"","ucode":"4FE19F5BC32FCA","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":451937,"discussion_content":"å¯¹ä½ æœ‰å¸®åŠ©å°±å¥½ğŸ˜„","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1559138926,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":245543,"user_name":"è“å±±","can_delete":false,"product_type":"c1","uid":1066264,"ip_address":"","ucode":"FBF673D51FF644","user_header":"https://static001.geekbang.org/account/avatar/00/10/45/18/3d05adb4.jpg","comment_is_top":false,"comment_ctime":1598972519,"is_pvip":false,"replies":[{"id":"90437","content":"ğŸ‘ğŸ»","user_name":"ä½œè€…å›å¤","user_name_real":"ç‹å®ä»¤","uid":"1269969","ctime":1599176405,"ip_address":"","comment_id":245543,"utype":1}],"discussion_count":1,"race_medal":0,"score":"5893939815","product_id":100023901,"comment_content":"ç½‘ç»œé€šä¿¡ç¨‹åºæ€§èƒ½è®¾è®¡é‡ç‚¹è¦å…³æ³¨ä¸‰ä¸ªæ–¹é¢ï¼š<br>1ã€ç½‘ç»œä¼ è¾“æ–¹å¼ï¼šåŒæ­¥é˜»å¡æ–¹å¼ã€å¼‚æ­¥éé˜»å¡æ–¹å¼ï¼›<br>2ã€æ•°æ®åºåˆ—åŒ–ï¼šJavaåºåˆ—åŒ–ï¼ˆåŸºæœ¬ä¸èƒ½è€ƒè™‘ï¼‰ã€protobufã€jasonã€Avroç­‰ç­‰ï¼›<br>3ã€ç½‘ç»œIOå¤„ç†çº¿ç¨‹æ¨¡å‹ï¼šåŒæ­¥é˜»å¡IOã€åŒæ­¥éé˜»å¡IOã€IOå¤šè·¯å¤ç”¨ï¼ˆReactoræ¨¡å¼ï¼‰ã€AIOå¼‚æ­¥IOï¼›<br>Nettyåœ¨åº”å¯¹è§£å†³ä¸Šè¿°ä¸‰ä¸ªé—®é¢˜ä¸­æä¾›äº†æ¯”è¾ƒå®Œå–„çš„æ–¹æ¡ˆã€‚é‡‡ç”¨IOå¤šè·¯å¤ç”¨æœºåˆ¶å®ç°ç½‘ç»œä¼ è¾“ï¼ŒåŒæ—¶é…åˆçµæ´»çš„reactorå®ç°æ¨¡å¼ï¼Œæ”¯æŒé€šè¿‡ç¼–ç çµæ´»é€‰æ‹©ä¸åŒçš„reactoræ¨¡å¼ä»¥åº”å¯¹ä¸åŒè´Ÿè½½å’Œæ€§èƒ½è¦æ±‚çš„åœºæ™¯ã€‚åŒæ—¶æä¾›äº†å®Œå–„çš„å¼‚æ­¥äº‹ä»¶é©±åŠ¨å®ç°å’ŒAPIï¼Œä¸ºå¼€å‘äººå‘˜æä¾›äº†å¦‚ä½•è·å–æ•°æ®ã€æ•°æ®ç¼–è§£ç ã€ç¼–è§£ç ä¹‹åä¸šåŠ¡å¤„ç†çº¿ç¨‹å…·ä½“åœ¨å“ªä¸ªçº¿ç¨‹æ‰§è¡Œã€ç¼–è§£ç ä¹‹åæ¶ˆæ¯å¦‚ä½•æ´¾å‘ç­‰ç­‰çµæ´»ä¸”æ–¹ä¾¿çš„æœºåˆ¶ã€‚åŒæ—¶åœ¨åè®®å±‚é¢ç›´æ¥æ”¯æŒäº†é€šç”¨çš„ç½‘ç»œé€šè®¯åè®®ï¼ŒåŒæ—¶å¯¹äºæ‰©å±•é’ˆå¯¹ä¸ªæ€§åŒ–æ€§èƒ½éœ€æ±‚çš„ç§æœ‰åŒ–åè®®å®šåˆ¶æä¾›äº†ä¾¿åˆ©çš„å¼€å‘å·¥å…·æ”¯æŒã€‚","like_count":2,"discussions":[{"author":{"id":1269969,"avatar":"https://static001.geekbang.org/account/avatar/00/13/60/d1/8efa89ab.jpg","nickname":"ç‹å®ä»¤","note":"","ucode":"4FE19F5BC32FCA","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":504913,"discussion_content":"ğŸ‘ğŸ»","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1599176405,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":198018,"user_name":"0xTang","can_delete":false,"product_type":"c1","uid":1019659,"ip_address":"","ucode":"82F5282EF3044B","user_header":"https://static001.geekbang.org/account/avatar/00/0f/8f/0b/a438de52.jpg","comment_is_top":false,"comment_ctime":1585406958,"is_pvip":false,"discussion_count":1,"race_medal":0,"score":"5880374254","product_id":100023901,"comment_content":"Tcpå¤„ç†è¿æ¥å’Œioåˆ†2ä¸ªsocketè¿™ä¸ªçŸ¥è¯†ç‚¹æœ‰ç”¨ã€‚","like_count":1,"discussions":[{"author":{"id":1277081,"avatar":"https://static001.geekbang.org/account/avatar/00/13/7c/99/4dac6ce6.jpg","nickname":"lakeslove","note":"","ucode":"65E14D29D3C981","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":319421,"discussion_content":"å¯ä»¥çœ‹ä¸€ä¸‹ç½‘ç»œç¼–ç¨‹å®æˆ˜è¿™ä¸ªä¸“æ ï¼Œä¸è¿‡è¦æ±‚æœ‰ç‚¹cè¯­è¨€åŸºç¡€","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1604026489,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":100791,"user_name":"æ½­å·å¤ªå®ˆ","can_delete":false,"product_type":"c1","uid":1178824,"ip_address":"","ucode":"1DA953B8DCA3C0","user_header":"https://static001.geekbang.org/account/avatar/00/11/fc/c8/15c85ee4.jpg","comment_is_top":false,"comment_ctime":1559640080,"is_pvip":false,"replies":[{"id":"36789","content":"æˆ‘æ²¡è¿™ä¹ˆæƒ³è¿‡ğŸ˜‚æ€è·¯ä¸Šå¥½åƒä¹Ÿæœ‰ç›¸é€šçš„åœ°æ–¹ï¼Œä¸è¿‡æ„Ÿè§‰è¿˜ä¸æ˜¯","user_name":"ä½œè€…å›å¤","user_name_real":"ç‹å®ä»¤","uid":"1269969","ctime":1560129131,"ip_address":"","comment_id":100791,"utype":1}],"discussion_count":1,"race_medal":0,"score":"5854607376","product_id":100023901,"comment_content":"è€å¸ˆï¼ŒReactorå¯ä»¥ç†è§£æ˜¯Actoræ¨¡å¼çš„ä¸€ç§å—","like_count":1,"discussions":[{"author":{"id":1269969,"avatar":"https://static001.geekbang.org/account/avatar/00/13/60/d1/8efa89ab.jpg","nickname":"ç‹å®ä»¤","note":"","ucode":"4FE19F5BC32FCA","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":452680,"discussion_content":"æˆ‘æ²¡è¿™ä¹ˆæƒ³è¿‡ğŸ˜‚æ€è·¯ä¸Šå¥½åƒä¹Ÿæœ‰ç›¸é€šçš„åœ°æ–¹ï¼Œä¸è¿‡æ„Ÿè§‰è¿˜ä¸æ˜¯","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1560129131,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":98655,"user_name":"å¼ ä¸‰","can_delete":false,"product_type":"c1","uid":1004092,"ip_address":"","ucode":"1155528FAE1546","user_header":"https://static001.geekbang.org/account/avatar/00/0f/52/3c/d6fcb93a.jpg","comment_is_top":false,"comment_ctime":1559051278,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"5854018574","product_id":100023901,"comment_content":"æ‰“å¡ï¼äº†è§£çš®æ¯›æ˜¯ä¸å¤Ÿçš„ã€‚","like_count":1},{"had_liked":false,"id":272712,"user_name":"poordickey","can_delete":false,"product_type":"c1","uid":1810156,"ip_address":"","ucode":"2A436EC813AF97","user_header":"","comment_is_top":false,"comment_ctime":1610249516,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1610249516","product_id":100023901,"comment_content":"è¿™æ˜¯æ¸Šåšçš„äºº  å†™çš„æ–‡ç« å’Œä¸€èˆ¬äººå†™çš„åšå®¢åŒºåˆ«çœŸçš„å¤ªå¤§äº†  è·Ÿç€å­¦ä¹ æ€ç»´ä¸æ–­å‘æ•£ æ„Ÿè§‰å¯ä»¥ä¸²èµ·æ¥å¥½å¤šçŸ¥è¯†ç‚¹  æ€ªä¸å¾—è€å¸ˆå¼ºè°ƒè®©æˆ‘ä»¬æœ‰æ“ä½œç³»ç»Ÿçš„åŸºç¡€å‘¢ ","like_count":1},{"had_liked":false,"id":258082,"user_name":"coder","can_delete":false,"product_type":"c1","uid":1656956,"ip_address":"","ucode":"3A0940EBF94577","user_header":"https://static001.geekbang.org/account/avatar/00/19/48/7c/2aaf50e5.jpg","comment_is_top":false,"comment_ctime":1604289078,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1604289078","product_id":100023901,"comment_content":"å†™å¾—å¤ªå¥½äº†å§","like_count":0},{"had_liked":false,"id":257174,"user_name":"mgs2002","can_delete":false,"product_type":"c1","uid":1812970,"ip_address":"","ucode":"F5931108BD509B","user_header":"https://static001.geekbang.org/account/avatar/00/1b/a9/ea/5bfce6c5.jpg","comment_is_top":false,"comment_ctime":1603872777,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1603872777","product_id":100023901,"comment_content":"å—æ•™äº†ï¼Œå»çœ‹nettyå®æˆ˜å»äº†","like_count":0},{"had_liked":false,"id":199828,"user_name":"ğŸ˜œå“ˆå“ˆ","can_delete":false,"product_type":"c1","uid":1069001,"ip_address":"","ucode":"1FF58FB3A91135","user_header":"https://static001.geekbang.org/account/avatar/00/10/4f/c9/88837387.jpg","comment_is_top":false,"comment_ctime":1585496611,"is_pvip":true,"discussion_count":0,"race_medal":0,"score":"1585496611","product_id":100023901,"comment_content":"nettyä¸­ä½¿ç”¨reactoräº‹ä»¶é©±åŠ¨å¹¶å‘ç¼–ç¨‹æ¨¡å‹","like_count":0},{"had_liked":false,"id":178871,"user_name":"å°”å†¬æ©™","can_delete":false,"product_type":"c1","uid":1225224,"ip_address":"","ucode":"0B013A49BC18DA","user_header":"https://static001.geekbang.org/account/avatar/00/12/b2/08/92f42622.jpg","comment_is_top":false,"comment_ctime":1581843117,"is_pvip":false,"discussion_count":1,"race_medal":0,"score":"1581843117","product_id":100023901,"comment_content":"<br>void Reactor::handle_events(){<br>  &#47;&#47;é€šè¿‡åŒæ­¥äº‹ä»¶å¤šè·¯é€‰æ‹©å™¨æä¾›çš„<br>  &#47;&#47;select()æ–¹æ³•ç›‘å¬ç½‘ç»œäº‹ä»¶<br>  select(handlers);<br>  &#47;&#47;å¤„ç†ç½‘ç»œäº‹ä»¶<br>  for(h in handlers){<br>    h.handle_event();<br>  }<br>}<br>&#47;&#47; åœ¨ä¸»ç¨‹åºä¸­å¯åŠ¨äº‹ä»¶å¾ªç¯<br>while (true) {<br>  handle_events();<br><br>è€å¸ˆï¼Œè¿™æ®µä»£ç æ˜¯å¦åº”è¯¥åœ¨forå¾ªç¯é‡ŒåŠ ä¸€ä¸ªifåˆ¤æ–­æ˜¯å¦æ˜¯è¯¥handleräº‹ä»¶å‘ç”Ÿï¼Œæ— éœ€å¯¹æ¯ä¸€ä¸ªhanderéå†ï¼Ÿ<br>for(h in handlers){<br>   if(häº‹ä»¶å‘ç”Ÿ)<br>         h.handle_event();<br>  }<br>æˆ–è€…æˆ‘ç†è§£æ˜¯äº‹ä»¶æ³¨å†Œåˆ°selectï¼ˆï¼‰ä¸­æ—¶ä¹Ÿä¼šæœ‰ä¸ªsocketç¼–å·ï¼Œäº‹ä»¶å‘ç”Ÿï¼Œselectä¼šç›´æ¥å›è°ƒè¯¥ç¼–å·çº¿ç¨‹ï¼Œä½†è¿™æ—¶å€™ä¹Ÿä¸éœ€è¦éå†äº‹ä»¶å¤„ç†å™¨äº†ï¼Ÿ","like_count":0,"discussions":[{"author":{"id":1134567,"avatar":"https://static001.geekbang.org/account/avatar/00/11/4f/e7/7e51052a.jpg","nickname":"fumeck.comğŸ‹ğŸŒ´summer sky","note":"","ucode":"6349BF32257990","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":198264,"discussion_content":"è€å“¥ï¼Œä½ è¿™é—®é¢˜è§£å†³äº†å—","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1583495877,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":177858,"user_name":"å°”å†¬æ©™","can_delete":false,"product_type":"c1","uid":1225224,"ip_address":"","ucode":"0B013A49BC18DA","user_header":"https://static001.geekbang.org/account/avatar/00/12/b2/08/92f42622.jpg","comment_is_top":false,"comment_ctime":1581515737,"is_pvip":false,"discussion_count":2,"race_medal":0,"score":"1581515737","product_id":100023901,"comment_content":"åŒä¸€ä¸ªEventLoopè¿æ¥å¾ˆå¤šå®¢æˆ·ç«¯ä¼šä¸ä¼šé€ æˆçº¿ç¨‹åˆ‡æ¢ä¸¥é‡ï¼Ÿ","like_count":0,"discussions":[{"author":{"id":1134567,"avatar":"https://static001.geekbang.org/account/avatar/00/11/4f/e7/7e51052a.jpg","nickname":"fumeck.comğŸ‹ğŸŒ´summer sky","note":"","ucode":"6349BF32257990","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":198267,"discussion_content":"æ¯ä¸ªè¿æ¥å¯¹åº”ä¸€ä¸ªç®¡é“.å¤šä¸ªç®¡é“å¯¹åº”ä¸€æ¡çº¿ç¨‹ï¼Œçº¿ç¨‹å¾€ç®¡é“é‡Œå–æ•°æ®å°±å¥½ï¼Œæ²¡æœ‰åˆ‡æ¢çº¿ç¨‹","likes_number":2,"is_delete":false,"is_hidden":false,"ctime":1583495971,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1810156,"avatar":"","nickname":"poordickey","note":"","ucode":"2A436EC813AF97","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":340987,"discussion_content":"è¿™å·²ç»å¤§å¤§å‡å°‘äº†ä¸€ä¸ªsocketå¯¹åº”ä¸€ä¸ªçº¿ç¨‹  æ‰€å¸¦æ¥çš„çº¿ç¨‹åˆ‡æ¢å¼€é”€äº†   å¦‚æœä½ ä¸æƒ³åˆ‡æ¢æ”¹æˆä¸€ä¸ªeventLoopå¤„ç†æ‰€æœ‰socketè¿æ¥å¥½äº†   é»˜è®¤åˆ›å»ºçš„æ˜¯core*2çš„çº¿ç¨‹æ•°  çº¿ç¨‹åˆ‡æ¢è¿˜å¥½å§","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1610249918,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":167057,"user_name":"æˆ‘æœ‰åˆ‡ç³•","can_delete":false,"product_type":"c1","uid":1104447,"ip_address":"","ucode":"B02DB48B30ED47","user_header":"https://static001.geekbang.org/account/avatar/00/10/da/3f/155d81ef.jpg","comment_is_top":false,"comment_ctime":1577678648,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1577678648","product_id":100023901,"comment_content":"bossGroupå’ŒworkerGroupæ˜¯ä¸æ˜¯å°±æ˜¯ç”Ÿäº§è€…-æ¶ˆè´¹è€…çš„æ¨¡å¼ï¼Ÿ","like_count":0},{"had_liked":false,"id":157497,"user_name":"sswrock","can_delete":false,"product_type":"c1","uid":1683896,"ip_address":"","ucode":"9D8DA794D7378D","user_header":"https://static001.geekbang.org/account/avatar/00/19/b1/b8/9ff50118.jpg","comment_is_top":false,"comment_ctime":1575179502,"is_pvip":false,"replies":[{"id":"62407","content":"å®¢æ°”å®¢æ°”ï¼Œæˆ‘å°±æ˜¯å€ŸèŠ±çŒ®ä½›ğŸ˜„","user_name":"ä½œè€…å›å¤","user_name_real":"ç‹å®ä»¤","uid":"1269969","ctime":1576911090,"ip_address":"","comment_id":157497,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1575179502","product_id":100023901,"comment_content":"çœ‹äº† Doug Leeçš„ â€œScalable IO in Javaâ€ï¼Œå¯¹äºåšä¸ªSwing GUIå¼€å‘çš„äººè±ç„¶å¼€æœ—ï¼Œ<br>æ„Ÿè°¢å®å“¥ å’Œ DougLee","like_count":0,"discussions":[{"author":{"id":1269969,"avatar":"https://static001.geekbang.org/account/avatar/00/13/60/d1/8efa89ab.jpg","nickname":"ç‹å®ä»¤","note":"","ucode":"4FE19F5BC32FCA","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":476447,"discussion_content":"å®¢æ°”å®¢æ°”ï¼Œæˆ‘å°±æ˜¯å€ŸèŠ±çŒ®ä½›ğŸ˜„","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1576911090,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":135928,"user_name":"å…š","can_delete":false,"product_type":"c1","uid":1071974,"ip_address":"","ucode":"EE531DB3EA124D","user_header":"https://static001.geekbang.org/account/avatar/00/10/5b/66/ad35bc68.jpg","comment_is_top":false,"comment_ctime":1569306505,"is_pvip":false,"replies":[{"id":"52706","content":"EventLoop å’Œ Java çº¿ç¨‹æ˜¯ 1 å¯¹ 1 å…³ç³»","user_name":"ä½œè€…å›å¤","user_name_real":"ç‹å®ä»¤","uid":"1269969","ctime":1569667269,"ip_address":"","comment_id":135928,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1569306505","product_id":100023901,"comment_content":"åè¿‡æ¥è¯´çš„è¯å°±æ˜¯ä¸€ä¸ªçº¿ç¨‹æœ‰å¤šä¸ªEventLoop ä¸€ä¸ªEventLoopæœ‰å¤šä¸ªç½‘ç»œè¿æ¥ å¯¹å§","like_count":0,"discussions":[{"author":{"id":1269969,"avatar":"https://static001.geekbang.org/account/avatar/00/13/60/d1/8efa89ab.jpg","nickname":"ç‹å®ä»¤","note":"","ucode":"4FE19F5BC32FCA","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":468388,"discussion_content":"EventLoop å’Œ Java çº¿ç¨‹æ˜¯ 1 å¯¹ 1 å…³ç³»","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1569667269,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":132171,"user_name":"å¢™è§’å„¿çš„èŠ±","can_delete":false,"product_type":"c1","uid":1258474,"ip_address":"","ucode":"EE5CAD76175CCF","user_header":"","comment_is_top":false,"comment_ctime":1568035792,"is_pvip":false,"replies":[{"id":"50588","content":"åç¨‹æœ€ç»ˆä¹Ÿæ˜¯ä¾é çº¿ç¨‹æ‰§è¡Œï¼Œæ‰€ä»¥ç†è®ºä¸Šæ²¡æœ‰è¿™ç§ç»“è®º","user_name":"ä½œè€…å›å¤","user_name_real":"ç‹å®ä»¤","uid":"1269969","ctime":1568083034,"ip_address":"","comment_id":132171,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1568035792","product_id":100023901,"comment_content":"é—®ä¸‹è€å¸ˆï¼ŒimæœåŠ¡ç«¯é™¤äº†ç”¨nettyï¼Œæ˜¯ä¸æ˜¯ç”¨goçš„åç¨‹ä¹Ÿå¥½ï¼Œè¿æ¥å’Œåç¨‹1å¯¹1æœåŠ¡ï¼Œæ„Ÿè§‰è¿™ä¸ªåœºæ™¯ä¸‹goåç¨‹å¹¶å‘èƒ½åŠ›ç»å¯¹åœ¨nettyä¹‹ä¸Šå•Š","like_count":0,"discussions":[{"author":{"id":1269969,"avatar":"https://static001.geekbang.org/account/avatar/00/13/60/d1/8efa89ab.jpg","nickname":"ç‹å®ä»¤","note":"","ucode":"4FE19F5BC32FCA","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":466799,"discussion_content":"åç¨‹æœ€ç»ˆä¹Ÿæ˜¯ä¾é çº¿ç¨‹æ‰§è¡Œï¼Œæ‰€ä»¥ç†è®ºä¸Šæ²¡æœ‰è¿™ç§ç»“è®º","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1568083034,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":126472,"user_name":"è±ªå“¥ç¬‘äº†","can_delete":false,"product_type":"c1","uid":1445782,"ip_address":"","ucode":"617D3DEFE7413C","user_header":"https://static001.geekbang.org/account/avatar/00/16/0f/96/be53e80f.jpg","comment_is_top":false,"comment_ctime":1566391644,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1566391644","product_id":100023901,"comment_content":"åå°é‡‡ç”¨Minaï¼Œå•æœº16æ ¸ï¼Œç”¨c++æµ‹å¹¶å‘æ•°ç›®åªæœ‰20ä¸ªï¼Œå¯èƒ½ä»€ä¹ˆé—®é¢˜","like_count":0},{"had_liked":false,"id":117358,"user_name":"å®çŸ³å±±","can_delete":false,"product_type":"c1","uid":1295061,"ip_address":"","ucode":"3ADF20E12EBF99","user_header":"https://static001.geekbang.org/account/avatar/00/13/c2/d5/126eac1a.jpg","comment_is_top":false,"comment_ctime":1564030902,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1564030902","product_id":100023901,"comment_content":"åœ¨netty4ä¸­, ä¸šåŠ¡çº¿ç¨‹æ‰§è¡Œä»¥ä¸‹ä»£ç , nameå­—æ®µä¸æ˜¯volatile, æ ¹æ®happens-beforeåŸåˆ™, åœ¨åºåˆ—åŒ–å±‚å¯èƒ½çœ‹ä¸åˆ°nameå€¼. æˆ‘è¿™ç†è§£æœ‰é—®é¢˜å—? è¯·è€å¸ˆæŒ‡æ­£<br><br>User user = new User(); &#47;&#47;business thread<br>user.setName(&quot;admin&quot;);<br>channel.write(user); <br>...<br>encoder.encode(user); &#47;&#47;io thread<br>...","like_count":0},{"had_liked":false,"id":116601,"user_name":"æ¥Š_å®µå¤œ","can_delete":false,"product_type":"c1","uid":1019302,"ip_address":"","ucode":"7BA0CADC5F23BB","user_header":"https://static001.geekbang.org/account/avatar/00/0f/8d/a6/22c37c91.jpg","comment_is_top":false,"comment_ctime":1563877644,"is_pvip":false,"discussion_count":1,"race_medal":0,"score":"1563877644","product_id":100023901,"comment_content":"è€å¸ˆå¥½ï¼ŒbossGroupå¤šäºä¸€æ¡çº¿ç¨‹ï¼Œçº¯å±æµªè´¹è¿™ä¸€ç‚¹ã€‚èƒ½å¦æ‰©å±•åœ°è¯´è¯´å‘¢ï¼Ÿæˆ‘ç¨å¾®æ€è€ƒäº†ä¸€ä¸‹ï¼Œæ˜¯å¦ä¸TCPåè®®ç´§ç›¸å…³å‘¢ï¼Ÿä¾‹å¦‚æ»‘åŠ¨çª—å£æœºåˆ¶é‚£äº›ï¼Ÿ<br>ä¹‹å‰æœ‰è¯´è¿‡ä¸€ä¸ªé™æµå™¨çš„æ¡ˆä¾‹ï¼Œé‡Œé¢æ¥å—è¿æ¥ä¹Ÿæ˜¯é˜»å¡å¼APIï¼Œå¦‚æœbossGroupåªæœ‰ä¸€æ¡çº¿ç¨‹ï¼Œè€ŒåŒä¸€æ—¶åˆ»åˆæœ‰10ä¸ªäººè¿›è¡Œè¿æ¥çš„è¯ï¼Œé‚£ç¬¬åä¸ªäººä¸å°±è¦ç­‰ä¸ªä¸€æ®µæ—¶é—´ï¼ˆå³ä½¿äººç±»æ„Ÿå®˜ä¸ŠåŸºæœ¬æ— æ„ŸçŸ¥ï¼‰ï¼Ÿ","like_count":0,"discussions":[{"author":{"id":1019659,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/8f/0b/a438de52.jpg","nickname":"0xTang","note":"","ucode":"82F5282EF3044B","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":216133,"discussion_content":"Bossgroupç›‘å¬ç«¯å£å°±1ä¸ªï¼Œå½“ç„¶å°±1æ¡çº¿ç¨‹","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1585406999,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":106002,"user_name":"é”¦","can_delete":false,"product_type":"c1","uid":1468298,"ip_address":"","ucode":"CB0EB4B68C468B","user_header":"https://static001.geekbang.org/account/avatar/00/16/67/8a/babd74dc.jpg","comment_is_top":false,"comment_ctime":1561123503,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1561123503","product_id":100023901,"comment_content":"è€å¸ˆæåˆ°äº‹ä»¶å¤„ç†å™¨æ˜¯ä¸èƒ½æœ‰é˜»å¡æ“ä½œçš„ï¼Œå®åœ¨éœ€è¦å°±é€šè¿‡çº¿ç¨‹æ± å¼‚æ­¥å¤„ç†ï¼Œæ„Ÿè§‰è¿™é‡Œçš„çº¿ç¨‹æ± é¿å…ä¸äº†ï¼Œå› ä¸ºå¾ˆéš¾ä¿è¯ä¸šåŠ¡æ²¡æœ‰é˜»å¡æ“ä½œ","like_count":0},{"had_liked":false,"id":99488,"user_name":"é”¦","can_delete":false,"product_type":"c1","uid":1468298,"ip_address":"","ucode":"CB0EB4B68C468B","user_header":"https://static001.geekbang.org/account/avatar/00/16/67/8a/babd74dc.jpg","comment_is_top":false,"comment_ctime":1559227241,"is_pvip":false,"replies":[{"id":"54022","content":"java nioæœ‰API","user_name":"ä½œè€…å›å¤","user_name_real":"ç‹å®ä»¤","uid":"1269969","ctime":1570766846,"ip_address":"","comment_id":99488,"utype":1}],"discussion_count":2,"race_medal":0,"score":"1559227241","product_id":100023901,"comment_content":"é—®ä¸‹è€å¸ˆé›¶æ‹·è´æ˜¯æ€ä¹ˆå®ç°çš„å‘¢ï¼Ÿ","like_count":0,"discussions":[{"author":{"id":1269969,"avatar":"https://static001.geekbang.org/account/avatar/00/13/60/d1/8efa89ab.jpg","nickname":"ç‹å®ä»¤","note":"","ucode":"4FE19F5BC32FCA","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":452134,"discussion_content":"java nioæœ‰API","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1570766846,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1542037,"avatar":"https://static001.geekbang.org/account/avatar/00/17/87/95/cba0a896.jpg","nickname":"å¢","note":"","ucode":"B6A9F41AEE348C","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":405746,"discussion_content":"æ˜¯ä¸æ˜¯ MappedByteBuffer","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1634636059,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":98686,"user_name":"ban","can_delete":false,"product_type":"c1","uid":1034204,"ip_address":"","ucode":"E523CE97E48266","user_header":"https://static001.geekbang.org/account/avatar/00/0f/c7/dc/9408c8c2.jpg","comment_is_top":false,"comment_ctime":1559057595,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1559057595","product_id":100023901,"comment_content":"æ–‡ç« è¯´çš„echoé‚£ç¯‡æ–‡ç« åº”è¯¥æ˜¯<br>34 | Worker Threadæ¨¡å¼ï¼šå¦‚ä½•é¿å…é‡å¤åˆ›å»ºçº¿ç¨‹ï¼Ÿ<br>æ‰å¯¹ã€‚","like_count":0},{"had_liked":false,"id":98470,"user_name":"æ™“æ°","can_delete":false,"product_type":"c1","uid":1441546,"ip_address":"","ucode":"1174C88EEBF8A6","user_header":"https://static001.geekbang.org/account/avatar/00/15/ff/0a/12faa44e.jpg","comment_is_top":false,"comment_ctime":1559007640,"is_pvip":false,"replies":[{"id":"35267","content":"æ²¡å¤ªæ˜ç™½ä½ çš„ç—›ç‚¹ï¼Œä½ å¯ä»¥åœ¨å®¢æˆ·ç«¯åšè´Ÿè½½å‡è¡¡","user_name":"ä½œè€…å›å¤","user_name_real":"ç‹å®ä»¤","uid":"1269969","ctime":1559044294,"ip_address":"","comment_id":98470,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1559007640","product_id":100023901,"comment_content":"ä¹‹å‰åšçš„å……ç”µæ¡©ä¹Ÿæ˜¯ç”¨çš„nettyï¼Œä½†æ˜¯åªèƒ½å•æœºéƒ¨ç½²ï¼Œå› ä¸ºnettyç”¨çš„æ˜¯é•¿è¿æ¥ï¼Œä½†æ˜¯åœ¨åˆ†å¸ƒå¼æ¡†æ¶ä¸­ç½‘ç»œè¿æ¥æ˜¯éšæœºçš„ï¼Œè¯·é—®è€å¸ˆè¿™ç§æƒ…å†µæ€ä¹ˆè§£å†³","like_count":0,"discussions":[{"author":{"id":1269969,"avatar":"https://static001.geekbang.org/account/avatar/00/13/60/d1/8efa89ab.jpg","nickname":"ç‹å®ä»¤","note":"","ucode":"4FE19F5BC32FCA","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":451701,"discussion_content":"æ²¡å¤ªæ˜ç™½ä½ çš„ç—›ç‚¹ï¼Œä½ å¯ä»¥åœ¨å®¢æˆ·ç«¯åšè´Ÿè½½å‡è¡¡","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1559044294,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":98449,"user_name":"è‹å¿—è¾‰","can_delete":false,"product_type":"c1","uid":1068927,"ip_address":"","ucode":"39B25CE21C04EE","user_header":"https://static001.geekbang.org/account/avatar/00/10/4f/7f/5dc11380.jpg","comment_is_top":false,"comment_ctime":1559005684,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1559005684","product_id":100023901,"comment_content":"nettyä¸­eventloopæ˜¯å»¶è¿Ÿåˆ›å»ºçš„","like_count":1},{"had_liked":false,"id":98417,"user_name":"GeekAmI","can_delete":false,"product_type":"c1","uid":1005030,"ip_address":"","ucode":"232C0B6DFB9F56","user_header":"https://static001.geekbang.org/account/avatar/00/0f/55/e6/87197b10.jpg","comment_is_top":false,"comment_ctime":1559002272,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1559002272","product_id":100023901,"comment_content":"nettyå¯ä»¥å¼€è®¾å¦ä¸€é—¨è¯¾å•¦","like_count":1}]}