{"id":10651,"title":"ç¬¬28è®² | è°ˆè°ˆä½ çš„GCè°ƒä¼˜æ€è·¯?","content":"<p>æˆ‘å‘ç°ï¼Œç›®å‰ä¸å°‘å¤–éƒ¨èµ„æ–™å¯¹G1çš„ä»‹ç»å¤§å¤šè¿˜åœç•™åœ¨JDK 7æˆ–æ›´æ—©æœŸçš„å®ç°ï¼Œå¾ˆå¤šç»“è®ºå·²ç»å­˜åœ¨è¾ƒå¤§åå·®ï¼Œç”šè‡³ä¸€äº›è¿‡å»çš„GCé€‰é¡¹å·²ç»ä¸å†æ¨èä½¿ç”¨ã€‚æ‰€ä»¥ï¼Œä»Šå¤©æˆ‘ä¼šé€‰å–æ–°ç‰ˆJDKä¸­çš„é»˜è®¤G1 GCä½œä¸ºé‡ç‚¹è¿›è¡Œè¯¦è§£ï¼Œå¹¶ä¸”æˆ‘ä¼šä»è°ƒä¼˜å®è·µçš„è§’åº¦ï¼Œåˆ†æå…¸å‹åœºæ™¯å’Œè°ƒä¼˜æ€è·¯ã€‚ä¸‹é¢æˆ‘ä»¬ä¸€èµ·æ¥æ›´æ–°ä¸‹è¿™æ–¹é¢çš„çŸ¥è¯†ã€‚</p>\n<p>ä»Šå¤©æˆ‘è¦é—®ä½ çš„é—®é¢˜æ˜¯ï¼Œ<span class=\"orange\">è°ˆè°ˆä½ çš„GCè°ƒä¼˜æ€è·¯ï¼Ÿ</span></p>\n<h2>å…¸å‹å›ç­”</h2>\n<p>è°ˆåˆ°è°ƒä¼˜ï¼Œè¿™ä¸€å®šæ˜¯é’ˆå¯¹ç‰¹å®šåœºæ™¯ã€ç‰¹å®šç›®çš„çš„äº‹æƒ…ï¼Œ å¯¹äºGCè°ƒä¼˜æ¥è¯´ï¼Œé¦–å…ˆå°±éœ€è¦æ¸…æ¥šè°ƒä¼˜çš„ç›®æ ‡æ˜¯ä»€ä¹ˆï¼Ÿä»æ€§èƒ½çš„è§’åº¦çœ‹ï¼Œé€šå¸¸å…³æ³¨ä¸‰ä¸ªæ–¹é¢ï¼Œå†…å­˜å ç”¨ï¼ˆfootprintï¼‰ã€å»¶æ—¶ï¼ˆlatencyï¼‰å’Œååé‡ï¼ˆthroughputï¼‰ï¼Œå¤§å¤šæ•°æƒ…å†µä¸‹è°ƒä¼˜ä¼šä¾§é‡äºå…¶ä¸­ä¸€ä¸ªæˆ–è€…ä¸¤ä¸ªæ–¹é¢çš„ç›®æ ‡ï¼Œå¾ˆå°‘æœ‰æƒ…å†µå¯ä»¥å…¼é¡¾ä¸‰ä¸ªä¸åŒçš„è§’åº¦ã€‚å½“ç„¶ï¼Œé™¤äº†ä¸Šé¢é€šå¸¸çš„ä¸‰ä¸ªæ–¹é¢ï¼Œä¹Ÿå¯èƒ½éœ€è¦è€ƒè™‘å…¶ä»–GCç›¸å…³çš„åœºæ™¯ï¼Œä¾‹å¦‚ï¼ŒOOMä¹Ÿå¯èƒ½ä¸ä¸åˆç†çš„GCç›¸å…³å‚æ•°æœ‰å…³ï¼›æˆ–è€…ï¼Œåº”ç”¨å¯åŠ¨é€Ÿåº¦æ–¹é¢çš„éœ€æ±‚ï¼ŒGCä¹Ÿä¼šæ˜¯ä¸ªè€ƒè™‘çš„æ–¹é¢ã€‚</p>\n<p>åŸºæœ¬çš„è°ƒä¼˜æ€è·¯å¯ä»¥æ€»ç»“ä¸ºï¼š</p>\n<ul>\n<li>\n<p>ç†è§£åº”ç”¨éœ€æ±‚å’Œé—®é¢˜ï¼Œç¡®å®šè°ƒä¼˜ç›®æ ‡ã€‚å‡è®¾ï¼Œæˆ‘ä»¬å¼€å‘äº†ä¸€ä¸ªåº”ç”¨æœåŠ¡ï¼Œä½†å‘ç°å¶å°”ä¼šå‡ºç°æ€§èƒ½æŠ–åŠ¨ï¼Œå‡ºç°è¾ƒé•¿çš„æœåŠ¡åœé¡¿ã€‚è¯„ä¼°ç”¨æˆ·å¯æ¥å—çš„å“åº”æ—¶é—´å’Œä¸šåŠ¡é‡ï¼Œå°†ç›®æ ‡ç®€åŒ–ä¸ºï¼Œå¸Œæœ›GCæš‚åœå°½é‡æ§åˆ¶åœ¨200msä»¥å†…ï¼Œå¹¶ä¸”ä¿è¯ä¸€å®šæ ‡å‡†çš„ååé‡ã€‚</p>\n</li>\n<li>\n<p>æŒæ¡JVMå’ŒGCçš„çŠ¶æ€ï¼Œå®šä½å…·ä½“çš„é—®é¢˜ï¼Œç¡®å®šçœŸçš„æœ‰GCè°ƒä¼˜çš„å¿…è¦ã€‚å…·ä½“æœ‰å¾ˆå¤šæ–¹æ³•ï¼Œæ¯”å¦‚ï¼Œé€šè¿‡jstatç­‰å·¥å…·æŸ¥çœ‹GCç­‰ç›¸å…³çŠ¶æ€ï¼Œå¯ä»¥å¼€å¯GCæ—¥å¿—ï¼Œæˆ–è€…æ˜¯åˆ©ç”¨æ“ä½œç³»ç»Ÿæä¾›çš„è¯Šæ–­å·¥å…·ç­‰ã€‚ä¾‹å¦‚ï¼Œé€šè¿‡è¿½è¸ªGCæ—¥å¿—ï¼Œå°±å¯ä»¥æŸ¥æ‰¾æ˜¯ä¸æ˜¯GCåœ¨ç‰¹å®šæ—¶é—´å‘ç”Ÿäº†é•¿æ—¶é—´çš„æš‚åœï¼Œè¿›è€Œå¯¼è‡´äº†åº”ç”¨å“åº”ä¸åŠæ—¶ã€‚</p>\n</li>\n<li>\n<p>è¿™é‡Œéœ€è¦æ€è€ƒï¼Œé€‰æ‹©çš„GCç±»å‹æ˜¯å¦ç¬¦åˆæˆ‘ä»¬çš„åº”ç”¨ç‰¹å¾ï¼Œå¦‚æœæ˜¯ï¼Œå…·ä½“é—®é¢˜è¡¨ç°åœ¨å“ªé‡Œï¼Œæ˜¯Minor GCè¿‡é•¿ï¼Œè¿˜æ˜¯Mixed GCç­‰å‡ºç°å¼‚å¸¸åœé¡¿æƒ…å†µï¼›å¦‚æœä¸æ˜¯ï¼Œè€ƒè™‘åˆ‡æ¢åˆ°ä»€ä¹ˆç±»å‹ï¼Œå¦‚CMSå’ŒG1éƒ½æ˜¯æ›´ä¾§é‡äºä½å»¶è¿Ÿçš„GCé€‰é¡¹ã€‚</p>\n</li>\n<li>\n<p>é€šè¿‡åˆ†æç¡®å®šå…·ä½“è°ƒæ•´çš„å‚æ•°æˆ–è€…è½¯ç¡¬ä»¶é…ç½®ã€‚</p>\n</li>\n<li>\n<p>éªŒè¯æ˜¯å¦è¾¾åˆ°è°ƒä¼˜ç›®æ ‡ï¼Œå¦‚æœè¾¾åˆ°ç›®æ ‡ï¼Œå³å¯ä»¥è€ƒè™‘ç»“æŸè°ƒä¼˜ï¼›å¦åˆ™ï¼Œé‡å¤å®Œæˆåˆ†æã€è°ƒæ•´ã€éªŒè¯è¿™ä¸ªè¿‡ç¨‹ã€‚</p>\n</li>\n</ul><!-- [[[read_end]]] -->\n<h2>è€ƒç‚¹åˆ†æ</h2>\n<p>ä»Šå¤©è€ƒå¯Ÿçš„GCè°ƒä¼˜é—®é¢˜æ˜¯JVMè°ƒä¼˜çš„ä¸€ä¸ªåŸºç¡€æ–¹é¢ï¼Œå¾ˆå¤šJVMè°ƒä¼˜éœ€æ±‚ï¼Œæœ€ç»ˆéƒ½ä¼šè½å®åœ¨GCè°ƒä¼˜ä¸Šæˆ–è€…ä¸å…¶ç›¸å…³ï¼Œæˆ‘æä¾›çš„æ˜¯ä¸€ä¸ªå¸¸è§çš„æ€è·¯ã€‚</p>\n<p>çœŸæ­£å¿«é€Ÿå®šä½å’Œè§£å†³å…·ä½“é—®é¢˜ï¼Œè¿˜æ˜¯éœ€è¦å¯¹JVMå’ŒGCçŸ¥è¯†çš„æŒæ¡ï¼Œä»¥åŠå®é™…è°ƒä¼˜ç»éªŒçš„æ€»ç»“ï¼Œæœ‰çš„æ—¶å€™ç”šè‡³æ˜¯æºè‡ªç»éªŒç§¯ç´¯çš„ç›´è§‰åˆ¤æ–­ã€‚é¢è¯•å®˜å¯èƒ½ä¼šç»§ç»­é—®é¡¹ç›®ä¸­é‡åˆ°çš„çœŸå®é—®é¢˜ï¼Œå¦‚æœä½ èƒ½æ¸…æ¥šã€ç®€è¦åœ°ä»‹ç»å…¶ä¸Šä¸‹æ–‡ï¼Œç„¶åå°†è¯Šæ–­æ€è·¯å’Œè°ƒä¼˜å®è·µè¿‡ç¨‹è¡¨è¿°å‡ºæ¥ï¼Œä¼šæ˜¯ä¸ªå¾ˆå¥½çš„åŠ åˆ†é¡¹ã€‚</p>\n<p>ä¸“æ è™½ç„¶æ— æ³•æä¾›å…·ä½“çš„é¡¹ç›®ç»éªŒï¼Œä½†æ˜¯å¯ä»¥å¸®åŠ©ä½ æŒæ¡å¸¸è§çš„è°ƒä¼˜æ€è·¯å’Œæ‰‹æ®µï¼Œè¿™ä¸ç®¡æ˜¯é¢è¯•è¿˜æ˜¯åœ¨å®é™…å·¥ä½œä¸­éƒ½æ˜¯å¾ˆæœ‰å¸®åŠ©çš„ã€‚å¦å¤–ï¼Œæˆ‘ä¼šè¿˜ä¼šä»ä¸‹é¢ä¸åŒè§’åº¦è¿›è¡Œè¡¥å……ï¼š</p>\n<ul>\n<li>\n<p><a href=\"http://time.geekbang.org/column/article/10513\">ä¸Šä¸€è®²</a>ä¸­æˆ‘å·²ç»è°ˆåˆ°ï¼Œæ¶‰åŠå…·ä½“çš„GCç±»å‹ï¼ŒJVMçš„å®é™…è¡¨ç°è¦æ›´åŠ å¤æ‚ã€‚ç›®å‰ï¼ŒG1å·²ç»æˆä¸ºæ–°ç‰ˆJDKçš„é»˜è®¤é€‰æ‹©ï¼Œæ‰€ä»¥å€¼å¾—ä½ å»æ·±å…¥ç†è§£ã€‚</p>\n</li>\n<li>\n<p>å› ä¸ºG1 GCä¸€ç›´å¤„åœ¨å¿«é€Ÿå‘å±•ä¹‹ä¸­ï¼Œæˆ‘ä¼šä¾§é‡å®ƒçš„æ¼”è¿›å˜åŒ–ï¼Œå°¤å…¶æ˜¯è¡Œä¸ºå’Œé…ç½®ç›¸å…³çš„å˜åŒ–ã€‚å¹¶ä¸”ï¼ŒåŒæ ·æ˜¯å› ä¸ºJVMçš„å¿«é€Ÿå‘å±•ï¼Œå³ä½¿æ˜¯æ”¶é›†GCæ—¥å¿—ç­‰æ–¹é¢ä¹Ÿå‘ç”Ÿäº†è¾ƒå¤§æ”¹è¿›ï¼Œè¿™ä¹Ÿæ˜¯ä¸ºä»€ä¹ˆæˆ‘åœ¨ä¸Šä¸€è®²ç•™ç»™ä½ çš„æ€è€ƒé¢˜æ˜¯æœ‰å…³æ—¥å¿—ç›¸å…³é€‰é¡¹ï¼Œçœ‹å®Œè®²è§£ç›¸ä¿¡ä½ ä¼šå¾ˆæƒŠè®¶ã€‚</p>\n</li>\n<li>\n<p>ä»GCè°ƒä¼˜å®è·µçš„è§’åº¦ï¼Œç†è§£é€šç”¨é—®é¢˜çš„è°ƒä¼˜æ€è·¯å’Œæ‰‹æ®µã€‚</p>\n</li>\n</ul>\n<h2>çŸ¥è¯†æ‰©å±•</h2>\n<p>é¦–å…ˆï¼Œå…ˆæ¥æ•´ä½“äº†è§£ä¸€ä¸‹G1 GCçš„å†…éƒ¨ç»“æ„å’Œä¸»è¦æœºåˆ¶ã€‚</p>\n<p>ä»å†…å­˜åŒºåŸŸçš„è§’åº¦ï¼ŒG1åŒæ ·å­˜åœ¨ç€å¹´ä»£çš„æ¦‚å¿µï¼Œä½†æ˜¯ä¸æˆ‘å‰é¢ä»‹ç»çš„å†…å­˜ç»“æ„å¾ˆä¸ä¸€æ ·ï¼Œå…¶å†…éƒ¨æ˜¯ç±»ä¼¼æ£‹ç›˜çŠ¶çš„ä¸€ä¸ªä¸ªregionç»„æˆï¼Œè¯·å‚è€ƒä¸‹é¢çš„ç¤ºæ„å›¾ã€‚<br />\n<img src=\"https://static001.geekbang.org/resource/image/a6/f1/a662fda0de8af087c37c40a86a9cf3f1.png?wh=669*322\" alt=\"\" /></p>\n<p>regionçš„å¤§å°æ˜¯ä¸€è‡´çš„ï¼Œæ•°å€¼æ˜¯åœ¨1Måˆ°32Må­—èŠ‚ä¹‹é—´çš„ä¸€ä¸ª2çš„å¹‚å€¼æ•°ï¼ŒJVMä¼šå°½é‡åˆ’åˆ†2048ä¸ªå·¦å³ã€åŒç­‰å¤§å°çš„regionï¼Œè¿™ç‚¹å¯ä»¥ä»æºç <a href=\"http://hg.openjdk.java.net/jdk/jdk/file/fa2f93f99dbc/src/hotspot/share/gc/g1/heapRegionBounds.hpp\">heapRegionBounds.hpp</a>ä¸­çœ‹åˆ°ã€‚å½“ç„¶è¿™ä¸ªæ•°å­—æ—¢å¯ä»¥æ‰‹åŠ¨è°ƒæ•´ï¼ŒG1ä¹Ÿä¼šæ ¹æ®å †å¤§å°è‡ªåŠ¨è¿›è¡Œè°ƒæ•´ã€‚</p>\n<p>åœ¨G1å®ç°ä¸­ï¼Œå¹´ä»£æ˜¯ä¸ªé€»è¾‘æ¦‚å¿µï¼Œå…·ä½“ä½“ç°åœ¨ï¼Œä¸€éƒ¨åˆ†regionæ˜¯ä½œä¸ºEdenï¼Œä¸€éƒ¨åˆ†ä½œä¸ºSurvivorï¼Œé™¤äº†æ„æ–™ä¹‹ä¸­çš„Old regionï¼ŒG1ä¼šå°†è¶…è¿‡region 50%å¤§å°çš„å¯¹è±¡ï¼ˆåœ¨åº”ç”¨ä¸­ï¼Œé€šå¸¸æ˜¯byteæˆ–charæ•°ç»„ï¼‰å½’ç±»ä¸ºHumongouså¯¹è±¡ï¼Œå¹¶æ”¾ç½®åœ¨ç›¸åº”çš„regionä¸­ã€‚é€»è¾‘ä¸Šï¼ŒHumongous regionç®—æ˜¯è€å¹´ä»£çš„ä¸€éƒ¨åˆ†ï¼Œå› ä¸ºå¤åˆ¶è¿™æ ·çš„å¤§å¯¹è±¡æ˜¯å¾ˆæ˜‚è´µçš„æ“ä½œï¼Œå¹¶ä¸é€‚åˆæ–°ç”Ÿä»£GCçš„å¤åˆ¶ç®—æ³•ã€‚</p>\n<p>ä½ å¯ä»¥æ€è€ƒä¸‹regionè®¾è®¡æœ‰ä»€ä¹ˆå‰¯ä½œç”¨ï¼Ÿ</p>\n<p>ä¾‹å¦‚ï¼Œregionå¤§å°å’Œå¤§å¯¹è±¡å¾ˆéš¾ä¿è¯ä¸€è‡´ï¼Œè¿™ä¼šå¯¼è‡´ç©ºé—´çš„æµªè´¹ã€‚ä¸çŸ¥é“ä½ æœ‰æ²¡æœ‰æ³¨æ„åˆ°ï¼Œæˆ‘çš„ç¤ºæ„å›¾ä¸­æœ‰çš„åŒºåŸŸæ˜¯Humongousé¢œè‰²ï¼Œä½†æ²¡æœ‰ç”¨åç§°æ ‡è®°ï¼Œè¿™æ˜¯ä¸ºäº†è¡¨ç¤ºï¼Œç‰¹åˆ«å¤§çš„å¯¹è±¡æ˜¯å¯èƒ½å ç”¨è¶…è¿‡ä¸€ä¸ªregionçš„ã€‚å¹¶ä¸”ï¼Œregionå¤ªå°ä¸åˆé€‚ï¼Œä¼šä»¤ä½ åœ¨åˆ†é…å¤§å¯¹è±¡æ—¶æ›´éš¾æ‰¾åˆ°è¿ç»­ç©ºé—´ï¼Œè¿™æ˜¯ä¸€ä¸ªé•¿ä¹…å­˜åœ¨çš„æƒ…å†µï¼Œè¯·å‚è€ƒ<a href=\"http://mail.openjdk.java.net/pipermail/hotspot-gc-use/2017-November/002726.html\">OpenJDKç¤¾åŒºçš„è®¨è®º</a>ã€‚è¿™æœ¬è´¨ä¹Ÿå¯ä»¥çœ‹ä½œæ˜¯JVMçš„bugï¼Œå°½ç®¡è§£å†³åŠæ³•ä¹Ÿéå¸¸ç®€å•ï¼Œç›´æ¥è®¾ç½®è¾ƒå¤§çš„regionå¤§å°ï¼Œå‚æ•°å¦‚ä¸‹ï¼š</p>\n<pre><code>-XX:G1HeapRegionSize=&lt;N, ä¾‹å¦‚16&gt;M\n</code></pre>\n<p>ä»GCç®—æ³•çš„è§’åº¦ï¼ŒG1é€‰æ‹©çš„æ˜¯å¤åˆç®—æ³•ï¼Œå¯ä»¥ç®€åŒ–ç†è§£ä¸ºï¼š</p>\n<ul>\n<li>\n<p>åœ¨æ–°ç”Ÿä»£ï¼ŒG1é‡‡ç”¨çš„ä»ç„¶æ˜¯å¹¶è¡Œçš„å¤åˆ¶ç®—æ³•ï¼Œæ‰€ä»¥åŒæ ·ä¼šå‘ç”ŸStop-The-Worldçš„æš‚åœã€‚</p>\n</li>\n<li>\n<p>åœ¨è€å¹´ä»£ï¼Œå¤§éƒ¨åˆ†æƒ…å†µä¸‹éƒ½æ˜¯å¹¶å‘æ ‡è®°ï¼Œè€Œæ•´ç†ï¼ˆCompactï¼‰åˆ™æ˜¯å’Œæ–°ç”Ÿä»£GCæ—¶æå¸¦è¿›è¡Œï¼Œå¹¶ä¸”ä¸æ˜¯æ•´ä½“æ€§çš„æ•´ç†ï¼Œè€Œæ˜¯å¢é‡è¿›è¡Œçš„ã€‚</p>\n</li>\n</ul>\n<p>æˆ‘åœ¨<a href=\"http://time.geekbang.org/column/article/10513\">ä¸Šä¸€è®²</a>æ›¾ç»ä»‹ç»è¿‡ï¼Œä¹ æƒ¯ä¸Šäººä»¬å–œæ¬¢æŠŠæ–°ç”Ÿä»£GCï¼ˆYoung GCï¼‰å«ä½œMinor GCï¼Œè€å¹´ä»£GCå«ä½œMajor GCï¼ŒåŒºåˆ«äºæ•´ä½“æ€§çš„Full GCã€‚ä½†æ˜¯ç°ä»£GCä¸­ï¼Œè¿™ç§æ¦‚å¿µå·²ç»ä¸å†å‡†ç¡®ï¼Œå¯¹äºG1æ¥è¯´ï¼š</p>\n<ul>\n<li>\n<p>Minor GCä»ç„¶å­˜åœ¨ï¼Œè™½ç„¶å…·ä½“è¿‡ç¨‹ä¼šæœ‰åŒºåˆ«ï¼Œä¼šæ¶‰åŠRemembered Setç­‰ç›¸å…³å¤„ç†ã€‚</p>\n</li>\n<li>\n<p>è€å¹´ä»£å›æ”¶ï¼Œåˆ™æ˜¯ä¾é Mixed GCã€‚å¹¶å‘æ ‡è®°ç»“æŸåï¼ŒJVMå°±æœ‰è¶³å¤Ÿçš„ä¿¡æ¯è¿›è¡Œåƒåœ¾æ”¶é›†ï¼ŒMixed GCä¸ä»…åŒæ—¶ä¼šæ¸…ç†Edenã€SurvivoråŒºåŸŸï¼Œè€Œä¸”è¿˜ä¼šæ¸…ç†éƒ¨åˆ†OldåŒºåŸŸã€‚å¯ä»¥é€šè¿‡è®¾ç½®ä¸‹é¢çš„å‚æ•°ï¼ŒæŒ‡å®šè§¦å‘é˜ˆå€¼ï¼Œå¹¶ä¸”è®¾å®šæœ€å¤šè¢«åŒ…å«åœ¨ä¸€æ¬¡Mixed GCä¸­çš„regionæ¯”ä¾‹ã€‚</p>\n</li>\n</ul>\n<pre><code>â€“XX:G1MixedGCLiveThresholdPercent\nâ€“XX:G1OldCSetRegionThresholdPercent\n</code></pre>\n<p>ä»G1å†…éƒ¨è¿è¡Œçš„è§’åº¦ï¼Œä¸‹é¢çš„ç¤ºæ„å›¾æè¿°äº†G1æ­£å¸¸è¿è¡Œæ—¶çš„çŠ¶æ€æµè½¬å˜åŒ–ï¼Œå½“ç„¶ï¼Œåœ¨å‘ç”Ÿé€ƒé€¸å¤±è´¥ç­‰æƒ…å†µä¸‹ï¼Œå°±ä¼šè§¦å‘Full GCã€‚<br />\n<img src=\"https://static001.geekbang.org/resource/image/47/ec/47dddbd91ad0e0adbd164632eb9facec.png?wh=585*358\" alt=\"\" /></p>\n<p>G1ç›¸å…³æ¦‚å¿µéå¸¸å¤šï¼Œæœ‰ä¸€ä¸ªé‡ç‚¹å°±æ˜¯Remembered Setï¼Œç”¨äºè®°å½•å’Œç»´æŠ¤regionä¹‹é—´å¯¹è±¡çš„å¼•ç”¨å…³ç³»ã€‚ä¸ºä»€ä¹ˆéœ€è¦è¿™ä¹ˆåšå‘¢ï¼Ÿè¯•æƒ³ï¼Œæ–°ç”Ÿä»£GCæ˜¯å¤åˆ¶ç®—æ³•ï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œç±»ä¼¼å¯¹è±¡ä»Edenæˆ–è€…Survivoråˆ°toåŒºåŸŸçš„â€œç§»åŠ¨â€ï¼Œå…¶å®æ˜¯â€œå¤åˆ¶â€ï¼Œæœ¬è´¨ä¸Šæ˜¯ä¸€ä¸ªæ–°çš„å¯¹è±¡ã€‚åœ¨è¿™ä¸ªè¿‡ç¨‹ä¸­ï¼Œéœ€è¦å¿…é¡»ä¿è¯è€å¹´ä»£åˆ°æ–°ç”Ÿä»£çš„è·¨åŒºå¼•ç”¨ä»ç„¶æœ‰æ•ˆã€‚ä¸‹é¢çš„ç¤ºæ„å›¾è¯´æ˜äº†ç›¸å…³è®¾è®¡ã€‚<br />\n<img src=\"https://static001.geekbang.org/resource/image/eb/d3/eb50bb2b270478bc6f525aa615d4a3d3.png?wh=776*537\" alt=\"\" /></p>\n<p>G1çš„å¾ˆå¤šå¼€é”€éƒ½æ˜¯æºè‡ªRemembered Setï¼Œä¾‹å¦‚ï¼Œå®ƒé€šå¸¸çº¦å ç”¨Heapå¤§å°çš„20%æˆ–æ›´é«˜ï¼Œè¿™å¯æ˜¯éå¸¸å¯è§‚çš„æ¯”ä¾‹ã€‚å¹¶ä¸”ï¼Œæˆ‘ä»¬è¿›è¡Œå¯¹è±¡å¤åˆ¶çš„æ—¶å€™ï¼Œå› ä¸ºéœ€è¦æ‰«æå’Œæ›´æ”¹Card Tableçš„ä¿¡æ¯ï¼Œè¿™ä¸ªé€Ÿåº¦å½±å“äº†å¤åˆ¶çš„é€Ÿåº¦ï¼Œè¿›è€Œå½±å“æš‚åœæ—¶é—´ã€‚</p>\n<p>æè¿°G1å†…éƒ¨çš„èµ„æ–™å¾ˆå¤šï¼Œæˆ‘å°±ä¸é‡å¤äº†ï¼Œå¦‚æœä½ æƒ³äº†è§£æ›´å¤šå†…éƒ¨ç»“æ„å’Œç®—æ³•ç­‰ï¼Œæˆ‘å»ºè®®å‚è€ƒä¸€äº›å…·ä½“çš„<a href=\"https://www.infoq.com/articles/G1-One-Garbage-Collector-To-Rule-Them-All\">ä»‹ç»</a>ï¼Œä¹¦ç±æ–¹é¢æˆ‘æ¨èCharlie Huntç­‰æ’°å†™çš„ã€ŠJava Performance Companionã€‹ã€‚</p>\n<p>æ¥ä¸‹æ¥ï¼Œæˆ‘ä»‹ç»ä¸‹å¤§å®¶å¯èƒ½è¿˜ä¸äº†è§£çš„G1è¡Œä¸ºå˜åŒ–ï¼Œå®ƒä»¬åœ¨ä¸€å®šç¨‹åº¦ä¸Šè§£å†³äº†ä¸“æ å…¶ä»–è®²ä¸­æåˆ°çš„éƒ¨åˆ†å›°æ‰°ï¼Œå¦‚ç±»å‹å¸è½½ä¸åŠæ—¶çš„é—®é¢˜ã€‚</p>\n<ul>\n<li>\n<p>ä¸Šé¢æåˆ°äº†Humongouså¯¹è±¡çš„åˆ†é…å’Œå›æ”¶ï¼Œè¿™æ˜¯å¾ˆå¤šå†…å­˜é—®é¢˜çš„æ¥æºï¼ŒHumongous regionä½œä¸ºè€å¹´ä»£çš„ä¸€éƒ¨åˆ†ï¼Œé€šå¸¸è®¤ä¸ºå®ƒä¼šåœ¨å¹¶å‘æ ‡è®°ç»“æŸåæ‰è¿›è¡Œå›æ”¶ï¼Œä½†æ˜¯åœ¨æ–°ç‰ˆG1ä¸­ï¼ŒHumongouså¯¹è±¡å›æ”¶é‡‡å–äº†æ›´åŠ æ¿€è¿›çš„ç­–ç•¥ã€‚<br />\næˆ‘ä»¬çŸ¥é“G1è®°å½•äº†è€å¹´ä»£regioné—´å¯¹è±¡å¼•ç”¨ï¼ŒHumongouså¯¹è±¡æ•°é‡æœ‰é™ï¼Œæ‰€ä»¥èƒ½å¤Ÿå¿«é€Ÿçš„çŸ¥é“æ˜¯å¦æœ‰è€å¹´ä»£å¯¹è±¡å¼•ç”¨å®ƒã€‚å¦‚æœæ²¡æœ‰ï¼Œèƒ½å¤Ÿé˜»æ­¢å®ƒè¢«å›æ”¶çš„å”¯ä¸€å¯èƒ½ï¼Œå°±æ˜¯æ–°ç”Ÿä»£æ˜¯å¦æœ‰å¯¹è±¡å¼•ç”¨äº†å®ƒï¼Œä½†è¿™ä¸ªä¿¡æ¯æ˜¯å¯ä»¥åœ¨Young GCæ—¶å°±çŸ¥é“çš„ï¼Œæ‰€ä»¥å®Œå…¨å¯ä»¥åœ¨Young GCä¸­å°±è¿›è¡ŒHumongouså¯¹è±¡çš„å›æ”¶ï¼Œä¸ç”¨åƒå…¶ä»–è€å¹´ä»£å¯¹è±¡é‚£æ ·ï¼Œç­‰å¾…å¹¶å‘æ ‡è®°ç»“æŸã€‚</p>\n</li>\n<li>\n<p>æˆ‘åœ¨<a href=\"http://time.geekbang.org/column/article/7349\">ä¸“æ ç¬¬5è®²</a>ï¼Œæåˆ°äº†åœ¨8u20ä»¥åå­—ç¬¦ä¸²æ’é‡çš„ç‰¹æ€§ï¼Œåœ¨åƒåœ¾æ”¶é›†è¿‡ç¨‹ä¸­ï¼ŒG1ä¼šæŠŠæ–°åˆ›å»ºçš„å­—ç¬¦ä¸²å¯¹è±¡æ”¾å…¥é˜Ÿåˆ—ä¸­ï¼Œç„¶ååœ¨Young GCä¹‹åï¼Œå¹¶å‘åœ°ï¼ˆä¸ä¼šSTWï¼‰å°†å†…éƒ¨æ•°æ®ï¼ˆcharæ•°ç»„ï¼ŒJDK 9ä»¥åæ˜¯byteæ•°ç»„ï¼‰ä¸€è‡´çš„å­—ç¬¦ä¸²è¿›è¡Œæ’é‡ï¼Œä¹Ÿå°±æ˜¯å°†å…¶å¼•ç”¨åŒä¸€ä¸ªæ•°ç»„ã€‚ä½ å¯ä»¥ä½¿ç”¨ä¸‹é¢å‚æ•°æ¿€æ´»ï¼š</p>\n</li>\n</ul>\n<pre><code>-XX:+UseStringDeduplication\n</code></pre>\n<p>æ³¨æ„ï¼Œè¿™ç§æ’é‡è™½ç„¶å¯ä»¥èŠ‚çœä¸å°‘å†…å­˜ç©ºé—´ï¼Œä½†è¿™ç§å¹¶å‘æ“ä½œä¼šå ç”¨ä¸€äº›CPUèµ„æºï¼Œä¹Ÿä¼šå¯¼è‡´Young GCç¨å¾®å˜æ…¢ã€‚</p>\n<ul>\n<li>ç±»å‹å¸è½½æ˜¯ä¸ªé•¿æœŸå›°æ‰°ä¸€äº›Javaåº”ç”¨çš„é—®é¢˜ï¼Œåœ¨<a href=\"http://time.geekbang.org/column/article/10192\">ä¸“æ ç¬¬25è®²</a>ä¸­ï¼Œæˆ‘ä»‹ç»äº†ä¸€ä¸ªç±»åªæœ‰å½“åŠ è½½å®ƒçš„è‡ªå®šä¹‰ç±»åŠ è½½å™¨è¢«å›æ”¶åï¼Œæ‰èƒ½è¢«å¸è½½ã€‚å…ƒæ•°æ®åŒºæ›¿æ¢äº†æ°¸ä¹…ä»£ä¹‹åæœ‰æ‰€æ”¹å–„ï¼Œä½†è¿˜æ˜¯å¯èƒ½å‡ºç°é—®é¢˜ã€‚</li>\n</ul>\n<p>G1çš„ç±»å‹å¸è½½æœ‰ä»€ä¹ˆæ”¹è¿›å—ï¼Ÿå¾ˆå¤šèµ„æ–™ä¸­éƒ½è°ˆåˆ°ï¼ŒG1åªæœ‰åœ¨å‘ç”ŸFull GCæ—¶æ‰è¿›è¡Œç±»å‹å¸è½½ï¼Œä½†è¿™æ˜¾ç„¶ä¸æ˜¯æˆ‘ä»¬æƒ³è¦çš„ã€‚ä½ å¯ä»¥åŠ ä¸Šä¸‹é¢çš„å‚æ•°æŸ¥çœ‹ç±»å‹å¸è½½ï¼š</p>\n<pre><code>-XX:+TraceClassUnloading\n</code></pre>\n<p>å¹¸å¥½ç°ä»£çš„G1å·²ç»ä¸æ˜¯å¦‚æ­¤äº†ï¼Œ8u40ä»¥åï¼ŒG1å¢åŠ å¹¶é»˜è®¤å¼€å¯ä¸‹é¢çš„é€‰é¡¹ï¼š</p>\n<pre><code>-XX:+ClassUnloadingWithConcurrentMark\n</code></pre>\n<p>ä¹Ÿå°±æ˜¯è¯´ï¼Œåœ¨å¹¶å‘æ ‡è®°é˜¶æ®µç»“æŸåï¼ŒJVMå³è¿›è¡Œç±»å‹å¸è½½ã€‚</p>\n<ul>\n<li>æˆ‘ä»¬çŸ¥é“è€å¹´ä»£å¯¹è±¡å›æ”¶ï¼ŒåŸºæœ¬è¦ç­‰å¾…å¹¶å‘æ ‡è®°ç»“æŸã€‚è¿™æ„å‘³ç€ï¼Œå¦‚æœå¹¶å‘æ ‡è®°ç»“æŸä¸åŠæ—¶ï¼Œå¯¼è‡´å †å·²æ»¡ï¼Œä½†è€å¹´ä»£ç©ºé—´è¿˜æ²¡å®Œæˆå›æ”¶ï¼Œå°±ä¼šè§¦å‘Full GCï¼Œæ‰€ä»¥è§¦å‘å¹¶å‘æ ‡è®°çš„æ—¶æœºå¾ˆé‡è¦ã€‚æ—©æœŸçš„G1è°ƒä¼˜ä¸­ï¼Œé€šå¸¸ä¼šè®¾ç½®ä¸‹é¢å‚æ•°ï¼Œä½†æ˜¯å¾ˆéš¾ç»™å‡ºä¸€ä¸ªæ™®é€‚çš„æ•°å€¼ï¼Œå¾€å¾€è¦æ ¹æ®å®é™…è¿è¡Œç»“æœè°ƒæ•´</li>\n</ul>\n<pre><code>-XX:InitiatingHeapOccupancyPercent\n</code></pre>\n<p>åœ¨JDK 9ä¹‹åçš„G1å®ç°ä¸­ï¼Œè¿™ç§è°ƒæ•´éœ€æ±‚ä¼šå°‘å¾ˆå¤šï¼Œå› ä¸ºJVMåªä¼šå°†è¯¥å‚æ•°ä½œä¸ºåˆå§‹å€¼ï¼Œä¼šåœ¨è¿è¡Œæ—¶è¿›è¡Œé‡‡æ ·ï¼Œè·å–ç»Ÿè®¡æ•°æ®ï¼Œç„¶åæ®æ­¤åŠ¨æ€è°ƒæ•´å¹¶å‘æ ‡è®°å¯åŠ¨æ—¶æœºã€‚å¯¹åº”çš„JVMå‚æ•°å¦‚ä¸‹ï¼Œé»˜è®¤å·²ç»å¼€å¯ï¼š</p>\n<pre><code>-XX:+G1UseAdaptiveIHOP\n</code></pre>\n<ul>\n<li>åœ¨ç°æœ‰çš„èµ„æ–™ä¸­ï¼Œå¤§å¤šæŒ‡å‡ºG1çš„Full GCæ˜¯æœ€å·®åŠ²çš„å•çº¿ç¨‹ä¸²è¡ŒGCã€‚å…¶å®ï¼Œå¦‚æœé‡‡ç”¨çš„æ˜¯æœ€æ–°çš„JDKï¼Œä½ ä¼šå‘ç°Full GCä¹Ÿæ˜¯å¹¶è¡Œè¿›è¡Œçš„äº†ï¼Œåœ¨é€šç”¨åœºæ™¯ä¸­çš„è¡¨ç°è¿˜ä¼˜äºParallel GCçš„Full GCå®ç°ã€‚</li>\n</ul>\n<p>å½“ç„¶ï¼Œè¿˜æœ‰å¾ˆå¤šå…¶ä»–çš„æ”¹å˜ï¼Œæ¯”å¦‚æ›´å¿«çš„Card Tableæ‰«æç­‰ï¼Œè¿™é‡Œä¸å†å±•å¼€ä»‹ç»ï¼Œå› ä¸ºå®ƒä»¬å¹¶ä¸å¸¦æ¥è¡Œä¸ºçš„å˜åŒ–ï¼ŒåŸºæœ¬ä¸å½±å“è°ƒä¼˜é€‰æ‹©ã€‚</p>\n<p>å‰é¢ä»‹ç»äº†G1çš„å†…éƒ¨æœºåˆ¶ï¼Œå¹¶ä¸”ç©¿æ’äº†éƒ¨åˆ†è°ƒä¼˜å»ºè®®ï¼Œä¸‹é¢ä»æ•´ä½“ä¸Šç»™å‡ºä¸€äº›è°ƒä¼˜çš„å»ºè®®ã€‚</p>\n<p>é¦–å…ˆï¼Œ<strong>å»ºè®®å°½é‡å‡çº§åˆ°è¾ƒæ–°çš„JDKç‰ˆæœ¬</strong>ï¼Œä»ä¸Šé¢ä»‹ç»çš„æ”¹è¿›å°±å¯ä»¥çœ‹åˆ°ï¼Œå¾ˆå¤šäººä»¬å¸¸å¸¸è®¨è®ºçš„é—®é¢˜ï¼Œå…¶å®å‡çº§JDKå°±å¯ä»¥è§£å†³äº†ã€‚</p>\n<p>ç¬¬äºŒï¼ŒæŒæ¡GCè°ƒä¼˜ä¿¡æ¯æ”¶é›†é€”å¾„ã€‚æŒæ¡å°½é‡å…¨é¢ã€è¯¦ç»†ã€å‡†ç¡®çš„ä¿¡æ¯ï¼Œæ˜¯å„ç§è°ƒä¼˜çš„åŸºç¡€ï¼Œä¸ä»…ä»…æ˜¯GCè°ƒä¼˜ã€‚æˆ‘ä»¬æ¥çœ‹çœ‹æ‰“å¼€GCæ—¥å¿—ï¼Œè¿™ä¼¼ä¹æ˜¯å¾ˆç®€å•çš„äº‹æƒ…ï¼Œå¯æ˜¯ä½ ç¡®å®šçœŸçš„æŒæ¡äº†å—ï¼Ÿ</p>\n<p>é™¤äº†å¸¸ç”¨çš„ä¸¤ä¸ªé€‰é¡¹ï¼Œ</p>\n<pre><code>-XX:+PrintGCDetails\n-XX:+PrintGCDateStamps\n</code></pre>\n<p>è¿˜æœ‰ä¸€äº›éå¸¸æœ‰ç”¨çš„æ—¥å¿—é€‰é¡¹ï¼Œå¾ˆå¤šç‰¹å®šé—®é¢˜çš„è¯Šæ–­éƒ½æ˜¯è¦ä¾èµ–è¿™äº›é€‰é¡¹ï¼š</p>\n<pre><code>-XX:+PrintAdaptiveSizePolicy // æ‰“å°G1 Ergonomicsç›¸å…³ä¿¡æ¯\n</code></pre>\n<p>æˆ‘ä»¬çŸ¥é“GCå†…éƒ¨ä¸€äº›è¡Œä¸ºæ˜¯é€‚åº”æ€§çš„è§¦å‘çš„ï¼Œåˆ©ç”¨PrintAdaptiveSizePolicyï¼Œæˆ‘ä»¬å°±å¯ä»¥çŸ¥é“ä¸ºä»€ä¹ˆJVMåšå‡ºäº†ä¸€äº›å¯èƒ½æˆ‘ä»¬ä¸å¸Œæœ›å‘ç”Ÿçš„åŠ¨ä½œã€‚ä¾‹å¦‚ï¼ŒG1è°ƒä¼˜çš„ä¸€ä¸ªåŸºæœ¬å»ºè®®å°±æ˜¯é¿å…è¿›è¡Œå¤§é‡çš„Humongouså¯¹è±¡åˆ†é…ï¼Œå¦‚æœErgonomicsä¿¡æ¯è¯´æ˜å‘ç”Ÿäº†è¿™ä¸€ç‚¹ï¼Œé‚£ä¹ˆå°±å¯ä»¥è€ƒè™‘è¦ä¹ˆå¢å¤§å †çš„å¤§å°ï¼Œè¦ä¹ˆç›´æ¥å°†regionå¤§å°æé«˜ã€‚</p>\n<p>å¦‚æœæ˜¯æ€€ç–‘å‡ºç°å¼•ç”¨æ¸…ç†ä¸åŠæ—¶çš„æƒ…å†µï¼Œåˆ™å¯ä»¥æ‰“å¼€ä¸‹é¢é€‰é¡¹ï¼ŒæŒæ¡åˆ°åº•æ˜¯å“ªé‡Œå‡ºç°äº†å †ç§¯ã€‚</p>\n<pre><code>-XX:+PrintReferenceGC\n</code></pre>\n<p>å¦å¤–ï¼Œå»ºè®®å¼€å¯é€‰é¡¹ä¸‹é¢çš„é€‰é¡¹è¿›è¡Œå¹¶è¡Œå¼•ç”¨å¤„ç†ã€‚</p>\n<pre><code>-XX:+ParallelRefProcEnabled\n</code></pre>\n<p>éœ€è¦æ³¨æ„çš„ä¸€ç‚¹æ˜¯ï¼ŒJDK 9ä¸­JVMå’ŒGCæ—¥å¿—æœºæ„è¿›è¡Œäº†é‡æ„ï¼Œå…¶å®æˆ‘å‰é¢æåˆ°çš„<strong>PrintGCDetailså·²ç»è¢«æ ‡è®°ä¸ºåºŸå¼ƒ</strong>ï¼Œè€Œ<strong>PrintGCDateStampså·²ç»è¢«ç§»é™¤</strong>ï¼ŒæŒ‡å®šå®ƒä¼šå¯¼è‡´JVMæ— æ³•å¯åŠ¨ã€‚å¯ä»¥ä½¿ç”¨ä¸‹é¢çš„å‘½ä»¤æŸ¥è¯¢æ–°çš„é…ç½®å‚æ•°ã€‚</p>\n<pre><code>java -Xlog:help\n</code></pre>\n<p>æœ€åï¼Œæ¥çœ‹ä¸€äº›é€šç”¨å®è·µï¼Œç†è§£äº†æˆ‘å‰é¢ä»‹ç»çš„å†…éƒ¨ç»“æ„å’Œæœºåˆ¶ï¼Œå¾ˆå¤šç»“è®ºå°±ä¸€ç›®äº†ç„¶äº†ï¼Œä¾‹å¦‚ï¼š</p>\n<ul>\n<li>å¦‚æœå‘ç°Young GCéå¸¸è€—æ—¶ï¼Œè¿™å¾ˆå¯èƒ½å°±æ˜¯å› ä¸ºæ–°ç”Ÿä»£å¤ªå¤§äº†ï¼Œæˆ‘ä»¬å¯ä»¥è€ƒè™‘å‡å°æ–°ç”Ÿä»£çš„æœ€å°æ¯”ä¾‹ã€‚</li>\n</ul>\n<pre><code>-XX:G1NewSizePercent\n</code></pre>\n<p>é™ä½å…¶æœ€å¤§å€¼åŒæ ·å¯¹é™ä½Young GCå»¶è¿Ÿæœ‰å¸®åŠ©ã€‚</p>\n<pre><code>-XX:G1MaxNewSizePercent\n</code></pre>\n<p>å¦‚æœæˆ‘ä»¬ç›´æ¥ä¸ºG1è®¾ç½®è¾ƒå°çš„å»¶è¿Ÿç›®æ ‡å€¼ï¼Œä¹Ÿä¼šèµ·åˆ°å‡å°æ–°ç”Ÿä»£çš„æ•ˆæœï¼Œè™½ç„¶ä¼šå½±å“ååé‡ã€‚</p>\n<ul>\n<li>å¦‚æœæ˜¯Mixed GCå»¶è¿Ÿè¾ƒé•¿ï¼Œæˆ‘ä»¬åº”è¯¥æ€ä¹ˆåšå‘¢ï¼Ÿ</li>\n</ul>\n<p>è¿˜è®°å¾—å‰é¢è¯´çš„ï¼Œéƒ¨åˆ†Old regionä¼šè¢«åŒ…å«è¿›Mixed GCï¼Œå‡å°‘ä¸€æ¬¡å¤„ç†çš„regionä¸ªæ•°ï¼Œå°±æ˜¯ä¸ªç›´æ¥çš„é€‰æ‹©ä¹‹ä¸€ã€‚<br />\næˆ‘åœ¨ä¸Šé¢å·²ç»ä»‹ç»äº†G1OldCSetRegionThresholdPercentæ§åˆ¶å…¶æœ€å¤§å€¼ï¼Œè¿˜å¯ä»¥åˆ©ç”¨ä¸‹é¢å‚æ•°æé«˜Mixed GCçš„ä¸ªæ•°ï¼Œå½“å‰é»˜è®¤å€¼æ˜¯8ï¼ŒMixed GCæ•°é‡å¢å¤šï¼Œæ„å‘³ç€æ¯æ¬¡è¢«åŒ…å«çš„regionå‡å°‘ã€‚</p>\n<pre><code>-XX:G1MixedGCCountTarget\n</code></pre>\n<p>ä»Šå¤©çš„å†…å®¹ç®—æ˜¯æŠ›ç –å¼•ç‰ï¼Œæ›´å¤šå†…å®¹ä½ å¯ä»¥å‚è€ƒ<a href=\"https://docs.oracle.com/javase/9/gctuning/garbage-first-garbage-collector-tuning.htm#JSGCT-GUID-4914A8D4-DE41-4250-B68E-816B58D4E278\">G1è°ƒä¼˜æŒ‡å—</a>ç­‰ï¼Œè¿œä¸æ˜¯å‡ å¥è¯å¯ä»¥å›Šæ‹¬çš„ã€‚éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œä¹Ÿè¦é¿å…è¿‡åº¦è°ƒä¼˜ï¼ŒG1å¯¹å¤§å †éå¸¸å‹å¥½ï¼Œå…¶è¿è¡Œæœºåˆ¶ä¹Ÿéœ€è¦æµªè´¹ä¸€å®šçš„ç©ºé—´ï¼Œæœ‰æ—¶å€™ç¨å¾®å¤šç»™å †ä¸€äº›ç©ºé—´ï¼Œæ¯”è¿›è¡Œè‹›åˆ»çš„è°ƒä¼˜æ›´åŠ å®ç”¨ã€‚</p>\n<p>ä»Šå¤©æˆ‘æ¢³ç†äº†åŸºæœ¬çš„GCè°ƒä¼˜æ€è·¯ï¼Œå¹¶å¯¹G1å†…éƒ¨ç»“æ„ä»¥åŠæœ€æ–°çš„è¡Œä¸ºå˜åŒ–è¿›è¡Œäº†è¯¦è§£ã€‚æ€»çš„æ¥è¯´ï¼ŒG1çš„è°ƒä¼˜ç›¸å¯¹ç®€å•ã€ç›´è§‚ï¼Œå› ä¸ºå¯ä»¥ç›´æ¥è®¾å®šæš‚åœæ—¶é—´ç­‰ç›®æ ‡ï¼Œå¹¶ä¸”å…¶å†…éƒ¨å¼•å…¥äº†å„ç§æ™ºèƒ½çš„è‡ªé€‚åº”æœºåˆ¶ï¼Œå¸Œæœ›è¿™ä¸€åˆ‡çš„åŠªåŠ›ï¼Œèƒ½å¤Ÿè®©ä½ åœ¨æ—¥å¸¸åº”ç”¨å¼€å‘æ—¶æ›´åŠ é«˜æ•ˆã€‚</p>\n<h2>ä¸€è¯¾ä¸€ç»ƒ</h2>\n<p>å…³äºä»Šå¤©æˆ‘ä»¬è®¨è®ºçš„é¢˜ç›®ä½ åšåˆ°å¿ƒä¸­æœ‰æ•°äº†å—ï¼Ÿä»Šå¤©çš„æ€è€ƒé¢˜æ˜¯ï¼Œå®šä½Full GCå‘ç”Ÿçš„åŸå› ï¼Œæœ‰å“ªäº›æ–¹å¼ï¼Ÿ</p>\n<p>è¯·ä½ åœ¨ç•™è¨€åŒºå†™å†™ä½ å¯¹è¿™ä¸ªé—®é¢˜çš„æ€è€ƒï¼Œæˆ‘ä¼šé€‰å‡ºç»è¿‡è®¤çœŸæ€è€ƒçš„ç•™è¨€ï¼Œé€ç»™ä½ ä¸€ä»½å­¦ä¹ å¥–åŠ±ç¤¼åˆ¸ï¼Œæ¬¢è¿ä½ ä¸æˆ‘ä¸€èµ·è®¨è®ºã€‚</p>\n<p>ä½ çš„æœ‹å‹æ˜¯ä¸æ˜¯ä¹Ÿåœ¨å‡†å¤‡é¢è¯•å‘¢ï¼Ÿä½ å¯ä»¥â€œè¯·æœ‹å‹è¯»â€ï¼ŒæŠŠä»Šå¤©çš„é¢˜ç›®åˆ†äº«ç»™å¥½å‹ï¼Œæˆ–è®¸ä½ èƒ½å¸®åˆ°ä»–ã€‚</p>\n<p></p>\n","comments":[{"had_liked":false,"id":19469,"user_name":"clz1341521","can_delete":false,"product_type":"c1","uid":1179557,"ip_address":"","ucode":"3BDB4AB454C918","user_header":"https://static001.geekbang.org/account/avatar/00/11/ff/a5/eccc7653.jpg","comment_is_top":false,"comment_ctime":1533859998,"is_pvip":false,"replies":[{"id":"7571","content":"ä¸é”™","user_name":"ä½œè€…å›å¤","user_name_real":"æ¨æ™“å³°","uid":"1009360","ctime":1535038628,"ip_address":"","comment_id":19469,"utype":1}],"discussion_count":2,"race_medal":0,"score":"263526865054","product_id":100006701,"comment_content":"1,é¦–å…ˆé€šè¿‡printgcdetail æŸ¥çœ‹fullgcé¢‘ç‡ä»¥åŠæ—¶é•¿<br>2,é€šè¿‡dump æŸ¥çœ‹å†…å­˜ä¸­å“ªäº›å¯¹è±¡å¤šï¼Œè¿™äº›å¯èƒ½æ˜¯å¼•èµ·fullgcçš„åŸå› ï¼Œçœ‹æ˜¯å¦èƒ½ä¼˜åŒ–<br>3,å¦‚æœå †å¤§æˆ–è€…æ˜¯ç”Ÿäº§ç¯å¢ƒï¼Œå¯ä»¥å¼€èµ·jmc é£è¡Œä¸€æ®µæ—¶é—´ï¼ŒæŸ¥çœ‹è¿™æœŸé—´çš„ç›¸å…³æ•°æ®æ¥è®¢ä½é—®é¢˜<br>","like_count":62,"discussions":[{"author":{"id":1009360,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/66/d0/6541f1d5.jpg","nickname":"æ¨æ™“å³°","note":"","ucode":"2BF255467A978F","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":421858,"discussion_content":"ä¸é”™","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1535038628,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1937062,"avatar":"https://static001.geekbang.org/account/avatar/00/1d/8e/a6/c3286b61.jpg","nickname":"Javaå’å¢™å·¥ç¨‹å¸ˆ","note":"","ucode":"E76AE44A9C76AE","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":302772,"discussion_content":"è¿™æ˜¯æœ¬åœ°ç¯å¢ƒå§ï¼Œçº¿ä¸Šç¯å¢ƒè¿™äº›è°ƒè¯•å·¥å…·å¾€å¾€ç”±äºæƒé™çš„ç¼˜æ•…è¿æ¥ä¸ä¸Šï¼Œæ€ä¹ˆå¼„å‘¢ï¼Ÿ","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1599026888,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":16069,"user_name":"åˆåŒå’å•æ˜¯ä¸€å¹´å•Š","can_delete":false,"product_type":"c1","uid":1000015,"ip_address":"","ucode":"E067320E537DEE","user_header":"https://static001.geekbang.org/account/avatar/00/0f/42/4f/ff1ac464.jpg","comment_is_top":false,"comment_ctime":1531757408,"is_pvip":false,"replies":[{"id":"5604","content":"ä¸é”™æ€è·¯ï¼Œå¦‚æœå †å¤ªå¤§dumpä¸ç°å®å‘¢ï¼›é™¤äº†gcæ—¥å¿—ï¼Œè¿˜æœ‰æ²¡æœ‰å…¶ä»–å·¥å…·ï¼Ÿ","user_name":"ä½œè€…å›å¤","user_name_real":"æ¨æ™“å³°","uid":"1009360","ctime":1531848343,"ip_address":"","comment_id":16069,"utype":1}],"discussion_count":3,"race_medal":0,"score":"78841168736","product_id":100006701,"comment_content":"FullGcå¯é€šè¿‡Gcæ—¥å¿— æˆ–è€…æ·»åŠ fullgcå‰åå †dump æŸ¥çœ‹å¼•èµ·fullgcåŸå›   CPUé£™å‡å¯ä»¥çœ‹çœ‹jstack","like_count":19,"discussions":[{"author":{"id":1000015,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/42/4f/ff1ac464.jpg","nickname":"åˆåŒå’å•æ˜¯ä¸€å¹´å•Š","note":"","ucode":"E067320E537DEE","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":4817,"discussion_content":"jmap æŸ¥çœ‹çº¿ä¸Šå †æ ˆå ç”¨æƒ…å†µ æ’åºåˆ†æå æ¯”è¾ƒå¤šå¯¹è±¡ã€‚ ç¼©å°é—®é¢˜èŒƒå›´","likes_number":3,"is_delete":false,"is_hidden":false,"ctime":1565752122,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1009360,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/66/d0/6541f1d5.jpg","nickname":"æ¨æ™“å³°","note":"","ucode":"2BF255467A978F","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":420652,"discussion_content":"ä¸é”™æ€è·¯ï¼Œå¦‚æœå †å¤ªå¤§dumpä¸ç°å®å‘¢ï¼›é™¤äº†gcæ—¥å¿—ï¼Œè¿˜æœ‰æ²¡æœ‰å…¶ä»–å·¥å…·ï¼Ÿ","likes_number":2,"is_delete":false,"is_hidden":false,"ctime":1531848343,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":1,"child_discussions":[{"author":{"id":1000015,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/42/4f/ff1ac464.jpg","nickname":"åˆåŒå’å•æ˜¯ä¸€å¹´å•Š","note":"","ucode":"E067320E537DEE","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":1009360,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/66/d0/6541f1d5.jpg","nickname":"æ¨æ™“å³°","note":"","ucode":"2BF255467A978F","race_medal":0,"user_type":2,"is_pvip":false},"discussion":{"id":571721,"discussion_content":"konajdkå¯ä»¥ç©ä¸å“ˆå“ˆ","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1652365313,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":420652,"ip_address":""},"score":571721,"extra":""}]}]},{"had_liked":false,"id":61025,"user_name":"åŠä¸ªè¥¿ç“œ","can_delete":false,"product_type":"c1","uid":1157662,"ip_address":"","ucode":"E6386B0A09B789","user_header":"https://static001.geekbang.org/account/avatar/00/11/aa/1e/e7ba85d9.jpg","comment_is_top":false,"comment_ctime":1547605148,"is_pvip":false,"replies":[{"id":"23329","content":"è¯´æ¥è¯é•¿ï¼Œç®€å•è¯´ï¼Œé™¤äº†å°½é‡è®©æ›´å¤šGCå·¥ä½œå¹¶å‘è¿›è¡Œï¼ŒG1çš„å†…å­˜åŒºåŸŸæ˜¯å¦‚æ£‹ç›˜ä¸€æ ·çš„ä¸€ä¸ªä¸ªregionï¼Œéè¿ç»­æ€§å†…å­˜åˆ’åˆ†ä»¥åŠä¸€äº›è®¾è®¡ï¼Œè®©ç›¸å½“ä¸€éƒ¨åˆ†å·¥ä½œå¤„ç†æ—¶é—´ä¸å †å¤§å°ä¸æ˜¯å¾ˆç›¸å…³ï¼ˆå½“ç„¶ä¹Ÿä¸æ˜¯å®Œå…¨å¦‚æ­¤ï¼‰","user_name":"ä½œè€…å›å¤","user_name_real":"æ¨æ™“å³°","uid":"1009360","ctime":1549813711,"ip_address":"","comment_id":61025,"utype":1}],"discussion_count":1,"race_medal":0,"score":"44497278108","product_id":100006701,"comment_content":"è€å¸ˆï¼Œä¸ºä»€ä¹ˆ G1 å¯¹å¤§å †éå¸¸å‹å¥½ã€‚æ˜¯å› ä¸ºè¿è¡Œæœºåˆ¶ä¹Ÿéœ€è¦æµªè´¹ä¸€å®šçš„ç©ºé—´ï¼Ÿ","like_count":11,"discussions":[{"author":{"id":1009360,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/66/d0/6541f1d5.jpg","nickname":"æ¨æ™“å³°","note":"","ucode":"2BF255467A978F","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":436710,"discussion_content":"è¯´æ¥è¯é•¿ï¼Œç®€å•è¯´ï¼Œé™¤äº†å°½é‡è®©æ›´å¤šGCå·¥ä½œå¹¶å‘è¿›è¡Œï¼ŒG1çš„å†…å­˜åŒºåŸŸæ˜¯å¦‚æ£‹ç›˜ä¸€æ ·çš„ä¸€ä¸ªä¸ªregionï¼Œéè¿ç»­æ€§å†…å­˜åˆ’åˆ†ä»¥åŠä¸€äº›è®¾è®¡ï¼Œè®©ç›¸å½“ä¸€éƒ¨åˆ†å·¥ä½œå¤„ç†æ—¶é—´ä¸å †å¤§å°ä¸æ˜¯å¾ˆç›¸å…³ï¼ˆå½“ç„¶ä¹Ÿä¸æ˜¯å®Œå…¨å¦‚æ­¤ï¼‰","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1549813711,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":15506,"user_name":"æ½‡æ´’çš„æ¯…å°å³°","can_delete":false,"product_type":"c1","uid":1118141,"ip_address":"","ucode":"24638DAED92F08","user_header":"https://static001.geekbang.org/account/avatar/00/11/0f/bd/7a9b2a0c.jpg","comment_is_top":false,"comment_ctime":1531241578,"is_pvip":false,"replies":[{"id":"5309","content":"æ±—","user_name":"ä½œè€…å›å¤","user_name_real":"æ¨æ™“å³°","uid":"1009360","ctime":1531319830,"ip_address":"","comment_id":15506,"utype":1}],"discussion_count":1,"race_medal":0,"score":"44480914538","product_id":100006701,"comment_content":"è€å¸ˆè¦å¿«ç‚¹æ›´æ–°å•Šæ„Ÿè§‰åˆ°26æ›´ä¸å®Œï¼Œæ ¡æ‹›é©¬ä¸Šå¼€å§‹äº†å‘¢ï¼Œå­¦çš„ä¸äº¦ä¹ä¹","like_count":11,"discussions":[{"author":{"id":1009360,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/66/d0/6541f1d5.jpg","nickname":"æ¨æ™“å³°","note":"","ucode":"2BF255467A978F","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":420414,"discussion_content":"æ±—","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1531319830,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":82953,"user_name":"ç¨‹åºå‘˜å°è·ƒ","can_delete":false,"product_type":"c1","uid":1015483,"ip_address":"","ucode":"25BB96E0791A60","user_header":"https://static001.geekbang.org/account/avatar/00/0f/7e/bb/947c329a.jpg","comment_is_top":false,"comment_ctime":1554358804,"is_pvip":true,"discussion_count":0,"race_medal":0,"score":"35914097172","product_id":100006701,"comment_content":"å‰é¢çš„è¯¾ç¨‹è¿˜è¡Œï¼Œæ¥è§¦äº†åƒåœ¾æ”¶é›†è¿™å‡ èŠ‚è¯¾ï¼Œæ„Ÿè§‰è¿™è¯¾ç¨‹çœŸçš„å¾ˆèµï¼ŒæŠŠæˆ‘å¾ˆå¤šè‡ªä¿¡éƒ½æ‰“è´¥äº†ï¼Œè¦å¥½å¥½å­¦ä¹ ","like_count":9},{"had_liked":false,"id":226042,"user_name":"gwl","can_delete":false,"product_type":"c1","uid":1320592,"ip_address":"","ucode":"24F334E9AC0313","user_header":"https://static001.geekbang.org/account/avatar/00/14/26/90/f68608f3.jpg","comment_is_top":false,"comment_ctime":1591934094,"is_pvip":true,"discussion_count":1,"race_medal":0,"score":"31656705166","product_id":100006701,"comment_content":"é‡åˆ°è¿‡çº¿ä¸Šç³»ç»Ÿå¡é¡¿çš„æƒ…å†µã€‚ä¸šåŠ¡ååº”ç³»ç»Ÿç™»å½•ä¸ä¸Šï¼Œç”¨top -p -h å’Œ jstack å‘ç°æ˜¯gcçº¿ç¨‹ï¼ˆæ•°é‡å’Œå†…æ ¸æ•°ä¸€è‡´ä¸”çº¿ç¨‹ç¼–å·è¿ç»­ï¼‰ï¼Œæ’æŸ¥å†…å­˜ä¸­å¯¹è±¡æ•°é‡ (jmap -histo:live javaPid) å’Œ è¯·æ±‚æ—¥å¿—(elkæˆ–è€…log4jæ—¥å¿—)ï¼Œå‘ç°æ˜¯ç”Ÿæˆexcelæ•°æ®å¤ªå¤šï¼Œä¸€ä¸‹å­æŠŠè€å¹´ä»£ç»™æ’‘çˆ†äº†ï¼Œå¯¼è‡´ç–¯ç‹‚çš„full gcã€‚<br>åå°†excelç”Ÿæˆç±»ä¸´æ—¶æ›¿æ¢æˆ SXSSFWorkbook å°±æš‚æ—¶æ²¡æœ‰å‡ºç°è¿‡ã€‚","like_count":8,"discussions":[{"author":{"id":1597200,"avatar":"https://static001.geekbang.org/account/avatar/00/18/5f/10/ed332d5a.jpg","nickname":"warriorSL","note":"","ucode":"902DA345FD2623","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":352810,"discussion_content":"å»ºè®®ä½¿ç”¨easyExcelï¼Œå› ä¸ºpoiç”Ÿæˆexcelä¼šåˆ›å»ºå¤§é‡çš„é¢å¤–å¯¹è±¡ï¼Œå®¹æ˜“å¯¼è‡´oomï¼ŒeasyExcelå†…éƒ¨å…¶å®ä¹Ÿæ˜¯å¯¹poiçš„å°è£…ï¼Œä¹Ÿæ˜¯ç›´æ¥ä½¿ç”¨sxssæ¨¡å¼çš„","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1614858134,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":223090,"user_name":"è“ä¼½å›¾","can_delete":false,"product_type":"c1","uid":1442705,"ip_address":"","ucode":"F2FBCE654E95B4","user_header":"http://thirdwx.qlogo.cn/mmopen/vi_32/FmjAcibbIH7AH7Zwy5RZg6BMsjWTib8iaY6VhY7ibouZWWhpMX3RoJicgeiapUdK2iaSbatQYZFU3PdUPGjl5TqJnxTnQ/132","comment_is_top":false,"comment_ctime":1590999529,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"31655770601","product_id":100006701,"comment_content":"1.æŸ¥çœ‹full gcçš„é¢‘ç‡å’Œæ—¶é—´ï¼Œä»¥åŠå›æ”¶å‰å’Œå›æ”¶åè€å¹´ä»£å›æ”¶äº†å¤šå°‘åƒåœ¾<br>2.å¦‚æœå›æ”¶çš„åƒåœ¾å¾ˆå¤šï¼Œæ¯”å¦‚ 80%-&gt;20% è€ƒè™‘ä¸šåŠ¡æ˜¯å¦æœ‰å¯ä»¥ä¼˜åŒ–çš„åœ°æ–¹ï¼Œæ˜¯å¦æœ‰åŒç±»å‹å¯¹è±¡çŸ­æ—¶é—´å¤§é‡è¿‡æœŸï¼Œå¯ä»¥åœ¨å†…å­˜é«˜ä½æ‰§è¡Œ dump  ç„¶åç­‰full gc åå†dumpåšå¯¹æ¯”<br>3.å¦‚æœå›æ”¶çš„åƒåœ¾æ¯”è¾ƒå°‘ï¼Œæ‰§è¡Œdumpï¼ŒæŸ¥çœ‹å“ªäº›å¯¹è±¡å ç”¨äº†å¤§éƒ¨åˆ†ç©ºé—´ï¼Œæ˜¯ä¸æ˜¯å‘ç”Ÿäº†å†…å­˜æ³„éœ²ï¼Œå¼•ç”¨éƒ½è¢«å“ªäº›å¯¹è±¡æŒæœ‰ï¼Œæ˜¯å¦åº”è¯¥åŠæ—¶é‡Šæ”¾ç­‰ã€‚","like_count":8},{"had_liked":false,"id":16064,"user_name":"åˆåŒå’å•æ˜¯ä¸€å¹´å•Š","can_delete":false,"product_type":"c1","uid":1000015,"ip_address":"","ucode":"E067320E537DEE","user_header":"https://static001.geekbang.org/account/avatar/00/0f/42/4f/ff1ac464.jpg","comment_is_top":false,"comment_ctime":1531756419,"is_pvip":false,"replies":[{"id":"5608","content":"æˆ‘ç†è§£card tableæ˜¯remembered setçš„ä¸€ç§å®ç°","user_name":"ä½œè€…å›å¤","user_name_real":"æ¨æ™“å³°","uid":"1009360","ctime":1531849110,"ip_address":"","comment_id":16064,"utype":1}],"discussion_count":3,"race_medal":0,"score":"23006592899","product_id":100006701,"comment_content":"è¯·é—®Remembered Setå’Œcardtableå…³ç³»æ˜¯æ€ä¹ˆæ ·çš„ï¼Ÿä»–ä»¬ä¹‹é—´æ˜¯å¦‚ä½•åä½œä¸€èµ·å®Œæˆg1 gcçš„ï¼Ÿ","like_count":6,"discussions":[{"author":{"id":1009360,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/66/d0/6541f1d5.jpg","nickname":"æ¨æ™“å³°","note":"","ucode":"2BF255467A978F","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":420651,"discussion_content":"æˆ‘ç†è§£card tableæ˜¯remembered setçš„ä¸€ç§å®ç°","likes_number":1,"is_delete":false,"is_hidden":false,"ctime":1531849110,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":2363417,"avatar":"https://static001.geekbang.org/account/avatar/00/24/10/19/8c3d6490.jpg","nickname":"R","note":"","ucode":"D09DECDF355D07","race_medal":0,"user_type":1,"is_pvip":true},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":578381,"discussion_content":"https://hllvm-group.iteye.com/group/topic/21468#post-272070 \nhttps://www.zhihu.com/question/63785052/answer/216407946 \nâ€”â€”from RednaxelaFX","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1656686512,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1158138,"avatar":"https://static001.geekbang.org/account/avatar/00/11/ab/fa/2967c8eb.jpg","nickname":"zhcc","note":"","ucode":"2AB9D306DBFAC2","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":263620,"discussion_content":"æ˜¯ï¼Œã€Šæ·±å…¥ç†è§£Javaè™šæ‹Ÿæœºã€‹é‡Œè¿™ä¹ˆè¯´çš„ã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1589213820,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":20190,"user_name":"è˜…","can_delete":false,"product_type":"c1","uid":1169985,"ip_address":"","ucode":"4ADC831DCFADEC","user_header":"https://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTIkickwTUOdmhMXj0oyXVAIXSUpCeCddSUnvWRJpSSB3PxEQHSr2pw813egTshq1QXNwxDcl3KZP1Q/132","comment_is_top":false,"comment_ctime":1534302680,"is_pvip":false,"replies":[{"id":"7381","content":"å½“ç„¶å¯ä»¥ï¼Œæ— å…³çš„ï¼›å»ºè®®éšæ‰‹è¯•éªŒä¸€ä¸‹ï¼Œé¡ºé“ç†Ÿæ‚‰å„ç§gcæ€ä¹ˆå¯ç”¨","user_name":"ä½œè€…å›å¤","user_name_real":"æ¨æ™“å³°","uid":"1009360","ctime":1534860602,"ip_address":"","comment_id":20190,"utype":1}],"discussion_count":1,"race_medal":0,"score":"14419204568","product_id":100006701,"comment_content":"-XX:+PrintGCDetails<br>-XX:+PrintGCDateStamps<br>è¿™ä¸¤ä¸ªå‚æ•°å¯ç”¨äºCMS GCä¸‹å—ï¼Ÿè¿˜æ˜¯åªèƒ½ç”¨äºG1 GC?","like_count":4,"discussions":[{"author":{"id":1009360,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/66/d0/6541f1d5.jpg","nickname":"æ¨æ™“å³°","note":"","ucode":"2BF255467A978F","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":422143,"discussion_content":"å½“ç„¶å¯ä»¥ï¼Œæ— å…³çš„ï¼›å»ºè®®éšæ‰‹è¯•éªŒä¸€ä¸‹ï¼Œé¡ºé“ç†Ÿæ‚‰å„ç§gcæ€ä¹ˆå¯ç”¨","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1534860602,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":16419,"user_name":"Pantheon","can_delete":false,"product_type":"c1","uid":1110487,"ip_address":"","ucode":"D1FF4C18CE3475","user_header":"https://static001.geekbang.org/account/avatar/00/10/f1/d7/a52e390d.jpg","comment_is_top":false,"comment_ctime":1531938930,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"10121873522","product_id":100006701,"comment_content":"æ¨è€å¸ˆèƒ½ä¸èƒ½å…·ä½“è®²è®²cmsï¼Œè¿™ä¸ªåƒåœ¾å›æ”¶ä¼¼ä¹ç”¨çš„è¿˜æŒºå¤šçš„ï¼Œæ˜¨å¤©ä¸Šå®˜ç½‘ä»‹ç»çš„ä¹Ÿä¸æ˜¯å¾ˆè¯¦ç»†èƒ½ä¸èƒ½è¯´è¯´åŸç†ä»¥åŠå‚æ•°ä¼˜åŒ–çš„ä¸œè¥¿ï¼Œæ„Ÿè°¢äº†","like_count":2},{"had_liked":false,"id":16404,"user_name":"è€å®äººHoney","can_delete":false,"product_type":"c1","uid":1080653,"ip_address":"","ucode":"EA4AB5C0C33090","user_header":"https://static001.geekbang.org/account/avatar/00/10/7d/4d/d98865b2.jpg","comment_is_top":false,"comment_ctime":1531926949,"is_pvip":true,"discussion_count":0,"race_medal":0,"score":"10121861541","product_id":100006701,"comment_content":"è¿™ä¸€é›†æœ‰éš¾åº¦äº†ï¼Œå¹³æ—¶æ¥è§¦å¾—å°‘ï¼Œåˆæ­¥è¯»æ¥èƒ½å¸æ”¶çš„çœŸæœ‰é™ã€‚:(","like_count":2},{"had_liked":false,"id":16247,"user_name":"åˆåŒå’å•æ˜¯ä¸€å¹´å•Š","can_delete":false,"product_type":"c1","uid":1000015,"ip_address":"","ucode":"E067320E537DEE","user_header":"https://static001.geekbang.org/account/avatar/00/0f/42/4f/ff1ac464.jpg","comment_is_top":false,"comment_ctime":1531849534,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"10121784126","product_id":100006701,"comment_content":"æ„Ÿè°¢äº†è¿™ä¹ˆæ™šè¿˜åœ¨å›å¤.ç‚¹èµäº†","like_count":3},{"had_liked":false,"id":15556,"user_name":"ä¸‰å£å…ˆç”Ÿ","can_delete":false,"product_type":"c1","uid":1117257,"ip_address":"","ucode":"8E8672321FE510","user_header":"https://static001.geekbang.org/account/avatar/00/11/0c/49/d71e939d.jpg","comment_is_top":false,"comment_ctime":1531292121,"is_pvip":false,"replies":[{"id":"5307","content":"å—¯ï¼Œä¸è¿‡ï¼ŒåŠ liveä¼šè§¦å‘full gcå§","user_name":"ä½œè€…å›å¤","user_name_real":"æ¨æ™“å³°","uid":"1009360","ctime":1531318823,"ip_address":"","comment_id":15556,"utype":1}],"discussion_count":1,"race_medal":0,"score":"10121226713","product_id":100006701,"comment_content":"jmapæŒ‡ä»¤åŠ ä¸åŠ liveï¼Œåˆ†ææ˜¯å¦æ˜¯å†…å­˜æ³„æ¼æˆ–è€…æ˜¯è¯·æ±‚çš„å†…å­˜å¤„ç†ä¸è¿‡æ¥ç­‰åŸå› ã€‚","like_count":3,"discussions":[{"author":{"id":1009360,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/66/d0/6541f1d5.jpg","nickname":"æ¨æ™“å³°","note":"","ucode":"2BF255467A978F","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":420440,"discussion_content":"å—¯ï¼Œä¸è¿‡ï¼ŒåŠ liveä¼šè§¦å‘full gcå§","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1531318823,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":49588,"user_name":"Jacky.L","can_delete":false,"product_type":"c1","uid":1177556,"ip_address":"","ucode":"C7386D54129BC1","user_header":"https://static001.geekbang.org/account/avatar/00/11/f7/d4/1bc7e9b4.jpg","comment_is_top":false,"comment_ctime":1544739561,"is_pvip":false,"discussion_count":1,"race_medal":0,"score":"5839706857","product_id":100006701,"comment_content":"è¯·é—®ä¸åŒå¹´ä»£çš„GCä¼šåˆ†åˆ«è¿›è¡Œæ ‡è®°å—ï¼Ÿè¿˜æ˜¯è¯´ä¸åŒå¹´ä»£ä¼šå¯¹æ•´ä¸ªå †æ•´ä½“æ ‡è®°ä¸€æ¬¡","like_count":1,"discussions":[{"author":{"id":2780637,"avatar":"https://thirdwx.qlogo.cn/mmopen/vi_32/rwDnuLiceLXQgtjokfEUPY5u2bUfzPAqOcD4YsUTT6GwsNE6lpfYeIDXMSeicVVdCOO0RnlibGk73LH4rOTQtaUsg/132","nickname":"scrat","note":"","ucode":"C5834B408A79D6","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":396269,"discussion_content":"ä¼šåˆ†åˆ«æ ‡æˆ‘è®¤ä¸º","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1632407299,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":16059,"user_name":"åˆåŒå’å•æ˜¯ä¸€å¹´å•Š","can_delete":false,"product_type":"c1","uid":1000015,"ip_address":"","ucode":"E067320E537DEE","user_header":"https://static001.geekbang.org/account/avatar/00/0f/42/4f/ff1ac464.jpg","comment_is_top":false,"comment_ctime":1531755629,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"5826722925","product_id":100006701,"comment_content":"Remembered Setå’Œcardtable æ˜¯ä»€ä¹ˆå…³ç³»ä»€ä¹ˆæ—¶å€™ä½¿ç”¨èƒ½è¯´æ˜ä¸‹è¿™ä¸ªè¿‡ç¨‹å—","like_count":1},{"had_liked":false,"id":279727,"user_name":"éšé‡è€Œå®‰","can_delete":false,"product_type":"c1","uid":1903385,"ip_address":"","ucode":"BD7F7DB2A54B23","user_header":"http://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTJkKNKezgVwH4EnyLvfib2W2DaRC2U3q3kYDySK5HPPCSWicgtQgicX68UODich1I1FQaGkQ8Vk2pLpibA/132","comment_is_top":false,"comment_ctime":1613928919,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1613928919","product_id":100006701,"comment_content":"è¯·é—®ä¸€ä¸‹è€å¸ˆæ–‡ä¸­æåˆ°çš„â€œé€ƒé€¸å¤±è´¥â€èƒ½å¦è§£é‡Šä¸€ä¸‹æ˜¯ä»€ä¹ˆæ„æ€ï¼Ÿä¸‡åˆ†æ„Ÿè°¢","like_count":0},{"had_liked":false,"id":260653,"user_name":"æ—æ¯…é‘«","can_delete":false,"product_type":"c1","uid":1917916,"ip_address":"","ucode":"1BB3D186E90D96","user_header":"https://static001.geekbang.org/account/avatar/00/1d/43/dc/95d4f2c5.jpg","comment_is_top":false,"comment_ctime":1605078704,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1605078704","product_id":100006701,"comment_content":"ä¸€è¾¹çœ‹è¿™ä¸ªå­¦ä¹ ï¼Œä¸€è¾¹æ‹¿è¿™äº›é—®é¢˜æé—®ğŸ¤­ğŸ¤­ğŸ¤­","like_count":0},{"had_liked":false,"id":192711,"user_name":"æŠ¤çˆ½ä½¿è€…","can_delete":false,"product_type":"c1","uid":1275464,"ip_address":"","ucode":"12DC35DD74671C","user_header":"https://static001.geekbang.org/account/avatar/00/13/76/48/5ab89daa.jpg","comment_is_top":false,"comment_ctime":1584869255,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1584869255","product_id":100006701,"comment_content":"çº¿ä¸Šé—®é¢˜éƒ½æ€ä¹ˆè§£å†³çš„ï¼Ÿæ­»é”ï¼Œ top 100%ç­‰","like_count":0},{"had_liked":false,"id":150191,"user_name":"ç‹ç››æ­¦","can_delete":false,"product_type":"c1","uid":1182516,"ip_address":"","ucode":"DE7EF246D3DCE8","user_header":"https://static001.geekbang.org/account/avatar/00/12/0b/34/f41d73a4.jpg","comment_is_top":false,"comment_ctime":1573476781,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1573476781","product_id":100006701,"comment_content":"å­—ç¬¦ä¸²æ’é‡çš„ç‰¹æ€§,  æ˜¯JDKå“ªä¸ªç‰ˆæœ¬æä¾›çš„?","like_count":0},{"had_liked":false,"id":103208,"user_name":"å­ä¸è¯­","can_delete":false,"product_type":"c1","uid":1123186,"ip_address":"","ucode":"907AB44706467B","user_header":"https://static001.geekbang.org/account/avatar/00/11/23/72/70190bc1.jpg","comment_is_top":false,"comment_ctime":1560396650,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1560396650","product_id":100006701,"comment_content":"è€å¸ˆï¼Œå’¨è¯¢ä¸ªé—®é¢˜ï¼Œæˆ‘é€šè¿‡jinfo -flag +PrintGC PID  jinfo -flag +PrintGCDetails PIDï¼Œæ²¡åŠæ³•æŒ‡å®šè·¯å¾„ï¼Œgcæ—¥å¿—è¾“å‡ºåœ¨å“ªé‡Œçš„ï¼Œæ‰¾ä¸åˆ°ã€‚","like_count":0},{"had_liked":false,"id":26802,"user_name":"Sunny Li","can_delete":false,"product_type":"c1","uid":1252120,"ip_address":"","ucode":"7C3B8ABF6DEF93","user_header":"https://static001.geekbang.org/account/avatar/00/13/1b/18/80b4d8ae.jpg","comment_is_top":false,"comment_ctime":1537755672,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1537755672","product_id":100006701,"comment_content":"è€å¸ˆï¼Œæˆ‘æƒ³é—®ä¸€ä¸‹é™¤äº†dumpæ–‡ä»¶å’Œgcæ—¥å¿—ï¼Œè¿˜å¯ä»¥ä½¿ç”¨ä»€ä¹ˆå·¥å…·å¯ä»¥ç”¨&#39;jconsoleå—ï¼Œå…·ä½“å…³æ³¨é‚£å‡ ä¸ªå‚æ•°","like_count":0},{"had_liked":false,"id":17463,"user_name":"äºæµ·","can_delete":false,"product_type":"c1","uid":1054754,"ip_address":"","ucode":"19C026AC2A5A9E","user_header":"https://static001.geekbang.org/account/avatar/00/10/18/22/e817914c.jpg","comment_is_top":false,"comment_ctime":1532662257,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1532662257","product_id":100006701,"comment_content":"è¿™ä¸ªé—®é¢˜çœŸçš„å¾ˆéš¾ï¼Œå¦‚æœæ²¡æœ‰å®é™…çš„ç”Ÿäº§ç»éªŒï¼ŒçœŸçš„å¾ˆéš¾å›ç­”ï¼Œéº»çƒ¦è€å¸ˆèƒ½ç»™æä¾›ä¸€äº›å‚è€ƒæ–¹æ¡ˆå—ï¼Ÿè°¢è°¢æ‚¨ï½","like_count":0},{"had_liked":false,"id":16246,"user_name":"åˆåŒå’å•æ˜¯ä¸€å¹´å•Š","can_delete":false,"product_type":"c1","uid":1000015,"ip_address":"","ucode":"E067320E537DEE","user_header":"https://static001.geekbang.org/account/avatar/00/0f/42/4f/ff1ac464.jpg","comment_is_top":false,"comment_ctime":1531848907,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1531848907","product_id":100006701,"comment_content":"å¦‚æœdumpå †å¤ªå¤§.æˆ‘è§‰å¾—å¯ä»¥å…ˆé€šè¿‡jmap -heapçœ‹ä¸‹æ˜¯å“ªä¸ªåŒºå ç”¨ç‰¹åˆ«å¤š.å†çœ‹ä¸‹å¯¹å†…å­˜å ç”¨å‰20åˆ°30çš„å¤§å¯¹è±¡.ç„¶åç»“åˆjstat gccuase æŸ¥çœ‹ä¸‹å¼•èµ·GcåŸå›  .ç›®å‰æƒ³åˆ°è¿™äº›æ€è·¯è¯·é—®è¿˜æœ‰æ›´å¥½çš„å·¥å…·ï¼Ÿjconsole jdbè¿œç¨‹è¿æ¥æŸ¥çœ‹å ç”¨ï¼Ÿ","like_count":1},{"had_liked":false,"id":16060,"user_name":"åˆåŒå’å•æ˜¯ä¸€å¹´å•Š","can_delete":false,"product_type":"c1","uid":1000015,"ip_address":"","ucode":"E067320E537DEE","user_header":"https://static001.geekbang.org/account/avatar/00/0f/42/4f/ff1ac464.jpg","comment_is_top":false,"comment_ctime":1531755676,"is_pvip":false,"discussion_count":1,"race_medal":0,"score":"1531755676","product_id":100006701,"comment_content":"Remembered Setå’Œcardtableçš„å…³ç³»æ˜¯ä»€ä¹ˆï¼Ÿä»–ä»¬ä»€ä¹ˆæ—¶å€™ä½¿ç”¨èƒ½è¯´æ˜ä¸‹å—","like_count":0,"discussions":[{"author":{"id":2938089,"avatar":"https://thirdwx.qlogo.cn/mmopen/vi_32/V71ITElU4RwprR74pPXB6LhIMrfeAHuHjicZmS7smy2tibBSMoA9awaTe86wziatYzoy3qVOGs0DnSTy6ah5L6bKA/132","nickname":"å››å–œä¸¸å­","note":"","ucode":"33D46CC1B747BA","race_medal":0,"user_type":1,"is_pvip":true},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":577843,"discussion_content":"éœ€è¦è‡ªå·±å»æŸ¥æ‰¾èµ„æ–™ï¼Œ","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1656387170,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":15459,"user_name":"å°åˆš","can_delete":false,"product_type":"c1","uid":1130187,"ip_address":"","ucode":"AA2E7773B399F5","user_header":"https://static001.geekbang.org/account/avatar/00/11/3e/cb/a0624173.jpg","comment_is_top":false,"comment_ctime":1531198256,"is_pvip":false,"discussion_count":0,"race_medal":1,"score":"1531198256","product_id":100006701,"comment_content":"è€å¸ˆè®²çš„å¾ˆåˆ°ä½ï¼Œçœ‹å¾—ä¸æ˜¯å¾ˆæ˜ç™½ï¼Œå¾—å¤šçœ‹å‡ éã€‚","like_count":1}]}