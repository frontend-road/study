{"id":13562,"title":"05 | 程序实体的那些事儿（中）","content":"<p>在前文中，我解释过代码块的含义。Go语言的代码块是一层套一层的，就像大圆套小圆。</p><p>一个代码块可以有若干个子代码块；但对于每个代码块，最多只会有一个直接包含它的代码块（后者可以简称为前者的外层代码块）。</p><p>这种代码块的划分，也间接地决定了程序实体的作用域。我们今天就来看看它们之间的关系。</p><p>我先说说作用域是什么？大家都知道，一个程序实体被创造出来，是为了让别的代码引用的。那么，哪里的代码可以引用它呢，这就涉及了它的作用域。</p><p>我在前面说过，程序实体的访问权限有三种：包级私有的、模块级私有的和公开的。这其实就是Go语言在语言层面，依据代码块对程序实体作用域进行的定义。</p><p>包级私有和模块级私有访问权限对应的都是代码包代码块，公开的访问权限对应的是全域代码块。然而，这个颗粒度是比较粗的，我们往往需要利用代码块再细化程序实体的作用域。</p><p>比如，我在一个函数中声明了一个变量，那么在通常情况下，这个变量是无法被这个函数以外的代码引用的。这里的函数就是一个代码块，而变量的作用域被限制在了该代码块中。当然了，还有例外的情况，这部分内容，我留到讲函数的时候再说。</p><p>总之，请记住，<strong>一个程序实体的作用域总是会被限制在某个代码块中，而这个作用域最大的用处，就是对程序实体的访问权限的控制。</strong>对“高内聚，低耦合”这种程序设计思想的实践，恰恰可以从这里开始。</p><!-- [[[read_end]]] --><p>你应该可以通过下面的问题进一步感受代码块和作用域的魅力。</p><p><strong>今天的问题是：如果一个变量与其外层代码块中的变量重名会出现什么状况？</strong></p><p>我把此题的代码存到了demo10.go文件中了。你可以在“Golang_Puzzlers”项目的<code>puzzlers/article5/q1</code>包中找到它。</p><pre><code>package main\n\nimport &quot;fmt&quot;\n\nvar block = &quot;package&quot;\n\nfunc main() {\n\tblock := &quot;function&quot;\n\t{\n\t\tblock := &quot;inner&quot;\n\t\tfmt.Printf(&quot;The block is %s.\\n&quot;, block)\n\t}\n\tfmt.Printf(&quot;The block is %s.\\n&quot;, block)\n}\n</code></pre><p>这个命令源码文件中有四个代码块，它们是：全域代码块、<code>main</code>包代表的代码块、<code>main</code>函数代表的代码块，以及在<code>main</code>函数中的一个用花括号包起来的代码块。</p><p>我在后三个代码块中分别声明了一个名为<code>block</code>的变量，并分别把字符串值<code>\"package\"</code>、<code>\"function\"</code>和<code>\"inner\"</code>赋给了它们。此外，我在后两个代码块的最后分别尝试用<code>fmt.Printf</code>函数打印出“The block is %s.”。这里的“%s”只是为了占位，程序会用<code>block</code>变量的实际值替换掉。</p><p>具体的问题是：该源码文件中的代码能通过编译吗？如果不能，原因是什么？如果能，运行它后会打印出什么内容？</p><h2>典型回答</h2><p>能通过编译。运行后打印出的内容是：</p><pre><code>The block is inner.\nThe block is function.\n</code></pre><h2>问题解析</h2><p>初看这道题，你可能会认为它无法通过编译，因为三处代码都声明了相同名称的变量。的确，声明重名的变量是无法通过编译的，用短变量声明对已有变量进行重声明除外，但这只是对于同一个代码块而言的。</p><p>对于不同的代码块来说，其中的变量重名没什么大不了，照样可以通过编译。即使这些代码块有直接的嵌套关系也是如此，就像demo10.go中的<code>main</code>包代码块、<code>main</code>函数代码块和那个最内层的代码块那样。</p><p>这样规定显然很方便也很合理，否则我们会每天为了选择变量名而烦恼。但是这会导致另外一个问题，我引用变量时到底用的是哪一个？这也是这道题的第二个考点。</p><p>这其实有一个很有画面感的查找过程。这个查找过程不只针对于变量，还适用于任何程序实体。如下面所示。</p><ul>\n<li>首先，代码引用变量的时候总会最优先查找当前代码块中的那个变量。注意，这里的“当前代码块”仅仅是引用变量的代码所在的那个代码块，并不包含任何子代码块。</li>\n<li>其次，如果当前代码块中没有声明以此为名的变量，那么程序会沿着代码块的嵌套关系，从直接包含当前代码块的那个代码块开始，一层一层地查找。</li>\n<li>一般情况下，程序会一直查到当前代码包代表的代码块。如果仍然找不到，那么Go语言的编译器就会报错了。</li>\n</ul><p>还记得吗？如果我们在当前源码文件中导入了其他代码包，那么引用其中的程序实体时，是需要以限定符为前缀的。所以程序在找代表变量未加限定符的名字（即标识符）的时候，是不会去被导入的代码包中查找的。</p><blockquote>\n<p><span class=\"reference\">但有个特殊情况，如果我们把代码包导入语句写成<code>import . \"XXX\"</code>的形式（注意中间的那个“.”），那么就会让这个“XXX”包中公开的程序实体，被当前源码文件中的代码，视为当前代码包中的程序实体。</span></p>\n<p><span class=\"reference\"> 比如，如果有代码包导入语句<code>import . fmt</code>，那么我们在当前源码文件中引用<code>fmt.Printf</code>函数的时候直接用<code>Printf</code>就可以了。在这个特殊情况下，程序在查找当前源码文件后会先去查用这种方式导入的那些代码包。</span></p>\n</blockquote><p>好了，当你明白了上述过程之后，再去看demo10.go中的代码。是不是感觉清晰了很多？</p><p>从作用域的角度也可以说，虽然通过<code>var block = \"package\"</code>声明的变量作用域是整个<code>main</code>代码包，但是在<code>main</code>函数中，它却被那两个同名的变量“屏蔽”了。</p><p>相似的，虽然<code>main</code>函数首先声明的<code>block</code>的作用域，是整个<code>main</code>函数，但是在最内层的那个代码块中，它却是不可能被引用到的。反过来讲，最内层代码块中的<code>block</code>也不可能被该块之外的代码引用到，这也是打印内容的第二行是“The block is function.”的另一半原因。</p><p>你现在应该知道了，这道题看似简单，但是它考察以及可延展的范围并不窄。</p><h2>知识扩展</h2><p><strong>不同代码块中的重名变量与变量重声明中的变量区别到底在哪儿？</strong></p><p><strong>为了方便描述，我就把不同代码块中的重名变量叫做“可重名变量”吧。</strong>注意，在同一个代码块中不允许出现重名的变量，这违背了Go语言的语法。关于这两者的表象和机理，我们已经讨论得足够充分了。你现在可以说出几条区别？请想一想，然后再看下面的列表。</p><ol>\n<li>变量重声明中的变量一定是在某一个代码块内的。注意，这里的“某一个代码块内”并不包含它的任何子代码块，否则就变成了“多个代码块之间”。而可重名变量指的正是在多个代码块之间由相同的标识符代表的变量。</li>\n<li>变量重声明是对同一个变量的多次声明，这里的变量只有一个。而可重名变量中涉及的变量肯定是有多个的。</li>\n<li>不论对变量重声明多少次，其类型必须始终一致，具体遵从它第一次被声明时给定的类型。而可重名变量之间不存在类似的限制，它们的类型可以是任意的。</li>\n<li>如果可重名变量所在的代码块之间，存在直接或间接的嵌套关系，那么它们之间一定会存在“屏蔽”的现象。但是这种现象绝对不会在变量重声明的场景下出现。</li>\n</ol><p><img src=\"https://static001.geekbang.org/resource/image/5e/89/5e68210d5639f9e42738f21bd9eb1e89.png?wh=1839*1170\" alt=\"\"></p><p>当然了，我们之前谈论过，对变量进行重声明还有一些前提条件，不过在这里并不是重点。我就不再赘述了。</p><p>以上4大区别中的第3条需要你再注意一下。既然可重名变量的类型可以是任意的，那么当它们之间存在“屏蔽”时你就更需要注意了。</p><p>不同类型的值大都有着不同的特性和用法。当你在某一种类型的值上施加只有在其他类型值上才能做的操作时，Go语言编译器一定会告诉你：“这不可以”。</p><p>这种情况很好，甚至值得庆幸，因为你的程序存在的问题被提前发现了。如若不然，程序没准儿会在运行过程中由此引发很隐晦的问题，让你摸不着头脑。</p><p>相比之下，那时候排查问题的成本可就太高了。所以，我们应该尽量利用Go语言的语法、规范和命令来约束我们的程序。</p><p>具体到不同类型的可重名变量的问题上，让我们先来看一下<code>puzzlers/article5/q2</code>包中的源码文件demo11.go。它是一个很典型的例子。</p><pre><code>package main\n\nimport &quot;fmt&quot;\n\nvar container = []string{&quot;zero&quot;, &quot;one&quot;, &quot;two&quot;}\n\nfunc main() {\n\tcontainer := map[int]string{0: &quot;zero&quot;, 1: &quot;one&quot;, 2: &quot;two&quot;}\n\tfmt.Printf(&quot;The element is %q.\\n&quot;, container[1])\n}\n</code></pre><p>在demo11.go中，有两个都叫做<code>container</code>的变量，分别位于<code>main</code>包代码块和<code>main</code>函数代码块。<code>main</code>包代码块中的变量是切片（slice）类型的，另一个是字典（map）类型的。在<code>main</code>函数的最后，我试图打印出<code>container</code>变量的值中索引为<code>1</code>的那个元素。</p><p>如果你熟悉这两个类型肯定会知道，在它们的值上我们都可以施加索引表达式，比如<code>container[0]</code>。只要中括号里的整数在有效范围之内（这里是[0, 2]），它就可以把值中的某一个元素取出来。</p><p>如果<code>container</code>的类型不是数组、切片或字典类型，那么索引表达式就会引发编译错误。这正是利用Go语言语法，帮我们约束程序的一个例子；但是当我们想知道container确切类型的时候，利用索引表达式的方式就不够了。</p><p>当可重名变量的值被转换成某个接口类型值，或者它们的类型本身就是接口类型的时候，严格的类型检查就很有必要了。至于怎么检查，我们在下篇文章中再讨论。</p><h2>总结</h2><p>我们先讨论了代码块，并且也谈到了它与程序实体的作用域，以及访问权限控制之间的巧妙关系。Go语言本身对程序实体提供了相对粗粒度的访问控制。但我们自己可以利用代码块和作用域精细化控制它们。</p><p>如果在具有嵌套关系的不同代码块中存在重名的变量，那么我们应该特别小心，它们之间可能会发生“屏蔽”的现象。这样你在不同代码块中引用到变量很可能是不同的。具体的鉴别方式需要参考Go语言查找（代表了程序实体的）标识符的过程。</p><p>另外，请记住变量重声明与可重名变量之间的区别以及它们的重要特征。其中最容易产生隐晦问题的一点是，可重名变量可以各有各的类型。这时候我们往往应该在真正使用它们之前先对其类型进行检查。利用Go语言的语法、规范和命令做辅助的检查是很好的办法，但有些时候并不充分。</p><h2>思考题</h2><p>我们在讨论Go语言查找标识符时的范围的时候，提到过<code>import . XXX</code>这种导入代码包的方式。这里有个思考题：</p><p>如果通过这种方式导入的代码包中的变量与当前代码包中的变量重名了，那么Go语言是会把它们当做“可重名变量”看待还是会报错呢？</p><p>其实我们写个例子一试便知，但重点是为什么？请你尝试从代码块和作用域的角度解释试验得到的答案。</p><p><a href=\"https://github.com/hyper0x/Golang_Puzzlers\">戳此查看Go语言专栏文章配套详细代码。</a></p><p></p>","comments":[{"had_liked":false,"id":21089,"user_name":"衡子","can_delete":false,"product_type":"c1","uid":1109433,"ip_address":"","ucode":"0AED79FC9D14BB","user_header":"https://static001.geekbang.org/account/avatar/00/10/ed/b9/825b2411.jpg","comment_is_top":true,"comment_ctime":1534906143,"is_pvip":false,"discussion_count":20,"race_medal":0,"score":"9.2233734041893007e+18","product_id":100013101,"comment_content":"希望文字能再精简些，很绕！看起来比较费劲！当然内容还是不错的！","like_count":319,"discussions":[{"author":{"id":1018449,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/8a/51/91efec48.jpg","nickname":"左弈","note":"","ucode":"8E080299B69C42","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":15290,"discussion_content":"就没有“重声明”这回事吧。\n“:=”就是单纯的声明，所以不同作用域会声明出同名的不同变量。\n“n,err :=”，这种语法糖，其实声明的是新变量n，err是赋值操作，所以类型不能改变。\n我是这么理解的，感觉作者讲绕了呢。","likes_number":20,"is_delete":false,"is_hidden":false,"ctime":1568814481,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":3,"child_discussions":[{"author":{"id":1566635,"avatar":"https://static001.geekbang.org/account/avatar/00/17/e7/ab/8383ca5b.jpg","nickname":"刻刻","note":"","ucode":"AD7FA37FA99EBC","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":1018449,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/8a/51/91efec48.jpg","nickname":"左弈","note":"","ucode":"8E080299B69C42","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":350308,"discussion_content":"就是个多变量赋值","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1613809266,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":15290,"ip_address":""},"score":350308,"extra":""},{"author":{"id":2599361,"avatar":"https://static001.geekbang.org/account/avatar/00/27/a9/c1/b927bfa5.jpg","nickname":"阿白","note":"","ucode":"8D2D594A7FEA09","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":1018449,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/8a/51/91efec48.jpg","nickname":"左弈","note":"","ucode":"8E080299B69C42","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":372165,"discussion_content":"感觉作者说的是这个意思，不知道对不对","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1620217468,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":15290,"ip_address":""},"score":372165,"extra":""},{"author":{"id":1001736,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/49/08/a194689c.jpg","nickname":"百变茄","note":"","ucode":"0C24BF85903405","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":1018449,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/8a/51/91efec48.jpg","nickname":"左弈","note":"","ucode":"8E080299B69C42","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":537479,"discussion_content":"很早就买了这门课程，看了几篇文章就放弃了，简直误人子弟啊。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1639064194,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":15290,"ip_address":""},"score":537479,"extra":""}]},{"author":{"id":1260026,"avatar":"https://static001.geekbang.org/account/avatar/00/13/39/fa/a7edbc72.jpg","nickname":"安排","note":"","ucode":"F78CFA9624CAEF","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":127175,"discussion_content":"讲的很绕，作者文字功底欠缺","likes_number":11,"is_delete":false,"is_hidden":false,"ctime":1578570166,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":2273620,"avatar":"https://static001.geekbang.org/account/avatar/00/22/b1/54/6d663b95.jpg","nickname":"瓜牛","note":"","ucode":"5EB7D2F4400A70","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":319633,"discussion_content":"确实，一个赋值操作非要叫变量重声明，懵了半天才理解作者意思","likes_number":10,"is_delete":false,"is_hidden":false,"ctime":1604066357,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1228084,"avatar":"https://static001.geekbang.org/account/avatar/00/12/bd/34/498a47fb.jpg","nickname":"王😑王","note":"","ucode":"15A7D7D7F65A64","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":372565,"discussion_content":"是的，特别绕，特别多自造的名词","likes_number":6,"is_delete":false,"is_hidden":false,"ctime":1620377813,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1065849,"avatar":"https://static001.geekbang.org/account/avatar/00/10/43/79/18073134.jpg","nickname":"test","note":"","ucode":"9A4973E591DD12","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":374019,"discussion_content":"确实不是一般的绕。看go圣经都没这么绕。","likes_number":3,"is_delete":false,"is_hidden":false,"ctime":1620972604,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":1,"child_discussions":[{"author":{"id":2622226,"avatar":"https://static001.geekbang.org/account/avatar/00/28/03/12/a4752c18.jpg","nickname":"杨文","note":"","ucode":"86897587CB8F64","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":1065849,"avatar":"https://static001.geekbang.org/account/avatar/00/10/43/79/18073134.jpg","nickname":"test","note":"","ucode":"9A4973E591DD12","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":378933,"discussion_content":"朋友推荐的这个。我看了，非常中国化的描述，简单的技术，变着花样往复杂去讲，废话太多。还不如我看菜鸟学的快。就这还3w多购买，有多少人看完了？","likes_number":6,"is_delete":false,"is_hidden":false,"ctime":1623514958,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":374019,"ip_address":""},"score":378933,"extra":""}]},{"author":{"id":2806043,"avatar":"https://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTLBFkSq1oiaEMRjtyyv4ZpCI0OuaSsqs04ODm0OkZF6QhsAh3SvqhxibS2n7PLAVZE3QRSn5Hic0DyXg/132","nickname":"ddh","note":"","ucode":"8E852375365F16","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":540767,"discussion_content":"确实有点， 把原本会的人都看不会了","likes_number":1,"is_delete":false,"is_hidden":false,"ctime":1640156674,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":2370088,"avatar":"https://static001.geekbang.org/account/avatar/00/24/2a/28/ee26afcb.jpg","nickname":"阿鹏","note":"","ucode":"C97BA6F7C569EB","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":381841,"discussion_content":"局部变量说的这么复杂","likes_number":1,"is_delete":false,"is_hidden":false,"ctime":1625234705,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1169431,"avatar":"https://static001.geekbang.org/account/avatar/00/11/d8/17/367943f4.jpg","nickname":"吴永祺","note":"","ucode":"294ADA49541AAE","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":20916,"discussion_content":"有道理啊，这样理解清楚多了","likes_number":1,"is_delete":false,"is_hidden":false,"ctime":1569393745,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1295111,"avatar":"https://static001.geekbang.org/account/avatar/00/13/c3/07/42188ca5.jpg","nickname":"qinghuazs","note":"","ucode":"2CFFA349A3A71B","race_medal":0,"user_type":1,"is_pvip":true},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":575425,"discussion_content":"属实，文章逻辑不太清晰，读起来很吃力","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1654826397,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1189663,"avatar":"https://static001.geekbang.org/account/avatar/00/12/27/1f/ee4bdace.jpg","nickname":"七月上","note":"","ucode":"0908AE5D2F4D61","race_medal":0,"user_type":1,"is_pvip":true},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":554124,"discussion_content":"确实","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1646222672,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":2599361,"avatar":"https://static001.geekbang.org/account/avatar/00/27/a9/c1/b927bfa5.jpg","nickname":"阿白","note":"","ucode":"8D2D594A7FEA09","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":372164,"discussion_content":"还是没明白可重名变量和变量可重声明之间的本质区别。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1620217407,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":3,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1142265,"avatar":"https://static001.geekbang.org/account/avatar/00/11/6d/f9/7431e82e.jpg","nickname":"24小菜鸟","note":"","ucode":"02D6127A2DE3C1","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":369038,"discussion_content":"确实绕","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1618909664,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":3,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":2422365,"avatar":"","nickname":"soyoungad","note":"","ucode":"F937BF11B95AE1","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":368157,"discussion_content":"多写个例子容易懂","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1618583336,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":3,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":2016574,"avatar":"https://static001.geekbang.org/account/avatar/00/1e/c5/3e/3df0c488.jpg","nickname":"jiyoujiu","note":"","ucode":"7A3EAA2DA97A78","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":344533,"discussion_content":"确实很绕","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1611490963,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":3,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1746778,"avatar":"","nickname":"Geek_3422f7","note":"","ucode":"CFC17ACB0660C3","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":324683,"discussion_content":"描述的却是不精简","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1605151693,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":3,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1017297,"avatar":"http://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTKYfcUOVhf3vhEBUNGHgtIcw8ujMZnkabicLzzjn3xwdeeic2PJSe7ibJgMx2UjF0d7L4B4gsRpaqe2A/132","nickname":"郭小菜","note":"","ucode":"C4044C80BB331B","race_medal":0,"user_type":1,"is_pvip":true},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":297069,"discussion_content":"的确有点绕了","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1596766289,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":3,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":21021,"user_name":"咖啡色的羊驼","can_delete":false,"product_type":"c1","uid":1112900,"ip_address":"","ucode":"84E288A5665A3A","user_header":"https://static001.geekbang.org/account/avatar/00/10/fb/44/8b2600fd.jpg","comment_is_top":true,"comment_ctime":1534868477,"is_pvip":false,"discussion_count":2,"race_medal":0,"score":"9.2233722617278996e+18","product_id":100013101,"comment_content":"会报redeclared。<br>采用import . xxx如文章所说，基本上就会认为引入的代码包的代码，如同在本包中一样，那作用域其实是同一个，自然不允许重复声明。<br>后文期待作者提到变量逃逸的问题，这个还蛮有趣的。<br><br>","like_count":53,"discussions":[{"author":{"id":1041640,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/e4/e8/a1703783.jpg","nickname":"mrlay","note":"","ucode":"385A1954ED3317","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":5930,"discussion_content":"包与包之间本来就是两个作用于呀，如果真的就在本包中，那怎么解释使用其他包的公开实体还要加上包名呢额。？","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1566540986,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":1,"child_discussions":[{"author":{"id":1239546,"avatar":"http://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTKWiaZb7a2JAcIVlXYuZ3iaPfSF6vBbg3yUps6LKpsZarftyXufMHYKJmMKzH3bIpVkDAVNXE9q0oOw/132","nickname":"Mr_scx","note":"","ucode":"28B5CE68A5A339","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":1041640,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/e4/e8/a1703783.jpg","nickname":"mrlay","note":"","ucode":"385A1954ED3317","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":378309,"discussion_content":"通过.XXX方式导入的包中的程序实体就不需要带上包名调用了","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1623157610,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":5930,"ip_address":""},"score":378309,"extra":""}]}]},{"had_liked":false,"id":21085,"user_name":"êｗěｎ","can_delete":false,"product_type":"c1","uid":1066707,"ip_address":"","ucode":"5000233111BEFA","user_header":"https://static001.geekbang.org/account/avatar/00/10/46/d3/e25d104a.jpg","comment_is_top":true,"comment_ctime":1534904495,"is_pvip":true,"replies":[{"id":"7403","content":"对，作用域不一样，会出现屏蔽现象。","user_name":"作者回复","user_name_real":"郝林","uid":"1026643","ctime":1534908913,"ip_address":"","comment_id":21085,"utype":1}],"discussion_count":5,"race_medal":0,"score":"9.2233722187783004e+18","product_id":100013101,"comment_content":"如果都是全局的变量，会报重复声明，如果只是在函数体重新声明，作用域不一样，应该不会报错吧","like_count":43,"discussions":[{"author":{"id":1026643,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/aa/53/768aec0a.jpg","nickname":"郝林","note":"","ucode":"F66BA62BA56FFA","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":422527,"discussion_content":"对，作用域不一样，会出现屏蔽现象。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1534908913,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1184397,"avatar":"http://thirdwx.qlogo.cn/mmopen/vi_32/mr9icibzvJmiatdx2FumKBY8ykmbUcUY4A8z8Ey4icqqtgUT6bZCGBo4ZFiaxrE5WmbtKia3xWYWrcrVtvdnmnWxrDjw/132","nickname":"王三白","note":"","ucode":"FE21B3D81384DE","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":194506,"discussion_content":"实际上不会报重复声明，main 中的名字(var, func 类型均可)直接遮蔽 dot import 引入的名字，用 go 1.13 测试的。","likes_number":5,"is_delete":false,"is_hidden":false,"ctime":1583226888,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1311299,"avatar":"https://static001.geekbang.org/account/avatar/00/14/02/43/1c2fb7b3.jpg","nickname":"Bourne","note":"","ucode":"1286279F70B13F","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":302305,"discussion_content":"是因为版本的原因还是你们没有亲自测试，我用1.14.3的module模式下试了试，全局变量并不会报错，而是会优先从当前代码包查找变量。","likes_number":2,"is_delete":false,"is_hidden":false,"ctime":1598875927,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1340746,"avatar":"https://static001.geekbang.org/account/avatar/00/14/75/4a/eb2f4f64.jpg","nickname":"Bruce Lee","note":"","ucode":"E51A47BB74DEA6","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":345679,"discussion_content":"go 1.13.12 也不报错 ","likes_number":1,"is_delete":false,"is_hidden":false,"ctime":1611759109,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1356077,"avatar":"https://static001.geekbang.org/account/avatar/00/14/b1/2d/661132f3.jpg","nickname":"佚名","note":"","ucode":"A4E35B21AC3C31","race_medal":0,"user_type":1,"is_pvip":true},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":318315,"discussion_content":"1.14.4测试，并没有报错","likes_number":1,"is_delete":false,"is_hidden":false,"ctime":1603703545,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":21069,"user_name":"atompi","can_delete":false,"product_type":"c1","uid":1212311,"ip_address":"","ucode":"D13F2DA4E41BA1","user_header":"https://static001.geekbang.org/account/avatar/00/12/7f/97/5acd3276.jpg","comment_is_top":true,"comment_ctime":1534901276,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"9.2233721715336991e+18","product_id":100013101,"comment_content":"从此地铁上那半小时变得格外充实👍","like_count":31},{"had_liked":false,"id":21090,"user_name":"衡子","can_delete":false,"product_type":"c1","uid":1109433,"ip_address":"","ucode":"0AED79FC9D14BB","user_header":"https://static001.geekbang.org/account/avatar/00/10/ed/b9/825b2411.jpg","comment_is_top":true,"comment_ctime":1534906243,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"9.2233721199940997e+18","product_id":100013101,"comment_content":"内容很不错👍 文字能再精简些就更好了！","like_count":19},{"had_liked":false,"id":21100,"user_name":"javaadu","can_delete":false,"product_type":"c1","uid":1000519,"ip_address":"","ucode":"8C0B140F1C8992","user_header":"https://static001.geekbang.org/account/avatar/00/0f/44/47/3ddb94d0.jpg","comment_is_top":true,"comment_ctime":1534913527,"is_pvip":true,"replies":[{"id":"7556","content":"很对。","user_name":"作者回复","user_name_real":"郝林","uid":"1026643","ctime":1535034366,"ip_address":"","comment_id":21100,"utype":1}],"discussion_count":1,"race_medal":0,"score":"9.2233720856342999e+18","product_id":100013101,"comment_content":"变量重复声明和变量重名不是一个事情，上篇讲的是前者，这一篇讲后者。变量重名按照作用域进行屏蔽，查找过程从小作用域查到大作用域","like_count":11,"discussions":[{"author":{"id":1026643,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/aa/53/768aec0a.jpg","nickname":"郝林","note":"","ucode":"F66BA62BA56FFA","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":422534,"discussion_content":"很对。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1535034366,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":21104,"user_name":"@hl","can_delete":false,"product_type":"c1","uid":1200784,"ip_address":"","ucode":"D21F6491254D3E","user_header":"https://static001.geekbang.org/account/avatar/00/12/52/90/95bfa4c8.jpg","comment_is_top":true,"comment_ctime":1534916944,"is_pvip":false,"replies":[{"id":"7555","content":"一个Go程序可以访问到的所有代码共同组成的代码块，也可以理解为Go标准库和所有工作区中的代码共同组成的代码块。","user_name":"作者回复","user_name_real":"郝林","uid":"1026643","ctime":1535034338,"ip_address":"","comment_id":21104,"utype":1}],"discussion_count":1,"race_medal":0,"score":"9.2233720770444001e+18","product_id":100013101,"comment_content":"什么是全域代码块","like_count":9,"discussions":[{"author":{"id":1026643,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/aa/53/768aec0a.jpg","nickname":"郝林","note":"","ucode":"F66BA62BA56FFA","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":422537,"discussion_content":"一个Go程序可以访问到的所有代码共同组成的代码块，也可以理解为Go标准库和所有工作区中的代码共同组成的代码块。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1535034338,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":21127,"user_name":"xiaolonghuster","can_delete":false,"product_type":"c1","uid":1205115,"ip_address":"","ucode":"6D91FC39D11252","user_header":"https://static001.geekbang.org/account/avatar/00/12/63/7b/0eb34db9.jpg","comment_is_top":true,"comment_ctime":1534931006,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"9.2233720598645002e+18","product_id":100013101,"comment_content":"对于和重名变量，不同类型时，可在使用之前通过查看变量类型来确定使用的是哪个地方定义的变量，reflect.TypeOf(container)","like_count":5},{"had_liked":false,"id":21060,"user_name":"云学","can_delete":false,"product_type":"c1","uid":1027233,"ip_address":"","ucode":"366AE90BA06356","user_header":"https://static001.geekbang.org/account/avatar/00/0f/ac/a1/43d83698.jpg","comment_is_top":true,"comment_ctime":1534900268,"is_pvip":false,"replies":[{"id":"7405","content":"可重名变量如果没用对地方就算","user_name":"作者回复","user_name_real":"郝林","uid":"1026643","ctime":1534908992,"ip_address":"","comment_id":21060,"utype":1}],"discussion_count":1,"race_medal":0,"score":"9.2233720512746004e+18","product_id":100013101,"comment_content":"这种变量命名算是code smell么？","like_count":3,"discussions":[{"author":{"id":1026643,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/aa/53/768aec0a.jpg","nickname":"郝林","note":"","ucode":"F66BA62BA56FFA","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":422516,"discussion_content":"可重名变量如果没用对地方就算","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1534908992,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":21159,"user_name":"lik0914","can_delete":false,"product_type":"c1","uid":1030212,"ip_address":"","ucode":"8F4A7BAAAF5DB4","user_header":"https://static001.geekbang.org/account/avatar/00/0f/b8/44/d919d889.jpg","comment_is_top":true,"comment_ctime":1534943606,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"9.2233720469797007e+18","product_id":100013101,"comment_content":"模块级私有，怎么全是模块级别呢","like_count":2},{"had_liked":false,"id":21040,"user_name":"小小笑儿","can_delete":false,"product_type":"c1","uid":1040354,"ip_address":"","ucode":"CA63CC50DC2091","user_header":"https://static001.geekbang.org/account/avatar/00/0f/df/e2/823a04b4.jpg","comment_is_top":true,"comment_ctime":1534897280,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"9.2233720383897006e+18","product_id":100013101,"comment_content":"报错，重定义","like_count":0},{"had_liked":false,"id":21024,"user_name":"卖轮子","can_delete":false,"product_type":"c1","uid":1001727,"ip_address":"","ucode":"7F96768F333DC8","user_header":"https://static001.geekbang.org/account/avatar/00/0f/48/ff/1967cdbb.jpg","comment_is_top":false,"comment_ctime":1534892054,"is_pvip":false,"replies":[{"id":"7406","content":"这个专栏是以音频为主的，文字版是备份和巩固。有的句子里概念较多，可以多读两遍试试。","user_name":"作者回复","user_name_real":"郝林","uid":"1026643","ctime":1534909060,"ip_address":"","comment_id":21024,"utype":1}],"discussion_count":3,"race_medal":0,"score":"138973845526","product_id":100013101,"comment_content":"文字多  看着比较费劲。  而且为啥咋感觉每句话都很长而且绕口呢？","like_count":32,"discussions":[{"author":{"id":1026643,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/aa/53/768aec0a.jpg","nickname":"郝林","note":"","ucode":"F66BA62BA56FFA","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":422500,"discussion_content":"这个专栏是以音频为主的，文字版是备份和巩固。有的句子里概念较多，可以多读两遍试试。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1534909060,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1676962,"avatar":"https://static001.geekbang.org/account/avatar/00/19/96/a2/c1596dd8.jpg","nickname":"🤔","note":"","ucode":"40ACB53BF3C6B1","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":571044,"discussion_content":"文字还有代码都看着觉得很绕，更别说只听音频","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1652061097,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1162920,"avatar":"https://static001.geekbang.org/account/avatar/00/11/be/a8/258cc90c.jpg","nickname":"李","note":"","ucode":"E3B06C9A0AEA8F","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":334560,"discussion_content":"我也觉得很绕。。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1607894335,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":21072,"user_name":"我来也","can_delete":false,"product_type":"c1","uid":1205253,"ip_address":"","ucode":"773D6104F56767","user_header":"https://static001.geekbang.org/account/avatar/00/12/64/05/6989dce6.jpg","comment_is_top":false,"comment_ctime":1534901463,"is_pvip":false,"replies":[{"id":"7404","content":"赞","user_name":"作者回复","user_name_real":"郝林","uid":"1026643","ctime":1534908937,"ip_address":"","comment_id":21072,"utype":1}],"discussion_count":1,"race_medal":0,"score":"113204051159","product_id":100013101,"comment_content":"当初在学校学c时，老师说重名变量时用了个很形象的比喻：强龙不压地头蛇。","like_count":26,"discussions":[{"author":{"id":1026643,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/aa/53/768aec0a.jpg","nickname":"郝林","note":"","ucode":"F66BA62BA56FFA","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":422520,"discussion_content":"赞","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1534908937,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":31143,"user_name":"🄽🄸🅇🅄🅂","can_delete":false,"product_type":"c1","uid":1000060,"ip_address":"","ucode":"853763C229A5AA","user_header":"https://static001.geekbang.org/account/avatar/00/0f/42/7c/8ef14715.jpg","comment_is_top":false,"comment_ctime":1539106630,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"44488779590","product_id":100013101,"comment_content":"最后的思考题，应该分情况对待！<br>1、如果子包中，声明的变量使用的是小写，如：var str = &quot;abc&quot; ，那么，在main包中同样声明 var str = &quot;aaa&quot; 是没有任何问题的，编译通过；<br>2、如果子包中声明变量是大写，如：var Str = &quot;abc&quot;，在main包中同样声明 var Str = &quot;aaa&quot;，IDE工具提示&#39;Str&#39; redeclared in this package。但是在执行 `go run main.go` 或 `go run *` 时，代码是没有任何错误的；<br>测试代码如下：<br><br>```<br>package main &#47;&#47; main包代码<br><br>import &quot;fmt&quot;<br>import . &quot;geektime&#47;go05&#47;t1&#47;p1&quot;<br><br>var Str = &quot;aaa&quot;<br><br>func main() {<br>\tfmt.Println(Str)<br><br>\tP()<br>}<br>```<br><br>```<br>package p1 &#47;&#47; 子包p1的代码<br><br>import &quot;fmt&quot;<br><br>var Str = &quot;abc&quot;<br><br>func P() {<br>\tfmt.Println(Str)<br>}<br>```<br>代码编译OK，执行结果为<br>```<br>aaa<br>abc<br>```","like_count":10},{"had_liked":false,"id":296783,"user_name":"Mr_scx","can_delete":false,"product_type":"c1","uid":1239546,"ip_address":"","ucode":"28B5CE68A5A339","user_header":"http://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTKWiaZb7a2JAcIVlXYuZ3iaPfSF6vBbg3yUps6LKpsZarftyXufMHYKJmMKzH3bIpVkDAVNXE9q0oOw/132","comment_is_top":false,"comment_ctime":1623158455,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"18803027639","product_id":100013101,"comment_content":"思考题解答：<br>分3种情况<br>1.  如果都是首字母大写的变量与当前代码中的全局变量重名，会报错 redeclared；<br>2. 如果是首字母小写的变量，其实包外并不可见，导入也没有感知到，所以不会和当前代码包中的变量名冲突，不报错。<br>3. 如果是与当前代码包中的函数代码块中的变量重名了，会被函数体中的变量“屏蔽”，不报错。","like_count":5},{"had_liked":false,"id":265273,"user_name":"guanooo","can_delete":false,"product_type":"c1","uid":2338873,"ip_address":"","ucode":"AB395CFA5D5D54","user_header":"https://static001.geekbang.org/account/avatar/00/23/b0/39/388114b0.jpg","comment_is_top":false,"comment_ctime":1606836302,"is_pvip":true,"replies":[{"id":"96435","content":"你哪里晕了？说说看？","user_name":"作者回复","user_name_real":"郝林","uid":"1026643","ctime":1606880708,"ip_address":"","comment_id":265273,"utype":1}],"discussion_count":3,"race_medal":0,"score":"18786705486","product_id":100013101,"comment_content":"明明很浅显的东西，非要给你绕晕","like_count":5,"discussions":[{"author":{"id":1026643,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/aa/53/768aec0a.jpg","nickname":"郝林","note":"","ucode":"F66BA62BA56FFA","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":510859,"discussion_content":"你哪里晕了？说说看？","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1606880708,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1461488,"avatar":"http://thirdwx.qlogo.cn/mmopen/vi_32/DYAIOgq83ep0Cb1HGLBTD57I53ZLsIBnvN3YkJOTkibWyibPoCUM5cbnhqDicm1aKWTUFeI7SEd8REnibfZVWeM3BQ/132","nickname":"Mr.zhou","note":"","ucode":"F7B2365D183788","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":581899,"discussion_content":"我感觉看完后反而不会了。那一定是我在开始就没有掌握好。","likes_number":1,"is_delete":false,"is_hidden":false,"ctime":1659063373,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":"陕西"},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1335457,"avatar":"https://static001.geekbang.org/account/avatar/00/14/60/a1/8f003697.jpg","nickname":"静心","note":"","ucode":"EB264FA6519FDA","race_medal":5,"user_type":1,"is_pvip":true},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":547557,"discussion_content":"说实话，有同感，主要是一些概念的上，如，重声明、重名，还有就是解释的方式上，感觉这类东西如果从运行堆栈的角度和编译原理的角度来解释会更清楚一些。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1642748205,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":100684,"user_name":"Sky","can_delete":false,"product_type":"c1","uid":1392585,"ip_address":"","ucode":"4C5A5AB73E8B90","user_header":"https://static001.geekbang.org/account/avatar/00/15/3f/c9/1ccefb9a.jpg","comment_is_top":false,"comment_ctime":1559615931,"is_pvip":false,"replies":[{"id":"36419","content":"好吧，貌似&quot;XXX&quot;更一致一些。谢谢。","user_name":"作者回复","user_name_real":"郝林","uid":"1026643","ctime":1559702526,"ip_address":"","comment_id":100684,"utype":1}],"discussion_count":1,"race_medal":0,"score":"18739485115","product_id":100013101,"comment_content":"import . XXX<br>应该是 import . &quot;XXX&quot;","like_count":4,"discussions":[{"author":{"id":1026643,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/aa/53/768aec0a.jpg","nickname":"郝林","note":"","ucode":"F66BA62BA56FFA","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":452636,"discussion_content":"好吧，貌似&amp;quot;XXX&amp;quot;更一致一些。谢谢。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1559702526,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":35428,"user_name":"happyhacker","can_delete":false,"product_type":"c1","uid":1033027,"ip_address":"","ucode":"8AFE882890F736","user_header":"https://static001.geekbang.org/account/avatar/00/0f/c3/43/4adc5704.jpg","comment_is_top":false,"comment_ctime":1540559090,"is_pvip":false,"replies":[{"id":"13310","content":"谢谢惠顾。写作技巧持续增进中。","user_name":"作者回复","user_name_real":"郝林","uid":"1026643","ctime":1541481935,"ip_address":"","comment_id":35428,"utype":1}],"discussion_count":1,"race_medal":0,"score":"18720428274","product_id":100013101,"comment_content":"我还以为只有我自己觉得文风很怪，尤其被朗读者读出来的时候听着更难受了。不过文章的细节很到位。刚买了本作者的Go并发编程实战","like_count":5,"discussions":[{"author":{"id":1026643,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/aa/53/768aec0a.jpg","nickname":"郝林","note":"","ucode":"F66BA62BA56FFA","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":427533,"discussion_content":"谢谢惠顾。写作技巧持续增进中。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1541481935,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":78304,"user_name":"浩","can_delete":false,"product_type":"c1","uid":1394346,"ip_address":"","ucode":"BD7FE280C83152","user_header":"http://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTKoGnC6068nQia1bOiaPxMRmkOQsaDsw5ib2drXic4gKOLzIFyZnnFm4uJ6KniboKG1nQD3J15y4d3QxLA/132","comment_is_top":false,"comment_ctime":1553128375,"is_pvip":false,"replies":[{"id":"28873","content":"函数在Go语言中是一等公民，所以它可以被赋给变量。赋值之后，这个变量就可以代表一个函数了，还可以被调用。","user_name":"作者回复","user_name_real":"郝林","uid":"1026643","ctime":1553398263,"ip_address":"","comment_id":78304,"utype":1}],"discussion_count":1,"race_medal":0,"score":"14438030263","product_id":100013101,"comment_content":"block := “function” {},这是什么格式，这是一个函数吗？这个写法很怪异，","like_count":4,"discussions":[{"author":{"id":1026643,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/aa/53/768aec0a.jpg","nickname":"郝林","note":"","ucode":"F66BA62BA56FFA","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":444040,"discussion_content":"函数在Go语言中是一等公民，所以它可以被赋给变量。赋值之后，这个变量就可以代表一个函数了，还可以被调用。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1553398263,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":21466,"user_name":"","can_delete":false,"product_type":"c1","uid":1146076,"ip_address":"","ucode":"974CAAC2D3FDCF","user_header":"https://static001.geekbang.org/account/avatar/00/11/7c/dc/0bad8e27.jpg","comment_is_top":false,"comment_ctime":1535100219,"is_pvip":false,"replies":[{"id":"7616","content":"当然，导入的终归是导入的。","user_name":"作者回复","user_name_real":"郝林","uid":"1026643","ctime":1535112133,"ip_address":"","comment_id":21466,"utype":1}],"discussion_count":1,"race_medal":0,"score":"14420002107","product_id":100013101,"comment_content":"import .的方式访问不了导入包内用小写字母的变量，这跟同一个作用域还是有区别吧？","like_count":3,"discussions":[{"author":{"id":1026643,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/aa/53/768aec0a.jpg","nickname":"郝林","note":"","ucode":"F66BA62BA56FFA","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":422690,"discussion_content":"当然，导入的终归是导入的。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1535112133,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":200356,"user_name":"芒果少侠","can_delete":false,"product_type":"c1","uid":1350159,"ip_address":"","ucode":"98D0BBB52BB80F","user_header":"https://static001.geekbang.org/account/avatar/00/14/9a/0f/da7ed75a.jpg","comment_is_top":false,"comment_ctime":1585576294,"is_pvip":true,"discussion_count":0,"race_medal":0,"score":"10175510886","product_id":100013101,"comment_content":"在go 1.13版本中测试（GoLand IDE），会报redeclared错误。但是程序却能正常运行，并输出本包中的结果。原因可能是评论区@王三白 同学提到的，1.13版本中main中的名字(var, func 类型均可)直接遮蔽 dot import 引入的名字。应该是go新版本对这种情况的一次健壮性处理。","like_count":2},{"had_liked":false,"id":85183,"user_name":"伟-Vae","can_delete":false,"product_type":"c1","uid":1203553,"ip_address":"","ucode":"E43395CF2822CB","user_header":"https://static001.geekbang.org/account/avatar/00/12/5d/61/94f63380.jpg","comment_is_top":false,"comment_ctime":1554996065,"is_pvip":false,"replies":[{"id":"30645","content":"因为它们操作的是同一个变量啊。你可以在case里用 := 给 result 赋值再看看。","user_name":"作者回复","user_name_real":"郝林","uid":"1026643","ctime":1555079417,"ip_address":"","comment_id":85183,"utype":1}],"discussion_count":2,"race_medal":0,"score":"10144930657","product_id":100013101,"comment_content":"你好老师，请看代码<br>var  result int<br>switch(op){<br>case 1:<br>        result = 1<br>break<br>case 2:<br>        result =2<br>break<br>......<br>}<br>fmt.println(result)<br><br>switch内属于一个代码块，里面对result赋值，怎么会改变外部result的值<br>","like_count":2,"discussions":[{"author":{"id":1026643,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/aa/53/768aec0a.jpg","nickname":"郝林","note":"","ucode":"F66BA62BA56FFA","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":446585,"discussion_content":"因为它们操作的是同一个变量啊。你可以在case里用 := 给 result 赋值再看看。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1555079417,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1526355,"avatar":"https://static001.geekbang.org/account/avatar/00/17/4a/53/063f9d17.jpg","nickname":"moonfox","note":"","ucode":"902BFF40EFA9FA","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":223669,"discussion_content":"你可以反着想呀，在switch里的变量如果是新的变量，那它还没有被声明呀，语法也不对呀","likes_number":2,"is_delete":false,"is_hidden":false,"ctime":1586245162,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":57446,"user_name":"言十年","can_delete":false,"product_type":"c1","uid":1110039,"ip_address":"","ucode":"67B8B49C3A3B17","user_header":"https://static001.geekbang.org/account/avatar/00/10/f0/17/796a3d20.jpg","comment_is_top":false,"comment_ctime":1546792562,"is_pvip":true,"replies":[{"id":"21582","content":"小新，你好。这确实是需要避免的。","user_name":"作者回复","user_name_real":"郝林","uid":"1026643","ctime":1547520390,"ip_address":"","comment_id":57446,"utype":1}],"discussion_count":1,"race_medal":0,"score":"10136727154","product_id":100013101,"comment_content":"我觉得用了变量就尽量用一个类型。用一个变量代表不同类型的，我觉得算是编码粗糙了。<br>隐晦的问题。不仅是可重声明变量。下面代码也会。<br><br>```<br>package main<br><br>var name = &quot;野原新之助&quot;<br>func main() {<br>\tvar name = 1<br>\tprint(name)<br>}<br>```<br><br> ","like_count":2,"discussions":[{"author":{"id":1026643,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/aa/53/768aec0a.jpg","nickname":"郝林","note":"","ucode":"F66BA62BA56FFA","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":435579,"discussion_content":"小新，你好。这确实是需要避免的。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1547520390,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":29913,"user_name":"Ye","can_delete":false,"product_type":"c1","uid":1250930,"ip_address":"","ucode":"73DD9C3844FA99","user_header":"https://static001.geekbang.org/account/avatar/00/13/16/72/2e922595.jpg","comment_is_top":false,"comment_ctime":1538603049,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"10128537641","product_id":100013101,"comment_content":"老师您好，针对jenningsloy318代码的问题我做了些修改。<br>先创建个test5文件夹，把main.go放进去，在test5文件夹里面建个package1文件夹作为放置&quot;package1&quot; 包的路径，并将func1.go放入package1文件夹里。<br>代码如下<br>main.go<br><br>package main<br>import &quot;test5&#47;package1&quot;<br>var amv = 123<br>func main(){<br>     amv := 456<br>     package1.Printa(amv)<br>}<br><br>--------------------<br>func1.go<br><br>package package1<br>import &quot;fmt&quot;<br>func Printa(input int){<br>    fmt.Println(input)<br>}<br><br>编译成功，输出结果456。这里思路main文件想通过条用package1包里面的Printa来打印main文件里面的amv变量，在调用Printa时候创建了新的作用域。但和main作用域分别属于不同的包，所以Printa不能共享main 里面的变量或者全域变量，所以必须给Printa手动添加amv作为输入值。另外，如果我删除func main 里面的 amv :=456，package1.Printa()找不到amv值，所以就会去找代码块外的amv，也就是 package main 里面全域变量的amv，然后输出结果就是123了，我的理解对吗？","like_count":2},{"had_liked":false,"id":22076,"user_name":"大神崛起","can_delete":false,"product_type":"c1","uid":1199116,"ip_address":"","ucode":"F1301B13DFF587","user_header":"https://static001.geekbang.org/account/avatar/00/12/4c/0c/efd088b9.jpg","comment_is_top":false,"comment_ctime":1535471260,"is_pvip":false,"replies":[{"id":"7956","content":"必然啊，test处于外层代码包里，文章里有讲。","user_name":"作者回复","user_name_real":"郝林","uid":"1026643","ctime":1535514756,"ip_address":"","comment_id":22076,"utype":1}],"discussion_count":2,"race_medal":0,"score":"10125405852","product_id":100013101,"comment_content":"package main<br><br>import &quot;fmt&quot;<br><br>var block = &quot;package&quot;<br><br>func main() {<br>    block := &quot;function&quot;<br>    {<br>        block := &quot;inner&quot;<br>        fmt.Printf(&quot;the block is %s.\\n&quot;, block)<br>    }<br>    fmt.Printf(&quot;the block is %s.\\n&quot;, block)<br>    test()<br>}<br>func test() {<br>    fmt.Printf(&quot;the block is %s.\\n&quot;, block)<br>}<br>最后test函数的输出值为什么是package","like_count":2,"discussions":[{"author":{"id":1026643,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/aa/53/768aec0a.jpg","nickname":"郝林","note":"","ucode":"F66BA62BA56FFA","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":422989,"discussion_content":"必然啊，test处于外层代码包里，文章里有讲。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1535514756,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1524242,"avatar":"https://static001.geekbang.org/account/avatar/00/17/42/12/928fa044.jpg","nickname":"杨阳","note":"","ucode":"88FA5140EEE153","race_medal":0,"user_type":1,"is_pvip":true},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":322902,"discussion_content":"go是静态作用域，在代码编译时期就确定了不是执行时期","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1604840561,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":22046,"user_name":"jenningsloy318","can_delete":false,"product_type":"c1","uid":1205840,"ip_address":"","ucode":"6DD5CE03B728C9","user_header":"","comment_is_top":false,"comment_ctime":1535461018,"is_pvip":false,"replies":[{"id":"7957","content":"你声明所属的代码包就不同，都改成package main就可以了","user_name":"作者回复","user_name_real":"郝林","uid":"1026643","ctime":1535514870,"ip_address":"","comment_id":22046,"utype":1}],"discussion_count":1,"race_medal":0,"score":"10125395610","product_id":100013101,"comment_content":"main.go<br><br>package main<br><br>import (<br>\t&quot;.&#47;packagea&quot;<br>)<br><br><br>var amv=123<br><br>func main() {<br><br>\tpackagea.printa()<br>}<br><br>------<br>packagea.go<br><br>package packagea<br>import (<br><br>\t&quot;fmt&quot;<br>)<br>func printa() {<br><br>\tfmt.Println(amv)<br>}<br>--------<br>编译是报错了，packagea不能直接调用amv变量<br><br>packagea&#47;packagea.go:8:14: undefined: amv","like_count":2,"discussions":[{"author":{"id":1026643,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/aa/53/768aec0a.jpg","nickname":"郝林","note":"","ucode":"F66BA62BA56FFA","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":422978,"discussion_content":"你声明所属的代码包就不同，都改成package main就可以了","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1535514870,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":291117,"user_name":"escray","can_delete":false,"product_type":"c1","uid":1020525,"ip_address":"","ucode":"1F4204930E47C4","user_header":"https://static001.geekbang.org/account/avatar/00/0f/92/6d/becd841a.jpg","comment_is_top":false,"comment_ctime":1620034931,"is_pvip":true,"discussion_count":0,"race_medal":2,"score":"5915002227","product_id":100013101,"comment_content":"这一篇其实是前文的后续，从重声明到可重名变量。<br><br>变量重声明是在某一个代码块内，对同一个变量的多次声明（赋值？），类型不变。<br><br>可重名变量可以各有各的类型。<br><br>思考题：如果通过 import . XXX 导入代码包中的变量，与当前代码包中的变量重名了，那么 Go 语言应该会报错。<br><br>导入之后，确实和变量名称的首字母是否大小写有一定的关系，如果在是大写，那么在 main 中会提示 already declared，但是可以运行；如果是小写，不会有提示。<br><br>将变量的地址打印出来，确实可以看得更清楚。<br><br>参考答案中“本地变量屏蔽被导入变量”说的很清楚了。","like_count":1},{"had_liked":false,"id":238407,"user_name":"美美","can_delete":false,"product_type":"c1","uid":1148422,"ip_address":"","ucode":"44CC95C45AF345","user_header":"https://static001.geekbang.org/account/avatar/00/11/86/06/72b01bb7.jpg","comment_is_top":false,"comment_ctime":1596160676,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"5891127972","product_id":100013101,"comment_content":"可重名变量是不同的变量，变量重声明是同一个变量。","like_count":1},{"had_liked":false,"id":40004,"user_name":"蛋蛋鸡","can_delete":false,"product_type":"c1","uid":1173194,"ip_address":"","ucode":"B93FB6CEE472AE","user_header":"https://static001.geekbang.org/account/avatar/00/11/e6/ca/04f35803.jpg","comment_is_top":false,"comment_ctime":1542435500,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"5837402796","product_id":100013101,"comment_content":"”可重命名变量“这个词听起来容易让人误解。初学者可能会认为这是变量的特性，但其实是作用域的问题，外围变量被隐藏了。当然，关于这个问题作者已经在文章中说得很清楚了，这里只是指出对于这个名词的顾虑。有C++经验的同学可能会比较有感触，用作用域操作符（::）可以把全局变量找出来。","like_count":1},{"had_liked":false,"id":352185,"user_name":"Geek_63c61d","can_delete":false,"product_type":"c1","uid":1583564,"ip_address":"","ucode":"6D9798ECBFE482","user_header":"https://static001.geekbang.org/account/avatar/00/18/29/cc/bec3ad33.jpg","comment_is_top":false,"comment_ctime":1658449298,"is_pvip":true,"discussion_count":0,"race_medal":0,"score":"1658449298","product_id":100013101,"comment_content":"典型的简单事情复杂化<br>","like_count":0},{"had_liked":false,"id":346684,"user_name":"EvanSung","can_delete":false,"product_type":"c1","uid":1542472,"ip_address":"","ucode":"0945F016568422","user_header":"https://static001.geekbang.org/account/avatar/00/17/89/48/7c849f0d.jpg","comment_is_top":false,"comment_ctime":1653360087,"is_pvip":true,"discussion_count":0,"race_medal":0,"score":"1653360087","product_id":100013101,"comment_content":"很简单的东西,讲的太绕了.老师文字功底有待提高.","like_count":0},{"had_liked":false,"id":327815,"user_name":"码狐","can_delete":false,"product_type":"c1","uid":1234879,"ip_address":"","ucode":"A4666D3AF30D6E","user_header":"https://static001.geekbang.org/account/avatar/00/12/d7/bf/9d8984b7.jpg","comment_is_top":false,"comment_ctime":1640314997,"is_pvip":false,"discussion_count":0,"race_medal":4,"score":"1640314997","product_id":100013101,"comment_content":"直接报错，代码块和作用域的角度理解是在同一作用于同时定义了两个同名实体","like_count":0},{"had_liked":false,"id":322079,"user_name":"jxs1211","can_delete":false,"product_type":"c1","uid":1101006,"ip_address":"","ucode":"B7F1F2D84389E7","user_header":"https://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTKELX1Rd1vmLRWibHib8P95NA87F4zcj8GrHKYQL2RcLDVnxNy1ia2geTWgW6L2pWn2kazrPNZMRVrIg/132","comment_is_top":false,"comment_ctime":1637159522,"is_pvip":false,"replies":[{"id":"116972","content":"好","user_name":"作者回复","user_name_real":"编辑","uid":"1026643","ctime":1637208111,"ip_address":"","comment_id":322079,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1637159522","product_id":100013101,"comment_content":"问题答案是会报错，因为到通过import . xxx导入代码包后，等同于讲xxx包中所有可以导入的程序实体到导入到了当前代码包中，由于import语句总在最前面，被导入的程序实体申明在前，而当前代码包中的名称如果一起重复了，就等同于在同一个代码块作用域中，再次申明了名称相同的程序实体，这在go语言中是不可以的<br>","like_count":0,"discussions":[{"author":{"id":1026643,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/aa/53/768aec0a.jpg","nickname":"郝林","note":"","ucode":"F66BA62BA56FFA","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":531031,"discussion_content":"好","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1637208111,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":314544,"user_name":"豆腐君","can_delete":false,"product_type":"c1","uid":2733337,"ip_address":"","ucode":"07734884AB47F5","user_header":"https://static001.geekbang.org/account/avatar/00/29/b5/19/94134ad1.jpg","comment_is_top":false,"comment_ctime":1633190316,"is_pvip":false,"replies":[{"id":"113953","content":"嗯，虽然你这个例子更复杂些，但是也很好：）<br><br>不过，我会尽量做到例子的简单性和专一性。这样一来，水平各异的人都会更容易理解一些。","user_name":"作者回复","user_name_real":"郝林","uid":"1026643","ctime":1633244237,"ip_address":"","comment_id":314544,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1633190316","product_id":100013101,"comment_content":"给老师提供更好的例子：<br><br>package main<br><br>import &quot;fmt&quot;<br><br>var message = &quot;in package&quot;<br><br>func special() {<br>\tfmt.Println(message)<br>}<br><br>func main() {<br>\tmessage := &quot;in main()&quot;<br>\t{<br>\t\tmessage := &quot;in block level 1&quot;<br>\t\t{<br>\t\t\tmessage := &quot;in block level 2&quot;<br>\t\t\tfmt.Println(message)<br>\t\t}<br>\t\tfmt.Println(message)<br>\t}<br>\tfmt.Println(message)<br><br>\tspecial()<br>}<br><br>可以注意到这个special函数 capture了它当时申明时候的环境，speical的打印值是&quot;in package&quot;","like_count":0,"discussions":[{"author":{"id":1026643,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/aa/53/768aec0a.jpg","nickname":"郝林","note":"","ucode":"F66BA62BA56FFA","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":527717,"discussion_content":"嗯，虽然你这个例子更复杂些，但是也很好：）\n\n不过，我会尽量做到例子的简单性和专一性。这样一来，水平各异的人都会更容易理解一些。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1633244237,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":307608,"user_name":"重新来过","can_delete":false,"product_type":"c1","uid":1254138,"ip_address":"","ucode":"27CC35140B63F3","user_header":"https://static001.geekbang.org/account/avatar/00/13/22/fa/671d2937.jpg","comment_is_top":false,"comment_ctime":1629172828,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1629172828","product_id":100013101,"comment_content":"package main<br><br>import . &quot;fmt&quot;<br><br>var Println = &quot;abc&quot;<br>var Print = &quot;bcd&quot;<br><br>func main() {<br>\tPrintf(&quot;%s&quot;, Println)<br>\tPrintf(&quot;%s&quot;, Print)<br>}<br>IDE有提示，编译执行不会报错，只是fmt中的函数名称作用域被覆盖了","like_count":0},{"had_liked":false,"id":289894,"user_name":"向南","can_delete":false,"product_type":"c1","uid":1325700,"ip_address":"","ucode":"E6072AD7CA6798","user_header":"https://static001.geekbang.org/account/avatar/00/14/3a/84/70340e87.jpg","comment_is_top":false,"comment_ctime":1619255900,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1619255900","product_id":100013101,"comment_content":"讲得很像零基础入门","like_count":0},{"had_liked":false,"id":282878,"user_name":"d","can_delete":false,"product_type":"c1","uid":1500139,"ip_address":"","ucode":"AB2F82CEC37EB5","user_header":"https://static001.geekbang.org/account/avatar/00/16/e3/eb/acd28d19.jpg","comment_is_top":false,"comment_ctime":1615450757,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1615450757","product_id":100013101,"comment_content":"我感觉语言组织不好，其实要表达的意思很简单，读起来时确被整懵逼了，得反复看","like_count":0},{"had_liked":false,"id":279504,"user_name":"刻刻","can_delete":false,"product_type":"c1","uid":1566635,"ip_address":"","ucode":"AD7FA37FA99EBC","user_header":"https://static001.geekbang.org/account/avatar/00/17/e7/ab/8383ca5b.jpg","comment_is_top":false,"comment_ctime":1613808627,"is_pvip":false,"replies":[{"id":"101642","content":"没问题。","user_name":"作者回复","user_name_real":"郝林","uid":"1026643","ctime":1613980682,"ip_address":"","comment_id":279504,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1613808627","product_id":100013101,"comment_content":"外层变量和本代码块的变量重名时，在本代码块引用的时候会直接用当前代码块的，把外层变量屏蔽了，这个理解没问题吧，<br>var container = []string{&quot;zero&quot;, &quot;one1&quot;, &quot;two&quot;}<br>func main() {<br>        container := map[int]string{0: &quot;zero&quot;, 1: &quot;one2&quot;, 2: &quot;two&quot;}<br>\tfmt.Printf(&quot;The element is %q.\\n&quot;, container[1])<br>}<br>这块打印的是one2 ","like_count":0,"discussions":[{"author":{"id":1026643,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/aa/53/768aec0a.jpg","nickname":"郝林","note":"","ucode":"F66BA62BA56FFA","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":515758,"discussion_content":"没问题。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1613980682,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":269972,"user_name":"Geek_8ae419","can_delete":false,"product_type":"c1","uid":2385598,"ip_address":"","ucode":"69576D84DEC942","user_header":"","comment_is_top":false,"comment_ctime":1608864929,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1608864929","product_id":100013101,"comment_content":"相同代码包中，变量重名编译不会通过。<br>不同代码包中，即使通过 import . &quot;xxx&quot; 引入，变量重名没问题。","like_count":0},{"had_liked":false,"id":168292,"user_name":"Lywane","can_delete":false,"product_type":"c1","uid":1446512,"ip_address":"","ucode":"2B0027AA069CE9","user_header":"https://static001.geekbang.org/account/avatar/00/16/12/70/10faf04b.jpg","comment_is_top":false,"comment_ctime":1578042980,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1578042980","product_id":100013101,"comment_content":"学习了，以前以为前面没有函数名或者关键字的{}只是为了规范代码，不想还会影响变量作用域","like_count":0},{"had_liked":false,"id":163644,"user_name":"lixiaofeng","can_delete":false,"product_type":"c1","uid":1100200,"ip_address":"","ucode":"0D6710D95B6FFB","user_header":"https://static001.geekbang.org/account/avatar/00/10/c9/a8/98507423.jpg","comment_is_top":false,"comment_ctime":1576759514,"is_pvip":false,"replies":[{"id":"62318","content":"这得看你的编译器或者IDE是怎么设置的。","user_name":"作者回复","user_name_real":"郝林","uid":"1026643","ctime":1576822370,"ip_address":"","comment_id":163644,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1576759514","product_id":100013101,"comment_content":"func main(){<br>\ttestv := &quot;1&quot;<br>\tprintln(testv)<br>\tflag.Usage = func(){<br>                &#47;&#47; 为什么在这个函数内下断点， 不起作用？<br>\t\ttestv := &quot;2&quot;<br>\t\tprintln(testv)<br>\t\tfmt.Fprintf(os.Stderr, &quot;usage of %s\\n&quot;, &quot; Link  to your MySQL!&quot;)<br>\t}<br>\tflag.Parse()<br>\t<br>\tif true{<br>\t\ttestv := &quot;1.5&quot;<br>\t\tprintln(testv)<br>\t}<br><br>\tprintln(testv)<br>\tfmt.Printf(&quot;hostname: %s\\nusernmae: %s\\npassword:  %s\\nport:  %s\\n&quot;, hostname, username, pwd, port)<br><br>\tc := compute.Add(1,2)<br>\tprintln(c)<br>}","like_count":0,"discussions":[{"author":{"id":1026643,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/aa/53/768aec0a.jpg","nickname":"郝林","note":"","ucode":"F66BA62BA56FFA","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":478486,"discussion_content":"这得看你的编译器或者IDE是怎么设置的。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1576822370,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":163389,"user_name":"Bojack","can_delete":false,"product_type":"c1","uid":1251080,"ip_address":"","ucode":"A57E552845DB28","user_header":"http://thirdwx.qlogo.cn/mmopen/vi_32/DYAIOgq83eoLw2qjwoaVCDq8BqCcXOibyTG3rxiaJlDy2lt62IkiaDrrHeVwq4Pe8RpBbYJTIiadyicZ7InBCLCjJtQ/132","comment_is_top":false,"comment_ctime":1576716347,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1576716347","product_id":100013101,"comment_content":"作用域和作用域链。讲的好复杂啊","like_count":0},{"had_liked":false,"id":124630,"user_name":"nora","can_delete":false,"product_type":"c1","uid":1206539,"ip_address":"","ucode":"3A3EABF27D0261","user_header":"https://static001.geekbang.org/account/avatar/00/12/69/0b/780b0aac.jpg","comment_is_top":false,"comment_ctime":1565931622,"is_pvip":false,"replies":[{"id":"45820","content":"对的","user_name":"作者回复","user_name_real":"郝林","uid":"1026643","ctime":1566010179,"ip_address":"","comment_id":124630,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1565931622","product_id":100013101,"comment_content":"其实就是可重命名变量实际上是两个变量，所以无论是类型还是其他什么都没有限制，重声明就只是单纯的语法糖，所以只有符合特定条件才可以使用。","like_count":0,"discussions":[{"author":{"id":1026643,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/aa/53/768aec0a.jpg","nickname":"郝林","note":"","ucode":"F66BA62BA56FFA","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":463255,"discussion_content":"对的","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1566010179,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":116514,"user_name":"姜子牙","can_delete":false,"product_type":"c1","uid":1253063,"ip_address":"","ucode":"1830E2FA33308B","user_header":"https://thirdwx.qlogo.cn/mmopen/vi_32/rUPjvMdUGic56wNdVm0be85REaB7nLwyEC7HiamhmeWsQichtADA3IsFubIqOXMjlsEtmicdpDRC2YhNWVrpPKj1lw/132","comment_is_top":false,"comment_ctime":1563861893,"is_pvip":false,"replies":[{"id":"42640","content":"检查一下你 go 的安装吧。","user_name":"作者回复","user_name_real":"郝林","uid":"1026643","ctime":1563889900,"ip_address":"","comment_id":116514,"utype":1}],"discussion_count":2,"race_medal":0,"score":"1563861893","product_id":100013101,"comment_content":"为啥我运行这段代码，不管是go run 还是go build 都报Segmentation fault: 11<br>。我用的goland .百度太烂了。搜不到什么答案","like_count":0,"discussions":[{"author":{"id":1026643,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/aa/53/768aec0a.jpg","nickname":"郝林","note":"","ucode":"F66BA62BA56FFA","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":459570,"discussion_content":"检查一下你 go 的安装吧。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1563889900,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1442431,"avatar":"https://static001.geekbang.org/account/avatar/00/16/02/7f/ddf56ac5.jpg","nickname":"runzhliu","note":"","ucode":"CD51D9465D7A05","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":5088,"discussion_content":"谷歌用不了用Bing吧 ;)","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1565936661,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":114665,"user_name":"党","can_delete":false,"product_type":"c1","uid":1071974,"ip_address":"","ucode":"EE531DB3EA124D","user_header":"https://static001.geekbang.org/account/avatar/00/10/5b/66/ad35bc68.jpg","comment_is_top":false,"comment_ctime":1563359461,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1563359461","product_id":100013101,"comment_content":"会报错，作用域相同，不允许重复定义。<br>另外只对首字母大写有效，程序实体还是遵循首字母大写的才能被外部访问的原则","like_count":0},{"had_liked":false,"id":103203,"user_name":"小康","can_delete":false,"product_type":"c1","uid":1226039,"ip_address":"","ucode":"68401E06CA9563","user_header":"https://static001.geekbang.org/account/avatar/00/12/b5/37/eece23bc.jpg","comment_is_top":false,"comment_ctime":1560396429,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1560396429","product_id":100013101,"comment_content":"思考题：<br>会当做可重命名变量，不会报错，程序正常运行。","like_count":0},{"had_liked":false,"id":93502,"user_name":"amesy","can_delete":false,"product_type":"c1","uid":1005366,"ip_address":"","ucode":"A634405CFCDDD1","user_header":"https://static001.geekbang.org/account/avatar/00/0f/57/36/cb42cae8.jpg","comment_is_top":false,"comment_ctime":1557482633,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1557482633","product_id":100013101,"comment_content":"作用域与程序的先后顺序有关系。<br><br>``` <br>package main<br><br>import (<br>\t&quot;fmt&quot;<br>\t. &quot;myProject&#47;testDemo&#47;demo1&quot;<br>)<br><br>func info() {<br>\tfmt.Println(&quot;before result is: &quot;, Name)<br>\tvar Name string<br>\tfmt.Println(&quot;After reslut is: &quot;, Name)<br>}<br><br>func main() {<br>\tinfo()<br>}<br>```","like_count":0},{"had_liked":false,"id":74334,"user_name":"ican_只会0到9","can_delete":false,"product_type":"c1","uid":1029473,"ip_address":"","ucode":"9EE33C42EE519D","user_header":"https://static001.geekbang.org/account/avatar/00/0f/b5/61/9802a552.jpg","comment_is_top":false,"comment_ctime":1552192466,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1552192466","product_id":100013101,"comment_content":"1.会当做可重名变量看待，因为处于不同代码块声明，且有可能类型不一致；<br>2.被导入的变量会被当前代码包中的可重名变量屏蔽；<br>3.当被导入的变量与当前代码包的全局变量重名，程序不会报错，会被当前代码包的重名变量屏蔽；当被导入的变量与当前代码包的非全局变量重名，程序会报错：导入未使用包","like_count":0},{"had_liked":false,"id":69071,"user_name":"超级费事儿","can_delete":false,"product_type":"c1","uid":1434114,"ip_address":"","ucode":"FD873FF4ADAA5F","user_header":"https://static001.geekbang.org/account/avatar/00/15/e2/02/488aec70.jpg","comment_is_top":false,"comment_ctime":1550655777,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1550655777","product_id":100013101,"comment_content":"您好！请问，ubuntu系统，我用golang1.9.2，go  build 命令编译出来的可执行文件，用   file 可执行文件名   命令查看，显示这个可执行文件是dynamiclly  linked，有什么参数可以让我编出来可执行文件是静态的没有这个动态链接吗？","like_count":0},{"had_liked":false,"id":65353,"user_name":"🐻","can_delete":false,"product_type":"c1","uid":1043072,"ip_address":"","ucode":"534EDAD496A0E6","user_header":"https://static001.geekbang.org/account/avatar/00/0f/ea/80/8759e4c1.jpg","comment_is_top":false,"comment_ctime":1549270558,"is_pvip":false,"replies":[{"id":"25251","content":"只导入不使用是会报错的。","user_name":"作者回复","user_name_real":"郝林","uid":"1026643","ctime":1551181522,"ip_address":"","comment_id":65353,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1549270558","product_id":100013101,"comment_content":"https:&#47;&#47;gist.github.com&#47;bwangelme&#47;708fd84b29d47a7a8644832ce621d53d#%E9%9A%90%E5%BC%8F%E5%AF%BC%E5%85%A5%E7%9A%84%E9%94%99%E8%AF%AF<br><br>我的 go 版本是1.11.1，遇到的错误是导入的模块未使用。","like_count":0,"discussions":[{"author":{"id":1026643,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/aa/53/768aec0a.jpg","nickname":"郝林","note":"","ucode":"F66BA62BA56FFA","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":438419,"discussion_content":"只导入不使用是会报错的。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1551181522,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":61431,"user_name":"一梦三四年","can_delete":false,"product_type":"c1","uid":1309156,"ip_address":"","ucode":"BFFB84088E5E3C","user_header":"https://static001.geekbang.org/account/avatar/00/13/f9/e4/1bdea4b6.jpg","comment_is_top":false,"comment_ctime":1547695970,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1547695970","product_id":100013101,"comment_content":"编译错误，感觉 import . &quot;包名&quot; 更像是 将包文件 直接拷贝到当前引入文件，导致变量。函数等在同一个块级","like_count":0},{"had_liked":false,"id":45872,"user_name":"虢國技醬","can_delete":false,"product_type":"c1","uid":1056807,"ip_address":"","ucode":"5A192262AA037E","user_header":"https://static001.geekbang.org/account/avatar/00/10/20/27/a6932fbe.jpg","comment_is_top":false,"comment_ctime":1543808261,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1543808261","product_id":100013101,"comment_content":"变量的重新声明：并不是重新声明了新的变量，只是在短声明另一个变量的时候，同时存在了之前已经声明过的变量，此时会对这个已存在的进行重新赋值<br>可重名变量：有时候，子代码块声明的变量和父级中的变量同名，此时这两个变量只是标识名相同，但是注意作用域不同，这是两个不同的变量<br><br>以上这些认识可用通过取变量的地址来验证：<br><br>package main<br><br>import &quot;fmt&quot;<br><br>var block string = &quot;package&quot;<br><br>func main() {<br>\tfmt.Println(block, &amp;block)<br>\tblock := &quot;function&quot;<br>\tfmt.Println(block, &amp;block)<br>\tblock, abc := &quot;function-2&quot;, &quot;abc&quot;<br>\tfmt.Println(block, &amp;block, abc, &amp;abc)<br><br>\t{<br>\t\tblock = &quot;function-2&quot;<br>\t\tfmt.Println(block, &amp;block)<br>\t\tblock := true<br>\t\tfmt.Println(block, &amp;block)<br>\t\tblock = false<br>\t\tfmt.Println(block, &amp;block)<br>\t}<br><br>\tfmt.Println(block, &amp;block)<br>}<br>","like_count":0},{"had_liked":false,"id":39828,"user_name":"700","can_delete":false,"product_type":"c1","uid":1072896,"ip_address":"","ucode":"E4BD0CBADAF951","user_header":"","comment_is_top":false,"comment_ctime":1542362309,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1542362309","product_id":100013101,"comment_content":"郝老师好。<br>个人觉得 jenningsloy318 的问题所在并不是将 package.go 修改成 package main。<br><br>他的代码存在两个问题：<br>1、公有函数首字母应大写 Printa，而非 printa。<br>2、packagea.go 的 Printa 函数应该进行传参来输出 main.go 中的全局变量 amv，而非直接指定 amv。<br><br>所以，按「Ye」同学的思路才应该是能正常输出结果的。<br><br>以上拙见请指点。","like_count":0},{"had_liked":false,"id":25738,"user_name":"小杰控","can_delete":false,"product_type":"c1","uid":1152822,"ip_address":"","ucode":"0E5AA624F5CD52","user_header":"https://static001.geekbang.org/account/avatar/00/11/97/36/ee863508.jpg","comment_is_top":false,"comment_ctime":1537429482,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1537429482","product_id":100013101,"comment_content":"声明在模块作用域中，则会报“redeclared”，如果不在同一作用域则不会报错。<br><br>package main<br><br>import &quot;fmt&quot;<br>import . &quot;go_json&#47;practice&#47;module1&quot;<br><br>var TestVar = &quot;test variable&quot;<br><br>func main() {<br>        &#47;&#47; var TestVar = &quot;test variable&quot;<br>        fmt.Printf(&quot;The testVar2 is: %s.\\n&quot;, TestVar2)<br>        fmt.Printf(&quot;The testVar is: %s.\\n&quot;, TestVar)<br>}","like_count":0},{"had_liked":false,"id":24033,"user_name":"先听","can_delete":false,"product_type":"c1","uid":1151409,"ip_address":"","ucode":"82D8DA7A2FEB4B","user_header":"https://static001.geekbang.org/account/avatar/00/11/91/b1/fb117c21.jpg","comment_is_top":false,"comment_ctime":1536764182,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1536764182","product_id":100013101,"comment_content":"越来越过瘾了","like_count":0},{"had_liked":false,"id":23254,"user_name":"Xiang","can_delete":false,"product_type":"c1","uid":1145585,"ip_address":"","ucode":"8D56F3E0DE77FF","user_header":"https://static001.geekbang.org/account/avatar/00/11/7a/f1/2a866fab.jpg","comment_is_top":false,"comment_ctime":1536234879,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1536234879","product_id":100013101,"comment_content":"go语言的变量是代码块作用域","like_count":0},{"had_liked":false,"id":22072,"user_name":"大神崛起","can_delete":false,"product_type":"c1","uid":1199116,"ip_address":"","ucode":"F1301B13DFF587","user_header":"https://static001.geekbang.org/account/avatar/00/12/4c/0c/efd088b9.jpg","comment_is_top":false,"comment_ctime":1535470057,"is_pvip":false,"replies":[{"id":"7955","content":"去掉一个*","user_name":"作者回复","user_name_real":"郝林","uid":"1026643","ctime":1535514707,"ip_address":"","comment_id":22072,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1535470057","product_id":100013101,"comment_content":"package main<br><br>import (<br>    &quot;flag&quot;<br>    &quot;fmt&quot;<br>)<br><br>func main() {<br>    var name = *flag.String(&quot;name&quot;, &quot;everyone&quot;, &quot;The greeting object.&quot;)<br>    flag.Parse()<br>    fmt.Printf(&quot;Hello, %v!\\n&quot;, *name)<br>}<br>老师这个最后一行的输出为什么会报错啊","like_count":0,"discussions":[{"author":{"id":1026643,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/aa/53/768aec0a.jpg","nickname":"郝林","note":"","ucode":"F66BA62BA56FFA","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":422987,"discussion_content":"去掉一个*","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1535514707,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":21541,"user_name":"jenningsloy318","can_delete":false,"product_type":"c1","uid":1205840,"ip_address":"","ucode":"6DD5CE03B728C9","user_header":"","comment_is_top":false,"comment_ctime":1535160972,"is_pvip":false,"replies":[{"id":"7737","content":"第一个问题，这样的变量就别定义在main包里了。第二个问题，所谓的全局变量就是某个包中不在其他程序实体里边的公开变量，","user_name":"作者回复","user_name_real":"郝林","uid":"1026643","ctime":1535293873,"ip_address":"","comment_id":21541,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1535160972","product_id":100013101,"comment_content":"有个问题，如果想在main包定义一个变量能够被子包访问，应该怎么做？现在变量都是以包的方式，怎么去定义这样一个变量？全局变量又是怎么定义的","like_count":0,"discussions":[{"author":{"id":1026643,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/aa/53/768aec0a.jpg","nickname":"郝林","note":"","ucode":"F66BA62BA56FFA","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":422729,"discussion_content":"第一个问题，这样的变量就别定义在main包里了。第二个问题，所谓的全局变量就是某个包中不在其他程序实体里边的公开变量，","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1535293873,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":21426,"user_name":"jacke","can_delete":false,"product_type":"c1","uid":1161209,"ip_address":"","ucode":"05F355E1FF88C5","user_header":"https://static001.geekbang.org/account/avatar/00/11/b7/f9/a8f26b10.jpg","comment_is_top":false,"comment_ctime":1535076263,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1535076263","product_id":100013101,"comment_content":"这个变量屏蔽编译的时候是有个 go vet shade 是吧？","like_count":0},{"had_liked":false,"id":21310,"user_name":"Bang","can_delete":false,"product_type":"c1","uid":1160079,"ip_address":"","ucode":"0CB8A52B177868","user_header":"https://static001.geekbang.org/account/avatar/00/11/b3/8f/4caf7f03.jpg","comment_is_top":false,"comment_ctime":1535018400,"is_pvip":false,"replies":[{"id":"7558","content":"由于第二版的纸质版卖得很好，所以出版社不着急出电子书，因为电子版一出来盗版就很容易了。","user_name":"作者回复","user_name_real":"郝林","uid":"1026643","ctime":1535034479,"ip_address":"","comment_id":21310,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1535018400","product_id":100013101,"comment_content":"您的 《go语言并发编程实战第二版》啥时候能出电子版？纸制版已买 电子版方便啊😂","like_count":0,"discussions":[{"author":{"id":1026643,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/aa/53/768aec0a.jpg","nickname":"郝林","note":"","ucode":"F66BA62BA56FFA","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":422629,"discussion_content":"由于第二版的纸质版卖得很好，所以出版社不着急出电子书，因为电子版一出来盗版就很容易了。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1535034479,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":21189,"user_name":"@XP","can_delete":false,"product_type":"c1","uid":1136671,"ip_address":"","ucode":"D8D93A044F989C","user_header":"https://static001.geekbang.org/account/avatar/00/11/58/1f/9dc4d475.jpg","comment_is_top":false,"comment_ctime":1534976354,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1534976354","product_id":100013101,"comment_content":"报错提示 redeclared","like_count":0},{"had_liked":false,"id":21103,"user_name":"@hl","can_delete":false,"product_type":"c1","uid":1200784,"ip_address":"","ucode":"D21F6491254D3E","user_header":"https://static001.geekbang.org/account/avatar/00/12/52/90/95bfa4c8.jpg","comment_is_top":false,"comment_ctime":1534916943,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1534916943","product_id":100013101,"comment_content":"什么是全域代码块","like_count":0},{"had_liked":false,"id":21078,"user_name":"来碗绿豆汤","can_delete":false,"product_type":"c1","uid":1070051,"ip_address":"","ucode":"B0AB63B8D9729F","user_header":"https://static001.geekbang.org/account/avatar/00/10/53/e3/39dcfb11.jpg","comment_is_top":false,"comment_ctime":1534903176,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1534903176","product_id":100013101,"comment_content":"会报redeclared错误。因为通过fmt . “XXX”引入的包中公开的程序实体被当前源码文件中的代码。如果我们再有一个同名代码，那就相当于同一个函数名在一个代码块出现了两次。","like_count":0}]}