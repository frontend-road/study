{"id":73971,"title":"05丨Python科学计算：Pandas","content":"<p>上一章中，我们讲了Python的一个重要的第三方库NumPy，今天我来给你介绍Python的另一个工具Pandas。</p><p>在数据分析工作中，Pandas的使用频率是很高的，一方面是因为Pandas提供的基础数据结构DataFrame与json的契合度很高，转换起来就很方便。另一方面，如果我们日常的数据清理工作不是很复杂的话，你通常用几句Pandas代码就可以对数据进行规整。</p><p>Pandas可以说是基于 NumPy 构建的含有更高级数据结构和分析能力的工具包。在NumPy中数据结构是围绕ndarray展开的，那么在Pandas中的核心数据结构是什么呢？</p><p>下面主要给你讲下<strong>Series和 DataFrame这两个核心数据结构</strong>，他们分别代表着一维的序列和二维的表结构。基于这两种数据结构，Pandas可以对数据进行导入、清洗、处理、统计和输出。</p><h2>数据结构：Series和DataFrame</h2><p><strong>Series是个定长的字典序列</strong>。说是定长是因为在存储的时候，相当于两个ndarray，这也是和字典结构最大的不同。因为在字典的结构里，元素的个数是不固定的。</p><p><strong>Series</strong>有两个基本属性：index 和 values。在Series结构中，index默认是0,1,2,……递增的整数序列，当然我们也可以自己来指定索引，比如index=[‘a’, ‘b’, ‘c’, ‘d’]。</p><!-- [[[read_end]]] --><pre><code>import pandas as pd\nfrom pandas import Series, DataFrame\nx1 = Series([1,2,3,4])\nx2 = Series(data=[1,2,3,4], index=['a', 'b', 'c', 'd'])\nprint x1\nprint x2\n</code></pre><p>运行结果：</p><pre><code>0    1\n1    2\n2    3\n3    4\ndtype: int64\na    1\nb    2\nc    3\nd    4\ndtype: int64\n</code></pre><p>这个例子中，x1中的index采用的是默认值，x2中index进行了指定。我们也可以采用字典的方式来创建Series，比如：</p><pre><code>d = {'a':1, 'b':2, 'c':3, 'd':4}\nx3 = Series(d)\nprint x3 \n</code></pre><p>运行结果：</p><pre><code>a    1\nb    2\nc    3\nd    4\ndtype: int64\n</code></pre><p><strong>DataFrame类型数据结构类似数据库表。</strong></p><p>它包括了行索引和列索引，我们可以将DataFrame 看成是由相同索引的Series组成的字典类型。</p><p>我们虚构一个王者荣耀考试的场景，想要输出几位英雄的考试成绩：</p><pre><code>import pandas as pd\nfrom pandas import Series, DataFrame\ndata = {'Chinese': [66, 95, 93, 90,80],'English': [65, 85, 92, 88, 90],'Math': [30, 98, 96, 77, 90]}\ndf1= DataFrame(data)\ndf2 = DataFrame(data, index=['ZhangFei', 'GuanYu', 'ZhaoYun', 'HuangZhong', 'DianWei'], columns=['English', 'Math', 'Chinese'])\nprint df1\nprint df2\n</code></pre><p>在后面的案例中，我一般会用df, df1, df2这些作为DataFrame数据类型的变量名，我们以例子中的df2为例，列索引是[‘English’, ‘Math’, ‘Chinese’]，行索引是[‘ZhangFei’, ‘GuanYu’, ‘ZhaoYun’, ‘HuangZhong’, ‘DianWei’]，所以df2的输出是：</p><pre><code>            English  Math  Chinese\nZhangFei         65    30       66\nGuanYu           85    98       95\nZhaoYun          92    96       93\nHuangZhong       88    77       90\nDianWei          90    90       80\n</code></pre><p>在了解了Series和 DataFrame这两个数据结构后，我们就从数据处理的流程角度，来看下他们的使用方法。</p><h2>数据导入和输出</h2><p>Pandas允许直接从xlsx，csv等文件中导入数据，也可以输出到xlsx, csv等文件，非常方便。</p><pre><code>import pandas as pd\nfrom pandas import Series, DataFrame\nscore = DataFrame(pd.read_excel('data.xlsx'))\nscore.to_excel('data1.xlsx')\nprint score\n</code></pre><p>需要说明的是，在运行的过程可能会存在缺少xlrd和openpyxl包的情况，到时候如果缺少了，可以在命令行模式下使用“pip install”命令来进行安装。</p><h2>数据清洗</h2><p>数据清洗是数据准备过程中必不可少的环节，Pandas也为我们提供了数据清洗的工具，在后面数据清洗的章节中会给你做详细的介绍，这里简单介绍下Pandas在数据清洗中的使用方法。</p><p>我还是以上面这个王者荣耀的数据为例。</p><pre><code>data = {'Chinese': [66, 95, 93, 90,80],'English': [65, 85, 92, 88, 90],'Math': [30, 98, 96, 77, 90]}\ndf2 = DataFrame(data, index=['ZhangFei', 'GuanYu', 'ZhaoYun', 'HuangZhong', 'DianWei'], columns=['English', 'Math', 'Chinese'])\n</code></pre><p><strong>在数据清洗过程中，一般都会遇到以下这几种情况，下面我来简单介绍一下。</strong></p><p><strong>1. 删除 DataFrame 中的不必要的列或行</strong></p><p>Pandas提供了一个便捷的方法 drop() 函数来删除我们不想要的列或行。比如我们想把“语文”这列删掉。</p><pre><code>df2 = df2.drop(columns=['Chinese'])\n</code></pre><p>想把“张飞”这行删掉。</p><pre><code>df2 = df2.drop(index=['ZhangFei'])\n</code></pre><p><strong>2. 重命名列名columns，让列表名更容易识别</strong></p><p>如果你想对DataFrame中的columns进行重命名，可以直接使用rename(columns=new_names, inplace=True) 函数，比如我把列名Chinese改成YuWen，English改成YingYu。</p><pre><code>df2.rename(columns={'Chinese': 'YuWen', 'English': 'Yingyu'}, inplace = True)\n</code></pre><p><strong>3. 去重复的值</strong></p><p>数据采集可能存在重复的行，这时只要使用drop_duplicates()就会自动把重复的行去掉。</p><pre><code>df = df.drop_duplicates() #去除重复行\n</code></pre><p><strong>4. 格式问题</strong></p><p><strong>更改数据格式</strong></p><p>这是个比较常用的操作，因为很多时候数据格式不规范，我们可以使用astype函数来规范数据格式，比如我们把Chinese字段的值改成str类型，或者int64可以这么写：</p><pre><code>df2['Chinese'].astype('str') \ndf2['Chinese'].astype(np.int64) \n</code></pre><p><strong>数据间的空格</strong></p><p>有时候我们先把格式转成了str类型，是为了方便对数据进行操作，这时想要删除数据间的空格，我们就可以使用strip函数：</p><pre><code>#删除左右两边空格\ndf2['Chinese']=df2['Chinese'].map(str.strip)\n#删除左边空格\ndf2['Chinese']=df2['Chinese'].map(str.lstrip)\n#删除右边空格\ndf2['Chinese']=df2['Chinese'].map(str.rstrip)\n</code></pre><p>如果数据里有某个特殊的符号，我们想要删除怎么办？同样可以使用strip函数，比如Chinese字段里有美元符号，我们想把这个删掉，可以这么写：</p><pre><code>df2['Chinese']=df2['Chinese'].str.strip('$')\n</code></pre><p><strong>大小写转换</strong></p><p>大小写是个比较常见的操作，比如人名、城市名等的统一都可能用到大小写的转换，在Python里直接使用upper(), lower(), title()函数，方法如下：</p><pre><code>#全部大写\ndf2.columns = df2.columns.str.upper()\n#全部小写\ndf2.columns = df2.columns.str.lower()\n#首字母大写\ndf2.columns = df2.columns.str.title()\n</code></pre><p><strong>查找空值</strong></p><p>数据量大的情况下，有些字段存在空值NaN的可能，这时就需要使用Pandas中的isnull函数进行查找。比如，我们输入一个数据表如下：</p><p><img src=\"https://static001.geekbang.org/resource/image/34/ab/3440abb73e91e9f7a41dc2fbfeea44ab.png?wh=423*202\" alt=\"\"><br>\n如果我们想看下哪个地方存在空值NaN，可以针对数据表df进行df.isnull()，结果如下：</p><p><img src=\"https://static001.geekbang.org/resource/image/5b/fe/5b52bca4eb6f00d51f72dcc5c6ce2afe.png?wh=391*161\" alt=\"\"></p><p>如果我想知道哪列存在空值，可以使用df.isnull().any()，结果如下：</p><p><img src=\"https://static001.geekbang.org/resource/image/89/03/89cb71afc4f54a11ce1d4d05cd46bb03.png?wh=179*116\" alt=\"\"></p><h2>使用apply函数对数据进行清洗</h2><p>apply函数是Pandas中<strong>自由度非常高的函数</strong>，使用频率也非常高。</p><p>比如我们想对name列的数值都进行大写转化可以用：</p><pre><code>df['name'] = df['name'].apply(str.upper)\n</code></pre><p>我们也可以定义个函数，在apply中进行使用。比如定义double_df函数是将原来的数值*2进行返回。然后对df1中的“语文”列的数值进行*2处理，可以写成：</p><pre><code>def double_df(x):\n           return 2*x\ndf1[u'语文'] = df1[u'语文'].apply(double_df)\n</code></pre><p>我们也可以定义更复杂的函数，比如对于DataFrame，我们新增两列，其中’new1’列是“语文”和“英语”成绩之和的m倍，'new2’列是“语文”和“英语”成绩之和的n倍，我们可以这样写：</p><pre><code>def plus(df,n,m):\n    df['new1'] = (df[u'语文']+df[u'英语']) * m\n    df['new2'] = (df[u'语文']+df[u'英语']) * n\n    return df\ndf1 = df1.apply(plus,axis=1,args=(2,3,))\n</code></pre><p>其中axis=1代表按照列为轴进行操作，axis=0代表按照行为轴进行操作，args是传递的两个参数，即n=2, m=3，在plus函数中使用到了n和m，从而生成新的df。</p><h2>数据统计</h2><p>在数据清洗后，我们就要对数据进行统计了。</p><p>Pandas和NumPy一样，都有常用的统计函数，如果遇到空值NaN，会自动排除。</p><p>常用的统计函数包括：</p><p><img src=\"https://static001.geekbang.org/resource/image/34/00/343ba98c1322dc0c013e07c87b157a00.jpg?wh=1800*3200\" alt=\"\"></p><p>表格中有一个describe()函数，统计函数千千万，describe()函数最简便。它是个统计大礼包，可以快速让我们对数据有个全面的了解。下面我直接使用df1.descirbe()输出结果为：</p><pre><code>df1 = DataFrame({'name':['ZhangFei', 'GuanYu', 'a', 'b', 'c'], 'data1':range(5)})\nprint df1.describe()\n</code></pre><p><img src=\"https://static001.geekbang.org/resource/image/e4/83/e4a7a208a11d60dbcda6f3dbaff9a583.png?wh=205*250\" alt=\"\"></p><h2>数据表合并</h2><p>有时候我们需要将多个渠道源的多个数据表进行合并，一个DataFrame相当于一个数据库的数据表，那么多个DataFrame数据表的合并就相当于多个数据库的表合并。</p><p>比如我要创建两个DataFrame：</p><pre><code>df1 = DataFrame({'name':['ZhangFei', 'GuanYu', 'a', 'b', 'c'], 'data1':range(5)})\ndf2 = DataFrame({'name':['ZhangFei', 'GuanYu', 'A', 'B', 'C'], 'data2':range(5)})\n</code></pre><p>两个DataFrame数据表的合并使用的是merge()函数，有下面5种形式：</p><p><strong>1. 基于指定列进行连接</strong></p><p>比如我们可以基于name这列进行连接。</p><pre><code>df3 = pd.merge(df1, df2, on='name')\n</code></pre><p><img src=\"https://static001.geekbang.org/resource/image/22/2f/220ce1ea19c8f6f2668d3a8122989c2f.png?wh=862*227?wh=862*227\" alt=\"\"></p><p><strong>2. inner内连接</strong></p><p>inner内链接是merge合并的默认情况，inner内连接其实也就是键的交集，在这里df1, df2相同的键是name，所以是基于name字段做的连接：</p><pre><code>df3 = pd.merge(df1, df2, how='inner')\n</code></pre><p><img src=\"https://static001.geekbang.org/resource/image/22/2f/220ce1ea19c8f6f2668d3a8122989c2f.png?wh=862*227?wh=862*227\" alt=\"\"></p><p><strong>3. left左连接</strong></p><p>左连接是以第一个DataFrame为主进行的连接，第二个DataFrame作为补充。</p><pre><code>df3 = pd.merge(df1, df2, how='left')\n</code></pre><p><img src=\"https://static001.geekbang.org/resource/image/90/ac/9091a7406d5aa7a2980328d587fb42ac.png?wh=863*234\" alt=\"\"></p><p><strong>4. right右连接</strong></p><p>右连接是以第二个DataFrame为主进行的连接，第一个DataFrame作为补充。</p><pre><code>df3 = pd.merge(df1, df2, how='right')\n</code></pre><p><img src=\"https://static001.geekbang.org/resource/image/10/af/10f9f22f66f3745381d85d760f857baf.png?wh=863*245\" alt=\"\"></p><p><strong>5. outer外连接</strong></p><p>外连接相当于求两个DataFrame的并集。</p><pre><code>df3 = pd.merge(df1, df2, how='outer')\n</code></pre><p><img src=\"https://static001.geekbang.org/resource/image/67/8c/6737f6d4d66af0d75734cd140b5d198c.png?wh=864*346\" alt=\"\"></p><h2>如何用SQL方式打开Pandas</h2><p>Pandas的DataFrame数据类型可以让我们像处理数据表一样进行操作，比如数据表的增删改查，都可以用Pandas工具来完成。不过也会有很多人记不住这些Pandas的命令，相比之下还是用SQL语句更熟练，用SQL对数据表进行操作是最方便的，它的语句描述形式更接近我们的自然语言。</p><p>事实上，在Python里可以直接使用SQL语句来操作Pandas。</p><p>这里给你介绍个工具：pandasql。</p><p>pandasql 中的主要函数是 sqldf，它接收两个参数：一个SQL 查询语句，还有一组环境变量globals()或locals()。这样我们就可以在Python里，直接用SQL语句中对DataFrame进行操作，举个例子：</p><pre><code>import pandas as pd\nfrom pandas import DataFrame\nfrom pandasql import sqldf, load_meat, load_births\ndf1 = DataFrame({'name':['ZhangFei', 'GuanYu', 'a', 'b', 'c'], 'data1':range(5)})\npysqldf = lambda sql: sqldf(sql, globals())\nsql = &quot;select * from df1 where name ='ZhangFei'&quot;\nprint pysqldf(sql)\n</code></pre><p>运行结果：</p><pre><code>   data1      name\n0      0  ZhangFei\n</code></pre><p>上面这个例子中，我们是对“name='ZhangFei”“的行进行了输出。当然你会看到我们用到了lambda，lambda在python中算是使用频率很高的，那lambda是用来做什么的呢？它实际上是用来定义一个匿名函数的，具体的使用形式为：</p><pre><code> lambda argument_list: expression\n</code></pre><p>这里argument_list是参数列表，expression是关于参数的表达式，会根据expression表达式计算结果进行输出返回。</p><p>在上面的代码中，我们定义了：</p><pre><code>pysqldf = lambda sql: sqldf(sql, globals())\n</code></pre><p>在这个例子里，输入的参数是sql，返回的结果是sqldf对sql的运行结果，当然sqldf中也输入了globals全局参数，因为在sql中有对全局参数df1的使用。</p><h2>总结</h2><p>和NumPy一样，Pandas有两个非常重要的数据结构：Series和DataFrame。使用Pandas可以直接从csv或xlsx等文件中导入数据，以及最终输出到excel表中。</p><p>我重点介绍了数据清洗中的操作，当然Pandas中同样提供了多种数据统计的函数。</p><p>最后我们介绍了如何将数据表进行合并，以及在Pandas中使用SQL对数据表更方便地进行操作。</p><p>Pandas包与NumPy工具库配合使用可以发挥巨大的威力，正是有了Pandas工具，Python做数据挖掘才具有优势。</p><p><img src=\"https://static001.geekbang.org/resource/image/74/cd/74884960677548b08acdc919c13460cd.jpg?wh=3200*1800\" alt=\"\"></p><p>我们来回顾一下今天的内容，在Pandas中，最主要的数据结构是什么？它都提供了哪些函数，可以帮我们做数据清洗？你可以自己描述一下吗？</p><h2>练习题</h2><p>对于下表的数据，请使用Pandas中的DataFrame进行创建，并对数据进行清洗。同时新增一列“总和”计算每个人的三科成绩之和。</p><p><img src=\"https://static001.geekbang.org/resource/image/25/80/25b34b3f6227a945500074e05ea49e80.png?wh=423*241\" alt=\"\"><br>\n欢迎在评论区与我分享你的答案。</p><p>如果你觉着这篇文章有价值，欢迎点击“请朋友读”，把这篇文章分享给你的朋友或者同事。</p><p></p>","neighbors":{"left":{"article_title":"04丨Python科学计算：用NumPy快速处理数据","id":73756},"right":{"article_title":"06 | 学数据分析要掌握哪些基本概念？","id":74612}},"comments":[{"had_liked":false,"id":53254,"user_name":"何楚","can_delete":false,"product_type":"c1","uid":1355689,"ip_address":"","ucode":"51C8258A3EAF11","user_header":"https://static001.geekbang.org/account/avatar/00/14/af/a9/e24380a0.jpg","comment_is_top":false,"comment_ctime":1545619739,"is_pvip":false,"replies":[{"id":19432,"content":"整理的不错，终于看到张飞的数学成绩 按照平均值来补全的了","user_name":"作者回复","user_name_real":"cy","uid":1306094,"ctime":1545670087,"ip_address":"","comment_id":53254,"utype":1}],"discussion_count":6,"race_medal":0,"score":2,"product_id":100021701,"comment_content":"#!&#47;usr&#47;bin&#47;env python3\n# -*- coding: utf-8 -*-\n\nimport pandas as pd\n\ndata = {&#39;Chinese&#39;: [66, 95, 93, 90, 80, 80], &#39;English&#39;: [65, 85, 92, 88, 90, 90],\n        &#39;Math&#39;: [None, 98, 96, 77, 90, 90]}\ndf = pd.DataFrame(data, index=[&#39;张飞&#39;, &#39;关羽&#39;, &#39;赵云&#39;, &#39;黄忠&#39;, &#39;典韦&#39;, &#39;典韦&#39;],\n                  columns=[&#39;English&#39;, &#39;Math&#39;, &#39;Chinese&#39;])\n# 去除重复行\ndf = df.drop_duplicates()\n# 列名重新排序\ncols = [&#39;Chinese&#39;, &#39;English&#39;, &#39;Math&#39;]\ndf = df.filter(cols, axis=1)\n# 列名改为中文\ndf.rename(columns={&#39;Chinese&#39;: &#39;语文&#39;, &#39;English&#39;: &#39;英语&#39;,\n                   &#39;Math&#39;: &#39;数学&#39;}, inplace=True)\n\n\ndef total_score(df):\n    df[&#39;总分&#39;] = df[&#39;语文&#39;] + df[&#39;英语&#39;] + df[&#39;数学&#39;]\n    return df\n\n\n# 求成绩的和，用老师讲的 apply 方法\ndf = df.apply(total_score, axis=1)\n# 或者可以用这个方法求和\n# df[&#39;总分&#39;] = df[&#39;语文&#39;] + df[&#39;英语&#39;] + df[&#39;数学&#39;]\n# 按照总分排序，从高到低，此时有缺失值\ndf.sort_values([&#39;总分&#39;], ascending=[False], inplace=True)\n# 打印显示成绩单信息，张飞有空值\nprint(df.isnull().sum())\nprint(df.describe())\nprint(df)\n\n# 使用数学成绩均值填充张飞同学的缺失值\ndf[&#39;数学&#39;].fillna(df[&#39;数学&#39;].mean(), inplace=True)\n# 再次求成绩的和并打印显示成绩单情况\ndf = df.apply(total_score, axis=1)\nprint(df.isnull().sum())\nprint(df.describe())\nprint(df)\n","like_count":88},{"had_liked":false,"id":53374,"user_name":"daydreamer","can_delete":false,"product_type":"c1","uid":1339168,"ip_address":"","ucode":"375D9D4F9A7AF6","user_header":"https://static001.geekbang.org/account/avatar/00/14/6f/20/53cb569d.jpg","comment_is_top":false,"comment_ctime":1545634716,"is_pvip":false,"replies":[{"id":19431,"content":"df[&#39;Total&#39;] = df.sum(axis=1) 这个求和写的还是挺简洁的","user_name":"作者回复","user_name_real":"cy","uid":1306094,"ctime":1545669962,"ip_address":"","comment_id":53374,"utype":1}],"discussion_count":2,"race_medal":0,"score":2,"product_id":100021701,"comment_content":"&quot;&quot;&quot;\nPandas中有Series和DataFrame两种重要的数据结构。\n    Series：是一个定长的字典序列。有两个基本属性：index，values\n    DataFrame：类似于数据库表的一种数据结构。我们甚至可以像操作数据库表那样对DataFrame数据进行\n    连接，合并，查询等等\n    常用DataFrame进行数据清晰：用到的发方法有:\n        去重删除：drop()，drop_duplicates(),rename()\n        去空格：strip(),lstrip(),rstrip()\n        变换大小写：upper(),lower(),title()\n        改变数据格式：astype()\n        查找空值：lsnull\n        apply\n\n\n&quot;&quot;&quot;\nfrom pandas import DataFrame\n\n# Scores of students\nscores = {&#39;Chinese&#39;: [66, 95, 95, 90, 80, 80],\n          &#39;English&#39;: [65, 85, 92, 80, 90, 90],\n          &#39;Math&#39;: [None, 98, 96, 77, 90, 90],\n          &#39;Total&#39;: [None, None, None, None, None, None]}\ndf = DataFrame(scores, index=[&#39;Zhang Fei&#39;, &#39;Guan Yu&#39;, &#39;Zhao Yun&#39;, &#39;Huang Zhong&#39;, &#39;Dian Wei&#39;,&#39;Dian Wei&#39;],)\n\n# Data ckeaning.\n# remove the duplicated record.\ndf = df.drop_duplicates()\n# print(df)\n\n# Calculate the total scores.\ndf[&#39;Total&#39;] = df.sum(axis=1)\nprint(df.describe())","like_count":21,"discussions":[{"author":{"id":1306094,"avatar":"https://static001.geekbang.org/account/avatar/00/13/ed/ee/c4779b67.jpg","nickname":"cy","note":"","ucode":"50D653399A31F6","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":434085,"discussion_content":"整理的不错，终于看到张飞的数学成绩 按照平均值来补全的了","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1545670087,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1022786,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/9b/42/aeb79b35.jpg","nickname":"Ling","note":"","ucode":"EE15D1ABDB073B","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":51202,"discussion_content":"其实新增列的话，不用自定义函数。\n\n# 新增列\ndf[&#34;总分数&#34;] = df.sum(axis=1)\n\n这样就行了。。","likes_number":6,"is_delete":false,"is_hidden":false,"ctime":1573823525,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1402511,"avatar":"https://static001.geekbang.org/account/avatar/00/15/66/8f/02be926d.jpg","nickname":"在路上","note":"","ucode":"6E31908EFE1107","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":532873,"discussion_content":"写得很好","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1637723825,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"{\"user_type\":1}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1525309,"avatar":"https://static001.geekbang.org/account/avatar/00/17/46/3d/55653953.jpg","nickname":"AI悦创","note":"","ucode":"D1007711CB0A79","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":302577,"discussion_content":"可以加我一起学习：Jiabcdefh，公众号：AI悦创","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1598964230,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":2016777,"avatar":"https://static001.geekbang.org/account/avatar/00/1e/c6/09/5ffaf096.jpg","nickname":"冬日阳光","note":"","ucode":"BFCA0C7BE4F06D","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":279480,"discussion_content":"df.filter这个好像是筛选需要的列 不是重新排序啊","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1591351934,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1189186,"avatar":"https://static001.geekbang.org/account/avatar/00/12/25/42/886a1f6e.jpg","nickname":"大富","note":"","ucode":"038D86A4D4CAB4","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":2603,"discussion_content":"同学，看了你写的代码，发现你用的挺灵活的。想交你这个优秀的朋友 ，不介意的话加我微信： zcf18290287575 ，或者你留下微信号 ，我加你也可以 。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1563784634,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":148866,"user_name":"知悉者也","can_delete":false,"product_type":"c1","uid":1728936,"ip_address":"","ucode":"6CB311A387709D","user_header":"https://static001.geekbang.org/account/avatar/00/1a/61/a8/a0b4d4d2.jpg","comment_is_top":false,"comment_ctime":1573096650,"is_pvip":false,"replies":[{"id":62680,"content":"正确，使用的很熟练","user_name":"作者回复","user_name_real":"cy","uid":1306094,"ctime":1577084119,"ip_address":"","comment_id":148866,"utype":1}],"discussion_count":2,"race_medal":0,"score":2,"product_id":100021701,"comment_content":"stu_score = pd.DataFrame([[&#39;张飞&#39;, 66, 65, np.nan],\n                         [&#39;关羽&#39;, 95, 85, 98],\n                         [&#39;赵云&#39;, 95, 92, 96],\n                         [&#39;黄忠&#39;, 90, 88, 77],\n                         [&#39;典韦&#39;, 80, 90, 90],\n                         [&#39;典韦&#39;, 80, 90, 90]],\n                        columns = [&#39;姓名&#39;,&#39;语文&#39;, &#39;英语&#39;, &#39;数学&#39;])\nstu_score = stu_score.set_index(&#39;姓名&#39;)  # 将某一列作为索引\n\nstu_score = stu_score.fillna(axis=1, method=&#39;ffill&#39;)  # 以左边来填充缺失值\nstu_score[&#39;总分&#39;] = stu_score.apply(sum , axis=1)\nstu_score","like_count":7,"discussions":[{"author":{"id":1306094,"avatar":"https://static001.geekbang.org/account/avatar/00/13/ed/ee/c4779b67.jpg","nickname":"cy","note":"","ucode":"50D653399A31F6","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":434117,"discussion_content":"df[&amp;#39;Total&amp;#39;] = df.sum(axis=1) 这个求和写的还是挺简洁的","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1545669962,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1396867,"avatar":"https://static001.geekbang.org/account/avatar/00/15/50/83/5c7394ec.jpg","nickname":"西风凋碧树","note":"","ucode":"F068F0E5B1ECB8","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":116868,"discussion_content":"最后的打印应该是 print(df)","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1578066342,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":105490,"user_name":"董大琳儿","can_delete":false,"product_type":"c1","uid":1582410,"ip_address":"","ucode":"8D03DA624D5EF8","user_header":"https://wx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTIc88LLmwU7RU1tGcmo5OZyPibKeXPg31wMxyc2uByEO3g44f6uLcu1bXGNO9AHVgn0PK5hwkcfYZA/132","comment_is_top":false,"comment_ctime":1561014196,"is_pvip":false,"replies":[{"id":64071,"content":"慢慢来 董大琳","user_name":"作者回复","user_name_real":"cy","uid":1306094,"ctime":1577608684,"ip_address":"","comment_id":105490,"utype":1}],"discussion_count":1,"race_medal":0,"score":2,"product_id":100021701,"comment_content":"都没听懂，感到淡淡的忧伤~~~","like_count":6,"discussions":[{"author":{"id":1306094,"avatar":"https://static001.geekbang.org/account/avatar/00/13/ed/ee/c4779b67.jpg","nickname":"cy","note":"","ucode":"50D653399A31F6","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":454702,"discussion_content":"慢慢来 董大琳","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1577608684,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":143585,"user_name":"Answer Liu","can_delete":false,"product_type":"c1","uid":1387369,"ip_address":"","ucode":"7F1E3D96EAD35C","user_header":"https://static001.geekbang.org/account/avatar/00/15/2b/69/7aace61c.jpg","comment_is_top":false,"comment_ctime":1571737166,"is_pvip":false,"replies":[{"id":62775,"content":"Good Job","user_name":"作者回复","user_name_real":"cy","uid":1306094,"ctime":1577091004,"ip_address":"","comment_id":143585,"utype":1}],"discussion_count":1,"race_medal":0,"score":2,"product_id":100021701,"comment_content":"df6 = pd.DataFrame(\n    {&quot;语文&quot;: [66, 95, 95, 90, 80, 80], &quot;数学&quot;: [65, 85, 92, 88, 90, 90], &quot;英语&quot;: [np.nan, 98, 96, 77, 90, 90]},\n    index=[&#39;张飞&#39;, &#39;关羽&#39;, &#39;赵云&#39;, &#39;黄忠&#39;, &#39;典韦&#39;, &#39;典韦&#39;]\n)\n# 去重\ndf7 = df6.drop_duplicates()\n# 替换NaN值\ndf8 = df7.fillna(df7[&#39;英语&#39;].mean())\n# 增加一行统计\ndf8[&#39;sum&#39;] = [df8.loc[name].sum() for name in df8.index]\n# 按总分倒序排列\ndf9 = df8.sort_values(by=&quot;sum&quot;, ascending=False)\nprint(df9)","like_count":5,"discussions":[{"author":{"id":1306094,"avatar":"https://static001.geekbang.org/account/avatar/00/13/ed/ee/c4779b67.jpg","nickname":"cy","note":"","ucode":"50D653399A31F6","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":471606,"discussion_content":"Good Job","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1577091004,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":146955,"user_name":"qinggeouye","can_delete":false,"product_type":"c1","uid":1251536,"ip_address":"","ucode":"5B53EEDD7BEC9C","user_header":"https://static001.geekbang.org/account/avatar/00/13/18/d0/49b06424.jpg","comment_is_top":false,"comment_ctime":1572717168,"is_pvip":false,"replies":[{"id":63485,"content":"Good Job","user_name":"作者回复","user_name_real":"cy","uid":1306094,"ctime":1577514145,"ip_address":"","comment_id":146955,"utype":1}],"discussion_count":2,"race_medal":0,"score":2,"product_id":100021701,"comment_content":"import numpy as np\nimport pandas as pd\n\nscores = pd.DataFrame(\n    {&#39;姓名&#39;: [&#39;张飞&#39;, &#39;关羽&#39;, &#39;赵云&#39;, &#39;黄忠&#39;, &#39;典韦&#39;, &#39;典韦&#39;], &#39;语文&#39;: [66, 95, 95, 90, 80, 80], &#39;英语&#39;: [65, 85, 92, 88, 90, 90],\n     &#39;数学&#39;: [np.NaN, 98, 96, 77, 90, 90], })\n\nprint(scores)\n\n# 查找空值所在的列\nisNaN = scores.isna().any()  # isnull(), isnull().any()\nisNaN = isNaN[isNaN == True]\nprint(scores[isNaN.index])\n\n# 列的平均值填充空值\nfor col in isNaN.index:\n    scores[col].fillna(scores[col].mean(), inplace=True)\nprint(scores)\n\n# 去除不必要的行（空值）\n# scores = scores.drop(index=[0])\n# scores = scores.dropna()\n\n# 去除重复行\nscores = scores.drop_duplicates()\nprint(scores)\n\n# 新增一列&#39;总和&#39;\n# scores[&#39;总和&#39;] = scores[&#39;语文&#39;] + scores[&#39;数学&#39;] + scores[&#39;英语&#39;]\nscores[&#39;总和&#39;] = scores.sum(axis=1)\nprint(scores)\n","like_count":4,"discussions":[{"author":{"id":1306094,"avatar":"https://static001.geekbang.org/account/avatar/00/13/ed/ee/c4779b67.jpg","nickname":"cy","note":"","ucode":"50D653399A31F6","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":473071,"discussion_content":"Good Job","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1577514145,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1251536,"avatar":"https://static001.geekbang.org/account/avatar/00/13/18/d0/49b06424.jpg","nickname":"qinggeouye","note":"","ucode":"5B53EEDD7BEC9C","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":42808,"discussion_content":"https://github.com/qinggeouye/GeekTime/blob/master/DataAnalysis/05_pandas.py","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1572785854,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":63831,"user_name":"龟仙人","can_delete":false,"product_type":"c1","uid":1359668,"ip_address":"","ucode":"C66C11910B50FF","user_header":"https://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTLricLSQB9ABYhZnndOoX0jItAiaficX3XicbvND1RodB3y62GCwxRvgAfoZggOyRFyHqwqnicicJKvQJ9g/132","comment_is_top":false,"comment_ctime":1548535145,"is_pvip":false,"replies":[{"id":64647,"content":"后面例子用的是Python3，微信群需要找运营同学，让运营同学拉你入群","user_name":"作者回复","user_name_real":"cy","uid":1306094,"ctime":1577622919,"ip_address":"","comment_id":63831,"utype":1}],"discussion_count":3,"race_medal":0,"score":2,"product_id":100021701,"comment_content":"老师你好，你好像没有在哪里明确说明自己的环境是python2.7的，结果大家的使用环境大多数是3.0的，多多少少会引发一些问题。还有请问，微信群怎么加？","like_count":4,"discussions":[{"author":{"id":1306094,"avatar":"https://static001.geekbang.org/account/avatar/00/13/ed/ee/c4779b67.jpg","nickname":"cy","note":"","ucode":"50D653399A31F6","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":437726,"discussion_content":"后面例子用的是Python3，微信群需要找运营同学，让运营同学拉你入群","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1577622919,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1817356,"avatar":"https://static001.geekbang.org/account/avatar/00/1b/bb/0c/ab13c47a.jpg","nickname":"wewe","note":"","ucode":"4ECEA6F33F3560","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":164761,"discussion_content":"运营的同学怎么联系呀，在网页联系我们界面只有电话和邮箱","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1581219344,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1033956,"avatar":"http://thirdwx.qlogo.cn/mmopen/vi_32/QD6bf8hkS5dHrabdW7M7Oo9An1Oo3QSxqoySJMDh7GTraxFRX77VZ2HZ13x3R4EVYddIGXicRRDAc7V9z5cLDlA/132","nickname":"爬行的蜗牛","note":"","ucode":"6623B62DE63CE9","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":127766,"discussion_content":"原来有微信群啊","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1578583906,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":53511,"user_name":"Grandia_Z","can_delete":false,"product_type":"c1","uid":1354034,"ip_address":"","ucode":"4928A7ABA7C24C","user_header":"https://static001.geekbang.org/account/avatar/00/14/a9/32/eb71b457.jpg","comment_is_top":false,"comment_ctime":1545660362,"is_pvip":false,"replies":[{"id":19400,"content":"我运行没有问题，是正确的。我使用的是py2.7版本，另外你在开头引用了 DataFrame和pandas工具包了么\n你可以联系编辑，加微信群，我帮你看下","user_name":"作者回复","user_name_real":"cy","uid":1306094,"ctime":1545666358,"ip_address":"","comment_id":53511,"utype":1}],"discussion_count":1,"race_medal":0,"score":2,"product_id":100021701,"comment_content":"照着老师写 df2 = df2.drop(columns=[&#39;Chinese&#39;]) 这行代码后,返回结果是:\nTypeError                                 Traceback (most recent call last)\n&lt;ipython-input-25-8116650c61ac&gt; in &lt;module&gt;()\n----&gt; 1 df2 = df2.drop(columns=[&#39;Chinese&#39;])\n\nTypeError: drop() got an unexpected keyword argument &#39;columns&#39;\n\n这个什么意思\n","like_count":3,"discussions":[{"author":{"id":1306094,"avatar":"https://static001.geekbang.org/account/avatar/00/13/ed/ee/c4779b67.jpg","nickname":"cy","note":"","ucode":"50D653399A31F6","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":437726,"discussion_content":"后面例子用的是Python3，微信群需要找运营同学，让运营同学拉你入群","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1577622919,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1817356,"avatar":"https://static001.geekbang.org/account/avatar/00/1b/bb/0c/ab13c47a.jpg","nickname":"wewe","note":"","ucode":"4ECEA6F33F3560","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":164761,"discussion_content":"运营的同学怎么联系呀，在网页联系我们界面只有电话和邮箱","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1581219344,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1033956,"avatar":"http://thirdwx.qlogo.cn/mmopen/vi_32/QD6bf8hkS5dHrabdW7M7Oo9An1Oo3QSxqoySJMDh7GTraxFRX77VZ2HZ13x3R4EVYddIGXicRRDAc7V9z5cLDlA/132","nickname":"爬行的蜗牛","note":"","ucode":"6623B62DE63CE9","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":127766,"discussion_content":"原来有微信群啊","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1578583906,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":106611,"user_name":"窝窝头","can_delete":false,"product_type":"c1","uid":1063866,"ip_address":"","ucode":"5C2635ED6484F8","user_header":"https://static001.geekbang.org/account/avatar/00/10/3b/ba/3b30dcde.jpg","comment_is_top":false,"comment_ctime":1561356546,"is_pvip":false,"replies":[{"id":64026,"content":"Good Job","user_name":"作者回复","user_name_real":"cy","uid":1306094,"ctime":1577607755,"ip_address":"","comment_id":106611,"utype":1}],"discussion_count":1,"race_medal":0,"score":2,"product_id":100021701,"comment_content":"import pandas as pd\ndata = {&#39;语文&#39;: [66, 95, 93, 90, 80, 80], &#39;英语&#39;: [65, 85, 92, 88, 90, 90],\n        &#39;数学&#39;: [None, 98, 96, 77, 90, 90]}\ndf = pd.DataFrame(data, index=[&#39;张飞&#39;, &#39;关羽&#39;, &#39;赵云&#39;, &#39;黄忠&#39;, &#39;典韦&#39;, &#39;典韦&#39;],\n                  columns=[u&#39;英语&#39;, u&#39;数学&#39;, u&#39;语文&#39;])\ndf=df.dropna()\ndf = df.drop_duplicates()\ndf[u&#39;总和&#39;] = df[u&#39;语文&#39;]+df[u&#39;英语&#39;]+df[u&#39;数学&#39;]\ndf.head()\n","like_count":2,"discussions":[{"author":{"id":1306094,"avatar":"https://static001.geekbang.org/account/avatar/00/13/ed/ee/c4779b67.jpg","nickname":"cy","note":"","ucode":"50D653399A31F6","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":434163,"discussion_content":"我运行没有问题，是正确的。我使用的是py2.7版本，另外你在开头引用了 DataFrame和pandas工具包了么\n你可以联系编辑，加微信群，我帮你看下","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1545666358,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":84992,"user_name":"青石","can_delete":false,"product_type":"c1","uid":1215531,"ip_address":"","ucode":"B0056AD6453322","user_header":"https://static001.geekbang.org/account/avatar/00/12/8c/2b/3ab96998.jpg","comment_is_top":false,"comment_ctime":1554953484,"is_pvip":false,"replies":[{"id":64274,"content":"Good Job","user_name":"作者回复","user_name_real":"cy","uid":1306094,"ctime":1577615848,"ip_address":"","comment_id":84992,"utype":1}],"discussion_count":1,"race_medal":0,"score":2,"product_id":100021701,"comment_content":"from pandas import DataFrame\n\n\ndef score(df):\n    df[&#39;score&#39;] = df[u&#39;Chinese&#39;] + df[u&#39;English&#39;] + df[u&#39;Math&#39;]\n    return df\n\ndata = {&#39;Chinese&#39;: [66, 95, 95, 90, 80, 80], &#39;English&#39;: [65, 85, 92, 88, 90, 90], &#39;Math&#39;: [None, 98, 96, 77, 90, 90]}\ndf = DataFrame(data, index=[&#39;ZhangFei&#39;, &#39;GuanYu&#39;, &#39;ZhaoYun&#39;, &#39;HuangZhong&#39;, &#39;DianWei&#39;, &#39;DianWei&#39;], columns=[&#39;Chinese&#39;, &#39;English&#39;, &#39;Math&#39;])\ndf = df.drop_duplicates().fillna(0)\ndf = df.apply(score, axis=1)\n\nprint(df)","like_count":2,"discussions":[{"author":{"id":1306094,"avatar":"https://static001.geekbang.org/account/avatar/00/13/ed/ee/c4779b67.jpg","nickname":"cy","note":"","ucode":"50D653399A31F6","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":446521,"discussion_content":"Good Job","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1577615848,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":53254,"user_name":"何楚","can_delete":false,"product_type":"c1","uid":1355689,"ip_address":"","ucode":"51C8258A3EAF11","user_header":"https://static001.geekbang.org/account/avatar/00/14/af/a9/e24380a0.jpg","comment_is_top":false,"comment_ctime":1545619739,"is_pvip":false,"replies":[{"id":19432,"content":"整理的不错，终于看到张飞的数学成绩 按照平均值来补全的了","user_name":"作者回复","user_name_real":"cy","uid":1306094,"ctime":1545670087,"ip_address":"","comment_id":53254,"utype":1}],"discussion_count":6,"race_medal":0,"score":2,"product_id":100021701,"comment_content":"#!&#47;usr&#47;bin&#47;env python3\n# -*- coding: utf-8 -*-\n\nimport pandas as pd\n\ndata = {&#39;Chinese&#39;: [66, 95, 93, 90, 80, 80], &#39;English&#39;: [65, 85, 92, 88, 90, 90],\n        &#39;Math&#39;: [None, 98, 96, 77, 90, 90]}\ndf = pd.DataFrame(data, index=[&#39;张飞&#39;, &#39;关羽&#39;, &#39;赵云&#39;, &#39;黄忠&#39;, &#39;典韦&#39;, &#39;典韦&#39;],\n                  columns=[&#39;English&#39;, &#39;Math&#39;, &#39;Chinese&#39;])\n# 去除重复行\ndf = df.drop_duplicates()\n# 列名重新排序\ncols = [&#39;Chinese&#39;, &#39;English&#39;, &#39;Math&#39;]\ndf = df.filter(cols, axis=1)\n# 列名改为中文\ndf.rename(columns={&#39;Chinese&#39;: &#39;语文&#39;, &#39;English&#39;: &#39;英语&#39;,\n                   &#39;Math&#39;: &#39;数学&#39;}, inplace=True)\n\n\ndef total_score(df):\n    df[&#39;总分&#39;] = df[&#39;语文&#39;] + df[&#39;英语&#39;] + df[&#39;数学&#39;]\n    return df\n\n\n# 求成绩的和，用老师讲的 apply 方法\ndf = df.apply(total_score, axis=1)\n# 或者可以用这个方法求和\n# df[&#39;总分&#39;] = df[&#39;语文&#39;] + df[&#39;英语&#39;] + df[&#39;数学&#39;]\n# 按照总分排序，从高到低，此时有缺失值\ndf.sort_values([&#39;总分&#39;], ascending=[False], inplace=True)\n# 打印显示成绩单信息，张飞有空值\nprint(df.isnull().sum())\nprint(df.describe())\nprint(df)\n\n# 使用数学成绩均值填充张飞同学的缺失值\ndf[&#39;数学&#39;].fillna(df[&#39;数学&#39;].mean(), inplace=True)\n# 再次求成绩的和并打印显示成绩单情况\ndf = df.apply(total_score, axis=1)\nprint(df.isnull().sum())\nprint(df.describe())\nprint(df)\n","like_count":88,"discussions":[{"author":{"id":1306094,"avatar":"https://static001.geekbang.org/account/avatar/00/13/ed/ee/c4779b67.jpg","nickname":"cy","note":"","ucode":"50D653399A31F6","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":434085,"discussion_content":"整理的不错，终于看到张飞的数学成绩 按照平均值来补全的了","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1545670087,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1022786,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/9b/42/aeb79b35.jpg","nickname":"Ling","note":"","ucode":"EE15D1ABDB073B","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":51202,"discussion_content":"其实新增列的话，不用自定义函数。\n\n# 新增列\ndf[&#34;总分数&#34;] = df.sum(axis=1)\n\n这样就行了。。","likes_number":6,"is_delete":false,"is_hidden":false,"ctime":1573823525,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1402511,"avatar":"https://static001.geekbang.org/account/avatar/00/15/66/8f/02be926d.jpg","nickname":"在路上","note":"","ucode":"6E31908EFE1107","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":532873,"discussion_content":"写得很好","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1637723825,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"{\"user_type\":1}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1525309,"avatar":"https://static001.geekbang.org/account/avatar/00/17/46/3d/55653953.jpg","nickname":"AI悦创","note":"","ucode":"D1007711CB0A79","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":302577,"discussion_content":"可以加我一起学习：Jiabcdefh，公众号：AI悦创","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1598964230,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":2016777,"avatar":"https://static001.geekbang.org/account/avatar/00/1e/c6/09/5ffaf096.jpg","nickname":"冬日阳光","note":"","ucode":"BFCA0C7BE4F06D","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":279480,"discussion_content":"df.filter这个好像是筛选需要的列 不是重新排序啊","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1591351934,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1189186,"avatar":"https://static001.geekbang.org/account/avatar/00/12/25/42/886a1f6e.jpg","nickname":"大富","note":"","ucode":"038D86A4D4CAB4","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":2603,"discussion_content":"同学，看了你写的代码，发现你用的挺灵活的。想交你这个优秀的朋友 ，不介意的话加我微信： zcf18290287575 ，或者你留下微信号 ，我加你也可以 。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1563784634,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":53374,"user_name":"daydreamer","can_delete":false,"product_type":"c1","uid":1339168,"ip_address":"","ucode":"375D9D4F9A7AF6","user_header":"https://static001.geekbang.org/account/avatar/00/14/6f/20/53cb569d.jpg","comment_is_top":false,"comment_ctime":1545634716,"is_pvip":false,"replies":[{"id":19431,"content":"df[&#39;Total&#39;] = df.sum(axis=1) 这个求和写的还是挺简洁的","user_name":"作者回复","user_name_real":"cy","uid":1306094,"ctime":1545669962,"ip_address":"","comment_id":53374,"utype":1}],"discussion_count":2,"race_medal":0,"score":2,"product_id":100021701,"comment_content":"&quot;&quot;&quot;\nPandas中有Series和DataFrame两种重要的数据结构。\n    Series：是一个定长的字典序列。有两个基本属性：index，values\n    DataFrame：类似于数据库表的一种数据结构。我们甚至可以像操作数据库表那样对DataFrame数据进行\n    连接，合并，查询等等\n    常用DataFrame进行数据清晰：用到的发方法有:\n        去重删除：drop()，drop_duplicates(),rename()\n        去空格：strip(),lstrip(),rstrip()\n        变换大小写：upper(),lower(),title()\n        改变数据格式：astype()\n        查找空值：lsnull\n        apply\n\n\n&quot;&quot;&quot;\nfrom pandas import DataFrame\n\n# Scores of students\nscores = {&#39;Chinese&#39;: [66, 95, 95, 90, 80, 80],\n          &#39;English&#39;: [65, 85, 92, 80, 90, 90],\n          &#39;Math&#39;: [None, 98, 96, 77, 90, 90],\n          &#39;Total&#39;: [None, None, None, None, None, None]}\ndf = DataFrame(scores, index=[&#39;Zhang Fei&#39;, &#39;Guan Yu&#39;, &#39;Zhao Yun&#39;, &#39;Huang Zhong&#39;, &#39;Dian Wei&#39;,&#39;Dian Wei&#39;],)\n\n# Data ckeaning.\n# remove the duplicated record.\ndf = df.drop_duplicates()\n# print(df)\n\n# Calculate the total scores.\ndf[&#39;Total&#39;] = df.sum(axis=1)\nprint(df.describe())","like_count":21,"discussions":[{"author":{"id":1306094,"avatar":"https://static001.geekbang.org/account/avatar/00/13/ed/ee/c4779b67.jpg","nickname":"cy","note":"","ucode":"50D653399A31F6","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":434117,"discussion_content":"df[&amp;#39;Total&amp;#39;] = df.sum(axis=1) 这个求和写的还是挺简洁的","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1545669962,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1396867,"avatar":"https://static001.geekbang.org/account/avatar/00/15/50/83/5c7394ec.jpg","nickname":"西风凋碧树","note":"","ucode":"F068F0E5B1ECB8","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":116868,"discussion_content":"最后的打印应该是 print(df)","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1578066342,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":148866,"user_name":"知悉者也","can_delete":false,"product_type":"c1","uid":1728936,"ip_address":"","ucode":"6CB311A387709D","user_header":"https://static001.geekbang.org/account/avatar/00/1a/61/a8/a0b4d4d2.jpg","comment_is_top":false,"comment_ctime":1573096650,"is_pvip":false,"replies":[{"id":62680,"content":"正确，使用的很熟练","user_name":"作者回复","user_name_real":"cy","uid":1306094,"ctime":1577084119,"ip_address":"","comment_id":148866,"utype":1}],"discussion_count":2,"race_medal":0,"score":2,"product_id":100021701,"comment_content":"stu_score = pd.DataFrame([[&#39;张飞&#39;, 66, 65, np.nan],\n                         [&#39;关羽&#39;, 95, 85, 98],\n                         [&#39;赵云&#39;, 95, 92, 96],\n                         [&#39;黄忠&#39;, 90, 88, 77],\n                         [&#39;典韦&#39;, 80, 90, 90],\n                         [&#39;典韦&#39;, 80, 90, 90]],\n                        columns = [&#39;姓名&#39;,&#39;语文&#39;, &#39;英语&#39;, &#39;数学&#39;])\nstu_score = stu_score.set_index(&#39;姓名&#39;)  # 将某一列作为索引\n\nstu_score = stu_score.fillna(axis=1, method=&#39;ffill&#39;)  # 以左边来填充缺失值\nstu_score[&#39;总分&#39;] = stu_score.apply(sum , axis=1)\nstu_score","like_count":7,"discussions":[{"author":{"id":1306094,"avatar":"https://static001.geekbang.org/account/avatar/00/13/ed/ee/c4779b67.jpg","nickname":"cy","note":"","ucode":"50D653399A31F6","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":473644,"discussion_content":"正确，使用的很熟练","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1577084119,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":2416500,"avatar":"https://static001.geekbang.org/account/avatar/00/24/df/74/a8bba941.jpg","nickname":"野比浣熊","note":"","ucode":"D1AE4397B20910","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":342955,"discussion_content":"忘删除重复行了","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1610886362,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":105490,"user_name":"董大琳儿","can_delete":false,"product_type":"c1","uid":1582410,"ip_address":"","ucode":"8D03DA624D5EF8","user_header":"https://wx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTIc88LLmwU7RU1tGcmo5OZyPibKeXPg31wMxyc2uByEO3g44f6uLcu1bXGNO9AHVgn0PK5hwkcfYZA/132","comment_is_top":false,"comment_ctime":1561014196,"is_pvip":false,"replies":[{"id":64071,"content":"慢慢来 董大琳","user_name":"作者回复","user_name_real":"cy","uid":1306094,"ctime":1577608684,"ip_address":"","comment_id":105490,"utype":1}],"discussion_count":1,"race_medal":0,"score":2,"product_id":100021701,"comment_content":"都没听懂，感到淡淡的忧伤~~~","like_count":6,"discussions":[{"author":{"id":1306094,"avatar":"https://static001.geekbang.org/account/avatar/00/13/ed/ee/c4779b67.jpg","nickname":"cy","note":"","ucode":"50D653399A31F6","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":473644,"discussion_content":"正确，使用的很熟练","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1577084119,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":2416500,"avatar":"https://static001.geekbang.org/account/avatar/00/24/df/74/a8bba941.jpg","nickname":"野比浣熊","note":"","ucode":"D1AE4397B20910","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":342955,"discussion_content":"忘删除重复行了","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1610886362,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":143585,"user_name":"Answer Liu","can_delete":false,"product_type":"c1","uid":1387369,"ip_address":"","ucode":"7F1E3D96EAD35C","user_header":"https://static001.geekbang.org/account/avatar/00/15/2b/69/7aace61c.jpg","comment_is_top":false,"comment_ctime":1571737166,"is_pvip":false,"replies":[{"id":62775,"content":"Good Job","user_name":"作者回复","user_name_real":"cy","uid":1306094,"ctime":1577091004,"ip_address":"","comment_id":143585,"utype":1}],"discussion_count":1,"race_medal":0,"score":2,"product_id":100021701,"comment_content":"df6 = pd.DataFrame(\n    {&quot;语文&quot;: [66, 95, 95, 90, 80, 80], &quot;数学&quot;: [65, 85, 92, 88, 90, 90], &quot;英语&quot;: [np.nan, 98, 96, 77, 90, 90]},\n    index=[&#39;张飞&#39;, &#39;关羽&#39;, &#39;赵云&#39;, &#39;黄忠&#39;, &#39;典韦&#39;, &#39;典韦&#39;]\n)\n# 去重\ndf7 = df6.drop_duplicates()\n# 替换NaN值\ndf8 = df7.fillna(df7[&#39;英语&#39;].mean())\n# 增加一行统计\ndf8[&#39;sum&#39;] = [df8.loc[name].sum() for name in df8.index]\n# 按总分倒序排列\ndf9 = df8.sort_values(by=&quot;sum&quot;, ascending=False)\nprint(df9)","like_count":5,"discussions":[{"author":{"id":1306094,"avatar":"https://static001.geekbang.org/account/avatar/00/13/ed/ee/c4779b67.jpg","nickname":"cy","note":"","ucode":"50D653399A31F6","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":454702,"discussion_content":"慢慢来 董大琳","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1577608684,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":146955,"user_name":"qinggeouye","can_delete":false,"product_type":"c1","uid":1251536,"ip_address":"","ucode":"5B53EEDD7BEC9C","user_header":"https://static001.geekbang.org/account/avatar/00/13/18/d0/49b06424.jpg","comment_is_top":false,"comment_ctime":1572717168,"is_pvip":false,"replies":[{"id":63485,"content":"Good Job","user_name":"作者回复","user_name_real":"cy","uid":1306094,"ctime":1577514145,"ip_address":"","comment_id":146955,"utype":1}],"discussion_count":2,"race_medal":0,"score":2,"product_id":100021701,"comment_content":"import numpy as np\nimport pandas as pd\n\nscores = pd.DataFrame(\n    {&#39;姓名&#39;: [&#39;张飞&#39;, &#39;关羽&#39;, &#39;赵云&#39;, &#39;黄忠&#39;, &#39;典韦&#39;, &#39;典韦&#39;], &#39;语文&#39;: [66, 95, 95, 90, 80, 80], &#39;英语&#39;: [65, 85, 92, 88, 90, 90],\n     &#39;数学&#39;: [np.NaN, 98, 96, 77, 90, 90], })\n\nprint(scores)\n\n# 查找空值所在的列\nisNaN = scores.isna().any()  # isnull(), isnull().any()\nisNaN = isNaN[isNaN == True]\nprint(scores[isNaN.index])\n\n# 列的平均值填充空值\nfor col in isNaN.index:\n    scores[col].fillna(scores[col].mean(), inplace=True)\nprint(scores)\n\n# 去除不必要的行（空值）\n# scores = scores.drop(index=[0])\n# scores = scores.dropna()\n\n# 去除重复行\nscores = scores.drop_duplicates()\nprint(scores)\n\n# 新增一列&#39;总和&#39;\n# scores[&#39;总和&#39;] = scores[&#39;语文&#39;] + scores[&#39;数学&#39;] + scores[&#39;英语&#39;]\nscores[&#39;总和&#39;] = scores.sum(axis=1)\nprint(scores)\n","like_count":4,"discussions":[{"author":{"id":1306094,"avatar":"https://static001.geekbang.org/account/avatar/00/13/ed/ee/c4779b67.jpg","nickname":"cy","note":"","ucode":"50D653399A31F6","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":471606,"discussion_content":"Good Job","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1577091004,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":63831,"user_name":"龟仙人","can_delete":false,"product_type":"c1","uid":1359668,"ip_address":"","ucode":"C66C11910B50FF","user_header":"https://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTLricLSQB9ABYhZnndOoX0jItAiaficX3XicbvND1RodB3y62GCwxRvgAfoZggOyRFyHqwqnicicJKvQJ9g/132","comment_is_top":false,"comment_ctime":1548535145,"is_pvip":false,"replies":[{"id":64647,"content":"后面例子用的是Python3，微信群需要找运营同学，让运营同学拉你入群","user_name":"作者回复","user_name_real":"cy","uid":1306094,"ctime":1577622919,"ip_address":"","comment_id":63831,"utype":1}],"discussion_count":3,"race_medal":0,"score":2,"product_id":100021701,"comment_content":"老师你好，你好像没有在哪里明确说明自己的环境是python2.7的，结果大家的使用环境大多数是3.0的，多多少少会引发一些问题。还有请问，微信群怎么加？","like_count":4,"discussions":[{"author":{"id":1306094,"avatar":"https://static001.geekbang.org/account/avatar/00/13/ed/ee/c4779b67.jpg","nickname":"cy","note":"","ucode":"50D653399A31F6","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":473071,"discussion_content":"Good Job","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1577514145,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1251536,"avatar":"https://static001.geekbang.org/account/avatar/00/13/18/d0/49b06424.jpg","nickname":"qinggeouye","note":"","ucode":"5B53EEDD7BEC9C","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":42808,"discussion_content":"https://github.com/qinggeouye/GeekTime/blob/master/DataAnalysis/05_pandas.py","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1572785854,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":53511,"user_name":"Grandia_Z","can_delete":false,"product_type":"c1","uid":1354034,"ip_address":"","ucode":"4928A7ABA7C24C","user_header":"https://static001.geekbang.org/account/avatar/00/14/a9/32/eb71b457.jpg","comment_is_top":false,"comment_ctime":1545660362,"is_pvip":false,"replies":[{"id":19400,"content":"我运行没有问题，是正确的。我使用的是py2.7版本，另外你在开头引用了 DataFrame和pandas工具包了么\n你可以联系编辑，加微信群，我帮你看下","user_name":"作者回复","user_name_real":"cy","uid":1306094,"ctime":1545666358,"ip_address":"","comment_id":53511,"utype":1}],"discussion_count":1,"race_medal":0,"score":2,"product_id":100021701,"comment_content":"照着老师写 df2 = df2.drop(columns=[&#39;Chinese&#39;]) 这行代码后,返回结果是:\nTypeError                                 Traceback (most recent call last)\n&lt;ipython-input-25-8116650c61ac&gt; in &lt;module&gt;()\n----&gt; 1 df2 = df2.drop(columns=[&#39;Chinese&#39;])\n\nTypeError: drop() got an unexpected keyword argument &#39;columns&#39;\n\n这个什么意思\n","like_count":3,"discussions":[{"author":{"id":1306094,"avatar":"https://static001.geekbang.org/account/avatar/00/13/ed/ee/c4779b67.jpg","nickname":"cy","note":"","ucode":"50D653399A31F6","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":434163,"discussion_content":"我运行没有问题，是正确的。我使用的是py2.7版本，另外你在开头引用了 DataFrame和pandas工具包了么\n你可以联系编辑，加微信群，我帮你看下","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1545666358,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":106611,"user_name":"窝窝头","can_delete":false,"product_type":"c1","uid":1063866,"ip_address":"","ucode":"5C2635ED6484F8","user_header":"https://static001.geekbang.org/account/avatar/00/10/3b/ba/3b30dcde.jpg","comment_is_top":false,"comment_ctime":1561356546,"is_pvip":false,"replies":[{"id":64026,"content":"Good Job","user_name":"作者回复","user_name_real":"cy","uid":1306094,"ctime":1577607755,"ip_address":"","comment_id":106611,"utype":1}],"discussion_count":1,"race_medal":0,"score":2,"product_id":100021701,"comment_content":"import pandas as pd\ndata = {&#39;语文&#39;: [66, 95, 93, 90, 80, 80], &#39;英语&#39;: [65, 85, 92, 88, 90, 90],\n        &#39;数学&#39;: [None, 98, 96, 77, 90, 90]}\ndf = pd.DataFrame(data, index=[&#39;张飞&#39;, &#39;关羽&#39;, &#39;赵云&#39;, &#39;黄忠&#39;, &#39;典韦&#39;, &#39;典韦&#39;],\n                  columns=[u&#39;英语&#39;, u&#39;数学&#39;, u&#39;语文&#39;])\ndf=df.dropna()\ndf = df.drop_duplicates()\ndf[u&#39;总和&#39;] = df[u&#39;语文&#39;]+df[u&#39;英语&#39;]+df[u&#39;数学&#39;]\ndf.head()\n","like_count":2,"discussions":[{"author":{"id":1306094,"avatar":"https://static001.geekbang.org/account/avatar/00/13/ed/ee/c4779b67.jpg","nickname":"cy","note":"","ucode":"50D653399A31F6","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":455153,"discussion_content":"Good Job","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1577607755,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":84992,"user_name":"青石","can_delete":false,"product_type":"c1","uid":1215531,"ip_address":"","ucode":"B0056AD6453322","user_header":"https://static001.geekbang.org/account/avatar/00/12/8c/2b/3ab96998.jpg","comment_is_top":false,"comment_ctime":1554953484,"is_pvip":false,"replies":[{"id":64274,"content":"Good Job","user_name":"作者回复","user_name_real":"cy","uid":1306094,"ctime":1577615848,"ip_address":"","comment_id":84992,"utype":1}],"discussion_count":1,"race_medal":0,"score":2,"product_id":100021701,"comment_content":"from pandas import DataFrame\n\n\ndef score(df):\n    df[&#39;score&#39;] = df[u&#39;Chinese&#39;] + df[u&#39;English&#39;] + df[u&#39;Math&#39;]\n    return df\n\ndata = {&#39;Chinese&#39;: [66, 95, 95, 90, 80, 80], &#39;English&#39;: [65, 85, 92, 88, 90, 90], &#39;Math&#39;: [None, 98, 96, 77, 90, 90]}\ndf = DataFrame(data, index=[&#39;ZhangFei&#39;, &#39;GuanYu&#39;, &#39;ZhaoYun&#39;, &#39;HuangZhong&#39;, &#39;DianWei&#39;, &#39;DianWei&#39;], columns=[&#39;Chinese&#39;, &#39;English&#39;, &#39;Math&#39;])\ndf = df.drop_duplicates().fillna(0)\ndf = df.apply(score, axis=1)\n\nprint(df)","like_count":2,"discussions":[{"author":{"id":1306094,"avatar":"https://static001.geekbang.org/account/avatar/00/13/ed/ee/c4779b67.jpg","nickname":"cy","note":"","ucode":"50D653399A31F6","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":455153,"discussion_content":"Good Job","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1577607755,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":73083,"user_name":"初","can_delete":false,"product_type":"c1","uid":1187792,"ip_address":"","ucode":"E124D8A566DA43","user_header":"https://static001.geekbang.org/account/avatar/00/12/1f/d0/660502a4.jpg","comment_is_top":false,"comment_ctime":1551794123,"is_pvip":false,"replies":[{"id":64462,"content":"哈哈","user_name":"作者回复","user_name_real":"cy","uid":1306094,"ctime":1577619584,"ip_address":"","comment_id":73083,"utype":1}],"discussion_count":1,"race_medal":0,"score":3,"product_id":100021701,"comment_content":"None竟然是浮点型数据....没想到","like_count":2},{"had_liked":false,"id":53420,"user_name":"lingmacker","can_delete":false,"product_type":"c1","uid":1353113,"ip_address":"","ucode":"2B61674AD47F34","user_header":"https://static001.geekbang.org/account/avatar/00/14/a5/99/db2f6325.jpg","comment_is_top":false,"comment_ctime":1545640624,"is_pvip":false,"replies":[{"id":19429,"content":"整理的不错，清洗张飞的数学成绩的时候，没有唯一答案。也可以用其他人的数学成绩平均值进行补全","user_name":"作者回复","user_name_real":"cy","uid":1306094,"ctime":1545669596,"ip_address":"","comment_id":53420,"utype":1}],"discussion_count":1,"race_medal":0,"score":3,"product_id":100021701,"comment_content":"def exercise():\n    # 1. 对于下表的数据，请使用Pandas中的DataFrame进行创建，并对数据进行清洗。\n    # 2. 同时新增一列“总和”计算每个人的三科成绩之和。\n\n    # 列名使用了中文，打印需要列对其的话，则需要设置这两个参数\n    pd.set_option(&#39;display.unicode.ambiguous_as_wide&#39;, True)\n    pd.set_option(&#39;display.unicode.east_asian_width&#39;, True)\n\n    data = {&quot;姓名&quot;: [&quot;张飞&quot;, &quot;关羽&quot;, &quot;赵云&quot;, &quot;黄忠&quot;, &quot;典韦&quot;, &quot;典韦&quot;],\n            &quot;语文&quot;: [66, 95, 95, 90, 80, 80],\n            &quot;英语&quot;: [65, 85, 92, 88, 90, 90],\n            &quot;数学&quot;: [None, 98, 96, 77, 90, 90]}\n    \n    score_table = pd.DataFrame(data, columns=[&quot;姓名&quot;, &quot;语文&quot;, &quot;英语&quot;, &quot;数学&quot;])\n    print(score_table, &quot;\\n&quot;)\n\n    # 除去重复行\n    score_table.drop_duplicates(inplace=True)\n    print(score_table, &quot;\\n&quot;)\n\n    # 添加 总分 列\n    score_table.fillna(0, inplace=True)  # 将NaN替换为0\n    score_table[&quot;总分&quot;] = score_table[&quot;语文&quot;] + score_table[&quot;英语&quot;] + score_table[&quot;数学&quot;]\n    print(score_table)","like_count":2,"discussions":[{"author":{"id":1306094,"avatar":"https://static001.geekbang.org/account/avatar/00/13/ed/ee/c4779b67.jpg","nickname":"cy","note":"","ucode":"50D653399A31F6","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":434133,"discussion_content":"整理的不错，清洗张飞的数学成绩的时候，没有唯一答案。也可以用其他人的数学成绩平均值进行补全","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1545669596,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":53399,"user_name":"姜戈","can_delete":false,"product_type":"c1","uid":1058972,"ip_address":"","ucode":"45C4BE93C8E4CC","user_header":"https://static001.geekbang.org/account/avatar/00/10/28/9c/73e76b19.jpg","comment_is_top":false,"comment_ctime":1545638531,"is_pvip":false,"replies":[{"id":19430,"content":"整理的OK，基本上清洗的过程都会把重复的行去掉。针对张飞的数学成绩，既可以按照0统计，也可以按照其他人的平均值来统计（考虑可能是统计缺失，而非真正为0）","user_name":"作者回复","user_name_real":"cy","uid":1306094,"ctime":1545669832,"ip_address":"","comment_id":53399,"utype":1}],"discussion_count":1,"race_medal":0,"score":3,"product_id":100021701,"comment_content":"# -*- coding: utf-8 -*-\nimport pandas as pd\nfrom pandas import Series, DataFrame\n\ndata={&#39;语文&#39;:[66, 95, 95, 90, 80, 80],&#39;英语&#39;:[65, 85, 92, 88, 90,90], &#39;数学&#39;:[&#39;&#39;, 98, 96, 77, 90, 90]}\ndf1 = DataFrame(data, index=[&#39;张飞&#39;, &#39;关羽&#39;, &#39;赵云&#39;,&#39;刘备&#39;,&#39;典韦&#39;,&#39;典韦&#39;], columns=[&#39;语文&#39;,&#39;英语&#39;,&#39;数学&#39;])\nprint df1\ndf1 = df1.drop_duplicates()\nprint df1\n\ndf = df1.replace(to_replace=&#39;&#39;, value=0)\n\nprint df\n\ndf[&#39;总计&#39;]=df[&#39;语文&#39;]+df[&#39;英语&#39;]+df[&#39;数学&#39;]\ndf.replace(to_replace=0, value=&#39;&#39;, inplace=True)\nprint df","like_count":2,"discussions":[{"author":{"id":1306094,"avatar":"https://static001.geekbang.org/account/avatar/00/13/ed/ee/c4779b67.jpg","nickname":"cy","note":"","ucode":"50D653399A31F6","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":434128,"discussion_content":"整理的OK，基本上清洗的过程都会把重复的行去掉。针对张飞的数学成绩，既可以按照0统计，也可以按照其他人的平均值来统计（考虑可能是统计缺失，而非真正为0）","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1545669832,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":53345,"user_name":"mickey","can_delete":false,"product_type":"c1","uid":1051663,"ip_address":"","ucode":"8B490C2DDE4010","user_header":"https://static001.geekbang.org/account/avatar/00/10/0c/0f/93d1c8eb.jpg","comment_is_top":false,"comment_ctime":1545629208,"is_pvip":false,"replies":[{"id":19428,"content":"简洁，整理的不错\n其实还有一种清洗方法，即针对张飞的情况，数学成绩可以进行补全，比如用其他人的数学成绩平均值","user_name":"作者回复","user_name_real":"cy","uid":1306094,"ctime":1545669335,"ip_address":"","comment_id":53345,"utype":1}],"discussion_count":1,"race_medal":0,"score":3,"product_id":100021701,"comment_content":"#!&#47;usr&#47;bin&#47;python\n# vim: set fileencoding:utf-8\n&#39;&#39;&#39;\n1.对于下表的数据，请使用Pandas中的DataFrame进行创建，并对数据进行清洗。\n2.同时新增一列“总和”计算每个人的三科成绩之和。\n&#39;&#39;&#39;\nimport pandas as pd\nfrom pandas import DataFrame\n\n# 导入成绩\ndata = pd.read_excel(u&#39;成绩表.xlsx&#39;)\ndf = DataFrame(data)\nprint df\n\n\n# 求和，并增加一列“总和”\ndef addtotal(df):\n    df[u&#39;总和&#39;] = df[u&#39;语文&#39;] + df[u&#39;英语&#39;] + df[u&#39;数学&#39;]\n    return df\n\n\n# 清洗为空的数据\ndf1 = df.dropna()\n\n# 清洗重复的数据\ndf1 = df1.drop_duplicates()\n\n# 生成新数据结构\ndf1= df1.apply(addtotal, axis=1)\nprint(df1)","like_count":2,"discussions":[{"author":{"id":1306094,"avatar":"https://static001.geekbang.org/account/avatar/00/13/ed/ee/c4779b67.jpg","nickname":"cy","note":"","ucode":"50D653399A31F6","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":434104,"discussion_content":"简洁，整理的不错\n其实还有一种清洗方法，即针对张飞的情况，数学成绩可以进行补全，比如用其他人的数学成绩平均值","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1545669335,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":245084,"user_name":"郭 冲","can_delete":false,"product_type":"c1","uid":2140563,"ip_address":"","ucode":"BEB26269C6F053","user_header":"https://static001.geekbang.org/account/avatar/00/20/a9/93/3acddf29.jpg","comment_is_top":false,"comment_ctime":1598818711,"is_pvip":false,"replies":[{"id":103494,"content":"很棒！","user_name":"作者回复","user_name_real":"cy","uid":1306094,"ctime":1616687534,"ip_address":"","comment_id":245084,"utype":1}],"discussion_count":1,"race_medal":0,"score":3,"product_id":100021701,"comment_content":"#!&#47;usr&#47;bin&#47;env python3\n# -*- coding: utf-8 -*-\n\nimport pandas as pd\n\ndata = {&#39;语文&#39;: [66, 95, 95, 90, 80, 80],\n        &#39;英语&#39;: [65, 85, 92, 88, 90, 90],\n        &#39;数学&#39;: [None, 98, 96, 77, 90, 90]}\n\ndf_hw = DataFrame(data, \n                  index=[&#39;张飞&#39;, &#39;关羽&#39;, &#39;赵云&#39;, &#39;黄忠&#39;, &#39;典韦&#39;, &#39;典韦&#39;], \n                  columns=[&#39;语文&#39;, &#39;英语&#39;, &#39;数学&#39;])\n\n# 1.去除重复的值\ndf_hw = df_hw.drop_duplicates()\n\n# 2.查找空值\ndf_hw.isnull()\n\n# 3. 使用数学成绩均值填充张飞同学的缺失值\ndf_hw[&#39;数学&#39;].fillna(df_hw[&#39;数学&#39;].mean(), inplace=True)\n\n# 4.使用apply函数增加“总和”列\ndef sum_together(df):\n    df[&#39;总和&#39;] = df[&#39;语文&#39;] + df[&#39;英语&#39;] + df[&#39;数学&#39;]\n    return df\n\ndf_hw = df_hw.apply(sum_together,axis=1)\n\ndf_hw","like_count":1,"discussions":[{"author":{"id":1306094,"avatar":"https://static001.geekbang.org/account/avatar/00/13/ed/ee/c4779b67.jpg","nickname":"cy","note":"","ucode":"50D653399A31F6","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":504789,"discussion_content":"很棒！","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1616687534,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":220622,"user_name":"Ric","can_delete":false,"product_type":"c1","uid":1917008,"ip_address":"","ucode":"2CCABA029EE711","user_header":"https://static001.geekbang.org/account/avatar/00/1d/40/50/a960f038.jpg","comment_is_top":false,"comment_ctime":1590296653,"is_pvip":false,"replies":[{"id":103743,"content":"哈哈是的","user_name":"作者回复","user_name_real":"cy","uid":1306094,"ctime":1617040288,"ip_address":"","comment_id":220622,"utype":1}],"discussion_count":1,"race_medal":0,"score":3,"product_id":100021701,"comment_content":"Pandas加sql，威力無窮","like_count":1,"discussions":[{"author":{"id":1306094,"avatar":"https://static001.geekbang.org/account/avatar/00/13/ed/ee/c4779b67.jpg","nickname":"cy","note":"","ucode":"50D653399A31F6","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":496192,"discussion_content":"哈哈是的","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1617040288,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":151133,"user_name":"GS","can_delete":false,"product_type":"c1","uid":1042618,"ip_address":"","ucode":"21C73A8CBD8093","user_header":"https://static001.geekbang.org/account/avatar/00/0f/e8/ba/6d318c08.jpg","comment_is_top":false,"comment_ctime":1573656757,"is_pvip":false,"replies":[{"id":62669,"content":"嗯嗯 多谢分享","user_name":"作者回复","user_name_real":"cy","uid":1306094,"ctime":1577082378,"ip_address":"","comment_id":151133,"utype":1}],"discussion_count":1,"race_medal":0,"score":3,"product_id":100021701,"comment_content":"https:&#47;&#47;github.com&#47;leledada&#47;jupyter&#47;blob&#47;master&#47;PandasTest.ipynb   用Jupter写了一遍。\n\npandasql  为什么要 import load_meat, load_births ？ 做什么用的？这个我要查一查","like_count":1,"discussions":[{"author":{"id":1306094,"avatar":"https://static001.geekbang.org/account/avatar/00/13/ed/ee/c4779b67.jpg","nickname":"cy","note":"","ucode":"50D653399A31F6","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":474374,"discussion_content":"嗯嗯 多谢分享","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1577082378,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":67079,"user_name":"Dull","can_delete":false,"product_type":"c1","uid":1347024,"ip_address":"","ucode":"A69F4D8E8CD1EA","user_header":"https://static001.geekbang.org/account/avatar/00/14/8d/d0/34e6a27d.jpg","comment_is_top":false,"comment_ctime":1550068341,"is_pvip":false,"replies":[{"id":64572,"content":"Good Job","user_name":"作者回复","user_name_real":"cy","uid":1306094,"ctime":1577621891,"ip_address":"","comment_id":67079,"utype":1}],"discussion_count":1,"race_medal":0,"score":3,"product_id":100021701,"comment_content":"使用Pyhon3.7+Pycharm编写，最后使用sort_value.()方法对总成绩进行降序排序。\n# -*- coding: utf-8 -*-\nimport pandas as pd\nfrom pandas import Series, DataFrame\ndata = {&#39;Chinese&#39;: [66, 95, 95, 90,80,80],&#39;English&#39;: [65, 85, 92, 88, 90,90],&#39;Math&#39;: [None, 98, 96, 77, 90,90]}\ndf = DataFrame(data,index=[&#39;张飞&#39;,&#39;关羽&#39;,&#39;赵云&#39;,&#39;黄忠&#39;,&#39;典韦&#39;,&#39;典韦&#39;],columns=[&#39;Chinese&#39;,&#39;English&#39;,&#39;Math&#39;])\nprint(df)\ndf = df.drop_duplicates()\ndf.rename(columns = {&#39;Chinese&#39;:&#39;语文&#39;,&#39;English&#39;:&#39;英语&#39;,&#39;Math&#39;:&#39;数学&#39;}, inplace = True)\ndf[&#39;数学&#39;].fillna(df[&#39;数学&#39;].mean(),inplace=True)  #df.fillna(df.mean())好像也可以\ndef new(df):\n\tdf[&#39;总分&#39;] = (df[&#39;语文&#39;]+df[&#39;数学&#39;]+df[&#39;英语&#39;])\n\treturn df\ndf = df.apply(new,axis=1)\nprint(df)\ndf1 = df.sort_values(by=[&#39;总分&#39;],ascending=False)\nprint(df1)","like_count":1,"discussions":[{"author":{"id":1306094,"avatar":"https://static001.geekbang.org/account/avatar/00/13/ed/ee/c4779b67.jpg","nickname":"cy","note":"","ucode":"50D653399A31F6","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":439044,"discussion_content":"Good Job","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1577621891,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":284875,"user_name":"笨鸟的GPS","can_delete":false,"product_type":"c1","uid":2489987,"ip_address":"","ucode":"62B321A5424FD9","user_header":"https://static001.geekbang.org/account/avatar/00/25/fe/83/b2e833ff.jpg","comment_is_top":false,"comment_ctime":1616506362,"is_pvip":false,"replies":[{"id":103395,"content":"很棒！填充空值也可以直接使用df=df.fillna(30)","user_name":"作者回复","user_name_real":"cy","uid":1306094,"ctime":1616598759,"ip_address":"","comment_id":284875,"utype":1}],"discussion_count":1,"race_medal":0,"score":3,"product_id":100021701,"comment_content":"# 创建dataframe\nimport pandas as pd\nfrom pandas import Series,DataFrame\ndata = {&#39;chinese&#39;:[66,95,95,90,80,80],&#39;english&#39;:[65,85,92,88,90,90],&#39;math&#39;:[&#39;&#39;,98,96,77,90,90]}\ndf2 = DataFrame(data,index=[&#39;zhangfei&#39;,&#39;guanyu&#39;,&#39;zhaoyun&#39;,&#39;huangzhong&#39;,&#39;dianwei&#39;,&#39;dianwei&#39;],columns=[&#39;chinese&#39;,&#39;english&#39;,&#39;math&#39;])\n# 去重\ndf2 = df2.drop_duplicates()\n# 填充缺失值\ndf2.loc[&#39;zhangfei&#39;,&#39;math&#39;] = 30\n# 新增总和\ndf2[&#39;total&#39;] = df2[&#39;chinese&#39;] +df2[&#39;english&#39;] + df2[&#39;math&#39;]","like_count":0,"discussions":[{"author":{"id":1306094,"avatar":"https://static001.geekbang.org/account/avatar/00/13/ed/ee/c4779b67.jpg","nickname":"cy","note":"","ucode":"50D653399A31F6","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":517496,"discussion_content":"很棒！填充空值也可以直接使用df=df.fillna(30)","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1616598759,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":270487,"user_name":"木头发芽","can_delete":false,"product_type":"c1","uid":1419723,"ip_address":"","ucode":"657B381C5DA963","user_header":"https://static001.geekbang.org/account/avatar/00/15/a9/cb/a431bde5.jpg","comment_is_top":false,"comment_ctime":1609144463,"is_pvip":false,"replies":[{"id":100869,"content":"继续加油","user_name":"作者回复","user_name_real":"cy","uid":1306094,"ctime":1612705693,"ip_address":"","comment_id":270487,"utype":1}],"discussion_count":1,"race_medal":0,"score":3,"product_id":100021701,"comment_content":"一通百通,这节的DataFrame跟Spark的DataFrame的各种操作几乎一样,虽然底层实现原理有差别,但用法是一样的. 所以说要做T型人才,当一个方向钻的够深,就能触类旁通.","like_count":0,"discussions":[{"author":{"id":1306094,"avatar":"https://static001.geekbang.org/account/avatar/00/13/ed/ee/c4779b67.jpg","nickname":"cy","note":"","ucode":"50D653399A31F6","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":512647,"discussion_content":"继续加油","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1612705693,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":73083,"user_name":"初","can_delete":false,"product_type":"c1","uid":1187792,"ip_address":"","ucode":"E124D8A566DA43","user_header":"https://static001.geekbang.org/account/avatar/00/12/1f/d0/660502a4.jpg","comment_is_top":false,"comment_ctime":1551794123,"is_pvip":false,"replies":[{"id":64462,"content":"哈哈","user_name":"作者回复","user_name_real":"cy","uid":1306094,"ctime":1577619584,"ip_address":"","comment_id":73083,"utype":1}],"discussion_count":1,"race_medal":0,"score":3,"product_id":100021701,"comment_content":"None竟然是浮点型数据....没想到","like_count":2,"discussions":[{"author":{"id":1306094,"avatar":"https://static001.geekbang.org/account/avatar/00/13/ed/ee/c4779b67.jpg","nickname":"cy","note":"","ucode":"50D653399A31F6","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":441904,"discussion_content":"哈哈","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1577619584,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":53420,"user_name":"lingmacker","can_delete":false,"product_type":"c1","uid":1353113,"ip_address":"","ucode":"2B61674AD47F34","user_header":"https://static001.geekbang.org/account/avatar/00/14/a5/99/db2f6325.jpg","comment_is_top":false,"comment_ctime":1545640624,"is_pvip":false,"replies":[{"id":19429,"content":"整理的不错，清洗张飞的数学成绩的时候，没有唯一答案。也可以用其他人的数学成绩平均值进行补全","user_name":"作者回复","user_name_real":"cy","uid":1306094,"ctime":1545669596,"ip_address":"","comment_id":53420,"utype":1}],"discussion_count":1,"race_medal":0,"score":3,"product_id":100021701,"comment_content":"def exercise():\n    # 1. 对于下表的数据，请使用Pandas中的DataFrame进行创建，并对数据进行清洗。\n    # 2. 同时新增一列“总和”计算每个人的三科成绩之和。\n\n    # 列名使用了中文，打印需要列对其的话，则需要设置这两个参数\n    pd.set_option(&#39;display.unicode.ambiguous_as_wide&#39;, True)\n    pd.set_option(&#39;display.unicode.east_asian_width&#39;, True)\n\n    data = {&quot;姓名&quot;: [&quot;张飞&quot;, &quot;关羽&quot;, &quot;赵云&quot;, &quot;黄忠&quot;, &quot;典韦&quot;, &quot;典韦&quot;],\n            &quot;语文&quot;: [66, 95, 95, 90, 80, 80],\n            &quot;英语&quot;: [65, 85, 92, 88, 90, 90],\n            &quot;数学&quot;: [None, 98, 96, 77, 90, 90]}\n    \n    score_table = pd.DataFrame(data, columns=[&quot;姓名&quot;, &quot;语文&quot;, &quot;英语&quot;, &quot;数学&quot;])\n    print(score_table, &quot;\\n&quot;)\n\n    # 除去重复行\n    score_table.drop_duplicates(inplace=True)\n    print(score_table, &quot;\\n&quot;)\n\n    # 添加 总分 列\n    score_table.fillna(0, inplace=True)  # 将NaN替换为0\n    score_table[&quot;总分&quot;] = score_table[&quot;语文&quot;] + score_table[&quot;英语&quot;] + score_table[&quot;数学&quot;]\n    print(score_table)","like_count":2,"discussions":[{"author":{"id":1306094,"avatar":"https://static001.geekbang.org/account/avatar/00/13/ed/ee/c4779b67.jpg","nickname":"cy","note":"","ucode":"50D653399A31F6","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":441904,"discussion_content":"哈哈","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1577619584,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":53399,"user_name":"姜戈","can_delete":false,"product_type":"c1","uid":1058972,"ip_address":"","ucode":"45C4BE93C8E4CC","user_header":"https://static001.geekbang.org/account/avatar/00/10/28/9c/73e76b19.jpg","comment_is_top":false,"comment_ctime":1545638531,"is_pvip":false,"replies":[{"id":19430,"content":"整理的OK，基本上清洗的过程都会把重复的行去掉。针对张飞的数学成绩，既可以按照0统计，也可以按照其他人的平均值来统计（考虑可能是统计缺失，而非真正为0）","user_name":"作者回复","user_name_real":"cy","uid":1306094,"ctime":1545669832,"ip_address":"","comment_id":53399,"utype":1}],"discussion_count":1,"race_medal":0,"score":3,"product_id":100021701,"comment_content":"# -*- coding: utf-8 -*-\nimport pandas as pd\nfrom pandas import Series, DataFrame\n\ndata={&#39;语文&#39;:[66, 95, 95, 90, 80, 80],&#39;英语&#39;:[65, 85, 92, 88, 90,90], &#39;数学&#39;:[&#39;&#39;, 98, 96, 77, 90, 90]}\ndf1 = DataFrame(data, index=[&#39;张飞&#39;, &#39;关羽&#39;, &#39;赵云&#39;,&#39;刘备&#39;,&#39;典韦&#39;,&#39;典韦&#39;], columns=[&#39;语文&#39;,&#39;英语&#39;,&#39;数学&#39;])\nprint df1\ndf1 = df1.drop_duplicates()\nprint df1\n\ndf = df1.replace(to_replace=&#39;&#39;, value=0)\n\nprint df\n\ndf[&#39;总计&#39;]=df[&#39;语文&#39;]+df[&#39;英语&#39;]+df[&#39;数学&#39;]\ndf.replace(to_replace=0, value=&#39;&#39;, inplace=True)\nprint df","like_count":2,"discussions":[{"author":{"id":1306094,"avatar":"https://static001.geekbang.org/account/avatar/00/13/ed/ee/c4779b67.jpg","nickname":"cy","note":"","ucode":"50D653399A31F6","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":434133,"discussion_content":"整理的不错，清洗张飞的数学成绩的时候，没有唯一答案。也可以用其他人的数学成绩平均值进行补全","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1545669596,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":53345,"user_name":"mickey","can_delete":false,"product_type":"c1","uid":1051663,"ip_address":"","ucode":"8B490C2DDE4010","user_header":"https://static001.geekbang.org/account/avatar/00/10/0c/0f/93d1c8eb.jpg","comment_is_top":false,"comment_ctime":1545629208,"is_pvip":false,"replies":[{"id":19428,"content":"简洁，整理的不错\n其实还有一种清洗方法，即针对张飞的情况，数学成绩可以进行补全，比如用其他人的数学成绩平均值","user_name":"作者回复","user_name_real":"cy","uid":1306094,"ctime":1545669335,"ip_address":"","comment_id":53345,"utype":1}],"discussion_count":1,"race_medal":0,"score":3,"product_id":100021701,"comment_content":"#!&#47;usr&#47;bin&#47;python\n# vim: set fileencoding:utf-8\n&#39;&#39;&#39;\n1.对于下表的数据，请使用Pandas中的DataFrame进行创建，并对数据进行清洗。\n2.同时新增一列“总和”计算每个人的三科成绩之和。\n&#39;&#39;&#39;\nimport pandas as pd\nfrom pandas import DataFrame\n\n# 导入成绩\ndata = pd.read_excel(u&#39;成绩表.xlsx&#39;)\ndf = DataFrame(data)\nprint df\n\n\n# 求和，并增加一列“总和”\ndef addtotal(df):\n    df[u&#39;总和&#39;] = df[u&#39;语文&#39;] + df[u&#39;英语&#39;] + df[u&#39;数学&#39;]\n    return df\n\n\n# 清洗为空的数据\ndf1 = df.dropna()\n\n# 清洗重复的数据\ndf1 = df1.drop_duplicates()\n\n# 生成新数据结构\ndf1= df1.apply(addtotal, axis=1)\nprint(df1)","like_count":2,"discussions":[{"author":{"id":1306094,"avatar":"https://static001.geekbang.org/account/avatar/00/13/ed/ee/c4779b67.jpg","nickname":"cy","note":"","ucode":"50D653399A31F6","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":434128,"discussion_content":"整理的OK，基本上清洗的过程都会把重复的行去掉。针对张飞的数学成绩，既可以按照0统计，也可以按照其他人的平均值来统计（考虑可能是统计缺失，而非真正为0）","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1545669832,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":245084,"user_name":"郭 冲","can_delete":false,"product_type":"c1","uid":2140563,"ip_address":"","ucode":"BEB26269C6F053","user_header":"https://static001.geekbang.org/account/avatar/00/20/a9/93/3acddf29.jpg","comment_is_top":false,"comment_ctime":1598818711,"is_pvip":false,"replies":[{"id":103494,"content":"很棒！","user_name":"作者回复","user_name_real":"cy","uid":1306094,"ctime":1616687534,"ip_address":"","comment_id":245084,"utype":1}],"discussion_count":1,"race_medal":0,"score":3,"product_id":100021701,"comment_content":"#!&#47;usr&#47;bin&#47;env python3\n# -*- coding: utf-8 -*-\n\nimport pandas as pd\n\ndata = {&#39;语文&#39;: [66, 95, 95, 90, 80, 80],\n        &#39;英语&#39;: [65, 85, 92, 88, 90, 90],\n        &#39;数学&#39;: [None, 98, 96, 77, 90, 90]}\n\ndf_hw = DataFrame(data, \n                  index=[&#39;张飞&#39;, &#39;关羽&#39;, &#39;赵云&#39;, &#39;黄忠&#39;, &#39;典韦&#39;, &#39;典韦&#39;], \n                  columns=[&#39;语文&#39;, &#39;英语&#39;, &#39;数学&#39;])\n\n# 1.去除重复的值\ndf_hw = df_hw.drop_duplicates()\n\n# 2.查找空值\ndf_hw.isnull()\n\n# 3. 使用数学成绩均值填充张飞同学的缺失值\ndf_hw[&#39;数学&#39;].fillna(df_hw[&#39;数学&#39;].mean(), inplace=True)\n\n# 4.使用apply函数增加“总和”列\ndef sum_together(df):\n    df[&#39;总和&#39;] = df[&#39;语文&#39;] + df[&#39;英语&#39;] + df[&#39;数学&#39;]\n    return df\n\ndf_hw = df_hw.apply(sum_together,axis=1)\n\ndf_hw","like_count":1,"discussions":[{"author":{"id":1306094,"avatar":"https://static001.geekbang.org/account/avatar/00/13/ed/ee/c4779b67.jpg","nickname":"cy","note":"","ucode":"50D653399A31F6","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":434104,"discussion_content":"简洁，整理的不错\n其实还有一种清洗方法，即针对张飞的情况，数学成绩可以进行补全，比如用其他人的数学成绩平均值","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1545669335,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":220622,"user_name":"Ric","can_delete":false,"product_type":"c1","uid":1917008,"ip_address":"","ucode":"2CCABA029EE711","user_header":"https://static001.geekbang.org/account/avatar/00/1d/40/50/a960f038.jpg","comment_is_top":false,"comment_ctime":1590296653,"is_pvip":false,"replies":[{"id":103743,"content":"哈哈是的","user_name":"作者回复","user_name_real":"cy","uid":1306094,"ctime":1617040288,"ip_address":"","comment_id":220622,"utype":1}],"discussion_count":1,"race_medal":0,"score":3,"product_id":100021701,"comment_content":"Pandas加sql，威力無窮","like_count":1,"discussions":[{"author":{"id":1306094,"avatar":"https://static001.geekbang.org/account/avatar/00/13/ed/ee/c4779b67.jpg","nickname":"cy","note":"","ucode":"50D653399A31F6","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":504789,"discussion_content":"很棒！","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1616687534,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":151133,"user_name":"GS","can_delete":false,"product_type":"c1","uid":1042618,"ip_address":"","ucode":"21C73A8CBD8093","user_header":"https://static001.geekbang.org/account/avatar/00/0f/e8/ba/6d318c08.jpg","comment_is_top":false,"comment_ctime":1573656757,"is_pvip":false,"replies":[{"id":62669,"content":"嗯嗯 多谢分享","user_name":"作者回复","user_name_real":"cy","uid":1306094,"ctime":1577082378,"ip_address":"","comment_id":151133,"utype":1}],"discussion_count":1,"race_medal":0,"score":3,"product_id":100021701,"comment_content":"https:&#47;&#47;github.com&#47;leledada&#47;jupyter&#47;blob&#47;master&#47;PandasTest.ipynb   用Jupter写了一遍。\n\npandasql  为什么要 import load_meat, load_births ？ 做什么用的？这个我要查一查","like_count":1,"discussions":[{"author":{"id":1306094,"avatar":"https://static001.geekbang.org/account/avatar/00/13/ed/ee/c4779b67.jpg","nickname":"cy","note":"","ucode":"50D653399A31F6","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":496192,"discussion_content":"哈哈是的","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1617040288,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":67079,"user_name":"Dull","can_delete":false,"product_type":"c1","uid":1347024,"ip_address":"","ucode":"A69F4D8E8CD1EA","user_header":"https://static001.geekbang.org/account/avatar/00/14/8d/d0/34e6a27d.jpg","comment_is_top":false,"comment_ctime":1550068341,"is_pvip":false,"replies":[{"id":64572,"content":"Good Job","user_name":"作者回复","user_name_real":"cy","uid":1306094,"ctime":1577621891,"ip_address":"","comment_id":67079,"utype":1}],"discussion_count":1,"race_medal":0,"score":3,"product_id":100021701,"comment_content":"使用Pyhon3.7+Pycharm编写，最后使用sort_value.()方法对总成绩进行降序排序。\n# -*- coding: utf-8 -*-\nimport pandas as pd\nfrom pandas import Series, DataFrame\ndata = {&#39;Chinese&#39;: [66, 95, 95, 90,80,80],&#39;English&#39;: [65, 85, 92, 88, 90,90],&#39;Math&#39;: [None, 98, 96, 77, 90,90]}\ndf = DataFrame(data,index=[&#39;张飞&#39;,&#39;关羽&#39;,&#39;赵云&#39;,&#39;黄忠&#39;,&#39;典韦&#39;,&#39;典韦&#39;],columns=[&#39;Chinese&#39;,&#39;English&#39;,&#39;Math&#39;])\nprint(df)\ndf = df.drop_duplicates()\ndf.rename(columns = {&#39;Chinese&#39;:&#39;语文&#39;,&#39;English&#39;:&#39;英语&#39;,&#39;Math&#39;:&#39;数学&#39;}, inplace = True)\ndf[&#39;数学&#39;].fillna(df[&#39;数学&#39;].mean(),inplace=True)  #df.fillna(df.mean())好像也可以\ndef new(df):\n\tdf[&#39;总分&#39;] = (df[&#39;语文&#39;]+df[&#39;数学&#39;]+df[&#39;英语&#39;])\n\treturn df\ndf = df.apply(new,axis=1)\nprint(df)\ndf1 = df.sort_values(by=[&#39;总分&#39;],ascending=False)\nprint(df1)","like_count":1,"discussions":[{"author":{"id":1306094,"avatar":"https://static001.geekbang.org/account/avatar/00/13/ed/ee/c4779b67.jpg","nickname":"cy","note":"","ucode":"50D653399A31F6","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":474374,"discussion_content":"嗯嗯 多谢分享","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1577082378,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":284875,"user_name":"笨鸟的GPS","can_delete":false,"product_type":"c1","uid":2489987,"ip_address":"","ucode":"62B321A5424FD9","user_header":"https://static001.geekbang.org/account/avatar/00/25/fe/83/b2e833ff.jpg","comment_is_top":false,"comment_ctime":1616506362,"is_pvip":false,"replies":[{"id":103395,"content":"很棒！填充空值也可以直接使用df=df.fillna(30)","user_name":"作者回复","user_name_real":"cy","uid":1306094,"ctime":1616598759,"ip_address":"","comment_id":284875,"utype":1}],"discussion_count":1,"race_medal":0,"score":3,"product_id":100021701,"comment_content":"# 创建dataframe\nimport pandas as pd\nfrom pandas import Series,DataFrame\ndata = {&#39;chinese&#39;:[66,95,95,90,80,80],&#39;english&#39;:[65,85,92,88,90,90],&#39;math&#39;:[&#39;&#39;,98,96,77,90,90]}\ndf2 = DataFrame(data,index=[&#39;zhangfei&#39;,&#39;guanyu&#39;,&#39;zhaoyun&#39;,&#39;huangzhong&#39;,&#39;dianwei&#39;,&#39;dianwei&#39;],columns=[&#39;chinese&#39;,&#39;english&#39;,&#39;math&#39;])\n# 去重\ndf2 = df2.drop_duplicates()\n# 填充缺失值\ndf2.loc[&#39;zhangfei&#39;,&#39;math&#39;] = 30\n# 新增总和\ndf2[&#39;total&#39;] = df2[&#39;chinese&#39;] +df2[&#39;english&#39;] + df2[&#39;math&#39;]","like_count":0,"discussions":[{"author":{"id":1306094,"avatar":"https://static001.geekbang.org/account/avatar/00/13/ed/ee/c4779b67.jpg","nickname":"cy","note":"","ucode":"50D653399A31F6","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":439044,"discussion_content":"Good Job","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1577621891,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":270487,"user_name":"木头发芽","can_delete":false,"product_type":"c1","uid":1419723,"ip_address":"","ucode":"657B381C5DA963","user_header":"https://static001.geekbang.org/account/avatar/00/15/a9/cb/a431bde5.jpg","comment_is_top":false,"comment_ctime":1609144463,"is_pvip":false,"replies":[{"id":100869,"content":"继续加油","user_name":"作者回复","user_name_real":"cy","uid":1306094,"ctime":1612705693,"ip_address":"","comment_id":270487,"utype":1}],"discussion_count":1,"race_medal":0,"score":3,"product_id":100021701,"comment_content":"一通百通,这节的DataFrame跟Spark的DataFrame的各种操作几乎一样,虽然底层实现原理有差别,但用法是一样的. 所以说要做T型人才,当一个方向钻的够深,就能触类旁通.","like_count":0,"discussions":[{"author":{"id":1306094,"avatar":"https://static001.geekbang.org/account/avatar/00/13/ed/ee/c4779b67.jpg","nickname":"cy","note":"","ucode":"50D653399A31F6","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":517496,"discussion_content":"很棒！填充空值也可以直接使用df=df.fillna(30)","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1616598759,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":248530,"user_name":"NLPer","can_delete":false,"product_type":"c1","uid":2087512,"ip_address":"","ucode":"CD3A997F9BE13B","user_header":"https://static001.geekbang.org/account/avatar/00/1f/da/58/2c36d211.jpg","comment_is_top":false,"comment_ctime":1600214788,"is_pvip":false,"replies":[{"id":103058,"content":"很棒哦！","user_name":"作者回复","user_name_real":"cy","uid":1306094,"ctime":1616082499,"ip_address":"","comment_id":248530,"utype":1}],"discussion_count":1,"race_medal":0,"score":4,"product_id":100021701,"comment_content":"老师，我准备做个笔记分享给更多的人😁","like_count":0},{"had_liked":false,"id":245016,"user_name":"拾光","can_delete":false,"product_type":"c1","uid":2087581,"ip_address":"","ucode":"3F88BAB08EF775","user_header":"https://static001.geekbang.org/account/avatar/00/1f/da/9d/1f825568.jpg","comment_is_top":false,"comment_ctime":1598783689,"is_pvip":false,"replies":[{"id":103496,"content":"很棒。数据清洗时，遇到空值可以删除等方式处理，这里是统计班级内同学的成绩，如果直接因为存在一科成绩空值就直接删除他的所有成绩，不太符合实际业务场景的需要。","user_name":"作者回复","user_name_real":"cy","uid":1306094,"ctime":1616688820,"ip_address":"","comment_id":245016,"utype":1}],"discussion_count":1,"race_medal":0,"score":4,"product_id":100021701,"comment_content":"import pandas as pd\n\n# 创建DataFrame，列名是：&#39;name&#39;、&#39;gender&#39;、&#39;age&#39;\ndf = pd.DataFrame([[&#39;Snow&#39;,83,97],\n                   [&#39;Tyrion&#39;,78,82,92],\n                   [&#39;Sansa&#39;,76,88,98],\n                   [&#39;Arya&#39;,95,78,64]], columns=[&#39;姓名&#39;,&#39;语文&#39;,&#39;英语&#39;, &#39;数学&#39;],index=None)\n\n# 清洗数据\ndf.dropna(axis=0, how=&#39;any&#39;, inplace=True)\n\ndf[&#39;总分&#39;] = df[&#39;语文&#39;] + df[&#39;英语&#39;] + df[&#39;数学&#39;]\nprint(df)","like_count":0,"discussions":[{"author":{"id":1306094,"avatar":"https://static001.geekbang.org/account/avatar/00/13/ed/ee/c4779b67.jpg","nickname":"cy","note":"","ucode":"50D653399A31F6","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":504770,"discussion_content":"很棒。数据清洗时，遇到空值可以删除等方式处理，这里是统计班级内同学的成绩，如果直接因为存在一科成绩空值就直接删除他的所有成绩，不太符合实际业务场景的需要。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1616688820,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":244415,"user_name":"包家欢","can_delete":false,"product_type":"c1","uid":1804112,"ip_address":"","ucode":"9B18C661D96430","user_header":"https://static001.geekbang.org/account/avatar/00/1b/87/50/fd4b6d5d.jpg","comment_is_top":false,"comment_ctime":1598510247,"is_pvip":false,"replies":[{"id":103500,"content":"print(type(data1))你会看到，data1是字典类型，而fillna()是pandas中DataFrame的方法，因此需要先将data1转为DataFrame:\ndf = pd.DataFrame(data1)\n# 将数学列中空字符串替换为0\n df[&#39;数学&#39;].apply(lambda x: 0 if x == &#39;&#39; else x)\n# 调整数据类型为整数型\ndf = df.astype(&#39;int&#39;)","user_name":"作者回复","user_name_real":"cy","uid":1306094,"ctime":1616689352,"ip_address":"","comment_id":244415,"utype":1}],"discussion_count":1,"race_medal":0,"score":4,"product_id":100021701,"comment_content":"data1 = {&#39;语文&#39;:[&#39;66&#39;,&#39;95&#39;,&#39;95&#39;,&#39;90&#39;,&#39;80&#39;,&#39;80&#39;],&#39;英语&#39;:[&#39;65&#39;,&#39;85&#39;,&#39;92&#39;,&#39;88&#39;,&#39;90&#39;,&#39;90&#39;],&#39;数学&#39;:[&#39;&#39;,&#39;98&#39;,&#39;96&#39;,&#39;77&#39;,&#39;90&#39;,&#39;90&#39;]}\n\n这种自定义的空字符串用不了fillna()，请问下这块，怎么进行处理？","like_count":0,"discussions":[{"author":{"id":1306094,"avatar":"https://static001.geekbang.org/account/avatar/00/13/ed/ee/c4779b67.jpg","nickname":"cy","note":"","ucode":"50D653399A31F6","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":504575,"discussion_content":"print(type(data1))你会看到，data1是字典类型，而fillna()是pandas中DataFrame的方法，因此需要先将data1转为DataFrame:\ndf = pd.DataFrame(data1)\n# 将数学列中空字符串替换为0\n df[&amp;#39;数学&amp;#39;].apply(lambda x: 0 if x == &amp;#39;&amp;#39; else x)\n# 调整数据类型为整数型\ndf = df.astype(&amp;#39;int&amp;#39;)","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1616689352,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":243702,"user_name":"酱油不好打","can_delete":false,"product_type":"c1","uid":2141903,"ip_address":"","ucode":"C20B4FD4E32802","user_header":"https://static001.geekbang.org/account/avatar/00/20/ae/cf/dad08a72.jpg","comment_is_top":false,"comment_ctime":1598253069,"is_pvip":false,"replies":[{"id":103065,"content":"df.dropna()后，张飞同学的成绩就被删除了；可以使用df.fillna(0)来填充空值；\n典韦同学有2条成绩，建议drop_duplicates()去除重复行。","user_name":"作者回复","user_name_real":"cy","uid":1306094,"ctime":1616085052,"ip_address":"","comment_id":243702,"utype":1}],"discussion_count":1,"race_medal":0,"score":4,"product_id":100021701,"comment_content":"import pandas as pd\ndata = {&#39;语文&#39;: [66, 95, 93, 90, 80, 80], &#39;英语&#39;: [65, 85, 92, 88, 90, 90],\n        &#39;数学&#39;: [None, 98, 96, 77, 90, 90]}\ndf = pd.DataFrame(data, index=[&#39;张飞&#39;, &#39;关羽&#39;, &#39;赵云&#39;, &#39;黄忠&#39;, &#39;典韦&#39;, &#39;典韦&#39;],\n                  columns=[u&#39;英语&#39;, u&#39;数学&#39;, u&#39;语文&#39;])\ndf=df.dropna()\ndf[u&#39;总和&#39;] = df[u&#39;语文&#39;]+df[u&#39;英语&#39;]+df[u&#39;数学&#39;]\ndf.head()","like_count":0,"discussions":[{"author":{"id":1306094,"avatar":"https://static001.geekbang.org/account/avatar/00/13/ed/ee/c4779b67.jpg","nickname":"cy","note":"","ucode":"50D653399A31F6","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":504366,"discussion_content":"df.dropna()后，张飞同学的成绩就被删除了；可以使用df.fillna(0)来填充空值；\n典韦同学有2条成绩，建议drop_duplicates()去除重复行。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1616085052,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":239074,"user_name":"落空","can_delete":false,"product_type":"c1","uid":1674783,"ip_address":"","ucode":"EC6AD8FC982697","user_header":"https://static001.geekbang.org/account/avatar/00/19/8e/1f/f96bd42d.jpg","comment_is_top":false,"comment_ctime":1596427674,"is_pvip":false,"replies":[{"id":103504,"content":"正确","user_name":"作者回复","user_name_real":"cy","uid":1306094,"ctime":1616690318,"ip_address":"","comment_id":239074,"utype":1}],"discussion_count":1,"race_medal":0,"score":4,"product_id":100021701,"comment_content":"#使用Jupyter Notebook编写\n#版本：python 3.6\nimport pandas as pd\n\n#新建DataFrame成绩单\ndata = {&#39;Chinese&#39;: [66, 95, 93, 90, 80, 80], &#39;English&#39;: [65, 85, 92, 88, 90, 90],\n        &#39;Math&#39;: [None, 98, 96, 77, 90, 90]}\ndf = pd.DataFrame(data, index=[&#39;张飞&#39;, &#39;关羽&#39;, &#39;赵云&#39;, &#39;黄忠&#39;, &#39;典韦&#39;, &#39;典韦&#39;],\n                  columns=[&#39;English&#39;, &#39;Math&#39;, &#39;Chinese&#39;])\n\n#查看数据情况\ndf.info()  #可以查看缺失值等情况\ndf.describe() #描述性统计常见统计值\n\n#处理缺失值，用均值填充\ndf[&#39;Math&#39;].fillna(df[&#39;Math&#39;].mean(), inplace=True)\ndf[&#39;Math&#39;] = df[&#39;Math&#39;].astype(int)\n# 去除重复行\ndf = df.drop_duplicates()\n#计算成绩总和\ndf[&#39;总和&#39;] = df.eval(&quot;English + Math + Chinese&quot;)\n#成绩排个序\ndf = df.sort_values(&#39;总和&#39;,ascending=False)","like_count":0,"discussions":[{"author":{"id":1306094,"avatar":"https://static001.geekbang.org/account/avatar/00/13/ed/ee/c4779b67.jpg","nickname":"cy","note":"","ucode":"50D653399A31F6","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":504366,"discussion_content":"df.dropna()后，张飞同学的成绩就被删除了；可以使用df.fillna(0)来填充空值；\n典韦同学有2条成绩，建议drop_duplicates()去除重复行。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1616085052,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":236919,"user_name":"liubin","can_delete":false,"product_type":"c1","uid":1908013,"ip_address":"","ucode":"69F7B261F81EE6","user_header":"http://thirdwx.qlogo.cn/mmopen/vi_32/twibiaV0K4L2f8wTjCjRYp3IFOHg4um1cgj233ibJVicmjF1Qsb7JFib6icBkFu68kT0ueMIA89GcXfv9g3InkGViciaRQ/132","comment_is_top":false,"comment_ctime":1595584921,"is_pvip":false,"replies":[{"id":103506,"content":"终端安装命令：pip install pandasql\nPython中调包命令：from pandasql import sqldf      \n同学检查下代码哦","user_name":"作者回复","user_name_real":"cy","uid":1306094,"ctime":1616691206,"ip_address":"","comment_id":236919,"utype":1}],"discussion_count":1,"race_medal":0,"score":4,"product_id":100021701,"comment_content":"ImportError: cannot import name &#39;sqldf&#39;  我安装了sqldf还是报这个错","like_count":0,"discussions":[{"author":{"id":1306094,"avatar":"https://static001.geekbang.org/account/avatar/00/13/ed/ee/c4779b67.jpg","nickname":"cy","note":"","ucode":"50D653399A31F6","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":502967,"discussion_content":"正确","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1616690318,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":233426,"user_name":"CHEN","can_delete":false,"product_type":"c1","uid":2058384,"ip_address":"","ucode":"5B9BA6F6C83F58","user_header":"https://static001.geekbang.org/account/avatar/00/1f/68/90/ca86abe3.jpg","comment_is_top":false,"comment_ctime":1594312425,"is_pvip":false,"replies":[{"id":103516,"content":"正确。scores的index没有意义，写入CSV文件时，可以通过参数index=False来舍弃写入index","user_name":"作者回复","user_name_real":"cy","uid":1306094,"ctime":1616694189,"ip_address":"","comment_id":233426,"utype":1}],"discussion_count":1,"race_medal":0,"score":4,"product_id":100021701,"comment_content":"import pandas as pd\nimport numpy as np\n\nscores = pd.DataFrame(\n    {&quot;语文&quot;: [66, 95, 95, 90, 80, 80], &quot;英语&quot;: [65, 85, 92, 88, 90, 90], &quot;数学&quot;: [np.nan, 98, 96, 77, 90, 90]},\n    index=[&#39;张飞&#39;, &#39;关羽&#39;, &#39;赵云&#39;, &#39;黄忠&#39;, &#39;典韦&#39;, &#39;典韦&#39;]\n)\n# 去重\nscores = scores.drop_duplicates()\n# 替换NaN值\nprint(scores.isnull().any())  #查看哪一列有空值\nscores = scores.fillna(scores[&#39;数学&#39;].mean())\n# 增加一行统计\nscores[&#39;总分&#39;] = scores.sum(axis=1)\n# 按总分倒序排列\nscores = scores.sort_values(by=&quot;总分&quot;, ascending=False)\nprint(scores)\n\n#输出清洗结果到csv文件进行保存\nscores.to_csv(&#39;scores.csv&#39;)","like_count":0,"discussions":[{"author":{"id":1306094,"avatar":"https://static001.geekbang.org/account/avatar/00/13/ed/ee/c4779b67.jpg","nickname":"cy","note":"","ucode":"50D653399A31F6","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":502253,"discussion_content":"终端安装命令：pip install pandasql\nPython中调包命令：from pandasql import sqldf      \n同学检查下代码哦","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1616691206,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":226535,"user_name":"As1m0v","can_delete":false,"product_type":"c1","uid":2035261,"ip_address":"","ucode":"279177F30FA011","user_header":"https://static001.geekbang.org/account/avatar/00/1f/0e/3d/ded8bc06.jpg","comment_is_top":false,"comment_ctime":1592132588,"is_pvip":false,"replies":[{"id":103731,"content":"思路一：鲁棒性不足；\n思路二：需要保证整个DataFrame都可以用0填充，比如：如果存在缺失值的列既有数值列又有字符列，那么直接用0填充，就容易出现问题；\n思路三：整个DataFrame如果除了数学列还有其他列也存在缺失值，直接使用数学均值填充，将会导致结果不正确；\n思路四是一种可用的方式。也可以给每个Series使用fillna","user_name":"作者回复","user_name_real":"cy","uid":1306094,"ctime":1617038553,"ip_address":"","comment_id":226535,"utype":1}],"discussion_count":1,"race_medal":0,"score":4,"product_id":100021701,"comment_content":"练习题解答：\npython3\n\nimport pandas as pd\nfrom pandas import DataFrame, Series\n\n# 创建DataFrame\ntest_data = {&#39;语文&#39;:[66, 95, 95, 90, 80, 80],\n          &#39;英语&#39;:[65, 85, 92, 88, 90, 90],\n          &#39;数学&#39;:[None, 98, 96, 77, 90, 90]}\n\ntest_df = DataFrame(test_data,\n                    columns = [&#39;语文&#39;, &#39;英语&#39;, &#39;数学&#39;],\n                   index = [&#39;张飞&#39;, &#39;关羽&#39;, &#39;赵云&#39;, &#39;黄忠&#39;, &#39;典韦&#39;, &#39;典韦&#39;])\ntest_df.index.name = &#39;姓名&#39;\n\n# 数据清洗\n# 删除重复数据\ntest_df.drop_duplicates(inplace = True)\n\n# 检查含有缺失值数据行\ncond=test_df[test_df.isnull().any(axis = 1)]\n\n# 思路一:删除含有缺失值数据行\ntest_df.drop(index = &#39;张飞&#39;, axis = 1,inplace = True)\n\n# 思路二:补全含有缺失数据行(补全为0\ntest_df.fillna(0, inplace = True)\n\n# 思路三:补全有缺失数据行(用平均值补充)\ntest_df.fillna(test_df[&#39;数学&#39;].mean(), inplace = True)\n\n# 思路四:补全有缺失数据行(用插值补充)\ntest_df = test_df.fillna(method = &#39;ffill&#39;, axis = 1)\n\n# 添加‘总和’列\nf4 = lambda x: x[0] + x[1] + x[2]\ntest_df[&#39;总和&#39;] = test_df.apply(f4, axis = &#39;columns&#39;)","like_count":0,"discussions":[{"author":{"id":1306094,"avatar":"https://static001.geekbang.org/account/avatar/00/13/ed/ee/c4779b67.jpg","nickname":"cy","note":"","ucode":"50D653399A31F6","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":501020,"discussion_content":"正确。scores的index没有意义，写入CSV文件时，可以通过参数index=False来舍弃写入index","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1616694189,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":223011,"user_name":"清风","can_delete":false,"product_type":"c1","uid":1987801,"ip_address":"","ucode":"5F99A1442E0390","user_header":"https://static001.geekbang.org/account/avatar/00/1e/54/d9/76a53118.jpg","comment_is_top":false,"comment_ctime":1590981311,"is_pvip":false,"replies":[{"id":103740,"content":"df3.drop_duplicates()如果不指定inplace参数为True，则会返回新DataFrame\nsum = 0 这行多余了\n","user_name":"作者回复","user_name_real":"cy","uid":1306094,"ctime":1617040223,"ip_address":"","comment_id":223011,"utype":1}],"discussion_count":1,"race_medal":0,"score":4,"product_id":100021701,"comment_content":"data = {&#39;姓名&#39;:[&#39;张飞&#39;,&#39;关羽&#39;, &#39;赵云&#39;, &#39;黄忠&#39;, &#39;典韦&#39;, &#39;典韦&#39;], &#39;语文&#39;:[66,95,95,90,80,80], &#39;英语&#39;:[65,85,92,88,90,90], &#39;数学&#39;: [None,98,96,77,90,90]}\ndf3 = DataFrame(data)\ndf3 = df3.set_index(&#39;姓名&#39;)\n\n# 去重\ndf3.duplicated()\ndf3.drop_duplicates(keep=&#39;first&#39;)\n\n# 查取空值 用均值填补\ndf3.isnull().any()\ndf3[&#39;数学&#39;].fillna(df3[&#39;数学&#39;].mean(), inplace=True)\n\n# 新增总和一列\nsum = 0\n#df3[&#39;总和&#39;] = df3[&#39;语文&#39;] + df3[&#39;英语&#39;] + df3[&#39;数学&#39;]\n# df3.drop(columns=&#39;总和&#39;, inplace=True)\ndf3[&#39;总和&#39;] = df3.sum(axis=1)\ndf3","like_count":0,"discussions":[{"author":{"id":1306094,"avatar":"https://static001.geekbang.org/account/avatar/00/13/ed/ee/c4779b67.jpg","nickname":"cy","note":"","ucode":"50D653399A31F6","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":498277,"discussion_content":"思路一：鲁棒性不足；\n思路二：需要保证整个DataFrame都可以用0填充，比如：如果存在缺失值的列既有数值列又有字符列，那么直接用0填充，就容易出现问题；\n思路三：整个DataFrame如果除了数学列还有其他列也存在缺失值，直接使用数学均值填充，将会导致结果不正确；\n思路四是一种可用的方式。也可以给每个Series使用fillna","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1617038553,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":216072,"user_name":"Henry","can_delete":false,"product_type":"c1","uid":1929375,"ip_address":"","ucode":"7C554C97935443","user_header":"https://static001.geekbang.org/account/avatar/00/1d/70/9f/741cd6a4.jpg","comment_is_top":false,"comment_ctime":1589182460,"is_pvip":false,"replies":[{"id":103757,"content":"很棒！！！","user_name":"作者回复","user_name_real":"cy","uid":1306094,"ctime":1617040898,"ip_address":"","comment_id":216072,"utype":1}],"discussion_count":1,"race_medal":0,"score":4,"product_id":100021701,"comment_content":"# 练习 python 3.x\ndata = {&#39;Chinese&#39;: [66, 95, 95, 90, 80, 80],\n        &#39;English&#39;: [65, 85, 92, 88, 90, 90],\n        &#39;Math&#39;: [None, 98, 96, 77, 90, 90]}\ndf = DataFrame(data, index=[&#39;ZhangFei&#39;, &#39;GuanYu&#39;, &#39;ZhaoYun&#39;, &#39;HuangZhong&#39;, &#39;DianWei&#39;, &#39;DianWei&#39;], columns=[&#39;English&#39;, &#39;Math&#39;, &#39;Chinese&#39;])\nprint(df)\n\ndf.drop_duplicates(inplace=True)\nprint(df)\ndf.dropna(inplace=True)\nprint(df)\ndf[&#39;total&#39;] = df.apply(func=lambda x: sum(x), axis=1)\nprint(df)","like_count":0,"discussions":[{"author":{"id":1306094,"avatar":"https://static001.geekbang.org/account/avatar/00/13/ed/ee/c4779b67.jpg","nickname":"cy","note":"","ucode":"50D653399A31F6","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":496987,"discussion_content":"df3.drop_duplicates()如果不指定inplace参数为True，则会返回新DataFrame\nsum = 0 这行多余了\n","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1617040223,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":248530,"user_name":"NLPer","can_delete":false,"product_type":"c1","uid":2087512,"ip_address":"","ucode":"CD3A997F9BE13B","user_header":"https://static001.geekbang.org/account/avatar/00/1f/da/58/2c36d211.jpg","comment_is_top":false,"comment_ctime":1600214788,"is_pvip":false,"replies":[{"id":103058,"content":"很棒哦！","user_name":"作者回复","user_name_real":"cy","uid":1306094,"ctime":1616082499,"ip_address":"","comment_id":248530,"utype":1}],"discussion_count":1,"race_medal":0,"score":4,"product_id":100021701,"comment_content":"老师，我准备做个笔记分享给更多的人😁","like_count":0,"discussions":[{"author":{"id":1306094,"avatar":"https://static001.geekbang.org/account/avatar/00/13/ed/ee/c4779b67.jpg","nickname":"cy","note":"","ucode":"50D653399A31F6","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":505673,"discussion_content":"很棒哦！","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1616082499,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":245016,"user_name":"拾光","can_delete":false,"product_type":"c1","uid":2087581,"ip_address":"","ucode":"3F88BAB08EF775","user_header":"https://static001.geekbang.org/account/avatar/00/1f/da/9d/1f825568.jpg","comment_is_top":false,"comment_ctime":1598783689,"is_pvip":false,"replies":[{"id":103496,"content":"很棒。数据清洗时，遇到空值可以删除等方式处理，这里是统计班级内同学的成绩，如果直接因为存在一科成绩空值就直接删除他的所有成绩，不太符合实际业务场景的需要。","user_name":"作者回复","user_name_real":"cy","uid":1306094,"ctime":1616688820,"ip_address":"","comment_id":245016,"utype":1}],"discussion_count":1,"race_medal":0,"score":4,"product_id":100021701,"comment_content":"import pandas as pd\n\n# 创建DataFrame，列名是：&#39;name&#39;、&#39;gender&#39;、&#39;age&#39;\ndf = pd.DataFrame([[&#39;Snow&#39;,83,97],\n                   [&#39;Tyrion&#39;,78,82,92],\n                   [&#39;Sansa&#39;,76,88,98],\n                   [&#39;Arya&#39;,95,78,64]], columns=[&#39;姓名&#39;,&#39;语文&#39;,&#39;英语&#39;, &#39;数学&#39;],index=None)\n\n# 清洗数据\ndf.dropna(axis=0, how=&#39;any&#39;, inplace=True)\n\ndf[&#39;总分&#39;] = df[&#39;语文&#39;] + df[&#39;英语&#39;] + df[&#39;数学&#39;]\nprint(df)","like_count":0,"discussions":[{"author":{"id":1306094,"avatar":"https://static001.geekbang.org/account/avatar/00/13/ed/ee/c4779b67.jpg","nickname":"cy","note":"","ucode":"50D653399A31F6","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":505673,"discussion_content":"很棒哦！","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1616082499,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":244415,"user_name":"包家欢","can_delete":false,"product_type":"c1","uid":1804112,"ip_address":"","ucode":"9B18C661D96430","user_header":"https://static001.geekbang.org/account/avatar/00/1b/87/50/fd4b6d5d.jpg","comment_is_top":false,"comment_ctime":1598510247,"is_pvip":false,"replies":[{"id":103500,"content":"print(type(data1))你会看到，data1是字典类型，而fillna()是pandas中DataFrame的方法，因此需要先将data1转为DataFrame:\ndf = pd.DataFrame(data1)\n# 将数学列中空字符串替换为0\n df[&#39;数学&#39;].apply(lambda x: 0 if x == &#39;&#39; else x)\n# 调整数据类型为整数型\ndf = df.astype(&#39;int&#39;)","user_name":"作者回复","user_name_real":"cy","uid":1306094,"ctime":1616689352,"ip_address":"","comment_id":244415,"utype":1}],"discussion_count":1,"race_medal":0,"score":4,"product_id":100021701,"comment_content":"data1 = {&#39;语文&#39;:[&#39;66&#39;,&#39;95&#39;,&#39;95&#39;,&#39;90&#39;,&#39;80&#39;,&#39;80&#39;],&#39;英语&#39;:[&#39;65&#39;,&#39;85&#39;,&#39;92&#39;,&#39;88&#39;,&#39;90&#39;,&#39;90&#39;],&#39;数学&#39;:[&#39;&#39;,&#39;98&#39;,&#39;96&#39;,&#39;77&#39;,&#39;90&#39;,&#39;90&#39;]}\n\n这种自定义的空字符串用不了fillna()，请问下这块，怎么进行处理？","like_count":0,"discussions":[{"author":{"id":1306094,"avatar":"https://static001.geekbang.org/account/avatar/00/13/ed/ee/c4779b67.jpg","nickname":"cy","note":"","ucode":"50D653399A31F6","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":504770,"discussion_content":"很棒。数据清洗时，遇到空值可以删除等方式处理，这里是统计班级内同学的成绩，如果直接因为存在一科成绩空值就直接删除他的所有成绩，不太符合实际业务场景的需要。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1616688820,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":243702,"user_name":"酱油不好打","can_delete":false,"product_type":"c1","uid":2141903,"ip_address":"","ucode":"C20B4FD4E32802","user_header":"https://static001.geekbang.org/account/avatar/00/20/ae/cf/dad08a72.jpg","comment_is_top":false,"comment_ctime":1598253069,"is_pvip":false,"replies":[{"id":103065,"content":"df.dropna()后，张飞同学的成绩就被删除了；可以使用df.fillna(0)来填充空值；\n典韦同学有2条成绩，建议drop_duplicates()去除重复行。","user_name":"作者回复","user_name_real":"cy","uid":1306094,"ctime":1616085052,"ip_address":"","comment_id":243702,"utype":1}],"discussion_count":1,"race_medal":0,"score":4,"product_id":100021701,"comment_content":"import pandas as pd\ndata = {&#39;语文&#39;: [66, 95, 93, 90, 80, 80], &#39;英语&#39;: [65, 85, 92, 88, 90, 90],\n        &#39;数学&#39;: [None, 98, 96, 77, 90, 90]}\ndf = pd.DataFrame(data, index=[&#39;张飞&#39;, &#39;关羽&#39;, &#39;赵云&#39;, &#39;黄忠&#39;, &#39;典韦&#39;, &#39;典韦&#39;],\n                  columns=[u&#39;英语&#39;, u&#39;数学&#39;, u&#39;语文&#39;])\ndf=df.dropna()\ndf[u&#39;总和&#39;] = df[u&#39;语文&#39;]+df[u&#39;英语&#39;]+df[u&#39;数学&#39;]\ndf.head()","like_count":0,"discussions":[{"author":{"id":1306094,"avatar":"https://static001.geekbang.org/account/avatar/00/13/ed/ee/c4779b67.jpg","nickname":"cy","note":"","ucode":"50D653399A31F6","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":504575,"discussion_content":"print(type(data1))你会看到，data1是字典类型，而fillna()是pandas中DataFrame的方法，因此需要先将data1转为DataFrame:\ndf = pd.DataFrame(data1)\n# 将数学列中空字符串替换为0\n df[&amp;#39;数学&amp;#39;].apply(lambda x: 0 if x == &amp;#39;&amp;#39; else x)\n# 调整数据类型为整数型\ndf = df.astype(&amp;#39;int&amp;#39;)","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1616689352,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":239074,"user_name":"落空","can_delete":false,"product_type":"c1","uid":1674783,"ip_address":"","ucode":"EC6AD8FC982697","user_header":"https://static001.geekbang.org/account/avatar/00/19/8e/1f/f96bd42d.jpg","comment_is_top":false,"comment_ctime":1596427674,"is_pvip":false,"replies":[{"id":103504,"content":"正确","user_name":"作者回复","user_name_real":"cy","uid":1306094,"ctime":1616690318,"ip_address":"","comment_id":239074,"utype":1}],"discussion_count":1,"race_medal":0,"score":4,"product_id":100021701,"comment_content":"#使用Jupyter Notebook编写\n#版本：python 3.6\nimport pandas as pd\n\n#新建DataFrame成绩单\ndata = {&#39;Chinese&#39;: [66, 95, 93, 90, 80, 80], &#39;English&#39;: [65, 85, 92, 88, 90, 90],\n        &#39;Math&#39;: [None, 98, 96, 77, 90, 90]}\ndf = pd.DataFrame(data, index=[&#39;张飞&#39;, &#39;关羽&#39;, &#39;赵云&#39;, &#39;黄忠&#39;, &#39;典韦&#39;, &#39;典韦&#39;],\n                  columns=[&#39;English&#39;, &#39;Math&#39;, &#39;Chinese&#39;])\n\n#查看数据情况\ndf.info()  #可以查看缺失值等情况\ndf.describe() #描述性统计常见统计值\n\n#处理缺失值，用均值填充\ndf[&#39;Math&#39;].fillna(df[&#39;Math&#39;].mean(), inplace=True)\ndf[&#39;Math&#39;] = df[&#39;Math&#39;].astype(int)\n# 去除重复行\ndf = df.drop_duplicates()\n#计算成绩总和\ndf[&#39;总和&#39;] = df.eval(&quot;English + Math + Chinese&quot;)\n#成绩排个序\ndf = df.sort_values(&#39;总和&#39;,ascending=False)","like_count":0,"discussions":[{"author":{"id":1306094,"avatar":"https://static001.geekbang.org/account/avatar/00/13/ed/ee/c4779b67.jpg","nickname":"cy","note":"","ucode":"50D653399A31F6","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":502967,"discussion_content":"正确","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1616690318,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":236919,"user_name":"liubin","can_delete":false,"product_type":"c1","uid":1908013,"ip_address":"","ucode":"69F7B261F81EE6","user_header":"http://thirdwx.qlogo.cn/mmopen/vi_32/twibiaV0K4L2f8wTjCjRYp3IFOHg4um1cgj233ibJVicmjF1Qsb7JFib6icBkFu68kT0ueMIA89GcXfv9g3InkGViciaRQ/132","comment_is_top":false,"comment_ctime":1595584921,"is_pvip":false,"replies":[{"id":103506,"content":"终端安装命令：pip install pandasql\nPython中调包命令：from pandasql import sqldf      \n同学检查下代码哦","user_name":"作者回复","user_name_real":"cy","uid":1306094,"ctime":1616691206,"ip_address":"","comment_id":236919,"utype":1}],"discussion_count":1,"race_medal":0,"score":4,"product_id":100021701,"comment_content":"ImportError: cannot import name &#39;sqldf&#39;  我安装了sqldf还是报这个错","like_count":0,"discussions":[{"author":{"id":1306094,"avatar":"https://static001.geekbang.org/account/avatar/00/13/ed/ee/c4779b67.jpg","nickname":"cy","note":"","ucode":"50D653399A31F6","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":502253,"discussion_content":"终端安装命令：pip install pandasql\nPython中调包命令：from pandasql import sqldf      \n同学检查下代码哦","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1616691206,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":233426,"user_name":"CHEN","can_delete":false,"product_type":"c1","uid":2058384,"ip_address":"","ucode":"5B9BA6F6C83F58","user_header":"https://static001.geekbang.org/account/avatar/00/1f/68/90/ca86abe3.jpg","comment_is_top":false,"comment_ctime":1594312425,"is_pvip":false,"replies":[{"id":103516,"content":"正确。scores的index没有意义，写入CSV文件时，可以通过参数index=False来舍弃写入index","user_name":"作者回复","user_name_real":"cy","uid":1306094,"ctime":1616694189,"ip_address":"","comment_id":233426,"utype":1}],"discussion_count":1,"race_medal":0,"score":4,"product_id":100021701,"comment_content":"import pandas as pd\nimport numpy as np\n\nscores = pd.DataFrame(\n    {&quot;语文&quot;: [66, 95, 95, 90, 80, 80], &quot;英语&quot;: [65, 85, 92, 88, 90, 90], &quot;数学&quot;: [np.nan, 98, 96, 77, 90, 90]},\n    index=[&#39;张飞&#39;, &#39;关羽&#39;, &#39;赵云&#39;, &#39;黄忠&#39;, &#39;典韦&#39;, &#39;典韦&#39;]\n)\n# 去重\nscores = scores.drop_duplicates()\n# 替换NaN值\nprint(scores.isnull().any())  #查看哪一列有空值\nscores = scores.fillna(scores[&#39;数学&#39;].mean())\n# 增加一行统计\nscores[&#39;总分&#39;] = scores.sum(axis=1)\n# 按总分倒序排列\nscores = scores.sort_values(by=&quot;总分&quot;, ascending=False)\nprint(scores)\n\n#输出清洗结果到csv文件进行保存\nscores.to_csv(&#39;scores.csv&#39;)","like_count":0,"discussions":[{"author":{"id":1306094,"avatar":"https://static001.geekbang.org/account/avatar/00/13/ed/ee/c4779b67.jpg","nickname":"cy","note":"","ucode":"50D653399A31F6","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":501020,"discussion_content":"正确。scores的index没有意义，写入CSV文件时，可以通过参数index=False来舍弃写入index","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1616694189,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":226535,"user_name":"As1m0v","can_delete":false,"product_type":"c1","uid":2035261,"ip_address":"","ucode":"279177F30FA011","user_header":"https://static001.geekbang.org/account/avatar/00/1f/0e/3d/ded8bc06.jpg","comment_is_top":false,"comment_ctime":1592132588,"is_pvip":false,"replies":[{"id":103731,"content":"思路一：鲁棒性不足；\n思路二：需要保证整个DataFrame都可以用0填充，比如：如果存在缺失值的列既有数值列又有字符列，那么直接用0填充，就容易出现问题；\n思路三：整个DataFrame如果除了数学列还有其他列也存在缺失值，直接使用数学均值填充，将会导致结果不正确；\n思路四是一种可用的方式。也可以给每个Series使用fillna","user_name":"作者回复","user_name_real":"cy","uid":1306094,"ctime":1617038553,"ip_address":"","comment_id":226535,"utype":1}],"discussion_count":1,"race_medal":0,"score":4,"product_id":100021701,"comment_content":"练习题解答：\npython3\n\nimport pandas as pd\nfrom pandas import DataFrame, Series\n\n# 创建DataFrame\ntest_data = {&#39;语文&#39;:[66, 95, 95, 90, 80, 80],\n          &#39;英语&#39;:[65, 85, 92, 88, 90, 90],\n          &#39;数学&#39;:[None, 98, 96, 77, 90, 90]}\n\ntest_df = DataFrame(test_data,\n                    columns = [&#39;语文&#39;, &#39;英语&#39;, &#39;数学&#39;],\n                   index = [&#39;张飞&#39;, &#39;关羽&#39;, &#39;赵云&#39;, &#39;黄忠&#39;, &#39;典韦&#39;, &#39;典韦&#39;])\ntest_df.index.name = &#39;姓名&#39;\n\n# 数据清洗\n# 删除重复数据\ntest_df.drop_duplicates(inplace = True)\n\n# 检查含有缺失值数据行\ncond=test_df[test_df.isnull().any(axis = 1)]\n\n# 思路一:删除含有缺失值数据行\ntest_df.drop(index = &#39;张飞&#39;, axis = 1,inplace = True)\n\n# 思路二:补全含有缺失数据行(补全为0\ntest_df.fillna(0, inplace = True)\n\n# 思路三:补全有缺失数据行(用平均值补充)\ntest_df.fillna(test_df[&#39;数学&#39;].mean(), inplace = True)\n\n# 思路四:补全有缺失数据行(用插值补充)\ntest_df = test_df.fillna(method = &#39;ffill&#39;, axis = 1)\n\n# 添加‘总和’列\nf4 = lambda x: x[0] + x[1] + x[2]\ntest_df[&#39;总和&#39;] = test_df.apply(f4, axis = &#39;columns&#39;)","like_count":0,"discussions":[{"author":{"id":1306094,"avatar":"https://static001.geekbang.org/account/avatar/00/13/ed/ee/c4779b67.jpg","nickname":"cy","note":"","ucode":"50D653399A31F6","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":498277,"discussion_content":"思路一：鲁棒性不足；\n思路二：需要保证整个DataFrame都可以用0填充，比如：如果存在缺失值的列既有数值列又有字符列，那么直接用0填充，就容易出现问题；\n思路三：整个DataFrame如果除了数学列还有其他列也存在缺失值，直接使用数学均值填充，将会导致结果不正确；\n思路四是一种可用的方式。也可以给每个Series使用fillna","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1617038553,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":223011,"user_name":"清风","can_delete":false,"product_type":"c1","uid":1987801,"ip_address":"","ucode":"5F99A1442E0390","user_header":"https://static001.geekbang.org/account/avatar/00/1e/54/d9/76a53118.jpg","comment_is_top":false,"comment_ctime":1590981311,"is_pvip":false,"replies":[{"id":103740,"content":"df3.drop_duplicates()如果不指定inplace参数为True，则会返回新DataFrame\nsum = 0 这行多余了\n","user_name":"作者回复","user_name_real":"cy","uid":1306094,"ctime":1617040223,"ip_address":"","comment_id":223011,"utype":1}],"discussion_count":1,"race_medal":0,"score":4,"product_id":100021701,"comment_content":"data = {&#39;姓名&#39;:[&#39;张飞&#39;,&#39;关羽&#39;, &#39;赵云&#39;, &#39;黄忠&#39;, &#39;典韦&#39;, &#39;典韦&#39;], &#39;语文&#39;:[66,95,95,90,80,80], &#39;英语&#39;:[65,85,92,88,90,90], &#39;数学&#39;: [None,98,96,77,90,90]}\ndf3 = DataFrame(data)\ndf3 = df3.set_index(&#39;姓名&#39;)\n\n# 去重\ndf3.duplicated()\ndf3.drop_duplicates(keep=&#39;first&#39;)\n\n# 查取空值 用均值填补\ndf3.isnull().any()\ndf3[&#39;数学&#39;].fillna(df3[&#39;数学&#39;].mean(), inplace=True)\n\n# 新增总和一列\nsum = 0\n#df3[&#39;总和&#39;] = df3[&#39;语文&#39;] + df3[&#39;英语&#39;] + df3[&#39;数学&#39;]\n# df3.drop(columns=&#39;总和&#39;, inplace=True)\ndf3[&#39;总和&#39;] = df3.sum(axis=1)\ndf3","like_count":0,"discussions":[{"author":{"id":1306094,"avatar":"https://static001.geekbang.org/account/avatar/00/13/ed/ee/c4779b67.jpg","nickname":"cy","note":"","ucode":"50D653399A31F6","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":496987,"discussion_content":"df3.drop_duplicates()如果不指定inplace参数为True，则会返回新DataFrame\nsum = 0 这行多余了\n","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1617040223,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":216072,"user_name":"Henry","can_delete":false,"product_type":"c1","uid":1929375,"ip_address":"","ucode":"7C554C97935443","user_header":"https://static001.geekbang.org/account/avatar/00/1d/70/9f/741cd6a4.jpg","comment_is_top":false,"comment_ctime":1589182460,"is_pvip":false,"replies":[{"id":103757,"content":"很棒！！！","user_name":"作者回复","user_name_real":"cy","uid":1306094,"ctime":1617040898,"ip_address":"","comment_id":216072,"utype":1}],"discussion_count":1,"race_medal":0,"score":4,"product_id":100021701,"comment_content":"# 练习 python 3.x\ndata = {&#39;Chinese&#39;: [66, 95, 95, 90, 80, 80],\n        &#39;English&#39;: [65, 85, 92, 88, 90, 90],\n        &#39;Math&#39;: [None, 98, 96, 77, 90, 90]}\ndf = DataFrame(data, index=[&#39;ZhangFei&#39;, &#39;GuanYu&#39;, &#39;ZhaoYun&#39;, &#39;HuangZhong&#39;, &#39;DianWei&#39;, &#39;DianWei&#39;], columns=[&#39;English&#39;, &#39;Math&#39;, &#39;Chinese&#39;])\nprint(df)\n\ndf.drop_duplicates(inplace=True)\nprint(df)\ndf.dropna(inplace=True)\nprint(df)\ndf[&#39;total&#39;] = df.apply(func=lambda x: sum(x), axis=1)\nprint(df)","like_count":0,"discussions":[{"author":{"id":1306094,"avatar":"https://static001.geekbang.org/account/avatar/00/13/ed/ee/c4779b67.jpg","nickname":"cy","note":"","ucode":"50D653399A31F6","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":494659,"discussion_content":"很棒！！！","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1617040898,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":213765,"user_name":"7Color_李康龙","can_delete":false,"product_type":"c1","uid":1914963,"ip_address":"","ucode":"0BCB00135C3F79","user_header":"https://static001.geekbang.org/account/avatar/00/1d/38/53/738fa9b2.jpg","comment_is_top":false,"comment_ctime":1588556534,"is_pvip":false,"replies":[{"id":103765,"content":"正确。\ndf2[&#39;sum&#39;] = df2[&#39;语文&#39;]+df2[&#39;英语&#39;]+df2[&#39;数学&#39;]\n因为df2只有3个学科的成绩列，所以成绩求和也可以写成df2[&#39;sum&#39;] =df.sum(1)","user_name":"作者回复","user_name_real":"cy","uid":1306094,"ctime":1617041585,"ip_address":"","comment_id":213765,"utype":1}],"discussion_count":1,"race_medal":0,"score":5,"product_id":100021701,"comment_content":"打卡05\nimport pandas as pd\nfrom pandas import Series,DataFrame\ndata={\n&#39;语文&#39;:[66,95,95,90,80,80],\n&#39;英语&#39;:[65,85,92,88,90,90],\n&#39;数学&#39;:[None,98,96,77,90,90]}\ndf2=DataFrame(data,\nindex=[&#39;张飞&#39; , &#39;关羽&#39; , &#39;赵云&#39; , &#39;张飞&#39; , &#39;典韦&#39; , &#39;典韦&#39;],\ncolumns=[&#39;语文&#39;, &#39;英语&#39; ,&#39;数学&#39;])\nprint(df2)\n\n#数据清洗\ndf2 = df2.drop_duplicates() #去除重复行\nprint(df2)\nprint(df2.isnull().any())  #是否有空值\n\n# 使用数学成绩均值填充张飞同学的缺失值\ndf2[&#39;数学&#39;].fillna(df2[&#39;数学&#39;].mean(), inplace=True)\n\ndf2[&#39;sum&#39;] =df2[&#39;语文&#39;]+df2[&#39;英语&#39;]+df2[&#39;数学&#39;]\nprint(df2)\nprint(df2.describe())","like_count":0},{"had_liked":false,"id":206433,"user_name":"南辞","can_delete":false,"product_type":"c1","uid":1915530,"ip_address":"","ucode":"098E01EB97E901","user_header":"https://static001.geekbang.org/account/avatar/00/1d/3a/8a/76b03c2f.jpg","comment_is_top":false,"comment_ctime":1586859901,"is_pvip":false,"replies":[{"id":104218,"content":"Good Job!","user_name":"作者回复","user_name_real":"cy","uid":1306094,"ctime":1617730818,"ip_address":"","comment_id":206433,"utype":1}],"discussion_count":1,"race_medal":0,"score":5,"product_id":100021701,"comment_content":"import numpy as np\nimport pandas as pd\nfrom pandas import DataFrame\ndata ={&quot;语文&quot;:[66,95,95,90,80,80],&quot;英语&quot;:[65,85,92,88,90,90],&quot;数学&quot;:[None,98,96,77,90,90]}\ndf1 = DataFrame(data,index=[&quot;张飞&quot;,&quot;关羽&quot;,&quot;赵云&quot;,&quot;黄忠&quot;,&quot;典韦&quot;,&quot;典韦&quot;])\n##开始对数据进行清洗\ndf1.dtypes\n##取消重复值\ndf1 = df1.drop_duplicates()\ndf1\n##用平均值来填充空值\ndf1[&quot;数学&quot;].fillna(df1[&quot;数学&quot;].mean(),inplace = True)\n##数据类型做个转换\ndf1[&quot;数学&quot;] = df1[&quot;数学&quot;].astype(np.int64)\ndf1[&quot;总和&quot;] = df1.sum(axis=1)\n##重新按照总成绩排序\ndf1.sort_values([&quot;总和&quot;],ascending=[False],inplace=True)\n##然后对数据座做一个描述\nprint(df1.describe())","like_count":0,"discussions":[{"author":{"id":1306094,"avatar":"https://static001.geekbang.org/account/avatar/00/13/ed/ee/c4779b67.jpg","nickname":"cy","note":"","ucode":"50D653399A31F6","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":493866,"discussion_content":"正确。\ndf2[&amp;#39;sum&amp;#39;] = df2[&amp;#39;语文&amp;#39;]+df2[&amp;#39;英语&amp;#39;]+df2[&amp;#39;数学&amp;#39;]\n因为df2只有3个学科的成绩列，所以成绩求和也可以写成df2[&amp;#39;sum&amp;#39;] =df.sum(1)","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1617041585,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":202484,"user_name":"彭纪程","can_delete":false,"product_type":"c1","uid":1682468,"ip_address":"","ucode":"F9222D72E791C8","user_header":"https://static001.geekbang.org/account/avatar/00/19/ac/24/0684a141.jpg","comment_is_top":false,"comment_ctime":1585995181,"is_pvip":false,"replies":[{"id":104221,"content":"apply()方法用的很不错！ Good Job!","user_name":"作者回复","user_name_real":"cy","uid":1306094,"ctime":1617731364,"ip_address":"","comment_id":202484,"utype":1}],"discussion_count":1,"race_medal":0,"score":5,"product_id":100021701,"comment_content":"import pandas as pd\nfrom pandas import DataFrame\nimport numpy as np\ndata = {&#39;姓名&#39;:[&#39;张飞&#39;,&#39;关羽&#39;,&#39;赵云&#39;,&#39;黄忠&#39;,&#39;典韦&#39;,&#39;典韦&#39;],&#39;语文&#39;:[66,95,95,90,80,80],&#39;英语&#39;:[65,85,92,88,90,90],&#39;数学&#39;:[np.NaN,98,96,77,90,90]}\ndf = DataFrame(data)\nprint(df.describe())\nprint(df.isnull())\ndf = df.drop_duplicates()\ndf=df.fillna(value = df.mean())\ndef sum(df):\n    return df[&#39;语文&#39;] + df[&#39;英语&#39;] + df[&#39;数学&#39;]\ndf[&#39;总和&#39;] = df.apply(sum, axis = 1)\nprint(df)","like_count":0,"discussions":[{"author":{"id":1306094,"avatar":"https://static001.geekbang.org/account/avatar/00/13/ed/ee/c4779b67.jpg","nickname":"cy","note":"","ucode":"50D653399A31F6","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":490598,"discussion_content":"apply()方法用的很不错！ Good Job!","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1617731364,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":202480,"user_name":"极客中心","can_delete":false,"product_type":"c1","uid":1542363,"ip_address":"","ucode":"F1CE36E3E47A3C","user_header":"https://static001.geekbang.org/account/avatar/00/17/88/db/adad4661.jpg","comment_is_top":false,"comment_ctime":1585994528,"is_pvip":false,"replies":[{"id":104220,"content":"Good Job!","user_name":"作者回复","user_name_real":"cy","uid":1306094,"ctime":1617731165,"ip_address":"","comment_id":202480,"utype":1}],"discussion_count":1,"race_medal":0,"score":5,"product_id":100021701,"comment_content":"from pandas import Series,DataFrame\nimport numpy as np\n\nd = {&quot;语文&quot;:[66,95,95,90,80,80],&quot;英语&quot;:[65,85,92,88,90,90],&quot;数学&quot;:[np.nan,98,96,77,90,90]}\ndf3 = DataFrame(d,index=[&quot;张飞&quot;,&quot;关羽&quot;,&quot;赵云&quot;,&quot;黄忠&quot;,&quot;典韦&quot;,&quot;典韦&quot;])\n\n# 查看空值\ndf3.isnull().any()\n\n# 填充空值\ndf3[&#39;数学&#39;].fillna(value=df3[&#39;数学&#39;].mean(),inplace=True)\n\n# 删除重复\ndf3.drop_duplicates(inplace=True)\n\n# 增加一列\ndef plus(df3):\n    df3[&#39;总和&#39;] = df3[&#39;语文&#39;]+df3[&#39;数学&#39;]+df3[&#39;英语&#39;]\n    return df3\n\ndf3 = df3.apply(plus,axis=1)\n\n# 排序\ndf4 = df3.sort_values(by=&#39;总和&#39;,ascending=False,axis=0,inplace=False)","like_count":0,"discussions":[{"author":{"id":1306094,"avatar":"https://static001.geekbang.org/account/avatar/00/13/ed/ee/c4779b67.jpg","nickname":"cy","note":"","ucode":"50D653399A31F6","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":490597,"discussion_content":"Good Job!","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1617731165,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":199366,"user_name":"🌻","can_delete":false,"product_type":"c1","uid":1509651,"ip_address":"","ucode":"9B4D8CA8C09A70","user_header":"https://static001.geekbang.org/account/avatar/00/17/09/13/d762ce74.jpg","comment_is_top":false,"comment_ctime":1585487755,"is_pvip":false,"replies":[{"id":104332,"content":"Good Job","user_name":"作者回复","user_name_real":"cy","uid":1306094,"ctime":1617903157,"ip_address":"","comment_id":199366,"utype":1}],"discussion_count":1,"race_medal":0,"score":5,"product_id":100021701,"comment_content":"# 定义 DataFrame\ndata = [[66, 65], [95, 85, 98], [95, 92,96], \n        [90, 88, 77], [80, 90, 90], [80, 90, 90]]\n\ncolumns = [&#39;语文&#39;,&#39;英语&#39;, &#39;数学&#39;]\nindex = [&#39;张飞&#39;, &#39;关羽&#39;, &#39;赵云&#39;, &#39;黄忠&#39;, &#39;典韦&#39;, &#39;典韦&#39;]\n\ndf = DataFrame(data, index=index, columns=columns)\nprint(df)\n\n# 去重复的值\ndf = df.drop_duplicates()\n\n# 空值设为 0\ndf = df.fillna(0)\n\n# 新增一列“总和”计算每个人的三科成绩之和\n\ndf[&#39;总和&#39;] = df.apply(sum, axis=1)\nprint(df)","like_count":0,"discussions":[{"author":{"id":1306094,"avatar":"https://static001.geekbang.org/account/avatar/00/13/ed/ee/c4779b67.jpg","nickname":"cy","note":"","ucode":"50D653399A31F6","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":490597,"discussion_content":"Good Job!","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1617731165,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":195839,"user_name":"十六。","can_delete":false,"product_type":"c1","uid":1935100,"ip_address":"","ucode":"DD4A02E3D904D5","user_header":"","comment_is_top":false,"comment_ctime":1585218678,"is_pvip":false,"replies":[{"id":103995,"content":"Good Job!","user_name":"作者回复","user_name_real":"cy","uid":1306094,"ctime":1617292922,"ip_address":"","comment_id":195839,"utype":1}],"discussion_count":1,"race_medal":0,"score":5,"product_id":100021701,"comment_content":"留言里师哥们学的太好了\n仿照着写了一遍：\nimport pandas as pd\ndata = {&#39;chinese&#39;: [66, 95, 93, 90, 80, 80], &#39;english&#39;: [65, 85, 92, 88, 90, 90],\n        &#39;math&#39;: [None, 98, 96, 77, 90, 90]}\ndf = pd.DataFrame(data, index=[&#39;张飞&#39;, &#39;关羽&#39;, &#39;赵云&#39;, &#39;黄忠&#39;, &#39;典韦&#39;, &#39;典韦&#39;],\n                  columns=[&#39;english&#39;, &#39;chinese&#39;, &#39;math&#39;])\n# 数据清洗\n# 去重、改列名、改类型、对于空值使用该列的均值来填充\ndf = df.drop_duplicates()\n\n# rename函数中columns值为字典类型,并且是在视图修改\ndf.rename(columns={&#39;chinese&#39;:&#39;语文&#39;,&#39;english&#39;:&#39;英语&#39;,&#39;math&#39;:&#39;数学&#39;},inplace=True)\n\n# 对张飞数学成绩进行军靴均值填充\ndf[df.isnull()] = df.iloc[1:,2].mean()\n\n# 之前求总成绩使用的是sum方法直接修改的，这次使用apply函数来写一遍\ndef add_col(df):\n    df[&#39;总成绩&#39;] = df[&#39;语文&#39;]+df[&#39;英语&#39;]+df[&#39;数学&#39;]\n    return df\ndf = df.apply(add_col,axis=1)\n# 按照总成绩进行排序\ndf.sort_values([&#39;总成绩&#39;], ascending=False, inplace=True)\ndf\n\n\n英语\t语文\t数学\t总成绩\n赵云\t92.0\t93.0\t96.00\t281.00\n关羽\t85.0\t95.0\t98.00\t278.00\n典韦\t90.0\t80.0\t90.00\t260.00\n黄忠\t88.0\t90.0\t77.00\t255.00\n张飞\t65.0\t66.0\t90.25\t221.25\n\n使用 jupyter lab","like_count":0,"discussions":[{"author":{"id":1306094,"avatar":"https://static001.geekbang.org/account/avatar/00/13/ed/ee/c4779b67.jpg","nickname":"cy","note":"","ucode":"50D653399A31F6","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":489824,"discussion_content":"Good Job","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1617903157,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":195823,"user_name":"十六。","can_delete":false,"product_type":"c1","uid":1935100,"ip_address":"","ucode":"DD4A02E3D904D5","user_header":"","comment_is_top":false,"comment_ctime":1585217157,"is_pvip":false,"replies":[{"id":103996,"content":"Good Gob","user_name":"作者回复","user_name_real":"cy","uid":1306094,"ctime":1617292979,"ip_address":"","comment_id":195823,"utype":1}],"discussion_count":1,"race_medal":0,"score":5,"product_id":100021701,"comment_content":"Pandas中最主要的数据结构是？\nSeries和DataFrame\n它都提供了哪些函数，可以帮我们做数据清洗？你可以自己描述一下吗？\ndropna、drop_duplicate、drop、isnull等\n\n题目：\nimport pandas as pd\ndata = {&#39;chinese&#39;: [66, 95, 93, 90, 80, 80], &#39;english&#39;: [65, 85, 92, 88, 90, 90],\n        &#39;math&#39;: [None, 98, 96, 77, 90, 90]}\ndf = pd.DataFrame(data, index=[&#39;张飞&#39;, &#39;关羽&#39;, &#39;赵云&#39;, &#39;黄忠&#39;, &#39;典韦&#39;, &#39;典韦&#39;],\n                  columns=[&#39;english&#39;, &#39;chinese&#39;, &#39;math&#39;])\n# 分析表格，存在空值，重复行\ndf = df.drop_duplicates()\ndf[df.isnull()] = 0\ndf = df.astype(dtype=&#39;i&#39;)\ndf[&#39;general&#39;] = df.sum(axis=1)\ndf\n\nenglish\tchinese\tmath\tgeneral\n张飞\t65\t66\t0\t131\n关羽\t85\t95\t98\t278\n赵云\t92\t93\t96\t281\n黄忠\t88\t90\t77\t255\n典韦\t90\t80\t90\t260","like_count":0,"discussions":[{"author":{"id":1306094,"avatar":"https://static001.geekbang.org/account/avatar/00/13/ed/ee/c4779b67.jpg","nickname":"cy","note":"","ucode":"50D653399A31F6","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":489170,"discussion_content":"Good Job!","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1617292922,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":192502,"user_name":"夕子","can_delete":false,"product_type":"c1","uid":1916066,"ip_address":"","ucode":"4115ABE599B2F4","user_header":"https://static001.geekbang.org/account/avatar/00/1d/3c/a2/09a2215c.jpg","comment_is_top":false,"comment_ctime":1584856141,"is_pvip":false,"replies":[{"id":104353,"content":"总结的很棒！Good Job!!!","user_name":"作者回复","user_name_real":"cy","uid":1306094,"ctime":1617904543,"ip_address":"","comment_id":192502,"utype":1}],"discussion_count":1,"race_medal":0,"score":5,"product_id":100021701,"comment_content":"一、pandas中最主要的两个数据结构是Series和DataFrame。\n二、pandas提供的数据清洗的函数有：\n①drop()，删除不必要的行或者列；\n②rename()，重命名列名；\n③drop_duplicates()，去重复值；\n④astype()，更改数据格式；\n⑤strip，处理数据间的空格，具体有strip()、lstrip()和rstrip()，分别代表两边、左边和右边空格，还可以用来删除数据中的特殊符号；\n⑥upper、lower、title大小写转换；\n⑦isnull()寻找空值，isnull().any()寻找空值所在的列；\n⑧apply()，使用函数，也可以使用自定义函数；\n⑨merge()，数据表合并，包括基于指定列的连接（on=)、左连接(how=&#39;left&#39;)、右连接(how=&#39;right&#39;)、内连接(how=&#39;inner&#39;)和外连接(how=&#39;outer&#39;);\n⑩统计函数，包括describe()、count()、min()、max()、sum()、mean()、median()、var()、std()、argmin()、argmax()、idxmin()、idxmax()。\n\n三、练习题：\n（1）创建DataFrame\nimport pandas as pd\nimport numpy as np\ndata = {&#39;name&#39;:[&#39;ZhangFei&#39;,&#39;GuanYu&#39;,&#39;ZhaoYun&#39;,&#39;HuangZhong&#39;,&#39;DianWei&#39;,&#39;DianWei&#39;],&#39;Chinese&#39;:[66,95,95,90,80,80],&#39;English&#39;:[65,85,92,88,90,90],&#39;Math&#39;:[np.nan,98,96,77,90,90]}\ndf = pd.DataFrame(data,columns=[&#39;name&#39;,&#39;Chinese&#39;,&#39;English&#39;,&#39;Math&#39;])\nprint(df)\n输出：\nname  Chinese  English  Math\n0    ZhangFei       66       65   NaN\n1      GuanYu       95       85  98.0\n2     ZhaoYun       95       92  96.0\n3  HuangZhong       90       88  77.0\n4     DianWei       80       90  90.0\n5     DianWei       80       90  90.0\n（2）# 删除重复值\ndf = df.drop_duplicates()\nprint(df)\n输出结果：\nname  Chinese  English  Math\n0    ZhangFei       66       65  84.0\n1      GuanYu       95       85  98.0\n2     ZhaoYun       95       92  96.0\n3  HuangZhong       90       88  77.0\n4     DianWei       80       90  90.0\n（3）# 新增一列“总和”计算每个人的三科成绩之和\ndf[&#39;total&#39;] = df[&#39;Chinese&#39;]+df[&#39;English&#39;]+df[&#39;Math&#39;]\nprint(df)\n输出结果：\nname  Chinese  English  Math  total\n0    ZhangFei       66       65  84.0  215.0\n1      GuanYu       95       85  98.0  278.0\n2     ZhaoYun       95       92  96.0  283.0\n3  HuangZhong       90       88  77.0  255.0\n4     DianWei       80       90  90.0  260.0\n","like_count":0,"discussions":[{"author":{"id":1306094,"avatar":"https://static001.geekbang.org/account/avatar/00/13/ed/ee/c4779b67.jpg","nickname":"cy","note":"","ucode":"50D653399A31F6","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":488411,"discussion_content":"总结的很棒！Good Job!!!","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1617904543,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":185736,"user_name":"Geek_日月","can_delete":false,"product_type":"c1","uid":1624334,"ip_address":"","ucode":"29CDE87CD74FCE","user_header":"http://thirdwx.qlogo.cn/mmopen/vi_32/Cbn8R1t289AcI6CR2vwuyJDY4pNsy15micFeEiaZSKwzYbicqTY4B4tawBiadDRiarGXzxDkial85dTgzgiaL4NBbiazFA/132","comment_is_top":false,"comment_ctime":1583673081,"is_pvip":false,"replies":[{"id":104362,"content":"Good Job!!!","user_name":"作者回复","user_name_real":"cy","uid":1306094,"ctime":1617904981,"ip_address":"","comment_id":185736,"utype":1}],"discussion_count":1,"race_medal":0,"score":5,"product_id":100021701,"comment_content":"import pandas as pd\nfrom pandas import Series, DataFrame\ndata = {&#39;Chinese&#39;: [66, 95, 95, 90, 80, 80],&#39;English&#39;: [65, 85, 92, 88, 90, 90],&#39;Math&#39;: [None, 98, 96, 77, 90, 90]}\n#df1= DataFrame(data)\ndf = DataFrame(data, index=[&#39;ZhangFei&#39;, &#39;GuanYu&#39;, &#39;ZhaoYun&#39;, &#39;HuangZhong&#39;, &#39;DianWei&#39;, &#39;DianWei&#39;], columns=[&#39;English&#39;, &#39;Math&#39;, &#39;Chinese&#39;])\n\n## 去除重复行\ndf = df.drop_duplicates()\n\n### 改名\ndf.rename(index={&#39;ZhangFei&#39;: &#39;张飞&#39;, &#39;GuanYu&#39;: &#39;关羽&#39;, &#39;ZhaoYun&#39;: &#39;赵云&#39;, &#39;DianWei&#39;: &#39;典韦&#39;,&#39;HuangZhong&#39;: &#39;黄忠&#39;}, inplace = True)\ndf.rename(columns={&#39;English&#39;: &#39;英语&#39;, &#39;Math&#39;: &#39;数学&#39;, &#39;Chinese&#39;: &#39;中文&#39;}, inplace = True)\nprint(df)\n\n#去一个中间数值进行填充None\ndf[&#39;数学&#39;].fillna(df[&#39;数学&#39;].median(),inplace=True)\n\n##去除有空值的行\nprint(df.isnull())\nprint(df.isnull().any())\ndf = df.dropna(how=&#39;any&#39;,axis=0)\n\nprint(df)\ndf[&#39;totle&#39;] = df[&#39;英语&#39;] + df[&#39;数学&#39;] + df[&#39;中文&#39;]\nprint(df)\nprint(df.describe())","like_count":0,"discussions":[{"author":{"id":1306094,"avatar":"https://static001.geekbang.org/account/avatar/00/13/ed/ee/c4779b67.jpg","nickname":"cy","note":"","ucode":"50D653399A31F6","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":486481,"discussion_content":"Good Job!!!","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1617904981,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":172822,"user_name":"pencilCool","can_delete":false,"product_type":"c1","uid":1461770,"ip_address":"","ucode":"49A9FE2DEE2911","user_header":"https://static001.geekbang.org/account/avatar/00/16/4e/0a/0ff15eaa.jpg","comment_is_top":false,"comment_ctime":1579325705,"is_pvip":false,"replies":[{"id":104013,"content":"感谢pencilCool的分享，Mac同学安装numpy 和pandas报错的同学可以看下","user_name":"作者回复","user_name_real":"cy","uid":1306094,"ctime":1617293843,"ip_address":"","comment_id":172822,"utype":1}],"discussion_count":1,"race_medal":0,"score":5,"product_id":100021701,"comment_content":"mac 电脑上 最近python 2.x 安装numpy 和pandas 会报各种错误。\npip 升级，然后pip3 命令用不了了。没关系pip 升级后默认用的就是python3了\n然后使用如下命令安装：\nsudo pip install Pandas -i http:&#47;&#47;mirrors.aliyun.com&#47;pypi&#47;simple --trusted-host mirrors.aliyun.com\n很快就安装好了","like_count":0,"discussions":[{"author":{"id":1306094,"avatar":"https://static001.geekbang.org/account/avatar/00/13/ed/ee/c4779b67.jpg","nickname":"cy","note":"","ucode":"50D653399A31F6","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":481867,"discussion_content":"感谢pencilCool的分享，Mac同学安装numpy 和pandas报错的同学可以看下","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1617293843,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":213765,"user_name":"7Color_李康龙","can_delete":false,"product_type":"c1","uid":1914963,"ip_address":"","ucode":"0BCB00135C3F79","user_header":"https://static001.geekbang.org/account/avatar/00/1d/38/53/738fa9b2.jpg","comment_is_top":false,"comment_ctime":1588556534,"is_pvip":false,"replies":[{"id":103765,"content":"正确。\ndf2[&#39;sum&#39;] = df2[&#39;语文&#39;]+df2[&#39;英语&#39;]+df2[&#39;数学&#39;]\n因为df2只有3个学科的成绩列，所以成绩求和也可以写成df2[&#39;sum&#39;] =df.sum(1)","user_name":"作者回复","user_name_real":"cy","uid":1306094,"ctime":1617041585,"ip_address":"","comment_id":213765,"utype":1}],"discussion_count":1,"race_medal":0,"score":5,"product_id":100021701,"comment_content":"打卡05\nimport pandas as pd\nfrom pandas import Series,DataFrame\ndata={\n&#39;语文&#39;:[66,95,95,90,80,80],\n&#39;英语&#39;:[65,85,92,88,90,90],\n&#39;数学&#39;:[None,98,96,77,90,90]}\ndf2=DataFrame(data,\nindex=[&#39;张飞&#39; , &#39;关羽&#39; , &#39;赵云&#39; , &#39;张飞&#39; , &#39;典韦&#39; , &#39;典韦&#39;],\ncolumns=[&#39;语文&#39;, &#39;英语&#39; ,&#39;数学&#39;])\nprint(df2)\n\n#数据清洗\ndf2 = df2.drop_duplicates() #去除重复行\nprint(df2)\nprint(df2.isnull().any())  #是否有空值\n\n# 使用数学成绩均值填充张飞同学的缺失值\ndf2[&#39;数学&#39;].fillna(df2[&#39;数学&#39;].mean(), inplace=True)\n\ndf2[&#39;sum&#39;] =df2[&#39;语文&#39;]+df2[&#39;英语&#39;]+df2[&#39;数学&#39;]\nprint(df2)\nprint(df2.describe())","like_count":0,"discussions":[{"author":{"id":1306094,"avatar":"https://static001.geekbang.org/account/avatar/00/13/ed/ee/c4779b67.jpg","nickname":"cy","note":"","ucode":"50D653399A31F6","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":493866,"discussion_content":"正确。\ndf2[&amp;#39;sum&amp;#39;] = df2[&amp;#39;语文&amp;#39;]+df2[&amp;#39;英语&amp;#39;]+df2[&amp;#39;数学&amp;#39;]\n因为df2只有3个学科的成绩列，所以成绩求和也可以写成df2[&amp;#39;sum&amp;#39;] =df.sum(1)","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1617041585,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":206433,"user_name":"南辞","can_delete":false,"product_type":"c1","uid":1915530,"ip_address":"","ucode":"098E01EB97E901","user_header":"https://static001.geekbang.org/account/avatar/00/1d/3a/8a/76b03c2f.jpg","comment_is_top":false,"comment_ctime":1586859901,"is_pvip":false,"replies":[{"id":104218,"content":"Good Job!","user_name":"作者回复","user_name_real":"cy","uid":1306094,"ctime":1617730818,"ip_address":"","comment_id":206433,"utype":1}],"discussion_count":1,"race_medal":0,"score":5,"product_id":100021701,"comment_content":"import numpy as np\nimport pandas as pd\nfrom pandas import DataFrame\ndata ={&quot;语文&quot;:[66,95,95,90,80,80],&quot;英语&quot;:[65,85,92,88,90,90],&quot;数学&quot;:[None,98,96,77,90,90]}\ndf1 = DataFrame(data,index=[&quot;张飞&quot;,&quot;关羽&quot;,&quot;赵云&quot;,&quot;黄忠&quot;,&quot;典韦&quot;,&quot;典韦&quot;])\n##开始对数据进行清洗\ndf1.dtypes\n##取消重复值\ndf1 = df1.drop_duplicates()\ndf1\n##用平均值来填充空值\ndf1[&quot;数学&quot;].fillna(df1[&quot;数学&quot;].mean(),inplace = True)\n##数据类型做个转换\ndf1[&quot;数学&quot;] = df1[&quot;数学&quot;].astype(np.int64)\ndf1[&quot;总和&quot;] = df1.sum(axis=1)\n##重新按照总成绩排序\ndf1.sort_values([&quot;总和&quot;],ascending=[False],inplace=True)\n##然后对数据座做一个描述\nprint(df1.describe())","like_count":0,"discussions":[{"author":{"id":1306094,"avatar":"https://static001.geekbang.org/account/avatar/00/13/ed/ee/c4779b67.jpg","nickname":"cy","note":"","ucode":"50D653399A31F6","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":491786,"discussion_content":"Good Job!","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1617730818,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":202484,"user_name":"彭纪程","can_delete":false,"product_type":"c1","uid":1682468,"ip_address":"","ucode":"F9222D72E791C8","user_header":"https://static001.geekbang.org/account/avatar/00/19/ac/24/0684a141.jpg","comment_is_top":false,"comment_ctime":1585995181,"is_pvip":false,"replies":[{"id":104221,"content":"apply()方法用的很不错！ Good Job!","user_name":"作者回复","user_name_real":"cy","uid":1306094,"ctime":1617731364,"ip_address":"","comment_id":202484,"utype":1}],"discussion_count":1,"race_medal":0,"score":5,"product_id":100021701,"comment_content":"import pandas as pd\nfrom pandas import DataFrame\nimport numpy as np\ndata = {&#39;姓名&#39;:[&#39;张飞&#39;,&#39;关羽&#39;,&#39;赵云&#39;,&#39;黄忠&#39;,&#39;典韦&#39;,&#39;典韦&#39;],&#39;语文&#39;:[66,95,95,90,80,80],&#39;英语&#39;:[65,85,92,88,90,90],&#39;数学&#39;:[np.NaN,98,96,77,90,90]}\ndf = DataFrame(data)\nprint(df.describe())\nprint(df.isnull())\ndf = df.drop_duplicates()\ndf=df.fillna(value = df.mean())\ndef sum(df):\n    return df[&#39;语文&#39;] + df[&#39;英语&#39;] + df[&#39;数学&#39;]\ndf[&#39;总和&#39;] = df.apply(sum, axis = 1)\nprint(df)","like_count":0,"discussions":[{"author":{"id":1306094,"avatar":"https://static001.geekbang.org/account/avatar/00/13/ed/ee/c4779b67.jpg","nickname":"cy","note":"","ucode":"50D653399A31F6","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":491786,"discussion_content":"Good Job!","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1617730818,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":202480,"user_name":"极客中心","can_delete":false,"product_type":"c1","uid":1542363,"ip_address":"","ucode":"F1CE36E3E47A3C","user_header":"https://static001.geekbang.org/account/avatar/00/17/88/db/adad4661.jpg","comment_is_top":false,"comment_ctime":1585994528,"is_pvip":false,"replies":[{"id":104220,"content":"Good Job!","user_name":"作者回复","user_name_real":"cy","uid":1306094,"ctime":1617731165,"ip_address":"","comment_id":202480,"utype":1}],"discussion_count":1,"race_medal":0,"score":5,"product_id":100021701,"comment_content":"from pandas import Series,DataFrame\nimport numpy as np\n\nd = {&quot;语文&quot;:[66,95,95,90,80,80],&quot;英语&quot;:[65,85,92,88,90,90],&quot;数学&quot;:[np.nan,98,96,77,90,90]}\ndf3 = DataFrame(d,index=[&quot;张飞&quot;,&quot;关羽&quot;,&quot;赵云&quot;,&quot;黄忠&quot;,&quot;典韦&quot;,&quot;典韦&quot;])\n\n# 查看空值\ndf3.isnull().any()\n\n# 填充空值\ndf3[&#39;数学&#39;].fillna(value=df3[&#39;数学&#39;].mean(),inplace=True)\n\n# 删除重复\ndf3.drop_duplicates(inplace=True)\n\n# 增加一列\ndef plus(df3):\n    df3[&#39;总和&#39;] = df3[&#39;语文&#39;]+df3[&#39;数学&#39;]+df3[&#39;英语&#39;]\n    return df3\n\ndf3 = df3.apply(plus,axis=1)\n\n# 排序\ndf4 = df3.sort_values(by=&#39;总和&#39;,ascending=False,axis=0,inplace=False)","like_count":0,"discussions":[{"author":{"id":1306094,"avatar":"https://static001.geekbang.org/account/avatar/00/13/ed/ee/c4779b67.jpg","nickname":"cy","note":"","ucode":"50D653399A31F6","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":490598,"discussion_content":"apply()方法用的很不错！ Good Job!","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1617731364,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":199366,"user_name":"🌻","can_delete":false,"product_type":"c1","uid":1509651,"ip_address":"","ucode":"9B4D8CA8C09A70","user_header":"https://static001.geekbang.org/account/avatar/00/17/09/13/d762ce74.jpg","comment_is_top":false,"comment_ctime":1585487755,"is_pvip":false,"replies":[{"id":104332,"content":"Good Job","user_name":"作者回复","user_name_real":"cy","uid":1306094,"ctime":1617903157,"ip_address":"","comment_id":199366,"utype":1}],"discussion_count":1,"race_medal":0,"score":5,"product_id":100021701,"comment_content":"# 定义 DataFrame\ndata = [[66, 65], [95, 85, 98], [95, 92,96], \n        [90, 88, 77], [80, 90, 90], [80, 90, 90]]\n\ncolumns = [&#39;语文&#39;,&#39;英语&#39;, &#39;数学&#39;]\nindex = [&#39;张飞&#39;, &#39;关羽&#39;, &#39;赵云&#39;, &#39;黄忠&#39;, &#39;典韦&#39;, &#39;典韦&#39;]\n\ndf = DataFrame(data, index=index, columns=columns)\nprint(df)\n\n# 去重复的值\ndf = df.drop_duplicates()\n\n# 空值设为 0\ndf = df.fillna(0)\n\n# 新增一列“总和”计算每个人的三科成绩之和\n\ndf[&#39;总和&#39;] = df.apply(sum, axis=1)\nprint(df)","like_count":0,"discussions":[{"author":{"id":1306094,"avatar":"https://static001.geekbang.org/account/avatar/00/13/ed/ee/c4779b67.jpg","nickname":"cy","note":"","ucode":"50D653399A31F6","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":489824,"discussion_content":"Good Job","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1617903157,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":195839,"user_name":"十六。","can_delete":false,"product_type":"c1","uid":1935100,"ip_address":"","ucode":"DD4A02E3D904D5","user_header":"","comment_is_top":false,"comment_ctime":1585218678,"is_pvip":false,"replies":[{"id":103995,"content":"Good Job!","user_name":"作者回复","user_name_real":"cy","uid":1306094,"ctime":1617292922,"ip_address":"","comment_id":195839,"utype":1}],"discussion_count":1,"race_medal":0,"score":5,"product_id":100021701,"comment_content":"留言里师哥们学的太好了\n仿照着写了一遍：\nimport pandas as pd\ndata = {&#39;chinese&#39;: [66, 95, 93, 90, 80, 80], &#39;english&#39;: [65, 85, 92, 88, 90, 90],\n        &#39;math&#39;: [None, 98, 96, 77, 90, 90]}\ndf = pd.DataFrame(data, index=[&#39;张飞&#39;, &#39;关羽&#39;, &#39;赵云&#39;, &#39;黄忠&#39;, &#39;典韦&#39;, &#39;典韦&#39;],\n                  columns=[&#39;english&#39;, &#39;chinese&#39;, &#39;math&#39;])\n# 数据清洗\n# 去重、改列名、改类型、对于空值使用该列的均值来填充\ndf = df.drop_duplicates()\n\n# rename函数中columns值为字典类型,并且是在视图修改\ndf.rename(columns={&#39;chinese&#39;:&#39;语文&#39;,&#39;english&#39;:&#39;英语&#39;,&#39;math&#39;:&#39;数学&#39;},inplace=True)\n\n# 对张飞数学成绩进行军靴均值填充\ndf[df.isnull()] = df.iloc[1:,2].mean()\n\n# 之前求总成绩使用的是sum方法直接修改的，这次使用apply函数来写一遍\ndef add_col(df):\n    df[&#39;总成绩&#39;] = df[&#39;语文&#39;]+df[&#39;英语&#39;]+df[&#39;数学&#39;]\n    return df\ndf = df.apply(add_col,axis=1)\n# 按照总成绩进行排序\ndf.sort_values([&#39;总成绩&#39;], ascending=False, inplace=True)\ndf\n\n\n英语\t语文\t数学\t总成绩\n赵云\t92.0\t93.0\t96.00\t281.00\n关羽\t85.0\t95.0\t98.00\t278.00\n典韦\t90.0\t80.0\t90.00\t260.00\n黄忠\t88.0\t90.0\t77.00\t255.00\n张飞\t65.0\t66.0\t90.25\t221.25\n\n使用 jupyter lab","like_count":0,"discussions":[{"author":{"id":1306094,"avatar":"https://static001.geekbang.org/account/avatar/00/13/ed/ee/c4779b67.jpg","nickname":"cy","note":"","ucode":"50D653399A31F6","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":489170,"discussion_content":"Good Job!","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1617292922,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":195823,"user_name":"十六。","can_delete":false,"product_type":"c1","uid":1935100,"ip_address":"","ucode":"DD4A02E3D904D5","user_header":"","comment_is_top":false,"comment_ctime":1585217157,"is_pvip":false,"replies":[{"id":103996,"content":"Good Gob","user_name":"作者回复","user_name_real":"cy","uid":1306094,"ctime":1617292979,"ip_address":"","comment_id":195823,"utype":1}],"discussion_count":1,"race_medal":0,"score":5,"product_id":100021701,"comment_content":"Pandas中最主要的数据结构是？\nSeries和DataFrame\n它都提供了哪些函数，可以帮我们做数据清洗？你可以自己描述一下吗？\ndropna、drop_duplicate、drop、isnull等\n\n题目：\nimport pandas as pd\ndata = {&#39;chinese&#39;: [66, 95, 93, 90, 80, 80], &#39;english&#39;: [65, 85, 92, 88, 90, 90],\n        &#39;math&#39;: [None, 98, 96, 77, 90, 90]}\ndf = pd.DataFrame(data, index=[&#39;张飞&#39;, &#39;关羽&#39;, &#39;赵云&#39;, &#39;黄忠&#39;, &#39;典韦&#39;, &#39;典韦&#39;],\n                  columns=[&#39;english&#39;, &#39;chinese&#39;, &#39;math&#39;])\n# 分析表格，存在空值，重复行\ndf = df.drop_duplicates()\ndf[df.isnull()] = 0\ndf = df.astype(dtype=&#39;i&#39;)\ndf[&#39;general&#39;] = df.sum(axis=1)\ndf\n\nenglish\tchinese\tmath\tgeneral\n张飞\t65\t66\t0\t131\n关羽\t85\t95\t98\t278\n赵云\t92\t93\t96\t281\n黄忠\t88\t90\t77\t255\n典韦\t90\t80\t90\t260","like_count":0,"discussions":[{"author":{"id":1306094,"avatar":"https://static001.geekbang.org/account/avatar/00/13/ed/ee/c4779b67.jpg","nickname":"cy","note":"","ucode":"50D653399A31F6","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":489165,"discussion_content":"Good Gob","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1617292979,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":192502,"user_name":"夕子","can_delete":false,"product_type":"c1","uid":1916066,"ip_address":"","ucode":"4115ABE599B2F4","user_header":"https://static001.geekbang.org/account/avatar/00/1d/3c/a2/09a2215c.jpg","comment_is_top":false,"comment_ctime":1584856141,"is_pvip":false,"replies":[{"id":104353,"content":"总结的很棒！Good Job!!!","user_name":"作者回复","user_name_real":"cy","uid":1306094,"ctime":1617904543,"ip_address":"","comment_id":192502,"utype":1}],"discussion_count":1,"race_medal":0,"score":5,"product_id":100021701,"comment_content":"一、pandas中最主要的两个数据结构是Series和DataFrame。\n二、pandas提供的数据清洗的函数有：\n①drop()，删除不必要的行或者列；\n②rename()，重命名列名；\n③drop_duplicates()，去重复值；\n④astype()，更改数据格式；\n⑤strip，处理数据间的空格，具体有strip()、lstrip()和rstrip()，分别代表两边、左边和右边空格，还可以用来删除数据中的特殊符号；\n⑥upper、lower、title大小写转换；\n⑦isnull()寻找空值，isnull().any()寻找空值所在的列；\n⑧apply()，使用函数，也可以使用自定义函数；\n⑨merge()，数据表合并，包括基于指定列的连接（on=)、左连接(how=&#39;left&#39;)、右连接(how=&#39;right&#39;)、内连接(how=&#39;inner&#39;)和外连接(how=&#39;outer&#39;);\n⑩统计函数，包括describe()、count()、min()、max()、sum()、mean()、median()、var()、std()、argmin()、argmax()、idxmin()、idxmax()。\n\n三、练习题：\n（1）创建DataFrame\nimport pandas as pd\nimport numpy as np\ndata = {&#39;name&#39;:[&#39;ZhangFei&#39;,&#39;GuanYu&#39;,&#39;ZhaoYun&#39;,&#39;HuangZhong&#39;,&#39;DianWei&#39;,&#39;DianWei&#39;],&#39;Chinese&#39;:[66,95,95,90,80,80],&#39;English&#39;:[65,85,92,88,90,90],&#39;Math&#39;:[np.nan,98,96,77,90,90]}\ndf = pd.DataFrame(data,columns=[&#39;name&#39;,&#39;Chinese&#39;,&#39;English&#39;,&#39;Math&#39;])\nprint(df)\n输出：\nname  Chinese  English  Math\n0    ZhangFei       66       65   NaN\n1      GuanYu       95       85  98.0\n2     ZhaoYun       95       92  96.0\n3  HuangZhong       90       88  77.0\n4     DianWei       80       90  90.0\n5     DianWei       80       90  90.0\n（2）# 删除重复值\ndf = df.drop_duplicates()\nprint(df)\n输出结果：\nname  Chinese  English  Math\n0    ZhangFei       66       65  84.0\n1      GuanYu       95       85  98.0\n2     ZhaoYun       95       92  96.0\n3  HuangZhong       90       88  77.0\n4     DianWei       80       90  90.0\n（3）# 新增一列“总和”计算每个人的三科成绩之和\ndf[&#39;total&#39;] = df[&#39;Chinese&#39;]+df[&#39;English&#39;]+df[&#39;Math&#39;]\nprint(df)\n输出结果：\nname  Chinese  English  Math  total\n0    ZhangFei       66       65  84.0  215.0\n1      GuanYu       95       85  98.0  278.0\n2     ZhaoYun       95       92  96.0  283.0\n3  HuangZhong       90       88  77.0  255.0\n4     DianWei       80       90  90.0  260.0\n","like_count":0,"discussions":[{"author":{"id":1306094,"avatar":"https://static001.geekbang.org/account/avatar/00/13/ed/ee/c4779b67.jpg","nickname":"cy","note":"","ucode":"50D653399A31F6","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":489165,"discussion_content":"Good Gob","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1617292979,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":185736,"user_name":"Geek_日月","can_delete":false,"product_type":"c1","uid":1624334,"ip_address":"","ucode":"29CDE87CD74FCE","user_header":"http://thirdwx.qlogo.cn/mmopen/vi_32/Cbn8R1t289AcI6CR2vwuyJDY4pNsy15micFeEiaZSKwzYbicqTY4B4tawBiadDRiarGXzxDkial85dTgzgiaL4NBbiazFA/132","comment_is_top":false,"comment_ctime":1583673081,"is_pvip":false,"replies":[{"id":104362,"content":"Good Job!!!","user_name":"作者回复","user_name_real":"cy","uid":1306094,"ctime":1617904981,"ip_address":"","comment_id":185736,"utype":1}],"discussion_count":1,"race_medal":0,"score":5,"product_id":100021701,"comment_content":"import pandas as pd\nfrom pandas import Series, DataFrame\ndata = {&#39;Chinese&#39;: [66, 95, 95, 90, 80, 80],&#39;English&#39;: [65, 85, 92, 88, 90, 90],&#39;Math&#39;: [None, 98, 96, 77, 90, 90]}\n#df1= DataFrame(data)\ndf = DataFrame(data, index=[&#39;ZhangFei&#39;, &#39;GuanYu&#39;, &#39;ZhaoYun&#39;, &#39;HuangZhong&#39;, &#39;DianWei&#39;, &#39;DianWei&#39;], columns=[&#39;English&#39;, &#39;Math&#39;, &#39;Chinese&#39;])\n\n## 去除重复行\ndf = df.drop_duplicates()\n\n### 改名\ndf.rename(index={&#39;ZhangFei&#39;: &#39;张飞&#39;, &#39;GuanYu&#39;: &#39;关羽&#39;, &#39;ZhaoYun&#39;: &#39;赵云&#39;, &#39;DianWei&#39;: &#39;典韦&#39;,&#39;HuangZhong&#39;: &#39;黄忠&#39;}, inplace = True)\ndf.rename(columns={&#39;English&#39;: &#39;英语&#39;, &#39;Math&#39;: &#39;数学&#39;, &#39;Chinese&#39;: &#39;中文&#39;}, inplace = True)\nprint(df)\n\n#去一个中间数值进行填充None\ndf[&#39;数学&#39;].fillna(df[&#39;数学&#39;].median(),inplace=True)\n\n##去除有空值的行\nprint(df.isnull())\nprint(df.isnull().any())\ndf = df.dropna(how=&#39;any&#39;,axis=0)\n\nprint(df)\ndf[&#39;totle&#39;] = df[&#39;英语&#39;] + df[&#39;数学&#39;] + df[&#39;中文&#39;]\nprint(df)\nprint(df.describe())","like_count":0,"discussions":[{"author":{"id":1306094,"avatar":"https://static001.geekbang.org/account/avatar/00/13/ed/ee/c4779b67.jpg","nickname":"cy","note":"","ucode":"50D653399A31F6","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":488411,"discussion_content":"总结的很棒！Good Job!!!","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1617904543,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":172822,"user_name":"pencilCool","can_delete":false,"product_type":"c1","uid":1461770,"ip_address":"","ucode":"49A9FE2DEE2911","user_header":"https://static001.geekbang.org/account/avatar/00/16/4e/0a/0ff15eaa.jpg","comment_is_top":false,"comment_ctime":1579325705,"is_pvip":false,"replies":[{"id":104013,"content":"感谢pencilCool的分享，Mac同学安装numpy 和pandas报错的同学可以看下","user_name":"作者回复","user_name_real":"cy","uid":1306094,"ctime":1617293843,"ip_address":"","comment_id":172822,"utype":1}],"discussion_count":1,"race_medal":0,"score":5,"product_id":100021701,"comment_content":"mac 电脑上 最近python 2.x 安装numpy 和pandas 会报各种错误。\npip 升级，然后pip3 命令用不了了。没关系pip 升级后默认用的就是python3了\n然后使用如下命令安装：\nsudo pip install Pandas -i http:&#47;&#47;mirrors.aliyun.com&#47;pypi&#47;simple --trusted-host mirrors.aliyun.com\n很快就安装好了","like_count":0,"discussions":[{"author":{"id":1306094,"avatar":"https://static001.geekbang.org/account/avatar/00/13/ed/ee/c4779b67.jpg","nickname":"cy","note":"","ucode":"50D653399A31F6","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":486481,"discussion_content":"Good Job!!!","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1617904981,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":171420,"user_name":"李宽","can_delete":false,"product_type":"c1","uid":1082930,"ip_address":"","ucode":"627B16DBFAAA32","user_header":"https://static001.geekbang.org/account/avatar/00/10/86/32/6a8049eb.jpg","comment_is_top":false,"comment_ctime":1578921292,"is_pvip":false,"replies":[{"id":104014,"content":"Good Job","user_name":"作者回复","user_name_real":"cy","uid":1306094,"ctime":1617293911,"ip_address":"","comment_id":171420,"utype":1}],"discussion_count":1,"race_medal":0,"score":6,"product_id":100021701,"comment_content":"import pandas as pd\nfrom pandas import Series, DataFrame\nindex = [&#39;张飞&#39;,&#39;关羽&#39;,&#39;赵云&#39;,&#39;黄忠&#39;,&#39;典韦&#39;,&#39;典韦&#39;]\ndata = {&#39;语文&#39;:[66,95,95,90,80,80],&#39;英语&#39;:[65,85,92,88,90,90],&#39;数学&#39;:[np.nan,98,96,77,90,90]}\nscore = DataFrame(data, index=index)\nscore = score.drop_duplicates()\nscore[&#39;数学&#39;] = score[&#39;数学&#39;].fillna(score[&#39;数学&#39;].mean())\nscore[&#39;总和&#39;] = score.sum(axis=1)","like_count":0},{"had_liked":false,"id":160247,"user_name":"满怀","can_delete":false,"product_type":"c1","uid":1483113,"ip_address":"","ucode":"EFAC662A37D684","user_header":"https://static001.geekbang.org/account/avatar/00/16/a1/69/0ddda908.jpg","comment_is_top":false,"comment_ctime":1575898648,"is_pvip":false,"replies":[{"id":62657,"content":"代码正确，如果不用xlsx的同学，也可以使用score = DataFrame(pd.read_csv(&#39;score.csv&#39;, encoding=&#39;gbk&#39;))","user_name":"作者回复","user_name_real":"cy","uid":1306094,"ctime":1577081748,"ip_address":"","comment_id":160247,"utype":1}],"discussion_count":1,"race_medal":0,"score":6,"product_id":100021701,"comment_content":"import pandas as pd\nfrom pandas import DataFrame\nfrom pandasql import sqldf, load_meat, load_births\n# 导入数据\nscore = DataFrame(pd.read_excel(&#39;score.xlsx&#39;))\nprint (&#39;原生数据:&#39;)\nprint (score)\n# 数据去重\nscore = score.drop_duplicates()\nprint (&#39;去重后数据:&#39;)\nprint (score)\n# 列名改为英文\nscore.rename(columns={&#39;姓名&#39;:&#39;Name&#39;,&#39;语文&#39;:&#39;Chinese&#39;,&#39;英语&#39;:&#39;English&#39;,&#39;数学&#39;:&#39;Math&#39;},inplace=True)\nprint (&#39;修改列名后数据:&#39;)\nprint (score)\n# 列名重新排序\ncols = [&#39;Name&#39;,&#39;Chinese&#39;,&#39;Math&#39;,&#39;English&#39;]\nscore = score.filter(cols,axis=1)\nprint (&#39;列名重排后数据:&#39;)\nprint (score)\n# 查看哪一列存在空值\nprint (score.isnull().any())\nprint (score.isnull())\n# 使用数据成绩均值填充张飞同学的缺失值\nscore[&#39;Math&#39;].fillna(score[&#39;Math&#39;].mean(),inplace=True)\nprint (&#39;数据清洗完成后数据:&#39;)\nprint (score)\n# 新增一列总和\n# 由于发现当行记录当中存在NaN空值时无法计算总和，所以需要对数据先进行清洗\ndef add_sum(df):\n    df[&#39;Sum&#39;] = df[&#39;Chinese&#39;] + df[&#39;Math&#39;] + df[&#39;English&#39;]\n    return df\nscore = score.apply(add_sum,axis=1)\nprint (&#39;加入新列总分后的数据&#39;)\nprint (score)\n# 按照总分排序由高到低\nscore.sort_values([&#39;Sum&#39;],ascending=[False],inplace=True)\nprint (&#39;最终数据:&#39;)\nprint (score)\n# 显示数据具体信息\nprint (&#39;数据统计信息:&#39;)\nprint (score.describe())\nscore.to_excel(&#39;last_score.xlsx&#39;)","like_count":0,"discussions":[{"author":{"id":1306094,"avatar":"https://static001.geekbang.org/account/avatar/00/13/ed/ee/c4779b67.jpg","nickname":"cy","note":"","ucode":"50D653399A31F6","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":481340,"discussion_content":"Good Job","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1617293911,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":158454,"user_name":"毕延超","can_delete":false,"product_type":"c1","uid":1738400,"ip_address":"","ucode":"364728DC261DA3","user_header":"https://static001.geekbang.org/account/avatar/00/1a/86/a0/63254a99.jpg","comment_is_top":false,"comment_ctime":1575375802,"is_pvip":false,"replies":[{"id":62626,"content":"locals() 和 globals() 就是局部变量和全局变量的区别","user_name":"作者回复","user_name_real":"cy","uid":1306094,"ctime":1577078385,"ip_address":"","comment_id":158454,"utype":1}],"discussion_count":1,"race_medal":0,"score":6,"product_id":100021701,"comment_content":"执行sql语句的那里globals与locals的用法有什么区别","like_count":0,"discussions":[{"author":{"id":1306094,"avatar":"https://static001.geekbang.org/account/avatar/00/13/ed/ee/c4779b67.jpg","nickname":"cy","note":"","ucode":"50D653399A31F6","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":477314,"discussion_content":"代码正确，如果不用xlsx的同学，也可以使用score = DataFrame(pd.read_csv(&amp;#39;score.csv&amp;#39;, encoding=&amp;#39;gbk&amp;#39;))","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1577081748,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":144373,"user_name":"疯子书生z","can_delete":false,"product_type":"c1","uid":1270544,"ip_address":"","ucode":"6AD3FCD6960656","user_header":"http://thirdwx.qlogo.cn/mmopen/vi_32/tkcQfAzEOt9GDOFiaTxcgia4C3qpyZpGysDCVqKGrJ84RplrziaWokZr7iaUwPJ8mLWReAEkGU4cT41UF3GWOmddcg/132","comment_is_top":false,"comment_ctime":1571906140,"is_pvip":false,"replies":[{"id":59761,"content":"后面代码用的都是Python3","user_name":"作者回复","user_name_real":"cy","uid":1306094,"ctime":1574740084,"ip_address":"","comment_id":144373,"utype":1}],"discussion_count":1,"race_medal":0,"score":6,"product_id":100021701,"comment_content":"想知道是啥时候出的教程，python2都停更了\n","like_count":0,"discussions":[{"author":{"id":1306094,"avatar":"https://static001.geekbang.org/account/avatar/00/13/ed/ee/c4779b67.jpg","nickname":"cy","note":"","ucode":"50D653399A31F6","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":476731,"discussion_content":"locals() 和 globals() 就是局部变量和全局变量的区别","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1577078385,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":141476,"user_name":"无心剑","can_delete":false,"product_type":"c1","uid":1699221,"ip_address":"","ucode":"1E671F2C090F84","user_header":"https://static001.geekbang.org/account/avatar/00/19/ed/95/0c024d69.jpg","comment_is_top":false,"comment_ctime":1571180522,"is_pvip":false,"replies":[{"id":62782,"content":"赞下认真做作业的同学，这个总分应该指的是平均分","user_name":"作者回复","user_name_real":"cy","uid":1306094,"ctime":1577092278,"ip_address":"","comment_id":141476,"utype":1}],"discussion_count":1,"race_medal":0,"score":6,"product_id":100021701,"comment_content":"# 成绩处理V1.1\n\nimport pandas as pd\n\ndf = pd.read_excel(&#39;e:&#47;excelfiles&#47;test2.xlsx&#39;)\n\nprint(&quot;原表：&quot;)\nprint(df)\n\n# 1. 用列均值填充NaN值\nfor i in range(1, len(df.columns)):\n    col = df.columns[i]\n    col_mean = round(df[col].mean(), 1)    \n    index = df[df[col].isnull()].index[0]\n    df.loc[index, col] = col_mean\nprint(&quot;用列均值填充NaN值：&quot;)\nprint(df)\n    \n# 2. 删除重复的行\ndf = df.drop_duplicates()\nprint(&quot;删除重复的行：&quot;)\nprint(df)\n\n# 3. 添加总分字段，计算总分\ndf[&#39;总分&#39;] = (df[&#39;语文&#39;] + df[&#39;英语&#39;] + df[&#39;数学&#39;]) &#47; 3\nprint(&quot;添加总分字段：&quot;)\nprint(df)","like_count":0,"discussions":[{"author":{"id":1306094,"avatar":"https://static001.geekbang.org/account/avatar/00/13/ed/ee/c4779b67.jpg","nickname":"cy","note":"","ucode":"50D653399A31F6","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":471908,"discussion_content":"后面代码用的都是Python3","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1574740084,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":141428,"user_name":"无心剑","can_delete":false,"product_type":"c1","uid":1699221,"ip_address":"","ucode":"1E671F2C090F84","user_header":"https://static001.geekbang.org/account/avatar/00/19/ed/95/0c024d69.jpg","comment_is_top":false,"comment_ctime":1571151395,"is_pvip":false,"replies":[{"id":59803,"content":"加油！","user_name":"作者回复","user_name_real":"cy","uid":1306094,"ctime":1574755975,"ip_address":"","comment_id":141428,"utype":1}],"discussion_count":1,"race_medal":0,"score":6,"product_id":100021701,"comment_content":"Python数据分析学习笔记04：Pandas基础（https:&#47;&#47;blog.csdn.net&#47;howard2005&#47;article&#47;details&#47;102561307）今天跟着陈老师学习Pandas，挺有收获。","like_count":0,"discussions":[{"author":{"id":1306094,"avatar":"https://static001.geekbang.org/account/avatar/00/13/ed/ee/c4779b67.jpg","nickname":"cy","note":"","ucode":"50D653399A31F6","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":470763,"discussion_content":"赞下认真做作业的同学，这个总分应该指的是平均分","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1577092278,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":141426,"user_name":"无心剑","can_delete":false,"product_type":"c1","uid":1699221,"ip_address":"","ucode":"1E671F2C090F84","user_header":"https://static001.geekbang.org/account/avatar/00/19/ed/95/0c024d69.jpg","comment_is_top":false,"comment_ctime":1571151258,"is_pvip":false,"replies":[{"id":62783,"content":"直接drop掉是一种方式，有时候还是需要补全的，尤其是对后续分析有帮助的时候","user_name":"作者回复","user_name_real":"cy","uid":1306094,"ctime":1577092307,"ip_address":"","comment_id":141426,"utype":1}],"discussion_count":1,"race_medal":0,"score":6,"product_id":100021701,"comment_content":"如果有多条记录的多个字段存在NaN，要一个一个地补全是比较麻烦的事情，简单粗暴的做法：凡是遇到有NaN的行，统统Kill掉。","like_count":0,"discussions":[{"author":{"id":1306094,"avatar":"https://static001.geekbang.org/account/avatar/00/13/ed/ee/c4779b67.jpg","nickname":"cy","note":"","ucode":"50D653399A31F6","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":470748,"discussion_content":"加油！","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1574755975,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":141423,"user_name":"无心剑","can_delete":false,"product_type":"c1","uid":1699221,"ip_address":"","ucode":"1E671F2C090F84","user_header":"https://static001.geekbang.org/account/avatar/00/19/ed/95/0c024d69.jpg","comment_is_top":false,"comment_ctime":1571150879,"is_pvip":false,"replies":[{"id":62708,"content":"赞 做的不错","user_name":"作者回复","user_name_real":"cy","uid":1306094,"ctime":1577085587,"ip_address":"","comment_id":141423,"utype":1}],"discussion_count":1,"race_medal":0,"score":6,"product_id":100021701,"comment_content":"【源程序】\nimport pandas as pd\nfrom pandas import DataFrame\n\ndf = pd.read_excel(&#39;e:&#47;excelfiles&#47;score.xlsx&#39;)\n\nprint(&quot;原表：&quot;)\nprint(df)\n\n# 1. 删除有NaN值的行\ncols = []\nnullcols = df.isnull().any()\nfor i in range(len(nullcols)):\n    if nullcols[i] == True:\n        cols.append(nullcols.index[i])        \nnulltable = df.isnull()\nfor i in range(len(cols)):\n    nullindex = nulltable[nulltable[cols[i]] == True].index[0]\n    df = df.drop(index = nullindex)\nprint(&quot;删除有NaN的行：&quot;)\nprint(df)\n    \n# 2. 删除重复的行\ndf = df.drop_duplicates()\nprint(&quot;删除重复的行：&quot;)\nprint(df)\n\n# 3. 添加总分字段，计算总分\ndf[&#39;总分&#39;] = (df[&#39;语文&#39;] + df[&#39;英语&#39;] + df[&#39;数学&#39;]) &#47; 3\nprint(&quot;添加总分字段：&quot;)\nprint(df)\n\n【运行结果】\n原表：\n   姓名 语文 英语  数学\n0  张飞  66  65   NaN \n1  关羽  95  85  98.0\n2  赵云  95  92  96.0\n3  黄忠  90  88  77.0\n4  典韦  80  90  90.0\n5  典韦  80  90  90.0\n删除有NaN的行：\n   姓名 语文 英语  数学\n1  关羽  95  85  98.0\n2  赵云  95  92  96.0\n3  黄忠  90  88  77.0\n4  典韦  80  90  90.0\n5  典韦  80  90  90.0\n删除重复的行：\n   姓名 语文 英语 数学\n1  关羽  95  85  98.0\n2  赵云  95  92  96.0\n3  黄忠  90  88  77.0\n4  典韦  80  90  90.0\n添加总分字段：\n   姓名 语文 英语 数学  总分\n1  关羽  95  85  98.0  92.666667\n2  赵云  95  92  96.0  94.333333\n3  黄忠  90  88  77.0  85.000000\n4  典韦  80  90  90.0  86.666667","like_count":0,"discussions":[{"author":{"id":1306094,"avatar":"https://static001.geekbang.org/account/avatar/00/13/ed/ee/c4779b67.jpg","nickname":"cy","note":"","ucode":"50D653399A31F6","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":470747,"discussion_content":"直接drop掉是一种方式，有时候还是需要补全的，尤其是对后续分析有帮助的时候","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1577092307,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":136818,"user_name":"逆光 Aidi","can_delete":false,"product_type":"c1","uid":1677471,"ip_address":"","ucode":"A13D99486B8D58","user_header":"https://static001.geekbang.org/account/avatar/00/19/98/9f/22a3d9ee.jpg","comment_is_top":false,"comment_ctime":1569524729,"is_pvip":false,"replies":[{"id":62716,"content":"#删除左右两边空格\ndf2[&#39;Chinese&#39;]=df2[&#39;Chinese&#39;].map(str.strip)\n#删除左边空格\ndf2[&#39;Chinese&#39;]=df2[&#39;Chinese&#39;].map(str.lstrip)\n#删除右边空格\ndf2[&#39;Chinese&#39;]=df2[&#39;Chinese&#39;].map(str.rstrip)\n\n如果你想要把字符串中所有的空格都去掉，可以使用df2[&#39;Chinese&#39;].replace(&#39; &#39;, &#39;&#39;)","user_name":"作者回复","user_name_real":"cy","uid":1306094,"ctime":1577086441,"ip_address":"","comment_id":136818,"utype":1}],"discussion_count":1,"race_medal":0,"score":6,"product_id":100021701,"comment_content":"不是很懂删空格那里，老师能讲一下吗","like_count":0,"discussions":[{"author":{"id":1306094,"avatar":"https://static001.geekbang.org/account/avatar/00/13/ed/ee/c4779b67.jpg","nickname":"cy","note":"","ucode":"50D653399A31F6","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":470746,"discussion_content":"赞 做的不错","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1577085587,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":128955,"user_name":"王定坤","can_delete":false,"product_type":"c1","uid":1196179,"ip_address":"","ucode":"B82E3768C1BB77","user_header":"https://static001.geekbang.org/account/avatar/00/12/40/93/386b936c.jpg","comment_is_top":false,"comment_ctime":1566992585,"is_pvip":false,"replies":[{"id":63512,"content":"正确，用的Python2","user_name":"作者回复","user_name_real":"cy","uid":1306094,"ctime":1577515680,"ip_address":"","comment_id":128955,"utype":1}],"discussion_count":1,"race_medal":0,"score":6,"product_id":100021701,"comment_content":"# coding=utf-8\n\nimport pandas as pd\nfrom pandas import DataFrame\n\ndata = {&#39;语文&#39;:[66, 95, 95, 90, 80, 80], &#39;数学&#39;:[None, 98, 96, 77, 90, 90], &#39;英语&#39;:[65, 85, 92, 88, 90, 90]}\ndf = DataFrame(data, index=[&#39;张飞&#39;, &#39;关羽&#39;, &#39;赵云&#39;, &#39;黄忠&#39;, &#39;典韦&#39;, &#39;典韦&#39;], columns=[&#39;语文&#39;, &#39;数学&#39;, &#39;英语&#39;])\ndf = df.drop_duplicates()\n\ndf[&#39;总分&#39;] = df[&#39;语文&#39;].add(df[&#39;数学&#39;], fill_value=0).add(df[&#39;英语&#39;], fill_value=0)\nprint df","like_count":0,"discussions":[{"author":{"id":1306094,"avatar":"https://static001.geekbang.org/account/avatar/00/13/ed/ee/c4779b67.jpg","nickname":"cy","note":"","ucode":"50D653399A31F6","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":465193,"discussion_content":"正确，用的Python2","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1577515680,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":171420,"user_name":"李宽","can_delete":false,"product_type":"c1","uid":1082930,"ip_address":"","ucode":"627B16DBFAAA32","user_header":"https://static001.geekbang.org/account/avatar/00/10/86/32/6a8049eb.jpg","comment_is_top":false,"comment_ctime":1578921292,"is_pvip":false,"replies":[{"id":104014,"content":"Good Job","user_name":"作者回复","user_name_real":"cy","uid":1306094,"ctime":1617293911,"ip_address":"","comment_id":171420,"utype":1}],"discussion_count":1,"race_medal":0,"score":6,"product_id":100021701,"comment_content":"import pandas as pd\nfrom pandas import Series, DataFrame\nindex = [&#39;张飞&#39;,&#39;关羽&#39;,&#39;赵云&#39;,&#39;黄忠&#39;,&#39;典韦&#39;,&#39;典韦&#39;]\ndata = {&#39;语文&#39;:[66,95,95,90,80,80],&#39;英语&#39;:[65,85,92,88,90,90],&#39;数学&#39;:[np.nan,98,96,77,90,90]}\nscore = DataFrame(data, index=index)\nscore = score.drop_duplicates()\nscore[&#39;数学&#39;] = score[&#39;数学&#39;].fillna(score[&#39;数学&#39;].mean())\nscore[&#39;总和&#39;] = score.sum(axis=1)","like_count":0,"discussions":[{"author":{"id":1306094,"avatar":"https://static001.geekbang.org/account/avatar/00/13/ed/ee/c4779b67.jpg","nickname":"cy","note":"","ucode":"50D653399A31F6","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":481340,"discussion_content":"Good Job","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1617293911,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":160247,"user_name":"满怀","can_delete":false,"product_type":"c1","uid":1483113,"ip_address":"","ucode":"EFAC662A37D684","user_header":"https://static001.geekbang.org/account/avatar/00/16/a1/69/0ddda908.jpg","comment_is_top":false,"comment_ctime":1575898648,"is_pvip":false,"replies":[{"id":62657,"content":"代码正确，如果不用xlsx的同学，也可以使用score = DataFrame(pd.read_csv(&#39;score.csv&#39;, encoding=&#39;gbk&#39;))","user_name":"作者回复","user_name_real":"cy","uid":1306094,"ctime":1577081748,"ip_address":"","comment_id":160247,"utype":1}],"discussion_count":1,"race_medal":0,"score":6,"product_id":100021701,"comment_content":"import pandas as pd\nfrom pandas import DataFrame\nfrom pandasql import sqldf, load_meat, load_births\n# 导入数据\nscore = DataFrame(pd.read_excel(&#39;score.xlsx&#39;))\nprint (&#39;原生数据:&#39;)\nprint (score)\n# 数据去重\nscore = score.drop_duplicates()\nprint (&#39;去重后数据:&#39;)\nprint (score)\n# 列名改为英文\nscore.rename(columns={&#39;姓名&#39;:&#39;Name&#39;,&#39;语文&#39;:&#39;Chinese&#39;,&#39;英语&#39;:&#39;English&#39;,&#39;数学&#39;:&#39;Math&#39;},inplace=True)\nprint (&#39;修改列名后数据:&#39;)\nprint (score)\n# 列名重新排序\ncols = [&#39;Name&#39;,&#39;Chinese&#39;,&#39;Math&#39;,&#39;English&#39;]\nscore = score.filter(cols,axis=1)\nprint (&#39;列名重排后数据:&#39;)\nprint (score)\n# 查看哪一列存在空值\nprint (score.isnull().any())\nprint (score.isnull())\n# 使用数据成绩均值填充张飞同学的缺失值\nscore[&#39;Math&#39;].fillna(score[&#39;Math&#39;].mean(),inplace=True)\nprint (&#39;数据清洗完成后数据:&#39;)\nprint (score)\n# 新增一列总和\n# 由于发现当行记录当中存在NaN空值时无法计算总和，所以需要对数据先进行清洗\ndef add_sum(df):\n    df[&#39;Sum&#39;] = df[&#39;Chinese&#39;] + df[&#39;Math&#39;] + df[&#39;English&#39;]\n    return df\nscore = score.apply(add_sum,axis=1)\nprint (&#39;加入新列总分后的数据&#39;)\nprint (score)\n# 按照总分排序由高到低\nscore.sort_values([&#39;Sum&#39;],ascending=[False],inplace=True)\nprint (&#39;最终数据:&#39;)\nprint (score)\n# 显示数据具体信息\nprint (&#39;数据统计信息:&#39;)\nprint (score.describe())\nscore.to_excel(&#39;last_score.xlsx&#39;)","like_count":0,"discussions":[{"author":{"id":1306094,"avatar":"https://static001.geekbang.org/account/avatar/00/13/ed/ee/c4779b67.jpg","nickname":"cy","note":"","ucode":"50D653399A31F6","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":477314,"discussion_content":"代码正确，如果不用xlsx的同学，也可以使用score = DataFrame(pd.read_csv(&amp;#39;score.csv&amp;#39;, encoding=&amp;#39;gbk&amp;#39;))","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1577081748,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":158454,"user_name":"毕延超","can_delete":false,"product_type":"c1","uid":1738400,"ip_address":"","ucode":"364728DC261DA3","user_header":"https://static001.geekbang.org/account/avatar/00/1a/86/a0/63254a99.jpg","comment_is_top":false,"comment_ctime":1575375802,"is_pvip":false,"replies":[{"id":62626,"content":"locals() 和 globals() 就是局部变量和全局变量的区别","user_name":"作者回复","user_name_real":"cy","uid":1306094,"ctime":1577078385,"ip_address":"","comment_id":158454,"utype":1}],"discussion_count":1,"race_medal":0,"score":6,"product_id":100021701,"comment_content":"执行sql语句的那里globals与locals的用法有什么区别","like_count":0,"discussions":[{"author":{"id":1306094,"avatar":"https://static001.geekbang.org/account/avatar/00/13/ed/ee/c4779b67.jpg","nickname":"cy","note":"","ucode":"50D653399A31F6","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":476731,"discussion_content":"locals() 和 globals() 就是局部变量和全局变量的区别","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1577078385,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":144373,"user_name":"疯子书生z","can_delete":false,"product_type":"c1","uid":1270544,"ip_address":"","ucode":"6AD3FCD6960656","user_header":"http://thirdwx.qlogo.cn/mmopen/vi_32/tkcQfAzEOt9GDOFiaTxcgia4C3qpyZpGysDCVqKGrJ84RplrziaWokZr7iaUwPJ8mLWReAEkGU4cT41UF3GWOmddcg/132","comment_is_top":false,"comment_ctime":1571906140,"is_pvip":false,"replies":[{"id":59761,"content":"后面代码用的都是Python3","user_name":"作者回复","user_name_real":"cy","uid":1306094,"ctime":1574740084,"ip_address":"","comment_id":144373,"utype":1}],"discussion_count":1,"race_medal":0,"score":6,"product_id":100021701,"comment_content":"想知道是啥时候出的教程，python2都停更了\n","like_count":0,"discussions":[{"author":{"id":1306094,"avatar":"https://static001.geekbang.org/account/avatar/00/13/ed/ee/c4779b67.jpg","nickname":"cy","note":"","ucode":"50D653399A31F6","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":471908,"discussion_content":"后面代码用的都是Python3","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1574740084,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":141476,"user_name":"无心剑","can_delete":false,"product_type":"c1","uid":1699221,"ip_address":"","ucode":"1E671F2C090F84","user_header":"https://static001.geekbang.org/account/avatar/00/19/ed/95/0c024d69.jpg","comment_is_top":false,"comment_ctime":1571180522,"is_pvip":false,"replies":[{"id":62782,"content":"赞下认真做作业的同学，这个总分应该指的是平均分","user_name":"作者回复","user_name_real":"cy","uid":1306094,"ctime":1577092278,"ip_address":"","comment_id":141476,"utype":1}],"discussion_count":1,"race_medal":0,"score":6,"product_id":100021701,"comment_content":"# 成绩处理V1.1\n\nimport pandas as pd\n\ndf = pd.read_excel(&#39;e:&#47;excelfiles&#47;test2.xlsx&#39;)\n\nprint(&quot;原表：&quot;)\nprint(df)\n\n# 1. 用列均值填充NaN值\nfor i in range(1, len(df.columns)):\n    col = df.columns[i]\n    col_mean = round(df[col].mean(), 1)    \n    index = df[df[col].isnull()].index[0]\n    df.loc[index, col] = col_mean\nprint(&quot;用列均值填充NaN值：&quot;)\nprint(df)\n    \n# 2. 删除重复的行\ndf = df.drop_duplicates()\nprint(&quot;删除重复的行：&quot;)\nprint(df)\n\n# 3. 添加总分字段，计算总分\ndf[&#39;总分&#39;] = (df[&#39;语文&#39;] + df[&#39;英语&#39;] + df[&#39;数学&#39;]) &#47; 3\nprint(&quot;添加总分字段：&quot;)\nprint(df)","like_count":0,"discussions":[{"author":{"id":1306094,"avatar":"https://static001.geekbang.org/account/avatar/00/13/ed/ee/c4779b67.jpg","nickname":"cy","note":"","ucode":"50D653399A31F6","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":470763,"discussion_content":"赞下认真做作业的同学，这个总分应该指的是平均分","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1577092278,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":141428,"user_name":"无心剑","can_delete":false,"product_type":"c1","uid":1699221,"ip_address":"","ucode":"1E671F2C090F84","user_header":"https://static001.geekbang.org/account/avatar/00/19/ed/95/0c024d69.jpg","comment_is_top":false,"comment_ctime":1571151395,"is_pvip":false,"replies":[{"id":59803,"content":"加油！","user_name":"作者回复","user_name_real":"cy","uid":1306094,"ctime":1574755975,"ip_address":"","comment_id":141428,"utype":1}],"discussion_count":1,"race_medal":0,"score":6,"product_id":100021701,"comment_content":"Python数据分析学习笔记04：Pandas基础（https:&#47;&#47;blog.csdn.net&#47;howard2005&#47;article&#47;details&#47;102561307）今天跟着陈老师学习Pandas，挺有收获。","like_count":0,"discussions":[{"author":{"id":1306094,"avatar":"https://static001.geekbang.org/account/avatar/00/13/ed/ee/c4779b67.jpg","nickname":"cy","note":"","ucode":"50D653399A31F6","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":470748,"discussion_content":"加油！","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1574755975,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":141426,"user_name":"无心剑","can_delete":false,"product_type":"c1","uid":1699221,"ip_address":"","ucode":"1E671F2C090F84","user_header":"https://static001.geekbang.org/account/avatar/00/19/ed/95/0c024d69.jpg","comment_is_top":false,"comment_ctime":1571151258,"is_pvip":false,"replies":[{"id":62783,"content":"直接drop掉是一种方式，有时候还是需要补全的，尤其是对后续分析有帮助的时候","user_name":"作者回复","user_name_real":"cy","uid":1306094,"ctime":1577092307,"ip_address":"","comment_id":141426,"utype":1}],"discussion_count":1,"race_medal":0,"score":6,"product_id":100021701,"comment_content":"如果有多条记录的多个字段存在NaN，要一个一个地补全是比较麻烦的事情，简单粗暴的做法：凡是遇到有NaN的行，统统Kill掉。","like_count":0,"discussions":[{"author":{"id":1306094,"avatar":"https://static001.geekbang.org/account/avatar/00/13/ed/ee/c4779b67.jpg","nickname":"cy","note":"","ucode":"50D653399A31F6","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":470747,"discussion_content":"直接drop掉是一种方式，有时候还是需要补全的，尤其是对后续分析有帮助的时候","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1577092307,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":141423,"user_name":"无心剑","can_delete":false,"product_type":"c1","uid":1699221,"ip_address":"","ucode":"1E671F2C090F84","user_header":"https://static001.geekbang.org/account/avatar/00/19/ed/95/0c024d69.jpg","comment_is_top":false,"comment_ctime":1571150879,"is_pvip":false,"replies":[{"id":62708,"content":"赞 做的不错","user_name":"作者回复","user_name_real":"cy","uid":1306094,"ctime":1577085587,"ip_address":"","comment_id":141423,"utype":1}],"discussion_count":1,"race_medal":0,"score":6,"product_id":100021701,"comment_content":"【源程序】\nimport pandas as pd\nfrom pandas import DataFrame\n\ndf = pd.read_excel(&#39;e:&#47;excelfiles&#47;score.xlsx&#39;)\n\nprint(&quot;原表：&quot;)\nprint(df)\n\n# 1. 删除有NaN值的行\ncols = []\nnullcols = df.isnull().any()\nfor i in range(len(nullcols)):\n    if nullcols[i] == True:\n        cols.append(nullcols.index[i])        \nnulltable = df.isnull()\nfor i in range(len(cols)):\n    nullindex = nulltable[nulltable[cols[i]] == True].index[0]\n    df = df.drop(index = nullindex)\nprint(&quot;删除有NaN的行：&quot;)\nprint(df)\n    \n# 2. 删除重复的行\ndf = df.drop_duplicates()\nprint(&quot;删除重复的行：&quot;)\nprint(df)\n\n# 3. 添加总分字段，计算总分\ndf[&#39;总分&#39;] = (df[&#39;语文&#39;] + df[&#39;英语&#39;] + df[&#39;数学&#39;]) &#47; 3\nprint(&quot;添加总分字段：&quot;)\nprint(df)\n\n【运行结果】\n原表：\n   姓名 语文 英语  数学\n0  张飞  66  65   NaN \n1  关羽  95  85  98.0\n2  赵云  95  92  96.0\n3  黄忠  90  88  77.0\n4  典韦  80  90  90.0\n5  典韦  80  90  90.0\n删除有NaN的行：\n   姓名 语文 英语  数学\n1  关羽  95  85  98.0\n2  赵云  95  92  96.0\n3  黄忠  90  88  77.0\n4  典韦  80  90  90.0\n5  典韦  80  90  90.0\n删除重复的行：\n   姓名 语文 英语 数学\n1  关羽  95  85  98.0\n2  赵云  95  92  96.0\n3  黄忠  90  88  77.0\n4  典韦  80  90  90.0\n添加总分字段：\n   姓名 语文 英语 数学  总分\n1  关羽  95  85  98.0  92.666667\n2  赵云  95  92  96.0  94.333333\n3  黄忠  90  88  77.0  85.000000\n4  典韦  80  90  90.0  86.666667","like_count":0,"discussions":[{"author":{"id":1306094,"avatar":"https://static001.geekbang.org/account/avatar/00/13/ed/ee/c4779b67.jpg","nickname":"cy","note":"","ucode":"50D653399A31F6","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":470746,"discussion_content":"赞 做的不错","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1577085587,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":136818,"user_name":"逆光 Aidi","can_delete":false,"product_type":"c1","uid":1677471,"ip_address":"","ucode":"A13D99486B8D58","user_header":"https://static001.geekbang.org/account/avatar/00/19/98/9f/22a3d9ee.jpg","comment_is_top":false,"comment_ctime":1569524729,"is_pvip":false,"replies":[{"id":62716,"content":"#删除左右两边空格\ndf2[&#39;Chinese&#39;]=df2[&#39;Chinese&#39;].map(str.strip)\n#删除左边空格\ndf2[&#39;Chinese&#39;]=df2[&#39;Chinese&#39;].map(str.lstrip)\n#删除右边空格\ndf2[&#39;Chinese&#39;]=df2[&#39;Chinese&#39;].map(str.rstrip)\n\n如果你想要把字符串中所有的空格都去掉，可以使用df2[&#39;Chinese&#39;].replace(&#39; &#39;, &#39;&#39;)","user_name":"作者回复","user_name_real":"cy","uid":1306094,"ctime":1577086441,"ip_address":"","comment_id":136818,"utype":1}],"discussion_count":1,"race_medal":0,"score":6,"product_id":100021701,"comment_content":"不是很懂删空格那里，老师能讲一下吗","like_count":0,"discussions":[{"author":{"id":1306094,"avatar":"https://static001.geekbang.org/account/avatar/00/13/ed/ee/c4779b67.jpg","nickname":"cy","note":"","ucode":"50D653399A31F6","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":468809,"discussion_content":"#删除左右两边空格\ndf2[&amp;#39;Chinese&amp;#39;]=df2[&amp;#39;Chinese&amp;#39;].map(str.strip)\n#删除左边空格\ndf2[&amp;#39;Chinese&amp;#39;]=df2[&amp;#39;Chinese&amp;#39;].map(str.lstrip)\n#删除右边空格\ndf2[&amp;#39;Chinese&amp;#39;]=df2[&amp;#39;Chinese&amp;#39;].map(str.rstrip)\n\n如果你想要把字符串中所有的空格都去掉，可以使用df2[&amp;#39;Chinese&amp;#39;].replace(&amp;#39; &amp;#39;, &amp;#39;&amp;#39;)","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1577086441,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":128955,"user_name":"王定坤","can_delete":false,"product_type":"c1","uid":1196179,"ip_address":"","ucode":"B82E3768C1BB77","user_header":"https://static001.geekbang.org/account/avatar/00/12/40/93/386b936c.jpg","comment_is_top":false,"comment_ctime":1566992585,"is_pvip":false,"replies":[{"id":63512,"content":"正确，用的Python2","user_name":"作者回复","user_name_real":"cy","uid":1306094,"ctime":1577515680,"ip_address":"","comment_id":128955,"utype":1}],"discussion_count":1,"race_medal":0,"score":6,"product_id":100021701,"comment_content":"# coding=utf-8\n\nimport pandas as pd\nfrom pandas import DataFrame\n\ndata = {&#39;语文&#39;:[66, 95, 95, 90, 80, 80], &#39;数学&#39;:[None, 98, 96, 77, 90, 90], &#39;英语&#39;:[65, 85, 92, 88, 90, 90]}\ndf = DataFrame(data, index=[&#39;张飞&#39;, &#39;关羽&#39;, &#39;赵云&#39;, &#39;黄忠&#39;, &#39;典韦&#39;, &#39;典韦&#39;], columns=[&#39;语文&#39;, &#39;数学&#39;, &#39;英语&#39;])\ndf = df.drop_duplicates()\n\ndf[&#39;总分&#39;] = df[&#39;语文&#39;].add(df[&#39;数学&#39;], fill_value=0).add(df[&#39;英语&#39;], fill_value=0)\nprint df","like_count":0,"discussions":[{"author":{"id":1306094,"avatar":"https://static001.geekbang.org/account/avatar/00/13/ed/ee/c4779b67.jpg","nickname":"cy","note":"","ucode":"50D653399A31F6","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":468809,"discussion_content":"#删除左右两边空格\ndf2[&amp;#39;Chinese&amp;#39;]=df2[&amp;#39;Chinese&amp;#39;].map(str.strip)\n#删除左边空格\ndf2[&amp;#39;Chinese&amp;#39;]=df2[&amp;#39;Chinese&amp;#39;].map(str.lstrip)\n#删除右边空格\ndf2[&amp;#39;Chinese&amp;#39;]=df2[&amp;#39;Chinese&amp;#39;].map(str.rstrip)\n\n如果你想要把字符串中所有的空格都去掉，可以使用df2[&amp;#39;Chinese&amp;#39;].replace(&amp;#39; &amp;#39;, &amp;#39;&amp;#39;)","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1577086441,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":123844,"user_name":"Geek_661f9f","can_delete":false,"product_type":"c1","uid":1606166,"ip_address":"","ucode":"4F803965D2B080","user_header":"http://thirdwx.qlogo.cn/mmopen/vi_32/dicYnIuz436fF0rvdd5fHCj2GM1NTtuasz4kibdg7AVnWpsGL57icflFeQBXdyXSpBpeNaSN3FxGZmHFJc0iaq1nPw/132","comment_is_top":false,"comment_ctime":1565770198,"is_pvip":false,"replies":[{"id":63522,"content":"Good Job，完成就是胜利","user_name":"作者回复","user_name_real":"cy","uid":1306094,"ctime":1577516615,"ip_address":"","comment_id":123844,"utype":1}],"discussion_count":1,"race_medal":0,"score":7,"product_id":100021701,"comment_content":"第一次试着挣扎地写完整，折腾了好久\n# ！&#47;usr&#47;bin&#47;env python\n# -*- coding:utf-8 -*-\nimport pandas as pd\nimport numpy as np\ndata = {&#39;语文&#39;:[66,95,95,90,80,80],&#39;英语&#39;:[65,85,92,88,90,90],\n        &#39;数学&#39;:[None,98,96,77,90,90],&#39;tatal&#39;:[None,None,None,None,None,None]}\ndf1= pd.DataFrame(data,index=[&#39;张飞&#39;,&#39;关羽&#39;,&#39;赵云&#39;,&#39;黄忠&#39;,&#39;典韦&#39;,&#39;典韦&#39;],\n                  columns=[&#39;语文&#39;,&#39;英语&#39;,&#39;数学&#39;,&#39;total&#39;])\n\n#print(df1)\n\n#去重复行\ndf1 = df1.drop_duplicates()\nprint(df1)\n&#39;&#39;&#39;\n#查空值\ndf1= df1.isnull()\nprint(df1)\ndf1= df1.isnull().any()\nprint(df1)\n&#39;&#39;&#39;\n#用数学平均值补充张飞的数学成绩\ndf1[&#39;数学&#39;].fillna(df1[&#39;数学&#39;].mean(),inplace=True)\n#计算总成绩并进行排名\ndf1[&#39;total&#39;]=sorted(df1.sum(axis=1))\n\nprint(df1)","like_count":0},{"had_liked":false,"id":119273,"user_name":"张怡铭","can_delete":false,"product_type":"c1","uid":1617440,"ip_address":"","ucode":"3D4025CFF787D3","user_header":"https://static001.geekbang.org/account/avatar/00/18/ae/20/e92a1d97.jpg","comment_is_top":false,"comment_ctime":1564548774,"is_pvip":false,"replies":[{"id":63603,"content":"Good Job 多谢分享","user_name":"作者回复","user_name_real":"cy","uid":1306094,"ctime":1577520705,"ip_address":"","comment_id":119273,"utype":1}],"discussion_count":1,"race_medal":0,"score":7,"product_id":100021701,"comment_content":"#!&#47;usr&#47;bin&#47;env python3\n# -*- coding: utf-8 -*-\n\nimport pandas as pd\nfrom pandas import  Series, DataFrame\n# x1 = Series([1,2,3,4])\n# x2 = Series(data = [1,2,3,4], index=[&#39;a&#39;, &#39;b&#39;, &#39;c&#39;, &#39;d&#39;])\n# print(x1)\n# print(x2)\n#\n# # 字典\n# d = {&#39;a&#39;:1, &#39;b&#39;:2, &#39;c&#39;:3, &#39;d&#39;:4}\n# x3 = Series(d)\n# print(x3)\n#\n# # DataFrame 数据库表\n#\n# data = {&#39;chinese&#39;:[66, 95, 93, 90, 80],\n#         &#39;english&#39;:[65,85, 92, 88, 90],\n#         &#39;math&#39;:[30, 98, 96, 77, 90]}\n#\n# df1 = DataFrame(data)\n# df2 = DataFrame(data, index=[&#39;zhangfei&#39;, &#39;nanyi&#39;, &#39;zym&#39;, &#39;mengyi&#39;, &#39;lwei&#39;], columns=[&#39;chinese&#39;, &#39;english&#39;, &#39;math&#39;])\n# print(df1)\n# print(df2)\n# print(df2.describe())\n#\nscore = DataFrame(pd.read_excel(&#39;data09.xlsx&#39;))\n# print(score)\nscore = score.drop_duplicates()\n# print(score)\n# print(score.isnull())\n# print(score.describe())\n\n#二、指定inplace参数 填充 NaN 值\n\nscore[&#39;数学&#39;].fillna(score[&#39;数学&#39;].mean(), inplace = True)\nprint(score)\ndef plus(df):\n    df[&#39;总分&#39;] = df[&#39;语文&#39;] + df[&#39;英语&#39;] + df[&#39;数学&#39;]\n    return df\nscore = score.apply(plus, axis = 1)\nprint(score)\n\n&#39;&#39;&#39;\n## 参数    \nDataFrame.sort_values(by, axis=0, ascending=True, inplace=False, kind=&#39;quicksort&#39;, na_position=&#39;last&#39;)  \n#### 参数说明    \naxis:{0 or ‘index’, 1 or ‘columns’}, default 0，默认按照索引排序，即纵向排序，如果为1，则是横向排序    \nby:str or list of str；如果axis=0，那么by=&quot;列名&quot;；如果axis=1，那么by=&quot;行名&quot;；  \nascending:布尔型，True则升序，可以是[True,False]，即第一字段升序，第二个降序  \ninplace:布尔型，是否用排序后的数据框替换现有的数据框  \nkind:排序方法，{‘quicksort’, ‘mergesort’, ‘heapsort’}, default ‘quicksort’。似乎不用太关心  \nna_position : {‘first’, ‘last’}, default ‘last’，默认缺失值排在最后面 \n&#39;&#39;&#39;\nprint(score.sort_values(by = &#39;总分&#39;, axis = 0, ascending= False, inplace= False))","like_count":0,"discussions":[{"author":{"id":1306094,"avatar":"https://static001.geekbang.org/account/avatar/00/13/ed/ee/c4779b67.jpg","nickname":"cy","note":"","ucode":"50D653399A31F6","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":460818,"discussion_content":"Good Job 多谢分享","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1577520705,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":118545,"user_name":"六天六夜六斤作业","can_delete":false,"product_type":"c1","uid":1292302,"ip_address":"","ucode":"5A5DE3BD2732DC","user_header":"https://static001.geekbang.org/account/avatar/00/13/b8/0e/795c1d59.jpg","comment_is_top":false,"comment_ctime":1564384897,"is_pvip":false,"replies":[{"id":47094,"content":"感谢支持，加油！","user_name":"作者回复","user_name_real":"cy","uid":1306094,"ctime":1566630404,"ip_address":"","comment_id":118545,"utype":1}],"discussion_count":1,"race_medal":0,"score":7,"product_id":100021701,"comment_content":"赞！非常好，非常精炼！！！继续学习下去","like_count":0,"discussions":[{"author":{"id":1306094,"avatar":"https://static001.geekbang.org/account/avatar/00/13/ed/ee/c4779b67.jpg","nickname":"cy","note":"","ucode":"50D653399A31F6","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":460446,"discussion_content":"感谢支持，加油！","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1566630404,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":116540,"user_name":"Geek_ray","can_delete":false,"product_type":"c1","uid":1514914,"ip_address":"","ucode":"957D73A3E4AAA4","user_header":"https://static001.geekbang.org/account/avatar/00/17/1d/a2/36a558e8.jpg","comment_is_top":false,"comment_ctime":1563866504,"is_pvip":false,"replies":[{"id":63646,"content":"需要check下环境","user_name":"作者回复","user_name_real":"cy","uid":1306094,"ctime":1577526377,"ip_address":"","comment_id":116540,"utype":1}],"discussion_count":1,"race_medal":0,"score":7,"product_id":100021701,"comment_content":"为何我更改数据类型不报错，但不成功？拿老师的代码尝试，也是如此，求助","like_count":0,"discussions":[{"author":{"id":1306094,"avatar":"https://static001.geekbang.org/account/avatar/00/13/ed/ee/c4779b67.jpg","nickname":"cy","note":"","ucode":"50D653399A31F6","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":460446,"discussion_content":"感谢支持，加油！","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1566630404,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":115645,"user_name":"刘宇滨","can_delete":false,"product_type":"c1","uid":1236593,"ip_address":"","ucode":"9A0E066DDAE2B9","user_header":"https://static001.geekbang.org/account/avatar/00/12/de/71/8b0f010e.jpg","comment_is_top":false,"comment_ctime":1563681129,"is_pvip":false,"replies":[{"id":63674,"content":"Good Job","user_name":"作者回复","user_name_real":"cy","uid":1306094,"ctime":1577527907,"ip_address":"","comment_id":115645,"utype":1}],"discussion_count":1,"race_medal":0,"score":7,"product_id":100021701,"comment_content":"练习题：\nimport pandas as pd\n\ndata = {&quot;name&quot;: [&quot;张飞&quot;, &quot;关羽&quot;, &quot;赵云&quot;, &quot;黄忠&quot;, &quot;典韦&quot;, &quot;典韦&quot;],\n        &quot;chinese&quot;: [66, 95, 95, 90, 80, 80],\n        &quot;english&quot;: [65, 85, 92, 88, 90, 90],\n        &quot;math&quot;: [None, 98, 96, 77, 90, 90]}\n\ngrade_df = pd.DataFrame(data, columns=[&quot;name&quot;, &quot;chinese&quot;, &quot;english&quot;, &quot;math&quot;])\n\n# 去除重复行\ngrade_df = grade_df.drop_duplicates()\n\n# 重命列名\ngrade_df.rename(columns={&quot;name&quot;:&quot;姓名&quot;, &quot;chinese&quot;:&quot;语文&quot;, &quot;english&quot;:&quot;英语&quot;, &quot;math&quot;:&quot;数学&quot;}, inplace=True)\n\n# 用数学成绩平均值填充张飞数学成绩缺失值\nmath_mean = grade_df[&quot;数学&quot;].mean()\ngrade_df = grade_df.fillna(math_mean)\n\ngrade_df[&quot;总成绩&quot;] = grade_df.sum(axis=1)","like_count":0,"discussions":[{"author":{"id":1306094,"avatar":"https://static001.geekbang.org/account/avatar/00/13/ed/ee/c4779b67.jpg","nickname":"cy","note":"","ucode":"50D653399A31F6","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":459206,"discussion_content":"Good Job","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1577527907,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":114669,"user_name":"Geek_shirley","can_delete":false,"product_type":"c1","uid":1599050,"ip_address":"","ucode":"A1D6BBF37B8337","user_header":"http://thirdwx.qlogo.cn/mmopen/vi_32/oQZ3rnHKdFrWgJDwABx9AUsf6fBibHLAsruGRsmD43lA6Zy1zicKfJsSNLOE2ZRsd8oIpPSznJLDFuUfIK8tUung/132","comment_is_top":false,"comment_ctime":1563359820,"is_pvip":false,"replies":[{"id":63809,"content":"python本身可以做一些BI的工作，当然也可以使用第三方的BI工具\n如果是打比赛的话，比如kaggle，一般还是自己写的多，因为需要做一些特征工程，然后再调用各种算法模型","user_name":"作者回复","user_name_real":"cy","uid":1306094,"ctime":1577542399,"ip_address":"","comment_id":114669,"utype":1}],"discussion_count":1,"race_medal":0,"score":7,"product_id":100021701,"comment_content":"这些函数库很多bi工具都支持，而且bi工具用起来更容易上手，并自动data visualization。老师如何看待python和bi工具的差别？","like_count":0,"discussions":[{"author":{"id":1306094,"avatar":"https://static001.geekbang.org/account/avatar/00/13/ed/ee/c4779b67.jpg","nickname":"cy","note":"","ucode":"50D653399A31F6","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":458767,"discussion_content":"python本身可以做一些BI的工作，当然也可以使用第三方的BI工具\n如果是打比赛的话，比如kaggle，一般还是自己写的多，因为需要做一些特征工程，然后再调用各种算法模型","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1577542399,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":114210,"user_name":"Untitled","can_delete":false,"product_type":"c1","uid":1039464,"ip_address":"","ucode":"8DD6ABA3E81A2E","user_header":"https://static001.geekbang.org/account/avatar/00/0f/dc/68/006ba72c.jpg","comment_is_top":false,"comment_ctime":1563252125,"is_pvip":false,"replies":[{"id":63695,"content":"Good Job","user_name":"作者回复","user_name_real":"cy","uid":1306094,"ctime":1577528457,"ip_address":"","comment_id":114210,"utype":1}],"discussion_count":1,"race_medal":0,"score":7,"product_id":100021701,"comment_content":"import pandas as pd\ndf1 = pd.read_excel(&#39;shizan-5.xlsx&#39;,index_col=0)\n#数据清洗\ndf1 = df1.drop_duplicates()#去重\ndf1 = df1.drop(index=df1[df1.isnull().any(axis=1) == True].index)#删除有空值的行\n#数据统计\ndef sum_of_all(df):\n    df[u&#39;总分&#39;] = df[u&#39;语文&#39;] + df[u&#39;英语&#39;] + df[u&#39;数学&#39;]\n    return df\ndf1 = df1.apply(sum_of_all,axis=1)\nprint(df1.sort_values(by=u&#39;总分&#39;))","like_count":0,"discussions":[{"author":{"id":1306094,"avatar":"https://static001.geekbang.org/account/avatar/00/13/ed/ee/c4779b67.jpg","nickname":"cy","note":"","ucode":"50D653399A31F6","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":458556,"discussion_content":"Good Job","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1577528457,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":109615,"user_name":"内存爆了","can_delete":false,"product_type":"c1","uid":1590007,"ip_address":"","ucode":"A0825B772CC3DF","user_header":"https://static001.geekbang.org/account/avatar/00/18/42/f7/67a2e6ee.jpg","comment_is_top":false,"comment_ctime":1562066621,"is_pvip":false,"replies":[{"id":63926,"content":"加油","user_name":"作者回复","user_name_real":"cy","uid":1306094,"ctime":1577605129,"ip_address":"","comment_id":109615,"utype":1}],"discussion_count":1,"race_medal":0,"score":7,"product_id":100021701,"comment_content":"## 课后习题：\n- 我的答案：感觉知识没有全用上，数学成绩NaN没解决\n```python\nimport pandas as pd\nfrom pandas import Series, DataFrame\ndata = DataFrame(pd.read_excel(&#39;data1.xlsx&#39;))\ndf = DataFrame(data)\ndf = df.drop_duplicates()\ndef sum(df):\n    df[&#39;zcj&#39;] = (df[u&#39;语文&#39;]+df[u&#39;英语&#39;]+df[u&#39;数学&#39;])\n    return df\ndf = df.apply(sum, axis=1)\nprint(df)\n```\n看到评论才知道别人多么优秀啊，加油！","like_count":0,"discussions":[{"author":{"id":1306094,"avatar":"https://static001.geekbang.org/account/avatar/00/13/ed/ee/c4779b67.jpg","nickname":"cy","note":"","ucode":"50D653399A31F6","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":456487,"discussion_content":"加油","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1577605129,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":109155,"user_name":"2525","can_delete":false,"product_type":"c1","uid":1180247,"ip_address":"","ucode":"2426488C258203","user_header":"https://static001.geekbang.org/account/avatar/00/12/02/57/9b235866.jpg","comment_is_top":false,"comment_ctime":1561972119,"is_pvip":false,"replies":[{"id":63931,"content":"Good Job","user_name":"作者回复","user_name_real":"cy","uid":1306094,"ctime":1577605421,"ip_address":"","comment_id":109155,"utype":1}],"discussion_count":1,"race_medal":0,"score":7,"product_id":100021701,"comment_content":"python 3.0习题代码:\n\nimport pandas as pd\npd.set_option(&#39;display.unicode.ambiguous_as_wide&#39;, True)\npd.set_option(&#39;display.unicode.east_asian_width&#39;, True)\ndf1=pd.DataFrame(data={&quot;语文&quot;:[66,95,95,90,80,80],&quot;英语&quot;:[65,85,92,88,90,90],&quot;数学&quot;:[None,98,96,77,90,90]},\n                 index=(&quot;张飞&quot;,&quot;关羽&quot;,&quot;赵云&quot;,&quot;黄忠&quot;,&quot;典韦&quot;,&quot;典韦&quot;))\nprint(df1,end=&quot;\\n_______________________\\n&quot;)\ndf1.drop_duplicates(subset=[&quot;语文&quot;,&quot;英语&quot;,&quot;数学&quot;],keep=&quot;last&quot;,inplace=True)\ndf1.dropna(inplace=True)\nprint(df1,end=&quot;\\n_______________________\\n&quot;)\ndef sum(serie_item):\n    serie_item[&quot;总和&quot;]=serie_item.values.sum()\n    return serie_item\ndf1=df1.apply(sum,axis=1)\nprint(df1)","like_count":0,"discussions":[{"author":{"id":1306094,"avatar":"https://static001.geekbang.org/account/avatar/00/13/ed/ee/c4779b67.jpg","nickname":"cy","note":"","ucode":"50D653399A31F6","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":456271,"discussion_content":"Good Job","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1577605421,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":108287,"user_name":"华夏","can_delete":false,"product_type":"c1","uid":1449474,"ip_address":"","ucode":"4D627CFA5A4B82","user_header":"https://static001.geekbang.org/account/avatar/00/16/1e/02/2864e0f2.jpg","comment_is_top":false,"comment_ctime":1561712767,"is_pvip":false,"replies":[{"id":63987,"content":"Good Job","user_name":"作者回复","user_name_real":"cy","uid":1306094,"ctime":1577606877,"ip_address":"","comment_id":108287,"utype":1}],"discussion_count":1,"race_medal":0,"score":7,"product_id":100021701,"comment_content":"import pandas as pd\nfrom pandas import Series, DataFrame\n\n\ndata = {&#39;语文&#39;: [66, 95, 93, 90, 80, 80],&#39;英语&#39;: [65, 85, 92, 88, 90, 90],&#39;数学&#39;: [ None, 98, 96, 77, 90, 90]}\ndf1 = DataFrame(data, index=[&#39;张飞&#39;, &#39;关羽&#39;, &#39;赵云&#39;, &#39;黄忠&#39;, &#39;典韦&#39;, &#39;典韦&#39;], \n                columns=[&#39;语文&#39;, &#39;英语&#39;, &#39;数学&#39;])\n\ndef total_score(df1):\n    df1[&#39;total_score&#39;] = df1[&#39;语文&#39;] + df1[&#39;数学&#39;] + df1[&#39;英语&#39;]\n    return df1\n\ndf1 = df1.drop_duplicates()\ndf1[&#39;数学&#39;].fillna(df1[&#39;数学&#39;].mean(), inplace = True)\ndf1 = df1.apply(total_score, axis = 1)\ndf1.rename(columns={&#39;total_score&#39;: &#39;总和&#39;}, inplace=True)\nprint(df1)","like_count":0,"discussions":[{"author":{"id":1306094,"avatar":"https://static001.geekbang.org/account/avatar/00/13/ed/ee/c4779b67.jpg","nickname":"cy","note":"","ucode":"50D653399A31F6","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":455904,"discussion_content":"Good Job","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1577606877,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":123844,"user_name":"Geek_661f9f","can_delete":false,"product_type":"c1","uid":1606166,"ip_address":"","ucode":"4F803965D2B080","user_header":"http://thirdwx.qlogo.cn/mmopen/vi_32/dicYnIuz436fF0rvdd5fHCj2GM1NTtuasz4kibdg7AVnWpsGL57icflFeQBXdyXSpBpeNaSN3FxGZmHFJc0iaq1nPw/132","comment_is_top":false,"comment_ctime":1565770198,"is_pvip":false,"replies":[{"id":63522,"content":"Good Job，完成就是胜利","user_name":"作者回复","user_name_real":"cy","uid":1306094,"ctime":1577516615,"ip_address":"","comment_id":123844,"utype":1}],"discussion_count":1,"race_medal":0,"score":7,"product_id":100021701,"comment_content":"第一次试着挣扎地写完整，折腾了好久\n# ！&#47;usr&#47;bin&#47;env python\n# -*- coding:utf-8 -*-\nimport pandas as pd\nimport numpy as np\ndata = {&#39;语文&#39;:[66,95,95,90,80,80],&#39;英语&#39;:[65,85,92,88,90,90],\n        &#39;数学&#39;:[None,98,96,77,90,90],&#39;tatal&#39;:[None,None,None,None,None,None]}\ndf1= pd.DataFrame(data,index=[&#39;张飞&#39;,&#39;关羽&#39;,&#39;赵云&#39;,&#39;黄忠&#39;,&#39;典韦&#39;,&#39;典韦&#39;],\n                  columns=[&#39;语文&#39;,&#39;英语&#39;,&#39;数学&#39;,&#39;total&#39;])\n\n#print(df1)\n\n#去重复行\ndf1 = df1.drop_duplicates()\nprint(df1)\n&#39;&#39;&#39;\n#查空值\ndf1= df1.isnull()\nprint(df1)\ndf1= df1.isnull().any()\nprint(df1)\n&#39;&#39;&#39;\n#用数学平均值补充张飞的数学成绩\ndf1[&#39;数学&#39;].fillna(df1[&#39;数学&#39;].mean(),inplace=True)\n#计算总成绩并进行排名\ndf1[&#39;total&#39;]=sorted(df1.sum(axis=1))\n\nprint(df1)","like_count":0,"discussions":[{"author":{"id":1306094,"avatar":"https://static001.geekbang.org/account/avatar/00/13/ed/ee/c4779b67.jpg","nickname":"cy","note":"","ucode":"50D653399A31F6","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":462840,"discussion_content":"Good Job，完成就是胜利","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1577516615,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":119273,"user_name":"张怡铭","can_delete":false,"product_type":"c1","uid":1617440,"ip_address":"","ucode":"3D4025CFF787D3","user_header":"https://static001.geekbang.org/account/avatar/00/18/ae/20/e92a1d97.jpg","comment_is_top":false,"comment_ctime":1564548774,"is_pvip":false,"replies":[{"id":63603,"content":"Good Job 多谢分享","user_name":"作者回复","user_name_real":"cy","uid":1306094,"ctime":1577520705,"ip_address":"","comment_id":119273,"utype":1}],"discussion_count":1,"race_medal":0,"score":7,"product_id":100021701,"comment_content":"#!&#47;usr&#47;bin&#47;env python3\n# -*- coding: utf-8 -*-\n\nimport pandas as pd\nfrom pandas import  Series, DataFrame\n# x1 = Series([1,2,3,4])\n# x2 = Series(data = [1,2,3,4], index=[&#39;a&#39;, &#39;b&#39;, &#39;c&#39;, &#39;d&#39;])\n# print(x1)\n# print(x2)\n#\n# # 字典\n# d = {&#39;a&#39;:1, &#39;b&#39;:2, &#39;c&#39;:3, &#39;d&#39;:4}\n# x3 = Series(d)\n# print(x3)\n#\n# # DataFrame 数据库表\n#\n# data = {&#39;chinese&#39;:[66, 95, 93, 90, 80],\n#         &#39;english&#39;:[65,85, 92, 88, 90],\n#         &#39;math&#39;:[30, 98, 96, 77, 90]}\n#\n# df1 = DataFrame(data)\n# df2 = DataFrame(data, index=[&#39;zhangfei&#39;, &#39;nanyi&#39;, &#39;zym&#39;, &#39;mengyi&#39;, &#39;lwei&#39;], columns=[&#39;chinese&#39;, &#39;english&#39;, &#39;math&#39;])\n# print(df1)\n# print(df2)\n# print(df2.describe())\n#\nscore = DataFrame(pd.read_excel(&#39;data09.xlsx&#39;))\n# print(score)\nscore = score.drop_duplicates()\n# print(score)\n# print(score.isnull())\n# print(score.describe())\n\n#二、指定inplace参数 填充 NaN 值\n\nscore[&#39;数学&#39;].fillna(score[&#39;数学&#39;].mean(), inplace = True)\nprint(score)\ndef plus(df):\n    df[&#39;总分&#39;] = df[&#39;语文&#39;] + df[&#39;英语&#39;] + df[&#39;数学&#39;]\n    return df\nscore = score.apply(plus, axis = 1)\nprint(score)\n\n&#39;&#39;&#39;\n## 参数    \nDataFrame.sort_values(by, axis=0, ascending=True, inplace=False, kind=&#39;quicksort&#39;, na_position=&#39;last&#39;)  \n#### 参数说明    \naxis:{0 or ‘index’, 1 or ‘columns’}, default 0，默认按照索引排序，即纵向排序，如果为1，则是横向排序    \nby:str or list of str；如果axis=0，那么by=&quot;列名&quot;；如果axis=1，那么by=&quot;行名&quot;；  \nascending:布尔型，True则升序，可以是[True,False]，即第一字段升序，第二个降序  \ninplace:布尔型，是否用排序后的数据框替换现有的数据框  \nkind:排序方法，{‘quicksort’, ‘mergesort’, ‘heapsort’}, default ‘quicksort’。似乎不用太关心  \nna_position : {‘first’, ‘last’}, default ‘last’，默认缺失值排在最后面 \n&#39;&#39;&#39;\nprint(score.sort_values(by = &#39;总分&#39;, axis = 0, ascending= False, inplace= False))","like_count":0,"discussions":[{"author":{"id":1306094,"avatar":"https://static001.geekbang.org/account/avatar/00/13/ed/ee/c4779b67.jpg","nickname":"cy","note":"","ucode":"50D653399A31F6","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":462840,"discussion_content":"Good Job，完成就是胜利","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1577516615,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":118545,"user_name":"六天六夜六斤作业","can_delete":false,"product_type":"c1","uid":1292302,"ip_address":"","ucode":"5A5DE3BD2732DC","user_header":"https://static001.geekbang.org/account/avatar/00/13/b8/0e/795c1d59.jpg","comment_is_top":false,"comment_ctime":1564384897,"is_pvip":false,"replies":[{"id":47094,"content":"感谢支持，加油！","user_name":"作者回复","user_name_real":"cy","uid":1306094,"ctime":1566630404,"ip_address":"","comment_id":118545,"utype":1}],"discussion_count":1,"race_medal":0,"score":7,"product_id":100021701,"comment_content":"赞！非常好，非常精炼！！！继续学习下去","like_count":0,"discussions":[{"author":{"id":1306094,"avatar":"https://static001.geekbang.org/account/avatar/00/13/ed/ee/c4779b67.jpg","nickname":"cy","note":"","ucode":"50D653399A31F6","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":460818,"discussion_content":"Good Job 多谢分享","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1577520705,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":116540,"user_name":"Geek_ray","can_delete":false,"product_type":"c1","uid":1514914,"ip_address":"","ucode":"957D73A3E4AAA4","user_header":"https://static001.geekbang.org/account/avatar/00/17/1d/a2/36a558e8.jpg","comment_is_top":false,"comment_ctime":1563866504,"is_pvip":false,"replies":[{"id":63646,"content":"需要check下环境","user_name":"作者回复","user_name_real":"cy","uid":1306094,"ctime":1577526377,"ip_address":"","comment_id":116540,"utype":1}],"discussion_count":1,"race_medal":0,"score":7,"product_id":100021701,"comment_content":"为何我更改数据类型不报错，但不成功？拿老师的代码尝试，也是如此，求助","like_count":0,"discussions":[{"author":{"id":1306094,"avatar":"https://static001.geekbang.org/account/avatar/00/13/ed/ee/c4779b67.jpg","nickname":"cy","note":"","ucode":"50D653399A31F6","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":459583,"discussion_content":"需要check下环境","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1577526377,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":115645,"user_name":"刘宇滨","can_delete":false,"product_type":"c1","uid":1236593,"ip_address":"","ucode":"9A0E066DDAE2B9","user_header":"https://static001.geekbang.org/account/avatar/00/12/de/71/8b0f010e.jpg","comment_is_top":false,"comment_ctime":1563681129,"is_pvip":false,"replies":[{"id":63674,"content":"Good Job","user_name":"作者回复","user_name_real":"cy","uid":1306094,"ctime":1577527907,"ip_address":"","comment_id":115645,"utype":1}],"discussion_count":1,"race_medal":0,"score":7,"product_id":100021701,"comment_content":"练习题：\nimport pandas as pd\n\ndata = {&quot;name&quot;: [&quot;张飞&quot;, &quot;关羽&quot;, &quot;赵云&quot;, &quot;黄忠&quot;, &quot;典韦&quot;, &quot;典韦&quot;],\n        &quot;chinese&quot;: [66, 95, 95, 90, 80, 80],\n        &quot;english&quot;: [65, 85, 92, 88, 90, 90],\n        &quot;math&quot;: [None, 98, 96, 77, 90, 90]}\n\ngrade_df = pd.DataFrame(data, columns=[&quot;name&quot;, &quot;chinese&quot;, &quot;english&quot;, &quot;math&quot;])\n\n# 去除重复行\ngrade_df = grade_df.drop_duplicates()\n\n# 重命列名\ngrade_df.rename(columns={&quot;name&quot;:&quot;姓名&quot;, &quot;chinese&quot;:&quot;语文&quot;, &quot;english&quot;:&quot;英语&quot;, &quot;math&quot;:&quot;数学&quot;}, inplace=True)\n\n# 用数学成绩平均值填充张飞数学成绩缺失值\nmath_mean = grade_df[&quot;数学&quot;].mean()\ngrade_df = grade_df.fillna(math_mean)\n\ngrade_df[&quot;总成绩&quot;] = grade_df.sum(axis=1)","like_count":0,"discussions":[{"author":{"id":1306094,"avatar":"https://static001.geekbang.org/account/avatar/00/13/ed/ee/c4779b67.jpg","nickname":"cy","note":"","ucode":"50D653399A31F6","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":459583,"discussion_content":"需要check下环境","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1577526377,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":114669,"user_name":"Geek_shirley","can_delete":false,"product_type":"c1","uid":1599050,"ip_address":"","ucode":"A1D6BBF37B8337","user_header":"http://thirdwx.qlogo.cn/mmopen/vi_32/oQZ3rnHKdFrWgJDwABx9AUsf6fBibHLAsruGRsmD43lA6Zy1zicKfJsSNLOE2ZRsd8oIpPSznJLDFuUfIK8tUung/132","comment_is_top":false,"comment_ctime":1563359820,"is_pvip":false,"replies":[{"id":63809,"content":"python本身可以做一些BI的工作，当然也可以使用第三方的BI工具\n如果是打比赛的话，比如kaggle，一般还是自己写的多，因为需要做一些特征工程，然后再调用各种算法模型","user_name":"作者回复","user_name_real":"cy","uid":1306094,"ctime":1577542399,"ip_address":"","comment_id":114669,"utype":1}],"discussion_count":1,"race_medal":0,"score":7,"product_id":100021701,"comment_content":"这些函数库很多bi工具都支持，而且bi工具用起来更容易上手，并自动data visualization。老师如何看待python和bi工具的差别？","like_count":0,"discussions":[{"author":{"id":1306094,"avatar":"https://static001.geekbang.org/account/avatar/00/13/ed/ee/c4779b67.jpg","nickname":"cy","note":"","ucode":"50D653399A31F6","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":459206,"discussion_content":"Good Job","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1577527907,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":114210,"user_name":"Untitled","can_delete":false,"product_type":"c1","uid":1039464,"ip_address":"","ucode":"8DD6ABA3E81A2E","user_header":"https://static001.geekbang.org/account/avatar/00/0f/dc/68/006ba72c.jpg","comment_is_top":false,"comment_ctime":1563252125,"is_pvip":false,"replies":[{"id":63695,"content":"Good Job","user_name":"作者回复","user_name_real":"cy","uid":1306094,"ctime":1577528457,"ip_address":"","comment_id":114210,"utype":1}],"discussion_count":1,"race_medal":0,"score":7,"product_id":100021701,"comment_content":"import pandas as pd\ndf1 = pd.read_excel(&#39;shizan-5.xlsx&#39;,index_col=0)\n#数据清洗\ndf1 = df1.drop_duplicates()#去重\ndf1 = df1.drop(index=df1[df1.isnull().any(axis=1) == True].index)#删除有空值的行\n#数据统计\ndef sum_of_all(df):\n    df[u&#39;总分&#39;] = df[u&#39;语文&#39;] + df[u&#39;英语&#39;] + df[u&#39;数学&#39;]\n    return df\ndf1 = df1.apply(sum_of_all,axis=1)\nprint(df1.sort_values(by=u&#39;总分&#39;))","like_count":0,"discussions":[{"author":{"id":1306094,"avatar":"https://static001.geekbang.org/account/avatar/00/13/ed/ee/c4779b67.jpg","nickname":"cy","note":"","ucode":"50D653399A31F6","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":458767,"discussion_content":"python本身可以做一些BI的工作，当然也可以使用第三方的BI工具\n如果是打比赛的话，比如kaggle，一般还是自己写的多，因为需要做一些特征工程，然后再调用各种算法模型","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1577542399,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":109615,"user_name":"内存爆了","can_delete":false,"product_type":"c1","uid":1590007,"ip_address":"","ucode":"A0825B772CC3DF","user_header":"https://static001.geekbang.org/account/avatar/00/18/42/f7/67a2e6ee.jpg","comment_is_top":false,"comment_ctime":1562066621,"is_pvip":false,"replies":[{"id":63926,"content":"加油","user_name":"作者回复","user_name_real":"cy","uid":1306094,"ctime":1577605129,"ip_address":"","comment_id":109615,"utype":1}],"discussion_count":1,"race_medal":0,"score":7,"product_id":100021701,"comment_content":"## 课后习题：\n- 我的答案：感觉知识没有全用上，数学成绩NaN没解决\n```python\nimport pandas as pd\nfrom pandas import Series, DataFrame\ndata = DataFrame(pd.read_excel(&#39;data1.xlsx&#39;))\ndf = DataFrame(data)\ndf = df.drop_duplicates()\ndef sum(df):\n    df[&#39;zcj&#39;] = (df[u&#39;语文&#39;]+df[u&#39;英语&#39;]+df[u&#39;数学&#39;])\n    return df\ndf = df.apply(sum, axis=1)\nprint(df)\n```\n看到评论才知道别人多么优秀啊，加油！","like_count":0,"discussions":[{"author":{"id":1306094,"avatar":"https://static001.geekbang.org/account/avatar/00/13/ed/ee/c4779b67.jpg","nickname":"cy","note":"","ucode":"50D653399A31F6","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":458556,"discussion_content":"Good Job","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1577528457,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":109155,"user_name":"2525","can_delete":false,"product_type":"c1","uid":1180247,"ip_address":"","ucode":"2426488C258203","user_header":"https://static001.geekbang.org/account/avatar/00/12/02/57/9b235866.jpg","comment_is_top":false,"comment_ctime":1561972119,"is_pvip":false,"replies":[{"id":63931,"content":"Good Job","user_name":"作者回复","user_name_real":"cy","uid":1306094,"ctime":1577605421,"ip_address":"","comment_id":109155,"utype":1}],"discussion_count":1,"race_medal":0,"score":7,"product_id":100021701,"comment_content":"python 3.0习题代码:\n\nimport pandas as pd\npd.set_option(&#39;display.unicode.ambiguous_as_wide&#39;, True)\npd.set_option(&#39;display.unicode.east_asian_width&#39;, True)\ndf1=pd.DataFrame(data={&quot;语文&quot;:[66,95,95,90,80,80],&quot;英语&quot;:[65,85,92,88,90,90],&quot;数学&quot;:[None,98,96,77,90,90]},\n                 index=(&quot;张飞&quot;,&quot;关羽&quot;,&quot;赵云&quot;,&quot;黄忠&quot;,&quot;典韦&quot;,&quot;典韦&quot;))\nprint(df1,end=&quot;\\n_______________________\\n&quot;)\ndf1.drop_duplicates(subset=[&quot;语文&quot;,&quot;英语&quot;,&quot;数学&quot;],keep=&quot;last&quot;,inplace=True)\ndf1.dropna(inplace=True)\nprint(df1,end=&quot;\\n_______________________\\n&quot;)\ndef sum(serie_item):\n    serie_item[&quot;总和&quot;]=serie_item.values.sum()\n    return serie_item\ndf1=df1.apply(sum,axis=1)\nprint(df1)","like_count":0,"discussions":[{"author":{"id":1306094,"avatar":"https://static001.geekbang.org/account/avatar/00/13/ed/ee/c4779b67.jpg","nickname":"cy","note":"","ucode":"50D653399A31F6","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":456487,"discussion_content":"加油","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1577605129,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":108287,"user_name":"华夏","can_delete":false,"product_type":"c1","uid":1449474,"ip_address":"","ucode":"4D627CFA5A4B82","user_header":"https://static001.geekbang.org/account/avatar/00/16/1e/02/2864e0f2.jpg","comment_is_top":false,"comment_ctime":1561712767,"is_pvip":false,"replies":[{"id":63987,"content":"Good Job","user_name":"作者回复","user_name_real":"cy","uid":1306094,"ctime":1577606877,"ip_address":"","comment_id":108287,"utype":1}],"discussion_count":1,"race_medal":0,"score":7,"product_id":100021701,"comment_content":"import pandas as pd\nfrom pandas import Series, DataFrame\n\n\ndata = {&#39;语文&#39;: [66, 95, 93, 90, 80, 80],&#39;英语&#39;: [65, 85, 92, 88, 90, 90],&#39;数学&#39;: [ None, 98, 96, 77, 90, 90]}\ndf1 = DataFrame(data, index=[&#39;张飞&#39;, &#39;关羽&#39;, &#39;赵云&#39;, &#39;黄忠&#39;, &#39;典韦&#39;, &#39;典韦&#39;], \n                columns=[&#39;语文&#39;, &#39;英语&#39;, &#39;数学&#39;])\n\ndef total_score(df1):\n    df1[&#39;total_score&#39;] = df1[&#39;语文&#39;] + df1[&#39;数学&#39;] + df1[&#39;英语&#39;]\n    return df1\n\ndf1 = df1.drop_duplicates()\ndf1[&#39;数学&#39;].fillna(df1[&#39;数学&#39;].mean(), inplace = True)\ndf1 = df1.apply(total_score, axis = 1)\ndf1.rename(columns={&#39;total_score&#39;: &#39;总和&#39;}, inplace=True)\nprint(df1)","like_count":0,"discussions":[{"author":{"id":1306094,"avatar":"https://static001.geekbang.org/account/avatar/00/13/ed/ee/c4779b67.jpg","nickname":"cy","note":"","ucode":"50D653399A31F6","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":456271,"discussion_content":"Good Job","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1577605421,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":106296,"user_name":"建强","can_delete":false,"product_type":"c1","uid":1397126,"ip_address":"","ucode":"62B03D0E0C64EC","user_header":"https://static001.geekbang.org/account/avatar/00/15/51/86/b5fd8dd8.jpg","comment_is_top":false,"comment_ctime":1561257582,"is_pvip":false,"replies":[{"id":64036,"content":"Good Job","user_name":"作者回复","user_name_real":"cy","uid":1306094,"ctime":1577607917,"ip_address":"","comment_id":106296,"utype":1}],"discussion_count":1,"race_medal":0,"score":8,"product_id":100021701,"comment_content":"思考题的程序代码如下，思考题要求增加一列总和我用到了数据合并，做了很多尝试，得出结论是：和数据库的SQL语句中的inner join不同，inner join是按关联条件进行数据关联，而Pandas在做数据合并时必须要基于相同的列，无法用关联条件，没有相同的列无法进行合并：\nimport pandas as pd\nfrom pandas import Series, DataFrame\n#创建学生成绩单\nMark = { &#39;语文&#39;: [66, 95, 95, 90,80,80]\n        ,&#39;英语&#39;: [65, 85, 92, 88, 90, 90]\n        ,&#39;数学&#39;: [None, 98, 96, 77, 90, 90]\n        ,&#39;姓名&#39;: [&#39;张飞&#39;, &#39;关羽&#39;, &#39;赵云&#39;, &#39;黄忠&#39;, &#39;典韦&#39;, &#39;典韦&#39;]\n        }\nStudentMark = DataFrame(Mark,columns=[&#39;姓名&#39;,&#39;语文&#39;, &#39;英语&#39;, &#39;数学&#39;])\n\n#去除重复行\nStudentMark = StudentMark.drop_duplicates()\nprint(&#39;----去除重复行结果-------&#39;)\nprint(StudentMark)\n  \n#增加一列总成绩\nt = {&#39;姓名&#39;:list(StudentMark[&#39;姓名&#39;]),&#39;总和&#39;:list(StudentMark.sum(axis=1))}\nt = DataFrame(t,columns=[&#39;姓名&#39;,&#39;总和&#39;])\nStudentMark = pd.merge(StudentMark,t,how=&#39;inner&#39;)\nprint(&#39;----增加总和结果-------&#39;)\nprint(StudentMark)\n","like_count":0},{"had_liked":false,"id":95974,"user_name":"大斌","can_delete":false,"product_type":"c1","uid":1002183,"ip_address":"","ucode":"1434C2B0A29135","user_header":"https://static001.geekbang.org/account/avatar/00/0f/4a/c7/ec18673b.jpg","comment_is_top":false,"comment_ctime":1558281367,"is_pvip":false,"replies":[{"id":64166,"content":"Good Job","user_name":"作者回复","user_name_real":"cy","uid":1306094,"ctime":1577610871,"ip_address":"","comment_id":95974,"utype":1}],"discussion_count":1,"race_medal":0,"score":8,"product_id":100021701,"comment_content":"import pandas as pd\nfrom pandas import DataFrame\n\n\ndata = {&#39;Chinese&#39;:[66,95,95,90,80,80],&#39;English&#39;:[65,85,92,88,90,90],&#39;Math&#39;:[0,98,96,77,90,90]}\n\ndf = DataFrame(data,index=[&#39;zhangfei&#39;,&#39;guanyu&#39;,&#39;zhaoyun&#39;,&#39;huangzhong&#39;,&#39;dianwei&#39;,&#39;dianwei&#39;])\n\n#去除重复的值\ndf = df.drop_duplicates()\n\n#新增一列综合计算每个人三科成绩之和\n\ndf[&#39;总和&#39;]=df.apply(lambda x:x.sum(),axis=1)\nprint(df)","like_count":0,"discussions":[{"author":{"id":1306094,"avatar":"https://static001.geekbang.org/account/avatar/00/13/ed/ee/c4779b67.jpg","nickname":"cy","note":"","ucode":"50D653399A31F6","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":455037,"discussion_content":"Good Job","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1577607917,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":82365,"user_name":"_xiongyi","can_delete":false,"product_type":"c1","uid":1482099,"ip_address":"","ucode":"F5038A1CC63DC2","user_header":"","comment_is_top":false,"comment_ctime":1554194066,"is_pvip":false,"replies":[{"id":64315,"content":"Good Job","user_name":"作者回复","user_name_real":"cy","uid":1306094,"ctime":1577616670,"ip_address":"","comment_id":82365,"utype":1}],"discussion_count":1,"race_medal":0,"score":8,"product_id":100021701,"comment_content":"import pandas as pd\nfrom pandas import Series, DataFrame\ndf1 = DataFrame({&#39;name&#39;:[&#39;ZhangFei&#39;,&#39;GuanYu&#39;,&#39;a&#39;,&#39;b&#39;,&#39;c&#39;],&#39;data1&#39;:range(5)})\ndf2 = DataFrame({&#39;name&#39;:[&#39;ZhangFei&#39;,&#39;GuanYu&#39;,&#39;A&#39;,&#39;B&#39;,&#39;C&#39;],&#39;data2&#39;:range(5)})\ndf3 = pd.merge(df1,df2,how=&#39;outer&#39;)\nprint(df3)\n\nimport pandas as pd\nfrom pandas import Series, DataFrame\ndata = {&#39;Chinese&#39;:[66,95,95,90,80,80],&#39;English&#39;:[65,85,92,88,90,90],&#39;Math&#39;:[None,98,96,77,90,90]}\ndf1 = DataFrame(data,index=[&#39;ZhangFei&#39;, &#39;GuanYu&#39;, &#39;ZhaoYun&#39;, &#39;HuangZhong&#39;, &#39;DianWei&#39;,&#39;DianWei&#39;],\n                columns=[&#39;Chinese&#39;,&#39;English&#39;,&#39;Math&#39;])\ndf1 = df1.drop_duplicates()\ndef plus(df):\n    df[&#39;总分&#39;]=(df[u&#39;Chinese&#39;]+df[u&#39;English&#39;]+df[u&#39;Math&#39;])\n    return df\ndf1 = df1.apply(plus,axis=1)\nprint(df1)","like_count":0,"discussions":[{"author":{"id":1306094,"avatar":"https://static001.geekbang.org/account/avatar/00/13/ed/ee/c4779b67.jpg","nickname":"cy","note":"","ucode":"50D653399A31F6","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":450664,"discussion_content":"Good Job","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1577610871,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":77723,"user_name":"『G YaQi』","can_delete":false,"product_type":"c1","uid":1461694,"ip_address":"","ucode":"D378F0C8D0EFD0","user_header":"https://static001.geekbang.org/account/avatar/00/16/4d/be/c04c9eac.jpg","comment_is_top":false,"comment_ctime":1552986791,"is_pvip":false,"replies":[{"id":64399,"content":"Good Job","user_name":"作者回复","user_name_real":"cy","uid":1306094,"ctime":1577618343,"ip_address":"","comment_id":77723,"utype":1}],"discussion_count":1,"race_medal":0,"score":8,"product_id":100021701,"comment_content":"import pandas as pd\nfrom pandas import Series, DataFrame\n\ndata = [[66, 65],\n        [95, 85, 98],\n        [95, 92, 96],\n        [90, 88, 77],\n        [80, 90, 90],\n        [80, 90, 90]]\nnames = [&#39;张飞&#39;,&#39;关羽&#39;,&#39;赵云&#39;,&#39;黄忠&#39;,&#39;典韦&#39;,&#39;典韦&#39;]\nclasses = [&#39;语文&#39;,&#39;英语&#39;,&#39;数学&#39;]\ndf = DataFrame(data=data,index=names,columns=classes)\ndf.dropna(inplace=True)\ndf.drop_duplicates(inplace=True)\ndf[&#39;总分&#39;] = df.语文 + df.英语 + df.数学\nprint(df)","like_count":0,"discussions":[{"author":{"id":1306094,"avatar":"https://static001.geekbang.org/account/avatar/00/13/ed/ee/c4779b67.jpg","nickname":"cy","note":"","ucode":"50D653399A31F6","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":445566,"discussion_content":"Good Job","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1577616670,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":77188,"user_name":"Geek_ce3c1f","can_delete":false,"product_type":"c1","uid":1452721,"ip_address":"","ucode":"31A9F00D01FE2D","user_header":"http://thirdwx.qlogo.cn/mmopen/vi_32/DYAIOgq83eqmqDPzn9q0YM0CgSicVD215GibbOpyC52vJ5LUbDicwoI7n3biapWls4qd7ENwH4tJyJibgGcyrM5kCzQ/132","comment_is_top":false,"comment_ctime":1552879811,"is_pvip":false,"replies":[{"id":64409,"content":"Good Job","user_name":"作者回复","user_name_real":"cy","uid":1306094,"ctime":1577618450,"ip_address":"","comment_id":77188,"utype":1}],"discussion_count":1,"race_medal":0,"score":8,"product_id":100021701,"comment_content":"import pandas as pd\n\n\n# 创建数据表\ndata = {&#39;Chinese&#39;: [66, 95, 95, 90, 80, 80],&#39;English&#39;: [65, 85, 92, 88, 90, 90],&#39;Math&#39;: [None, 98, 96, 77, 90, 90]}\ndf = pd.DataFrame(data, index=[&#39;ZhangFei&#39;, &#39;GuanYu&#39;,\n                                &#39;ZhaoYun&#39;, &#39;HuangZhong&#39;,\n                                &#39;DianWei&#39;,&#39;DianWei&#39;], columns=[&#39;Chinese&#39;,&#39;English&#39;,&#39;Math&#39;])\n# 去除重复行\ndf = df.drop_duplicates()\n\n# 将空值转换为0\n# df = df.fillna(0)\n# 将空值替换为均值\n# df = df.fillna(df.mean(axis=&#39;数学&#39;))\n\n\n# 重命名行列名\ndf.rename(index={&#39;ZhangFei&#39;:&#39;张飞&#39;, &#39;GuanYu&#39;:&#39;关羽&#39;, &#39;ZhaoYun&#39;:&#39;赵云&#39;, &#39;HuangZhong&#39;:&#39;黄忠&#39;, &#39;DianWei&#39;:&#39;典韦&#39;},\n          columns={&#39;Chinese&#39;:&#39;语文&#39;,&#39;English&#39;:&#39;英语&#39;,&#39;Math&#39;:&#39;数学&#39;},inplace=True)\n\n# 将空值替换为均值\ndf = df.fillna(df[&#39;数学&#39;].mean())\n\n# 创建新列并且计算每个人的三科成绩总和\ndf[&#39;总成绩&#39;] = df[&#39;语文&#39;] + df[&#39;英语&#39;] + df[&#39;数学&#39;]\n\nprint(df)\nprint(df.describe())\n","like_count":0,"discussions":[{"author":{"id":1306094,"avatar":"https://static001.geekbang.org/account/avatar/00/13/ed/ee/c4779b67.jpg","nickname":"cy","note":"","ucode":"50D653399A31F6","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":443824,"discussion_content":"Good Job","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1577618343,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":76568,"user_name":"Reinhardt Gao","can_delete":false,"product_type":"c1","uid":1436125,"ip_address":"","ucode":"E872470FFF9F4B","user_header":"https://static001.geekbang.org/account/avatar/00/15/e9/dd/7921208d.jpg","comment_is_top":false,"comment_ctime":1552633792,"is_pvip":false,"replies":[{"id":64419,"content":"Good Job","user_name":"作者回复","user_name_real":"cy","uid":1306094,"ctime":1577618921,"ip_address":"","comment_id":76568,"utype":1}],"discussion_count":1,"race_medal":0,"score":8,"product_id":100021701,"comment_content":"环境Python3.7 Anaconda\n注释段落尝试用sql去修改空值但是编译的时候报错说找不到表。但是同一个位置写select * from spreadsheet就没有问题。老师可否帮忙看一下？\n其他编译均通过\n\nfrom pandas import DataFrame\nfrom pandasql import sqldf\n\n# Create table\n\nscore = {&#39;Name&#39;:[&#39;Zhang Fei&#39;, &#39;Guan Yu&#39;, &#39;Zhao Yun&#39;, &#39;Huang Zhong&#39;, &#39;Dian Wei&#39;, &#39;Dian Wei&#39;],&#39;Chinese&#39;: [66, 95, 95, 90, 80, 80], &#39;English&#39;: [65, 85, 92, 88, 90, 90], &#39;Mathematics&#39;: [None, 98, 96, 77, 90, 90]}\nspreadsheet = DataFrame(score)\nprint(spreadsheet)\n\n# Data Preparation\n\nspreadsheet.drop_duplicates()\nprint(spreadsheet.isnull())\nspreadsheet.fillna(spreadsheet[&#39;Mathematics&#39;].mean(),inplace=True)\nprint(spreadsheet.isnull())\n\n\n&#39;&#39;&#39;\nHas problem with this code. WHen executing this part, interpreter throws out exception \nas &quot;sqlite3.OperationalError: no such table: spreadsheet&quot;. \nBut if we run &quot;Select * from spreadsheet&quot; here, no exception throw out.\npysql = lambda sql: sqldf(sql, globals())\nsql1 = &quot;update spreadsheet &quot; \\            \n       &quot;set Mathematics = 0 &quot; \\\n       &quot;where Name = &#39;Zhang Fei&#39;&quot;\nprint(pysql(sql1))\n&#39;&#39;&#39;\n# Add new column\n\nspreadsheet[&#39;Total&#39;] = spreadsheet[u&#39;Chinese&#39;] + spreadsheet[u&#39;English&#39;] + spreadsheet[u&#39;Mathematics&#39;]\nprint(spreadsheet)\n","like_count":0,"discussions":[{"author":{"id":1306094,"avatar":"https://static001.geekbang.org/account/avatar/00/13/ed/ee/c4779b67.jpg","nickname":"cy","note":"","ucode":"50D653399A31F6","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":443626,"discussion_content":"Good Job","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1577618450,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":72371,"user_name":"均","can_delete":false,"product_type":"c1","uid":1177456,"ip_address":"","ucode":"9BABCE1419817B","user_header":"https://static001.geekbang.org/account/avatar/00/11/f7/70/6be5dd41.jpg","comment_is_top":false,"comment_ctime":1551600444,"is_pvip":false,"replies":[{"id":64473,"content":"Good Job","user_name":"作者回复","user_name_real":"cy","uid":1306094,"ctime":1577619770,"ip_address":"","comment_id":72371,"utype":1}],"discussion_count":1,"race_medal":0,"score":8,"product_id":100021701,"comment_content":"\nimport pandas as pd\nfrom pandas import Series,DataFrame\n\n\ndef total_score(df):\n    df[&#39;总分&#39;]=(df[u&#39;语文&#39;]+df[u&#39;英语&#39;]+df[u&#39;数学&#39;])\n    return df\n\ndef main():\n    data={&#39;姓名&#39;:[&#39;张飞&#39;,&#39;关羽&#39;,&#39;赵云&#39;,&#39;黄忠&#39;,&#39;典韦&#39;,&#39;典韦&#39;],&#39;语文&#39;:[66,95,95,90,80,80],&#39;英语&#39;:[65,85,92,88,90,90],&#39;数学&#39;:[0,98,96,77,90,90]}\n    df1=DataFrame(data)\n    df1=df1.drop_duplicates()\n    df1=df1.apply(total_score,axis=1)\n    print(df1)","like_count":0,"discussions":[{"author":{"id":1306094,"avatar":"https://static001.geekbang.org/account/avatar/00/13/ed/ee/c4779b67.jpg","nickname":"cy","note":"","ucode":"50D653399A31F6","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":443358,"discussion_content":"Good Job","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1577618921,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":68648,"user_name":"Mikey","can_delete":false,"product_type":"c1","uid":1188191,"ip_address":"","ucode":"3EC73395031E88","user_header":"https://static001.geekbang.org/account/avatar/00/12/21/5f/9e1300d3.jpg","comment_is_top":false,"comment_ctime":1550566662,"is_pvip":false,"replies":[{"id":64529,"content":"Good Job","user_name":"作者回复","user_name_real":"cy","uid":1306094,"ctime":1577621323,"ip_address":"","comment_id":68648,"utype":1}],"discussion_count":1,"race_medal":0,"score":8,"product_id":100021701,"comment_content":"import pandas as pd\n\ndata = {&#39;Chinese&#39;:[66,95,95,90,80,80],\n        &#39;English&#39;:[65,85,92,88,90,90],\n        &#39;Math&#39;:[None,98,96,77,90,90]}\n\ndf = pd.DataFrame(data, index=[&#39;张飞&#39;, &#39;关羽&#39;, &#39;赵云&#39;, &#39;黄忠&#39;, &#39;典韦&#39;, &#39;典韦&#39;],columns=[&#39;English&#39;,&#39;Chinese&#39;,&#39;Math&#39;])\n\n# 数据清洗\n# 1.去除重复行\ndf = df.drop_duplicates()\n# 求和\ndf[&#39;total&#39;] = df[&#39;Chinese&#39;] + df[&#39;English&#39;] + df[&#39;Math&#39;]\n# 2.排序\ncols = [&#39;Chinese&#39;, &#39;English&#39;, &#39;Math&#39;]\ndf = df.filter(cols, axis=1)\n# 3.改成中文列名\ndf.rename(columns={&#39;Chinese&#39;:&#39;语文&#39;,&#39;English&#39;:&#39;英语&#39;,&#39;Math&#39;:&#39;数学&#39;,&#39;total&#39;:&#39;总和&#39;}, inplace=True)\n# 4.填充缺失值 (使用平均值)\ndf[&#39;数学&#39;].fillna(df[&#39;数学&#39;].mean(), inplace=True)\nprint(df)","like_count":0,"discussions":[{"author":{"id":1306094,"avatar":"https://static001.geekbang.org/account/avatar/00/13/ed/ee/c4779b67.jpg","nickname":"cy","note":"","ucode":"50D653399A31F6","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":441561,"discussion_content":"Good Job","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1577619770,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":67655,"user_name":"草包雷","can_delete":false,"product_type":"c1","uid":1158255,"ip_address":"","ucode":"A6466D21248DF5","user_header":"http://thirdwx.qlogo.cn/mmopen/vi_32/PiajxSqBRaEL8c2Tu3bibiaKQmS1rc58icJOsDKpCtYzhvMMr3YAYTHiboxCAG0CroejUibP0ALOQbzMWz6eyz49Ltcg/132","comment_is_top":false,"comment_ctime":1550217640,"is_pvip":false,"replies":[{"id":64566,"content":"Good Job","user_name":"作者回复","user_name_real":"cy","uid":1306094,"ctime":1577621820,"ip_address":"","comment_id":67655,"utype":1}],"discussion_count":1,"race_medal":0,"score":8,"product_id":100021701,"comment_content":"import pandas as pd\nfrom pandas import DataFrame\ndata = {&#39;语文&#39;: [66,95,95,90,80,80],&#39;英语&#39;: [65,85,92,88,90,90],&#39;数学&#39;: [None,98,96,77,90,90]}\ndf = DataFrame(data, index=[&#39;张飞&#39;, &#39;关羽&#39;, &#39;赵云&#39;, &#39;黄忠&#39;, &#39;典韦&#39;,&#39;典韦&#39;], columns=[&#39;语文&#39;, &#39;英语&#39;, &#39;数学&#39;])\n\ndf = df.drop_duplicates()\ndf=df.fillna(0)\ndef addtotal(df):\n     df[&#39;总分&#39;] = df[&#39;语文&#39;] + df[&#39;英语&#39;] + df[&#39;数学&#39;]\n     return  df\ndf = df.apply(addtotal,axis=1)\n\nprint (df)\n\n\n      语文    英语    数学     总分\n张飞  66.0  65.0   0.0  131.0\n关羽  95.0  85.0  98.0  278.0\n赵云  95.0  92.0  96.0  283.0\n黄忠  90.0  88.0  77.0  255.0\n典韦  80.0  90.0  90.0  260.0","like_count":0,"discussions":[{"author":{"id":1306094,"avatar":"https://static001.geekbang.org/account/avatar/00/13/ed/ee/c4779b67.jpg","nickname":"cy","note":"","ucode":"50D653399A31F6","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":439776,"discussion_content":"Good Job","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1577621323,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":64843,"user_name":"Geek_hve78z","can_delete":false,"product_type":"c1","uid":1015045,"ip_address":"","ucode":"386803B8FC2DD5","user_header":"https://static001.geekbang.org/account/avatar/00/0f/7d/05/4bad0c7c.jpg","comment_is_top":false,"comment_ctime":1548923012,"is_pvip":false,"replies":[{"id":64620,"content":"Good Job","user_name":"作者回复","user_name_real":"cy","uid":1306094,"ctime":1577622531,"ip_address":"","comment_id":64843,"utype":1}],"discussion_count":1,"race_medal":0,"score":8,"product_id":100021701,"comment_content":"1、在pandas中，最主要的数据结构是Series和DataFrame\nSeries: 是个定长的字典序列。俩个基本属性：index和values\nDataFrame：类似于数据库表，包括行索引和列索引。\n2、对于DataFrame数据清洗的函数\n1）删除不必要的列或行：drop（）\ndf=df.drop(columns=[&#39;Math&#39;]\ndf=df.drop(index=[&#39;ZhangFei&#39;]\n2）重命名列名columns：rename\nrename(columns=new_names, inplace=True)\n3）去重复的行 dtop_duplicates()\n4）格式问题\n4.1 更改数据格式 astype()\n4.2 删除数据间的空格 strip(), lstrip(), rstrip()\n4.3 大小写转换 upper(), lower(), title()\ndf.columns= df.columns.str.upper() ## 全部大写\n4.4 查找空值 df.isnull(), df.isnull().any()\n5）使用apply函数进行‘大写转换’、数值处理、新增列\n\n————————————————————\n代码呈现\n## 作业代码：对数据进行清洗，新增一列总和\nimport pandas as pd\nfrom pandas import DataFrame\n\ndata={&#39;语文&#39;:[66,95,95,90,80,80],&#39;英语&#39;:[65,85,92,88,90,90],&#39;数学&#39;:[None,98,96,77,90,90]}\ndf=DataFrame(data,index=[&#39;张飞&#39;,&#39;关羽&#39;,&#39;赵云&#39;,&#39;黄忠&#39;,&#39;典韦&#39;,&#39;典韦&#39;],columns=[&#39;语文&#39;,&#39;英语&#39;,&#39;数学&#39;])\n\n## 删除重复行\ndf=df.drop_duplicates()\n\n## 查找缺失值缺失值\nprint(df.isnull())\n\n## 利用平均值补充‘张飞’的缺失值\ndf[&#39;数学&#39;].fillna(df[&#39;数学&#39;].mean(),inplace=True)\n\n## 新增一列‘总分’\ndf[&#39;总分&#39;]=df[&#39;语文&#39;]+df[&#39;英语&#39;]+df[&#39;数学&#39;]\n\n## 按照总分排序，从高到低，输出\ndf.sort_values([&#39;总分&#39;],ascending=False,inplace=True)\n\n\n## 输出最终结果\nprint(df)\nprint(df.describe())\n\n\n","like_count":0,"discussions":[{"author":{"id":1306094,"avatar":"https://static001.geekbang.org/account/avatar/00/13/ed/ee/c4779b67.jpg","nickname":"cy","note":"","ucode":"50D653399A31F6","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":439308,"discussion_content":"Good Job","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1577621820,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":106296,"user_name":"建强","can_delete":false,"product_type":"c1","uid":1397126,"ip_address":"","ucode":"62B03D0E0C64EC","user_header":"https://static001.geekbang.org/account/avatar/00/15/51/86/b5fd8dd8.jpg","comment_is_top":false,"comment_ctime":1561257582,"is_pvip":false,"replies":[{"id":64036,"content":"Good Job","user_name":"作者回复","user_name_real":"cy","uid":1306094,"ctime":1577607917,"ip_address":"","comment_id":106296,"utype":1}],"discussion_count":1,"race_medal":0,"score":8,"product_id":100021701,"comment_content":"思考题的程序代码如下，思考题要求增加一列总和我用到了数据合并，做了很多尝试，得出结论是：和数据库的SQL语句中的inner join不同，inner join是按关联条件进行数据关联，而Pandas在做数据合并时必须要基于相同的列，无法用关联条件，没有相同的列无法进行合并：\nimport pandas as pd\nfrom pandas import Series, DataFrame\n#创建学生成绩单\nMark = { &#39;语文&#39;: [66, 95, 95, 90,80,80]\n        ,&#39;英语&#39;: [65, 85, 92, 88, 90, 90]\n        ,&#39;数学&#39;: [None, 98, 96, 77, 90, 90]\n        ,&#39;姓名&#39;: [&#39;张飞&#39;, &#39;关羽&#39;, &#39;赵云&#39;, &#39;黄忠&#39;, &#39;典韦&#39;, &#39;典韦&#39;]\n        }\nStudentMark = DataFrame(Mark,columns=[&#39;姓名&#39;,&#39;语文&#39;, &#39;英语&#39;, &#39;数学&#39;])\n\n#去除重复行\nStudentMark = StudentMark.drop_duplicates()\nprint(&#39;----去除重复行结果-------&#39;)\nprint(StudentMark)\n  \n#增加一列总成绩\nt = {&#39;姓名&#39;:list(StudentMark[&#39;姓名&#39;]),&#39;总和&#39;:list(StudentMark.sum(axis=1))}\nt = DataFrame(t,columns=[&#39;姓名&#39;,&#39;总和&#39;])\nStudentMark = pd.merge(StudentMark,t,how=&#39;inner&#39;)\nprint(&#39;----增加总和结果-------&#39;)\nprint(StudentMark)\n","like_count":0,"discussions":[{"author":{"id":1306094,"avatar":"https://static001.geekbang.org/account/avatar/00/13/ed/ee/c4779b67.jpg","nickname":"cy","note":"","ucode":"50D653399A31F6","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":455037,"discussion_content":"Good Job","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1577607917,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":95974,"user_name":"大斌","can_delete":false,"product_type":"c1","uid":1002183,"ip_address":"","ucode":"1434C2B0A29135","user_header":"https://static001.geekbang.org/account/avatar/00/0f/4a/c7/ec18673b.jpg","comment_is_top":false,"comment_ctime":1558281367,"is_pvip":false,"replies":[{"id":64166,"content":"Good Job","user_name":"作者回复","user_name_real":"cy","uid":1306094,"ctime":1577610871,"ip_address":"","comment_id":95974,"utype":1}],"discussion_count":1,"race_medal":0,"score":8,"product_id":100021701,"comment_content":"import pandas as pd\nfrom pandas import DataFrame\n\n\ndata = {&#39;Chinese&#39;:[66,95,95,90,80,80],&#39;English&#39;:[65,85,92,88,90,90],&#39;Math&#39;:[0,98,96,77,90,90]}\n\ndf = DataFrame(data,index=[&#39;zhangfei&#39;,&#39;guanyu&#39;,&#39;zhaoyun&#39;,&#39;huangzhong&#39;,&#39;dianwei&#39;,&#39;dianwei&#39;])\n\n#去除重复的值\ndf = df.drop_duplicates()\n\n#新增一列综合计算每个人三科成绩之和\n\ndf[&#39;总和&#39;]=df.apply(lambda x:x.sum(),axis=1)\nprint(df)","like_count":0,"discussions":[{"author":{"id":1306094,"avatar":"https://static001.geekbang.org/account/avatar/00/13/ed/ee/c4779b67.jpg","nickname":"cy","note":"","ucode":"50D653399A31F6","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":450664,"discussion_content":"Good Job","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1577610871,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":82365,"user_name":"_xiongyi","can_delete":false,"product_type":"c1","uid":1482099,"ip_address":"","ucode":"F5038A1CC63DC2","user_header":"","comment_is_top":false,"comment_ctime":1554194066,"is_pvip":false,"replies":[{"id":64315,"content":"Good Job","user_name":"作者回复","user_name_real":"cy","uid":1306094,"ctime":1577616670,"ip_address":"","comment_id":82365,"utype":1}],"discussion_count":1,"race_medal":0,"score":8,"product_id":100021701,"comment_content":"import pandas as pd\nfrom pandas import Series, DataFrame\ndf1 = DataFrame({&#39;name&#39;:[&#39;ZhangFei&#39;,&#39;GuanYu&#39;,&#39;a&#39;,&#39;b&#39;,&#39;c&#39;],&#39;data1&#39;:range(5)})\ndf2 = DataFrame({&#39;name&#39;:[&#39;ZhangFei&#39;,&#39;GuanYu&#39;,&#39;A&#39;,&#39;B&#39;,&#39;C&#39;],&#39;data2&#39;:range(5)})\ndf3 = pd.merge(df1,df2,how=&#39;outer&#39;)\nprint(df3)\n\nimport pandas as pd\nfrom pandas import Series, DataFrame\ndata = {&#39;Chinese&#39;:[66,95,95,90,80,80],&#39;English&#39;:[65,85,92,88,90,90],&#39;Math&#39;:[None,98,96,77,90,90]}\ndf1 = DataFrame(data,index=[&#39;ZhangFei&#39;, &#39;GuanYu&#39;, &#39;ZhaoYun&#39;, &#39;HuangZhong&#39;, &#39;DianWei&#39;,&#39;DianWei&#39;],\n                columns=[&#39;Chinese&#39;,&#39;English&#39;,&#39;Math&#39;])\ndf1 = df1.drop_duplicates()\ndef plus(df):\n    df[&#39;总分&#39;]=(df[u&#39;Chinese&#39;]+df[u&#39;English&#39;]+df[u&#39;Math&#39;])\n    return df\ndf1 = df1.apply(plus,axis=1)\nprint(df1)","like_count":0,"discussions":[{"author":{"id":1306094,"avatar":"https://static001.geekbang.org/account/avatar/00/13/ed/ee/c4779b67.jpg","nickname":"cy","note":"","ucode":"50D653399A31F6","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":445566,"discussion_content":"Good Job","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1577616670,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":77723,"user_name":"『G YaQi』","can_delete":false,"product_type":"c1","uid":1461694,"ip_address":"","ucode":"D378F0C8D0EFD0","user_header":"https://static001.geekbang.org/account/avatar/00/16/4d/be/c04c9eac.jpg","comment_is_top":false,"comment_ctime":1552986791,"is_pvip":false,"replies":[{"id":64399,"content":"Good Job","user_name":"作者回复","user_name_real":"cy","uid":1306094,"ctime":1577618343,"ip_address":"","comment_id":77723,"utype":1}],"discussion_count":1,"race_medal":0,"score":8,"product_id":100021701,"comment_content":"import pandas as pd\nfrom pandas import Series, DataFrame\n\ndata = [[66, 65],\n        [95, 85, 98],\n        [95, 92, 96],\n        [90, 88, 77],\n        [80, 90, 90],\n        [80, 90, 90]]\nnames = [&#39;张飞&#39;,&#39;关羽&#39;,&#39;赵云&#39;,&#39;黄忠&#39;,&#39;典韦&#39;,&#39;典韦&#39;]\nclasses = [&#39;语文&#39;,&#39;英语&#39;,&#39;数学&#39;]\ndf = DataFrame(data=data,index=names,columns=classes)\ndf.dropna(inplace=True)\ndf.drop_duplicates(inplace=True)\ndf[&#39;总分&#39;] = df.语文 + df.英语 + df.数学\nprint(df)","like_count":0,"discussions":[{"author":{"id":1306094,"avatar":"https://static001.geekbang.org/account/avatar/00/13/ed/ee/c4779b67.jpg","nickname":"cy","note":"","ucode":"50D653399A31F6","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":443824,"discussion_content":"Good Job","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1577618343,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":77188,"user_name":"Geek_ce3c1f","can_delete":false,"product_type":"c1","uid":1452721,"ip_address":"","ucode":"31A9F00D01FE2D","user_header":"http://thirdwx.qlogo.cn/mmopen/vi_32/DYAIOgq83eqmqDPzn9q0YM0CgSicVD215GibbOpyC52vJ5LUbDicwoI7n3biapWls4qd7ENwH4tJyJibgGcyrM5kCzQ/132","comment_is_top":false,"comment_ctime":1552879811,"is_pvip":false,"replies":[{"id":64409,"content":"Good Job","user_name":"作者回复","user_name_real":"cy","uid":1306094,"ctime":1577618450,"ip_address":"","comment_id":77188,"utype":1}],"discussion_count":1,"race_medal":0,"score":8,"product_id":100021701,"comment_content":"import pandas as pd\n\n\n# 创建数据表\ndata = {&#39;Chinese&#39;: [66, 95, 95, 90, 80, 80],&#39;English&#39;: [65, 85, 92, 88, 90, 90],&#39;Math&#39;: [None, 98, 96, 77, 90, 90]}\ndf = pd.DataFrame(data, index=[&#39;ZhangFei&#39;, &#39;GuanYu&#39;,\n                                &#39;ZhaoYun&#39;, &#39;HuangZhong&#39;,\n                                &#39;DianWei&#39;,&#39;DianWei&#39;], columns=[&#39;Chinese&#39;,&#39;English&#39;,&#39;Math&#39;])\n# 去除重复行\ndf = df.drop_duplicates()\n\n# 将空值转换为0\n# df = df.fillna(0)\n# 将空值替换为均值\n# df = df.fillna(df.mean(axis=&#39;数学&#39;))\n\n\n# 重命名行列名\ndf.rename(index={&#39;ZhangFei&#39;:&#39;张飞&#39;, &#39;GuanYu&#39;:&#39;关羽&#39;, &#39;ZhaoYun&#39;:&#39;赵云&#39;, &#39;HuangZhong&#39;:&#39;黄忠&#39;, &#39;DianWei&#39;:&#39;典韦&#39;},\n          columns={&#39;Chinese&#39;:&#39;语文&#39;,&#39;English&#39;:&#39;英语&#39;,&#39;Math&#39;:&#39;数学&#39;},inplace=True)\n\n# 将空值替换为均值\ndf = df.fillna(df[&#39;数学&#39;].mean())\n\n# 创建新列并且计算每个人的三科成绩总和\ndf[&#39;总成绩&#39;] = df[&#39;语文&#39;] + df[&#39;英语&#39;] + df[&#39;数学&#39;]\n\nprint(df)\nprint(df.describe())\n","like_count":0,"discussions":[{"author":{"id":1306094,"avatar":"https://static001.geekbang.org/account/avatar/00/13/ed/ee/c4779b67.jpg","nickname":"cy","note":"","ucode":"50D653399A31F6","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":443626,"discussion_content":"Good Job","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1577618450,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":76568,"user_name":"Reinhardt Gao","can_delete":false,"product_type":"c1","uid":1436125,"ip_address":"","ucode":"E872470FFF9F4B","user_header":"https://static001.geekbang.org/account/avatar/00/15/e9/dd/7921208d.jpg","comment_is_top":false,"comment_ctime":1552633792,"is_pvip":false,"replies":[{"id":64419,"content":"Good Job","user_name":"作者回复","user_name_real":"cy","uid":1306094,"ctime":1577618921,"ip_address":"","comment_id":76568,"utype":1}],"discussion_count":1,"race_medal":0,"score":8,"product_id":100021701,"comment_content":"环境Python3.7 Anaconda\n注释段落尝试用sql去修改空值但是编译的时候报错说找不到表。但是同一个位置写select * from spreadsheet就没有问题。老师可否帮忙看一下？\n其他编译均通过\n\nfrom pandas import DataFrame\nfrom pandasql import sqldf\n\n# Create table\n\nscore = {&#39;Name&#39;:[&#39;Zhang Fei&#39;, &#39;Guan Yu&#39;, &#39;Zhao Yun&#39;, &#39;Huang Zhong&#39;, &#39;Dian Wei&#39;, &#39;Dian Wei&#39;],&#39;Chinese&#39;: [66, 95, 95, 90, 80, 80], &#39;English&#39;: [65, 85, 92, 88, 90, 90], &#39;Mathematics&#39;: [None, 98, 96, 77, 90, 90]}\nspreadsheet = DataFrame(score)\nprint(spreadsheet)\n\n# Data Preparation\n\nspreadsheet.drop_duplicates()\nprint(spreadsheet.isnull())\nspreadsheet.fillna(spreadsheet[&#39;Mathematics&#39;].mean(),inplace=True)\nprint(spreadsheet.isnull())\n\n\n&#39;&#39;&#39;\nHas problem with this code. WHen executing this part, interpreter throws out exception \nas &quot;sqlite3.OperationalError: no such table: spreadsheet&quot;. \nBut if we run &quot;Select * from spreadsheet&quot; here, no exception throw out.\npysql = lambda sql: sqldf(sql, globals())\nsql1 = &quot;update spreadsheet &quot; \\            \n       &quot;set Mathematics = 0 &quot; \\\n       &quot;where Name = &#39;Zhang Fei&#39;&quot;\nprint(pysql(sql1))\n&#39;&#39;&#39;\n# Add new column\n\nspreadsheet[&#39;Total&#39;] = spreadsheet[u&#39;Chinese&#39;] + spreadsheet[u&#39;English&#39;] + spreadsheet[u&#39;Mathematics&#39;]\nprint(spreadsheet)\n","like_count":0,"discussions":[{"author":{"id":1306094,"avatar":"https://static001.geekbang.org/account/avatar/00/13/ed/ee/c4779b67.jpg","nickname":"cy","note":"","ucode":"50D653399A31F6","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":443358,"discussion_content":"Good Job","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1577618921,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":72371,"user_name":"均","can_delete":false,"product_type":"c1","uid":1177456,"ip_address":"","ucode":"9BABCE1419817B","user_header":"https://static001.geekbang.org/account/avatar/00/11/f7/70/6be5dd41.jpg","comment_is_top":false,"comment_ctime":1551600444,"is_pvip":false,"replies":[{"id":64473,"content":"Good Job","user_name":"作者回复","user_name_real":"cy","uid":1306094,"ctime":1577619770,"ip_address":"","comment_id":72371,"utype":1}],"discussion_count":1,"race_medal":0,"score":8,"product_id":100021701,"comment_content":"\nimport pandas as pd\nfrom pandas import Series,DataFrame\n\n\ndef total_score(df):\n    df[&#39;总分&#39;]=(df[u&#39;语文&#39;]+df[u&#39;英语&#39;]+df[u&#39;数学&#39;])\n    return df\n\ndef main():\n    data={&#39;姓名&#39;:[&#39;张飞&#39;,&#39;关羽&#39;,&#39;赵云&#39;,&#39;黄忠&#39;,&#39;典韦&#39;,&#39;典韦&#39;],&#39;语文&#39;:[66,95,95,90,80,80],&#39;英语&#39;:[65,85,92,88,90,90],&#39;数学&#39;:[0,98,96,77,90,90]}\n    df1=DataFrame(data)\n    df1=df1.drop_duplicates()\n    df1=df1.apply(total_score,axis=1)\n    print(df1)","like_count":0,"discussions":[{"author":{"id":1306094,"avatar":"https://static001.geekbang.org/account/avatar/00/13/ed/ee/c4779b67.jpg","nickname":"cy","note":"","ucode":"50D653399A31F6","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":441561,"discussion_content":"Good Job","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1577619770,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":68648,"user_name":"Mikey","can_delete":false,"product_type":"c1","uid":1188191,"ip_address":"","ucode":"3EC73395031E88","user_header":"https://static001.geekbang.org/account/avatar/00/12/21/5f/9e1300d3.jpg","comment_is_top":false,"comment_ctime":1550566662,"is_pvip":false,"replies":[{"id":64529,"content":"Good Job","user_name":"作者回复","user_name_real":"cy","uid":1306094,"ctime":1577621323,"ip_address":"","comment_id":68648,"utype":1}],"discussion_count":1,"race_medal":0,"score":8,"product_id":100021701,"comment_content":"import pandas as pd\n\ndata = {&#39;Chinese&#39;:[66,95,95,90,80,80],\n        &#39;English&#39;:[65,85,92,88,90,90],\n        &#39;Math&#39;:[None,98,96,77,90,90]}\n\ndf = pd.DataFrame(data, index=[&#39;张飞&#39;, &#39;关羽&#39;, &#39;赵云&#39;, &#39;黄忠&#39;, &#39;典韦&#39;, &#39;典韦&#39;],columns=[&#39;English&#39;,&#39;Chinese&#39;,&#39;Math&#39;])\n\n# 数据清洗\n# 1.去除重复行\ndf = df.drop_duplicates()\n# 求和\ndf[&#39;total&#39;] = df[&#39;Chinese&#39;] + df[&#39;English&#39;] + df[&#39;Math&#39;]\n# 2.排序\ncols = [&#39;Chinese&#39;, &#39;English&#39;, &#39;Math&#39;]\ndf = df.filter(cols, axis=1)\n# 3.改成中文列名\ndf.rename(columns={&#39;Chinese&#39;:&#39;语文&#39;,&#39;English&#39;:&#39;英语&#39;,&#39;Math&#39;:&#39;数学&#39;,&#39;total&#39;:&#39;总和&#39;}, inplace=True)\n# 4.填充缺失值 (使用平均值)\ndf[&#39;数学&#39;].fillna(df[&#39;数学&#39;].mean(), inplace=True)\nprint(df)","like_count":0,"discussions":[{"author":{"id":1306094,"avatar":"https://static001.geekbang.org/account/avatar/00/13/ed/ee/c4779b67.jpg","nickname":"cy","note":"","ucode":"50D653399A31F6","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":439776,"discussion_content":"Good Job","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1577621323,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":67655,"user_name":"草包雷","can_delete":false,"product_type":"c1","uid":1158255,"ip_address":"","ucode":"A6466D21248DF5","user_header":"http://thirdwx.qlogo.cn/mmopen/vi_32/PiajxSqBRaEL8c2Tu3bibiaKQmS1rc58icJOsDKpCtYzhvMMr3YAYTHiboxCAG0CroejUibP0ALOQbzMWz6eyz49Ltcg/132","comment_is_top":false,"comment_ctime":1550217640,"is_pvip":false,"replies":[{"id":64566,"content":"Good Job","user_name":"作者回复","user_name_real":"cy","uid":1306094,"ctime":1577621820,"ip_address":"","comment_id":67655,"utype":1}],"discussion_count":1,"race_medal":0,"score":8,"product_id":100021701,"comment_content":"import pandas as pd\nfrom pandas import DataFrame\ndata = {&#39;语文&#39;: [66,95,95,90,80,80],&#39;英语&#39;: [65,85,92,88,90,90],&#39;数学&#39;: [None,98,96,77,90,90]}\ndf = DataFrame(data, index=[&#39;张飞&#39;, &#39;关羽&#39;, &#39;赵云&#39;, &#39;黄忠&#39;, &#39;典韦&#39;,&#39;典韦&#39;], columns=[&#39;语文&#39;, &#39;英语&#39;, &#39;数学&#39;])\n\ndf = df.drop_duplicates()\ndf=df.fillna(0)\ndef addtotal(df):\n     df[&#39;总分&#39;] = df[&#39;语文&#39;] + df[&#39;英语&#39;] + df[&#39;数学&#39;]\n     return  df\ndf = df.apply(addtotal,axis=1)\n\nprint (df)\n\n\n      语文    英语    数学     总分\n张飞  66.0  65.0   0.0  131.0\n关羽  95.0  85.0  98.0  278.0\n赵云  95.0  92.0  96.0  283.0\n黄忠  90.0  88.0  77.0  255.0\n典韦  80.0  90.0  90.0  260.0","like_count":0,"discussions":[{"author":{"id":1306094,"avatar":"https://static001.geekbang.org/account/avatar/00/13/ed/ee/c4779b67.jpg","nickname":"cy","note":"","ucode":"50D653399A31F6","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":439308,"discussion_content":"Good Job","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1577621820,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":64843,"user_name":"Geek_hve78z","can_delete":false,"product_type":"c1","uid":1015045,"ip_address":"","ucode":"386803B8FC2DD5","user_header":"https://static001.geekbang.org/account/avatar/00/0f/7d/05/4bad0c7c.jpg","comment_is_top":false,"comment_ctime":1548923012,"is_pvip":false,"replies":[{"id":64620,"content":"Good Job","user_name":"作者回复","user_name_real":"cy","uid":1306094,"ctime":1577622531,"ip_address":"","comment_id":64843,"utype":1}],"discussion_count":1,"race_medal":0,"score":8,"product_id":100021701,"comment_content":"1、在pandas中，最主要的数据结构是Series和DataFrame\nSeries: 是个定长的字典序列。俩个基本属性：index和values\nDataFrame：类似于数据库表，包括行索引和列索引。\n2、对于DataFrame数据清洗的函数\n1）删除不必要的列或行：drop（）\ndf=df.drop(columns=[&#39;Math&#39;]\ndf=df.drop(index=[&#39;ZhangFei&#39;]\n2）重命名列名columns：rename\nrename(columns=new_names, inplace=True)\n3）去重复的行 dtop_duplicates()\n4）格式问题\n4.1 更改数据格式 astype()\n4.2 删除数据间的空格 strip(), lstrip(), rstrip()\n4.3 大小写转换 upper(), lower(), title()\ndf.columns= df.columns.str.upper() ## 全部大写\n4.4 查找空值 df.isnull(), df.isnull().any()\n5）使用apply函数进行‘大写转换’、数值处理、新增列\n\n————————————————————\n代码呈现\n## 作业代码：对数据进行清洗，新增一列总和\nimport pandas as pd\nfrom pandas import DataFrame\n\ndata={&#39;语文&#39;:[66,95,95,90,80,80],&#39;英语&#39;:[65,85,92,88,90,90],&#39;数学&#39;:[None,98,96,77,90,90]}\ndf=DataFrame(data,index=[&#39;张飞&#39;,&#39;关羽&#39;,&#39;赵云&#39;,&#39;黄忠&#39;,&#39;典韦&#39;,&#39;典韦&#39;],columns=[&#39;语文&#39;,&#39;英语&#39;,&#39;数学&#39;])\n\n## 删除重复行\ndf=df.drop_duplicates()\n\n## 查找缺失值缺失值\nprint(df.isnull())\n\n## 利用平均值补充‘张飞’的缺失值\ndf[&#39;数学&#39;].fillna(df[&#39;数学&#39;].mean(),inplace=True)\n\n## 新增一列‘总分’\ndf[&#39;总分&#39;]=df[&#39;语文&#39;]+df[&#39;英语&#39;]+df[&#39;数学&#39;]\n\n## 按照总分排序，从高到低，输出\ndf.sort_values([&#39;总分&#39;],ascending=False,inplace=True)\n\n\n## 输出最终结果\nprint(df)\nprint(df.describe())\n\n\n","like_count":0,"discussions":[{"author":{"id":1306094,"avatar":"https://static001.geekbang.org/account/avatar/00/13/ed/ee/c4779b67.jpg","nickname":"cy","note":"","ucode":"50D653399A31F6","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":438203,"discussion_content":"Good Job","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1577622531,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":62100,"user_name":"Sniper","can_delete":false,"product_type":"c1","uid":1385287,"ip_address":"","ucode":"8FEA9AE27A7A08","user_header":"https://static001.geekbang.org/account/avatar/00/15/23/47/6c2a60ee.jpg","comment_is_top":false,"comment_ctime":1547910694,"is_pvip":false,"replies":[{"id":64690,"content":"Good Job","user_name":"作者回复","user_name_real":"cy","uid":1306094,"ctime":1577624264,"ip_address":"","comment_id":62100,"utype":1}],"discussion_count":1,"race_medal":0,"score":9,"product_id":100021701,"comment_content":"交作业（python3）：\nimport pandas as pd\nfrom pandas import Series, DataFrame\ndata = {&#39;Chinese&#39;: [66, 95, 95, 90, 80, 80],&#39;English&#39;: [65, 85, 92, 88, 90, 90],&#39;Math&#39;: [None, 98, 96, 77, 90, 90]}\ndf1= DataFrame(data)\ndf2 = DataFrame(data, index=[&#39;ZhangFei&#39;, &#39;GuanYu&#39;, &#39;ZhaoYun&#39;, &#39;HuangZhong&#39;, &#39;DianWei&#39;, &#39;DianWei&#39;],\n                columns=[&#39;Chinese&#39;, &#39;English&#39;, &#39;Math&#39;])\n\n# print (df2)\n# 对数据去重\ndf2 = df2.drop_duplicates()\n# 用平均值填充张飞数学成绩\ndf3 = df2.isnull() # 对每个坐标判断是否为空且返回dataframe\n# 返回columns列表\na = df2.columns\na = list(a)\n# 返回index列表\nb = df2.index\nb = list(b)\n# 对空值用均值填充\nfor course in a:\n    course_average = df2[course].mean()\n    for name in b:\n        if df3.loc[name, course]:\n            df2.loc[name, course] = course_average\n        else:\n            pass\n\n# 添加求和列\ndef plus(df):\n    df[&#39;total&#39;] = df[&#39;Chinese&#39;] + df[&#39;Math&#39;] + df[&#39;English&#39;]\n    return df\nplus(df2)\ndf2 = df2.apply(plus,axis=1)\n\nprint(df2)\n","like_count":0},{"had_liked":false,"id":61811,"user_name":"柚子","can_delete":false,"product_type":"c1","uid":1382672,"ip_address":"","ucode":"721F6C7F5DD303","user_header":"http://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTI45zO9GOMquk9JymTibN9sC25Sy4WtsDGRQzIRVIoIzPnaJGKmGe3jXqxP0zKZyTYazrXHBGYjBzw/132","comment_is_top":false,"comment_ctime":1547806165,"is_pvip":false,"replies":[{"id":64698,"content":"Good Job","user_name":"作者回复","user_name_real":"cy","uid":1306094,"ctime":1577624385,"ip_address":"","comment_id":61811,"utype":1}],"discussion_count":1,"race_medal":0,"score":9,"product_id":100021701,"comment_content":"df = pd.DataFrame({&#39;name&#39;[&#39;zhangfei&#39;,&#39;gaunyu&#39;,&#39;zhaoyun&#39;,&#39;huangzhong&#39;,&#39;dianwei&#39;,&#39;dianwei&#39;],\n                               &#39;chinese&#39;:[66,95,95,90,80,80],\n                               &#39;english&#39;:[65,85,92,88,90,90],\n                               &#39;math&#39;:[None,98,96,77,90,90]})\ndf = df.drop_duplicates()  #去除重复值\ndf = df.fillna(0)                 #空值填充，可以用0或者数学成绩的平均值\ndf[&#39;total&#39;] = df[&#39;chinese&#39;] + df[&#39;english&#39;] + df[&#39;math&#39;]\ndf","like_count":0,"discussions":[{"author":{"id":1306094,"avatar":"https://static001.geekbang.org/account/avatar/00/13/ed/ee/c4779b67.jpg","nickname":"cy","note":"","ucode":"50D653399A31F6","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":437095,"discussion_content":"Good Job","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1577624264,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":59793,"user_name":"马克图布","can_delete":false,"product_type":"c1","uid":1019274,"ip_address":"","ucode":"9E3879D6A55244","user_header":"https://static001.geekbang.org/account/avatar/00/0f/8d/8a/ec29ca4a.jpg","comment_is_top":false,"comment_ctime":1547426227,"is_pvip":false,"replies":[{"id":64760,"content":"代码里可以不加上u，也是work的","user_name":"作者回复","user_name_real":"cy","uid":1306094,"ctime":1577625202,"ip_address":"","comment_id":59793,"utype":1}],"discussion_count":1,"race_medal":0,"score":9,"product_id":100021701,"comment_content":"#!&#47;usr&#47;bin&#47;env python3\n# -*- coding: utf-8 -*-\n\nfrom pandas import DataFrame\n\ndata = {u&#39;语文&#39;: [66, 95, 95, 90, 80, 80], u&#39;英语&#39;: [65, 85, 92, 88, 90, 90], u&#39;数学&#39;: [None, 98, 96, 77, 90, 90]}\nname = [u&#39;张飞&#39;, u&#39;关羽&#39;, u&#39;赵云&#39;, u&#39;黄忠&#39;, u&#39;典韦&#39;, u&#39;典韦&#39;]\n\ndf1 = DataFrame(data, index=name)\n\n# Drop duplicated data\ndf1 = df1.drop_duplicates()\n\n# Fill the NaN with average grade\ndf1.fillna(value=df1[u&#39;数学&#39;].mean(), inplace=True)\n\n# Calculate the total grade\ndf1[u&#39;总分&#39;] = df1.sum(axis=1)\n\nprint(df1)\nprint(df1.describe())\n\n---\n老师，想问一下，如果在文件开头的 shebang 中已经指定了 `# -*- coding: utf-8 -*-` 的编码方式，在代码中还需要在每一个中文字符串前加上 u 吗？","like_count":0,"discussions":[{"author":{"id":1306094,"avatar":"https://static001.geekbang.org/account/avatar/00/13/ed/ee/c4779b67.jpg","nickname":"cy","note":"","ucode":"50D653399A31F6","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":437003,"discussion_content":"Good Job","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1577624385,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":58728,"user_name":"追梦小乐","can_delete":false,"product_type":"c1","uid":1035507,"ip_address":"","ucode":"82AB8A7F98389D","user_header":"https://static001.geekbang.org/account/avatar/00/0f/cc/f3/5e4b0315.jpg","comment_is_top":false,"comment_ctime":1547185802,"is_pvip":false,"replies":[{"id":64781,"content":"具体情况具体分析，也可以是填充平均值，或者找那条记录和哪条记录比较相近，就会另一条记录里的那个字段值来填充 也是一种方式","user_name":"作者回复","user_name_real":"cy","uid":1306094,"ctime":1577625515,"ip_address":"","comment_id":58728,"utype":1}],"discussion_count":1,"race_medal":0,"score":9,"product_id":100021701,"comment_content":"老师，缺省值在真实工作中一般是怎么处理的？做题的时候我的第一反应就是给缺失值补充0，不过我看到有用平均值的，这里面有什么讲究的吗？","like_count":0,"discussions":[{"author":{"id":1306094,"avatar":"https://static001.geekbang.org/account/avatar/00/13/ed/ee/c4779b67.jpg","nickname":"cy","note":"","ucode":"50D653399A31F6","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":436397,"discussion_content":"代码里可以不加上u，也是work的","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1577625202,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":58682,"user_name":"夏小爱","can_delete":false,"product_type":"c1","uid":1352069,"ip_address":"","ucode":"D1B29E85F46FB1","user_header":"http://thirdwx.qlogo.cn/mmopen/vi_32/PiaDmjdWicz1PM4F6XCjQwoQoXm8tdZxYj7iaOCZ1k1uUZey6OYMtUGgWTtAgG5HmdYtu3wEPdRgOHiaOiaaiazcSa8w/132","comment_is_top":false,"comment_ctime":1547174283,"is_pvip":false,"replies":[{"id":64782,"content":"Good Job","user_name":"作者回复","user_name_real":"cy","uid":1306094,"ctime":1577625523,"ip_address":"","comment_id":58682,"utype":1}],"discussion_count":1,"race_medal":0,"score":9,"product_id":100021701,"comment_content":"# &#47;usr&#47;bin&#47;env python2.7\n# -*- coding:utf-8 -*-\n\nfrom pandas import DataFrame\nimport numpy as np\n\ndata = np.array([[66, 95, 95, 90, 80, 80], [65, 85, 92, 88, 90, 90], [None, 98, 96, 77, 90, 90]])\ndf = DataFrame(data.T, index=[&quot;张飞&quot;, &quot;关羽&quot;, &quot;赵云&quot;, &quot;黄忠&quot;, &quot;典韦&quot;, &quot;典韦&quot;], columns=[&quot;语文&quot;, &quot;英语&quot;, &quot;数学&quot;])\nprint df\ndf[&quot;数学&quot;].fillna(df[&quot;数学&quot;].mean().astype(int), inplace=True)\ndf = df.drop_duplicates()\ndf[&quot;总分&quot;] = df.sum(axis=1)\nprint df\ndf.describe()\nprint df.loc[&quot;张飞&quot;]","like_count":0,"discussions":[{"author":{"id":1306094,"avatar":"https://static001.geekbang.org/account/avatar/00/13/ed/ee/c4779b67.jpg","nickname":"cy","note":"","ucode":"50D653399A31F6","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":436191,"discussion_content":"具体情况具体分析，也可以是填充平均值，或者找那条记录和哪条记录比较相近，就会另一条记录里的那个字段值来填充 也是一种方式","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1577625515,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":58502,"user_name":"圆圆的大食客","can_delete":false,"product_type":"c1","uid":1361827,"ip_address":"","ucode":"B5B87E08869507","user_header":"https://static001.geekbang.org/account/avatar/00/14/c7/a3/1e2f9f5a.jpg","comment_is_top":false,"comment_ctime":1547094814,"is_pvip":false,"replies":[{"id":64792,"content":"Good Job","user_name":"作者回复","user_name_real":"cy","uid":1306094,"ctime":1577625607,"ip_address":"","comment_id":58502,"utype":1}],"discussion_count":1,"race_medal":0,"score":9,"product_id":100021701,"comment_content":"import pandas as pd\nfrom pandas import Series, DataFrame\ndata = {&#39;Chinese&#39;: [66, 95, 93, 90, 80, 80],&#39;English&#39;: [65, 85, 92, 88, 90, 90],&#39;Math&#39;: [None, 98, 96, 77, 90, 90]}\ndf1= DataFrame(data)\ndf2 = DataFrame(data, index=[&#39;ZhangFei&#39;, &#39;GuanYu&#39;, &#39;ZhaoYun&#39;, &#39;HuangZhong&#39;, &#39;DianWei&#39;, &#39;Dianwei&#39;], columns=[&#39;Chinese&#39;, &#39;English&#39;, &#39;Math&#39;])\ndf2 = df2.drop_duplicates()\nprint (df2.isnull())  #Find out null \ndf2 = df2.fillna(df2.mean()) #Fill null with average\ndf2[&#39;Sum&#39;] = df2.apply(lambda x: x.sum(), axis=1 ) #add column &#39;Sum&#39; to sum grades\nprint (df2)","like_count":0,"discussions":[{"author":{"id":1306094,"avatar":"https://static001.geekbang.org/account/avatar/00/13/ed/ee/c4779b67.jpg","nickname":"cy","note":"","ucode":"50D653399A31F6","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":436170,"discussion_content":"Good Job","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1577625523,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":58387,"user_name":"小熊猫","can_delete":false,"product_type":"c1","uid":1257442,"ip_address":"","ucode":"7549BA17FFBAD4","user_header":"https://static001.geekbang.org/account/avatar/00/13/2f/e2/3640e491.jpg","comment_is_top":false,"comment_ctime":1547049039,"is_pvip":false,"replies":[{"id":64799,"content":"Good Job","user_name":"作者回复","user_name_real":"cy","uid":1306094,"ctime":1577625658,"ip_address":"","comment_id":58387,"utype":1}],"discussion_count":1,"race_medal":0,"score":9,"product_id":100021701,"comment_content":"import pandas as pd\nfrom pandas import DataFrame\n\ndata = {&#39;Chinese&#39;:[66, 95, 95, 90, 80, 80], &#39;English&#39;:[65, 85, 92, 88, 90, 90], \n        &#39;Math&#39;:[None, 98, 96, 77, 90, 90]}\ndf = DataFrame(data, index=[&#39;zhangfei&#39;, &#39;guanyu&#39;, &#39;zhaoyun&#39;, &#39;huangzhong&#39;, &#39;dianwei&#39;, &#39;dianwei&#39;], \n                columns=[&#39;Chinese&#39;, &#39;English&#39;, &#39;Math&#39;])\n# 清除重复行dianwei\ndf = df.drop_duplicates()\n# 行名、列名改成中文 df.rename(index={&#39;zhangfei&#39;:&#39;张飞&#39;, &#39;guanyu&#39;:&#39;关羽&#39;, &#39;zhaoyun&#39;:&#39;赵云&#39;, &#39;huangzhong&#39;:&#39;黄忠&#39;, &#39;dianwei&#39;:&#39;典韦&#39;}, columns={&#39;Chinese&#39;:&#39;语文&#39;, &#39;English&#39;:&#39;英语&#39;, &#39;Math&#39;:&#39;数学&#39;}, inplace=True)\n# 填充缺省值\ndf[&#39;数学&#39;].fillna(df[&#39;数学&#39;].mean(), inplace=True)\n# 新增一列“总分”，然后排序\ndf[&#39;总分&#39;] = df.apply(func=lambda x:x[&#39;语文&#39;] + x[&#39;英语&#39;] + x[&#39;数学&#39;], axis=1)\ndf.sort_values(&#39;总分&#39;, ascending=False, inplace=True)","like_count":0,"discussions":[{"author":{"id":1306094,"avatar":"https://static001.geekbang.org/account/avatar/00/13/ed/ee/c4779b67.jpg","nickname":"cy","note":"","ucode":"50D653399A31F6","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":436097,"discussion_content":"Good Job","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1577625607,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":56764,"user_name":"李沛欣","can_delete":false,"product_type":"c1","uid":1362695,"ip_address":"","ucode":"98874954230D95","user_header":"https://static001.geekbang.org/account/avatar/00/14/cb/07/e34220d6.jpg","comment_is_top":false,"comment_ctime":1546559669,"is_pvip":false,"replies":[{"id":21213,"content":"了解前面的就算是了解了pandas的核心。后面是关于一些数据库的查询操作，你可以重点对前面的两个数据结构，还有主要函数多一些操作。这些在python中使用频率算是比较高的","user_name":"作者回复","user_name_real":"cy","uid":1306094,"ctime":1547177077,"ip_address":"","comment_id":56764,"utype":1}],"discussion_count":1,"race_medal":0,"score":9,"product_id":100021701,"comment_content":"今天的看完了，有点儿吃力，哈哈。pandas的关键在于数据清洗功能和载入现成数据的功能。它主要的两个数据结构是series 和dataframe，主要的函数，有重命名，增删，去重，大小写等等。但是看到后面关于左啊右啊的，就蒙圈了。","like_count":0,"discussions":[{"author":{"id":1306094,"avatar":"https://static001.geekbang.org/account/avatar/00/13/ed/ee/c4779b67.jpg","nickname":"cy","note":"","ucode":"50D653399A31F6","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":436040,"discussion_content":"Good Job","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1577625658,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":56625,"user_name":"瑞","can_delete":false,"product_type":"c1","uid":1354236,"ip_address":"","ucode":"529AA74D89FEF3","user_header":"https://static001.geekbang.org/account/avatar/00/14/a9/fc/6d7df2b9.jpg","comment_is_top":false,"comment_ctime":1546509606,"is_pvip":false,"replies":[{"id":21207,"content":"张飞的数学在做清洗的时候会发现为空，可以用平均值的方式先补充上","user_name":"作者回复","user_name_real":"cy","uid":1306094,"ctime":1547176546,"ip_address":"","comment_id":56625,"utype":1}],"discussion_count":1,"race_medal":0,"score":9,"product_id":100021701,"comment_content":"import pandas as pd\nfrom pandas import Series,DataFrame\ndata={&#39;name&#39;:[&#39;张飞&#39;,&#39;关羽&#39;,&#39;赵云&#39;,&#39;黄忠&#39;,&#39;典韦&#39;,&#39;典韦&#39;],\n      &#39;Chinese&#39;:[66,95,95,90,80,80],&#39;English&#39;:[65,85,92,88,90,90],&#39;Math&#39;:[None,98,96,77,90,90],\n     &#39;total&#39;:[0,0,0,0,0,0]}\ndf=DataFrame(data,columns=[&#39;name&#39;,&#39;Chinese&#39;,&#39;English&#39;,&#39;Math&#39;,&#39;total&#39;])\n# print(df)\ndf.rename(columns={&#39;name&#39;:&#39;姓名&#39;,&#39;Chinese&#39;:&#39;语文&#39;,&#39;English&#39;:&#39;英语&#39;,&#39;Math&#39;:&#39;数学&#39;,&#39;total&#39;:&#39;总分&#39;},inplace=True)\n# print (df)\ndf=df.drop_duplicates()\ndf=df.fillna(0)\nprint (df)\n\ndef total_df(df):\n    df[&#39;总分&#39;]=df[&#39;语文&#39;]+df[&#39;英语&#39;]+df[&#39;数学&#39;]\n    return df\n\ndf.apply(total_df,axis=1)","like_count":0,"discussions":[{"author":{"id":1306094,"avatar":"https://static001.geekbang.org/account/avatar/00/13/ed/ee/c4779b67.jpg","nickname":"cy","note":"","ucode":"50D653399A31F6","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":435219,"discussion_content":"了解前面的就算是了解了pandas的核心。后面是关于一些数据库的查询操作，你可以重点对前面的两个数据结构，还有主要函数多一些操作。这些在python中使用频率算是比较高的","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1547177077,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":55281,"user_name":"沐念邪","can_delete":false,"product_type":"c1","uid":1337123,"ip_address":"","ucode":"06485FCA54DF6B","user_header":"https://static001.geekbang.org/account/avatar/00/14/67/23/16545faf.jpg","comment_is_top":false,"comment_ctime":1546089571,"is_pvip":false,"replies":[{"id":20207,"content":"代码前填写 # coding: utf-8\n中文前添加 u\n这两个你试试","user_name":"作者回复","user_name_real":"cy","uid":1306094,"ctime":1546395342,"ip_address":"","comment_id":55281,"utype":1}],"discussion_count":1,"race_medal":0,"score":9,"product_id":100021701,"comment_content":"columns写中文出错","like_count":0,"discussions":[{"author":{"id":1306094,"avatar":"https://static001.geekbang.org/account/avatar/00/13/ed/ee/c4779b67.jpg","nickname":"cy","note":"","ucode":"50D653399A31F6","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":435155,"discussion_content":"张飞的数学在做清洗的时候会发现为空，可以用平均值的方式先补充上","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1547176546,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":62100,"user_name":"Sniper","can_delete":false,"product_type":"c1","uid":1385287,"ip_address":"","ucode":"8FEA9AE27A7A08","user_header":"https://static001.geekbang.org/account/avatar/00/15/23/47/6c2a60ee.jpg","comment_is_top":false,"comment_ctime":1547910694,"is_pvip":false,"replies":[{"id":64690,"content":"Good Job","user_name":"作者回复","user_name_real":"cy","uid":1306094,"ctime":1577624264,"ip_address":"","comment_id":62100,"utype":1}],"discussion_count":1,"race_medal":0,"score":9,"product_id":100021701,"comment_content":"交作业（python3）：\nimport pandas as pd\nfrom pandas import Series, DataFrame\ndata = {&#39;Chinese&#39;: [66, 95, 95, 90, 80, 80],&#39;English&#39;: [65, 85, 92, 88, 90, 90],&#39;Math&#39;: [None, 98, 96, 77, 90, 90]}\ndf1= DataFrame(data)\ndf2 = DataFrame(data, index=[&#39;ZhangFei&#39;, &#39;GuanYu&#39;, &#39;ZhaoYun&#39;, &#39;HuangZhong&#39;, &#39;DianWei&#39;, &#39;DianWei&#39;],\n                columns=[&#39;Chinese&#39;, &#39;English&#39;, &#39;Math&#39;])\n\n# print (df2)\n# 对数据去重\ndf2 = df2.drop_duplicates()\n# 用平均值填充张飞数学成绩\ndf3 = df2.isnull() # 对每个坐标判断是否为空且返回dataframe\n# 返回columns列表\na = df2.columns\na = list(a)\n# 返回index列表\nb = df2.index\nb = list(b)\n# 对空值用均值填充\nfor course in a:\n    course_average = df2[course].mean()\n    for name in b:\n        if df3.loc[name, course]:\n            df2.loc[name, course] = course_average\n        else:\n            pass\n\n# 添加求和列\ndef plus(df):\n    df[&#39;total&#39;] = df[&#39;Chinese&#39;] + df[&#39;Math&#39;] + df[&#39;English&#39;]\n    return df\nplus(df2)\ndf2 = df2.apply(plus,axis=1)\n\nprint(df2)\n","like_count":0,"discussions":[{"author":{"id":1306094,"avatar":"https://static001.geekbang.org/account/avatar/00/13/ed/ee/c4779b67.jpg","nickname":"cy","note":"","ucode":"50D653399A31F6","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":437095,"discussion_content":"Good Job","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1577624264,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":61811,"user_name":"柚子","can_delete":false,"product_type":"c1","uid":1382672,"ip_address":"","ucode":"721F6C7F5DD303","user_header":"http://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTI45zO9GOMquk9JymTibN9sC25Sy4WtsDGRQzIRVIoIzPnaJGKmGe3jXqxP0zKZyTYazrXHBGYjBzw/132","comment_is_top":false,"comment_ctime":1547806165,"is_pvip":false,"replies":[{"id":64698,"content":"Good Job","user_name":"作者回复","user_name_real":"cy","uid":1306094,"ctime":1577624385,"ip_address":"","comment_id":61811,"utype":1}],"discussion_count":1,"race_medal":0,"score":9,"product_id":100021701,"comment_content":"df = pd.DataFrame({&#39;name&#39;[&#39;zhangfei&#39;,&#39;gaunyu&#39;,&#39;zhaoyun&#39;,&#39;huangzhong&#39;,&#39;dianwei&#39;,&#39;dianwei&#39;],\n                               &#39;chinese&#39;:[66,95,95,90,80,80],\n                               &#39;english&#39;:[65,85,92,88,90,90],\n                               &#39;math&#39;:[None,98,96,77,90,90]})\ndf = df.drop_duplicates()  #去除重复值\ndf = df.fillna(0)                 #空值填充，可以用0或者数学成绩的平均值\ndf[&#39;total&#39;] = df[&#39;chinese&#39;] + df[&#39;english&#39;] + df[&#39;math&#39;]\ndf","like_count":0,"discussions":[{"author":{"id":1306094,"avatar":"https://static001.geekbang.org/account/avatar/00/13/ed/ee/c4779b67.jpg","nickname":"cy","note":"","ucode":"50D653399A31F6","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":437003,"discussion_content":"Good Job","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1577624385,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":59793,"user_name":"马克图布","can_delete":false,"product_type":"c1","uid":1019274,"ip_address":"","ucode":"9E3879D6A55244","user_header":"https://static001.geekbang.org/account/avatar/00/0f/8d/8a/ec29ca4a.jpg","comment_is_top":false,"comment_ctime":1547426227,"is_pvip":false,"replies":[{"id":64760,"content":"代码里可以不加上u，也是work的","user_name":"作者回复","user_name_real":"cy","uid":1306094,"ctime":1577625202,"ip_address":"","comment_id":59793,"utype":1}],"discussion_count":1,"race_medal":0,"score":9,"product_id":100021701,"comment_content":"#!&#47;usr&#47;bin&#47;env python3\n# -*- coding: utf-8 -*-\n\nfrom pandas import DataFrame\n\ndata = {u&#39;语文&#39;: [66, 95, 95, 90, 80, 80], u&#39;英语&#39;: [65, 85, 92, 88, 90, 90], u&#39;数学&#39;: [None, 98, 96, 77, 90, 90]}\nname = [u&#39;张飞&#39;, u&#39;关羽&#39;, u&#39;赵云&#39;, u&#39;黄忠&#39;, u&#39;典韦&#39;, u&#39;典韦&#39;]\n\ndf1 = DataFrame(data, index=name)\n\n# Drop duplicated data\ndf1 = df1.drop_duplicates()\n\n# Fill the NaN with average grade\ndf1.fillna(value=df1[u&#39;数学&#39;].mean(), inplace=True)\n\n# Calculate the total grade\ndf1[u&#39;总分&#39;] = df1.sum(axis=1)\n\nprint(df1)\nprint(df1.describe())\n\n---\n老师，想问一下，如果在文件开头的 shebang 中已经指定了 `# -*- coding: utf-8 -*-` 的编码方式，在代码中还需要在每一个中文字符串前加上 u 吗？","like_count":0,"discussions":[{"author":{"id":1306094,"avatar":"https://static001.geekbang.org/account/avatar/00/13/ed/ee/c4779b67.jpg","nickname":"cy","note":"","ucode":"50D653399A31F6","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":436397,"discussion_content":"代码里可以不加上u，也是work的","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1577625202,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":58728,"user_name":"追梦小乐","can_delete":false,"product_type":"c1","uid":1035507,"ip_address":"","ucode":"82AB8A7F98389D","user_header":"https://static001.geekbang.org/account/avatar/00/0f/cc/f3/5e4b0315.jpg","comment_is_top":false,"comment_ctime":1547185802,"is_pvip":false,"replies":[{"id":64781,"content":"具体情况具体分析，也可以是填充平均值，或者找那条记录和哪条记录比较相近，就会另一条记录里的那个字段值来填充 也是一种方式","user_name":"作者回复","user_name_real":"cy","uid":1306094,"ctime":1577625515,"ip_address":"","comment_id":58728,"utype":1}],"discussion_count":1,"race_medal":0,"score":9,"product_id":100021701,"comment_content":"老师，缺省值在真实工作中一般是怎么处理的？做题的时候我的第一反应就是给缺失值补充0，不过我看到有用平均值的，这里面有什么讲究的吗？","like_count":0,"discussions":[{"author":{"id":1306094,"avatar":"https://static001.geekbang.org/account/avatar/00/13/ed/ee/c4779b67.jpg","nickname":"cy","note":"","ucode":"50D653399A31F6","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":436191,"discussion_content":"具体情况具体分析，也可以是填充平均值，或者找那条记录和哪条记录比较相近，就会另一条记录里的那个字段值来填充 也是一种方式","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1577625515,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":58682,"user_name":"夏小爱","can_delete":false,"product_type":"c1","uid":1352069,"ip_address":"","ucode":"D1B29E85F46FB1","user_header":"http://thirdwx.qlogo.cn/mmopen/vi_32/PiaDmjdWicz1PM4F6XCjQwoQoXm8tdZxYj7iaOCZ1k1uUZey6OYMtUGgWTtAgG5HmdYtu3wEPdRgOHiaOiaaiazcSa8w/132","comment_is_top":false,"comment_ctime":1547174283,"is_pvip":false,"replies":[{"id":64782,"content":"Good Job","user_name":"作者回复","user_name_real":"cy","uid":1306094,"ctime":1577625523,"ip_address":"","comment_id":58682,"utype":1}],"discussion_count":1,"race_medal":0,"score":9,"product_id":100021701,"comment_content":"# &#47;usr&#47;bin&#47;env python2.7\n# -*- coding:utf-8 -*-\n\nfrom pandas import DataFrame\nimport numpy as np\n\ndata = np.array([[66, 95, 95, 90, 80, 80], [65, 85, 92, 88, 90, 90], [None, 98, 96, 77, 90, 90]])\ndf = DataFrame(data.T, index=[&quot;张飞&quot;, &quot;关羽&quot;, &quot;赵云&quot;, &quot;黄忠&quot;, &quot;典韦&quot;, &quot;典韦&quot;], columns=[&quot;语文&quot;, &quot;英语&quot;, &quot;数学&quot;])\nprint df\ndf[&quot;数学&quot;].fillna(df[&quot;数学&quot;].mean().astype(int), inplace=True)\ndf = df.drop_duplicates()\ndf[&quot;总分&quot;] = df.sum(axis=1)\nprint df\ndf.describe()\nprint df.loc[&quot;张飞&quot;]","like_count":0,"discussions":[{"author":{"id":1306094,"avatar":"https://static001.geekbang.org/account/avatar/00/13/ed/ee/c4779b67.jpg","nickname":"cy","note":"","ucode":"50D653399A31F6","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":436170,"discussion_content":"Good Job","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1577625523,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":58502,"user_name":"圆圆的大食客","can_delete":false,"product_type":"c1","uid":1361827,"ip_address":"","ucode":"B5B87E08869507","user_header":"https://static001.geekbang.org/account/avatar/00/14/c7/a3/1e2f9f5a.jpg","comment_is_top":false,"comment_ctime":1547094814,"is_pvip":false,"replies":[{"id":64792,"content":"Good Job","user_name":"作者回复","user_name_real":"cy","uid":1306094,"ctime":1577625607,"ip_address":"","comment_id":58502,"utype":1}],"discussion_count":1,"race_medal":0,"score":9,"product_id":100021701,"comment_content":"import pandas as pd\nfrom pandas import Series, DataFrame\ndata = {&#39;Chinese&#39;: [66, 95, 93, 90, 80, 80],&#39;English&#39;: [65, 85, 92, 88, 90, 90],&#39;Math&#39;: [None, 98, 96, 77, 90, 90]}\ndf1= DataFrame(data)\ndf2 = DataFrame(data, index=[&#39;ZhangFei&#39;, &#39;GuanYu&#39;, &#39;ZhaoYun&#39;, &#39;HuangZhong&#39;, &#39;DianWei&#39;, &#39;Dianwei&#39;], columns=[&#39;Chinese&#39;, &#39;English&#39;, &#39;Math&#39;])\ndf2 = df2.drop_duplicates()\nprint (df2.isnull())  #Find out null \ndf2 = df2.fillna(df2.mean()) #Fill null with average\ndf2[&#39;Sum&#39;] = df2.apply(lambda x: x.sum(), axis=1 ) #add column &#39;Sum&#39; to sum grades\nprint (df2)","like_count":0,"discussions":[{"author":{"id":1306094,"avatar":"https://static001.geekbang.org/account/avatar/00/13/ed/ee/c4779b67.jpg","nickname":"cy","note":"","ucode":"50D653399A31F6","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":436097,"discussion_content":"Good Job","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1577625607,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":58387,"user_name":"小熊猫","can_delete":false,"product_type":"c1","uid":1257442,"ip_address":"","ucode":"7549BA17FFBAD4","user_header":"https://static001.geekbang.org/account/avatar/00/13/2f/e2/3640e491.jpg","comment_is_top":false,"comment_ctime":1547049039,"is_pvip":false,"replies":[{"id":64799,"content":"Good Job","user_name":"作者回复","user_name_real":"cy","uid":1306094,"ctime":1577625658,"ip_address":"","comment_id":58387,"utype":1}],"discussion_count":1,"race_medal":0,"score":9,"product_id":100021701,"comment_content":"import pandas as pd\nfrom pandas import DataFrame\n\ndata = {&#39;Chinese&#39;:[66, 95, 95, 90, 80, 80], &#39;English&#39;:[65, 85, 92, 88, 90, 90], \n        &#39;Math&#39;:[None, 98, 96, 77, 90, 90]}\ndf = DataFrame(data, index=[&#39;zhangfei&#39;, &#39;guanyu&#39;, &#39;zhaoyun&#39;, &#39;huangzhong&#39;, &#39;dianwei&#39;, &#39;dianwei&#39;], \n                columns=[&#39;Chinese&#39;, &#39;English&#39;, &#39;Math&#39;])\n# 清除重复行dianwei\ndf = df.drop_duplicates()\n# 行名、列名改成中文 df.rename(index={&#39;zhangfei&#39;:&#39;张飞&#39;, &#39;guanyu&#39;:&#39;关羽&#39;, &#39;zhaoyun&#39;:&#39;赵云&#39;, &#39;huangzhong&#39;:&#39;黄忠&#39;, &#39;dianwei&#39;:&#39;典韦&#39;}, columns={&#39;Chinese&#39;:&#39;语文&#39;, &#39;English&#39;:&#39;英语&#39;, &#39;Math&#39;:&#39;数学&#39;}, inplace=True)\n# 填充缺省值\ndf[&#39;数学&#39;].fillna(df[&#39;数学&#39;].mean(), inplace=True)\n# 新增一列“总分”，然后排序\ndf[&#39;总分&#39;] = df.apply(func=lambda x:x[&#39;语文&#39;] + x[&#39;英语&#39;] + x[&#39;数学&#39;], axis=1)\ndf.sort_values(&#39;总分&#39;, ascending=False, inplace=True)","like_count":0,"discussions":[{"author":{"id":1306094,"avatar":"https://static001.geekbang.org/account/avatar/00/13/ed/ee/c4779b67.jpg","nickname":"cy","note":"","ucode":"50D653399A31F6","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":436040,"discussion_content":"Good Job","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1577625658,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":56764,"user_name":"李沛欣","can_delete":false,"product_type":"c1","uid":1362695,"ip_address":"","ucode":"98874954230D95","user_header":"https://static001.geekbang.org/account/avatar/00/14/cb/07/e34220d6.jpg","comment_is_top":false,"comment_ctime":1546559669,"is_pvip":false,"replies":[{"id":21213,"content":"了解前面的就算是了解了pandas的核心。后面是关于一些数据库的查询操作，你可以重点对前面的两个数据结构，还有主要函数多一些操作。这些在python中使用频率算是比较高的","user_name":"作者回复","user_name_real":"cy","uid":1306094,"ctime":1547177077,"ip_address":"","comment_id":56764,"utype":1}],"discussion_count":1,"race_medal":0,"score":9,"product_id":100021701,"comment_content":"今天的看完了，有点儿吃力，哈哈。pandas的关键在于数据清洗功能和载入现成数据的功能。它主要的两个数据结构是series 和dataframe，主要的函数，有重命名，增删，去重，大小写等等。但是看到后面关于左啊右啊的，就蒙圈了。","like_count":0,"discussions":[{"author":{"id":1306094,"avatar":"https://static001.geekbang.org/account/avatar/00/13/ed/ee/c4779b67.jpg","nickname":"cy","note":"","ucode":"50D653399A31F6","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":435219,"discussion_content":"了解前面的就算是了解了pandas的核心。后面是关于一些数据库的查询操作，你可以重点对前面的两个数据结构，还有主要函数多一些操作。这些在python中使用频率算是比较高的","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1547177077,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":56625,"user_name":"瑞","can_delete":false,"product_type":"c1","uid":1354236,"ip_address":"","ucode":"529AA74D89FEF3","user_header":"https://static001.geekbang.org/account/avatar/00/14/a9/fc/6d7df2b9.jpg","comment_is_top":false,"comment_ctime":1546509606,"is_pvip":false,"replies":[{"id":21207,"content":"张飞的数学在做清洗的时候会发现为空，可以用平均值的方式先补充上","user_name":"作者回复","user_name_real":"cy","uid":1306094,"ctime":1547176546,"ip_address":"","comment_id":56625,"utype":1}],"discussion_count":1,"race_medal":0,"score":9,"product_id":100021701,"comment_content":"import pandas as pd\nfrom pandas import Series,DataFrame\ndata={&#39;name&#39;:[&#39;张飞&#39;,&#39;关羽&#39;,&#39;赵云&#39;,&#39;黄忠&#39;,&#39;典韦&#39;,&#39;典韦&#39;],\n      &#39;Chinese&#39;:[66,95,95,90,80,80],&#39;English&#39;:[65,85,92,88,90,90],&#39;Math&#39;:[None,98,96,77,90,90],\n     &#39;total&#39;:[0,0,0,0,0,0]}\ndf=DataFrame(data,columns=[&#39;name&#39;,&#39;Chinese&#39;,&#39;English&#39;,&#39;Math&#39;,&#39;total&#39;])\n# print(df)\ndf.rename(columns={&#39;name&#39;:&#39;姓名&#39;,&#39;Chinese&#39;:&#39;语文&#39;,&#39;English&#39;:&#39;英语&#39;,&#39;Math&#39;:&#39;数学&#39;,&#39;total&#39;:&#39;总分&#39;},inplace=True)\n# print (df)\ndf=df.drop_duplicates()\ndf=df.fillna(0)\nprint (df)\n\ndef total_df(df):\n    df[&#39;总分&#39;]=df[&#39;语文&#39;]+df[&#39;英语&#39;]+df[&#39;数学&#39;]\n    return df\n\ndf.apply(total_df,axis=1)","like_count":0,"discussions":[{"author":{"id":1306094,"avatar":"https://static001.geekbang.org/account/avatar/00/13/ed/ee/c4779b67.jpg","nickname":"cy","note":"","ucode":"50D653399A31F6","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":435155,"discussion_content":"张飞的数学在做清洗的时候会发现为空，可以用平均值的方式先补充上","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1547176546,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":55281,"user_name":"沐念邪","can_delete":false,"product_type":"c1","uid":1337123,"ip_address":"","ucode":"06485FCA54DF6B","user_header":"https://static001.geekbang.org/account/avatar/00/14/67/23/16545faf.jpg","comment_is_top":false,"comment_ctime":1546089571,"is_pvip":false,"replies":[{"id":20207,"content":"代码前填写 # coding: utf-8\n中文前添加 u\n这两个你试试","user_name":"作者回复","user_name_real":"cy","uid":1306094,"ctime":1546395342,"ip_address":"","comment_id":55281,"utype":1}],"discussion_count":1,"race_medal":0,"score":9,"product_id":100021701,"comment_content":"columns写中文出错","like_count":0,"discussions":[{"author":{"id":1306094,"avatar":"https://static001.geekbang.org/account/avatar/00/13/ed/ee/c4779b67.jpg","nickname":"cy","note":"","ucode":"50D653399A31F6","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":434726,"discussion_content":"代码前填写 # coding: utf-8\n中文前添加 u\n这两个你试试","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1546395342,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":53455,"user_name":"Geek_zclap3","can_delete":false,"product_type":"c1","uid":1179158,"ip_address":"","ucode":"DB05C0F7D2C472","user_header":"https://static001.geekbang.org/account/avatar/00/11/fe/16/aac4d7f2.jpg","comment_is_top":false,"comment_ctime":1545648546,"is_pvip":false,"replies":[{"id":19401,"content":"👍写总结的同学，另外也可以把总结的文字贴过来","user_name":"作者回复","user_name_real":"cy","uid":1306094,"ctime":1545666399,"ip_address":"","comment_id":53455,"utype":1}],"discussion_count":1,"race_medal":0,"score":10,"product_id":100021701,"comment_content":"今日总结：\nhttps:&#47;&#47;mubu.com&#47;doc&#47;tfLtTByI50","like_count":0},{"had_liked":false,"id":53427,"user_name":"Hyperuniverse","can_delete":false,"product_type":"c1","uid":1352392,"ip_address":"","ucode":"5720D21D349E0A","user_header":"https://static001.geekbang.org/account/avatar/00/14/a2/c8/f8753e06.jpg","comment_is_top":false,"comment_ctime":1545641902,"is_pvip":false,"replies":[{"id":19402,"content":"是的 省去很多事 ","user_name":"作者回复","user_name_real":"cy","uid":1306094,"ctime":1545666442,"ip_address":"","comment_id":53427,"utype":1}],"discussion_count":1,"race_medal":0,"score":10,"product_id":100021701,"comment_content":"pandasql真的好用.","like_count":0,"discussions":[{"author":{"id":1306094,"avatar":"https://static001.geekbang.org/account/avatar/00/13/ed/ee/c4779b67.jpg","nickname":"cy","note":"","ucode":"50D653399A31F6","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":434136,"discussion_content":"是的 省去很多事 ","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1545666442,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":53268,"user_name":"frazer","can_delete":false,"product_type":"c1","uid":1194427,"ip_address":"","ucode":"36869573D98495","user_header":"https://static001.geekbang.org/account/avatar/00/12/39/bb/3dd9ef18.jpg","comment_is_top":false,"comment_ctime":1545620863,"is_pvip":false,"replies":[{"id":19411,"content":"其实也是一些细节操作，根本目标就是让数据更规整","user_name":"作者回复","user_name_real":"cy","uid":1306094,"ctime":1545667188,"ip_address":"","comment_id":53268,"utype":1}],"discussion_count":1,"race_medal":0,"score":10,"product_id":100021701,"comment_content":"这就是传说中的数据清洗，好高大上的概念\n","like_count":0,"discussions":[{"author":{"id":1306094,"avatar":"https://static001.geekbang.org/account/avatar/00/13/ed/ee/c4779b67.jpg","nickname":"cy","note":"","ucode":"50D653399A31F6","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":434088,"discussion_content":"其实也是一些细节操作，根本目标就是让数据更规整","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1545667188,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":55049,"user_name":"自导自演","can_delete":false,"product_type":"c1","uid":1352180,"ip_address":"","ucode":"C497F01EABF944","user_header":"https://static001.geekbang.org/account/avatar/00/14/a1/f4/5e562863.jpg","comment_is_top":false,"comment_ctime":1546010257,"is_pvip":false,"replies":null,"discussion_count":15,"race_medal":0,"score":10,"product_id":100021701,"comment_content":"老师能换3.x版本的吗？一堆2.x问题一直卡着好难受。","like_count":114,"discussions":[{"author":{"id":1930025,"avatar":"","nickname":"雷","note":"","ucode":"9B173B575A7317","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":215170,"discussion_content":"对于初入编程的人，一开始接触的是python3，能用python3是会友好些","likes_number":3,"is_delete":false,"is_hidden":false,"ctime":1585295432,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"","child_discussion_number":2,"child_discussions":[{"author":{"id":1951924,"avatar":"http://thirdwx.qlogo.cn/mmopen/vi_32/1ornnGqSaTxRdbxhUHibeylvYngHvK64ebMaBso6vwXD9I3OEic75dZXxypvwfoCKeKutkpK2d7Xte8Gqh0UH4QA/132","nickname":"Geek_5d8f2f","note":"","ucode":"2836BC5634E64F","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":1930025,"avatar":"","nickname":"雷","note":"","ucode":"9B173B575A7317","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":223676,"discussion_content":"老兄，你是新学习的吗？下网有个小伙伴可以一起交流啊。我刚买的课程","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1586245494,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":215170,"ip_address":"","group_id":0},"score":223676,"extra":""},{"author":{"id":1960215,"avatar":"http://thirdwx.qlogo.cn/mmopen/vi_32/RtwUHVBWSMjPlSmVlRh5eNiaXSLHHJiaMg7kFchHjoUibmvqk6OUB2B9NUs6t1hxAUVWEjf2oeXKeiaUskb6kkicOOw/132","nickname":"徐飞翔","note":"","ucode":"5253B355EEFB7A","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":1951924,"avatar":"http://thirdwx.qlogo.cn/mmopen/vi_32/1ornnGqSaTxRdbxhUHibeylvYngHvK64ebMaBso6vwXD9I3OEic75dZXxypvwfoCKeKutkpK2d7Xte8Gqh0UH4QA/132","nickname":"Geek_5d8f2f","note":"","ucode":"2836BC5634E64F","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":228920,"discussion_content":"可以加我一起学习Jenny50470503","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1586590229,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":223676,"ip_address":"","group_id":0},"score":228920,"extra":""}]},{"author":{"id":1917715,"avatar":"https://static001.geekbang.org/account/avatar/00/1d/43/13/649ccaa9.jpg","nickname":"海林Lin","note":"","ucode":"26333AE3DFAF9D","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":269128,"discussion_content":"遇到问题上网搜索下就解决了，反正总有报错需要处理的，这样也能锻炼动手处理能力","likes_number":2,"is_delete":false,"is_hidden":false,"ctime":1589869256,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1488280,"avatar":"https://static001.geekbang.org/account/avatar/00/16/b5/98/ffaf2aca.jpg","nickname":"Ronnyz","note":"","ucode":"9F34527B1D343D","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":30997,"discussion_content":"所有的print都加上（）基本就没问题了","likes_number":2,"is_delete":false,"is_hidden":false,"ctime":1570877375,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1370659,"avatar":"https://static001.geekbang.org/account/avatar/00/14/ea/23/508f71e3.jpg","nickname":"Jefitar","note":"","ucode":"D7ED9F32ADA5B1","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":24497,"discussion_content":"我用的3.7，也就一点点的差别，没问题啊","likes_number":2,"is_delete":false,"is_hidden":false,"ctime":1570159622,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1252206,"avatar":"https://static001.geekbang.org/account/avatar/00/13/1b/6e/cd8fea9f.jpg","nickname":"RecordLiu","note":"","ucode":"41178CC21337FB","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":548431,"discussion_content":"Python3和Python2语法差别不大，老师的例子Python3基本能跑，Python3中输出的写法为print()","likes_number":1,"is_delete":false,"is_hidden":false,"ctime":1643189783,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1525309,"avatar":"https://static001.geekbang.org/account/avatar/00/17/46/3d/55653953.jpg","nickname":"AI悦创","note":"","ucode":"D1007711CB0A79","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":302575,"discussion_content":"可以加我一起学习：Jiabcdefh，公众号：AI悦创","likes_number":1,"is_delete":false,"is_hidden":false,"ctime":1598964195,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1599519,"avatar":"","nickname":"爱吃的吃吃","note":"","ucode":"8D20209811E9F3","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":1901,"discussion_content":"+1\n","likes_number":1,"is_delete":false,"is_hidden":false,"ctime":1563075794,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1930025,"avatar":"","nickname":"雷","note":"","ucode":"9B173B575A7317","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":213149,"discussion_content":"我也用的3.7","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1585055769,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1546360,"avatar":"https://static001.geekbang.org/account/avatar/00/17/98/78/17953599.jpg","nickname":"张小艺","note":"","ucode":"85222658EA5D6F","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":50245,"discussion_content":"而且，就只是print加括号的区别","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1573696369,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1546360,"avatar":"https://static001.geekbang.org/account/avatar/00/17/98/78/17953599.jpg","nickname":"张小艺","note":"","ucode":"85222658EA5D6F","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":50244,"discussion_content":"哪怕是跟着老师学，也需要自己适应的","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1573696338,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1292302,"avatar":"https://static001.geekbang.org/account/avatar/00/13/b8/0e/795c1d59.jpg","nickname":"六天六夜六斤作业","note":"","ucode":"5A5DE3BD2732DC","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":3300,"discussion_content":"+1","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1564384965,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":"","group_id":0},"score":3,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1027194,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/ac/7a/4e794516.jpg","nickname":"上善问道","note":"","ucode":"F255CC6176E752","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":1267,"discussion_content":"支持\n","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1562488262,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":"","group_id":0},"score":3,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1591008,"avatar":"https://static001.geekbang.org/account/avatar/00/18/46/e0/20a20115.jpg","nickname":"libean","note":"","ucode":"F9332FAA3CFFEF","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":541,"discussion_content":"支持","likes_number":1,"is_delete":false,"is_hidden":false,"ctime":1561684015,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":"","group_id":0},"score":3,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":53447,"user_name":"大萌","can_delete":false,"product_type":"c1","uid":1357028,"ip_address":"","ucode":"5E9EB5659230DE","user_header":"https://static001.geekbang.org/account/avatar/00/14/b4/e4/7c16516d.jpg","comment_is_top":false,"comment_ctime":1545645749,"is_pvip":false,"replies":null,"discussion_count":5,"race_medal":0,"score":10,"product_id":100021701,"comment_content":"另外推荐一个链接：https:&#47;&#47;www.cnblogs.com&#47;nxld&#47;p&#47;6756492.html\n很实用，里面记载了许多python常使用的方法","like_count":37,"discussions":[{"author":{"id":1930025,"avatar":"","nickname":"雷","note":"","ucode":"9B173B575A7317","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":215170,"discussion_content":"对于初入编程的人，一开始接触的是python3，能用python3是会友好些","likes_number":3,"is_delete":false,"is_hidden":false,"ctime":1585295432,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"","child_discussion_number":2,"child_discussions":[{"author":{"id":1951924,"avatar":"http://thirdwx.qlogo.cn/mmopen/vi_32/1ornnGqSaTxRdbxhUHibeylvYngHvK64ebMaBso6vwXD9I3OEic75dZXxypvwfoCKeKutkpK2d7Xte8Gqh0UH4QA/132","nickname":"Geek_5d8f2f","note":"","ucode":"2836BC5634E64F","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":1930025,"avatar":"","nickname":"雷","note":"","ucode":"9B173B575A7317","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":223676,"discussion_content":"老兄，你是新学习的吗？下网有个小伙伴可以一起交流啊。我刚买的课程","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1586245494,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":215170,"ip_address":"","group_id":0},"score":223676,"extra":""},{"author":{"id":1960215,"avatar":"http://thirdwx.qlogo.cn/mmopen/vi_32/RtwUHVBWSMjPlSmVlRh5eNiaXSLHHJiaMg7kFchHjoUibmvqk6OUB2B9NUs6t1hxAUVWEjf2oeXKeiaUskb6kkicOOw/132","nickname":"徐飞翔","note":"","ucode":"5253B355EEFB7A","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":1951924,"avatar":"http://thirdwx.qlogo.cn/mmopen/vi_32/1ornnGqSaTxRdbxhUHibeylvYngHvK64ebMaBso6vwXD9I3OEic75dZXxypvwfoCKeKutkpK2d7Xte8Gqh0UH4QA/132","nickname":"Geek_5d8f2f","note":"","ucode":"2836BC5634E64F","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":228920,"discussion_content":"可以加我一起学习Jenny50470503","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1586590229,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":223676,"ip_address":"","group_id":0},"score":228920,"extra":""}]},{"author":{"id":1917715,"avatar":"https://static001.geekbang.org/account/avatar/00/1d/43/13/649ccaa9.jpg","nickname":"海林Lin","note":"","ucode":"26333AE3DFAF9D","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":269128,"discussion_content":"遇到问题上网搜索下就解决了，反正总有报错需要处理的，这样也能锻炼动手处理能力","likes_number":2,"is_delete":false,"is_hidden":false,"ctime":1589869256,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1488280,"avatar":"https://static001.geekbang.org/account/avatar/00/16/b5/98/ffaf2aca.jpg","nickname":"Ronnyz","note":"","ucode":"9F34527B1D343D","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":30997,"discussion_content":"所有的print都加上（）基本就没问题了","likes_number":2,"is_delete":false,"is_hidden":false,"ctime":1570877375,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1370659,"avatar":"https://static001.geekbang.org/account/avatar/00/14/ea/23/508f71e3.jpg","nickname":"Jefitar","note":"","ucode":"D7ED9F32ADA5B1","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":24497,"discussion_content":"我用的3.7，也就一点点的差别，没问题啊","likes_number":2,"is_delete":false,"is_hidden":false,"ctime":1570159622,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1252206,"avatar":"https://static001.geekbang.org/account/avatar/00/13/1b/6e/cd8fea9f.jpg","nickname":"RecordLiu","note":"","ucode":"41178CC21337FB","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":548431,"discussion_content":"Python3和Python2语法差别不大，老师的例子Python3基本能跑，Python3中输出的写法为print()","likes_number":1,"is_delete":false,"is_hidden":false,"ctime":1643189783,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1525309,"avatar":"https://static001.geekbang.org/account/avatar/00/17/46/3d/55653953.jpg","nickname":"AI悦创","note":"","ucode":"D1007711CB0A79","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":302575,"discussion_content":"可以加我一起学习：Jiabcdefh，公众号：AI悦创","likes_number":1,"is_delete":false,"is_hidden":false,"ctime":1598964195,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1599519,"avatar":"","nickname":"爱吃的吃吃","note":"","ucode":"8D20209811E9F3","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":1901,"discussion_content":"+1\n","likes_number":1,"is_delete":false,"is_hidden":false,"ctime":1563075794,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1930025,"avatar":"","nickname":"雷","note":"","ucode":"9B173B575A7317","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":213149,"discussion_content":"我也用的3.7","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1585055769,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1546360,"avatar":"https://static001.geekbang.org/account/avatar/00/17/98/78/17953599.jpg","nickname":"张小艺","note":"","ucode":"85222658EA5D6F","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":50245,"discussion_content":"而且，就只是print加括号的区别","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1573696369,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1546360,"avatar":"https://static001.geekbang.org/account/avatar/00/17/98/78/17953599.jpg","nickname":"张小艺","note":"","ucode":"85222658EA5D6F","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":50244,"discussion_content":"哪怕是跟着老师学，也需要自己适应的","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1573696338,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1292302,"avatar":"https://static001.geekbang.org/account/avatar/00/13/b8/0e/795c1d59.jpg","nickname":"六天六夜六斤作业","note":"","ucode":"5A5DE3BD2732DC","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":3300,"discussion_content":"+1","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1564384965,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":"","group_id":0},"score":3,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1027194,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/ac/7a/4e794516.jpg","nickname":"上善问道","note":"","ucode":"F255CC6176E752","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":1267,"discussion_content":"支持\n","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1562488262,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":"","group_id":0},"score":3,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1591008,"avatar":"https://static001.geekbang.org/account/avatar/00/18/46/e0/20a20115.jpg","nickname":"libean","note":"","ucode":"F9332FAA3CFFEF","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":541,"discussion_content":"支持","likes_number":1,"is_delete":false,"is_hidden":false,"ctime":1561684015,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":"","group_id":0},"score":3,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":53197,"user_name":"求知鸟","can_delete":false,"product_type":"c1","uid":1309134,"ip_address":"","ucode":"76249BB4897629","user_header":"https://static001.geekbang.org/account/avatar/00/13/f9/ce/4985c6fc.jpg","comment_is_top":false,"comment_ctime":1545615037,"is_pvip":false,"replies":null,"discussion_count":1,"race_medal":0,"score":10,"product_id":100021701,"comment_content":"大家以后放代码时能不能写明自己的软件环境啊，方便交流啊","like_count":14,"discussions":[{"author":{"id":1252206,"avatar":"https://static001.geekbang.org/account/avatar/00/13/1b/6e/cd8fea9f.jpg","nickname":"RecordLiu","note":"","ucode":"41178CC21337FB","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":548433,"discussion_content":"Python写出的代码是一样的，跟软件环境没有关系","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1643190032,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":55709,"user_name":"tjcslx","can_delete":false,"product_type":"c1","uid":1060608,"ip_address":"","ucode":"F98FA363E88ECF","user_header":"https://static001.geekbang.org/account/avatar/00/10/2f/00/eaf03870.jpg","comment_is_top":false,"comment_ctime":1546265715,"is_pvip":false,"replies":null,"discussion_count":1,"race_medal":0,"score":10,"product_id":100021701,"comment_content":"#!&#47;usr&#47;bin&#47;env python\n# coding: utf-8\n# 使用Jupyter Notebook进行脚本编写\n\nimport pandas as pd\nimport numpy as np\nfrom pandas import DataFrame\nfrom pandasql import sqldf, load_meat, load_births\n\n# 创建数据集并进行数据清洗：清除重复的行；\n# 录入数值时，空值用None或np.nan；defaultValues为字段为空时的默认值，姓名字段默认为“无姓名”，成绩字段默认为0\n# 分别使用drop_duplicates和fillna方法进行去重复值及空值填充\ndata = {&#39;Name&#39;: [&#39;张飞&#39;, &#39;关羽&#39;, &#39;赵云&#39;, &#39;黄忠&#39;, &#39;典韦&#39;, &#39;典韦&#39;], &#39;Chinese&#39;: [66, 95, 95, 90, 80, 80], &#39;English&#39;: [65, 85, 92, 88, 90, 90], &#39;Maths&#39;: [None, 98, 96, 77, 90, 90]}\ndf = DataFrame(data, columns=[&#39;Name&#39;, &#39;Chinese&#39;, &#39;English&#39;, &#39;Maths&#39;])\ndefaultValues = {&#39;Name&#39;: &#39;无姓名&#39;, &#39;Chinese&#39;: 0, &#39;English&#39;: 0, &#39;Maths&#39;: 0}\ndf = df.drop_duplicates()\n# 按照默认值进行填充\ndf = df.fillna(defaultValues)\n# 使用其他学生的平均值对空值进行填充\n# df[&#39;Maths&#39;].fillna(df[&#39;Maths&#39;].mean(), inplace=True)\n\n# 使用Pandas SQL进行排序语句编写\npysqldf = lambda sql: sqldf(sql, globals())\nsql = &quot;select *, Chinese + English + Maths as Total from df order by Chinese + English + Maths desc&quot;\nprint(pysqldf(sql))","like_count":10,"discussions":[{"author":{"id":1483795,"avatar":"https://static001.geekbang.org/account/avatar/00/16/a4/13/85ee9f77.jpg","nickname":"王婷婷","note":"","ucode":"4438720A288B3A","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":319221,"discussion_content":"本地安装的python3，按照上述方法，总是报错no such table: df，实在差不到是什么原因，求大神指教\ndef students_pandas_sort():\n    df =DataFrame({&#39;Name&#39;: [&#39;张飞&#39;, &#39;关羽&#39;, &#39;赵云&#39;, &#39;黄忠&#39;, &#39;典韦&#39;, &#39;典韦&#39;], &#39;Chinese&#39;: [90, 95, 95, 90, 80, 80], &#39;English&#39;: [65, 85, 92, 88, 90, 90], &#39;Maths&#39;: [0, 98, 96, 77, 90, 90]})\n\n\n    print(&#34;去重&#34;)\n    df = df.drop_duplicates()\n    print(df)\n\n    print(&#34;排名&#34;)\n    pysqldf = lambda q: sqldf(q,globals())\n    q = &#34;&#34;&#34;select * from df&#34;&#34;&#34;\n    print(pysqldf(q))\n","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1603965715,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":56984,"user_name":"七彩星云","can_delete":false,"product_type":"c1","uid":1073654,"ip_address":"","ucode":"225B339A9FD42A","user_header":"https://static001.geekbang.org/account/avatar/00/10/61/f6/5e99c406.jpg","comment_is_top":false,"comment_ctime":1546592259,"is_pvip":false,"replies":null,"discussion_count":1,"race_medal":0,"score":10,"product_id":100021701,"comment_content":"df2[&#39;Chinese&#39;].astype(&#39;str&#39;) ＃这种写法貌似不行，如果是原始类型是int，再次map调用str.strip 方法的时候会出错，\n改成赋值形式就行了df2[&#39;Chinese&#39;] ＝df2[&#39;Chinese&#39;].astype(&#39;str&#39;) ","like_count":7,"discussions":[{"author":{"id":1521602,"avatar":"https://static001.geekbang.org/account/avatar/00/17/37/c2/8674db24.jpg","nickname":"一直都是小孩子","note":"","ucode":"832FBD7FBBE4E3","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":24487,"discussion_content":"我也遇到这个问题，确实得赋值才能完成类型的转换","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1570157040,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":53446,"user_name":"大萌","can_delete":false,"product_type":"c1","uid":1357028,"ip_address":"","ucode":"5E9EB5659230DE","user_header":"https://static001.geekbang.org/account/avatar/00/14/b4/e4/7c16516d.jpg","comment_is_top":false,"comment_ctime":1545645646,"is_pvip":false,"replies":null,"discussion_count":0,"race_medal":0,"score":10,"product_id":100021701,"comment_content":"Pandas最主要的两个数据结构：Series，DataFrame\nSeries提供：index,values,map\nDataFrame常用的函数：\n- describe()  统计性描述\n- drop_duplicates() 删除重复行\n- rename(columns=...) 更名\n- dropna()  删除具有空的行\n- isnull()  判断空值\n- fillna() 填充空值 \n- apply()  应用函数\n- merge() 合并df\n- value_counts() 统计某列的各类型个数\n- read_excel() to_excel() 读取和保存excel\n- set_index() 设置索引\n- cut 分组\n\n代码，工具jupyter notebook：\nimport pandas as pd\nfrom pandas import DataFrame,Series\nimport numpy as np\n\ngrades = {&#39;Chinese&#39;:[66,95,95,90,80,80],&#39;English&#39;:[65,85,92,88,90,90],&#39;Math&#39;:[np.nan,98,96,77,90,90]} #定义成绩字典\ndf1 = DataFrame(grades,index=[&#39;zhangfei&#39;,&#39;guanyu&#39;,&#39;zhaoyun&#39;,&#39;huangzhong&#39;,&#39;machao&#39;,&#39;machao&#39;]) #创建DataFrame\n\ndf1.describe()\ndf1.isnull().any() #查看哪一列有空值\n\ndf1.dropna(inplace=True) #去除空值\ndf1.drop_duplicates(inplace=True)  #去除重复值\ndf1.rename(columns={&#39;Chinese&#39;:&#39;YuWen&#39;,&#39;English&#39;:&#39;YingYu&#39;,&#39;Math&#39;:&#39;ShuXue&#39;},inplace=True) #更名\n\ndf1[&#39;ZongFen&#39;] = df1.YingYu+df1.YuWen+df1.ShuXue #计算总分\ndf1","like_count":6},{"had_liked":false,"id":246225,"user_name":"McKee Chen","can_delete":false,"product_type":"c1","uid":2037505,"ip_address":"","ucode":"F74B76542FAB65","user_header":"https://static001.geekbang.org/account/avatar/00/1f/17/01/1c5309a3.jpg","comment_is_top":false,"comment_ctime":1599213565,"is_pvip":false,"replies":null,"discussion_count":0,"race_medal":0,"score":10,"product_id":100021701,"comment_content":"我有翻阅评论的习惯，并且都读完。希望平台能对评论功能再做改进，增加筛选评论功能、评论分类功能等，这样方便看评论。","like_count":2},{"had_liked":false,"id":53455,"user_name":"Geek_zclap3","can_delete":false,"product_type":"c1","uid":1179158,"ip_address":"","ucode":"DB05C0F7D2C472","user_header":"https://static001.geekbang.org/account/avatar/00/11/fe/16/aac4d7f2.jpg","comment_is_top":false,"comment_ctime":1545648546,"is_pvip":false,"replies":[{"id":19401,"content":"👍写总结的同学，另外也可以把总结的文字贴过来","user_name":"作者回复","user_name_real":"cy","uid":1306094,"ctime":1545666399,"ip_address":"","comment_id":53455,"utype":1}],"discussion_count":1,"race_medal":0,"score":10,"product_id":100021701,"comment_content":"今日总结：\nhttps:&#47;&#47;mubu.com&#47;doc&#47;tfLtTByI50","like_count":0,"discussions":[{"author":{"id":1306094,"avatar":"https://static001.geekbang.org/account/avatar/00/13/ed/ee/c4779b67.jpg","nickname":"cy","note":"","ucode":"50D653399A31F6","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":434144,"discussion_content":"👍写总结的同学，另外也可以把总结的文字贴过来","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1545666399,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":53427,"user_name":"Hyperuniverse","can_delete":false,"product_type":"c1","uid":1352392,"ip_address":"","ucode":"5720D21D349E0A","user_header":"https://static001.geekbang.org/account/avatar/00/14/a2/c8/f8753e06.jpg","comment_is_top":false,"comment_ctime":1545641902,"is_pvip":false,"replies":[{"id":19402,"content":"是的 省去很多事 ","user_name":"作者回复","user_name_real":"cy","uid":1306094,"ctime":1545666442,"ip_address":"","comment_id":53427,"utype":1}],"discussion_count":1,"race_medal":0,"score":10,"product_id":100021701,"comment_content":"pandasql真的好用.","like_count":0,"discussions":[{"author":{"id":1306094,"avatar":"https://static001.geekbang.org/account/avatar/00/13/ed/ee/c4779b67.jpg","nickname":"cy","note":"","ucode":"50D653399A31F6","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":434144,"discussion_content":"👍写总结的同学，另外也可以把总结的文字贴过来","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1545666399,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":53268,"user_name":"frazer","can_delete":false,"product_type":"c1","uid":1194427,"ip_address":"","ucode":"36869573D98495","user_header":"https://static001.geekbang.org/account/avatar/00/12/39/bb/3dd9ef18.jpg","comment_is_top":false,"comment_ctime":1545620863,"is_pvip":false,"replies":[{"id":19411,"content":"其实也是一些细节操作，根本目标就是让数据更规整","user_name":"作者回复","user_name_real":"cy","uid":1306094,"ctime":1545667188,"ip_address":"","comment_id":53268,"utype":1}],"discussion_count":1,"race_medal":0,"score":10,"product_id":100021701,"comment_content":"这就是传说中的数据清洗，好高大上的概念\n","like_count":0,"discussions":[{"author":{"id":1306094,"avatar":"https://static001.geekbang.org/account/avatar/00/13/ed/ee/c4779b67.jpg","nickname":"cy","note":"","ucode":"50D653399A31F6","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":434136,"discussion_content":"是的 省去很多事 ","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1545666442,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":55049,"user_name":"自导自演","can_delete":false,"product_type":"c1","uid":1352180,"ip_address":"","ucode":"C497F01EABF944","user_header":"https://static001.geekbang.org/account/avatar/00/14/a1/f4/5e562863.jpg","comment_is_top":false,"comment_ctime":1546010257,"is_pvip":false,"replies":null,"discussion_count":15,"race_medal":0,"score":10,"product_id":100021701,"comment_content":"老师能换3.x版本的吗？一堆2.x问题一直卡着好难受。","like_count":114,"discussions":[{"author":{"id":1306094,"avatar":"https://static001.geekbang.org/account/avatar/00/13/ed/ee/c4779b67.jpg","nickname":"cy","note":"","ucode":"50D653399A31F6","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":434088,"discussion_content":"其实也是一些细节操作，根本目标就是让数据更规整","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1545667188,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":53447,"user_name":"大萌","can_delete":false,"product_type":"c1","uid":1357028,"ip_address":"","ucode":"5E9EB5659230DE","user_header":"https://static001.geekbang.org/account/avatar/00/14/b4/e4/7c16516d.jpg","comment_is_top":false,"comment_ctime":1545645749,"is_pvip":false,"replies":null,"discussion_count":5,"race_medal":0,"score":10,"product_id":100021701,"comment_content":"另外推荐一个链接：https:&#47;&#47;www.cnblogs.com&#47;nxld&#47;p&#47;6756492.html\n很实用，里面记载了许多python常使用的方法","like_count":37,"discussions":[{"author":{"id":2719093,"avatar":"https://static001.geekbang.org/account/avatar/00/29/7d/75/21263d0f.jpg","nickname":"Rachel","note":"","ucode":"F4DC012ABBCF6B","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":595932,"discussion_content":"谢谢啦","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1670481651,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":"四川","group_id":0},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":3073408,"avatar":"","nickname":"Geek_53e08e","note":"","ucode":"2CD84EF58A4488","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":584157,"discussion_content":"感谢分享！","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1660646223,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":"上海","group_id":0},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1044967,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/f1/e7/c055e0e9.jpg","nickname":"WZ","note":"","ucode":"2E87ED270A39EF","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":286963,"discussion_content":"感谢分享","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1593334311,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1315333,"avatar":"https://thirdwx.qlogo.cn/mmopen/vi_32/DYAIOgq83epu5XExe9UUhWmZFibk4Ce6nuGLEF8DhckNdibbegdVm7J5diaYg7XoQTIwAJicUyibrLbKKiaicPEicXx8Gg/132","nickname":"nikky","note":"","ucode":"67B1A126645EAA","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":241146,"discussion_content":"谢谢","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1587395260,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1506548,"avatar":"https://static001.geekbang.org/account/avatar/00/16/fc/f4/7e9dd5c3.jpg","nickname":"。。。","note":"","ucode":"79ABC7ABB81FE4","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":4225,"discussion_content":"可以呀，兄die，哈哈哈，还有别的资源吗","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1565238652,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":53197,"user_name":"求知鸟","can_delete":false,"product_type":"c1","uid":1309134,"ip_address":"","ucode":"76249BB4897629","user_header":"https://static001.geekbang.org/account/avatar/00/13/f9/ce/4985c6fc.jpg","comment_is_top":false,"comment_ctime":1545615037,"is_pvip":false,"replies":null,"discussion_count":1,"race_medal":0,"score":10,"product_id":100021701,"comment_content":"大家以后放代码时能不能写明自己的软件环境啊，方便交流啊","like_count":14,"discussions":[{"author":{"id":2719093,"avatar":"https://static001.geekbang.org/account/avatar/00/29/7d/75/21263d0f.jpg","nickname":"Rachel","note":"","ucode":"F4DC012ABBCF6B","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":595932,"discussion_content":"谢谢啦","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1670481651,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":"四川","group_id":0},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":3073408,"avatar":"","nickname":"Geek_53e08e","note":"","ucode":"2CD84EF58A4488","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":584157,"discussion_content":"感谢分享！","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1660646223,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":"上海","group_id":0},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1044967,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/f1/e7/c055e0e9.jpg","nickname":"WZ","note":"","ucode":"2E87ED270A39EF","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":286963,"discussion_content":"感谢分享","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1593334311,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1315333,"avatar":"https://thirdwx.qlogo.cn/mmopen/vi_32/DYAIOgq83epu5XExe9UUhWmZFibk4Ce6nuGLEF8DhckNdibbegdVm7J5diaYg7XoQTIwAJicUyibrLbKKiaicPEicXx8Gg/132","nickname":"nikky","note":"","ucode":"67B1A126645EAA","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":241146,"discussion_content":"谢谢","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1587395260,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1506548,"avatar":"https://static001.geekbang.org/account/avatar/00/16/fc/f4/7e9dd5c3.jpg","nickname":"。。。","note":"","ucode":"79ABC7ABB81FE4","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":4225,"discussion_content":"可以呀，兄die，哈哈哈，还有别的资源吗","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1565238652,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":55709,"user_name":"tjcslx","can_delete":false,"product_type":"c1","uid":1060608,"ip_address":"","ucode":"F98FA363E88ECF","user_header":"https://static001.geekbang.org/account/avatar/00/10/2f/00/eaf03870.jpg","comment_is_top":false,"comment_ctime":1546265715,"is_pvip":false,"replies":null,"discussion_count":1,"race_medal":0,"score":10,"product_id":100021701,"comment_content":"#!&#47;usr&#47;bin&#47;env python\n# coding: utf-8\n# 使用Jupyter Notebook进行脚本编写\n\nimport pandas as pd\nimport numpy as np\nfrom pandas import DataFrame\nfrom pandasql import sqldf, load_meat, load_births\n\n# 创建数据集并进行数据清洗：清除重复的行；\n# 录入数值时，空值用None或np.nan；defaultValues为字段为空时的默认值，姓名字段默认为“无姓名”，成绩字段默认为0\n# 分别使用drop_duplicates和fillna方法进行去重复值及空值填充\ndata = {&#39;Name&#39;: [&#39;张飞&#39;, &#39;关羽&#39;, &#39;赵云&#39;, &#39;黄忠&#39;, &#39;典韦&#39;, &#39;典韦&#39;], &#39;Chinese&#39;: [66, 95, 95, 90, 80, 80], &#39;English&#39;: [65, 85, 92, 88, 90, 90], &#39;Maths&#39;: [None, 98, 96, 77, 90, 90]}\ndf = DataFrame(data, columns=[&#39;Name&#39;, &#39;Chinese&#39;, &#39;English&#39;, &#39;Maths&#39;])\ndefaultValues = {&#39;Name&#39;: &#39;无姓名&#39;, &#39;Chinese&#39;: 0, &#39;English&#39;: 0, &#39;Maths&#39;: 0}\ndf = df.drop_duplicates()\n# 按照默认值进行填充\ndf = df.fillna(defaultValues)\n# 使用其他学生的平均值对空值进行填充\n# df[&#39;Maths&#39;].fillna(df[&#39;Maths&#39;].mean(), inplace=True)\n\n# 使用Pandas SQL进行排序语句编写\npysqldf = lambda sql: sqldf(sql, globals())\nsql = &quot;select *, Chinese + English + Maths as Total from df order by Chinese + English + Maths desc&quot;\nprint(pysqldf(sql))","like_count":10,"discussions":[{"author":{"id":1252206,"avatar":"https://static001.geekbang.org/account/avatar/00/13/1b/6e/cd8fea9f.jpg","nickname":"RecordLiu","note":"","ucode":"41178CC21337FB","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":548433,"discussion_content":"Python写出的代码是一样的，跟软件环境没有关系","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1643190032,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":56984,"user_name":"七彩星云","can_delete":false,"product_type":"c1","uid":1073654,"ip_address":"","ucode":"225B339A9FD42A","user_header":"https://static001.geekbang.org/account/avatar/00/10/61/f6/5e99c406.jpg","comment_is_top":false,"comment_ctime":1546592259,"is_pvip":false,"replies":null,"discussion_count":1,"race_medal":0,"score":10,"product_id":100021701,"comment_content":"df2[&#39;Chinese&#39;].astype(&#39;str&#39;) ＃这种写法貌似不行，如果是原始类型是int，再次map调用str.strip 方法的时候会出错，\n改成赋值形式就行了df2[&#39;Chinese&#39;] ＝df2[&#39;Chinese&#39;].astype(&#39;str&#39;) ","like_count":7,"discussions":[{"author":{"id":1483795,"avatar":"https://static001.geekbang.org/account/avatar/00/16/a4/13/85ee9f77.jpg","nickname":"王婷婷","note":"","ucode":"4438720A288B3A","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":319221,"discussion_content":"本地安装的python3，按照上述方法，总是报错no such table: df，实在差不到是什么原因，求大神指教\ndef students_pandas_sort():\n    df =DataFrame({&#39;Name&#39;: [&#39;张飞&#39;, &#39;关羽&#39;, &#39;赵云&#39;, &#39;黄忠&#39;, &#39;典韦&#39;, &#39;典韦&#39;], &#39;Chinese&#39;: [90, 95, 95, 90, 80, 80], &#39;English&#39;: [65, 85, 92, 88, 90, 90], &#39;Maths&#39;: [0, 98, 96, 77, 90, 90]})\n\n\n    print(&#34;去重&#34;)\n    df = df.drop_duplicates()\n    print(df)\n\n    print(&#34;排名&#34;)\n    pysqldf = lambda q: sqldf(q,globals())\n    q = &#34;&#34;&#34;select * from df&#34;&#34;&#34;\n    print(pysqldf(q))\n","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1603965715,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":53446,"user_name":"大萌","can_delete":false,"product_type":"c1","uid":1357028,"ip_address":"","ucode":"5E9EB5659230DE","user_header":"https://static001.geekbang.org/account/avatar/00/14/b4/e4/7c16516d.jpg","comment_is_top":false,"comment_ctime":1545645646,"is_pvip":false,"replies":null,"discussion_count":0,"race_medal":0,"score":10,"product_id":100021701,"comment_content":"Pandas最主要的两个数据结构：Series，DataFrame\nSeries提供：index,values,map\nDataFrame常用的函数：\n- describe()  统计性描述\n- drop_duplicates() 删除重复行\n- rename(columns=...) 更名\n- dropna()  删除具有空的行\n- isnull()  判断空值\n- fillna() 填充空值 \n- apply()  应用函数\n- merge() 合并df\n- value_counts() 统计某列的各类型个数\n- read_excel() to_excel() 读取和保存excel\n- set_index() 设置索引\n- cut 分组\n\n代码，工具jupyter notebook：\nimport pandas as pd\nfrom pandas import DataFrame,Series\nimport numpy as np\n\ngrades = {&#39;Chinese&#39;:[66,95,95,90,80,80],&#39;English&#39;:[65,85,92,88,90,90],&#39;Math&#39;:[np.nan,98,96,77,90,90]} #定义成绩字典\ndf1 = DataFrame(grades,index=[&#39;zhangfei&#39;,&#39;guanyu&#39;,&#39;zhaoyun&#39;,&#39;huangzhong&#39;,&#39;machao&#39;,&#39;machao&#39;]) #创建DataFrame\n\ndf1.describe()\ndf1.isnull().any() #查看哪一列有空值\n\ndf1.dropna(inplace=True) #去除空值\ndf1.drop_duplicates(inplace=True)  #去除重复值\ndf1.rename(columns={&#39;Chinese&#39;:&#39;YuWen&#39;,&#39;English&#39;:&#39;YingYu&#39;,&#39;Math&#39;:&#39;ShuXue&#39;},inplace=True) #更名\n\ndf1[&#39;ZongFen&#39;] = df1.YingYu+df1.YuWen+df1.ShuXue #计算总分\ndf1","like_count":6},{"had_liked":false,"id":246225,"user_name":"McKee Chen","can_delete":false,"product_type":"c1","uid":2037505,"ip_address":"","ucode":"F74B76542FAB65","user_header":"https://static001.geekbang.org/account/avatar/00/1f/17/01/1c5309a3.jpg","comment_is_top":false,"comment_ctime":1599213565,"is_pvip":false,"replies":null,"discussion_count":0,"race_medal":0,"score":10,"product_id":100021701,"comment_content":"我有翻阅评论的习惯，并且都读完。希望平台能对评论功能再做改进，增加筛选评论功能、评论分类功能等，这样方便看评论。","like_count":2,"discussions":[{"author":{"id":1521602,"avatar":"https://static001.geekbang.org/account/avatar/00/17/37/c2/8674db24.jpg","nickname":"一直都是小孩子","note":"","ucode":"832FBD7FBBE4E3","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":24487,"discussion_content":"我也遇到这个问题，确实得赋值才能完成类型的转换","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1570157040,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":53151,"user_name":"nrvna","can_delete":false,"product_type":"c1","uid":1352764,"ip_address":"","ucode":"05830A97EF354D","user_header":"https://static001.geekbang.org/account/avatar/00/14/a4/3c/6d0a0cc8.jpg","comment_is_top":false,"comment_ctime":1545612394,"is_pvip":false,"replies":null,"discussion_count":1,"race_medal":0,"score":11,"product_id":100021701,"comment_content":"import pandas as pd\n\ndata = {&#39;Chinese&#39;:[66,95,95,90,80,80],&#39;English&#39;:[65,85,92,88,90,90],&#39;Math&#39;:[None,98,96,77,90,90]}\ndf = pd.DataFrame(data, index=[&#39;ZhangFei&#39;, &#39;GuanYu&#39;, &#39;ZhaoYun&#39;, &#39;HuangZhong&#39;, &#39;DianWei&#39;, &#39;DianWei&#39;])\nprint(df)\n\n# Delete extra lines，Replace null with 0， Add new column for total\ndf = df.drop_duplicates()\ndf = df.where(df.notnull(),0)\n# None will change &#39;Math&#39; column to float, so that we need to clean it back.\n# [[]] is a DataFrame\ndf[[&#39;Math&#39;]] = df[[&#39;Math&#39;]].astype(int)\n\n&#39;&#39;&#39;\nMethod 1: Directly\n&#39;&#39;&#39;\n# df[&#39;Total&#39;] = df[&#39;Chinese&#39;] + df[&#39;English&#39;] + df[&#39;Math&#39;]\n# print(df)\n\n&#39;&#39;&#39;\nMethod 2: apply a function\n&#39;&#39;&#39;\ndef add_column(df):\n    df[&#39;Total&#39;] = df[&#39;Chinese&#39;] + df[&#39;English&#39;] + df[&#39;Math&#39;]\n    return df\ndf = df.apply(add_column,axis=1)\nprint(df)","like_count":2},{"had_liked":false,"id":332376,"user_name":"RecordLiu","can_delete":false,"product_type":"c1","uid":1252206,"ip_address":"","ucode":"41178CC21337FB","user_header":"https://static001.geekbang.org/account/avatar/00/13/1b/6e/cd8fea9f.jpg","comment_is_top":false,"comment_ctime":1643189660,"is_pvip":false,"replies":null,"discussion_count":1,"race_medal":0,"score":11,"product_id":100021701,"comment_content":"使用Python3实现：\n#!&#47;usr&#47;bin&#47;env python3\n# -*- coding: utf-8 -*-\nimport pandas as pd\nimport numpy as np\nfrom pandas import Series, DataFrame\n\n#初始化数据\ndata = {u&#39;语文&#39;:[66,95,95,90,80,80],u&#39;英语&#39;:[65,85,92,88,90,90],u&#39;数学&#39;:[None,98,96,77,90,90]} #空值用None进行表示\ndf = DataFrame(data,index=[u&#39;张飞&#39;,u&#39;关羽&#39;,u&#39;赵云&#39;,u&#39;黄忠&#39;,u&#39;典韦&#39;,u&#39;典韦&#39;],columns=[&#39;语文&#39;,&#39;英语&#39;,&#39;数学&#39;])\n\n#对数学列空值用0进行填充\ndf[&#39;数学&#39;] = df[&#39;数学&#39;].fillna(0)\n#删除重复行\ndf = df.drop_duplicates()\n\n#使用apply函数新增一个总和列\ndef add_total(df):\n\tdf[&#39;总和&#39;] = df[&#39;语文&#39;] + df[&#39;英语&#39;] + df[&#39;数学&#39;]\n\treturn df\ndf = df.apply(add_total,axis=1)\t\n\nprint(df)","like_count":1,"discussions":[{"author":{"id":1351434,"avatar":"https://static001.geekbang.org/account/avatar/00/14/9f/0a/611030c3.jpg","nickname":"同心飞翔","note":"","ucode":"01EE03B0DF81EF","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":368301,"discussion_content":"# 删除左右空格\na = &#39; 123$ &#39;\nb = &#39; 1234$ &#39;\nc = &#39;1234$&#39;\nprint(a)\nprint(a.strip())\nprint(a.lstrip())\nprint(a.rstrip())\nprint(b.strip(&#39;$&#39;))\nprint(c.strip(&#39;$&#39;))\n\n 123$ \n123$\n123$ \n 123$\n 1234$ \n1234\n我发现前后有空格，去除特殊字符就不行。。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1618648988,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":299408,"user_name":"李闯","can_delete":false,"product_type":"c1","uid":2639036,"ip_address":"","ucode":"39E65036A83581","user_header":"https://static001.geekbang.org/account/avatar/00/28/44/bc/c71a044e.jpg","comment_is_top":false,"comment_ctime":1624612935,"is_pvip":false,"replies":null,"discussion_count":0,"race_medal":0,"score":11,"product_id":100021701,"comment_content":"# 作业\n&#39;&#39;&#39;\n对于下表的数据，请使用 Pandas 中的 DataFrame 进行创建，并对数据进行清洗。同时新增一列“总和”计算每个人的三科成绩之和。\n&#39;&#39;&#39;\nimport pandas as pd\n\ndata = {&#39;Chinese&#39;: [66, 95, 93, 90, 80, 80], &#39;English&#39;: [65, 85, 92, 88, 90, 90],\n        &#39;Math&#39;: [None, 98, 96, 77, 90, 90]}\ndf = pd.DataFrame(data, index=[&#39;张飞&#39;, &#39;关羽&#39;, &#39;赵云&#39;, &#39;黄忠&#39;, &#39;典韦&#39;, &#39;典韦&#39;],\n                  columns=[&#39;English&#39;, &#39;Math&#39;, &#39;Chinese&#39;])\n\ndf = df.drop_duplicates()\nprint(df.isnull().any())\ncol = []\nfor i in df.isnull().any().index:\n    if df.isnull().any()[i] == True:\n        col.append(i)\n\nfor i in col:\n    df[i] = df[i].fillna(df[i].mean())\n    df[i] = df[i].astype(&#39;int64&#39;)\ndf[&#39;total&#39;] = df.sum(axis=1)\nprint(df)","like_count":1},{"had_liked":false,"id":102530,"user_name":"DDBG","can_delete":false,"product_type":"c1","uid":1254896,"ip_address":"","ucode":"47907B25713E00","user_header":"https://static001.geekbang.org/account/avatar/00/13/25/f0/c4a77516.jpg","comment_is_top":false,"comment_ctime":1560244925,"is_pvip":false,"replies":null,"discussion_count":0,"race_medal":0,"score":11,"product_id":100021701,"comment_content":"老师我想问一下，假如我查找到了一个空值，怎么利用函数，然后利用apply把空值删除，或者重新赋值","like_count":1},{"had_liked":false,"id":53546,"user_name":"自然","can_delete":false,"product_type":"c1","uid":1071508,"ip_address":"","ucode":"BE7B107039BCCA","user_header":"https://static001.geekbang.org/account/avatar/00/10/59/94/b94b5995.jpg","comment_is_top":false,"comment_ctime":1545667801,"is_pvip":false,"replies":null,"discussion_count":0,"race_medal":0,"score":11,"product_id":100021701,"comment_content":"def sum(df):\n    df[u&#39;总和&#39;] = (df[u&#39;语文&#39;]+df[u&#39;英语&#39;]+ df[u&#39;数学&#39;]) \n    return df\ndf1 = df1.apply(sum, axis=1)","like_count":1},{"had_liked":false,"id":53319,"user_name":"是我的海","can_delete":false,"product_type":"c1","uid":1353653,"ip_address":"","ucode":"38323EB899A210","user_header":"","comment_is_top":false,"comment_ctime":1545626015,"is_pvip":false,"replies":null,"discussion_count":0,"race_medal":0,"score":11,"product_id":100021701,"comment_content":"import pandas as pd\nfrom pandas import  Series,DataFrame\ndata={&#39;语文&#39;:[66,95,95,90,80,80],&#39;英语&#39;:[65,85,92,88,90,90],&#39;数学&#39;:[None,98,96,77,90,90]}\ndf=DataFrame(data,index=[&#39;张飞&#39;,&#39;关羽&#39;,&#39;赵云&#39;,&#39;黄忠&#39;,&#39;典韦&#39;,&#39;典韦&#39;],columns=[&#39;语文&#39;,&#39;英语&#39;,&#39;数学&#39;])\ndf=df.drop_duplicates()\ndf=df.fillna(0)\ndef plus(df):\n    df[&#39;成绩综合&#39;]=df[u&#39;语文&#39;]+df[u&#39;英语&#39;]+df[u&#39;数学&#39;]\n    return df\ndf=df.apply(plus,axis=1)\nprint(df)\n\n额，感觉我的代码好简单。关于数学那个空值的处理，我感觉有很多种方法，这里用了最简单的一种。","like_count":1},{"had_liked":false,"id":393476,"user_name":"莫扎特","can_delete":false,"product_type":"c1","uid":3824954,"ip_address":"上海","ucode":"D642BCAE66C960","user_header":"https://static001.geekbang.org/account/avatar/00/3a/5d/3a/a4abb3ab.jpg","comment_is_top":false,"comment_ctime":1723975062,"is_pvip":false,"replies":null,"discussion_count":0,"race_medal":0,"score":11,"product_id":100021701,"comment_content":"```python\nimport numpy as np\nimport pandas as pd\nfrom pandas import Series,DataFrame\n```\n\n\n```python\n# 创建DataFrame（输入数据）\ndf=DataFrame(data={&#39;姓名&#39;:[&#39;张飞&#39;,&#39;关羽&#39;,&#39;赵云&#39;,&#39;黄忠&#39;,&#39;典韦&#39;,&#39;典韦&#39;],&#39;语文&#39;:[66,95,95,90,80,80],&#39;英语&#39;:[65,85,92,88,90,90],&#39;数学&#39;:[np.nan,98,96,77,90,90]},index=[0,1,2,3,4,5],columns=[&#39;姓名&#39;,&#39;语文&#39;,&#39;数学&#39;,&#39;英语&#39;])\nprint(df)\n```\n\n       姓名  语文    数学  英语\n    0  张飞  66   NaN  65\n    1  关羽  95  98.0  85\n    2  赵云  95  96.0  92\n    3  黄忠  90  77.0  88\n    4  典韦  80  90.0  90\n    5  典韦  80  90.0  90\n\n\n\n```python\n# 数据清洗（缺失值处理，重复值处理）\n## 重复值处理\ndf=df.drop_duplicates()\nprint(df)\n\n## 缺失值处理\ndf.isnull()\ndf=df.fillna(df.mean(numeric_only=True)) #将缺失值取平均值\nprint(df)\n```\n\n       姓名  语文    数学  英语\n    0  张飞  66   NaN  65\n    1  关羽  95  98.0  85\n    2  赵云  95  96.0  92\n    3  黄忠  90  77.0  88\n    4  典韦  80  90.0  90\n       姓名  语文     数学  英语\n    0  张飞  66  90.25  65\n    1  关羽  95  98.00  85\n    2  赵云  95  96.00  92\n    3  黄忠  90  77.00  88\n    4  典韦  80  90.00  90\n\n\n\n```python\n# 新增“总分”列\ndef df_sum(df):\n    df[&#39;总分&#39;]=df[&#39;语文&#39;]+df[&#39;数学&#39;]+df[&#39;英语&#39;]\n    return df\ndf=df.apply(df_sum,axis=1)\nprint(df)\n```\n\n       姓名  语文     数学  英语      总分\n    0  张飞  66  90.25  65  221.25\n    1  关羽  95  98.00  85  278.00\n    2  赵云  95  96.00  92  283.00\n    3  黄忠  90  77.00  88  255.00\n    4  典韦  80  90.00  90  260.00\n\n","like_count":0},{"had_liked":false,"id":392108,"user_name":"伊贺","can_delete":false,"product_type":"c1","uid":1044870,"ip_address":"山西","ucode":"610C041F19CF40","user_header":"https://static001.geekbang.org/account/avatar/00/0f/f1/86/2c65933d.jpg","comment_is_top":false,"comment_ctime":1719984936,"is_pvip":false,"replies":null,"discussion_count":0,"race_medal":0,"score":11,"product_id":100021701,"comment_content":"https:&#47;&#47;code.juejin.cn&#47;pen&#47;7387277224552235048\n\nimport pandas as pd\nfrom pandas import DataFrame\n\ndash_line = &#39;=&#39; * 40\n\ndata = [\n    [&#39;ZhangFei&#39;, 66, 65],\n    [&#39;GuanYv&#39;, 95, 85, 98],\n    [&#39;ZhaoYun&#39;, 95, 92, 96],\n    [&#39;HuangZhong&#39;, 90, 88, 77],\n    [&#39;DianWei&#39;, 80, 90, 90],\n    [&#39;DianWei&#39;, 80, 90, 90],\n]\n\ndf = pd.DataFrame(data, columns=[&#39;name&#39;, &#39;language&#39;, &#39;english&#39;, &#39;math&#39;])\n\nprint(df)\n\ndfuni = df.drop_duplicates()\ndfuni = dfuni.fillna(0)\nprint(dash_line)\nprint(dfuni)\n\ndef plus(df):\n    df[&#39;sum&#39;] = 0\n    for s in df.iloc[1:-1]:\n        df[&#39;sum&#39;] += s\n    return df\n\ndfsum = dfuni.apply(plus, axis=1)\n\nprint(dash_line)\nprint(dfsum)\n\n         name  language  english  math\n0    ZhangFei        66       65   NaN\n1      GuanYv        95       85  98.0\n2     ZhaoYun        95       92  96.0\n3  HuangZhong        90       88  77.0\n4     DianWei        80       90  90.0\n5     DianWei        80       90  90.0\n========================================\n         name  language  english  math\n0    ZhangFei        66       65   0.0\n1      GuanYv        95       85  98.0\n2     ZhaoYun        95       92  96.0\n3  HuangZhong        90       88  77.0\n4     DianWei        80       90  90.0\n========================================\n         name  language  english  math    sum\n0    ZhangFei        66       65   0.0  131.0\n1      GuanYv        95       85  98.0  278.0\n2     ZhaoYun        95       92  96.0  283.0\n3  HuangZhong        90       88  77.0  255.0\n4     DianWei        80       90  90.0  260.0","like_count":0},{"had_liked":false,"id":387412,"user_name":"小叶同学","can_delete":false,"product_type":"c1","uid":2719194,"ip_address":"北京","ucode":"20603647E99E9B","user_header":"https://static001.geekbang.org/account/avatar/00/29/7d/da/2fde9f86.jpg","comment_is_top":false,"comment_ctime":1707207484,"is_pvip":false,"replies":null,"discussion_count":0,"race_medal":0,"score":11,"product_id":100021701,"comment_content":"import pandas as pd\nfrom pandas import DataFrame\ndata = {&#39;语文&#39;:[66,95,95,90,80,80],&#39;英语&#39;:[65,85,92,88,90,90],&#39;数学&#39;:[None,98,96,77,90,90]}\ndf1 =  DataFrame(data,index=[&#39;张飞&#39;,&#39;关羽&#39;,&#39;赵云&#39;,&#39;黄忠&#39;,&#39;典韦&#39;,&#39;典韦&#39;])\ndef sumScore(df):\n    df[&#39;总和&#39;] = df[&#39;语文&#39;] + df[&#39;数学&#39;] + df[&#39;英语&#39;]\n    return df\ndf1.fillna(0, inplace=True)\ndf1.astype(int)\ndf1 = df1.apply(sumScore,axis=1)\ndf1 = df1.drop_duplicates()\nprint(df1)","like_count":0},{"had_liked":false,"id":386833,"user_name":"GkTian","can_delete":false,"product_type":"c1","uid":1415305,"ip_address":"辽宁","ucode":"05B11A512A8892","user_header":"https://static001.geekbang.org/account/avatar/00/15/98/89/ca8fa978.jpg","comment_is_top":false,"comment_ctime":1705648972,"is_pvip":false,"replies":null,"discussion_count":0,"race_medal":0,"score":11,"product_id":100021701,"comment_content":"文中代码\ndef plus(df,n,m):\n    df[&#39;new1&#39;] = (df[u&#39;语文&#39;]+df[u&#39;英语&#39;]) * m\n    df[&#39;new2&#39;] = (df[u&#39;语文&#39;]+df[u&#39;英语&#39;]) * n\n    return df\ndf1 = df1.apply(plus,axis=1,args=(2,3,))\n其中 plus 参数 df 有误导性， 应该改名为 row","like_count":0,"discussions":[{"author":{"id":2601508,"avatar":"https://static001.geekbang.org/account/avatar/00/27/b2/24/3b1d2755.jpg","nickname":"Geek_b8d28c","note":"","ucode":"CA4E525295A91E","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":550056,"discussion_content":"你好~想请问一下u在这里是起到什么作用呀","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1644372733,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":53151,"user_name":"nrvna","can_delete":false,"product_type":"c1","uid":1352764,"ip_address":"","ucode":"05830A97EF354D","user_header":"https://static001.geekbang.org/account/avatar/00/14/a4/3c/6d0a0cc8.jpg","comment_is_top":false,"comment_ctime":1545612394,"is_pvip":false,"replies":null,"discussion_count":1,"race_medal":0,"score":11,"product_id":100021701,"comment_content":"import pandas as pd\n\ndata = {&#39;Chinese&#39;:[66,95,95,90,80,80],&#39;English&#39;:[65,85,92,88,90,90],&#39;Math&#39;:[None,98,96,77,90,90]}\ndf = pd.DataFrame(data, index=[&#39;ZhangFei&#39;, &#39;GuanYu&#39;, &#39;ZhaoYun&#39;, &#39;HuangZhong&#39;, &#39;DianWei&#39;, &#39;DianWei&#39;])\nprint(df)\n\n# Delete extra lines，Replace null with 0， Add new column for total\ndf = df.drop_duplicates()\ndf = df.where(df.notnull(),0)\n# None will change &#39;Math&#39; column to float, so that we need to clean it back.\n# [[]] is a DataFrame\ndf[[&#39;Math&#39;]] = df[[&#39;Math&#39;]].astype(int)\n\n&#39;&#39;&#39;\nMethod 1: Directly\n&#39;&#39;&#39;\n# df[&#39;Total&#39;] = df[&#39;Chinese&#39;] + df[&#39;English&#39;] + df[&#39;Math&#39;]\n# print(df)\n\n&#39;&#39;&#39;\nMethod 2: apply a function\n&#39;&#39;&#39;\ndef add_column(df):\n    df[&#39;Total&#39;] = df[&#39;Chinese&#39;] + df[&#39;English&#39;] + df[&#39;Math&#39;]\n    return df\ndf = df.apply(add_column,axis=1)\nprint(df)","like_count":2,"discussions":[{"author":{"id":1351434,"avatar":"https://static001.geekbang.org/account/avatar/00/14/9f/0a/611030c3.jpg","nickname":"同心飞翔","note":"","ucode":"01EE03B0DF81EF","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":368301,"discussion_content":"# 删除左右空格\na = &#39; 123$ &#39;\nb = &#39; 1234$ &#39;\nc = &#39;1234$&#39;\nprint(a)\nprint(a.strip())\nprint(a.lstrip())\nprint(a.rstrip())\nprint(b.strip(&#39;$&#39;))\nprint(c.strip(&#39;$&#39;))\n\n 123$ \n123$\n123$ \n 123$\n 1234$ \n1234\n我发现前后有空格，去除特殊字符就不行。。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1618648988,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":332376,"user_name":"RecordLiu","can_delete":false,"product_type":"c1","uid":1252206,"ip_address":"","ucode":"41178CC21337FB","user_header":"https://static001.geekbang.org/account/avatar/00/13/1b/6e/cd8fea9f.jpg","comment_is_top":false,"comment_ctime":1643189660,"is_pvip":false,"replies":null,"discussion_count":1,"race_medal":0,"score":11,"product_id":100021701,"comment_content":"使用Python3实现：\n#!&#47;usr&#47;bin&#47;env python3\n# -*- coding: utf-8 -*-\nimport pandas as pd\nimport numpy as np\nfrom pandas import Series, DataFrame\n\n#初始化数据\ndata = {u&#39;语文&#39;:[66,95,95,90,80,80],u&#39;英语&#39;:[65,85,92,88,90,90],u&#39;数学&#39;:[None,98,96,77,90,90]} #空值用None进行表示\ndf = DataFrame(data,index=[u&#39;张飞&#39;,u&#39;关羽&#39;,u&#39;赵云&#39;,u&#39;黄忠&#39;,u&#39;典韦&#39;,u&#39;典韦&#39;],columns=[&#39;语文&#39;,&#39;英语&#39;,&#39;数学&#39;])\n\n#对数学列空值用0进行填充\ndf[&#39;数学&#39;] = df[&#39;数学&#39;].fillna(0)\n#删除重复行\ndf = df.drop_duplicates()\n\n#使用apply函数新增一个总和列\ndef add_total(df):\n\tdf[&#39;总和&#39;] = df[&#39;语文&#39;] + df[&#39;英语&#39;] + df[&#39;数学&#39;]\n\treturn df\ndf = df.apply(add_total,axis=1)\t\n\nprint(df)","like_count":1,"discussions":[{"author":{"id":2601508,"avatar":"https://static001.geekbang.org/account/avatar/00/27/b2/24/3b1d2755.jpg","nickname":"Geek_b8d28c","note":"","ucode":"CA4E525295A91E","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":550056,"discussion_content":"你好~想请问一下u在这里是起到什么作用呀","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1644372733,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":299408,"user_name":"李闯","can_delete":false,"product_type":"c1","uid":2639036,"ip_address":"","ucode":"39E65036A83581","user_header":"https://static001.geekbang.org/account/avatar/00/28/44/bc/c71a044e.jpg","comment_is_top":false,"comment_ctime":1624612935,"is_pvip":false,"replies":null,"discussion_count":0,"race_medal":0,"score":11,"product_id":100021701,"comment_content":"# 作业\n&#39;&#39;&#39;\n对于下表的数据，请使用 Pandas 中的 DataFrame 进行创建，并对数据进行清洗。同时新增一列“总和”计算每个人的三科成绩之和。\n&#39;&#39;&#39;\nimport pandas as pd\n\ndata = {&#39;Chinese&#39;: [66, 95, 93, 90, 80, 80], &#39;English&#39;: [65, 85, 92, 88, 90, 90],\n        &#39;Math&#39;: [None, 98, 96, 77, 90, 90]}\ndf = pd.DataFrame(data, index=[&#39;张飞&#39;, &#39;关羽&#39;, &#39;赵云&#39;, &#39;黄忠&#39;, &#39;典韦&#39;, &#39;典韦&#39;],\n                  columns=[&#39;English&#39;, &#39;Math&#39;, &#39;Chinese&#39;])\n\ndf = df.drop_duplicates()\nprint(df.isnull().any())\ncol = []\nfor i in df.isnull().any().index:\n    if df.isnull().any()[i] == True:\n        col.append(i)\n\nfor i in col:\n    df[i] = df[i].fillna(df[i].mean())\n    df[i] = df[i].astype(&#39;int64&#39;)\ndf[&#39;total&#39;] = df.sum(axis=1)\nprint(df)","like_count":1},{"had_liked":false,"id":102530,"user_name":"DDBG","can_delete":false,"product_type":"c1","uid":1254896,"ip_address":"","ucode":"47907B25713E00","user_header":"https://static001.geekbang.org/account/avatar/00/13/25/f0/c4a77516.jpg","comment_is_top":false,"comment_ctime":1560244925,"is_pvip":false,"replies":null,"discussion_count":0,"race_medal":0,"score":11,"product_id":100021701,"comment_content":"老师我想问一下，假如我查找到了一个空值，怎么利用函数，然后利用apply把空值删除，或者重新赋值","like_count":1},{"had_liked":false,"id":53546,"user_name":"自然","can_delete":false,"product_type":"c1","uid":1071508,"ip_address":"","ucode":"BE7B107039BCCA","user_header":"https://static001.geekbang.org/account/avatar/00/10/59/94/b94b5995.jpg","comment_is_top":false,"comment_ctime":1545667801,"is_pvip":false,"replies":null,"discussion_count":0,"race_medal":0,"score":11,"product_id":100021701,"comment_content":"def sum(df):\n    df[u&#39;总和&#39;] = (df[u&#39;语文&#39;]+df[u&#39;英语&#39;]+ df[u&#39;数学&#39;]) \n    return df\ndf1 = df1.apply(sum, axis=1)","like_count":1},{"had_liked":false,"id":53319,"user_name":"是我的海","can_delete":false,"product_type":"c1","uid":1353653,"ip_address":"","ucode":"38323EB899A210","user_header":"","comment_is_top":false,"comment_ctime":1545626015,"is_pvip":false,"replies":null,"discussion_count":0,"race_medal":0,"score":11,"product_id":100021701,"comment_content":"import pandas as pd\nfrom pandas import  Series,DataFrame\ndata={&#39;语文&#39;:[66,95,95,90,80,80],&#39;英语&#39;:[65,85,92,88,90,90],&#39;数学&#39;:[None,98,96,77,90,90]}\ndf=DataFrame(data,index=[&#39;张飞&#39;,&#39;关羽&#39;,&#39;赵云&#39;,&#39;黄忠&#39;,&#39;典韦&#39;,&#39;典韦&#39;],columns=[&#39;语文&#39;,&#39;英语&#39;,&#39;数学&#39;])\ndf=df.drop_duplicates()\ndf=df.fillna(0)\ndef plus(df):\n    df[&#39;成绩综合&#39;]=df[u&#39;语文&#39;]+df[u&#39;英语&#39;]+df[u&#39;数学&#39;]\n    return df\ndf=df.apply(plus,axis=1)\nprint(df)\n\n额，感觉我的代码好简单。关于数学那个空值的处理，我感觉有很多种方法，这里用了最简单的一种。","like_count":1},{"had_liked":false,"id":393476,"user_name":"莫扎特","can_delete":false,"product_type":"c1","uid":3824954,"ip_address":"上海","ucode":"D642BCAE66C960","user_header":"https://static001.geekbang.org/account/avatar/00/3a/5d/3a/a4abb3ab.jpg","comment_is_top":false,"comment_ctime":1723975062,"is_pvip":false,"replies":null,"discussion_count":0,"race_medal":0,"score":11,"product_id":100021701,"comment_content":"```python\nimport numpy as np\nimport pandas as pd\nfrom pandas import Series,DataFrame\n```\n\n\n```python\n# 创建DataFrame（输入数据）\ndf=DataFrame(data={&#39;姓名&#39;:[&#39;张飞&#39;,&#39;关羽&#39;,&#39;赵云&#39;,&#39;黄忠&#39;,&#39;典韦&#39;,&#39;典韦&#39;],&#39;语文&#39;:[66,95,95,90,80,80],&#39;英语&#39;:[65,85,92,88,90,90],&#39;数学&#39;:[np.nan,98,96,77,90,90]},index=[0,1,2,3,4,5],columns=[&#39;姓名&#39;,&#39;语文&#39;,&#39;数学&#39;,&#39;英语&#39;])\nprint(df)\n```\n\n       姓名  语文    数学  英语\n    0  张飞  66   NaN  65\n    1  关羽  95  98.0  85\n    2  赵云  95  96.0  92\n    3  黄忠  90  77.0  88\n    4  典韦  80  90.0  90\n    5  典韦  80  90.0  90\n\n\n\n```python\n# 数据清洗（缺失值处理，重复值处理）\n## 重复值处理\ndf=df.drop_duplicates()\nprint(df)\n\n## 缺失值处理\ndf.isnull()\ndf=df.fillna(df.mean(numeric_only=True)) #将缺失值取平均值\nprint(df)\n```\n\n       姓名  语文    数学  英语\n    0  张飞  66   NaN  65\n    1  关羽  95  98.0  85\n    2  赵云  95  96.0  92\n    3  黄忠  90  77.0  88\n    4  典韦  80  90.0  90\n       姓名  语文     数学  英语\n    0  张飞  66  90.25  65\n    1  关羽  95  98.00  85\n    2  赵云  95  96.00  92\n    3  黄忠  90  77.00  88\n    4  典韦  80  90.00  90\n\n\n\n```python\n# 新增“总分”列\ndef df_sum(df):\n    df[&#39;总分&#39;]=df[&#39;语文&#39;]+df[&#39;数学&#39;]+df[&#39;英语&#39;]\n    return df\ndf=df.apply(df_sum,axis=1)\nprint(df)\n```\n\n       姓名  语文     数学  英语      总分\n    0  张飞  66  90.25  65  221.25\n    1  关羽  95  98.00  85  278.00\n    2  赵云  95  96.00  92  283.00\n    3  黄忠  90  77.00  88  255.00\n    4  典韦  80  90.00  90  260.00\n\n","like_count":0},{"had_liked":false,"id":392108,"user_name":"伊贺","can_delete":false,"product_type":"c1","uid":1044870,"ip_address":"山西","ucode":"610C041F19CF40","user_header":"https://static001.geekbang.org/account/avatar/00/0f/f1/86/2c65933d.jpg","comment_is_top":false,"comment_ctime":1719984936,"is_pvip":false,"replies":null,"discussion_count":0,"race_medal":0,"score":11,"product_id":100021701,"comment_content":"https:&#47;&#47;code.juejin.cn&#47;pen&#47;7387277224552235048\n\nimport pandas as pd\nfrom pandas import DataFrame\n\ndash_line = &#39;=&#39; * 40\n\ndata = [\n    [&#39;ZhangFei&#39;, 66, 65],\n    [&#39;GuanYv&#39;, 95, 85, 98],\n    [&#39;ZhaoYun&#39;, 95, 92, 96],\n    [&#39;HuangZhong&#39;, 90, 88, 77],\n    [&#39;DianWei&#39;, 80, 90, 90],\n    [&#39;DianWei&#39;, 80, 90, 90],\n]\n\ndf = pd.DataFrame(data, columns=[&#39;name&#39;, &#39;language&#39;, &#39;english&#39;, &#39;math&#39;])\n\nprint(df)\n\ndfuni = df.drop_duplicates()\ndfuni = dfuni.fillna(0)\nprint(dash_line)\nprint(dfuni)\n\ndef plus(df):\n    df[&#39;sum&#39;] = 0\n    for s in df.iloc[1:-1]:\n        df[&#39;sum&#39;] += s\n    return df\n\ndfsum = dfuni.apply(plus, axis=1)\n\nprint(dash_line)\nprint(dfsum)\n\n         name  language  english  math\n0    ZhangFei        66       65   NaN\n1      GuanYv        95       85  98.0\n2     ZhaoYun        95       92  96.0\n3  HuangZhong        90       88  77.0\n4     DianWei        80       90  90.0\n5     DianWei        80       90  90.0\n========================================\n         name  language  english  math\n0    ZhangFei        66       65   0.0\n1      GuanYv        95       85  98.0\n2     ZhaoYun        95       92  96.0\n3  HuangZhong        90       88  77.0\n4     DianWei        80       90  90.0\n========================================\n         name  language  english  math    sum\n0    ZhangFei        66       65   0.0  131.0\n1      GuanYv        95       85  98.0  278.0\n2     ZhaoYun        95       92  96.0  283.0\n3  HuangZhong        90       88  77.0  255.0\n4     DianWei        80       90  90.0  260.0","like_count":0},{"had_liked":false,"id":387412,"user_name":"小叶同学","can_delete":false,"product_type":"c1","uid":2719194,"ip_address":"北京","ucode":"20603647E99E9B","user_header":"https://static001.geekbang.org/account/avatar/00/29/7d/da/2fde9f86.jpg","comment_is_top":false,"comment_ctime":1707207484,"is_pvip":false,"replies":null,"discussion_count":0,"race_medal":0,"score":11,"product_id":100021701,"comment_content":"import pandas as pd\nfrom pandas import DataFrame\ndata = {&#39;语文&#39;:[66,95,95,90,80,80],&#39;英语&#39;:[65,85,92,88,90,90],&#39;数学&#39;:[None,98,96,77,90,90]}\ndf1 =  DataFrame(data,index=[&#39;张飞&#39;,&#39;关羽&#39;,&#39;赵云&#39;,&#39;黄忠&#39;,&#39;典韦&#39;,&#39;典韦&#39;])\ndef sumScore(df):\n    df[&#39;总和&#39;] = df[&#39;语文&#39;] + df[&#39;数学&#39;] + df[&#39;英语&#39;]\n    return df\ndf1.fillna(0, inplace=True)\ndf1.astype(int)\ndf1 = df1.apply(sumScore,axis=1)\ndf1 = df1.drop_duplicates()\nprint(df1)","like_count":0},{"had_liked":false,"id":386833,"user_name":"GkTian","can_delete":false,"product_type":"c1","uid":1415305,"ip_address":"辽宁","ucode":"05B11A512A8892","user_header":"https://static001.geekbang.org/account/avatar/00/15/98/89/ca8fa978.jpg","comment_is_top":false,"comment_ctime":1705648972,"is_pvip":false,"replies":null,"discussion_count":0,"race_medal":0,"score":11,"product_id":100021701,"comment_content":"文中代码\ndef plus(df,n,m):\n    df[&#39;new1&#39;] = (df[u&#39;语文&#39;]+df[u&#39;英语&#39;]) * m\n    df[&#39;new2&#39;] = (df[u&#39;语文&#39;]+df[u&#39;英语&#39;]) * n\n    return df\ndf1 = df1.apply(plus,axis=1,args=(2,3,))\n其中 plus 参数 df 有误导性， 应该改名为 row","like_count":0},{"had_liked":false,"id":368801,"user_name":"唐明响","can_delete":false,"product_type":"c1","uid":1692093,"ip_address":"广东","ucode":"1343FD7A9E7DCC","user_header":"https://static001.geekbang.org/account/avatar/00/19/d1/bd/a3a74304.jpg","comment_is_top":false,"comment_ctime":1676728598,"is_pvip":false,"replies":null,"discussion_count":0,"race_medal":0,"score":12,"product_id":100021701,"comment_content":"pandasql 执行的时候报错：\nTraceback (most recent call last):\n  File &quot;D:\\PycharmProjects\\python1014\\venv\\lib\\site-packages\\sqlalchemy\\engine\\base.py&quot;, line 1410, in execute\n    meth = statement._execute_on_connection\nAttributeError: &#39;str&#39; object has no attribute &#39;_execute_on_connection&#39;","like_count":0},{"had_liked":false,"id":359357,"user_name":"刘慧慧","can_delete":false,"product_type":"c1","uid":1475203,"ip_address":"上海","ucode":"67D6D0B7A97D06","user_header":"http://thirdwx.qlogo.cn/mmopen/vi_32/DYAIOgq83epNx7CCsqNO0qiavCXp2AQEU7ZIpL8aNpRr7ypmKPrf5MOia5rV5ibTLKrlMQxiafPoRLicOvfSicwukIbw/132","comment_is_top":false,"comment_ctime":1665470509,"is_pvip":false,"replies":null,"discussion_count":0,"race_medal":0,"score":12,"product_id":100021701,"comment_content":"有没有遇到通过Workbook写入的xls文件，再通过pd.read_excel读取的时候会报不支持xlsx？文件后缀确实是xls,但是如果把这个文件重新另存为一份又可以读取，网上找了很多原因都没有解决。","like_count":0},{"had_liked":false,"id":358243,"user_name":"Null","can_delete":false,"product_type":"c1","uid":1382587,"ip_address":"北京","ucode":"A7D4DF2A43C7D8","user_header":"https://static001.geekbang.org/account/avatar/00/15/18/bb/9299fab1.jpg","comment_is_top":false,"comment_ctime":1664110889,"is_pvip":false,"replies":null,"discussion_count":0,"race_medal":0,"score":12,"product_id":100021701,"comment_content":"df2[&#39;Chinese&#39;]=df2[&#39;Chinese&#39;].map(str.strip)这种写法会不会有人不理解，str·strip是函数，lamda函数，python的函数式编程","like_count":0},{"had_liked":false,"id":356178,"user_name":"Geek_889ca5","can_delete":false,"product_type":"c1","uid":2028412,"ip_address":"广东","ucode":"B960CE6930C198","user_header":"","comment_is_top":false,"comment_ctime":1662026437,"is_pvip":false,"replies":null,"discussion_count":0,"race_medal":0,"score":12,"product_id":100021701,"comment_content":"import numpy as np\nimport pandas as pd\nfrom pandas import DataFrame\n\ndata = {u&#39;姓名&#39;:[u&#39;张飞&#39;,u&#39;关羽&#39;,u&#39;赵云&#39;,u&#39;黄忠&#39;,u&#39;典韦&#39;,u&#39;典韦&#39;],u&#39;语文&#39;:[66,95,95,90,80,80],u&#39;英语&#39;:[65,85,92,88,90,90],u&#39;数学&#39;:[np.NaN,98,96,77,90,90]}\n\ndf = DataFrame(data)\nprint(df.isnull())\nprint(df.isnull().any())\ndf = df.fillna(0)\ndf = df.drop_duplicates()\ndf[u&#39;总和&#39;] = df[u&#39;语文&#39;]+df[u&#39;英语&#39;]+df[u&#39;数学&#39;]\nprint(df)","like_count":0},{"had_liked":false,"id":355568,"user_name":"Vincent","can_delete":false,"product_type":"c1","uid":1241581,"ip_address":"北京","ucode":"9B70BE6908EB3B","user_header":"https://static001.geekbang.org/account/avatar/00/12/f1/ed/4e249c6b.jpg","comment_is_top":false,"comment_ctime":1661501611,"is_pvip":false,"replies":null,"discussion_count":0,"race_medal":0,"score":12,"product_id":100021701,"comment_content":"data = {&#39;语文&#39;: [66, 95, 95, 90, 80, 80], &#39;英语&#39;: [65, 85, 92, 88, 90, 90], &#39;数学&#39;: [None, 98, 96, 77, 90, 90]}\ndf = pd.DataFrame(data, index=[&#39;张飞&#39;, &#39;关羽&#39;, &#39;赵云&#39;, &#39;黄忠&#39;, &#39;典韦&#39;, &#39;典韦&#39;], columns=[&#39;语文&#39;, &#39;英语&#39;, &#39;数学&#39;])\nprint(df.dtypes)\n# df[&#39;数学&#39;] = df[&#39;数学&#39;].astype(int)\ndf[&#39;数学&#39;].fillna(df[&#39;数学&#39;].mean(), inplace=True)\nprint(df)\ndf = df.drop_duplicates()\nprint(df)\n# df[&#39;总和&#39;] = df[&#39;语文&#39;]+df[&#39;英语&#39;]+df[&#39;数学&#39;]\ndf[&#39;总和&#39;] = df.sum(axis=1)  # 这个更加简便\nprint(df)\n\n&quot;&quot;&quot;\n    语文  英语    数学     总和\n张飞  66  65  90.2  221.2\n关羽  95  85  98.0  278.0\n赵云  95  92  96.0  283.0\n黄忠  90  88  77.0  255.0\n典韦  80  90  90.0  260.0\n&quot;&quot;&quot;","like_count":0},{"had_liked":false,"id":354227,"user_name":"闫凯伟","can_delete":false,"product_type":"c1","uid":1923359,"ip_address":"河北","ucode":"4D0CD810777520","user_header":"https://static001.geekbang.org/account/avatar/00/1d/59/1f/7e0c7447.jpg","comment_is_top":false,"comment_ctime":1660201157,"is_pvip":false,"replies":null,"discussion_count":0,"race_medal":0,"score":12,"product_id":100021701,"comment_content":"import pandas as pd\n\n# 初始化数据\ndata = {\n    &#39;name&#39;: [&#39;张飞&#39;, &#39;关羽&#39;, &#39;赵云&#39;, &#39;黄忠&#39;, &#39;典韦&#39;, &#39;典韦&#39;],\n    &#39;Chinese&#39;: [66, 95, 95, 90, 80, 80],\n    &#39;English&#39;: [65, 85, 92, 88, 90, 90],\n    &#39;Math&#39;: [None, 98, 96, 77, 90, 90]\n}\ndf = pd.DataFrame(data)\n\n# 清洗空值，以列平均值替换空单元格\nx = df[&#39;Math&#39;].mean()\ndf[&#39;Math&#39;].fillna(x, inplace=True)\n\n# 清洗重复数据\ndf.drop_duplicates(inplace=True)\n\n# apply 函数对数据进行清洗，添加 sum 列\ndef sum(df):\n    df[&#39;Sum&#39;] = df[&#39;Chinese&#39;] + df[&#39;English&#39;] + df[&#39;Math&#39;]\n    return df\n\ndf = df.apply(sum, axis=1)\n\n# 重命名列名\ndf.rename(columns={&#39;name&#39;: &#39;姓名&#39;, &#39;Chinese&#39;: &#39;语文&#39;, &#39;English&#39;: &#39;英语&#39;, &#39;Math&#39;: &#39;数学&#39;, &#39;Sum&#39;: &#39;总成绩&#39;}, inplace=True)\n\nprint(df)","like_count":0},{"had_liked":false,"id":353874,"user_name":"尖尖","can_delete":false,"product_type":"c1","uid":3066538,"ip_address":"四川","ucode":"CFFA12A459D891","user_header":"https://static001.geekbang.org/account/avatar/00/2e/ca/aa/71165169.jpg","comment_is_top":false,"comment_ctime":1659880554,"is_pvip":false,"replies":null,"discussion_count":0,"race_medal":0,"score":12,"product_id":100021701,"comment_content":"import pandas as pd\nimport pandasql\n\ndata = {&#39;Chinese&#39;: [66, 95, 95, 90,80,80],&#39;English&#39;: [65, 85, 92, 88, 90, 90],&#39;Math&#39;: [None, 98, 96, 77, 90, 90]}\ndf1= pd.DataFrame(data)\ndf2 = pd.DataFrame(data, index=[&#39;ZhangFei&#39;, &#39;GuanYu&#39;, &#39;ZhaoYun&#39;, &#39;HuangZhong&#39;, &#39;DianWei&#39;, &#39;DianWei&#39;], columns=[&#39;Chinese&#39;, &#39;English&#39;, &#39;Math&#39;])\nprint (df1)\n\ndf2.fillna(0,inplace=True)\ndf2.drop_duplicates(inplace=True)\ndf2[&#39;总成绩&#39;] = df2[&#39;Chinese&#39;]+df2[&#39;English&#39;]+ df2[&#39;Math&#39;]","like_count":0},{"had_liked":false,"id":349661,"user_name":"zong","can_delete":false,"product_type":"c1","uid":2414187,"ip_address":"","ucode":"B245DA27DED469","user_header":"https://static001.geekbang.org/account/avatar/00/24/d6/6b/69544084.jpg","comment_is_top":false,"comment_ctime":1656210905,"is_pvip":false,"replies":null,"discussion_count":0,"race_medal":0,"score":12,"product_id":100021701,"comment_content":"import numpy as np\n\nimport pandas as pd\nfrom pandasql import sqldf, load_meat, load_births\ndata={&#39;姓名&#39;:[&#39;张飞&#39;,&#39;关羽&#39;,&#39;赵云&#39;,&#39;黄忠&#39;,&#39;典韦&#39;,&#39;典韦&#39;],\n      &#39;语文&#39;:[66,95,95,90,80,80],&#39;英语&#39;:[65,85,92,88,90,90],\n      &#39;数学&#39;:[None,98,96,77,90,90]}\ncol=[&#39;姓名&#39;,&#39;语文&#39;,&#39;数学&#39;,&#39;英语&#39;]\ndf=pd.DataFrame(data = data,columns = col)\n\nprint(df)\n#查找是否有空值\na=df.isnull().any()\n\n#空值填充\ndf1=df.fillna(value = 0)\n\n#去除重复列\ndf=df1.drop_duplicates()\ndf[&#39;数学&#39;].astype(int)\n\n\n#新增一列总和\ndef plus(df):\n      df[&#39;总计&#39;]=df[&#39;英语&#39;]+df[&#39;数学&#39;]+df[&#39;语文&#39;]\n      return df\n\n\ndf1=df1.apply(plus,axis = 1)\n\nprint(df1)\n","like_count":0},{"had_liked":false,"id":344286,"user_name":"H.H","can_delete":false,"product_type":"c1","uid":2668479,"ip_address":"","ucode":"3C0BB1E2A3EC51","user_header":"https://static001.geekbang.org/account/avatar/00/28/b7/bf/815f0ec6.jpg","comment_is_top":false,"comment_ctime":1651420291,"is_pvip":false,"replies":null,"discussion_count":0,"race_medal":0,"score":12,"product_id":100021701,"comment_content":"import pandas as pd \nimport numpy as np\nfrom pandas import DataFrame\nscores = {\n    &quot;语文&quot;:[66,95,95,90,80,80],\n    &quot;英语&quot;:[65,85,92,88,90,90],\n    &quot;数学&quot;:[None,98,96,77,90,90]\n}\n\ndf = DataFrame(data=scores,index=[&#39;张飞&#39;,&#39;关羽&#39;,&#39;赵云&#39;,&#39;黄忠&#39;,&#39;典韦&#39;,&#39;典韦&#39;],dtype=np.int64)\ndf = df.drop_duplicates()\ndf[&quot;总和&quot;] = df.sum(axis=1).values","like_count":0},{"had_liked":false,"id":341964,"user_name":"Jeff","can_delete":false,"product_type":"c1","uid":2864924,"ip_address":"","ucode":"F9230D1FA48AE1","user_header":"https://static001.geekbang.org/account/avatar/00/2b/b7/1c/b5c9456b.jpg","comment_is_top":false,"comment_ctime":1649932829,"is_pvip":false,"replies":null,"discussion_count":0,"race_medal":0,"score":12,"product_id":100021701,"comment_content":"import  pandas as pd\nimport numpy as np\n\ndd=pd.DataFrame(data={&#39;语文&#39;:[66,95,95,90,80,80],&#39;英语&#39;:[65,85,92,88,90,90],&#39;数学&#39;:[np.nan,98,96,77,90,90]},\n                index=[&#39;张飞&#39;,&#39;关羽&#39;,&#39;赵云&#39;,&#39;黄忠&#39;,&#39;典韦&#39;,&#39;典韦&#39;])\ndd=dd.fillna(0) #缺考成绩为0\ndd=dd.drop_duplicates() #删除重复值\ndd[&#39;总和&#39;]=dd.语文+dd.英语+dd.数学 #成绩求和\nprint(dd)","like_count":0},{"had_liked":false,"id":368801,"user_name":"唐明响","can_delete":false,"product_type":"c1","uid":1692093,"ip_address":"广东","ucode":"1343FD7A9E7DCC","user_header":"https://static001.geekbang.org/account/avatar/00/19/d1/bd/a3a74304.jpg","comment_is_top":false,"comment_ctime":1676728598,"is_pvip":false,"replies":null,"discussion_count":0,"race_medal":0,"score":12,"product_id":100021701,"comment_content":"pandasql 执行的时候报错：\nTraceback (most recent call last):\n  File &quot;D:\\PycharmProjects\\python1014\\venv\\lib\\site-packages\\sqlalchemy\\engine\\base.py&quot;, line 1410, in execute\n    meth = statement._execute_on_connection\nAttributeError: &#39;str&#39; object has no attribute &#39;_execute_on_connection&#39;","like_count":0},{"had_liked":false,"id":359357,"user_name":"刘慧慧","can_delete":false,"product_type":"c1","uid":1475203,"ip_address":"上海","ucode":"67D6D0B7A97D06","user_header":"http://thirdwx.qlogo.cn/mmopen/vi_32/DYAIOgq83epNx7CCsqNO0qiavCXp2AQEU7ZIpL8aNpRr7ypmKPrf5MOia5rV5ibTLKrlMQxiafPoRLicOvfSicwukIbw/132","comment_is_top":false,"comment_ctime":1665470509,"is_pvip":false,"replies":null,"discussion_count":0,"race_medal":0,"score":12,"product_id":100021701,"comment_content":"有没有遇到通过Workbook写入的xls文件，再通过pd.read_excel读取的时候会报不支持xlsx？文件后缀确实是xls,但是如果把这个文件重新另存为一份又可以读取，网上找了很多原因都没有解决。","like_count":0},{"had_liked":false,"id":358243,"user_name":"Null","can_delete":false,"product_type":"c1","uid":1382587,"ip_address":"北京","ucode":"A7D4DF2A43C7D8","user_header":"https://static001.geekbang.org/account/avatar/00/15/18/bb/9299fab1.jpg","comment_is_top":false,"comment_ctime":1664110889,"is_pvip":false,"replies":null,"discussion_count":0,"race_medal":0,"score":12,"product_id":100021701,"comment_content":"df2[&#39;Chinese&#39;]=df2[&#39;Chinese&#39;].map(str.strip)这种写法会不会有人不理解，str·strip是函数，lamda函数，python的函数式编程","like_count":0},{"had_liked":false,"id":356178,"user_name":"Geek_889ca5","can_delete":false,"product_type":"c1","uid":2028412,"ip_address":"广东","ucode":"B960CE6930C198","user_header":"","comment_is_top":false,"comment_ctime":1662026437,"is_pvip":false,"replies":null,"discussion_count":0,"race_medal":0,"score":12,"product_id":100021701,"comment_content":"import numpy as np\nimport pandas as pd\nfrom pandas import DataFrame\n\ndata = {u&#39;姓名&#39;:[u&#39;张飞&#39;,u&#39;关羽&#39;,u&#39;赵云&#39;,u&#39;黄忠&#39;,u&#39;典韦&#39;,u&#39;典韦&#39;],u&#39;语文&#39;:[66,95,95,90,80,80],u&#39;英语&#39;:[65,85,92,88,90,90],u&#39;数学&#39;:[np.NaN,98,96,77,90,90]}\n\ndf = DataFrame(data)\nprint(df.isnull())\nprint(df.isnull().any())\ndf = df.fillna(0)\ndf = df.drop_duplicates()\ndf[u&#39;总和&#39;] = df[u&#39;语文&#39;]+df[u&#39;英语&#39;]+df[u&#39;数学&#39;]\nprint(df)","like_count":0},{"had_liked":false,"id":355568,"user_name":"Vincent","can_delete":false,"product_type":"c1","uid":1241581,"ip_address":"北京","ucode":"9B70BE6908EB3B","user_header":"https://static001.geekbang.org/account/avatar/00/12/f1/ed/4e249c6b.jpg","comment_is_top":false,"comment_ctime":1661501611,"is_pvip":false,"replies":null,"discussion_count":0,"race_medal":0,"score":12,"product_id":100021701,"comment_content":"data = {&#39;语文&#39;: [66, 95, 95, 90, 80, 80], &#39;英语&#39;: [65, 85, 92, 88, 90, 90], &#39;数学&#39;: [None, 98, 96, 77, 90, 90]}\ndf = pd.DataFrame(data, index=[&#39;张飞&#39;, &#39;关羽&#39;, &#39;赵云&#39;, &#39;黄忠&#39;, &#39;典韦&#39;, &#39;典韦&#39;], columns=[&#39;语文&#39;, &#39;英语&#39;, &#39;数学&#39;])\nprint(df.dtypes)\n# df[&#39;数学&#39;] = df[&#39;数学&#39;].astype(int)\ndf[&#39;数学&#39;].fillna(df[&#39;数学&#39;].mean(), inplace=True)\nprint(df)\ndf = df.drop_duplicates()\nprint(df)\n# df[&#39;总和&#39;] = df[&#39;语文&#39;]+df[&#39;英语&#39;]+df[&#39;数学&#39;]\ndf[&#39;总和&#39;] = df.sum(axis=1)  # 这个更加简便\nprint(df)\n\n&quot;&quot;&quot;\n    语文  英语    数学     总和\n张飞  66  65  90.2  221.2\n关羽  95  85  98.0  278.0\n赵云  95  92  96.0  283.0\n黄忠  90  88  77.0  255.0\n典韦  80  90  90.0  260.0\n&quot;&quot;&quot;","like_count":0},{"had_liked":false,"id":354227,"user_name":"闫凯伟","can_delete":false,"product_type":"c1","uid":1923359,"ip_address":"河北","ucode":"4D0CD810777520","user_header":"https://static001.geekbang.org/account/avatar/00/1d/59/1f/7e0c7447.jpg","comment_is_top":false,"comment_ctime":1660201157,"is_pvip":false,"replies":null,"discussion_count":0,"race_medal":0,"score":12,"product_id":100021701,"comment_content":"import pandas as pd\n\n# 初始化数据\ndata = {\n    &#39;name&#39;: [&#39;张飞&#39;, &#39;关羽&#39;, &#39;赵云&#39;, &#39;黄忠&#39;, &#39;典韦&#39;, &#39;典韦&#39;],\n    &#39;Chinese&#39;: [66, 95, 95, 90, 80, 80],\n    &#39;English&#39;: [65, 85, 92, 88, 90, 90],\n    &#39;Math&#39;: [None, 98, 96, 77, 90, 90]\n}\ndf = pd.DataFrame(data)\n\n# 清洗空值，以列平均值替换空单元格\nx = df[&#39;Math&#39;].mean()\ndf[&#39;Math&#39;].fillna(x, inplace=True)\n\n# 清洗重复数据\ndf.drop_duplicates(inplace=True)\n\n# apply 函数对数据进行清洗，添加 sum 列\ndef sum(df):\n    df[&#39;Sum&#39;] = df[&#39;Chinese&#39;] + df[&#39;English&#39;] + df[&#39;Math&#39;]\n    return df\n\ndf = df.apply(sum, axis=1)\n\n# 重命名列名\ndf.rename(columns={&#39;name&#39;: &#39;姓名&#39;, &#39;Chinese&#39;: &#39;语文&#39;, &#39;English&#39;: &#39;英语&#39;, &#39;Math&#39;: &#39;数学&#39;, &#39;Sum&#39;: &#39;总成绩&#39;}, inplace=True)\n\nprint(df)","like_count":0},{"had_liked":false,"id":353874,"user_name":"尖尖","can_delete":false,"product_type":"c1","uid":3066538,"ip_address":"四川","ucode":"CFFA12A459D891","user_header":"https://static001.geekbang.org/account/avatar/00/2e/ca/aa/71165169.jpg","comment_is_top":false,"comment_ctime":1659880554,"is_pvip":false,"replies":null,"discussion_count":0,"race_medal":0,"score":12,"product_id":100021701,"comment_content":"import pandas as pd\nimport pandasql\n\ndata = {&#39;Chinese&#39;: [66, 95, 95, 90,80,80],&#39;English&#39;: [65, 85, 92, 88, 90, 90],&#39;Math&#39;: [None, 98, 96, 77, 90, 90]}\ndf1= pd.DataFrame(data)\ndf2 = pd.DataFrame(data, index=[&#39;ZhangFei&#39;, &#39;GuanYu&#39;, &#39;ZhaoYun&#39;, &#39;HuangZhong&#39;, &#39;DianWei&#39;, &#39;DianWei&#39;], columns=[&#39;Chinese&#39;, &#39;English&#39;, &#39;Math&#39;])\nprint (df1)\n\ndf2.fillna(0,inplace=True)\ndf2.drop_duplicates(inplace=True)\ndf2[&#39;总成绩&#39;] = df2[&#39;Chinese&#39;]+df2[&#39;English&#39;]+ df2[&#39;Math&#39;]","like_count":0},{"had_liked":false,"id":349661,"user_name":"zong","can_delete":false,"product_type":"c1","uid":2414187,"ip_address":"","ucode":"B245DA27DED469","user_header":"https://static001.geekbang.org/account/avatar/00/24/d6/6b/69544084.jpg","comment_is_top":false,"comment_ctime":1656210905,"is_pvip":false,"replies":null,"discussion_count":0,"race_medal":0,"score":12,"product_id":100021701,"comment_content":"import numpy as np\n\nimport pandas as pd\nfrom pandasql import sqldf, load_meat, load_births\ndata={&#39;姓名&#39;:[&#39;张飞&#39;,&#39;关羽&#39;,&#39;赵云&#39;,&#39;黄忠&#39;,&#39;典韦&#39;,&#39;典韦&#39;],\n      &#39;语文&#39;:[66,95,95,90,80,80],&#39;英语&#39;:[65,85,92,88,90,90],\n      &#39;数学&#39;:[None,98,96,77,90,90]}\ncol=[&#39;姓名&#39;,&#39;语文&#39;,&#39;数学&#39;,&#39;英语&#39;]\ndf=pd.DataFrame(data = data,columns = col)\n\nprint(df)\n#查找是否有空值\na=df.isnull().any()\n\n#空值填充\ndf1=df.fillna(value = 0)\n\n#去除重复列\ndf=df1.drop_duplicates()\ndf[&#39;数学&#39;].astype(int)\n\n\n#新增一列总和\ndef plus(df):\n      df[&#39;总计&#39;]=df[&#39;英语&#39;]+df[&#39;数学&#39;]+df[&#39;语文&#39;]\n      return df\n\n\ndf1=df1.apply(plus,axis = 1)\n\nprint(df1)\n","like_count":0},{"had_liked":false,"id":344286,"user_name":"H.H","can_delete":false,"product_type":"c1","uid":2668479,"ip_address":"","ucode":"3C0BB1E2A3EC51","user_header":"https://static001.geekbang.org/account/avatar/00/28/b7/bf/815f0ec6.jpg","comment_is_top":false,"comment_ctime":1651420291,"is_pvip":false,"replies":null,"discussion_count":0,"race_medal":0,"score":12,"product_id":100021701,"comment_content":"import pandas as pd \nimport numpy as np\nfrom pandas import DataFrame\nscores = {\n    &quot;语文&quot;:[66,95,95,90,80,80],\n    &quot;英语&quot;:[65,85,92,88,90,90],\n    &quot;数学&quot;:[None,98,96,77,90,90]\n}\n\ndf = DataFrame(data=scores,index=[&#39;张飞&#39;,&#39;关羽&#39;,&#39;赵云&#39;,&#39;黄忠&#39;,&#39;典韦&#39;,&#39;典韦&#39;],dtype=np.int64)\ndf = df.drop_duplicates()\ndf[&quot;总和&quot;] = df.sum(axis=1).values","like_count":0},{"had_liked":false,"id":341964,"user_name":"Jeff","can_delete":false,"product_type":"c1","uid":2864924,"ip_address":"","ucode":"F9230D1FA48AE1","user_header":"https://static001.geekbang.org/account/avatar/00/2b/b7/1c/b5c9456b.jpg","comment_is_top":false,"comment_ctime":1649932829,"is_pvip":false,"replies":null,"discussion_count":0,"race_medal":0,"score":12,"product_id":100021701,"comment_content":"import  pandas as pd\nimport numpy as np\n\ndd=pd.DataFrame(data={&#39;语文&#39;:[66,95,95,90,80,80],&#39;英语&#39;:[65,85,92,88,90,90],&#39;数学&#39;:[np.nan,98,96,77,90,90]},\n                index=[&#39;张飞&#39;,&#39;关羽&#39;,&#39;赵云&#39;,&#39;黄忠&#39;,&#39;典韦&#39;,&#39;典韦&#39;])\ndd=dd.fillna(0) #缺考成绩为0\ndd=dd.drop_duplicates() #删除重复值\ndd[&#39;总和&#39;]=dd.语文+dd.英语+dd.数学 #成绩求和\nprint(dd)","like_count":0},{"had_liked":false,"id":326036,"user_name":"千弦","can_delete":false,"product_type":"c1","uid":2808755,"ip_address":"","ucode":"140C26C4C039D3","user_header":"https://static001.geekbang.org/account/avatar/00/2a/db/b3/98b929e4.jpg","comment_is_top":false,"comment_ctime":1639323155,"is_pvip":false,"replies":null,"discussion_count":0,"race_medal":0,"score":13,"product_id":100021701,"comment_content":"打卡,坚持学习","like_count":0},{"had_liked":false,"id":324146,"user_name":"Stone之","can_delete":false,"product_type":"c1","uid":2627431,"ip_address":"","ucode":"826DC054AC02BB","user_header":"https://static001.geekbang.org/account/avatar/00/28/17/67/2cd102cd.jpg","comment_is_top":false,"comment_ctime":1638322304,"is_pvip":false,"replies":null,"discussion_count":0,"race_medal":0,"score":13,"product_id":100021701,"comment_content":"DataFrame(pd.read_excel(&#39;data.xlsx&#39;))  我这里py3.10,直接用pd.read_excel(&#39;data.xlsx&#39;)就返回一个DataFrame对象","like_count":0},{"had_liked":false,"id":322420,"user_name":"Geek_fc90ae","can_delete":false,"product_type":"c1","uid":2832398,"ip_address":"","ucode":"48B13AE913DB91","user_header":"","comment_is_top":false,"comment_ctime":1637378942,"is_pvip":false,"replies":null,"discussion_count":0,"race_medal":0,"score":13,"product_id":100021701,"comment_content":"练习题\n对于下表的数据，请使用 Pandas 中的 DataFrame 进行创建，并对数据进行清洗。同时新增一列“总和”计算每个人的三科成绩之和。\nimport pandas as pd\nfrom pandas import Series, DataFrame\ndata={&#39;Chinese&#39;:[66,95,95,90,80,80],&#39;English&#39;:[65,85,92,88,90,90],&#39;Maths&#39;:[None,98,96,77,90,90]}\ndf1 = DataFrame(data)\ndf2 = DataFrame(data, index = [&#39;zhangfei&#39;, &#39;guanyu&#39;, &#39;zhaoyun&#39;,&#39;huangzhong&#39;,&#39;dianwei&#39;,&#39;dianwei&#39;])\ndf2.isnull()\ndf2=df2.drop_duplicates()\ndf2[&#39;Maths&#39;].fillna(df2[&#39;Maths&#39;].mean(), inplace = True)\ndf2[&#39;score&#39;] = df2.sum(axis = 1)","like_count":0},{"had_liked":false,"id":317412,"user_name":"Adorkable🍧","can_delete":false,"product_type":"c1","uid":1516738,"ip_address":"","ucode":"B2742905093B21","user_header":"https://static001.geekbang.org/account/avatar/00/17/24/c2/5223e43e.jpg","comment_is_top":false,"comment_ctime":1634788574,"is_pvip":false,"replies":null,"discussion_count":0,"race_medal":0,"score":13,"product_id":100021701,"comment_content":"df1 = DataFrame({&#39;name&#39;:[&#39;ZhangFei&#39;, &#39;GuanYu&#39;, &#39;zhaoyun&#39;, &#39;huangzhong&#39;, &#39;dianwei&#39;,&#39;dianwei&#39;],\n                 &#39;yuwen&#39;:[&#39;66&#39;, &#39;95&#39;, &#39;95&#39;, &#39;90&#39;, &#39;80&#39;,&#39;80&#39;],\n                 &#39;yingyu&#39;:[&#39;65&#39;, &#39;85&#39;, &#39;92&#39;, &#39;88&#39;, &#39;90&#39;,&#39;90&#39;],\n                 &#39;shuxue&#39;:[None, &#39;98&#39;, &#39;96&#39;, &#39;77&#39;, &#39;90&#39;,&#39;90&#39;]},\n                index=[&#39;ZhangFei&#39;, &#39;GuanYu&#39;, &#39;zhaoyun&#39;, &#39;huangzhong&#39;, &#39;dianwei&#39;,&#39;dianwei&#39;],\n                columns=[&#39;yuwen&#39;,&#39;yingyu&#39;,&#39;shuxue&#39;])\ndf1 = df1.drop_duplicates()\ndf1.replace(to_replace= [None], value=&#39;0&#39;, inplace=True)\ndf1[&#39;sum&#39;] = df1[&#39;yuwen&#39;].astype(int) + df1[&#39;yingyu&#39;].astype(int) + df1[&#39;shuxue&#39;].astype(int)\nprint(df1)","like_count":0},{"had_liked":false,"id":316461,"user_name":"自救机会","can_delete":false,"product_type":"c1","uid":2807082,"ip_address":"","ucode":"C0D7E8ACF63F73","user_header":"https://static001.geekbang.org/account/avatar/00/2a/d5/2a/af8cc195.jpg","comment_is_top":false,"comment_ctime":1634311781,"is_pvip":false,"replies":null,"discussion_count":0,"race_medal":0,"score":13,"product_id":100021701,"comment_content":"import pandas as pd\ndf = pd.DataFrame([(&#39;张飞&#39;, 66, 65, ), (&#39;关羽&#39;, 95, 85, 98), (&#39;赵云&#39;, 95, 92, 96), (&#39;黄忠&#39;, 90, 88, 77), (&#39;典韦&#39;, 80, 90, 90), (&#39;典韦&#39;, 80, 90, 90)], columns=[&#39;姓名&#39;, &#39;语文&#39;, &#39;英语&#39;, &#39;数学&#39;]).set_index(&#39;姓名&#39;)\ndf = df.drop_duplicates(keep=&quot;first&quot;)\ndf = df.fillna(0)\ndf[&#39;总和&#39;] = df.apply(lambda x: x.sum(), axis=1)\nprint(df)","like_count":0},{"had_liked":false,"id":313638,"user_name":"picoasis","can_delete":false,"product_type":"c1","uid":1217329,"ip_address":"","ucode":"D5113416FF2B14","user_header":"https://static001.geekbang.org/account/avatar/00/12/93/31/abb7bfe3.jpg","comment_is_top":false,"comment_ctime":1632576900,"is_pvip":false,"replies":null,"discussion_count":0,"race_medal":0,"score":13,"product_id":100021701,"comment_content":"#!&#47;usr&#47;bin&#47;env python3\n# -*- coding: utf-8 -*-\n&quot;&quot;&quot;\nCreated on Sat Sep 25 16:05:37 2021\n\n@author: picoasis\n&quot;&quot;&quot;\n&#39;&#39;&#39;\n对于下表的数据，请使用 Pandas 中的 DataFrame \n进行创建，\n并对数据进行清洗。\n同时新增一列“总和”计算每个人的三科成绩之和。\n&#39;&#39;&#39;\nimport numpy as np\nimport pandas as pd\nfrom pandas import DataFrame\n\n# 缺失值如何表示： numpy用  np.nan\ndata = {&quot;语文&quot;:[66,95,95,90,80,80],&quot;英语&quot;:[65,85,92,88,90,90],\n        &quot;数学&quot;:[np.nan ,98,96,77,90,90]}\nscores = DataFrame(data,index=[&#39;张飞&#39;,&quot;关羽&quot;,&quot;赵云&quot;,&quot;黄忠&quot;,&quot;典韦&quot;,&quot;典韦&quot;])\n\n#重复行\nscores = scores.drop_duplicates()\n#缺失值如何处理 用0代替&#47;用成绩均值代替\nscores[&quot;数学&quot;] = scores[&quot;数学&quot;].fillna(scores[&quot;数学&quot;].mean())\n#print(scores)\n\ntotalS = []\nfor index,r in scores.iterrows():\n    totalS.append( r[&quot;数学&quot;]+r[&quot;英语&quot;]+r[&quot;语文&quot;] )\n    \nscores[&#39;总分&#39;] = totalS\nprint(scores)","like_count":0},{"had_liked":false,"id":309764,"user_name":"俯瞰风景.","can_delete":false,"product_type":"c1","uid":1044166,"ip_address":"","ucode":"A6DB68B7B84AEE","user_header":"https://static001.geekbang.org/account/avatar/00/0f/ee/c6/bebcbcf0.jpg","comment_is_top":false,"comment_ctime":1630325472,"is_pvip":false,"replies":null,"discussion_count":0,"race_medal":1,"score":13,"product_id":100021701,"comment_content":"from numpy import array\nimport pandas as pd\n\ndata = {&#39;语文&#39;: [66, 95, 93, 90, 80, 80],&#39;英语&#39;: [65, 85, 92, 88, 90, 90],&#39;数学&#39;: [None, 98, 96, 77, 90, 90]}\ndf = DataFrame(data, index=[&#39;张飞&#39;, &#39;关羽&#39;, &#39;赵云&#39;, &#39;黄忠&#39;, &#39;典韦&#39;, &#39;典韦&#39;], columns=[&#39;语文&#39;, &#39;英语&#39;, &#39;数学&#39;])\nprint(df)\nprint(&#39;************************************&#39;)\n\ndf = df.drop_duplicates()\ndf = df.fillna(df[&#39;数学&#39;].mean())\ndf[&#39;总分&#39;] = df.sum(axis=1)\ndf = df.sort_values(by=&#39;总分&#39;, ascending=False)\nprint(df)\n\noutput:\n    语文  英语    数学\n张飞  66  65   NaN\n关羽  95  85  98.0\n赵云  93  92  96.0\n黄忠  90  88  77.0\n典韦  80  90  90.0\n典韦  80  90  90.0\n************************************\n    语文  英语     数学      总分\n赵云  93  92  96.00  281.00\n关羽  95  85  98.00  278.00\n典韦  80  90  90.00  260.00\n黄忠  90  88  77.00  255.00\n张飞  66  65  90.25  221.25\n","like_count":0},{"had_liked":false,"id":308057,"user_name":"随片","can_delete":false,"product_type":"c1","uid":2139020,"ip_address":"","ucode":"1EDA99E17B20C7","user_header":"https://static001.geekbang.org/account/avatar/00/20/a3/8c/23b2464c.jpg","comment_is_top":false,"comment_ctime":1629371064,"is_pvip":false,"replies":null,"discussion_count":0,"race_medal":0,"score":13,"product_id":100021701,"comment_content":"目前使用astype(&#39;str&#39;)进行格式转换一直没生效。编辑你好，请让加一下微信群，谢谢。","like_count":0},{"had_liked":false,"id":303228,"user_name":"布布塔","can_delete":false,"product_type":"c1","uid":2333790,"ip_address":"","ucode":"AB7C3727B481C1","user_header":"https://static001.geekbang.org/account/avatar/00/23/9c/5e/7605d010.jpg","comment_is_top":false,"comment_ctime":1626676979,"is_pvip":false,"replies":null,"discussion_count":0,"race_medal":0,"score":13,"product_id":100021701,"comment_content":"import pandas as pd\nimport numpy as np\nfrom pandas import DataFrame\n\ndata = {&#39;Chinese&#39;:[66,95,95,90,80,80],&#39;English&#39;:[65,85,92,88,90,90],&#39;Math&#39;:[None,98,96,77,90,90]}\ndf = DataFrame(data,index=[&#39;张飞&#39;,&#39;关羽&#39;,&#39;赵云&#39;,&#39;黄忠&#39;,&#39;典韦&#39;,&#39;典韦&#39;],columns=[&#39;Chinese&#39;,&#39;English&#39;,&#39;Math&#39;])\n# 清除重复数据\ndf = df.drop_duplicates()\n#查看是否有缺失数据\ndf.isnull()\n# 将张飞缺失的数据用整个数学的均值替换上\ndf.Math.fillna(df.Math.mean(),inplace=True)\ndf[&#39;总和&#39;] = df.Chinese+df.English+df.Math","like_count":0},{"had_liked":false,"id":298465,"user_name":"沙","can_delete":false,"product_type":"c1","uid":2641625,"ip_address":"","ucode":"E8749E3999CBE6","user_header":"https://static001.geekbang.org/account/avatar/00/28/4e/d9/426c5bc0.jpg","comment_is_top":false,"comment_ctime":1624119198,"is_pvip":false,"replies":null,"discussion_count":0,"race_medal":0,"score":13,"product_id":100021701,"comment_content":"\nimport pandas as pd\nfrom pandas import Series, DataFrame\n#录入数据\ndata = {&#39;Chinese&#39;: [66, 95, 93, 90, 80, 80], &#39;English&#39;: [65, 85, 92, 88, 90, 90],\n        &#39;Math&#39;: [None, 98, 96, 77, 90, 90]}\ndf = pd.DataFrame(data, index=[&#39;张飞&#39;, &#39;关羽&#39;, &#39;赵云&#39;, &#39;黄忠&#39;, &#39;典韦&#39;, &#39;典韦&#39;],\n                  columns=[&#39;English&#39;, &#39;Math&#39;, &#39;Chinese&#39;])\n# 去除重复行\ndf = df.drop_duplicates()\n# 重名名\ndf.rename(columns={&#39;Chinese&#39;: &#39;语文&#39;, &#39;English&#39;: &#39;英语&#39;,&#39;Math&#39;: &#39;数学&#39;}, inplace = True)\n#新增列\ndef plus(df):\n    df[&#39;总和&#39;]=df[&#39;语文&#39;]+df[&#39;英语&#39;]+df[&#39;数学&#39;]\n    return df\ndf = df.apply(plus,axis=1)\n#排序\ndf.sort_values([&#39;总和&#39;], ascending=[False], inplace=True)\nprint(df.describe())\nprint(df)\n#导出数据\ndf.to_excel(&#39;C:&#47;Users&#47;shadie&#47;Desktop&#47;new.xlsx&#39;)","like_count":0},{"had_liked":false,"id":326036,"user_name":"千弦","can_delete":false,"product_type":"c1","uid":2808755,"ip_address":"","ucode":"140C26C4C039D3","user_header":"https://static001.geekbang.org/account/avatar/00/2a/db/b3/98b929e4.jpg","comment_is_top":false,"comment_ctime":1639323155,"is_pvip":false,"replies":null,"discussion_count":0,"race_medal":0,"score":13,"product_id":100021701,"comment_content":"打卡,坚持学习","like_count":0},{"had_liked":false,"id":324146,"user_name":"Stone之","can_delete":false,"product_type":"c1","uid":2627431,"ip_address":"","ucode":"826DC054AC02BB","user_header":"https://static001.geekbang.org/account/avatar/00/28/17/67/2cd102cd.jpg","comment_is_top":false,"comment_ctime":1638322304,"is_pvip":false,"replies":null,"discussion_count":0,"race_medal":0,"score":13,"product_id":100021701,"comment_content":"DataFrame(pd.read_excel(&#39;data.xlsx&#39;))  我这里py3.10,直接用pd.read_excel(&#39;data.xlsx&#39;)就返回一个DataFrame对象","like_count":0},{"had_liked":false,"id":322420,"user_name":"Geek_fc90ae","can_delete":false,"product_type":"c1","uid":2832398,"ip_address":"","ucode":"48B13AE913DB91","user_header":"","comment_is_top":false,"comment_ctime":1637378942,"is_pvip":false,"replies":null,"discussion_count":0,"race_medal":0,"score":13,"product_id":100021701,"comment_content":"练习题\n对于下表的数据，请使用 Pandas 中的 DataFrame 进行创建，并对数据进行清洗。同时新增一列“总和”计算每个人的三科成绩之和。\nimport pandas as pd\nfrom pandas import Series, DataFrame\ndata={&#39;Chinese&#39;:[66,95,95,90,80,80],&#39;English&#39;:[65,85,92,88,90,90],&#39;Maths&#39;:[None,98,96,77,90,90]}\ndf1 = DataFrame(data)\ndf2 = DataFrame(data, index = [&#39;zhangfei&#39;, &#39;guanyu&#39;, &#39;zhaoyun&#39;,&#39;huangzhong&#39;,&#39;dianwei&#39;,&#39;dianwei&#39;])\ndf2.isnull()\ndf2=df2.drop_duplicates()\ndf2[&#39;Maths&#39;].fillna(df2[&#39;Maths&#39;].mean(), inplace = True)\ndf2[&#39;score&#39;] = df2.sum(axis = 1)","like_count":0},{"had_liked":false,"id":317412,"user_name":"Adorkable🍧","can_delete":false,"product_type":"c1","uid":1516738,"ip_address":"","ucode":"B2742905093B21","user_header":"https://static001.geekbang.org/account/avatar/00/17/24/c2/5223e43e.jpg","comment_is_top":false,"comment_ctime":1634788574,"is_pvip":false,"replies":null,"discussion_count":0,"race_medal":0,"score":13,"product_id":100021701,"comment_content":"df1 = DataFrame({&#39;name&#39;:[&#39;ZhangFei&#39;, &#39;GuanYu&#39;, &#39;zhaoyun&#39;, &#39;huangzhong&#39;, &#39;dianwei&#39;,&#39;dianwei&#39;],\n                 &#39;yuwen&#39;:[&#39;66&#39;, &#39;95&#39;, &#39;95&#39;, &#39;90&#39;, &#39;80&#39;,&#39;80&#39;],\n                 &#39;yingyu&#39;:[&#39;65&#39;, &#39;85&#39;, &#39;92&#39;, &#39;88&#39;, &#39;90&#39;,&#39;90&#39;],\n                 &#39;shuxue&#39;:[None, &#39;98&#39;, &#39;96&#39;, &#39;77&#39;, &#39;90&#39;,&#39;90&#39;]},\n                index=[&#39;ZhangFei&#39;, &#39;GuanYu&#39;, &#39;zhaoyun&#39;, &#39;huangzhong&#39;, &#39;dianwei&#39;,&#39;dianwei&#39;],\n                columns=[&#39;yuwen&#39;,&#39;yingyu&#39;,&#39;shuxue&#39;])\ndf1 = df1.drop_duplicates()\ndf1.replace(to_replace= [None], value=&#39;0&#39;, inplace=True)\ndf1[&#39;sum&#39;] = df1[&#39;yuwen&#39;].astype(int) + df1[&#39;yingyu&#39;].astype(int) + df1[&#39;shuxue&#39;].astype(int)\nprint(df1)","like_count":0},{"had_liked":false,"id":316461,"user_name":"自救机会","can_delete":false,"product_type":"c1","uid":2807082,"ip_address":"","ucode":"C0D7E8ACF63F73","user_header":"https://static001.geekbang.org/account/avatar/00/2a/d5/2a/af8cc195.jpg","comment_is_top":false,"comment_ctime":1634311781,"is_pvip":false,"replies":null,"discussion_count":0,"race_medal":0,"score":13,"product_id":100021701,"comment_content":"import pandas as pd\ndf = pd.DataFrame([(&#39;张飞&#39;, 66, 65, ), (&#39;关羽&#39;, 95, 85, 98), (&#39;赵云&#39;, 95, 92, 96), (&#39;黄忠&#39;, 90, 88, 77), (&#39;典韦&#39;, 80, 90, 90), (&#39;典韦&#39;, 80, 90, 90)], columns=[&#39;姓名&#39;, &#39;语文&#39;, &#39;英语&#39;, &#39;数学&#39;]).set_index(&#39;姓名&#39;)\ndf = df.drop_duplicates(keep=&quot;first&quot;)\ndf = df.fillna(0)\ndf[&#39;总和&#39;] = df.apply(lambda x: x.sum(), axis=1)\nprint(df)","like_count":0},{"had_liked":false,"id":313638,"user_name":"picoasis","can_delete":false,"product_type":"c1","uid":1217329,"ip_address":"","ucode":"D5113416FF2B14","user_header":"https://static001.geekbang.org/account/avatar/00/12/93/31/abb7bfe3.jpg","comment_is_top":false,"comment_ctime":1632576900,"is_pvip":false,"replies":null,"discussion_count":0,"race_medal":0,"score":13,"product_id":100021701,"comment_content":"#!&#47;usr&#47;bin&#47;env python3\n# -*- coding: utf-8 -*-\n&quot;&quot;&quot;\nCreated on Sat Sep 25 16:05:37 2021\n\n@author: picoasis\n&quot;&quot;&quot;\n&#39;&#39;&#39;\n对于下表的数据，请使用 Pandas 中的 DataFrame \n进行创建，\n并对数据进行清洗。\n同时新增一列“总和”计算每个人的三科成绩之和。\n&#39;&#39;&#39;\nimport numpy as np\nimport pandas as pd\nfrom pandas import DataFrame\n\n# 缺失值如何表示： numpy用  np.nan\ndata = {&quot;语文&quot;:[66,95,95,90,80,80],&quot;英语&quot;:[65,85,92,88,90,90],\n        &quot;数学&quot;:[np.nan ,98,96,77,90,90]}\nscores = DataFrame(data,index=[&#39;张飞&#39;,&quot;关羽&quot;,&quot;赵云&quot;,&quot;黄忠&quot;,&quot;典韦&quot;,&quot;典韦&quot;])\n\n#重复行\nscores = scores.drop_duplicates()\n#缺失值如何处理 用0代替&#47;用成绩均值代替\nscores[&quot;数学&quot;] = scores[&quot;数学&quot;].fillna(scores[&quot;数学&quot;].mean())\n#print(scores)\n\ntotalS = []\nfor index,r in scores.iterrows():\n    totalS.append( r[&quot;数学&quot;]+r[&quot;英语&quot;]+r[&quot;语文&quot;] )\n    \nscores[&#39;总分&#39;] = totalS\nprint(scores)","like_count":0},{"had_liked":false,"id":309764,"user_name":"俯瞰风景.","can_delete":false,"product_type":"c1","uid":1044166,"ip_address":"","ucode":"A6DB68B7B84AEE","user_header":"https://static001.geekbang.org/account/avatar/00/0f/ee/c6/bebcbcf0.jpg","comment_is_top":false,"comment_ctime":1630325472,"is_pvip":false,"replies":null,"discussion_count":0,"race_medal":1,"score":13,"product_id":100021701,"comment_content":"from numpy import array\nimport pandas as pd\n\ndata = {&#39;语文&#39;: [66, 95, 93, 90, 80, 80],&#39;英语&#39;: [65, 85, 92, 88, 90, 90],&#39;数学&#39;: [None, 98, 96, 77, 90, 90]}\ndf = DataFrame(data, index=[&#39;张飞&#39;, &#39;关羽&#39;, &#39;赵云&#39;, &#39;黄忠&#39;, &#39;典韦&#39;, &#39;典韦&#39;], columns=[&#39;语文&#39;, &#39;英语&#39;, &#39;数学&#39;])\nprint(df)\nprint(&#39;************************************&#39;)\n\ndf = df.drop_duplicates()\ndf = df.fillna(df[&#39;数学&#39;].mean())\ndf[&#39;总分&#39;] = df.sum(axis=1)\ndf = df.sort_values(by=&#39;总分&#39;, ascending=False)\nprint(df)\n\noutput:\n    语文  英语    数学\n张飞  66  65   NaN\n关羽  95  85  98.0\n赵云  93  92  96.0\n黄忠  90  88  77.0\n典韦  80  90  90.0\n典韦  80  90  90.0\n************************************\n    语文  英语     数学      总分\n赵云  93  92  96.00  281.00\n关羽  95  85  98.00  278.00\n典韦  80  90  90.00  260.00\n黄忠  90  88  77.00  255.00\n张飞  66  65  90.25  221.25\n","like_count":0},{"had_liked":false,"id":308057,"user_name":"随片","can_delete":false,"product_type":"c1","uid":2139020,"ip_address":"","ucode":"1EDA99E17B20C7","user_header":"https://static001.geekbang.org/account/avatar/00/20/a3/8c/23b2464c.jpg","comment_is_top":false,"comment_ctime":1629371064,"is_pvip":false,"replies":null,"discussion_count":0,"race_medal":0,"score":13,"product_id":100021701,"comment_content":"目前使用astype(&#39;str&#39;)进行格式转换一直没生效。编辑你好，请让加一下微信群，谢谢。","like_count":0},{"had_liked":false,"id":303228,"user_name":"布布塔","can_delete":false,"product_type":"c1","uid":2333790,"ip_address":"","ucode":"AB7C3727B481C1","user_header":"https://static001.geekbang.org/account/avatar/00/23/9c/5e/7605d010.jpg","comment_is_top":false,"comment_ctime":1626676979,"is_pvip":false,"replies":null,"discussion_count":0,"race_medal":0,"score":13,"product_id":100021701,"comment_content":"import pandas as pd\nimport numpy as np\nfrom pandas import DataFrame\n\ndata = {&#39;Chinese&#39;:[66,95,95,90,80,80],&#39;English&#39;:[65,85,92,88,90,90],&#39;Math&#39;:[None,98,96,77,90,90]}\ndf = DataFrame(data,index=[&#39;张飞&#39;,&#39;关羽&#39;,&#39;赵云&#39;,&#39;黄忠&#39;,&#39;典韦&#39;,&#39;典韦&#39;],columns=[&#39;Chinese&#39;,&#39;English&#39;,&#39;Math&#39;])\n# 清除重复数据\ndf = df.drop_duplicates()\n#查看是否有缺失数据\ndf.isnull()\n# 将张飞缺失的数据用整个数学的均值替换上\ndf.Math.fillna(df.Math.mean(),inplace=True)\ndf[&#39;总和&#39;] = df.Chinese+df.English+df.Math","like_count":0},{"had_liked":false,"id":298465,"user_name":"沙","can_delete":false,"product_type":"c1","uid":2641625,"ip_address":"","ucode":"E8749E3999CBE6","user_header":"https://static001.geekbang.org/account/avatar/00/28/4e/d9/426c5bc0.jpg","comment_is_top":false,"comment_ctime":1624119198,"is_pvip":false,"replies":null,"discussion_count":0,"race_medal":0,"score":13,"product_id":100021701,"comment_content":"\nimport pandas as pd\nfrom pandas import Series, DataFrame\n#录入数据\ndata = {&#39;Chinese&#39;: [66, 95, 93, 90, 80, 80], &#39;English&#39;: [65, 85, 92, 88, 90, 90],\n        &#39;Math&#39;: [None, 98, 96, 77, 90, 90]}\ndf = pd.DataFrame(data, index=[&#39;张飞&#39;, &#39;关羽&#39;, &#39;赵云&#39;, &#39;黄忠&#39;, &#39;典韦&#39;, &#39;典韦&#39;],\n                  columns=[&#39;English&#39;, &#39;Math&#39;, &#39;Chinese&#39;])\n# 去除重复行\ndf = df.drop_duplicates()\n# 重名名\ndf.rename(columns={&#39;Chinese&#39;: &#39;语文&#39;, &#39;English&#39;: &#39;英语&#39;,&#39;Math&#39;: &#39;数学&#39;}, inplace = True)\n#新增列\ndef plus(df):\n    df[&#39;总和&#39;]=df[&#39;语文&#39;]+df[&#39;英语&#39;]+df[&#39;数学&#39;]\n    return df\ndf = df.apply(plus,axis=1)\n#排序\ndf.sort_values([&#39;总和&#39;], ascending=[False], inplace=True)\nprint(df.describe())\nprint(df)\n#导出数据\ndf.to_excel(&#39;C:&#47;Users&#47;shadie&#47;Desktop&#47;new.xlsx&#39;)","like_count":0},{"had_liked":false,"id":295068,"user_name":"FunLu","can_delete":false,"product_type":"c1","uid":1102518,"ip_address":"","ucode":"84BA5DE44307F6","user_header":"https://static001.geekbang.org/account/avatar/00/10/d2/b6/2bab2a8b.jpg","comment_is_top":false,"comment_ctime":1622204044,"is_pvip":false,"replies":null,"discussion_count":0,"race_medal":0,"score":14,"product_id":100021701,"comment_content":"import pandas as pd \nfrom pandas import DataFrame\n\nscore = DataFrame(pd.read_excel(&#39;scores.xlsx&#39;))\nprint(score)\n\n#清洗数据\nscore = score.drop_duplicates() #去除重复行\nprint(score)\nscore = score.fillna(value=0) #使用数字0填充数据表中空值\nprint(score)\n\ncls = score.columns #获取数据库表的列名索引\nprint(cls)   \nclst = cls.tolist()  #列名索引转换为列表\nprint(clst)\n\nscore[u&#39;总和&#39;] = score[clst[1]] + score[clst[2]] + score[clst[3]]\nprint(score)\n","like_count":0},{"had_liked":false,"id":288472,"user_name":"同心飞翔","can_delete":false,"product_type":"c1","uid":1351434,"ip_address":"","ucode":"01EE03B0DF81EF","user_header":"https://static001.geekbang.org/account/avatar/00/14/9f/0a/611030c3.jpg","comment_is_top":false,"comment_ctime":1618484763,"is_pvip":false,"replies":null,"discussion_count":0,"race_medal":0,"score":14,"product_id":100021701,"comment_content":"讲的简洁，赞一个","like_count":0},{"had_liked":false,"id":274023,"user_name":"要瘦的胖子👋🏼","can_delete":false,"product_type":"c1","uid":1527884,"ip_address":"","ucode":"598037BF56563C","user_header":"https://static001.geekbang.org/account/avatar/00/17/50/4c/22e7b5bf.jpg","comment_is_top":false,"comment_ctime":1610790356,"is_pvip":false,"replies":null,"discussion_count":0,"race_medal":0,"score":14,"product_id":100021701,"comment_content":"# -*- coding:utf-8 -*-\n&quot;&quot;&quot;\n作者：18371\n日期：2021年01月16日\n&quot;&quot;&quot;\n\nimport numpy as np\nimport pandas as pd\nfrom pandasql import sqldf, load_meat, load_births\n\nscore = pd.DataFrame([[66, 65, np.nan], [95, 85, 98], [95, 92, 96],\n                      [90, 88, 77], [80, 90, 90], [80, 90, 90]],\n                     index=[&#39;张飞&#39;, &#39;关羽&#39;, &#39;赵云&#39;, &#39;黄忠&#39;, &#39;典韦&#39;, &#39;典韦&#39;],\n                     columns=[&#39;语文&#39;, &#39;数学&#39;, &#39;英语&#39;])\n\nprint(score, &#39;\\n&#39;, score.shape)\n\nscore.drop_duplicates(inplace=True)\nprint(score)\n\nprint(score.isnull().any(axis=1))\n\n# score.drop(labels=score.index[score[&#39;英语&#39;].isnull()], axis=0, inplace=True)    # 删除缺失行\nscore.fillna(value={&#39;英语&#39;: score[&#39;英语&#39;].mean()}, inplace=True)    # 填充缺失行\nprint(score, &#39;\\n&#39;, score.shape)\n\nscore[&#39;total&#39;] = score.sum(axis=1)\nprint(score)\n\n\n# 输出结果\n语文  数学    英语\n张飞  66  65   NaN\n关羽  95  85  98.0\n赵云  95  92  96.0\n黄忠  90  88  77.0\n典韦  80  90  90.0\n典韦  80  90  90.0 \n (6, 3)\n    语文  数学    英语\n张飞  66  65   NaN\n关羽  95  85  98.0\n赵云  95  92  96.0\n黄忠  90  88  77.0\n典韦  80  90  90.0\n张飞     True\n关羽    False\n赵云    False\n黄忠    False\n典韦    False\ndtype: bool\n    语文  数学     英语\n张飞  66  65  90.25\n关羽  95  85  98.00\n赵云  95  92  96.00\n黄忠  90  88  77.00\n典韦  80  90  90.00 \n (5, 3)\n    语文  数学     英语   total\n张飞  66  65  90.25  221.25\n关羽  95  85  98.00  278.00\n赵云  95  92  96.00  283.00\n黄忠  90  88  77.00  255.00\n典韦  80  90  90.00  260.00","like_count":0},{"had_liked":false,"id":271860,"user_name":"听雨","can_delete":false,"product_type":"c1","uid":1022961,"ip_address":"","ucode":"1BCAE39A2A433E","user_header":"https://static001.geekbang.org/account/avatar/00/0f/9b/f1/7b3ac181.jpg","comment_is_top":false,"comment_ctime":1609844545,"is_pvip":false,"replies":null,"discussion_count":0,"race_medal":0,"score":14,"product_id":100021701,"comment_content":"import pandas as pd\n\ndf = DataFrame(pd.read_excel(&#39;&#47;Users&#47;zhuxd&#47;Downloads&#47;1.xlsx&#39;)) #读取Excel\ndf = df.drop_duplicates() #去重\ndf = df.fillna(0) #空值填充0\ndf[&#39;数学&#39;] = df[&#39;数学&#39;].astype(int) #转换成int\n# print (df.dtypes)\n\ndf[&#39;总分&#39;]=df.sum(axis=1) #增加一列按行求和\ndf.to_excel(&#39;&#47;Users&#47;zhuxd&#47;Downloads&#47;1-1.xlsx&#39;)\n\nprint (df)\nprint (df.describe().round(2))\n\n\n----运行结果----\n\n姓名  语文  英语  数学   总分\n0  张飞  66  65   0  131\n1  关羽  95  85  98  278\n2  赵云  95  92  96  283\n3  黄忠  90  88  77  255\n4  典韦  80  90  90  260\n\n          语文     英语     数学      总分\ncount   5.00   5.00   5.00    5.00\nmean   85.20  84.00  72.20  241.40\nstd    12.36  10.93  41.18   62.83\nmin    66.00  65.00   0.00  131.00\n25%    80.00  85.00  77.00  255.00\n50%    90.00  88.00  90.00  260.00\n75%    95.00  90.00  96.00  278.00\nmax    95.00  92.00  98.00  283.00","like_count":0},{"had_liked":false,"id":268974,"user_name":"健身咸鱼","can_delete":false,"product_type":"c1","uid":1528176,"ip_address":"","ucode":"415CBFF3F158F3","user_header":"https://static001.geekbang.org/account/avatar/00/17/51/70/68b3f0e6.jpg","comment_is_top":false,"comment_ctime":1608453357,"is_pvip":false,"replies":null,"discussion_count":0,"race_medal":0,"score":14,"product_id":100021701,"comment_content":"Pandas 中最主要的数据结构是 Series 和 DataFrame. Pandas 给我们提供了许多统计类的函数, 例如\n+ count()\n+ describe()\n+ min()\n+ max()\n+ sum()\n+ mean()\n+ median()\n+ var()\n+ std()\n+ argmin(), 最小值索引位置\n+ argmax()\n+ idxmin(), 最小值索引值\n+ idxmax()\n等.\n在数据清洗方面, 我们可以利用 df.drop()、df.drop_duplicates() 等函数帮助我们删除重复行或列的数据.\n\n\n练习题:\n\nimport pandas as pd\n\n\n\ndata = {\n    &#39;Chinese&#39;: [66, 95, 95, 90, 80, 80],\n    &#39;English&#39;: [65, 85, 92, 88, 90, 90],\n    &#39;Math&#39;: [&#39;NA&#39;, 98, 96, 77, 90, 90],\n}\n\n\ndf = DataFrame(data, \n                index=[&#39;ZhangFei&#39;, &#39;GuanYu&#39;, &#39;ZhaoYun&#39;, &#39;HuangZhong&#39;, &#39;Dianwei&#39;, &#39;DianWei&#39;], \n                columns=[&#39;Chinese&#39;, &#39;English&#39;, &#39;Math&#39;])\n\n# 去除重复值\ndf = df.drop_duplicates()\n\n# 插值替补\ndf[&#39;Math&#39;][0] = df[&#39;Math&#39;][1::].mean()\n\n# 新增一列并求三个成绩之和\ndf[&#39;Sum&#39;] = df[&#39;Chinese&#39;] + df[&#39;English&#39;] + df[&#39;Math&#39;]","like_count":0},{"had_liked":false,"id":197412,"user_name":"叮当喵","can_delete":false,"product_type":"c1","uid":1236607,"ip_address":"","ucode":"60E6EA076932CB","user_header":"https://static001.geekbang.org/account/avatar/00/12/de/7f/079356c2.jpg","comment_is_top":false,"comment_ctime":1585374969,"is_pvip":false,"replies":null,"discussion_count":0,"race_medal":0,"score":14,"product_id":100021701,"comment_content":"https:&#47;&#47;mubu.com&#47;docGH5QSZ1Yih","like_count":0},{"had_liked":false,"id":179276,"user_name":"will","can_delete":false,"product_type":"c1","uid":1750093,"ip_address":"","ucode":"A36CADCB62BFB5","user_header":"https://static001.geekbang.org/account/avatar/00/1a/b4/4d/f072c7f9.jpg","comment_is_top":false,"comment_ctime":1581949920,"is_pvip":false,"replies":null,"discussion_count":0,"race_medal":0,"score":14,"product_id":100021701,"comment_content":"data = {&#39;Chinese&#39;: [66, 95, 93, 90,80],&#39;English&#39;: [65, 85, 92, 88, 90],&#39;Math&#39;: [np.nan, 98, 96, 77, 90]}\ndf2 =pd.DataFrame(data, index=[&#39;ZhangFei&#39;, &#39;GuanYu&#39;, &#39;ZhaoYun&#39;, &#39;HuangZhong&#39;, &#39;DianWei&#39;], columns=[&#39;English&#39;, &#39;Math&#39;, &#39;Chinese&#39;])\ndf2=df2.replace(np.nan,0)\ndf2[&quot;求和&quot;]=df2[&quot;Chinese&quot;]+df2[&quot;English&quot;]+df2[&quot;Math&quot;]","like_count":0},{"had_liked":false,"id":175853,"user_name":"鱼非子","can_delete":false,"product_type":"c1","uid":1818595,"ip_address":"","ucode":"BB76AE2CB4D680","user_header":"https://static001.geekbang.org/account/avatar/00/1b/bf/e3/2aa8ec84.jpg","comment_is_top":false,"comment_ctime":1580870486,"is_pvip":false,"replies":null,"discussion_count":0,"race_medal":0,"score":14,"product_id":100021701,"comment_content":"# -*- coding: utf-8 -*\n\nimport numpy as np\n\nimport pandas as pd\nimport matplotlib.pyplot as plt\n\nvalues = {&#39;chinese&#39;: [66,95,95,90,80,80], &#39;english&#39;:[65,85,92,88,90,90],\n          &#39;math&#39;:[None,98,96,77,90,90]}\ndf1 = pd.DataFrame(values)\ndf2 = pd.DataFrame(values,index=[&#39;zhangfei&#39;,&#39;guanyu&#39;,&#39;zhaoyun&#39;,&#39;huangzhong&#39;,\n                                &#39;dianwei&#39;,&#39;dianwei&#39;])\n\n# print(df1)\n# print(df2)\n\n#去除重复列\ndf3 = pd.DataFrame.drop_duplicates(df2)\n#查看统计信息\nprint(df3.describe())\n# print(df3)\nprint(df3.isnull())\n#处理缺失值\ndf3.fillna(df3[&#39;math&#39;].mean(),inplace=True)\n\ndf3[&#39;total&#39;] = df3[&#39;chinese&#39;] + df3[&#39;english&#39;] + df3[&#39;math&#39;]\nprint(df3)\n\n","like_count":0},{"had_liked":false,"id":170687,"user_name":"爬行的蜗牛","can_delete":false,"product_type":"c1","uid":1033956,"ip_address":"","ucode":"6623B62DE63CE9","user_header":"http://thirdwx.qlogo.cn/mmopen/vi_32/QD6bf8hkS5dHrabdW7M7Oo9An1Oo3QSxqoySJMDh7GTraxFRX77VZ2HZ13x3R4EVYddIGXicRRDAc7V9z5cLDlA/132","comment_is_top":false,"comment_ctime":1578665582,"is_pvip":false,"replies":null,"discussion_count":0,"race_medal":0,"score":14,"product_id":100021701,"comment_content":"import pandas as pd\nimport numpy\nfrom pandas import Series, DataFrame\ndata={&#39;语文&#39;:[66, 95, 95, 90, 80, 80],&#39;英语&#39;:[65, 85, 92, 88, 90,90], &#39;数学&#39;:[ None, 98, 96, 77, 90, 90]}\ndf1 = DataFrame(data, index=[&#39;张飞&#39;, &#39;关羽&#39;, &#39;赵云&#39;,&#39;刘备&#39;,&#39;典韦&#39;,&#39;典韦&#39;], columns=[&#39;语文&#39;,&#39;英语&#39;,&#39;数学&#39;])\ndf1 = df1.drop_duplicates()\n#df1.dropna()\ndf1.fillna(df1.mean(axis = 0))\ndf1","like_count":0},{"had_liked":false,"id":170618,"user_name":"苹果","can_delete":false,"product_type":"c1","uid":1761988,"ip_address":"","ucode":"5D0FA9D8560FD8","user_header":"https://static001.geekbang.org/account/avatar/00/1a/e2/c4/25acaa38.jpg","comment_is_top":false,"comment_ctime":1578644505,"is_pvip":false,"replies":null,"discussion_count":0,"race_medal":0,"score":14,"product_id":100021701,"comment_content":"# -*- coding: utf-8 -*-\nfrom pandas import Series,DataFrame\ndata = {&#39;Chinese&#39;: [66, 95, 95,90, 80,80],&#39;English&#39;: [65, 85, 92, 88, 90,90],\\\n        &#39;Math&#39;: [None,98, 96, 77, 90,90]}\ndf1 = DataFrame(data, index=[&#39;ZhangFei&#39;, &#39;GuanYu&#39;, &#39;ZhaoYun&#39;, &#39;HuangZhong&#39;,\\\n                &#39;DianWei&#39;,&#39;DianWei&#39;], columns=[&#39;Chinese&#39;,&#39;English&#39;,&#39;Math&#39;])\n# df3 = df3.drop(index=[&#39;guanyu&#39;])\ndf2 = df1.drop_duplicates()\ndf2.rename(columns={&#39;Chinese&#39;:&#39;语文&#39;,&#39;English&#39;:&#39;英语&#39;,&#39;Math&#39;:&#39;数学&#39;},inplace=True)\ndf2[&quot;total_score&quot;] = df2.sum(axis=1)\n# df1 = df1.apply(sum_score,axis=1)\ndf2[&#39;数学&#39;].fillna(df2[&#39;数学&#39;].mean(), inplace=True)\nprint(df2)\n","like_count":0},{"had_liked":false,"id":295068,"user_name":"FunLu","can_delete":false,"product_type":"c1","uid":1102518,"ip_address":"","ucode":"84BA5DE44307F6","user_header":"https://static001.geekbang.org/account/avatar/00/10/d2/b6/2bab2a8b.jpg","comment_is_top":false,"comment_ctime":1622204044,"is_pvip":false,"replies":null,"discussion_count":0,"race_medal":0,"score":14,"product_id":100021701,"comment_content":"import pandas as pd \nfrom pandas import DataFrame\n\nscore = DataFrame(pd.read_excel(&#39;scores.xlsx&#39;))\nprint(score)\n\n#清洗数据\nscore = score.drop_duplicates() #去除重复行\nprint(score)\nscore = score.fillna(value=0) #使用数字0填充数据表中空值\nprint(score)\n\ncls = score.columns #获取数据库表的列名索引\nprint(cls)   \nclst = cls.tolist()  #列名索引转换为列表\nprint(clst)\n\nscore[u&#39;总和&#39;] = score[clst[1]] + score[clst[2]] + score[clst[3]]\nprint(score)\n","like_count":0},{"had_liked":false,"id":288472,"user_name":"同心飞翔","can_delete":false,"product_type":"c1","uid":1351434,"ip_address":"","ucode":"01EE03B0DF81EF","user_header":"https://static001.geekbang.org/account/avatar/00/14/9f/0a/611030c3.jpg","comment_is_top":false,"comment_ctime":1618484763,"is_pvip":false,"replies":null,"discussion_count":0,"race_medal":0,"score":14,"product_id":100021701,"comment_content":"讲的简洁，赞一个","like_count":0},{"had_liked":false,"id":274023,"user_name":"要瘦的胖子👋🏼","can_delete":false,"product_type":"c1","uid":1527884,"ip_address":"","ucode":"598037BF56563C","user_header":"https://static001.geekbang.org/account/avatar/00/17/50/4c/22e7b5bf.jpg","comment_is_top":false,"comment_ctime":1610790356,"is_pvip":false,"replies":null,"discussion_count":0,"race_medal":0,"score":14,"product_id":100021701,"comment_content":"# -*- coding:utf-8 -*-\n&quot;&quot;&quot;\n作者：18371\n日期：2021年01月16日\n&quot;&quot;&quot;\n\nimport numpy as np\nimport pandas as pd\nfrom pandasql import sqldf, load_meat, load_births\n\nscore = pd.DataFrame([[66, 65, np.nan], [95, 85, 98], [95, 92, 96],\n                      [90, 88, 77], [80, 90, 90], [80, 90, 90]],\n                     index=[&#39;张飞&#39;, &#39;关羽&#39;, &#39;赵云&#39;, &#39;黄忠&#39;, &#39;典韦&#39;, &#39;典韦&#39;],\n                     columns=[&#39;语文&#39;, &#39;数学&#39;, &#39;英语&#39;])\n\nprint(score, &#39;\\n&#39;, score.shape)\n\nscore.drop_duplicates(inplace=True)\nprint(score)\n\nprint(score.isnull().any(axis=1))\n\n# score.drop(labels=score.index[score[&#39;英语&#39;].isnull()], axis=0, inplace=True)    # 删除缺失行\nscore.fillna(value={&#39;英语&#39;: score[&#39;英语&#39;].mean()}, inplace=True)    # 填充缺失行\nprint(score, &#39;\\n&#39;, score.shape)\n\nscore[&#39;total&#39;] = score.sum(axis=1)\nprint(score)\n\n\n# 输出结果\n语文  数学    英语\n张飞  66  65   NaN\n关羽  95  85  98.0\n赵云  95  92  96.0\n黄忠  90  88  77.0\n典韦  80  90  90.0\n典韦  80  90  90.0 \n (6, 3)\n    语文  数学    英语\n张飞  66  65   NaN\n关羽  95  85  98.0\n赵云  95  92  96.0\n黄忠  90  88  77.0\n典韦  80  90  90.0\n张飞     True\n关羽    False\n赵云    False\n黄忠    False\n典韦    False\ndtype: bool\n    语文  数学     英语\n张飞  66  65  90.25\n关羽  95  85  98.00\n赵云  95  92  96.00\n黄忠  90  88  77.00\n典韦  80  90  90.00 \n (5, 3)\n    语文  数学     英语   total\n张飞  66  65  90.25  221.25\n关羽  95  85  98.00  278.00\n赵云  95  92  96.00  283.00\n黄忠  90  88  77.00  255.00\n典韦  80  90  90.00  260.00","like_count":0},{"had_liked":false,"id":271860,"user_name":"听雨","can_delete":false,"product_type":"c1","uid":1022961,"ip_address":"","ucode":"1BCAE39A2A433E","user_header":"https://static001.geekbang.org/account/avatar/00/0f/9b/f1/7b3ac181.jpg","comment_is_top":false,"comment_ctime":1609844545,"is_pvip":false,"replies":null,"discussion_count":0,"race_medal":0,"score":14,"product_id":100021701,"comment_content":"import pandas as pd\n\ndf = DataFrame(pd.read_excel(&#39;&#47;Users&#47;zhuxd&#47;Downloads&#47;1.xlsx&#39;)) #读取Excel\ndf = df.drop_duplicates() #去重\ndf = df.fillna(0) #空值填充0\ndf[&#39;数学&#39;] = df[&#39;数学&#39;].astype(int) #转换成int\n# print (df.dtypes)\n\ndf[&#39;总分&#39;]=df.sum(axis=1) #增加一列按行求和\ndf.to_excel(&#39;&#47;Users&#47;zhuxd&#47;Downloads&#47;1-1.xlsx&#39;)\n\nprint (df)\nprint (df.describe().round(2))\n\n\n----运行结果----\n\n姓名  语文  英语  数学   总分\n0  张飞  66  65   0  131\n1  关羽  95  85  98  278\n2  赵云  95  92  96  283\n3  黄忠  90  88  77  255\n4  典韦  80  90  90  260\n\n          语文     英语     数学      总分\ncount   5.00   5.00   5.00    5.00\nmean   85.20  84.00  72.20  241.40\nstd    12.36  10.93  41.18   62.83\nmin    66.00  65.00   0.00  131.00\n25%    80.00  85.00  77.00  255.00\n50%    90.00  88.00  90.00  260.00\n75%    95.00  90.00  96.00  278.00\nmax    95.00  92.00  98.00  283.00","like_count":0},{"had_liked":false,"id":268974,"user_name":"健身咸鱼","can_delete":false,"product_type":"c1","uid":1528176,"ip_address":"","ucode":"415CBFF3F158F3","user_header":"https://static001.geekbang.org/account/avatar/00/17/51/70/68b3f0e6.jpg","comment_is_top":false,"comment_ctime":1608453357,"is_pvip":false,"replies":null,"discussion_count":0,"race_medal":0,"score":14,"product_id":100021701,"comment_content":"Pandas 中最主要的数据结构是 Series 和 DataFrame. Pandas 给我们提供了许多统计类的函数, 例如\n+ count()\n+ describe()\n+ min()\n+ max()\n+ sum()\n+ mean()\n+ median()\n+ var()\n+ std()\n+ argmin(), 最小值索引位置\n+ argmax()\n+ idxmin(), 最小值索引值\n+ idxmax()\n等.\n在数据清洗方面, 我们可以利用 df.drop()、df.drop_duplicates() 等函数帮助我们删除重复行或列的数据.\n\n\n练习题:\n\nimport pandas as pd\n\n\n\ndata = {\n    &#39;Chinese&#39;: [66, 95, 95, 90, 80, 80],\n    &#39;English&#39;: [65, 85, 92, 88, 90, 90],\n    &#39;Math&#39;: [&#39;NA&#39;, 98, 96, 77, 90, 90],\n}\n\n\ndf = DataFrame(data, \n                index=[&#39;ZhangFei&#39;, &#39;GuanYu&#39;, &#39;ZhaoYun&#39;, &#39;HuangZhong&#39;, &#39;Dianwei&#39;, &#39;DianWei&#39;], \n                columns=[&#39;Chinese&#39;, &#39;English&#39;, &#39;Math&#39;])\n\n# 去除重复值\ndf = df.drop_duplicates()\n\n# 插值替补\ndf[&#39;Math&#39;][0] = df[&#39;Math&#39;][1::].mean()\n\n# 新增一列并求三个成绩之和\ndf[&#39;Sum&#39;] = df[&#39;Chinese&#39;] + df[&#39;English&#39;] + df[&#39;Math&#39;]","like_count":0},{"had_liked":false,"id":197412,"user_name":"叮当喵","can_delete":false,"product_type":"c1","uid":1236607,"ip_address":"","ucode":"60E6EA076932CB","user_header":"https://static001.geekbang.org/account/avatar/00/12/de/7f/079356c2.jpg","comment_is_top":false,"comment_ctime":1585374969,"is_pvip":false,"replies":null,"discussion_count":0,"race_medal":0,"score":14,"product_id":100021701,"comment_content":"https:&#47;&#47;mubu.com&#47;docGH5QSZ1Yih","like_count":0},{"had_liked":false,"id":179276,"user_name":"will","can_delete":false,"product_type":"c1","uid":1750093,"ip_address":"","ucode":"A36CADCB62BFB5","user_header":"https://static001.geekbang.org/account/avatar/00/1a/b4/4d/f072c7f9.jpg","comment_is_top":false,"comment_ctime":1581949920,"is_pvip":false,"replies":null,"discussion_count":0,"race_medal":0,"score":14,"product_id":100021701,"comment_content":"data = {&#39;Chinese&#39;: [66, 95, 93, 90,80],&#39;English&#39;: [65, 85, 92, 88, 90],&#39;Math&#39;: [np.nan, 98, 96, 77, 90]}\ndf2 =pd.DataFrame(data, index=[&#39;ZhangFei&#39;, &#39;GuanYu&#39;, &#39;ZhaoYun&#39;, &#39;HuangZhong&#39;, &#39;DianWei&#39;], columns=[&#39;English&#39;, &#39;Math&#39;, &#39;Chinese&#39;])\ndf2=df2.replace(np.nan,0)\ndf2[&quot;求和&quot;]=df2[&quot;Chinese&quot;]+df2[&quot;English&quot;]+df2[&quot;Math&quot;]","like_count":0},{"had_liked":false,"id":175853,"user_name":"鱼非子","can_delete":false,"product_type":"c1","uid":1818595,"ip_address":"","ucode":"BB76AE2CB4D680","user_header":"https://static001.geekbang.org/account/avatar/00/1b/bf/e3/2aa8ec84.jpg","comment_is_top":false,"comment_ctime":1580870486,"is_pvip":false,"replies":null,"discussion_count":0,"race_medal":0,"score":14,"product_id":100021701,"comment_content":"# -*- coding: utf-8 -*\n\nimport numpy as np\n\nimport pandas as pd\nimport matplotlib.pyplot as plt\n\nvalues = {&#39;chinese&#39;: [66,95,95,90,80,80], &#39;english&#39;:[65,85,92,88,90,90],\n          &#39;math&#39;:[None,98,96,77,90,90]}\ndf1 = pd.DataFrame(values)\ndf2 = pd.DataFrame(values,index=[&#39;zhangfei&#39;,&#39;guanyu&#39;,&#39;zhaoyun&#39;,&#39;huangzhong&#39;,\n                                &#39;dianwei&#39;,&#39;dianwei&#39;])\n\n# print(df1)\n# print(df2)\n\n#去除重复列\ndf3 = pd.DataFrame.drop_duplicates(df2)\n#查看统计信息\nprint(df3.describe())\n# print(df3)\nprint(df3.isnull())\n#处理缺失值\ndf3.fillna(df3[&#39;math&#39;].mean(),inplace=True)\n\ndf3[&#39;total&#39;] = df3[&#39;chinese&#39;] + df3[&#39;english&#39;] + df3[&#39;math&#39;]\nprint(df3)\n\n","like_count":0},{"had_liked":false,"id":170687,"user_name":"爬行的蜗牛","can_delete":false,"product_type":"c1","uid":1033956,"ip_address":"","ucode":"6623B62DE63CE9","user_header":"http://thirdwx.qlogo.cn/mmopen/vi_32/QD6bf8hkS5dHrabdW7M7Oo9An1Oo3QSxqoySJMDh7GTraxFRX77VZ2HZ13x3R4EVYddIGXicRRDAc7V9z5cLDlA/132","comment_is_top":false,"comment_ctime":1578665582,"is_pvip":false,"replies":null,"discussion_count":0,"race_medal":0,"score":14,"product_id":100021701,"comment_content":"import pandas as pd\nimport numpy\nfrom pandas import Series, DataFrame\ndata={&#39;语文&#39;:[66, 95, 95, 90, 80, 80],&#39;英语&#39;:[65, 85, 92, 88, 90,90], &#39;数学&#39;:[ None, 98, 96, 77, 90, 90]}\ndf1 = DataFrame(data, index=[&#39;张飞&#39;, &#39;关羽&#39;, &#39;赵云&#39;,&#39;刘备&#39;,&#39;典韦&#39;,&#39;典韦&#39;], columns=[&#39;语文&#39;,&#39;英语&#39;,&#39;数学&#39;])\ndf1 = df1.drop_duplicates()\n#df1.dropna()\ndf1.fillna(df1.mean(axis = 0))\ndf1","like_count":0},{"had_liked":false,"id":170618,"user_name":"苹果","can_delete":false,"product_type":"c1","uid":1761988,"ip_address":"","ucode":"5D0FA9D8560FD8","user_header":"https://static001.geekbang.org/account/avatar/00/1a/e2/c4/25acaa38.jpg","comment_is_top":false,"comment_ctime":1578644505,"is_pvip":false,"replies":null,"discussion_count":0,"race_medal":0,"score":14,"product_id":100021701,"comment_content":"# -*- coding: utf-8 -*-\nfrom pandas import Series,DataFrame\ndata = {&#39;Chinese&#39;: [66, 95, 95,90, 80,80],&#39;English&#39;: [65, 85, 92, 88, 90,90],\\\n        &#39;Math&#39;: [None,98, 96, 77, 90,90]}\ndf1 = DataFrame(data, index=[&#39;ZhangFei&#39;, &#39;GuanYu&#39;, &#39;ZhaoYun&#39;, &#39;HuangZhong&#39;,\\\n                &#39;DianWei&#39;,&#39;DianWei&#39;], columns=[&#39;Chinese&#39;,&#39;English&#39;,&#39;Math&#39;])\n# df3 = df3.drop(index=[&#39;guanyu&#39;])\ndf2 = df1.drop_duplicates()\ndf2.rename(columns={&#39;Chinese&#39;:&#39;语文&#39;,&#39;English&#39;:&#39;英语&#39;,&#39;Math&#39;:&#39;数学&#39;},inplace=True)\ndf2[&quot;total_score&quot;] = df2.sum(axis=1)\n# df1 = df1.apply(sum_score,axis=1)\ndf2[&#39;数学&#39;].fillna(df2[&#39;数学&#39;].mean(), inplace=True)\nprint(df2)\n","like_count":0},{"had_liked":false,"id":170411,"user_name":"爬行的蜗牛","can_delete":false,"product_type":"c1","uid":1033956,"ip_address":"","ucode":"6623B62DE63CE9","user_header":"http://thirdwx.qlogo.cn/mmopen/vi_32/QD6bf8hkS5dHrabdW7M7Oo9An1Oo3QSxqoySJMDh7GTraxFRX77VZ2HZ13x3R4EVYddIGXicRRDAc7V9z5cLDlA/132","comment_is_top":false,"comment_ctime":1578589406,"is_pvip":false,"replies":null,"discussion_count":0,"race_medal":0,"score":15,"product_id":100021701,"comment_content":"data={&#39;语文&#39;:[66, 95, 95, 90, 80, 80],&#39;英语&#39;:[65, 85, 92, 88, 90,90], &#39;数学&#39;:[&#39;&#39;, 98, 96, 77, 90, 90]}\ndf1 = DataFrame(data, index=[&#39;张飞&#39;, &#39;关羽&#39;, &#39;赵云&#39;,&#39;刘备&#39;,&#39;典韦&#39;,&#39;典韦&#39;], columns=[&#39;语文&#39;,&#39;英语&#39;,&#39;数学&#39;])\ndf1 = df1.drop_duplicates()\ndf1.dropna() # 删除或则填充， 我选择删除， 貌似删除含有Null 的行有点问题\nprint(df1)","like_count":0},{"had_liked":false,"id":168571,"user_name":"强者自强","can_delete":false,"product_type":"c1","uid":1362648,"ip_address":"","ucode":"391B934CC10342","user_header":"https://static001.geekbang.org/account/avatar/00/14/ca/d8/767d8e6e.jpg","comment_is_top":false,"comment_ctime":1578112830,"is_pvip":false,"replies":null,"discussion_count":0,"race_medal":0,"score":15,"product_id":100021701,"comment_content":"之前代码没写注释，这个习惯不好，看了评论里的代码，写的真的好，认识到自己有很多不足的地方，还要多学习这些好的代码。\nimport pandas as pandas \nimport numpy as np\nfrom pandas import DataFrame\n#表数据\ndata = {&#39;names&#39;:[&#39;张飞&#39;,&#39;关羽&#39;,&#39;赵云&#39;,&#39;黄忠&#39;,&#39;典韦&#39;,&#39;典韦&#39;],&#39;Chinese&#39;:[66,95,95,90,80,80],&#39;English&#39;:[65,85,92,88,90,90]\n      ,&#39;Math&#39;:[np.NaN,98,96,77,90,90]}\n#建表\ndf = pd.DataFrame(data,index=[0,1,2,3,4,5],columns=[&#39;names&#39;,&#39;Chinese&#39;,&#39;English&#39;,&#39;Math&#39;])\n#将列字段改成中文\ndf = df.rename(columns={&#39;Chinese&#39;:&#39;语文&#39;,&#39;English&#39;:&#39;英语&#39;,&#39;Math&#39;:&#39;数学&#39;})\n#去重复行\ndf = df.drop_duplicates()\n#查空列\nisNaN = df.isnull().any()\n#用平均值补全空值\ndf[&#39;数学&#39;][0]=np.mean(df[:][&#39;数学&#39;])\n#定义函数增加新列\ndef muti_sum(df):\n    df[&#39;total&#39;] = df[&#39;数学&#39;]+df[&#39;英语&#39;]+df[&#39;语文&#39;]\n    return df\n#为数据表增加新列\ndf = df.apply(muti_sum,axis=1)\nprint(df)","like_count":0},{"had_liked":false,"id":152842,"user_name":"nqluo","can_delete":false,"product_type":"c1","uid":1005773,"ip_address":"","ucode":"68AB4D0B1A2E96","user_header":"https://static001.geekbang.org/account/avatar/00/0f/58/cd/59512aff.jpg","comment_is_top":false,"comment_ctime":1574087759,"is_pvip":false,"replies":null,"discussion_count":0,"race_medal":0,"score":15,"product_id":100021701,"comment_content":"#补NaN\ncols = [&#39;Chinese&#39;,&#39;English&#39;,&#39;Math&#39;]\nfor col in cols:\n    if df1[col].isnull().sum().sum():\n        #print(col)\n        #print(df1[col].isnull().sum().sum())\n        df1[col].fillna(df1[col].mean(), inplace=True)\n        #print(df1[col].isnull().sum().sum())\n        \nprint(df1)","like_count":0},{"had_liked":false,"id":148540,"user_name":"J.Smile","can_delete":false,"product_type":"c1","uid":1336475,"ip_address":"","ucode":"C4D98DFDBF7584","user_header":"https://static001.geekbang.org/account/avatar/00/14/64/9b/d1ab239e.jpg","comment_is_top":false,"comment_ctime":1573027437,"is_pvip":false,"replies":null,"discussion_count":0,"race_medal":0,"score":15,"product_id":100021701,"comment_content":"“其中 axis=1 代表按照列为轴进行操作，axis=0 代表按照行为轴进行操作，args 是传递的两个参数，即 n=2, m=3，在 plus 函数中使用到了 n 和 m，从而生成新的 df“\n------------------------------------------------------------------------------------\n老师，axis的解释是不是写反了","like_count":0},{"had_liked":false,"id":126705,"user_name":"Geek_545e3b","can_delete":false,"product_type":"c1","uid":1628619,"ip_address":"","ucode":"9F11D3604EE9D2","user_header":"http://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTKWbUlKibZs6Qy1q1SuRfyew09nKownad6JrNicJROsssCdib9hdHpG7vburY5rWdxU6YGrgHg0VVsaA/132","comment_is_top":false,"comment_ctime":1566454077,"is_pvip":false,"replies":null,"discussion_count":0,"race_medal":0,"score":15,"product_id":100021701,"comment_content":"我想了两个办法，有一个是借鉴了别人的语句，老师帮我看看第二个办法pandas中有没有方法或者函数帮我简化一下循环，我试了很多，只能想到将df.isnull 的值放到列表来进行条件判断\n第一个方法：\nimport pandas as pd\r\nfrom pandas import DataFrame\r\ndata={&#39;Chinese&#39;:[66,95,93,90,80,80],&#39;English&#39;:[65,85,92,88,90,90],&#39;Math&#39;:[None,98,96,77,90,90]}\r\nnames=[&#39;Zhangfei&#39;,&#39;Guangyu&#39;,&#39;Zhaoyun&#39;,&#39;Huangzhong&#39;,&#39;Dianwei&#39;,&#39;Dianwei&#39;]\r\nsubjects=[&#39;Chinese&#39;,&#39;English&#39;,&#39;Math&#39;]\r\ndf=DataFrame(data,index=names,columns=subjects)\ndf=df.drop_duplicates()\r\nprint(df)\r\n# df=df.rename(columns={&#39;Chinese&#39;:&#39;语文&#39;,&#39;English&#39;:&#39;英语&#39;,&#39;Math&#39;:&#39;数学&#39;}),下面inplace可以在原数据修改，不需要赋值\r\ndf.rename(columns={&#39;Chinese&#39;:&#39;语文&#39;,&#39;English&#39;:&#39;英语&#39;,&#39;Math&#39;:&#39;数学&#39;},inplace=True)\r\njudge_kemu=[]\nfor x in df.isnull().any():\r\n    judge_kemu.append(x)\n#如果数据量大，自动填充空白值\nif True in judge_kemu:\r\n    kemu=[]\r\n    for b in df:\r\n        if df[b].isnull().any():\r\n            kemu.append(b)\r\n    for item in kemu:\r\n        df.fillna(df[item].mean(),inplace=True)\ndf[&#39;总分&#39;]=df.sum(axis=1)\nprint(df.describe())\n第二个方法：\nimport pandas as pd\r\nfrom pandas import DataFrame\r\ndata={&#39;Chinese&#39;:[66,95,93,90,80,80],&#39;English&#39;:[65,85,92,88,90,90],&#39;Math&#39;:[None,98,96,77,90,90]}\r\nnames=[&#39;Zhangfei&#39;,&#39;Guangyu&#39;,&#39;Zhaoyun&#39;,&#39;Huangzhong&#39;,&#39;Dianwei&#39;,&#39;Dianwei&#39;]\r\nsubjects=[&#39;Chinese&#39;,&#39;English&#39;,&#39;Math&#39;]\r\ndf=DataFrame(data,index=names,columns=subjects)\ndf=df.drop_duplicates()\r\nprint(df)\r\n# df=df.rename(columns={&#39;Chinese&#39;:&#39;语文&#39;,&#39;English&#39;:&#39;英语&#39;,&#39;Math&#39;:&#39;数学&#39;}),下面inplace可以在原数据修改，不需要赋值\r\ndf.rename(columns={&#39;Chinese&#39;:&#39;语文&#39;,&#39;English&#39;:&#39;英语&#39;,&#39;Math&#39;:&#39;数学&#39;},inplace=True)\r\njudge_kemu=[]\nfor x in df.isnull().any():\r\n    judge_kemu.append(x)\n#如果数据量大，自动填充空白值\nif True in judge_kemu:\r\n    kemu=[]\r\n    for b in df:\r\n        if df[b].isnull().any():\r\n            kemu.append(b)\n       for item in kemu:\r\n           average=df[item].mean()\r\n           for name in df.index:\r\n               if str(df[item][name])==&#39;nan&#39;:\r\n                   df[item][name]=average\n\ndf[&#39;总分&#39;]=df.sum(axis=1)\nprint(df.describe())","like_count":0},{"had_liked":false,"id":110704,"user_name":"xqs42b","can_delete":false,"product_type":"c1","uid":1590102,"ip_address":"","ucode":"E1B85D10E44672","user_header":"https://static001.geekbang.org/account/avatar/00/18/43/56/3572a20c.jpg","comment_is_top":false,"comment_ctime":1562316766,"is_pvip":false,"replies":null,"discussion_count":0,"race_medal":0,"score":15,"product_id":100021701,"comment_content":"我提个小小的建议，希望老师说明一下执行环境，还有就是strip, apply, upper, title, lower,....是python函数， 还是pandas里面的呢！","like_count":0},{"had_liked":false,"id":108539,"user_name":"从前从前","can_delete":false,"product_type":"c1","uid":1575475,"ip_address":"","ucode":"73ED0B74D9DCB0","user_header":"https://static001.geekbang.org/account/avatar/00/18/0a/33/292a3f4b.jpg","comment_is_top":false,"comment_ctime":1561796728,"is_pvip":false,"replies":null,"discussion_count":0,"race_medal":0,"score":15,"product_id":100021701,"comment_content":"import pandas as pd\nfrom pandas import DataFrame,Series\n\n\ndata = {&#39;Chinese&#39;:[66,95,95,90,80,80],&#39;Math&#39;:[None,98,96,77,90,90],&#39;English&#39;:[65,85,92,88,90,90]}\ndf = DataFrame(data,index = [&#39;张飞&#39;,&#39;关羽&#39;,&#39;赵云&#39;,&#39;黄忠&#39;,&#39;典韦&#39;,&#39;典韦&#39;],columns=[&#39;Chinese&#39;,&#39;English&#39;,&#39;Math&#39;])\n#去除重复\ndf = df.drop_duplicates()\n# 修改列名\ndf.rename(columns={&#39;Chinese&#39;:&#39;语文&#39;,&#39;Math&#39;:&#39;数学&#39;,&#39;English&#39;:&#39;英语&#39;},inplace=True)\n#使用平均值填补空值\ndf[&#39;数学&#39;].fillna(df[&#39;数学&#39;].mean(),inplace=True)\n#计算总分\ndf[&#39;总和&#39;] = df[&#39;语文&#39;]+df[&#39;数学&#39;] + df[&#39;英语&#39;]\n#排名\ndf.sort_values([&#39;总和&#39;],ascending=[False],inplace=True)\n\nprint(df)\n\n# 想请教两个问题\n# 1、想在名字那列的列名改为姓名，要怎么改呢\n# 2、已经改完列名了，接下来想用SQL的方式做出练习题中的答案，要怎么做呢","like_count":0},{"had_liked":false,"id":107469,"user_name":"lycan","can_delete":false,"product_type":"c1","uid":1587048,"ip_address":"","ucode":"F984DBF4515EEA","user_header":"https://static001.geekbang.org/account/avatar/00/18/37/68/afe6c6f8.jpg","comment_is_top":false,"comment_ctime":1561541038,"is_pvip":false,"replies":null,"discussion_count":0,"race_medal":0,"score":15,"product_id":100021701,"comment_content":"import pandas as pd\nimport numpy as np\nfrom pandas import DataFrame,Series\n#定义DataFrame\ndf = {&#39;Chinese&#39;:[95,95,95,90,80,80],&#39;english&#39;:[65,85,92,88,90,90],&#39;math&#39;:[None,98,96,77,90,90]}\nmy_frame = pd.DataFrame(df,index=[&#39;ZhangFei&#39;,&#39;GuanYu&#39;,&#39;ZhaoYun&#39;,&#39;HuangZhong&#39;,&#39;DianWei&#39;,&#39;DianWei&#39;])\ndef clean(df):\n    df = pd.DataFrame(df)\n    #去除重复值\n    df = df.drop_duplicates()\n    #检查是否包含空值，\n    result_series = df.isnull().any()\n    #print(result_series)\n    #获取包含空值的列名\n    NaN_index = result_series[result_series.values==True].index\n    #print(NaN_index)\n    #将平均值添加到空值中\n    for item in NaN_index:\n        df[item].fillna(df[item].mean(),inplace=True)\n    #添加一列，算出总成绩\n    df[&#39;score&#39;] = df.sum(axis=1)\n    #排序\n    df.sort_values(&#39;score&#39;,ascending=False,inplace=True)\n    return df\nmy_frame = clean(my_frame)\nprint(my_frame)\n陈老师您好，上边是我写的作业，有个问题再最后调用我定义的clean方法的时候，clean(my_frame)是没有报错的，但是使用my_frame.apply(clean)就会报好多错，希望您能解答一下，谢谢","like_count":0},{"had_liked":false,"id":107364,"user_name":"David","can_delete":false,"product_type":"c1","uid":1506673,"ip_address":"","ucode":"5154BE2B2DF689","user_header":"https://static001.geekbang.org/account/avatar/00/16/fd/71/2c66cbdd.jpg","comment_is_top":false,"comment_ctime":1561519530,"is_pvip":false,"replies":null,"discussion_count":0,"race_medal":0,"score":15,"product_id":100021701,"comment_content":"def plus(df,n,m):\n    df[&#39;new1&#39;] = (df[u&#39;语文&#39;]+df[u&#39;英语&#39;]) * m\n    df[&#39;new2&#39;] = (df[u&#39;语文&#39;]+df[u&#39;英语&#39;]) * n\n    return df\ndf1 = df1.apply(plus,axis=1,args=(2,3,))\n最后args这里为什么不能写（scores,2,3）呢？","like_count":0},{"had_liked":false,"id":105749,"user_name":"薛定谔的猫","can_delete":false,"product_type":"c1","uid":1467230,"ip_address":"","ucode":"F2DEF41FDA2D05","user_header":"https://static001.geekbang.org/account/avatar/00/16/63/5e/b413dee1.jpg","comment_is_top":false,"comment_ctime":1561080678,"is_pvip":false,"replies":null,"discussion_count":0,"race_medal":0,"score":15,"product_id":100021701,"comment_content":"data = {&#39;Chinese&#39;: [&#39;ss&#39;, &#39;nf&#39;,&#39;&#39;,&#39;  ds&#39;,&#39;cd  &#39;],&#39;English&#39;: [&#39;sd&#39;, &#39;ws&#39;, &#39;cd&#39;, &#39;sa&#39;, &#39;fv&#39;]}\ndf5 = DataFrame(data, index=[&#39;ZhangFei&#39;, &#39;GuanYu&#39;, &#39;ZhaoYun&#39;, &#39;HuangZhong&#39;, &#39;DianWei&#39;], columns=[&#39;English&#39;,&#39;Chinese&#39;])\nprint(df5.describe())\n结果为：\n       English Chinese\ncount        5       5\nunique       5       5\ntop         sa      nf\nfreq         1       1\n结果表示看不懂","like_count":0},{"had_liked":false,"id":170411,"user_name":"爬行的蜗牛","can_delete":false,"product_type":"c1","uid":1033956,"ip_address":"","ucode":"6623B62DE63CE9","user_header":"http://thirdwx.qlogo.cn/mmopen/vi_32/QD6bf8hkS5dHrabdW7M7Oo9An1Oo3QSxqoySJMDh7GTraxFRX77VZ2HZ13x3R4EVYddIGXicRRDAc7V9z5cLDlA/132","comment_is_top":false,"comment_ctime":1578589406,"is_pvip":false,"replies":null,"discussion_count":0,"race_medal":0,"score":15,"product_id":100021701,"comment_content":"data={&#39;语文&#39;:[66, 95, 95, 90, 80, 80],&#39;英语&#39;:[65, 85, 92, 88, 90,90], &#39;数学&#39;:[&#39;&#39;, 98, 96, 77, 90, 90]}\ndf1 = DataFrame(data, index=[&#39;张飞&#39;, &#39;关羽&#39;, &#39;赵云&#39;,&#39;刘备&#39;,&#39;典韦&#39;,&#39;典韦&#39;], columns=[&#39;语文&#39;,&#39;英语&#39;,&#39;数学&#39;])\ndf1 = df1.drop_duplicates()\ndf1.dropna() # 删除或则填充， 我选择删除， 貌似删除含有Null 的行有点问题\nprint(df1)","like_count":0},{"had_liked":false,"id":168571,"user_name":"强者自强","can_delete":false,"product_type":"c1","uid":1362648,"ip_address":"","ucode":"391B934CC10342","user_header":"https://static001.geekbang.org/account/avatar/00/14/ca/d8/767d8e6e.jpg","comment_is_top":false,"comment_ctime":1578112830,"is_pvip":false,"replies":null,"discussion_count":0,"race_medal":0,"score":15,"product_id":100021701,"comment_content":"之前代码没写注释，这个习惯不好，看了评论里的代码，写的真的好，认识到自己有很多不足的地方，还要多学习这些好的代码。\nimport pandas as pandas \nimport numpy as np\nfrom pandas import DataFrame\n#表数据\ndata = {&#39;names&#39;:[&#39;张飞&#39;,&#39;关羽&#39;,&#39;赵云&#39;,&#39;黄忠&#39;,&#39;典韦&#39;,&#39;典韦&#39;],&#39;Chinese&#39;:[66,95,95,90,80,80],&#39;English&#39;:[65,85,92,88,90,90]\n      ,&#39;Math&#39;:[np.NaN,98,96,77,90,90]}\n#建表\ndf = pd.DataFrame(data,index=[0,1,2,3,4,5],columns=[&#39;names&#39;,&#39;Chinese&#39;,&#39;English&#39;,&#39;Math&#39;])\n#将列字段改成中文\ndf = df.rename(columns={&#39;Chinese&#39;:&#39;语文&#39;,&#39;English&#39;:&#39;英语&#39;,&#39;Math&#39;:&#39;数学&#39;})\n#去重复行\ndf = df.drop_duplicates()\n#查空列\nisNaN = df.isnull().any()\n#用平均值补全空值\ndf[&#39;数学&#39;][0]=np.mean(df[:][&#39;数学&#39;])\n#定义函数增加新列\ndef muti_sum(df):\n    df[&#39;total&#39;] = df[&#39;数学&#39;]+df[&#39;英语&#39;]+df[&#39;语文&#39;]\n    return df\n#为数据表增加新列\ndf = df.apply(muti_sum,axis=1)\nprint(df)","like_count":0},{"had_liked":false,"id":152842,"user_name":"nqluo","can_delete":false,"product_type":"c1","uid":1005773,"ip_address":"","ucode":"68AB4D0B1A2E96","user_header":"https://static001.geekbang.org/account/avatar/00/0f/58/cd/59512aff.jpg","comment_is_top":false,"comment_ctime":1574087759,"is_pvip":false,"replies":null,"discussion_count":0,"race_medal":0,"score":15,"product_id":100021701,"comment_content":"#补NaN\ncols = [&#39;Chinese&#39;,&#39;English&#39;,&#39;Math&#39;]\nfor col in cols:\n    if df1[col].isnull().sum().sum():\n        #print(col)\n        #print(df1[col].isnull().sum().sum())\n        df1[col].fillna(df1[col].mean(), inplace=True)\n        #print(df1[col].isnull().sum().sum())\n        \nprint(df1)","like_count":0},{"had_liked":false,"id":148540,"user_name":"J.Smile","can_delete":false,"product_type":"c1","uid":1336475,"ip_address":"","ucode":"C4D98DFDBF7584","user_header":"https://static001.geekbang.org/account/avatar/00/14/64/9b/d1ab239e.jpg","comment_is_top":false,"comment_ctime":1573027437,"is_pvip":false,"replies":null,"discussion_count":0,"race_medal":0,"score":15,"product_id":100021701,"comment_content":"“其中 axis=1 代表按照列为轴进行操作，axis=0 代表按照行为轴进行操作，args 是传递的两个参数，即 n=2, m=3，在 plus 函数中使用到了 n 和 m，从而生成新的 df“\n------------------------------------------------------------------------------------\n老师，axis的解释是不是写反了","like_count":0},{"had_liked":false,"id":126705,"user_name":"Geek_545e3b","can_delete":false,"product_type":"c1","uid":1628619,"ip_address":"","ucode":"9F11D3604EE9D2","user_header":"http://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTKWbUlKibZs6Qy1q1SuRfyew09nKownad6JrNicJROsssCdib9hdHpG7vburY5rWdxU6YGrgHg0VVsaA/132","comment_is_top":false,"comment_ctime":1566454077,"is_pvip":false,"replies":null,"discussion_count":0,"race_medal":0,"score":15,"product_id":100021701,"comment_content":"我想了两个办法，有一个是借鉴了别人的语句，老师帮我看看第二个办法pandas中有没有方法或者函数帮我简化一下循环，我试了很多，只能想到将df.isnull 的值放到列表来进行条件判断\n第一个方法：\nimport pandas as pd\r\nfrom pandas import DataFrame\r\ndata={&#39;Chinese&#39;:[66,95,93,90,80,80],&#39;English&#39;:[65,85,92,88,90,90],&#39;Math&#39;:[None,98,96,77,90,90]}\r\nnames=[&#39;Zhangfei&#39;,&#39;Guangyu&#39;,&#39;Zhaoyun&#39;,&#39;Huangzhong&#39;,&#39;Dianwei&#39;,&#39;Dianwei&#39;]\r\nsubjects=[&#39;Chinese&#39;,&#39;English&#39;,&#39;Math&#39;]\r\ndf=DataFrame(data,index=names,columns=subjects)\ndf=df.drop_duplicates()\r\nprint(df)\r\n# df=df.rename(columns={&#39;Chinese&#39;:&#39;语文&#39;,&#39;English&#39;:&#39;英语&#39;,&#39;Math&#39;:&#39;数学&#39;}),下面inplace可以在原数据修改，不需要赋值\r\ndf.rename(columns={&#39;Chinese&#39;:&#39;语文&#39;,&#39;English&#39;:&#39;英语&#39;,&#39;Math&#39;:&#39;数学&#39;},inplace=True)\r\njudge_kemu=[]\nfor x in df.isnull().any():\r\n    judge_kemu.append(x)\n#如果数据量大，自动填充空白值\nif True in judge_kemu:\r\n    kemu=[]\r\n    for b in df:\r\n        if df[b].isnull().any():\r\n            kemu.append(b)\r\n    for item in kemu:\r\n        df.fillna(df[item].mean(),inplace=True)\ndf[&#39;总分&#39;]=df.sum(axis=1)\nprint(df.describe())\n第二个方法：\nimport pandas as pd\r\nfrom pandas import DataFrame\r\ndata={&#39;Chinese&#39;:[66,95,93,90,80,80],&#39;English&#39;:[65,85,92,88,90,90],&#39;Math&#39;:[None,98,96,77,90,90]}\r\nnames=[&#39;Zhangfei&#39;,&#39;Guangyu&#39;,&#39;Zhaoyun&#39;,&#39;Huangzhong&#39;,&#39;Dianwei&#39;,&#39;Dianwei&#39;]\r\nsubjects=[&#39;Chinese&#39;,&#39;English&#39;,&#39;Math&#39;]\r\ndf=DataFrame(data,index=names,columns=subjects)\ndf=df.drop_duplicates()\r\nprint(df)\r\n# df=df.rename(columns={&#39;Chinese&#39;:&#39;语文&#39;,&#39;English&#39;:&#39;英语&#39;,&#39;Math&#39;:&#39;数学&#39;}),下面inplace可以在原数据修改，不需要赋值\r\ndf.rename(columns={&#39;Chinese&#39;:&#39;语文&#39;,&#39;English&#39;:&#39;英语&#39;,&#39;Math&#39;:&#39;数学&#39;},inplace=True)\r\njudge_kemu=[]\nfor x in df.isnull().any():\r\n    judge_kemu.append(x)\n#如果数据量大，自动填充空白值\nif True in judge_kemu:\r\n    kemu=[]\r\n    for b in df:\r\n        if df[b].isnull().any():\r\n            kemu.append(b)\n       for item in kemu:\r\n           average=df[item].mean()\r\n           for name in df.index:\r\n               if str(df[item][name])==&#39;nan&#39;:\r\n                   df[item][name]=average\n\ndf[&#39;总分&#39;]=df.sum(axis=1)\nprint(df.describe())","like_count":0},{"had_liked":false,"id":110704,"user_name":"xqs42b","can_delete":false,"product_type":"c1","uid":1590102,"ip_address":"","ucode":"E1B85D10E44672","user_header":"https://static001.geekbang.org/account/avatar/00/18/43/56/3572a20c.jpg","comment_is_top":false,"comment_ctime":1562316766,"is_pvip":false,"replies":null,"discussion_count":0,"race_medal":0,"score":15,"product_id":100021701,"comment_content":"我提个小小的建议，希望老师说明一下执行环境，还有就是strip, apply, upper, title, lower,....是python函数， 还是pandas里面的呢！","like_count":0},{"had_liked":false,"id":108539,"user_name":"从前从前","can_delete":false,"product_type":"c1","uid":1575475,"ip_address":"","ucode":"73ED0B74D9DCB0","user_header":"https://static001.geekbang.org/account/avatar/00/18/0a/33/292a3f4b.jpg","comment_is_top":false,"comment_ctime":1561796728,"is_pvip":false,"replies":null,"discussion_count":0,"race_medal":0,"score":15,"product_id":100021701,"comment_content":"import pandas as pd\nfrom pandas import DataFrame,Series\n\n\ndata = {&#39;Chinese&#39;:[66,95,95,90,80,80],&#39;Math&#39;:[None,98,96,77,90,90],&#39;English&#39;:[65,85,92,88,90,90]}\ndf = DataFrame(data,index = [&#39;张飞&#39;,&#39;关羽&#39;,&#39;赵云&#39;,&#39;黄忠&#39;,&#39;典韦&#39;,&#39;典韦&#39;],columns=[&#39;Chinese&#39;,&#39;English&#39;,&#39;Math&#39;])\n#去除重复\ndf = df.drop_duplicates()\n# 修改列名\ndf.rename(columns={&#39;Chinese&#39;:&#39;语文&#39;,&#39;Math&#39;:&#39;数学&#39;,&#39;English&#39;:&#39;英语&#39;},inplace=True)\n#使用平均值填补空值\ndf[&#39;数学&#39;].fillna(df[&#39;数学&#39;].mean(),inplace=True)\n#计算总分\ndf[&#39;总和&#39;] = df[&#39;语文&#39;]+df[&#39;数学&#39;] + df[&#39;英语&#39;]\n#排名\ndf.sort_values([&#39;总和&#39;],ascending=[False],inplace=True)\n\nprint(df)\n\n# 想请教两个问题\n# 1、想在名字那列的列名改为姓名，要怎么改呢\n# 2、已经改完列名了，接下来想用SQL的方式做出练习题中的答案，要怎么做呢","like_count":0},{"had_liked":false,"id":107469,"user_name":"lycan","can_delete":false,"product_type":"c1","uid":1587048,"ip_address":"","ucode":"F984DBF4515EEA","user_header":"https://static001.geekbang.org/account/avatar/00/18/37/68/afe6c6f8.jpg","comment_is_top":false,"comment_ctime":1561541038,"is_pvip":false,"replies":null,"discussion_count":0,"race_medal":0,"score":15,"product_id":100021701,"comment_content":"import pandas as pd\nimport numpy as np\nfrom pandas import DataFrame,Series\n#定义DataFrame\ndf = {&#39;Chinese&#39;:[95,95,95,90,80,80],&#39;english&#39;:[65,85,92,88,90,90],&#39;math&#39;:[None,98,96,77,90,90]}\nmy_frame = pd.DataFrame(df,index=[&#39;ZhangFei&#39;,&#39;GuanYu&#39;,&#39;ZhaoYun&#39;,&#39;HuangZhong&#39;,&#39;DianWei&#39;,&#39;DianWei&#39;])\ndef clean(df):\n    df = pd.DataFrame(df)\n    #去除重复值\n    df = df.drop_duplicates()\n    #检查是否包含空值，\n    result_series = df.isnull().any()\n    #print(result_series)\n    #获取包含空值的列名\n    NaN_index = result_series[result_series.values==True].index\n    #print(NaN_index)\n    #将平均值添加到空值中\n    for item in NaN_index:\n        df[item].fillna(df[item].mean(),inplace=True)\n    #添加一列，算出总成绩\n    df[&#39;score&#39;] = df.sum(axis=1)\n    #排序\n    df.sort_values(&#39;score&#39;,ascending=False,inplace=True)\n    return df\nmy_frame = clean(my_frame)\nprint(my_frame)\n陈老师您好，上边是我写的作业，有个问题再最后调用我定义的clean方法的时候，clean(my_frame)是没有报错的，但是使用my_frame.apply(clean)就会报好多错，希望您能解答一下，谢谢","like_count":0},{"had_liked":false,"id":107364,"user_name":"David","can_delete":false,"product_type":"c1","uid":1506673,"ip_address":"","ucode":"5154BE2B2DF689","user_header":"https://static001.geekbang.org/account/avatar/00/16/fd/71/2c66cbdd.jpg","comment_is_top":false,"comment_ctime":1561519530,"is_pvip":false,"replies":null,"discussion_count":0,"race_medal":0,"score":15,"product_id":100021701,"comment_content":"def plus(df,n,m):\n    df[&#39;new1&#39;] = (df[u&#39;语文&#39;]+df[u&#39;英语&#39;]) * m\n    df[&#39;new2&#39;] = (df[u&#39;语文&#39;]+df[u&#39;英语&#39;]) * n\n    return df\ndf1 = df1.apply(plus,axis=1,args=(2,3,))\n最后args这里为什么不能写（scores,2,3）呢？","like_count":0},{"had_liked":false,"id":105749,"user_name":"薛定谔的猫","can_delete":false,"product_type":"c1","uid":1467230,"ip_address":"","ucode":"F2DEF41FDA2D05","user_header":"https://static001.geekbang.org/account/avatar/00/16/63/5e/b413dee1.jpg","comment_is_top":false,"comment_ctime":1561080678,"is_pvip":false,"replies":null,"discussion_count":0,"race_medal":0,"score":15,"product_id":100021701,"comment_content":"data = {&#39;Chinese&#39;: [&#39;ss&#39;, &#39;nf&#39;,&#39;&#39;,&#39;  ds&#39;,&#39;cd  &#39;],&#39;English&#39;: [&#39;sd&#39;, &#39;ws&#39;, &#39;cd&#39;, &#39;sa&#39;, &#39;fv&#39;]}\ndf5 = DataFrame(data, index=[&#39;ZhangFei&#39;, &#39;GuanYu&#39;, &#39;ZhaoYun&#39;, &#39;HuangZhong&#39;, &#39;DianWei&#39;], columns=[&#39;English&#39;,&#39;Chinese&#39;])\nprint(df5.describe())\n结果为：\n       English Chinese\ncount        5       5\nunique       5       5\ntop         sa      nf\nfreq         1       1\n结果表示看不懂","like_count":0},{"had_liked":false,"id":105516,"user_name":"是剑雄啊~","can_delete":false,"product_type":"c1","uid":1397245,"ip_address":"","ucode":"F4A46B6288EB61","user_header":"https://static001.geekbang.org/account/avatar/00/15/51/fd/6ebb7efb.jpg","comment_is_top":false,"comment_ctime":1561020020,"is_pvip":false,"replies":null,"discussion_count":0,"race_medal":0,"score":16,"product_id":100021701,"comment_content":"1.创建数据：两种方式\nimport pandas as pd\nfrom pandas import Series,DataFrame\n\n1).a = pd.read_csv(&#39;C:&#47;Users&#47;Jason&#47;Desktop&#47;test.csv&#39;, sep=&#39;,&#39;,encoding=&#39;gbk&#39;)\na\n2).data ={u&#39;姓名&#39;:[u&#39;张飞&#39;,u&#39;关羽&#39;,u&#39;赵云&#39;,u&#39;黄忠&#39;,u&#39;典韦&#39;,u&#39;典韦&#39;],\n       u&#39;语文&#39;:[66,95,95,90,80,80],\n       u&#39;英语&#39;:[65,85,92,88,90,90],\n       u&#39;数学&#39;:[None,98,96,77,90,90]}\ndf = DataFrame(data)\n输出:\n\t姓名\t数学\t英语\t语文\n0\t张飞\t99.0\t65\t66\n1\t关羽\t98.0\t85\t95\n2\t赵云\t96.0\t92\t95\n3\t黄忠\t77.0\t88\t90\n4\t典韦\t90.0\t90\t80\n5\t典韦\t90.0\t90\t80\n\n2.删除空值\ndf = df.drop(index=[0])\n\n3.去除重复值\ndf = df.drop_duplicates()\n\n4.加入总成绩\ndef total(df):\n    df[u&#39;总成绩&#39;] = df[u&#39;语文&#39;] + df[u&#39;数学&#39;] + df[u&#39;英语&#39;]\n    return df\ndf = df.apply(total,axis=1)\n\n5.总成绩排名\na.sort_values(u&#39;总成绩&#39;,ascending=False)\n\n姓名\t语文\t英语\t数学\t总成绩\n2\t赵云\t95\t92\t96.0\t283.0\n1\t关羽\t95\t85\t98.0\t278.0\n4\t典韦\t80\t90\t90.0\t260.0\n3\t黄忠\t90\t88\t77.0\t255.0\n\n\n","like_count":0},{"had_liked":false,"id":104851,"user_name":"建强","can_delete":false,"product_type":"c1","uid":1397126,"ip_address":"","ucode":"62B03D0E0C64EC","user_header":"https://static001.geekbang.org/account/avatar/00/15/51/86/b5fd8dd8.jpg","comment_is_top":false,"comment_ctime":1560855562,"is_pvip":false,"replies":null,"discussion_count":0,"race_medal":0,"score":16,"product_id":100021701,"comment_content":"请问老师，用python做数据分析和清洗，和现在比较流行的Hadoop平台中的各种组件做数据分析相比，两者各有什么优劣，各自用在什么场景？","like_count":0},{"had_liked":false,"id":104503,"user_name":"GentleCP","can_delete":false,"product_type":"c1","uid":1525440,"ip_address":"","ucode":"BB1EE3720D44F0","user_header":"https://static001.geekbang.org/account/avatar/00/17/46/c0/01292b08.jpg","comment_is_top":false,"comment_ctime":1560768679,"is_pvip":false,"replies":null,"discussion_count":1,"race_medal":0,"score":16,"product_id":100021701,"comment_content":"请问老师，在创建DataFrame的时候columns是设定列的字段名，但是这个字段名不能覆盖index的字段名，例如:\n  Name | Chinese | Math\n张飞  | 89 | 98\n中张飞是index索引，他的字段名Name无法在columns中创建，最后形成的表左上角是空白的，这个怎么解决呢","like_count":0},{"had_liked":false,"id":100181,"user_name":"Wing·三金","can_delete":false,"product_type":"c1","uid":1341402,"ip_address":"","ucode":"6B9F5822C3717F","user_header":"https://static001.geekbang.org/account/avatar/00/14/77/da/54c663f3.jpg","comment_is_top":false,"comment_ctime":1559470225,"is_pvip":false,"replies":null,"discussion_count":0,"race_medal":0,"score":16,"product_id":100021701,"comment_content":"今日新知：\ndf 中的 str 用法：Series.map 以及 Series.str.strip&#47;lstrip&#47;rstrip\npandasql：用 sql 的语言操作 pd\n\nimport pandas as pd\n思考题：\n# data building\nsubjects = (&#39;Chinese&#39;, &#39;English&#39;, &#39;Math&#39;)\nnames = (&#39;张飞&#39;, &#39;关羽&#39;, &#39;赵云&#39;, &#39;黄忠&#39;, &#39;典韦&#39;, &#39;典韦&#39;)\ngrades = [(66, 65, ), \n         (95, 85, 98), \n         (95, 92, 96), \n         (90, 88, 77), \n         (80, 90, 90), \n         (80, 90, 90)]\n\ndf = pd.DataFrame(grades, columns=subjects, index=names)\n\n# data cleaning\ndf.drop_duplicates(inplace=True)\ndf[&#39;Math&#39;].fillna(df[&#39;Math&#39;].mean(), inplace=True) # 感觉这个操作有点高估了张飞 emmmm\n\n# sum up and sort by total scores\ndf[&#39;Total&#39;] = df.sum(axis=1)\ndf.sort_values(by=&#39;Total&#39;, ascending=False)","like_count":0},{"had_liked":false,"id":98704,"user_name":"春风沐古","can_delete":false,"product_type":"c1","uid":1349426,"ip_address":"","ucode":"EB5C8507AA7D72","user_header":"https://static001.geekbang.org/account/avatar/00/14/97/32/10543da1.jpg","comment_is_top":false,"comment_ctime":1559060625,"is_pvip":false,"replies":null,"discussion_count":0,"race_medal":0,"score":16,"product_id":100021701,"comment_content":"import pandas as pd\nfrom pandas import Series,DataFrame\nscore=DataFrame({\n                 &#39;语文&#39;:[66,95,95,90,80,80],\n                 &#39;英语&#39;:[65,85,92,88,90,90],\n                 &#39;数学&#39;:[None,98,96,77,90,90]},\n                index=[&#39;张飞&#39;,&#39;关羽&#39;,&#39;赵云&#39;,&#39;黄忠&#39;,&#39;典韦&#39;,&#39;典韦&#39;])\nscore=score.drop_duplicates()\n# 查看哪一行是空值，如果是未知的，for遍历\n# print(score.isnull().sum())\nscore[&#39;数学&#39;].fillna(score[&#39;数学&#39;].mean(),inplace=True)\nscore[&#39;总分&#39;]=score[&#39;语文&#39;]+score[&#39;英语&#39;]+score[&#39;数学&#39;]\nprint(score)\n\n","like_count":0},{"had_liked":false,"id":98640,"user_name":"Eline","can_delete":false,"product_type":"c1","uid":1164589,"ip_address":"","ucode":"936EF16B8C08FB","user_header":"https://static001.geekbang.org/account/avatar/00/11/c5/2d/3f658d3f.jpg","comment_is_top":false,"comment_ctime":1559047328,"is_pvip":false,"replies":null,"discussion_count":1,"race_medal":0,"score":16,"product_id":100021701,"comment_content":"data = {&#39;Chinese&#39;: [66, 95, 93, 90,80],&#39;English&#39;: [65, 85, 92, 88, 90],&#39;Math&#39;: [30, 98, 96, 77, 90]}\ndf3 = DataFrame(data, index=[&#39;ZhangFei&#39;, &#39;GuanYu&#39;, &#39;ZhaoYun&#39;, &#39;HuangZhong&#39;, &#39;DianWei&#39;], columns=[&#39;English&#39;, &#39;Math&#39;, &#39;Chinese&#39;])\n# 删除左右两边空格\ndf3[&#39;Chinese&#39;]=df3[&#39;Chinese&#39;].map(str.strip)\n# 删除左边空格\n# df3[&#39;Chinese&#39;]=df3[&#39;Chinese&#39;].map(str.lstrip)\n# 删除右边空格\n# df3[&#39;Chinese&#39;]=df3[&#39;Chinese&#39;].map(str.rstrip)\n--------------------------------------------------------------------------\nTypeError                                 Traceback (most recent call last)\n&lt;ipython-input-186-a713f0ae82bd&gt; in &lt;module&gt;\n      1 # 删除左右两边空格\n----&gt; 2 df3[&#39;Chinese&#39;]=df3[&#39;Chinese&#39;].map(str.strip)\n      3 # 删除左边空格\n      4 df3[&#39;Chinese&#39;]=df3[&#39;Chinese&#39;].map(str.lstrip)\n      5 # 删除右边空格\n\nC:\\software\\Anaconda3\\lib\\site-packages\\pandas\\core\\series.py in map(self, arg, na_action)\n   3380         &quot;&quot;&quot;\n   3381         new_values = super(Series, self)._map_values(\n-&gt; 3382             arg, na_action=na_action)\n   3383         return self._constructor(new_values,\n   3384                                  index=self.index).__finalize__(self)\n\nC:\\software\\Anaconda3\\lib\\site-packages\\pandas\\core\\base.py in _map_values(self, mapper, na_action)\n   1216 \n   1217         # mapper is a function\n-&gt; 1218         new_values = map_f(values, mapper)\n   1219 \n   1220         return new_values\n\npandas&#47;_libs&#47;lib.pyx in pandas._libs.lib.map_infer()\n\nTypeError: descriptor &#39;strip&#39; requires a &#39;str&#39; object but received a &#39;int&#39;\n老师，帮忙看下，我用的是Anaconda自带的py3.7.3版本执行的，但还是提示类型不对，试了其他方法也不行。\n","like_count":0,"discussions":[{"author":{"id":1058818,"avatar":"https://static001.geekbang.org/account/avatar/00/10/28/02/a6d7ece6.jpg","nickname":"refactor","note":"","ucode":"EC8FF55FE6EC8E","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":3743,"discussion_content":"Name 就不要了呗，或者不设置 index","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1564752388,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":98315,"user_name":"寻心","can_delete":false,"product_type":"c1","uid":1455101,"ip_address":"","ucode":"67B76ED0844DD9","user_header":"https://static001.geekbang.org/account/avatar/00/16/33/fd/01a8e1f3.jpg","comment_is_top":false,"comment_ctime":1558955524,"is_pvip":false,"replies":null,"discussion_count":0,"race_medal":0,"score":16,"product_id":100021701,"comment_content":"# -*- coding: utf-8 -\nimport pandas as pd\nfrom pandas import DataFrame\n\n\ndata = {&#39;语文&#39;:[66,95,95,90,80,80], &#39;英语&#39;:[65,85,92,88,90,90], &#39;数学&#39;:[None, 98, 96,77,90,90]}\ndf = DataFrame(data, index=[&#39;张飞&#39;, &#39;关羽&#39;, &#39;赵云&#39;, &#39;黄忠&#39;, &#39;典韦&#39;, &#39;典韦&#39;], columns=[&#39;语文&#39;, &#39;英语&#39;, &#39;数学&#39;])\n\n\ndf = df.drop_duplicates()\n\ndf = df.fillna(0)\n\n\ndef plus(df):\n\tdf[&#39;总和&#39;] = df[&#39;语文&#39;] + df[&#39;英语&#39;] + df[&#39;数学&#39;]\n\treturn df\n\ndf = df.apply(plus, axis=1)\n\nprint &#39;&#39;\nprint df","like_count":0},{"had_liked":false,"id":96928,"user_name":"Geek_l0anid","can_delete":false,"product_type":"c1","uid":1258042,"ip_address":"","ucode":"96DE706AAC9D97","user_header":"https://static001.geekbang.org/account/avatar/00/13/32/3a/2d8a2c67.jpg","comment_is_top":false,"comment_ctime":1558537644,"is_pvip":false,"replies":null,"discussion_count":0,"race_medal":0,"score":16,"product_id":100021701,"comment_content":"score = {&#39;姓名&#39;:[&#39;张飞&#39;,&#39;关羽&#39;,&#39;赵云&#39;,&#39;黄忠&#39;,&#39;典韦&#39;,&#39;典韦&#39;],&#39;语文&#39;:[66,95,95,90,80,80],&#39;英语&#39;:[65,85,92,88,90,90],&#39;数学&#39;:[None,98,96,77,90,90]}\nheros_score = DataFrame(score)\nheros_score = heros_score.drop_duplicates()\na = heros_score[&#39;数学&#39;].mean()\nheros_score.loc[0,&#39;数学&#39;] = a\nheros_score[&#39;总和&#39;] = heros_score.sum(axis = 1)\nprint(heros_score)","like_count":0},{"had_liked":false,"id":95975,"user_name":"大斌","can_delete":false,"product_type":"c1","uid":1002183,"ip_address":"","ucode":"1434C2B0A29135","user_header":"https://static001.geekbang.org/account/avatar/00/0f/4a/c7/ec18673b.jpg","comment_is_top":false,"comment_ctime":1558281682,"is_pvip":false,"replies":null,"discussion_count":0,"race_medal":0,"score":16,"product_id":100021701,"comment_content":"最主要的数据结构是series和dataframe，提供的可用作数据清洗的函数有：drop()、rename()、drop_duplicates()、astype()、strip()、upper()、lower()、title()、isnull()、apply()","like_count":0},{"had_liked":false,"id":83059,"user_name":"滢","can_delete":false,"product_type":"c1","uid":1221511,"ip_address":"","ucode":"971A6F20AF3F9A","user_header":"https://static001.geekbang.org/account/avatar/00/12/a3/87/c415e370.jpg","comment_is_top":false,"comment_ctime":1554387835,"is_pvip":false,"replies":null,"discussion_count":0,"race_medal":0,"score":16,"product_id":100021701,"comment_content":"语言：Python3.6 环境：IDLE\n&gt;&gt;&gt; data={&#39;Chinese&#39;:[66,95,95,90,80,80],&#39;English&#39;:[65,85,92,88,90,90],&#39;Math&#39;:[None,98,96,77,90,90]}\n&gt;&gt;&gt; scoreframe = DataFrame(data,index=[&#39;张飞&#39;,&#39;关羽&#39;,&#39;赵云&#39;,&#39;黄忠&#39;,&#39;典韦&#39;,&#39;典韦&#39;],columns=[&#39;Chinese&#39;,&#39;English&#39;,&#39;Math&#39;])\n&gt;&gt;&gt; #删除重复数据\n&gt;&gt;&gt; scoreframe.drop_duplicates()\n    Chinese  English  Math\n张飞       66       65   NaN\n关羽       95       85  98.0\n赵云       95       92  96.0\n黄忠       90       88  77.0\n典韦       80       90  90.0\n&gt;&gt;&gt; #第一步：删除重复数据\n&gt;&gt;&gt; scoreframe.drop_duplicates()\n    Chinese  English  Math\n张飞       66       65   NaN\n关羽       95       85  98.0\n赵云       95       92  96.0\n黄忠       90       88  77.0\n典韦       80       90  90.0\n&gt;&gt;&gt; 第二步:#检查是否有空值\n&gt;&gt;&gt; scoreframe.isnull()\n    Chinese  English   Math\n张飞    False    False   True\n关羽    False    False  False\n赵云    False    False  False\n黄忠    False    False  False\n典韦    False    False  False\n典韦    False    False  False\n&gt;&gt;&gt; #对张飞的数学成绩进行补充\n&gt;&gt;&gt; scoreframe[&#39;Math&#39;].fillna(scoreframe[&#39;Math&#39;].mean(),inplace = True)\n&gt;&gt;&gt; #添加新的一行，求和\n&gt;&gt;&gt; def total_score(scoreframe):\n\tscoreframe[&#39;总分&#39;] = scoreframe.sum(axis=0)\n\treturn scoreframe\n\n &gt;&gt;&gt; scoreframe = scoreframe.apply(total_score,axis =1)\n    Chinese  English  Math     总分\n张飞     66.0     65.0  90.2  221.2\n关羽     95.0     85.0  98.0  278.0\n赵云     95.0     92.0  96.0  283.0\n黄忠     90.0     88.0  77.0  255.0\n典韦     80.0     90.0  90.0  260.0\n典韦     80.0     90.0  90.0  260.0\n&gt;&gt;&gt; #替换名称\n&gt;&gt;&gt; scoreframe.rename(columns={&#39;Chinese&#39;:&#39;语文&#39;,&#39;English&#39;:&#39;英语&#39;,&#39;Math&#39;:&#39;数学&#39;},inplace = True)\n&gt;&gt;&gt; print (scoreframe)\n      语文    英语    数学     总分\n张飞  66.0  65.0  90.2  221.2\n关羽  95.0  85.0  98.0  278.0\n赵云  95.0  92.0  96.0  283.0\n黄忠  90.0  88.0  77.0  255.0\n典韦  80.0  90.0  90.0  260.0\n典韦  80.0  90.0  90.0  260.0\n\n疑问：对于最左上角的姓名，该如何输入表格中？ 如果要对成绩进行排名，并自动填写上名词，该如何写？ ","like_count":0,"discussions":[{"author":{"id":1042618,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/e8/ba/6d318c08.jpg","nickname":"GS","note":"","ucode":"21C73A8CBD8093","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":50020,"discussion_content":"descriptor &#39;strip&#39; requires a &#39;str&#39; object but received a &#39;int&#39;，这个提示很明显了。因为时操作字符串str的方法，例子中的df里面的数据是int，你看我的链接里面，自己追加一列字符串str来练习 ，供你参考：\nhttps://github.com/leledada/jupyter/blob/master/PandasTest.ipynb","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1573656870,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":105516,"user_name":"是剑雄啊~","can_delete":false,"product_type":"c1","uid":1397245,"ip_address":"","ucode":"F4A46B6288EB61","user_header":"https://static001.geekbang.org/account/avatar/00/15/51/fd/6ebb7efb.jpg","comment_is_top":false,"comment_ctime":1561020020,"is_pvip":false,"replies":null,"discussion_count":0,"race_medal":0,"score":16,"product_id":100021701,"comment_content":"1.创建数据：两种方式\nimport pandas as pd\nfrom pandas import Series,DataFrame\n\n1).a = pd.read_csv(&#39;C:&#47;Users&#47;Jason&#47;Desktop&#47;test.csv&#39;, sep=&#39;,&#39;,encoding=&#39;gbk&#39;)\na\n2).data ={u&#39;姓名&#39;:[u&#39;张飞&#39;,u&#39;关羽&#39;,u&#39;赵云&#39;,u&#39;黄忠&#39;,u&#39;典韦&#39;,u&#39;典韦&#39;],\n       u&#39;语文&#39;:[66,95,95,90,80,80],\n       u&#39;英语&#39;:[65,85,92,88,90,90],\n       u&#39;数学&#39;:[None,98,96,77,90,90]}\ndf = DataFrame(data)\n输出:\n\t姓名\t数学\t英语\t语文\n0\t张飞\t99.0\t65\t66\n1\t关羽\t98.0\t85\t95\n2\t赵云\t96.0\t92\t95\n3\t黄忠\t77.0\t88\t90\n4\t典韦\t90.0\t90\t80\n5\t典韦\t90.0\t90\t80\n\n2.删除空值\ndf = df.drop(index=[0])\n\n3.去除重复值\ndf = df.drop_duplicates()\n\n4.加入总成绩\ndef total(df):\n    df[u&#39;总成绩&#39;] = df[u&#39;语文&#39;] + df[u&#39;数学&#39;] + df[u&#39;英语&#39;]\n    return df\ndf = df.apply(total,axis=1)\n\n5.总成绩排名\na.sort_values(u&#39;总成绩&#39;,ascending=False)\n\n姓名\t语文\t英语\t数学\t总成绩\n2\t赵云\t95\t92\t96.0\t283.0\n1\t关羽\t95\t85\t98.0\t278.0\n4\t典韦\t80\t90\t90.0\t260.0\n3\t黄忠\t90\t88\t77.0\t255.0\n\n\n","like_count":0},{"had_liked":false,"id":104851,"user_name":"建强","can_delete":false,"product_type":"c1","uid":1397126,"ip_address":"","ucode":"62B03D0E0C64EC","user_header":"https://static001.geekbang.org/account/avatar/00/15/51/86/b5fd8dd8.jpg","comment_is_top":false,"comment_ctime":1560855562,"is_pvip":false,"replies":null,"discussion_count":0,"race_medal":0,"score":16,"product_id":100021701,"comment_content":"请问老师，用python做数据分析和清洗，和现在比较流行的Hadoop平台中的各种组件做数据分析相比，两者各有什么优劣，各自用在什么场景？","like_count":0},{"had_liked":false,"id":104503,"user_name":"GentleCP","can_delete":false,"product_type":"c1","uid":1525440,"ip_address":"","ucode":"BB1EE3720D44F0","user_header":"https://static001.geekbang.org/account/avatar/00/17/46/c0/01292b08.jpg","comment_is_top":false,"comment_ctime":1560768679,"is_pvip":false,"replies":null,"discussion_count":1,"race_medal":0,"score":16,"product_id":100021701,"comment_content":"请问老师，在创建DataFrame的时候columns是设定列的字段名，但是这个字段名不能覆盖index的字段名，例如:\n  Name | Chinese | Math\n张飞  | 89 | 98\n中张飞是index索引，他的字段名Name无法在columns中创建，最后形成的表左上角是空白的，这个怎么解决呢","like_count":0,"discussions":[{"author":{"id":1058818,"avatar":"https://static001.geekbang.org/account/avatar/00/10/28/02/a6d7ece6.jpg","nickname":"refactor","note":"","ucode":"EC8FF55FE6EC8E","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":3743,"discussion_content":"Name 就不要了呗，或者不设置 index","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1564752388,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":100181,"user_name":"Wing·三金","can_delete":false,"product_type":"c1","uid":1341402,"ip_address":"","ucode":"6B9F5822C3717F","user_header":"https://static001.geekbang.org/account/avatar/00/14/77/da/54c663f3.jpg","comment_is_top":false,"comment_ctime":1559470225,"is_pvip":false,"replies":null,"discussion_count":0,"race_medal":0,"score":16,"product_id":100021701,"comment_content":"今日新知：\ndf 中的 str 用法：Series.map 以及 Series.str.strip&#47;lstrip&#47;rstrip\npandasql：用 sql 的语言操作 pd\n\nimport pandas as pd\n思考题：\n# data building\nsubjects = (&#39;Chinese&#39;, &#39;English&#39;, &#39;Math&#39;)\nnames = (&#39;张飞&#39;, &#39;关羽&#39;, &#39;赵云&#39;, &#39;黄忠&#39;, &#39;典韦&#39;, &#39;典韦&#39;)\ngrades = [(66, 65, ), \n         (95, 85, 98), \n         (95, 92, 96), \n         (90, 88, 77), \n         (80, 90, 90), \n         (80, 90, 90)]\n\ndf = pd.DataFrame(grades, columns=subjects, index=names)\n\n# data cleaning\ndf.drop_duplicates(inplace=True)\ndf[&#39;Math&#39;].fillna(df[&#39;Math&#39;].mean(), inplace=True) # 感觉这个操作有点高估了张飞 emmmm\n\n# sum up and sort by total scores\ndf[&#39;Total&#39;] = df.sum(axis=1)\ndf.sort_values(by=&#39;Total&#39;, ascending=False)","like_count":0},{"had_liked":false,"id":98704,"user_name":"春风沐古","can_delete":false,"product_type":"c1","uid":1349426,"ip_address":"","ucode":"EB5C8507AA7D72","user_header":"https://static001.geekbang.org/account/avatar/00/14/97/32/10543da1.jpg","comment_is_top":false,"comment_ctime":1559060625,"is_pvip":false,"replies":null,"discussion_count":0,"race_medal":0,"score":16,"product_id":100021701,"comment_content":"import pandas as pd\nfrom pandas import Series,DataFrame\nscore=DataFrame({\n                 &#39;语文&#39;:[66,95,95,90,80,80],\n                 &#39;英语&#39;:[65,85,92,88,90,90],\n                 &#39;数学&#39;:[None,98,96,77,90,90]},\n                index=[&#39;张飞&#39;,&#39;关羽&#39;,&#39;赵云&#39;,&#39;黄忠&#39;,&#39;典韦&#39;,&#39;典韦&#39;])\nscore=score.drop_duplicates()\n# 查看哪一行是空值，如果是未知的，for遍历\n# print(score.isnull().sum())\nscore[&#39;数学&#39;].fillna(score[&#39;数学&#39;].mean(),inplace=True)\nscore[&#39;总分&#39;]=score[&#39;语文&#39;]+score[&#39;英语&#39;]+score[&#39;数学&#39;]\nprint(score)\n\n","like_count":0},{"had_liked":false,"id":98640,"user_name":"Eline","can_delete":false,"product_type":"c1","uid":1164589,"ip_address":"","ucode":"936EF16B8C08FB","user_header":"https://static001.geekbang.org/account/avatar/00/11/c5/2d/3f658d3f.jpg","comment_is_top":false,"comment_ctime":1559047328,"is_pvip":false,"replies":null,"discussion_count":1,"race_medal":0,"score":16,"product_id":100021701,"comment_content":"data = {&#39;Chinese&#39;: [66, 95, 93, 90,80],&#39;English&#39;: [65, 85, 92, 88, 90],&#39;Math&#39;: [30, 98, 96, 77, 90]}\ndf3 = DataFrame(data, index=[&#39;ZhangFei&#39;, &#39;GuanYu&#39;, &#39;ZhaoYun&#39;, &#39;HuangZhong&#39;, &#39;DianWei&#39;], columns=[&#39;English&#39;, &#39;Math&#39;, &#39;Chinese&#39;])\n# 删除左右两边空格\ndf3[&#39;Chinese&#39;]=df3[&#39;Chinese&#39;].map(str.strip)\n# 删除左边空格\n# df3[&#39;Chinese&#39;]=df3[&#39;Chinese&#39;].map(str.lstrip)\n# 删除右边空格\n# df3[&#39;Chinese&#39;]=df3[&#39;Chinese&#39;].map(str.rstrip)\n--------------------------------------------------------------------------\nTypeError                                 Traceback (most recent call last)\n&lt;ipython-input-186-a713f0ae82bd&gt; in &lt;module&gt;\n      1 # 删除左右两边空格\n----&gt; 2 df3[&#39;Chinese&#39;]=df3[&#39;Chinese&#39;].map(str.strip)\n      3 # 删除左边空格\n      4 df3[&#39;Chinese&#39;]=df3[&#39;Chinese&#39;].map(str.lstrip)\n      5 # 删除右边空格\n\nC:\\software\\Anaconda3\\lib\\site-packages\\pandas\\core\\series.py in map(self, arg, na_action)\n   3380         &quot;&quot;&quot;\n   3381         new_values = super(Series, self)._map_values(\n-&gt; 3382             arg, na_action=na_action)\n   3383         return self._constructor(new_values,\n   3384                                  index=self.index).__finalize__(self)\n\nC:\\software\\Anaconda3\\lib\\site-packages\\pandas\\core\\base.py in _map_values(self, mapper, na_action)\n   1216 \n   1217         # mapper is a function\n-&gt; 1218         new_values = map_f(values, mapper)\n   1219 \n   1220         return new_values\n\npandas&#47;_libs&#47;lib.pyx in pandas._libs.lib.map_infer()\n\nTypeError: descriptor &#39;strip&#39; requires a &#39;str&#39; object but received a &#39;int&#39;\n老师，帮忙看下，我用的是Anaconda自带的py3.7.3版本执行的，但还是提示类型不对，试了其他方法也不行。\n","like_count":0,"discussions":[{"author":{"id":1042618,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/e8/ba/6d318c08.jpg","nickname":"GS","note":"","ucode":"21C73A8CBD8093","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":50020,"discussion_content":"descriptor &#39;strip&#39; requires a &#39;str&#39; object but received a &#39;int&#39;，这个提示很明显了。因为时操作字符串str的方法，例子中的df里面的数据是int，你看我的链接里面，自己追加一列字符串str来练习 ，供你参考：\nhttps://github.com/leledada/jupyter/blob/master/PandasTest.ipynb","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1573656870,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":98315,"user_name":"寻心","can_delete":false,"product_type":"c1","uid":1455101,"ip_address":"","ucode":"67B76ED0844DD9","user_header":"https://static001.geekbang.org/account/avatar/00/16/33/fd/01a8e1f3.jpg","comment_is_top":false,"comment_ctime":1558955524,"is_pvip":false,"replies":null,"discussion_count":0,"race_medal":0,"score":16,"product_id":100021701,"comment_content":"# -*- coding: utf-8 -\nimport pandas as pd\nfrom pandas import DataFrame\n\n\ndata = {&#39;语文&#39;:[66,95,95,90,80,80], &#39;英语&#39;:[65,85,92,88,90,90], &#39;数学&#39;:[None, 98, 96,77,90,90]}\ndf = DataFrame(data, index=[&#39;张飞&#39;, &#39;关羽&#39;, &#39;赵云&#39;, &#39;黄忠&#39;, &#39;典韦&#39;, &#39;典韦&#39;], columns=[&#39;语文&#39;, &#39;英语&#39;, &#39;数学&#39;])\n\n\ndf = df.drop_duplicates()\n\ndf = df.fillna(0)\n\n\ndef plus(df):\n\tdf[&#39;总和&#39;] = df[&#39;语文&#39;] + df[&#39;英语&#39;] + df[&#39;数学&#39;]\n\treturn df\n\ndf = df.apply(plus, axis=1)\n\nprint &#39;&#39;\nprint df","like_count":0},{"had_liked":false,"id":96928,"user_name":"Geek_l0anid","can_delete":false,"product_type":"c1","uid":1258042,"ip_address":"","ucode":"96DE706AAC9D97","user_header":"https://static001.geekbang.org/account/avatar/00/13/32/3a/2d8a2c67.jpg","comment_is_top":false,"comment_ctime":1558537644,"is_pvip":false,"replies":null,"discussion_count":0,"race_medal":0,"score":16,"product_id":100021701,"comment_content":"score = {&#39;姓名&#39;:[&#39;张飞&#39;,&#39;关羽&#39;,&#39;赵云&#39;,&#39;黄忠&#39;,&#39;典韦&#39;,&#39;典韦&#39;],&#39;语文&#39;:[66,95,95,90,80,80],&#39;英语&#39;:[65,85,92,88,90,90],&#39;数学&#39;:[None,98,96,77,90,90]}\nheros_score = DataFrame(score)\nheros_score = heros_score.drop_duplicates()\na = heros_score[&#39;数学&#39;].mean()\nheros_score.loc[0,&#39;数学&#39;] = a\nheros_score[&#39;总和&#39;] = heros_score.sum(axis = 1)\nprint(heros_score)","like_count":0},{"had_liked":false,"id":95975,"user_name":"大斌","can_delete":false,"product_type":"c1","uid":1002183,"ip_address":"","ucode":"1434C2B0A29135","user_header":"https://static001.geekbang.org/account/avatar/00/0f/4a/c7/ec18673b.jpg","comment_is_top":false,"comment_ctime":1558281682,"is_pvip":false,"replies":null,"discussion_count":0,"race_medal":0,"score":16,"product_id":100021701,"comment_content":"最主要的数据结构是series和dataframe，提供的可用作数据清洗的函数有：drop()、rename()、drop_duplicates()、astype()、strip()、upper()、lower()、title()、isnull()、apply()","like_count":0},{"had_liked":false,"id":83059,"user_name":"滢","can_delete":false,"product_type":"c1","uid":1221511,"ip_address":"","ucode":"971A6F20AF3F9A","user_header":"https://static001.geekbang.org/account/avatar/00/12/a3/87/c415e370.jpg","comment_is_top":false,"comment_ctime":1554387835,"is_pvip":false,"replies":null,"discussion_count":0,"race_medal":0,"score":16,"product_id":100021701,"comment_content":"语言：Python3.6 环境：IDLE\n&gt;&gt;&gt; data={&#39;Chinese&#39;:[66,95,95,90,80,80],&#39;English&#39;:[65,85,92,88,90,90],&#39;Math&#39;:[None,98,96,77,90,90]}\n&gt;&gt;&gt; scoreframe = DataFrame(data,index=[&#39;张飞&#39;,&#39;关羽&#39;,&#39;赵云&#39;,&#39;黄忠&#39;,&#39;典韦&#39;,&#39;典韦&#39;],columns=[&#39;Chinese&#39;,&#39;English&#39;,&#39;Math&#39;])\n&gt;&gt;&gt; #删除重复数据\n&gt;&gt;&gt; scoreframe.drop_duplicates()\n    Chinese  English  Math\n张飞       66       65   NaN\n关羽       95       85  98.0\n赵云       95       92  96.0\n黄忠       90       88  77.0\n典韦       80       90  90.0\n&gt;&gt;&gt; #第一步：删除重复数据\n&gt;&gt;&gt; scoreframe.drop_duplicates()\n    Chinese  English  Math\n张飞       66       65   NaN\n关羽       95       85  98.0\n赵云       95       92  96.0\n黄忠       90       88  77.0\n典韦       80       90  90.0\n&gt;&gt;&gt; 第二步:#检查是否有空值\n&gt;&gt;&gt; scoreframe.isnull()\n    Chinese  English   Math\n张飞    False    False   True\n关羽    False    False  False\n赵云    False    False  False\n黄忠    False    False  False\n典韦    False    False  False\n典韦    False    False  False\n&gt;&gt;&gt; #对张飞的数学成绩进行补充\n&gt;&gt;&gt; scoreframe[&#39;Math&#39;].fillna(scoreframe[&#39;Math&#39;].mean(),inplace = True)\n&gt;&gt;&gt; #添加新的一行，求和\n&gt;&gt;&gt; def total_score(scoreframe):\n\tscoreframe[&#39;总分&#39;] = scoreframe.sum(axis=0)\n\treturn scoreframe\n\n &gt;&gt;&gt; scoreframe = scoreframe.apply(total_score,axis =1)\n    Chinese  English  Math     总分\n张飞     66.0     65.0  90.2  221.2\n关羽     95.0     85.0  98.0  278.0\n赵云     95.0     92.0  96.0  283.0\n黄忠     90.0     88.0  77.0  255.0\n典韦     80.0     90.0  90.0  260.0\n典韦     80.0     90.0  90.0  260.0\n&gt;&gt;&gt; #替换名称\n&gt;&gt;&gt; scoreframe.rename(columns={&#39;Chinese&#39;:&#39;语文&#39;,&#39;English&#39;:&#39;英语&#39;,&#39;Math&#39;:&#39;数学&#39;},inplace = True)\n&gt;&gt;&gt; print (scoreframe)\n      语文    英语    数学     总分\n张飞  66.0  65.0  90.2  221.2\n关羽  95.0  85.0  98.0  278.0\n赵云  95.0  92.0  96.0  283.0\n黄忠  90.0  88.0  77.0  255.0\n典韦  80.0  90.0  90.0  260.0\n典韦  80.0  90.0  90.0  260.0\n\n疑问：对于最左上角的姓名，该如何输入表格中？ 如果要对成绩进行排名，并自动填写上名词，该如何写？ ","like_count":0},{"had_liked":false,"id":82711,"user_name":"郑志宾","can_delete":false,"product_type":"c1","uid":1243448,"ip_address":"","ucode":"D9B010C9C71276","user_header":"https://static001.geekbang.org/account/avatar/00/12/f9/38/faec874e.jpg","comment_is_top":false,"comment_ctime":1554282272,"is_pvip":false,"replies":null,"discussion_count":0,"race_medal":0,"score":17,"product_id":100021701,"comment_content":"老师，数据表合并中的NaN 是怎么计算出来的，怎么出现的。例如 left 左连接中 df3 中data2 列中的 NaN 是怎么计算出来的，过程是怎么样？","like_count":0},{"had_liked":false,"id":74552,"user_name":"颖","can_delete":false,"product_type":"c1","uid":1446178,"ip_address":"","ucode":"05512CB7E87D46","user_header":"https://static001.geekbang.org/account/avatar/00/16/11/22/932aa49b.jpg","comment_is_top":false,"comment_ctime":1552233262,"is_pvip":false,"replies":null,"discussion_count":0,"race_medal":0,"score":17,"product_id":100021701,"comment_content":"def double_df(x):\n           return 2*x\ndf1[u&#39;语文&#39;] = df1[u&#39;语文&#39;].apply(double_df)\n这个运行报错：\nTypeError: cannot concatenate object of type &quot;&lt;class &#39;int&#39;&gt;&quot;; only pd.Series, pd.DataFrame, and pd.Panel (deprecated) objs are valid","like_count":0},{"had_liked":false,"id":68284,"user_name":"Sandy","can_delete":false,"product_type":"c1","uid":1239815,"ip_address":"","ucode":"3097343BDAB831","user_header":"http://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTKkpApOjdIb81ZHxeAup1IGH97eaD8oiawlCtUJdvct1AP6UfmmpYlE6r25tNM5cgOCgM3oAzpic5Aw/132","comment_is_top":false,"comment_ctime":1550477335,"is_pvip":false,"replies":null,"discussion_count":0,"race_medal":0,"score":17,"product_id":100021701,"comment_content":"# !&#47;usr&#47;bin&#47;env python\n# -*- coding: utf-8 -*-\nfrom pandas import DataFrame\n\ndef plus(df):\n    df[&#39;total&#39;] = df[&#39;Chinese&#39;]+df[&#39;English&#39;]+df[&#39;Math&#39;]\n    return df\n\ndata = {&#39;Chinese&#39;: [66, 95, 95, 90,80, 80],&#39;English&#39;: [65, 85, 92, 88, 90, 90],&#39;Math&#39;: [None, 98, 96, 77, 90, 90]}\ndf = DataFrame(data, index=[&#39;ZhangFei&#39;, &#39;GuanYu&#39;, &#39;ZhaoYun&#39;, &#39;HuangZhong&#39;, &#39;DianWei&#39;, &#39;DianWei&#39;], columns=[&#39;English&#39;, &#39;Math&#39;, &#39;Chinese&#39;])\n\n#去重\ndf = df.drop_duplicates()\n#查null\nprint(df.isnull().any())\n#平均值填null\ndf[&#39;Math&#39;].fillna(df[&#39;Math&#39;].mean(), inplace=True)\n#总分\ndf[&#39;total&#39;] = df[&#39;Chinese&#39;]+df[&#39;English&#39;]+df[&#39;Math&#39;]\n#df = df.apply(plus, axis=1)\n#排序\ndf.sort_values(&#39;total&#39;,ascending=False, inplace=True)\n\nprint(df)","like_count":0},{"had_liked":false,"id":67742,"user_name":"U.均宇","can_delete":false,"product_type":"c1","uid":1353610,"ip_address":"","ucode":"3B0AFDB11ACA96","user_header":"https://static001.geekbang.org/account/avatar/00/14/a7/8a/284465c6.jpg","comment_is_top":false,"comment_ctime":1550238399,"is_pvip":false,"replies":null,"discussion_count":0,"race_medal":0,"score":17,"product_id":100021701,"comment_content":"执行完代码： df2[&#39;Chinese&#39;]=df2[&#39;Chinese&#39;].map(str.strip)，只能输出‘Chinese&#39;这一列的数值。\n而如果这时执行print（df2），还是原来的df2(没有去除空格前的状态)\n有没有类似如inplace = True的办法，可以更改原表的值呢？期待老师解答\n","like_count":0},{"had_liked":false,"id":62759,"user_name":"Lambert","can_delete":false,"product_type":"c1","uid":1361833,"ip_address":"","ucode":"4518DC2ACEAFF1","user_header":"http://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTJnryDfaYkQh7mTgVIQqk4vdeuY2oa82w0yxOVNfsz4qfSMqEqPFE9gKFvlhS53xY6YOrib86Z6vPA/132","comment_is_top":false,"comment_ctime":1548149627,"is_pvip":false,"replies":null,"discussion_count":0,"race_medal":0,"score":17,"product_id":100021701,"comment_content":"import pandas as pd\nfrom pandas import DataFrame\ndata = {&#39;语文&#39;:[66,95,95,90,80,80],&#39;英语&#39;:[65,85,92,88,90,90],&#39;数学&#39;:[None,98,96,77,90,90]}\ndf1 = DataFrame(data)\ndf2 = DataFrame(data,index=[&#39;张飞&#39;, &#39;关羽&#39;,&#39;赵云&#39;, &#39;黄忠&#39;, &#39;典韦&#39;, &#39;典韦&#39;],\n                                 columns=[&#39;语文&#39;,&#39;英语&#39;,&#39;数学&#39;] )\ndf2 = df2.drop_duplicates()\ndf2[&#39;数学&#39;].fillna(df2[&#39;数学&#39;].mean(), inplace=True)\ndef add(df2):\n    df2[&#39;总和&#39;] = (df2[u&#39;语文&#39;] + df2[u&#39;英语&#39;] + df2[u&#39;数学&#39;])\n    return df2\ndf3 = df2.apply(add, axis=1,args=())\nprint(df3)","like_count":0},{"had_liked":false,"id":62140,"user_name":"Mickey","can_delete":false,"product_type":"c1","uid":1387985,"ip_address":"","ucode":"2C89B997DC81FC","user_header":"http://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTLfibmKDlXhXnU0JiaDKG8JcqtjiafA4Ktyiaic34VTLpY80rXovJbtq27NTtWtNjUWAL5O9ic6NKVbbLtg/132","comment_is_top":false,"comment_ctime":1547954949,"is_pvip":false,"replies":null,"discussion_count":0,"race_medal":0,"score":17,"product_id":100021701,"comment_content":"在存入excel的时候，写score.to_excel(&#39;data.xlsx&#39;)时报错No module named &#39;openpyxl&#39; 。\n根据知道安装了openpyxl, 然后怎么运行存入excel的操作呢？能否详细说明下？","like_count":0},{"had_liked":false,"id":61081,"user_name":"胖陶","can_delete":false,"product_type":"c1","uid":1372987,"ip_address":"","ucode":"EE32D91A3BC0F3","user_header":"https://static001.geekbang.org/account/avatar/00/14/f3/3b/15ffb7c3.jpg","comment_is_top":false,"comment_ctime":1547616188,"is_pvip":false,"replies":null,"discussion_count":0,"race_medal":0,"score":17,"product_id":100021701,"comment_content":"import numpy as np\nfrom pandas import DataFrame\ndata={&#39;yuwen&#39;:[66,95,95,90,80,80],&#39;yingyu&#39;:[65,85,92,88,90,90],&#39;shuxue&#39;:[np.nan,98,96,77,90,90]}\ndf=DataFrame(data,index=[&#39;zhangfei&#39;,&#39;guanyu&#39;,&#39;zhaoyun&#39;,&#39;huangzhong&#39;,&#39;dianwei&#39;,&#39;dianwei&#39;],columns=[&#39;yuwen&#39;,&#39;yingyu&#39;,&#39;shuxue&#39;])\ndf.drop_duplicates()\ndf[&#39;shuxue&#39;]=df[&#39;shuxue&#39;].fillna(df[&#39;shuxue&#39;].mean())\ndf[&#39;sum&#39;]=df[&#39;yuwen&#39;]+df[&#39;yingyu&#39;]+df[&#39;shuxue&#39;]\ndf.rename(columns={&#39;yuwen&#39;:&#39;语文&#39;,&#39;yingyu&#39;:&#39;英语&#39;,&#39;shuxue&#39;:&#39;数学&#39;,&#39;sum&#39;:&#39;总和&#39;},inplace=True)\n","like_count":0},{"had_liked":false,"id":60865,"user_name":"胖陶","can_delete":false,"product_type":"c1","uid":1372987,"ip_address":"","ucode":"EE32D91A3BC0F3","user_header":"https://static001.geekbang.org/account/avatar/00/14/f3/3b/15ffb7c3.jpg","comment_is_top":false,"comment_ctime":1547564371,"is_pvip":false,"replies":null,"discussion_count":0,"race_medal":0,"score":17,"product_id":100021701,"comment_content":"删除列那边的代码会报错啊。。。。df2 = df2.drop([&#39;Chinese&#39;],axis=1)\n","like_count":0},{"had_liked":false,"id":58253,"user_name":"黑小白白白","can_delete":false,"product_type":"c1","uid":1189393,"ip_address":"","ucode":"FFCAC581306F94","user_header":"https://static001.geekbang.org/account/avatar/00/12/26/11/5d2d7b0f.jpg","comment_is_top":false,"comment_ctime":1547019951,"is_pvip":false,"replies":null,"discussion_count":0,"race_medal":0,"score":17,"product_id":100021701,"comment_content":"请教老师，Python3中DataFrame如何对列名是中文的数据进行操作呢。","like_count":0},{"had_liked":false,"id":58243,"user_name":"孙有能希","can_delete":false,"product_type":"c1","uid":1057071,"ip_address":"","ucode":"3FE607B46018F4","user_header":"https://static001.geekbang.org/account/avatar/00/10/21/2f/85a3c897.jpg","comment_is_top":false,"comment_ctime":1547017011,"is_pvip":false,"replies":null,"discussion_count":0,"race_medal":0,"score":17,"product_id":100021701,"comment_content":"data = {&#39;Chinese&#39;: [66, 95, 95, 90, 80, 80], &#39;English&#39;:[65, 85, 92, 88, 90, 90], &#39;Math&#39;:[None, 98, 96, 77, 90, 90]}\ndf = DataFrame(data, index=[&#39;ZhangFei&#39;, &#39;GuanYu&#39;, &#39;ZhaoYun&#39;, &#39;HuangZhong&#39;, &#39;Dianwei&#39;, &#39;Dianwei&#39;], columns=[&#39;Chinese&#39;, &#39;English&#39;, &#39;Math&#39;])\nprint(df)\n\ndf = df.drop_duplicates()\ndf = df.fillna(df.mean())\n\ndf[&#39;All&#39;] = df[&#39;Chinese&#39;] + df[&#39;English&#39;] + df[&#39;Math&#39;]\nprint(df)","like_count":0},{"had_liked":false,"id":82711,"user_name":"郑志宾","can_delete":false,"product_type":"c1","uid":1243448,"ip_address":"","ucode":"D9B010C9C71276","user_header":"https://static001.geekbang.org/account/avatar/00/12/f9/38/faec874e.jpg","comment_is_top":false,"comment_ctime":1554282272,"is_pvip":false,"replies":null,"discussion_count":0,"race_medal":0,"score":17,"product_id":100021701,"comment_content":"老师，数据表合并中的NaN 是怎么计算出来的，怎么出现的。例如 left 左连接中 df3 中data2 列中的 NaN 是怎么计算出来的，过程是怎么样？","like_count":0},{"had_liked":false,"id":74552,"user_name":"颖","can_delete":false,"product_type":"c1","uid":1446178,"ip_address":"","ucode":"05512CB7E87D46","user_header":"https://static001.geekbang.org/account/avatar/00/16/11/22/932aa49b.jpg","comment_is_top":false,"comment_ctime":1552233262,"is_pvip":false,"replies":null,"discussion_count":0,"race_medal":0,"score":17,"product_id":100021701,"comment_content":"def double_df(x):\n           return 2*x\ndf1[u&#39;语文&#39;] = df1[u&#39;语文&#39;].apply(double_df)\n这个运行报错：\nTypeError: cannot concatenate object of type &quot;&lt;class &#39;int&#39;&gt;&quot;; only pd.Series, pd.DataFrame, and pd.Panel (deprecated) objs are valid","like_count":0},{"had_liked":false,"id":68284,"user_name":"Sandy","can_delete":false,"product_type":"c1","uid":1239815,"ip_address":"","ucode":"3097343BDAB831","user_header":"http://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTKkpApOjdIb81ZHxeAup1IGH97eaD8oiawlCtUJdvct1AP6UfmmpYlE6r25tNM5cgOCgM3oAzpic5Aw/132","comment_is_top":false,"comment_ctime":1550477335,"is_pvip":false,"replies":null,"discussion_count":0,"race_medal":0,"score":17,"product_id":100021701,"comment_content":"# !&#47;usr&#47;bin&#47;env python\n# -*- coding: utf-8 -*-\nfrom pandas import DataFrame\n\ndef plus(df):\n    df[&#39;total&#39;] = df[&#39;Chinese&#39;]+df[&#39;English&#39;]+df[&#39;Math&#39;]\n    return df\n\ndata = {&#39;Chinese&#39;: [66, 95, 95, 90,80, 80],&#39;English&#39;: [65, 85, 92, 88, 90, 90],&#39;Math&#39;: [None, 98, 96, 77, 90, 90]}\ndf = DataFrame(data, index=[&#39;ZhangFei&#39;, &#39;GuanYu&#39;, &#39;ZhaoYun&#39;, &#39;HuangZhong&#39;, &#39;DianWei&#39;, &#39;DianWei&#39;], columns=[&#39;English&#39;, &#39;Math&#39;, &#39;Chinese&#39;])\n\n#去重\ndf = df.drop_duplicates()\n#查null\nprint(df.isnull().any())\n#平均值填null\ndf[&#39;Math&#39;].fillna(df[&#39;Math&#39;].mean(), inplace=True)\n#总分\ndf[&#39;total&#39;] = df[&#39;Chinese&#39;]+df[&#39;English&#39;]+df[&#39;Math&#39;]\n#df = df.apply(plus, axis=1)\n#排序\ndf.sort_values(&#39;total&#39;,ascending=False, inplace=True)\n\nprint(df)","like_count":0},{"had_liked":false,"id":67742,"user_name":"U.均宇","can_delete":false,"product_type":"c1","uid":1353610,"ip_address":"","ucode":"3B0AFDB11ACA96","user_header":"https://static001.geekbang.org/account/avatar/00/14/a7/8a/284465c6.jpg","comment_is_top":false,"comment_ctime":1550238399,"is_pvip":false,"replies":null,"discussion_count":0,"race_medal":0,"score":17,"product_id":100021701,"comment_content":"执行完代码： df2[&#39;Chinese&#39;]=df2[&#39;Chinese&#39;].map(str.strip)，只能输出‘Chinese&#39;这一列的数值。\n而如果这时执行print（df2），还是原来的df2(没有去除空格前的状态)\n有没有类似如inplace = True的办法，可以更改原表的值呢？期待老师解答\n","like_count":0},{"had_liked":false,"id":62759,"user_name":"Lambert","can_delete":false,"product_type":"c1","uid":1361833,"ip_address":"","ucode":"4518DC2ACEAFF1","user_header":"http://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTJnryDfaYkQh7mTgVIQqk4vdeuY2oa82w0yxOVNfsz4qfSMqEqPFE9gKFvlhS53xY6YOrib86Z6vPA/132","comment_is_top":false,"comment_ctime":1548149627,"is_pvip":false,"replies":null,"discussion_count":0,"race_medal":0,"score":17,"product_id":100021701,"comment_content":"import pandas as pd\nfrom pandas import DataFrame\ndata = {&#39;语文&#39;:[66,95,95,90,80,80],&#39;英语&#39;:[65,85,92,88,90,90],&#39;数学&#39;:[None,98,96,77,90,90]}\ndf1 = DataFrame(data)\ndf2 = DataFrame(data,index=[&#39;张飞&#39;, &#39;关羽&#39;,&#39;赵云&#39;, &#39;黄忠&#39;, &#39;典韦&#39;, &#39;典韦&#39;],\n                                 columns=[&#39;语文&#39;,&#39;英语&#39;,&#39;数学&#39;] )\ndf2 = df2.drop_duplicates()\ndf2[&#39;数学&#39;].fillna(df2[&#39;数学&#39;].mean(), inplace=True)\ndef add(df2):\n    df2[&#39;总和&#39;] = (df2[u&#39;语文&#39;] + df2[u&#39;英语&#39;] + df2[u&#39;数学&#39;])\n    return df2\ndf3 = df2.apply(add, axis=1,args=())\nprint(df3)","like_count":0},{"had_liked":false,"id":62140,"user_name":"Mickey","can_delete":false,"product_type":"c1","uid":1387985,"ip_address":"","ucode":"2C89B997DC81FC","user_header":"http://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTLfibmKDlXhXnU0JiaDKG8JcqtjiafA4Ktyiaic34VTLpY80rXovJbtq27NTtWtNjUWAL5O9ic6NKVbbLtg/132","comment_is_top":false,"comment_ctime":1547954949,"is_pvip":false,"replies":null,"discussion_count":0,"race_medal":0,"score":17,"product_id":100021701,"comment_content":"在存入excel的时候，写score.to_excel(&#39;data.xlsx&#39;)时报错No module named &#39;openpyxl&#39; 。\n根据知道安装了openpyxl, 然后怎么运行存入excel的操作呢？能否详细说明下？","like_count":0},{"had_liked":false,"id":61081,"user_name":"胖陶","can_delete":false,"product_type":"c1","uid":1372987,"ip_address":"","ucode":"EE32D91A3BC0F3","user_header":"https://static001.geekbang.org/account/avatar/00/14/f3/3b/15ffb7c3.jpg","comment_is_top":false,"comment_ctime":1547616188,"is_pvip":false,"replies":null,"discussion_count":0,"race_medal":0,"score":17,"product_id":100021701,"comment_content":"import numpy as np\nfrom pandas import DataFrame\ndata={&#39;yuwen&#39;:[66,95,95,90,80,80],&#39;yingyu&#39;:[65,85,92,88,90,90],&#39;shuxue&#39;:[np.nan,98,96,77,90,90]}\ndf=DataFrame(data,index=[&#39;zhangfei&#39;,&#39;guanyu&#39;,&#39;zhaoyun&#39;,&#39;huangzhong&#39;,&#39;dianwei&#39;,&#39;dianwei&#39;],columns=[&#39;yuwen&#39;,&#39;yingyu&#39;,&#39;shuxue&#39;])\ndf.drop_duplicates()\ndf[&#39;shuxue&#39;]=df[&#39;shuxue&#39;].fillna(df[&#39;shuxue&#39;].mean())\ndf[&#39;sum&#39;]=df[&#39;yuwen&#39;]+df[&#39;yingyu&#39;]+df[&#39;shuxue&#39;]\ndf.rename(columns={&#39;yuwen&#39;:&#39;语文&#39;,&#39;yingyu&#39;:&#39;英语&#39;,&#39;shuxue&#39;:&#39;数学&#39;,&#39;sum&#39;:&#39;总和&#39;},inplace=True)\n","like_count":0},{"had_liked":false,"id":60865,"user_name":"胖陶","can_delete":false,"product_type":"c1","uid":1372987,"ip_address":"","ucode":"EE32D91A3BC0F3","user_header":"https://static001.geekbang.org/account/avatar/00/14/f3/3b/15ffb7c3.jpg","comment_is_top":false,"comment_ctime":1547564371,"is_pvip":false,"replies":null,"discussion_count":0,"race_medal":0,"score":17,"product_id":100021701,"comment_content":"删除列那边的代码会报错啊。。。。df2 = df2.drop([&#39;Chinese&#39;],axis=1)\n","like_count":0},{"had_liked":false,"id":58253,"user_name":"黑小白白白","can_delete":false,"product_type":"c1","uid":1189393,"ip_address":"","ucode":"FFCAC581306F94","user_header":"https://static001.geekbang.org/account/avatar/00/12/26/11/5d2d7b0f.jpg","comment_is_top":false,"comment_ctime":1547019951,"is_pvip":false,"replies":null,"discussion_count":0,"race_medal":0,"score":17,"product_id":100021701,"comment_content":"请教老师，Python3中DataFrame如何对列名是中文的数据进行操作呢。","like_count":0},{"had_liked":false,"id":58243,"user_name":"孙有能希","can_delete":false,"product_type":"c1","uid":1057071,"ip_address":"","ucode":"3FE607B46018F4","user_header":"https://static001.geekbang.org/account/avatar/00/10/21/2f/85a3c897.jpg","comment_is_top":false,"comment_ctime":1547017011,"is_pvip":false,"replies":null,"discussion_count":0,"race_medal":0,"score":17,"product_id":100021701,"comment_content":"data = {&#39;Chinese&#39;: [66, 95, 95, 90, 80, 80], &#39;English&#39;:[65, 85, 92, 88, 90, 90], &#39;Math&#39;:[None, 98, 96, 77, 90, 90]}\ndf = DataFrame(data, index=[&#39;ZhangFei&#39;, &#39;GuanYu&#39;, &#39;ZhaoYun&#39;, &#39;HuangZhong&#39;, &#39;Dianwei&#39;, &#39;Dianwei&#39;], columns=[&#39;Chinese&#39;, &#39;English&#39;, &#39;Math&#39;])\nprint(df)\n\ndf = df.drop_duplicates()\ndf = df.fillna(df.mean())\n\ndf[&#39;All&#39;] = df[&#39;Chinese&#39;] + df[&#39;English&#39;] + df[&#39;Math&#39;]\nprint(df)","like_count":0},{"had_liked":false,"id":58168,"user_name":"外星人","can_delete":false,"product_type":"c1","uid":1354627,"ip_address":"","ucode":"5596A6085B24C3","user_header":"https://static001.geekbang.org/account/avatar/00/14/ab/83/185cb0c9.jpg","comment_is_top":false,"comment_ctime":1547005785,"is_pvip":false,"replies":null,"discussion_count":0,"race_medal":0,"score":18,"product_id":100021701,"comment_content":"import pandas as pd\nfrom pandas import Series, DataFrame\nfrom pandasql import sqldf, load_meat, load_births\n\n# 对数据进行清洗。同时新增一列“总和”计算每个人的三科成绩之和\n\nscore = DataFrame(pd.read_excel(&#39;E:&#47;item_python&#47;test&#47;pandas&#47;exercise1.xlsx&#39;))\nprint(score)\n\nscore = score.drop_duplicates()  #去重\n\ndefault = {&#39;姓名&#39;:&#39;无名氏&#39;,&#39;语文&#39;:0,&#39;英语&#39;:0,&#39;数学&#39;:0}\n#score[&#39;数学&#39;].fillna(0,inplace=True) #补空值\nscore = score.fillna(default)\nprint(score)\n\ndef plus(df):\n    df[&#39;总和&#39;] = df[&#39;语文&#39;]+df[&#39;英语&#39;]+df[&#39;数学&#39;]\n    return df\nscore = score.apply(plus, axis=1)  #求和\nprint(score)","like_count":0},{"had_liked":false,"id":57710,"user_name":"xfoolin","can_delete":false,"product_type":"c1","uid":1352218,"ip_address":"","ucode":"F63BF326141F46","user_header":"http://thirdwx.qlogo.cn/mmopen/vi_32/DYAIOgq83erBSoNm28CNCYpvytDbhfSYpgCo6T9vuzKkSoflr3sX8VucMz8ykrichKDY9vVoMVomUIakXSQq9icw/132","comment_is_top":false,"comment_ctime":1546872903,"is_pvip":false,"replies":null,"discussion_count":0,"race_medal":0,"score":18,"product_id":100021701,"comment_content":"一、 \n\n在Pandas 有两个数据结构，分别是 Series 和 DataFrame。\n\nDataFrame 提供的数据清洗函数是： \n\n- 删除 drop,\n- 删除重复行 drop_duplicates\n- 重命名列名 rename\n- 格式转换 astype\n- 去除空格 strip\n- 大小写转换（upper,lower,title）\n- 查找空值 isnull 和 isnull().any()\n- 使用 apply函数来嵌套其他函数实现更多要求\n\n二、\nimport pandas as pd\nfrom pandas import DataFrame\nscores = DataFrame({&#39;姓名&#39;:[&#39;张飞&#39;,&#39;关羽&#39;,&#39;赵云&#39;,&#39;黄忠&#39;,&#39;典韦&#39;,&#39;典韦&#39;],\n                    &#39;语文&#39;:[66,95,95,90,80,80],\n                    &#39;英语&#39;:[65,85,92,88,90,90],\n                    &#39;数学&#39;:[None,98,96,77,90,90]\n                    })\nprint(scores)\nscores = scores.drop_duplicates()\nprint(scores.isnull().any())\nscores = scores.fillna(0)\nscores[&#39;总和&#39;] = scores.sum(axis = 1)\nprint(scores)","like_count":0},{"had_liked":false,"id":57627,"user_name":"灵灵","can_delete":false,"product_type":"c1","uid":1327225,"ip_address":"","ucode":"F5FA615E8B46FB","user_header":"https://static001.geekbang.org/account/avatar/00/14/40/79/b8dbf66a.jpg","comment_is_top":false,"comment_ctime":1546854633,"is_pvip":false,"replies":null,"discussion_count":0,"race_medal":0,"score":18,"product_id":100021701,"comment_content":"# -- coding: utf-8 -\n\nimport numpy as np\nimport pandas as pd\nfrom pandas import Series,DataFrame\nfrom numpy import nan as NaN\n\ndate = DataFrame({&#39;姓名&#39;:[&#39;张飞&#39;,&#39;关羽&#39;,&#39;赵云&#39;,&#39;黄忠&#39;,&#39;典韦&#39;,&#39;典韦&#39;],&#39;语文&#39;:[66,95,95,90,80,80],&#39;英语&#39;:[65,85,92,88,90,90],&#39;数学&#39;:[NaN,98,96,77,90,90]})\nprint (date)\n\ndf1 = date.drop_duplicates()\nprint (df1)\n\ndf2 = df1.copy()\ndf2[&#39;数学&#39;].fillna(df2[&#39;数学&#39;].mean(), inplace=True)\n\nprint (df2)\n\ndef totaiscore(df2):\n    df2[&#39;总分&#39;]=df2[&#39;语文&#39;]+df2[&#39;英语&#39;]+df2[&#39;数学&#39;]\n    return df2\n\nprint (totaiscore(df2))\n","like_count":0},{"had_liked":false,"id":57441,"user_name":"伍俊滨","can_delete":false,"product_type":"c1","uid":1083959,"ip_address":"","ucode":"D96CA824F7B462","user_header":"https://static001.geekbang.org/account/avatar/00/10/8a/37/92b98544.jpg","comment_is_top":false,"comment_ctime":1546791589,"is_pvip":false,"replies":null,"discussion_count":0,"race_medal":0,"score":18,"product_id":100021701,"comment_content":"第五讲笔记\nhttps:&#47;&#47;mubu.com&#47;doc&#47;3QadR_xU7v","like_count":0},{"had_liked":false,"id":57372,"user_name":"陈亦凡","can_delete":false,"product_type":"c1","uid":1071734,"ip_address":"","ucode":"52A0731541792D","user_header":"https://static001.geekbang.org/account/avatar/00/10/5a/76/3f8dcda6.jpg","comment_is_top":false,"comment_ctime":1546770151,"is_pvip":false,"replies":null,"discussion_count":0,"race_medal":0,"score":18,"product_id":100021701,"comment_content":"https:&#47;&#47;github.com&#47;26huitailang&#47;python-of-data-analysis&#47;blob&#47;master&#47;geek-time&#47;ch05-pandas.ipynb\n\n👆上面是我用jupyter写的，可以在线查看，参考了其他同学平均值补全的方法。","like_count":0},{"had_liked":false,"id":57344,"user_name":"胡","can_delete":false,"product_type":"c1","uid":1353712,"ip_address":"","ucode":"3917AFED7701CA","user_header":"https://static001.geekbang.org/account/avatar/00/14/a7/f0/e3212f18.jpg","comment_is_top":false,"comment_ctime":1546757598,"is_pvip":false,"replies":null,"discussion_count":0,"race_medal":0,"score":18,"product_id":100021701,"comment_content":"__author__ = &#39;Administrator&#39;\n\nimport pandas  as pd\nfrom pandas import DataFrame\nfrom pandasql  import sqldf\ndata={&#39;语文&#39;:[66,95,95,90,80,80],&#39;英语&#39;:[65,85,92,88,90,90],&#39;数学&#39;:[None,98,96,77,90,90]}\ndf1=pd.DataFrame(data,index=[&#39;张飞&#39;,&#39;关羽&#39;,&#39;赵云&#39;,&#39;黄忠&#39;,&#39;典韦&#39;,&#39;典韦&#39;],columns=[&#39;英语&#39;, &#39;数学&#39;, &#39;语文&#39;])\nprint(df1)\ndf1=df1.drop_duplicates()#去重\nprint(df1)\nprint(df1.isnull())#显示那边有空值\n\ndf1[&#39;数学&#39;].fillna(df1[&#39;数学&#39;].mean(), inplace=True)\n\nprint(df1)\n\ndf1[&#39;总分&#39;] = df1[&#39;语文&#39;] + df1[&#39;英语&#39;] + df1[&#39;数学&#39;]#这样操作就会插入新的一列\n\nprint(df1)","like_count":0},{"had_liked":false,"id":57172,"user_name":"易平","can_delete":false,"product_type":"c1","uid":1356284,"ip_address":"","ucode":"87821C032D7499","user_header":"https://static001.geekbang.org/account/avatar/00/14/b1/fc/8503c08a.jpg","comment_is_top":false,"comment_ctime":1546671646,"is_pvip":false,"replies":null,"discussion_count":0,"race_medal":0,"score":18,"product_id":100021701,"comment_content":"#作业创建成绩数据表，并新增一列总和\ndata2={&#39;姓名&#39;:[&#39;张飞&#39;,&#39;关羽&#39;,&#39;赵云&#39;,&#39;黄忠&#39;,&#39;典韦&#39;,&#39;典韦&#39;],&#39;语文&#39;:[66,95,95,90,80,80],&#39;英语&#39;:[65,85,92,88,90,90],&#39;数学&#39;:[None,98,96,77,90,90]}\ndf8=pd.DataFrame(data2)\n\n#去除重复\ndf9=df8.drop_duplicates()\n\n#排查空值和用0分代替空值\ndf9.isnull().any()\n#补全张飞的数学成绩\ndf9=df9.fillna(0)\n\n\n\n#求和\ndef count_score(df):\n    df[&#39;总分&#39;]=df[&#39;语文&#39;]+df[&#39;英语&#39;]+df[&#39;数学&#39;]\n    return df\n    \ndf9=df9.apply(count_score,axis=1)\n\nprint(df9)","like_count":0},{"had_liked":false,"id":56323,"user_name":"瑞","can_delete":false,"product_type":"c1","uid":1354236,"ip_address":"","ucode":"529AA74D89FEF3","user_header":"https://static001.geekbang.org/account/avatar/00/14/a9/fc/6d7df2b9.jpg","comment_is_top":false,"comment_ctime":1546421795,"is_pvip":false,"replies":null,"discussion_count":0,"race_medal":0,"score":18,"product_id":100021701,"comment_content":"我也是这个问题，用的python3，df2[&#39;English&#39;]=df2[&#39;English&#39;].map(str.strip)这个也有问题\ndf2 = df2.drop(columns=[&#39;Chinese&#39;]) 这行代码后,返回结果是:\nTypeError Traceback (most recent call last)\n&lt;ipython-input-25-8116650c61ac&gt; in &lt;module&gt;()\n----&gt; 1 df2 = df2.drop(columns=[&#39;Chinese&#39;])\n\nTypeError: drop() got an unexpected keyword argument &#39;columns&#39;","like_count":0},{"had_liked":false,"id":56308,"user_name":"瑞","can_delete":false,"product_type":"c1","uid":1354236,"ip_address":"","ucode":"529AA74D89FEF3","user_header":"https://static001.geekbang.org/account/avatar/00/14/a9/fc/6d7df2b9.jpg","comment_is_top":false,"comment_ctime":1546419423,"is_pvip":false,"replies":null,"discussion_count":0,"race_medal":0,"score":18,"product_id":100021701,"comment_content":"python3 \ndf2=df2.drop(index=[&#39;zhangfei&#39;]) 报错","like_count":0},{"had_liked":false,"id":55906,"user_name":"I.L","can_delete":false,"product_type":"c1","uid":1352435,"ip_address":"","ucode":"965523A3BC7029","user_header":"https://static001.geekbang.org/account/avatar/00/14/a2/f3/801c2561.jpg","comment_is_top":false,"comment_ctime":1546344900,"is_pvip":false,"replies":null,"discussion_count":0,"race_medal":0,"score":18,"product_id":100021701,"comment_content":"import pandas as pd\ndata = {&#39;姓名&#39;: [&#39;张飞&#39;, &#39;关羽&#39;, &#39;赵云&#39;, &#39;黄忠&#39;, &#39;典韦&#39;, &#39;典韦&#39;],\n        &#39;语文&#39;: [66, 95, 95, 90, 80, 80],\n        &#39;英语&#39;: [65, 85, 92, 88, 90, 90],\n        &#39;数学&#39;: [None,98, 96, 77, 90, 90]}\ndata_table = pd.DataFrame(data)\ndata_table = data_table.drop_duplicates()\ndata_table[&#39;数学&#39;].fillna(data_table[&#39;数学&#39;].mean(), inplace=True)\ndata_table[&#39;总和&#39;] = data_table[&#39;英语&#39;] + data_table[&#39;语文&#39;] + data_table[&#39;数学&#39;]\ndata_table\n#注意点：\n#Dataframe中的apply函数类似于map函数\n#在apply例子中：\n#df1.apply(plus, axis=1, args=(2,3,))\n#可以在apply函数的args参数中传递对应函数（plus）的参数\n#inner left right outer就像SQL中的inner left right full\n#其中通过SQL方式对Dataframe进行查询的方式很棒，之前没有了解过\n\n#正如热评中的做法，数据的清洗过程需要的不仅仅是删除，更多的应该是近似值填充\n","like_count":0},{"had_liked":false,"id":58168,"user_name":"外星人","can_delete":false,"product_type":"c1","uid":1354627,"ip_address":"","ucode":"5596A6085B24C3","user_header":"https://static001.geekbang.org/account/avatar/00/14/ab/83/185cb0c9.jpg","comment_is_top":false,"comment_ctime":1547005785,"is_pvip":false,"replies":null,"discussion_count":0,"race_medal":0,"score":18,"product_id":100021701,"comment_content":"import pandas as pd\nfrom pandas import Series, DataFrame\nfrom pandasql import sqldf, load_meat, load_births\n\n# 对数据进行清洗。同时新增一列“总和”计算每个人的三科成绩之和\n\nscore = DataFrame(pd.read_excel(&#39;E:&#47;item_python&#47;test&#47;pandas&#47;exercise1.xlsx&#39;))\nprint(score)\n\nscore = score.drop_duplicates()  #去重\n\ndefault = {&#39;姓名&#39;:&#39;无名氏&#39;,&#39;语文&#39;:0,&#39;英语&#39;:0,&#39;数学&#39;:0}\n#score[&#39;数学&#39;].fillna(0,inplace=True) #补空值\nscore = score.fillna(default)\nprint(score)\n\ndef plus(df):\n    df[&#39;总和&#39;] = df[&#39;语文&#39;]+df[&#39;英语&#39;]+df[&#39;数学&#39;]\n    return df\nscore = score.apply(plus, axis=1)  #求和\nprint(score)","like_count":0},{"had_liked":false,"id":57710,"user_name":"xfoolin","can_delete":false,"product_type":"c1","uid":1352218,"ip_address":"","ucode":"F63BF326141F46","user_header":"http://thirdwx.qlogo.cn/mmopen/vi_32/DYAIOgq83erBSoNm28CNCYpvytDbhfSYpgCo6T9vuzKkSoflr3sX8VucMz8ykrichKDY9vVoMVomUIakXSQq9icw/132","comment_is_top":false,"comment_ctime":1546872903,"is_pvip":false,"replies":null,"discussion_count":0,"race_medal":0,"score":18,"product_id":100021701,"comment_content":"一、 \n\n在Pandas 有两个数据结构，分别是 Series 和 DataFrame。\n\nDataFrame 提供的数据清洗函数是： \n\n- 删除 drop,\n- 删除重复行 drop_duplicates\n- 重命名列名 rename\n- 格式转换 astype\n- 去除空格 strip\n- 大小写转换（upper,lower,title）\n- 查找空值 isnull 和 isnull().any()\n- 使用 apply函数来嵌套其他函数实现更多要求\n\n二、\nimport pandas as pd\nfrom pandas import DataFrame\nscores = DataFrame({&#39;姓名&#39;:[&#39;张飞&#39;,&#39;关羽&#39;,&#39;赵云&#39;,&#39;黄忠&#39;,&#39;典韦&#39;,&#39;典韦&#39;],\n                    &#39;语文&#39;:[66,95,95,90,80,80],\n                    &#39;英语&#39;:[65,85,92,88,90,90],\n                    &#39;数学&#39;:[None,98,96,77,90,90]\n                    })\nprint(scores)\nscores = scores.drop_duplicates()\nprint(scores.isnull().any())\nscores = scores.fillna(0)\nscores[&#39;总和&#39;] = scores.sum(axis = 1)\nprint(scores)","like_count":0},{"had_liked":false,"id":57627,"user_name":"灵灵","can_delete":false,"product_type":"c1","uid":1327225,"ip_address":"","ucode":"F5FA615E8B46FB","user_header":"https://static001.geekbang.org/account/avatar/00/14/40/79/b8dbf66a.jpg","comment_is_top":false,"comment_ctime":1546854633,"is_pvip":false,"replies":null,"discussion_count":0,"race_medal":0,"score":18,"product_id":100021701,"comment_content":"# -- coding: utf-8 -\n\nimport numpy as np\nimport pandas as pd\nfrom pandas import Series,DataFrame\nfrom numpy import nan as NaN\n\ndate = DataFrame({&#39;姓名&#39;:[&#39;张飞&#39;,&#39;关羽&#39;,&#39;赵云&#39;,&#39;黄忠&#39;,&#39;典韦&#39;,&#39;典韦&#39;],&#39;语文&#39;:[66,95,95,90,80,80],&#39;英语&#39;:[65,85,92,88,90,90],&#39;数学&#39;:[NaN,98,96,77,90,90]})\nprint (date)\n\ndf1 = date.drop_duplicates()\nprint (df1)\n\ndf2 = df1.copy()\ndf2[&#39;数学&#39;].fillna(df2[&#39;数学&#39;].mean(), inplace=True)\n\nprint (df2)\n\ndef totaiscore(df2):\n    df2[&#39;总分&#39;]=df2[&#39;语文&#39;]+df2[&#39;英语&#39;]+df2[&#39;数学&#39;]\n    return df2\n\nprint (totaiscore(df2))\n","like_count":0},{"had_liked":false,"id":57441,"user_name":"伍俊滨","can_delete":false,"product_type":"c1","uid":1083959,"ip_address":"","ucode":"D96CA824F7B462","user_header":"https://static001.geekbang.org/account/avatar/00/10/8a/37/92b98544.jpg","comment_is_top":false,"comment_ctime":1546791589,"is_pvip":false,"replies":null,"discussion_count":0,"race_medal":0,"score":18,"product_id":100021701,"comment_content":"第五讲笔记\nhttps:&#47;&#47;mubu.com&#47;doc&#47;3QadR_xU7v","like_count":0},{"had_liked":false,"id":57372,"user_name":"陈亦凡","can_delete":false,"product_type":"c1","uid":1071734,"ip_address":"","ucode":"52A0731541792D","user_header":"https://static001.geekbang.org/account/avatar/00/10/5a/76/3f8dcda6.jpg","comment_is_top":false,"comment_ctime":1546770151,"is_pvip":false,"replies":null,"discussion_count":0,"race_medal":0,"score":18,"product_id":100021701,"comment_content":"https:&#47;&#47;github.com&#47;26huitailang&#47;python-of-data-analysis&#47;blob&#47;master&#47;geek-time&#47;ch05-pandas.ipynb\n\n👆上面是我用jupyter写的，可以在线查看，参考了其他同学平均值补全的方法。","like_count":0},{"had_liked":false,"id":57344,"user_name":"胡","can_delete":false,"product_type":"c1","uid":1353712,"ip_address":"","ucode":"3917AFED7701CA","user_header":"https://static001.geekbang.org/account/avatar/00/14/a7/f0/e3212f18.jpg","comment_is_top":false,"comment_ctime":1546757598,"is_pvip":false,"replies":null,"discussion_count":0,"race_medal":0,"score":18,"product_id":100021701,"comment_content":"__author__ = &#39;Administrator&#39;\n\nimport pandas  as pd\nfrom pandas import DataFrame\nfrom pandasql  import sqldf\ndata={&#39;语文&#39;:[66,95,95,90,80,80],&#39;英语&#39;:[65,85,92,88,90,90],&#39;数学&#39;:[None,98,96,77,90,90]}\ndf1=pd.DataFrame(data,index=[&#39;张飞&#39;,&#39;关羽&#39;,&#39;赵云&#39;,&#39;黄忠&#39;,&#39;典韦&#39;,&#39;典韦&#39;],columns=[&#39;英语&#39;, &#39;数学&#39;, &#39;语文&#39;])\nprint(df1)\ndf1=df1.drop_duplicates()#去重\nprint(df1)\nprint(df1.isnull())#显示那边有空值\n\ndf1[&#39;数学&#39;].fillna(df1[&#39;数学&#39;].mean(), inplace=True)\n\nprint(df1)\n\ndf1[&#39;总分&#39;] = df1[&#39;语文&#39;] + df1[&#39;英语&#39;] + df1[&#39;数学&#39;]#这样操作就会插入新的一列\n\nprint(df1)","like_count":0},{"had_liked":false,"id":57172,"user_name":"易平","can_delete":false,"product_type":"c1","uid":1356284,"ip_address":"","ucode":"87821C032D7499","user_header":"https://static001.geekbang.org/account/avatar/00/14/b1/fc/8503c08a.jpg","comment_is_top":false,"comment_ctime":1546671646,"is_pvip":false,"replies":null,"discussion_count":0,"race_medal":0,"score":18,"product_id":100021701,"comment_content":"#作业创建成绩数据表，并新增一列总和\ndata2={&#39;姓名&#39;:[&#39;张飞&#39;,&#39;关羽&#39;,&#39;赵云&#39;,&#39;黄忠&#39;,&#39;典韦&#39;,&#39;典韦&#39;],&#39;语文&#39;:[66,95,95,90,80,80],&#39;英语&#39;:[65,85,92,88,90,90],&#39;数学&#39;:[None,98,96,77,90,90]}\ndf8=pd.DataFrame(data2)\n\n#去除重复\ndf9=df8.drop_duplicates()\n\n#排查空值和用0分代替空值\ndf9.isnull().any()\n#补全张飞的数学成绩\ndf9=df9.fillna(0)\n\n\n\n#求和\ndef count_score(df):\n    df[&#39;总分&#39;]=df[&#39;语文&#39;]+df[&#39;英语&#39;]+df[&#39;数学&#39;]\n    return df\n    \ndf9=df9.apply(count_score,axis=1)\n\nprint(df9)","like_count":0},{"had_liked":false,"id":56323,"user_name":"瑞","can_delete":false,"product_type":"c1","uid":1354236,"ip_address":"","ucode":"529AA74D89FEF3","user_header":"https://static001.geekbang.org/account/avatar/00/14/a9/fc/6d7df2b9.jpg","comment_is_top":false,"comment_ctime":1546421795,"is_pvip":false,"replies":null,"discussion_count":0,"race_medal":0,"score":18,"product_id":100021701,"comment_content":"我也是这个问题，用的python3，df2[&#39;English&#39;]=df2[&#39;English&#39;].map(str.strip)这个也有问题\ndf2 = df2.drop(columns=[&#39;Chinese&#39;]) 这行代码后,返回结果是:\nTypeError Traceback (most recent call last)\n&lt;ipython-input-25-8116650c61ac&gt; in &lt;module&gt;()\n----&gt; 1 df2 = df2.drop(columns=[&#39;Chinese&#39;])\n\nTypeError: drop() got an unexpected keyword argument &#39;columns&#39;","like_count":0},{"had_liked":false,"id":56308,"user_name":"瑞","can_delete":false,"product_type":"c1","uid":1354236,"ip_address":"","ucode":"529AA74D89FEF3","user_header":"https://static001.geekbang.org/account/avatar/00/14/a9/fc/6d7df2b9.jpg","comment_is_top":false,"comment_ctime":1546419423,"is_pvip":false,"replies":null,"discussion_count":0,"race_medal":0,"score":18,"product_id":100021701,"comment_content":"python3 \ndf2=df2.drop(index=[&#39;zhangfei&#39;]) 报错","like_count":0},{"had_liked":false,"id":55906,"user_name":"I.L","can_delete":false,"product_type":"c1","uid":1352435,"ip_address":"","ucode":"965523A3BC7029","user_header":"https://static001.geekbang.org/account/avatar/00/14/a2/f3/801c2561.jpg","comment_is_top":false,"comment_ctime":1546344900,"is_pvip":false,"replies":null,"discussion_count":0,"race_medal":0,"score":18,"product_id":100021701,"comment_content":"import pandas as pd\ndata = {&#39;姓名&#39;: [&#39;张飞&#39;, &#39;关羽&#39;, &#39;赵云&#39;, &#39;黄忠&#39;, &#39;典韦&#39;, &#39;典韦&#39;],\n        &#39;语文&#39;: [66, 95, 95, 90, 80, 80],\n        &#39;英语&#39;: [65, 85, 92, 88, 90, 90],\n        &#39;数学&#39;: [None,98, 96, 77, 90, 90]}\ndata_table = pd.DataFrame(data)\ndata_table = data_table.drop_duplicates()\ndata_table[&#39;数学&#39;].fillna(data_table[&#39;数学&#39;].mean(), inplace=True)\ndata_table[&#39;总和&#39;] = data_table[&#39;英语&#39;] + data_table[&#39;语文&#39;] + data_table[&#39;数学&#39;]\ndata_table\n#注意点：\n#Dataframe中的apply函数类似于map函数\n#在apply例子中：\n#df1.apply(plus, axis=1, args=(2,3,))\n#可以在apply函数的args参数中传递对应函数（plus）的参数\n#inner left right outer就像SQL中的inner left right full\n#其中通过SQL方式对Dataframe进行查询的方式很棒，之前没有了解过\n\n#正如热评中的做法，数据的清洗过程需要的不仅仅是删除，更多的应该是近似值填充\n","like_count":0},{"had_liked":false,"id":55705,"user_name":"tjcslx","can_delete":false,"product_type":"c1","uid":1060608,"ip_address":"","ucode":"F98FA363E88ECF","user_header":"https://static001.geekbang.org/account/avatar/00/10/2f/00/eaf03870.jpg","comment_is_top":false,"comment_ctime":1546265353,"is_pvip":false,"replies":null,"discussion_count":0,"race_medal":0,"score":19,"product_id":100021701,"comment_content":"#!&#47;usr&#47;bin&#47;env python\n# coding: utf-8\n# 使用Jupyter Notebook进行脚本编写\n\nimport pandas as pd\nimport numpy as np\nfrom pandas import DataFrame\n\n# 创建数据集并进行数据清洗：清除重复的行；\n# 录入数值时，空值用None或np.nan；defaultValues为字段为空时的默认值，姓名字段默认为“无姓名”，成绩字段默认为0\n# 分别使用drop_duplicates和fillna方法进行去重复值及空值填充\ndata = {&#39;Name&#39;: [&#39;张飞&#39;, &#39;关羽&#39;, &#39;赵云&#39;, &#39;黄忠&#39;, &#39;典韦&#39;, &#39;典韦&#39;], &#39;Chinese&#39;: [66, 95, 95, 90, 80, 80], &#39;English&#39;: [65, 85, 92, 88, 90, 90], &#39;Maths&#39;: [None, 98, 96, 77, 90, 90]}\ndf = DataFrame(data, columns=[&#39;Name&#39;, &#39;Chinese&#39;, &#39;English&#39;, &#39;Maths&#39;])\ndefaultValues = {&#39;Name&#39;: &#39;无姓名&#39;, &#39;Chinese&#39;: 0, &#39;English&#39;: 0, &#39;Maths&#39;: 0}\ndf = df.drop_duplicates()\n# 按照默认值进行填充\ndf = df.fillna(defaultValues)\n# 使用其他学生的平均值对空值进行填充\n# df[&#39;Maths&#39;].fillna(df[&#39;Maths&#39;].mean(), inplace=True)\n\n# 总和列的值等于语数外三列之和\n# 按照总和列倒序排列\ndf[&#39;总和&#39;] = df[&#39;Chinese&#39;] + df[&#39;English&#39;] + df[&#39;Maths&#39;]\nprint(df.sort_values(by=&#39;总和&#39;, ascending=False))","like_count":0},{"had_liked":false,"id":55438,"user_name":"竹本先生","can_delete":false,"product_type":"c1","uid":1357379,"ip_address":"","ucode":"83D292AACD1E20","user_header":"https://static001.geekbang.org/account/avatar/00/14/b6/43/c7b2a6f9.jpg","comment_is_top":false,"comment_ctime":1546180249,"is_pvip":false,"replies":null,"discussion_count":0,"race_medal":0,"score":19,"product_id":100021701,"comment_content":"import pandas as pd\nfrom pandas import DataFrame\n\nperson = DataFrame(\n\t{\n\t\t&#39;语文&#39;: [66,65,95,90,80,80], \n\t\t&#39;英语&#39;: [65,85,92,88,90,90], \n\t\t&#39;数学&#39;: [None,98,96,77,90,90]\n\t}, \n\tindex=[&#39;张飞&#39;,&#39;关羽&#39;,&#39;赵云&#39;,&#39;黄忠&#39;,&#39;典韦&#39;,&#39;典韦&#39;], \n\tcolumns=[&#39;语文&#39;,&#39;英语&#39;,&#39;数学&#39;]\n)\n# ~ 删除重复行\nperson.drop_duplicates(inplace=True)\n\n# ~ 用数学平均分填充缺失数据\nperson[&#39;数学&#39;].fillna(person[&#39;数学&#39;].mean(), inplace=True)\n\n# ~ 计算总分\ndef sum_score(df):\n\tdf[&#39;总分&#39;] = df[&#39;语文&#39;] + df[&#39;英语&#39;] + df[&#39;数学&#39;]\n\treturn df\n\nperson = person.apply(sum_score, axis=1)\n\nprint(person)\n\n运行结果如下：\n      语文    英语     数学      总分\n张飞  66.0  65.0  90.25  221.25\n关羽  65.0  85.0  98.00  248.00\n赵云  95.0  92.0  96.00  283.00\n黄忠  90.0  88.0  77.00  255.00\n典韦  80.0  90.0  90.00  260.00","like_count":0},{"had_liked":false,"id":55299,"user_name":"周飞","can_delete":false,"product_type":"c1","uid":1073374,"ip_address":"","ucode":"F85FA236EB0C0D","user_header":"https://static001.geekbang.org/account/avatar/00/10/60/de/5c67895a.jpg","comment_is_top":false,"comment_ctime":1546097359,"is_pvip":false,"replies":null,"discussion_count":0,"race_medal":0,"score":19,"product_id":100021701,"comment_content":"# -*- coding: utf-8 -*\nimport pandas as pd\nimport numpy as np\nfrom pandas import Series, DataFrame\ndata = {&#39;chinese&#39;: [66, 95, 95,90, 80,80],&#39;english&#39;: [65, 85, 92, 88, 90,90],&#39;math&#39;: [ np.nan,98, 96, 77, 90,90]}\ndf2 = DataFrame(data, index=[&#39;zhangfei&#39;, &#39;guanyu&#39;, &#39;zhaoyun&#39;, &#39;huangzhong&#39;, &#39;dianwei&#39;,&#39;dianwei&#39;], columns=[&#39;chinese&#39;, &#39;english&#39;, &#39;math&#39;])\ndf2.drop_duplicates(inplace=True)\nprint (df2)\ndf2.rename(columns={&#39;chinese&#39;: &#39;语文&#39;, &#39;english&#39;: &#39;英语&#39;,&#39;math&#39;:&#39;数学&#39;},index={&#39;zhangfei&#39;: &#39;张飞&#39;, &#39;guanyu&#39;: &#39;关羽&#39;,&#39;zhaoyun&#39;:&#39;赵云&#39;,&#39;huangzhong&#39;:&#39;黄忠&#39;,&#39;dianwei&#39;:&#39;典韦&#39;}, inplace = True)\ndf2.isnull()\ndf2.loc[&#39;张飞&#39;,&#39;数学&#39;]=0\ndf2[&#39;总和&#39;] = df2[&#39;语文&#39;]+df2[&#39;英语&#39;]+df2[&#39;数学&#39;]\n\nprint (df2)","like_count":0},{"had_liked":false,"id":54961,"user_name":"xyw pro","can_delete":false,"product_type":"c1","uid":1233617,"ip_address":"","ucode":"C2B4A69BA04A5A","user_header":"https://static001.geekbang.org/account/avatar/00/12/d2/d1/6cb2904b.jpg","comment_is_top":false,"comment_ctime":1545989249,"is_pvip":false,"replies":null,"discussion_count":0,"race_medal":0,"score":19,"product_id":100021701,"comment_content":"import pandas as pd\nfrom pandas import Series, DataFrame\n\ndata = {&#39;chinese&#39;:[66,95,95,90,80,80],&#39;english&#39;:[65,85,92,88,90,90],&#39;math&#39;:[None,98,96,77,90,90]}\ndf1 = pd.DataFrame(data,index=[&#39;zhangfei&#39;,&#39;guanyu&#39;,&#39;zhaoyun&#39;,&#39;dianwei&#39;,&#39;huangzhong&#39;,&#39;huangzhong&#39;])\n#去除重复行\ndf1 = df1.drop_duplicates()\n\n# 列名重新排序\ncols = [&#39;chinese&#39;, &#39;math&#39;, &#39;english&#39;]\ndf = df1.filter(cols, axis=1)\n\n#列名改成中文\ndf1.rename(columns={&#39;chinese&#39;: &#39;语文&#39;, &#39;english&#39;: &#39;英语&#39;,\n&#39;math&#39;: &#39;数学&#39;}, inplace=True)\n\n#加总成绩\ndef total_score(df):\n    df[u&#39;总成绩&#39;] = df[u&#39;语文&#39;]+df[u&#39;数学&#39;]+df[u&#39;英语&#39;]\n    return df\ndf1 = df1.apply(total_score,axis=1)","like_count":0},{"had_liked":false,"id":54893,"user_name":"半夏","can_delete":false,"product_type":"c1","uid":1352974,"ip_address":"","ucode":"60D4E50E19CD6E","user_header":"http://thirdwx.qlogo.cn/mmopen/vi_32/1OU8Yiaqnlicxqibd4fjXNPE3jD9DRFANWuyMjhNAONM6mBAUBw4BH4HLDCNNAI7vvkzIbY5iclNiclXgiciaOOeouVeA/132","comment_is_top":false,"comment_ctime":1545978895,"is_pvip":false,"replies":null,"discussion_count":0,"race_medal":0,"score":19,"product_id":100021701,"comment_content":"请问 df[u&#39;语文&#39;] 和 df[&#39;语文&#39;] 有什么区别？ 这个u是做什么用的\n\n","like_count":0},{"had_liked":false,"id":54390,"user_name":"河蟹hxscript","can_delete":false,"product_type":"c1","uid":1166209,"ip_address":"","ucode":"E330F9C9F0F8AC","user_header":"https://static001.geekbang.org/account/avatar/00/11/cb/81/57024c59.jpg","comment_is_top":false,"comment_ctime":1545840722,"is_pvip":false,"replies":null,"discussion_count":0,"race_medal":0,"score":19,"product_id":100021701,"comment_content":"环境是：在阿里云ECS搭建的jupyter notebook，环境一次配好就可以一直用了，不受设备的限制，随时随用。如果只是学python，学生党10块钱一个月的配置就够了，非常滴划算！\n\n代码如下：\nimport pandas as pd\ndata = {&#39;语文&#39;: [66, 95, 95, 90, 90, 90],&#39;英语&#39;: [65, 85, 92, 88, 90,90],&#39;数学&#39;: [None, 98, 96, 77, 90,90]}\ndf = pd.DataFrame(data, index=[&#39;张飞&#39;, &#39;关羽&#39;, &#39;赵云&#39;, &#39;黄忠&#39;,&#39;典韦&#39;,&#39;典韦2&#39;], columns=[&#39;语文&#39;, &#39;英语&#39;, &#39;数学&#39;])\n# print(df)\n\n# 去重：要该行中，除了index外，其他列内容完全一致，才会被去重。\ndf = df.drop_duplicates()\n# print(df)\n\n\ndef total_socre(df):\n    df[&#39;总分&#39;] = df[&#39;语文&#39;] + df[&#39;英语&#39;] + df[&#39;数学&#39;]\n    return df\n\n\ndf = df.apply(total_socre, axis = 1)\n\ndf.sort_values([&#39;总分&#39;], ascending = [False], inplace = True)\n# print(df)\n\n# 处理NaN：\n# 方案1：直接删除\ndf1 = df.dropna()\n# print(df1)\n\n# 方案2：用均值替换\n# print(df.isnull())\ndf.fillna(df[&#39;数学&#39;].mean(), inplace = True)\n# print(df)\ndf = df.apply(total_socre, axis = 1)\ndf.sort_values([&#39;总分&#39;], ascending = [False], inplace = True)\nprint(df)","like_count":0},{"had_liked":false,"id":54384,"user_name":"X","can_delete":false,"product_type":"c1","uid":1353215,"ip_address":"","ucode":"3C10A7CB921429","user_header":"https://static001.geekbang.org/account/avatar/00/14/a5/ff/a46422a0.jpg","comment_is_top":false,"comment_ctime":1545839310,"is_pvip":false,"replies":null,"discussion_count":0,"race_medal":0,"score":19,"product_id":100021701,"comment_content":"感谢老师，今天学到蛮多，对pandas的运用还需要靠大量的练习才能逐渐熟悉各个API\nimport pandas as pd\nfrom pandas import Series, DataFrame\nimport numpy as np\n# 初始数据\ndata = {&#39;姓名&#39;:[&#39;张飞&#39;,&#39;关羽&#39;,&#39;赵云&#39;,&#39;黄忠&#39;,&#39;典韦&#39;,&#39;典韦&#39;],&#39;语文&#39;:[66,95,95,90,80,80],&#39;英语&#39;:[65,85,92,88,90,90],&#39;数学&#39;:[None,98,96,77,90,90]}\n# 装载data数据到DataFrame\ndf = DataFrame(data)\nprint(df)\n\n# 清除重复数据\ndf = df.drop_duplicates()\nprint(df)\n# 求和, 若有空值按0分计算\ndef sum_score(df):\n    #替换NaN的数据为0分\n    a = (0 if np.isnan(df[&#39;数学&#39;]) else df[&#39;数学&#39;])\n    df[&#39;总和&#39;] = a + df[&#39;英语&#39;] + df[&#39;语文&#39;]\n    return df\n\n# 新增一列总和\ndf = df.apply(sum_score, axis=1)\nprint(df)\n# 用数学平均值填充空值\ndf[&#39;数学&#39;].fillna(df[&#39;数学&#39;].mean(), inplace=True)\ndf = df.apply(sum_score, axis=1)\nprint(df)\n","like_count":0},{"had_liked":false,"id":54374,"user_name":"Chino","can_delete":false,"product_type":"c1","uid":1347181,"ip_address":"","ucode":"0240D89E5F74B4","user_header":"https://static001.geekbang.org/account/avatar/00/14/8e/6d/c68e07ef.jpg","comment_is_top":false,"comment_ctime":1545836687,"is_pvip":false,"replies":null,"discussion_count":0,"race_medal":0,"score":19,"product_id":100021701,"comment_content":"在贴代码之前首先问老师几个问题\n第一个是 老师您说过 这里引用&quot;其中 axis=1 代表按照列为轴进行操作，axis=0 代表按照行为轴进行操作，args 是传递的两个参数，即 n=2, m=3，在 plus 函数中使用到了 n 和 m，从而生成新的 df&quot; \n这里axis又蒙了 上一讲老师不是说axis=0的时候 代表竖着 也就是列 axis=1的时候 是横着 也就是行 是因为上一节是numpy 而这一节是pandas所以不一样吗 还是我理解错了\n另外就是那个apply里 axis=0和axis=1这里有点不懂 为什么文章中的例子 (也就是求两个成绩乘n,m倍的那里 我改成axis=0就报错了 是为什么呢. (大概我把pandas DataFrame这里的axis理解好了就懂了?)\n\n然后是作业代码\nimport pandas as pd\nfrom pandas import DataFrame\n\ndata = {&#39;语文&#39;: [66,95,95,90,80,80], &#39;英语&#39;: [65,85,92,88,90,90], &#39;数学&#39;: [None,98,96,77,90,90]}\n\ndf1 = DataFrame(data,index=[&#39;张飞&#39;,&#39;关羽&#39;,&#39;赵云&#39;,&#39;黄忠&#39;,&#39;典韦&#39;,&#39;典韦&#39;])\n\ndf1 = df1.drop_duplicates()\n\n# print(df1.isnull())\n# print(df1.isnull().any())\n\ndf1.fillna(df1[&#39;数学&#39;].mean(),inplace=True)\n\ndf1[&#39;总计&#39;] = df1[&#39;语文&#39;] + df1[&#39;英语&#39;] + df1[&#39;数学&#39;]\n\nprint(df1)\n","like_count":0},{"had_liked":false,"id":54244,"user_name":"TKbook","can_delete":false,"product_type":"c1","uid":1073829,"ip_address":"","ucode":"F6E0E99CC79059","user_header":"https://static001.geekbang.org/account/avatar/00/10/62/a5/43aa0c27.jpg","comment_is_top":false,"comment_ctime":1545815107,"is_pvip":false,"replies":null,"discussion_count":0,"race_medal":0,"score":19,"product_id":100021701,"comment_content":"import pandas as pd\ndf = pd.read_csv(&#39;wzrycj.csv&#39;, encoding=&#39;gb2312&#39;)\ndf.info()\ndf = df.drop_duplicates()\ndf = df.copy()\nfor i in df[df[&#39;数学&#39;].isnull()].index:\n    df.iloc[i, 3] = df[&#39;数学&#39;].mean()\ndef sumScore(df):\n    df[&#39;total&#39;] = df[&#39;语文&#39;] + df[&#39;英语&#39;] + df[&#39;数学&#39;]\n    return df\ndf = df.apply(sumScore, axis=1)\ndf\n姓名\t语文\t英语\t数学\ttotal\n0\t张飞\t66\t65\t90.25\t221.25\n1\t关羽\t95\t85\t98.00\t278.00\n2\t赵云\t95\t92\t96.00\t283.00\n3\t黄忠\t90\t88\t77.00\t255.00\n4\t典韦\t80\t90\t90.00\t260.00\n这个留言不支持markdown，写的代码很难看~~","like_count":0},{"had_liked":false,"id":54112,"user_name":"大灰狼","can_delete":false,"product_type":"c1","uid":1084408,"ip_address":"","ucode":"08410C09214253","user_header":"","comment_is_top":false,"comment_ctime":1545794835,"is_pvip":false,"replies":null,"discussion_count":0,"race_medal":0,"score":19,"product_id":100021701,"comment_content":"老师我看了几节讲python的课程，完全看不懂说的意思，是要去先学习下python的基础课程吗？","like_count":0},{"had_liked":false,"id":55705,"user_name":"tjcslx","can_delete":false,"product_type":"c1","uid":1060608,"ip_address":"","ucode":"F98FA363E88ECF","user_header":"https://static001.geekbang.org/account/avatar/00/10/2f/00/eaf03870.jpg","comment_is_top":false,"comment_ctime":1546265353,"is_pvip":false,"replies":null,"discussion_count":0,"race_medal":0,"score":19,"product_id":100021701,"comment_content":"#!&#47;usr&#47;bin&#47;env python\n# coding: utf-8\n# 使用Jupyter Notebook进行脚本编写\n\nimport pandas as pd\nimport numpy as np\nfrom pandas import DataFrame\n\n# 创建数据集并进行数据清洗：清除重复的行；\n# 录入数值时，空值用None或np.nan；defaultValues为字段为空时的默认值，姓名字段默认为“无姓名”，成绩字段默认为0\n# 分别使用drop_duplicates和fillna方法进行去重复值及空值填充\ndata = {&#39;Name&#39;: [&#39;张飞&#39;, &#39;关羽&#39;, &#39;赵云&#39;, &#39;黄忠&#39;, &#39;典韦&#39;, &#39;典韦&#39;], &#39;Chinese&#39;: [66, 95, 95, 90, 80, 80], &#39;English&#39;: [65, 85, 92, 88, 90, 90], &#39;Maths&#39;: [None, 98, 96, 77, 90, 90]}\ndf = DataFrame(data, columns=[&#39;Name&#39;, &#39;Chinese&#39;, &#39;English&#39;, &#39;Maths&#39;])\ndefaultValues = {&#39;Name&#39;: &#39;无姓名&#39;, &#39;Chinese&#39;: 0, &#39;English&#39;: 0, &#39;Maths&#39;: 0}\ndf = df.drop_duplicates()\n# 按照默认值进行填充\ndf = df.fillna(defaultValues)\n# 使用其他学生的平均值对空值进行填充\n# df[&#39;Maths&#39;].fillna(df[&#39;Maths&#39;].mean(), inplace=True)\n\n# 总和列的值等于语数外三列之和\n# 按照总和列倒序排列\ndf[&#39;总和&#39;] = df[&#39;Chinese&#39;] + df[&#39;English&#39;] + df[&#39;Maths&#39;]\nprint(df.sort_values(by=&#39;总和&#39;, ascending=False))","like_count":0},{"had_liked":false,"id":55438,"user_name":"竹本先生","can_delete":false,"product_type":"c1","uid":1357379,"ip_address":"","ucode":"83D292AACD1E20","user_header":"https://static001.geekbang.org/account/avatar/00/14/b6/43/c7b2a6f9.jpg","comment_is_top":false,"comment_ctime":1546180249,"is_pvip":false,"replies":null,"discussion_count":0,"race_medal":0,"score":19,"product_id":100021701,"comment_content":"import pandas as pd\nfrom pandas import DataFrame\n\nperson = DataFrame(\n\t{\n\t\t&#39;语文&#39;: [66,65,95,90,80,80], \n\t\t&#39;英语&#39;: [65,85,92,88,90,90], \n\t\t&#39;数学&#39;: [None,98,96,77,90,90]\n\t}, \n\tindex=[&#39;张飞&#39;,&#39;关羽&#39;,&#39;赵云&#39;,&#39;黄忠&#39;,&#39;典韦&#39;,&#39;典韦&#39;], \n\tcolumns=[&#39;语文&#39;,&#39;英语&#39;,&#39;数学&#39;]\n)\n# ~ 删除重复行\nperson.drop_duplicates(inplace=True)\n\n# ~ 用数学平均分填充缺失数据\nperson[&#39;数学&#39;].fillna(person[&#39;数学&#39;].mean(), inplace=True)\n\n# ~ 计算总分\ndef sum_score(df):\n\tdf[&#39;总分&#39;] = df[&#39;语文&#39;] + df[&#39;英语&#39;] + df[&#39;数学&#39;]\n\treturn df\n\nperson = person.apply(sum_score, axis=1)\n\nprint(person)\n\n运行结果如下：\n      语文    英语     数学      总分\n张飞  66.0  65.0  90.25  221.25\n关羽  65.0  85.0  98.00  248.00\n赵云  95.0  92.0  96.00  283.00\n黄忠  90.0  88.0  77.00  255.00\n典韦  80.0  90.0  90.00  260.00","like_count":0},{"had_liked":false,"id":55299,"user_name":"周飞","can_delete":false,"product_type":"c1","uid":1073374,"ip_address":"","ucode":"F85FA236EB0C0D","user_header":"https://static001.geekbang.org/account/avatar/00/10/60/de/5c67895a.jpg","comment_is_top":false,"comment_ctime":1546097359,"is_pvip":false,"replies":null,"discussion_count":0,"race_medal":0,"score":19,"product_id":100021701,"comment_content":"# -*- coding: utf-8 -*\nimport pandas as pd\nimport numpy as np\nfrom pandas import Series, DataFrame\ndata = {&#39;chinese&#39;: [66, 95, 95,90, 80,80],&#39;english&#39;: [65, 85, 92, 88, 90,90],&#39;math&#39;: [ np.nan,98, 96, 77, 90,90]}\ndf2 = DataFrame(data, index=[&#39;zhangfei&#39;, &#39;guanyu&#39;, &#39;zhaoyun&#39;, &#39;huangzhong&#39;, &#39;dianwei&#39;,&#39;dianwei&#39;], columns=[&#39;chinese&#39;, &#39;english&#39;, &#39;math&#39;])\ndf2.drop_duplicates(inplace=True)\nprint (df2)\ndf2.rename(columns={&#39;chinese&#39;: &#39;语文&#39;, &#39;english&#39;: &#39;英语&#39;,&#39;math&#39;:&#39;数学&#39;},index={&#39;zhangfei&#39;: &#39;张飞&#39;, &#39;guanyu&#39;: &#39;关羽&#39;,&#39;zhaoyun&#39;:&#39;赵云&#39;,&#39;huangzhong&#39;:&#39;黄忠&#39;,&#39;dianwei&#39;:&#39;典韦&#39;}, inplace = True)\ndf2.isnull()\ndf2.loc[&#39;张飞&#39;,&#39;数学&#39;]=0\ndf2[&#39;总和&#39;] = df2[&#39;语文&#39;]+df2[&#39;英语&#39;]+df2[&#39;数学&#39;]\n\nprint (df2)","like_count":0},{"had_liked":false,"id":54961,"user_name":"xyw pro","can_delete":false,"product_type":"c1","uid":1233617,"ip_address":"","ucode":"C2B4A69BA04A5A","user_header":"https://static001.geekbang.org/account/avatar/00/12/d2/d1/6cb2904b.jpg","comment_is_top":false,"comment_ctime":1545989249,"is_pvip":false,"replies":null,"discussion_count":0,"race_medal":0,"score":19,"product_id":100021701,"comment_content":"import pandas as pd\nfrom pandas import Series, DataFrame\n\ndata = {&#39;chinese&#39;:[66,95,95,90,80,80],&#39;english&#39;:[65,85,92,88,90,90],&#39;math&#39;:[None,98,96,77,90,90]}\ndf1 = pd.DataFrame(data,index=[&#39;zhangfei&#39;,&#39;guanyu&#39;,&#39;zhaoyun&#39;,&#39;dianwei&#39;,&#39;huangzhong&#39;,&#39;huangzhong&#39;])\n#去除重复行\ndf1 = df1.drop_duplicates()\n\n# 列名重新排序\ncols = [&#39;chinese&#39;, &#39;math&#39;, &#39;english&#39;]\ndf = df1.filter(cols, axis=1)\n\n#列名改成中文\ndf1.rename(columns={&#39;chinese&#39;: &#39;语文&#39;, &#39;english&#39;: &#39;英语&#39;,\n&#39;math&#39;: &#39;数学&#39;}, inplace=True)\n\n#加总成绩\ndef total_score(df):\n    df[u&#39;总成绩&#39;] = df[u&#39;语文&#39;]+df[u&#39;数学&#39;]+df[u&#39;英语&#39;]\n    return df\ndf1 = df1.apply(total_score,axis=1)","like_count":0},{"had_liked":false,"id":54893,"user_name":"半夏","can_delete":false,"product_type":"c1","uid":1352974,"ip_address":"","ucode":"60D4E50E19CD6E","user_header":"http://thirdwx.qlogo.cn/mmopen/vi_32/1OU8Yiaqnlicxqibd4fjXNPE3jD9DRFANWuyMjhNAONM6mBAUBw4BH4HLDCNNAI7vvkzIbY5iclNiclXgiciaOOeouVeA/132","comment_is_top":false,"comment_ctime":1545978895,"is_pvip":false,"replies":null,"discussion_count":0,"race_medal":0,"score":19,"product_id":100021701,"comment_content":"请问 df[u&#39;语文&#39;] 和 df[&#39;语文&#39;] 有什么区别？ 这个u是做什么用的\n\n","like_count":0},{"had_liked":false,"id":54390,"user_name":"河蟹hxscript","can_delete":false,"product_type":"c1","uid":1166209,"ip_address":"","ucode":"E330F9C9F0F8AC","user_header":"https://static001.geekbang.org/account/avatar/00/11/cb/81/57024c59.jpg","comment_is_top":false,"comment_ctime":1545840722,"is_pvip":false,"replies":null,"discussion_count":0,"race_medal":0,"score":19,"product_id":100021701,"comment_content":"环境是：在阿里云ECS搭建的jupyter notebook，环境一次配好就可以一直用了，不受设备的限制，随时随用。如果只是学python，学生党10块钱一个月的配置就够了，非常滴划算！\n\n代码如下：\nimport pandas as pd\ndata = {&#39;语文&#39;: [66, 95, 95, 90, 90, 90],&#39;英语&#39;: [65, 85, 92, 88, 90,90],&#39;数学&#39;: [None, 98, 96, 77, 90,90]}\ndf = pd.DataFrame(data, index=[&#39;张飞&#39;, &#39;关羽&#39;, &#39;赵云&#39;, &#39;黄忠&#39;,&#39;典韦&#39;,&#39;典韦2&#39;], columns=[&#39;语文&#39;, &#39;英语&#39;, &#39;数学&#39;])\n# print(df)\n\n# 去重：要该行中，除了index外，其他列内容完全一致，才会被去重。\ndf = df.drop_duplicates()\n# print(df)\n\n\ndef total_socre(df):\n    df[&#39;总分&#39;] = df[&#39;语文&#39;] + df[&#39;英语&#39;] + df[&#39;数学&#39;]\n    return df\n\n\ndf = df.apply(total_socre, axis = 1)\n\ndf.sort_values([&#39;总分&#39;], ascending = [False], inplace = True)\n# print(df)\n\n# 处理NaN：\n# 方案1：直接删除\ndf1 = df.dropna()\n# print(df1)\n\n# 方案2：用均值替换\n# print(df.isnull())\ndf.fillna(df[&#39;数学&#39;].mean(), inplace = True)\n# print(df)\ndf = df.apply(total_socre, axis = 1)\ndf.sort_values([&#39;总分&#39;], ascending = [False], inplace = True)\nprint(df)","like_count":0},{"had_liked":false,"id":54384,"user_name":"X","can_delete":false,"product_type":"c1","uid":1353215,"ip_address":"","ucode":"3C10A7CB921429","user_header":"https://static001.geekbang.org/account/avatar/00/14/a5/ff/a46422a0.jpg","comment_is_top":false,"comment_ctime":1545839310,"is_pvip":false,"replies":null,"discussion_count":0,"race_medal":0,"score":19,"product_id":100021701,"comment_content":"感谢老师，今天学到蛮多，对pandas的运用还需要靠大量的练习才能逐渐熟悉各个API\nimport pandas as pd\nfrom pandas import Series, DataFrame\nimport numpy as np\n# 初始数据\ndata = {&#39;姓名&#39;:[&#39;张飞&#39;,&#39;关羽&#39;,&#39;赵云&#39;,&#39;黄忠&#39;,&#39;典韦&#39;,&#39;典韦&#39;],&#39;语文&#39;:[66,95,95,90,80,80],&#39;英语&#39;:[65,85,92,88,90,90],&#39;数学&#39;:[None,98,96,77,90,90]}\n# 装载data数据到DataFrame\ndf = DataFrame(data)\nprint(df)\n\n# 清除重复数据\ndf = df.drop_duplicates()\nprint(df)\n# 求和, 若有空值按0分计算\ndef sum_score(df):\n    #替换NaN的数据为0分\n    a = (0 if np.isnan(df[&#39;数学&#39;]) else df[&#39;数学&#39;])\n    df[&#39;总和&#39;] = a + df[&#39;英语&#39;] + df[&#39;语文&#39;]\n    return df\n\n# 新增一列总和\ndf = df.apply(sum_score, axis=1)\nprint(df)\n# 用数学平均值填充空值\ndf[&#39;数学&#39;].fillna(df[&#39;数学&#39;].mean(), inplace=True)\ndf = df.apply(sum_score, axis=1)\nprint(df)\n","like_count":0},{"had_liked":false,"id":54374,"user_name":"Chino","can_delete":false,"product_type":"c1","uid":1347181,"ip_address":"","ucode":"0240D89E5F74B4","user_header":"https://static001.geekbang.org/account/avatar/00/14/8e/6d/c68e07ef.jpg","comment_is_top":false,"comment_ctime":1545836687,"is_pvip":false,"replies":null,"discussion_count":0,"race_medal":0,"score":19,"product_id":100021701,"comment_content":"在贴代码之前首先问老师几个问题\n第一个是 老师您说过 这里引用&quot;其中 axis=1 代表按照列为轴进行操作，axis=0 代表按照行为轴进行操作，args 是传递的两个参数，即 n=2, m=3，在 plus 函数中使用到了 n 和 m，从而生成新的 df&quot; \n这里axis又蒙了 上一讲老师不是说axis=0的时候 代表竖着 也就是列 axis=1的时候 是横着 也就是行 是因为上一节是numpy 而这一节是pandas所以不一样吗 还是我理解错了\n另外就是那个apply里 axis=0和axis=1这里有点不懂 为什么文章中的例子 (也就是求两个成绩乘n,m倍的那里 我改成axis=0就报错了 是为什么呢. (大概我把pandas DataFrame这里的axis理解好了就懂了?)\n\n然后是作业代码\nimport pandas as pd\nfrom pandas import DataFrame\n\ndata = {&#39;语文&#39;: [66,95,95,90,80,80], &#39;英语&#39;: [65,85,92,88,90,90], &#39;数学&#39;: [None,98,96,77,90,90]}\n\ndf1 = DataFrame(data,index=[&#39;张飞&#39;,&#39;关羽&#39;,&#39;赵云&#39;,&#39;黄忠&#39;,&#39;典韦&#39;,&#39;典韦&#39;])\n\ndf1 = df1.drop_duplicates()\n\n# print(df1.isnull())\n# print(df1.isnull().any())\n\ndf1.fillna(df1[&#39;数学&#39;].mean(),inplace=True)\n\ndf1[&#39;总计&#39;] = df1[&#39;语文&#39;] + df1[&#39;英语&#39;] + df1[&#39;数学&#39;]\n\nprint(df1)\n","like_count":0},{"had_liked":false,"id":54244,"user_name":"TKbook","can_delete":false,"product_type":"c1","uid":1073829,"ip_address":"","ucode":"F6E0E99CC79059","user_header":"https://static001.geekbang.org/account/avatar/00/10/62/a5/43aa0c27.jpg","comment_is_top":false,"comment_ctime":1545815107,"is_pvip":false,"replies":null,"discussion_count":0,"race_medal":0,"score":19,"product_id":100021701,"comment_content":"import pandas as pd\ndf = pd.read_csv(&#39;wzrycj.csv&#39;, encoding=&#39;gb2312&#39;)\ndf.info()\ndf = df.drop_duplicates()\ndf = df.copy()\nfor i in df[df[&#39;数学&#39;].isnull()].index:\n    df.iloc[i, 3] = df[&#39;数学&#39;].mean()\ndef sumScore(df):\n    df[&#39;total&#39;] = df[&#39;语文&#39;] + df[&#39;英语&#39;] + df[&#39;数学&#39;]\n    return df\ndf = df.apply(sumScore, axis=1)\ndf\n姓名\t语文\t英语\t数学\ttotal\n0\t张飞\t66\t65\t90.25\t221.25\n1\t关羽\t95\t85\t98.00\t278.00\n2\t赵云\t95\t92\t96.00\t283.00\n3\t黄忠\t90\t88\t77.00\t255.00\n4\t典韦\t80\t90\t90.00\t260.00\n这个留言不支持markdown，写的代码很难看~~","like_count":0},{"had_liked":false,"id":54112,"user_name":"大灰狼","can_delete":false,"product_type":"c1","uid":1084408,"ip_address":"","ucode":"08410C09214253","user_header":"","comment_is_top":false,"comment_ctime":1545794835,"is_pvip":false,"replies":null,"discussion_count":0,"race_medal":0,"score":19,"product_id":100021701,"comment_content":"老师我看了几节讲python的课程，完全看不懂说的意思，是要去先学习下python的基础课程吗？","like_count":0},{"had_liked":false,"id":54106,"user_name":"土豆毛毛","can_delete":false,"product_type":"c1","uid":1348962,"ip_address":"","ucode":"2CFF8740BE31F5","user_header":"https://static001.geekbang.org/account/avatar/00/14/95/62/04c5d06e.jpg","comment_is_top":false,"comment_ctime":1545794471,"is_pvip":false,"replies":null,"discussion_count":0,"race_medal":0,"score":20,"product_id":100021701,"comment_content":"import pandas as pd\nfrom pandas import Series, DataFrame\n\ndata = {&#39;Chinese&#39;: [66, 95, 95, 90, 80, 80], &#39;English&#39;: [65, 85, 92, 88, 90, 90], &#39;Math&#39;: [None, 98, 96, 77, 90, 90]}\ndf1 = DataFrame(data, index=[&#39;ZhangFei&#39;, &#39;GuanYu&#39;, &#39;ZhaoYun&#39;, &#39;HuangZhong&#39;, &#39;DianWei&#39;, &#39;DianWei&#39;], columns=[&#39;English&#39;, &#39;Math&#39;, &#39;Chinese&#39;])\n\n# Clean the data\ndf = df1.drop_duplicates()  # remove duplicated lines\ndf.rename(index={&#39;ZhangFei&#39;: &#39;张飞&#39;, &#39;GuanYu&#39;: &#39;关羽&#39;, &#39;ZhaoYun&#39;: &#39;赵云&#39;, &#39;HuangZhong&#39;: &#39;黄忠&#39;, &quot;DianWei&quot;: &#39;典韦&#39;}, inplace=True)\n\n#print(df.describe())    # ouput corresponding statistic data\n\n\n# Function: add a new line\ndef addSum(df):\n    df[&#39;Sum&#39;] = df[&#39;English&#39;] + df[&#39;Chinese&#39;] + df[&#39;Math&#39;]\n    return df\n\n# Use the average mark of Math to fill the NaN value\ndf.fillna(df[&#39;Math&#39;].mean(), inplace=True)\n\n# call the function and add a line called &quot;Sum&quot;, pay attention to the value of axis\nprint(df.apply(addSum, axis=1))\n","like_count":0},{"had_liked":false,"id":53962,"user_name":"拉我吃","can_delete":false,"product_type":"c1","uid":1354151,"ip_address":"","ucode":"8BC9C44FE00097","user_header":"https://static001.geekbang.org/account/avatar/00/14/a9/a7/de3ee890.jpg","comment_is_top":false,"comment_ctime":1545782383,"is_pvip":false,"replies":null,"discussion_count":0,"race_medal":0,"score":20,"product_id":100021701,"comment_content":"# coding: utf8\nimport pandas as pd\n\nfrom pandas import Series, DataFrame\nfrom pandasql import sqldf, load_meat, load_births\n\n&quot;&quot;&quot;\n对于下表的数据，请使用 Pandas 中的 DataFrame 进行创建，并对数据进行清洗。同时新增一列“总和”计算每个人的三科成绩之和。\n&quot;&quot;&quot;\n\ndef total(df):\n    df[u&#39;总和&#39;] = (df[u&#39;语文&#39;] + df[u&#39;英语&#39;] + df[u&#39;数学&#39;])\n    return df\n\n\n# 导入并初始化数据到DataFrame中\ndf = pd.read_excel(&#39;Book.xlsx&#39;)\n\n# 消除重复行\ndf = df.drop_duplicates()\n\n# 添加并计算总成绩列\ndfnew = df.apply(total, axis=1)\n\n# 排序\ndfnew = dfnew.sort_values([u&#39;总和&#39;], ascending=False)\n\n# 输出\nprint(dfnew)\n","like_count":0},{"had_liked":false,"id":53933,"user_name":"汪汪汪","can_delete":false,"product_type":"c1","uid":1352124,"ip_address":"","ucode":"5BF97C411703C8","user_header":"https://static001.geekbang.org/account/avatar/00/14/a1/bc/99c20923.jpg","comment_is_top":false,"comment_ctime":1545762330,"is_pvip":false,"replies":null,"discussion_count":0,"race_medal":0,"score":20,"product_id":100021701,"comment_content":"import pandas as pd\nimport numpy as np\nfrom pandas import Series, DataFrame\n# 1.创建表格数据\ndata = {&quot;语文&quot;:[66, 95, 95, 90, 80, 80],\n        &quot;英语&quot;:[65, 85, 92, 88, 90, 90],\n        &quot;数学&quot;:[None, 98, 96, 77, 90, 90]}\ndf = DataFrame(data,\n               index=[&quot;张飞&quot;,&quot;关羽&quot;,&quot;赵云&quot;,&quot;黄忠&quot;,&quot;典韦&quot;,&quot;典韦&quot;],\n               columns=[&quot;语文&quot;,&quot;英语&quot;,&quot;数学&quot;])\nprint(df)\n# 对数据进行清洗\n# 1) 删除重复数据（典韦）\ndf1 = df.drop_duplicates()\n# 2) 将空值NaN替换为0\ndf1.fillna(0, inplace=True)\nprint(df1)\n# 3) 新增一行，计算每个人的三科成绩之和\ndef total_score(df1):\n    df1[u&quot;总分&quot;]=df1[u&quot;语文&quot;]+df1[u&quot;英语&quot;]+df1[u&quot;数学&quot;]\n    return df1\ndf2 = df1.apply(total_score, axis=1)\nprint(df2)","like_count":0},{"had_liked":false,"id":53869,"user_name":"Mingjie","can_delete":false,"product_type":"c1","uid":1356757,"ip_address":"","ucode":"58E350527F1261","user_header":"https://static001.geekbang.org/account/avatar/00/14/b3/d5/1ac75658.jpg","comment_is_top":false,"comment_ctime":1545745354,"is_pvip":false,"replies":null,"discussion_count":0,"race_medal":0,"score":20,"product_id":100021701,"comment_content":"我的代码\n***************************\nfrom pandas import Series, DataFrame\nimport re\nfrom pandasql import sqldf, load_meat, load_births\n\ndata = { &#39;name&#39;:[&#39;张飞&#39;,&#39;关羽&#39;,&#39;赵云&#39;,&#39;黄忠&#39;,&#39;典韦&#39;,&#39;典韦&#39;] ,\n         &#39;chinese&#39;: [66,95,95,90,80,80],&#39;english&#39;: [65,85,92,88,90,90],&#39;math&#39;: [None,98,96,77,90,90]}\ndf = DataFrame(data, columns=[&#39;name&#39;,&#39;english&#39;, &#39;chinese&#39;, &#39;math&#39;])\n\nprint(&quot;预览\\n&quot;,df)\n\n#添加一列为总成绩并求和\ndef plus(df):\n    #df[&#39;total&#39;] = (df[u&#39;Chinese&#39;]+df[u&#39;English&#39;]+df[u&#39;Math&#39;])\n    return df\n\n#添加一列 ‘total’，并计算求和\ndf[&#39;total&#39;] = df.sum(axis=1)\n\n#首字母大写转换\ndf.columns = df.columns.str.title()\n\n#去除空值的行\n#df = df.dropna()\n\n# 查找空值\nprint(&quot;查找空值\\n&quot;,df.isnull())\n\n# 查找空值 并 将空值用平均值填充\nnone_series = df.isnull().any()\ncol_name = re.findall(r&quot;&#39;(.+?)&#39;&quot;,str(none_series[none_series== True].index))\ndf[col_name[0]].fillna(df[col_name[0]].mean(), inplace=True)\n\n# 去除重复行\ndf = df.drop_duplicates()\n\n#按照总分排序\ndf.sort_values([&#39;Total&#39;], ascending=[False], inplace=True)\n\nprint(&quot;数据清洗后\\n&quot;,df)\n\nprint(&quot;统计数据\\n&quot;,df.describe())","like_count":0},{"had_liked":false,"id":53840,"user_name":"怀念列侬","can_delete":false,"product_type":"c1","uid":1104248,"ip_address":"","ucode":"C91DD8D392F7A6","user_header":"https://static001.geekbang.org/account/avatar/00/10/d9/78/ed5a1922.jpg","comment_is_top":false,"comment_ctime":1545739346,"is_pvip":false,"replies":null,"discussion_count":0,"race_medal":0,"score":20,"product_id":100021701,"comment_content":"from pandas import Series, DataFrame\nimport numpy as np\n\ndata = {&#39;Chinese&#39;: [66, 95, 93, 90, 80, 80], &#39;English&#39;: [65, 85, 92, 88, 90, 90], &#39;Math&#39;: [None, 98, 96, 77, 90, 90]}\ndf = DataFrame(data, index=[&#39;张飞&#39;, &#39;关羽&#39;, &#39;赵云&#39;, &#39;黄忠&#39;, &#39;典韦&#39;, &#39;典韦&#39;], columns=[&#39;Chinese&#39;, &#39;English&#39;, &#39;Math&#39;])\ndf = df.drop_duplicates()\ndf.rename(columns={&#39;Chinese&#39;: &#39;语文&#39;, &#39;English&#39;: &#39;英语&#39;, &#39;Math&#39;: &#39;数学&#39;}, inplace = True)\nprint df.describe().round()\n\ndf[&#39;总和&#39;] = np.where(df[&#39;语文&#39;].isnull(), 0, df[&#39;语文&#39;]) + np.where(df[&#39;英语&#39;].isnull(), 0, df[&#39;英语&#39;]) + np.where(df[&#39;数学&#39;].isnull(), 0, df[&#39;数学&#39;])\nprint df","like_count":0},{"had_liked":false,"id":53814,"user_name":"1e-43","can_delete":false,"product_type":"c1","uid":1138688,"ip_address":"","ucode":"8AADC2ED8409E9","user_header":"https://static001.geekbang.org/account/avatar/00/11/60/00/3dbaf430.jpg","comment_is_top":false,"comment_ctime":1545733557,"is_pvip":false,"replies":null,"discussion_count":0,"race_medal":0,"score":20,"product_id":100021701,"comment_content":"import pandas as pd\ndata = {&#39;Chinese&#39;:[66,95,95,90,80,80],&#39;English&#39;:[65,85,92,88,90,90],&#39;Math&#39;:[None,98,96,77,90,90]}\ndf1=pd.DataFrame(data,index=[&#39;zhangfie&#39;,&#39;guanyu&#39;,&#39;zhaoyun&#39;,&#39;huangzhong&#39;,&#39;dianwei&#39;,&#39;dianwwei&#39;],columns=[&#39;Chinese&#39;, &#39;English&#39; ,&#39;Math&#39;])\ndf2=df1.drop_duplicates()\ndf2.insert(3,&#39;zonghe&#39;,df2.sum(axis=1))","like_count":0},{"had_liked":false,"id":53761,"user_name":"轨迹","can_delete":false,"product_type":"c1","uid":1026737,"ip_address":"","ucode":"B212E2582B38CE","user_header":"https://static001.geekbang.org/account/avatar/00/0f/aa/b1/52d2871f.jpg","comment_is_top":false,"comment_ctime":1545721007,"is_pvip":false,"replies":null,"discussion_count":0,"race_medal":0,"score":20,"product_id":100021701,"comment_content":"pandas的dataframe基本上就是关系数据库的表，pandas对比表有什么优势","like_count":0},{"had_liked":false,"id":53756,"user_name":"不能忘记的笑容","can_delete":false,"product_type":"c1","uid":1356706,"ip_address":"","ucode":"FCD3F3C53DD9D4","user_header":"","comment_is_top":false,"comment_ctime":1545720227,"is_pvip":false,"replies":null,"discussion_count":0,"race_medal":0,"score":20,"product_id":100021701,"comment_content":"老师，请问，用apply定义函数的时候，为什么要加u，u代表什么意思，例如：\ndef plus(df):\n    df[&#39;total&#39;] = (df[u&#39;chinese&#39;]+df[u&#39;english&#39;]+df[u&#39;math&#39;])\n    return df","like_count":0},{"had_liked":false,"id":53748,"user_name":"北方","can_delete":false,"product_type":"c1","uid":1114754,"ip_address":"","ucode":"D04589B652AC29","user_header":"https://static001.geekbang.org/account/avatar/00/11/02/82/abed70a0.jpg","comment_is_top":false,"comment_ctime":1545718913,"is_pvip":false,"replies":null,"discussion_count":0,"race_medal":0,"score":20,"product_id":100021701,"comment_content":"#!&#47;usr&#47;bin&#47;env python\n# -*- coding:utf8 -*-\n# __author__ = &#39;北方姆Q&#39;\n# __datetime__ = 2018&#47;12&#47;25 10:36\n\n\nimport pandas as pd\n\n\ndata = {\n    &#39; Chinese&#39;: [66, 95, 93, 90, 80, 80],\n    &#39;English  &#39;: [65, 85, 92, 88, 90, 90],\n    &#39;  Math  &#39;: [None, 98, 96, 77, 90, 90]\n}\ndf = pd.DataFrame(data, index=[&#39;ZhangFei&#39;, &#39;GuanYu&#39;, &#39;ZhaoYun&#39;, &#39;HuangZhong&#39;, &#39;DianWei&#39;, &#39;DianWei&#39;])\n\n# 去重行\ndf = df.drop_duplicates()\n\n# 列名去空格\ndf.columns = df.columns.str.strip()\n\n# 列名转化\ndf.rename(columns={\n    &#39;Chinese&#39;: &#39;语文&#39;,\n    &#39;English&#39;:  &#39;英语&#39;,\n    &#39;Math&#39;:  &#39;数学&#39;\n}, inplace=True)\n\n# 补充缺考数据\ndf[&#39;数学&#39;].fillna(0, inplace=True)\n\n# 添加总分列\ndf[&#39;Total&#39;] = df.sum(axis=1)\n\nprint(df)\nprint(&quot;===========================&quot;)\nprint(df.describe())\n","like_count":0},{"had_liked":false,"id":53667,"user_name":"chochinlu","can_delete":false,"product_type":"c1","uid":1266152,"ip_address":"","ucode":"E98E3E848F8AD9","user_header":"https://static001.geekbang.org/account/avatar/00/13/51/e8/5a942071.jpg","comment_is_top":false,"comment_ctime":1545707492,"is_pvip":false,"replies":null,"discussion_count":0,"race_medal":0,"score":20,"product_id":100021701,"comment_content":"from pandas import DataFrame\n\nscores = {\n    &#39;Chinese&#39;: [66, 95, 95, 90, 80, 80],\n    &#39;English&#39;: [65, 85, 92, 88, 90, 90],\n    &#39;Math&#39;: [None, 98, 96, 77, 90, 90]\n}\n\ndf = DataFrame(scores, index=[&#39;张飞&#39;, &#39;关羽&#39;, &#39;赵云&#39;, &#39;黄忠&#39;, &#39;典韦&#39;, &#39;典韦&#39;])\n\n# clean data\ndf2 = df.drop_duplicates()\ndf2 = df2.replace([None], 0)\ndf2[&#39;Math&#39;] = df2.astype(int)\n\ndef addSum(df):\n    df[&#39;Sum&#39;] = df[&#39;Chinese&#39;] + df[&#39;English&#39;] + df[&#39;Math&#39;]\n    return df\n\nprint(df2.apply(addSum, axis=1))","like_count":0},{"had_liked":false,"id":54106,"user_name":"土豆毛毛","can_delete":false,"product_type":"c1","uid":1348962,"ip_address":"","ucode":"2CFF8740BE31F5","user_header":"https://static001.geekbang.org/account/avatar/00/14/95/62/04c5d06e.jpg","comment_is_top":false,"comment_ctime":1545794471,"is_pvip":false,"replies":null,"discussion_count":0,"race_medal":0,"score":20,"product_id":100021701,"comment_content":"import pandas as pd\nfrom pandas import Series, DataFrame\n\ndata = {&#39;Chinese&#39;: [66, 95, 95, 90, 80, 80], &#39;English&#39;: [65, 85, 92, 88, 90, 90], &#39;Math&#39;: [None, 98, 96, 77, 90, 90]}\ndf1 = DataFrame(data, index=[&#39;ZhangFei&#39;, &#39;GuanYu&#39;, &#39;ZhaoYun&#39;, &#39;HuangZhong&#39;, &#39;DianWei&#39;, &#39;DianWei&#39;], columns=[&#39;English&#39;, &#39;Math&#39;, &#39;Chinese&#39;])\n\n# Clean the data\ndf = df1.drop_duplicates()  # remove duplicated lines\ndf.rename(index={&#39;ZhangFei&#39;: &#39;张飞&#39;, &#39;GuanYu&#39;: &#39;关羽&#39;, &#39;ZhaoYun&#39;: &#39;赵云&#39;, &#39;HuangZhong&#39;: &#39;黄忠&#39;, &quot;DianWei&quot;: &#39;典韦&#39;}, inplace=True)\n\n#print(df.describe())    # ouput corresponding statistic data\n\n\n# Function: add a new line\ndef addSum(df):\n    df[&#39;Sum&#39;] = df[&#39;English&#39;] + df[&#39;Chinese&#39;] + df[&#39;Math&#39;]\n    return df\n\n# Use the average mark of Math to fill the NaN value\ndf.fillna(df[&#39;Math&#39;].mean(), inplace=True)\n\n# call the function and add a line called &quot;Sum&quot;, pay attention to the value of axis\nprint(df.apply(addSum, axis=1))\n","like_count":0},{"had_liked":false,"id":53962,"user_name":"拉我吃","can_delete":false,"product_type":"c1","uid":1354151,"ip_address":"","ucode":"8BC9C44FE00097","user_header":"https://static001.geekbang.org/account/avatar/00/14/a9/a7/de3ee890.jpg","comment_is_top":false,"comment_ctime":1545782383,"is_pvip":false,"replies":null,"discussion_count":0,"race_medal":0,"score":20,"product_id":100021701,"comment_content":"# coding: utf8\nimport pandas as pd\n\nfrom pandas import Series, DataFrame\nfrom pandasql import sqldf, load_meat, load_births\n\n&quot;&quot;&quot;\n对于下表的数据，请使用 Pandas 中的 DataFrame 进行创建，并对数据进行清洗。同时新增一列“总和”计算每个人的三科成绩之和。\n&quot;&quot;&quot;\n\ndef total(df):\n    df[u&#39;总和&#39;] = (df[u&#39;语文&#39;] + df[u&#39;英语&#39;] + df[u&#39;数学&#39;])\n    return df\n\n\n# 导入并初始化数据到DataFrame中\ndf = pd.read_excel(&#39;Book.xlsx&#39;)\n\n# 消除重复行\ndf = df.drop_duplicates()\n\n# 添加并计算总成绩列\ndfnew = df.apply(total, axis=1)\n\n# 排序\ndfnew = dfnew.sort_values([u&#39;总和&#39;], ascending=False)\n\n# 输出\nprint(dfnew)\n","like_count":0},{"had_liked":false,"id":53933,"user_name":"汪汪汪","can_delete":false,"product_type":"c1","uid":1352124,"ip_address":"","ucode":"5BF97C411703C8","user_header":"https://static001.geekbang.org/account/avatar/00/14/a1/bc/99c20923.jpg","comment_is_top":false,"comment_ctime":1545762330,"is_pvip":false,"replies":null,"discussion_count":0,"race_medal":0,"score":20,"product_id":100021701,"comment_content":"import pandas as pd\nimport numpy as np\nfrom pandas import Series, DataFrame\n# 1.创建表格数据\ndata = {&quot;语文&quot;:[66, 95, 95, 90, 80, 80],\n        &quot;英语&quot;:[65, 85, 92, 88, 90, 90],\n        &quot;数学&quot;:[None, 98, 96, 77, 90, 90]}\ndf = DataFrame(data,\n               index=[&quot;张飞&quot;,&quot;关羽&quot;,&quot;赵云&quot;,&quot;黄忠&quot;,&quot;典韦&quot;,&quot;典韦&quot;],\n               columns=[&quot;语文&quot;,&quot;英语&quot;,&quot;数学&quot;])\nprint(df)\n# 对数据进行清洗\n# 1) 删除重复数据（典韦）\ndf1 = df.drop_duplicates()\n# 2) 将空值NaN替换为0\ndf1.fillna(0, inplace=True)\nprint(df1)\n# 3) 新增一行，计算每个人的三科成绩之和\ndef total_score(df1):\n    df1[u&quot;总分&quot;]=df1[u&quot;语文&quot;]+df1[u&quot;英语&quot;]+df1[u&quot;数学&quot;]\n    return df1\ndf2 = df1.apply(total_score, axis=1)\nprint(df2)","like_count":0},{"had_liked":false,"id":53869,"user_name":"Mingjie","can_delete":false,"product_type":"c1","uid":1356757,"ip_address":"","ucode":"58E350527F1261","user_header":"https://static001.geekbang.org/account/avatar/00/14/b3/d5/1ac75658.jpg","comment_is_top":false,"comment_ctime":1545745354,"is_pvip":false,"replies":null,"discussion_count":0,"race_medal":0,"score":20,"product_id":100021701,"comment_content":"我的代码\n***************************\nfrom pandas import Series, DataFrame\nimport re\nfrom pandasql import sqldf, load_meat, load_births\n\ndata = { &#39;name&#39;:[&#39;张飞&#39;,&#39;关羽&#39;,&#39;赵云&#39;,&#39;黄忠&#39;,&#39;典韦&#39;,&#39;典韦&#39;] ,\n         &#39;chinese&#39;: [66,95,95,90,80,80],&#39;english&#39;: [65,85,92,88,90,90],&#39;math&#39;: [None,98,96,77,90,90]}\ndf = DataFrame(data, columns=[&#39;name&#39;,&#39;english&#39;, &#39;chinese&#39;, &#39;math&#39;])\n\nprint(&quot;预览\\n&quot;,df)\n\n#添加一列为总成绩并求和\ndef plus(df):\n    #df[&#39;total&#39;] = (df[u&#39;Chinese&#39;]+df[u&#39;English&#39;]+df[u&#39;Math&#39;])\n    return df\n\n#添加一列 ‘total’，并计算求和\ndf[&#39;total&#39;] = df.sum(axis=1)\n\n#首字母大写转换\ndf.columns = df.columns.str.title()\n\n#去除空值的行\n#df = df.dropna()\n\n# 查找空值\nprint(&quot;查找空值\\n&quot;,df.isnull())\n\n# 查找空值 并 将空值用平均值填充\nnone_series = df.isnull().any()\ncol_name = re.findall(r&quot;&#39;(.+?)&#39;&quot;,str(none_series[none_series== True].index))\ndf[col_name[0]].fillna(df[col_name[0]].mean(), inplace=True)\n\n# 去除重复行\ndf = df.drop_duplicates()\n\n#按照总分排序\ndf.sort_values([&#39;Total&#39;], ascending=[False], inplace=True)\n\nprint(&quot;数据清洗后\\n&quot;,df)\n\nprint(&quot;统计数据\\n&quot;,df.describe())","like_count":0},{"had_liked":false,"id":53840,"user_name":"怀念列侬","can_delete":false,"product_type":"c1","uid":1104248,"ip_address":"","ucode":"C91DD8D392F7A6","user_header":"https://static001.geekbang.org/account/avatar/00/10/d9/78/ed5a1922.jpg","comment_is_top":false,"comment_ctime":1545739346,"is_pvip":false,"replies":null,"discussion_count":0,"race_medal":0,"score":20,"product_id":100021701,"comment_content":"from pandas import Series, DataFrame\nimport numpy as np\n\ndata = {&#39;Chinese&#39;: [66, 95, 93, 90, 80, 80], &#39;English&#39;: [65, 85, 92, 88, 90, 90], &#39;Math&#39;: [None, 98, 96, 77, 90, 90]}\ndf = DataFrame(data, index=[&#39;张飞&#39;, &#39;关羽&#39;, &#39;赵云&#39;, &#39;黄忠&#39;, &#39;典韦&#39;, &#39;典韦&#39;], columns=[&#39;Chinese&#39;, &#39;English&#39;, &#39;Math&#39;])\ndf = df.drop_duplicates()\ndf.rename(columns={&#39;Chinese&#39;: &#39;语文&#39;, &#39;English&#39;: &#39;英语&#39;, &#39;Math&#39;: &#39;数学&#39;}, inplace = True)\nprint df.describe().round()\n\ndf[&#39;总和&#39;] = np.where(df[&#39;语文&#39;].isnull(), 0, df[&#39;语文&#39;]) + np.where(df[&#39;英语&#39;].isnull(), 0, df[&#39;英语&#39;]) + np.where(df[&#39;数学&#39;].isnull(), 0, df[&#39;数学&#39;])\nprint df","like_count":0},{"had_liked":false,"id":53814,"user_name":"1e-43","can_delete":false,"product_type":"c1","uid":1138688,"ip_address":"","ucode":"8AADC2ED8409E9","user_header":"https://static001.geekbang.org/account/avatar/00/11/60/00/3dbaf430.jpg","comment_is_top":false,"comment_ctime":1545733557,"is_pvip":false,"replies":null,"discussion_count":0,"race_medal":0,"score":20,"product_id":100021701,"comment_content":"import pandas as pd\ndata = {&#39;Chinese&#39;:[66,95,95,90,80,80],&#39;English&#39;:[65,85,92,88,90,90],&#39;Math&#39;:[None,98,96,77,90,90]}\ndf1=pd.DataFrame(data,index=[&#39;zhangfie&#39;,&#39;guanyu&#39;,&#39;zhaoyun&#39;,&#39;huangzhong&#39;,&#39;dianwei&#39;,&#39;dianwwei&#39;],columns=[&#39;Chinese&#39;, &#39;English&#39; ,&#39;Math&#39;])\ndf2=df1.drop_duplicates()\ndf2.insert(3,&#39;zonghe&#39;,df2.sum(axis=1))","like_count":0},{"had_liked":false,"id":53761,"user_name":"轨迹","can_delete":false,"product_type":"c1","uid":1026737,"ip_address":"","ucode":"B212E2582B38CE","user_header":"https://static001.geekbang.org/account/avatar/00/0f/aa/b1/52d2871f.jpg","comment_is_top":false,"comment_ctime":1545721007,"is_pvip":false,"replies":null,"discussion_count":0,"race_medal":0,"score":20,"product_id":100021701,"comment_content":"pandas的dataframe基本上就是关系数据库的表，pandas对比表有什么优势","like_count":0},{"had_liked":false,"id":53756,"user_name":"不能忘记的笑容","can_delete":false,"product_type":"c1","uid":1356706,"ip_address":"","ucode":"FCD3F3C53DD9D4","user_header":"","comment_is_top":false,"comment_ctime":1545720227,"is_pvip":false,"replies":null,"discussion_count":0,"race_medal":0,"score":20,"product_id":100021701,"comment_content":"老师，请问，用apply定义函数的时候，为什么要加u，u代表什么意思，例如：\ndef plus(df):\n    df[&#39;total&#39;] = (df[u&#39;chinese&#39;]+df[u&#39;english&#39;]+df[u&#39;math&#39;])\n    return df","like_count":0},{"had_liked":false,"id":53748,"user_name":"北方","can_delete":false,"product_type":"c1","uid":1114754,"ip_address":"","ucode":"D04589B652AC29","user_header":"https://static001.geekbang.org/account/avatar/00/11/02/82/abed70a0.jpg","comment_is_top":false,"comment_ctime":1545718913,"is_pvip":false,"replies":null,"discussion_count":0,"race_medal":0,"score":20,"product_id":100021701,"comment_content":"#!&#47;usr&#47;bin&#47;env python\n# -*- coding:utf8 -*-\n# __author__ = &#39;北方姆Q&#39;\n# __datetime__ = 2018&#47;12&#47;25 10:36\n\n\nimport pandas as pd\n\n\ndata = {\n    &#39; Chinese&#39;: [66, 95, 93, 90, 80, 80],\n    &#39;English  &#39;: [65, 85, 92, 88, 90, 90],\n    &#39;  Math  &#39;: [None, 98, 96, 77, 90, 90]\n}\ndf = pd.DataFrame(data, index=[&#39;ZhangFei&#39;, &#39;GuanYu&#39;, &#39;ZhaoYun&#39;, &#39;HuangZhong&#39;, &#39;DianWei&#39;, &#39;DianWei&#39;])\n\n# 去重行\ndf = df.drop_duplicates()\n\n# 列名去空格\ndf.columns = df.columns.str.strip()\n\n# 列名转化\ndf.rename(columns={\n    &#39;Chinese&#39;: &#39;语文&#39;,\n    &#39;English&#39;:  &#39;英语&#39;,\n    &#39;Math&#39;:  &#39;数学&#39;\n}, inplace=True)\n\n# 补充缺考数据\ndf[&#39;数学&#39;].fillna(0, inplace=True)\n\n# 添加总分列\ndf[&#39;Total&#39;] = df.sum(axis=1)\n\nprint(df)\nprint(&quot;===========================&quot;)\nprint(df.describe())\n","like_count":0},{"had_liked":false,"id":53667,"user_name":"chochinlu","can_delete":false,"product_type":"c1","uid":1266152,"ip_address":"","ucode":"E98E3E848F8AD9","user_header":"https://static001.geekbang.org/account/avatar/00/13/51/e8/5a942071.jpg","comment_is_top":false,"comment_ctime":1545707492,"is_pvip":false,"replies":null,"discussion_count":0,"race_medal":0,"score":20,"product_id":100021701,"comment_content":"from pandas import DataFrame\n\nscores = {\n    &#39;Chinese&#39;: [66, 95, 95, 90, 80, 80],\n    &#39;English&#39;: [65, 85, 92, 88, 90, 90],\n    &#39;Math&#39;: [None, 98, 96, 77, 90, 90]\n}\n\ndf = DataFrame(scores, index=[&#39;张飞&#39;, &#39;关羽&#39;, &#39;赵云&#39;, &#39;黄忠&#39;, &#39;典韦&#39;, &#39;典韦&#39;])\n\n# clean data\ndf2 = df.drop_duplicates()\ndf2 = df2.replace([None], 0)\ndf2[&#39;Math&#39;] = df2.astype(int)\n\ndef addSum(df):\n    df[&#39;Sum&#39;] = df[&#39;Chinese&#39;] + df[&#39;English&#39;] + df[&#39;Math&#39;]\n    return df\n\nprint(df2.apply(addSum, axis=1))","like_count":0},{"had_liked":false,"id":53656,"user_name":"CNxxxxx","can_delete":false,"product_type":"c1","uid":1243483,"ip_address":"","ucode":"FDF4F218C52E99","user_header":"http://thirdwx.qlogo.cn/mmopen/vi_32/ibrIw5sOVgfnH3JjKcYHcT5bbJUoaCST3anibeKrtbZLMtdO7t1ZmE3ZW2cgqs8dmDIdKMQag9MnXP5OgoMXqFeg/132","comment_is_top":false,"comment_ctime":1545705835,"is_pvip":false,"replies":null,"discussion_count":0,"race_medal":0,"score":21,"product_id":100021701,"comment_content":"import pandas as pd\nfrom pandas import Series, DataFrame\nscore = DataFrame(pd.read_excel(&#39;testdata.xlsx&#39;))\n\n\n#score = score.dropna()\n# print(score)\n#替换空值\nscore.fillna(score[&#39;music&#39;].mean(), inplace=True)\nscore = score.drop_duplicates()\nprint(score)\n\n#添加一列\ndef addTotalColumn(df):\n    df[&#39;total&#39;] = df.sum(axis=1)\n    return df\n\n\nscore = addTotalColumn(score)\nprint(score)\nscore.to_excel(&#39;pd_practice_result.xlsx&#39;)\n#抄袭了同学们的idea","like_count":0},{"had_liked":false,"id":53653,"user_name":"Gerard","can_delete":false,"product_type":"c1","uid":1353630,"ip_address":"","ucode":"BE61873D123FC6","user_header":"https://static001.geekbang.org/account/avatar/00/14/a7/9e/b580616f.jpg","comment_is_top":false,"comment_ctime":1545705586,"is_pvip":false,"replies":null,"discussion_count":0,"race_medal":0,"score":21,"product_id":100021701,"comment_content":"老师，您好！我数据的导入和输出代码运行不通，在这个工程目录下创建了一个excel表，然后还是显示没有这个文件，麻烦老师看到了解答一下","like_count":0},{"had_liked":false,"id":53626,"user_name":"Jie","can_delete":false,"product_type":"c1","uid":1355892,"ip_address":"","ucode":"B251D8EB7BCEE1","user_header":"https://static001.geekbang.org/account/avatar/00/14/b0/74/5e8b277b.jpg","comment_is_top":false,"comment_ctime":1545702151,"is_pvip":false,"replies":null,"discussion_count":0,"race_medal":0,"score":21,"product_id":100021701,"comment_content":"import pandas as pd\nfrom pandas import DataFrame\n\n#写入数据\ndf1 = DataFrame(pd.read_excel(&#39;score_chinese.xlsx&#39;))\n\n#删除重复行\ndf1 = df1.drop_duplicates()\n#删除含有空值的行\ndf1 = df1.dropna(axis = 0,how = &#39;any&#39;)\n\n#计算总分\ndef total(df):\n\tdf[u&#39;总分&#39;] = df[u&#39;语文&#39;] + df[u&#39;英语&#39;] + df[u&#39;数学&#39;]\n\treturn df\n\ndf1 = df1.apply(total,axis =1)\nprint (df1)","like_count":0},{"had_liked":false,"id":53573,"user_name":"吴晓岚 jim wu","can_delete":false,"product_type":"c1","uid":1352009,"ip_address":"","ucode":"A4560901000FC8","user_header":"https://static001.geekbang.org/account/avatar/00/14/a1/49/a787ddaf.jpg","comment_is_top":false,"comment_ctime":1545696839,"is_pvip":false,"replies":null,"discussion_count":0,"race_medal":0,"score":21,"product_id":100021701,"comment_content":"import numpy as np\nimport pandas as pd\nfrom pandas import Series, DataFrame\n\ndata = {&#39;Chinese&#39;:[66,95,95,90,80,80], &#39;English&#39;:[65,85,92,88,90,90], &#39;Math&#39;:[ None,98,96,77,90,90]}\ndf2 = DataFrame(data,index=[&#39;zhangfei&#39;,&#39;Guanyu&#39;,&#39;zhaoyun&#39;,&#39;huangzhong&#39;,&#39;dianwei&#39;,&#39;dianwei&#39;])\nprint(df2)\n\ndf3 = df2.drop_duplicates(df2)\n\ndf3.fillna(df3[&#39;Math&#39;].mean(),inplace=True)\ndf3[&#39;total&#39;] = df3[&#39;Chinese&#39;] +df3[&#39;English&#39;] +df3[&#39;Math&#39;]\ndf3","like_count":0},{"had_liked":false,"id":53528,"user_name":"王      慈","can_delete":false,"product_type":"c1","uid":1298139,"ip_address":"","ucode":"EACC3D086674D8","user_header":"https://static001.geekbang.org/account/avatar/00/13/ce/db/bb1821b3.jpg","comment_is_top":false,"comment_ctime":1545663292,"is_pvip":false,"replies":null,"discussion_count":0,"race_medal":0,"score":21,"product_id":100021701,"comment_content":"# python 2.7\n# IMPORT\nimport numpy as np\nimport pandas as pd\n\n# 构造 DataFrame\ndf = pd.DataFrame({u&#39;语文&#39;: [66, 95, 95, 90, 80, 80], u&#39;英语&#39;: [65, 85, 92, 88, 90, 90], u&#39;数学&#39;: [np.nan, 98, 96, 77, 90, 90]}, index=[u&#39;张飞&#39;, u&#39;关羽&#39;, u&#39;赵云&#39;, u&#39;黄忠&#39;, u&#39;典韦&#39;, u&#39;典韦&#39;], columns=[u&#39;语文&#39;, u&#39;英语&#39;, u&#39;数学&#39;])\n# df.index.name = u&#39;姓名&#39;\n\n# 去重\ndf.drop_duplicates(inplace=True)\n\n# 均值填充空值 (略显不合理, 请指教)\ndf[u&#39;数学&#39;].fillna(df[u&#39;数学&#39;].mean(), inplace=True)\n\n# 求成绩总和\ndf[u&#39;总和&#39;] = df.sum(axis=1)\n\n# 输出结果\nprint(df)","like_count":0},{"had_liked":false,"id":53517,"user_name":"跳跳","can_delete":false,"product_type":"c1","uid":1172803,"ip_address":"","ucode":"80B697B89E1A0B","user_header":"https://static001.geekbang.org/account/avatar/00/11/e5/43/7bc7cfe3.jpg","comment_is_top":false,"comment_ctime":1545662068,"is_pvip":false,"replies":null,"discussion_count":0,"race_medal":0,"score":21,"product_id":100021701,"comment_content":"import pandas as pd\nimport pandas from Series,DataFrame\ndata={&#39;chinses&#39;:[66,95,95,90,80,80],&#39;English&#39;:[65,85,92,88,90,90],&#39;math&#39;:[,98,96,77,90,90]}\ndf=DataFrame(data,indax=[&#39;zhangfei&#39;,&#39;guanyu&#39;,&#39;zhaoyun&#39;,&#39;huangzhong&#39;,&#39;diewei&#39;,&#39;diewei&#39;],columns=[&#39;chinese&#39;,&#39;english&#39;,&#39;math&#39;])\n#判断是否有空值,0替换空值\ndf.isnull()\ndf=df.fillna(0,inplace=True)\n#查看一下统计值\nprint df.describe()\n#去掉重复值\ndf=df.drop_duplicates()\ndef totalscore(df):\n    df[&#39;totalscore&#39;]=df[&#39;chinese&#39;]+df[&#39;English&#39;]+df[&#39;math&#39;]\n    return df\ndf1=df1.apply(totalscore,axis=1)\nprint df1","like_count":0},{"had_liked":false,"id":53506,"user_name":"JingZ","can_delete":false,"product_type":"c1","uid":1023464,"ip_address":"","ucode":"6F97895B2CC375","user_header":"https://thirdwx.qlogo.cn/mmopen/vi_32/wJphZ3HcvhjVUyTWCIsCugzfQY5NAy6VJ0XoPLibDlcHWMswFmFe678zd0lUjFETia80NQhyQcVnGDlKgKPcRGyw/132","comment_is_top":false,"comment_ctime":1545660183,"is_pvip":false,"replies":null,"discussion_count":0,"race_medal":0,"score":21,"product_id":100021701,"comment_content":"# Spider(Python 3.7)\n\n# 创建表格数据\ndata = {&#39;语文&#39;:[65,95,95,90,80,80],&#39;英语&#39;:[65,85,92,88,90,90],&#39;数学&#39;:[&#39;&#39;,98,96,77,90,90]}\ndf = DataFrame(data,index=[&#39;张飞&#39;,&#39;关羽&#39;,&#39;赵云&#39;,&#39;黄忠&#39;,&#39;典韦&#39;,&#39;典韦&#39;],columns = [&#39;语文&#39;,&#39;英语&#39;,&#39;数学&#39;])\nprint(df)\n\n# 数据清洗\ndf = df.drop_duplicates()\ndf = df.replace(to_replace = &#39;&#39;,value=0)\nprint(df)\n\n#新增“总和”\ndf[&#39;总和&#39;]=df[&#39;语文&#39;]+df[&#39;英语&#39;]+df[&#39;数学&#39;]\nprint(df)\n\n#打印结果\ndf.replace(to_replace =0,value =&#39;&#39;,inplace = True)\nprint(df)","like_count":0},{"had_liked":false,"id":53371,"user_name":"Lin_嘉杰","can_delete":false,"product_type":"c1","uid":1023901,"ip_address":"","ucode":"377885EBBC9C03","user_header":"https://static001.geekbang.org/account/avatar/00/0f/9f/9d/67a33381.jpg","comment_is_top":false,"comment_ctime":1545634426,"is_pvip":false,"replies":null,"discussion_count":0,"race_medal":0,"score":21,"product_id":100021701,"comment_content":"from pandas import DataFrame\ndata = {&#39;chinese&#39;:[66,95,95,90,80,80],&#39;english&#39;:[65,85,92,88,90,90],&#39;math&#39;:[None,98,96,77,90,90]}\nmark = DataFrame(data, index=[&#39;张飞&#39;,&#39;关羽&#39;,&#39;赵云&#39;,&#39;黄忠&#39;,&#39;典韦&#39;,&#39;典韦&#39;])\n# print(mark)\n# 清洗重复行\nmark = mark.drop_duplicates()\n# 将为空的数据填充为0\nmark = mark.fillna(0)\nmark.rename(columns={&#39;chinese&#39;:&#39;语文&#39;,&#39;english&#39;:&#39;英语&#39;,&#39;math&#39;:&#39;数学&#39;}, inplace=True)\ndef add(mark):\n    mark[&#39;总分&#39;] = mark[&#39;语文&#39;] + mark[&#39;英语&#39;] + mark[&#39;数学&#39;]\n    return mark\nmark = mark.apply(add, axis=1)\nprint(mark)","like_count":0},{"had_liked":false,"id":53342,"user_name":"mickey","can_delete":false,"product_type":"c1","uid":1051663,"ip_address":"","ucode":"8B490C2DDE4010","user_header":"https://static001.geekbang.org/account/avatar/00/10/0c/0f/93d1c8eb.jpg","comment_is_top":false,"comment_ctime":1545628931,"is_pvip":false,"replies":null,"discussion_count":0,"race_medal":0,"score":21,"product_id":100021701,"comment_content":"#!&#47;usr&#47;bin&#47;python\n# vim: set fileencoding:utf-8\nimport pandas as pd\nfrom pandas import DataFrame\n\n# 导入成绩\ndata = pd.read_excel(u&#39;成绩表.xlsx&#39;)\ndf = DataFrame(data)\nprint df\n\n\n# 求和，并增加一列“总和”\ndef addtotal(df):\n    df[u&#39;总和&#39;] = df[u&#39;语文&#39;] + df[u&#39;英语&#39;] + df[u&#39;数学&#39;]\n    return df\n\n\n# 清洗为空的数据\ndf1 = df.dropna()\n\n# 清洗重复的数据\ndf1 = df1.drop_duplicates()\n\n# 生成新数据结构\ndf1= df1.apply(addtotal, axis=1)\nprint(df1)","like_count":0},{"had_liked":false,"id":53263,"user_name":"狸猫假面","can_delete":false,"product_type":"c1","uid":1357908,"ip_address":"","ucode":"D1C91A13BDB48C","user_header":"https://static001.geekbang.org/account/avatar/00/14/b8/54/618b7aee.jpg","comment_is_top":false,"comment_ctime":1545620618,"is_pvip":false,"replies":null,"discussion_count":0,"race_medal":0,"score":21,"product_id":100021701,"comment_content":"说起来pandas可以用pivot_table来构建数据透视表，请问老师有什么方法可以讲输出的透视表存储到文件中，例如excel中么？很多时候自己做的数据结果只能在jupyter notebook中看，感觉不太方便","like_count":0},{"had_liked":false,"id":53656,"user_name":"CNxxxxx","can_delete":false,"product_type":"c1","uid":1243483,"ip_address":"","ucode":"FDF4F218C52E99","user_header":"http://thirdwx.qlogo.cn/mmopen/vi_32/ibrIw5sOVgfnH3JjKcYHcT5bbJUoaCST3anibeKrtbZLMtdO7t1ZmE3ZW2cgqs8dmDIdKMQag9MnXP5OgoMXqFeg/132","comment_is_top":false,"comment_ctime":1545705835,"is_pvip":false,"replies":null,"discussion_count":0,"race_medal":0,"score":21,"product_id":100021701,"comment_content":"import pandas as pd\nfrom pandas import Series, DataFrame\nscore = DataFrame(pd.read_excel(&#39;testdata.xlsx&#39;))\n\n\n#score = score.dropna()\n# print(score)\n#替换空值\nscore.fillna(score[&#39;music&#39;].mean(), inplace=True)\nscore = score.drop_duplicates()\nprint(score)\n\n#添加一列\ndef addTotalColumn(df):\n    df[&#39;total&#39;] = df.sum(axis=1)\n    return df\n\n\nscore = addTotalColumn(score)\nprint(score)\nscore.to_excel(&#39;pd_practice_result.xlsx&#39;)\n#抄袭了同学们的idea","like_count":0},{"had_liked":false,"id":53653,"user_name":"Gerard","can_delete":false,"product_type":"c1","uid":1353630,"ip_address":"","ucode":"BE61873D123FC6","user_header":"https://static001.geekbang.org/account/avatar/00/14/a7/9e/b580616f.jpg","comment_is_top":false,"comment_ctime":1545705586,"is_pvip":false,"replies":null,"discussion_count":0,"race_medal":0,"score":21,"product_id":100021701,"comment_content":"老师，您好！我数据的导入和输出代码运行不通，在这个工程目录下创建了一个excel表，然后还是显示没有这个文件，麻烦老师看到了解答一下","like_count":0},{"had_liked":false,"id":53626,"user_name":"Jie","can_delete":false,"product_type":"c1","uid":1355892,"ip_address":"","ucode":"B251D8EB7BCEE1","user_header":"https://static001.geekbang.org/account/avatar/00/14/b0/74/5e8b277b.jpg","comment_is_top":false,"comment_ctime":1545702151,"is_pvip":false,"replies":null,"discussion_count":0,"race_medal":0,"score":21,"product_id":100021701,"comment_content":"import pandas as pd\nfrom pandas import DataFrame\n\n#写入数据\ndf1 = DataFrame(pd.read_excel(&#39;score_chinese.xlsx&#39;))\n\n#删除重复行\ndf1 = df1.drop_duplicates()\n#删除含有空值的行\ndf1 = df1.dropna(axis = 0,how = &#39;any&#39;)\n\n#计算总分\ndef total(df):\n\tdf[u&#39;总分&#39;] = df[u&#39;语文&#39;] + df[u&#39;英语&#39;] + df[u&#39;数学&#39;]\n\treturn df\n\ndf1 = df1.apply(total,axis =1)\nprint (df1)","like_count":0},{"had_liked":false,"id":53573,"user_name":"吴晓岚 jim wu","can_delete":false,"product_type":"c1","uid":1352009,"ip_address":"","ucode":"A4560901000FC8","user_header":"https://static001.geekbang.org/account/avatar/00/14/a1/49/a787ddaf.jpg","comment_is_top":false,"comment_ctime":1545696839,"is_pvip":false,"replies":null,"discussion_count":0,"race_medal":0,"score":21,"product_id":100021701,"comment_content":"import numpy as np\nimport pandas as pd\nfrom pandas import Series, DataFrame\n\ndata = {&#39;Chinese&#39;:[66,95,95,90,80,80], &#39;English&#39;:[65,85,92,88,90,90], &#39;Math&#39;:[ None,98,96,77,90,90]}\ndf2 = DataFrame(data,index=[&#39;zhangfei&#39;,&#39;Guanyu&#39;,&#39;zhaoyun&#39;,&#39;huangzhong&#39;,&#39;dianwei&#39;,&#39;dianwei&#39;])\nprint(df2)\n\ndf3 = df2.drop_duplicates(df2)\n\ndf3.fillna(df3[&#39;Math&#39;].mean(),inplace=True)\ndf3[&#39;total&#39;] = df3[&#39;Chinese&#39;] +df3[&#39;English&#39;] +df3[&#39;Math&#39;]\ndf3","like_count":0},{"had_liked":false,"id":53528,"user_name":"王      慈","can_delete":false,"product_type":"c1","uid":1298139,"ip_address":"","ucode":"EACC3D086674D8","user_header":"https://static001.geekbang.org/account/avatar/00/13/ce/db/bb1821b3.jpg","comment_is_top":false,"comment_ctime":1545663292,"is_pvip":false,"replies":null,"discussion_count":0,"race_medal":0,"score":21,"product_id":100021701,"comment_content":"# python 2.7\n# IMPORT\nimport numpy as np\nimport pandas as pd\n\n# 构造 DataFrame\ndf = pd.DataFrame({u&#39;语文&#39;: [66, 95, 95, 90, 80, 80], u&#39;英语&#39;: [65, 85, 92, 88, 90, 90], u&#39;数学&#39;: [np.nan, 98, 96, 77, 90, 90]}, index=[u&#39;张飞&#39;, u&#39;关羽&#39;, u&#39;赵云&#39;, u&#39;黄忠&#39;, u&#39;典韦&#39;, u&#39;典韦&#39;], columns=[u&#39;语文&#39;, u&#39;英语&#39;, u&#39;数学&#39;])\n# df.index.name = u&#39;姓名&#39;\n\n# 去重\ndf.drop_duplicates(inplace=True)\n\n# 均值填充空值 (略显不合理, 请指教)\ndf[u&#39;数学&#39;].fillna(df[u&#39;数学&#39;].mean(), inplace=True)\n\n# 求成绩总和\ndf[u&#39;总和&#39;] = df.sum(axis=1)\n\n# 输出结果\nprint(df)","like_count":0},{"had_liked":false,"id":53517,"user_name":"跳跳","can_delete":false,"product_type":"c1","uid":1172803,"ip_address":"","ucode":"80B697B89E1A0B","user_header":"https://static001.geekbang.org/account/avatar/00/11/e5/43/7bc7cfe3.jpg","comment_is_top":false,"comment_ctime":1545662068,"is_pvip":false,"replies":null,"discussion_count":0,"race_medal":0,"score":21,"product_id":100021701,"comment_content":"import pandas as pd\nimport pandas from Series,DataFrame\ndata={&#39;chinses&#39;:[66,95,95,90,80,80],&#39;English&#39;:[65,85,92,88,90,90],&#39;math&#39;:[,98,96,77,90,90]}\ndf=DataFrame(data,indax=[&#39;zhangfei&#39;,&#39;guanyu&#39;,&#39;zhaoyun&#39;,&#39;huangzhong&#39;,&#39;diewei&#39;,&#39;diewei&#39;],columns=[&#39;chinese&#39;,&#39;english&#39;,&#39;math&#39;])\n#判断是否有空值,0替换空值\ndf.isnull()\ndf=df.fillna(0,inplace=True)\n#查看一下统计值\nprint df.describe()\n#去掉重复值\ndf=df.drop_duplicates()\ndef totalscore(df):\n    df[&#39;totalscore&#39;]=df[&#39;chinese&#39;]+df[&#39;English&#39;]+df[&#39;math&#39;]\n    return df\ndf1=df1.apply(totalscore,axis=1)\nprint df1","like_count":0},{"had_liked":false,"id":53506,"user_name":"JingZ","can_delete":false,"product_type":"c1","uid":1023464,"ip_address":"","ucode":"6F97895B2CC375","user_header":"https://thirdwx.qlogo.cn/mmopen/vi_32/wJphZ3HcvhjVUyTWCIsCugzfQY5NAy6VJ0XoPLibDlcHWMswFmFe678zd0lUjFETia80NQhyQcVnGDlKgKPcRGyw/132","comment_is_top":false,"comment_ctime":1545660183,"is_pvip":false,"replies":null,"discussion_count":0,"race_medal":0,"score":21,"product_id":100021701,"comment_content":"# Spider(Python 3.7)\n\n# 创建表格数据\ndata = {&#39;语文&#39;:[65,95,95,90,80,80],&#39;英语&#39;:[65,85,92,88,90,90],&#39;数学&#39;:[&#39;&#39;,98,96,77,90,90]}\ndf = DataFrame(data,index=[&#39;张飞&#39;,&#39;关羽&#39;,&#39;赵云&#39;,&#39;黄忠&#39;,&#39;典韦&#39;,&#39;典韦&#39;],columns = [&#39;语文&#39;,&#39;英语&#39;,&#39;数学&#39;])\nprint(df)\n\n# 数据清洗\ndf = df.drop_duplicates()\ndf = df.replace(to_replace = &#39;&#39;,value=0)\nprint(df)\n\n#新增“总和”\ndf[&#39;总和&#39;]=df[&#39;语文&#39;]+df[&#39;英语&#39;]+df[&#39;数学&#39;]\nprint(df)\n\n#打印结果\ndf.replace(to_replace =0,value =&#39;&#39;,inplace = True)\nprint(df)","like_count":0},{"had_liked":false,"id":53371,"user_name":"Lin_嘉杰","can_delete":false,"product_type":"c1","uid":1023901,"ip_address":"","ucode":"377885EBBC9C03","user_header":"https://static001.geekbang.org/account/avatar/00/0f/9f/9d/67a33381.jpg","comment_is_top":false,"comment_ctime":1545634426,"is_pvip":false,"replies":null,"discussion_count":0,"race_medal":0,"score":21,"product_id":100021701,"comment_content":"from pandas import DataFrame\ndata = {&#39;chinese&#39;:[66,95,95,90,80,80],&#39;english&#39;:[65,85,92,88,90,90],&#39;math&#39;:[None,98,96,77,90,90]}\nmark = DataFrame(data, index=[&#39;张飞&#39;,&#39;关羽&#39;,&#39;赵云&#39;,&#39;黄忠&#39;,&#39;典韦&#39;,&#39;典韦&#39;])\n# print(mark)\n# 清洗重复行\nmark = mark.drop_duplicates()\n# 将为空的数据填充为0\nmark = mark.fillna(0)\nmark.rename(columns={&#39;chinese&#39;:&#39;语文&#39;,&#39;english&#39;:&#39;英语&#39;,&#39;math&#39;:&#39;数学&#39;}, inplace=True)\ndef add(mark):\n    mark[&#39;总分&#39;] = mark[&#39;语文&#39;] + mark[&#39;英语&#39;] + mark[&#39;数学&#39;]\n    return mark\nmark = mark.apply(add, axis=1)\nprint(mark)","like_count":0},{"had_liked":false,"id":53342,"user_name":"mickey","can_delete":false,"product_type":"c1","uid":1051663,"ip_address":"","ucode":"8B490C2DDE4010","user_header":"https://static001.geekbang.org/account/avatar/00/10/0c/0f/93d1c8eb.jpg","comment_is_top":false,"comment_ctime":1545628931,"is_pvip":false,"replies":null,"discussion_count":0,"race_medal":0,"score":21,"product_id":100021701,"comment_content":"#!&#47;usr&#47;bin&#47;python\n# vim: set fileencoding:utf-8\nimport pandas as pd\nfrom pandas import DataFrame\n\n# 导入成绩\ndata = pd.read_excel(u&#39;成绩表.xlsx&#39;)\ndf = DataFrame(data)\nprint df\n\n\n# 求和，并增加一列“总和”\ndef addtotal(df):\n    df[u&#39;总和&#39;] = df[u&#39;语文&#39;] + df[u&#39;英语&#39;] + df[u&#39;数学&#39;]\n    return df\n\n\n# 清洗为空的数据\ndf1 = df.dropna()\n\n# 清洗重复的数据\ndf1 = df1.drop_duplicates()\n\n# 生成新数据结构\ndf1= df1.apply(addtotal, axis=1)\nprint(df1)","like_count":0},{"had_liked":false,"id":53263,"user_name":"狸猫假面","can_delete":false,"product_type":"c1","uid":1357908,"ip_address":"","ucode":"D1C91A13BDB48C","user_header":"https://static001.geekbang.org/account/avatar/00/14/b8/54/618b7aee.jpg","comment_is_top":false,"comment_ctime":1545620618,"is_pvip":false,"replies":null,"discussion_count":0,"race_medal":0,"score":21,"product_id":100021701,"comment_content":"说起来pandas可以用pivot_table来构建数据透视表，请问老师有什么方法可以讲输出的透视表存储到文件中，例如excel中么？很多时候自己做的数据结果只能在jupyter notebook中看，感觉不太方便","like_count":0},{"had_liked":false,"id":53260,"user_name":"yaoyao7417","can_delete":false,"product_type":"c1","uid":1352527,"ip_address":"","ucode":"2ECAA32BD0C849","user_header":"https://wx.qlogo.cn/mmopen/vi_32/BI2zhwEjXmAoYpxRVebsyibRb5NmNGHD64HdzeCm5m4icDlkAv0fupfTpABs8e73RTwLBfDLMup4U3O5ibsynruKA/132","comment_is_top":false,"comment_ctime":1545620181,"is_pvip":false,"replies":null,"discussion_count":0,"race_medal":0,"score":22,"product_id":100021701,"comment_content":"import pandas as pd\nscore = {&#39;chinese&#39;:[66,95,95,90,80,80],&#39;english&#39;:[65,85,92,88,90,90],&#39;math&#39;:[0,98,96,77,90,90]}\ndf1 = pd.DataFrame(score,index=[&#39;ZhangFei&#39;,&#39;GuanYu&#39;,&#39;ZhaoYun&#39;,&#39;HuangZhong&#39;,&#39;DianWei&#39;,&#39;DianWei&#39;])\ndf1 = df1.drop_duplicates()\ndf2 = df1[&#39;chinese&#39;] + df1[&#39;english&#39;] + df1[&#39;math&#39;]\ndf2 = pd.DataFrame(df2)\ndf3 = pd.merge(df1.T,df2.T,how=&#39;outer&#39;)\ndf3.rename(index={0:&#39;chinese&#39;,1:&#39;english&#39;,2:&#39;math&#39;,3:&#39;total&#39;}).T\n不太清楚张飞数学为空怎么整","like_count":0},{"had_liked":false,"id":53243,"user_name":"从未在此","can_delete":false,"product_type":"c1","uid":1354589,"ip_address":"","ucode":"5A4AA275D8EE9A","user_header":"https://static001.geekbang.org/account/avatar/00/14/ab/5d/430ed3b6.jpg","comment_is_top":false,"comment_ctime":1545618798,"is_pvip":false,"replies":null,"discussion_count":0,"race_medal":0,"score":22,"product_id":100021701,"comment_content":"import  pandas as pd\ndata＝pd.DataFrame({&#39;姓名&#39;:[&#39;张飞&#39;,&#39;吕布&#39;,&#39;典韦&#39;,&#39;典韦],\n                                       &#39;语文&#39;:[10,20,30,30],\n                                       &#39;数学&#39;:[,50,60,60]}\ndata.drop_duplicates()\ndata[&#39;数学&#39;].isnull()=data[&#39;数学&#39;].mean()\ndata[&#39;总和&#39;]=data.apply(lambda  x:x.sum(),axis＝1)\n手机打字太麻烦了。就少写一点。\n还有那个统计函数那张图，标准差应该是std,老师写成str了\n","like_count":0},{"had_liked":false,"id":53098,"user_name":"Key.","can_delete":false,"product_type":"c1","uid":1308561,"ip_address":"","ucode":"9B2C009090CBBA","user_header":"https://static001.geekbang.org/account/avatar/00/13/f7/91/c5073dbe.jpg","comment_is_top":false,"comment_ctime":1545583431,"is_pvip":false,"replies":null,"discussion_count":0,"race_medal":0,"score":22,"product_id":100021701,"comment_content":"Pandas中最重要是数据结构是Series和DataFrame，Series是基于字典的数据结构，构成数据列(index-value)，而DataFrame是由相同索引的Series构成的数据库表。Pandas库相关的主要用途为数据清洗，数据统计，数据表连接，以及用pandasql操作数据表！数据清洗的方法比如有drop(),columns(),drop_duplicates(),astype(),strip(),isnull(),apply(),upper(),lower(),title()等等","like_count":0},{"had_liked":false,"id":53260,"user_name":"yaoyao7417","can_delete":false,"product_type":"c1","uid":1352527,"ip_address":"","ucode":"2ECAA32BD0C849","user_header":"https://wx.qlogo.cn/mmopen/vi_32/BI2zhwEjXmAoYpxRVebsyibRb5NmNGHD64HdzeCm5m4icDlkAv0fupfTpABs8e73RTwLBfDLMup4U3O5ibsynruKA/132","comment_is_top":false,"comment_ctime":1545620181,"is_pvip":false,"replies":null,"discussion_count":0,"race_medal":0,"score":22,"product_id":100021701,"comment_content":"import pandas as pd\nscore = {&#39;chinese&#39;:[66,95,95,90,80,80],&#39;english&#39;:[65,85,92,88,90,90],&#39;math&#39;:[0,98,96,77,90,90]}\ndf1 = pd.DataFrame(score,index=[&#39;ZhangFei&#39;,&#39;GuanYu&#39;,&#39;ZhaoYun&#39;,&#39;HuangZhong&#39;,&#39;DianWei&#39;,&#39;DianWei&#39;])\ndf1 = df1.drop_duplicates()\ndf2 = df1[&#39;chinese&#39;] + df1[&#39;english&#39;] + df1[&#39;math&#39;]\ndf2 = pd.DataFrame(df2)\ndf3 = pd.merge(df1.T,df2.T,how=&#39;outer&#39;)\ndf3.rename(index={0:&#39;chinese&#39;,1:&#39;english&#39;,2:&#39;math&#39;,3:&#39;total&#39;}).T\n不太清楚张飞数学为空怎么整","like_count":0},{"had_liked":false,"id":53243,"user_name":"从未在此","can_delete":false,"product_type":"c1","uid":1354589,"ip_address":"","ucode":"5A4AA275D8EE9A","user_header":"https://static001.geekbang.org/account/avatar/00/14/ab/5d/430ed3b6.jpg","comment_is_top":false,"comment_ctime":1545618798,"is_pvip":false,"replies":null,"discussion_count":0,"race_medal":0,"score":22,"product_id":100021701,"comment_content":"import  pandas as pd\ndata＝pd.DataFrame({&#39;姓名&#39;:[&#39;张飞&#39;,&#39;吕布&#39;,&#39;典韦&#39;,&#39;典韦],\n                                       &#39;语文&#39;:[10,20,30,30],\n                                       &#39;数学&#39;:[,50,60,60]}\ndata.drop_duplicates()\ndata[&#39;数学&#39;].isnull()=data[&#39;数学&#39;].mean()\ndata[&#39;总和&#39;]=data.apply(lambda  x:x.sum(),axis＝1)\n手机打字太麻烦了。就少写一点。\n还有那个统计函数那张图，标准差应该是std,老师写成str了\n","like_count":0},{"had_liked":false,"id":53098,"user_name":"Key.","can_delete":false,"product_type":"c1","uid":1308561,"ip_address":"","ucode":"9B2C009090CBBA","user_header":"https://static001.geekbang.org/account/avatar/00/13/f7/91/c5073dbe.jpg","comment_is_top":false,"comment_ctime":1545583431,"is_pvip":false,"replies":null,"discussion_count":0,"race_medal":0,"score":22,"product_id":100021701,"comment_content":"Pandas中最重要是数据结构是Series和DataFrame，Series是基于字典的数据结构，构成数据列(index-value)，而DataFrame是由相同索引的Series构成的数据库表。Pandas库相关的主要用途为数据清洗，数据统计，数据表连接，以及用pandasql操作数据表！数据清洗的方法比如有drop(),columns(),drop_duplicates(),astype(),strip(),isnull(),apply(),upper(),lower(),title()等等","like_count":0}]}