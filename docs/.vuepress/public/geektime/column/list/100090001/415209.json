{"id":415209,"title":"01ï½œSparkï¼šä»â€œå¤§æ•°æ®çš„Hello Worldâ€å¼€å§‹","content":"<p>ä½ å¥½ï¼Œæˆ‘æ˜¯å´ç£Šã€‚</p><p>ä»è¿™èŠ‚è¯¾å¼€å§‹ï¼Œæˆ‘ä»¬å…ˆæ¥å­¦ä¹ Sparkçš„â€œåŸºç¡€çŸ¥è¯†â€æ¨¡å—ï¼Œå¯¹Sparkçš„æ¦‚å¿µå’Œæ ¸å¿ƒåŸç†å…ˆåšä¸€ä¸ªæ•´ä½“çš„äº†è§£ã€‚æˆ‘å¹¶ä¸ä¼šä»RDDã€DAGè¿™äº›åŸºæœ¬æ¦‚å¿µç»™ä½ è®²èµ·ã€‚å¦ç™½åœ°è¯´ï¼Œè¿™äº›æŠ½è±¡çš„æ¦‚å¿µæ¯ç‡¥è€Œåˆä¹å‘³ï¼Œå¯¹äºåˆšå¼€å§‹æ¥è§¦Sparkçš„ä½ æ¥è¯´ï¼Œå¾ˆéš¾å­¦è¿›å»ã€‚å› æ­¤ï¼Œæˆ‘ä»¬ä¸å¦¨åå…¶é“è€Œè¡Œä¹‹ï¼Œå…ˆä»å®æˆ˜å…¥æ‰‹ï¼Œç”¨ä¸€ä¸ªå°ä¾‹å­æ¥ç›´è§‚åœ°è®¤è¯†Sparkï¼Œçœ‹çœ‹Sparkéƒ½èƒ½åšäº›ä»€ä¹ˆã€‚</p><p>è¿™å°±å¥½æ¯”æˆ‘ä»¬å­¦ä¹ ä¸€é—¨æ–°çš„ç¼–ç¨‹è¯­è¨€ï¼Œå¾€å¾€éƒ½æ˜¯ä»â€œHello Worldâ€å¼€å§‹ã€‚æˆ‘è¿˜è®°å¾—ï¼Œåˆšåˆšå­¦ç¼–ç¨‹é‚£ä¼šï¼Œå±å¹•ä¸Šæ‰“å°å‡ºçš„â€œHello Worldâ€ï¼Œè¶³è¶³è®©æˆ‘å…´å¥‹äº†ä¸€æ•´å¤©ï¼Œè®©æˆ‘è«ååœ°æœ‰ä¸€ç§â€œI can change the worldâ€çš„å†²åŠ¨ã€‚</p><p>ä»Šå¤©è¿™ä¸€è®²ï¼Œæˆ‘ä»¬å°±ä»â€œå¤§æ•°æ®çš„Hello Worldâ€å¼€å§‹ï¼Œå»å­¦ä¹ æ€ä¹ˆåœ¨Sparkä¹‹ä¸Šåšåº”ç”¨å¼€å‘ã€‚ä¸è¿‡ï¼Œâ€œå¤§æ•°æ®çš„Hello Worldâ€å¹¶ä¸æ˜¯æŠŠå­—ç¬¦ä¸²æ‰“å°åˆ°å±å¹•ä¸Šè¿™ä¹ˆç®€å•ï¼Œè€Œæ˜¯è¦å…ˆå¯¹æ–‡ä»¶ä¸­çš„å•è¯åšç»Ÿè®¡è®¡æ•°ï¼Œç„¶åå†æ‰“å°å‡ºé¢‘æ¬¡æœ€é«˜çš„5ä¸ªå•è¯ï¼Œæ±Ÿæ¹–äººç§°â€œWord Countâ€ã€‚</p><p>ä¹‹æ‰€ä»¥ä¼šé€‰æ‹©Word Countï¼Œä½œä¸ºæˆ‘ä»¬è¿ˆå…¥Sparké—¨æ§›çš„ç¬¬ä¸€ä¸ªé¡¹ç›®ï¼Œä¸»è¦æœ‰ä¸¤ä¸ªåŸå› ï¼Œä¸€æ˜¯Word Countåœºæ™¯æ¯”è¾ƒç®€å•ã€å®¹æ˜“ç†è§£ï¼›äºŒæ˜¯Word Countéº»é›€è™½å°ï¼Œä½†äº”è„ä¿±å…¨ï¼Œä¸€ä¸ªå°å°çš„Word Countï¼Œå°±èƒ½å¤Ÿç‰µå¼•å‡ºSparkè®¸å¤šçš„æ ¸å¿ƒåŸç†ï¼Œå¸®åŠ©æˆ‘ä»¬å¿«é€Ÿå…¥é—¨ã€‚</p><!-- [[[read_end]]] --><p>å¥½å•¦ï¼Œè¯ä¸å¤šè¯´ï¼Œä¸‹é¢æˆ‘ä»¬æ­£å¼å¼€å¯Word Countä¹‹æ—…ã€‚</p><h2><strong>å‡†å¤‡å·¥ä½œ</strong></h2><p>å·§å¦‡éš¾ä¸ºæ— ç±³ä¹‹ç‚Šï¼Œè¦åšWord Countï¼Œæˆ‘ä»¬å¾—å…ˆæŠŠæºæ–‡ä»¶å‡†å¤‡å¥½ã€‚</p><p>å’±ä»¬åšWord Countçš„åˆè¡·æ˜¯å­¦ä¹ Sparkï¼Œå› æ­¤æºæ–‡ä»¶çš„å†…å®¹æ— è¶³è½»é‡ã€‚è¿™é‡Œæˆ‘æå–äº†<a href=\"https://en.wikipedia.org/wiki/Apache_Spark\">Wikipediaä¸­å¯¹Sparkçš„ä»‹ç»</a>æ¥åšæˆ‘ä»¬çš„æºæ–‡ä»¶ã€‚æˆ‘æŠŠå®ƒä¿å­˜åˆ°äº†ä¸è¯¾ç¨‹é…å¥—çš„GitHubé¡¹ç›®ä¸­ï¼Œå¹¶æŠŠå®ƒå‘½åä¸ºâ€œwikiOfSpark.txtâ€ã€‚ä½ å¯ä»¥ä»<a href=\"https://github.com/wulei-bj-cn/learn-spark/blob/main/chapter01/wikiOfSpark.txt\">è¿™é‡Œ</a>ä¸‹è½½å®ƒã€‚</p><p>ä¸ºäº†è·‘é€šWord Countå®ä¾‹ï¼Œæˆ‘ä»¬è¿˜éœ€è¦åœ¨æœ¬åœ°ï¼ˆLocalï¼‰éƒ¨ç½²Sparkè¿è¡Œç¯å¢ƒã€‚è¿™é‡Œçš„â€œæœ¬åœ°â€ï¼ŒæŒ‡çš„æ˜¯ä½ æ‰‹å¤´èƒ½å¤Ÿè·å–åˆ°çš„ä»»ä½•è®¡ç®—èµ„æºï¼Œæ¯”å¦‚æœåŠ¡å™¨ã€å°å¼æœºï¼Œæˆ–æ˜¯ç¬”è®°æœ¬ç”µè„‘ã€‚</p><p>åœ¨æœ¬åœ°éƒ¨ç½²Sparkè¿è¡Œç¯å¢ƒéå¸¸ç®€å•ï¼Œå³ä¾¿ä½ ä»æ¥æ²¡æœ‰å’ŒSparkæ‰“è¿‡äº¤é“ï¼Œä¹Ÿä¸å¿…æ‹…å¿ƒã€‚<strong>åªéœ€è¦ä¸‹é¢è¿™3ä¸ªæ­¥éª¤ï¼Œæˆ‘ä»¬å°±å¯ä»¥å®ŒæˆSparkçš„æœ¬åœ°éƒ¨ç½²äº†</strong>ã€‚</p><ol>\n<li><strong>ä¸‹è½½å®‰è£…åŒ…ï¼š</strong>ä»<a href=\"http://spark.apache.org/downloads.html\">Sparkå®˜ç½‘</a>ä¸‹è½½å®‰è£…åŒ…ï¼Œé€‰æ‹©æœ€æ–°çš„é¢„ç¼–è¯‘ç‰ˆæœ¬å³å¯ï¼›</li>\n<li><strong>è§£å‹ï¼š</strong>è§£å‹Sparkå®‰è£…åŒ…åˆ°ä»»æ„æœ¬åœ°ç›®å½•ï¼›</li>\n<li><strong>é…ç½®ï¼š</strong>å°†â€œ${è§£å‹ç›®å½•}/binâ€é…ç½®åˆ°PATHç¯å¢ƒå˜é‡ã€‚</li>\n</ol><p>æˆ‘è¿™é‡Œç»™ä½ å‡†å¤‡äº†ä¸€ä¸ªæœ¬åœ°éƒ¨ç½²çš„å°è§†é¢‘ï¼Œä½ å¯ä»¥ç›´è§‚åœ°æ„Ÿå—ä¸€ä¸‹ã€‚</p><p><video poster=\"https://media001.geekbang.org/d5c5a960d1d84fcd8d02c3b38515d530/snapshots/f09e3d96d7ef47e98c2e7155198480f2-00004.jpg\" preload=\"none\" controls=\"\"><source src=\"https://media001.geekbang.org/customerTrans/7e27d07d27d407ebcc195a0e78395f55/341986fd-17bef16db30-0000-0000-01d-dbacd.mp4\" type=\"video/mp4\"><source src=\" https://media001.geekbang.org/8eaaf98af7614dc1b5297ebca1e2c746/56a5b58801ea45419cf2760b23b4dc49-b111872a4e8294fade9a938a484f8b67-sd.m3u8\" type=\"application/x-mpegURL\"></video></p><p>æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬ç¡®è®¤ä¸€ä¸‹Sparkæ˜¯å¦éƒ¨ç½²æˆåŠŸã€‚æ‰“å¼€å‘½ä»¤è¡Œç»ˆç«¯ï¼Œæ•²å…¥â€œspark-shell --versionâ€å‘½ä»¤ï¼Œå¦‚æœè¯¥å‘½ä»¤èƒ½æˆåŠŸåœ°æ‰“å°å‡ºSparkç‰ˆæœ¬å·ï¼Œå°±è¡¨ç¤ºæˆ‘ä»¬å¤§åŠŸå‘Šæˆäº†ï¼Œå°±åƒè¿™æ ·ï¼š</p><p><img src=\"https://static001.geekbang.org/resource/image/51/34/51664d2f8479aac9099a1b2736ebee34.jpg?wh=1112x726\" alt=\"\" title=\"éªŒè¯Sparkæœ¬åœ°éƒ¨ç½²æˆåŠŸ\"></p><p>åœ¨åç»­çš„å®æˆ˜ä¸­ï¼Œæˆ‘ä»¬ä¼šç”¨spark-shellæ¥æ¼”ç¤ºWord Countçš„æ‰§è¡Œè¿‡ç¨‹ã€‚spark-shellæ˜¯æäº¤Sparkä½œä¸šä¼—å¤šæ–¹å¼ä¸­çš„ä¸€ç§ï¼Œæˆ‘ä»¬åœ¨åç»­çš„è¯¾ç¨‹ä¸­è¿˜ä¼šå±•å¼€ä»‹ç»ï¼Œè¿™é‡Œä½ ä¸å¦¨æš‚æ—¶æŠŠå®ƒå½“åšæ˜¯Sparkä¸­çš„Linux shellã€‚spark-shellæä¾›äº¤äº’å¼çš„è¿è¡Œç¯å¢ƒï¼ˆREPLï¼ŒRead-Evaluate-Print-Loopï¼‰ï¼Œä»¥â€œæ‰€è§å³æ‰€å¾—â€çš„æ–¹å¼ï¼Œè®©å¼€å‘è€…åœ¨æäº¤æºä»£ç ä¹‹åï¼Œå°±å¯ä»¥è¿…é€Ÿåœ°è·å–æ‰§è¡Œç»“æœã€‚</p><p>ä¸è¿‡ï¼Œéœ€è¦æ³¨æ„çš„æ˜¯ï¼Œspark-shellåœ¨è¿è¡Œçš„æ—¶å€™ï¼Œä¾èµ–äºJavaå’ŒScalaè¯­è¨€ç¯å¢ƒã€‚å› æ­¤ï¼Œä¸ºäº†ä¿è¯spark-shellçš„æˆåŠŸå¯åŠ¨ï¼Œä½ éœ€è¦åœ¨æœ¬åœ°é¢„è£…Javaä¸Scalaã€‚å¥½æ¶ˆæ¯æ˜¯ï¼Œå…³äºJavaä¸Scalaçš„å®‰è£…ï¼Œç½‘ä¸Šçš„èµ„æ–™éå¸¸ä¸°å¯Œï¼Œä½ å¯ä»¥å‚è€ƒé‚£äº›èµ„æ–™æ¥è¿›è¡Œå®‰è£…ï¼Œå’±ä»¬åœ¨æœ¬è®²å°±ä¸å†èµ˜è¿°Javaä¸Scalaçš„å®‰è£…æ­¥éª¤å•¦ã€‚</p><h2><strong>æ¢³ç†</strong>Word Countçš„è®¡ç®—æ­¥éª¤</h2><p>åšäº†ä¸€ç•ªå‡†å¤‡ä¹‹åï¼Œæ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬å°±å¯ä»¥å¼€å§‹å†™ä»£ç äº†ã€‚ä¸è¿‡ï¼Œåœ¨â€œä¸‹æ‰‹â€ä¹‹å‰ï¼Œå’±ä»¬ä¸å¦¨ä¸€èµ·æ¢³ç†ä¸‹Word Countçš„è®¡ç®—æ­¥éª¤ï¼Œå…ˆåšåˆ°å¿ƒä¸­æœ‰æ•°ï¼Œç„¶åå†å’ä»£ç ä¹Ÿä¸è¿Ÿã€‚</p><p>ä¹‹å‰æˆ‘ä»¬æåˆ°ï¼ŒWord Countçš„åˆè¡·æ˜¯å¯¹æ–‡ä»¶ä¸­çš„å•è¯åšç»Ÿè®¡è®¡æ•°ï¼Œæ‰“å°å‡ºé¢‘æ¬¡æœ€é«˜çš„5ä¸ªè¯æ±‡ã€‚é‚£ä¹ˆWord Countçš„ç¬¬ä¸€æ­¥å°±å¾ˆæ˜æ˜¾äº†ï¼Œå½“ç„¶æ˜¯å¾—è¯»å–æ–‡ä»¶çš„å†…å®¹ï¼Œä¸ç„¶å’±ä»¬ç»Ÿè®¡ä»€ä¹ˆå‘¢ï¼Ÿ</p><p>æˆ‘ä»¬å‡†å¤‡å¥½çš„æ–‡ä»¶æ˜¯wikiOfSpark.txtï¼Œå®ƒä»¥çº¯æ–‡æœ¬çš„æ–¹å¼è®°å½•äº†å…³äºSparkçš„ç®€å•ä»‹ç»ï¼Œæˆ‘æ‘˜å–äº†å…¶ä¸­çš„éƒ¨åˆ†å†…å®¹ç»™ä½ çœ‹ä¸€ä¸‹ï¼š</p><p><img src=\"https://static001.geekbang.org/resource/image/8f/d3/8fa70d857b684ef85cd5fa92611651d3.png?wh=1292x394\" alt=\"\" title=\"wikiOfSpark.txtå†…å®¹æ‘˜è¦\"></p><p>æˆ‘ä»¬çŸ¥é“ï¼Œæ–‡ä»¶çš„è¯»å–å¾€å¾€æ˜¯ä»¥è¡Œï¼ˆLineï¼‰ä¸ºå•ä½çš„ã€‚ä¸éš¾å‘ç°ï¼ŒwikiOfSpark.txtçš„æ¯ä¸€è¡Œéƒ½åŒ…å«å¤šä¸ªå•è¯ã€‚</p><p>æˆ‘ä»¬è¦æ˜¯ä»¥â€œå•è¯â€ä½œä¸ºç²’åº¦åšè®¡æ•°ï¼Œå°±éœ€è¦å¯¹æ¯ä¸€è¡Œçš„æ–‡æœ¬åšåˆ†è¯ã€‚åˆ†è¯è¿‡åï¼Œæ–‡ä»¶ä¸­çš„æ¯ä¸€å¥è¯ï¼Œéƒ½è¢«æ‰“æ•£æˆäº†ä¸€ä¸ªä¸ªå•è¯ã€‚è¿™æ ·ä¸€æ¥ï¼Œæˆ‘ä»¬å°±å¯ä»¥æŒ‰ç…§å•è¯åšåˆ†ç»„è®¡æ•°äº†ã€‚è¿™å°±æ˜¯Word Countçš„è®¡ç®—è¿‡ç¨‹ï¼Œä¸»è¦åŒ…å«å¦‚ä¸‹3ä¸ªæ­¥éª¤ï¼š</p><ol>\n<li><strong>è¯»å–å†…å®¹</strong>ï¼šè°ƒç”¨Sparkæ–‡ä»¶è¯»å–APIï¼ŒåŠ è½½wikiOfSpark.txtæ–‡ä»¶å†…å®¹ï¼›</li>\n<li><strong>åˆ†è¯</strong>ï¼šä»¥è¡Œä¸ºå•ä½ï¼ŒæŠŠå¥å­æ‰“æ•£ä¸ºå•è¯ï¼›</li>\n<li><strong>åˆ†ç»„è®¡æ•°</strong>ï¼šæŒ‰ç…§å•è¯åšåˆ†ç»„è®¡æ•°ã€‚</li>\n</ol><p>æ˜ç¡®äº†è®¡ç®—æ­¥éª¤åï¼Œæ¥ä¸‹æ¥æˆ‘ä»¬å°±å¯ä»¥è°ƒç”¨Sparkå¼€å‘APIï¼Œå¯¹è¿™äº›æ­¥éª¤è¿›è¡Œä»£ç å®ç°ï¼Œä»è€Œå®ŒæˆWord Countçš„åº”ç”¨å¼€å‘ã€‚</p><p>ä¼—æ‰€å‘¨çŸ¥ï¼ŒSparkæ”¯æŒç§ç±»ä¸°å¯Œçš„å¼€å‘è¯­è¨€ï¼Œå¦‚Scalaã€Javaã€Pythonï¼Œç­‰ç­‰ã€‚ä½ å¯ä»¥ç»“åˆä¸ªäººåå¥½å’Œå¼€å‘ä¹ æƒ¯ï¼Œä»»æ„é€‰æ‹©å…¶ä¸­çš„ä¸€ç§è¿›è¡Œå¼€å‘ã€‚å°½ç®¡ä¸åŒè¯­è¨€çš„å¼€å‘APIåœ¨è¯­æ³•ä¸Šæœ‰ç€ç»†å¾®çš„å·®å¼‚ï¼Œä½†ä¸è®ºæ˜¯åŠŸèƒ½æ–¹é¢ã€è¿˜æ˜¯æ€§èƒ½æ–¹é¢ï¼ŒSparkå¯¹äºæ¯ä¸€ç§è¯­è¨€çš„æ”¯æŒéƒ½æ˜¯ä¸€è‡´çš„ã€‚æ¢å¥è¯è¯´ï¼ŒåŒæ ·æ˜¯Word Countï¼Œä½ ç”¨Scalaå®ç°ä¹Ÿè¡Œï¼Œç”¨Pythonå®ç°ä¹Ÿå¯ä»¥ï¼Œä¸¤ä»½ä»£ç çš„æ‰§è¡Œç»“æœæ˜¯ä¸€è‡´çš„ã€‚ä¸ä»…å¦‚æ­¤ï¼Œåœ¨åŒæ ·çš„è®¡ç®—èµ„æºä¸‹ï¼Œä¸¤ä»½ä»£ç çš„æ‰§è¡Œæ•ˆç‡ä¹Ÿæ˜¯ä¸€æ ·çš„ã€‚</p><p>å› æ­¤ï¼Œå°±Word Countè¿™ä¸ªç¤ºä¾‹æ¥è¯´ï¼Œå¼€å‘è¯­è¨€ä¸æ˜¯é‡ç‚¹ï¼Œæˆ‘ä»¬ä¸å¦¨é€‰æ‹©Scalaã€‚ä½ å¯èƒ½ä¼šè¯´ï¼šâ€œæˆ‘æœ¬æ¥å¯¹Sparkå°±ä¸ç†Ÿï¼Œæ›´æ²¡æœ‰æ¥è§¦è¿‡Scalaï¼Œä¸€ä¸Šæ¥å°±ç”¨Scalaæ¼”ç¤ºSparkåº”ç”¨ä»£ç ï¼Œç†è§£èµ·æ¥ä¼šä¸ä¼šå¾ˆå›°éš¾ï¼Ÿâ€</p><p>å…¶å®å¤§å¯ä¸å¿…æ‹…å¿ƒï¼ŒScalaè¯­æ³•æ¯”è¾ƒç®€æ´ï¼ŒWord Countçš„Scalaå®ç°ä¸è¶…è¿‡10è¡Œä»£ç ã€‚å†è€…ï¼Œå¯¹äºWord Countä¸­çš„æ¯ä¸€è¡ŒScalaä»£ç ï¼Œæˆ‘ä¼šå¸¦ç€ä½ æ‰‹æŠŠæ‰‹ã€é€è¡Œåœ°è¿›è¡Œè®²è§£å’Œåˆ†æã€‚æˆ‘ç›¸ä¿¡ï¼Œè·Ÿç€æˆ‘è¿‡å®Œä¸€éä»£ç ä¹‹åï¼Œä½ èƒ½å¾ˆå¿«åœ°æŠŠå®ƒâ€œç¿»è¯‘â€æˆä½ ç†Ÿæ‚‰çš„è¯­è¨€ï¼Œæ¯”å¦‚Javaæˆ–Pythonã€‚å¦å¤–ï¼Œç»å¤§å¤šæ•°çš„Spark æºç éƒ½æ˜¯ç”± Scala å®ç°çš„ï¼Œæ¥è§¦å¹¶äº†è§£ä¸€äº›Scalaçš„åŸºæœ¬è¯­æ³•ï¼Œæœ‰åˆ©äºä½ åç»­é˜…è¯»ã€å­¦ä¹ Sparkæºä»£ç ã€‚</p><h2>Word Countä»£ç å®ç°</h2><p>é€‰å®šäº†è¯­è¨€ï¼Œæ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬å°±æŒ‰ç…§è¯»å–å†…å®¹ã€åˆ†è¯ã€åˆ†ç»„è®¡æ•°è¿™ä¸‰æ­¥æ¥çœ‹çœ‹Word Countå…·ä½“æ€ä¹ˆå®ç°ã€‚</p><h3>ç¬¬ä¸€æ­¥ï¼Œè¯»å–å†…å®¹</h3><p>é¦–å…ˆï¼Œæˆ‘ä»¬è°ƒç”¨SparkContextçš„textFileæ–¹æ³•ï¼Œè¯»å–æºæ–‡ä»¶ï¼Œä¹Ÿå°±æ˜¯wikiOfSpark.txtï¼Œä»£ç å¦‚ä¸‹è¡¨æ‰€ç¤ºï¼š</p><pre><code class=\"language-scala\">import org.apache.spark.rdd.RDD\n \n// è¿™é‡Œçš„ä¸‹åˆ’çº¿\"_\"æ˜¯å ä½ç¬¦ï¼Œä»£è¡¨æ•°æ®æ–‡ä»¶çš„æ ¹ç›®å½•\nval rootPath: String = _\nval file: String = s\"${rootPath}/wikiOfSpark.txt\"\n \n// è¯»å–æ–‡ä»¶å†…å®¹\nval lineRDD: RDD[String] = spark.sparkContext.textFile(file) \n</code></pre><p>åœ¨è¿™æ®µä»£ç ä¸­ï¼Œä½ å¯èƒ½ä¼šå‘ç°3ä¸ªæ–°æ¦‚å¿µï¼Œåˆ†åˆ«æ˜¯sparkã€sparkContextå’ŒRDDã€‚</p><p>å…¶ä¸­ï¼Œsparkå’ŒsparkContextåˆ†åˆ«æ˜¯ä¸¤ç§ä¸åŒçš„å¼€å‘å…¥å£å®ä¾‹ï¼š</p><ul>\n<li>sparkæ˜¯å¼€å‘å…¥å£SparkSessionå®ä¾‹ï¼ˆInstanceï¼‰ï¼ŒSparkSessionåœ¨spark-shellä¸­ä¼šç”±ç³»ç»Ÿè‡ªåŠ¨åˆ›å»ºï¼›</li>\n<li>sparkContextæ˜¯å¼€å‘å…¥å£SparkContextå®ä¾‹ã€‚</li>\n</ul><p>åœ¨Sparkç‰ˆæœ¬æ¼”è¿›çš„è¿‡ç¨‹ä¸­ï¼Œä»2.0ç‰ˆæœ¬å¼€å§‹ï¼ŒSparkSessionå–ä»£äº†SparkContextï¼Œæˆä¸ºç»Ÿä¸€çš„å¼€å‘å…¥å£ã€‚æ¢å¥è¯è¯´ï¼Œè¦å¼€å‘Sparkåº”ç”¨ï¼Œä½ å¿…é¡»å…ˆåˆ›å»ºSparkSessionã€‚å…³äºSparkSessionå’ŒSparkContextï¼Œæˆ‘ä¼šåœ¨åç»­çš„è¯¾ç¨‹åšæ›´è¯¦ç»†çš„ä»‹ç»ï¼Œè¿™é‡Œä½ åªè¦è®°ä½å®ƒä»¬æ˜¯å¿…éœ€çš„å¼€å‘å…¥å£å°±å¯ä»¥äº†ã€‚</p><p>æˆ‘ä»¬å†æ¥çœ‹çœ‹RDDï¼ŒRDDçš„å…¨ç§°æ˜¯Resilient Distributed Datasetï¼Œæ„æ€æ˜¯â€œå¼¹æ€§åˆ†å¸ƒå¼æ•°æ®é›†â€ã€‚RDDæ˜¯Sparkå¯¹äºåˆ†å¸ƒå¼æ•°æ®çš„ç»Ÿä¸€æŠ½è±¡ï¼Œå®ƒå®šä¹‰äº†ä¸€ç³»åˆ—åˆ†å¸ƒå¼æ•°æ®çš„åŸºæœ¬å±æ€§ä¸å¤„ç†æ–¹æ³•ã€‚å…³äºRDDçš„å®šä¹‰ã€å†…æ¶µä¸ä½œç”¨ï¼Œæˆ‘ä»¬ç•™åˆ°<a href=\"https://time.geekbang.org/column/article/417164\">ä¸‹ä¸€è®²</a>å†å»å±•å¼€ã€‚</p><p>åœ¨è¿™é‡Œï¼Œä½ ä¸å¦¨å…ˆç®€å•åœ°æŠŠRDDç†è§£æˆâ€œæ•°ç»„â€ï¼Œæ¯”å¦‚ä»£ç ä¸­çš„lineRDDå˜é‡ï¼Œå®ƒçš„ç±»å‹æ˜¯RDD[String]ï¼Œä½ å¯ä»¥æš‚æ—¶æŠŠå®ƒå½“æˆå…ƒç´ ç±»å‹æ˜¯Stringçš„æ•°ç»„ï¼Œæ•°ç»„çš„æ¯ä¸ªå…ƒç´ éƒ½æ˜¯æ–‡ä»¶ä¸­çš„ä¸€è¡Œå­—ç¬¦ä¸²ã€‚</p><p>è·å–åˆ°æ–‡ä»¶å†…å®¹ä¹‹åï¼Œä¸‹ä¸€æ­¥æˆ‘ä»¬å°±è¦åšåˆ†è¯äº†ã€‚</p><h3>ç¬¬äºŒæ­¥ï¼Œåˆ†è¯</h3><p>â€œåˆ†è¯â€å°±æ˜¯æŠŠâ€œæ•°ç»„â€çš„è¡Œå…ƒç´ æ‰“æ•£ä¸ºå•è¯ã€‚è¦å®ç°è¿™ä¸€ç‚¹ï¼Œæˆ‘ä»¬å¯ä»¥è°ƒç”¨RDDçš„flatMapæ–¹æ³•æ¥å®Œæˆã€‚flatMapæ“ä½œåœ¨é€»è¾‘ä¸Šå¯ä»¥åˆ†æˆä¸¤ä¸ªæ­¥éª¤ï¼š<strong>æ˜ å°„</strong>å’Œ<strong>å±•å¹³</strong>ã€‚</p><p>è¿™ä¸¤ä¸ªæ­¥éª¤æ˜¯ä»€ä¹ˆæ„æ€å‘¢ï¼Ÿæˆ‘ä»¬è¿˜æ˜¯ç»“åˆWord Countçš„ä¾‹å­æ¥çœ‹ï¼š</p><pre><code class=\"language-scala\">// ä»¥è¡Œä¸ºå•ä½åšåˆ†è¯\nval wordRDD: RDD[String] = lineRDD.flatMap(line =&gt; line.split(\" \"))&nbsp;\n</code></pre><p>è¦æŠŠlineRDDçš„è¡Œå…ƒç´ è½¬æ¢ä¸ºå•è¯ï¼Œæˆ‘ä»¬å¾—å…ˆç”¨åˆ†éš”ç¬¦å¯¹æ¯ä¸ªè¡Œå…ƒç´ è¿›è¡Œåˆ†å‰²ï¼ˆSplitï¼‰ï¼Œå’±ä»¬è¿™é‡Œçš„åˆ†éš”ç¬¦æ˜¯ç©ºæ ¼ã€‚</p><p>åˆ†å‰²ä¹‹åï¼Œæ¯ä¸ªè¡Œå…ƒç´ å°±éƒ½å˜æˆäº†å•è¯æ•°ç»„ï¼Œå…ƒç´ ç±»å‹ä¹Ÿä»Stringå˜æˆäº†Array[String]ï¼Œåƒè¿™æ ·ä»¥å…ƒç´ ä¸ºå•ä½è¿›è¡Œè½¬æ¢çš„æ“ä½œï¼Œç»Ÿä¸€ç§°ä½œâ€œ<strong>æ˜ å°„</strong>â€ã€‚</p><p>æ˜ å°„è¿‡åï¼ŒRDDç±»å‹ç”±åŸæ¥çš„RDD[String]å˜ä¸ºRDD[Array[String]]ã€‚å¦‚æœæŠŠRDD[String]çœ‹æˆæ˜¯â€œæ•°ç»„â€çš„è¯ï¼Œé‚£ä¹ˆRDD[Array[String]]å°±æ˜¯ä¸€ä¸ªâ€œäºŒç»´æ•°ç»„â€ï¼Œå®ƒçš„æ¯ä¸€ä¸ªå…ƒç´ éƒ½æ˜¯å•è¯ã€‚</p><p><img src=\"https://static001.geekbang.org/resource/image/1e/2a/1e364df2yy57857efafc1023c102942a.jpg?wh=2284x758\" alt=\"\" title=\"ä»¥è¡Œä¸ºå•ä½åšåˆ†è¯\"></p><p>ä¸ºäº†åç»­å¯¹å•è¯åšåˆ†ç»„ï¼Œæˆ‘ä»¬è¿˜éœ€è¦å¯¹è¿™ä¸ªâ€œäºŒç»´æ•°ç»„â€åš<strong>å±•å¹³</strong>ï¼Œä¹Ÿå°±æ˜¯å»æ‰å†…å±‚çš„åµŒå¥—ç»“æ„ï¼ŒæŠŠâ€œäºŒç»´æ•°ç»„â€è¿˜åŸæˆâ€œä¸€ç»´æ•°ç»„â€ï¼Œå¦‚ä¸‹å›¾æ‰€ç¤ºã€‚</p><p><img src=\"https://static001.geekbang.org/resource/image/b5/34/b51c79dfeeb393456f2392011688c934.jpg?wh=2284x643\" alt=\"\" title=\"åˆ†è¯ååšå±•å¹³\"></p><p>å°±è¿™æ ·ï¼Œåœ¨flatMapç®—å­çš„ä½œç”¨ä¸‹ï¼ŒåŸæ¥ä»¥è¡Œä¸ºå…ƒç´ çš„lineRDDï¼Œè½¬æ¢æˆäº†ä»¥å•è¯ä¸ºå…ƒç´ çš„wordRDDã€‚</p><p>ä¸è¿‡ï¼Œå€¼å¾—æ³¨æ„çš„æ˜¯ï¼Œæˆ‘ä»¬ç”¨â€œç©ºæ ¼â€å»åˆ†å‰²å¥å­ï¼Œæœ‰å¯èƒ½ä¼šäº§ç”Ÿç©ºå­—ç¬¦ä¸²ã€‚æ‰€ä»¥ï¼Œåœ¨å®Œæˆâ€œæ˜ å°„â€å’Œâ€œå±•å¹³â€ä¹‹åï¼Œå¯¹äºè¿™æ ·çš„â€œå•è¯â€ï¼Œæˆ‘ä»¬è¦æŠŠå…¶ä¸­çš„ç©ºå­—ç¬¦ä¸²éƒ½è¿‡æ»¤æ‰ï¼Œè¿™é‡Œæˆ‘ä»¬è°ƒç”¨RDDçš„filteræ–¹æ³•æ¥è¿‡æ»¤ï¼š</p><pre><code class=\"language-scala\">// è¿‡æ»¤æ‰ç©ºå­—ç¬¦ä¸²\nval cleanWordRDD: RDD[String] = wordRDD.filter(word =&gt; !word.equals(\"\"))\n</code></pre><p>è¿™æ ·ä¸€æ¥ï¼Œæˆ‘ä»¬åœ¨åˆ†è¯é˜¶æ®µå°±å¾—åˆ°äº†è¿‡æ»¤æ‰ç©ºå­—ç¬¦ä¸²ä¹‹åçš„å•è¯â€œæ•°ç»„â€ï¼Œç±»å‹æ˜¯RDD[String]ã€‚æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬å°±å¯ä»¥å‡†å¤‡åšåˆ†ç»„è®¡æ•°äº†ã€‚</p><h3>ç¬¬ä¸‰æ­¥ï¼Œåˆ†ç»„è®¡æ•°</h3><p>åœ¨RDDçš„å¼€å‘æ¡†æ¶ä¸‹ï¼Œèšåˆç±»æ“ä½œï¼Œå¦‚è®¡æ•°ã€æ±‚å’Œã€æ±‚å‡å€¼ï¼Œéœ€è¦ä¾èµ–<strong>é”®å€¼å¯¹</strong>ï¼ˆKey Value Pairï¼‰ç±»å‹çš„æ•°æ®å…ƒç´ ï¼Œä¹Ÿå°±æ˜¯ï¼ˆKeyï¼ŒValueï¼‰å½¢å¼çš„â€œæ•°ç»„â€å…ƒç´ ã€‚</p><p>å› æ­¤ï¼Œåœ¨è°ƒç”¨èšåˆç®—å­åšåˆ†ç»„è®¡æ•°ä¹‹å‰ï¼Œæˆ‘ä»¬è¦å…ˆæŠŠRDDå…ƒç´ è½¬æ¢ä¸ºï¼ˆKeyï¼ŒValueï¼‰çš„å½¢å¼ï¼Œä¹Ÿå°±æ˜¯æŠŠRDD[String]æ˜ å°„æˆRDD[(String, Int)]ã€‚</p><p>å…¶ä¸­ï¼Œæˆ‘ä»¬ç»Ÿä¸€æŠŠæ‰€æœ‰çš„Valueç½®ä¸º1ã€‚è¿™æ ·ä¸€æ¥ï¼Œå¯¹äºåŒä¸€ä¸ªçš„å•è¯ï¼Œåœ¨åç»­çš„è®¡æ•°è¿ç®—ä¸­ï¼Œæˆ‘ä»¬åªè¦å¯¹Valueåšç´¯åŠ å³å¯ï¼Œå°±åƒè¿™æ ·ï¼š</p><p><img src=\"https://static001.geekbang.org/resource/image/9c/ac/9c4c96fe9a9f48f0cb7e2e1f3374f5ac.jpg?wh=2284x866\" alt=\"\" title=\"æŠŠå…ƒç´ è½¬æ¢ä¸ºï¼ˆKeyï¼ŒValueï¼‰å½¢å¼\"></p><p>ä¸‹é¢æ˜¯å¯¹åº”çš„ä»£ç ï¼š</p><pre><code class=\"language-scala\">// æŠŠRDDå…ƒç´ è½¬æ¢ä¸ºï¼ˆKeyï¼ŒValueï¼‰çš„å½¢å¼\nval kvRDD: RDD[(String, Int)] = cleanWordRDD.map(word =&gt; (word, 1))&nbsp;\n</code></pre><p>è¿™æ ·ä¸€æ¥ï¼ŒRDDå°±ç”±åŸæ¥å­˜å‚¨Stringå…ƒç´ çš„cleanWordRDDï¼Œè½¬æ¢ä¸ºäº†å­˜å‚¨ï¼ˆStringï¼ŒIntï¼‰çš„kvRDDã€‚</p><p>å®Œæˆäº†å½¢å¼çš„è½¬æ¢ä¹‹åï¼Œæˆ‘ä»¬å°±è¯¥æ­£å¼åšåˆ†ç»„è®¡æ•°äº†ã€‚åˆ†ç»„è®¡æ•°å…¶å®æ˜¯ä¸¤ä¸ªæ­¥éª¤ï¼Œä¹Ÿå°±æ˜¯å…ˆâ€œåˆ†ç»„â€ï¼Œå†â€œè®¡æ•°â€ã€‚ä¸‹é¢ï¼Œæˆ‘ä»¬ä½¿ç”¨èšåˆç®—å­reduceByKeyæ¥åŒæ—¶å®Œæˆåˆ†ç»„å’Œè®¡æ•°è¿™ä¸¤ä¸ªæ“ä½œã€‚</p><p>å¯¹äºkvRDDè¿™ä¸ªé”®å€¼å¯¹â€œæ•°ç»„â€ï¼ŒreduceByKeyå…ˆæ˜¯æŒ‰ç…§Keyï¼ˆä¹Ÿå°±æ˜¯å•è¯ï¼‰æ¥åšåˆ†ç»„ï¼Œåˆ†ç»„ä¹‹åï¼Œæ¯ä¸ªå•è¯éƒ½æœ‰ä¸€ä¸ªä¸ä¹‹å¯¹åº”çš„Valueåˆ—è¡¨ã€‚ç„¶åæ ¹æ®ç”¨æˆ·æä¾›çš„èšåˆå‡½æ•°ï¼Œå¯¹åŒä¸€ä¸ªKeyçš„æ‰€æœ‰Valueåšreduceè¿ç®—ã€‚</p><p>è¿™é‡Œçš„reduceï¼Œä½ å¯ä»¥ç†è§£æˆæ˜¯ä¸€ç§è®¡ç®—æ­¥éª¤æˆ–æ˜¯ä¸€ç§è®¡ç®—æ–¹æ³•ã€‚å½“æˆ‘ä»¬ç»™å®šèšåˆå‡½æ•°åï¼Œå®ƒä¼šç”¨æŠ˜å çš„æ–¹å¼ï¼ŒæŠŠåŒ…å«å¤šä¸ªå…ƒç´ çš„åˆ—è¡¨è½¬æ¢ä¸ºå•ä¸ªå…ƒç´ å€¼ï¼Œä»è€Œç»Ÿè®¡å‡ºä¸åŒå…ƒç´ çš„æ•°é‡ã€‚</p><p>åœ¨Word Countçš„ç¤ºä¾‹ä¸­ï¼Œæˆ‘ä»¬è°ƒç”¨reduceByKeyå®ç°åˆ†ç»„è®¡ç®—çš„ä»£ç å¦‚ä¸‹ï¼š</p><pre><code class=\"language-scala\">// æŒ‰ç…§å•è¯åšåˆ†ç»„è®¡æ•°\nval wordCounts: RDD[(String, Int)] = kvRDD.reduceByKey((x, y) =&gt; x + y)&nbsp;\n</code></pre><p>å¯ä»¥çœ‹åˆ°ï¼Œæˆ‘ä»¬ä¼ é€’ç»™reduceByKeyç®—å­çš„èšåˆå‡½æ•°æ˜¯(x, y) =&gt; x + yï¼Œä¹Ÿå°±æ˜¯ç´¯åŠ å‡½æ•°ã€‚å› æ­¤ï¼Œåœ¨æ¯ä¸ªå•è¯åˆ†ç»„ä¹‹åï¼Œreduceä¼šä½¿ç”¨ç´¯åŠ å‡½æ•°ï¼Œä¾æ¬¡æŠ˜å è®¡ç®—Valueåˆ—è¡¨ä¸­çš„æ‰€æœ‰å…ƒç´ ï¼Œæœ€ç»ˆæŠŠå…ƒç´ åˆ—è¡¨è½¬æ¢ä¸ºå•è¯çš„é¢‘æ¬¡ã€‚å¯¹äºä»»æ„ä¸€ä¸ªå•è¯æ¥è¯´ï¼Œreduceçš„è®¡ç®—è¿‡ç¨‹éƒ½æ˜¯ä¸€æ ·çš„ï¼Œå¦‚ä¸‹å›¾æ‰€ç¤ºã€‚</p><p><img src=\"https://static001.geekbang.org/resource/image/c1/c4/c1b5022a6c8d62226ba53af3dd90b2c4.jpg?wh=2284x747\" alt=\"\" title=\"reduceæ“ä½œç¤ºæ„å›¾\"></p><p>reduceByKeyå®Œæˆè®¡ç®—ä¹‹åï¼Œæˆ‘ä»¬å¾—åˆ°çš„ä¾ç„¶æ˜¯ç±»å‹ä¸ºRDD[(String, Int)]çš„RDDã€‚ä¸è¿‡ï¼Œä¸kvRDDä¸åŒï¼ŒwordCountså…ƒç´ çš„Valueå€¼ï¼Œè®°å½•çš„æ˜¯æ¯ä¸ªå•è¯çš„ç»Ÿè®¡è¯é¢‘ã€‚åˆ°æ­¤ä¸ºæ­¢ï¼Œæˆ‘ä»¬å°±å®Œæˆäº†Word Countä¸»é€»è¾‘çš„å¼€å‘ä¸å®ç°ã€‚</p><p><img src=\"https://static001.geekbang.org/resource/image/79/33/7948a3d9c923791e139397988fcc6433.jpg?wh=2284x791\" alt=\"\" title=\"reduceByKeyè½¬æ¢ç¤ºæ„å›¾\"></p><p>åœ¨ç¨‹åºçš„æœ€åï¼Œæˆ‘ä»¬è¿˜è¦æŠŠwordCountsæŒ‰ç…§è¯é¢‘åšæ’åºï¼Œå¹¶æŠŠè¯é¢‘æœ€é«˜çš„5ä¸ªå•è¯æ‰“å°åˆ°å±å¹•ä¸Šï¼Œä»£ç å¦‚ä¸‹æ‰€ç¤ºã€‚</p><pre><code class=\"language-scala\">// æ‰“å°è¯é¢‘æœ€é«˜çš„5ä¸ªè¯æ±‡\nwordCounts.map{case (k, v) =&gt; (v, k)}.sortByKey(false).take(5)\n</code></pre><h3><strong>ä»£ç æ‰§è¡Œ</strong></h3><p>åº”ç”¨å¼€å‘å®Œæˆä¹‹åï¼Œæˆ‘ä»¬å°±å¯ä»¥æŠŠä»£ç ä¸¢è¿›å·²ç»å‡†å¤‡å¥½çš„æœ¬åœ°Sparkéƒ¨ç½²ç¯å¢ƒé‡Œå•¦ã€‚é¦–å…ˆï¼Œæˆ‘ä»¬æ‰“å¼€å‘½ä»¤è¡Œç»ˆç«¯ï¼ˆTerminalï¼‰ï¼Œæ•²å…¥â€œspark-shellâ€ï¼Œæ‰“å¼€äº¤äº’å¼è¿è¡Œç¯å¢ƒï¼Œå¦‚ä¸‹å›¾æ‰€ç¤ºã€‚</p><p><img src=\"https://static001.geekbang.org/resource/image/65/4d/65257daf7030ca80c3da9c615edb654d.jpg?wh=1790x978\" alt=\"\" title=\"spark-shellå¯åŠ¨ç•Œé¢\"></p><p>ç„¶åï¼ŒæŠŠæˆ‘ä»¬å¼€å‘å¥½çš„ä»£ç ï¼Œä¾æ¬¡æ•²å…¥spark-shellã€‚ä¸ºäº†æ–¹ä¾¿ä½ æ“ä½œï¼Œæˆ‘æŠŠå®Œæ•´çš„ä»£ç å®ç°æ•´ç†åˆ°ä¸‹é¢äº†ï¼š</p><pre><code class=\"language-scala\">import org.apache.spark.rdd.RDD\n \n// è¿™é‡Œçš„ä¸‹åˆ’çº¿\"_\"æ˜¯å ä½ç¬¦ï¼Œä»£è¡¨æ•°æ®æ–‡ä»¶çš„æ ¹ç›®å½•\nval rootPath: String = _\nval file: String = s\"${rootPath}/wikiOfSpark.txt\"\n \n// è¯»å–æ–‡ä»¶å†…å®¹\nval lineRDD: RDD[String] = spark.sparkContext.textFile(file)\n \n// ä»¥è¡Œä¸ºå•ä½åšåˆ†è¯\nval wordRDD: RDD[String] = lineRDD.flatMap(line =&gt; line.split(\" \"))\nval cleanWordRDD: RDD[String] = wordRDD.filter(word =&gt; !word.equals(\"\"))\n \n// æŠŠRDDå…ƒç´ è½¬æ¢ä¸ºï¼ˆKeyï¼ŒValueï¼‰çš„å½¢å¼\nval kvRDD: RDD[(String, Int)] = cleanWordRDD.map(word =&gt; (word, 1))\n// æŒ‰ç…§å•è¯åšåˆ†ç»„è®¡æ•°\nval wordCounts: RDD[(String, Int)] = kvRDD.reduceByKey((x, y) =&gt; x + y)\n \n// æ‰“å°è¯é¢‘æœ€é«˜çš„5ä¸ªè¯æ±‡\nwordCounts.map{case (k, v) =&gt; (v, k)}.sortByKey(false).take(5)\n</code></pre><p>æˆ‘ä»¬æŠŠä¸Šé¢çš„ä»£ç ä¾æ¬¡æ•²å…¥åˆ°spark-shellä¹‹åï¼Œspark-shellæœ€ç»ˆä¼šæŠŠè¯é¢‘æœ€é«˜çš„5ä¸ªå•è¯æ‰“å°åˆ°å±å¹•ä¸Šï¼š</p><p><img src=\"https://static001.geekbang.org/resource/image/6a/f4/6acf199e126b205c92c2ec03ffba33f4.png?wh=1524x84\" alt=\"\" title=\"æ‰“å°è¯é¢‘æœ€é«˜çš„5ä¸ªè¯æ±‡\"></p><p>åœ¨Wikipediaçš„Sparkä»‹ç»æ–‡æœ¬ä¸­ï¼Œè¯é¢‘æœ€é«˜çš„å•è¯åˆ†åˆ«æ˜¯theã€Sparkã€aã€andå’Œofï¼Œé™¤äº†â€œSparkâ€ä¹‹å¤–ï¼Œå…¶ä»–4ä¸ªå•è¯éƒ½æ˜¯å¸¸ç”¨çš„åœç”¨è¯ï¼ˆStop Wordï¼‰ï¼Œå› æ­¤å®ƒä»¬å‡ ä¸ªé«˜å±…æ¦œé¦–ä¹Ÿå°±ä¸è¶³ä¸ºæ€ªäº†ã€‚</p><p>å¥½å•¦ï¼Œåˆ°æ­¤ä¸ºæ­¢ï¼Œæˆ‘ä»¬åœ¨Sparkä¹‹ä¸Šï¼Œå®Œæˆäº†â€œå¤§æ•°æ®é¢†åŸŸHello Worldâ€çš„å¼€å‘ä¸å®ç°ï¼Œæ­å–œä½ è·¨å…¥å¤§æ•°æ®å¼€å‘çš„å¤§é—¨ï¼</p><h2>é‡ç‚¹å›é¡¾</h2><p>ä»Šå¤©è¿™ä¸€è®²ï¼Œæˆ‘ä»¬å›´ç»•ç€Word Countï¼Œåˆæ­¥æ¢ç´¢å¹¶ä½“éªŒäº†Sparkåº”ç”¨å¼€å‘ã€‚ä½ é¦–å…ˆéœ€è¦æŒæ¡çš„æ˜¯Sparkçš„æœ¬åœ°éƒ¨ç½²ï¼Œä»è€Œå¯ä»¥é€šè¿‡spark-shellæ¥è¿…é€Ÿç†Ÿæ‚‰Sparkï¼Œè·å¾—å¯¹Sparkçš„â€œç¬¬ä¸€å°è±¡â€ã€‚è¦åœ¨æœ¬åœ°éƒ¨ç½²Sparkï¼Œä½ éœ€è¦éµå¾ª3ä¸ªæ­¥éª¤ï¼š</p><ul>\n<li>ä»<a href=\"http://spark.apache.org/downloads.html\">Sparkå®˜ç½‘</a>ä¸‹è½½å®‰è£…åŒ…ï¼Œé€‰æ‹©æœ€æ–°çš„é¢„ç¼–è¯‘ç‰ˆæœ¬å³å¯ï¼›</li>\n<li>è§£å‹Sparkå®‰è£…åŒ…åˆ°ä»»æ„æœ¬åœ°ç›®å½•ï¼›</li>\n<li>å°†â€œ${è§£å‹ç›®å½•}/binâ€é…ç½®åˆ°PATHç¯å¢ƒå˜é‡ã€‚</li>\n</ul><p>ç„¶åï¼Œæˆ‘ä»¬ä¸€èµ·åˆ†æå¹¶å®ç°äº†å…¥é—¨Sparkçš„ç¬¬ä¸€ä¸ªåº”ç”¨ç¨‹åºï¼šWord Countã€‚åœ¨æˆ‘ä»¬çš„ä¾‹å­ä¸­ï¼ŒWord Countè¦å®Œæˆçš„è®¡ç®—ä»»åŠ¡ï¼Œæ˜¯å…ˆå¯¹æ–‡ä»¶ä¸­çš„å•è¯åšç»Ÿè®¡è®¡æ•°ï¼Œç„¶åå†æ‰“å°å‡ºé¢‘æ¬¡æœ€é«˜çš„5ä¸ªå•è¯ã€‚å®ƒçš„å®ç°è¿‡ç¨‹åˆ†ä¸º3ä¸ªæ­¥éª¤ï¼š</p><ul>\n<li>è¯»å–å†…å®¹ï¼šè°ƒç”¨Sparkæ–‡ä»¶è¯»å–APIï¼ŒåŠ è½½wikiOfSpark.txtæ–‡ä»¶å†…å®¹ï¼›</li>\n<li>åˆ†è¯ï¼šä»¥è¡Œä¸ºå•ä½ï¼ŒæŠŠå¥å­æ‰“æ•£ä¸ºå•è¯ï¼›</li>\n<li>åˆ†ç»„è®¡æ•°ï¼šæŒ‰ç…§å•è¯åšåˆ†ç»„è®¡æ•°ã€‚</li>\n</ul><p>ä¹Ÿè®¸ä½ å¯¹RDD APIè¿˜ä¸ç†Ÿæ‚‰ï¼Œç”šè‡³ä»æœªæ¥è§¦è¿‡Scalaï¼Œä¸è¿‡æ²¡å…³ç³»ï¼Œå®Œæˆäº†è¿™æ¬¡â€œå¤§æ•°æ®çš„Hello Worldâ€å¼€å‘ä¹‹æ—…ï¼Œä½ å°±å·²ç»è¸ä¸Šäº†æ–°çš„å¾ç¨‹ã€‚åœ¨æ¥ä¸‹æ¥çš„è¯¾ç¨‹é‡Œï¼Œè®©æˆ‘ä»¬æºæ‰‹å¹¶è‚©ï¼Œåƒæ¢ç´¢æ–°å¤§é™†ä¸€æ ·ï¼Œä¸€å±‚ä¸€å±‚åœ°å‰¥å¼€Sparkçš„ç¥ç§˜é¢çº±ï¼ŒåŠ æ²¹ï¼</p><h2>æ¯è¯¾ä¸€ç»ƒ</h2><p>åœ¨Word Countçš„ä»£ç å®ç°ä¸­ï¼Œæˆ‘ä»¬ç”¨åˆ°äº†å¤šç§å¤šæ ·çš„RDDç®—å­ï¼Œå¦‚mapã€filterã€flatMapå’ŒreduceByKeyï¼Œé™¤äº†è¿™äº›ç®—å­ä»¥å¤–ï¼Œä½ çŸ¥é“è¿˜æœ‰å“ªäº›å¸¸ç”¨çš„RDDç®—å­å—ï¼Ÿï¼ˆæç¤ºï¼Œå¯ä»¥ç»“åˆ<a href=\"https://spark.apache.org/docs/latest/rdd-programming-guide.html#transformations\">å®˜ç½‘</a>å»æŸ¥æ‰¾ï¼‰ã€‚</p><p>å¦å¤–ï¼Œä½ èƒ½è¯´è¯´ï¼Œä»¥ä¸Šè¿™äº›ç®—å­éƒ½æœ‰å“ªäº›å…±æ€§æˆ–æ˜¯å…±åŒç‚¹å—ï¼Ÿ</p><p>æ¬¢è¿ä½ æŠŠç­”æ¡ˆåˆ†äº«åˆ°è¯„è®ºåŒºï¼Œæˆ‘åœ¨è¯„è®ºåŒºç­‰ä½ ã€‚</p><p>å¦‚æœè¿™ä¸€è®²å¯¹ä½ æœ‰å¸®åŠ©ï¼Œä¹Ÿæ¬¢è¿ä½ åˆ†äº«ç»™è‡ªå·±çš„æœ‹å‹ï¼Œæˆ‘ä»¬ä¸‹ä¸€è®²å†è§ï¼</p>","neighbors":{"left":{"article_title":"å¼€ç¯‡è¯ | å…¥é—¨Sparkï¼Œä½ éœ€è¦å­¦ä¼šâ€œä¸‰æ­¥èµ°â€","id":415208},"right":{"article_title":"02 | RDDä¸ç¼–ç¨‹æ¨¡å‹ï¼šå»¶è¿Ÿè®¡ç®—æ˜¯æ€ä¹ˆå›äº‹ï¼Ÿ","id":417164}},"comments":[{"had_liked":false,"id":312944,"user_name":"Alvin-L","can_delete":false,"product_type":"c1","uid":1603052,"ip_address":"","ucode":"5AC96AAB75B720","user_header":"https://static001.geekbang.org/account/avatar/00/18/75/ec/c60b29f5.jpg","comment_is_top":true,"comment_ctime":1632133863,"is_pvip":false,"replies":[{"id":"113453","content":"èµğŸ‘ï¼ŒPerfectï¼<br><br>å¯ä»¥ä½œä¸ºPythonæ ‡æ†ä»£ç ï¼Œä¾›åç»­åŒå­¦å‚è€ƒ~","user_name":"ä½œè€…å›å¤","user_name_real":"å´ç£Š","uid":"1043100","ctime":1632327030,"ip_address":"","comment_id":312944,"utype":1}],"discussion_count":5,"race_medal":0,"score":"9.2233720986165002e+18","product_id":100090001,"comment_content":"åœ¨Pythonä¸­è¿è¡Œ:<br>``` <br>from pyspark import SparkContext<br><br>textFile = SparkContext().textFile(&quot;.&#47;wikiOfSpark.txt&quot;)<br>wordCount = (<br>    textFile.flatMap(lambda line: line.split(&quot; &quot;))<br>    .filter(lambda word: word != &quot;&quot;)<br>    .map(lambda word: (word, 1))<br>    .reduceByKey(lambda x, y: x + y)<br>    .sortBy(lambda x: x[1], False)<br>    .take(5)<br>)<br>print(wordCount)<br>#æ˜¾ç¤º: [(&#39;the&#39;, 67), (&#39;Spark&#39;, 63), (&#39;a&#39;, 54), (&#39;and&#39;, 51), (&#39;of&#39;, 50)]<br>``` <br>","like_count":14,"discussions":[{"author":{"id":1043100,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/ea/9c/230061e7.jpg","nickname":"å´ç£Š","note":"","ucode":"136DC8CF1B10DC","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":527174,"discussion_content":"èµğŸ‘ï¼ŒPerfectï¼\n\nå¯ä»¥ä½œä¸ºPythonæ ‡æ†ä»£ç ï¼Œä¾›åç»­åŒå­¦å‚è€ƒ~","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1632327030,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1408343,"avatar":"https://static001.geekbang.org/account/avatar/00/15/7d/57/c94b6a93.jpg","nickname":"ç‹ç’€ç’¨","note":"","ucode":"9873E12D503CB4","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":398632,"discussion_content":"ä½¿ç”¨è¿™ä¸ªä»£ç æŠ¥é”™:py4j.protocol.Py4JJavaError: An error occurred while calling z:org.apache.spark.api.python.PythonRDD.collectAndServe.  è¯·é—®ä¸€ä¸‹æœ‰è°çŸ¥é“æ˜¯ä»€ä¹ˆåŸå› å—ï¼Œæˆ‘æ‰¾äº†å¥½å¤šç§åŠæ³•éƒ½æ²¡è§£å†³","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1632823461,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":3,"child_discussions":[{"author":{"id":1043100,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/ea/9c/230061e7.jpg","nickname":"å´ç£Š","note":"","ucode":"136DC8CF1B10DC","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":1408343,"avatar":"https://static001.geekbang.org/account/avatar/00/15/7d/57/c94b6a93.jpg","nickname":"ç‹ç’€ç’¨","note":"","ucode":"9873E12D503CB4","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":399135,"discussion_content":"å¯ä»¥è¯•è¯•è¿™é‡Œçš„æ–¹æ³•ï¼š\n\nhttps://stackoverflow.com/questions/50064646/py4j-protocol-py4jjavaerror-occurred-while-calling-zorg-apache-spark-api-python","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1632910351,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":398632,"ip_address":""},"score":399135,"extra":""},{"author":{"id":1408343,"avatar":"https://static001.geekbang.org/account/avatar/00/15/7d/57/c94b6a93.jpg","nickname":"ç‹ç’€ç’¨","note":"","ucode":"9873E12D503CB4","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":1043100,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/ea/9c/230061e7.jpg","nickname":"å´ç£Š","note":"","ucode":"136DC8CF1B10DC","race_medal":0,"user_type":2,"is_pvip":false},"discussion":{"id":399404,"discussion_content":"è¿™é‡Œé¢çš„æ–¹å¼éƒ½è¯•äº†ï¼Œè¿˜æ˜¯æ²¡æœ‰ç”¨ã€‚ä¼šæ˜¯å› ä¸ºæ˜¯windowsç¯å¢ƒæŠ¥é”™çš„åŸå› å—","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1632964058,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":399135,"ip_address":""},"score":399404,"extra":""},{"author":{"id":1408343,"avatar":"https://static001.geekbang.org/account/avatar/00/15/7d/57/c94b6a93.jpg","nickname":"ç‹ç’€ç’¨","note":"","ucode":"9873E12D503CB4","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":1043100,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/ea/9c/230061e7.jpg","nickname":"å´ç£Š","note":"","ucode":"136DC8CF1B10DC","race_medal":0,"user_type":2,"is_pvip":false},"discussion":{"id":399414,"discussion_content":"æœ€ç»ˆå‘ç°çš„é—®é¢˜ç«Ÿç„¶æ˜¯å®‰è£…çš„sparkå’Œpysparkç‰ˆæœ¬æ²¡ä¸€è‡´ã€‚ã€‚ã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1632965168,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":399135,"ip_address":""},"score":399414,"extra":""}]}]},{"had_liked":false,"id":310937,"user_name":"liugddx","can_delete":false,"product_type":"c1","uid":1016163,"ip_address":"","ucode":"FDB66E03A74422","user_header":"https://static001.geekbang.org/account/avatar/00/0f/81/63/2ceecb43.jpg","comment_is_top":false,"comment_ctime":1630992793,"is_pvip":false,"replies":[{"id":"112695","content":"å¥½é—®é¢˜ï¼ŒHadoopçš„èŒƒç•´å¯å¤§å¯å°ã€‚<br><br>å¾€å°äº†è¯´ï¼ŒHadoopç‰¹æŒ‡HDFSã€YARNã€MapReduceè¿™ä¸‰ä¸ªç»„ä»¶ï¼Œä»–ä»¬åˆ†åˆ«æ˜¯Hadoopåˆ†å¸ƒå¼æ–‡ä»¶ç³»ç»Ÿã€åˆ†å¸ƒå¼ä»»åŠ¡è°ƒåº¦æ¡†æ¶ã€åˆ†å¸ƒå¼è®¡ç®—å¼•æ“ã€‚<br><br>å¾€å¤§äº†è¯´ï¼ŒHadoopç”Ÿæ€åŒ…å«æ‰€æœ‰ç”±è¿™3ä¸ªç»„ä»¶è¡ç”Ÿå‡ºçš„å¤§æ•°æ®äº§å“ï¼Œå¦‚Hiveã€Hbaseã€Pigã€Sqoopï¼Œç­‰ç­‰ã€‚<br><br>Sparkå’ŒHadoopçš„å…³ç³»ï¼Œæ˜¯å…±ç”Ÿå…±èµ¢çš„å…³ç³»ã€‚Sparkçš„å®šä½æ˜¯åˆ†å¸ƒå¼è®¡ç®—å¼•æ“ï¼Œå› æ­¤ï¼Œå®ƒçš„ç›´æ¥â€œç«äº‰å¯¹æ‰‹â€ï¼Œæ˜¯MapReduceï¼Œä¹Ÿå°±æ˜¯Hadoopçš„åˆ†å¸ƒå¼è®¡ç®—å¼•æ“ã€‚Sparkæ˜¯å†…å­˜è®¡ç®—å¼•æ“ï¼Œè€ŒMapReduceåœ¨è®¡ç®—çš„è¿‡ç¨‹ä¸­ï¼Œéœ€è¦é¢‘ç¹è½ç›˜ï¼Œå› æ­¤ï¼Œä¸€èˆ¬æ¥è¯´ï¼Œç›¸æ¯”MapReduceï¼ŒSparkåœ¨æ‰§è¡Œæ€§èƒ½ä¸Šï¼Œæ›´èƒœä¸€ç­¹ã€‚<br><br>å¯¹äºHDFSã€YARNï¼ŒSparkå¯ä¸ä¹‹å®Œç¾ç»“åˆï¼Œå®é™…ä¸Šï¼Œåœ¨å¾ˆå¤šçš„ä½¿ç”¨åœºæ™¯ä¸­ï¼ŒSparkçš„æ•°æ®æºå¾€å¾€å­˜å‚¨äºHDFSï¼Œè€ŒYARNæ˜¯Sparké‡è¦çš„èµ„æºè°ƒåº¦æ¡†æ¶ä¹‹ä¸€ã€‚<br><br>å¤§ä½“ä¸Šæ˜¯è¿™äº›ï¼Œå½“ç„¶ï¼Œè¿˜å¯ä»¥è¯´çš„æ›´ç»†ï¼Œè€å¼Ÿå¯ä»¥ç»§ç»­åœ¨åå°ç•™è¨€ï¼Œæˆ‘ä»¬ç»§ç»­è®¨è®º~","user_name":"ä½œè€…å›å¤","user_name_real":"å´ç£Š","uid":"1043100","ctime":1631024087,"ip_address":"","comment_id":310937,"utype":1}],"discussion_count":4,"race_medal":0,"score":"147659880857","product_id":100090001,"comment_content":"æˆ‘æ˜¯ä¸€ä¸ªå¤§æ•°æ®å°ç™½ï¼Œæˆ‘æƒ³å’¨è¯¢ä¸‹sparkå’Œhadoopåœ¨å¤§æ•°æ®ä½“ç³»ä¸‹çš„å…³ç³»ï¼Ÿ","like_count":34,"discussions":[{"author":{"id":1043100,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/ea/9c/230061e7.jpg","nickname":"å´ç£Š","note":"","ucode":"136DC8CF1B10DC","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":526408,"discussion_content":"å¥½é—®é¢˜ï¼ŒHadoopçš„èŒƒç•´å¯å¤§å¯å°ã€‚\n\nå¾€å°äº†è¯´ï¼ŒHadoopç‰¹æŒ‡HDFSã€YARNã€MapReduceè¿™ä¸‰ä¸ªç»„ä»¶ï¼Œä»–ä»¬åˆ†åˆ«æ˜¯Hadoopåˆ†å¸ƒå¼æ–‡ä»¶ç³»ç»Ÿã€åˆ†å¸ƒå¼ä»»åŠ¡è°ƒåº¦æ¡†æ¶ã€åˆ†å¸ƒå¼è®¡ç®—å¼•æ“ã€‚\n\nå¾€å¤§äº†è¯´ï¼ŒHadoopç”Ÿæ€åŒ…å«æ‰€æœ‰ç”±è¿™3ä¸ªç»„ä»¶è¡ç”Ÿå‡ºçš„å¤§æ•°æ®äº§å“ï¼Œå¦‚Hiveã€Hbaseã€Pigã€Sqoopï¼Œç­‰ç­‰ã€‚\n\nSparkå’ŒHadoopçš„å…³ç³»ï¼Œæ˜¯å…±ç”Ÿå…±èµ¢çš„å…³ç³»ã€‚Sparkçš„å®šä½æ˜¯åˆ†å¸ƒå¼è®¡ç®—å¼•æ“ï¼Œå› æ­¤ï¼Œå®ƒçš„ç›´æ¥â€œç«äº‰å¯¹æ‰‹â€ï¼Œæ˜¯MapReduceï¼Œä¹Ÿå°±æ˜¯Hadoopçš„åˆ†å¸ƒå¼è®¡ç®—å¼•æ“ã€‚Sparkæ˜¯å†…å­˜è®¡ç®—å¼•æ“ï¼Œè€ŒMapReduceåœ¨è®¡ç®—çš„è¿‡ç¨‹ä¸­ï¼Œéœ€è¦é¢‘ç¹è½ç›˜ï¼Œå› æ­¤ï¼Œä¸€èˆ¬æ¥è¯´ï¼Œç›¸æ¯”MapReduceï¼ŒSparkåœ¨æ‰§è¡Œæ€§èƒ½ä¸Šï¼Œæ›´èƒœä¸€ç­¹ã€‚\n\nå¯¹äºHDFSã€YARNï¼ŒSparkå¯ä¸ä¹‹å®Œç¾ç»“åˆï¼Œå®é™…ä¸Šï¼Œåœ¨å¾ˆå¤šçš„ä½¿ç”¨åœºæ™¯ä¸­ï¼ŒSparkçš„æ•°æ®æºå¾€å¾€å­˜å‚¨äºHDFSï¼Œè€ŒYARNæ˜¯Sparké‡è¦çš„èµ„æºè°ƒåº¦æ¡†æ¶ä¹‹ä¸€ã€‚\n\nå¤§ä½“ä¸Šæ˜¯è¿™äº›ï¼Œå½“ç„¶ï¼Œè¿˜å¯ä»¥è¯´çš„æ›´ç»†ï¼Œè€å¼Ÿå¯ä»¥ç»§ç»­åœ¨åå°ç•™è¨€ï¼Œæˆ‘ä»¬ç»§ç»­è®¨è®º~","likes_number":2,"is_delete":false,"is_hidden":false,"ctime":1631024087,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":1,"child_discussions":[{"author":{"id":2823352,"avatar":"https://static001.geekbang.org/account/avatar/00/2b/14/b8/2d030d91.jpg","nickname":"ç¦…","note":"","ucode":"FA0E4FD1672854","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":1043100,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/ea/9c/230061e7.jpg","nickname":"å´ç£Š","note":"","ucode":"136DC8CF1B10DC","race_medal":0,"user_type":2,"is_pvip":false},"discussion":{"id":561357,"discussion_content":"å¯ä»¥æ¥ç€å¾€ä¸‹è®²å—ï¼ŸæœŸå¾…","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1649605961,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":526408,"ip_address":""},"score":561357,"extra":""}]},{"author":{"id":1016163,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/81/63/2ceecb43.jpg","nickname":"liugddx","note":"","ucode":"FDB66E03A74422","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":392824,"discussion_content":"å´è€å¸ˆï¼Œæˆ‘è¿˜æƒ³é—®å…³äºç‰ˆæœ¬çš„é—®é¢˜ï¼Œå¤§æ•°æ®å¾ˆå¤šç»„ä»¶éƒ½æœ‰ç‰ˆæœ¬ä¸å…¼å®¹çš„é—®é¢˜ï¼Œæˆ‘å­¦ä¹ çš„è¯è¯¥ç”¨ä»€ä¹ˆç‰ˆæœ¬å‘¢ï¼Ÿä¼šä¸ä¼šå’Œå…¶ä»–æ¯”å¦‚hadoopæœ‰ä¸å…¼å®¹ç­‰ç­‰é—®é¢˜ï¼Ÿ","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1631149643,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":1,"child_discussions":[{"author":{"id":1043100,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/ea/9c/230061e7.jpg","nickname":"å´ç£Š","note":"","ucode":"136DC8CF1B10DC","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":1016163,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/81/63/2ceecb43.jpg","nickname":"liugddx","note":"","ucode":"FDB66E03A74422","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":399136,"discussion_content":"è¿™ä¸ªå°±case by caseäº†ï¼Œä¸è¿‡éƒ½ç”¨æœ€æ–°çš„ç¨³å®šç‰ˆï¼Œä¸€èˆ¬éƒ½æ²¡å•¥é—®é¢˜","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1632910388,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":392824,"ip_address":""},"score":399136,"extra":""}]}]},{"had_liked":false,"id":312691,"user_name":"Neo-dqy","can_delete":false,"product_type":"c1","uid":1924786,"ip_address":"","ucode":"9BF300EB1DDD00","user_header":"https://static001.geekbang.org/account/avatar/00/1d/5e/b2/aceb3e41.jpg","comment_is_top":false,"comment_ctime":1631944433,"is_pvip":false,"replies":[{"id":"113342","content":"Scalaè¯­æ³•ç¡®å®æ¯”è¾ƒçµæ´»ï¼Œä¸€èˆ¬æ¥è¯´ï¼Œç®€å•è¡¨è¾¾å¼ç”¨()ï¼Œå¤æ‚è¡¨è¾¾å¼ç”¨{}ã€‚<br><br>æ¯”å¦‚ï¼Œç®€å•å‡½æ•°ä½“ï¼š(x =&gt; x + 1)ã€(_ + 1)ï¼Œç­‰ç­‰ï¼›<br>å¤æ‚å‡½æ•°ä½“ï¼š{case x: String =&gt; â€œä¸€å¤§å †å…³äºxçš„è½¬æ¢â€ }<br><br>å…³äºæœ€åçš„é—®é¢˜ï¼Œä¹Ÿå°±æ˜¯Scalaä¹Ÿå¯ä»¥å®ç°Word Countï¼Œå’ŒSparkæœ‰ä»€ä¹ˆåŒºåˆ«ã€‚è¿™ä¸ªé—®é¢˜æ¯”è¾ƒé‡è¦ï¼Œè€å¼Ÿéœ€è¦ç”¨å¿ƒå¬ä¸€ä¸‹~<br><br>å…¶å®ï¼Œä»»ä½•ä¸€ç§è¯­è¨€ï¼Œéƒ½å¯ä»¥å®ç°ä»»ä½•è®¡ç®—é€»è¾‘ï¼Œæ¯•ç«Ÿæ˜¯é«˜çº§ç¼–ç¨‹è¯­è¨€ï¼ŒåŸºæœ¬ä¸Šéƒ½æ˜¯å›¾çµå®Œå¤‡çš„ã€‚æ‰€ä»¥è¯´åƒword countè¿™ç§éå¸¸ç®€å•çš„é€»è¾‘ï¼Œä¸åªæ˜¯scalaï¼Œå…¶ä»–è¯­è¨€éƒ½èƒ½æå®šã€‚ä½†æ˜¯ï¼ŒScalaä¹Ÿå¥½ã€Javaä¹Ÿç½¢ï¼Œå†æˆ–è€…æ˜¯Pythonï¼Œä»–ä»¬å®ç°çš„word countï¼Œåªèƒ½åœ¨å•æœºè·‘ï¼Œè€ŒSparkå®ç°çš„Word Countï¼Œæ˜¯åœ¨åˆ†å¸ƒå¼ç¯å¢ƒè·‘ã€‚è¿™ï¼Œæ˜¯æœ¬è´¨çš„åŒºåˆ«ã€‚<br><br>Sparkï¼Œæœ€æ ¸å¿ƒçš„èƒ½åŠ›ï¼Œå°±æ˜¯åˆ†å¸ƒå¼è®¡ç®—ï¼Œåˆ©ç”¨å¤§è§„æ¨¡é›†ç¾¤çš„èƒ½åŠ›ã€‚è¿™æ˜¯æœ€æœ¬è´¨çš„åŒºåˆ«ã€‚<br><br>æ¯”å¦‚ï¼Œç°åœ¨æœ‰2ä¸‡äº¿è¡Œçš„æ–‡æœ¬ï¼Œéœ€è¦ä½ è®¡ç®—word countï¼Œä½ ç”¨scalaä¹Ÿèƒ½åœ¨å•æœºå®ç°ï¼Œä½†æ˜¯ï¼Œè¿™ä¸ªword countåªèƒ½åœ¨å•æœºè·‘ï¼Œå¯¹äºä¸€èˆ¬çš„æœºå™¨ï¼Œå¤§æ¦‚ç‡æ˜¯è·‘ä¸åŠ¨çš„ã€‚<br><br>å¯æ˜¯ï¼Œåœ¨åˆ†å¸ƒå¼é›†ç¾¤ä¸­ï¼Œè¿™æ ·çš„é‡çº§ï¼Œå°±è½»æ¾å¾—å¤šäº†ã€‚Sparkï¼Œæ›´å¤šçš„ï¼Œæ˜¯æä¾›ä¸€ç§åˆ†å¸ƒå¼è®¡ç®—çš„èƒ½åŠ›ï¼Œå®ƒæä¾›ç»™å¼€å‘è€…ç®€å•çš„å¼€å‘APIï¼Œè®©å¼€å‘è€…å¯ä»¥åƒå¼€å‘å•æœºåº”ç”¨é‚£æ ·ï¼Œè½»è€Œæ˜“ä¸¾åœ°å¼€å‘åˆ†å¸ƒå¼åº”ç”¨ï¼Œè®©åˆ†å¸ƒå¼è®¡ç®—å¯¹äºå¼€å‘è€…æ¥è¯´ï¼Œå˜å¾—é€æ˜ã€‚å¼€å‘è€…åªéœ€è¦å…³æ³¨ä¸šåŠ¡é€»è¾‘ï¼Œæˆ–è€…è¯´è®¡ç®—é€»è¾‘ï¼Œè€Œä¸å¿…å…³å¿ƒåˆ†å¸ƒå¼ç³»ç»Ÿåº•å±‚çš„è°ƒåº¦ã€åˆ†å‘ã€æ•°æ®äº¤æ¢ã€ç­‰ç­‰å’Œåˆ†å¸ƒå¼è®¡ç®—æœ¬èº«æœ‰å…³çš„ä¸œè¥¿ã€‚<br><br>æ‰€ä»¥è¯´ï¼ŒScalaå’ŒSparkï¼Œä¸¤è€…æ²¡æœ‰å¯æ¯”æ€§ã€‚å½“ç„¶ï¼Œé™¤äº†Sparkï¼Œç°åœ¨è¿˜æœ‰éå¸¸å¤šçš„åˆ†å¸ƒå¼è®¡ç®—æ¡†æ¶ï¼Œæ¯”å¦‚MapReduceã€Flinkã€Prestoã€TensorFlowï¼Œç­‰ç­‰ï¼Œå¤§å®¶éƒ½æ˜¯ç©åˆ†å¸ƒå¼è®¡ç®—çš„ï¼Œåªä¸è¿‡â€œæœ¯ä¸šæœ‰ä¸“æ”»â€ï¼Œå„å¸å…¶èŒ~","user_name":"ä½œè€…å›å¤","user_name_real":"å´ç£Š","uid":"1043100","ctime":1632051865,"ip_address":"","comment_id":312691,"utype":1}],"discussion_count":5,"race_medal":0,"score":"66056453873","product_id":100090001,"comment_content":"è€å¸ˆå¥½ï¼wordCounts.map{case (k, v) =&gt; (v, k)}.sortByKey(false).take(5)è¿™è¡Œä»£ç æˆ‘è¿˜å­˜åœ¨ç–‘é—®ï¼Œä¸ºä»€ä¹ˆè¿™é‡Œçš„mapå‡½æ•°ä½¿ç”¨äº†èŠ±æ‹¬å·{ }è€Œä¸æ˜¯ä¸Šé¢ä¸€äº›ç®—å­çš„( )ï¼ŒåŒæ—¶è¿™ä¸ªcaseåˆæ˜¯ä»€ä¹ˆæ„æ€ï¼Ÿè¿™ä¸€è¡Œä»£ç éå¸¸åƒæˆ‘æ›¾ç»åœ¨Pythonä¸­ä½¿ç”¨å­—å…¸æ•°æ®ç»“æ„ï¼Œç„¶åæ ¹æ®å­—å…¸å€¼çš„å‡åºæ’åºã€‚æœ€åï¼Œè²Œä¼¼Scalaè¯­è¨€æœ¬èº«å°±å¯ä»¥å®ç°wordcountæ¡ˆä¾‹ï¼Œé‚£ä¹ˆå®ƒæœ¬èº«çš„å®ç°å’Œsparkå®ç°ç›¸æ¯”ï¼Œsparkæœ‰ä»€ä¹ˆä¼˜åŠ¿å‘¢ï¼Ÿ","like_count":15,"discussions":[{"author":{"id":1598796,"avatar":"https://static001.geekbang.org/account/avatar/00/18/65/4c/f7f86496.jpg","nickname":"welldo","note":"","ucode":"D38E75364CD2E3","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":405379,"discussion_content":"ç¬¬ä¸€ä¸ªé—®é¢˜,å´è€å¸ˆå›ç­”å¾—æ¯”è¾ƒç®€å•,æˆ‘æ¥æ·±å…¥æŒ–æ˜ä¸€ä¸‹.\nè¿™ç§è¯­æ³•,åœ¨scalaé‡Œå«åå‡½æ•°,ç›´æ¥è¯´è¿™ä¸ªåè¯,å¯èƒ½æœ‰ç‚¹å„¿æ‡µ,\næˆ‘ä»¬æ¥çœ‹ä¸€ä¸‹æ¨æ¼”è¿‡ç¨‹.\n\né¢˜ç›®:\nè¿™é‡Œæœ‰ä¸ªé›†åˆ,val list = List(1, 2, 3, 4, &#34;abc&#34;)\nè¦æ±‚å°†é›†åˆlistä¸­çš„æ‰€æœ‰æ•°å­—å…ƒç´ +1ï¼Œå¿½ç•¥æ‰ éæ•°å­— çš„å…ƒç´ ï¼Œå¹¶è¿”å›ä¸€ä¸ªæ–°çš„é›†åˆ\nå¾ˆæ˜¾ç„¶,ç­”æ¡ˆä¸º(2, 3, 4, 5)\n\næ–¹å¼1(å¤è€æ–¹å¼)\nä½¿ç”¨scalaè‡ªå¸¦çš„filterç®—å­(ç­›æ‰éint),å’Œ mapç®—å­(å‰©ä¸‹çš„int +1)\n\næ–¹å¼2(ç¨å¾®å…ˆè¿›çš„æ–¹å¼,ä½¿ç”¨&#34;æ¨¡å¼åŒ¹é…&#34;ï¼Œç›¸å½“äºjavaä¸­çš„switch)\n    def add1(item :Any)={\n        item match {\n            case x:Int => x +1\n            case _ =>\n        }\n    }\n\n\næ–¹å¼3(å…ˆè¿›çš„æ–¹å¼,åå‡½æ•°)\nä½¿ç”¨åœºæ™¯ï¼šä¸æ˜¯é’ˆå¯¹æ‰€æœ‰å…ƒç´ éƒ½è¿›è¡Œé€»è¾‘æ“ä½œï¼Œè€Œåªé’ˆå¯¹ç¬¦åˆæ¡ä»¶çš„å…ƒç´ è¿›è¡Œæ“ä½œ\nval pf = new PartialFunction[Any, Int] {\n      override def isDefinedAt(x: Any): Boolean = { }\n      override def apply(v1: Any): Int = { }\n    }\n\nè§£é‡Šï¼šisDefinedAtï¼ˆï¼‰å‡½æ•°,ä¼šéå†é›†åˆçš„æ‰€æœ‰å…ƒç´ ï¼Œå¦‚æœè¿”å›å€¼ä¸ºtrue ,åˆ™ç»§ç»­å¯¹æ­¤å…ƒç´ æ‰§è¡Œ applyï¼ˆï¼‰å‡½æ•°, æ„å»ºè¿”å›å€¼ã€‚\nå¯¹åº”åˆ°è¿™ä¸ªé¢˜,ä¹Ÿå°±æ˜¯isDefinedAt()å‡½æ•° ç­›é€‰intå‹, ç„¶ååœ¨ apply()å‡½æ•°ä¸­+1\n\næ–¹å¼4(å…ˆè¿›çš„æ–¹å¼,åå‡½æ•°çš„ç®€å†™ç‰ˆæœ¬)\nå› ä¸ºä¸Šé¢é‚£ä¸€å¨å®åœ¨å¤ªè‡ƒè‚¿ä¸”æ ‡å‡†åŒ–,æ‰€ä»¥ç”¨è¯­æ³•ç³–ç®€å†™å¦‚ä¸‹\nlist.collect {\n      case i: Int => i + 1\n    }\n\næ€»ç»“:æŠŠå¤§æ‹¬å·å†…çš„ä¸€ç»„caseè¯­å¥å°è£…ä¸ºå‡½æ•°ï¼Œæˆ‘ä»¬ç§°ä¹‹ä¸ºåå‡½æ•°.\n\nåœ¨è€å¸ˆçš„ç¤ºä¾‹ä»£ç ä¸­,map{case (k, v) => (v, k)}\nå°±æ˜¯æŠŠäºŒå…ƒç»„kv, å˜æˆvk","likes_number":6,"is_delete":false,"is_hidden":false,"ctime":1634562666,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1043100,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/ea/9c/230061e7.jpg","nickname":"å´ç£Š","note":"","ucode":"136DC8CF1B10DC","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":527081,"discussion_content":"Scalaè¯­æ³•ç¡®å®æ¯”è¾ƒçµæ´»ï¼Œä¸€èˆ¬æ¥è¯´ï¼Œç®€å•è¡¨è¾¾å¼ç”¨()ï¼Œå¤æ‚è¡¨è¾¾å¼ç”¨{}ã€‚\n\næ¯”å¦‚ï¼Œç®€å•å‡½æ•°ä½“ï¼š(x =&amp;gt; x + 1)ã€(_ + 1)ï¼Œç­‰ç­‰ï¼›\nå¤æ‚å‡½æ•°ä½“ï¼š{case x: String =&amp;gt; â€œä¸€å¤§å †å…³äºxçš„è½¬æ¢â€ }\n\nå…³äºæœ€åçš„é—®é¢˜ï¼Œä¹Ÿå°±æ˜¯Scalaä¹Ÿå¯ä»¥å®ç°Word Countï¼Œå’ŒSparkæœ‰ä»€ä¹ˆåŒºåˆ«ã€‚è¿™ä¸ªé—®é¢˜æ¯”è¾ƒé‡è¦ï¼Œè€å¼Ÿéœ€è¦ç”¨å¿ƒå¬ä¸€ä¸‹~\n\nå…¶å®ï¼Œä»»ä½•ä¸€ç§è¯­è¨€ï¼Œéƒ½å¯ä»¥å®ç°ä»»ä½•è®¡ç®—é€»è¾‘ï¼Œæ¯•ç«Ÿæ˜¯é«˜çº§ç¼–ç¨‹è¯­è¨€ï¼ŒåŸºæœ¬ä¸Šéƒ½æ˜¯å›¾çµå®Œå¤‡çš„ã€‚æ‰€ä»¥è¯´åƒword countè¿™ç§éå¸¸ç®€å•çš„é€»è¾‘ï¼Œä¸åªæ˜¯scalaï¼Œå…¶ä»–è¯­è¨€éƒ½èƒ½æå®šã€‚ä½†æ˜¯ï¼ŒScalaä¹Ÿå¥½ã€Javaä¹Ÿç½¢ï¼Œå†æˆ–è€…æ˜¯Pythonï¼Œä»–ä»¬å®ç°çš„word countï¼Œåªèƒ½åœ¨å•æœºè·‘ï¼Œè€ŒSparkå®ç°çš„Word Countï¼Œæ˜¯åœ¨åˆ†å¸ƒå¼ç¯å¢ƒè·‘ã€‚è¿™ï¼Œæ˜¯æœ¬è´¨çš„åŒºåˆ«ã€‚\n\nSparkï¼Œæœ€æ ¸å¿ƒçš„èƒ½åŠ›ï¼Œå°±æ˜¯åˆ†å¸ƒå¼è®¡ç®—ï¼Œåˆ©ç”¨å¤§è§„æ¨¡é›†ç¾¤çš„èƒ½åŠ›ã€‚è¿™æ˜¯æœ€æœ¬è´¨çš„åŒºåˆ«ã€‚\n\næ¯”å¦‚ï¼Œç°åœ¨æœ‰2ä¸‡äº¿è¡Œçš„æ–‡æœ¬ï¼Œéœ€è¦ä½ è®¡ç®—word countï¼Œä½ ç”¨scalaä¹Ÿèƒ½åœ¨å•æœºå®ç°ï¼Œä½†æ˜¯ï¼Œè¿™ä¸ªword countåªèƒ½åœ¨å•æœºè·‘ï¼Œå¯¹äºä¸€èˆ¬çš„æœºå™¨ï¼Œå¤§æ¦‚ç‡æ˜¯è·‘ä¸åŠ¨çš„ã€‚\n\nå¯æ˜¯ï¼Œåœ¨åˆ†å¸ƒå¼é›†ç¾¤ä¸­ï¼Œè¿™æ ·çš„é‡çº§ï¼Œå°±è½»æ¾å¾—å¤šäº†ã€‚Sparkï¼Œæ›´å¤šçš„ï¼Œæ˜¯æä¾›ä¸€ç§åˆ†å¸ƒå¼è®¡ç®—çš„èƒ½åŠ›ï¼Œå®ƒæä¾›ç»™å¼€å‘è€…ç®€å•çš„å¼€å‘APIï¼Œè®©å¼€å‘è€…å¯ä»¥åƒå¼€å‘å•æœºåº”ç”¨é‚£æ ·ï¼Œè½»è€Œæ˜“ä¸¾åœ°å¼€å‘åˆ†å¸ƒå¼åº”ç”¨ï¼Œè®©åˆ†å¸ƒå¼è®¡ç®—å¯¹äºå¼€å‘è€…æ¥è¯´ï¼Œå˜å¾—é€æ˜ã€‚å¼€å‘è€…åªéœ€è¦å…³æ³¨ä¸šåŠ¡é€»è¾‘ï¼Œæˆ–è€…è¯´è®¡ç®—é€»è¾‘ï¼Œè€Œä¸å¿…å…³å¿ƒåˆ†å¸ƒå¼ç³»ç»Ÿåº•å±‚çš„è°ƒåº¦ã€åˆ†å‘ã€æ•°æ®äº¤æ¢ã€ç­‰ç­‰å’Œåˆ†å¸ƒå¼è®¡ç®—æœ¬èº«æœ‰å…³çš„ä¸œè¥¿ã€‚\n\næ‰€ä»¥è¯´ï¼ŒScalaå’ŒSparkï¼Œä¸¤è€…æ²¡æœ‰å¯æ¯”æ€§ã€‚å½“ç„¶ï¼Œé™¤äº†Sparkï¼Œç°åœ¨è¿˜æœ‰éå¸¸å¤šçš„åˆ†å¸ƒå¼è®¡ç®—æ¡†æ¶ï¼Œæ¯”å¦‚MapReduceã€Flinkã€Prestoã€TensorFlowï¼Œç­‰ç­‰ï¼Œå¤§å®¶éƒ½æ˜¯ç©åˆ†å¸ƒå¼è®¡ç®—çš„ï¼Œåªä¸è¿‡â€œæœ¯ä¸šæœ‰ä¸“æ”»â€ï¼Œå„å¸å…¶èŒ~","likes_number":1,"is_delete":false,"is_hidden":false,"ctime":1632051865,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":2759990,"avatar":"https://static001.geekbang.org/account/avatar/00/2a/1d/36/a0a283f8.jpg","nickname":"åƒæ±Ÿæœ‰æ°´åƒæ±Ÿæœˆ","note":"","ucode":"23F5A65024CB67","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":406992,"discussion_content":"case æ¨¡å¼åŒ¹é…  èŠ±æ‹¬å·è¡¨ç¤ºä»£ç å—ï¼Œç®€å•çš„ç”¨ï¼ˆï¼‰ï¼Œå¤æ‚çš„ç”¨{}ï¼Œå†…éƒ¨å¯ä»¥ç”¨ï¼›éš”å¼€æ¯ä¸ªç®€å•ä»£ç ã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1634885005,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":2642450,"avatar":"https://static001.geekbang.org/account/avatar/00/28/52/12/36300520.jpg","nickname":"å¤§å¤§æ€ªä¸‹å£«ã€‚","note":"","ucode":"5DFC38A7D54D9B","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":401218,"discussion_content":"Sparkåšçš„æ˜¯ä¸€ç§åˆ†å¸ƒå¼è®¡ç®—ï¼Œå®ƒçš„åº•å±‚ä»£ç æˆ‘ç›®å‰è¿˜æ²¡æœ‰è¯»è¿‡ï¼Œä½†æ˜¯ä½ å¯ä»¥è¿™æ ·ç†è§£ï¼Œå®ƒå°†è¿ç®—çš„é€»è¾‘å‘ç»™é›†ç¾¤ä¸­çš„ä¸€äº›èŠ‚ç‚¹ï¼Œæ¯ä¸ªèŠ‚ç‚¹åˆ†åˆ«å»åšè®¡ç®—ã€‚è€Œå¦‚æœä½ ä»…ä»…ä½¿ç”¨Javaæˆ–è€…å…¶ä»–è¯­è¨€ç¼–å†™wordcountï¼Œä½ åº”è¯¥æœ€å¤šåªèƒ½åœ¨ä¸€å°æœºå™¨ä¸Šåšè¿ç®—ã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1633605924,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":2768136,"avatar":"https://static001.geekbang.org/account/avatar/00/2a/3d/08/fcf92621.jpg","nickname":"å°ç²é“›ğŸ¯","note":"","ucode":"C9608A91BA66A0","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":395539,"discussion_content":"å›ç­”çš„å¤ªå¥½äº†","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1632313297,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":310926,"user_name":"Vic","can_delete":false,"product_type":"c1","uid":1898294,"ip_address":"","ucode":"234BBDADBEF8C0","user_header":"https://static001.geekbang.org/account/avatar/00/1c/f7/36/ccf3b5d1.jpg","comment_is_top":false,"comment_ctime":1630989581,"is_pvip":true,"replies":[{"id":"112697","content":"è¿™ä¸ªæ˜¯æˆ‘çš„é”…ï¼Œå“ˆå“ˆ~ <br><br>è¿™é‡Œæ˜¯æˆ‘å·æ‡’äº†ï¼Œæˆ‘åº”è¯¥åœ¨è¿™æ¡codeä¸Šé¢åŠ ä¸ªæ³¨é‡Šï¼Œè¿™é‡Œâ€œ_â€ï¼ˆä¸‹åˆ’çº¿ï¼‰çš„æ„æ€ï¼Œæ˜¯ä½ çš„æ–‡ä»¶æ ¹ç›®å½•ã€‚Scalaé‡Œé¢ï¼Œç”¨â€œ_â€è¡¨ç¤ºä¸€äº›ä¸é‡è¦ã€ä¸å…³å¿ƒçš„ä¸œè¥¿ï¼Œæ‰€ä»¥æˆ‘å·ç”¨äº†Scalaçš„â€œ_â€ã€‚ä½†è¿™é‡Œç¡®å®ä¼šå¼•èµ·å›°æƒ‘ï¼Œä¸ç”¨ç®¡è¿™ä¸ªï¼Œæˆ‘çš„é”…ï¼Œç”¨ä½ çš„æ–‡ä»¶æ ¹ç›®å½•æ›¿æ¢æ‰è¿™é‡Œçš„â€œ_â€å°±å¥½~","user_name":"ä½œè€…å›å¤","user_name_real":"å´ç£Š","uid":"1043100","ctime":1631024301,"ip_address":"","comment_id":310926,"utype":1}],"discussion_count":9,"race_medal":0,"score":"31695760653","product_id":100090001,"comment_content":"é‡åˆ°è¿™ä¸ªé—®é¢˜<br>scala&gt; val rootPath: String = _<br>&lt;console&gt;:24: error: unbound placeholder parameter<br>       val rootPath: String = _<br>ç½‘ä¸Šæœä¸€ä¸‹ï¼Œè¯´è¿™æ˜¯æ±‡ç¼–é”™è¯¯ã€‚<br>è¦æŠŠval æ”¹æˆvar , ä½†ä¼šé‡åˆ°&quot;_&quot;è¿™defaultå€¼æ˜¯nullã€‚<br>org.apache.hadoop.mapred.InvalidInputException: Input path does not exist: file:&#47;Users&#47;vic&#47;src&#47;data&#47;null&#47;wikiOfSpark.txt<br>è¿™ä¸€æ®µå°±å…ˆè·³è¿‡root_pathï¼Œç›´æ¥ç»™fileä¸€ä¸ªè·¯å¾„ï¼Œæ˜¯å¯ä»¥æˆåŠŸè¿è¡Œ&quot;word count&quot;,å¾—åˆ°å’Œè€å¸ˆä¸€æ ·çš„ç»“æœ:<br>[Stage 0:&gt;                                                          (0 + 2) &#47;                                                                               res0: Array[(Int, String)] = Array((67,the), (63,Spark), (54,a), (51,and), (50,of))","like_count":7,"discussions":[{"author":{"id":1043100,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/ea/9c/230061e7.jpg","nickname":"å´ç£Š","note":"","ucode":"136DC8CF1B10DC","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":526403,"discussion_content":"è¿™ä¸ªæ˜¯æˆ‘çš„é”…ï¼Œå“ˆå“ˆ~ \n\nè¿™é‡Œæ˜¯æˆ‘å·æ‡’äº†ï¼Œæˆ‘åº”è¯¥åœ¨è¿™æ¡codeä¸Šé¢åŠ ä¸ªæ³¨é‡Šï¼Œè¿™é‡Œâ€œ_â€ï¼ˆä¸‹åˆ’çº¿ï¼‰çš„æ„æ€ï¼Œæ˜¯ä½ çš„æ–‡ä»¶æ ¹ç›®å½•ã€‚Scalaé‡Œé¢ï¼Œç”¨â€œ_â€è¡¨ç¤ºä¸€äº›ä¸é‡è¦ã€ä¸å…³å¿ƒçš„ä¸œè¥¿ï¼Œæ‰€ä»¥æˆ‘å·ç”¨äº†Scalaçš„â€œ_â€ã€‚ä½†è¿™é‡Œç¡®å®ä¼šå¼•èµ·å›°æƒ‘ï¼Œä¸ç”¨ç®¡è¿™ä¸ªï¼Œæˆ‘çš„é”…ï¼Œç”¨ä½ çš„æ–‡ä»¶æ ¹ç›®å½•æ›¿æ¢æ‰è¿™é‡Œçš„â€œ_â€å°±å¥½~","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1631024301,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1647570,"avatar":"https://static001.geekbang.org/account/avatar/00/19/23/d2/6ccb3d6c.jpg","nickname":"hope","note":"","ucode":"8CABACA63DF653","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":392542,"discussion_content":"åŠ ä¸€ä¸ªæ³¨é‡Šè¯´æ˜åº”è¯¥å°±å¯ä»¥å§ï½","likes_number":2,"is_delete":false,"is_hidden":false,"ctime":1631032097,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":2,"child_discussions":[{"author":{"id":1043100,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/ea/9c/230061e7.jpg","nickname":"å´ç£Š","note":"","ucode":"136DC8CF1B10DC","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":1647570,"avatar":"https://static001.geekbang.org/account/avatar/00/19/23/d2/6ccb3d6c.jpg","nickname":"hope","note":"","ucode":"8CABACA63DF653","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":392657,"discussion_content":"å¯¹çš„ï¼Œåé¢ä¼šè®©ç¼–è¾‘å¸®å¿™åœ¨åå°åŠ ä¸€ä¸‹~","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1631090773,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":392542,"ip_address":""},"score":392657,"extra":""},{"author":{"id":1501385,"avatar":"https://static001.geekbang.org/account/avatar/00/16/e8/c9/59bcd490.jpg","nickname":"å¬æ°´çš„æ¹–","note":"","ucode":"B1759F90165D81","race_medal":0,"user_type":8,"is_pvip":false},"reply_author":{"id":1647570,"avatar":"https://static001.geekbang.org/account/avatar/00/19/23/d2/6ccb3d6c.jpg","nickname":"hope","note":"","ucode":"8CABACA63DF653","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":392727,"discussion_content":"å·²ç»åœ¨æ­£æ–‡å¢åŠ äº†ï¼Œè°¢è°¢å¤§ä¼™å„¿åé¦ˆ","likes_number":1,"is_delete":false,"is_hidden":false,"ctime":1631103443,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":392542,"ip_address":""},"score":392727,"extra":""}]},{"author":{"id":1898294,"avatar":"https://static001.geekbang.org/account/avatar/00/1c/f7/36/ccf3b5d1.jpg","nickname":"Vic","note":"","ucode":"234BBDADBEF8C0","race_medal":0,"user_type":1,"is_pvip":true},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":392604,"discussion_content":"å“ˆå“ˆï¼Œè°¢è°¢è€å¸ˆçš„è¯´æ˜ã€‚æˆ‘æ¬£èµè€å¸ˆè¿™ç§å¦ç‡å’Œå¹½é»˜çš„æ€§æ ¼ã€‚","likes_number":1,"is_delete":false,"is_hidden":false,"ctime":1631068639,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1031075,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/bb/a3/af469d27.jpg","nickname":"Qilin Lou","note":"","ucode":"29AD43329E7404","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":392451,"discussion_content":"è¿™é‡Œç¡®å®ç¨å¾®æœ‰ç‚¹è¿·æƒ‘ï¼Œåœ¨ Scala é‡Œé¢ç›´æ¥è¿™æ ·å†™ä¼šæœ‰ä¸€ä¸ªè¯­æ³•é”™ã€‚@JavaXu å’Œä½ çš„ææ³•éƒ½æŒºå¥½ï¼Œå…¶å®æˆ‘æ›´å»ºè®®è®²å¸ˆåœ¨è¿™é‡Œæ”¹æˆ???","likes_number":1,"is_delete":false,"is_hidden":false,"ctime":1631009555,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":1,"child_discussions":[{"author":{"id":1043100,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/ea/9c/230061e7.jpg","nickname":"å´ç£Š","note":"","ucode":"136DC8CF1B10DC","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":1031075,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/bb/a3/af469d27.jpg","nickname":"Qilin Lou","note":"","ucode":"29AD43329E7404","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":392658,"discussion_content":"åé¢ä¼šåœ¨codeä¸Šé¢è¡¥å……ä¸ªæ³¨é‡Šå“ˆ~","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1631090813,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":392451,"ip_address":""},"score":392658,"extra":""}]},{"author":{"id":2758135,"avatar":"https://static001.geekbang.org/account/avatar/00/2a/15/f7/aba61f1b.jpg","nickname":"JavaXu","note":"","ucode":"B2EBC7BEEF4D1C","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":392413,"discussion_content":"val rootPath: String = _   æ„æ€æ˜¯è®©ä½ è‡ªå·±è®¾ç½®ä¸€ä¸‹ä½ æœ¬åœ°æ–‡ä»¶çš„ç›®å½•\næ¯”å¦‚ val rootPath: String = s&#34;/Users/MyName/Documents/spark-learning&#34;","likes_number":1,"is_delete":false,"is_hidden":false,"ctime":1630999285,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":1,"child_discussions":[{"author":{"id":1043100,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/ea/9c/230061e7.jpg","nickname":"å´ç£Š","note":"","ucode":"136DC8CF1B10DC","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":2758135,"avatar":"https://static001.geekbang.org/account/avatar/00/2a/15/f7/aba61f1b.jpg","nickname":"JavaXu","note":"","ucode":"B2EBC7BEEF4D1C","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":392659,"discussion_content":"æ˜¯è¿™ä¸ªæ„æ€~","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1631090878,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":392413,"ip_address":""},"score":392659,"extra":""}]}]},{"had_liked":false,"id":310935,"user_name":"å´”å°è±ª","can_delete":false,"product_type":"c1","uid":2604437,"ip_address":"","ucode":"ABB59CE5209E67","user_header":"https://static001.geekbang.org/account/avatar/00/27/bd/95/e923a332.jpg","comment_is_top":false,"comment_ctime":1630992132,"is_pvip":false,"replies":[{"id":"112696","content":"æ¬¢è¿~","user_name":"ä½œè€…å›å¤","user_name_real":"å´ç£Š","uid":"1043100","ctime":1631024120,"ip_address":"","comment_id":310935,"utype":1}],"discussion_count":1,"race_medal":0,"score":"23105828612","product_id":100090001,"comment_content":"å‰æ’å åº§ï¼ä¸‰å¹´å‰æ¥è§¦è¿‡ Spark ä»Šå¤©ä»å¤´å†å­¦ï¼","like_count":5,"discussions":[{"author":{"id":1043100,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/ea/9c/230061e7.jpg","nickname":"å´ç£Š","note":"","ucode":"136DC8CF1B10DC","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":526406,"discussion_content":"æ¬¢è¿~","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1631024120,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":312725,"user_name":"Neo-dqy","can_delete":false,"product_type":"c1","uid":1924786,"ip_address":"","ucode":"9BF300EB1DDD00","user_header":"https://static001.geekbang.org/account/avatar/00/1d/5e/b2/aceb3e41.jpg","comment_is_top":false,"comment_ctime":1631954321,"is_pvip":false,"replies":[{"id":"113344","content":"æ˜¯çš„ï¼Œæ²¡é”™~","user_name":"ä½œè€…å›å¤","user_name_real":"å´ç£Š","uid":"1043100","ctime":1632052047,"ip_address":"","comment_id":312725,"utype":1}],"discussion_count":1,"race_medal":0,"score":"18811823505","product_id":100090001,"comment_content":"è€å¸ˆæˆ‘å¯ä»¥å†é—®ä¸€ä¸‹ï¼Œå¦‚æœæˆ‘æ˜¯ç”¨IDEAåˆ›å»ºSparké¡¹ç›®ï¼Œæ˜¯ä¸æ˜¯åªè¦é…ç½®å¥½Scalaçš„SDKï¼Œç„¶ååœ¨pomæ–‡ä»¶ä¸­åŠ å…¥å¯¹åº”ç‰ˆæœ¬å·çš„sparkä¾èµ–ï¼Œå°±ä¼šè‡ªåŠ¨ä¸‹è½½sparkåŒ…äº†ï¼Ÿè¿™ä¸ªæ—¶å€™ä¸éœ€è¦å†å»å®˜ç½‘ä¸‹è½½sparkäº†å—ï¼ŒåŒæ—¶ä¹Ÿä¸å†éœ€è¦ä½¿ç”¨spark-shelläº†å—ï¼Ÿ","like_count":4,"discussions":[{"author":{"id":1043100,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/ea/9c/230061e7.jpg","nickname":"å´ç£Š","note":"","ucode":"136DC8CF1B10DC","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":527089,"discussion_content":"æ˜¯çš„ï¼Œæ²¡é”™~","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1632052047,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":348495,"user_name":"æ¨å¸…","can_delete":false,"product_type":"c1","uid":1684811,"ip_address":"","ucode":"0A558B1BA62E44","user_header":"","comment_is_top":false,"comment_ctime":1655135528,"is_pvip":true,"discussion_count":0,"race_medal":0,"score":"14540037416","product_id":100090001,"comment_content":"è€å¸ˆï¼Œspark-3.2.1 é»˜è®¤ä»hdfsè¯»å–æ–‡ä»¶ï¼Œæ‰€ä»¥rootPathéœ€è¦åŠ ä¸Šåè®® file:&#47;&#47;.","like_count":3},{"had_liked":false,"id":327787,"user_name":"æµ®ç”Ÿè‹¥æ¢¦","can_delete":false,"product_type":"c1","uid":1454469,"ip_address":"","ucode":"5048F62293A484","user_header":"https://static001.geekbang.org/account/avatar/00/16/31/85/5fd92ebe.jpg","comment_is_top":false,"comment_ctime":1640307584,"is_pvip":false,"replies":[{"id":"119390","content":"æ»¡åˆ†ğŸ’¯ï¼ŒèµğŸ‘~","user_name":"ä½œè€…å›å¤","user_name_real":"ç¼–è¾‘","uid":"1043100","ctime":1640355674,"ip_address":"","comment_id":327787,"utype":1}],"discussion_count":1,"race_medal":0,"score":"14525209472","product_id":100090001,"comment_content":"Javaå®ç°ï¼š<br><br>SparkConf sparkConf = new SparkConf().setAppName(&quot;Test&quot;).setMaster(&quot;local[*]&quot;);<br>        JavaSparkContext JSC = new JavaSparkContext(sparkConf);<br><br>        &#47;&#47; è¯»å–æ–‡ä»¶å†…å®¹<br>        JavaRDD&lt;String&gt; lineRDD = JSC.textFile(&quot;wikiOfSpark.txt&quot;);<br>        &#47;&#47; ä»¥è¡Œä¸ºå•ä½åšåˆ†è¯<br>        JavaRDD&lt;String&gt; wordRDD = lineRDD.flatMap(new FlatMapFunction&lt;String, String&gt;() {<br>            @Override<br>            public Iterator&lt;String&gt; call(String s) throws Exception {<br>                return  Arrays.asList(s.split(&quot; &quot;)).iterator();<br>            }<br>        });<br>        JavaRDD&lt;String&gt; cleanWordRDD = wordRDD.filter(new Function&lt;String, Boolean&gt;() {<br>            @Override<br>            public Boolean call(String s) throws Exception {<br>                return !s.equals(&quot;&quot;);<br>            }<br>        });<br><br>        &#47;&#47; æŠŠRDDå…ƒç´ è½¬æ¢ä¸ºï¼ˆKeyï¼ŒValueï¼‰çš„å½¢å¼<br>        JavaPairRDD&lt;String, Integer&gt; kvRDD = cleanWordRDD.mapToPair(new PairFunction&lt;String, String, Integer&gt;() {<br>            @Override<br>            public Tuple2&lt;String, Integer&gt; call(String s) throws Exception {<br>                return new Tuple2&lt;String, Integer&gt;(s,1);<br>            }<br>        });<br>        &#47;&#47; æŒ‰ç…§å•è¯åšåˆ†ç»„è®¡æ•°<br>        JavaPairRDD&lt;String, Integer&gt; wordCounts = kvRDD.reduceByKey(new Function2&lt;Integer, Integer, Integer&gt;() {<br>            @Override<br>            public Integer call(Integer integer, Integer integer2) throws Exception {<br>                return integer+integer2;<br>            }<br>        });<br>        &#47;&#47; æ‰“å°è¯é¢‘æœ€é«˜çš„5ä¸ªè¯æ±‡(å…ˆå°†å…ƒç»„çš„key valueäº¤æ¢ä¸€ä¸‹é¡ºåºï¼Œç„¶ååœ¨è°ƒç”¨sortByKey())<br>        wordCounts.mapToPair((row)-&gt;  new Tuple2&lt;&gt;(row._2,row._1)).sortByKey(false).foreach(new VoidFunction&lt;Tuple2&lt;Integer, String&gt;&gt;() {<br>            @Override<br>            public void call(Tuple2&lt;Integer, String&gt; stringIntegerTuple2) throws Exception {<br>                System.out.println(stringIntegerTuple2._1 + &quot;:&quot; + stringIntegerTuple2._2);<br>            }<br>        });<br><br>        &#47;&#47;å…³é—­context<br>        JSC.close();","like_count":3,"discussions":[{"author":{"id":1043100,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/ea/9c/230061e7.jpg","nickname":"å´ç£Š","note":"","ucode":"136DC8CF1B10DC","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":541399,"discussion_content":"æ»¡åˆ†ğŸ’¯ï¼ŒèµğŸ‘~","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1640355674,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":312601,"user_name":"ç«ç‚ç„±ç‡š","can_delete":false,"product_type":"c1","uid":2767491,"ip_address":"","ucode":"DB11784DD94059","user_header":"https://static001.geekbang.org/account/avatar/00/2a/3a/83/74e3fabd.jpg","comment_is_top":false,"comment_ctime":1631886464,"is_pvip":false,"replies":[{"id":"113340","content":"Cool~<br><br>åé¢ç­‰ä¸“æ æ›´å®Œäº†ï¼Œæ‰“ç®—æŠŠæ‰€æœ‰Scalaä»£ç æ•´ç†å‡ºä¸€ä»½Pythonç‰ˆæœ¬çš„ï¼Œè€å¼Ÿæœ‰æ²¡æœ‰å…´è¶£ä¸€èµ·å‘€~","user_name":"ä½œè€…å›å¤","user_name_real":"å´ç£Š","uid":"1043100","ctime":1632051299,"ip_address":"","comment_id":312601,"utype":1}],"discussion_count":2,"race_medal":0,"score":"14516788352","product_id":100090001,"comment_content":"Pythonç‰ˆä»£ç ä¸ºï¼š<br><br>file=&#39;~~~&#47;wikiOfSpark.txt&#39;<br>lineRDD=sc.textFile(file)<br>lineRDD.first() # ä¼šæ‰“å°å‡ºlineRDDçš„ç¬¬ä¸€è¡Œï¼š u&#39;Apache Spark&#39;ï¼Œå¦‚æœå‡ºé”™åˆ™ä¸æ‰“å°<br>wordRDD=lineRDD.flatMap(lambda line: line.split(&quot; &quot;))<br>cleanWordRDD=wordRDD.filter(lambda word: word!=&#39;&#39;)<br>kvRDD=cleanWordRDD.map(lambda word:(word,1))<br>wordCounts=kvRDD.reduceByKey(lambda x,y:x+y)<br>wordCounts.map(lambda (k,v):(v,k)).sortByKey(False).take(5)","like_count":3,"discussions":[{"author":{"id":1043100,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/ea/9c/230061e7.jpg","nickname":"å´ç£Š","note":"","ucode":"136DC8CF1B10DC","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":527041,"discussion_content":"Cool~\n\nåé¢ç­‰ä¸“æ æ›´å®Œäº†ï¼Œæ‰“ç®—æŠŠæ‰€æœ‰Scalaä»£ç æ•´ç†å‡ºä¸€ä»½Pythonç‰ˆæœ¬çš„ï¼Œè€å¼Ÿæœ‰æ²¡æœ‰å…´è¶£ä¸€èµ·å‘€~","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1632051299,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":2767491,"avatar":"https://static001.geekbang.org/account/avatar/00/2a/3a/83/74e3fabd.jpg","nickname":"ç«ç‚ç„±ç‡š","note":"","ucode":"DB11784DD94059","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":401913,"discussion_content":"å¥½çš„å•Šï¼Œæˆ‘è¿™å„¿ä¸»è¦å­¦ä¹ pythonï¼Œæ‰€ä»¥æ‰“ç®—æŠŠè¯¾ç¨‹ä¸­çš„ä»£ç éƒ½ç”¨pythonå®ç°ä¸€éã€‚","likes_number":1,"is_delete":false,"is_hidden":false,"ctime":1633762936,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":343030,"user_name":"é™ˆé‡‘é‘«","can_delete":false,"product_type":"c1","uid":1077127,"ip_address":"","ucode":"609A24832CA80C","user_header":"https://static001.geekbang.org/account/avatar/00/10/6f/87/669263b4.jpg","comment_is_top":false,"comment_ctime":1650602160,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"10240536752","product_id":100090001,"comment_content":"åˆå­¦äº†ä¸€éï¼Œwordcountä¸€å¥è¯å®ç°ï¼š<br>spark.sparkContext.textFile(file).flatMap(_.split(&quot; &quot;)).filter(!_.equals(&quot;&quot;)).map((_, 1)).reduceByKey(_ + _).map(t =&gt; (t._2, t._1)).sortByKey(false).take(5)","like_count":2},{"had_liked":false,"id":333067,"user_name":"å›½åº¦","can_delete":false,"product_type":"c1","uid":1697428,"ip_address":"","ucode":"525DA45D56E8C9","user_header":"https://static001.geekbang.org/account/avatar/00/19/e6/94/98f30daf.jpg","comment_is_top":false,"comment_ctime":1644044352,"is_pvip":false,"replies":[{"id":"121998","content":"èµå­¦ä¹ æ‰“å¡~ ä¸€èµ·åŠ æ²¹~ ","user_name":"ä½œè€…å›å¤","user_name_real":"ç¼–è¾‘","uid":"1043100","ctime":1644674396,"ip_address":"","comment_id":333067,"utype":1}],"discussion_count":1,"race_medal":0,"score":"10233978944","product_id":100090001,"comment_content":"2022å¹´2æœˆ5å·å­¦ä¹ æ‰“å¡è®°å½•<br>æœºå™¨ç¯å¢ƒï¼šROG14<br>æ“ä½œç³»ç»Ÿï¼šwin11 + wsl Ubuntu20.04<br>ç¯å¢ƒå˜é‡ï¼š<br>----------------------------<br><br>export SPARK_HOME=&#47;mnt&#47;c&#47;spark&#47;spark-2.4.8-bin-hadoop2.7<br>export JAVA_HOME=&#47;mnt&#47;c&#47;linux_environment&#47;jdk&#47;jdk1.8.0_321<br>export M2_HOME=&#47;mnt&#47;c&#47;linux_environment&#47;apache-maven-3.8.4<br>export SCALA_HOME=&#47;mnt&#47;c&#47;linux_environment&#47;scala3-3.1.1<br><br>export PATH=$SPARK_HOME&#47;bin:$SCALA_HOME&#47;bin:$M2_HOME&#47;bin:$JAVA_HOME&#47;bin:$PATH<br><br>---------------------------<br>å¸Œæœ›å¸®åŠ©å’Œæˆ‘ä¸€æ ·ä»é›¶å¼€å§‹ä¸€èµ·å­¦ä¹ çš„åŒå­¦èº²é¿ä¸€äº›å‘ï¼š<br><br>å‘1ï¼šjdkç‰ˆæœ¬ä¸å…¼å®¹ï¼š<br>ä¸€å¼€å§‹ä½¿ç”¨jdk17ç‰ˆæœ¬ï¼Œåœ¨å¯åŠ¨è¿‡ç¨‹ä¸­ä¸€ç›´æŠ¥é”™ï¼Œé™ä¸º1.8åå¯åŠ¨æˆåŠŸï¼›<br><br>å‘2ï¼šhadoopç‰ˆæœ¬é—®é¢˜ï¼š<br>hadoop3.2.1 é€æ­¥ä½¿ç”¨Datasetï¼ŒæŠ¥é”™ç±»å‹è½¬æ¢å¼‚å¸¸ï¼›<br>ç”±äºscalaç»éªŒä¸è¶³ï¼Œæš‚æ—¶æ— æ³•å¤§è§„æ¨¡æ”¹å†™è€å¸ˆçš„ä»£ç ï¼Œé™ä½ç‰ˆæœ¬ä¸ºspark2.4.8<br>ä¸‹è½½åœ°å€ï¼šhttps:&#47;&#47;dlcdn.apache.org&#47;spark&#47; å¯ä»¥é€‰æ‹©é€‚åˆçš„ç‰ˆæœ¬ä¸‹è½½<br><br>åŸç†æ€§çš„è¿˜æ²¡æœ‰ææ‡‚ï¼Œç›®å‰åœ¨ç¬¬ä¸€é˜¶æ®µï¼Œè¯»æ‡‚ï¼Œç®€å•æ”¹å†™ä¸ºä¸»ï¼›<br><br>æ„Ÿè°¢å´ç£Šè€å¸ˆçš„è¯¾","like_count":2,"discussions":[{"author":{"id":1043100,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/ea/9c/230061e7.jpg","nickname":"å´ç£Š","note":"","ucode":"136DC8CF1B10DC","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":550695,"discussion_content":"èµå­¦ä¹ æ‰“å¡~ ä¸€èµ·åŠ æ²¹~ ","likes_number":1,"is_delete":false,"is_hidden":false,"ctime":1644674396,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":322124,"user_name":"çŒ«å¤ªå¤ª","can_delete":false,"product_type":"c1","uid":1537617,"ip_address":"","ucode":"7A1D1CAA3AF260","user_header":"https://static001.geekbang.org/account/avatar/00/17/76/51/96291466.jpg","comment_is_top":false,"comment_ctime":1637198209,"is_pvip":false,"replies":[{"id":"117221","content":"ä¸éœ€è¦çš„~","user_name":"ä½œè€…å›å¤","user_name_real":"ç¼–è¾‘","uid":"1043100","ctime":1637653868,"ip_address":"","comment_id":322124,"utype":1}],"discussion_count":1,"race_medal":0,"score":"10227132801","product_id":100090001,"comment_content":"è¯·é—®åœ¨æœ¬åœ°éƒ¨ç½²sparkç¯å¢ƒä¸éœ€è¦å…ˆå®‰è£…hadoopä¹ˆ","like_count":2,"discussions":[{"author":{"id":1043100,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/ea/9c/230061e7.jpg","nickname":"å´ç£Š","note":"","ucode":"136DC8CF1B10DC","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":532612,"discussion_content":"ä¸éœ€è¦çš„~","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1637653868,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":312596,"user_name":"Unknown element","can_delete":false,"product_type":"c1","uid":2028277,"ip_address":"","ucode":"34A129800D0238","user_header":"https://static001.geekbang.org/account/avatar/00/1e/f2/f5/b82f410d.jpg","comment_is_top":false,"comment_ctime":1631884796,"is_pvip":false,"replies":[{"id":"113339","content":"spark-shellä¸­ï¼Œsparkæ˜¯é»˜è®¤çš„SparkSessionå®ä¾‹ï¼Œä½ æ˜¯åœ¨spark-shellä¸­æ‰§è¡Œè¿™æ®µä»£ç å—ï¼Ÿå¦‚æœæ˜¯åœ¨IDEï¼Œéœ€è¦è‡ªå·±æ˜ç¡®å®šä¹‰SparkSessionå®ä¾‹çš„ï¼Œæ¯”å¦‚ï¼š<br><br>import org.apache.spark.sql.SparkSession<br><br>val spark = SparkSession.builder<br>  .master(&quot;local[2]&quot;)<br>  .appName(&quot;SparkSession Example&quot;)<br>  .getOrCreate()","user_name":"ä½œè€…å›å¤","user_name_real":"å´ç£Š","uid":"1043100","ctime":1632051238,"ip_address":"","comment_id":312596,"utype":1}],"discussion_count":1,"race_medal":0,"score":"10221819388","product_id":100090001,"comment_content":"é—®ä¸‹æ‰§è¡Œ val lineRDD: RDD[String] = spark.sparkContext.textFile(file) æŠ¥é”™error: not found: value sparkæ˜¯æ€ä¹ˆå›äº‹ï¼Ÿ","like_count":2,"discussions":[{"author":{"id":1043100,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/ea/9c/230061e7.jpg","nickname":"å´ç£Š","note":"","ucode":"136DC8CF1B10DC","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":527038,"discussion_content":"spark-shellä¸­ï¼Œsparkæ˜¯é»˜è®¤çš„SparkSessionå®ä¾‹ï¼Œä½ æ˜¯åœ¨spark-shellä¸­æ‰§è¡Œè¿™æ®µä»£ç å—ï¼Ÿå¦‚æœæ˜¯åœ¨IDEï¼Œéœ€è¦è‡ªå·±æ˜ç¡®å®šä¹‰SparkSessionå®ä¾‹çš„ï¼Œæ¯”å¦‚ï¼š\n\nimport org.apache.spark.sql.SparkSession\n\nval spark = SparkSession.builder\n  .master(&amp;quot;local[2]&amp;quot;)\n  .appName(&amp;quot;SparkSession Example&amp;quot;)\n  .getOrCreate()","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1632051238,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":350438,"user_name":"ğŸŒˆä½ æ˜¯äººé—´å››æœˆå¤©ğŸ’«","can_delete":false,"product_type":"c1","uid":2141510,"ip_address":"","ucode":"3DF00177C07A06","user_header":"https://static001.geekbang.org/account/avatar/00/20/ad/46/f3c56862.jpg","comment_is_top":false,"comment_ctime":1656915495,"is_pvip":false,"discussion_count":1,"race_medal":0,"score":"5951882791","product_id":100090001,"comment_content":"åƒæˆ‘è¿™ç§é›¶åŸºç¡€çš„ï¼Œçœ‹åˆ°å¾ˆæ‡µï¼Œç¬¬ä¸€ä¸ªdemoä»£ç æ˜¯sparkï¼Œè¿™ä¸ªå˜é‡æ€ä¹ˆæ¥çš„ï¼Ÿè¿™ä¸ªçœŸçš„é€‚åˆé›¶åŸºç¡€ï¼Ÿ","like_count":1,"discussions":[{"author":{"id":2941084,"avatar":"","nickname":"Geek_ce7292","note":"","ucode":"7C89258611315E","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":583649,"discussion_content":"åŒå°ç™½å‰æ¥æŠ¥é“ï¼Œä¸€èµ·åŠ æ²¹å‘€~","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1660269953,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":"ä¸­å›½é¦™æ¸¯"},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":342661,"user_name":"Gavin_From_Mars","can_delete":false,"product_type":"c1","uid":1568046,"ip_address":"","ucode":"B66CC36E3F8129","user_header":"https://static001.geekbang.org/account/avatar/00/17/ed/2e/7a171500.jpg","comment_is_top":false,"comment_ctime":1650389909,"is_pvip":false,"discussion_count":1,"race_medal":0,"score":"5945357205","product_id":100090001,"comment_content":"æŒ‰ç…§æ–‡ä¸­å®‰è£…åä¸€ç›´æœ‰é—®é¢˜ã€‚ã€‚ã€‚å¯åŠ¨sparkçœ‹åˆ°é»˜è®¤å¸¦scala2.12.15.ä½†æ˜¯å¯åŠ¨spark shellæœ‰é”™è¯¯ã€‚â€œerror: not found: value sparkâ€ï¼Œç„¶ååœ¨shellä¸­æ‰§è¡Œæ–‡ä¸­çš„wordcountä¹Ÿæ˜¯åŒæ ·çš„é”™è¯¯","like_count":1,"discussions":[{"author":{"id":1169841,"avatar":"https://static001.geekbang.org/account/avatar/00/11/d9/b1/e0db45de.jpg","nickname":"åœˆåœˆgor","note":"","ucode":"30B3FDAE5D92B6","race_medal":2,"user_type":1,"is_pvip":true},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":566991,"discussion_content":"ä½ è¿™æ˜¯åœ¨windowä¸‹æ‰§è¡Œçš„å—ï¼Ÿæˆ‘é‡åˆ°åŒæ ·é—®é¢˜ï¼Œåˆ‡æ¢åˆ°linuxé‡Œå°±ä¸ä¼šäº†ï¼Œä¼šè‡ªåŠ¨åˆ›å»ºè¿™ä¸ªå¯¹è±¡ã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1650810531,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":341492,"user_name":"æˆ‘çˆ±å¤œæ¥é¦™","can_delete":false,"product_type":"c1","uid":2609930,"ip_address":"","ucode":"10761E677EF05F","user_header":"https://static001.geekbang.org/account/avatar/00/27/d3/0a/92640aae.jpg","comment_is_top":false,"comment_ctime":1649659919,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"5944627215","product_id":100090001,"comment_content":"è€å¸ˆ,DAGè®¡ç®—æ¨¡å‹çš„ä¼˜åŠ¿å¯ä¸å¯ä»¥è¿™ä¹ˆç†è§£:sparkåœ¨æ²¡æœ‰é‡åˆ°å®½ä¾èµ–ä¹‹å‰,æ‰€æœ‰çš„æ“ä½œåŒ…æ‹¬wordRDDåˆ°lineRDDåˆ°wordRDDåˆ°kvRDDç­‰éƒ½æ˜¯ä¸€æ¬¡æ€§åœ¨å†…å­˜ä¸­å®Œæˆçš„,æœ€ç»ˆè¾“å‡ºkvRDDåˆ°ç£ç›˜ä¸­è¿›è¡Œshuffle,åªä¼šæœ‰ä¸€æ¬¡è½ç›˜æ“ä½œ;<br>è€ŒmapReduceä¸­æ¯”å¦‚æŠŠæ•´ä¸ªæ–‡æœ¬åˆ‡å‰²æˆä¸€è¡Œä¸€è¡Œ,åœ¨å†…å­˜ä¸­å®Œæˆåéœ€è¦è½ç›˜,å†ç”±ä¸€è¡Œä¸€è¡Œè½¬æ¢æˆé”®å€¼å¯¹åˆè¦è½ç›˜.ä¸­é—´æ¶‰åŠäº†å¤ªå¤šå†™ç›˜æ“ä½œã€‚æ¢å¥è¯è¯´,sparkåŸºäºå†…å­˜è®¡ç®—å°±æ˜¯å……åˆ†åˆ©ç”¨å†…å­˜?éº»çƒ¦è€å¸ˆè§£ç­”ä¸€ä¸‹","like_count":1},{"had_liked":false,"id":311235,"user_name":"Z","can_delete":false,"product_type":"c1","uid":2758639,"ip_address":"","ucode":"A404BDC6C4435C","user_header":"https://static001.geekbang.org/account/avatar/00/2a/17/ef/d0a1a069.jpg","comment_is_top":false,"comment_ctime":1631113822,"is_pvip":false,"replies":[{"id":"112843","content":"çœ‹çœ‹åˆ†éš”ç¬¦æ˜¯ä¸æ˜¯ç”¨äº†ç©ºå­—ç¬¦ä¸²ï¼Ÿåˆ†éš”ç¬¦åº”è¯¥æ˜¯ç©ºæ ¼â€œ â€","user_name":"ä½œè€…å›å¤","user_name_real":"å´ç£Š","uid":"1043100","ctime":1631236752,"ip_address":"","comment_id":311235,"utype":1}],"discussion_count":1,"race_medal":0,"score":"5926081118","product_id":100090001,"comment_content":"ä¸ºå•¥æˆ‘çš„ç»“æœæ˜¯å•ä¸ªå­—æ¯å‘¢ï¼Ÿ","like_count":1,"discussions":[{"author":{"id":1043100,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/ea/9c/230061e7.jpg","nickname":"å´ç£Š","note":"","ucode":"136DC8CF1B10DC","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":526533,"discussion_content":"çœ‹çœ‹åˆ†éš”ç¬¦æ˜¯ä¸æ˜¯ç”¨äº†ç©ºå­—ç¬¦ä¸²ï¼Ÿåˆ†éš”ç¬¦åº”è¯¥æ˜¯ç©ºæ ¼â€œ â€","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1631236752,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":311025,"user_name":"é’±é¹ Allen","can_delete":false,"product_type":"c1","uid":2518863,"ip_address":"","ucode":"7E95E82C0717DA","user_header":"https://static001.geekbang.org/account/avatar/00/26/6f/4f/3cf1e9c4.jpg","comment_is_top":false,"comment_ctime":1631022850,"is_pvip":true,"replies":[{"id":"112755","content":"åˆšåˆšå¼€å§‹ï¼Œéœ€è¦æ³¨æ„çš„ç»†èŠ‚ç¡®å®æ¯”è¾ƒå¤šï¼Œæ…¢æ…¢çš„å°±å¥½äº†~ ä¸€èµ·åŠ æ²¹~ ğŸ’ª","user_name":"ä½œè€…å›å¤","user_name_real":"å´ç£Š","uid":"1043100","ctime":1631090606,"ip_address":"","comment_id":311025,"utype":1}],"discussion_count":1,"race_medal":0,"score":"5925990146","product_id":100090001,"comment_content":"æ³¨æ„ç©ºæ ¼â€œ â€ï¼Œå’Œç©ºå­—ç¬¦ä¸²â€œâ€ï¼Œå‰è€…æœ‰ç©ºæ ¼ï¼Œåè€…æ²¡æœ‰<br><br>ä¹¦å†™çš„æ—¶å€™ï¼Œæ ¹æ®è‡ªå·±çš„æ–‡ä»¶æ‰€åœ¨ç›®å½•æ¥ï¼Œæ¯”å¦‚æˆ‘çš„æ˜¯ &#47;input&#47;wikiOfSpark.txt<br>ä¸è¦é—æ¼åç¼€åã€‚<br><br>å­¦ä¹ çš„è¿‡ç¨‹ï¼Œéœ€è¦ç»™è‡ªå·±ä¸€äº›è€å¿ƒå’Œé¼“åŠ±ï¼Œä¸€èµ·åŠ æ²¹æŠŠï¼","like_count":1,"discussions":[{"author":{"id":1043100,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/ea/9c/230061e7.jpg","nickname":"å´ç£Š","note":"","ucode":"136DC8CF1B10DC","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":526438,"discussion_content":"åˆšåˆšå¼€å§‹ï¼Œéœ€è¦æ³¨æ„çš„ç»†èŠ‚ç¡®å®æ¯”è¾ƒå¤šï¼Œæ…¢æ…¢çš„å°±å¥½äº†~ ä¸€èµ·åŠ æ²¹~ ğŸ’ª","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1631090606,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":310970,"user_name":"GACÂ·DU","can_delete":false,"product_type":"c1","uid":1385403,"ip_address":"","ucode":"7847FBE1C13740","user_header":"https://static001.geekbang.org/account/avatar/00/15/23/bb/a1a61f7c.jpg","comment_is_top":false,"comment_ctime":1631003916,"is_pvip":true,"replies":[{"id":"112691","content":"æ²¡é”™~ Exactlyï¼","user_name":"ä½œè€…å›å¤","user_name_real":"å´ç£Š","uid":"1043100","ctime":1631023241,"ip_address":"","comment_id":310970,"utype":1}],"discussion_count":1,"race_medal":0,"score":"5925971212","product_id":100090001,"comment_content":"Spark RDDç®—å­åˆ†ä¸ºTransformationç®—å­å’ŒActionç®—å­ï¼ŒTransformationç®—å­åŸºæœ¬ä¸Šéƒ½æ˜¯å»¶è¿Ÿè®¡ç®—ï¼Œéœ€è¦é€šè¿‡è°ƒç”¨Actionç®—å­è¿›è¡Œè§¦å‘ã€‚","like_count":1,"discussions":[{"author":{"id":1043100,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/ea/9c/230061e7.jpg","nickname":"å´ç£Š","note":"","ucode":"136DC8CF1B10DC","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":526414,"discussion_content":"æ²¡é”™~ Exactlyï¼","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1631023241,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":360792,"user_name":"Geek_f09cec","can_delete":false,"product_type":"c1","uid":3197217,"ip_address":"å¹¿ä¸œ","ucode":"789CED750CD905","user_header":"","comment_is_top":false,"comment_ctime":1666856957,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1666856957","product_id":100090001,"comment_content":"å°†â€œ${è§£å‹ç›®å½•}&#47;binâ€é…ç½®åˆ° PATH ç¯å¢ƒå˜é‡ã€‚è¿™ä¸€æ­¥ä¸æ‡‚ï¼Œåœ¨å“ªå„¿é…ç½®ï¼Œæ€ä¹ˆé…ç½®å‘¢ï¼Ÿ","like_count":0},{"had_liked":false,"id":353734,"user_name":"VenFox","can_delete":false,"product_type":"c1","uid":1002112,"ip_address":"å¹¿ä¸œ","ucode":"11F08AD5685505","user_header":"https://static001.geekbang.org/account/avatar/00/0f/4a/80/b1862ca3.jpg","comment_is_top":false,"comment_ctime":1659707991,"is_pvip":true,"discussion_count":1,"race_medal":0,"score":"1659707991","product_id":100090001,"comment_content":"è€å¸ˆï¼Œè¯·é—®ä»€ä¹ˆå«ç®—å­ï¼Ÿå¯ä»¥ç†è§£æˆå‡½æ•°å—ï¼Ÿ","like_count":0,"discussions":[{"author":{"id":2941084,"avatar":"","nickname":"Geek_ce7292","note":"","ucode":"7C89258611315E","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":583650,"discussion_content":"æµ…æµ…çš„å¸®åŠ©è€å¸ˆå›ç­”ä¸€ä¸‹ï¼Œä½ çš„ç†è§£åº”è¯¥æ˜¯æ²¡æœ‰é—®é¢˜çš„å“¦","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1660269988,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":"ä¸­å›½é¦™æ¸¯"},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":348726,"user_name":"äºšæ—","can_delete":false,"product_type":"c1","uid":1018972,"ip_address":"","ucode":"4A5A6D24314B79","user_header":"https://static001.geekbang.org/account/avatar/00/0f/8c/5c/3f164f66.jpg","comment_is_top":false,"comment_ctime":1655350132,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1655350132","product_id":100090001,"comment_content":"import org.apache.spark.SparkConf<br>import org.apache.spark.rdd.RDD<br>import org.apache.spark.sql.SparkSession<br>object Main extends App {<br>  println(&quot;Hello, World!&quot;)<br><br>  &#47;&#47; è¿™é‡Œçš„ä¸‹åˆ’çº¿&quot;_&quot;æ˜¯å ä½ç¬¦ï¼Œä»£è¡¨æ•°æ®æ–‡ä»¶çš„æ ¹ç›®å½•<br>  val rootPath: String = &quot;.&quot;<br>  val file: String = s&quot;$rootPath&#47;wikiOfSpark.txt&quot;<br><br>  val conf = new SparkConf()<br>    .setMaster(&quot;local[2]&quot;)<br>    .setAppName(&quot;Spark SQL basic example&quot;)<br><br>  val spark = SparkSession<br>    .builder()<br>    .config(conf)<br>    .getOrCreate()<br><br>  &#47;&#47; è¯»å–æ–‡ä»¶å†…å®¹<br>  val lineRDD: RDD[String] = spark.sparkContext.textFile(file)<br><br><br>  lineRDD.take(10).foreach(println)<br><br>  &#47;&#47; ä»¥è¡Œä¸ºå•ä½åšåˆ†è¯<br>  val wordRDD: RDD[String] = lineRDD.flatMap(line =&gt; line.split(&quot; &quot;))<br>  wordRDD.take(200).foreach(println)<br><br>  &#47;&#47; è¿‡æ»¤æ‰ç©ºå­—ç¬¦ä¸²<br>  val cleanWordRDD: RDD[String] = wordRDD.filter(word =&gt; !word.equals(&quot;&quot;))<br>  cleanWordRDD.take(200).foreach(println)<br><br>  &#47;&#47; æŠŠRDDå…ƒç´ è½¬æ¢ä¸ºï¼ˆKeyï¼ŒValueï¼‰çš„å½¢å¼<br>  val kvRDD: RDD[(String, Int)] = cleanWordRDD.map(word =&gt; (word, 1))<br>  kvRDD.take(10).foreach(println)<br><br>  &#47;&#47; æŒ‰ç…§å•è¯åšåˆ†ç»„è®¡æ•°<br>  val wordCounts: RDD[(String, Int)] = kvRDD.reduceByKey((x, y) =&gt; x + y)<br>  wordCounts.take(10).foreach(println)<br><br>  &#47;&#47; æ‰“å°è¯é¢‘æœ€é«˜çš„5ä¸ªè¯æ±‡<br>  val top5: Array[(Int, String)] = wordCounts.map{case (k, v) =&gt; (v, k)}.sortByKey(ascending = false).take(5)<br><br>  println(top5.mkString(&quot;Array(&quot;, &quot;, &quot;, &quot;)&quot;))<br>}","like_count":0},{"had_liked":false,"id":346893,"user_name":"easy-cloud","can_delete":false,"product_type":"c1","uid":1107744,"ip_address":"","ucode":"3067EE44DAEF40","user_header":"https://static001.geekbang.org/account/avatar/00/10/e7/20/4f78c4e4.jpg","comment_is_top":false,"comment_ctime":1653525727,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1653525727","product_id":100090001,"comment_content":"å¦‚æœè¿™ä¸ªæ–‡ä»¶æœ‰10ä¸ªtï¼Œè¿™ä¸ªæ—¶å€™å¦‚æœè¯»å–å‘€","like_count":0},{"had_liked":false,"id":346460,"user_name":"wedde","can_delete":false,"product_type":"c1","uid":1128756,"ip_address":"","ucode":"A49B1732CBE5DD","user_header":"https://static001.geekbang.org/account/avatar/00/11/39/34/10fe2b93.jpg","comment_is_top":false,"comment_ctime":1653149772,"is_pvip":false,"discussion_count":1,"race_medal":0,"score":"1653149772","product_id":100090001,"comment_content":"ä½œè€…ä½ å¥½~æˆ‘åœ¨centos6.5ä¸Šå®‰è£…spark-3.2.1-bin-hadoop3.2ã€‚ç¯å¢ƒå˜é‡éƒ½é…ç½®æ­£ç¡®äº†ã€‚è¿è¡Œspark-shell --versionå‡ºç°ä¸‹é¢æŠ¥é”™åº”è¯¥æ€ä¹ˆè§£å†³?<br>Caused by: java.net.UnknownHostException: spark: spark: No address associated with hostname<br>\tat java.net.InetAddress.getLocalHost(InetAddress.java:1506)<br>\tat org.apache.spark.util.Utils$.findLocalInetAddress(Utils.scala:1005)<br>\tat org.apache.spark.util.Utils$.localIpAddress$lzycompute(Utils.scala:998)<br>\tat org.apache.spark.util.Utils$.localIpAddress(Utils.scala:998)<br>\tat org.apache.spark.util.Utils$.$anonfun$localCanonicalHostName$1(Utils.scala:1055)<br>\tat scala.Option.getOrElse(Option.scala:189)<br>\tat org.apache.spark.util.Utils$.localCanonicalHostName(Utils.scala:1055)<br>\tat org.apache.spark.internal.config.package$.&lt;init&gt;(package.scala:990)<br>\tat org.apache.spark.internal.config.package$.&lt;clinit&gt;(package.scala)<br>\t... 10 more","like_count":0,"discussions":[{"author":{"id":1184678,"avatar":"http://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTJDgV2qia6eAL7Fb4egX3odViclRRwOlkfCBrjhU9lLeib90KGkIDjdddSibNVs47N90L36Brgnr6ppiag/132","nickname":"ddww","note":"","ucode":"2871112FC9B3F7","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":573242,"discussion_content":"ä½ çœ‹ï¼ŒæŠ¥é”™å¾ˆæ˜æ˜¾äº†ã€‚spark: spark: No address associated with hostnameã€‚æˆ‘ä¸å¤ªæ¸…æ¥šä½ è¿è¡Œæ—¶ä¼ çš„å‚æ•°é”™è¯¯ï¼Œè¿˜æ˜¯ä½ hostnameè®¾ç½®çš„é”™è¯¯","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1653290932,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":344778,"user_name":"xiong","can_delete":false,"product_type":"c1","uid":1099375,"ip_address":"","ucode":"C1BFD9EF96372F","user_header":"https://static001.geekbang.org/account/avatar/00/10/c6/6f/ac3003fa.jpg","comment_is_top":false,"comment_ctime":1651762922,"is_pvip":false,"discussion_count":1,"race_medal":0,"score":"1651762922","product_id":100090001,"comment_content":"è™½ç„¶ç°åœ¨çš„æœºå™¨è·‘ä¸åŠ¨sparkï¼Œä½†ä»ç„¶éœ€è¦å­¦ä¹ å•Šï¼Œå“ˆå“ˆ","like_count":0,"discussions":[{"author":{"id":1184678,"avatar":"http://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTJDgV2qia6eAL7Fb4egX3odViclRRwOlkfCBrjhU9lLeib90KGkIDjdddSibNVs47N90L36Brgnr6ppiag/132","nickname":"ddww","note":"","ucode":"2871112FC9B3F7","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":573243,"discussion_content":"åœ¨æœ¬åœ°è·‘å‘€ï¼Œå…¶å®æ²¡æœ‰ä»€ä¹ˆå¥½ç¥ç§˜çš„ï¼ŒæŠŠå®ƒå½“åšæ™®é€šçš„javaç¨‹åºå°±å¥½äº†ã€‚å¹¶ä¸”ï¼Œæˆ‘ä¸ä¿¡ä½ çš„ç”µè„‘æ— æ³•è¿è¡Œç®€å•çš„sparkç¨‹åº","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1653291062,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":339683,"user_name":"Spoon","can_delete":false,"product_type":"c1","uid":1959822,"ip_address":"","ucode":"2FF9193AD482C2","user_header":"https://static001.geekbang.org/account/avatar/00/1d/e7/8e/318cfde0.jpg","comment_is_top":false,"comment_ctime":1648288885,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1648288885","product_id":100090001,"comment_content":"Javaå®ç°<br>https:&#47;&#47;github.com&#47;Spoon94&#47;spark-practice&#47;blob&#47;master&#47;src&#47;main&#47;java&#47;com&#47;spoon&#47;spark&#47;core&#47;WordCountJob.java<br>&#47;&#47;top5 é¢‘ç‡å•è¯<br>List&lt;Tuple2&lt;Integer, String&gt;&gt; top5CntWordList = rawRdd.flatMap(line -&gt; Splitter.on(&quot; &quot;).splitToList(line)<br>            .iterator())<br>            .filter(word -&gt; !Strings.isNullOrEmpty(word))<br>            .mapToPair(word -&gt; Tuple2.apply(word, 1))<br>            .reduceByKey(Integer::sum)<br>            .mapToPair(Tuple2::swap)<br>            .sortByKey(false)<br>            .take(5);","like_count":0},{"had_liked":false,"id":316564,"user_name":"Luke Skywalker","can_delete":false,"product_type":"c1","uid":1799433,"ip_address":"","ucode":"5345D0407363A0","user_header":"https://static001.geekbang.org/account/avatar/00/1b/75/09/464ade1e.jpg","comment_is_top":false,"comment_ctime":1634393928,"is_pvip":false,"replies":[{"id":"114669","content":"é—®ä¸‹ç»†èŠ‚ä¿¡æ¯ï¼š<br><br>1ï¼‰ä»€ä¹ˆæ“ä½œç³»ç»Ÿï¼ˆLinuxã€Windowsã€Macï¼‰ï¼Ÿ<br>2ï¼‰æ˜¯PySparkå—ï¼Ÿ<br>3ï¼‰è¿™ä¸ªWARNæ˜¯å¦å½±å“spark-shellæ­£å¸¸è¿è¡Œï¼Ÿ<br><br>çœ‹ä¸Šå»æ˜¯ç¯å¢ƒå˜é‡è®¾ç½®é—®é¢˜ï¼Œè€å¼Ÿå†å¤šå‘äº›ç»†èŠ‚ï¼Œæˆ‘ä»¬ä¸€èµ·å†çœ‹çœ‹~","user_name":"ä½œè€…å›å¤","user_name_real":"å´ç£Š","uid":"1043100","ctime":1634533792,"ip_address":"","comment_id":316564,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1634393928","product_id":100090001,"comment_content":"è€å¸ˆï¼Œè¯·é—®æˆ‘è¿è¡Œspark-shellæ€»æ˜¯æŠ¥è¿™ä¸ªè­¦å‘Šæ˜¯ä»€ä¹ˆé—®é¢˜å‘¢ï¼Ÿæœäº†å¥½å¤šè§£å†³åŠæ³•ä¹Ÿæ²¡å»æ‰WARN ProcfsMetricsGetter: Exception when trying to compute pagesize, as a result reporting of ProcessTree metrics is stopped","like_count":0,"discussions":[{"author":{"id":1043100,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/ea/9c/230061e7.jpg","nickname":"å´ç£Š","note":"","ucode":"136DC8CF1B10DC","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":528414,"discussion_content":"é—®ä¸‹ç»†èŠ‚ä¿¡æ¯ï¼š\n\n1ï¼‰ä»€ä¹ˆæ“ä½œç³»ç»Ÿï¼ˆLinuxã€Windowsã€Macï¼‰ï¼Ÿ\n2ï¼‰æ˜¯PySparkå—ï¼Ÿ\n3ï¼‰è¿™ä¸ªWARNæ˜¯å¦å½±å“spark-shellæ­£å¸¸è¿è¡Œï¼Ÿ\n\nçœ‹ä¸Šå»æ˜¯ç¯å¢ƒå˜é‡è®¾ç½®é—®é¢˜ï¼Œè€å¼Ÿå†å¤šå‘äº›ç»†èŠ‚ï¼Œæˆ‘ä»¬ä¸€èµ·å†çœ‹çœ‹~","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1634533792,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":313200,"user_name":"Unknown element","can_delete":false,"product_type":"c1","uid":2028277,"ip_address":"","ucode":"34A129800D0238","user_header":"https://static001.geekbang.org/account/avatar/00/1e/f2/f5/b82f410d.jpg","comment_is_top":false,"comment_ctime":1632308323,"is_pvip":false,"replies":[{"id":"113468","content":"é‚£ä¸åº”è¯¥ï¼ŒSparkç‰ˆæœ¬å·å¤šå°‘ï¼Ÿ","user_name":"ä½œè€…å›å¤","user_name_real":"å´ç£Š","uid":"1043100","ctime":1632357979,"ip_address":"","comment_id":313200,"utype":1}],"discussion_count":4,"race_medal":0,"score":"1632308323","product_id":100090001,"comment_content":"å…³äºå‰å‡ å¤©é—®çš„ æ‰§è¡Œ val lineRDD: RDD[String] = spark.sparkContext.textFile(file) æŠ¥é”™error: not found: value spark çš„é—®é¢˜ï¼Œæˆ‘ç¡®å®æ˜¯åœ¨spark-shellæ‰§è¡Œçš„ï¼Œåº”è¯¥ä¸éœ€è¦æ˜¾å¼åˆ›å»ºspark-sessionå§","like_count":0,"discussions":[{"author":{"id":1043100,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/ea/9c/230061e7.jpg","nickname":"å´ç£Š","note":"","ucode":"136DC8CF1B10DC","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":527273,"discussion_content":"é‚£ä¸åº”è¯¥ï¼ŒSparkç‰ˆæœ¬å·å¤šå°‘ï¼Ÿ","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1632357979,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":2028277,"avatar":"https://static001.geekbang.org/account/avatar/00/1e/f2/f5/b82f410d.jpg","nickname":"Unknown element","note":"","ucode":"34A129800D0238","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":396433,"discussion_content":"2.2.0","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1632442577,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":2,"child_discussions":[{"author":{"id":1043100,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/ea/9c/230061e7.jpg","nickname":"å´ç£Š","note":"","ucode":"136DC8CF1B10DC","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":2028277,"avatar":"https://static001.geekbang.org/account/avatar/00/1e/f2/f5/b82f410d.jpg","nickname":"Unknown element","note":"","ucode":"34A129800D0238","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":399137,"discussion_content":"é‚£ç€å®ä¸åº”è¯¥ï¼Œspark-shellé‡Œé¢ï¼Œsparkæ˜¯é»˜è®¤çš„SparkSession instanceï¼Œç¥å¥‡äº†~","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1632910454,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":396433,"ip_address":""},"score":399137,"extra":""},{"author":{"id":1568046,"avatar":"https://static001.geekbang.org/account/avatar/00/17/ed/2e/7a171500.jpg","nickname":"Gavin_From_Mars","note":"","ucode":"B66CC36E3F8129","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":1043100,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/ea/9c/230061e7.jpg","nickname":"å´ç£Š","note":"","ucode":"136DC8CF1B10DC","race_medal":0,"user_type":2,"is_pvip":false},"discussion":{"id":565116,"discussion_content":"æˆ‘ä¹Ÿæ˜¯ç›¸åŒçš„é”™è¯¯ã€‚ã€‚ã€‚spark3.2.1ä¸€æ¨¡ä¸€æ ·çš„é”™è¯¯","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1650389763,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":399137,"ip_address":""},"score":565116,"extra":""}]}]},{"had_liked":false,"id":311912,"user_name":"zhihui","can_delete":false,"product_type":"c1","uid":1649037,"ip_address":"","ucode":"780ED9E443525F","user_header":"https://static001.geekbang.org/account/avatar/00/19/29/8d/2869a10b.jpg","comment_is_top":false,"comment_ctime":1631530171,"is_pvip":false,"replies":[{"id":"113019","content":"1. IDEä¸­éœ€è¦å¯¼å…¥Sparkçš„å¼€å‘åŒ…<br>2. éœ€è¦è¿‡æ»¤æ‰ç©ºå­—ç¬¦ä¸²ï¼šâ€œâ€ï¼ˆå°±æ˜¯79åé¢çš„â€œâ€ï¼‰","user_name":"ä½œè€…å›å¤","user_name_real":"å´ç£Š","uid":"1043100","ctime":1631544033,"ip_address":"","comment_id":311912,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1631530171","product_id":100090001,"comment_content":"1.<br>val lineRDD: RDD[String] = spark.sparkContext.textFile(file)<br>ideaä¸­ï¼ŒsparkContextæŠ¥çº¢ï¼Œæç¤º â€œvalue sparkContext is not a member of sparkâ€ã€‚<br>ä½†æ˜¯å¤åˆ¶åˆ°spark-shellå´å¯ä»¥æ‰§è¡Œã€‚<br>æˆ‘æ˜¯å†™javaçš„ï¼Œæ€»è§‰çš„è¿™æ˜¯å¯¼åŒ…é—®é¢˜ï¼Œä½†åˆæ‰¾ä¸åˆ°è¿™ä¸ªåŒ…ã€‚ä¸€è„¸æ‡µã€‚<br>2. æˆ‘æŒ‰ç…§è€å¸ˆä»£ç å†™çš„ï¼Œä¸€æ‘¸ä¸€æ ·ã€‚æ‰§è¡Œç»“æœæ˜¯Array[(Int, String)] = Array((79,&quot;&quot;), (67,the), (63,Spark), (54,a), (51,and))","like_count":0,"discussions":[{"author":{"id":1043100,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/ea/9c/230061e7.jpg","nickname":"å´ç£Š","note":"","ucode":"136DC8CF1B10DC","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":526792,"discussion_content":"1. IDEä¸­éœ€è¦å¯¼å…¥Sparkçš„å¼€å‘åŒ…\n2. éœ€è¦è¿‡æ»¤æ‰ç©ºå­—ç¬¦ä¸²ï¼šâ€œâ€ï¼ˆå°±æ˜¯79åé¢çš„â€œâ€ï¼‰","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1631544033,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":311839,"user_name":"undefined","can_delete":false,"product_type":"c1","uid":1001917,"ip_address":"","ucode":"72E03BBEF25E42","user_header":"https://static001.geekbang.org/account/avatar/00/0f/49/bd/02b20ca1.jpg","comment_is_top":false,"comment_ctime":1631501474,"is_pvip":false,"replies":[{"id":"113021","content":"Perfect~","user_name":"ä½œè€…å›å¤","user_name_real":"å´ç£Š","uid":"1043100","ctime":1631544165,"ip_address":"","comment_id":311839,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1631501474","product_id":100090001,"comment_content":"WordCountä¸­æœ‰æ¶‰åŠä¸¤ç±»ç®—å­ï¼Œé¦–å…ˆæ˜¯mapã€filterã€flatMapã€ reduceByKeyã€sortByKeyã€sortByç­‰è½¬æ¢ç®—å­ï¼Œå±äºå»¶è¿Ÿæ‰§è¡Œï¼Œéœ€è¦å¦ä¸€ç§è¡ŒåŠ¨ç®—å­è¿›è¡Œè§¦å‘ï¼Œè¡ŒåŠ¨ç®—å­åŒ…æ‹¬ï¼štakeã€countã€foreachã€collectã€first; ","like_count":0,"discussions":[{"author":{"id":1043100,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/ea/9c/230061e7.jpg","nickname":"å´ç£Š","note":"","ucode":"136DC8CF1B10DC","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":526767,"discussion_content":"Perfect~","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1631544165,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":311748,"user_name":"å·´æ™®æ´›å¤«çš„","can_delete":false,"product_type":"c1","uid":1787466,"ip_address":"","ucode":"0FE795ECA04B1D","user_header":"https://static001.geekbang.org/account/avatar/00/1b/46/4a/b0cd391e.jpg","comment_is_top":false,"comment_ctime":1631440861,"is_pvip":false,"replies":[{"id":"112952","content":"ä¸€æ­¥æ­¥è¯´å“ˆ~<br><br>map{case (k, v) =&gt; (v, k)}ï¼Œè¿™ä¸€æ­¥æ˜¯æŠŠï¼ˆKeyï¼ŒValueï¼‰å¯¹è°ƒï¼Œç›®çš„æ˜¯æŒ‰ç…§â€œè®¡æ•°â€æ¥æ’åºã€‚æ¯”å¦‚ï¼ŒåŸæ¥æ˜¯ï¼ˆSparkï¼Œ63ï¼‰ï¼Œè¿™ä¸€æ­¥ä¹‹åï¼Œè¿™æ¡è®°å½•å°±å˜æˆäº†ï¼ˆ63ï¼ŒSparkï¼‰ï¼Œä¸å¦¨æŠŠè¿™ä¸€æ­¥æ‹†è§£å¼€æ¥ï¼Œç”¨firstæ¢ç´¢ä¸€ä¸‹~<br><br>sortByKey(false) æ˜¯é™åºæ’åºï¼Œæ³¨æ„ï¼Œè¿™æ—¶å€™çš„Keyï¼Œä¸å†æ˜¯å•è¯äº†ï¼Œè€Œæ˜¯è°ƒæ¢é¡ºåºä¹‹åçš„Valueï¼ˆæ¯”å¦‚63ï¼‰ï¼Œä¹Ÿå°±æ˜¯å•è¯è®¡æ•°ã€‚<br>","user_name":"ä½œè€…å›å¤","user_name_real":"å´ç£Š","uid":"1043100","ctime":1631460925,"ip_address":"","comment_id":311748,"utype":1}],"discussion_count":2,"race_medal":0,"score":"1631440861","product_id":100090001,"comment_content":"wordCounts.map{case (k, v) =&gt; (v, k)}.sortByKey(false) <br>è¿™ä¸€æ­¥æ˜¯åšäº†ä»€ä¹ˆå‘¢ï¼Œæ²¡æœ‰è§è¿‡çš„è¯­æ³•","like_count":0,"discussions":[{"author":{"id":1043100,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/ea/9c/230061e7.jpg","nickname":"å´ç£Š","note":"","ucode":"136DC8CF1B10DC","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":526729,"discussion_content":"ä¸€æ­¥æ­¥è¯´å“ˆ~\n\nmap{case (k, v) =&amp;gt; (v, k)}ï¼Œè¿™ä¸€æ­¥æ˜¯æŠŠï¼ˆKeyï¼ŒValueï¼‰å¯¹è°ƒï¼Œç›®çš„æ˜¯æŒ‰ç…§â€œè®¡æ•°â€æ¥æ’åºã€‚æ¯”å¦‚ï¼ŒåŸæ¥æ˜¯ï¼ˆSparkï¼Œ63ï¼‰ï¼Œè¿™ä¸€æ­¥ä¹‹åï¼Œè¿™æ¡è®°å½•å°±å˜æˆäº†ï¼ˆ63ï¼ŒSparkï¼‰ï¼Œä¸å¦¨æŠŠè¿™ä¸€æ­¥æ‹†è§£å¼€æ¥ï¼Œç”¨firstæ¢ç´¢ä¸€ä¸‹~\n\nsortByKey(false) æ˜¯é™åºæ’åºï¼Œæ³¨æ„ï¼Œè¿™æ—¶å€™çš„Keyï¼Œä¸å†æ˜¯å•è¯äº†ï¼Œè€Œæ˜¯è°ƒæ¢é¡ºåºä¹‹åçš„Valueï¼ˆæ¯”å¦‚63ï¼‰ï¼Œä¹Ÿå°±æ˜¯å•è¯è®¡æ•°ã€‚\n","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1631460925,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1948015,"avatar":"https://static001.geekbang.org/account/avatar/00/1d/b9/6f/35bd9674.jpg","nickname":"TheEve","note":"","ucode":"70551999133804","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":407311,"discussion_content":"// æ‰“å°è¯é¢‘æœ€é«˜çš„5ä¸ªè¯æ±‡\n// (v, k)å¯¹è°ƒçš„å†™æ³•\nwordCounts.map { case (k, v) => (v, k) }.sortByKey(false).take(5).foreach(println)\n// (v, k)ä¸å¯¹è°ƒçš„å†™æ³•\nwordCounts.sortBy(_._2, false).take(5).foreach(println)\n\n// æ³¨ï¼šè¿™é‡Œç”¨çš„æ˜¯Scala~~","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1634977041,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":311170,"user_name":"keke","can_delete":false,"product_type":"c1","uid":1077379,"ip_address":"","ucode":"BE28B8110DF861","user_header":"https://static001.geekbang.org/account/avatar/00/10/70/83/36ab65ec.jpg","comment_is_top":false,"comment_ctime":1631093356,"is_pvip":true,"replies":[{"id":"112908","content":"æœ‰æ›´å¤šçš„æŠ¥é”™ä¿¡æ¯å—ï¼Ÿå¯ä»¥æŠŠå®Œæ•´çš„æŠ¥é”™ä¿¡æ¯è´´å‡ºæ¥ï¼Œä¸€èµ·çœ‹çœ‹~","user_name":"ä½œè€…å›å¤","user_name_real":"å´ç£Š","uid":"1043100","ctime":1631344300,"ip_address":"","comment_id":311170,"utype":1}],"discussion_count":3,"race_medal":0,"score":"1631093356","product_id":100090001,"comment_content":"æŠ¥é”™â€œæ­¤æ—¶ä¸åº”æœ‰ \\spark-3.1.2-bin-hadoop3\\bin\\..&#39;ã€‚â€æ˜¯å•¥é—®é¢˜å‘¢ï¼Ÿ","like_count":0,"discussions":[{"author":{"id":1043100,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/ea/9c/230061e7.jpg","nickname":"å´ç£Š","note":"","ucode":"136DC8CF1B10DC","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":526504,"discussion_content":"æœ‰æ›´å¤šçš„æŠ¥é”™ä¿¡æ¯å—ï¼Ÿå¯ä»¥æŠŠå®Œæ•´çš„æŠ¥é”™ä¿¡æ¯è´´å‡ºæ¥ï¼Œä¸€èµ·çœ‹çœ‹~","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1631344300,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1077379,"avatar":"https://static001.geekbang.org/account/avatar/00/10/70/83/36ab65ec.jpg","nickname":"keke","note":"","ucode":"BE28B8110DF861","race_medal":0,"user_type":1,"is_pvip":true},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":393347,"discussion_content":"å·²ç»æ‰¾åˆ°åŸå› äº†ï¼Œè·¯å¾„ä¸­ä¸èƒ½æœ‰ç©ºæ ¼ï¼Œä¹‹åè¿˜é‡åˆ°äº†javaç‰ˆæœ¬å¤ªé«˜æ¨¡å—åŒ–çš„é”™è¯¯ï¼Œéƒ½è§£å†³äº†ï¼Œsparkå·²ç»å®‰è£…å®Œäº†","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1631368735,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":1,"child_discussions":[{"author":{"id":1043100,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/ea/9c/230061e7.jpg","nickname":"å´ç£Š","note":"","ucode":"136DC8CF1B10DC","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":1077379,"avatar":"https://static001.geekbang.org/account/avatar/00/10/70/83/36ab65ec.jpg","nickname":"keke","note":"","ucode":"BE28B8110DF861","race_medal":0,"user_type":1,"is_pvip":true},"discussion":{"id":394263,"discussion_content":"Cool","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1631804951,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":393347,"ip_address":""},"score":394263,"extra":""}]}]},{"had_liked":false,"id":311097,"user_name":"å¤§å¿—","can_delete":false,"product_type":"c1","uid":1039047,"ip_address":"","ucode":"648335930C2E55","user_header":"https://static001.geekbang.org/account/avatar/00/0f/da/c7/66f5fcea.jpg","comment_is_top":false,"comment_ctime":1631071163,"is_pvip":false,"replies":[{"id":"112756","content":"èµ~ ğŸ‘ åŠŸå¤«ä¸è´Ÿæœ‰å¿ƒäººï¼","user_name":"ä½œè€…å›å¤","user_name_real":"å´ç£Š","uid":"1043100","ctime":1631090682,"ip_address":"","comment_id":311097,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1631071163","product_id":100090001,"comment_content":"Win10ç³»ç»Ÿåˆè£…äº†Hadoopï¼Œå¹¶ä¸‹è½½äº†winutils.exeè¿™ä¸ªæ–‡ä»¶æ”¾åˆ°Hadoop binç›®å½•ä¸‹ï¼Œæ¢æˆäº†spark-2.4.6-bin-hadoop2.7è¿è¡Œspark-shellç»ˆäºä¸æŠ¥é”™äº†ã€‚Windowsä¸‹æ–‡ä»¶è·¯å¾„å†™æ³•val file: String = s&quot;file:&#47;&#47;&#47;D:&#47;wikiOfSpark.txt&quot;","like_count":0,"discussions":[{"author":{"id":1043100,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/ea/9c/230061e7.jpg","nickname":"å´ç£Š","note":"","ucode":"136DC8CF1B10DC","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":526473,"discussion_content":"èµ~ ğŸ‘ åŠŸå¤«ä¸è´Ÿæœ‰å¿ƒäººï¼","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1631090682,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":310954,"user_name":"JavaXu","can_delete":false,"product_type":"c1","uid":2758135,"ip_address":"","ucode":"B2EBC7BEEF4D1C","user_header":"https://static001.geekbang.org/account/avatar/00/2a/15/f7/aba61f1b.jpg","comment_is_top":false,"comment_ctime":1630999446,"is_pvip":false,"replies":[{"id":"112692","content":"è®²é“ç†Scalaæ˜¯éœ€è¦å•ç‹¬å®‰è£…çš„ï¼Œç¥å¥‡~ ä¸è¿‡æ²¡å…³ç³»ï¼Œspark-shellå¥½ä½¿å°±è¡Œï¼Œé‡ç‚¹æ˜¯åº”ç”¨å¼€å‘ï¼Œæˆ‘ä»¬ä¸å¦¨æš‚ä¸”æŠŠæ³¨æ„åŠ›å…ˆæ”¾åˆ°ä»£ç ä¸Š~ ","user_name":"ä½œè€…å›å¤","user_name_real":"å´ç£Š","uid":"1043100","ctime":1631023550,"ip_address":"","comment_id":310954,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1630999446","product_id":100090001,"comment_content":"åœ¨macOSä¸Šï¼Œä¼¼ä¹é»˜è®¤å®‰è£…äº†scalaã€‚<br>æ€»ä¹‹æˆ‘å®‰è£…äº†sparkä¹‹åï¼Œspark-shellï¼Œç„¶åé”®å…¥ä»£ç ï¼Œå¯ä»¥æ‰§è¡Œå¹¶å¾—åˆ°ç»“æœã€‚<br><br>æˆ–è€…æ˜¯æˆ‘å®‰è£…çš„sparkåŒ…ï¼Œé‡Œé¢è‡ªå¸¦äº†scalaï¼Ÿ","like_count":0,"discussions":[{"author":{"id":1043100,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/ea/9c/230061e7.jpg","nickname":"å´ç£Š","note":"","ucode":"136DC8CF1B10DC","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":526412,"discussion_content":"è®²é“ç†Scalaæ˜¯éœ€è¦å•ç‹¬å®‰è£…çš„ï¼Œç¥å¥‡~ ä¸è¿‡æ²¡å…³ç³»ï¼Œspark-shellå¥½ä½¿å°±è¡Œï¼Œé‡ç‚¹æ˜¯åº”ç”¨å¼€å‘ï¼Œæˆ‘ä»¬ä¸å¦¨æš‚ä¸”æŠŠæ³¨æ„åŠ›å…ˆæ”¾åˆ°ä»£ç ä¸Š~ ","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1631023550,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":310941,"user_name":"Qilin Lou","can_delete":false,"product_type":"c1","uid":1031075,"ip_address":"","ucode":"29AD43329E7404","user_header":"https://static001.geekbang.org/account/avatar/00/0f/bb/a3/af469d27.jpg","comment_is_top":false,"comment_ctime":1630995668,"is_pvip":false,"replies":[{"id":"112694","content":"å¥½é—®é¢˜ï¼Œæˆ‘ä¹Ÿæ˜¯è¿™ä¹ˆæƒ³ï¼Œå…¶å®æ”¯æŒä¸ªfilterNotä¸æ˜¯ä»€ä¹ˆéš¾äº‹ï¼Œä¸çŸ¥é“ä¸ºä»€ä¹ˆSparkç¤¾åŒºæ²¡æœ‰æä¾›è¿™ä¸ªç®—å­ã€‚æˆ‘çŒœå¯èƒ½æ˜¯æ‰§ç€äºâ€œæå®¢ç²¾ç¥â€ï¼Œè§‰å¾—filterèƒ½å®ç°çš„åŠŸèƒ½ï¼Œæ²¡å¿…è¦å†å¤šæ·»ä¸ªç®—å­~","user_name":"ä½œè€…å›å¤","user_name_real":"å´ç£Š","uid":"1043100","ctime":1631023717,"ip_address":"","comment_id":310941,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1630995668","product_id":100090001,"comment_content":"æˆ‘å…¶å®æ¯”è¾ƒå–œæ¬¢ç”¨filterNotï¼Œè¿™æ ·é‡Œé¢çš„å‡½æ•°å°±ä¸ç”¨å–åï¼Œä¸è¿‡Sparké‡Œå±…ç„¶æ²¡æœ‰æä¾›","like_count":0,"discussions":[{"author":{"id":1043100,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/ea/9c/230061e7.jpg","nickname":"å´ç£Š","note":"","ucode":"136DC8CF1B10DC","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":526410,"discussion_content":"å¥½é—®é¢˜ï¼Œæˆ‘ä¹Ÿæ˜¯è¿™ä¹ˆæƒ³ï¼Œå…¶å®æ”¯æŒä¸ªfilterNotä¸æ˜¯ä»€ä¹ˆéš¾äº‹ï¼Œä¸çŸ¥é“ä¸ºä»€ä¹ˆSparkç¤¾åŒºæ²¡æœ‰æä¾›è¿™ä¸ªç®—å­ã€‚æˆ‘çŒœå¯èƒ½æ˜¯æ‰§ç€äºâ€œæå®¢ç²¾ç¥â€ï¼Œè§‰å¾—filterèƒ½å®ç°çš„åŠŸèƒ½ï¼Œæ²¡å¿…è¦å†å¤šæ·»ä¸ªç®—å­~","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1631023717,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":310871,"user_name":"Qilin Lou","can_delete":false,"product_type":"c1","uid":1031075,"ip_address":"","ucode":"29AD43329E7404","user_header":"https://static001.geekbang.org/account/avatar/00/0f/bb/a3/af469d27.jpg","comment_is_top":false,"comment_ctime":1630940604,"is_pvip":false,"replies":[{"id":"112674","content":"å“ˆå“ˆï¼ŒJavaã€Scalaå®‰è£…æ¯”è¾ƒç®€å•ï½ spark-shelléœ€è¦ç”¨åˆ°","user_name":"ä½œè€…å›å¤","user_name_real":"å´ç£Š","uid":"1043100","ctime":1630986991,"ip_address":"","comment_id":310871,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1630940604","product_id":100090001,"comment_content":"å¤§æ„äº†ï¼Œæ²¡æƒ³åˆ°ç”¨çš„æ˜¯ä¸€å°æ–°ç”µè„‘ï¼Œè¿˜å¾—å…ˆè£…Java Runtime","like_count":0,"discussions":[{"author":{"id":1043100,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/ea/9c/230061e7.jpg","nickname":"å´ç£Š","note":"","ucode":"136DC8CF1B10DC","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":526383,"discussion_content":"å“ˆå“ˆï¼ŒJavaã€Scalaå®‰è£…æ¯”è¾ƒç®€å•ï½ spark-shelléœ€è¦ç”¨åˆ°","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1630986991,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":310835,"user_name":"StÃ©phane èƒ¡","can_delete":false,"product_type":"c1","uid":2757945,"ip_address":"","ucode":"BACE52B2E1C3E1","user_header":"https://static001.geekbang.org/account/avatar/00/2a/15/39/095dc1c2.jpg","comment_is_top":false,"comment_ctime":1630928952,"is_pvip":false,"replies":[{"id":"112635","content":"è®²é“ç†æ˜¯å‘¨ä¸€ã€å‘¨ä¸‰ã€å‘¨äº”å„æ›´ä¸€ç¯‡ï¼Œä¸è¿‡ä»Šå¤©ä¸Šçº¿æˆ‘ç†è§£æ˜¯é¢„å”®ï¼Œæ‰€ä»¥è¿™å‘¨ä¸‰ã€å‘¨äº”æš‚ä¸æ›´æ–°ã€‚ä»ä¸‹å‘¨å¼€å§‹ï¼Œæ¯å‘¨ä¸€ã€å‘¨ä¸‰ã€å‘¨äº”å„æ›´ä¸€ç¯‡å“ˆ~","user_name":"ä½œè€…å›å¤","user_name_real":"å´ç£Š","uid":"1043100","ctime":1630937288,"ip_address":"","comment_id":310835,"utype":1}],"discussion_count":5,"race_medal":0,"score":"1630928952","product_id":100090001,"comment_content":"æ‚¨å¥½è€å¸ˆï¼Œè¯·é—®ä¸€ä¸‹å¤šä¹…ä¼šæ›´æ–°ä¸€è®²å‘¢ï¼Ÿ","like_count":0,"discussions":[{"author":{"id":1043100,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/ea/9c/230061e7.jpg","nickname":"å´ç£Š","note":"","ucode":"136DC8CF1B10DC","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":526373,"discussion_content":"è®²é“ç†æ˜¯å‘¨ä¸€ã€å‘¨ä¸‰ã€å‘¨äº”å„æ›´ä¸€ç¯‡ï¼Œä¸è¿‡ä»Šå¤©ä¸Šçº¿æˆ‘ç†è§£æ˜¯é¢„å”®ï¼Œæ‰€ä»¥è¿™å‘¨ä¸‰ã€å‘¨äº”æš‚ä¸æ›´æ–°ã€‚ä»ä¸‹å‘¨å¼€å§‹ï¼Œæ¯å‘¨ä¸€ã€å‘¨ä¸‰ã€å‘¨äº”å„æ›´ä¸€ç¯‡å“ˆ~","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1630937288,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1058183,"avatar":"https://static001.geekbang.org/account/avatar/00/10/25/87/f3a69d1b.jpg","nickname":"peter","note":"","ucode":"261C3FC001DE2D","race_medal":0,"user_type":1,"is_pvip":true},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":392562,"discussion_content":"å´è€å¸ˆï¼šè¯·æ•™å¦å¤–ä¸€ä¸ªé—®é¢˜ï¼šæœ¬è¯¾ç¨‹æœ‰å¾®ä¿¡å­¦ä¹ ç¾¤å—ï¼Ÿæˆ‘åœ¨PCæ®µç™»å½•æå®¢æ—¶é—´ï¼Œåœ¨â€œè¯¾ç¨‹ä»‹ç»â€é‡Œé¢æ²¡æœ‰å‘ç°å…³äºå¾®ä¿¡å­¦ä¹ ç¾¤çš„ä¿¡æ¯ã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1631061346,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":1,"child_discussions":[{"author":{"id":1043100,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/ea/9c/230061e7.jpg","nickname":"å´ç£Š","note":"","ucode":"136DC8CF1B10DC","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":1058183,"avatar":"https://static001.geekbang.org/account/avatar/00/10/25/87/f3a69d1b.jpg","nickname":"peter","note":"","ucode":"261C3FC001DE2D","race_medal":0,"user_type":1,"is_pvip":true},"discussion":{"id":392670,"discussion_content":"ä¹‹åè¿è¥åŒå­¦ä¼šå¸®å¿™æ‹‰ä¸ªå­¦ä¹ ç¾¤~ ","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1631093711,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":392562,"ip_address":""},"score":392670,"extra":""}]},{"author":{"id":1058183,"avatar":"https://static001.geekbang.org/account/avatar/00/10/25/87/f3a69d1b.jpg","nickname":"peter","note":"","ucode":"261C3FC001DE2D","race_medal":0,"user_type":1,"is_pvip":true},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":392557,"discussion_content":"å´è€å¸ˆï¼šæ‚¨çš„è¯¾å¾ˆå¥½ï¼Œç‚¹èµï¼ï¼ï¼è¯·æ•™ä¸€ä¸ªå…³äºç¯å¢ƒçš„é—®é¢˜ï¼šä»¥å‰å­¦hadoopçš„æ—¶å€™ï¼Œéœ€è¦å¾ˆå¤šå°æœºå™¨ã€‚æˆ‘æ˜¯åœ¨è‡ªå·±çš„ç¬”è®°æœ¬ç”µè„‘ä¸Šæ­å»ºè™šæ‹Ÿæœºï¼ˆlinuxï¼‰ï¼Œå°è±¡ä¸­ç¯å¢ƒæ­å»ºæ¯”è¾ƒéº»çƒ¦ã€‚ è¯·é—®ï¼šæœ¬è¯¾ç¨‹åç»­å†…å®¹ï¼Œæ˜¯å¦ä¼šè¦æ±‚æ­å»ºå¤šå°è™šæ‹Ÿæœºï¼Ÿ","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1631060131,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":1,"child_discussions":[{"author":{"id":1043100,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/ea/9c/230061e7.jpg","nickname":"å´ç£Š","note":"","ucode":"136DC8CF1B10DC","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":1058183,"avatar":"https://static001.geekbang.org/account/avatar/00/10/25/87/f3a69d1b.jpg","nickname":"peter","note":"","ucode":"261C3FC001DE2D","race_medal":0,"user_type":1,"is_pvip":true},"discussion":{"id":392672,"discussion_content":"ä¸éœ€è¦çš„~ è€ƒè™‘åˆ°å¤§å®¶æœ‰å¯èƒ½ä¸æ–¹ä¾¿æ­å»ºåˆ†å¸ƒå¼ç¯å¢ƒï¼Œæ‰€ä»¥å’±ä»¬çš„é¡¹ç›®åœ¨é€‰å‹çš„æ—¶å€™ï¼Œå°±åªé€‰æ‹©é‚£äº›åœ¨å•æœºç¯å¢ƒå°±å¯ä»¥è·‘çš„~","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1631093819,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":392557,"ip_address":""},"score":392672,"extra":""}]}]}]}