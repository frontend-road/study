{"id":111600,"title":"31 | è£…é¥°å™¨æ¨¡å¼ï¼šå¦‚ä½•ä¼˜åŒ–ç”µå•†ç³»ç»Ÿä¸­å¤æ‚çš„å•†å“ä»·æ ¼ç­–ç•¥ï¼Ÿ","content":"<p>ä½ å¥½ï¼Œæˆ‘æ˜¯åˆ˜è¶…ã€‚</p><p>å¼€å§‹ä»Šå¤©çš„å­¦ä¹ ä¹‹å‰ï¼Œæˆ‘æƒ³å…ˆè¯·ä½ æ€è€ƒä¸€ä¸ªé—®é¢˜ã€‚å‡è®¾ç°åœ¨æœ‰è¿™æ ·ä¸€ä¸ªéœ€æ±‚ï¼Œè®©ä½ è®¾è®¡ä¸€ä¸ªè£…ä¿®åŠŸèƒ½ï¼Œç”¨æˆ·å¯ä»¥åŠ¨æ€é€‰æ‹©ä¸åŒçš„è£…ä¿®åŠŸèƒ½æ¥è£…é¥°è‡ªå·±çš„æˆ¿å­ã€‚ä¾‹å¦‚ï¼Œæ°´ç”µè£…ä¿®ã€å¤©èŠ±æ¿ä»¥åŠç²‰åˆ·å¢™ç­‰å±äºåŸºæœ¬åŠŸèƒ½ï¼Œè€Œè®¾è®¡çª—å¸˜è£…é¥°çª—æˆ·ã€è®¾è®¡åŠé¡¶è£…é¥°æˆ¿é¡¶ç­‰æœªå¿…æ˜¯æ‰€æœ‰ç”¨æˆ·éƒ½éœ€è¦çš„ï¼Œè¿™äº›åŠŸèƒ½åˆ™éœ€è¦å®ç°åŠ¨æ€æ·»åŠ ã€‚è¿˜æœ‰å°±æ˜¯ä¸€æ—¦æœ‰æ–°çš„è£…ä¿®åŠŸèƒ½ï¼Œæˆ‘ä»¬ä¹Ÿå¯ä»¥å®ç°åŠ¨æ€æ·»åŠ ã€‚å¦‚æœè¦ä½ æ¥è´Ÿè´£ï¼Œä½ ä¼šæ€ä¹ˆè®¾è®¡å‘¢ï¼Ÿ</p><p>æ­¤æ—¶ä½ å¯èƒ½ä¼šæƒ³äº†ï¼Œé€šå¸¸ç»™ä¸€ä¸ªå¯¹è±¡æ·»åŠ åŠŸèƒ½ï¼Œè¦ä¹ˆç›´æ¥ä¿®æ”¹ä»£ç ï¼Œåœ¨å¯¹è±¡ä¸­æ·»åŠ ç›¸åº”çš„åŠŸèƒ½ï¼Œè¦ä¹ˆæ´¾ç”Ÿå¯¹åº”çš„å­ç±»æ¥æ‰©å±•ã€‚ç„¶è€Œï¼Œå‰è€…æ¯æ¬¡éƒ½éœ€è¦ä¿®æ”¹å¯¹è±¡çš„ä»£ç ï¼Œè¿™æ˜¾ç„¶ä¸æ˜¯ç†æƒ³çš„é¢å‘å¯¹è±¡è®¾è®¡ï¼Œå³ä¾¿åè€…æ˜¯é€šè¿‡æ´¾ç”Ÿå¯¹åº”çš„å­ç±»æ¥æ‰©å±•ï¼Œä¹Ÿå¾ˆéš¾æ»¡è¶³å¤æ‚çš„éšæ„ç»„åˆåŠŸèƒ½éœ€æ±‚ã€‚</p><p>é¢å¯¹è¿™ç§æƒ…å†µï¼Œä½¿ç”¨è£…é¥°å™¨æ¨¡å¼åº”è¯¥å†åˆé€‚ä¸è¿‡äº†ã€‚å®ƒçš„ä¼˜åŠ¿æˆ‘æƒ³ä½ å¤šå°‘çŸ¥é“ä¸€ç‚¹ï¼Œæˆ‘åœ¨è¿™é‡Œæ€»ç»“ä¸€ä¸‹ã€‚</p><p>è£…é¥°å™¨æ¨¡å¼èƒ½å¤Ÿå®ç°ä¸ºå¯¹è±¡åŠ¨æ€æ·»åŠ è£…ä¿®åŠŸèƒ½ï¼Œå®ƒæ˜¯ä»ä¸€ä¸ªå¯¹è±¡çš„å¤–éƒ¨æ¥ç»™å¯¹è±¡æ·»åŠ åŠŸèƒ½ï¼Œæ‰€ä»¥æœ‰éå¸¸çµæ´»çš„æ‰©å±•æ€§ï¼Œæˆ‘ä»¬å¯ä»¥åœ¨å¯¹åŸæ¥çš„ä»£ç æ¯«æ— ä¿®æ”¹çš„å‰æä¸‹ï¼Œä¸ºå¯¹è±¡æ·»åŠ æ–°åŠŸèƒ½ã€‚é™¤æ­¤ä¹‹å¤–ï¼Œè£…é¥°å™¨æ¨¡å¼è¿˜èƒ½å¤Ÿå®ç°å¯¹è±¡çš„åŠ¨æ€ç»„åˆï¼Œå€Ÿæ­¤æˆ‘ä»¬å¯ä»¥å¾ˆçµæ´»åœ°ç»™åŠ¨æ€ç»„åˆçš„å¯¹è±¡ï¼ŒåŒ¹é…æ‰€éœ€è¦çš„åŠŸèƒ½ã€‚</p><p>ä¸‹é¢æˆ‘ä»¬å°±é€šè¿‡å®è·µï¼Œå…·ä½“çœ‹çœ‹è¯¥æ¨¡å¼çš„ä¼˜åŠ¿ã€‚</p><!-- [[[read_end]]] --><h2>ä»€ä¹ˆæ˜¯è£…é¥°å™¨æ¨¡å¼ï¼Ÿ</h2><p>åœ¨è¿™ä¹‹å‰ï¼Œæˆ‘å…ˆç®€å•ä»‹ç»ä¸‹ä»€ä¹ˆæ˜¯è£…é¥°å™¨æ¨¡å¼ã€‚è£…é¥°å™¨æ¨¡å¼åŒ…æ‹¬äº†ä»¥ä¸‹å‡ ä¸ªè§’è‰²ï¼šæ¥å£ã€å…·ä½“å¯¹è±¡ã€è£…é¥°ç±»ã€å…·ä½“è£…é¥°ç±»ã€‚</p><p>æ¥å£å®šä¹‰äº†å…·ä½“å¯¹è±¡çš„ä¸€äº›å®ç°æ–¹æ³•ï¼›å…·ä½“å¯¹è±¡å®šä¹‰äº†ä¸€äº›åˆå§‹åŒ–æ“ä½œï¼Œæ¯”å¦‚å¼€å¤´è®¾è®¡è£…ä¿®åŠŸèƒ½çš„æ¡ˆä¾‹ä¸­ï¼Œæ°´ç”µè£…ä¿®ã€å¤©èŠ±æ¿ä»¥åŠç²‰åˆ·å¢™ç­‰éƒ½æ˜¯åˆå§‹åŒ–æ“ä½œï¼›è£…é¥°ç±»åˆ™æ˜¯ä¸€ä¸ªæŠ½è±¡ç±»ï¼Œä¸»è¦ç”¨æ¥åˆå§‹åŒ–å…·ä½“å¯¹è±¡çš„ä¸€ä¸ªç±»ï¼›å…¶å®ƒçš„å…·ä½“è£…é¥°ç±»éƒ½ç»§æ‰¿äº†è¯¥æŠ½è±¡ç±»ã€‚</p><p>ä¸‹é¢æˆ‘ä»¬å°±é€šè¿‡è£…é¥°å™¨æ¨¡å¼æ¥å®ç°ä¸‹è£…ä¿®åŠŸèƒ½ï¼Œä»£ç å¦‚ä¸‹ï¼š</p><pre><code>/**\n * å®šä¹‰ä¸€ä¸ªåŸºæœ¬è£…ä¿®æ¥å£\n * @author admin\n *\n */\npublic interface IDecorator {\n\t\n\t/**\n\t * è£…ä¿®æ–¹æ³•\n\t */\n\tvoid decorate();\n\n}\n</code></pre><pre><code>/**\n * è£…ä¿®åŸºæœ¬ç±»\n * @author admin\n *\n */\npublic class Decorator implements IDecorator{\n\n\t/**\n\t * åŸºæœ¬å®ç°æ–¹æ³•\n\t */\n\tpublic void decorate() {\n\t\tSystem.out.println(&quot;æ°´ç”µè£…ä¿®ã€å¤©èŠ±æ¿ä»¥åŠç²‰åˆ·å¢™ã€‚ã€‚ã€‚&quot;);\n\t}\n\n}\n</code></pre><pre><code>/**\n * åŸºæœ¬è£…é¥°ç±»\n * @author admin\n *\n */\npublic abstract class BaseDecorator implements IDecorator{\n\n\tprivate IDecorator decorator;\n\t\n\tpublic BaseDecorator(IDecorator decorator) {\n\t\tthis.decorator = decorator;\n\t}\n\t\n\t/**\n\t * è°ƒç”¨è£…é¥°æ–¹æ³•\n\t */\n\tpublic void decorate() {\n\t\tif(decorator != null) {\n\t\t\tdecorator.decorate();\n\t\t}\n\t}\n}\n</code></pre><pre><code>/**\n * çª—å¸˜è£…é¥°ç±»\n * @author admin\n *\n */\npublic class CurtainDecorator extends BaseDecorator{\n\n\tpublic CurtainDecorator(IDecorator decorator) {\n\t\tsuper(decorator);\n\t}\n\t\n\t/**\n\t * çª—å¸˜å…·ä½“è£…é¥°æ–¹æ³•\n\t */\n\t@Override\n\tpublic void decorate() {\n\t\tSystem.out.println(&quot;çª—å¸˜è£…é¥°ã€‚ã€‚ã€‚&quot;);\n\t\tsuper.decorate();\n\t}\n\n}\n</code></pre><pre><code>    public static void main( String[] args )\n    {\n    \tIDecorator decorator = new Decorator();\n    \tIDecorator curtainDecorator = new CurtainDecorator(decorator);\n    \tcurtainDecorator.decorate();\n        \n    }\n</code></pre><p>è¿è¡Œç»“æœï¼š</p><pre><code>çª—å¸˜è£…é¥°ã€‚ã€‚ã€‚\næ°´ç”µè£…ä¿®ã€å¤©èŠ±æ¿ä»¥åŠç²‰åˆ·å¢™ã€‚ã€‚ã€‚\n</code></pre><p>é€šè¿‡è¿™ä¸ªæ¡ˆä¾‹ï¼Œæˆ‘ä»¬å¯ä»¥äº†è§£åˆ°ï¼šå¦‚æœæˆ‘ä»¬æƒ³è¦åœ¨åŸºç¡€ç±»ä¸Šæ·»åŠ æ–°çš„è£…ä¿®åŠŸèƒ½ï¼Œåªéœ€è¦åŸºäºæŠ½è±¡ç±»BaseDecoratorå»å®ç°ç»§æ‰¿ç±»ï¼Œé€šè¿‡æ„é€ å‡½æ•°è°ƒç”¨çˆ¶ç±»ï¼Œä»¥åŠé‡å†™è£…ä¿®æ–¹æ³•å®ç°è£…ä¿®çª—å¸˜çš„åŠŸèƒ½å³å¯ã€‚åœ¨mainå‡½æ•°ä¸­ï¼Œæˆ‘ä»¬é€šè¿‡å®ä¾‹åŒ–è£…é¥°ç±»ï¼Œè°ƒç”¨è£…ä¿®æ–¹æ³•ï¼Œå³å¯åœ¨åŸºç¡€è£…ä¿®çš„å‰æä¸‹ï¼Œè·å¾—çª—å¸˜è£…ä¿®åŠŸèƒ½ã€‚</p><p>åŸºäºè£…é¥°å™¨æ¨¡å¼å®ç°çš„è£…ä¿®åŠŸèƒ½çš„ä»£ç ç»“æ„ç®€æ´æ˜“è¯»ï¼Œä¸šåŠ¡é€»è¾‘ä¹Ÿéå¸¸æ¸…æ™°ï¼Œå¹¶ä¸”å¦‚æœæˆ‘ä»¬éœ€è¦æ‰©å±•æ–°çš„è£…ä¿®åŠŸèƒ½ï¼Œåªéœ€è¦æ–°å¢ä¸€ä¸ªç»§æ‰¿äº†æŠ½è±¡è£…é¥°ç±»çš„å­ç±»å³å¯ã€‚</p><p>åœ¨è¿™ä¸ªæ¡ˆä¾‹ä¸­ï¼Œæˆ‘ä»¬ä»…å®ç°äº†ä¸šåŠ¡æ‰©å±•åŠŸèƒ½ï¼Œæ¥ä¸‹æ¥ï¼Œæˆ‘å°†é€šè¿‡è£…é¥°å™¨æ¨¡å¼ä¼˜åŒ–ç”µå•†ç³»ç»Ÿä¸­çš„å•†å“ä»·æ ¼ç­–ç•¥ï¼Œå®ç°ä¸åŒä¿ƒé”€æ´»åŠ¨çš„çµæ´»ç»„åˆã€‚</p><h2>ä¼˜åŒ–ç”µå•†ç³»ç»Ÿä¸­çš„å•†å“ä»·æ ¼ç­–ç•¥</h2><p>ç›¸ä¿¡ä½ ä¸€å®šä¸é™Œç”Ÿï¼Œè´­ä¹°å•†å“æ—¶ç»å¸¸ä¼šç”¨åˆ°çš„é™æ—¶æŠ˜æ‰£ã€çº¢åŒ…ã€æŠµæ‰£åˆ¸ä»¥åŠç‰¹æ®ŠæŠµæ‰£é‡‘ç­‰ï¼Œç§ç±»å¾ˆå¤šï¼Œå¦‚æœæ¢åˆ°å¼€å‘è§†è§’ï¼Œå®ç°èµ·æ¥å°±æ›´å¤æ‚äº†ã€‚</p><p>ä¾‹å¦‚ï¼Œæ¯é€¢åŒåä¸€ï¼Œä¸ºäº†åŠ å¤§å•†åŸçš„ä¼˜æƒ åŠ›åº¦ï¼Œå¼€å‘å¾€å¾€è¦è®¾è®¡çº¢åŒ…+é™æ—¶æŠ˜æ‰£æˆ–çº¢åŒ…+æŠµæ‰£åˆ¸ç­‰ç»„åˆæ¥å®ç°å¤šé‡ä¼˜æƒ ã€‚è€Œåœ¨å¹³æ—¶ï¼Œç”±äºæŸäº›ç‰¹æ®ŠåŸå› ï¼Œå•†å®¶è¿˜ä¼šèµ é€ç‰¹æ®ŠæŠµæ‰£åˆ¸ç»™è´­ä¹°ç”¨æˆ·ï¼Œè€Œç‰¹æ®ŠæŠµæ‰£åˆ¸+å„ç§ä¼˜æƒ åˆæ˜¯å¦ä¸€ç§ç»„åˆæ–¹å¼ã€‚</p><p>è¦å®ç°ä»¥ä¸Šè¿™ç±»ç»„åˆä¼˜æƒ çš„åŠŸèƒ½ï¼Œæœ€å¿«ã€æœ€æ™®éçš„å®ç°æ–¹å¼å°±æ˜¯é€šè¿‡å¤§é‡if-elseçš„æ–¹å¼æ¥å®ç°ã€‚ä½†è¿™ç§æ–¹å¼åŒ…å«äº†å¤§é‡çš„é€»è¾‘åˆ¤æ–­ï¼Œè‡´ä½¿å…¶ä»–å¼€å‘äººå‘˜å¾ˆéš¾è¯»æ‡‚ä¸šåŠ¡ï¼Œ å¹¶ä¸”ä¸€æ—¦æœ‰æ–°çš„ä¼˜æƒ ç­–ç•¥æˆ–è€…ä»·æ ¼ç»„åˆç­–ç•¥å‡ºç°ï¼Œå°±éœ€è¦ä¿®æ”¹ä»£ç é€»è¾‘ã€‚</p><p>è¿™æ—¶ï¼Œåˆšåˆšä»‹ç»çš„è£…é¥°å™¨æ¨¡å¼å°±å¾ˆé€‚åˆç”¨åœ¨è¿™é‡Œï¼Œå…¶ç›¸äº’ç‹¬ç«‹ã€è‡ªç”±ç»„åˆä»¥åŠæ–¹ä¾¿åŠ¨æ€æ‰©å±•åŠŸèƒ½çš„ç‰¹æ€§ï¼Œå¯ä»¥å¾ˆå¥½åœ°è§£å†³if-elseæ–¹å¼çš„å¼Šç«¯ã€‚ä¸‹é¢æˆ‘ä»¬å°±ç”¨è£…é¥°å™¨æ¨¡å¼åŠ¨æ‰‹å®ç°ä¸€å¥—å•†å“ä»·æ ¼ç­–ç•¥çš„ä¼˜åŒ–æ–¹æ¡ˆã€‚</p><p>é¦–å…ˆï¼Œæˆ‘ä»¬å…ˆå»ºç«‹è®¢å•å’Œå•†å“çš„å±æ€§ç±»ï¼Œåœ¨æœ¬æ¬¡æ¡ˆä¾‹ä¸­ï¼Œä¸ºäº†ä¿è¯ç®€æ´æ€§ï¼Œæˆ‘åªå»ºç«‹äº†å‡ ä¸ªå…³é”®å­—æ®µã€‚ä»¥ä¸‹å‡ ä¸ªé‡è¦å±æ€§å…³ç³»ä¸ºï¼Œä¸»è®¢å•åŒ…å«è‹¥å¹²è¯¦ç»†è®¢å•ï¼Œè¯¦ç»†è®¢å•ä¸­è®°å½•äº†å•†å“ä¿¡æ¯ï¼Œå•†å“ä¿¡æ¯ä¸­åŒ…å«äº†ä¿ƒé”€ç±»å‹ä¿¡æ¯ï¼Œä¸€ä¸ªå•†å“å¯ä»¥åŒ…å«å¤šä¸ªä¿ƒé”€ç±»å‹ï¼ˆæœ¬æ¡ˆä¾‹åªè®¨è®ºå•ä¸ªä¿ƒé”€å’Œç»„åˆä¿ƒé”€ï¼‰ï¼š</p><pre><code>/**\n * ä¸»è®¢å•\n * @author admin\n *\n */\npublic class Order {\n\t\n\tprivate int id; //è®¢å•ID\n\tprivate String orderNo; //è®¢å•å·\n\tprivate BigDecimal totalPayMoney; //æ€»æ”¯ä»˜é‡‘é¢\n\tprivate List&lt;OrderDetail&gt; list; //è¯¦ç»†è®¢å•åˆ—è¡¨\n}\n</code></pre><pre><code>/**\n * è¯¦ç»†è®¢å•\n * @author admin\n *\n */\npublic class OrderDetail {\n\tprivate int id; //è¯¦ç»†è®¢å•ID\n\tprivate int orderId;//ä¸»è®¢å•ID\n\tprivate Merchandise merchandise; //å•†å“è¯¦æƒ…\n\tprivate BigDecimal payMoney; //æ”¯ä»˜å•ä»·\n}\n</code></pre><pre><code>/**\n * å•†å“\n * @author admin\n *\n */\npublic class Merchandise {\n\t\n\tprivate String sku;//å•†å“SKU\n\tprivate String name; //å•†å“åç§°\n\tprivate BigDecimal price; //å•†å“å•ä»·\n\tprivate Map&lt;PromotionType, SupportPromotions&gt; supportPromotions; //æ”¯æŒä¿ƒé”€ç±»å‹\n}\n</code></pre><pre><code>/**\n * ä¿ƒé”€ç±»å‹\n * @author admin\n *\n */\npublic class SupportPromotions implements Cloneable{\n\n\tprivate int id;//è¯¥å•†å“ä¿ƒé”€çš„ID\n\tprivate PromotionType promotionType;//ä¿ƒé”€ç±»å‹ 1\\ä¼˜æƒ åˆ¸ 2\\çº¢åŒ…\n\tprivate int priority; //ä¼˜å…ˆçº§\n\tprivate UserCoupon userCoupon; //ç”¨æˆ·é¢†å–è¯¥å•†å“çš„ä¼˜æƒ åˆ¸\n\tprivate UserRedPacket userRedPacket; //ç”¨æˆ·é¢†å–è¯¥å•†å“çš„çº¢åŒ…\n\t\n\t//é‡å†™cloneæ–¹æ³•\n    public SupportPromotions clone(){\n    \tSupportPromotions supportPromotions = null;\n        try{\n        \tsupportPromotions = (SupportPromotions)super.clone();\n        }catch(CloneNotSupportedException e){\n            e.printStackTrace();\n        }\n        return supportPromotions;\n    }\n}\n</code></pre><pre><code>/**\n * ä¼˜æƒ åˆ¸\n * @author admin\n *\n */\npublic class UserCoupon {\n\t\n\tprivate int id; //ä¼˜æƒ åˆ¸ID\n\tprivate int userId; //é¢†å–ä¼˜æƒ åˆ¸ç”¨æˆ·ID\n\tprivate String sku; //å•†å“SKU\n\tprivate BigDecimal coupon; //ä¼˜æƒ é‡‘é¢\n}\n</code></pre><pre><code>/**\n * çº¢åŒ…\n * @author admin\n *\n */\npublic class UserRedPacket {\n\n\tprivate int id; //çº¢åŒ…ID\n\tprivate int userId; //é¢†å–ç”¨æˆ·ID\n\tprivate String sku; //å•†å“SKU\n\tprivate BigDecimal redPacket; //é¢†å–çº¢åŒ…é‡‘é¢\n}\n</code></pre><p>æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬å†å»ºç«‹ä¸€ä¸ªè®¡ç®—æ”¯ä»˜é‡‘é¢çš„æ¥å£ç±»ä»¥åŠåŸºæœ¬ç±»ï¼š</p><pre><code>/**\n * è®¡ç®—æ”¯ä»˜é‡‘é¢æ¥å£ç±»\n * @author admin\n *\n */\npublic interface IBaseCount {\n\t\n\tBigDecimal countPayMoney(OrderDetail orderDetail);\n\n}\n</code></pre><pre><code>/**\n * æ”¯ä»˜åŸºæœ¬ç±»\n * @author admin\n *\n */\npublic class BaseCount implements IBaseCount{\n\n\tpublic BigDecimal countPayMoney(OrderDetail orderDetail) {\norderDetail.setPayMoney(orderDetail.getMerchandise().getPrice());\n\t\tSystem.out.println(&quot;å•†å“åŸå•ä»·é‡‘é¢ä¸ºï¼š&quot; +  orderDetail.getPayMoney());\n\t\t\n\t\treturn orderDetail.getPayMoney();\n\t}\n\n}\n</code></pre><p>ç„¶åï¼Œæˆ‘ä»¬å†å»ºç«‹ä¸€ä¸ªè®¡ç®—æ”¯ä»˜é‡‘é¢çš„æŠ½è±¡ç±»ï¼Œç”±æŠ½è±¡ç±»è°ƒç”¨åŸºæœ¬ç±»ï¼š</p><pre><code>/**\n * è®¡ç®—æ”¯ä»˜é‡‘é¢çš„æŠ½è±¡ç±»\n * @author admin\n *\n */\npublic abstract class BaseCountDecorator implements IBaseCount{\n\t\n\tprivate IBaseCount count;\n\t\n\tpublic BaseCountDecorator(IBaseCount count) {\n\t\tthis.count = count;\n\t}\n\n\tpublic BigDecimal countPayMoney(OrderDetail orderDetail) {\n\t\tBigDecimal payTotalMoney = new BigDecimal(0);\n\t\tif(count!=null) {\n\t\t\tpayTotalMoney = count.countPayMoney(orderDetail);\n\t\t}\n\t\treturn payTotalMoney;\n\t}\n}\n</code></pre><p>ç„¶åï¼Œæˆ‘ä»¬å†é€šè¿‡ç»§æ‰¿æŠ½è±¡ç±»æ¥å®ç°æˆ‘ä»¬æ‰€éœ€è¦çš„ä¿®é¥°ç±»ï¼ˆä¼˜æƒ åˆ¸è®¡ç®—ç±»ã€çº¢åŒ…è®¡ç®—ç±»ï¼‰ï¼š</p><pre><code>/**\n * è®¡ç®—ä½¿ç”¨ä¼˜æƒ åˆ¸åçš„é‡‘é¢\n * @author admin\n *\n */\npublic class CouponDecorator extends BaseCountDecorator{\n\n\tpublic CouponDecorator(IBaseCount count) {\n\t\tsuper(count);\n\t}\n\t\n\tpublic BigDecimal countPayMoney(OrderDetail orderDetail) {\n\t\tBigDecimal payTotalMoney = new BigDecimal(0);\n\t\tpayTotalMoney = super.countPayMoney(orderDetail);\n\t\tpayTotalMoney = countCouponPayMoney(orderDetail);\n\t\treturn payTotalMoney;\n\t}\n\t\n\tprivate BigDecimal countCouponPayMoney(OrderDetail orderDetail) {\n\t\t\n\t\tBigDecimal coupon =  orderDetail.getMerchandise().getSupportPromotions().get(PromotionType.COUPON).getUserCoupon().getCoupon();\n\t\tSystem.out.println(&quot;ä¼˜æƒ åˆ¸é‡‘é¢ï¼š&quot; + coupon);\n\t\t\n\t\torderDetail.setPayMoney(orderDetail.getPayMoney().subtract(coupon));\n\t\treturn orderDetail.getPayMoney();\n\t}\n}\n</code></pre><pre><code>/**\n * è®¡ç®—ä½¿ç”¨çº¢åŒ…åçš„é‡‘é¢\n * @author admin\n *\n */\npublic class RedPacketDecorator extends BaseCountDecorator{\n\n\tpublic RedPacketDecorator(IBaseCount count) {\n\t\tsuper(count);\n\t}\n\t\n\tpublic BigDecimal countPayMoney(OrderDetail orderDetail) {\n\t\tBigDecimal payTotalMoney = new BigDecimal(0);\n\t\tpayTotalMoney = super.countPayMoney(orderDetail);\n\t\tpayTotalMoney = countCouponPayMoney(orderDetail);\n\t\treturn payTotalMoney;\n\t}\n\t\n\tprivate BigDecimal countCouponPayMoney(OrderDetail orderDetail) {\n\t\t\n\t\tBigDecimal redPacket = orderDetail.getMerchandise().getSupportPromotions().get(PromotionType.REDPACKED).getUserRedPacket().getRedPacket();\n\t\tSystem.out.println(&quot;çº¢åŒ…ä¼˜æƒ é‡‘é¢ï¼š&quot; + redPacket);\n\t\t\n\t\torderDetail.setPayMoney(orderDetail.getPayMoney().subtract(redPacket));\n\t\treturn orderDetail.getPayMoney();\n\t}\n}\n</code></pre><p>æœ€åï¼Œæˆ‘ä»¬é€šè¿‡ä¸€ä¸ªå·¥å‚ç±»æ¥ç»„åˆå•†å“çš„ä¿ƒé”€ç±»å‹ï¼š</p><pre><code>/**\n * è®¡ç®—ä¿ƒé”€åçš„æ”¯ä»˜ä»·æ ¼\n * @author admin\n *\n */\npublic class PromotionFactory {\n\t\n\tpublic static BigDecimal getPayMoney(OrderDetail orderDetail) {\n\t\t\n\t\t//è·å–ç»™å•†å“è®¾å®šçš„ä¿ƒé”€ç±»å‹\n\t\tMap&lt;PromotionType, SupportPromotions&gt; supportPromotionslist = orderDetail.getMerchandise().getSupportPromotions();\n\t\t\n\t\t//åˆå§‹åŒ–è®¡ç®—ç±»\n\t\tIBaseCount baseCount = new BaseCount();\n\t\tif(supportPromotionslist!=null &amp;&amp; supportPromotionslist.size()&gt;0) {\n\t\t\tfor(PromotionType promotionType: supportPromotionslist.keySet()) {//éå†è®¾ç½®çš„ä¿ƒé”€ç±»å‹ï¼Œé€šè¿‡è£…é¥°å™¨ç»„åˆä¿ƒé”€ç±»å‹\n\t\t\t\tbaseCount = protmotion(supportPromotionslist.get(promotionType), baseCount);\n\t\t\t}\n\t\t}\n\t\treturn baseCount.countPayMoney(orderDetail);\n\t}\n\t\n\t/**\n\t * ç»„åˆä¿ƒé”€ç±»å‹\n\t * @param supportPromotions\n\t * @param baseCount\n\t * @return\n\t */\n\tprivate static IBaseCount protmotion(SupportPromotions supportPromotions, IBaseCount baseCount) {\n\t\tif(supportPromotions.getPromotionType()==PromotionType.COUPON) {\n\t\t\tbaseCount = new CouponDecorator(baseCount);\n\t\t}else if(supportPromotions.getPromotionType()==PromotionType.REDPACKED) {\n\t\t\tbaseCount = new RedPacketDecorator(baseCount);\n\t\t}\n\t\treturn baseCount;\n\t}\n\n}\n</code></pre><pre><code>    public static void main( String[] args ) throws InterruptedException, IOException\n    {\n    \tOrder order = new Order();\n    \tinit(order);\n    \t\n    \tfor(OrderDetail orderDetail: order.getList()) {\n    \t\tBigDecimal payMoney = PromotionFactory.getPayMoney(orderDetail);\n    \t\torderDetail.setPayMoney(payMoney);\n    \t\tSystem.out.println(&quot;æœ€ç»ˆæ”¯ä»˜é‡‘é¢ï¼š&quot; + orderDetail.getPayMoney());\n    \t}\n    }\n</code></pre><p>è¿è¡Œç»“æœï¼š</p><pre><code>å•†å“åŸå•ä»·é‡‘é¢ä¸ºï¼š20\nä¼˜æƒ åˆ¸é‡‘é¢ï¼š3\nçº¢åŒ…ä¼˜æƒ é‡‘é¢ï¼š10\næœ€ç»ˆæ”¯ä»˜é‡‘é¢ï¼š7\n</code></pre><p>ä»¥ä¸Šæºç å¯ä»¥é€šè¿‡ <a href=\"https://github.com/nickliuchao/decorator.git\">Github</a> ä¸‹è½½è¿è¡Œã€‚é€šè¿‡ä»¥ä¸Šæ¡ˆä¾‹å¯çŸ¥ï¼šä½¿ç”¨è£…é¥°å™¨æ¨¡å¼è®¾è®¡çš„ä»·æ ¼ä¼˜æƒ ç­–ç•¥ï¼Œå®ç°å„ä¸ªä¿ƒé”€ç±»å‹çš„è®¡ç®—åŠŸèƒ½éƒ½æ˜¯ç›¸äº’ç‹¬ç«‹çš„ç±»ï¼Œå¹¶ä¸”å¯ä»¥é€šè¿‡å·¥å‚ç±»è‡ªç”±ç»„åˆå„ç§ä¿ƒé”€ç±»å‹ã€‚</p><h2>æ€»ç»“</h2><p>è¿™è®²ä»‹ç»çš„è£…é¥°å™¨æ¨¡å¼ä¸»è¦ç”¨æ¥ä¼˜åŒ–ä¸šåŠ¡çš„å¤æ‚åº¦ï¼Œå®ƒä¸ä»…ç®€åŒ–äº†æˆ‘ä»¬çš„ä¸šåŠ¡ä»£ç ï¼Œè¿˜ä¼˜åŒ–äº†ä¸šåŠ¡ä»£ç çš„ç»“æ„è®¾è®¡ï¼Œä½¿å¾—æ•´ä¸ªä¸šåŠ¡é€»è¾‘æ¸…æ™°ã€æ˜“è¯»æ˜“æ‡‚ã€‚</p><p>é€šå¸¸ï¼Œè£…é¥°å™¨æ¨¡å¼ç”¨äºæ‰©å±•ä¸€ä¸ªç±»çš„åŠŸèƒ½ï¼Œä¸”æ”¯æŒåŠ¨æ€æ·»åŠ å’Œåˆ é™¤ç±»çš„åŠŸèƒ½ã€‚åœ¨è£…é¥°å™¨æ¨¡å¼ä¸­ï¼Œè£…é¥°ç±»å’Œè¢«è£…é¥°ç±»éƒ½åªå…³å¿ƒè‡ªèº«çš„ä¸šåŠ¡ï¼Œä¸ç›¸äº’å¹²æ‰°ï¼ŒçœŸæ­£å®ç°äº†è§£è€¦ã€‚</p><h2>æ€è€ƒé¢˜</h2><p>è´£ä»»é“¾æ¨¡å¼ã€ç­–ç•¥æ¨¡å¼ä¸è£…é¥°å™¨æ¨¡å¼æœ‰å¾ˆå¤šç›¸ä¼¼ä¹‹å¤„ã€‚å¹³æ—¶ï¼Œè¿™äº›è®¾è®¡æ¨¡å¼é™¤äº†åœ¨ä¸šåŠ¡ä¸­è¢«ç”¨åˆ°ä»¥å¤–ï¼Œåœ¨æ¶æ„è®¾è®¡ä¸­ä¹Ÿç»å¸¸è¢«ç”¨åˆ°ï¼Œä½ æ˜¯å¦åœ¨æºç ä¸­è§è¿‡è¿™å‡ ç§è®¾è®¡æ¨¡å¼çš„ä½¿ç”¨åœºæ™¯å‘¢ï¼Ÿæ¬¢è¿ä½ ä¸å¤§å®¶åˆ†äº«ã€‚</p><p></p>","neighbors":{"left":{"article_title":"30 | ç”Ÿäº§è€…æ¶ˆè´¹è€…æ¨¡å¼ï¼šç”µå•†åº“å­˜è®¾è®¡ä¼˜åŒ–","id":111288},"right":{"article_title":"32 | ç­”ç–‘è¯¾å ‚ï¼šæ¨¡å—äº”æ€è€ƒé¢˜é›†é”¦","id":112160}},"comments":[{"had_liked":false,"id":119486,"user_name":"å¯†ç 123456","can_delete":false,"product_type":"c1","uid":1126593,"ip_address":"","ucode":"9889463CC0EA71","user_header":"https://static001.geekbang.org/account/avatar/00/11/30/c1/2dde6700.jpg","comment_is_top":false,"comment_ctime":1564618640,"is_pvip":false,"replies":[{"id":"43996","content":"ğŸ‘ğŸ»","user_name":"ä½œè€…å›å¤","user_name_real":"åˆ˜è¶…","uid":"1228576","ctime":1564712833,"ip_address":"","comment_id":119486,"utype":1}],"discussion_count":1,"race_medal":0,"score":"190543179664","product_id":100028001,"comment_content":"è´£ä»»é“¾ã€‚æœ€å¸¸è§åˆ°çš„å°±æ˜¯æ¥æ”¶httpè¯·æ±‚äº†ã€‚å¸®æˆ‘ä»¬è½¬ç ï¼Œè½¬åŒ–æˆå®ä½“ç±»ï¼Œç­‰ç­‰ã€‚ç­–ç•¥æ¨¡å¼ã€‚æœ€å¸¸ç®€å•å’Œç”¨åˆ°çš„å°±æ˜¯é›†åˆæ’åºï¼Œè‡ªå®šä¹‰æ’åºè§„åˆ™ã€‚è£…é¥°å™¨ï¼Œæœ€å¸¸è§åˆ°çš„å°±æ˜¯å„ç§æµï¼Œæ¯”å¦‚å­—ç¬¦æµï¼Œå­—èŠ‚æµç­‰","like_count":45,"discussions":[{"author":{"id":1228576,"avatar":"https://static001.geekbang.org/account/avatar/00/12/bf/20/19d42715.jpg","nickname":"åˆ˜è¶…","note":"","ucode":"CD56F93596E818","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":460922,"discussion_content":"ğŸ‘ğŸ»","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1564712833,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":119725,"user_name":"QQæ€ª","can_delete":false,"product_type":"c1","uid":1211223,"ip_address":"","ucode":"1A39B8433D9208","user_header":"https://static001.geekbang.org/account/avatar/00/12/7b/57/a9b04544.jpg","comment_is_top":false,"comment_ctime":1564665560,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"108938847960","product_id":100028001,"comment_content":"è€å¸ˆè¿™ä¸ªæ¡ˆä¾‹æ¥çš„å¤ªåŠæ—¶äº†ï¼Œæ­£æƒ³é‡æ„å…¬å¸è®¢å•ä¼˜æƒ åŠµçº¢åŒ…æ‰£é™¤è¿™æ–¹é¢çš„ä»£ç ï¼ŒçœŸçš„æ˜¯åŠæ—¶é›¨å•Šï¼Ÿå‰å®³å‰å®³ğŸ‘ğŸ»","like_count":26},{"had_liked":false,"id":119452,"user_name":"nightmare","can_delete":false,"product_type":"c1","uid":1056314,"ip_address":"","ucode":"EF2E51C2122A86","user_header":"https://static001.geekbang.org/account/avatar/00/10/1e/3a/5b21c01c.jpg","comment_is_top":false,"comment_ctime":1564592616,"is_pvip":false,"replies":[{"id":"43997","content":"æœ‰è¯»æºç ä¹ æƒ¯ğŸ‘ğŸ»","user_name":"ä½œè€…å›å¤","user_name_real":"åˆ˜è¶…","uid":"1228576","ctime":1564712875,"ip_address":"","comment_id":119452,"utype":1}],"discussion_count":1,"race_medal":0,"score":"87463938536","product_id":100028001,"comment_content":"nettyä¸­çš„pipelineï¼Œtomcatä¸­çš„filterï¼Œå±äºè´£ä»»é“¾ï¼Œ   springmvcä¸­å¯¹å‚æ•°è§£æçš„å°±æ˜¯ ç­–ç•¥æ¨¡å¼ï¼Œæ¯ä¸€ä¸ªå‚æ•°ç±»å‹ä¸€ä¸ªå®ç°ç±»ï¼Œç”¨forå¾ªç¯è§£æå‚æ•°     java. ioå°±æ˜¯ç»å…¸çš„è£…é¥°å™¨æ¨¡å¼","like_count":21,"discussions":[{"author":{"id":1228576,"avatar":"https://static001.geekbang.org/account/avatar/00/12/bf/20/19d42715.jpg","nickname":"åˆ˜è¶…","note":"","ucode":"CD56F93596E818","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":460908,"discussion_content":"æœ‰è¯»æºç ä¹ æƒ¯ğŸ‘ğŸ»","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1564712875,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":175855,"user_name":"æè‹±æƒ","can_delete":false,"product_type":"c1","uid":1076081,"ip_address":"","ucode":"FECAC14A9C414B","user_header":"https://static001.geekbang.org/account/avatar/00/10/6b/71/e833b14a.jpg","comment_is_top":false,"comment_ctime":1580870816,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"53120478368","product_id":100028001,"comment_content":"æ¯æ¬¡çœ‹åˆ°æœ‰äººè¿™æ ·åšè£…é¥°å™¨æˆ–è€…ç­–ç•¥æ¨¡å¼çš„åˆå§‹åŒ–ï¼Œéƒ½è§‰å¾—å¾ˆå¯æƒœï¼Œå› ä¸ºè¿™å¾’å¢äº†å¾ˆå¤šéº»çƒ¦ï¼Œå…¶å®å®Œå…¨å¯ä»¥æŠŠè£…é¥°å™¨æˆ–ç­–ç•¥å®ç°ä½œä¸ºæšä¸¾å€¼çš„æˆå‘˜å˜é‡ åˆå§‹åŒ–åˆ°æšä¸¾ç±»å‹ä¸­ã€‚æ— è®ºæ˜¯ä»¥åæ‰©å±•è¿˜æ˜¯å¹³æ—¶ä½¿ç”¨ éƒ½éå¸¸ç®€å•è‡ªç„¶ã€‚","like_count":11},{"had_liked":false,"id":119446,"user_name":"CCC","can_delete":false,"product_type":"c1","uid":1259814,"ip_address":"","ucode":"1608E84D2F0655","user_header":"https://static001.geekbang.org/account/avatar/00/13/39/26/61e46afe.jpg","comment_is_top":false,"comment_ctime":1564589885,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"31629360957","product_id":100028001,"comment_content":"æœ‰å‡ ä¸ªä»Šå¹´ç§‹æ‹›çš„ï¼ä¸¾ä¸ªæ‰‹ï¼è€å¸ˆçš„è¯¾ç¨‹çœŸçš„æ”¶è·å¾ˆå¤šï¼","like_count":8},{"had_liked":false,"id":130010,"user_name":"å°”å†¬æ©™","can_delete":false,"product_type":"c1","uid":1225224,"ip_address":"","ucode":"0B013A49BC18DA","user_header":"https://static001.geekbang.org/account/avatar/00/12/b2/08/92f42622.jpg","comment_is_top":false,"comment_ctime":1567351077,"is_pvip":false,"replies":[{"id":"48613","content":"æˆ‘ä»¬çŸ¥é“ï¼ŒInputStreamæ˜¯ç›´æ¥è¯»å†™æ–‡ä»¶çš„ï¼Œé™¤äº†InputStreamï¼Œåœ¨å…¶ä¸Šå±‚è¿˜æœ‰BufferedInputStreamã€DataInputStreamç­‰å…¶ä»–ä¿®é¥°ç±»ï¼Œå¢åŠ äº†ç¼“å­˜è¯»å–ã€ç±»å‹è¯»å–ç­‰åŠŸèƒ½ï¼Œç›¸å½“äºInputStreamä¹‹ä¸ŠåŠ äº†å¾ˆå¤šä¿®é¥°åŠŸèƒ½ï¼Œåœ¨æ‰€ä»¥å®ƒæ˜¯ä¸€ä¸ªè£…é¥°å™¨æ¨¡å¼ã€‚","user_name":"ä½œè€…å›å¤","user_name_real":"åˆ˜è¶…","uid":"1228576","ctime":1567424639,"ip_address":"","comment_id":130010,"utype":1}],"discussion_count":1,"race_medal":0,"score":"23042187557","product_id":100028001,"comment_content":"è€å¸ˆï¼Œä¸ºä»€ä¹ˆjava ioæ˜¯è£…é¥°å™¨æ¨¡å¼","like_count":6,"discussions":[{"author":{"id":1228576,"avatar":"https://static001.geekbang.org/account/avatar/00/12/bf/20/19d42715.jpg","nickname":"åˆ˜è¶…","note":"","ucode":"CD56F93596E818","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":465762,"discussion_content":"æˆ‘ä»¬çŸ¥é“ï¼ŒInputStreamæ˜¯ç›´æ¥è¯»å†™æ–‡ä»¶çš„ï¼Œé™¤äº†InputStreamï¼Œåœ¨å…¶ä¸Šå±‚è¿˜æœ‰BufferedInputStreamã€DataInputStreamç­‰å…¶ä»–ä¿®é¥°ç±»ï¼Œå¢åŠ äº†ç¼“å­˜è¯»å–ã€ç±»å‹è¯»å–ç­‰åŠŸèƒ½ï¼Œç›¸å½“äºInputStreamä¹‹ä¸ŠåŠ äº†å¾ˆå¤šä¿®é¥°åŠŸèƒ½ï¼Œåœ¨æ‰€ä»¥å®ƒæ˜¯ä¸€ä¸ªè£…é¥°å™¨æ¨¡å¼ã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1567424639,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":119517,"user_name":"å†¯ä¼ åš","can_delete":false,"product_type":"c1","uid":1177787,"ip_address":"","ucode":"91B9A1EF0FF042","user_header":"https://static001.geekbang.org/account/avatar/00/11/f8/bb/8b2ba45d.jpg","comment_is_top":false,"comment_ctime":1564621152,"is_pvip":false,"replies":[{"id":"43994","content":"å¥½çš„ï¼Œåç»­è¡¥ä¸Š","user_name":"ä½œè€…å›å¤","user_name_real":"åˆ˜è¶…","uid":"1228576","ctime":1564712722,"ip_address":"","comment_id":119517,"utype":1}],"discussion_count":4,"race_medal":0,"score":"14449523040","product_id":100028001,"comment_content":"å¸Œæœ›èƒ½æœ‰ä¸ªç±»å›¾ï¼Œè¿™æ ·å°±èƒ½ä¸€ç›®äº†ç„¶çš„çœ‹æ¸…æ¥šå„ä¸ªç±»ä¹‹é—´çš„å…³ç³»äº†","like_count":3,"discussions":[{"author":{"id":1228576,"avatar":"https://static001.geekbang.org/account/avatar/00/12/bf/20/19d42715.jpg","nickname":"åˆ˜è¶…","note":"","ucode":"CD56F93596E818","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":460937,"discussion_content":"å¥½çš„ï¼Œåç»­è¡¥ä¸Š","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1564712722,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1134861,"avatar":"https://static001.geekbang.org/account/avatar/00/11/51/0d/fc1652fe.jpg","nickname":"James","note":"","ucode":"48B0F2A334D1C1","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":350475,"discussion_content":"2å¹´äº†,è¿˜æ²¡è¡¥ä¸Š.å“ˆå“ˆ","likes_number":4,"is_delete":false,"is_hidden":false,"ctime":1613890190,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":1,"child_discussions":[{"author":{"id":1130561,"avatar":"https://static001.geekbang.org/account/avatar/00/11/40/41/abb7bfe3.jpg","nickname":"åŒ—åŸ.","note":"","ucode":"FF7F69F71FAD02","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":1134861,"avatar":"https://static001.geekbang.org/account/avatar/00/11/51/0d/fc1652fe.jpg","nickname":"James","note":"","ucode":"48B0F2A334D1C1","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":556499,"discussion_content":"ä¸‰å¹´äº†","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1647402617,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":350475,"ip_address":""},"score":556499,"extra":""}]},{"author":{"id":1008582,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/63/c6/d6ea3df3.jpg","nickname":"æ—è‚¯","note":"","ucode":"D2C97220230DE5","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":531214,"discussion_content":"è‡ªå·±åŠ¨æ‰‹ç”»ä¸€ç”»ï¼Œé˜…è¯»æ•ˆæœæ›´å¥½","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1637248185,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"user_type\":1}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":131460,"user_name":"é£é¸½","can_delete":false,"product_type":"c1","uid":1102172,"ip_address":"","ucode":"D6CB7D762D9E46","user_header":"https://static001.geekbang.org/account/avatar/00/10/d1/5c/ff82e7d2.jpg","comment_is_top":false,"comment_ctime":1567757931,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"10157692523","product_id":100028001,"comment_content":"ä¿ƒé”€ã€çº¢åŒ…è¿™ç§æƒ…å†µå¤æ‚å¤šå˜ã€‚åŸºäºè§„åˆ™é…ç½®å¤„ç†æ›´å¥½ã€‚","like_count":2},{"had_liked":false,"id":121020,"user_name":"Liam","can_delete":false,"product_type":"c1","uid":1094597,"ip_address":"","ucode":"1D15D3B64F2606","user_header":"https://static001.geekbang.org/account/avatar/00/10/b3/c5/7fc124e2.jpg","comment_is_top":false,"comment_ctime":1565050939,"is_pvip":false,"replies":[{"id":"51663","content":"ä¸¤è€…éƒ½å¯ä»¥è¾¾åˆ°å¯¹ä¸€ä¸ªå¯¹è±¡æ·»åŠ æ–¹æ³•ï¼Œä½†ä»£ç†æ¨¡å¼åå‘äºæ§åˆ¶å¤–éƒ¨å…¶ä»–å¯¹è±¡å¯¹è¯¥å¯¹è±¡çš„è®¿é—®ï¼Œè€Œè£…é¥°å™¨æ˜¯ä¸ºäº†å¢å¼ºä¸€ä¸ªå¯¹è±¡çš„åŠŸèƒ½ã€‚","user_name":"ä½œè€…å›å¤","user_name_real":"åˆ˜è¶…","uid":"1228576","ctime":1568897703,"ip_address":"","comment_id":121020,"utype":1}],"discussion_count":1,"race_medal":0,"score":"10154985531","product_id":100028001,"comment_content":"è¯·é—®è€å¸ˆï¼Œè£…é¥°å™¨å’Œä»£ç†æœ‰ä»€ä¹ˆåŒºåˆ«å‘¢ï¼Œä»£ç†ä¹Ÿå¯ä»¥å®ç°è¢«ä»£ç†çš„æ¥å£ï¼Œå¹¶æ³¨å…¥è¢«ä»£ç†å¯¹è±¡å®ç°åŠŸèƒ½æ‰©å±•ï¼Œæœ€åå¯ä»¥å§”æ‰˜è¢«ä»£ç†å¯¹è±¡å®ŒæˆåŸºç¡€åŠŸèƒ½","like_count":2,"discussions":[{"author":{"id":1228576,"avatar":"https://static001.geekbang.org/account/avatar/00/12/bf/20/19d42715.jpg","nickname":"åˆ˜è¶…","note":"","ucode":"CD56F93596E818","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":461578,"discussion_content":"ä¸¤è€…éƒ½å¯ä»¥è¾¾åˆ°å¯¹ä¸€ä¸ªå¯¹è±¡æ·»åŠ æ–¹æ³•ï¼Œä½†ä»£ç†æ¨¡å¼åå‘äºæ§åˆ¶å¤–éƒ¨å…¶ä»–å¯¹è±¡å¯¹è¯¥å¯¹è±¡çš„è®¿é—®ï¼Œè€Œè£…é¥°å™¨æ˜¯ä¸ºäº†å¢å¼ºä¸€ä¸ªå¯¹è±¡çš„åŠŸèƒ½ã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1568897703,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":119495,"user_name":"-W.LI-","can_delete":false,"product_type":"c1","uid":1210699,"ip_address":"","ucode":"3556786538664F","user_header":"https://static001.geekbang.org/account/avatar/00/12/79/4b/740f91ca.jpg","comment_is_top":false,"comment_ctime":1564619588,"is_pvip":false,"replies":[{"id":"43995","content":"ç”±äºæˆ‘ä»¬è¿™é‡Œè€ƒè™‘åˆ°çµæ´»çš„ç»„åˆæ¨¡å¼ï¼Œæ‰€ä»¥éœ€è¦è°ƒç”¨çˆ¶ç±»çš„countPayMoney()æ–¹æ³•ã€‚","user_name":"ä½œè€…å›å¤","user_name_real":"åˆ˜è¶…","uid":"1228576","ctime":1564712797,"ip_address":"","comment_id":119495,"utype":1}],"discussion_count":1,"race_medal":0,"score":"10154554180","product_id":100028001,"comment_content":"public BigDecimal countPayMoney(OrderDetail orderDetail) {<br>\t\tBigDecimal payTotalMoney = new BigDecimal(0);<br>\t\tpayTotalMoney = super.countPayMoney(orderDetail);<br>\t\tpayTotalMoney = countCouponPayMoney(orderDetail);<br>\t\treturn payTotalMoney;<br>\t}<br>è€å¸ˆå¥½!è¿™é‡Œä¸ºå•¥è¦è°ƒç”¨çˆ¶ç±»çš„countPayMoney()æ–¹æ³•å•Š?<br>è´£ä»»é“¾æ¨¡å¼:æ„Ÿè§‰è´£ä»»è¿æ¨¡å¼æ¯”è¾ƒå›ºå®šä¸æ€ä¹ˆä¼šå˜ä¸€å±‚å¾€ä¸€å±‚è°ƒç”¨ï¼Œè§£è€¦ï¼ŒæŸä¸€å±‚å˜äº†ä¸å½±å“åˆ«çš„å±‚ã€‚<br>ç­–ç•¥æ¨¡å¼:ç­–ç•¥æ¨¡å¼ï¼Œè™½ç„¶ä¹Ÿæ˜¯å°è£…äº†å¾ˆå¤šä¸åŒçš„ç­–ç•¥ï¼Œä½†æ˜¯ä½¿ç”¨æ—¶ä¸€èˆ¬ä¸€æ¬¡åªé€‰ä¸€ä¸ªå®ç°ç±»ä½¿ç”¨ï¼Œä¸ä¼šæœ‰åµŒå¥—ã€‚<br>è£…é¥°è€…æ¨¡å¼:è´£ä»»é“¾æœ‰çš„ä¼˜ç‚¹ä»–éƒ½æœ‰ï¼Œè£…é¥°è€…è¿˜èƒ½åŠ¨æ€ç»„åˆã€‚<br>è°¢è°¢è€å¸ˆï¼Œå¸Œæœ›ç»™å‡ºè¯¦ç»†ç­”æ¡ˆè°¢è°¢","like_count":2,"discussions":[{"author":{"id":1228576,"avatar":"https://static001.geekbang.org/account/avatar/00/12/bf/20/19d42715.jpg","nickname":"åˆ˜è¶…","note":"","ucode":"CD56F93596E818","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":460930,"discussion_content":"ç”±äºæˆ‘ä»¬è¿™é‡Œè€ƒè™‘åˆ°çµæ´»çš„ç»„åˆæ¨¡å¼ï¼Œæ‰€ä»¥éœ€è¦è°ƒç”¨çˆ¶ç±»çš„countPayMoney()æ–¹æ³•ã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1564712797,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":190336,"user_name":".","can_delete":false,"product_type":"c1","uid":1083502,"ip_address":"","ucode":"83F583994F4F72","user_header":"https://static001.geekbang.org/account/avatar/00/10/88/6e/3bd860d3.jpg","comment_is_top":false,"comment_ctime":1584630061,"is_pvip":true,"discussion_count":0,"race_medal":0,"score":"5879597357","product_id":100028001,"comment_content":"è£…é¥°æ¨¡å¼ä¼˜åŒ–å•†å“ä»·æ ¼ç­–ç•¥ä¾‹å­ä¸¾çš„å¾ˆå®é™…æŒºå¥½","like_count":1},{"had_liked":false,"id":158721,"user_name":"å¥‹æ–—çš„å°ç™½é¼ ","can_delete":false,"product_type":"c1","uid":1743483,"ip_address":"","ucode":"752BB901FFB7CE","user_header":"http://thirdwx.qlogo.cn/mmopen/vi_32/icHicAP9M4M4DIjAvlj5FDdFxIeA0pR3J15QdvVjXQXbznwunDN8OvrYqnsFchtBTNrZCCfGTE2RpPzIxjkvFAKg/132","comment_is_top":false,"comment_ctime":1575440364,"is_pvip":false,"replies":[{"id":"60853","content":"ç®€å•çš„å°†SupportPromotionsä¿ƒé”€ç±»å‹å­˜å‚¨èµ·æ¥å°±å¥½äº†","user_name":"ä½œè€…å›å¤","user_name_real":"åˆ˜è¶…","uid":"1228576","ctime":1575537941,"ip_address":"","comment_id":158721,"utype":1}],"discussion_count":1,"race_medal":0,"score":"5870407660","product_id":100028001,"comment_content":"è€å¸ˆï¼Œé—®ä¸€ä¸ªå°ç™½é—®é¢˜ï¼Œäº§å“Map&lt;PromotionType, SupportPromotions&gt; supportPromotions; &#47;&#47;æ”¯æŒä¿ƒé”€ç±»å‹  æ€ä¹ˆå­˜å…¥æ•°æ®åº“äº†ï¼Ÿ","like_count":1,"discussions":[{"author":{"id":1228576,"avatar":"https://static001.geekbang.org/account/avatar/00/12/bf/20/19d42715.jpg","nickname":"åˆ˜è¶…","note":"","ucode":"CD56F93596E818","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":476827,"discussion_content":"ç®€å•çš„å°†SupportPromotionsä¿ƒé”€ç±»å‹å­˜å‚¨èµ·æ¥å°±å¥½äº†","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1575537941,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":154920,"user_name":"neohope","can_delete":false,"product_type":"c1","uid":1043475,"ip_address":"","ucode":"C0268F6E7E2B6E","user_header":"https://static001.geekbang.org/account/avatar/00/0f/ec/13/49e98289.jpg","comment_is_top":false,"comment_ctime":1574596442,"is_pvip":true,"replies":[{"id":"59461","content":"ä¹Ÿå¯ä»¥åŸºäºè¯¥æ¨¡å¼å®ç°ï¼Œæˆ‘ä»¬åªéœ€è¦å°†å åŠ é€»è¾‘æ”¹æˆé€‰æ‹©æœ€ä¼˜é€»è¾‘å³å¯ã€‚","user_name":"ä½œè€…å›å¤","user_name_real":"åˆ˜è¶…","uid":"1228576","ctime":1574597346,"ip_address":"","comment_id":154920,"utype":1}],"discussion_count":1,"race_medal":0,"score":"5869563738","product_id":100028001,"comment_content":"è€å¸ˆæ‚¨å¥½ï¼Œæƒ³è¯·æ•™ä¸€ä¸‹ï¼Œåœ¨å®é™…åšä¼˜æƒ æ´»åŠ¨æ—¶ï¼Œå¾ˆå¤šæ´»åŠ¨ç­–ç•¥ä¹‹é—´æ˜¯ç›¸äº’æ’æ–¥çš„ï¼Œç”¨äº†ä¼˜æƒ 1å°±ä¸èƒ½ç”¨ä¼˜æƒ 2ï¼Œç”¨äº†ä¼˜æƒ 2å°±ä¸èƒ½ç”¨çº¢åŒ…ã€‚è¿™ç§è‡ªåŠ¨é€‰æ‹©æœ€ä¼˜ä¼˜æƒ ç­–ç•¥ï¼Œåœ¨å“ªé‡Œå®ç°æ¯”è¾ƒåˆç†å‘¢ï¼Ÿå¤šè°¢ï¼","like_count":2,"discussions":[{"author":{"id":1228576,"avatar":"https://static001.geekbang.org/account/avatar/00/12/bf/20/19d42715.jpg","nickname":"åˆ˜è¶…","note":"","ucode":"CD56F93596E818","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":475613,"discussion_content":"ä¹Ÿå¯ä»¥åŸºäºè¯¥æ¨¡å¼å®ç°ï¼Œæˆ‘ä»¬åªéœ€è¦å°†å åŠ é€»è¾‘æ”¹æˆé€‰æ‹©æœ€ä¼˜é€»è¾‘å³å¯ã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1574597346,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":119798,"user_name":"å³°","can_delete":false,"product_type":"c1","uid":1056019,"ip_address":"","ucode":"C53CB64E8E7D19","user_header":"https://static001.geekbang.org/account/avatar/00/10/1d/13/31ea1b0b.jpg","comment_is_top":false,"comment_ctime":1564705010,"is_pvip":true,"replies":[{"id":"43992","content":"å¯¹çš„ï¼Œä¸»è¦ç”¨æ¥ä¼˜åŒ–ä¸šåŠ¡çš„å¤æ‚åº¦ã€‚","user_name":"ä½œè€…å›å¤","user_name_real":"åˆ˜è¶…","uid":"1228576","ctime":1564711473,"ip_address":"","comment_id":119798,"utype":1}],"discussion_count":1,"race_medal":0,"score":"5859672306","product_id":100028001,"comment_content":"æ„Ÿè§‰è€å¸ˆåœ¨çº¢åŒ…è¿™ä¸ªä¾‹å­é‡Œé¢ï¼Œå…¶å®æœ€é‡è¦çš„è§£è€¦æ˜¯è£…é¥°å™¨å®ç°çš„å„ç§åŸºæœ¬çš„ä¼˜æƒ æ‰“æŠ˜æ‰‹æ®µä¸å·¥å‚çš„å„ç§ä¼˜æƒ è§„åˆ™æ¯”å¦‚çº¢åŒ…æŠµç”¨åˆ¸å¯å åŠ ç­‰ç­‰ã€‚<br>","like_count":1,"discussions":[{"author":{"id":1228576,"avatar":"https://static001.geekbang.org/account/avatar/00/12/bf/20/19d42715.jpg","nickname":"åˆ˜è¶…","note":"","ucode":"CD56F93596E818","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":461077,"discussion_content":"å¯¹çš„ï¼Œä¸»è¦ç”¨æ¥ä¼˜åŒ–ä¸šåŠ¡çš„å¤æ‚åº¦ã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1564711473,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":294069,"user_name":"çŸ¥æ˜“","can_delete":false,"product_type":"c1","uid":1246882,"ip_address":"","ucode":"BD3E3F0F0A40EF","user_header":"https://static001.geekbang.org/account/avatar/00/13/06/a2/350c4af0.jpg","comment_is_top":false,"comment_ctime":1621744610,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1621744610","product_id":100028001,"comment_content":"for(PromotionType promotionType: supportPromotionslist.keySet()) {&#47;&#47;éå†è®¾ç½®çš„ä¿ƒé”€ç±»å‹ï¼Œé€šè¿‡è£…é¥°å™¨ç»„åˆä¿ƒé”€ç±»å‹<br>\t\t\t\tbaseCount = protmotion(supportPromotionslist.get(promotionType), baseCount);<br>\t\t\t}<br>å¾ªç¯è¿™é‡Œï¼Œåé¢çš„baseCountä¸æ˜¯è¦†ç›–äº†å‰é¢çš„baseCountä¹ˆï¼Œï¼Œè¿™é‡Œå’‹è¿ä½œçš„æ²¡ææ‡‚å‘¢","like_count":0},{"had_liked":false,"id":246747,"user_name":"Javaå’å¢™å·¥ç¨‹å¸ˆ","can_delete":false,"product_type":"c1","uid":1937062,"ip_address":"","ucode":"E76AE44A9C76AE","user_header":"https://static001.geekbang.org/account/avatar/00/1d/8e/a6/c3286b61.jpg","comment_is_top":false,"comment_ctime":1599469582,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1599469582","product_id":100028001,"comment_content":"CouponDecorator å’ŒRedPacketDecoratorä¸€æ¨¡ä¸€æ ·çš„é€»è¾‘ä»£ç é‡å¤","like_count":0},{"had_liked":false,"id":246746,"user_name":"Javaå’å¢™å·¥ç¨‹å¸ˆ","can_delete":false,"product_type":"c1","uid":1937062,"ip_address":"","ucode":"E76AE44A9C76AE","user_header":"https://static001.geekbang.org/account/avatar/00/1d/8e/a6/c3286b61.jpg","comment_is_top":false,"comment_ctime":1599469441,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1599469441","product_id":100028001,"comment_content":"è¿™ä¸ªæ˜¯ä¸ªæ‚ç³…æ¨¡å¼ï¼Œè´´åˆå®é™…ï¼Œä¸æ˜¯æ ‡å‡†çš„è£…é¥°å™¨","like_count":0},{"had_liked":false,"id":231725,"user_name":"wisboy","can_delete":false,"product_type":"c1","uid":1031331,"ip_address":"","ucode":"CEAB14935EED7F","user_header":"https://static001.geekbang.org/account/avatar/00/0f/bc/a3/abb7bfe3.jpg","comment_is_top":false,"comment_ctime":1593759746,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1593759746","product_id":100028001,"comment_content":"BigDecimal payTotalMoney = new BigDecimal(0);<br>\t\tpayTotalMoney = super.countPayMoney(orderDetail);<br>\t\tpayTotalMoney = countCouponPayMoney(orderDetail);<br>\t\treturn payTotalMoney;<br>æŒºå›°æƒ‘çš„ï¼Œå¯è¯»æ€§ï¼Œä¹Ÿä¸å¤ªå¥½ï¼Œæœ‰æ²¡æœ‰æ›´å¥½çš„å®ç°æ–¹å¼ã€‚","like_count":0},{"had_liked":false,"id":213974,"user_name":"å¤©å¤©å‘ä¸Š","can_delete":false,"product_type":"c1","uid":1242455,"ip_address":"","ucode":"0CCCA6F4DCC480","user_header":"https://static001.geekbang.org/account/avatar/00/12/f5/57/ce10fb1b.jpg","comment_is_top":false,"comment_ctime":1588604299,"is_pvip":false,"replies":[{"id":"80539","content":"ç®€å•çš„å¢åˆ æ”¹æŸ¥ä¸ç”¨è®¾è®¡æ¨¡å¼","user_name":"ä½œè€…å›å¤","user_name_real":"åˆ˜è¶…","uid":"1228576","ctime":1589618375,"ip_address":"","comment_id":213974,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1588604299","product_id":100028001,"comment_content":"æœ‰ä¸ªé—®é¢˜ï¼Œå¯¹äºä¸šåŠ¡ç³»ç»Ÿï¼Œéƒ½æ˜¯å¯¹æ•°æ®åº“çš„å¢åˆ æ”¹æŸ¥ï¼Œè¿™ç§çš„ï¼Œå¾ˆéš¾ç”¨åˆ°è®¾è®¡æ¨¡å¼å§ã€‚","like_count":0,"discussions":[{"author":{"id":1228576,"avatar":"https://static001.geekbang.org/account/avatar/00/12/bf/20/19d42715.jpg","nickname":"åˆ˜è¶…","note":"","ucode":"CD56F93596E818","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":493918,"discussion_content":"ç®€å•çš„å¢åˆ æ”¹æŸ¥ä¸ç”¨è®¾è®¡æ¨¡å¼","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1589618375,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":199379,"user_name":"10å¹´ä»¥å","can_delete":false,"product_type":"c1","uid":1297421,"ip_address":"","ucode":"FE58CA7E5C2AF9","user_header":"https://static001.geekbang.org/account/avatar/00/13/cc/0d/89435926.jpg","comment_is_top":false,"comment_ctime":1585488034,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1585488034","product_id":100028001,"comment_content":"è®¾è®¡æ¨¡å¼","like_count":0},{"had_liked":false,"id":158170,"user_name":"wuyin","can_delete":false,"product_type":"c1","uid":1115707,"ip_address":"","ucode":"6D25A939B05952","user_header":"https://static001.geekbang.org/account/avatar/00/11/06/3b/456d0a2a.jpg","comment_is_top":false,"comment_ctime":1575341616,"is_pvip":false,"replies":[{"id":"60855","content":"è¿™é‡Œçš„åœºæ™¯æ˜¯å¤šä¸ªå åŠ ä¼˜æƒ ","user_name":"ä½œè€…å›å¤","user_name_real":"åˆ˜è¶…","uid":"1228576","ctime":1575538263,"ip_address":"","comment_id":158170,"utype":1}],"discussion_count":4,"race_medal":0,"score":"1575341616","product_id":100028001,"comment_content":"public static BigDecimal getPayMoney(OrderDetail orderDetail) { &#47;&#47;è·å–ç»™å•†å“è®¾å®šçš„ä¿ƒé”€ç±»å‹ Map supportPromotionslist = orderDetail.getMerchandise().getSupportPromotions(); &#47;&#47;åˆå§‹åŒ–è®¡ç®—ç±» IBaseCount baseCount = new BaseCount(); if(supportPromotionslist!=null &amp;&amp; supportPromotionslist.size()&gt;0) { for(PromotionType promotionType: supportPromotionslist.keySet()) {&#47;&#47;éå†è®¾ç½®çš„ä¿ƒé”€ç±»å‹ï¼Œé€šè¿‡è£…é¥°å™¨ç»„åˆä¿ƒé”€ç±»å‹ baseCount = protmotion(supportPromotionslist.get(promotionType), baseCount); } } return baseCount.countPayMoney(orderDetail); } <br>baseCountåªä¼šæœ‰ä¸€ç§ä¼˜æƒ ç±»å‹å§ï¼Œæ€ä¹ˆè¿›è¡Œç»„åˆè®¡ç®—å‘¢","like_count":0,"discussions":[{"author":{"id":1228576,"avatar":"https://static001.geekbang.org/account/avatar/00/12/bf/20/19d42715.jpg","nickname":"åˆ˜è¶…","note":"","ucode":"CD56F93596E818","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":476650,"discussion_content":"è¿™é‡Œçš„åœºæ™¯æ˜¯å¤šä¸ªå åŠ ä¼˜æƒ ","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1575538263,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1246882,"avatar":"https://static001.geekbang.org/account/avatar/00/13/06/a2/350c4af0.jpg","nickname":"çŸ¥æ˜“","note":"","ucode":"BD3E3F0F0A40EF","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":375568,"discussion_content":"è€Œä¸”è¿™ç§è£…é…æ–¹å¼ï¼Œï¼Œå¯ä»¥ä¸€è‡´æ‰©å±•","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1621746930,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1246882,"avatar":"https://static001.geekbang.org/account/avatar/00/13/06/a2/350c4af0.jpg","nickname":"çŸ¥æ˜“","note":"","ucode":"BD3E3F0F0A40EF","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":375567,"discussion_content":"æ¥å›çœ‹äº†å‡ æ¬¡ï¼Œçœ‹æ˜ç™½äº†ï¼Œæ ¸å¿ƒç‚¹åœ¨proymotionæ–¹æ³•ä¸Šã€‚\nç¬¬ä¸€æ¬¡å¾ªç¯ï¼Œprotmotion(couponç±»å‹ï¼Œnew BaseCount())ã€‚protmotionæ–¹æ³•è¿”å›couponDecoratorå¯¹è±¡ï¼Œå…¶å±æ€§count=new BaseCount().\nç¬¬äºŒæ¬¡å¾ªç¯ï¼Œprotmotion(redPackedç±»å‹ï¼Œç¬¬ä¸€æ¬¡è¿”å›çš„couponDecoratorå¯¹è±¡)ã€‚protmotionæ–¹æ³•è¿”å›redPackedDecoratorå¯¹è±¡ï¼Œå…¶å±æ€§count=ç¬¬ä¸€æ¬¡è¿”å›çš„couponDecoratorå¯¹è±¡ã€‚\n\nå¾—åˆ°è£…é…å¥½çš„baseCount=redPackedDecoratorå¯¹è±¡åï¼Œè°ƒç”¨baseCount.countPayMoney(orderDetail)ã€‚ã€‚\næ­¤æ—¶ï¼Œå…ˆè¿›å…¥RedPacketDecoratorç±»çš„countPayMoneyæ–¹æ³•ï¼Œé‡Œé¢è°ƒç”¨super.countPayMoneyåˆ°BaseCountDecoratorçš„countPayMoneyæ–¹æ³•å†…ã€‚å…¶ä¸­è°ƒç”¨count.countPayMoneyæ–¹æ³•ã€‚è¿™é‡Œå°±ç”¨åˆ°äº†ï¼Œåˆšè¯´çš„redPackedDecoratorä¸­çš„countå±æ€§ï¼Œå…¶å®å°±æ˜¯å¾ªç¯ä½“ç¬¬ä¸€æ¬¡è¿”å›çš„couponDecoratorå¯¹è±¡ï¼Œï¼Œï¼Œï¼Œåé¢çš„è°ƒç”¨è¿‡ç¨‹å°±å¾ˆæ¸…æ™°äº†ã€‚ã€‚\nä»¥ä¸Šä¸ºä¸ªäººè§è§£ï¼Œå¦‚æœ‰ä¸å¯¹çš„åœ°æ–¹ï¼Œè¿˜è¯·æŒ‡æ­£å’Œè¡¥å……ï¼Œæ„Ÿè°¢ã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1621746203,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1031331,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/bc/a3/abb7bfe3.jpg","nickname":"wisboy","note":"","ucode":"CEAB14935EED7F","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":288490,"discussion_content":"èƒ½è§£ç­”çš„åœ¨æ¸…æ¥šç‚¹å˜›","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1593759992,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":135216,"user_name":"ä¾ç„¶äº¦æ™¨","can_delete":false,"product_type":"c1","uid":1244726,"ip_address":"","ucode":"41F288A69AA4B6","user_header":"https://static001.geekbang.org/account/avatar/00/12/fe/36/df26de4a.jpg","comment_is_top":false,"comment_ctime":1569065773,"is_pvip":false,"replies":[{"id":"53073","content":"å¯¹çš„ï¼Œæ²¡æœ‰ä½¿ç”¨ï¼Œå¯ä»¥å¿½ç•¥","user_name":"ä½œè€…å›å¤","user_name_real":"åˆ˜è¶…","uid":"1228576","ctime":1569981531,"ip_address":"","comment_id":135216,"utype":1}],"discussion_count":1,"race_medal":1,"score":"1569065773","product_id":100028001,"comment_content":"è€å¸ˆï¼Œæœ‰ä¸ªç–‘é—®ï¼Œä¿ƒé”€ç±»å‹ç±»é‡Œçœ‹åˆ°ç”¨äº†cloneæ–¹æ³•ï¼ŒåŸå‹æ¨¡å¼ï¼Œä¸ºä»€ä¹ˆåè¾¹éƒ½æ²¡ç”¨è°ƒç”¨cloneæ–¹æ³•çš„åœ°æ–¹å‘¢ï¼Ÿ","like_count":0,"discussions":[{"author":{"id":1228576,"avatar":"https://static001.geekbang.org/account/avatar/00/12/bf/20/19d42715.jpg","nickname":"åˆ˜è¶…","note":"","ucode":"CD56F93596E818","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":468099,"discussion_content":"å¯¹çš„ï¼Œæ²¡æœ‰ä½¿ç”¨ï¼Œå¯ä»¥å¿½ç•¥","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1569981531,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":134093,"user_name":"è¡Œåˆ™å°†è‡³","can_delete":false,"product_type":"c1","uid":1542987,"ip_address":"","ucode":"DB972F2DF059C4","user_header":"https://static001.geekbang.org/account/avatar/00/17/8b/4b/fa52d222.jpg","comment_is_top":false,"comment_ctime":1568738272,"is_pvip":false,"replies":[{"id":"51444","content":"super.countPayMoney(orderDetail)ä¸»è¦æ˜¯è®¡ç®—äº†orderDetailä¸­çš„paymoneyï¼Œè¿™é‡Œå†™çš„å¯è¯»æ€§ä¸æ˜¯å¾ˆå¥½ï¼Œå¯ä»¥è¿™æ ·ç†è§£ï¼š<br><br>BigDecimal payTotalMoney = new BigDecimal(0);<br>super.countPayMoney(orderDetail);&#47;&#47;è®¡ç®—paymoneyï¼›<br>payTotalMoney = countCouponPayMoney(orderDetail);&#47;&#47;è®¡ç®—ä¼˜æƒ åçš„ä»·æ ¼ï¼›","user_name":"ä½œè€…å›å¤","user_name_real":"åˆ˜è¶…","uid":"1228576","ctime":1568772707,"ip_address":"","comment_id":134093,"utype":1}],"discussion_count":1,"race_medal":1,"score":"1568738272","product_id":100028001,"comment_content":"è€å¸ˆï¼ŒçŸ¥è¡Œåˆä¸€åŒå­¦æçš„é—®é¢˜ã€‚<br>BigDecimal payTotalMoney = new BigDecimal(0);<br>payTotalMoney = super.countPayMoney(orderDetail);<br>payTotalMoney = countCouponPayMoney(orderDetail);<br>payTotalMoneyä¸å°±è¢«è¦†ç›–äº†å—ï¼Ÿ<br>è¿™é‡Œçš„super.countPayMoney()æ˜¯ä¸èƒ½å»æ‰çš„ã€‚å»æ‰å°±æŠ¥ç©ºæŒ‡é’ˆ<br>RedPacketDecoratorä¸­çš„superä»£è¡¨çš„æ˜¯BaseCountï¼Œsuper.countPayMoney()æ‰¿æ‹…ç€è®¡ç®—æ€»é¢çš„ä»»åŠ¡ã€‚<br>CouponDecoratorä¸­çš„superä»£è¡¨çš„æ˜¯RedPacketDecoratorï¼Œè¿™é‡Œçš„super.countPayMoney()æ‰¿æ‹…ç€è®¡ç®—è®¡ç®—çº¢åŒ…ä¼˜æƒ é¢çš„ä»»åŠ¡ã€‚<br>ä¸¤ä¸ªsuper.countPayMoneyéƒ½ä¸å¯ä»¥çœç•¥çš„ã€‚<br>æœ›è€å¸ˆæ˜ç¤º","like_count":0,"discussions":[{"author":{"id":1228576,"avatar":"https://static001.geekbang.org/account/avatar/00/12/bf/20/19d42715.jpg","nickname":"åˆ˜è¶…","note":"","ucode":"CD56F93596E818","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":467614,"discussion_content":"super.countPayMoney(orderDetail)ä¸»è¦æ˜¯è®¡ç®—äº†orderDetailä¸­çš„paymoneyï¼Œè¿™é‡Œå†™çš„å¯è¯»æ€§ä¸æ˜¯å¾ˆå¥½ï¼Œå¯ä»¥è¿™æ ·ç†è§£ï¼š\n\nBigDecimal payTotalMoney = new BigDecimal(0);\nsuper.countPayMoney(orderDetail);//è®¡ç®—paymoneyï¼›\npayTotalMoney = countCouponPayMoney(orderDetail);//è®¡ç®—ä¼˜æƒ åçš„ä»·æ ¼ï¼›","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1568772707,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":133759,"user_name":"è¡Œåˆ™å°†è‡³","can_delete":false,"product_type":"c1","uid":1542987,"ip_address":"","ucode":"DB972F2DF059C4","user_header":"https://static001.geekbang.org/account/avatar/00/17/8b/4b/fa52d222.jpg","comment_is_top":false,"comment_ctime":1568647182,"is_pvip":false,"replies":[{"id":"51391","content":"è¿™æ˜¯ä¸€ä¸ªæŠ½è±¡åŸºç±»ï¼Œæ²¡æœ‰ç‰¹åˆ«çš„ï¼Œæ–¹ä¾¿åé¢æ‰©å±•","user_name":"ä½œè€…å›å¤","user_name_real":"åˆ˜è¶…","uid":"1228576","ctime":1568720951,"ip_address":"","comment_id":133759,"utype":1}],"discussion_count":1,"race_medal":1,"score":"1568647182","product_id":100028001,"comment_content":"è€å¸ˆï¼Œè£…ä¿®åŠŸèƒ½é‡Œé¢çš„BaseDecoratorä¸ºä»€ä¹ˆè¦ç”¨abstractä¿®é¥°å‘¢ï¼Ÿä¹Ÿæ²¡æœ‰æŠ½è±¡æ–¹æ³•å‘¢","like_count":0,"discussions":[{"author":{"id":1228576,"avatar":"https://static001.geekbang.org/account/avatar/00/12/bf/20/19d42715.jpg","nickname":"åˆ˜è¶…","note":"","ucode":"CD56F93596E818","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":467497,"discussion_content":"è¿™æ˜¯ä¸€ä¸ªæŠ½è±¡åŸºç±»ï¼Œæ²¡æœ‰ç‰¹åˆ«çš„ï¼Œæ–¹ä¾¿åé¢æ‰©å±•","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1568720951,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":133042,"user_name":"é’±","can_delete":false,"product_type":"c1","uid":1009652,"ip_address":"","ucode":"2C92A243A463D4","user_header":"https://static001.geekbang.org/account/avatar/00/0f/67/f4/9a1feb59.jpg","comment_is_top":false,"comment_ctime":1568334458,"is_pvip":false,"replies":[{"id":"50983","content":"ä»£ç æ˜“æ‰©å±•ï¼Œé€»è¾‘æ¸…æ™°","user_name":"ä½œè€…å›å¤","user_name_real":"åˆ˜è¶…","uid":"1228576","ctime":1568422972,"ip_address":"","comment_id":133042,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1568334458","product_id":100028001,"comment_content":"ğŸ˜€è€å¸ˆï¼Œè£…é¥°å™¨æ¨¡å¼çš„æ€§èƒ½ä¼˜åŒ–ç‚¹åœ¨å“ªé‡Œï¼Ÿæ˜¯ä¸æ˜¯åŠ é€Ÿäº†ç ”å‘è°ƒæ•´ä»£ç æ‰©å±•ä»£ç çš„é€Ÿåº¦!","like_count":0,"discussions":[{"author":{"id":1228576,"avatar":"https://static001.geekbang.org/account/avatar/00/12/bf/20/19d42715.jpg","nickname":"åˆ˜è¶…","note":"","ucode":"CD56F93596E818","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":467235,"discussion_content":"ä»£ç æ˜“æ‰©å±•ï¼Œé€»è¾‘æ¸…æ™°","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1568422972,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":129985,"user_name":"å°”å†¬æ©™","can_delete":false,"product_type":"c1","uid":1225224,"ip_address":"","ucode":"0B013A49BC18DA","user_header":"https://static001.geekbang.org/account/avatar/00/12/b2/08/92f42622.jpg","comment_is_top":false,"comment_ctime":1567347478,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1567347478","product_id":100028001,"comment_content":"è€å¸ˆä½ è®²çš„å¤ªå¥½äº†ï¼Œè¦åŠ é¤åŠ é¤","like_count":0},{"had_liked":false,"id":123610,"user_name":"Gred","can_delete":false,"product_type":"c1","uid":1442929,"ip_address":"","ucode":"F68068880E348B","user_header":"https://static001.geekbang.org/account/avatar/00/16/04/71/853b2292.jpg","comment_is_top":false,"comment_ctime":1565712246,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1565712246","product_id":100028001,"comment_content":"è€å¸ˆæ‚¨è¿™æ®µä¼˜åŒ–çš„è£…é¥°å™¨æ¨¡å¼ä»£ç é‡Œé¢ï¼Œå°±ç”¨åˆ°è£…é¥°å™¨ã€è´£ä»»é“¾ä»¥åŠå·¥å‚æ¨¡å¼ã€‚ä¸æ„§æ˜¯è€å¸ˆï¼Œå‰å®³å‰å®³ã€‚","like_count":0},{"had_liked":false,"id":123606,"user_name":"Gred","can_delete":false,"product_type":"c1","uid":1442929,"ip_address":"","ucode":"F68068880E348B","user_header":"https://static001.geekbang.org/account/avatar/00/16/04/71/853b2292.jpg","comment_is_top":false,"comment_ctime":1565711761,"is_pvip":false,"replies":[{"id":"71194","content":"æ˜¯çš„","user_name":"ä½œè€…å›å¤","user_name_real":"åˆ˜è¶…","uid":"1228576","ctime":1583159599,"ip_address":"","comment_id":123606,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1565711761","product_id":100028001,"comment_content":"è€å¸ˆï¼Œæ‚¨åœ¨SupportPromotionsé‡å†™ clone æ–¹æ³•ï¼Œåªå¯¹ç±»è¿›è¡Œæ‹·è´ï¼Œä½†æ˜¯æˆå‘˜å˜é‡åªæ˜¯æµ…æ‹·è´ï¼Œå¦‚æœè¦å®é™…åº”ç”¨ä¸šåŠ¡åœºæ™¯ï¼Œæ˜¯ä¸æ˜¯åº”è¯¥æ”¹ç”¨æ·±æ‹·è´ï¼Œé¿å…å…¶ä»–è®¢å•çš„ä¼˜åŒ–åˆ¸ç­‰ä¿¡æ¯å½±å“åˆ°äº†ã€‚","like_count":0,"discussions":[{"author":{"id":1228576,"avatar":"https://static001.geekbang.org/account/avatar/00/12/bf/20/19d42715.jpg","nickname":"åˆ˜è¶…","note":"","ucode":"CD56F93596E818","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":462743,"discussion_content":"æ˜¯çš„","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1583159599,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":121979,"user_name":"çŸ¥è¡Œåˆä¸€","can_delete":false,"product_type":"c1","uid":1090784,"ip_address":"","ucode":"563C4A71D80DA1","user_header":"http://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTJwQvLGE4dMsF4JU0svW3DtGbodpjskbY65FdwF13JdtBYZfgL2IXHlHrdejWzHdjT0RibEIfib4QYA/132","comment_is_top":false,"comment_ctime":1565261755,"is_pvip":false,"replies":[{"id":"44860","content":"ç¬¬ä¸€ä¸ªæ˜¯è®¡ç®—åŸä»·ï¼Œç¬¬äºŒä¸ªæ˜¯è®¡ç®—ä½¿ç”¨ä¼˜æƒ åˆ¸åçš„ä»·æ ¼ï¼Œæˆ‘ä»¬å¯ä»¥å°†ç¬¬ä¸€ä¸ªå»æ‰ï¼Œè¿™é‡Œåªæ˜¯å†—ä½™äº†ä¸€ä¸ªpayTotalMoneyã€‚","user_name":"ä½œè€…å›å¤","user_name_real":"åˆ˜è¶…","uid":"1228576","ctime":1565313311,"ip_address":"","comment_id":121979,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1565261755","product_id":100028001,"comment_content":"BigDecimal payTotalMoney = new BigDecimal(0);<br>payTotalMoney = super.countPayMoney(orderDetail);<br>payTotalMoney = countCouponPayMoney(orderDetail);<br>payTotalMoneyä¸å°±è¢«è¦†ç›–äº†å—ï¼Ÿ","like_count":0,"discussions":[{"author":{"id":1228576,"avatar":"https://static001.geekbang.org/account/avatar/00/12/bf/20/19d42715.jpg","nickname":"åˆ˜è¶…","note":"","ucode":"CD56F93596E818","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":462039,"discussion_content":"ç¬¬ä¸€ä¸ªæ˜¯è®¡ç®—åŸä»·ï¼Œç¬¬äºŒä¸ªæ˜¯è®¡ç®—ä½¿ç”¨ä¼˜æƒ åˆ¸åçš„ä»·æ ¼ï¼Œæˆ‘ä»¬å¯ä»¥å°†ç¬¬ä¸€ä¸ªå»æ‰ï¼Œè¿™é‡Œåªæ˜¯å†—ä½™äº†ä¸€ä¸ªpayTotalMoneyã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1565313311,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]}]}