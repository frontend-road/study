{"id":608146,"title":"37｜小试牛刀：如何设计一个飞机大战的程序？","content":"<p><strong>课后习题</strong><br>\n请参考本节案例代码，通过 +、- 符号，实现飞机大战的血量恢复和血量扣除功能，每次按键随机增加或减少 100 以内的整数，当血量为 0 时游戏结束。</p><p>举例：初始血量为 100，按一次 +，由于最大血量为 100，无变化。再按一次 -，随机减少 100 以内整数，并显示剩余血量。过程中，可以反复按 +、-，直到血量为 0，提示游戏结束。</p><p><strong>课程代码、课件及其他相关资料地址</strong><br>\n<a href=\"https://gitee.com/wilsonyin/zero-basics-python\">https://gitee.com/wilsonyin/zero-basics-python</a></p>","comments":[{"had_liked":false,"id":364528,"user_name":"梅美美🥰","can_delete":false,"product_type":"c3","uid":2042460,"ip_address":"广东","ucode":"2601B93AB0806D","user_header":"http://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTKVRwtvDSFQd4IMslTNkjq9KibEibJSKvNFIa1hibDIrauJwGuY5gPJ4tfibDj9ib0oqkmgaNyvSicoz9kQ/132","comment_is_top":false,"comment_ctime":1671084998,"is_pvip":false,"replies":[{"id":133097,"content":"用print()将坐标打印出来，你会发现如果是012，判断的时候会遇到判断条件不完整的问题，得再增加额外的判断条件。所以我偷懒，反过来使用了210","user_name":"作者回复","user_name_real":"编辑","uid":1056235,"ctime":1672485986,"ip_address":"广东","comment_id":364528,"utype":1}],"discussion_count":4,"race_medal":0,"score":2,"product_id":100310001,"comment_content":"为什么向下的时候第一层循环时2，1，0，不是0，1，2？","like_count":1,"discussions":[{"author":{"id":1056235,"avatar":"https://static001.geekbang.org/account/avatar/00/10/1d/eb/b2123759.jpg","nickname":"尹会生","note":"","ucode":"D1093DBD093617","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":598066,"discussion_content":"用print()将坐标打印出来，你会发现如果是012，判断的时候会遇到判断条件不完整的问题，得再增加额外的判断条件。所以我偷懒，反过来使用了210","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1672485986,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"广东","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1273252,"avatar":"https://static001.geekbang.org/account/avatar/00/13/6d/a4/e07825c8.jpg","nickname":"haoleir","note":"","ucode":"3FAC05601B5752","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":641205,"discussion_content":"假如飞机当前在第 1 行，按下 s 键，你会发现如果外层循环用0，1，2，那么飞机会跳过第2行，直接到第 3 行。因为外层循环用0，1，2递增的话，需要加额外的标志来记录飞机是否移动过；不然循环到下一层时，飞机会继续往下移。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1712366255,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":"广东","group_id":0},"score":2,"extra":"","child_discussion_number":2,"child_discussions":[{"author":{"id":3248283,"avatar":"","nickname":"J哥","note":"","ucode":"0A2307E1B6FC5A","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":1273252,"avatar":"https://static001.geekbang.org/account/avatar/00/13/6d/a4/e07825c8.jpg","nickname":"haoleir","note":"","ucode":"3FAC05601B5752","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":645585,"discussion_content":"为什么在这里加break还是不行呢","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1716388482,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":641205,"ip_address":"广东","group_id":0},"score":645585,"extra":""},{"author":{"id":3248283,"avatar":"","nickname":"J哥","note":"","ucode":"0A2307E1B6FC5A","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":1273252,"avatar":"https://static001.geekbang.org/account/avatar/00/13/6d/a4/e07825c8.jpg","nickname":"haoleir","note":"","ucode":"3FAC05601B5752","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":645586,"discussion_content":"按D键也会出现这种情况，用break就能解决","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1716388654,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":641205,"ip_address":"广东","group_id":0},"score":645586,"extra":""}]}]},{"had_liked":false,"id":393090,"user_name":"低调的成熟","can_delete":false,"product_type":"c3","uid":1791376,"ip_address":"上海","ucode":"67A7C323515E37","user_header":"https://static001.geekbang.org/account/avatar/00/1b/55/90/4538950b.jpg","comment_is_top":false,"comment_ctime":1722776500,"is_pvip":false,"replies":[{"id":142772,"content":"虽然终端显示已经安装成功，但在运行脚本时却提示 ModuleNotFoundError。 这里有可能出现两个原因，需要你依次排查一下\n\n1 多版本 Python 问题：你的系统上可能有多个 Python 版本，你安装 pynput 的版本和运行脚本时使用的版本不同。\n2 环境问题：你可能在一个虚拟环境中运行你的代码，而 pynput 安装在全局环境中。\n\n参考的排查步骤:\n\n解决方法\n1. 确认 Python 版本\n首先，检查你当前使用的 Python 版本，以及安装 pynput 的 Python 版本是否一致。\n\n检查 Python 版本：\n\npython3 --version\n检查你的脚本使用哪个 Python 解释器：\n\n在你的脚本开头加上以下行，并运行脚本：\nimport sys\nprint(sys.executable)\n确认终端中安装 pynput 使用的 Python 版本：\n\nwhich python3\n上述命令的输出应与脚本中打印的 sys.executable 一致。\n\n2. 确认安装位置\n确认 pynput 是否安装在正确的位置。你可以使用以下命令来查看 pynput 的安装位置：\n\npip3 show pynput\n这将显示 pynput 安装路径，确保路径与运行脚本时使用的 Python 版本路径一致。\n\n3. 安装到正确的环境\n如果路径不一致，你可以在运行脚本的 Python 环境中安装 pynput。使用以下命令：\n\n&#47;path&#47;to&#47;python3 -m pip install pynput\n将 &#47;path&#47;to&#47;python3 替换为你运行脚本时使用的 Python 解释器路径。\n\n4. 检查虚拟环境\n如果你在使用虚拟环境，确保激活了正确的虚拟环境：\n\nsource &#47;path&#47;to&#47;venv&#47;bin&#47;activate\n然后再次安装 pynput：\n\npip install pynput","user_name":"作者回复","user_name_real":"编辑","uid":1056235,"ctime":1723005081,"ip_address":"广东","comment_id":393090,"utype":1}],"discussion_count":1,"race_medal":0,"score":2,"product_id":100310001,"comment_content":"[notice] A new release of pip available: 22.3.1 -&gt; 24.2\n[notice] To update, run: pip3 install --upgrade pip\nI530994@DQ29KKFF9W ~ % pip3 install pynput\nLooking in indexes: https:&#47;&#47;pypi.tuna.tsinghua.edu.cn&#47;simple&#47;\nRequirement already satisfied: pynput in &#47;Library&#47;Frameworks&#47;Python.framework&#47;Versions&#47;3.11&#47;lib&#47;python3.11&#47;site-packages (1.7.7)\nRequirement already satisfied: six in &#47;Library&#47;Frameworks&#47;Python.framework&#47;Versions&#47;3.11&#47;lib&#47;python3.11&#47;site-packages (from pynput) (1.16.0)\nRequirement already satisfied: pyobjc-framework-ApplicationServices&gt;=8.0 in &#47;Library&#47;Frameworks&#47;Python.framework&#47;Versions&#47;3.11&#47;lib&#47;python3.11&#47;site-packages (from pynput) (10.3.1)\nRequirement already satisfied: pyobjc-framework-Quartz&gt;=8.0 in &#47;Library&#47;Frameworks&#47;Python.framework&#47;Versions&#47;3.11&#47;lib&#47;python3.11&#47;site-packages (from pynput) (10.3.1)\nRequirement already satisfied: pyobjc-core&gt;=10.3.1 in &#47;Library&#47;Frameworks&#47;Python.framework&#47;Versions&#47;3.11&#47;lib&#47;python3.11&#47;site-packages (from pyobjc-framework-ApplicationServices&gt;=8.0-&gt;pynput) (10.3.1)\nRequirement already satisfied: pyobjc-framework-Cocoa&gt;=10.3.1 in &#47;Library&#47;Frameworks&#47;Python.framework&#47;Versions&#47;3.11&#47;lib&#47;python3.11&#47;site-packages (from pyobjc-framework-ApplicationServices&gt;=8.0-&gt;pynput) (10.3.1)\nRequirement already satisfied: pyobjc-framework-CoreText&gt;=10.3.1 in &#47;Library&#47;Frameworks&#47;Python.framework&#47;Versions&#47;3.11&#47;lib&#47;python3.11&#47;site-packages (from pyobjc-framework-ApplicationServices&gt;=8.0-&gt;pynput) (10.3.1)\n 这个算安装成功了吗但他为什么这样啊\nTraceback (most recent call last):\n  File &quot;&#47;Users&#47;I530994&#47;Downloads&#47;XYY&#47;8&#47;main.py&quot;, line 1, in &lt;module&gt;\n    from pynput.keyboard import  Key, Listener, KeyCode\nModuleNotFoundError: No module named &#39;pynput&#39;","like_count":0,"discussions":[{"author":{"id":1056235,"avatar":"https://static001.geekbang.org/account/avatar/00/10/1d/eb/b2123759.jpg","nickname":"尹会生","note":"","ucode":"D1093DBD093617","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":649204,"discussion_content":"虽然终端显示已经安装成功，但在运行脚本时却提示 ModuleNotFoundError。 这里有可能出现两个原因，需要你依次排查一下\n\n1 多版本 Python 问题：你的系统上可能有多个 Python 版本，你安装 pynput 的版本和运行脚本时使用的版本不同。\n2 环境问题：你可能在一个虚拟环境中运行你的代码，而 pynput 安装在全局环境中。\n\n参考的排查步骤:\n\n解决方法\n1. 确认 Python 版本\n首先，检查你当前使用的 Python 版本，以及安装 pynput 的 Python 版本是否一致。\n\n检查 Python 版本：\n\npython3 --version\n检查你的脚本使用哪个 Python 解释器：\n\n在你的脚本开头加上以下行，并运行脚本：\nimport sys\nprint(sys.executable)\n确认终端中安装 pynput 使用的 Python 版本：\n\nwhich python3\n上述命令的输出应与脚本中打印的 sys.executable 一致。\n\n2. 确认安装位置\n确认 pynput 是否安装在正确的位置。你可以使用以下命令来查看 pynput 的安装位置：\n\npip3 show pynput\n这将显示 pynput 安装路径，确保路径与运行脚本时使用的 Python 版本路径一致。\n\n3. 安装到正确的环境\n如果路径不一致，你可以在运行脚本的 Python 环境中安装 pynput。使用以下命令：\n\n/path/to/python3 -m pip install pynput\n将 /path/to/python3 替换为你运行脚本时使用的 Python 解释器路径。\n\n4. 检查虚拟环境\n如果你在使用虚拟环境，确保激活了正确的虚拟环境：\n\nsource /path/to/venv/bin/activate\n然后再次安装 pynput：\n\npip install pynput","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1723005081,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"广东","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2,\"source\":0}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":381752,"user_name":"Geek_a7c1fb","can_delete":false,"product_type":"c3","uid":3715129,"ip_address":"辽宁","ucode":"E39884733B746C","user_header":"https://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTICFHlYKsSkvVK2b0ChnJHCEjhKf2QMYmur0UytyEIQ6KPvvelicSCswXIQ6j6icrsEgr48x4YIggAA/132","comment_is_top":false,"comment_ctime":1695801389,"is_pvip":false,"replies":[{"id":139142,"content":"要把报错信息一起提交，我才能帮你分析错误原因，安装不上的原因非常多，甚至会因为网络超时导致安装失败","user_name":"作者回复","user_name_real":"编辑","uid":1056235,"ctime":1696563655,"ip_address":"广东","comment_id":381752,"utype":1}],"discussion_count":1,"race_medal":0,"score":2,"product_id":100310001,"comment_content":"你好，我这个为什么安装不了pynput呢","like_count":0,"discussions":[{"author":{"id":1056235,"avatar":"https://static001.geekbang.org/account/avatar/00/10/1d/eb/b2123759.jpg","nickname":"尹会生","note":"","ucode":"D1093DBD093617","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":629033,"discussion_content":"要把报错信息一起提交，我才能帮你分析错误原因，安装不上的原因非常多，甚至会因为网络超时导致安装失败","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1696563655,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"广东","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":366909,"user_name":"yanyu-xin","can_delete":false,"product_type":"c3","uid":1899757,"ip_address":"广东","ucode":"3AA389F9E4C236","user_header":"","comment_is_top":false,"comment_ctime":1674575068,"is_pvip":false,"replies":null,"discussion_count":1,"race_medal":0,"score":2,"product_id":100310001,"comment_content":"from pynput.keyboard import Key, Listener, KeyCode\nimport random\n\n\nvolume = 100   # 初始血量\nprint(f&#39;初始血量是：{volume}&#39;)\n\n\ndef on_press(key):\n\n    global volume #血量为全局变量\n    \n    if key == KeyCode.from_char(&#39;+&#39;):  # 按键 ‘+’ 处理部分\n        ran_valume = random.randint(1, 100) # 随机数\n        volume = volume + ran_valume  # 加血\n        if volume &gt; 100 : # 大于100，按100处理\n            volume = 100\n        print(f&#39;血量为：{ volume} &#39;)\n\n    elif key == KeyCode.from_char(&#39;-&#39;): # 按键 ‘-’ 处理部分\n        ran_valume = random.randint(1, 100) # 随机数\n        volume = volume - ran_valume # 减血\n        if volume &lt; 0 : # 小于0，按0处理\n            volume = 0\n        print(f&#39;血量为：{ volume} &#39;)\n        if volume == 0 : # 小于等于 0 结束\n            print(&#39;游戏结束&#39;)\n            exit(-1) # 退出程序\n\n    elif key == KeyCode.from_char(&#39;q&#39;): # 按 q 键退出程序\n         exit(-1)\n\n\nwith Listener(on_press=on_press) as listener: # 按键处理\n    listener.join()","like_count":2,"discussions":[{"author":{"id":1604567,"avatar":"https://static001.geekbang.org/account/avatar/00/18/7b/d7/acc3c92b.jpg","nickname":"rick","note":"","ucode":"59044624C829D5","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":629200,"discussion_content":"厉害啊","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1696821965,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":"北京","group_id":0},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":391133,"user_name":"且听风吟","can_delete":false,"product_type":"c3","uid":2291112,"ip_address":"浙江","ucode":"D7E37D0C3CE45D","user_header":"https://static001.geekbang.org/account/avatar/00/22/f5/a8/f10d2446.jpg","comment_is_top":false,"comment_ctime":1717402330,"is_pvip":false,"replies":null,"discussion_count":0,"race_medal":0,"score":2,"product_id":100310001,"comment_content":"# 安装pynput包\n# pip install pynput\n\nfrom pynput.keyboard import Key, Listener, KeyCode\n\nmap_size = 9  # 地图尺寸\n\n# 使用推导式循环生成map_size*map_size的地图\nbackground = [[&#39; &#39; for x in range(1, map_size + 1)] for y in range(1, map_size + 1)]\n# 使用*运算拼接生成二位数组\n# background = [[&#39;0&#39;] * map_size] * map_size\nself_x = self_y = int(map_size &#47; 2)  # 初始坐标为中心\nprint(self_x, self_y)\nbackground[self_x][self_y] = &#39;X&#39;  # 安置飞机\n\n\n# 绘制地图\ndef draw():\n    print()\n    for line in background:\n        print(line)\n\n\n# 移动， x表示目标行，y表示目标列\ndef move(x, y):\n    global self_x, self_y\n    background[self_x][self_y] = &#39; &#39;  # 原地图中飞机位置清空\n    background[x][y] = &#39;X&#39;  # 更新地图中飞机位置\n    self_x = x  # 缓存最新坐标\n    self_y = y  # 缓存最新坐标\n    draw()  # 绘制地图\n\n\n# 键盘按下事件\ndef on_press(key):\n    if key == KeyCode.from_char(&#39;w&#39;):\n        if self_x &gt; 0:\n            move(self_x - 1, self_y)\n    elif key == KeyCode.from_char(&#39;s&#39;):\n        if self_x &lt; map_size - 1:\n            move(self_x + 1, self_y)\n    elif key == KeyCode.from_char(&#39;a&#39;):\n        if self_y &gt; 0:\n            move(self_x, self_y - 1)\n    elif key == KeyCode.from_char(&#39;d&#39;):\n        if self_y &lt; map_size - 1:\n            move(self_x, self_y + 1)\n\n\n# 初始绘制地图\ndraw()\n\n\nwith Listener(on_press=on_press) as listener:\n    listener.join()","like_count":1},{"had_liked":false,"id":365230,"user_name":"江江儿嘛哩哄","can_delete":false,"product_type":"c3","uid":1928117,"ip_address":"浙江","ucode":"E7D6E59551B7F1","user_header":"https://static001.geekbang.org/account/avatar/00/1d/6b/b5/14586a78.jpg","comment_is_top":false,"comment_ctime":1672286279,"is_pvip":false,"replies":null,"discussion_count":0,"race_medal":0,"score":2,"product_id":100310001,"comment_content":"from pynput.keyboard import Key, Listener, KeyCode\nimport random\nimport sys  #sys为结束整个程序\nnumber = 100\ndef on_press(key):\n#gobal用来申明number为全局变量，可在函数内对函数外对number进行操作\n    global number \n    if key == KeyCode.from_char(&#39;+&#39;):\n        number = number + int(random.randint(1,100))\n        if number &gt;= 100:\n            number = 100\n            print(f&quot;已达到最大血量{number}，游戏继续&quot;)\n        else:\n            print(f&quot;血量增加，现在血量：{number}，游戏继续&quot;)\n\n    if key == KeyCode.from_char(&#39;-&#39;):\n        number =number - int(random.randint(1,100))\n        if number &lt;= 0 :\n            number = 0\n            print(&quot;血量已耗尽，游戏结束！&quot;)\n            sys.exit()  #此时自动结束并退出游戏\n        else:\n            print(f&quot;血量减少，现在血量：{number}，游戏继续&quot;)\n            \n    print()\n    \nwith Listener(on_press = on_press) as listener:\n    listener.join()","like_count":1},{"had_liked":false,"id":364605,"user_name":"Calvin","can_delete":false,"product_type":"c3","uid":1603004,"ip_address":"广东","ucode":"0EEF5B207623B5","user_header":"https://static001.geekbang.org/account/avatar/00/18/75/bc/89d88775.jpg","comment_is_top":false,"comment_ctime":1671178816,"is_pvip":false,"replies":null,"discussion_count":0,"race_medal":0,"score":2,"product_id":100310001,"comment_content":"import random\nimport sys\n\nfrom pynput.keyboard import Listener, KeyCode\n\nbg: list[list[int | str]] = [[0, 0, 0], [0, &#39;x&#39;, 0], [0, 0, 0]]\nblood = 100\n\n\ndef print_bg():\n    for x in bg:\n        print(x[0], x[1], x[2])\n\n\nprint_bg()\n\n\ndef on_press(key):\n    global blood\n    if key == KeyCode.from_char(&#39;a&#39;):\n        for i in 0, 1, 2:\n            for j in 0, 1, 2:\n                if bg[i][j] == &#39;x&#39; and j &gt; 0:\n                    bg[i][j] = 0\n                    bg[i][j - 1] = &#39;x&#39;\n    elif key == KeyCode.from_char(&#39;d&#39;):\n        for i in 0, 1, 2:\n            for j in 2, 1, 0:\n                if bg[i][j] == &#39;x&#39; and j &lt; 2:\n                    bg[i][j] = 0\n                    bg[i][j + 1] = &#39;x&#39;\n    elif key == KeyCode.from_char(&#39;w&#39;):\n        for i in 0, 1, 2:\n            for j in 0, 1, 2:\n                if bg[i][j] == &#39;x&#39; and i &gt; 0:\n                    bg[i][j] = 0\n                    bg[i - 1][j] = &#39;x&#39;\n    elif key == KeyCode.from_char(&#39;s&#39;):\n        for i in 2, 1, 0:\n            for j in 0, 1, 2:\n                if bg[i][j] == &#39;x&#39; and i &lt; 2:\n                    bg[i][j] = 0\n                    bg[i + 1][j] = &#39;x&#39;\n    elif key == KeyCode.from_char(&#39;+&#39;):\n        blood += random.randint(0, 100)\n        if blood &gt; 100:\n            blood = 100\n        print(f&quot;血量增加，当前血量 {blood}，游戏继续 :-)&quot;)\n    elif key == KeyCode.from_char(&#39;-&#39;):\n        blood -= random.randint(0, 100)\n        if blood &lt; 0:\n            blood = 0\n            print(f&quot;血量不足，当前血量 {blood}，游戏结束 :&#39;-(&quot;)\n            sys.exit()\n        print(f&quot;血量减少，当前血量 {blood}，游戏继续 :-(&quot;)\n    print()\n    print_bg()\n\n\nwith Listener(on_press=on_press) as listener:\n    listener.join()","like_count":1},{"had_liked":false,"id":395652,"user_name":"C.","can_delete":false,"product_type":"c3","uid":1444698,"ip_address":"江苏","ucode":"5AE269220EFD73","user_header":"https://static001.geekbang.org/account/avatar/00/16/0b/5a/453ad411.jpg","comment_is_top":false,"comment_ctime":1731574486,"is_pvip":false,"replies":null,"discussion_count":0,"race_medal":0,"score":2,"product_id":100310001,"comment_content":"参考的评论区答案，并加上课后习题\nimport random\nfrom pynput.keyboard import Listener, KeyCode\nmap_size = 9\nbackground = [[&#39; &#39; for i in range(1, map_size + 1)]\n              for y in range(1, map_size + 1)]\nself_x = self_y = int(map_size &#47; 2)\nbackground[self_x][self_y] = &#39;X&#39;\n# 血量\nblood_volume = 100\n\ndef draw():\n    print()\n    for i in background:\n        print(i)\n\n\ndef move(x, y):\n    global self_x, self_y\n    background[self_x][self_y] = &#39; &#39;\n    background[x][y] = &#39;X&#39;\n    self_x = x\n    self_y = y\n    draw()\n\ndef on_press(key):\n    global blood_volume\n    random_num = int(random.random() * 100)\n\n    if key == KeyCode.from_char(&#39;w&#39;):\n        if self_x &gt; 0:\n            move(self_x - 1, self_y)\n    elif key == KeyCode.from_char(&#39;s&#39;):\n        if self_x &lt; map_size - 1:\n            move(self_x + 1, self_y)\n    elif key == KeyCode.from_char(&#39;a&#39;):\n        if self_y &gt; 0:\n            move(self_x, self_y - 1)\n    elif key == KeyCode.from_char(&#39;d&#39;):\n        if self_y &lt; map_size - 1:\n            move(self_x, self_y + 1)\n    elif key == KeyCode.from_char(&#39;-&#39;):\n        if blood_volume == 0:\n            print(&quot;游戏结束&quot;)\n        elif blood_volume &gt; 0:\n            num = blood_volume - random_num\n            if num &lt;= 0:\n                blood_volume = 0\n                print(f&quot;游戏结束,你的生命值已经归{blood_volume}&quot;)\n                exit(-1)\n            else:\n                blood_volume = num\n                print(f&quot;损失血量{random_num},剩余血量{blood_volume}&quot;)\n    elif key == KeyCode.from_char(&#39;+&#39;):\n        if blood_volume &lt; 100:\n            num = blood_volume + random_num\n            if num &lt;= 100:\n                blood_volume = num\n                print(f&quot;血量为：{blood_volume}&quot;)\n            else:\n                blood_volume = 100\n                print(f&quot;你已经充满活力&quot;)\n    elif key == KeyCode.from_char(&#39;c&#39;):\n        exit(-1)\n\n\ndraw()\n\nwith Listener(on_press=on_press) as listener:\n    listener.join()","like_count":0},{"had_liked":false,"id":394676,"user_name":"尹长拟","can_delete":false,"product_type":"c3","uid":3074007,"ip_address":"北京","ucode":"1EBD42B5BBD934","user_header":"","comment_is_top":false,"comment_ctime":1727545890,"is_pvip":false,"replies":null,"discussion_count":0,"race_medal":0,"score":2,"product_id":100310001,"comment_content":"搞明白了，顺序问题会导致 s 按键部分循环两次，修改顺序后逻辑就闭合了","like_count":0},{"had_liked":false,"id":394665,"user_name":"尹长拟","can_delete":false,"product_type":"c3","uid":3074007,"ip_address":"北京","ucode":"1EBD42B5BBD934","user_header":"","comment_is_top":false,"comment_ctime":1727453324,"is_pvip":false,"replies":null,"discussion_count":0,"race_medal":0,"score":2,"product_id":100310001,"comment_content":"from pynput.keyboard import Key,Listener,KeyCode\nimport random,sys\n\nxue=100\nprint(f&quot;初始血量为{xue}&quot;)\n\ndef on_press(key):\n    global xue\n\n    if key == KeyCode.from_char(&#39;+&#39;):\n        if xue ==100:\n            print(&#39;你的血量是满的&#39;)\n        else:\n            increase = random.randint(1,100)\n            xue = min(100,xue+increase)\n            print(f&quot;增加了{increase}点血量，目前血量为{xue}&quot;)\n    \n\n    elif key == KeyCode.from_char(&#39;-&#39;):\n        decrease = random.randint(1,100)\n        xue = max(0,xue - decrease)\n        if xue &gt;0:\n            print(f&quot;扣除了{decrease}点血量,剩余血量为{xue}&quot;)\n        else:\n            print(f&quot;扣除了{decrease}点血量，你的血量已归零，游戏结束！&quot;)\n            sys.exit()\n    \n    else:\n        print(&#39;无效操作，请按+或-&#39;)\n    \n    print()\n\nwith Listener(on_press=on_press)as listener:\n    listener.join()","like_count":0},{"had_liked":false,"id":394660,"user_name":"尹长拟","can_delete":false,"product_type":"c3","uid":3074007,"ip_address":"北京","ucode":"1EBD42B5BBD934","user_header":"","comment_is_top":false,"comment_ctime":1727450583,"is_pvip":false,"replies":null,"discussion_count":0,"race_medal":0,"score":3,"product_id":100310001,"comment_content":"# 飞机大战小游戏按照直接的理解写了一次\n\nfrom pynput.keyboard import Key,Listener,KeyCode\n\nbackground= [[0.0,0],\n             [0,&quot;x&quot;,0],\n             [0,0,0]]\n\nfor y in background:\n    print(y)\n\ndef on_press(key):\n    global background\n    if key == KeyCode.from_char(&#39;w&#39;):\n        for i in range(3):\n            for j in range(3):\n                if background[i][j] == &quot;x&quot; and i &gt;0 :\n                    background[i][j]=&quot;0&quot;\n                    background[i-1][j]=&quot;x&quot;\n                    break\n\n\n    elif key == KeyCode.from_char(&quot;s&quot;):\n        for i in range(3):\n            for j in range(3):\n                if background[i][j]==&quot;x&quot; and i &lt;2 :\n                    background[i][j]=&quot;0&quot;\n                    background[i+1][j]=&quot;x&quot;\n                    break\n\n\n    elif key == KeyCode.from_char(&quot;a&quot;):\n        for i in range(3):\n            for j in range(3):\n                if background[i][j]==&quot;x&quot; and j &gt;0 :\n                    background[i][j]=&quot;0&quot;\n                    background[i][j-1]=&quot;x&quot;\n                    break\n\n\n    elif key == KeyCode.from_char(&quot;d&quot;):\n        for i in range(3):\n            for j in range(3):\n                if background[i][j]==&quot;x&quot; and j &lt;2 :\n                    background[i][j]=&quot;0&quot;\n                    background[i][j+1]=&quot;x&quot;\n                    break\n    print()\n    for y in background:\n        print(y)\n\nwith Listener(on_press=on_press)as listener:\n    listener.join()","like_count":0},{"had_liked":false,"id":390821,"user_name":"J哥","can_delete":false,"product_type":"c3","uid":3248283,"ip_address":"广东","ucode":"0A2307E1B6FC5A","user_header":"","comment_is_top":false,"comment_ctime":1716380834,"is_pvip":false,"replies":null,"discussion_count":1,"race_medal":0,"score":3,"product_id":100310001,"comment_content":"我飞机移动的代码执行之后按S和D之后移动两格，代码完全一样的啊，为什么会一样呢","like_count":0,"discussions":[{"author":{"id":2291112,"avatar":"https://static001.geekbang.org/account/avatar/00/22/f5/a8/f10d2446.jpg","nickname":"且听风吟","note":"","ucode":"D7E37D0C3CE45D","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":646113,"discussion_content":"贴代码才能查问题","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1717401037,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":"浙江","group_id":0},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":388331,"user_name":"Geek_c131f7","can_delete":false,"product_type":"c3","uid":3828103,"ip_address":"美国","ucode":"88BB639931161E","user_header":"https://thirdwx.qlogo.cn/mmopen/vi_32/icniaGmw8xiboyC25ic8l7Vf62AOJ9ysHeAZSxPYMAnL8TticuELVSpnZcexwicbyaeVSCdtnN0MNWawrdBcgeLwmhdg/132","comment_is_top":false,"comment_ctime":1709905897,"is_pvip":false,"replies":null,"discussion_count":0,"race_medal":0,"score":3,"product_id":100310001,"comment_content":"import random\nfrom pynput.keyboard import Key, Listener, KeyCode\nBlut = 100   \n\ndef on_press(key):\n\n    global Blut\n    if key == KeyCode.from_char(&#39;+&#39;):\n        add = random.randint(1,100)\n        if Blut &gt;= 100:\n            print(&quot;血量已满&quot;)\n        else:\n            Blut += add\n            if Blut &gt;= 100:\n                Blut = 100\n                print(&quot;血量已满&quot;)\n            else:\n                print(f&quot;剩余血量为：{Blut}&quot;)\n\n    elif key == KeyCode.from_char(&#39;-&#39;):\n        Blut -= random.randint(1,100)\n        if Blut &lt;= 0:\n            print(&quot;游戏结束&quot;)\n            return False\n        else:            \n            print(f&quot;剩余血量为：{Blut}&quot;)   \n\nwith Listener(on_press=on_press) as listener:\n    listener.join()","like_count":0},{"had_liked":false,"id":386397,"user_name":"杨帆","can_delete":false,"product_type":"c3","uid":3805884,"ip_address":"上海","ucode":"F02879DB1370AD","user_header":"https://static001.geekbang.org/account/avatar/00/3a/12/bc/2a7ec1e9.jpg","comment_is_top":false,"comment_ctime":1704769373,"is_pvip":false,"replies":null,"discussion_count":1,"race_medal":0,"score":3,"product_id":100310001,"comment_content":"为什么向下第一层循环采用0，1，2的时候，当x的坐标为[0][1]的时候按下s向下直接x的坐标变成了[1][2]?","like_count":0,"discussions":[{"author":{"id":3579083,"avatar":"https://static001.geekbang.org/account/avatar/00/36/9c/cb/873a2cf8.jpg","nickname":"云边小卖部","note":"","ucode":"F41D8C65D8928A","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":636190,"discussion_content":"我也是","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1705764494,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":"广东","group_id":0},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":385114,"user_name":"一只会编程的二哈","can_delete":false,"product_type":"c3","uid":1301420,"ip_address":"上海","ucode":"DBCC529266C7C5","user_header":"https://static001.geekbang.org/account/avatar/00/13/db/ac/9064bd13.jpg","comment_is_top":false,"comment_ctime":1702108563,"is_pvip":false,"replies":null,"discussion_count":0,"race_medal":0,"score":3,"product_id":100310001,"comment_content":"plane_data = [\n    [0, 0, 0],\n    [0, &quot;x&quot;, 0],\n    [0, 0, 0]\n]\n\nplane_idx = []\nplane_num = 100\n\nfor i in enumerate(plane_data):\n    print(i[1])\n    try:\n        targetPlane = i[1].index(&quot;x&quot;)\n        plane_idx = [i[0], targetPlane]\n    except ValueError:\n        continue\n\n\ndef on_press(key):\n    next_idx = []\n    global plane_num\n    if KeyCode.from_char(&quot;w&quot;) == key:\n        if plane_idx[0] != 0:\n            next_idx = [plane_idx[0] - 1, plane_idx[1]]\n    elif KeyCode.from_char(&quot;s&quot;) == key:\n        if plane_idx[0] &lt; len(plane_data) - 1:\n            next_idx = [plane_idx[0] + 1, plane_idx[1]]\n    elif KeyCode.from_char(&quot;a&quot;) == key:\n        if plane_idx[1] != 0:\n            next_idx = [plane_idx[0], plane_idx[1] - 1]\n    elif KeyCode.from_char(&quot;d&quot;) == key:\n        if plane_idx[1] &lt; len(plane_data[plane_idx[1]]) - 1:\n            next_idx = [plane_idx[0], plane_idx[1] + 1]\n    elif KeyCode.from_char(&quot;+&quot;) == key:\n        add_num = int(random.random() * 100 + 1)\n        plane_num += add_num\n        if plane_num &gt; 100:\n            plane_num = 100\n    elif KeyCode.from_char(&#39;-&#39;) == key:\n        cut_num = int(random.random() * 100 + 1)\n        plane_num -= cut_num\n        if plane_num &lt; 0:\n            print(&quot;游戏结束 你的血没了&quot;)\n            exit(-1)\n    else:\n        return\n\n    if len(next_idx) != 0:\n        plane_data[plane_idx[0]][plane_idx[1]] = 0\n        plane_data[next_idx[0]][next_idx[1]] = &quot;x&quot;\n        plane_idx[0] = next_idx[0]\n        plane_idx[1] = next_idx[1]\n    for x in plane_data:\n        print(x)\n    print(plane_num)","like_count":0},{"had_liked":false,"id":384756,"user_name":"Geek_0c747b","can_delete":false,"product_type":"c3","uid":3790728,"ip_address":"广东","ucode":"7D7251D7B98B08","user_header":"","comment_is_top":false,"comment_ctime":1701437541,"is_pvip":false,"replies":null,"discussion_count":0,"race_medal":0,"score":3,"product_id":100310001,"comment_content":"# 需要使用global关键字\nhp_init = 100\n\ndef add_hp(hp_init):\n    add_hp = hp_init\n    random_hp = random.randint(1, 100)\n    add_hp = hp_init + random_hp\n    \n    if add_hp &gt; 100:\n        add_hp = 100\n        hp_init = 100\n        print(f&quot;hp --&gt; {hp_init} random_hp --&gt;{random_hp} add_hp --&gt; 100[血满了，不能再加了]&quot;)\n        return hp_init\n    else:\n        print(f&quot;hp --&gt; {hp_init} random_hp --&gt;{random_hp} add_hp --&gt; {add_hp}&quot;)\n    return add_hp\n\ndef subtract_hp(hp_init):\n    subtract_hp = hp_init\n    random_hp = random.randint(1, 100)\n    subtract_hp = hp_init - random_hp\n    print(f&quot;hp --&gt; {hp_init} random_hp --&gt;{random_hp} subtract_hp --&gt; {subtract_hp}&quot;)\n    if subtract_hp == 0 or subtract_hp &lt; 0:\n        print(&#39;游戏结束&#39;)\n        exit()        \n    return subtract_hp\n\ndef on_press(key):\n    global hp_init\n    if key == KeyCode.from_char(&#39;w&#39;):\n        hp_init = add_hp(hp_init)     \n        for i in 0,1,2:\n            for j in 0,1,2:\n                if background[i][j] == &#39;x&#39; and i &gt; 0:\n                    background[i][j] = &#39;0&#39;\n                    background[i-1][j] = &#39;x&#39;\n                    break\n    elif key == KeyCode.from_char(&#39;s&#39;):\n        hp_init = subtract_hp(hp_init)\n        for i in 2,1,0:\n            for j in 0,1,2:\n                if background[i][j] == &#39;x&#39; and i &lt; 2:\n                    background[i][j] = &#39;0&#39;\n                    background[i+1][j] = &#39;x&#39;\n                    break\n    elif key == KeyCode.from_char(&#39;a&#39;):\n        for i in 0,1,2:\n            for j in 0,1,2:\n                if background[i][j] == &#39;x&#39; and j &gt; 0:\n                    background[i][j] = &#39;0&#39;\n                    background[i][j-1] = &#39;x&#39;\n                    break\n    elif key == KeyCode.from_char(&#39;d&#39;):\n        for i in 0,1,2:\n            for j in 0,1,2:\n                if background[i][j] == &#39;x&#39; and j &lt; 2:\n                    background[i][j] = &#39;0&#39;\n                    background[i][j+1] = &#39;x&#39;\n                    break\nwith Listener(on_press=on_press) as listener:\n    listener.join()","like_count":0},{"had_liked":false,"id":384580,"user_name":"杜少星","can_delete":false,"product_type":"c3","uid":1387875,"ip_address":"北京","ucode":"9EB2A705BA9B17","user_header":"https://static001.geekbang.org/account/avatar/00/15/2d/63/6513b925.jpg","comment_is_top":false,"comment_ctime":1701180757,"is_pvip":false,"replies":null,"discussion_count":0,"race_medal":0,"score":3,"product_id":100310001,"comment_content":"测试没问题\n# pip3 install pynput\n\nfrom pynput.keyboard import Key, Listener, KeyCode\nfrom random import randint\n\ninitial_value = 100\nprint(f&quot;初始血量为 &quot;,initial_value)\n\ndef on_press(key):\n\n    global initial_value\n\n    if key == KeyCode.from_char(&#39;+&#39;) :\n        initial_value += randint(1, 100)\n        if initial_value &gt; 100:\n            initial_value = 100\n        print(f&quot;血量为: &quot;,initial_value)\n\n    elif key == KeyCode.from_char(&#39;-&#39;) :\n        initial_value -= randint(1, 100)\n        print(f&quot;血量为: &quot;,initial_value)\n        if initial_value &lt; 0:\n            print(&quot;game over&quot;)\n            exit()\n\n    # 按esc退出\n    elif key == Key.esc :\n        exit()\n\nwith Listener(on_press=on_press) as listener:\n    listener.join()","like_count":0},{"had_liked":false,"id":384313,"user_name":"依托答辩","can_delete":false,"product_type":"c3","uid":2383299,"ip_address":"上海","ucode":"4BE79E8A030813","user_header":"https://static001.geekbang.org/account/avatar/00/24/5d/c3/b8bb888c.jpg","comment_is_top":false,"comment_ctime":1700658161,"is_pvip":false,"replies":null,"discussion_count":0,"race_medal":0,"score":3,"product_id":100310001,"comment_content":"老师你在调试键盘事件时是如何退出命令行的","like_count":0},{"had_liked":false,"id":382481,"user_name":"Geek_335e45","can_delete":false,"product_type":"c3","uid":3732213,"ip_address":"辽宁","ucode":"749F12AA100004","user_header":"","comment_is_top":false,"comment_ctime":1697444893,"is_pvip":false,"replies":null,"discussion_count":0,"race_medal":0,"score":3,"product_id":100310001,"comment_content":"因为if条件执行多次。我多写了层break，第一次满足条件就跳出整个循环。也不知道对不对\ndef on_press(key):\n    if key == KeyCode.from_char(&quot;w&quot;):\n        flag = False\n        for indexi, i in enumerate(background):\n            for indexj, j in enumerate(i):\n                if background[indexi][indexj] == &#39;x&#39; and indexi &gt; 0:\n                    background[indexi][indexj] = 0\n                    background[indexi-1][indexj] = &#39;x&#39;\n                    flag = True\n                    break\n            if flag:\n                break\n    elif key == KeyCode.from_char(&quot;s&quot;):\n        print(&quot;您按了 下 键&quot;)\n        flag = False\n        for indexi, i in enumerate(background):\n            for indexj, j in enumerate(i):\n                if background[indexi][indexj] == &#39;x&#39; and indexi &lt; len(background) - 1:\n                    background[indexi][indexj] = 0\n                    background[indexi+1][indexj] = &#39;x&#39;\n                    flag = True\n                    break\n            if flag:\n                break\n    elif key == KeyCode.from_char(&quot;a&quot;):\n        print(&quot;您按了 左 键&quot;)\n        flag = False\n        for indexi, i in enumerate(background):\n            for indexj, j in enumerate(i):\n                if background[indexi][indexj] == &#39;x&#39; and indexj &gt; 0:\n                    background[indexi][indexj] = 0\n                    background[indexi][indexj-1] = &#39;x&#39;\n                    flag = True\n                    break\n            if flag:\n                break\n    elif key == KeyCode.from_char(&quot;d&quot;):\n        print(&quot;您按了 右 键&quot;)\n        flag = False\n        for indexi, i in enumerate(background):\n            for indexj, j in enumerate(i):\n                if background[indexi][indexj] == &#39;x&#39; and indexj &lt; len(i) - 1:\n                    background[indexi][indexj] = 0\n                    background[indexi][indexj+1] = &#39;x&#39;\n                    flag = True\n                    break\n            if flag:\n                break\n    print()\n    for i in background:\n        print(i)","like_count":0},{"had_liked":false,"id":381948,"user_name":"MarkG","can_delete":false,"product_type":"c3","uid":3675806,"ip_address":"山东","ucode":"454082595FE769","user_header":"https://static001.geekbang.org/account/avatar/00/38/16/9e/48621655.jpg","comment_is_top":false,"comment_ctime":1696297891,"is_pvip":false,"replies":null,"discussion_count":0,"race_medal":0,"score":3,"product_id":100310001,"comment_content":"from pynput.keyboard import Key, Listener, KeyCode\nimport random\n\nblood = 100 # 初始血量\nprint(f&quot;当前血量{blood}&quot;)\n\ndef on_press(key):\n\n    global blood\n    random_int = random.randint(1, 100)\n    ...\n    elif key == KeyCode.from_char(&#39;-&#39;):\n        temp_blood = blood - random_int\n        if temp_blood &lt; 0:\n            blood = 0\n            print(&quot;游戏结束!&quot;)\n        else:\n            blood = temp_blood\n    elif key == KeyCode.from_char(&#39;+&#39;):\n        temp_blood = blood + random_int\n        if temp_blood &gt; 100:\n            blood = 100\n        else:\n            blood = temp_blood\n\n    print(f&quot;当前血量 {blood}&quot;)","like_count":0},{"had_liked":false,"id":379555,"user_name":"好困啊","can_delete":false,"product_type":"c3","uid":2094450,"ip_address":"上海","ucode":"D49429660F2DC8","user_header":"https://static001.geekbang.org/account/avatar/00/1f/f5/72/8cbc5cb3.jpg","comment_is_top":false,"comment_ctime":1692096227,"is_pvip":false,"replies":null,"discussion_count":0,"race_medal":0,"score":4,"product_id":100310001,"comment_content":"from pynput.keyboard import Key, Listener, KeyCode\nimport random\n\nbackground = [[0,0,0],\n              [0,&quot;x&quot;,0],\n              [0,0,0]]\n\n# 初始化血量\nhealth = 100\n\ndef on_press(key):\n    global health\n\n    if key == KeyCode.from_char(&quot;w&quot;):\n        \n        for i in 0,1,2:\n            for j in 0,1,2:\n                if background[i][j] == &quot;x&quot; and i &gt; 0:\n                    background[i][j] = 0\n                    background[i-1][j] = &quot;x&quot;\n\n\n    elif key == KeyCode.from_char(&quot;s&quot;):\n        \n        for i in 2,1,0:\n            for j in 0,1,2:\n                if background[i][j] == &quot;x&quot; and i &lt; 2:\n                    background[i][j] = 0\n                    background[i+1][j] = &quot;x&quot;\n                    break\n\n    elif key == KeyCode.from_char(&quot;a&quot;):\n        \n        for i in 0,1,2:\n            for j in 0,1,2:\n                if background[i][j] == &quot;x&quot; and j &gt; 0:\n                    background[i][j] = 0\n                    background[i][j-1] = &quot;x&quot;\n                    break\n\n    elif key == KeyCode.from_char(&quot;d&quot;):\n        \n        for i in 2,1,0:\n            for j in 0,1,2:\n                if background[i][j] == &quot;x&quot; and j &lt; 2:\n                    background[i][j] = 0\n                    background[i][j+1] = &quot;x&quot;\n                    break\n    elif key == KeyCode.from_char(&quot;+&quot;):\n        health += random.randint(1,100)\n        if health &gt; 100:\n            health = 100\n\n    elif key == KeyCode.from_char(&quot;-&quot;):\n        health -= random.randint(1,100)\n        if health &lt; 0:\n            print(&quot;Game Over,your health is 0&quot;)\n            return False\n\n    print()\n    for site in background:\n        print(site)\n    print(f&quot;health:&quot;,{health})\n\nwith Listener(on_press=on_press) as listener:\n    listener.join()","like_count":0},{"had_liked":false,"id":377914,"user_name":"Greenery","can_delete":false,"product_type":"c3","uid":3566765,"ip_address":"","ucode":"16111129C9EBA2","user_header":"https://static001.geekbang.org/account/avatar/00/36/6c/ad/0a694b50.jpg","comment_is_top":false,"comment_ctime":1689520255,"is_pvip":false,"replies":null,"discussion_count":0,"race_medal":0,"score":4,"product_id":100310001,"comment_content":"from pynput.keyboard import Key, Listener, KeyCode\nfrom random import random\n\nblood = 1000  # 总血量[0,1000]\n\n\ndef on_press(key):\n    global blood\n    delta = int(random() * 100 + 1)\n    if key == KeyCode.from_char(&#39;+&#39;):\n        blood += delta\n        blood = blood if blood &lt; 1000 else 1000\n        print(f&quot;加血{delta}总血{blood}&quot;)\n    elif key == KeyCode.from_char(&#39;-&#39;):\n        blood -= delta\n        blood = blood if blood &gt; 0 else 0\n        print(f&quot;扣血{delta}总血{blood}&quot;)\n        if blood &lt;= 0:\n            quit()\n\n\nwith Listener(on_press=on_press) as listener:\n    listener.join()","like_count":0},{"had_liked":false,"id":377196,"user_name":"Geek_Mike","can_delete":false,"product_type":"c3","uid":3196376,"ip_address":"云南","ucode":"CFA942192C3B74","user_header":"https://static001.geekbang.org/account/avatar/00/30/c5/d8/c5509b9c.jpg","comment_is_top":false,"comment_ctime":1688048358,"is_pvip":false,"replies":null,"discussion_count":0,"race_medal":0,"score":4,"product_id":100310001,"comment_content":"#控制飞机的血量\n\nfrom pynput.keyboard import Key, Listener, KeyCode\nimport random\nhp = 100\n\ndef on_press(key):\n\n    while hp &gt; 0:\n        \n        if key == KeyCode.from_char(&#39;+&#39;) and hp == 100:\n            print(f&#39;当前HP是{hp}&#39;)\n    \n        elif key == KeyCode.from_char(&#39;+&#39;) and hp &lt; 100:\n            random_hp = random.randint(1,100)\n            hp = hp + random_hp\n            if hp &lt; 100:\n                print(f&#39;当前HP是{hp}&#39;)\n            else:\n                print(&#39;当前HP是100&#39;) \n            \n        elif key == KeyCode.from_char(&#39;-&#39;):\n            random_hp = random.randint(1,100)\n            hp = hp - random_hp\n            print(f&#39;当前HP是{hp}&#39;)\n\n    print(&#39;当前HP为0，游戏结束&#39;)\n\n因为技术原因在电脑上执行不了，用AI模拟了一下执行结果是正确的","like_count":0},{"had_liked":false,"id":376703,"user_name":"陈小菡","can_delete":false,"product_type":"c3","uid":3071892,"ip_address":"四川","ucode":"C5BAC410CC00DE","user_header":"https://thirdwx.qlogo.cn/mmopen/vi_32/DYAIOgq83eomyRD87iaxYMqJn1IchvqM1f221DKQbc25Hg4zSJftyX2RMs9qicHnoXg1Ze9OqKweAyHIJlg93gjA/132","comment_is_top":false,"comment_ctime":1687248924,"is_pvip":false,"replies":null,"discussion_count":0,"race_medal":0,"score":4,"product_id":100310001,"comment_content":"blood = 100\nprint(f&quot;你的初始血量为{blood}&quot;)\n\n\ndef on_press(key):\n    global blood\n    if key == KeyCode.from_char(&#39;+&#39;) and blood &lt; 100:\n        blood += random.randint(1, 100)\n        if blood &gt;= 100:\n            blood = 100\n        print(f&quot;你已加血，当前血量为{blood}&quot;)\n    elif key == KeyCode.from_char(&#39;-&#39;) and blood &gt; 0:\n        blood -= random.randint(1, 100)\n        if blood &lt;= 0:\n            blood = 0\n            print(&quot;你已死亡，游戏结束&quot;)\n            exit(-1)\n        else:\n            print(f&quot;你受到攻击，当前血量为{blood}&quot;)\n\n\nwith Listener(on_press=on_press) as listener:\n    listener.join()","like_count":0},{"had_liked":false,"id":375215,"user_name":"黄英镑","can_delete":false,"product_type":"c3","uid":2829525,"ip_address":"广东","ucode":"7B6853FDBA9C52","user_header":"","comment_is_top":false,"comment_ctime":1685078665,"is_pvip":false,"replies":null,"discussion_count":0,"race_medal":0,"score":4,"product_id":100310001,"comment_content":"import random\n\nfrom pynput import keyboard\n\nbackground = [[0, 0, 0],\n              [0, 1, 0],\n              [0, 0, 0]]\n\nlife = 100\n\n\ndef go_up():\n    for i, row in enumerate(background):\n        for (j, location) in enumerate(row):\n            if location and i &gt; 0:\n                background[i][j] = 0\n                background[i - 1][j] = 1\n                break\n\n\ndef go_left():\n    for i, row in enumerate(background):\n        for (j, location) in enumerate(row):\n            if location and j &gt; 0:\n                background[i][j] = 0\n                background[i][j - 1] = 1\n                break\n\n\ndef go_down():\n    moved = False\n    for i, row in enumerate(background):\n        for (j, location) in enumerate(row):\n            if location and i &lt; (len(background) - 1):\n                background[i][j] = 0\n                background[i + 1][j] = 1\n                moved = True\n                break\n        if moved:\n            break\n\n\ndef go_right():\n    for i, row in enumerate(background):\n        for (j, location) in enumerate(row):\n            if location and j &lt; (len(row) - 1):\n                background[i][j] = 0\n                background[i][j + 1] = 1\n                break\n\n\ndef on_release(key):\n    global life\n\n    if key == keyboard.KeyCode.from_char(&#39;+&#39;):\n        if life &lt; 100:\n            life += random.randint(1, (100 - life))\n    elif key == keyboard.KeyCode.from_char(&#39;-&#39;):\n        if life &gt; 0:\n            life -= random.randint(1, life)\n    elif key == keyboard.Key.up:\n        go_up()\n    elif key == keyboard.Key.left:\n        go_left()\n    elif key == keyboard.Key.down:\n        go_down()\n    elif key == keyboard.Key.right:\n        go_right()\n\n    print(&#39;当前位置：&#39;)\n    for row in background:\n        print(row)\n    print(f&#39;当前血量：{life}&#39;)\n    if life == 0:\n        print(&#39;游戏结束！&#39;)\n        return False\n\n\nwith keyboard.Listener(on_release=on_release) as listener:\n    listener.join()","like_count":0},{"had_liked":false,"id":367561,"user_name":"sunny","can_delete":false,"product_type":"c3","uid":1904632,"ip_address":"江苏","ucode":"12350F6FF873D1","user_header":"https://static001.geekbang.org/account/avatar/00/1d/0f/f8/e1b9c1cc.jpg","comment_is_top":false,"comment_ctime":1675324095,"is_pvip":false,"replies":null,"discussion_count":0,"race_medal":0,"score":4,"product_id":100310001,"comment_content":"# 血量增减\n# pip3 install pynput\nfrom pynput.keyboard import Key, Listener, KeyCode\nimport random\n\nblood = 100\n\n\ndef on_press(key):\n    global blood  #不加global的时候，在函数内部是改不了外面的全局变量的\n\n    if key == KeyCode.from_char(&#39;u&#39;):   #加血\n        ra = random.random()\n        change_blood = int(random.random() * 100 + 1)\n        blood = blood + change_blood\n        if blood &lt; 100:\n            print(f&quot;blood is {blood},continue&quot;)\n        else:\n            blood = 100\n            print(f&quot;blood is {blood},continue&quot;)\n\n    elif key == KeyCode.from_char(&#39;d&#39;):  #减血\n        ra = random.random()\n        change_blood = int(random.random() * 100 + 1)\n        blood = blood - change_blood\n        if blood &gt; 0:\n            print(f&quot;blood is {blood},continue&quot;)\n        else:\n            blood = 0\n            print(f&quot;your blood is {blood},gameover&quot;)\n            exit(0)\n\n\n\n\n\nwith Listener(on_press=on_press) as listener:\n    listener.join()","like_count":0},{"had_liked":false,"id":367282,"user_name":"朱雯","can_delete":false,"product_type":"c3","uid":1035744,"ip_address":"北京","ucode":"064C45FBF6B51F","user_header":"https://static001.geekbang.org/account/avatar/00/0f/cd/e0/c85bb948.jpg","comment_is_top":false,"comment_ctime":1675091117,"is_pvip":false,"replies":null,"discussion_count":0,"race_medal":0,"score":4,"product_id":100310001,"comment_content":"from pynput.keyboard import  Key,Listener,KeyCode\nimport random\nbackground = [[0,0,0],[0,&quot;x&quot;,0],[0,0,0]]\n# for i in background:\n#     print(i)\nhealth = 100\nprint(health)\n\ndef on_press(key):\n    global health\n    if key == KeyCode.from_char(&quot;w&quot;):\n        movehead(background)\n    if key == KeyCode.from_char(&quot;s&quot;):\n        moveback(background)\n    if key == KeyCode.from_char(&quot;a&quot;):\n        moveleft(background)\n    if key == KeyCode.from_char(&quot;d&quot;):\n        moveright(background)\n    if key == KeyCode.from_char(&quot;=&quot;):\n        if health &lt; 100:\n            health += random.randint(0,100)\n            if health &gt; 100:\n                health = 100\n    if key == KeyCode.from_char(&quot;-&quot;):\n        if health &gt; 0:\n            health -= random.randint(0,100)\n            if health &lt;= 0:\n                health = 0\n                exit(-1)\n    print(health)\n\ndef moveleft(background):\n   for i in range(0,3):\n        for j in range(0,3):\n            if background[i][j] == &#39;x&#39; and j &gt; 0:\n                background[i][j] = 0\n                background[i][j-1] = &#39;x&#39;\ndef moveright(background):\n     for i in range(0,3):\n            for j in 2,1,0:\n                if background[i][j] == &#39;x&#39; and j &lt; 2:\n                    background[i][j] = 0\n                    background[i][j+1] = &#39;x&#39;\n                    print(i,j)\ndef movehead(background):\n     for i in range(0,3):\n        for j in range(0,3):\n            if background[i][j] == &#39;x&#39; and i &gt; 0:\n                background[i][j] = 0\n                background[i-1][j] = &#39;x&#39;\n                break \ndef moveback(background):\n     for i in 2,1,0:\n        for j in range(0,3):\n            if background[i][j] == &#39;x&#39; and i &lt; 2:\n                background[i][j] = 0\n                background[i+1][j] = &#39;x&#39;\n\n\nwith Listener(on_press=on_press) as listner:\n    listner.join()","like_count":0},{"had_liked":false,"id":367277,"user_name":"朱雯","can_delete":false,"product_type":"c3","uid":1035744,"ip_address":"北京","ucode":"064C45FBF6B51F","user_header":"https://static001.geekbang.org/account/avatar/00/0f/cd/e0/c85bb948.jpg","comment_is_top":false,"comment_ctime":1675089005,"is_pvip":false,"replies":null,"discussion_count":1,"race_medal":0,"score":4,"product_id":100310001,"comment_content":"为什么我按一个键，他移动了两位，我不太理解原因是啥。","like_count":0,"discussions":[{"author":{"id":2829525,"avatar":"","nickname":"黄英镑","note":"","ucode":"7B6853FDBA9C52","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":619414,"discussion_content":"循环了两次，注意打断循环","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1685075872,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":"广东","group_id":0},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":363735,"user_name":"Matthew","can_delete":false,"product_type":"c3","uid":2843865,"ip_address":"江苏","ucode":"96093089773740","user_header":"https://thirdwx.qlogo.cn/mmopen/vi_32/PiajxSqBRaEKSVuNarJuDhBSvHY0giaq6yriceEBKiaKuc04wCYWOuso50noqDexaPJJibJN7PHwvcQppnzsDia1icZkw/132","comment_is_top":false,"comment_ctime":1670076610,"is_pvip":false,"replies":null,"discussion_count":0,"race_medal":0,"score":4,"product_id":100310001,"comment_content":"from pynput.keyboard import Key, Listener, KeyCode\nimport random\n\n# 初始血量是100\nblood_now = 100\nprint(f&quot;初始血量为：{blood_now}&quot;)\n\ndef on_press(key):\n\n    global blood_now\n\n    if key == KeyCode.from_char(&#39;+&#39;):\n        if blood_now == 100:\n            print(&quot;已达最大血量，无法增加！&quot;)\n        else:\n            blood_add = int ( random.randint(1, 100) )\n\n            if blood_now + blood_add &gt;= 100:\n                blood_now = 100\n            else:\n                blood_now = blood_now + blood_add\n\n            print(f&quot;血量增加，目前为：{blood_now}&quot;)\n\n    if  key == KeyCode.from_char(&#39;-&#39;):  \n        blood_minus = int ( random.randint(1,100) )\n\n        if blood_now - blood_minus &lt;= 0:\n            print(&quot;血量全部耗尽，游戏结束！&quot;)\n        else:            \n            blood_now = blood_now - blood_minus\n            print(f&quot;血量减少，目前为：{blood_now}&quot;)\n\n    print()\n\n\nwith Listener(on_press=on_press) as listener:\n    listener.join()","like_count":0},{"had_liked":false,"id":363580,"user_name":"PatrickL","can_delete":false,"product_type":"c3","uid":1341431,"ip_address":"上海","ucode":"EF0EC18639B9B2","user_header":"https://static001.geekbang.org/account/avatar/00/14/77/f7/11548247.jpg","comment_is_top":false,"comment_ctime":1669826539,"is_pvip":false,"replies":null,"discussion_count":0,"race_medal":0,"score":4,"product_id":100310001,"comment_content":"from pynput.keyboard import Key, Listener, KeyCode\ndef adjustBlood(key):\n    if key == KeyCode.from_char(&#39;&gt;&#39;):\n        if 0 &lt;= blood[0] &lt; 100:\n            blood[0] += 1\n            print(f&#39;血量加1，目前血量为{blood[0]}。&#39;)\n        elif blood[0] == 100:\n            print(&#39;最高血量为100，已加满。&#39;)\n        else:\n            print(&#39;血量无效。&#39;)\n    elif key == KeyCode.from_char(&#39;&lt;&#39;):\n        if 0 &lt; blood[0] &lt;= 100:\n            blood[0] -= 1\n            print(f&#39;血量减1，目前血量为{blood[0]}。&#39;)\n        elif blood[0] == 0:\n            print(&#39;最低血量为0，已扣完。&#39;)\n        else:\n            print(&#39;血量无效。&#39;)\n\nblood = [73]\nwith Listener(on_press=adjustBlood) as listener:\n    listener.join()","like_count":0},{"had_liked":false,"id":363575,"user_name":"xinn","can_delete":false,"product_type":"c3","uid":2809426,"ip_address":"陕西","ucode":"4F1F78839D3C9B","user_header":"https://static001.geekbang.org/account/avatar/00/2a/de/52/816a6bc3.jpg","comment_is_top":false,"comment_ctime":1669821897,"is_pvip":false,"replies":null,"discussion_count":0,"race_medal":0,"score":5,"product_id":100310001,"comment_content":"num = 100\nimport random\nwhile num != 0:\n    st = input()\n    if st == &quot;+&quot; :\n        a = num + random.randint(1,100)\n        num = min(100, a)\n        \n        print(f&quot;仙子的血量为{num}&quot;)\n    else :\n        b = num - random.randint(1,100)\n        num = max(0, b)\n        print(f&quot;现在的血量为{num}&quot;)\nprint(&quot;游戏结束！&quot;)","like_count":0}]}