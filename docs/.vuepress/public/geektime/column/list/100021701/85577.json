{"id":85577,"title":"39ä¸¨æ•°æ®æŒ–æ˜å®æˆ˜ï¼ˆ1ï¼‰ï¼šä¿¡ç”¨å¡è¿çº¦ç‡åˆ†æ","content":"<p>ä»Šå¤©æˆ‘æ¥å¸¦ä½ åšä¸€ä¸ªæ•°æ®æŒ–æ˜çš„é¡¹ç›®ã€‚åœ¨æ•°æ®æŒ–æ˜çš„è¿‡ç¨‹ä¸­ï¼Œæˆ‘ä»¬ç»å¸¸ä¼šé‡åˆ°ä¸€äº›é—®é¢˜ï¼Œæ¯”å¦‚ï¼šå¦‚ä½•é€‰æ‹©å„ç§åˆ†ç±»å™¨ï¼Œåˆ°åº•é€‰æ‹©å“ªä¸ªåˆ†ç±»ç®—æ³•ï¼Œæ˜¯SVMï¼Œå†³ç­–æ ‘ï¼Œè¿˜æ˜¯KNNï¼Ÿå¦‚ä½•ä¼˜åŒ–åˆ†ç±»å™¨çš„å‚æ•°ï¼Œä»¥ä¾¿å¾—åˆ°æ›´å¥½çš„åˆ†ç±»å‡†ç¡®ç‡ï¼Ÿ</p><p>è¿™ä¸¤ä¸ªé—®é¢˜ï¼Œæ˜¯æ•°æ®æŒ–æ˜æ ¸å¿ƒçš„é—®é¢˜ã€‚å½“ç„¶å¯¹äºä¸€ä¸ªæ–°çš„é¡¹ç›®ï¼Œæˆ‘ä»¬è¿˜æœ‰å…¶ä»–çš„é—®é¢˜éœ€è¦äº†è§£ï¼Œæ¯”å¦‚æŒæ¡æ•°æ®æ¢ç´¢å’Œæ•°æ®å¯è§†åŒ–çš„æ–¹å¼ï¼Œè¿˜éœ€è¦å¯¹æ•°æ®çš„å®Œæ•´æ€§å’Œè´¨é‡åšè¯„ä¼°ã€‚è¿™äº›å†…å®¹æˆ‘åœ¨ä¹‹å‰çš„è¯¾ç¨‹ä¸­éƒ½æœ‰è®²åˆ°è¿‡ã€‚</p><p>ä»Šå¤©çš„å­¦ä¹ ä¸»è¦å›´ç»•ä¸‹é¢çš„ä¸‰ä¸ªç›®æ ‡ï¼Œå¹¶é€šè¿‡å®ƒä»¬å®Œæˆä¿¡ç”¨å¡è¿çº¦ç‡é¡¹ç›®çš„å®æˆ˜ï¼Œè¿™ä¸‰ä¸ªç›®æ ‡åˆ†åˆ«æ˜¯ï¼š</p><ol>\n<li>\n<p>åˆ›å»ºå„ç§åˆ†ç±»å™¨ï¼ŒåŒ…æ‹¬å·²ç»æŒæ¡çš„SVMã€å†³ç­–æ ‘ã€KNNåˆ†ç±»å™¨ï¼Œä»¥åŠéšæœºæ£®æ—åˆ†ç±»å™¨ï¼›</p>\n</li>\n<li>\n<p>æŒæ¡GridSearchCVå·¥å…·ï¼Œä¼˜åŒ–ç®—æ³•æ¨¡å‹çš„å‚æ•°ï¼›</p>\n</li>\n<li>\n<p>ä½¿ç”¨Pipelineç®¡é“æœºåˆ¶è¿›è¡Œæµæ°´çº¿ä½œä¸šã€‚å› ä¸ºåœ¨åšåˆ†ç±»ä¹‹å‰ï¼Œæˆ‘ä»¬è¿˜éœ€è¦ä¸€äº›å‡†å¤‡è¿‡ç¨‹ï¼Œæ¯”å¦‚æ•°æ®è§„èŒƒåŒ–ï¼Œæˆ–è€…æ•°æ®é™ç»´ç­‰ã€‚</p>\n</li>\n</ol><h2>æ„å»ºéšæœºæ£®æ—åˆ†ç±»å™¨</h2><p>åœ¨ç®—æ³•ç¯‡ä¸­ï¼Œæˆ‘ä¸»è¦è®²äº†æ•°æ®æŒ–æ˜åå¤§ç»å…¸ç®—æ³•ã€‚å®é™…å·¥ä½œä¸­ï¼Œä½ ä¹Ÿå¯èƒ½ä¼šç”¨åˆ°éšæœºæ£®æ—ã€‚</p><p>éšæœºæ£®æ—çš„è‹±æ–‡æ˜¯Random Forestï¼Œè‹±æ–‡ç®€å†™æ˜¯RFã€‚å®ƒå®é™…ä¸Šæ˜¯ä¸€ä¸ªåŒ…å«å¤šä¸ªå†³ç­–æ ‘çš„åˆ†ç±»å™¨ï¼Œæ¯ä¸€ä¸ªå­åˆ†ç±»å™¨éƒ½æ˜¯ä¸€æ£µCARTåˆ†ç±»å›å½’æ ‘ã€‚æ‰€ä»¥éšæœºæ£®æ—æ—¢å¯ä»¥åšåˆ†ç±»ï¼Œåˆå¯ä»¥åšå›å½’ã€‚å½“å®ƒåšåˆ†ç±»çš„æ—¶å€™ï¼Œè¾“å‡ºç»“æœæ˜¯æ¯ä¸ªå­åˆ†ç±»å™¨çš„åˆ†ç±»ç»“æœä¸­æœ€å¤šçš„é‚£ä¸ªã€‚ä½ å¯ä»¥ç†è§£æ˜¯æ¯ä¸ªåˆ†ç±»å™¨éƒ½åšæŠ•ç¥¨ï¼Œå–æŠ•ç¥¨æœ€å¤šçš„é‚£ä¸ªç»“æœã€‚å½“å®ƒåšå›å½’çš„æ—¶å€™ï¼Œè¾“å‡ºç»“æœæ˜¯æ¯æ£µCARTæ ‘çš„å›å½’ç»“æœçš„å¹³å‡å€¼ã€‚</p><!-- [[[read_end]]] --><p>åœ¨sklearnä¸­ï¼Œæˆ‘ä»¬ä½¿ç”¨RandomForestClassifier()æ„é€ éšæœºæ£®æ—æ¨¡å‹ï¼Œå‡½æ•°é‡Œæœ‰ä¸€äº›å¸¸ç”¨çš„æ„é€ å‚æ•°ï¼š</p><p><img src=\"https://static001.geekbang.org/resource/image/35/f9/352035fe3e92d412d652fd55c77f23f9.png?wh=629*210\" alt=\"\"><br>\nå½“æˆ‘ä»¬åˆ›å»ºå¥½ä¹‹åï¼Œå°±å¯ä»¥ä½¿ç”¨fitå‡½æ•°æ‹Ÿåˆï¼Œä½¿ç”¨predictå‡½æ•°é¢„æµ‹ã€‚</p><h2>ä½¿ç”¨GridSearchCVå·¥å…·å¯¹æ¨¡å‹å‚æ•°è¿›è¡Œè°ƒä¼˜</h2><p>åœ¨åšåˆ†ç±»ç®—æ³•çš„æ—¶å€™ï¼Œæˆ‘ä»¬éœ€è¦ç»å¸¸è°ƒèŠ‚ç½‘ç»œå‚æ•°ï¼ˆå¯¹åº”ä¸Šé¢çš„æ„é€ å‚æ•°ï¼‰ï¼Œç›®çš„æ˜¯å¾—åˆ°æ›´å¥½çš„åˆ†ç±»ç»“æœã€‚å®é™…ä¸Šä¸€ä¸ªåˆ†ç±»ç®—æ³•æœ‰å¾ˆå¤šå‚æ•°ï¼Œå–å€¼èŒƒå›´ä¹Ÿæ¯”è¾ƒå¹¿ï¼Œé‚£ä¹ˆè¯¥å¦‚ä½•è°ƒä¼˜å‘¢ï¼Ÿ</p><p>Pythonç»™æˆ‘ä»¬æä¾›äº†ä¸€ä¸ªå¾ˆå¥½ç”¨çš„å·¥å…·GridSearchCVï¼Œå®ƒæ˜¯Pythonçš„å‚æ•°è‡ªåŠ¨æœç´¢æ¨¡å—ã€‚æˆ‘ä»¬åªè¦å‘Šè¯‰å®ƒæƒ³è¦è°ƒä¼˜çš„å‚æ•°æœ‰å“ªäº›ä»¥åŠå‚æ•°çš„å–å€¼èŒƒå›´ï¼Œå®ƒå°±ä¼šæŠŠæ‰€æœ‰çš„æƒ…å†µéƒ½è·‘ä¸€éï¼Œç„¶åå‘Šè¯‰æˆ‘ä»¬å“ªä¸ªå‚æ•°æ˜¯æœ€ä¼˜çš„ï¼Œç»“æœå¦‚ä½•ã€‚</p><p>ä½¿ç”¨GridSearchCVæ¨¡å—éœ€è¦å…ˆå¼•ç”¨å·¥å…·åŒ…ï¼Œæ–¹æ³•å¦‚ä¸‹ï¼š</p><pre><code>from sklearn.model_selection import GridSearchCV\n</code></pre><p>ç„¶åæˆ‘ä»¬ä½¿ç”¨GridSearchCV(estimator, param_grid, cv=None, scoring=None)æ„é€ å‚æ•°çš„è‡ªåŠ¨æœç´¢æ¨¡å—ï¼Œè¿™é‡Œæœ‰ä¸€äº›ä¸»è¦çš„å‚æ•°éœ€è¦è¯´æ˜ä¸‹ï¼š</p><p><img src=\"https://static001.geekbang.org/resource/image/70/fd/7042cb450e5dcac9306d0178265642fd.png?wh=630*183\" alt=\"\"><br>\næ„é€ å®ŒGridSearchCVä¹‹åï¼Œæˆ‘ä»¬å°±å¯ä»¥ä½¿ç”¨fitå‡½æ•°æ‹Ÿåˆè®­ç»ƒï¼Œä½¿ç”¨predictå‡½æ•°é¢„æµ‹ï¼Œè¿™æ—¶é¢„æµ‹é‡‡ç”¨çš„æ˜¯æœ€ä¼˜å‚æ•°æƒ…å†µä¸‹çš„åˆ†ç±»å™¨ã€‚</p><p>è¿™é‡Œä¸¾ä¸€ä¸ªç®€å•çš„ä¾‹å­ï¼Œæˆ‘ä»¬ç”¨sklearnè‡ªå¸¦çš„IRISæ•°æ®é›†ï¼Œé‡‡ç”¨éšæœºæ£®æ—å¯¹IRISæ•°æ®åˆ†ç±»ã€‚å‡è®¾æˆ‘ä»¬æƒ³çŸ¥é“n_estimatorsåœ¨1-10çš„èŒƒå›´å†…å–å“ªä¸ªå€¼çš„åˆ†ç±»ç»“æœæœ€å¥½ï¼Œå¯ä»¥ç¼–å†™ä»£ç ï¼š</p><pre><code># -*- coding: utf-8 -*-\n# ä½¿ç”¨RandomForestå¯¹IRISæ•°æ®é›†è¿›è¡Œåˆ†ç±»\n# åˆ©ç”¨GridSearchCVå¯»æ‰¾æœ€ä¼˜å‚æ•°\nfrom sklearn.ensemble import RandomForestClassifier\nfrom sklearn.model_selection import GridSearchCV\nfrom sklearn.datasets import load_iris\nrf = RandomForestClassifier()\nparameters = {&quot;n_estimators&quot;: range(1,11)}\niris = load_iris()\n# ä½¿ç”¨GridSearchCVè¿›è¡Œå‚æ•°è°ƒä¼˜\nclf = GridSearchCV(estimator=rf, param_grid=parameters)\n# å¯¹irisæ•°æ®é›†è¿›è¡Œåˆ†ç±»\nclf.fit(iris.data, iris.target)\nprint(&quot;æœ€ä¼˜åˆ†æ•°ï¼š %.4lf&quot; %clf.best_score_)\nprint(&quot;æœ€ä¼˜å‚æ•°ï¼š&quot;, clf.best_params_)\nè¿è¡Œç»“æœå¦‚ä¸‹ï¼š\næœ€ä¼˜åˆ†æ•°ï¼š 0.9667\næœ€ä¼˜å‚æ•°ï¼š {'n_estimators': 6}\n</code></pre><p>ä½ èƒ½çœ‹åˆ°å½“æˆ‘ä»¬é‡‡ç”¨éšæœºæ£®æ—ä½œä¸ºåˆ†ç±»å™¨çš„æ—¶å€™ï¼Œæœ€ä¼˜å‡†ç¡®ç‡æ˜¯0.9667ï¼Œå½“n_estimators=6çš„æ—¶å€™ï¼Œæ˜¯æœ€ä¼˜å‚æ•°ï¼Œä¹Ÿå°±æ˜¯éšæœºæ£®æ—ä¸€å…±æœ‰6ä¸ªå­å†³ç­–æ ‘ã€‚</p><h2>ä½¿ç”¨Pipelineç®¡é“æœºåˆ¶è¿›è¡Œæµæ°´çº¿ä½œä¸š</h2><p>åšåˆ†ç±»çš„æ—¶å€™å¾€å¾€éƒ½æ˜¯æœ‰æ­¥éª¤çš„ï¼Œæ¯”å¦‚å…ˆå¯¹æ•°æ®è¿›è¡Œè§„èŒƒåŒ–å¤„ç†ï¼Œä½ ä¹Ÿå¯ä»¥ç”¨PCAæ–¹æ³•ï¼ˆä¸€ç§å¸¸ç”¨çš„é™ç»´æ–¹æ³•ï¼‰å¯¹æ•°æ®é™ç»´ï¼Œæœ€åä½¿ç”¨åˆ†ç±»å™¨åˆ†ç±»ã€‚</p><p>Pythonæœ‰ä¸€ç§Pipelineç®¡é“æœºåˆ¶ã€‚ç®¡é“æœºåˆ¶å°±æ˜¯è®©æˆ‘ä»¬æŠŠæ¯ä¸€æ­¥éƒ½æŒ‰é¡ºåºåˆ—ä¸‹æ¥ï¼Œä»è€Œåˆ›å»ºPipelineæµæ°´çº¿ä½œä¸šã€‚æ¯ä¸€æ­¥éƒ½é‡‡ç”¨(â€˜åç§°â€™, æ­¥éª¤)çš„æ–¹å¼æ¥è¡¨ç¤ºã€‚</p><p>æˆ‘ä»¬éœ€è¦å…ˆé‡‡ç”¨StandardScaleræ–¹æ³•å¯¹æ•°æ®è§„èŒƒåŒ–ï¼Œå³é‡‡ç”¨æ•°æ®è§„èŒƒåŒ–ä¸ºå‡å€¼ä¸º0ï¼Œæ–¹å·®ä¸º1çš„æ­£æ€åˆ†å¸ƒï¼Œç„¶åé‡‡ç”¨PCAæ–¹æ³•å¯¹æ•°æ®è¿›è¡Œé™ç»´ï¼Œæœ€åé‡‡ç”¨éšæœºæ£®æ—è¿›è¡Œåˆ†ç±»ã€‚</p><p>å…·ä½“ä»£ç å¦‚ä¸‹ï¼š</p><pre><code>from sklearn.model_selection import GridSearchCV\npipeline = Pipeline([\n        ('scaler', StandardScaler()),\n        ('pca', PCA()),\n        ('randomforestclassifier', RandomForestClassifier())\n])\n</code></pre><p>é‚£ä¹ˆæˆ‘ä»¬ç°åœ¨é‡‡ç”¨Pipelineç®¡é“æœºåˆ¶ï¼Œç”¨éšæœºæ£®æ—å¯¹IRISæ•°æ®é›†åšä¸€ä¸‹åˆ†ç±»ã€‚å…ˆç”¨StandardScaleræ–¹æ³•å¯¹æ•°æ®è§„èŒƒåŒ–ï¼Œç„¶åå†ç”¨éšæœºæ£®æ—åˆ†ç±»ï¼Œç¼–å†™ä»£ç å¦‚ä¸‹ï¼š</p><pre><code># -*- coding: utf-8 -*-\n# ä½¿ç”¨RandomForestå¯¹IRISæ•°æ®é›†è¿›è¡Œåˆ†ç±»\n# åˆ©ç”¨GridSearchCVå¯»æ‰¾æœ€ä¼˜å‚æ•°,ä½¿ç”¨Pipelineè¿›è¡Œæµæ°´ä½œä¸š\nfrom sklearn.ensemble import RandomForestClassifier\nfrom sklearn.model_selection import GridSearchCV\nfrom sklearn.datasets import load_iris\nfrom sklearn.preprocessing import StandardScaler\nfrom sklearn.pipeline import Pipeline\nrf = RandomForestClassifier()\nparameters = {&quot;randomforestclassifier__n_estimators&quot;: range(1,11)}\niris = load_iris()\npipeline = Pipeline([\n        ('scaler', StandardScaler()),\n        ('randomforestclassifier', rf)\n])\n# ä½¿ç”¨GridSearchCVè¿›è¡Œå‚æ•°è°ƒä¼˜\nclf = GridSearchCV(estimator=pipeline, param_grid=parameters)\n# å¯¹irisæ•°æ®é›†è¿›è¡Œåˆ†ç±»\nclf.fit(iris.data, iris.target)\nprint(&quot;æœ€ä¼˜åˆ†æ•°ï¼š %.4lf&quot; %clf.best_score_)\nprint(&quot;æœ€ä¼˜å‚æ•°ï¼š&quot;, clf.best_params_)\nè¿è¡Œç»“æœï¼š\næœ€ä¼˜åˆ†æ•°ï¼š 0.9667\næœ€ä¼˜å‚æ•°ï¼š {'randomforestclassifier__n_estimators': 9}\n</code></pre><p>ä½ èƒ½çœ‹åˆ°æ˜¯å¦é‡‡ç”¨æ•°æ®è§„èŒƒåŒ–å¯¹ç»“æœè¿˜æ˜¯æœ‰ä¸€äº›å½±å“çš„ï¼Œæœ‰äº†GridSearchCVå’ŒPipelineè¿™ä¸¤ä¸ªå·¥å…·ä¹‹åï¼Œæˆ‘ä»¬åœ¨ä½¿ç”¨åˆ†ç±»å™¨çš„æ—¶å€™å°±ä¼šæ–¹ä¾¿å¾ˆå¤šã€‚</p><h2>å¯¹ä¿¡ç”¨å¡è¿çº¦ç‡è¿›è¡Œåˆ†æ</h2><p>æˆ‘ä»¬ç°åœ¨æ¥åšä¸€ä¸ªä¿¡ç”¨å¡è¿çº¦ç‡çš„é¡¹ç›®ï¼Œè¿™ä¸ªæ•°æ®é›†ä½ å¯ä»¥ä»GitHubä¸Šä¸‹è½½ï¼š<a href=\"https://github.com/cystanford/credit_default\">https://github.com/cystanford/credit_default</a>ã€‚</p><p>è¿™ä¸ªæ•°æ®é›†æ˜¯å°æ¹¾æŸé“¶è¡Œ2005å¹´4æœˆåˆ°9æœˆçš„ä¿¡ç”¨å¡æ•°æ®ï¼Œæ•°æ®é›†ä¸€å…±åŒ…æ‹¬25ä¸ªå­—æ®µï¼Œå…·ä½“å«ä¹‰å¦‚ä¸‹ï¼š</p><p><img src=\"https://static001.geekbang.org/resource/image/17/88/1730fb3a809c99950739e7f50e1a6988.jpg?wh=627*843\" alt=\"\"><br>\nç°åœ¨æˆ‘ä»¬çš„ç›®æ ‡æ˜¯è¦é’ˆå¯¹è¿™ä¸ªæ•°æ®é›†æ„å»ºä¸€ä¸ªåˆ†æä¿¡ç”¨å¡è¿çº¦ç‡çš„åˆ†ç±»å™¨ã€‚å…·ä½“é€‰æ‹©å“ªä¸ªåˆ†ç±»å™¨ï¼Œä»¥åŠåˆ†ç±»å™¨çš„å‚æ•°å¦‚ä½•ä¼˜åŒ–ï¼Œæˆ‘ä»¬å¯ä»¥ç”¨GridSearchCVè¿™ä¸ªå·¥å…·è·‘ä¸€éã€‚</p><p>å…ˆæ¢³ç†ä¸‹æ•´ä¸ªé¡¹ç›®çš„æµç¨‹ï¼š</p><p><img src=\"https://static001.geekbang.org/resource/image/92/a5/929c96584cbc25972f63ef39101c96a5.jpg?wh=2350*1079\" alt=\"\"></p><ol>\n<li>\n<p>åŠ è½½æ•°æ®ï¼›</p>\n</li>\n<li>\n<p>å‡†å¤‡é˜¶æ®µï¼šæ¢ç´¢æ•°æ®ï¼Œé‡‡ç”¨æ•°æ®å¯è§†åŒ–æ–¹å¼å¯ä»¥è®©æˆ‘ä»¬å¯¹æ•°æ®æœ‰æ›´ç›´è§‚çš„äº†è§£ï¼Œæ¯”å¦‚æˆ‘ä»¬æƒ³è¦äº†è§£ä¿¡ç”¨å¡è¿çº¦ç‡å’Œä¸è¿çº¦ç‡çš„äººæ•°ã€‚å› ä¸ºæ•°æ®é›†æ²¡æœ‰ä¸“é—¨çš„æµ‹è¯•é›†ï¼Œæˆ‘ä»¬è¿˜éœ€è¦ä½¿ç”¨train_test_splitåˆ’åˆ†æ•°æ®é›†ã€‚</p>\n</li>\n<li>\n<p>åˆ†ç±»é˜¶æ®µï¼šä¹‹æ‰€ä»¥æŠŠæ•°æ®è§„èŒƒåŒ–æ”¾åˆ°è¿™ä¸ªé˜¶æ®µï¼Œæ˜¯å› ä¸ºæˆ‘ä»¬å¯ä»¥ä½¿ç”¨Pipelineç®¡é“æœºåˆ¶ï¼Œå°†æ•°æ®è§„èŒƒåŒ–è®¾ç½®ä¸ºç¬¬ä¸€æ­¥ï¼Œåˆ†ç±»ä¸ºç¬¬äºŒæ­¥ã€‚å› ä¸ºæˆ‘ä»¬ä¸çŸ¥é“é‡‡ç”¨å“ªä¸ªåˆ†ç±»å™¨æ•ˆæœå¥½ï¼Œæ‰€ä»¥æˆ‘ä»¬éœ€è¦å¤šç”¨å‡ ä¸ªåˆ†ç±»å™¨ï¼Œæ¯”å¦‚SVMã€å†³ç­–æ ‘ã€éšæœºæ£®æ—å’ŒKNNã€‚ç„¶åé€šè¿‡GridSearchCVå·¥å…·ï¼Œæ‰¾åˆ°æ¯ä¸ªåˆ†ç±»å™¨çš„æœ€ä¼˜å‚æ•°å’Œæœ€ä¼˜åˆ†æ•°ï¼Œæœ€ç»ˆæ‰¾åˆ°æœ€é€‚åˆè¿™ä¸ªé¡¹ç›®çš„åˆ†ç±»å™¨å’Œè¯¥åˆ†ç±»å™¨çš„å‚æ•°ã€‚</p>\n</li>\n</ol><p>åŸºäºä¸Šé¢çš„æµç¨‹ï¼Œå…·ä½“ä»£ç å¦‚ä¸‹ï¼š</p><pre><code># -*- coding: utf-8 -*-\n# ä¿¡ç”¨å¡è¿çº¦ç‡åˆ†æ\nimport pandas as pd\nfrom sklearn.model_selection import learning_curve, train_test_split,GridSearchCV\nfrom sklearn.preprocessing import StandardScaler\nfrom sklearn.pipeline import Pipeline\nfrom sklearn.metrics import accuracy_score\nfrom sklearn.svm import SVC\nfrom sklearn.tree import DecisionTreeClassifier\nfrom sklearn.ensemble import RandomForestClassifier\nfrom sklearn.neighbors import KNeighborsClassifier\nfrom matplotlib import pyplot as plt\nimport seaborn as sns\n# æ•°æ®åŠ è½½\ndata = data = pd.read_csv('./UCI_Credit_Card.csv')\n# æ•°æ®æ¢ç´¢\nprint(data.shape) # æŸ¥çœ‹æ•°æ®é›†å¤§å°\nprint(data.describe()) # æ•°æ®é›†æ¦‚è§ˆ\n# æŸ¥çœ‹ä¸‹ä¸€ä¸ªæœˆè¿çº¦ç‡çš„æƒ…å†µ\nnext_month = data['default.payment.next.month'].value_counts()\nprint(next_month)\ndf = pd.DataFrame({'default.payment.next.month': next_month.index,'values': next_month.values})\nplt.rcParams['font.sans-serif']=['SimHei'] #ç”¨æ¥æ­£å¸¸æ˜¾ç¤ºä¸­æ–‡æ ‡ç­¾\nplt.figure(figsize = (6,6))\nplt.title('ä¿¡ç”¨å¡è¿çº¦ç‡å®¢æˆ·\\n (è¿çº¦ï¼š1ï¼Œå®ˆçº¦ï¼š0)')\nsns.set_color_codes(&quot;pastel&quot;)\nsns.barplot(x = 'default.payment.next.month', y=&quot;values&quot;, data=df)\nlocs, labels = plt.xticks()\nplt.show()\n# ç‰¹å¾é€‰æ‹©ï¼Œå»æ‰IDå­—æ®µã€æœ€åä¸€ä¸ªç»“æœå­—æ®µå³å¯\ndata.drop(['ID'], inplace=True, axis =1) #IDè¿™ä¸ªå­—æ®µæ²¡æœ‰ç”¨\ntarget = data['default.payment.next.month'].values\ncolumns = data.columns.tolist()\ncolumns.remove('default.payment.next.month')\nfeatures = data[columns].values\n# 30%ä½œä¸ºæµ‹è¯•é›†ï¼Œå…¶ä½™ä½œä¸ºè®­ç»ƒé›†\ntrain_x, test_x, train_y, test_y = train_test_split(features, target, test_size=0.30, stratify = target, random_state = 1)\n    \n# æ„é€ å„ç§åˆ†ç±»å™¨\nclassifiers = [\n    SVC(random_state = 1, kernel = 'rbf'),    \n    DecisionTreeClassifier(random_state = 1, criterion = 'gini'),\n    RandomForestClassifier(random_state = 1, criterion = 'gini'),\n    KNeighborsClassifier(metric = 'minkowski'),\n]\n# åˆ†ç±»å™¨åç§°\nclassifier_names = [\n            'svc', \n            'decisiontreeclassifier',\n            'randomforestclassifier',\n            'kneighborsclassifier',\n]\n# åˆ†ç±»å™¨å‚æ•°\nclassifier_param_grid = [\n            {'svc__C':[1], 'svc__gamma':[0.01]},\n            {'decisiontreeclassifier__max_depth':[6,9,11]},\n            {'randomforestclassifier__n_estimators':[3,5,6]} ,\n            {'kneighborsclassifier__n_neighbors':[4,6,8]},\n]\n \n# å¯¹å…·ä½“çš„åˆ†ç±»å™¨è¿›è¡ŒGridSearchCVå‚æ•°è°ƒä¼˜\ndef GridSearchCV_work(pipeline, train_x, train_y, test_x, test_y, param_grid, score = 'accuracy'):\n    response = {}\n    gridsearch = GridSearchCV(estimator = pipeline, param_grid = param_grid, scoring = score)\n    # å¯»æ‰¾æœ€ä¼˜çš„å‚æ•° å’Œæœ€ä¼˜çš„å‡†ç¡®ç‡åˆ†æ•°\n    search = gridsearch.fit(train_x, train_y)\n    print(&quot;GridSearchæœ€ä¼˜å‚æ•°ï¼š&quot;, search.best_params_)\n    print(&quot;GridSearchæœ€ä¼˜åˆ†æ•°ï¼š %0.4lf&quot; %search.best_score_)\n\tpredict_y = gridsearch.predict(test_x)\n    print(&quot;å‡†ç¡®ç‡ %0.4lf&quot; %accuracy_score(test_y, predict_y))\n    response['predict_y'] = predict_y\n    response['accuracy_score'] = accuracy_score(test_y,predict_y)\n    return response\n \nfor model, model_name, model_param_grid in zip(classifiers, classifier_names, classifier_param_grid):\n    pipeline = Pipeline([\n            ('scaler', StandardScaler()),\n            (model_name, model)\n    ])\n    result = GridSearchCV_work(pipeline, train_x, train_y, test_x, test_y, model_param_grid , score = 'accuracy')\n</code></pre><pre><code>è¿è¡Œç»“æœï¼š\n(30000, 25)\n                 ID             ...              default.payment.next.month\ncount  30000.000000             ...                            30000.000000\nmean   15000.500000             ...                                0.221200\nstd     8660.398374             ...                                0.415062\nmin        1.000000             ...                                0.000000\n25%     7500.750000             ...                                0.000000\n50%    15000.500000             ...                                0.000000\n75%    22500.250000             ...                                0.000000\nmax    30000.000000             ...                                1.000000\n\n[8 rows x 25 columns]\n\nGridSearchæœ€ä¼˜å‚æ•°ï¼š {'svc__C': 1, 'svc__gamma': 0.01}\nGridSearchæœ€ä¼˜åˆ†æ•°ï¼š 0.8174\nå‡†ç¡®ç‡ 0.8172\nGridSearchæœ€ä¼˜å‚æ•°ï¼š {'decisiontreeclassifier__max_depth': 6}\nGridSearchæœ€ä¼˜åˆ†æ•°ï¼š 0.8186\nå‡†ç¡®ç‡ 0.8113\nGridSearchæœ€ä¼˜å‚æ•°ï¼š {'randomforestclassifier__n_estimators': 6}\nGridSearchæœ€ä¼˜åˆ†æ•°ï¼š 0.7998\nå‡†ç¡®ç‡ 0.7994\nGridSearchæœ€ä¼˜å‚æ•°ï¼š {'kneighborsclassifier__n_neighbors': 8}\nGridSearchæœ€ä¼˜åˆ†æ•°ï¼š 0.8040\nå‡†ç¡®ç‡ 0.8036\n</code></pre><p><img src=\"https://static001.geekbang.org/resource/image/18/72/187d0233d4fb5f07a9653e5ae4754372.png?wh=1729*1774\" alt=\"\"><br>\nä»ç»“æœä¸­ï¼Œæˆ‘ä»¬èƒ½çœ‹åˆ°SVMåˆ†ç±»å™¨çš„å‡†ç¡®ç‡æœ€é«˜ï¼Œæµ‹è¯•å‡†ç¡®ç‡ä¸º0.8172ã€‚</p><p>åœ¨å†³ç­–æ ‘åˆ†ç±»ä¸­ï¼Œæˆ‘è®¾ç½®äº†3ç§æœ€å¤§æ·±åº¦ï¼Œå½“æœ€å¤§æ·±åº¦=6æ—¶ç»“æœæœ€ä¼˜ï¼Œæµ‹è¯•å‡†ç¡®ç‡ä¸º0.8113ï¼›åœ¨éšæœºæ£®æ—åˆ†ç±»ä¸­ï¼Œæˆ‘è®¾ç½®äº†3ä¸ªå†³ç­–æ ‘ä¸ªæ•°çš„å–å€¼ï¼Œå–å€¼ä¸º6æ—¶ç»“æœæœ€ä¼˜ï¼Œæµ‹è¯•å‡†ç¡®ç‡ä¸º0.7994ï¼›åœ¨KNNåˆ†ç±»ä¸­ï¼Œæˆ‘è®¾ç½®äº†3ä¸ªnçš„å–å€¼ï¼Œå–å€¼ä¸º8æ—¶ç»“æœæœ€ä¼˜ï¼Œæµ‹è¯•å‡†ç¡®ç‡ä¸º0.8036ã€‚</p><h2>æ€»ç»“</h2><p>ä»Šå¤©æˆ‘ç»™ä½ è®²äº†éšæœºæ£®æ—çš„æ¦‚å¿µåŠå·¥å…·çš„ä½¿ç”¨ï¼Œå¦å¤–é’ˆå¯¹æ•°æ®æŒ–æ˜ç®—æ³•ä¸­ç»å¸¸é‡‡ç”¨çš„å‚æ•°è°ƒä¼˜ï¼Œä¹Ÿä»‹ç»äº†GridSearchCVå·¥å…·è¿™ä¸ªåˆ©å™¨ã€‚å¹¶å°†è¿™ä¸¤è€…ç»“åˆèµ·æ¥ï¼Œåœ¨ä¿¡ç”¨å¡è¿çº¦åˆ†æè¿™ä¸ªé¡¹ç›®ä¸­è¿›è¡Œäº†ä½¿ç”¨ã€‚</p><p>å¾ˆå¤šæ—¶å€™ï¼Œæˆ‘ä»¬ä¸çŸ¥é“è¯¥é‡‡ç”¨å“ªç§åˆ†ç±»ç®—æ³•æ›´é€‚åˆã€‚å³ä¾¿æ˜¯å¯¹äºä¸€ç§åˆ†ç±»ç®—æ³•ï¼Œä¹Ÿæœ‰å¾ˆå¤šå‚æ•°å¯ä»¥è°ƒä¼˜ï¼Œæ¯ä¸ªå‚æ•°éƒ½æœ‰ä¸€å®šçš„å–å€¼èŒƒå›´ã€‚æˆ‘ä»¬å¯ä»¥æŠŠæƒ³è¦é‡‡ç”¨çš„åˆ†ç±»å™¨ï¼Œä»¥åŠè¿™äº›å‚æ•°çš„å–å€¼èŒƒå›´éƒ½è®¾ç½®åˆ°æ•°ç»„é‡Œï¼Œç„¶åä½¿ç”¨GridSearchCVå·¥å…·è¿›è¡Œè°ƒä¼˜ã€‚</p><p><img src=\"https://static001.geekbang.org/resource/image/14/16/14f9cddc17d6cceb0b8cbc4381c65216.png?wh=1728*1019\" alt=\"\"><br>\nä»Šå¤©æˆ‘ä»¬è®²äº†å¦‚ä½•ä½¿ç”¨GridSearchCVåšå‚æ•°è°ƒä¼˜ï¼Œä½ å¯ä»¥è¯´è¯´ä½ çš„ç†è§£ï¼Œå¦‚æœæœ‰ä½¿ç”¨çš„ç»éªŒä¹Ÿå¯ä»¥åˆ†äº«ä¸‹ã€‚</p><p>å¦å¤–é’ˆå¯¹ä¿¡ç”¨å¡è¿çº¦ç‡åˆ†æè¿™ä¸ªé¡¹ç›®ï¼Œæˆ‘ä»¬ä½¿ç”¨äº†SVMã€å†³ç­–æ ‘ã€éšæœºæ£®æ—å’ŒKNNåˆ†ç±»å™¨ï¼Œä½ èƒ½ä¸èƒ½ç¼–å†™ä»£ç ä½¿ç”¨AdaBooståˆ†ç±»å™¨åšåˆ†ç±»å‘¢ï¼Ÿå…¶ä¸­n_estimatorsçš„å–å€¼æœ‰10ã€50ã€100ä¸‰ç§å¯èƒ½ï¼Œä½ å¯ä»¥ä½¿ç”¨GridSearchCVè¿è¡Œçœ‹çœ‹æœ€ä¼˜å‚æ•°æ˜¯å¤šå°‘ï¼Œæµ‹è¯•å‡†ç¡®ç‡æ˜¯å¤šå°‘ï¼Ÿ</p><p>æ¬¢è¿ä½ åœ¨è¯„è®ºåŒºä¸æˆ‘åˆ†äº«ä½ çš„ç­”æ¡ˆï¼Œå¦‚æœæœ‰é—®é¢˜ä¹Ÿå¯ä»¥å†™åœ¨è¯„è®ºåŒºã€‚å¦‚æœä½ è§‰å¾—è¿™ç¯‡æ–‡ç« æœ‰ä»·å€¼ï¼Œæ¬¢è¿æŠŠå®ƒåˆ†äº«ç»™ä½ çš„æœ‹å‹æˆ–è€…åŒäº‹ã€‚</p><p></p>","neighbors":{"left":{"article_title":"38ä¸¨æ•°æ®å¯è§†åŒ–å®æˆ˜ï¼šå¦‚ä½•ç»™æ¯›ä¸æ˜“çš„æ­Œæ›²åšè¯äº‘å±•ç¤ºï¼Ÿ","id":85158},"right":{"article_title":"40ä¸¨æ•°æ®æŒ–æ˜å®æˆ˜ï¼ˆ2ï¼‰ï¼šä¿¡ç”¨å¡è¯ˆéª—åˆ†æ","id":85987}},"comments":[{"had_liked":false,"id":75780,"user_name":"æŸšå­","can_delete":false,"product_type":"c1","uid":1382672,"ip_address":"","ucode":"721F6C7F5DD303","user_header":"http://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTI45zO9GOMquk9JymTibN9sC25Sy4WtsDGRQzIRVIoIzPnaJGKmGe3jXqxP0zKZyTYazrXHBGYjBzw/132","comment_is_top":false,"comment_ctime":1552467995,"is_pvip":false,"discussion_count":3,"race_medal":0,"score":"130401486875","product_id":100021701,"comment_content":"è€å¸ˆï¼Œ ä½¿ç”¨GridSearchCV å·¥å…·å¤šæ¬¡æ‰§è¡Œæ¯æ¬¡ç»“æœéƒ½ä¸ä¸€æ ·ï¼Œæ˜¯æ€ä¹ˆåˆ¤å®šæœ€ä¼˜åˆ†æ•°å°±æ˜¯0.9667ï¼Œæœ€ä¼˜å‚æ•°å°±æ˜¯6å‘¢ï¼Ÿ","like_count":31,"discussions":[{"author":{"id":1914504,"avatar":"https://static001.geekbang.org/account/avatar/00/1d/36/88/20b6a6ee.jpg","nickname":"Simon","note":"","ucode":"A8A2E3E57BD029","race_medal":0,"user_type":1,"is_pvip":true},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":232011,"discussion_content":"æ­£å¸¸ï¼Œæœ¬æ–‡ä½¿ç”¨äº†éšæœºæ£®æ—ã€‚éšæœºæ£®æ—æ¯å»ºä¸€ä¸ªæ ‘éƒ½æœ‰ä¸¤æ¬¡éšæœºæŠ½æ ·ï¼šæ ·æœ¬éšæœºæŠ½æ ·å’Œå±æ€§éšæœºæŠ½æ ·ã€‚æœ¬è´¨æ˜¯ä¸ºäº†é˜²æ­¢è¿‡æ‹Ÿåˆï¼ŒåŒæ—¶æ¯æ¬¡è¿è¡Œç»“æœä¸ä¸€æ ·ã€‚","likes_number":4,"is_delete":false,"is_hidden":false,"ctime":1586845480,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1073136,"avatar":"https://static001.geekbang.org/account/avatar/00/10/5f/f0/a73607b3.jpg","nickname":"victor666","note":"","ucode":"20C9BE10E07D55","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":211634,"discussion_content":"æ˜¯ä¸æ˜¯ä½¿ç”¨éšæœºæ•°çš„åœ°æ–¹æ²¡æœ‰æŒ‡å®šéšæœºç§å­ã€‚ä¾‹å¦‚åˆ’åˆ†æµ‹è¯•ä¸è®­ç»ƒé›† è¿™æ ·æ¯æ¬¡çš„åˆ’åˆ†ç»“æœéƒ½ä¸ä¸€æ · æœ€å¥½çš„ç»“æœè‡ªç„¶ä¸ä¸€æ ·","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1584872287,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1674204,"avatar":"https://static001.geekbang.org/account/avatar/00/19/8b/dc/925e0f8a.jpg","nickname":"æ¢ä¸ªè°ƒè°ƒ","note":"","ucode":"F781C8EBB6D529","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":206523,"discussion_content":"åŒé—®ï¼Œæƒ³äº†å¥½ä¹…ä¹Ÿæ²¡æœ‰å¼„æ‡‚ï¼Œä¸ºä»€ä¹ˆæ¯æ¬¡ç»“æœéƒ½ä¸ä¸€æ ·ï¼Œå¸Œæœ›è€å¸ˆè§£æƒ‘ï¼ï¼","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1584411691,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":130634,"user_name":"è¥¿æ¹–æ™¨æ›¦","can_delete":false,"product_type":"c1","uid":1582253,"ip_address":"","ucode":"38FA2603461C5E","user_header":"https://static001.geekbang.org/account/avatar/00/18/24/ad/54571ab3.jpg","comment_is_top":false,"comment_ctime":1567498340,"is_pvip":false,"replies":[{"id":"53382","content":"ç”¨æ•°æ®åˆ†æåšåˆ†ç±»é¢„æµ‹ï¼Œä¹Ÿå°±æ˜¯é‡åˆ°äº†å…¶ä»–çš„ç”¨æˆ·æ•°æ®ï¼Œé€šè¿‡æ¨¡å‹è¿›è¡Œåˆ†ç±»é¢„æµ‹ï¼Œæˆ‘ä»¬æœ‰å¤šå°‘å‡†ç¡®ç‡å¯ä»¥é¢„æµ‹å‡ºæ¥ä»–æ˜¯å¦æ˜¯æ¬ºè¯ˆç”¨æˆ·ã€‚","user_name":"ä½œè€…å›å¤","user_name_real":"cy","uid":"1306094","ctime":1570431510,"ip_address":"","comment_id":130634,"utype":1}],"discussion_count":8,"race_medal":0,"score":"100351746148","product_id":100021701,"comment_content":"æˆ‘æ˜¯é“¶è¡Œä¿¡ç”¨å¡éƒ¨çš„ä»ä¸šäººå‘˜ï¼Œä¹Ÿå¾ˆå–œæ¬¢æ•°æ®åˆ†æã€‚<br><br>ä½†æ˜¯çœ‹äº†è¿™ä¸ªæ¡ˆä¾‹ï¼Œæ„Ÿè§‰è¿™ä¸ªæ¡ˆä¾‹èƒ½å¤Ÿç»™ä¿¡ç”¨å¡çš„æ•°æ®åˆ†æå¸¦æ¥ä»€ä¹ˆå‘¢ï¼Ÿæˆ‘çš„æ„æ€æ˜¯ï¼Œèƒ½å¤Ÿåˆ†æå‡ºä»€ä¹ˆé—®é¢˜å—ï¼Ÿé“¶è¡Œä¿¡ç”¨å¡éƒ¨åº”è¯¥åœ¨æŒå¡äººç”¨å¡çš„ä»€ä¹ˆé˜¶æ®µå¼€å§‹å¼€å§‹è¦é‡‡å–æªæ–½é˜²æ­¢è¯ˆéª—ï¼Ÿä»€ä¹ˆç±»å‹çš„å®¢æˆ·å®¹æ˜“è¯ˆéª—ï¼Ÿ---æ„Ÿè§‰è¿™ä¸ªæ¡ˆä¾‹å°±æ˜¯ä»æ•°å­—åˆ°æ•°å­—ï¼Œæ²¡æœ‰èƒ½å¤Ÿç»™çœŸå®ä¸šåŠ¡å¸¦æ¥ä»€ä¹ˆå¸®åŠ©ã€‚<br><br>-----ä¹Ÿæƒ³å¯¹ä»äº‹æ•°æ®åˆ†æçš„äººå‘˜æä¸ªé†’ï¼Œæ•°æ®åˆ†æä¸æ˜¯ä»çº¯æ•°å­—åˆ°çº¯æ•°å­—çš„çº¯å­¦æœ¯ç ”ç©¶ï¼Œåº”è¯¥æ˜¯è”ç³»å®é™…å·¥ä½œï¼Œèƒ½å¤Ÿç»™å®é™…å·¥ä½œå¸¦æ¥å¸®åŠ©çš„å•Šï¼è”ç³»åˆ°æ­¤æ¡ˆä¾‹ï¼Œåº”è¯¥æ˜¯èƒ½å¤Ÿç»™é“¶è¡Œä¿¡ç”¨å¡éƒ¨çš„é˜²æ¬ºè¯ˆå·¥ä½œå¸¦æ¥æå‡çš„å•Š~åˆ†æäº†ä»€ä¹ˆå‡ºæ¥ï¼Ÿé“¶è¡Œçš„å“ªä¸ªç¯èŠ‚åº”è¯¥æå‡ä»¥é˜²æ­¢æ¬ºè¯ˆï¼Ÿ","like_count":24,"discussions":[{"author":{"id":1306094,"avatar":"https://static001.geekbang.org/account/avatar/00/13/ed/ee/c4779b67.jpg","nickname":"cy","note":"","ucode":"50D653399A31F6","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":466042,"discussion_content":"ç”¨æ•°æ®åˆ†æåšåˆ†ç±»é¢„æµ‹ï¼Œä¹Ÿå°±æ˜¯é‡åˆ°äº†å…¶ä»–çš„ç”¨æˆ·æ•°æ®ï¼Œé€šè¿‡æ¨¡å‹è¿›è¡Œåˆ†ç±»é¢„æµ‹ï¼Œæˆ‘ä»¬æœ‰å¤šå°‘å‡†ç¡®ç‡å¯ä»¥é¢„æµ‹å‡ºæ¥ä»–æ˜¯å¦æ˜¯æ¬ºè¯ˆç”¨æˆ·ã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1570431510,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1131414,"avatar":"https://static001.geekbang.org/account/avatar/00/11/43/96/5bbfc853.jpg","nickname":"superMOæ½¼","note":"","ucode":"AEE2274BF75E44","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":293508,"discussion_content":"æœ‰ç›‘ç£å­¦ä¹ ï¼Œé€šè¿‡æ ‡æ³¨çš„å¥½åå®¢æˆ·å»ºç«‹æ¨¡å‹ï¼Œæ–°å®¢æˆ·æ¥çš„æ—¶å€™é¢„æµ‹æ˜¯ä¸æ˜¯åå®¢æˆ·ï¼Œåå®¢æˆ·å°±æ‹’äº†ã€‚ä¸è¿‡ä¸€èˆ¬å®è·µè¿‡ç¨‹ä¸­å¸¸ç”¨è¯„åˆ†å¡åˆ†è´·å‰ï¼Œè´·ä¸­ï¼Œè´·åå»ºç«‹ä¸åŒæ¨¡å‹ï¼Œå¯¹åº”è´·å‰åæ¬ºè¯ˆï¼Œæˆä¿¡é¢åº¦æµ‹ç®—ï¼Œè´·ä¸­é£é™©é¢„è­¦ï¼Œè´·åå‚¬æ”¶","likes_number":2,"is_delete":false,"is_hidden":false,"ctime":1595561387,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1828866,"avatar":"http://thirdwx.qlogo.cn/mmopen/vi_32/DYAIOgq83erJEqa95HvFXL7kN2mT4SLWMhMb6XscnlTXN9EZq9fLuialHzQVDdoT0icGziacvs8YibxGdHej1JxR4w/132","nickname":"é™¶å†€","note":"","ucode":"5B7B21E61BDD32","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":590032,"discussion_content":"è¿™é‡Œçš„æ•°æ®ç»™äº†æ˜¯å¦è¿çº¦çš„ç»“æœæ•°æ®ï¼Œä½ ç”¨æœ‰ç»“æœçš„æ•°æ®è®­ç»ƒå¥½æ¨¡å‹åã€‚å¯¹äºä»¥åæ–°çš„å®¢æˆ·æ•°æ®ï¼Œå¯ä»¥ç”¨æ¥é¢„æµ‹æ˜¯å¦è¿çº¦ã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1665481564,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":"ä¸­å›½é¦™æ¸¯"},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1919541,"avatar":"https://static001.geekbang.org/account/avatar/00/1d/4a/35/66caeed9.jpg","nickname":"å®Œç¾åšæŒ","note":"","ucode":"AE0261D8DDEF64","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":369333,"discussion_content":"ç»™æ‚¨ç‚¹èµ","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1619007371,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1149004,"avatar":"https://static001.geekbang.org/account/avatar/00/11/88/4c/2c3d2c7d.jpg","nickname":"å°å¼º","note":"","ucode":"CC3D3A9E5D9A42","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":308036,"discussion_content":"å­¦åˆ°è¿™é‡Œï¼Œè¿™æ˜¯å­¦ä¹ è€…æœ€å¤§çš„å›°æƒ‘ï¼Œä¸çŸ¥é“æ˜¯ä¸æ˜¯æˆ‘è„‘å­ä¸å¥½ä½¿ï¼Œæ€»è§‰å¾—å·®å¾ˆå¤šï¼Œå­¦çš„ä¸å¥½ï¼Œæ²¡å¤ªå¤§ä»·å€¼ï¼Œè¿˜æ˜¯éœ€è¦çœ‹å…¶ä»–èµ„æ–™æ¥å­¦ä¹ ï¼ŒæŠŠä¸æ‡‚çš„å†é‡æ–°æ‰¾èµ„æ–™å­¦ä¹ ï¼Œåªèµ·åˆ°äº†é•¿è§è¯†çš„ä½œç”¨","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1600828104,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1073136,"avatar":"https://static001.geekbang.org/account/avatar/00/10/5f/f0/a73607b3.jpg","nickname":"victor666","note":"","ucode":"20C9BE10E07D55","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":211637,"discussion_content":"æ£’ï¼","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1584872326,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1903481,"avatar":"https://static001.geekbang.org/account/avatar/00/1d/0b/79/4202ffc6.jpg","nickname":"ğŸŒ•","note":"","ucode":"85899FCC7FB482","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":201857,"discussion_content":"è°¢è°¢æ‚¨çš„æé†’","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1583845403,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1582253,"avatar":"https://static001.geekbang.org/account/avatar/00/18/24/ad/54571ab3.jpg","nickname":"è¥¿æ¹–æ™¨æ›¦","note":"","ucode":"38FA2603461C5E","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":36307,"discussion_content":"è°¢è°¢è€å¸ˆçš„å›å¤~\n","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1571361375,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":75573,"user_name":"vortual","can_delete":false,"product_type":"c1","uid":1258515,"ip_address":"","ucode":"1161CD103110C0","user_header":"https://static001.geekbang.org/account/avatar/00/13/34/13/d43ff5ed.jpg","comment_is_top":false,"comment_ctime":1552436800,"is_pvip":false,"replies":[{"id":"64431","content":"æ·±åº¦å­¦ä¹  æ˜¯å¸®ä½ å‘ç°ä¸€äº›ä¸å¤ªæ˜æ˜¾ï¼ˆçº¿æ€§æƒ…å†µä¸‹ä¸å®¹æ˜“ï¼‰å‘ç°çš„è§„å¾‹ã€‚æœ‰æ—¶å€™ ä½ å¯ä»¥å…ˆç”¨æœºå™¨å­¦ä¹ å¾—åˆ°ä¸€ä¸ªbaselineï¼Œç„¶åå†è€ƒè™‘ç”¨ NNæ¨¡å‹ï¼Œæ¯•ç«Ÿæ·±åº¦æ¨¡å‹è®¡ç®—é‡å¤§ï¼Œæœ‰æ—¶å€™è¿˜éœ€è¦GPU","user_name":"ä½œè€…å›å¤","user_name_real":"cy","uid":"1306094","ctime":1577619148,"ip_address":"","comment_id":75573,"utype":1}],"discussion_count":1,"race_medal":0,"score":"57387011648","product_id":100021701,"comment_content":"è€å¸ˆï¼Œå®é™…å·¥ä½œä¸­æ•°æ®é‡å¤§çš„è¯è·‘ä¸ªæ¨¡å‹åº”è¯¥è¦ä¸å°‘æ—¶é—´ï¼Œåº”è¯¥ä¸å…è®¸è¿™ä¹ˆå»è¯•æ‰€æœ‰å‚æ•°å’Œé‚£ä¹ˆå¤šç®—æ³•å§ï¼Ÿè¿˜æœ‰ä¸€ä¸ªç–‘é—®æ˜¯æ•°æ®é‡è¶…è¿‡ä¸€å®šé‡æ˜¯ä¸æ˜¯è¦ç”¨æ·±åº¦å­¦ä¹ äº†ï¼Ÿå¸Œæœ›è€å¸ˆèƒ½è§£æƒ‘ä¸‹","like_count":14,"discussions":[{"author":{"id":1306094,"avatar":"https://static001.geekbang.org/account/avatar/00/13/ed/ee/c4779b67.jpg","nickname":"cy","note":"","ucode":"50D653399A31F6","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":442949,"discussion_content":"æ·±åº¦å­¦ä¹  æ˜¯å¸®ä½ å‘ç°ä¸€äº›ä¸å¤ªæ˜æ˜¾ï¼ˆçº¿æ€§æƒ…å†µä¸‹ä¸å®¹æ˜“ï¼‰å‘ç°çš„è§„å¾‹ã€‚æœ‰æ—¶å€™ ä½ å¯ä»¥å…ˆç”¨æœºå™¨å­¦ä¹ å¾—åˆ°ä¸€ä¸ªbaselineï¼Œç„¶åå†è€ƒè™‘ç”¨ NNæ¨¡å‹ï¼Œæ¯•ç«Ÿæ·±åº¦æ¨¡å‹è®¡ç®—é‡å¤§ï¼Œæœ‰æ—¶å€™è¿˜éœ€è¦GPU","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1577619148,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":202871,"user_name":"CR77","can_delete":false,"product_type":"c1","uid":1933444,"ip_address":"","ucode":"138F832024B01E","user_header":"https://static001.geekbang.org/account/avatar/00/1d/80/84/a7af5eae.jpg","comment_is_top":false,"comment_ctime":1586078287,"is_pvip":false,"replies":[{"id":"104327","content":"1. æ˜¯å¦éœ€è¦å½’ä¸€åŒ–ï¼Œå–å†³äºæ‰€ä½¿ç”¨çš„æ¨¡å‹ã€‚å¦‚æœæ˜¯æ ‘æ¨¡å‹ï¼Œåªåœ¨æ„ä»–ä»¬çš„ç›¸å¯¹å¤§å°ä¸åœ¨æ„å®é™…è·ç¦»ï¼Œå…¶å®å¯ä»¥ä¸å½’ä¸€åŒ–ã€‚<br>2. ä¸é”™çš„æƒ³æ³•ï¼Œå¯ä»¥å°è¯•ä¸‹ã€‚<br>3. ä¸‹é‡‡æ ·æ˜¯è§£å†³æ ·æœ¬æåº¦ä¸å‡è¡¡çš„å¸¸ç”¨æ–¹æ³•ï¼Œæœ‰åŒå­¦ä¹Ÿç¡®å®å¾—åˆ°äº†ä¸é”™çš„æ•ˆæœï¼Œå¯ä»¥å°è¯•ä¸‹ã€‚<br>4. åœ¨å®é™…åº”ç”¨ä¸­ï¼Œå¯ä»¥åˆ©ç”¨è¯¥æ¨¡å‹å¯¹é«˜é£é™©å®¢æˆ·çš„é¢åº¦è¿›è¡Œé™åˆ¶ï¼Œä¹Ÿå¯ä»¥ç”¨æ¥é™åˆ¶ä»–ä»¬çš„è´·æ¬¾ç­‰ç­‰ã€‚","user_name":"ä½œè€…å›å¤","user_name_real":"cy","uid":"1306094","ctime":1617902518,"ip_address":"","comment_id":202871,"utype":1}],"discussion_count":2,"race_medal":0,"score":"23060914767","product_id":100021701,"comment_content":"åœ¨åšçš„æ—¶å€™åˆå¦‚ä¸‹é—®é¢˜ï¼Œæˆ‘è§‰å¾—éœ€è¦æ³¨æ„ï¼š<br>ç¬¬ä¸€ã€PAY_0åˆ°PAY_6ç»å…¸æŒ‡æ ‡æ€§çš„ç‰¹å¾ï¼Œä½†æ˜¯å…·ä½“ä»€ä¹ˆæ„ä¹‰ä¸çŸ¥é“ï¼Œä¸ªäººè®¤ä¸ºä¸åº”è¯¥è‰è‰çš„å½’ä¸€åŒ–ã€‚<br>ç¬¬äºŒï¼Œæ¯æœˆè´¦å•é‡‘é¢ä½“ç°çš„æ˜¯å®¢æˆ·çš„æ¶ˆè´¹æ°´å¹³ï¼Œæ¯æœˆçš„è¿˜æ¬¾é‡‘é¢ä½“ç°çš„æ˜¯å®¢æˆ·çš„å®é™…ç»æµæƒ…å†µï¼ˆå½“ç„¶ä¸æ’é™¤é‚£äº›ï¼Œæœ‰é’±ä½†æ˜¯ä¸è¿˜æ¬¾çš„æƒ…å†µï¼‰ï¼Œæ‰€ä»¥æˆ‘æƒ³èƒ½ä¸èƒ½å°†ï¼ˆæ¯æœˆçš„è´¦å•é‡‘é¢ - æ¯æœˆçš„è¿˜æ¬¾é‡‘é¢ï¼‰è®¾ç½®ä¸ºä¸€ä¸ªæ–°çš„ç‰¹å¾ï¼Œå¯èƒ½èƒ½æ›´åŠ è´´è¿‘ç”¨æˆ·çš„å®é™…ç»æµæƒ…å†µã€‚<br>ç¬¬ä¸‰ï¼Œæ˜¯å¦éœ€è¦é‡‡ç”¨ä¸‹é‡‡æ ·ï¼Ÿå› ä¸ºæ¯•ç«Ÿæ­£è´Ÿæ ·æœ¬çš„æ¯”ä¾‹æ˜¯æœ‰ä¸€å®šçš„å·®è·çš„ï¼Œæˆ‘ä»¬æ¨¡å‹è®­ç»ƒå‡ºæ¥çš„æ•ˆæœå¹¶ä¸æ˜¯å¾ˆå¥½æ˜¯ä¸æ˜¯æœ‰å…³ç³»<br>ç¬¬å››ï¼Œé—®é¢˜çš„å®é™…æ„ä¹‰çš„åˆ†æï¼Œè¿™æ˜¯ä¸€ä¸ªè¿çº¦ç‡çš„æ•°æ®æŒ–æ˜ï¼Œæ›´å¤šçš„å¯ä»¥è¯´æ˜¯ä¸€ç§åˆ†æï¼Œæˆ‘ä»¬å¾—åˆ°çš„ç»“æœæ˜¯ä»€ä¹ˆï¼Œæ˜¯ä¸€ä¸ªæ–°çš„å®¢æˆ·åœ¨äº§ç”Ÿç§ç§äº¤æ˜“ä¹‹åï¼Œä»–è¿çº¦çš„å¯èƒ½ï¼Œè¿™æ˜¯æˆ‘èƒ½æƒ³åˆ°çš„æ„ä¹‰ï¼Œæ”¾åˆ°å•†ä¸šä¸Šçš„è¯æˆ‘ä»¬å®é™…ä¸Šæ˜¯è¦åšå‡ºæ€ä¹ˆæ ·çš„å†³ç­–å‘¢ï¼Ÿ","like_count":5,"discussions":[{"author":{"id":1306094,"avatar":"https://static001.geekbang.org/account/avatar/00/13/ed/ee/c4779b67.jpg","nickname":"cy","note":"","ucode":"50D653399A31F6","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":490703,"discussion_content":"1. æ˜¯å¦éœ€è¦å½’ä¸€åŒ–ï¼Œå–å†³äºæ‰€ä½¿ç”¨çš„æ¨¡å‹ã€‚å¦‚æœæ˜¯æ ‘æ¨¡å‹ï¼Œåªåœ¨æ„ä»–ä»¬çš„ç›¸å¯¹å¤§å°ä¸åœ¨æ„å®é™…è·ç¦»ï¼Œå…¶å®å¯ä»¥ä¸å½’ä¸€åŒ–ã€‚\n2. ä¸é”™çš„æƒ³æ³•ï¼Œå¯ä»¥å°è¯•ä¸‹ã€‚\n3. ä¸‹é‡‡æ ·æ˜¯è§£å†³æ ·æœ¬æåº¦ä¸å‡è¡¡çš„å¸¸ç”¨æ–¹æ³•ï¼Œæœ‰åŒå­¦ä¹Ÿç¡®å®å¾—åˆ°äº†ä¸é”™çš„æ•ˆæœï¼Œå¯ä»¥å°è¯•ä¸‹ã€‚\n4. åœ¨å®é™…åº”ç”¨ä¸­ï¼Œå¯ä»¥åˆ©ç”¨è¯¥æ¨¡å‹å¯¹é«˜é£é™©å®¢æˆ·çš„é¢åº¦è¿›è¡Œé™åˆ¶ï¼Œä¹Ÿå¯ä»¥ç”¨æ¥é™åˆ¶ä»–ä»¬çš„è´·æ¬¾ç­‰ç­‰ã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1617902518,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":2864924,"avatar":"https://static001.geekbang.org/account/avatar/00/2b/b7/1c/b5c9456b.jpg","nickname":"Jeff","note":"","ucode":"F9230D1FA48AE1","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":566104,"discussion_content":"ç¬¬äºŒä¸ªé—®é¢˜ï¼Œå¦‚æœã€æ¯æœˆçš„è´¦å•é‡‘é¢ - æ¯æœˆçš„è¿˜æ¬¾é‡‘é¢ï¼‰è®¾ç½®ä¸ºä¸€ä¸ªæ–°çš„ç‰¹å¾ã€‘ï¼Œè¿™ä¸ªæ–°ç‰¹å¾å’ŒåŸç‰¹å¾æ˜¯å®Œå…¨çº¿æ€§ç›¸å…³çš„ï¼Œè¿™æ ·æ˜¯ä¸æ˜¯ä¸åˆç†?","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1650603140,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":75867,"user_name":"ç‹å½¬æˆ","can_delete":false,"product_type":"c1","uid":1015045,"ip_address":"","ucode":"386803B8FC2DD5","user_header":"https://static001.geekbang.org/account/avatar/00/0f/7d/05/4bad0c7c.jpg","comment_is_top":false,"comment_ctime":1552484768,"is_pvip":false,"replies":[{"id":"64423","content":"Good Job","user_name":"ä½œè€…å›å¤","user_name_real":"cy","uid":"1306094","ctime":1577618958,"ip_address":"","comment_id":75867,"utype":1}],"discussion_count":1,"race_medal":0,"score":"23027321248","product_id":100021701,"comment_content":"GridSearchæœ€ä¼˜å‚æ•°ï¼š {&#39;n_estimators&#39;: 10}<br>GridSearchæœ€ä¼˜åˆ†æ•°ï¼š 0.8187<br>å‡†ç¡®ç‡ 0.8129<br>-----ä»£ç ------<br><br># -*- coding: utf-8 -*-<br># ä¿¡ç”¨å¡è¿çº¦ç‡åˆ†æ<br>import pandas as pd<br>from sklearn.model_selection import learning_curve, train_test_split,GridSearchCV<br>from sklearn.preprocessing import StandardScaler<br>from sklearn.pipeline import Pipeline<br>from sklearn.metrics import accuracy_score<br>from sklearn.ensemble import AdaBoostClassifier<br><br>from matplotlib import pyplot as plt<br>import seaborn as sns<br># æ•°æ®åŠ è½½<br>data=data=pd.read_csv(&#39;.&#47;credit_default-master&#47;UCI_Credit_Card.csv&#39;)<br># æ•°æ®æ¢ç´¢<br>print(data.shape) # æŸ¥çœ‹æ•°æ®é›†å¤§å°<br>print(data.describe()) # æ•°æ®é›†æ¦‚è§ˆ<br># æŸ¥çœ‹ä¸‹ä¸€ä¸ªæœˆè¿çº¦ç‡çš„æƒ…å†µ<br>next_month = data[&#39;default.payment.next.month&#39;].value_counts()<br>print(next_month)<br>df = pd.DataFrame({&#39;default.payment.next.month&#39;: next_month.index,&#39;values&#39;: next_month.values})<br>plt.rcParams[&#39;font.sans-serif&#39;]=[&#39;SimHei&#39;] #ç”¨æ¥æ­£å¸¸æ˜¾ç¤ºä¸­æ–‡æ ‡ç­¾<br>plt.figure(figsize = (6,6))<br>plt.title(&#39;ä¿¡ç”¨å¡è¿çº¦ç‡å®¢æˆ·\\n (è¿çº¦ï¼š1ï¼Œå®ˆçº¦ï¼š0)&#39;)<br>sns.set_color_codes(&quot;pastel&quot;)<br>sns.barplot(x = &#39;default.payment.next.month&#39;, y=&quot;values&quot;, data=df)<br>locs, labels = plt.xticks()<br>plt.show()<br># ç‰¹å¾é€‰æ‹©ï¼Œå»æ‰IDå­—æ®µã€æœ€åä¸€ä¸ªç»“æœå­—æ®µå³å¯<br>data.drop([&#39;ID&#39;], inplace=True, axis =1) #IDè¿™ä¸ªå­—æ®µæ²¡æœ‰ç”¨<br>target = data[&#39;default.payment.next.month&#39;].values<br>columns = data.columns.tolist()<br>columns.remove(&#39;default.payment.next.month&#39;)<br>features = data[columns].values<br># 30%ä½œä¸ºæµ‹è¯•é›†ï¼Œå…¶ä½™ä½œä¸ºè®­ç»ƒé›†<br>train_x, test_x, train_y, test_y = train_test_split(features, target, test_size=0.30, stratify = target, random_state = 1)<br><br><br>#åˆ†ç±»å™¨<br>ada=AdaBoostClassifier( random_state=1)<br>#éœ€è¦è°ƒæ•´çš„å‚æ•°<br>parameters={&#39;n_estimators&#39;:[10,50,100]}<br><br># ä½¿ç”¨ GridSearchCV è¿›è¡Œå‚æ•°è°ƒä¼˜<br>clf=GridSearchCV(estimator=ada,param_grid=parameters,scoring = &#39;accuracy&#39;)<br><br>clf.fit(train_x,train_y)<br>print(&quot;GridSearchæœ€ä¼˜å‚æ•°ï¼š&quot;, clf.best_params_)<br>print(&quot;GridSearchæœ€ä¼˜åˆ†æ•°ï¼š %0.4lf&quot; %clf.best_score_)<br>predict_y=clf.predict(test_x)<br>print(&quot;å‡†ç¡®ç‡ %0.4lf&quot; %accuracy_score(test_y, predict_y))<br> <br><br><br>","like_count":5,"discussions":[{"author":{"id":1306094,"avatar":"https://static001.geekbang.org/account/avatar/00/13/ed/ee/c4779b67.jpg","nickname":"cy","note":"","ucode":"50D653399A31F6","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":443064,"discussion_content":"Good Job","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1577618958,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":75728,"user_name":"è·³è·³","can_delete":false,"product_type":"c1","uid":1172803,"ip_address":"","ucode":"80B697B89E1A0B","user_header":"https://static001.geekbang.org/account/avatar/00/11/e5/43/7bc7cfe3.jpg","comment_is_top":false,"comment_ctime":1552459671,"is_pvip":false,"replies":[{"id":"64430","content":"å¯¹çš„ ç»™ä¸€ä¸ªèŒƒå›´è®©GridSearchCV åˆ©ç”¨ç©·ä¸¾æ‰¾åˆ°æœ€ä¼˜","user_name":"ä½œè€…å›å¤","user_name_real":"cy","uid":"1306094","ctime":1577619084,"ip_address":"","comment_id":75728,"utype":1}],"discussion_count":1,"race_medal":0,"score":"23027296151","product_id":100021701,"comment_content":"1.å¯¹GridSearchCVçš„ç†è§£ï¼šå°±æ˜¯åœ¨ä¹‹å‰çš„ç»éªŒçš„åŸºç¡€ä¸Šé€‰æ‹©äº†ä¸€äº›è¾ƒå¥½çš„å–å€¼å¤‡é€‰ï¼Œç„¶ååˆ†åˆ«å»è¯•ï¼Œå¾—åˆ°ä¸€ä¸ªå¥½çš„æ€§èƒ½ã€‚æ¯”ç›´æ¥é€‰æ‹©å‚æ•°å¤šäº†ä¸€äº›ä¿éšœï¼Œä½†æ˜¯ä¹Ÿå¢åŠ ä¸€äº›è®¡ç®—è´Ÿæ‹…ã€‚<br>2.åœ¨è€å¸ˆä»£ç çš„åŸºç¡€ä¸Šæ·»åŠ äº†adabooståˆ†ç±»ï¼Œä½¿ç”¨adaboosté»˜è®¤çš„åˆ†ç±»å™¨ï¼Œç»“æœæ˜¯åœ¨n_estimators=10çš„æ—¶å€™å–å¾—æœ€ä¼˜æ€§èƒ½ï¼Œå‡†ç¡®ç‡æ˜¯0.8187<br>GridSearch æœ€ä¼˜å‚æ•°ï¼š {&#39;AdaBoostClassifier__n_estimators&#39;: 10}<br>GridSearch æœ€ä¼˜åˆ†æ•°ï¼š 0.8187<br> å‡†ç¡®ç‡ 0.8129","like_count":5,"discussions":[{"author":{"id":1306094,"avatar":"https://static001.geekbang.org/account/avatar/00/13/ed/ee/c4779b67.jpg","nickname":"cy","note":"","ucode":"50D653399A31F6","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":443004,"discussion_content":"å¯¹çš„ ç»™ä¸€ä¸ªèŒƒå›´è®©GridSearchCV åˆ©ç”¨ç©·ä¸¾æ‰¾åˆ°æœ€ä¼˜","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1577619084,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":78198,"user_name":"third","can_delete":false,"product_type":"c1","uid":1025114,"ip_address":"","ucode":"9A37408A834F0B","user_header":"https://static001.geekbang.org/account/avatar/00/0f/a4/5a/e708e423.jpg","comment_is_top":false,"comment_ctime":1553091893,"is_pvip":false,"replies":[{"id":"64390","content":"å¯ä»¥å±è”½ warning","user_name":"ä½œè€…å›å¤","user_name_real":"cy","uid":"1306094","ctime":1577618214,"ip_address":"","comment_id":78198,"utype":1}],"discussion_count":2,"race_medal":0,"score":"18732961077","product_id":100021701,"comment_content":"æé—®ï¼šè€æ˜¯å‡ºç°futureWarning,æ˜¯ä»€ä¹ˆæƒ…å†µ<br><br>GridSearchæœ€ä¼˜å‚æ•°ï¼š {&#39;n_estimators&#39;: 10}<br>GridSearchæœ€ä¼˜åˆ†æ•°ï¼š 0.8187<br>å‡†ç¡®ç‡ 0.8129","like_count":4,"discussions":[{"author":{"id":1306094,"avatar":"https://static001.geekbang.org/account/avatar/00/13/ed/ee/c4779b67.jpg","nickname":"cy","note":"","ucode":"50D653399A31F6","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":444001,"discussion_content":"å¯ä»¥å±è”½ warning","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1577618214,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1022786,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/9b/42/aeb79b35.jpg","nickname":"Ling","note":"","ucode":"EE15D1ABDB073B","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":55935,"discussion_content":"from warnings import simplefilter\n\nsimplefilter(action=&#39;ignore&#39;, category=FutureWarning)","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1574414320,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":75873,"user_name":"ç‹å½¬æˆ","can_delete":false,"product_type":"c1","uid":1015045,"ip_address":"","ucode":"386803B8FC2DD5","user_header":"https://static001.geekbang.org/account/avatar/00/0f/7d/05/4bad0c7c.jpg","comment_is_top":false,"comment_ctime":1552485879,"is_pvip":false,"replies":[{"id":"64428","content":"æ„Ÿè°¢åˆ†äº«","user_name":"ä½œè€…å›å¤","user_name_real":"cy","uid":"1306094","ctime":1577619039,"ip_address":"","comment_id":75873,"utype":1}],"discussion_count":1,"race_medal":0,"score":"18732355063","product_id":100021701,"comment_content":"ä½¿ç”¨ Pipeline ç®¡é“æœºåˆ¶çš„ä¼˜åŠ¿ï¼Œå‚è€ƒèµ„æ–™ï¼š<br>https:&#47;&#47;www.jianshu.com&#47;p&#47;9c2c8c8ef42d<br>https:&#47;&#47;blog.csdn.net&#47;qq_41598851&#47;article&#47;details&#47;80957893<br><br>ä¸ªäººç†è§£ï¼š<br>Pipelineæ˜¯å°†æ•°æ®å¤„ç†æµç¨‹çš„å…±åŒéƒ¨åˆ†æå–å‡ºæ¥ï¼Œç®€åŒ–ä»£ç ã€‚<br>ä»¥æœ¬æ–‡æœ€åçš„ç¼–ç¨‹æ¡ˆä¾‹ä¸ºä¾‹ï¼Œå…±åŒéƒ¨åˆ†æ˜¯â€œæ•°æ®è§„èŒƒåŒ–â€å’Œâ€œä½¿ç”¨æ•°æ®åˆ†ç±»ç®—æ³•â€ï¼Œå°†ä¿©éƒ¨åˆ†å°è£…ã€‚<br>åœ¨æ¯ä¸€æ¬¡å¾ªç¯â€œç®—æ³•â€æ—¶ï¼Œpipelineé‡Œå¤´å®Œæˆç®—æ³•æ›´æ–°ã€‚GridSearchCVå¼•ç”¨å›ºå®šçš„pipelineï¼Œå®åˆ™ç®—æ³•å·²ç»æ›´æ–°äº†ã€‚è¿™æ ·å‡å°‘äº†å¤šä½™ä»£ç çš„ä¹¦å†™ã€‚<br>","like_count":4,"discussions":[{"author":{"id":1306094,"avatar":"https://static001.geekbang.org/account/avatar/00/13/ed/ee/c4779b67.jpg","nickname":"cy","note":"","ucode":"50D653399A31F6","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":443069,"discussion_content":"æ„Ÿè°¢åˆ†äº«","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1577619039,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":75832,"user_name":"ç™½å¤œ","can_delete":false,"product_type":"c1","uid":1354449,"ip_address":"","ucode":"7AABFA7C04EA34","user_header":"https://static001.geekbang.org/account/avatar/00/14/aa/d1/076482f3.jpg","comment_is_top":false,"comment_ctime":1552478093,"is_pvip":false,"replies":[{"id":"64425","content":"Good Job","user_name":"ä½œè€…å›å¤","user_name_real":"cy","uid":"1306094","ctime":1577618998,"ip_address":"","comment_id":75832,"utype":1}],"discussion_count":3,"race_medal":0,"score":"14437379981","product_id":100021701,"comment_content":"ä¸‰ä¸‡æ¡ï¼Œ25ä¸ªå­—æ®µå°±è¦è¿ç®—å‡ åˆ†é’Ÿäº†ï¼Œæ•°æ®ä¸Šäº¿ã€‚ã€‚ã€‚<br>&#39;&#39;&#39;<br>GridSearchæœ€ä¼˜å‚æ•°ï¼š {&#39;svc__C&#39;: 1, &#39;svc__gamma&#39;: 0.01}<br>GridSearchæœ€ä¼˜åˆ†æ•°ï¼š 0.8174<br>å‡†ç¡®ç‡ 0.8172<br>68.59484457969666 s<br>GridSearchæœ€ä¼˜å‚æ•°ï¼š {&#39;decisiontreeclassifier__max_depth&#39;: 6}<br>GridSearchæœ€ä¼˜åˆ†æ•°ï¼š 0.8186<br>å‡†ç¡®ç‡ 0.8113<br>1.8460278511047363 s<br>GridSearchæœ€ä¼˜å‚æ•°ï¼š {&#39;randomforestclassifier__n_estimators&#39;: 6}<br>GridSearchæœ€ä¼˜åˆ†æ•°ï¼š 0.7998<br>å‡†ç¡®ç‡ 0.7994<br>2.297856330871582 s<br>GridSearchæœ€ä¼˜å‚æ•°ï¼š {&#39;kneighborsclassifier__n_neighbors&#39;: 8}<br>GridSearchæœ€ä¼˜åˆ†æ•°ï¼š 0.8040<br>å‡†ç¡®ç‡ 0.8036<br>154.36387968063354 s<br>GridSearchæœ€ä¼˜å‚æ•°ï¼š {&#39;adaboostclassifier__n_estimators&#39;: 10}<br>GridSearchæœ€ä¼˜åˆ†æ•°ï¼š 0.8187<br>å‡†ç¡®ç‡ 0.8129<br>13.483576774597168 s<br>&#39;&#39;&#39;","like_count":3,"discussions":[{"author":{"id":1306094,"avatar":"https://static001.geekbang.org/account/avatar/00/13/ed/ee/c4779b67.jpg","nickname":"cy","note":"","ucode":"50D653399A31F6","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":443049,"discussion_content":"Good Job","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1577618998,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":2285481,"avatar":"https://static001.geekbang.org/account/avatar/00/22/df/a9/bf395f99.jpg","nickname":"èµµå®","note":"","ucode":"7E5C648BA67DAA","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":338604,"discussion_content":"è¿™ä½ä»å…„ï¼Œå¯è¯·é—®ä¸‹æµ‹è¯•æ—¶é—´æ€ä¹ˆå†™å‡ºæ¥çš„ï¼Ÿ","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1609321576,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":1,"child_discussions":[{"author":{"id":1919541,"avatar":"https://static001.geekbang.org/account/avatar/00/1d/4a/35/66caeed9.jpg","nickname":"å®Œç¾åšæŒ","note":"","ucode":"AE0261D8DDEF64","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":2285481,"avatar":"https://static001.geekbang.org/account/avatar/00/22/df/a9/bf395f99.jpg","nickname":"èµµå®","note":"","ucode":"7E5C648BA67DAA","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":369362,"discussion_content":"åœ¨æƒ³è¦æµ‹è¯•æ—¶é—´çš„ä»£ç æ®µï¼Œä¸Šä¸‹åˆ†åˆ«åŠ ä¸Šä¸€æ®µä»£ç \n\nimport time\nstart_time = time.perf_counter()\n# ä¸­é—´æ˜¯æƒ³è¦æµ‹è¯•æ—¶é—´çš„ä»£ç æ®µ\nend_time = time.perf_counter()\nprint(&#39;èŠ±è´¹æ—¶é—´ {} s&#39;.format(end_time - start_time))","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1619011533,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":338604,"ip_address":""},"score":369362,"extra":""}]}]},{"had_liked":false,"id":75848,"user_name":"ç‹å½¬æˆ","can_delete":false,"product_type":"c1","uid":1015045,"ip_address":"","ucode":"386803B8FC2DD5","user_header":"https://static001.geekbang.org/account/avatar/00/0f/7d/05/4bad0c7c.jpg","comment_is_top":false,"comment_ctime":1552481433,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"10142416025","product_id":100021701,"comment_content":"â€˜GridSearchæœ€ä¼˜åˆ†æ•°â€™å’Œâ€˜é¢„æµ‹æ•°æ®å‡†ç¡®ç‡â€™æ˜¯æ€ä¹ˆç†è§£çš„ã€‚ä»¥ä¸‹æˆ‘çš„ç†è§£å¯¹å—<br><br>æˆ‘ç†è§£æ˜¯â€˜GridSearchæœ€ä¼˜åˆ†æ•°â€™æ˜¯ä»ã€è®­ç»ƒæ•°æ®ã€‘ä¸­å¾—åˆ°çš„æœ€ä¼˜å‡†ç¡®ç‡ã€‚<br>è€Œâ€˜é¢„æµ‹æ•°æ®å‡†ç¡®ç‡â€™æ˜¯åˆ©ç”¨æœ€ä¼˜æ¨¡å‹ï¼Œåˆ†æã€æµ‹è¯•æ•°æ®ã€‘å¾—åˆ°çš„å‡†ç¡®ç‡ã€‚","like_count":2},{"had_liked":false,"id":75766,"user_name":"JingZ","can_delete":false,"product_type":"c1","uid":1023464,"ip_address":"","ucode":"6F97895B2CC375","user_header":"https://thirdwx.qlogo.cn/mmopen/vi_32/wJphZ3HcvhjVUyTWCIsCugzfQY5NAy6VJ0XoPLibDlcHWMswFmFe678zd0lUjFETia80NQhyQcVnGDlKgKPcRGyw/132","comment_is_top":false,"comment_ctime":1552466428,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"10142401020","product_id":100021701,"comment_content":"# ä¿¡ç”¨å¡è¿çº¦ç‡åˆ†æ<br>KNNç›¸æ¯”è¾ƒè€Œè¨€ï¼Œè·‘å¾—æœ€æ…¢äº†ç‚¹<br><br>from sklearn.ensemble import AdaBoostClassifier<br><br># æ„é€ å„ç§åˆ†ç±»å™¨<br>AdaBoostClassifier(random_state=1)<br><br># åˆ†ç±»å™¨åç§°<br>&#39;adaboostclassifier&#39;<br><br># åˆ†ç±»å™¨å‚æ•°<br>{&#39;adaboostclassifier__n_estimators&#39;: [10, 50, 100]}<br><br>ç»“æœï¼š<br><br>GridSearch æœ€ä¼˜åˆ†æ•°ï¼š0.8187<br>GridSearch æœ€ä¼˜å‚æ•°: {&#39;adaboostclassifier__n_estimators&#39;: 10}<br>å‡†ç¡®ç‡ 0.8129","like_count":2},{"had_liked":false,"id":186356,"user_name":"å»ºå¼º","can_delete":false,"product_type":"c1","uid":1397126,"ip_address":"","ucode":"62B03D0E0C64EC","user_header":"https://static001.geekbang.org/account/avatar/00/15/51/86/b5fd8dd8.jpg","comment_is_top":false,"comment_ctime":1583829620,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"5878796916","product_id":100021701,"comment_content":"åŠ å…¥AdaBooståˆ†ç±»å™¨åï¼Œè¾“å‡ºçš„ç»“æœå¦‚ä¸‹ï¼š<br>GridSearchæœ€ä¼˜å‚æ•°ï¼š {&#39;svc__C&#39;: 1, &#39;svc__gamma&#39;: 0.01}<br>GridSearchæœ€ä¼˜åˆ†æ•°ï¼š 0.8174<br>å‡†ç¡®ç‡ 0.8172<br>GridSearchæœ€ä¼˜å‚æ•°ï¼š {&#39;decisiontreeclassifier__max_depth&#39;: 6}<br>GridSearchæœ€ä¼˜åˆ†æ•°ï¼š 0.8186<br>å‡†ç¡®ç‡ 0.8113<br>GridSearchæœ€ä¼˜å‚æ•°ï¼š {&#39;randomforestclassifier__n_estimators&#39;: 6}<br>GridSearchæœ€ä¼˜åˆ†æ•°ï¼š 0.7998<br>å‡†ç¡®ç‡ 0.7994<br>GridSearchæœ€ä¼˜å‚æ•°ï¼š {&#39;kneighborsclassifier__n_neighbors&#39;: 8}<br>GridSearchæœ€ä¼˜åˆ†æ•°ï¼š 0.8040<br>å‡†ç¡®ç‡ 0.8036<br>GridSearchæœ€ä¼˜å‚æ•°ï¼š {&#39;adaboostclassifier__n_estimators&#39;: 10}<br>GridSearchæœ€ä¼˜åˆ†æ•°ï¼š 0.8187<br>å‡†ç¡®ç‡ 0.8129<br><br>AdaBoostçš„n_estimatorsæœ€ä½³å€¼æ˜¯10ï¼Œå‡†ç¡®ç‡è¾ƒé«˜ï¼Œä»…æ¬¡äºæ”¯æŒå‘é‡æœºï¼ˆSVC)ç®—æ³•","like_count":1},{"had_liked":false,"id":154306,"user_name":"ä¸€çº¸ä¹¦","can_delete":false,"product_type":"c1","uid":1659590,"ip_address":"","ucode":"C58A22B54521CA","user_header":"https://static001.geekbang.org/account/avatar/00/19/52/c6/8eb48963.jpg","comment_is_top":false,"comment_ctime":1574407059,"is_pvip":false,"replies":[{"id":"62645","content":"æ…¢æ…¢æ¥å•Š~ å¤§å®¶éƒ½æ˜¯é€æ¸ç§¯ç´¯èµ·æ¥çš„ï¼ŒåŠ æ²¹","user_name":"ä½œè€…å›å¤","user_name_real":"cy","uid":"1306094","ctime":1577080493,"ip_address":"","comment_id":154306,"utype":1}],"discussion_count":1,"race_medal":0,"score":"5869374355","product_id":100021701,"comment_content":"å‹‰å‹‰å¼ºå¼ºçœ‹æ‡‚,ä½†å¿ƒçŸ¥è‹¥è®©æˆ‘åœ¨ä¸€ç‰‡ç©ºç™½çš„pythonæ–‡ä»¶ä¸­,å®Œå…¨ç‹¬ç«‹å®Œæˆè¿™ä¸ªé¡¹ç›®;æˆ‘åšä¸åˆ°; ","like_count":1,"discussions":[{"author":{"id":1306094,"avatar":"https://static001.geekbang.org/account/avatar/00/13/ed/ee/c4779b67.jpg","nickname":"cy","note":"","ucode":"50D653399A31F6","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":475433,"discussion_content":"æ…¢æ…¢æ¥å•Š~ å¤§å®¶éƒ½æ˜¯é€æ¸ç§¯ç´¯èµ·æ¥çš„ï¼ŒåŠ æ²¹","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1577080493,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":89211,"user_name":"æ»¢","can_delete":false,"product_type":"c1","uid":1221511,"ip_address":"","ucode":"971A6F20AF3F9A","user_header":"https://static001.geekbang.org/account/avatar/00/12/a3/87/c415e370.jpg","comment_is_top":false,"comment_ctime":1556107907,"is_pvip":false,"replies":[{"id":"64219","content":"å¾ˆå¥½çš„æ´å¯Ÿï¼Œéšæœºæ£®æ—å’ŒAdaBoostéƒ½æ˜¯é›†æˆå­¦ä¹ æ–¹æ³•ï¼Œ<br>Random Forestæ˜¯Baggingæ–¹å¼ï¼ŒAdaBoostæ˜¯Boostingæ–¹æ³•ã€‚Baggingå°±æ˜¯æŠ•ç¥¨æ¨¡å‹","user_name":"ä½œè€…å›å¤","user_name_real":"cy","uid":"1306094","ctime":1577614551,"ip_address":"","comment_id":89211,"utype":1}],"discussion_count":1,"race_medal":0,"score":"5851075203","product_id":100021701,"comment_content":"æ—¸è€å¸ˆï¼Œæƒ³è¯·æ•™å‡ ä¸ªé—®é¢˜ï¼š1.ä¸ºä½•æ‰§è¡Œå¤šæ¬¡ æœ€ä¼˜åˆ†æ•°æ˜¯ä¸€å®šçš„ 0.9667  ä½†æ˜¯æœ€ä¼˜å‚æ•°ï¼Œn_estimators æ¯æ¬¡éƒ½ä¸ä¸€æ ·ï¼Œè¿™æ˜¯ä»€ä¹ˆåŸå› ï¼Ÿ2.éšæœºæ£®æ—æ˜¯ä¸æ˜¯æ­£å¥½ä¸AdaBoostç›¸åï¼Œéƒ½æ•°æ®é›†æˆæ¨¡å¼ï¼Œä¸€ä¸ªæ˜¯é›†æˆé‡Œçš„æŠ•ç¥¨æ¨¡å¼ï¼Œä¸€ä¸ªæ˜¯å­¦ä¹ æ¨¡å¼ã€‚è¿™æ ·ç†è§£æ­£ç¡®å—ï¼Ÿ","like_count":1,"discussions":[{"author":{"id":1306094,"avatar":"https://static001.geekbang.org/account/avatar/00/13/ed/ee/c4779b67.jpg","nickname":"cy","note":"","ucode":"50D653399A31F6","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":448057,"discussion_content":"å¾ˆå¥½çš„æ´å¯Ÿï¼Œéšæœºæ£®æ—å’ŒAdaBoostéƒ½æ˜¯é›†æˆå­¦ä¹ æ–¹æ³•ï¼Œ\nRandom Forestæ˜¯Baggingæ–¹å¼ï¼ŒAdaBoostæ˜¯Boostingæ–¹æ³•ã€‚Baggingå°±æ˜¯æŠ•ç¥¨æ¨¡å‹","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1577614551,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":325172,"user_name":"é™å¿ƒ","can_delete":false,"product_type":"c1","uid":1335457,"ip_address":"","ucode":"EB264FA6519FDA","user_header":"https://static001.geekbang.org/account/avatar/00/14/60/a1/8f003697.jpg","comment_is_top":false,"comment_ctime":1638848994,"is_pvip":true,"discussion_count":0,"race_medal":5,"score":"1638848994","product_id":100021701,"comment_content":"åƒ&#39;svc__C&#39;:[1]ã€decisiontreeclassifier__max_depthã€randomforestclassifier__n_estimatorsã€kneighborsclassifier__n_neighborsè¿™æ ·çš„æ ¼å¼çš„è§„å¾‹æ˜¯ä»€ä¹ˆï¼Ÿæ²¡ææ˜ç™½ã€‚","like_count":0},{"had_liked":false,"id":283422,"user_name":"å°æ™¨","can_delete":false,"product_type":"c1","uid":1935063,"ip_address":"","ucode":"B7ADDC309C0D19","user_header":"https://static001.geekbang.org/account/avatar/00/1d/86/d7/46842f90.jpg","comment_is_top":false,"comment_ctime":1615777060,"is_pvip":false,"replies":[{"id":"102992","content":"arr.astype(np.float32) å¯ä»¥å°†æ•°ç»„ä»float64ä¿®æ”¹ä¸ºfloat32çš„æ•°æ®ç±»å‹ï¼Œfloat16åŒç†","user_name":"ä½œè€…å›å¤","user_name_real":"cy","uid":"1306094","ctime":1615988568,"ip_address":"","comment_id":283422,"utype":1}],"discussion_count":2,"race_medal":0,"score":"1615777060","product_id":100021701,"comment_content":"ç”¨32ä½çš„pythonåœ¨æ‰§è¡Œkneighborsclassifieråˆ†ç±»å™¨æ—¶ï¼Œä¼šæŠ¥å†…å­˜é”™è¯¯ï¼šnumpy.core._exceptions.MemoryError: Unable to allocate 1.00 GiB for an array with shape (6391, 21000) and data type float64<br>è€å¸ˆæœ‰æ— åŠæ³•å°†numpyæ•°æ®ç±»å‹float64æ”¹ä¸ºfloat16æˆ–float32å‘¢ï¼Ÿæˆ–æ˜¯å…¶ä»–åŠæ³•è§£å†³<br>&#47;&#47;&#47;é‡è£…64ä½ï¼Œå…¨éƒ¨åº“éœ€è¦é‡è£…&#47;&#47;&#47;","like_count":0,"discussions":[{"author":{"id":1306094,"avatar":"https://static001.geekbang.org/account/avatar/00/13/ed/ee/c4779b67.jpg","nickname":"cy","note":"","ucode":"50D653399A31F6","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":517035,"discussion_content":"arr.astype(np.float32) å¯ä»¥å°†æ•°ç»„ä»float64ä¿®æ”¹ä¸ºfloat32çš„æ•°æ®ç±»å‹ï¼Œfloat16åŒç†","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1615988568,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1935063,"avatar":"https://static001.geekbang.org/account/avatar/00/1d/86/d7/46842f90.jpg","nickname":"å°æ™¨","note":"","ucode":"B7ADDC309C0D19","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":358506,"discussion_content":"å¥½ï¼Œæˆ‘åˆšé‡è£…äº†ğŸ˜‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1615990338,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":270937,"user_name":"èµµå®","can_delete":false,"product_type":"c1","uid":2285481,"ip_address":"","ucode":"7E5C648BA67DAA","user_header":"https://static001.geekbang.org/account/avatar/00/22/df/a9/bf395f99.jpg","comment_is_top":false,"comment_ctime":1609323035,"is_pvip":false,"replies":[{"id":"101925","content":"æ¯”å¦‚ï¼šPAY_0 ä»£è¡¨2005å¹´9æœˆè¿˜æ¬¾æƒ…å†µ(-1=æŒ‰æœŸè¿˜æ¬¾ï¼Œ1=æ‹–æ¬ ä¸€ä¸ªæœˆï¼Œ2=æ‹–æ¬ ä¸¤ä¸ªæœˆï¼Œâ€¦8=æ‹–æ¬ å…«ä¸ªæœˆï¼Œ9=æ‹–æ¬ ä¹ä¸ªæœˆåŠä»¥ä¸Š)<br>PAY_0 è‡³ PAY_6ï¼Œåˆ†åˆ«ä»£è¡¨2005å¹´9æœˆ-2005å¹´4æœˆæ¯ä¸ªæœˆçš„è¿˜æ¬¾æƒ…å†µï¼Œå…·ä½“ç‰¹å¾å€¼å«ä¹‰å¦‚ä¸Šã€‚","user_name":"ä½œè€…å›å¤","user_name_real":"cy","uid":"1306094","ctime":1614365200,"ip_address":"","comment_id":270937,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1609323035","product_id":100021701,"comment_content":"è¯·é—®â€œå®¢æˆ·è¿˜æ¬¾æƒ…å†µâ€å­—æ®µé‡Œçš„å€¼åˆ†åˆ«ä»£è¡¨ä»€ä¹ˆæ„æ€ï¼Ÿ","like_count":0,"discussions":[{"author":{"id":1306094,"avatar":"https://static001.geekbang.org/account/avatar/00/13/ed/ee/c4779b67.jpg","nickname":"cy","note":"","ucode":"50D653399A31F6","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":512798,"discussion_content":"æ¯”å¦‚ï¼šPAY_0 ä»£è¡¨2005å¹´9æœˆè¿˜æ¬¾æƒ…å†µ(-1=æŒ‰æœŸè¿˜æ¬¾ï¼Œ1=æ‹–æ¬ ä¸€ä¸ªæœˆï¼Œ2=æ‹–æ¬ ä¸¤ä¸ªæœˆï¼Œâ€¦8=æ‹–æ¬ å…«ä¸ªæœˆï¼Œ9=æ‹–æ¬ ä¹ä¸ªæœˆåŠä»¥ä¸Š)\nPAY_0 è‡³ PAY_6ï¼Œåˆ†åˆ«ä»£è¡¨2005å¹´9æœˆ-2005å¹´4æœˆæ¯ä¸ªæœˆçš„è¿˜æ¬¾æƒ…å†µï¼Œå…·ä½“ç‰¹å¾å€¼å«ä¹‰å¦‚ä¸Šã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1614365200,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":206993,"user_name":"JustDoDT","can_delete":false,"product_type":"c1","uid":1127175,"ip_address":"","ucode":"6AF0B80F00EAEF","user_header":"https://static001.geekbang.org/account/avatar/00/11/33/07/8f351609.jpg","comment_is_top":false,"comment_ctime":1586972096,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1586972096","product_id":100021701,"comment_content":"äº¤ä½œä¸šï¼š<br>https:&#47;&#47;github.com&#47;LearningChanging&#47;Data-analysis-in-action&#47;tree&#47;master&#47;39-%E6%95%B0%E6%8D%AE%E6%8C%96%E6%8E%98%E5%AE%9E%E6%88%98%EF%BC%881%EF%BC%89%EF%BC%9A%E4%BF%A1%E7%94%A8%E5%8D%A1%E8%BF%9D%E7%BA%A6%E7%8E%87%E5%88%86%E6%9E%90","like_count":0},{"had_liked":false,"id":206355,"user_name":"Simon","can_delete":false,"product_type":"c1","uid":1914504,"ip_address":"","ucode":"A8A2E3E57BD029","user_header":"https://static001.geekbang.org/account/avatar/00/1d/36/88/20b6a6ee.jpg","comment_is_top":false,"comment_ctime":1586846622,"is_pvip":true,"replies":[{"id":"103984","content":"æ²¡é”™ï¼æ ‘æ¨¡å‹ä¸éœ€è¦æ•°æ®è§„èŒƒåŒ–","user_name":"ä½œè€…å›å¤","user_name_real":"cy","uid":"1306094","ctime":1617291947,"ip_address":"","comment_id":206355,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1586846622","product_id":100021701,"comment_content":"ä»best_score_çœ‹ï¼Œæ˜¯å¦å¯¹æ•°æ®æ ‡å‡†åŒ–ï¼Œå¯¹éšæœºæ£®æ—ç®—æ³•ç¡®å®æ²¡æœ‰å½±å“ã€‚å¯¹å†³ç­–æ ‘è€Œè¨€ï¼Œé‡è¦çš„æ˜¯å±æ€§çš„æ¬¡åºï¼Œè€Œä¸æ˜¯ç»å¯¹å¤§å°ã€‚","like_count":0,"discussions":[{"author":{"id":1306094,"avatar":"https://static001.geekbang.org/account/avatar/00/13/ed/ee/c4779b67.jpg","nickname":"cy","note":"","ucode":"50D653399A31F6","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":491762,"discussion_content":"æ²¡é”™ï¼æ ‘æ¨¡å‹ä¸éœ€è¦æ•°æ®è§„èŒƒåŒ–","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1617291947,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":205686,"user_name":"JustDoDT","can_delete":false,"product_type":"c1","uid":1127175,"ip_address":"","ucode":"6AF0B80F00EAEF","user_header":"https://static001.geekbang.org/account/avatar/00/11/33/07/8f351609.jpg","comment_is_top":false,"comment_ctime":1586702269,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1586702269","product_id":100021701,"comment_content":"çœ‹äº†è¿™ä¸€èŠ‚ï¼Œæ„Ÿè§‰å€¼å›ç¥¨ä»·äº†ã€‚","like_count":0},{"had_liked":false,"id":196740,"user_name":"å¼ è´º","can_delete":false,"product_type":"c1","uid":1283181,"ip_address":"","ucode":"0254E40FB3EB5F","user_header":"https://static001.geekbang.org/account/avatar/00/13/94/6d/5cd6e8c7.jpg","comment_is_top":false,"comment_ctime":1585309200,"is_pvip":true,"replies":[{"id":"104343","content":"å¾ˆæ£’ï¼åŠ æ²¹å“¦","user_name":"ä½œè€…å›å¤","user_name_real":"cy","uid":"1306094","ctime":1617904151,"ip_address":"","comment_id":196740,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1585309200","product_id":100021701,"comment_content":"GridSearchæœ€ä¼˜å‚æ•°ï¼š {&#39;adaboostclassifier__n_estimators&#39;: 10}<br>GridSearchæœ€ä¼˜åˆ†æ•°ï¼š 0.8187<br>å‡†ç¡®ç‡ 0.8129","like_count":0,"discussions":[{"author":{"id":1306094,"avatar":"https://static001.geekbang.org/account/avatar/00/13/ed/ee/c4779b67.jpg","nickname":"cy","note":"","ucode":"50D653399A31F6","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":489373,"discussion_content":"å¾ˆæ£’ï¼åŠ æ²¹å“¦","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1617904151,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":189477,"user_name":"Williamï½Zhang","can_delete":false,"product_type":"c1","uid":1527138,"ip_address":"","ucode":"8659B589428F11","user_header":"https://static001.geekbang.org/account/avatar/00/17/4d/62/0fe9cbb3.jpg","comment_is_top":false,"comment_ctime":1584520459,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1584520459","product_id":100021701,"comment_content":"ä½¿ç”¨gridsearchcvçš„æ—¶å€™ï¼Œæ¯”å¦‚ç®—æ³•æ¨¡å‹æœ‰nä¸ªå‚æ•°ï¼Œé‚£ä¹ˆparam_gridè¿™ä¸ªå­—å…¸æ˜¯ä¸æ˜¯åº”è¯¥å¯¹åº”å†™ä¸Šå‚æ•°çš„åç§°ï¼Œä½†æ˜¯åœ¨æ–‡ç« ä¸­ï¼Œè€å¸ˆå¥½åƒåœ¨å‰é¢è¿˜åŠ ä¸Šäº†æ¨¡å‹åç§°æ¯”å¦‚svc__gamma","like_count":1},{"had_liked":false,"id":180155,"user_name":"è‹¹æœ","can_delete":false,"product_type":"c1","uid":1761988,"ip_address":"","ucode":"5D0FA9D8560FD8","user_header":"https://static001.geekbang.org/account/avatar/00/1a/e2/c4/25acaa38.jpg","comment_is_top":false,"comment_ctime":1582201142,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1582201142","product_id":100021701,"comment_content":"clfçš„æœ€æœ‰åˆ†æ•°:0.8163<br>clfçš„æœ€ä¼˜å‚æ•°: {&#39;adboostclassifize__n_estimators&#39;: 10}<br>æ¯æ¬¡è¿è¡Œçš„ç»“æœä¸åŒï¼Œæœ€ä¼˜å‚æ•°æœ‰æ—¶æ˜¯50ï¼Œä¸çŸ¥é“å¦‚ä½•ç†è§£ï¼Œ<br>ä»£ç å¦‚ä¸‹<br># -*- coding: utf-8 -*-<br>#å¯¹ä¿¡ç”¨å¡è¿çº¦çš„é¢„æµ‹åˆ¤æ–­<br>import numpy as np<br>import pandas as pd<br>import matplotlib.pyplot as plt<br>import seaborn as sns<br>from sklearn.ensemble import AdaBoostClassifier<br>from sklearn.pipeline import Pipeline<br>from sklearn.model_selection import train_test_split,GridSearchCV<br>from sklearn.preprocessing import StandardScaler<br><br>#è§‚å¯Ÿè¿çº¦çš„æ•°é‡ï¼Œå¯è§†åŒ–<br>data = pd.read_csv(&#39;E:\\\\C-01-pythonlç»ƒä¹ \\\\01æ•°æ®åˆ†æå®æˆ˜45\\\\credit_default-master\\\\UCI_Credit_Card.csv&#39;)<br>print(data.shape)<br>print(data.describe())<br>print(data.axes)<br>target_result = data[&#39;default.payment.next.month&#39;].value_counts()<br>print(target_result)<br># df = pd.DataFrame({&#39;default.payment.next.month&#39;:target_result})<br>plt.figure(figsize=(6,6),dpi=80)<br>plt.bar(target_result.index,target_result.values)<br>plt.title(&#39;ä¿¡ç”¨å¡è¿çº¦å®¢æˆ·\\n(è¿çº¦ï¼š1ï¼Œå®ˆçº¦ï¼š0)&#39;)<br>plt.ylabel(&#39;äººæ•°&#39;)<br>locs , labels = plt.xticks()<br>plt.show()<br>#æ•°æ®å¤„ç†ï¼Œç‰¹å¾é€‰æ‹©  æå–feature,target<br>data.drop(&#39;ID&#39;,inplace=True,axis=1)<br>target = data[&#39;default.payment.next.month&#39;].values<br>columns = data.columns.tolist()<br>columns.remove(&#39;default.payment.next.month&#39;)<br>features = data[columns].values<br>train_x , text_x, train_y,text_y = train_test_split(features,target,test_size=0.2)<br><br># å®šä¹‰adboostç®—æ³•<br>adb = AdaBoostClassifier()<br><br>#ä½¿ç”¨pipeline<br>pipeline = Pipeline([<br>    (&#39;scaler&#39;,StandardScaler()),<br>    (&#39;adboostclassifize&#39;, adb)<br>])<br>parameters = {&quot;adboostclassifize__n_estimators&quot;:[10,50,100]}<br># ä½¿ç”¨GridsearchCV<br>clf = GridSearchCV(pipeline,param_grid=parameters)<br>clf.fit(train_x,train_y)<br>predict_y = clf.predict(text_x)<br>print(&#39;clfçš„æœ€æœ‰åˆ†æ•°:{:.4f}&#39;.format(clf.best_score_))<br>print(&#39;clfçš„æœ€ä¼˜å‚æ•°:&#39;,clf.best_params_)<br><br># @Time : 2020&#47;2&#47;20 16:17<br>","like_count":0},{"had_liked":false,"id":170623,"user_name":"ä½³ä½³çš„çˆ¸","can_delete":false,"product_type":"c1","uid":1082338,"ip_address":"","ucode":"9D4FE7C3552087","user_header":"https://static001.geekbang.org/account/avatar/00/10/83/e2/297518ab.jpg","comment_is_top":false,"comment_ctime":1578645646,"is_pvip":false,"discussion_count":1,"race_medal":0,"score":"1578645646","product_id":100021701,"comment_content":"ç¨‹åºè¿è¡Œå‡ºé”™äº†ï¼ŒPython3.7çš„ç¯å¢ƒ<br><br>Traceback (most recent call last):<br>  File &quot;E:&#47;my_work_spaces&#47;pycharm&#47;Self_learn_projs&#47;Crawler_projs&#47;Data_ana_lesson_src&#47;Credit_card&#47;Creditcard_fraud.py&quot;, line 71, in &lt;module&gt;<br>    ax = sns.countplot(x=&#39;Class&#39;, data=data)<br>  File &quot;E:\\my_work_spaces\\pycharm\\venv_py37\\lib\\site-packages\\seaborn\\categorical.py&quot;, line 3553, in countplot<br>    errcolor, errwidth, capsize, dodge)<br>  File &quot;E:\\my_work_spaces\\pycharm\\venv_py37\\lib\\site-packages\\seaborn\\categorical.py&quot;, line 1607, in __init__<br>    order, hue_order, units)<br>  File &quot;E:\\my_work_spaces\\pycharm\\venv_py37\\lib\\site-packages\\seaborn\\categorical.py&quot;, line 155, in establish_variables<br>    raise ValueError(err)<br>ValueError: Could not interpret input &#39;Class&#39;","like_count":0,"discussions":[{"author":{"id":1460392,"avatar":"https://static001.geekbang.org/account/avatar/00/16/48/a8/7b1a2b65.jpg","nickname":"æ¢¦é‡Œçš„å°çŒ©çŒ©","note":"","ucode":"D60A2C01A81795","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":203939,"discussion_content":"çœ‹èµ·æ¥æ˜¯ä½ çš„â€˜Classâ€™æ²¡æœ‰å®šä¹‰ï¼Ÿ","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1584103638,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":157268,"user_name":"Ronnyz","can_delete":false,"product_type":"c1","uid":1488280,"ip_address":"","ucode":"9F34527B1D343D","user_header":"https://static001.geekbang.org/account/avatar/00/16/b5/98/ffaf2aca.jpg","comment_is_top":false,"comment_ctime":1575100931,"is_pvip":false,"replies":[{"id":"62621","content":"RonnyzåŒå­¦å†™çš„ä¸é”™","user_name":"ä½œè€…å›å¤","user_name_real":"cy","uid":"1306094","ctime":1577078146,"ip_address":"","comment_id":157268,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1575100931","product_id":100021701,"comment_content":"# -*- coding:utf-8 -*-\r<br>import pandas as pd\r<br>from sklearn.model_selection import GridSearchCV,train_test_split\r<br>from sklearn.preprocessing import StandardScaler\r<br>from sklearn.pipeline import Pipeline\r<br>from sklearn.datasets import load_iris\r<br>from sklearn.metrics import accuracy_score\r<br>from sklearn.ensemble import AdaBoostClassifier\r<br>from matplotlib import pyplot as plt\r<br>import seaborn as sns\r<br>from warnings import simplefilter\r<br>simplefilter(action=&#39;ignore&#39;,category=FutureWarning)\r<br>\r<br>#æ•°æ®åŠ è½½\r<br>credits=pd.read_csv(&#39;CreditCard_data&#47;UCI_Credit_Card.csv&#39;)\r<br>#æ•°æ®æ¢ç´¢\r<br>print(credits.shape)\r<br>print(credits.describe()) #æŸ¥çœ‹æ•°æ®æ¦‚è§ˆ\r<br>\r<br>#ç‰¹å¾é€‰æ‹©ï¼Œå»æ‰IDå­—æ®µ\r<br>credits.drop([&#39;ID&#39;],inplace=True,axis=1)\r<br>target=credits[&#39;default.payment.next.month&#39;].values\r<br>columns=credits.columns.tolist()\r<br>columns.remove(&#39;default.payment.next.month&#39;)\r<br>features=credits[columns].values\r<br>\r<br>#åˆ†å‰²æ•°æ®ï¼Œå°†30%ä½œä¸ºæµ‹è¯•é›†\r<br>X_train,X_test,y_train,y_test=train_test_split(features,target,test_size=0.3,random_state=666)\r<br>\r<br>#æ„å»ºåˆ†ç±»å™¨\r<br>ada=AdaBoostClassifier()\r<br>#ä½¿ç”¨ç½‘æ ¼æœç´¢è°ƒæ•´å‚æ•°\r<br>#å‚æ•°è®¾ç½®\r<br>parameters={\r<br>    &#39;n_estimators&#39;:[10,50,100]\r<br>}\r<br>gscv=GridSearchCV(estimator=ada,param_grid=parameters,scoring=&#39;accuracy&#39;,n_jobs=-1)\r<br>gscv.fit(X_train,y_train)\r<br>print(&#39;GridSearchæœ€ä¼˜å‚æ•°ï¼š&#39;,gscv.best_params_)\r<br>print(&#39;GridSearchæœ€ä¼˜åˆ†æ•°ï¼š%0.4lf&#39; % gscv.best_score_)\r<br>y_pred=gscv.predict(X_test)\r<br>print(&#39;å‡†ç¡®ç‡ï¼š&#39;,accuracy_score(y_test,y_pred))\r<br>\r<br>GridSearchæœ€ä¼˜å‚æ•°ï¼š {&#39;n_estimators&#39;: 50}\r<br>GridSearchæœ€ä¼˜åˆ†æ•°ï¼š0.8197\r<br>å‡†ç¡®ç‡ï¼š 0.8121111111111111","like_count":0,"discussions":[{"author":{"id":1306094,"avatar":"https://static001.geekbang.org/account/avatar/00/13/ed/ee/c4779b67.jpg","nickname":"cy","note":"","ucode":"50D653399A31F6","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":476380,"discussion_content":"RonnyzåŒå­¦å†™çš„ä¸é”™","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1577078146,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":148746,"user_name":"å­Ÿå›","can_delete":false,"product_type":"c1","uid":1691291,"ip_address":"","ucode":"94D8DC4001BA52","user_header":"https://static001.geekbang.org/account/avatar/00/19/ce/9b/46b3dc8d.jpg","comment_is_top":false,"comment_ctime":1573070071,"is_pvip":false,"replies":[{"id":"62678","content":"å¯ä»¥å…ˆè¿›è¡Œbalanceå¤„ç†ï¼Œè¿™æ ·ä¼šå¥½ä¸€äº›","user_name":"ä½œè€…å›å¤","user_name_real":"cy","uid":"1306094","ctime":1577082987,"ip_address":"","comment_id":148746,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1573070071","product_id":100021701,"comment_content":"è€å¸ˆï¼Œè¿™ä¸ªæ•°æ®é›†æ˜¯æ˜æ˜¾çš„unbalanced dedatasetã€‚ éœ€è¦å…ˆè¿›è¡Œbalanceå¤„ç†å—ï¼Ÿæˆ‘ä»¥å‰å¤„ç†lending clubçš„datasetï¼Œå‘ç°ç»è¿‡convert to balance datasetä¹‹åï¼Œrandom forestçš„å‡†ç¡®ç‡é«˜äº†ä¸å°‘","like_count":0,"discussions":[{"author":{"id":1306094,"avatar":"https://static001.geekbang.org/account/avatar/00/13/ed/ee/c4779b67.jpg","nickname":"cy","note":"","ucode":"50D653399A31F6","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":473593,"discussion_content":"å¯ä»¥å…ˆè¿›è¡Œbalanceå¤„ç†ï¼Œè¿™æ ·ä¼šå¥½ä¸€äº›","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1577082987,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":147117,"user_name":"è®¸æ™ºé¸¿","can_delete":false,"product_type":"c1","uid":1655563,"ip_address":"","ucode":"18E41503CC43C2","user_header":"https://static001.geekbang.org/account/avatar/00/19/43/0b/25ff73e0.jpg","comment_is_top":false,"comment_ctime":1572797695,"is_pvip":false,"replies":[{"id":"59819","content":"æ¯ä¸ªæ¯”èµ›é™¤äº†ç®—æ³•æ¨¡å‹ï¼Œç‰¹å¾å·¥ç¨‹è¿˜æ˜¯å¾ˆé‡è¦çš„ã€‚æ˜¯å¦è¿›è¡Œé™ç»´ï¼Œè¿™ä¸ªè¿˜æ˜¯çœ‹ä¸šåŠ¡åœºæ™¯ï¼Œåœ¨æ¯”èµ›ä¸­æœ‰çš„æ—¶å€™ä¸éœ€è¦é™ç»´ï¼Œæœ‰æ—¶å€™åè€Œéœ€è¦æ„é€ å‡ºæ¥ä¸€äº›æ–°çš„ç‰¹å¾ï¼Œç›®çš„æ˜¯ä¸ºäº†è®©ç»“æœæ›´å¥½ã€‚åœ¨å·¥ç¨‹ä¸­ï¼Œå¯ä»¥é‡‡ç”¨é™ç»´æ–¹å¼ï¼Œæ¯•ç«Ÿæ›´å°‘çš„ç»´åº¦å¯ä»¥è®©è®¡ç®—æ•ˆç‡æ›´é«˜","user_name":"ä½œè€…å›å¤","user_name_real":"cy","uid":"1306094","ctime":1574757419,"ip_address":"","comment_id":147117,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1572797695","product_id":100021701,"comment_content":"è€å¸ˆï¼Œå‚èµ›çš„èŒƒå›´åˆ’åˆ†æœ‰ä»€ä¹ˆä¾æ®å—?è¿˜æ˜¯è¯´æˆ‘ä¸‹æ¬¡é‡åˆ°ç±»ä¼¼çš„é¢˜ç›®ï¼Œä¾‹å¦‚é¢„æµ‹ç”¨æˆ·ç‚¹å‡»å¹¿å‘Šçš„æ¦‚ç‡ï¼Œä¹Ÿå¯ä»¥ç›´æ¥å¥—ç”¨æ‚¨è¿™å¥—ä»£ç å’Œå‚æ•°æ°›å›´ï¼Œç„¶åå¾—å‡ºæœ€ä¼˜çš„åˆ†ç±»æ–¹æ¡ˆå’Œå‚æ•°å–å€¼?<br><br>å¦å¤–ï¼Œå¦‚æœå­—æ®µè¿‡å¤šï¼Œéœ€è¦è¿›è¡Œé™çº¬å¤„ç†å—?æ€ä¹ˆå¤„ç†?","like_count":0,"discussions":[{"author":{"id":1306094,"avatar":"https://static001.geekbang.org/account/avatar/00/13/ed/ee/c4779b67.jpg","nickname":"cy","note":"","ucode":"50D653399A31F6","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":473155,"discussion_content":"æ¯ä¸ªæ¯”èµ›é™¤äº†ç®—æ³•æ¨¡å‹ï¼Œç‰¹å¾å·¥ç¨‹è¿˜æ˜¯å¾ˆé‡è¦çš„ã€‚æ˜¯å¦è¿›è¡Œé™ç»´ï¼Œè¿™ä¸ªè¿˜æ˜¯çœ‹ä¸šåŠ¡åœºæ™¯ï¼Œåœ¨æ¯”èµ›ä¸­æœ‰çš„æ—¶å€™ä¸éœ€è¦é™ç»´ï¼Œæœ‰æ—¶å€™åè€Œéœ€è¦æ„é€ å‡ºæ¥ä¸€äº›æ–°çš„ç‰¹å¾ï¼Œç›®çš„æ˜¯ä¸ºäº†è®©ç»“æœæ›´å¥½ã€‚åœ¨å·¥ç¨‹ä¸­ï¼Œå¯ä»¥é‡‡ç”¨é™ç»´æ–¹å¼ï¼Œæ¯•ç«Ÿæ›´å°‘çš„ç»´åº¦å¯ä»¥è®©è®¡ç®—æ•ˆç‡æ›´é«˜","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1574757419,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":90161,"user_name":"æ»¨æ»¨","can_delete":false,"product_type":"c1","uid":1334567,"ip_address":"","ucode":"881EFA798BEE34","user_header":"https://static001.geekbang.org/account/avatar/00/14/5d/27/74e152d3.jpg","comment_is_top":false,"comment_ctime":1556436561,"is_pvip":false,"replies":[{"id":"64210","content":"æ˜¯çš„","user_name":"ä½œè€…å›å¤","user_name_real":"cy","uid":"1306094","ctime":1577614256,"ip_address":"","comment_id":90161,"utype":1}],"discussion_count":2,"race_medal":0,"score":"1556436561","product_id":100021701,"comment_content":"GridSearchCVæœ¬è´¨æ˜¯ä¸€ç§ç©·ä¸¾æ³•","like_count":0,"discussions":[{"author":{"id":1306094,"avatar":"https://static001.geekbang.org/account/avatar/00/13/ed/ee/c4779b67.jpg","nickname":"cy","note":"","ucode":"50D653399A31F6","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":448410,"discussion_content":"æ˜¯çš„","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1577614256,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1022786,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/9b/42/aeb79b35.jpg","nickname":"Ling","note":"","ucode":"EE15D1ABDB073B","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":55862,"discussion_content":"æš´åŠ›æœç´¢ï¼Œå› æ­¤åªé€‚ç”¨äºå°æ•°æ®é‡ã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1574407015,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":81537,"user_name":"Geek_dancer","can_delete":false,"product_type":"c1","uid":1440561,"ip_address":"","ucode":"F66D454E58E35E","user_header":"https://static001.geekbang.org/account/avatar/00/15/fb/31/f0a884a3.jpg","comment_is_top":false,"comment_ctime":1553938325,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1553938325","product_id":100021701,"comment_content":"æˆ‘å‘ç°ï¼šclassifier_param_gridçš„keyså¿…é¡»ä¸¥æ ¼æŒ‰ç…§&#39;classifier_names&#39;+&#39;__&#39;+&#39;classifier_param_name&#39;çš„æ ¼å¼æ¥å†™","like_count":1},{"had_liked":false,"id":77221,"user_name":"TKbook","can_delete":false,"product_type":"c1","uid":1073829,"ip_address":"","ucode":"F6E0E99CC79059","user_header":"https://static001.geekbang.org/account/avatar/00/10/62/a5/43aa0c27.jpg","comment_is_top":false,"comment_ctime":1552891341,"is_pvip":false,"replies":[{"id":"64407","content":"Good Job","user_name":"ä½œè€…å›å¤","user_name_real":"cy","uid":"1306094","ctime":1577618437,"ip_address":"","comment_id":77221,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1552891341","product_id":100021701,"comment_content":"ada = AdaBoostClassifier()<br>parameters = {&#39;adaboostclassifier__n_estimators&#39;: [10, 50, 100]}<br>pipeline = Pipeline([<br>    (&#39;scaler&#39;, StandardScaler()),<br>    (&#39;adaboostclassifier&#39;, ada)<br>])<br>clf = GridSearchCV(estimator=pipeline, param_grid=parameters)<br>clf.fit(train_x, train_y)<br>print(&#39;GridSearchæœ€ä¼˜å‚æ•°ï¼š&#39;, clf.best_params_)<br>print(&#39;GridSearchæœ€ä¼˜åˆ†æ•°ï¼š%0.4lf&#39; % clf.best_score_)<br>predict_y = clf.predict(test_x)<br>print(&#39;å‡†ç¡®ç‡%0.4lf&#39; % accuracy_score(test_y, predict_y))<br><br>GridSearchæœ€ä¼˜å‚æ•°ï¼š {&#39;adaboostclassifier__n_estimators&#39;: 10}<br>GridSearchæœ€ä¼˜åˆ†æ•°ï¼š0.8187<br>å‡†ç¡®ç‡0.8129","like_count":0,"discussions":[{"author":{"id":1306094,"avatar":"https://static001.geekbang.org/account/avatar/00/13/ed/ee/c4779b67.jpg","nickname":"cy","note":"","ucode":"50D653399A31F6","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":443641,"discussion_content":"Good Job","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1577618437,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":75834,"user_name":"Geek_2a6093","can_delete":false,"product_type":"c1","uid":1395560,"ip_address":"","ucode":"9C216A0B09A7AF","user_header":"https://static001.geekbang.org/account/avatar/00/15/4b/68/a6198a59.jpg","comment_is_top":false,"comment_ctime":1552478720,"is_pvip":false,"replies":[{"id":"64424","content":"xgboost lightgbméƒ½æ˜¯å¸¸ç”¨çš„æœºå™¨å­¦ä¹ å·¥å…·","user_name":"ä½œè€…å›å¤","user_name_real":"cy","uid":"1306094","ctime":1577618984,"ip_address":"","comment_id":75834,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1552478720","product_id":100021701,"comment_content":"è¿™æ¬¡getåˆ°äº†pipeline å’ŒgridsearchçœŸå¥½ï¼Œè°¢è°¢è€å¸ˆï¼è€å¸ˆä¸‹æ¬¡èƒ½ä¸èƒ½è¯¦ç»†åœ°ä»‹ç»ä¸€ä¸‹é›†æˆæ–¹æ³•å¦‚Stackingï¼Œæˆ–è€…XgBoostè¿™ä¸ªåº“çš„ç‰¹ç‚¹å‘€ï¼Ÿ","like_count":0,"discussions":[{"author":{"id":1306094,"avatar":"https://static001.geekbang.org/account/avatar/00/13/ed/ee/c4779b67.jpg","nickname":"cy","note":"","ucode":"50D653399A31F6","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":443050,"discussion_content":"xgboost lightgbméƒ½æ˜¯å¸¸ç”¨çš„æœºå™¨å­¦ä¹ å·¥å…·","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1577618984,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":75814,"user_name":"æ™¨æ›¦åæµª","can_delete":false,"product_type":"c1","uid":1064142,"ip_address":"","ucode":"41F476DDF37AB8","user_header":"https://static001.geekbang.org/account/avatar/00/10/3c/ce/27fe1845.jpg","comment_is_top":false,"comment_ctime":1552474902,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1552474902","product_id":100021701,"comment_content":"ä½¿ç”¨GridSearchCVè°ƒå‚çš„æ—¶å€™,ä¸ºä»€ä¹ˆè®¾ç½®äº†RandomForestClassifierçš„n_jobs=-1,è¿è¡Œå¤šæ¬¡,n_estimatorsçš„æœ€ä¼˜å€¼ä¸ºä»€ä¹ˆä¸ä¸€æ ·?","like_count":0}]}