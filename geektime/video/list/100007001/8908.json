{"id":8908,"title":"45 | Spring Cloud Config简介","content":"无","comments":[{"had_liked":false,"id":215565,"user_name":"石栖","can_delete":false,"product_type":"c3","uid":1496443,"ip_address":"","ucode":"35600F645A479F","user_header":"https://static001.geekbang.org/account/avatar/00/16/d5/7b/c512da6a.jpg","comment_is_top":false,"comment_ctime":1589017249,"is_pvip":false,"replies":[{"id":79979,"content":"嗯，课程是08年开发，现在spring cloud更新迭代很快。后面有计划会考虑更新课程。","user_name":"作者回复","user_name_real":"杨波","uid":1030344,"ctime":1589204466,"ip_address":"","comment_id":215565,"utype":1}],"discussion_count":1,"race_medal":0,"score":2,"product_id":100007001,"comment_content":"spring cloud config 支持多种存储，支持数据库的。bobo老师看的版本可能比较老了。","like_count":0,"discussions":[{"author":{"id":1030344,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/b8/c8/c94d38a7.jpg","nickname":"杨波","note":"","ucode":"FA3418BB703BCA","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":494478,"discussion_content":"嗯，课程是08年开发，现在spring cloud更新迭代很快。后面有计划会考虑更新课程。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1589204466,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":166952,"user_name":"阿宝","can_delete":false,"product_type":"c3","uid":1439711,"ip_address":"","ucode":"EE22750E46A03E","user_header":"https://static001.geekbang.org/account/avatar/00/15/f7/df/60889fe8.jpg","comment_is_top":false,"comment_ctime":1577636477,"is_pvip":false,"replies":[{"id":64905,"content":"apollo支持分环境配置，但是每个环境有独立的configDB，所以不能共享。你需要把30%的配置在每个环境都复制一份，这个工作量基本是一次性的，所以问题不大。","user_name":"作者回复","user_name_real":"杨波","uid":1030344,"ctime":1577704266,"ip_address":"","comment_id":166952,"utype":1}],"discussion_count":2,"race_medal":0,"score":2,"product_id":100007001,"comment_content":"您好，老师，现在有三套环境（Dev,Test,Prod），现在它们都有自己独立的一份完整配置项（大约有200来个配置项吧，采用了properties,db两种），可变采用的db方式。之前采用消息机制出了次问题，后来改为不管它有没有变化，各服务是采用每隔一秒去load一次。有30%的配置项的值是相同的，不分环境的。那么如果改为apollo配置中心方式，这30%不分环境的配置项，如何抽取出来？这种情况改为apollo配置中心，能不能给一些建议？","like_count":0,"discussions":[{"author":{"id":1030344,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/b8/c8/c94d38a7.jpg","nickname":"杨波","note":"","ucode":"FA3418BB703BCA","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":479690,"discussion_content":"apollo支持分环境配置，但是每个环境有独立的configDB，所以不能共享。你需要把30%的配置在每个环境都复制一份，这个工作量基本是一次性的，所以问题不大。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1577704266,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1439711,"avatar":"https://static001.geekbang.org/account/avatar/00/15/f7/df/60889fe8.jpg","nickname":"阿宝","note":"","ucode":"EE22750E46A03E","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":109694,"discussion_content":"谢谢老师的答复","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1577707551,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":132479,"user_name":"贾俊","can_delete":false,"product_type":"c3","uid":1591943,"ip_address":"","ucode":"A2E6DD5BAF3E27","user_header":"https://static001.geekbang.org/account/avatar/00/18/4a/87/b6b91b03.jpg","comment_is_top":false,"comment_ctime":1568131766,"is_pvip":false,"replies":[{"id":50864,"content":"咨询了一下apollo作者，建议发布时只新增和修改配置，不删除配置。这样在理解上最简单，不容易犯错，发布完后确认配置不用了再做删除。","user_name":"作者回复","user_name_real":"杨波","uid":1030344,"ctime":1568208758,"ip_address":"","comment_id":132479,"utype":1}],"discussion_count":1,"race_medal":0,"score":2,"product_id":100007001,"comment_content":"老师你好，想请教如何自动化部署使用apollo做配置管理中心的微服务？有没有这方面的最佳实践。我们的微服务都是使用jenkins pipeline+k8s做一键部署，每次部署的时候滚动更新，会出现新旧pod共存的情况。在用apollo来管理所有配置的情况下，如何在部署过程中保证配置能够兼容新旧的版本呢？这样不至于在发布了新配置后导致现存的旧版pod出问题。我们有同事建议只加新配置和修改已有配置，不删旧配置，把所有的新旧配置都写在namespace里面，但我觉得这样不是太好，有更好的实践方式吗？","like_count":0,"discussions":[{"author":{"id":1030344,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/b8/c8/c94d38a7.jpg","nickname":"杨波","note":"","ucode":"FA3418BB703BCA","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":466963,"discussion_content":"咨询了一下apollo作者，建议发布时只新增和修改配置，不删除配置。这样在理解上最简单，不容易犯错，发布完后确认配置不用了再做删除。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1568208758,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":91933,"user_name":"Geek_382ccc","can_delete":false,"product_type":"c3","uid":1520267,"ip_address":"","ucode":"3E40727B8772AA","user_header":"https://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTKicUgL8bc6EDqlS73icGODUXdXmicFb8UYNNGFkibtq4z9j0yGJY6WK4sQmic3pqLZmFqw3rfE1Sa0zNw/132","comment_is_top":false,"comment_ctime":1557138196,"is_pvip":false,"replies":[{"id":33107,"content":"你好，从apollo官方提供的文档看，它支持多个第三方应用绑定同一个appid，也就是允许多个应用修改同一套配置信息。一个第三方应用同时操作多个appid，官方文档没有说，实际应该也是可行的，不过需要定制，我之前公司的无线团队觉得apollo的portal不好使，就专门开发了一个针对apollo的proxy，它基本可以操作所有的appid，不过我们当时对apollo的api做了一些定制扩展，工作量也不大。","user_name":"作者回复","user_name_real":"杨波","uid":1030344,"ctime":1557322913,"ip_address":"","comment_id":91933,"utype":1}],"discussion_count":1,"race_medal":0,"score":2,"product_id":100007001,"comment_content":"能不能这样理解开放平台：相当于给了第三方应用开放了权限，可以增删改查配置信息。如果是的话那么问题来了，如果多个应用绑定同一个appid，也就是允许多个应用修改同一套配置信息？另外一个应用可以绑定多个appid，访问多套配置吗？","like_count":0,"discussions":[{"author":{"id":1030344,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/b8/c8/c94d38a7.jpg","nickname":"杨波","note":"","ucode":"FA3418BB703BCA","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":449087,"discussion_content":"你好，从apollo官方提供的文档看，它支持多个第三方应用绑定同一个appid，也就是允许多个应用修改同一套配置信息。一个第三方应用同时操作多个appid，官方文档没有说，实际应该也是可行的，不过需要定制，我之前公司的无线团队觉得apollo的portal不好使，就专门开发了一个针对apollo的proxy，它基本可以操作所有的appid，不过我们当时对apollo的api做了一些定制扩展，工作量也不大。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1557322913,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]}]}