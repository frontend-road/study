{"id":110085,"title":"34 | RESTful & Socket：搭建交易执行层核心","content":"<p>你好，我是景霄。</p><p>上一节，我们简单介绍了量化交易的历史、严谨的定义和它的基本组成结构。有了这些高层次的基本知识，接下来我们就分模块，开始讲解量化交易系统中具体的部分。</p><p>从这节课开始，我们将实打实地从代码出发，一步步设计出一套清晰完整、易于理解的量化交易系统。</p><p>一个量化交易系统，可以说是一个黑箱。这个黑箱连接交易所获取到的数据，通过策略运算，然后再连接交易所进行下单操作。正如我们在输入输出那节课说的那样，黑箱的特性是输入和输出。每一个设计网络交互的同学，都需要在大脑中形成清晰的交互状态图：</p><ul>\n<li>知道包是怎样在网络间传递的；</li>\n<li>知道每一个节点是如何处理不同的输入包，然后输出并分发给下一级的。</li>\n</ul><p>在你搞不明白的时候，可以先在草稿纸上画出交互拓扑图，标注清楚每个节点的输入和输出格式，然后想清楚网络是怎么流动的。这一点，对网络编程至关重要。</p><p>现在，我假设你对网络编程只有很基本的了解。所以接下来，我将先从 REST 的定义讲起，然后过渡到具体的交互方式——如何通过 Python 和交易所进行交互，从而执行下单、撤单、查询订单等网络交互方式。</p><h2>REST 简介</h2><p>什么是 REST API？什么是 Socket？有过网络编程经验的同学，一定对这两个词汇不陌生。</p><!-- [[[read_end]]] --><p>REST的全称是表征层状态转移（REpresentational State Transfer），本意是指一种操作资源方法。不过，你不用纠结于这个绕口的名字。换种方式来说，REST的实质可以理解为：通过URL定位资源，用GET、POST、PUT、DELETE等动词来描述操作。而满足REST要求的接口，就被称为RESTful的接口。</p><p>为了方便你更容易理解这些概念，这里我举个例子来类比。小明同学不是很聪明但很懂事，每天会在他的妈妈下班回来后给妈妈泡茶。刚开始，他的妈妈会发出这样的要求：</p><blockquote>\n<p>用红色杯子，去厨房泡一杯放了糖的37.5度的普洱茶。</p>\n</blockquote><p>可是小明同学不够聪明，很难理解这个定语很多的句子。于是，他妈妈为了让他更简单明白需要做的事情，把这个指令设计成了更简洁的样子：</p><blockquote>\n<p>泡厨房的茶，要求如下：</p>\n<ol>\n<li>类型=普洱；</li>\n<li>杯子=红色；</li>\n<li>放糖=True；</li>\n<li>温度=37.5度。</li>\n</ol>\n</blockquote><p>这里的“茶”就是资源，“<strong>厨房的茶</strong>”就是资源的地址（URI）；“<strong>泡</strong>”是动词；后面的要求，都是接口参数。这样的一个接口，就是小明提供的一个REST接口。</p><p>如果小明是一台机器，那么解析这个请求就会非常容易；而我们作为维护者，查看小明的代码也很简单。当小明把这个接口暴露到网上时，这就是一个RESTful的接口。</p><p>总的来说，RESTful接口通常以HTTP GET和POST形式出现。但并非所有的GET、POST请求接口，都是RESTful的接口。</p><p>这话可能有些拗口，我们举个例子来看。上节课中，我们获取了Gemini交易所中，BTC对USD价格的ticker接口：</p><pre><code>GET https://api.gemini.com/v1/pubticker/btcusd\n</code></pre><p>这里的“GET”是动词，后边的URI是“Ticker”这个资源的地址。所以，这是一个RESTful的接口。</p><p>但下面这样的接口，就不是一个严格的RESTful接口：</p><pre><code>POST https://api.restful.cn/accounts/delete/:username\n</code></pre><p>因为URI中包含动词“delete”（删除），所以这个URI并不是<strong>指向一个资源</strong>。如果要修改成严格的RESTful接口，我们可以把它改成下面这样：</p><pre><code>DELETE https://api.rest.cn/accounts/:username\n</code></pre><p>然后，我们带着这个观念去看Gemini的取消订单接口：</p><pre><code>POST https://api.gemini.com/v1/order/cancel\n</code></pre><p><img src=\"https://static001.geekbang.org/resource/image/c6/8f/c6851d2560b5f67f29c750cyy018738f.png?wh=1132x614\" alt=\"\"></p><p>你会发现，这个接口不够“RESTful”的地方有：</p><ul>\n<li>动词设计不准确，接口使用“POST”而不是重用HTTP动词“DELETE”；</li>\n<li>URI里包含动词cancel；</li>\n<li>ID代表的订单是<strong>资源</strong>，但订单ID是放在<strong>参数列表</strong>而不是<strong>URI</strong>里的，因此URI并没有指向资源。</li>\n</ul><p>所以严格来说，这不是一个RESTful的接口。</p><p>此外，如果我们去检查Gemini的其他私有接口（Private，私有接口是指需要附加身份验证信息才能访问的接口），我们会发现，那些接口的设计都不是严格RESTful的。不仅如此，大部分的交易所，比如Bitmex、Bitfinex、OKCoin等等，它们提供的“REST接口”，也都不是严格RESTful的。这些接口之所以还能被称为“REST接口”，是因为他们大部分满足了REST接口的另一个重要要求：<strong>无状态</strong>。</p><p>无状态的意思是，每个REST请求都是独立的，不需要服务器在会话（Session）中缓存中间状态来完成这个请求。简单来说，如果服务器A接收到请求的时候宕机了，而此时把这个请求发送给交易所的服务器B，也能继续完成，那么这个接口就是无状态的。</p><p>这里，我再给你举一个简单的有状态的接口的例子。服务器要求，在客户端请求取消订单的时候，必须发送两次不一样的HTTP请求。并且，第一次发送让服务器“等待取消”；第二次发送“确认取消”。那么，就算这个接口满足了RESTful的动词、资源分离原则，也不是一个REST接口。</p><p>当然，对于交易所的REST接口，你并不需要过于纠结“RESTful”这个概念，否则很容易就被这些名词给绕晕了。你只需要把握住最核心的一点：<strong>一个HTTP请求完成一次完整操作</strong>。</p><h2>交易所 API 简介</h2><p>现在，你对 REST 和 Web Socket 应该有一个大致了解了吧。接下来，我们就开始做点有意思的事情。</p><p>首先，我来介绍一下交易所是什么。区块链交易所是个撮合交易平台： 它兼容了传统撮合规则撮合引擎，将资金托管和交割方式替换为区块链。数字资产交易所，则是一个中心化的平台，通过 Web 页面或 PC、手机客户端的形式，让用户将数字资产充值到指定钱包地址（交易所创建的钱包），然后在平台挂买单、卖单以实现数字资产之间的兑换。</p><p>通俗来说，交易所就是一个买和卖的菜市场。有人在摊位上大声喊着：“二斤羊肉啊，二斤羊肉，四斤牛肉来换！”这种人被称为 maker（挂单者）。有的人则游走于不同摊位，不动声色地掏出两斤牛肉，顺手拿走一斤羊肉。这种人被称为 taker（吃单者）。</p><p>交易所存在的意义，一方面是为 maker 和 taker 提供足够的空间活动；另一方面，让一个名叫撮合引擎的玩意儿，尽可能地把单子撮合在一起，然后收取一定比例的保护费…啊不对，是手续费，从而保障游戏继续进行下去。</p><p>市场显然是个很伟大的发明，这里我们就不进行更深入的哲学讨论了。</p><p>然后，我再来介绍一个叫作 Gemini 的交易所。Gemini，双子星交易所，全球首个获得合法经营许可的、首个推出期货合约的、专注于撮合大宗交易的数字货币交易所。Gemini 位于纽约，是一家数字货币交易所和托管机构，允许客户交易和存储数字资产，并直接受纽约州金融服务部门（NYDFS）的监管。</p><p>Gemini 的界面清晰，API 完整而易用，更重要的是，还提供了完整的测试网络，也就是说，功能和正常的 Gemini 完全一样。但是他家的交易采用虚拟币，非常方便从业者在平台上进行对接测试。</p><p>另一个做得很好的交易所，是 Bitmex，他家的 API UI 界面和测试网络也是币圈一流。不过，鉴于这家是期货交易所，对于量化初学者来说有一定的门槛，我们还是选择 Gemini 更方便一些。</p><p>在进入正题之前，我们最后再以比特币和美元之间的交易为例，介绍四个基本概念（orderbook 的概念这里就不介绍了，你也不用深究，你只需要知道比特币的价格是什么就行了）。</p><ul>\n<li>买（buy）：用美元买入比特币的行为。</li>\n<li>卖（sell）：用比特币换取美元的行为。</li>\n<li>市价单（market order）：给交易所一个方向（买或者卖）和一个数量，交易所把给定数量的美元（或者比特币）换成比特币（或者美元）的单子。</li>\n<li>限价单（limit order）：给交易所一个价格、一个方向（买或者卖）和一个数量，交易所在价格达到给定价格的时候，把给定数量的美元（或者比特币）换成比特币（或者美元）的单子。</li>\n</ul><p>这几个概念都不难懂。其中，市价单和限价单，最大的区别在于，限价单多了一个给定价格。如何理解这一点呢？我们可以来看下面这个例子。</p><p>小明在某一天中午12:00:00，告诉交易所，我要用1000美元买比特币。交易所收到消息，在 12:00:01 回复小明，现在你的账户多了 0.099 个比特币，少了 1000 美元，交易成功。这是一个市价买单。</p><p>而小强在某一天中午 11:59:00，告诉交易所，我要挂一个单子，数量为 0.1 比特币，1个比特币的价格为 10000 美元，低于这个价格不卖。交易所收到消息，在11:59:01 告诉小强，挂单成功，你的账户余额中 0.1 比特币的资金被冻结。又过了一分钟，交易所告诉小强，你的单子被完全执行了（fully executed），现在你的账户多了 1000 美元，少了 0.1 个比特币。这就是一个限价卖单。</p><p>（这里肯定有人发现不对了：貌似少了一部分比特币，到底去哪儿了呢？嘿嘿，你不妨自己猜猜看。）</p><p>显然，市价单，在交给交易所后，会立刻得到执行，当然执行价格也并不受你的控制。它很快，但是也非常不安全。而限价单，则限定了交易价格和数量，安全性相对高很多。缺点呢，自然就是如果市场朝相反方向走，你挂的单子可能没有任何人去接，也就变成了干吆喝却没人买。因为我没有讲解 orderbook，所以这里的说辞不完全严谨，但是对于初学者理解今天的内容，已经够用了。</p><p>储备了这么久的基础知识，想必你已经跃跃欲试了吧？下面，我们正式进入正题，手把手教你使用API下单。</p><h2>手把手教你使用 API 下单</h2><p>手动挂单显然太慢，也不符合量化交易的初衷。我们就来看看如何用代码实现自动化下单吧。</p><p>第一步，你需要做的是，注册一个 Gemini Sandbox 账号。请放心，这个测试账号不需要你充值任何金额，注册后即送大量虚拟现金。这口吻是不是听着特像网游宣传语，接下来就是“快来贪玩蓝月里找我吧”？哈哈，不过这个设定确实如此，所以赶紧来注册一个吧。</p><p>注册后，为了满足好奇，你可以先尝试着使用 Web 界面自行下单。不过，事实上，未解锁的情况下是无法正常下单的，因此这样尝试并没啥太大意义。</p><p>所以第二步，我们需要来配置 API Key。菜单栏User Settings-&gt;API Settings，然后点 GENERATE A NEW ACCOUNT API KEY，记下 Key 和 Secret 这两串字符。因为窗口一旦消失，这两个信息就再也找不到了，需要你重新生成。</p><p>配置到此结束。接下来，我们来看具体实现。</p><p>先强调一点，在量化系统开发的时候，你的心中一定要有清晰的数据流图。下单逻辑是一个很简单的 RESTful 的过程，和你在网页操作的一样，构造你的请求订单、加密请求，然后 POST 给 gemini 交易所即可。</p><p>不过，因为涉及到的知识点较多，带你一步一步从零来写代码显然不太现实。所以，我们采用“先读懂后记忆并使用”的方法来学，下面即为这段代码：</p><pre><code>import requests\nimport json\nimport base64\nimport hmac\nimport hashlib\nimport datetime\nimport time\n\nbase_url = &quot;https://api.sandbox.gemini.com&quot;\nendpoint = &quot;/v1/order/new&quot;\nurl = base_url + endpoint\n\ngemini_api_key = &quot;account-zmidXEwP72yLSSybXVvn&quot;\ngemini_api_secret = &quot;375b97HfE7E4tL8YaP3SJ239Pky9&quot;.encode()\n\nt = datetime.datetime.now()\npayload_nonce = str(int(time.mktime(t.timetuple())*1000))\n\npayload = {\n   &quot;request&quot;: &quot;/v1/order/new&quot;,\n   &quot;nonce&quot;: payload_nonce,\n   &quot;symbol&quot;: &quot;btcusd&quot;,\n   &quot;amount&quot;: &quot;5&quot;,\n   &quot;price&quot;: &quot;3633.00&quot;,\n   &quot;side&quot;: &quot;buy&quot;,\n   &quot;type&quot;: &quot;exchange limit&quot;,\n   &quot;options&quot;: [&quot;maker-or-cancel&quot;]\n}\n\nencoded_payload = json.dumps(payload).encode()\nb64 = base64.b64encode(encoded_payload)\nsignature = hmac.new(gemini_api_secret, b64, hashlib.sha384).hexdigest()\n\nrequest_headers = {\n    'Content-Type': &quot;text/plain&quot;,\n    'Content-Length': &quot;0&quot;,\n    'X-GEMINI-APIKEY': gemini_api_key,\n    'X-GEMINI-PAYLOAD': b64,\n    'X-GEMINI-SIGNATURE': signature,\n    'Cache-Control': &quot;no-cache&quot;\n}\n\nresponse = requests.post(url,\n                         data=None,\n                         headers=request_headers)\n\nnew_order = response.json()\nprint(new_order)\n\n\n########## 输出 ##########\n\n{'order_id': '239088767', 'id': '239088767', 'symbol': 'btcusd', 'exchange': 'gemini', 'avg_execution_price': '0.00', 'side': 'buy', 'type': 'exchange limit', 'timestamp': '1561956976', 'timestampms': 1561956976535, 'is_live': True, 'is_cancelled': False, 'is_hidden': False, 'was_forced': False, 'executed_amount': '0', 'remaining_amount': '5', 'options': ['maker-or-cancel'], 'price': '3633.00', 'original_amount': '5'}\n</code></pre><p>我们来深入看一下这段代码。</p><p>RESTful 的 POST 请求，通过 <code>requests.post</code> 来实现。post 接受三个参数，url、data 和 headers。</p><p>这里的 url 等价于 <code>https://api.sandbox.gemini.com/v1/order/new</code>，但是在代码中分两部分写。第一部分是交易所 API 地址；第二部分，以斜杠开头，用来表示统一的 API endpoint。我们也可以在其他交易所的 API 中看到类似的写法，两者连接在一起，就构成了最终的 url。</p><p>而接下来大段命令的目的，是为了构造 request_headers。</p><p>这里我简单说一下 HTTP request，这是互联网中基于 TCP 的基础协议。HTTP 协议是 Hyper Text Transfer Protocol（超文本传输协议）的缩写，用于从万维网（WWW:World Wide Web）服务器传输超文本到本地浏览器的传送协议。而 TCP（Transmission Control Protocol）则是面向连接的、可靠的、基于字节流的传输层通信协议。</p><p>多提一句，如果你开发网络程序，建议利用闲暇时间认真读一读《计算机网络：自顶向下方法》这本书，它也是国内外计算机专业必修课中广泛采用的课本之一。一边学习，一边应用，对于初学者的能力提升是全面而充分的。</p><p>回到 HTTP，它的主要特点是，连接简单、灵活，可以使用“简单请求，收到回复，然后断开连接”的方式，也是一种无状态的协议，因此充分符合 RESTful 的思想。</p><p>HTTP 发送需要一个请求头（request header），也就是代码中的 request_headers，用 Python 的语言表示，就是一个 str 对 str 的字典。</p><p>这个字典里，有一些字段有特殊用途， <code>'Content-Type': \"text/plain\"</code> 和 <code>'Content-Length': \"0\"</code> 描述 Content 的类型和长度，这里的 Content 对应于参数 data。但是 Gemini 这里的 request 的 data 没有任何用处，因此长度为 0。</p><p>还有一些其他字段，例如 <code>'keep-alive'</code> 来表示连接是否可持续化等，你也可以适当注意一下。要知道，网络编程很多 bug 都会出现在不起眼的细节之处。</p><p>继续往下走看代码。payload 是一个很重要的字典，它用来存储下单操作需要的所有的信息，也就是业务逻辑信息。这里我们可以下一个 limit buy，限价买单，价格为 3633 刀。</p><p>另外，请注意 nonce，这是个很关键并且在网络通信中很常见的字段。</p><p>因为网络通信是不可靠的，一个信息包有可能会丢失，也有可能重复发送，在金融操作中，这两者都会造成很严重的后果。丢包的话，我们重新发送就行了；但是重复的包，我们需要去重。虽然 TCP 在某种程度上可以保证，但为了在应用层面进一步减少错误发生的机会，Gemini 交易所要求所有的通信 payload 必须带有 nonce。</p><p>nonce 是个单调递增的整数。当某个后来的请求的 nonce，比上一个成功收到的请求的 nouce 小或者相等的时候，Gemini 便会拒绝这次请求。这样一来，重复的包就不会被执行两次了。另一方面，这样也可以在一定程度上防止中间人攻击：</p><ul>\n<li>一则是因为 nonce 的加入，使得加密后的同样订单的加密文本完全混乱；</li>\n<li>二则是因为，这会使得中间人无法通过“发送同样的包来构造重复订单”进行攻击。</li>\n</ul><p>这样的设计思路是不是很巧妙呢？这就相当于每个包都增加了一个身份识别，可以极大地提高安全性。希望你也可以多注意，多思考一下这些巧妙的用法。</p><p>接下来的代码就很清晰了。我们要对 payload 进行 base64 和 sha384 算法非对称加密，其中 gemini_api_secret  为私钥；而交易所存储着公钥，可以对你发送的请求进行解密。最后，代码再将加密后的请求封装到 request_headers 中，发送给交易所，并收到 response，这个订单就完成了。</p><h2>总结</h2><p>这节课我们介绍了什么是 RESTful API，带你了解了交易所的 RESTful API 是如何工作的，以及如何通过 RESTful API 来下单。同时，我简单讲述了网络编程中的一些技巧操作，希望你在网络编程中要注意思考每一个细节，尽可能在写代码之前，对业务逻辑和具体的技术细节有足够清晰的认识。</p><p>下一节，我们同样将从 Web Socket 的定义开始，讲解量化交易中数据模块的具体实现。</p><h2>思考题</h2><p>最后留一个思考题。今天的内容里，能不能使用 timestamp 代替 nonce？为什么？欢迎留言写下你的思考，也欢迎你把这篇文章分享出去。</p>","neighbors":{"left":{"article_title":"33 | 带你初探量化世界","id":109128},"right":{"article_title":"35 | RESTful & Socket：行情数据对接和抓取","id":110734}},"comments":[{"had_liked":false,"id":119463,"user_name":"Jingxiao","can_delete":false,"product_type":"c1","uid":1259521,"ip_address":"","ucode":"EB966BB87132F6","user_header":"https://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTJJOlibibPFEWOib8ib7RtfAtxND5FUqCxxoeTuLAbBI9ic23xuwdXT4IyiaWq3Fic9RgEAYI0lBTbEp2rcg/132","comment_is_top":true,"comment_ctime":1564601589,"is_pvip":false,"discussion_count":5,"race_medal":0,"score":"9.2233722402828001e+18","product_id":100026901,"comment_content":"思考题答案：事实上，在要求不是很严格的低频交易中，timestamp 是可以作为 nonce 存在的，它满足单调递增不重复的特性，比如一小时只会发送几个交易请求的波段策略中，timestamp 完全没问题。但是，在频率较高的交易中，timestamp 可能就不是那么适合。如果你使用协程来编程，或者使用类似 node.js 这样的异步编程工具或语言，那么你的代码很可能在发送的时候，并不是按照你想要的顺序发送给服务器，就会出现 timestamp 更大的请求反而更早发送。其次，在网络传输中，不同的包也可能有完全不同的抵达顺序，虽然你可以通过一些编程技巧来实现按顺序传输，但是如果你需要多台机器进行较为高频的交易。而且需要对同一个仓位（同一个 API Key）进行操作，就可能会变得比较麻烦。<br>","like_count":48,"discussions":[{"author":{"id":1154146,"avatar":"https://static001.geekbang.org/account/avatar/00/11/9c/62/f625b2bb.jpg","nickname":"酸葡萄","note":"","ucode":"9D059C4FB327C0","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":100368,"discussion_content":"时间戳在并发编程中不能保证顺序，那么原设计中单调递增的整数为什么能呢？","likes_number":10,"is_delete":false,"is_hidden":false,"ctime":1577254882,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":1,"child_discussions":[{"author":{"id":1157364,"avatar":"https://static001.geekbang.org/account/avatar/00/11/a8/f4/2abb4a4c.jpg","nickname":"MirkoWei","note":"","ucode":"901C436D359CD3","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":1154146,"avatar":"https://static001.geekbang.org/account/avatar/00/11/9c/62/f625b2bb.jpg","nickname":"酸葡萄","note":"","ucode":"9D059C4FB327C0","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":278671,"discussion_content":"同样的疑惑","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1591215188,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":100368,"ip_address":""},"score":278671,"extra":""}]},{"author":{"id":1156557,"avatar":"https://static001.geekbang.org/account/avatar/00/11/a5/cd/3aff5d57.jpg","nickname":"Alery","note":"","ucode":"08F3F49181E67B","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":61709,"discussion_content":"请问异步编程time.mktime(datetime.datetime.now().timetuple())是怎么保证请求是按照顺序发送的呢？nonce和timestamp有什么区别吗？望大神指教。。","likes_number":3,"is_delete":false,"is_hidden":false,"ctime":1574782644,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1105457,"avatar":"https://static001.geekbang.org/account/avatar/00/10/de/31/a783a2a6.jpg","nickname":"mira_wey","note":"","ucode":"FA1B6A3FBC2A19","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":320191,"discussion_content":"同样的疑惑，对并发程序，先运行的未必时间戳在前，而用递增序列则可以确保先开始的顺序一定在前，递增序列也是使用时间戳转换的吧？该怎么理解呢？","likes_number":1,"is_delete":false,"is_hidden":false,"ctime":1604287801,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1115232,"avatar":"https://static001.geekbang.org/account/avatar/00/11/04/60/64d166b6.jpg","nickname":"Fan","note":"","ucode":"3BF28670FD9407","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":554297,"discussion_content":"那不用timestamp，需要怎样做呢？有什么办法呢？","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1646304663,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":144425,"user_name":"自由民","can_delete":false,"product_type":"c1","uid":1346236,"ip_address":"","ucode":"435C67531697F1","user_header":"https://static001.geekbang.org/account/avatar/00/14/8a/bc/cb39ed38.jpg","comment_is_top":true,"comment_ctime":1571919774,"is_pvip":false,"replies":[{"id":"56038","content":"谢谢","user_name":"作者回复","user_name_real":"高山流水","uid":"1513504","ctime":1572244562,"ip_address":"","comment_id":144425,"utype":1}],"discussion_count":10,"race_medal":0,"score":"9.2233720727863992e+18","product_id":100026901,"comment_content":"为注册sandbox的账号折腾了半天，停在创建账号那里就不动了。不知道是不是墙的原因，挂了梯子终于注册好了，但是却要验证手机号码，开始我瞎填的美国加州，用网上的美国手机号接收验证码也不行。最后用另一个邮箱注册了，可以选中国的，手机也能接收到验证码。<br>思考题:应该不行，对并发程序，先运行的未必时间戳在前，而用递增序列则可以确保先开始的顺序一定在前。<br>课程的练习代码: https:&#47;&#47;github.com&#47;zwdnet&#47;PythonPractice","like_count":8,"discussions":[{"author":{"id":1513504,"avatar":"https://static001.geekbang.org/account/avatar/00/17/18/20/75ea3b20.jpg","nickname":"高山流水","note":"","ucode":"71E513B5937481","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":471934,"discussion_content":"谢谢","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1572244562,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1157364,"avatar":"https://static001.geekbang.org/account/avatar/00/11/a8/f4/2abb4a4c.jpg","nickname":"MirkoWei","note":"","ucode":"901C436D359CD3","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":278672,"discussion_content":"时间戳在并发编程中不能保证顺序能理解，但是原设计中单调递增的整数为什么能保证顺序不太理解，感觉除了精确度不同，效果应该差不多啊","likes_number":2,"is_delete":false,"is_hidden":false,"ctime":1591215400,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1016917,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/84/55/1e40bd61.jpg","nickname":"shiziwen","note":"","ucode":"ADADC770D82D66","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":269551,"discussion_content":"我也是没有注册成功。。。发了邮件，说中国大陆不支持。用了美国的Google voice号码，也是不行。。。","likes_number":2,"is_delete":false,"is_hidden":false,"ctime":1589905818,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1095997,"avatar":"https://static001.geekbang.org/account/avatar/00/10/b9/3d/e061a652.jpg","nickname":"Geek_109a0b","note":"","ucode":"93A45B581947FC","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":55100,"discussion_content":"我也选的美国，手机号没法验证，怎么办？\n\n注册顺序是先选国家，再填写邮箱，请问怎么选中国呀？选中国区就提示 &#39;Unfortunately, we are not operational in China yet&#39;","likes_number":2,"is_delete":false,"is_hidden":false,"ctime":1574339960,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1564605,"avatar":"","nickname":"宋强","note":"","ucode":"119A0B00ABDA7B","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":165728,"discussion_content":"必须用梯子才可以注册吗 ？","likes_number":1,"is_delete":false,"is_hidden":false,"ctime":1581318907,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":1,"child_discussions":[{"author":{"id":1346236,"avatar":"https://static001.geekbang.org/account/avatar/00/14/8a/bc/cb39ed38.jpg","nickname":"自由民","note":"","ucode":"435C67531697F1","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":1564605,"avatar":"","nickname":"宋强","note":"","ucode":"119A0B00ABDA7B","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":201542,"discussion_content":"反正我不用梯子是注册不了的","likes_number":1,"is_delete":false,"is_hidden":false,"ctime":1583806765,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":165728,"ip_address":""},"score":201542,"extra":""}]},{"author":{"id":1134630,"avatar":"https://static001.geekbang.org/account/avatar/00/11/50/26/b0a0b6b5.jpg","nickname":"SuperXiong","note":"","ucode":"EA3FF62368DD56","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":130962,"discussion_content":"我选了中国，提交注册就出现error ID 7eela8768","likes_number":1,"is_delete":false,"is_hidden":false,"ctime":1578813925,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1510970,"avatar":"https://static001.geekbang.org/account/avatar/00/17/0e/3a/a84da865.jpg","nickname":"Hellboy1989","note":"","ucode":"5843AF09CDA063","race_medal":0,"user_type":1,"is_pvip":true},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":572775,"discussion_content":"所以，老师这选的实战例子，确实没有考虑到国内行情丫","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1652951251,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":2118179,"avatar":"https://static001.geekbang.org/account/avatar/00/20/52/23/b3551be1.jpg","nickname":"通天白鼠","note":"","ucode":"5033B4E1240002","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":556087,"discussion_content":"我开了代理，但是选了中国以后，说是还没开通中国得服务，如果是国外，又需要填手机号，注册不了呀。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1647212533,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":2718436,"avatar":"https://static001.geekbang.org/account/avatar/00/29/7a/e4/791d0f5e.jpg","nickname":"海南三亚体检代检海口体检代检","note":"","ucode":"63917623D4E152","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":549716,"discussion_content":"开全局代理，国家可以选择China","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1644218411,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":118029,"user_name":"小侠龙旋风","can_delete":false,"product_type":"c1","uid":1126441,"ip_address":"","ucode":"073F3924A99835","user_header":"https://static001.geekbang.org/account/avatar/00/11/30/29/d6816ebf.jpg","comment_is_top":false,"comment_ctime":1564214709,"is_pvip":false,"replies":[{"id":"43827","content":"👍<br><br>参考出错原因，你的账户余额中 BTC 不够 5，下单失败。","user_name":"作者回复","user_name_real":"高山流水","uid":"1513504","ctime":1564623057,"ip_address":"","comment_id":118029,"utype":1}],"discussion_count":1,"race_medal":0,"score":"70283691445","product_id":100026901,"comment_content":"知识点很多，整理一下。<br>1. 非对称加密：<br>    加密：公钥加密，私钥解密；<br>    签名：私钥签名，公钥验签。<br>2. hmac.new(key, str, digestmod)<br>    key是密钥；str是欲加密的串；digestmod是hmac加密算法<br>3. 最后一句打印语句可以写成如下看着更清晰：<br>    print(json.dumps(new_order, indent=4))<br>4. 在草稿纸上画出交互拓扑图<br>5. 如何设计符合RESTful特征的API<br>6. Keep-Alive: timeout=5, max=100<br><br>思考题：<br>测试了一下timestamp效果，代码如下：<br>import time<br>import datetime<br>current_time = datetime.datetime.now()<br>print(int(datetime.datetime.timestamp(current_time)*1000))<br>print(int(time.mktime(current_time.timetuple())*1000))<br><br>同样都是时间戳，timestamp是带毫秒的，具备单调递增、加密混乱的特质。<br>文中有句话是这么说的：&quot;当某个后来请求的nonce比上一个成功收到的请求的nonce小或者相等的时候，Gemini便会拒绝这次请求&quot;。<br>说明Gemini不希望http请求在一秒内发生多次。应该是反爬用的吧~<br>用timestamp是可以精确到毫秒的，意味着每毫秒可以请求发送的nonce都不一样。<br><br>另外，作为taker第二次运行该代码就报出下面的错：<br>{<br>    &quot;result&quot;: &quot;error&quot;,<br>    &quot;reason&quot;: &quot;InsufficientFunds&quot;,<br>    &quot;message&quot;: &quot;Failed to place buy order on symbol &#39;BTCUSD&#39; for price $3,633.00 and quantity 5 BTC due to insufficient funds&quot;<br>}","like_count":16,"discussions":[{"author":{"id":1513504,"avatar":"https://static001.geekbang.org/account/avatar/00/17/18/20/75ea3b20.jpg","nickname":"高山流水","note":"","ucode":"71E513B5937481","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":460229,"discussion_content":"👍\n\n参考出错原因，你的账户余额中 BTC 不够 5，下单失败。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1564623057,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":117684,"user_name":"SCAR","can_delete":false,"product_type":"c1","uid":1031209,"ip_address":"","ucode":"38C0927FA3C5FC","user_header":"https://static001.geekbang.org/account/avatar/00/0f/bc/29/022905e6.jpg","comment_is_top":false,"comment_ctime":1564110739,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"53103718291","product_id":100026901,"comment_content":"思考题：<br>1. 纯粹使用timestamp应该不行，虽然timestamp也是递增的，但是在python里timestamp是float而不是int。<br>2.但如果基于timestamp抽取出部分应该是可以，比如老师例子中的：<br>   payload_nonce = str(int(time.mktime(t.timetuple())*1000))<br>   改成：<br>   payload_nonce = str(int(t.timestamp())*1000)<br>   结果应该是一致的。","like_count":12},{"had_liked":false,"id":117661,"user_name":"Monroe  He","can_delete":false,"product_type":"c1","uid":1348219,"ip_address":"","ucode":"D04ECB2EF2E0DA","user_header":"https://static001.geekbang.org/account/avatar/00/14/92/7b/8c7e3e61.jpg","comment_is_top":false,"comment_ctime":1564107133,"is_pvip":false,"discussion_count":2,"race_medal":0,"score":"27333910909","product_id":100026901,"comment_content":"我想问一下老师，有针对国内股票的虚拟交易平台吗<br>可以提供一下相关方面的书籍资料吗","like_count":6,"discussions":[{"author":{"id":1258218,"avatar":"https://static001.geekbang.org/account/avatar/00/13/32/ea/2c50e4a0.jpg","nickname":"阿杰","note":"","ucode":"F9DFA1CE265912","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":3394,"discussion_content":"我也想了解，国内的股票的量化交易。。","likes_number":1,"is_delete":false,"is_hidden":false,"ctime":1564454583,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1268778,"avatar":"","nickname":"sky","note":"","ucode":"6D31488C0DAFCC","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":3088,"discussion_content":"我也想了解，国内的股票的量化交易。。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1564153570,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":173026,"user_name":"devna","can_delete":false,"product_type":"c1","uid":1014408,"ip_address":"","ucode":"A175FE9B73D773","user_header":"https://static001.geekbang.org/account/avatar/00/0f/7a/88/b787338a.jpg","comment_is_top":false,"comment_ctime":1579412126,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"23054248606","product_id":100026901,"comment_content":"前段时间刚看完《计算机网络：自顶自下方法》，确实不错，能很快提升对网络的认识，强烈推荐","like_count":5},{"had_liked":false,"id":273078,"user_name":"karofsky","can_delete":false,"product_type":"c1","uid":1191529,"ip_address":"","ucode":"4AFBEDE22F9652","user_header":"","comment_is_top":false,"comment_ctime":1610433180,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"14495335068","product_id":100026901,"comment_content":"今天再看这篇文章的感受就是，BTC真的涨了好多啊...","like_count":3},{"had_liked":false,"id":127082,"user_name":"kang","can_delete":false,"product_type":"c1","uid":1365450,"ip_address":"","ucode":"A70EDF86712A16","user_header":"https://static001.geekbang.org/account/avatar/00/14/d5/ca/488c0688.jpg","comment_is_top":false,"comment_ctime":1566551238,"is_pvip":false,"discussion_count":6,"race_medal":0,"score":"14451453126","product_id":100026901,"comment_content":"請問大家都是怎麼註冊Genimi 的? 我的註冊國家都被阻擋","like_count":3,"discussions":[{"author":{"id":1195004,"avatar":"https://static001.geekbang.org/account/avatar/00/12/3b/fc/04a75cd0.jpg","nickname":"taoist","note":"","ucode":"D70AFE25CD8F10","race_medal":0,"user_type":1,"is_pvip":true},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":6964,"discussion_content":"不能选中国，没有国外的手机号。Unfortunately, we are not operational in China yet. Please opt in to be notified when we launch in your country. ","likes_number":1,"is_delete":false,"is_hidden":false,"ctime":1567224995,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":2,"child_discussions":[{"author":{"id":1528176,"avatar":"https://static001.geekbang.org/account/avatar/00/17/51/70/68b3f0e6.jpg","nickname":"健身咸鱼","note":"","ucode":"415CBFF3F158F3","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":1195004,"avatar":"https://static001.geekbang.org/account/avatar/00/12/3b/fc/04a75cd0.jpg","nickname":"taoist","note":"","ucode":"D70AFE25CD8F10","race_medal":0,"user_type":1,"is_pvip":true},"discussion":{"id":334887,"discussion_content":"现在还是注册不了","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1608018578,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":6964,"ip_address":""},"score":334887,"extra":""},{"author":{"id":1191529,"avatar":"","nickname":"karofsky","note":"","ucode":"4AFBEDE22F9652","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":1528176,"avatar":"https://static001.geekbang.org/account/avatar/00/17/51/70/68b3f0e6.jpg","nickname":"健身咸鱼","note":"","ucode":"415CBFF3F158F3","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":341486,"discussion_content":"我现在可以注册，是Gemini Sandbox","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1610433289,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":334887,"ip_address":""},"score":341486,"extra":""}]},{"author":{"id":1219179,"avatar":"https://static001.geekbang.org/account/avatar/00/12/9a/6b/e8ef2989.jpg","nickname":"云蝈蝈","note":"","ucode":"19B1597DB49819","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":297694,"discussion_content":"https://sandbox.gemini.com 我刚注册完，是注册sandbox.gemini不是gemini","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1597026120,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":1,"child_discussions":[{"author":{"id":2117451,"avatar":"https://static001.geekbang.org/account/avatar/00/20/4f/4b/74696428.jpg","nickname":"肖国强","note":"","ucode":"96979DB3F497F3","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":1219179,"avatar":"https://static001.geekbang.org/account/avatar/00/12/9a/6b/e8ef2989.jpg","nickname":"云蝈蝈","note":"","ucode":"19B1597DB49819","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":298191,"discussion_content":"我注册不到，“next”一直在打转","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1597216602,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":297694,"ip_address":""},"score":298191,"extra":""}]},{"author":{"id":1095997,"avatar":"https://static001.geekbang.org/account/avatar/00/10/b9/3d/e061a652.jpg","nickname":"Geek_109a0b","note":"","ucode":"93A45B581947FC","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":55101,"discussion_content":"同样的问题，有解决办法吗","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1574340001,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":235771,"user_name":"马建华","can_delete":false,"product_type":"c1","uid":1185974,"ip_address":"","ucode":"928189590259AB","user_header":"https://static001.geekbang.org/account/avatar/00/12/18/b6/f3f68a39.jpg","comment_is_top":false,"comment_ctime":1595186493,"is_pvip":false,"discussion_count":3,"race_medal":0,"score":"10185121085","product_id":100026901,"comment_content":"我是报错：<br>{&#39;result&#39;: &#39;error&#39;, &#39;reason&#39;: &#39;MissingAccounts&#39;, &#39;message&#39;: &#39;Expected a JSON payload with accounts&#39;}<br>有谁碰到吗？","like_count":2,"discussions":[{"author":{"id":1257490,"avatar":"https://static001.geekbang.org/account/avatar/00/13/30/12/7144b8b2.jpg","nickname":"mozlingyu","note":"","ucode":"2ECA45816F2D22","race_medal":0,"user_type":1,"is_pvip":true},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":293116,"discussion_content":"发现问题了，创建 API Key 的时候要选择 primary 类型，而不是 master。","likes_number":2,"is_delete":false,"is_hidden":false,"ctime":1595434334,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1347160,"avatar":"https://thirdwx.qlogo.cn/mmopen/vi_32/ricKzCoviaZX4dGD1ock3tj3RfAKLOxGJflqmYxFEV2fWRPQPH9WrVaG2gGRQJGHJFZCicEUKG72V0W1Ajmv0KOfQ/132","nickname":"vijay","note":"","ucode":"F5DC4106690B3C","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":294831,"discussion_content":"1、在pload中添加属性account:&#34;xxx&#34;\n2、在创建api key的时候选择primary类型","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1596011589,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1257490,"avatar":"https://static001.geekbang.org/account/avatar/00/13/30/12/7144b8b2.jpg","nickname":"mozlingyu","note":"","ucode":"2ECA45816F2D22","race_medal":0,"user_type":1,"is_pvip":true},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":293079,"discussion_content":"我好想也遇到了","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1595428090,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":216854,"user_name":"及時行樂","can_delete":false,"product_type":"c1","uid":1895499,"ip_address":"","ucode":"2FD0E0BB8327DE","user_header":"https://static001.geekbang.org/account/avatar/00/1c/ec/4b/442dd5f1.jpg","comment_is_top":false,"comment_ctime":1589355178,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"10179289770","product_id":100026901,"comment_content":"现在程序跑起来都报错了，这是交易所把API地址改了吗？<br>{&#39;result&#39;: &#39;error&#39;, &#39;reason&#39;: &#39;EndpointMismatch&#39;, &#39;message&#39;: &#39;EndpointMismatch&#39;}","like_count":2},{"had_liked":false,"id":117782,"user_name":"瞳梦","can_delete":false,"product_type":"c1","uid":1596386,"ip_address":"","ucode":"A86FC44F6321BD","user_header":"","comment_is_top":false,"comment_ctime":1564129819,"is_pvip":false,"replies":[{"id":"43828","content":"https:&#47;&#47;sandbox.gemini.com","user_name":"作者回复","user_name_real":"高山流水","uid":"1513504","ctime":1564623104,"ip_address":"","comment_id":117782,"utype":1}],"discussion_count":4,"race_medal":0,"score":"10154064411","product_id":100026901,"comment_content":"请问gemini sandbox账号怎么注册呢？我在官网只找到了Open a Personal Account和I Represent an Institution","like_count":2,"discussions":[{"author":{"id":1513504,"avatar":"https://static001.geekbang.org/account/avatar/00/17/18/20/75ea3b20.jpg","nickname":"高山流水","note":"","ucode":"71E513B5937481","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":460115,"discussion_content":"https://sandbox.gemini.com","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1564623104,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1348219,"avatar":"https://static001.geekbang.org/account/avatar/00/14/92/7b/8c7e3e61.jpg","nickname":"Monroe  He","note":"","ucode":"D04ECB2EF2E0DA","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":3288,"discussion_content":"https://exchange.sandbox.gemini.com/这个网站","likes_number":1,"is_delete":false,"is_hidden":false,"ctime":1564376407,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":2,"child_discussions":[{"author":{"id":1258218,"avatar":"https://static001.geekbang.org/account/avatar/00/13/32/ea/2c50e4a0.jpg","nickname":"阿杰","note":"","ucode":"F9DFA1CE265912","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":1348219,"avatar":"https://static001.geekbang.org/account/avatar/00/14/92/7b/8c7e3e61.jpg","nickname":"Monroe  He","note":"","ucode":"D04ECB2EF2E0DA","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":3415,"discussion_content":"多谢，也遇到了同样问题","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1564469630,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":3288,"ip_address":""},"score":3415,"extra":""},{"author":{"id":1134630,"avatar":"https://static001.geekbang.org/account/avatar/00/11/50/26/b0a0b6b5.jpg","nickname":"SuperXiong","note":"","ucode":"EA3FF62368DD56","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":1348219,"avatar":"https://static001.geekbang.org/account/avatar/00/14/92/7b/8c7e3e61.jpg","nickname":"Monroe  He","note":"","ucode":"D04ECB2EF2E0DA","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":131190,"discussion_content":"注册不了，提交注册表单出问题，要练习客服，联系了也没反应","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1578831693,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":3288,"ip_address":""},"score":131190,"extra":""}]}]},{"had_liked":false,"id":246362,"user_name":"知止。","can_delete":false,"product_type":"c1","uid":2087309,"ip_address":"","ucode":"5D56DD062B1A43","user_header":"https://static001.geekbang.org/account/avatar/00/1f/d9/8d/78dd472a.jpg","comment_is_top":false,"comment_ctime":1599295644,"is_pvip":false,"discussion_count":2,"race_medal":0,"score":"5894262940","product_id":100026901,"comment_content":"老师，是不是该针对运行可能出现的一些问题给出解答呢？如果网站变更过信息，那么课件相应也得更新一下吧，不然后来订阅学习的人没办法完整学习啊。比如我按照课件内容运行，提示{&#39;result&#39;: &#39;error&#39;, &#39;reason&#39;: &#39;InvalidSignature&#39;, &#39;message&#39;: &#39;InvalidSignature&#39;}，网上都找不到原因，想自己排查错误都不懂如何着手<br>","like_count":1,"discussions":[{"author":{"id":2041435,"avatar":"https://static001.geekbang.org/account/avatar/00/1f/26/5b/30281476.jpg","nickname":"落雨","note":"","ucode":"5B3B09E72211B6","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":386985,"discussion_content":"老师提出的问题深有同感啊，老哥的问题可以参考你楼上Sanhong的答案\n","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1627918895,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1714189,"avatar":"https://static001.geekbang.org/account/avatar/00/1a/28/0d/9d10e756.jpg","nickname":"raito4","note":"","ucode":"7F307F9988D4A8","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":344119,"discussion_content":"你这是签名错了啊，说明生成签名的某个参数不对或者加密方法不对","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1611299156,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":170993,"user_name":"SuperXiong","can_delete":false,"product_type":"c1","uid":1134630,"ip_address":"","ucode":"EA3FF62368DD56","user_header":"https://static001.geekbang.org/account/avatar/00/11/50/26/b0a0b6b5.jpg","comment_is_top":false,"comment_ctime":1578814704,"is_pvip":false,"discussion_count":6,"race_medal":0,"score":"5873782000","product_id":100026901,"comment_content":"第一部：注册sandbox没有成功，选了中国区，提交注册表之后，返回一个未知问题。","like_count":1,"discussions":[{"author":{"id":1016917,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/84/55/1e40bd61.jpg","nickname":"shiziwen","note":"","ucode":"ADADC770D82D66","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":269306,"discussion_content":"我也是没有注册成功，客服告诉我没有开通在中国大陆的服务，一直卡在手机验证这块，请问SuperXiong是怎么解决的？\n","likes_number":1,"is_delete":false,"is_hidden":false,"ctime":1589893243,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":1,"child_discussions":[{"author":{"id":2321982,"avatar":"https://static001.geekbang.org/account/avatar/00/23/6e/3e/874ec3c1.jpg","nickname":"cooper","note":"","ucode":"27259668DC97B5","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":1016917,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/84/55/1e40bd61.jpg","nickname":"shiziwen","note":"","ucode":"ADADC770D82D66","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":363939,"discussion_content":"我也是，怎么解决？","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1617328874,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":269306,"ip_address":""},"score":363939,"extra":""}]},{"author":{"id":1499572,"avatar":"https://static001.geekbang.org/account/avatar/00/16/e1/b4/b8f48139.jpg","nickname":"北北","note":"","ucode":"CE8E414ED7FECE","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":325161,"discussion_content":"我是用gmail邮箱注册的，注册成功","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1605248136,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1564605,"avatar":"","nickname":"宋强","note":"","ucode":"119A0B00ABDA7B","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":165724,"discussion_content":"我尝试使用网易或者腾讯邮箱，都一直停留在注册界面，请问你最后是换了哪款邮箱","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1581318280,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1134630,"avatar":"https://static001.geekbang.org/account/avatar/00/11/50/26/b0a0b6b5.jpg","nickname":"SuperXiong","note":"","ucode":"EA3FF62368DD56","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":138880,"discussion_content":"解决了，方法是换个邮箱或者找客服，没想到Gemini服务出奇优秀，这里赞一个！","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1579268890,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":1,"child_discussions":[{"author":{"id":1073175,"avatar":"https://static001.geekbang.org/account/avatar/00/10/60/17/2c2c21b6.jpg","nickname":"无敌小饭桶","note":"","ucode":"AF0015EC4BC90D","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":1134630,"avatar":"https://static001.geekbang.org/account/avatar/00/11/50/26/b0a0b6b5.jpg","nickname":"SuperXiong","note":"","ucode":"EA3FF62368DD56","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":203855,"discussion_content":"哥咋弄的，注册不了啊","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1584093105,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":138880,"ip_address":""},"score":203855,"extra":""}]}]},{"had_liked":false,"id":128541,"user_name":"鱼鱼鱼培填","can_delete":false,"product_type":"c1","uid":1195489,"ip_address":"","ucode":"5D99ED5A01AB3D","user_header":"https://static001.geekbang.org/account/avatar/00/12/3d/e1/5279ea2f.jpg","comment_is_top":false,"comment_ctime":1566898209,"is_pvip":false,"discussion_count":1,"race_medal":0,"score":"5861865505","product_id":100026901,"comment_content":"请教老师一个问题：在Gemini注册账号之后用生成key和secret实现代码，结果一直出现InvalidSignature<br>试了两种方式：<br>1、一开始以为是key setting的问题，结果三种都试过还是一样的结果<br>2、重新生成key和secret，也还是一样的结果<br>Google查找后发现有人也是一样的结果，但是没有找到解决方案","like_count":1,"discussions":[{"author":{"id":2087309,"avatar":"https://static001.geekbang.org/account/avatar/00/1f/d9/8d/78dd472a.jpg","nickname":"知止。","note":"","ucode":"5D56DD062B1A43","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":303497,"discussion_content":"{&#39;result&#39;: &#39;error&#39;, &#39;reason&#39;: &#39;InvalidSignature&#39;, &#39;message&#39;: &#39;InvalidSignature&#39;}\n","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1599284536,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":117741,"user_name":"许童童","can_delete":false,"product_type":"c1","uid":1003005,"ip_address":"","ucode":"4B799C0C6BC678","user_header":"https://static001.geekbang.org/account/avatar/00/0f/4d/fd/0aa0e39f.jpg","comment_is_top":false,"comment_ctime":1564122945,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"5859090241","product_id":100026901,"comment_content":"老师讲得好啊，妙啊！","like_count":1},{"had_liked":false,"id":117732,"user_name":"Geek_adeba6","can_delete":false,"product_type":"c1","uid":1313206,"ip_address":"","ucode":"78B05B44FCC268","user_header":"","comment_is_top":false,"comment_ctime":1564120788,"is_pvip":false,"discussion_count":1,"race_medal":0,"score":"5859088084","product_id":100026901,"comment_content":"想请问如果想实现秒级别的市场行情获取，生产环境下的最佳实践是什么？","like_count":1,"discussions":[{"author":{"id":1313206,"avatar":"","nickname":"Geek_adeba6","note":"","ucode":"78B05B44FCC268","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":3031,"discussion_content":"补充一下就是秒级别的定时任务在生产环境下，最佳实践有哪些？谢谢","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1564124105,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":117702,"user_name":"程序员人生","can_delete":false,"product_type":"c1","uid":1113668,"ip_address":"","ucode":"C5C5073D89AAA2","user_header":"https://static001.geekbang.org/account/avatar/00/10/fe/44/3e3040ac.jpg","comment_is_top":false,"comment_ctime":1564114222,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"5859081518","product_id":100026901,"comment_content":"timestamp应该不能代替nonce。<br>当某个后请求的nonce，比上一个成功收到请求的nonce小或者等于时候，服务器会拒绝接收。<br>但timestamp不行，因为后请求的timestamp，可能会由于各种原因先到服务器，先请求的可能会晚到，并不能体现先后次序。<br>不知道我理解是否正确？","like_count":1},{"had_liked":false,"id":117567,"user_name":"Xg huang","can_delete":false,"product_type":"c1","uid":1016995,"ip_address":"","ucode":"9680FA95DE3553","user_header":"","comment_is_top":false,"comment_ctime":1564095196,"is_pvip":false,"replies":[{"id":"43048","content":"是的，我修改了","user_name":"编辑回复","user_name_real":"郭蕾","uid":"1000473","ctime":1564100325,"ip_address":"","comment_id":117567,"utype":2}],"discussion_count":1,"race_medal":0,"score":"5859062492","product_id":100026901,"comment_content":"哈哈，深入浅出，赞一个<br><br>不过有个地方是否写错？&quot;而小宝在某一天中午 11:59:00，告诉交易所，我要挂一个单子，数量为 0.1 比特币，价格为 10000 美元，低于这个价格不卖。&quot;<br><br>是不是1000才对？","like_count":1,"discussions":[{"author":{"id":1000473,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/44/19/17fadc62.jpg","nickname":"郭蕾","note":"","ucode":"34F4C07D1C5FE8","race_medal":0,"user_type":8,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":460027,"discussion_content":"是的，我修改了","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1564100325,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":4}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":117554,"user_name":"SuQiu","can_delete":false,"product_type":"c1","uid":1289128,"ip_address":"","ucode":"ABA149B869746F","user_header":"https://static001.geekbang.org/account/avatar/00/13/ab/a8/eb9f186e.jpg","comment_is_top":false,"comment_ctime":1564074149,"is_pvip":false,"discussion_count":1,"race_medal":0,"score":"5859041445","product_id":100026901,"comment_content":"timestamp也属于自增长，猜测是由于他的可预见性，所以不能代替nonce","like_count":1,"discussions":[{"author":{"id":1105457,"avatar":"https://static001.geekbang.org/account/avatar/00/10/de/31/a783a2a6.jpg","nickname":"mira_wey","note":"","ucode":"FA1B6A3FBC2A19","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":320194,"discussion_content":"可预见性怎么理解？还是不明白和单调递增的区别","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1604287866,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":343827,"user_name":"徐李","can_delete":false,"product_type":"c1","uid":1213325,"ip_address":"","ucode":"41550F6CA1E112","user_header":"https://static001.geekbang.org/account/avatar/00/12/83/8d/03cac826.jpg","comment_is_top":false,"comment_ctime":1651071054,"is_pvip":true,"discussion_count":0,"race_medal":0,"score":"1651071054","product_id":100026901,"comment_content":"时间错不能完全保证唯一性","like_count":0},{"had_liked":false,"id":327052,"user_name":"Geek_56b863","can_delete":false,"product_type":"c1","uid":2872032,"ip_address":"","ucode":"F9776DCCEA9092","user_header":"","comment_is_top":false,"comment_ctime":1639887854,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1639887854","product_id":100026901,"comment_content":"老师，requests.post(url,data=None,headers=request_headers) 执行后，等待一会儿会报错：ConnectionError: HTTPSConnectionPool(host=&#39;api.sandbox.gemini.com&#39;, port=443): Max retries exceeded with url: &#47;v1&#47;order&#47;new (Caused by NewConnectionError(&#39;&lt;urllib3.connection.HTTPSConnection object at 0x00000141BA65CAC0&gt;: Failed to establish a new connection: [WinError 10060] 由于连接方在一段时间后没有正确答复或连接的主机没有反应，连接尝试失败。&#39;))<br><br>科学上网也无法解决，会报出另一个错误：ValueError: check_hostname requires server_hostname<br><br>请问老师，这个REQUEST.POST问题，应该如何解决呢？谢谢解答","like_count":0},{"had_liked":false,"id":250196,"user_name":"Sanhong","can_delete":false,"product_type":"c1","uid":1005630,"ip_address":"","ucode":"0B68D6EE423CA8","user_header":"https://static001.geekbang.org/account/avatar/00/0f/58/3e/77c9b529.jpg","comment_is_top":false,"comment_ctime":1600968098,"is_pvip":true,"discussion_count":0,"race_medal":0,"score":"1600968098","product_id":100026901,"comment_content":"如果报{&#39;result&#39;: &#39;error&#39;, &#39;reason&#39;: &#39;InvalidSignature&#39;, &#39;message&#39;: &#39;InvalidSignature&#39;} ，就检查一下key和secret是否正确；<br>如果报{&#39;result&#39;: &#39;error&#39;, &#39;reason&#39;: &#39;MissingAccounts&#39;, &#39;message&#39;: &#39;Expected a JSON payload with accounts&#39;}，就检查一下scope是否为Primary，并且Permissions是否有交易权限。","like_count":0},{"had_liked":false,"id":206332,"user_name":"皮皮侠","can_delete":false,"product_type":"c1","uid":1258402,"ip_address":"","ucode":"04205990C1DE1F","user_header":"https://static001.geekbang.org/account/avatar/00/13/33/a2/6c0ffc15.jpg","comment_is_top":false,"comment_ctime":1586841467,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1586841467","product_id":100026901,"comment_content":"谢谢老师教我方法✌️","like_count":0},{"had_liked":false,"id":206227,"user_name":"Richard","can_delete":false,"product_type":"c1","uid":1316758,"ip_address":"","ucode":"893F958B9DD161","user_header":"https://static001.geekbang.org/account/avatar/00/14/17/96/846fc11b.jpg","comment_is_top":false,"comment_ctime":1586825813,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1586825813","product_id":100026901,"comment_content":"还有一点就是timestamp在nat网络中会有问题，难以保证单调递增，虽然这种极端情况基本不可能发生","like_count":0},{"had_liked":false,"id":204224,"user_name":"余皇南","can_delete":false,"product_type":"c1","uid":1918922,"ip_address":"","ucode":"3CCED29D3D513D","user_header":"http://thirdwx.qlogo.cn/mmopen/vi_32/8P1a8D3WButrPQicebnKkrAiaI1lWUfZicWPtWfXHbm9Xv7qb1tkJ7eiaxVG2JfO8mLJt7AzmPXjn0MsgjKBWujFfQ/132","comment_is_top":false,"comment_ctime":1586353673,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1586353673","product_id":100026901,"comment_content":"nonce 并不幂等啊？ 因为网络原因会造成 重复下单（首次成功但延迟）的可能；","like_count":0},{"had_liked":false,"id":187027,"user_name":"向南","can_delete":false,"product_type":"c1","uid":1325700,"ip_address":"","ucode":"E6072AD7CA6798","user_header":"https://static001.geekbang.org/account/avatar/00/14/3a/84/70340e87.jpg","comment_is_top":false,"comment_ctime":1583994330,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1583994330","product_id":100026901,"comment_content":"区别在于生成nonce及执行交易的顺讯，会不会出现后生成nonce的交易请求抢先一步提交交易所执行交易，导致先前生成nonce的请求不得已被延后执行时，被交易所拒绝。<br>若能保证 先一步 生成nonce的交易请求 先执行交易，则二者没啥区别（时间戳是float的不考虑，肯定会转换的）；若不能保证，则nonce更安全些。<br>但是文中的nonce本质上不也是时间戳吗？<br>看了Gemini REST API 的文档，文中的例子和Gemini给的例子一毛一样。<br>还有就是创建master API账户无法进行交易，必须是Primary账户。","like_count":0},{"had_liked":false,"id":179767,"user_name":"建强","can_delete":false,"product_type":"c1","uid":1397126,"ip_address":"","ucode":"62B03D0E0C64EC","user_header":"https://static001.geekbang.org/account/avatar/00/15/51/86/b5fd8dd8.jpg","comment_is_top":false,"comment_ctime":1582094207,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1582094207","product_id":100026901,"comment_content":"网络编程没有接触过，对这道思考题的个人初步理解：用timestamp代替nonce可能会有隐患，第一，timestamp是时间戳，而nonce要求是整数，可能需要做转换；第二，timestamp需要根据发送方服务器时间来生成，一旦发送方的服务器时间设置错误，有可能造成接收方拒收；第三，用timestamp容易被破解，可能会受第三方的攻击。","like_count":0},{"had_liked":false,"id":171304,"user_name":"王帅帅","can_delete":false,"product_type":"c1","uid":1526719,"ip_address":"","ucode":"84424192B61D47","user_header":"https://static001.geekbang.org/account/avatar/00/17/4b/bf/d714f592.jpg","comment_is_top":false,"comment_ctime":1578898640,"is_pvip":false,"replies":[{"id":"66517","content":"交易所 API 在维护，可以等一段时间，或者换其他交易所自己尝试","user_name":"作者回复","user_name_real":"高山流水","uid":"1513504","ctime":1578979077,"ip_address":"","comment_id":171304,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1578898640","product_id":100026901,"comment_content":"我跑了一遍，提示gemini 交易所正在维护，怎么回事。","like_count":0,"discussions":[{"author":{"id":1513504,"avatar":"https://static001.geekbang.org/account/avatar/00/17/18/20/75ea3b20.jpg","nickname":"高山流水","note":"","ucode":"71E513B5937481","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":481293,"discussion_content":"交易所 API 在维护，可以等一段时间，或者换其他交易所自己尝试","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1578979077,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":142612,"user_name":"furuiyang","can_delete":false,"product_type":"c1","uid":1054414,"ip_address":"","ucode":"8460F6F73DB937","user_header":"https://static001.geekbang.org/account/avatar/00/10/16/ce/e60edcf0.jpg","comment_is_top":false,"comment_ctime":1571412543,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1571412543","product_id":100026901,"comment_content":"为啥大宝要买回复给了小明 小宝要卖回复给了小强 ...😵","like_count":0},{"had_liked":false,"id":140925,"user_name":"三件事","can_delete":false,"product_type":"c1","uid":1055819,"ip_address":"","ucode":"BCC867C8961A24","user_header":"https://static001.geekbang.org/account/avatar/00/10/1c/4b/2e5df06f.jpg","comment_is_top":false,"comment_ctime":1571095783,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1571095783","product_id":100026901,"comment_content":"非常喜欢老师的授课风格！","like_count":0},{"had_liked":false,"id":140677,"user_name":"扶幽","can_delete":false,"product_type":"c1","uid":1322612,"ip_address":"","ucode":"1400EDFF8970D3","user_header":"https://static001.geekbang.org/account/avatar/00/14/2e/74/88c613e0.jpg","comment_is_top":false,"comment_ctime":1571027298,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1571027298","product_id":100026901,"comment_content":"应该不能。<br>原因：因为nonce只有在被接收成功时才会增量，失败时未必会递增（我的假设，具体还待大佬们纠正）。但是使用时间戳的话，肯定是递增的，在一定程度上无法解决重复订单问题。","like_count":0},{"had_liked":false,"id":121001,"user_name":"江南皮革厂研发中心保安队长","can_delete":false,"product_type":"c1","uid":1099584,"ip_address":"","ucode":"231419643A5CC5","user_header":"https://static001.geekbang.org/account/avatar/00/10/c7/40/66a203cd.jpg","comment_is_top":false,"comment_ctime":1565048663,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1565048663","product_id":100026901,"comment_content":"为什么我不是IT大牛，因为我没有小明这样的妈妈。[滑稽]","like_count":0},{"had_liked":false,"id":118825,"user_name":"csn","can_delete":false,"product_type":"c1","uid":1524609,"ip_address":"","ucode":"68FAE1EE372ADF","user_header":"https://static001.geekbang.org/account/avatar/00/17/43/81/8b09dd90.jpg","comment_is_top":false,"comment_ctime":1564450111,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1564450111","product_id":100026901,"comment_content":"gemini_api_key是什么？","like_count":0},{"had_liked":false,"id":117821,"user_name":"蜉蝣","can_delete":false,"product_type":"c1","uid":1229070,"ip_address":"","ucode":"77CF92496855D4","user_header":"https://static001.geekbang.org/account/avatar/00/12/c1/0e/2b987d54.jpg","comment_is_top":false,"comment_ctime":1564137732,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1564137732","product_id":100026901,"comment_content":"大家为什么都不运行一下 `time.mktime(datetime.datetime.now().timetuple())` 就在说不能代替的问题","like_count":0},{"had_liked":false,"id":117712,"user_name":"code2","can_delete":false,"product_type":"c1","uid":1281792,"ip_address":"","ucode":"BBA5748FB6A01C","user_header":"http://thirdwx.qlogo.cn/mmopen/vi_32/8OPzdpDraQMvCNWAicicDt54sDaIYJZicBLfMyibXVs4V0ZibEdkZlbzxxL7aGpRoeyvibag5LaAaaGKSdwYQMY2hUrQ/132","comment_is_top":false,"comment_ctime":1564116144,"is_pvip":false,"discussion_count":2,"race_medal":0,"score":"1564116144","product_id":100026901,"comment_content":"HTTP 协议是 Hyper Text Transfer Protocolv翻译过来不是超文本传输协议，提出这个协议的作者在其博士论文中有明确说明。","like_count":0,"discussions":[{"author":{"id":2369413,"avatar":"https://static001.geekbang.org/account/avatar/00/24/27/85/ddeeaf30.jpg","nickname":"dived","note":"","ucode":"141916A3BAF5A1","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":375180,"discussion_content":"我们学的不是一个英语吗 请问应该翻译成啥","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1621503296,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":1,"child_discussions":[{"author":{"id":1281792,"avatar":"http://thirdwx.qlogo.cn/mmopen/vi_32/8OPzdpDraQMvCNWAicicDt54sDaIYJZicBLfMyibXVs4V0ZibEdkZlbzxxL7aGpRoeyvibag5LaAaaGKSdwYQMY2hUrQ/132","nickname":"code2","note":"","ucode":"BBA5748FB6A01C","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":2369413,"avatar":"https://static001.geekbang.org/account/avatar/00/24/27/85/ddeeaf30.jpg","nickname":"dived","note":"","ucode":"141916A3BAF5A1","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":393336,"discussion_content":"超文本转换协议，英文同一个词，汉语意思很多。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1631364226,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":375180,"ip_address":""},"score":393336,"extra":""}]}]}]}