{"id":624256,"title":"96｜如何实现数据的批量格式转换？","content":"<p><strong>课后习题</strong><br>\n请你编写程序，将指定 Word 文件中的文字内容，转换为同名的 Excel 文件。</p><p><strong>课程代码、课件及其他相关资料地址</strong><br>\n<a href=\"https://gitee.com/wilsonyin/zero-basics-python\">https://gitee.com/wilsonyin/zero-basics-python</a></p>","comments":[{"had_liked":false,"id":385243,"user_name":"Geek_631607","can_delete":false,"product_type":"c3","uid":3789991,"ip_address":"广东","ucode":"EAF874838F0BE4","user_header":"","comment_is_top":false,"comment_ctime":1702346325,"is_pvip":false,"replies":null,"discussion_count":0,"race_medal":0,"score":2,"product_id":100310001,"comment_content":"from docx import Document\nimport pandas as pd\n\n# 读取 Word 文件\ndoc = Document(&#39;file.docx&#39;)\n\n# 提取 Word 文件中的文字内容\ndata = [p.text for p in doc.paragraphs]\n\n# 创建一个 DataFrame\ndf = pd.DataFrame(data, columns=[&#39;Text&#39;])\n\n# 将 DataFrame 写入 Excel 文件\ndf.to_excel(&#39;file.xlsx&#39;, index=False)","like_count":0},{"had_liked":false,"id":384950,"user_name":"依托答辩","can_delete":false,"product_type":"c3","uid":2383299,"ip_address":"上海","ucode":"4BE79E8A030813","user_header":"https://static001.geekbang.org/account/avatar/00/24/5d/c3/b8bb888c.jpg","comment_is_top":false,"comment_ctime":1701847143,"is_pvip":false,"replies":null,"discussion_count":0,"race_medal":0,"score":2,"product_id":100310001,"comment_content":"my_list = [\n    [[1, 2, 3], [4, 5, 6]]\n]\nflat = [x for sub1 in my_list for sub2 in sub1 for x in sub2]\nprint(flat)\n# [1, 2, 3, 4, 5, 6]\n\nflat2 = [((x for x in sub2) for sub2 in sub1) for sub1 in my_list]\nprint(list(flat))\n# [1, 2, 3, 4, 5, 6]","like_count":0},{"had_liked":false,"id":383481,"user_name":"MarkG","can_delete":false,"product_type":"c3","uid":3675806,"ip_address":"山东","ucode":"454082595FE769","user_header":"https://static001.geekbang.org/account/avatar/00/38/16/9e/48621655.jpg","comment_is_top":false,"comment_ctime":1699112706,"is_pvip":false,"replies":null,"discussion_count":0,"race_medal":0,"score":2,"product_id":100310001,"comment_content":"将指定的 Excel 文件，转化为同名的 Word 文件\n\nfrom openpyxl import load_workbook\n\nwb = load_workbook(&#39;.&#47;sample2.xlsx&#39;)\nws = wb.active\n\ndata_cell = []\ndata_row = []\n\nfor row in ws.iter_rows():\n    for cell in row:\n        data_cell.append(cell.value)\n    data_row.append(tuple(data_cell))\n    data_cell = []\n\ndata_row_tuple = tuple(data_row)\n\n\nfrom docx import Document\n\ndocument = Document()\ndocument.add_heading(&quot;标题&quot;, 0)\n\ntable = document.add_table(rows=1, cols=3)\n\n# 剥离首行\ntuple_first_row = data_row_tuple[0]\ntuple_rest_rows = data_row_tuple[1:]\nprint(&#39;tuple_first_row&#39;, tuple_first_row)\nprint(&#39;tuple_rest_rows&#39;, tuple_rest_rows)\n\n# 表格首行\nhdr_cells = table.rows[0].cells\nhdr_cells[0].text = tuple_first_row[0]\nhdr_cells[1].text = tuple_first_row[1]\nhdr_cells[2].text = tuple_first_row[2]\n\n\nfor qty, id, desc in tuple_rest_rows:\n    row_cells = table.add_row().cells\n    row_cells[0].text = str(qty)\n    row_cells[1].text = id\n    row_cells[2].text = desc\n\ndocument.add_page_break()\n\ndocument.save(&#39;sample2.docx&#39;)","like_count":0},{"had_liked":false,"id":383020,"user_name":"Geek_Mike","can_delete":false,"product_type":"c3","uid":3196376,"ip_address":"云南","ucode":"CFA942192C3B74","user_header":"https://static001.geekbang.org/account/avatar/00/30/c5/d8/c5509b9c.jpg","comment_is_top":false,"comment_ctime":1698308890,"is_pvip":false,"replies":null,"discussion_count":0,"race_medal":0,"score":2,"product_id":100310001,"comment_content":"&#39;&#39;&#39;将指定 Word 文件中的文字内容，转换为同名的 Excel 文件&#39;&#39;&#39;\nimport openpyxl\nimport docx\n\npath = &#39;.&#47;sample.docx&#39;\ndoc = docx.Document(path)\n\npara_list = []\nfor para in doc.paragraphs:\n    para_list.append(para.text)\n\n    wb = openpyxl.Workbook()\n    ws = wb.active\n    ws.append(para_list)\n\n    wb.save(&#39;.&#47;sample.xlsx&#39;)","like_count":0},{"had_liked":false,"id":378564,"user_name":"Greenery","can_delete":false,"product_type":"c3","uid":3566765,"ip_address":"新加坡","ucode":"16111129C9EBA2","user_header":"https://static001.geekbang.org/account/avatar/00/36/6c/ad/0a694b50.jpg","comment_is_top":false,"comment_ctime":1690428100,"is_pvip":false,"replies":null,"discussion_count":0,"race_medal":0,"score":2,"product_id":100310001,"comment_content":"#%%\nfrom docx import Document\nfrom openpyxl import Workbook\nfrom os import chdir\n\nchdir(r&#39;C:\\Projects\\python\\0base_py\\ch12\\exp3&#39;)\ndocument = Document(&#39;sample.docx&#39;)\nsearch_txt = &#39;plain&#39;\nresult = []\nfor para in document.paragraphs:\n  if search_txt in para.text:\n    result.append(para.text)\nprint(result)\n#%%\nwb_part = Workbook()\nws_part = wb_part.active\nfor row in result:\n  ws_part.append([row])\nwb_part.save(&quot;hk.xlsx&quot;)","like_count":0},{"had_liked":false,"id":367403,"user_name":"Cy23","can_delete":false,"product_type":"c3","uid":1591293,"ip_address":"辽宁","ucode":"8DC561C5151758","user_header":"https://static001.geekbang.org/account/avatar/00/18/47/fd/895f0c27.jpg","comment_is_top":false,"comment_ctime":1675216052,"is_pvip":false,"replies":null,"discussion_count":0,"race_medal":0,"score":2,"product_id":100310001,"comment_content":"from docx import Document\nfrom openpyxl import Workbook\n\ndocument = Document(&#39;.&#47;2.docx&#39;)\nsearch_txt = &#39;沈阳&#39;\nresult = []\nfor para in document.paragraphs:\n  if search_txt in para.text:\n    result.append(para.text)\n\nwb_part = Workbook()\nws_part = wb_part.active\nfor row in result:\n  ws_part.append([row])\nwb_part.save(&quot;2.xlsx&quot;)","like_count":0}]}