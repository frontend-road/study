{"id":70822,"title":"06 | æ¡ˆä¾‹ç¯‡ï¼šç³»ç»Ÿçš„ CPU ä½¿ç”¨ç‡å¾ˆé«˜ï¼Œä½†ä¸ºå•¥å´æ‰¾ä¸åˆ°é«˜ CPU çš„åº”ç”¨ï¼Ÿ","content":"<p>ä½ å¥½ï¼Œæˆ‘æ˜¯å€ªæœ‹é£ã€‚</p><p>ä¸Šä¸€èŠ‚æˆ‘è®²äº† CPU ä½¿ç”¨ç‡æ˜¯ä»€ä¹ˆï¼Œå¹¶é€šè¿‡ä¸€ä¸ªæ¡ˆä¾‹æ•™ä½ ä½¿ç”¨ topã€vmstatã€pidstat ç­‰å·¥å…·ï¼Œæ’æŸ¥é«˜ CPU ä½¿ç”¨ç‡çš„è¿›ç¨‹ï¼Œç„¶åå†ä½¿ç”¨ perf top å·¥å…·ï¼Œå®šä½åº”ç”¨å†…éƒ¨å‡½æ•°çš„é—®é¢˜ã€‚ä¸è¿‡å°±æœ‰äººç•™è¨€äº†ï¼Œè¯´ä¼¼ä¹æ„Ÿè§‰é«˜ CPU ä½¿ç”¨ç‡çš„é—®é¢˜ï¼Œè¿˜æ˜¯æŒºå®¹æ˜“æ’æŸ¥çš„ã€‚</p><p>é‚£æ˜¯ä¸æ˜¯æ‰€æœ‰ CPU ä½¿ç”¨ç‡é«˜çš„é—®é¢˜ï¼Œéƒ½å¯ä»¥è¿™ä¹ˆåˆ†æå‘¢ï¼Ÿæˆ‘æƒ³ï¼Œä½ çš„ç­”æ¡ˆåº”è¯¥æ˜¯å¦å®šçš„ã€‚</p><p>å›é¡¾å‰é¢çš„å†…å®¹ï¼Œæˆ‘ä»¬çŸ¥é“ï¼Œç³»ç»Ÿçš„ CPU ä½¿ç”¨ç‡ï¼Œä¸ä»…åŒ…æ‹¬è¿›ç¨‹ç”¨æˆ·æ€å’Œå†…æ ¸æ€çš„è¿è¡Œï¼Œè¿˜åŒ…æ‹¬ä¸­æ–­å¤„ç†ã€ç­‰å¾… I/O ä»¥åŠå†…æ ¸çº¿ç¨‹ç­‰ã€‚æ‰€ä»¥ï¼Œ<strong>å½“ä½ å‘ç°ç³»ç»Ÿçš„ CPU ä½¿ç”¨ç‡å¾ˆé«˜çš„æ—¶å€™ï¼Œä¸ä¸€å®šèƒ½æ‰¾åˆ°ç›¸å¯¹åº”çš„é«˜ CPU ä½¿ç”¨ç‡çš„è¿›ç¨‹</strong>ã€‚</p><p>ä»Šå¤©ï¼Œæˆ‘å°±ç”¨ä¸€ä¸ª Nginx + PHP çš„ Web æœåŠ¡çš„æ¡ˆä¾‹ï¼Œå¸¦ä½ æ¥åˆ†æè¿™ç§æƒ…å†µã€‚</p><h2>æ¡ˆä¾‹åˆ†æ</h2><h3>ä½ çš„å‡†å¤‡</h3><p>ä»Šå¤©ä¾æ—§æ¢ç©¶ç³»ç»ŸCPUä½¿ç”¨ç‡é«˜çš„æƒ…å†µï¼Œæ‰€ä»¥è¿™æ¬¡å®éªŒçš„å‡†å¤‡å·¥ä½œï¼Œä¸ä¸ŠèŠ‚è¯¾çš„å‡†å¤‡å·¥ä½œåŸºæœ¬ç›¸åŒï¼Œå·®åˆ«åœ¨äºæ¡ˆä¾‹æ‰€ç”¨çš„ Docker é•œåƒä¸åŒã€‚</p><p>æœ¬æ¬¡æ¡ˆä¾‹è¿˜æ˜¯åŸºäº Ubuntu 18.04ï¼ŒåŒæ ·é€‚ç”¨äºå…¶ä»–çš„ Linux ç³»ç»Ÿã€‚æˆ‘ä½¿ç”¨çš„æ¡ˆä¾‹ç¯å¢ƒå¦‚ä¸‹æ‰€ç¤ºï¼š</p><ul>\n<li>\n<p>æœºå™¨é…ç½®ï¼š2 CPUï¼Œ8GB å†…å­˜</p>\n</li>\n<li>\n<p>é¢„å…ˆå®‰è£… dockerã€sysstatã€perfã€ab ç­‰å·¥å…·ï¼Œå¦‚ apt install <a href=\"http://docker.io\">docker.io</a> sysstat linux-tools-common apache2-utils</p>\n</li>\n</ul><!-- [[[read_end]]] --><p>å‰é¢æˆ‘ä»¬è®²åˆ°è¿‡ï¼Œabï¼ˆapache benchï¼‰æ˜¯ä¸€ä¸ªå¸¸ç”¨çš„ HTTP æœåŠ¡æ€§èƒ½æµ‹è¯•å·¥å…·ï¼Œè¿™é‡ŒåŒæ ·ç”¨æ¥æ¨¡æ‹Ÿ Nginx çš„å®¢æˆ·ç«¯ã€‚ç”±äº Nginx å’Œ PHP çš„é…ç½®æ¯”è¾ƒéº»çƒ¦ï¼Œæˆ‘æŠŠå®ƒä»¬æ‰“åŒ…æˆäº†ä¸¤ä¸ª <a href=\"https://github.com/feiskyer/linux-perf-examples/tree/master/nginx-short-process\">Docker é•œåƒ</a>ï¼Œè¿™æ ·åªéœ€è¦è¿è¡Œä¸¤ä¸ªå®¹å™¨ï¼Œå°±å¯ä»¥å¾—åˆ°æ¨¡æ‹Ÿç¯å¢ƒã€‚</p><p>æ³¨æ„ï¼Œè¿™ä¸ªæ¡ˆä¾‹è¦ç”¨åˆ°ä¸¤å°è™šæ‹Ÿæœºï¼Œå¦‚ä¸‹å›¾æ‰€ç¤ºï¼š</p><p><img src=\"https://static001.geekbang.org/resource/image/90/3d/90c30b4f555218f77241bfe2ac27723d.png?wh=408*258\" alt=\"\"></p><p>ä½ å¯ä»¥çœ‹åˆ°ï¼Œå…¶ä¸­ä¸€å°ç”¨ä½œ Web æœåŠ¡å™¨ï¼Œæ¥æ¨¡æ‹Ÿæ€§èƒ½é—®é¢˜ï¼›å¦ä¸€å°ç”¨ä½œ Web æœåŠ¡å™¨çš„å®¢æˆ·ç«¯ï¼Œæ¥ç»™ Web æœåŠ¡å¢åŠ å‹åŠ›è¯·æ±‚ã€‚ä½¿ç”¨ä¸¤å°è™šæ‹Ÿæœºæ˜¯ä¸ºäº†ç›¸äº’éš”ç¦»ï¼Œé¿å…â€œäº¤å‰æ„ŸæŸ“â€ã€‚</p><p>æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬æ‰“å¼€ä¸¤ä¸ªç»ˆç«¯ï¼Œåˆ†åˆ« SSH ç™»å½•åˆ°ä¸¤å°æœºå™¨ä¸Šï¼Œå¹¶å®‰è£…ä¸Šè¿°å·¥å…·ã€‚</p><p>åŒæ ·æ³¨æ„ï¼Œä¸‹é¢æ‰€æœ‰å‘½ä»¤éƒ½é»˜è®¤ä»¥ root ç”¨æˆ·è¿è¡Œï¼Œå¦‚æœä½ æ˜¯ç”¨æ™®é€šç”¨æˆ·èº«ä»½ç™»é™†ç³»ç»Ÿï¼Œè¯·è¿è¡Œ sudo su root å‘½ä»¤åˆ‡æ¢åˆ° root ç”¨æˆ·ã€‚</p><p>èµ°åˆ°è¿™ä¸€æ­¥ï¼Œå‡†å¤‡å·¥ä½œå°±å®Œæˆäº†ã€‚æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬æ­£å¼è¿›å…¥æ“ä½œç¯èŠ‚ã€‚</p><blockquote>\n<p>æ¸©é¦¨æç¤ºï¼šæ¡ˆä¾‹ä¸­ PHP åº”ç”¨çš„æ ¸å¿ƒé€»è¾‘æ¯”è¾ƒç®€å•ï¼Œä½ å¯èƒ½ä¸€çœ¼å°±èƒ½çœ‹å‡ºé—®é¢˜ï¼Œä½†å®é™…ç”Ÿäº§ç¯å¢ƒä¸­çš„æºç å°±å¤æ‚å¤šäº†ã€‚æ‰€ä»¥ï¼Œæˆ‘ä¾æ—§å»ºè®®ï¼Œ<strong>æ“ä½œä¹‹å‰åˆ«çœ‹æºç </strong>ï¼Œé¿å…å…ˆå…¥ä¸ºä¸»ï¼Œè€Œè¦æŠŠå®ƒå½“æˆä¸€ä¸ªé»‘ç›’æ¥åˆ†æã€‚è¿™æ ·ï¼Œä½ å¯ä»¥æ›´å¥½æŠŠæ¡ï¼Œæ€ä¹ˆä»ç³»ç»Ÿçš„èµ„æºä½¿ç”¨é—®é¢˜å‡ºå‘ï¼Œåˆ†æå‡ºç“¶é¢ˆæ‰€åœ¨çš„åº”ç”¨ï¼Œä»¥åŠç“¶é¢ˆåœ¨åº”ç”¨ä¸­å¤§æ¦‚çš„ä½ç½®ã€‚</p>\n</blockquote><h3>æ“ä½œå’Œåˆ†æ</h3><p>é¦–å…ˆï¼Œæˆ‘ä»¬åœ¨ç¬¬ä¸€ä¸ªç»ˆç«¯ï¼Œæ‰§è¡Œä¸‹é¢çš„å‘½ä»¤è¿è¡Œ Nginx å’Œ PHP åº”ç”¨ï¼š</p><pre><code>$ docker run --name nginx -p 10000:80 -itd feisky/nginx:sp\n$ docker run --name phpfpm -itd --network container:nginx feisky/php-fpm:sp\n</code></pre><p>ç„¶åï¼Œåœ¨ç¬¬äºŒä¸ªç»ˆç«¯ï¼Œä½¿ç”¨ curl è®¿é—® http://[VM1çš„IP]:10000ï¼Œç¡®è®¤ Nginx å·²æ­£å¸¸å¯åŠ¨ã€‚ä½ åº”è¯¥å¯ä»¥çœ‹åˆ° It works! çš„å“åº”ã€‚</p><pre><code># 192.168.0.10æ˜¯ç¬¬ä¸€å°è™šæ‹Ÿæœºçš„IPåœ°å€\n$ curl http://192.168.0.10:10000/\nIt works!\n</code></pre><p>æ¥ç€ï¼Œæˆ‘ä»¬æ¥æµ‹è¯•ä¸€ä¸‹è¿™ä¸ª Nginx æœåŠ¡çš„æ€§èƒ½ã€‚åœ¨ç¬¬äºŒä¸ªç»ˆç«¯è¿è¡Œä¸‹é¢çš„ ab å‘½ä»¤ã€‚è¦æ³¨æ„ï¼Œä¸ä¸Šæ¬¡æ“ä½œä¸åŒçš„æ˜¯ï¼Œè¿™æ¬¡æˆ‘ä»¬éœ€è¦å¹¶å‘100ä¸ªè¯·æ±‚æµ‹è¯•Nginxæ€§èƒ½ï¼Œæ€»å…±æµ‹è¯•1000ä¸ªè¯·æ±‚ã€‚</p><pre><code># å¹¶å‘100ä¸ªè¯·æ±‚æµ‹è¯•Nginxæ€§èƒ½ï¼Œæ€»å…±æµ‹è¯•1000ä¸ªè¯·æ±‚\n$ ab -c 100 -n 1000 http://192.168.0.10:10000/\nThis is ApacheBench, Version 2.3 &lt;$Revision: 1706008 $&gt;\nCopyright 1996 Adam Twiss, Zeus Technology Ltd, \n...\nRequests per second:    87.86 [#/sec] (mean)\nTime per request:       1138.229 [ms] (mean)\n...\n</code></pre><p>ä»abçš„è¾“å‡ºç»“æœæˆ‘ä»¬å¯ä»¥çœ‹åˆ°ï¼ŒNginxèƒ½æ‰¿å—çš„æ¯ç§’å¹³å‡è¯·æ±‚æ•°ï¼Œåªæœ‰ 87 å¤šä¸€ç‚¹ï¼Œæ˜¯ä¸æ˜¯æ„Ÿè§‰å®ƒçš„æ€§èƒ½æœ‰ç‚¹å·®å‘€ã€‚é‚£ä¹ˆï¼Œåˆ°åº•æ˜¯å“ªé‡Œå‡ºäº†é—®é¢˜å‘¢ï¼Ÿæˆ‘ä»¬å†ç”¨ top å’Œ pidstat æ¥è§‚å¯Ÿä¸€ä¸‹ã€‚</p><p>è¿™æ¬¡ï¼Œæˆ‘ä»¬åœ¨ç¬¬äºŒä¸ªç»ˆç«¯ï¼Œå°†æµ‹è¯•çš„å¹¶å‘è¯·æ±‚æ•°æ”¹æˆ5ï¼ŒåŒæ—¶æŠŠè¯·æ±‚æ—¶é•¿è®¾ç½®ä¸º10åˆ†é’Ÿï¼ˆ-t 600ï¼‰ã€‚è¿™æ ·ï¼Œå½“ä½ åœ¨ç¬¬ä¸€ä¸ªç»ˆç«¯ä½¿ç”¨æ€§èƒ½åˆ†æå·¥å…·æ—¶ï¼Œ Nginx çš„å‹åŠ›è¿˜æ˜¯ç»§ç»­çš„ã€‚</p><p>ç»§ç»­åœ¨ç¬¬äºŒä¸ªç»ˆç«¯è¿è¡Œ ab å‘½ä»¤ï¼š</p><pre><code>$ ab -c 5 -t 600 http://192.168.0.10:10000/\n</code></pre><p>ç„¶åï¼Œæˆ‘ä»¬åœ¨ç¬¬ä¸€ä¸ªç»ˆç«¯è¿è¡Œ top å‘½ä»¤ï¼Œè§‚å¯Ÿç³»ç»Ÿçš„ CPU ä½¿ç”¨æƒ…å†µï¼š</p><pre><code>$ top\n...\n%Cpu(s): 80.8 us, 15.1 sy,  0.0 ni,  2.8 id,  0.0 wa,  0.0 hi,  1.3 si,  0.0 st\n...\n\n  PID USER      PR  NI    VIRT    RES    SHR S  %CPU %MEM     TIME+ COMMAND\n 6882 root      20   0    8456   5052   3884 S   2.7  0.1   0:04.78 docker-containe\n 6947 systemd+  20   0   33104   3716   2340 S   2.7  0.0   0:04.92 nginx\n 7494 daemon    20   0  336696  15012   7332 S   2.0  0.2   0:03.55 php-fpm\n 7495 daemon    20   0  336696  15160   7480 S   2.0  0.2   0:03.55 php-fpm\n10547 daemon    20   0  336696  16200   8520 S   2.0  0.2   0:03.13 php-fpm\n10155 daemon    20   0  336696  16200   8520 S   1.7  0.2   0:03.12 php-fpm\n10552 daemon    20   0  336696  16200   8520 S   1.7  0.2   0:03.12 php-fpm\n15006 root      20   0 1168608  66264  37536 S   1.0  0.8   9:39.51 dockerd\n 4323 root      20   0       0      0      0 I   0.3  0.0   0:00.87 kworker/u4:1\n...\n</code></pre><p>è§‚å¯Ÿ top è¾“å‡ºçš„è¿›ç¨‹åˆ—è¡¨å¯ä»¥å‘ç°ï¼ŒCPU ä½¿ç”¨ç‡æœ€é«˜çš„è¿›ç¨‹ä¹Ÿåªä¸è¿‡æ‰ 2.7%ï¼Œçœ‹èµ·æ¥å¹¶ä¸é«˜ã€‚</p><p>ç„¶è€Œï¼Œå†çœ‹ç³»ç»Ÿ CPU ä½¿ç”¨ç‡ï¼ˆ %Cpu ï¼‰è¿™ä¸€è¡Œï¼Œä½ ä¼šå‘ç°ï¼Œç³»ç»Ÿçš„æ•´ä½“ CPU ä½¿ç”¨ç‡æ˜¯æ¯”è¾ƒé«˜çš„ï¼šç”¨æˆ· CPU ä½¿ç”¨ç‡ï¼ˆusï¼‰å·²ç»åˆ°äº† 80%ï¼Œç³»ç»Ÿ CPU ä¸º 15.1%ï¼Œè€Œç©ºé—² CPU ï¼ˆidï¼‰åˆ™åªæœ‰ 2.8%ã€‚</p><p>ä¸ºä»€ä¹ˆç”¨æˆ· CPU ä½¿ç”¨ç‡è¿™ä¹ˆé«˜å‘¢ï¼Ÿæˆ‘ä»¬å†é‡æ–°åˆ†æä¸€ä¸‹è¿›ç¨‹åˆ—è¡¨ï¼Œçœ‹çœ‹æœ‰æ²¡æœ‰å¯ç–‘è¿›ç¨‹ï¼š</p><ul>\n<li>\n<p>docker-containerd è¿›ç¨‹æ˜¯ç”¨æ¥è¿è¡Œå®¹å™¨çš„ï¼Œ2.7% çš„ CPU ä½¿ç”¨ç‡çœ‹èµ·æ¥æ­£å¸¸ï¼›</p>\n</li>\n<li>\n<p>Nginx å’Œ php-fpm æ˜¯è¿è¡Œ Web æœåŠ¡çš„ï¼Œå®ƒä»¬ä¼šå ç”¨ä¸€äº› CPU ä¹Ÿä¸æ„å¤–ï¼Œå¹¶ä¸” 2% çš„ CPU ä½¿ç”¨ç‡ä¹Ÿä¸ç®—é«˜ï¼›</p>\n</li>\n<li>\n<p>å†å¾€ä¸‹çœ‹ï¼Œåé¢çš„è¿›ç¨‹å‘¢ï¼Œåªæœ‰ 0.3% çš„ CPU ä½¿ç”¨ç‡ï¼Œçœ‹èµ·æ¥ä¸å¤ªåƒä¼šå¯¼è‡´ç”¨æˆ· CPU ä½¿ç”¨ç‡è¾¾åˆ° 80%ã€‚</p>\n</li>\n</ul><p>é‚£å°±å¥‡æ€ªäº†ï¼Œæ˜æ˜ç”¨æˆ· CPU ä½¿ç”¨ç‡éƒ½80%äº†ï¼Œå¯æˆ‘ä»¬æŒ¨ä¸ªåˆ†æäº†ä¸€éè¿›ç¨‹åˆ—è¡¨ï¼Œè¿˜æ˜¯æ‰¾ä¸åˆ°é«˜ CPU ä½¿ç”¨ç‡çš„è¿›ç¨‹ã€‚çœ‹æ¥topæ˜¯ä¸ç®¡ç”¨äº†ï¼Œé‚£è¿˜æœ‰å…¶ä»–å·¥å…·å¯ä»¥æŸ¥çœ‹è¿›ç¨‹ CPU ä½¿ç”¨æƒ…å†µå—ï¼Ÿä¸çŸ¥é“ä½ è®°ä¸è®°å¾—æˆ‘ä»¬çš„è€æœ‹å‹  pidstatï¼Œå®ƒå¯ä»¥ç”¨æ¥åˆ†æè¿›ç¨‹çš„ CPU ä½¿ç”¨æƒ…å†µã€‚</p><p>æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬è¿˜æ˜¯åœ¨ç¬¬ä¸€ä¸ªç»ˆç«¯ï¼Œè¿è¡Œ pidstat å‘½ä»¤ï¼š</p><pre><code># é—´éš”1ç§’è¾“å‡ºä¸€ç»„æ•°æ®ï¼ˆæŒ‰Ctrl+Cç»“æŸï¼‰\n$ pidstat 1\n...\n04:36:24      UID       PID    %usr %system  %guest   %wait    %CPU   CPU  Command\n04:36:25        0      6882    1.00    3.00    0.00    0.00    4.00     0  docker-containe\n04:36:25      101      6947    1.00    2.00    0.00    1.00    3.00     1  nginx\n04:36:25        1     14834    1.00    1.00    0.00    1.00    2.00     0  php-fpm\n04:36:25        1     14835    1.00    1.00    0.00    1.00    2.00     0  php-fpm\n04:36:25        1     14845    0.00    2.00    0.00    2.00    2.00     1  php-fpm\n04:36:25        1     14855    0.00    1.00    0.00    1.00    1.00     1  php-fpm\n04:36:25        1     14857    1.00    2.00    0.00    1.00    3.00     0  php-fpm\n04:36:25        0     15006    0.00    1.00    0.00    0.00    1.00     0  dockerd\n04:36:25        0     15801    0.00    1.00    0.00    0.00    1.00     1  pidstat\n04:36:25        1     17084    1.00    0.00    0.00    2.00    1.00     0  stress\n04:36:25        0     31116    0.00    1.00    0.00    0.00    1.00     0  atopacctd\n...\n</code></pre><p>è§‚å¯Ÿä¸€ä¼šå„¿ï¼Œä½ æ˜¯ä¸æ˜¯å‘ç°ï¼Œæ‰€æœ‰è¿›ç¨‹çš„ CPU ä½¿ç”¨ç‡ä¹Ÿéƒ½ä¸é«˜å•Šï¼Œæœ€é«˜çš„ Docker å’Œ Nginx ä¹Ÿåªæœ‰ 4% å’Œ 3%ï¼Œå³ä½¿æ‰€æœ‰è¿›ç¨‹çš„ CPU ä½¿ç”¨ç‡éƒ½åŠ èµ·æ¥ï¼Œä¹Ÿä¸è¿‡æ˜¯ 21%ï¼Œç¦» 80% è¿˜å·®å¾—è¿œå‘¢ï¼</p><p>æœ€æ—©çš„æ—¶å€™ï¼Œæˆ‘ç¢°åˆ°è¿™ç§é—®é¢˜å°±å®Œå…¨æ‡µäº†ï¼šæ˜æ˜ç”¨æˆ· CPU ä½¿ç”¨ç‡å·²ç»é«˜è¾¾ 80%ï¼Œä½†æˆ‘å´æ€ä¹ˆéƒ½æ‰¾ä¸åˆ°æ˜¯å“ªä¸ªè¿›ç¨‹çš„é—®é¢˜ã€‚åˆ°è¿™é‡Œï¼Œä½ ä¹Ÿå¯ä»¥æƒ³æƒ³ï¼Œä½ æ˜¯ä¸æ˜¯ä¹Ÿé‡åˆ°è¿‡è¿™ç§æƒ…å†µï¼Ÿè¿˜èƒ½ä¸èƒ½å†åšè¿›ä¸€æ­¥çš„åˆ†æå‘¢ï¼Ÿ</p><p>åæ¥æˆ‘å‘ç°ï¼Œä¼šå‡ºç°è¿™ç§æƒ…å†µï¼Œå¾ˆå¯èƒ½æ˜¯å› ä¸ºå‰é¢çš„åˆ†ææ¼äº†ä¸€äº›å…³é”®ä¿¡æ¯ã€‚ä½ å¯ä»¥å…ˆæš‚åœä¸€ä¸‹ï¼Œè‡ªå·±å¾€ä¸Šç¿»ï¼Œé‡æ–°æ“ä½œæ£€æŸ¥ä¸€éã€‚æˆ–è€…ï¼Œæˆ‘ä»¬ä¸€èµ·è¿”å›å»åˆ†æ top çš„è¾“å‡ºï¼Œçœ‹çœ‹èƒ½ä¸èƒ½æœ‰æ–°å‘ç°ã€‚</p><p>ç°åœ¨ï¼Œæˆ‘ä»¬å›åˆ°ç¬¬ä¸€ä¸ªç»ˆç«¯ï¼Œé‡æ–°è¿è¡Œ top å‘½ä»¤ï¼Œå¹¶è§‚å¯Ÿä¸€ä¼šå„¿ï¼š</p><pre><code>$ top\ntop - 04:58:24 up 14 days, 15:47,  1 user,  load average: 3.39, 3.82, 2.74\nTasks: 149 total,   6 running,  93 sleeping,   0 stopped,   0 zombie\n%Cpu(s): 77.7 us, 19.3 sy,  0.0 ni,  2.0 id,  0.0 wa,  0.0 hi,  1.0 si,  0.0 st\nKiB Mem :  8169348 total,  2543916 free,   457976 used,  5167456 buff/cache\nKiB Swap:        0 total,        0 free,        0 used.  7363908 avail Mem\n\n  PID USER      PR  NI    VIRT    RES    SHR S  %CPU %MEM     TIME+ COMMAND\n 6947 systemd+  20   0   33104   3764   2340 S   4.0  0.0   0:32.69 nginx\n 6882 root      20   0   12108   8360   3884 S   2.0  0.1   0:31.40 docker-containe\n15465 daemon    20   0  336696  15256   7576 S   2.0  0.2   0:00.62 php-fpm\n15466 daemon    20   0  336696  15196   7516 S   2.0  0.2   0:00.62 php-fpm\n15489 daemon    20   0  336696  16200   8520 S   2.0  0.2   0:00.62 php-fpm\n 6948 systemd+  20   0   33104   3764   2340 S   1.0  0.0   0:00.95 nginx\n15006 root      20   0 1168608  65632  37536 S   1.0  0.8   9:51.09 dockerd\n15476 daemon    20   0  336696  16200   8520 S   1.0  0.2   0:00.61 php-fpm\n15477 daemon    20   0  336696  16200   8520 S   1.0  0.2   0:00.61 php-fpm\n24340 daemon    20   0    8184   1616    536 R   1.0  0.0   0:00.01 stress\n24342 daemon    20   0    8196   1580    492 R   1.0  0.0   0:00.01 stress\n24344 daemon    20   0    8188   1056    492 R   1.0  0.0   0:00.01 stress\n24347 daemon    20   0    8184   1356    540 R   1.0  0.0   0:00.01 stress\n...\n</code></pre><p>è¿™æ¬¡ä»å¤´å¼€å§‹çœ‹ top çš„æ¯è¡Œè¾“å‡ºï¼Œå’¦ï¼ŸTasks è¿™ä¸€è¡Œçœ‹èµ·æ¥æœ‰ç‚¹å¥‡æ€ªï¼Œå°±ç»ªé˜Ÿåˆ—ä¸­å±…ç„¶æœ‰ 6 ä¸ª Running çŠ¶æ€çš„è¿›ç¨‹ï¼ˆ6 runningï¼‰ï¼Œæ˜¯ä¸æ˜¯æœ‰ç‚¹å¤šå‘¢ï¼Ÿ</p><p>å›æƒ³ä¸€ä¸‹ ab æµ‹è¯•çš„å‚æ•°ï¼Œå¹¶å‘è¯·æ±‚æ•°æ˜¯ 5ã€‚å†çœ‹è¿›ç¨‹åˆ—è¡¨é‡Œï¼Œ php-fpm çš„æ•°é‡ä¹Ÿæ˜¯ 5ï¼Œå†åŠ ä¸Š Nginxï¼Œå¥½åƒåŒæ—¶æœ‰ 6 ä¸ªè¿›ç¨‹ä¹Ÿå¹¶ä¸å¥‡æ€ªã€‚ä½†çœŸçš„æ˜¯è¿™æ ·å—ï¼Ÿ</p><p>å†ä»”ç»†çœ‹è¿›ç¨‹åˆ—è¡¨ï¼Œè¿™æ¬¡ä¸»è¦çœ‹ Runningï¼ˆRï¼‰ çŠ¶æ€çš„è¿›ç¨‹ã€‚ä½ æœ‰æ²¡æœ‰å‘ç°ï¼Œ Nginx å’Œæ‰€æœ‰çš„ php-fpm éƒ½å¤„äºSleepï¼ˆSï¼‰çŠ¶æ€ï¼Œè€ŒçœŸæ­£å¤„äº Runningï¼ˆRï¼‰çŠ¶æ€çš„ï¼Œå´æ˜¯å‡ ä¸ª stress è¿›ç¨‹ã€‚è¿™å‡ ä¸ª stress è¿›ç¨‹å°±æ¯”è¾ƒå¥‡æ€ªäº†ï¼Œéœ€è¦æˆ‘ä»¬åšè¿›ä¸€æ­¥çš„åˆ†æã€‚</p><p>æˆ‘ä»¬è¿˜æ˜¯ä½¿ç”¨ pidstat æ¥åˆ†æè¿™å‡ ä¸ªè¿›ç¨‹ï¼Œå¹¶ä¸”ä½¿ç”¨ -p é€‰é¡¹æŒ‡å®šè¿›ç¨‹çš„ PIDã€‚é¦–å…ˆï¼Œä»ä¸Šé¢ top çš„ç»“æœä¸­ï¼Œæ‰¾åˆ°è¿™å‡ ä¸ªè¿›ç¨‹çš„ PIDã€‚æ¯”å¦‚ï¼Œå…ˆéšä¾¿æ‰¾ä¸€ä¸ª 24344ï¼Œç„¶åç”¨ pidstat å‘½ä»¤çœ‹ä¸€ä¸‹å®ƒçš„ CPU ä½¿ç”¨æƒ…å†µï¼š</p><pre><code>$ pidstat -p 24344\n\n16:14:55      UID       PID    %usr %system  %guest   %wait    %CPU   CPU  Command\n</code></pre><p>å¥‡æ€ªï¼Œå±…ç„¶æ²¡æœ‰ä»»ä½•è¾“å‡ºã€‚éš¾é“æ˜¯pidstat å‘½ä»¤å‡ºé—®é¢˜äº†å—ï¼Ÿä¹‹å‰æˆ‘è¯´è¿‡ï¼Œ<strong>åœ¨æ€€ç–‘æ€§èƒ½å·¥å…·å‡ºé—®é¢˜å‰ï¼Œæœ€å¥½è¿˜æ˜¯å…ˆç”¨å…¶ä»–å·¥å…·äº¤å‰ç¡®è®¤ä¸€ä¸‹</strong>ã€‚é‚£ç”¨ä»€ä¹ˆå·¥å…·å‘¢ï¼Ÿ ps åº”è¯¥æ˜¯æœ€ç®€å•æ˜“ç”¨çš„ã€‚æˆ‘ä»¬åœ¨ç»ˆç«¯é‡Œè¿è¡Œä¸‹é¢çš„å‘½ä»¤ï¼Œçœ‹çœ‹ 24344 è¿›ç¨‹çš„çŠ¶æ€ï¼š</p><pre><code># ä»æ‰€æœ‰è¿›ç¨‹ä¸­æŸ¥æ‰¾PIDæ˜¯24344çš„è¿›ç¨‹\n$ ps aux | grep 24344\nroot      9628  0.0  0.0  14856  1096 pts/0    S+   16:15   0:00 grep --color=auto 24344\n</code></pre><p>è¿˜æ˜¯æ²¡æœ‰è¾“å‡ºã€‚ç°åœ¨ç»ˆäºå‘ç°é—®é¢˜ï¼ŒåŸæ¥è¿™ä¸ªè¿›ç¨‹å·²ç»ä¸å­˜åœ¨äº†ï¼Œæ‰€ä»¥ pidstat å°±æ²¡æœ‰ä»»ä½•è¾“å‡ºã€‚æ—¢ç„¶è¿›ç¨‹éƒ½æ²¡äº†ï¼Œé‚£æ€§èƒ½é—®é¢˜åº”è¯¥ä¹Ÿè·Ÿç€æ²¡äº†å§ã€‚æˆ‘ä»¬å†ç”¨ top å‘½ä»¤ç¡®è®¤ä¸€ä¸‹ï¼š</p><pre><code>$ top\n...\n%Cpu(s): 80.9 us, 14.9 sy,  0.0 ni,  2.8 id,  0.0 wa,  0.0 hi,  1.3 si,  0.0 st\n...\n\n  PID USER      PR  NI    VIRT    RES    SHR S  %CPU %MEM     TIME+ COMMAND\n 6882 root      20   0   12108   8360   3884 S   2.7  0.1   0:45.63 docker-containe\n 6947 systemd+  20   0   33104   3764   2340 R   2.7  0.0   0:47.79 nginx\n 3865 daemon    20   0  336696  15056   7376 S   2.0  0.2   0:00.15 php-fpm\n  6779 daemon    20   0    8184   1112    556 R   0.3  0.0   0:00.01 stress\n...\n</code></pre><p>å¥½åƒåˆé”™äº†ã€‚ç»“æœè¿˜è·ŸåŸæ¥ä¸€æ ·ï¼Œç”¨æˆ· CPU ä½¿ç”¨ç‡è¿˜æ˜¯é«˜è¾¾ 80.9%ï¼Œç³»ç»Ÿ CPU æ¥è¿‘ 15%ï¼Œè€Œç©ºé—² CPU åªæœ‰ 2.8%ï¼ŒRunning çŠ¶æ€çš„è¿›ç¨‹æœ‰ Nginxã€stressç­‰ã€‚</p><p>å¯æ˜¯ï¼Œåˆšåˆšæˆ‘ä»¬çœ‹åˆ°stress è¿›ç¨‹ä¸å­˜åœ¨äº†ï¼Œæ€ä¹ˆç°åœ¨è¿˜åœ¨è¿è¡Œå‘¢ï¼Ÿå†ç»†çœ‹ä¸€ä¸‹ top çš„è¾“å‡ºï¼ŒåŸæ¥ï¼Œè¿™æ¬¡ stress è¿›ç¨‹çš„ PID è·Ÿå‰é¢ä¸ä¸€æ ·äº†ï¼ŒåŸæ¥çš„ PID 24344 ä¸è§äº†ï¼Œç°åœ¨çš„æ˜¯ 6779ã€‚</p><p>è¿›ç¨‹çš„ PID åœ¨å˜ï¼Œè¿™è¯´æ˜ä»€ä¹ˆå‘¢ï¼Ÿåœ¨æˆ‘çœ‹æ¥ï¼Œè¦ä¹ˆæ˜¯è¿™äº›è¿›ç¨‹åœ¨ä¸åœåœ°é‡å¯ï¼Œè¦ä¹ˆå°±æ˜¯å…¨æ–°çš„è¿›ç¨‹ï¼Œè¿™æ— éä¹Ÿå°±ä¸¤ä¸ªåŸå› ï¼š</p><ul>\n<li>\n<p>ç¬¬ä¸€ä¸ªåŸå› ï¼Œè¿›ç¨‹åœ¨ä¸åœåœ°å´©æºƒé‡å¯ï¼Œæ¯”å¦‚å› ä¸ºæ®µé”™è¯¯ã€é…ç½®é”™è¯¯ç­‰ç­‰ï¼Œè¿™æ—¶ï¼Œè¿›ç¨‹åœ¨é€€å‡ºåå¯èƒ½åˆè¢«ç›‘æ§ç³»ç»Ÿè‡ªåŠ¨é‡å¯äº†ã€‚</p>\n</li>\n<li>\n<p>ç¬¬äºŒä¸ªåŸå› ï¼Œè¿™äº›è¿›ç¨‹éƒ½æ˜¯çŸ­æ—¶è¿›ç¨‹ï¼Œä¹Ÿå°±æ˜¯åœ¨å…¶ä»–åº”ç”¨å†…éƒ¨é€šè¿‡ exec è°ƒç”¨çš„å¤–é¢å‘½ä»¤ã€‚è¿™äº›å‘½ä»¤ä¸€èˆ¬éƒ½åªè¿è¡Œå¾ˆçŸ­çš„æ—¶é—´å°±ä¼šç»“æŸï¼Œä½ å¾ˆéš¾ç”¨ top è¿™ç§é—´éš”æ—¶é—´æ¯”è¾ƒé•¿çš„å·¥å…·å‘ç°ï¼ˆä¸Šé¢çš„æ¡ˆä¾‹ï¼Œæˆ‘ä»¬ç¢°å·§å‘ç°äº†ï¼‰ã€‚</p>\n</li>\n</ul><p>è‡³äº stressï¼Œæˆ‘ä»¬å‰é¢æåˆ°è¿‡ï¼Œå®ƒæ˜¯ä¸€ä¸ªå¸¸ç”¨çš„å‹åŠ›æµ‹è¯•å·¥å…·ã€‚å®ƒçš„ PID åœ¨ä¸æ–­å˜åŒ–ä¸­ï¼Œçœ‹èµ·æ¥åƒæ˜¯è¢«å…¶ä»–è¿›ç¨‹è°ƒç”¨çš„çŸ­æ—¶è¿›ç¨‹ã€‚è¦æƒ³ç»§ç»­åˆ†æä¸‹å»ï¼Œè¿˜å¾—æ‰¾åˆ°å®ƒä»¬çš„çˆ¶è¿›ç¨‹ã€‚</p><p>è¦æ€ä¹ˆæŸ¥æ‰¾ä¸€ä¸ªè¿›ç¨‹çš„çˆ¶è¿›ç¨‹å‘¢ï¼Ÿæ²¡é”™ï¼Œç”¨ pstree  å°±å¯ä»¥ç”¨æ ‘çŠ¶å½¢å¼æ˜¾ç¤ºæ‰€æœ‰è¿›ç¨‹ä¹‹é—´çš„å…³ç³»ï¼š</p><pre><code>$ pstree | grep stress\n        |-docker-containe-+-php-fpm-+-php-fpm---sh---stress\n        |         |-3*[php-fpm---sh---stress---stress]\n</code></pre><p>ä»è¿™é‡Œå¯ä»¥çœ‹åˆ°ï¼Œstress æ˜¯è¢« php-fpm è°ƒç”¨çš„å­è¿›ç¨‹ï¼Œå¹¶ä¸”è¿›ç¨‹æ•°é‡ä¸æ­¢ä¸€ä¸ªï¼ˆè¿™é‡Œæ˜¯3ä¸ªï¼‰ã€‚æ‰¾åˆ°çˆ¶è¿›ç¨‹åï¼Œæˆ‘ä»¬èƒ½è¿›å…¥ app çš„å†…éƒ¨åˆ†æäº†ã€‚</p><p>é¦–å…ˆï¼Œå½“ç„¶åº”è¯¥å»çœ‹çœ‹å®ƒçš„æºç ã€‚è¿è¡Œä¸‹é¢çš„å‘½ä»¤ï¼ŒæŠŠæ¡ˆä¾‹åº”ç”¨çš„æºç æ‹·è´åˆ° app ç›®å½•ï¼Œç„¶åå†æ‰§è¡Œ grep æŸ¥æ‰¾æ˜¯ä¸æ˜¯æœ‰ä»£ç å†è°ƒç”¨ stress å‘½ä»¤ï¼š</p><pre><code># æ‹·è´æºç åˆ°æœ¬åœ°\n$ docker cp phpfpm:/app .\n\n# grep æŸ¥æ‰¾çœ‹çœ‹æ˜¯ä¸æ˜¯æœ‰ä»£ç åœ¨è°ƒç”¨stresså‘½ä»¤\n$ grep stress -r app\napp/index.php:// fake I/O with stress (via write()/unlink()).\napp/index.php:$result = exec(&quot;/usr/local/bin/stress -t 1 -d 1 2&gt;&amp;1&quot;, $output, $status);\n</code></pre><p>æ‰¾åˆ°äº†ï¼Œæœç„¶æ˜¯ app/index.php æ–‡ä»¶ä¸­ç›´æ¥è°ƒç”¨äº† stress å‘½ä»¤ã€‚</p><p>å†æ¥çœ‹çœ‹<a href=\"https://github.com/feiskyer/linux-perf-examples/blob/master/nginx-short-process/app/index.php\"> app/index.php </a>çš„æºä»£ç ï¼š</p><pre><code>$ cat app/index.php\n&lt;?php\n// fake I/O with stress (via write()/unlink()).\n$result = exec(&quot;/usr/local/bin/stress -t 1 -d 1 2&gt;&amp;1&quot;, $output, $status);\nif (isset($_GET[&quot;verbose&quot;]) &amp;&amp; $_GET[&quot;verbose&quot;]==1 &amp;&amp; $status != 0) {\n  echo &quot;Server internal error: &quot;;\n  print_r($output);\n} else {\n  echo &quot;It works!&quot;;\n}\n?&gt;\n</code></pre><p>å¯ä»¥çœ‹åˆ°ï¼Œæºç é‡Œå¯¹æ¯ä¸ªè¯·æ±‚éƒ½ä¼šè°ƒç”¨ä¸€ä¸ª stress å‘½ä»¤ï¼Œæ¨¡æ‹Ÿ I/O å‹åŠ›ã€‚ä»æ³¨é‡Šä¸Šçœ‹ï¼Œstress ä¼šé€šè¿‡ write() å’Œ unlink() å¯¹ I/O è¿›ç¨‹è¿›è¡Œå‹æµ‹ï¼Œçœ‹æ¥ï¼Œè¿™åº”è¯¥å°±æ˜¯ç³»ç»Ÿ CPU ä½¿ç”¨ç‡å‡é«˜çš„æ ¹æºäº†ã€‚</p><p>ä¸è¿‡ï¼Œstress æ¨¡æ‹Ÿçš„æ˜¯ I/O å‹åŠ›ï¼Œè€Œä¹‹å‰åœ¨ top çš„è¾“å‡ºä¸­çœ‹åˆ°çš„ï¼Œå´ä¸€ç›´æ˜¯ç”¨æˆ· CPU å’Œç³»ç»Ÿ CPU å‡é«˜ï¼Œå¹¶æ²¡è§åˆ° iowait å‡é«˜ã€‚è¿™åˆæ˜¯æ€ä¹ˆå›äº‹å‘¢ï¼Ÿstress åˆ°åº•æ˜¯ä¸æ˜¯ CPU ä½¿ç”¨ç‡å‡é«˜çš„åŸå› å‘¢ï¼Ÿ</p><p>æˆ‘ä»¬è¿˜å¾—ç»§ç»­å¾€ä¸‹èµ°ã€‚ä»ä»£ç ä¸­å¯ä»¥çœ‹åˆ°ï¼Œç»™è¯·æ±‚åŠ å…¥ verbose=1 å‚æ•°åï¼Œå°±å¯ä»¥æŸ¥çœ‹ stress çš„è¾“å‡ºã€‚ä½ å…ˆè¯•è¯•çœ‹ï¼Œåœ¨ç¬¬äºŒä¸ªç»ˆç«¯è¿è¡Œï¼š</p><pre><code>$ curl http://192.168.0.10:10000?verbose=1\nServer internal error: Array\n(\n    [0] =&gt; stress: info: [19607] dispatching hogs: 0 cpu, 0 io, 0 vm, 1 hdd\n    [1] =&gt; stress: FAIL: [19608] (563) mkstemp failed: Permission denied\n    [2] =&gt; stress: FAIL: [19607] (394) &lt;-- worker 19608 returned error 1\n    [3] =&gt; stress: WARN: [19607] (396) now reaping child worker processes\n    [4] =&gt; stress: FAIL: [19607] (400) kill error: No such process\n    [5] =&gt; stress: FAIL: [19607] (451) failed run completed in 0s\n)\n</code></pre><p>çœ‹é”™è¯¯æ¶ˆæ¯ <span class=\"orange\">mkstemp failed: Permission denied </span>ï¼Œä»¥åŠ <span class=\"orange\">failed run completed in 0s</span>ã€‚åŸæ¥ stress å‘½ä»¤å¹¶æ²¡æœ‰æˆåŠŸï¼Œå®ƒå› ä¸ºæƒé™é—®é¢˜å¤±è´¥é€€å‡ºäº†ã€‚çœ‹æ¥ï¼Œæˆ‘ä»¬å‘ç°äº†ä¸€ä¸ª PHP è°ƒç”¨å¤–éƒ¨ stress å‘½ä»¤çš„ bugï¼šæ²¡æœ‰æƒé™åˆ›å»ºä¸´æ—¶æ–‡ä»¶ã€‚</p><p>ä»è¿™é‡Œæˆ‘ä»¬å¯ä»¥çŒœæµ‹ï¼Œæ­£æ˜¯ç”±äºæƒé™é”™è¯¯ï¼Œå¤§é‡çš„ stress è¿›ç¨‹åœ¨å¯åŠ¨æ—¶åˆå§‹åŒ–å¤±è´¥ï¼Œè¿›è€Œå¯¼è‡´ç”¨æˆ· CPU ä½¿ç”¨ç‡çš„å‡é«˜ã€‚</p><p>åˆ†æå‡ºé—®é¢˜æ¥æºï¼Œä¸‹ä¸€æ­¥æ˜¯ä¸æ˜¯å°±è¦å¼€å§‹ä¼˜åŒ–äº†å‘¢ï¼Ÿå½“ç„¶ä¸æ˜¯ï¼æ—¢ç„¶åªæ˜¯çŒœæµ‹ï¼Œé‚£å°±éœ€è¦å†ç¡®è®¤ä¸€ä¸‹ï¼Œè¿™ä¸ªçŒœæµ‹åˆ°åº•å¯¹ä¸å¯¹ï¼Œæ˜¯ä¸æ˜¯çœŸçš„æœ‰å¤§é‡çš„ stress è¿›ç¨‹ã€‚è¯¥ç”¨ä»€ä¹ˆå·¥å…·æˆ–æŒ‡æ ‡å‘¢ï¼Ÿ</p><p>æˆ‘ä»¬å‰é¢å·²ç»ç”¨äº† topã€pidstatã€pstree ç­‰å·¥å…·ï¼Œæ²¡æœ‰å‘ç°å¤§é‡çš„ stress è¿›ç¨‹ã€‚é‚£ä¹ˆï¼Œè¿˜æœ‰ä»€ä¹ˆå…¶ä»–çš„å·¥å…·å¯ä»¥ç”¨å—ï¼Ÿ</p><p>è¿˜è®°å¾—ä¸Šä¸€æœŸæåˆ°çš„ perf å—ï¼Ÿå®ƒå¯ä»¥ç”¨æ¥åˆ†æ CPU æ€§èƒ½äº‹ä»¶ï¼Œç”¨åœ¨è¿™é‡Œå°±å¾ˆåˆé€‚ã€‚ä¾æ—§åœ¨ç¬¬ä¸€ä¸ªç»ˆç«¯ä¸­è¿è¡Œ perf record -g å‘½ä»¤ ï¼Œå¹¶ç­‰å¾…ä¸€ä¼šå„¿ï¼ˆæ¯”å¦‚15ç§’ï¼‰åæŒ‰ Ctrl+C é€€å‡ºã€‚ç„¶åå†è¿è¡Œ perf report æŸ¥çœ‹æŠ¥å‘Šï¼š</p><pre><code># è®°å½•æ€§èƒ½äº‹ä»¶ï¼Œç­‰å¾…å¤§çº¦15ç§’åæŒ‰ Ctrl+C é€€å‡º\n$ perf record -g\n\n# æŸ¥çœ‹æŠ¥å‘Š\n$ perf report\n</code></pre><p>è¿™æ ·ï¼Œä½ å°±å¯ä»¥çœ‹åˆ°ä¸‹å›¾è¿™ä¸ªæ€§èƒ½æŠ¥å‘Šï¼š</p><p><img src=\"https://static001.geekbang.org/resource/image/c9/33/c99445b401301147fa41cb2b5739e833.png?wh=720*527\" alt=\"\"></p><p>ä½ çœ‹ï¼Œstress å äº†æ‰€æœ‰CPUæ—¶é’Ÿäº‹ä»¶çš„ 77%ï¼Œè€Œ stress  è°ƒç”¨è°ƒç”¨æ ˆä¸­æ¯”ä¾‹æœ€é«˜çš„ï¼Œæ˜¯éšæœºæ•°ç”Ÿæˆå‡½æ•° random()ï¼Œçœ‹æ¥å®ƒçš„ç¡®å°±æ˜¯ CPU ä½¿ç”¨ç‡å‡é«˜çš„å…ƒå‡¶äº†ã€‚éšåçš„ä¼˜åŒ–å°±å¾ˆç®€å•äº†ï¼Œåªè¦ä¿®å¤æƒé™é—®é¢˜ï¼Œå¹¶å‡å°‘æˆ–åˆ é™¤ stress çš„è°ƒç”¨ï¼Œå°±å¯ä»¥å‡è½»ç³»ç»Ÿçš„ CPU å‹åŠ›ã€‚</p><p>å½“ç„¶ï¼Œå®é™…ç”Ÿäº§ç¯å¢ƒä¸­çš„é—®é¢˜ä¸€èˆ¬éƒ½è¦æ¯”è¿™ä¸ªæ¡ˆä¾‹å¤æ‚ï¼Œåœ¨ä½ æ‰¾åˆ°è§¦å‘ç“¶é¢ˆçš„å‘½ä»¤è¡Œåï¼Œå´å¯èƒ½å‘ç°ï¼Œè¿™ä¸ªå¤–éƒ¨å‘½ä»¤çš„è°ƒç”¨è¿‡ç¨‹æ˜¯åº”ç”¨æ ¸å¿ƒé€»è¾‘çš„ä¸€éƒ¨åˆ†ï¼Œå¹¶ä¸èƒ½è½»æ˜“å‡å°‘æˆ–è€…åˆ é™¤ã€‚</p><p>è¿™æ—¶ï¼Œä½ å°±å¾—ç»§ç»­æ’æŸ¥ï¼Œä¸ºä»€ä¹ˆè¢«è°ƒç”¨çš„å‘½ä»¤ï¼Œä¼šå¯¼è‡´ CPU ä½¿ç”¨ç‡å‡é«˜æˆ– I/O å‡é«˜ç­‰é—®é¢˜ã€‚è¿™äº›å¤æ‚åœºæ™¯çš„æ¡ˆä¾‹ï¼Œæˆ‘ä¼šåœ¨åé¢çš„ç»¼åˆå®æˆ˜é‡Œè¯¦ç»†åˆ†æã€‚</p><p>æœ€åï¼Œåœ¨æ¡ˆä¾‹ç»“æŸæ—¶ï¼Œä¸è¦å¿˜äº†æ¸…ç†ç¯å¢ƒï¼Œæ‰§è¡Œä¸‹é¢çš„ Docker å‘½ä»¤ï¼Œåœæ­¢æ¡ˆä¾‹ä¸­ç”¨åˆ°çš„ Nginx è¿›ç¨‹ï¼š</p><pre><code>$ docker rm -f nginx phpfpm\n</code></pre><h2>execsnoop</h2><p>åœ¨è¿™ä¸ªæ¡ˆä¾‹ä¸­ï¼Œæˆ‘ä»¬ä½¿ç”¨äº† topã€pidstatã€pstree ç­‰å·¥å…·åˆ†æäº†ç³»ç»Ÿ CPU ä½¿ç”¨ç‡é«˜çš„é—®é¢˜ï¼Œå¹¶å‘ç° CPU å‡é«˜æ˜¯çŸ­æ—¶è¿›ç¨‹ stress å¯¼è‡´çš„ï¼Œä½†æ˜¯æ•´ä¸ªåˆ†æè¿‡ç¨‹è¿˜æ˜¯æ¯”è¾ƒå¤æ‚çš„ã€‚å¯¹äºè¿™ç±»é—®é¢˜ï¼Œæœ‰æ²¡æœ‰æ›´å¥½çš„æ–¹æ³•ç›‘æ§å‘¢ï¼Ÿ</p><p><a href=\"https://github.com/brendangregg/perf-tools/blob/master/execsnoop\">execsnoop</a> å°±æ˜¯ä¸€ä¸ªä¸“ä¸ºçŸ­æ—¶è¿›ç¨‹è®¾è®¡çš„å·¥å…·ã€‚å®ƒé€šè¿‡ ftrace å®æ—¶ç›‘æ§è¿›ç¨‹çš„ exec() è¡Œä¸ºï¼Œå¹¶è¾“å‡ºçŸ­æ—¶è¿›ç¨‹çš„åŸºæœ¬ä¿¡æ¯ï¼ŒåŒ…æ‹¬è¿›ç¨‹ PIDã€çˆ¶è¿›ç¨‹ PIDã€å‘½ä»¤è¡Œå‚æ•°ä»¥åŠæ‰§è¡Œçš„ç»“æœã€‚</p><p>æ¯”å¦‚ï¼Œç”¨ execsnoop ç›‘æ§ä¸Šè¿°æ¡ˆä¾‹ï¼Œå°±å¯ä»¥ç›´æ¥å¾—åˆ° stress è¿›ç¨‹çš„çˆ¶è¿›ç¨‹ PID ä»¥åŠå®ƒçš„å‘½ä»¤è¡Œå‚æ•°ï¼Œå¹¶å¯ä»¥å‘ç°å¤§é‡çš„ stress è¿›ç¨‹åœ¨ä¸åœå¯åŠ¨ï¼š</p><pre><code># æŒ‰ Ctrl+C ç»“æŸ\n$ execsnoop\nPCOMM            PID    PPID   RET ARGS\nsh               30394  30393    0\nstress           30396  30394    0 /usr/local/bin/stress -t 1 -d 1\nsh               30398  30393    0\nstress           30399  30398    0 /usr/local/bin/stress -t 1 -d 1\nsh               30402  30400    0\nstress           30403  30402    0 /usr/local/bin/stress -t 1 -d 1\nsh               30405  30393    0\nstress           30407  30405    0 /usr/local/bin/stress -t 1 -d 1\n...\n</code></pre><p>execsnoop æ‰€ç”¨çš„ ftrace æ˜¯ä¸€ç§å¸¸ç”¨çš„åŠ¨æ€è¿½è¸ªæŠ€æœ¯ï¼Œä¸€èˆ¬ç”¨äºåˆ†æ Linux å†…æ ¸çš„è¿è¡Œæ—¶è¡Œä¸ºï¼Œåé¢è¯¾ç¨‹æˆ‘ä¹Ÿä¼šè¯¦ç»†ä»‹ç»å¹¶å¸¦ä½ ä½¿ç”¨ã€‚</p><h2>å°ç»“</h2><p>ç¢°åˆ°å¸¸è§„é—®é¢˜æ— æ³•è§£é‡Šçš„ CPU ä½¿ç”¨ç‡æƒ…å†µæ—¶ï¼Œé¦–å…ˆè¦æƒ³åˆ°æœ‰å¯èƒ½æ˜¯çŸ­æ—¶åº”ç”¨å¯¼è‡´çš„é—®é¢˜ï¼Œæ¯”å¦‚æœ‰å¯èƒ½æ˜¯ä¸‹é¢è¿™ä¸¤ç§æƒ…å†µã€‚</p><ul>\n<li>\n<p>ç¬¬ä¸€ï¼Œ<strong>åº”ç”¨é‡Œç›´æ¥è°ƒç”¨äº†å…¶ä»–äºŒè¿›åˆ¶ç¨‹åºï¼Œè¿™äº›ç¨‹åºé€šå¸¸è¿è¡Œæ—¶é—´æ¯”è¾ƒçŸ­ï¼Œé€šè¿‡ top ç­‰å·¥å…·ä¹Ÿä¸å®¹æ˜“å‘ç°</strong>ã€‚</p>\n</li>\n<li>\n<p>ç¬¬äºŒï¼Œ<strong>åº”ç”¨æœ¬èº«åœ¨ä¸åœåœ°å´©æºƒé‡å¯ï¼Œè€Œå¯åŠ¨è¿‡ç¨‹çš„èµ„æºåˆå§‹åŒ–ï¼Œå¾ˆå¯èƒ½ä¼šå ç”¨ç›¸å½“å¤šçš„ CPU</strong>ã€‚</p>\n</li>\n</ul><p>å¯¹äºè¿™ç±»è¿›ç¨‹ï¼Œæˆ‘ä»¬å¯ä»¥ç”¨ pstree æˆ–è€… execsnoop æ‰¾åˆ°å®ƒä»¬çš„çˆ¶è¿›ç¨‹ï¼Œå†ä»çˆ¶è¿›ç¨‹æ‰€åœ¨çš„åº”ç”¨å…¥æ‰‹ï¼Œæ’æŸ¥é—®é¢˜çš„æ ¹æºã€‚</p><h2>æ€è€ƒ</h2><p>æœ€åï¼Œæˆ‘æƒ³é‚€è¯·ä½ ä¸€èµ·æ¥èŠèŠï¼Œä½ æ‰€ç¢°åˆ°çš„ CPU æ€§èƒ½é—®é¢˜ã€‚æœ‰æ²¡æœ‰å“ªä¸ªå°è±¡æ·±åˆ»çš„ç»å†å¯ä»¥è·Ÿæˆ‘åˆ†äº«å‘¢ï¼Ÿæˆ–è€…ï¼Œåœ¨ä»Šå¤©çš„æ¡ˆä¾‹æ“ä½œä¸­ï¼Œä½ é‡åˆ°äº†ä»€ä¹ˆé—®é¢˜ï¼Œåˆè§£å†³äº†å“ªäº›å‘¢ï¼Ÿä½ å¯ä»¥ç»“åˆæˆ‘çš„è®²è¿°ï¼Œæ€»ç»“è‡ªå·±çš„æ€è·¯ã€‚</p><p>æ¬¢è¿åœ¨ç•™è¨€åŒºå’Œæˆ‘è®¨è®ºï¼Œä¹Ÿæ¬¢è¿æŠŠè¿™ç¯‡æ–‡ç« åˆ†äº«ç»™ä½ çš„åŒäº‹ã€æœ‹å‹ã€‚æˆ‘ä»¬ä¸€èµ·åœ¨å®æˆ˜ä¸­æ¼”ç»ƒï¼Œåœ¨äº¤æµä¸­è¿›æ­¥ã€‚</p><p><img src=\"https://static001.geekbang.org/resource/image/56/52/565d66d658ad23b2f4997551db153852.jpg?wh=1110*549\" alt=\"\"></p>","comments":[{"had_liked":false,"id":45871,"user_name":"sotey","can_delete":false,"product_type":"c1","uid":1221689,"ip_address":"","ucode":"7D3B7E45FC18BA","user_header":"https://static001.geekbang.org/account/avatar/00/12/a4/39/6a5cd1d8.jpg","comment_is_top":false,"comment_ctime":1543807781,"is_pvip":false,"replies":[{"id":"16421","content":"ä¸¾ä¸€åä¸‰åŠ¨æ‰‹å®è·µçš„æ¥·æ¨¡ğŸ˜Š å¸Œæœ›çœ‹åˆ°æ›´å¤šçš„äººæŠŠè¿™äº›æ€è·¯ç”¨èµ·æ¥","user_name":"ä½œè€…å›å¤","user_name_real":"å€ªæœ‹é£","uid":"1001282","ctime":1543831267,"ip_address":"","comment_id":45871,"utype":1}],"discussion_count":2,"race_medal":0,"score":"701623477029","product_id":100020901,"comment_content":"å¯¹è€å¸ˆè†œæ‹œï¼ä»Šå¤©ä¸€æ—©ç”Ÿäº§tomcatå¤¯ä½äº†ï¼Œ16é¢—cpuå…¨éƒ¨98%ä»¥ä¸Šï¼Œä½¿ç”¨è€å¸ˆçš„æ–¹æ³•åŠ ä¸Šjavaçš„å·¥å…·æˆåŠŸå®šä½åˆ°äº†é—®é¢˜çº¿ç¨‹å’Œé—®é¢˜å‡½æ•°ã€‚","like_count":163,"discussions":[{"author":{"id":1001282,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/47/42/5b55bd1a.jpg","nickname":"å€ªæœ‹é£","note":"","ucode":"F0FAC195CDE7AC","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":431247,"discussion_content":"ä¸¾ä¸€åä¸‰åŠ¨æ‰‹å®è·µçš„æ¥·æ¨¡ğŸ˜Š å¸Œæœ›çœ‹åˆ°æ›´å¤šçš„äººæŠŠè¿™äº›æ€è·¯ç”¨èµ·æ¥","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1543831267,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1331828,"avatar":"http://thirdwx.qlogo.cn/mmopen/vi_32/IZKGetBZDuMEa2VwwtesTELvLORIyV749ItgfAqNPv30n4zEv71wuGNr1aNVIVltG0icvH53DHDuqPuzNpiauWAg/132","nickname":"Geek_bb89c3","note":"","ucode":"0F97B5B0F2DDD6","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":349802,"discussion_content":"ç›´æ¥çœ‹é”™è¯¯æ—¥å¿—ï¼Œæ˜¯ä¸æ˜¯èƒ½å¤Ÿæ›´å¿«çš„å®šä½åˆ°ç³»ç»Ÿä¸­çš„é”™è¯¯ä¿¡æ¯ï¼Ÿ","likes_number":3,"is_delete":false,"is_hidden":false,"ctime":1613555782,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":48456,"user_name":"å¥½å¥½å­¦ä¹ ","can_delete":false,"product_type":"c1","uid":1258789,"ip_address":"","ucode":"63A002997462E3","user_header":"https://static001.geekbang.org/account/avatar/00/13/35/25/bab760a1.jpg","comment_is_top":false,"comment_ctime":1544447550,"is_pvip":false,"replies":[{"id":"17467","content":"ğŸ‘","user_name":"ä½œè€…å›å¤","user_name_real":"å€ªæœ‹é£","uid":"1001282","ctime":1544521665,"ip_address":"","comment_id":48456,"utype":1}],"discussion_count":1,"race_medal":0,"score":"285012289086","product_id":100020901,"comment_content":"perf record -ag -- sleep 2;perf report<br>ä¸€éƒ¨åˆ°ä½","like_count":66,"discussions":[{"author":{"id":1001282,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/47/42/5b55bd1a.jpg","nickname":"å€ªæœ‹é£","note":"","ucode":"F0FAC195CDE7AC","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":432187,"discussion_content":"ğŸ‘","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1544521665,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":66315,"user_name":"bruceding","can_delete":false,"product_type":"c1","uid":1024057,"ip_address":"","ucode":"D35A2B05487EAE","user_header":"https://static001.geekbang.org/account/avatar/00/0f/a0/39/ddcf26ac.jpg","comment_is_top":false,"comment_ctime":1549929024,"is_pvip":false,"discussion_count":2,"race_medal":0,"score":"250658032192","product_id":100020901,"comment_content":"sar -w æˆ–è€… sar -w 1  ä¹Ÿèƒ½ç›´è§‚çš„çœ‹åˆ°æ¯ç§’ç”Ÿæˆçº¿ç¨‹æˆ–è€…è¿›ç¨‹çš„æ•°é‡ã€‚Brendan Gregg ç¡®å®æ˜¯è¿™ä¸ªé¢†åŸŸçš„å¤§å¸ˆï¼Œè´¡çŒ®äº†å¾ˆå¤šçš„æŠ€æœ¯ç†å¿µå’Œå®è·µç»éªŒã€‚ä»–çš„ã€Šæ€§èƒ½ä¹‹å·…ã€‹ å¯ä»¥å’Œæœ¬è¯¾å¯¹æ¯”ç€çœ‹ï¼Œä¼šæœ‰æ›´å¤šçš„ç†è§£ã€‚","like_count":58,"discussions":[{"author":{"id":1250922,"avatar":"https://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTIzGGthScz54sECZJKX3lgyjCATkgrvSt5N3eOsYB34jibCr3SkAX88QaZ5IVmME9Ec7VdkQGwRSPw/132","nickname":"å“ˆå“ˆå“ˆ","note":"","ucode":"8AC20A1C9C7DF8","race_medal":0,"user_type":1,"is_pvip":true},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":589974,"discussion_content":"ç‰›ï¼","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1665414836,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":"åŒ—äº¬"},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1452675,"avatar":"https://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTJhbjhkN9mVxxA3wfMCmZ5BmoFVHXyaOkqDH5uRXGQNFngDdJDYqkf82ictdicZ9WibLjoiapcom4XbGw/132","nickname":"æœ¨æ˜“","note":"","ucode":"7CCA6255570E6C","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":568446,"discussion_content":"mark","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1651138466,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":66073,"user_name":"bruceding","can_delete":false,"product_type":"c1","uid":1024057,"ip_address":"","ucode":"D35A2B05487EAE","user_header":"https://static001.geekbang.org/account/avatar/00/0f/a0/39/ddcf26ac.jpg","comment_is_top":false,"comment_ctime":1549870738,"is_pvip":false,"replies":[{"id":"23697","content":"èµï¼Œå†åŠ ä¸ŠAPMå®šä½å°±æ›´ç®€å•äº†","user_name":"ä½œè€…å›å¤","user_name_real":"å€ªæœ‹é£","uid":"1001282","ctime":1550067571,"ip_address":"","comment_id":66073,"utype":1}],"discussion_count":2,"race_medal":0,"score":"173348562578","product_id":100020901,"comment_content":"http:&#47;&#47;blog.bruceding.com&#47;420.html  è¿™ä¸ªæ˜¯ä¹‹å‰çš„ä¼˜åŒ–ç»å†ï¼Œé€šè¿‡ perf + ç«ç„°å›¾ï¼Œå®šä½çƒ­ç‚¹ä»£ç ï¼Œç»“åˆä¸šåŠ¡å’Œç½‘ç»œåˆ†æï¼Œæœ€ç»ˆç¡®å®šé—®é¢˜åŸå› ","like_count":40,"discussions":[{"author":{"id":1001282,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/47/42/5b55bd1a.jpg","nickname":"å€ªæœ‹é£","note":"","ucode":"F0FAC195CDE7AC","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":438692,"discussion_content":"èµï¼Œå†åŠ ä¸ŠAPMå®šä½å°±æ›´ç®€å•äº†","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1550067571,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":2593667,"avatar":"https://static001.geekbang.org/account/avatar/00/27/93/83/cb37c46e.jpg","nickname":"cshzet","note":"","ucode":"A343CCB6E5D519","race_medal":0,"user_type":1,"is_pvip":true},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":567860,"discussion_content":"è€å“¥ï¼Œä½ çš„æœåŠ¡å™¨å¥½åƒè¿‡æœŸäº†ï¼Œç½‘é¡µä¸Šä¸å»","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1651020350,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":46624,"user_name":"æ¯å¤©æ™’ç™½ç‰™","can_delete":false,"product_type":"c1","uid":1004698,"ip_address":"","ucode":"A1B102CD933DEA","user_header":"https://static001.geekbang.org/account/avatar/00/0f/54/9a/76c0af70.jpg","comment_is_top":false,"comment_ctime":1543965533,"is_pvip":false,"discussion_count":6,"race_medal":1,"score":"134687951709","product_id":100020901,"comment_content":"ã€D6è¡¥å¡ã€‘<br>å¦‚æœç¢°åˆ°ä¸å¥½è§£é‡Šçš„CPUé—®é¢˜æ—¶ï¼Œæ¯”å¦‚ç°è±¡ï¼š<br>é€šè¿‡topè§‚å¯ŸCPUä½¿ç”¨ç‡å¾ˆé«˜ï¼Œä½†æ˜¯çœ‹ä¸‹é¢çš„è¿›ç¨‹çš„CPUä½¿ç”¨ç‡å¥½åƒå¾ˆæ­£å¸¸ï¼Œé€šè¿‡pidstatå‘½ä»¤æŸ¥çœ‹cpuä¹Ÿå¾ˆæ­£å¸¸ã€‚ä½†é€šè¿‡topæŸ¥çœ‹taskæ•°é‡ä¸æ­£å¸¸ï¼Œå¤„äºRçŠ¶æ€çš„è¿›ç¨‹æ˜¯å¯ç–‘ç‚¹ã€‚<br><br>é¦–å…ˆè¦æƒ³åˆ°å¯èƒ½æ˜¯çŸ­æ—¶é—´çš„åº”ç”¨å¯¼è‡´çš„é—®é¢˜ï¼Œå¦‚ä¸‹é¢çš„ä¸¤ä¸ªï¼š<br>ï¼ˆ1ï¼‰åº”ç”¨é‡Œç›´æ¥è°ƒç”¨äº†å…¶ä»–äºŒè¿›åˆ¶ç¨‹åºï¼Œè¿™äº›ç¨‹åºé€šå¸¸è¿è¡Œæ—¶é—´æ¯”è¾ƒçŸ­ï¼Œé€šè¿‡topç­‰å·¥å…·å‘ç°ä¸äº†<br>ï¼ˆ2ï¼‰åº”ç”¨æœ¬èº«åœ¨ä¸åœåœ°å´©æºƒé‡å¯ï¼Œè€Œå¯åŠ¨è¿‡ç¨‹çš„èµ„æºåˆå§‹åŒ–ï¼Œå¾ˆå¯èƒ½ä¼šå ç”¨å¾ˆå¤šCPUèµ„æº<br><br>å¯¹äºè¿™ç±»è¿›ç¨‹å°±éœ€è¦ pstree æˆ–execsnoopå‘½ä»¤æŸ¥æ‰¾çˆ¶è¿›ç¨‹ï¼Œå†ä»çˆ¶è¿›ç¨‹çš„åº”ç”¨å…¥æ‰‹ï¼Œæ‰¾åŸå› ã€‚<br>æˆ‘å®æˆ˜çš„é—®é¢˜ï¼š<br>ï¼ˆ1ï¼‰centosçš„ç³»ç»Ÿï¼Œå‘ç°é€šè¿‡ yum install pstresså‘½ä»¤æˆ–å…¶ä»–å‘½ä»¤ï¼Œæ€»æ˜¯è¯´æ²¡æœ‰åŒ¹é…çš„è½¯ä»¶åŒ…ï¼Œè¿™ä¸ªå¾ˆå¤´ç–¼<br>â‘ pstressè£…ä¸ä¸Šå¯ä»¥å°è¯• yum install psmisc<br>â‘¡execsnoopè¿™ä¸ªå‘½ä»¤æˆ‘æ²¡æœ‰è£…ä¸Šï¼Œæƒ³è¯·æ•™ä¸‹è€å¸ˆå¦‚ä½•è§£å†³è¿™ç§yum installå‘½ä»¤æŠ¥æ²¡æœ‰åŒ¹é…åŒ…çš„æƒ…å†µ<br>ï¼ˆ2ï¼‰ç„¶åå°±æ˜¯é€šè¿‡perfå‘½ä»¤åªèƒ½çœ‹åˆ°åå…­è¿›åˆ¶ç¬¦å·ï¼Œçœ‹ä¸åˆ°å…·ä½“å‡½æ•°åçš„é—®é¢˜ï¼Œè¿™ä¸ªå¯ä»¥ä½¿ç”¨ä¸Šç¯‡æ–‡ç« ä¸­æˆ‘çš„ç•™è¨€çš„æ–¹æ³•ï¼Œæˆ‘åœ¨copyä¸€ä»½ï¼Œä¾›å¤§å®¶å‚è€ƒ<br>åˆ†æï¼šå½“æ²¡æœ‰çœ‹åˆ°å‡½æ•°åï¼Œåªçœ‹åˆ°åå…­è¿›åˆ¶æ—¶ï¼Œè¯´æ˜perfæ— æ³•æ‰¾åˆ°å¾…åˆ†æè¿›ç¨‹æ‰€ä¾èµ–çš„åº“ã€‚<br>è§£å†³åŠæ³•ï¼š<br>åœ¨å®¹å™¨å¤–é¢æŠŠåˆ†æè®°å½•ä¿å­˜ï¼Œåˆ°å®¹å™¨é‡Œé¢æŸ¥çœ‹ç»“æœ<br>æ“ä½œï¼š<br>ï¼ˆ1ï¼‰åœ¨centosç³»ç»Ÿä¸Šè¿è¡Œ perf record -g ï¼Œæ‰§è¡Œä¸€ä¼šå„¿æŒ‰ctrl+cåœæ­¢<br>ï¼ˆ2ï¼‰æŠŠç”Ÿæˆçš„perf.dataï¼ˆé€šå¸¸æ–‡ä»¶ç”Ÿæˆåœ¨å‘½ä»¤æ‰§è¡Œçš„å½“å‰ç›®å½•ä¸‹ï¼Œå½“ç„¶å¯ä»¥é€šè¿‡find | grep perf.dataæˆ– find &#47; -name perf.dataæŸ¥çœ‹è·¯å¾„ï¼‰æ–‡ä»¶æ‹·è´åˆ°å®¹å™¨é‡Œé¢åˆ†æï¼š<br>docker cp perf.data phpfpm:&#47;tpm<br>docker exec -i -t phpfpm bash<br>cd &#47;tmp&#47;<br>apt-get update &amp;&amp; apt-get install -y linux-perf linux-tools procps<br>perf_4.9 report<br>è¿™æ ·å°±å¯ä»¥çœ‹åˆ°å‡½æ•°åäº†","like_count":31,"discussions":[{"author":{"id":1640292,"avatar":"https://thirdwx.qlogo.cn/mmopen/vi_32/pnpwGEBxicgdYWEX1CPAibVUKL7ricsI0NK7XrFh0iaBUrZdLoYC5jojQfMib7ePJKj0icScdf4sv0LmZ82nFWa9OBibw/132","nickname":"æ›¾ä¸­é“­","note":"","ucode":"C3F974ED43F82C","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":40638,"discussion_content":"å¯¹äº yum install å‘½ä»¤æŠ¥æ²¡æœ‰åŒ¹é…åŒ…çš„é—®é¢˜ï¼Œå¯ä»¥é€šè¿‡ yum provides æŸ¥è¯¢éœ€è¦å®‰è£…çš„å·¥å…·è¢«åŒ…å«åœ¨å“ªä¸ª rpm é‡Œï¼Œå†ç”¨ yum install å®‰è£…è¯¥ rpm åŒ…","likes_number":3,"is_delete":false,"is_hidden":false,"ctime":1572247457,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1200299,"avatar":"https://static001.geekbang.org/account/avatar/00/12/50/ab/6584e520.jpg","nickname":"é™ˆé¡ºå‰","note":"","ucode":"315732AEA35CD1","race_medal":0,"user_type":1,"is_pvip":true},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":301799,"discussion_content":"æ‰¾ä¸åˆ°å¯¹åº”çš„å‘½ä»¤ã€åº“æ–‡ä»¶ã€å¤´æ–‡ä»¶æ—¶ï¼Œç›´æ¥ä½¿ç”¨ yum provides &#34;*/FILENAME&#34; å°±å¯ä»¥æ‰¾åˆ°è¯¥æ–‡ä»¶å¯¹åº”çš„ rpm åŒ…äº†ã€‚å¦å¤–ï¼Œæ˜¯ pstree ä¸æ˜¯ pstressï¼Œtree æ˜¯æ ‘çš„æ„æ€ã€‚","likes_number":2,"is_delete":false,"is_hidden":false,"ctime":1598664055,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1076264,"avatar":"https://static001.geekbang.org/account/avatar/00/10/6c/28/a1f9f0ad.jpg","nickname":"é™ˆæ ‘ä¹‰","note":"","ucode":"AF83C4BDC192B5","race_medal":0,"user_type":1,"is_pvip":true},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":585052,"discussion_content":"å­¦ä¹ äº†~","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1661311379,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":"å¹¿ä¸œ"},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":2110494,"avatar":"https://static001.geekbang.org/account/avatar/00/20/34/1e/8a9f7cd5.jpg","nickname":"æ…¢æ…¢æ¥","note":"","ucode":"3AF18A1AEC3E61","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":300878,"discussion_content":"è¡¥å……ä¸€ç‚¹ï¼Œè€å¸ˆé‡Œé¢çš„dockerç¯å¢ƒä¸ºdebianï¼Œå¯¹åº”çš„å®‰è£…æºåº”è¯¥æ›´æ–°ä¸ºè¾ƒå¿«çš„é˜¿é‡Œæºæˆ–å…¶ä»–ï¼Œå¦åˆ™updateç­‰ä¸Šä¸ªä¸€å¤©éƒ½æä¸å®š","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1598286521,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1336009,"avatar":"https://static001.geekbang.org/account/avatar/00/14/62/c9/7da27891.jpg","nickname":"DKSky","note":"","ucode":"69371A81033949","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":21150,"discussion_content":"execsnoopç‚¹è¿›å»å°±åœ¨githubä¸­ï¼Œç›´æ¥ä¸‹è½½","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1569424155,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1321192,"avatar":"https://static001.geekbang.org/account/avatar/00/14/28/e8/a0936291.jpg","nickname":"é¾™å°å®","note":"","ucode":"39A3FBD4040508","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":4161,"discussion_content":"å‰ä¸€ç¯‡ä¸­ä½ æåˆ°çš„è§£å†³å‡½æ•°åå˜æ›´ä¸º16è¿›åˆ¶çš„åŠæ³•åœ¨è¿™é‡Œæˆ‘è¯•äº†è¡Œä¸é€šï¼ŒæŠŠperf.dataæ”¾è¿›å»ä¹‹åï¼Œä½¿ç”¨perf_4.9è¿è¡Œä¸äº†ï¼Œæç¤ºéœ€è¦å®‰è£…3.10çš„å†…æ ¸æ›´æ–°ï¼Œä½†æ˜¯å†…æ ¸æ›´æ–°åˆæ›´æ–°ä¸äº†","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1565178884,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":203541,"user_name":"EncodedStar","can_delete":false,"product_type":"c1","uid":1504234,"ip_address":"","ucode":"03958CA7DDD6AE","user_header":"https://static001.geekbang.org/account/avatar/00/16/f3/ea/2b2adda5.jpg","comment_is_top":false,"comment_ctime":1586230212,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"126140281796","product_id":100020901,"comment_content":"è¿™ç§è¯¾ç¨‹ï¼Œå¤šå­¦å¤šç›Šï¼Œä¸€æ—¦é‡åˆ°è¢«ä½ è§£å†³äº†ï¼Œä½ å°±æ˜¯å…¬å¸æœ€é“çš„ä»”~~~","like_count":29},{"had_liked":false,"id":180358,"user_name":"ç½—è¾‘æ€ç»´","can_delete":false,"product_type":"c1","uid":1318941,"ip_address":"","ucode":"D257A06EDE928E","user_header":"https://static001.geekbang.org/account/avatar/00/14/20/1d/0c1a184c.jpg","comment_is_top":false,"comment_ctime":1582267050,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"104661482154","product_id":100020901,"comment_content":"#ä¸‹è½½execsnoop#<br>1 cd &#47;usr&#47;bin<br>2 wget https:&#47;&#47;raw.githubusercontent.com&#47;brendangregg&#47;perf-tools&#47;master&#47;execsnoop<br>3 chmod 755 execsnoop ","like_count":24},{"had_liked":false,"id":47142,"user_name":"western","can_delete":false,"product_type":"c1","uid":1215550,"ip_address":"","ucode":"21BCB130722780","user_header":"https://static001.geekbang.org/account/avatar/00/12/8c/3e/e767c15f.jpg","comment_is_top":false,"comment_ctime":1544062789,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"91738376005","product_id":100020901,"comment_content":"æ„Ÿè§‰çœ‹ä¾¦æ¢å°è¯´ï¼Œéçœ‹éç­‰è€å¸ˆè¯´é‚£å¥è¯â€”â€”â€çœŸç›¸åªæœ‰ä¸€ä¸ªâ€","like_count":21},{"had_liked":false,"id":46281,"user_name":"åˆ’æ—¶ä»£","can_delete":false,"product_type":"c1","uid":1061454,"ip_address":"","ucode":"9554CE2F83B77F","user_header":"http://thirdwx.qlogo.cn/mmopen/vi_32/2o1Izf2YyJSnnI0ErZ51pYRlnrmibqUTaia3tCU1PjMxuwyXSKOLUYiac2TQ5pd5gNGvS81fVqKWGvDsZLTM8zhWg/132","comment_is_top":false,"comment_ctime":1543892584,"is_pvip":false,"discussion_count":1,"race_medal":0,"score":"87443238504","product_id":100020901,"comment_content":"ä»Šå¤©æ—©ä¸Šæ”¶åˆ°çº¿ä¸Šä¸€å°æœºå™¨çš„CPUä½¿ç”¨ç‡å‘Šè­¦é‚®ä»¶ï¼Œé©¬ä¸Šç™»é™†æœºå™¨æŸ¥çœ‹å‘Šè­¦è¿›ç¨‹å·çš„&#47;procæƒ…å†µï¼Œä½¿ç”¨uptimeã€pidstatå’Œtopå‘½ä»¤æŸ¥å½“å‰è¿è¡Œæƒ…å†µï¼Œåé¢å®šä½åˆ°æ˜¯crontabå®šæ—¶ä»»åŠ¡ä¸­çš„ç¨‹åºå¼•èµ·è´Ÿè½½è¿‡é«˜ã€‚","like_count":20,"discussions":[{"author":{"id":3065276,"avatar":"","nickname":"Geek_b3b8da","note":"","ucode":"5461CD95B1D764","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":591474,"discussion_content":"ä½ å°±æ˜¯å…¬å¸æœ€äº®çš„ä»”","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1666595547,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":"æµ™æ±Ÿ"},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":50462,"user_name":"é£","can_delete":false,"product_type":"c1","uid":1177916,"ip_address":"","ucode":"E054CE4AABF790","user_header":"https://static001.geekbang.org/account/avatar/00/11/f9/3c/f75ab868.jpg","comment_is_top":false,"comment_ctime":1544974078,"is_pvip":false,"replies":[{"id":"18094","content":"å—¯å—¯ å¾ˆå¥½çš„é—®é¢˜ã€‚ç®€å•çš„è¯´ï¼Œswapperè·Ÿæˆ‘ä»¬è¦åˆ†æçš„å¯¹è±¡æ— å…³ã€‚è¿™ä¹Ÿæ˜¯ä¸ºä»€ä¹ˆæˆ‘ä»¬ä¸ä¸Šæ¥å°±ç”¨perfï¼Œè€Œæ˜¯å…ˆç”¨å…¶ä»–æ–¹æ³•ç¼©å°èŒƒå›´ã€‚æˆ‘è¿˜ä¼šåœ¨ç­”ç–‘ç¯‡é‡Œè§£é‡Šswapperçš„ä½œç”¨","user_name":"ä½œè€…å›å¤","user_name_real":"å€ªæœ‹é£","uid":"1001282","ctime":1545003241,"ip_address":"","comment_id":50462,"utype":1}],"discussion_count":6,"race_medal":0,"score":"61674516222","product_id":100020901,"comment_content":"è€å¸ˆå¥½ï¼Œæˆ‘åœ¨å®éªŒçš„è¿‡ç¨‹ä¸­ï¼Œåœ¨æœ€åä½¿ç”¨ perf record -ag çš„æ—¶å€™ï¼Œå‘ç°è®°å½•ä¸‹æ¥çš„å€¼ï¼Œå…¶ä¸­ stress å¹¶ä¸æ˜¯æ¶ˆè€— CPU æœ€çŒ›çš„è¿›ç¨‹ï¼Œè€Œæ˜¯swapperï¼Œä¸çŸ¥é“ä»€ä¹ˆåŸå› ï¼Ÿç¢°åˆ°è¿™ç§æƒ…å†µæ—¶ï¼Œè¯¥å¦‚ä½•ç»§ç»­æ’æŸ¥ä¸‹å»ï¼Ÿä»¥ä¸‹æ˜¯æˆ‘çš„ perf report<br>Samples: 223K of event &#39;cpu-clock&#39;, Event count (approx.): 55956000000<br>  Children      Self  Command          Shared Object            Symbol<br>+   11.54%     0.00%  swapper          [kernel.kallsyms]        [k] cpu_startup_entry<br>+   11.42%     0.00%  swapper          [kernel.kallsyms]        [k] default_idle_call<br>+   11.42%     0.00%  swapper          [kernel.kallsyms]        [k] arch_cpu_idle<br>+   11.42%     0.00%  swapper          [kernel.kallsyms]        [k] default_idle<br>+   11.05%    11.05%  swapper          [kernel.kallsyms]        [k] native_safe_halt<br>+    8.69%     0.00%  swapper          [kernel.kallsyms]        [k] start_secondary<br>+    4.36%     4.36%  stress           libc-2.24.so             [.] 0x0000000000036387<br>+    3.44%     0.00%  php-fpm          libc-2.24.so             [.] 0xffff808406d432e1<br>+    3.44%     0.00%  php-fpm          [unknown]                [k] 0x6cb6258d4c544155<br>+    3.43%     3.43%  stress           stress                   [.] 0x0000000000002eff<br>+    3.20%     0.00%  stress           [kernel.kallsyms]        [k] page_fault<br>+    3.20%     0.00%  stress           [kernel.kallsyms]        [k] do_page_fault<br>+    3.15%     0.76%  stress           [kernel.kallsyms]        [k] __do_page_fault","like_count":14,"discussions":[{"author":{"id":1001282,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/47/42/5b55bd1a.jpg","nickname":"å€ªæœ‹é£","note":"","ucode":"F0FAC195CDE7AC","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":432986,"discussion_content":"å—¯å—¯ å¾ˆå¥½çš„é—®é¢˜ã€‚ç®€å•çš„è¯´ï¼Œswapperè·Ÿæˆ‘ä»¬è¦åˆ†æçš„å¯¹è±¡æ— å…³ã€‚è¿™ä¹Ÿæ˜¯ä¸ºä»€ä¹ˆæˆ‘ä»¬ä¸ä¸Šæ¥å°±ç”¨perfï¼Œè€Œæ˜¯å…ˆç”¨å…¶ä»–æ–¹æ³•ç¼©å°èŒƒå›´ã€‚æˆ‘è¿˜ä¼šåœ¨ç­”ç–‘ç¯‡é‡Œè§£é‡Šswapperçš„ä½œç”¨","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1545003241,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1356083,"avatar":"https://static001.geekbang.org/account/avatar/00/14/b1/33/8993eae0.jpg","nickname":"é»„å±•å¿—","note":"","ucode":"EBA342CD89072D","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":39208,"discussion_content":"æˆ‘è·Ÿä½ çš„æƒ…å†µæ˜¯ä¸€æ ·çš„ï¼Œæˆ‘çš„è™šæ‹Ÿæœºç”¨äº†8ä¸ªCPUï¼Œ8Gå†…å­˜","likes_number":1,"is_delete":false,"is_hidden":false,"ctime":1571905208,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":3065276,"avatar":"","nickname":"Geek_b3b8da","note":"","ucode":"5461CD95B1D764","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":591475,"discussion_content":"swapperæ˜¯ä¸€ä¸ªç©ºä»»åŠ¡ä¸éœ€è¦ç®¡","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1666595595,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":"æµ™æ±Ÿ"},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1769504,"avatar":"http://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTJGXndj5N66z9BL1ic9GibZzWWgoVeWaWTL2XUnCYic7iba2kAEvN9WfjmlXELD5lqt8IJ1P023N5ZWicg/132","nickname":"Geek_f93234","note":"","ucode":"1E5DC903A5429E","race_medal":1,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":580374,"discussion_content":"+   23.56%     0.00%  swapper          [kernel.kallsyms]               [k] start_cpu\n+   23.55%     0.00%  swapper          [kernel.kallsyms]               [k] cpu_startup_entry\n+   23.55%     0.00%  swapper          [kernel.kallsyms]               [k] arch_cpu_idle\n+   23.55%     0.00%  swapper          [kernel.kallsyms]               [k] default_idle\n+   22.62%    22.62%  swapper          [kernel.kallsyms]               [k] native_safe_halt\n+   18.06%     0.00%  swapper          [kernel.kallsyms]               [k] start_secondary\n+   13.38%     0.00%  nginx            [kernel.kallsyms]               [k] do_softirq\n+   13.38%     0.00%  nginx            [kernel.kallsyms]               [k] call_softirq\n+   13.38%     0.01%  nginx            [kernel.kallsyms]               [k] __do_softirq\n+   13.33%     0.02%  nginx            [kernel.kallsyms]               [k] net_rx_action\n+   12.87%     0.02%  nginx            [kernel.kallsyms]               [k] __local_bh_enable_ip\n+   11.58%     0.01%  nginx            [kernel.kallsyms]               [k] ip_output\n+   11.55%     0.00%  nginx            [kernel.kallsyms]               [k] ip_finish_output\n+   11.31%     0.02%  nginx            [kernel.kallsyms]               [k] tcp_transmit_skb\n+   11.28%     0.01%  nginx            [kernel.kallsyms]               [k] ip_local_out_sk\n+   11.27%     0.01%  nginx            [kernel.kallsyms]               [k] ip_queue_xmit\n+   11.24%     0.01%  nginx            [kernel.kallsyms]               [k] __tcp_push_pending_frames\n","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1658132929,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1356083,"avatar":"https://static001.geekbang.org/account/avatar/00/14/b1/33/8993eae0.jpg","nickname":"é»„å±•å¿—","note":"","ucode":"EBA342CD89072D","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":39210,"discussion_content":"+    6.48%     0.00%  swapper          [unknown]                [k] 0xffffffff94d85885\n+    6.48%     0.00%  swapper          [unknown]                [k] 0xffffffff94d8572f\n+    6.48%     0.00%  swapper          [unknown]                [k] 0xffffffff94d861c6\n+    6.48%     0.00%  swapper          [unknown]                [k] 0xffffffff94751117\n     2.57%     2.57%  stress           libc-2.24.so             [.] 0x0000000000036387\n+    2.49%     0.00%  stress           [unknown]                [.] 0xffffffff9476c768\n+    2.49%     0.00%  stress           [unknown]                [.] 0xffffffff94770925\n     2.43%     2.43%  stress           stress                   [.] 0x0000000000002eff\n+    2.28%     0.00%  php-fpm          [unknown]                [k] 0x6cb6258d4c544155\n+    2.28%     0.00%  php-fpm          libc-2.24.so             [.] 0x00007fbb4f0912e1\n+    1.62%     0.00%  stress           [unknown]                [.] 0xffffffff94770603","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1571905295,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1356083,"avatar":"https://static001.geekbang.org/account/avatar/00/14/b1/33/8993eae0.jpg","nickname":"é»„å±•å¿—","note":"","ucode":"EBA342CD89072D","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":39209,"discussion_content":"+   46.72%     0.00%  swapper          [unknown]                [k] 0xffffffff940000d5\n+   46.44%     0.00%  swapper          [unknown]                [k] 0xffffffff940fc65a\n+   46.44%     0.00%  swapper          [unknown]                [k] 0xffffffff940366f0\n+   46.43%     0.00%  swapper          [unknown]                [k] 0xffffffff9476ac8e\n+   46.10%    46.10%  swapper          [kernel.kallsyms]        [k] native_safe_halt\n+   46.10%     0.00%  swapper          [unknown]                [k] 0xffffffff9476ae9b\n+   40.23%     0.00%  swapper          [unknown]                [k] 0xffffffff94057ff7","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1571905271,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":46275,"user_name":"looperX","can_delete":false,"product_type":"c1","uid":1054948,"ip_address":"","ucode":"AB13DFCF9D6DE9","user_header":"https://static001.geekbang.org/account/avatar/00/10/18/e4/46d002ed.jpg","comment_is_top":false,"comment_ctime":1543892257,"is_pvip":false,"discussion_count":5,"race_medal":0,"score":"48788532513","product_id":100020901,"comment_content":"Day03ç•™è¨€ã€‚<br>Githubä¸Šæ‰¾åˆ°ä¸€ä¸ªé“¾æ¥ï¼Œé‡Œé¢æœ‰å„ç§å·¥å…·ï¼ŒåŒ…æ‹¬execsnoopã€‚","like_count":11,"discussions":[{"author":{"id":1069269,"avatar":"https://static001.geekbang.org/account/avatar/00/10/50/d5/73334a95.jpg","nickname":"doos","note":"","ucode":"7C9AF67F90E65C","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":578928,"discussion_content":"ç‰›é€¼å‹\n","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1657096093,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1135912,"avatar":"https://static001.geekbang.org/account/avatar/00/11/55/28/31b0cf2f.jpg","nickname":"é»‘è‰²æ¯›è¡£","note":"","ucode":"FF7E235F91BA5C","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":577514,"discussion_content":"git clone --depth 1 https://github.com/brendangregg/perf-tools","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1656157546,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1538486,"avatar":"https://static001.geekbang.org/account/avatar/00/17/79/b6/98834766.jpg","nickname":"August","note":"","ucode":"72A0CB0C74CD35","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":369597,"discussion_content":"åœ°å€å‘ä¸€ä¸‹ï¼Œè°¢è°¢","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1619089765,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":1,"child_discussions":[{"author":{"id":1303623,"avatar":"https://static001.geekbang.org/account/avatar/00/13/e4/47/d6469ffa.jpg","nickname":"æ©™å­","note":"","ucode":"019A02ADD2E9F1","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":1538486,"avatar":"https://static001.geekbang.org/account/avatar/00/17/79/b6/98834766.jpg","nickname":"August","note":"","ucode":"72A0CB0C74CD35","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":402063,"discussion_content":"git clone --depth 1 https://github.com/brendangregg/perf-tools\nåœ¨./perf-tools/bin/ç›®å½•ä¸‹","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1633789454,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":369597,"ip_address":""},"score":402063,"extra":""}]},{"author":{"id":1106209,"avatar":"https://static001.geekbang.org/account/avatar/00/10/e1/21/5f0bf9a0.jpg","nickname":"é˜¿æ–‡","note":"","ucode":"BB4DB62141971F","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":1078,"discussion_content":"åœ°å€å‘ä¸€ä¸‹","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1562312939,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":90906,"user_name":"è°","can_delete":false,"product_type":"c1","uid":1517268,"ip_address":"","ucode":"F65760FDD31CEB","user_header":"https://static001.geekbang.org/account/avatar/00/17/26/d4/add17f35.jpg","comment_is_top":false,"comment_ctime":1556719532,"is_pvip":false,"discussion_count":1,"race_medal":0,"score":"44506392492","product_id":100020901,"comment_content":"åˆ†ææ­¥éª¤ï¼š<br>1ï¼Œåœ¨topä¸­ï¼Œå¯è§ç”¨æˆ·æ€cpuä½¿ç”¨ç‡å¾ˆé«˜ï¼Œä½†æœªè§ç›¸å…³æœ‰é—®é¢˜çš„è¿›ç¨‹ï¼›<br>2ï¼Œå°è¯•pidstat 1 æ‰¾å‡ºé—®é¢˜è¿›ç¨‹ï¼Œæ— æœï¼›<br>3ï¼Œå†æ¬¡top,ä»load average å¯è§è´Ÿè½½é«˜ï¼Œshift + f ï¼Œç„¶åé€‰æ‹©ä»¥s (è¿›ç¨‹çŠ¶æ€ï¼‰æ’åºï¼ŒæŒ‰Rå€’åºï¼Œå¯è§runningçš„è¿›ç¨‹ä¸»è¦å°±æ˜¯å‡ ä¸ªstressè¿›ç¨‹ï¼Œè§‚å¯Ÿå‘ç°ï¼Œrunningçš„stressè¿›ç¨‹çš„pidä¸€ç›´åœ¨å˜åŒ–ï¼›<br>4ï¼Œwatch -d &#39;ps aux | grep stress | grep -v grep&#39; å‘ç°å¤šä¸ªstressè¿›ç¨‹åœ¨ä¸æ–­ç”Ÿæˆï¼Œç”±Rå˜Så†å˜Zï¼ˆç”±äºwatchçš„æ—¶é—´é—´éš”æ˜¯1ç§’ï¼Œæ‰€ä»¥åªæ˜¯çœ‹åˆ°æœ‰å¤šä¸ªstressè¿›ç¨‹ï¼Œæœ‰çš„çŠ¶æ€æ˜¯Ræœ‰çš„æ˜¯Sæœ‰çš„æ˜¯Zï¼Œæ‰€ä»¥æˆ‘æ¨æ–­å…¶ç”Ÿå‘½å‘¨æœŸæ˜¯å¦‚æ­¤ï¼‰<br>5ï¼Œè¿›ç¨‹Pidå†ä¸æ–­å˜åŒ–ï¼Œæœ‰ä»¥ä¸‹ä¸¤ä¸ªåŸå› ï¼š<br>5.1ï¼Œè¿›ç¨‹åœ¨ä¸æ–­å´©æºƒé‡å¯ï¼Œå¦‚å› ä¸ºæ®µé”™è¯¯ï¼Œé…ç½®é”™è¯¯ç­‰ï¼Œè¿™æ—¶è¿›ç¨‹åœ¨é€€å‡ºååˆè¢«ç›‘æ§ç³»ç»Ÿè‡ªåŠ¨é‡å¯<br>5.2ï¼Œè¿™äº›éƒ½æ˜¯çŸ­è¿›ç¨‹ï¼Œå³åœ¨åº”ç”¨å†…éƒ¨é€šè¿‡execè°ƒç”¨å¤–éƒ¨å‘½ä»¤ã€‚è¿™äº›å‘½ä»¤ä¸€èˆ¬åªè¿è¡Œå¾ˆçŸ­çš„æ—¶é—´å°±ä¼šç»“æŸï¼Œå¾ˆéš¾ç”¨æ—¶é—´é—´éš”é•¿çš„å·¥å…·ï¼Œå¦‚topå»å‘ç°<br>6ï¼Œç”¨pstresså»æ‰¾å…¶çˆ¶è¿›ç¨‹<br><br>7ï¼Œå‘ç°æ˜¯phpå®¹å™¨ï¼Œæ•…æŸ¥çœ‹phpæºç <br># æ‹·è´æºç åˆ°æœ¬åœ°<br>$ docker cp phpfpm:&#47;app .<br># grep æŸ¥æ‰¾çœ‹çœ‹æ˜¯ä¸æ˜¯æœ‰ä»£ç åœ¨è°ƒç”¨ stress å‘½ä»¤<br>$ grep stress -r app<br><br>8ï¼Œä»æºä»£ç ä¸­æ‰¾ç›¸å…³å­—æ®µ<br><br>9ï¼Œstress -t 1 -d 1 æ˜¯æ¨¡æ‹ŸIOå‹åŠ›çš„ï¼Œä½†åœ¨ä¹‹å‰çš„topä¸­ï¼Œæœªè§%iowaitå¼‚å¸¸ï¼›<br>10ï¼Œé€šè¿‡ä»£ç ä¸­çš„åˆ¤æ–­å­—æ®µï¼Œæ‰‹åŠ¨èµ‹å€¼è®¿é—®<br>curl http:&#47;&#47;192.168.0.10:10000?verbose=1<br>Server internal error: Array<br>(<br>    [0] =&gt; stress: info: [19607] dispatching hogs: 0 cpu, 0 io, 0 vm, 1 hdd<br>    [1] =&gt; stress: FAIL: [19608] (563) mkstemp failed: Permission denied<br>    [2] =&gt; stress: FAIL: [19607] (394) &lt;-- worker 19608 returned error 1<br>    [3] =&gt; stress: WARN: [19607] (396) now reaping child worker processes<br>    [4] =&gt; stress: FAIL: [19607] (400) kill error: No such process<br>    [5] =&gt; stress: FAIL: [19607] (451) failed run completed in 0s<br>)<br>11ï¼Œä»è¿™é‡Œå¯ä»¥çŒœæµ‹ï¼Œç”±äºæƒé™é”™è¯¯ï¼Œå¤§é‡çš„stressè¿›ç¨‹åœ¨å¯åŠ¨æ—¶åˆå§‹åŒ–å¤±è´¥ï¼Œç»“åˆç¬¬4ç‚¹ï¼Œæˆ‘è®¤ä¸ºCPUæ¶ˆè€—åœ¨è¿›ç¨‹ä¸Šä¸‹æ–‡åˆ‡æ¢ï¼Œä»vmstatå¯è§csç”±é—®é¢˜å‡ºç°å‰çš„100å¤šéª¤å‡å¹¶ç¨³å®šç»´æŒåœ¨3000å¤š<br>[root@master ~]# vmstat 1<br>procs -----------memory---------- ---swap-- -----io---- -system-- ------cpu-----<br> r  b   swpd   free   buff  cache   si   so    bi    bo   in   cs us sy id wa st<br> 9  0      0 6932288   2160 790400    0    0    20    24   44   71  8  5 87  0  0<br> 8  0      0 6932784   2160 790560    0    0     0     0 4027 3512 71 27  3  0  0<br>11  0      0 6934920   2160 790488    0    0     0     0 4170 3646 72 28  1  0  0<br><br>ä½†pidstat -w |grep stress å´æœªè§å¼‚å¸¸ï¼Œå› ä¸ºåŒåè¿›ç¨‹ä¸€ç›´åœ¨æ›´æ¢ï¼Œæ‰€ä»¥ç”¨pidstat -wåœ¨è¿™é‡Œæ˜¯ä¸å¤ªé€‚ç”¨çš„<br>[root@master ~]# pidstat -w 2 | grep stress<br>09:55:29 AM     1     18583      0.50      0.50  stress<br>09:55:29 AM     1     18584      0.50      0.50  stress<br>09:55:29 AM     1     18586      0.50      0.00  stress<br>ã€‚ã€‚ã€‚<br>è¯·é—®ä»¥ä¸Šå¯¹å—ï¼Ÿ","like_count":10,"discussions":[{"author":{"id":3065276,"avatar":"","nickname":"Geek_b3b8da","note":"","ucode":"5461CD95B1D764","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":591477,"discussion_content":"æŸ¥çœ‹åƒµå°¸è¿›ç¨‹ç›´æ¥å°±æ˜¯ ps -A -ostat,ppid,pid,cmd|egrep -e &#34;^[zZ]&#34;å°±å¯ä»¥äº†","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1666596038,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":"æµ™æ±Ÿ"},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":219979,"user_name":"é˜¿é£","can_delete":false,"product_type":"c1","uid":1298046,"ip_address":"","ucode":"F8B1FC8521264D","user_header":"http://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTKZicicibGibtR5zAia782Ajc5I5BN3F3tjAdlibATIknHv67gbxeH21N7B6vbgwLjYb1miaLKhqicptB5ibYw/132","comment_is_top":false,"comment_ctime":1590130273,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"23064966753","product_id":100020901,"comment_content":"å…³äºä½¿ç”¨perfå·¥å…·åˆ†ædockerå®¹å™¨å…±ç”¨3ç§å¯è¡Œçš„åŠæ³•ï¼Œè¯¦è§ï¼šhttps:&#47;&#47;www.cnblogs.com&#47;luoahong&#47;p&#47;10833689.html","like_count":5},{"had_liked":false,"id":48054,"user_name":"Griffin","can_delete":false,"product_type":"c1","uid":1087329,"ip_address":"","ucode":"CF766B92A65261","user_header":"https://static001.geekbang.org/account/avatar/00/10/97/61/34a0da09.jpg","comment_is_top":false,"comment_ctime":1544334825,"is_pvip":false,"replies":[{"id":"17291","content":"å—¯å—¯ï¼Œè¿™æ˜¯ä¸€ä¸ªæ¨¡å—ï¼Œä¾§é‡äºCPUçš„åˆ†æï¼Œåé¢è¿˜ä¼šè®²ç£ç›˜ã€ç½‘ç»œç­‰ç­‰","user_name":"ä½œè€…å›å¤","user_name_real":"å€ªæœ‹é£","uid":"1001282","ctime":1544437300,"ip_address":"","comment_id":48054,"utype":1}],"discussion_count":1,"race_medal":0,"score":"23019171305","product_id":100020901,"comment_content":"å®é™…ç”Ÿäº§ç¯å¢ƒä¸­çš„è¿›ç¨‹æ›´å¤šï¼Œstressè—åœ¨psä¸­æ ¹æœ¬ä¸å®¹æ˜“å‘ç°ï¼Œpstreeçš„ç»“æœä¹Ÿéå¸¸å¤§ã€‚è€å¸ˆæœ‰ç©ºè®²è®²å¦‚ä½•æ‰¾åˆ°è¿™äº›å¼‚å¸¸è¿›ç¨‹çš„æ–¹æ³•å’Œçµæ„Ÿã€‚","like_count":5,"discussions":[{"author":{"id":1001282,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/47/42/5b55bd1a.jpg","nickname":"å€ªæœ‹é£","note":"","ucode":"F0FAC195CDE7AC","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":432010,"discussion_content":"å—¯å—¯ï¼Œè¿™æ˜¯ä¸€ä¸ªæ¨¡å—ï¼Œä¾§é‡äºCPUçš„åˆ†æï¼Œåé¢è¿˜ä¼šè®²ç£ç›˜ã€ç½‘ç»œç­‰ç­‰","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1544437300,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":46032,"user_name":"èµµå¼ºå¼º","can_delete":false,"product_type":"c1","uid":1073596,"ip_address":"","ucode":"1B8AE07484C69A","user_header":"https://static001.geekbang.org/account/avatar/00/10/61/bc/88a905a5.jpg","comment_is_top":false,"comment_ctime":1543836612,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"23018673092","product_id":100020901,"comment_content":"å€ªè€å¸ˆæ‚¨å¥½ï¼Œæˆ‘åœ¨ç½‘ä¸Šçœ‹åˆ°ä¸€ä¸ªå…³äºiowaitæŒ‡æ ‡çš„è§£é‡Šï¼Œéå¸¸å½¢è±¡ï¼Œä½†ä¸ç¡®å®šæ˜¯å¦å‡†ç¡®ï¼Œå¸®å¿™é‰´åˆ«ä¸€ä¸‹ï¼Œè°¢è°¢ï¼Œé“¾æ¥ http:&#47;&#47;linuxperf.com&#47;?p=33","like_count":5},{"had_liked":false,"id":45811,"user_name":"æ¯å¤©æ™’ç™½ç‰™","can_delete":false,"product_type":"c1","uid":1004698,"ip_address":"","ucode":"A1B102CD933DEA","user_header":"https://static001.geekbang.org/account/avatar/00/0f/54/9a/76c0af70.jpg","comment_is_top":false,"comment_ctime":1543798976,"is_pvip":false,"discussion_count":2,"race_medal":1,"score":"23018635456","product_id":100020901,"comment_content":"ã€D6æ‰“å¡ã€‘è¿™å‡ å¤©å›ä¸ˆæ¯å¨˜å®¶ï¼Œæ²¡å¸¦ç”µè„‘ï¼Œæ²¡èƒ½å®æˆ˜ï¼Œåªèƒ½çœ‹æ–‡ç« äº†ï¼Œå›æ¥åè¦è¡¥ä¸Š","like_count":5,"discussions":[{"author":{"id":1805809,"avatar":"","nickname":"ccz å¼€å‘(è°¢ä¸é‚€)","note":"","ucode":"B8803B050AAC68","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":136545,"discussion_content":"é‡ç‚¹åœ¨ã€‚ã€‚ã€‚æœ‰ä¸ˆæ¯å¨˜çš„äºº","likes_number":3,"is_delete":false,"is_hidden":false,"ctime":1579146984,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1336475,"avatar":"https://static001.geekbang.org/account/avatar/00/14/64/9b/0b578b08.jpg","nickname":"J.Smile","note":"","ucode":"C4D98DFDBF7584","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":293232,"discussion_content":"æœ‰ä¸ˆæ¯å¨˜çš„å°ä¼™","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1595488231,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":76260,"user_name":"æ±¤ğŸ ğŸ¥£æ˜±","can_delete":false,"product_type":"c1","uid":1332781,"ip_address":"","ucode":"46842C90E59A1A","user_header":"https://static001.geekbang.org/account/avatar/00/14/56/2d/dd3b12b8.jpg","comment_is_top":false,"comment_ctime":1552560322,"is_pvip":false,"discussion_count":1,"race_medal":0,"score":"18732429506","product_id":100020901,"comment_content":"1ï¼š å¯¹äºpidstat,vmstat,topæ— æ³•å®šä½åˆ°é—®é¢˜çš„æ—¶å€™ã€‚<br>2ï¼š å¯ä»¥é€‰æ‹©perf record -g è®°å½•ã€‚<br>3ï¼š ç”¨perf reportæŸ¥çœ‹æ˜¯å¦å¯ä»¥å®šä½åˆ°é—®é¢˜ã€‚<br>4ï¼š ç”¨pstree | grep [xx],è¿™æ ·å®šä½åˆ°å…·ä½“çš„è°ƒç”¨æ–¹æ³•é‡Œã€‚<br>5ï¼š ç”¨grep [xx] -r [é¡¹ç›®æ–‡ä»¶],æ‰¾åˆ°å…·ä½“ä»£ç ä½ç½®ã€‚<br>6ï¼š æŸ¥æ‰¾æºç ï¼Œå®šä½åˆ°å…·ä½“ä½ç½®ï¼Œä¿®æ”¹ã€‚","like_count":4,"discussions":[{"author":{"id":3065276,"avatar":"","nickname":"Geek_b3b8da","note":"","ucode":"5461CD95B1D764","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":591478,"discussion_content":"è¿˜å¯ä»¥ç”¨strace -p -f å»è¿›è¡Œè¿½è¸ª","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1666596115,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":"æµ™æ±Ÿ"},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":72557,"user_name":"Boy-struggle","can_delete":false,"product_type":"c1","uid":1402286,"ip_address":"","ucode":"94113E2837DC29","user_header":"https://static001.geekbang.org/account/avatar/00/15/65/ae/9727318e.jpg","comment_is_top":false,"comment_ctime":1551667699,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"18731536883","product_id":100020901,"comment_content":"æ‰“å¡ï¼Œå¯¹äºå¤§æ•°æ®çš„ç³»ç»Ÿåˆ†æèµ·æ¥è¿˜æ˜¯æ¯”è¾ƒå›°éš¾çš„ï¼Œè¿›ç¨‹å·²ç»è¾¾åˆ°ä¸Šåƒï¼Œåªèƒ½ç”¨topå»åˆ†æ","like_count":4},{"had_liked":false,"id":53496,"user_name":"æ¯ä¸€æ®µè·¯éƒ½æ˜¯ä¸€ç§é¢†æ‚Ÿ","can_delete":false,"product_type":"c1","uid":1123452,"ip_address":"","ucode":"B23F0D4B02197B","user_header":"https://static001.geekbang.org/account/avatar/00/11/24/7c/b76ad65d.jpg","comment_is_top":false,"comment_ctime":1545657533,"is_pvip":false,"replies":[{"id":"19395","content":"ğŸ˜Š","user_name":"ä½œè€…å›å¤","user_name_real":"å€ªæœ‹é£","uid":"1001282","ctime":1545664294,"ip_address":"","comment_id":53496,"utype":1}],"discussion_count":2,"race_medal":0,"score":"18725526717","product_id":100020901,"comment_content":"ä»Šå¤©ä¸€ä¸ªç¨‹åºè´Ÿè½½é£™åˆ°140ï¼Œæœ€é«˜ç‚¹240ï¼Œæˆ‘ä»¬çš„æœåŠ¡å™¨æ²¡æœ‰æŒ‚æ‰ï¼ŒçœŸçš„æ˜¯ç‰›é€¼ï¼Œå¦å¤–ä½¿ç”¨è¿™å‡ å¤©çš„æ–¹æ³•ï¼ŒåŸºæœ¬ç¡®è®¤äº†ç¨‹åºçš„é—®é¢˜ï¼Œè´¨é—®å¼€å‘åï¼Œä»–ä¸å¥½æ„æ€çš„å‘Šè¯‰æˆ‘ï¼Œioé«˜æ˜¯å› ä¸ºè‡ªå·±ç¨‹åºå·äº†æ‡’ï¼Œå¥½åœ¨è¿™æ¬¡æ‰¾åˆ°è¯æ®äº†ï¼Œä½œä¸ºä»¥åçš„åˆ†ææ¡ˆä¾‹","like_count":4,"discussions":[{"author":{"id":1001282,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/47/42/5b55bd1a.jpg","nickname":"å€ªæœ‹é£","note":"","ucode":"F0FAC195CDE7AC","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":434156,"discussion_content":"ğŸ˜Š","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1545664294,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1804356,"avatar":"https://static001.geekbang.org/account/avatar/00/1b/88/44/87cc5c0f.jpg","nickname":"å°å­¦ç”Ÿ","note":"","ucode":"0DBB26031234FB","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":266493,"discussion_content":"è¿™å°±æ˜¯ä¸Šé¢è¯´çš„ï¼šå…¬å¸é‡Œæœ€äº®çš„ä»”ã€‚","likes_number":1,"is_delete":false,"is_hidden":false,"ctime":1589522565,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":45862,"user_name":"walker","can_delete":false,"product_type":"c1","uid":1324219,"ip_address":"","ucode":"FA5B2400A53730","user_header":"https://static001.geekbang.org/account/avatar/00/14/34/bb/0b971fca.jpg","comment_is_top":false,"comment_ctime":1543805037,"is_pvip":false,"replies":[{"id":"16423","content":"ç‚¹å‡»é“¾æ¥åˆ°githubä¸Šã€‚<br><br>å®Œå…¨ä¸€æ ·çš„å·¥å…·åº”è¯¥æ²¡æœ‰ï¼Œä½†å¯ä»¥åŸºäºå†…æ ¸è¿½è¸ªæŠ€æœ¯ï¼ˆæ¯”å¦‚BPFï¼‰æ¥è‡ªå·±å†™ä¸€ä¸ªã€‚","user_name":"ä½œè€…å›å¤","user_name_real":"å€ªæœ‹é£","uid":"1001282","ctime":1543831617,"ip_address":"","comment_id":45862,"utype":1}],"discussion_count":2,"race_medal":0,"score":"18723674221","product_id":100020901,"comment_content":"execsnoopè¿™ä¸ªå·¥å…·åœ¨centosé‡Œæ‰¾ä¸åˆ°ï¼Œæœ‰ç±»ä¼¼çš„ä»£æ›¿å“å—","like_count":4,"discussions":[{"author":{"id":1001282,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/47/42/5b55bd1a.jpg","nickname":"å€ªæœ‹é£","note":"","ucode":"F0FAC195CDE7AC","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":431243,"discussion_content":"ç‚¹å‡»é“¾æ¥åˆ°githubä¸Šã€‚\n\nå®Œå…¨ä¸€æ ·çš„å·¥å…·åº”è¯¥æ²¡æœ‰ï¼Œä½†å¯ä»¥åŸºäºå†…æ ¸è¿½è¸ªæŠ€æœ¯ï¼ˆæ¯”å¦‚BPFï¼‰æ¥è‡ªå·±å†™ä¸€ä¸ªã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1543831617,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":1,"child_discussions":[{"author":{"id":3065276,"avatar":"","nickname":"Geek_b3b8da","note":"","ucode":"5461CD95B1D764","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":1001282,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/47/42/5b55bd1a.jpg","nickname":"å€ªæœ‹é£","note":"","ucode":"F0FAC195CDE7AC","race_medal":0,"user_type":2,"is_pvip":false},"discussion":{"id":591496,"discussion_content":"æ²¡æœ‰å¤§ä½¬ä½ è¿™ä¸ªæ°´å¹³å»å†™ï¼Œåªèƒ½ç”¨ç°æˆçš„å·¥å…·","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1666599411,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":431243,"ip_address":"æµ™æ±Ÿ"},"score":591496,"extra":""}]}]},{"had_liked":false,"id":66316,"user_name":"bruceding","can_delete":false,"product_type":"c1","uid":1024057,"ip_address":"","ucode":"D35A2B05487EAE","user_header":"https://static001.geekbang.org/account/avatar/00/0f/a0/39/ddcf26ac.jpg","comment_is_top":false,"comment_ctime":1549929112,"is_pvip":false,"replies":[{"id":"23703","content":"ğŸ‘ï¼Œè°¢è°¢åˆ†äº«ç»éªŒã€‚ä½¿ç”¨ä½ç‰ˆæœ¬å†…æ ¸çš„ç”¨æˆ·å¯ä»¥è¯•è¯• é“¾æ¥é‡Œé¢çš„ thread-times.stpã€‚","user_name":"ä½œè€…å›å¤","user_name_real":"å€ªæœ‹é£","uid":"1001282","ctime":1550068279,"ip_address":"","comment_id":66316,"utype":1}],"discussion_count":1,"race_medal":0,"score":"14434831000","product_id":100020901,"comment_content":"å¯¹äºå†…æ ¸å‡½æ•°çš„è°ƒè¯•ï¼Œ4.0 çš„å†…æ ¸å¯ä»¥ä½¿ç”¨ eBPF å·¥å…·ï¼Œ2.6 æˆ–è€… 4.0 ä»¥ä¸‹çš„å·¥å…·ï¼Œä½¿ç”¨ systemtapã€‚perf æ˜¯åŸºäºé‡‡æ ·çš„åŸç†ã€‚æœ¬æ–‡çš„ä¾‹å­ execsnoop å¯ä»¥æ›¿æ¢æˆ https:&#47;&#47;sourceware.org&#47;systemtap&#47;SystemTap_Beginners_Guide&#47;threadtimessect.htmlã€‚systemtap ä¸­æ–‡èµ„æ–™æ¯”è¾ƒå°‘ï¼Œæœ¬äººä¹Ÿç¿»è¯‘äº†ç›¸å…³æ–‡æ¡£ï¼Œå‚è€ƒï¼šhttp:&#47;&#47;systemtap.bruceding.com&#47;ã€‚","like_count":3,"discussions":[{"author":{"id":1001282,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/47/42/5b55bd1a.jpg","nickname":"å€ªæœ‹é£","note":"","ucode":"F0FAC195CDE7AC","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":438778,"discussion_content":"ğŸ‘ï¼Œè°¢è°¢åˆ†äº«ç»éªŒã€‚ä½¿ç”¨ä½ç‰ˆæœ¬å†…æ ¸çš„ç”¨æˆ·å¯ä»¥è¯•è¯• é“¾æ¥é‡Œé¢çš„ thread-times.stpã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1550068279,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":52706,"user_name":"dexter","can_delete":false,"product_type":"c1","uid":1315252,"ip_address":"","ucode":"DD51207438FBD6","user_header":"http://thirdwx.qlogo.cn/mmopen/vi_32/PiajxSqBRaEL5xnfuicbtRz4F87AAjZX6oCEjMtYiaIu4iaQichQmy0vEBA6Sumic1RDvUCeuBEqj6iatnt2kENbKYmuw/132","comment_is_top":false,"comment_ctime":1545482800,"is_pvip":false,"discussion_count":3,"race_medal":0,"score":"14430384688","product_id":100020901,"comment_content":"ç¯å¢ƒå·²æ­å»ºå¥½ï¼Œä½†ç°åœ¨ä¸çŸ¥é“æ€ä¹ˆé€šè¿‡githubé“¾æ¥æ¥å®‰è£…execsnoop","like_count":3,"discussions":[{"author":{"id":1069269,"avatar":"https://static001.geekbang.org/account/avatar/00/10/50/d5/73334a95.jpg","nickname":"doos","note":"","ucode":"7C9AF67F90E65C","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":578944,"discussion_content":"git clone  https://github.com/brendangregg/perf-tools æ‹‰ä¸‹æ¥è¿›å…¥ç›®å½•/root/perf-tools/execsnoopæˆ–è€…è®¾ç½®ç¯å¢ƒå˜é‡å³å¯","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1657097189,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1912653,"avatar":"https://wx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTL3OaibxsOia5ZET1iaBsPwDM6NS43lAUTdItqkwZ66fGaaXtjOQYL73IsvY0foscUZlkaZSQPPQNexA/132","nickname":"Yong","note":"","ucode":"0ADA75C5C68619","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":265400,"discussion_content":"execsnoopå°±æ˜¯ä¸ªbashè„šæœ¬ï¼Œå¤åˆ¶å†…å®¹åˆ°æœ¬åœ°ï¼Œç„¶åchmod +x å°±ok","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1589385359,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1031677,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/bd/fd/3f5d5db5.jpg","nickname":"scorpiozj","note":"","ucode":"C66EA76809F9BF","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":4433,"discussion_content":"é“¾æ¥ä¸Šçº§å°±æ˜¯perf-toolsä¸»é¡µï¼Œæœ‰ä¸‹è½½è¯´æ˜ï¼›è„šæœ¬å‘½ä»¤ï¼Œä¸‹è½½å³ç”¨ã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1565417274,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":46049,"user_name":"å­¦ä¹ å­¦ä¹ å†å­¦ä¹ ","can_delete":false,"product_type":"c1","uid":1291177,"ip_address":"","ucode":"7F85F036A150A8","user_header":"https://static001.geekbang.org/account/avatar/00/13/b3/a9/46cbb52f.jpg","comment_is_top":false,"comment_ctime":1543838956,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"14428740844","product_id":100020901,"comment_content":"è€å¸ˆåœ¨æŸæ¥¼çš„å›å¤ä¸­è¯´ strace æ²¡æœ‰ç»Ÿè®¡åŠŸèƒ½ï¼Œè¿™é‡Œæä¸€ä¸‹ï¼Œ-c å¯ä»¥ç»Ÿè®¡æŸ pid çš„ç³»ç»Ÿè°ƒç”¨æ¬¡æ•°ï¼Œä½†ç¡®å®æ²¡æ³•å¯¹æ•´ä¸ªç³»ç»Ÿè¿›è¡Œç»Ÿè®¡ã€‚","like_count":3},{"had_liked":false,"id":45931,"user_name":"å¤œç©ºä¸­æœ€äº®çš„æ˜Ÿ","can_delete":false,"product_type":"c1","uid":1267566,"ip_address":"","ucode":"ADC3E7B6789955","user_header":"https://static001.geekbang.org/account/avatar/00/13/57/6e/b6795c44.jpg","comment_is_top":false,"comment_ctime":1543820981,"is_pvip":false,"replies":[{"id":"16416","content":"ä¹‹å‰çš„é“¾æ¥æœ‰é”™è¯¯ï¼Œå·²ç»ä¿®å¤äº†ï¼Œå¯ä»¥ç‚¹å‡»é“¾æ¥è·³è¿‡å»","user_name":"ä½œè€…å›å¤","user_name_real":"å€ªæœ‹é£","uid":"1001282","ctime":1543830011,"ip_address":"","comment_id":45931,"utype":1}],"discussion_count":1,"race_medal":0,"score":"14428722869","product_id":100020901,"comment_content":"execsnoop<br>è¿™ä¸ªå·¥å…·æ²¡æ‰¾åˆ°","like_count":3,"discussions":[{"author":{"id":1001282,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/47/42/5b55bd1a.jpg","nickname":"å€ªæœ‹é£","note":"","ucode":"F0FAC195CDE7AC","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":431277,"discussion_content":"ä¹‹å‰çš„é“¾æ¥æœ‰é”™è¯¯ï¼Œå·²ç»ä¿®å¤äº†ï¼Œå¯ä»¥ç‚¹å‡»é“¾æ¥è·³è¿‡å»","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1543830011,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":258202,"user_name":"didiè¿ªè¿ª","can_delete":false,"product_type":"c1","uid":1244282,"ip_address":"","ucode":"0FF1C8A5162695","user_header":"https://static001.geekbang.org/account/avatar/00/12/fc/7a/f4dec0b9.jpg","comment_is_top":false,"comment_ctime":1604325256,"is_pvip":false,"discussion_count":1,"race_medal":0,"score":"10194259848","product_id":100020901,"comment_content":"è€å¸ˆï¼Œä¸ºä»€ä¹ˆtopå‘½ä»¤ä¸­çš„%uså¯ä»¥ç»Ÿè®¡åˆ°%80ï¼Œä½†æ˜¯åé¢è¯¦ç»†è¿›ç¨‹ä¿¡æ¯ä¸­å´ç»Ÿè®¡ä¸åˆ°å ç”¨cpuå¤šçš„è¿›ç¨‹å‘¢ï¼Ÿ","like_count":2,"discussions":[{"author":{"id":1226968,"avatar":"https://static001.geekbang.org/account/avatar/00/12/b8/d8/f81b5604.jpg","nickname":"hcyycb","note":"","ucode":"77FF6CA41F9E66","race_medal":0,"user_type":1,"is_pvip":true},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":387241,"discussion_content":"åˆ†äº«ä¸€ä¸‹æˆ‘ä¸ªäººçš„ç†è§£ï¼štopç»Ÿè®¡çš„æ˜¯ç³»ç»Ÿå…¨å±€çš„çŠ¶æ€æŒ‡æ ‡ã€‚å®ƒé»˜è®¤çš„é‡‡æ ·é—´éš”æ˜¯ 3 ç§’ã€‚ä¸Šä¸€èŠ‚è¯¾ï¼Œæœ‰è¯´åˆ°topä¼šç”¨ /proc/stat é‡Œé¢çš„æ•°æ®ï¼Œè®¡ç®—å„ä¸ªç±»å‹çš„CPUæŒ‡æ ‡ã€‚åœ¨ /proc/stat é‡Œéƒ½æœ‰ç´¯è®¡ï¼Œæ‰€ä»¥å¯ä»¥ç»Ÿè®¡åˆ°å…¨å±€çš„çŠ¶æ€â€”â€”CPUçš„ %us æœ‰ 80% è¿™æ ·çš„æ•°æ®ã€‚è€Œä¸‹é¢è¯¦ç»†çš„è¿›ç¨‹ä¿¡æ¯æ˜¯é€šè¿‡ /proc/[PID]/stat è¯»å–çš„ã€‚ä¾‹å¦‚ï¼Œè¿™èŠ‚è¯¾çš„ stress å¯åŠ¨ä¹‹åå¾ˆå¿«å°±æ¶ˆå¤±äº†ï¼Œæ‰€ä»¥ç»Ÿè®¡ä¸åˆ°ã€‚","likes_number":2,"is_delete":false,"is_hidden":false,"ctime":1628066451,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":230564,"user_name":"ç”Ÿæ´»ä¸å¦‚è¯—","can_delete":false,"product_type":"c1","uid":1139515,"ip_address":"","ucode":"FD48EABEEC52B7","user_header":"https://static001.geekbang.org/account/avatar/00/11/63/3b/c5cd68ab.jpg","comment_is_top":false,"comment_ctime":1593419515,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"10183354107","product_id":100020901,"comment_content":"å¦‚æœcpuç”¨æˆ·ç©ºé—´ä½¿ç”¨ç‡éå¸¸é«˜ï¼Œä½†æ˜¯é€šè¿‡topæŸ¥çœ‹åˆæ‰¾ä¸åˆ°cpuå ç”¨é«˜çš„è¿›ç¨‹çš„æ—¶å€™å¯ä»¥è¿™æ ·æ’æŸ¥ï¼š<br>1. é€šè¿‡topå‘½ä»¤æŸ¥çœ‹å½“å‰å¤„äºrunningçŠ¶æ€çš„è¿›ç¨‹æ•°é‡ï¼›<br>2. æ‰¾åˆ°runningè¿›ç¨‹ï¼Œçœ‹æ˜¯å¦æœ‰å¯ç–‘è¿›ç¨‹ï¼›<br>3. é€šè¿‡psæˆ–è€…pidstatæŸ¥çœ‹æ­¤è¿›ç¨‹çš„cpuä½¿ç”¨ç‡ï¼›<br>4. åŒæ—¶æŸ¥çœ‹æ­¤è¿›ç¨‹çš„pidæ˜¯å¦ä¼šç»å¸¸å˜ï¼Œå¦‚æœç»å¸¸å˜ï¼Œé‚£ä¹ˆæ­¤è¿›ç¨‹å¯ä»¥æ˜¯æ²¡æœ‰æ­£å¸¸å¯åŠ¨æˆ–è€…æ˜¯å¼‚å¸¸é€€å‡ºåå¾ªç¯å¯åŠ¨å¯¼è‡´ï¼›<br>5. é€šè¿‡pstreeæŸ¥çœ‹topä¸­æŸ¥åˆ°çš„å¼‚å¸¸è¿›ç¨‹ï¼Œæ‰¾åˆ°ä¸»è¿›ç¨‹ï¼Œç„¶åé€šè¿‡ä¸»è¿›ç¨‹æ¥æ’æŸ¥é—®é¢˜ï¼›<br>6. é€šè¿‡perfå‘½ä»¤æ¥æŸ¥æ‰¾å ç”¨cpuæ—¶é•¿æœ€é«˜çš„è¿›ç¨‹ï¼Œç„¶åæ’æŸ¥å†…éƒ¨å¼‚å¸¸å‡½æ•°ï¼›","like_count":2},{"had_liked":false,"id":116880,"user_name":"kingkang","can_delete":false,"product_type":"c1","uid":1064567,"ip_address":"","ucode":"13E1FC8E51CE4A","user_header":"https://static001.geekbang.org/account/avatar/00/10/3e/77/22843055.jpg","comment_is_top":false,"comment_ctime":1563933936,"is_pvip":false,"replies":[{"id":"43471","content":"çœ‹èµ·æ¥åƒæ˜¯mongodbæ“ä½œæ²¡æœ‰æœ‰æ•ˆåˆ©ç”¨ç¼“å­˜ï¼Œå¯ä»¥è¯•è¯•åˆ†æmongodbçš„æŸ¥è¯¢æ˜¯å¦åˆç†","user_name":"ä½œè€…å›å¤","user_name_real":"å€ªæœ‹é£","uid":"1001282","ctime":1564410337,"ip_address":"","comment_id":116880,"utype":1}],"discussion_count":3,"race_medal":0,"score":"10153868528","product_id":100020901,"comment_content":"å€ªè€å¸ˆä½ å¥½ï¼Œæˆ‘è‡ªå·±ç”¨goå†™äº†ä¸€å¥—å¾®æœåŠ¡æ¡†æ¶ï¼ˆåŸºæœ¬ç½‘ç»œæ¶æ„æ˜¯ ä¸€å°http server+ä¸€å°grpc server +ä¸‰å°mongodb å‰¯æœ¬é›†ç¾¤ï¼‰ï¼›å¦‚æœgrpc serverä¸è°ƒç”¨mongodb æŸ¥è¯¢çš„è¯ï¼Œqpsèƒ½ç¨³å®šåœ¨36000å·¦å³ï¼Œè€Œä¸”å‹æµ‹çš„æ—¶å€™ï¼Œgrpc server çš„cpuä½¿ç”¨ç‡å¤§æ¦‚åœ¨60%å·¦å³ï¼Œå¹³å‡è´Ÿè½½æœ€é«˜ä¸ä¼šè¶…è¿‡2.5ï¼ˆæœåŠ¡å™¨éƒ½æ˜¯å››æ ¸8Gçš„ ï¼‰ã€‚å¦‚æœä¸€æ—¦è°ƒç”¨äº†mongodbæŸ¥è¯¢çš„è¯ï¼Œcpuä½¿ç”¨ç‡åŸºæœ¬éƒ½èƒ½è¾¾åˆ°95%ï¼Œå¹³å‡è´Ÿè½½æœ€é«˜èƒ½åˆ°4.6ï¼Œè€Œqpsä¹Ÿä¸‹é™åˆ°äº†6kå·¦å³ã€‚ä¸¤ç§æƒ…å†µçš„å†…å­˜å·®åˆ«å¹¶ä¸å¤§ï¼Œç³»ç»Ÿå†…å­˜ä¸€ç›´ç»´æŒåœ¨800Mä¸Šä¸‹ã€‚æˆ‘ç”¨è€å¸ˆæ•™çš„æ–¹æ³•ï¼Œmongol db  findæ–¹æ³•cpuå ç”¨è¿‡é«˜ã€‚è¿™ä¸ªæ–¹æ³•å¹¶æ²¡åŠæ³•åšåˆ°è¿›ä¸€æ­¥ä¼˜åŒ–ï¼Œè¯·é—®è€å¸ˆæˆ‘è¿™ä¸ªæ¡†æ¶cpuä½¿ç”¨ç‡è¿‡é«˜çš„æƒ…å†µæ˜¯ä¸æ˜¯å°±æ²¡åŠæ³•è¿›ä¸€æ­¥ä¼˜åŒ–äº†ï¼Ÿå¦å¤–å°±æ˜¯ï¼Œå¦‚æœæˆ‘åœ¨åŠ ä¸€å°grpc server,ä¹Ÿå°±æ˜¯http server è°ƒç”¨ä¸¤ä¸ªgrpc server  å¯¹ç³»ç»Ÿqps å¢åŠ å¹¶ä¸å¤§ï¼Œè¿™æ˜¯ä¸ºä»€ä¹ˆæˆ‘ä¸€ç›´æƒ³ä¸æ˜ç™½ï¼Ÿ","like_count":2,"discussions":[{"author":{"id":1001282,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/47/42/5b55bd1a.jpg","nickname":"å€ªæœ‹é£","note":"","ucode":"F0FAC195CDE7AC","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":459717,"discussion_content":"çœ‹èµ·æ¥åƒæ˜¯mongodbæ“ä½œæ²¡æœ‰æœ‰æ•ˆåˆ©ç”¨ç¼“å­˜ï¼Œå¯ä»¥è¯•è¯•åˆ†æmongodbçš„æŸ¥è¯¢æ˜¯å¦åˆç†","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1564410337,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":2065762,"avatar":"https://static001.geekbang.org/account/avatar/00/1f/85/62/fadf9016.jpg","nickname":"å…‰æš—ç²¾çµ","note":"","ucode":"500D1285D8B6DE","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":291375,"discussion_content":"ä½ è¿™ä¸ªæ˜¯ä¼˜åŒ–æ•°æ®åº“è¯»å†™æ€§èƒ½ï¼Œè¿™ä¸ªå¾—çœ‹æ•°æ®åº“æ“ä½œçš„ä»£ç ï¼Œä¸€å¥ä¸€å¥æ‰¾é—®é¢˜ä¼˜åŒ–äº†ï¼Œè¯»å†™åˆ†ç¦»å‡ºæ¥ã€‚ã€‚ã€‚","likes_number":1,"is_delete":false,"is_hidden":false,"ctime":1594796687,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":2065762,"avatar":"https://static001.geekbang.org/account/avatar/00/1f/85/62/fadf9016.jpg","nickname":"å…‰æš—ç²¾çµ","note":"","ucode":"500D1285D8B6DE","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":291377,"discussion_content":"æœåŠ¡å™¨çš„å¹¶å‘ç“¶é¢ˆéƒ½æ˜¯å¡åœ¨æ•°æ®åº“æ“ä½œä¸Šé¢äº†","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1594796722,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":91138,"user_name":"å°è´_No_7","can_delete":false,"product_type":"c1","uid":1063224,"ip_address":"","ucode":"84C39D64EF04C3","user_header":"https://static001.geekbang.org/account/avatar/00/10/39/38/4c962666.jpg","comment_is_top":false,"comment_ctime":1556876184,"is_pvip":false,"replies":[{"id":"33125","content":"è¯·å‚è€ƒ 14 | ç­”ç–‘ï¼ˆäºŒï¼‰ï¼šå¦‚ä½•ç”¨perfå·¥å…·åˆ†æJavaç¨‹åº","user_name":"ä½œè€…å›å¤","user_name_real":"å€ªæœ‹é£","uid":"1001282","ctime":1557326170,"ip_address":"","comment_id":91138,"utype":1}],"discussion_count":1,"race_medal":0,"score":"10146810776","product_id":100020901,"comment_content":"æœ€åçš„perf -gæœ‰ç–‘é—®ã€‚è¿™é‡Œå¹¶æ²¡æœ‰å±•ç¤ºå‡ºæ˜æ˜¾çš„stresså æ¯”è¾ƒé«˜çš„æƒ…å†µã€‚ç›¸åæ˜¯swapperè¾ƒå¤š, stressçš„å æ¯”å…¶å®åœ¨10%ä¸€ä¸‹ã€‚è¯·é—®è¿™ä¸ªæ€ä¹ˆè§£é‡Š? æˆ‘çœ‹åˆ°åº•ä¸‹ä¹Ÿæœ‰å…¶ä»–æœ‹å‹æœ‰ç±»ä¼¼çš„ç–‘é—®ä½†æ˜¯æ²¡å¾—åˆ°å¾ˆå¥½çš„è§£æã€‚è°¢è°¢å•¦ã€‚  ","like_count":2,"discussions":[{"author":{"id":1001282,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/47/42/5b55bd1a.jpg","nickname":"å€ªæœ‹é£","note":"","ucode":"F0FAC195CDE7AC","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":448824,"discussion_content":"è¯·å‚è€ƒ 14 | ç­”ç–‘ï¼ˆäºŒï¼‰ï¼šå¦‚ä½•ç”¨perfå·¥å…·åˆ†æJavaç¨‹åº","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1557326170,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":72945,"user_name":"åˆ˜éŸ¦è ","can_delete":false,"product_type":"c1","uid":1423328,"ip_address":"","ucode":"7DEE07AEB11973","user_header":"https://static001.geekbang.org/account/avatar/00/15/b7/e0/5fdb9fc2.jpg","comment_is_top":false,"comment_ctime":1551758001,"is_pvip":false,"replies":[{"id":"26744","content":"ä»¥å‰è¿˜çœŸæ²¡æ³¨æ„æœ‰è¿™ä¸ªå‡½æ•°ã€‚æŸ¥äº†ä¸‹ï¼Œè¿™æ˜¯ stress æºç é‡Œé¢çš„å‡½æ•°ï¼Œä½ å¯ä»¥å»çœ‹çœ‹å®ƒçš„æºç ","user_name":"ä½œè€…å›å¤","user_name_real":"å€ªæœ‹é£","uid":"1001282","ctime":1551883532,"ip_address":"","comment_id":72945,"utype":1}],"discussion_count":1,"race_medal":0,"score":"10141692593","product_id":100020901,"comment_content":"æˆ‘çš„perf record é‡Œé¢ random å‡½æ•°è°ƒç”¨å æ¯”ä¸æ˜¯æœ€é«˜çš„, æœ€é«˜çš„æ˜¯ä¸€ä¸ªå«åšhoghdd çš„å‡½æ•°, è¿™ä¸ªå‡½æ•°é‡Œé¢åŒ…å«äº†ä¸€äº›å†…å­˜æ®µé”™è¯¯å’Œæ¢é¡µçš„å‡½æ•°. è¿™ä¸ªæ˜¯ä¸ºä»€ä¹ˆå‘¢? <br>æˆ‘çš„æœºå™¨æ˜¯mac, ç„¶åè¿™ä¸ªæ‰¹æ¬¡çš„mac ssd æ€§èƒ½æœ‰é—®é¢˜, å®˜æ–¹æ›¾ç»ç»™æˆ‘å‘è¿‡è¿”å‚ç»´ä¿®çš„é€šçŸ¥é‚®ä»¶, ä½†æ˜¯å› ä¸ºæ˜¯å…¬å¸çš„ç”µè„‘, æ‰€ä»¥æˆ‘å¹¶æ²¡æœ‰å¼„å»ç»´ä¿®. hog hdd æ˜¯ä¸æ˜¯ å ç”¨hddç¡¬ç›˜çš„æ„æ€å‘¢?<br><br>-   57.30%     0.03%  stress           stress                    [.] main                                                                                                                                  â–’<br>   - main                                                                                                                                                                                                  â–’<br>      + 21.77% hoghdd                                                                                                                                                                                      â–’<br>      + 16.12% random_r                                                                                                                                                                                    â–’<br>      + 12.09% random                                                                                                                                                                                      â–’","like_count":2,"discussions":[{"author":{"id":1001282,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/47/42/5b55bd1a.jpg","nickname":"å€ªæœ‹é£","note":"","ucode":"F0FAC195CDE7AC","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":441839,"discussion_content":"ä»¥å‰è¿˜çœŸæ²¡æ³¨æ„æœ‰è¿™ä¸ªå‡½æ•°ã€‚æŸ¥äº†ä¸‹ï¼Œè¿™æ˜¯ stress æºç é‡Œé¢çš„å‡½æ•°ï¼Œä½ å¯ä»¥å»çœ‹çœ‹å®ƒçš„æºç ","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1551883532,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":48061,"user_name":"å¼ å¾·","can_delete":false,"product_type":"c1","uid":1101929,"ip_address":"","ucode":"31FE63E8725EFC","user_header":"https://static001.geekbang.org/account/avatar/00/10/d0/69/5dbdc245.jpg","comment_is_top":false,"comment_ctime":1544338014,"is_pvip":false,"replies":[{"id":"17289","content":"æ²¡æƒ³åˆ°ä¸“æ è¿˜å¸¦åŠ¨å¤§å®¶å­¦ä¹ dockeräº†ğŸ˜Š","user_name":"ä½œè€…å›å¤","user_name_real":"å€ªæœ‹é£","uid":"1001282","ctime":1544437063,"ip_address":"","comment_id":48061,"utype":1}],"discussion_count":1,"race_medal":0,"score":"10134272606","product_id":100020901,"comment_content":"æ¯å¤©éƒ½åœ¨è¿›æ­¥  çœ‹æ¥å¾—å¥½å¥½ç†Ÿæ‚‰dockeräº†  æ‰“å¡æ‰“å¡","like_count":2,"discussions":[{"author":{"id":1001282,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/47/42/5b55bd1a.jpg","nickname":"å€ªæœ‹é£","note":"","ucode":"F0FAC195CDE7AC","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":432013,"discussion_content":"æ²¡æƒ³åˆ°ä¸“æ è¿˜å¸¦åŠ¨å¤§å®¶å­¦ä¹ dockeräº†ğŸ˜Š","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1544437063,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":46265,"user_name":"kakasir","can_delete":false,"product_type":"c1","uid":1316615,"ip_address":"","ucode":"21F9742D3E63B3","user_header":"https://static001.geekbang.org/account/avatar/00/14/17/07/83f030c9.jpg","comment_is_top":false,"comment_ctime":1543890998,"is_pvip":false,"discussion_count":1,"race_medal":0,"score":"10133825590","product_id":100020901,"comment_content":"å› ä¸ºå¼€æ”¾é¢æ¯”è¾ƒçª„ï¼Œè€å¸ˆåé¢æåˆ°çš„ä¸€äº›phpï¼Œdockerï¼Œngixéƒ½æ¯”è¾ƒé™Œç”Ÿï¼Œæ–°çš„è™šæ‹Ÿæœºç¯å¢ƒéƒ½éœ€è¦å®‰è£…ï¼Œæ“ä½œèµ·æ¥å°±å›°éš¾é‡é‡ï¼Œä¸è¿‡ç¡®å®èƒ½é€šè¿‡æ¡ˆä¾‹é¢†ä¼šè§£å†³é—®é¢˜çš„æ€è·¯ï¼Œè¿˜æ˜¯ä¼šåšæŒä¸‹å»","like_count":2,"discussions":[{"author":{"id":2291160,"avatar":"https://static001.geekbang.org/account/avatar/00/22/f5/d8/121e4b68.jpg","nickname":"Woa ğŸ¤","note":"","ucode":"6033F496082F3B","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":553285,"discussion_content":"ç›¸å¿…ç°åœ¨ä¹Ÿæ˜¯å¤§ç‰›äº†ğŸ®","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1645804687,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":228318,"user_name":"Thomas.Wu","can_delete":false,"product_type":"c1","uid":1433711,"ip_address":"","ucode":"9B8980EE4FE08C","user_header":"https://static001.geekbang.org/account/avatar/00/15/e0/6f/aef2e3ce.jpg","comment_is_top":false,"comment_ctime":1592640292,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"5887607588","product_id":100020901,"comment_content":"è†œæ‹œå¤§ç¥ï¼Œè®²çš„ç¡®å®ä¸é”™","like_count":1},{"had_liked":false,"id":126851,"user_name":"é¥­ç²’","can_delete":false,"product_type":"c1","uid":1153455,"ip_address":"","ucode":"4C3220B0D43997","user_header":"https://static001.geekbang.org/account/avatar/00/11/99/af/d29273e2.jpg","comment_is_top":false,"comment_ctime":1566490492,"is_pvip":false,"replies":[{"id":"47197","content":"ğŸ˜Š","user_name":"ä½œè€…å›å¤","user_name_real":"å€ªæœ‹é£","uid":"1001282","ctime":1566742982,"ip_address":"","comment_id":126851,"utype":1}],"discussion_count":1,"race_medal":0,"score":"5861457788","product_id":100020901,"comment_content":"è¿™ç§å®æ“æ¡ˆä¾‹çœŸæ˜¯å¤ªèµäº†ã€‚","like_count":1,"discussions":[{"author":{"id":1001282,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/47/42/5b55bd1a.jpg","nickname":"å€ªæœ‹é£","note":"","ucode":"F0FAC195CDE7AC","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":464202,"discussion_content":"ğŸ˜Š","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1566742982,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":113493,"user_name":"å­™å¿—åš","can_delete":false,"product_type":"c1","uid":1206306,"ip_address":"","ucode":"338B3218553440","user_header":"https://static001.geekbang.org/account/avatar/00/12/68/22/b9eb397f.jpg","comment_is_top":false,"comment_ctime":1563031410,"is_pvip":false,"replies":[{"id":"41985","content":"ğŸ˜Š","user_name":"ä½œè€…å›å¤","user_name_real":"å€ªæœ‹é£","uid":"1001282","ctime":1563457334,"ip_address":"","comment_id":113493,"utype":1}],"discussion_count":1,"race_medal":0,"score":"5857998706","product_id":100020901,"comment_content":"ç¡®å®é‡åˆ°äº†ç¬¬1ç§æƒ…å†µçš„é—®é¢˜ï¼Œä½¿ç”¨äº†æ­¤è§£å†³æ–¹æ¡ˆï¼Œç‚¹èµ","like_count":1,"discussions":[{"author":{"id":1001282,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/47/42/5b55bd1a.jpg","nickname":"å€ªæœ‹é£","note":"","ucode":"F0FAC195CDE7AC","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":458248,"discussion_content":"ğŸ˜Š","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1563457334,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":81918,"user_name":"Silver bullet","can_delete":false,"product_type":"c1","uid":1145022,"ip_address":"","ucode":"5FE5FEC8DC56AF","user_header":"https://static001.geekbang.org/account/avatar/00/11/78/be/7bf3f1b0.jpg","comment_is_top":false,"comment_ctime":1554082553,"is_pvip":false,"replies":[{"id":"29841","content":"ç¬¬11ç¯‡æœ‰è®²åˆ°è¿™äº›","user_name":"ä½œè€…å›å¤","user_name_real":"å€ªæœ‹é£","uid":"1001282","ctime":1554210393,"ip_address":"","comment_id":81918,"utype":1}],"discussion_count":1,"race_medal":0,"score":"5849049849","product_id":100020901,"comment_content":"è€æ˜¯æ‚¨å¥½ çœ‹äº†6ç¯‡æ–‡ç« å­¦äº†ä¸å°‘å·¥å…·  ä¹Ÿè·Ÿç€é‡Œé¢çš„æ¡ˆä¾‹è”ç³»äº†  ä½†æ˜¯æœ‰äº›ä¸å¸¸ç”¨çš„å·¥å…·å®¹æ˜“å¿˜  æ¯”å¦‚vmstat å‰å¤©å­¦çš„ ä»Šå¤©å°±å¿˜äº†  æœ‰æ²¡æœ‰ä»€ä¹ˆåŠæ³•è®°ä½æ‰€å­¦è¿‡çš„å·¥å…·å‘¢ï¼Ÿ","like_count":1,"discussions":[{"author":{"id":1001282,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/47/42/5b55bd1a.jpg","nickname":"å€ªæœ‹é£","note":"","ucode":"F0FAC195CDE7AC","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":445390,"discussion_content":"ç¬¬11ç¯‡æœ‰è®²åˆ°è¿™äº›","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1554210393,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":80557,"user_name":"Geek_32a1cf","can_delete":false,"product_type":"c1","uid":1203854,"ip_address":"","ucode":"319DDD9BAB6772","user_header":"http://thirdwx.qlogo.cn/mmopen/vi_32/ajNVdqHZLLDC4cj2XKjHPNdOiaZR6oxeO36umdW8cnuW0YfyKCfpia883ib4RheBicuL2TPhMY14HQ7e7Dl4Zvhd8w/132","comment_is_top":false,"comment_ctime":1553681555,"is_pvip":false,"replies":[{"id":"29323","content":"è¿™å°±æ˜¯è¦åˆ†æçš„äº†","user_name":"ä½œè€…å›å¤","user_name_real":"å€ªæœ‹é£","uid":"1001282","ctime":1553697213,"ip_address":"","comment_id":80557,"utype":1}],"discussion_count":1,"race_medal":0,"score":"5848648851","product_id":100020901,"comment_content":"è€å¸ˆï¼Œæœ‰ä¸ªç–‘é—®ï¼Œå’±ä»¬è®¨è®ºçš„éƒ½æ˜¯æœ‰é—®é¢˜å¯¼è‡´äº†cpuä½¿ç”¨ç‡è¾ƒé«˜çš„æƒ…å†µï¼Œé‚£æ€ä¹ˆåˆ¤æ–­æ˜¯ç¨‹åºæœ¬èº«è°ƒç”¨å°±éœ€è¦å¤§é‡çš„è€—è´¹cpuï¼ˆä¾‹å¦‚ç¨‹åºçº¯è®¡ç®—ï¼‰è¿˜æ˜¯è¯´ç¨‹åºæœ‰é—®é¢˜æ‰å¯¼è‡´äº†cpuçš„å‡é«˜å‘¢","like_count":1,"discussions":[{"author":{"id":1001282,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/47/42/5b55bd1a.jpg","nickname":"å€ªæœ‹é£","note":"","ucode":"F0FAC195CDE7AC","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":444902,"discussion_content":"è¿™å°±æ˜¯è¦åˆ†æçš„äº†","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1553697213,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":79420,"user_name":"rm -rf ğŸ˜Šà½²","can_delete":false,"product_type":"c1","uid":1070908,"ip_address":"","ucode":"BC448EC4206D95","user_header":"https://static001.geekbang.org/account/avatar/00/10/57/3c/081b89ec.jpg","comment_is_top":false,"comment_ctime":1553479792,"is_pvip":false,"replies":[{"id":"29034","content":"å—¯ æœ‰å¯èƒ½æ˜¯çŸ­æ—¶è¿›ç¨‹","user_name":"ä½œè€…å›å¤","user_name_real":"å€ªæœ‹é£","uid":"1001282","ctime":1553525450,"ip_address":"","comment_id":79420,"utype":1}],"discussion_count":1,"race_medal":0,"score":"5848447088","product_id":100020901,"comment_content":"æƒ³è¯·æ•™ä¸€ä¸‹è€å¸ˆï¼Œrunningè¿›ç¨‹çªç„¶å˜å¤šï¼Œçªç„¶å˜å°‘çš„ï¼Œæ˜¯ä»€ä¹ˆæƒ…å†µï¼Œä¸»è¦æ˜¯çŸ­æ—¶è¿›ç¨‹çš„é—®é¢˜å—ï¼Ÿ","like_count":1,"discussions":[{"author":{"id":1001282,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/47/42/5b55bd1a.jpg","nickname":"å€ªæœ‹é£","note":"","ucode":"F0FAC195CDE7AC","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":444494,"discussion_content":"å—¯ æœ‰å¯èƒ½æ˜¯çŸ­æ—¶è¿›ç¨‹","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1553525450,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":59618,"user_name":"Windï½","can_delete":false,"product_type":"c1","uid":1335448,"ip_address":"","ucode":"C72A7DE7DB21DB","user_header":"https://static001.geekbang.org/account/avatar/00/14/60/98/b519a361.jpg","comment_is_top":false,"comment_ctime":1547392903,"is_pvip":false,"replies":[{"id":"21517","content":"å…¨æ˜¯16è¿›åˆ¶çš„ç¬¦å·ï¼Œè¯·å‚è€ƒæ€§èƒ½ç­”ç–‘ç¯‡æŸ¥çœ‹è§£å†³æ–¹æ³•","user_name":"ä½œè€…å›å¤","user_name_real":"å€ªæœ‹é£","uid":"1001282","ctime":1547447648,"ip_address":"","comment_id":59618,"utype":1}],"discussion_count":1,"race_medal":0,"score":"5842360199","product_id":100020901,"comment_content":"ä¹‹å‰ç»™è€å¸ˆç•™è¨€çš„é—®é¢˜å·²ç»è‡ªå·±æå®šäº†ï¼Œåœ¨åç»­çš„å®éªŒä¸­æˆ‘å‘ç°æˆ‘çš„å®éªŒæœ‰äº›ä¸å¤ªä¸€æ ·ï¼Œè¿˜æ˜¯å¸Œæœ›è€å¸ˆçœ‹åˆ°åå¯ä»¥å†æŒ‡ç‚¹ä¸€äºŒï¼Œè€å¸ˆçš„pså’Œpidstatéƒ½æ²¡æœ‰è¾“å‡ºï¼Œè€Œæˆ‘çš„åˆ™æ˜¯æœ‰è¾“å‡ºï¼Œä½†æ˜¯åˆ†æçš„ç»“æœå¯¼å‘æ˜¯ä¸€è‡´çš„â€”â€”çº¿ç´¢éƒ½æŒ‡å‘äº†stress<br><br>----é€šè¿‡pidstat<br>[wind@aaa ~]$ pidstat -p 39945<br>Linux 3.10.0-862.el7.x86_64 (aaa)     2019å¹´01æœˆ14æ—¥     _x86_64_    (1 CPU)<br><br>06æ—¶31åˆ†09ç§’   UID       PID    %usr %system  %guest    %CPU   CPU  Command<br>06æ—¶31åˆ†09ç§’     1     89962    0.00    0.00    0.00    0.00     0  php-fpm<br>[wind@aaa ~]$ <br><br>----é€šè¿‡ps aux<br>[wind@aaa ~]$ ps aux | grep 39945<br>bin       39945  1.3  0.7 336684  7688 pts&#47;2    S+   06:36   0:01 php-fpm: pool www<br>wind      54077  0.0  0.0 112704   664 pts&#47;3    R+   06:38   0:00 grep --color=auto 39945<br>[wind@aaa ~]$ <br><br>----å†é€šè¿‡ps -efl<br>[wind@aaa ~]$ ps -lef | grep 121267<br>0 S bin       58233 121267  0  80   0 -  1070 do_wai 07:00 pts&#47;2    00:00:00 sh -c &#47;usr&#47;local&#47;bin&#47;stress -t 1 -d 1 2&gt;&amp;1<br>0 S wind      58250  42935  0  80   0 - 28180 pipe_w 07:00 pts&#47;3    00:00:00 grep --color=auto 121267<br>5 S bin      121267  75443  1  80   0 - 84171 pipe_w 06:52 pts&#47;2    00:00:06 php-fpm: pool www<br><br>----ä½†æ˜¯æˆ‘çš„å®éªŒä¸­æœ‰äº›ä¸åŒçš„åœ°æ–¹æ˜¯ï¼Œphp-fpmçš„äº¬åŸå¹¶ä¸ä¼šå‘ç”Ÿæ”¹å˜ä½†æ˜¯åŸºæœ¬ä¸Šéƒ½å¤„äºSçŠ¶æ€å¾ˆå°‘ä¼šæœ‰RçŠ¶æ€å‡ºç°ï¼Œä½†æ˜¯å¦‚æœå‡ºç°RçŠ¶æ€çš„è¯ï¼Œé‚£ä¹ˆåœ¨è¿‡0.5ç§’åï¼Œå°±å¿…ç„¶ä¼šå‡ºç°ä¸€ä¸ªZè¿›ç¨‹<br>----å¹¶ä¸”åœ¨åç»­çš„perf report ä¸­å æ¯”æœ€é«˜çš„ä¹Ÿæ²¡æœ‰randomå‡½æ•°<br>-   66.20%     0.00%  stress           stress                          [.] 0x000000000000168d                                       â–’<br>   - 0x168d                                                                                                                         â–’<br>      - 5.49% 0x2f25                                                                                                                â–’<br>         - 3.75% 0xffffffffba116768                                                                                                 â–’<br>            - 3.74% 0xffffffffba11a925                                                                                              â–’<br>               - 2.94% 0xffffffffba11a597","like_count":1,"discussions":[{"author":{"id":1001282,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/47/42/5b55bd1a.jpg","nickname":"å€ªæœ‹é£","note":"","ucode":"F0FAC195CDE7AC","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":436367,"discussion_content":"å…¨æ˜¯16è¿›åˆ¶çš„ç¬¦å·ï¼Œè¯·å‚è€ƒæ€§èƒ½ç­”ç–‘ç¯‡æŸ¥çœ‹è§£å†³æ–¹æ³•","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1547447648,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":46505,"user_name":"î…Œ","can_delete":false,"product_type":"c1","uid":1187469,"ip_address":"","ucode":"B4A70F7D96BECF","user_header":"https://static001.geekbang.org/account/avatar/00/12/1e/8d/4239f463.jpg","comment_is_top":false,"comment_ctime":1543931150,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"5838898446","product_id":100020901,"comment_content":"400%cpu  150%user   3%nice  119%sys   127%idle  0% iow  0%irq  1%  sirq 0%host <br>PID    USER    PR   NI   VIRT   RES    SHR  S[%CPU] %MEM   TIME+ARGS<br>4149  system  10  -10 1.8G    176M  113M   141        6.4         7:13.67<br>4127   root      20   0     0        0         0          98.3        0            7:23.93<br>è€å¸ˆä½ å¥½ï¼Œæ¿å¡ä¸Šlinux ç³»ç»Ÿå¥½å¤šå·¥å…·æ— æ³•ä½¿ç”¨ï¼Œåªèƒ½ç”¨topæŸ¥çœ‹CPUä½¿ç”¨ç‡å¾ˆé«˜ï¼Œ<br>uptime  load average:  9.26  4.37  1.70  <br><br>ç›®å‰åˆ†æåˆ° ç”¨æˆ·ç©ºé—´å ç”¨CPUæ¯”è¾ƒé«˜ï¼Œå†…æ ¸æ€çš„CPUå ç”¨ä¹Ÿæ¯”è¾ƒé«˜ã€‚æœ‰æ²¡æœ‰ä»€ä¹ˆå¯ä»¥è¿›ä¸€æ­¥åˆ†æçš„å·¥å…·æˆ–æ–¹æ³•å—ï¼Ÿæ„Ÿè°¢","like_count":1},{"had_liked":false,"id":46381,"user_name":"é˜¿æˆï¼ˆMatthewï¼‰","can_delete":false,"product_type":"c1","uid":1315901,"ip_address":"","ucode":"935985DD00A1F6","user_header":"https://static001.geekbang.org/account/avatar/00/14/14/3d/70764fdc.jpg","comment_is_top":false,"comment_ctime":1543911918,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"5838879214","product_id":100020901,"comment_content":"å¦‚æœä¸€ä¸ªçº¿ç¨‹å¤„äºioçŠ¶æ€ï¼Œç­‰å¾…ç½‘ç»œresponseï¼Œé‚£ä¹ˆ è¿™ä¸ªçº¿ç¨‹ã€‚ä¼šè¢«cpuè°ƒåº¦çš„æ—¶å€™è°ƒç”¨ä¹ˆï¼Ÿè¿˜æ˜¯ç­‰åˆ°responseæœ‰æ•°æ®çš„æ—¶å€™ï¼Œæ‰ä¼šè¢«è°ƒåº¦åˆ°ï¼Ÿ","like_count":1},{"had_liked":false,"id":46112,"user_name":"mj4ever","can_delete":false,"product_type":"c1","uid":1005549,"ip_address":"","ucode":"73028E537099CC","user_header":"https://static001.geekbang.org/account/avatar/00/0f/57/ed/d50de13c.jpg","comment_is_top":false,"comment_ctime":1543848770,"is_pvip":true,"discussion_count":0,"race_medal":0,"score":"5838816066","product_id":100020901,"comment_content":"æ•´ç†ä¸‹ä»Šå¤©å­¦åˆ°çš„çŸ¥è¯†ï¼š<br>1ã€é‡åˆ°CPUä½¿ç”¨ç‡é«˜ï¼Œä½†åˆæ— æ³•é€šè¿‡topå®šä½åˆ°æŸä¸ªè¿›ç¨‹æ—¶ï¼Œå°±éœ€è¦è€ƒè™‘æ˜¯å¦æ˜¯çŸ­æ—¶åº”ç”¨æ‰€å¯¼è‡´ï¼Œå¦‚ï¼š<br>ï¼ˆ1ï¼‰åº”ç”¨æœ¬èº«é—®é¢˜ï¼Œå¯¼è‡´åå¤é‡å¯<br>ï¼ˆ2ï¼‰åº”ç”¨é€šè¿‡execè°ƒç”¨äº†å…¶ä»–äºŒè¿›åˆ¶ç¨‹åºï¼Œè¿™äº›ç¨‹åºè¿è¡Œæ—¶é—´åˆæ¯”è¾ƒçŸ­<br>2ã€ä½¿ç”¨topå·¥å…·æŸ¥çœ‹CPUæ—¶ï¼Œè¿˜éœ€è¦åŒæ—¶å…³æ³¨ä¸‹å…¶ä»–å‚æ•°ï¼Œæ¯”å¦‚ï¼Œè¿è¡Œçš„è¿›ç¨‹æ•°<br>3ã€å¯¹perfå·¥å…·æœ‰äº†è¿‘ä¸€æ­¥çš„å®æ“ï¼›åç»­å¯ä»¥åˆ‡æ¢åˆ°Ubuntuå†è¯•ä¸‹ï¼Œæœ‰æœºä¼šéœ€è¦çœ‹ä¸‹The<br>Flame Graph<br>4ã€execsnoopè½¬ä¸ºçŸ­æ—¶ç¨‹åºè®¾è®¡çš„å·¥å…·ï¼Œé€šè¿‡ftraceæ¥å®æ—¶ç›‘æ§exec()çš„è¡Œä¸ºï¼›<br>5ã€æ¥ç€å®æ“çš„æœºä¼šï¼Œé¡ºä¾¿æ¸©ä¹ äº†ä¸‹dockerçš„ä¸€äº›ç®€å•å‘½ä»¤ã€‚","like_count":1},{"had_liked":false,"id":45944,"user_name":"9527","can_delete":false,"product_type":"c1","uid":1032735,"ip_address":"","ucode":"04B51C09E3C7B8","user_header":"https://static001.geekbang.org/account/avatar/00/0f/c2/1f/343f2dec.jpg","comment_is_top":false,"comment_ctime":1543823426,"is_pvip":false,"replies":[{"id":"16413","content":"straceå¯ä»¥è·Ÿè¸ªç³»ç»Ÿè°ƒç”¨ï¼Œä½†æ²¡æœ‰ç»Ÿè®¡åŠŸèƒ½ã€‚è¦è·Ÿè¸ªçš„è¯éœ€è¦ä½¿ç”¨åŠ¨æ€è¿½è¸ªå·¥å…·ï¼Œæ¯”å¦‚bcc&#47;BPFã€systemtap ç­‰","user_name":"ä½œè€…å›å¤","user_name_real":"å€ªæœ‹é£","uid":"1001282","ctime":1543829690,"ip_address":"","comment_id":45944,"utype":1}],"discussion_count":1,"race_medal":0,"score":"5838790722","product_id":100020901,"comment_content":"å¦‚æœæ˜¯çŸ­æ—¶é—´å†…æœ‰å¤§é‡è¿›ç¨‹åœ¨ä¸æ–­é‡å¯ï¼Œæ¯ç§’çš„forkè°ƒç”¨åº”è¯¥å¾ˆå¤šï¼Œå¦‚æœèƒ½ç›‘æ§åˆ°ä¸€æ®µå†…éƒ½è°ƒç”¨äº†å“ªäº›ç³»ç»Ÿå‡½æ•°ï¼ŒåŒæ ·çš„é—®é¢˜åº”è¯¥ä¹Ÿèƒ½å…ˆå‡ºæ¥å§ï¼Œæœ‰è¿™æ ·çš„æŸ¥çœ‹ä¸€æ®µæ—¶é—´å†…ç³»ç»Ÿå‡½æ•°è°ƒç”¨æƒ…å†µçš„å·¥å…·å—ï¼Ÿ","like_count":1,"discussions":[{"author":{"id":1001282,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/47/42/5b55bd1a.jpg","nickname":"å€ªæœ‹é£","note":"","ucode":"F0FAC195CDE7AC","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":431283,"discussion_content":"straceå¯ä»¥è·Ÿè¸ªç³»ç»Ÿè°ƒç”¨ï¼Œä½†æ²¡æœ‰ç»Ÿè®¡åŠŸèƒ½ã€‚è¦è·Ÿè¸ªçš„è¯éœ€è¦ä½¿ç”¨åŠ¨æ€è¿½è¸ªå·¥å…·ï¼Œæ¯”å¦‚bcc/BPFã€systemtap ç­‰","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1543829690,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":45750,"user_name":"Johnson","can_delete":false,"product_type":"c1","uid":1225037,"ip_address":"","ucode":"55B582953E49F3","user_header":"https://static001.geekbang.org/account/avatar/00/12/b1/4d/10c75b34.jpg","comment_is_top":false,"comment_ctime":1543768708,"is_pvip":false,"replies":[{"id":"16296","content":"æœ€å¥½æ˜¯å…ˆåšæ€§èƒ½åˆ†æï¼Œæ‰¾å‡ºNginxçš„ç“¶é¢ˆä¹‹åå†ä¼˜åŒ–","user_name":"ä½œè€…å›å¤","user_name_real":"å€ªæœ‹é£","uid":"1001282","ctime":1543794326,"ip_address":"","comment_id":45750,"utype":1}],"discussion_count":1,"race_medal":0,"score":"5838736004","product_id":100020901,"comment_content":"æ›¾ç»ç¢°åˆ°CPUåˆ©ç”¨ç‡å¾ˆé«˜ï¼Œä¹ŸçŸ¥é“æ˜¯nginxé€ æˆçš„ï¼Œæ•´ä¸ªå›¢é˜Ÿéƒ½åœ¨ä¼˜åŒ–ï¼Œæ•ˆæœä¸ç†æƒ³å•Š","like_count":1,"discussions":[{"author":{"id":1001282,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/47/42/5b55bd1a.jpg","nickname":"å€ªæœ‹é£","note":"","ucode":"F0FAC195CDE7AC","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":431191,"discussion_content":"æœ€å¥½æ˜¯å…ˆåšæ€§èƒ½åˆ†æï¼Œæ‰¾å‡ºNginxçš„ç“¶é¢ˆä¹‹åå†ä¼˜åŒ–","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1543794326,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":360494,"user_name":"Geek_b3b8da","can_delete":false,"product_type":"c1","uid":3065276,"ip_address":"æµ™æ±Ÿ","ucode":"5461CD95B1D764","user_header":"","comment_is_top":false,"comment_ctime":1666602113,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1666602113","product_id":100020901,"comment_content":"æˆ‘çº¿ä¸Šæœ‰ä¸€å°æœåŠ¡å™¨çš„suæ˜¯åƒµå°¸è¿›ç¨‹è€Œä¸”åœ¨ä¸æ–­çš„æ­»æ‰å¯åŠ¨ï¼Œæˆ‘é€šè¿‡execsnoop å’Œpstree perfæ‰¾åˆ°é‚£ä¸ªç¨‹åºåå­—äº†ï¼Œå› ä¸ºshellè„šæœ¬ä¸æ˜¯æˆ‘å†™çš„å¯¼è‡´æ— æ³•æ‰¾åˆ°æ˜¯é‚£ä¸ªç¨‹åºè°ƒç”¨äº†suä¸€ç›´åœ¨é‡å¯ï¼Œè€Œä¸”ç”¨execsnoop æŸ¥çœ‹è¿›ç¨‹å¤ªå¤šäº†å¾ˆéš¾åˆ¤æ–­å“ªäº›ç¨‹åºåœ¨ä¸æ–­çš„æ›´æ¢pidå·","like_count":0},{"had_liked":false,"id":352374,"user_name":"é¾è¦","can_delete":false,"product_type":"c1","uid":1000076,"ip_address":"","ucode":"BE1D500833F070","user_header":"https://static001.geekbang.org/account/avatar/00/0f/42/8c/373d4027.jpg","comment_is_top":false,"comment_ctime":1658593960,"is_pvip":true,"discussion_count":0,"race_medal":0,"score":"1658593960","product_id":100020901,"comment_content":"execsnoop åœ¨ CentOS-8.5&#47;Rocky-8.6 ï¼ˆkernel 4.18ï¼‰æœªèƒ½æ˜¾ç¤ºçŸ­æ—¶è¿›ç¨‹ï¼Œæ ¹æ® execsnoop æ–‡ä»¶ä¸­çš„è¯´æ˜ï¼Œåº”è¯¥æ˜¯ä¸æ”¯æŒæ¯”è¾ƒæ–°çš„å†…æ ¸çš„<br>https:&#47;&#47;github.com&#47;brendangregg&#47;perf-tools&#47;blob&#47;master&#47;execsnoop#L22:L23<br>This implementation is designed to work on older kernel versions, and without kernel debuginfo.","like_count":0},{"had_liked":false,"id":342227,"user_name":"Peter","can_delete":false,"product_type":"c1","uid":2425556,"ip_address":"","ucode":"5E57A0FE948966","user_header":"https://static001.geekbang.org/account/avatar/00/25/02/d4/1e0bb504.jpg","comment_is_top":false,"comment_ctime":1650114743,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1650114743","product_id":100020901,"comment_content":"CPU å‡é«˜æ˜¯çŸ­æ—¶è¿›ç¨‹ stress å¯¼è‡´çš„  æƒ³é—®ä¸‹çŸ­æ—¶è¿›ç¨‹æ˜¯ä»€ä¹ˆæ„æ€çš„å•Šï¼Ÿ","like_count":0},{"had_liked":false,"id":340584,"user_name":"ç½—æ°","can_delete":false,"product_type":"c1","uid":1320487,"ip_address":"","ucode":"96BAFAA147341F","user_header":"https://static001.geekbang.org/account/avatar/00/14/26/27/eba94899.jpg","comment_is_top":false,"comment_ctime":1648954394,"is_pvip":false,"discussion_count":0,"race_medal":2,"score":"1648954394","product_id":100020901,"comment_content":"C++ æ¸¸æˆæœåŠ¡å™¨ï¼Œæ¯ä¸ªè¿›ç¨‹ä¸Šå¤§æ¦‚æœ‰ä¸€åƒç”¨æˆ·çš„æ—¶å€™ï¼ŒCPU å°±è¾¾åˆ°äº† 100%ï¼Œæ‰¾ä¸åˆ°åŸå› ã€‚ç”¨æœ€ç¬¨çš„æ–¹æ³•ï¼ŒåŠ æ—¥å¿—çœ‹é‚£ä¸ªå‡½æ•°è°ƒç”¨æœ€è€—æ—¶ï¼Œæœ€åå‘ç°æ˜¯åœ¨ä¸€ä¸ªé«˜é¢‘æ¬¡çš„è°ƒç”¨å‡½æ•°ä¸­å¤„ç†ä¼šéœ€è¦å‡ ç™¾æ¯«ç§’ã€‚ç»è¿‡ä¸€ç•ªåˆ†æï¼ŒåŸæ¥æ˜¯ C++11 auto æƒ¹çš„ç¥¸ï¼ˆä¹Ÿä¸èƒ½å…¨æ€ª autoï¼‰ï¼Œauto ä¸€æ—¶çˆ½ï¼Œä½†æ˜¯æ²¡æœ‰æ„è¯†åˆ°æ­¤å¤„æ˜¯æœ‰å¾ˆå¤§çš„æ‹·è´æˆæœ¬ï¼Œå¹¶éæ‹·è´äº†æŒ‡é’ˆï¼ˆæ­£ç¡®çš„æ“ä½œå°±åº”è¯¥æ˜¯æ‹·è´æŒ‡é’ˆï¼Œè€Œä¸æ˜¯æ‹·è´è¿™ä¸€å—å†…å­˜ï¼‰ï¼Œè€Œè¿™å—å†…å­˜å¤§æ¦‚åœ¨ 50KB å·¦å³ã€‚ä¿®å¤å®Œä¹‹åï¼Œå•ä¸ªæœåŠ¡çš„æ”¯æŒçš„ç”¨æˆ·è¶…è¿‡ 5000ï¼ŒCPU éƒ½æ²¡è¶…è¿‡ 50%ã€‚","like_count":0},{"had_liked":false,"id":338002,"user_name":"æ™ºè€…å¤æœ«","can_delete":false,"product_type":"c1","uid":2598358,"ip_address":"","ucode":"0CFAB842980A93","user_header":"https://static001.geekbang.org/account/avatar/00/27/a5/d6/41967892.jpg","comment_is_top":false,"comment_ctime":1647227876,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1647227876","product_id":100020901,"comment_content":"å¯¹è€å¸ˆè®²è§£å’ŒåŒå­¦ä»¬çš„å®è·µç»å†é¡¶ç¤¼è†œæ‹œï¼Œè‡ªå·±è¿˜éœ€è¦åŠ å¼ºå®è·µå’Œå­¦ä¹ ç†è§£å•¦","like_count":0},{"had_liked":false,"id":332050,"user_name":"HelloBug","can_delete":false,"product_type":"c1","uid":1249598,"ip_address":"","ucode":"E61A4AD5C2F724","user_header":"https://static001.geekbang.org/account/avatar/00/13/11/3e/925aa996.jpg","comment_is_top":false,"comment_ctime":1642995714,"is_pvip":true,"discussion_count":0,"race_medal":0,"score":"1642995714","product_id":100020901,"comment_content":"è€å¸ˆï¼Œå¯¹äºå®æ—¶äº§ç”Ÿçš„è¿›ç¨‹ï¼Œä¸çŸ¥é“å…¶PIDä¿¡æ¯ï¼Œè¯¥è¿›ç¨‹åœ¨å¯åŠ¨ä¹‹åï¼ŒCPUé£™å‡å¤§æ¦‚1ç§’ç„¶åé™ä½ï¼Œè¿™ç§å¦‚ä½•å®šä½å‘¢ï¼Ÿ","like_count":0},{"had_liked":false,"id":318895,"user_name":"ğŸ‰æ™¶æ™¶ğŸ‰ğŸ˜„","can_delete":false,"product_type":"c1","uid":1169422,"ip_address":"","ucode":"76B608C42E06A8","user_header":"https://static001.geekbang.org/account/avatar/00/11/d8/0e/1bf7f57a.jpg","comment_is_top":false,"comment_ctime":1635475378,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1635475378","product_id":100020901,"comment_content":"centosä¸‹æ„å»ºphp-fpmçš„é•œåƒæ—¶è¿è¡Œä¸äº†RUN apt-get update &amp;&amp; apt-get install -y stress &amp;&amp; apt-get cleanï¼Œå¤§å®¶æ€ä¹ˆè§£å†³çš„å‘¢ï¼Ÿ","like_count":0},{"had_liked":false,"id":309828,"user_name":"å’•å’•å’•","can_delete":false,"product_type":"c1","uid":1319375,"ip_address":"","ucode":"E939C1FD951235","user_header":"https://static001.geekbang.org/account/avatar/00/14/21/cf/f47e092d.jpg","comment_is_top":false,"comment_ctime":1630365566,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1630365566","product_id":100020901,"comment_content":"æ‰“å¡","like_count":0},{"had_liked":false,"id":309748,"user_name":"Geek_5227ac","can_delete":false,"product_type":"c1","uid":1607208,"ip_address":"","ucode":"8C468F5C45696E","user_header":"http://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTKiay65IMyD82E59Xnbp370ChMG3N9XQuXoKwfhZJ19zotzKMlJhwzBDxE61bp26jdkf54NY9L41yg/132","comment_is_top":false,"comment_ctime":1630319588,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1630319588","product_id":100020901,"comment_content":"$ docker run --name nginx -p 10000:80 -itd feisky&#47;nginx:sp<br>$ docker run --name phpfpm -itd --network container:nginx feisky&#47;php-fpm:sp<br>è€å¸ˆï¼Œç°åœ¨è¿™é‡Œçš„é•œåƒç°åœ¨æ‹‰ä¸ä¸‹æ¥äº†ï¼Œåœ°å€å˜æ›´äº†å—ï¼Ÿ","like_count":0},{"had_liked":false,"id":305572,"user_name":"Geek_aef4be","can_delete":false,"product_type":"c1","uid":2723576,"ip_address":"","ucode":"F1C3F2AE3CCA0F","user_header":"https://thirdwx.qlogo.cn/mmopen/vi_32/DYAIOgq83epxppZUun6eqepI5hGHjU3fP8yVIicUq7gYRZfR3PoDCMQqd2ia8CmCSa1mIIf6OYGFjbW28RCXmrJQ/132","comment_is_top":false,"comment_ctime":1628052903,"is_pvip":false,"discussion_count":1,"race_medal":0,"score":"1628052903","product_id":100020901,"comment_content":"æˆ‘ä¹‹å‰é‡åˆ°è¿‡CPUï¼…çš„æƒ…å†µã€‚é€šè¿‡pså‘½ä»¤ä¸€ä¸‹å°±æ‰¾åˆ°äº†å¼‚å¸¸è¿›ç¨‹ï¼ˆåæ¥æ‰çŸ¥é“æ˜¯æŒ–çŸ¿ç¨‹åºï¼‰ï¼Œç„¶åæŠŠä»–killæ‰ï¼Œä½†æ˜¯è¿‡äº†ä¸€ä¼šè¿™ä¸ªè¿›ç¨‹åˆè‡ªåŠ¨å¯åŠ¨ï¼Œç„¶åå°±å®šä½åˆ°è¿™ä¸ªè¿›ç¨‹æ‰€åœ¨æ–‡ä»¶ï¼ŒæŠŠæ–‡ä»¶åˆ æ‰ï¼Œä»¥ä¸ºå°±ä¸‡äº‹å¤§å‰äº†ï¼Œç»“æœè¿‡äº†ä¸€ä¼šåˆå¯åŠ¨äº†ï¼Œå½“æ—¶æ‡µé€¼äº†ã€‚æ²¡åŠæ³•ï¼Œç™¾åº¦ï¼Œæ‰å‘ç°æ˜¯æŒ–çŸ¿ç¨‹åºï¼Œä¹‹æ‰€ä»¥æ–‡ä»¶åˆ æ‰è¿˜èƒ½å¯åŠ¨ï¼Œæ˜¯å› ä¸ºè¿˜æœ‰ä¸€ä¸ªå®ˆæŠ¤è¿›ç¨‹å†ç›‘æ§ï¼Œä¸€æ—¦è¿›ç¨‹è¢«killï¼Œä»–å°±åœ¨å¯åŠ¨ï¼Œè¿›ç¨‹æ–‡ä»¶è¢«åˆ ï¼Œå°±è‡ªåŠ¨å»ä¸‹è½½ï¼Œç„¶åå†æ‰§è¡Œè¿™ä¸ªè¿›ç¨‹è„šæœ¬ã€‚è€ŒæœåŠ¡å™¨ä¹‹æ‰€ä»¥è¢«é»‘ï¼Œå°±æ˜¯å› ä¸ºredisæœåŠ¡æ²¡æœ‰è®¾ç½®å¯†ç ï¼Œé€šè¿‡redisæŒæ¡äº†ç³»ç»Ÿæ§åˆ¶æƒ","like_count":0,"discussions":[{"author":{"id":1129668,"avatar":"https://static001.geekbang.org/account/avatar/00/11/3c/c4/7c2bf312.jpg","nickname":"è‰æ ¹","note":"","ucode":"7C97CB09A4D8F1","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":540214,"discussion_content":"å¤–ç½‘å¯ä»¥ç›´æ¥è®¿é—®redisï¼Ÿ","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1639992311,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":298908,"user_name":"æ„šå…¬ç§»å±±","can_delete":false,"product_type":"c1","uid":1487110,"ip_address":"","ucode":"395029049DCFFC","user_header":"https://static001.geekbang.org/account/avatar/00/16/b1/06/de844599.jpg","comment_is_top":false,"comment_ctime":1624365787,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1624365787","product_id":100020901,"comment_content":"å‰é¢æˆ‘ä»¬è®²åˆ°è¿‡ï¼Œabï¼ˆapache benchï¼‰æ˜¯ä¸€ä¸ªå¸¸ç”¨çš„ HTTP æœåŠ¡æ€§èƒ½æµ‹è¯•å·¥å…·ï¼Œè¿™é‡ŒåŒæ ·ç”¨æ¥æ¨¡æ‹Ÿ Nginx çš„å®¢æˆ·ç«¯ã€‚ç”±äº Nginx å’Œ PHP çš„é…ç½®æ¯”è¾ƒéº»çƒ¦ï¼Œæˆ‘æŠŠå®ƒä»¬æ‰“åŒ…æˆäº†ä¸¤ä¸ª Docker é•œåƒï¼Œè¿™æ ·åªéœ€è¦è¿è¡Œä¸¤ä¸ªå®¹å™¨ï¼Œå°±å¯ä»¥å¾—åˆ°æ¨¡æ‹Ÿç¯å¢ƒ  --è¿™ä¸ªéœ€è¦ä¸‹è½½å—?å¦‚ä½•è¿è¡Œè¿™ä¸ªé•œåƒ<br><br>$ docker run --name nginx -p 10000:80 -itd feisky&#47;nginx:sp<br>$ docker run --name phpfpm -itd --network container:nginx feisky&#47;php-fpm:sp è¿™ä¸¤ä¸ªå‘½ä»¤ä¾èµ–ä»€ä¹ˆæ–‡ä»¶å—?æˆ‘å·²ç»åœ¨gitä¸‹æ¥åŸæ–‡ä»¶äº†ï¼Œä½†ä¸å¦‚ä½•ä½¿ç”¨ï¼Ÿ<br>","like_count":0},{"had_liked":false,"id":298735,"user_name":"æ„šå…¬ç§»å±±","can_delete":false,"product_type":"c1","uid":1487110,"ip_address":"","ucode":"395029049DCFFC","user_header":"https://static001.geekbang.org/account/avatar/00/16/b1/06/de844599.jpg","comment_is_top":false,"comment_ctime":1624282253,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1624282253","product_id":100020901,"comment_content":"è€å¸ˆä½ å¥½ï¼Œä¸ºä»€ä¹ˆæˆ‘ç¬¬äºŒæ¬¡è¿è¡Œè¿™ä¸ªå®¹å™¨ï¼Œè¿è¡Œä¸äº†root@100ask:&#47;home&#47;book#  docker run --name nginx -p 10000:80 -itd feisky&#47;nginx:sp<br>docker: Error response from daemon: Conflict. The container name &quot;&#47;nginx&quot; is already in use by container &quot;058dd0f37aa9db1297c4c0b51bb693a5cb8c4b843ffbb82855d5dd2620563031&quot;. You have to remove (or rename) that container to be able to reuse that name.<br>","like_count":0},{"had_liked":false,"id":297596,"user_name":"ywz","can_delete":false,"product_type":"c1","uid":2401841,"ip_address":"","ucode":"A93F43B3506FA9","user_header":"https://static001.geekbang.org/account/avatar/00/24/a6/31/0242f7d6.jpg","comment_is_top":false,"comment_ctime":1623659255,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1623659255","product_id":100020901,"comment_content":"è€å¸ˆï¼Œè¯·é—®ä¸‹perfæŠ“å‡ºæ¥çš„ç«ç„°å›¾ï¼Œç”¨æˆ·ç©ºé—´æ‰¾ä¸åˆ°ç›¸åº”çš„æ ˆå›æº¯å¯èƒ½æ˜¯ä»€ä¹ˆåŸå› å¯¼è‡´çš„ï¼Ÿ","like_count":0},{"had_liked":false,"id":293826,"user_name":"dyh","can_delete":false,"product_type":"c1","uid":2039139,"ip_address":"","ucode":"4E20FDA64495C2","user_header":"https://static001.geekbang.org/account/avatar/00/1f/1d/63/35c38c6c.jpg","comment_is_top":false,"comment_ctime":1621566468,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1621566468","product_id":100020901,"comment_content":"execsnoop è¿™ç§æœ‰ç”¨çš„å·¥å…·æ€ä¹ˆåœ¨åµŒå…¥å¼è®¾å¤‡ä¸Šä½¿ç”¨","like_count":0},{"had_liked":false,"id":290180,"user_name":"Heaven","can_delete":false,"product_type":"c1","uid":1694207,"ip_address":"","ucode":"FA33FBCC66C911","user_header":"https://static001.geekbang.org/account/avatar/00/19/d9/ff/b23018a6.jpg","comment_is_top":false,"comment_ctime":1619420243,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1619420243","product_id":100020901,"comment_content":"ä¹‹å‰æ›¾ç»å‡ºè¿‡cpuè¿‡é«˜çš„é—®é¢˜,ä½¿ç”¨å¯¹åº”çš„topå‘½ä»¤ç¡®å®šæ˜¯jarè¿è¡Œå,åˆ©ç”¨pså‘½ä»¤ç¡®å®šäº†æ˜¯å“ªä¸ªjaråŒ…,å¹¶ä½¿ç”¨jmapè·å–åˆ°äº†ç›¸å…³çš„å †æ ˆä¿¡æ¯,åˆ†æåå‘ç°æ˜¯æ–°å¼€çº¿ç¨‹æ²¡æœ‰åˆç†å›æ”¶å¯¼è‡´çš„","like_count":0},{"had_liked":false,"id":289586,"user_name":"August","can_delete":false,"product_type":"c1","uid":1538486,"ip_address":"","ucode":"72A0CB0C74CD35","user_header":"https://static001.geekbang.org/account/avatar/00/17/79/b6/98834766.jpg","comment_is_top":false,"comment_ctime":1619090271,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1619090271","product_id":100020901,"comment_content":"è€å¸ˆï¼Œcentos6 ä¸€å°64æ ¸cpuï¼Œ256gå†…å­˜ï¼Œå¤šä¸ªkworkerå’Œmigrationä¸¤ä¸ªç³»ç»Ÿè¿›ç¨‹å cpu ç™¾åˆ†ç™¾ï¼Œä¼šæ˜¯ä»€ä¹ˆé—®é¢˜å‘¢ï¼Ÿ","like_count":0},{"had_liked":false,"id":284765,"user_name":"æµ·ä¸¹ä¸¹","can_delete":false,"product_type":"c1","uid":2412456,"ip_address":"","ucode":"4901931CC85521","user_header":"https://static001.geekbang.org/account/avatar/00/24/cf/a8/6f511f02.jpg","comment_is_top":false,"comment_ctime":1616463899,"is_pvip":false,"discussion_count":1,"race_medal":0,"score":"1616463899","product_id":100020901,"comment_content":"æƒ³è®°å½•ä¸€ä¸‹æœ€è¿‘é‡åˆ°çš„é—®é¢˜ï¼Œå¾ˆå¤šå¼€å‘æ¿ä¸Šçš„ç³»ç»Ÿæ˜¯è£å‡è¿‡çš„ï¼Œåœ¨åˆ©ç”¨Perfåšæµ‹è¯•æ—¶ä¹Ÿä¼šé‡åˆ°å¥½å¤šé—®é¢˜ã€‚æ¯”å¦‚symbolåªæ˜¾ç¤º åœ°å€ä¸æ˜¾ç¤ºå‡½æ•°åï¼Œ è¿˜æœ‰ä¸€äº›åŠŸèƒ½ä¸å…¨ã€‚æƒ³åŠæ³•è§£å†³ä¸­ã€‚ã€‚","like_count":0,"discussions":[{"author":{"id":3065276,"avatar":"","nickname":"Geek_b3b8da","note":"","ucode":"5461CD95B1D764","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":591495,"discussion_content":"å‚è€ƒåœ°å€https://www.cnblogs.com/luoahong/p/10833689.html","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1666599087,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":"æµ™æ±Ÿ"},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":284763,"user_name":"æµ·ä¸¹ä¸¹","can_delete":false,"product_type":"c1","uid":2412456,"ip_address":"","ucode":"4901931CC85521","user_header":"https://static001.geekbang.org/account/avatar/00/24/cf/a8/6f511f02.jpg","comment_is_top":false,"comment_ctime":1616463736,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1616463736","product_id":100020901,"comment_content":"ä»Šå¤©é‡åˆ°äº†é—®é¢˜ï¼ŒåµŒå…¥å¼å¼€å‘æ¿ä¸Šæ²¡æœ‰pstreeï¼Œå…¶å®æˆ‘ä¹ŸçŸ¥é“æˆ‘ä»¬çš„è½¯ä»¶æ¨¡å—åº•ä¸‹ï¼Œæœ‰500ä¸ªå·¦å³å­çº¿ç¨‹ï¼Œä½†è¿˜æ˜¯æƒ³è¯•ä¸€ä¸‹pstreeã€‚äºæ˜¯ä¸‹è½½äº†psmiscçš„ä»£ç åŒ…ï¼Œäº¤å‰ç¼–è¯‘æˆLSB elfï¼Œä¹‹å‰æ¯æ¬¡ç¼–è¯‘æ—¶æ‰§è¡Œautoreconf --ifvä¼šå¯¼è‡´æœ€ç»ˆç¼–å‡ºæ¥çš„åŒ…ï¼Œä¸å¯çŸ¥æ€§ï¼Œçº¯å¹²çªçœ¼ã€‚ ä¸æ•²è¿™æ¡å°±OKã€‚è¿˜æ²¡å»æŸ¥ã€‚<br><br>anywayï¼Œè·Ÿç€è¯¾ç¨‹å­¦çš„å¾ˆå¼€å¿ƒ~~","like_count":0},{"had_liked":false,"id":256866,"user_name":"å¿—å¼º","can_delete":false,"product_type":"c1","uid":1141536,"ip_address":"","ucode":"1C5DC9C7D70A82","user_header":"https://static001.geekbang.org/account/avatar/00/11/6b/20/004af747.jpg","comment_is_top":false,"comment_ctime":1603768575,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1603768575","product_id":100020901,"comment_content":"è€å¸ˆå’Œå„ä½å¤§ç¥ä»¬ï¼Œè¯·é—®æœ‰ä»€ä¹ˆæ–¹å¼å¯ä»¥çœ‹åˆ°cpuå®æ—¶åœ¨å¤„ç†çš„ä»»åŠ¡æ•°é‡(linuxç³»ç»Ÿ)","like_count":0},{"had_liked":false,"id":253655,"user_name":"Geek_f702be","can_delete":false,"product_type":"c1","uid":1143067,"ip_address":"","ucode":"8E3B5F393C4266","user_header":"http://thirdwx.qlogo.cn/mmopen/vi_32/DYAIOgq83epumnXjMLYzHkGFhAraIiaAMXpotuUR9PCexBWl25tRLFAvpzs03Hfse4Y1lyeWuryz6z80Fd8AXiaw/132","comment_is_top":false,"comment_ctime":1602819764,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1602819764","product_id":100020901,"comment_content":"æ‰“å¡<br>ç¢°åˆ°æ— æ³•è§£é‡Šçš„cpué«˜é—®é¢˜ï¼Œæƒ³æƒ³æ˜¯ä¸æ˜¯çŸ­æ—¶è¿›ç¨‹å¯¼è‡´<br>è¿™ä¸ªæ—¶å€™ç”¨topã€vmstataã€pidstatå°±æ‰¾ä¸åˆ°é—®é¢˜æ ¹æº<br>å¯ä»¥è€ƒè™‘pstreeæŸ¥çœ‹ä¸‹è¿›ç¨‹æ ‘ï¼Œç”¨perfæˆ–è€…execsnoopæ¥è®°å½•åˆ†æçŸ­æ—¶è¿›ç¨‹","like_count":0},{"had_liked":false,"id":252976,"user_name":"ming","can_delete":false,"product_type":"c1","uid":2084718,"ip_address":"","ucode":"FF2C74CBA5E7BC","user_header":"https://static001.geekbang.org/account/avatar/00/1f/cf/6e/366a8247.jpg","comment_is_top":false,"comment_ctime":1602552390,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1602552390","product_id":100020901,"comment_content":"perf topæ˜¯å¦åªèƒ½åœ¨linuxå‘è¡Œç‰ˆä¸Šä½¿ç”¨ï¼Œå¦‚æœæ˜¯å¼€å‘æ¿ï¼Œæ˜¯å¦ä¹Ÿå¯ä»¥é€šè¿‡perf topå»æ’æŸ¥é—®é¢˜","like_count":0},{"had_liked":false,"id":242913,"user_name":"Geek_8c2731","can_delete":false,"product_type":"c1","uid":1928194,"ip_address":"","ucode":"A87F938209D65A","user_header":"http://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTJkGGBK46EQpqE6zWCncMs14Jw95s191Y6pk3x3gQpNrvSc2YWoFEgUxmJWicibGp7XsFFKaZxuTSnA/132","comment_is_top":false,"comment_ctime":1597891108,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1597891108","product_id":100020901,"comment_content":"æ˜¯æˆ‘æµ‹è¯•çš„æœåŠ¡å™¨æ€§èƒ½å¤ªå¼ºäº†ä¹ˆï¼Ÿ å’‹å‹æ ¹æ²¡æŠŠå®ƒå½“å›äº‹æƒ…ï¼Œè´Ÿè½½ä¸é«˜ï¼Œstressè¿›ç¨‹æ²¡çœ‹åˆ°ï¼Œphp-fpm topä¸­ä¹Ÿæ²¡å‘ç°","like_count":0},{"had_liked":false,"id":240935,"user_name":"ğŸ®","can_delete":false,"product_type":"c1","uid":2112298,"ip_address":"","ucode":"3FAD9EA59E1713","user_header":"https://static001.geekbang.org/account/avatar/00/20/3b/2a/f05e546a.jpg","comment_is_top":false,"comment_ctime":1597125851,"is_pvip":true,"discussion_count":1,"race_medal":0,"score":"1597125851","product_id":100020901,"comment_content":"å€ªè€å¸ˆï¼Œæˆ‘è¿™è¾¹æœ‰ä¸ªç°è±¡ï¼Œpidstståˆ†æå‡ºæŸä¸ªçº¿ç¨‹å CPUå¾ˆé«˜ï¼Œä½†ä½¿ç”¨perfå»åˆ†æè¿™ä¸ªçº¿ç¨‹æ˜¯é‡Œé¢çƒ­ç‚¹å‡½æ•°æ²¡æœ‰å¾ˆé«˜çš„ï¼Œæœ€é«˜ä¹Ÿå°±3.5è¿™ä¸ªåº”è¯¥æ€ä¹ˆç»§ç»­åˆ†æå•Š","like_count":0,"discussions":[{"author":{"id":2112298,"avatar":"https://static001.geekbang.org/account/avatar/00/20/3b/2a/f05e546a.jpg","nickname":"ğŸ®","note":"","ucode":"3FAD9EA59E1713","race_medal":0,"user_type":1,"is_pvip":true},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":298132,"discussion_content":"ä½¿ç”¨perf recordè®°å½•åˆ†æä¹Ÿæ²¡æœ‰æ˜æ˜¾åé«˜çš„çƒ­ç‚¹å‡½æ•°","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1597201710,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":237274,"user_name":"Geek_e92fa6","can_delete":false,"product_type":"c1","uid":2015094,"ip_address":"","ucode":"36EE2386861098","user_header":"http://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTL3FmianZ3EBmffWJFZkJ1VjLUWPIOKCicdblsg0Z37eGWajZ77JoM9WM5kN7zUpCoicMkSo4fgSM5KQ/132","comment_is_top":false,"comment_ctime":1595763888,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1595763888","product_id":100020901,"comment_content":"æˆ‘æŒ‰ç…§è€å¸ˆçš„æ­¥éª¤è¯•äº†ä¸€ä¸‹ï¼Œå‘ç°topå¹¶çœ‹ä¸åˆ°stressè¿›ç¨‹çš„ä¿¡æ¯ï¼Œå¯èƒ½è¿˜æ˜¯è¦é€šè¿‡topå’Œpstreeç»¼åˆçœ‹ä¸‹è§‰å¾—æœ‰é—®é¢˜çš„è¿›ç¨‹çš„å§ï¼Œçœ‹æ¥å®é™…åº”ç”¨ä¸­çš„é—®é¢˜è¿˜è¦å¤æ‚å¾—å¤šã€‚","like_count":0},{"had_liked":false,"id":236640,"user_name":"J.Smile","can_delete":false,"product_type":"c1","uid":1336475,"ip_address":"","ucode":"C4D98DFDBF7584","user_header":"https://static001.geekbang.org/account/avatar/00/14/64/9b/0b578b08.jpg","comment_is_top":false,"comment_ctime":1595488135,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1595488135","product_id":100020901,"comment_content":"æ€»ç»“ï¼š<br>â€» PIDä¸€ç›´åœ¨å˜çš„åŸå› ï¼š<br>â‘  è¿›ç¨‹ä¸åœå´©æºƒé‡å¯<br>â‘¡åº”ç”¨å†…éƒ¨é€šè¿‡execè°ƒç”¨çš„å¤–éƒ¨å‘½ä»¤ï¼ŒçŸ­æ—¶é—´å°±ç»“æŸï¼Œæ˜¯çŸ­æ—¶è¿›ç¨‹ã€‚<br><br>â€» æŸ¥æ‰¾çŸ­æ—¶è¿›ç¨‹çš„çˆ¶è¿›ç¨‹ï¼špstree | grep [procname]<br>â€» çŸ­æ—¶è¿›ç¨‹ç›‘æ§å·¥å…·execsnoopï¼š<br>execsnoop å°±æ˜¯ä¸€ä¸ªä¸“ä¸ºçŸ­æ—¶è¿›ç¨‹è®¾è®¡çš„å·¥å…·ã€‚å®ƒé€šè¿‡ ftrace å®æ—¶ç›‘æ§è¿›ç¨‹çš„ exec() è¡Œä¸ºï¼Œå¹¶è¾“å‡ºçŸ­æ—¶è¿›ç¨‹çš„åŸºæœ¬ä¿¡æ¯ï¼ŒåŒ…æ‹¬è¿›ç¨‹ PIDã€çˆ¶è¿›ç¨‹ PIDã€å‘½ä»¤è¡Œå‚æ•°ä»¥åŠæ‰§è¡Œçš„ç»“æœ","like_count":0},{"had_liked":false,"id":232325,"user_name":"Ryoma","can_delete":false,"product_type":"c1","uid":1130590,"ip_address":"","ucode":"7F692369239692","user_header":"https://static001.geekbang.org/account/avatar/00/11/40/5e/b8fada94.jpg","comment_is_top":false,"comment_ctime":1593958123,"is_pvip":true,"discussion_count":0,"race_medal":2,"score":"1593958123","product_id":100020901,"comment_content":"top æ—¶çœ‹ä¸åˆ° stress è¿›ç¨‹è®°å½•ï¼ŒåŠ ä¸Š i ä¹Ÿçœ‹ä¸åˆ°ã€‚è¿™æ˜¯ä¸ºä»€ä¹ˆå‘¢ï¼Ÿåªçœ‹åˆ° kworker æˆ– ksoftirqd åœ¨ running","like_count":0},{"had_liked":false,"id":230272,"user_name":"æŸæ£®æ£®","can_delete":false,"product_type":"c1","uid":1285420,"ip_address":"","ucode":"F370AD99BA71B9","user_header":"https://static001.geekbang.org/account/avatar/00/13/9d/2c/6248ffbd.jpg","comment_is_top":false,"comment_ctime":1593332629,"is_pvip":false,"discussion_count":1,"race_medal":0,"score":"1593332629","product_id":100020901,"comment_content":"ç”¨çš„æ˜¯ubuntu16.04,ç„¶ååˆ¶ä½œmake buildçš„æ—¶å€™æŠ¥é”™äº†ï¼Œstandard_init_linux.go:211 exec user process caused &quot;exec format error&quot;ï¼Œåº”è¯¥æ€ä¹ˆè§£å†³ï¼Ÿ<br>å¦å¤–dockerIä¸‹è½½çš„è¯ï¼Œéœ€è¦åœ¨hub.dockerä¸Šé¢æ³¨å†Œä¸€ä¸ªè´¦å·å—ï¼Ÿ","like_count":0,"discussions":[{"author":{"id":3065276,"avatar":"","nickname":"Geek_b3b8da","note":"","ucode":"5461CD95B1D764","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":591494,"discussion_content":"åˆ‡æ¢dockerçš„åŠ é€Ÿå™¨åœ°å€ä¸ºé˜¿é‡Œå°±okäº†","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1666598817,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":"æµ™æ±Ÿ"},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":226035,"user_name":"Trident","can_delete":false,"product_type":"c1","uid":1609530,"ip_address":"","ucode":"53E6788CF33398","user_header":"https://thirdwx.qlogo.cn/mmopen/vi_32/l4nngwyggBGqeMXC0micwO8bM1hSttgQXa1Y5frJSqWa8NibDhia5icwPcHM5wOpV3hfsf0UicDY0ypFqnQ3iarG0T1w/132","comment_is_top":false,"comment_ctime":1591932543,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1591932543","product_id":100020901,"comment_content":"é‡åˆ°è¿‡ç›¸åŒçš„é—®é¢˜ï¼ŒCPUé£™é«˜ï¼Œå„ä¸ªè¿›ç¨‹å ç”¨æ¯”è¾ƒå°‘","like_count":0},{"had_liked":false,"id":224404,"user_name":"ç«¹æ—","can_delete":false,"product_type":"c1","uid":1006947,"ip_address":"","ucode":"60E76BCE7AFE2C","user_header":"https://static001.geekbang.org/account/avatar/00/0f/5d/63/25fbd0be.jpg","comment_is_top":false,"comment_ctime":1591370028,"is_pvip":true,"discussion_count":0,"race_medal":0,"score":"1591370028","product_id":100020901,"comment_content":"è€å¸ˆï¼Œæˆ‘æƒ³é—®ä¸‹ï¼Œè¦æ˜¯ä¸€å°LinuxæœåŠ¡å™¨cpuä¼šå¶å°”æŠ–åŠ¨ä¸€ä¸‹ï¼Œç§’çº§ç›‘æ§(1s)èƒ½çœ‹åˆ°cpuæœ‰ä¸ªå³°å€¼ï¼Œä¸é¢‘ç¹ï¼Œä¸€å¤©å¯èƒ½å°±å‡ºç°ä¸€ä¸¤æ¬¡æ²¡æœ‰è§„å¾‹ï¼Œç”¨top -d 1 æŠ“ä¸åˆ°ï¼Œç”¨excesnoopç”±äºè¿›ç¨‹å¤šï¼Œæ¯æ—¶æ¯åˆ»éƒ½ä¼šæ‰“å‡ºæ¥å¾ˆå¤šè¿›ç¨‹ä¹Ÿä¸å¥½æ‰¾ã€‚è¿™ç§è¦å¦‚ä½•å®šä½æ˜¯å“ªä¸ªè¿›ç¨‹å¯¼è‡´çš„å‘¢ï¼Ÿæœ‰ä»€ä¹ˆå¥½åŠæ³•å—ï¼Ÿ","like_count":0},{"had_liked":false,"id":219999,"user_name":"é˜¿é£","can_delete":false,"product_type":"c1","uid":1298046,"ip_address":"","ucode":"F8B1FC8521264D","user_header":"http://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTKZicicibGibtR5zAia782Ajc5I5BN3F3tjAdlibATIknHv67gbxeH21N7B6vbgwLjYb1miaLKhqicptB5ibYw/132","comment_is_top":false,"comment_ctime":1590133628,"is_pvip":false,"discussion_count":1,"race_medal":0,"score":"1590133628","product_id":100020901,"comment_content":"åœ¨æˆ‘çš„ç¯å¢ƒ(centos7.5)é‡Œä½¿ç”¨topæ— æ³•çœ‹åˆ°stressè¿›ç¨‹ï¼Œå…¶æ¬¡dockerä¸»æœºé‡Œæ— æ³•å®‰è£…linux-toolsã€‚è™½ç„¶åœ¨å®¿ä¸»æœºä¸Šæ‰§è¡Œper record 1åˆ†é’Ÿåï¼Œå†ç”¨perf reportåˆ†æä¹Ÿèƒ½çœ‹åˆ°stressè°ƒç”¨å ç”¨æ¯”ç‡å¾ˆé«˜ï¼Œä½†æ—¢ç„¶èƒ½é€šè¿‡bindfsçš„æ–¹å¼æŠŠdockerè¿›ç¨‹çš„ç”¨æˆ·ç©ºé—´æŒ‚è½½åˆ°ç›®å½•ä¸­ä½¿ç”¨perf reportæ¥åˆ†æï¼ˆhttps:&#47;&#47;www.cnblogs.com&#47;luoahong&#47;p&#47;10833689.htmlï¼‰ï¼Œæ˜¯å¦æœ‰åˆ«çš„æ–¹æ³•å¯ä»¥æŠŠdockerè¿›ç¨‹çš„è°ƒç”¨é“¾å’Œç¯å¢ƒä¹Ÿæ˜ å°„åˆ°å®¿ä¸»æœºæ¥åˆ†æå‘¢","like_count":0,"discussions":[{"author":{"id":3065276,"avatar":"","nickname":"Geek_b3b8da","note":"","ucode":"5461CD95B1D764","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":591493,"discussion_content":"å‚è€ƒè¿™ä¸ªhttps://www.cnblogs.com/luoahong/p/10833689.html","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1666598777,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":"æµ™æ±Ÿ"},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":217012,"user_name":"Yong","can_delete":false,"product_type":"c1","uid":1912653,"ip_address":"","ucode":"0ADA75C5C68619","user_header":"https://wx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTL3OaibxsOia5ZET1iaBsPwDM6NS43lAUTdItqkwZ66fGaaXtjOQYL73IsvY0foscUZlkaZSQPPQNexA/132","comment_is_top":false,"comment_ctime":1589385177,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1589385177","product_id":100020901,"comment_content":"æ‰“å¡ï¼šç¢°åˆ°éå¸¸è§„çš„cpuä½¿ç”¨ç‡è¾ƒé«˜çš„é—®é¢˜æ—¶ï¼Œä½¿ç”¨pstree å’Œexecsnoop åˆ†æä¸€ä¸‹","like_count":0},{"had_liked":false,"id":212970,"user_name":"ray","can_delete":false,"product_type":"c1","uid":1717235,"ip_address":"","ucode":"10962C711CBC11","user_header":"","comment_is_top":false,"comment_ctime":1588250888,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1588250888","product_id":100020901,"comment_content":"è€å¸ˆæ‚¨å¥½ï¼Œ<br>æˆ‘åœ¨ubuntu 18.04, kernelç‰ˆæœ¬ 5.3.0-51-genericï¼Œä½¿ç”¨execsnoopæ²¡æœ‰åŠæ³•é¡ºåˆ©æŠ“åˆ°stressã€‚è¯·é—®å¯ä»¥æ€ä¹ˆè§£å†³è¯¥é—®é¢˜å‘¢ï¼Ÿ<br><br>è°¢è°¢è€å¸ˆçš„è§£ç­”ï¼","like_count":0},{"had_liked":false,"id":204609,"user_name":"ç”°æŒ¯å®‡","can_delete":false,"product_type":"c1","uid":1127162,"ip_address":"","ucode":"668341D1B4D9AF","user_header":"https://static001.geekbang.org/account/avatar/00/11/32/fa/990a6a58.jpg","comment_is_top":false,"comment_ctime":1586428919,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1586428919","product_id":100020901,"comment_content":"æ‰§è¡Œexecsnoopï¼Œè¾“å‡ºå†…å®¹ï¼š<br>Tracing exec()s. Ctrl-C to end.<br>Instrumenting do_execve<br>   PID   PPID ARGS<br><br>ç„¶åå°±æ²¡æœ‰å…¶ä»–ä¿¡æ¯äº†ï¼Œä¸ºå•¥åˆ«äººçš„æˆªå›¾éƒ½èƒ½çœ‹åˆ°è¿›ç¨‹ä¿¡æ¯ï¼Ÿ<br>","like_count":0},{"had_liked":false,"id":183886,"user_name":"sierlu","can_delete":false,"product_type":"c1","uid":1449460,"ip_address":"","ucode":"3CBAB057E90FDA","user_header":"","comment_is_top":false,"comment_ctime":1583154858,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1583154858","product_id":100020901,"comment_content":"è€å¸ˆï¼ŒæœåŠ¡å™¨ä¸­éƒ¨ç½²äº†å‡ ä¸ªæœåŠ¡éƒ½åœ¨dockerä¸­ï¼Œæˆ‘ç”¨perfå·¥å…·æ—¶ï¼Œæ‰“å°çš„ä¿¡å·éƒ½æ˜¯16ä½åœ°å€ä¿¡æ¯ï¼Œæ˜¯ä¸æ˜¯éœ€è¦è¿›å…¥åˆ°dockerä¸­ä½¿ç”¨perfå·¥å…·ï¼Ÿ","like_count":0},{"had_liked":false,"id":180991,"user_name":"å®‹èƒ–èƒ–","can_delete":false,"product_type":"c1","uid":1857496,"ip_address":"","ucode":"AA828F49CCEABA","user_header":"https://static001.geekbang.org/account/avatar/00/1c/57/d8/e9c8b923.jpg","comment_is_top":false,"comment_ctime":1582454382,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1582454382","product_id":100020901,"comment_content":"ab   pstree &#47; execsnoop   è¿™äº›å·¥å…·éƒ½æ˜¯å¤´ä¸€æ¬¡ç”¨ï¼Œä¸å­¦ä¸çŸ¥é“å•Š","like_count":0},{"had_liked":false,"id":179482,"user_name":"ç‹é‡‘åˆš","can_delete":false,"product_type":"c1","uid":1813219,"ip_address":"","ucode":"FD8D6D19310DC7","user_header":"http://thirdwx.qlogo.cn/mmopen/vi_32/DYAIOgq83eq3fQlPJzwQRfpg2AlCpaD1znKGeBDX8D4JrJ6KJhuzonicU7FLNelZYDFQzsclNEcdVGzCSUKls3w/132","comment_is_top":false,"comment_ctime":1582013459,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1582013459","product_id":100020901,"comment_content":"è€å¸ˆåœ¨è¿›è¡Œï¼šab -c 5 -t 600 http:&#47;&#47;192.168.0.10:10000&#47;æ“ä½œåï¼Œç»“æœï¼š<br>%Cpu(s):  2.0 us, 13.3 sy, 80.9 ni,  3.4 id,  0.0 wa,  0.0 hi,  0.5 si,  0.0 st<br>niçš„ä½¿ç”¨ç‡æ¯”è¾ƒåˆ°ï¼Œè¿™æ˜¯ä¸ºä½•ã€‹ã€‹","like_count":0},{"had_liked":false,"id":177322,"user_name":"Carey","can_delete":false,"product_type":"c1","uid":1295041,"ip_address":"","ucode":"D31D1ECFAE0027","user_header":"https://static001.geekbang.org/account/avatar/00/13/c2/c1/48785057.jpg","comment_is_top":false,"comment_ctime":1581346769,"is_pvip":false,"discussion_count":1,"race_medal":0,"score":"1581346769","product_id":100020901,"comment_content":"perf report éƒ½æ˜¯å‡½æ•°åœ°å€ï¼Œæ€ä¹ˆçœ‹åˆ°å‡½æ•°åï¼Ÿ","like_count":0,"discussions":[{"author":{"id":3065276,"avatar":"","nickname":"Geek_b3b8da","note":"","ucode":"5461CD95B1D764","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":591492,"discussion_content":"1æ˜¯åœ¨å®¿ä¸»æœºåˆ›å»ºå’Œå®¹å™¨å†…éƒ¨ä¸€æ ·çš„ç¯å¢ƒæ¯”è¾ƒå¤æ‚ï¼Œ2æ˜¯åœ¨å®¿ä¸»æœºå¤–é¢æ‰§è¡Œå®Œï¼Œç„¶åæŠŠdataé‚£ä¸ªæ–‡ä»¶è´Ÿè´£è¿›å®¹å™¨é‡Œé¢ï¼Œåœ¨å®¹å™¨é‡Œé¢å®‰è£…perfç„¶åæ‰§è¡Œå‘½ä»¤æŸ¥çœ‹ï¼Œå…·ä½“å‚è€ƒhttps://www.cnblogs.com/luoahong/p/10833689.html","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1666598742,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":"æµ™æ±Ÿ"},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":174566,"user_name":"ê¯­å°ê¯­å‡¯ê¯­","can_delete":false,"product_type":"c1","uid":1335260,"ip_address":"","ucode":"AF96BE095507C9","user_header":"https://static001.geekbang.org/account/avatar/00/14/5f/dc/2a8440ed.jpg","comment_is_top":false,"comment_ctime":1580281082,"is_pvip":false,"discussion_count":0,"race_medal":3,"score":"1580281082","product_id":100020901,"comment_content":"æˆ‘åœ¨æœ¬åœ°çš„è™šæ‹Ÿæœºä¸ŠæŒ‰ç…§ä¸Šé¢è®²çš„åšæ—¶ï¼Œå‘ç°CPUä½¿ç”¨ç‡å¤§æ¦‚æ˜¯ 40%ï¼ŒTaskä»»åŠ¡ä¸­ï¼Œ running çŠ¶æ€çš„ ä¸€èˆ¬å°±å››äº”ä¸ªï¼Œä½¿ç”¨çš„æŒ‡ä»¤æ˜¯ï¼šab -c 50 -n 1000000 http:&#47;&#47;192.168.194.150:10000&#47;  è¿›è¡Œæ¨¡æ‹Ÿã€‚è™šæ‹Ÿæœº CPUæ˜¯8æ ¸ï¼Œç¡¬ç›˜æ˜¯å›ºæ€ã€‚ <br>","like_count":0},{"had_liked":false,"id":173573,"user_name":"linker","can_delete":false,"product_type":"c1","uid":1803259,"ip_address":"","ucode":"6C5799F2FC2C82","user_header":"https://static001.geekbang.org/account/avatar/00/1b/83/fb/621adceb.jpg","comment_is_top":false,"comment_ctime":1579599033,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1579599033","product_id":100020901,"comment_content":"å¦‚æœçŸ¥é“çˆ¶è¿›ç¨‹çš„è¯ï¼Œå¯ä»¥ç”¨strace","like_count":0},{"had_liked":false,"id":172849,"user_name":"TTTTan","can_delete":false,"product_type":"c1","uid":1669818,"ip_address":"","ucode":"709B6AD19750A1","user_header":"https://static001.geekbang.org/account/avatar/00/19/7a/ba/2850504a.jpg","comment_is_top":false,"comment_ctime":1579334295,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1579334295","product_id":100020901,"comment_content":"æ‰“å¡<br>","like_count":0},{"had_liked":false,"id":171963,"user_name":"åˆ˜å‹æ·™","can_delete":false,"product_type":"c1","uid":1620058,"ip_address":"","ucode":"97F3A69A308313","user_header":"","comment_is_top":false,"comment_ctime":1579058425,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1579058425","product_id":100020901,"comment_content":"D6 æ‰“å¡","like_count":0},{"had_liked":false,"id":171812,"user_name":"ç¬‘","can_delete":false,"product_type":"c1","uid":1741098,"ip_address":"","ucode":"689A435818403A","user_header":"https://static001.geekbang.org/account/avatar/00/1a/91/2a/c0fb21fa.jpg","comment_is_top":false,"comment_ctime":1579017116,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1579017116","product_id":100020901,"comment_content":"è¡¥æ‰“å¡ï¼ŒDay 5ï¼Œç¢°åˆ°å¸¸è§„é—®é¢˜æ— æ³•è§£é‡Šçš„ CPU ä½¿ç”¨ç‡æƒ…å†µæ—¶ï¼Œé¦–å…ˆè¦æƒ³åˆ°æœ‰å¯èƒ½æ˜¯çŸ­æ—¶åº”ç”¨å¯¼è‡´çš„é—®é¢˜ã€‚å¸¸ç”¨å‘½ä»¤æœ‰ï¼štopã€pidstatã€psã€pstreeã€perf","like_count":0},{"had_liked":false,"id":159786,"user_name":"xdargs","can_delete":false,"product_type":"c1","uid":1063740,"ip_address":"","ucode":"EB8326D3A72DE5","user_header":"http://thirdwx.qlogo.cn/mmopen/vi_32/DYAIOgq83eoH9Mlw0kLK0p39vhQpdvkbQP5TX96DB9HMJ1POaTVDpMZg4rjlO3WCAqiaWWMc77ffS3vTo8qWdXA/132","comment_is_top":false,"comment_ctime":1575788776,"is_pvip":true,"discussion_count":0,"race_medal":0,"score":"1575788776","product_id":100020901,"comment_content":"ç¢°åˆ°éå¸¸è§„CPUé—®é¢˜æ—¶æƒ³åˆ°ç¨‹åºå¼‚å¸¸é‡å¯çš„æƒ…å†µï¼Œä½¿ç”¨pstreeå’Œexexsnoopå·¥å…·æŸ¥çœ‹è°ƒç”¨å’Œè®°å½•çŸ­æ—¶è¿›ç¨‹ä¿¡æ¯","like_count":0},{"had_liked":false,"id":144370,"user_name":"é»„å±•å¿—","can_delete":false,"product_type":"c1","uid":1356083,"ip_address":"","ucode":"EBA342CD89072D","user_header":"https://static001.geekbang.org/account/avatar/00/14/b1/33/8993eae0.jpg","comment_is_top":false,"comment_ctime":1571905481,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1571905481","product_id":100020901,"comment_content":"å¾ˆèµï¼Œå¥½æƒ³æŠŠæ‰€æœ‰çš„è¯„è®ºéƒ½çœ‹å®Œï¼Œä½†è¿˜æ˜¯å…ˆå­¦ä¹ å…¶å®ƒç¯‡ç« ï¼Œå€¼å¾—å¤šçœ‹å‡ é","like_count":0},{"had_liked":false,"id":134353,"user_name":"Geek_e986e3","can_delete":false,"product_type":"c1","uid":1642716,"ip_address":"","ucode":"EF53D2DEA59A8F","user_header":"","comment_is_top":false,"comment_ctime":1568812014,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1568812014","product_id":100020901,"comment_content":"è¿™å‡ ç¯‡çœ‹ä¸‹æ¥æ„Ÿè§‰prefå’Œä¸‡é‡‘æ²¹ä¸€æ · èƒ½åˆ†æå„ç§cpué—®é¢˜ã€‚è¿˜èƒ½é¡ºå¸¦æŸ¥æ‰¾çƒ­ç‚¹è°ƒç”¨ã€‚è€å¸ˆæˆ‘èƒ½è¿™ä¹ˆç†è§£å—ï¼Ÿ","like_count":0},{"had_liked":false,"id":132741,"user_name":"è°","can_delete":false,"product_type":"c1","uid":1517268,"ip_address":"","ucode":"F65760FDD31CEB","user_header":"https://static001.geekbang.org/account/avatar/00/17/26/d4/add17f35.jpg","comment_is_top":false,"comment_ctime":1568209217,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1568209217","product_id":100020901,"comment_content":"è¯·é—®è€å¸ˆè¿™ä¸ªè°ƒç”¨stressé‡åˆ°çš„æƒé™é—®é¢˜è¯¥æ€ä¹ˆä¿®å¤å‘¢ï¼Ÿ","like_count":0},{"had_liked":false,"id":125647,"user_name":"18601611625","can_delete":false,"product_type":"c1","uid":1334444,"ip_address":"","ucode":"53D7412DCFD74C","user_header":"","comment_is_top":false,"comment_ctime":1566220240,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1566220240","product_id":100020901,"comment_content":"è€å¸ˆï¼Œæˆ‘åœ¨æ“ä½œä¸­å‘ç°æ‚¨çš„docker imageä¸‹è½½é€Ÿåº¦ææ…¢ï¼Œæœ‰ä»€ä¹ˆå»ºè®®å—ï¼Ÿæ˜¯å¦å¯ä»¥å°†é•œåƒä¸Šä¼ ä¸€ä»½åˆ°daocloud<br>","like_count":0},{"had_liked":false,"id":119755,"user_name":"å°è‹","can_delete":false,"product_type":"c1","uid":1501618,"ip_address":"","ucode":"1A4776F948C6F5","user_header":"https://static001.geekbang.org/account/avatar/00/16/e9/b2/6a9203b5.jpg","comment_is_top":false,"comment_ctime":1564673541,"is_pvip":false,"replies":[{"id":"44403","content":"Javaç¨‹åºçš„åˆ†æè¯·å‚è€ƒç¬¬14ç¯‡çš„ç­”ç–‘","user_name":"ä½œè€…å›å¤","user_name_real":"å€ªæœ‹é£","uid":"1001282","ctime":1565015423,"ip_address":"","comment_id":119755,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1564673541","product_id":100020901,"comment_content":"è€å¸ˆæˆ‘å†™äº†ä¸€ä¸ªæµ‹è¯•ç¨‹åºjavaçš„ (cpuå¯†é›†å‹): å‘½ä»¤:top -g -p 27476<br>    while (true) {<br>         Math.pow(RandomUtils.nextInt(100), RandomUtils.nextInt(100));<br>     }<br>cpuå‡ä¸Šæ¥äº†ä½†æ˜¯å¹¶æ²¡æœ‰æ˜ç¡®çš„æ˜¾ç¤ºæ˜¯ç”±äºè®¡ç®—æ¬¡æ–¹ä¹Ÿå°±æ˜¯powæ–¹æ³•é€ æˆçš„<br>æ¥ä¸‹æ¥æˆ‘æ”¹å¦‚ä½•ç”¨ perf  å®šä½<br>+   67.60%     0.00%  perf-27476.map      [.] 0x00007f8de749930c                                                                                                                                           â–’<br>-   67.27%     0.90%  libjvm.so           [.] JVM_GetStackTraceElement                                                                                                                                     â–’<br>   - 11.07% JVM_GetStackTraceElement                                                                                                                                                                       â–’<br>      - 15.16% java_lang_Throwable::get_stack_trace_element                                                                                                                                                â–’<br>         - 23.20% java_lang_StackTraceElement::create                                                                                                                                                      â–’<br>            - 14.01% StringTable::intern                                                                                                                                                                   â–’<br>               + 9.21% StringTable::intern                                                                                                                                                                 â–’<br>                 3.22% UTF8::convert_to_unicode                                                                                                                                                            â–’<br>                 3.01% UTF8::unicode_length","like_count":0,"discussions":[{"author":{"id":1001282,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/47/42/5b55bd1a.jpg","nickname":"å€ªæœ‹é£","note":"","ucode":"F0FAC195CDE7AC","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":461056,"discussion_content":"Javaç¨‹åºçš„åˆ†æè¯·å‚è€ƒç¬¬14ç¯‡çš„ç­”ç–‘","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1565015423,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":113577,"user_name":"å°‘ç›","can_delete":false,"product_type":"c1","uid":1305743,"ip_address":"","ucode":"BCC7E264B75702","user_header":"https://static001.geekbang.org/account/avatar/00/13/ec/8f/8299495a.jpg","comment_is_top":false,"comment_ctime":1563085372,"is_pvip":false,"replies":[{"id":"41983","content":"ä» docker.io ä¸Šé¢ä¸‹è½½é•œåƒé€Ÿåº¦æ¯”è¾ƒæ…¢ï¼Œä¸€èˆ¬å¤šé‡è¯•å‡ æ¬¡å°±å¯ä»¥äº†ã€‚å½“ç„¶ï¼Œä¹Ÿå¯ä»¥è¯•è¯•å›½å†…çš„ Docker Registry Proxyï¼Œæ¯”å¦‚ http:&#47;&#47;mirror.azure.cn&#47;help&#47;docker-registry-proxy-cache.html","user_name":"ä½œè€…å›å¤","user_name_real":"å€ªæœ‹é£","uid":"1001282","ctime":1563456835,"ip_address":"","comment_id":113577,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1563085372","product_id":100020901,"comment_content":"docker build -t feisky&#47;nginx:cpu -f Dockerfile.nginx .<br>Sending build context to Docker daemon  32.26kB<br>Step 1&#47;4 : FROM nginx<br>Get https:&#47;&#47;registry-1.docker.io&#47;v2&#47;: net&#47;http: TLS handshake timeout<br>Makefile:8: recipe for target &#39;build&#39; failed<br>make: *** [build] Error 1<br>ä¸ºä»€ä¹ˆè¾“å…¥make build å‡ºç°è¿™ä¸ªé”™è¯¯","like_count":0,"discussions":[{"author":{"id":1001282,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/47/42/5b55bd1a.jpg","nickname":"å€ªæœ‹é£","note":"","ucode":"F0FAC195CDE7AC","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":458289,"discussion_content":"ä» docker.io ä¸Šé¢ä¸‹è½½é•œåƒé€Ÿåº¦æ¯”è¾ƒæ…¢ï¼Œä¸€èˆ¬å¤šé‡è¯•å‡ æ¬¡å°±å¯ä»¥äº†ã€‚å½“ç„¶ï¼Œä¹Ÿå¯ä»¥è¯•è¯•å›½å†…çš„ Docker Registry Proxyï¼Œæ¯”å¦‚ http://mirror.azure.cn/help/docker-registry-proxy-cache.html","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1563456835,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":109163,"user_name":"hadoop_admin","can_delete":false,"product_type":"c1","uid":1300466,"ip_address":"","ucode":"7EAFA775505C7E","user_header":"https://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTJGMphabeneYXs9otkAtr67RvxJClDa7jPe7w8yExg4YaS2FGJruDKMj5yN1E90o6MFibnicH8gM0ibg/132","comment_is_top":false,"comment_ctime":1561973364,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1561973364","product_id":100020901,"comment_content":"hadoopç¯å¢ƒä¸‹çš„CPUé—®é¢˜æ¯”è¾ƒéš¾å®šä½ï¼Œæ€è·¯åé¢å¯ä»¥å€Ÿé‰´ä¸‹","like_count":0},{"had_liked":false,"id":103266,"user_name":"Butter Fly","can_delete":false,"product_type":"c1","uid":1564473,"ip_address":"","ucode":"D2B488B465FC3C","user_header":"https://static001.geekbang.org/account/avatar/00/17/df/39/6ead11bc.jpg","comment_is_top":false,"comment_ctime":1560406589,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1560406589","product_id":100020901,"comment_content":"æ‰“å¡","like_count":0},{"had_liked":false,"id":97511,"user_name":"Vincent","can_delete":false,"product_type":"c1","uid":1110967,"ip_address":"","ucode":"A14BA4C418315F","user_header":"https://static001.geekbang.org/account/avatar/00/10/f3/b7/d7377f0c.jpg","comment_is_top":false,"comment_ctime":1558686736,"is_pvip":false,"replies":[{"id":"34967","content":"è¯·æŸ¥è¯¢topçš„æ‰‹å†Œ","user_name":"ä½œè€…å›å¤","user_name_real":"å€ªæœ‹é£","uid":"1001282","ctime":1558793371,"ip_address":"","comment_id":97511,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1558686736","product_id":100020901,"comment_content":"ä½¿ç”¨topæ—¶ï¼Œå¦‚ä½•åªå±•ç¤ºRçŠ¶æ€çš„è¿›ç¨‹ï¼Œæˆ–è€…æŒ‰ç…§çŠ¶æ€æ’åºä¹Ÿå¯ä»¥~","like_count":0,"discussions":[{"author":{"id":1001282,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/47/42/5b55bd1a.jpg","nickname":"å€ªæœ‹é£","note":"","ucode":"F0FAC195CDE7AC","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":451306,"discussion_content":"è¯·æŸ¥è¯¢topçš„æ‰‹å†Œ","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1558793371,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":86593,"user_name":"å¤§åç‹ç‹¸","can_delete":false,"product_type":"c1","uid":1325678,"ip_address":"","ucode":"5044F89A505C5B","user_header":"https://static001.geekbang.org/account/avatar/00/14/3a/6e/e39e90ca.jpg","comment_is_top":false,"comment_ctime":1555405864,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1555405864","product_id":100020901,"comment_content":"ç…çš„çœ¼ç›ç–¼ï¼Œç…ä¸è§stress ä¸è¿‡perf report åˆ°æ˜¯çœ‹åˆ°äº†stress","like_count":0},{"had_liked":false,"id":85695,"user_name":"Warren","can_delete":false,"product_type":"c1","uid":1041381,"ip_address":"","ucode":"64A3C45BABC6A2","user_header":"https://static001.geekbang.org/account/avatar/00/0f/e3/e5/7b2586cb.jpg","comment_is_top":false,"comment_ctime":1555203335,"is_pvip":true,"discussion_count":0,"race_medal":0,"score":"1555203335","product_id":100020901,"comment_content":"æƒ³è·Ÿè€å¸ˆç¡®è®¤ä¸‹è‡ªå·±çš„ç†è§£ï¼Œ<br>1. cpuä½¿ç”¨ç‡é«˜æ˜¯å› ä¸ºå¤§é‡stressè¿›ç¨‹ä½¿ç”¨äº†å¾ˆå¤šCPUï¼Œå³ä½¿æ²¡æœ‰æƒé™çš„é—®é¢˜ï¼Œä¹Ÿä¼šæœ‰é«˜cpuçš„é—®é¢˜ï¼Œå¯¹å—?<br>2. CPUä½¿ç”¨ç‡é«˜è·Ÿå¾ˆå¤šstressè¿›ç¨‹çš„æŠ¢å å’Œä¸Šä¸‹åˆåˆ‡æ¢æœ‰å…³ç³»å—? ","like_count":0},{"had_liked":false,"id":82983,"user_name":"å¼ºå‹è°…","can_delete":false,"product_type":"c1","uid":1475358,"ip_address":"","ucode":"C13F01A12D72A0","user_header":"https://static001.geekbang.org/account/avatar/00/16/83/1e/bdc4f811.jpg","comment_is_top":false,"comment_ctime":1554365058,"is_pvip":false,"replies":[{"id":"30189","content":"è¿™æ˜¯DNSé…ç½®æˆäº†æœ¬åœ°åœ°å€å¹¶ä¸”dockerç»§æ‰¿è¿‡å»äº†ã€‚è§£å†³æ–¹æ³•æ˜¯å‡çº§Dockeråˆ°æœ€æ–°ç‰ˆæœ¬ï¼Œæˆ–è€…ç½‘ç»œæœç´¢127.0.0.53è§£å†³","user_name":"ä½œè€…å›å¤","user_name_real":"å€ªæœ‹é£","uid":"1001282","ctime":1554638825,"ip_address":"","comment_id":82983,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1554365058","product_id":100020901,"comment_content":"åœ¨åšç›¸å…³çš„å®éªŒï¼Œç”±äºç¯å¢ƒä¸­å­˜åœ¨ä»£ç†ã€‚<br>1.make buildæŠ¥é”™æ— æ³•æ‹‰å–é•œåƒGet https:&#47;&#47;registry-1.docker.io&#47;v2&#47;: dial tcp: lookup registry-1.docker.io on 127.0.0.53:53: read udp 127.0.0.1:40789-&gt;127.0.0.53:53: i&#47;o timeout<br>2.åœ¨vim &#47;lib&#47;systemd&#47;system&#47;docker.serviceä¸­æ·»åŠ ä»æŠ¥è¯¥é”™è¯¯ã€‚<br>3.&#47;etc&#47;profileä¸­é€šè¿‡export http_proxy=http:&#47;&#47;172.16.10.12:808<br>export https_proxy=http:&#47;&#47;172.16.10.12:808é…ç½®ä»£ç† ï¼Œwget www.baidu.coméªŒè¯å¯é€š<br><br>4.ä¸€ç›´çº ç»“åœ¨æˆ‘è¿™ç§ç½‘ç»œæƒ…å†µä¸‹å¦‚ä½•æ¬¢ç•…çš„æ‹–å–é•œåƒï¼Œå®˜æ–¹æ–‡æ¡£ä¹Ÿå‚ç…§è®¾ç½®è¿‡ï¼ŒdaocloudåŠ é€Ÿå™¨ä¹Ÿæœ‰å°è¯•ã€‚<br>é—®é¢˜ï¼šè¯·é—®ç°åœ¨çš„é—®é¢˜æ˜¯dockerä»“åº“çš„é—®é¢˜ï¼Œè¿˜æ˜¯ç½‘ç»œé…ç½®ä»æœ‰é—®é¢˜ï¼ŸæœŸæœ›å¤§ç‰›çš„å›ç­”^_^<br>","like_count":0,"discussions":[{"author":{"id":1001282,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/47/42/5b55bd1a.jpg","nickname":"å€ªæœ‹é£","note":"","ucode":"F0FAC195CDE7AC","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":445802,"discussion_content":"è¿™æ˜¯DNSé…ç½®æˆäº†æœ¬åœ°åœ°å€å¹¶ä¸”dockerç»§æ‰¿è¿‡å»äº†ã€‚è§£å†³æ–¹æ³•æ˜¯å‡çº§Dockeråˆ°æœ€æ–°ç‰ˆæœ¬ï¼Œæˆ–è€…ç½‘ç»œæœç´¢127.0.0.53è§£å†³","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1554638825,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":79113,"user_name":"Geek_fce8cb","can_delete":false,"product_type":"c1","uid":1166928,"ip_address":"","ucode":"DCEFB11A493DD0","user_header":"http://thirdwx.qlogo.cn/mmopen/vi_32/S2RCl03ejxSqsShDO7uExD8AREBK5O4xroRXQMjBzFRtbEvcaGNKgIPlZJNBBa1C9QSXrhGFWtttukIAvrdoBQ/132","comment_is_top":false,"comment_ctime":1553354788,"is_pvip":false,"replies":[{"id":"29061","content":"abæ˜¯å®¢æˆ·ç«¯ï¼Œè€Œstressæ˜¯è¦åˆ†æçš„Webåº”ç”¨å†…éƒ¨è°ƒç”¨çš„ã€‚åœ¨åº”ç”¨ç¨‹åºé‡Œé¢è°ƒç”¨å¤–éƒ¨çš„å‘½ä»¤æ—¶ï¼Œæœ‰çš„æ—¶å€™ä¼šå¯¼è‡´æ€§èƒ½é—®é¢˜","user_name":"ä½œè€…å›å¤","user_name_real":"å€ªæœ‹é£","uid":"1001282","ctime":1553527013,"ip_address":"","comment_id":79113,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1553354788","product_id":100020901,"comment_content":"è€å¸ˆï¼Œæ²¡å¤ªæ˜ç™½ è¿™ä¸ªåˆ†æappç›®å½•ä¸‹è°ƒç”¨äº†stressæ˜¯å•¥æ„æ€ï¼Œè¿™ä¸æ˜¯ç”¨çš„abå‘½ä»¤æµ‹è¯•çš„å—ï¼Œæ€ä¹ˆåˆæ‰¯ä¸Šstresså»äº†","like_count":0,"discussions":[{"author":{"id":1001282,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/47/42/5b55bd1a.jpg","nickname":"å€ªæœ‹é£","note":"","ucode":"F0FAC195CDE7AC","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":444361,"discussion_content":"abæ˜¯å®¢æˆ·ç«¯ï¼Œè€Œstressæ˜¯è¦åˆ†æçš„Webåº”ç”¨å†…éƒ¨è°ƒç”¨çš„ã€‚åœ¨åº”ç”¨ç¨‹åºé‡Œé¢è°ƒç”¨å¤–éƒ¨çš„å‘½ä»¤æ—¶ï¼Œæœ‰çš„æ—¶å€™ä¼šå¯¼è‡´æ€§èƒ½é—®é¢˜","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1553527013,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":78055,"user_name":"æ¢¦å›æ±‰å”","can_delete":false,"product_type":"c1","uid":1321581,"ip_address":"","ucode":"9C66E35165F813","user_header":"https://static001.geekbang.org/account/avatar/00/14/2a/6d/0e436c1c.jpg","comment_is_top":false,"comment_ctime":1553064047,"is_pvip":false,"replies":[{"id":"28777","content":"watchçš„é—´éš”æ—¶é—´æ˜¯1sï¼Œ1så†…å°±ç»“æŸçš„è¿›ç¨‹è¿˜æ˜¯ä¼šæ¼æ‰","user_name":"ä½œè€…å›å¤","user_name_real":"å€ªæœ‹é£","uid":"1001282","ctime":1553319593,"ip_address":"","comment_id":78055,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1553064047","product_id":100020901,"comment_content":"æŸ¥çœ‹ç¬æ—¶è¿›ç¨‹ï¼Œè¿˜å¯ä»¥ç”¨è¿™ä¸ªæ–¹æ³•ï¼š<br><br>watch -n 1 -d &quot;ps -A -ostat,pid,ppid,cmd | grep -i &#39;^r&#39; | grep -v ps&quot;<br><br>ä¸‹é¢æ˜¯è¾“å‡ºï¼š<br><br>Every 1.0s: ps -A -ostat,pid,ppid,cmd | grep -i &#39;^r&#39; | grep -v ps       Wed Mar 20 02:39:50 2019<br><br>R+   13308 13307 &#47;usr&#47;local&#47;bin&#47;stress -t 1 -d 1<br>R+   13313 13312 &#47;usr&#47;local&#47;bin&#47;stress -t 1 -d 1<br>R+   13314 13311 &#47;usr&#47;local&#47;bin&#47;stress -t 1 -d 1<br>R+   13319 13317 &#47;usr&#47;local&#47;bin&#47;stress -t 1 -d 1<br>R+   13320 13318 &#47;usr&#47;local&#47;bin&#47;stress -t 1 -d 1","like_count":0,"discussions":[{"author":{"id":1001282,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/47/42/5b55bd1a.jpg","nickname":"å€ªæœ‹é£","note":"","ucode":"F0FAC195CDE7AC","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":443949,"discussion_content":"watchçš„é—´éš”æ—¶é—´æ˜¯1sï¼Œ1så†…å°±ç»“æŸçš„è¿›ç¨‹è¿˜æ˜¯ä¼šæ¼æ‰","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1553319593,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":76640,"user_name":"Ignacio","can_delete":false,"product_type":"c1","uid":1130334,"ip_address":"","ucode":"AEAA24A58B6D29","user_header":"https://static001.geekbang.org/account/avatar/00/11/3f/5e/2fa1377d.jpg","comment_is_top":false,"comment_ctime":1552653709,"is_pvip":false,"replies":[{"id":"28064","content":"è¿™åº”è¯¥æ˜¯ipv6è¢«ç¦æ­¢å¯¼è‡´çš„ï¼Œå¯ä»¥å¼€å¯ipv6æˆ–è€…ä¿®æ”¹ç›‘å¬åœ¨ ipv4ï¼Œæ¯”å¦‚listen = 0.0.0.0:9000","user_name":"ä½œè€…å›å¤","user_name_real":"å€ªæœ‹é£","uid":"1001282","ctime":1552751003,"ip_address":"","comment_id":76640,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1552653709","product_id":100020901,"comment_content":"[root@rhel7 ~]# docker logs 6117d3a95fda<br>[15-Mar-2019 12:33:07] ERROR: failed to create new listening socket: socket(): Address family not supported by protocol (97)<br>[15-Mar-2019 12:33:07] ERROR: FPM initialization failed<br>é•œåƒéƒ½å¯ä»¥æ‹‰ä¸‹æ¥ï¼Œnginxå¯ä»¥å¯åŠ¨ï¼Œphp-fpmèµ·ä¸æ¥ã€‚ã€‚","like_count":0,"discussions":[{"author":{"id":1001282,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/47/42/5b55bd1a.jpg","nickname":"å€ªæœ‹é£","note":"","ucode":"F0FAC195CDE7AC","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":443386,"discussion_content":"è¿™åº”è¯¥æ˜¯ipv6è¢«ç¦æ­¢å¯¼è‡´çš„ï¼Œå¯ä»¥å¼€å¯ipv6æˆ–è€…ä¿®æ”¹ç›‘å¬åœ¨ ipv4ï¼Œæ¯”å¦‚listen = 0.0.0.0:9000","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1552751003,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":76587,"user_name":"Geek_00d753","can_delete":false,"product_type":"c1","uid":1253949,"ip_address":"","ucode":"2ED08B1A425994","user_header":"https://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTJUP6ibuQssqJBNtQdSaFNhzzibdf7I3nyVGCeJPoDYqfsRndqRY19GpOJCOibMXQmOv2EchtHh0SXow/132","comment_is_top":false,"comment_ctime":1552635668,"is_pvip":false,"replies":[{"id":"28066","content":"è¿™æ˜¯æ­£å¸¸çš„ï¼Œä¸åŒçš„é€‰é¡¹ä¼šå½±å“gccçš„ç¼–è¯‘è¿‡ç¨‹","user_name":"ä½œè€…å›å¤","user_name_real":"å€ªæœ‹é£","uid":"1001282","ctime":1552751293,"ip_address":"","comment_id":76587,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1552635668","product_id":100020901,"comment_content":"è€å¸ˆä½ å¥½ï¼ŒC++çš„ç¨‹åºï¼Œperf record åŠ  &quot;-g&quot; å‚æ•°ï¼Œä¼šä¾èµ–äºç¼–è¯‘æ—¶å¼€å¯-fno-omit-frame-pointeré€‰é¡¹ï¼Œæˆ‘åœ¨ç¼–è¯‘çš„æ—¶å€™ï¼ŒåŒæ—¶åŠ å…¥-fno-omit-frame-pointer å’Œ-ggdb3é€‰é¡¹ã€‚ä½†æˆ‘é€šè¿‡ perf record -g å’Œperf record --call-graph dwarfæŠ“å‡ºæ¥çš„é‡‡æ ·ä¿¡æ¯æœ‰å¾ˆå¤§çš„åŒºåˆ«ï¼Œä¸¤è€…ç”Ÿäº§çš„ç«ç„°å›¾ä¹Ÿä¸ä¸€æ ·ã€‚è¯·é—®è¿™ä¸ªæ˜¯ä»€ä¹ˆåŸå› ï¼ŸåŒæ ·çš„æƒ…å†µä¹Ÿä½¿ç”¨äºperf topä¸­å¯¹&quot;-g&quot;çš„é™å®šã€‚","like_count":0,"discussions":[{"author":{"id":1001282,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/47/42/5b55bd1a.jpg","nickname":"å€ªæœ‹é£","note":"","ucode":"F0FAC195CDE7AC","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":443364,"discussion_content":"è¿™æ˜¯æ­£å¸¸çš„ï¼Œä¸åŒçš„é€‰é¡¹ä¼šå½±å“gccçš„ç¼–è¯‘è¿‡ç¨‹","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1552751293,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":75335,"user_name":"vvsuperman","can_delete":false,"product_type":"c1","uid":1021518,"ip_address":"","ucode":"F393A3FB894124","user_header":"https://static001.geekbang.org/account/avatar/00/0f/96/4e/2acbc3a8.jpg","comment_is_top":false,"comment_ctime":1552381060,"is_pvip":false,"replies":[{"id":"27486","content":"å¯ä»¥çœ‹åˆ°çš„ï¼Œdocker å†…çš„è¿›ç¨‹åœ¨ä¸»æœºä¸­éƒ½å¯ä»¥çœ‹åˆ°","user_name":"ä½œè€…å›å¤","user_name_real":"å€ªæœ‹é£","uid":"1001282","ctime":1552399655,"ip_address":"","comment_id":75335,"utype":1}],"discussion_count":2,"race_medal":0,"score":"1552381060","product_id":100020901,"comment_content":"ç™»é™†åˆ°dockerç¯å¢ƒä¸­topçœ‹åˆ°çš„éƒ½æ˜¯æ•´ä¸ªä¸»æœºçš„ä¿¡æ¯ï¼Œè€Œä¸æ˜¯dockerè‡ªèº«çš„è¿›ç¨‹çš„ä¿¡æ¯ï¼ŒæŸ¥çœ‹ä¸åˆ°å‘€","like_count":0,"discussions":[{"author":{"id":1001282,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/47/42/5b55bd1a.jpg","nickname":"å€ªæœ‹é£","note":"","ucode":"F0FAC195CDE7AC","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":442866,"discussion_content":"å¯ä»¥çœ‹åˆ°çš„ï¼Œdocker å†…çš„è¿›ç¨‹åœ¨ä¸»æœºä¸­éƒ½å¯ä»¥çœ‹åˆ°","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1552399655,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":3065276,"avatar":"","nickname":"Geek_b3b8da","note":"","ucode":"5461CD95B1D764","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":591487,"discussion_content":"dockerçš„å®¹å™¨æœ¬èº«å°±æ˜¯å®¿ä¸»æœºçš„ä¸€ä¸ªè¿›ç¨‹","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1666598231,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":"æµ™æ±Ÿ"},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":72990,"user_name":"AceslupK","can_delete":false,"product_type":"c1","uid":1284474,"ip_address":"","ucode":"048F84D019CBBB","user_header":"https://static001.geekbang.org/account/avatar/00/13/99/7a/558666a5.jpg","comment_is_top":false,"comment_ctime":1551772088,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1551772088","product_id":100020901,"comment_content":"è±ç„¶å¼€æœ—ï¼Œæ„Ÿè°¢","like_count":0},{"had_liked":false,"id":70955,"user_name":"L33K","can_delete":false,"product_type":"c1","uid":1046063,"ip_address":"","ucode":"2F8E105F44E347","user_header":"https://static001.geekbang.org/account/avatar/00/0f/f6/2f/d3f1dae6.jpg","comment_is_top":false,"comment_ctime":1551233114,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1551233114","product_id":100020901,"comment_content":"mark","like_count":0},{"had_liked":false,"id":70562,"user_name":"ä»™é“","can_delete":false,"product_type":"c1","uid":1402218,"ip_address":"","ucode":"3F3B35929E08C9","user_header":"https://static001.geekbang.org/account/avatar/00/15/65/6a/67f55083.jpg","comment_is_top":false,"comment_ctime":1551141531,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1551141531","product_id":100020901,"comment_content":"mark","like_count":0},{"had_liked":false,"id":70316,"user_name":"å¹³å®‰å–œä¹","can_delete":false,"product_type":"c1","uid":1102350,"ip_address":"","ucode":"B97D8944B0B035","user_header":"https://static001.geekbang.org/account/avatar/00/10/d2/0e/26bf35a4.jpg","comment_is_top":false,"comment_ctime":1551072097,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1551072097","product_id":100020901,"comment_content":"æ‰“å¡","like_count":0},{"had_liked":false,"id":68421,"user_name":"æ¯æ—¥éƒ½æƒ³ä¸Šç­","can_delete":false,"product_type":"c1","uid":1060466,"ip_address":"","ucode":"1DE64120C8B14A","user_header":"https://static001.geekbang.org/account/avatar/00/10/2e/72/145c10db.jpg","comment_is_top":false,"comment_ctime":1550498245,"is_pvip":false,"replies":[{"id":"24376","content":"æ˜¯ä¸æ˜¯å¿«æ·é”®è®¾ç½®çš„é—®é¢˜ï¼Ÿæˆ‘ç”¨çš„æ˜¯ Ubuntu è‡ªå¸¦çš„ç»ˆç«¯æˆ–è€…iterm","user_name":"ä½œè€…å›å¤","user_name_real":"å€ªæœ‹é£","uid":"1001282","ctime":1550570373,"ip_address":"","comment_id":68421,"utype":1}],"discussion_count":2,"race_medal":0,"score":"1550498245","product_id":100020901,"comment_content":"è€å¸ˆï¼Œæˆ‘ç”¨securecrtä¸­è¿œç¨‹linuxï¼Œç„¶ååœ¨é‡Œé¢è¿è¡Œperf top åæŒ‰ä¸Šä¸‹é”®æ²¡æœ‰ç”¨ï¼Œè¯·é—®ä½ ä»¬æ˜¯ç”¨ä»€ä¹ˆå·¥å…·è¿›è¡Œsshçš„","like_count":0,"discussions":[{"author":{"id":1001282,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/47/42/5b55bd1a.jpg","nickname":"å€ªæœ‹é£","note":"","ucode":"F0FAC195CDE7AC","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":439668,"discussion_content":"æ˜¯ä¸æ˜¯å¿«æ·é”®è®¾ç½®çš„é—®é¢˜ï¼Ÿæˆ‘ç”¨çš„æ˜¯ Ubuntu è‡ªå¸¦çš„ç»ˆç«¯æˆ–è€…iterm","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1550570373,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":3065276,"avatar":"","nickname":"Geek_b3b8da","note":"","ucode":"5461CD95B1D764","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":591486,"discussion_content":"xhell","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1666598203,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":"æµ™æ±Ÿ"},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":66968,"user_name":"å…ƒå¤©å¤«","can_delete":false,"product_type":"c1","uid":1315599,"ip_address":"","ucode":"A453A2EBA77780","user_header":"","comment_is_top":false,"comment_ctime":1550049344,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1550049344","product_id":100020901,"comment_content":"æ‰“å¡ï¼Œå…¬å¸æœåŠ¡å™¨ä¸Šä¸èƒ½æ‰§è¡Œperfå‘½ä»¤ï¼Œæœ‰é™åˆ¶ã€‚å›å»è‡ªå·±æ­ç¯å¢ƒå†æ•´ä¸€æ¬¡å§","like_count":0},{"had_liked":false,"id":62219,"user_name":"è®©ç†ŠçŒ«é£ä¸Šå¤©","can_delete":false,"product_type":"c1","uid":1348156,"ip_address":"","ucode":"7D6D349B6E3730","user_header":"https://static001.geekbang.org/account/avatar/00/14/92/3c/9116abf4.jpg","comment_is_top":false,"comment_ctime":1547986462,"is_pvip":false,"replies":[{"id":"22141","content":"è°¢è°¢åˆ†äº«å®è·µç»éªŒ","user_name":"ä½œè€…å›å¤","user_name_real":"å€ªæœ‹é£","uid":"1001282","ctime":1548116761,"ip_address":"","comment_id":62219,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1547986462","product_id":100020901,"comment_content":"æˆ‘çš„ç³»ç»Ÿæ˜¯centos7.5ï¼Œåœ¨å®‰è£…è€å¸ˆè¿™èŠ‚çš„å®éªŒdockerå®¹å™¨çš„æ—¶å€™ï¼Œå‘ç°pullä¸ä¸‹æ¥ï¼ŒæŠ¥å¦‚ä¸‹é”™è¯¯ï¼š<br>[root@xuegod63 ~]# docker run --name nginx -p 10000:80 -itd feisky&#47;nginx:sp<br>Unable to find image &#39;feisky&#47;nginx:sp&#39; locally<br>sp: Pulling from feisky&#47;nginx<br>......<br>docker: error pulling image configuration: Get https:&#47;&#47;production.cloudflare.docker.com&#47;registry-v2&#47;docker&#47;registry&#47;v2&#47;blobs&#47;sha256&#47;91&#47;915c06c7382480f7f09e079a5668b14a30c945d0f92b520ff6ed772849046c06&#47;data?verify=1547988802-0w2CCTWkCUWJrCEvBPLV%2BZNygkc%3D: EOF.<br>See &#39;docker run --help&#39;.<br>åæ¥åœ¨ç½‘ä¸ŠæŸ¥çœ‹äº†ä¸€ä¸‹ï¼Œç»™å‡ºäº†å¦‚ä¸‹çš„è§£å†³æ–¹æ³•(æˆ‘å®‰è£…å®¹å™¨è½¯ä»¶ç”¨çš„æ–¹å¼æ˜¯curl -sSL https:&#47;&#47;get.docker.com&#47; | sh)æ‰€ä»¥åœ¨&#47;etc&#47;sysconfig&#47;ä¸‹é¢æ²¡æœ‰é‚£ä¸ªdockerçš„é…ç½®æ–‡ä»¶ï¼Œæˆ‘æ˜¯ç›´æ¥æ–°å»ºçš„ï¼ŒæŠŠä¸‹é¢å†…å®¹å…¨éƒ¨ç²˜è¿›å»äº†ï¼Œç„¶åé‡å¯dockeræœåŠ¡<br>å‚è€ƒè¿™ä¸ªç½‘å€ä¸Šçš„å†…å®¹https:&#47;&#47;www.cnblogs.com&#47;guyeshanrenshiwoshifu&#47;p&#47;9025104.html<br>å°±æ˜¯ä¸Šé¢çš„å†…å®¹ï¼Œç„¶åå†å»æ‰§è¡Œdocker run --name nginx -p 10000:80 -itd feisky&#47;nginx:spå°±å¯ä»¥æ­£å¸¸ä¸‹è½½äº†ã€‚","like_count":0,"discussions":[{"author":{"id":1001282,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/47/42/5b55bd1a.jpg","nickname":"å€ªæœ‹é£","note":"","ucode":"F0FAC195CDE7AC","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":437140,"discussion_content":"è°¢è°¢åˆ†äº«å®è·µç»éªŒ","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1548116761,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":62213,"user_name":"è®©ç†ŠçŒ«é£ä¸Šå¤©","can_delete":false,"product_type":"c1","uid":1348156,"ip_address":"","ucode":"7D6D349B6E3730","user_header":"https://static001.geekbang.org/account/avatar/00/14/92/3c/9116abf4.jpg","comment_is_top":false,"comment_ctime":1547985236,"is_pvip":false,"replies":[{"id":"22335","content":"ç½‘ç»œé”™è¯¯ï¼Œå¯ä»¥ç¨åå†è¯•è¯•","user_name":"ä½œè€…å›å¤","user_name_real":"å€ªæœ‹é£","uid":"1001282","ctime":1548251708,"ip_address":"","comment_id":62213,"utype":1}],"discussion_count":2,"race_medal":0,"score":"1547985236","product_id":100020901,"comment_content":"[root@xuegod63 ~]# docker run --name phpfpm -itd --network container:nginx feisky&#47;php-fpm:sp<br>Unable to find image &#39;feisky&#47;php-fpm:sp&#39; locally<br>sp: Pulling from feisky&#47;php-fpm<br>a02fbcf48e6b: Downloading [==&gt;                                                ]  916.6kB&#47;22.05MB<br>0fd90e182cc5: Pulling fs layer <br>554d282927ec: Pulling fs layer <br>805a76c208d2: Waiting <br>7815988b0b73: Waiting <br>5937bbd596b6: Waiting <br>eb60d700b9c1: Waiting <br>a1fc81bebde7: Waiting <br>a4ae4e49d6a5: Waiting <br>b71e96a90b11: Waiting <br>8ce6d254af53: Waiting <br>docker: error pulling image configuration: Get https:&#47;&#47;production.cloudflare.docker.com&#47;registry-v2&#47;docker&#47;registry&#47;v2&#47;blobs&#47;sha256&#47;65&#47;65aa1224020319c62d5f1045ecf096797ce0db3b895c4bf00d083a97e837bb3c&#47;data?verify=1547988073-3m6OqcKpNgL9ybEbjvlDHHK7p9w%3D: net&#47;http: TLS handshake timeout.<br>See &#39;docker run --help&#39;.<br>è€å¸ˆä¸ºä»€ä¹ˆè¯•éªŒç”¨çš„é•œåƒä¸èƒ½æ­£å¸¸ä¸‹è½½äº†å‘¢ï¼Ÿæˆ‘çš„æ˜¯CENTOS7çš„ç³»ç»Ÿ","like_count":0,"discussions":[{"author":{"id":1001282,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/47/42/5b55bd1a.jpg","nickname":"å€ªæœ‹é£","note":"","ucode":"F0FAC195CDE7AC","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":437139,"discussion_content":"ç½‘ç»œé”™è¯¯ï¼Œå¯ä»¥ç¨åå†è¯•è¯•","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1548251708,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":3065276,"avatar":"","nickname":"Geek_b3b8da","note":"","ucode":"5461CD95B1D764","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":591485,"discussion_content":"ä½ éœ€è¦è®¾ç½®dockerçš„åŠ é€Ÿå™¨","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1666598162,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":"æµ™æ±Ÿ"},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":59131,"user_name":"Yangjing","can_delete":false,"product_type":"c1","uid":1018061,"ip_address":"","ucode":"D88DFD4958D07C","user_header":"https://static001.geekbang.org/account/avatar/00/0f/88/cd/2c3808ce.jpg","comment_is_top":false,"comment_ctime":1547303859,"is_pvip":true,"replies":[{"id":"21524","content":"é»˜è®¤å‘½ä»¤åº”è¯¥æ˜¯å¯ä»¥çš„ï¼Œæˆ‘åœ¨centos7å’Œubuntu18æµ‹è¯•è¿‡ã€‚ä½ çš„ç³»ç»Ÿç‰ˆæœ¬æ˜¯ä»€ä¹ˆï¼Ÿ","user_name":"ä½œè€…å›å¤","user_name_real":"å€ªæœ‹é£","uid":"1001282","ctime":1547448451,"ip_address":"","comment_id":59131,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1547303859","product_id":100020901,"comment_content":"è¿™é‡Œçš„ perf å‘½ä»¤æ˜¯å¦æœ‰é—®é¢˜ï¼Ÿ å®é™…ä½¿ç”¨çš„æ—¶å€™ï¼Œå‘ç° &quot;perf record -g&quot; éœ€è¦æ”¹ä¸º &quot;perf record -ag&quot; æ‰èƒ½å®é™…è®°å½•æ•°æ®åˆ° perf.data æ–‡ä»¶ã€‚","like_count":0,"discussions":[{"author":{"id":1001282,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/47/42/5b55bd1a.jpg","nickname":"å€ªæœ‹é£","note":"","ucode":"F0FAC195CDE7AC","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":436302,"discussion_content":"é»˜è®¤å‘½ä»¤åº”è¯¥æ˜¯å¯ä»¥çš„ï¼Œæˆ‘åœ¨centos7å’Œubuntu18æµ‹è¯•è¿‡ã€‚ä½ çš„ç³»ç»Ÿç‰ˆæœ¬æ˜¯ä»€ä¹ˆï¼Ÿ","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1547448451,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":58299,"user_name":"closer","can_delete":false,"product_type":"c1","uid":1368990,"ip_address":"","ucode":"69F38480DF8491","user_header":"https://static001.geekbang.org/account/avatar/00/14/e3/9e/b26da70d.jpg","comment_is_top":false,"comment_ctime":1547029283,"is_pvip":false,"replies":[{"id":"21157","content":"è¯·æŠŠå…·ä½“çš„é”™è¯¯è´´å‡ºæ¥","user_name":"ä½œè€…å›å¤","user_name_real":"å€ªæœ‹é£","uid":"1001282","ctime":1547125063,"ip_address":"","comment_id":58299,"utype":1}],"discussion_count":2,"race_medal":0,"score":"1547029283","product_id":100020901,"comment_content":"perf record -g æ‰§è¡Œä¸è¡Œï¼Œè¦æ±‚è¿˜è¦åŠ å‚æ•°ï¼Œä»€ä¹ˆé—®é¢˜?è°¢è°¢","like_count":0,"discussions":[{"author":{"id":1001282,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/47/42/5b55bd1a.jpg","nickname":"å€ªæœ‹é£","note":"","ucode":"F0FAC195CDE7AC","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":435996,"discussion_content":"è¯·æŠŠå…·ä½“çš„é”™è¯¯è´´å‡ºæ¥","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1547125063,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":3065276,"avatar":"","nickname":"Geek_b3b8da","note":"","ucode":"5461CD95B1D764","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":591484,"discussion_content":"perf record -g -F 99 -p è¿›ç¨‹çš„pidå·","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1666598132,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":"æµ™æ±Ÿ"},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":52722,"user_name":"speace","can_delete":false,"product_type":"c1","uid":1132600,"ip_address":"","ucode":"F068042179AFB0","user_header":"https://static001.geekbang.org/account/avatar/00/11/48/38/2a4abf0a.jpg","comment_is_top":false,"comment_ctime":1545487650,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1545487650","product_id":100020901,"comment_content":"ä½ å¥½ï¼Œexecsnoopå¯ä»¥çœ‹åˆ°é‚£äº›è¿›ç¨‹ï¼Ÿåœ¨é‚£äº›åœ°æ–¹å¯ä»¥ç”¨åˆ°ï¼Ÿä¸ºä»€ä¹ˆåªæ˜¾ç¤ºä¸€éƒ¨åˆ†è¿›ç¨‹ï¼Ÿ","like_count":0},{"had_liked":false,"id":52248,"user_name":"Only now","can_delete":false,"product_type":"c1","uid":1038574,"ip_address":"","ucode":"C617473A03AE27","user_header":"https://static001.geekbang.org/account/avatar/00/0f/d8/ee/6e7c2264.jpg","comment_is_top":false,"comment_ctime":1545354305,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1545354305","product_id":100020901,"comment_content":"mark ","like_count":0},{"had_liked":false,"id":52082,"user_name":"maoxiajun","can_delete":false,"product_type":"c1","uid":1198843,"ip_address":"","ucode":"CB4926BC81B3B1","user_header":"https://static001.geekbang.org/account/avatar/00/12/4a/fb/70f14340.jpg","comment_is_top":false,"comment_ctime":1545306899,"is_pvip":false,"replies":[{"id":"18877","content":"ğŸ‘","user_name":"ä½œè€…å›å¤","user_name_real":"å€ªæœ‹é£","uid":"1001282","ctime":1545312455,"ip_address":"","comment_id":52082,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1545306899","product_id":100020901,"comment_content":"lesson6æ‰“å¡","like_count":0,"discussions":[{"author":{"id":1001282,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/47/42/5b55bd1a.jpg","nickname":"å€ªæœ‹é£","note":"","ucode":"F0FAC195CDE7AC","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":433734,"discussion_content":"ğŸ‘","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1545312455,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":50241,"user_name":"é“é¸Ÿ","can_delete":false,"product_type":"c1","uid":1227710,"ip_address":"","ucode":"D89CDBEA75BD40","user_header":"https://static001.geekbang.org/account/avatar/00/12/bb/be/0f96379d.jpg","comment_is_top":false,"comment_ctime":1544931099,"is_pvip":false,"replies":[{"id":"18102","content":"ğŸ‘","user_name":"ä½œè€…å›å¤","user_name_real":"å€ªæœ‹é£","uid":"1001282","ctime":1545004101,"ip_address":"","comment_id":50241,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1544931099","product_id":100020901,"comment_content":"æ‰“å¡","like_count":0,"discussions":[{"author":{"id":1001282,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/47/42/5b55bd1a.jpg","nickname":"å€ªæœ‹é£","note":"","ucode":"F0FAC195CDE7AC","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":432924,"discussion_content":"ğŸ‘","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1545004101,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":49126,"user_name":"å¦‚æœ","can_delete":false,"product_type":"c1","uid":1320638,"ip_address":"","ucode":"138A3EEEE50850","user_header":"","comment_is_top":false,"comment_ctime":1544607722,"is_pvip":false,"replies":[{"id":"17664","content":"ğŸ‘","user_name":"ä½œè€…å›å¤","user_name_real":"å€ªæœ‹é£","uid":"1001282","ctime":1544660516,"ip_address":"","comment_id":49126,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1544607722","product_id":100020901,"comment_content":"DAY6ï¼Œæ‰“å¡","like_count":0,"discussions":[{"author":{"id":1001282,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/47/42/5b55bd1a.jpg","nickname":"å€ªæœ‹é£","note":"","ucode":"F0FAC195CDE7AC","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":432493,"discussion_content":"ğŸ‘","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1544660516,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":48622,"user_name":"æé€é¥","can_delete":false,"product_type":"c1","uid":1109750,"ip_address":"","ucode":"DB74823527E203","user_header":"http://thirdwx.qlogo.cn/mmopen/vi_32/xzHDjCSFicNY3MUMECtNz6sM8yDJhBoyGk5IRoOtUat6ZIkGzxjqEqwqKYWMD3GjehScKvMjicGOGDog5FF18oyg/132","comment_is_top":false,"comment_ctime":1544498662,"is_pvip":false,"replies":[{"id":"17707","content":"å—¯ ä¸å®Œå…¨ä¸€è‡´æ˜¯æ­£å¸¸çš„ï¼Œå±•å¼€è¡Œå†çœ‹çœ‹è°ƒç”¨æ ˆ","user_name":"ä½œè€…å›å¤","user_name_real":"å€ªæœ‹é£","uid":"1001282","ctime":1544662527,"ip_address":"","comment_id":48622,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1544498662","product_id":100020901,"comment_content":"Samples: 319K of event &#39;cycles&#39;, Event count (approx.): 158249991282                                                                            <br>  Children      Self  Command          Shared Object                   Symbol                                                                  <br>+    5.78%     0.00%  php-fpm          libc-2.24.so                    [.] 0xffff80c6b4c1e2e1                                                  <br>+    5.78%     0.00%  php-fpm          [unknown]                       [.] 0x6cb6258d4c544155                                                  <br>+    5.56%     1.11%  stress           [kernel.kallsyms]               [k] async_page_fault                                                    <br>+    5.49%     5.49%  stress           libc-2.24.so                    [.] 0x0000000000036387                                                  <br>+    4.45%     0.04%  stress           [kernel.kallsyms]               [k] do_async_page_fault                                                 <br>+    4.42%     0.03%  stress           [kernel.kallsyms]               [k] trace_do_page_fault                                                 <br>ä¸ºä»€ä¹ˆæˆ‘perf report çš„ç»“æœæ˜¯è¿™æ ·                                           ","like_count":0,"discussions":[{"author":{"id":1001282,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/47/42/5b55bd1a.jpg","nickname":"å€ªæœ‹é£","note":"","ucode":"F0FAC195CDE7AC","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":432279,"discussion_content":"å—¯ ä¸å®Œå…¨ä¸€è‡´æ˜¯æ­£å¸¸çš„ï¼Œå±•å¼€è¡Œå†çœ‹çœ‹è°ƒç”¨æ ˆ","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1544662527,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":48612,"user_name":"VickyğŸ£ğŸ£ğŸ£","can_delete":false,"product_type":"c1","uid":1266840,"ip_address":"","ucode":"F659F178A2FF34","user_header":"https://static001.geekbang.org/account/avatar/00/13/54/98/52ca7053.jpg","comment_is_top":false,"comment_ctime":1544496368,"is_pvip":false,"replies":[{"id":"17847","content":"çœ‹èµ·æ¥è¿˜æ˜¯æ²¡æœ‰æŠ“å–åˆ°æ•°æ®ï¼Œæœ‰æ²¡æœ‰çœ‹åˆ°è­¦å‘Šä¿¡æ¯ï¼Ÿ","user_name":"ä½œè€…å›å¤","user_name_real":"å€ªæœ‹é£","uid":"1001282","ctime":1544746318,"ip_address":"","comment_id":48612,"utype":1}],"discussion_count":2,"race_medal":0,"score":"1544496368","product_id":100020901,"comment_content":"perf record -g å¾—åˆ°çš„æ–‡ä»¶è¿›è¡Œperf reportçš„æ—¶å€™<br><br>é‡åˆ°ç¬¬ä¸€ä¸ªé—®é¢˜ï¼š<br>[root@VM_0_5_centos ~]# perf report <br>WARNING: The perf.data file&#39;s data size field is 0 which is unexpected.<br>Was the &#39;perf record&#39; command properly terminated?<br>ç„¶åçŒœæµ‹æ˜¯æŠ“å–çš„æ—¶é—´å¤ªé•¿äº†ï¼Œåˆç¼©çŸ­åˆ°äº†å¤§æ¦‚ä¸ƒå…«ç§’çš„æ ·å­<br><br>æ–°çš„é—®é¢˜ï¼š<br>Samples: 16K of event &#39;cpu-clock&#39;, Event count (approx.): 4248000000                                                                                                                  <br>  Children      Self  Command  Shared Object  Symbol                                                                                                                                  <br>æ­¤å¤„æ˜¾ç¤ºç©ºç™½ï¼Œä»€ä¹ˆéƒ½æ²¡æœ‰<br><br>è¯·é—®è€å¸ˆï¼Œæ˜¯ä»€ä¹ˆåŸå› å‘¢ï¼Ÿ","like_count":0,"discussions":[{"author":{"id":1001282,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/47/42/5b55bd1a.jpg","nickname":"å€ªæœ‹é£","note":"","ucode":"F0FAC195CDE7AC","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":432275,"discussion_content":"çœ‹èµ·æ¥è¿˜æ˜¯æ²¡æœ‰æŠ“å–åˆ°æ•°æ®ï¼Œæœ‰æ²¡æœ‰çœ‹åˆ°è­¦å‘Šä¿¡æ¯ï¼Ÿ","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1544746318,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":3065276,"avatar":"","nickname":"Geek_b3b8da","note":"","ucode":"5461CD95B1D764","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":591482,"discussion_content":"WARNING: The perf.data file&#39;s data size field is 0 which is unexpected.\nWas the &#39;perf record&#39; command properly terminated?è¿™æ˜¯å‘Šè­¦ä¿¡æ¯","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1666598088,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":"æµ™æ±Ÿ"},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":48042,"user_name":"wumin","can_delete":false,"product_type":"c1","uid":1297749,"ip_address":"","ucode":"419A9FDDC9636D","user_header":"http://thirdwx.qlogo.cn/mmopen/vi_32/PiajxSqBRaEJSYNNABBxXCme5FMGUYTPbvnT6IvpzPP3qiaSibZficAfabydnwWOV6LlQ4lAtF0aeN3ficv0S3iavmxQ/132","comment_is_top":false,"comment_ctime":1544328773,"is_pvip":false,"replies":[{"id":"17853","content":"å—¯å—¯","user_name":"ä½œè€…å›å¤","user_name_real":"å€ªæœ‹é£","uid":"1001282","ctime":1544746850,"ip_address":"","comment_id":48042,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1544328773","product_id":100020901,"comment_content":"make buildåè‡ªåŠ¨å¯åŠ¨dockerã€‚docker runå°±ä¸éœ€è¦æ‰§è¡Œäº†ã€‚","like_count":0,"discussions":[{"author":{"id":1001282,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/47/42/5b55bd1a.jpg","nickname":"å€ªæœ‹é£","note":"","ucode":"F0FAC195CDE7AC","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":432000,"discussion_content":"å—¯å—¯","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1544746850,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":47978,"user_name":"wumin","can_delete":false,"product_type":"c1","uid":1297749,"ip_address":"","ucode":"419A9FDDC9636D","user_header":"http://thirdwx.qlogo.cn/mmopen/vi_32/PiajxSqBRaEJSYNNABBxXCme5FMGUYTPbvnT6IvpzPP3qiaSibZficAfabydnwWOV6LlQ4lAtF0aeN3ficv0S3iavmxQ/132","comment_is_top":false,"comment_ctime":1544276428,"is_pvip":false,"replies":[{"id":"17071","content":"ä¸¤ä¸ªè™šæ‹Ÿæœºï¼Œè¿™æ˜¯ä¸ºäº†é¿å…abå¹²æ‰°æ€§èƒ½åˆ†æçš„è¿‡ç¨‹","user_name":"ä½œè€…å›å¤","user_name_real":"å€ªæœ‹é£","uid":"1001282","ctime":1544311793,"ip_address":"","comment_id":47978,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1544276428","product_id":100020901,"comment_content":"è¿™é‡Œä¸¤ä¸ªè™šæ‹Ÿæœºæ˜¯ä¸¤ä¸ªubuntuçš„osï¼Œè¿˜æ˜¯ä¸¤ä¸ªdocker","like_count":0,"discussions":[{"author":{"id":1001282,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/47/42/5b55bd1a.jpg","nickname":"å€ªæœ‹é£","note":"","ucode":"F0FAC195CDE7AC","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":431968,"discussion_content":"ä¸¤ä¸ªè™šæ‹Ÿæœºï¼Œè¿™æ˜¯ä¸ºäº†é¿å…abå¹²æ‰°æ€§èƒ½åˆ†æçš„è¿‡ç¨‹","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1544311793,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":47733,"user_name":"shuifa","can_delete":false,"product_type":"c1","uid":1040063,"ip_address":"","ucode":"636733F5C88A7B","user_header":"https://static001.geekbang.org/account/avatar/00/0f/de/bf/4df4224d.jpg","comment_is_top":false,"comment_ctime":1544188926,"is_pvip":false,"replies":[{"id":"17006","content":"ä¸‹ä¸€ç¯‡å¾—å‘å¸ƒå‡ºæ¥æ‰èƒ½æœ‰é“¾æ¥ğŸ˜“ è¿™äº›é“¾æ¥å¯èƒ½è¦äº‹åæ‰èƒ½åŠ è¿›æ¥ã€‚","user_name":"ä½œè€…å›å¤","user_name_real":"å€ªæœ‹é£","uid":"1001282","ctime":1544192946,"ip_address":"","comment_id":47733,"utype":1}],"discussion_count":1,"race_medal":1,"score":"1544188926","product_id":100020901,"comment_content":"åˆæŒæ¡æ–°å§¿åŠ¿äº†ï¼é—®ä¸‹ï¼Œè€å¸ˆæ–‡ç« æœ«å°¾èƒ½å¦åŠ ä¸‹ä¸Šä¸€ç¯‡å’Œä¸‹ä¸€ç¯‡çš„é“¾æ¥å‘¢ï¼Œçœ‹å…¶å®ƒä¸“æ æœ‰è¿™ä¸ªï¼Œä»¥ä¸ºæ˜¯appçš„åŠŸèƒ½å‘¢","like_count":0,"discussions":[{"author":{"id":1001282,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/47/42/5b55bd1a.jpg","nickname":"å€ªæœ‹é£","note":"","ucode":"F0FAC195CDE7AC","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":431875,"discussion_content":"ä¸‹ä¸€ç¯‡å¾—å‘å¸ƒå‡ºæ¥æ‰èƒ½æœ‰é“¾æ¥ğŸ˜“ è¿™äº›é“¾æ¥å¯èƒ½è¦äº‹åæ‰èƒ½åŠ è¿›æ¥ã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1544192946,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":47108,"user_name":"å°å¼º","can_delete":false,"product_type":"c1","uid":1294353,"ip_address":"","ucode":"154A18AD4028F3","user_header":"https://static001.geekbang.org/account/avatar/00/13/c0/11/3d59119f.jpg","comment_is_top":false,"comment_ctime":1544058918,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1544058918","product_id":100020901,"comment_content":"æ‰“å¡","like_count":0},{"had_liked":false,"id":47083,"user_name":"Linuxäº‘è®¡ç®—ç½‘ç»œ","can_delete":false,"product_type":"c1","uid":1114062,"ip_address":"","ucode":"8E1F8B049D3C95","user_header":"https://static001.geekbang.org/account/avatar/00/10/ff/ce/73ee54bf.jpg","comment_is_top":false,"comment_ctime":1544052491,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1544052491","product_id":100020901,"comment_content":"mark","like_count":0},{"had_liked":false,"id":46710,"user_name":"å¡å¡","can_delete":false,"product_type":"c1","uid":1064855,"ip_address":"","ucode":"E696CC0386FA27","user_header":"https://static001.geekbang.org/account/avatar/00/10/3f/97/8d7a6460.jpg","comment_is_top":false,"comment_ctime":1543973241,"is_pvip":false,"replies":[{"id":"16773","content":"è¿™é‡Œçš„æ„æ€æ˜¯æŠŠå®¹å™¨å†…éƒ¨çš„&#47;appç›®å½•æ‹·è´åˆ°å½“å‰ç›®å½•ä¸­ã€‚æ‰€ä»¥ä½ å°±ä¼šåœ¨æ‰§è¡Œè¿™æ¡å‘½ä»¤çš„ç›®å½•ä¸­çœ‹åˆ°ä¸€ä¸ªæ–°çš„appç›®å½•","user_name":"ä½œè€…å›å¤","user_name_real":"å€ªæœ‹é£","uid":"1001282","ctime":1544018743,"ip_address":"","comment_id":46710,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1543973241","product_id":100020901,"comment_content":"docker cp phpfpm:&#47;app .<br>phpfpm:&#47;app æ˜¯ä»€ä¹ˆï¼Ÿæ˜¯ä¸€ä¸ªæ–‡ä»¶å—ï¼Ÿæ€ä¹ˆç¡®è®¤æ˜¯è¦è¿›å…¥åˆ°appï¼Ÿè€Œä¸æ˜¯åˆ«çš„åœ°æ–¹ï¼Ÿ","like_count":0,"discussions":[{"author":{"id":1001282,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/47/42/5b55bd1a.jpg","nickname":"å€ªæœ‹é£","note":"","ucode":"F0FAC195CDE7AC","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":431512,"discussion_content":"è¿™é‡Œçš„æ„æ€æ˜¯æŠŠå®¹å™¨å†…éƒ¨çš„/appç›®å½•æ‹·è´åˆ°å½“å‰ç›®å½•ä¸­ã€‚æ‰€ä»¥ä½ å°±ä¼šåœ¨æ‰§è¡Œè¿™æ¡å‘½ä»¤çš„ç›®å½•ä¸­çœ‹åˆ°ä¸€ä¸ªæ–°çš„appç›®å½•","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1544018743,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":46677,"user_name":"é˜¿å·-è±†å¤«","can_delete":false,"product_type":"c1","uid":1005123,"ip_address":"","ucode":"732188848B0A85","user_header":"https://static001.geekbang.org/account/avatar/00/0f/56/43/abb7bfe3.jpg","comment_is_top":false,"comment_ctime":1543970870,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1543970870","product_id":100020901,"comment_content":"è€å¸ˆï¼Œæˆ‘è¿™é‡Œæ˜¯ä¸ªjavaåº”ç”¨ï¼Œç”¨top jstackè¿½è¸ªä»£ç ï¼Œå‘ç°cpuæ ‡é«˜å‘ç”Ÿåœ¨ä¸€ä¸ªåŠ¨æ€å­—èŠ‚ç ç”Ÿæˆçš„ç±»ï¼Œç„¶åè¿™å—æ˜¯æ²¡æœ‰æºç çš„ï¼Œæ˜¯ä¸çŸ¥é“é‚£ä¸€æ®µå‡½æ•°çš„è°ƒç”¨å¼•èµ·çš„ã€‚ç„¶åç”¨perf top -v å¯ä»¥å‘ç°è¿™ä¸ªåº”ç”¨ï¼Œkernal _spin_lock è¿™ä¸ªé•¿æœŸå ç”¨80%çš„cpu æˆ‘ç°åœ¨ä¸€ç‚¹åŠæ³•éƒ½æ²¡æœ‰ï¼Œå› ä¸ºæˆ‘ä¸çŸ¥é“åº”ç”¨ä¸­é‚£æ®µç¨‹åºä½¿ç”¨äº†è‡ªæ—‹é”ï¼Œè¿™ä¸ªæœ‰ä»€ä¹ˆåŠæ³•è¿½è¸ªæ•´ä¸ªè°ƒç”¨é“¾å‘¢ï¼Ÿ","like_count":0},{"had_liked":false,"id":46424,"user_name":"é£é£˜ï¼Œå¾ç‹¬æ€","can_delete":false,"product_type":"c1","uid":1131032,"ip_address":"","ucode":"4DF0E7DC22EE53","user_header":"https://static001.geekbang.org/account/avatar/00/11/42/18/edc1b373.jpg","comment_is_top":false,"comment_ctime":1543922687,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1543922687","product_id":100020901,"comment_content":"æ‰“å¡","like_count":0},{"had_liked":false,"id":46402,"user_name":"Enterprize","can_delete":false,"product_type":"c1","uid":1215130,"ip_address":"","ucode":"3C120E9023B6C5","user_header":"https://static001.geekbang.org/account/avatar/00/12/8a/9a/7270d764.jpg","comment_is_top":false,"comment_ctime":1543916350,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1543916350","product_id":100020901,"comment_content":"å°±ç»ªé˜Ÿï¦œä¸­å±…ç„¶æœ‰ 6 ä¸ª Running çŠ¶æ€çš„è¿›ç¨‹ï¼ˆ6 runningï¼‰ï¼Œæ˜¯ï¥§æ˜¯æœ‰ç‚¹å¤šå‘¢ï¼Ÿ<br><br>è¯·æ•™ä¸‹è¿™ä¸ª running å¤šå°‘æ˜¯æ€ä¹ˆçœ‹çš„å‘¢ï¼Ÿè°¢è°¢","like_count":0},{"had_liked":false,"id":46202,"user_name":"Geek_101627","can_delete":false,"product_type":"c1","uid":1070389,"ip_address":"","ucode":"F246019019F1CB","user_header":"https://static001.geekbang.org/account/avatar/00/10/55/35/09e7dfde.jpg","comment_is_top":false,"comment_ctime":1543884528,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1543884528","product_id":100020901,"comment_content":"æ‰“å¡","like_count":0},{"had_liked":false,"id":46145,"user_name":"æ¹–æ¹˜å¿—","can_delete":false,"product_type":"c1","uid":1285578,"ip_address":"","ucode":"C8B069B3AD4FEA","user_header":"https://thirdwx.qlogo.cn/mmopen/vi_32/DYAIOgq83erJR5Kj0Xm6LykFHLaWqHjQiaroVxgdoGI7uHEGz2D3PfibWNkBYP23QLzFmcuicgKLbqUch0ZJ2ZNOA/132","comment_is_top":false,"comment_ctime":1543853705,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1543853705","product_id":100020901,"comment_content":"D6","like_count":0},{"had_liked":false,"id":46092,"user_name":"å¤§é£","can_delete":false,"product_type":"c1","uid":1320080,"ip_address":"","ucode":"2D98888FC63CA9","user_header":"","comment_is_top":false,"comment_ctime":1543844960,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1543844960","product_id":100020901,"comment_content":"æ‰“å¡","like_count":0},{"had_liked":false,"id":46061,"user_name":"æ¨Šæµ·æ¶›","can_delete":false,"product_type":"c1","uid":1323249,"ip_address":"","ucode":"0B04D5985EE0E1","user_header":"https://static001.geekbang.org/account/avatar/00/14/30/f1/bf7fd8d2.jpg","comment_is_top":false,"comment_ctime":1543840391,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1543840391","product_id":100020901,"comment_content":"execsnoopè¿™ä¸ªå‘½ä»¤æ‰§è¡Œç¬¬ä¸€æ¬¡ï¼Œç¡®å®å‘ç°äº†å¥½å¤šstressè¿›ç¨‹ï¼›<br>ä½†æ˜¯åé¢å†æ‰§è¡Œçš„è¯å°±ä¸è¡Œäº†<br>","like_count":0},{"had_liked":false,"id":46041,"user_name":"æ¨Šæµ·æ¶›","can_delete":false,"product_type":"c1","uid":1323249,"ip_address":"","ucode":"0B04D5985EE0E1","user_header":"https://static001.geekbang.org/account/avatar/00/14/30/f1/bf7fd8d2.jpg","comment_is_top":false,"comment_ctime":1543838284,"is_pvip":false,"discussion_count":1,"race_medal":0,"score":"1543838284","product_id":100020901,"comment_content":"è¯·é—®è€å¸ˆexecsnoopè¿™ä¸ªå·¥å…·æ˜¯è¦è£…googleçš„perf-toolså—ï¼Ÿ","like_count":0,"discussions":[{"author":{"id":1013424,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/76/b0/14fec62f.jpg","nickname":"ä¸äº†å³°","note":"","ucode":"E23B96D6A3D4EC","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":540982,"discussion_content":"æ˜¯çš„  \n#ä¸‹è½½execsnoop#\n1 cd /usr/bin\n2 wget https://raw.githubusercontent.com/brendangregg/perf-tools/master/execsnoop\n3 chmod 755 execsnoop\n","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1640225228,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":46019,"user_name":"Aaron Cheung","can_delete":false,"product_type":"c1","uid":1079816,"ip_address":"","ucode":"03972759C53667","user_header":"https://static001.geekbang.org/account/avatar/00/10/7a/08/4d3e47dd.jpg","comment_is_top":false,"comment_ctime":1543834217,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1543834217","product_id":100020901,"comment_content":"æ‰“å¡","like_count":0},{"had_liked":false,"id":46018,"user_name":"Aaron Cheung","can_delete":false,"product_type":"c1","uid":1079816,"ip_address":"","ucode":"03972759C53667","user_header":"https://static001.geekbang.org/account/avatar/00/10/7a/08/4d3e47dd.jpg","comment_is_top":false,"comment_ctime":1543834198,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1543834198","product_id":100020901,"comment_content":"æ‰“å¡day07","like_count":0},{"had_liked":false,"id":45997,"user_name":"æœ‰é“­","can_delete":false,"product_type":"c1","uid":1046302,"ip_address":"","ucode":"2C7CB36CA5C04C","user_header":"http://thirdwx.qlogo.cn/mmopen/vi_32/3XbCueYYVWTiclv8T5tFpwiblOxLphvSZxL4ujMdqVMibZnOiaFK2C5nKRGv407iaAsrI0CDICYVQJtiaITzkjfjbvrQ/132","comment_is_top":false,"comment_ctime":1543829822,"is_pvip":false,"discussion_count":1,"race_medal":0,"score":"1543829822","product_id":100020901,"comment_content":"*.execsnoopè¿™ä¸ªå·¥å…·è«éæ˜¯Ubuntuç‹¬æœ‰çš„ï¼Ÿæˆ‘æ”¾ç‹—éƒ½æ²¡æ³•æ‰¾åˆ°CentOSä¸‹å¦‚ä½•å®‰è£…<br>*æˆ‘ç”¨perf topå¯¹MySQLæ£€æµ‹çš„æ—¶å€™å‘ç°äº†ä¸€ä¸ªå¥‡æ€ªçš„ç°è±¡ï¼Œå•ç‹¬ç”¨perf topå‘½ä»¤ï¼Œå’Œä½¿ç”¨perf top -på‘½ä»¤ç‹¬è‡ªé’ˆå¯¹mysqlçš„è¿›ç¨‹æ—¶ï¼Œæ˜¾ç¤ºçš„CPUå ç”¨ç‡æœ€é«˜çš„å‡½æ•°ï¼Œæ˜¯ä¸ä¸€æ ·çš„ï¼Œæ¯”å¦‚perf topæ—¶æ˜¾ç¤ºçš„mysqlå ç”¨cpuæœ€é«˜çš„å‡½æ•°æ˜¯row_search_mvccã€‚perf top -på‘½ä»¤æ˜¾ç¤ºçš„å‡½æ•°åç§°å´æ˜¯do_commandã€‚è¿™å¦‚ä½•è§£é‡Šï¼Ÿ","like_count":0,"discussions":[{"author":{"id":3065276,"avatar":"","nickname":"Geek_b3b8da","note":"","ucode":"5461CD95B1D764","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":591481,"discussion_content":"execsnoopè¿™ä¸ªå·¥å…·æœ‰2ç§æ–¹æ³•ä¸€æ˜¯å‡çº§å†…æ ¸2æ˜¯https://github.com/brendangregg/perf-tools","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1666597837,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":"æµ™æ±Ÿ"},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":45967,"user_name":"LeonğŸ“·","can_delete":false,"product_type":"c1","uid":1219496,"ip_address":"","ucode":"B9BBD1EFAAE5A2","user_header":"https://static001.geekbang.org/account/avatar/00/12/9b/a8/6a391c66.jpg","comment_is_top":false,"comment_ctime":1543826163,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1543826163","product_id":100020901,"comment_content":"çœ‹åˆ°å…¶ä»–çš„å°ä¼™ä¼´çš„ç•™è¨€ï¼Œä¹Ÿè·Ÿæˆ‘ä¸€æ ·çš„é‡åˆ°é—®é¢˜äº†ï¼Œå¸Œæœ›è€å¸ˆèƒ½é›†ä¸­è§£ç­”ä¸‹","like_count":0},{"had_liked":false,"id":45966,"user_name":"LeonğŸ“·","can_delete":false,"product_type":"c1","uid":1219496,"ip_address":"","ucode":"B9BBD1EFAAE5A2","user_header":"https://static001.geekbang.org/account/avatar/00/12/9b/a8/6a391c66.jpg","comment_is_top":false,"comment_ctime":1543826115,"is_pvip":false,"replies":[{"id":"16414","content":"åªçœ‹åˆ°åœ°å€è€Œä¸æ˜¯å‡½æ•°åæ˜¯ç”±äºåº”ç”¨ç¨‹åºè¿è¡Œåœ¨å®¹å™¨ä¸­ï¼Œå®ƒçš„ä¾èµ–ä¹Ÿéƒ½åœ¨å®¹å™¨å†…éƒ¨ï¼Œæ•…è€Œperfæ— æ³•æ‰¾åˆ°PHPç¬¦å·è¡¨ã€‚ä¸€ä¸ªç®€å•çš„è§£å†³æ–¹æ³•æ˜¯ä½¿ç”¨perf recordç”Ÿæˆperf.dataæ‹·è´åˆ°å®¹å™¨å†…éƒ¨å†æ‰§è¡Œ perf report æ¥åˆ†æã€‚","user_name":"ä½œè€…å›å¤","user_name_real":"å€ªæœ‹é£","uid":"1001282","ctime":1543829829,"ip_address":"","comment_id":45966,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1543826115","product_id":100020901,"comment_content":"è€å¸ˆï¼Œæˆ‘æŒ‰ç…§ä½ çš„æ“ä½œæ²¡æœ‰çœ‹åˆ°è°ƒç”¨çš„å‡½æ•°ï¼Œéš¾é“æ˜¯ç³»ç»Ÿé—®é¢˜æˆ–è€…æ˜¯è½¯ä»¶ç‰ˆæœ¬é—®é¢˜ï¼Œä½ èƒ½ç»™ä¸ªé‚®ç®±å—ï¼Œæˆ‘æŠŠé—®é¢˜æˆªå›¾å’Œæè¿°å‘ç»™ä½ ï¼Œè¿™é‡Œé¢è¯´ä¸æ¸…æ¥š","like_count":0,"discussions":[{"author":{"id":1001282,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/47/42/5b55bd1a.jpg","nickname":"å€ªæœ‹é£","note":"","ucode":"F0FAC195CDE7AC","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":431292,"discussion_content":"åªçœ‹åˆ°åœ°å€è€Œä¸æ˜¯å‡½æ•°åæ˜¯ç”±äºåº”ç”¨ç¨‹åºè¿è¡Œåœ¨å®¹å™¨ä¸­ï¼Œå®ƒçš„ä¾èµ–ä¹Ÿéƒ½åœ¨å®¹å™¨å†…éƒ¨ï¼Œæ•…è€Œperfæ— æ³•æ‰¾åˆ°PHPç¬¦å·è¡¨ã€‚ä¸€ä¸ªç®€å•çš„è§£å†³æ–¹æ³•æ˜¯ä½¿ç”¨perf recordç”Ÿæˆperf.dataæ‹·è´åˆ°å®¹å™¨å†…éƒ¨å†æ‰§è¡Œ perf report æ¥åˆ†æã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1543829829,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":45889,"user_name":"é¥¼å­","can_delete":false,"product_type":"c1","uid":1085953,"ip_address":"","ucode":"981A44836A5216","user_header":"https://static001.geekbang.org/account/avatar/00/10/92/01/c723d180.jpg","comment_is_top":false,"comment_ctime":1543813146,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1543813146","product_id":100020901,"comment_content":"ä¸€èˆ¬éƒ½æ˜¯æ‰¾åˆ°æœ‰é—®é¢˜çš„è¿›ç¨‹ï¼Œç„¶åpsæ‰¾åˆ°å¯¹åº”çš„PPID","like_count":0},{"had_liked":false,"id":45886,"user_name":"èŠ±ä¼¼é›¾ä¸­çœ‹","can_delete":false,"product_type":"c1","uid":1317682,"ip_address":"","ucode":"D9979D86CB7AD9","user_header":"https://static001.geekbang.org/account/avatar/00/14/1b/32/467683eb.jpg","comment_is_top":false,"comment_ctime":1543812156,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1543812156","product_id":100020901,"comment_content":"markï¼","like_count":0},{"had_liked":false,"id":45883,"user_name":"æœ«ç­è½¦","can_delete":false,"product_type":"c1","uid":1335855,"ip_address":"","ucode":"FC7A7AB51A9C8C","user_header":"https://static001.geekbang.org/account/avatar/00/14/62/2f/bb04ae52.jpg","comment_is_top":false,"comment_ctime":1543811168,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1543811168","product_id":100020901,"comment_content":"æ‰“å¡ï¼Œæ‰“å¡ï¼ŒçŒœåˆ°äº†ï¼Œä½†æ²¡æœ‰ä¸‹æ‰‹çš„æ–¹æ³•ï¼Œå­¦åˆ°äº†","like_count":0},{"had_liked":false,"id":45847,"user_name":"æ¨Šæµ·æ¶›","can_delete":false,"product_type":"c1","uid":1323249,"ip_address":"","ucode":"0B04D5985EE0E1","user_header":"https://static001.geekbang.org/account/avatar/00/14/30/f1/bf7fd8d2.jpg","comment_is_top":false,"comment_ctime":1543803212,"is_pvip":false,"replies":[{"id":"16424","content":"åªçœ‹åˆ°åœ°å€è€Œä¸æ˜¯å‡½æ•°åæ˜¯ç”±äºåº”ç”¨ç¨‹åºè¿è¡Œåœ¨å®¹å™¨ä¸­ï¼Œå®ƒçš„ä¾èµ–ä¹Ÿéƒ½åœ¨å®¹å™¨å†…éƒ¨ï¼Œæ•…è€Œperfæ— æ³•æ‰¾åˆ°PHPç¬¦å·è¡¨ã€‚ä¸€ä¸ªç®€å•çš„è§£å†³æ–¹æ³•æ˜¯ä½¿ç”¨perf recordç”Ÿæˆperf.dataæ‹·è´åˆ°å®¹å™¨å†…éƒ¨å†æ‰§è¡Œ perf report æ¥åˆ†æã€‚","user_name":"ä½œè€…å›å¤","user_name_real":"å€ªæœ‹é£","uid":"1001282","ctime":1543831628,"ip_address":"","comment_id":45847,"utype":1}],"discussion_count":2,"race_medal":0,"score":"1543803212","product_id":100020901,"comment_content":"day7æ‰“å¡ï¼Œä¸Šä¸€èŠ‚ä¸­é—ç•™é—®é¢˜<br>perf top -p -g pid æ— æ³•å®šä½åˆ°sqrtå‡½æ•°ï¼Œè€å¸ˆæœ‰æ—¶é—´è§£ç­”ä¸‹ï¼Œè°¢è°¢ğŸ™","like_count":0,"discussions":[{"author":{"id":1001282,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/47/42/5b55bd1a.jpg","nickname":"å€ªæœ‹é£","note":"","ucode":"F0FAC195CDE7AC","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":431237,"discussion_content":"åªçœ‹åˆ°åœ°å€è€Œä¸æ˜¯å‡½æ•°åæ˜¯ç”±äºåº”ç”¨ç¨‹åºè¿è¡Œåœ¨å®¹å™¨ä¸­ï¼Œå®ƒçš„ä¾èµ–ä¹Ÿéƒ½åœ¨å®¹å™¨å†…éƒ¨ï¼Œæ•…è€Œperfæ— æ³•æ‰¾åˆ°PHPç¬¦å·è¡¨ã€‚ä¸€ä¸ªç®€å•çš„è§£å†³æ–¹æ³•æ˜¯ä½¿ç”¨perf recordç”Ÿæˆperf.dataæ‹·è´åˆ°å®¹å™¨å†…éƒ¨å†æ‰§è¡Œ perf report æ¥åˆ†æã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1543831628,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":3065276,"avatar":"","nickname":"Geek_b3b8da","note":"","ucode":"5461CD95B1D764","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":591480,"discussion_content":"å¯ä»¥åœ¨å®¿ä¸»æœºè¿è¡ŒperfæŠŠç»“æœæ‹·è´è¿›å®¹å™¨é‡Œé¢å»å®‰è£…perfç„¶åæŸ¥çœ‹","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1666597765,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":"æµ™æ±Ÿ"},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":45846,"user_name":"æˆ‘æ¥ä¹Ÿ","can_delete":false,"product_type":"c1","uid":1205253,"ip_address":"","ucode":"773D6104F56767","user_header":"https://static001.geekbang.org/account/avatar/00/12/64/05/6989dce6.jpg","comment_is_top":false,"comment_ctime":1543803209,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1543803209","product_id":100020901,"comment_content":"[D6æ‰“å¡]<br>åˆå­¦äº†ä¸ªä¹–ã€‚<br>è™½ç„¶å‰é¢çŒœåˆ°äº†å¯èƒ½æ˜¯çŸ­æ—¶è¿›ç¨‹ï¼Œä½†æ˜¯æ²¡æƒ³åˆ°å±…ç„¶æœ‰ä¸“ç”¨å·¥å…·æ¥åˆ†æã€‚<br>è¦æ˜¯ä»¥å‰,å¯èƒ½ä¼šå‚»å‚»çš„å¤šåˆ·å‡ æ¬¡ps aufxï¼Œç„¶åæ‰¾è¿™äº›ä¸´æ—¶è¿›ç¨‹çš„çˆ¶pidï¼Œè€Œä¸ä¼šç›´æ¥ç”¨pstreeäº†ã€‚<br>ç›®å‰å‡ ä¸ªæµ‹è¯•ç¯å¢ƒæ¯”è¾ƒç®€å•ï¼Œåªéœ€è¦ä¸€ä¸ªè™šæ‹Ÿæœºå³å¯ï¼Œå¦ä¸€ä¸ªç›´æ¥åœ¨ç‰©ç†æœºä¸Šç”¨abå‘½ä»¤ï¼Œæˆ–è€…åœ¨ç‰©ç†æœºä¸Šè£…dockerã€‚","like_count":0},{"had_liked":false,"id":45832,"user_name":"C","can_delete":false,"product_type":"c1","uid":1171389,"ip_address":"","ucode":"74B4B21EA7D0C3","user_header":"https://static001.geekbang.org/account/avatar/00/11/df/bd/46614a70.jpg","comment_is_top":false,"comment_ctime":1543801596,"is_pvip":false,"replies":[{"id":"16425","content":"è°¢è°¢ï¼ŒåŠ æ²¹ğŸ‘","user_name":"ä½œè€…å›å¤","user_name_real":"å€ªæœ‹é£","uid":"1001282","ctime":1543831647,"ip_address":"","comment_id":45832,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1543801596","product_id":100020901,"comment_content":"ä»Šå¤©å†…å®¹ç»™åŠ›å‘¢ï¼Œå¤šè®¤è¯†ä¸¤ä¸ªæ–°å·¥å…·ï¼Œç»™è€å¸ˆç‚¹èµ","like_count":0,"discussions":[{"author":{"id":1001282,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/47/42/5b55bd1a.jpg","nickname":"å€ªæœ‹é£","note":"","ucode":"F0FAC195CDE7AC","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":431228,"discussion_content":"è°¢è°¢ï¼ŒåŠ æ²¹ğŸ‘","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1543831647,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":45823,"user_name":"ä»˜ç›¼æ˜Ÿ","can_delete":false,"product_type":"c1","uid":1055542,"ip_address":"","ucode":"E0E4B74E8B361F","user_header":"https://static001.geekbang.org/account/avatar/00/10/1b/36/abe6d066.jpg","comment_is_top":false,"comment_ctime":1543800642,"is_pvip":false,"replies":[{"id":"16434","content":"è¿™ä¸ªé—®é¢˜è·Ÿä»Šå¤©çš„æ¡ˆä¾‹æœ‰ç‚¹ç±»ä¼¼ï¼Œéœ€è¦æ‰¾å‡ºè¿™äº›è¿›ç¨‹çš„çˆ¶è¿›ç¨‹ï¼ŒæŠŠçˆ¶è¿›ç¨‹æ¸…ç†æ‰ã€‚<br><br>æˆ‘çš„å»ºè®®æ˜¯ä¸¤ä¸ªæ€è·¯ï¼š<br><br>1. è·Ÿæœ¬æ–‡ç±»ä¼¼ï¼Œç”¨ç±»ä¼¼execsnoopçš„æ–¹æ³•è·Ÿè¸ªforkè°ƒç”¨ï¼Œå®šä½å‡ºçˆ¶è¿›ç¨‹ï¼Œå†æŠŠå®ƒæ¸…ç†æ‰<br>2. é‡è£…ç³»ç»Ÿ<br><br>æˆ‘æ›´æ¨èé‡è£…ç³»ç»Ÿï¼Œå› ä¸ºå³ä½¿å®šä½å‡ºæ¥è¿™äº›è¿›ç¨‹çš„æ ¹æºï¼Œä¹Ÿä¸èƒ½ç¡®ä¿å…¶ä»–åœ°æ–¹å°±æ²¡æœ‰è¢«æ„ŸæŸ“ã€‚","user_name":"ä½œè€…å›å¤","user_name_real":"å€ªæœ‹é£","uid":"1001282","ctime":1543832444,"ip_address":"","comment_id":45823,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1543800642","product_id":100020901,"comment_content":"è€å¸ˆå¥½ï¼Œä¹‹å‰å°±é‡åˆ°è¿‡ä¸€æ¬¡çŸ­è¿›ç¨‹çš„é—®é¢˜å¯¼è‡´cpuä½¿ç”¨ç‡è¿‡é«˜ï¼Œå› ä¸ºæˆ‘ä»¬å‘å¸ƒåº”ç”¨ç”¨çš„æ˜¯å®¹å™¨ï¼ŒæŠŠé‡å¯ç­–ç•¥è®¾ç½®ä¸ºalwaysï¼Œç»“æœå®¹å™¨å¯åŠ¨æ—¶å€™è°ƒç”¨java -jar å¯åŠ¨åº”ç”¨ï¼Œå› ä¸ºé…ç½®åŸå› ï¼Œæ— æ³•å¯åŠ¨ï¼Œç„¶åå®ƒå°±ä¸åœå¯åŠ¨ï¼Œç°è±¡æ˜¯cpuä½¿ç”¨ç‡è¿‡é«˜ï¼Œå¥½åœ¨ç”¨topèƒ½å‘ç°ï¼Œæ¯•ç«Ÿè¿›ç¨‹ä¸€ç›´åœ¨ã€‚ä¸è¿‡è¿˜æœ‰ä¸ªåœºæ™¯å°±æ¯”è¾ƒéš¾æäº†ï¼Œç³»ç»Ÿè¢«å…¥ä¾µï¼Œä¸åœå¯åŠ¨è¿›ç¨‹æ¶ˆè€—èµ„æºï¼Œä½ æ€æ‰ä¹‹åï¼Œå®ƒåˆå¯åŠ¨æ–°çš„è¿›ç¨‹ï¼Œpidä¹Ÿä¸åŒï¼Œè¿™ç§æƒ…å†µï¼Œæœ‰å¤„ç†åŠæ³•ä¹ˆï¼Ÿ","like_count":0,"discussions":[{"author":{"id":1001282,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/47/42/5b55bd1a.jpg","nickname":"å€ªæœ‹é£","note":"","ucode":"F0FAC195CDE7AC","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":431220,"discussion_content":"è¿™ä¸ªé—®é¢˜è·Ÿä»Šå¤©çš„æ¡ˆä¾‹æœ‰ç‚¹ç±»ä¼¼ï¼Œéœ€è¦æ‰¾å‡ºè¿™äº›è¿›ç¨‹çš„çˆ¶è¿›ç¨‹ï¼ŒæŠŠçˆ¶è¿›ç¨‹æ¸…ç†æ‰ã€‚\n\næˆ‘çš„å»ºè®®æ˜¯ä¸¤ä¸ªæ€è·¯ï¼š\n\n1. è·Ÿæœ¬æ–‡ç±»ä¼¼ï¼Œç”¨ç±»ä¼¼execsnoopçš„æ–¹æ³•è·Ÿè¸ªforkè°ƒç”¨ï¼Œå®šä½å‡ºçˆ¶è¿›ç¨‹ï¼Œå†æŠŠå®ƒæ¸…ç†æ‰\n2. é‡è£…ç³»ç»Ÿ\n\næˆ‘æ›´æ¨èé‡è£…ç³»ç»Ÿï¼Œå› ä¸ºå³ä½¿å®šä½å‡ºæ¥è¿™äº›è¿›ç¨‹çš„æ ¹æºï¼Œä¹Ÿä¸èƒ½ç¡®ä¿å…¶ä»–åœ°æ–¹å°±æ²¡æœ‰è¢«æ„ŸæŸ“ã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1543832444,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":45819,"user_name":"ä¸€ç¦…å°å’Œå°š","can_delete":false,"product_type":"c1","uid":1182806,"ip_address":"","ucode":"5A2A0875DE062A","user_header":"https://static001.geekbang.org/account/avatar/00/12/0c/56/02fba09b.jpg","comment_is_top":false,"comment_ctime":1543800000,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1543800000","product_id":100020901,"comment_content":"æ‰“å¡","like_count":0},{"had_liked":false,"id":45818,"user_name":"ä¸€ç¦…å°å’Œå°š","can_delete":false,"product_type":"c1","uid":1182806,"ip_address":"","ucode":"5A2A0875DE062A","user_header":"https://static001.geekbang.org/account/avatar/00/12/0c/56/02fba09b.jpg","comment_is_top":false,"comment_ctime":1543799999,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1543799999","product_id":100020901,"comment_content":"æ‰“å¡","like_count":0},{"had_liked":false,"id":45786,"user_name":"ninuxer","can_delete":false,"product_type":"c1","uid":1243135,"ip_address":"","ucode":"5394ADAF2667D6","user_header":"https://wx.qlogo.cn/mmopen/vi_32/PiajxSqBRaEKQMM4m7NHuicr55aRiblTSEWIYe0QqbpyHweaoAbG7j2v7UUElqqeP3Ihrm3UfDPDRb1Hv8LvPwXqA/132","comment_is_top":false,"comment_ctime":1543796455,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1543796455","product_id":100020901,"comment_content":"æ‰“å¡ï¼Œday7<br>ç¬”è®°ï¼šå½“cpuä½¿ç”¨ç‡é«˜ï¼Œä½†ç”¨topç­‰å¸¸è§„å·¥å…·ï¼Œè§‚å¯Ÿè¿›ç¨‹ä½¿ç”¨ç‡å¹¶ä¸é«˜æ—¶ï¼Œè¦ä¼˜å…ˆè€ƒè™‘ç°æœ‰è¿›ç¨‹å¯åŠ¨çš„ä¸€äº›ç¬æ—¶è¿›ç¨‹ï¼Œæ­¤ç±»è¿›ç¨‹æ‰§è¡Œå‘¨æœŸçŸ­ï¼Œä¸æ˜“å¯Ÿè§‰ï¼Œè¿›ç¨‹è‡ªèº«æœ‰å¯èƒ½å› ä¸ºé€»è¾‘æˆ–å†…éƒ¨é”™è¯¯å¼•å‘cpuå ç”¨é«˜<br>å·¥å…·ï¼šperfç»Ÿè®¡ä¸€æ®µæ—¶é—´å†…çš„æ€§èƒ½æŠ¥å‘Šï¼Œæˆ–execsnoop(å¯æŸ¥çœ‹åˆ°ç¬æ—¶è¿›ç¨‹çš„ä¿¡æ¯)è¿›è¡Œåˆ†æ","like_count":0},{"had_liked":false,"id":45779,"user_name":"ä½è°ƒ","can_delete":false,"product_type":"c1","uid":1087237,"ip_address":"","ucode":"F4F001639091E0","user_header":"https://static001.geekbang.org/account/avatar/00/10/97/05/17cf5840.jpg","comment_is_top":false,"comment_ctime":1543795248,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1543795248","product_id":100020901,"comment_content":"æ‰“å¡","like_count":0}]}