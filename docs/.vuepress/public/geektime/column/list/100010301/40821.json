{"id":40821,"title":"31 | Javaè™šæ‹Ÿæœºçš„ç›‘æ§åŠè¯Šæ–­å·¥å…·ï¼ˆGUIç¯‡ï¼‰","content":"<p>ä»Šå¤©æˆ‘ä»¬æ¥ç»§ç»­äº†è§£Javaè™šæ‹Ÿæœºçš„ç›‘æ§åŠè¯Šæ–­å·¥å…·ã€‚</p>\n<h2>eclipse MAT</h2>\n<p>åœ¨ä¸Šä¸€ç¯‡ä¸­ï¼Œæˆ‘ä»‹ç»äº†<code>jmap</code>å·¥å…·ï¼Œå®ƒæ”¯æŒå¯¼å‡ºJavaè™šæ‹Ÿæœºå †çš„äºŒè¿›åˆ¶å¿«ç…§ã€‚eclipseçš„<a href=\"https://www.eclipse.org/mat/\">MATå·¥å…·</a>ä¾¿æ˜¯å…¶ä¸­ä¸€ä¸ªèƒ½å¤Ÿè§£æè¿™ç±»äºŒè¿›åˆ¶å¿«ç…§çš„å·¥å…·ã€‚</p>\n<p>MATæœ¬èº«ä¹Ÿèƒ½å¤Ÿè·å–å †çš„äºŒè¿›åˆ¶å¿«ç…§ã€‚è¯¥åŠŸèƒ½å°†å€ŸåŠ©<code>jps</code>åˆ—å‡ºå½“å‰æ­£åœ¨è¿è¡Œçš„Javaè¿›ç¨‹ï¼Œä»¥ä¾›é€‰æ‹©å¹¶è·å–å¿«ç…§ã€‚ç”±äº<code>jps</code>ä¼šå°†è‡ªå·±åˆ—å…¥å…¶ä¸­ï¼Œå› æ­¤ä½ ä¼šåœ¨åˆ—è¡¨ä¸­å‘ç°ä¸€ä¸ªå·²ç»ç»“æŸè¿è¡Œçš„<code>jps</code>è¿›ç¨‹ã€‚</p>\n<p><img src=\"https://static001.geekbang.org/resource/image/c9/7e/c9072149fb112312cbc217acc2660c7e.png?wh=1280*894\" alt=\"\" /></p>\n<p>MATè·å–äºŒè¿›åˆ¶å¿«ç…§çš„æ–¹å¼æœ‰ä¸‰ç§ï¼Œä¸€æ˜¯ä½¿ç”¨Attach APIï¼ŒäºŒæ˜¯æ–°å»ºä¸€ä¸ªJavaè™šæ‹Ÿæœºæ¥è¿è¡ŒAttach APIï¼Œä¸‰æ˜¯ä½¿ç”¨<code>jmap</code>å·¥å…·ã€‚</p>\n<p>è¿™ä¸‰ç§æœ¬è´¨ä¸Šéƒ½æ˜¯åœ¨ä½¿ç”¨Attach APIã€‚ä¸è¿‡ï¼Œåœ¨ç›®æ ‡è¿›ç¨‹å¯ç”¨äº†<code>DisableAttachMechanism</code>å‚æ•°æ—¶ï¼Œå‰ä¸¤è€…å°†ä¸åœ¨é€‰å–åˆ—è¡¨ä¸­æ˜¾ç¤ºï¼Œåè€…å°†åœ¨è¿è¡Œæ—¶æŠ¥é”™ã€‚</p>\n<p>å½“åŠ è½½å®Œå †å¿«ç…§ä¹‹åï¼ŒMATçš„ä¸»ç•Œé¢å°†å±•ç¤ºä¸€å¼ é¥¼çŠ¶å›¾ï¼Œå…¶ä¸­åˆ—ä¸¾å æ®çš„Retained heapæœ€å¤šçš„å‡ ä¸ªå¯¹è±¡ã€‚</p>\n<p><img src=\"https://static001.geekbang.org/resource/image/da/bf/da2e5894d0be535b6daa5084beb33ebf.png?wh=1920*1116\" alt=\"\" /></p>\n<p>è¿™é‡Œè®²ä¸€ä¸‹MATè®¡ç®—å¯¹è±¡å æ®å†…å­˜çš„<a href=\"https://help.eclipse.org/mars/topic/org.eclipse.mat.ui.help/concepts/shallowretainedheap.html?cp=46_2_1\">ä¸¤ç§æ–¹å¼</a>ã€‚ç¬¬ä¸€ç§æ˜¯Shallow heapï¼ŒæŒ‡çš„æ˜¯å¯¹è±¡è‡ªèº«æ‰€å æ®çš„å†…å­˜ã€‚ç¬¬äºŒç§æ˜¯Retained heapï¼ŒæŒ‡çš„æ˜¯å½“å¯¹è±¡ä¸å†è¢«å¼•ç”¨æ—¶ï¼Œåƒåœ¾å›æ”¶å™¨æ‰€èƒ½å›æ”¶çš„æ€»å†…å­˜ï¼ŒåŒ…æ‹¬å¯¹è±¡è‡ªèº«æ‰€å æ®çš„å†…å­˜ï¼Œä»¥åŠä»…èƒ½å¤Ÿé€šè¿‡è¯¥å¯¹è±¡å¼•ç”¨åˆ°çš„å…¶ä»–å¯¹è±¡æ‰€å æ®çš„å†…å­˜ã€‚ä¸Šé¢çš„é¥¼çŠ¶å›¾ä¾¿æ˜¯åŸºäºRetained heapçš„ã€‚</p><!-- [[[read_end]]] -->\n<p>MATåŒ…æ‹¬äº†ä¸¤ä¸ªæ¯”è¾ƒé‡è¦çš„è§†å›¾ï¼Œåˆ†åˆ«æ˜¯ç›´æ–¹å›¾ï¼ˆhistogramï¼‰å’Œæ”¯é…æ ‘ï¼ˆdominator treeï¼‰ã€‚</p>\n<p><img src=\"https://static001.geekbang.org/resource/image/bb/05/bbb59ca4d86c227dac23f30c360c9405.png?wh=1510*1394\" alt=\"\" /></p>\n<p>MATçš„ç›´æ–¹å›¾å’Œ<code>jmap</code>çš„<code>-histo</code>å­å‘½ä»¤ä¸€æ ·ï¼Œéƒ½èƒ½å¤Ÿå±•ç¤ºå„ä¸ªç±»çš„å®ä¾‹æ•°ç›®ä»¥åŠè¿™äº›å®ä¾‹çš„Shallow heapæ€»å’Œã€‚ä½†æ˜¯ï¼ŒMATçš„ç›´æ–¹å›¾è¿˜èƒ½å¤Ÿè®¡ç®—Retained heapï¼Œå¹¶æ”¯æŒåŸºäºå®ä¾‹æ•°ç›®æˆ–Retained heapçš„æ’åºæ–¹å¼ï¼ˆé»˜è®¤ä¸ºShallow heapï¼‰ã€‚æ­¤å¤–ï¼ŒMATè¿˜å¯ä»¥å°†ç›´æ–¹å›¾ä¸­çš„ç±»æŒ‰ç…§è¶…ç±»ã€ç±»åŠ è½½å™¨æˆ–è€…åŒ…ååˆ†ç»„ã€‚</p>\n<p>å½“é€‰ä¸­æŸä¸ªç±»æ—¶ï¼ŒMATç•Œé¢å·¦ä¸Šè§’çš„Inspectorçª—å£å°†å±•ç¤ºè¯¥ç±»çš„Classå®ä¾‹çš„ç›¸å…³ä¿¡æ¯ï¼Œå¦‚ç±»åŠ è½½å™¨ç­‰ã€‚ï¼ˆä¸‹å›¾ä¸­çš„<code>ClassLoader @ 0x0</code>æŒ‡çš„ä¾¿æ˜¯å¯åŠ¨ç±»åŠ è½½å™¨ã€‚ï¼‰</p>\n<p><img src=\"https://static001.geekbang.org/resource/image/dd/ab/dde7022060fad3945944fb7e4c9926ab.png?wh=1550*648\" alt=\"\" /></p>\n<p>æ”¯é…æ ‘çš„æ¦‚å¿µæºè‡ªå›¾è®ºã€‚åœ¨ä¸€åˆ™æµå›¾ï¼ˆflow diagramï¼‰ä¸­ï¼Œå¦‚æœä»å…¥å£èŠ‚ç‚¹åˆ°bèŠ‚ç‚¹çš„æ‰€æœ‰è·¯å¾„éƒ½è¦ç»è¿‡aèŠ‚ç‚¹ï¼Œé‚£ä¹ˆaæ”¯é…ï¼ˆdominateï¼‰bã€‚</p>\n<p>åœ¨aæ”¯é…bï¼Œä¸”aä¸åŒäºbçš„æƒ…å†µä¸‹ï¼ˆå³aä¸¥æ ¼æ”¯é…bï¼‰ï¼Œå¦‚æœä»aèŠ‚ç‚¹åˆ°bèŠ‚ç‚¹çš„æ‰€æœ‰è·¯å¾„ä¸­ä¸å­˜åœ¨æ”¯é…bçš„å…¶ä»–èŠ‚ç‚¹ï¼Œé‚£ä¹ˆaç›´æ¥æ”¯é…ï¼ˆimmediate dominateï¼‰bã€‚è¿™é‡Œçš„æ”¯é…æ ‘æŒ‡çš„ä¾¿æ˜¯ç”±èŠ‚ç‚¹çš„ç›´æ¥æ”¯é…èŠ‚ç‚¹æ‰€ç»„æˆçš„æ ‘çŠ¶ç»“æ„ã€‚</p>\n<p>æˆ‘ä»¬å¯ä»¥å°†å †ä¸­æ‰€æœ‰çš„å¯¹è±¡çœ‹æˆä¸€å¼ å¯¹è±¡å›¾ï¼Œæ¯ä¸ªå¯¹è±¡æ˜¯ä¸€ä¸ªå›¾èŠ‚ç‚¹ï¼Œè€ŒGC Rootsåˆ™æ˜¯å¯¹è±¡å›¾çš„å…¥å£ï¼Œå¯¹è±¡ä¹‹é—´çš„å¼•ç”¨å…³ç³»åˆ™æ„æˆäº†å¯¹è±¡å›¾ä¸­çš„æœ‰å‘è¾¹ã€‚è¿™æ ·ä¸€æ¥ï¼Œæˆ‘ä»¬ä¾¿èƒ½å¤Ÿæ„é€ å‡ºè¯¥å¯¹è±¡å›¾æ‰€å¯¹åº”çš„æ”¯é…æ ‘ã€‚</p>\n<p>MATå°†æŒ‰ç…§æ¯ä¸ªå¯¹è±¡Retained heapçš„å¤§å°æ’åˆ—è¯¥æ”¯é…æ ‘ã€‚å¦‚ä¸‹å›¾æ‰€ç¤ºï¼š</p>\n<p><img src=\"https://static001.geekbang.org/resource/image/0d/a6/0d4ea7f00d500db8a978ff0183a840a6.png?wh=1920*1045\" alt=\"\" /></p>\n<p>æ ¹æ®Retained heapçš„å®šä¹‰ï¼Œåªè¦èƒ½å¤Ÿå›æ”¶ä¸Šå›¾å³ä¾§çš„è¡¨ä¸­çš„ç¬¬ä¸€ä¸ªå¯¹è±¡ï¼Œé‚£ä¹ˆåƒåœ¾å›æ”¶å™¨ä¾¿èƒ½å¤Ÿé‡Šæ”¾å‡º13.6MBå†…å­˜ã€‚</p>\n<p>éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œå¯¹è±¡çš„å¼•ç”¨å‹å­—æ®µæœªå¿…å¯¹åº”æ”¯é…æ ‘ä¸­çš„çˆ¶å­èŠ‚ç‚¹å…³ç³»ã€‚å‡è®¾å¯¹è±¡aæ‹¥æœ‰ä¸¤ä¸ªå¼•ç”¨å‹å­—æ®µï¼Œåˆ†åˆ«æŒ‡å‘bå’Œcã€‚è€Œbå’Œcå„è‡ªæ‹¥æœ‰ä¸€ä¸ªå¼•ç”¨å‹å­—æ®µï¼Œä½†éƒ½æŒ‡å‘dã€‚å¦‚æœæ²¡æœ‰å…¶ä»–å¼•ç”¨æŒ‡å‘bã€cæˆ–dï¼Œé‚£ä¹ˆaç›´æ¥æ”¯é…bã€cå’Œdï¼Œè€Œbï¼ˆæˆ–cï¼‰å’Œdä¹‹é—´ä¸å­˜åœ¨æ”¯é…å…³ç³»ã€‚</p>\n<p>å½“åœ¨æ”¯é…æ ‘è§†å›¾ä¸­é€‰ä¸­æŸä¸€å¯¹è±¡æ—¶ï¼Œæˆ‘ä»¬è¿˜å¯ä»¥é€šè¿‡Path To GC RootsåŠŸèƒ½ï¼Œåå‘åˆ—å‡ºè¯¥å¯¹è±¡åˆ°GC Rootsçš„å¼•ç”¨è·¯å¾„ã€‚å¦‚ä¸‹å›¾æ‰€ç¤ºï¼š</p>\n<p><img src=\"https://static001.geekbang.org/resource/image/e0/e7/e04d55d955832bf681aba16dcffc2ee7.png?wh=1388*816\" alt=\"\" /></p>\n<p>MATè¿˜å°†è‡ªåŠ¨åŒ¹é…å†…å­˜æ³„æ¼ä¸­çš„å¸¸è§æ¨¡å¼ï¼Œå¹¶æ±‡æŠ¥æ½œåœ¨çš„å†…å­˜æ³„æ¼é—®é¢˜ã€‚å…·ä½“å¯å‚è€ƒè¯¥<a href=\"https://help.eclipse.org/mars/topic/org.eclipse.mat.ui.help/tasks/runningleaksuspectreport.html?cp=46_3_1\">å¸®åŠ©æ–‡æ¡£</a>ä»¥åŠ<a href=\"http://memoryanalyzer.blogspot.com/2008/05/automated-heap-dump-analysis-finding.html\">è¿™ç¯‡åšå®¢</a>ã€‚</p>\n<h2>Java Mission Control</h2>\n<blockquote>\n<p>æ³¨æ„ï¼šè‡ªJava 11å¼€å§‹ï¼Œæœ¬èŠ‚ä»‹ç»çš„JFRå·²ç»å¼€æºã€‚ä½†åœ¨ä¹‹å‰çš„Javaç‰ˆæœ¬ï¼ŒJFRå±äºCommercial Featureï¼Œéœ€è¦é€šè¿‡Javaè™šæ‹Ÿæœºå‚æ•°<code>-XX:+UnlockCommercialFeatures</code>å¼€å¯ã€‚</p>\n<p>æˆ‘ä¸ªäººä¸æ¸…æ¥šä¹Ÿä¸èƒ½å›ç­”å…³äºJava 11ä¹‹å‰çš„ç‰ˆæœ¬æ˜¯å¦ä»éœ€è¦å•†åŠ¡è®¸å¯ï¼ˆCommercial Licenseï¼‰çš„é—®é¢˜ã€‚è¯·å¦è¡Œå’¨è¯¢åå†ä½¿ç”¨ï¼Œæˆ–è€…ç›´æ¥ä½¿ç”¨Java 11ã€‚</p>\n<p><a href=\"http://jdk.java.net/jmc/\">Java Mission Control</a>ï¼ˆJMCï¼‰æ˜¯Javaè™šæ‹Ÿæœºå¹³å°ä¸Šçš„æ€§èƒ½ç›‘æ§å·¥å…·ã€‚å®ƒåŒ…å«ä¸€ä¸ªGUIå®¢æˆ·ç«¯ï¼Œä»¥åŠä¼—å¤šç”¨æ¥æ”¶é›†Javaè™šæ‹Ÿæœºæ€§èƒ½æ•°æ®çš„æ’ä»¶ï¼Œå¦‚JMX Consoleï¼ˆèƒ½å¤Ÿè®¿é—®ç”¨æ¥å­˜æ”¾è™šæ‹Ÿæœºå„ä¸ªå­ç³»ç»Ÿè¿è¡Œæ•°æ®çš„<a href=\"https://en.wikipedia.org/wiki/Java_Management_Extensions#Managed_beans\">MXBeans</a>ï¼‰ï¼Œä»¥åŠè™šæ‹Ÿæœºå†…ç½®çš„é«˜æ•ˆprofilingå·¥å…·Java Flight Recorderï¼ˆJFRï¼‰ã€‚</p>\n</blockquote>\n<p>JFRçš„æ€§èƒ½å¼€é”€å¾ˆå°ï¼Œåœ¨é»˜è®¤é…ç½®ä¸‹å¹³å‡ä½äº1%ã€‚ä¸å…¶ä»–å·¥å…·ç›¸æ¯”ï¼ŒJFRèƒ½å¤Ÿç›´æ¥è®¿é—®è™šæ‹Ÿæœºå†…çš„æ•°æ®ï¼Œå¹¶ä¸”ä¸ä¼šå½±å“è™šæ‹Ÿæœºçš„ä¼˜åŒ–ã€‚å› æ­¤ï¼Œå®ƒéå¸¸é€‚ç”¨äºç”Ÿäº§ç¯å¢ƒä¸‹æ»¡è´Ÿè·è¿è¡Œçš„Javaç¨‹åºã€‚</p>\n<p>å½“å¯ç”¨æ—¶ï¼ŒJFRå°†è®°å½•è¿è¡Œè¿‡ç¨‹ä¸­å‘ç”Ÿçš„ä¸€ç³»åˆ—äº‹ä»¶ã€‚å…¶ä¸­åŒ…æ‹¬Javaå±‚é¢çš„äº‹ä»¶ï¼Œå¦‚çº¿ç¨‹äº‹ä»¶ã€é”äº‹ä»¶ï¼Œä»¥åŠJavaè™šæ‹Ÿæœºå†…éƒ¨çš„äº‹ä»¶ï¼Œå¦‚æ–°å»ºå¯¹è±¡ã€åƒåœ¾å›æ”¶å’Œå³æ—¶ç¼–è¯‘äº‹ä»¶ã€‚</p>\n<p>æŒ‰ç…§å‘ç”Ÿæ—¶æœºä»¥åŠæŒç»­æ—¶é—´æ¥åˆ’åˆ†ï¼ŒJFRçš„äº‹ä»¶å…±æœ‰å››ç§ç±»å‹ï¼Œå®ƒä»¬åˆ†åˆ«ä¸ºä»¥ä¸‹å››ç§ã€‚</p>\n<ol>\n<li>ç¬æ—¶äº‹ä»¶ï¼ˆInstant Eventï¼‰ï¼Œç”¨æˆ·å…³å¿ƒçš„æ˜¯å®ƒä»¬å‘ç”Ÿä¸å¦ï¼Œä¾‹å¦‚å¼‚å¸¸ã€çº¿ç¨‹å¯åŠ¨äº‹ä»¶ã€‚</li>\n<li>æŒç»­äº‹ä»¶ï¼ˆDuration Eventï¼‰ï¼Œç”¨æˆ·å…³å¿ƒçš„æ˜¯å®ƒä»¬çš„æŒç»­æ—¶é—´ï¼Œä¾‹å¦‚åƒåœ¾å›æ”¶äº‹ä»¶ã€‚</li>\n<li>è®¡æ—¶äº‹ä»¶ï¼ˆTimed Eventï¼‰ï¼Œæ˜¯æ—¶é•¿è¶…å‡ºæŒ‡å®šé˜ˆå€¼çš„æŒç»­äº‹ä»¶ã€‚</li>\n<li>å–æ ·äº‹ä»¶ï¼ˆSample Eventï¼‰ï¼Œæ˜¯å‘¨æœŸæ€§å–æ ·çš„äº‹ä»¶ã€‚<br />\nå–æ ·äº‹ä»¶çš„å…¶ä¸­ä¸€ä¸ªå¸¸è§ä¾‹å­ä¾¿æ˜¯æ–¹æ³•æŠ½æ ·ï¼ˆMethod Samplingï¼‰ï¼Œå³æ¯éš”ä¸€æ®µæ—¶é—´ç»Ÿè®¡å„ä¸ªçº¿ç¨‹çš„æ ˆè½¨è¿¹ã€‚å¦‚æœåœ¨è¿™äº›æŠ½æ ·å–å¾—çš„æ ˆè½¨è¿¹ä¸­å­˜åœ¨ä¸€ä¸ªåå¤å‡ºç°çš„æ–¹æ³•ï¼Œé‚£ä¹ˆæˆ‘ä»¬å¯ä»¥æ¨æµ‹è¯¥æ–¹æ³•æ˜¯çƒ­ç‚¹æ–¹æ³•ã€‚</li>\n</ol>\n<p>JFRçš„å–æ ·äº‹ä»¶è¦æ¯”å…¶ä»–å·¥å…·æ›´åŠ ç²¾ç¡®ã€‚ä»¥æ–¹æ³•æŠ½æ ·ä¸ºä¾‹ï¼Œå…¶ä»–å·¥å…·é€šå¸¸åŸºäºJVMTIï¼ˆ<a href=\"https://docs.oracle.com/en/java/javase/11/docs/specs/jvmti.html\">Java Virtual Machine Tool Interface</a>ï¼‰çš„<code>GetAllStackTraces</code> APIã€‚è¯¥APIä¾èµ–äºå®‰å…¨ç‚¹æœºåˆ¶ï¼Œå…¶è·å¾—çš„æ ˆè½¨è¿¹æ€»æ˜¯åœ¨å®‰å…¨ç‚¹ä¸Šï¼Œç”±æ­¤å¾—å‡ºçš„ç»“è®ºæœªå¿…ç²¾ç¡®ã€‚JFRåˆ™ä¸ç„¶ï¼Œå®ƒä¸ä¾èµ–äºå®‰å…¨ç‚¹æœºåˆ¶ï¼Œå› æ­¤å…¶ç»“æœç›¸å¯¹æ¥è¯´æ›´åŠ ç²¾ç¡®ã€‚</p>\n<p>JFRçš„å¯ç”¨æ–¹å¼ä¸»è¦æœ‰ä¸‰ç§ã€‚</p>\n<p>ç¬¬ä¸€ç§æ˜¯åœ¨è¿è¡Œç›®æ ‡Javaç¨‹åºæ—¶æ·»åŠ <code>-XX:StartFlightRecording=</code>å‚æ•°ã€‚å…³äºè¯¥å‚æ•°çš„é…ç½®è¯¦æƒ…ï¼Œä½ å¯ä»¥å‚è€ƒ<a href=\"https://docs.oracle.com/en/java/javase/11/tools/java.html\">è¯¥å¸®åŠ©æ–‡æ¡£</a>ï¼ˆè¯·åœ¨é¡µé¢ä¸­æœç´¢<code>StartFlightRecording</code>ï¼‰ã€‚</p>\n<p>ä¸‹é¢æˆ‘åˆ—ä¸¾ä¸‰ç§å¸¸è§çš„é…ç½®æ–¹å¼ã€‚</p>\n<ul>\n<li>åœ¨ä¸‹é¢è¿™æ¡å‘½ä»¤ä¸­ï¼ŒJFRå°†ä¼šåœ¨Javaè™šæ‹Ÿæœºå¯åŠ¨5såï¼ˆå¯¹åº”<code>delay=5s</code>ï¼‰æ”¶é›†æ•°æ®ï¼ŒæŒç»­20sï¼ˆå¯¹åº”<code>duration=20s</code>ï¼‰ã€‚å½“æ”¶é›†å®Œæ¯•åï¼ŒJFRä¼šå°†æ”¶é›†å¾—åˆ°çš„æ•°æ®ä¿å­˜è‡³æŒ‡å®šçš„æ–‡ä»¶ä¸­ï¼ˆå¯¹åº”<code>filename=myrecording.jfr</code>ï¼‰ã€‚</li>\n</ul>\n<pre><code># Time fixed\n$ java -XX:StartFlightRecording=delay=5s,duration=20s,filename=myrecording.jfr,settings=profile MyApp\n</code></pre>\n<blockquote>\n<p><code>settings=profile</code>æŒ‡å®šäº†JFRæ‰€æ”¶é›†çš„äº‹ä»¶ç±»å‹ã€‚é»˜è®¤æƒ…å†µä¸‹ï¼ŒJFRå°†åŠ è½½é…ç½®æ–‡ä»¶<code>$JDK/lib/jfr/default.jfc</code>ï¼Œå¹¶è¯†åˆ«å…¶ä¸­æ‰€åŒ…å«çš„äº‹ä»¶ç±»å‹ã€‚å½“ä½¿ç”¨äº†<code>settings=profile</code>é…ç½®æ—¶ï¼ŒJFRå°†åŠ è½½é…ç½®æ–‡ä»¶<code>$JDK/lib/jfr/profile.jfc</code>ã€‚è¯¥é…ç½®æ–‡ä»¶æ‰€åŒ…å«çš„äº‹ä»¶ç±»å‹è¦å¤šäºé»˜è®¤çš„<code>default.jfc</code>ï¼Œå› æ­¤æ€§èƒ½å¼€é”€ä¹Ÿè¦å¤§ä¸€äº›ï¼ˆçº¦ä¸º2%ï¼‰ã€‚</p>\n<p><code>default.jfc</code>ä»¥åŠ<code>profile.jfc</code>å‡ä¸ºXMLæ–‡ä»¶ã€‚åé¢æˆ‘ä¼šä»‹ç»å¦‚ä½•åˆ©ç”¨JMCæ¥è¿›è¡Œä¿®æ”¹ã€‚</p>\n</blockquote>\n<ul>\n<li>åœ¨ä¸‹é¢è¿™æ¡å‘½ä»¤ä¸­ï¼ŒJFRå°†åœ¨Javaè™šæ‹Ÿæœºå¯åŠ¨ä¹‹åæŒç»­æ”¶é›†æ•°æ®ï¼Œç›´è‡³è¿›ç¨‹é€€å‡ºã€‚åœ¨è¿›ç¨‹é€€å‡ºæ—¶ï¼ˆå¯¹åº”<code>dumponexit=true</code>ï¼‰ï¼ŒJFRä¼šå°†æ”¶é›†å¾—åˆ°çš„æ•°æ®ä¿å­˜è‡³æŒ‡å®šçš„æ–‡ä»¶ä¸­ã€‚</li>\n</ul>\n<pre><code># Continuous, dump on exit\n$ java -XX:StartFlightRecording=dumponexit=true,filename=myrecording.jfr MyApp\n</code></pre>\n<ul>\n<li>åœ¨ä¸‹é¢è¿™æ¡å‘½ä»¤ä¸­ï¼ŒJFRå°†åœ¨Javaè™šæ‹Ÿæœºå¯åŠ¨ä¹‹åæŒç»­æ”¶é›†æ•°æ®ï¼Œç›´è‡³è¿›ç¨‹é€€å‡ºã€‚è¯¥å‘½ä»¤ä¸ä¼šä¸»åŠ¨ä¿å­˜JFRæ”¶é›†å¾—åˆ°çš„æ•°æ®ã€‚</li>\n</ul>\n<pre><code># Continuous, dump on demand\n$ java -XX:StartFlightRecording=maxage=10m,maxsize=100m,name=SomeLabel MyApp\nStarted recording 1.\n\nUse jcmd 38502 JFR.dump name=SomeLabel filename=FILEPATH to copy recording data to file.\n...\n</code></pre>\n<p>ç”±äºJFRå°†æŒç»­æ”¶é›†æ•°æ®ï¼Œå¦‚æœä¸åŠ ä»¥é™åˆ¶ï¼Œé‚£ä¹ˆJFRå¯èƒ½ä¼šå¡«æ»¡ç¡¬ç›˜çš„æ‰€æœ‰ç©ºé—´ã€‚å› æ­¤ï¼Œæˆ‘ä»¬æœ‰å¿…è¦å¯¹è¿™ç§æ¨¡å¼ä¸‹æ‰€æ”¶é›†çš„æ•°æ®è¿›è¡Œé™åˆ¶ã€‚</p>\n<p>åœ¨è¿™æ¡å‘½ä»¤ä¸­ï¼Œ<code>maxage=10m</code>æŒ‡çš„æ˜¯ä»…ä¿ç•™10åˆ†é’Ÿä»¥å†…çš„äº‹ä»¶ï¼Œ<code>maxsize=100m</code>æŒ‡çš„æ˜¯ä»…ä¿ç•™100MBä»¥å†…çš„äº‹ä»¶ã€‚ä¸€æ—¦æ‰€æ”¶é›†çš„äº‹ä»¶è¾¾åˆ°å…¶ä¸­ä»»æ„ä¸€ä¸ªé™åˆ¶ï¼ŒJFRä¾¿ä¼šå¼€å§‹æ¸…é™¤ä¸åˆè§„æ ¼çš„äº‹ä»¶ã€‚</p>\n<p>ç„¶è€Œï¼Œä¸ºäº†ä¿æŒè¾ƒå°çš„æ€§èƒ½å¼€é”€ï¼ŒJFRå¹¶ä¸ä¼šé¢‘ç¹åœ°æ ¡éªŒè¿™ä¸¤ä¸ªé™åˆ¶ã€‚å› æ­¤ï¼Œåœ¨å®è·µè¿‡ç¨‹ä¸­ä½ å¾€å¾€ä¼šå‘ç°æŒ‡å®šæ–‡ä»¶çš„å¤§å°è¶…å‡ºé™åˆ¶ï¼Œæˆ–è€…æ–‡ä»¶ä¸­æ‰€å­˜å‚¨äº‹ä»¶çš„æ—¶é—´è¶…å‡ºé™åˆ¶ã€‚å…·ä½“è§£é‡Šè¯·å‚è€ƒ<a href=\"https://community.oracle.com/thread/3514679\">è¿™ç¯‡å¸–å­</a>ã€‚</p>\n<p>å‰é¢æåˆ°ï¼Œè¯¥å‘½ä»¤ä¸ä¼šä¸»åŠ¨ä¿å­˜JFRæ”¶é›†å¾—åˆ°çš„æ•°æ®ã€‚ç”¨æˆ·éœ€è¦è¿è¡Œ<code>jcmd &lt;PID&gt; JFR.dump</code>å‘½ä»¤æ–¹èƒ½ä¿å­˜ã€‚</p>\n<p>è¿™ä¾¿æ˜¯JFRçš„ç¬¬äºŒç§å¯ç”¨æ–¹å¼ï¼Œå³é€šè¿‡<code>jcmd</code>æ¥è®©JFRå¼€å§‹æ”¶é›†æ•°æ®ã€åœæ­¢æ”¶é›†æ•°æ®ï¼Œæˆ–è€…ä¿å­˜æ‰€æ”¶é›†çš„æ•°æ®ï¼Œå¯¹åº”çš„å­å‘½ä»¤åˆ†åˆ«ä¸º<code>JFR.start</code>ï¼Œ<code>JFR.stop</code>ï¼Œä»¥åŠ<code>JFR.dump</code>ã€‚</p>\n<p><code>JFR.start</code>å­å‘½ä»¤æ‰€æ¥æ”¶çš„é…ç½®åŠæ ¼å¼å’Œ<code>-XX:StartFlightRecording=</code>å‚æ•°çš„ç±»ä¼¼ã€‚è¿™äº›é…ç½®åŒ…æ‹¬<code>delay</code>ã€<code>duration</code>ã€<code>settings</code>ã€<code>maxage</code>ã€<code>maxsize</code>ä»¥åŠ<code>name</code>ã€‚å‰å‡ ä¸ªå‚æ•°æˆ‘ä»¬éƒ½å·²ç»ä»‹ç»è¿‡äº†ï¼Œæœ€åä¸€ä¸ªå‚æ•°<code>name</code>å°±æ˜¯ä¸€ä¸ªæ ‡ç­¾ï¼Œå½“åŒä¸€è¿›ç¨‹ä¸­å­˜åœ¨å¤šä¸ªJFRæ•°æ®æ”¶é›†æ“ä½œæ—¶ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡è¯¥æ ‡ç­¾æ¥è¾¨åˆ«ã€‚</p>\n<p>åœ¨å¯åŠ¨ç›®æ ‡è¿›ç¨‹æ—¶ï¼Œæˆ‘ä»¬ä¸å†æ·»åŠ <code>-XX:StartFlightRecording=</code>å‚æ•°ã€‚åœ¨ç›®æ ‡è¿›ç¨‹è¿è¡Œè¿‡ç¨‹ä¸­ï¼Œæˆ‘ä»¬å¯ä»¥è¿è¡Œ<code>JFR.start</code>å­å‘½ä»¤è¿œç¨‹å¯ç”¨ç›®æ ‡è¿›ç¨‹çš„JFRåŠŸèƒ½ã€‚å…·ä½“ç”¨æ³•å¦‚ä¸‹æ‰€ç¤ºï¼š</p>\n<pre><code>$ jcmd &lt;PID&gt; JFR.start settings=profile maxage=10m maxsize=150m name=SomeLabel\n</code></pre>\n<p>ä¸Šè¿°å‘½ä»¤è¿è¡Œè¿‡åï¼Œç›®æ ‡è¿›ç¨‹ä¸­çš„JFRå·²ç»å¼€å§‹æ”¶é›†æ•°æ®ã€‚æ­¤æ—¶ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡ä¸‹è¿°å‘½ä»¤æ¥å¯¼å‡ºå·²ç»æ”¶é›†åˆ°çš„æ•°æ®ï¼š</p>\n<pre><code>$ jcmd &lt;PID&gt; JFR.dump name=SomeLabel filename=myrecording.jfr\n</code></pre>\n<p>æœ€åï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡ä¸‹è¿°å‘½ä»¤å…³é—­ç›®æ ‡è¿›ç¨‹ä¸­çš„JFRï¼š</p>\n<pre><code>$ jcmd &lt;PID&gt; JFR.stop name=SomeLabel\n</code></pre>\n<p>å…³äº<code>JFR.start</code>ã€<code>JFR.dump</code>å’Œ<code>JFR.stop</code>çš„å…¶ä»–ç”¨æ³•ï¼Œä½ å¯ä»¥å‚è€ƒ<a href=\"https://docs.oracle.com/javacomponents/jmc-5-5/jfr-runtime-guide/comline.htm#JFRRT185\">è¯¥å¸®åŠ©æ–‡æ¡£</a>ã€‚</p>\n<p>ç¬¬ä¸‰ç§å¯ç”¨JFRçš„æ–¹å¼åˆ™æ˜¯JMCä¸­çš„JFRæ’ä»¶ã€‚</p>\n<p><img src=\"https://static001.geekbang.org/resource/image/39/16/395900f606fd93570196a6dcbac75e16.png?wh=752*458\" alt=\"\" /></p>\n<p>åœ¨JMC GUIå®¢æˆ·ç«¯å·¦ä¾§çš„JVMæµè§ˆå™¨ä¸­ï¼Œæˆ‘ä»¬å¯ä»¥çœ‹åˆ°æ‰€æœ‰æ­£åœ¨è¿è¡Œçš„Javaç¨‹åºã€‚å½“ç‚¹å‡»å³é”®å¼¹å‡ºèœå•ä¸­çš„<code>Start Flight Recording...</code>æ—¶ï¼ŒJMCä¾¿ä¼šå¼¹å‡ºå¦ä¸€ä¸ªçª—å£ï¼Œç”¨æ¥é…ç½®JFRçš„å¯åŠ¨å‚æ•°ï¼Œå¦‚ä¸‹å›¾æ‰€ç¤ºï¼š</p>\n<p><img src=\"https://static001.geekbang.org/resource/image/31/6a/31f86bc1cafc569f51e0364d716cab6a.png?wh=1330*1020\" alt=\"\" /></p>\n<p>è¿™é‡Œçš„é…ç½®å‚æ•°ä¸å‰ä¸¤ç§å¯åŠ¨JFRçš„æ–¹å¼å¹¶æ— äºŒè‡´ï¼ŒåŒæ ·ä¹ŸåŒ…æ‹¬æ ‡ç­¾åã€æ”¶é›†æ•°æ®çš„æŒç»­æ—¶é—´ã€ç¼“å­˜äº‹ä»¶çš„æ—¶é—´åŠç©ºé—´é™åˆ¶ï¼Œä»¥åŠé…ç½®æ‰€è¦ç›‘æ§äº‹ä»¶çš„<code>Event settings</code>ã€‚<br />\nï¼ˆè¿™é‡Œå¯¹åº”å‰ä¸¤ç§å¯åŠ¨æ–¹å¼çš„<code>settings=default|profile</code>ï¼‰</p>\n<blockquote>\n<p>JMCæä¾›äº†ä¸¤ä¸ªé€‰æ‹©ï¼šContinuouså’ŒProfilingï¼Œåˆ†åˆ«å¯¹åº”<code>$JDK/lib/jfr/</code>é‡Œçš„<code>default.jfc</code>å’Œ<code>profile.jfc</code>ã€‚</p>\n</blockquote>\n<p>æˆ‘ä»¬å¯ä»¥é€šè¿‡JMCçš„<code>Flight Recording Template Manager</code>å¯¼å…¥è¿™äº›jfcæ–‡ä»¶ï¼Œå¹¶åœ¨GUIç•Œé¢ä¸Šè¿›è¡Œæ›´æ”¹ã€‚æ›´æ”¹å®Œæ¯•åï¼Œæˆ‘ä»¬å¯ä»¥å¯¼å‡ºä¸ºæ–°çš„jfcæ–‡ä»¶ï¼Œä»¥ä¾¿åœ¨æœåŠ¡å™¨ç«¯ä½¿ç”¨ã€‚</p>\n<p>å½“æ”¶é›†å®Œæˆæ—¶ï¼ŒJMCä¼šè‡ªåŠ¨æ‰“å¼€æ‰€ç”Ÿæˆçš„jfræ–‡ä»¶ï¼Œå¹¶åœ¨ä¸»ç•Œé¢ä¸­åˆ—ä¸¾ç›®æ ‡è¿›ç¨‹åœ¨æ”¶é›†æ•°æ®çš„è¿™æ®µæ—¶é—´å†…çš„æ½œåœ¨é—®é¢˜ã€‚ä¾‹å¦‚ï¼Œ<code>Parallel Threads</code>ä¸€èŠ‚ï¼Œä¾¿æ±‡æŠ¥äº†æ²¡æœ‰å®Œæ•´åˆ©ç”¨CPUèµ„æºçš„é—®é¢˜ã€‚</p>\n<p><img src=\"https://static001.geekbang.org/resource/image/5a/7c/5a4302c29947518250e2b697aecc8d7c.png?wh=1920*1062\" alt=\"\" /></p>\n<p>å®¢æˆ·ç«¯çš„å·¦è¾¹åˆ™ç½—åˆ—äº†Javaè™šæ‹Ÿæœºçš„å„ä¸ªå­ç³»ç»Ÿã€‚JMCå°†æ ¹æ®JFRæ‰€æ”¶é›†åˆ°çš„æ¯ä¸ªå­ç³»ç»Ÿçš„äº‹ä»¶æ¥è¿›è¡Œå¯è§†åŒ–ï¼Œè½¬æ¢æˆå›¾æˆ–è€…è¡¨ã€‚</p>\n<p><img src=\"https://static001.geekbang.org/resource/image/db/ff/dbc36a8713af058c79df2878379276ff.png?wh=732*1272\" alt=\"\" /></p>\n<p>è¿™é‡Œæˆ‘ç®€å•åœ°ä»‹ç»å…¶ä¸­ä¸¤ä¸ªã€‚</p>\n<p>åƒåœ¾å›æ”¶å­ç³»ç»Ÿæ‰€å¯¹åº”çš„é€‰é¡¹å¡å±•ç¤ºäº†JFRæ‰€æ”¶é›†åˆ°çš„GCäº‹ä»¶ï¼Œä»¥åŠåŸºäºè¿™äº›GCäº‹ä»¶çš„æ•°æ®ç”Ÿæˆçš„å †å·²ç”¨ç©ºé—´çš„åˆ†å¸ƒå›¾ï¼ŒMetaspaceå¤§å°çš„åˆ†å¸ƒå›¾ï¼Œæœ€é•¿æš‚åœä»¥åŠæ€»æš‚åœçš„ç›´æ–¹åˆ†å¸ƒå›¾ã€‚</p>\n<p><img src=\"https://static001.geekbang.org/resource/image/56/0c/56f9fb2932ffb63ffa29e95dc779100c.png?wh=1920*1074\" alt=\"\" /></p>\n<p>å³æ—¶ç¼–è¯‘å­ç³»ç»Ÿæ‰€å¯¹åº”çš„é€‰é¡¹å¡åˆ™å±•ç¤ºäº†æ–¹æ³•ç¼–è¯‘æ—¶é—´çš„ç›´æ–¹å›¾ï¼Œä»¥åŠæŒ‰ç¼–è¯‘æ—¶é—´æ’åºçš„ç¼–è¯‘ä»»åŠ¡è¡¨ã€‚</p>\n<p>åè€…å¯èƒ½å‡ºç°åŒæ–¹æ³•ååŒæ–¹æ³•æè¿°ç¬¦çš„ç¼–è¯‘ä»»åŠ¡ã€‚å…¶åŸå› ä¸»è¦æœ‰ä¸¤ä¸ªï¼Œä¸€æ˜¯ä¸åŒç¼–è¯‘å±‚æ¬¡çš„å³æ—¶ç¼–è¯‘ï¼Œå¦‚3å±‚çš„C1ç¼–è¯‘ä»¥åŠ4å±‚çš„C2ç¼–è¯‘ã€‚äºŒæ˜¯å»ä¼˜åŒ–åçš„é‡æ–°ç¼–è¯‘ã€‚</p>\n<p><img src=\"https://static001.geekbang.org/resource/image/6e/c8/6e7e41a6f8945a2b65d67c18ea5293c8.png?wh=1920*1070\" alt=\"\" /></p>\n<p>JMCçš„å›¾è¡¨æ€»ä½“è€Œè¨€éƒ½ä¸éš¾ç†è§£ã€‚ä½ å¯ä»¥é€ä¸ªæ¢ç´¢ï¼Œæˆ‘åœ¨è¿™é‡Œä¾¿ä¸è¯¦ç»†å±•å¼€äº†ã€‚</p>\n<h2>æ€»ç»“ä¸å®è·µ</h2>\n<p>ä»Šå¤©æˆ‘ä»‹ç»äº†ä¸¤ä¸ªGUIå·¥å…·ï¼šeclipse MATä»¥åŠJMCã€‚</p>\n<p>eclipse MATå¯ç”¨äºåˆ†æç”±<code>jmap</code>å‘½ä»¤å¯¼å‡ºçš„Javaå †å¿«ç…§ã€‚å®ƒåŒ…æ‹¬ä¸¤ä¸ªç›¸å¯¹æ¯”è¾ƒé‡è¦çš„è§†å›¾ï¼Œåˆ†åˆ«ä¸ºç›´æ–¹å›¾å’Œæ”¯é…æ ‘ã€‚ç›´æ–¹å›¾å±•ç¤ºäº†å„ä¸ªç±»çš„å®ä¾‹æ•°ç›®ä»¥åŠè¿™äº›å®ä¾‹çš„Shallow heapæˆ–Retained heapçš„æ€»å’Œã€‚æ”¯é…æ ‘åˆ™å±•ç¤ºäº†å¿«ç…§ä¸­æ¯ä¸ªå¯¹è±¡æ‰€ç›´æ¥æ”¯é…çš„å¯¹è±¡ã€‚</p>\n<p>Java Mission Controlæ˜¯Javaè™šæ‹Ÿæœºå¹³å°ä¸Šçš„æ€§èƒ½ç›‘æ§å·¥å…·ã€‚Java Flight Recorderæ˜¯JMCçš„å…¶ä¸­ä¸€ä¸ªç»„ä»¶ï¼Œèƒ½å¤Ÿä»¥æä½çš„æ€§èƒ½å¼€é”€æ”¶é›†Javaè™šæ‹Ÿæœºçš„æ€§èƒ½æ•°æ®ã€‚</p>\n<p>JFRçš„å¯ç”¨æ–¹å¼æœ‰ä¸‰ç§ï¼Œåˆ†åˆ«ä¸ºåœ¨å‘½ä»¤è¡Œä¸­ä½¿ç”¨<code>-XX:StartFlightRecording=</code>å‚æ•°ï¼Œä½¿ç”¨<code>jcmd</code>çš„<code>JFR.*</code>å­å‘½ä»¤ï¼Œä»¥åŠJMCçš„JFRæ’ä»¶ã€‚JMCèƒ½å¤ŸåŠ è½½JFRçš„è¾“å‡ºç»“æœï¼Œå¹¶ä¸”ç”Ÿæˆå„ç§ä¿¡æ¯ä¸°å¯Œçš„å›¾è¡¨ã€‚</p>\n<hr />\n<p>ä»Šå¤©çš„å®è·µç¯èŠ‚ï¼Œè¯·ä½ è¯•ç”¨JMCä¸­çš„MBean ServeråŠŸèƒ½ï¼Œå¹¶é€šè¿‡JMCçš„å¸®åŠ©æ–‡æ¡£ï¼ˆ<code>Help-&gt;Java Mission Control Help</code>ï¼‰ï¼Œä»¥åŠ<a href=\"https://docs.oracle.com/javase/tutorial/jmx/mbeans/index.html\">è¯¥æ•™ç¨‹</a>æ¥äº†è§£è¯¥åŠŸèƒ½çš„å…·ä½“å«ä¹‰ã€‚</p>\n<p><img src=\"https://static001.geekbang.org/resource/image/2a/7f/2a68f0f2b5de35f29b045fe82923ac7f.png?wh=1920*1072\" alt=\"\" /></p>\n<p>ç”±äºç¯‡å¹…çš„é™åˆ¶ï¼Œæˆ‘å°±ä¸å†ä»‹ç»<a href=\"https://visualvm.github.io/index.html\">VisualVM</a> ä»¥åŠ<a href=\"https://github.com/AdoptOpenJDK/jitwatch\">JITWatch</a> äº†ã€‚æ„Ÿå…´è¶£çš„åŒå­¦å¯è‡ªè¡Œä¸‹è½½ç ”ç©¶ã€‚</p>\n<p></p>\n","neighbors":{"left":{"article_title":"30 | Javaè™šæ‹Ÿæœºçš„ç›‘æ§åŠè¯Šæ–­å·¥å…·ï¼ˆå‘½ä»¤è¡Œç¯‡ï¼‰","id":40520},"right":{"article_title":"32 | JNIçš„è¿è¡Œæœºåˆ¶","id":40839}},"comments":[{"had_liked":false,"id":52253,"user_name":"Maxwell","can_delete":false,"product_type":"c1","uid":1086275,"ip_address":"","ucode":"720A00AD472616","user_header":"https://static001.geekbang.org/account/avatar/00/10/93/43/0e84492d.jpg","comment_is_top":false,"comment_ctime":1545354869,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"53084962421","product_id":100010301,"comment_content":"èƒ½å¦åˆ†äº«ä¸‹å®é™…å·¥ä½œä¸­å‘ç”Ÿå†…å­˜æ³„éœ²ï¼Œä½¿ç”¨MATåˆ†æå’Œå®šä½çš„æ¡ˆä¾‹å‘¢ï¼Ÿ","like_count":13},{"had_liked":false,"id":30299,"user_name":"é’±","can_delete":false,"product_type":"c1","uid":1009652,"ip_address":"","ucode":"2C92A243A463D4","user_header":"https://static001.geekbang.org/account/avatar/00/0f/67/f4/9a1feb59.jpg","comment_is_top":false,"comment_ctime":1538782962,"is_pvip":false,"replies":[{"id":"11047","content":"æå‰ä¸€å‘¨å†™å¥½çš„ã€‚æå®¢çš„å°ç¼–è¾›è‹¦äº›ï¼Œéœ€è¦åŠ ç­è¾ƒç¨¿ã€‚","user_name":"ä½œè€…å›å¤","comment_id":30299,"uid":"1176688","ip_address":"","utype":1,"ctime":1538986866,"user_name_real":"éƒ‘é›¨è¿ª"}],"discussion_count":1,"race_medal":0,"score":"27308586738","product_id":100010301,"comment_content":"JVM GUIç›‘æ§å’Œæ£€æµ‹å·¥å…·<br>1:MAT<br>2:JMC<br>è¿™ä¸¤ä¸ªæ²¡æ€ä¹ˆç”¨è¿‡ï¼Œå›å¤´ä¸‹è½½ã€å®‰è£…ã€ä½¿ç”¨ä¸‹ï¼Œå›½åº†å›å®¶äº†ï¼Œé›¨è¿ªè€å¸ˆè¿˜åœ¨åŒ€é€Ÿçš„å‰è¿›ï¼Œæ˜¯ä¸æ˜¯è¯¾ç¨‹æ˜¯æå‰ç¼–å†™å¥½ï¼Œå½•åˆ¶å¥½ï¼Œç„¶åå®šæ—¶æ”¾å‡ºï¼Ÿæ— è®ºæ€ä¹ˆéå¸¸æ„Ÿè°¢ï¼Œè·Ÿç€è€å¸ˆç¡®å®å­¦ä¹ äº†ä¸å°‘ä¸œè¥¿ï¼Œæœ€åä¸¤å¤©è¡¥ä¸Šæ‹‰ä¸‹çš„è¯¾ç¨‹ã€‚","like_count":6,"discussions":[{"author":{"id":1176688,"avatar":"https://static001.geekbang.org/account/avatar/00/11/f4/70/2f61fa20.jpg","nickname":"éƒ‘é›¨è¿ª","note":"","ucode":"F7CA1AE501EAFF","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":425932,"discussion_content":"æå‰ä¸€å‘¨å†™å¥½çš„ã€‚æå®¢çš„å°ç¼–è¾›è‹¦äº›ï¼Œéœ€è¦åŠ ç­è¾ƒç¨¿ã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1538986866,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":29543,"user_name":"fuyu","can_delete":false,"product_type":"c1","uid":1012551,"ip_address":"","ucode":"E2D00651A70E27","user_header":"http://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTIKVicSvNf6OFvv4m3ibfsYCIUxic41kODPa9cuGUJjPcBtryLBDljalIVUiaJKlkGEJtOMZ03XSFlx1w/132","comment_is_top":false,"comment_ctime":1538408958,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"27308212734","product_id":100010301,"comment_content":"è¦æ˜¯èƒ½ä¸¾å‡ ä¸ªä¾‹å­ç»“åˆå·¥å…·æ’æŸ¥å°±æ›´å¥½äº†ã€‚","like_count":6},{"had_liked":false,"id":29519,"user_name":"é˜¿æ­¦","can_delete":false,"product_type":"c1","uid":1234116,"ip_address":"","ucode":"833B4B27FF7F55","user_header":"https://static001.geekbang.org/account/avatar/00/12/d4/c4/be9f44bb.jpg","comment_is_top":false,"comment_ctime":1538401830,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"23013238310","product_id":100010301,"comment_content":"å›½åº†ä¹Ÿæ¨é€ï¼Œå¤§å†™çš„æœã€‚ğŸ‘ğŸ‘","like_count":5},{"had_liked":false,"id":29562,"user_name":"å°æ–‡åŒå­¦","can_delete":false,"product_type":"c1","uid":1001893,"ip_address":"","ucode":"48F2AEB989C12A","user_header":"https://static001.geekbang.org/account/avatar/00/0f/49/a5/e4c1c2d4.jpg","comment_is_top":false,"comment_ctime":1538442502,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"18718311686","product_id":100010301,"comment_content":"MATæ˜¯ä¸€ä¸ªéå¸¸æœ‰ç”¨çš„å·¥å…·ï¼Œå·²ç»ç”¨å®ƒæˆåŠŸæ’æŸ¥è¿‡å†…å­˜æ³„éœ²çš„é—®é¢˜ã€‚","like_count":4},{"had_liked":false,"id":131639,"user_name":"neohope","can_delete":false,"product_type":"c1","uid":1043475,"ip_address":"","ucode":"C0268F6E7E2B6E","user_header":"https://static001.geekbang.org/account/avatar/00/0f/ec/13/49e98289.jpg","comment_is_top":false,"comment_ctime":1567829947,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"14452731835","product_id":100010301,"comment_content":"ä¹‹å‰åœ¨é¡¹ç›®ä¸Šé‡åˆ°äº†è¿™ç§æƒ…å†µï¼šæˆ‘ä»¬æœ‰ä¸€ä¸ªæœåŠ¡ä¸“é—¨å¤„ç†XMLï¼Œæœ‰æ˜æ˜¾çš„å†…å­˜æ³„æ¼ï¼Œè¿è¡Œä¸€å¤©åå†…å­˜ä¼šæœ‰å‡ åGï¼Œå¯¼å‡ºçš„å†…å­˜å¿«ç…§ä¹Ÿæ˜¯å‡ åGï¼Œä½†å‹ç¼©ååªæœ‰å‡ ç™¾Mã€‚ç”¨MATæŸ¥çœ‹å†…å­˜å¿«ç…§ï¼Œå‘ç°éƒ½æ˜¯ç©ºçš„ã€‚ç°åœ¨å›æƒ³èµ·æ¥ï¼Œæ˜¯ä¸æ˜¯æˆ‘ä»¬ç”¨çš„XMLç±»åº“ï¼Œç”¨äº†ç›´æ¥å†…å­˜ï¼Ÿé‚£ç›´æ¥å†…å­˜çš„è¯ï¼Œç”¨ä»€ä¹ˆæ–¹æ³•å¯ä»¥æŸ¥çœ‹å†…å­˜æ³„æ¼çš„æƒ…å†µå‘¢ï¼Ÿ","like_count":3},{"had_liked":false,"id":328707,"user_name":"å•¸ç–¯","can_delete":false,"product_type":"c1","uid":1104225,"ip_address":"","ucode":"24792660595DA1","user_header":"https://static001.geekbang.org/account/avatar/00/10/d9/61/4999fbc3.jpg","comment_is_top":false,"comment_ctime":1640849537,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"5935816833","product_id":100010301,"comment_content":"Ideaä¸­æœ‰jprofileæ’ä»¶å¯ä»¥ç”¨","like_count":1},{"had_liked":false,"id":107593,"user_name":"Roway","can_delete":false,"product_type":"c1","uid":1060967,"ip_address":"","ucode":"65AF589142AB6C","user_header":"https://static001.geekbang.org/account/avatar/00/10/30/67/a1e9aaba.jpg","comment_is_top":false,"comment_ctime":1561561775,"is_pvip":true,"discussion_count":1,"race_medal":0,"score":"5856529071","product_id":100010301,"comment_content":"èƒ½å¦åˆ†äº«ä¸‹å®é™…å·¥ä½œä¸­å‘ç”Ÿå†…å­˜æ³„éœ²ï¼Œä½¿ç”¨MATåˆ†æå’Œå®šä½çš„æ¡ˆä¾‹å‘¢ï¼Ÿ","like_count":1,"discussions":[{"author":{"id":2289217,"avatar":"","nickname":"å°æ–‡åŒå­¦","note":"","ucode":"4E6FD201BD45C2","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":379565,"discussion_content":"åŒæ±‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1623983577,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":347533,"user_name":"Tomy","can_delete":false,"product_type":"c1","uid":1192601,"ip_address":"","ucode":"D7E49E90B0D60F","user_header":"https://static001.geekbang.org/account/avatar/00/12/32/99/91b58bf7.jpg","comment_is_top":false,"comment_ctime":1654133761,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1654133761","product_id":100010301,"comment_content":"è€å¸ˆèƒ½å¦å‡ºä¸€ç‰ˆjvmçš„ä¹¦ï¼Œå¸‚é¢ä¸Šè¿™æ–¹é¢çš„ä¹¦å¤ªå°‘äº†ä¸”ä¸å¤Ÿç³»ç»Ÿå’Œå…¨é¢","like_count":0},{"had_liked":false,"id":265458,"user_name":"é äººå“å»èµ¢","can_delete":false,"product_type":"c1","uid":1301286,"ip_address":"","ucode":"7A20F9EBE847E1","user_header":"https://static001.geekbang.org/account/avatar/00/13/db/26/54f2c164.jpg","comment_is_top":false,"comment_ctime":1606902842,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1606902842","product_id":100010301,"comment_content":"æœ‰æœ¨æœ‰ç›¸å…³çš„IDEAæ’ä»¶ä¹‹ç±»çš„ï¼Œå¼€å‘çš„æ—¶å€™æµ‹è¯•è§‚å¯ŸJVMçŠ¶å†µã€‚","like_count":0},{"had_liked":false,"id":260983,"user_name":"xzy","can_delete":false,"product_type":"c1","uid":1002095,"ip_address":"","ucode":"1A44368083A19E","user_header":"https://static001.geekbang.org/account/avatar/00/0f/4a/6f/e36b3908.jpg","comment_is_top":false,"comment_ctime":1605166484,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1605166484","product_id":100010301,"comment_content":"è¿‡æ®µæ—¶é—´ä¸ç”¨ï¼Œéƒ½å¿˜äº†ï¼Œå†æ¥çœ‹çœ‹","like_count":0},{"had_liked":false,"id":171675,"user_name":"Geek_e2a822","can_delete":false,"product_type":"c1","uid":1484659,"ip_address":"","ucode":"2DA5EE7E7FCA4E","user_header":"","comment_is_top":false,"comment_ctime":1578990070,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1578990070","product_id":100010301,"comment_content":"æœ€å¥½æœ‰ç‚¹å®é™…é¡¹ç›®ä¸­é—®é¢˜å®šä½çš„ç¤ºä¾‹ï¼Œå¦åˆ™æ•´ç¯‡è¿™æ ·çš„ä»‹ç»å¾ˆé¸¡è‚‹","like_count":0},{"had_liked":false,"id":146620,"user_name":"éšå¿ƒè€Œè‡³","can_delete":false,"product_type":"c1","uid":1097836,"ip_address":"","ucode":"31866865255101","user_header":"https://static001.geekbang.org/account/avatar/00/10/c0/6c/29be1864.jpg","comment_is_top":false,"comment_ctime":1572585176,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1572585176","product_id":100010301,"comment_content":"ä¸‹äº†VisualVMï¼Œç»“åˆå®˜æ–¹æ–‡æ¡£ï¼Œå‘ç°çœŸçš„å¥½ç”¨ã€‚","like_count":0},{"had_liked":false,"id":107595,"user_name":"Roway","can_delete":false,"product_type":"c1","uid":1060967,"ip_address":"","ucode":"65AF589142AB6C","user_header":"https://static001.geekbang.org/account/avatar/00/10/30/67/a1e9aaba.jpg","comment_is_top":false,"comment_ctime":1561561958,"is_pvip":true,"discussion_count":1,"race_medal":0,"score":"1561561958","product_id":100010301,"comment_content":"è€å¸ˆï¼Œä¸è¯´ä¸€ä¸‹IBMçš„ä¸¤ä¸ªåˆ†æå·¥å…·å—ï¼Ÿä¸€ä¸ªå†…å­˜çš„ä¸€ä¸ªCPUçš„","like_count":0,"discussions":[{"author":{"id":2925548,"avatar":"","nickname":"Geek_57c142","note":"","ucode":"822BB99D9D395F","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":553595,"discussion_content":"å“ªå…©å€‹","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1645973821,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":35431,"user_name":"é‡è§æœªæ¥","can_delete":false,"product_type":"c1","uid":1188295,"ip_address":"","ucode":"FE8F3A33AA3194","user_header":"https://static001.geekbang.org/account/avatar/00/12/21/c7/966b6b85.jpg","comment_is_top":false,"comment_ctime":1540560533,"is_pvip":false,"replies":[{"id":"12768","content":"Java 11å¼€å§‹æ‰è¿›OpenJDKçš„","user_name":"ä½œè€…å›å¤","comment_id":35431,"uid":"1176688","ip_address":"","utype":1,"ctime":1540823701,"user_name_real":"éƒ‘é›¨è¿ª"}],"discussion_count":1,"race_medal":0,"score":"1540560533","product_id":100010301,"comment_content":"è€å¸ˆæ‚¨å¥½ï¼Œopenjdkå¯ä»¥ç”¨JFRå˜›ï¼Œé…ç½®äº†å¥½ä¹…æ²¡æˆåŠŸï¼Œå¦‚æœä¸èƒ½æœ‰æ²¡æœ‰ç±»ä¼¼çš„å·¥å…·æ¨èï¼Œè°¢è°¢ğŸ˜","like_count":0,"discussions":[{"author":{"id":1176688,"avatar":"https://static001.geekbang.org/account/avatar/00/11/f4/70/2f61fa20.jpg","nickname":"éƒ‘é›¨è¿ª","note":"","ucode":"F7CA1AE501EAFF","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":427534,"discussion_content":"Java 11å¼€å§‹æ‰è¿›OpenJDKçš„","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1540823701,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]}]}