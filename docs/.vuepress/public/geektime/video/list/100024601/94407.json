{"id":94407,"title":"45 | 自己封装一个支持自动校验的表单项","content":"<h1>源代码及课件地址</h1><p><a href=\"https://gitee.com/geektime-geekbang/geektime-vue-1\">https://gitee.com/geektime-geekbang/geektime-vue-1</a><br>\n<a href=\"https://gitee.com/geektime-geekbang/ant-design-vue-pro\">https://gitee.com/geektime-geekbang/ant-design-vue-pro</a></p>","comments":[{"had_liked":false,"id":95244,"user_name":"Tonyzzzzzzzz","can_delete":false,"product_type":"c3","uid":1464097,"ip_address":"","ucode":"EC236CADB4B9BB","user_header":"http://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTLoYV8ManGz8CmNJ86QMlnwsNBdBlfmwiaMVu81MApVuYHfID9vlOicZlQTVoV79rRWRvvkvdkW68rQ/132","comment_is_top":false,"comment_ctime":1557996150,"is_pvip":false,"replies":[{"id":34197,"content":"表单是组件库最复杂的地方，主要还是多用几次，多接触一些场景，就会清晰很多了","user_name":"作者回复","user_name_real":"唐","uid":1316874,"ctime":1558102986,"ip_address":"","comment_id":95244,"utype":1}],"discussion_count":1,"race_medal":0,"score":2,"product_id":100024601,"comment_content":"这几节课怎么听着那么吃力呢，有一样的么。。。","like_count":3,"discussions":[{"author":{"id":1316874,"avatar":"https://static001.geekbang.org/account/avatar/00/14/18/0a/28206510.jpg","nickname":"唐金州","note":"","ucode":"563B97D87C66AC","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":450383,"discussion_content":"表单是组件库最复杂的地方，主要还是多用几次，多接触一些场景，就会清晰很多了","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1558102986,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":156964,"user_name":"null","can_delete":false,"product_type":"c3","uid":1141409,"ip_address":"","ucode":"BE4C8015BF543A","user_header":"https://static001.geekbang.org/account/avatar/00/11/6a/a1/a90065ec.jpg","comment_is_top":false,"comment_ctime":1575003477,"is_pvip":false,"replies":[{"id":61865,"content":"新版本新增了一个属性 selfUpdate 或许可以帮助你","user_name":"作者回复","user_name_real":"唐","uid":1316874,"ctime":1576581605,"ip_address":"","comment_id":156964,"utype":1}],"discussion_count":1,"race_medal":0,"score":2,"product_id":100024601,"comment_content":"老师请问下，一个表单，有很非常多个 input，导致输入反应非常慢，这个要怎么处理呢？","like_count":1,"discussions":[{"author":{"id":1316874,"avatar":"https://static001.geekbang.org/account/avatar/00/14/18/0a/28206510.jpg","nickname":"唐金州","note":"","ucode":"563B97D87C66AC","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":476286,"discussion_content":"新版本新增了一个属性 selfUpdate 或许可以帮助你","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1576581605,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":151104,"user_name":"金刚不换","can_delete":false,"product_type":"c3","uid":1588618,"ip_address":"","ucode":"8A3A34D922710D","user_header":"https://static001.geekbang.org/account/avatar/00/18/3d/8a/aa4a82c4.jpg","comment_is_top":false,"comment_ctime":1573654123,"is_pvip":false,"replies":[{"id":58215,"content":"格式要自己转  ","user_name":"作者回复","user_name_real":"唐","uid":1316874,"ctime":1573700350,"ip_address":"","comment_id":151104,"utype":1}],"discussion_count":1,"race_medal":0,"score":2,"product_id":100024601,"comment_content":"如何收集表单提交的所有内容，转换成指定的json格式？换句话说vue有专门的内容转换器么？举个例子吧，Elasticsearch的api要求给后台发请求需要指定格式的json，我写了一个表单，收集了数据后，需要转成这样的格式。vue有这种插件或者组件支持么？","like_count":1,"discussions":[{"author":{"id":1316874,"avatar":"https://static001.geekbang.org/account/avatar/00/14/18/0a/28206510.jpg","nickname":"唐金州","note":"","ucode":"563B97D87C66AC","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":474365,"discussion_content":"格式要自己转  ","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1573700350,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":187669,"user_name":"Geek_fc1551","can_delete":false,"product_type":"c3","uid":1738150,"ip_address":"","ucode":"517DEBD42CF473","user_header":"","comment_is_top":false,"comment_ctime":1584189697,"is_pvip":false,"replies":[{"id":73165,"content":"？ 你说的不会清除？  这个问题太抽象了，我能想象到好几种意思，你想要清空表单内数据？ 加一个唯一key？","user_name":"作者回复","user_name_real":"唐","uid":1316874,"ctime":1584613815,"ip_address":"","comment_id":187669,"utype":1}],"discussion_count":1,"race_medal":0,"score":2,"product_id":100024601,"comment_content":"提交完成下次进来vuex的数据不会清楚这个问题，有什么优雅的解决方式吗","like_count":0,"discussions":[{"author":{"id":1316874,"avatar":"https://static001.geekbang.org/account/avatar/00/14/18/0a/28206510.jpg","nickname":"唐金州","note":"","ucode":"563B97D87C66AC","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":487193,"discussion_content":"？ 你说的不会清除？  这个问题太抽象了，我能想象到好几种意思，你想要清空表单内数据？ 加一个唯一key？","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1584613815,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":105897,"user_name":"此号为空号","can_delete":false,"product_type":"c3","uid":1464621,"ip_address":"","ucode":"3DF7B99F0CA533","user_header":"https://static001.geekbang.org/account/avatar/00/16/59/2d/b5f3abb6.jpg","comment_is_top":false,"comment_ctime":1561101006,"is_pvip":false,"replies":[{"id":38361,"content":"有的   低版本ie有兼容性问题","user_name":"作者回复","user_name_real":"唐","uid":1316874,"ctime":1561189462,"ip_address":"","comment_id":105897,"utype":1}],"discussion_count":1,"race_medal":0,"score":2,"product_id":100024601,"comment_content":"由于pc端的兼容问题,在css中利用calc计算值是否有问题","like_count":0,"discussions":[{"author":{"id":1316874,"avatar":"https://static001.geekbang.org/account/avatar/00/14/18/0a/28206510.jpg","nickname":"唐金州","note":"","ucode":"563B97D87C66AC","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":454855,"discussion_content":"有的   低版本ie有兼容性问题","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1561189462,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":97980,"user_name":"fatty Jack","can_delete":false,"product_type":"c3","uid":1222664,"ip_address":"","ucode":"7499DA9429013B","user_header":"https://static001.geekbang.org/account/avatar/00/12/a8/08/17453632.jpg","comment_is_top":false,"comment_ctime":1558858909,"is_pvip":false,"replies":[{"id":35043,"content":"使用了 v-decorator 就不能用 value或v-model 视频中有提到过","user_name":"作者回复","user_name_real":"唐","uid":1316874,"ctime":1558877685,"ip_address":"","comment_id":97980,"utype":1}],"discussion_count":1,"race_medal":0,"score":2,"product_id":100024601,"comment_content":"老师这节课我加了receiverAccont组件后,控制台Warning: `getFieldDecorator` will override `value`, so please don&#39;t set `value and v-model` directly and use `setFieldsValue` to set it.\n什么问题请解答？","like_count":0,"discussions":[{"author":{"id":1316874,"avatar":"https://static001.geekbang.org/account/avatar/00/14/18/0a/28206510.jpg","nickname":"唐金州","note":"","ucode":"563B97D87C66AC","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":451501,"discussion_content":"使用了 v-decorator 就不能用 value或v-model 视频中有提到过","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1558877685,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":93629,"user_name":"时光","can_delete":false,"product_type":"c3","uid":1392746,"ip_address":"","ucode":"88602944BBC8E3","user_header":"https://static001.geekbang.org/account/avatar/00/15/40/6a/a85d4464.jpg","comment_is_top":false,"comment_ctime":1557539653,"is_pvip":false,"replies":null,"discussion_count":0,"race_medal":0,"score":2,"product_id":100024601,"comment_content":"老师,能不能讲讲ant的那个自动生成骨架屏的,感谢","like_count":8},{"had_liked":false,"id":206906,"user_name":"yuzhewo","can_delete":false,"product_type":"c3","uid":1051834,"ip_address":"","ucode":"484C8D662EF9AA","user_header":"https://wx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTLDZc0soy5gq0OW7d1qTo99tWZ5ibP9aO3c37bWn5MNMLEWReO48c2hlr8H9aS19eWR05OWunQC4hA/132","comment_is_top":false,"comment_ctime":1586955629,"is_pvip":false,"replies":null,"discussion_count":0,"race_medal":0,"score":2,"product_id":100024601,"comment_content":"calc计算属性，经验运算符两侧需要留空，要不然不生效，学到老。\nBad: calc(100%-88px)\nGood: calc(100% - 88px)","like_count":7},{"had_liked":false,"id":98396,"user_name":"young","can_delete":false,"product_type":"c3","uid":1472571,"ip_address":"","ucode":"4B5285A404E637","user_header":"https://static001.geekbang.org/account/avatar/00/16/78/3b/19ef632a.jpg","comment_is_top":false,"comment_ctime":1558977706,"is_pvip":false,"replies":null,"discussion_count":2,"race_medal":0,"score":2,"product_id":100024601,"comment_content":"老师，我在receiverAccount.vue中这样写，我感觉不需要用watch监听父组件传过来的value了，对吗？\ndata(){\n       &#47;&#47;const { type, number } = this.value || { };\n        return {\n            type: this.value.type || &#39;alipay&#39;,\n            number: this.value.number || &#39;&#39;\n        }\n\n","like_count":1,"discussions":[{"author":{"id":1127115,"avatar":"https://static001.geekbang.org/account/avatar/00/11/32/cb/cece03fc.jpg","nickname":"GeekYa","note":"","ucode":"4B30219E8E7A97","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":195122,"discussion_content":"你可以试试...","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1583249322,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1395602,"avatar":"https://static001.geekbang.org/account/avatar/00/15/4b/92/03338a22.jpg","nickname":"王圣军","note":"","ucode":"1E13CF683137D1","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":166534,"discussion_content":"我也是这么认为的，看到使用了双向绑定，是不是可以不用watch了，还希望老师帮忙解答下","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1581408204,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":295321,"user_name":"Elcser","can_delete":false,"product_type":"c3","uid":2633548,"ip_address":"","ucode":"98376156F97B86","user_header":"https://static001.geekbang.org/account/avatar/00/28/2f/4c/610cf97c.jpg","comment_is_top":false,"comment_ctime":1622364766,"is_pvip":false,"replies":null,"discussion_count":1,"race_medal":0,"score":2,"product_id":100024601,"comment_content":"【提交】后，receiverAccount中只有number，没有type？","like_count":0,"discussions":[{"author":{"id":2145095,"avatar":"https://static001.geekbang.org/account/avatar/00/20/bb/47/b60ae3eb.jpg","nickname":"你好，阳光","note":"","ucode":"1A2F487C57F7D9","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":387562,"discussion_content":"我也碰到了一样的问题，select没有切换选项就会出现这个现象","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1628246251,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":235400,"user_name":"地平线","can_delete":false,"product_type":"c3","uid":1482026,"ip_address":"","ucode":"F50717D6244867","user_header":"https://static001.geekbang.org/account/avatar/00/16/9d/2a/3e57b54a.jpg","comment_is_top":false,"comment_ctime":1594998965,"is_pvip":false,"replies":null,"discussion_count":0,"race_medal":0,"score":3,"product_id":100024601,"comment_content":"change事件的方法名 约定是 handlexxxChange 这样的才行吗？","like_count":0},{"had_liked":false,"id":223882,"user_name":"科大码王","can_delete":false,"product_type":"c3","uid":1202511,"ip_address":"","ucode":"33683EDCD648E5","user_header":"https://static001.geekbang.org/account/avatar/00/12/59/4f/656113ed.jpg","comment_is_top":false,"comment_ctime":1591205065,"is_pvip":false,"replies":null,"discussion_count":1,"race_medal":0,"score":3,"product_id":100024601,"comment_content":"老师，我看在ReceiverAccount.vue中的两个handle***Change方法中emit了“change”事件，而它的外层组件a-form-item中并没有change事件，结果却能够顺利改变value的值。这是因为v-decorator这个指令实际上里面包含了change事件处理吗","like_count":0,"discussions":[{"author":{"id":1765894,"avatar":"https://static001.geekbang.org/account/avatar/00/1a/f2/06/ebb5b764.jpg","nickname":"NikkiZeng","note":"","ucode":"F669C811773394","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":282625,"discussion_content":"自定义表单控件    提供 onChange 事件或 trigger-参数) 的值同名的事件。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1592032609,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":112515,"user_name":"tuyu","can_delete":false,"product_type":"c3","uid":1448863,"ip_address":"","ucode":"B235325B541408","user_header":"http://thirdwx.qlogo.cn/mmopen/vi_32/BIRpwViaN51yynIeFonD7QRlwDCVtKibrG956NTxzEqibOZZVjhMMgibOPmd3VicfYxpknZsic1oJq8KicZvXkmmiajuQg/132","comment_is_top":false,"comment_ctime":1562749786,"is_pvip":false,"replies":null,"discussion_count":0,"race_medal":0,"score":3,"product_id":100024601,"comment_content":"老师，那个官方的table点击新建会弹出一个form表单，那个怎么实现，官方的ant design pro似乎不是基于课程的逻辑写的","like_count":0},{"had_liked":false,"id":107185,"user_name":"龍","can_delete":false,"product_type":"c3","uid":1386393,"ip_address":"","ucode":"7240C43FB19CB7","user_header":"https://static001.geekbang.org/account/avatar/00/15/27/99/20aea94e.jpg","comment_is_top":false,"comment_ctime":1561474744,"is_pvip":false,"replies":null,"discussion_count":2,"race_medal":0,"score":3,"product_id":100024601,"comment_content":"哪位大佬能给我讲讲分步表单中step1和step2中的 \n$store.commit({                                              \n      type: &quot;form&#47;saveStepFormData&quot;,\n      payload: values\n});\n\n$store.dispatch({\n      type: &quot;form&#47;submitStepForm&quot;,\n      payload: { ...step, ...values }\n });\ntype作用是什么，有什么作用，谢谢","like_count":0,"discussions":[{"author":{"id":1607721,"avatar":"https://static001.geekbang.org/account/avatar/00/18/88/29/90d9ba80.jpg","nickname":"流花","note":"","ucode":"E1B3C07536BB05","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":58271,"discussion_content":"对象风格的提交方式，可以改写成这样。第一个参数就不用讲了吧，就是触发的方法（带命名空间的），第二个就是携带的参数\n $store.commit(&#39;form/saveStepFormData&#39;,{\n       // type:&#39;&#39;,\n        payload:value\n  }) ","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1574664198,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1481952,"avatar":"https://static001.geekbang.org/account/avatar/00/16/9c/e0/b1d9ffc5.jpg","nickname":"Venom","note":"","ucode":"CCF8C0C9F400C1","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":1339,"discussion_content":"看看 vuex 吧 太基础的东西了 ","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1562567344,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":103687,"user_name":"有人@你","can_delete":false,"product_type":"c3","uid":1392697,"ip_address":"","ucode":"4E4F61303CEC2E","user_header":"https://static001.geekbang.org/account/avatar/00/15/40/39/62636d99.jpg","comment_is_top":false,"comment_ctime":1560490871,"is_pvip":false,"replies":null,"discussion_count":0,"race_medal":0,"score":3,"product_id":100024601,"comment_content":"For a guide and recipes on how to configure &#47; customize this project,\ncheck out the vue-cli documentation.\n\nInstalled CLI Plugins\nbabeleslintunit-jest\nEssential Links\nCore DocsForumCommunity ChatTwitterNews\nEcosystem\nvue-routervuexvue-devtoolsvue-loaderawesome-vue\n\n这是啥问题","like_count":0},{"had_liked":false,"id":98266,"user_name":"fatty Jack","can_delete":false,"product_type":"c3","uid":1222664,"ip_address":"","ucode":"7499DA9429013B","user_header":"https://static001.geekbang.org/account/avatar/00/12/a8/08/17453632.jpg","comment_is_top":false,"comment_ctime":1558945091,"is_pvip":false,"replies":null,"discussion_count":0,"race_medal":0,"score":3,"product_id":100024601,"comment_content":"我的ReceiverAccount自定义组件已经跟官网示例的那个自定义组件代码几乎一样了，除了官网是用template定义的子组件，我这边是vue单文件，为什么我这边还是有warning提示？请问我如何修改好？","like_count":0}]}