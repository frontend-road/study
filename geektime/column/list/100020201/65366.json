{"id":65366,"title":"05 | 从RAID看垂直伸缩到水平伸缩的演化","content":"<p>经过前面的预习和上一期我们聊的，大数据技术主要是要解决大规模数据的计算处理问题，但是我们要想对数据进行计算，首先要解决的其实是大规模数据的存储问题。我这里有一个直观又现实的问题想问你：如果一个文件的大小超过了一张磁盘的大小，你该如何存储？</p><p>我的答案是，单机时代，主要的解决方案是RAID；分布式时代，主要解决方案是分布式文件系统。</p><p>其实不论是在单机时代还是分布式时代，大规模数据存储都需要解决几个核心问题，这些问题都是什么呢？总结一下，主要有以下三个方面。</p><p>1.<strong>数据存储容量的问题</strong>。既然大数据要解决的是数以PB计的数据计算问题，而一般的服务器磁盘容量通常1～2TB，那么如何存储这么大规模的数据呢？</p><p>2.<strong>数据读写速度的问题</strong>。一般磁盘的连续读写速度为几十MB，以这样的速度，几十PB的数据恐怕要读写到天荒地老。</p><p>3.<strong>数据可靠性的问题</strong>。磁盘大约是计算机设备中最易损坏的硬件了，通常情况一块磁盘使用寿命大概是一年，如果磁盘损坏了，数据怎么办？</p><p>在大数据技术出现之前，我们就需要面对这些关于存储的问题，对应的解决方案就是RAID技术。<span class=\"orange\">今天我们就先从RAID开始，一起看看大规模数据存储方式的演化过程</span>。</p><p>RAID（独立磁盘冗余阵列）技术是将多块普通磁盘组成一个阵列，共同对外提供服务。主要是为了改善磁盘的存储容量、读写速度，增强磁盘的可用性和容错能力。在RAID之前，要使用大容量、高可用、高速访问的存储系统需要专门的存储设备，这类设备价格要比RAID的几块普通磁盘贵几十倍。RAID刚出来的时候给我们的感觉像是一种黑科技，但其原理却不复杂，下面我慢慢道来。</p><!-- [[[read_end]]] --><p>目前服务器级别的计算机都支持插入多块磁盘（8块或者更多），通过使用RAID技术，实现数据在多块磁盘上的并发读写和数据备份。</p><p>常用RAID技术有图中下面这几种，光看图片你可能觉得它们都差不多，下面我给你讲讲它们之间的区别。</p><p><img src=\"https://static001.geekbang.org/resource/image/54/af/54e170b7438fe3b8f8196dbfbc943baf.jpg?wh=582*150\" alt=\"\"></p><p>首先，我们先假设服务器有N块磁盘，<strong>RAID 0</strong>是数据在从内存缓冲区写入磁盘时，根据磁盘数量将数据分成N份，这些数据同时并发写入N块磁盘，使得数据整体写入速度是一块磁盘的N倍；读取的时候也一样，因此RAID  0具有极快的数据读写速度。但是RAID  0不做数据备份，N块磁盘中只要有一块损坏，数据完整性就被破坏，其他磁盘的数据也都无法使用了。</p><p><strong>RAID 1</strong>是数据在写入磁盘时，将一份数据同时写入两块磁盘，这样任何一块磁盘损坏都不会导致数据丢失，插入一块新磁盘就可以通过复制数据的方式自动修复，具有极高的可靠性。</p><p>结合RAID  0和RAID  1两种方案构成了<strong>RAID 10</strong>，它是将所有磁盘N平均分成两份，数据同时在两份磁盘写入，相当于RAID  1；但是平分成两份，在每一份磁盘（也就是N/2块磁盘）里面，利用RAID  0技术并发读写，这样既提高可靠性又改善性能。不过RAID  10的磁盘利用率较低，有一半的磁盘用来写备份数据。</p><p>一般情况下，一台服务器上很少出现同时损坏两块磁盘的情况，在只损坏一块磁盘的情况下，如果能利用其他磁盘的数据恢复损坏磁盘的数据，这样在保证可靠性和性能的同时，磁盘利用率也得到大幅提升。</p><p>顺着这个思路，<strong>RAID 3</strong>可以在数据写入磁盘的时候，将数据分成N-1份，并发写入N-1块磁盘，并在第N块磁盘记录校验数据，这样任何一块磁盘损坏（包括校验数据磁盘），都可以利用其他N-1块磁盘的数据修复。</p><p>但是在数据修改较多的场景中，任何磁盘数据的修改，都会导致第N块磁盘重写校验数据。频繁写入的后果是第N块磁盘比其他磁盘更容易损坏，需要频繁更换，所以RAID  3很少在实践中使用，因此在上面图中也就没有单独列出。</p><p>相比RAID  3，<strong>RAID 5</strong>是使用更多的方案。RAID  5和RAID  3很相似，但是校验数据不是写入第N块磁盘，而是螺旋式地写入所有磁盘中。这样校验数据的修改也被平均到所有磁盘上，避免RAID  3频繁写坏一块磁盘的情况。</p><p>如果数据需要很高的可靠性，在出现同时损坏两块磁盘的情况下（或者运维管理水平比较落后，坏了一块磁盘但是迟迟没有更换，导致又坏了一块磁盘），仍然需要修复数据，这时候可以使用<strong>RAID 6</strong>。</p><p>RAID  6和RAID  5类似，但是数据只写入N-2块磁盘，并螺旋式地在两块磁盘中写入校验信息（使用不同算法生成）。</p><p>从下面表格中你可以看到在相同磁盘数目（N）的情况下，各种RAID技术的比较。</p><p><img src=\"https://static001.geekbang.org/resource/image/e2/2f/e2fb7ec97e6127c1b03e83daeff0232f.jpg?wh=720*184\" alt=\"\"></p><p>RAID技术有硬件实现，比如专用的RAID卡或者主板直接支持；也可以通过软件实现，在操作系统层面将多块磁盘组成RAID，从逻辑上视作一个访问目录。RAID技术在传统关系数据库及文件系统中应用比较广泛，是改善计算机存储特性的重要手段。</p><p>现在我来总结一下，看看RAID是如何解决我一开始提出的，关于存储的三个关键问题。</p><p>1.数据存储容量的问题。RAID使用了N块磁盘构成一个存储阵列，如果使用RAID  5，数据就可以存储在N-1块磁盘上，这样将存储空间扩大了N-1倍。</p><p>2.数据读写速度的问题。RAID根据可以使用的磁盘数量，将待写入的数据分成多片，并发同时向多块磁盘进行写入，显然写入的速度可以得到明显提高；同理，读取速度也可以得到明显提高。不过，需要注意的是，由于传统机械磁盘的访问延迟主要来自于寻址时间，数据真正进行读写的时间可能只占据整个数据访问时间的一小部分，所以数据分片后对N块磁盘进行并发读写操作并不能将访问速度提高N倍。</p><p>3.数据可靠性的问题。使用RAID  10、RAID  5或者RAID  6方案的时候，由于数据有冗余存储，或者存储校验信息，所以当某块磁盘损坏的时候，可以通过其他磁盘上的数据和校验数据将丢失磁盘上的数据还原。</p><p>我们对更强计算能力和更大规模数据存储的追求几乎是没有止境的，这似乎是源于人类的天性。神话里人类试图建立一座通天塔到神居住的地方，就是这种追求的体现。</p><p>我在上一期提到过，在计算机领域，实现更强的计算能力和更大规模的数据存储有两种思路，一种是升级计算机，一种是用分布式系统。前一种也被称作“垂直伸缩”（scaling up），通过升级CPU、内存、磁盘等将一台计算机变得更强大；后一种是“水平伸缩”（scaling out），添加更多的计算机到系统中，从而实现更强大的计算能力。</p><p><img src=\"https://static001.geekbang.org/resource/image/0e/80/0ea550a24ac70d39cabafa52c3257080.png?wh=1080*524\" alt=\"\"></p><p>在计算机发展的早期，我们获得更强大计算能力的手段主要依靠垂直伸缩。一方面拜摩尔定律所赐，每18个月计算机的处理能力提升一倍；另一方面由于不断研究新的计算机体系结构，小型机、中型机、大型机、超级计算机，不断刷新我们的认知。</p><p>但是到了互联网时代，这种垂直伸缩的路子走不通了，一方面是成本问题，互联网公司面对巨大的不确定性市场，无法为一个潜在的需要巨大计算资源的产品一下投入很多钱去购买大型计算机；另一方面，对于Google这样的公司和产品而言，即使是世界上最强大的超级计算机也无法满足其对计算资源的需求。</p><p>所以互联网公司走向了一条新的道路：<strong>水平伸缩</strong>，在一个系统中不断添加计算机，以满足不断增长的用户和数据对计算资源的需求。这就是最近十几年引导技术潮流的分布式与大数据技术。</p><p>RAID可以看作是一种垂直伸缩，一台计算机集成更多的磁盘实现数据更大规模、更安全可靠的存储以及更快的访问速度。而HDFS则是水平伸缩，通过添加更多的服务器实现数据更大、更快、更安全存储与访问。</p><p>RAID技术只是在单台服务器的多块磁盘上组成阵列，大数据需要更大规模的存储空间和更快的访问速度。将RAID思想原理应用到分布式服务器集群上，就形成了Hadoop分布式文件系统HDFS的架构思想。</p><p>垂直伸缩总有尽头，水平伸缩理论上是没有止境的，在实践中，数万台服务器的HDFS集群已经出现，我会在下一期谈谈HDFS的架构。</p><h2>思考题</h2><p>传统机械磁盘进行数据连续写入的时候，比如磁盘以日志格式连续写入操作，其写入速度远远大于磁盘随机写入的速度，比如关系数据库连续更新若干条数据记录，你知道这是为什么吗？</p><p>欢迎你写下自己的思考或疑问，与我和其他同学一起讨论。</p><p></p>","comments":[{"had_liked":false,"id":37537,"user_name":"Panmax","can_delete":false,"product_type":"c1","uid":1004871,"ip_address":"","ucode":"9D65E3B84C5519","user_header":"https://static001.geekbang.org/account/avatar/00/0f/55/47/d217c45f.jpg","comment_is_top":true,"comment_ctime":1541638252,"is_pvip":false,"replies":[{"id":"13445","content":"实践中一般用raid10，已订正，谢谢指正","user_name":"作者回复","user_name_real":"李智慧","uid":"1007349","ctime":1541639550,"ip_address":"","comment_id":37537,"utype":1}],"discussion_count":1,"race_medal":0,"score":"9.2233720985259991e+18","product_id":100020201,"comment_content":"3. 数据可靠性的问题。使用 RAID 0、RAID 5 或者 RAID 6 方案的时候，由于数据有冗余存储，或者存储校验信息，所以当某块磁盘损坏的时候，可以通过其他磁盘上的数据和校验数据将丢失磁盘上的数据还原。<br><br>这里应该是 RAID1 吧","like_count":14,"discussions":[{"author":{"id":1007349,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/5e/f5/018907ac.jpg","nickname":"李智慧","note":"","ucode":"8C9980C438AFD1","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":428389,"discussion_content":"实践中一般用raid10，已订正，谢谢指正","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1541639550,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":37545,"user_name":"多襄丸","can_delete":false,"product_type":"c1","uid":1074310,"ip_address":"","ucode":"1AA1497C5A293C","user_header":"https://static001.geekbang.org/account/avatar/00/10/64/86/f5a9403a.jpg","comment_is_top":false,"comment_ctime":1541638773,"is_pvip":false,"replies":[{"id":"13545","content":"是的","user_name":"作者回复","user_name_real":"李智慧","uid":"1007349","ctime":1541678686,"ip_address":"","comment_id":37545,"utype":1}],"discussion_count":1,"race_medal":0,"score":"684441438837","product_id":100020201,"comment_content":"连续写入：写入只寻址一次 存储位置与逻辑位置相邻 不用多次寻址<br><br>随机写入：每写一次 便寻址一次 增加了磁盘的寻址时间<br>","like_count":159,"discussions":[{"author":{"id":1007349,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/5e/f5/018907ac.jpg","nickname":"李智慧","note":"","ucode":"8C9980C438AFD1","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":428394,"discussion_content":"是的","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1541678686,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":37550,"user_name":"wmg","can_delete":false,"product_type":"c1","uid":1070036,"ip_address":"","ucode":"BA4CED171B59E9","user_header":"https://static001.geekbang.org/account/avatar/00/10/53/d4/2ed767ea.jpg","comment_is_top":false,"comment_ctime":1541639516,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"177635298652","product_id":100020201,"comment_content":"到目前为止专栏的内容基本上是普及大数据知识，非常适合打算入坑的码农，期待后续能有更多关于大数据系统架构和针对某项技术深入介绍的内容。","like_count":41},{"had_liked":false,"id":37603,"user_name":"lyshrine","can_delete":false,"product_type":"c1","uid":1058278,"ip_address":"","ucode":"497551F047A5C6","user_header":"https://static001.geekbang.org/account/avatar/00/10/25/e6/a69cff76.jpg","comment_is_top":false,"comment_ctime":1541649246,"is_pvip":false,"replies":[{"id":"13538","content":"服务器磁盘访问压力大，寿命短<br>你的电脑常年不关机下小电影，硬盘也坏的快","user_name":"作者回复","user_name_real":"李智慧","uid":"1007349","ctime":1541678376,"ip_address":"","comment_id":37603,"utype":1}],"discussion_count":4,"race_medal":0,"score":"164750406494","product_id":100020201,"comment_content":"老师，为啥通常情况一块磁盘使用寿命大概是一年？磁盘不是能用很多年吗？一年一换成本会不会太高了？","like_count":38,"discussions":[{"author":{"id":1116188,"avatar":"https://static001.geekbang.org/account/avatar/00/11/08/1c/ef15e661.jpg","nickname":" 臣馟飞扬","note":"","ucode":"F2F882B7678055","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":185019,"discussion_content":"哈哈，老师有什么好的小电影资源共享一下呗~~","likes_number":11,"is_delete":false,"is_hidden":false,"ctime":1582592639,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1640389,"avatar":"","nickname":"殷小龙","note":"","ucode":"095859187EB697","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":62849,"discussion_content":"准确的说，磁盘的寿命是用写入量的评估的，终身可以写入10PB，一年写10PB一年就坏了，一年写1PB，10年才坏，家用机写入的不频繁","likes_number":10,"is_delete":false,"is_hidden":false,"ctime":1574862755,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1007349,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/5e/f5/018907ac.jpg","nickname":"李智慧","note":"","ucode":"8C9980C438AFD1","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":428420,"discussion_content":"服务器磁盘访问压力大，寿命短\n你的电脑常年不关机下小电影，硬盘也坏的快","likes_number":2,"is_delete":false,"is_hidden":false,"ctime":1541678376,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1200822,"avatar":"https://static001.geekbang.org/account/avatar/00/12/52/b6/d065c05f.jpg","nickname":"atom","note":"","ucode":"7A754C4EA3C3E4","race_medal":0,"user_type":1,"is_pvip":true},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":384786,"discussion_content":"其实1年这个说法不准确 磁盘损坏速度跟读写频率有很大关系","likes_number":2,"is_delete":false,"is_hidden":false,"ctime":1626750749,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":136456,"user_name":"钱","can_delete":false,"product_type":"c1","uid":1009652,"ip_address":"","ucode":"2C92A243A463D4","user_header":"https://static001.geekbang.org/account/avatar/00/0f/67/f4/9a1feb59.jpg","comment_is_top":false,"comment_ctime":1569454116,"is_pvip":false,"discussion_count":1,"race_medal":0,"score":"147598342180","product_id":100020201,"comment_content":"1、本文核心观点：<br>大规模数据存储需要解决的三个核心问题，容量，性能，高可用。<br><br>2、课后思考及问题<br>2-1：老师讲的真棒，一下子把大数据高高在上不可亵玩的外衣给撕掉啦！<br>2-2：大规模数据的三个核心问题，大容量，高性能，高可用。<br>大容量——水平扩展机器数<br>高可用——分布式多副本<br>高性能——这个是最难的，基本上怎么存放数据就决定了存取的性能，但是非关系型数据库还是出现了许多，每一种都有其特点，核心不同点就在于怎么存储数据和存取数据。期待老师后面关于这块的讲解，不过学习过redis和es后发现，主要就是三板斧，一是尽量利用内存；二是尽量使用合适的数据结构，有序的存储结构，三是利用操作系统的高速IO通信，比如：事件驱动IO&#47;零拷贝&#47;异步&#47;多线程<br><br>顺序写为啥那么快？<br>写磁盘的速度其实是一样的，至少同一块磁盘可以认为一样的，关键在顺序二字，如果看过磁盘的内部结构就更清楚了，一块磁盘有多个磁盘片组成，每个磁盘片又划分为不同的磁道，磁道上又划分为不同的扇区，扇区内才是磁盘真正记录数据的地方，写数据之前磁臂磁头要先找到要写的位置。顺序写快就快在找到开始写的地方就可以写数据了，而随机写，写一会可能就需要再找写的位置啦！多花了一些做和写无关的事，自然写不快啦！<br>好比：你也借1个亿，我也借1个亿，假如你是王思聪，你一开口你爸就给你一个亿，我要去100家银行去借，我借钱的速度自然很慢。<br>","like_count":34,"discussions":[{"author":{"id":2518863,"avatar":"https://static001.geekbang.org/account/avatar/00/26/6f/4f/3cf1e9c4.jpg","nickname":"钱鹏 Allen","note":"","ucode":"7E95E82C0717DA","race_medal":0,"user_type":1,"is_pvip":true},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":391906,"discussion_content":"去100家银行，很妙的比喻","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1630682492,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":37534,"user_name":"o°cboy","can_delete":false,"product_type":"c1","uid":1200086,"ip_address":"","ucode":"D9F18B4B16CBB6","user_header":"https://static001.geekbang.org/account/avatar/00/12/4f/d6/fd4794e0.jpg","comment_is_top":false,"comment_ctime":1541638036,"is_pvip":false,"replies":[{"id":"13548","content":"是的","user_name":"作者回复","user_name_real":"李智慧","uid":"1007349","ctime":1541678728,"ip_address":"","comment_id":37534,"utype":1}],"discussion_count":1,"race_medal":0,"score":"121800722324","product_id":100020201,"comment_content":"磁盘的读写过程，最消耗时间的地方就是在磁盘中磁道寻址的过程，而一旦寻址完成，写入数据的速度很快。<br>顺序写入只要一次寻址操作，而随机写入要多次寻址操作。所以顺序写入速度明显高于随机写入。<br>个人的理解，不正确的地方，还请多多指教。","like_count":28,"discussions":[{"author":{"id":1007349,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/5e/f5/018907ac.jpg","nickname":"李智慧","note":"","ucode":"8C9980C438AFD1","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":428388,"discussion_content":"是的","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1541678728,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":189766,"user_name":"杰哥长得帅","can_delete":false,"product_type":"c1","uid":1241993,"ip_address":"","ucode":"5A7FD1794F62D7","user_header":"https://static001.geekbang.org/account/avatar/00/12/f3/89/fcfecb46.jpg","comment_is_top":false,"comment_ctime":1584546958,"is_pvip":false,"replies":[{"id":"73072","content":"就是异或运算<br><br>所有数据的bit位，逐位进行异或，得到的就是校验位。<br><br>如果丢失部分数据，用校验数据和其余数据逐位进行异或运算，可到丢失部分数据。<br><br>举例，5块磁盘做RAID5，四块磁盘上的bit为：0 1 1 1 ，那么异或计算后，校验位为 1，如果丢失了第一块盘上的bit位0，那么校验位1和其他三块盘上的bit位进行异或运算，可以算出0","user_name":"作者回复","user_name_real":"李智慧","uid":"1007349","ctime":1584581171,"ip_address":"","comment_id":189766,"utype":1}],"discussion_count":2,"race_medal":0,"score":"74598990990","product_id":100020201,"comment_content":"2. 数据读写速度的问题。RAID 根据可以使用的磁盘数量，将待写入的数据分成多片，并发同时向多块磁盘进行写入，显然写入的速度可以得到明显提高；同理，读取速度也可以得到明显提高。不过，需要注意的是，由于传统机械磁盘的访问延迟主要来自于寻址时间，数据真正进行读写的时间可能只占据整个数据访问时间的一小部分，所以数据分片后对 N 块磁盘进行并发读写操作并不能将访问速度提高 N 倍。<br><br>还是不能理解为何不能提高n倍。。。。<br><br>还有就是想问下数据校验信息是怎么实现的？<br>谢谢老师👨‍🏫","like_count":17,"discussions":[{"author":{"id":1007349,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/5e/f5/018907ac.jpg","nickname":"李智慧","note":"","ucode":"8C9980C438AFD1","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":487787,"discussion_content":"就是异或运算\n\n所有数据的bit位，逐位进行异或，得到的就是校验位。\n\n如果丢失部分数据，用校验数据和其余数据逐位进行异或运算，可到丢失部分数据。\n\n举例，5块磁盘做RAID5，四块磁盘上的bit为：0 1 1 1 ，那么异或计算后，校验位为 1，如果丢失了第一块盘上的bit位0，那么校验位1和其他三块盘上的bit位进行异或运算，可以算出0","likes_number":1,"is_delete":false,"is_hidden":false,"ctime":1584581171,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":1,"child_discussions":[{"author":{"id":3020972,"avatar":"","nickname":"Geek_2a5cb4","note":"","ucode":"D46C3042606D37","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":1007349,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/5e/f5/018907ac.jpg","nickname":"李智慧","note":"","ucode":"8C9980C438AFD1","race_medal":0,"user_type":2,"is_pvip":false},"discussion":{"id":575237,"discussion_content":"懂了 很牛批啊这检验 完美利用了非0即1 推导出坏的那块磁盘的数据","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1654679466,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":487787,"ip_address":""},"score":575237,"extra":""}]}]},{"had_liked":false,"id":37691,"user_name":"多襄丸","can_delete":false,"product_type":"c1","uid":1074310,"ip_address":"","ucode":"1AA1497C5A293C","user_header":"https://static001.geekbang.org/account/avatar/00/10/64/86/f5a9403a.jpg","comment_is_top":false,"comment_ctime":1541682095,"is_pvip":false,"replies":[{"id":"13645","content":"谢谢","user_name":"作者回复","user_name_real":"李智慧","uid":"1007349","ctime":1541772043,"ip_address":"","comment_id":37691,"utype":1}],"discussion_count":1,"race_medal":0,"score":"70261158831","product_id":100020201,"comment_content":"老师居然回我信息了，好开心！ 我最喜欢那种 讲课做事都亲自来的老师！ 听了老师四节课了，都是老师自己读，有的话是老师的原汁原味的话，在文稿里没有！ 给智慧老师打call!","like_count":16,"discussions":[{"author":{"id":1007349,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/5e/f5/018907ac.jpg","nickname":"李智慧","note":"","ucode":"8C9980C438AFD1","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":428448,"discussion_content":"谢谢","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1541772043,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":37781,"user_name":"hashmap","can_delete":false,"product_type":"c1","uid":1271613,"ip_address":"","ucode":"0F6A1B21BEF8DA","user_header":"https://static001.geekbang.org/account/avatar/00/13/67/3d/e336de58.jpg","comment_is_top":false,"comment_ctime":1541727348,"is_pvip":false,"replies":[{"id":"13643","content":"有raid硬件，也有驱动实现","user_name":"作者回复","user_name_real":"李智慧","uid":"1007349","ctime":1541771885,"ip_address":"","comment_id":37781,"utype":1}],"discussion_count":1,"race_medal":0,"score":"48786367604","product_id":100020201,"comment_content":"磁盘寻址是耗时操作，是时间大于写入时间<br>连续写入，可以寻址一次，然后写入<br>随机写入，需要寻址多次，然后写入<br>所以连续写入快<br>这个问题可以延伸回答，为什么很多数据库索引采用b+树，而不是完全二叉树？<br>因为b+树的节点包含多个信息，可以连续读写磁盘<br>有一疑问？RAID技术是实现在哪里？<br>需要安装软件，还是磁盘的驱动实现","like_count":11,"discussions":[{"author":{"id":1007349,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/5e/f5/018907ac.jpg","nickname":"李智慧","note":"","ucode":"8C9980C438AFD1","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":428483,"discussion_content":"有raid硬件，也有驱动实现","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1541771885,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":37896,"user_name":"暴风雪","can_delete":false,"product_type":"c1","uid":1283139,"ip_address":"","ucode":"BF1523D69866FF","user_header":"https://static001.geekbang.org/account/avatar/00/13/94/43/46a7d0a8.jpg","comment_is_top":false,"comment_ctime":1541777110,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"44491450070","product_id":100020201,"comment_content":"那个RAID3的修复，可以理解为：b1+b2+b3+...+bn=s，其中一块坏掉了，也就是bn数据不见了，可以通过bn=s-b1-b2-b3-...-b(n-1)。","like_count":10},{"had_liked":false,"id":37877,"user_name":"暴风雪","can_delete":false,"product_type":"c1","uid":1283139,"ip_address":"","ucode":"BF1523D69866FF","user_header":"https://static001.geekbang.org/account/avatar/00/13/94/43/46a7d0a8.jpg","comment_is_top":false,"comment_ctime":1541761971,"is_pvip":false,"replies":[{"id":"13642","content":"有一块盘记录校验数据，用校验数据和未损坏盘数据可以计算损坏盘的数据","user_name":"作者回复","user_name_real":"李智慧","uid":"1007349","ctime":1541771726,"ip_address":"","comment_id":37877,"utype":1}],"discussion_count":1,"race_medal":0,"score":"44491434931","product_id":100020201,"comment_content":"我想问一下，RAID 3的任意一块磁盘损坏，通过其他磁盘的数据修复，是怎么修复的？有点不理解这段话","like_count":10,"discussions":[{"author":{"id":1007349,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/5e/f5/018907ac.jpg","nickname":"李智慧","note":"","ucode":"8C9980C438AFD1","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":428508,"discussion_content":"有一块盘记录校验数据，用校验数据和未损坏盘数据可以计算损坏盘的数据","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1541771726,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":37628,"user_name":"lyshrine","can_delete":false,"product_type":"c1","uid":1058278,"ip_address":"","ucode":"497551F047A5C6","user_header":"https://static001.geekbang.org/account/avatar/00/10/25/e6/a69cff76.jpg","comment_is_top":false,"comment_ctime":1541658746,"is_pvip":false,"discussion_count":2,"race_medal":0,"score":"35901397114","product_id":100020201,"comment_content":"“RAID 3可以在数据写入磁盘的时候，将数据分成 N-1 份，并发写入 N-1 块磁盘，并在第 N 块磁盘记录校验数据，这样任何一块磁盘损坏（包括校验数据磁盘），都可以利用其他 N-1 块磁盘的数据修复。”<br>不是很明白：数据都是写到N-1的磁盘里，每个磁盘里的数据都不一样，没有备份，如何数据修复？","like_count":8,"discussions":[{"author":{"id":1228500,"avatar":"https://static001.geekbang.org/account/avatar/00/12/be/d4/ff1c1319.jpg","nickname":"金龟","note":"","ucode":"1C7D35C8AE8D9D","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":3092,"discussion_content":"我也不明白","likes_number":1,"is_delete":false,"is_hidden":false,"ctime":1564154555,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1213258,"avatar":"https://static001.geekbang.org/account/avatar/00/12/83/4a/3e08427e.jpg","nickname":"药师","note":"","ucode":"14BB054A38A2F0","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":311215,"discussion_content":"就理解为通过检验盘的数据加未损坏磁盘数据可以反推出损坏盘的数据，具体就是用位运算作为算法反推","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1602254988,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":37641,"user_name":"zc","can_delete":false,"product_type":"c1","uid":1013406,"ip_address":"","ucode":"A231FA413151DD","user_header":"https://static001.geekbang.org/account/avatar/00/0f/76/9e/dc53669e.jpg","comment_is_top":false,"comment_ctime":1541663794,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"31606434866","product_id":100020201,"comment_content":"老师请推荐大数据相关书籍","like_count":7},{"had_liked":false,"id":37539,"user_name":"格非","can_delete":false,"product_type":"c1","uid":1004569,"ip_address":"","ucode":"89FABFFC377131","user_header":"https://static001.geekbang.org/account/avatar/00/0f/54/19/95ff4cbd.jpg","comment_is_top":false,"comment_ctime":1541638400,"is_pvip":false,"replies":[{"id":"13547","content":"是的","user_name":"作者回复","user_name_real":"李智慧","uid":"1007349","ctime":1541678710,"ip_address":"","comment_id":37539,"utype":1}],"discussion_count":1,"race_medal":0,"score":"27311442176","product_id":100020201,"comment_content":"跟机械磁盘的构造有关，随机读写时，磁头需要不停的移动，时间都浪费在了磁头寻址上","like_count":6,"discussions":[{"author":{"id":1007349,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/5e/f5/018907ac.jpg","nickname":"李智慧","note":"","ucode":"8C9980C438AFD1","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":428391,"discussion_content":"是的","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1541678710,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":37704,"user_name":"落叶飞逝的恋","can_delete":false,"product_type":"c1","uid":1046429,"ip_address":"","ucode":"F9A95DB28BCF1E","user_header":"https://static001.geekbang.org/account/avatar/00/0f/f7/9d/be04b331.jpg","comment_is_top":false,"comment_ctime":1541687657,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"23016524137","product_id":100020201,"comment_content":"RAID 5 6螺旋写入这个怎么看？前面三个图的DATA表示看的懂，后面两个看不懂？还有就是平常开发接触不到服务器怎么办？","like_count":5},{"had_liked":false,"id":37876,"user_name":"暴风雪","can_delete":false,"product_type":"c1","uid":1283139,"ip_address":"","ucode":"BF1523D69866FF","user_header":"https://static001.geekbang.org/account/avatar/00/13/94/43/46a7d0a8.jpg","comment_is_top":false,"comment_ctime":1541761774,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"14426663662","product_id":100020201,"comment_content":"思考题：上文说过，机械硬盘时间消耗主要在寻址上，所以我猜想，连续文件写入时是只寻址一次，后面可以连续写入，所以时间计划不变，而数据库随机写入，每次都要寻址，分配新的地址，所以时间就慢很多了","like_count":3},{"had_liked":false,"id":37572,"user_name":"Lugyedo","can_delete":false,"product_type":"c1","uid":1011793,"ip_address":"","ucode":"EB5E456B638E70","user_header":"https://static001.geekbang.org/account/avatar/00/0f/70/51/f1825adb.jpg","comment_is_top":false,"comment_ctime":1541642634,"is_pvip":true,"replies":[{"id":"13540","content":"hdfs就不用raid<br>分布式存储一般都不用raid","user_name":"作者回复","user_name_real":"李智慧","uid":"1007349","ctime":1541678441,"ip_address":"","comment_id":37572,"utype":1}],"discussion_count":1,"race_medal":0,"score":"14426544522","product_id":100020201,"comment_content":"RAID技术会不会被淘汰","like_count":3,"discussions":[{"author":{"id":1007349,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/5e/f5/018907ac.jpg","nickname":"李智慧","note":"","ucode":"8C9980C438AFD1","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":428404,"discussion_content":"hdfs就不用raid\n分布式存储一般都不用raid","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1541678441,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":37540,"user_name":"小文同学","can_delete":false,"product_type":"c1","uid":1001893,"ip_address":"","ucode":"48F2AEB989C12A","user_header":"https://static001.geekbang.org/account/avatar/00/0f/49/a5/e4c1c2d4.jpg","comment_is_top":false,"comment_ctime":1541638415,"is_pvip":false,"replies":[{"id":"13546","content":"是的","user_name":"作者回复","user_name_real":"李智慧","uid":"1007349","ctime":1541678700,"ip_address":"","comment_id":37540,"utype":1}],"discussion_count":1,"race_medal":0,"score":"14426540303","product_id":100020201,"comment_content":"传统机械硬盘的读写耗时主要在寻址上，连续读写一般只寻址一次，所以速度会快。","like_count":3,"discussions":[{"author":{"id":1007349,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/5e/f5/018907ac.jpg","nickname":"李智慧","note":"","ucode":"8C9980C438AFD1","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":428392,"discussion_content":"是的","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1541678700,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":37527,"user_name":"公号-技术夜未眠","can_delete":false,"product_type":"c1","uid":1013683,"ip_address":"","ucode":"83825B57CBD952","user_header":"https://static001.geekbang.org/account/avatar/00/0f/77/b3/991f3f9b.jpg","comment_is_top":false,"comment_ctime":1541637213,"is_pvip":true,"replies":[{"id":"13549","content":"是的","user_name":"作者回复","user_name_real":"李智慧","uid":"1007349","ctime":1541678743,"ip_address":"","comment_id":37527,"utype":1}],"discussion_count":1,"race_medal":0,"score":"14426539101","product_id":100020201,"comment_content":"1 计算写入地址更简单快速<br>2 磁盘机械机构移动的距离更少，寻址更快<br>3 由于空间的连续性，写入也更快","like_count":3,"discussions":[{"author":{"id":1007349,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/5e/f5/018907ac.jpg","nickname":"李智慧","note":"","ucode":"8C9980C438AFD1","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":428384,"discussion_content":"是的","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1541678743,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":139517,"user_name":"达子不一般","can_delete":false,"product_type":"c1","uid":1315527,"ip_address":"","ucode":"A91C8DB45184F7","user_header":"https://static001.geekbang.org/account/avatar/00/14/12/c7/a7a5df8b.jpg","comment_is_top":false,"comment_ctime":1570671215,"is_pvip":false,"replies":[{"id":"54051","content":"不是压缩，通过位运算计算校验位。","user_name":"作者回复","user_name_real":"李智慧","uid":"1007349","ctime":1570773371,"ip_address":"","comment_id":139517,"utype":1}],"discussion_count":1,"race_medal":0,"score":"10160605807","product_id":100020201,"comment_content":"raid5的磁盘使用率是n-1&#47;n,raid5不是校验信息写在所有磁盘上吗？raid6校验信息写在2块磁盘上，不是raid3的升级吗？没有频繁更新的问题吗？校验信息是类似数据压缩信息吗？2块磁盘能放的下吗？","like_count":2,"discussions":[{"author":{"id":1007349,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/5e/f5/018907ac.jpg","nickname":"李智慧","note":"","ucode":"8C9980C438AFD1","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":469978,"discussion_content":"不是压缩，通过位运算计算校验位。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1570773371,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":59854,"user_name":"Leo","can_delete":false,"product_type":"c1","uid":1038811,"ip_address":"","ucode":"BFAF83E23199DA","user_header":"https://static001.geekbang.org/account/avatar/00/0f/d9/db/66d5b3f4.jpg","comment_is_top":false,"comment_ctime":1547428383,"is_pvip":false,"replies":[{"id":"21595","content":"N块磁盘放在那里，就是一堆磁盘而已，就像N台服务器放在那里，不通过分布式系统把他们架构在一起，就是一堆服务器而已。RAID把这些磁盘组成一个整体，在应用看来就是一块磁盘，存储容量就高了。","user_name":"作者回复","user_name_real":"李智慧","uid":"1007349","ctime":1547523790,"ip_address":"","comment_id":59854,"utype":1}],"discussion_count":1,"race_medal":0,"score":"10137362975","product_id":100020201,"comment_content":"老师，问一个比较低级的问题：为什么说RAID提高了存储容量，不都是N快磁盘吗？如果不用RAID，N快磁盘不也是固定的容量吗？计算机数据本来不能存在多块硬盘上吗？","like_count":2,"discussions":[{"author":{"id":1007349,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/5e/f5/018907ac.jpg","nickname":"李智慧","note":"","ucode":"8C9980C438AFD1","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":436406,"discussion_content":"N块磁盘放在那里，就是一堆磁盘而已，就像N台服务器放在那里，不通过分布式系统把他们架构在一起，就是一堆服务器而已。RAID把这些磁盘组成一个整体，在应用看来就是一块磁盘，存储容量就高了。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1547523790,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":38757,"user_name":"沙鱼","can_delete":false,"product_type":"c1","uid":1282855,"ip_address":"","ucode":"E9B2198C7DBADB","user_header":"https://static001.geekbang.org/account/avatar/00/13/93/27/e32e111e.jpg","comment_is_top":false,"comment_ctime":1542121726,"is_pvip":false,"replies":[{"id":"14011","content":"没有，hdfs要保证机架级别的数据可用性，raid5解决不了，请看下期。","user_name":"作者回复","user_name_real":"李智慧","uid":"1007349","ctime":1542238845,"ip_address":"","comment_id":38757,"utype":1}],"discussion_count":1,"race_medal":0,"score":"10132056318","product_id":100020201,"comment_content":"老师请问一下：如果部署hdfs集群，还有没有必要单台机器做raid5浪费磁盘呢？想听听老师的分析。","like_count":2,"discussions":[{"author":{"id":1007349,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/5e/f5/018907ac.jpg","nickname":"李智慧","note":"","ucode":"8C9980C438AFD1","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":428799,"discussion_content":"没有，hdfs要保证机架级别的数据可用性，raid5解决不了，请看下期。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1542238845,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":37554,"user_name":"才才","can_delete":false,"product_type":"c1","uid":1242373,"ip_address":"","ucode":"94D76106261987","user_header":"https://static001.geekbang.org/account/avatar/00/12/f5/05/d6547381.jpg","comment_is_top":false,"comment_ctime":1541639757,"is_pvip":false,"replies":[{"id":"13543","content":"是的","user_name":"作者回复","user_name_real":"李智慧","uid":"1007349","ctime":1541678589,"ip_address":"","comment_id":37554,"utype":1}],"discussion_count":1,"race_medal":0,"score":"10131574349","product_id":100020201,"comment_content":"批量地址连续，指针的寻址没那么跳跃","like_count":2,"discussions":[{"author":{"id":1007349,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/5e/f5/018907ac.jpg","nickname":"李智慧","note":"","ucode":"8C9980C438AFD1","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":428398,"discussion_content":"是的","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1541678589,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":222935,"user_name":"jacky","can_delete":false,"product_type":"c1","uid":1716933,"ip_address":"","ucode":"CD583272CF1237","user_header":"https://static001.geekbang.org/account/avatar/00/1a/32/c5/025e6716.jpg","comment_is_top":false,"comment_ctime":1590970849,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"5885938145","product_id":100020201,"comment_content":"随机写入的时候，需要磁盘不断地转动盘片，磁头，更换磁道，也就是所谓的寻址，在一次随机写入中，寻址时间占了一次IO的大部分时间，所以随机性能主要看磁盘的IOPS，一般普通的机械硬盘IOPS大概100多，而顺序写入则不需要这么频繁的寻址，只需要连续不断地按照LBA顺序写入数据，所以顺序IO性能主要看磁盘的吞吐。","like_count":1},{"had_liked":false,"id":173832,"user_name":"linker","can_delete":false,"product_type":"c1","uid":1803259,"ip_address":"","ucode":"6C5799F2FC2C82","user_header":"https://static001.geekbang.org/account/avatar/00/1b/83/fb/621adceb.jpg","comment_is_top":false,"comment_ctime":1579713504,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"5874680800","product_id":100020201,"comment_content":"连续写入只要一次寻道时间。而传统的机械硬盘的寻道时间占比很大，所以减少寻道时间，就能到提升连续写入速度","like_count":1},{"had_liked":false,"id":65001,"user_name":"抛物线","can_delete":false,"product_type":"c1","uid":1207118,"ip_address":"","ucode":"E872599B490FF1","user_header":"https://static001.geekbang.org/account/avatar/00/12/6b/4e/507cd4a4.jpg","comment_is_top":false,"comment_ctime":1548997719,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"5843965015","product_id":100020201,"comment_content":"磁盘是一种块存储设备，在读写过程中，主要的时间消耗是在寻址。当连续写入日志或数据库一次性若干条记录，那么硬盘只需要寻址一次。","like_count":1},{"had_liked":false,"id":62208,"user_name":"hallo128","can_delete":false,"product_type":"c1","uid":1212044,"ip_address":"","ucode":"3921D6E11CFCB1","user_header":"https://static001.geekbang.org/account/avatar/00/12/7e/8c/f029535a.jpg","comment_is_top":false,"comment_ctime":1547983102,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"5842950398","product_id":100020201,"comment_content":"老师讲得真的很清楚了，之前对大数据只了解一个分布式概念，至于存储量，可靠性，读写速度这方面的问题，都没有想过。磁盘的集成引入问题，真的很有启发。","like_count":1},{"had_liked":false,"id":44484,"user_name":"刘工的一号马由","can_delete":false,"product_type":"c1","uid":1024110,"ip_address":"","ucode":"92C4D4186DDFB9","user_header":"https://static001.geekbang.org/account/avatar/00/0f/a0/6e/85512d27.jpg","comment_is_top":false,"comment_ctime":1543452852,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"5838420148","product_id":100020201,"comment_content":"RAID5为什么是N-1呢？不是所有磁盘螺旋写入吗？应该所有磁盘都可以使用啊","like_count":1},{"had_liked":false,"id":39372,"user_name":"高国君","can_delete":false,"product_type":"c1","uid":1308879,"ip_address":"","ucode":"AF205FFDED7E92","user_header":"https://static001.geekbang.org/account/avatar/00/13/f8/cf/e73c402f.jpg","comment_is_top":false,"comment_ctime":1542258412,"is_pvip":false,"replies":[{"id":"14141","content":"是的","user_name":"作者回复","user_name_real":"李智慧","uid":"1007349","ctime":1542294050,"ip_address":"","comment_id":39372,"utype":1}],"discussion_count":1,"race_medal":0,"score":"5837225708","product_id":100020201,"comment_content":"磁盘IO是需要机械寻址的，相比较数据写或读的时间来说是耗时操作。连续写入，只需要寻址一次，随机写入，每次写都要寻址。所以，","like_count":1,"discussions":[{"author":{"id":1007349,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/5e/f5/018907ac.jpg","nickname":"李智慧","note":"","ucode":"8C9980C438AFD1","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":429036,"discussion_content":"是的","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1542294050,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":37940,"user_name":"Ahikaka","can_delete":false,"product_type":"c1","uid":1045146,"ip_address":"","ucode":"B3A678567E40A9","user_header":"https://thirdwx.qlogo.cn/mmopen/vi_32/vhOPEib27xAuTycN0eQekLzsCe9zwcTTcrOb98cIfpgibgcweZBDN38tIicABibuZBwah9jnGVr02H2Zjuue1fLfEQ/132","comment_is_top":false,"comment_ctime":1541818937,"is_pvip":false,"replies":[{"id":"13779","content":"是的","user_name":"作者回复","user_name_real":"李智慧","uid":"1007349","ctime":1542032768,"ip_address":"","comment_id":37940,"utype":1}],"discussion_count":1,"race_medal":0,"score":"5836786233","product_id":100020201,"comment_content":"机械硬盘读取数据需要依靠读针头在盘上移动来进行读书操作，连续读取的时候针头只需要转动就好了，随机读取的时候不不仅要转动跳过无用的数据，还要再轴上前前后后移动，浪费了太多时间。","like_count":1,"discussions":[{"author":{"id":1007349,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/5e/f5/018907ac.jpg","nickname":"李智慧","note":"","ucode":"8C9980C438AFD1","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":428533,"discussion_content":"是的","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1542032768,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":37938,"user_name":"intuition","can_delete":false,"product_type":"c1","uid":1083657,"ip_address":"","ucode":"94D61C78277850","user_header":"https://static001.geekbang.org/account/avatar/00/10/89/09/d660509d.jpg","comment_is_top":false,"comment_ctime":1541817353,"is_pvip":false,"replies":[{"id":"13780","content":"如果你的数据量不是特别大，就不是非得用nosql。如果你的业务依赖SQL，可以用MySQL的伸缩方案。","user_name":"作者回复","user_name_real":"李智慧","uid":"1007349","ctime":1542032952,"ip_address":"","comment_id":37938,"utype":1}],"discussion_count":1,"race_medal":0,"score":"5836784649","product_id":100020201,"comment_content":"老师 我实战经验减少 我一直有个疑惑 mysql是水平拓展的 那存在哪些问题呢 这和一些nosql比例如hbase 有哪些不足呢 我们的架构何时才会由mysql集群升级为这些nosql呢","like_count":1,"discussions":[{"author":{"id":1007349,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/5e/f5/018907ac.jpg","nickname":"李智慧","note":"","ucode":"8C9980C438AFD1","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":428532,"discussion_content":"如果你的数据量不是特别大，就不是非得用nosql。如果你的业务依赖SQL，可以用MySQL的伸缩方案。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1542032952,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":37615,"user_name":"jack","can_delete":false,"product_type":"c1","uid":1182934,"ip_address":"","ucode":"D3DBD1DC490E1E","user_header":"https://static001.geekbang.org/account/avatar/00/12/0c/d6/2677ec43.jpg","comment_is_top":false,"comment_ctime":1541652633,"is_pvip":false,"replies":[{"id":"13535","content":"是的","user_name":"作者回复","user_name_real":"李智慧","uid":"1007349","ctime":1541678087,"ip_address":"","comment_id":37615,"utype":1}],"discussion_count":1,"race_medal":0,"score":"5836619929","product_id":100020201,"comment_content":"影响磁盘读写效率最主要因素是磁盘寻址，连续读写只有一次寻址，随机写入每一次都要寻址。","like_count":1,"discussions":[{"author":{"id":1007349,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/5e/f5/018907ac.jpg","nickname":"李智慧","note":"","ucode":"8C9980C438AFD1","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":428426,"discussion_content":"是的","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1541678087,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":37522,"user_name":"summer ₂ ₀ ₁ ₈","can_delete":false,"product_type":"c1","uid":1281478,"ip_address":"","ucode":"E8E582007494E7","user_header":"https://static001.geekbang.org/account/avatar/00/13/8d/c6/1ac9edae.jpg","comment_is_top":false,"comment_ctime":1541635988,"is_pvip":false,"replies":[{"id":"13553","content":"是的","user_name":"作者回复","user_name_real":"李智慧","uid":"1007349","ctime":1541678798,"ip_address":"","comment_id":37522,"utype":1}],"discussion_count":1,"race_medal":0,"score":"5836603284","product_id":100020201,"comment_content":"这个应该是文中提到的寻址有关，找到了这个表的存储文件后，一次寻址多次写入，望老师指点！","like_count":1,"discussions":[{"author":{"id":1007349,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/5e/f5/018907ac.jpg","nickname":"李智慧","note":"","ucode":"8C9980C438AFD1","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":428380,"discussion_content":"是的","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1541678798,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":37517,"user_name":"每天晒白牙","can_delete":false,"product_type":"c1","uid":1004698,"ip_address":"","ucode":"A1B102CD933DEA","user_header":"https://static001.geekbang.org/account/avatar/00/0f/54/9a/76c0af70.jpg","comment_is_top":false,"comment_ctime":1541635167,"is_pvip":false,"replies":[{"id":"13554","content":"是的","user_name":"作者回复","user_name_real":"李智慧","uid":"1007349","ctime":1541678849,"ip_address":"","comment_id":37517,"utype":1}],"discussion_count":1,"race_medal":1,"score":"5836602463","product_id":100020201,"comment_content":"随机写入相对于连续写入增加了寻址时间。<br>连续写入磁头移动范围小，随机写入磁头移动范围大，所以连续写入速度快。","like_count":1,"discussions":[{"author":{"id":1007349,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/5e/f5/018907ac.jpg","nickname":"李智慧","note":"","ucode":"8C9980C438AFD1","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":428376,"discussion_content":"是的","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1541678849,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":37513,"user_name":"李强","can_delete":false,"product_type":"c1","uid":1109968,"ip_address":"","ucode":"29652ED057EC10","user_header":"https://static001.geekbang.org/account/avatar/00/10/ef/d0/d0925f9f.jpg","comment_is_top":false,"comment_ctime":1541633307,"is_pvip":false,"replies":[{"id":"13555","content":"是的","user_name":"作者回复","user_name_real":"李智慧","uid":"1007349","ctime":1541678902,"ip_address":"","comment_id":37513,"utype":1}],"discussion_count":1,"race_medal":0,"score":"5836600603","product_id":100020201,"comment_content":"减少了寻址时间，关系型数据库，直接将日志写入到固定的地址，而随机还需要寻址，然后再写入","like_count":1,"discussions":[{"author":{"id":1007349,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/5e/f5/018907ac.jpg","nickname":"李智慧","note":"","ucode":"8C9980C438AFD1","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":428374,"discussion_content":"是的","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1541678902,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":37500,"user_name":"无形","can_delete":false,"product_type":"c1","uid":1016889,"ip_address":"","ucode":"B740E2A68A17A5","user_header":"https://static001.geekbang.org/account/avatar/00/0f/84/39/c8772466.jpg","comment_is_top":false,"comment_ctime":1541610215,"is_pvip":true,"replies":[{"id":"13556","content":"是的","user_name":"作者回复","user_name_real":"李智慧","uid":"1007349","ctime":1541678908,"ip_address":"","comment_id":37500,"utype":1}],"discussion_count":1,"race_medal":0,"score":"5836577511","product_id":100020201,"comment_content":"顺序io比随机io快","like_count":1,"discussions":[{"author":{"id":1007349,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/5e/f5/018907ac.jpg","nickname":"李智慧","note":"","ucode":"8C9980C438AFD1","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":428370,"discussion_content":"是的","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1541678908,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":359777,"user_name":"woJA1wCgAAMiqadN4anEjNVgD_7J3AIg","can_delete":false,"product_type":"c1","uid":3001861,"ip_address":"广东","ucode":"3B3E0AC10C670F","user_header":"","comment_is_top":false,"comment_ctime":1665861622,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1665861622","product_id":100020201,"comment_content":"首先磁盘内存是块连续的空间，连续的写入只需要变更指针偏移量，不需要重新进行寻址。而随机写入，每次的指针都不相同需要进行重新寻址。<br>其次因为有操作系统中有缓存页的存在，对同一块空间的写入，也可以直接写在同一pageCache缓存页中，由操作系统自动刷写。而随机写入的地址互不相同则需要建立新的pageCache缓存页，增加成本及降低效率","like_count":0},{"had_liked":false,"id":341402,"user_name":"王振华 程序员","can_delete":false,"product_type":"c1","uid":1131957,"ip_address":"","ucode":"31BB337642B882","user_header":"https://static001.geekbang.org/account/avatar/00/11/45/b5/c3cfb198.jpg","comment_is_top":false,"comment_ctime":1649581956,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1649581956","product_id":100020201,"comment_content":"总结：大数据，顾名思义，要解决的是大规模数据的计算处理问题，而这首先就要解决大规模数据的存储问题，而这又需要解决3个问题：<br>1. 1个文件的大小就大于1个磁盘的容量<br>2. 读写速度太低<br>3. 数据可靠性问题<br>传统的解决这3个问题的方式是RAID，把这个思想用到分布式服务器集群上，就是Hadoop分布式文件系统HDFS。<br>RAID是垂直伸缩，也就是想办法提高一台计算机的性能，HDFS则是水平伸缩，不断添加多台服务器。而技术方向变化的背后则是商业需求的变化，一是互联网时代性能的需求不确定，二是垂直伸缩基本达到了极限，所以水平伸缩就登山了舞台。<br><br>","like_count":0},{"had_liked":false,"id":324762,"user_name":"Geek6116","can_delete":false,"product_type":"c1","uid":2844811,"ip_address":"","ucode":"C228701EDBF648","user_header":"","comment_is_top":false,"comment_ctime":1638606153,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1638606153","product_id":100020201,"comment_content":"传统机械磁盘的访问延迟主要来自于寻址时间，数据真正进行读写的时间可能只占据整个数据访问时间的一小部分。连续写入只需要寻址一次，随机写入需要多次寻址","like_count":0},{"had_liked":false,"id":324230,"user_name":"hujihu33","can_delete":false,"product_type":"c1","uid":1078729,"ip_address":"","ucode":"686860FE2DFABB","user_header":"https://static001.geekbang.org/account/avatar/00/10/75/c9/fb23007c.jpg","comment_is_top":false,"comment_ctime":1638344744,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1638344744","product_id":100020201,"comment_content":"连续写入磁盘只需要寻址一次，其他的位置只需要逻辑相位置就可以写入。随机写入，没写入一次都需要寻址一次。","like_count":0},{"had_liked":false,"id":310499,"user_name":"钱鹏 Allen","can_delete":false,"product_type":"c1","uid":2518863,"ip_address":"","ucode":"7E95E82C0717DA","user_header":"https://static001.geekbang.org/account/avatar/00/26/6f/4f/3cf1e9c4.jpg","comment_is_top":false,"comment_ctime":1630682376,"is_pvip":true,"discussion_count":0,"race_medal":0,"score":"1630682376","product_id":100020201,"comment_content":"连续的写入速度远远大于磁盘随机写入的速度<br><br>RAID0写入的速度快，RAID1分区后需要加上寻址的时间","like_count":0},{"had_liked":false,"id":305876,"user_name":"Flychen","can_delete":false,"product_type":"c1","uid":1880782,"ip_address":"","ucode":"4029A8F1D3C361","user_header":"https://static001.geekbang.org/account/avatar/00/1c/b2/ce/5638be2b.jpg","comment_is_top":false,"comment_ctime":1628216678,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1628216678","product_id":100020201,"comment_content":"连续写入，相对随机写入 主要是节约了寻址时间","like_count":0},{"had_liked":false,"id":299046,"user_name":"kunkun","can_delete":false,"product_type":"c1","uid":1083701,"ip_address":"","ucode":"C5939C86787E33","user_header":"https://static001.geekbang.org/account/avatar/00/10/89/35/0267d869.jpg","comment_is_top":false,"comment_ctime":1624437547,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1624437547","product_id":100020201,"comment_content":"将数据分成对等2份，然后将这2份运算成第3份，就只需要3个空间来存放这3分数据。<br>而这3个空间如果只损坏1个空间的情况下，数据都可以恢复。<br>就如我们要存两个数字a和b，同时在另外一个地方存放了a+b(不考虑溢出情况)，<br>如果存放b的空间损坏，由c-a可得b。","like_count":0},{"had_liked":false,"id":295403,"user_name":"CK宇","can_delete":false,"product_type":"c1","uid":1676584,"ip_address":"","ucode":"E9BBA09619BCCB","user_header":"https://static001.geekbang.org/account/avatar/00/19/95/28/295ae99c.jpg","comment_is_top":false,"comment_ctime":1622418666,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1622418666","product_id":100020201,"comment_content":"随机写入多了每次写入的上下文开销，连续写入只有一次","like_count":0},{"had_liked":false,"id":291920,"user_name":"Django","can_delete":false,"product_type":"c1","uid":2251107,"ip_address":"","ucode":"7BBC6F2EDD41AD","user_header":"https://static001.geekbang.org/account/avatar/00/22/59/63/f4a0f3b9.jpg","comment_is_top":false,"comment_ctime":1620607920,"is_pvip":false,"replies":[{"id":"105759","content":"评论区已经讨论过了，异或运算","user_name":"作者回复","user_name_real":"李智慧","uid":"1007349","ctime":1620700681,"ip_address":"","comment_id":291920,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1620607920","product_id":100020201,"comment_content":"raid5、6如何通过其他磁盘数据加上检验数据来还原损坏的磁盘数据的？这一点没想通，麻烦解答一下谢谢","like_count":0,"discussions":[{"author":{"id":1007349,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/5e/f5/018907ac.jpg","nickname":"李智慧","note":"","ucode":"8C9980C438AFD1","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":519605,"discussion_content":"评论区已经讨论过了，异或运算","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1620700681,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":289532,"user_name":"levi","can_delete":false,"product_type":"c1","uid":1501281,"ip_address":"","ucode":"41AFA57F56C15E","user_header":"https://static001.geekbang.org/account/avatar/00/16/e8/61/47293afd.jpg","comment_is_top":false,"comment_ctime":1619063823,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1619063823","product_id":100020201,"comment_content":"磁盘读取数据的时间=寻道时间 + 真正写数据的时间，<br>机械盘如果连续写入，只需要一次寻道时间+n次写入时间，通常n足够大时，寻道时间可以忽略；而如果随机写入，则需要n次寻道时间+n次写入时间，这里n越大，总寻道时间越大，故而非常耗性能。著名的kafka，hbase的WAL等，都是采用了连续读写来提升性能<br>实际上SSD的顺序读写性能也是要高于随机读写性能的，原因主要是连续读写可以预加载以及流水线上并行化处理","like_count":0},{"had_liked":false,"id":285215,"user_name":"阿廖先生","can_delete":false,"product_type":"c1","uid":1116155,"ip_address":"","ucode":"E78812EE852F67","user_header":"https://static001.geekbang.org/account/avatar/00/11/07/fb/abfe3708.jpg","comment_is_top":false,"comment_ctime":1616671610,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1616671610","product_id":100020201,"comment_content":"主要是多次随机访问磁盘，需要多次寻址。连续写入的话，只需要寻址一次","like_count":0},{"had_liked":false,"id":281547,"user_name":"HarveyHanzy","can_delete":false,"product_type":"c1","uid":1922083,"ip_address":"","ucode":"74E0FEC00128B0","user_header":"https://thirdwx.qlogo.cn/mmopen/vi_32/Q3auHgzwzM7J1ef5o74bywMG5zftY8ZpTO1Vs6YKpjiaXXzyWbWPtcf5TX5eCrX0pzk2UaIDGjXtYVlNG5YtTmg/132","comment_is_top":false,"comment_ctime":1614782238,"is_pvip":false,"replies":[{"id":"102302","content":"但是在数据修改较多的场景中，任何磁盘数据的修改，都会导致第 N 块磁盘重写校验数据。频繁写入的后果是第 N 块磁盘比其他磁盘更容易损坏，需要频繁更换","user_name":"作者回复","user_name_real":"李智慧","uid":"1007349","ctime":1614915473,"ip_address":"","comment_id":281547,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1614782238","product_id":100020201,"comment_content":"RAID5的螺旋写入不是太理解，在螺旋写入过程中，第N块磁盘与前面的N-1 块磁盘承载的校验数据功能有何不同呢？","like_count":0,"discussions":[{"author":{"id":1007349,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/5e/f5/018907ac.jpg","nickname":"李智慧","note":"","ucode":"8C9980C438AFD1","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":516437,"discussion_content":"但是在数据修改较多的场景中，任何磁盘数据的修改，都会导致第 N 块磁盘重写校验数据。频繁写入的后果是第 N 块磁盘比其他磁盘更容易损坏，需要频繁更换","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1614915473,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":280868,"user_name":"毛巧龙","can_delete":false,"product_type":"c1","uid":1053393,"ip_address":"","ucode":"4FDB06EAB67A61","user_header":"https://static001.geekbang.org/account/avatar/00/10/12/d1/eb07d91a.jpg","comment_is_top":false,"comment_ctime":1614432237,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1614432237","product_id":100020201,"comment_content":"寻址时间大于数据存取时间。对于大数据来说是否意味着寻址设计将会是根本问题","like_count":0},{"had_liked":false,"id":273490,"user_name":"Geek6561","can_delete":false,"product_type":"c1","uid":2028940,"ip_address":"","ucode":"D44141D4AD2587","user_header":"","comment_is_top":false,"comment_ctime":1610612738,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1610612738","product_id":100020201,"comment_content":"思考题：主要是顺相互处理数据，减少了寻址时间，大大提高访问速度。","like_count":0},{"had_liked":false,"id":257459,"user_name":"雄鹰","can_delete":false,"product_type":"c1","uid":1786819,"ip_address":"","ucode":"67E0C4BDE7F6F2","user_header":"https://static001.geekbang.org/account/avatar/00/1b/43/c3/2c53acd7.jpg","comment_is_top":false,"comment_ctime":1603978747,"is_pvip":true,"replies":[{"id":"93811","content":"性能一样的，用裸盘","user_name":"作者回复","user_name_real":"李智慧","uid":"1007349","ctime":1604041298,"ip_address":"","comment_id":257459,"utype":1}],"discussion_count":2,"race_medal":0,"score":"1603978747","product_id":100020201,"comment_content":"老师你好：有个关于磁盘做raid问题请教您，测hdfs的基准性能，现在每个服务器上有4块磁盘，是把这4块磁盘做成raid0(单考虑性能)的读写性能好还是4块磁盘都是挂裸盘的读写性能好？","like_count":0,"discussions":[{"author":{"id":1007349,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/5e/f5/018907ac.jpg","nickname":"李智慧","note":"","ucode":"8C9980C438AFD1","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":508339,"discussion_content":"性能一样的，用裸盘","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1604041298,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":3003980,"avatar":"","nickname":"Geek_5eb648","note":"","ucode":"0D2E7CA26847D7","race_medal":0,"user_type":1,"is_pvip":true},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":591300,"discussion_content":"没有理解为什么做成radi0不能进一步增加性能？","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1666453607,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":"北京"},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":229692,"user_name":"jams","can_delete":false,"product_type":"c1","uid":1647000,"ip_address":"","ucode":"3C37EF4825CDE3","user_header":"https://static001.geekbang.org/account/avatar/00/19/21/98/16b6dce5.jpg","comment_is_top":false,"comment_ctime":1593099638,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1593099638","product_id":100020201,"comment_content":"老师，raid5 螺旋式写入磁盘是什么意思，这样子坏了一次磁盘，是怎么样修复数据的呢","like_count":0},{"had_liked":false,"id":220808,"user_name":"技术修行者","can_delete":false,"product_type":"c1","uid":1013147,"ip_address":"","ucode":"28CA41A1214D6B","user_header":"https://static001.geekbang.org/account/avatar/00/0f/75/9b/611e74ab.jpg","comment_is_top":false,"comment_ctime":1590325793,"is_pvip":true,"discussion_count":0,"race_medal":5,"score":"1590325793","product_id":100020201,"comment_content":"传统机械磁盘读写文件的时间，大部分花在寻址上面，如果是连续写入或者读取，那么只需要一次寻址即可。如果是随机写入或者读取，那么需要多次寻址，这样花的时间就多了。<br>另外，目前的大数据系统，使用机械磁盘的还多吗？一般都换成SSD了吧。","like_count":0},{"had_liked":false,"id":219892,"user_name":"小豹哥","can_delete":false,"product_type":"c1","uid":1613919,"ip_address":"","ucode":"115FF45CAA6FAD","user_header":"https://static001.geekbang.org/account/avatar/00/18/a0/5f/cf72d453.jpg","comment_is_top":false,"comment_ctime":1590114875,"is_pvip":true,"discussion_count":0,"race_medal":0,"score":"1590114875","product_id":100020201,"comment_content":"老师好，有个疑问，RAID 5 和 RAID 3 很相似，但是校验数据不是写入第 N 块磁盘，而是螺旋式地写入所有磁盘中。螺旋式的写入磁盘是啥意思？ 比如data 变成了 date ，又从 date 变成 datt ，第一次改变的值存在第一块磁盘，第二次改变的值放在第二块磁盘并将第一次改变的值也加进来？","like_count":0},{"had_liked":false,"id":189921,"user_name":"杰哥长得帅","can_delete":false,"product_type":"c1","uid":1241993,"ip_address":"","ucode":"5A7FD1794F62D7","user_header":"https://static001.geekbang.org/account/avatar/00/12/f3/89/fcfecb46.jpg","comment_is_top":false,"comment_ctime":1584582284,"is_pvip":false,"discussion_count":1,"race_medal":0,"score":"1584582284","product_id":100020201,"comment_content":"2. 数据读写速度的问题。RAID 根据可以使用的磁盘数量，将待写入的数据分成多片，并发同时向多块磁盘进行写入，显然写入的速度可以得到明显提高；同理，读取速度也可以得到明显提高。不过，需要注意的是，由于传统机械磁盘的访问延迟主要来自于寻址时间，数据真正进行读写的时间可能只占据整个数据访问时间的一小部分，所以数据分片后对 N 块磁盘进行并发读写操作并不能将访问速度提高 N 倍。<br><br>老师能举个例子说明下为什么不能提高n倍吗<br>谢谢老师","like_count":0,"discussions":[{"author":{"id":1241993,"avatar":"https://static001.geekbang.org/account/avatar/00/12/f3/89/fcfecb46.jpg","nickname":"杰哥长得帅","note":"","ucode":"5A7FD1794F62D7","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":209067,"discussion_content":"我懂了，就是说还是寻址那一次，然后n并发写入。而不是n个线程同时并发寻址并读写","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1584605838,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":177503,"user_name":"小伟","can_delete":false,"product_type":"c1","uid":1359701,"ip_address":"","ucode":"124953423491E2","user_header":"https://static001.geekbang.org/account/avatar/00/14/bf/55/198c6104.jpg","comment_is_top":false,"comment_ctime":1581406942,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1581406942","product_id":100020201,"comment_content":"思考题：<br>    只需要寻址一次，剩下的用偏移量就能得到地址。连续写入相邻的磁道，磁头移动的距离短，故写入速度快。","like_count":0},{"had_liked":false,"id":175450,"user_name":"淤白","can_delete":false,"product_type":"c1","uid":1206503,"ip_address":"","ucode":"D1E65DC40DAF68","user_header":"https://static001.geekbang.org/account/avatar/00/12/68/e7/ee47d0e2.jpg","comment_is_top":false,"comment_ctime":1580722926,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1580722926","product_id":100020201,"comment_content":"重新看了一遍，发现了一个自己原来没发现的思维误区：RAID 5等是如何保证磁盘数据的可靠性的（一开始想的就是和 RAID 1 一样，别的上面就有现成的，这次学习后才意识到这里其实是需要算法来支持的）。","like_count":0},{"had_liked":false,"id":170780,"user_name":"极无宪","can_delete":false,"product_type":"c1","uid":1309726,"ip_address":"","ucode":"B86438E0930A95","user_header":"https://static001.geekbang.org/account/avatar/00/13/fc/1e/1e48fd05.jpg","comment_is_top":false,"comment_ctime":1578714448,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1578714448","product_id":100020201,"comment_content":"连续写入不需要在寻址","like_count":0},{"had_liked":false,"id":169663,"user_name":"淤白","can_delete":false,"product_type":"c1","uid":1206503,"ip_address":"","ucode":"D1E65DC40DAF68","user_header":"https://static001.geekbang.org/account/avatar/00/12/68/e7/ee47d0e2.jpg","comment_is_top":false,"comment_ctime":1578400178,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1578400178","product_id":100020201,"comment_content":"随机写入每次都需要寻址，而顺序写入只需要一次，如文中所说，寻址才是更耗时的操作。","like_count":0},{"had_liked":false,"id":108835,"user_name":"少盐","can_delete":false,"product_type":"c1","uid":1305743,"ip_address":"","ucode":"BCC7E264B75702","user_header":"https://static001.geekbang.org/account/avatar/00/13/ec/8f/8299495a.jpg","comment_is_top":false,"comment_ctime":1561898057,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1561898057","product_id":100020201,"comment_content":"垂直伸缩增强单机性能，水平伸缩把多个普通机器组成集群，发挥团队力量，磁盘发展就是解决存储空间，速度，可靠性问题，raid就是在水平方向并利用信息冗余和并发解决速度和可靠性问题，当然存储空间问题也解决了","like_count":0},{"had_liked":false,"id":88690,"user_name":"gkb111","can_delete":false,"product_type":"c1","uid":1224217,"ip_address":"","ucode":"9B3154BCC9046B","user_header":"http://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTLLUic3XzxET3L3QXxcTbeg96GMx1HkiaiaZdudchmOmtPnuEPHK5vYEeMkvJR098XljMbXDialYib3z6w/132","comment_is_top":false,"comment_ctime":1555982933,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1555982933","product_id":100020201,"comment_content":"raid 垂直伸缩，与水平扩展，思路不错，<br>些磁盘，访址时间大于写磁盘时间，顺序写入比较高效","like_count":0},{"had_liked":false,"id":81220,"user_name":"nice_why","can_delete":false,"product_type":"c1","uid":1236498,"ip_address":"","ucode":"33CFE25327F2A3","user_header":"https://static001.geekbang.org/account/avatar/00/12/de/12/bde6c0de.jpg","comment_is_top":false,"comment_ctime":1553834013,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1553834013","product_id":100020201,"comment_content":"关系数据库连续更新若干条数据记录：<br>一般都是日志模式，更新信息先cache到多个 redo 或者 undo 类似日志下，然后分批随机提交到schema对应的storage，再由storage的水位线去提交给物理磁盘。<br>目的就是减少高频繁寻址带来的性能开销和物理磁盘寿命开销。","like_count":0},{"had_liked":false,"id":62494,"user_name":"杰之7","can_delete":false,"product_type":"c1","uid":1297232,"ip_address":"","ucode":"F7DA2E21085332","user_header":"https://static001.geekbang.org/account/avatar/00/13/cb/50/66d0bd7f.jpg","comment_is_top":false,"comment_ctime":1548072101,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1548072101","product_id":100020201,"comment_content":"通过这一节的复习，进一步熟悉了从RAID的思想原理（集成更多的磁盘）到HDFS（集成更多的服务器对分布式文件系统存储）的过程。<br><br>回答老师的问题，连续写入和随机写入的的速度不同。因为连续写入只需要一次寻址，而随机写入需要多次寻址。老师在文章中也写到，机械磁盘的访问延迟主要来自于寻址时间。<br><br>老师在文章中重点分析了RAID的演进过程。我有两个疑问，一是RAID3在数据写入磁盘是将数据分成N-1份，写入N-1块磁盘，在第N快磁盘记录效验数据，我的问题是：为什么这样任何一块磁盘损坏，都可以利用其他N-1块磁盘的数据修复？<br><br>第二个疑问是RAID5效验数据螺旋式写入所有磁盘，RAID6效验数据螺旋式的在两块磁盘中写入。这样的话RAID5和RAID6的工作方式是否是不同的？<br><br><br><br><br><br>","like_count":0},{"had_liked":false,"id":57914,"user_name":"丶请叫我七七丿。","can_delete":false,"product_type":"c1","uid":1319483,"ip_address":"","ucode":"1F1F4263F317BF","user_header":"https://static001.geekbang.org/account/avatar/00/14/22/3b/a9064d21.jpg","comment_is_top":false,"comment_ctime":1546939928,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1546939928","product_id":100020201,"comment_content":"连续写入，只需要寻址一次就行了<br>随机写入，需要每次都寻址，而寻址是写入数据过程中最花费时间的","like_count":0},{"had_liked":false,"id":56978,"user_name":"钟悠","can_delete":false,"product_type":"c1","uid":1114612,"ip_address":"","ucode":"5AF2CAE1737927","user_header":"https://static001.geekbang.org/account/avatar/00/11/01/f4/3dc9bcce.jpg","comment_is_top":false,"comment_ctime":1546591678,"is_pvip":true,"discussion_count":0,"race_medal":0,"score":"1546591678","product_id":100020201,"comment_content":"连续写入节约了寻址时间","like_count":0},{"had_liked":false,"id":51903,"user_name":"karas","can_delete":false,"product_type":"c1","uid":1349594,"ip_address":"","ucode":"836873D0D9973B","user_header":"https://static001.geekbang.org/account/avatar/00/14/97/da/ae765e15.jpg","comment_is_top":false,"comment_ctime":1545274936,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1545274936","product_id":100020201,"comment_content":"随机访问的话磁盘还要转一圈寻找读写位置，再读写，转圈纯机械运动，大概有些慢🙃","like_count":0},{"had_liked":false,"id":51499,"user_name":"成功","can_delete":false,"product_type":"c1","uid":1112099,"ip_address":"","ucode":"954B90AC92E8C3","user_header":"https://static001.geekbang.org/account/avatar/00/10/f8/23/165d2f0e.jpg","comment_is_top":false,"comment_ctime":1545190128,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1545190128","product_id":100020201,"comment_content":"是个寻址问题，每次随机写，会根据FIFO，SSTF，SCAN等算法找对应磁道。固定的格式，寻址到首地址，后面的访问是连续的，不用计算，数据量越大，性能比随机写越好。","like_count":0},{"had_liked":false,"id":50061,"user_name":"zhou0953","can_delete":false,"product_type":"c1","uid":1001278,"ip_address":"","ucode":"753C090C5BDD78","user_header":"https://static001.geekbang.org/account/avatar/00/0f/47/3e/2abe6d1b.jpg","comment_is_top":false,"comment_ctime":1544855972,"is_pvip":false,"discussion_count":1,"race_medal":0,"score":"1544855972","product_id":100020201,"comment_content":"非常喜欢李老师的书和课，由浅入深.强烈建议大家看看大型网站技术架构一书","like_count":0,"discussions":[{"author":{"id":1102245,"avatar":"https://static001.geekbang.org/account/avatar/00/10/d1/a5/2bbedc3b.jpg","nickname":"over","note":"","ucode":"FE272AC19842D3","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":395275,"discussion_content":"已买","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1632276714,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":49782,"user_name":"小卡向前冲","can_delete":false,"product_type":"c1","uid":1124914,"ip_address":"","ucode":"1C8908A61FA00B","user_header":"https://static001.geekbang.org/account/avatar/00/11/2a/32/6354a589.jpg","comment_is_top":false,"comment_ctime":1544768488,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1544768488","product_id":100020201,"comment_content":"思考题实际上已经在文中提及：“不过，需要注意的是，由于传统机械磁盘的访问延迟主要来自于寻址时间，数据真正进行读写的时间可能只占据整个数据访问时间的一小部分，所以数据分片后对 N 块磁盘进行并发读写操作并不能将访问速度提高 N 倍。”<br>连续写入时，硬盘的底层操作是 寻址-写入1-写入2-……-写入n<br>随机写入时，硬盘的底层操作是 寻址1-写入1-寻址2-写入2-……-寻址n-写入n","like_count":0},{"had_liked":false,"id":45601,"user_name":"clairec","can_delete":false,"product_type":"c1","uid":1281520,"ip_address":"","ucode":"4B1C80C5CC61C7","user_header":"https://static001.geekbang.org/account/avatar/00/13/8d/f0/38fbd52d.jpg","comment_is_top":false,"comment_ctime":1543718838,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1543718838","product_id":100020201,"comment_content":"智慧老师的学生都好优秀","like_count":0},{"had_liked":false,"id":45496,"user_name":"小老鼠","can_delete":false,"product_type":"c1","uid":1257460,"ip_address":"","ucode":"C663A0C863A515","user_header":"https://static001.geekbang.org/account/avatar/00/13/2f/f4/2dede51a.jpg","comment_is_top":false,"comment_ctime":1543655290,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1543655290","product_id":100020201,"comment_content":"现在的固态硬盘还有扇区与磁道概念吗？","like_count":0},{"had_liked":false,"id":44212,"user_name":"Adia","can_delete":false,"product_type":"c1","uid":1179253,"ip_address":"","ucode":"85FF0554437C09","user_header":"https://static001.geekbang.org/account/avatar/00/11/fe/75/6962b70b.jpg","comment_is_top":false,"comment_ctime":1543385672,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1543385672","product_id":100020201,"comment_content":"主要是寻址的时间","like_count":0},{"had_liked":false,"id":43556,"user_name":"杰之7","can_delete":false,"product_type":"c1","uid":1297232,"ip_address":"","ucode":"F7DA2E21085332","user_header":"https://static001.geekbang.org/account/avatar/00/13/cb/50/66d0bd7f.jpg","comment_is_top":false,"comment_ctime":1543239875,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1543239875","product_id":100020201,"comment_content":"连续写入操作比随机写入操作快很多是因为随机写入需要进行在次寻找，这需要消耗大量的时间。在阅读这一讲的过程中，学习RAID不断的改进来提高计算机存储和读写的性能，但海量的数据总有单台服务器无法存储的，于是在RAID技术的基础上有了分布式技术HDFS，就这样，大数据技术时代开始了，被大量的技术公司采用，让今天我们每一个人都受益其中。","like_count":0},{"had_liked":false,"id":41415,"user_name":"🙊","can_delete":false,"product_type":"c1","uid":1283699,"ip_address":"","ucode":"CBE69B6D4FE330","user_header":"https://static001.geekbang.org/account/avatar/00/13/96/73/40d83121.jpg","comment_is_top":false,"comment_ctime":1542776945,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1542776945","product_id":100020201,"comment_content":"期待更深入的技术介绍呀，或者研究方向指导<br>","like_count":0},{"had_liked":false,"id":40935,"user_name":"Miranda-胡古月","can_delete":false,"product_type":"c1","uid":1306534,"ip_address":"","ucode":"3ACD8A1F179658","user_header":"https://static001.geekbang.org/account/avatar/00/13/ef/a6/a73b86fc.jpg","comment_is_top":false,"comment_ctime":1542697942,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1542697942","product_id":100020201,"comment_content":"多谢分享！搞明白了各种RAID和scaling up和scaling out的来源！","like_count":0},{"had_liked":false,"id":39584,"user_name":"士冰突击","can_delete":false,"product_type":"c1","uid":1012777,"ip_address":"","ucode":"8EBAAE0130B27C","user_header":"https://static001.geekbang.org/account/avatar/00/0f/74/29/73d97f93.jpg","comment_is_top":false,"comment_ctime":1542326799,"is_pvip":false,"replies":[{"id":"14175","content":"是的","user_name":"作者回复","user_name_real":"李智慧","uid":"1007349","ctime":1542332091,"ip_address":"","comment_id":39584,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1542326799","product_id":100020201,"comment_content":"传统机械磁盘读写时主要浪费时间的是寻址。连续的写入可以大大提升寻址，而随机写入在寻址上会耗费很多时间，故而连续的写入比随机写入时速率更高。","like_count":0,"discussions":[{"author":{"id":1007349,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/5e/f5/018907ac.jpg","nickname":"李智慧","note":"","ucode":"8C9980C438AFD1","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":429127,"discussion_content":"是的","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1542332091,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":39261,"user_name":"班戟鱼","can_delete":false,"product_type":"c1","uid":1173050,"ip_address":"","ucode":"CF6D8D96B801FE","user_header":"https://static001.geekbang.org/account/avatar/00/11/e6/3a/991c0e7a.jpg","comment_is_top":false,"comment_ctime":1542241136,"is_pvip":true,"replies":[{"id":"14150","content":"不用，请看下期","user_name":"作者回复","user_name_real":"李智慧","uid":"1007349","ctime":1542295243,"ip_address":"","comment_id":39261,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1542241136","product_id":100020201,"comment_content":"raid这个数据恢复机制让我想到里所码，hdfs里面有用到里所码策略吗？","like_count":0,"discussions":[{"author":{"id":1007349,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/5e/f5/018907ac.jpg","nickname":"李智慧","note":"","ucode":"8C9980C438AFD1","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":428985,"discussion_content":"不用，请看下期","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1542295243,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":39260,"user_name":"李永康Leo","can_delete":false,"product_type":"c1","uid":1035988,"ip_address":"","ucode":"464974917B0A72","user_header":"https://static001.geekbang.org/account/avatar/00/0f/ce/d4/99c857e8.jpg","comment_is_top":false,"comment_ctime":1542241057,"is_pvip":false,"replies":[{"id":"14151","content":"数据库还在用","user_name":"作者回复","user_name_real":"李智慧","uid":"1007349","ctime":1542295282,"ip_address":"","comment_id":39260,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1542241057","product_id":100020201,"comment_content":"以后raid的方案是不是要逐渐的被淘汰掉了？","like_count":0,"discussions":[{"author":{"id":1007349,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/5e/f5/018907ac.jpg","nickname":"李智慧","note":"","ucode":"8C9980C438AFD1","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":428984,"discussion_content":"数据库还在用","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1542295282,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":39138,"user_name":"ming","can_delete":false,"product_type":"c1","uid":1054341,"ip_address":"","ucode":"63135A86598E64","user_header":"https://static001.geekbang.org/account/avatar/00/10/16/85/e4d53282.jpg","comment_is_top":false,"comment_ctime":1542196786,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1542196786","product_id":100020201,"comment_content":"为什么写入也需要寻址？磁盘哪个空间是空就写到那里不行吗？","like_count":0},{"had_liked":false,"id":38070,"user_name":"贝特","can_delete":false,"product_type":"c1","uid":1276977,"ip_address":"","ucode":"C98E09E7120032","user_header":"https://static001.geekbang.org/account/avatar/00/13/7c/31/3486d7a5.jpg","comment_is_top":false,"comment_ctime":1541919970,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1541919970","product_id":100020201,"comment_content":"差距在于寻址，数据库的一次load其实是将数据先放在内存里面，等到了一定的限度后再一次性写，这样是写到一个连续的物理地址中只寻址一次。<br><br>随机写日志就需要不停地寻址。解决这个问题其实也可以用数据库的思路，先缓存在内存里面，再一次性写入。","like_count":0},{"had_liked":false,"id":37944,"user_name":"Ahikaka","can_delete":false,"product_type":"c1","uid":1045146,"ip_address":"","ucode":"B3A678567E40A9","user_header":"https://thirdwx.qlogo.cn/mmopen/vi_32/vhOPEib27xAuTycN0eQekLzsCe9zwcTTcrOb98cIfpgibgcweZBDN38tIicABibuZBwah9jnGVr02H2Zjuue1fLfEQ/132","comment_is_top":false,"comment_ctime":1541819902,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1541819902","product_id":100020201,"comment_content":"分布式的优点：并行传输，方便地扩展服务器数量来提升容量。能够实现这样的功能是因为将单个文件拆分为很多晓的数据块，分布存储在不同的服务器上。","like_count":0},{"had_liked":false,"id":37707,"user_name":"落叶飞逝的恋","can_delete":false,"product_type":"c1","uid":1046429,"ip_address":"","ucode":"F9A95DB28BCF1E","user_header":"https://static001.geekbang.org/account/avatar/00/0f/f7/9d/be04b331.jpg","comment_is_top":false,"comment_ctime":1541688270,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1541688270","product_id":100020201,"comment_content":"回答思考题:<br>连续写入速度大于随机写入的速度，其原理就跟数组结构根据索引随机访问时间复杂度始终为O(1)一样。根据公式计算得出的。例如address=baseaddress+i*data_type_size一样。磁盘的寻址公式跟其类似。","like_count":0},{"had_liked":false,"id":37634,"user_name":"小老鼠","can_delete":false,"product_type":"c1","uid":1257460,"ip_address":"","ucode":"C663A0C863A515","user_header":"https://static001.geekbang.org/account/avatar/00/13/2f/f4/2dede51a.jpg","comment_is_top":false,"comment_ctime":1541661488,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1541661488","product_id":100020201,"comment_content":"1、中型机、大型机未来还有市场吗？<br>2、RAID会不会出现备份不充分引起的数据不一直性。","like_count":0},{"had_liked":false,"id":37616,"user_name":"NaNa","can_delete":false,"product_type":"c1","uid":1057785,"ip_address":"","ucode":"DEB5EB41A42248","user_header":"https://static001.geekbang.org/account/avatar/00/10/23/f9/2eaf6d45.jpg","comment_is_top":false,"comment_ctime":1541652751,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1541652751","product_id":100020201,"comment_content":"产运同学表示还处于科普阶段，无法进行思考","like_count":0},{"had_liked":false,"id":37614,"user_name":"足迹","can_delete":false,"product_type":"c1","uid":1105779,"ip_address":"","ucode":"38134D1A6B8DC2","user_header":"https://static001.geekbang.org/account/avatar/00/10/df/73/4a4ce2b5.jpg","comment_is_top":false,"comment_ctime":1541652616,"is_pvip":false,"replies":[{"id":"13536","content":"你是说区块链吗？😂","user_name":"作者回复","user_name_real":"李智慧","uid":"1007349","ctime":1541678146,"ip_address":"","comment_id":37614,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1541652616","product_id":100020201,"comment_content":"从今天的文章所想，思维不要被惯性束缚，在水平扩充出现前大家的思维都往纵向思考，不料水平扩充横空出现。而如今我们处在水平扩充的时候是不是也可以问问还有没有其他可能的方式？","like_count":0,"discussions":[{"author":{"id":1007349,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/5e/f5/018907ac.jpg","nickname":"李智慧","note":"","ucode":"8C9980C438AFD1","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":428425,"discussion_content":"你是说区块链吗？😂","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1541678146,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":37575,"user_name":"kmax","can_delete":false,"product_type":"c1","uid":1074928,"ip_address":"","ucode":"C737BA2D30F4BA","user_header":"https://static001.geekbang.org/account/avatar/00/10/66/f0/830d3c1f.jpg","comment_is_top":false,"comment_ctime":1541643128,"is_pvip":false,"replies":[{"id":"13539","content":"是的","user_name":"作者回复","user_name_real":"李智慧","uid":"1007349","ctime":1541678386,"ip_address":"","comment_id":37575,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1541643128","product_id":100020201,"comment_content":"连续读写节省了寻址时间~","like_count":0,"discussions":[{"author":{"id":1007349,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/5e/f5/018907ac.jpg","nickname":"李智慧","note":"","ucode":"8C9980C438AFD1","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":428405,"discussion_content":"是的","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1541678386,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":37567,"user_name":"iron_man","can_delete":false,"product_type":"c1","uid":1099883,"ip_address":"","ucode":"C0053A59442910","user_header":"https://static001.geekbang.org/account/avatar/00/10/c8/6b/0f3876ef.jpg","comment_is_top":false,"comment_ctime":1541642055,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1541642055","product_id":100020201,"comment_content":"如果数据被分片到n个磁盘，假设每个磁盘读一块数据的时间一样，即寻址时间和读盘时间一样，为t。那么t时间内，应该可以读取n块数据，感觉读取速度也差不多有n倍提升；写入类似","like_count":0},{"had_liked":false,"id":37560,"user_name":"李二木","can_delete":false,"product_type":"c1","uid":1103091,"ip_address":"","ucode":"30E03BB84ADB27","user_header":"https://static001.geekbang.org/account/avatar/00/10/d4/f3/129d6dfe.jpg","comment_is_top":false,"comment_ctime":1541640645,"is_pvip":true,"replies":[{"id":"13542","content":"是的","user_name":"作者回复","user_name_real":"李智慧","uid":"1007349","ctime":1541678583,"ip_address":"","comment_id":37560,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1541640645","product_id":100020201,"comment_content":"主要是寻址方式不一样。","like_count":0,"discussions":[{"author":{"id":1007349,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/5e/f5/018907ac.jpg","nickname":"李智慧","note":"","ucode":"8C9980C438AFD1","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":428400,"discussion_content":"是的","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1541678583,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":37552,"user_name":"云辉","can_delete":false,"product_type":"c1","uid":1103058,"ip_address":"","ucode":"0E67E8E8421294","user_header":"https://static001.geekbang.org/account/avatar/00/10/d4/d2/96dbfa5a.jpg","comment_is_top":false,"comment_ctime":1541639562,"is_pvip":false,"replies":[{"id":"13544","content":"是的","user_name":"作者回复","user_name_real":"李智慧","uid":"1007349","ctime":1541678599,"ip_address":"","comment_id":37552,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1541639562","product_id":100020201,"comment_content":"磁盘连续读写，少了寻址时间，比如kafka，数据库查询是随机读者。<br>","like_count":0,"discussions":[{"author":{"id":1007349,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/5e/f5/018907ac.jpg","nickname":"李智慧","note":"","ucode":"8C9980C438AFD1","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":428396,"discussion_content":"是的","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1541678599,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":37551,"user_name":"hua168","can_delete":false,"product_type":"c1","uid":1065255,"ip_address":"","ucode":"CFF9A7E86EBA48","user_header":"https://static001.geekbang.org/account/avatar/00/10/41/27/3ff1a1d6.jpg","comment_is_top":false,"comment_ctime":1541639542,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1541639542","product_id":100020201,"comment_content":"生产环境中，很少见到hadoop当存储用吧？看视频，有讲师说hadoop存放的是计算数据（如openstack），这样丢失也没事，普通存储还是用GFS、MFS、ceph，阿里自研的oss等……生产环境中能用hadoop直接当分布式文件系统用吗？电商方面，我看到用TFS多","like_count":0},{"had_liked":false,"id":37536,"user_name":"乘坐Tornado的线程魔法师","can_delete":false,"product_type":"c1","uid":1132661,"ip_address":"","ucode":"C4C9915866E769","user_header":"https://static001.geekbang.org/account/avatar/00/11/48/75/02b4366a.jpg","comment_is_top":false,"comment_ctime":1541638096,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1541638096","product_id":100020201,"comment_content":"是因为日志在生成的时候已经在缓存中保存了一份吗","like_count":0},{"had_liked":false,"id":37531,"user_name":"Geek_f76818","can_delete":false,"product_type":"c1","uid":1128168,"ip_address":"","ucode":"B7B5A19318C826","user_header":"https://static001.geekbang.org/account/avatar/00/11/36/e8/bbec9aca.jpg","comment_is_top":false,"comment_ctime":1541637756,"is_pvip":false,"replies":[{"id":"13550","content":"是的","user_name":"作者回复","user_name_real":"李智慧","uid":"1007349","ctime":1541678750,"ip_address":"","comment_id":37531,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1541637756","product_id":100020201,"comment_content":"连续读写减少了寻址时间，效率更高","like_count":0,"discussions":[{"author":{"id":1007349,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/5e/f5/018907ac.jpg","nickname":"李智慧","note":"","ucode":"8C9980C438AFD1","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":428386,"discussion_content":"是的","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1541678750,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":37525,"user_name":"Mac Kwan","can_delete":false,"product_type":"c1","uid":1001958,"ip_address":"","ucode":"FC80EBC9CD37A8","user_header":"https://static001.geekbang.org/account/avatar/00/0f/49/e6/4f00fe55.jpg","comment_is_top":false,"comment_ctime":1541636483,"is_pvip":false,"replies":[{"id":"13551","content":"没错","user_name":"作者回复","user_name_real":"李智慧","uid":"1007349","ctime":1541678776,"ip_address":"","comment_id":37525,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1541636483","product_id":100020201,"comment_content":"由于传统机械磁盘的访问延迟主要来自于寻址时间，所以连续写入的数据能更好地压缩寻址时间，提升读写速度。因为我们以前会经常做磁盘碎片整理 😝","like_count":0,"discussions":[{"author":{"id":1007349,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/5e/f5/018907ac.jpg","nickname":"李智慧","note":"","ucode":"8C9980C438AFD1","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":428382,"discussion_content":"没错","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1541678776,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":37524,"user_name":"Jowin","can_delete":false,"product_type":"c1","uid":1114356,"ip_address":"","ucode":"19017F7D06C22A","user_header":"https://static001.geekbang.org/account/avatar/00/11/00/f4/cc5f0896.jpg","comment_is_top":false,"comment_ctime":1541636474,"is_pvip":false,"replies":[{"id":"13552","content":"是的","user_name":"作者回复","user_name_real":"李智慧","uid":"1007349","ctime":1541678788,"ip_address":"","comment_id":37524,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1541636474","product_id":100020201,"comment_content":"1.减少硬盘寻道定位时间，大多数时间都在写数据。<br>2.容易缓存整块整块的数据，减少硬盘写入次数。","like_count":0,"discussions":[{"author":{"id":1007349,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/5e/f5/018907ac.jpg","nickname":"李智慧","note":"","ucode":"8C9980C438AFD1","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":428381,"discussion_content":"是的","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1541678788,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":37521,"user_name":"summer ₂ ₀ ₁ ₈","can_delete":false,"product_type":"c1","uid":1281478,"ip_address":"","ucode":"E8E582007494E7","user_header":"https://static001.geekbang.org/account/avatar/00/13/8d/c6/1ac9edae.jpg","comment_is_top":false,"comment_ctime":1541635804,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1541635804","product_id":100020201,"comment_content":"应该和老师提到的寻址有关，数据库更新连续的数条记录，找到这个数据文件的扇区位置，一次寻址多次写入。不知道理解对不对，望老师指点","like_count":0},{"had_liked":false,"id":37514,"user_name":"高榕","can_delete":false,"product_type":"c1","uid":1113451,"ip_address":"","ucode":"9CAEB3203B8B6D","user_header":"https://static001.geekbang.org/account/avatar/00/10/fd/6b/1f3bf70e.jpg","comment_is_top":false,"comment_ctime":1541633366,"is_pvip":true,"discussion_count":0,"race_medal":0,"score":"1541633366","product_id":100020201,"comment_content":"HDFS 水平伸缩的文件读写速度比起垂直伸缩的速度理论上会慢很多，如何保证速度？","like_count":0}]}