{"id":420078,"title":"05 | è°ƒåº¦ç³»ç»Ÿï¼šå¦‚ä½•æŠŠæ¡åˆ†å¸ƒå¼è®¡ç®—çš„ç²¾é«“ï¼Ÿ","content":"<p>ä½ å¥½ï¼Œæˆ‘æ˜¯å´ç£Šã€‚</p><p>åœ¨ä¸Šä¸€è®²ï¼Œæˆ‘ä»¬é€šè¿‡â€œåŒ…å·¥å¤´ä¸æ–½å·¥å·¥äººâ€çš„ä¾‹å­ï¼Œåˆæ­¥è®¤è¯†äº†Sparkè¿›ç¨‹æ¨¡å‹ä¸­çš„Driverå’ŒExecutorsã€ä»¥åŠå®ƒä»¬ä¹‹é—´çš„äº¤äº’å…³ç³»ã€‚Driverè´Ÿè´£è§£æç”¨æˆ·ä»£ç ã€æ„å»ºè®¡ç®—æµå›¾ï¼Œç„¶åå°†è®¡ç®—æµå›¾è½¬åŒ–ä¸ºåˆ†å¸ƒå¼ä»»åŠ¡ï¼Œå¹¶æŠŠä»»åŠ¡åˆ†å‘ç»™é›†ç¾¤ä¸­çš„Executorsäº¤ä»˜è¿è¡Œã€‚</p><p>ä¸è¿‡ï¼Œä½ å¯èƒ½ä¼šå¥½å¥‡ï¼šâ€œå¯¹äºç»™å®šçš„ç”¨æˆ·ä»£ç å’Œç›¸åº”çš„è®¡ç®—æµå›¾ï¼ŒDriveræ˜¯æ€ä¹ˆæŠŠè®¡ç®—å›¾æ‹†è§£ä¸ºåˆ†å¸ƒå¼ä»»åŠ¡ï¼Œåˆæ˜¯æŒ‰ç…§ä»€ä¹ˆè§„åˆ™åˆ†å‘ç»™Executorsçš„å‘¢ï¼Ÿè¿˜æœ‰ï¼ŒExecutorså…·ä½“åˆæ˜¯å¦‚ä½•æ‰§è¡Œåˆ†å¸ƒå¼ä»»åŠ¡çš„å‘¢ï¼Ÿâ€</p><p>æˆ‘ä»¬ä¹‹å‰ä¸€å†å¼ºè°ƒï¼Œ<strong>åˆ†å¸ƒå¼è®¡ç®—çš„ç²¾é«“ï¼Œåœ¨äºå¦‚ä½•æŠŠæŠ½è±¡çš„è®¡ç®—å›¾ï¼Œè½¬åŒ–ä¸ºå®å®åœ¨åœ¨çš„åˆ†å¸ƒå¼è®¡ç®—ä»»åŠ¡ï¼Œç„¶åä»¥å¹¶è¡Œè®¡ç®—çš„æ–¹å¼äº¤ä»˜æ‰§è¡Œ</strong>ã€‚æ·±å…¥ç†è§£åˆ†å¸ƒå¼è®¡ç®—ï¼Œæ˜¯æˆ‘ä»¬åšå¥½å¤§æ•°æ®å¼€å‘çš„å…³é”®å’Œå‰æï¼Œå®ƒèƒ½æœ‰æ•ˆé¿å…æˆ‘ä»¬æ‰å…¥â€œå•æœºæ€ç»´â€çš„é™·é˜±ï¼ŒåŒæ—¶ä¹Ÿèƒ½ä¸ºæ€§èƒ½å¯¼å‘çš„å¼€å‘å¥ å®šåšå®åŸºç¡€ã€‚</p><p>è€Œä¸Šé¢çš„è¿™ä¸€ç³»åˆ—é—®é¢˜ï¼Œæ°æ°æ˜¯æˆ‘ä»¬åƒé€åˆ†å¸ƒå¼è®¡ç®—çš„å…³é”®æ‰€åœ¨ã€‚å› æ­¤ï¼Œä»Šå¤©è¿™ä¸€è®²ï¼Œæˆ‘ä»¬å°±é¡ºç€è¿™äº›é—®é¢˜ï¼Œä¸€èµ·å»æ·±å…¥æ¢ç©¶Sparkè°ƒåº¦ç³»ç»Ÿï¼Œè¿›è€Œå¼„æ¸…æ¥šåˆ†å¸ƒå¼è®¡ç®—çš„æ¥é¾™å»è„‰ã€‚</p><h2>è§’è‰²åˆ’åˆ†ä¸æ–¯å·´å…‹å»ºç­‘é›†å›¢</h2><p>åœ¨ä¸Šä¸€è®²ï¼Œæˆ‘ä»¬é€šè¿‡â€œåŒ…å·¥å¤´ä¸æ–½å·¥å·¥äººâ€çš„ç±»æ¯”ã€ä»¥åŠWord Countçš„ç¤ºä¾‹ï¼Œå…¶å®å·²ç»å¤§è‡´å˜æ¸…äº†Sparkåˆ†å¸ƒå¼ä»»åŠ¡è°ƒåº¦çš„æ ¸å¿ƒç¯èŠ‚ä¸å…³é”®æ­¥éª¤ã€‚ä»Šå¤©è¿™ä¸€è®²çš„æ ¸å¿ƒä»»åŠ¡ï¼Œå°±æ˜¯å¸¦ä½ å»æ·±å…¥å…¶ä¸­çš„æ¯ä¸€ä¸ªç¯èŠ‚ï¼Œåšåˆ°â€œæ—¢è§æ£®æ—ã€ä¹Ÿè§æ ‘æœ¨â€ã€‚è¿™é‡Œå’±ä»¬ä¸å¦¨å…ˆæŠŠè¿™äº›ç¯èŠ‚å’Œæ¶‰åŠçš„ç»„ä»¶æ¢³ç†å‡ºæ¥ï¼Œä»è€Œè®©ä½ åœ¨æ•´ä½“ä¸Šæœ‰ä¸€ä¸ªæ¸…æ™°çš„æŠŠæ¡ã€‚</p><!-- [[[read_end]]] --><p><img src=\"https://static001.geekbang.org/resource/image/e7/1e/e743cf687bb02bfec8c6ffebbe7d4a1e.jpg?wh=1452x806\" alt=\"å›¾ç‰‡\" title=\"Sparkè°ƒåº¦ç³»ç»Ÿå…³é”®æ­¥éª¤ä¸æ ¸å¿ƒç»„ä»¶\"></p><p>ä¸éš¾å‘ç°ï¼Œè¡¨ä¸­çš„æ­¥éª¤ä¸ç»„ä»¶ä¼—å¤šï¼Œè¦æ˜¯ç…§æœ¬å®£ç§‘åœ°å»è®²è°ƒåº¦ç³»ç»Ÿï¼Œå…ˆåˆ«è¯´ä½ å¯èƒ½çœ‹ç€çœ‹ç€å°±å¼€å§‹çŠ¯å›°äº†ï¼Œå°±è¿æˆ‘è‡ªå·±ï¼Œä¹Ÿå¯èƒ½å†™ç€å†™ç€å°±ç¡ç€äº†ã€‚å› æ­¤ï¼Œå’±ä»¬ä¸å¦¨æŠŠè¿™äº›ç¯èŠ‚ä¸ç»„ä»¶èå…¥åˆ°ä¸€ä¸ªæ•…äº‹ä¸­å»ï¼Œè®©ä½ åƒè¯»å°è¯´ä¸€æ ·ï¼Œåœ¨æ§è…¹ä¹‹ä½™å¼„æ‡‚Sparkè°ƒåº¦ç³»ç»Ÿã€‚</p><p>è¯è¯´å¾ˆä¹…ä»¥å‰ï¼Œç¾å›½æœ‰ä¸€å®¶åæ‰¬æµ·å†…å¤–çš„å»ºç­‘é›†å›¢ï¼Œåä¸ºâ€œæ–¯å·´å…‹ï¼ˆSparkï¼‰â€ã€‚è¿™å®¶å»ºç­‘é›†å›¢è§„æ¨¡åºå¤§ï¼Œè®¾æœ‰ä¸€ä¸ªæ€»å…¬å¸ï¼ˆDriverï¼‰ï¼Œå’Œå¤šä¸ªåˆ†å…¬å¸ï¼ˆExecutorsï¼‰ã€‚æ–¯å·´å…‹å…¬å¸çš„ä¸»è¦æœåŠ¡å¯¹è±¡æ˜¯å»ºç­‘è®¾è®¡å¸ˆï¼ˆå¼€å‘è€…ï¼‰ï¼Œå»ºç­‘è®¾è®¡å¸ˆè´Ÿè´£æä¾›è®¾è®¡å›¾çº¸ï¼ˆç”¨æˆ·ä»£ç ã€è®¡ç®—å›¾ï¼‰ï¼Œè€Œæ–¯å·´å…‹å…¬å¸çš„ä¸»è¥ä¸šåŠ¡æ˜¯å°†å›¾çº¸è½åœ°ã€å»ºé€ èµ·ä¸€æ ‹æ ‹é«˜æ¥¼å¤§å¦ã€‚</p><p>è¦å®Œæˆä¸»è¥ä¸šåŠ¡ï¼Œé›†å›¢å…¬å¸éœ€è¦æ‹›è˜èƒ½å¤Ÿçœ‹æ‡‚å›¾çº¸ã€å¹¶å°†å…¶è½¬åŒ–ä¸ºå»ºç­‘é¡¹ç›®çš„æ¶æ„å¸ˆï¼Œå› æ­¤æ–¯å·´å…‹å…¬å¸æŒ–è§’äº†è¡Œä¸šçŸ¥åæ¶æ„å¸ˆâ€œæˆ´æ ¼â€ï¼ˆDAGSchedulerï¼‰ã€‚é›†å›¢å…¬å¸ç»™æˆ´æ ¼å®‰æ’çš„èŒä½æ˜¯æ€»å…¬å¸çš„ä¸€æŠŠæ‰‹ï¼ŒåŒæ—¶è¦æ±‚ä¸¤ä½åˆ›å§‹å…ƒè€â€œå¡”æ–¯å…‹â€å’Œâ€œæ‹œè‚¯å¾·â€å…¨åŠ›é…åˆæˆ´æ ¼çš„å·¥ä½œã€‚</p><p>å¬åˆ°è¿™é‡Œï¼Œä½ è‚¯å®šä¼šé—®â€œå¡”æ–¯å…‹â€å’Œâ€œæ‹œè‚¯å¾·â€æ˜¯è°å‘¢ï¼Ÿ</p><p>å¡”æ–¯å…‹ï¼ˆTaskSchedulerï¼‰ä¸€æ¯•ä¸šå°±åŠ å…¥äº†æ–¯å·´å…‹å…¬å¸ï¼Œç°ä»»æ€»å…¬å¸æ–½å·¥ç»ç†ï¼ŒæˆåŠŸæŒ‡æŒ¥å®Œæˆäº†å¤šä¸ªå¤§å¤§å°å°çš„å·¥ç¨‹é¡¹ç›®ï¼Œä¸šç»©éå¸¸çªå‡ºï¼Œæ·±å¾—å…¬å¸èµè¯†ã€‚æ‹œè‚¯å¾·ï¼ˆSchedulerBackendï¼‰å’Œå¡”æ–¯å…‹åœ¨ä¸Šå¤§å­¦çš„æ—¶å€™å°±æ˜¯ä¸Šä¸‹é“ºï¼Œå…³ç³»å¥½å¾—ç©¿ä¸€æ¡è£¤å­ï¼Œç°ä»»æ€»å…¬å¸äººåŠ›èµ„æºæ€»ç›‘ï¼Œè´Ÿè´£ä¸åˆ†å…¬å¸åè°ƒã€å®‰æ’äººåŠ›èµ„æºã€‚ä»å…¬å¸çš„å®‰æ’æ¥çœ‹ï¼Œä¸‰ä½ä¸»ç®¡çš„åˆ†å·¥è¿˜æ˜¯æ¯”è¾ƒæ˜ç¡®çš„ã€‚</p><p><img src=\"https://static001.geekbang.org/resource/image/43/7a/43cff78db9dfc211bb7b15b1c0ea6e7a.jpg?wh=1587x572\" alt=\"å›¾ç‰‡\" title=\"å¡”æ–¯å…‹å…¬å¸å…³é”®äººç‰©ä¸æ ¸å¿ƒèŒè´£\"></p><p>ä¹‹æ‰€ä»¥è¯´å¡”æ–¯å…‹ï¼ˆTaskSchedulerï¼‰å’Œæ‹œè‚¯å¾·ï¼ˆSchedulerBackendï¼‰æ˜¯å…¬å¸å…ƒè€ï¼ŒåŸå› åœ¨äºï¼Œåœ¨SparkContext / SparkSessionçš„åˆå§‹åŒ–ä¸­ï¼ŒTaskSchedulerå’ŒSchedulerBackendæ˜¯æœ€æ—©ã€ä¸”åŒæ—¶è¢«åˆ›å»ºçš„è°ƒåº¦ç³»ç»Ÿç»„ä»¶ã€‚è¿™äºŒè€…çš„å…³ç³»éå¸¸å¾®å¦™ï¼šSchedulerBackendåœ¨æ„é€ æ–¹æ³•ä¸­å¼•ç”¨TaskSchedulerï¼Œè€ŒTaskScheduleråœ¨åˆå§‹åŒ–æ—¶ä¼šå¼•ç”¨SchedulerBackendã€‚</p><p>å€¼å¾—ä¸€æçš„æ˜¯ï¼ŒSchedulerBackendç»„ä»¶çš„å®ä¾‹åŒ–ï¼Œå–å†³äºå¼€å‘è€…æŒ‡å®šçš„Spark MasterURLï¼Œä¹Ÿå°±æ˜¯æˆ‘ä»¬ä½¿ç”¨spark-shellï¼ˆæˆ–æ˜¯spark-submitï¼‰æ—¶æŒ‡å®šçš„â€“master å‚æ•°ï¼Œå¦‚â€œâ€“master spark://ip:hostâ€å°±ä»£è¡¨Standalone éƒ¨ç½²æ¨¡å¼ï¼Œâ€œâ€“master yarnâ€å°±ä»£è¡¨YARN æ¨¡å¼ç­‰ç­‰ã€‚</p><p>ä¸éš¾å‘ç°ï¼ŒSchedulerBackend ä¸èµ„æºç®¡ç†å™¨ï¼ˆStandaloneã€YARNã€Mesosç­‰ï¼‰å¼ºç»‘å®šï¼Œæ˜¯èµ„æºç®¡ç†å™¨åœ¨ Spark ä¸­çš„ä»£ç†ã€‚å…¶å®ç¡¬ä»¶èµ„æºä¸äººåŠ›èµ„æºä¸€æ ·ï¼Œéƒ½æ˜¯â€œå¹²æ´»å„¿çš„â€ã€‚æ‰€ä»¥ï¼Œå¦‚æœæˆ‘ä»¬ç”¨é›†å›¢å…¬å¸çš„äººåŠ›èµ„æºæ¥ç±»æ¯”Sparké›†ç¾¤çš„ç¡¬ä»¶èµ„æºï¼Œé‚£ä¹ˆâ€œæ‹œè‚¯å¾·â€å°±æ˜¯åå‰¯å…¶å®çš„äººåŠ›èµ„æºæ€»ç›‘ã€‚</p><p>ä»å…¨å±€è§†è§’æ¥çœ‹ï¼ŒDAGScheduleræ˜¯ä»»åŠ¡è°ƒåº¦çš„å‘èµ·è€…ï¼ŒDAGSchedulerä»¥TaskSetä¸ºç²’åº¦ï¼Œå‘TaskScheduleræäº¤ä»»åŠ¡è°ƒåº¦è¯·æ±‚ã€‚TaskScheduleråœ¨åˆå§‹åŒ–çš„è¿‡ç¨‹ä¸­ï¼Œä¼šåˆ›å»ºä»»åŠ¡è°ƒåº¦é˜Ÿåˆ—ï¼Œä»»åŠ¡è°ƒåº¦é˜Ÿåˆ—ç”¨äºç¼“å­˜ DAGScheduleræäº¤çš„TaskSetsã€‚TaskSchedulerç»“åˆSchedulerBackendæä¾›çš„ WorkerOfferï¼ŒæŒ‰ç…§é¢„å…ˆè®¾ç½®çš„è°ƒåº¦ç­–ç•¥ä¾æ¬¡å¯¹é˜Ÿåˆ—ä¸­çš„ä»»åŠ¡è¿›è¡Œè°ƒåº¦ã€‚</p><p><img src=\"https://static001.geekbang.org/resource/image/49/2f/4978695a7560ab08f3e5fd08b4ee612f.jpg?wh=1920x792\" alt=\"å›¾ç‰‡\" title=\"Sparkè°ƒåº¦ç³»ç»Ÿå…¨å±€è§†è§’\"></p><p>ç®€è€Œè¨€ä¹‹ï¼ŒDAGScheduleræ‰‹é‡Œæœ‰â€œæ´»å„¿â€ï¼ŒSchedulerBackendæ‰‹é‡Œæœ‰â€œäººåŠ›â€ï¼ŒTaskSchedulerçš„æ ¸å¿ƒèŒèƒ½ï¼Œå°±æ˜¯æŠŠåˆé€‚çš„â€œæ´»å„¿â€æ´¾å‘åˆ°åˆé€‚çš„â€œäººâ€çš„æ‰‹é‡Œã€‚ç”±æ­¤å¯è§ï¼ŒTaskScheduleræ‰¿æ‹…çš„æ˜¯æ‰¿ä¸Šå¯ä¸‹ã€ä¸Šé€šä¸‹è¾¾çš„å…³é”®è§’è‰²ï¼Œè¿™ä¹Ÿæ­£æ˜¯æˆ‘ä»¬å°†â€œå¡”æ–¯å…‹â€è§†ä¸ºæ–¯å·´å…‹å»ºç­‘å…¬å¸å…ƒè€ä¹‹ä¸€çš„é‡è¦åŸå› ã€‚</p><p>é‚£ä¹ˆï¼Œäº†è§£äº†è¿™ä¸‰ä¸ªä¸»ç®¡çš„è§’è‰²èŒè´£ï¼Œæˆ‘ä»¬æ¥ä¸‹æ¥å°±æ¥è¯¦ç»†è¯´è¯´ï¼Œä»–ä»¬æ˜¯æ€ä¹ˆå„è‡ªå®Œæˆè‡ªå·±çš„å·¥ä½œçš„ã€‚</p><h3>æ€»æ¶æˆ´æ ¼ï¼šDAGScheduler</h3><p>å›åˆ°æˆ‘ä»¬çš„æ•…äº‹é‡Œï¼Œæˆ´æ ¼åœ¨ä¸¤ä½å…ƒè€çš„ååŠ©ä¸‹ï¼Œå·¥ä½œå¼€å±•å¾—è¿˜ç®—é¡ºåˆ©ï¼Œç„¶è€Œï¼Œå†°å±‚ä¹‹ä¸‹ï¼Œæš—æµæ¶ŒåŠ¨ï¼Œä½œä¸ºä¸€åç©ºé™çš„é¢†å¯¼ï¼Œæˆ´è€æ¿è¿˜éœ€äº²è‡ªâ€œéœ²ä¸¤æ‰‹â€ï¼Œæ‰èƒ½èµ¢å¾—å¹³çº§çš„è®¤å¯ä¸ä¿¡ä»»ã€‚</p><p>ä½œä¸ºé›†å›¢å…¬å¸çš„â€œæ€»æ¶â€ï¼ˆæ€»æ¶æ„å¸ˆï¼‰ï¼Œæˆ´æ ¼çš„æ ¸å¿ƒèŒè´£ï¼Œæ˜¯æŠŠè®¡ç®—å›¾DAGæ‹†åˆ†ä¸ºæ‰§è¡Œé˜¶æ®µStagesï¼ŒStagesæŒ‡çš„æ˜¯ä¸åŒçš„è¿è¡Œé˜¶æ®µï¼ŒåŒæ—¶è¿˜è¦è´Ÿè´£æŠŠStagesè½¬åŒ–ä¸ºä»»åŠ¡é›†åˆTaskSetsï¼Œä¹Ÿå°±æ˜¯æŠŠâ€œå»ºç­‘å›¾çº¸â€è½¬åŒ–æˆå¯æ‰§è¡Œã€å¯æ“ä½œçš„â€œå»ºç­‘é¡¹ç›®â€ã€‚</p><p>ç”¨ä¸€å¥è¯æ¥æ¦‚æ‹¬ä» DAG åˆ° Stages çš„æ‹†åˆ†è¿‡ç¨‹ï¼Œé‚£å°±æ˜¯ï¼š<strong>ä»¥ Actions ç®—å­ä¸ºèµ·ç‚¹ï¼Œä»åå‘å‰å›æº¯ DAGï¼Œä»¥ Shuffle æ“ä½œä¸ºè¾¹ç•Œå»åˆ’åˆ† Stagesã€‚</strong></p><p>åœ¨<a href=\"https://time.geekbang.org/column/article/417164\">ç¬¬2è®²</a>ä»‹ç»ç¼–ç¨‹æ¨¡å‹çš„æ—¶å€™ï¼Œæˆ‘ä»¬ä»¥Word Countä¸ºä¾‹ï¼Œæåˆ°Sparkä½œä¸šçš„è¿è¡Œåˆ†ä¸ºä¸¤ä¸ªç¯èŠ‚ï¼Œç¬¬ä¸€ä¸ªæ˜¯ä»¥æƒ°æ€§çš„æ–¹å¼æ„å»ºè®¡ç®—å›¾ï¼Œç¬¬äºŒä¸ªåˆ™æ˜¯é€šè¿‡Actionsç®—å­è§¦å‘ä½œä¸šçš„ä»å¤´è®¡ç®—ï¼š</p><p><img src=\"https://static001.geekbang.org/resource/image/6f/7b/6f82b4a35cdfb526d837d23675yy477b.jpg?wh=1920x472\" alt=\"å›¾ç‰‡\" title=\"Word Countä½œä¸šçš„ä¸¤ä¸ªç¯èŠ‚\"></p><p>å¯¹äºå›¾ä¸­çš„ç¬¬äºŒä¸ªç¯èŠ‚ï¼ŒSparkåœ¨å®é™…è¿è¡Œçš„è¿‡ç¨‹ä¸­ï¼Œä¼šæŠŠå®ƒå†ç»†åŒ–ä¸ºä¸¤ä¸ªæ­¥éª¤ã€‚<strong>ç¬¬ä¸€ä¸ªæ­¥éª¤ï¼Œå°±æ˜¯ä»¥Shuffleä¸ºè¾¹ç•Œï¼Œä»åå‘å‰ä»¥é€’å½’çš„æ–¹å¼ï¼ŒæŠŠé€»è¾‘ä¸Šçš„è®¡ç®—å›¾DAGï¼Œè½¬åŒ–æˆä¸€ä¸ªåˆä¸€ä¸ªStagesã€‚</strong></p><p><img src=\"https://static001.geekbang.org/resource/image/24/1c/249eb09407421838782f2515f09yy01c.jpg?wh=1920x534\" alt=\"å›¾ç‰‡\" title=\"\nç¬¬ä¸€æ­¥ï¼šé€’å½’åˆ›å»ºStages\"></p><p>æˆ‘ä»¬è¿˜æ˜¯ä»¥Word Countä¸ºä¾‹ï¼ŒSparkä»¥takeç®—å­ä¸ºèµ·ç‚¹ï¼Œä¾æ¬¡æŠŠDAGä¸­çš„RDDåˆ’å…¥åˆ°ç¬¬ä¸€ä¸ªStageï¼Œç›´åˆ°é‡åˆ°reduceByKeyç®—å­ã€‚ç”±äºreduceByKeyç®—å­ä¼šå¼•å…¥Shuffleï¼Œå› æ­¤ç¬¬ä¸€ä¸ªStageåˆ›å»ºå®Œæ¯•ï¼Œä¸”åªåŒ…å«wordCountsè¿™ä¸€ä¸ªRDDã€‚æ¥ä¸‹æ¥ï¼ŒSparkç»§ç»­å‘å‰å›æº¯ï¼Œç”±äºæœªæ›¾ç¢°åˆ°ä¼šå¼•å…¥Shuffleçš„ç®—å­ï¼Œå› æ­¤å®ƒæŠŠâ€œæ²¿é€”â€æ‰€æœ‰çš„RDDéƒ½åˆ’å…¥äº†ç¬¬äºŒä¸ªStageã€‚</p><p>åœ¨Stagesåˆ›å»ºå®Œæ¯•ä¹‹åï¼Œå°±åˆ°äº†è§¦å‘è®¡ç®—çš„ç¬¬äºŒä¸ªæ­¥éª¤ï¼šSpark<strong>ä»åå‘å‰ï¼Œä»¥é€’å½’çš„æ–¹å¼ï¼Œä¾æ¬¡æè¯·æ‰§è¡Œæ‰€æœ‰çš„Stages</strong>ã€‚</p><p><img src=\"https://static001.geekbang.org/resource/image/61/d3/61f394b4bc31af6847944911032119d3.jpg?wh=1920x503\" alt=\"å›¾ç‰‡\" title=\"ç¬¬äºŒæ­¥ï¼šé€’å½’æè¯·æ‰§è¡Œåˆ›å»ºå¥½çš„Stages\"></p><p>å…·ä½“æ¥è¯´ï¼Œåœ¨Word Countçš„ä¾‹å­ä¸­ï¼ŒDAGScheduleræœ€å…ˆæè¯·æ‰§è¡Œçš„æ˜¯Stage1ã€‚åœ¨æäº¤çš„æ—¶å€™ï¼ŒDAGSchedulerå‘ç°Stage1ä¾èµ–çš„çˆ¶Stageï¼Œä¹Ÿå°±æ˜¯Stage0ï¼Œè¿˜æ²¡æœ‰æ‰§è¡Œè¿‡ï¼Œé‚£ä¹ˆè¿™ä¸ªæ—¶å€™å®ƒä¼šæŠŠStage1çš„æäº¤åŠ¨ä½œå‹æ ˆï¼Œè½¬è€Œå»æè¯·æ‰§è¡ŒStage0ã€‚å½“Stage0æ‰§è¡Œå®Œæ¯•çš„æ—¶å€™ï¼ŒDAGScheduleré€šè¿‡å‡ºæ ˆçš„åŠ¨ä½œï¼Œå†æ¬¡æè¯·æ‰§è¡ŒStage 1ã€‚</p><p>å¯¹äºæè¯·æ‰§è¡Œçš„æ¯ä¸€ä¸ªStageï¼ŒDAGScheduleræ ¹æ®Stageå†…RDDçš„partitionså±æ€§åˆ›å»ºåˆ†å¸ƒå¼ä»»åŠ¡é›†åˆTaskSetã€‚TaskSetåŒ…å«ä¸€ä¸ªåˆä¸€ä¸ªåˆ†å¸ƒå¼ä»»åŠ¡Taskï¼ŒRDDæœ‰å¤šå°‘æ•°æ®åˆ†åŒºï¼ŒTaskSetå°±åŒ…å«å¤šå°‘ä¸ªTaskã€‚æ¢å¥è¯è¯´ï¼ŒTaskä¸RDDçš„åˆ†åŒºï¼Œæ˜¯ä¸€ä¸€å¯¹åº”çš„ã€‚</p><p>ä½ å¯èƒ½ä¼šé—®ï¼šâ€œTaskä»£è¡¨çš„æ˜¯åˆ†å¸ƒå¼ä»»åŠ¡ï¼Œä¸è¿‡å®ƒå…·ä½“æ˜¯ä»€ä¹ˆå‘¢ï¼Ÿâ€è¦æ›´å¥½åœ°è®¤è¯†Taskï¼Œæˆ‘ä»¬ä¸å¦¨æ¥çœ‹çœ‹å®ƒçš„å…³é”®å±æ€§ã€‚</p><p><img src=\"https://static001.geekbang.org/resource/image/f6/6b/f69d0f189b666c989679ba4d8f7c856b.jpg?wh=1605x277\" alt=\"å›¾ç‰‡\" title=\"Taskå¯¹è±¡çš„é‡è¦å±æ€§\"></p><p>åœ¨ä¸Šè¡¨ä¸­ï¼ŒstageIdã€stageAttemptIdæ ‡è®°äº†Taskä¸æ‰§è¡Œé˜¶æ®µStageçš„æ‰€å±å…³ç³»ï¼›taskBinaryåˆ™å°è£…äº†éš¶å±äºè¿™ä¸ªæ‰§è¡Œé˜¶æ®µçš„ç”¨æˆ·ä»£ç ï¼›partitionå°±æ˜¯æˆ‘ä»¬åˆšåˆšè¯´çš„RDDæ•°æ®åˆ†åŒºï¼›locså±æ€§ä»¥å­—ç¬¦ä¸²çš„å½¢å¼è®°å½•äº†è¯¥ä»»åŠ¡å€¾å‘çš„è®¡ç®—èŠ‚ç‚¹æˆ–æ˜¯Executor IDã€‚</p><p>ä¸éš¾å‘ç°ï¼ŒtaskBinaryã€partitionå’Œlocsè¿™ä¸‰ä¸ªå±æ€§ï¼Œä¸€èµ·æè¿°äº†è¿™æ ·ä¸€ä»¶äº‹æƒ…ï¼šTaskåº”è¯¥åœ¨å“ªé‡Œï¼ˆlocsï¼‰ä¸ºè°ï¼ˆpartitionï¼‰æ‰§è¡Œä»€ä¹ˆä»»åŠ¡ï¼ˆtaskBinaryï¼‰ã€‚</p><p>åˆ°è¿™é‡Œï¼Œæˆ‘ä»¬è®²å®Œäº†æˆ´æ ¼çš„èŒè´£ï¼Œè®©æˆ‘ä»¬æ¥ä¸€èµ·ç®€å•æ±‡æ€»ä¸€ä¸‹ï¼Œæˆ´æ ¼æŒ‡ä»£çš„æ˜¯DAGSchedulerï¼ŒDAGSchedulerçš„ä¸»è¦èŒè´£æœ‰ä¸‰ä¸ªï¼š</p><ul>\n<li>æ ¹æ®ç”¨æˆ·ä»£ç æ„å»ºDAGï¼›</li>\n<li>ä»¥Shuffleä¸ºè¾¹ç•Œåˆ‡å‰²Stagesï¼›</li>\n<li>åŸºäºStagesåˆ›å»ºTaskSetsï¼Œå¹¶å°†TaskSetsæäº¤ç»™TaskSchedulerè¯·æ±‚è°ƒåº¦ã€‚</li>\n</ul><p>ç°åœ¨ï¼Œæˆ´æ ¼ä¸è¾±ä½¿å‘½ï¼Œå®Œæˆäº†â€œå»ºç­‘å›¾çº¸â€åˆ°â€œå»ºç­‘é¡¹ç›®â€çš„è½¬åŒ–ï¼Œæ¥ä¸‹æ¥ï¼Œä»–éœ€è¦æŠŠè¿™äº›â€œæ´»å„¿â€ä¸‹æ´¾ç»™å¡”æ–¯å…‹ï¼Œç”±å¡”æ–¯å…‹è¿›ä¸€æ­¥å®Œæˆä»»åŠ¡çš„å§”æ´¾ã€‚</p><p><img src=\"https://static001.geekbang.org/resource/image/25/40/25404e6dfb5b3b5d5e6f319e16232440.jpg?wh=1920x712\" alt=\"å›¾ç‰‡\" title=\"Sparkè°ƒåº¦ç³»ç»Ÿå…¨å±€è§†è§’ï¼šæˆ´æ ¼çš„èŒè´£\"></p><p>ä¸è¿‡ï¼Œå¯¹äºå¡”æ–¯å…‹æ¥è¯´ï¼Œè¦æƒ³æŠŠè¿™äº›â€œæ´»å„¿â€å§”æ´¾å‡ºå»ï¼Œä»–å¾—å…ˆæ‘¸æ¸…æ¥šé›†å›¢å†…æœ‰å¤šå°‘â€œé€‚é¾„åŠ³åŠ¨åŠ›â€æ‰è¡Œã€‚è¦åšåˆ°è¿™ä¸€ç‚¹ï¼Œä»–å¿…é¡»ä»°ä»—æ­»å…šï¼šæ‹œè‚¯å¾·çš„å¸®å¿™ã€‚</p><h3>æ‹œè‚¯å¾·ï¼šSchedulerBackend</h3><p>ä½œä¸ºé›†å›¢å…¬å¸çš„äººåŠ›èµ„æºæ€»ç›‘ï¼Œæ‹œè‚¯å¾·çš„æ ¸å¿ƒèŒè´£ï¼Œå°±æ˜¯å®æ—¶æ±‡æ€»å¹¶æŒæ¡å…¨å…¬å¸çš„äººåŠ›èµ„æºçŠ¶å†µã€‚å‰é¢æˆ‘ä»¬è®²äº†ï¼Œå…¨å…¬å¸çš„äººåŠ›èµ„æºå¯¹åº”çš„å°±æ˜¯Sparkçš„è®¡ç®—èµ„æºã€‚å¯¹äºé›†ç¾¤ä¸­å¯ç”¨çš„è®¡ç®—èµ„æºï¼ŒSchedulerBackendç”¨ä¸€ä¸ªå«åšExecutorDataMapçš„æ•°æ®ç»“æ„ï¼Œæ¥è®°å½•æ¯ä¸€ä¸ªè®¡ç®—èŠ‚ç‚¹ä¸­Executorsçš„èµ„æºçŠ¶æ€ã€‚</p><p>è¿™é‡Œçš„ExecutorDataMapæ˜¯ä¸€ç§HashMapï¼Œå®ƒçš„Keyæ˜¯æ ‡è®° Executor çš„å­—ç¬¦ä¸²ï¼ŒValueæ˜¯ä¸€ç§å«åšExecutorDataçš„æ•°æ®ç»“æ„ã€‚ExecutorDataç”¨äºå°è£…Executorçš„èµ„æºçŠ¶æ€ï¼Œå¦‚RPCåœ°å€ã€ä¸»æœºåœ°å€ã€å¯ç”¨CPUæ ¸æ•°å’Œæ»¡é…CPUæ ¸æ•°ç­‰ç­‰ï¼Œå®ƒç›¸å½“äºæ˜¯å¯¹Executoråšçš„â€œèµ„æºç”»åƒâ€ã€‚</p><p><img src=\"https://static001.geekbang.org/resource/image/e5/ac/e50055d90d3b1c271e4ab97b1ddee6ac.jpg?wh=1920x729\" alt=\"å›¾ç‰‡\" title=\"ExecutorDataMapæ˜ å°„è¡¨\"></p><p>æœ‰äº†ExecutorDataMapè¿™æœ¬â€œäººåŠ›èµ„æºå°å†Œå­â€ï¼Œå¯¹å†…ï¼ŒSchedulerBackendå¯ä»¥å°±Executoråšâ€œèµ„æºç”»åƒâ€ï¼›å¯¹å¤–ï¼ŒSchedulerBackendä»¥WorkerOfferä¸ºç²’åº¦æä¾›è®¡ç®—èµ„æºã€‚å…¶ä¸­ï¼ŒWorkerOfferå°è£…äº†Executor IDã€ä¸»æœºåœ°å€å’ŒCPUæ ¸æ•°ï¼Œå®ƒç”¨æ¥è¡¨ç¤ºä¸€ä»½å¯ç”¨äºè°ƒåº¦ä»»åŠ¡çš„ç©ºé—²èµ„æºã€‚</p><p>æ˜¾ç„¶ï¼ŒåŸºäºExecutorèµ„æºç”»åƒï¼ŒSchedulerBackendå¯ä»¥åŒæ—¶æä¾›å¤šä¸ªWorkerOfferç”¨äºåˆ†å¸ƒå¼ä»»åŠ¡è°ƒåº¦ã€‚WorkerOfferè¿™ä¸ªåå­—èµ·å¾—å¾ˆä¼ ç¥ï¼ŒOfferçš„å­—é¢æ„æ€æ˜¯å…¬å¸ç»™ä½ æä¾›çš„å·¥ä½œæœºä¼šï¼Œåˆ°äº†Sparkè°ƒåº¦ç³»ç»Ÿçš„ä¸Šä¸‹æ–‡ï¼Œå®ƒå°±å˜æˆäº†ä½¿ç”¨ç¡¬ä»¶èµ„æºçš„æœºä¼šã€‚</p><p><img src=\"https://static001.geekbang.org/resource/image/59/e7/59a078cfcd4d98cfaf0cf8e89650f0e7.jpg?wh=1920x724\" alt=\"å›¾ç‰‡\" title=\"Sparkè°ƒåº¦ç³»ç»Ÿå…¨å±€è§†è§’ï¼šæ‹œè‚¯å¾·çš„èŒè´£\"></p><p>ä½ å¯èƒ½ä¼šå¥½å¥‡ï¼Œåé•‡æ€»å…¬å¸çš„æ‹œè‚¯å¾·ï¼Œå¯¹äºæ•´ä¸ªé›†å›¢çš„äººåŠ›èµ„æºï¼Œä»–æ˜¯æ€ä¹ˆåšåˆ°è¶³ä¸å‡ºæˆ·å°±å¦‚æ•°å®¶ççš„ï¼Ÿä¸€ä¸ªç¯±ç¬†ä¸‰ä¸ªæ¡©ï¼Œä¸€ä¸ªå¥½æ±‰ä¸‰ä¸ªå¸®ã€‚ä»…å‡­æ‹œè‚¯å¾·ä¸€å·±ä¹‹åŠ›ï¼Œè‡ªç„¶æ˜¯åŠ›ä¸ä»å¿ƒï¼Œå¹•ååŠŸè‡£å®é™…ä¸Šæ˜¯é©»æ‰åœ¨åˆ†å…¬å¸çš„ä¸€ä¼—å°å¼Ÿä»¬ï¼šExecutorBackendã€‚</p><p>SchedulerBackendä¸é›†ç¾¤å†…æ‰€æœ‰Executorsä¸­çš„ExecutorBackendä¿æŒå‘¨æœŸæ€§é€šä¿¡ï¼ŒåŒæ–¹é€šè¿‡LaunchedExecutorã€RemoveExecutorã€StatusUpdateç­‰æ¶ˆæ¯æ¥äº’é€šæœ‰æ— ã€å˜æ›´å¯ç”¨è®¡ç®—èµ„æºã€‚æ‹œè‚¯å¾·æ­£æ˜¯é€šè¿‡è¿™äº›å°å¼Ÿå‘é€çš„â€œä¿¡ä»¶â€ï¼Œæ¥ä¸åœåœ°æ›´æ–°è‡ªå·±æ‰‹ä¸­çš„é‚£æœ¬å°å†Œå­ï¼Œä»è€Œå¯¹é›†å›¢äººåŠ›èµ„æºäº†å¦‚æŒ‡æŒã€‚</p><p><img src=\"https://static001.geekbang.org/resource/image/59/e7/59a078cfcd4d98cfaf0cf8e89650f0e7.jpg?wh=1920x724\" alt=\"å›¾ç‰‡\" title=\"Sparkè°ƒåº¦ç³»ç»Ÿå…¨å±€è§†è§’ï¼šæ‹œè‚¯å¾·çš„èŒè´£\"></p><h3>å¡”æ–¯å…‹ï¼šTaskScheduler</h3><p>ä¸€æŠŠæ‰‹æˆ´æ ¼æœ‰â€œæ´»å„¿â€ï¼Œä¸‰æŠŠæ‰‹æ‹œè‚¯å¾·å‡ºâ€œäººåŠ›â€ï¼Œæ¥ä¸‹æ¥ï¼Œç»ˆäºè½®åˆ°ç‰µçº¿æ­æ¡¥çš„å¡”æ–¯å…‹å‡ºé©¬äº†ã€‚ä½œä¸ºæ–½å·¥ç»ç†ï¼Œå¡”æ–¯å…‹çš„æ ¸å¿ƒèŒè´£æ˜¯ï¼Œç»™å®šæ‹œè‚¯å¾·æä¾›çš„â€œäººåŠ›â€ï¼Œé´é€‰å‡ºæœ€åˆé€‚çš„â€œæ´»å„¿â€å¹¶æ´¾å‘å‡ºå»ã€‚è€Œè¿™ä¸ªé´é€‰çš„è¿‡ç¨‹ï¼Œå°±æ˜¯ä»»åŠ¡è°ƒåº¦çš„æ ¸å¿ƒæ‰€åœ¨ï¼Œå¦‚ä¸‹å›¾æ­¥éª¤3æ‰€ç¤ºï¼š</p><p><img src=\"https://static001.geekbang.org/resource/image/fa/ae/fa880f590a48f12b671dbb6be2d4beae.jpg?wh=1920x678\" alt=\"å›¾ç‰‡\" title=\"Sparkè°ƒåº¦ç³»ç»Ÿå…¨å±€è§†è§’ï¼šå¡”æ–¯å…‹çš„èŒè´£\"></p><p>é‚£ä¹ˆé—®é¢˜æ¥äº†ï¼Œå¯¹äºSchedulerBackendæä¾›çš„ä¸€ä¸ªä¸ªWorkerOfferï¼ŒTaskScheduleræ˜¯ä¾æ®ä»€ä¹ˆè§„åˆ™æ¥æŒ‘é€‰Tasksçš„å‘¢ï¼Ÿ</p><p>ç”¨ä¸€å¥è¯æ¥å›ç­”ï¼Œå¯¹äºç»™å®šçš„WorkerOfferï¼Œ<strong>TaskScheduleræ˜¯æŒ‰ç…§ä»»åŠ¡çš„æœ¬åœ°å€¾å‘æ€§ï¼Œæ¥é´é€‰å‡ºTaskSetä¸­é€‚åˆè°ƒåº¦çš„Tasksã€‚</strong>è¿™æ˜¯ä»€ä¹ˆæ„æ€å‘¢ï¼Ÿå¬ä¸Šå»æ¯”è¾ƒæŠ½è±¡ï¼Œæˆ‘ä»¬è¿˜æ˜¯ä»DAGScheduleråœ¨Stageå†…åˆ›å»ºä»»åŠ¡é›†TaskSetè¯´èµ·ã€‚</p><p>æˆ‘ä»¬åˆšåˆšè¯´è¿‡ï¼ŒTaskä¸RDDçš„partitionsæ˜¯ä¸€ä¸€å¯¹åº”çš„ï¼Œåœ¨åˆ›å»ºTaskçš„è¿‡ç¨‹ä¸­ï¼ŒDAGSchedulerä¼šæ ¹æ®æ•°æ®åˆ†åŒºçš„ç‰©ç†åœ°å€ï¼Œæ¥ä¸ºTaskè®¾ç½®locså±æ€§ã€‚locså±æ€§è®°å½•äº†æ•°æ®åˆ†åŒºæ‰€åœ¨çš„è®¡ç®—èŠ‚ç‚¹ã€ç”šè‡³æ˜¯Executorè¿›ç¨‹IDã€‚</p><p>ä¸¾ä¾‹æ¥è¯´ï¼Œå½“æˆ‘ä»¬è°ƒç”¨textFile APIä»HDFSæ–‡ä»¶ç³»ç»Ÿä¸­è¯»å–æºæ–‡ä»¶æ—¶ï¼ŒSparkä¼šæ ¹æ®HDFS NameNodeå½“ä¸­è®°å½•çš„å…ƒæ•°æ®ï¼Œè·å–æ•°æ®åˆ†åŒºçš„å­˜å‚¨åœ°å€ï¼Œä¾‹å¦‚node0:/rootPath/partition0-replica0ï¼Œnode1:/rootPath/partition0-replica1å’Œnode2:/rootPath/partition0-replica2ã€‚</p><p>é‚£ä¹ˆï¼ŒDAGScheduleråœ¨ä¸ºè¯¥æ•°æ®åˆ†åŒºåˆ›å»ºTask0çš„æ—¶å€™ï¼Œä¼šæŠŠè¿™äº›åœ°å€ä¸­çš„è®¡ç®—èŠ‚ç‚¹è®°å½•åˆ°Task0çš„locså±æ€§ã€‚</p><p>å¦‚æ­¤ä¸€æ¥ï¼Œå½“TaskScheduleréœ€è¦è°ƒåº¦Task0è¿™ä¸ªåˆ†å¸ƒå¼ä»»åŠ¡çš„æ—¶å€™ï¼Œæ ¹æ®Task0çš„locså±æ€§ï¼Œå®ƒå°±çŸ¥é“ï¼šâ€œTask0æ‰€éœ€å¤„ç†çš„æ•°æ®åˆ†åŒºï¼Œåœ¨èŠ‚ç‚¹node0ã€node1ã€node2ä¸Šå­˜æœ‰å‰¯æœ¬ï¼Œå› æ­¤ï¼Œå¦‚æœWorkOfferæ˜¯æ¥è‡ªè¿™3ä¸ªèŠ‚ç‚¹çš„è®¡ç®—èµ„æºï¼Œé‚£å¯¹Task0æ¥è¯´å°±æ˜¯æŠ•å…¶æ‰€å¥½â€ã€‚</p><p>ä»è¿™ä¸ªä¾‹å­æˆ‘ä»¬å°±èƒ½æ›´å¥½åœ°ç†è§£ï¼Œæ¯ä¸ªä»»åŠ¡éƒ½æ˜¯è‡ªå¸¦<strong>æœ¬åœ°å€¾å‘æ€§</strong>çš„ï¼Œæ¢å¥è¯è¯´ï¼Œæ¯ä¸ªä»»åŠ¡éƒ½æœ‰è‡ªå·±çš„â€œè°ƒåº¦æ„æ„¿â€ã€‚</p><p>å›åˆ°æ–¯å·´å…‹å»ºç­‘é›†å›¢çš„ç±»æ¯”ï¼Œå°±å¥½æ¯”æ˜¯æŸä¸ªâ€œæ´»å„¿â€ï¼Œå¹¶ä¸æ˜¯æ‰€æœ‰äººéƒ½èƒ½å¹²ï¼Œè€Œæ˜¯åªå€¾å‘äºè®©æŸäº›äººæ¥åšï¼Œå› ä¸ºä»–ä»¬æ›´ä¸“ä¸šã€‚æ¯”å¦‚ç Œå¢™è¿™ä»¶äº‹ï¼Œæ›´å€¾å‘äºç»™å·¥é¾„3å¹´ä»¥ä¸Šçš„ç“¦å·¥æ¥åšï¼›è€ŒåŠé¡¶ï¼Œåˆ™æ›´å€¾å‘äºç»™ç»éªŒè¶…è¿‡5å¹´çš„æœ¨å·¥æ¥åšï¼Œè¯¸å¦‚æ­¤ç±»ã€‚</p><p>åƒä¸Šé¢è¿™ç§å®šå‘åˆ°è®¡ç®—èŠ‚ç‚¹ç²’åº¦çš„æœ¬åœ°æ€§å€¾å‘ï¼ŒSparkä¸­çš„æœ¯è¯­å«åšNODE_LOCALã€‚é™¤äº†å®šå‘åˆ°èŠ‚ç‚¹ï¼ŒTaskè¿˜å¯ä»¥å®šå‘åˆ°è¿›ç¨‹ï¼ˆExecutorï¼‰ã€æœºæ¶ã€ä»»æ„åœ°å€ï¼Œå®ƒä»¬å¯¹åº”çš„æœ¯è¯­åˆ†åˆ«æ˜¯PROCESS_LOCALã€RACK_LOCALå’ŒANYã€‚</p><p>å¯¹äºå€¾å‘PROCESS_LOCALçš„Taskæ¥è¯´ï¼Œå®ƒè¦æ±‚å¯¹åº”çš„æ•°æ®åˆ†åŒºåœ¨æŸä¸ªè¿›ç¨‹ï¼ˆExecutorï¼‰ä¸­å­˜æœ‰å‰¯æœ¬ï¼›è€Œå¯¹äºå€¾å‘RACK_LOCALçš„Taskæ¥è¯´ï¼Œå®ƒä»…è¦æ±‚ç›¸åº”çš„æ•°æ®åˆ†åŒºå­˜åœ¨äºåŒä¸€æœºæ¶å³å¯ã€‚ANYåˆ™ç­‰åŒäºæ— å®šå‘ï¼Œä¹Ÿå°±æ˜¯Taskå¯¹äºåˆ†å‘çš„ç›®çš„åœ°æ²¡æœ‰å€¾å‘æ€§ï¼Œè¢«è°ƒåº¦åˆ°å“ªé‡Œéƒ½å¯ä»¥ã€‚</p><p>ä¸‹å›¾å±•ç¤ºçš„æ˜¯ï¼ŒTaskSchedulerä¾æ®æœ¬åœ°æ€§å€¾å‘ï¼Œä¾æ¬¡è¿›è¡Œä»»åŠ¡è°ƒåº¦çš„è¿è¡Œé€»è¾‘ï¼š</p><p><img src=\"https://static001.geekbang.org/resource/image/49/6b/495d8ebf85758b4ba5daa5e562da736b.jpg?wh=1920x695\" alt=\"å›¾ç‰‡\" title=\"TaskSchedulerä¾æ®æœ¬åœ°æ€§å€¾å‘ä¾æ¬¡è¿›è¡Œä»»åŠ¡è°ƒåº¦\"></p><p>ä¸éš¾å‘ç°ï¼Œä»PROCESS_LOCALã€NODE_LOCALã€åˆ°RACK_LOCALã€å†åˆ°ANYï¼ŒTaskçš„æœ¬åœ°æ€§å€¾å‘é€æ¸ä»ä¸¥è‹›å˜å¾—å®½æ¾ã€‚TaskScheduleræ¥æ”¶åˆ°WorkerOfferä¹‹åï¼Œä¹Ÿæ­£æ˜¯æŒ‰ç…§è¿™ä¸ªé¡ºåºæ¥éå†TaskSetä¸­çš„Tasksï¼Œä¼˜å…ˆè°ƒåº¦æœ¬åœ°æ€§å€¾å‘ä¸ºPROCESS_LOCALçš„Taskï¼Œè€ŒNODE_LOCALæ¬¡ä¹‹ï¼ŒRACK_LOCALä¸ºå†æ¬¡ï¼Œæœ€åæ˜¯ANYã€‚</p><p>ä½ å¯èƒ½ä¼šé—®ï¼šâ€œSparkåŒºåˆ†å¯¹å¾…ä¸åŒçš„æœ¬åœ°å€¾å‘æ€§ï¼Œå®ƒçš„åˆè¡·å’Œæ„å›¾æ˜¯ä»€ä¹ˆå‘¢ï¼Ÿâ€å®é™…ä¸Šï¼Œä¸åŒçš„æœ¬åœ°æ€§å€¾å‘ï¼Œæœ¬è´¨ä¸Šæ˜¯ç”¨æ¥åŒºåˆ†è®¡ç®—ï¼ˆä»£ç ï¼‰ä¸æ•°æ®ä¹‹é—´çš„å…³ç³»ã€‚</p><p><strong>Sparkè°ƒåº¦ç³»ç»Ÿçš„æ ¸å¿ƒæ€æƒ³ï¼Œæ˜¯â€œæ•°æ®ä¸åŠ¨ã€ä»£ç åŠ¨â€ã€‚</strong>ä¹Ÿå°±æ˜¯è¯´ï¼Œåœ¨ä»»åŠ¡è°ƒåº¦çš„è¿‡ç¨‹ä¸­ï¼Œä¸ºäº†å®Œæˆåˆ†å¸ƒå¼è®¡ç®—ï¼ŒSparkå€¾å‘äºè®©æ•°æ®å¾…åœ¨åŸåœ°ã€ä¿æŒä¸åŠ¨ï¼Œè€ŒæŠŠè®¡ç®—ä»»åŠ¡ï¼ˆä»£ç ï¼‰è°ƒåº¦ã€åˆ†å‘åˆ°æ•°æ®æ‰€åœ¨çš„åœ°æ–¹ï¼Œä»è€Œæ¶ˆé™¤æ•°æ®åˆ†å‘å¼•å…¥çš„æ€§èƒ½éšæ‚£ã€‚æ¯•ç«Ÿï¼Œç›¸æ¯”åˆ†å‘æ•°æ®ï¼Œåˆ†å‘ä»£ç è¦è½»é‡å¾—å¤šã€‚</p><p>æœ¬åœ°æ€§å€¾å‘åˆ™æ„å‘³ç€ä»£ç å’Œæ•°æ®åº”è¯¥åœ¨å“ªé‡Œâ€œç›¸ä¼šâ€ï¼ŒPROCESS_LOCALæ˜¯åœ¨JVMè¿›ç¨‹ä¸­ï¼ŒNODE_LOCALæ˜¯åœ¨èŠ‚ç‚¹å†…ï¼ŒRACK_LOCALæ˜¯ä¸è¶…å‡ºç‰©ç†æœºæ¶çš„èŒƒå›´ï¼Œè€ŒANYåˆ™ä»£è¡¨â€œæ— æ‰€è°“ã€ä¸é‡è¦â€ã€‚</p><p><img src=\"https://static001.geekbang.org/resource/image/2b/0a/2b3864c2f01fc9916005a1b5d6e08d0a.jpg?wh=1920x763\" alt=\"å›¾ç‰‡\" title=\"\nSparkè°ƒåº¦ç³»ç»Ÿå…¨å±€è§†è§’ï¼šå¡”æ–¯å…‹çš„èŒè´£\"></p><p>å¥½å•¦ï¼Œåˆ°æ­¤ä¸ºæ­¢ï¼Œç»“åˆWorkerOfferä¸ä»»åŠ¡çš„æœ¬åœ°æ€§å€¾å‘ï¼Œå¡”æ–¯å…‹TaskScheduleræŒ‘é€‰å‡ºäº†é€‚åˆè°ƒåº¦çš„â€œæ´»å„¿â€ï¼šTasksã€‚æ¥ä¸‹æ¥ï¼ŒTaskSchedulerå°±æŠŠè¿™äº›Tasksé€šè¿‡LaunchTaskæ¶ˆæ¯ï¼Œå‘é€ç»™å¥½åŸºå‹SchedulerBackendã€‚äººåŠ›èµ„æºæ€»ç›‘SchedulerBackendæ‹¿åˆ°è¿™äº›æ´»å„¿ä¹‹åï¼ŒåŒæ ·ä½¿ç”¨LaunchTaskæ¶ˆæ¯ï¼ŒæŠŠæ´»å„¿è¿›ä¸€æ­¥ä¸‹å‘ç»™åˆ†å…¬å¸çš„å°å¼Ÿï¼šExecutorBackendã€‚</p><p>é‚£ä¹ˆå°å¼ŸExecutorBackendæ‹¿åˆ°æ´»ä¹‹åï¼Œæ˜¯æ€ä¹ˆå·¥ä½œçš„å‘¢ï¼Ÿæˆ‘ä»¬æ¥ç€å¾€ä¸‹çœ‹å§ï¼</p><h3>ä»˜è¯¸æ‰§è¡Œï¼šExecutorBackend</h3><p>ä½œä¸ºåˆ†å…¬å¸çš„äººåŠ›èµ„æºä¸»ç®¡ï¼ŒExecutorBackendæ‹¿åˆ°â€œæ´»å„¿â€ä¹‹åï¼Œéšå³æŠŠæ´»å„¿æ´¾å‘ç»™åˆ†å…¬å¸çš„å»ºç­‘å·¥äººã€‚è¿™äº›å·¥äººï¼Œå°±æ˜¯Executorsçº¿ç¨‹æ± ä¸­ä¸€ä¸ªåˆä¸€ä¸ªçš„CPUçº¿ç¨‹ï¼Œæ¯ä¸ªçº¿ç¨‹è´Ÿè´£å¤„ç†ä¸€ä¸ªTaskã€‚</p><p>æ¯å½“Taskå¤„ç†å®Œæ¯•ï¼Œè¿™äº›çº¿ç¨‹ä¾¿ä¼šé€šè¿‡ExecutorBackendï¼Œå‘Driverç«¯çš„SchedulerBackendå‘é€StatusUpdateäº‹ä»¶ï¼Œå‘ŠçŸ¥Taskæ‰§è¡ŒçŠ¶æ€ã€‚æ¥ä¸‹æ¥ï¼ŒTaskSchedulerä¸SchedulerBackendé€šè¿‡æ¥åŠ›çš„æ–¹å¼ï¼Œæœ€ç»ˆæŠŠçŠ¶æ€æ±‡æŠ¥ç»™DAGSchedulerï¼Œå¦‚å›¾ä¸­æ­¥éª¤7ã€8ã€9æ‰€ç¤ºï¼š</p><p><img src=\"https://static001.geekbang.org/resource/image/c9/a9/c92eca7d5de4c72d478183b187322da9.jpg?wh=1920x742\" alt=\"å›¾ç‰‡\" title=\"Sparkè°ƒåº¦ç³»ç»Ÿå…¨å±€è§†è§’ï¼šä»»åŠ¡åˆ†å‘ä¸æ‰§è¡Œ\"></p><p>å¯¹äºåŒä¸€ä¸ªTaskSetå½“ä¸­çš„Tasksæ¥è¯´ï¼Œå½“å®ƒä»¬åˆ†åˆ«å®Œæˆäº†ä»»åŠ¡è°ƒåº¦ä¸ä»»åŠ¡æ‰§è¡Œè¿™ä¸¤ä¸ªç¯èŠ‚æ—¶ï¼Œä¹Ÿå°±æ˜¯ä¸Šå›¾ä¸­æ­¥éª¤1åˆ°æ­¥éª¤9çš„è®¡ç®—è¿‡ç¨‹ï¼ŒSparkè°ƒåº¦ç³»ç»Ÿå°±å®Œæˆäº†DAGä¸­æŸä¸€ä¸ªStageçš„ä»»åŠ¡è°ƒåº¦ã€‚</p><p>ä¸è¿‡ï¼Œæ•…äº‹åˆ°è¿™é‡Œå¹¶æœªç»“æŸã€‚æˆ‘ä»¬çŸ¥é“ï¼Œä¸€ä¸ªDAGä¼šåŒ…å«å¤šä¸ªStagesï¼Œä¸€ä¸ªStageçš„ç»“æŸå³å®£å‘Šä¸‹ä¸€ä¸ªStageçš„å¼€å§‹ï¼Œè€Œè¿™ä¹Ÿæ˜¯æˆ´æ ¼èµ·åˆå°†DAGåˆ’åˆ†ä¸ºStagesçš„æ„ä¹‰æ‰€åœ¨ã€‚åªæœ‰å½“æ‰€æœ‰çš„Stageså…¨éƒ¨è°ƒåº¦ã€æ‰§è¡Œå®Œæ¯•ï¼Œæ‰è¡¨ç¤ºä¸€ä¸ªå®Œæ•´çš„Sparkä½œä¸šå®£å‘Šç»“æŸã€‚</p><p>è·¯é¥çŸ¥é©¬åŠ›ï¼Œåœ¨ä¸€èµ·åˆä½œäº†ä¸€ä¸ªåˆä¸€ä¸ªå»ºç­‘é¡¹ç›®ä¹‹åï¼Œç©ºé™è€å¤§æˆ´æ ¼ç»ˆäºèµ¢å¾—äº†å…ƒè€å¡”æ–¯å…‹å’Œæ‹œè‚¯å¾·çš„ä¿¡ä»»ä¸è®¤å¯ï¼Œåç¨³äº†æ–¯å·´å…‹å»ºç­‘é›†å›¢çš„å¤´æŠŠäº¤æ¤…ã€‚æ¥æ—¥å¯æœŸï¼Œæˆ´æ ¼çš„å‰æ™¯ä¸€ç‰‡å…‰æ˜ã€‚</p><h2>é‡ç‚¹å›é¡¾</h2><p>ä»Šå¤©è¿™ä¸€è®²ï¼Œæˆ‘ä»¬ç”¨æ–¯å·´å…‹å»ºç­‘é›†å›¢çš„æ•…äº‹ï¼Œä»‹ç»äº†Sparkè°ƒåº¦ç³»ç»Ÿçš„å·¥ä½œåŸç†ã€‚å¯¹äºè°ƒåº¦ç³»ç»Ÿçš„å·¥ä½œæµç¨‹ï¼Œä½ éœ€è¦æŒæ¡è¡¨æ ¼ä¸­çš„5ä¸ªå…³é”®ç¯èŠ‚ï¼š</p><p><img src=\"https://static001.geekbang.org/resource/image/e7/1e/e743cf687bb02bfec8c6ffebbe7d4a1e.jpg?wh=1452x806\" alt=\"å›¾ç‰‡\"></p><p>å…·ä½“è¯´æ¥ï¼Œä»»åŠ¡è°ƒåº¦åˆ†ä¸ºå¦‚ä¸‹5ä¸ªæ­¥éª¤ï¼š</p><p>1.DAGSchedulerä»¥Shuffleä¸ºè¾¹ç•Œï¼Œå°†å¼€å‘è€…è®¾è®¡çš„è®¡ç®—å›¾DAGæ‹†åˆ†ä¸ºå¤šä¸ªæ‰§è¡Œé˜¶æ®µStagesï¼Œç„¶åä¸ºæ¯ä¸ªStageåˆ›å»ºä»»åŠ¡é›†TaskSetã€‚<br>\n2.SchedulerBackendé€šè¿‡ä¸Executorsä¸­çš„ExecutorBackendçš„äº¤äº’æ¥å®æ—¶åœ°è·å–é›†ç¾¤ä¸­å¯ç”¨çš„è®¡ç®—èµ„æºï¼Œå¹¶å°†è¿™äº›ä¿¡æ¯è®°å½•åˆ°ExecutorDataMapæ•°æ®ç»“æ„ã€‚<br>\n3.ä¸æ­¤åŒæ—¶ï¼ŒSchedulerBackendæ ¹æ®ExecutorDataMapä¸­å¯ç”¨èµ„æºåˆ›å»ºWorkerOfferï¼Œä»¥WorkerOfferä¸ºç²’åº¦æä¾›è®¡ç®—èµ„æºã€‚<br>\n4.å¯¹äºç»™å®šWorkerOfferï¼ŒTaskSchedulerç»“åˆTaskSetä¸­ä»»åŠ¡çš„æœ¬åœ°æ€§å€¾å‘ï¼ŒæŒ‰ç…§PROCESS_LOCALã€NODE_LOCALã€RACK_LOCALå’ŒANYçš„é¡ºåºï¼Œä¾æ¬¡å¯¹TaskSetä¸­çš„ä»»åŠ¡è¿›è¡Œéå†ï¼Œä¼˜å…ˆè°ƒåº¦æœ¬åœ°æ€§å€¾å‘è¦æ±‚è‹›åˆ»çš„Taskã€‚<br>\n5.è¢«é€‰ä¸­çš„Taskç”±TaskSchedulerä¼ é€’ç»™SchedulerBackendï¼Œå†ç”±SchedulerBackendåˆ†å‘åˆ°Executorsä¸­çš„ExecutorBackendã€‚Executorsæ¥æ”¶åˆ°Taskä¹‹åï¼Œå³è°ƒç”¨æœ¬åœ°çº¿ç¨‹æ± æ¥æ‰§è¡Œåˆ†å¸ƒå¼ä»»åŠ¡ã€‚</p><p>ä»Šå¤©çš„å†…å®¹å°±æ˜¯è¿™äº›ï¼Œè°ƒåº¦ç³»ç»Ÿæ˜¯åˆ†å¸ƒå¼è®¡ç®—ç³»ç»Ÿçš„æ ¸å¿ƒï¼ŒæŒæ¡äº†Sparkä»»åŠ¡è°ƒåº¦çš„æ¥é¾™å»è„‰ï¼Œä½ ä¹Ÿå°±æŠŠæ¡ä½äº†Sparkåˆ†å¸ƒå¼è®¡ç®—å¼•æ“çš„ç²¾é«“ï¼Œè¿™ä¼šä¸ºä½ å¼€å‘å‡ºé«˜æ€§èƒ½çš„Sparkåˆ†å¸ƒå¼åº”ç”¨æ‰“ä¸‹åšå®åŸºç¡€ã€‚</p><h2>æ¯è¯¾ä¸€ç»ƒ</h2><p>è¯¾ç¨‹çš„æœ€åï¼Œæˆ‘æ¥ç»™ä½ ç•™ä¸€é“ç»ƒä¹ é¢˜ã€‚è¯·ä½ æƒ³ä¸€æƒ³ï¼ŒDAGSchedulerå¦‚ä½•å¾—çŸ¥ä¸€ä¸ªStageä¸­æ‰€æœ‰çš„Taskséƒ½å·²è°ƒåº¦ã€æ‰§è¡Œå®Œæ¯•ï¼Œç„¶åæ‰å†³å®šå¼€å§‹è°ƒåº¦DAGä¸­çš„ä¸‹ä¸€ä¸ªStageï¼Ÿ</p><p>æ¬¢è¿ä½ åœ¨è¯„è®ºåŒºå›ç­”è¿™ä¸ªé—®é¢˜ã€‚å¦‚æœä½ è§‰å¾—è¿™ä¸€è®²å¯¹ä½ æœ‰æ‰€å¸®åŠ©ï¼Œä¹Ÿæ¬¢è¿ä½ æŠŠå®ƒåˆ†äº«ç»™æ›´å¤šçš„æœ‹å‹å’ŒåŒäº‹ã€‚æˆ‘åœ¨è¯„è®ºåŒºç­‰ä½ ï¼Œå’±ä»¬ä¸‹ä¸€è®²è§ï¼</p>","neighbors":{"left":{"article_title":"04 | è¿›ç¨‹æ¨¡å‹ä¸åˆ†å¸ƒå¼éƒ¨ç½²ï¼šåˆ†å¸ƒå¼è®¡ç®—æ˜¯æ€ä¹ˆå›äº‹ï¼Ÿ","id":419200},"right":{"article_title":"06 | Shuffleç®¡ç†ï¼šä¸ºä»€ä¹ˆShuffleæ˜¯æ€§èƒ½ç“¶é¢ˆï¼Ÿ","id":420399}},"comments":[{"had_liked":false,"id":312940,"user_name":"Geek_2dfa9a","can_delete":false,"product_type":"c1","uid":1435535,"ip_address":"","ucode":"B5FE7971F5E773","user_header":"http://thirdwx.qlogo.cn/mmopen/vi_32/DYAIOgq83epGTSTvn7r4ibk1PuaUrSvvLdviaLcne50jbvvfiaxKkM5SLibeP6jibA2bCCQBqETibvIvcsOhAZlwS8kQ/132","comment_is_top":true,"comment_ctime":1632132409,"is_pvip":false,"replies":[{"id":"113452","content":"æ»¡åˆ†ğŸ’¯ + ç½®é¡¶ğŸ”ï¼ŒğŸ‘ğŸ‘ğŸ‘<br><br>åˆ†æå¾—ç›¸å½“åˆ°ä½&#47;æ·±å…¥ï¼èµèµèµï¼<br><br>æ„Ÿè°¢è€å¼Ÿè®¤å¯~ æ²¡é—®é¢˜ï¼Œåç»­æŠŠå­—ä½“è°ƒå¤§äº›~","user_name":"ä½œè€…å›å¤","user_name_real":"å´ç£Š","uid":"1043100","ctime":1632326747,"ip_address":"","comment_id":312940,"utype":1}],"discussion_count":4,"race_medal":0,"score":"9.2233721630409994e+18","product_id":100090001,"comment_content":"å›ç­”è¿™ä¸ªæµç¨‹æ¯”è¾ƒé•¿å“ˆï¼Œæ²¡æœ‰ç‚¹å¼€æºæºç é˜…è¯»ç»éªŒè¿˜çœŸä¸å¥½ç­”å“ˆï¼Œæˆ‘è¿™é‡Œéƒ½æ˜¯è‡ªå·±çš„ç†è§£ï¼Œå¦‚æœ‰å¼‚è®®æ¬¢è¿è®¨è®ºã€‚<br>ä»¥è€å¸ˆçš„WordCountä¸ºä¾‹ï¼Œé¦–å…ˆstageåˆ†ä¸ºä¸¤ç§ï¼šResultStageï¼ŒShuffleMapStageã€‚<br>ResultStageæ˜¯å•¥å‘¢å°±æ˜¯å¤„ç†ActionåŠ¨ä½œçš„ï¼Œä¸€èˆ¬ä¹Ÿå°±æ˜¯æœ€åä¸€ä¸ªStageï¼ˆå½“ç„¶ä¸€ä¸ªdriveré‡Œä¹Ÿå¯èƒ½æœ‰å¤šä¸ªActionï¼Œæ‰€ä»¥ResultStageä¹Ÿå¯èƒ½æœ‰å¤šä¸ªï¼Œ<br>è¿™é‡Œç®€å•ç‚¹ï¼ŒWordCountä¾‹å­é‡Œå°±æ˜¯Stage1ï¼‰ã€‚<br>ShuffleMapStageæ˜¯å•¥å‘¢ï¼Œå°±æ˜¯äº§ç”Ÿä¸€ä¸ªshuffleæ–‡ä»¶çš„stageï¼Œå¯¹åº”WordCountçš„Stage0ã€‚<br>ä¸ºå•¥è¦åˆ†è¿™ä¹ˆä¸¤ç±»å‘¢ï¼Œå› ä¸ºä½ DAGSchedulerå°±æ˜¯æ ¹æ®æ˜¯å¦shuffleå€’æ¨å‡ºæ¥çš„stageå˜›ã€‚è¿™é‡Œå¤šæä¸€å¥ï¼Œå¤šä¸ªJobä¼šå…±äº«Stageï¼Œè¿™æ ·å°±å¯ä»¥é¿å…é‡å¤è®¡ç®—æå‡æ•ˆç‡ã€‚<br>å†æ ¹æ®è€å¸ˆè®²çš„æ¯ä¸ªStageé‡Œä¼šæ ¹æ®RDDçš„partitionsåˆ›å»ºTaskè¿™æ®µç»“åˆæºç å‘ç°Taskä¹Ÿæœ‰ä¸¤ç§ï¼šResultTaskå’ŒShuffleMapTaskï¼Œå¯¹åº”çš„æ˜¯Stageçš„ä¸¤ç§ç±»å‹ã€‚<br><br>æ¥ä¸‹æ¥åˆ†æä¸‹DAGScheduleræ€ä¹ˆæ„ŸçŸ¥Taskçš„æ‰§è¡ŒçŠ¶æ€ï¼ŒDAGSchedulerå†…éƒ¨æœ‰ä¸€ä¸ªçº¿ç¨‹eventProcessLoopï¼Œçº¿ç¨‹ä½¿ç”¨äº†ç”Ÿäº§è€…æ¶ˆè´¹è€…æ¨¡å¼ï¼Œ<br>é‡Œé¢æœ‰ä¸€ä¸ªLinkedBlockingDequeé˜Ÿåˆ—ï¼Œç”Ÿäº§è€…TaskSetManagerï¼ˆå¯ä»¥å¿½ç•¥ï¼Œç†è§£ä¸ºä¸€ä¸ªçº¿ç¨‹å³å¯ï¼‰å‘é€ç»™DAGSchedulerçš„å„ç§Taskçš„eventï¼Œ<br>æ¶ˆè´¹è€…eventProcessLoopæŠŠeventå–å‡ºæ¥ç„¶åå§”æ‰˜ç»™DAGSchedulerå¤„ç†ï¼Œå…¶ä¸­å¯¹åº”Taskå®Œæˆçš„é€»è¾‘åœ¨æ–¹æ³•handleTaskCompletion(event: <br>CompletionEvent)ä¸­ã€‚æ—¢ç„¶é—®çš„æ˜¯æ€ä¹ˆçŸ¥é“å½“å‰Stageå·²ç»è¿è¡Œå®Œæˆï¼Œå¯ä»¥è¿è¡Œä¸‹ä¸€ä¸ªStageï¼Œé‚£å½“å‰Stageè‚¯å®šä¸æ˜¯ResultStageï¼Œ<br>å› æ­¤åœ¨handleTaskCompletionæ‰¾åˆ°å¤„ç†ShuffleMapTaskçš„eventçš„é€»è¾‘ï¼Œå…·ä½“é€»è¾‘ä¸ºï¼šå…ˆæ‰¾åˆ°executorçš„IDæ ‡å¿—execIdï¼Œ<br>æ ¡éªŒexecIdæ˜¯å¦ä¸ºä¸‹å‘çš„Executorï¼ˆä»¥é˜²ä¼ªé€ çš„eventï¼‰ç„¶åæ ‡è®°ShuffleMapTaskçš„ç»“æœå¯ç”¨ï¼Œç„¶åæ£€æŸ¥å½“å‰ShuffleMapStageæ˜¯å¦è¿˜æœ‰æ²¡å¤„ç†çš„Taskï¼Œ<br>å¦‚æœæ²¡æœ‰çš„è¯è¯´æ˜è¯¥Stageå®Œæˆï¼Œæœ€åsubmitWaitingChildStagesæäº¤ç­‰å¾…ä¸­çš„åç»­Stageã€‚<br><br>è¿™é‡Œä½¿ç”¨çš„eventProcessLoopç”Ÿäº§è€…æ¶ˆè´¹è€…æ¨¡å¼æ¯”è¾ƒå·§å¦™ï¼Œç”Ÿäº§è€…å¯èƒ½æœ‰å¤šä¸ªçº¿ç¨‹ï¼ˆæ²¡è¿›ä¸€æ­¥ç¡®è®¤ï¼Œæœ‰å¯èƒ½æ˜¯1&#47;nä¸ªï¼‰ï¼Œä½†æ˜¯æ¶ˆè´¹è€…æ˜¯å•çº¿ç¨‹çš„ï¼Œ<br>ç”Ÿäº§è€…ä¹Ÿä¸ç›´æ¥ä¿®æ”¹DAGSchedulerå†…éƒ¨çš„æˆå‘˜ï¼Œåªé€šè¿‡ä¸¢eventç»™çº¿ç¨‹å®‰å…¨çš„LinkedBlockingDequeï¼Œè¿™æ ·å°±ä¿è¯äº†æ²¡æœ‰æ•°æ®ç«äº‰ã€‚<br><br>æœ€åï¼Œè€å¸ˆè®²çš„éå¸¸æ¸…æ¥šï¼Œçœ‹äº†è¿™é—¨è¯¾åæˆ‘ä¹°äº†è€å¸ˆçš„å¦ä¸€é—¨Sparkæ€§èƒ½è°ƒä¼˜ï¼Œåœ¨è¿™é‡Œæ„Ÿè°¢è€å¸ˆã€‚æœ€åæä¸€å¥ï¼Œæ‚¨é…å›¾é‡Œçš„å­—èƒ½è°ƒå¤§ç‚¹å˜›ï¼Œå­—å¤ªå°äº†ã€‚","like_count":30,"discussions":[{"author":{"id":1043100,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/ea/9c/230061e7.jpg","nickname":"å´ç£Š","note":"","ucode":"136DC8CF1B10DC","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":527172,"discussion_content":"æ»¡åˆ†ğŸ’¯ + ç½®é¡¶ğŸ”ï¼ŒğŸ‘ğŸ‘ğŸ‘\n\nåˆ†æå¾—ç›¸å½“åˆ°ä½/æ·±å…¥ï¼èµèµèµï¼\n\næ„Ÿè°¢è€å¼Ÿè®¤å¯~ æ²¡é—®é¢˜ï¼Œåç»­æŠŠå­—ä½“è°ƒå¤§äº›~","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1632326747,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":2861352,"avatar":"","nickname":"é˜¿ç‹¸å¼Ÿå¼Ÿçš„åŒ…å­åº—","note":"","ucode":"0CCF598B029075","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":548513,"discussion_content":"Jobåˆæ˜¯å•¥ï¼Ÿå´è€å¸ˆæ²¡æåˆ°å‘€ï¼Ÿ","likes_number":1,"is_delete":false,"is_hidden":false,"ctime":1643245743,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":1,"child_discussions":[{"author":{"id":1048441,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/ff/79/f400c4d1.jpg","nickname":"douge","note":"","ucode":"A6EB1AA3D53516","race_medal":0,"user_type":1,"is_pvip":true},"reply_author":{"id":2861352,"avatar":"","nickname":"é˜¿ç‹¸å¼Ÿå¼Ÿçš„åŒ…å­åº—","note":"","ucode":"0CCF598B029075","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":589732,"discussion_content":"å°±æ˜¯actionï¼Œactionä¸åŒï¼Œå‰é¢çš„transformç›¸åŒï¼Œæ‰€ä»¥å¯ä»¥å…±äº«ä¸­é—´ç»“æœ","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1665292221,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":548513,"ip_address":"å±±ä¸œ"},"score":589732,"extra":""}]},{"author":{"id":1096652,"avatar":"https://static001.geekbang.org/account/avatar/00/10/bb/cc/fac12364.jpg","nickname":"xxx","note":"","ucode":"E79CEA70430449","race_medal":0,"user_type":1,"is_pvip":true},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":544543,"discussion_content":"ç¡¬æ ¸å•Šï¼Œç›´æ¥ä¸Šæºç !","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1641556031,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":318548,"user_name":"welldo","can_delete":false,"product_type":"c1","uid":1598796,"ip_address":"","ucode":"D38E75364CD2E3","user_header":"https://static001.geekbang.org/account/avatar/00/18/65/4c/f7f86496.jpg","comment_is_top":false,"comment_ctime":1635328617,"is_pvip":false,"replies":[{"id":"115570","content":"è€å¼Ÿå¤´åƒä¸é”™~<br><br>å›ç­”ä½ çš„é—®é¢˜ï¼šç†è§£å¾—ç®€ç›´å¤ªåˆ°ä½äº†ï¼éå¸¸å¯¹ï¼å°±æ˜¯è¿™ä¸ªæ„æ€~","user_name":"ä½œè€…å›å¤","user_name_real":"å´ç£Š","uid":"1043100","ctime":1635424741,"ip_address":"","comment_id":318548,"utype":1}],"discussion_count":2,"race_medal":0,"score":"23110165097","product_id":100090001,"comment_content":"è€å¸ˆ,<br>æ ¹æ®â€œå½“ TaskScheduler éœ€è¦è°ƒåº¦ Task0 è¿™ä¸ªä»»åŠ¡æ—¶ï¼Œæ ¹æ® Task0 çš„ locs å±æ€§ï¼Œå®ƒå°±çŸ¥é“ã€‚ã€‚ã€‚â€è¿™æ®µè¯ï¼Œ<br>å’Œä½ å›å¤unknownåŒå­¦çš„â€œä»…ä»…çŸ¥é“æ•°æ®åœ¨æŸä¸ªæœºæ¶å†…ï¼ˆä¸€ä¸ªæœºæ¶åŒ…å«å¤šå°æœºå™¨ï¼‰â€è¿™æ®µè¯ï¼Œ<br>ç»“åˆèµ·æ¥ï¼Œæ„æ€æ˜¯ä¸æ˜¯ï¼š<br><br>taskå¯¹äºå®ƒè¦å¤„ç†çš„æ•°æ®åœ¨å“ªé‡Œï¼Œ<br>æœ‰æ—¶å€™ç²¾ç¡®çŸ¥é“ï¼ˆåœ¨æŸä¸ªè¿›ç¨‹å†…æˆ–æŸä¸ªèŠ‚ç‚¹å†…ï¼‰ï¼›<br>æœ‰æ—¶å€™æ¨¡ç³ŠçŸ¥é“ï¼ˆåœ¨æŸä¸ªæœºæ¶å†…ï¼‰ï¼›æœ‰æ—¶å€™ä¸çŸ¥é“ï¼ˆanyï¼‰ï¼Œ<br>å¹¶ä¸”æ ‡æ³¨åœ¨å®ƒçš„locså±æ€§é‡Œï¼Œ<br>â€œç²¾ç¡®çŸ¥é“çš„â€taskï¼Œå°±åªæŒ‘é€‰ç¬¦åˆè¦æ±‚çš„offerï¼›<br>â€œæ¨¡ç³ŠçŸ¥é“çš„â€taskï¼Œå°±æŒ‘é€‰å¤§è‡´ç¬¦åˆè¦æ±‚çš„offerï¼›<br>â€œä¸çŸ¥é“çš„â€taskï¼Œå°±éšä¾¿é€‰ä¸€ä¸ªofferã€‚<br><br>è€å¸ˆï¼Œè¯·é—®æˆ‘çš„ç†è§£å¯¹å—ï¼Ÿ<br><br><br><br><br><br><br><br><br><br>","like_count":5,"discussions":[{"author":{"id":1043100,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/ea/9c/230061e7.jpg","nickname":"å´ç£Š","note":"","ucode":"136DC8CF1B10DC","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":529294,"discussion_content":"è€å¼Ÿå¤´åƒä¸é”™~\n\nå›ç­”ä½ çš„é—®é¢˜ï¼šç†è§£å¾—ç®€ç›´å¤ªåˆ°ä½äº†ï¼éå¸¸å¯¹ï¼å°±æ˜¯è¿™ä¸ªæ„æ€~","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1635424741,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":1,"child_discussions":[{"author":{"id":2845437,"avatar":"","nickname":"Geek5763","note":"","ucode":"D4C8CAEABAA925","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":1043100,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/ea/9c/230061e7.jpg","nickname":"å´ç£Š","note":"","ucode":"136DC8CF1B10DC","race_medal":0,"user_type":2,"is_pvip":false},"discussion":{"id":542420,"discussion_content":"å¦‚æœä¸çŸ¥é“æ•°æ®å…·ä½“åœ¨å“ªä¸ªèŠ‚ç‚¹ï¼Œæ€ä¹ˆæŠŠä»£ç å‘é€åˆ°è¿™ä¸ªèŠ‚ç‚¹å‘¢ è¿™å—æ˜¯æ€ä¹ˆå¤„ç†çš„å‘¢è€å¸ˆ","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1640746432,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":529294,"ip_address":""},"score":542420,"extra":""}]}]},{"had_liked":false,"id":312900,"user_name":"JordanÂ·æå¨","can_delete":false,"product_type":"c1","uid":1149793,"ip_address":"","ucode":"4ACC42374723EA","user_header":"https://static001.geekbang.org/account/avatar/00/11/8b/61/df00ebc5.jpg","comment_is_top":false,"comment_ctime":1632110544,"is_pvip":false,"replies":[{"id":"113451","content":"å–œæ¬¢å°±å¥½~","user_name":"ä½œè€…å›å¤","user_name_real":"å´ç£Š","uid":"1043100","ctime":1632326390,"ip_address":"","comment_id":312900,"utype":1}],"discussion_count":1,"race_medal":0,"score":"18811979728","product_id":100090001,"comment_content":"æ€»å…¬å¸å’Œåˆ†å…¬å¸çš„å·¥ä½œä»»åŠ¡å’ŒäººåŠ›èµ„æºåˆ†é…è°ƒåº¦çš„ä¾‹å­å¤ªåŒ¹é…äº†ã€‚","like_count":4,"discussions":[{"author":{"id":1043100,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/ea/9c/230061e7.jpg","nickname":"å´ç£Š","note":"","ucode":"136DC8CF1B10DC","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":527152,"discussion_content":"å–œæ¬¢å°±å¥½~","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1632326390,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":331902,"user_name":"èµŒç¥å¾ˆä½è°ƒ","can_delete":false,"product_type":"c1","uid":1168545,"ip_address":"","ucode":"1066778E1EDF26","user_header":"https://static001.geekbang.org/account/avatar/00/11/d4/a1/8bc8e7e1.jpg","comment_is_top":false,"comment_ctime":1642859862,"is_pvip":true,"replies":[{"id":"121405","content":"å¥½é—®é¢˜ï¼Œæ˜¯è¿™æ ·çš„ï¼Œèµ„æºè°ƒåº¦å’Œä»»åŠ¡è°ƒåº¦æ˜¯åˆ†å¼€çš„ã€‚<br><br>èµ„æºè°ƒåº¦ä¸»è¦çœ‹å“ªäº›èŠ‚ç‚¹å¯ä»¥å¯åŠ¨executorsï¼Œæ˜¯å¦èƒ½æ»¡è¶³executorsæ‰€éœ€çš„cpuæ•°é‡è¦æ±‚ï¼Œè¿™ä¸ªæ—¶å€™ï¼Œä¸ä¼šè€ƒè™‘ä»»åŠ¡ã€æ•°æ®æœ¬åœ°æ€§è¿™äº›å› ç´ ã€‚<br><br>èµ„æºè°ƒåº¦å®Œæˆä¹‹åï¼Œåœ¨ä»»åŠ¡è°ƒåº¦é˜¶æ®µï¼Œsparkè´Ÿè´£è®¡ç®—æ¯ä¸ªä»»åŠ¡çš„æœ¬åœ°æ€§ï¼Œæ•ˆæœå°±æ˜¯taskæ˜ç¡®çŸ¥é“è‡ªå·±åº”è¯¥è°ƒåº¦åˆ°å“ªä¸ªèŠ‚ç‚¹ï¼Œç”šè‡³æ˜¯å“ªä¸ªexecutorsã€‚æœ€åscheduler Backendä¼šæŠŠtaskä»£ç ï¼Œåˆ†å‘åˆ°ç›®æ ‡èŠ‚ç‚¹çš„ç›®æ ‡executorsï¼Œå®Œæˆä»»åŠ¡è°ƒåº¦ï¼Œå®ç°æ•°æ®ä¸åŠ¨ä»£ç åŠ¨ã€‚<br><br>æ‰€ä»¥ï¼ŒäºŒè€…æ˜¯ç‹¬ç«‹çš„ï¼Œä¸èƒ½æ··ä¸ºä¸€è°ˆå“ˆï½","user_name":"ä½œè€…å›å¤","user_name_real":"ç¼–è¾‘","uid":"1043100","ctime":1643189502,"ip_address":"","comment_id":331902,"utype":1}],"discussion_count":1,"race_medal":0,"score":"14527761750","product_id":100090001,"comment_content":"è€å¸ˆå¥½ï¼Œæ–‡ä¸­è¯´taskä»»åŠ¡åˆ†å‘é€šè¿‡æ•°æ®æœ¬åœ°æ€§æ‰¾åˆ°åˆé€‚çš„executorï¼Œæƒ³äº†è§£executorè¿›ç¨‹æ˜¯æ ¹æ®æ•°æ®æ‰€åœ¨çš„èŠ‚ç‚¹åˆ›å»ºçš„å—ï¼Ÿå¦åˆ™ä¸æ˜¯å¾ˆå¤§å‡ ç‡éƒ½æ‰¾ä¸åˆ°åˆé€‚çš„executor?","like_count":3,"discussions":[{"author":{"id":1043100,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/ea/9c/230061e7.jpg","nickname":"å´ç£Š","note":"","ucode":"136DC8CF1B10DC","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":548428,"discussion_content":"å¥½é—®é¢˜ï¼Œæ˜¯è¿™æ ·çš„ï¼Œèµ„æºè°ƒåº¦å’Œä»»åŠ¡è°ƒåº¦æ˜¯åˆ†å¼€çš„ã€‚\n\nèµ„æºè°ƒåº¦ä¸»è¦çœ‹å“ªäº›èŠ‚ç‚¹å¯ä»¥å¯åŠ¨executorsï¼Œæ˜¯å¦èƒ½æ»¡è¶³executorsæ‰€éœ€çš„cpuæ•°é‡è¦æ±‚ï¼Œè¿™ä¸ªæ—¶å€™ï¼Œä¸ä¼šè€ƒè™‘ä»»åŠ¡ã€æ•°æ®æœ¬åœ°æ€§è¿™äº›å› ç´ ã€‚\n\nèµ„æºè°ƒåº¦å®Œæˆä¹‹åï¼Œåœ¨ä»»åŠ¡è°ƒåº¦é˜¶æ®µï¼Œsparkè´Ÿè´£è®¡ç®—æ¯ä¸ªä»»åŠ¡çš„æœ¬åœ°æ€§ï¼Œæ•ˆæœå°±æ˜¯taskæ˜ç¡®çŸ¥é“è‡ªå·±åº”è¯¥è°ƒåº¦åˆ°å“ªä¸ªèŠ‚ç‚¹ï¼Œç”šè‡³æ˜¯å“ªä¸ªexecutorsã€‚æœ€åscheduler Backendä¼šæŠŠtaskä»£ç ï¼Œåˆ†å‘åˆ°ç›®æ ‡èŠ‚ç‚¹çš„ç›®æ ‡executorsï¼Œå®Œæˆä»»åŠ¡è°ƒåº¦ï¼Œå®ç°æ•°æ®ä¸åŠ¨ä»£ç åŠ¨ã€‚\n\næ‰€ä»¥ï¼ŒäºŒè€…æ˜¯ç‹¬ç«‹çš„ï¼Œä¸èƒ½æ··ä¸ºä¸€è°ˆå“ˆï½","likes_number":1,"is_delete":false,"is_hidden":false,"ctime":1643189502,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":321330,"user_name":"pythonbug","can_delete":false,"product_type":"c1","uid":1487274,"ip_address":"","ucode":"1A70CA92FFF8EB","user_header":"https://wx.qlogo.cn/mmopen/vi_32/wgMMrp1hvSB3E30KqZvMsj3KQdAI3T1uQM77LT7hZ65nVSjPGRg3AbUOyiahnssA6AIT5PAkyHFmlTBzUH9gdyQ/132","comment_is_top":false,"comment_ctime":1636794681,"is_pvip":true,"replies":[{"id":"116843","content":"ç²¾è¾Ÿï¼ï¼ï¼èµğŸ‘ï¼Œé€»è¾‘ä¸Šå°±æ˜¯è¿™ä¸ªæ„æ€~","user_name":"ä½œè€…å›å¤","user_name_real":"å´ç£Š","uid":"1043100","ctime":1637058507,"ip_address":"","comment_id":321330,"utype":1}],"discussion_count":1,"race_medal":0,"score":"14521696569","product_id":100090001,"comment_content":"è€å¸ˆå¥½ï¼ŒTaskSchedulerè°ƒåº¦ä¼˜å…ˆçº§é‚£é‡Œæ˜¯ä¸æ˜¯å¯ä»¥è¿™æ ·ç†è§£ï¼š<br>for ä¼˜å…ˆçº§ &lt;- PROCESS_LOCAL to ANY {<br>  for task &lt;- task0 to taskn{<br>    if task0.locs == workoffer åˆ†é… else è·³è¿‡<br>  }<br>}","like_count":4,"discussions":[{"author":{"id":1043100,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/ea/9c/230061e7.jpg","nickname":"å´ç£Š","note":"","ucode":"136DC8CF1B10DC","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":530357,"discussion_content":"ç²¾è¾Ÿï¼ï¼ï¼èµğŸ‘ï¼Œé€»è¾‘ä¸Šå°±æ˜¯è¿™ä¸ªæ„æ€~","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1637058507,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":344656,"user_name":"æ˜Ÿæ½¼","can_delete":false,"product_type":"c1","uid":1008546,"ip_address":"","ucode":"D7C30CD2BEC78D","user_header":"https://static001.geekbang.org/account/avatar/00/0f/63/a2/abb7bfe3.jpg","comment_is_top":false,"comment_ctime":1651713198,"is_pvip":false,"discussion_count":1,"race_medal":0,"score":"10241647790","product_id":100090001,"comment_content":"æ„Ÿè°¢è€å¸ˆçš„ç²¾å½©è®²è§£ï¼Œæ”¶è·æ»¡æ»¡ã€‚ä½†å¯¹äºSchedulerBackendç®¡ç†Executorséƒ¨åˆ†æœ‰äº›ä¸ç†è§£ï¼Œæƒ³è¯·æ•™ä¸€ä¸‹è€å¸ˆã€‚<br>å‡­æˆ‘å¯¹Hadoop YARNçš„ç†è§£(å‡è®¾sparkè¿è¡Œåœ¨YARNç®¡ç†çš„é›†ç¾¤ä¸­)ï¼ŒRMæ˜¯æ•´ä¸ªé›†ç¾¤èµ„æºçš„ç®¡ç†è€…ï¼Œsparkåªæ˜¯æäº¤ç»™é›†ç¾¤çš„ä¸€ä¸ªJOBï¼ŒSparkä¸­çš„Driveråº”è¯¥å¯ä»¥å¯¹æ ‡åˆ°MRä¸­çš„ApplicationMasterã€‚ <br>é‚£ä¹ˆè¿™æ ·æƒ³çš„è¯ï¼Œåœ¨å‘é›†ç¾¤æäº¤sparkä½œä¸šä¹‹å‰ï¼Œé›†ç¾¤ä¸­æ˜¯ä¸å­˜åœ¨è¿™ä¸ªJobçš„Driverå’ŒExecutorçš„ã€‚åœ¨æäº¤sparkä½œä¸šåï¼Œåº”è¯¥ç”±Driverå…ˆå‘RMç”³è¯·èµ„æºï¼ŒRMå‘Driverè¿”å›åˆ†é…èµ„æºçš„èŠ‚ç‚¹ï¼ŒDriverå†ä¸å¯¹åº”èŠ‚ç‚¹ä¸Šçš„DMé€šä¿¡ï¼ŒDMå†å¯åŠ¨ä¸€ä¸ªExecutorè¿›ç¨‹ã€‚<br>ä½†ç›®å‰çœ‹æ–‡ç« çš„æè¿°ï¼Œè§‰å¾—Driverå’ŒExecutoræ˜¯ä¸€ç›´å­˜åœ¨äºé›†ç¾¤ä¸­çš„ï¼ŒDriveræ˜¯æ•´ä¸ªé›†ç¾¤èµ„æºçš„ç®¡ç†è€…ã€‚æˆ‘è®¤ä¸ºDriveråªæ˜¯ä¸€ä¸ªä½œä¸šçš„ç®¡ç†è€…ï¼ŒDriverå’ŒExecutoræ˜¯éšç€ä½œä¸šçš„è°ƒåº¦è¢«åˆ›å»ºï¼Œä½œä¸šæ‰§è¡Œå®Œå®ƒä»¬ä¹Ÿå°±æ¶ˆäº¡äº†ã€‚<br>æ‰€ä»¥è¿™é‡Œæƒ³è¯·æ•™ä¸€ä¸‹è€å¸ˆï¼Œå½“æˆ‘ä»¬æäº¤ä¸€ä¸ªsparkä½œä¸šåï¼Œæ˜¯å¦‚ä½•åˆ›å»ºå¯¹åº”çš„Driverå’Œæ‰€æœ‰çš„Executorçš„ï¼Ÿåˆ›å»ºçš„æµç¨‹æ˜¯ä»€ä¹ˆæ ·çš„ï¼Ÿè¯·æ‚¨æŒ‡æ•™ï¼ŒæœŸå¾…å›å¤^_^","like_count":2,"discussions":[{"author":{"id":1351248,"avatar":"https://static001.geekbang.org/account/avatar/00/14/9e/50/21e0beca.jpg","nickname":"kylin","note":"","ucode":"3588B62A4F9534","race_medal":0,"user_type":1,"is_pvip":true},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":586855,"discussion_content":"æˆ‘ä¹Ÿæœ‰è¿™ç§ç–‘æƒ‘ï¼Œå°¤å…¶æ˜¯Executorsï¼Œå®ƒåº”è¯¥æ˜¯å…·ä½“ä½œä¸šæ‰§è¡Œçš„æ—¶å€™åˆ›å»ºå‡ºæ¥çš„å§","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1662540803,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":"æ±Ÿè‹"},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":333239,"user_name":"è‰¾åˆ©ç‰¹-G","can_delete":false,"product_type":"c1","uid":1195204,"ip_address":"","ucode":"8C4DA0ABE77CDC","user_header":"https://static001.geekbang.org/account/avatar/00/12/3c/c4/4ee2968a.jpg","comment_is_top":false,"comment_ctime":1644225742,"is_pvip":false,"replies":[{"id":"122394","content":"è¿™é‡Œçš„å…³é”®ï¼Œè¿˜æ˜¯è¦åŒºåˆ†â€œèµ„æºè°ƒåº¦â€å’Œâ€œä»»åŠ¡è°ƒåº¦â€ï¼Œè¿™ä¸¤ä¸ªæ˜¯ç›¸å¯¹ç‹¬ç«‹çš„ç³»ç»Ÿã€‚èµ„æºè°ƒåº¦ä¸Yarnï¼Œåªå…³å¿ƒCPUã€å†…å­˜èµ„æºæ˜¯å¦å……è¶³ï¼Œä»è€Œå†³å®šæ˜¯å¦åœ¨NodeMgrä¸­å¯åŠ¨Executorsï¼›è€Œæ•°æ®åˆ†ç‰‡ä½ç½®ï¼ŒTaskå€¾å‘æ€§ï¼Œè¿™äº›æ˜¯ä»»åŠ¡è°ƒåº¦ç³»ç»Ÿå…³ç³»çš„å†…å®¹ã€‚ä¸¤ä¸ªç³»ç»Ÿç›¸äº’ç‹¬ç«‹ï¼Œä¿æŒæ¾è€¦åˆçš„å…³ç³»ï¼Œæ˜¯æ¯”è¾ƒå¥½çš„è®¾è®¡ã€‚å¦‚æœåœ¨èµ„æºè°ƒåº¦é˜¶æ®µï¼Œå°±å¼•å…¥ä¸ä»»åŠ¡ç›¸å…³çš„ä¿¡æ¯ï¼Œæ¯”å¦‚åˆ†ç‰‡ä½ç½®ï¼Œè¿™æ ·çš„ç³»ç»Ÿè®¾è®¡ä¼šå¾ˆå¤æ‚ã€å¾ˆéš¾ç»´æŠ¤ï¼ŒMapReduce V1å®é™…ä¸Šå°±æ˜¯è¿™æ ·çš„è®¾è®¡ï¼Œåæ¥åœ¨V2çš„æ—¶å€™ï¼Œå°±æŠŠYARNå•ç‹¬æ‹†å‡ºæ¥äº†ã€‚","user_name":"ä½œè€…å›å¤","user_name_real":"ç¼–è¾‘","uid":"1043100","ctime":1645369479,"ip_address":"","comment_id":333239,"utype":1}],"discussion_count":1,"race_medal":0,"score":"10234160334","product_id":100090001,"comment_content":"&gt; 2.SchedulerBackend é€šè¿‡ä¸ Executors ä¸­çš„ ExecutorBackend çš„äº¤äº’æ¥å®æ—¶åœ°è·å–é›†ç¾¤ä¸­å¯ç”¨çš„è®¡ç®—èµ„æºï¼Œå¹¶å°†è¿™äº›ä¿¡æ¯è®°å½•åˆ° ExecutorDataMap æ•°æ®ç»“æ„ã€‚<br>è¿™ä¸€æ­¥ä¸­ï¼Œå‡å¦‚æ•°æ®æ˜¯å­˜æ”¾åœ¨HDFSä¸­ï¼Œé‚£ä¹ˆSchedulerBackendé€šè¿‡è¯»å–HDFSçš„å…ƒæ•°æ®å°±çŸ¥é“äº†æŸä¸ªtaskæ‰€éœ€è¦çš„æ•°æ®åˆ†ç‰‡åœ¨å“ªä¸ªDataNode(YARN&#47;Spark worker node)ã€‚<br>è¿™ä¸ªæ—¶å€™ä¸ºäº†çŸ¥é“è¯¥DataNodeçš„è®¡ç®—èµ„æºï¼Œä¸éœ€è¦å®é™…åœ°å¯åŠ¨ä¸€ä¸ªexecutorï¼Œåªéœ€è¦å‘YARN NodeManager(æˆ–è€…åˆ«çš„èµ„æºè°ƒåº¦æ¡†æ¶ä¸­çš„worker daemon)è¯¢é—®ä¸€ä¸‹å°±çŸ¥é“äº†å§ï¼Ÿ","like_count":2,"discussions":[{"author":{"id":1043100,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/ea/9c/230061e7.jpg","nickname":"å´ç£Š","note":"","ucode":"136DC8CF1B10DC","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":552253,"discussion_content":"è¿™é‡Œçš„å…³é”®ï¼Œè¿˜æ˜¯è¦åŒºåˆ†â€œèµ„æºè°ƒåº¦â€å’Œâ€œä»»åŠ¡è°ƒåº¦â€ï¼Œè¿™ä¸¤ä¸ªæ˜¯ç›¸å¯¹ç‹¬ç«‹çš„ç³»ç»Ÿã€‚èµ„æºè°ƒåº¦ä¸Yarnï¼Œåªå…³å¿ƒCPUã€å†…å­˜èµ„æºæ˜¯å¦å……è¶³ï¼Œä»è€Œå†³å®šæ˜¯å¦åœ¨NodeMgrä¸­å¯åŠ¨Executorsï¼›è€Œæ•°æ®åˆ†ç‰‡ä½ç½®ï¼ŒTaskå€¾å‘æ€§ï¼Œè¿™äº›æ˜¯ä»»åŠ¡è°ƒåº¦ç³»ç»Ÿå…³ç³»çš„å†…å®¹ã€‚ä¸¤ä¸ªç³»ç»Ÿç›¸äº’ç‹¬ç«‹ï¼Œä¿æŒæ¾è€¦åˆçš„å…³ç³»ï¼Œæ˜¯æ¯”è¾ƒå¥½çš„è®¾è®¡ã€‚å¦‚æœåœ¨èµ„æºè°ƒåº¦é˜¶æ®µï¼Œå°±å¼•å…¥ä¸ä»»åŠ¡ç›¸å…³çš„ä¿¡æ¯ï¼Œæ¯”å¦‚åˆ†ç‰‡ä½ç½®ï¼Œè¿™æ ·çš„ç³»ç»Ÿè®¾è®¡ä¼šå¾ˆå¤æ‚ã€å¾ˆéš¾ç»´æŠ¤ï¼ŒMapReduce V1å®é™…ä¸Šå°±æ˜¯è¿™æ ·çš„è®¾è®¡ï¼Œåæ¥åœ¨V2çš„æ—¶å€™ï¼Œå°±æŠŠYARNå•ç‹¬æ‹†å‡ºæ¥äº†ã€‚","likes_number":1,"is_delete":false,"is_hidden":false,"ctime":1645369479,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":320118,"user_name":"D.C","can_delete":false,"product_type":"c1","uid":1115215,"ip_address":"","ucode":"AA79F04070A64D","user_header":"https://static001.geekbang.org/account/avatar/00/11/04/4f/f5ef8a2a.jpg","comment_is_top":false,"comment_ctime":1636086266,"is_pvip":false,"replies":[{"id":"116034","content":"å¯ä»¥çš„~ ä¼˜å…ˆæ ¹æ®locality preferenceæ¥ï¼Œ<br><br>PROCESS_LOCAL -&gt; NODE_LOCAL -&gt; RACK_LOCALï¼Œwaitæ—¶é—´è¶…æ—¶ä¹‹åï¼Œå°±éšæœºåˆ†å‘äº†ï¼Œå˜æˆANY","user_name":"ä½œè€…å›å¤","user_name_real":"å´ç£Š","uid":"1043100","ctime":1636092300,"ip_address":"","comment_id":320118,"utype":1}],"discussion_count":1,"race_medal":0,"score":"10226020858","product_id":100090001,"comment_content":"ä¸€ä¸ªtaskSetä¸‹çš„ä¸åŒtaskï¼Œå¯ä»¥åˆ†é…åˆ°åŒä¸€ä¸ªexecutorsä¹ˆï¼Ÿ","like_count":2,"discussions":[{"author":{"id":1043100,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/ea/9c/230061e7.jpg","nickname":"å´ç£Š","note":"","ucode":"136DC8CF1B10DC","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":529881,"discussion_content":"å¯ä»¥çš„~ ä¼˜å…ˆæ ¹æ®locality preferenceæ¥ï¼Œ\n\nPROCESS_LOCAL -&amp;gt; NODE_LOCAL -&amp;gt; RACK_LOCALï¼Œwaitæ—¶é—´è¶…æ—¶ä¹‹åï¼Œå°±éšæœºåˆ†å‘äº†ï¼Œå˜æˆANY","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1636092300,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":317681,"user_name":"bian","can_delete":false,"product_type":"c1","uid":1222371,"ip_address":"","ucode":"38D918F2ABF058","user_header":"","comment_is_top":false,"comment_ctime":1634888669,"is_pvip":false,"replies":[{"id":"115141","content":"å–œæ¬¢å°±å¥½å“ˆ~","user_name":"ä½œè€…å›å¤","user_name_real":"å´ç£Š","uid":"1043100","ctime":1634890994,"ip_address":"","comment_id":317681,"utype":1}],"discussion_count":1,"race_medal":0,"score":"10224823261","product_id":100090001,"comment_content":"è¿™ç« çœŸçš„æ˜¯å°†æ‰§è¡Œæµç¨‹è®²çš„æ£’æäº†","like_count":2,"discussions":[{"author":{"id":1043100,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/ea/9c/230061e7.jpg","nickname":"å´ç£Š","note":"","ucode":"136DC8CF1B10DC","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":528928,"discussion_content":"å–œæ¬¢å°±å¥½å“ˆ~","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1634890994,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":340173,"user_name":"åæœˆ","can_delete":false,"product_type":"c1","uid":2955154,"ip_address":"","ucode":"95877CD3753595","user_header":"https://static001.geekbang.org/account/avatar/00/2d/17/92/0af520ef.jpg","comment_is_top":false,"comment_ctime":1648641923,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"5943609219","product_id":100090001,"comment_content":"ç®€ç›´æ˜¯é†é†ç½ä½“ï¼æ–¯å·´å…‹å…¬å¸çš„ä¾‹å­æˆ‘æ„¿ç§°ä¹‹ä¸ºç¥æ¯”å–»","like_count":1},{"had_liked":false,"id":314205,"user_name":"Unknown element","can_delete":false,"product_type":"c1","uid":2028277,"ip_address":"","ucode":"34A129800D0238","user_header":"https://static001.geekbang.org/account/avatar/00/1e/f2/f5/b82f410d.jpg","comment_is_top":false,"comment_ctime":1632898136,"is_pvip":false,"replies":[{"id":"113797","content":"nodel_localï¼Œæ˜¯è¯´å·²çŸ¥æ•°æ®åœ¨æŸä¸ªèŠ‚ç‚¹ä¸Šï¼ŒSchedulerå¯ä»¥æŠŠä»£ç è°ƒåº¦åˆ°é‚£ä¸ªç›®æ ‡èŠ‚ç‚¹ï¼Œç›®æ ‡èŠ‚ç‚¹ä¸Šï¼ŒåŒ…å«æœ‰ä»£ç æ‰€éœ€çš„æ•°æ®ï¼Œå› æ­¤ï¼Œæ­¤æ—¶æ˜¯â€œæ•°æ®ä¸åŠ¨ï¼Œä»£ç åŠ¨â€~<br><br>è€Œrack_localï¼Œæ˜¯è¯´ä»…ä»…çŸ¥é“æ•°æ®åœ¨æŸä¸ªæœºæ¶å†…ï¼ˆä¸€ä¸ªæœºæ¶åŒ…å«å¤šå°æœºå™¨ï¼‰ï¼Œä½†ä¸ç¡®å®šåœ¨å“ªå°æœºå™¨èŠ‚ç‚¹ä¸Šï¼Œæ‰€ä»¥è¯´ï¼ŒScheduleråªèƒ½æŠŠä»£ç è°ƒåº¦åˆ°é‚£ä¸ªæœºæ¶ä¸Šéšæ„ä¸€ä¸ªèŠ‚ç‚¹ï¼Œæ¯”å¦‚è¯´èŠ‚ç‚¹node01ï¼Œä½†æ˜¯ï¼Œè°ƒåº¦ç»™node01çš„ä»£ç ï¼Œæ‰€éœ€è¦çš„æ•°æ®ï¼Œå®é™…ä¸Šå­˜å‚¨åœ¨åŒä¸€ä¸ªæœºæ¶çš„node02ä¸Šã€‚å› æ­¤ï¼Œæ•°æ®è¿˜æ˜¯è¦é€šè¿‡ç½‘ç»œï¼Œä»node02ä¼ é€’åˆ°node01ã€‚è¿™ä¸ªæ—¶å€™ï¼Œå°±æ˜¯æ‰€è°“çš„â€œæ•°æ®åŠ¨äº†ï¼Œä»£ç ä¹ŸåŠ¨äº†â€~","user_name":"ä½œè€…å›å¤","user_name_real":"å´ç£Š","uid":"1043100","ctime":1632909054,"ip_address":"","comment_id":314205,"utype":1}],"discussion_count":2,"race_medal":0,"score":"5927865432","product_id":100090001,"comment_content":"æœºæ¶å°±æ˜¯ç‰©ç†ä¸Šçš„â€œé“æ¶â€å— é‚£ rack_local å’Œ node_local æœ‰ä»€ä¹ˆåŒºåˆ«å‘¢","like_count":1,"discussions":[{"author":{"id":1043100,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/ea/9c/230061e7.jpg","nickname":"å´ç£Š","note":"","ucode":"136DC8CF1B10DC","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":527612,"discussion_content":"nodel_localï¼Œæ˜¯è¯´å·²çŸ¥æ•°æ®åœ¨æŸä¸ªèŠ‚ç‚¹ä¸Šï¼ŒSchedulerå¯ä»¥æŠŠä»£ç è°ƒåº¦åˆ°é‚£ä¸ªç›®æ ‡èŠ‚ç‚¹ï¼Œç›®æ ‡èŠ‚ç‚¹ä¸Šï¼ŒåŒ…å«æœ‰ä»£ç æ‰€éœ€çš„æ•°æ®ï¼Œå› æ­¤ï¼Œæ­¤æ—¶æ˜¯â€œæ•°æ®ä¸åŠ¨ï¼Œä»£ç åŠ¨â€~\n\nè€Œrack_localï¼Œæ˜¯è¯´ä»…ä»…çŸ¥é“æ•°æ®åœ¨æŸä¸ªæœºæ¶å†…ï¼ˆä¸€ä¸ªæœºæ¶åŒ…å«å¤šå°æœºå™¨ï¼‰ï¼Œä½†ä¸ç¡®å®šåœ¨å“ªå°æœºå™¨èŠ‚ç‚¹ä¸Šï¼Œæ‰€ä»¥è¯´ï¼ŒScheduleråªèƒ½æŠŠä»£ç è°ƒåº¦åˆ°é‚£ä¸ªæœºæ¶ä¸Šéšæ„ä¸€ä¸ªèŠ‚ç‚¹ï¼Œæ¯”å¦‚è¯´èŠ‚ç‚¹node01ï¼Œä½†æ˜¯ï¼Œè°ƒåº¦ç»™node01çš„ä»£ç ï¼Œæ‰€éœ€è¦çš„æ•°æ®ï¼Œå®é™…ä¸Šå­˜å‚¨åœ¨åŒä¸€ä¸ªæœºæ¶çš„node02ä¸Šã€‚å› æ­¤ï¼Œæ•°æ®è¿˜æ˜¯è¦é€šè¿‡ç½‘ç»œï¼Œä»node02ä¼ é€’åˆ°node01ã€‚è¿™ä¸ªæ—¶å€™ï¼Œå°±æ˜¯æ‰€è°“çš„â€œæ•°æ®åŠ¨äº†ï¼Œä»£ç ä¹ŸåŠ¨äº†â€~","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1632909054,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1048441,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/ff/79/f400c4d1.jpg","nickname":"douge","note":"","ucode":"A6EB1AA3D53516","race_medal":0,"user_type":1,"is_pvip":true},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":589733,"discussion_content":"ä¸€ä¸ªæœºæ¶åŒ…å«å¤šä¸ªèŠ‚ç‚¹ï¼Œä¸€èˆ¬è¿åœ¨åŒä¸€ä¸ªäº¤æ¢æœºï¼Œæ‰€ä»¥äº’è”é€Ÿåº¦å¿«ï¼Œè·¨æœºæ¶æ…¢ä¸€äº›","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1665292483,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":"å±±ä¸œ"},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":314063,"user_name":"åŠ ä¹˜î”","can_delete":false,"product_type":"c1","uid":1766461,"ip_address":"","ucode":"6AE69CE2A3196A","user_header":"https://static001.geekbang.org/account/avatar/00/1a/f4/3d/d4ddbe31.jpg","comment_is_top":false,"comment_ctime":1632822543,"is_pvip":false,"replies":[{"id":"113783","content":"å¥½é—®é¢˜ï¼Œé€šå¸¸æ¥è¯´ï¼ŒSparkä¸HDFSéƒ½æ˜¯éƒ¨ç½²åœ¨åŒä¸€ä¸ªé›†ç¾¤ï¼Œæ‰€ä»¥Executorså’ŒHDFSæ˜¯åˆ†æ•£åœ¨åŒä¸€ä¸ªé›†ç¾¤ã€‚ä½†æ˜¯ï¼ŒExecutorsæ‰€éœ€çš„æ•°æ®åˆ†åŒºï¼Œä¸è§å¾—æ˜¯åœ¨åŒä¸€ä¸ªè®¡ç®—èŠ‚ç‚¹ã€‚<br><br>è€Œè¿™ï¼Œå°±æ˜¯è°ƒåº¦ç³»ç»Ÿçš„ä»·å€¼ä¹‹ä¸€ï¼ŒæŠŠtaskä»£ç ï¼Œåˆ†å‘åˆ°æ•°æ®åˆ†åŒºæ‰€åœ¨çš„èŠ‚ç‚¹ä¸Šçš„Executorï¼Œä»è€Œä¿è¯node_localçš„æœ¬åœ°æ€§çº§åˆ«ã€‚<br><br>è€Œä¸æ˜¯æŠŠtaskéšæ„åˆ†å‘åˆ°ä»»æ„èµ„æºå……è¶³çš„èŠ‚ç‚¹ï¼Œç„¶åå†æŠŠå¯¹åº”çš„æ‰€éœ€æ•°æ®æ‹‰è¿‡æ¥ã€‚<br><br>è¿™ä¸ªå°±æ˜¯æ‰€è°“çš„ï¼šæ•°æ®ä¸åŠ¨ä»£ç åŠ¨ï½","user_name":"ä½œè€…å›å¤","user_name_real":"å´ç£Š","uid":"1043100","ctime":1632879829,"ip_address":"","comment_id":314063,"utype":1}],"discussion_count":2,"race_medal":0,"score":"5927789839","product_id":100090001,"comment_content":"è€å¸ˆå¥½ï¼Œæœ‰ä¸ªåŸºç¡€çš„é—®é¢˜ï¼Œæ²¡å¤ªæ˜ç™½ï¼Œå°±æ˜¯æ–‡ä¸­è¯´åˆ°â€œå½“æˆ‘ä»¬è°ƒç”¨ textFile API ä» HDFS æ–‡ä»¶ç³»ç»Ÿä¸­è¯»å–æºæ–‡ä»¶æ—¶ï¼ŒSpark ä¼šæ ¹æ® HDFS NameNode å½“ä¸­è®°å½•çš„å…ƒæ•°æ®......â€æ—¶ï¼Œæ•°æ®å’ŒExecutorsåº”è¯¥ä¸åœ¨ä¸€ä¸ªç‰©ç†æœºå™¨ä¸Šå§ï¼Œé‚£ä¹ˆExecutorsæ‰§è¡Œçš„æ—¶å€™ï¼Œæ˜¯åˆ°æ•°æ®èŠ‚ç‚¹çš„æœºå™¨ä¸Šè¯»å–æ•°æ®å†è¿›è¡Œå¤„ç†å—ï¼Ÿ<br>åé¢åˆæåˆ°â€œæ•°æ®ä¸åŠ¨ï¼Œä»£ç åŠ¨â€ï¼Œæ„Ÿè§‰åº”è¯¥æ˜¯æŠŠä»£ç å‘åˆ°æ•°æ®èŠ‚ç‚¹ï¼Œç„¶ååœ¨æ•°æ®èŠ‚ç‚¹ä¸Šè¿›è¡Œè®¡ç®—å¤„ç†ã€‚ç„¶åå†è¿”å›ç»™Executorsæ‰§è¡Œç»“æœï¼Œè¿™æ ·ç†è§£å¯¹å—ï¼Ÿ","like_count":1,"discussions":[{"author":{"id":1043100,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/ea/9c/230061e7.jpg","nickname":"å´ç£Š","note":"","ucode":"136DC8CF1B10DC","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":527563,"discussion_content":"å¥½é—®é¢˜ï¼Œé€šå¸¸æ¥è¯´ï¼ŒSparkä¸HDFSéƒ½æ˜¯éƒ¨ç½²åœ¨åŒä¸€ä¸ªé›†ç¾¤ï¼Œæ‰€ä»¥Executorså’ŒHDFSæ˜¯åˆ†æ•£åœ¨åŒä¸€ä¸ªé›†ç¾¤ã€‚ä½†æ˜¯ï¼ŒExecutorsæ‰€éœ€çš„æ•°æ®åˆ†åŒºï¼Œä¸è§å¾—æ˜¯åœ¨åŒä¸€ä¸ªè®¡ç®—èŠ‚ç‚¹ã€‚\n\nè€Œè¿™ï¼Œå°±æ˜¯è°ƒåº¦ç³»ç»Ÿçš„ä»·å€¼ä¹‹ä¸€ï¼ŒæŠŠtaskä»£ç ï¼Œåˆ†å‘åˆ°æ•°æ®åˆ†åŒºæ‰€åœ¨çš„èŠ‚ç‚¹ä¸Šçš„Executorï¼Œä»è€Œä¿è¯node_localçš„æœ¬åœ°æ€§çº§åˆ«ã€‚\n\nè€Œä¸æ˜¯æŠŠtaskéšæ„åˆ†å‘åˆ°ä»»æ„èµ„æºå……è¶³çš„èŠ‚ç‚¹ï¼Œç„¶åå†æŠŠå¯¹åº”çš„æ‰€éœ€æ•°æ®æ‹‰è¿‡æ¥ã€‚\n\nè¿™ä¸ªå°±æ˜¯æ‰€è°“çš„ï¼šæ•°æ®ä¸åŠ¨ä»£ç åŠ¨ï½","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1632879829,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":2861352,"avatar":"","nickname":"é˜¿ç‹¸å¼Ÿå¼Ÿçš„åŒ…å­åº—","note":"","ucode":"0CCF598B029075","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":548514,"discussion_content":"driverå‘é€ç»™executorçš„taskä¸­å·²ç»åŒ…æ‹¬äº†hdfsçš„åˆ†åŒºä¿¡æ¯ï¼Œè¿™æ ·executoræ ¹æ®åˆ†åŒºä¿¡æ¯ç›´æ¥å»æ‹‰hdfsçš„æ•°æ®å—å³å¯ï¼Œå¹¶ä¸æ˜¯driverå°†æ•°æ®å‘ç»™äº†executorã€‚æˆ‘ç†è§£çš„æ²¡é”™å§","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1643246136,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":313076,"user_name":"è™¹æ¡¥å¿µè‹","can_delete":false,"product_type":"c1","uid":1109582,"ip_address":"","ucode":"495C023F6CB96C","user_header":"https://static001.geekbang.org/account/avatar/00/10/ee/4e/70227e09.jpg","comment_is_top":false,"comment_ctime":1632271092,"is_pvip":false,"replies":[{"id":"113426","content":"è°¢è°¢åé¦ˆå“ˆï½ ç¡®å®ï¼Œä¸ºäº†ç…§é¡¾å¤§å¤šæ•°æ–°åŒå­¦ï¼Œæˆ‘ä»¬ä¼šç”¨å¤§é‡çš„æ•…äº‹å’Œç”Ÿæ´»åŒ–ç±»æ¯”ï¼Œç›®çš„æ˜¯é™ä½å¤§å®¶çš„å­¦ä¹ æˆæœ¬ï¼Œè¿™æ ·å³ä¾¿åœ¨åœ°é“ä¸Šï¼Œå­¦èµ·æ¥ä¹Ÿä¼šè½»æ¾ä¸€äº›ï½ <br><br>è€å¼Ÿå¦‚æœæœ‰ä¸€å®šåŸºç¡€çš„è¯ï¼Œæ¨èä¸å¦¨äº†è§£ä¸‹ã€ŠSparkæ€§èƒ½è°ƒä¼˜å®æˆ˜ã€‹å“ˆï½ æœ‰ç‚¹å¤¹å¸¦ç§è´§çš„å«Œç–‘ï¼Œå“ˆå“ˆå“ˆ","user_name":"ä½œè€…å›å¤","user_name_real":"å´ç£Š","uid":"1043100","ctime":1632283222,"ip_address":"","comment_id":313076,"utype":1}],"discussion_count":4,"race_medal":0,"score":"5927238388","product_id":100090001,"comment_content":"è™½è¯´å¾ˆå½¢è±¡ï¼Œä½†æœ‰ç‚¹å•°å—¦ï¼Œå­¦ä¹ è¿˜æ˜¯å–œæ¬¢å¹²è´§æ»¡æ»¡ï¼Œå¯èƒ½æ¯”è¾ƒé€‚åˆå®Œå…¨é›¶åŸºç¡€çš„åŒå­¦å§","like_count":1,"discussions":[{"author":{"id":1043100,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/ea/9c/230061e7.jpg","nickname":"å´ç£Š","note":"","ucode":"136DC8CF1B10DC","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":527218,"discussion_content":"è°¢è°¢åé¦ˆå“ˆï½ ç¡®å®ï¼Œä¸ºäº†ç…§é¡¾å¤§å¤šæ•°æ–°åŒå­¦ï¼Œæˆ‘ä»¬ä¼šç”¨å¤§é‡çš„æ•…äº‹å’Œç”Ÿæ´»åŒ–ç±»æ¯”ï¼Œç›®çš„æ˜¯é™ä½å¤§å®¶çš„å­¦ä¹ æˆæœ¬ï¼Œè¿™æ ·å³ä¾¿åœ¨åœ°é“ä¸Šï¼Œå­¦èµ·æ¥ä¹Ÿä¼šè½»æ¾ä¸€äº›ï½ \n\nè€å¼Ÿå¦‚æœæœ‰ä¸€å®šåŸºç¡€çš„è¯ï¼Œæ¨èä¸å¦¨äº†è§£ä¸‹ã€ŠSparkæ€§èƒ½è°ƒä¼˜å®æˆ˜ã€‹å“ˆï½ æœ‰ç‚¹å¤¹å¸¦ç§è´§çš„å«Œç–‘ï¼Œå“ˆå“ˆå“ˆ","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1632283222,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":2688429,"avatar":"https://static001.geekbang.org/account/avatar/00/29/05/ad/e2265f63.jpg","nickname":"promise","note":"","ucode":"906961B12C18C4","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":546237,"discussion_content":"ä¹ æƒ¯çº¯è®¡ç®—æœºæ€ç»´ä¹‹åï¼Œä¸¾ç”Ÿæ´»åŒ–ä¾‹å­æ„Ÿè§‰åªæ˜¯å¢åŠ ä¿¡æ¯å¢’å’Œnoiseï¼Œç»™å­¦ä¹ å¸¦æ¥éšœç¢ã€‚çœ‹äº†å¥½å‡ ä¸ªè¯¾éƒ½æ˜¯è¿™ä¸ªç”»é£ï¼Œå¹²è´§æ³¨æ°´ğŸ˜‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1642246378,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1109582,"avatar":"https://static001.geekbang.org/account/avatar/00/10/ee/4e/70227e09.jpg","nickname":"è™¹æ¡¥å¿µè‹","note":"","ucode":"495C023F6CB96C","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":395717,"discussion_content":"ä¹‹å‰çŸ­æš‚ç”¨è¿‡sparkï¼Œåé¢ä¸€ç›´åšflinkï¼Œå‘ç°sparkè¿˜æ˜¯è›®é‡è¦çš„ï¼Œæ‚¨çš„ä¸¤é—¨sparkéƒ½å·²è®¢é˜…ï¼Œå“ˆå“ˆå“ˆï¼Œä»¥åè·Ÿç€å´è€å¸ˆå¤šå¤šæˆé•¿","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1632324638,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":1,"child_discussions":[{"author":{"id":1043100,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/ea/9c/230061e7.jpg","nickname":"å´ç£Š","note":"","ucode":"136DC8CF1B10DC","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":1109582,"avatar":"https://static001.geekbang.org/account/avatar/00/10/ee/4e/70227e09.jpg","nickname":"è™¹æ¡¥å¿µè‹","note":"","ucode":"495C023F6CB96C","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":395752,"discussion_content":"è€å¼Ÿå®¢æ°”ï¼Œä¸€èµ·åŠ æ²¹~ ğŸ†™","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1632326893,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":395717,"ip_address":""},"score":395752,"extra":""}]}]},{"had_liked":false,"id":356992,"user_name":"æ— éš…","can_delete":false,"product_type":"c1","uid":1058801,"ip_address":"å¹¿ä¸œ","ucode":"756E8D6E915FF0","user_header":"https://static001.geekbang.org/account/avatar/00/10/27/f1/e4fc57a3.jpg","comment_is_top":false,"comment_ctime":1662802927,"is_pvip":true,"discussion_count":0,"race_medal":0,"score":"1662802927","product_id":100090001,"comment_content":"è¦æ˜¯æœ‰æ— æ¯”å–»çš„æ¸…æ°´ç‰ˆå°±å¥½äº†","like_count":0},{"had_liked":false,"id":346594,"user_name":"åˆ˜ç¾½å„¿","can_delete":false,"product_type":"c1","uid":2809636,"ip_address":"","ucode":"8D280A4EBBC4BE","user_header":"https://static001.geekbang.org/account/avatar/00/2a/df/24/04ce86da.jpg","comment_is_top":false,"comment_ctime":1653272764,"is_pvip":false,"discussion_count":1,"race_medal":0,"score":"1653272764","product_id":100090001,"comment_content":"è¯·é—®è€å¸ˆï¼Œsparkåº•å±‚æ˜¯æ€ä¹ˆåˆ¤æ–­æŸä¸ªç®—å­æ˜¯éœ€è¦è¿›è¡Œshuffleçš„å‘¢ï¼Ÿ","like_count":0,"discussions":[{"author":{"id":1048441,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/ff/79/f400c4d1.jpg","nickname":"douge","note":"","ucode":"A6EB1AA3D53516","race_medal":0,"user_type":1,"is_pvip":true},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":589734,"discussion_content":"æ ¹æ®ç®—å­å’Œåˆ†åŒºï¼Œä¸åŒç®—å­åŠä¸åŒåˆ†åŒºéƒ½æœ‰å¯èƒ½å½±å“æ˜¯å¦shuffle ï¼Œæœ‰æœ¬sparkä¹¦è¯¦ç»†åˆ†æäº†æ¯ç§ç®—å­æ˜¯å¦éœ€è¦shuffleï¼Œå¯ä»¥å‚è€ƒä¸‹","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1665292815,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":"å±±ä¸œ"},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":345961,"user_name":"æœ‰ç‚¹å¿™","can_delete":false,"product_type":"c1","uid":1748720,"ip_address":"","ucode":"C82D787567E849","user_header":"https://static001.geekbang.org/account/avatar/00/1a/ae/f0/56ddebdd.jpg","comment_is_top":false,"comment_ctime":1652717986,"is_pvip":true,"discussion_count":0,"race_medal":0,"score":"1652717986","product_id":100090001,"comment_content":"æˆ‘è¦å¤šçœ‹å‡ éï¼Œç„¶åç»™é¢è¯•å®˜è®²ä¸€éï¼Œä¹‹å‰å¯¹è¿™å—åªæœ‰å¤§æ¦‚äº†è§£ï¼Œçœ‹å®Œè¿™ä¸ªï¼Œæˆ‘è§‰å¾—å¯ä»¥è®²åå¤šåˆ†é’Ÿäº†ï¼Œåè¾¹åº”è¯¥è¿˜æœ‰æƒŠå–œ","like_count":0},{"had_liked":false,"id":338439,"user_name":"éª¨æ±¤é¸¡è›‹é¢","can_delete":false,"product_type":"c1","uid":1050002,"ip_address":"","ucode":"2AC141A523E710","user_header":"https://static001.geekbang.org/account/avatar/00/10/05/92/b609f7e3.jpg","comment_is_top":false,"comment_ctime":1647504472,"is_pvip":true,"discussion_count":0,"race_medal":0,"score":"1647504472","product_id":100090001,"comment_content":"è¯·é—®ä¸‹è€å¸ˆï¼ŒtaskBinary å…·ä½“æ˜¯ä»€ä¹ˆå½¢å¼å‘¢ï¼Ÿå’Œhaddop çš„MapReduce åˆ†å‘ä¸€æ ·å˜›ï¼Ÿ","like_count":0},{"had_liked":false,"id":336225,"user_name":"èŠ±ç”Ÿè€¿","can_delete":false,"product_type":"c1","uid":1880923,"ip_address":"","ucode":"509DF5E77CECF2","user_header":"http://thirdwx.qlogo.cn/mmopen/vi_32/qicejJNHoVjX73w3hkw9RDGwgSLchAU8X6ibbdO8PhBJXGPuB2icbm3f4b74v7DWdTQic4gX6WSQS3M5THMhRoGlzA/132","comment_is_top":false,"comment_ctime":1646014867,"is_pvip":true,"replies":[{"id":"123246","content":"æŠ±æ­‰è€å¼Ÿ~ å¤šä¸€äº›æ‹Ÿäººã€ç±»æ¯”ï¼Œä¸»è¦æ˜¯ä¸ºäº†å¢åŠ å­¦ä¹ çš„è¶£å‘³æ€§ï¼Œå¤šä¸€äº›ç”Ÿæ´»åŒ–è”æƒ³ï¼Œå¾ˆå¤šå¤æ‚çš„æ¦‚å¿µï¼Œä¹Ÿä¼šè®°å¾—æ›´ç‰¢é ä¸€äº›~","user_name":"ä½œè€…å›å¤","user_name_real":"ç¼–è¾‘","uid":"1043100","ctime":1646724801,"ip_address":"","comment_id":336225,"utype":1}],"discussion_count":2,"race_medal":0,"score":"1646014867","product_id":100090001,"comment_content":"è€å¸ˆï¼Œæˆ‘æ˜¯sparké›¶åŸºç¡€ã€‚è¿™ä¸ªä¾‹å­ä¸­çš„ä¸€å †ä¸­æ–‡åå­—åè€Œå¢åŠ äº†ç†è§£çš„éš¾åº¦ï¼Œæˆ‘å»ºè®®ç›´æ¥æŠŠé‡Œé¢çš„è§’è‰²ç›´æ¥æ›¿æ¢æˆçœŸå®çš„ç»„ä»¶æ›´å®¹æ˜“ç†è§£ï¼Œè¦ä¸ç„¶è¿˜å¾—ä¸€è¾¹çœ‹ä¸­æ–‡åå­—ï¼Œä¸€è¾¹è·Ÿé‚£ä¸ªç»„ä»¶å¯¹åº”ã€‚","like_count":0,"discussions":[{"author":{"id":1043100,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/ea/9c/230061e7.jpg","nickname":"å´ç£Š","note":"","ucode":"136DC8CF1B10DC","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":555030,"discussion_content":"æŠ±æ­‰è€å¼Ÿ~ å¤šä¸€äº›æ‹Ÿäººã€ç±»æ¯”ï¼Œä¸»è¦æ˜¯ä¸ºäº†å¢åŠ å­¦ä¹ çš„è¶£å‘³æ€§ï¼Œå¤šä¸€äº›ç”Ÿæ´»åŒ–è”æƒ³ï¼Œå¾ˆå¤šå¤æ‚çš„æ¦‚å¿µï¼Œä¹Ÿä¼šè®°å¾—æ›´ç‰¢é ä¸€äº›~","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1646724801,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":2955154,"avatar":"https://static001.geekbang.org/account/avatar/00/2d/17/92/0af520ef.jpg","nickname":"åæœˆ","note":"","ucode":"95877CD3753595","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":559191,"discussion_content":"å°†ç»„ä»¶çš„è‹±æ–‡åå¯¹åº”åˆ°ä¸€ä¸ªä¸­æ–‡åæ›´æ–¹ä¾¿è®°å¿†å§","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1648642169,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":332259,"user_name":"åº·","can_delete":false,"product_type":"c1","uid":2621850,"ip_address":"","ucode":"C3E85292E026D5","user_header":"https://static001.geekbang.org/account/avatar/00/28/01/9a/d2831441.jpg","comment_is_top":false,"comment_ctime":1643119045,"is_pvip":false,"replies":[{"id":"121403","content":"æ„Ÿè°¢è€å¼Ÿè®¤å¯~","user_name":"ä½œè€…å›å¤","user_name_real":"ç¼–è¾‘","uid":"1043100","ctime":1643189064,"ip_address":"","comment_id":332259,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1643119045","product_id":100090001,"comment_content":"è€å¸ˆè®²çš„å¤ªå¥½äº†","like_count":0,"discussions":[{"author":{"id":1043100,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/ea/9c/230061e7.jpg","nickname":"å´ç£Š","note":"","ucode":"136DC8CF1B10DC","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":548423,"discussion_content":"æ„Ÿè°¢è€å¼Ÿè®¤å¯~","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1643189064,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":325718,"user_name":"liugddx","can_delete":false,"product_type":"c1","uid":1016163,"ip_address":"","ucode":"FDB66E03A74422","user_header":"https://static001.geekbang.org/account/avatar/00/0f/81/63/2ceecb43.jpg","comment_is_top":false,"comment_ctime":1639105575,"is_pvip":false,"replies":[{"id":"118185","content":"ä»¥Shuffleä¸ºè¾¹ç•Œï¼Œåˆ’åˆ†Stages","user_name":"ä½œè€…å›å¤","user_name_real":"ç¼–è¾‘","uid":"1043100","ctime":1639149741,"ip_address":"","comment_id":325718,"utype":1}],"discussion_count":2,"race_medal":0,"score":"1639105575","product_id":100090001,"comment_content":"æˆ‘æƒ³é—®ä¸‹ï¼ŒDAGScheduleråˆ’åˆ†stageä¸ºå•¥æ˜¯æŒ‰ç…§shuffleå€’æ¨å‘¢ï¼Ÿ","like_count":0,"discussions":[{"author":{"id":1043100,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/ea/9c/230061e7.jpg","nickname":"å´ç£Š","note":"","ucode":"136DC8CF1B10DC","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":537723,"discussion_content":"ä»¥Shuffleä¸ºè¾¹ç•Œï¼Œåˆ’åˆ†Stages","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1639149741,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1048441,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/ff/79/f400c4d1.jpg","nickname":"douge","note":"","ucode":"A6EB1AA3D53516","race_medal":0,"user_type":1,"is_pvip":true},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":589735,"discussion_content":"å› ä¸ºshuffleä¸èƒ½pipelineå¤„ç†äº†ï¼Œå¿…é¡»ç­‰åˆ°å…¶ä»–åˆ†åŒºå¤„ç†å®Œï¼Œä»¥å·¥å‚æµæ°´çº¿ä¸ºä¾‹ï¼Œä½ çš„å·¥ä½œå¿…é¡»ç­‰å…¶ä»–å·¥åºå®Œæˆæ‰èƒ½ç»§ç»­å·¥ä½œ","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1665293026,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":"å±±ä¸œ"},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":325462,"user_name":"å“‡å¡","can_delete":false,"product_type":"c1","uid":2639609,"ip_address":"","ucode":"C7340DD79BF02E","user_header":"","comment_is_top":false,"comment_ctime":1638964874,"is_pvip":true,"replies":[{"id":"118124","content":"å“ˆå“ˆï¼Œè€å¼Ÿå–œæ¬¢å°±å¥½~","user_name":"ä½œè€…å›å¤","user_name_real":"ç¼–è¾‘","uid":"1043100","ctime":1639045594,"ip_address":"","comment_id":325462,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1638964874","product_id":100090001,"comment_content":"ç‰›é€¼ ä¾‹å­å¾ˆå½¢è±¡å•Šï¼ï¼ï¼","like_count":0,"discussions":[{"author":{"id":1043100,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/ea/9c/230061e7.jpg","nickname":"å´ç£Š","note":"","ucode":"136DC8CF1B10DC","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":537377,"discussion_content":"å“ˆå“ˆï¼Œè€å¼Ÿå–œæ¬¢å°±å¥½~","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1639045594,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":324012,"user_name":"å°æ–°","can_delete":false,"product_type":"c1","uid":1690884,"ip_address":"","ucode":"DCAD04665E2CF8","user_header":"https://static001.geekbang.org/account/avatar/00/19/cd/04/e27b7803.jpg","comment_is_top":false,"comment_ctime":1638256036,"is_pvip":false,"replies":[{"id":"117600","content":"æ„Ÿè°¢è€å¼Ÿçš„è®¤å¯~","user_name":"ä½œè€…å›å¤","user_name_real":"ç¼–è¾‘","uid":"1043100","ctime":1638283608,"ip_address":"","comment_id":324012,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1638256036","product_id":100090001,"comment_content":"ç²¾å½©ç»ä¼¦","like_count":0,"discussions":[{"author":{"id":1043100,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/ea/9c/230061e7.jpg","nickname":"å´ç£Š","note":"","ucode":"136DC8CF1B10DC","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":534820,"discussion_content":"æ„Ÿè°¢è€å¼Ÿçš„è®¤å¯~","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1638283608,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":323816,"user_name":"Yadong","can_delete":false,"product_type":"c1","uid":1019536,"ip_address":"","ucode":"DD7E96E08AA456","user_header":"","comment_is_top":false,"comment_ctime":1638173346,"is_pvip":false,"replies":[{"id":"117602","content":"æ„Ÿè°¢è€å¼Ÿçš„è®¤å¯å’Œé¼“åŠ±~","user_name":"ä½œè€…å›å¤","user_name_real":"ç¼–è¾‘","uid":"1043100","ctime":1638283740,"ip_address":"","comment_id":323816,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1638173346","product_id":100090001,"comment_content":"è¯¾ç¨‹è´¨é‡é«˜ï¼Œè¯„è®ºåŒºä¹Ÿæ˜¯å¹²è´§ï¼","like_count":0,"discussions":[{"author":{"id":1043100,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/ea/9c/230061e7.jpg","nickname":"å´ç£Š","note":"","ucode":"136DC8CF1B10DC","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":534824,"discussion_content":"æ„Ÿè°¢è€å¼Ÿçš„è®¤å¯å’Œé¼“åŠ±~","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1638283740,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":314496,"user_name":"ç«ç‚ç„±ç‡š","can_delete":false,"product_type":"c1","uid":2767491,"ip_address":"","ucode":"DB11784DD94059","user_header":"https://static001.geekbang.org/account/avatar/00/2a/3a/83/74e3fabd.jpg","comment_is_top":false,"comment_ctime":1633145701,"is_pvip":false,"replies":[{"id":"113937","content":"ä¸€èµ·åŠ æ²¹~","user_name":"ä½œè€…å›å¤","user_name_real":"å´ç£Š","uid":"1043100","ctime":1633166922,"ip_address":"","comment_id":314496,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1633145701","product_id":100090001,"comment_content":"å¥½æ–‡ç« ï¼Œå¯¹äºæˆ‘è¿™ä¸ªæ–°æ‰‹éå¸¸åˆé€‚ã€‚","like_count":0,"discussions":[{"author":{"id":1043100,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/ea/9c/230061e7.jpg","nickname":"å´ç£Š","note":"","ucode":"136DC8CF1B10DC","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":527701,"discussion_content":"ä¸€èµ·åŠ æ²¹~","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1633166922,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":313713,"user_name":"Unknown element","can_delete":false,"product_type":"c1","uid":2028277,"ip_address":"","ucode":"34A129800D0238","user_header":"https://static001.geekbang.org/account/avatar/00/1e/f2/f5/b82f410d.jpg","comment_is_top":false,"comment_ctime":1632627430,"is_pvip":false,"replies":[{"id":"113615","content":"èŠ‚ç‚¹å…¶å®å°±æ˜¯æœåŠ¡å™¨ï¼Œæœºæ¶æ˜¯æ‰¿è½½èŠ‚ç‚¹çš„å¤§é“å£³å­","user_name":"ä½œè€…å›å¤","user_name_real":"å´ç£Š","uid":"1043100","ctime":1632656384,"ip_address":"","comment_id":313713,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1632627430","product_id":100090001,"comment_content":"è€å¸ˆæˆ‘æƒ³é—®ä¸‹ èŠ‚ç‚¹ å’Œ æœºæ¶ çš„åŒºåˆ«æ˜¯ä»€ä¹ˆï¼Ÿ","like_count":0,"discussions":[{"author":{"id":1043100,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/ea/9c/230061e7.jpg","nickname":"å´ç£Š","note":"","ucode":"136DC8CF1B10DC","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":527449,"discussion_content":"èŠ‚ç‚¹å…¶å®å°±æ˜¯æœåŠ¡å™¨ï¼Œæœºæ¶æ˜¯æ‰¿è½½èŠ‚ç‚¹çš„å¤§é“å£³å­","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1632656384,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":312911,"user_name":"æ— åæ— å§“","can_delete":false,"product_type":"c1","uid":2621412,"ip_address":"","ucode":"487BD5AA2CD305","user_header":"https://static001.geekbang.org/account/avatar/00/27/ff/e4/927547a9.jpg","comment_is_top":false,"comment_ctime":1632116209,"is_pvip":true,"replies":[{"id":"113427","content":"å“ˆå“ˆï¼Œé™ä½å­¦ä¹ æˆæœ¬ï½","user_name":"ä½œè€…å›å¤","user_name_real":"å´ç£Š","uid":"1043100","ctime":1632283417,"ip_address":"","comment_id":312911,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1632116209","product_id":100090001,"comment_content":"æ¯”è¾ƒå½¢è±¡","like_count":0,"discussions":[{"author":{"id":1043100,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/ea/9c/230061e7.jpg","nickname":"å´ç£Š","note":"","ucode":"136DC8CF1B10DC","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":527157,"discussion_content":"å“ˆå“ˆï¼Œé™ä½å­¦ä¹ æˆæœ¬ï½","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1632283417,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]}]}