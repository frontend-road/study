{"id":551890,"title":"11 | FFmpeg åŸºç¡€æ¨¡å—ï¼ˆäºŒï¼‰ï¼šAVIOã€AVDictionary ä¸ AVOption","content":"<p>ä½ å¥½ï¼Œæˆ‘æ˜¯åˆ˜æ­§ã€‚</p><p><a href=\"https://time.geekbang.org/column/article/551256\">ä¸Šä¸€èŠ‚è¯¾</a>æˆ‘ä»¬äº†è§£äº†AVFormatä¸­çš„APIæ¥å£çš„åŠŸèƒ½ï¼Œä»å®é™…æ“ä½œç»éªŒçœ‹ï¼Œè¿™äº›æ¥å£æ˜¯å¯ä»¥æ»¡è¶³å¤§å¤šæ•°éŸ³è§†é¢‘çš„muxä¸demuxï¼Œæˆ–è€…è¯´remuxåœºæ™¯çš„ã€‚ä½†æ˜¯é™¤æ­¤ä¹‹å¤–ï¼Œåœ¨æ—¥å¸¸ä½¿ç”¨APIå¼€å‘åº”ç”¨çš„æ—¶å€™ï¼Œæˆ‘ä»¬è¿˜ä¼šé‡åˆ°éœ€è¦ä»è‡ªå·±å®šä¹‰çš„å†…å­˜æˆ–æ–‡ä»¶ä¸­è¯»å†™æ•°æ®ï¼Œç„¶åå¥—ç”¨åœ¨AVFormatä¸­çš„åœºæ™¯ã€‚é‡åˆ°è¿™ç§åœºæ™¯çš„æ—¶å€™æˆ‘ä»¬åº”è¯¥æ€ä¹ˆåŠå‘¢ï¼Ÿä½¿ç”¨AVIOå°±å¯ä»¥åšåˆ°ã€‚</p><h2>AVIO</h2><p>æˆ‘ä»¬å…ˆæ¥è®¤è¯†ä¸€ä¸‹AVIOã€‚AVIOéƒ¨åˆ†å¸¸è§çš„æ¥å£çœ‹ä¸Šå»æ¯”è¾ƒå¤šï¼Œä¸»è¦æ˜¯ä¸ºäº†æ–¹ä¾¿è¯»ã€å†™å†…å®¹æ—¶åšä¸€äº›å­—èŠ‚å¯¹é½ä¸å¤§å°ç«¯å®šä¹‰çš„æ“ä½œï¼Œäº†è§£äº†å®ƒå†…åœ¨çš„ç»“æ„ä¹‹åï¼Œä½ å°±ä¼šè§‰å¾—æ¸…æ™°å¤šäº†ã€‚ä¸‹é¢æˆ‘ä»¬æ¥ä¸€ä¸€è®²è§£ä¸€ä¸‹ã€‚</p><p>å½“ä½ æƒ³çŸ¥é“ä¸€ä¸ªURLå­—ç¬¦ä¸²æ˜¯ä»€ä¹ˆåè®®çš„æ—¶å€™ï¼Œé€šè¿‡<strong>avio_find_protocol_nameæ¥å£</strong>å°±èƒ½å¾—åˆ°åè®®çš„åç§°ï¼Œä¾‹å¦‚httpã€rtmpã€rtspç­‰ã€‚</p><pre><code class=\"language-plain\">const char *avio_find_protocol_name(const char *url);\n</code></pre><p><strong>avio_alloc_contextæ¥å£</strong>ä¸»è¦ç”¨æ¥ç”³è¯·AVIOContextå¥æŸ„ï¼Œå¹¶ä¸”å¯ä»¥åœ¨ç”³è¯·çš„æ—¶å€™æ³¨å†Œread_packetã€write_packetä¸seekå›è°ƒï¼Œç„¶åå¯ä»¥å°†AVIOContextå¥æŸ„æŒ‚è½½åˆ°AVFormatContextçš„pbä¸Šé¢ã€‚æŒ‚è½½å®Œæˆåï¼Œåœ¨æ“ä½œAVFormatContextçš„read_packetã€write_packetã€seekçš„æ—¶å€™ï¼Œä¼šè°ƒç”¨è¿™é‡Œæ³¨å†Œè¿‡çš„å›è°ƒæ¥å£ï¼Œæ³¨å†Œçš„æ—¶å€™å¦‚æœæŠŠå›è°ƒæ¥å£è®¾ç½®æˆNULL<span class=\"reference\">ï¼ˆç©ºï¼‰</span>ï¼Œå°±ä¼šä½¿ç”¨AVIOContextå­æ¨¡å—é»˜è®¤çš„æµç¨‹ã€‚è¿™é‡Œç”³è¯·çš„AVIOContextå¯ä»¥é€šè¿‡<strong>avio_context_free</strong>æ¥é‡Šæ”¾ã€‚</p><!-- [[[read_end]]] --><pre><code class=\"language-plain\">AVIOContext *avio_alloc_context(\n                  unsigned char *buffer,\n                  int buffer_size,\n                  int write_flag,\n                  void *opaque,\n                  int (*read_packet)(void *opaque, uint8_t *buf, int buf_size),\n                  int (*write_packet)(void *opaque, uint8_t *buf, int buf_size),\n                  int64_t (*seek)(void *opaque, int64_t offset, int whence));\n                  \nvoid avio_context_free(AVIOContext **s);\n</code></pre><p>ä¸‹é¢è¿™ä¸€ç³»åˆ—çš„è¯»å†™æ¥å£ï¼Œä»åå­—å°±å¯ä»¥çœ‹å‡ºæ¥ï¼Œå…¶ä¸­wæ˜¯å†™ï¼Œræ˜¯è¯»ï¼Œlæˆ–è€…leä»£è¡¨å°ç«¯æ–¹å¼è¯»å†™ï¼Œbæˆ–è€…beä»£è¡¨å¤§ç«¯è¯»å†™ï¼Œ8ä»£è¡¨8ä½ï¼Œ16ä»£è¡¨16ä½ï¼Œ24ã€32ã€64åˆ†åˆ«ä»£è¡¨24ä½ã€32ä½å’Œ64ä½ã€‚è‡³äºæ˜¯å¤§ç«¯è¯»å†™è¿˜æ˜¯å°ç«¯è¯»å†™ï¼Œä½ å¯ä»¥æ ¹æ®å®é™…çš„å‚è€ƒæ ‡å‡†çš„è¦æ±‚è¿›è¡Œæ“ä½œã€‚ç„¶åæ˜¯å­—ç¬¦ä¸²æ“ä½œï¼Œè¿™ä¸ªéƒ¨åˆ†ä¹Ÿå¯ä»¥åŒºåˆ†å¤§å°ç«¯çš„è¯»å†™ã€‚</p><pre><code class=\"language-plain\">void avio_w8(AVIOContext *s, int b);\nvoid avio_write(AVIOContext *s, const unsigned char *buf, int size);\nvoid avio_wl64(AVIOContext *s, uint64_t val);\nvoid avio_wb64(AVIOContext *s, uint64_t val);\nvoid avio_wl32(AVIOContext *s, unsigned int val);\nvoid avio_wb32(AVIOContext *s, unsigned int val);\nvoid avio_wl24(AVIOContext *s, unsigned int val);\nvoid avio_wb24(AVIOContext *s, unsigned int val);\nvoid avio_wl16(AVIOContext *s, unsigned int val);\nvoid avio_wb16(AVIOContext *s, unsigned int val);\nint avio_put_str(AVIOContext *s, const char *str);\nint avio_put_str16le(AVIOContext *s, const char *str);\nint avio_put_str16be(AVIOContext *s, const char *str);\n\nint avio_read(AVIOContext *s, unsigned char *buf, int size);\nint avio_read_partial(AVIOContext *s, unsigned char *buf, int size);\nint          avio_r8  (AVIOContext *s);\nunsigned int avio_rl16(AVIOContext *s);\nunsigned int avio_rl24(AVIOContext *s);\nunsigned int avio_rl32(AVIOContext *s);\nuint64_t     avio_rl64(AVIOContext *s);\nunsigned int avio_rb16(AVIOContext *s);\nunsigned int avio_rb24(AVIOContext *s);\nunsigned int avio_rb32(AVIOContext *s);\nuint64_t     avio_rb64(AVIOContext *s);\nint avio_get_str(AVIOContext *pb, int maxlen, char *buf, int buflen);\nint avio_get_str16le(AVIOContext *pb, int maxlen, char *buf, int buflen);\nint avio_get_str16be(AVIOContext *pb, int maxlen, char *buf, int buflen);\n</code></pre><p>å½“è§£æéƒ¨åˆ†å°è£…æ ¼å¼çš„æ—¶å€™ï¼Œæœ‰ä¸€äº›å­—æ®µæš‚æ—¶ä¸ç”¨æˆ–è€…ä¸éœ€è¦è§£æï¼Œå°±å¯ä»¥ä½¿ç”¨<strong>avio_skipã€avio_seek</strong>æ¥è·³è¿‡å¯¹åº”çš„å­—èŠ‚ï¼Œæˆ–è€…é€šè¿‡avio_seekå®šä½åˆ°æƒ³å»çš„å­—èŠ‚å¤„ï¼Œå¦‚æœæƒ³è¦çŸ¥é“æ–‡ä»¶è¯»å†™ä¹‹åå½“å‰çš„æ–‡ä»¶ä½ç½®ï¼Œå¯ä»¥é€šè¿‡<strong>avio_tell</strong>æ¥è·å¾—ã€‚</p><pre><code class=\"language-plain\">int64_t avio_seek(AVIOContext *s, int64_t offset, int whence);\nint64_t avio_skip(AVIOContext *s, int64_t offset);\nstatic av_always_inline int64_t avio_tell(AVIOContext *s)\n</code></pre><p>AVIOContextå¥æŸ„æ–‡ä»¶å½“å‰å·²ç»å†™å…¥çš„å†…å®¹çš„å¤§å°ï¼Œå¯ä»¥é€šè¿‡<strong>avio_size</strong>æ¥è·å¾—ã€‚</p><pre><code class=\"language-plain\">int64_t avio_size(AVIOContext *s);\n</code></pre><p>é€šè¿‡<strong>avio_feof</strong>å¯ä»¥åˆ¤æ–­å½“å‰ä½ç½®æ˜¯å¦æ˜¯AVIOContextçš„EOF<span class=\"reference\">ï¼ˆæ–‡ä»¶æœ«å°¾ï¼‰</span>ã€‚</p><pre><code class=\"language-plain\">int avio_feof(AVIOContext *s);\n</code></pre><p>å¦‚æœåœ¨æ“ä½œAVIOContextå†™å†…å®¹çš„æ—¶å€™å†…å­˜ä¸æ–­å¢é•¿ï¼Œå¯ä»¥å°è¯•ç”¨<strong>avio_flush</strong>æŠŠå†…å®¹åˆ·åˆ°ç›®æ ‡æ–‡ä»¶ä¸­å»ã€‚</p><pre><code class=\"language-plain\">void avio_flush(AVIOContext *s);\n</code></pre><p>å½“å†™å…¥æ–‡ä»¶éœ€è¦å…ˆä¸´æ—¶æ”¾åœ¨å†…å­˜ä¸­ï¼Œæœ€åæŒ‰ç…§è‡ªå·±çš„è®¡åˆ’å°†å†…å®¹åˆ·åˆ°æ–‡ä»¶ä¸­çš„è¯ï¼Œå¯ä»¥è€ƒè™‘ä½¿ç”¨<strong>avio_open_dyn_bufã€avio_get_dyn_bufã€avio_close_dyn_buf</strong>æ¥æ“ä½œã€‚</p><pre><code class=\"language-plain\">int avio_open_dyn_buf(AVIOContext **s);\nint avio_get_dyn_buf(AVIOContext *s, uint8_t **pbuffer);\nint avio_close_dyn_buf(AVIOContext *s, uint8_t **pbuffer);\n</code></pre><p>æ¯”å¦‚æ“ä½œHLSç›´æ’­æµçš„æ—¶å€™ï¼Œè€ƒè™‘åˆ°fragment mp4æ–‡ä»¶çš„ç‰¹æ®Šæ€§ï¼Œæˆ‘å¸Œæœ›å…ˆæŠŠæ–‡ä»¶å†…å®¹å†™å…¥åˆ°å†…å­˜ä¸­ï¼Œç¡®ä¿å†™å…¥çš„æ•°æ®æ‹¿åˆ°éŸ³è§†é¢‘åŒ…å®Œæ•´çš„æµä¿¡æ¯æ•°æ®ï¼Œç„¶åç”ŸæˆHLSåˆ—è¡¨æ—¶èƒ½å¤Ÿå†™å…¥å‡†ç¡®çš„æµä¿¡æ¯å†…å®¹ï¼Œæˆ‘ä¼šè°ƒç”¨avio_open_dyn_bufã€avio_get_dyn_bufã€avio_close_dyn_bufæ¥è§£å†³é—®é¢˜ã€‚<br>\nå†æ¯”å¦‚ç”Ÿæˆfragment mp4çš„HLSæ—¶ï¼Œéœ€è¦æœ‰ä¸€ä¸ªfragment mp4çš„initå¤´å†…å®¹ï¼Œè¿™ä¸ªinitå¤´éƒ¨å†…å®¹ï¼Œé€šå¸¸å¯ä»¥ç”¨avio_open_dyn_bufã€avio_get_dyn_bufã€avio_close_dyn_bufæ¥åšä¸´æ—¶ç¼“å­˜ï¼Œå¹¶ä¸”å®šæ—¶åˆ·æ–°åˆ°initå¤´ä¸­ã€‚</p><p><strong>avio_closeä¸avio_closep</strong>å‡ ä¹ç›¸åŒï¼Œç”¨æ¥é‡Šæ”¾ç”³è¯·çš„èµ„æºï¼Œä½†æ˜¯åœ¨avio_closepé‡Œä¼šè°ƒç”¨avio_closeï¼Œå¹¶æ¸…ç©ºAVIOContextå¥æŸ„å†…å®¹ï¼Œç„¶åç½®ç©ºã€‚è¿™æ ·å¯ä»¥ç¡®ä¿AVIOContextçš„æ“ä½œå®‰å…¨ï¼Œä¸ä¼šå‡ºç°use-after-freeçš„é—®é¢˜ï¼Œæ‰€ä»¥æœ‰æ—¶å€™ç”¨avio_closepä¼šæ›´å®‰å…¨ä¸€äº›ã€‚</p><pre><code class=\"language-plain\">int avio_close(AVIOContext *s);\nint avio_closep(AVIOContext **s);\n</code></pre><p><strong>avio_openå’Œavio_open2</strong>éƒ½æ˜¯ç”¨æ¥æ‰“å¼€FFmpegçš„è¾“å…¥è¾“å‡ºæ–‡ä»¶çš„ï¼Œå®ƒä»¬ä¹‹é—´çš„å·®åˆ«æ˜¯avio_open2å¯ä»¥æ³¨å†Œä¸€ä¸ªAVIOInterruptCBçš„callbackåšè¶…æ—¶ä¸­æ–­å¤„ç†ï¼Œè€Œä¸”å¯ä»¥åœ¨opençš„æ—¶å€™è®¾ç½®AVDictionaryæ¥æ“ä½œAVIOç›®æ ‡å¯¹è±¡çš„optionsã€‚</p><pre><code class=\"language-plain\">int avio_open(AVIOContext **s, const char *url, int flags);\nint avio_open2(AVIOContext **s, const char *url, int flags, const AVIOInterruptCB *int_cb, AVDictionary **options);\n</code></pre><p><img src=\"https://static001.geekbang.org/resource/image/77/47/773dc943233541714b0113c114118147.png?wh=1920x2084\" alt=\"å›¾ç‰‡\"></p><p>å­¦å®ŒAVIOéƒ¨åˆ†æ¥å£çš„ç”¨é€”å’Œæ“ä½œæ–¹å¼ï¼Œå°±è¡¥é½äº†å°è£…æ ¼å¼æ“ä½œAPIæ–¹é¢çš„æ‹¼å›¾ã€‚è¿™æ˜¯æˆ‘ä»¬æˆä¸ºFFmpeg APIç”¨æˆ·çš„ç¬¬ä¸€æ­¥ã€‚ä½†ä½ ä¸è¦å› æ­¤è§‰å¾—æˆä¸ºAPIç”¨æˆ·å°±å¯ä»¥ä¸ç”¨FFmpegçš„å‘½ä»¤è¡Œäº†ã€‚</p><p>å…¶å®æ— è®ºæ˜¯FFmpegçš„å‘½ä»¤è¡Œè¿˜æ˜¯å„ç§APIæ¥å£ï¼Œéƒ½å¯ä»¥ä¸ºæˆ‘ä»¬æ‰€ç”¨ï¼Œå®ƒä»¬ä¹‹é—´å¹¶ä¸æ˜¯å‰²è£‚çš„ã€‚FFmpegæä¾›çš„å‘½ä»¤è¡Œæ”¯æŒå¾ˆå¤šå‚æ•°ï¼Œè¿™äº›å‚æ•°ä¸å•å•æ˜¯æä¾›ç»™å‘½ä»¤è¡Œç”¨æˆ·çš„ï¼ŒAPIç”¨æˆ·ä¹Ÿå¯ä»¥ä½¿ç”¨ã€‚é‚£å…·ä½“APIç”¨æˆ·åº”è¯¥æ€ä¹ˆå»ä½¿ç”¨è¿™äº›å‚æ•°å‘¢ï¼Ÿ</p><p>æˆ‘ä»¬å¯ä»¥é€šè¿‡AVDictionaryæˆ–è€…AVOptionæ¥è®¾ç½®å‚æ•°ï¼Œè¿™ä¸¤ä¸ªAPIç³»åˆ—ä¸»è¦ç”¨æ¥è®¾ç½®æ“ä½œç›®æ ‡çš„formatã€codecã€protocolçš„å‚æ•°ï¼Œæœ€ç»ˆè¾¾åˆ°ä¸å‘½ä»¤è¡Œä½¿ç”¨å‚æ•°ä¸€æ ·çš„æ•ˆæœã€‚å› ä¸ºAVDictionaryå’ŒAVOptionéƒ½æ˜¯åŸºç¡€æ“ä½œæ¥å£ï¼Œä¹‹åæˆ‘ä»¬å­¦ä¹ çš„æ“ä½œæ¥å£éƒ½ä¼šæ¶‰åŠå‚æ•°è®¾ç½®ï¼Œæ‰€ä»¥ä»Šå¤©æˆ‘ä»¬ä¹Ÿè¯¦ç»†åœ°äº†è§£ä¸€ä¸‹optå’Œdictçš„æ“ä½œæ–¹æ³•ã€‚</p><h2>AVDictionary ä¸ AVOption</h2><p>åœ¨ä½¿ç”¨ FFmpeg å‘½ä»¤è¡Œåšå°è£…ã€è§£å°è£…ã€ç¼–è§£ç ã€ç½‘ç»œä¼ è¾“çš„æ—¶å€™ï¼Œéƒ½ä¼šç”¨åˆ°ä¸€äº›å‚æ•°ï¼Œæ¯”å¦‚æˆ‘ä»¬å½•åˆ¶MP4çš„æ—¶å€™ï¼Œå¸Œæœ›åœ¨å½•åˆ¶å®Œæˆä¹‹åæŠŠmoovç§»åŠ¨åˆ°æ–‡ä»¶å¤´éƒ¨ï¼Œå°±éœ€è¦æ·»åŠ ä¸€ä¸ªå‚æ•°â€movflags faststartã€‚é‚£ä¹ˆåœ¨ä½¿ç”¨FFmpegçš„SDKæ—¶ï¼Œå°±éœ€è¦ä½¿ç”¨dictæˆ–optçš„æ“ä½œæ–¹å¼ï¼Œæ¥å°†å‚æ•°ä¼ ç»™ FFmpegå†…éƒ¨MP4çš„muxeræ¨¡å—ã€‚</p><p>åŒæ ·æ˜¯æŠŠmoovç§»åŠ¨åˆ°æ–‡ä»¶å¤´éƒ¨ï¼Œä½¿ç”¨dictå’Œä½¿ç”¨optæœ‰ä»€ä¹ˆåŒºåˆ«å‘¢ï¼Ÿä¸‹é¢æˆ‘ç”¨ä¸¤ä¸ªä¾‹å­æ¥è¯´æ˜è¿™ä¸ªé—®é¢˜ã€‚</p><ol>\n<li>é€šè¿‡optæ“ä½œè®¾ç½®å‚æ•°</li>\n</ol><pre><code class=\"language-plain\">AVFormatContext *oc;\navformat_alloc_output_context2(&amp;oc, NULL, NULL, \"out.mp4\");\nav_opt_set(ocâ€&gt;priv_data, \"movflags\", \"faststart\", 0); /* ç›´æ¥è®¾ç½®å®¹å™¨å¯¹è±¡çš„å‚æ•° */\navformat_write_header(oc, NULL);\nav_interleaved_write_frame(oc, pkt);\nav_write_trailer(oc);\n</code></pre><ol start=\"2\">\n<li>é€šè¿‡dictæ“ä½œè®¾ç½®å‚æ•°ã€‚</li>\n</ol><pre><code class=\"language-plain\">AVFormatContext *oc;\nAVDictionary *opt = NULL; /* å…ˆå®šä¹‰ä¸€ä¸ªAVDictionaryå˜é‡ */\navformat_alloc_output_context2(&amp;oc, NULL, NULL, \"out.mp4\");\nav_dict_set(&amp;opt, \"movflags\", \"faststart\", 0); /* å°†å‚æ•°è®¾ç½®åˆ°AVDictionaryå˜é‡ä¸­ */\navformat_write_header(oc, &amp;opt); /* æ‰“å¼€æ–‡ä»¶æ—¶ä¼ AVDictionaryå‚æ•° */\nav_dict_free(&amp;opt); /* ä½¿ç”¨å®ŒAVDictionaryå‚æ•°åç«‹å³é‡Šæ”¾ä»¥é˜²æ­¢å†…å­˜æ³„éœ² */\nav_interleaved_write_frame(oc, pkt);\nav_write_trailer(oc);\n</code></pre><p>è¿™ä¸¤ç§æ“ä½œæ–¹å¼éƒ½å¯ä»¥å°†moovå®¹å™¨ç§»åŠ¨åˆ°MP4æ–‡ä»¶çš„å¤´éƒ¨ï¼Œæˆ‘ä»¬ä»æ“ä½œçš„ä»£ç ä¸­çœ‹åˆ°ï¼Œ av_opt_setå¯ä»¥ç›´æ¥è®¾ç½®å¯¹åº”å¯¹è±¡çš„å‚æ•°ï¼Œè¿™æ ·ä½¿ç”¨çš„è¯èƒ½å¤Ÿç›´æ¥è®©è®¾ç½®çš„å‚æ•°ç”Ÿæ•ˆã€‚è€Œ av_dict_setå¯ä»¥æŠŠå‚æ•°è®¾ç½®åˆ°AVDictionaryå˜é‡ä¸­ï¼Œæ”¾åˆ°AVDictionaryé‡Œä¹‹åï¼Œå¯ä»¥å¤ç”¨åˆ°å¤šä¸ªå¯¹è±¡é‡Œï¼Œä½†æ˜¯è®¾ç½®èµ·æ¥ä¼šç¨å¾®éº»çƒ¦ä¸€äº›ã€‚äºŒè€…å„æœ‰ä¼˜åŠ¿ï¼Œä½ å¯ä»¥é€šè¿‡ä¸ªäººçš„ä½¿ç”¨ä¹ æƒ¯è€Œå®šã€‚</p><p>é™¤äº†av_opt_setä¸av_dict_setä¹‹å¤–ï¼Œoptä¸dictè¿˜æœ‰å¾ˆå¤šçš„æ“ä½œæ¥å£å¯ä»¥ä½¿ç”¨ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡åˆ—è¡¨æ¥äº†è§£ä¸€ä¸‹ã€‚</p><ol>\n<li>optæ¥å£åˆ—è¡¨</li>\n</ol><pre><code class=\"language-plain\">av_opt_set_int åªæ¥å—æ•´æ•°\nav_opt_set_double åªæ¥å—æµ®ç‚¹æ•°\nav_opt_set_q åªæ¥å—åˆ†å­ä¸åˆ†æ¯ï¼Œä¾‹å¦‚{1, 25}è¿™æ ·\nav_opt_set_bin åªæ¥å—äºŒè¿›åˆ¶æ•°æ®\nav_opt_set_image_size åªæ¥å—å›¾åƒå®½ä¸é«˜ï¼Œä¾‹å¦‚1920ï¼Œ1080è¿™æ ·\nav_opt_set_video_rate åªæ¥å—åˆ†å­ä¸åˆ†æ¯ï¼Œä¾‹å¦‚{1, 25}è¿™æ ·\nav_opt_set_pixel_fmt åªæ¥å—æšä¸¾ç±»å‹ï¼Œä¾‹å¦‚AV_PIX_FMT_YUV420P\nav_opt_set_sample_fmt åªæ¥å—é‡‡æ ·æ•°æ®æ ¼å¼æšä¸¾ç±»å‹ï¼Œä¾‹å¦‚AV_SAMPLE_FMT_S16\nav_opt_set_channel_layout åªæ¥å—éŸ³é¢‘é€šé“å¸ƒå±€æšä¸¾ç±»å‹ï¼Œä¾‹å¦‚AV_CHANNEL_LAYOUT_5POINT0\nav_opt_set_dict_val æ¥å—AVDictionaryç±»å‹ï¼Œä¾‹å¦‚è®¾ç½®metadataæ—¶å€™å¯ä»¥ä½¿ç”¨\nav_opt_set_chlayout åªæ¥å—éŸ³é¢‘é€šé“å¸ƒå±€æšä¸¾ç±»å‹ï¼Œä¾‹å¦‚AV_CHANNEL_LAYOUT_5POINT0\nav_opt_set_defaults è®¾ç½®å¯¹è±¡çš„é»˜è®¤å€¼ï¼Œä¾‹å¦‚hlsencæœ‰è‡ªå·±å¯¹åº”çš„æ“ä½œé€‰é¡¹çš„é»˜è®¤å€¼ï¼Œå…¨éƒ¨è®¾ç½®å¯¹åº”çš„é»˜è®¤å€¼\nav_opt_set_defaults2 è®¾ç½®å¯¹è±¡çš„é»˜è®¤å€¼ï¼Œä¾‹å¦‚hlsencæœ‰è‡ªå·±å¯¹åº”çš„æ“ä½œé€‰é¡¹çš„é»˜è®¤å€¼ï¼Œå…¨éƒ¨è®¾ç½®å¯¹åº”çš„é»˜è®¤å€¼\nav_opt_set_from_string è§£ækey=valueæ ¼å¼çš„å­—ç¬¦ä¸²å¹¶è®¾ç½®å¯¹åº”çš„å‚æ•°ä¸å€¼\n\nav_opt_next è·å¾—optæ“ä½œçš„å¯¹è±¡çš„ä¸‹ä¸€ä¸ªå‚æ•°\nav_opt_get_int è·å¾—å¯¹è±¡å‚æ•°çš„å€¼ä¸ºæ•´æ•°\nav_opt_get_double è·å¾—å¯¹è±¡å‚æ•°çš„å€¼ä¸ºåŒç²¾åº¦æµ®ç‚¹æ•°\nav_opt_get_q è·å¾—å¯¹è±¡å‚æ•°ä¸ºåˆ†å­åˆ†æ¯æ•°ï¼Œä¾‹å¦‚{1, 25}è¿™æ ·\nav_opt_get_image_size è·å¾—å›¾åƒçš„å®½å’Œé«˜ï¼Œä¾‹å¦‚1920ï¼Œ1080è¿™æ ·\nav_opt_get_video_rate è·å¾—è§†é¢‘çš„å¸§ç‡ï¼Œä¾‹å¦‚{1, 25}è¿™æ ·\nav_opt_get_pixel_fmt è·å¾—è§†é¢‘çš„åƒç´ ç‚¹æ ¼å¼æšä¸¾ç±»å‹ï¼Œä¾‹å¦‚AV_PIX_FMT_YUV420P\nav_opt_get_sample_fmt è·å¾—éŸ³é¢‘çš„é‡‡æ ·æ ¼å¼æšä¸¾ç±»å‹ï¼Œä¾‹å¦‚AV_SAMPLE_FMT_S16\nav_opt_get_channel_layout è·å¾—éŸ³é¢‘çš„é‡‡æ ·å¸ƒå±€æšä¸¾ç±»å‹ï¼Œä¾‹å¦‚AV_CHANNEL_LAYOUT_5POINT0\nav_opt_get_dict_val è·å¾—AVDictionaryç±»å‹ï¼Œé€šå¸¸æ˜¯key-valueæ–¹å¼\nav_opt_get_key_value è·å¾—key=valueç±»å‹\n</code></pre><p>ä½¿ç”¨optä¸­çš„è¿™äº›æ¥å£è¿›è¡Œæ“ä½œæ—¶ï¼Œå¯ä»¥ç²¾ç¡®åœ°è®¾ç½®åˆ°å‚æ•°å€¼çš„ç±»å‹ï¼Œç›´æ¥æ“ä½œå¯¹è±¡ï¼Œæ¯”å¦‚æŸä¸ªå°è£…æ ¼å¼æ¨¡å—ã€æŸä¸ªç¼–è§£ç æ¨¡å—ï¼Œéå¸¸æ–¹ä¾¿ã€‚</p><ol start=\"2\">\n<li>dirtæ¥å£åˆ—è¡¨</li>\n</ol><pre><code class=\"language-plain\">av_dict_count è·å¾—dictå‚æ•°çš„æ•°é‡æ•´æ•°\nav_dict_parse_string ä¸€æ¬¡æ€§è§£æå¤šç»„key=valueæ ¼å¼çš„å­—ç¬¦ä¸²ä¸ºdict\nav_dict_free é‡Šæ”¾å› è®¾ç½®dictç”³è¯·çš„å†…å­˜ç©ºé—´\nav_dict_copy å¤åˆ¶dictå‚æ•°ä¸å€¼\nav_dict_get_string è·å¾—dictçš„å‚æ•°å€¼ä¸ºå­—ç¬¦ä¸²ï¼Œç”¨key=valueæ ¼å¼å­—ç¬¦ä¸²è·å¾—åˆ°value\nav_dict_set_int è®¾ç½®dictå‚æ•°çš„å€¼ä¸ºæ•´æ•°\n</code></pre><p>å’Œoptç›¸æ¯”ï¼Œdictçš„æ“ä½œæ¥å£æ¯”è¾ƒå°‘ï¼Œç»™äººæ„Ÿè§‰æ¯”è¾ƒç®€å•ã€‚ä½†æ˜¯æ³¨æ„ï¼Œä½¿ç”¨dictè¿™äº›æ¥å£æ“ä½œå¯¹è±¡åï¼Œé€šå¸¸åªæ˜¯è®¾ç½®äº†AVDictionaryï¼Œå¹¶æ²¡æœ‰çœŸæ­£åœ°è®¾ç½®å…·ä½“å¯¹è±¡ã€‚å¦‚æœæƒ³è®©è®¾ç½®çš„å‚æ•°ç”Ÿæ•ˆï¼Œè¿˜éœ€è¦åœ¨åšå°è£…æ ¼å¼openæˆ–ç¼–è§£ç å™¨opençš„æ—¶å€™ï¼Œè®¾ç½®AVDictionaryï¼Œå¹¶ä¸”éœ€è¦ä»”ç»†æ–Ÿé…Œå†…å­˜ä½¿ç”¨æƒ…å†µï¼Œé€šå¸¸éœ€è¦è‡ªå·±è°ƒç”¨av_dict_freeåšå†…å­˜é‡Šæ”¾ã€‚</p><p>åœ¨æ—¥å¸¸ä½¿ç”¨APIè¿›è¡Œå¼€å‘çš„æ—¶å€™ï¼Œä½ å¯ä»¥ä½¿ç”¨optä¸dictç›¸å…³çš„æ¥å£ï¼Œé«˜æ•ˆåœ°è®¾ç½®å¯¹åº”çš„å‚æ•°ã€‚å½“ç„¶æƒ³è¦è·å¾—è¿™é¡¹èƒ½åŠ›ï¼Œè¿˜éœ€è¦ä½ å‹¤åŠ ç»ƒä¹ ã€‚</p><h2>å°ç»“</h2><p><img src=\"https://static001.geekbang.org/resource/image/2d/77/2debcce3ce9a8360bdd31cf90a0dcd77.png?wh=1920x1348\" alt=\"å›¾ç‰‡\"></p><p>å…³äºå°è£…æ ¼å¼çš„APIï¼Œé™¤äº†<a href=\"https://time.geekbang.org/column/article/551256\">ä¸ŠèŠ‚è¯¾</a>æˆ‘ä»¬å­¦ä¹ çš„AVFormatæ¨¡å—ä¹‹å¤–ï¼Œè¿˜æœ‰AVIOï¼Œå®ƒä¸»è¦åº”ç”¨äºåœ¨å†…å­˜ä¸­ç›´æ¥æ“ä½œæ•°æ®çš„åœºæ™¯ä¸­ã€‚</p><p>AVIOä¸­åŒ…å«å¾ˆå¤šå¸¸ç”¨çš„æ¥å£ï¼Œæ¯”å¦‚ç”¨æ¥æŸ¥çœ‹åè®®åç§°çš„avio_find_protocol_nameæ¥å£ã€ç”¨æ¥ç”³è¯·AVIOContextå¥æŸ„çš„avio_alloc_contextæ¥å£ï¼Œè¿˜æœ‰ä¸€ç³»åˆ—çš„è¯»å†™æ¥å£ç­‰ã€‚AVIOæ“ä½œæ¥å£å’Œæˆ‘ä»¬æ ‡å‡†æ–‡ä»¶çš„æ“ä½œæ¥å£åŸºæœ¬ç›¸ä¼¼ï¼Œå¯ä»¥åœ¨ç”³è¯·ä¹‹åä¸FFmpegçš„AVFormatContextçš„pbæŒ‚è½½ï¼Œè¿™æ ·æ–¹ä¾¿è¿›å…¥FFmpegçš„AVFormatæ“ä½œçš„å†…éƒ¨æµç¨‹ã€‚</p><p>é™¤æ­¤ä¹‹å¤–ï¼Œæˆ‘ä»¬ä¹Ÿåº”è¯¥åˆç†åˆ©ç”¨FFmpegå‘½ä»¤è¡Œæ”¯æŒçš„å‚æ•°ï¼Œå­¦ä¼šä½¿ç”¨optä¸dictç›¸å…³çš„APIæ“ä½œï¼Œçµæ´»è°ƒç”¨FFmpegå‘½ä»¤è¡Œæ”¯æŒçš„å‚æ•°ï¼Œä¸ºæˆ‘ä»¬ä½¿ç”¨APIå¼€å‘åº”ç”¨æä¾›æ›´å¼ºå¤§çš„èƒ½åŠ›ã€‚</p><h2>æ€è€ƒé¢˜</h2><p>æœ€åï¼Œæˆ‘ä»¬æ¥æ€è€ƒä¸€ä¸ªé—®é¢˜ï¼Œåœ¨AVFormatæ¨¡å—ä¸­å¯ä»¥çœ‹åˆ°é¢‘ç¹å‡ºç°çš„ä¸€ä¸ªå‚æ•°AVPacketï¼Œè¿™ä¸ªAVPacketå±äºAVFormatè¿˜æ˜¯AVCodecå‘¢ï¼Ÿ æ¬¢è¿ä½ åœ¨è¯„è®ºåŒºç•™ä¸‹ä½ çš„ç­”æ¡ˆï¼Œä¹Ÿæ¬¢è¿ä½ æŠŠè¿™èŠ‚è¯¾åˆ†äº«ç»™æ„Ÿå…´è¶£çš„æœ‹å‹ï¼Œæˆ‘ä»¬ä¸‹èŠ‚è¯¾å†è§ï¼</p>","neighbors":{"left":{"article_title":"10 | FFmpeg åŸºç¡€æ¨¡å—ï¼ˆä¸€ï¼‰ï¼šå®¹å™¨ç›¸å…³çš„ API æ“ä½œ","id":551256},"right":{"article_title":"12 | FFmpegåŸºç¡€æ¨¡å—ï¼ˆä¸‰ï¼‰ï¼šAVCodec","id":553087}},"comments":[{"had_liked":false,"id":358645,"user_name":"Geek_wad2tx","can_delete":false,"product_type":"c1","uid":1004576,"ip_address":"åŒ—äº¬","ucode":"78CDCEBD183D3A","user_header":"https://static001.geekbang.org/account/avatar/00/0f/54/20/abb7bfe3.jpg","comment_is_top":false,"comment_ctime":1664508255,"is_pvip":false,"replies":[{"id":131822,"content":"ğŸ‘","user_name":"ç¼–è¾‘å›å¤","user_name_real":"ç¼–è¾‘","uid":2843479,"ctime":1668529750,"ip_address":"åŒ—äº¬","comment_id":358645,"utype":2}],"discussion_count":1,"race_medal":0,"score":2,"product_id":100117501,"comment_content":"AVPacket æ˜¯å±äºAVCodec\nAVPacket ä¸€èˆ¬ç”¨æ¥å­˜å‚¨è§£ç å‰çš„æ•°æ®ï¼ŒAVFormatä¸€èˆ¬ç”¨æ¥å­˜å‚¨è§£ç åçš„æ•°æ®ï¼Œ\né€šè¿‡ avcodec_send_packet é€å…¥avpacket ,  é€šè¿‡ avcodec_receive_frame è¿›è¡Œè§£ç ï¼Œé€å‡ºavformat","like_count":3,"discussions":[{"author":{"id":2843479,"avatar":"https://static001.geekbang.org/account/avatar/00/2b/63/57/cba4c68b.jpg","nickname":"å°è™å­ğŸ¯","note":"","ucode":"4C9530B3FB407B","race_medal":0,"user_type":8,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":593796,"discussion_content":"ğŸ‘","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1668529750,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"åŒ—äº¬","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":8}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":354882,"user_name":"geek","can_delete":false,"product_type":"c1","uid":2054268,"ip_address":"åŒ—äº¬","ucode":"97472635FF69ED","user_header":"","comment_is_top":false,"comment_ctime":1660849836,"is_pvip":false,"replies":[{"id":129098,"content":"AVFormatContexté‡Œé¢æœ‰ä¸ªAVIOContextï¼Œä¹Ÿå°±æ˜¯pbï¼Œæ˜¯AVFormatContextè‡ªå·±çš„pb åœ¨ffmpegçš„avformatå¤„ç†æµç¨‹é‡Œé¢ä¼šç”¨åˆ°","user_name":"ä½œè€…å›å¤","user_name_real":"ç¼–è¾‘","uid":1287929,"ctime":1660889955,"ip_address":"åŒ—äº¬","comment_id":354882,"utype":1}],"discussion_count":1,"race_medal":0,"score":2,"product_id":100117501,"comment_content":"è¿˜æœ‰ä¸ªé—®é¢˜\n\navio_alloc_context æ¥å£ä¸»è¦ç”¨æ¥ç”³è¯· AVIOContext å¥æŸ„ï¼Œå¹¶ä¸”å¯ä»¥åœ¨ç”³è¯·çš„æ—¶å€™æ³¨å†Œ read_packetã€write_packet ä¸ seek å›è°ƒï¼Œç„¶åå¯ä»¥å°† AVIOContext å¥æŸ„æŒ‚è½½åˆ° AVFormatContext çš„ pb ä¸Šé¢ã€‚\n\nè¿™ä¸ªpbæ˜¯ä»€ä¹ˆï¼Ÿ","like_count":0,"discussions":[{"author":{"id":1287929,"avatar":"https://static001.geekbang.org/account/avatar/00/13/a6/f9/79cad962.jpg","nickname":"æ‚Ÿç©º@OnVideo","note":"","ucode":"C320167A9A17B8","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":584510,"discussion_content":"AVFormatContexté‡Œé¢æœ‰ä¸ªAVIOContextï¼Œä¹Ÿå°±æ˜¯pbï¼Œæ˜¯AVFormatContextè‡ªå·±çš„pb åœ¨ffmpegçš„avformatå¤„ç†æµç¨‹é‡Œé¢ä¼šç”¨åˆ°","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1660889955,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"åŒ—äº¬","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":354881,"user_name":"geek","can_delete":false,"product_type":"c1","uid":2054268,"ip_address":"åŒ—äº¬","ucode":"97472635FF69ED","user_header":"","comment_is_top":false,"comment_ctime":1660848715,"is_pvip":false,"replies":[{"id":129097,"content":"åº”è¯¥æ˜¯ä¸è¡Œï¼Œå¾—æœ‰optionsæ‰è¡Œï¼Œä½ å¯ä»¥è¯•è¯•ç”¨metadata","user_name":"ä½œè€…å›å¤","user_name_real":"ç¼–è¾‘","uid":1287929,"ctime":1660889896,"ip_address":"åŒ—äº¬","comment_id":354881,"utype":1}],"discussion_count":1,"race_medal":0,"score":2,"product_id":100117501,"comment_content":"è¯·æ•™è€å¸ˆ\nAVDictionaryæ˜¯å¯ä»¥è‡ªå®šäº›è‡ªå·±çš„ä¿¡æ¯å†™åˆ°æ–‡ä»¶é‡Œï¼Ÿè€ŒAVOptionå´ä¸å¯ä»¥ï¼Ÿè¿˜æ˜¯éƒ½å¯ä»¥ï¼Ÿæ¯”å¦‚æˆ‘æƒ³åœ¨mp4æ–‡ä»¶ä¸­åŠ äº›ä¸ªäººä¿¡æ¯ã€‚","like_count":0,"discussions":[{"author":{"id":1287929,"avatar":"https://static001.geekbang.org/account/avatar/00/13/a6/f9/79cad962.jpg","nickname":"æ‚Ÿç©º@OnVideo","note":"","ucode":"C320167A9A17B8","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":584509,"discussion_content":"åº”è¯¥æ˜¯ä¸è¡Œï¼Œå¾—æœ‰optionsæ‰è¡Œï¼Œä½ å¯ä»¥è¯•è¯•ç”¨metadata","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1660889896,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"åŒ—äº¬","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":354701,"user_name":"peter","can_delete":false,"product_type":"c1","uid":1058183,"ip_address":"åŒ—äº¬","ucode":"261C3FC001DE2D","user_header":"https://static001.geekbang.org/account/avatar/00/10/25/87/f3a69d1b.jpg","comment_is_top":false,"comment_ctime":1660702444,"is_pvip":false,"replies":[{"id":129046,"content":"1.ä½ å¯ä»¥ç†è§£å°±æ˜¯cè¯­è¨€é‡Œé¢çš„inlineçš„åŠŸèƒ½ï¼Œå…·ä½“çš„è¿˜å¾—çœ‹ä¸€ä¸‹cè¯­è¨€æ ‡å‡†éƒ¨åˆ†\n2. æ’­æ”¾å™¨ä¸ç”¨ffmpegåº”è¯¥æ¯”è¾ƒå°‘ï¼Œè½¬ç ç³»ç»Ÿä¸ç”¨ffmpegä¹Ÿæ¯”è¾ƒå°‘ï¼Œæ¯”å¦‚ijkplayerï¼Œmpvï¼Œmplayerï¼Œblender,mltframework\n3. æ˜¯çš„ï¼Œä¸è¿‡ä¸å•å•æ˜¯ffmpegï¼Œè¿˜æœ‰OpenGL, AIæ¡†æ¶ï¼Œè‡ªç ”çš„ä¸€äº›æ¡†æ¶ï¼Œå±•æ™“å‡¯è€å¸ˆä¹Ÿè®²äº†ä¸€éƒ¨åˆ†ï¼Œå…¶ä»–çš„å¯èƒ½éœ€è¦çœ‹å¤§ä¼™çš„å…´è¶£ç¨‹åº¦é€æ¸è€ƒè™‘å¼€æ”¾ä»‹ç»\n4. ç§»åŠ¨ç«¯ï¼ŒæœåŠ¡ç«¯ï¼Œé«˜ç«¯ä¸€ç‚¹çš„åµŒå…¥å¼éƒ½å¯ä»¥çš„","user_name":"ä½œè€…å›å¤","user_name_real":"ç¼–è¾‘","uid":1287929,"ctime":1660717265,"ip_address":"åŒ—äº¬","comment_id":354701,"utype":1}],"discussion_count":1,"race_medal":0,"score":2,"product_id":100117501,"comment_content":"è¯·æ•™è€å¸ˆå‡ ä¸ªé—®é¢˜ï¼š\nQ1ï¼šstatic av_always_inline int64_t avio_tell(AVIOContext *s)ï¼Œav_always_inline ä»€ä¹ˆæ„æ€ï¼Ÿ\nQ2ï¼šæœ‰åŸºäºFFmpegçš„å¼€æºåº”ç”¨å—ï¼Ÿæœ‰çš„è¯éº»çƒ¦æ¨èä¸€ä¸‹å•Šã€‚\nQ3ï¼šå¿«æ‰‹APPï¼ŒéŸ³è§†é¢‘å¤„ç†æ˜¯é‡‡ç”¨FFmpegå—ï¼Ÿ\nQ4ï¼šæˆ‘åˆšæ¥è§¦FFmpegï¼Œå°è±¡ä¸­FFmpegå¯ä»¥ç”¨åœ¨æ‰‹æœºä¸Šã€‚é‚£ä¹ˆï¼Œé™¤äº†ç§»åŠ¨ç«¯å¤–ï¼Œè¿˜æœ‰å“ªäº›åº”ç”¨åœºæ™¯ï¼Ÿ","like_count":0,"discussions":[{"author":{"id":1287929,"avatar":"https://static001.geekbang.org/account/avatar/00/13/a6/f9/79cad962.jpg","nickname":"æ‚Ÿç©º@OnVideo","note":"","ucode":"C320167A9A17B8","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":584266,"discussion_content":"1.ä½ å¯ä»¥ç†è§£å°±æ˜¯cè¯­è¨€é‡Œé¢çš„inlineçš„åŠŸèƒ½ï¼Œå…·ä½“çš„è¿˜å¾—çœ‹ä¸€ä¸‹cè¯­è¨€æ ‡å‡†éƒ¨åˆ†\n2. æ’­æ”¾å™¨ä¸ç”¨ffmpegåº”è¯¥æ¯”è¾ƒå°‘ï¼Œè½¬ç ç³»ç»Ÿä¸ç”¨ffmpegä¹Ÿæ¯”è¾ƒå°‘ï¼Œæ¯”å¦‚ijkplayerï¼Œmpvï¼Œmplayerï¼Œblender,mltframework\n3. æ˜¯çš„ï¼Œä¸è¿‡ä¸å•å•æ˜¯ffmpegï¼Œè¿˜æœ‰OpenGL, AIæ¡†æ¶ï¼Œè‡ªç ”çš„ä¸€äº›æ¡†æ¶ï¼Œå±•æ™“å‡¯è€å¸ˆä¹Ÿè®²äº†ä¸€éƒ¨åˆ†ï¼Œå…¶ä»–çš„å¯èƒ½éœ€è¦çœ‹å¤§ä¼™çš„å…´è¶£ç¨‹åº¦é€æ¸è€ƒè™‘å¼€æ”¾ä»‹ç»\n4. ç§»åŠ¨ç«¯ï¼ŒæœåŠ¡ç«¯ï¼Œé«˜ç«¯ä¸€ç‚¹çš„åµŒå…¥å¼éƒ½å¯ä»¥çš„","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1660717266,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"åŒ—äº¬","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":386021,"user_name":"ifelse","can_delete":false,"product_type":"c1","uid":2550743,"ip_address":"æµ™æ±Ÿ","ucode":"D0565908C99695","user_header":"https://static001.geekbang.org/account/avatar/00/26/eb/d7/90391376.jpg","comment_is_top":false,"comment_ctime":1703842032,"is_pvip":false,"replies":null,"discussion_count":0,"race_medal":3,"score":2,"product_id":100117501,"comment_content":"å­¦ä¹ æ‰“å¡","like_count":0},{"had_liked":false,"id":378049,"user_name":"æ¬¢ä»”","can_delete":false,"product_type":"c1","uid":1053451,"ip_address":"ä¸Šæµ·","ucode":"FBE2105916BB6B","user_header":"https://static001.geekbang.org/account/avatar/00/10/13/0b/14670105.jpg","comment_is_top":false,"comment_ctime":1689690946,"is_pvip":false,"replies":null,"discussion_count":0,"race_medal":0,"score":2,"product_id":100117501,"comment_content":"åŒå±ï¼Œä¸åŒdpiï¼Œå±å¹•ä½ç½®éšæ„ã€‚å½“æˆ‘åœ¨å‰¯å±å¹•ä¸ŠæˆªåŒºåŸŸå½•å±ï¼Œç„¶åä¼ çš„æ˜¯wpf æ§ä»¶åœ¨å±å¹•ä¸Šçš„é¡¶ç‚¹åæ ‡,ä½†æ˜¯å½•å‡ºæ¥çš„åŒºåŸŸä¸å¯¹ï¼ŒæŸ¥äº†ä¸€ä¸‹ï¼Œè¯´æ˜¯å‰¯å±ä¼šæŒ‰ç…§ä¸»å±å¹•çš„dpiè®¡ç®—ï¼Œä¸çŸ¥é“æœ‰æ²¡æœ‰æ¥å£æ˜¯æ¥æ”¶è¿™æ ·çš„å‚æ•°","like_count":0}]}