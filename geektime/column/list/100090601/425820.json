{"id":425820,"title":"12ï½œç»“æ„ï¼šå¦‚ä½•ç³»ç»Ÿè®¾è®¡æ¡†æ¶çš„æ•´ä½“ç›®å½•ï¼Ÿ","content":"<p>ä½ å¥½ï¼Œæˆ‘æ˜¯è½©è„‰åˆƒã€‚</p><p>åˆ°ç°åœ¨ï¼Œæˆ‘ä»¬å·²ç»å°†Giné›†æˆåˆ°æ¡†æ¶hadeä¸­ï¼ŒåŒæ—¶åˆå¼•å…¥äº†æœåŠ¡å®¹å™¨å’ŒæœåŠ¡æä¾›è€…ï¼Œæ˜ç¡®æ¡†æ¶çš„æ ¸å¿ƒæ€æƒ³æ˜¯é¢å‘æœåŠ¡ç¼–ç¨‹ï¼Œä¸€åˆ‡çš†æœåŠ¡ï¼Œæ‰€æœ‰æœåŠ¡éƒ½æ˜¯åŸºäºåè®®ã€‚åç»­ä¹Ÿä¼šä»¥æœåŠ¡çš„å½¢å¼ï¼Œå°è£…ä¸€ä¸ªä¸ªçš„æœåŠ¡ï¼Œè®©æˆ‘ä»¬çš„æ¡†æ¶è¶Šæ¥è¶Šä¸°å¯Œã€‚</p><p>ä½†æ˜¯æœåŠ¡æ–‡ä»¶ä»£ç åº”è¯¥å­˜æ”¾åœ¨å“ªé‡Œå‘¢ï¼Ÿè¿™æ˜¯æˆ‘ä»¬ä¼šæœ€å…ˆé‡åˆ°çš„é—®é¢˜ã€‚ä¸šåŠ¡çš„ç›®å½•ç»“æ„æ˜¯å¦åº”è¯¥æœ‰è§„èŒƒï¼Œåº”è¯¥å¦‚ä½•è§„èŒƒï¼Ÿæ‰€ä»¥ä»Šå¤©è¿™èŠ‚è¯¾æˆ‘ä»¬å°±æ¥è®¨è®ºè¿™ä¸ªé—®é¢˜ï¼Œä»ç³»ç»Ÿçš„è§’åº¦è€ƒè™‘æ¡†æ¶çš„æ•´ä½“ç›®å½•è®¾è®¡ã€‚</p><h2>æ¡†æ¶å’Œä¸šåŠ¡åŒºåˆ†</h2><p>æœ‰äººå¯èƒ½ä¼šé—®äº†ï¼Œæˆ‘ä»¬å†™çš„ä¸æ˜¯ä¸€ä¸ª Web æ¡†æ¶ä¹ˆï¼Œä¸ºä»€ä¹ˆè¦è§„èŒƒä¸šåŠ¡çš„ç›®å½•ç»“æ„ï¼Ÿåƒ Gin æ¡†æ¶ï¼Œå°±æ²¡æœ‰è§„èŒƒä¸šåŠ¡åº”ç”¨çš„ç›®å½•ç»“æ„ï¼Œä¸šåŠ¡æ–¹æ ¹æ®è‡ªå·±çš„éœ€è¦ï¼Œæƒ³æ€ä¹ˆç»„ç»‡ä¸šåŠ¡ç›®å½•å°±æ€ä¹ˆç»„ç»‡ï¼Œä¸å¥½ä¹ˆï¼Ÿä½œä¸ºä¸€ä¸ªæ¡†æ¶ï¼Œæƒ³è§„èŒƒä¸šåŠ¡çš„ç›®å½•ç»“æ„ï¼Œè¿™æ ·åšæ˜¯ä¸æ˜¯æœ‰ç‚¹è¶Šä¿ä»£åº–ï¼Ÿ</p><p>è¿™ä¸ªé—®é¢˜å…¶å®å¾ˆæœ‰æ„ä¹‰ï¼Œæˆ‘ä»¬éœ€è¦ææ¸…æ¥šç›®å½•ç»“æ„åˆ°åº•æ˜¯ç”¨æ¥å¹²ä»€ä¹ˆçš„ã€‚</p><p><strong>ä¸šåŠ¡ä»£ç çš„ç›®å½•ç»“æ„æ˜¯ä¸€ç§å·¥ç¨‹åŒ–çš„è§„èŒƒ</strong>ã€‚æ‰€è°“å·¥ç¨‹åŒ–ï¼Œç®€å•æ¥è¯´å°±æ˜¯å¸Œæœ›ä¸ç®¡æ˜¯è°ï¼Œåœ¨ä¸€ä¸ªå·¥ç¨‹é¡¹ç›®ä¸­ï¼Œéƒ½æŒ‰ç…§ä¸€ç§åšæ³•æ¥å®ŒæˆæŸä¸ªäº‹æƒ…ã€‚è€Œç›®å½•ç»“æ„ï¼Œå°±æ˜¯é¡¹ç›®å·¥ç¨‹åŒ–çš„ä¸€ä¸ªèµ·ç‚¹ã€‚</p><p>åœ¨ä¸€ä¸ªå…¬å¸æˆ–è€…ä¸€ä¸ªéƒ¨é—¨ä¸­ï¼Œå¦‚æœæœ‰æ¶æ„å›¢é˜Ÿï¼ŒåŸºæœ¬ä¸Šè¦åšçš„ç¬¬ä¸€ä¸ªäº‹æƒ…å°±æ˜¯ï¼Œè§„èŒƒå…¬å¸æˆ–è€…éƒ¨é—¨çš„ä»£ç ç›®å½•ç»“æ„ã€‚æ•´ä½“ç›®å½•ç»“æ„ä¸ä»…ä»…ä»£è¡¨ç€åˆ†å±‚ã€å½’çº³ï¼Œä¹ŸåŒ…å«ç€å¾ˆå¤šæ¶æ„çš„æ€æƒ³ã€‚</p><!-- [[[read_end]]] --><p>è€Œå¯¹äº hade æ¡†æ¶è€Œè¨€ï¼Œå› ä¸ºç›®æ ‡æ˜¯å°†æ¡†æ¶åº”ç”¨äºå®é™…ç”Ÿäº§ï¼Œå·¥ç¨‹åŒ–ä½¿ç”¨ï¼Œæ‰€ä»¥å¯¹ä¸šåŠ¡çš„ç›®å½•ç»“æ„ï¼Œ<strong>åˆ¶å®šæœ€å°åŒ–çš„å·¥ç¨‹åŒ–è§„èŒƒï¼Œå¹¶ä¸”æä¾›é»˜è®¤çš„æ•´ä½“ç›®å½•ç»“æ„</strong>æ˜¯å¾ˆæœ‰å¿…è¦çš„ã€‚</p><p>ä¸è¿‡è¯·æ³¨æ„ï¼Œè¿™é‡Œæ˜¯å¸Œæœ›åˆ¶å®šæœ€å°åŒ–çš„å·¥ç¨‹åŒ–è§„èŒƒï¼Œå°±æ˜¯è¯´ï¼Œå¯¹äºè¿™ä¸ªæ¡†æ¶ï¼Œè§„èŒƒæŸäº›æœ€å°åŒ–çš„åŠŸèƒ½æ€§ç›®å½•æ˜¯å¿…è¦çš„ï¼Œå¦‚æœæ²¡æœ‰è¿™äº›åŠŸèƒ½æ€§ç›®å½•ï¼Œæˆ‘ä»¬ä¼šè®¤ä¸ºç›®å½•è®¾è®¡æ˜¯ä¸åˆç†çš„ã€‚</p><p>ä¸‹é¢å°±æ¥è®¨è®ºä¸‹å¦‚ä½•åˆ¶å®šç›®å½•ç»“æ„ã€‚</p><h2>å¦‚ä½•è®¾è®¡</h2><p>åœ¨åˆ¶å®šå…·ä½“çš„ç›®å½•ç»“æ„ä¹‹å‰ï¼Œæˆ‘ä»¬è¦æ˜ç¡®ä¸€ç‚¹ï¼š<strong>ä¸šåŠ¡çš„ç›®å½•ç»“æ„ä¹Ÿæ˜¯ä¸€ä¸ªæœåŠ¡ï¼Œæ˜¯ä¸€ä¸ªåº”ç”¨ç›®å½•æœåŠ¡</strong>ã€‚åœ¨è¿™ä¸ªæœåŠ¡ä¸­ï¼Œæˆ‘ä»¬åˆ¶å®šæ¡†æ¶è¦æ±‚çš„æœ€å°åŒ–çš„å·¥ç¨‹åŒ–è§„èŒƒï¼Œå³æ¡†æ¶è¦æ±‚ä¸šåŠ¡è‡³å°‘æœ‰å“ªäº›ç›®å½•ç»“æ„ã€‚</p><p>è€Œåœ¨å…¶ä»–æœåŠ¡ä¸­ï¼Œä¸€æ—¦éœ€è¦ç”¨åˆ°æŸä¸ªç›®å½•ï¼Œæˆ‘ä»¬èƒ½ä»ç›®å½•ç»“æ„æœåŠ¡ä¸­ï¼ŒæŸ¥æ‰¾å‡ºå¯¹åº”çš„ç»“æ„ã€‚æ¯”å¦‚åç»­è¦åˆ›å»ºé…ç½®æœåŠ¡ï¼Œå®ƒéœ€è¦å»æŸä¸ªé…ç½®ç›®å½•æ–‡ä»¶ä¸­è¯»å–é…ç½®ï¼Œè€Œå»å“ªä¸ªé…ç½®ç›®å½•å‘¢ï¼Œåªéœ€è¦å»æœåŠ¡å®¹å™¨ä¸­è·å–è¿™ä¸ªåº”ç”¨ç›®å½•æœåŠ¡å°±èƒ½çŸ¥é“äº†ã€‚</p><p>æ‰€ä»¥æŒ‰ç…§é¢å‘æ¥å£ç¼–ç¨‹çš„æ€æƒ³ï¼Œå…ˆä¸ºâ€œåº”ç”¨ç›®å½•æœåŠ¡â€å®šä¹‰ä¸€ä¸‹æœåŠ¡æ¥å£åè®®ï¼Œä¹Ÿå°±æ˜¯åº”ç”¨è¦æä¾›å“ªäº›æ¥å£ã€‚</p><p>åœ¨ä»Šåçš„ç« èŠ‚ä¸­ï¼Œæˆ‘ä»¬ä¼šå®šä¹‰è®¸å¤šæ¡†æ¶çº§åˆ«çš„åŸºç¡€æœåŠ¡ï¼Œè¿™äº›æœåŠ¡æˆ‘ä»¬éƒ½å­˜æ”¾åœ¨æ¡†æ¶ç›®å½•ä¸­ã€‚<strong>æœåŠ¡çš„æ¥å£åè®®ï¼Œç»Ÿä¸€æ”¾åœ¨æ¡†æ¶ç›®å½•ä¸‹çš„framework/contractä¸­ï¼Œè€Œå¯¹åº”çš„æœåŠ¡æä¾›è€…å’ŒæœåŠ¡å®ç°ï¼Œç»Ÿä¸€å­˜æ”¾åœ¨æ¡†æ¶ç›®å½•ä¸‹çš„framework/providerä¸­</strong>ã€‚</p><p>è¿™é‡Œå°†æ‰€æœ‰æ¡†æ¶çº§åˆ«çš„æ¥å£åè®®æ”¾åœ¨framework/contractä¸­çš„è®¾è®¡æœ‰ä¸¤ä¸ªå¥½å¤„ã€‚</p><p>ä¸€æ˜¯æ¡†æ¶åè®®çš„å…³é”®å­—ï¼Œæˆ‘å¸Œæœ›ä½¿ç”¨contract.xxx è¿™ä¸ªè¯­ä¹‰æ¥åŒºåˆ†ï¼Œæ¯”å¦‚AppæœåŠ¡çš„æ¥å£ä¸ºcontract.Appã€æ—¥å¿—æœåŠ¡çš„æ¥å£ä¸ºcontract.Logï¼Œå®ƒä»¬çš„namespaceéƒ½æ˜¯contractï¼Œè¿™æ ·åœ¨ä½¿ç”¨çš„æ—¶å€™è®°å¿†æˆæœ¬ä¼šæ¯”è¾ƒä½ã€‚å¦å¤–å°†æ¡†æ¶æä¾›çš„æ‰€æœ‰æ¥å£åè®®éƒ½æ”¾åœ¨ä¸€ä¸ªæ–‡ä»¶å¤¹ä¸­ï¼Œåœ¨é˜…è¯»æ¡†æ¶æä¾›å“ªäº›æœåŠ¡çš„æ—¶å€™ï¼Œä¹Ÿæ›´æ¸…æ™°æ˜äº†ã€‚</p><p>ä»¥â€œåº”ç”¨ç›®å½•æœåŠ¡â€ä¸ºä¾‹ï¼Œæˆ‘ä»¬åœ¨framework/contractç›®å½•ä¸­åˆ›å»ºapp.go å­˜æ”¾æœåŠ¡åè®®ã€‚åœ¨framework/contract/app.goä¸­ï¼Œæˆ‘ä»¬å®šä¹‰åº”ç”¨ç›®å½•æœåŠ¡æ¥å£åç§°ä¸º Appï¼Œä»£è¡¨æ•´ä¸ªåº”ç”¨ã€‚å®ƒå¯¹åº”çš„æœåŠ¡å­—ç¬¦ä¸²å‡­è¯ä¸ºâ€œhade:appâ€ã€‚</p><pre><code class=\"language-go\">const AppKey = \"hade:app\"\n</code></pre><p>è¿™ä¸ªæ¥å£çš„æŠ½è±¡ï¼Œæˆ‘ä»¬æŒ‰ç…§åˆ›å»ºåº”ç”¨éœ€è¦å“ªäº›ç›®å½•çš„é¡ºåºæ¥æ€è€ƒã€‚</p><p>é¦–å…ˆåˆ›å»ºä¸€ä¸ªåº”ç”¨éœ€è¦æ˜ç¡®åº”ç”¨æ‰€åœ¨çš„æ ¹ç›®å½•ï¼Œè¿™ä¸ªå°±æ˜¯æ ¹ç›®å½• BaseFolderï¼›å…¶æ¬¡ï¼Œæˆ‘ä»¬éœ€è¦ä¸€ä¸ªç›®å½•ä¿å­˜é…ç½®æ–‡ä»¶ï¼Œæ‰€ä»¥è¦æœ‰ä¸€ä¸ªé…ç½®æ–‡ä»¶çš„ç›®å½• ConfigFolderï¼›åº”ç”¨è¦è¾“å‡ºæ—¥å¿—ï¼Œæ—¥å¿—è¾“å‡ºçš„å­˜æ”¾è·¯å¾„ä¹Ÿæ˜¯éœ€è¦è®¾ç½®çš„ï¼Œæ‰€ä»¥æˆ‘ä»¬å†åˆ›å»ºä¸€ä¸ª LogFolder æ¥è®¾ç½®æ—¥å¿—å­˜æ”¾ã€‚</p><p>å†è€ƒè™‘ä¸‹ï¼Œä¸šåŠ¡çš„æœåŠ¡æä¾›è€…å’Œå¯¹åº”æ¥å£éœ€è¦æœ‰ä¸€ä¸ªåœ°æ–¹å­˜æ”¾ï¼Œæˆ‘ä»¬å°†å…¶å‘½åä¸º ProviderFolderã€‚åŒæ—¶ï¼Œæˆ‘ä»¬ä¸šåŠ¡ä¹Ÿæœ‰å¯èƒ½åˆ›å»ºè‡ªå·±çš„ä¸­é—´ä»¶ï¼Œæ‰€ä»¥éœ€è¦æœ‰ä¸ª MiddlewareFolder æ¥å­˜æ”¾ä¸­é—´ä»¶ã€‚</p><p>åœ¨åç»­çš„ç« èŠ‚ä¸­ï¼Œæˆ‘ä»¬é¢„è®¡è®©æ¡†æ¶æ”¯æŒå‘½ä»¤è¡Œå‘½ä»¤ï¼Œå¹¶ä¸”ä½¿ç”¨å‘½ä»¤è¡Œæ¥æ§åˆ¶è¿›ç¨‹çš„è¿è¡Œæ—¶çŠ¶æ€ï¼Œæ‰€ä»¥éœ€è¦æœ‰ä¸ª CommandFolder æ¥å­˜æ”¾å„ç§å‘½ä»¤è¡Œå‘½ä»¤ã€ä¸€ä¸ª RuntimeFolder æ¥å­˜æ”¾è¿è¡Œæ—¶çš„è¿›ç¨‹ ID ç­‰ä¿¡æ¯ã€‚</p><p>æœ€åå½“ç„¶äº†è¿˜éœ€è¦æœ‰ä¸€ä¸ªæ–‡ä»¶æ¥å­˜æ”¾å•å…ƒæµ‹è¯•ä¿¡æ¯ï¼Œæ¯”å¦‚å•å…ƒæµ‹è¯•çš„åˆå§‹åŒ–å’Œç»ˆæ­¢çš„ä¸€äº›é»˜è®¤æ“ä½œç­‰ï¼Œæ‰€ä»¥æˆ‘ä»¬æœ‰ä¸€ä¸ª TestFolder ç›®å½•ã€‚</p><p>æŒ‰ç…§ç›®å‰èƒ½æƒ³åˆ°çš„éœ€æ±‚ï¼Œå¯ä»¥å°†ç›®å½•å…ˆåˆ†ä¸ºè¿™äº›æ–‡ä»¶å¤¹ï¼Œåç»­åœ¨å¼€å‘æ¨¡å—çš„è¿‡ç¨‹ä¸­ï¼Œé‡åˆ°éœ€è¦å¢åŠ çš„ç›®å½•ï¼Œæˆ‘ä»¬è¿˜å¯ä»¥ç»§ç»­è¿­ä»£ä¿®æ”¹ App æ¥å£ã€‚</p><p>æŒ‰ç…§ä»¥ä¸Šçš„åˆ†æï¼Œæˆ‘ä»¬åœ¨æ¡†æ¶çš„framework/contract/app.goä¸­å®šä¹‰äº†ä¸€ä¸ª App çš„æœåŠ¡æ¥å£ï¼š</p><pre><code class=\"language-go\">package contract\n// AppKey å®šä¹‰å­—ç¬¦ä¸²å‡­è¯\nconst AppKey = \"hade:app\"\n// App å®šä¹‰æ¥å£\ntype App interface {\n   // Version å®šä¹‰å½“å‰ç‰ˆæœ¬\n   Version() string\n   //BaseFolder å®šä¹‰é¡¹ç›®åŸºç¡€åœ°å€\n   BaseFolder() string\n   // ConfigFolder å®šä¹‰äº†é…ç½®æ–‡ä»¶çš„è·¯å¾„\n   ConfigFolder() string\n   // LogFolder å®šä¹‰äº†æ—¥å¿—æ‰€åœ¨è·¯å¾„\n   LogFolder() string\n   // ProviderFolder å®šä¹‰ä¸šåŠ¡è‡ªå·±çš„æœåŠ¡æä¾›è€…åœ°å€\n   ProviderFolder() string\n   // MiddlewareFolder å®šä¹‰ä¸šåŠ¡è‡ªå·±å®šä¹‰çš„ä¸­é—´ä»¶\n   MiddlewareFolder() string\n   // CommandFolder å®šä¹‰ä¸šåŠ¡å®šä¹‰çš„å‘½ä»¤\n   CommandFolder() string\n   // RuntimeFolder å®šä¹‰ä¸šåŠ¡çš„è¿è¡Œä¸­é—´æ€ä¿¡æ¯\n   RuntimeFolder() string\n   // TestFolder å­˜æ”¾æµ‹è¯•æ‰€éœ€è¦çš„ä¿¡æ¯\n   TestFolder() string\n}\n</code></pre><h2>å®šä¹‰é»˜è®¤ç›®å½•ç»“æ„</h2><p>å®šä¹‰å¥½äº†åº”ç”¨ç›®å½•æœåŠ¡æ¥å£ï¼Œæˆ‘ä»¬å†æ¥æ€è€ƒå®ƒçš„å®ç°ï¼Œä¹Ÿå°±æ˜¯è®¾è®¡ä½¿ç”¨è¿™ä¸ª hade æ¡†æ¶çš„åº”ç”¨çš„é»˜è®¤ç›®å½•ã€‚</p><p>ç›®å½•ç»“æ„çš„è®¾è®¡æˆ‘ä»¬å¯ä»¥å…ˆå»çœ‹çœ‹å¸‚é¢ä¸Šçš„ä¼˜ç§€æ¡†æ¶ï¼Œè¿™é‡ŒæŒ‘é€‰çš„æ˜¯ PHP ç›®å‰æœ€ç«çš„åº”ç”¨æ¡†æ¶ <a href=\"https://github.com/laravel/laravel\">Laravel</a>ï¼Œå®ƒçš„ç›®å½•è®¾è®¡éå¸¸å€¼å¾—æˆ‘ä»¬å­¦ä¹ å’Œå‚è€ƒï¼Œ<strong>å¾ˆåˆç†åœ°å°†å„ä¸ªåŠŸèƒ½æ¨¡å—æ”¾åœ¨å„è‡ªçš„æ–‡ä»¶ï¼Œå¹¶ä¸”æ–‡ä»¶å®šä¹‰æ¸…æ™°ã€æ— æ­§ä¹‰</strong>ã€‚æ‰€ä»¥æœ‰äº†ä¸‹é¢è¿™ä¸ªé»˜è®¤ç›®å½•ç»“æ„ï¼Œæˆ‘ä»¬æ¥è§£é‡Šä¸‹å¯¹åº”çš„æ¯ä¸ªç›®å½•ã€‚</p><p><img src=\"https://static001.geekbang.org/resource/image/13/b7/131d82414bda554aa5d28a60a05801b7.png?wh=335x744\" alt=\"å›¾ç‰‡\"></p><p>åœ¨æ ¹ç›®å½•ä¸‹ï¼Œæœ‰äº”ä¸ªæ–‡ä»¶ï¼šappã€frameworkã€configã€storageã€testï¼Œæˆ‘ä»¬ä¸€ä¸ªä¸ªæè¿°åŠŸèƒ½çœ‹çœ‹ä¸‹é¢éƒ½åº”è¯¥æ€ä¹ˆåˆ’åˆ†ã€‚</p><h3>app ç›®å½•</h3><p>ä¸€ä¸ªä¸šåŠ¡å°±æ˜¯ä¸€ä¸ª Appï¼Œå’Œä¸šåŠ¡ä»£ç ç›¸å…³çš„ï¼Œæ¯”å¦‚æ‰€æœ‰çš„è¯·æ±‚ã€æ§åˆ¶å°å‘½ä»¤ã€æ§åˆ¶å™¨ã€æœåŠ¡æä¾›è€…ç­‰éƒ½æ”¾åœ¨è¿™ä¸ªç›®å½•ä¸­ï¼Œè€Œä¸šåŠ¡é€»è¾‘ä»£ç ä¹‹å¤–çš„ï¼Œæ¯”å¦‚é…ç½®æ–‡ä»¶ã€ç¼“å­˜ã€æ—¥å¿—ç­‰ï¼Œéƒ½æ”¾åœ¨å¤–é¢ã€‚è¿™æ ·èƒ½æŠŠâ€œä¸šåŠ¡é€»è¾‘â€å’Œâ€œéä¸šåŠ¡é€»è¾‘â€åŒºåˆ†å¾—æ›´æ¸…æ™°ã€‚</p><p>æˆ‘ä»¬ç»§ç»­çœ‹ä¸šåŠ¡é€»è¾‘ç›®å½• app ä¸‹æœ‰å“ªäº›å­ç›®å½•ã€‚</p><p><img src=\"https://static001.geekbang.org/resource/image/62/37/62fd7201f0690235a505acda04e18337.jpg?wh=335x416\" alt=\"å›¾ç‰‡\"></p><p>ç¬¬ä¸€å±‚æœ‰ä¸‰ä¸ªç›®å½•ï¼šconsoleã€httpã€providerã€‚å› ä¸ºä¸šåŠ¡é™¤äº†æä¾› Web æœåŠ¡ï¼Œä¹Ÿæä¾›æ§åˆ¶å°è¿›ç¨‹ï¼Œæ‰€ä»¥åœ¨ app ç›®å½•ä¸‹æœ‰ä¸¤ä¸ªå­ç›®å½•ï¼šä¸€ä¸ªæ˜¯ consoleï¼Œä¸šåŠ¡ä¸­æ‰€æœ‰çš„æ§åˆ¶å°è¿›ç¨‹é€»è¾‘éƒ½æ”¾åœ¨è¿™é‡Œï¼›è€Œå¦ä¸€ä¸ªå°±æ˜¯ http ç›®å½•ï¼Œæ‰€æœ‰ Web æœåŠ¡çš„é€»è¾‘éƒ½å­˜æ”¾åœ¨é‡Œé¢ã€‚</p><p>åŒæ—¶è¿™ä¸¤è€…æœ‰å¾ˆå¤šé€»è¾‘æ˜¯é€šç”¨çš„ï¼Œæ¯”å¦‚æœ‰å¯èƒ½ç”¨åˆ°åŒä¸€ä¸ªæœåŠ¡æä¾›è€…ï¼Œæ‰€ä»¥æˆ‘ä»¬å°†ä¸¤è€…é€šç”¨çš„æœåŠ¡æä¾›è€…çš„ä»£ç  provider ç›®å½•ï¼Œä¹Ÿæ”¾åœ¨ app ç›®å½•ä¸‹ã€‚</p><p>å†çœ‹ç¬¬äºŒå±‚çš„ç»†åˆ†ç›®å½•ã€‚</p><ul>\n<li>é¦–å…ˆæ˜¯ app ç›®å½•ä¸‹çš„ consoleï¼Œå­˜æ”¾çš„æ˜¯æ‰€æœ‰å‘½ä»¤è¡Œå·¥å…·çš„é€»è¾‘ä»£ç ã€‚</li>\n</ul><p>æ§åˆ¶å°å‘½ä»¤è®¾è®¡ä¸ºå¤šçº§å‘½ä»¤ï¼Œæ¯”å¦‚åœ¨å‘½ä»¤  <code>./hade task info</code> ä¸­ï¼Œhade æ˜¯å‘½ä»¤è¡Œå·¥å…·ï¼Œtask ä¸ºä¸€çº§å‘½ä»¤ï¼Œinfo ä¸ºäºŒçº§å‘½ä»¤ã€‚æ‰€ä»¥åœ¨ console ç›®å½•ä¸‹ï¼Œæˆ‘ä»¬è¦åˆ›å»ºä¸€ä¸ª command ç›®å½•ï¼Œå¹¶ä¸” command ç›®å½•ä¸‹æŒ‰ç…§ä¸€çº§ã€äºŒçº§â€¦â€¦é€’å½’ä¿å­˜ã€‚ï¼ˆå…³äºå‘½ä»¤è¡Œå·¥å…·çš„æ›´å¤šè¯¦ç»†è®¾è®¡å’Œå®ç°æˆ‘ä»¬åœ¨ä¸‹èŠ‚è¯¾å®ç°ã€‚ï¼‰</p><ul>\n<li>æä¾› Web æœåŠ¡çš„ http ç›®å½•è¿˜æœ‰æ›´ç»†çš„å±‚çº§ã€‚</li>\n</ul><p>HTTP æœåŠ¡ä¸€èˆ¬ä¼šæŒ‰ç…§æ¨¡å—åˆ’åˆ†ï¼Œæ¯”å¦‚ä¸€ä¸ªå›¾ä¹¦é¦†ä¸šåŠ¡ï¼Œæˆ‘ä»¬ä¼šåˆ†ä¸ºæ³¨å†Œæ¨¡å—ã€å›¾ä¹¦æ¨¡å—ã€ç”¨æˆ·æ¨¡å—ç­‰ï¼Œæ‰€ä»¥æˆ‘ä»¬åœ¨ http ç›®å½•ä¸‹å®šä¹‰äº†ä¸€ä¸ª module ç›®å½•ï¼Œè¿™ä¸ª module ç›®å½•ä¸‹æ¯ä¸ªå­ç›®å½•ä»£è¡¨ä¸€ä¸ªæ¨¡å—æœåŠ¡ã€‚è€Œ Web æœåŠ¡ç‰¹æœ‰çš„é€šç”¨ä¸­é—´ä»¶ï¼Œæˆ‘ä»¬ä½¿ç”¨ http ç›®å½•ä¸‹çš„ middleware ç›®å½•æ¥ä¿å­˜ã€‚</p><ul>\n<li>app ä¸‹çš„ provider ç›®å½•ï¼Œæä¾›çš„æ˜¯å®šä¹‰ä¸€ä¸ªæœåŠ¡éœ€è¦çš„æ–‡ä»¶ã€‚</li>\n</ul><p>åœ¨ provider ç›®å½•ä¸­ï¼Œæ¯ä¸ªå­ç›®å½•å°±ä»£è¡¨ä¸€ä¸ªä¸šåŠ¡æœåŠ¡ã€‚è€ŒæŒ‰ç…§ä¸Šä¸€èŠ‚è¯¾æè¿°çš„ï¼Œæ¯ä¸ªæœåŠ¡éƒ½éœ€è¦æœ‰ä¸‰ä¸ªæ–‡ä»¶ï¼šä»£è¡¨æœåŠ¡åè®®çš„ contract.go æ–‡ä»¶ã€ä»£è¡¨æœåŠ¡æä¾›è€…çš„ provider.go æ–‡ä»¶ï¼Œä»¥åŠä»£è¡¨å…·ä½“æœåŠ¡å®ç°çš„ service.go æ–‡ä»¶ã€‚</p><p>è¿™é‡Œè¦å¼ºè°ƒæ˜¯ï¼Œè¿™ä¸ª provider ç›®å½•å­˜æ”¾ä¸šåŠ¡æä¾›çš„æœåŠ¡ï¼Œè€Œæ¡†æ¶æä¾›çš„æœåŠ¡ï¼Œæˆ‘ä»¬ä¼šæ”¾åœ¨ framework ç›®å½•ä¸‹ã€‚</p><p>app ç›®å½•æˆ‘ä»¬è§£é‡Šå®Œäº†ï¼Œä¸‹é¢æ¥ç ”ç©¶æ ¹ç›®å½•ä¸‹çš„å…¶ä»–å‡ ä¸ªæ–‡ä»¶å¤¹ã€‚</p><h3>framework ç›®å½•</h3><p>framework ç›®å½•å°±æ˜¯æˆ‘ä»¬è¿™ä¸ªæ¡†æ¶æ‰€æœ‰çš„ä»£ç ã€‚åœ¨è¿™ä¸ªç›®å½•é‡Œï¼Œé™¤äº†ä¹‹å‰å¼•å…¥äº† Gin æ¡†æ¶æœ‰çš„ gin ç›®å½•ï¼Œè¿˜æœ‰ä¸€äº›å­ç›®å½•ï¼šcommandã€contractã€middlewareã€providerã€utilã€‚</p><p><img src=\"https://static001.geekbang.org/resource/image/4f/2d/4f357e976abebac4b5cfafdcb2b1e72d.png?wh=321x647\" alt=\"å›¾ç‰‡\"></p><p>è¿™å‡ ä¸ªç›®å½•çš„åŠŸèƒ½ä¹Ÿæ¯”è¾ƒå¥½ç†è§£ã€‚command æä¾›çš„æ˜¯æ¡†æ¶è‡ªå¸¦çš„å‘½ä»¤è¡Œå·¥å…·ï¼›middleware å­˜æ”¾æ¡†æ¶ä¸º Web æœåŠ¡æä¾›çš„ä¸­é—´ä»¶ï¼›contract å­˜æ”¾æ¡†æ¶é»˜è®¤æä¾›çš„æœåŠ¡åè®®ï¼›è€Œå¯¹åº”æœåŠ¡åè®®çš„å…·ä½“å®ç°ä»¥åŠæœåŠ¡æä¾›è€…ï¼Œæˆ‘ä»¬å­˜æ”¾åœ¨ provider ç›®å½•ä¸‹ï¼›util ç›®å½•åˆ™å­˜æ”¾åœ¨æ¡†æ¶ç ”å‘è¿‡ç¨‹ä¸­é€šç”¨çš„ä¸€äº›å‡½æ•°ã€‚</p><p>ä¸éš¾å‘ç°ï¼Œproviderå’Œcommandçš„æœåŠ¡ï¼Œåœ¨ä¸šåŠ¡ï¼ˆappç›®å½•ï¼‰å’Œæ¡†æ¶ï¼ˆframeworkç›®å½•ï¼‰å±‚é¢éƒ½æœ‰ç›¸åŒçš„ç›®å½•ï¼ŒåŒºåˆ«å°±æ˜¯ä¸€ä¸ªæ˜¯ä¸šåŠ¡æä¾›çš„ï¼Œä¸€ä¸ªæ˜¯æ¡†æ¶æä¾›çš„ã€‚</p><p>æˆ‘ä»¬è¿™ä¸ªé¡¹ç›®ä¸ºäº†æ¼”ç¤ºæ¡†æ¶å¼€å‘çš„å…¨è¿‡ç¨‹ï¼ŒæŠŠæ¡†æ¶å’Œä¸šåŠ¡åˆå¹¶åœ¨ä¸€èµ·ï¼Œä½†æ˜¯å› ä¸ºæœ€ç»ˆç‰ˆæ¡†æ¶åœ¨å¼€æºå‘å¸ƒçš„æ—¶å€™ï¼Œframework ç›®å½•æ˜¯ä¼šå‰¥ç¦»å‡ºå»ï¼Œä½œä¸ºä¸€ä¸ªå•ç‹¬çš„ git é¡¹ç›®çš„ã€‚æ‰€ä»¥ï¼Œ<strong>ä½ åœ¨å¼€å‘çš„æ—¶å€™è¦æ—¶åˆ»æ˜ç¡®ï¼Œå“ªäº›æ˜¯æ¡†æ¶æä¾›çš„å‘½ä»¤è¡Œå·¥å…·å’ŒæœåŠ¡ï¼Œå“ªäº›æ˜¯ä¸šåŠ¡æä¾›çš„å‘½ä»¤è¡Œå’ŒæœåŠ¡</strong>ã€‚æ¡†æ¶çš„å†…å®¹éœ€è¦æ”¾åœ¨ framework ç›®å½•ä¸‹ï¼Œä¸šåŠ¡çš„å°±è¦æ”¾åœ¨ framework å¤–ã€‚</p><h3>configã€storageã€test ç›®å½•</h3><p>åœ¨åº”ç”¨æ ¹ç›®å½•ä¸‹è¿˜å‰© config ã€storageã€test ç›®å½•ã€‚configè¿™ä¸ªç›®å½•å­˜æ”¾çš„æ˜¯é…ç½®æ–‡ä»¶ï¼Œè‡³äºä¸åŒç¯å¢ƒçš„é…ç½®æ–‡ä»¶å¦‚ä½•å­˜æ”¾å’Œç»„ç»‡ï¼Œæˆ‘ä»¬åé¢ä¼šç»Ÿä¸€æ¢è®¨æ•´ä½“çš„é…ç½®æ–‡ä»¶å­˜æ”¾æœºåˆ¶ã€‚test ç›®å½•å­˜æ”¾çš„æ˜¯æµ‹è¯•ç›¸å…³çš„ä¿¡æ¯ï¼Œæ¯”å¦‚æµ‹è¯•ç”¨ä¾‹æˆ–è€…æµ‹è¯•æ•°æ®ç­‰ä¿¡æ¯ã€‚</p><p>åº”ç”¨æ ¹ç›®å½•ä¸‹çš„ storage å­˜æ”¾åº”ç”¨è¿è¡Œè¿‡ç¨‹ä¸­äº§ç”Ÿçš„å†…å®¹ã€‚é¦–å…ˆæ˜¯æ—¥å¿—ï¼Œæ—¥å¿—æ˜¯åº”ç”¨è¿è¡Œè¿‡ç¨‹ä¸­å¿…ç„¶äº§ç”Ÿçš„ä¿¡æ¯ï¼Œåœ¨ storage ä¸‹çš„ log å­ç›®å½•é‡Œä¿å­˜ï¼›å…¶æ¬¡æ˜¯è¿è¡Œçš„è¿›ç¨‹ ID ç­‰ä¿¡æ¯ï¼Œè¿™äº›éƒ½ä¼šå­˜æ”¾åœ¨ storage ä¸‹çš„ runtime ç›®å½•ä¸­ã€‚</p><p>å¥½ï¼Œç›®å½•ç»“æ„è®²å®Œäº†ï¼Œæˆ‘ä»¬æ•´ç†ä¸‹ï¼Œä»åº”ç”¨æ ¹ç›®å½•å¼€å§‹ï¼Œåˆ†ä¸º 5 ä¸ªå­ç›®å½•appã€frameworkã€configã€storageã€testï¼Œå…¶ä¸­ï¼š</p><ul>\n<li>app æŒ‰åº”ç”¨çš„ä½¿ç”¨æ–¹å¼å’Œé€šç”¨æ€§åˆ†ä¸º console å’Œ httpï¼Œä»¥åŠé€šç”¨çš„ provider ç›®å½•ã€‚framework æ ¹æ®æ¡†æ¶éœ€è¦æä¾›çš„åŠŸèƒ½åˆ†ä¸º commandã€contractã€ginã€middlewareã€providerå’Œutil 6 ä¸ªå­ç›®å½•ã€‚</li>\n<li>config å’Œ test åˆ†åˆ«ä¿å­˜é…ç½®å’Œæµ‹è¯•ç›¸å…³çš„ä¿¡æ¯ï¼›storage ç›®å½•ä¿å­˜åº”ç”¨è¿è¡Œäº§ç”Ÿçš„ä¿¡æ¯ï¼Œåˆ†ä¸º log å’Œ runtime ä¸¤ä¸ªç›®å½•ã€‚</li>\n</ul><h2>é»˜è®¤ç›®å½•çš„å®ç°</h2><p>åœ¨ä»Šå¤©æœ€å¼€å§‹æˆ‘ä»¬è¯´äº†ï¼Œç›®å½•ç»“æ„ä¹Ÿæ˜¯ä¸€ä¸ªæœåŠ¡ï¼Œå…¶ä»–æœåŠ¡æƒ³è¦ä½¿ç”¨ç›®å½•ç»“æ„çš„æ—¶å€™ï¼Œå¯ä»¥é€šè¿‡æœåŠ¡å®¹å™¨ï¼Œæ¥è·å–ç›®å½•ç»“æ„æœåŠ¡å®ä¾‹ã€‚è€Œç°åœ¨æˆ‘ä»¬æœ‰äº†æƒ³è¦åˆ›å»ºçš„é»˜è®¤ç›®å½•ç»“æ„ï¼Œé‚£ä¹ˆä¸‹é¢å°±è¦å®ç°è¿™ä¸ªç›®å½•ç»“æ„æœåŠ¡å®ä¾‹äº†ã€‚</p><p>æˆ‘ä»¬å®šä¹‰ä¸€ä¸ª HadeApp æ¥å®ç°è¿™ä¸ªç›®å½•ç»“æ„æœåŠ¡æ¥å£ï¼Œ<strong>è¿™ä¸ª HadeApp ç»“æ„çš„å…ƒç´ é™¤äº†æœåŠ¡å®ä¾‹ä¹‹å¤–ï¼Œåªéœ€è¦ä¸€ä¸ªé¡¹ç›®çš„åŸºç¡€è·¯å¾„ basePath</strong>ã€‚å› ä¸ºæˆ‘ä»¬è®¾è®¡çš„é»˜è®¤ç›®å½•ç»“æ„åªè¦æœ‰äº†è¿™ä¸ª basePathï¼Œå°±å¯ä»¥æŒ‰ç…§è®¾è®¡æ‰¾å‡ºå…¶ä½™çš„æ‰€æœ‰ç›®å½•äº†ã€‚</p><p>æˆ‘ä»¬åœ¨framework/provider/app/service.goä¸­å®šä¹‰HadeAppç»“æ„ï¼š</p><pre><code class=\"language-go\">// HadeApp ä»£è¡¨ hade æ¡†æ¶çš„ App å®ç°\ntype HadeApp struct {\n   container framework.Container // æœåŠ¡å®¹å™¨\n   baseFolder  string              // åŸºç¡€è·¯å¾„\n}\n</code></pre><p>çœ‹æœ€é‡è¦çš„ BaseFolder çš„å®ç°æ€è·¯ã€‚</p><p>BaseFolder æ˜¯è·å–é¡¹ç›®çš„åŸºç¡€è·¯å¾„ï¼Œæ‰€ä»¥æˆ‘ä»¬å¯ä»¥æä¾›ä¸€ç§æ–¹å¼ï¼Œåœ¨æ³¨å†ŒæœåŠ¡æä¾›è€…çš„æ—¶å€™ï¼Œå®ç° BaseFolder çš„è®¾ç½®ã€‚æ¥çœ‹ä»£ç ï¼Œè®¾ç½® hade æ¡†æ¶é»˜è®¤çš„ App æœåŠ¡æä¾›è€…ä¸º HadeAppProviderï¼Œå®ƒå¸¦æœ‰ä¸€ä¸ªå¯ä»¥è®¾ç½®çš„å±æ€§ BaseFolderï¼Œè¿™ä¸ªå±æ€§ä½œä¸ºå‚æ•°ä¼ å…¥ç»™æœåŠ¡å®ä¾‹åˆå§‹åŒ–å‡½æ•°ã€‚</p><p>æˆ‘ä»¬åœ¨framework/provider/app/provider.goä¸­å®šä¹‰HadeAppProviderç»“æ„å’Œæ–¹æ³•ï¼š</p><pre><code class=\"language-go\">// HadeAppProvider æä¾› App çš„å…·ä½“å®ç°æ–¹æ³•\ntype HadeAppProvider struct {\n   BaseFolder string\n}\n\n...\n\n// Params è·å–åˆå§‹åŒ–å‚æ•°\nfunc (h *HadeAppProvider) Params(container framework.Container) []interface{} {\n   return []interface{}{container, h.BaseFolder}\n}\n...\n\n\n\n// NewHadeApp åˆå§‹åŒ– HadeApp\nfunc NewHadeApp(params ...interface{}) (interface{}, error) {\n   if len(params) != 2 {\n      return nil, errors.New(\"param error\")\n   }\n   // æœ‰ä¸¤ä¸ªå‚æ•°ï¼Œä¸€ä¸ªæ˜¯å®¹å™¨ï¼Œä¸€ä¸ªæ˜¯ baseFolder\n   container := params[0].(framework.Container)\n   baseFolder := params[1].(string)\n   return &amp;HadeApp{baseFolder: baseFolder, container: container}, nil\n}\n</code></pre><p>è¿™æ ·ï¼Œåœ¨ä¸šåŠ¡ç›®å½•çš„main.goä¸­æ³¨å†Œ App æœåŠ¡çš„æ—¶å€™ï¼Œå°±å¯ä»¥åˆ›å»ºæŒ‡å®šæˆ‘ä»¬çš„ BaseFolderï¼š</p><pre><code class=\"language-go\">func main() {\n   // åˆ›å»º engine ç»“æ„\n   core := gin.New()\n   // æŒ‡å®š BaseFolder\n   core.Bind(&amp;app.HadeAppProvider{BaseFolder: \"/tmp\"})\n   ...\n}\n</code></pre><p>ä½†æ˜¯åˆšæ‰çš„å®ç°åœ¨æ¯æ¬¡æ³¨å†ŒæœåŠ¡çš„æ—¶å€™ï¼Œéƒ½éœ€è¦è®¾ç½®ä¸€éï¼Œä¸ºäº†æé«˜æ˜“ç”¨æ€§ï¼Œæˆ‘ä»¬å¸Œæœ›è¿™ä¸ª BaseFolder èƒ½è‡ªåŠ¨è®¾ç½®ã€‚æ€ä¹ˆåŠï¼Ÿ</p><p>è¿™é‡Œè¦å…ˆè€ƒè™‘ä½¿ç”¨è¿™ä¸ªæ¡†æ¶å¼€å‘çš„ä¸šåŠ¡çš„åœºæ™¯æœ‰å“ªäº›ï¼Œä¸€èˆ¬æ¥è¯´ä¼šæœ‰ä¸¤ä¸ªï¼Œå¼€å‘åœºæ™¯å’Œè¿è¡Œåœºæ™¯ã€‚</p><p>åœ¨å¼€å‘åœºæ™¯ä¸­ï¼Œæˆ‘ä»¬<strong>åœ¨å¼€å‘ä¸šåŠ¡ä»£ç æ—¶ï¼Œè¿™ä¸ª BaseFolder ä»£è¡¨ä¸šåŠ¡çš„å¼€å‘è·¯å¾„ï¼Œå³ä¸šåŠ¡ä»£ç æ‰€åœ¨çš„ç›®å½•ï¼›è€Œåœ¨å¦ä¸€ä¸ªè¿è¡Œåœºæ™¯ä¸­ï¼Œæ¡†æ¶å¼€å‘çš„ä¸šåŠ¡éœ€è¦å»ç°ç½‘ï¼Œä¹Ÿå°±æ˜¯ç”Ÿäº§ç¯å¢ƒä¸­è¿è¡Œ</strong>ï¼Œåªéœ€è¦äºŒè¿›åˆ¶æ–‡ä»¶ã€é…ç½®æ–‡ä»¶ã€æ—¥å¿—æ–‡ä»¶å³å¯ï¼Œå› ä¸ºè¿™æ—¶å€™çš„ BaseFolder å…¶å®æ˜¯ä¼šæ ¹æ®é¡¹ç›®éƒ¨ç½²åœ°å€å˜åŒ–çš„ã€‚</p><p>æ‰€ä»¥å¯¹äºç¬¬ä¸€ç§åœºæ™¯ï¼Œæˆ‘ä»¬æä¾›è·å–å½“å‰å¼€å‘è·¯å¾„çš„æ–¹æ³•ï¼Œå¯ä»¥ä½¿ç”¨ Golang æ ‡å‡†åº“çš„ os.Getwd() æ–¹æ³•è·å–åˆ°å½“å‰æ‰€åœ¨çš„å¼€å‘è·¯å¾„ã€‚</p><pre><code class=\"language-go\">// GetExecDirectory è·å–å½“å‰æ‰§è¡Œç¨‹åºç›®å½•\nfunc GetExecDirectory() string {\n   file, err := os.Getwd()\n   if err == nil {\n      return file + \"/\"\n   }\n   return \"\"\n}\n</code></pre><p>è€Œå¯¹äºç¬¬äºŒç§è¿è¡Œåœºæ™¯ï¼Œæˆ‘ä»¬å¸Œæœ›è¿™ä¸ª BaseFolder åœ¨è¿è¡Œçš„æ—¶å€™å†æŒ‡å®šã€‚æ‰€ä»¥å¯ä»¥<strong>ä¸ºç¨‹åºè®¾è®¡ä¸€ä¸ª base_folder å‚æ•°ï¼Œè¿™æ ·åœ¨è¿è¡Œçš„æ—¶å€™ï¼Œå°±è§£æå‚æ•°å°†BaseFolder è®¾ç½®å¯¹åº”å€¼</strong>ã€‚å€Ÿç”¨ Golang çš„ flag æ ‡å‡†åº“ï¼Œæˆ‘ä»¬èƒ½å¾ˆå®¹æ˜“åšåˆ°è§£æå‚æ•°ã€è·å–å‚æ•°ã€‚</p><p>BaseFolder çš„ä»£ç å®ç°å¦‚ä¸‹ï¼Œå…¶ä¸­æœ‰ä¸¤æ¬¡åˆ¤æ–­ã€‚æˆ‘ä»¬å…ˆåˆ¤æ–­æœåŠ¡æä¾›è€…æ˜¯å¦æœ‰æŒ‡å®šï¼Œå¦‚æœæœ‰æŒ‡å®šçš„è¯ä½¿ç”¨æŒ‡å®šå€¼ï¼Œå¦‚æœæ²¡æœ‰æŒ‡å®šçš„è¯ï¼Œå†åˆ¤æ–­ï¼›å¦‚æœæ˜¯è¿è¡Œåœºæ™¯ï¼Œçœ‹å‘½ä»¤è¡Œå‚æ•°ä¸­æœ‰æ²¡æœ‰ä¼ é€’ base_folder å‚æ•°ï¼Œä¼ é€’äº†å°±ä½¿ç”¨å‚æ•°è®¾ç½® BaseFolderï¼Œå¦åˆ™é»˜è®¤ä¸ºå¼€å‘åœºæ™¯ï¼Œä½¿ç”¨å½“å‰è·¯å¾„ã€‚</p><p>äºæ˜¯framework/provider/app/service.goå®šä¹‰BaseFolderå¦‚ä¸‹ï¼š</p><pre><code class=\"language-go\">// BaseFolder è¡¨ç¤ºåŸºç¡€ç›®å½•ï¼Œå¯ä»¥ä»£è¡¨å¼€å‘åœºæ™¯çš„ç›®å½•ï¼Œä¹Ÿå¯ä»¥ä»£è¡¨è¿è¡Œæ—¶å€™çš„ç›®å½•\nfunc (h HadeApp) BaseFolder() string {\n   if h.baseFolder != \"\" {\n      return h.baseFolder\n   }\n   // å¦‚æœæ²¡æœ‰è®¾ç½®ï¼Œåˆ™ä½¿ç”¨å‚æ•°\n   var baseFolder string\n   flag.StringVar(&amp;baseFolder, \"base_folder\", \"\", \"base_folder å‚æ•°, é»˜è®¤ä¸ºå½“å‰è·¯å¾„\")\n   flag.Parse()\n   if baseFolder != \"\" {\n      return baseFolder\n   }\n   // å¦‚æœå‚æ•°ä¹Ÿæ²¡æœ‰ï¼Œä½¿ç”¨é»˜è®¤çš„å½“å‰è·¯å¾„\n   return util.GetExecDirectory()\n}\n</code></pre><p>åœ¨ BaseFolder çš„å®ç°ä¸­ï¼Œå…³é”®ç‚¹å°±æ˜¯éœ€è¦åŒºåˆ†ä¸šåŠ¡åœºæ™¯ã€‚æœåŠ¡åè®®çš„å…¶ä»–æ¥å£åŸºæœ¬éƒ½æ˜¯ä» BaseFolder è¿™ä¸ªç›®å½•ä¸Šè¿›è¡Œæ‰©å±•çš„ã€‚</p><p>æ¯”å¦‚å­˜æ”¾æ—¥å¿—çš„ç›®å½•LogFolderï¼Œæˆ‘ä»¬å…ˆé€šè¿‡BaseFolderå®šä¹‰å‡ºStorageFolderç›®å½•ï¼Œç„¶åå†é€šè¿‡StorageFolderï¼Œå®šä¹‰å‡ºLogFolderçš„ä½ç½®ã€‚åŒæ ·åœ¨ framework/provider/app/service.go ä¸­å®šä¹‰å¯¹åº”çš„StorageFolderå’ŒLogFolderä¸‹ï¼Œåœ¨åé¢è®²é…ç½®çš„æ—¶å€™ä¼šæ›´æ–°è¿™æ®µä»£ç ï¼š</p><pre><code class=\"language-go\">func (h HadeApp) StorageFolder() string {\n\treturn filepath.Join(h.BaseFolder(), \"storage\")\n}\n\n// LogFolder è¡¨ç¤ºæ—¥å¿—å­˜æ”¾åœ°å€\nfunc (h HadeApp) LogFolder() string {\n  return filepath.Join(h.StorageFolder(), \"log\")\n}\n</code></pre><p>å…¶ä»–ç›®å½•åœ°å€çš„å®ç°å°±ä¸å†èµ˜è¿°äº†ï¼Œéƒ½æ˜¯å¤§åŒå°å¼‚çš„ã€‚<br>\næœ¬èŠ‚è¯¾çš„æ‰€æœ‰ä»£ç æˆ‘éƒ½å­˜æ”¾åœ¨ GitHub ä¸Šçš„ <a href=\"https://github.com/gohade/coredemo/tree/geekbang/12\">geekbang/12</a> åˆ†æ”¯ä¸Šäº†ã€‚è¿™é‡Œé™„å¸¦ä¸Šå½“å‰çš„ä»£ç ç»“æ„æˆªå›¾ã€‚</p><p><img src=\"https://static001.geekbang.org/resource/image/7c/8f/7ce79e33e5d807ff58e269byy0a3f08f.png?wh=363x865\" alt=\"å›¾ç‰‡\"></p><h2>æ€»ç»“</h2><p>ä»Šå¤©æˆ‘ä»¬å…¶å®å°±è®¨è®ºäº†ä¸€ä¸ªæ ¸å¿ƒé—®é¢˜ï¼šå¦‚ä½•ä»æ¡†æ¶å±‚æ¥è§„èŒƒä¸šåŠ¡çš„ç›®å½•ç»“æ„ã€‚æ˜¯ä¸æ˜¯æœ‰ç‚¹æƒŠè®¶ï¼Œåªæ˜¯ä¸€ä¸ªç›®å½•ç»“æ„çš„è®¾è®¡ï¼Œå±…ç„¶ä¹Ÿæœ‰å¦‚æ­¤å¤šçš„é—¨é“ã€‚æ¡†æ¶è®¾è®¡å°±æ˜¯è¿™æ ·ï¼Œå¥½çš„æ¡†æ¶ä¹‹æ‰€ä»¥èƒ½è®©æ‰€æœ‰äººéƒ½å–œæ¬¢ï¼Œå°±æ˜¯å› ä¸ºå…·å¤‡éå¸¸ä¼˜ç§€çš„è®¾è®¡æ„Ÿï¼Œåœ¨æ¯ä¸ªæ¨¡å—å’Œæ¯ä¸ªç»†èŠ‚ç‚¹ä¸Šï¼Œéƒ½åŒ…å«ä½œè€…çš„æ€è€ƒã€‚</p><p>æ¯”å¦‚æˆ‘ä»¬çš„ç›®å½•ç»“æ„ï¼Œ<strong>ä¸ä»…ä»…æ˜¯ä¸€ç§åˆ†ç›®å½•çš„è®¾è®¡ï¼Œè¿˜è´¯å½»äº†é¢å‘æ¥å£çš„æ€æƒ³ï¼Œå°†ç›®å½•ä½œä¸ºä¸€ä¸ªæœåŠ¡æä¾›åœ¨æœåŠ¡å®¹å™¨ä¸­</strong>ï¼Œåç»­çš„æ‰€æœ‰æœåŠ¡åœ¨ä½¿ç”¨åˆ°ä¸šåŠ¡ç›®å½•çš„æ—¶å€™ï¼Œå¯ä»¥ç›´æ¥é€šè¿‡è¿™ä¸ªç›®å½•æœåŠ¡ï¼Œè·å–å…·ä½“çš„ç›®å½•è·¯å¾„ï¼Œæ˜¯éå¸¸æ–¹ä¾¿çš„ã€‚</p><h2>æ€è€ƒé¢˜</h2><p>æˆ‘ä»¬å¯¹æ¡†æ¶çš„ç›®å½•åšäº†è¯¦ç»†çš„æ‹†åˆ†ï¼Œå…¶ä¸­HTTPæœåŠ¡ä¸­çš„moduleç›®å½•ï¼Œè¡¨ç¤ºå…·ä½“çš„ä¸šåŠ¡æ¨¡å—ã€‚</p><p>è¿™ä¸ªä¸šåŠ¡æ¨¡å—çš„æ–‡ä»¶è®¾è®¡ï¼Œæˆ‘ä»¬æ²¡æœ‰é™åˆ¶ï¼Œä½ å¯ä»¥ä½¿ç”¨MVCï¼Œä¹Ÿå¯ä»¥ä½¿ç”¨DDDæ¥åšå…·ä½“çš„ä¸šåŠ¡æ¨¡å—æ–‡ä»¶è®¾è®¡ï¼Œè¿™ä¸ªæ–‡ä»¶ç»“æ„ä¸çŸ¥é“ä½ æ—¥å¸¸æœ‰æ²¡æœ‰ä»€ä¹ˆè®¾è®¡å€¾å‘ï¼Ÿè¿™æ˜¯ä¸€ä¸ªå¼€æ”¾æ€§é—®é¢˜ï¼Œæˆ‘ä»¬å¯ä»¥ä¸€èµ·è®¨è®ºã€‚</p><p>æ¬¢è¿åœ¨ç•™è¨€åŒºåˆ†äº«ä½ çš„æ€è€ƒã€‚æ„Ÿè°¢ä½ çš„æ”¶å¬ï¼Œå¦‚æœä½ è§‰å¾—æœ‰æ”¶è·ï¼Œä¹Ÿæ¬¢è¿ä½ æŠŠä»Šå¤©çš„å†…å®¹åˆ†äº«ç»™ä½ èº«è¾¹çš„æœ‹å‹ï¼Œé‚€ä»–ä¸€èµ·å­¦ä¹ ã€‚æˆ‘ä»¬ä¸‹èŠ‚è¯¾è§ã€‚</p>","comments":[{"had_liked":false,"id":316024,"user_name":"èŠ’æœå°‘ä¾ ","can_delete":false,"product_type":"c1","uid":1350159,"ip_address":"","ucode":"98D0BBB52BB80F","user_header":"https://static001.geekbang.org/account/avatar/00/14/9a/0f/da7ed75a.jpg","comment_is_top":false,"comment_ctime":1634110271,"is_pvip":true,"replies":[{"id":"114842","content":"æ˜¯çš„ï¼ŒappæœåŠ¡å®šä¹‰çš„æ„æ€å°±æ˜¯ï¼Œä½ è¦å¯åŠ¨ä¸€ä¸ªåº”ç”¨æ¥ä½¿ç”¨hadeæ¡†æ¶åç»­çš„ä¸€äº›åŠŸèƒ½ï¼Œé‚£ä¹ˆè¿™ä¸ªåº”ç”¨çš„è¿™äº›ç›®å½•ä½ è¦å®‰æ’ä¸€ä¸‹å…·ä½“å®ç°ï¼Œåç»­æˆ‘æ¡†æ¶çš„æ‰€æœ‰åŠŸèƒ½éƒ½ä¼šåœ¨è¿™äº›ç›®å½•é‡Œé¢æ“ä½œ","user_name":"ä½œè€…å›å¤","user_name_real":"å¶å‰‘å³°","uid":"1069186","ctime":1634694493,"ip_address":"","comment_id":316024,"utype":1}],"discussion_count":2,"race_medal":0,"score":"5929077567","product_id":100090601,"comment_content":"é¦–å…ˆçœ‹è¿™èŠ‚è¯¾çš„æ—¶å€™ï¼Œæˆ‘æ˜¯æ„Ÿè§‰æœ‰ç‚¹æŠ½è±¡å’Œéš¾ä»¥ç†è§£çš„ï¼Œçƒ¦è¯·è€å¸ˆæŒ‡æ­£ä¸€ä¸‹ã€‚è¿™ä¸ªappæœåŠ¡ï¼Œæ˜¯ä¸æ˜¯å°±ç›¸å½“äºä¸€ä¸ªä¸šåŠ¡æœåŠ¡ï¼ˆåŸºäºhadeæ¡†æ¶å®Œæˆï¼‰ï¼Ÿ<br><br>å…³äºæ€è€ƒé¢˜ï¼šä¸€èˆ¬æ¥è¯´ï¼Œæˆ‘è¿™è¾¹å·¥ä½œä¸Šæ˜¯è¿™æ ·çš„ï¼š<br>DDDæ˜¯åœ¨ç±»ä¼¼æœ¬æ–‡çš„appè¿™ä¸€ç»´åº¦åˆ’åˆ†çš„ï¼Œæ¯”å¦‚è¯´æˆ‘æœ‰å¤šä¸ªæœåŠ¡app1,app2,app3ã€‚æ¯ä¸ªæœåŠ¡é‡Œåˆé€šè¿‡service&#47;cmd&#47;dao&#47;modelç­‰åˆ†å±‚æ¬¡åˆ’åˆ†ç›®å½•æ¶æ„ã€‚","like_count":1,"discussions":[{"author":{"id":1069186,"avatar":"https://static001.geekbang.org/account/avatar/00/10/50/82/32a2bf86.jpg","nickname":"å¶å‰‘å³°","note":"","ucode":"3974D917C69C29","race_medal":0,"user_type":2,"is_pvip":true},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":528240,"discussion_content":"æ˜¯çš„ï¼ŒappæœåŠ¡å®šä¹‰çš„æ„æ€å°±æ˜¯ï¼Œä½ è¦å¯åŠ¨ä¸€ä¸ªåº”ç”¨æ¥ä½¿ç”¨hadeæ¡†æ¶åç»­çš„ä¸€äº›åŠŸèƒ½ï¼Œé‚£ä¹ˆè¿™ä¸ªåº”ç”¨çš„è¿™äº›ç›®å½•ä½ è¦å®‰æ’ä¸€ä¸‹å…·ä½“å®ç°ï¼Œåç»­æˆ‘æ¡†æ¶çš„æ‰€æœ‰åŠŸèƒ½éƒ½ä¼šåœ¨è¿™äº›ç›®å½•é‡Œé¢æ“ä½œ","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1634694493,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1189532,"avatar":"https://static001.geekbang.org/account/avatar/00/12/26/9c/fa84029d.jpg","nickname":"ç‹é˜¿è§‰","note":"","ucode":"797634D3AC0560","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":404429,"discussion_content":"è€å¸ˆåé¢ä¼°è®¡æƒ³åšä¸€ä¸ªgo laravelæ¡†æ¶äº†ã€‚\nè§‰å¾—laravelæœåŠ¡æä¾›è€…è¿‡äºæŠ½è±¡å¹¶ä¸”ä¸ç›´è§‚ã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1634305443,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":337432,"user_name":"Geek_065895","can_delete":false,"product_type":"c1","uid":2136069,"ip_address":"","ucode":"2E6FCCC78E5767","user_header":"https://thirdwx.qlogo.cn/mmopen/vi_32/rxz5aKicRkvqWmt6c6c7eayHvh577uibBTVQzcJKwSTqI9FaxZSRlx7NRVw4atWpqER8ncA5jErQb3wb4cPzZxlA/132","comment_is_top":false,"comment_ctime":1646819110,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1646819110","product_id":100090601,"comment_content":"æ„Ÿè§‰çœŸçš„ä¸é€‚åº”","like_count":0},{"had_liked":false,"id":334222,"user_name":"yiyi","can_delete":false,"product_type":"c1","uid":2812900,"ip_address":"","ucode":"CA33EB2653E8ED","user_header":"https://static001.geekbang.org/account/avatar/00/2a/eb/e4/75f0c49c.jpg","comment_is_top":false,"comment_ctime":1644820297,"is_pvip":false,"discussion_count":2,"race_medal":0,"score":"1644820297","product_id":100090601,"comment_content":"å¶è€å¸ˆï¼Œå‘ç°ä¸€ä¸ªbugï¼Œå¤šæ¬¡è°ƒç”¨HadeApp.BaseFolderï¼ˆï¼‰æ–¹æ³•ï¼Œè‹¥æ˜¯æ²¡æœ‰åœ¨åˆå§‹åŒ–çš„æ—¶å€™æŒ‡å®šbaseFolderè¿™ä¸ªå­—æ®µï¼Œç¬¬äºŒæ¬¡è°ƒç”¨æ—¶ä¼šå‡ºç°panicï¼ŒåŸå› æ˜¯flagå¤šæ¬¡è§£æåŒä¸€ä¸ªå­—æ®µå¼•å‘çš„flag redefinedã€‚è§£å†³æ–¹æ³•:ç¬¬ä¸€æ¬¡è°ƒç”¨è·å–åˆ°BaseFolderåç¼“å­˜è¿™ä¸ªå­—æ®µã€‚ä¸çŸ¥é“è¿™æ ·è¡Œä¸è¡Œã€‚","like_count":0,"discussions":[{"author":{"id":2559238,"avatar":"https://static001.geekbang.org/account/avatar/00/27/0d/06/970cc957.jpg","nickname":"Charles","note":"","ucode":"8ACBA423B5A505","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":559579,"discussion_content":"æ€ä¹ˆä¿®æ”¹å‘¢ï¼Ÿ","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1648822555,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1174794,"avatar":"https://static001.geekbang.org/account/avatar/00/11/ed/0a/18201290.jpg","nickname":"Juniper","note":"","ucode":"1BC24554034BD3","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":557692,"discussion_content":"å¯ä»¥åœ¨è·å–åˆ°å€¼ä¹‹åï¼Œèµ‹å€¼ç»™hadeApp.baseFolderï¼Œä¸‹æ¬¡å†è¿›å…¥çš„æ—¶å€™å°±ä¸ä¼šæ‰§è¡Œåˆ°ä¸‹é¢äº†","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1647933571,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":330636,"user_name":"peterszhou","can_delete":false,"product_type":"c1","uid":1272477,"ip_address":"","ucode":"DE068869801A28","user_header":"https://static001.geekbang.org/account/avatar/00/13/6a/9d/65bc01f9.jpg","comment_is_top":false,"comment_ctime":1642079872,"is_pvip":false,"discussion_count":1,"race_medal":0,"score":"1642079872","product_id":100090601,"comment_content":"è¿™ä¸ªå¥½åƒè·Ÿä¼ ç»Ÿçš„goé¡¹ç›®å¸ƒå±€ä¸å¤§ä¸€æ ·ï¼Œä¸€èˆ¬æ˜¯pkg1ã€pkg2ã€commandã€internalè¿™æ ·çš„å¸ƒå±€","like_count":0,"discussions":[{"author":{"id":2021362,"avatar":"https://static001.geekbang.org/account/avatar/00/1e/d7/f2/82e1dc03.jpg","nickname":"Geek_cdef71","note":"","ucode":"BF967703F342A2","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":554973,"discussion_content":"phpæœ‰ä¸ªæ¡†æ¶å«laravelï¼Œè¿™ä¸ªæ˜¯ä»¿é‚£ä¸ªæ•´çš„","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1646705875,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":330633,"user_name":"ç‰›ç‰å¯Œ","can_delete":false,"product_type":"c1","uid":1231623,"ip_address":"","ucode":"DD962676F8FAF6","user_header":"https://static001.geekbang.org/account/avatar/00/12/cb/07/482b7155.jpg","comment_is_top":false,"comment_ctime":1642078952,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1642078952","product_id":100090601,"comment_content":"1ã€é€šè¿‡å®¹å™¨å°†å¤æ‚çš„æœåŠ¡å®ç°ç®€æ˜“åŒ–<br>2ã€å®šä¹‰è‰¯å¥½çš„ç›®å½•ç»“æ„é™ä½ç†è§£æ­§ä¹‰","like_count":0},{"had_liked":false,"id":325396,"user_name":"å‹","can_delete":false,"product_type":"c1","uid":2536820,"ip_address":"","ucode":"972A4333A8B101","user_header":"https://static001.geekbang.org/account/avatar/00/26/b5/74/cd80b9f4.jpg","comment_is_top":false,"comment_ctime":1638943582,"is_pvip":false,"replies":[{"id":"118662","content":"å…¶å®modelè¿™ä¸€å±‚ä¸€ç›´æœ‰ä¸ªè®¨è®ºï¼Œå°±æ˜¯èƒ–modelè¿˜æ˜¯ç˜¦modelï¼Œmodelé‡Œé¢æ˜¯ä¸æ˜¯åº”è¯¥æ”¾ä¸€äº›ä¸šåŠ¡é€»è¾‘ã€‚","user_name":"ä½œè€…å›å¤","user_name_real":"ç¼–è¾‘","uid":"1069186","ctime":1639608359,"ip_address":"","comment_id":325396,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1638943582","product_id":100090601,"comment_content":"è€å¸ˆæˆ‘æ„Ÿè§‰laravelçš„ modelå°±ç±»ä¼¼å……è¡€æ¨¡å‹ ä¸çŸ¥é“æˆ‘æœ‰æ²¡æœ‰ç†è§£é”™","like_count":0,"discussions":[{"author":{"id":1069186,"avatar":"https://static001.geekbang.org/account/avatar/00/10/50/82/32a2bf86.jpg","nickname":"å¶å‰‘å³°","note":"","ucode":"3974D917C69C29","race_medal":0,"user_type":2,"is_pvip":true},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":539096,"discussion_content":"å…¶å®modelè¿™ä¸€å±‚ä¸€ç›´æœ‰ä¸ªè®¨è®ºï¼Œå°±æ˜¯èƒ–modelè¿˜æ˜¯ç˜¦modelï¼Œmodelé‡Œé¢æ˜¯ä¸æ˜¯åº”è¯¥æ”¾ä¸€äº›ä¸šåŠ¡é€»è¾‘ã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1639608359,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":325383,"user_name":"å‹","can_delete":false,"product_type":"c1","uid":2536820,"ip_address":"","ucode":"972A4333A8B101","user_header":"https://static001.geekbang.org/account/avatar/00/26/b5/74/cd80b9f4.jpg","comment_is_top":false,"comment_ctime":1638938525,"is_pvip":false,"replies":[{"id":"118661","content":"å—¯ï¼Œåé¢æœ‰æä¾›è¿™ä¸ªnew hadeï¼Œé‚£ä¸ªå®ç°çš„è®¾è®¡è¿˜æœ‰ç‚¹æ„æ€ï¼Œæ…¢æ…¢çœ‹","user_name":"ä½œè€…å›å¤","user_name_real":"ç¼–è¾‘","uid":"1069186","ctime":1639608303,"ip_address":"","comment_id":325383,"utype":1}],"discussion_count":2,"race_medal":0,"score":"1638938525","product_id":100090601,"comment_content":"é‚£ä¹ˆè€å¸ˆæ˜¯ä¸æ˜¯ä¼šæä¾›ä¸€ä¸ª new hade è¿™ç§ç©æ„ ç”Ÿæˆæ¨¡æ¿æ¥ç”¨ ï¼Œå…¶å®åœ¨æˆ‘å¿ƒé‡Œæˆ‘ä¸€ç›´è®¤ä¸ºæ¡†æ¶å°±æ˜¯å¸®æˆ‘è§„å®šå¥½äº†ä¸€äº›æœ€å°ç›®å½•èŒƒå›´ï¼Œæˆ‘å¯ä»¥æ²¡æœ‰ä»€ä¹ˆå¿ƒæ™ºè´Ÿæ‹…çš„å¯¹äºå·¥ç¨‹ç›®å½•çš„è§„åˆ’ï¼Œä½†æ˜¯ç”¨ginè®©æˆ‘æ„Ÿè§‰å°±æ˜¯ä¸€ä¸ªåŒ…ï¼Œæˆ‘å¼•å…¥ginå¯ä»¥è‡ªå·±å®šä¹‰å„ç§å·¥ç¨‹åŒ–è§„èŒƒã€‚ä¸¤è€…éƒ½æœ‰å¥½å¤„ ä½†æ˜¯å¯¹äºæˆ‘è¿™ç§æ²¡æœ‰ä»€ä¹ˆæ¶æ„ç»éªŒçš„æ¥è¯´ æˆ‘æ›´å–œæ¬¢laravelè¿™ç§ ï¼ˆè™½ç„¶æˆ‘ä¹Ÿå¾ˆæƒ³æœ‰æ¶æ„ç»éªŒï¼‰","like_count":0,"discussions":[{"author":{"id":1069186,"avatar":"https://static001.geekbang.org/account/avatar/00/10/50/82/32a2bf86.jpg","nickname":"å¶å‰‘å³°","note":"","ucode":"3974D917C69C29","race_medal":0,"user_type":2,"is_pvip":true},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":539095,"discussion_content":"å—¯ï¼Œåé¢æœ‰æä¾›è¿™ä¸ªnew hadeï¼Œé‚£ä¸ªå®ç°çš„è®¾è®¡è¿˜æœ‰ç‚¹æ„æ€ï¼Œæ…¢æ…¢çœ‹","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1639608303,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":1,"child_discussions":[{"author":{"id":2536820,"avatar":"https://static001.geekbang.org/account/avatar/00/26/b5/74/cd80b9f4.jpg","nickname":"å‹","note":"","ucode":"972A4333A8B101","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":1069186,"avatar":"https://static001.geekbang.org/account/avatar/00/10/50/82/32a2bf86.jpg","nickname":"å¶å‰‘å³°","note":"","ucode":"3974D917C69C29","race_medal":0,"user_type":2,"is_pvip":true},"discussion":{"id":539143,"discussion_content":"å˜¿å˜¿ æˆ‘å·²ç»æ‹¿åˆ°æ¯•ä¸šè¯ä¹¦äº†","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1639621686,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":539095,"ip_address":""},"score":539143,"extra":""}]}]},{"had_liked":false,"id":325381,"user_name":"å‹","can_delete":false,"product_type":"c1","uid":2536820,"ip_address":"","ucode":"972A4333A8B101","user_header":"https://static001.geekbang.org/account/avatar/00/26/b5/74/cd80b9f4.jpg","comment_is_top":false,"comment_ctime":1638937812,"is_pvip":false,"replies":[{"id":"118660","content":"æ˜¯çš„ã€‚ã€‚","user_name":"ä½œè€…å›å¤","user_name_real":"ç¼–è¾‘","uid":"1069186","ctime":1639608251,"ip_address":"","comment_id":325381,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1638937812","product_id":100090601,"comment_content":"å¯¹äºä¸€ä¸ªç”¨äº†å¾ˆä¹…çš„laravelçš„æˆ‘æ¥è¯´ çœ‹èµ·æ¥å¤ªç†Ÿæ‚‰å¤ªäº²åˆ‡","like_count":0,"discussions":[{"author":{"id":1069186,"avatar":"https://static001.geekbang.org/account/avatar/00/10/50/82/32a2bf86.jpg","nickname":"å¶å‰‘å³°","note":"","ucode":"3974D917C69C29","race_medal":0,"user_type":2,"is_pvip":true},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":539094,"discussion_content":"æ˜¯çš„ã€‚ã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1639608251,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":322949,"user_name":"zzq","can_delete":false,"product_type":"c1","uid":1234584,"ip_address":"","ucode":"03FE20B812D15D","user_header":"https://static001.geekbang.org/account/avatar/00/12/d6/98/e2d8f2a9.jpg","comment_is_top":false,"comment_ctime":1637668103,"is_pvip":true,"discussion_count":0,"race_medal":0,"score":"1637668103","product_id":100090601,"comment_content":"å¤§ä½¬å¸¦ç€æ€è€ƒï¼Œ ä¸€ä¸ªä»°æ…•çš„å¸–å­ï¼Œ å¤§ä½¬ ğŸ‚ ğŸº","like_count":0},{"had_liked":false,"id":317974,"user_name":"å®™æ–¯","can_delete":false,"product_type":"c1","uid":2041396,"ip_address":"","ucode":"80DF36BAD298AD","user_header":"https://static001.geekbang.org/account/avatar/00/1f/26/34/891dd45b.jpg","comment_is_top":false,"comment_ctime":1635081791,"is_pvip":true,"replies":[{"id":"115341","content":"èµğŸ‘","user_name":"ä½œè€…å›å¤","user_name_real":"å¶å‰‘å³°","uid":"1069186","ctime":1635203743,"ip_address":"","comment_id":317974,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1635081791","product_id":100090601,"comment_content":"ä¹‹å‰è§phpæ¡†æ¶ä¸­yii2åœ¨appä¸‹æœ‰moduleè¿™ä¸€å±‚ï¼Œå¯¹äºmodulesä¸šåŠ¡åˆ’åˆ†æˆ‘è§è¿‡mvcæ–¹å¼åˆ’åˆ†ã€‚<br>åœ¨å…¶ä»–æ¡†æ¶ä¸Šä¹Ÿè§è¿‡DDDæ–¹å¼ã€‚<br><br>MVCæ–¹å¼å¦‚ä¸‹ï¼š<br>ç›®å½•ç»“æ„ç±»ä¼¼ä¸‹é¢<br>config<br>controller<br>model<br>view<br>--modules<br>----app1<br>------config<br>------controller<br>--------aController.php<br>------model<br>--------aModel.php<br>------app1Module.php<br>----app2<br><br>--------------------------<br>DDDæ–¹å¼<br>apps<br>--app1<br>----backend<br>------bin<br>--------controller<br>------config<br>------web<br>--------controller<br>--app2<br>modules<br>--xapp1<br>----application<br>------aa.php<br>----domain<br>------da.php<br>----infrastructure<br>------ia.php<br>--xapp2<br>--xapp3","like_count":1,"discussions":[{"author":{"id":1069186,"avatar":"https://static001.geekbang.org/account/avatar/00/10/50/82/32a2bf86.jpg","nickname":"å¶å‰‘å³°","note":"","ucode":"3974D917C69C29","race_medal":0,"user_type":2,"is_pvip":true},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":529050,"discussion_content":"èµğŸ‘","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1635203743,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":316075,"user_name":"qinsi","can_delete":false,"product_type":"c1","uid":1667175,"ip_address":"","ucode":"090D9C4068FF12","user_header":"https://static001.geekbang.org/account/avatar/00/19/70/67/0c1359c2.jpg","comment_is_top":false,"comment_ctime":1634122757,"is_pvip":true,"replies":[{"id":"114841","content":"æ¯”å¦‚æˆ‘æƒ³æŠŠruntimefolderæ”¹ä¸ªåå­—ï¼Œé‡æ–°å®šä¹‰ä¸€ä¸ªappæœåŠ¡å°±è¡Œäº†","user_name":"ä½œè€…å›å¤","user_name_real":"å¶å‰‘å³°","uid":"1069186","ctime":1634694355,"ip_address":"","comment_id":316075,"utype":1}],"discussion_count":3,"race_medal":0,"score":"1634122757","product_id":100090601,"comment_content":"è€å¸ˆèƒ½ä¸èƒ½ä¸¾ä¸ªä¾‹å­ï¼ŒAppæœåŠ¡ä¼šæœ‰å“ªäº›ä¸åŒçš„å®ç°ï¼Ÿå¸¸è§çš„æœåŠ¡æ¯”å¦‚æ—¥å¿—ã€æ•°æ®åº“ã€æ¶ˆæ¯é˜Ÿåˆ—ä¹‹ç±»çš„ï¼Œå¾ˆå®¹æ˜“ç†è§£ä¼šæœ‰ä¸åŒçš„å®ç°ã€‚é‚£AppæœåŠ¡ä¸åŒçš„å®ç°æ˜¯æ€ä¹ˆæ ·çš„ï¼Ÿ<br><br>å…‰çœ‹ç›®å‰AppæœåŠ¡çš„æ¥å£çš„è¯ï¼Œä¼¼ä¹éƒ½æ˜¯åœ¨è§„å®šè·¯å¾„ï¼Ÿé‚£ä¹ˆä¸åŒçš„å®ç°å°±æ˜¯è·¯å¾„å¯èƒ½ä¼šä¸ä¸€æ ·ï¼Ÿå¯èƒ½æ¢ä¸ªåå­—å«ProjectLayoutæœåŠ¡æ›´èƒ½ä½“ç°å…¶ç”¨é€”ï¼Ÿ","like_count":0,"discussions":[{"author":{"id":1069186,"avatar":"https://static001.geekbang.org/account/avatar/00/10/50/82/32a2bf86.jpg","nickname":"å¶å‰‘å³°","note":"","ucode":"3974D917C69C29","race_medal":0,"user_type":2,"is_pvip":true},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":528255,"discussion_content":"æ¯”å¦‚æˆ‘æƒ³æŠŠruntimefolderæ”¹ä¸ªåå­—ï¼Œé‡æ–°å®šä¹‰ä¸€ä¸ªappæœåŠ¡å°±è¡Œäº†","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1634694355,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1718011,"avatar":"https://static001.geekbang.org/account/avatar/00/1a/36/fb/b480f2ac.jpg","nickname":"äººé—´ç†æƒ³","note":"","ucode":"0D6A4C402D7CBD","race_medal":0,"user_type":1,"is_pvip":true},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":577482,"discussion_content":"æˆ‘ä¹Ÿæ²¡å¤ªæ˜ç™½ï¼Œä¸ºä»€ä¹ˆå«appæœåŠ¡æ¥å£ï¼Œæˆ‘æ„Ÿè§‰å¦‚æœè¿™ä¸ªappåªæ˜¯ç”¨æ¥è§„å®šé¡¹ç›®çš„è·¯å¾„ï¼Œå«ProjectLayoutæ›´èƒ½ä½“ç°ä»–çš„ä½œç”¨","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1656139758,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":2536820,"avatar":"https://static001.geekbang.org/account/avatar/00/26/b5/74/cd80b9f4.jpg","nickname":"å‹","note":"","ucode":"972A4333A8B101","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":537042,"discussion_content":"å…¶å®åªè¦æ‰¾åˆ°äº†base å…¶ä»–çš„éƒ½æ˜¯åœ¨baseä¹‹ä¸‹ æœ€å°é™å®šåŸåˆ™é‚£ä¹ˆå°±æ˜¯é™å®šäº†baseä¹‹ä¸‹çš„ç›®å½• å¯¹äºbaseè¿™ä¸ªç›®å½•æ˜¯å¯å®šåˆ¶çš„","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1638943506,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]}]}