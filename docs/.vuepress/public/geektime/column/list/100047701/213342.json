{"id":213342,"title":"07 | æ•°æ®åº“ç´¢å¼•ï¼šç´¢å¼•å¹¶ä¸æ˜¯ä¸‡èƒ½è¯","content":"<p>ä½ å¥½ï¼Œæˆ‘æ˜¯æœ±æ™”ã€‚ä»Šå¤©ï¼Œæˆ‘è¦å’Œä½ åˆ†äº«çš„ä¸»é¢˜æ˜¯ï¼Œæ•°æ®åº“çš„ç´¢å¼•å¹¶ä¸æ˜¯ä¸‡èƒ½è¯ã€‚</p><p>å‡ ä¹æ‰€æœ‰çš„ä¸šåŠ¡é¡¹ç›®éƒ½ä¼šæ¶‰åŠæ•°æ®å­˜å‚¨ï¼Œè™½ç„¶å½“å‰å„ç§NoSQLå’Œæ–‡ä»¶ç³»ç»Ÿå¤§è¡Œå…¶é“ï¼Œä½†MySQLç­‰å…³ç³»å‹æ•°æ®åº“å› ä¸ºæ»¡è¶³ACIDã€å¯é æ€§é«˜ã€å¯¹å¼€å‘å‹å¥½ç­‰ç‰¹ç‚¹ï¼Œä»ç„¶æœ€å¸¸è¢«ç”¨äºå­˜å‚¨é‡è¦æ•°æ®ã€‚åœ¨å…³ç³»å‹æ•°æ®åº“ä¸­ï¼Œç´¢å¼•æ˜¯ä¼˜åŒ–æŸ¥è¯¢æ€§èƒ½çš„é‡è¦æ‰‹æ®µã€‚</p><p>ä¸ºæ­¤ï¼Œæˆ‘ç»å¸¸çœ‹åˆ°ä¸€äº›åŒå­¦ä¸€é‡åˆ°æŸ¥è¯¢æ€§èƒ½é—®é¢˜ï¼Œå°±ç›²ç›®è¦æ±‚è¿ç»´æˆ–DBAç»™æ•°æ®è¡¨ç›¸å…³å­—æ®µåˆ›å»ºå¤§é‡ç´¢å¼•ã€‚æ˜¾ç„¶ï¼Œè¿™ç§æƒ³æ³•æ˜¯é”™è¯¯çš„ã€‚ä»Šå¤©ï¼Œæˆ‘ä»¬å°±ä»¥MySQLä¸ºä¾‹æ¥æ·±å…¥ç†è§£ä¸‹ç´¢å¼•çš„åŸç†ï¼Œä»¥åŠç›¸å…³è¯¯åŒºã€‚</p><h2>InnoDBæ˜¯å¦‚ä½•å­˜å‚¨æ•°æ®çš„ï¼Ÿ</h2><p>MySQLæŠŠæ•°æ®å­˜å‚¨å’ŒæŸ¥è¯¢æ“ä½œæŠ½è±¡æˆäº†å­˜å‚¨å¼•æ“ï¼Œä¸åŒçš„å­˜å‚¨å¼•æ“ï¼Œå¯¹æ•°æ®çš„å­˜å‚¨å’Œè¯»å–æ–¹å¼å„ä¸ç›¸åŒã€‚MySQLæ”¯æŒå¤šç§å­˜å‚¨å¼•æ“ï¼Œå¹¶ä¸”å¯ä»¥ä»¥è¡¨ä¸ºç²’åº¦è®¾ç½®å­˜å‚¨å¼•æ“ã€‚å› ä¸ºæ”¯æŒäº‹åŠ¡ï¼Œæˆ‘ä»¬æœ€å¸¸ä½¿ç”¨çš„æ˜¯InnoDBã€‚ä¸ºæ–¹ä¾¿ç†è§£ä¸‹é¢çš„å†…å®¹ï¼Œæˆ‘å…ˆå’Œä½ ç®€å•è¯´è¯´InnoDBæ˜¯å¦‚ä½•å­˜å‚¨æ•°æ®çš„ã€‚</p><p>è™½ç„¶æ•°æ®ä¿å­˜åœ¨ç£ç›˜ä¸­ï¼Œä½†å…¶å¤„ç†æ˜¯åœ¨å†…å­˜ä¸­è¿›è¡Œçš„ã€‚ä¸ºäº†å‡å°‘ç£ç›˜éšæœºè¯»å–æ¬¡æ•°ï¼ŒInnoDBé‡‡ç”¨é¡µè€Œä¸æ˜¯è¡Œçš„ç²’åº¦æ¥ä¿å­˜æ•°æ®ï¼Œå³æ•°æ®è¢«åˆ†æˆè‹¥å¹²é¡µï¼Œä»¥é¡µä¸ºå•ä½ä¿å­˜åœ¨ç£ç›˜ä¸­ã€‚InnoDBçš„é¡µå¤§å°ï¼Œä¸€èˆ¬æ˜¯16KBã€‚</p><p>å„ä¸ªæ•°æ®é¡µç»„æˆä¸€ä¸ªåŒå‘é“¾è¡¨ï¼Œæ¯ä¸ªæ•°æ®é¡µä¸­çš„è®°å½•æŒ‰ç…§ä¸»é”®é¡ºåºç»„æˆå•å‘é“¾è¡¨ï¼›æ¯ä¸€ä¸ªæ•°æ®é¡µä¸­æœ‰ä¸€ä¸ªé¡µç›®å½•ï¼Œæ–¹ä¾¿æŒ‰ç…§ä¸»é”®æŸ¥è¯¢è®°å½•ã€‚æ•°æ®é¡µçš„ç»“æ„å¦‚ä¸‹ï¼š</p><!-- [[[read_end]]] --><p><img src=\"https://static001.geekbang.org/resource/image/13/d1/1302b4a8d877609486c9a9eed2d8d8d1.png?wh=1924*1396\" alt=\"\"></p><p>é¡µç›®å½•é€šè¿‡æ§½æŠŠè®°å½•åˆ†æˆä¸åŒçš„å°ç»„ï¼Œæ¯ä¸ªå°ç»„æœ‰è‹¥å¹²æ¡è®°å½•ã€‚å¦‚å›¾æ‰€ç¤ºï¼Œè®°å½•ä¸­æœ€å‰é¢çš„å°æ–¹å—ä¸­çš„æ•°å­—ï¼Œä»£è¡¨çš„æ˜¯å½“å‰åˆ†ç»„çš„è®°å½•æ¡æ•°ï¼Œæœ€å°å’Œæœ€å¤§çš„æ§½æŒ‡å‘2ä¸ªç‰¹æ®Šçš„ä¼ªè®°å½•ã€‚æœ‰äº†æ§½ä¹‹åï¼Œæˆ‘ä»¬æŒ‰ç…§ä¸»é”®æœç´¢é¡µä¸­è®°å½•æ—¶ï¼Œå°±å¯ä»¥é‡‡ç”¨äºŒåˆ†æ³•å¿«é€Ÿæœç´¢ï¼Œæ— éœ€ä»æœ€å°è®°å½•å¼€å§‹éå†æ•´ä¸ªé¡µä¸­çš„è®°å½•é“¾è¡¨ã€‚</p><p>ä¸¾ä¸€ä¸ªä¾‹å­ï¼Œå¦‚æœè¦æœç´¢ä¸»é”®ï¼ˆPKï¼‰=15çš„è®°å½•ï¼š</p><ul>\n<li>å…ˆäºŒåˆ†å¾—å‡ºæ§½ä¸­é—´ä½æ˜¯(0+6)/2=3ï¼Œçœ‹åˆ°å…¶æŒ‡å‘çš„è®°å½•æ˜¯12ï¼œ15ï¼Œæ‰€ä»¥éœ€è¦ä»#3æ§½åç»§ç»­æœç´¢è®°å½•ï¼›</li>\n<li>å†ä½¿ç”¨äºŒåˆ†æœç´¢å‡º#3æ§½å’Œ#6æ§½çš„ä¸­é—´ä½æ˜¯(3+6)/2=4.5å–æ•´4ï¼Œ#4æ§½å¯¹åº”çš„è®°å½•æ˜¯16ï¼15ï¼Œæ‰€ä»¥è®°å½•ä¸€å®šåœ¨#4æ§½ä¸­ï¼›</li>\n<li>å†ä»#3æ§½æŒ‡å‘çš„12å·è®°å½•å¼€å§‹å‘ä¸‹æœç´¢3æ¬¡ï¼Œå®šä½åˆ°15å·è®°å½•ã€‚</li>\n</ul><p>ç†è§£äº†InnoDBå­˜å‚¨æ•°æ®çš„åŸç†åï¼Œæˆ‘ä»¬å°±å¯ä»¥ç»§ç»­å­¦ä¹ MySQLç´¢å¼•ç›¸å…³çš„åŸç†å’Œå‘äº†ã€‚</p><h2>èšç°‡ç´¢å¼•å’ŒäºŒçº§ç´¢å¼•</h2><p>è¯´åˆ°ç´¢å¼•ï¼Œé¡µç›®å½•å°±æ˜¯æœ€ç®€å•çš„ç´¢å¼•ï¼Œæ˜¯é€šè¿‡å¯¹è®°å½•è¿›è¡Œä¸€çº§åˆ†ç»„æ¥é™ä½æœç´¢çš„æ—¶é—´å¤æ‚åº¦ã€‚ä½†ï¼Œè¿™æ ·èƒ½å¤Ÿé™ä½çš„æ—¶é—´å¤æ‚åº¦æ•°é‡çº§ï¼Œéå¸¸æœ‰é™ã€‚å½“æœ‰æ— æ•°ä¸ªæ•°æ®é¡µæ¥å­˜å‚¨è¡¨æ•°æ®çš„æ—¶å€™ï¼Œæˆ‘ä»¬å°±éœ€è¦è€ƒè™‘å¦‚ä½•å»ºç«‹åˆé€‚çš„ç´¢å¼•ï¼Œæ‰èƒ½æ–¹ä¾¿å®šä½è®°å½•æ‰€åœ¨çš„é¡µã€‚</p><p>ä¸ºäº†è§£å†³è¿™ä¸ªé—®é¢˜ï¼ŒInnoDBå¼•å…¥äº†B+æ ‘ã€‚å¦‚ä¸‹å›¾æ‰€ç¤ºï¼ŒB+æ ‘æ˜¯ä¸€æ£µå€’è¿‡æ¥çš„æ ‘ï¼š</p><p><img src=\"https://static001.geekbang.org/resource/image/e7/65/e76adf029e63a045e05956039f81f265.png?wh=1996*1224\" alt=\"\"></p><p>B+æ ‘çš„ç‰¹ç‚¹åŒ…æ‹¬ï¼š</p><ul>\n<li>æœ€åº•å±‚çš„èŠ‚ç‚¹å«ä½œå¶å­èŠ‚ç‚¹ï¼Œç”¨æ¥å­˜æ”¾æ•°æ®ï¼›</li>\n<li>å…¶ä»–ä¸Šå±‚èŠ‚ç‚¹å«ä½œéå¶å­èŠ‚ç‚¹ï¼Œä»…ç”¨æ¥å­˜æ”¾ç›®å½•é¡¹ï¼Œä½œä¸ºç´¢å¼•ï¼›</li>\n<li>éå¶å­èŠ‚ç‚¹åˆ†ä¸ºä¸åŒå±‚æ¬¡ï¼Œé€šè¿‡åˆ†å±‚æ¥é™ä½æ¯ä¸€å±‚çš„æœç´¢é‡ï¼›</li>\n<li>æ‰€æœ‰èŠ‚ç‚¹æŒ‰ç…§ç´¢å¼•é”®å¤§å°æ’åºï¼Œæ„æˆä¸€ä¸ªåŒå‘é“¾è¡¨ï¼ŒåŠ é€ŸèŒƒå›´æŸ¥æ‰¾ã€‚</li>\n</ul><p>å› æ­¤ï¼ŒInnoDBä½¿ç”¨B+æ ‘ï¼Œæ—¢å¯ä»¥ä¿å­˜å®é™…æ•°æ®ï¼Œä¹Ÿå¯ä»¥åŠ é€Ÿæ•°æ®æœç´¢ï¼Œè¿™å°±æ˜¯èšç°‡ç´¢å¼•ã€‚å¦‚æœæŠŠä¸Šå›¾å¶å­èŠ‚ç‚¹ä¸‹é¢æ–¹å—ä¸­çš„çœç•¥å·çœ‹ä½œå®é™…æ•°æ®çš„è¯ï¼Œé‚£ä¹ˆå®ƒå°±æ˜¯èšç°‡ç´¢å¼•çš„ç¤ºæ„å›¾ã€‚<strong>ç”±äºæ•°æ®åœ¨ç‰©ç†ä¸Šåªä¼šä¿å­˜ä¸€ä»½ï¼Œæ‰€ä»¥åŒ…å«å®é™…æ•°æ®çš„èšç°‡ç´¢å¼•åªèƒ½æœ‰ä¸€ä¸ª</strong>ã€‚</p><p>InnoDBä¼šè‡ªåŠ¨ä½¿ç”¨ä¸»é”®ï¼ˆå”¯ä¸€å®šä¹‰ä¸€æ¡è®°å½•çš„å•ä¸ªæˆ–å¤šä¸ªå­—æ®µï¼‰ä½œä¸ºèšç°‡ç´¢å¼•çš„ç´¢å¼•é”®ï¼ˆå¦‚æœæ²¡æœ‰ä¸»é”®ï¼Œå°±é€‰æ‹©ç¬¬ä¸€ä¸ªä¸åŒ…å«NULLå€¼çš„å”¯ä¸€åˆ—ï¼‰ã€‚ä¸Šå›¾æ–¹æ¡†ä¸­çš„æ•°å­—ä»£è¡¨äº†ç´¢å¼•é”®çš„å€¼ï¼Œå¯¹èšç°‡ç´¢å¼•è€Œè¨€ä¸€èˆ¬å°±æ˜¯ä¸»é”®ã€‚</p><p>æˆ‘ä»¬å†çœ‹çœ‹B+æ ‘å¦‚ä½•å®ç°å¿«é€ŸæŸ¥æ‰¾ä¸»é”®ã€‚æ¯”å¦‚ï¼Œæˆ‘ä»¬è¦æœç´¢PK=4çš„æ•°æ®ï¼Œé€šè¿‡æ ¹èŠ‚ç‚¹ä¸­çš„ç´¢å¼•å¯ä»¥çŸ¥é“æ•°æ®åœ¨ç¬¬ä¸€ä¸ªè®°å½•æŒ‡å‘çš„2å·é¡µä¸­ï¼Œé€šè¿‡2å·é¡µçš„ç´¢å¼•åˆå¯ä»¥çŸ¥é“æ•°æ®åœ¨5å·é¡µï¼Œ5å·é¡µå°±æ˜¯å®é™…çš„æ•°æ®é¡µï¼Œç„¶åå†é€šè¿‡äºŒåˆ†æ³•æŸ¥æ‰¾é¡µç›®å½•é©¬ä¸Šå¯ä»¥æ‰¾åˆ°è®°å½•çš„æŒ‡é’ˆã€‚</p><p>ä¸ºäº†å®ç°éä¸»é”®å­—æ®µçš„å¿«é€Ÿæœç´¢ï¼Œå°±å¼•å‡ºäº†äºŒçº§ç´¢å¼•ï¼Œä¹Ÿå«ä½œéèšç°‡ç´¢å¼•ã€è¾…åŠ©ç´¢å¼•ã€‚äºŒçº§ç´¢å¼•ï¼Œä¹Ÿæ˜¯åˆ©ç”¨çš„B+æ ‘çš„æ•°æ®ç»“æ„ï¼Œå¦‚ä¸‹å›¾æ‰€ç¤ºï¼š</p><p><img src=\"https://static001.geekbang.org/resource/image/4b/3a/4be8f22d993bd92878209d00a1264b3a.png?wh=1952*1176\" alt=\"\"></p><p>è¿™æ¬¡äºŒçº§ç´¢å¼•çš„å¶å­èŠ‚ç‚¹ä¸­ä¿å­˜çš„ä¸æ˜¯å®é™…æ•°æ®ï¼Œè€Œæ˜¯ä¸»é”®ï¼Œè·å¾—ä¸»é”®å€¼åå»èšç°‡ç´¢å¼•ä¸­è·å¾—æ•°æ®è¡Œã€‚è¿™ä¸ªè¿‡ç¨‹å°±å«ä½œå›è¡¨ã€‚</p><p>ä¸¾ä¸ªä¾‹å­ï¼Œæœ‰ä¸ªç´¢å¼•æ˜¯é’ˆå¯¹ç”¨æˆ·åå­—æ®µåˆ›å»ºçš„ï¼Œç´¢å¼•è®°å½•ä¸Šé¢æ–¹å—ä¸­çš„å­—æ¯æ˜¯ç”¨æˆ·åï¼ŒæŒ‰ç…§é¡ºåºå½¢æˆé“¾è¡¨ã€‚å¦‚æœæˆ‘ä»¬è¦æœç´¢ç”¨æˆ·åä¸ºbçš„æ•°æ®ï¼Œç»è¿‡ä¸¤æ¬¡å®šä½å¯ä»¥å¾—å‡ºåœ¨#5æ•°æ®é¡µä¸­ï¼ŒæŸ¥å‡ºæ‰€æœ‰çš„ä¸»é”®ä¸º7å’Œ6ï¼Œå†æ‹¿ç€è¿™ä¸¤ä¸ªä¸»é”®ç»§ç»­ä½¿ç”¨èšç°‡ç´¢å¼•è¿›è¡Œä¸¤æ¬¡å›è¡¨å¾—åˆ°å®Œæ•´æ•°æ®ã€‚</p><h2>è€ƒè™‘é¢å¤–åˆ›å»ºäºŒçº§ç´¢å¼•çš„ä»£ä»·</h2><p>åˆ›å»ºäºŒçº§ç´¢å¼•çš„ä»£ä»·ï¼Œä¸»è¦è¡¨ç°åœ¨ç»´æŠ¤ä»£ä»·ã€ç©ºé—´ä»£ä»·å’Œå›è¡¨ä»£ä»·ä¸‰ä¸ªæ–¹é¢ã€‚æ¥ä¸‹æ¥ï¼Œæˆ‘å°±ä¸ä½ ä»”ç»†åˆ†æä¸‹å§ã€‚</p><p><strong>é¦–å…ˆæ˜¯ç»´æŠ¤ä»£ä»·</strong>ã€‚åˆ›å»ºNä¸ªäºŒçº§ç´¢å¼•ï¼Œå°±éœ€è¦å†åˆ›å»ºNæ£µB+æ ‘ï¼Œæ–°å¢æ•°æ®æ—¶ä¸ä»…è¦ä¿®æ”¹èšç°‡ç´¢å¼•ï¼Œè¿˜éœ€è¦ä¿®æ”¹è¿™Nä¸ªäºŒçº§ç´¢å¼•ã€‚</p><p>æˆ‘ä»¬é€šè¿‡å®éªŒæµ‹è¯•ä¸€ä¸‹åˆ›å»ºç´¢å¼•çš„ä»£ä»·ã€‚å‡è®¾æœ‰ä¸€ä¸ªpersonè¡¨ï¼Œæœ‰ä¸»é”®IDï¼Œä»¥åŠnameã€scoreã€create_timeä¸‰ä¸ªå­—æ®µï¼š</p><pre><code>CREATE TABLE `person` (\n  `id` bigint(20) NOT NULL AUTO_INCREMENT,\n  `name` varchar(255) NOT NULL,\n  `score` int(11) NOT NULL,\n  `create_time` timestamp NOT NULL,\n  PRIMARY KEY (`id`)\n) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4;\n</code></pre><p>é€šè¿‡ä¸‹é¢çš„å­˜å‚¨è¿‡ç¨‹å¾ªç¯åˆ›å»º10ä¸‡æ¡æµ‹è¯•æ•°æ®ï¼Œæˆ‘çš„æœºå™¨çš„è€—æ—¶æ˜¯140ç§’ï¼ˆæœ¬æ–‡çš„ä¾‹å­å‡åœ¨MySQL 5.7.26ä¸­æ‰§è¡Œï¼‰ï¼š</p><pre><code>CREATE DEFINER=`root`@`%` PROCEDURE `insert_person`()\nbegin\n    declare c_id integer default 1;\n    while c_id&lt;=100000 do\n    insert into person values(c_id, concat('name',c_id), c_id+100, date_sub(NOW(), interval c_id second));\n    set c_id=c_id+1;\n    end while;\nend\n</code></pre><p>å¦‚æœå†åˆ›å»ºä¸¤ä¸ªç´¢å¼•ï¼Œä¸€ä¸ªæ˜¯nameå’Œscoreæ„æˆçš„è”åˆç´¢å¼•ï¼Œå¦ä¸€ä¸ªæ˜¯å•ä¸€åˆ—create_timeçš„ç´¢å¼•ï¼Œé‚£ä¹ˆåˆ›å»º10ä¸‡æ¡è®°å½•çš„è€—æ—¶æé«˜åˆ°154ç§’ï¼š</p><pre><code>KEY `name_score` (`name`,`score`) USING BTREE,\nKEY `create_time` (`create_time`) USING BTREE\n</code></pre><p>è¿™é‡Œï¼Œæˆ‘å†é¢å¤–æä¸€ä¸‹ï¼Œé¡µä¸­çš„è®°å½•éƒ½æ˜¯æŒ‰ç…§ç´¢å¼•å€¼ä»å°åˆ°å¤§çš„é¡ºåºå­˜æ”¾çš„ï¼Œæ–°å¢è®°å½•å°±éœ€è¦å¾€é¡µä¸­æ’å…¥æ•°æ®ï¼Œç°æœ‰çš„é¡µæ»¡äº†å°±éœ€è¦æ–°åˆ›å»ºä¸€ä¸ªé¡µï¼ŒæŠŠç°æœ‰é¡µçš„éƒ¨åˆ†æ•°æ®ç§»è¿‡å»ï¼Œè¿™å°±æ˜¯é¡µåˆ†è£‚ï¼›å¦‚æœåˆ é™¤äº†è®¸å¤šæ•°æ®ä½¿å¾—é¡µæ¯”è¾ƒç©ºé—²ï¼Œè¿˜éœ€è¦è¿›è¡Œé¡µåˆå¹¶ã€‚é¡µåˆ†è£‚å’Œåˆå¹¶ï¼Œéƒ½ä¼šæœ‰IOä»£ä»·ï¼Œå¹¶ä¸”å¯èƒ½åœ¨æ“ä½œè¿‡ç¨‹ä¸­äº§ç”Ÿæ­»é”ã€‚</p><p>ä½ å¯ä»¥æŸ¥çœ‹<a href=\"https://dev.mysql.com/doc/refman/5.7/en/index-page-merge-threshold.html\">è¿™ä¸ªæ–‡æ¡£</a>ï¼Œä»¥è¿›ä¸€æ­¥äº†è§£å¦‚ä½•è®¾ç½®åˆç†çš„åˆå¹¶é˜ˆå€¼ï¼Œæ¥å¹³è¡¡é¡µçš„ç©ºé—²ç‡å’Œå› ä¸ºå†æ¬¡é¡µåˆ†è£‚äº§ç”Ÿçš„ä»£ä»·ã€‚</p><p><strong>å…¶æ¬¡æ˜¯ç©ºé—´ä»£ä»·</strong>ã€‚è™½ç„¶äºŒçº§ç´¢å¼•ä¸ä¿å­˜åŸå§‹æ•°æ®ï¼Œä½†è¦ä¿å­˜ç´¢å¼•åˆ—çš„æ•°æ®ï¼Œæ‰€ä»¥ä¼šå ç”¨æ›´å¤šçš„ç©ºé—´ã€‚æ¯”å¦‚ï¼Œpersonè¡¨åˆ›å»ºäº†ä¸¤ä¸ªç´¢å¼•åï¼Œä½¿ç”¨ä¸‹é¢çš„SQLæŸ¥çœ‹æ•°æ®å’Œç´¢å¼•å ç”¨çš„ç£ç›˜ï¼š</p><pre><code>SELECT DATA_LENGTH, INDEX_LENGTH FROM information_schema.TABLES WHERE TABLE_NAME='person'\n</code></pre><p>ç»“æœæ˜¾ç¤ºï¼Œæ•°æ®æœ¬èº«åªå ç”¨äº†4.7Mï¼Œè€Œç´¢å¼•å ç”¨äº†8.4Mã€‚</p><p><strong>æœ€åæ˜¯å›è¡¨çš„ä»£ä»·</strong>ã€‚äºŒçº§ç´¢å¼•ä¸ä¿å­˜åŸå§‹æ•°æ®ï¼Œé€šè¿‡ç´¢å¼•æ‰¾åˆ°ä¸»é”®åéœ€è¦å†æŸ¥è¯¢èšç°‡ç´¢å¼•ï¼Œæ‰èƒ½å¾—åˆ°æˆ‘ä»¬è¦çš„æ•°æ®ã€‚æ¯”å¦‚ï¼Œä½¿ç”¨SELECT * æŒ‰ç…§nameå­—æ®µæŸ¥è¯¢ç”¨æˆ·ï¼Œä½¿ç”¨EXPLAINæŸ¥çœ‹æ‰§è¡Œè®¡åˆ’ï¼š</p><pre><code>EXPLAIN SELECT * FROM person WHERE NAME='name1'\n</code></pre><p>æ‰§è¡Œè®¡åˆ’å¦‚ä¸‹ï¼Œå¯ä»¥å‘ç°ï¼š</p><p><img src=\"https://static001.geekbang.org/resource/image/f3/21/f380ee99efb997a8520d16f5433f7e21.png?wh=1654*98\" alt=\"\"></p><ul>\n<li>keyå­—æ®µä»£è¡¨å®é™…èµ°çš„æ˜¯å“ªä¸ªç´¢å¼•ï¼Œå…¶å€¼æ˜¯name_scoreï¼Œè¯´æ˜èµ°çš„æ˜¯name_scoreè¿™ä¸ªç´¢å¼•ã€‚</li>\n<li>typeå­—æ®µä»£è¡¨äº†è®¿é—®è¡¨çš„æ–¹å¼ï¼Œå…¶å€¼refè¯´æ˜æ˜¯äºŒçº§ç´¢å¼•ç­‰å€¼åŒ¹é…ï¼Œç¬¦åˆæˆ‘ä»¬çš„æŸ¥è¯¢ã€‚</li>\n</ul><p>æŠŠSQLä¸­çš„*ä¿®æ”¹ä¸ºNAMEå’ŒSCOREï¼Œä¹Ÿå°±æ˜¯SELECT name_scoreè”åˆç´¢å¼•åŒ…å«çš„ä¸¤åˆ—ï¼š</p><pre><code>EXPLAIN SELECT NAME,SCORE FROM person WHERE NAME='name1'\n</code></pre><p>å†æ¥çœ‹çœ‹æ‰§è¡Œè®¡åˆ’ï¼š</p><p><img src=\"https://static001.geekbang.org/resource/image/88/e7/88809b6f547238596d141eab27f3d7e7.png?wh=1712*100\" alt=\"\"></p><p>å¯ä»¥çœ‹åˆ°ï¼ŒExtraåˆ—å¤šäº†ä¸€è¡ŒUsing indexçš„æç¤ºï¼Œè¯æ˜è¿™æ¬¡æŸ¥è¯¢ç›´æ¥æŸ¥çš„æ˜¯äºŒçº§ç´¢å¼•ï¼Œå…å»äº†å›è¡¨ã€‚</p><p>åŸå› å¾ˆç®€å•ï¼Œè”åˆç´¢å¼•ä¸­å…¶å®ä¿å­˜äº†å¤šä¸ªç´¢å¼•åˆ—çš„å€¼ï¼Œå¯¹äºé¡µä¸­çš„è®°å½•å…ˆæŒ‰ç…§å­—æ®µ1æ’åºï¼Œå¦‚æœç›¸åŒå†æŒ‰ç…§å­—æ®µ2æ’åºï¼Œå¦‚å›¾æ‰€ç¤ºï¼š</p><p><img src=\"https://static001.geekbang.org/resource/image/80/72/803c3e6a8df1d6031db70473dc948472.png?wh=1984*1500\" alt=\"\"></p><p>å›¾ä¸­ï¼Œå¶å­èŠ‚ç‚¹æ¯ä¸€æ¡è®°å½•çš„ç¬¬ä¸€å’Œç¬¬äºŒä¸ªæ–¹å—æ˜¯ç´¢å¼•åˆ—çš„æ•°æ®ï¼Œç¬¬ä¸‰ä¸ªæ–¹å—æ˜¯è®°å½•çš„ä¸»é”®ã€‚å¦‚æœæˆ‘ä»¬éœ€è¦æŸ¥è¯¢çš„æ˜¯ç´¢å¼•åˆ—ç´¢å¼•æˆ–è”åˆç´¢å¼•èƒ½è¦†ç›–çš„æ•°æ®ï¼Œé‚£ä¹ˆæŸ¥è¯¢ç´¢å¼•æœ¬èº«å·²ç»â€œè¦†ç›–â€äº†éœ€è¦çš„æ•°æ®ï¼Œä¸å†éœ€è¦å›è¡¨æŸ¥è¯¢ã€‚å› æ­¤ï¼Œè¿™ç§æƒ…å†µä¹Ÿå«ä½œ<strong>ç´¢å¼•è¦†ç›–</strong>ã€‚æˆ‘ä¼šåœ¨æœ€åä¸€å°èŠ‚ä»‹ç»å¦‚ä½•æŸ¥çœ‹ä¸åŒæŸ¥è¯¢çš„æˆæœ¬ï¼Œå’Œä½ ä¸€èµ·çœ‹çœ‹ç´¢å¼•è¦†ç›–å’Œç´¢å¼•æŸ¥è¯¢åå›è¡¨çš„ä»£ä»·å·®å¼‚ã€‚</p><p>æœ€åï¼Œæˆ‘å’Œä½ æ€»ç»“ä¸‹å…³äºç´¢å¼•å¼€é”€çš„æœ€ä½³å®è·µå§ã€‚</p><p>ç¬¬ä¸€ï¼Œæ— éœ€ä¸€å¼€å§‹å°±å»ºç«‹ç´¢å¼•ï¼Œå¯ä»¥ç­‰åˆ°ä¸šåŠ¡åœºæ™¯æ˜ç¡®åï¼Œæˆ–è€…æ˜¯æ•°æ®é‡è¶…è¿‡1ä¸‡ã€æŸ¥è¯¢å˜æ…¢åï¼Œå†é’ˆå¯¹éœ€è¦æŸ¥è¯¢ã€æ’åºæˆ–åˆ†ç»„çš„å­—æ®µåˆ›å»ºç´¢å¼•ã€‚åˆ›å»ºç´¢å¼•åå¯ä»¥ä½¿ç”¨EXPLAINå‘½ä»¤ï¼Œç¡®è®¤æŸ¥è¯¢æ˜¯å¦å¯ä»¥ä½¿ç”¨ç´¢å¼•ã€‚æˆ‘ä¼šåœ¨ä¸‹ä¸€å°èŠ‚å±•å¼€è¯´æ˜ã€‚</p><p>ç¬¬äºŒï¼Œå°½é‡ç´¢å¼•è½»é‡çº§çš„å­—æ®µï¼Œæ¯”å¦‚èƒ½ç´¢å¼•intå­—æ®µå°±ä¸è¦ç´¢å¼•varcharå­—æ®µã€‚ç´¢å¼•å­—æ®µä¹Ÿå¯ä»¥æ˜¯éƒ¨åˆ†å‰ç¼€ï¼Œåœ¨åˆ›å»ºçš„æ—¶å€™æŒ‡å®šå­—æ®µç´¢å¼•é•¿åº¦ã€‚é’ˆå¯¹é•¿æ–‡æœ¬çš„æœç´¢ï¼Œå¯ä»¥è€ƒè™‘ä½¿ç”¨Elasticsearchç­‰ä¸“é—¨ç”¨äºæ–‡æœ¬æœç´¢çš„ç´¢å¼•æ•°æ®åº“ã€‚</p><p>ç¬¬ä¸‰ï¼Œå°½é‡ä¸è¦åœ¨SQLè¯­å¥ä¸­SELECT *ï¼Œè€Œæ˜¯SELECTå¿…è¦çš„å­—æ®µï¼Œç”šè‡³å¯ä»¥è€ƒè™‘ä½¿ç”¨è”åˆç´¢å¼•æ¥åŒ…å«æˆ‘ä»¬è¦æœç´¢çš„å­—æ®µï¼Œæ—¢èƒ½å®ç°ç´¢å¼•åŠ é€Ÿï¼Œåˆå¯ä»¥é¿å…å›è¡¨çš„å¼€é”€ã€‚</p><h2>ä¸æ˜¯æ‰€æœ‰é’ˆå¯¹ç´¢å¼•åˆ—çš„æŸ¥è¯¢éƒ½èƒ½ç”¨ä¸Šç´¢å¼•</h2><p>åœ¨ä¸Šä¸€ä¸ªæ¡ˆä¾‹ä¸­ï¼Œæˆ‘åˆ›å»ºäº†ä¸€ä¸ªname+scoreçš„è”åˆç´¢å¼•ï¼Œä»…æœç´¢nameæ—¶å°±èƒ½å¤Ÿç”¨ä¸Šè¿™ä¸ªè”åˆç´¢å¼•ã€‚è¿™å°±å¼•å‡ºä¸¤ä¸ªé—®é¢˜ï¼š</p><ul>\n<li>æ˜¯ä¸æ˜¯å»ºäº†ç´¢å¼•ä¸€å®šå¯ä»¥ç”¨ä¸Šï¼Ÿ</li>\n<li>æ€ä¹ˆé€‰æ‹©åˆ›å»ºè”åˆç´¢å¼•è¿˜æ˜¯å¤šä¸ªç‹¬ç«‹ç´¢å¼•ï¼Ÿ</li>\n</ul><p>é¦–å…ˆï¼Œæˆ‘ä»¬é€šè¿‡å‡ ä¸ªæ¡ˆä¾‹æ¥åˆ†æä¸€ä¸‹ç´¢å¼•å¤±æ•ˆçš„æƒ…å†µã€‚</p><p>ç¬¬ä¸€ï¼Œ<strong>ç´¢å¼•åªèƒ½åŒ¹é…åˆ—å‰ç¼€</strong>ã€‚æ¯”å¦‚ä¸‹é¢çš„LIKEè¯­å¥ï¼Œæœç´¢nameåç¼€ä¸ºname123çš„ç”¨æˆ·æ— æ³•èµ°ç´¢å¼•ï¼Œæ‰§è¡Œè®¡åˆ’çš„type=ALLä»£è¡¨äº†å…¨è¡¨æ‰«æï¼š</p><pre><code>EXPLAIN SELECT * FROM person WHERE NAME LIKE '%name123' LIMIT 100\n</code></pre><p><img src=\"https://static001.geekbang.org/resource/image/e1/c9/e1033c6534938f8381fce051fb8ef8c9.png?wh=1806*126\" alt=\"\"></p><p>æŠŠç™¾åˆ†å·æ”¾åˆ°åé¢èµ°å‰ç¼€åŒ¹é…ï¼Œtype=rangeè¡¨ç¤ºèµ°ç´¢å¼•æ‰«æï¼Œkey=name_scoreçœ‹åˆ°å®é™…èµ°äº†name_scoreç´¢å¼•ï¼š</p><pre><code>EXPLAIN SELECT * FROM person WHERE NAME LIKE 'name123%' LIMIT 100\n</code></pre><p><img src=\"https://static001.geekbang.org/resource/image/95/5a/95074c69e68039738046fd4275c4d85a.png?wh=1824*104\" alt=\"\"></p><p>åŸå› å¾ˆç®€å•ï¼Œç´¢å¼•B+æ ‘ä¸­è¡Œæ•°æ®æŒ‰ç…§ç´¢å¼•å€¼æ’åºï¼Œåªèƒ½æ ¹æ®å‰ç¼€è¿›è¡Œæ¯”è¾ƒã€‚å¦‚æœè¦æŒ‰ç…§åç¼€æœç´¢ä¹Ÿå¸Œæœ›èµ°ç´¢å¼•çš„è¯ï¼Œå¹¶ä¸”æ°¸è¿œåªæ˜¯æŒ‰ç…§åç¼€æœç´¢çš„è¯ï¼Œå¯ä»¥æŠŠæ•°æ®åè¿‡æ¥å­˜ï¼Œç”¨çš„æ—¶å€™å†å€’è¿‡æ¥ã€‚</p><p>ç¬¬äºŒï¼Œ<strong>æ¡ä»¶æ¶‰åŠå‡½æ•°æ“ä½œæ— æ³•èµ°ç´¢å¼•</strong>ã€‚æ¯”å¦‚æœç´¢æ¡ä»¶ç”¨åˆ°äº†LENGTHå‡½æ•°ï¼Œè‚¯å®šæ— æ³•èµ°ç´¢å¼•ï¼š</p><pre><code>EXPLAIN SELECT * FROM person WHERE LENGTH(NAME)=7\n</code></pre><p><img src=\"https://static001.geekbang.org/resource/image/f1/08/f1eadcdd35b96c9f982115e528ee6808.png?wh=1684*120\" alt=\"\"></p><p>åŒæ ·çš„åŸå› ï¼Œç´¢å¼•ä¿å­˜çš„æ˜¯ç´¢å¼•åˆ—çš„åŸå§‹å€¼ï¼Œè€Œä¸æ˜¯ç»è¿‡å‡½æ•°è®¡ç®—åçš„å€¼ã€‚å¦‚æœéœ€è¦é’ˆå¯¹å‡½æ•°è°ƒç”¨èµ°æ•°æ®åº“ç´¢å¼•çš„è¯ï¼Œåªèƒ½ä¿å­˜ä¸€ä»½å‡½æ•°å˜æ¢åçš„å€¼ï¼Œç„¶åé‡æ–°é’ˆå¯¹è¿™ä¸ªè®¡ç®—åˆ—åšç´¢å¼•ã€‚</p><p>ç¬¬ä¸‰ï¼Œ<strong>è”åˆç´¢å¼•åªèƒ½åŒ¹é…å·¦è¾¹çš„åˆ—</strong>ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œè™½ç„¶å¯¹nameå’Œscoreå»ºäº†è”åˆç´¢å¼•ï¼Œä½†æ˜¯ä»…æŒ‰ç…§scoreåˆ—æœç´¢æ— æ³•èµ°ç´¢å¼•ï¼š</p><pre><code>EXPLAIN SELECT * FROM person WHERE SCORE&gt;45678\n</code></pre><p><img src=\"https://static001.geekbang.org/resource/image/0d/e3/0d3d1a4ad0ae545f0264be3de781e0e3.png?wh=1714*122\" alt=\"\"></p><p>åŸå› ä¹Ÿå¾ˆç®€å•ï¼Œåœ¨è”åˆç´¢å¼•çš„æƒ…å†µä¸‹ï¼Œæ•°æ®æ˜¯æŒ‰ç…§ç´¢å¼•ç¬¬ä¸€åˆ—æ’åºï¼Œç¬¬ä¸€åˆ—æ•°æ®ç›¸åŒæ—¶æ‰ä¼šæŒ‰ç…§ç¬¬äºŒåˆ—æ’åºã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œå¦‚æœæˆ‘ä»¬æƒ³ä½¿ç”¨è”åˆç´¢å¼•ä¸­å°½å¯èƒ½å¤šçš„åˆ—ï¼ŒæŸ¥è¯¢æ¡ä»¶ä¸­çš„å„ä¸ªåˆ—å¿…é¡»æ˜¯è”åˆç´¢å¼•ä¸­ä»æœ€å·¦è¾¹å¼€å§‹è¿ç»­çš„åˆ—ã€‚å¦‚æœæˆ‘ä»¬ä»…ä»…æŒ‰ç…§ç¬¬äºŒåˆ—æœç´¢ï¼Œè‚¯å®šæ— æ³•èµ°ç´¢å¼•ã€‚å°è¯•æŠŠæœç´¢æ¡ä»¶åŠ å…¥nameåˆ—ï¼Œå¯ä»¥çœ‹åˆ°èµ°äº†name_scoreç´¢å¼•ï¼š</p><pre><code>EXPLAIN SELECT * FROM person WHERE SCORE&gt;45678 AND NAME LIKE 'NAME45%'\n</code></pre><p><img src=\"https://static001.geekbang.org/resource/image/77/17/77c946fcf49059d40673cf6075119d17.png?wh=1916*102\" alt=\"\"></p><p>éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œå› ä¸ºæœ‰æŸ¥è¯¢ä¼˜åŒ–å™¨ï¼Œæ‰€ä»¥nameä½œä¸ºWHEREå­å¥çš„ç¬¬å‡ ä¸ªæ¡ä»¶å¹¶ä¸æ˜¯å¾ˆé‡è¦ã€‚</p><p>ç°åœ¨å›åˆ°æœ€å¼€å§‹çš„ä¸¤ä¸ªé—®é¢˜ã€‚</p><ul>\n<li>æ˜¯ä¸æ˜¯å»ºäº†ç´¢å¼•ä¸€å®šå¯ä»¥ç”¨ä¸Šï¼Ÿå¹¶ä¸æ˜¯ï¼Œåªæœ‰å½“æŸ¥è¯¢èƒ½ç¬¦åˆç´¢å¼•å­˜å‚¨çš„å®é™…ç»“æ„æ—¶ï¼Œæ‰èƒ½ç”¨ä¸Šã€‚è¿™é‡Œï¼Œæˆ‘åªç»™å‡ºäº†ä¸‰ä¸ªè‚¯å®šç”¨ä¸ä¸Šç´¢å¼•çš„åä¾‹ã€‚å…¶å®ï¼Œæœ‰çš„æ—¶å€™å³ä½¿å¯ä»¥èµ°ç´¢å¼•ï¼ŒMySQLä¹Ÿä¸ä¸€å®šä¼šé€‰æ‹©ä½¿ç”¨ç´¢å¼•ã€‚æˆ‘ä¼šåœ¨ä¸‹ä¸€å°èŠ‚å±•å¼€è¿™ä¸€ç‚¹ã€‚</li>\n<li>æ€ä¹ˆé€‰æ‹©å»ºè”åˆç´¢å¼•è¿˜æ˜¯å¤šä¸ªç‹¬ç«‹ç´¢å¼•ï¼Ÿå¦‚æœä½ çš„æœç´¢æ¡ä»¶ç»å¸¸ä¼šä½¿ç”¨å¤šä¸ªå­—æ®µè¿›è¡Œæœç´¢ï¼Œé‚£ä¹ˆå¯ä»¥è€ƒè™‘é’ˆå¯¹è¿™å‡ ä¸ªå­—æ®µå»ºè”åˆç´¢å¼•ï¼›åŒæ—¶ï¼Œé’ˆå¯¹å¤šå­—æ®µå»ºç«‹è”åˆç´¢å¼•ï¼Œä½¿ç”¨ç´¢å¼•è¦†ç›–çš„å¯èƒ½æ›´å¤§ã€‚å¦‚æœåªä¼šæŸ¥è¯¢å•ä¸ªå­—æ®µï¼Œå¯ä»¥è€ƒè™‘å»ºå•ç‹¬çš„ç´¢å¼•ï¼Œæ¯•ç«Ÿè”åˆç´¢å¼•ä¿å­˜äº†ä¸å¿…è¦å­—æ®µä¹Ÿæœ‰æˆæœ¬ã€‚</li>\n</ul><h2>æ•°æ®åº“åŸºäºæˆæœ¬å†³å®šæ˜¯å¦èµ°ç´¢å¼•</h2><p>é€šè¿‡å‰é¢çš„æ¡ˆä¾‹ï¼Œæˆ‘ä»¬å¯ä»¥çœ‹åˆ°ï¼ŒæŸ¥è¯¢æ•°æ®å¯ä»¥ç›´æ¥åœ¨èšç°‡ç´¢å¼•ä¸Šè¿›è¡Œå…¨è¡¨æ‰«æï¼Œä¹Ÿå¯ä»¥èµ°äºŒçº§ç´¢å¼•æ‰«æååˆ°èšç°‡ç´¢å¼•å›è¡¨ã€‚çœ‹åˆ°è¿™é‡Œï¼Œä½ ä¸ç¦è¦é—®äº†ï¼ŒMySQLåˆ°åº•æ˜¯æ€ä¹ˆç¡®å®šèµ°å“ªç§æ–¹æ¡ˆçš„å‘¢ã€‚</p><p>å…¶å®ï¼ŒMySQLåœ¨æŸ¥è¯¢æ•°æ®ä¹‹å‰ï¼Œä¼šå…ˆå¯¹å¯èƒ½çš„æ–¹æ¡ˆåšæ‰§è¡Œè®¡åˆ’ï¼Œç„¶åä¾æ®æˆæœ¬å†³å®šèµ°å“ªä¸ªæ‰§è¡Œè®¡åˆ’ã€‚</p><p>è¿™é‡Œçš„æˆæœ¬ï¼ŒåŒ…æ‹¬IOæˆæœ¬å’ŒCPUæˆæœ¬ï¼š</p><ul>\n<li>IOæˆæœ¬ï¼Œæ˜¯ä»ç£ç›˜æŠŠæ•°æ®åŠ è½½åˆ°å†…å­˜çš„æˆæœ¬ã€‚é»˜è®¤æƒ…å†µä¸‹ï¼Œè¯»å–æ•°æ®é¡µçš„IOæˆæœ¬å¸¸æ•°æ˜¯1ï¼ˆä¹Ÿå°±æ˜¯è¯»å–1ä¸ªé¡µæˆæœ¬æ˜¯1ï¼‰ã€‚</li>\n<li>CPUæˆæœ¬ï¼Œæ˜¯æ£€æµ‹æ•°æ®æ˜¯å¦æ»¡è¶³æ¡ä»¶å’Œæ’åºç­‰CPUæ“ä½œçš„æˆæœ¬ã€‚é»˜è®¤æƒ…å†µä¸‹ï¼Œæ£€æµ‹è®°å½•çš„æˆæœ¬æ˜¯0.2ã€‚</li>\n</ul><p>åŸºäºæ­¤ï¼Œæˆ‘ä»¬åˆ†æä¸‹å…¨è¡¨æ‰«æçš„æˆæœ¬ã€‚</p><p>å…¨è¡¨æ‰«æï¼Œå°±æ˜¯æŠŠèšç°‡ç´¢å¼•ä¸­çš„è®°å½•ä¾æ¬¡å’Œç»™å®šçš„æœç´¢æ¡ä»¶åšæ¯”è¾ƒï¼ŒæŠŠç¬¦åˆæœç´¢æ¡ä»¶çš„è®°å½•åŠ å…¥ç»“æœé›†çš„è¿‡ç¨‹ã€‚é‚£ä¹ˆï¼Œè¦è®¡ç®—å…¨è¡¨æ‰«æçš„ä»£ä»·éœ€è¦ä¸¤ä¸ªä¿¡æ¯ï¼š</p><ul>\n<li>èšç°‡ç´¢å¼•å ç”¨çš„é¡µé¢æ•°ï¼Œç”¨æ¥è®¡ç®—è¯»å–æ•°æ®çš„IOæˆæœ¬ï¼›</li>\n<li>è¡¨ä¸­çš„è®°å½•æ•°ï¼Œç”¨æ¥è®¡ç®—æœç´¢çš„CPUæˆæœ¬ã€‚</li>\n</ul><p>é‚£ä¹ˆï¼ŒMySQLæ˜¯å®æ—¶ç»Ÿè®¡è¿™äº›ä¿¡æ¯çš„å—ï¼Ÿå…¶å®å¹¶ä¸æ˜¯ï¼ŒMySQLç»´æŠ¤äº†è¡¨çš„ç»Ÿè®¡ä¿¡æ¯ï¼Œå¯ä»¥ä½¿ç”¨ä¸‹é¢çš„å‘½ä»¤æŸ¥çœ‹ï¼š</p><pre><code>SHOW TABLE STATUS LIKE 'person'\n</code></pre><p>è¾“å‡ºå¦‚ä¸‹ï¼š</p><p><img src=\"https://static001.geekbang.org/resource/image/55/32/5554af3acf1005fac1b6a494b6578732.png?wh=1614*1118\" alt=\"\"></p><p>å¯ä»¥çœ‹åˆ°ï¼š</p><ul>\n<li>æ€»è¡Œæ•°æ˜¯100086è¡Œï¼ˆä¹‹å‰EXPLAINæ—¶ï¼Œä¹Ÿçœ‹åˆ°rowsä¸º100086ï¼‰ã€‚ä½ å¯èƒ½è¯´ï¼Œpersonè¡¨ä¸æ˜¯æœ‰10ä¸‡è¡Œè®°å½•å—ï¼Œä¸ºä»€ä¹ˆè¿™é‡Œå¤šäº†86è¡Œï¼Ÿå…¶å®ï¼ŒMySQLçš„ç»Ÿè®¡ä¿¡æ¯æ˜¯ä¸€ä¸ªä¼°ç®—ï¼Œå…¶ç»Ÿè®¡æ–¹å¼æ¯”è¾ƒå¤æ‚æˆ‘å°±ä¸å†å±•å¼€äº†ã€‚ä½†ä¸å¦¨ç¢æˆ‘ä»¬æ ¹æ®è¿™ä¸ªå€¼ä¼°ç®—CPUæˆæœ¬ï¼Œæ˜¯100086*0.2=20017å·¦å³ã€‚</li>\n<li>æ•°æ®é•¿åº¦æ˜¯4734976å­—èŠ‚ã€‚å¯¹äºInnoDBæ¥è¯´ï¼Œè¿™å°±æ˜¯èšç°‡ç´¢å¼•å ç”¨çš„ç©ºé—´ï¼Œç­‰äºèšç°‡ç´¢å¼•çš„é¡µé¢æ•°é‡*æ¯ä¸ªé¡µé¢çš„å¤§å°ã€‚InnoDBæ¯ä¸ªé¡µé¢çš„å¤§å°æ˜¯16KBï¼Œå¤§æ¦‚è®¡ç®—å‡ºé¡µé¢æ•°é‡æ˜¯289ï¼Œå› æ­¤IOæˆæœ¬æ˜¯289å·¦å³ã€‚</li>\n</ul><p>æ‰€ä»¥ï¼Œå…¨è¡¨æ‰«æçš„æ€»æˆæœ¬æ˜¯20306å·¦å³ã€‚</p><p>æ¥ä¸‹æ¥ï¼Œæˆ‘è¿˜æ˜¯ç”¨personè¡¨è¿™ä¸ªä¾‹å­ï¼Œå’Œä½ åˆ†æä¸‹MySQLå¦‚ä½•åŸºäºæˆæœ¬æ¥åˆ¶å®šæ‰§è¡Œè®¡åˆ’ã€‚ç°åœ¨ï¼Œæˆ‘è¦ç”¨ä¸‹é¢çš„SQLæŸ¥è¯¢name&gt;â€˜name84059â€™ AND create_time&gt;â€˜2020-01-24 05:00:00â€™</p><pre><code>EXPLAIN SELECT * FROM person WHERE NAME &gt;'name84059' AND create_time&gt;'2020-01-24 05:00:00'\n</code></pre><p>å…¶æ‰§è¡Œè®¡åˆ’æ˜¯å…¨è¡¨æ‰«æï¼š</p><p><img src=\"https://static001.geekbang.org/resource/image/54/a8/54c6e60d390b54d5e1ae1e8bc2451fa8.png?wh=1912*116\" alt=\"\"></p><p>åªè¦æŠŠcreate_timeæ¡ä»¶ä¸­çš„5ç‚¹æ”¹ä¸º6ç‚¹å°±å˜ä¸ºèµ°ç´¢å¼•äº†ï¼Œå¹¶ä¸”èµ°çš„æ˜¯create_timeç´¢å¼•è€Œä¸æ˜¯name_scoreè”åˆç´¢å¼•ï¼š</p><p><img src=\"https://static001.geekbang.org/resource/image/25/aa/2501093bce47944d4a9c2b090c2f8baa.png?wh=2052*112\" alt=\"\"></p><p><strong>æˆ‘ä»¬å¯ä»¥å¾—åˆ°ä¸¤ä¸ªç»“è®ºï¼š</strong></p><ul>\n<li>MySQLé€‰æ‹©ç´¢å¼•ï¼Œå¹¶ä¸æ˜¯æŒ‰ç…§WHEREæ¡ä»¶ä¸­åˆ—çš„é¡ºåºè¿›è¡Œçš„ï¼›</li>\n<li>å³ä¾¿åˆ—æœ‰ç´¢å¼•ï¼Œç”šè‡³æœ‰å¤šä¸ªå¯èƒ½çš„ç´¢å¼•æ–¹æ¡ˆï¼ŒMySQLä¹Ÿå¯èƒ½ä¸èµ°ç´¢å¼•ã€‚</li>\n</ul><p>å…¶åŸå› å°±æ˜¯ï¼ŒMySQLå¹¶ä¸æ˜¯çŒœæ‹³å†³å®šæ˜¯å¦èµ°ç´¢å¼•çš„ï¼Œè€Œæ˜¯æ ¹æ®æˆæœ¬æ¥åˆ¤æ–­çš„ã€‚è™½ç„¶è¡¨çš„ç»Ÿè®¡ä¿¡æ¯ä¸å®Œå…¨å‡†ç¡®ï¼Œä½†è¶³å¤Ÿç”¨äºç­–ç•¥çš„åˆ¤æ–­äº†ã€‚</p><p>ä¸è¿‡ï¼Œæœ‰æ—¶ä¼šå› ä¸ºç»Ÿè®¡ä¿¡æ¯çš„ä¸å‡†ç¡®æˆ–æˆæœ¬ä¼°ç®—çš„é—®é¢˜ï¼Œå®é™…å¼€é”€ä¼šå’ŒMySQLç»Ÿè®¡å‡ºæ¥çš„å·®è·è¾ƒå¤§ï¼Œå¯¼è‡´MySQLé€‰æ‹©é”™è¯¯çš„ç´¢å¼•æˆ–æ˜¯ç›´æ¥é€‰æ‹©èµ°å…¨è¡¨æ‰«æï¼Œè¿™ä¸ªæ—¶å€™å°±éœ€è¦äººå·¥å¹²é¢„ï¼Œä½¿ç”¨å¼ºåˆ¶ç´¢å¼•äº†ã€‚æ¯”å¦‚ï¼Œåƒè¿™æ ·å¼ºåˆ¶èµ°name_scoreç´¢å¼•ï¼š</p><pre><code>EXPLAIN SELECT * FROM person FORCE INDEX(name_score) WHERE NAME &gt;'name84059' AND create_time&gt;'2020-01-24 05:00:00' \n</code></pre><p>æˆ‘ä»¬ä»‹ç»äº†MySQLä¼šæ ¹æ®æˆæœ¬é€‰æ‹©æ‰§è¡Œè®¡åˆ’ï¼Œä¹Ÿé€šè¿‡EXPLAINçŸ¥é“äº†ä¼˜åŒ–å™¨æœ€ç»ˆä¼šé€‰æ‹©æ€æ ·çš„æ‰§è¡Œè®¡åˆ’ï¼Œä½†MySQLå¦‚ä½•åˆ¶å®šæ‰§è¡Œè®¡åˆ’å§‹ç»ˆæ˜¯ä¸€ä¸ªé»‘ç›’ã€‚é‚£ä¹ˆï¼Œæœ‰æ²¡æœ‰ä»€ä¹ˆåŠæ³•å¯ä»¥äº†è§£å„ç§æ‰§è¡Œè®¡åˆ’çš„æˆæœ¬ï¼Œä»¥åŠMySQLåšå‡ºé€‰æ‹©çš„ä¾æ®å‘¢ï¼Ÿ</p><p>åœ¨MySQL 5.6åŠä¹‹åçš„ç‰ˆæœ¬ä¸­ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨optimizer traceåŠŸèƒ½æŸ¥çœ‹ä¼˜åŒ–å™¨ç”Ÿæˆæ‰§è¡Œè®¡åˆ’çš„æ•´ä¸ªè¿‡ç¨‹ã€‚æœ‰äº†è¿™ä¸ªåŠŸèƒ½ï¼Œæˆ‘ä»¬ä¸ä»…å¯ä»¥äº†è§£ä¼˜åŒ–å™¨çš„é€‰æ‹©è¿‡ç¨‹ï¼Œæ›´å¯ä»¥äº†è§£æ¯ä¸€ä¸ªæ‰§è¡Œç¯èŠ‚çš„æˆæœ¬ï¼Œç„¶åä¾é è¿™äº›ä¿¡æ¯è¿›ä¸€æ­¥ä¼˜åŒ–æŸ¥è¯¢ã€‚</p><p>å¦‚ä¸‹ä»£ç æ‰€ç¤ºï¼Œæ‰“å¼€optimizer_traceåï¼Œå†æ‰§è¡ŒSQLå°±å¯ä»¥æŸ¥è¯¢information_schema.OPTIMIZER_TRACEè¡¨æŸ¥çœ‹æ‰§è¡Œè®¡åˆ’äº†ï¼Œæœ€åå¯ä»¥å…³é—­optimizer_traceåŠŸèƒ½ï¼š</p><pre><code>SET optimizer_trace=&quot;enabled=on&quot;;\nSELECT * FROM person WHERE NAME &gt;'name84059' AND create_time&gt;'2020-01-24 05:00:00';\nSELECT * FROM information_schema.OPTIMIZER_TRACE;\nSET optimizer_trace=&quot;enabled=off&quot;;\n</code></pre><p>å¯¹äºæŒ‰ç…§create_time&gt;'2020-01-24 05:00:00â€™æ¡ä»¶èµ°å…¨è¡¨æ‰«æçš„SQLï¼Œæˆ‘ä»OPTIMIZER_TRACEçš„æ‰§è¡Œç»“æœä¸­ï¼Œæ‘˜å‡ºäº†å‡ ä¸ªé‡è¦ç‰‡æ®µæ¥é‡ç‚¹åˆ†æï¼š</p><ul>\n<li>ä½¿ç”¨name_scoreå¯¹name84059&lt;nameæ¡ä»¶è¿›è¡Œç´¢å¼•æ‰«æéœ€è¦æ‰«æ25362è¡Œï¼Œæˆæœ¬æ˜¯30435ï¼Œå› æ­¤æœ€ç»ˆæ²¡æœ‰é€‰æ‹©è¿™ä¸ªæ–¹æ¡ˆã€‚è¿™é‡Œçš„30435æ˜¯æŸ¥è¯¢äºŒçº§ç´¢å¼•çš„IOæˆæœ¬å’ŒCPUæˆæœ¬ä¹‹å’Œï¼Œå†åŠ ä¸Šå›è¡¨æŸ¥è¯¢èšç°‡ç´¢å¼•çš„IOæˆæœ¬å’ŒCPUæˆæœ¬ä¹‹å’Œï¼Œæˆ‘å°±ä¸å†å…·ä½“åˆ†æäº†ï¼š</li>\n</ul><pre><code>{\n\t&quot;index&quot;: &quot;name_score&quot;,\n\t&quot;ranges&quot;: [\n\t\t&quot;name84059 &lt; name&quot;\n\t],\n\t&quot;rows&quot;: 25362,\n\t&quot;cost&quot;: 30435,\n\t&quot;chosen&quot;: false,\n\t&quot;cause&quot;: &quot;cost&quot;\n},\n</code></pre><ul>\n<li>ä½¿ç”¨create_timeè¿›è¡Œç´¢å¼•æ‰«æéœ€è¦æ‰«æ23758è¡Œï¼Œæˆæœ¬æ˜¯28511ï¼ŒåŒæ ·å› ä¸ºæˆæœ¬åŸå› æ²¡æœ‰é€‰æ‹©è¿™ä¸ªæ–¹æ¡ˆï¼š</li>\n</ul><pre><code>{\n\t&quot;index&quot;: &quot;create_time&quot;,\n\t&quot;ranges&quot;: [\n\t\t&quot;0x5e2a79d0 &lt; create_time&quot;\n\t],\n\t&quot;rows&quot;: 23758,\n\t&quot;cost&quot;: 28511,\n\t&quot;chosen&quot;: false,\n\t&quot;cause&quot;: &quot;cost&quot;\n}\n</code></pre><ul>\n<li>æœ€ç»ˆé€‰æ‹©äº†å…¨è¡¨æ‰«ææ–¹å¼ä½œä¸ºæ‰§è¡Œè®¡åˆ’ã€‚å¯ä»¥çœ‹åˆ°ï¼Œå…¨è¡¨æ‰«æ100086æ¡è®°å½•çš„æˆæœ¬æ˜¯20306ï¼Œå’Œæˆ‘ä»¬ä¹‹å‰è®¡ç®—çš„ä¸€è‡´ï¼Œæ˜¾ç„¶æ˜¯å°äºå…¶ä»–ä¸¤ä¸ªæ–¹æ¡ˆçš„28511å’Œ30435ï¼š</li>\n</ul><pre><code>{\n\t&quot;considered_execution_plans&quot;: [{\n\t\t&quot;table&quot;: &quot;`person`&quot;,\n\t\t&quot;best_access_path&quot;: {\n\t\t\t&quot;considered_access_paths&quot;: [{\n\t\t\t\t&quot;rows_to_scan&quot;: 100086,\n\t\t\t\t&quot;access_type&quot;: &quot;scan&quot;,\n\t\t\t\t&quot;resulting_rows&quot;: 100086,\n\t\t\t\t&quot;cost&quot;: 20306,\n\t\t\t\t&quot;chosen&quot;: true\n\t\t\t}]\n\t\t},\n\t\t&quot;rows_for_plan&quot;: 100086,\n\t\t&quot;cost_for_plan&quot;: 20306,\n\t\t&quot;chosen&quot;: true\n\t}]\n},\n</code></pre><p>æŠŠSQLä¸­çš„create_timeæ¡ä»¶ä»05:00æ”¹ä¸º06:00ï¼Œå†æ¬¡åˆ†æOPTIMIZER_TRACEå¯ä»¥çœ‹åˆ°ï¼Œè¿™æ¬¡æ‰§è¡Œè®¡åˆ’é€‰æ‹©çš„æ˜¯èµ°create_timeç´¢å¼•ã€‚å› ä¸ºæ˜¯æŸ¥è¯¢æ›´æ™šæ—¶é—´çš„æ•°æ®ï¼Œèµ°create_timeç´¢å¼•éœ€è¦æ‰«æçš„è¡Œæ•°ä»23758å‡å°‘åˆ°äº†16588ã€‚è¿™æ¬¡èµ°è¿™ä¸ªç´¢å¼•çš„æˆæœ¬19907å°äºå…¨è¡¨æ‰«æçš„20306ï¼Œæ›´å°äºèµ°name_scoreç´¢å¼•çš„30435ï¼š</p><pre><code>{\n\t&quot;index&quot;: &quot;create_time&quot;,\n\t&quot;ranges&quot;: [\n\t\t&quot;0x5e2a87e0 &lt; create_time&quot;\n\t],\n\t&quot;rows&quot;: 16588,\n\t&quot;cost&quot;: 19907,\n\t&quot;chosen&quot;: true\n}\n</code></pre><p>æœ‰å…³optimizer traceçš„æ›´å¤šä¿¡æ¯ï¼Œä½ å¯ä»¥å‚è€ƒ<a href=\"https://dev.mysql.com/doc/internals/en/optimizer-tracing.html\">MySQLçš„æ–‡æ¡£</a>ã€‚</p><h2>é‡ç‚¹å›é¡¾</h2><p>ä»Šå¤©ï¼Œæˆ‘å…ˆå’Œä½ åˆ†æäº†MySQL InnoDBå­˜å‚¨å¼•æ“é¡µã€èšç°‡ç´¢å¼•å’ŒäºŒçº§ç´¢å¼•çš„ç»“æ„ï¼Œç„¶ååˆ†æäº†å…³äºç´¢å¼•çš„ä¸¤ä¸ªè¯¯åŒºã€‚</p><p>ç¬¬ä¸€ä¸ªè¯¯åŒºæ˜¯ï¼Œè€ƒè™‘åˆ°ç´¢å¼•çš„ç»´æŠ¤ä»£ä»·ã€ç©ºé—´å ç”¨å’ŒæŸ¥è¯¢æ—¶å›è¡¨çš„ä»£ä»·ï¼Œä¸èƒ½è®¤ä¸ºç´¢å¼•è¶Šå¤šè¶Šå¥½ã€‚ç´¢å¼•ä¸€å®šæ˜¯æŒ‰éœ€åˆ›å»ºçš„ï¼Œå¹¶ä¸”è¦å°½å¯èƒ½ç¡®ä¿è¶³å¤Ÿè½»é‡ã€‚ä¸€æ—¦åˆ›å»ºäº†å¤šå­—æ®µçš„è”åˆç´¢å¼•ï¼Œæˆ‘ä»¬è¦è€ƒè™‘å°½å¯èƒ½åˆ©ç”¨ç´¢å¼•æœ¬èº«å®Œæˆæ•°æ®æŸ¥è¯¢ï¼Œå‡å°‘å›è¡¨çš„æˆæœ¬ã€‚</p><p>ç¬¬äºŒä¸ªè¯¯åŒºæ˜¯ï¼Œä¸èƒ½è®¤ä¸ºå»ºäº†ç´¢å¼•å°±ä¸€å®šæœ‰æ•ˆï¼Œå¯¹äºåç¼€çš„åŒ¹é…æŸ¥è¯¢ã€æŸ¥è¯¢ä¸­ä¸åŒ…å«è”åˆç´¢å¼•çš„ç¬¬ä¸€åˆ—ã€æŸ¥è¯¢æ¡ä»¶æ¶‰åŠå‡½æ•°è®¡ç®—ç­‰æƒ…å†µæ— æ³•ä½¿ç”¨ç´¢å¼•ã€‚æ­¤å¤–ï¼Œå³ä½¿SQLæœ¬èº«ç¬¦åˆç´¢å¼•çš„ä½¿ç”¨æ¡ä»¶ï¼ŒMySQLä¹Ÿä¼šé€šè¿‡è¯„ä¼°å„ç§æŸ¥è¯¢æ–¹å¼çš„ä»£ä»·ï¼Œæ¥å†³å®šæ˜¯å¦èµ°ç´¢å¼•ï¼Œä»¥åŠèµ°å“ªä¸ªç´¢å¼•ã€‚</p><p>å› æ­¤ï¼Œåœ¨å°è¯•é€šè¿‡ç´¢å¼•è¿›è¡ŒSQLæ€§èƒ½ä¼˜åŒ–çš„æ—¶å€™ï¼ŒåŠ¡å¿…é€šè¿‡æ‰§è¡Œè®¡åˆ’æˆ–å®é™…çš„æ•ˆæœæ¥ç¡®è®¤ç´¢å¼•æ˜¯å¦èƒ½æœ‰æ•ˆæ”¹å–„æ€§èƒ½é—®é¢˜ï¼Œå¦åˆ™å¢åŠ äº†ç´¢å¼•ä¸ä½†æ²¡è§£å†³æ€§èƒ½é—®é¢˜ï¼Œè¿˜å¢åŠ äº†æ•°æ®åº“å¢åˆ æ”¹çš„è´Ÿæ‹…ã€‚å¦‚æœå¯¹EXPLAINç»™å‡ºçš„æ‰§è¡Œè®¡åˆ’æœ‰ç–‘é—®çš„è¯ï¼Œä½ è¿˜å¯ä»¥åˆ©ç”¨optimizer_traceæŸ¥çœ‹è¯¦ç»†çš„æ‰§è¡Œè®¡åˆ’åšè¿›ä¸€æ­¥åˆ†æã€‚</p><p>ä»Šå¤©ç”¨åˆ°çš„ä»£ç ï¼Œæˆ‘éƒ½æ”¾åœ¨äº†GitHubä¸Šï¼Œä½ å¯ä»¥ç‚¹å‡»<a href=\"https://github.com/JosephZhu1983/java-common-mistakes\">è¿™ä¸ªé“¾æ¥</a>æŸ¥çœ‹ã€‚</p><h2>æ€è€ƒä¸è®¨è®º</h2><ol>\n<li>åœ¨ä»‹ç»äºŒçº§ç´¢å¼•ä»£ä»·æ—¶ï¼Œæˆ‘ä»¬é€šè¿‡EXPLAINå‘½ä»¤çœ‹åˆ°äº†ç´¢å¼•è¦†ç›–å’Œå›è¡¨çš„ä¸¤ç§æƒ…å†µã€‚ä½ èƒ½ç”¨optimizer traceæ¥åˆ†æä¸€ä¸‹è¿™ä¸¤ç§æƒ…å†µçš„æˆæœ¬å·®å¼‚å—ï¼Ÿ</li>\n<li>ç´¢å¼•é™¤äº†å¯ä»¥ç”¨äºåŠ é€Ÿæœç´¢å¤–ï¼Œè¿˜å¯ä»¥åœ¨æ’åºæ—¶å‘æŒ¥ä½œç”¨ï¼Œä½ èƒ½é€šè¿‡EXPLAINæ¥è¯æ˜å—ï¼Ÿä½ çŸ¥é“ï¼Œåœ¨ä»€ä¹ˆæƒ…å†µä¸‹é’ˆå¯¹æ’åºç´¢å¼•ä¼šå¤±æ•ˆå—ï¼Ÿ</li>\n</ol><p>é’ˆå¯¹æ•°æ®åº“ç´¢å¼•ï¼Œä½ è¿˜æœ‰ä»€ä¹ˆå¿ƒå¾—å—ï¼Ÿæˆ‘æ˜¯æœ±æ™”ï¼Œæ¬¢è¿åœ¨è¯„è®ºåŒºä¸æˆ‘ç•™è¨€åˆ†äº«ï¼Œä¹Ÿæ¬¢è¿ä½ æŠŠè¿™ç¯‡æ–‡ç« åˆ†äº«ç»™ä½ çš„æœ‹å‹æˆ–åŒäº‹ï¼Œä¸€èµ·äº¤æµã€‚</p>","comments":[{"had_liked":false,"id":194146,"user_name":"Darren","can_delete":false,"product_type":"c1","uid":1254968,"ip_address":"","ucode":"CCD2B2C492BE9A","user_header":"https://static001.geekbang.org/account/avatar/00/13/26/38/ef063dc2.jpg","comment_is_top":true,"comment_ctime":1585030909,"is_pvip":true,"replies":[{"id":"73958","content":"ğŸ‘ğŸ»","user_name":"ä½œè€…å›å¤","comment_id":194146,"uid":"1001470","ip_address":"","utype":1,"ctime":1585034197,"user_name_real":"æœ±æ™”"}],"discussion_count":7,"race_medal":0,"score":"9.223372364857301e+18","product_id":100047701,"comment_content":"ç¬¬ä¸€ä¸ªé—®é¢˜ï¼š<br>è¦†ç›–ç´¢å¼•çš„costæ˜¯1.21è€Œå›è¡¨çš„æ˜¯2.21<br>è¦†ç›–ç´¢å¼•ï¼š<br>analyzing_range_alternatives&quot;: {<br>                    &quot;range_scan_alternatives&quot;: [<br>                      {<br>                        &quot;index&quot;: &quot;name_score&quot;,<br>                        &quot;ranges&quot;: [<br>                          &quot;name1 &lt;= name &lt;= name1&quot;<br>                        ] &#47;* ranges *&#47;,<br>                        &quot;index_dives_for_eq_ranges&quot;: true,<br>                        &quot;rowid_ordered&quot;: false,<br>                        &quot;using_mrr&quot;: false,<br>                        &quot;index_only&quot;: true,<br>                        &quot;rows&quot;: 1,<br>                        &quot;cost&quot;: 1.21,<br>                        &quot;chosen&quot;: true<br>                      }<br>                    ]<br>å›è¡¨ï¼š<br>&quot;range_scan_alternatives&quot;: [<br>                      {<br>                        &quot;index&quot;: &quot;name_score&quot;,<br>                        &quot;ranges&quot;: [<br>                          &quot;name1 &lt;= name &lt;= name1&quot;<br>                        ] &#47;* ranges *&#47;,<br>                        &quot;index_dives_for_eq_ranges&quot;: true,<br>                        &quot;rowid_ordered&quot;: false,<br>                        &quot;using_mrr&quot;: false,<br>                        &quot;index_only&quot;: false,<br>                        &quot;rows&quot;: 1,<br>                        &quot;cost&quot;: 2.21,<br>                        &quot;chosen&quot;: true<br>                      }<br>                    ]<br><br>ç¬¬äºŒä¸ªé—®é¢˜ï¼š<br>SQLä¸­å¸¦order byä¸”æ‰§è¡Œè®¡åˆ’ä¸­Extra è¿™ä¸ªå­—æ®µä¸­æœ‰&quot;Using index&quot;æˆ–è€…&quot;Using index condition&quot;è¡¨ç¤ºç”¨åˆ°ç´¢å¼•ï¼Œå¹¶ä¸”ä¸ç”¨ä¸“é—¨æ’åºï¼Œå› ä¸ºç´¢å¼•æœ¬èº«å°±æ˜¯æœ‰åºçš„ï¼›<br>å¦‚æœExtraæœ‰â€œUsing filesortâ€è¡¨ç¤ºçš„å°±æ˜¯éœ€è¦æ’åºï¼›<br><br>æ’åºæ—¶ï¼šMySQL ä¼šç»™æ¯ä¸ªçº¿ç¨‹åˆ†é…ä¸€å—å†…å­˜ç”¨äºæ’åºï¼Œç§°ä¸º sort_bufferã€‚sort_buffer_sizeï¼ˆsort_bufferï¼‰çš„å¤§å°ã€‚å¦‚æœè¦æ’åºçš„æ•°æ®é‡å°äº sort_buffer_sizeï¼Œæ’åºå°±åœ¨å†…å­˜ä¸­å®Œæˆã€‚ä½†å¦‚æœæ’åºæ•°æ®é‡å¤ªå¤§ï¼Œå†…å­˜æ”¾ä¸ä¸‹ï¼Œåˆ™ä¸å¾—ä¸åˆ©ç”¨ç£ç›˜ä¸´æ—¶æ–‡ä»¶è¾…åŠ©æ’åºã€‚<br>ä¸Šè¿°æ’åºä¸­ï¼Œåªå¯¹åŸè¡¨çš„æ•°æ®è¯»äº†ä¸€éï¼Œå‰©ä¸‹çš„æ“ä½œéƒ½æ˜¯åœ¨ sort_buffer å’Œä¸´æ—¶æ–‡ä»¶ä¸­æ‰§è¡Œçš„ã€‚ä½†è¿™ä¸ªç®—æ³•æœ‰ä¸€ä¸ªé—®é¢˜ï¼Œå°±æ˜¯å¦‚æœæŸ¥è¯¢è¦è¿”å›çš„å­—æ®µå¾ˆå¤šçš„è¯ï¼Œé‚£ä¹ˆ sort_buffer é‡Œé¢è¦æ”¾çš„å­—æ®µæ•°å¤ªå¤šï¼Œè¿™æ ·å†…å­˜é‡Œèƒ½å¤ŸåŒæ—¶æ”¾ä¸‹çš„è¡Œæ•°å¾ˆå°‘ï¼Œè¦åˆ†æˆå¾ˆå¤šä¸ªä¸´æ—¶æ–‡ä»¶ï¼Œæ’åºçš„æ€§èƒ½ä¼šå¾ˆå·®ã€‚æ‰€ä»¥å¦‚æœå•è¡Œå¾ˆå¤§ï¼Œè¿™ä¸ªæ–¹æ³•æ•ˆç‡ä¸å¤Ÿå¥½ã€‚max_length_for_sort_dataï¼Œæ˜¯ MySQL ä¸­ä¸“é—¨æ§åˆ¶ç”¨äºæ’åºçš„è¡Œæ•°æ®çš„é•¿åº¦çš„ä¸€ä¸ªå‚æ•°ã€‚å®ƒçš„æ„æ€æ˜¯ï¼Œå¦‚æœå•è¡Œçš„é•¿åº¦è¶…è¿‡è¿™ä¸ªå€¼ï¼ŒMySQL å°±è®¤ä¸ºå•è¡Œå¤ªå¤§ï¼Œè¦æ¢ä¸€ä¸ªç®—æ³•ã€‚ç§°ä¸º rowid æ’åºï¼›<br>rowidæ’åºç®€å•çš„æè¿°å°±æ˜¯å…ˆå–å‡ºIDå’Œæ’åºå­—æ®µè¿›è¡Œæ’åºï¼Œæ’åºç»“æŸåï¼Œç”¨IDå›è¡¨å»æŸ¥è¯¢selectä¸­å‡ºç°çš„å…¶ä»–å­—æ®µï¼Œå¤šäº†ä¸€æ¬¡å›è¡¨æ“ä½œï¼Œ<br>å¯¹äº InnoDB è¡¨æ¥è¯´ï¼Œrowid æ’åºä¼šè¦æ±‚å›è¡¨å¤šé€ æˆç£ç›˜è¯»ï¼Œå› æ­¤ä¸ä¼šè¢«ä¼˜å…ˆé€‰æ‹©ã€‚","like_count":77,"discussions":[{"author":{"id":1001470,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/47/fe/d0e25d57.jpg","nickname":"æœ±æ™”","note":"","ucode":"0B7F0BADE6AAB8","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":488770,"discussion_content":"ğŸ‘ğŸ»","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1585034197,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1968721,"avatar":"http://thirdwx.qlogo.cn/mmopen/vi_32/unkzY52hVDjTmZJGNkrBR75tFs4XTGBoYYcOYkIcPvHlQrLibwc94aBfj1uWiawoKeEMwHbkvgThXZarfoP8Dzag/132","nickname":"å¥¹","note":"","ucode":"FAC6851866C9C7","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":406587,"discussion_content":"éš¾é“æ˜¯ ã€ŠMySQL 45è®²ã€‹å­¦å‹ï¼Ÿ","likes_number":3,"is_delete":false,"is_hidden":false,"ctime":1634800167,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1811277,"avatar":"https://static001.geekbang.org/account/avatar/00/1b/a3/4d/59390ba9.jpg","nickname":"æ’éª¨","note":"","ucode":"A413CF46211E1F","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":549134,"discussion_content":"çœŸçš„ä¸“ä¸š","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1643604635,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1324501,"avatar":"https://static001.geekbang.org/account/avatar/00/14/35/d5/17833946.jpg","nickname":"å…«å®","note":"","ucode":"89D991A930FDEA","race_medal":1,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":406859,"discussion_content":"Mark","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1634861215,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1074491,"avatar":"https://static001.geekbang.org/account/avatar/00/10/65/3b/c1c6b16a.jpg","nickname":"Alex","note":"","ucode":"20BA92E4F914D2","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":385599,"discussion_content":"mark","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1627151665,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1306032,"avatar":"http://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTJcxSpNMqwqyicMvdOSr9ic0p1ABiauHnv7g7YQVSJuoHPoQbYDu3YzdpgmSAk2KricUBQ5yibWBWIq75w/132","nickname":"æ¡‚åŸè€æ‰˜å°¼","note":"","ucode":"139E4B8EE88B79","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":367701,"discussion_content":"å¾ˆè¯¦ç»†","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1618445910,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1297723,"avatar":"http://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTKPuKKjuhiaOGQ8kfMmEnMkQAwdZib5NI3EQzn9lAU0ewX8msoqt36T2k7Z9Sh1JUUDCCn6jwBTvgHA/132","nickname":"äº","note":"","ucode":"46D459C025D30B","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":217179,"discussion_content":"æ„Ÿè§‰å¾ˆä¸“ä¸šï¼Œå­¦ä¹ äº†","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1585525978,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":194178,"user_name":"Darren","can_delete":false,"product_type":"c1","uid":1254968,"ip_address":"","ucode":"CCD2B2C492BE9A","user_header":"https://static001.geekbang.org/account/avatar/00/13/26/38/ef063dc2.jpg","comment_is_top":false,"comment_ctime":1585033864,"is_pvip":true,"replies":[{"id":"73960","content":"æ„Ÿè°¢åˆ†äº«","user_name":"ä½œè€…å›å¤","comment_id":194178,"uid":"1001470","ip_address":"","utype":1,"ctime":1585035559,"user_name_real":"æœ±æ™”"}],"discussion_count":2,"race_medal":0,"score":"194858562184","product_id":100047701,"comment_content":"å¦å¤–åˆ†äº«ä¸‹ä¹‹å‰åœ¨å…¬å¸åˆ†äº«çš„MySQLç›¸å…³çš„PPTï¼Œä¸»è¦ä»MySQLæ•´ä½“æ¶æ„ï¼Œå¼•æ“ã€ç´¢å¼•ã€é”å’ŒMVCCè¿™åŠéƒ¨åˆ†åˆ†äº«çš„ï¼Œæ„Ÿå…´è¶£çš„åŒå­¦å¯ä»¥çœ‹çœ‹ï¼Œç„¶åå¤§å®¶äº¤æµäº¤æµã€‚<br><br>https:&#47;&#47;github.com&#47;y645194203&#47;geektime-java-100&#47;blob&#47;master&#47;MySQL-%E5%88%86%E4%BA%AB%E4%BA%A4%E6%B5%81%E7%9A%84%E5%89%AF%E6%9C%AC.pptx","like_count":46,"discussions":[{"author":{"id":1001470,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/47/fe/d0e25d57.jpg","nickname":"æœ±æ™”","note":"","ucode":"0B7F0BADE6AAB8","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":488776,"discussion_content":"æ„Ÿè°¢åˆ†äº«","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1585035559,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1062848,"avatar":"http://thirdwx.qlogo.cn/mmopen/vi_32/DYAIOgq83ersGSic8ib7OguJv6CJiaXY0s4n9C7Z51sWxTTljklFpq3ZAIWXoFTPV5oLo0GMTkqW5sYJRRnibNqOJQ/132","nickname":"walleæ–Œ","note":"","ucode":"0DB3243004951F","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":382237,"discussion_content":"æ‰«äº†çœ¼ã€‚ã€‚ã€‚å›§ éš”å£ ä¸å¥‡è€å¸ˆmysql 45è®² æ‘˜è¦ã€‚ã€‚æœŸå¾…èƒ½ è§¦ç±»æ—é€šè®²ç‚¹åˆ«çš„ã€‚ã€‚ä¹ˆæœ‰ã€‚ã€‚ä¾‹å¦‚å­˜å‚¨çš„åœ°æ–¹ ç±»æ¯”ä¸‹å¸¸è§çš„mq æ–‡ä»¶å­˜å‚¨ï¼Œæˆ–è€… redisçš„å­˜å‚¨ é’ˆå¯¹ä¸åŒåœºæ™¯å¤§å®¶å’‹ç©çš„ï¼Œæœ‰å•¥å¼‚åŒç‚¹ã€‚ã€‚é¢ã€‚ã€‚","likes_number":2,"is_delete":false,"is_hidden":false,"ctime":1625483331,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":194880,"user_name":"è¢å¸…","can_delete":false,"product_type":"c1","uid":1084993,"ip_address":"","ucode":"A71A89B9F1BD69","user_header":"https://static001.geekbang.org/account/avatar/00/10/8e/41/709e9677.jpg","comment_is_top":false,"comment_ctime":1585114537,"is_pvip":true,"replies":[{"id":"74105","content":"è§‰å¾—å¥½å¯ä»¥å¤šåˆ†äº«","user_name":"ä½œè€…å›å¤","comment_id":194880,"uid":"1001470","ip_address":"","utype":1,"ctime":1585115446,"user_name_real":"æœ±æ™”"}],"discussion_count":1,"race_medal":0,"score":"53124722089","product_id":100047701,"comment_content":"è€å¸ˆçš„æ–‡ç« çœŸçš„æ˜¯å¤ªç”¨å¿ƒäº†ï¼Œè®²çš„å¤ªå¥½äº†ï¼ŒèµğŸ‘","like_count":12,"discussions":[{"author":{"id":1001470,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/47/fe/d0e25d57.jpg","nickname":"æœ±æ™”","note":"","ucode":"0B7F0BADE6AAB8","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":488918,"discussion_content":"è§‰å¾—å¥½å¯ä»¥å¤šåˆ†äº«","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1585115446,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":194187,"user_name":"ğŸ‘½","can_delete":false,"product_type":"c1","uid":1274117,"ip_address":"","ucode":"D313AF941B412D","user_header":"https://static001.geekbang.org/account/avatar/00/13/71/05/db554eba.jpg","comment_is_top":false,"comment_ctime":1585035502,"is_pvip":false,"replies":[{"id":"73962","content":"æ€»ç»“çš„ä¸é”™","user_name":"ä½œè€…å›å¤","comment_id":194187,"uid":"1001470","ip_address":"","utype":1,"ctime":1585035637,"user_name_real":"æœ±æ™”"}],"discussion_count":1,"race_medal":0,"score":"48829675758","product_id":100047701,"comment_content":"è¿‡æ—©çš„ä¼˜åŒ–ï¼Œæ˜¯ä¸‡æ¶ä¹‹æºã€‚ä¸éœ€è¦æå‰è€ƒè™‘å»ºç«‹ç´¢å¼•ã€‚ç­‰æ€§èƒ½å‡ºç°é—®é¢˜ï¼ŒçœŸæ­£çš„éœ€æ±‚é™ä¸´çš„æ—¶å€™å†è€ƒè™‘ä¼˜åŒ–ã€‚<br>å»ºç«‹ç´¢å¼•ä¹‹å‰ï¼Œéœ€è¦è€ƒè™‘ç´¢å¼•å¸¦æ¥çš„å‰¯ä½œç”¨ï¼šç»´æŠ¤æˆæœ¬ï¼Œç©ºé—´æˆæœ¬ï¼Œå›è¡¨æˆæœ¬ã€‚<br>æ›´é‡è¦çš„æ˜¯è¿˜è¦è€ƒè™‘ï¼Œä½ çš„æŸ¥è¯¢æ˜¯å¦èƒ½ç”¨åˆ°ç´¢å¼•ã€‚å¦‚æœèŠ±è´¹å¤§é‡æˆæœ¬å»ºç«‹çš„ç´¢å¼•ï¼Œæœ€åè¿˜ç”¨ä¸ä¸Šã€‚é‚£å°±èµ”äº†å¤«äººåˆæŠ˜å…µäº†ã€‚<br>ç´¢å¼•åˆç‰µæ‰¯åˆ°äº†å¾ˆå¤šæ³¨æ„äº‹é¡¹ï¼Œä¾‹å¦‚ï¼šå°½é‡ä½¿ç”¨å‰ç¼€åŒ¹é…ï¼Œè€Œé¿å…ä½¿ç”¨åç¼€åŒ¹é…ã€‚å› ä¸ºåç¼€åŒ¹é…ä¼šä½¿å¾—ç´¢å¼•å¤±æ•ˆï¼Œèµ°å…¨è¡¨åŒ¹é…ã€‚","like_count":12,"discussions":[{"author":{"id":1001470,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/47/fe/d0e25d57.jpg","nickname":"æœ±æ™”","note":"","ucode":"0B7F0BADE6AAB8","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":488777,"discussion_content":"æ€»ç»“çš„ä¸é”™","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1585035637,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":223367,"user_name":"é©¬ä»¥","can_delete":false,"product_type":"c1","uid":1344431,"ip_address":"","ucode":"3FEA06CA14DE28","user_header":"https://static001.geekbang.org/account/avatar/00/14/83/af/1cb42cd3.jpg","comment_is_top":false,"comment_ctime":1591074311,"is_pvip":false,"replies":[{"id":"82305","content":"å¯ä»¥è¿›ä¸€æ­¥é˜…è¯»MySQLå®æˆ˜45è®²ä¸“æ æ¥äº†è§£ç›¸å…³å†…å®¹ï¼Œæ¯”å¦‚ï¼š<br>09 | æ™®é€šç´¢å¼•å’Œå”¯ä¸€ç´¢å¼•ï¼Œåº”è¯¥æ€ä¹ˆé€‰æ‹©ï¼Ÿ<br>10 | MySQLä¸ºä»€ä¹ˆæœ‰æ—¶å€™ä¼šé€‰é”™ç´¢å¼•ï¼Ÿ","user_name":"ä½œè€…å›å¤","comment_id":223367,"uid":"1001470","ip_address":"","utype":1,"ctime":1591075228,"user_name_real":"æœ±æ™”"}],"discussion_count":3,"race_medal":0,"score":"35950812679","product_id":100047701,"comment_content":"è€å¸ˆè¿™é‡Œè®²çš„æŸ¥è¯¢ä¼˜åŒ–å™¨é€‰æ‹©æµç¨‹è¯¦ç»†ä¸€äº›ï¼Œå¯å¦åŠ ä¸ªé¤ï¼Œè¯´ä¸€è¯´æ™®é€šç´¢å¼•å’Œå”¯ä¸€ç´¢å¼•åœ¨ä»€ä¹ˆä¸šåŠ¡åœºæ™¯ä¸‹ä½¿ç”¨ï¼Ÿ","like_count":7,"discussions":[{"author":{"id":1001470,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/47/fe/d0e25d57.jpg","nickname":"æœ±æ™”","note":"","ucode":"0B7F0BADE6AAB8","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":497109,"discussion_content":"å¯ä»¥è¿›ä¸€æ­¥é˜…è¯»MySQLå®æˆ˜45è®²ä¸“æ æ¥äº†è§£ç›¸å…³å†…å®¹ï¼Œæ¯”å¦‚ï¼š\n09 | æ™®é€šç´¢å¼•å’Œå”¯ä¸€ç´¢å¼•ï¼Œåº”è¯¥æ€ä¹ˆé€‰æ‹©ï¼Ÿ\n10 | MySQLä¸ºä»€ä¹ˆæœ‰æ—¶å€™ä¼šé€‰é”™ç´¢å¼•ï¼Ÿ","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1591075228,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1877862,"avatar":"http://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTLu3MgZBAyyiavX2CMF2KRib791j3bBGiaQDzuQwBF2k6AKHANV2uTAAss2vVaeC7xcSYYD8vjmibRpTQ/132","nickname":"çºµä¸æœ½","note":"","ucode":"DB2CA2C46B2EF1","race_medal":0,"user_type":1,"is_pvip":true},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":401886,"discussion_content":"è€å¸ˆå¹³å¸¸æ˜¯ä¸æ˜¯ä¹Ÿä¼šä¹°å…¶ä»–ä¸“æ æ¥çœ‹ï¼Ÿï¼Œ(â†’_â†’)","likes_number":2,"is_delete":false,"is_hidden":false,"ctime":1633758982,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":2014573,"avatar":"https://static001.geekbang.org/account/avatar/00/1e/bd/6d/7010f98e.jpg","nickname":"SharpBB","note":"","ucode":"D30C5B798B8E8C","race_medal":0,"user_type":1,"is_pvip":true},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":555599,"discussion_content":"ä¸€èˆ¬æ¥è®²æ— è„‘ç”¨æ™®é€šç´¢å¼•å°±å¥½äº†  å”¯ä¸€ç´¢å¼•æœ‰æ£€æŸ¥å”¯ä¸€æ€§çš„å¼€é”€","likes_number":1,"is_delete":false,"is_hidden":false,"ctime":1646985495,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":194220,"user_name":"æ±æ—å¤–å²","can_delete":false,"product_type":"c1","uid":1188906,"ip_address":"","ucode":"3C66C0F0537A99","user_header":"https://static001.geekbang.org/account/avatar/00/12/24/2a/33441e2b.jpg","comment_is_top":false,"comment_ctime":1585038515,"is_pvip":false,"replies":[{"id":"73980","content":"èšç°‡ç´¢å¼•çš„è§„åˆ™æ˜¯ï¼š<br><br>When you define a PRIMARY KEY on your table, InnoDB uses it as the clustered index. Define a primary key for each table that you create. If there is no logical unique and non-null column or set of columns, add a new auto-increment column, whose values are filled in automatically.<br><br>If you do not define a PRIMARY KEY for your table, MySQL locates the first UNIQUE index where all the key columns are NOT NULL and InnoDB uses it as the clustered index.<br><br>If the table has no PRIMARY KEY or suitable UNIQUE index, InnoDB internally generates a hidden clustered index named GEN_CLUST_INDEX on a synthetic column containing row ID values. The rows are ordered by the ID that InnoDB assigns to the rows in such a table. The row ID is a 6-byte field that increases monotonically as new rows are inserted. Thus, the rows ordered by the row ID are physically in insertion order.<br><br>å› ä¸ºè¿™äº›å¤ªç»†èŠ‚çš„ä¸œè¥¿å’Œå‘ç‚¹æ²¡æœ‰å¤ªå¤šå…³ç³»ï¼Œä¸ºäº†èŠ‚çœç¯‡å¹…å°±ä¸å±•å¼€è¯´äº†ã€‚<br><br>æ˜¯çš„ï¼Œå½“ä½ è¯»ä¸€äº›æ–‡ç« çš„æ—¶å€™å‘ç°99%çš„çŸ¥è¯†ç‚¹è‡ªå·±éƒ½çŸ¥é“ï¼Œå®Œå…¨æ˜¯å¤ä¹ ä¸€éçš„æ„Ÿè§‰ï¼Œè¿™ç§å¥‘åˆçš„æ„Ÿè§‰å¾ˆèˆ’æœ","user_name":"ä½œè€…å›å¤","comment_id":194220,"uid":"1001470","ip_address":"","utype":1,"ctime":1585042040,"user_name_real":"æœ±æ™”"}],"discussion_count":1,"race_medal":0,"score":"18764907699","product_id":100047701,"comment_content":"å¦‚æœæ²¡æœ‰ä¸»é”®ï¼Œå°±é€‰æ‹©ç¬¬ä¸€ä¸ªä¸åŒ…å« NULL å€¼çš„å”¯ä¸€åˆ—ã€‚<br>æ²¡æœ‰ä¸»é”®çš„è¯ï¼Œmysqlä¸æ˜¯ä¼šä¸ºæ¯è¡Œæ•°æ®é»˜è®¤ç”Ÿæˆä¸€ä¸ªrowidå­—æ®µä½œä¸ºä¸»é”®å—ï¼Ÿï¼Ÿ<br><br>æ’åºç´¢å¼•å¤±æ•ˆåº”è¯¥ä¹Ÿæ˜¯å¯¹ç´¢å¼•åšäº†ä¸€äº›å‡½æ•°æ“ä½œã€‚<br><br>ç ”è¯»è¿‡mysqlçš„ä¸“æ ï¼Œæ‰€ä»¥è¿™ä¸€èŠ‚æ„Ÿè§‰çš„çŸ¥è¯†æ„Ÿè§‰éƒ½äº†è§£ï¼Œä¸è¿‡è¿™ç§æ„Ÿè§‰è¿˜æ˜¯å¾ˆçˆ½çš„ï¼ŒæœŸå¾…è€å¸ˆæ›´å¤šçš„å¹²è´§ã€‚","like_count":5,"discussions":[{"author":{"id":1001470,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/47/fe/d0e25d57.jpg","nickname":"æœ±æ™”","note":"","ucode":"0B7F0BADE6AAB8","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":488786,"discussion_content":"èšç°‡ç´¢å¼•çš„è§„åˆ™æ˜¯ï¼š\n\nWhen you define a PRIMARY KEY on your table, InnoDB uses it as the clustered index. Define a primary key for each table that you create. If there is no logical unique and non-null column or set of columns, add a new auto-increment column, whose values are filled in automatically.\n\nIf you do not define a PRIMARY KEY for your table, MySQL locates the first UNIQUE index where all the key columns are NOT NULL and InnoDB uses it as the clustered index.\n\nIf the table has no PRIMARY KEY or suitable UNIQUE index, InnoDB internally generates a hidden clustered index named GEN_CLUST_INDEX on a synthetic column containing row ID values. The rows are ordered by the ID that InnoDB assigns to the rows in such a table. The row ID is a 6-byte field that increases monotonically as new rows are inserted. Thus, the rows ordered by the row ID are physically in insertion order.\n\nå› ä¸ºè¿™äº›å¤ªç»†èŠ‚çš„ä¸œè¥¿å’Œå‘ç‚¹æ²¡æœ‰å¤ªå¤šå…³ç³»ï¼Œä¸ºäº†èŠ‚çœç¯‡å¹…å°±ä¸å±•å¼€è¯´äº†ã€‚\n\næ˜¯çš„ï¼Œå½“ä½ è¯»ä¸€äº›æ–‡ç« çš„æ—¶å€™å‘ç°99%çš„çŸ¥è¯†ç‚¹è‡ªå·±éƒ½çŸ¥é“ï¼Œå®Œå…¨æ˜¯å¤ä¹ ä¸€éçš„æ„Ÿè§‰ï¼Œè¿™ç§å¥‘åˆçš„æ„Ÿè§‰å¾ˆèˆ’æœ","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1585042040,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":194014,"user_name":"pedro","can_delete":false,"product_type":"c1","uid":1200704,"ip_address":"","ucode":"F40C839DDFD599","user_header":"https://static001.geekbang.org/account/avatar/00/12/52/40/e57a736e.jpg","comment_is_top":false,"comment_ctime":1585015020,"is_pvip":false,"replies":[{"id":"73886","content":"select *ï¼Œä½ selectä»…ä»…æ˜¯ç´¢å¼•åˆ—ï¼Œé‚£ä¹ˆèµ°ç´¢å¼•æ›´åˆ’ç®—äº†","user_name":"ä½œè€…å›å¤","comment_id":194014,"uid":"1001470","ip_address":"","utype":1,"ctime":1585018724,"user_name_real":"æœ±æ™”"}],"discussion_count":1,"race_medal":0,"score":"18764884204","product_id":100047701,"comment_content":"ç¬¬äºŒä¸ªé—®é¢˜ï¼Œæˆ‘ä½¿ç”¨ EXPLAIN SELECT create_time from person ORDER BY create_time LIMIT 10; è¯­å¥ï¼Œåˆ†æè¯¥ SQLï¼Œç»“æœæœç„¶æ˜¯ type = indexï¼ŒExtra = using indexï¼Œè¯æ˜æ’åºèµ°äº†ç´¢å¼•å¹¶ä¸”æ˜¯ç´¢å¼•è¦†ç›–æ²¡æœ‰å›è¡¨ï¼›æˆ‘æœ¬ä»¥ä¸ºåŠ ä¸Šå‡½æ•°å°±å¯ä»¥ä½¿ç´¢å¼•å¤±æ•ˆï¼Œäºæ˜¯åˆ†åˆ«ä½¿ç”¨äº† ORDER BY YEAR(create_time) å’Œ ORDER BY  substring(create_time,1,3)ï¼Œå‘ç° type è¿˜æ˜¯ indexï¼Œæˆ‘çš„æ•°æ®åº“ç‰ˆæœ¬æ˜¯8.0ï¼Œè¯·é—®è€å¸ˆï¼Œæœ‰ä»€ä¹ˆæ–¹å¼å¯ä»¥è®©ç´¢å¼•å¤±æ•ˆå‘¢ï¼Ÿ","like_count":4,"discussions":[{"author":{"id":1001470,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/47/fe/d0e25d57.jpg","nickname":"æœ±æ™”","note":"","ucode":"0B7F0BADE6AAB8","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":488729,"discussion_content":"select *ï¼Œä½ selectä»…ä»…æ˜¯ç´¢å¼•åˆ—ï¼Œé‚£ä¹ˆèµ°ç´¢å¼•æ›´åˆ’ç®—äº†","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1585018724,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":206031,"user_name":"è¯·å«æˆ‘å’Œå°š","can_delete":false,"product_type":"c1","uid":1703256,"ip_address":"","ucode":"33A8A1CDA103F9","user_header":"https://static001.geekbang.org/account/avatar/00/19/fd/58/1af629c7.jpg","comment_is_top":false,"comment_ctime":1586776259,"is_pvip":false,"discussion_count":0,"race_medal":1,"score":"14471678147","product_id":100047701,"comment_content":"è¿™ä¸€ç¯‡æ–‡ç« ï¼Œæˆ‘æ„Ÿè§‰å“ªé‡Œéƒ½æ˜¯é‡ç‚¹ï¼Œå“ˆå“ˆå“ˆå“ˆ","like_count":4},{"had_liked":false,"id":194672,"user_name":"æµ·æˆ˜","can_delete":false,"product_type":"c1","uid":1232690,"ip_address":"","ucode":"309FF034BA2E91","user_header":"https://static001.geekbang.org/account/avatar/00/12/cf/32/fd71af86.jpg","comment_is_top":false,"comment_ctime":1585096796,"is_pvip":false,"replies":[{"id":"74085","content":"æ–‡ä¸­å›è¡¨æ˜¯æŒ‡äºŒçº§ç´¢å¼•æŸ¥è¯¢åå›èšç°‡ç´¢å¼•ï¼Œè¿™ä¸ªå’Œjpaæ²¡ä»€ä¹ˆå…³ç³»","user_name":"ä½œè€…å›å¤","comment_id":194672,"uid":"1001470","ip_address":"","utype":1,"ctime":1585103269,"user_name_real":"æœ±æ™”"}],"discussion_count":2,"race_medal":0,"score":"14469998684","product_id":100047701,"comment_content":"åˆ©ç”¨jpa å®ŒæˆæŸ¥è¯¢ï¼Œæ˜¯ä¸æ˜¯éƒ½ä¼šå‘ç”Ÿå›è¡¨å‘€ï¼Œä¸çŸ¥é“ä¼šä¸ä¼šäº§ç”Ÿå½±å“","like_count":3,"discussions":[{"author":{"id":1001470,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/47/fe/d0e25d57.jpg","nickname":"æœ±æ™”","note":"","ucode":"0B7F0BADE6AAB8","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":488869,"discussion_content":"æ–‡ä¸­å›è¡¨æ˜¯æŒ‡äºŒçº§ç´¢å¼•æŸ¥è¯¢åå›èšç°‡ç´¢å¼•ï¼Œè¿™ä¸ªå’Œjpaæ²¡ä»€ä¹ˆå…³ç³»","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1585103269,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1232690,"avatar":"https://static001.geekbang.org/account/avatar/00/12/cf/32/fd71af86.jpg","nickname":"æµ·æˆ˜","note":"","ucode":"309FF034BA2E91","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":213541,"discussion_content":"å“¦ï¼Œæ˜¯æƒ³å¤šäº† ","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1585103435,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":276545,"user_name":"ä¸‰åˆ†ä¹‹äºŒ","can_delete":false,"product_type":"c1","uid":2224364,"ip_address":"","ucode":"1756803F29AAA2","user_header":"https://thirdwx.qlogo.cn/mmopen/vi_32/OrfXQWvE0jIuibibw0dnicPM02gKia0iaBHYMF6RgEDX1kjlKjOf2f36PXe8h0HtrgUGibcP4l6ndcRqlAHUYSNYe2dA/132","comment_is_top":false,"comment_ctime":1611996968,"is_pvip":false,"discussion_count":1,"race_medal":0,"score":"10201931560","product_id":100047701,"comment_content":"å†ä½¿ç”¨äºŒåˆ†æœç´¢å‡º #3 æ§½å’Œ #6 æ§½çš„ä¸­é—´ä½æ˜¯ (3+6)&#47;2=4.5 å–æ•´ 4ï¼Œ#4 æ§½å¯¹åº”çš„è®°å½•æ˜¯ 16ï¼15ï¼Œæ‰€ä»¥è®°å½•ä¸€å®šåœ¨ #4 æ§½ä¸­ï¼›<br>ã€æ‰€ä»¥è®°å½•ä¸€å®šåœ¨ #4 æ§½ä¸­ï¼›ã€‘è¿™é‡Œåº”è¯¥æ˜¯#3æ§½ã€‚","like_count":2,"discussions":[{"author":{"id":2023634,"avatar":"","nickname":"ç§¦æ™¨æ™®","note":"","ucode":"6C5474313FB039","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":550811,"discussion_content":"æ˜¯#4æ§½ã€‚æˆ‘æœ¬æ¥ä¹Ÿæ²¡ç†è§£ï¼Œåæ¥çœ‹äº†ä½œè€…å›å¤ï¼ŒåˆæŸ¥äº†ä¸€ä¸‹ï¼Œå‘ç°è¿™é‡Œæœ‰ä¸€äº›ç»†èŠ‚ä½œè€…æ²¡å®Œå…¨è®²æ¸…æ¥šã€‚\n1. æœ€å°è®°å½•æ‰€åœ¨åˆ†ç»„åªèƒ½æœ‰ 1 æ¡è®°å½•ï¼Œå³æœ€å°è®°å½•æœ¬èº«å ç”¨ä¸€ä¸ªæ§½ï¼›\n2. æ§½1åŒ…å«æœ‰pk=1-4å››æ¡è®°å½•ï¼Œpk=4å‰é¢çš„æ•°å­—4ä»£è¡¨æ§½#1ä¸­æœ‰4æ¡è®°å½•ï¼Œå¯¹åº”åœ°ï¼Œ#4ä¸­åŒ…å«çš„å…¶å®æ˜¯pk=12-16å››æ¡è®°å½•ï¼›\n3. æ•°æ®é¡µä¸­è¿›è¡ŒäºŒåˆ†æ³•æŸ¥æ‰¾æ—¶ï¼Œæ¯”è¾ƒçš„æ˜¯æ§½ä¸­ä¸»é”®å€¼æœ€å¤§çš„ä¸€æ¡è®°å½•ï¼Œç„¶åæœç´¢éœ€è¦ä»å‰ä¸€ä¸ªæ§½å¼€å§‹æœç´¢","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1644742932,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":195464,"user_name":"Geek_3b1096","can_delete":false,"product_type":"c1","uid":1549364,"ip_address":"","ucode":"A6BD92B79B3632","user_header":"","comment_is_top":false,"comment_ctime":1585189655,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"10175124247","product_id":100047701,"comment_content":"è®²è§£éå¸¸ç»†è‡´è°¢è°¢è€å¸ˆ","like_count":2},{"had_liked":false,"id":244533,"user_name":"å°èƒ¡å­","can_delete":false,"product_type":"c1","uid":1018182,"ip_address":"","ucode":"79FEC6400D25DA","user_header":"https://static001.geekbang.org/account/avatar/00/0f/89/46/0b7828a1.jpg","comment_is_top":false,"comment_ctime":1598573409,"is_pvip":false,"discussion_count":1,"race_medal":0,"score":"5893540705","product_id":100047701,"comment_content":"å°½é‡ä¸è¦åœ¨ SQL è¯­å¥ä¸­ SELECT *ï¼Œè€Œæ˜¯ SELECT å¿…è¦çš„å­—æ®µï¼Œå®é™…ä½¿ç”¨ä¸­èƒ½åšåˆ°å®åœ¨å¤ªå°‘äº†","like_count":1,"discussions":[{"author":{"id":2378309,"avatar":"https://static001.geekbang.org/account/avatar/00/24/4a/45/e048531a.jpg","nickname":"è¿ªç±³ä¹Œæ ¼æ–¯","note":"","ucode":"1D4393746DCBCE","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":340376,"discussion_content":"æ„Ÿè§‰åœ¨ä¸šåŠ¡ä¸­curdçš„æ—¶å€™å¤§éƒ¨åˆ†éƒ½æ˜¯selectå¿…è¦çš„å­—æ®µ,ä½†æ˜¯åœ¨ç›´æ¥è¿æ¥æ•°æ®åº“çœ‹æ•ˆæœçš„æ—¶å€™è¿˜æ˜¯*, å°¤å…¶æ˜¯ä¸çŸ¥é“åˆ°åº•å“ªä¸ªå­—æ®µçš„æ•°æ®å‡ºé—®é¢˜çš„æ—¶å€™.","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1609990209,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":211729,"user_name":"LiGâ„ï¸","can_delete":false,"product_type":"c1","uid":1357566,"ip_address":"","ucode":"0FE01F25ADD1F9","user_header":"https://static001.geekbang.org/account/avatar/00/14/b6/fe/c5d7f0dc.jpg","comment_is_top":false,"comment_ctime":1587999612,"is_pvip":false,"replies":[{"id":"78715","content":"ï¼šï¼‰","user_name":"ä½œè€…å›å¤","comment_id":211729,"uid":"1001470","ip_address":"","utype":1,"ctime":1588038612,"user_name_real":"æœ±æ™”"}],"discussion_count":1,"race_medal":0,"score":"5882966908","product_id":100047701,"comment_content":"è€å¸ˆå¥½ä¼˜ç§€ï¼Œè®²çš„éå¸¸é€å½»~è‡ªå·±è¿˜è¦è¦å®æ“ï¼ŒåŠ æ·±ç†è§£ï¼","like_count":1,"discussions":[{"author":{"id":1001470,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/47/fe/d0e25d57.jpg","nickname":"æœ±æ™”","note":"","ucode":"0B7F0BADE6AAB8","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":493347,"discussion_content":"ï¼šï¼‰","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1588038612,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":197503,"user_name":"hellojd","can_delete":false,"product_type":"c1","uid":1341697,"ip_address":"","ucode":"4E51807AE7E472","user_header":"https://static001.geekbang.org/account/avatar/00/14/79/01/e71510dc.jpg","comment_is_top":false,"comment_ctime":1585382277,"is_pvip":false,"replies":[{"id":"74604","content":"æ˜¯çš„","user_name":"ä½œè€…å›å¤","comment_id":197503,"uid":"1001470","ip_address":"","utype":1,"ctime":1585389127,"user_name_real":"æœ±æ™”"}],"discussion_count":1,"race_medal":0,"score":"5880349573","product_id":100047701,"comment_content":"æœ‰æ—¶å€™ä¸€ä¸ªè¡¨ç´¢å¼•å¤ªå¤šï¼Œä¹Ÿä¼šå¸¦æ¥æˆæœ¬","like_count":1,"discussions":[{"author":{"id":1001470,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/47/fe/d0e25d57.jpg","nickname":"æœ±æ™”","note":"","ucode":"0B7F0BADE6AAB8","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":489535,"discussion_content":"æ˜¯çš„","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1585389127,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":194028,"user_name":"pedro","can_delete":false,"product_type":"c1","uid":1200704,"ip_address":"","ucode":"F40C839DDFD599","user_header":"https://static001.geekbang.org/account/avatar/00/12/52/40/e57a736e.jpg","comment_is_top":false,"comment_ctime":1585016115,"is_pvip":false,"replies":[{"id":"73887","content":"æˆ‘è¿™è¾¹åšå®éªŒçš„ç»“æœåœ¨æºç çš„coveringindex.jpgä¸­å¯ä»¥çœ‹ä¸€ä¸‹","user_name":"ä½œè€…å›å¤","comment_id":194028,"uid":"1001470","ip_address":"","utype":1,"ctime":1585018844,"user_name_real":"æœ±æ™”"}],"discussion_count":1,"race_medal":0,"score":"5879983411","product_id":100047701,"comment_content":"ç¬¬ä¸€ä¸ªé—®é¢˜ï¼Œæˆ‘ä»”ç»†å¯¹æ¯”äº† optimizer trace ä¸‹çš„ç´¢å¼•è¦†ç›–å’Œå›è¡¨ï¼Œå‘ç°ç´¢å¼•è¦†ç›–çš„å¦‚ä¸‹é¡¹ï¼š<br>                    &quot;range_scan_alternatives&quot;: [<br>                      {<br>                        &quot;index&quot;: &quot;name_score&quot;,<br>                        &quot;ranges&quot;: [<br>                          &quot;name1 &lt;= name &lt;= name1&quot;<br>                        ],<br>                        &quot;index_dives_for_eq_ranges&quot;: true,<br>                        &quot;rowid_ordered&quot;: false,<br>                        &quot;using_mrr&quot;: false,<br>                        &quot;index_only&quot;: true,<br>                        &quot;rows&quot;: 1,<br>                        &quot;cost&quot;: 1.1056,<br>                        &quot;chosen&quot;: true<br>                      }<br>æˆ‘çŒœæµ‹æ˜¯ index_only =true å‘Šè¯‰æˆ‘ä»¬è¿™æ˜¯ç´¢å¼•è¦†ç›–è€Œä¸éœ€å›è¡¨ï¼Œå¯ä»¥ç´¢å¼•è¦†ç›–çš„ cost_for_plan ä¸º 1.1056 è€Œå›è¡¨çš„ cost_for_plan ä¸º 0.61ï¼Œè¿™æ˜¯ä¸æ˜¯è¯æ˜ç´¢å¼•è¦†ç›–æ‰€ä»˜å‡ºçš„æŸè€—è¿˜è¦é«˜äºå›è¡¨äº†ï¼Ÿ ","like_count":1,"discussions":[{"author":{"id":1001470,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/47/fe/d0e25d57.jpg","nickname":"æœ±æ™”","note":"","ucode":"0B7F0BADE6AAB8","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":488737,"discussion_content":"æˆ‘è¿™è¾¹åšå®éªŒçš„ç»“æœåœ¨æºç çš„coveringindex.jpgä¸­å¯ä»¥çœ‹ä¸€ä¸‹","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1585018844,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":341655,"user_name":"å¤å¤©ï¼ƒé£ä¹‹å‹","can_delete":false,"product_type":"c1","uid":1195532,"ip_address":"","ucode":"28010A4D48935D","user_header":"https://static001.geekbang.org/account/avatar/00/12/3e/0c/b8b15a96.jpg","comment_is_top":false,"comment_ctime":1649753113,"is_pvip":false,"replies":[{"id":"124851","content":"æ•°é‡å¤§ï¼Œå­—æ®µå¤šï¼Œè¿™ç§æœç´¢å°±ç”¨ESå¥½äº†","user_name":"ä½œè€…å›å¤","comment_id":341655,"uid":"1001470","ip_address":"","utype":1,"ctime":1649813944,"user_name_real":"ç¼–è¾‘"}],"discussion_count":1,"race_medal":0,"score":"1649753113","product_id":100047701,"comment_content":"è€å¸ˆï¼Œä½ å¥½ï¼Œçœ‹åˆ°æ–‡ç« å¾ˆå—å¯å‘ã€‚æˆ‘è¿™é‡Œæœ‰ä¸ªé—®é¢˜è¯·æ•™ä¸€ä¸‹ï¼Œé¡¹ç›®ç»å¸¸é‡åˆ°å¤šæ¡ä»¶æŸ¥è¯¢ï¼Œä¾‹å¦‚ï¼Œè®°å½•è¡¨æ•°é‡çº§å¤§ï¼Œæƒ³ç€æ·»åŠ å¤šå­—æ®µçš„äºŒçº§ç´¢å¼•ï¼ˆæ¯”å¦‚ index_test(a,b,c)ï¼‰æ¥æå‡æ•ˆç‡ï¼Œä½†ç”±äºæŸ¥è¯¢æ¡ä»¶å­—æ®µæ˜¯åŠ¨æ€æ‹¼æ¥ï¼Œæ•°é‡ä¸å®š(æ¯”å¦‚ï¼šabc,ac,bc,a,b,c)ã€‚è¿™æ ·ä¼šå¯¼è‡´æ— æ³•æ¯æ¬¡æŸ¥è¯¢éƒ½ä¼šå‘½ä¸­ç´¢å¼•ã€‚ åƒè¿™æ ·çš„æƒ…å†µï¼Œè€å¸ˆæœ‰ä»€ä¹ˆæ›´å¥½çš„æŸ¥è¯¢æ–¹æ¡ˆï¼Ÿæ„Ÿè°¢","like_count":0,"discussions":[{"author":{"id":1001470,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/47/fe/d0e25d57.jpg","nickname":"æœ±æ™”","note":"","ucode":"0B7F0BADE6AAB8","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":562350,"discussion_content":"æ•°é‡å¤§ï¼Œå­—æ®µå¤šï¼Œè¿™ç§æœç´¢å°±ç”¨ESå¥½äº†","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1649813944,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":337905,"user_name":"SharpBB","can_delete":false,"product_type":"c1","uid":2014573,"ip_address":"","ucode":"D30C5B798B8E8C","user_header":"https://static001.geekbang.org/account/avatar/00/1e/bd/6d/7010f98e.jpg","comment_is_top":false,"comment_ctime":1647154820,"is_pvip":true,"discussion_count":0,"race_medal":0,"score":"1647154820","product_id":100047701,"comment_content":"ç§€å•Š ç‰¹åˆ«æ˜¯ä¸èµ°ç´¢å¼•çš„æƒ…å†µ åŸæ¥mysqlä¼šè‡ªè¡Œåˆ¤æ–­æˆæœ¬  éš¾æ€ªdbaæ˜¯ä¸€ä¸ªå•ç‹¬çš„èŒä½ æ•°æ®åº“æ–¹é¢çš„å­¦é—®å¾ˆæ·±å•Š","like_count":0},{"had_liked":false,"id":309115,"user_name":"ChaselğŸ‘»","can_delete":false,"product_type":"c1","uid":2563225,"ip_address":"","ucode":"7DB9E8FA5307EF","user_header":"https://static001.geekbang.org/account/avatar/00/27/1c/99/5e738818.jpg","comment_is_top":false,"comment_ctime":1629947275,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1629947275","product_id":100047701,"comment_content":"è€å¸ˆï¼Œæ ¹æ®é˜¿é‡Œçš„å¼€å‘æ–‡æ¡£ï¼Œä¸šåŠ¡ä¸Šå…·æœ‰å”¯ä¸€ç‰¹æ€§çš„å­—æ®µï¼Œå³ä½¿æ˜¯å¤šä¸ªå­—æ®µçš„ç»„åˆï¼Œä¹Ÿå¿…é¡»å»ºæˆå”¯ä¸€ç´¢å¼•ã€‚è¿™ä¸ªå­—æ®µç»„åˆå¦‚æœç‰¹åˆ«é•¿çš„è¯ä¹Ÿéœ€è¦å»ºç«‹å”¯ä¸€ç´¢å¼•ä¹ˆï¼Ÿå®é™…å¼€å‘ä¸­æ˜¯æ€ä¹ˆè€ƒé‡çš„","like_count":0},{"had_liked":false,"id":302864,"user_name":"é˜²è…åŸº","can_delete":false,"product_type":"c1","uid":2696605,"ip_address":"","ucode":"0FF3BF30631995","user_header":"https://static001.geekbang.org/account/avatar/00/29/25/9d/d612cbf8.jpg","comment_is_top":false,"comment_ctime":1626416103,"is_pvip":true,"discussion_count":0,"race_medal":0,"score":"1626416103","product_id":100047701,"comment_content":"äºŒåˆ†æ³•ä»€ä¹ˆçš„ä¸€å¤´é›¾æ°´ï¼Œä¸‹é¢ä¹Ÿå°±çœ‹ä¸ä¸‹å»äº†â€¦â€¦","like_count":0},{"had_liked":false,"id":300451,"user_name":"batman","can_delete":false,"product_type":"c1","uid":1266482,"ip_address":"","ucode":"73C30ACFC0D612","user_header":"http://thirdwx.qlogo.cn/mmopen/vi_32/IIkdC2gohpcibib0AJvSdnJQefAuQYGlLySQOticThpF7Ck9WuDUQLJlgZ7ic13LIFnGBXXbMsSP3nZsbibBN98ZjGA/132","comment_is_top":false,"comment_ctime":1625182957,"is_pvip":true,"replies":[{"id":"108895","content":"ç£ç›˜+å†…å­˜","user_name":"ä½œè€…å›å¤","comment_id":300451,"uid":"1001470","ip_address":"","utype":1,"ctime":1625196967,"user_name_real":"æœ±æ™”"}],"discussion_count":1,"race_medal":1,"score":"1625182957","product_id":100047701,"comment_content":"ä¸»é”®èšæ—ç´¢å¼•æ˜¯å­˜åœ¨ç£ç›˜è¿˜æ˜¯å†…å­˜ï¼Œå¦‚æœæ˜¯ç£ç›˜ï¼Œæ¯æ¬¡éƒ½æŸ¥ç£ç›˜å²‚ä¸æ˜¯å¾ˆæ…¢ï¼Œå¦‚æœæ˜¯å†…å­˜ï¼Œæ€ä¹ˆèƒ½æ”¾ä¸‹é‚£ä¹ˆæ•°æ®","like_count":0,"discussions":[{"author":{"id":1001470,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/47/fe/d0e25d57.jpg","nickname":"æœ±æ™”","note":"","ucode":"0B7F0BADE6AAB8","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":522736,"discussion_content":"ç£ç›˜+å†…å­˜","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1625196967,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":269604,"user_name":"å¤©å¤©å‘ä¸Š","can_delete":false,"product_type":"c1","uid":1242455,"ip_address":"","ucode":"0CCCA6F4DCC480","user_header":"https://static001.geekbang.org/account/avatar/00/12/f5/57/ce10fb1b.jpg","comment_is_top":false,"comment_ctime":1608712996,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1608712996","product_id":100047701,"comment_content":"æ•°æ®åº“åŸºäºæˆæœ¬å†³å®šæ˜¯å¦èµ°ç´¢å¼• é•¿çŸ¥è¯†äº†","like_count":0},{"had_liked":false,"id":257293,"user_name":"seckiller","can_delete":false,"product_type":"c1","uid":1540757,"ip_address":"","ucode":"CCA66F155A2022","user_header":"http://thirdwx.qlogo.cn/mmopen/vi_32/DYAIOgq83er3Ey0Uq2w4wDUKbLgqUHIkeH9oYeG2KW92CvBgYviczRMdbk6xxFO8mxMOVxGBozUUZDyfLKEhFFA/132","comment_is_top":false,"comment_ctime":1603931477,"is_pvip":false,"replies":[{"id":"93819","content":"æŸ¥è¯¢äºŒçº§ç´¢å¼•ä¸­ä¸è¦†ç›–çš„å­—æ®µå°±éœ€è¦å›è¡¨èšç°‡ç´¢å¼•","user_name":"ä½œè€…å›å¤","user_name_real":"æœ±æ™”","uid":"1001470","ctime":1604054490,"ip_address":"","comment_id":257293,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1603931477","product_id":100047701,"comment_content":"è€å¸ˆè§£é‡Šä¸€ä¸‹å›è¡¨ï¼Œä»€ä¹ˆæ—¶å€™å®¹æ˜“å›è¡¨ï¼Œå›è¡¨åªå½±å“æ€§èƒ½å—ï¼Ÿ","like_count":0,"discussions":[{"author":{"id":1001470,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/47/fe/d0e25d57.jpg","nickname":"æœ±æ™”","note":"","ucode":"0B7F0BADE6AAB8","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":508287,"discussion_content":"æŸ¥è¯¢äºŒçº§ç´¢å¼•ä¸­ä¸è¦†ç›–çš„å­—æ®µå°±éœ€è¦å›è¡¨èšç°‡ç´¢å¼•","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1604054490,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":249780,"user_name":"é²é¸£","can_delete":false,"product_type":"c1","uid":2152306,"ip_address":"","ucode":"974BA3C3E64630","user_header":"https://static001.geekbang.org/account/avatar/00/20/d7/72/cbef720d.jpg","comment_is_top":false,"comment_ctime":1600788998,"is_pvip":false,"discussion_count":1,"race_medal":0,"score":"1600788998","product_id":100047701,"comment_content":"ä¹‹å‰å’ŒåŒäº‹çªç„¶æƒ³åˆ°ä¸€ä¸ªé—®é¢˜ï¼Œå°±æ˜¯å”¯ä¸€ç´¢å¼•ä¹Ÿæ˜¯æœ€å·¦åŒ¹é…å—ï¼Ÿ","like_count":0,"discussions":[{"author":{"id":1488356,"avatar":"https://static001.geekbang.org/account/avatar/00/16/b5/e4/e6faf686.jpg","nickname":"æ¡äº†ä¸ªå¤§èš‚èš±","note":"","ucode":"AD34AD4FA37371","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":341253,"discussion_content":"éƒ½æ˜¯b+æ ‘","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1610362479,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":240357,"user_name":"æå’Œæ¡ƒ","can_delete":false,"product_type":"c1","uid":1015877,"ip_address":"","ucode":"97E66953070EE0","user_header":"https://static001.geekbang.org/account/avatar/00/0f/80/45/d719f7df.jpg","comment_is_top":false,"comment_ctime":1596875934,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1596875934","product_id":100047701,"comment_content":"é’ˆå¯¹ç¬¬äºŒä¸ªé—®é¢˜ï¼Œå¯ä»¥ä»type,rows,extraä¸‰ä¸ªå­—æ®µä¸Šé¢çœ‹åˆ°åŸå› ã€‚å¦‚æœæ²¡æœ‰ç´¢å¼•çš„è¯ï¼Œæ’åºå°±éœ€è¦æŠŠè¡¨ä¸­æ‰€æœ‰çš„æ•°æ®æ”¾å…¥sort_bufferï¼Œå¦‚æœæ”¾ä¸ä¸‹ï¼Œå°±è¦å€ŸåŠ©fileå»æ’åºï¼ˆextraçš„filesortï¼‰ï¼Œæ•ˆç‡ç›¸å½“æ…¢ã€‚å¦‚æœæ˜¯æœ‰ç´¢å¼•ï¼Œé‚£ä¹ˆB+treeå¸®æˆ‘ä»¬ç»´æŠ¤äº†ä¸€ä¸ªæœ‰åºçš„ç»“æ„ï¼Œå¯ä»¥ç›´æ¥è¿›è¡Œb+treeæœç´¢ã€‚","like_count":0},{"had_liked":false,"id":240354,"user_name":"æå’Œæ¡ƒ","can_delete":false,"product_type":"c1","uid":1015877,"ip_address":"","ucode":"97E66953070EE0","user_header":"https://static001.geekbang.org/account/avatar/00/0f/80/45/d719f7df.jpg","comment_is_top":false,"comment_ctime":1596875511,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1596875511","product_id":100047701,"comment_content":"è€å¸ˆï¼Œä¸ºä»€ä¹ˆæˆ‘ä½¿ç”¨è¦†ç›–ç´¢å¼•å‘ç°è¦†ç›–ç´¢å¼•çš„costæ›´é«˜å‘¢ï¼Ÿ<br>ä¸ä½¿ç”¨è¦†ç›–ç´¢å¼•ï¼š<br>select * from person where name = &#39;name123&#39;;<br>&quot;range_scan_alternatives&quot;: [<br>                      {<br>                        &quot;index&quot;: &quot;idx_name_score&quot;,<br>                        &quot;ranges&quot;: [<br>                          &quot;name123 &lt;= name &lt;= name123&quot;<br>                        ],<br>                        &quot;index_dives_for_eq_ranges&quot;: true,<br>                        &quot;rowid_ordered&quot;: false,<br>                        &quot;using_mrr&quot;: false,<br>                        &quot;index_only&quot;: false,<br>                        &quot;rows&quot;: 1,<br>                        &quot;cost&quot;: 0.61,<br>                        &quot;chosen&quot;: true<br>                      }<br>                    ]<br>ä½¿ç”¨è¦†ç›–ç´¢å¼•ï¼š<br>select name,score from person where name = &#39;name123&#39;;<br>&quot;range_scan_alternatives&quot;: [<br>                      {<br>                        &quot;index&quot;: &quot;idx_name_score&quot;,<br>                        &quot;ranges&quot;: [<br>                          &quot;name123 &lt;= name &lt;= name123&quot;<br>                        ],<br>                        &quot;index_dives_for_eq_ranges&quot;: true,<br>                        &quot;rowid_ordered&quot;: false,<br>                        &quot;using_mrr&quot;: false,<br>                        &quot;index_only&quot;: true,<br>                        &quot;rows&quot;: 1,<br>                        &quot;cost&quot;: 1.1056,<br>                        &quot;chosen&quot;: true<br>                      }<br>]","like_count":0},{"had_liked":false,"id":238192,"user_name":"Geek_299a34","can_delete":false,"product_type":"c1","uid":1928441,"ip_address":"","ucode":"79AECE06F08E87","user_header":"http://thirdwx.qlogo.cn/mmopen/vi_32/cfNtHoAbHvia1O0jIopiafYbnppEPiawgicKa8vdI2FxMMEdqORB4VLzkYTuGJGA7HibustnU0hDTOD7YSDAWuxhmrg/132","comment_is_top":false,"comment_ctime":1596092228,"is_pvip":false,"replies":[{"id":"88011","content":"As previously described, all pages at each level are doubly-linked to each other, and within each page, records are singly-linked in ascending order. Non-leaf pages contain â€œpointersâ€ (containing the child page number) rather than non-key row data.<br><br><br>https:&#47;&#47;blog.jcole.us&#47;2013&#47;01&#47;10&#47;btree-index-structures-in-innodb&#47;","user_name":"ä½œè€…å›å¤","user_name_real":"æœ±æ™”","uid":"1001470","ctime":1596094076,"ip_address":"","comment_id":238192,"utype":1}],"discussion_count":2,"race_medal":0,"score":"1596092228","product_id":100047701,"comment_content":"è€å¸ˆï¼ŒB+æ ‘åŒä¸€å±‚çš„éå¶å­ç»“ç‚¹ä¹‹é—´åº”è¯¥ä¸æ˜¯åŒå‘é“¾è¡¨å§ï¼Œä½ é‚£ä¸ªå›¾ç”»çš„çœ‹èµ·æ¥æ˜¯åŒå‘é“¾è¡¨","like_count":0,"discussions":[{"author":{"id":1001470,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/47/fe/d0e25d57.jpg","nickname":"æœ±æ™”","note":"","ucode":"0B7F0BADE6AAB8","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":502671,"discussion_content":"As previously described, all pages at each level are doubly-linked to each other, and within each page, records are singly-linked in ascending order. Non-leaf pages contain â€œpointersâ€ (containing the child page number) rather than non-key row data.\n\n\nhttps://blog.jcole.us/2013/01/10/btree-index-structures-in-innodb/","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1596094076,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1928441,"avatar":"http://thirdwx.qlogo.cn/mmopen/vi_32/cfNtHoAbHvia1O0jIopiafYbnppEPiawgicKa8vdI2FxMMEdqORB4VLzkYTuGJGA7HibustnU0hDTOD7YSDAWuxhmrg/132","nickname":"Geek_299a34","note":"","ucode":"79AECE06F08E87","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":295149,"discussion_content":"è€å¸ˆå¤ªå‰å®³äº†ï¼Œä¸ºè€å¸ˆç‚¹èµï¼Œæ„Ÿè°¢","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1596103096,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":237788,"user_name":"æé±¼çš„æ¬ç –å¥‡","can_delete":false,"product_type":"c1","uid":1021539,"ip_address":"","ucode":"2FD194C4DA26E5","user_header":"https://static001.geekbang.org/account/avatar/00/0f/96/63/7eb32c9b.jpg","comment_is_top":false,"comment_ctime":1595952787,"is_pvip":false,"replies":[{"id":"87890","content":"analyze tableå¼„ä¸€ä¸‹","user_name":"ä½œè€…å›å¤","user_name_real":"æœ±æ™”","uid":"1001470","ctime":1596009507,"ip_address":"","comment_id":237788,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1595952787","product_id":100047701,"comment_content":"æ–‡ä¸­çš„ä¾‹å­ï¼Œperson è¡¨å»ºç«‹åï¼Œåœ¨å¢åŠ  ä¸¤ä¸ªç´¢å¼•ã€‚index_length è¿˜æ˜¯0.è¿™æ˜¯ä¸ºä»€ä¹ˆå‘¢","like_count":0,"discussions":[{"author":{"id":1001470,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/47/fe/d0e25d57.jpg","nickname":"æœ±æ™”","note":"","ucode":"0B7F0BADE6AAB8","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":502538,"discussion_content":"analyze tableå¼„ä¸€ä¸‹","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1596009507,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":230839,"user_name":"ä½ å½“åƒé¸Ÿé£å‘ä½ çš„å±±","can_delete":false,"product_type":"c1","uid":1915046,"ip_address":"","ucode":"D20279F2D2867B","user_header":"http://thirdwx.qlogo.cn/mmopen/vi_32/a1nDkic8T3LRWe4hAWqCd32C6x3SM7IsmxKticU0icDt0oO95FYlmWhBnWdjiboaRh6c5fxu8t7E6VSElVfUZGe6Ww/132","comment_is_top":false,"comment_ctime":1593508144,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1593508144","product_id":100047701,"comment_content":"å¬è¯´å†™ä¸€ä¸ªç¬¦å·ä¹Ÿä¼šæé«˜å­¦ä¹ çš„æ•ˆæœï¼š<br>ç¬¬ä¸€ï¼Œåœ¨éœ€è¦ä¼˜åŒ–æ€§èƒ½çš„æ—¶å€™ï¼Œå†æ ¹æ®ç»å¸¸ä½œä¸ºæŸ¥è¯¢æ¡ä»¶çš„å­—æ®µæ¥å»ºç«‹ç´¢å¼•ï¼Œå»ºç«‹ç´¢å¼•ä¸æ˜¯å­—æ®µè¶Šå¤šè¶Šå¥½ï¼Œè€Œè¦è€ƒè™‘åˆ°å»ºç«‹ç´¢å¼•å¸¦æ¥çš„ç©ºé—´æˆæœ¬ï¼Œå»ºç«‹ä¹‹åçš„ç»´æŠ¤æˆæœ¬ï¼ŒæŸ¥è¯¢ä½¿ç”¨ç´¢å¼•çš„å›è¡¨æˆæœ¬ã€‚<br>ç¬¬äºŒï¼Œåœ¨æŸ¥è¯¢è¿‡ç¨‹ä¸­ ï¼Œå¹¶ä¸æ˜¯ä¸€å®šä¼šèµ°ç´¢å¼•æŸ¥è¯¢ï¼Œå¦‚æœæ ¹æ®ç»Ÿè®¡ä¿¡æ¯è®¡ç®—å‡ºæ¥èµ°ç´¢å¼•çš„æˆæœ¬æ¯”å…¨è¡¨æ‰«æè¿˜å¤§ï¼Œåˆ™èµ°å…¨è¡¨æ‰«æäº†ï¼Œå…¶ä»–çš„æƒ…å†µæ¯”å¦‚ï¼šå¤šå­—æ®µè”åˆç´¢å¼•ä¸æŒ‰ç´¢å¼•å­—æ®µé¡ºåºæ’åˆ—æ¡ä»¶ï¼Œç´¢å¼•å­—æ®µä½¿ç”¨å‡½æ•°ï¼Œä½¿ç”¨ç´¢å¼•å­—æ®µå‰ç¼€æ¨¡ç³ŠåŒ¹é…","like_count":0},{"had_liked":false,"id":223271,"user_name":"é©¬ä»¥","can_delete":false,"product_type":"c1","uid":1344431,"ip_address":"","ucode":"3FEA06CA14DE28","user_header":"https://static001.geekbang.org/account/avatar/00/14/83/af/1cb42cd3.jpg","comment_is_top":false,"comment_ctime":1591053023,"is_pvip":false,"replies":[{"id":"82245","content":"å¯ä»¥çœ‹çœ‹æˆ‘å¯¹Jokerçš„å›å¤","user_name":"ä½œè€…å›å¤","user_name_real":"æœ±æ™”","uid":"1001470","ctime":1591056377,"ip_address":"","comment_id":223271,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1591053023","product_id":100047701,"comment_content":"â€œå†ä½¿ç”¨äºŒåˆ†æœç´¢å‡º #3 æ§½å’Œ #6 æ§½çš„ä¸­é—´ä½æ˜¯ (3+6)&#47;2=4.5 å–æ•´ 4ï¼Œ#4 æ§½å¯¹åº”çš„è®°å½•æ˜¯ 16ï¼15ï¼Œæ‰€ä»¥è®°å½•ä¸€å®šåœ¨ #4 æ§½ä¸­ï¼›â€è¿™é‡Œçš„#4æ˜¯ä¸æ˜¯åº”è¯¥æ˜¯#3ï¼Ÿ","like_count":0,"discussions":[{"author":{"id":1001470,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/47/fe/d0e25d57.jpg","nickname":"æœ±æ™”","note":"","ucode":"0B7F0BADE6AAB8","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":497083,"discussion_content":"å¯ä»¥çœ‹çœ‹æˆ‘å¯¹Jokerçš„å›å¤","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1591056377,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":222336,"user_name":"Mq","can_delete":false,"product_type":"c1","uid":1178359,"ip_address":"","ucode":"041F572AFAB275","user_header":"https://static001.geekbang.org/account/avatar/00/11/fa/f7/91ac44c5.jpg","comment_is_top":false,"comment_ctime":1590751668,"is_pvip":false,"replies":[{"id":"82020","content":"æ’åºä½¿ç”¨åˆ°ç´¢å¼•ï¼Œæ‰§è¡Œè®¡åˆ’ä¸­ä½“ç°çš„å°±æ˜¯keyä¸€åˆ—ï¼Œå¦‚æœæ²¡æœ‰ç”¨åˆ°ç´¢å¼•ï¼Œä¼šåœ¨Extraä¸­çœ‹åˆ°Using filesort","user_name":"ä½œè€…å›å¤","user_name_real":"æœ±æ™”","uid":"1001470","ctime":1590754954,"ip_address":"","comment_id":222336,"utype":1}],"discussion_count":2,"race_medal":0,"score":"1590751668","product_id":100047701,"comment_content":"è€å¸ˆå¥½ï¼Œçœ‹æ–‡æ¡£é¡µé‡Œé¢çš„æ•°æ®æ˜¯å•å‘çš„ï¼Œä¸ºä»€ä¹ˆæˆ‘åœ¨ç´¢å¼•é‡Œä»å¤§åˆ°å°æ£€ç´¢æ•°æ®ï¼Œçœ‹ä¸åˆ°æ’åºçš„æ‰§è¡Œè®¡åˆ’","like_count":0,"discussions":[{"author":{"id":1001470,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/47/fe/d0e25d57.jpg","nickname":"æœ±æ™”","note":"","ucode":"0B7F0BADE6AAB8","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":496755,"discussion_content":"æ’åºä½¿ç”¨åˆ°ç´¢å¼•ï¼Œæ‰§è¡Œè®¡åˆ’ä¸­ä½“ç°çš„å°±æ˜¯keyä¸€åˆ—ï¼Œå¦‚æœæ²¡æœ‰ç”¨åˆ°ç´¢å¼•ï¼Œä¼šåœ¨Extraä¸­çœ‹åˆ°Using filesort","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1590754954,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1178359,"avatar":"https://static001.geekbang.org/account/avatar/00/11/fa/f7/91ac44c5.jpg","nickname":"Mq","note":"","ucode":"041F572AFAB275","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":275959,"discussion_content":"æˆ‘çš„æ„æ€æ˜¯ä½¿ç”¨åˆ°äº†ç´¢å¼•ï¼Œå‡è®¾idæ˜¯ç´¢å¼•ï¼Œå€¼æ˜¯1-100ï¼Œæˆ‘æŸ¥100-1ï¼Œæ‰§è¡Œè®¡åˆ’æ˜¯èµ°çš„ç´¢å¼•ï¼Œæ²¡æœ‰æ’åºï¼Œä½†æ˜¯æˆ‘çœ‹æ•°æ®é¡µé‡Œé¢çš„æ•°æ®æ˜¯å•å‘çš„ï¼Œä»–æ˜¯æ€ä¹ˆåšåˆ°ä¸æ’åºçš„ï¼Œå¦‚æœæ˜¯åŒå‘çš„å°±å¥½ç†è§£äº†","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1590793143,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":221457,"user_name":"å¼ fore fore","can_delete":false,"product_type":"c1","uid":1913432,"ip_address":"","ucode":"3AE90B5B7B2D19","user_header":"https://static001.geekbang.org/account/avatar/00/1d/32/58/b3f156bf.jpg","comment_is_top":false,"comment_ctime":1590502630,"is_pvip":false,"replies":[{"id":"81662","content":"ï¼šï¼‰","user_name":"ä½œè€…å›å¤","user_name_real":"æœ±æ™”","uid":"1001470","ctime":1590503834,"ip_address":"","comment_id":221457,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1590502630","product_id":100047701,"comment_content":"è€å¸ˆçœŸçš„å¾ˆç”¨å¿ƒï¼Œç»†è‡´å…¥å¾®~( 0 x 0 )","like_count":0,"discussions":[{"author":{"id":1001470,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/47/fe/d0e25d57.jpg","nickname":"æœ±æ™”","note":"","ucode":"0B7F0BADE6AAB8","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":496458,"discussion_content":"ï¼šï¼‰","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1590503834,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":220499,"user_name":"å²³å®œæ³¢","can_delete":false,"product_type":"c1","uid":1975581,"ip_address":"","ucode":"5043CA250FDCB1","user_header":"http://thirdwx.qlogo.cn/mmopen/2kpMNDYsSfCnhAYmvAsNcYKyNLUJG5iax9BKgXAJzxypEJGRVwhibjZ53S5icgEDibn8uqrqwsKcxzEXfRRUXTdqjA/132","comment_is_top":false,"comment_ctime":1590251160,"is_pvip":false,"replies":[{"id":"81372","content":"å—¯ è¿™æ˜¯ä¸€ç§é€æ˜ç¼“å­˜çš„åšæ³• ä¸è¿‡è¿™ä¸ªä¹Ÿè¦çœ‹ä¸šåŠ¡æ˜¯å¦é€‚åˆ","user_name":"ä½œè€…å›å¤","user_name_real":"æœ±æ™”","uid":"1001470","ctime":1590281716,"ip_address":"","comment_id":220499,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1590251160","product_id":100047701,"comment_content":"æˆ‘ä»¬é¡¹ç›®ä¸­æ˜¯ä½¿ç”¨JPAï¼Œåœ¨æŸ¥è¯¢æ—¶è¿›è¡Œäº†å°è£…ï¼Œå°†æ•°æ®æ ¹æ®IDç¼“å­˜åœ¨Redis é‡Œï¼ŒæŸ¥è¯¢æ—¶æ ¹æ®æŸ¥è¯¢æ¡ä»¶åªæŸ¥å‡ºIDï¼Œç„¶åæ ¹æ®IDå»Redisé‡Œè·å–æ•°æ®ï¼Œé¿å…äº†å›è¡¨","like_count":0,"discussions":[{"author":{"id":1001470,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/47/fe/d0e25d57.jpg","nickname":"æœ±æ™”","note":"","ucode":"0B7F0BADE6AAB8","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":496156,"discussion_content":"å—¯ è¿™æ˜¯ä¸€ç§é€æ˜ç¼“å­˜çš„åšæ³• ä¸è¿‡è¿™ä¸ªä¹Ÿè¦çœ‹ä¸šåŠ¡æ˜¯å¦é€‚åˆ","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1590281716,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":219895,"user_name":"tongzi","can_delete":false,"product_type":"c1","uid":2002210,"ip_address":"","ucode":"7349A6E42EDF17","user_header":"https://static001.geekbang.org/account/avatar/00/1e/8d/22/0bf540be.jpg","comment_is_top":false,"comment_ctime":1590115326,"is_pvip":false,"replies":[{"id":"81175","content":"1ã€æ ¹æ®ç›®å½•é¡µä¸­PKçš„èŒƒå›´ç¡®å®šç›®å½•é¡µ<br>2ã€åœ¨ç›®å½•é¡µä¸­äºŒåˆ†æ³•ç¡®å®šä¸‹å±‚ç›®å½•é¡µ<br>3ã€é‡å¤1å’Œ2ä¸€ç›´åˆ°æ‰¾åˆ°å¶å­é¡µ<br>4ã€åœ¨å¶å­é¡µä¸­åŒæ ·äºŒåˆ†æ³•å®šä½åˆ°è®°å½•","user_name":"ä½œè€…å›å¤","user_name_real":"æœ±æ™”","uid":"1001470","ctime":1590119996,"ip_address":"","comment_id":219895,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1590115326","product_id":100047701,"comment_content":"è€å¸ˆä½ å¥½ï¼Œè¯·æ•™ä¸ªé—®é¢˜ï¼ˆå…³äºæœ¬ç¯‡å¼€å¤´ï¼Œmysqlåˆ©ç”¨ç´¢å¼•æœç´¢å®šä½æ•°æ®ï¼‰ï¼Œä»¥ä¸‹é—®é¢˜å¯èƒ½æœ¬èº«å°±æ˜¯ä¸€ä¸ªå‡å‘½é¢˜<br>     mysqlçš„ç´¢å¼•æ˜¯B+æ ‘ç»“æ„å­˜å‚¨ï¼ŒB+æ ‘çš„å¶å­èŠ‚ç‚¹æ˜¯æˆ‘ä»¬çš„æ•°æ®é¡µ<br>     å½“æŠŠæ•°æ®é¡µåŠ è½½åˆ°å†…å­˜åï¼Œå¦‚æœ¬ç¯‡å¼€å¤´ï¼Œå½“å‰å¶å­èŠ‚ç‚¹æ˜¯3ä¸ªæ•°æ®é¡µç»„æˆçš„åŒå‘é“¾è¡¨ï¼Œè¿™é‡Œå¶å­èŠ‚ç‚¹æœ‰å¯èƒ½æ˜¯3ä¸ªæ•°æ®é¡µç»„æˆçš„å§ï¼Ÿï¼ˆå‡è®¾åˆ¤pkä¸º1-768ï¼›æ•°æ®é¡µ1å­˜å‚¨1-256ï¼Œæ•°æ®é¡µ2å­˜å‚¨257-512ï¼Œæ•°æ®é¡µ3å­˜å‚¨513-768ï¼‰<br>å¦‚æœç°åœ¨å®šä½pk = 544ï¼Œæ˜¯ä»æ•°æ®é¡µ1å¼€å§‹æŸ¥ï¼Œåªåˆ°æ•°æ®é¡µ3ï¼Œç„¶åé‡‡ç”¨äºŒåˆ†æ³•å®šä½åˆ°pk=544<br>è¿˜æ˜¯åˆ©ç”¨å…¶å®ƒæ–¹å¼çš„ï¼Œç›´æ¥å®šä½åˆ°æ•°æ®3ï¼Ÿ<br>","like_count":0,"discussions":[{"author":{"id":1001470,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/47/fe/d0e25d57.jpg","nickname":"æœ±æ™”","note":"","ucode":"0B7F0BADE6AAB8","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":495981,"discussion_content":"1ã€æ ¹æ®ç›®å½•é¡µä¸­PKçš„èŒƒå›´ç¡®å®šç›®å½•é¡µ\n2ã€åœ¨ç›®å½•é¡µä¸­äºŒåˆ†æ³•ç¡®å®šä¸‹å±‚ç›®å½•é¡µ\n3ã€é‡å¤1å’Œ2ä¸€ç›´åˆ°æ‰¾åˆ°å¶å­é¡µ\n4ã€åœ¨å¶å­é¡µä¸­åŒæ ·äºŒåˆ†æ³•å®šä½åˆ°è®°å½•","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1590119996,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":215931,"user_name":"Heiky","can_delete":false,"product_type":"c1","uid":1623626,"ip_address":"","ucode":"03AA79E1BC4AE4","user_header":"https://static001.geekbang.org/account/avatar/00/18/c6/4a/3bd896fc.jpg","comment_is_top":false,"comment_ctime":1589154982,"is_pvip":false,"replies":[{"id":"79888","content":"InnoDBä½¿ç”¨çš„æ˜¯èšç°‡ç´¢å¼•ï¼Œå°†ä¸»é”®ç»„ç»‡åˆ°ä¸€æ£µB+æ ‘ä¸­ï¼Œè€Œè¡Œæ•°æ®å°±å‚¨å­˜åœ¨å¶å­èŠ‚ç‚¹ä¸Š","user_name":"ä½œè€…å›å¤","user_name_real":"æœ±æ™”","uid":"1001470","ctime":1589158275,"ip_address":"","comment_id":215931,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1589154982","product_id":100047701,"comment_content":"è€å¸ˆï¼Œæœ‰ä¸ªé—®é¢˜ï¼Œç°‡èšç´¢å¼•å¶å­èŠ‚ç‚¹å­˜å‚¨æ˜¯çœŸå®çš„æ•°æ®ï¼Œè¿˜æ˜¯æŒ‡å‘æ•°æ®çš„æŒ‡é’ˆã€‚","like_count":0,"discussions":[{"author":{"id":1001470,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/47/fe/d0e25d57.jpg","nickname":"æœ±æ™”","note":"","ucode":"0B7F0BADE6AAB8","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":494617,"discussion_content":"InnoDBä½¿ç”¨çš„æ˜¯èšç°‡ç´¢å¼•ï¼Œå°†ä¸»é”®ç»„ç»‡åˆ°ä¸€æ£µB+æ ‘ä¸­ï¼Œè€Œè¡Œæ•°æ®å°±å‚¨å­˜åœ¨å¶å­èŠ‚ç‚¹ä¸Š","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1589158275,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":206460,"user_name":"Ant_D","can_delete":false,"product_type":"c1","uid":1111116,"ip_address":"","ucode":"9C8C8417D0AF09","user_header":"https://static001.geekbang.org/account/avatar/00/10/f4/4c/aac5165c.jpg","comment_is_top":false,"comment_ctime":1586865204,"is_pvip":false,"replies":[{"id":"77148","content":"å—ç¯‡å¹…é™åˆ¶æ–‡ä¸­è¯´çš„æ¯”è¾ƒç®€æ´ï¼Œç†è§£äº†å¤§æ¦‚ä¹‹åï¼Œè¿˜å¯ä»¥ç»§ç»­æ‰¾å…¶ä»–èµ„æ–™çœ‹<br><br>å¦‚æœè§‰å¾—å¯¹ä½ æœ‰å¸®åŠ©æ¬¢è¿ç‚¹èµ&amp;è½¬å‘","user_name":"ä½œè€…å›å¤","user_name_real":"æœ±æ™”","uid":"1001470","ctime":1586870172,"ip_address":"","comment_id":206460,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1586865204","product_id":100047701,"comment_content":"å—ç›ŠåŒªæµ…","like_count":0,"discussions":[{"author":{"id":1001470,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/47/fe/d0e25d57.jpg","nickname":"æœ±æ™”","note":"","ucode":"0B7F0BADE6AAB8","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":491799,"discussion_content":"å—ç¯‡å¹…é™åˆ¶æ–‡ä¸­è¯´çš„æ¯”è¾ƒç®€æ´ï¼Œç†è§£äº†å¤§æ¦‚ä¹‹åï¼Œè¿˜å¯ä»¥ç»§ç»­æ‰¾å…¶ä»–èµ„æ–™çœ‹\n\nå¦‚æœè§‰å¾—å¯¹ä½ æœ‰å¸®åŠ©æ¬¢è¿ç‚¹èµ&amp;amp;è½¬å‘","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1586870172,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":205733,"user_name":"Joker","can_delete":false,"product_type":"c1","uid":1156592,"ip_address":"","ucode":"126AF848001A1E","user_header":"https://static001.geekbang.org/account/avatar/00/11/a5/f0/8648c464.jpg","comment_is_top":false,"comment_ctime":1586716617,"is_pvip":false,"replies":[{"id":"76899","content":"æ²¡é”™ï¼Œæ–‡ä¸­æ²¡æœ‰è¯¦ç»†è¯´è¿™å—ï¼Œæ¯ä¸ªæ§½å¯¹åº”çš„è®°å½•æ˜¯è¯¥ç»„ä¸­ä¸»é”®å€¼æœ€å¤§çš„è®°å½•ï¼Œæ‰€ä»¥è¿˜æ˜¯#4ï¼Œç„¶åæœç´¢éœ€è¦ä»å‰ä¸€ä¸ªæ§½å¼€å§‹æœç´¢","user_name":"ä½œè€…å›å¤","user_name_real":"æœ±æ™”","uid":"1001470","ctime":1586739769,"ip_address":"","comment_id":205733,"utype":1}],"discussion_count":3,"race_medal":0,"score":"1586716617","product_id":100047701,"comment_content":"å†ä½¿ç”¨äºŒåˆ†æœç´¢å‡º #3 æ§½å’Œ #6 æ§½çš„ä¸­é—´ä½æ˜¯ (3+6)&#47;2=4.5 å–æ•´ 4ï¼Œ#4 æ§½å¯¹åº”çš„è®°å½•æ˜¯ 16ï¼15ï¼Œæ‰€ä»¥è®°å½•ä¸€å®šåœ¨ #4 æ§½ä¸­ï¼›<br>---<br>è¿™ä¸ªæ˜¯ä¸æ˜¯å‡ºé”™äº†ï¼Ÿåº”è¯¥æ˜¯ #3 æ§½ä¸­å§","like_count":0,"discussions":[{"author":{"id":1001470,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/47/fe/d0e25d57.jpg","nickname":"æœ±æ™”","note":"","ucode":"0B7F0BADE6AAB8","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":491571,"discussion_content":"æ²¡é”™ï¼Œæ–‡ä¸­æ²¡æœ‰è¯¦ç»†è¯´è¿™å—ï¼Œæ¯ä¸ªæ§½å¯¹åº”çš„è®°å½•æ˜¯è¯¥ç»„ä¸­ä¸»é”®å€¼æœ€å¤§çš„è®°å½•ï¼Œæ‰€ä»¥è¿˜æ˜¯#4ï¼Œç„¶åæœç´¢éœ€è¦ä»å‰ä¸€ä¸ªæ§½å¼€å§‹æœç´¢","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1586739769,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":2357964,"avatar":"https://static001.geekbang.org/account/avatar/00/23/fa/cc/d4b3ce87.jpg","nickname":"ç§ƒå¦‚å…¶æ¥","note":"","ucode":"9130CE773F31B3","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":552317,"discussion_content":"#3çš„æœ€å¤§è®°å½•åˆšå¥½å°±æ˜¯15å•Š æ°å¥½å°±å¯¹ä¸Šäº† è¿˜éœ€è¦ç»§ç»­äºŒåˆ†ä¹ˆ ä¸å¤ªæ‡‚äº†","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1645410737,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":1,"child_discussions":[{"author":{"id":1630174,"avatar":"https://static001.geekbang.org/account/avatar/00/18/df/de/8f844ff7.jpg","nickname":"å°æ•å¿«","note":"","ucode":"9B4DB5D1B9C46C","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":2357964,"avatar":"https://static001.geekbang.org/account/avatar/00/23/fa/cc/d4b3ce87.jpg","nickname":"ç§ƒå¦‚å…¶æ¥","note":"","ucode":"9130CE773F31B3","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":553864,"discussion_content":"ç¬¬ä¸€æ¬¡äºŒåˆ†æ—¶å€™å†™äº†#3æ§½æœ€å¤§å€¼æ˜¯12ï¼Œç¬¬äºŒæ¬¡å¾—åˆ°#4æ§½æœ€å¤§å€¼æ˜¯16ï¼Œ#4æ§½è®°å½•çš„å€¼16æ˜¯æœ€åä¸€ä¸ªä½ç½®ã€‚æ‰€ä»¥15åº”è¯¥åœ¨#4æ§½ã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1646121240,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":552317,"ip_address":""},"score":553864,"extra":""}]}]},{"had_liked":false,"id":197068,"user_name":"ç»ˆç»“è€…999å·","can_delete":false,"product_type":"c1","uid":1055854,"ip_address":"","ucode":"33ADE61580B6DD","user_header":"https://static001.geekbang.org/account/avatar/00/10/1c/6e/6c5f5734.jpg","comment_is_top":false,"comment_ctime":1585356233,"is_pvip":true,"discussion_count":0,"race_medal":0,"score":"1585356233","product_id":100047701,"comment_content":"è€å¸ˆçš„æ–‡ç« å¾ˆå¥½ï¼Œå› ä¸ºå¹³å¸¸éƒ½æ˜¯Oracleï¼Œæˆ‘ä»¬ä¸€èˆ¬éƒ½æ˜¯ä¸€èˆ¬è€ƒè™‘ç´¢å¼•å¤ªå¤šä¼šå ç”¨ç´¢å¼•ç©ºé—´ï¼Œè¿˜æ²¡æœ‰è€ƒè™‘åˆ°ä¸ºä»€ä¹ˆç´¢å¼•æ²¡ç”¨åˆ°","like_count":0},{"had_liked":false,"id":195462,"user_name":"å¼ ç®ç£Šæƒ³é™é™","can_delete":false,"product_type":"c1","uid":1084732,"ip_address":"","ucode":"2E582ED7BB178E","user_header":"https://static001.geekbang.org/account/avatar/00/10/8d/3c/9025c2ca.jpg","comment_is_top":false,"comment_ctime":1585189535,"is_pvip":true,"replies":[{"id":"74262","content":"å¯ä»¥çœ‹æ–‡ä¸­ã€åŸå› å¾ˆç®€å•ï¼Œè”åˆç´¢å¼•ä¸­å…¶å®ä¿å­˜äº†å¤šä¸ªç´¢å¼•åˆ—çš„å€¼ï¼Œå¯¹äºé¡µä¸­çš„è®°å½•å…ˆæŒ‰ç…§å­—æ®µ 1 æ’åºï¼Œå¦‚æœç›¸åŒå†æŒ‰ç…§å­—æ®µ 2 æ’åºï¼Œå¦‚å›¾æ‰€ç¤ºã€è¿™ä¸€æ®µä¸‹é¢çš„å›¾ï¼Œè¿˜æ˜¯ç´¢å¼•ç»“æ„çš„åŸå› ã€‚","user_name":"ä½œè€…å›å¤","user_name_real":"æœ±æ™”","uid":"1001470","ctime":1585190845,"ip_address":"","comment_id":195462,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1585189535","product_id":100047701,"comment_content":"è€å¸ˆæ‚¨å¥½ï¼Œæƒ³é—®ä¸‹è”åˆç´¢å¼•åœ¨B+treeä¸­æ˜¯æ€ä¹ˆæ’åˆ—çš„å‘¢ï¼Œä¸ºä»€ä¹ˆä¼šæœ‰æœ€ä½³å·¦å‰ç¼€æ³•åˆ™ï¼Œæ˜¯å’Œç´¢å¼•ç»“æ„æœ‰å…³å—","like_count":0,"discussions":[{"author":{"id":1001470,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/47/fe/d0e25d57.jpg","nickname":"æœ±æ™”","note":"","ucode":"0B7F0BADE6AAB8","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":489076,"discussion_content":"å¯ä»¥çœ‹æ–‡ä¸­ã€åŸå› å¾ˆç®€å•ï¼Œè”åˆç´¢å¼•ä¸­å…¶å®ä¿å­˜äº†å¤šä¸ªç´¢å¼•åˆ—çš„å€¼ï¼Œå¯¹äºé¡µä¸­çš„è®°å½•å…ˆæŒ‰ç…§å­—æ®µ 1 æ’åºï¼Œå¦‚æœç›¸åŒå†æŒ‰ç…§å­—æ®µ 2 æ’åºï¼Œå¦‚å›¾æ‰€ç¤ºã€è¿™ä¸€æ®µä¸‹é¢çš„å›¾ï¼Œè¿˜æ˜¯ç´¢å¼•ç»“æ„çš„åŸå› ã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1585190845,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":195446,"user_name":"é™ˆå¤©æŸ±","can_delete":false,"product_type":"c1","uid":1696225,"ip_address":"","ucode":"917BFDC845760D","user_header":"https://static001.geekbang.org/account/avatar/00/19/e1/e1/441df85d.jpg","comment_is_top":false,"comment_ctime":1585188658,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1585188658","product_id":100047701,"comment_content":"æˆ‘è¿™é‡Œä¹Ÿåˆ†äº«ä¸€ä¸‹æˆ‘ä¹‹å‰é‡åˆ°çš„ä¸€ä¸ªæ’åºæ²¡èµ°ç´¢å¼•çš„é—®é¢˜ï¼Œä¸çŸ¥é“å…¶ä»–äººæœ‰æ²¡æœ‰é‡åˆ°ç±»ä¼¼çš„<br>å‡è®¾æœ‰ä¸€å¼ è¡¨test, è¡¨ç»“æ„çš„DDLï¼š<br>CREATE TABLE `test` (<br>  `id` int(11) NOT NULL AUTO_INCREMENT,<br>  `a` int(11) DEFAULT NULL,<br>  `status` int(11) DEFAULT NULL,<br>  `delete_sign` int(11) DEFAULT NULL,<br>  PRIMARY KEY (`id`),<br>  KEY `idx_a` (`a`)<br>) ENGINE=InnoDB AUTO_INCREMENT=7 DEFAULT CHARSET=utf8<br>è¡¨å­—æ®µaæ˜¯ç´¢å¼•å­—æ®µï¼Œ<br>select * from test order by a; &#47;&#47; è¿™é‡Œæ’åºèµ°çš„è¿˜æ˜¯using filesortï¼Œ åŸå› è€å¸ˆæœ‰æè¿‡ï¼Œå› ä¸ºéœ€è¦èµ°å›è¡¨ï¼Œæ— æ³•ç›´æ¥åœ¨ç´¢å¼•å­—æ®µä¸Šæ’åº<br>select id, a from test order by a; &#47;&#47; è¿™é‡Œæ’åºèµ°çš„å°±æ˜¯ç´¢å¼•æ’åºï¼Œ ä¸ä¼šçœŸæ­£å»åšæ’åº<br>select id, a from test order a desc, id asc; &#47;&#47; è¿™é‡Œå°±ä¸ä¼šèµ°ç´¢å¼•æ’åºäº†ï¼Œå› ä¸ºä¸€å‡ä¸€é™ï¼Œè€Œæˆ‘ä»¬åˆ›å»ºç´¢å¼•çš„æ—¶å€™ï¼Œéƒ½æ˜¯åŒå‡æˆ–è€…åŒé™ï¼Œä¹‹å‰åœ¨ä¸€ä¸ªæ…¢æŸ¥è¯¢é‡Œæƒ³ä¼˜åŒ–æ’åºï¼Œä½†æ˜¯ä¸€å‡ä¸€é™é—®é¢˜æ— æ³•ä»ç´¢å¼•å±‚é¢ä¼˜åŒ–ï¼Œéœ€è¦ä»ä¸šåŠ¡ä¸Šå°†å«ä¹‰å€’è½¬ï¼Œå®ç°åŒå‡åŒé™æ‰èƒ½èµ°ç´¢å¼•æ’åºã€‚<br>","like_count":0},{"had_liked":false,"id":193967,"user_name":"Holly","can_delete":false,"product_type":"c1","uid":1903064,"ip_address":"","ucode":"4C09CCAB4554A5","user_header":"https://static001.geekbang.org/account/avatar/00/1d/09/d8/9bacc831.jpg","comment_is_top":false,"comment_ctime":1585008597,"is_pvip":false,"discussion_count":2,"race_medal":0,"score":"1585008597","product_id":100047701,"comment_content":"ä½ å¥½ï¼CPUæˆæœ¬è®¡ç®—ä¸ºä»€ä¹ˆæ˜¯ä¹˜ä»¥0.2","like_count":0,"discussions":[{"author":{"id":1001470,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/47/fe/d0e25d57.jpg","nickname":"æœ±æ™”","note":"","ucode":"0B7F0BADE6AAB8","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":212740,"discussion_content":"0.2æ˜¯ä¸€ä¸ªå¸¸é‡ æˆ–è€…å«æˆæœ¬å¸¸æ•°","likes_number":2,"is_delete":false,"is_hidden":false,"ctime":1585012047,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":1,"child_discussions":[{"author":{"id":1895585,"avatar":"https://static001.geekbang.org/account/avatar/00/1c/ec/a1/cfc44efe.jpg","nickname":"Geek_2ad702","note":"","ucode":"0014C0AE89FB0C","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":1001470,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/47/fe/d0e25d57.jpg","nickname":"æœ±æ™”","note":"","ucode":"0B7F0BADE6AAB8","race_medal":0,"user_type":2,"is_pvip":false},"discussion":{"id":302815,"discussion_content":"è¿™ä¸ª0.2æ˜¯æ€ä¹ˆå¾—å‡ºæ¥çš„ï¼Œä¸ºä»€ä¹ˆä¸æ˜¯0.3æˆ–å…¶ä»–æ•°ï¼Œè€Œæ˜¯0.2","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1599037201,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":212740,"ip_address":""},"score":302815,"extra":""}]}]}]}