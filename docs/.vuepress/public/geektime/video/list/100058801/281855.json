{"id":281855,"title":"11 | Flink On Yarn实操演示","content":"<p><strong>课件和Demo地址</strong><br>\n<a href=\"https://gitee.com/geektime-geekbang/geektime-Flink\">https://gitee.com/geektime-geekbang/geektime-Flink</a></p>","comments":[{"had_liked":false,"id":247120,"user_name":"lujg","can_delete":false,"product_type":"c3","uid":1054963,"ip_address":"","ucode":"6CCCD89A29B06D","user_header":"https://static001.geekbang.org/account/avatar/00/10/18/f3/cd07e64c.jpg","comment_is_top":false,"comment_ctime":1599613808,"is_pvip":false,"replies":[{"id":90841,"content":"可以这样理解","user_name":"作者回复","user_name_real":"张利兵","uid":1119779,"ctime":1599670635,"ip_address":"","comment_id":247120,"utype":1}],"discussion_count":1,"race_medal":0,"score":2,"product_id":100058801,"comment_content":"在生产环境中，flink on yarn通常是以哪种方式运行？个人感觉小数据量batch任务使用session模式会增加任务运行速率同时节省资源。而对于batch大任务还是使用per-job或者Application mode会更好一些。而流式任务使用per-job或者Application mode会好一些。","like_count":7,"discussions":[{"author":{"id":1119779,"avatar":"https://static001.geekbang.org/account/avatar/00/11/16/23/99c7ede5.jpg","nickname":"张利兵","note":"","ucode":"DBAE17970AB143","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":505315,"discussion_content":"可以这样理解","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1599670635,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":291231,"user_name":"BigData～兰兴星","can_delete":false,"product_type":"c3","uid":2275664,"ip_address":"","ucode":"2D0CF9BCFF2493","user_header":"https://static001.geekbang.org/account/avatar/00/22/b9/50/30eea9a0.jpg","comment_is_top":false,"comment_ctime":1620132509,"is_pvip":false,"replies":[{"id":106753,"content":"Vs Code","user_name":"作者回复","user_name_real":"张利兵","uid":1119779,"ctime":1621852243,"ip_address":"","comment_id":291231,"utype":1}],"discussion_count":1,"race_medal":0,"score":2,"product_id":100058801,"comment_content":"老师：在第二章11 节| flink on yarn 老师你教学演示的客户端叫什么，集成等很不错\n\n","like_count":0,"discussions":[{"author":{"id":1119779,"avatar":"https://static001.geekbang.org/account/avatar/00/11/16/23/99c7ede5.jpg","nickname":"张利兵","note":"","ucode":"DBAE17970AB143","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":519406,"discussion_content":"Vs Code","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1621852243,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":257276,"user_name":"粮忆雨","can_delete":false,"product_type":"c3","uid":2151710,"ip_address":"","ucode":"87672209F5D83D","user_header":"https://static001.geekbang.org/account/avatar/00/20/d5/1e/50bee102.jpg","comment_is_top":false,"comment_ctime":1603900103,"is_pvip":false,"replies":[{"id":94046,"content":"要看下具体的情况了，按道理应该是生效的","user_name":"作者回复","user_name_real":"张利兵","uid":1119779,"ctime":1604335239,"ip_address":"","comment_id":257276,"utype":1}],"discussion_count":1,"race_medal":0,"score":2,"product_id":100058801,"comment_content":"我部署的flink 11 on yarn，执行yarn-session.sh启动时 后面跟的-tm jm nm 等参数没生效\n","like_count":0,"discussions":[{"author":{"id":1119779,"avatar":"https://static001.geekbang.org/account/avatar/00/11/16/23/99c7ede5.jpg","nickname":"张利兵","note":"","ucode":"DBAE17970AB143","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":508280,"discussion_content":"要看下具体的情况了，按道理应该是生效的","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1604335239,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":249977,"user_name":"jasper","can_delete":false,"product_type":"c3","uid":1058086,"ip_address":"","ucode":"245404D19450E7","user_header":"https://static001.geekbang.org/account/avatar/00/10/25/26/fb664d01.jpg","comment_is_top":false,"comment_ctime":1600872316,"is_pvip":false,"replies":[{"id":93246,"content":"加油","user_name":"作者回复","user_name_real":"张利兵","uid":1119779,"ctime":1603527615,"ip_address":"","comment_id":249977,"utype":1}],"discussion_count":1,"race_medal":0,"score":2,"product_id":100058801,"comment_content":"跟着老师的脚步走","like_count":0,"discussions":[{"author":{"id":1119779,"avatar":"https://static001.geekbang.org/account/avatar/00/11/16/23/99c7ede5.jpg","nickname":"张利兵","note":"","ucode":"DBAE17970AB143","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":506082,"discussion_content":"加油","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1603527615,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":372073,"user_name":"Monologue.","can_delete":false,"product_type":"c3","uid":1716536,"ip_address":"浙江","ucode":"FD5F539632AA83","user_header":"https://static001.geekbang.org/account/avatar/00/1a/31/38/c6520e34.jpg","comment_is_top":false,"comment_ctime":1680683994,"is_pvip":false,"replies":null,"discussion_count":0,"race_medal":0,"score":2,"product_id":100058801,"comment_content":"per-job模式 一个作业好像也可以写多个execute吧 相当于提交多个作业job","like_count":0},{"had_liked":false,"id":318454,"user_name":"老A","can_delete":false,"product_type":"c3","uid":1806678,"ip_address":"","ucode":"6B3BB0851583BD","user_header":"https://static001.geekbang.org/account/avatar/00/1b/91/56/f714ad14.jpg","comment_is_top":false,"comment_ctime":1635301761,"is_pvip":false,"replies":null,"discussion_count":0,"race_medal":0,"score":2,"product_id":100058801,"comment_content":"老师，我在按照你的演示运行per job的时候，运行不成功，等了半天，然后看日志，错误是这样的\n\n2021-10-26 18:20:49,650 ERROR org.apache.flink.runtime.rpc.akka.FencedAkkaRpcActor [] - Caught exception while executing runnable in main thread.\njava.lang.IllegalStateException: The RMClient&#39;s and YarnResourceManagers internal state about the number of pending container requests for resource &lt;memory:2048, vCores:1&gt; has diverged. Number client&#39;s pending container requests 1 != Number RM&#39;s pending container requests 0.\n请问这是怎么回事，是一步一步根据你的步骤来的。","like_count":0},{"had_liked":false,"id":287439,"user_name":"杨帅","can_delete":false,"product_type":"c3","uid":1684811,"ip_address":"","ucode":"0A558B1BA62E44","user_header":"","comment_is_top":false,"comment_ctime":1617952099,"is_pvip":false,"replies":null,"discussion_count":0,"race_medal":0,"score":2,"product_id":100058801,"comment_content":"老师，您好。我想问一下，standalone 多机部署和on yarn session都有web端可以看到job运行情况，那么 per-job模式和application mode模式 有web端可以查看job运行情况吗？ 还有一个问题，on yarn session每次启动的对外web 地址都不一样，这个可以通过配置固定吗？","like_count":0},{"had_liked":false,"id":285059,"user_name":"勿更改任何信息","can_delete":false,"product_type":"c3","uid":2028956,"ip_address":"","ucode":"575185C69C05A3","user_header":"","comment_is_top":false,"comment_ctime":1616594544,"is_pvip":false,"replies":null,"discussion_count":0,"race_medal":0,"score":2,"product_id":100058801,"comment_content":"请教下老师：\n我执行命令后得到的下列错误信息，网上检索未找到相关解决方案，还不知道问题出在哪了\n\n.&#47;bin&#47;flink run .&#47;examples&#47;batch&#47;WordCount.jar --input hdfs:&#47;&#47;nameservice1:8020&#47;flink-training&#47;frostroad.txt --output hdfs:&#47;&#47;nameservice1:8020&#47;flink-training&#47;wordcount-result.txt\n\nCaused by: org.apache.hadoop.ipc.RemoteException(org.apache.hadoop.yarn.exceptions.ApplicationNotFoundException): Application with id &#39;application_1615874066610_0060&#39; doesn&#39;t exist in RM. Please check that the job submission was successful.\n\tat org.apache.hadoop.yarn.server.resourcemanager.ClientRMService.getApplicationReport(ClientRMService.java:370)\n\tat org.apache.hadoop.yarn.api.impl.pb.service.ApplicationClientProtocolPBServiceImpl.getApplicationReport(ApplicationClientProtocolPBServiceImpl.java:224)\n\tat org.apache.hadoop.yarn.proto.ApplicationClientProtocol$ApplicationClientProtocolService$2.callBlockingMethod(ApplicationClientProtocol.java:529)\n\tat org.apache.hadoop.ipc.ProtobufRpcEngine$Server$ProtoBufRpcInvoker.call(ProtobufRpcEngine.java:523)\n\tat org.apache.hadoop.ipc.RPC$Server.call(RPC.java:991)\n\tat org.apache.hadoop.ipc.Server$RpcCall.run(Server.java:870)\n\tat org.apache.hadoop.ipc.Server$RpcCall.run(Server.java:816)\n\tat java.security.AccessController.doPrivileged(Native Method)\n\tat javax.security.auth.Subject.doAs(Subject.java:422)\n\tat org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1875)\n\tat org.apache.hadoop.ipc.Server$Handler.run(Server.java:2680)\n\n\tat org.apache.hadoop.ipc.Client.getRpcResponse(Client.java:1499)\n\tat org.apache.hadoop.ipc.Client.call(Client.java:1445)\n\tat org.apache.hadoop.ipc.Client.call(Client.java:1355)\n\tat org.apache.hadoop.ipc.ProtobufRpcEngine$Invoker.invoke(ProtobufRpcEngine.java:228)\n\tat org.apache.hadoop.ipc.ProtobufRpcEngine$Invoker.invoke(ProtobufRpcEngine.java:116)\n\tat com.sun.proxy.$Proxy31.getApplicationReport(Unknown Source)\n\tat ","like_count":0},{"had_liked":false,"id":279438,"user_name":"阿哲","can_delete":false,"product_type":"c3","uid":1401452,"ip_address":"","ucode":"5ADFE1085054B6","user_header":"https://static001.geekbang.org/account/avatar/00/15/62/6c/98a69882.jpg","comment_is_top":false,"comment_ctime":1613787867,"is_pvip":false,"replies":null,"discussion_count":0,"race_medal":0,"score":2,"product_id":100058801,"comment_content":"flink on yarn模式，对于CDH集群集成flink 有相关文档吗？ ","like_count":0},{"had_liked":false,"id":279219,"user_name":"~~等","can_delete":false,"product_type":"c3","uid":1504221,"ip_address":"","ucode":"684D09B8B3D977","user_header":"https://static001.geekbang.org/account/avatar/00/16/f3/dd/9da7d90d.jpg","comment_is_top":false,"comment_ctime":1613659161,"is_pvip":false,"replies":null,"discussion_count":0,"race_medal":0,"score":2,"product_id":100058801,"comment_content":"老师，每秒100万次的流量数据，使用基于yarn的flink集群应该如何设计，目前有的资源是8核32G机器，应该搭建几台","like_count":0},{"had_liked":false,"id":277952,"user_name":"Mr.Silence","can_delete":false,"product_type":"c3","uid":1135973,"ip_address":"","ucode":"629A47952A6D18","user_header":"https://static001.geekbang.org/account/avatar/00/11/55/65/dc386be4.jpg","comment_is_top":false,"comment_ctime":1612681662,"is_pvip":false,"replies":null,"discussion_count":0,"race_medal":0,"score":3,"product_id":100058801,"comment_content":"老师，你电脑桌面用的这个工具是什么？既可以编辑文档，也可以做为一个termnal。","like_count":0},{"had_liked":false,"id":272199,"user_name":"碧雪天虹","can_delete":false,"product_type":"c3","uid":1258359,"ip_address":"","ucode":"313CC048C7E341","user_header":"https://static001.geekbang.org/account/avatar/00/13/33/77/0c593044.jpg","comment_is_top":false,"comment_ctime":1609987049,"is_pvip":false,"replies":null,"discussion_count":0,"race_medal":0,"score":3,"product_id":100058801,"comment_content":"```bash\n# 找到作业对应的ApplicationID\n$ yarn application --list\n# 指定Kill命令\n$ yarn application --kill application_1597152309776_0008\n```\n\nyarn 命令操作要有减号前缀","like_count":0}]}