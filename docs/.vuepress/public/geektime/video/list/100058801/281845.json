{"id":281845,"title":"10 | Flink On Yarn部署讲解","content":"<p><strong>课件和Demo地址</strong><br>\n<a href=\"https://gitee.com/geektime-geekbang/geektime-Flink\">https://gitee.com/geektime-geekbang/geektime-Flink</a></p>","comments":[{"had_liked":false,"id":254233,"user_name":"Radar","can_delete":false,"product_type":"c3","uid":1052758,"ip_address":"","ucode":"CEC0BA51316892","user_header":"https://static001.geekbang.org/account/avatar/00/10/10/56/3405a6b0.jpg","comment_is_top":false,"comment_ctime":1603088024,"is_pvip":false,"replies":[{"id":93247,"content":"学习的榜样","user_name":"作者回复","user_name_real":"张利兵","uid":1119779,"ctime":1603527657,"ip_address":"","comment_id":254233,"utype":1}],"discussion_count":1,"race_medal":0,"score":2,"product_id":100058801,"comment_content":" - Yarn简介\n        - ResourceManager: 资源调度，监控NodeManager，资源分配和调度\n        - NodeManager：管理单个Worker节点上的资源；处理RM，AM的命令。汇报资源状态\n        - ApplicationMaster：负责数据切分，为应用申请计算资源，任务监控与容错，运行在WOrker节点上\n        - Container：资源抽象，封装了CPU，内存\n    - Session模式\n        - Client提交Yarn App\n        - 启动Spawn Application Master\n        - Client Submit Job\n        - Dispatcher 启动Job Manager，申请Slots\n        - Start TaskManagers，Register\n        - Deploy Tasks\n    - Per-Job 模式：独享\n    - 优势：\n        - 与现有大数据平台无缝对接\n        - 部署和任务提交简单，容错借助Hadoop Yarn提供的自动failover机制\n    - 劣势：\n        - 资源隔离，网络隔离问题\n        - Kerberos超期问题导致CheckPoint无法持久化","like_count":5,"discussions":[{"author":{"id":1119779,"avatar":"https://static001.geekbang.org/account/avatar/00/11/16/23/99c7ede5.jpg","nickname":"张利兵","note":"","ucode":"DBAE17970AB143","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":507323,"discussion_content":"学习的榜样","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1603527657,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":256758,"user_name":"生活发言权","can_delete":false,"product_type":"c3","uid":1136291,"ip_address":"","ucode":"B6269BE979DF35","user_header":"https://static001.geekbang.org/account/avatar/00/11/56/a3/0141096a.jpg","comment_is_top":false,"comment_ctime":1603723411,"is_pvip":false,"replies":[{"id":93563,"content":"应该在12月全部更新完","user_name":"作者回复","user_name_real":"张利兵","uid":1119779,"ctime":1603845114,"ip_address":"","comment_id":256758,"utype":1}],"discussion_count":1,"race_medal":0,"score":2,"product_id":100058801,"comment_content":"学习中，请教一下 除了加餐内容，其他内容什么时候可以更新完，尤其是实战部分。","like_count":0,"discussions":[{"author":{"id":1119779,"avatar":"https://static001.geekbang.org/account/avatar/00/11/16/23/99c7ede5.jpg","nickname":"张利兵","note":"","ucode":"DBAE17970AB143","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":508107,"discussion_content":"应该在12月全部更新完","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1603845114,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":246269,"user_name":"白开水","can_delete":false,"product_type":"c3","uid":1725387,"ip_address":"","ucode":"0300AB319468D3","user_header":"http://thirdwx.qlogo.cn/mmopen/vi_32/yb5R8iaxicD8tROw24eqlC8icMLSz4UeMnebgXASYV8lLahzpaeiapqZkM3oAw55zPBR84KeRQ0ILQHmv3pmibuicxGg/132","comment_is_top":false,"comment_ctime":1599233836,"is_pvip":false,"replies":[{"id":90843,"content":"加油","user_name":"作者回复","user_name_real":"张利兵","uid":1119779,"ctime":1599670692,"ip_address":"","comment_id":246269,"utype":1}],"discussion_count":1,"race_medal":0,"score":2,"product_id":100058801,"comment_content":"学习中！！！","like_count":0,"discussions":[{"author":{"id":1119779,"avatar":"https://static001.geekbang.org/account/avatar/00/11/16/23/99c7ede5.jpg","nickname":"张利兵","note":"","ucode":"DBAE17970AB143","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":505097,"discussion_content":"加油","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1599670692,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":261628,"user_name":"geek","can_delete":false,"product_type":"c3","uid":1234974,"ip_address":"","ucode":"BF9406F6ABDB7B","user_header":"https://static001.geekbang.org/account/avatar/00/12/d8/1e/985d5363.jpg","comment_is_top":false,"comment_ctime":1605450045,"is_pvip":false,"replies":null,"discussion_count":5,"race_medal":0,"score":2,"product_id":100058801,"comment_content":"老师好，有个矛盾的点请教一下，因为评论不能截图，我简单描述一下：\n07章PPT -&gt; Session集群运行模式 -&gt; 图中Deployer了三个Job，共用了一个JobManager\n10章PPT(本节) -&gt; Flink On Yarn 集群部署 - Session 模式 -&gt; 图中第9步submit了Job B，为什么又启动了一个JobManager B？","like_count":1,"discussions":[{"author":{"id":1751214,"avatar":"https://static001.geekbang.org/account/avatar/00/1a/b8/ae/085484e7.jpg","nickname":"Insomnia","note":"","ucode":"5986A48988D6E3","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":340148,"discussion_content":"Session 集群运行模式只是一个设计架构的理念图, 实际在 Yarn上的 Session 模式, 在 job 提交之前就已经拉起了一个 AM 进程, 多个 Job 共用的就是这个 flink-AM (这是一个 yarn AM接口的具体实现, 可以去了解下 yarn 任务开发, 这个就相当于设计理念里的 JM, 其内部就包含了 Dispatcher 和 RM), 而负责每个 Job 的资源申请的就是各个 Job 自己的 JobManager, 他们共用的是 flink-AM 已经向集群申请的资源, 这部分资源即使在 job 执行完成后也不会被释放. 而 yarn per-job 模式是需要提交任务后才拉起这个 flink-AM 进程的, 并且这个进程是该 job 独享的, 进程生命周期和 job 是绑定的.","likes_number":4,"is_delete":false,"is_hidden":false,"ctime":1609916624,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"","child_discussion_number":2,"child_discussions":[{"author":{"id":3161518,"avatar":"","nickname":"李晓琪","note":"","ucode":"D82D5E16B6DB1E","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":1751214,"avatar":"https://static001.geekbang.org/account/avatar/00/1a/b8/ae/085484e7.jpg","nickname":"Insomnia","note":"","ucode":"5986A48988D6E3","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":586039,"discussion_content":"懂了，谢谢大神！就是说，flink on yarn 的JM和flink集群的JM就不是一个意思","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1661944469,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":340148,"ip_address":"北京","group_id":0},"score":586039,"extra":""},{"author":{"id":3161518,"avatar":"","nickname":"李晓琪","note":"","ucode":"D82D5E16B6DB1E","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":1751214,"avatar":"https://static001.geekbang.org/account/avatar/00/1a/b8/ae/085484e7.jpg","nickname":"Insomnia","note":"","ucode":"5986A48988D6E3","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":586040,"discussion_content":"那yarn per-job 模式里，会有多个AM进程同时运行吗","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1661944599,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":340148,"ip_address":"北京","group_id":0},"score":586040,"extra":""}]},{"author":{"id":2390265,"avatar":"https://static001.geekbang.org/account/avatar/00/24/78/f9/fab2f726.jpg","nickname":"醉月竹影","note":"","ucode":"48849A20A9091E","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":337628,"discussion_content":"同问\n","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1608993875,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":2288789,"avatar":"","nickname":"cqfan12","note":"","ucode":"24E3417A64E74C","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":331055,"discussion_content":"同问","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1606755108,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":319989,"user_name":"强","can_delete":false,"product_type":"c3","uid":1035643,"ip_address":"","ucode":"D0A761E25B0740","user_header":"https://static001.geekbang.org/account/avatar/00/0f/cd/7b/31a6bf42.jpg","comment_is_top":false,"comment_ctime":1636028509,"is_pvip":false,"replies":null,"discussion_count":0,"race_medal":0,"score":2,"product_id":100058801,"comment_content":"老师,我看大纲没有join相关原理的讲解吧？","like_count":0}]}