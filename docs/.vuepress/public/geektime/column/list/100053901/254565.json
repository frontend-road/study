{"id":254565,"title":"01 | OAuth 2.0是要通过什么方式解决什么问题？","content":"<p>你好，我是王新栋。</p><p>在课程正式开始之前，我想先问你个问题。第一次使用极客时间App的时候，你是直接使用了第三方帐号（比如微信、微博）登录，还是选择了重新注册新用户？如果你选择了重新注册用户，那你还得上传头像、输入用户名等信息。但如果你选择了使用第三方帐号微信来登录，那极客时间会直接使用你微信的这些信息作为基础信息，你就能省心很多。</p><p>到这里，我估计你会问，这是怎么实现的？微信把我的个人信息给了极客时间，它又是怎么保证我的数据安全的呢？</p><p>其实，微信这一系列授权背后的原理都可以归到一个词上，那就是OAuth 2.0。今天这节课，我们就来看看OAuth 2.0到底是什么、能干什么以及它是怎么干的。</p><h2>OAuth 2.0是什么？</h2><p>用一句话总结来说，OAuth 2.0就是一种授权协议。那如何理解这里的“授权”呢？</p><p>我举个咱们生活中的例子。假如你是一名销售人员，你想去百度拜访你的大客户王总。到了百度的大楼之后，保安拦住了你，问你要工牌。你说：“保安大哥啊，我是来拜访王总的，哪里有什么工牌”。保安大哥说：“那你要去前台做个登记”。</p><p>然后你就赶紧来到前台，前台美女问你是不是做了登记。你说王总秘书昨天有要你的手机号，说是已经做过预约。小姐姐确认之后往你的手机发了个验证码，你把验证码告诉了前台小姐姐之后，她给了你一张门禁卡，于是你就可以开心地去见王总了。</p><!-- [[[read_end]]] --><p>你看，这个例子里面就有一次授权。本来你是没有权限进入百度大楼的，但是经过前台小姐姐一系列的验证之后，她发现你确实是来拜访客户的，于是给了你一张临时工牌。这整个过程就是授权。</p><p>我再举一个电商的场景，你估计更有感觉。假如你是一个卖家，在京东商城开了一个店铺，日常运营中你要将订单打印出来以便给用户发货。但打印这事儿也挺繁琐的，之前你总是手工操作，后来发现有个叫“小兔”的第三方软件，它可以帮你高效率地处理这事。</p><p>但你想想，小兔是怎么访问到这些订单数据的呢？其实是这样，京东商城提供了开放平台，小兔通过京东商家开放平台的API就能访问到用户的订单数据。</p><p>只要你在软件里点击同意，小兔就可以拿到一个访问令牌，通过访问令牌来获取到你的订单数据帮你干活儿了。你看，这里也是有一次授权。你要是不同意，平台肯定不敢把这些数据给到第三方软件。</p><h2>为什么用OAuth 2.0？</h2><p>基于上面两种场景的解决方案，关于授权我们最容易想到的方案就是提供钥匙。比如，你要去百度拜访王总，那前台小姐姐就给你张百度的工牌；小兔要获取你的订单信息，那你就把你的用户名和密码给它。但稍微有些安全意识，我们都不会这样做。</p><p>因为你有了百度工牌，那以后都可以随时自由地进出了，这显然不是百度想要的。所以，百度有一套完整的机制，通过给你一张临时工牌，实现在保证安全的情况下，还能让你去大楼里面见到王总。相应地，小兔软件请求访问你的订单数据的过程，也会涉及这样一套授权机制，那就是OAuth 2.0。它通过给小兔软件一个访问令牌，而不是让小兔软件拿着你的用户名和密码，去获取你的订单数据帮你干活儿。</p><p>其实，除了小兔软件这个场景，在如今的互联网世界里用到OAuth 2.0的地方非常多，只是因为它隐藏了实现细节，需要我们多做分析才能发现它。比如，当你使用微信登录其他网站或者App的时候，当你开始使用某个小程序的时候，你都在无感知的情况下用到了OAuth 2.0。</p><p>那总结来说，<strong>OAuth 2.0这种授权协议，就是保证第三方（软件）只有在获得授权之后，才可以进一步访问授权者的数据</strong>。因此，我们常常还会听到一种说法，OAuth 2.0是一种安全协议。现在你知道了，这种说法也是正确的。</p><p>现在访问授权者的数据主要是通过Web API，所以凡是要保护这种对外的API时，都需要这样授权的方式。而OAuth 2.0的这种颁发访问令牌的机制，是再合适不过的方法了。同时，这样的Web API还在持续增加，所以OAuth 2.0是目前Web上重要的安全手段之一了。</p><h2>OAuth 2.0是怎样运转的？</h2><p>现在，我相信你已经对OAuth 2.0有了一个整体印象，接下来咱们再看看它是怎么运转的。</p><p>我们还是来看上面提到的小兔打单软件的例子吧。假如小明在京东上面开了一个店铺，小明要管理他的店铺里面的订单，于是选择了使用小兔软件。</p><p>现在，让我们把“小明”“小兔软件”“京东商家开放平台”放到一个对话里面，看看“他们”是怎么沟通的吧。</p><p><strong>小明</strong>：“你好，小兔软件。我正在Google浏览器上面，需要访问你来帮我处理我在京东商城店铺的订单。”</p><p><strong>小兔软件</strong>：“好的，小明，我需要你给我授权。现在我把你引导到京东商家开放平台上，你在那里给我授权吧。”</p><p><strong>京东商家开放平台</strong>：“你好，小明。我收到了小兔软件跳转过来的请求，现在已经准备好了一个授权页面。你登录并确认后，点击授权页面上面的授权按钮即可。”</p><p><strong>小明</strong>：“好的，京东商家开放平台。我看到了这个授权页面，已经点授权按钮啦😄”</p><p><strong>京东商家开放平台</strong>：“你好，小兔打单软件。我收到了小明的授权，现在要给你生成一个授权码code值，我通过浏览器重定向到你的回调URL地址上面了。”</p><p><strong>小兔软件</strong>：“好的，京东商家开放平台。我现在从浏览器上拿到了授权码，现在就用这个授权码来请求你，请给我一个访问令牌access_token吧。”</p><p><strong>京东商家开放平台</strong>：“好的，小兔打单软件，访问令牌已经发送给你了。”</p><p><strong>小兔打单软件</strong>：“太好了，我现在就可以使用访问令牌来获取小明店铺的订单了。”</p><p><strong>小明</strong>：“我已经能够看到我的订单了，现在就开始打单操作了。”</p><p>下面，为了帮助你理解，我再用一张图来描述整个过程：</p><p><img src=\"https://static001.geekbang.org/resource/image/77/79/77197844a8f41a33cb68947b1dc9ee79.png?wh=1564*1118\" alt=\"\" title=\"小明使用小兔软件打印订单的整体流程\"></p><p>再分析下这个流程，我们不难发现小兔软件最终的目的，是要获取一个叫做“访问令牌”的东西。从最后一步也能够看出来，在小兔软件获取到<strong>访问令牌</strong>之后，才有足够的 “能力” 去请求小明的店铺的订单，也就是才能够帮助小明打印订单。</p><p>那么，小兔软件是怎么获取访问令牌的值的呢？我们会发现还有一个叫做“授权码”的东西，也就是说小兔软件是拿<strong>授权码换取的访问令牌</strong>。</p><p>小兔软件又是怎么拿到<strong>授权码</strong>的呢？从图中流程刚开始的那一步，我们就会发现，是在小明授权之后，才产生的授权码，上面流程中后续的一切动作，实际上都是在小明对小兔软件授权发生以后才产生的。其中主要的动作，就是生成授权码–&gt;生成访问令牌–&gt;使用访问令牌。</p><p>到这里，我们不难发现，<strong>OAuth 2.0 授权的核心就是颁发访问令牌、使用访问令牌，</strong>而且不管是哪种类型的授权流程都是这样。你一定要理解，或者记住这句话，它是整个流程的核心。你也可以再回想下，去百度拜访王总的例子。如果你是百度这套机制的设计者的话，会怎么设计这套授权机制呢。想清楚了这个问题，你再去理解令牌、授权码啥的也就简单了。</p><p>在小兔软件这个例子中呢，我们使用的就是授权码许可（Authorization Code）类型。它是OAuth 2.0中最经典、最完备、最安全、应用最广泛的许可类型。除了授权码许可类型外，OAuth 2.0针对不同的使用场景，还有3种基础的许可类型，分别是隐式许可（Implicit）、客户端凭据许可（Client Credentials）、资源拥有者凭据许可（Resource Owner Password Credentials）。相对而言，这3种授权许可类型的流程，在流程复杂度和安全性上都有所减弱（我会在第6讲，与你详细分析）。</p><p>因此，在这个课程中，我会频繁用授权码许可类型来举例。至于为什么称它为授权码许可，为什么有两次重定向，以及这种许可类型更详细的通信流程又是怎样的，我会在第2讲给你深入分析，你可以先不用关注。</p><h2>总结</h2><p>好了，今天这节课就到这里。这节课咱们知识点不多，我来回给你举例子，其实就是希望你能理解OAuth到底是什么，为什么需要它，以及它大概的运行逻辑是怎样的。总结来说，我需要你记住以下这3个关键点：</p><ol>\n<li>\n<p>OAuth 2.0的核心是授权许可，更进一步说就是令牌机制。也就是说，像小兔软件这样的第三方软件只有拿到了京东商家开放平台颁发的访问令牌，也就是得到了授权许可，然后才可以<strong>代表</strong>用户访问他们的数据。</p>\n</li>\n<li>\n<p>互联网中所有的受保护资源，几乎都是以Web API的形式来提供访问的，比如极客时间App要获取用户的头像、昵称，小兔软件要获取用户的店铺订单，我们说OAuth 2.0与安全相关，是用来保护Web API的。另外，第三方软件通过OAuth 2.0取得访问权限之后，用户便把这些权限<strong>委托</strong>给了第三方软件，我们说OAuth 2.0是一种委托协议，也没问题。</p>\n</li>\n<li>\n<p>也正因为像小兔这样的第三方软件，每次都是用访问令牌而不是用户名和密码来请求用户的数据，才大大减少了安全风险上的“攻击面”。不然，我们试想一下，每次都带着用户名和密码来访问数量众多的Web API ，是不是增加了这个“攻击面”。因此，我们说OAuth 2.0的核心，就是颁发访问令牌和使用访问令牌。</p>\n</li>\n</ol><h2>思考题</h2><p>好了，今天这一讲我们马上要结束了，我给你留个思考题。</p><p>你可以再花时间想下小兔软件获取用户订单信息的那个场景，如果让你来设计整个的授权流程，你会怎么设计？还有没有更好的方式？</p><p>欢迎你在留言区分享你的观点，也欢迎你把今天的内容分享给其他朋友，我们一起交流。</p>","comments":[{"had_liked":false,"id":230629,"user_name":"inrtyx","can_delete":false,"product_type":"c1","uid":1246178,"ip_address":"","ucode":"81CD18FF34ABAB","user_header":"https://static001.geekbang.org/account/avatar/00/13/03/e2/5768d26e.jpg","comment_is_top":false,"comment_ctime":1593435917,"is_pvip":true,"replies":[{"id":"85142","content":"直接获取token的场景是有的，客户端凭据许可类型就是这样的使用场景，但是我们会在课程里面讲到，授权码许可类型是OAuth 2.0 最安全 最完备的许可类型。<br><br>以Web场景为例，第一次用户是跟第三方软件建立的“联系”，三方软件要把用户引导到平台一方去授权，这个时候用户实际上跟三方软件就失去了“联系”，平台如果这个时候直接把令牌给了三方软件，因为没了“联系”，三方软件就不能很方便的告诉用户。<br><br>关于这块更详细的内容在后面课程会着重讲到。","user_name":"作者回复","user_name_real":"王新栋","uid":"1352303","ctime":1593445143,"ip_address":"","comment_id":230629,"utype":1}],"discussion_count":14,"race_medal":0,"score":"169097160461","product_id":100053901,"comment_content":"为什么要用授权码换取token，而不是直接获取token？<br>？","like_count":40,"discussions":[{"author":{"id":1809168,"avatar":"","nickname":"Geek_7c4953","note":"","ucode":"359745D4725D4F","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":287572,"discussion_content":"一般code是给客户端的，比如通过web跳转传回来，这个时候code就是暴露的。当然也有类似JS直接获取的，同样也是暴露的。所以code是不安全的，有效时间也会很短。而code换取的token往往是服务端之间的通讯，是保密且比较长时间有效的。\n另一方面，token是用户与授权方交互才能直接给出的，如果第三方要直接获取token，说明用户跟授权方的交互要委托给第三方。比如你的用户名密码要给到第三方，第三方再跟授权方换取token，这里就向第三方暴露了用户的机密。","likes_number":23,"is_delete":false,"is_hidden":false,"ctime":1593484192,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":3,"child_discussions":[{"author":{"id":1246178,"avatar":"https://static001.geekbang.org/account/avatar/00/13/03/e2/5768d26e.jpg","nickname":"inrtyx","note":"","ucode":"81CD18FF34ABAB","race_medal":0,"user_type":1,"is_pvip":true},"reply_author":{"id":1809168,"avatar":"","nickname":"Geek_7c4953","note":"","ucode":"359745D4725D4F","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":287720,"discussion_content":"谢谢指点，明白了","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1593520465,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":287572,"ip_address":""},"score":287720,"extra":""},{"author":{"id":1269832,"avatar":"http://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTJman25D8JlricJVaeweYqr70vyp2acetStqbtaDnCnroGXvuJfgr1As9q47iacTCUUMK1eRUt4KImg/132","nickname":"进阶的小孔","note":"","ucode":"71E88AE4EFDBF2","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":1809168,"avatar":"","nickname":"Geek_7c4953","note":"","ucode":"359745D4725D4F","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":293553,"discussion_content":"说的对","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1595579505,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":287572,"ip_address":""},"score":293553,"extra":""},{"author":{"id":1451509,"avatar":"http://thirdwx.qlogo.cn/mmopen/vi_32/P5EIPG3R01lW2MG1HfcPUDLKajMy7BGg8rKn5dKDbdrCreIwabwJ1RqWOJMVKqAusLaf7Y0Utomibp6ibxajflvQ/132","nickname":"我要放大🐂","note":"","ucode":"B280A95E02E7C1","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":1809168,"avatar":"","nickname":"Geek_7c4953","note":"","ucode":"359745D4725D4F","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":579898,"discussion_content":"那如果直接提供一个回调接口来接收token呢？","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1657763826,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":287572,"ip_address":""},"score":579898,"extra":""}]},{"author":{"id":1119490,"avatar":"https://static001.geekbang.org/account/avatar/00/11/15/02/66f65388.jpg","nickname":"雷霹雳的爸爸","note":"","ucode":"99BBA6D83DD11F","race_medal":0,"user_type":1,"is_pvip":true},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":290255,"discussion_content":"兄弟这留言简直就是捧哏的标准动作","likes_number":5,"is_delete":false,"is_hidden":false,"ctime":1594390412,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1352303,"avatar":"https://static001.geekbang.org/account/avatar/00/14/a2/6f/d239ed80.jpg","nickname":"王新栋","note":"","ucode":"0A5D089B8E1E9D","race_medal":0,"user_type":2,"is_pvip":true},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":499967,"discussion_content":"直接获取token的场景是有的，客户端凭据许可类型就是这样的使用场景，但是我们会在课程里面讲到，授权码许可类型是OAuth 2.0 最安全 最完备的许可类型。\n\n以Web场景为例，第一次用户是跟第三方软件建立的“联系”，三方软件要把用户引导到平台一方去授权，这个时候用户实际上跟三方软件就失去了“联系”，平台如果这个时候直接把令牌给了三方软件，因为没了“联系”，三方软件就不能很方便的告诉用户。\n\n关于这块更详细的内容在后面课程会着重讲到。","likes_number":1,"is_delete":false,"is_hidden":false,"ctime":1593445143,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1256405,"avatar":"https://static001.geekbang.org/account/avatar/00/13/2b/d5/77ee608e.jpg","nickname":"fenghaiju","note":"","ucode":"A251DC262A2AB2","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":311967,"discussion_content":"授权码模式是几种模式中最安全的，拿到code后，三方内部还要根据自己项目标识密钥请求，才能拿到token","likes_number":1,"is_delete":false,"is_hidden":false,"ctime":1602553354,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":2275516,"avatar":"https://static001.geekbang.org/account/avatar/00/22/b8/bc/d2d547c9.jpg","nickname":"成为优秀的程序员","note":"","ucode":"6D9080A2B225AE","race_medal":0,"user_type":1,"is_pvip":true},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":590697,"discussion_content":"问了我想问的","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1666013788,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":"广东"},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":2220763,"avatar":"https://static001.geekbang.org/account/avatar/00/21/e2/db/97c6f756.jpg","nickname":"_patrick","note":"","ucode":"B24C6EEBCABB94","race_medal":0,"user_type":1,"is_pvip":true},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":585009,"discussion_content":"假设小兔提供了两种方式登录小兔软件：1、小兔软件自己的用户名密码 2、通过京东账号登录小兔软件。    你现在用的是2这种方式，如果用1就可以直接获取token.   1和2对应的场景又不同了，2可以获取用户在京东的某些信息， 而1可能需要再去绑定京东账号。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1661268011,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":"浙江"},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1759325,"avatar":"https://static001.geekbang.org/account/avatar/00/1a/d8/5d/07dfb3b5.jpg","nickname":"杯莫停","note":"","ucode":"4FA1D5CBBEF702","race_medal":0,"user_type":1,"is_pvip":true},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":360636,"discussion_content":"token是会过期的，如果没有授权码你拿什么去要新的token呢，平台总不会随便调个接口就让你你拿到token吧。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1616495725,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":2,"child_discussions":[{"author":{"id":1183518,"avatar":"https://static001.geekbang.org/account/avatar/00/12/0f/1e/6b6eb987.jpg","nickname":"我们在路上","note":"","ucode":"0DB77DB7C64C47","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":1759325,"avatar":"https://static001.geekbang.org/account/avatar/00/1a/d8/5d/07dfb3b5.jpg","nickname":"杯莫停","note":"","ucode":"4FA1D5CBBEF702","race_medal":0,"user_type":1,"is_pvip":true},"discussion":{"id":374938,"discussion_content":"对接过微信公众号的话，你就能理解了：资源服务器会给你分配client_id和client_secret，你可以一直使用这两个参数去获取新的token","likes_number":1,"is_delete":false,"is_hidden":false,"ctime":1621416076,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":360636,"ip_address":""},"score":374938,"extra":""},{"author":{"id":1811495,"avatar":"https://static001.geekbang.org/account/avatar/00/1b/a4/27/15e75982.jpg","nickname":"小袁","note":"","ucode":"3F5D8721F577D9","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":1759325,"avatar":"https://static001.geekbang.org/account/avatar/00/1a/d8/5d/07dfb3b5.jpg","nickname":"杯莫停","note":"","ucode":"4FA1D5CBBEF702","race_medal":0,"user_type":1,"is_pvip":true},"discussion":{"id":379982,"discussion_content":"其实你没理解问题。为什么不能把授权码当成token使用，也会过期，也能刷新。为什么不能随便拿到token呢？难道授权码不也是随便拿到的么？其实我也有类似疑问，为什么不能一步返回token，减少交互次数。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1624268604,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":360636,"ip_address":""},"score":379982,"extra":""}]},{"author":{"id":1079495,"avatar":"https://static001.geekbang.org/account/avatar/00/10/78/c7/083a3a0b.jpg","nickname":"新世界","note":"","ucode":"4473DC1505F158","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":342114,"discussion_content":"code是中间的一个跳板，如果每次用户认证以后给token，token一般是有有效期的，有效期过期了，会需要code继续授权颁发新的token，如果直接认证以后给token，token过期以后还需要用户反复交互授权，通过code 获取token能够有效减少用户和第三方的交互，更合理","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1610595819,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":1,"child_discussions":[{"author":{"id":1183518,"avatar":"https://static001.geekbang.org/account/avatar/00/12/0f/1e/6b6eb987.jpg","nickname":"我们在路上","note":"","ucode":"0DB77DB7C64C47","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":1079495,"avatar":"https://static001.geekbang.org/account/avatar/00/10/78/c7/083a3a0b.jpg","nickname":"新世界","note":"","ucode":"4473DC1505F158","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":374944,"discussion_content":"code是一次性的，后续是通过refreshToken续约的","likes_number":2,"is_delete":false,"is_hidden":false,"ctime":1621416350,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":342114,"ip_address":""},"score":374944,"extra":""}]}]},{"had_liked":false,"id":230918,"user_name":"Geek_aceb32","can_delete":false,"product_type":"c1","uid":1070442,"ip_address":"","ucode":"28FDDECC233708","user_header":"https://static001.geekbang.org/account/avatar/00/10/55/6a/b7f3abb0.jpg","comment_is_top":false,"comment_ctime":1593522750,"is_pvip":false,"replies":[{"id":"85739","content":"第三方应用在官方平台上注册的时候是要签订协议的，你说的这点就属于监守自盗了，只能靠法律法规来惩治。<br>另外，授权服务做登录的时候，当前一般都是采用App扫码登录，只要培养了用户这样的习惯，也能规避一大部分风险发生的概率。","user_name":"作者回复","user_name_real":"王新栋","uid":"1352303","ctime":1593960882,"ip_address":"","comment_id":230918,"utype":1}],"discussion_count":6,"race_medal":0,"score":"70312999486","product_id":100053901,"comment_content":"我有个疑问，小兔把客户引导到京东开放平台上，如果小兔是恶意的，做了一个和京东一样的网页让用户授权，一般用户难以仔细区分，小兔不就能拿到用户的密码了吗？","like_count":16,"discussions":[{"author":{"id":1352303,"avatar":"https://static001.geekbang.org/account/avatar/00/14/a2/6f/d239ed80.jpg","nickname":"王新栋","note":"","ucode":"0A5D089B8E1E9D","race_medal":0,"user_type":2,"is_pvip":true},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":500074,"discussion_content":"第三方应用在官方平台上注册的时候是要签订协议的，你说的这点就属于监守自盗了，只能靠法律法规来惩治。\n另外，授权服务做登录的时候，当前一般都是采用App扫码登录，只要培养了用户这样的习惯，也能规避一大部分风险发生的概率。","likes_number":1,"is_delete":false,"is_hidden":false,"ctime":1593960882,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":2220763,"avatar":"https://static001.geekbang.org/account/avatar/00/21/e2/db/97c6f756.jpg","nickname":"_patrick","note":"","ucode":"B24C6EEBCABB94","race_medal":0,"user_type":1,"is_pvip":true},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":585010,"discussion_content":"你这样跟京东也没关系，除了小兔 ，谁都可以去做一个京东的假页面 钓鱼。  ","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1661268308,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":"浙江"},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1114999,"avatar":"https://static001.geekbang.org/account/avatar/00/11/03/77/3f6a76a9.jpg","nickname":"极客","note":"","ucode":"A4AAA6B4F40E66","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":324895,"discussion_content":"扫码登录","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1605187540,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1033219,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/c4/03/f753fda7.jpg","nickname":"JianXu","note":"","ucode":"2A61BDBB573BDC","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":311557,"discussion_content":"我突然觉得这个问题很严重的，很多软件或者网站都可以在自己的主页上做钓鱼，骗取微信的登陆信息啊。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1602399465,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":2,"child_discussions":[{"author":{"id":2694146,"avatar":"https://static001.geekbang.org/account/avatar/00/29/1c/02/5aa8b087.jpg","nickname":"Wayne👿","note":"","ucode":"A8AD5481052D9F","race_medal":1,"user_type":1,"is_pvip":false},"reply_author":{"id":1033219,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/c4/03/f753fda7.jpg","nickname":"JianXu","note":"","ucode":"2A61BDBB573BDC","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":550298,"discussion_content":"不是随便一个网站或者公司，都能接入微信的第三方登录，必须先向微信进行申请，微信会对其进行资格验证。然后加入到白名单，只有这些白名单的公司才能使用微信的第三方登录。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1644477874,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":311557,"ip_address":""},"score":550298,"extra":""},{"author":{"id":3024820,"avatar":"https://static001.geekbang.org/account/avatar/00/2e/27/b4/df65c0f7.jpg","nickname":"| ~浑蛋~","note":"","ucode":"B6904B44DFA805","race_medal":1,"user_type":1,"is_pvip":true},"reply_author":{"id":2694146,"avatar":"https://static001.geekbang.org/account/avatar/00/29/1c/02/5aa8b087.jpg","nickname":"Wayne👿","note":"","ucode":"A8AD5481052D9F","race_medal":1,"user_type":1,"is_pvip":false},"discussion":{"id":580961,"discussion_content":"不向微信申请，直接伪造微信网页登录界面，也能骗到小白","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1658418829,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":550298,"ip_address":""},"score":580961,"extra":""}]}]},{"had_liked":false,"id":230593,"user_name":"gavin","can_delete":false,"product_type":"c1","uid":1049858,"ip_address":"","ucode":"6765F7ACF8C508","user_header":"https://static001.geekbang.org/account/avatar/00/10/05/02/52a52265.jpg","comment_is_top":false,"comment_ctime":1593424488,"is_pvip":true,"replies":[{"id":"85279","content":"理解的很详细，我分别补充一些：<br>1、Implicit模式相当于是一个“裸”的状态，当然OAuth 2.0 是建议要通信在HTTPS的环境下，四种授权模式中最安全的就是授权码许可，令牌端点的通信是通过后端通信；<br>2、这里你说的“访问凭据”就是指TOKEN了，TOKEN和SCOPE的映射关系会在授权服务一侧保存；","user_name":"作者回复","user_name_real":"王新栋","uid":"1352303","ctime":1593525881,"ip_address":"","comment_id":230593,"utype":1}],"discussion_count":2,"race_medal":0,"score":"53133032040","product_id":100053901,"comment_content":"这里的授权服务和受保护资源服务都是京东商家开放平台（不过应该是对应授权服务和订单服务）、客户端（第三方软件）对应的是小兔软件、资源的拥有者小明通过OAuth2.0的授权码模式授权后，小兔软件可以访问对应的订单，这里有两个点，需要老师给指点一下是否理解的正确：<br>1. 授权码模式我一直理解其比Implicit模式的安全性主要体现在，其访问令牌是基于再次的https请求的返回值，是加密传递的，而Implicit模式的授权码是get请求参数跳转返回的，所以安全性不高。<br>2. OAuth2.0的授权是基于scope实现的，一个scope值会对应一些可以访问的资源，在小兔软件请求获取授权时，要声明对应scope，小明在授权页面上能够清楚的看到授权的scope是什么，对应的返回的访问凭据也应该包含scope信息。<br>而且凭据中也包含了小明的身份信息，这样最终授权访问的就是scope对应的小明的相关资源。","like_count":12,"discussions":[{"author":{"id":1352303,"avatar":"https://static001.geekbang.org/account/avatar/00/14/a2/6f/d239ed80.jpg","nickname":"王新栋","note":"","ucode":"0A5D089B8E1E9D","race_medal":0,"user_type":2,"is_pvip":true},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":499951,"discussion_content":"理解的很详细，我分别补充一些：\n1、Implicit模式相当于是一个“裸”的状态，当然OAuth 2.0 是建议要通信在HTTPS的环境下，四种授权模式中最安全的就是授权码许可，令牌端点的通信是通过后端通信；\n2、这里你说的“访问凭据”就是指TOKEN了，TOKEN和SCOPE的映射关系会在授权服务一侧保存；","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1593525881,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":2608728,"avatar":"https://static001.geekbang.org/account/avatar/00/27/ce/58/71ed845f.jpg","nickname":"Dexter","note":"","ucode":"909CABC4AC4AC9","race_medal":0,"user_type":1,"is_pvip":true},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":584892,"discussion_content":"访问令牌和scope","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1661209416,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":"浙江"},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":230605,"user_name":"Jaswine","can_delete":false,"product_type":"c1","uid":1243370,"ip_address":"","ucode":"EE39D9629204DB","user_header":"https://static001.geekbang.org/account/avatar/00/12/f8/ea/98738420.jpg","comment_is_top":false,"comment_ctime":1593426755,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"40248132419","product_id":100053901,"comment_content":"访问百度的案例中有以下角色:我（client），前台王小姐（百度的授权、鉴权服务），大客户王总（资源），百度（资源所在的服务器）。","like_count":9},{"had_liked":false,"id":238935,"user_name":"Edison鹏","can_delete":false,"product_type":"c1","uid":2103222,"ip_address":"","ucode":"62E10D50565DC8","user_header":"https://static001.geekbang.org/account/avatar/00/20/17/b6/ac21f221.jpg","comment_is_top":false,"comment_ctime":1596375355,"is_pvip":false,"replies":[{"id":"88265","content":"第三方软件能够拿到token的前提是，用户必须授权，用户授权的前提是，用户必须先登录。","user_name":"作者回复","user_name_real":"王新栋","uid":"1352303","ctime":1596415554,"ip_address":"","comment_id":238935,"utype":1}],"discussion_count":1,"race_medal":0,"score":"23071211835","product_id":100053901,"comment_content":"我的理解：1.通过第三方应用授权通过拿到的token和用户主动登录开放平台所获得的token是两个独立的token？","like_count":5,"discussions":[{"author":{"id":1352303,"avatar":"https://static001.geekbang.org/account/avatar/00/14/a2/6f/d239ed80.jpg","nickname":"王新栋","note":"","ucode":"0A5D089B8E1E9D","race_medal":0,"user_type":2,"is_pvip":true},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":502901,"discussion_content":"第三方软件能够拿到token的前提是，用户必须授权，用户授权的前提是，用户必须先登录。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1596415554,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":231595,"user_name":"宝宝太喜欢极客时间了","can_delete":false,"product_type":"c1","uid":1215152,"ip_address":"","ucode":"9CDB679C257612","user_header":"http://thirdwx.qlogo.cn/mmopen/vi_32/DYAIOgq83eoOGZ6lbHiboIZMN9USbeutnmCWBahVLtSlKlIENKvrZQCUQzpzeZQOxTntIkBUeDk6qZUPdqmfKrQ/132","comment_is_top":false,"comment_ctime":1593734881,"is_pvip":false,"replies":[{"id":"85535","content":"前者是授权，后者是认证，后面我们会详细讲，授权和认证的区别，在这里我先提前说一下：OAuth 2.0 是授权协议，不是身份认证协议。","user_name":"作者回复","user_name_real":"王新栋","uid":"1352303","ctime":1593755418,"ip_address":"","comment_id":231595,"utype":1}],"discussion_count":1,"race_medal":0,"score":"23068571361","product_id":100053901,"comment_content":"令牌跟sessionId有什么本质区别？","like_count":5,"discussions":[{"author":{"id":1352303,"avatar":"https://static001.geekbang.org/account/avatar/00/14/a2/6f/d239ed80.jpg","nickname":"王新栋","note":"","ucode":"0A5D089B8E1E9D","race_medal":0,"user_type":2,"is_pvip":true},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":500362,"discussion_content":"前者是授权，后者是认证，后面我们会详细讲，授权和认证的区别，在这里我先提前说一下：OAuth 2.0 是授权协议，不是身份认证协议。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1593755418,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":230651,"user_name":"baitaoccb","can_delete":false,"product_type":"c1","uid":1151940,"ip_address":"","ucode":"986131E7496155","user_header":"https://static001.geekbang.org/account/avatar/00/11/93/c4/69918422.jpg","comment_is_top":false,"comment_ctime":1593440284,"is_pvip":false,"replies":[{"id":"85138","content":"以Web场景为例，第一次用户是跟第三方软件建立的“联系”，三方软件要把用户引导到平台一方去授权，这个时候用户实际上跟三方软件就失去了“联系”，平台如果这个时候直接把令牌给了三方软件，因为没了“联系”，三方软件就不能很方便的告诉用户，关于这块更详细的内容在后面课程会着重讲到。","user_name":"作者回复","user_name_real":"王新栋","uid":"1352303","ctime":1593444498,"ip_address":"","comment_id":230651,"utype":1}],"discussion_count":3,"race_medal":0,"score":"18773309468","product_id":100053901,"comment_content":"请问为什么授权者授权后，不直接返回令牌？而是先返回授权码，然后第三方软件再通过授权码得到令牌？","like_count":4,"discussions":[{"author":{"id":1352303,"avatar":"https://static001.geekbang.org/account/avatar/00/14/a2/6f/d239ed80.jpg","nickname":"王新栋","note":"","ucode":"0A5D089B8E1E9D","race_medal":0,"user_type":2,"is_pvip":true},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":499975,"discussion_content":"以Web场景为例，第一次用户是跟第三方软件建立的“联系”，三方软件要把用户引导到平台一方去授权，这个时候用户实际上跟三方软件就失去了“联系”，平台如果这个时候直接把令牌给了三方软件，因为没了“联系”，三方软件就不能很方便的告诉用户，关于这块更详细的内容在后面课程会着重讲到。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1593444498,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1098221,"avatar":"http://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTIY8df9yV6vQjOMxv5xym070hFT2GWYELpqBhxSicQoq5IqBx6teS1xJaomkOBeuzv4vkXRJfibqcMw/132","nickname":"永不止步","note":"","ucode":"B5228B7EDF5921","race_medal":0,"user_type":1,"is_pvip":true},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":287454,"discussion_content":"返回授权码是在前端的跳转链接过程中完成的，通过授权码换取刷新令牌和访问令牌是在服务端完成的，服务端的安全性比较高。直接返回访问令牌也是可以的，但是直接通过前端返回的话，安全性就比较差，隐式模式就是直接返回访问令牌，这种情况适合只有前端的场景，由于这种场景的安全性差，因此只能获取访问令牌，无法获取刷新令牌。","likes_number":4,"is_delete":false,"is_hidden":false,"ctime":1593442795,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1102126,"avatar":"https://static001.geekbang.org/account/avatar/00/10/d1/2e/ad6315ab.jpg","nickname":"聂士伟","note":"","ucode":"C1624B259BB34E","race_medal":0,"user_type":1,"is_pvip":true},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":562072,"discussion_content":"“第三方软件再通过授权码得到令牌”这里的第三方软件其实是第三方软件的后台服务器了，不是web前端也不是app，所以这里第三方软件的前端们是看不到授权码的","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1649771075,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":230628,"user_name":"iLeGeND","can_delete":false,"product_type":"c1","uid":1055475,"ip_address":"","ucode":"4055A628A6E97C","user_header":"https://static001.geekbang.org/account/avatar/00/10/1a/f3/41d5ba7d.jpg","comment_is_top":false,"comment_ctime":1593435485,"is_pvip":false,"discussion_count":2,"race_medal":0,"score":"18773304669","product_id":100053901,"comment_content":"<br>为什么直接用授权码 还弄个令牌","like_count":4,"discussions":[{"author":{"id":1021455,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/96/0f/d9d878f8.jpg","nickname":"leros","note":"","ucode":"02F018C58337E6","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":288839,"discussion_content":"授权码也是临时的，而且只能一次性使用。授权码目的是帮助第三方应用得到用户许可，授权码由开放平台的授权服务器生成，通过第三方应用的重定向URL返回给该应用，并且在浏览器可见，属于公开信息。令牌是在第三方应用获得用户授权后（通过授权码证明）再向授权服务器申请的，令牌有授权令牌和更新令牌两种，这两个令牌都存在应用的后端服务器上，浏览器不可见，应用拿着令牌再申请对资源的获取。授权码和令牌相互配合，实现第三方应用对用户资源的安全调用。","likes_number":3,"is_delete":false,"is_hidden":false,"ctime":1593897863,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1486895,"avatar":"https://static001.geekbang.org/account/avatar/00/16/b0/2f/e2096905.jpg","nickname":"马成","note":"","ucode":"664F2BAA2E0F0B","race_medal":0,"user_type":1,"is_pvip":true},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":287579,"discussion_content":"令牌有过期机制，需要隔一段时间刷新，刷新令牌的时候不需要像获取授权码一样再跳转一遍。","likes_number":2,"is_delete":false,"is_hidden":false,"ctime":1593485274,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":284846,"user_name":"杯莫停","can_delete":false,"product_type":"c1","uid":1759325,"ip_address":"","ucode":"4FA1D5CBBEF702","user_header":"https://static001.geekbang.org/account/avatar/00/1a/d8/5d/07dfb3b5.jpg","comment_is_top":false,"comment_ctime":1616496174,"is_pvip":true,"discussion_count":1,"race_medal":0,"score":"14501398062","product_id":100053901,"comment_content":"比如极客时间可以用微信登录，点击微信图标，极客时间会重定向到一个有微信登录二维码的页面，让我扫二维码，我扫了就是授权微信给极客时间提供授权服务。然后微信会给极客时间发授权码，极客时间收到授权码，去微信提供的api获取token。获取到token，极客时间就可以获取到我的微信头像，昵称，甚至通讯录（不知道会不会）大概是这个流程吧？","like_count":3,"discussions":[{"author":{"id":2608728,"avatar":"https://static001.geekbang.org/account/avatar/00/27/ce/58/71ed845f.jpg","nickname":"Dexter","note":"","ucode":"909CABC4AC4AC9","race_medal":0,"user_type":1,"is_pvip":true},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":580163,"discussion_content":"那对极客时间里面的资源类型/内容的访问，怎么体现的？","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1657942294,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":234336,"user_name":"蒋胜琳","can_delete":false,"product_type":"c1","uid":2052127,"ip_address":"","ucode":"E0786D90BAA3A5","user_header":"https://static001.geekbang.org/account/avatar/00/1f/50/1f/5563ddc2.jpg","comment_is_top":false,"comment_ctime":1594649159,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"14479551047","product_id":100053901,"comment_content":"总结得很好，例子也不错，特别喜欢先粗讲实习原理及流程的课程，对新手很友好，容易建立起体系知识","like_count":3},{"had_liked":false,"id":231054,"user_name":"扎紧绷带","can_delete":false,"product_type":"c1","uid":1316667,"ip_address":"","ucode":"4EDB38E21C12BB","user_header":"https://static001.geekbang.org/account/avatar/00/14/17/3b/37bcd31e.jpg","comment_is_top":false,"comment_ctime":1593572081,"is_pvip":false,"replies":[{"id":"85405","content":"密码怎样加密最终还都是传输的保护【密码】的信息，当然可以采用非对称的加密算法，另外呢，加密的重点不在于加密算法本身，因加密算法无外乎刚才说的非对称和对此，重点地方在于如何管理秘钥，需要有一个秘钥管理系统。另外还是建议采用其它的授权许可类型。","user_name":"作者回复","user_name_real":"王新栋","uid":"1352303","ctime":1593653257,"ip_address":"","comment_id":231054,"utype":1}],"discussion_count":3,"race_medal":0,"score":"14478473969","product_id":100053901,"comment_content":"栋哥，我要提一个比较超前的问题，因为现在正在做一个开放平台，目前用到密码模式，第三方客户端可以通过我们平台的账号密码，访问一些数据。我的问题是，这个密码该怎样加密？可以简单说下吗","like_count":3,"discussions":[{"author":{"id":1352303,"avatar":"https://static001.geekbang.org/account/avatar/00/14/a2/6f/d239ed80.jpg","nickname":"王新栋","note":"","ucode":"0A5D089B8E1E9D","race_medal":0,"user_type":2,"is_pvip":true},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":500138,"discussion_content":"密码怎样加密最终还都是传输的保护【密码】的信息，当然可以采用非对称的加密算法，另外呢，加密的重点不在于加密算法本身，因加密算法无外乎刚才说的非对称和对此，重点地方在于如何管理秘钥，需要有一个秘钥管理系统。另外还是建议采用其它的授权许可类型。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1593653257,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":2055809,"avatar":"https://static001.geekbang.org/account/avatar/00/1f/5e/81/82709d6e.jpg","nickname":"码小呆","note":"","ucode":"44532D6ABF9340","race_medal":0,"user_type":1,"is_pvip":true},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":589749,"discussion_content":"这为啥不用客户端凭证模式，感觉会好点","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1665298493,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":"广东"},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1046893,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/f9/6d/b623562a.jpg","nickname":"霹雳大仙pp","note":"","ucode":"F654FD9AEC1D56","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":288037,"discussion_content":"RSA非对称加密，约定好密钥对","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1593617472,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":230698,"user_name":"iLeGeND","can_delete":false,"product_type":"c1","uid":1055475,"ip_address":"","ucode":"4055A628A6E97C","user_header":"https://static001.geekbang.org/account/avatar/00/10/1a/f3/41d5ba7d.jpg","comment_is_top":false,"comment_ctime":1593472943,"is_pvip":false,"replies":[{"id":"85276","content":"规范、解决方案、框架 都有他的语境含义，也就是说在一定情况下都没有问题，都合理。比如 规范，那么它是一种授权协议规范，在协议后面加上规范没有问题；解决方案，保护Web Api的一种解决方案，没有问题；框架，授权框架，在这个框架下包含了四种角色，我们的生产组件承担了里面的角色，也没有问题。","user_name":"作者回复","user_name_real":"王新栋","uid":"1352303","ctime":1593525370,"ip_address":"","comment_id":230698,"utype":1}],"discussion_count":1,"race_medal":0,"score":"14478374831","product_id":100053901,"comment_content":"oauth2 一种规范或者解决方案，还是框架？","like_count":3,"discussions":[{"author":{"id":1352303,"avatar":"https://static001.geekbang.org/account/avatar/00/14/a2/6f/d239ed80.jpg","nickname":"王新栋","note":"","ucode":"0A5D089B8E1E9D","race_medal":0,"user_type":2,"is_pvip":true},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":499996,"discussion_content":"规范、解决方案、框架 都有他的语境含义，也就是说在一定情况下都没有问题，都合理。比如 规范，那么它是一种授权协议规范，在协议后面加上规范没有问题；解决方案，保护Web Api的一种解决方案，没有问题；框架，授权框架，在这个框架下包含了四种角色，我们的生产组件承担了里面的角色，也没有问题。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1593525370,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":230617,"user_name":"星夜宝宝","can_delete":false,"product_type":"c1","uid":1334215,"ip_address":"","ucode":"958CEA5A12850C","user_header":"https://static001.geekbang.org/account/avatar/00/14/5b/c7/1728011a.jpg","comment_is_top":false,"comment_ctime":1593432475,"is_pvip":true,"replies":[{"id":"85139","content":"我们的附属例子是想用最原生的代码，来讲透OAuth 2.0的流程体系，带着“衣服”的例子，会干扰原理的讲解。","user_name":"作者回复","user_name_real":"王新栋","uid":"1352303","ctime":1593444638,"ip_address":"","comment_id":230617,"utype":1}],"discussion_count":3,"race_medal":0,"score":"14478334363","product_id":100053901,"comment_content":"老师能写弄一个spring boot版本的吗？","like_count":3,"discussions":[{"author":{"id":1352303,"avatar":"https://static001.geekbang.org/account/avatar/00/14/a2/6f/d239ed80.jpg","nickname":"王新栋","note":"","ucode":"0A5D089B8E1E9D","race_medal":0,"user_type":2,"is_pvip":true},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":499964,"discussion_content":"我们的附属例子是想用最原生的代码，来讲透OAuth 2.0的流程体系，带着“衣服”的例子，会干扰原理的讲解。","likes_number":1,"is_delete":false,"is_hidden":false,"ctime":1593444638,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1334215,"avatar":"https://static001.geekbang.org/account/avatar/00/14/5b/c7/1728011a.jpg","nickname":"星夜宝宝","note":"","ucode":"958CEA5A12850C","race_medal":0,"user_type":1,"is_pvip":true},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":287631,"discussion_content":"那老师能否两种版本都有呢？","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1593498864,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":1,"child_discussions":[{"author":{"id":1000473,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/44/19/17fadc62.jpg","nickname":"郭蕾","note":"","ucode":"34F4C07D1C5FE8","race_medal":0,"user_type":8,"is_pvip":false},"reply_author":{"id":1334215,"avatar":"https://static001.geekbang.org/account/avatar/00/14/5b/c7/1728011a.jpg","nickname":"星夜宝宝","note":"","ucode":"958CEA5A12850C","race_medal":0,"user_type":1,"is_pvip":true},"discussion":{"id":287686,"discussion_content":"后面会有加餐，放心吧","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1593509994,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":287631,"ip_address":""},"score":287686,"extra":""}]}]},{"had_liked":false,"id":230581,"user_name":"Seven.Lin澤耿","can_delete":false,"product_type":"c1","uid":1181192,"ip_address":"","ucode":"4CAB732CD6F149","user_header":"https://static001.geekbang.org/account/avatar/00/12/06/08/855abb02.jpg","comment_is_top":false,"comment_ctime":1593422839,"is_pvip":false,"replies":[{"id":"85282","content":"没错，使用OAuth 2.0 的核心目的就是令牌，通过令牌来代替账号密码，这样可以减少【攻击面】，那么如果还继续使用账号和密码，当然就没有利用到OAuth 2.0。","user_name":"作者回复","user_name_real":"王新栋","uid":"1352303","ctime":1593526352,"ip_address":"","comment_id":230581,"utype":1}],"discussion_count":2,"race_medal":0,"score":"14478324727","product_id":100053901,"comment_content":"我们项目使用OAuth2.0 ，但是还是使用账号密码登录，是不是等于没有用授权的特性了==、","like_count":3,"discussions":[{"author":{"id":1352303,"avatar":"https://static001.geekbang.org/account/avatar/00/14/a2/6f/d239ed80.jpg","nickname":"王新栋","note":"","ucode":"0A5D089B8E1E9D","race_medal":0,"user_type":2,"is_pvip":true},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":499944,"discussion_content":"没错，使用OAuth 2.0 的核心目的就是令牌，通过令牌来代替账号密码，这样可以减少【攻击面】，那么如果还继续使用账号和密码，当然就没有利用到OAuth 2.0。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1593526352,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1070298,"avatar":"https://static001.geekbang.org/account/avatar/00/10/54/da/e2e5ddf7.jpg","nickname":"2102","note":"","ucode":"A67068F2A3157E","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":287543,"discussion_content":"oauth是3方的，要看你这个账户密码是否直接是你们自己的平台","likes_number":1,"is_delete":false,"is_hidden":false,"ctime":1593479013,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":230935,"user_name":"暖色浮余生","can_delete":false,"product_type":"c1","uid":1593126,"ip_address":"","ucode":"ED943F2DF88896","user_header":"https://static001.geekbang.org/account/avatar/00/18/4f/26/f21afb83.jpg","comment_is_top":false,"comment_ctime":1593525800,"is_pvip":false,"replies":[{"id":"85453","content":"感谢支持","user_name":"作者回复","user_name_real":"王新栋","uid":"1352303","ctime":1593667691,"ip_address":"","comment_id":230935,"utype":1}],"discussion_count":2,"race_medal":0,"score":"10183460392","product_id":100053901,"comment_content":"最近刚好在学习这个OAuth2。觉得很绕，搞不懂各种模式应该应用在哪一种场景下，感觉这个课就是个救星啊哈哈。 ","like_count":2,"discussions":[{"author":{"id":1352303,"avatar":"https://static001.geekbang.org/account/avatar/00/14/a2/6f/d239ed80.jpg","nickname":"王新栋","note":"","ucode":"0A5D089B8E1E9D","race_medal":0,"user_type":2,"is_pvip":true},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":500081,"discussion_content":"感谢支持","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1593667691,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1593126,"avatar":"https://static001.geekbang.org/account/avatar/00/18/4f/26/f21afb83.jpg","nickname":"暖色浮余生","note":"","ucode":"ED943F2DF88896","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":288207,"discussion_content":"能催更就更好了哈哈","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1593677673,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":230780,"user_name":"兰正浩","can_delete":false,"product_type":"c1","uid":1273461,"ip_address":"","ucode":"FC1E485662F524","user_header":"https://static001.geekbang.org/account/avatar/00/13/6e/75/159bafb9.jpg","comment_is_top":false,"comment_ctime":1593491256,"is_pvip":true,"replies":[{"id":"85275","content":"这个可以通过SCOPE来约束，权限控制也是OAuth 2.0实践过程中需要重点处理的，在后面的课程中都会有涉及到。","user_name":"作者回复","user_name_real":"王新栋","uid":"1352303","ctime":1593524815,"ip_address":"","comment_id":230780,"utype":1}],"discussion_count":1,"race_medal":0,"score":"10183425848","product_id":100053901,"comment_content":"如何确保小兔软件只访问订单数据？","like_count":2,"discussions":[{"author":{"id":1352303,"avatar":"https://static001.geekbang.org/account/avatar/00/14/a2/6f/d239ed80.jpg","nickname":"王新栋","note":"","ucode":"0A5D089B8E1E9D","race_medal":0,"user_type":2,"is_pvip":true},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":500035,"discussion_content":"这个可以通过SCOPE来约束，权限控制也是OAuth 2.0实践过程中需要重点处理的，在后面的课程中都会有涉及到。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1593524815,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":230579,"user_name":"胡化敏","can_delete":false,"product_type":"c1","uid":1717937,"ip_address":"","ucode":"D6574E9AAFC294","user_header":"","comment_is_top":false,"comment_ctime":1593422810,"is_pvip":false,"replies":[{"id":"85148","content":"谢谢 化敏同学。其实故事的背后还有故事，😀","user_name":"作者回复","user_name_real":"王新栋","uid":"1352303","ctime":1593446189,"ip_address":"","comment_id":230579,"utype":1}],"discussion_count":1,"race_medal":0,"score":"10183357402","product_id":100053901,"comment_content":"故事讲的不错","like_count":2,"discussions":[{"author":{"id":1352303,"avatar":"https://static001.geekbang.org/account/avatar/00/14/a2/6f/d239ed80.jpg","nickname":"王新栋","note":"","ucode":"0A5D089B8E1E9D","race_medal":0,"user_type":2,"is_pvip":true},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":499943,"discussion_content":"谢谢 化敏同学。其实故事的背后还有故事，😀","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1593446189,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":247875,"user_name":"曙光","can_delete":false,"product_type":"c1","uid":1476450,"ip_address":"","ucode":"04D65BF7F19845","user_header":"https://static001.geekbang.org/account/avatar/00/16/87/62/f99b5b05.jpg","comment_is_top":false,"comment_ctime":1599900359,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"5894867655","product_id":100053901,"comment_content":"安全基本不同，授权方式不通。如果商家的用户名密码被盗用，页面跳转，授权码没办法保护商家了。可以再添加手机验证码验证商家信息，如果金额较高或打单数量较大，可以增加U盾来提升安全性。当然，也可以通过人脸识别，安全性高，使用方便。<br>如果小兔是京东商城自家应用，本身的安全级别就高，点击一次授权即可获取访问令牌","like_count":1},{"had_liked":false,"id":235389,"user_name":"慎独明强","can_delete":false,"product_type":"c1","uid":1965699,"ip_address":"","ucode":"DC2F7F2C0C8F60","user_header":"https://static001.geekbang.org/account/avatar/00/1d/fe/83/df562574.jpg","comment_is_top":false,"comment_ctime":1594995844,"is_pvip":false,"replies":[{"id":"87021","content":"感谢支持","user_name":"作者回复","user_name_real":"王新栋","uid":"1352303","ctime":1595121496,"ip_address":"","comment_id":235389,"utype":1}],"discussion_count":1,"race_medal":0,"score":"5889963140","product_id":100053901,"comment_content":"OAuth2.0是开放授权协议，通过用户登录后，再去授权给第三方，开放平台会给第三方erp系统一个授权认证码，第三方erp再与开放平台系统进行认证，颁发一个Access token访问令牌，令牌会有过期时间，第三方erp拿到令牌，再使用令牌请求拉单接口，就可以通过开放平台的认证访问到我们订单系统的订单数据。之前自己负责订单这块，给开放平台提供拉单接口，老师讲的这个例子，很生动。","like_count":1,"discussions":[{"author":{"id":1352303,"avatar":"https://static001.geekbang.org/account/avatar/00/14/a2/6f/d239ed80.jpg","nickname":"王新栋","note":"","ucode":"0A5D089B8E1E9D","race_medal":0,"user_type":2,"is_pvip":true},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":501702,"discussion_content":"感谢支持","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1595121496,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":232726,"user_name":"沉淀","can_delete":false,"product_type":"c1","uid":1790036,"ip_address":"","ucode":"BC460D5AC78A6B","user_header":"https://static001.geekbang.org/account/avatar/00/1b/50/54/558506ee.jpg","comment_is_top":false,"comment_ctime":1594102718,"is_pvip":false,"replies":[{"id":"85929","content":"1、搭建开放平台主要包括网关和授权两个系统，网关下面是一堆服务，调用量最大的是网关系统，对于网关来讲这不是瓶颈，网关就是干这个的；<br><br>2、用户登录跟用户授权是隔离的，用户登录之后进行授权，然后第三方软件拿到token，之后就是token的生命周期了，而且token自身有有效期。","user_name":"作者回复","user_name_real":"王新栋","uid":"1352303","ctime":1594133342,"ip_address":"","comment_id":232726,"utype":1}],"discussion_count":2,"race_medal":0,"score":"5889070014","product_id":100053901,"comment_content":"1. 用户在获得了访问资源的token之后，去开放平台获取资源，所有资源的请求都需要通过开放平台，那开放平台就会成为一个瓶颈？不知道实际中有没有办法解决这个问题。<br>2. 用户授权了之后一般第三方应用就可以通过token获取资源，所以用户授权的记录需要在开放平台保留下来，用户每次的登录都会有过期时间，那就会有过期时间的刷新问题，而每次请求都要刷新这个过期时间，请求量大的时候，这个刷新也会成为一个瓶颈。大佬有好的解决方案么?<br>","like_count":1,"discussions":[{"author":{"id":1352303,"avatar":"https://static001.geekbang.org/account/avatar/00/14/a2/6f/d239ed80.jpg","nickname":"王新栋","note":"","ucode":"0A5D089B8E1E9D","race_medal":0,"user_type":2,"is_pvip":true},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":500753,"discussion_content":"1、搭建开放平台主要包括网关和授权两个系统，网关下面是一堆服务，调用量最大的是网关系统，对于网关来讲这不是瓶颈，网关就是干这个的；\n\n2、用户登录跟用户授权是隔离的，用户登录之后进行授权，然后第三方软件拿到token，之后就是token的生命周期了，而且token自身有有效期。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1594133342,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1790036,"avatar":"https://static001.geekbang.org/account/avatar/00/1b/50/54/558506ee.jpg","nickname":"沉淀","note":"","ucode":"BC460D5AC78A6B","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":294184,"discussion_content":"谢谢。\n1.对于第一个问题， 这里的授权服务和受保护资源是分开的对吧。\n2.token的有效期不回随着使用而更新对吧","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1595822011,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":359138,"user_name":"码小呆","can_delete":false,"product_type":"c1","uid":2055809,"ip_address":"广东","ucode":"44532D6ABF9340","user_header":"https://static001.geekbang.org/account/avatar/00/1f/5e/81/82709d6e.jpg","comment_is_top":false,"comment_ctime":1665286495,"is_pvip":true,"discussion_count":0,"race_medal":0,"score":"1665286495","product_id":100053901,"comment_content":"小兔打单那个场景是否可以使用 客户端凭证模式来实现","like_count":0},{"had_liked":false,"id":320578,"user_name":"garyhimself","can_delete":false,"product_type":"c1","uid":2708528,"ip_address":"","ucode":"4EDF54651242EC","user_header":"https://static001.geekbang.org/account/avatar/00/29/54/30/5f146e1b.jpg","comment_is_top":false,"comment_ctime":1636385110,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1636385110","product_id":100053901,"comment_content":"如何确保小兔打单软件只去拿小明店铺的订单，小兔打单软件只拿到了一个access token，它怎么知道小明的？","like_count":0},{"had_liked":false,"id":248058,"user_name":"༼¥༽ ༼་ཅ་༽","can_delete":false,"product_type":"c1","uid":2142688,"ip_address":"","ucode":"7F77A85B16AEF7","user_header":"https://static001.geekbang.org/account/avatar/00/20/b1/e0/8930fa26.jpg","comment_is_top":false,"comment_ctime":1599996127,"is_pvip":true,"discussion_count":0,"race_medal":0,"score":"1599996127","product_id":100053901,"comment_content":"问一些jwt保存用户信息。里面还有保存用户的角色等权限信息，返回到前端，这个安全吗，还请老师说下","like_count":0},{"had_liked":false,"id":238936,"user_name":"Edison鹏","can_delete":false,"product_type":"c1","uid":2103222,"ip_address":"","ucode":"62E10D50565DC8","user_header":"https://static001.geekbang.org/account/avatar/00/20/17/b6/ac21f221.jpg","comment_is_top":false,"comment_ctime":1596375584,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1596375584","product_id":100053901,"comment_content":"2.假如用户再第三方授权的时候，如果客户端本地没有和开放平台建立关联，是必须手动输入开放平台账号密码登录的，并且通过开放平台返回的token去访问弹出授权按钮的界面的","like_count":0},{"had_liked":false,"id":236901,"user_name":"进阶的小孔","can_delete":false,"product_type":"c1","uid":1269832,"ip_address":"","ucode":"71E88AE4EFDBF2","user_header":"http://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTJman25D8JlricJVaeweYqr70vyp2acetStqbtaDnCnroGXvuJfgr1As9q47iacTCUUMK1eRUt4KImg/132","comment_is_top":false,"comment_ctime":1595580230,"is_pvip":false,"replies":[{"id":"88111","content":"感谢支持","user_name":"作者回复","user_name_real":"王新栋","uid":"1352303","ctime":1596199608,"ip_address":"","comment_id":236901,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1595580230","product_id":100053901,"comment_content":"看完之后接着看留言，帮助不是一般的大","like_count":0,"discussions":[{"author":{"id":1352303,"avatar":"https://static001.geekbang.org/account/avatar/00/14/a2/6f/d239ed80.jpg","nickname":"王新栋","note":"","ucode":"0A5D089B8E1E9D","race_medal":0,"user_type":2,"is_pvip":true},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":502247,"discussion_content":"感谢支持","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1596199608,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":235450,"user_name":"在路上","can_delete":false,"product_type":"c1","uid":1215139,"ip_address":"","ucode":"258880ACE79448","user_header":"https://static001.geekbang.org/account/avatar/00/12/8a/a3/aee7ded7.jpg","comment_is_top":false,"comment_ctime":1595041427,"is_pvip":false,"replies":[{"id":"87018","content":"在我们给的小兔三方软件的例子中是小明购买之后来进行使用的，小兔拿到的令牌时长跟订购有关系。<br><br>一般应用小时级就可以，比如微信给的是2小时，超过之后用刷新令牌获取。","user_name":"作者回复","user_name_real":"王新栋","uid":"1352303","ctime":1595121452,"ip_address":"","comment_id":235450,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1595041427","product_id":100053901,"comment_content":"王老师，小兔三方软件拿到的令牌一般是多久，每次都需要重新授权，还是周期性的  一天  一周 一月 一年这种","like_count":0,"discussions":[{"author":{"id":1352303,"avatar":"https://static001.geekbang.org/account/avatar/00/14/a2/6f/d239ed80.jpg","nickname":"王新栋","note":"","ucode":"0A5D089B8E1E9D","race_medal":0,"user_type":2,"is_pvip":true},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":501727,"discussion_content":"在我们给的小兔三方软件的例子中是小明购买之后来进行使用的，小兔拿到的令牌时长跟订购有关系。\n\n一般应用小时级就可以，比如微信给的是2小时，超过之后用刷新令牌获取。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1595121452,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":230945,"user_name":"witluo","can_delete":false,"product_type":"c1","uid":1443117,"ip_address":"","ucode":"3D9608C3DDDD95","user_header":"","comment_is_top":false,"comment_ctime":1593528759,"is_pvip":false,"replies":[{"id":"85452","content":"后面课程会讲到","user_name":"作者回复","user_name_real":"王新栋","uid":"1352303","ctime":1593667680,"ip_address":"","comment_id":230945,"utype":1}],"discussion_count":2,"race_medal":0,"score":"1593528759","product_id":100053901,"comment_content":"期待详细讲解一下： 为什么用户授权后不直接返回access_token， 而是先需要返回 授权code。 需要中间多一个环节(code换取accessToken)  , 个人觉得直接返回access_token也没什么问题。 ","like_count":0,"discussions":[{"author":{"id":1352303,"avatar":"https://static001.geekbang.org/account/avatar/00/14/a2/6f/d239ed80.jpg","nickname":"王新栋","note":"","ucode":"0A5D089B8E1E9D","race_medal":0,"user_type":2,"is_pvip":true},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":500085,"discussion_content":"后面课程会讲到","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1593667680,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1202447,"avatar":"https://static001.geekbang.org/account/avatar/00/12/59/0f/dfb310b5.jpg","nickname":"西","note":"","ucode":"439CF4B1FEF9EE","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":292891,"discussion_content":"直接返回令牌那就是简化模式了，浏览器地址栏上都能看到令牌了","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1595380273,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]}]}