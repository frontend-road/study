{"id":176900,"title":"21 |  äº‹åŠ¡å¼€å‘ï¼šè¯»æ“ä½œäº‹åŠ¡ä¹‹äºŒ","content":"<p><strong>è¯¾ä»¶å’ŒDemoåœ°å€</strong><br>\n<a href=\"https://gitee.com/geektime-geekbang/geektime-mongodb-course\">https://gitee.com/geektime-geekbang/geektime-mongodb-course</a></p>","comments":[{"had_liked":false,"id":179593,"user_name":"kylexy_0817","can_delete":false,"product_type":"c3","uid":1068372,"ip_address":"","ucode":"392DD9DD5E4B6E","user_header":"https://static001.geekbang.org/account/avatar/00/10/4d/54/9c214885.jpg","comment_is_top":false,"comment_ctime":1582036158,"is_pvip":false,"replies":[{"id":70079,"content":"å¾ˆæœ‰æ´å¯ŸåŠ›çš„ä¸€ä¸ªé—®é¢˜ã€‚\n\nä¸€ä¸ªè¯»çº¿ç¨‹ï¼Œä½¿ç”¨ readConcern:majorityï¼Œåœ¨t1 çš„æ—¶å€™è¯»S1èŠ‚ç‚¹ï¼ŒS1æ˜¯å¦è¦è¿”å›æœ€æ–°çš„ä¸€ä¸ªå†™å…¥ x=1 è¿˜æ˜¯è¦ç­‰åˆ°t5ï¼Ÿ\n\né¦–å…ˆç†è§£ï¼Œè¿™ä¸ªè¯»çº¿ç¨‹åªèƒ½è¯» ä¸€ä¸ªè¢«å¤§å¤šæ•°èŠ‚ç‚¹ç¡®è®¤çš„å†™å…¥(æ»¡è¶³write majority)ï¼Œè¿™æ‰å¯ä»¥æ»¡è¶³readConcern: majorityçš„æ¡ä»¶ã€‚\n\nåœ¨t1çš„æ—¶å€™ï¼Œx=1å®é™…ä¸Šå·²ç»åˆ°è¾¾ä¸¤ä¸ªèŠ‚ç‚¹ï¼ˆmajorityï¼‰ï¼Œä½†æ˜¯åˆ¤æ–­è¿™ä¸ªäº‹å®çš„æ˜¯ä¸»èŠ‚ç‚¹ã€‚åœ¨ä¸»èŠ‚ç‚¹æ²¡æœ‰çŸ¥é“å¹¶ç¡®è®¤x=1è¿™ä¸ªæ“ä½œå·²ç»è¢«å¤šæ•°èŠ‚ç‚¹å†™å…¥çš„æ—¶å€™ï¼Œè¿™æ¡æ•°æ®æ˜¯ä¸å¤Ÿèµ„æ ¼è¢«å‘ç»™ readConcern: majority è¯»çº¿ç¨‹çš„ã€‚ \n\nè¿™ä¸ªæ˜¯3ä¸ªèŠ‚ç‚¹ï¼Œæƒ³è±¡ä¸€ä¸‹5ä¸ªèŠ‚ç‚¹ - é‚£S1æ˜¯è‚¯å®šä¸çŸ¥é“æ•°æ®å·²ç»å†™å…¥åˆ°å¤šæ•°èŠ‚ç‚¹ï¼Œåªèƒ½ç­‰primary å‘Šè¯‰ä»–ã€‚\n \nè¿™é‡Œæ˜¯å®˜æ–¹çš„æ–‡æ¡£ï¼š\nhttps:&#47;&#47;docs.mongodb.com&#47;manual&#47;reference&#47;read-concern-majority&#47;","user_name":"ä½œè€…å›å¤","user_name_real":"è¿œèˆªçš„TJ å”å»ºæ³•","uid":1260017,"ctime":1582347281,"ip_address":"","comment_id":179593,"utype":1}],"discussion_count":4,"race_medal":0,"score":2,"product_id":100040001,"comment_content":"è€å¸ˆï¼Œæœ‰ä¸ªé—®é¢˜æƒ³è¯·æ•™ï¼Œæœ¬èŠ‚ä¸­çš„{readConcern:&quot;majority&quot;}çš„ä¾‹å­ï¼Œæ‰€æœ‰èŠ‚ç‚¹çš„æ•°æ®è¾¾åˆ°å…±è¯†çš„æ—¶é—´ï¼Œä¸å¤åˆ¶é›†çš„åº”è¯¥ä¸ä¸€æ ·å§ï¼Ÿå¤åˆ¶é›†çš„æƒ…å†µåº”è¯¥ä¼šç®€å•ç‚¹ï¼Œå°±æ˜¯å½“primaryèŠ‚ç‚¹æŠŠæ•°æ®å¤åˆ¶ç»™secondaryæ—¶ï¼Œé¡ºä¾¿æŠŠx=1å†™å…¥PæˆåŠŸçš„ä¿¡æ¯å‘Šè¯‰S1å’ŒS2ï¼Œè¿™æ ·S1å’ŒS2åªéœ€è¦å‘Šè¯‰Pä»–ä»¬ä¹Ÿå†™å…¥æˆåŠŸå°±å®Œäº‹äº†ï¼Œæ²¡å¿…è¦åˆ°t5ã€t6å§ï¼Ÿåªæœ‰åœ¨writeConcernæ—¶æ‰åƒä¾‹å­ä¸­è¯´çš„ï¼Ÿ","like_count":6,"discussions":[{"author":{"id":1260017,"avatar":"https://static001.geekbang.org/account/avatar/00/13/39/f1/6d18a4d1.jpg","nickname":"è¿œèˆªçš„TJ å”å»ºæ³•","note":"","ucode":"0719807390250A","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":484319,"discussion_content":"å¾ˆæœ‰æ´å¯ŸåŠ›çš„ä¸€ä¸ªé—®é¢˜ã€‚\n\nä¸€ä¸ªè¯»çº¿ç¨‹ï¼Œä½¿ç”¨ readConcern:majorityï¼Œåœ¨t1 çš„æ—¶å€™è¯»S1èŠ‚ç‚¹ï¼ŒS1æ˜¯å¦è¦è¿”å›æœ€æ–°çš„ä¸€ä¸ªå†™å…¥ x=1 è¿˜æ˜¯è¦ç­‰åˆ°t5ï¼Ÿ\n\né¦–å…ˆç†è§£ï¼Œè¿™ä¸ªè¯»çº¿ç¨‹åªèƒ½è¯» ä¸€ä¸ªè¢«å¤§å¤šæ•°èŠ‚ç‚¹ç¡®è®¤çš„å†™å…¥(æ»¡è¶³write majority)ï¼Œè¿™æ‰å¯ä»¥æ»¡è¶³readConcern: majorityçš„æ¡ä»¶ã€‚\n\nåœ¨t1çš„æ—¶å€™ï¼Œx=1å®é™…ä¸Šå·²ç»åˆ°è¾¾ä¸¤ä¸ªèŠ‚ç‚¹ï¼ˆmajorityï¼‰ï¼Œä½†æ˜¯åˆ¤æ–­è¿™ä¸ªäº‹å®çš„æ˜¯ä¸»èŠ‚ç‚¹ã€‚åœ¨ä¸»èŠ‚ç‚¹æ²¡æœ‰çŸ¥é“å¹¶ç¡®è®¤x=1è¿™ä¸ªæ“ä½œå·²ç»è¢«å¤šæ•°èŠ‚ç‚¹å†™å…¥çš„æ—¶å€™ï¼Œè¿™æ¡æ•°æ®æ˜¯ä¸å¤Ÿèµ„æ ¼è¢«å‘ç»™ readConcern: majority è¯»çº¿ç¨‹çš„ã€‚ \n\nè¿™ä¸ªæ˜¯3ä¸ªèŠ‚ç‚¹ï¼Œæƒ³è±¡ä¸€ä¸‹5ä¸ªèŠ‚ç‚¹ - é‚£S1æ˜¯è‚¯å®šä¸çŸ¥é“æ•°æ®å·²ç»å†™å…¥åˆ°å¤šæ•°èŠ‚ç‚¹ï¼Œåªèƒ½ç­‰primary å‘Šè¯‰ä»–ã€‚\n \nè¿™é‡Œæ˜¯å®˜æ–¹çš„æ–‡æ¡£ï¼š\nhttps://docs.mongodb.com/manual/reference/read-concern-majority/","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1582347281,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1165671,"avatar":"https://static001.geekbang.org/account/avatar/00/11/c9/67/7d446501.jpg","nickname":"å¤§å±•å®å…”","note":"","ucode":"21E6001F29951B","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":576553,"discussion_content":"äºŒé˜¶æ®µæäº¤ï¼šprepare and commit","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1655647617,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":2074870,"avatar":"https://static001.geekbang.org/account/avatar/00/1f/a8/f6/5f5efd88.jpg","nickname":"Geek_4c9d75","note":"","ucode":"96B73112AB93BC","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":332977,"discussion_content":"å¦å¤–ï¼št6æ—¶é—´ä¹‹åï¼Œæ˜¯å¦è¿˜ä¼šæœ‰På‘ŠçŸ¥S1ï¼šS2å·²ç»åŒæ­¥äº†æ•°æ®ï¼Ÿ","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1607406203,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":2074870,"avatar":"https://static001.geekbang.org/account/avatar/00/1f/a8/f6/5f5efd88.jpg","nickname":"Geek_4c9d75","note":"","ucode":"96B73112AB93BC","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":332976,"discussion_content":"åŒæ ·è§£ç­”äº†æˆ‘çš„é—®é¢˜ï¼Œæ„Ÿè°¢ã€‚è§‰å¾—ä¸»è¦æ˜¯â€œåˆ¤æ–­è¿™ä¸ªäº‹å®çš„æ˜¯ä¸»èŠ‚ç‚¹â€ã€‚\nä¸è¿‡åˆå¼•å‘ä¸€ä¸ªç–‘é—®ï¼šä»S1èŠ‚ç‚¹è¯»æ•°æ®ï¼ŒåŒæ ·éœ€è¦PèŠ‚ç‚¹çš„å‚ä¸å—ï¼Ÿ","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1607405925,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":244611,"user_name":"å·å·","can_delete":false,"product_type":"c3","uid":1382517,"ip_address":"","ucode":"DA092CAC7F294D","user_header":"https://static001.geekbang.org/account/avatar/00/15/18/75/68487e89.jpg","comment_is_top":false,"comment_ctime":1598595112,"is_pvip":false,"replies":[{"id":90300,"content":"å¦‚æœä½ çš„writeConcernæ˜¯é»˜è®¤ï¼Œæ¯”å¦‚è¯´ä½ å†™ x:1 åˆ°ä¸»èŠ‚ç‚¹, ,å®ƒä¼šç«‹å³è¿”å›ã€‚å¦‚æœä½ é©¬ä¸Šå†å»ç”¨majority readConcernå»è¯»è¿™æ¡æ•°æ®ï¼Œè¿™æ¡æ•°æ®æœ‰å¯èƒ½æ²¡è¢«å¤åˆ¶åˆ°å¤šæ•°èŠ‚ç‚¹ï¼Œä½ å°±è¯»ä¸åˆ°å®ƒã€‚å¦‚æœåœ¨åŒä¸€ä¸ªçº¿ç¨‹å†…ï¼Œä¸€èˆ¬è¿™ä¸ªæ˜¯ä¸å¯ä»¥æ¥å—çš„ã€‚\n\næ­£è§£æ˜¯ï¼Œåœ¨è¯»å†™æ“ä½œæ˜¯åŒä¸€ä¸ªåº”ç”¨å‘èµ·æ—¶ï¼Œä½ è¦é…åˆä½¿ç”¨ writeConcern:majority æ¥ä¿è¯ä½ çš„å†™å·²ç»è¢«æäº¤åˆ°å¤§å¤šæ•°èŠ‚ç‚¹ï¼Œè¿™æ ·ä½ é©¬ä¸Šå†ç”¨readConcern: majority å°±å¯ä»¥è¯»åˆ°ä½ åˆšæ‰çš„å†™å…¥äº†ã€‚","user_name":"ä½œè€…å›å¤","user_name_real":"è¿œèˆªçš„TJ å”å»ºæ³•","uid":1260017,"ctime":1598999958,"ip_address":"","comment_id":244611,"utype":1}],"discussion_count":3,"race_medal":0,"score":2,"product_id":100040001,"comment_content":"è€å¸ˆä½ å¥½ï¼Œ æˆ‘ç”¨readConcernå’ŒwriteConcernå°±æ˜¯æƒ³åŸºäºQuorumåŸç†æ¥è§£å†³ä¸€è‡´æ€§é—®é¢˜çš„ï¼Œ ä½†æ˜¯æˆ‘çœ‹å®˜ç½‘è¯´â€œreadConcernè®¾ç½®ä¸ºmajorityæ—¶ï¼Œèƒ½ä¿è¯è¯»åˆ°çš„æ•°æ®ã€ä¸ä¼šå‘ç”Ÿå›æ»šã€ï¼Œä½†å¹¶ä¸èƒ½ä¿è¯è¯»åˆ°çš„æ•°æ®æ˜¯æœ€æ–°çš„â€œã€‚è¿™å¥è¯æŒ‡çš„æ˜¯æˆ‘åˆšæ‰å†™çš„æ•°æ®æäº¤åï¼Œåœ¨å‘èµ·è¯»æ“ä½œå¹¶æ²¡æ³•é©¬ä¸Šè¯»åˆ°åˆšæ‰æäº¤çš„æ•°æ®å—ã€‚  è¯·é—®è€å¸ˆæ€ä¹ˆç†è§£","like_count":3,"discussions":[{"author":{"id":1260017,"avatar":"https://static001.geekbang.org/account/avatar/00/13/39/f1/6d18a4d1.jpg","nickname":"è¿œèˆªçš„TJ å”å»ºæ³•","note":"","ucode":"0719807390250A","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":504636,"discussion_content":"å¦‚æœä½ çš„writeConcernæ˜¯é»˜è®¤ï¼Œæ¯”å¦‚è¯´ä½ å†™ x:1 åˆ°ä¸»èŠ‚ç‚¹, ,å®ƒä¼šç«‹å³è¿”å›ã€‚å¦‚æœä½ é©¬ä¸Šå†å»ç”¨majority readConcernå»è¯»è¿™æ¡æ•°æ®ï¼Œè¿™æ¡æ•°æ®æœ‰å¯èƒ½æ²¡è¢«å¤åˆ¶åˆ°å¤šæ•°èŠ‚ç‚¹ï¼Œä½ å°±è¯»ä¸åˆ°å®ƒã€‚å¦‚æœåœ¨åŒä¸€ä¸ªçº¿ç¨‹å†…ï¼Œä¸€èˆ¬è¿™ä¸ªæ˜¯ä¸å¯ä»¥æ¥å—çš„ã€‚\n\næ­£è§£æ˜¯ï¼Œåœ¨è¯»å†™æ“ä½œæ˜¯åŒä¸€ä¸ªåº”ç”¨å‘èµ·æ—¶ï¼Œä½ è¦é…åˆä½¿ç”¨ writeConcern:majority æ¥ä¿è¯ä½ çš„å†™å·²ç»è¢«æäº¤åˆ°å¤§å¤šæ•°èŠ‚ç‚¹ï¼Œè¿™æ ·ä½ é©¬ä¸Šå†ç”¨readConcern: majority å°±å¯ä»¥è¯»åˆ°ä½ åˆšæ‰çš„å†™å…¥äº†ã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1598999958,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1519881,"avatar":"https://static001.geekbang.org/account/avatar/00/17/31/09/f5d68957.jpg","nickname":"ç¤¼æ‹œä¸‰","note":"","ucode":"C36A84E76E163D","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":310990,"discussion_content":"ç›®å‰ MongoDB 4.4.0 å·²ç»è®¾ç½®äº†é»˜è®¤å¼€å¯ MajorityReadConcern åŠŸèƒ½ï¼Œå¯ä»¥åœ¨ MongoDB Shell ä¸­æŸ¥çœ‹ï¼ˆå€’æ•°ç¬¬ 4 ä¸ªé”®å€¼å¯¹ï¼‰ï¼š\n\nrs0:PRIMARY> db.serverStatus().storageEngine\n{\n        &#34;name&#34; : &#34;wiredTiger&#34;,\n        &#34;supportsCommittedReads&#34; : true,\n        &#34;oldestRequiredTimestampForCrashRecovery&#34; : Timestamp(1602156917, 1),\n        &#34;supportsPendingDrops&#34; : true,\n        &#34;dropPendingIdents&#34; : NumberLong(0),\n        &#34;supportsTwoPhaseIndexBuild&#34; : true,\n        &#34;supportsSnapshotReadConcern&#34; : true,\n        &#34;readOnly&#34; : false,\n        &#34;persistent&#34; : true,\n        &#34;backupCursorOpen&#34; : false\n}\n\nreadPref = &#39;primary&#39; æ—¶è¯»å–ä¸åˆ° P èŠ‚ç‚¹å·²å­˜åœ¨ä½† S èŠ‚ç‚¹ä¸å­˜åœ¨çš„æ•°æ®ï¼Œå°±æ˜¯å› ä¸º readConcern = &#39;majority&#39; å•¦ã€‚\n\næˆ‘çš„ç†è§£ï¼Œæ‰€è°“â€œè¯»å–çš„æ•°æ®å¯èƒ½ä¸æ˜¯æœ€æ–°çš„â€ï¼Œè¦çœ‹å’Œè°æ¯”ï¼Œå¦‚æœå’Œ P èŠ‚ç‚¹æ¯”ï¼Œæ˜¯å¯èƒ½çš„ã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1602166709,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1382517,"avatar":"https://static001.geekbang.org/account/avatar/00/15/18/75/68487e89.jpg","nickname":"å·å·","note":"","ucode":"DA092CAC7F294D","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":303496,"discussion_content":"è°¢è°¢è€å¸ˆ ä¸è¿‡æˆ‘çœ‹readConcernå¼€å¯majorityéœ€è¦åŒæ—¶replication.enableMajorityReadConcernæ‰èƒ½ç”Ÿæ•ˆã€‚åŠ ä¸Šè¿™ä¸ªå‚æ•°åmongoä¼šå¼€å¯ä¸€ä¸ªå•ç‹¬çš„snapshotçº¿ç¨‹å¯¹æ•°æ®é›†è¿›è¡Œå‘¨æœŸæ€§çš„snapshot è¿™ä¸ªæœºåˆ¶ï¼Œç”¨æˆ·è¯»æ•°æ®è®¾è®¡ä»æœ€æ–°çš„committedçš„snapshotè¯»å–æ•°æ®ï¼Œè¿™ç§æœºåˆ¶ä¹Ÿå¯¼è‡´äº†è¯»å–å€’çš„æ•°æ®ä¸æ˜¯è„æ•°æ®ä½†æ˜¯ä¹Ÿä¸æ˜¯æœ€æ–°commitçš„æ•°æ®ã€‚ æ¯”å¦‚åŸæ¥x=1ï¼ŒAåœ¨T1æäº¤äº†æ•°æ®x=1ï¼Œ åœ¨T2æ—¶åˆ»ä¸ä¸€å®šèƒ½å¤Ÿç«‹åˆ»è¯»å–åˆ°x=1ã€‚ æˆ‘ä¸çŸ¥é“æˆ‘çš„ç†è§£å¯¹ä¸å¯¹ï¼Œ è¿™ä¸ªä¹Ÿæ˜¯ç–‘æƒ‘çš„ç‚¹ï¼Œ è¿™ä¸ªå¥½åƒå’ŒwriteConcern majorityæ— å…³å§ ã€‚ ä¸‹é¢è¿™ä¸ªé“¾æ¥æ˜¯mongodbä¸­æ–‡ç¤¾åŒºè®²è§£readConcernåŸç†çš„æ–‡ç«  \n\nhttp://mongoing.com/archives/3403","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1599283846,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":202645,"user_name":"ç‚ç‚","can_delete":false,"product_type":"c3","uid":1525840,"ip_address":"","ucode":"386E790507C66D","user_header":"http://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTIUlVIL2Y7gVjfuubGmkKVXUv9LUlZURwK0fwnHz4xrzaqf2BjwwSXXNwLrTcxdRnnwhTlwnV1Xcg/132","comment_is_top":false,"comment_ctime":1586041656,"is_pvip":false,"replies":[{"id":75797,"content":"å®Œæ•´çš„äº‹åŠ¡åŒ…æ‹¬ACIDã€‚ä½ çš„ç†è§£å’Œå¤§éƒ¨åˆ†ç¨‹åºå‘˜ä¸€æ ·ï¼Œæ›´åŠ å…³æ³¨çš„æ˜¯é‡Œé¢çš„A: Atomictyã€‚ å°±æ˜¯å‡ ä¸ªæ“ä½œè¦groupä¸ºä¸€ä¸ªåŸå­æ“ä½œï¼Œè¦ä¹ˆå…¨éƒ¨æˆåŠŸï¼Œè¦ä¹ˆå›æ»šæ‰€æœ‰æ“ä½œã€‚\n\n","user_name":"ä½œè€…å›å¤","user_name_real":"è¿œèˆªçš„TJ å”å»ºæ³•","uid":1260017,"ctime":1586079428,"ip_address":"","comment_id":202645,"utype":1}],"discussion_count":1,"race_medal":0,"score":2,"product_id":100040001,"comment_content":"mysqlå•èŠ‚ç‚¹æ—¶ä»ç„¶æ˜¯äº‹åŠ¡å‹çš„ã€‚æˆ‘è§‰å¾—äº‹åŠ¡æœ€æ ¸å¿ƒçš„æ ‡å¿—æ˜¯ begin; xxx; commit|rollback;  å½“xxxä¸­å‡ºé—®é¢˜æˆ–è€…ä¸šåŠ¡ç¨‹åºé‡Œå‡ºé—®é¢˜å¯ä»¥rollbackï¼Œä¿è¯æ•´ä¸ªè¿‡ç¨‹æ˜¯å®Œæ•´çš„åŸå­çš„ã€‚","like_count":1,"discussions":[{"author":{"id":1260017,"avatar":"https://static001.geekbang.org/account/avatar/00/13/39/f1/6d18a4d1.jpg","nickname":"è¿œèˆªçš„TJ å”å»ºæ³•","note":"","ucode":"0719807390250A","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":490643,"discussion_content":"å®Œæ•´çš„äº‹åŠ¡åŒ…æ‹¬ACIDã€‚ä½ çš„ç†è§£å’Œå¤§éƒ¨åˆ†ç¨‹åºå‘˜ä¸€æ ·ï¼Œæ›´åŠ å…³æ³¨çš„æ˜¯é‡Œé¢çš„A: Atomictyã€‚ å°±æ˜¯å‡ ä¸ªæ“ä½œè¦groupä¸ºä¸€ä¸ªåŸå­æ“ä½œï¼Œè¦ä¹ˆå…¨éƒ¨æˆåŠŸï¼Œè¦ä¹ˆå›æ»šæ‰€æœ‰æ“ä½œã€‚\n\n","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1586079428,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":165336,"user_name":"ğŸ‘» å°äºŒ","can_delete":false,"product_type":"c3","uid":1625463,"ip_address":"","ucode":"9EEA8553163270","user_header":"https://static001.geekbang.org/account/avatar/00/18/cd/77/b2ab5d44.jpg","comment_is_top":false,"comment_ctime":1577202427,"is_pvip":false,"replies":[{"id":65229,"content":"å¦‚æœç”¨majority è¯»ï¼Œè‚¯å®šè¿”å›æ˜¯2","user_name":"ä½œè€…å›å¤","user_name_real":"è¿œèˆªçš„TJ å”å»ºæ³•","uid":1260017,"ctime":1577974175,"ip_address":"","comment_id":165336,"utype":1}],"discussion_count":6,"race_medal":0,"score":2,"product_id":100040001,"comment_content":"è€å¸ˆï¼Œ è¯·é—®ä¸‹, majority è¯»æ—¶ï¼Œ æˆ‘æœ‰3ä¸ªèŠ‚ç‚¹ï¼Œåˆšå¼€å§‹ä¸‰ä¸ªèŠ‚ç‚¹ï¼Œ xå€¼éƒ½æ˜¯1ï¼Œ åé¢æ›´æ–°äº†x=2æ—¶ï¼Œ  aèŠ‚ç‚¹è·ŸbèŠ‚ç‚¹éƒ½æ›´æ–°äº†ï¼Œ cè¿˜æ²¡æ¥å¾—åŠæ›´æ–°ï¼Œ ç„¶åæˆ‘å»è¯»ï¼Œ åˆšå¥½è½åœ¨cèŠ‚ç‚¹ä¸Šï¼Œ é‚£æ­¤æ—¶ ä¼šè¿”å›1ï¼Ÿ  ","like_count":0,"discussions":[{"author":{"id":1260017,"avatar":"https://static001.geekbang.org/account/avatar/00/13/39/f1/6d18a4d1.jpg","nickname":"è¿œèˆªçš„TJ å”å»ºæ³•","note":"","ucode":"0719807390250A","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":479126,"discussion_content":"å¦‚æœç”¨majority è¯»ï¼Œè‚¯å®šè¿”å›æ˜¯2","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1577974175,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1625463,"avatar":"https://static001.geekbang.org/account/avatar/00/18/cd/77/b2ab5d44.jpg","nickname":"ğŸ‘» å°äºŒ","note":"","ucode":"9EEA8553163270","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":116244,"discussion_content":"ä½ å¥½ï¼Œmongoæ˜¯æ€ä¹ˆåˆ¤æ–­ç°åœ¨æ˜¯2çš„ï¼Œéš¾é“ä»–ä¼šåŒæ—¶è¯·æ±‚å¤šä¸ªç‚¹ï¼Ÿ","likes_number":1,"is_delete":false,"is_hidden":false,"ctime":1578058324,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"","child_discussion_number":2,"child_discussions":[{"author":{"id":1076081,"avatar":"https://static001.geekbang.org/account/avatar/00/10/6b/71/e833b14a.jpg","nickname":"æè‹±æƒ","note":"","ucode":"FECAC14A9C414B","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":1625463,"avatar":"https://static001.geekbang.org/account/avatar/00/18/cd/77/b2ab5d44.jpg","nickname":"ğŸ‘» å°äºŒ","note":"","ucode":"9EEA8553163270","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":220439,"discussion_content":"majorityè¯» è‚¯å®šæ˜¯å¼€é”€å¤§ä¸€äº›çš„ï¼Œæˆ‘çŒœæµ‹å¼€é”€å¤§å°±å¤§åœ¨äº†å»å¤šä¸ªèŠ‚ç‚¹ç¡®è®¤ç‰ˆæœ¬","likes_number":1,"is_delete":false,"is_hidden":false,"ctime":1585877275,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":116244,"ip_address":"","group_id":0},"score":220439,"extra":""},{"author":{"id":1306315,"avatar":"https://static001.geekbang.org/account/avatar/00/13/ee/cb/4bd24e0f.jpg","nickname":"å®˜äºº","note":"","ucode":"ECEF55B08E252B","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":1076081,"avatar":"https://static001.geekbang.org/account/avatar/00/10/6b/71/e833b14a.jpg","nickname":"æè‹±æƒ","note":"","ucode":"FECAC14A9C414B","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":390057,"discussion_content":"æŒ‰ç…§å¤šç‰ˆæœ¬æ§åˆ¶æ¥åˆ†æè¿™ä¸ªé—®é¢˜çš„è¯ æˆ‘çŒœæµ‹åº”è¯¥æ˜¯ä¼šç¡®è®¤ä¸€ä¸‹å¤§å¤šæ•°èŠ‚ç‚¹çš„ æ°´ä½åœ¨ä»€ä¹ˆä½ç½® æ°´ä½é«˜å°±è¿”å›é«˜æ°´ä½çš„æ•°å€¼ çŒœæµ‹æ˜¯è¿™æ ·çš„","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1629625799,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":220439,"ip_address":"","group_id":0},"score":390057,"extra":""}]},{"author":{"id":1241430,"avatar":"http://thirdwx.qlogo.cn/mmopen/vi_32/f4lPZg0qXT2FJvgmfiapD2R97e5TERdkibUBPpSM2dLoRY1xg2hCcE8rULmutkzFcWH5kibmRFicrZvzq1pp2lO7oQ/132","nickname":"å‘¨å¹•è¾°","note":"","ucode":"904D82C48C970F","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":629025,"discussion_content":"è¿™ä¸å°±æ˜¯t5æ—¶åˆ»,secondaryè¯»çš„ç»“æœï¼Œåº”è¯¥è¿”å›1","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1696523411,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":"å¹¿ä¸œ","group_id":0},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1363017,"avatar":"https://static001.geekbang.org/account/avatar/00/14/cc/49/d527d9df.jpg","nickname":"Gunners","note":"","ucode":"B7CDAC2B3C6BCF","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":205265,"discussion_content":"åŒä¸è§£","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1584283065,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":202646,"user_name":"ç‚ç‚","can_delete":false,"product_type":"c3","uid":1525840,"ip_address":"","ucode":"386E790507C66D","user_header":"http://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTIUlVIL2Y7gVjfuubGmkKVXUv9LUlZURwK0fwnHz4xrzaqf2BjwwSXXNwLrTcxdRnnwhTlwnV1Xcg/132","comment_is_top":false,"comment_ctime":1586041709,"is_pvip":false,"replies":null,"discussion_count":0,"race_medal":0,"score":2,"product_id":100040001,"comment_content":"è€å¸ˆè®²çš„â€œäº‹åŠ¡â€ï¼Œåº”è¯¥æ˜¯â€œå¤åˆ¶é›†â€æ¨¡å¼ä¸‹çš„å®‰å…¨è¯»å†™ï¼","like_count":3},{"had_liked":false,"id":163281,"user_name":"é•¿æœŸè§„åˆ’","can_delete":false,"product_type":"c3","uid":1019332,"ip_address":"","ucode":"5EF65E9115834B","user_header":"https://static001.geekbang.org/account/avatar/00/0f/8d/c4/6f97daea.jpg","comment_is_top":false,"comment_ctime":1576679596,"is_pvip":false,"replies":null,"discussion_count":0,"race_medal":0,"score":2,"product_id":100040001,"comment_content":"è€å¸ˆï¼Œæ‚¨ç»™çš„ç¤ºä¾‹ä¸­ï¼Œåœ¨ä¸¤ä¸ªä»èŠ‚ç‚¹è®¾ç½®fsyncLockï¼Œåœ¨ä¸»ä¸Šç”¨readconcern=majorityè¯»æ—¶ï¼Œä¸»ä¼šblockï¼Œblockæ˜¯åŸºäºä»€ä¹ˆè€ƒè™‘å‘¢ï¼Ÿä¸ºä½•è¦ç­‰å¾…å‘¢ï¼Œç›´æ¥å¿½ç•¥æœªåŒæ­¥åˆ°majorityçš„æ•°æ®ï¼Œç«‹å³è¿”å›å·²ç»majorityçš„ä¸è¡Œå—ï¼Ÿå¯¹æ¯”MySQLï¼Œè®¾ç½®æäº¤è¯»æ—¶ï¼Œç›´æ¥å¿½ç•¥æœªæäº¤çš„æ•°æ®ï¼Œè€Œä¸æ˜¯ç­‰å¾…ä»–ä»¬æäº¤ã€‚","like_count":2},{"had_liked":false,"id":163866,"user_name":"é•¿æœŸè§„åˆ’","can_delete":false,"product_type":"c3","uid":1019332,"ip_address":"","ucode":"5EF65E9115834B","user_header":"https://static001.geekbang.org/account/avatar/00/0f/8d/c4/6f97daea.jpg","comment_is_top":false,"comment_ctime":1576813876,"is_pvip":false,"replies":null,"discussion_count":1,"race_medal":0,"score":2,"product_id":100040001,"comment_content":"è€å¸ˆï¼Œæˆ‘åœ¨MongoDB3.6ä¸‹æµ‹è¯•æ‚¨çš„ç¤ºä¾‹ï¼Œå‘ç°åœ¨ä¸¤ä¸ªä»èŠ‚ç‚¹éƒ½è®¾ç½®db.fsyncLock()çš„æƒ…å†µä¸‹ï¼Œåœ¨ä¸»ä¸Šæ‰§è¡ŒreadConcern(&quot;majority&quot;)ï¼Œå¹¶ä¸ä¼šé˜»å¡ç­‰å¾…ï¼Œä¼šç«‹å³è¿”å›ï¼Œè¿”å›ç»“æœä¸­ä¸åŒ…å«x=1ï¼ˆè¯¥è®°å½•å†™å…¥ä¸»èŠ‚ç‚¹ï¼ŒæœªåŒæ­¥åˆ°ä»èŠ‚ç‚¹ï¼‰ã€‚ä½ ç”¨çš„æ˜¯4.2ç‰ˆæœ¬å—ï¼Ÿè¿™ä¸ªç‰ˆæœ¬æ˜¯å¢åŠ äº†ä»€ä¹ˆè®¾ç½®æ‰ä¼šå¯¼è‡´è¯»æ—¶é˜»å¡å§","like_count":1,"discussions":[{"author":{"id":2281842,"avatar":"","nickname":"ä½ å¥½ï¼ŒJava","note":"","ucode":"4FA103B707B78D","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":343688,"discussion_content":"æˆ‘ç”¨4.4ä¸€æ¨£ä¸æœƒé˜»å¡","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1611136040,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":224771,"user_name":"ç”°ç¿Œè¾°","can_delete":false,"product_type":"c3","uid":1430069,"ip_address":"","ucode":"4AF661C4C61C68","user_header":"https://static001.geekbang.org/account/avatar/00/15/d2/35/b25875e4.jpg","comment_is_top":false,"comment_ctime":1591536205,"is_pvip":false,"replies":null,"discussion_count":0,"race_medal":0,"score":2,"product_id":100040001,"comment_content":"mysqlçš„é»˜è®¤éš”ç¦»çº§åˆ«ä¸æ˜¯RRå˜›ï¼Ÿ","like_count":0},{"had_liked":false,"id":176968,"user_name":"æ·æ·åŒå­¦","can_delete":false,"product_type":"c3","uid":1179533,"ip_address":"","ucode":"529A326B898008","user_header":"https://static001.geekbang.org/account/avatar/00/11/ff/8d/8601f035.jpg","comment_is_top":false,"comment_ctime":1581238512,"is_pvip":false,"replies":null,"discussion_count":0,"race_medal":0,"score":2,"product_id":100040001,"comment_content":"é‚£mongoæ˜¯æ€ä¹ˆè§£å†³å¹»è¯»é—®é¢˜çš„å‘¢ï¼Ÿmysqlæ˜¯å¯é‡å¤è¯»è§£å†³çš„è®°å¾—ã€‚","like_count":0}]}