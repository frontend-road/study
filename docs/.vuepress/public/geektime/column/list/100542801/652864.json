{"id":652864,"title":"08ï½œæ•°æ®è·å–ï¼šå¦‚ä½•ä½¿ç”¨Scrapyæ¡†æ¶çˆ¬å–æ–°é—»æ•°æ®ï¼Ÿ","content":"<p>ä½ å¥½ï¼Œæˆ‘æ˜¯é»„é¸¿æ³¢ã€‚</p><p>ä¸Šä¸€èŠ‚è¯¾ï¼Œæˆ‘ä»¬å¯¹Scrapyæ¡†æ¶æœ‰äº†ä¸€ä¸ªæ•´ä½“çš„äº†è§£ï¼Œä¹Ÿå®é™…åœ°å®‰è£…äº†Scrapyåº“å¹¶æ­å»ºäº†ä¸€ä¸ªåŸºç¡€çš„Scrapyå·¥ç¨‹ã€‚è¿™èŠ‚è¯¾ï¼Œæˆ‘ä»¬å°±ç»§ç»­åœ¨è¿™ä¸ªå·¥ç¨‹çš„åŸºç¡€ä¸Šçˆ¬å–æ–°æµªæ–°é—»ä¸­çš„æ•°æ®ï¼Œå¹¶å¯¹çˆ¬å–åˆ°çš„æ•°æ®è¿›è¡Œè§£æã€‚</p><h2>ä½¿ç”¨Scrapyæ¡†æ¶æŠ“å–æ•°æ®</h2><p>æˆ‘ä»¬é¦–å…ˆæ‰“å¼€sina\\sina\\spiderä¸‹é¢çš„sina_spider.pyæ–‡ä»¶ï¼Œåœ¨è¿™ä¸ªæ–‡ä»¶ä¸­ï¼ŒScrapyæ¡†æ¶ç»™æˆ‘ä»¬å†™äº†ä¸€ä¸ªåŸºç¡€çš„æ¡†æ¶ä»£ç ã€‚</p><pre><code>import scrapy\n \nclass SinaSpiderSpider(scrapy.Spider):\n    name = 'sina_spider'\n    allowed_domains = ['sina.com.cn']\n    start_urls = ['http://sina.com.cn/']\n \n    def parse(self, response):\n        pass\n</code></pre><p>è¿™æ®µä»£ç ä¸»è¦æ˜¯å¯¹æ•´ä¸ªçˆ¬è™«ç¨‹åºåšäº†ä¸€ä¸ªç®€å•çš„å®šä¹‰ï¼Œå®šä¹‰äº†çˆ¬è™«çš„åå­—ä¸ºâ€œsina_spiderâ€ï¼Œçˆ¬å–çš„åŸŸåä¸ºâ€œsina.com.cnâ€ï¼Œçˆ¬å–çš„URLæ˜¯â€œ<a href=\"http://sina.com.cn/\">http://sina.com.cn/</a>â€ã€‚æœ€åå®ƒè¿˜è´´å¿ƒåœ°å¸®æˆ‘ä»¬å®šä¹‰äº†ä¸€ä¸ªè§£æå‡½æ•°ï¼Œè¿™ä¸ªè§£æå‡½æ•°çš„å…¥å‚å°±æ˜¯æœåŠ¡å™¨è¿”å›çš„responseå€¼ã€‚ç°åœ¨ï¼Œæˆ‘ä»¬è¦å¼€å§‹åˆ†ææˆ‘ä»¬è¦çˆ¬å–çš„å†…å®¹ï¼Œå¹¶å¯¹è¿™ä¸ªå‡½æ•°è¿›è¡Œæ”¹å†™ã€‚</p><h3>é¡µé¢åˆ†æ</h3><p>æˆ‘ä»¬å…ˆä»¥ç½‘æ˜“çš„å›½å†…æ–°é—»ä¸ºä¾‹æ¥åˆ†æä¸€ä¸‹ã€‚æˆ‘ä»¬å…ˆçœ‹ä¸‹é¢è¿™ä¸ªç•Œé¢ã€‚</p><p><img src=\"https://static001.geekbang.org/resource/image/10/c5/105f1037b22ba0d30f68346c39c065c5.png?wh=2412x1391\" alt=\"\"></p><p>æˆ‘ä»¬è¦åˆ†æçš„æ˜¯ç•Œé¢é‡Œæœ€æ–°æ–°é—»è¿™ä¸ªéƒ¨åˆ†ã€‚å¯ä»¥çœ‹åˆ°è¿™ä¸ªæ–°é—»åˆ—è¡¨ä¸­ä¸€å…±åŒ…å«äº†ä¸‹é¢è¿™å‡ éƒ¨åˆ†ï¼šæ ‡é¢˜ã€æ‘˜è¦ã€æ—¶é—´ã€å…³é”®è¯ã€‚æˆ‘ä»¬è¿˜å¯ä»¥çœ‹åˆ°ï¼Œæ—¶é—´åœ¨1å°æ—¶ä¹‹å†…çš„ä¼šæ˜¾ç¤ºä¸ºâ€œXXåˆ†é’Ÿå‰â€ï¼Œåœ¨1å°æ—¶ä»¥ä¸Šçš„ä¼šæ˜¾ç¤ºä»Šå¤©å…·ä½“çš„æŸä¸ªæ—¶é—´ç‚¹ã€‚</p><!-- [[[read_end]]] --><p>æ¥ç€æˆ‘ä»¬æŠŠé¡µé¢æ‹‰åˆ°æœ€ä¸‹é¢ã€‚</p><p><img src=\"https://static001.geekbang.org/resource/image/43/9e/43ed7a9c7a42f8cf44244f795372ba9e.png?wh=1659x1830\" alt=\"\"></p><p>å¯ä»¥çœ‹åˆ°ï¼Œä»Šå¤©ä¹‹å‰çš„æ–°é—»ä¼šæ˜¾ç¤ºå‡ºå…·ä½“çš„æ—¥æœŸï¼Œå¹¶ä¸”æœ€ä¸‹é¢æœ‰ä¸€ä¸ªå¯¼èˆªæ¡ç”¨æ¥ç¿»é¡µã€‚</p><p>æˆ‘ä»¬éšä¾¿ç‚¹å‡»ä¸€æ¡æ–°é—»è¿›å…¥è¯¦æƒ…é¡µçœ‹ä¸€ä¸‹ã€‚å¯ä»¥çœ‹åˆ°é‡Œé¢åŒ…å«äº†å›¾ç‰‡å’Œæ–‡å­—ï¼Œå…¶ä¸­æ–‡å­—éƒ¨åˆ†æœ€ä¸Šé¢æœ‰æ ‡é¢˜ï¼Œä¸‹é¢æœ‰æ—¥æœŸå’Œæ—¶é—´ï¼Œå†ä¸‹é¢æ˜¯æ­£æ–‡ã€‚å½“ç„¶ï¼Œè¿˜å……æ–¥ç€å¹¿å‘Šå’Œæˆ‘ä»¬ä¸éœ€è¦çš„ä¿¡æ¯ï¼Œè¿™äº›æˆ‘ä»¬æš‚æ—¶ä¸ç”¨ç®¡ã€‚</p><p><img src=\"https://static001.geekbang.org/resource/image/b9/2c/b9eb79c35ae40f4e2d3c4e607d7fa12c.png?wh=1475x1298\" alt=\"\"></p><p>æ¥ä¸‹æ¥æˆ‘ä»¬åˆ†æä¸€ä¸‹å‰é¢çš„åˆ—è¡¨ä»¥åŠè¿™ä¸ªè¯¦æƒ…é¡µçš„å†…å®¹ï¼ŒæŠ“å–æˆ‘ä»¬æƒ³è¦çš„ä¿¡æ¯ã€‚</p><p>æˆ‘ä»¬çŸ¥é“ï¼Œæ‰€æœ‰çš„é¡µé¢ä»æ ¹æœ¬ä¸Šæ¥è¯´éƒ½æ˜¯ç”±HTMLé¡µé¢æ„æˆçš„ï¼Œçˆ¬è™«æƒ³è¦çˆ¬å–çš„å†…å®¹å°±è—åœ¨è¿™äº›HTMLé¡µé¢ä¸­ã€‚åœ¨Chromeæµè§ˆå™¨ä¸­ï¼Œæˆ‘ä»¬æŒ‰ä¸‹é”®ç›˜ä¸Šçš„F12é”®å°±èƒ½å¤Ÿæ‰“å¼€å¼€å‘è€…å·¥å…·æ¨¡å¼ã€‚æˆ‘ä»¬å¯ä»¥åˆ©ç”¨è¿™ä¸ªæ¨¡å¼æŸ¥çœ‹ç½‘é¡µçš„HTMLæºæ–‡ä»¶ã€è¯·æ±‚çš„ä¿¡æ¯æ–‡ä»¶ä»¥åŠç½‘ç»œè¿”å›ç­‰ã€‚æˆ‘ä»¬é€‰æ‹©ä¸Šé¢çš„Elementé€‰é¡¹å¡ï¼Œå°±èƒ½çœ‹åˆ°ç½‘é¡µçš„HTMLæºæ–‡ä»¶ï¼Œå¦‚ä¸‹å›¾æ‰€ç¤ºã€‚</p><p><img src=\"https://static001.geekbang.org/resource/image/0c/cf/0cca5213c59b5eb24c2813850fef0dcf.png?wh=2734x1465\" alt=\"\"></p><p>å› ä¸ºæˆ‘ä»¬è¦æ‰¾çš„æ˜¯æˆ‘ä»¬éœ€è¦çš„åˆ—è¡¨ï¼Œæ‰€ä»¥æˆ‘ä»¬å¯ä»¥ç‚¹å‡»å¼€å‘è€…å·¥å…·å·¦ä¸Šè§’çš„å°ç®­å¤´ï¼Œå¦‚ä¸‹å›¾æ‰€ç¤ºã€‚</p><p><img src=\"https://static001.geekbang.org/resource/image/0c/8f/0c257c8072f7b1fb8649eb7e1f53cf8f.png?wh=2036x290\" alt=\"\"></p><p>ç„¶åç”¨é¼ æ ‡ç‚¹å‡»æˆ‘ä»¬æƒ³è¦çš„åˆ—è¡¨ï¼Œå³ä¾§çš„HTMLä»£ç å°±ä¼šè·Ÿç€è·³è½¬åˆ°ç›¸åº”çš„éƒ¨åˆ†ã€‚</p><p><img src=\"https://static001.geekbang.org/resource/image/dd/8b/dd94c05aa27ebc26148f56cb9c90258b.png?wh=2330x1065\" alt=\"\"></p><p>é‚£ä¹ˆè¿™ä¸ªæ—¶å€™ï¼Œæˆ‘ä»¬éœ€è¦æ‰¾åˆ°è¿™é‡Œé¢çš„å…¶ä¸­ä¸€æ¡ï¼Œç„¶åæŸ¥çœ‹å³é¢çš„HTMLæºæ–‡ä»¶ã€‚</p><p><img src=\"https://static001.geekbang.org/resource/image/4f/85/4fff3041b2f175a092604a3d29b70285.png?wh=2335x994\" alt=\"\"></p><p>æˆ‘ä»¬å¯ä»¥å‘ç°ï¼Œå®é™…ä¸Šï¼Œåœ¨è¿™ä¸ªåˆ—è¡¨ä¸­ï¼Œæ¯ä¸€æ¡å†…å®¹éƒ½ä¼šè¢«åŒ…å«åœ¨classä¸ºâ€œfeed-card-itemâ€çš„æ ‡ç­¾ä¸­ï¼Œæˆ‘ä»¬æŠŠè¿™ä¸ªæ ‡ç­¾å±•å¼€æ¥è¯¦ç»†åœ°åˆ†æä¸€ä¸‹ã€‚</p><p><img src=\"https://static001.geekbang.org/resource/image/5a/d8/5a27522b9d887103a5b270d4930ca6d8.png?wh=1893x719\" alt=\"\"></p><p>å¯ä»¥çœ‹åˆ°ï¼Œæ ‡é¢˜è¢«åŒ…å«åœ¨h2æ ‡ç­¾é‡Œçš„aæ ‡ç­¾ä¸­ï¼Œæ—¶é—´è¢«åŒ…å«åœ¨h2æ ‡ç­¾é‡Œclassä¸ºfeed-card-a feed-card-clearfixä¸‹é¢çš„feed-card-timeä¸­ï¼Œç„¶åè¿™æ¡å†…å®¹çš„é“¾æ¥å°±æ˜¯h2æ ‡ç­¾é‡Œçš„aæ ‡ç­¾çš„é“¾æ¥ã€‚</p><p>å¥½äº†ï¼ŒçŸ¥é“äº†æˆ‘ä»¬è¦çš„æ ‡é¢˜ã€æ—¶é—´ä»¥åŠå¯¹åº”çš„é“¾æ¥ï¼Œæ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬å°±å¯ä»¥é€šè¿‡çˆ¬è™«æŠŠå®ƒä»¬æ‹¿ä¸‹æ¥äº†ã€‚</p><h3>çˆ¬å–åˆ—è¡¨</h3><p>ä½¿ç”¨Scrapyæ‹¿æ ‡ç­¾ï¼Œæ¯”è¾ƒæ–¹ä¾¿çš„ä¸€ç§æ–¹æ³•æ˜¯ä½¿ç”¨Seleniumåº“ã€‚</p><p>Seleniumæ˜¯ä¸€ä¸ªç”¨äºæµ‹è¯•Webåº”ç”¨ç¨‹åºçš„å·¥å…·ï¼ŒSeleniumæµ‹è¯•å¯ä»¥ç›´æ¥è¿è¡Œåœ¨æµè§ˆå™¨ä¸­ï¼Œå°±åƒçœŸæ­£çš„ç”¨æˆ·åœ¨æ“ä½œä¸€æ ·ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨Seleniumåº“æ¥æ¨¡æ‹Ÿç‚¹å‡»ã€ä¸Šæ»‘å’Œä¸‹æ»‘ç­‰æ“ä½œã€‚</p><p>è¦æƒ³ä½¿ç”¨è¿™ä¸ªåº“ï¼Œé¦–å…ˆè¦åœ¨å¼€å‘ç¯å¢ƒä¸­å®‰è£…å®ƒã€‚å®‰è£…æ–¹æ³•ä¹Ÿæ¯”è¾ƒç®€å•ï¼Œç›´æ¥åœ¨æˆ‘ä»¬çš„Anacondaç¯å¢ƒä¸­ä½¿ç”¨pipå®‰è£…å°±å¥½ã€‚å…·ä½“åšæ³•æ˜¯åˆ‡æ¢åˆ°scrapy_recommendationç¯å¢ƒä¸­ï¼Œæ‰§è¡Œä¸‹é¢çš„å‘½ä»¤ã€‚</p><pre><code>pip install selenium\n</code></pre><p>å®‰è£…å®Œæˆåå¦‚å›¾æ‰€ç¤ºã€‚</p><p><img src=\"https://static001.geekbang.org/resource/image/45/78/45128e532b0a6bcd316f8ca61500c078.png?wh=1905x983\" alt=\"\"></p><p>æ¥ä¸‹æ¥æˆ‘ä»¬å°±å¯ä»¥ä½¿ç”¨Seleniumæ¥è¿›è¡Œæµè§ˆå™¨é¡µé¢è®¿é—®å·¥ä½œäº†ï¼Œæˆ‘ä»¬æŠŠä¸Šé¢çš„ä»£ç æ”¹å†™å¦‚ä¸‹ã€‚</p><pre><code>import scrapy\nfrom scrapy.http import Request\nfrom selenium import webdriver\n \n \nclass SinaSpiderSpider(scrapy.Spider):\n    name = 'sina_spider'\n \n \n    def __init__(self):\n        self.start_urls = ['https://news.sina.com.cn/china/']\n        self.option = webdriver.ChromeOptions()\n        self.option.add_argument('no=sandbox')\n        self.option.add_argument('--blink-setting=imagesEnable=false')\n \n    def start_requests(self):\n        for url in self.start_urls:\n            yield Request(url=url, callback=self.parse)\n \n    def parse(self, response):\n        driver = webdriver.Chrome(chrome_options=self.option)\n        driver.set_page_load_timeout(30)\n        driver.get(response.url)\n \n        title = driver.find_elements_by_xpath(&quot;//h2[@class='undefined']/a[@target='_blank']&quot;)\n        time = driver.find_elements_by_xpath(&quot;//h2[@class='undefined']/../div[@class='feed-card-a &quot;\n                                             &quot;feed-card-clearfix']/div[@class='feed-card-time']&quot;)\n \n        for i in range(len(title)):\n            print(title[i].text)\n            print(time[i].text)\n</code></pre><p>å¯ä»¥çœ‹åˆ°ï¼Œè¿™æ®µä»£ç ç›¸æ¯”ä¸Šé¢é‚£æ®µä»£ç æœ‰äº†éå¸¸å¤§çš„æ”¹å˜ã€‚é¦–å…ˆï¼Œåœ¨æœ€ä¸Šé¢ï¼Œæˆ‘ä»¬å¤šå¯¼å…¥äº†ä¸¤ä¸ªåŒ…ã€‚</p><pre><code>from scrapy.http import Request\nfrom selenium import webdriver\n</code></pre><p>è¿™æ®µä»£ç ç¬¬ä¸€è¡Œçš„æ„æ€æ˜¯ä»Scrapyçš„httpæ¨¡å—å¯¼å…¥Requestè¿™ä¸ªåŒ…ï¼Œç¬¬äºŒè¡Œçš„æ„æ€æ˜¯ä»Seleniumåº“å¯¼å…¥Webdriverè¿™ä¸ªåŒ…ã€‚</p><p>RequeståŒ…é¡¾åæ€ä¹‰ï¼Œå°±æ˜¯ç”¨æ¥åšHTTPè¯·æ±‚ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œæˆ‘ä»¬åœ¨å‘ç½‘ç«™æœåŠ¡å™¨è¯·æ±‚æ•°æ®æ—¶ï¼Œå°±æ˜¯RequeståŒ…åœ¨èµ·ä½œç”¨ã€‚è€ŒSeleniumä¸‹é¢çš„webdriveråŒ…æ˜¯ä¸€ç»„å¼€æºçš„APIï¼Œç”¨äºè‡ªåŠ¨åŒ–æµ‹è¯•Webåº”ç”¨ç¨‹åºã€‚åœ¨æˆ‘ä»¬çš„ç¨‹åºä¸­ï¼Œä¸»è¦æ˜¯åˆ©ç”¨å®ƒæ¥æ‰“å¼€æµè§ˆå™¨ï¼Œä»¥åŠè®¾ç½®æ‰“å¼€æ—¶çš„ä¸€äº›ä¿¡æ¯ã€‚</p><p>æ¥ç€ï¼Œæˆ‘ä»¬æŠŠè¿™ä¸ªclassè¿›è¡Œäº†é‡æ„ï¼ŒåŠ å…¥äº†__init__è¿™ä¸ªæ„é€ å‡½æ•°ã€‚æˆ‘ä»¬å¯ä»¥å…ˆç²—ç•¥åœ°ç†è§£ä¸ºï¼Œå½“æˆ‘ä»¬è¿è¡Œè¿™ä¸ªPythonæ–‡ä»¶æ—¶ï¼Œå°±ä¼šå…ˆå»æ‰§è¡Œ__init__å‡½æ•°é‡Œé¢çš„å†…å®¹ã€‚</p><p>æˆ‘ä»¬å°†ä¹‹å‰çš„start_urlsåŠ å…¥åˆ°äº†__init__ä¸­ï¼Œå¹¶åœ¨å‰é¢åŠ ä¸Šselfã€‚æ¥ç€ï¼Œæˆ‘ä»¬å®šä¹‰äº†webdriverä¸­å…³äºChromeæµè§ˆå™¨çš„ä¸€äº›å‚æ•°ã€‚</p><pre><code>self.option = webdriver.ChromeOptions()\nself.option.add_argument('no=sandbox')\nself.option.add_argument('--blink-setting=imagesEnable=false')\n</code></pre><p>æˆ‘åœ¨è¿™é‡ŒåŠ äº†ä¸¤ä¸ªå‚æ•°ï¼Œä¸€ä¸ªæ˜¯â€œno=sandboxâ€ï¼Œå®ƒè¡¨ç¤ºå–æ¶ˆæ²™ç›’æ¨¡å¼ï¼Œä¹Ÿå°±æ˜¯è¯´è®©å®ƒåœ¨rootæƒé™ä¸‹æ‰§è¡Œã€‚å¦ä¸€ä¸ªå‚æ•°æ˜¯â€œâ€“blink-setting=imagesEnable=falseâ€ï¼Œå®ƒè¡¨ç¤ºä¸åŠ è½½å›¾ç‰‡ï¼Œå› ä¸ºæˆ‘ä»¬åªæƒ³è¦æ–‡å­—éƒ¨åˆ†ï¼ŒåŠ ä¸Šè¿™ä¸€å¥å¯ä»¥æå‡çˆ¬å–é€Ÿåº¦å’Œæ•ˆç‡ã€‚</p><p>æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬å¢åŠ äº†ä¸€ä¸ªstart_requests()å‡½æ•°ï¼Œè¿™å®é™…ä¸Šä¹Ÿæ˜¯Scrapyè‡ªå¸¦çš„å‡½æ•°ï¼Œå®ƒçš„ä¸»è¦ä½œç”¨æ˜¯å®šä¹‰Scrapyæ¡†æ¶çš„èµ·å§‹è¯·æ±‚ï¼Œå¦‚æœåœ¨è¿™ä¸ªèµ·å§‹è¯·æ±‚ä¸­æœ‰é‡å¤çš„URLï¼Œå®ƒä¼šè‡ªåŠ¨è¿›è¡Œå»é‡æ“ä½œã€‚</p><pre><code>def start_requests(self):\n        for url in self.start_urls:\n            yield Request(url=url, callback=self.parse)\n</code></pre><p>ç„¶ååœ¨è§£æå‡½æ•°ä¸­ï¼Œæˆ‘ä»¬å®šä¹‰äº†ä¸€ä¸ªdriverï¼Œå®ƒè°ƒç”¨äº†webdriverçš„chromeå‡½æ•°ï¼Œä»£è¡¨è¿™æ˜¯ä½¿ç”¨Chromeæµè§ˆå™¨æ¥çˆ¬å–çš„ã€‚æˆ‘ä»¬è¿˜æŠŠåŠ è½½é¡µé¢çš„è¶…æ—¶æ—¶é—´è®¾ç½®ä¸ºäº†30ç§’ï¼Œä¹Ÿå°±æ˜¯è¯´å¦‚æœ30ç§’è¿˜åŠ è½½ä¸å‡ºæ¥ï¼Œå°±å»è¯·æ±‚ä¸‹ä¸€ä¸ªé¡µé¢ï¼Œè€Œè¿™ä¸‹ä¸€ä¸ªé¡µé¢å°±æ˜¯ä»start_requests()å‡½æ•°ä¸­è·å¾—çš„ã€‚ç„¶åæˆ‘ä»¬è°ƒç”¨driver.getæ¥è·å–responseçš„URLï¼Œå°±å¯ä»¥æ‹¿åˆ°responseä¿¡æ¯äº†ã€‚</p><pre><code>def parse(self, response):\n    driver = webdriver.Chrome(chrome_options=self.option)\n    driver.set_page_load_timeout(30)\n    driver.get(response.url)\n\n\n    title = driver.find_elements_by_xpath(&quot;//h2[@class='undefined']/a[@target='_blank']&quot;)\n    time = driver.find_elements_by_xpath(&quot;//h2[@class='undefined']/../div[@class='feed-card-a &quot;\n                                         &quot;feed-card-clearfix']/div[@class='feed-card-time']&quot;)\n\n\n    for i in range(len(title)):\n        print(title[i].text)\n        print(time[i].text)\n</code></pre><p>åœ¨åé¢çš„ä»£ç ä¸­ï¼Œæˆ‘ä»¬ä¸»è¦åˆåšäº†ä¸¤ä»¶äº‹ã€‚ä¸€ä¸ªæ˜¯è·å–titleä¿¡æ¯ï¼Œä¸€ä¸ªæ˜¯è·å–timeä¿¡æ¯ã€‚</p><p>æˆ‘ä»¬ä½¿ç”¨driver.find_elements_by_xpath()å‡½æ•°è·å–HTMLæ ‡ç­¾ä¸­çš„å†…å®¹ï¼Œæ ¹æ®æˆ‘ä»¬åœ¨æœ€å‰é¢çš„åˆ†æï¼Œtitleè¢«å­˜åœ¨â€œ//h2[@class=â€˜undefinedâ€™]/a[@target=â€˜_blankâ€™]â€ä¸­ï¼Œè€Œtimeè¢«å­˜åœ¨â€œ//h2[@class=â€˜undefinedâ€™]/â€¦/div[@class=â€˜feed-card-a feed-card-clearfixâ€™]/div[@class=â€˜feed-card-timeâ€™]â€ä¸­ï¼Œå› æ­¤ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡driver.find_elements_by_xpath()è·å–åˆ°é‡Œé¢çš„å†…å®¹ã€‚</p><p><strong>è¦æ³¨æ„çš„æ˜¯ï¼Œæˆ‘ä»¬è·å–åˆ°çš„å†…å®¹ä¸€èˆ¬æ˜¯ä»¥ä¸€ä¸ªlistçš„å½¢å¼å­˜æ”¾ï¼Œæ‰€ä»¥æˆ‘ä»¬è¿˜éœ€è¦ä½¿ç”¨forå¾ªç¯æ‹¿åˆ°é‡Œé¢çš„ä¿¡æ¯ã€‚</strong></p><p>æ­£å¸¸æ¥è®²ï¼Œå®Œæˆä¸Šé¢è¿™æ®µä»£ç ä¹‹åï¼Œè¿è¡Œmain.pyæ–‡ä»¶ï¼Œå°±ä¼šå¾—åˆ°å¦‚ä¸‹å›¾æ‰€ç¤ºçš„ç»“æœã€‚</p><p><img src=\"https://static001.geekbang.org/resource/image/3d/87/3d2c52211yy4acc2b2b45350ac59df87.png?wh=2895x1299\" alt=\"\"></p><p>å¯ä»¥çœ‹åˆ°ï¼Œæˆ‘ä»¬æƒ³è¦çš„æ—¶é—´å’Œæ ‡é¢˜éƒ½å·²ç»è¾“å‡ºå‡ºæ¥äº†ã€‚</p><p>ä¸è¿‡ï¼Œè™½ç„¶æˆ‘ä»¬ç°åœ¨å·²ç»å¾—åˆ°äº†æ—¶é—´ï¼Œä½†æ˜¯è¾“å‡ºçš„æ ¼å¼å´ä¸ç»Ÿä¸€ï¼šæœ‰çš„æ˜¾ç¤ºçš„æ˜¯ä»Šå¤©çš„æŸä¸ªæ—¶é—´ï¼Œæœ‰çš„æ˜¾ç¤ºçš„æ˜¯æ—¥æœŸåŠ æ—¶é—´ã€‚æ‰€ä»¥æˆ‘ä»¬è¦å¯¹æ—¶é—´åšè¿›ä¸€æ­¥å¤„ç†ï¼Œå¯ä»¥åœ¨åˆšåˆšçš„forå¾ªç¯ä»£ç ä¸‹é¢åŠ ä¸Šå¤„ç†ä»£ç ã€‚</p><pre><code>\ttoday = datetime.datetime.now()\n            eachtime = time[i].text\n            eachtime = eachtime.replace('ä»Šå¤©', str(today.month) + 'æœˆ' + str(today.day) + 'æ—¥')\n \n            if 'åˆ†é’Ÿå‰' in eachtime:\n                minute = int(eachtime.split('åˆ†é’Ÿå‰')[0])\n                t = datetime.datetime.now() - datetime.timedelta(minutes=minute)\n                t2 = datetime.datetime(year=t.year, month=t.month, day=t.day, hour=t.hour, minute=t.minute)\n            else:\n                if 'å¹´' not in eachtime:\n                    eachtime = str(today.year) + 'å¹´' + eachtime\n                t1 = re.split('[å¹´æœˆæ—¥:]', eachtime)\n                t2 = datetime.datetime(year=int(t1[0]), month=int(t1[1]), day=int(t1[2]), hour=int(t1[3]),\n                                       minute=int(t1[4]))\n \n            print(t2)\n</code></pre><p>æˆ‘ä»¬å†è¿è¡Œä¸€ä¸‹ç¨‹åºï¼Œå¾—åˆ°å¦‚ä¸‹ç»“æœã€‚</p><p><img src=\"https://static001.geekbang.org/resource/image/ed/46/edb1674167760b7b852d23e8cc29e046.png?wh=2552x870\" alt=\"\"></p><p>å¯ä»¥çœ‹åˆ°ï¼Œç°åœ¨æ—¶é—´å·²ç»å˜æˆäº†æˆ‘ä»¬æƒ³è¦çš„æ ·å­ã€‚<strong>åˆ°è¿™é‡Œæˆ‘ä»¬çš„åˆ—è¡¨çˆ¬å–å·¥ä½œå°±å®Œæˆäº†ï¼Œæ¥ä¸‹æ¥å¼€å§‹çˆ¬å–è¯¦æƒ…é¡µçš„ä¿¡æ¯ã€‚</strong></p><h3>çˆ¬å–è¯¦æƒ…é¡µ</h3><p>æˆ‘ä»¬çŸ¥é“ï¼Œå¦‚æœæ˜¯äººä¸ºæ“ä½œï¼Œéœ€è¦ç‚¹å‡»ç›¸åº”æ ‡é¢˜è¿›å…¥è¯¦æƒ…é¡µã€‚å¯¹äºçˆ¬è™«ç¨‹åºæ¥è¯´ä¹Ÿæ˜¯ä¸€æ ·çš„ï¼Œæˆ‘ä»¬éœ€è¦ä»HTMLæ–‡ä»¶ä¸­æå–æ ‡é¢˜å¯¹åº”çš„é“¾æ¥ï¼Œç„¶åå†ä¼ ç»™çˆ¬è™«ç¨‹åºè¿›è¡Œæ•°æ®çš„çˆ¬å–ï¼Œæœ€åå¤„ç†å¯¹åº”çš„responseã€‚</p><p>æˆ‘ä»¬å…ˆæ¥çœ‹çœ‹æ€ä¹ˆè·å–æˆ‘ä»¬æ‰€éœ€è¦çš„é“¾æ¥ã€‚</p><p><img src=\"https://static001.geekbang.org/resource/image/43/2b/43b7d4b9ed070a150056a4c3d224d42b.png?wh=2007x1249\" alt=\"\"></p><p>é€šè¿‡åˆ†æHTMLæºæ–‡ä»¶æˆ‘ä»¬å¯ä»¥çœ‹åˆ°ï¼Œæ¯ä¸€ä¸ªæ ‡é¢˜éƒ½åœ¨aæ ‡ç­¾ä¸­ï¼Œè€Œaæ ‡ç­¾é‡Œé¢çš„hrefå°±æ˜¯å®ƒæ‰€å¯¹åº”çš„é“¾æ¥ã€‚æ‰€ä»¥ï¼Œæˆ‘ä»¬åªéœ€è¦å–å‡ºhrefï¼Œå°±å¯ä»¥å–å‡ºè¯¦æƒ…é¡µçš„é“¾æ¥äº†ã€‚</p><p>è¦å®ç°è¿™ä¸€ç‚¹ï¼Œæˆ‘ä»¬åªéœ€è¦åœ¨è§£ætitleåé¢åŠ ä¸Šä¸‹é¢è¿™æ¡ä»£ç ã€‚</p><pre><code>href = title[i].get_attribute('href')\n</code></pre><p>æ¥ä¸‹æ¥ï¼Œä¸ºäº†è·å–æ­£æ–‡ä¿¡æ¯ï¼Œåœ¨Scrapyä¸­ï¼Œæˆ‘ä»¬éœ€è¦æŠŠrequestè¯·æ±‚ç»™yieldå‡ºå»ï¼Œåœ¨é‡Œé¢æ”¾ä¸Šé“¾æ¥ã€‚</p><p>é¦–å…ˆï¼Œæˆ‘ä»¬æŠŠéœ€è¦çš„å†…å®¹yieldåˆ°ä¸‹ä¸€é¡µï¼Œä¼ é€’å®ƒæœ€å¥½çš„æ–¹å¼å°±æ˜¯ä½¿ç”¨ItemPipelineã€‚å¯ä»¥çœ‹åˆ°æˆ‘ä»¬åˆ›å»ºScrapyå·¥ç¨‹ä¹‹åï¼Œå·¥ç¨‹ç›®å½•ä¸‹ä¼šè‡ªåŠ¨åˆ›å»ºä¸€ä¸ªitems.pyã€‚æˆ‘ä»¬æ‰“å¼€è¿™ä¸ªæ–‡ä»¶ï¼Œä¼šå‘ç°å®ƒè‡ªå¸¦äº†ä¸€äº›ä»£ç ã€‚</p><pre><code># Define here the models for your scraped items\n#\n# See documentation in:\n# https://docs.scrapy.org/en/latest/topics/items.html\n \nimport scrapy\n \n \nclass SinaItem(scrapy.Item):\n    # define the fields for your item here like:\n    # name = scrapy.Field()\n    pass\n</code></pre><p>è¿™æ®µä»£ç é‡Œå¯¼å…¥äº†scrapyåŒ…ï¼Œå¹¶è‡ªåŠ¨å¸®æˆ‘ä»¬åˆ›å»ºäº†ä¸€ä¸ªSinaItemç±»ï¼Œè¿™é‡Œè¿˜é€šè¿‡æ³¨é‡Šçš„æ–¹æ³•å‘Šè¯‰äº†æˆ‘ä»¬è¿™ä¸ªç±»é‡Œé¢åº”è¯¥æ€ä¹ˆå†™ã€‚æˆ‘ä»¬å°±æ¥ç…§è‘«èŠ¦ç”»ç“¢ï¼ŒæŠŠæˆ‘ä»¬æƒ³è¦çš„å­—æ®µåŠ å…¥è¿›æ¥ã€‚</p><p>ä»£ç ä¼šå˜æˆå¦‚ä¸‹å½¢å¼ã€‚</p><pre><code>class SinaItem(scrapy.Item):\n    # define the fields for your item here like:\n    # name = scrapy.Field()\n    title = scrapy.Field()\n    desc = scrapy.Field()\n    times = scrapy.Field()\n\ttype = scrapy.Field()\n</code></pre><p>æˆ‘ä»¬åœ¨é‡Œé¢å®šä¹‰äº†å››ä¸ªå­—æ®µï¼Œåˆ†åˆ«æ˜¯titleã€descã€timeså’Œtypeï¼Œåˆ†åˆ«ç”¨æ¥è¡¨ç¤ºæ ‡é¢˜ã€å†…å®¹ã€æ—¶é—´å’Œç±»å‹ã€‚è¿™é‡Œçš„æ ‡é¢˜å’Œæ—¶é—´é€šè¿‡åˆ—è¡¨æ¥è·å–ï¼Œå†…å®¹æ˜¯è¯¦æƒ…é¡µé‡Œçš„ã€‚è€Œç±»å‹æˆ‘ä»¬é»˜è®¤ä¸ºå›½å†…ï¼Œå¦‚æœåé¢æˆ‘ä»¬éœ€è¦çˆ¬å–å…¶ä»–çš„ç±»åˆ«ï¼Œæ¯”å¦‚ç»¼è‰ºã€ä½“è‚²ç­‰ï¼Œæˆ‘ä»¬å°±ä¸éœ€è¦æ–°å»ºclassäº†ï¼Œåªè¦é‡æ–°åœ¨è¿™ä¸ªtypeå­—æ®µä¸­èµ‹å€¼å³å¯ã€‚</p><p>å¥½äº†ï¼Œè¿›è¡Œåˆ°è¿™é‡Œï¼Œæˆ‘ä»¬å°±å¯ä»¥å›åˆ°æˆ‘ä»¬çš„çˆ¬è™«ä»£ç å»å¼•å…¥è¿™éƒ¨åˆ†å†…å®¹äº†ã€‚é¦–å…ˆæˆ‘ä»¬è¦åœ¨ç¬¬ä¸€è¡Œå¼•å…¥æˆ‘ä»¬çš„itemæ–‡ä»¶ï¼ŒåŠ å…¥ä¸‹é¢çš„ä»£ç ã€‚</p><pre><code>from sina.items import SinaItem\n</code></pre><p>ç„¶åï¼Œæˆ‘ä»¬åœ¨çˆ¬è™«æ–‡ä»¶çš„parseå‡½æ•°ä¸­å¼•å…¥SinaItemç±»ï¼Œå¹¶åœ¨å‡½æ•°çš„æœ«å°¾å¯¹å…¶èµ‹å€¼æˆ‘ä»¬æƒ³è¦çš„å†…å®¹ã€‚</p><pre><code>item = SinaItem()\nitem['type'] = 'news'\nitem['title'] = title[i].text\nitem['times'] = t2\n</code></pre><p>æ¥ç€ï¼Œæˆ‘ä»¬å¯ä»¥åœ¨æœ€åæŠŠitemç»™yieldå‡ºå»ï¼Œåœ¨ä»£ç çš„æœ€ååŠ å…¥å¦‚ä¸‹å†…å®¹ã€‚</p><pre><code>yield Request(url=response.urljoin(href), meta={'name': item}, callback=self.parse_namedetail)\n</code></pre><p>è¿™æ ·æˆ‘ä»¬å°±å¯ä»¥é¡ºåˆ©åœ°æŠŠitemä¿¡æ¯å’ŒURLç»™yieldå‡ºå»äº†ã€‚</p><p>æˆ‘ä»¬æ¥çœ‹è¿™ä¸ªyieldçš„å†™æ³•ã€‚æˆ‘ä»¬yieldå‡ºå»çš„å†…å®¹æœ‰ä¸¤ä¸ªï¼Œåˆ†åˆ«æ˜¯URLä¿¡æ¯å’Œitemã€‚itemç”¨Key-Valueçš„å½¢å¼ä¼ è¾“ï¼Œæˆ‘ä»¬æŠŠå®ƒèµ‹å€¼åˆ°äº†Keyä¸ºâ€œnameâ€çš„é”®å€¼å¯¹ä¸­ã€‚</p><p>ç„¶åæˆ‘ä»¬åœ¨è¿™é‡Œè¿˜ç”¨åˆ°äº†ä¸€ä¸ªcallbackå‡½æ•°ï¼Œå®ƒå®é™…ä¸Šæ˜¯å›è°ƒäº†ä¸€ä¸ªåä¸ºparse_namedetailçš„å‡½æ•°ã€‚æ‰€ä»¥ï¼Œæˆ‘ä»¬éœ€è¦åœ¨ä¸‹é¢å»ºç«‹è¿™ä¸ªå‡½æ•°è§£ææˆ‘ä»¬çš„è¯¦æƒ…é¡µä¿¡æ¯ã€‚æˆ‘ä»¬åœ¨parseå‡½æ•°çš„ä¸‹é¢æ–°å»ºä¸€ä¸ªå‡½æ•°parse_namedeatalå¹¶å®ç°å®ƒï¼Œä»£ç å¦‚ä¸‹ã€‚</p><pre><code>def parse_namedetail(self, response):\n\tselector = Selector(response)\n\tdesc = selector.xpath(&quot;//div[@class='article']/p/text()&quot;).extract()\n\titem = response.meta['name']\n\tdesc = list(map(str.strip, desc))\n\titem['desc'] = ''.join(desc)\n\tprint(item)\n\tyield item\n</code></pre><p>åœ¨è¿™ä¸ªå‡½æ•°ä¸­ï¼Œæˆ‘ä»¬é¦–å…ˆå»ºç«‹äº†ä¸€ä¸ªSelectorï¼Œå®ƒä¸»è¦æ˜¯Responseç”¨æ¥æå–æ•°æ®çš„ã€‚å½“Spiderçš„Requestå¾—åˆ°Responseä¹‹åï¼ŒSpiderå¯ä»¥ä½¿ç”¨Selectoræå–Responseä¸­çš„æœ‰ç”¨çš„æ•°æ®ã€‚å› æ­¤ï¼Œè¿™é‡Œæˆ‘ä»¬ä¼ å…¥çš„æ˜¯ä¸Šé¢çš„Responseä¿¡æ¯ï¼Œä¹Ÿå°±æ˜¯è¯¦æƒ…é¡µçš„Responseã€‚</p><p>ç„¶åï¼Œæˆ‘ä»¬ä½¿ç”¨XPathè¯­æ³•è§£æresponseä¸­çš„HTMLä»£ç ã€‚æˆ‘ä»¬å…ˆæ¥çœ‹ä¸‹æœ‰å“ªäº›XPathè¡¨è¾¾å¼ï¼Œä»¥ä¾¿åç»­æˆ‘ä»¬æ›´å¥½åœ°ä½¿ç”¨å®ƒã€‚</p><p><img src=\"https://static001.geekbang.org/resource/image/e2/8b/e276155304958748328c3b3b8855708b.jpg?wh=2076x2000\" alt=\"\"></p><p>ç„¶åæˆ‘ä»¬å†æ¥çœ‹ä¸€ä¸‹è¯¦æƒ…é¡µçš„æ­£æ–‡éƒ¨åˆ†åœ¨Chromeçš„å¼€å‘è€…å·¥å…·ä¸­çš„æºä»£ç ã€‚</p><p><img src=\"https://static001.geekbang.org/resource/image/f8/c4/f857999da6671773df7a051d8d1174c4.png?wh=2701x1236\" alt=\"\"></p><p>æ”¾å¤§ä»£ç éƒ¨åˆ†å¾—åˆ°å¦‚ä¸‹ç»“æœã€‚</p><p><img src=\"https://static001.geekbang.org/resource/image/6d/70/6dfc9455479797619e9dbf7ba2532470.png?wh=2154x1224\" alt=\"\"></p><p>å¯ä»¥çœ‹åˆ°ï¼Œæ‰€æœ‰çš„æ­£æ–‡éƒ¨åˆ†éƒ½åœ¨classä¸ºarticleå’Œidä¸ºarticleçš„<code>&lt;div&gt;</code>æ ‡ç­¾ä¸­ï¼Œå¹¶ä¸”æ¯ä¸ªæ®µè½éƒ½ç”¨<code>&lt;p&gt;</code>æ ‡ç­¾åŒ…è£¹ç€ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œæˆ‘ä»¬åªéœ€è¦æ‹¿åˆ°classå’Œidçš„æ ‡ç­¾ï¼Œå¹¶ä¸”æ‹¿åˆ°æ‰€æœ‰çš„pæ ‡ç­¾ï¼Œå°±å¯ä»¥æ‹¿å‡ºæ‰€æœ‰çš„å†…å®¹ã€‚å› æ­¤æˆ‘ä»¬å¯ä»¥ä½¿ç”¨ä¸‹é¢è¿™è¡Œä»£ç æ¥è·å–æ‰€æœ‰çš„æ­£æ–‡å†…å®¹ã€‚</p><pre><code>desc = selector.xpath(&quot;//div[@class='article']/p/text()&quot;).extract()\n</code></pre><p>ç®€å•è§£é‡Šä¸€ä¸‹ï¼Œæˆ‘ä»¬ä½¿ç”¨  <code>//</code>  æ ‡å¿—è·¨èŠ‚ç‚¹è·å–åˆ°äº†classä¸ºarticleçš„æ®µè½ä¸‹é¢æ‰€æœ‰pæ ‡ç­¾ä¸­çš„å†…å®¹ï¼Œå¹¶æŠŠå®ƒä»¬æå–äº†å‡ºæ¥ã€‚æ¥ç€ï¼Œæˆ‘ä»¬ä½¿ç”¨ä¸‹é¢çš„ä»£ç æ‹¿åˆ°äº†å‰é¢ä¼ å…¥çš„itemä¿¡æ¯ï¼Œå¹¶æŠŠdescåŠ å…¥åˆ°äº†itemä¸­ã€‚</p><pre><code>item = response.meta['name']\ndesc = list(map(str.strip, desc))\nitem['desc'] = ''.join(desc)\n</code></pre><p>æœ€åï¼Œæˆ‘ä»¬å†æŠŠè¿™ä¸ªitemç»™yieldå‡ºå»å°±å¯ä»¥äº†ã€‚ç°åœ¨æˆ‘ä»¬å†è¿è¡Œä¸€ä¸‹ä»£ç ä¼šå¾—åˆ°å¦‚ä¸‹è¾“å‡ºã€‚</p><p><img src=\"https://static001.geekbang.org/resource/image/4f/d3/4f8d9f3b6c23e9c610fe20b6d54cf7d3.png?wh=2730x396\" alt=\"\"></p><p>åˆ°è¿™é‡Œï¼Œæˆ‘ä»¬çš„æ•°æ®çˆ¬å–å·¥ä½œçœ‹èµ·æ¥å°±å·²ç»å®Œæˆäº†ã€‚</p><p>ä½†æ˜¯ç­‰ä¸€ç­‰ï¼Œä½ æœ‰æ²¡æœ‰å‘ç°ä¸€ä¸ªé—®é¢˜ï¼Œç°åœ¨è™½ç„¶å·²ç»èƒ½å¤Ÿçˆ¬å–åˆ°æ•°æ®ï¼Œä½†æ˜¯åªèƒ½çˆ¬å–ä¸€é¡µçš„å†…å®¹ã€‚<strong>è¿™æ˜¯è¿œè¿œä¸å¤Ÿçš„ï¼Œæ¥ä¸‹æ¥æˆ‘ä»¬å°±ç”¨ç¨‹åºæ¥å®ç°ç¿»é¡µæŒ‰é’®çš„ç‚¹å‡»åŠŸèƒ½ã€‚</strong></p><p>å®é™…ä¸Šï¼Œæˆ‘ä»¬åªéœ€è¦åœ¨parseå‡½æ•°ä¸­åŠ å…¥å¦‚ä¸‹ä»£ç å³å¯ã€‚</p><pre><code>try:\n\tdriver.find_element_by_xpath(&quot;//div[@class='feed-card-page']/span[@class='pagebox_next']/a&quot;).click()\nexcept:\n\tBreak\n</code></pre><p>è¿™æ®µä»£ç ä¹Ÿä¸éš¾ç†è§£ï¼Œå°±æ˜¯æ‰¾åˆ°ç¿»é¡µå¯¼èˆªæ¡çš„HTMLæ ‡ç­¾ï¼Œç„¶åæ‰¾åˆ°å®ƒçš„<code>&lt;a&gt;</code>é“¾æ¥ï¼Œæ‰§è¡Œç‚¹å‡»ã€‚</p><p>æœ€åï¼Œæˆ‘ä»¬è¦åœ¨æœ€ä¸Šé¢åŠ ä¸Šä¸€ä¸ªç¿»é¡µæ“ä½œï¼Œå‡è®¾æˆ‘ä»¬åªéœ€è¦ç¿»5é¡µï¼Œæ­¤æ—¶parseå‡½æ•°çš„ä»£ç å¦‚ä¸‹ã€‚</p><pre><code>def parse(self, response):\n\tdriver = webdriver.Chrome(chrome_options=self.option)\n\tdriver.set_page_load_timeout(30)\n\tdriver.get(response.url)\n \n\tfor i in range(5):\n\t\twhile not driver.find_element_by_xpath(&quot;//div[@class='feed-card-page']&quot;).text:\n\t\t\tdriver.execute_script(&quot;window.scrollTo(0, document.body.scrollHeight);&quot;)\n\t\ttitle = driver.find_elements_by_xpath(&quot;//h2[@class='undefined']/a[@target='_blank']&quot;)\n\t\ttime = driver.find_elements_by_xpath(\n\t\t\t&quot;//h2[@class='undefined']/../div[@class='feed-card-a feed-card-clearfix']/div[@class='feed-card-time']&quot;)\n\t\tfor i in range(len(title)):\n\t\t\tprint(title[i].text)\n\t\t\tprint(time[i].text)\n \n\t\t\ttoday = datetime.datetime.now()\n\t\t\teachtime = time[i].text\n\t\t\teachtime = eachtime.replace('ä»Šå¤©', str(today.month) + 'æœˆ' + str(today.day) + 'æ—¥')\n \n\t\t\thref = title[i].get_attribute('href')\n \n\t\t\tif 'åˆ†é’Ÿå‰' in eachtime:\n\t\t\t\tminute = int(eachtime.split('åˆ†é’Ÿå‰')[0])\n\t\t\t\tt = datetime.datetime.now() - datetime.timedelta(minutes=minute)\n\t\t\t\tt2 = datetime.datetime(year=t.year, month=t.month, day=t.day, hour=t.hour, minute=t.minute)\n\t\t\telse:\n\t\t\t\tif 'å¹´' not in eachtime:\n\t\t\t\t\teachtime = str(today.year) + 'å¹´' + eachtime\n\t\t\t\tt1 = re.split('[å¹´æœˆæ—¥:]', eachtime)\n\t\t\t\tt2 = datetime.datetime(year=int(t1[0]), month=int(t1[1]), day=int(t1[2]), hour=int(t1[3]),\n\t\t\t\t\t\t\t\t\t   minute=int(t1[4]))\n \n\t\t\tprint(t2)\n \n\t\t\titem = SinaItem()\n\t\t\titem['type'] = 'news'\n\t\t\titem['title'] = title[i].text\n\t\t\titem['times'] = t2\n \n\t\t\tyield Request(url=response.urljoin(href), meta={'name': item}, callback=self.parse_namedetail)\n \n\t\ttry:\n\t\t\tdriver.find_element_by_xpath(&quot;//div[@class='feed-card-page']/span[@class='pagebox_next']/a&quot;).click()\n\t\texcept:\n\t\t\tBreak\n</code></pre><p>æˆ‘ä»¬å†è¿è¡Œç¨‹åºï¼Œè¿™æ—¶æˆ‘ä»¬å°±å¯ä»¥çˆ¬å–5é¡µçš„å†…å®¹äº†ï¼Œåœ¨æ­¤ä¹‹åï¼Œçˆ¬è™«ä¼šè‡ªåŠ¨åœæ­¢ã€‚</p><p><img src=\"https://static001.geekbang.org/resource/image/c4/d8/c4a396f83ba2b9a060a267cf116656d8.png?wh=3637x623\" alt=\"\"></p><p>è¿™æ ·ï¼Œæˆ‘ä»¬å·²ç»èƒ½å¤Ÿé’ˆå¯¹ä¸€ä¸ªæ ç›®æ¥çˆ¬å–æ•°æ®äº†ã€‚åœ¨åé¢çš„è¯¾ç¨‹ä¸­ï¼Œæˆ‘ä»¬ä¼šå»¶ç»­è¿™ä¸ªæ€è·¯ï¼Œç„¶åæŠŠæ•°æ®å­˜å‚¨èµ·æ¥å¹¶åšç›¸åº”çš„å¤„ç†ã€‚</p><h2>æ€»ç»“</h2><p>è¿™èŠ‚è¯¾åˆ°è¿™é‡Œä¹Ÿå°±æ¥è¿‘å°¾å£°äº†ï¼Œæˆ‘æ¥ç»™ä½ æ¢³ç†ä¸€ä¸‹è¿™èŠ‚è¯¾çš„ä¸»è¦å†…å®¹ã€‚</p><ol>\n<li>åœ¨Chromeæµè§ˆå™¨ä¸­ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨ Chrome å¼€å‘è€…å·¥å…·æ¥æŸ¥çœ‹é¡µé¢ä¸Šçš„å…ƒç´ ã€æ ‡è®°å’Œå±æ€§ï¼Œä»¥åŠæŸ¥çœ‹ç½‘ç»œè¯·æ±‚ã€å“åº”å’Œå…¶ä»–è¯Šæ–­ä¿¡æ¯ã€‚</li>\n<li>Scrapy æä¾›äº†è®¸å¤šå†…ç½®çš„è§£æå™¨ï¼ŒåŒ…æ‹¬ XPath å’Œ CSS é€‰æ‹©å™¨ç­‰ï¼Œè¿™äº›è§£æå™¨å¯ä»¥å¸®åŠ©æˆ‘ä»¬è½»æ¾åœ°ä» HTML é¡µé¢ä¸­æå–æ‰€éœ€æ•°æ®ã€‚</li>\n<li>åœ¨ Scrapy ä¸­ï¼Œcallback å‡½æ•°å¯ä»¥è¿”å›å¤šä¸ªè¯·æ±‚ï¼Œå¹¶åœ¨ç»“æœè¿”å›æ—¶ä½¿ç”¨ yield å…³é”®å­—ä¼ é€’ç»™ Scrapy å¼•æ“ã€‚</li>\n<li>item.py æ–‡ä»¶æ˜¯ Scrapy ä¸­ç”¨äºè§£æå’Œå­˜å‚¨æ•°æ®çš„ Python ç±»ã€‚åœ¨ item.py æ–‡ä»¶ä¸­ï¼Œä½ å¯ä»¥å®šä¹‰æ•°æ®æ¨¡å‹ï¼Œç¡®å®šè¦æå–çš„å­—æ®µï¼Œå¹¶å®šä¹‰æ•°æ®çš„ç±»å‹å’Œæ ¼å¼ã€‚</li>\n<li>åœ¨çˆ¬å–åŒ…å«å¤šä¸ªé¡µé¢çš„ç½‘ç«™æ—¶ï¼Œå¯ä»¥ä½¿ç”¨ next_page() æ–¹æ³•æ¥æ¨¡æ‹Ÿç”¨æˆ·æ“ä½œï¼Œè°ƒç”¨click(ï¼‰å‡½æ•°è¿›è¡Œç‚¹å‡»ã€‚</li>\n</ol><h2>è¯¾åé¢˜</h2><p>å­¦å®Œè¿™èŠ‚è¯¾ï¼Œè¯·ä½ è¯•ç€å®Œæˆä¸‹é¢ä¸¤é¡¹ä»»åŠ¡ã€‚</p><ol>\n<li>è·Ÿç€æˆ‘çš„è®²è§£ï¼Œè‡ªå·±å®ç°ä¸€éè¿™èŠ‚è¯¾æ‰€è®²çš„å†…å®¹ã€‚</li>\n<li>çˆ¬å–æ–°æµªç½‘ç«™ç”µå½±æ¿å—çš„å†…å®¹ã€‚</li>\n</ol><p>æ¬¢è¿ä½ åœ¨ç•™è¨€åŒºä¸æˆ‘äº¤æµè®¨è®ºï¼Œä½ ä¹Ÿå¯ä»¥æŠŠä»£ç é“¾æ¥é™„åœ¨è¯„è®ºåŒºï¼Œæˆ‘ä¼šé€‰å–æœ‰ä»£è¡¨æ€§çš„ä»£ç è¿›è¡Œç‚¹è¯„ï¼Œæˆ‘ä»¬ä¸‹èŠ‚è¯¾è§ï¼</p>","neighbors":{"left":{"article_title":"07ï½œæ•°æ®è·å–ï¼šä»€ä¹ˆæ˜¯Scrapyæ¡†æ¶ï¼Ÿ","id":651624},"right":{"article_title":"09ï½œæ•°æ®å­˜å‚¨ï¼šå¦‚ä½•å°†çˆ¬å–åˆ°çš„æ•°æ®å­˜å…¥æ•°æ®åº“ä¸­ï¼Ÿ","id":653611}},"comments":[{"had_liked":false,"id":373939,"user_name":"Geek_ccc0fd","can_delete":false,"product_type":"c1","uid":1461544,"ip_address":"å¹¿ä¸œ","ucode":"DB53D576AEC020","user_header":"https://thirdwx.qlogo.cn/mmopen/vi_32/EaBxhibOicZe9L7z2icbU4W462l543drFWYqibqczTicj4Msyb2g9pDSGmFTiafW9jibwib7jG6hpAdPMcCowdCiaxHaOdA/132","comment_is_top":false,"comment_ctime":1683365285,"is_pvip":false,"replies":[{"id":136924,"content":"æ„Ÿè°¢åˆ†äº«æ‚¨çš„ç»éªŒã€‚ç¡®å®ï¼ŒSelenium çš„ API æœ‰æ—¶å€™ä¼šè¿›è¡Œæ›´æ–°ï¼Œéœ€è¦æ ¹æ®æ–°ç‰ˆæœ¬æ¥è¿›è¡Œè°ƒæ•´ã€‚åœ¨å…·ä½“å®ç°ä¸­ï¼Œæˆ‘ä»¬éœ€è¦ç»“åˆé¡µé¢çš„ HTML ç»“æ„æ¥è¿›è¡Œ xpath è·¯å¾„çš„é€‰æ‹©ï¼Œä»¥ç¡®ä¿èƒ½å¤Ÿå®šä½åˆ°æ­£ç¡®çš„å…ƒç´ ã€‚å¯¹äºä¸€äº›å¯èƒ½å­˜åœ¨å¤šä¸ªå…ƒç´ çš„æƒ…å†µï¼Œä½¿ç”¨ç´¢å¼•å¯ä»¥ç¡®ä¿ç‚¹å‡»åˆ°æ­£ç¡®çš„å…ƒç´ ï¼Œé¿å…å½±å“ç¨‹åºçš„æ­£å¸¸æ‰§è¡Œã€‚","user_name":"ä½œè€…å›å¤","user_name_real":"ç¼–è¾‘","uid":1982950,"ctime":1685035325,"ip_address":"å¹¿ä¸œ","comment_id":373939,"utype":1}],"discussion_count":1,"race_medal":0,"score":2,"product_id":100542801,"comment_content":"æ–°å®‰è£…selemiumçš„APIå˜äº†ï¼Œè€Œä¸”xpathè·å–çš„è·¯å¾„æœ‰ç‚¹é—®é¢˜ï¼Œæˆ‘è¿™é‡Œè·å–ä¸åˆ°ä¸€é¡µçš„å…¨éƒ¨å†…å®¹ï¼Œæˆ‘ä¿®æ”¹äº†ä¸€ä¸‹ï¼š\ntitle = driver.find_elements(By.XPATH, &quot;&#47;&#47;div[@class=&#39;feed-card-item&#39;]&#47;h2&#47;a[@target=&#39;_blank&#39;]&quot;)\ntime = driver.find_elements(By.XPATH,&quot;&#47;&#47;div[@class=&#39;feed-card-item&#39;]&#47;h2&#47;..&#47;div[@class=&#39;feed-card-a feed-card-clearfix&#39;]&#47;div[@class=&#39;feed-card-time&#39;]&quot;)\nç„¶åå°±æ˜¯ç¿»é¡µç‚¹å‡»é‚£é‡Œæˆ‘è¿™è¾¹è·‘ä¸‹æ¥ä¹Ÿæœ‰é—®é¢˜ï¼Œæ ¹æ®xpathä¼šè·å–ä¸¤ä¸ªaæ ‡ç­¾,æ‰€ä»¥éœ€è¦å¢åŠ ç´¢å¼•ï¼š\ndriver.find_elements(By.XPATH,&quot;&#47;&#47;div[@class=&#39;feed-card-page&#39;]&#47;span[@class=&#39;pagebox_next&#39;]&#47;a&quot;)[0].click()","like_count":3,"discussions":[{"author":{"id":1982950,"avatar":"https://static001.geekbang.org/account/avatar/00/1e/41/e6/beb42103.jpg","nickname":"é»„é¸¿æ³¢","note":"","ucode":"5EB4E6946A363C","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":619391,"discussion_content":"æ„Ÿè°¢åˆ†äº«æ‚¨çš„ç»éªŒã€‚ç¡®å®ï¼ŒSelenium çš„ API æœ‰æ—¶å€™ä¼šè¿›è¡Œæ›´æ–°ï¼Œéœ€è¦æ ¹æ®æ–°ç‰ˆæœ¬æ¥è¿›è¡Œè°ƒæ•´ã€‚åœ¨å…·ä½“å®ç°ä¸­ï¼Œæˆ‘ä»¬éœ€è¦ç»“åˆé¡µé¢çš„ HTML ç»“æ„æ¥è¿›è¡Œ xpath è·¯å¾„çš„é€‰æ‹©ï¼Œä»¥ç¡®ä¿èƒ½å¤Ÿå®šä½åˆ°æ­£ç¡®çš„å…ƒç´ ã€‚å¯¹äºä¸€äº›å¯èƒ½å­˜åœ¨å¤šä¸ªå…ƒç´ çš„æƒ…å†µï¼Œä½¿ç”¨ç´¢å¼•å¯ä»¥ç¡®ä¿ç‚¹å‡»åˆ°æ­£ç¡®çš„å…ƒç´ ï¼Œé¿å…å½±å“ç¨‹åºçš„æ­£å¸¸æ‰§è¡Œã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1685035325,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"å¹¿ä¸œ","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":373757,"user_name":"æœªæ¥å·²æ¥","can_delete":false,"product_type":"c1","uid":1187130,"ip_address":"å¹¿ä¸œ","ucode":"3A21ACFD53CB9C","user_header":"https://static001.geekbang.org/account/avatar/00/12/1d/3a/cdf9c55f.jpg","comment_is_top":false,"comment_ctime":1683126600,"is_pvip":false,"replies":[{"id":136923,"content":"æ„Ÿè°¢æé†’ï¼Œåç»­æˆ‘ä¼šç»Ÿä¸€ä¿®æ”¹ä¸€ä¸‹ã€‚","user_name":"ä½œè€…å›å¤","user_name_real":"ç¼–è¾‘","uid":1982950,"ctime":1685035217,"ip_address":"å¹¿ä¸œ","comment_id":373757,"utype":1}],"discussion_count":2,"race_medal":0,"score":2,"product_id":100542801,"comment_content":"æˆªæ­¢åˆ° 5æœˆ3æ—¥ï¼Œæ–°å®‰è£…çš„ selemium åªæœ‰ find_elements æ–¹æ³•ï¼Œè€å¸ˆçš„ä»£ç éœ€æ”¹ä¸ºï¼š\n`title = driver.find_elements(By.XPATH, &quot;&#47;&#47;h2[@class=&#39;undefined&#39;]&#47;a[@target=&#39;_blank&#39;]&quot;)`\n`time = driver.find_elements(By.XPATH, &quot;&#47;&#47;h2[@class=&#39;undefined&#39;]&#47;..&#47;div[@class=&#39;feed-card-a feed-card-clearfix&#39;]&#47;div[@class=&#39;feed-card-time&#39;]&quot;)`\nä»¥æ­¤ç±»æ¨","like_count":1,"discussions":[{"author":{"id":1982950,"avatar":"https://static001.geekbang.org/account/avatar/00/1e/41/e6/beb42103.jpg","nickname":"é»„é¸¿æ³¢","note":"","ucode":"5EB4E6946A363C","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":619390,"discussion_content":"æ„Ÿè°¢æé†’ï¼Œåç»­æˆ‘ä¼šç»Ÿä¸€ä¿®æ”¹ä¸€ä¸‹ã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1685035217,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"å¹¿ä¸œ","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":1,"child_discussions":[{"author":{"id":1258480,"avatar":"https://static001.geekbang.org/account/avatar/00/13/33/f0/50c773cd.jpg","nickname":"å…¨å›½èŠ±å¼ä¼¸è„–å­è¹¬è…¿é”¦æ ‡èµ›å† å†›ğŸ†","note":"","ucode":"77181EEE13E761","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":1982950,"avatar":"https://static001.geekbang.org/account/avatar/00/1e/41/e6/beb42103.jpg","nickname":"é»„é¸¿æ³¢","note":"","ucode":"5EB4E6946A363C","race_medal":0,"user_type":2,"is_pvip":false},"discussion":{"id":635115,"discussion_content":"2024å¹´äº†ï¼Œè€å¸ˆè¿˜æ²¡ä¿®æ”¹å—","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1704424605,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":619390,"ip_address":"é‡åº†","group_id":0},"score":635115,"extra":""}]}]},{"had_liked":false,"id":382852,"user_name":"Abigail","can_delete":false,"product_type":"c1","uid":2604437,"ip_address":"æ¾³å¤§åˆ©äºš","ucode":"ABB59CE5209E67","user_header":"https://static001.geekbang.org/account/avatar/00/27/bd/95/882bd4e0.jpg","comment_is_top":false,"comment_ctime":1698122538,"is_pvip":false,"replies":[{"id":140000,"content":"å®é™…ä¸Šï¼Œè¿™ä¸ªç‰ˆæœ¬ç›¸å¯¹æ¥è®²æ˜¯é€šç”¨çš„ï¼Œå¯ä»¥ç”¨3.9ç‰ˆæœ¬æ¥å¼€å‘","user_name":"ä½œè€…å›å¤","user_name_real":"ç¼–è¾‘","uid":1982950,"ctime":1699860010,"ip_address":"å¹¿ä¸œ","comment_id":382852,"utype":1}],"discussion_count":1,"race_medal":0,"score":2,"product_id":100542801,"comment_content":"åº”è¯¥è®¾è®¡ä¸€ä¸ªç®€å•ç‚¹çš„ä¾‹å­, python èµ·ç ä¹Ÿè¦ç”¨ 3.9 å•Š","like_count":0,"discussions":[{"author":{"id":1982950,"avatar":"https://static001.geekbang.org/account/avatar/00/1e/41/e6/beb42103.jpg","nickname":"é»„é¸¿æ³¢","note":"","ucode":"5EB4E6946A363C","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":631634,"discussion_content":"å®é™…ä¸Šï¼Œè¿™ä¸ªç‰ˆæœ¬ç›¸å¯¹æ¥è®²æ˜¯é€šç”¨çš„ï¼Œå¯ä»¥ç”¨3.9ç‰ˆæœ¬æ¥å¼€å‘","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1699860010,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"å¹¿ä¸œ","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":375536,"user_name":"alexliu","can_delete":false,"product_type":"c1","uid":1112019,"ip_address":"ä¸Šæµ·","ucode":"DD65983BBC9CD4","user_header":"https://static001.geekbang.org/account/avatar/00/10/f7/d3/2bbc62b2.jpg","comment_is_top":false,"comment_ctime":1685604963,"is_pvip":false,"replies":[{"id":140034,"content":"è¿™ä¸ªå¾ˆæœ‰å¯èƒ½æ˜¯ä½ çš„æœåŠ¡æ¥å£éƒ¨ç½²çš„é—®é¢˜ã€‚","user_name":"ä½œè€…å›å¤","user_name_real":"ç¼–è¾‘","uid":1982950,"ctime":1699860905,"ip_address":"å¹¿ä¸œ","comment_id":375536,"utype":1}],"discussion_count":1,"race_medal":0,"score":2,"product_id":100542801,"comment_content":"åœ¨è¿è¡Œä¸‹ä¸€é¡µclick()çš„æ—¶å€™ï¼Œæœ‰å¯èƒ½å‡ºç°ElementNotInteractableExceptioné”™è¯¯ï¼Œè§£å†³æ–¹æ¡ˆï¼š\n1ã€åœ¨driver.get(response.url)å’Œclick()åæ·»åŠ å»¶æ—¶time.sleep(2)\n2ã€ä¿æŒchromeçš„çª—å£å¤§å°ä¸€è‡´ self.option.add_argument(&quot;--window-size=1960,1080&quot;)\ntry... except...éƒ¨åˆ†ä»£ç å¦‚ä¸‹ï¼š\n            try:\n                _next = driver.find_elements(By.XPATH, &quot;&#47;&#47;div[@class=&#39;feed-card-page&#39;]&#47;span[@class=&#39;pagebox_next&#39;]&#47;a&quot;)\n                _next[0].click()\n                _time.sleep(2)\n            except StaleElementReferenceException as e:\n                print(&quot; page failed.&quot;, e)\n                _next = driver.find_elements(By.XPATH, &quot;&#47;&#47;div[@class=&#39;feed-card-page&#39;]&#47;span[@class=&#39;pagebox_next&#39;]&#47;a&quot;)\n                _next[0].click()\n                _time.sleep(2)\n            except ElementNotInteractableException as e:\n                print(&quot; not found page.&quot;, e)\n                break\n            except Exception as e:\n                print(&quot;unkwon error: &quot;, e)","like_count":0,"discussions":[{"author":{"id":1982950,"avatar":"https://static001.geekbang.org/account/avatar/00/1e/41/e6/beb42103.jpg","nickname":"é»„é¸¿æ³¢","note":"","ucode":"5EB4E6946A363C","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":631669,"discussion_content":"è¿™ä¸ªå¾ˆæœ‰å¯èƒ½æ˜¯ä½ çš„æœåŠ¡æ¥å£éƒ¨ç½²çš„é—®é¢˜ã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1699860906,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"å¹¿ä¸œ","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":373934,"user_name":"Geek_ccc0fd","can_delete":false,"product_type":"c1","uid":1461544,"ip_address":"å¹¿ä¸œ","ucode":"DB53D576AEC020","user_header":"https://thirdwx.qlogo.cn/mmopen/vi_32/EaBxhibOicZe9L7z2icbU4W462l543drFWYqibqczTicj4Msyb2g9pDSGmFTiafW9jibwib7jG6hpAdPMcCowdCiaxHaOdA/132","comment_is_top":false,"comment_ctime":1683361742,"is_pvip":false,"replies":[{"id":136920,"content":"è™½ç„¶åœ¨ Scrapy ä¸­å¯ä»¥é€šè¿‡ `response.xpath` ç›´æ¥è·å–ç½‘é¡µå…ƒç´ ï¼Œä½†æ˜¯æœ‰æ—¶å€™ç½‘é¡µå†…å®¹æ˜¯é€šè¿‡ JavaScript åŠ¨æ€åŠ è½½çš„ï¼Œæ­¤æ—¶ Scrapy å¯èƒ½æ— æ³•è·å–è¿™äº›éœ€è¦ JavaScript æ‰§è¡Œåæ‰èƒ½å¾—åˆ°çš„å†…å®¹ã€‚\nè€Œä½¿ç”¨ Selenium å°±å¯ä»¥å®Œå…¨æ¨¡æ‹Ÿæµè§ˆå™¨è¡Œä¸ºï¼ŒåŒ…æ‹¬ JavaScript çš„æ‰§è¡Œï¼Œå¯ä»¥è·å–åˆ°å®Œæ•´çš„ç½‘é¡µå†…å®¹ã€‚æ­¤å¤–ï¼ŒæŸäº›ç½‘ç«™ä¼šé€šè¿‡ä¸€äº›åçˆ¬è™«æŠ€æœ¯æ¥æ£€æµ‹è®¿é—®è€…æ˜¯å¦æ˜¯çœŸæ­£çš„æµè§ˆå™¨ï¼Œå¦‚æœæ£€æµ‹åˆ°æ˜¯çˆ¬è™«ï¼Œåˆ™ä¼šæ‹’ç»è®¿é—®ã€‚ä½¿ç”¨ Selenium å¯ä»¥å®Œç¾åœ°è§£å†³è¿™ä¸ªé—®é¢˜ã€‚","user_name":"ä½œè€…å›å¤","user_name_real":"ç¼–è¾‘","uid":1982950,"ctime":1685035038,"ip_address":"å¹¿ä¸œ","comment_id":373934,"utype":1}],"discussion_count":1,"race_medal":0,"score":2,"product_id":100542801,"comment_content":"æˆ‘ä»¬åœ¨parseé‡Œé¢å¯ä»¥ç›´æ¥ä½¿ç”¨response.xpathè·å–å…ƒç´ ï¼Œå’Œä½¿ç”¨ driver.find_elementsæ˜¯åŒæ ·çš„æ•ˆæœï¼Œä¸ºä»€ä¹ˆè¿˜è¦ç”¨seleniumæ¥åšæµè§ˆå™¨çš„æ“ä½œå‘¢ï¼Ÿ","like_count":0,"discussions":[{"author":{"id":1982950,"avatar":"https://static001.geekbang.org/account/avatar/00/1e/41/e6/beb42103.jpg","nickname":"é»„é¸¿æ³¢","note":"","ucode":"5EB4E6946A363C","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":619387,"discussion_content":"è™½ç„¶åœ¨ Scrapy ä¸­å¯ä»¥é€šè¿‡ `response.xpath` ç›´æ¥è·å–ç½‘é¡µå…ƒç´ ï¼Œä½†æ˜¯æœ‰æ—¶å€™ç½‘é¡µå†…å®¹æ˜¯é€šè¿‡ JavaScript åŠ¨æ€åŠ è½½çš„ï¼Œæ­¤æ—¶ Scrapy å¯èƒ½æ— æ³•è·å–è¿™äº›éœ€è¦ JavaScript æ‰§è¡Œåæ‰èƒ½å¾—åˆ°çš„å†…å®¹ã€‚\nè€Œä½¿ç”¨ Selenium å°±å¯ä»¥å®Œå…¨æ¨¡æ‹Ÿæµè§ˆå™¨è¡Œä¸ºï¼ŒåŒ…æ‹¬ JavaScript çš„æ‰§è¡Œï¼Œå¯ä»¥è·å–åˆ°å®Œæ•´çš„ç½‘é¡µå†…å®¹ã€‚æ­¤å¤–ï¼ŒæŸäº›ç½‘ç«™ä¼šé€šè¿‡ä¸€äº›åçˆ¬è™«æŠ€æœ¯æ¥æ£€æµ‹è®¿é—®è€…æ˜¯å¦æ˜¯çœŸæ­£çš„æµè§ˆå™¨ï¼Œå¦‚æœæ£€æµ‹åˆ°æ˜¯çˆ¬è™«ï¼Œåˆ™ä¼šæ‹’ç»è®¿é—®ã€‚ä½¿ç”¨ Selenium å¯ä»¥å®Œç¾åœ°è§£å†³è¿™ä¸ªé—®é¢˜ã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1685035038,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"å¹¿ä¸œ","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":373692,"user_name":"å®‰è²å°”å¾·","can_delete":false,"product_type":"c1","uid":1660533,"ip_address":"å¤©æ´¥","ucode":"A7B310463C15F1","user_header":"https://static001.geekbang.org/account/avatar/00/19/56/75/28a29e7c.jpg","comment_is_top":false,"comment_ctime":1683021683,"is_pvip":false,"replies":[{"id":136677,"content":"åŒå­¦ï¼Œä½ å¥½ã€‚\nmain.pyæ–‡ä»¶æ˜¯éœ€è¦è‡ªå·±åˆ›å»ºçš„ã€‚","user_name":"ä½œè€…å›å¤","user_name_real":"ç¼–è¾‘","uid":1982950,"ctime":1683878462,"ip_address":"å¹¿ä¸œ","comment_id":373692,"utype":1}],"discussion_count":1,"race_medal":0,"score":2,"product_id":100542801,"comment_content":"è¯·é—®å“ªæœ‰main.pyæ–‡ä»¶å‘¢ï¼Œæ²¡æœ‰çœ‹åˆ°","like_count":0,"discussions":[{"author":{"id":1982950,"avatar":"https://static001.geekbang.org/account/avatar/00/1e/41/e6/beb42103.jpg","nickname":"é»„é¸¿æ³¢","note":"","ucode":"5EB4E6946A363C","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":617796,"discussion_content":"åŒå­¦ï¼Œä½ å¥½ã€‚\nmain.pyæ–‡ä»¶æ˜¯éœ€è¦è‡ªå·±åˆ›å»ºçš„ã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1683878462,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"å¹¿ä¸œ","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":373448,"user_name":"peter","can_delete":false,"product_type":"c1","uid":1058183,"ip_address":"åŒ—äº¬","ucode":"261C3FC001DE2D","user_header":"https://static001.geekbang.org/account/avatar/00/10/25/87/f3a69d1b.jpg","comment_is_top":false,"comment_ctime":1682514360,"is_pvip":false,"replies":[{"id":136406,"content":"åŒå­¦ä½ å¥½ï¼ŒèŠ‚åæˆ‘ä¼šæŠŠæºç æ”¾åœ¨githubä¸Šï¼Œç„¶åç»™ä½ ä»¬é“¾æ¥ã€‚","user_name":"ä½œè€…å›å¤","user_name_real":"ç¼–è¾‘","uid":1982950,"ctime":1682607054,"ip_address":"å¹¿ä¸œ","comment_id":373448,"utype":1}],"discussion_count":2,"race_medal":0,"score":2,"product_id":100542801,"comment_content":"Q3ï¼šæºç æ”¾åœ¨ä»€ä¹ˆåœ°æ–¹å•Šï¼Ÿèƒ½å¦æŠŠæºç é›†ä¸­æ”¾åˆ°ä¸€ä¸ªå…¬å…±åœ°æ–¹? æ¯”å¦‚githubç­‰ã€‚","like_count":0,"discussions":[{"author":{"id":1982950,"avatar":"https://static001.geekbang.org/account/avatar/00/1e/41/e6/beb42103.jpg","nickname":"é»„é¸¿æ³¢","note":"","ucode":"5EB4E6946A363C","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":616157,"discussion_content":"åŒå­¦ä½ å¥½ï¼ŒèŠ‚åæˆ‘ä¼šæŠŠæºç æ”¾åœ¨githubä¸Šï¼Œç„¶åç»™ä½ ä»¬é“¾æ¥ã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1682607054,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"å¹¿ä¸œ","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":1,"child_discussions":[{"author":{"id":1784001,"avatar":"","nickname":"imageine","note":"","ucode":"05A7EA8F28818C","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":1982950,"avatar":"https://static001.geekbang.org/account/avatar/00/1e/41/e6/beb42103.jpg","nickname":"é»„é¸¿æ³¢","note":"","ucode":"5EB4E6946A363C","race_medal":0,"user_type":2,"is_pvip":false},"discussion":{"id":643090,"discussion_content":"1å¹´è¿‡å»äº†ï¼Œè¯·é—®githubé“¾æ¥æœ‰äº†ä¹ˆï¼Ÿ\n","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1714036744,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":616157,"ip_address":"å±±ä¸œ","group_id":0},"score":643090,"extra":""}]}]},{"had_liked":false,"id":373447,"user_name":"peter","can_delete":false,"product_type":"c1","uid":1058183,"ip_address":"åŒ—äº¬","ucode":"261C3FC001DE2D","user_header":"https://static001.geekbang.org/account/avatar/00/10/25/87/f3a69d1b.jpg","comment_is_top":false,"comment_ctime":1682514294,"is_pvip":false,"replies":[{"id":136418,"content":"å…³äºç¬¬ä¸€ä¸ªé—®é¢˜ï¼Œçœ‹çœ‹èƒ½ä¸èƒ½é€šè¿‡æˆªå›¾æˆ–è€…å…¶ä»–æ–¹å¼å‘Šè¯‰æˆ‘ï¼Œå…³äºå¾®ä¿¡ç¾¤ï¼Œæˆ‘å¯ä»¥å’Œå®˜æ–¹å•†é‡ä¸€ä¸‹ï¼Œçœ‹çœ‹æ€ä¹ˆæã€‚","user_name":"ä½œè€…å›å¤","user_name_real":"ç¼–è¾‘","uid":1982950,"ctime":1682612825,"ip_address":"å¹¿ä¸œ","comment_id":373447,"utype":1}],"discussion_count":3,"race_medal":0,"score":2,"product_id":100542801,"comment_content":"Q1ï¼šç¬¬ä¸ƒè¯¾ï¼Œåˆ›å»ºç¯å¢ƒçš„æœ€åå‡ æ­¥ï¼Œä¸åœå‡ºé”™ï¼Œæœ€åä¸€ä¸ªé”™è¯¯æ˜¯ï¼šæ‰§è¡Œâ€œscrapy genspider sina_spider sina.com.cnâ€ï¼ŒæŠ¥å‘Šï¼šlib\\string.py&quot;, line 132, in substitute\n    return self.pattern.sub(convert, self.template)\nTypeError: cannot use a string pattern on a bytes-like object\nç½‘ä¸Šæœäº†ï¼Œå¤§æ„è¯´æ˜¯python2å’Œpython3ä¸åŒ¹é…å¯¼è‡´çš„ã€‚ æˆ‘æ˜¯å®Œå…¨æŒ‰ç…§è€å¸ˆçš„æ­¥éª¤æ¥å®‰è£…çš„ï¼Œå®‰è£…çš„æ˜¯pythno3ï¼Œæ€ä¹ˆä¼šæœ‰python2å‘¢ï¼Ÿå½“ç„¶ï¼Œè¿™ä¸ªæ–‡ä»¶è¿˜æ²¡æœ‰è§£å†³ï¼Œè¿›è¡Œä¸ä¸‹å»äº†ï¼Œéƒé—·å•Šã€‚ \nQ2ï¼šèƒ½å¦å»ºä¸€ä¸ªå¾®ä¿¡ç¾¤ï¼Ÿé‡åˆ°é—®é¢˜å¯ä»¥åå•†ã€‚ å¦å¤–ï¼Œè€å¸ˆèƒ½å¦æ›´åŠæ—¶åœ°å›å¤ç•™è¨€ï¼Ÿ","like_count":0,"discussions":[{"author":{"id":1982950,"avatar":"https://static001.geekbang.org/account/avatar/00/1e/41/e6/beb42103.jpg","nickname":"é»„é¸¿æ³¢","note":"","ucode":"5EB4E6946A363C","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":616196,"discussion_content":"å…³äºç¬¬ä¸€ä¸ªé—®é¢˜ï¼Œçœ‹çœ‹èƒ½ä¸èƒ½é€šè¿‡æˆªå›¾æˆ–è€…å…¶ä»–æ–¹å¼å‘Šè¯‰æˆ‘ï¼Œå…³äºå¾®ä¿¡ç¾¤ï¼Œæˆ‘å¯ä»¥å’Œå®˜æ–¹å•†é‡ä¸€ä¸‹ï¼Œçœ‹çœ‹æ€ä¹ˆæã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1682612825,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"å¹¿ä¸œ","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":2189310,"avatar":"https://static001.geekbang.org/account/avatar/00/21/67/fe/5d17661a.jpg","nickname":"æ‚Ÿå°˜","note":"","ucode":"4E7E854340D3A4","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":633541,"discussion_content":"å¾®ä¿¡ç¾¤æœ‰äº†å—ï¼Ÿ","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1702290039,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":"åŒ—äº¬","group_id":0},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1385403,"avatar":"https://static001.geekbang.org/account/avatar/00/15/23/bb/a1a61f7c.jpg","nickname":"GACÂ·DU","note":"","ucode":"7847FBE1C13740","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":616029,"discussion_content":"é¡¹ç›®è¿è¡Œç¯å¢ƒåˆ›å»ºäº†å—ï¼Ÿ","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1682559530,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":"åŒ—äº¬","group_id":0},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":373433,"user_name":"GACÂ·DU","can_delete":false,"product_type":"c1","uid":1385403,"ip_address":"åŒ—äº¬","ucode":"7847FBE1C13740","user_header":"https://static001.geekbang.org/account/avatar/00/15/23/bb/a1a61f7c.jpg","comment_is_top":false,"comment_ctime":1682506430,"is_pvip":false,"replies":[{"id":136417,"content":"åŒå­¦ä½ å¥½ï¼Œæˆ‘æ¥å›ç­”ä½ çš„ä¸¤ä¸ªé—®é¢˜ï¼š\nA1ï¼šå› ä¸ºåœ¨parse_namedetailä¸­å·²ç»è·å–åˆ°äº†httpå“åº”çš„å†…å®¹ï¼Œæ‰€ä»¥å¯ä»¥ç›´æ¥ç”¨ï¼Œè€Œä¸æ˜¯å†æ¬¡è¯·æ±‚ç½‘ç»œï¼Œè¯·æ±‚ç½‘ç»œä¼šæœ‰æ›´å¤šçš„è€—æ—¶ï¼›\nA2ï¼šresponseå¯¹è±¡åŒ…å«æ¥è‡ªWebæœåŠ¡å™¨çš„HTMLå“åº”ï¼Œå¹¶å¯ç”¨äºæå–å“åº”æ•°æ®ï¼Œè€Œselectorå¯¹è±¡æ˜¯ä½¿ç”¨responseå¯¹è±¡åˆ›å»ºçš„ï¼Œå®ƒæä¾›äº†ä¸€ç§æ–¹ä¾¿çš„æ–¹æ³•æ¥ä»å“åº”ä¸­é€‰æ‹©å’Œæå–æ•°æ®ã€‚å› æ­¤ï¼Œä½¿ç”¨selectorè€Œä¸æ˜¯responseå¯ä»¥æ›´æ–¹ä¾¿åœ°ä»HTMLå“åº”ä¸­æå–å’Œå¤„ç†æ•°æ®ã€‚","user_name":"ä½œè€…å›å¤","user_name_real":"ç¼–è¾‘","uid":1982950,"ctime":1682612425,"ip_address":"å¹¿ä¸œ","comment_id":373433,"utype":1}],"discussion_count":1,"race_medal":0,"score":2,"product_id":100542801,"comment_content":"è€å¸ˆï¼Œå…³äºä»£ç æœ‰äº›ç–‘æƒ‘ï¼Œç¬¬ä¸€ï¼šä¸ºä»€ä¹ˆparse_namedetailæ–¹æ³•ä¸å†ä½¿ç”¨driverå‘èµ·httpè¯·æ±‚å’Œè·å–htmlæ ‡ç­¾å†…å®¹ï¼Ÿ\nç¬¬äºŒï¼šdesc = response.xpath(&quot;&#47;&#47;div[@class=&#39;article&#39;]&#47;p&#47;text()&quot;).extract()\n        desc = selector.xpath(&quot;&#47;&#47;div[@class=&#39;article&#39;]&#47;p&#47;text()&quot;).extract() \næˆ‘æµ‹è¯•äº†ä¸¤ä¸ªä»£ç éƒ½å¯ä»¥ä½¿ç”¨ï¼Œé‚£ä¸ºä»€ä¹ˆä¸ç›´æ¥ä½¿ç”¨responseï¼Œåè€Œè¦ç”Ÿæˆä¸€ä¸ªselectorï¼Ÿ","like_count":0,"discussions":[{"author":{"id":1982950,"avatar":"https://static001.geekbang.org/account/avatar/00/1e/41/e6/beb42103.jpg","nickname":"é»„é¸¿æ³¢","note":"","ucode":"5EB4E6946A363C","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":616195,"discussion_content":"åŒå­¦ä½ å¥½ï¼Œæˆ‘æ¥å›ç­”ä½ çš„ä¸¤ä¸ªé—®é¢˜ï¼š\nA1ï¼šå› ä¸ºåœ¨parse_namedetailä¸­å·²ç»è·å–åˆ°äº†httpå“åº”çš„å†…å®¹ï¼Œæ‰€ä»¥å¯ä»¥ç›´æ¥ç”¨ï¼Œè€Œä¸æ˜¯å†æ¬¡è¯·æ±‚ç½‘ç»œï¼Œè¯·æ±‚ç½‘ç»œä¼šæœ‰æ›´å¤šçš„è€—æ—¶ï¼›\nA2ï¼šresponseå¯¹è±¡åŒ…å«æ¥è‡ªWebæœåŠ¡å™¨çš„HTMLå“åº”ï¼Œå¹¶å¯ç”¨äºæå–å“åº”æ•°æ®ï¼Œè€Œselectorå¯¹è±¡æ˜¯ä½¿ç”¨responseå¯¹è±¡åˆ›å»ºçš„ï¼Œå®ƒæä¾›äº†ä¸€ç§æ–¹ä¾¿çš„æ–¹æ³•æ¥ä»å“åº”ä¸­é€‰æ‹©å’Œæå–æ•°æ®ã€‚å› æ­¤ï¼Œä½¿ç”¨selectorè€Œä¸æ˜¯responseå¯ä»¥æ›´æ–¹ä¾¿åœ°ä»HTMLå“åº”ä¸­æå–å’Œå¤„ç†æ•°æ®ã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1682612425,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"å¹¿ä¸œ","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":376388,"user_name":"WeitzenbÃ¶ck","can_delete":false,"product_type":"c1","uid":2669122,"ip_address":"æ±Ÿè‹","ucode":"78C92583084ABA","user_header":"https://static001.geekbang.org/account/avatar/00/28/ba/42/5ca553bd.jpg","comment_is_top":false,"comment_ctime":1686762157,"is_pvip":false,"replies":null,"discussion_count":1,"race_medal":0,"score":2,"product_id":100542801,"comment_content":"å¦‚æœå‡ºç°è¿™ä¸ªé”™è¯¯ï¼š__init__() got an unexpected keyword argument &#39;chrome_options&#39; ä»£ç é‡Œæ”¹ä¸º driver = webdriver.Chrome(options=self.option)å…·ä½“æºç æ˜¯ï¼š\nclass WebDriver(ChromiumDriver):\n    &quot;&quot;&quot;Controls the ChromeDriver and allows you to drive the browser.&quot;&quot;&quot;\n\n    def __init__(\n        self,\n        options: Options = None,\n        service: Service = None,\n        keep_alive: bool = True,\n    ) -&gt; None:\n        &quot;&quot;&quot;Creates a new instance of the chrome driver. Starts the service and\n        then creates new instance of chrome driver.\n\n        :Args:\n         - options - this takes an instance of ChromeOptions\n         - service - Service object for handling the browser driver if you need to pass extra details\n         - keep_alive - Whether to configure ChromeRemoteConnection to use HTTP keep-alive.\n        &quot;&quot;&quot;\n        self.service = service if service else Service()\n        self.options = options if options else Options()\n        self.keep_alive = keep_alive\n\n        self.service.path = DriverFinder.get_path(self.service, self.options)\n\n        super().__init__(\n            DesiredCapabilities.CHROME[&quot;browserName&quot;],\n            &quot;goog&quot;,\n            self.options,\n            self.service,\n            self.keep_alive,\n        )","like_count":1,"discussions":[{"author":{"id":1542987,"avatar":"https://static001.geekbang.org/account/avatar/00/17/8b/4b/15ab499a.jpg","nickname":"é£è½»æ‰¬","note":"","ucode":"DB972F2DF059C4","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":650031,"discussion_content":"è€å“¥ï¼Œæˆ‘é‡åˆ°ä½ è¿™ä¸ªé—®é¢˜äº†ã€‚ä½ çš„å®Œæ•´ä»£ç èƒ½ç»™è´´ä¸‹å—ï¼Œæ”¹äº†ä¹‹åæŠ¥é”™ï¼šTypeError: ArgOptions.add_argument() missing 1 required positional argument: &#39;argument&#39;","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1724282231,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":"åŒ—äº¬","group_id":0},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":393608,"user_name":"é£è½»æ‰¬","can_delete":false,"product_type":"c1","uid":1542987,"ip_address":"åŒ—äº¬","ucode":"DB972F2DF059C4","user_header":"https://static001.geekbang.org/account/avatar/00/17/8b/4b/15ab499a.jpg","comment_is_top":false,"comment_ctime":1724313128,"is_pvip":false,"replies":null,"discussion_count":0,"race_medal":0,"score":3,"product_id":100542801,"comment_content":"macç³»ç»Ÿï¼Œçˆ¬å–è¿‡ç¨‹ä¸­ï¼Œå¯èƒ½ä¼šæŠ¥é”™ï¼šæ— æ³•æ‰“å¼€chromedriverï¼Œå› ä¸ºæ— æ³•éªŒè¯å¼€å‘è€…ã€‚\nå¦‚æœæ˜¯brewå®‰è£…çš„chromedriverï¼Œå¯ä»¥æ‰§è¡Œï¼šxattr -d com.apple.quarantine &#47;opt&#47;homebrew&#47;bin&#47;chromedriverè¿›è¡Œå¯ä¿¡æˆæƒã€‚\nå¦‚æœä¸æ˜¯brewå®‰è£…çš„ï¼Œéœ€è¦è‡ªå·±æ‰¾åˆ°chromedriverçš„å®‰è£…è·¯å¾„ï¼Œç„¶åæ‰§è¡Œxattr -d com.apple.quarantine ä½ çš„chromedriverçš„è·¯å¾„","like_count":0},{"had_liked":false,"id":385267,"user_name":"æ‚Ÿå°˜","can_delete":false,"product_type":"c1","uid":2189310,"ip_address":"åŒ—äº¬","ucode":"4E7E854340D3A4","user_header":"https://static001.geekbang.org/account/avatar/00/21/67/fe/5d17661a.jpg","comment_is_top":false,"comment_ctime":1702368613,"is_pvip":false,"replies":null,"discussion_count":1,"race_medal":0,"score":3,"product_id":100542801,"comment_content":" # å°è¯•ç‚¹å‡»ä¸‹ä¸€é¡µ\n            try:\n                # next_page_link = WebDriverWait(driver, 30).until(\n                #     EC.element_to_be_clickable(\n                #         (By.XPATH, &quot;&#47;&#47;div[@class=&#39;feed-card-page&#39;]&#47;span[@class=&#39;pagebox_next&#39;]&#47;a&quot;))\n                # )\n                # next_page_link.click()\n                driver.find_elements(By.XPATH, &quot;&#47;&#47;div[@class=&#39;feed-card-page&#39;]&#47;span[@class=&#39;pagebox_next&#39;]&#47;a&quot;)[0].click()\n            except Exception as e:\n                print(f&quot;Error clicking next page link: {e}&quot;)\n                break\n\næ‰“å‡ºçš„å¼‚å¸¸æ˜¯ï¼šError clicking next page link: Message: stale element reference: stale element not found\n\nè¿™æ˜¯å› ä¸ºä»€ä¹ˆï¼Ÿ","like_count":0,"discussions":[{"author":{"id":2189310,"avatar":"https://static001.geekbang.org/account/avatar/00/21/67/fe/5d17661a.jpg","nickname":"æ‚Ÿå°˜","note":"","ucode":"4E7E854340D3A4","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":633608,"discussion_content":"æˆ‘åŠ äº†ä¸€ä¸ªsleepï¼Œå…·ä½“ä»£ç å¦‚ä¸‹ï¼šä¸çŸ¥é“åŸå› æ˜¯å¦åƒæˆ‘å†™çš„è¿™æ ·ï¼Ÿ\n  # æ‰§è¡Œæ»šåŠ¨è„šæœ¬\n            driver.execute_script(&#34;window.scrollTo(0, document.body.scrollHeight);&#34;)\n            # æš‚åœç¨‹åºæ‰§è¡Œ 1 ç§’é’Ÿï¼Œéœ€è¦è®©é¡µé¢åŠ è½½å®Œæˆï¼ŒåŸå› å¯èƒ½æ˜¯ï¼šåœ¨é¡µé¢åŠ è½½æœŸé—´ï¼ŒæŸäº›å…ƒç´ å¯èƒ½ä¼šå˜å¾—ä¸å¯äº¤äº’ã€‚ç¡®ä¿ç­‰å¾…è¶³å¤Ÿçš„æ—¶é—´ä»¥ç¡®ä¿é¡µé¢åŠ è½½å®Œæˆã€‚\n            time.sleep(1)","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1702373684,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":"åŒ—äº¬","group_id":0},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":385257,"user_name":"æ‚Ÿå°˜","can_delete":false,"product_type":"c1","uid":2189310,"ip_address":"åŒ—äº¬","ucode":"4E7E854340D3A4","user_header":"https://static001.geekbang.org/account/avatar/00/21/67/fe/5d17661a.jpg","comment_is_top":false,"comment_ctime":1702361899,"is_pvip":false,"replies":null,"discussion_count":0,"race_medal":0,"score":3,"product_id":100542801,"comment_content":"ä¸ºä»€ä¹ˆæˆ‘çš„ç¿»é¡µä¸èµ·ä½œç”¨å‘¢ï¼Ÿ\n","like_count":0}]}