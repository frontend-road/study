{"id":107773,"title":"84 | 集成QQ SDK实现登录和分享功能","content":"<p><strong>PDF 课件和源代码下载地址：</strong></p><p><a href=\"https://gitee.com/geektime-geekbang/geektime-ios-course\">https://gitee.com/geektime-geekbang/geektime-ios-course</a></p>","comments":[{"had_liked":false,"id":172039,"user_name":"Masami","can_delete":false,"product_type":"c3","uid":1505981,"ip_address":"","ucode":"73E03F53335DBC","user_header":"https://static001.geekbang.org/account/avatar/00/16/fa/bd/7bf33188.jpg","comment_is_top":false,"comment_ctime":1579077141,"is_pvip":false,"replies":[{"id":67095,"content":"看一下课程中7分05秒左右，理论上对应的Scheme需要在LSApplicationQueriesSchemes中进行添加。那么对于我们的Demo，由于是在模拟器中使用的无法安装QQ，所以SDK会自动的拉起网页，这部分的能力不会有影响。具体LSApplicationQueriesSchemes的作用和意义在后续的课程中也会有讲解，主要就是支持在我们的App中判断对应Scheme的App是否安装的这个能力。总的来说，第一个日志可以通过添加LSApplicationQueriesSchemes优化掉，下面的日志需要在真机上安装QQ。","user_name":"作者回复","user_name_real":"zzz","uid":1041455,"ctime":1579406396,"ip_address":"","comment_id":172039,"utype":1}],"discussion_count":2,"race_medal":0,"score":2,"product_id":100025901,"comment_content":"老师你好，我在xcode11，13.2版本下做这一节的QQ framework（3.3.3版本）点击minecontroller的图片按钮没法跳转！控制台显示以下内容。请问如何解决？？？\n\n2020-01-15 16:29:19.093048+0800 SampleApp[57130:1926879] -canOpenURL: failed for URL: &quot;mqqopensdkapiV2:&#47;&#47;&quot; - error: &quot;This app is not allowed to query for scheme mqqopensdkapiv2&quot;\n2020-01-15 16:29:19.093270+0800 SampleApp[57130:1926879] qqversion not suport opensdkapiV2\n2020-01-15 16:29:19.093455+0800 SampleApp[57130:1926879] API Method must be specified","like_count":1,"discussions":[{"author":{"id":1041455,"avatar":"http://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTKJ3dLlYr6tznfnZXJNsD7Jw48BVnFSib3RO3VWEN0pgebRY1jaR8YXLQ6iaAjTsFiamOWSA3UPAa37A/132","nickname":"Geek_e7jq8k","note":"","ucode":"352964E5D793DA","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":481597,"discussion_content":"看一下课程中7分05秒左右，理论上对应的Scheme需要在LSApplicationQueriesSchemes中进行添加。那么对于我们的Demo，由于是在模拟器中使用的无法安装QQ，所以SDK会自动的拉起网页，这部分的能力不会有影响。具体LSApplicationQueriesSchemes的作用和意义在后续的课程中也会有讲解，主要就是支持在我们的App中判断对应Scheme的App是否安装的这个能力。总的来说，第一个日志可以通过添加LSApplicationQueriesSchemes优化掉，下面的日志需要在真机上安装QQ。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1579406396,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":2003998,"avatar":"https://static001.geekbang.org/account/avatar/00/1e/94/1e/25c77c24.jpg","nickname":"luowentao","note":"","ucode":"4122CA5BD503CE","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":286193,"discussion_content":"同样的问题，请问怎么解决","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1593083219,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":184495,"user_name":"Hugo","can_delete":false,"product_type":"c3","uid":1067050,"ip_address":"","ucode":"ABD4B55F8DE278","user_header":"https://static001.geekbang.org/account/avatar/00/10/48/2a/28af04d5.jpg","comment_is_top":false,"comment_ctime":1583328654,"is_pvip":false,"replies":[{"id":74564,"content":"建议上传下代码哈，留言url我帮你看下","user_name":"作者回复","user_name_real":"zzz","uid":1041455,"ctime":1585373028,"ip_address":"","comment_id":184495,"utype":1}],"discussion_count":1,"race_medal":0,"score":2,"product_id":100025901,"comment_content":"还是报错：\n20-03-04 21:30:26.313978+0800 SampleApp[34660:42075560] PBItemCollectionServicer connection disconnected.\n2020-03-04 21:30:26.314632+0800 SampleApp[34660:42075368] openQQWithURL failed\n2020-03-04 21:30:26.315120+0800 SampleApp[34660:42075368] openTIMWithURL failed\n2020-03-04 21:30:26.315224+0800 SampleApp[34660:42075368] openQQWithCommand failed\n2020-03-04 21:30:26.315305+0800 SampleApp[34660:42075368] API Method must be specified","like_count":0,"discussions":[{"author":{"id":1041455,"avatar":"http://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTKJ3dLlYr6tznfnZXJNsD7Jw48BVnFSib3RO3VWEN0pgebRY1jaR8YXLQ6iaAjTsFiamOWSA3UPAa37A/132","nickname":"Geek_e7jq8k","note":"","ucode":"352964E5D793DA","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":486035,"discussion_content":"建议上传下代码哈，留言url我帮你看下","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1585373028,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":183895,"user_name":"Hugo","can_delete":false,"product_type":"c3","uid":1067050,"ip_address":"","ucode":"ABD4B55F8DE278","user_header":"https://static001.geekbang.org/account/avatar/00/10/48/2a/28af04d5.jpg","comment_is_top":false,"comment_ctime":1583157083,"is_pvip":false,"replies":[{"id":74565,"content":"建议上传下代码哈，留言url我帮你看下","user_name":"作者回复","user_name_real":"zzz","uid":1041455,"ctime":1585373037,"ip_address":"","comment_id":183895,"utype":1}],"discussion_count":1,"race_medal":0,"score":2,"product_id":100025901,"comment_content":"貌似那个报错和我用 - (void)scene:(UIScene *)scene willConnectToSession:(UISceneSession *)session options:(UISceneConnectionOptions *)connectionOptions { 有关？","like_count":0,"discussions":[{"author":{"id":1041455,"avatar":"http://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTKJ3dLlYr6tznfnZXJNsD7Jw48BVnFSib3RO3VWEN0pgebRY1jaR8YXLQ6iaAjTsFiamOWSA3UPAa37A/132","nickname":"Geek_e7jq8k","note":"","ucode":"352964E5D793DA","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":485813,"discussion_content":"建议上传下代码哈，留言url我帮你看下","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1585373037,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":183888,"user_name":"Hugo","can_delete":false,"product_type":"c3","uid":1067050,"ip_address":"","ucode":"ABD4B55F8DE278","user_header":"https://static001.geekbang.org/account/avatar/00/10/48/2a/28af04d5.jpg","comment_is_top":false,"comment_ctime":1583155518,"is_pvip":false,"replies":[{"id":71747,"content":"是的，课程录制是还是iOS12，所以不会涉及到iOS13相关的问题。这个问题在 reason 已经提到了具体的问题和解决方案。&#39;UIAlertView is deprecated and unavailable for UIScene based applications, please use UIAlertController!&#39; 所以如果是基于UIScene的，使用UIAlertController即可。","user_name":"作者回复","user_name_real":"zzz","uid":1041455,"ctime":1583670677,"ip_address":"","comment_id":183888,"utype":1}],"discussion_count":1,"race_medal":0,"score":2,"product_id":100025901,"comment_content":"老师  xcode 11，13.2 版本 作这这一节课 报错\n\n020-03-02 21:24:07.409806+0800 SampleApp[87612:38894497] *** Terminating app due to uncaught exception &#39;NSObjectNotAvailableException&#39;, reason: &#39;UIAlertView is deprecated and unavailable for UIScene based applications, please use UIAlertController!&#39;\n*** First throw call stack:\n(\n\t0   CoreFoundation                      0x00007fff23c7127e __exceptionPreprocess + 350\n\t1   libobjc.A.dylib                     0x00007fff513fbb20 objc_exception_throw + 48\n\t2   CoreFoundation                      0x00007fff23c710bc +[NSException raise:format:] + 188\n\t3   UIKitCore                           0x00007fff475f1c0a -[UIAlertView initWithFrame:] + 316\n\t4   UIKitCore                           0x00007fff475f2275 -[UIAlertView initWithTitle:message:delegate:cancelButtonTitle:otherButtonTitles:] + 218\n\t5   SampleApp                           0x0000000100cdd244 -[UIView(WebCacheOperation) sd_removeImageLoadOperationWithKey:] + 56372\n\t6   SampleApp                           0x0000000100cde668 -[UIView(WebCacheOperation) sd_removeImageLoadOperationWithKey:] + 61528\n\t7   SampleApp                           0x0000000100c36d6b -[GTLogin loginWithFinishBlock:] + 443\n\t8   SampleApp                           0x0000000100c3a01e -[GTMineViewController _tapImage] + 318\n\t9   UIKitCore                           0x00007fff47c3a347 -[UIGestureRecognizerTarget _sendActionWithGestureRecognizer:] + 44\n\t10  UIKitCore                           0x00007fff47c4333d _UIGestureRecognizerSendTargetActions + 109\n\t11  UIKitCore                           0x00007fff47c409ea _UIGestureRecognizerSendActions + 298\n\t12  UIKitCore                           0x00007fff47c3fd17 -[UIGestureRecognizer _updateGestureForActiveEvents] + 757\n\t13  UIKitCore                           0x00007fff47c31eda _UIGestureEnvironmentUpdate + 2706\n","like_count":0,"discussions":[{"author":{"id":1041455,"avatar":"http://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTKJ3dLlYr6tznfnZXJNsD7Jw48BVnFSib3RO3VWEN0pgebRY1jaR8YXLQ6iaAjTsFiamOWSA3UPAa37A/132","nickname":"Geek_e7jq8k","note":"","ucode":"352964E5D793DA","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":485810,"discussion_content":"是的，课程录制是还是iOS12，所以不会涉及到iOS13相关的问题。这个问题在 reason 已经提到了具体的问题和解决方案。&amp;#39;UIAlertView is deprecated and unavailable for UIScene based applications, please use UIAlertController!&amp;#39; 所以如果是基于UIScene的，使用UIAlertController即可。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1583670677,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":118212,"user_name":"LINBE","can_delete":false,"product_type":"c3","uid":1598489,"ip_address":"","ucode":"DC74D647538356","user_header":"https://static001.geekbang.org/account/avatar/00/18/64/19/9bf8d7ae.jpg","comment_is_top":false,"comment_ctime":1564292671,"is_pvip":false,"replies":[{"id":43538,"content":"上面的是 ![[GTLogin sharedLogin] isLogin] 前面有个❗️就是没有登录的时候才调用。整理的流程就是没有登录那么执行登录的逻辑，因为登录的过程是异步的并且用户可以取消，所以在回调中判断下是否登录成功。","user_name":"作者回复","user_name_real":"dequanzhu","uid":1041455,"ctime":1564450536,"ip_address":"","comment_id":118212,"utype":1}],"discussion_count":1,"race_medal":0,"score":2,"product_id":100025901,"comment_content":"老师好，GTMineViewController.m中私有方法- (void)_tapImage，[[GTLogin shareLogin] isLogin]不是已经判断是否登录了吗？为什么还要调用block块，然后再添加判断isLogin？不能直接，[[GTLogin shareLogin] isLogin]判断登录成功后直接reloadDatak吗？","like_count":0,"discussions":[{"author":{"id":1041455,"avatar":"http://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTKJ3dLlYr6tznfnZXJNsD7Jw48BVnFSib3RO3VWEN0pgebRY1jaR8YXLQ6iaAjTsFiamOWSA3UPAa37A/132","nickname":"Geek_e7jq8k","note":"","ucode":"352964E5D793DA","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":460304,"discussion_content":"上面的是 ![[GTLogin sharedLogin] isLogin] 前面有个❗️就是没有登录的时候才调用。整理的流程就是没有登录那么执行登录的逻辑，因为登录的过程是异步的并且用户可以取消，所以在回调中判断下是否登录成功。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1564450536,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":313411,"user_name":"wxyzjp 123","can_delete":false,"product_type":"c3","uid":2573454,"ip_address":"","ucode":"6E8739C65165BE","user_header":"https://static001.geekbang.org/account/avatar/00/27/44/8e/5a841e48.jpg","comment_is_top":false,"comment_ctime":1632411438,"is_pvip":false,"replies":null,"discussion_count":0,"race_medal":0,"score":2,"product_id":100025901,"comment_content":"老师对应版本的指南可以上传一下吗","like_count":0},{"had_liked":false,"id":184039,"user_name":"Hugo","can_delete":false,"product_type":"c3","uid":1067050,"ip_address":"","ucode":"ABD4B55F8DE278","user_header":"https://static001.geekbang.org/account/avatar/00/10/48/2a/28af04d5.jpg","comment_is_top":false,"comment_ctime":1583209658,"is_pvip":false,"replies":null,"discussion_count":0,"race_medal":0,"score":2,"product_id":100025901,"comment_content":"删除SceneDelegate代理文件 (可选)\n删除 Info.plist里面的Application Scene Manifest配置（一定要删除）\n删除 AppDelegate代理的两个方法：\napplication:configurationForConnectingSceneSession:options:\napplication: didDiscardSceneSessions:\n这两个方法一定要删除，否则使用纯代码创建的Window和导航控制器UINavigationController不会生效。","like_count":0}]}