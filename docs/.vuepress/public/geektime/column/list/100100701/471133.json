{"id":471133,"title":"07ï½œæ•´åˆæ•°æ®ï¼šæšä¸¾ã€ç»“æ„ä¸è”åˆæ˜¯å¦‚ä½•å®ç°çš„ï¼Ÿ","content":"<p>ä½ å¥½ï¼Œæˆ‘æ˜¯äºèˆªã€‚</p><p>C è¯­è¨€ä¸ºæˆ‘ä»¬æä¾›äº†é«˜äºæœºå™¨æŒ‡ä»¤çš„ä¸€å®šæŠ½è±¡èƒ½åŠ›ï¼Œè¿™ä½¿å¾—æˆ‘ä»¬èƒ½å¤Ÿä»¥æ¥è¿‘è‡ªç„¶è¯­è¨€çš„æ–¹å¼æ¥æ„å»ºåº”ç”¨ç¨‹åºã€‚å¦‚æœè¯´ä½¿ç”¨ C è¯­è¨€æ˜¯ç”¨ç –å—æ¥é€ æˆ¿å­ï¼Œé‚£ä½¿ç”¨å…¶ä»–é«˜æŠ½è±¡ç²’åº¦ç¼–ç¨‹è¯­è¨€ï¼Œå°±æ˜¯ç›´æ¥ä»¥å¢™é¢ä¸ºå•ä½æ¥æ­å»ºã€‚å¾ˆæ˜æ˜¾ï¼Œä»è¿™ä¸ªè§’åº¦æ¥è¯´ï¼ŒC è¯­è¨€ç”¨èµ·æ¥ä¸å¦‚å…¶ä»–é«˜çº§è¯­è¨€æ–¹ä¾¿ï¼Œä½†å®ƒä¹ŸåŒæ—¶ç»™äºˆäº†æ›´ç»†çš„æ„å»ºç²’åº¦ï¼Œè®©æˆ‘ä»¬èƒ½å¤ŸæŒ‰ç…§è‡ªå·±çš„æƒ³æ³•ï¼Œçµæ´»è‡ªå®šä¹‰å¢™é¢çš„å½¢æ€ã€‚</p><p>å¯¹äºè¿™é‡Œæåˆ°çš„ç –å—å’Œå¢™é¢ï¼Œä½ å¯ä»¥å°†å®ƒä»¬ç®€å•ç†è§£ä¸ºç¼–ç¨‹è¯­è¨€åœ¨æ„å»ºç¨‹åºæ—¶ä½¿ç”¨çš„æ•°æ®ç±»å‹ã€‚æ¯”å¦‚åœ¨ Python è¯­è¨€ä¸­ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨é›†åˆï¼ˆsetï¼‰ã€å­—å…¸ï¼ˆdictï¼‰ç­‰å¤æ‚æ•°æ®ç±»å‹ã€‚è€Œåœ¨ Java è¯­è¨€ä¸­ï¼ŒMap æœ¬èº«åˆä¼šè¢«ç»†åˆ†ä¸º HashMapã€LinkedHashMapã€EnumMap ç­‰å¤šç§ç±»å‹ï¼Œä¾›ä¸åŒåº”ç”¨åœºæ™¯ä½¿ç”¨ã€‚</p><p>ä¸ºäº†åœ¨ä¿æŒè‡ªèº«ç²¾ç®€çš„åŒæ—¶ä¹Ÿä¿è¯è¶³å¤Ÿé«˜çš„çµæ´»æ€§ï¼ŒC è¯­è¨€åœ¨æä¾›åŸºæœ¬æ•°å€¼ç±»å‹å’ŒæŒ‡é’ˆç±»å‹çš„åŸºç¡€ä¸Šï¼Œåˆä¸ºæˆ‘ä»¬æä¾›äº†ç»“æ„ï¼ˆstructï¼‰ã€è”åˆï¼ˆunionï¼‰ä¸æšä¸¾ï¼ˆenumï¼‰è¿™ä¸‰ç§ç±»å‹ã€‚ç»“åˆä½¿ç”¨è¿™äº›ç±»å‹ï¼Œæˆ‘ä»¬å°±èƒ½å°†å°çš„â€œç –å—â€ç»„åˆèµ·æ¥ï¼Œä»è€Œå°†å®ƒä»¬æ‹¼æ¥æˆä¸ºæ›´å¤§çš„ã€å…·æœ‰ç‰¹å®šåŠŸèƒ½ç»“æ„çš„å¤æ‚æ„å»ºå•å…ƒã€‚</p><p>æ¥ä¸‹æ¥ï¼Œå°±è®©æˆ‘ä»¬ä¸€èµ·çœ‹çœ‹ï¼šç¼–è¯‘å™¨æ˜¯å¦‚ä½•åœ¨èƒŒåå®ç°è¿™ä¸‰ç§æ•°æ®ç±»å‹çš„ï¼Ÿè€Œåœ¨å®ç°ä¸Šï¼Œä¸ºäº†å…¼é¡¾ç¨‹åºçš„æ€§èƒ½è¦æ±‚ï¼Œç¼–è¯‘å™¨åˆåšäº†å“ªäº›ç‰¹æ®Šä¼˜åŒ–ï¼Ÿ</p><!-- [[[read_end]]] --><h2>æšä¸¾</h2><p>åœ¨ç¼–ç¨‹è¯­è¨€ä¸­ï¼Œæšä¸¾ï¼ˆEnumerationï¼‰è¿™ç§æ•°æ®ç±»å‹å¯ä»¥ç”±ç¨‹åºå‘˜è‡ªè¡Œå®šä¹‰ï¼Œç”¨æ¥è¡¨ç¤ºæŸç±»å¯å–å€¼èŒƒå›´æœ‰é™çš„æŠ½è±¡æ¦‚å¿µã€‚</p><p>ä¸‹é¢æˆ‘ä»¬æ¥çœ‹ä¸€ä¸ªç»å…¸çš„ä¾‹å­ï¼šåº”è¯¥å¦‚ä½•ä½¿ç”¨ç¼–ç¨‹è¯­è¨€æ¥è¡¨ç¤º â€œå‘¨å·¥ä½œæ—¥ï¼ˆweekdayï¼‰â€ è¿™ä¸ªæ¦‚å¿µå‘¢ï¼Ÿ</p><p>å‘¨å·¥ä½œæ—¥å±äºç°å®ä¸–ç•Œä¸­çš„ä¸€ç§æŠ½è±¡æ¦‚å¿µï¼Œå®ƒåŒ…å«å‘¨ä¸€åˆ°å‘¨äº”å…±äº”ä¸ªæœ‰æ•ˆå€¼ã€‚ä¸åŒäºæ•°å€¼ã€å­—ç¬¦ç­‰æ¦‚å¿µï¼Œå®ƒæ— æ³•ç›´æ¥å¯¹åº”åˆ°ç‰©ç†è®¡ç®—æœºä¸­çš„ä»»ä½•è½¯ç¡¬ä»¶å®ç°ä¸Šã€‚å› æ­¤ï¼Œä¸ºäº†èƒ½å¤Ÿåœ¨ç¨‹åºä¸­æ›´åŠ ç²¾ç¡®åœ°è¡¨è¾¾è¿™ç±»ä¿¡æ¯ï¼Œæˆ‘ä»¬å¯ä»¥ç”¨æšä¸¾æ¥è‡ªå®šä¹‰å¯¹åº”çš„ç±»å‹ã€‚</p><p>åœ¨ C è¯­è¨€ä¸­ï¼Œæˆ‘ä»¬å¯ä»¥è¿™æ ·å®ç°ï¼š</p><p><img src=\"https://static001.geekbang.org/resource/image/45/d5/453a138a660a7e8f7c173391e17a75d5.png?wh=1920x1356\" alt=\"å›¾ç‰‡\"></p><p>ä¸ºäº†ä¾¿äºè§‚å¯Ÿï¼Œæˆ‘ç›´æ¥å±•ç¤ºäº† C ä»£ç åŠå…¶å¯¹åº”çš„æ±‡ç¼–ä»£ç ã€‚å¯ä»¥çœ‹åˆ°ï¼Œç¼–è¯‘å™¨æ²¡æœ‰ä¸ºå·¦ä¾§çº¢æ¡†å†…çš„æšä¸¾ç±»å‹å®šä¹‰ç”Ÿæˆä»»ä½•çš„æœºå™¨æŒ‡ä»¤ã€‚å®é™…ä¸Šï¼Œåœ¨ C è¯­è¨€ä¸­ï¼Œæ¯ä¸€ä¸ªè‡ªå®šä¹‰æšä¸¾ç±»å‹ä¸­çš„æšä¸¾å€¼ï¼Œéƒ½æ˜¯ä»¥ <code>int</code> ç±»å‹çš„æ–¹å¼è¢«å­˜å‚¨çš„ï¼Œå› æ­¤ï¼Œè¿™äº›æšä¸¾å€¼æœ‰æ—¶ä¹Ÿè¢«ç§°ä¸ºâ€œå…·åæ•´å‹â€ã€‚ä½ å¯ä»¥ä»ä¸Šå›¾å³ä¾§è“æ¡†å†…çš„æ±‡ç¼–ä»£ç ä¸­çœ‹åˆ°ï¼Œå½“å‡½æ•° foo è¢«è°ƒç”¨æ—¶ï¼Œä¼ å…¥çš„æšä¸¾å€¼ Mon æ­£å¯¹åº”äºé€šè¿‡ edi å¯„å­˜å™¨ä¼ å…¥çš„å­—é¢é‡æ•°å­— 0ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œæšä¸¾å€¼ Mon åœ¨åº•å±‚æ˜¯ç”±æ•°å­—å€¼ 0 è¡¨ç¤ºçš„ã€‚</p><p>åŒæ ·åœ°ï¼Œåœ¨å·¦ä¾§ C ä»£ç çš„ç¬¬ 11 è¡Œï¼Œæˆ‘ä»¬ä¹Ÿä½¿ç”¨äº†æ³›å‹å®æ¥åˆ¤æ–­æšä¸¾å€¼ Mon çš„å…·ä½“ç±»å‹ã€‚ä½ å¯ä»¥å°è¯•è¿è¡Œè¿™æ®µä»£ç ï¼Œå¹¶è§‚å¯Ÿç¨‹åºçš„è¾“å‡ºç»“æœï¼Œä»¥éªŒè¯æˆ‘ä»¬çš„ç»“è®ºã€‚</p><p>éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œ<strong>C æ ‡å‡†ç›´æ¥å°†æšä¸¾å€¼å½“ä½œæ•´æ•°è¿›è¡Œå¤„ç†çš„è¿™ç§æ–¹å¼ï¼Œå¯èƒ½ä¼šå¯¼è‡´æˆ‘ä»¬åœ¨æ„å»ºç¨‹åºæ—¶é‡åˆ°æ„æƒ³ä¸åˆ°çš„é—®é¢˜ã€‚</strong>æ¯”å¦‚ï¼Œå¯¹äºä¸Šè¿°è¿™æ®µ C ä»£ç ï¼Œå‡½æ•° foo åœ¨è¢«è°ƒç”¨æ—¶ï¼Œå®é™…ä¸Šå…è®¸ä¼ å…¥ä»»ä½•å¯ä»¥è¢«éšå¼è½¬æ¢ä¸º <code>int</code> ç±»å‹çš„å€¼ï¼Œå“ªæ€•è¿™ä¸ªå€¼æ¥æºäºå¦ä¸€ä¸ªæšä¸¾ç±»å‹çš„å˜é‡ã€‚å› æ­¤ï¼Œè®©æšä¸¾ç±»å‹æœ‰åŠ©äºç»„ç»‡ç¨‹åºä»£ç çš„åŒæ—¶å¹¶ç¡®ä¿å®ƒä¸è¢«ä¹±ç”¨ï¼Œä¹Ÿæ˜¯æˆ‘ä»¬åœ¨æ„å»ºé«˜è´¨é‡ç¨‹åºæ—¶éœ€è¦æ³¨æ„çš„ä¸€ä¸ªé—®é¢˜ã€‚</p><h2>ç»“æ„</h2><p>åœ¨ C è¯­è¨€ä¸­ï¼Œæ•°ç»„ç”¨æ¥å°†ä¸€ç°‡ç›¸åŒç±»å‹çš„æ•°æ®å­˜æ”¾åœ¨è¿ç»­çš„å†…å­˜æ®µä¸Šã€‚è€Œç»“æ„ï¼ˆStructï¼‰å®é™…ä¸Šä¸å…¶ç±»ä¼¼ï¼Œåªä¸è¿‡åœ¨ç»“æ„å†…éƒ¨ï¼Œæˆ‘ä»¬å¯ä»¥å­˜æ”¾ä¸åŒç±»å‹çš„æ•°æ®ã€‚å…ˆæ¥çœ‹ä¸€æ®µä»£ç ï¼š</p><p><img src=\"https://static001.geekbang.org/resource/image/af/49/af6ffbd5313461163e28949d40636049.png?wh=1920x999\" alt=\"å›¾ç‰‡\"></p><p>åœ¨ä¸Šå›¾å·¦ä¾§çš„ C ä»£ç ä¸­ï¼Œæˆ‘ä»¬å®šä¹‰äº†ä¸€ä¸ªåä¸º S çš„ç»“æ„ã€‚å¯¹äºæ¯ä¸€ä¸ªç»“æ„ S çš„å¯¹è±¡ï¼Œå…¶å†…éƒ¨éƒ½ä¼šè¿ç»­å­˜æ”¾ä¸‰ä¸ªç±»å‹å®Œå…¨ä¸åŒçš„æ•°æ®å€¼ï¼Œå³ä¸€ä¸ªå­—ç¬¦æŒ‡é’ˆã€ä¸€ä¸ªå­—ç¬¦å€¼ã€ä¸€ä¸ªé•¿æ•´å‹æ•°å€¼ã€‚</p><p>åœ¨ä»£ç çš„ç¬¬ 10 è¡Œï¼Œæˆ‘ä»¬é€šè¿‡æ‹¬å·åˆ—è¡¨åˆå§‹åŒ–çš„æ–¹å¼ï¼Œæ„é€ äº†ç»“æ„ S çš„ä¸€ä¸ªå¯¹è±¡ sã€‚é€šè¿‡å³ä¸Šæ–¹è“æ¡†ä¸­çš„æ±‡ç¼–ä»£ç ï¼Œæˆ‘ä»¬å¯ä»¥çœ‹åˆ°ç¼–è¯‘å™¨æ˜¯å¦‚ä½•å®ç°å¯¹å®ƒçš„åˆå§‹åŒ–çš„ã€‚<strong>æœ¬è´¨ä¸Šï¼Œç»“æ„åªæ˜¯å¯¹å…¶å†…éƒ¨æ‰€åŒ…å«å„ç±»æ•°æ®çš„ä¸€ä¸ªå°è£…ï¼Œå› æ­¤ä»ç¼–è¯‘äº§ç‰©çš„è§’åº¦æ¥çœ‹ï¼Œåªéœ€è¦æŠŠå®ƒå°è£…çš„è¿™äº›æ•°æ®è¿ç»­åœ°å­˜æ”¾åœ¨å†…å­˜ä¸­å³å¯ã€‚</strong>äº‹å®ä¹Ÿæ­£æ˜¯å¦‚æ­¤ï¼Œå¯¹ç»“æ„ S å†…éƒ¨ä¸‰ä¸ªæ•°æ®çš„åˆå§‹åŒ–è¿‡ç¨‹ï¼Œå‡æ˜¯ç”±æŒ‡ä»¤ <code>mov</code> å®Œæˆçš„ï¼Œè¿™äº›æ•°æ®è¢«åˆå§‹åŒ–åœ¨æ ˆå†…å­˜ä¸­ã€‚</p><p>ç»“æ„ä¸­çš„æ•°æ®é¡¹è¢«åˆå§‹åŒ–åœ¨å†…å­˜ä¸­ï¼Œè¿™æ¯‹åº¸ç½®ç–‘ï¼Œä½†å®ƒä»¬çœŸçš„â€œè¿ç»­â€å—ï¼Ÿ</p><p>ä¸ºäº†éªŒè¯è¿™ä¸ªé—®é¢˜ï¼Œæˆ‘ä»¬åœ¨å·¦ä¾§ C ä»£ç çš„ç¬¬ 12 è¡Œï¼Œé€šè¿‡ <code>sizeof</code> è¿ç®—ç¬¦å°†ç»“æ„ S çš„å¤§å°æ‰“å°äº†å‡ºæ¥ã€‚æŒ‰ç…§ç»“æ„ S çš„å®šä¹‰æ–¹å¼å’Œæˆ‘ä»¬å¯¹â€œè¿ç»­â€ä¸€è¯çš„ç†è§£ï¼Œå®ƒåœ¨ x86-64 å¹³å°ä¸Šçš„å¤§å°åº”è¯¥ä¸º 17 å­—èŠ‚ã€‚å…¶ä¸­ï¼Œå­—ç¬¦æŒ‡é’ˆ 8 å­—èŠ‚ã€å­—ç¬¦ 1 å­—èŠ‚ï¼Œæœ€åçš„é•¿æ•´å‹æ•°å€¼ 8 å­—èŠ‚ã€‚ä½†æŸ¥çœ‹å³ä¾§é»„æ¡†å†…çš„æ±‡ç¼–ä»£ç åï¼Œä½ ä¼šå‘ç°äº‹å®å¹¶éå¦‚æ­¤ï¼šæ¯ä¸€ä¸ªç»“æ„ S çš„å¯¹è±¡ç«Ÿç„¶å ç”¨äº†å¤šè¾¾ 24 å­—èŠ‚çš„å†…å­˜ã€‚é‚£è¿™æ˜¯ä¸ºä»€ä¹ˆå‘¢ï¼Ÿ</p><p>é€šè¿‡æ•´ç†å¯¹è±¡ s åœ¨åˆå§‹åŒ–æ—¶ä½¿ç”¨çš„æ±‡ç¼–ä»£ç ï¼Œæˆ‘ä»¬å¯ä»¥å¾—åˆ°å…¶å†…éƒ¨å„ä¸ªæˆå‘˜å­—æ®µåœ¨æ ˆå†…å­˜ä¸­çš„å®é™…å¸ƒå±€æƒ…å†µã€‚ç»è¿‡æ•´ç†åï¼Œå¯ä»¥å¾—åˆ°ä¸‹é¢è¿™å¼ å›¾ï¼š</p><p><img src=\"https://static001.geekbang.org/resource/image/43/d4/435e8e8e1c188698cccbf38e1ec719d4.jpg?wh=1920x475\" alt=\"å›¾ç‰‡\"></p><p>ä»å·¦è‡³å³ï¼Œè¿™å¼ å›¾ä»£è¡¨ç€æ ˆå†…å­˜çš„å¢é•¿æ–¹å‘ï¼ˆé«˜åœ°å€ -&gt; ä½åœ°å€ï¼‰ã€‚å…¶ä¸­ï¼Œå¯„å­˜å™¨ rsp æŒ‡å‘æ ˆé¡¶çš„ä½åœ°å€ï¼Œè€Œ rbp å¯„å­˜å™¨åˆ™æŒ‡å‘æ ˆå¸§å¼€å§‹å¤„çš„é«˜åœ°å€ã€‚æŒ‰ç…§æ±‡ç¼–ä»£ç ä¸­çš„æŒ‡ä»¤ï¼Œå­—ç¬¦æŒ‡é’ˆ p ä½äº [rbp-32] å¤„ï¼Œå¹¶å ç”¨ 8 ä¸ªå­—èŠ‚ï¼›å­—ç¬¦ c ä½äº [rbp-24] å¤„ï¼Œå¹¶å ç”¨ 1 ä¸ªå­—èŠ‚ã€‚è€Œé•¿æ•´å‹å˜é‡ x åˆ™ä½äº [rbp-16] å¤„ï¼Œå¹¶å ç”¨ 8 ä¸ªå­—èŠ‚ã€‚</p><p>å¯ä»¥çœ‹åˆ°ï¼Œç¼–è¯‘å™¨å®é™…ä¸Šå¹¶æ²¡æœ‰æŒ‰ç…§ä¸¥æ ¼è¿ç»­çš„æ–¹å¼æ¥â€œæ‘†æ”¾â€è¿™ä¸‰ä¸ªæ•°æ®å€¼ï¼Œå…¶ä¸­ï¼Œ[rbp-25] åˆ° [rbp-16] ä¸­é—´çš„ 7 ä¸ªå­—èŠ‚å¹¶æ²¡æœ‰å­˜æ”¾ä»»ä½•æ•°æ®ã€‚è€Œç¼–è¯‘å™¨è¿™æ ·åšçš„ä¸€ä¸ªé‡è¦ç›®çš„ï¼Œä¾¿æ˜¯ä¸ºäº†â€œæ•°æ®å¯¹é½â€ã€‚</p><h3>å†…å­˜æ•°æ®å¯¹é½</h3><p>å¯¹äºç°ä»£è®¡ç®—æœºè€Œè¨€ï¼Œå½“å†…å­˜ä¸­éœ€è¦è¢«è¯»å†™çš„æ•°æ®ï¼Œå…¶æ‰€åœ¨åœ°å€æ»¡è¶³â€œè‡ªç„¶å¯¹é½â€æ—¶ï¼ŒCPU é€šå¸¸èƒ½å¤Ÿä»¥æœ€é«˜çš„æ•ˆç‡è¿›è¡Œæ•°æ®æ“ä½œã€‚<strong>è€Œæ‰€è°“è‡ªç„¶å¯¹é½ï¼Œæ˜¯æŒ‡è¢«æ“ä½œæ•°æ®çš„æ‰€åœ¨åœ°å€ä¸ºè¯¥æ•°æ®å¤§å°çš„æ•´æ•°å€ã€‚</strong>æ¯”å¦‚åœ¨ x86-64 æ¶æ„ä¸­ï¼Œè‹¥ä¸€ä¸ª <code>int</code> ç±»å‹çš„å˜é‡ï¼Œå…¶å€¼åœ¨å†…å­˜ä¸­è¿ç»­å­˜æ”¾ï¼Œä¸”æœ€ä½æœ‰æ•ˆä½å­—èŠ‚ï¼ˆLSBï¼‰çš„æ‰€åœ¨åœ°å€ä¸º 4 çš„æ•´æ•°å€ï¼Œé‚£æˆ‘ä»¬å°±å¯ä»¥è¯´è¯¥å˜é‡çš„å€¼åœ¨å†…å­˜ä¸­æ˜¯å¯¹é½çš„ã€‚</p><p>è‡ªç„¶å¯¹é½ä¸ºä»€ä¹ˆèƒ½å¤Ÿå‘æŒ¥ CPU æœ€å¤§çš„å†…å­˜è¯»å–æ•ˆç‡å‘¢ï¼Ÿè¿™å®é™…ä¸Šä¸ CPU å’Œ MMUï¼ˆå†…å­˜ç®¡ç†å•å…ƒï¼‰ç­‰å†…å­˜è¯»å†™ç›¸å…³æ ¸å¿ƒç¡¬ä»¶å‘å±•è¿‡ç¨‹ä¸­çš„è¯¸å¤šé™åˆ¶æ€§å› ç´ æœ‰å…³ã€‚æ¯”å¦‚ï¼Œå¯¹äºæŸäº›å¤è€çš„ Sun SPARC å’Œ ARM å¤„ç†å™¨æ¥è¯´ï¼Œå®ƒä»¬åªèƒ½è®¿é—®ä½äºç‰¹å®šåœ°å€ä¸Šçš„å¯¹é½æ•°æ®ï¼Œè€Œå¯¹äºéå¯¹é½æ•°æ®çš„è®¿é—®ï¼Œåˆ™ä¼šäº§ç”Ÿå¼‚å¸¸ã€‚ç›¸åï¼Œæœ‰äº›å¤„ç†å™¨åˆ™èƒ½å¤Ÿæ”¯æŒå¯¹éå¯¹é½æ•°æ®çš„è®¿é—®ï¼Œä½†ç”±äºè®¾è®¡å·¥è‰ºä¸Šçš„é™åˆ¶ï¼Œå¯¹è¿™äº›æ•°æ®çš„è®¿é—®éœ€è¦èŠ±è´¹æ›´å¤šçš„æ—¶é’Ÿå‘¨æœŸã€‚</p><p>å› æ­¤ï¼Œä¸ºäº†è®©ä»£ç é€‚åº”ä¸åŒå¤„ç†å™¨çš„â€œé£æ ¼â€ï¼Œä¿è¯å†…å­˜ä¸­çš„æ•°æ®æ»¡è¶³è‡ªç„¶å¯¹é½è¦æ±‚ï¼Œå°±æˆäº†å¤§å¤šæ•°ç¼–è¯‘å™¨åœ¨ç”Ÿæˆæœºå™¨æŒ‡ä»¤æ—¶è¾¾æˆçš„ä¸€ä¸ªé»˜è®¤å…±è¯†ã€‚å“ªæ€•åœ¨å¦‚ä»Šçš„ç°ä»£ x86-64 å¤„ç†å™¨ä¸Šï¼Œè®¿é—®éå¯¹é½æ•°æ®æ‰€äº§ç”Ÿçš„æ€§èƒ½æŸè€—åœ¨å¤§å¤šæ•°æƒ…å†µä¸‹å·²å¾®ä¸è¶³é“ã€‚</p><h3>å¡«å……å­—èŠ‚</h3><p>è®©æˆ‘ä»¬å†å›åˆ°ä¹‹å‰é‚£ä¸ªä¾‹å­ã€‚å¯ä»¥çœ‹åˆ°çš„æ˜¯ï¼Œä¸ºäº†ç¡®ä¿å¯¹è±¡ s ä¸­æ‰€æœ‰æˆå‘˜å­—æ®µåœ¨æ ˆå†…å­˜ä¸­éƒ½æ»¡è¶³è‡ªç„¶å¯¹é½çš„è¦æ±‚ï¼Œç¼–è¯‘å™¨ä¼šæ’å…¥é¢å¤–çš„â€œå¡«å……å­—èŠ‚â€ï¼Œæ¥åŠ¨æ€è°ƒæ•´ç»“æ„å¯¹è±¡ä¸­å„ä¸ªå­—æ®µå¯¹åº”æ•°æ®çš„èµ·å§‹ä½ç½®ã€‚</p><p>é™¤æ­¤ä¹‹å¤–ï¼Œåœ¨æŸäº›æƒ…å†µä¸‹ï¼Œå³ä½¿ç»“æ„å¯¹è±¡å†…å„ä¸ªæ•°æ®æˆå‘˜éƒ½æ»¡è¶³è‡ªç„¶å¯¹é½çš„è¦æ±‚ï¼Œé¢å¤–çš„å¡«å……å­—èŠ‚ä¹Ÿå¯èƒ½ä¼šè¢«æ·»åŠ ã€‚æ¯”å¦‚ä¸‹é¢è¿™ä¸ªä¾‹å­ï¼š</p><pre><code class=\"language-c++\">struct Foo {\n&nbsp; char *p;&nbsp; // 8 bytes.\n&nbsp; char c;  // 1 bytes.\n  // (padding): 7 bytes.\n};\n</code></pre><p>è¿™é‡Œå¯ä»¥çœ‹åˆ°ï¼Œç»“æ„ Foo ä¸­çš„ä¸¤ä¸ªæˆå‘˜å­—æ®µåœ¨é»˜è®¤æƒ…å†µä¸‹å·²ç»æ»¡è¶³è‡ªç„¶å¯¹é½çš„è¦æ±‚ï¼ˆå‡è®¾å­—ç¬¦æŒ‡é’ˆ p çš„å­˜æ”¾èµ·å§‹ä½ç½®æ»¡è¶³ 8 å­—èŠ‚å¯¹é½ï¼‰ã€‚ä½†å®é™…ä¸Šï¼Œåœ¨é€šè¿‡ <code>sizeof</code> è¿ç®—ç¬¦å¯¹å®ƒè¿›è¡Œæ±‚å€¼æ—¶ï¼Œæˆ‘ä»¬ä¼šå¾—åˆ° 16 å­—èŠ‚å¤§å°çš„ç»“æœï¼Œè€Œéç›´è§‚çš„ 9 å­—èŠ‚ã€‚</p><p>ä¹‹æ‰€ä»¥ä¼šå‡ºç°è¿™æ ·çš„ç°è±¡ï¼Œå°±æ˜¯å› ä¸ºç¼–è¯‘å™¨æƒ³è¦ä¿è¯è¿™ä¸€ç‚¹ï¼šå½“ç»“æ„å¯¹è±¡è¢«è¿ç»­å­˜æ”¾æ—¶ï¼ˆæ¯”å¦‚é€šè¿‡æ•°ç»„ï¼‰ï¼Œå‰ä¸€ä¸ªå¯¹è±¡çš„ç»“æŸä½ç½®æ­£å¥½å¯ä»¥æ»¡è¶³åä¸€ä¸ªå¯¹è±¡ä½œä¸ºèµ·å§‹ä½ç½®æ—¶çš„è‡ªç„¶å¯¹é½è¦æ±‚ã€‚è€Œè¿™ä¹Ÿå°±è¦æ±‚ç»“æ„å¯¹è±¡æœ¬èº«çš„å¤§å°å¿…é¡»æ˜¯å…¶å†…éƒ¨æœ€å¤§æˆå‘˜å¤§å°çš„æ•´æ•°å€ã€‚å› æ­¤ï¼Œç¼–è¯‘å™¨ä¼šåœ¨ç»“æ„æœ€åä¸€ä¸ªæˆå‘˜çš„åé¢å†å¡«å……é€‚å½“å­—èŠ‚ï¼Œä»¥æ»¡è¶³è¿™ä¸ªæ¡ä»¶ã€‚å¯ä»¥è¯´ï¼Œåœ¨è¿™ç§æƒ…å†µä¸‹çš„ç»“æ„å¯¹è±¡ï¼Œå·²ç»æ»¡è¶³äº†åœ¨ä¸åŒåœºæ™¯ä¸‹çš„è‡ªç„¶å¯¹é½æ¡ä»¶ï¼Œå› æ­¤ï¼Œæ­¤æ—¶çš„ç»“æ„å¤§å°ä¹Ÿä¼šè¢«ä½œä¸º <code>sizeof</code> è¿ç®—ç¬¦çš„æœ€ç»ˆè®¡ç®—ç»“æœã€‚</p><h2>è”åˆ</h2><p>æœ€åï¼Œæˆ‘ä»¬å†æ¥çœ‹çœ‹ C è¯­è¨€ä¸­çš„ç¬¬ä¸‰ç§åŠŸèƒ½å¼ºå¤§çš„æ•°æ®ç±»å‹ï¼Œâ€œè”åˆï¼ˆUnionï¼‰â€ã€‚è”åˆä¸â€œç»“æ„â€åœ¨è¯­æ³•ä¸Šçš„ä½¿ç”¨æ–¹å¼ååˆ†ç±»ä¼¼ï¼Œåªä¸è¿‡è¦æŠŠå¯¹åº”çš„è¯­æ³•å…³é”®å­—ä» <code>struct</code> æ›´æ¢ä¸º <code>union</code> ã€‚</p><p>é™¤æ­¤ä¹‹å¤–ï¼ŒäºŒè€…è¿˜æœ‰ä¸€ä¸ªè¾ƒå¤§çš„åŒºåˆ«ï¼Œæˆ‘ä»¬å¯ä»¥ä»â€œè”åˆâ€è¿™ä¸ªåå­—è°ˆèµ·ã€‚é¡¾åæ€ä¹‰ï¼Œâ€œè”åˆâ€å°±æ„å‘³ç€å®šä¹‰åœ¨è¯¥ç»“æ„å†…çš„æ‰€æœ‰æ•°æ®å­—æ®µï¼Œå°†ä¼šè”åˆèµ·æ¥å…±äº«åŒä¸€å—å†…å­˜åŒºåŸŸã€‚è¿˜æ˜¯å…ˆæ¥çœ‹ä¸€æ®µä»£ç ï¼š</p><p><img src=\"https://static001.geekbang.org/resource/image/46/18/4609c5e57d1b198884bf5b7d2ee86a18.png?wh=1920x1203\" alt=\"å›¾ç‰‡\"></p><p>è¿™é‡Œï¼Œåœ¨å·¦ä¾§çš„ C ä»£ç ä¸­ï¼Œæˆ‘ä»¬ä½¿ç”¨ â€œTagged Unionâ€ çš„æ¨¡å¼å¯¹è”åˆè¿›è¡Œäº†å°è£…ã€‚<strong>ä¸ç»“æ„ä¸åŒï¼Œå¯¹äºæ¯ä¸€ä¸ªå•ç‹¬çš„è”åˆå¯¹è±¡æ¥è¯´ï¼Œåœ¨æŸä¸€æ—¶åˆ»å…¶å†…éƒ¨å“ªä¸€ä¸ªå­—æ®µæ­£åœ¨ç”Ÿæ•ˆï¼Œæˆ‘ä»¬æ— ä»å¾—çŸ¥ã€‚</strong>å› æ­¤ï¼ŒTagged Union çš„ä½¿ç”¨æ–¹å¼è¦æ±‚æˆ‘ä»¬ä¸ºæ¯ä¸€ä¸ªè”åˆè®¾ç½®å•ç‹¬çš„â€œæ ‡ç­¾â€ï¼Œç”¨æ¥æ˜ç¡®æŒ‡å‡ºå½“å‰è”åˆå†…éƒ¨æ­£åœ¨ç”Ÿæ•ˆçš„å­—æ®µã€‚åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬ä¾¿éœ€è¦å°†è¿™ä¸ªæ ‡ç­¾ä¸è”åˆè¿›è¡Œå°è£…ï¼Œæ¥å°†å®ƒä»¬è¿›è¡Œâ€œç»‘å®šâ€ã€‚</p><p>å¯ä»¥çœ‹åˆ°ï¼Œè¿™é‡Œåœ¨ç»“æ„ S å†…éƒ¨ï¼Œæšä¸¾ç±»å‹å­—æ®µ type å°±æ˜¯ç”¨æ¥æ ‡è®°å½“å‰åŒ¿åè”åˆå†…éƒ¨æ‰€å­˜æ”¾çš„æ•°æ®ç§ç±»çš„ã€‚è€Œåœ¨ç´§æ¥ç€çš„åŒ¿åè”åˆå†…éƒ¨ï¼Œæ•´å‹æˆå‘˜ i ä¸å­—ç¬¦æˆå‘˜ c åˆ™å…±äº«è¯¥è”åˆçš„å†…å­˜ç©ºé—´ã€‚è¿™ä¾¿æ˜¯ Tagged Union åœ¨ C è¯­è¨€ä¸­çš„åŸºæœ¬ä½¿ç”¨æ–¹å¼ã€‚</p><p>ä¸€ä¸ªè”åˆå¯¹è±¡çš„å¤§å°åŒè¯¥è”åˆå†…éƒ¨å®šä¹‰æ—¶æ‰€åŒ…å«æœ€å¤§æˆå‘˜çš„å¤§å°ç›¸åŒï¼Œå› æ­¤åœ¨ä¸Šé¢è¿™ä¸ªä¾‹å­ä¸­ï¼Œç»“æ„ S ä¸­çš„åŒ¿åè”åˆå¤§å°ä¾¿ä¸è”åˆå®šä¹‰å†…æ•´å‹å‚æ•° i çš„å¤§å°ç›¸åŒã€‚è¿™ä¸ªå¤§å°åœ¨ x86-64 å¹³å°ä¸Šä¸º 4 å­—èŠ‚ã€‚</p><p>ä»å›¾ç‰‡å³ä¾§è“æ¡†å†…çš„æ±‡ç¼–ä»£ç ä¸­ï¼Œæˆ‘ä»¬ä¹Ÿå¯ä»¥å¾—åˆ°ç›¸åŒçš„ç»“è®ºã€‚ç¬¬ä¸€è¡Œä»£ç å°†æ•´ä¸ªç»“æ„å¯¹è±¡ s æ‰€å ç”¨çš„ 8 å­—èŠ‚ç©ºé—´å…¨éƒ¨ç½®é›¶ï¼Œæ¥ä¸ºåç»­çš„åŒ¿åè”åˆå¯¹è±¡èµ‹å€¼åšå‡†å¤‡ï¼›ç¬¬äºŒè¡Œä»£ç å°†æšä¸¾ç±»å‹ CHAR å¯¹åº”çš„å€¼ 1 èµ‹å€¼ç»™ç»“æ„å¯¹è±¡ s å†…çš„æšä¸¾å­—æ®µ typeï¼›ç¬¬ä¸‰è¡Œä»£ç å°†å­—ç¬¦ â€œaâ€ å¯¹åº”çš„å€¼ 97 å­˜æ”¾åˆ°ç»“æ„å¯¹è±¡ s å†…çš„åŒ¿åè”åˆå¯¹è±¡ä¸­ã€‚è¿™é‡Œå¯ä»¥çœ‹åˆ°ï¼ŒæŒ‡ä»¤ <code>mov</code> åœ¨è¿›è¡Œæ•°æ®ä¼ é€æ—¶ï¼Œåœ¨ç›®çš„åœ°å‚æ•°ä¸­ä½¿ç”¨äº† BYTEï¼Œä¹Ÿå°±æ˜¯â€œå–å‡ºâ€äº†è”åˆå¯¹è±¡æ‰€å ç”¨çš„ 4 å­—èŠ‚ç©ºé—´ä¸­çš„ 1 ä¸ªå­—èŠ‚ï¼Œå°†å…¶ä½œä¸ºå­˜æ”¾å­—ç¬¦æ•°å€¼çš„ç›®æ ‡å†…å­˜ç©ºé—´ã€‚</p><h2>æ€»ç»“</h2><p>å¥½äº†ï¼Œè®²åˆ°è¿™é‡Œï¼Œä»Šå¤©çš„å†…å®¹ä¹Ÿå°±åŸºæœ¬ç»“æŸäº†ï¼Œæœ€åæˆ‘æ¥ç»™ä½ æ€»ç»“ä¸€ä¸‹ã€‚</p><p>è¿™ä¸€è®²æˆ‘ä¸»è¦å›´ç»•ç€ C è¯­è¨€ä¸­çš„æšä¸¾ã€ç»“æ„ä¸è”åˆè¿™ä¸‰ç§æ•°æ®ç±»å‹å±•å¼€äº†ä»‹ç»ï¼Œå’Œä½ ä¸€èµ·æ¢ç©¶äº†å®ƒä»¬åœ¨æœºå™¨æŒ‡ä»¤å±‚é¢çš„å…·ä½“å®ç°æ–¹å¼ã€‚</p><p><strong>æšä¸¾è¿™ç§æ•°æ®ç±»å‹ï¼Œç”¨äºè¡¨ç¤ºå¯å–å€¼èŒƒå›´æœ‰é™çš„æŠ½è±¡å®ä½“ã€‚</strong>æšä¸¾ç±»å‹ä¸­çš„æšä¸¾å€¼åˆè¢«ç§°ä¸ºâ€œå…·åæ•´å‹â€ï¼Œå› æ­¤åœ¨ C ä»£ç ä¸­ï¼Œå®ƒå¯ä»¥ç›´æ¥è¢«å½“ä½œæ•´æ•°å€¼æ¥ä½¿ç”¨ã€‚åŒæ ·åœ°ï¼Œåœ¨ç¼–è¯‘å™¨ç”Ÿæˆçš„ä»£ç ä¸­ï¼Œæšä¸¾å€¼å°†è¢«ç›´æ¥æ›¿æ¢ä¸ºå¯¹åº”çš„æ•´æ•°å€¼ã€‚ä½†éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œæˆ‘ä»¬è¦åœ¨è¿›è¡Œ C ç¼–ç æ—¶ä¿è¯æšä¸¾å€¼å’Œå®ƒå¯¹åº”çš„æ•´æ•°å€¼ä¸è¢«ä¹±ç”¨ã€‚</p><p><strong>ç»“æ„æ˜¯ä¸€ç§ç”¨äºç»„ç»‡å¼‚æ„æ•°æ®çš„å¤åˆæ•°æ®ç±»å‹ã€‚</strong>åœ¨ç»“æ„ä¸­ï¼Œæ‰€æœ‰å®šä¹‰çš„æ•°æ®å­—æ®µåœ¨å†…å­˜ä¸­æŒ‰é¡ºåºæ’åˆ—ã€‚ä¸ºäº†ä¿è¯ç»“æ„ä¸­å„ä¸ªå­—æ®µæœ€é«˜æ•ˆçš„æ•°æ®è®¿é—®é€Ÿåº¦ï¼Œç¼–è¯‘å™¨åœ¨å†…å­˜ä¸­å¸ƒå±€è¿™äº›å­—æ®µæ•°æ®æ—¶ï¼Œä¼šä¿è¯å®ƒä»¬çš„èµ·å§‹åœ°å€æ»¡è¶³è‡ªç„¶å¯¹é½çš„æ ‡å‡†ã€‚å› æ­¤ï¼Œç»“æ„ä¸­å­—æ®µçš„ä¸åŒå®šä¹‰é¡ºåºå°†ç›´æ¥å½±å“ç»“æ„å¯¹è±¡çš„å®é™…å†…å­˜å ç”¨å¤§å°ï¼Œè€Œè¿™ä¹Ÿæ˜¯æˆ‘ä»¬è¿›è¡Œç¨‹åºä¼˜åŒ–çš„ä¸€ä¸ªé‡è¦åˆ‡å…¥ç‚¹ã€‚</p><p><strong>è”åˆæ˜¯ä¸€ç§ç‰¹æ®Šçš„å¤åˆæ•°æ®ç±»å‹ï¼Œåœ¨å…¶å†…éƒ¨å®šä¹‰çš„æ‰€æœ‰æ•°æ®å­—æ®µå°†å ç”¨åŒä¸€å—å†…å­˜ç©ºé—´ã€‚</strong>è”åˆå¯¹è±¡çš„å®é™…å¤§å°ä¸å…¶å†…éƒ¨æ‰€å®šä¹‰æœ€å¤§å­—æ®µçš„å¤§å°ç›¸åŒã€‚é»˜è®¤æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬æ— æ³•ä»å¤–éƒ¨å¾—çŸ¥ä¸€ä¸ªè”åˆå¯¹è±¡ä¸­æ­£åœ¨â€œç”Ÿæ•ˆâ€çš„å­—æ®µç±»å‹ï¼Œå› æ­¤ Tagged Union çš„ä½¿ç”¨æ–¹å¼ä¾¿æˆä¸ºä¸»æµã€‚å°†ç”¨æ¥æ ‡è¯†ç”Ÿæ•ˆå­—æ®µçš„æšä¸¾ç±»å‹ä¸è”åˆè¿›è¡Œâ€œæ‰“åŒ…â€ï¼Œæˆ‘ä»¬å°±å¯ä»¥åœ¨ä½¿ç”¨è”åˆå¯¹è±¡å‰è¿›è¡Œç›¸åº”çš„åˆ¤æ–­å’Œå‡†å¤‡ï¼Œè€Œè¿™ä¹Ÿä¸ºåº”ç”¨ç¨‹åºçš„å¥å£®æ€§æ‰“ä¸‹äº†åŸºç¡€ã€‚</p><h2>æ€è€ƒé¢˜</h2><p>æœ€åï¼Œæˆ‘ä»¬ä¸€èµ·åšä¸ªæ€è€ƒé¢˜ã€‚</p><p>è¯•ç€ç”¨ä¸è¿™ä¸€è®²ä¸­ç±»ä¼¼çš„æ–¹å¼è¿›è¡Œåˆ†æï¼šä¸‹é¢è¿™ä¸ªç»“æ„ä½“åœ¨ç»è¿‡ <code>sizeof</code> è¿ç®—ç¬¦è®¡ç®—åï¼Œæ‰€å¾—åˆ°çš„å¤§å°æ˜¯å¤šå°‘ï¼Ÿ</p><pre><code class=\"language-c++\">struct {\n&nbsp; short a;\n&nbsp; char b;\n&nbsp; char c;\n&nbsp; int* d;\n&nbsp; union {\n&nbsp; &nbsp; double e;\n&nbsp; &nbsp; int f;\n&nbsp; };\n};\n</code></pre><p>ä»Šå¤©çš„è¯¾ç¨‹å°±ç»“æŸäº†ï¼Œå¸Œæœ›å¯ä»¥å¸®åŠ©åˆ°ä½ ï¼Œä¹Ÿå¸Œæœ›ä½ åœ¨ä¸‹æ–¹çš„ç•™è¨€åŒºå’Œæˆ‘ä¸€èµ·è®¨è®ºã€‚åŒæ—¶ï¼Œæ¬¢è¿ä½ æŠŠè¿™èŠ‚è¯¾åˆ†äº«ç»™ä½ çš„æœ‹å‹æˆ–åŒäº‹ï¼Œæˆ‘ä»¬ä¸€èµ·äº¤æµã€‚</p>","neighbors":{"left":{"article_title":"06ï½œä»£ç å°è£…ï¼ˆä¸‹ï¼‰ï¼šå‡½æ•°æ˜¯å¦‚ä½•è¢«è°ƒç”¨çš„ï¼Ÿ","id":469250},"right":{"article_title":"08ï½œæ“æ§èµ„æºï¼šæŒ‡é’ˆæ˜¯å¦‚ä½•çµæ´»ä½¿ç”¨å†…å­˜çš„ï¼Ÿ","id":471937}},"comments":[{"had_liked":false,"id":331868,"user_name":"zxk","can_delete":false,"product_type":"c1","uid":1221195,"ip_address":"","ucode":"4BB2BD9D2BCD04","user_header":"https://static001.geekbang.org/account/avatar/00/12/a2/4b/b72f724f.jpg","comment_is_top":false,"comment_ctime":1642840675,"is_pvip":false,"replies":[{"id":"122220","content":"å›ç­”æ­£ç¡®ï¼","user_name":"ä½œè€…å›å¤","user_name_real":"ç¼–è¾‘","uid":"1005890","ctime":1645019094,"ip_address":"","comment_id":331868,"utype":1}],"discussion_count":1,"race_medal":0,"score":"36002579043","product_id":100100701,"comment_content":"å…± 24 å­—èŠ‚ï¼š<br>1. short aã€char bã€char c å…± 2 + 1 + 1 = 4 bytesï¼›<br>2. padding = 4 bytesï¼›<br>3. int* d ä¸º 8 bytesï¼›<br>4. è”åˆå¤§å°å–å†³äºæœ€å¤§çš„ doubleï¼Œä¸º 8 byesï¼›<br>ç»¼ä¸Šï¼Œå…±ä¸º 2 + 1 + 1 + 4 + 8 + 8 = 24 bytesã€‚","like_count":8,"discussions":[{"author":{"id":1005890,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/59/42/e1757583.jpg","nickname":"Jason Yu äºèˆª","note":"","ucode":"0731492F4BC77D","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":551461,"discussion_content":"å›ç­”æ­£ç¡®ï¼","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1645019094,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":329551,"user_name":"=","can_delete":false,"product_type":"c1","uid":2600127,"ip_address":"","ucode":"104232A8292220","user_header":"https://static001.geekbang.org/account/avatar/00/27/ac/bf/f549183e.jpg","comment_is_top":false,"comment_ctime":1641397378,"is_pvip":false,"discussion_count":2,"race_medal":0,"score":"18821266562","product_id":100100701,"comment_content":"x86-64 gcc 11.2ç¼–è¯‘å™¨ä¸‹ï¼Œä¸º24bytesã€‚<br>shortç±»å‹çš„aå ç”¨2bytesï¼›<br>charç±»å‹çš„bå ç”¨1bytesï¼Œæ­¤æ—¶æ»¡è¶³è‡ªç„¶å¯¹é½ï¼›<br>charç±»å‹çš„cå ç”¨1bytesï¼Œæ­¤æ—¶æ»¡è¶³è‡ªç„¶å¯¹é½ï¼›<br>æŒ‡é’ˆç±»å‹çš„då ç”¨8bytesï¼Œæ­¤æ—¶ä¸æ»¡è¶³è‡ªç„¶å¯¹é½ï¼Œéœ€è¦å…ˆå¡«å……4bytesçš„paddingï¼Œç„¶åå†æ”¾ç½®8bytesçš„dï¼›<br>è”åˆçš„å¤§å°ä¸doubleç±»å‹ä¿æŒä¸€è‡´ï¼Œå› æ­¤æ˜¯8bytesï¼Œæ­¤æ—¶æ»¡è¶³è‡ªç„¶å¯¹é½ã€‚<br>ç»¼ä¸Šï¼Œæ€»å…±æ˜¯2+1+1++4+8+8=24bytes","like_count":5,"discussions":[{"author":{"id":1135912,"avatar":"https://static001.geekbang.org/account/avatar/00/11/55/28/31b0cf2f.jpg","nickname":"é»‘è‰²æ¯›è¡£","note":"","ucode":"FF7E235F91BA5C","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":572138,"discussion_content":" 4bytes çš„ padding æ˜¯ short + char + char çš„","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1652618067,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":1,"child_discussions":[{"author":{"id":1216016,"avatar":"https://static001.geekbang.org/account/avatar/00/12/8e/10/10092bb1.jpg","nickname":"Luke","note":"","ucode":"C34D4C44DBCE03","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":1135912,"avatar":"https://static001.geekbang.org/account/avatar/00/11/55/28/31b0cf2f.jpg","nickname":"é»‘è‰²æ¯›è¡£","note":"","ucode":"FF7E235F91BA5C","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":586321,"discussion_content":"ä»–ä¹Ÿæ˜¯è¿™ä¸ªæ„æ€","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1662105534,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":572138,"ip_address":"æ±Ÿè‹"},"score":586321,"extra":""}]}]},{"had_liked":false,"id":329124,"user_name":"Pushsadfc","can_delete":false,"product_type":"c1","uid":2866661,"ip_address":"","ucode":"219034B7AA6E6F","user_header":"https://static001.geekbang.org/account/avatar/00/2b/bd/e5/e671a9f1.jpg","comment_is_top":false,"comment_ctime":1641138690,"is_pvip":false,"replies":[{"id":"119915","content":"æœ‰ä¸€æœ¬å«ã€ŠC in a Nutshell: The Definitive Referenceã€‹çš„ä¹¦ï¼Œä¸çŸ¥é“ç¬¦ä¸ç¬¦åˆä½ çš„éœ€æ±‚ã€‚","user_name":"ä½œè€…å›å¤","user_name_real":"ç¼–è¾‘","uid":"1005890","ctime":1641273325,"ip_address":"","comment_id":329124,"utype":1}],"discussion_count":1,"race_medal":0,"score":"10231073282","product_id":100100701,"comment_content":"è€å¸ˆï¼Œé‚£ä¸ªå…³äºcè¯­è¨€å¦‚ä½•æ„å»ºé¡¹ç›®æˆ–è€…ç¼–ç¨‹è§„èŒƒçš„ä¹¦æœ‰æ¨èçš„å’©","like_count":2,"discussions":[{"author":{"id":1005890,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/59/42/e1757583.jpg","nickname":"Jason Yu äºèˆª","note":"","ucode":"0731492F4BC77D","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":543691,"discussion_content":"æœ‰ä¸€æœ¬å«ã€ŠC in a Nutshell: The Definitive Referenceã€‹çš„ä¹¦ï¼Œä¸çŸ¥é“ç¬¦ä¸ç¬¦åˆä½ çš„éœ€æ±‚ã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1641273325,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":327456,"user_name":"liu_liu","can_delete":false,"product_type":"c1","uid":1019138,"ip_address":"","ucode":"24283806A07759","user_header":"https://static001.geekbang.org/account/avatar/00/0f/8d/02/6a16058a.jpg","comment_is_top":false,"comment_ctime":1640139101,"is_pvip":false,"replies":[{"id":"119226","content":"å¾ˆå¥½çš„é—®é¢˜ï¼ä¸‹é¢æ˜¯å›ç­”ï¼š<br><br>1. è¿™é‡Œçš„ â€œ.LC0[rip]â€ å®é™…ä¸Šæ˜¯æ±‡ç¼–ä»£ç ä¸­çš„ä¸€ç§é€šè¿‡ rip å¯„å­˜å™¨æ¥è¿›è¡Œç›¸å¯¹å¯»å€çš„æ–¹å¼ï¼Œä¸€èˆ¬ä¹Ÿç§°ä¸º pc-relative æˆ– rip-relativeã€‚rip å¯„å­˜å™¨ä¸­å­˜æ”¾ç€ä¸‹ä¸€æ¡å°†è¦æ‰§è¡Œçš„æŒ‡ä»¤ã€‚è€Œè¿™é‡Œè¯¥æ¡æŒ‡ä»¤çš„å¯»å€ç»“æœä¾¿æ˜¯ .LC0 è¿™ä¸ª label çš„å¼€å¤´ã€‚<br>2. .long æ˜¯ä¸€ä¸ªæ±‡ç¼–æŒ‡ç¤ºæ ‡è®°ï¼Œç”¨äºè®©æ±‡ç¼–å™¨åœ¨å½“å‰è¿™ä¸ªä½ç½®ä¿ç•™ä¸€ä¸ª 4 å­—èŠ‚çš„å€¼ã€‚è¿™é‡Œç¬¬ä¸€ä¸ª .long 0 æ˜¯ 1.25 å¯¹åº”äºŒè¿›åˆ¶è¡¨ç¤ºçš„ä½ 32 ä½ï¼›ç¬¬äºŒä¸ª .long 1072955392 åˆ™æ˜¯å¯¹åº”é«˜ 32 ä½çš„åè¿›åˆ¶å€¼ã€‚","user_name":"ä½œè€…å›å¤","user_name_real":"ç¼–è¾‘","uid":"1005890","ctime":1640190085,"ip_address":"","comment_id":327456,"utype":1}],"discussion_count":3,"race_medal":0,"score":"10230073693","product_id":100100701,"comment_content":"a - 2 å­—èŠ‚<br>b - 1<br>c - 1<br>padding - 4<br>d - 8<br>union - 8<br><br>å…± 24 å­—èŠ‚ã€‚<br><br>-------<br><br>ä½†è€å¸ˆï¼Œæˆ‘æœ‰äº›åœ°æ–¹ä¸å¤ªæ˜ç™½ã€‚<br><br>å½“ç»™æ€è€ƒé¢˜ä¸­çš„ç»“æ„ä½“èµ‹å€¼ï¼ˆæˆ‘ç»™å®ƒèµ·åå« Userï¼‰ï¼Œå¹¶ä¸” union èµ‹å€¼ä¸ºæµ®ç‚¹æ•° 1.25ï¼Œå¦‚ä¸‹ï¼š<br><br>int main() {<br>    struct User u = {1, &#39;a&#39;, &#39;b&#39;, 0x10000, .e = 1.25};<br>    return 0;<br>}<br><br>æ±‡ç¼–ä»£ç å¦‚ä¸‹ï¼š<br><br>------<br><br>main:<br>        push    rbp<br>        mov     rbp, rsp<br>        mov     WORD PTR [rbp-32], 1<br>        mov     BYTE PTR [rbp-30], 97<br>        mov     BYTE PTR [rbp-29], 98<br>        mov     QWORD PTR [rbp-24], 65536<br>        movsd   xmm0, QWORD PTR .LC0[rip]<br>        movsd   QWORD PTR [rbp-16], xmm0<br>        mov     eax, 0<br>        pop     rbp<br>        ret<br>.LC0:<br>        .long   0<br>        .long   1072955392<br><br> --------<br><br> .LC0 è¿™æ®µåº”è¯¥æ˜¯æµ®ç‚¹æ•° 1.25 çš„å€¼ã€‚<br><br> movsd  xmm0, QWORD PTR .LC0[rip]ï¼Œæˆ‘çŒœå®ƒçš„å«ä¹‰æ˜¯æŠŠ 1.25 çš„å€¼æ”¾å…¥ xmm0 å¯„å­˜å™¨ä¸­ã€‚<br><br><br> 1. é‚£ .LC0[rip] çš„æ„æ€æ˜¯ä»€ä¹ˆå‘¢ï¼Ÿä¸ºä»€ä¹ˆè¦æŠŠ rip ä¼ å…¥å‘¢ï¼Ÿ<br> 2. ä¸ºä»€ä¹ˆ .LCO ä¸­ä½¿ç”¨ä¸¤ä¸ª .long æ¥è¡¨ç¤ºå‘¢ï¼Ÿè¿™é‡Œçš„å…·ä½“å«ä¹‰æ˜¯ä»€ä¹ˆå‘¢ï¼Ÿ<br><br>æœ›è€å¸ˆè§£ç­”~<br>","like_count":2,"discussions":[{"author":{"id":1005890,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/59/42/e1757583.jpg","nickname":"Jason Yu äºèˆª","note":"","ucode":"0731492F4BC77D","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":540904,"discussion_content":"å¾ˆå¥½çš„é—®é¢˜ï¼ä¸‹é¢æ˜¯å›ç­”ï¼š\n\n1. è¿™é‡Œçš„ â€œ.LC0[rip]â€ å®é™…ä¸Šæ˜¯æ±‡ç¼–ä»£ç ä¸­çš„ä¸€ç§é€šè¿‡ rip å¯„å­˜å™¨æ¥è¿›è¡Œç›¸å¯¹å¯»å€çš„æ–¹å¼ï¼Œä¸€èˆ¬ä¹Ÿç§°ä¸º pc-relative æˆ– rip-relativeã€‚rip å¯„å­˜å™¨ä¸­å­˜æ”¾ç€ä¸‹ä¸€æ¡å°†è¦æ‰§è¡Œçš„æŒ‡ä»¤ã€‚è€Œè¿™é‡Œè¯¥æ¡æŒ‡ä»¤çš„å¯»å€ç»“æœä¾¿æ˜¯ .LC0 è¿™ä¸ª label çš„å¼€å¤´ã€‚\n2. .long æ˜¯ä¸€ä¸ªæ±‡ç¼–æŒ‡ç¤ºæ ‡è®°ï¼Œç”¨äºè®©æ±‡ç¼–å™¨åœ¨å½“å‰è¿™ä¸ªä½ç½®ä¿ç•™ä¸€ä¸ª 4 å­—èŠ‚çš„å€¼ã€‚è¿™é‡Œç¬¬ä¸€ä¸ª .long 0 æ˜¯ 1.25 å¯¹åº”äºŒè¿›åˆ¶è¡¨ç¤ºçš„ä½ 32 ä½ï¼›ç¬¬äºŒä¸ª .long 1072955392 åˆ™æ˜¯å¯¹åº”é«˜ 32 ä½çš„åè¿›åˆ¶å€¼ã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1640190086,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":2,"child_discussions":[{"author":{"id":1019138,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/8d/02/6a16058a.jpg","nickname":"liu_liu","note":"","ucode":"24283806A07759","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":1005890,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/59/42/e1757583.jpg","nickname":"Jason Yu äºèˆª","note":"","ucode":"0731492F4BC77D","race_medal":0,"user_type":2,"is_pvip":false},"discussion":{"id":540944,"discussion_content":"é‚£ä¸ºä»€ä¹ˆæµ®ç‚¹æ•°è¡¨ç¤ºç”¨ .LCO æ ‡ç­¾çš„æ–¹å¼ï¼Œä¸ç›´æ¥ç”¨ç«‹å³æ•°å‘¢ï¼Ÿæ˜¯ä¸€ç§çº¦å®šå—ï¼Ÿ\n\næ¯”å¦‚è¿™æ ·ï¼š\n\nmovsd xmm0, 73827328782378","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1640220743,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":540904,"ip_address":""},"score":540944,"extra":""},{"author":{"id":1216016,"avatar":"https://static001.geekbang.org/account/avatar/00/12/8e/10/10092bb1.jpg","nickname":"Luke","note":"","ucode":"C34D4C44DBCE03","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":1019138,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/8d/02/6a16058a.jpg","nickname":"liu_liu","note":"","ucode":"24283806A07759","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":586324,"discussion_content":"å› ä¸ºè¿™æ˜¯simdæŒ‡ä»¤ï¼Œå•æŒ‡ä»¤å¤šæ•°æ®é›†ç±»å‹ï¼Œä»–æ˜¯ç»“åˆfpuè¿ç®—çš„ï¼Œä¼ é€’çš„æ˜¯å‘é‡å’Œæ•°æ®é›†åˆã€‚å›¾å½¢è¿ç®—è¿™å—æˆ‘äº†è§£çš„ä¹Ÿä¸å¤šã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1662106254,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":540944,"ip_address":"æ±Ÿè‹"},"score":586324,"extra":""}]}]},{"had_liked":false,"id":329528,"user_name":"ç–¯ç ","can_delete":false,"product_type":"c1","uid":1228313,"ip_address":"","ucode":"7FF11EC80439EA","user_header":"http://thirdwx.qlogo.cn/mmopen/vi_32/vQiadbkZYR239J80hjekw7jzY9vy6otLKPNDSuz2lruDiaXlKGkcsX5wwiaFevicgqV8odlRG4UITiadDF3fgicrHPcw/132","comment_is_top":false,"comment_ctime":1641388732,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"5936356028","product_id":100100701,"comment_content":"æ€»ç®—æ˜ç™½å¯¹é½è§„åˆ™æ€ä¹ˆæ¥çš„äº†ï¼Œæ„Ÿè°¢","like_count":1},{"had_liked":false,"id":327496,"user_name":"sky","can_delete":false,"product_type":"c1","uid":1207056,"ip_address":"","ucode":"5CEF9A1806298D","user_header":"https://static001.geekbang.org/account/avatar/00/12/6b/10/22f93764.jpg","comment_is_top":false,"comment_ctime":1640150362,"is_pvip":false,"replies":[{"id":"119222","content":"æ­£ç¡®ï¼","user_name":"ä½œè€…å›å¤","user_name_real":"ç¼–è¾‘","uid":"1005890","ctime":1640188170,"ip_address":"","comment_id":327496,"utype":1}],"discussion_count":1,"race_medal":0,"score":"5935117658","product_id":100100701,"comment_content":"é—®ç­”é¢˜ï¼ŒX86_64æ¶æ„ä¸‹ï¼Œ24å­—èŠ‚ã€‚ç»¼åˆè€ƒè™‘ä¸¤ä¸ªç‚¹ï¼š<br>1.ç»“æ„ä½“ å†…éƒ¨æˆå‘˜ è‡ªç„¶å¯¹é½ï¼›<br>2.ç»“æ„ä½“æ•°ç»„çš„å†…å­˜å¯¹é½ã€‚","like_count":1,"discussions":[{"author":{"id":1005890,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/59/42/e1757583.jpg","nickname":"Jason Yu äºèˆª","note":"","ucode":"0731492F4BC77D","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":540893,"discussion_content":"æ­£ç¡®ï¼","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1640188171,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":327442,"user_name":"pedro","can_delete":false,"product_type":"c1","uid":1200704,"ip_address":"","ucode":"F40C839DDFD599","user_header":"https://static001.geekbang.org/account/avatar/00/12/52/40/e57a736e.jpg","comment_is_top":false,"comment_ctime":1640136949,"is_pvip":false,"replies":[{"id":"119224","content":"æ²¡é”™ï¼","user_name":"ä½œè€…å›å¤","user_name_real":"ç¼–è¾‘","uid":"1005890","ctime":1640188265,"ip_address":"","comment_id":327442,"utype":1}],"discussion_count":1,"race_medal":0,"score":"5935104245","product_id":100100701,"comment_content":"x86_64 çš„å¹³å°ä¸‹ï¼Œsizeof å¾—åˆ°çš„å¤§å°ä¸ºï¼š24 = 8 + 8 + 8ï¼Œ<br>åŠ ä¸Š packed å±æ€§åï¼Œsizeof ä¸º 20 = (1 + 1 + 2) + 8 + 8ã€‚","like_count":1,"discussions":[{"author":{"id":1005890,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/59/42/e1757583.jpg","nickname":"Jason Yu äºèˆª","note":"","ucode":"0731492F4BC77D","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":540895,"discussion_content":"æ²¡é”™ï¼","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1640188265,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":359733,"user_name":"å¤•æ—è¯­","can_delete":false,"product_type":"c1","uid":1264180,"ip_address":"æ±Ÿè¥¿","ucode":"B57681D0C73E1B","user_header":"https://static001.geekbang.org/account/avatar/00/13/4a/34/1faac99b.jpg","comment_is_top":false,"comment_ctime":1665822981,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1665822981","product_id":100100701,"comment_content":"2+1+1+4(padding)+8+8=24","like_count":0},{"had_liked":false,"id":356294,"user_name":"Luke","can_delete":false,"product_type":"c1","uid":1216016,"ip_address":"æ±Ÿè‹","ucode":"C34D4C44DBCE03","user_header":"https://static001.geekbang.org/account/avatar/00/12/8e/10/10092bb1.jpg","comment_is_top":false,"comment_ctime":1662112531,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1662112531","product_id":100100701,"comment_content":"æˆ‘è®°å¾—ä»¥å‰æœ‰æœ¬ä¹¦é‡Œå†™çš„ç»“æ„ä½“å†…å­˜å¯¹é½çš„ç›’å­æ¨¡å‹ã€‚<br>ä¸¤ç‚¹ï¼šç»“æ„ä½“å†…éƒ¨æˆå‘˜çš„è‡ªç„¶å¯¹é½ï¼Œç»“æ„ä½“æ•°ç»„ä¸­ç»“æ„ä½“è‡ªèº«çš„è‡ªç„¶å¯¹é½ã€‚<br><br>å› ä¸ºç»“æ„ä½“éœ€è¦å†…éƒ¨è‡ªç„¶å¯¹é½ï¼Œå› æ­¤å†…éƒ¨æœ€å¤§çš„æˆå‘˜çš„èµ·å§‹åœ°å€å¿…é¡»æ˜¯è¯¥æˆå‘˜å¤§å°çš„æ•´æ•°å€ï¼Œåˆå› ä¸ºç»“æ„ä½“è‡ªèº«éœ€è¦è‡ªç„¶å¯¹é½ï¼Œæ‰€ä»¥æœ€ç»ˆçš„å†…å­˜å ç”¨å¤§å°ä¹Ÿæ˜¯æœ€å¤§æˆå‘˜å¤§å°çš„æ•´æ•°å€ã€‚<br><br>æ‰€ä»¥ï¼Œåˆç†çš„ç»“æ„ä½“è®¾è®¡åº”è¯¥æŒ‰ç…§æˆå‘˜å†…å­˜å¤§å°ä»å°åˆ°å¤§æ’ç»ƒï¼Œè¿™æ ·paddingæ˜¯æœ€å°çš„ã€‚å¦‚æœæœ€å¤§çš„æˆå‘˜ä¹‹åè¿˜æœ‰å°çš„æˆå‘˜ï¼Œé‚£ä¹ˆå¯èƒ½ç»“æ„ä½“å†…éƒ¨ä¼šæœ‰ä¸¤å¤„paddingç©ºé—´ã€‚<br><br>è€å¸ˆï¼Œæˆ‘æƒ³é—®ä¸‹#pragma pack(1)æ˜¯ä¸æ˜¯ä¼šå¼ºåˆ¶æŒ‰ç…§1ä¸ªå­—èŠ‚æ¥æ’åˆ—ç»“æ„ä½“çš„å†…å­˜æ¨¡å‹ï¼Œè¿™æ ·ä¿è¯æ²¡æœ‰paddingï¼Œä½†æ˜¯å‡ºäºæ•ˆç‡è€ƒè™‘ï¼Œéœ€è¦å¼€å‘äººå‘˜è‡ªè¡Œç¡®ä¿å­—èŠ‚å¯¹é½ï¼Œæ¯”å¦‚å¯ä»¥åŠ ä¸Šå›ºå®šå¤§å°ä½œä¸ºé¢„ç•™ç©ºé—´ã€‚","like_count":0},{"had_liked":false,"id":353488,"user_name":"may_huang","can_delete":false,"product_type":"c1","uid":1451623,"ip_address":"åŒ—äº¬","ucode":"EAF989F18FC109","user_header":"https://static001.geekbang.org/account/avatar/00/16/26/67/c3d90f46.jpg","comment_is_top":false,"comment_ctime":1659497081,"is_pvip":true,"discussion_count":1,"race_medal":0,"score":"1659497081","product_id":100100701,"comment_content":"è€å¸ˆæœ‰æ¯”è¾ƒå¥½çš„è®²æ±‡ç¼–çš„ä¹¦æ¨èå—ï¼Ÿä»£ç ä¸­æœ‰äº›æ±‡ç¼–ä»£ç ä¸æ˜¯å¾ˆæ‡‚ã€‚","like_count":0,"discussions":[{"author":{"id":1475273,"avatar":"","nickname":"æé’¦æ”¿","note":"","ucode":"F9B29A03557B88","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":590146,"discussion_content":"æ¸…åå¤§å­¦ ç‹çˆ½","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1665556736,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":"æ±Ÿè‹"},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":348678,"user_name":"å¥½åƒä¸è´µ","can_delete":false,"product_type":"c1","uid":1316993,"ip_address":"","ucode":"6576E2BECE4F7C","user_header":"https://static001.geekbang.org/account/avatar/00/14/18/81/83b6ade2.jpg","comment_is_top":false,"comment_ctime":1655298457,"is_pvip":true,"replies":[{"id":"127245","content":"ğŸ‘ğŸ»","user_name":"ä½œè€…å›å¤","user_name_real":"ç¼–è¾‘","uid":"1005890","ctime":1656223634,"ip_address":"","comment_id":348678,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1655298457","product_id":100100701,"comment_content":"å¯ä»¥ç”¨gdbçš„ptypeæ¥æŸ¥çœ‹å„å­—æ®µçš„å¤§å°ã€‚<br>ptype &#47;o a<br>&#47;* offset    |  size *&#47;  type = struct {<br>&#47;*    0      |     2 *&#47;    short a;<br>&#47;*    2      |     1 *&#47;    char b;<br>&#47;*    3      |     1 *&#47;    char c;<br>&#47;* XXX  4-byte hole  *&#47;<br>&#47;*    8      |     8 *&#47;    int *d;<br>&#47;*   16      |     8 *&#47;    union {<br>&#47;*                 8 *&#47;        double e;<br>&#47;*                 4 *&#47;        int f;<br><br>                               &#47;* total size (bytes):    8 *&#47;<br>                           };<br><br>                           &#47;* total size (bytes):   24 *&#47;<br>                         }","like_count":0,"discussions":[{"author":{"id":1005890,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/59/42/e1757583.jpg","nickname":"Jason Yu äºèˆª","note":"","ucode":"0731492F4BC77D","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":577597,"discussion_content":"ğŸ‘ğŸ»","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1656223634,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":327572,"user_name":"Lijie","can_delete":false,"product_type":"c1","uid":2639207,"ip_address":"","ucode":"F2576438129567","user_header":"https://static001.geekbang.org/account/avatar/00/28/45/67/62ba1136.jpg","comment_is_top":false,"comment_ctime":1640175836,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1640175836","product_id":100100701,"comment_content":"24","like_count":0},{"had_liked":false,"id":327416,"user_name":"å¼ è´º","can_delete":false,"product_type":"c1","uid":1283181,"ip_address":"","ucode":"0254E40FB3EB5F","user_header":"https://static001.geekbang.org/account/avatar/00/13/94/6d/5cd6e8c7.jpg","comment_is_top":false,"comment_ctime":1640128917,"is_pvip":true,"replies":[{"id":"119223","content":"ä¸å¯¹å“¦ï¼Œå†çœ‹çœ‹ï¼Ÿ","user_name":"ä½œè€…å›å¤","user_name_real":"ç¼–è¾‘","uid":"1005890","ctime":1640188181,"ip_address":"","comment_id":327416,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1640128917","product_id":100100701,"comment_content":"40ä¸ªå­—èŠ‚","like_count":0,"discussions":[{"author":{"id":1005890,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/59/42/e1757583.jpg","nickname":"Jason Yu äºèˆª","note":"","ucode":"0731492F4BC77D","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":540894,"discussion_content":"ä¸å¯¹å“¦ï¼Œå†çœ‹çœ‹ï¼Ÿ","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1640188181,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]}]}