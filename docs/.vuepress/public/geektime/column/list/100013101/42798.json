{"id":42798,"title":"34 | å¹¶å‘å®‰å…¨å­—å…¸sync.Map ï¼ˆä¸Šï¼‰","content":"<p>åœ¨å‰é¢ï¼Œæˆ‘å‡ ä¹å·²ç»æŠŠGoè¯­è¨€è‡ªå¸¦çš„åŒæ­¥å·¥å…·å…¨ç›˜æ‰˜å‡ºäº†ã€‚ä½ æ˜¯å¦å·²ç»å¬æ‡‚äº†ä¼šç”¨äº†å‘¢ï¼Ÿ</p><p>æ— è®ºæ€æ ·ï¼Œæˆ‘éƒ½å¸Œæœ›ä½ èƒ½å¤Ÿå¤šå¤šç»ƒä¹ ã€å¤šå¤šä½¿ç”¨ã€‚å®ƒä»¬å’ŒGoè¯­è¨€ç‹¬æœ‰çš„å¹¶å‘ç¼–ç¨‹æ–¹å¼å¹¶ä¸å†²çªï¼Œç›¸åï¼Œé…åˆèµ·æ¥ä½¿ç”¨ï¼Œç»å¯¹èƒ½è¾¾åˆ°â€œä¸€åŠ ä¸€å¤§äºäºŒâ€çš„æ•ˆæœã€‚</p><p>å½“ç„¶äº†ï¼Œè‡³äºæ€æ ·é…åˆå°±æ˜¯ä¸€é—¨å­¦é—®äº†ã€‚æˆ‘åœ¨å‰é¢å·²ç»è®²äº†ä¸å°‘çš„æ–¹æ³•å’ŒæŠ€å·§ï¼Œä¸è¿‡ï¼Œæ›´å¤šçš„ä¸œè¥¿å¯èƒ½å°±éœ€è¦ä½ åœ¨å®è·µä¸­é€æ¸é¢†æ‚Ÿå’Œæ€»ç»“äº†ã€‚</p><hr></hr><p>æˆ‘ä»¬ä»Šå¤©å†æ¥è®²ä¸€ä¸ªå¹¶å‘å®‰å…¨çš„é«˜çº§æ•°æ®ç»“æ„ï¼š<code>sync.Map</code>ã€‚ä¼—æ‰€å‘¨çŸ¥ï¼ŒGoè¯­è¨€è‡ªå¸¦çš„å­—å…¸ç±»å‹<code>map</code>å¹¶ä¸æ˜¯å¹¶å‘å®‰å…¨çš„ã€‚</p><h2>å‰å¯¼çŸ¥è¯†ï¼šå¹¶å‘å®‰å…¨å­—å…¸è¯ç”Ÿå²</h2><p>æ¢å¥è¯è¯´ï¼Œåœ¨åŒä¸€æ—¶é—´æ®µå†…ï¼Œè®©ä¸åŒgoroutineä¸­çš„ä»£ç ï¼Œå¯¹åŒä¸€ä¸ªå­—å…¸è¿›è¡Œè¯»å†™æ“ä½œæ˜¯ä¸å®‰å…¨çš„ã€‚å­—å…¸å€¼æœ¬èº«å¯èƒ½ä¼šå› è¿™äº›æ“ä½œè€Œäº§ç”Ÿæ··ä¹±ï¼Œç›¸å…³çš„ç¨‹åºä¹Ÿå¯èƒ½ä¼šå› æ­¤å‘ç”Ÿä¸å¯é¢„çŸ¥çš„é—®é¢˜ã€‚</p><p>åœ¨<code>sync.Map</code>å‡ºç°ä¹‹å‰ï¼Œæˆ‘ä»¬å¦‚æœè¦å®ç°å¹¶å‘å®‰å…¨çš„å­—å…¸ï¼Œå°±åªèƒ½è‡ªè¡Œæ„å»ºã€‚ä¸è¿‡ï¼Œè¿™å…¶å®ä¹Ÿä¸æ˜¯ä»€ä¹ˆéº»çƒ¦äº‹ï¼Œä½¿ç”¨ <code>sync.Mutex</code>æˆ–<code>sync.RWMutex</code>ï¼Œå†åŠ ä¸ŠåŸç”Ÿçš„<code>map</code>å°±å¯ä»¥è½»æ¾åœ°åšåˆ°ã€‚</p><p>GitHubç½‘ç«™ä¸Šå·²ç»æœ‰å¾ˆå¤šåº“æä¾›äº†ç±»ä¼¼çš„æ•°æ®ç»“æ„ã€‚æˆ‘åœ¨ã€ŠGoå¹¶å‘ç¼–ç¨‹å®æˆ˜ã€‹çš„ç¬¬2ç‰ˆä¸­ä¹Ÿæä¾›äº†ä¸€ä¸ªæ¯”è¾ƒå®Œæ•´çš„å¹¶å‘å®‰å…¨å­—å…¸çš„å®ç°ã€‚å®ƒçš„æ€§èƒ½æ¯”åŒç±»çš„æ•°æ®ç»“æ„è¿˜è¦å¥½ä¸€äº›ï¼Œå› ä¸ºå®ƒåœ¨å¾ˆå¤§ç¨‹åº¦ä¸Šæœ‰æ•ˆåœ°é¿å…äº†å¯¹é”çš„ä¾èµ–ã€‚</p><!-- [[[read_end]]] --><p>å°½ç®¡å·²ç»æœ‰äº†ä¸å°‘çš„å‚è€ƒå®ç°ï¼ŒGoè¯­è¨€çˆ±å¥½è€…ä»¬è¿˜æ˜¯å¸Œæœ›Goè¯­è¨€å®˜æ–¹èƒ½å¤Ÿå‘å¸ƒä¸€ä¸ªæ ‡å‡†çš„å¹¶å‘å®‰å…¨å­—å…¸ã€‚</p><p>ç»è¿‡å¤§å®¶å¤šå¹´çš„å»ºè®®å’Œåæ§½ï¼ŒGoè¯­è¨€å®˜æ–¹ç»ˆäºåœ¨2017å¹´å‘å¸ƒçš„Go 1.9ä¸­ï¼Œæ­£å¼åŠ å…¥äº†å¹¶å‘å®‰å…¨çš„å­—å…¸ç±»å‹<code>sync.Map</code>ã€‚</p><p>è¿™ä¸ªå­—å…¸ç±»å‹æä¾›äº†ä¸€äº›å¸¸ç”¨çš„é”®å€¼å­˜å–æ“ä½œæ–¹æ³•ï¼Œå¹¶ä¿è¯äº†è¿™äº›æ“ä½œçš„å¹¶å‘å®‰å…¨ã€‚åŒæ—¶ï¼Œå®ƒçš„å­˜ã€å–ã€åˆ ç­‰æ“ä½œéƒ½å¯ä»¥åŸºæœ¬ä¿è¯åœ¨å¸¸æ•°æ—¶é—´å†…æ‰§è¡Œå®Œæ¯•ã€‚æ¢å¥è¯è¯´ï¼Œå®ƒä»¬çš„ç®—æ³•å¤æ‚åº¦ä¸<code>map</code>ç±»å‹ä¸€æ ·éƒ½æ˜¯<code>O(1)</code>çš„ã€‚</p><p>åœ¨æœ‰äº›æ—¶å€™ï¼Œä¸å•çº¯ä½¿ç”¨åŸç”Ÿ<code>map</code>å’Œäº’æ–¥é”çš„æ–¹æ¡ˆç›¸æ¯”ï¼Œä½¿ç”¨<code>sync.Map</code>å¯ä»¥æ˜¾è‘—åœ°å‡å°‘é”çš„äº‰ç”¨ã€‚<code>sync.Map</code>æœ¬èº«è™½ç„¶ä¹Ÿç”¨åˆ°äº†é”ï¼Œä½†æ˜¯ï¼Œå®ƒå…¶å®åœ¨å°½å¯èƒ½åœ°é¿å…ä½¿ç”¨é”ã€‚</p><p>æˆ‘ä»¬éƒ½çŸ¥é“ï¼Œä½¿ç”¨é”å°±æ„å‘³ç€è¦æŠŠä¸€äº›å¹¶å‘çš„æ“ä½œå¼ºåˆ¶ä¸²è¡ŒåŒ–ã€‚è¿™å¾€å¾€ä¼šé™ä½ç¨‹åºçš„æ€§èƒ½ï¼Œå°¤å…¶æ˜¯åœ¨è®¡ç®—æœºæ‹¥æœ‰å¤šä¸ªCPUæ ¸å¿ƒçš„æƒ…å†µä¸‹ã€‚</p><p>å› æ­¤ï¼Œæˆ‘ä»¬å¸¸è¯´ï¼Œèƒ½ç”¨åŸå­æ“ä½œå°±ä¸è¦ç”¨é”ï¼Œä¸è¿‡è¿™å¾ˆæœ‰å±€é™æ€§ï¼Œæ¯•ç«ŸåŸå­åªèƒ½å¯¹ä¸€äº›åŸºæœ¬çš„æ•°æ®ç±»å‹æä¾›æ”¯æŒã€‚</p><p>æ— è®ºåœ¨ä½•ç§åœºæ™¯ä¸‹ä½¿ç”¨<code>sync.Map</code>ï¼Œæˆ‘ä»¬éƒ½éœ€è¦æ³¨æ„ï¼Œä¸åŸç”Ÿ<code>map</code>æ˜æ˜¾ä¸åŒï¼Œå®ƒåªæ˜¯Goè¯­è¨€æ ‡å‡†åº“ä¸­çš„ä¸€å‘˜ï¼Œè€Œä¸æ˜¯è¯­è¨€å±‚é¢çš„ä¸œè¥¿ã€‚ä¹Ÿæ­£å› ä¸ºè¿™ä¸€ç‚¹ï¼ŒGoè¯­è¨€çš„ç¼–è¯‘å™¨å¹¶ä¸ä¼šå¯¹å®ƒçš„é”®å’Œå€¼ï¼Œè¿›è¡Œç‰¹æ®Šçš„ç±»å‹æ£€æŸ¥ã€‚</p><p>å¦‚æœä½ çœ‹è¿‡<code>sync.Map</code>çš„æ–‡æ¡£æˆ–è€…å®é™…ä½¿ç”¨è¿‡å®ƒï¼Œé‚£ä¹ˆå°±ä¸€å®šä¼šçŸ¥é“ï¼Œå®ƒæ‰€æœ‰çš„æ–¹æ³•æ¶‰åŠçš„é”®å’Œå€¼çš„ç±»å‹éƒ½æ˜¯<code>interface{}</code>ï¼Œä¹Ÿå°±æ˜¯ç©ºæ¥å£ï¼Œè¿™æ„å‘³ç€å¯ä»¥åŒ…ç½—ä¸‡è±¡ã€‚æ‰€ä»¥ï¼Œæˆ‘ä»¬å¿…é¡»åœ¨ç¨‹åºä¸­è‡ªè¡Œä¿è¯å®ƒçš„é”®ç±»å‹å’Œå€¼ç±»å‹çš„æ­£ç¡®æ€§ã€‚</p><p>å¥½äº†ï¼Œç°åœ¨ç¬¬ä¸€ä¸ªé—®é¢˜æ¥äº†ã€‚<strong>ä»Šå¤©çš„é—®é¢˜æ˜¯ï¼šå¹¶å‘å®‰å…¨å­—å…¸å¯¹é”®çš„ç±»å‹æœ‰è¦æ±‚å—ï¼Ÿ</strong></p><p>è¿™é“é¢˜çš„å…¸å‹å›ç­”æ˜¯ï¼šæœ‰è¦æ±‚ã€‚é”®çš„å®é™…ç±»å‹ä¸èƒ½æ˜¯å‡½æ•°ç±»å‹ã€å­—å…¸ç±»å‹å’Œåˆ‡ç‰‡ç±»å‹ã€‚</p><p><strong>è§£æä¸€ä¸‹è¿™ä¸ªé—®é¢˜ã€‚</strong> æˆ‘ä»¬éƒ½çŸ¥é“ï¼ŒGoè¯­è¨€çš„åŸç”Ÿå­—å…¸çš„é”®ç±»å‹ä¸èƒ½æ˜¯å‡½æ•°ç±»å‹ã€å­—å…¸ç±»å‹å’Œåˆ‡ç‰‡ç±»å‹ã€‚</p><p>ç”±äºå¹¶å‘å®‰å…¨å­—å…¸å†…éƒ¨ä½¿ç”¨çš„å­˜å‚¨ä»‹è´¨æ­£æ˜¯åŸç”Ÿå­—å…¸ï¼Œåˆå› ä¸ºå®ƒä½¿ç”¨çš„åŸç”Ÿå­—å…¸é”®ç±»å‹ä¹Ÿæ˜¯å¯ä»¥åŒ…ç½—ä¸‡è±¡çš„<code>interface{}</code>ï¼›æ‰€ä»¥ï¼Œæˆ‘ä»¬ç»å¯¹ä¸èƒ½å¸¦ç€ä»»ä½•å®é™…ç±»å‹ä¸ºå‡½æ•°ç±»å‹ã€å­—å…¸ç±»å‹æˆ–åˆ‡ç‰‡ç±»å‹çš„é”®å€¼å»æ“ä½œå¹¶å‘å®‰å…¨å­—å…¸ã€‚</p><p>ç”±äºè¿™äº›é”®å€¼çš„å®é™…ç±»å‹åªæœ‰åœ¨ç¨‹åºè¿è¡ŒæœŸé—´æ‰èƒ½å¤Ÿç¡®å®šï¼Œæ‰€ä»¥Goè¯­è¨€ç¼–è¯‘å™¨æ˜¯æ— æ³•åœ¨ç¼–è¯‘æœŸå¯¹å®ƒä»¬è¿›è¡Œæ£€æŸ¥çš„ï¼Œä¸æ­£ç¡®çš„é”®å€¼å®é™…ç±»å‹è‚¯å®šä¼šå¼•å‘panicã€‚</p><p>å› æ­¤ï¼Œæˆ‘ä»¬åœ¨è¿™é‡Œé¦–å…ˆè¦åšçš„ä¸€ä»¶äº‹å°±æ˜¯ï¼šä¸€å®šä¸è¦è¿åä¸Šè¿°è§„åˆ™ã€‚æˆ‘ä»¬åº”è¯¥åœ¨æ¯æ¬¡æ“ä½œå¹¶å‘å®‰å…¨å­—å…¸çš„æ—¶å€™ï¼Œéƒ½å»æ˜¾å¼åœ°æ£€æŸ¥é”®å€¼çš„å®é™…ç±»å‹ã€‚æ— è®ºæ˜¯å­˜ã€å–è¿˜æ˜¯åˆ ï¼Œéƒ½åº”è¯¥å¦‚æ­¤ã€‚</p><p>å½“ç„¶ï¼Œæ›´å¥½çš„åšæ³•æ˜¯ï¼ŒæŠŠé’ˆå¯¹åŒä¸€ä¸ªå¹¶å‘å®‰å…¨å­—å…¸çš„è¿™å‡ ç§æ“ä½œéƒ½é›†ä¸­èµ·æ¥ï¼Œç„¶åç»Ÿä¸€åœ°ç¼–å†™æ£€æŸ¥ä»£ç ã€‚é™¤æ­¤ä¹‹å¤–ï¼ŒæŠŠå¹¶å‘å®‰å…¨å­—å…¸å°è£…åœ¨ä¸€ä¸ªç»“æ„ä½“ç±»å‹ä¸­ï¼Œå¾€å¾€æ˜¯ä¸€ä¸ªå¾ˆå¥½çš„é€‰æ‹©ã€‚</p><p>æ€»ä¹‹ï¼Œæˆ‘ä»¬å¿…é¡»ä¿è¯é”®çš„ç±»å‹æ˜¯å¯æ¯”è¾ƒçš„ï¼ˆæˆ–è€…è¯´å¯åˆ¤ç­‰çš„ï¼‰ã€‚å¦‚æœä½ å®åœ¨æ‹¿ä¸å‡†ï¼Œé‚£ä¹ˆå¯ä»¥å…ˆé€šè¿‡è°ƒç”¨<code>reflect.TypeOf</code>å‡½æ•°å¾—åˆ°ä¸€ä¸ªé”®å€¼å¯¹åº”çš„åå°„ç±»å‹å€¼ï¼ˆå³ï¼š<code>reflect.Type</code>ç±»å‹çš„å€¼ï¼‰ï¼Œç„¶åå†è°ƒç”¨è¿™ä¸ªå€¼çš„<code>Comparable</code>æ–¹æ³•ï¼Œå¾—åˆ°ç¡®åˆ‡çš„åˆ¤æ–­ç»“æœã€‚</p><h2>çŸ¥è¯†æ‰©å±•</h2><h2>é—®é¢˜1ï¼šæ€æ ·ä¿è¯å¹¶å‘å®‰å…¨å­—å…¸ä¸­çš„é”®å’Œå€¼çš„ç±»å‹æ­£ç¡®æ€§ï¼Ÿï¼ˆæ–¹æ¡ˆä¸€ï¼‰</h2><p>ç®€å•åœ°è¯´ï¼Œå¯ä»¥ä½¿ç”¨ç±»å‹æ–­è¨€è¡¨è¾¾å¼æˆ–è€…åå°„æ“ä½œæ¥ä¿è¯å®ƒä»¬çš„ç±»å‹æ­£ç¡®æ€§ã€‚</p><p>ä¸ºäº†è¿›ä¸€æ­¥æ˜ç¡®å¹¶å‘å®‰å…¨å­—å…¸ä¸­é”®å€¼çš„å®é™…ç±»å‹ï¼Œè¿™é‡Œå¤§è‡´æœ‰ä¸¤ç§æ–¹æ¡ˆå¯é€‰ã€‚</p><p><strong>ç¬¬ä¸€ç§æ–¹æ¡ˆæ˜¯ï¼Œè®©å¹¶å‘å®‰å…¨å­—å…¸åªèƒ½å­˜å‚¨æŸä¸ªç‰¹å®šç±»å‹çš„é”®ã€‚</strong></p><p>æ¯”å¦‚ï¼ŒæŒ‡å®šè¿™é‡Œçš„é”®åªèƒ½æ˜¯<code>int</code>ç±»å‹çš„ï¼Œæˆ–è€…åªèƒ½æ˜¯å­—ç¬¦ä¸²ï¼Œåˆæˆ–æ˜¯æŸç±»ç»“æ„ä½“ã€‚ä¸€æ—¦å®Œå…¨ç¡®å®šäº†é”®çš„ç±»å‹ï¼Œä½ å°±å¯ä»¥åœ¨è¿›è¡Œå­˜ã€å–ã€åˆ æ“ä½œçš„æ—¶å€™ï¼Œä½¿ç”¨ç±»å‹æ–­è¨€è¡¨è¾¾å¼å»å¯¹é”®çš„ç±»å‹åšæ£€æŸ¥äº†ã€‚</p><p>ä¸€èˆ¬æƒ…å†µä¸‹ï¼Œè¿™ç§æ£€æŸ¥å¹¶ä¸ç¹çã€‚è€Œä¸”ï¼Œä½ è¦æ˜¯æŠŠå¹¶å‘å®‰å…¨å­—å…¸å°è£…åœ¨ä¸€ä¸ªç»“æ„ä½“ç±»å‹é‡Œé¢ï¼Œé‚£å°±æ›´åŠ æ–¹ä¾¿äº†ã€‚ä½ è¿™æ—¶å®Œå…¨å¯ä»¥è®©Goè¯­è¨€ç¼–è¯‘å™¨å¸®åŠ©ä½ åšç±»å‹æ£€æŸ¥ã€‚è¯·çœ‹ä¸‹é¢çš„ä»£ç ï¼š</p><pre><code>type IntStrMap struct {\n m sync.Map\n}\n\nfunc (iMap *IntStrMap) Delete(key int) {\n iMap.m.Delete(key)\n}\n\nfunc (iMap *IntStrMap) Load(key int) (value string, ok bool) {\n v, ok := iMap.m.Load(key)\n if v != nil {\n  value = v.(string)\n }\n return\n}\n\nfunc (iMap *IntStrMap) LoadOrStore(key int, value string) (actual string, loaded bool) {\n a, loaded := iMap.m.LoadOrStore(key, value)\n actual = a.(string)\n return\n}\n\nfunc (iMap *IntStrMap) Range(f func(key int, value string) bool) {\n f1 := func(key, value interface{}) bool {\n  return f(key.(int), value.(string))\n }\n iMap.m.Range(f1)\n}\n\nfunc (iMap *IntStrMap) Store(key int, value string) {\n iMap.m.Store(key, value)\n}\n</code></pre><p>å¦‚ä¸Šæ‰€ç¤ºï¼Œæˆ‘ç¼–å†™äº†ä¸€ä¸ªåä¸º<code>IntStrMap</code>çš„ç»“æ„ä½“ç±»å‹ï¼Œå®ƒä»£è¡¨äº†é”®ç±»å‹ä¸º<code>int</code>ã€å€¼ç±»å‹ä¸º<code>string</code>çš„å¹¶å‘å®‰å…¨å­—å…¸ã€‚åœ¨è¿™ä¸ªç»“æ„ä½“ç±»å‹ä¸­ï¼Œåªæœ‰ä¸€ä¸ª<code>sync.Map</code>ç±»å‹çš„å­—æ®µ<code>m</code>ã€‚å¹¶ä¸”ï¼Œè¿™ä¸ªç±»å‹æ‹¥æœ‰çš„æ‰€æœ‰æ–¹æ³•ï¼Œéƒ½ä¸<code>sync.Map</code>ç±»å‹çš„æ–¹æ³•éå¸¸ç±»ä¼¼ã€‚</p><p>ä¸¤è€…å¯¹åº”çš„æ–¹æ³•åç§°å®Œå…¨ä¸€è‡´ï¼Œæ–¹æ³•ç­¾åä¹Ÿéå¸¸ç›¸ä¼¼ï¼Œåªä¸è¿‡ï¼Œä¸é”®å’Œå€¼ç›¸å…³çš„é‚£äº›å‚æ•°å’Œç»“æœçš„ç±»å‹ä¸åŒè€Œå·²ã€‚åœ¨<code>IntStrMap</code>ç±»å‹çš„æ–¹æ³•ç­¾åä¸­ï¼Œæ˜ç¡®äº†é”®çš„ç±»å‹ä¸º<code>int</code>ï¼Œä¸”å€¼çš„ç±»å‹ä¸º<code>string</code>ã€‚</p><p>æ˜¾ç„¶ï¼Œè¿™äº›æ–¹æ³•åœ¨æ¥å—é”®å’Œå€¼çš„æ—¶å€™ï¼Œå°±ä¸ç”¨å†åšç±»å‹æ£€æŸ¥äº†ã€‚å¦å¤–ï¼Œè¿™äº›æ–¹æ³•åœ¨ä»<code>m</code>ä¸­å–å‡ºé”®å’Œå€¼çš„æ—¶å€™ï¼Œå®Œå…¨ä¸ç”¨æ‹…å¿ƒå®ƒä»¬çš„ç±»å‹ä¼šä¸æ­£ç¡®ï¼Œå› ä¸ºå®ƒçš„æ­£ç¡®æ€§åœ¨å½“åˆå­˜å…¥çš„æ—¶å€™ï¼Œå°±å·²ç»ç”±Goè¯­è¨€ç¼–è¯‘å™¨ä¿è¯äº†ã€‚</p><p>ç¨å¾®æ€»ç»“ä¸€ä¸‹ã€‚ç¬¬ä¸€ç§æ–¹æ¡ˆé€‚ç”¨äºæˆ‘ä»¬å¯ä»¥å®Œå…¨ç¡®å®šé”®å’Œå€¼çš„å…·ä½“ç±»å‹çš„æƒ…å†µã€‚åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬å¯ä»¥åˆ©ç”¨Goè¯­è¨€ç¼–è¯‘å™¨å»åšç±»å‹æ£€æŸ¥ï¼Œå¹¶ç”¨ç±»å‹æ–­è¨€è¡¨è¾¾å¼ä½œä¸ºè¾…åŠ©ï¼Œå°±åƒ<code>IntStrMap</code>é‚£æ ·ã€‚</p><h2>æ€»ç»“</h2><p>æˆ‘ä»¬ä»Šå¤©è®¨è®ºçš„æ˜¯<code>sync.Map</code>ç±»å‹ï¼Œå®ƒæ˜¯ä¸€ç§å¹¶å‘å®‰å…¨çš„å­—å…¸ã€‚å®ƒæä¾›äº†ä¸€äº›å¸¸ç”¨çš„é”®ã€å€¼å­˜å–æ“ä½œæ–¹æ³•ï¼Œå¹¶ä¿è¯äº†è¿™äº›æ“ä½œçš„å¹¶å‘å®‰å…¨ã€‚åŒæ—¶ï¼Œå®ƒè¿˜ä¿è¯äº†å­˜ã€å–ã€åˆ ç­‰æ“ä½œçš„å¸¸æ•°çº§æ‰§è¡Œæ—¶é—´ã€‚</p><p>ä¸åŸç”Ÿçš„å­—å…¸ç›¸åŒï¼Œå¹¶å‘å®‰å…¨å­—å…¸å¯¹é”®çš„ç±»å‹ä¹Ÿæ˜¯æœ‰è¦æ±‚çš„ã€‚å®ƒä»¬åŒæ ·ä¸èƒ½æ˜¯å‡½æ•°ç±»å‹ã€å­—å…¸ç±»å‹å’Œåˆ‡ç‰‡ç±»å‹ã€‚</p><p>å¦å¤–ï¼Œç”±äºå¹¶å‘å®‰å…¨å­—å…¸æä¾›çš„æ–¹æ³•æ¶‰åŠçš„é”®å’Œå€¼çš„ç±»å‹éƒ½æ˜¯<code>interface{}</code>ï¼Œæ‰€ä»¥æˆ‘ä»¬åœ¨è°ƒç”¨è¿™äº›æ–¹æ³•çš„æ—¶å€™ï¼Œå¾€å¾€è¿˜éœ€è¦å¯¹é”®å’Œå€¼çš„å®é™…ç±»å‹è¿›è¡Œæ£€æŸ¥ã€‚</p><p>è¿™é‡Œå¤§è‡´æœ‰ä¸¤ä¸ªæ–¹æ¡ˆã€‚æˆ‘ä»¬ä»Šå¤©ä¸»è¦æåˆ°äº†ç¬¬ä¸€ç§æ–¹æ¡ˆï¼Œè¿™æ˜¯åœ¨ç¼–ç æ—¶å°±å®Œå…¨ç¡®å®šé”®å’Œå€¼çš„ç±»å‹ï¼Œç„¶ååˆ©ç”¨Goè¯­è¨€çš„ç¼–è¯‘å™¨å¸®æˆ‘ä»¬åšæ£€æŸ¥ã€‚</p><p>åœ¨ä¸‹ä¸€æ¬¡çš„æ–‡ç« ä¸­ï¼Œæˆ‘ä»¬ä¼šæåˆ°å¦å¤–ä¸€ç§æ–¹æ¡ˆï¼Œå¹¶å¯¹æ¯”è¿™ä¸¤ç§æ–¹æ¡ˆçš„ä¼˜åŠ£ã€‚é™¤æ­¤ä¹‹å¤–ï¼Œæˆ‘ä¼šç»§ç»­æ¢è®¨å¹¶å‘å®‰å…¨å­—å…¸çš„ç›¸å…³é—®é¢˜ã€‚</p><p>æ„Ÿè°¢ä½ çš„æ”¶å¬ï¼Œæˆ‘ä»¬ä¸‹æœŸå†è§ã€‚</p><p><a href=\"https://github.com/hyper0x/Golang_Puzzlers\">æˆ³æ­¤æŸ¥çœ‹Goè¯­è¨€ä¸“æ æ–‡ç« é…å¥—è¯¦ç»†ä»£ç ã€‚</a></p><p></p>","neighbors":{"left":{"article_title":"33 | ä¸´æ—¶å¯¹è±¡æ± sync.Pool","id":42160},"right":{"article_title":"35 | å¹¶å‘å®‰å…¨å­—å…¸sync.Map (ä¸‹)","id":42800}},"comments":[{"had_liked":false,"id":71846,"user_name":"è™¢åœ‹æŠ€é†¬","can_delete":false,"product_type":"c1","uid":1056807,"ip_address":"","ucode":"5A192262AA037E","user_header":"https://static001.geekbang.org/account/avatar/00/10/20/27/a6932fbe.jpg","comment_is_top":false,"comment_ctime":1551450119,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"117515567111","product_id":100013101,"comment_content":"æ‰“å¡ï¼Œåé¢çš„ç•™è¨€è¶Šæ¥è¶Šå°‘ï¼Œçœ‹æ¥æœ‰ç‚¹éš¾åº¦äº†ï¼ŒåŠ æ²¹å•ƒä¸‹å®ƒï¼åé¢çš„å…„å¼Ÿ","like_count":28},{"had_liked":false,"id":114474,"user_name":"é—«é£","can_delete":false,"product_type":"c1","uid":1013162,"ip_address":"","ucode":"30C782D30108D4","user_header":"https://static001.geekbang.org/account/avatar/00/0f/75/aa/21275b9d.jpg","comment_is_top":false,"comment_ctime":1563323148,"is_pvip":false,"discussion_count":2,"race_medal":0,"score":"35923061516","product_id":100013101,"comment_content":"æˆ‘è§‰å¾—è¿™é‡Œçš„ä¸»è¦éº»çƒ¦ä¹‹ä¸€æ˜¯golangä¸æ”¯æŒæ³›å‹ç¼–ç¨‹è¿™ä¸€é‡å¤§çš„èŒƒå¼ï¼Œç”¨æˆ·ä¸å¾—ä¸åœ¨ä¸Šå±‚ä»£ç é‡Œé¢åšç¹ççš„æ£€æŸ¥ã€‚","like_count":8,"discussions":[{"author":{"id":2063832,"avatar":"","nickname":"é©¬å®å›¾","note":"","ucode":"81721525304984","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":382651,"discussion_content":"æ”¯æŒæ³›å‹å°±å’Œphpä¼¼çš„å¾—åšç±»å‹å…¼å®¹ï¼Œå­˜å‚¨å’Œè¯»å–æ•ˆç‡å°±ä¸å¯èƒ½å¾—åˆ°ä¿éšœäº†","likes_number":1,"is_delete":false,"is_hidden":false,"ctime":1625660310,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1311995,"avatar":"https://static001.geekbang.org/account/avatar/00/14/04/fb/40f298bb.jpg","nickname":"å°ç½—å¸Œå†€","note":"","ucode":"88416458FF0041","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":318708,"discussion_content":"æ²¡é”™,ä¸æ”¯æŒæ³›å‹æ˜¯çœŸçš„éš¾å—","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1603811506,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":218234,"user_name":"ç»™åŠ›","can_delete":false,"product_type":"c1","uid":1113645,"ip_address":"","ucode":"646EE4AFC17224","user_header":"https://static001.geekbang.org/account/avatar/00/10/fe/2d/2c9177ca.jpg","comment_is_top":false,"comment_ctime":1589763641,"is_pvip":false,"replies":[{"id":"80734","content":"æ˜¯çš„ï¼Œè¿™ç§å¹¶å‘å®‰å…¨å­—å…¸æ˜¯åœ¨ä¸€äº›ç‰¹å®šåœºæ™¯ä¸‹ç”¨çš„ï¼Œæ¯”å¦‚é…ç½®ä¿¡æ¯åŒæ­¥ã€æ‰¹é‡è®¡æ•°ç­‰ç­‰ã€‚åœ¨è¿™ç±»åœºæ™¯ä¸‹ï¼Œé”®å€¼å¯¹æ•°é‡å¹¶ä¸æ˜¯å…³é”®é—®é¢˜ã€‚å¦‚æœä½ æƒ³æ‰¾é€šç”¨çš„ï¼Œå¯ä»¥å‚çœ‹ä¸€ä¸‹è¿™ä¸ªï¼šhttps:&#47;&#47;github.com&#47;gopcp&#47;example.v2&#47;tree&#47;master&#47;src&#47;gopcp.v2&#47;chapter5&#47;cmap","user_name":"ä½œè€…å›å¤","user_name_real":"éƒæ—","uid":"1026643","ctime":1589775776,"ip_address":"","comment_id":218234,"utype":1}],"discussion_count":1,"race_medal":0,"score":"14474665529","product_id":100013101,"comment_content":"å¹¶å‘å®‰å…¨çš„å­—å…¸é‡Œå°‘äº†ä¸¤ä¸ªæ–¹æ³•ï¼Œæ¯”å¦‚å·²ç»æœ‰å¤šå°‘keyï¼Œæˆ‘ä»¬æœ‰ä»€ä¹ˆè§£å†³åŠæ³•æ²¡ï¼Œåªèƒ½è‡ªå·±æ¯æ¬¡æ’å…¥æˆ–è€…åˆ é™¤keyè®°å½•å…ƒç´ ä¸ªæ•°å˜åŒ–å—ï¼Ÿ<br>","like_count":3,"discussions":[{"author":{"id":1026643,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/aa/53/768aec0a.jpg","nickname":"éƒæ—","note":"","ucode":"F66BA62BA56FFA","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":495397,"discussion_content":"æ˜¯çš„ï¼Œè¿™ç§å¹¶å‘å®‰å…¨å­—å…¸æ˜¯åœ¨ä¸€äº›ç‰¹å®šåœºæ™¯ä¸‹ç”¨çš„ï¼Œæ¯”å¦‚é…ç½®ä¿¡æ¯åŒæ­¥ã€æ‰¹é‡è®¡æ•°ç­‰ç­‰ã€‚åœ¨è¿™ç±»åœºæ™¯ä¸‹ï¼Œé”®å€¼å¯¹æ•°é‡å¹¶ä¸æ˜¯å…³é”®é—®é¢˜ã€‚å¦‚æœä½ æƒ³æ‰¾é€šç”¨çš„ï¼Œå¯ä»¥å‚çœ‹ä¸€ä¸‹è¿™ä¸ªï¼šhttps://github.com/gopcp/example.v2/tree/master/src/gopcp.v2/chapter5/cmap","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1589775776,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":280943,"user_name":"mkii","can_delete":false,"product_type":"c1","uid":1674466,"ip_address":"","ucode":"534914EC7EA304","user_header":"https://static001.geekbang.org/account/avatar/00/19/8c/e2/48f4e4fa.jpg","comment_is_top":false,"comment_ctime":1614498151,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"5909465447","product_id":100013101,"comment_content":"è¿™ä¸‹å¯ä»¥æŠŠé¡¹ç›®é‡Œä¸‘é™‹çš„mutex+mapå»æ‰äº†ğŸ‘ğŸ‘ğŸ‘","like_count":1},{"had_liked":false,"id":351027,"user_name":"MClink","can_delete":false,"product_type":"c1","uid":1435733,"ip_address":"","ucode":"F479190923355C","user_header":"https://static001.geekbang.org/account/avatar/00/15/e8/55/92f82281.jpg","comment_is_top":false,"comment_ctime":1657463884,"is_pvip":true,"replies":[{"id":"127815","content":"ç¨‹åºä¾‹æœ‰å…±äº«ç¨‹åºå®ä½“æˆ–è€…èµ„æºçš„æ—¶å€™å°±è‚¯å®šä¼šç”¨ä¸Šå¹¶å‘ç¼–ç¨‹çš„","user_name":"ä½œè€…å›å¤","user_name_real":"ç¼–è¾‘","uid":"1026643","ctime":1657777613,"ip_address":"","comment_id":351027,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1657463884","product_id":100013101,"comment_content":"æ„Ÿè§‰å¹¶å‘ç¼–ç¨‹å’Œæ—¥å¸¸çš„ä¸šåŠ¡CRUDè¿˜æ˜¯æœ‰å¾ˆå¤šåŒºåˆ«çš„ï¼Œä¸€èˆ¬ä¸šåŠ¡å¾ˆå¤šä¸œè¥¿éƒ½ç”¨ä¸ä¸Šã€‚","like_count":0,"discussions":[{"author":{"id":1026643,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/aa/53/768aec0a.jpg","nickname":"éƒæ—","note":"","ucode":"F66BA62BA56FFA","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":579929,"discussion_content":"ç¨‹åºä¾‹æœ‰å…±äº«ç¨‹åºå®ä½“æˆ–è€…èµ„æºçš„æ—¶å€™å°±è‚¯å®šä¼šç”¨ä¸Šå¹¶å‘ç¼–ç¨‹çš„","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1657777613,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":345094,"user_name":"DayDayUp","can_delete":false,"product_type":"c1","uid":1610552,"ip_address":"","ucode":"9C53659518AB74","user_header":"https://static001.geekbang.org/account/avatar/00/18/93/38/71615300.jpg","comment_is_top":false,"comment_ctime":1652018460,"is_pvip":false,"replies":[{"id":"126244","content":"æˆ‘æ²¡ç ”ç©¶è¿‡é‚£ä¸ªconcurrent-mapã€‚ä½ å¯ä»¥åŠŸèƒ½æµ‹è¯•æ¯”è¾ƒä¸€ä¸‹ä¸¤è€…çš„åŠŸèƒ½å·®å¼‚å’ŒAPIä¾¿æ·åº¦ï¼Œå¹¶ç”¨åŸºå‡†æµ‹è¯•æ¯”è¾ƒä¸€ä¸‹ä¸¤è€…çš„æ€§èƒ½ã€‚","user_name":"ä½œè€…å›å¤","user_name_real":"ç¼–è¾‘","uid":"1026643","ctime":1652762709,"ip_address":"","comment_id":345094,"utype":1}],"discussion_count":1,"race_medal":1,"score":"1652018460","product_id":100013101,"comment_content":"è€å¸ˆï¼Œçœ‹åˆ°æœ‰äººç”¨github.com&#47;orcaman&#47;concurrent-mapï¼Œä¸çŸ¥é“äºŒè€…æœ‰ä½•åŒºåˆ«å‘¢ï¼Ÿ","like_count":0,"discussions":[{"author":{"id":1026643,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/aa/53/768aec0a.jpg","nickname":"éƒæ—","note":"","ucode":"F66BA62BA56FFA","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":572389,"discussion_content":"æˆ‘æ²¡ç ”ç©¶è¿‡é‚£ä¸ªconcurrent-mapã€‚ä½ å¯ä»¥åŠŸèƒ½æµ‹è¯•æ¯”è¾ƒä¸€ä¸‹ä¸¤è€…çš„åŠŸèƒ½å·®å¼‚å’ŒAPIä¾¿æ·åº¦ï¼Œå¹¶ç”¨åŸºå‡†æµ‹è¯•æ¯”è¾ƒä¸€ä¸‹ä¸¤è€…çš„æ€§èƒ½ã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1652762710,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":339583,"user_name":"å¯„å±…ä¸èŸ¹","can_delete":false,"product_type":"c1","uid":2690189,"ip_address":"","ucode":"3D254E5E2C9966","user_header":"https://static001.geekbang.org/account/avatar/00/29/0c/8d/90bee755.jpg","comment_is_top":false,"comment_ctime":1648201293,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1648201293","product_id":100013101,"comment_content":"æ‰“å¡ï¼Œå†²","like_count":0},{"had_liked":false,"id":319068,"user_name":"jxs1211","can_delete":false,"product_type":"c1","uid":1101006,"ip_address":"","ucode":"B7F1F2D84389E7","user_header":"https://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTKELX1Rd1vmLRWibHib8P95NA87F4zcj8GrHKYQL2RcLDVnxNy1ia2geTWgW6L2pWn2kazrPNZMRVrIg/132","comment_is_top":false,"comment_ctime":1635565346,"is_pvip":false,"replies":[{"id":"115713","content":"atomic.Value åŸåˆ™ä¸Šå¯ä»¥å­˜ä»»ä½•å€¼ï¼Œä½†å¯¹äºå¼•ç”¨ç±»å‹çš„å€¼ï¼Œè¦é¿å…å¤–ç•Œç›´æ¥å»ä¿®æ”¹è¿™ä¸ªå€¼ï¼Œå¦åˆ™ Value çš„ä¿æŠ¤å°±å½¢åŒè™šè®¾äº†ã€‚","user_name":"ä½œè€…å›å¤","user_name_real":"éƒæ—","uid":"1026643","ctime":1635675545,"ip_address":"","comment_id":319068,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1635565346","product_id":100013101,"comment_content":"èƒ½ç”¨åŸå­æ“ä½œå°±ä¸è¦ç”¨é”ï¼Œä¸è¿‡è¿™å¾ˆæœ‰å±€é™æ€§ï¼Œæ¯•ç«ŸåŸå­åªèƒ½å¯¹ä¸€äº›åŸºæœ¬çš„æ•°æ®ç±»å‹æä¾›æ”¯æŒã€‚é—®é¢˜ï¼š<br>atomic.Valueä¸æ˜¯å¯ä»¥æ”¯æŒé™¤äº†äºŒè¿›åˆ¶å’Œintç±»å‹ä»¥å¤–çš„æ•°æ®ç±»å‹çš„åŸå­æ“ä½œå—ï¼Œè¿˜æ˜¯å…¶ä»æœ‰ä¸€å®šå±€é™æ€§ï¼Œå¦å¤–atomic.Valueä½¿ç”¨æ˜¯å¦æœ‰ç¦å¿Œæˆ–è€…éœ€è¦æ³¨æ„çš„åœ°æ–¹","like_count":0,"discussions":[{"author":{"id":1026643,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/aa/53/768aec0a.jpg","nickname":"éƒæ—","note":"","ucode":"F66BA62BA56FFA","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":529486,"discussion_content":"atomic.Value åŸåˆ™ä¸Šå¯ä»¥å­˜ä»»ä½•å€¼ï¼Œä½†å¯¹äºå¼•ç”¨ç±»å‹çš„å€¼ï¼Œè¦é¿å…å¤–ç•Œç›´æ¥å»ä¿®æ”¹è¿™ä¸ªå€¼ï¼Œå¦åˆ™ Value çš„ä¿æŠ¤å°±å½¢åŒè™šè®¾äº†ã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1635675545,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":319067,"user_name":"jxs1211","can_delete":false,"product_type":"c1","uid":1101006,"ip_address":"","ucode":"B7F1F2D84389E7","user_header":"https://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTKELX1Rd1vmLRWibHib8P95NA87F4zcj8GrHKYQL2RcLDVnxNy1ia2geTWgW6L2pWn2kazrPNZMRVrIg/132","comment_is_top":false,"comment_ctime":1635565306,"is_pvip":false,"replies":[{"id":"115714","content":"1. ä¸å¯¹ï¼Œè¿›ç¨‹ä¸CPUæ ¸å¿ƒä¹‹é—´ä¸€èˆ¬ä¸ä¼šæœ‰ç‰¹å®šçš„å¯¹åº”å…³ç³»ï¼Œé™¤éç¨‹åºé‡Œæ‰‹åŠ¨é”å®šä¸€å¯¹ä¸€çš„å…³ç³»ã€‚å¤§å¤šæ•°ç¨‹åºä¸€èˆ¬éƒ½ä¼šå……åˆ†åˆ©ç”¨æ‰€æœ‰çš„CPUæ ¸å¿ƒã€‚<br><br>2. æ¯ä¸ªè¿›ç¨‹çš„é”éƒ½åªèƒ½æ§åˆ¶å½“å‰è¿›ç¨‹ä¸­çš„ä»£ç æ‰§è¡Œæµç¨‹ã€‚è‡³äºä½ çš„ç–‘é—®ï¼Œè¯·å‚è€ƒç¬¬ä¸€ä¸ªé—®é¢˜çš„ç­”æ¡ˆï¼šç¨‹åºä¸€èˆ¬ä¼šåŒæ—¶ä½¿ç”¨å¤šä¸ªCPUæ ¸å¿ƒã€‚","user_name":"ä½œè€…å›å¤","user_name_real":"éƒæ—","uid":"1026643","ctime":1635675904,"ip_address":"","comment_id":319067,"utype":1}],"discussion_count":2,"race_medal":0,"score":"1635565306","product_id":100013101,"comment_content":"æˆ‘ä»¬éƒ½çŸ¥é“ï¼Œä½¿ç”¨é”å°±æ„å‘³ç€è¦æŠŠä¸€äº›å¹¶å‘çš„æ“ä½œå¼ºåˆ¶ä¸²è¡ŒåŒ–ã€‚è¿™å¾€å¾€ä¼šé™ä½ç¨‹åºçš„æ€§èƒ½ï¼Œå°¤å…¶æ˜¯åœ¨è®¡ç®—æœºæ‹¥æœ‰å¤šä¸ª CPU æ ¸å¿ƒçš„æƒ…å†µä¸‹ã€‚é—®é¢˜ï¼š<br>1 ä¸€ä¸ªç¨‹åºçš„æ¯ä¸ªè¿›ç¨‹åªèƒ½è·‘åœ¨ä¸€ä¸ªcpuçš„æ ¸å¿ƒä¸Šï¼Œå¯¹å—ï¼Ÿ<br>2 æ¯ä¸ªè¿›ç¨‹ä¸­çš„é”åªä¼šæ§åˆ¶è¯¥è¿›ç¨‹å†…éƒ¨çš„goroutineä¸²è¡Œæ‰§è¡Œï¼Œåº”è¯¥æ˜¯ä¸èƒ½æ§åˆ¶å…¶ä»–è¿›ç¨‹é‡Œçš„goroutineçš„å§ï¼Œé‚£è¿™é‡Œå¤šæ ¸CPUä¸‹ä½¿ç”¨äº’æ–¥é”æ›´åŠ å½±å“æ€§èƒ½çš„æ„æ€æ˜¯æŒ‡ä»€ä¹ˆ","like_count":0,"discussions":[{"author":{"id":1026643,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/aa/53/768aec0a.jpg","nickname":"éƒæ—","note":"","ucode":"F66BA62BA56FFA","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":529485,"discussion_content":"1. ä¸å¯¹ï¼Œè¿›ç¨‹ä¸CPUæ ¸å¿ƒä¹‹é—´ä¸€èˆ¬ä¸ä¼šæœ‰ç‰¹å®šçš„å¯¹åº”å…³ç³»ï¼Œé™¤éç¨‹åºé‡Œæ‰‹åŠ¨é”å®šä¸€å¯¹ä¸€çš„å…³ç³»ã€‚å¤§å¤šæ•°ç¨‹åºä¸€èˆ¬éƒ½ä¼šå……åˆ†åˆ©ç”¨æ‰€æœ‰çš„CPUæ ¸å¿ƒã€‚\n\n2. æ¯ä¸ªè¿›ç¨‹çš„é”éƒ½åªèƒ½æ§åˆ¶å½“å‰è¿›ç¨‹ä¸­çš„ä»£ç æ‰§è¡Œæµç¨‹ã€‚è‡³äºä½ çš„ç–‘é—®ï¼Œè¯·å‚è€ƒç¬¬ä¸€ä¸ªé—®é¢˜çš„ç­”æ¡ˆï¼šç¨‹åºä¸€èˆ¬ä¼šåŒæ—¶ä½¿ç”¨å¤šä¸ªCPUæ ¸å¿ƒã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1635675904,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1101006,"avatar":"https://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTKELX1Rd1vmLRWibHib8P95NA87F4zcj8GrHKYQL2RcLDVnxNy1ia2geTWgW6L2pWn2kazrPNZMRVrIg/132","nickname":"jxs1211","note":"","ucode":"B7F1F2D84389E7","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":410367,"discussion_content":"é‚£æ˜¯ä¸€ä¸ªè¿›ç¨‹å¯ä»¥è·‘åˆ°å¤šä¸ªCPUæ ¸å¿ƒä¸Šå—ï¼Œåˆ©ç”¨çš„æ„æ€æ˜¯æŒ‡ç¨‹åºä¼šèµ·å¤šä¸ªè¿›ç¨‹ä»»æ„è·‘åœ¨å¤šä¸ªCPUä¸Šï¼Ÿ","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1635677386,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":308364,"user_name":"lesserror","can_delete":false,"product_type":"c1","uid":1351076,"ip_address":"","ucode":"25A54D1165FCF6","user_header":"https://static001.geekbang.org/account/avatar/00/14/9d/a4/e481ae48.jpg","comment_is_top":false,"comment_ctime":1629556467,"is_pvip":false,"replies":[{"id":"111671","content":"v.(T) æ˜¯åœ¨åšç±»å‹è½¬æ¢æ–­è¨€ï¼ŒæŠŠ v çš„ç±»å‹è½¬æ¢æˆ Tï¼Œå¦‚æœè½¬æ¢å¤±è´¥å°±æŠ›å‡º panicï¼Œå¦‚æœä¸æƒ³è®©å®ƒæŠ› panicï¼Œå¯ä»¥ï¼š<br><br>v2, ok := v.(T)<br><br>å¦‚æœ ok ä¸º falseï¼Œå°±è¯´æ˜å¤±è´¥äº†ï¼›å¦‚æœ ok ä¸º true å°±è¯´æ˜æˆåŠŸäº†ï¼Œæ­¤æ—¶ v2 å°±æ˜¯è½¬æ¢åçš„å€¼ã€‚","user_name":"ä½œè€…å›å¤","user_name_real":"éƒæ—","uid":"1026643","ctime":1629619389,"ip_address":"","comment_id":308364,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1629556467","product_id":100013101,"comment_content":"éƒæ—è€å¸ˆï¼Œåœ¨ IntStrMap çš„æ–¹æ³•ä¸­è¿™ç§ å€¼ç‚¹ä¸Š æ‹¬å· string intã€‚  key.(int) ã€value.(string) ã€a.(string) ä»£è¡¨çš„æ˜¯å°†å¯¹åº”çš„æ•°æ®è½¬æ¢ä¸º stringå’Œ int ç±»å‹å§ï¼Ÿ æˆ‘è¿™æ ·ç†è§£å¯¹å—ï¼Ÿ","like_count":0,"discussions":[{"author":{"id":1026643,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/aa/53/768aec0a.jpg","nickname":"éƒæ—","note":"","ucode":"F66BA62BA56FFA","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":525471,"discussion_content":"v.(T) æ˜¯åœ¨åšç±»å‹è½¬æ¢æ–­è¨€ï¼ŒæŠŠ v çš„ç±»å‹è½¬æ¢æˆ Tï¼Œå¦‚æœè½¬æ¢å¤±è´¥å°±æŠ›å‡º panicï¼Œå¦‚æœä¸æƒ³è®©å®ƒæŠ› panicï¼Œå¯ä»¥ï¼š\n\nv2, ok := v.(T)\n\nå¦‚æœ ok ä¸º falseï¼Œå°±è¯´æ˜å¤±è´¥äº†ï¼›å¦‚æœ ok ä¸º true å°±è¯´æ˜æˆåŠŸäº†ï¼Œæ­¤æ—¶ v2 å°±æ˜¯è½¬æ¢åçš„å€¼ã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1629619389,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":254279,"user_name":"ä¸‹é›¨å¤©","can_delete":false,"product_type":"c1","uid":1413399,"ip_address":"","ucode":"FB3851E3A79C3B","user_header":"https://static001.geekbang.org/account/avatar/00/15/91/17/89c3d249.jpg","comment_is_top":false,"comment_ctime":1603095108,"is_pvip":false,"discussion_count":1,"race_medal":0,"score":"1603095108","product_id":100013101,"comment_content":"æˆ‘æœ€è¿‘é‡åˆ°ä¸€ä¸ªé—®é¢˜ï¼Œsync.Mapä¹‹é—´èµ‹å€¼æ“ä½œä¹‹åï¼Œä¼šå˜æˆçº¿ç¨‹ä¸å®‰å…¨çš„mapï¼ˆåŸå§‹mapï¼‰ï¼Œèµ‹å€¼ä¹‹åå¯èƒ½ä¼šå¯¼è‡´åº•çš„åŸå§‹mapæ“ä½œå‡ºç°è¯»å†™ï¼Œå¯¼è‡´é—®é¢˜ã€‚","like_count":0,"discussions":[{"author":{"id":1201009,"avatar":"https://static001.geekbang.org/account/avatar/00/12/53/71/a4e9f20e.jpg","nickname":"è¨€åˆæœ¨æ‰","note":"","ucode":"300BEDC1B07DF1","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":370663,"discussion_content":"è´´ä¸ªä»£ç çœ‹çœ‹ï¼Ÿï¼Ÿ","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1619500662,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":243644,"user_name":"æ¼‚æ³Šçš„å°é£˜","can_delete":false,"product_type":"c1","uid":1222578,"ip_address":"","ucode":"25C0CA4887D8AD","user_header":"https://static001.geekbang.org/account/avatar/00/12/a7/b2/274a4192.jpg","comment_is_top":false,"comment_ctime":1598238928,"is_pvip":false,"replies":[{"id":"89791","content":"ä½ æ²¡è¯´ä¸Šä¸‹æ–‡ï¼Œæˆ‘æ²¡æ³•è§£é‡Šå•Šã€‚","user_name":"ä½œè€…å›å¤","user_name_real":"éƒæ—","uid":"1026643","ctime":1598251355,"ip_address":"","comment_id":243644,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1598238928","product_id":100013101,"comment_content":"ä»€ä¹ˆå­—å…¸çš„å¹¶å‘å†™ä¼šé€ æˆfatal errorå‘¢ï¼Œç®€å•çš„åŸç†æ˜¯ä»€ä¹ˆï¼Ÿ","like_count":0,"discussions":[{"author":{"id":1026643,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/aa/53/768aec0a.jpg","nickname":"éƒæ—","note":"","ucode":"F66BA62BA56FFA","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":504346,"discussion_content":"ä½ æ²¡è¯´ä¸Šä¸‹æ–‡ï¼Œæˆ‘æ²¡æ³•è§£é‡Šå•Šã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1598251355,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":198021,"user_name":"æ¶›å£°ä¾æ—§","can_delete":false,"product_type":"c1","uid":1013593,"ip_address":"","ucode":"E0F22ECA010A5C","user_header":"https://static001.geekbang.org/account/avatar/00/0f/77/59/8bb1f879.jpg","comment_is_top":false,"comment_ctime":1585407173,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1585407173","product_id":100013101,"comment_content":"è¿™ä¸ªç« èŠ‚æˆ‘åˆå­¦ä¹ ä¸€æ‹›","like_count":0},{"had_liked":false,"id":168696,"user_name":"ç–¯ç´","can_delete":false,"product_type":"c1","uid":1099379,"ip_address":"","ucode":"82ACAA4A27753D","user_header":"https://static001.geekbang.org/account/avatar/00/10/c6/73/abb7bfe3.jpg","comment_is_top":false,"comment_ctime":1578142521,"is_pvip":false,"replies":[{"id":"65624","content":"è¿™ä¸ªä¸å®¹æ˜“å¤ç°ï¼Œå°¤å…¶å¯¹äºç®€å•çš„ç¤ºä¾‹æ¥è¯´ã€‚","user_name":"ä½œè€…å›å¤","user_name_real":"éƒæ—","uid":"1026643","ctime":1578306434,"ip_address":"","comment_id":168696,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1578142521","product_id":100013101,"comment_content":"æˆ‘è§‰å¾—è€å¸ˆçš„ç¤ºä¾‹ä»£ç è¦æ˜¯å¯¹ sync.map åšä¸€äº›å¯èƒ½å¼•å‘å†²çªçš„å¹¶å‘æ“ä½œå°±æ›´å¥½äº†ã€‚","like_count":0,"discussions":[{"author":{"id":1026643,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/aa/53/768aec0a.jpg","nickname":"éƒæ—","note":"","ucode":"F66BA62BA56FFA","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":480301,"discussion_content":"è¿™ä¸ªä¸å®¹æ˜“å¤ç°ï¼Œå°¤å…¶å¯¹äºç®€å•çš„ç¤ºä¾‹æ¥è¯´ã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1578306434,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":159849,"user_name":"çŒ«ä¹","can_delete":false,"product_type":"c1","uid":1198901,"ip_address":"","ucode":"6D3DCB786AFD8C","user_header":"https://static001.geekbang.org/account/avatar/00/12/4b/35/28fa7039.jpg","comment_is_top":false,"comment_ctime":1575810815,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1575810815","product_id":100013101,"comment_content":"æ‰“å¡","like_count":0},{"had_liked":false,"id":143673,"user_name":"ç¾½ä»”","can_delete":false,"product_type":"c1","uid":1206126,"ip_address":"","ucode":"F364B23E857DB2","user_header":"https://static001.geekbang.org/account/avatar/00/12/67/6e/d59a413f.jpg","comment_is_top":false,"comment_ctime":1571754557,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1571754557","product_id":100013101,"comment_content":"Fine.","like_count":0},{"had_liked":false,"id":89822,"user_name":"ä¹ˆä¹å„¿","can_delete":false,"product_type":"c1","uid":1248786,"ip_address":"","ucode":"4740501C87379F","user_header":"https://static001.geekbang.org/account/avatar/00/13/0e/12/0398de50.jpg","comment_is_top":false,"comment_ctime":1556273068,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1556273068","product_id":100013101,"comment_content":"æ‰“å¡!","like_count":0},{"had_liked":false,"id":76419,"user_name":"show","can_delete":false,"product_type":"c1","uid":1044073,"ip_address":"","ucode":"CA742454B6F828","user_header":"https://static001.geekbang.org/account/avatar/00/0f/ee/69/39d0a2b2.jpg","comment_is_top":false,"comment_ctime":1552609342,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1552609342","product_id":100013101,"comment_content":"æ‰“å¡ï¼Œè¯»å®Œäº†ï¼Œè¿˜éœ€è¦å®è·µä¸‹","like_count":0}]}