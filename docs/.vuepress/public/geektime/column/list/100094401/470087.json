{"id":470087,"title":"27ï½œè‡ªå®šä¹‰æ¸²æŸ“å™¨ï¼šå¦‚ä½•å®ç°Vueçš„è·¨ç«¯æ¸²æŸ“ ï¼Ÿ","content":"<p>ä½ å¥½ï¼Œæˆ‘æ˜¯å¤§åœ£ã€‚</p><p>ä¸Šä¸€è®²æˆ‘ä»¬è®²å®Œäº†ç»„ä»¶åº“çš„æ ¸å¿ƒçŸ¥è¯†ç‚¹ï¼Œè¿™ä¸€è®²æˆ‘ä»¬æ¥å­¦ä¹ ä¸€ä¸ªå«Vue 3çš„è¿›é˜¶çŸ¥è¯†ç‚¹ï¼šè‡ªå®šä¹‰æ¸²æŸ“å™¨ï¼Œè¿™ä¸ªåŠŸèƒ½å¯ä»¥è‡ªå®šä¹‰Vueæ¸²æŸ“çš„é€»è¾‘ã€‚</p><p>åœ¨ç»™ä½ è®²æ¸…æ¥šåŸç†ä¹‹åï¼Œæˆ‘è¿˜ä¼šå¸¦ä½ ä¸€èµ·å®ç°ä¸€ä¸ªCanvasçš„æ¸²æŸ“å™¨å®é™…ä¸Šæ‰‹ä½“éªŒä¸€ä¸‹ã€‚</p><h2>ä»€ä¹ˆæ˜¯æ¸²æŸ“å™¨</h2><p>æˆ‘ä»¬éƒ½çŸ¥é“ï¼ŒVueå†…éƒ¨çš„ç»„ä»¶æ˜¯ä»¥è™šæ‹Ÿdomå½¢å¼å­˜åœ¨çš„ã€‚ä¸‹é¢çš„ä»£ç å°±æ˜¯ä¸€ä¸ªå¾ˆå¸¸è§çš„è™šæ‹ŸDomï¼Œç”¨å¯¹è±¡çš„æ–¹å¼å»æè¿°ä¸€ä¸ªé¡¹ç›®ã€‚ç›¸æ¯”domæ ‡ç­¾ç›¸æ¯”ï¼Œè¿™ç§å½¢å¼å¯ä»¥è®©æ•´ä¸ªVueé¡¹ç›®è„±ç¦»æµè§ˆå™¨çš„é™åˆ¶ï¼Œæ›´æ–¹ä¾¿åœ°å®ç°Vuejsçš„è·¨ç«¯ã€‚</p><pre><code class=\"language-javascript\">{\n  tag: 'div',\n  props: {\n    id: 'app'\n  },\n  chidren: [\n    {\n      tag: Container,\n      props: {\n        className: 'el-container'\n      },\n      chidren: [\n        'å“ˆå–½å°è€å¼Ÿ!!!'\n      ]\n    }\n  ]\n}\n</code></pre><p>æ¸²æŸ“å™¨æ˜¯å›´ç»•è™šæ‹ŸDomå­˜åœ¨çš„ã€‚åœ¨æµè§ˆå™¨ä¸­ï¼Œæˆ‘ä»¬æŠŠè™šæ‹ŸDomæ¸²æŸ“æˆçœŸå®çš„Domå¯¹è±¡ï¼ŒVueæºç å†…éƒ¨æŠŠä¸€ä¸ªæ¡†æ¶é‡Œæ‰€æœ‰å’Œå¹³å°ç›¸å…³çš„æ“ä½œï¼ŒæŠ½ç¦»æˆäº†ç‹¬ç«‹çš„æ–¹æ³•ã€‚æ‰€ä»¥ï¼Œæˆ‘ä»¬åªéœ€è¦å®ç°ä¸‹é¢è¿™äº›æ–¹æ³•ï¼Œå°±å¯ä»¥å®ç°Vue 3åœ¨ä¸€ä¸ªå¹³å°çš„æ¸²æŸ“ã€‚</p><p>é¦–å…ˆç”¨createElementåˆ›å»ºæ ‡ç­¾ï¼Œè¿˜æœ‰ç”¨createTextåˆ›å»ºæ–‡æœ¬ã€‚åˆ›å»ºä¹‹åå°±éœ€è¦ç”¨insertæ–°å¢å…ƒç´ ï¼Œé€šè¿‡remoteåˆ é™¤å…ƒç´ ï¼Œé€šè¿‡setTextæ›´æ–°æ–‡æœ¬å’ŒpatchPropsä¿®æ”¹å±æ€§ã€‚ç„¶åå†å®ç°parentNodeã€nextSiblingç­‰æ–¹æ³•å®ç°èŠ‚ç‚¹çš„æŸ¥æ‰¾å…³ç³»ã€‚å®Œæˆè¿™äº›å·¥ä½œï¼Œç†è®ºä¸Šå°±å¯ä»¥åœ¨ä¸€ä¸ªå¹³å°å†…å®ç°ä¸€ä¸ªåº”ç”¨äº†ã€‚</p><!-- [[[read_end]]] --><p>åœ¨Vue 3ä¸­çš„runtime-coreæ¨¡å—ï¼Œå°±å¯¹å¤–æš´éœ²äº†è¿™äº›æ¥å£ï¼Œruntime-coreå†…éƒ¨åŸºäºè¿™äº›å‡½æ•°å®ç°äº†æ•´ä¸ªVueå†…éƒ¨çš„æ‰€æœ‰æ“ä½œï¼Œç„¶ååœ¨runtime-domä¸­ä¼ å…¥ä»¥ä¸Šæ‰€æœ‰æ–¹æ³•ã€‚</p><p>ä¸‹é¢çš„ä»£ç å°±æ˜¯Vueä»£ç æä¾›æµè§ˆå™¨ç«¯æ“ä½œçš„å‡½æ•°ï¼Œè¿™äº›DOMç¼–ç¨‹æ¥å£å®Œæˆäº†æµè§ˆå™¨ç«¯å¢åŠ ã€æ·»åŠ å’Œåˆ é™¤æ“ä½œï¼Œè¿™äº›APIéƒ½æ˜¯æµè§ˆå™¨ç«¯ç‹¬æœ‰çš„ï¼Œå¦‚æœä¸€ä¸ªæ¡†æ¶å¼ºä¾èµ–äºè¿™äº›å‡½æ•°ï¼Œé‚£å°±åªèƒ½åœ¨æµè§ˆå™¨ç«¯è¿è¡Œã€‚</p><pre><code class=\"language-javascript\">export const nodeOps: Omit&lt;RendererOptions&lt;Node, Element&gt;, 'patchProp'&gt; = {\n  //æ’å…¥å…ƒç´ \n  insert: (child, parent, anchor) =&gt; {\n    parent.insertBefore(child, anchor || null)\n  },\n  // åˆ é™¤å…ƒç´ \n  remove: child =&gt; {\n    const parent = child.parentNode\n    if (parent) {\n      parent.removeChild(child)\n    }\n  },\n  // åˆ›å»ºå…ƒç´ \n  createElement: (tag, isSVG, is, props): Element =&gt; {\n    const el = isSVG\n      ? doc.createElementNS(svgNS, tag)\n      : doc.createElement(tag, is ? { is } : undefined)\n\n    if (tag === 'select' &amp;&amp; props &amp;&amp; props.multiple != null) {\n      ;(el as HTMLSelectElement).setAttribute('multiple', props.multiple)\n    }\n\n    return el\n  }\n  //...å…¶ä»–æ“ä½œå‡½æ•°\n}\n</code></pre><p>å¦‚æœä¸€ä¸ªæ¡†æ¶æƒ³è¦å®ç°å®ç°è·¨ç«¯çš„åŠŸèƒ½ï¼Œé‚£ä¹ˆæ¸²æŸ“å™¨æœ¬èº«ä¸èƒ½ä¾èµ–ä»»ä½•å¹³å°ä¸‹ç‰¹æœ‰çš„æ¥å£ã€‚</p><p>åœ¨åé¢çš„ä»£ç ä¸­ï¼Œæˆ‘ä»¬é€šè¿‡createRendererå‡½æ•°åŒºåˆ›å»ºäº†ä¸€ä¸ªæ¸²æŸ“å™¨ã€‚é€šè¿‡å‚æ•°optionsè·å–å¢åˆ æ”¹æŸ¥æ‰€æœ‰çš„å‡½æ•°ä»¥åï¼Œåœ¨å†…éƒ¨çš„renderã€mountã€patchç­‰å‡½æ•°ä¸­ï¼Œéœ€è¦å»æ¸²æŸ“ä¸€ä¸ªå…ƒç´ çš„æ—¶å€™ï¼Œå°±å¯ä»¥é€šè¿‡option.createElementå’Œoption.insertæ¥å®ç°ã€‚</p><p>è¿™æ®µä»£ç ç»™ä½ å±•ç°çš„æ˜¯æ ¸å¿ƒé€»è¾‘ï¼Œå®Œæ•´ç‰ˆæœ¬ä½ å¯ä»¥çœ‹ä¸€ä¸‹<a href=\"https://github.com/vuejs/vue-next/blob/master/packages/runtime-core/src/renderer.ts#L334\">Vue 3çš„æºç </a>ã€‚</p><pre><code class=\"language-javascript\">export default function createRenderer(options) {\n  const {\n\t    insert: hostInsert,\n\t    remove: hostRemove,\n\t    patchProp: hostPatchProp,\n\t    createElement: hostCreateElement,\n\t    createText: hostCreateText,\n\t    createComment: hostCreateComment,\n\t    setText: hostSetText,\n\t    setElementText: hostSetElementText,\n\t    parentNode: hostParentNode,\n\t    nextSibling: hostNextSibling,\n\t    setScopeId: hostSetScopeId = NOOP,\n\t    cloneNode: hostCloneNode,\n\t    insertStaticContent: hostInsertStaticContent\n   } = options\n\n&nbsp; function render(vnode, container) {  }\n\n&nbsp; function mount(vnode, container, isSVG, refNode) {  }\n\n&nbsp; function mountElement(vnode, container, isSVG, refNode) {  }\n\n&nbsp; function mountText(vnode, container) {  }\n\n&nbsp; function patch(prevVNode, nextVNode, container) {  }\n\n&nbsp; function replaceVNode(prevVNode, nextVNode, container) {  }\n&nbsp; function patchElement(prevVNode, nextVNode, container) {  }\n&nbsp; function patchChildren(\n&nbsp; &nbsp; prevChildFlags,\n&nbsp; &nbsp; nextChildFlags,\n&nbsp; &nbsp; prevChildren,\n&nbsp; &nbsp; nextChildren,\n&nbsp; &nbsp; container\n&nbsp; ) {  }\n\n&nbsp; function patchText(prevVNode, nextVNode) {  }\n&nbsp; function patchComponent(prevVNode, nextVNode, container) {  }\n\n&nbsp; return { render }\n}\n</code></pre><p>åœ¨æ¯ä¸ªå‡½æ•°å®ç°çš„å†…éƒ¨ï¼Œæ¯”å¦‚mountElemntï¼Œæˆ‘ä»¬ä¹‹å‰çš„å®ç°æ–¹å¼æ˜¯è°ƒç”¨æµè§ˆå™¨çš„APIåˆ›å»ºã€‚</p><pre><code class=\"language-javascript\">function mountElement(vnode, container, isSVG, refNode) {\n&nbsp; const el = isSVG\n&nbsp; &nbsp; ? document.createElementNS(....)\n&nbsp; &nbsp; : document.createElement(vnode.tag)\n}\n\n</code></pre><p>å¯¹æ¯”ä¸€ä¸‹ï¼Œç»è¿‡æ¸²æŸ“å™¨æŠ½ç¦»ä¹‹åï¼Œå†…éƒ¨çš„mountElmenetå°±ä¼šæŠŠæ‰€æœ‰documentçš„æ“ä½œå…¨éƒ¨æ¢æˆoptionsä¼ é€’è¿›æ¥çš„hostCreateå‡½æ•°ã€‚</p><pre><code class=\"language-javascript\">function mountElement(vnode, container, isSVG, refNode) {\n&nbsp; const el = hostCreateElement(vnode.tag, isSVG)\n}\n</code></pre><p>ç„¶åï¼Œæˆ‘ä»¬ä½¿ç”¨åé¢çš„ä»£ç åˆ›å»ºä¸€ä¸ªå…·ä½“å¹³å°çš„æ¸²æŸ“å™¨ï¼Œè¿™ä¹Ÿæ˜¯Vue 3ä¸­çš„runtime-domåŒ…ä¸»è¦åšçš„äº‹ã€‚äº†è§£äº†Vueä¸­è‡ªå®šä¹‰æ¸²æŸ“å™¨çš„å®ç°æ–¹å¼åï¼Œæˆ‘ä»¬è¿˜å¯ä»¥åŸºäºVue 3çš„runtime-coreåŒ…å°è£…å…¶ä»–å¹³å°çš„æ¸²æŸ“å™¨ï¼Œè®©å…¶ä»–å¹³å°ä¹Ÿèƒ½ä½¿ç”¨Vueå†…éƒ¨çš„å“åº”å¼å’Œç»„ä»¶åŒ–ç­‰ä¼˜ç§€çš„ç‰¹æ€§ã€‚</p><pre><code class=\"language-javascript\">const { render } = createRenderer({\n&nbsp; nodeOps: {\n&nbsp; &nbsp; createElement() {   },\n&nbsp; &nbsp; createText() {   }\n&nbsp; &nbsp; // more...\n&nbsp; },\n&nbsp; patchData\n})\n\n</code></pre><h2>è‡ªå®šä¹‰æ¸²æŸ“</h2><p>è¯´å®Œäº†æ¸²æŸ“å™¨åˆ›å»ºï¼Œæˆ‘ä»¬å†æ¥çœ‹çœ‹è‡ªå®šä¹‰æ¸²æŸ“ã€‚</p><p>è‡ªå®šä¹‰æ¸²æŸ“å™¨è®©Vueè„±ç¦»äº†æµè§ˆå™¨çš„é™åˆ¶ï¼Œæˆ‘ä»¬åªéœ€è¦å®ç°å¹³å°å†…éƒ¨çš„å¢åˆ æ”¹æŸ¥å‡½æ•°åï¼Œå°±å¯ä»¥ç›´æ¥å¯¹æ¥Vue 3ã€‚æ¯”æ–¹è¯´ï¼Œæˆ‘ä»¬å¯ä»¥æŠŠVueæ¸²æŸ“åˆ°å°ç¨‹åºå¹³å°ï¼Œå®ç°Vue 3-minippï¼›ä¹Ÿå¯ä»¥æ¸²æŸ“åˆ°Canvasï¼Œå®ç°vue 3-canvasï¼ŒæŠŠè™šæ‹Ÿdomæ¸²æŸ“æˆCanvasï¼›ç”šè‡³è¿˜å¯ä»¥å°è¯•æŠŠVue 3æ¸²æŸ“åˆ°threee.jsä¸­ï¼Œåœ¨3Dä¸–ç•Œä½¿ç”¨å“åº”å¼å¼€å‘ã€‚</p><p>æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬ä¸€èµ·å°è¯•å®ç°ä¸€ä¸ªCanvasçš„æ¸²æŸ“å™¨ã€‚å…·ä½“æ“ä½œæ˜¯è¿™æ ·çš„ï¼Œæˆ‘ä»¬åœ¨é¡¹ç›®çš„srcç›®å½•ä¸‹æ–°å»ºrenderer.jsï¼Œé€šè¿‡è¿™ä¸ªæ–‡ä»¶å®ç°ä¸€ä¸ªç®€æ˜“çš„Canvasæ¸²æŸ“é€»è¾‘ã€‚Canvaså¹³å°ä¸­æ“ä½œçš„æ–¹å¼ç›¸å¯¹ç®€å•ï¼Œæ²¡æœ‰å¤ªå¤šèŠ‚ç‚¹çš„æ¦‚å¿µï¼Œæˆ‘ä»¬å¯ä»¥æŠŠæ•´ä¸ªCanvasç»´æŠ¤æˆä¸€ä¸ªå¯¹è±¡ï¼Œæ¯æ¬¡æ“ä½œçš„æ—¶å€™ç›´æ¥æŠŠCanvasé‡ç»˜ä¸€ä¸‹å°±å¯ä»¥äº†ã€‚</p><pre><code class=\"language-javascript\">import { createRenderer } from '@vue/runtime-core'\nconst { createApp: originCa } = createRenderer({\n  insert: (child, parent, anchor) =&gt; {\n  },\n  createElement(type, isSVG, isCustom) {\n  },\n  setElementText(node, text) {\n  },\n  patchProp(el, key, prev, next) {\n  },\n});\n</code></pre><p>ä¸‹é¢çš„ä»£ç ä¸­æˆ‘ä»¬å®ç°äº†drawå‡½æ•°ï¼Œè¿™é‡Œæˆ‘ä»¬å°±æ˜¯ç”¨Canvasçš„æ“ä½œæ–¹æ³•<strong>é€’å½’</strong>åœ°æŠŠCanvaså¯¹è±¡æ¸²æŸ“åˆ°Canvasæ ‡ç­¾å†…éƒ¨ã€‚</p><pre><code class=\"language-javascript\">let ctx\nfunction draw(ele, isChild) {\n  if (!isChild) {\n    ctx.clearRect(0, 0, 500, 500)\n  }\n\n  ctx.fillStyle = ele.fill || 'white'\n  ctx.fillRect(...ele.pos)\n  if (ele.text) {\n    ctx.fillStyle = ele.color || 'white'\n    ele.fontSize = ele.type == \"h1\" ? 20 : 12\n    ctx.font = (ele.fontSize || 18) + 'px serif'\n    ctx.fillText(ele.text, ele.pos[0] + 10, ele.pos[1] + ele.fontSize)\n  }\n  ele.child &amp;&amp; ele.child.forEach(c =&gt; {\n    console.log('child:::', c)\n    draw(c, true)\n  })\n\n}\n</code></pre><p>ç”±äºæˆ‘ä»¬ä¸»ä½“éœ€è¦ç»´æŠ¤çš„é€»è¾‘å°±æ˜¯å¯¹äºå¯¹è±¡çš„æ“ä½œï¼Œæ‰€ä»¥åˆ›å»ºå’Œæ›´æ–°æ“ä½œç›´æ¥æ“ä½œå¯¹è±¡å³å¯ã€‚æ–°å¢insertéœ€è¦ç»´æŠ¤parentå’Œchildå…ƒç´ ã€‚å¦å¤–ï¼Œæ’å…¥çš„æ—¶å€™ä¹Ÿéœ€è¦è°ƒç”¨drawå‡½æ•°ï¼Œå¹¶ä¸”éœ€è¦ç›‘å¬onclickäº‹ä»¶ã€‚</p><pre><code class=\"language-javascript\">const { createApp: originCa } = createRenderer({\n  insert: (child, parent, anchor) =&gt; {\n    if (typeof child == 'string') {\n      parent.text = child\n    } else {\n      child.parent = parent\n      if (!parent.child) {\n        parent.child = [child]\n      } else {\n        parent.child.push(child)\n      }\n    }\n    if (parent.nodeName) {\n      draw(child)\n      if (child.onClick) {\n        ctx.canvas.addEventListener('click', () =&gt; {\n          child.onClick()\n          setTimeout(() =&gt; {\n            draw(child)\n          })\n        }, false)\n      }\n    }\n  },\n  createElement(type, isSVG, isCustom) {\n    return {\n      type\n    }\n  },\n  setElementText(node, text) {\n    node.text = text\n  },\n  patchProp(el, key, prev, next) {\n    el[key] = next\n  },\n\n});\n</code></pre><p>ç°åœ¨æˆ‘ä»¬æ¥åˆ°src/main.jsä¸­ï¼Œè¿™æ—¶å€™å°±ä¸èƒ½ç›´æ¥ä»vueä¸­å¼•å…¥createAppäº†ï¼Œè€Œæ˜¯éœ€è¦ä»runtime-coreä¸­å¯¼å…¥createRendererã€‚</p><p>æ¥ä¸‹æ¥ï¼Œé€šè¿‡createRendererç”¨æˆ‘ä»¬è‡ªå·²å®šä¹‰çš„rendererå»åˆ›å»ºcreateAppï¼Œå¹¶ä¸”é‡å†™mountå‡½æ•°ã€‚åœ¨Canvasçš„mountä¸­ï¼Œæˆ‘ä»¬éœ€è¦åˆ›å»ºCanvasæ ‡ç­¾å¹¶ä¸”æŒ‚è½½åˆ°Appä¸Šã€‚</p><pre><code class=\"language-javascript\">import { createRenderer } from '@vue/runtime-core'\nconst { createApp: originCa } = createRenderer({\n\n}ï¼‰\nfunction createApp(...args) {\n  const app = originCa(...args)\n  return {\n    mount(selector) {\n      const canvas = document.createElement('canvas')\n      canvas.width = window.innerWidth\n      canvas.height = window.innerHeight\n      document.querySelector(selector).appendChild(canvas)\n      ctx = canvas.getContext('2d')\n      app.mount(canvas)\n    }\n  }\n}\n</code></pre><p>ä¸‹ä¸€æ­¥è¿›å…¥src/App.vueä¸­ï¼Œæˆ‘ä»¬å°±å¯ä»¥åœ¨Vueç»„ä»¶ä¸­ä½¿ç”¨refç­‰å“åº”å¼çš„å†™æ³•äº†ã€‚æˆ‘ä»¬å®ç°äº†é€šè¿‡refè¿”å›çš„å“åº”å¼å¯¹è±¡ï¼Œæ¸²æŸ“Canvaså†…éƒ¨çš„æ–‡å­—å’Œé«˜åº¦ï¼Œå¹¶ä¸”ç‚¹å‡»çš„æ—¶å€™è¿˜å¯ä»¥ä¿®æ”¹æ–‡å­—ã€‚å®Œæˆä¸Šé¢çš„æ“ä½œï¼Œæˆ‘ä»¬å°±å®ç°äº†Canvaså¹³å°çš„åŸºæœ¬æ¸²æŸ“ã€‚</p><pre><code class=\"language-xml\">&lt;template&gt;\n&lt;div @click=\"setName('vue3çœŸæ£’')\" :pos=\"[10,10,300,300]\" fill=\"#eee\"&gt;\n    &lt;h1 :pos=\"[20,20,200,100]\" fill=\"red\" color=\"#000\"&gt;ç´¯åŠ å™¨{{count}}&lt;/h1&gt;\n    &lt;span :pos=\"pos\" fill=\"black\" &gt;å“ˆå–½{{name}}&lt;/span&gt;\n&lt;/div&gt;\n\n\n\n&lt;/template&gt;\n\n&lt;script setup&gt;\n\nimport {ref} from 'vue'\nconst name = ref('vue3å…¥é—¨')\nconst pos = ref([20,120,200,100])\nconst count = ref(1)\nconst setName = (n)=&gt;{\n&nbsp; name.value = n\n&nbsp; pos.value[1]+=20\n&nbsp; count.value+=2\n}\n&lt;/script&gt;\n</code></pre><p>ä¸Šé¢çš„ä»£ç åœ¨æµè§ˆå™¨é‡Œå°±ä¼šæœ‰ä¸‹å›¾çš„æ˜¾ç¤ºæ•ˆæœã€‚æˆ‘ä»¬ç‚¹å‡»Canvasåï¼Œæ–‡æ¡ˆå°±ä¼šæ˜¾ç¤ºä¸ºâ€œå“ˆå–½vue3çœŸæ£’â€ï¼Œå¹¶ä¸”é»‘è‰²æ–¹å—å’Œçº¢è‰²æ–¹å—çš„è·ç¦»ä¹Ÿä¼šå˜å¤§ã€‚<br>\n<img src=\"https://static001.geekbang.org/resource/image/b4/7b/b466ca102ef94ebce2d05c865ca4637b.png?wh=1920x992\" alt=\"å›¾ç‰‡\"></p><p>åŸºäºè¿™ä¸ªåŸç†ï¼Œæˆ‘ä»¬å…¶å®å¯ä»¥åšå¾ˆå¤šæœ‰æ„æ€çš„å°è¯•ï¼Œç¤¾åŒºä¹Ÿä¹Ÿæœ‰è¶Šæ¥è¶Šå¤šå¼€æºçš„Vue 3çš„è‡ªå®šä¹‰æ¸²æŸ“å™¨ï¼Œæ¯”å¦‚å°ç¨‹åºè·¨ç«¯æ¡†æ¶uni-appï¼ŒVugelå¯ä»¥ä½¿ç”¨Vueæ¸²æŸ“Webglç­‰ï¼Œä½ ä¹Ÿå¯ä»¥åŠ¨æ‰‹å¤šå¤šä½“éªŒã€‚</p><p>æ¯”å¦‚ä¸‹é¢çš„ä»£ç ä¸­ï¼Œæˆ‘ä»¬å¯¹three.jsè¿›è¡Œä¸€ä¸ªæ¸²æŸ“çš„å°è¯•ã€‚å®ƒçš„å®ç°é€»è¾‘å’ŒCanvasæ¯”è¾ƒç±»ä¼¼ï¼Œé€šè¿‡å¯¹äºå¯¹è±¡çš„ç»´æŠ¤å’Œdrawå‡½æ•°å®ç°æœ€ç»ˆçš„ç»˜åˆ¶ã€‚åœ¨drawå‡½æ•°å†…éƒ¨ï¼Œæˆ‘ä»¬è°ƒç”¨three.jsçš„æ“ä½œæ–¹æ³•å»åˆ›å»ºcameraï¼Œsenceï¼Œgeometryç­‰æ¦‚å¿µï¼Œæœ€åå¯¹å¤–æš´éœ²three.jsçš„createAppå‡½æ•°ã€‚</p><pre><code class=\"language-xml\">import { createRenderer } from '@vue/runtime-core'\nimport * as THREE from 'three'\nimport {nextTick} from '@vue/runtime-core'\n\nlet renderer\n\nfunction draw(obj) {\n    const {camera,cameraPos, scene, geometry,geometryArg,material,mesh,meshY,meshX} = obj\n    if([camera,cameraPos, scene, geometry,geometryArg,material,mesh,meshY,meshX].filter(v=&gt;v).length&lt;9){\n        return \n    }\n    let cameraObj = new THREE[camera]( 40, window.innerWidth / window.innerHeight, 0.1, 10 )\n    Object.assign(cameraObj.position,cameraPos)\n\n    let sceneObj = new THREE[scene]()\n\n    let geometryObj = new THREE[geometry]( ...geometryArg)\n    let materialObj = new THREE[material]()\n\n    let meshObj = new THREE[mesh]( geometryObj, materialObj )\n    meshObj.rotation.x = meshX\n    meshObj.rotation.y = meshY\n    sceneObj.add( meshObj )\n    renderer.render( sceneObj, cameraObj );\n\n}\n\nconst { createApp: originCa } = createRenderer({\n  insert: (child, parent, anchor) =&gt; {\n    if(parent.domElement){\n        draw(child)\n    }\n  },\n  createElement(type, isSVG, isCustom) {\n    return {\n      type\n    }\n  },\n  setElementText(node, text) {\n  },\n  patchProp(el, key, prev, next) {\n    el[key] = next\n    draw(el)\n  },\n  parentNode: node =&gt; node,\n  nextSibling: node =&gt; node,\n  createText: text =&gt; text,\n  remove:node=&gt;node\n\n});\nfunction createApp(...args) {\n  const app = originCa(...args)\n  return {\n    mount(selector) {\n        renderer = new THREE.WebGLRenderer( { antialias: true } );\n        renderer.setSize( window.innerWidth, window.innerHeight );\n        document.body.appendChild( renderer.domElement );\n        app.mount(renderer)\n    }\n  }\n}\nexport { createApp }\n\n\n\n</code></pre><p>ç„¶åæˆ‘ä»¬åœ¨App.vueä¸­ï¼Œä½¿ç”¨ä¸‹é¢çš„ä»£ç æ¸²æŸ“å‡ºä¸€ä¸ªç«‹æ–¹ä½“ï¼Œå¹¶ä¸”é€šè¿‡refå“åº”å¼å¯¹è±¡æ§åˆ¶ç«‹æ–¹ä½“åç§»çš„ç›‘ç£ï¼Œå†é€šè¿‡setIntervalå®ç°ç«‹æ–¹ä½“çš„åŠ¨ç”»ï¼Œå®ç°ä¸‹å›¾çš„åè½¬æ•ˆæœã€‚</p><pre><code class=\"language-xml\">&lt;template&gt;\n&nbsp; &nbsp; &lt;div\n&nbsp; &nbsp; &nbsp; &nbsp; camera=\"PerspectiveCamera\"\n&nbsp; &nbsp; &nbsp; &nbsp; :cameraPos={z:1}\n&nbsp; &nbsp; &nbsp; &nbsp; scene=\"Scene\"\n&nbsp; &nbsp; &nbsp; &nbsp; geometry=\"BoxGeometry\"\n&nbsp; &nbsp; &nbsp; &nbsp; :geometryArg=\"[0.2,0.2,0.2]\"\n&nbsp; &nbsp; &nbsp; &nbsp; material=\"MeshNormalMaterial\"\n&nbsp; &nbsp; &nbsp; &nbsp; mesh=\"Mesh\"\n&nbsp; &nbsp; &nbsp; &nbsp; :meshY=\"y\"\n&nbsp; &nbsp; &nbsp; &nbsp; :meshX=\"x\"\n&nbsp; &nbsp; &gt;\n&nbsp; &nbsp; &lt;/div&gt;\n\n&lt;/template&gt;\n\n&lt;script&gt;\nimport {ref} from 'vue'\nexport default {\n&nbsp; &nbsp; setup(){\n&nbsp; &nbsp; &nbsp; &nbsp; const y = ref(0.3)\n&nbsp; &nbsp; &nbsp; &nbsp; const x = ref(0.3)\n&nbsp; &nbsp; &nbsp; &nbsp; setInterval(()=&gt;{\n&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; y.value+=0.3\n&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; x.value+=0.5\n&nbsp; &nbsp; &nbsp; &nbsp; },100)\n&nbsp; &nbsp; &nbsp; &nbsp; return {y,x}\n&nbsp; &nbsp; }\n}\n&lt;/script&gt;\n</code></pre><p>åè½¬æ•ˆæœæ¼”ç¤ºå¦‚ä¸‹ï¼š<br>\n<img src=\"https://static001.geekbang.org/resource/image/b0/4f/b0b20b2a314bcf650b8b56256bdf804f.gif?wh=1182x761\" alt=\"å›¾ç‰‡\"></p><p>æˆ‘ä»¬è¿˜å¯ä»¥åœ¨Canvasçš„å°è£…ä¸Šæ›´è¿›ä¸€æ­¥ï¼Œå¹¶ä¸”å®ç°å¯¹ä¸€äº›Canvaså·²æœ‰æ¡†æ¶Pixi.jsçš„å°è£…ï¼Œè¿™æ ·å°±å¯ä»¥é€šè¿‡Vue 3çš„å“åº”å¼çš„å¼€å‘æ–¹å¼ï¼Œå¿«é€Ÿå¼€å‘ä¸€ä¸ªå°æ¸¸æˆã€‚</p><p>ä¸‹é¢çš„ä»£ç ä¸­å°±æ˜¯é’ˆå¯¹Pixi.jså®ç°çš„å°è£…å‡½æ•°ï¼Œä½ å¯ä»¥çœ‹ä¸€ä¸‹ã€‚</p><pre><code class=\"language-xml\"> import {Graphics} from \"PIXI.js\";\n\nexport const getNodeOps = (app) =&gt; {\n  return {\n    insert: (child, parent, anchor) =&gt; {\n      parent.addChild(child);\n    },\n\n    remove: (child) =&gt; {\n      const parent = child.parentNode;\n      if (parent) {\n        parent.removeChild(child);\n      }\n    },\n\n    createElement: (tag, isSVG, is) =&gt; {\n      let element;\n      if (tag === \"Rectangle\") {\n        // åˆ›å»ºä¸€ä¸ªçŸ©å½¢\n        element = new window.PIXI.Graphics();\n        element.lineStyle(4, 0xff3300, 1);\n        element.beginFill(0x66ccff);\n        element.drawRect(0, 0, 64, 64);\n        element.endFill();\n        element.x = 0;\n        element.y = 0;\n        // Opt-in to interactivity\n        element.interactive = true;\n\n        // Shows hand cursor\n        element.buttonMode = true;\n      } else if (tag === \"Sprite\") {\n        element = new window.PIXI.Sprite();\n        element.x = 0;\n        element.y = 0;\n      } else if (tag === \"Container\") {\n        element = new window.PIXI.Container();\n        element.x = 0;\n        element.y = 0;\n      }\n\n      return element;\n    },\n\n    createText: (text) =&gt; doc.createTextNode(text),\n\n    createComment: (text) =&gt; {\n    //   console.log(text);\n    },\n\n    setText: (node, text) =&gt; {\n      node.nodeValue = text;\n    },\n\n    setElementText: (el, text) =&gt; {\n      el.textContent = text;\n    },\n\n    parentNode: (node) =&gt; node.parentNode,\n\n    nextSibling: (node) =&gt; node.nextSibling,\n\n    querySelector: (selector) =&gt; doc.querySelector(selector),\n\n    setScopeId(el, id) {\n      el.setAttribute(id, \"\");\n    },\n\n    cloneNode(el) {\n      return el.cloneNode(true);\n    },\n  };\n};\n</code></pre><p>Pixiä¸­çš„å±æ€§ä¿®æ”¹å¯ä»¥ä½¿ç”¨ä¸‹é¢çš„ä»£ç ï¼Œåˆ¤æ–­xã€yã€widthå’Œonå±æ€§ä¸åŒçš„æ“ä½œï¼Œå°±æ˜¯ç”¨å“åº”å¼åŒ…è£¹äº†Pixiçš„å¯¹è±¡ã€‚å…³äºVue 3å’ŒPixiå®ç°çš„ä»£ç æ•ˆæœï¼Œä½ å¯ä»¥åœ¨<a href=\"https://github.dev/shengxinjing/vue3-vs-vue2/blob/0911af848941c2eeb2783c32c1907fd286134be1/vue3-runtime-canvas/index.js\">GitHub</a>çœ‹åˆ°å…¨éƒ¨çš„æºç ã€‚</p><pre><code class=\"language-xml\">export const patchProp = (\n  el,\n  key,\n  prevValue,\n  nextValue,\n  isSVG = false,\n) =&gt; {\n  switch (key) {\n    case \"x\":\n    case \"y\":\n    case \"width\":\n    case \"height\":\n        el[key] = nextValue;\n        break;\n    case \"on\":\n      Object.keys(nextValue).forEach((eventName) =&gt; {\n        const callback = nextValue[eventName];\n        el.on(eventName, callback);\n      });\n      break;\n    case \"texture\":\n        let texture = PIXI.Texture.from(nextValue);\n        el.texture = texture;\n        break;\n  }\n};\n\n</code></pre><h2>æ€»ç»“</h2><p>ä»Šå¤©èŠçš„å†…å®¹åˆ°æ­¤å°±ç»“æŸäº†ï¼Œæˆ‘ä»¬æ¥æ€»ç»“ä¸€ä¸‹ä»Šå¤©å­¦åˆ°çš„çŸ¥è¯†ç‚¹ã€‚</p><p>é¦–å…ˆæˆ‘ä»¬äº†è§£äº†è‡ªå®šä¹‰æ¸²æŸ“å™¨çš„åŸç†ï¼Œå°±æ˜¯<strong>æŠŠæ‰€æœ‰çš„å¢åˆ æ”¹æŸ¥æ“ä½œæš´éœ²å‡ºå»ï¼Œä½¿ç”¨çš„æ—¶å€™ä¸éœ€è¦çŸ¥é“å†…éƒ¨çš„å®ç°ç»†èŠ‚ï¼Œæˆ‘ä»¬åªéœ€è¦é’ˆå¯¹æ¯ä¸ªå¹³å°ä½¿ç”¨ä¸åŒçš„APIå³å¯</strong>ã€‚</p><p>ä½ å¯ä»¥è¿™æ ·ç†è§£ï¼Œå°±åƒæ­¦ä¾ å°è¯´ä¸­é«˜æ‰‹å¯ä»¥é€šè¿‡ç»™ä½ ä¼ è¾“å†…åŠ›çš„æ–¹å¼æ§åˆ¶ä½ è¿›è¡Œæ¯”æ­¦ã€‚æˆ‘ä»¬æ‰“å‡ºå»çš„æ¯æ‹›æ¯å¼éƒ½æ˜¯æ¥æºäºèƒŒåçš„é«˜æ‰‹ï¼Œåªä¸è¿‡è‡ªå·±åšäº†ç®€å•çš„é€‚é…ã€‚åœ¨Vueæ¸²æŸ“å™¨çš„è®¾è®¡ä¸­å°±æŠŠdocumentæ‰€æœ‰çš„æ“ä½œéƒ½æŠ½ç¦»æˆäº†nodeOpsï¼Œå¹¶ä¸”é€šè¿‡è°ƒç”¨Vueçš„createRendererå‡½æ•°åˆ›å»ºå¹³å°çš„æ¸²æŸ“å™¨ã€‚</p><p>è¿™æ ·ä¸€æ¥ï¼Œåªè¦æˆ‘ä»¬å®ç°äº†Canvaså¹³å°çš„å¢åˆ æ”¹æŸ¥ï¼Œå°±å¯ä»¥åœ¨Canvasçš„ä¸–ç•Œä¸­ä½¿ç”¨Vueçš„å“åº”å¼è¯­æ³•æ§åˆ¶ç»˜å›¾å’Œåšæ¸¸æˆï¼ŒVueç”Ÿæ€ä¸­å¯¹å°ç¨‹åºå’ŒåŸç”Ÿappçš„æ”¯æŒåŸç†ä¹Ÿæ˜¯åŸºäºè‡ªå®šä¹‰æ¸²æŸ“å™¨å®ç°çš„ã€‚</p><p>å…¶å®ï¼Œè‡ªå®šä¹‰æ¸²æŸ“å™¨ä¹Ÿä»£è¡¨ç€é€‚é…å™¨è®¾è®¡æ¨¡å¼çš„ä¸€ä¸ªå®è·µã€‚é™¤äº†è‡ªå®šä¹‰æ¸²æŸ“å™¨ API çš„å­¦ä¹ ï¼Œæˆ‘ä»¬ä¹Ÿè¦åæ€ä¸€ä¸‹è‡ªå·±ç°åœ¨è´Ÿè´£çš„é¡¹ç›®ä¸­ï¼Œæœ‰å“ªäº›åœ°æ–¹ä¸ºäº†ä¸åŒçš„æ¥å£æˆ–è€…å¹³å°å†™äº†å¤ªå¤šçš„åˆ¤æ–­ä»£ç ï¼Œæ˜¯å¦ä¹Ÿå¯ä»¥ä½¿ç”¨ç±»ä¼¼è‡ªå®šä¹‰æ¸²æŸ“å™¨çš„é€»è¾‘å’Œæ¨¡å¼ï¼ŒæŠŠå¤šä¸ªç»„ä»¶ã€å¹³å°ã€æ¥å£ä¹‹é—´ä¸åŒçš„æ“ä½œæ–¹å¼å°è£…æˆä¸€ä¸ªæ ¸å¿ƒæ¨¡å—ï¼Œå»è¿›è¡Œå•ç‹¬å‡½æ•°çš„æ‰©å±•ã€‚</p><h2>æ€è€ƒé¢˜</h2><p>æœ€åç•™ä¸ªæ€è€ƒé¢˜ç»™ä½ ï¼ŒVueå¦‚ä½•åœ¨nodeç¯å¢ƒä¸­æ¸²æŸ“å‘¢ï¼Ÿæ¬¢è¿åœ¨è¯„è®ºåŒºåˆ†äº«ä½ çš„ç­”æ¡ˆï¼Œæˆ‘ä»¬ä¸‹ä¸€è®²å†è§ï¼</p>","comments":[{"had_liked":false,"id":327538,"user_name":"ll","can_delete":false,"product_type":"c1","uid":1296458,"ip_address":"","ucode":"57C5DAC5B51036","user_header":"https://static001.geekbang.org/account/avatar/00/13/c8/4a/3a322856.jpg","comment_is_top":false,"comment_ctime":1640164957,"is_pvip":true,"discussion_count":2,"race_medal":0,"score":"53179772509","product_id":100094401,"comment_content":"å¼€çœ¼ç•Œçš„ä¸€è¯¾ã€‚å¹³æ—¶å·¥ä½œä¸­æ¶‰åŠç›¸å…³å†…å®¹è¾ƒå°‘ï¼Œæ‰€ä»¥è¿™éƒ¨åˆ†çš„å†…å®¹è¿˜éœ€è¯¾ä¸‹å¤šç»ƒå‡ éã€‚<br>ç»“åˆä¹‹å‰æ‰€å­¦ï¼Œå†™å‡ ç‚¹æ„Ÿæƒ³ï¼Œé¦–å…ˆæœ‰ä»¥ä¸‹å‡ ç§â€œè¿‡ç¨‹â€;<br>1. html --&gt; dom --&gt; æµè§ˆå™¨<br>2. html --&gt; v-dom --&gt; dom --&gt; æµè§ˆå™¨<br>3. svg, canvas, webgl --&gt; v-dom --&gt; dom --&gt; æµè§ˆå™¨<br>4. htmlç­‰ --&gt; v-dom --&gt; dom --&gt; &quot;webå†…æ ¸&quot; --&gt; å…¶ä»–å¹³å°<br>5. htmlç­‰ --&gt; v-dom --&gt; &quot;xxx object model&quot; --&gt; å…¶ä»–å¹³å°<br>ç„¶åï¼Œ<br>vue çš„è§’è‰²æ˜¯æä¾›äº†æ“ä½œ v-dom çš„â€œæ–¹å¼â€ï¼Œå¹¶ä¸”åœ¨ v-dom --&gt; dom è¿™ä¸ªè¿‡ç¨‹ä¸­ï¼Œéå¸¸&quot;é«˜æ•ˆ&quot;ä¸”&quot;ä¸“ä¸š&quot;,<br><br>ä»Šå¤©çš„å†…å®¹èšç„¦è¿‡ç¨‹ 4. çš„å‰åŠæ®µï¼Œå³ htmlç­‰ --&gt; v-dom.<br><br>ä¸ºä»€ä¹ˆï¼Ÿæˆ–è€…è§£å†³äº†ä»€ä¹ˆé—®é¢˜ï¼Ÿ ç­”: æˆ‘ä»¬æ“ä½œ v-dom çš„æ–¹å¼ä¸ä¼šå› éœ€è¦â€é€‚é…â€œä¸åŒçš„&quot;æ ‡å‡†&quot;è€Œå‘ç”Ÿâ€ä»»ä½•â€œæ”¹å˜ã€‚<br><br>æ€ä¹ˆå®ç°çš„ï¼Ÿsvgï¼Œcanvas ç­‰æ€ä¹ˆå˜æˆâ€œç»Ÿä¸€â€çš„ v-domï¼Œéœ€è¦ä»€ä¹ˆï¼Ÿvue ä¹Ÿç»™ä½ æä¾›äº† createRendererã€‚<br><br>â€œé€‚é…å™¨&quot;å‡ºåœºäº†ï¼Œåœ¨ä»£ç æŠ½è±¡å®ç°ä¸Šæ¥è¯´å°±æ˜¯â€œé€‚é…å™¨æ¨¡å¼â€ã€‚æˆ‘å¼€å§‹çœ‹æ–‡ç« æ—¶çŒœçš„æ˜¯â€œç­–ç•¥æ¨¡å¼â€ï¼Œå½“ç„¶æˆ‘å­¦è‰ºä¸ç²¾ï¼Œè¿™ä¹Ÿæ˜¯ä¸ªå¤ä¹ â€œè®¾è®¡æ¨¡å¼â€çš„å¥½æœºä¼šã€‚<br><br>è‡³äºæ€è€ƒé¢˜ï¼ŒVue åœ¨ åœ¨ node ç¯å¢ƒä¸­æ¸²æŸ“æˆ‘èƒ½æƒ³åˆ°çš„åº”ç”¨åœºæ™¯ï¼Œæ˜¯å‰åç«¯åŒæ„ï¼ŒSSRï¼ŒSSGï¼Œäº§ç”Ÿè¿™ä¸ªé—®é¢˜çš„æ ¹æœ¬åŸå› å°±æ˜¯ï¼Œnode å®ƒä¸æ‡‚ â€œdom&quot;, ä¸æ‡‚æ€ä¹ˆåŠï¼Ÿé…ä¸ªç¿»è¯‘ï¼Ÿè¦ä¸ä½ ç¿»è¯‘æˆå®ƒèƒ½æ‡‚çš„å†ç»™å®ƒï¼Ÿ<br><br>å·²ä¸Šï¼Œå°±æ˜¯æˆ‘çš„ä¸€äº›å¤§è‡´æƒ³æ³•ï¼Œè°¬è¯¯ä¹‹å¤„è¿˜æœ›å¤§å®¶ä¸åèµæ•™ã€‚","like_count":12,"discussions":[{"author":{"id":1217641,"avatar":"https://static001.geekbang.org/account/avatar/00/12/94/69/4937e1e4.jpg","nickname":"Sean","note":"","ucode":"2178FD5B59B620","race_medal":0,"user_type":1,"is_pvip":true},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":563223,"discussion_content":"3. svg, canvas, webgl --&gt; v-dom --&gt; dom --&gt; æµè§ˆå™¨\nè¿™ä¸ªä¸å¯¹ï¼Œæœ¬è´¨ä¸Šæ˜¯objectï¼ˆv-domï¼‰è½¬æˆdomã€canvasã€webgal-&gt;æµè§ˆå™¨","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1649951176,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1296458,"avatar":"https://static001.geekbang.org/account/avatar/00/13/c8/4a/3a322856.jpg","nickname":"ll","note":"","ucode":"57C5DAC5B51036","race_medal":0,"user_type":1,"is_pvip":true},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":548005,"discussion_content":"è¡¥å……ä¸€ä¸‹ï¼Œvue æ“ä½œçš„æ˜¯ v-domï¼Œ æ¸²æŸ“å™¨â€ç”Ÿæˆâ€œ v-domï¼Œä¸åŒå¹³å°æä¾›ä¸åŒ options â€ä¾›â€œ æ¸²æŸ“å™¨ç”Ÿæˆ v-dom","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1642993846,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":327420,"user_name":"Johnson","can_delete":false,"product_type":"c1","uid":1326108,"ip_address":"","ucode":"C6B6FF9EA4CC60","user_header":"https://static001.geekbang.org/account/avatar/00/14/3c/1c/47e5b7aa.jpg","comment_is_top":false,"comment_ctime":1640131172,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"23114967652","product_id":100094401,"comment_content":"è¿™ä¸€è®²çš„è·¨ç«¯åŸç†è®²è§£å¤ªå®ç”¨å•¦ï¼ğŸ˜","like_count":5},{"had_liked":false,"id":342133,"user_name":"Sean","can_delete":false,"product_type":"c1","uid":1217641,"ip_address":"","ucode":"2178FD5B59B620","user_header":"https://static001.geekbang.org/account/avatar/00/12/94/69/4937e1e4.jpg","comment_is_top":false,"comment_ctime":1650032232,"is_pvip":true,"discussion_count":0,"race_medal":0,"score":"5944999528","product_id":100094401,"comment_content":"è€å¸ˆ è¿™æ²¡æœ‰ä»£ç  å¯ä»¥è¿è¡Œä¸€ä¸‹å—","like_count":1},{"had_liked":false,"id":341737,"user_name":"ä¹å¤š","can_delete":false,"product_type":"c1","uid":1562891,"ip_address":"","ucode":"286632BFF7D68D","user_header":"https://static001.geekbang.org/account/avatar/00/17/d9/0b/d842b71a.jpg","comment_is_top":false,"comment_ctime":1649815810,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"5944783106","product_id":100094401,"comment_content":"è€å¸ˆï¼Œè¿™ä¸€è®²çš„æºç å“ªé‡Œæœ‰ï¼Ÿ","like_count":1},{"had_liked":false,"id":327511,"user_name":"æ— åŒ","can_delete":false,"product_type":"c1","uid":1238757,"ip_address":"","ucode":"405779043D091E","user_header":"https://static001.geekbang.org/account/avatar/00/12/e6/e5/e3daa1a7.jpg","comment_is_top":false,"comment_ctime":1640157462,"is_pvip":false,"replies":[{"id":"119454","content":"å¯ä»¥çœ‹ä¸‹è¿™ä¸ªåº“<br>https:&#47;&#47;github.com&#47;troisjs&#47;trois","user_name":"ä½œè€…å›å¤","comment_id":327511,"uid":"1003715","ip_address":"","utype":1,"ctime":1640529793,"user_name_real":"ç¼–è¾‘"}],"discussion_count":1,"race_medal":0,"score":"5935124758","product_id":100094401,"comment_content":"æƒ³æ·±å…¥äº†è§£ä¸€ä¸‹three.jså’Œvueçš„ç»“åˆï¼Œæœ‰æ²¡æœ‰è¿™æ–¹é¢çš„èµ„æ–™ï¼Œæˆ–è€…æœ€ä½³å®è·µï¼Ÿ","like_count":2,"discussions":[{"author":{"id":1003715,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/50/c3/0aa50246.jpg","nickname":"èŠ±æœå±±å¤§åœ£","note":"","ucode":"25C0A36D628037","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":541720,"discussion_content":"å¯ä»¥çœ‹ä¸‹è¿™ä¸ªåº“\nhttps://github.com/troisjs/trois","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1640529793,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":356432,"user_name":"è¿·è·¯æ£®æ—","can_delete":false,"product_type":"c1","uid":2740863,"ip_address":"å››å·","ucode":"2A381C5A140A85","user_header":"https://static001.geekbang.org/account/avatar/00/29/d2/7f/44fbd96b.jpg","comment_is_top":false,"comment_ctime":1662301345,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1662301345","product_id":100094401,"comment_content":"æˆ‘çš„renderer.jsæ–‡ä»¶ä¸€ç›´æ¸²æŸ“ä¸å‡ºæ¥ï¼Œè¯·é—®æ˜¯è¦å®‰è£…ä»€ä¹ˆä¾èµ–åŒ…å—","like_count":0},{"had_liked":false,"id":356145,"user_name":"Chaosæµ©","can_delete":false,"product_type":"c1","uid":1675943,"ip_address":"æµ™æ±Ÿ","ucode":"4FFAE6EEAA460B","user_header":"https://static001.geekbang.org/account/avatar/00/19/92/a7/00fefed5.jpg","comment_is_top":false,"comment_ctime":1662010044,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1662010044","product_id":100094401,"comment_content":"è¿˜æ˜¯è¿™ç§å†…å®¹æ›´å¸å¼•äºº","like_count":0},{"had_liked":false,"id":352395,"user_name":"ä¸œæ–¹å¥‡éª¥","can_delete":false,"product_type":"c1","uid":1354850,"ip_address":"","ucode":"DEE7085F7E55A4","user_header":"https://static001.geekbang.org/account/avatar/00/14/ac/62/37912d51.jpg","comment_is_top":false,"comment_ctime":1658643036,"is_pvip":true,"discussion_count":0,"race_medal":0,"score":"1658643036","product_id":100094401,"comment_content":"å¥½æ–‡ï¼æœ€è¿‘å·¥ä½œä¸­æ­£è¦è‡ªå®šä¹‰staterï¼Œæ²¡æƒ³é“å°±æ‰¾åˆ°äº†ã€‚","like_count":0},{"had_liked":false,"id":349593,"user_name":"æ±Ÿæ— èŠ±","can_delete":false,"product_type":"c1","uid":1599154,"ip_address":"","ucode":"AE415FD7A202DF","user_header":"https://static001.geekbang.org/account/avatar/00/18/66/b2/cf691f56.jpg","comment_is_top":false,"comment_ctime":1656127489,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1656127489","product_id":100094401,"comment_content":"Vue å¦‚ä½•åœ¨ node ç¯å¢ƒä¸­æ¸²æŸ“ï¼Œè¿™ä¸ªå…¶å®æ²¡å¤ªæ˜ç™½ã€‚æ˜¯æŒ‡åœ¨nodeç¯å¢ƒä¸­ï¼Œä½¿ç”¨å‘½ä»¤è¡Œè¾“å‡ºï¼Ÿ","like_count":0},{"had_liked":false,"id":342137,"user_name":"Sean","can_delete":false,"product_type":"c1","uid":1217641,"ip_address":"","ucode":"2178FD5B59B620","user_header":"https://static001.geekbang.org/account/avatar/00/12/94/69/4937e1e4.jpg","comment_is_top":false,"comment_ctime":1650033378,"is_pvip":true,"discussion_count":0,"race_medal":0,"score":"1650033378","product_id":100094401,"comment_content":"æºç åœ°å€ï¼šhttps:&#47;&#47;github.com&#47;shengxinjing&#47;vue3-vs-vue2.git","like_count":0},{"had_liked":false,"id":337579,"user_name":"ææ–‡å","can_delete":false,"product_type":"c1","uid":1613802,"ip_address":"","ucode":"DC570A509F7EEB","user_header":"https://static001.geekbang.org/account/avatar/00/18/9f/ea/b587985a.jpg","comment_is_top":false,"comment_ctime":1646901584,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1646901584","product_id":100094401,"comment_content":"ç¬¬ä¸€ä¸ªä¾‹å­ç´¯åŠ å™¨å€¼å¹¶ä¸ä¼šå¢åŠ ","like_count":0},{"had_liked":false,"id":329798,"user_name":"Geek_15264a","can_delete":false,"product_type":"c1","uid":2829354,"ip_address":"","ucode":"3D5C9171F8A3B2","user_header":"","comment_is_top":false,"comment_ctime":1641543462,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1641543462","product_id":100094401,"comment_content":"æœ€ç»ˆæ‰¾åˆ°äº†ï¼Œæ„Ÿè§‰è¿˜æ˜¯éœ€è¦æŠŠæœ¬èŠ‚æ¶‰åŠçš„æºç ï¼Œåœ¨æ˜¾çœ¼çš„ä½ç½®è´´å‡ºæ¥ï¼Œæ‰¾åˆ°æœ¬ç« ä¸­æçš„ä¸€ä¸ªé“¾æ¥ï¼Œæ‰“å¼€æœ‰é—®é¢˜ï¼Œç»“æœç›´æ¥å»ä½ çš„githubä»“åº“ä¸‹æ‰¾åˆ°å¯¹åº”çš„ä»£ç ","like_count":0},{"had_liked":false,"id":327419,"user_name":"æµ·é˜”å¤©ç©º","can_delete":false,"product_type":"c1","uid":1327016,"ip_address":"","ucode":"16C87A0052A08B","user_header":"https://static001.geekbang.org/account/avatar/00/14/3f/a8/8da58e53.jpg","comment_is_top":false,"comment_ctime":1640130870,"is_pvip":false,"replies":[{"id":"119158","content":"å“ªé‡Œä¸æ‡‚ç•™è¨€è®¨è®ºå•Šï½","user_name":"ç¼–è¾‘å›å¤","comment_id":327419,"uid":"1501385","ip_address":"","utype":2,"ctime":1640137560,"user_name_real":"ç¼–è¾‘"}],"discussion_count":1,"race_medal":0,"score":"1640130870","product_id":100094401,"comment_content":"æœ‰å¾ˆå¤šéƒ½ä¸æ˜¯å¾ˆæ‡‚ã€‚ã€‚ã€‚","like_count":0,"discussions":[{"author":{"id":1501385,"avatar":"https://static001.geekbang.org/account/avatar/00/16/e8/c9/59bcd490.jpg","nickname":"å¬æ°´çš„æ¹–","note":"","ucode":"B1759F90165D81","race_medal":0,"user_type":8,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":540687,"discussion_content":"å“ªé‡Œä¸æ‡‚ç•™è¨€è®¨è®ºå•Šï½","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1640137560,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":4}","child_discussion_number":0,"child_discussions":[]}]}]}