{"id":114179,"title":"11 | å¦‚ä½•é€šè¿‡Node.jså®ç°ä¸€å¥—æœ€ç®€å•çš„ä¿¡ä»¤ç³»ç»Ÿï¼Ÿ","content":"<p>é€šè¿‡å‰é¢å‡ ç¯‡æ–‡ç« çš„è®²è§£ï¼Œæˆ‘æƒ³ç°åœ¨ä½ åº”è¯¥å·²ç»å¯¹ WebRTC æœ‰äº†ä¸€ä¸ªæ¸…æ¥šçš„è®¤çŸ¥äº†ã€‚æ¥ä¸‹æ¥çš„ç« èŠ‚å’±ä»¬å°±ä½¿ç”¨ WebRTC é€æ­¥å®ç°ä¸€å¥—çœŸå®å¯ç”¨çš„ 1 å¯¹ 1 å®æ—¶ç›´æ’­ç³»ç»Ÿå§ã€‚</p><p>WebRTC 1.0 è§„èŒƒå¯¹ WebRTC è¦å®ç°çš„åŠŸèƒ½ã€API ç­‰ç›¸å…³ä¿¡æ¯åšäº†å¤§é‡çš„çº¦æŸï¼Œæ¯”å¦‚è§„èŒƒä¸­å®šä¹‰äº†å¦‚ä½•é‡‡é›†éŸ³è§†é¢‘æ•°æ®ã€å¦‚ä½•å½•åˆ¶ä»¥åŠå¦‚ä½•ä¼ è¾“ç­‰ã€‚ç”šè‡³æ›´ç»†çš„ï¼Œè¿˜å®šä¹‰äº†éƒ½æœ‰å“ªäº› APIï¼Œä»¥åŠè¿™äº›API çš„ä½œç”¨æ˜¯ä»€ä¹ˆã€‚ä½†è¿™äº›çº¦æŸåªé’ˆå¯¹äºå®¢æˆ·ç«¯ï¼Œå¹¶æ²¡æœ‰å¯¹æœåŠ¡ç«¯åšä»»ä½•é™åˆ¶ã€‚</p><p>é‚£WebRTCè§„èŒƒä¸­ä¸ºä»€ä¹ˆä¸å¯¹æœåŠ¡å™¨ä¹Ÿåšçº¦æŸå‘¢ï¼Ÿå…¶å®ï¼Œè¿™æ ·åšæœ‰ä»¥ä¸‹ä¸‰ç‚¹å¥½å¤„ã€‚</p><ul>\n<li><strong>ç¬¬ä¸€ç‚¹ï¼Œå¯ä»¥é›†ä¸­ç²¾åŠ›å°† WebRTC åº“åšå¥½</strong>ã€‚WebRTCçš„æ„¿æ™¯æ˜¯ä½¿æµè§ˆå™¨èƒ½å¤Ÿæ–¹ä¾¿åœ°å¤„ç†éŸ³è§†é¢‘ç›¸å…³çš„åº”ç”¨ï¼Œè§„èŒƒä¸­ä¸é™åˆ¶æœåŠ¡ç«¯çš„äº‹å„¿ï¼Œå¯ä»¥ä½¿å®ƒæ›´èšç„¦ã€‚</li>\n<li><strong>ç¬¬äºŒç‚¹ï¼Œè®©ç”¨æˆ·æ›´å¥½åœ°å¯¹æ¥ä¸šåŠ¡</strong>ã€‚ä½ ä¹Ÿæ¸…æ¥šï¼Œä¿¡ä»¤æœåŠ¡å™¨ä¸€èˆ¬éƒ½ä¸å…¬å¸çš„ä¸šåŠ¡æœ‰ç€å¯†åˆ‡çš„å…³ç³»ï¼Œæ¯å®¶å…¬å¸çš„ä¸šåŠ¡éƒ½å„æœ‰ç‰¹è‰²ï¼Œè®©å®ƒä»¬æŒ‰ç…§è‡ªå·²çš„ä¸šåŠ¡å»å®ç°ä¿¡ä»¤æœåŠ¡å™¨ä¼šæ›´ç¬¦åˆå®ƒä»¬çš„è¦æ±‚ã€‚</li>\n<li><strong>ç¬¬ä¸‰ç‚¹ï¼Œèƒ½å¾—åˆ°æ›´å¤šå…¬å¸çš„æ”¯æŒ</strong>ã€‚WebRTCæ‰©å±•äº†æµè§ˆå™¨çš„åŸºç¡€è®¾æ–½åŠèƒ½åŠ›ï¼Œè€Œä¸æ¶‰åŠåˆ°å…·ä½“çš„ä¸šåŠ¡æˆ–äº§å“ï¼Œè¿™æ ·ä¼šæ›´å®¹æ˜“å¾—åˆ°åƒè‹¹æœã€å¾®è½¯è¿™ç§å¤§å…¬å¸çš„æ”¯æŒï¼Œå¦åˆ™è¿™äº›å¤§å…¬å¸ä¹‹é—´å°±ä¼šäº§ç”ŸæŠ—è¡¡ã€‚</li>\n</ul><p>å½“ç„¶ï¼Œè¿™æ ·åšä¹Ÿå¸¦æ¥äº†ä¸€äº›åå¤„ï¼Œæœ€æ˜æ˜¾çš„ä¸€ä¸ªå°±æ˜¯å¢åŠ äº†å­¦ä¹  WebRTC çš„æˆæœ¬ï¼Œå› ä¸ºä½ åœ¨å­¦ä¹ WebRTCçš„æ—¶å€™ï¼Œå¿…é¡»<strong>è‡ªå·±å»å®ç°ä¿¡ä»¤æœåŠ¡å™¨</strong>ï¼Œå¦åˆ™ä½ å°±æ²¡åŠæ³•è®© WebRTC è¿è½¬èµ·æ¥ï¼Œè¿™ç¡®å®å¢åŠ äº†ä¸å°‘å­¦ä¹ æˆæœ¬ã€‚</p><!-- [[[read_end]]] --><p>ä¸è¿‡æœ‰äº†æœ¬ä¸“æ ï¼Œä½ å°±ä¸ç”¨å†æ‹…å¿ƒè¿™ä¸ªé—®é¢˜äº†ã€‚æ¥ä¸‹æ¥ï¼Œæˆ‘å°±å‘ä½ è®²è§£ä¸€ä¸‹ï¼Œ<strong>å¦‚ä½•å®ç°ä¸€å¥—æœ€ç®€å•çš„ WebRTC ä¿¡ä»¤æœåŠ¡ç³»ç»Ÿ</strong>ã€‚æœ‰äº†è¿™å¥—ä¿¡ä»¤æœåŠ¡ç³»ç»Ÿï¼ŒWebRTCå°±èƒ½è¿è½¬èµ·æ¥ï¼Œè¿™æ ·ä½ å°±èƒ½çœŸæ­£åœ°ä½“éªŒåˆ° WebRTC çš„å¼ºå¤§ä¹‹å¤„äº†ã€‚</p><h2>åœ¨WebRTC å¤„ç†è¿‡ç¨‹ä¸­çš„ä½ç½®</h2><p>åœ¨å¼€å§‹è®²è§£ WebRTC ä¿¡ä»¤æœåŠ¡å™¨ä¹‹å‰ï¼Œæˆ‘ä»¬å…ˆæ¥çœ‹ä¸€ä¸‹æœ¬æ–‡åœ¨ WebRTC å¤„ç†è¿‡ç¨‹ä¸­çš„ä½ç½®ã€‚</p><p><img src=\"https://static001.geekbang.org/resource/image/a7/3e/a7489c842514a707501afd1953d82a3e.png?wh=1142*509\" alt=\"\"></p><center><span class=\"reference\">WebRTCå¤„ç†è¿‡ç¨‹å›¾</span></center><p>é€šè¿‡ä¸Šé¢è¿™å¹…å›¾ï¼Œä½ å¯ä»¥æ¸…æ¥šåœ°çŸ¥é“æœ¬æ–‡æ‰€è®²çš„ä¸»è¦å†…å®¹å°±æ˜¯çº¢è‰²æ–¹æ¡†ä¸­çš„<strong>ä¿¡ä»¤æœåŠ¡å™¨</strong>éƒ¨åˆ†ã€‚</p><h2>WebRTCä¿¡ä»¤æœåŠ¡å™¨çš„ä½œç”¨</h2><p>ä½ è‹¥æƒ³è¦å®ç° WebRTC ä¿¡ä»¤æœåŠ¡å™¨ï¼Œé¦–å…ˆå°±è¦çŸ¥é“å®ƒåœ¨ WebRTC 1 å¯¹ 1 é€šä¿¡ä¸­æ‰€èµ·çš„ä½œç”¨ã€‚å®é™…ä¸Šå®ƒçš„åŠŸèƒ½æ˜¯è›®ç®€å•çš„ï¼Œå°±æ˜¯<strong>è¿›è¡Œä¿¡ä»¤çš„äº¤æ¢ï¼Œä½†ä½œç”¨å´ååˆ†å…³é”®ã€‚åœ¨é€šä¿¡åŒæ–¹å½¼æ­¤è¿æ¥ã€ä¼ è¾“åª’ä½“æ•°æ®ä¹‹å‰ï¼Œå®ƒä»¬è¦é€šè¿‡ä¿¡ä»¤æœåŠ¡å™¨äº¤æ¢ä¸€äº›ä¿¡æ¯ï¼Œå¦‚åª’ä½“åå•†</strong>ã€‚</p><p>ä¸¾ä¸ªä¾‹å­ï¼Œå‡è®¾ A ä¸ B è¦è¿›è¡ŒéŸ³è§†é¢‘é€šä¿¡ï¼Œé‚£ä¹ˆ A è¦çŸ¥é“ B å·²ç»ä¸Šçº¿äº†ï¼ŒåŒæ ·ï¼ŒB ä¹Ÿè¦çŸ¥é“ A åœ¨ç­‰ç€ä¸å®ƒé€šä¿¡å‘¢ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œ<strong>åªæœ‰åŒæ–¹éƒ½çŸ¥é“å½¼æ­¤å­˜åœ¨ï¼Œæ‰èƒ½ç”±ä¸€æ–¹å‘å¦ä¸€æ–¹å‘èµ·éŸ³è§†é¢‘é€šä¿¡è¯·æ±‚ï¼Œå¹¶æœ€ç»ˆå®ç°éŸ³è§†é¢‘é€šè¯</strong>ã€‚æ¯”å¦‚æˆ‘ä»¬åœ¨<a href=\"https://time.geekbang.org/column/article/111675\">ã€Š08 | æœ‰è¯å¥½å•†é‡ï¼Œè®ºåª’ä½“åå•†ã€‹</a>ä¸€æ–‡ä¸­è®²çš„åª’ä½“ä¿¡æ¯åå•†çš„è¿‡ç¨‹å°±æ˜¯è¿™æ ·ä¸€ä¸ªéå¸¸å…¸å‹çš„æ¡ˆä¾‹ï¼ŒåŒæ–¹çš„ SDP ä¿¡æ¯ç”Ÿæˆåï¼Œè¦é€šè¿‡ä¿¡ä»¤æœåŠ¡å™¨è¿›è¡Œäº¤æ¢ï¼Œä»è€Œè¾¾åˆ°åª’ä½“åå•†çš„ç›®çš„ã€‚</p><p>é‚£åœ¨ WebRTC ä¿¡ä»¤æœåŠ¡å™¨ä¸Šè¦å®ç°å“ªäº›åŠŸèƒ½ï¼Œæ‰èƒ½å®ç°ä¸Šè¿°ç»“æœå‘¢ï¼Ÿæˆ‘æƒ³è‡³å°‘è¦å®ç°ä¸‹é¢ä¸¤ä¸ªåŠŸèƒ½ï¼š</p><ol>\n<li><strong>æˆ¿é—´ç®¡ç†</strong>ã€‚å³æ¯ä¸ªç”¨æˆ·éƒ½è¦åŠ å…¥åˆ°ä¸€ä¸ªå…·ä½“çš„æˆ¿é—´é‡Œï¼Œæ¯”å¦‚ä¸¤ä¸ªç”¨æˆ· A ä¸ B è¦è¿›è¡Œé€šè¯ï¼Œé‚£ä¹ˆå®ƒä»¬å¿…é¡»åŠ å…¥åˆ°åŒä¸€ä¸ªæˆ¿é—´é‡Œã€‚</li>\n<li><strong>ä¿¡ä»¤çš„äº¤æ¢</strong>ã€‚å³åœ¨åŒä¸€ä¸ªæˆ¿é—´é‡Œçš„ç”¨æˆ·ä¹‹é—´å¯ä»¥ç›¸äº’å‘é€ä¿¡ä»¤ã€‚</li>\n</ol><h2>ä¿¡ä»¤æœåŠ¡å™¨çš„å®ç°</h2><p>äº†è§£äº† WebRTC ä¿¡ä»¤æœåŠ¡å™¨çš„ä½œç”¨ï¼Œå¹¶ä¸”è¿˜çŸ¥é“äº†ä¿¡ä»¤æœåŠ¡å™¨è¦å®ç°çš„åŠŸèƒ½ï¼Œæ¥ä¸‹æ¥æˆ‘ä»¬å°±æ“ç»ƒèµ·æ¥ï¼Œçœ‹çœ‹å¦‚ä½•å®ç°ä¿¡ä»¤æœåŠ¡å™¨å§ï¼æˆ‘å°†ä»ä¸‹é¢5ä¸ªæ–¹é¢æ¥å‘ä½ é€æ­¥è®²è§£å¦‚ä½•å®ç°ä¸€ä¸ªä¿¡ä»¤æœåŠ¡å™¨ã€‚</p><h3>1. ä¸ºä»€ä¹ˆé€‰æ‹© Node.jsï¼Ÿ</h3><p>è¦å®ç°ä¿¡ä»¤æœåŠ¡å™¨ï¼Œä½ å¯ä»¥ä½¿ç”¨ C/C++ã€Java ç­‰è¯­è¨€ä¸€è¡Œä¸€è¡Œä»å¤´å¼€å§‹ç¼–å†™ä»£ç ï¼Œä¹Ÿå¯ä»¥ä»¥ç°æœ‰çš„ã€æˆç†Ÿçš„æœåŠ¡å™¨ä¸ºåŸºç¡€ï¼ŒåšäºŒæ¬¡å¼€å‘ã€‚å…·ä½“ä½¿ç”¨å“ªç§æ–¹å¼æ¥å®ç°ï¼Œå…³é”®çœ‹ä½ çš„æœåŠ¡å™¨è¦å®ç°ä»€ä¹ˆåŠŸèƒ½ï¼Œä»¥åŠä½¿ç”¨ä»€ä¹ˆä¼ è¾“åè®®ç­‰ä¿¡æ¯æ¥å†³ç­–ã€‚</p><p>ä»¥æˆ‘ä»¬è¦å®ç°çš„ä¿¡ä»¤æœåŠ¡å™¨ä¸ºä¾‹ï¼Œå› å®ƒåªéœ€è¦ä¼ è¾“å‡ ä¸ªç®€å•çš„ä¿¡ä»¤ï¼Œè€Œè¿™äº›ä¿¡ä»¤æ—¢å¯ä»¥ä½¿ç”¨ TCPã€ HTTP/HTTPSä¼ è¾“ï¼Œä¹Ÿå¯ä»¥ç”¨ WebSocket/WSS åè®®ä¼ è¾“ï¼Œæ‰€ä»¥æ ¹æ®å®ƒä½¿ç”¨çš„ä¼ è¾“åè®®ï¼Œä½ å°±å¯ä»¥å¾ˆå®¹æ˜“åœ°æƒ³åˆ°ï¼Œé€šè¿‡ Web æœåŠ¡å™¨ï¼ˆå¦‚Nginxã€Node.jsï¼‰æ¥æ„å»ºæˆ‘ä»¬çš„ä¿¡ä»¤æœåŠ¡å™¨æ˜¯æœ€ç†æƒ³ã€æœ€çœæ—¶çš„ã€ä¸”æ˜¯æœ€ä¼˜çš„æ–¹æ¡ˆã€‚</p><p>ä½ å¯ä»¥æ ¹æ®è‡ªå·±çš„å–œå¥½é€‰æ‹©ä¸åŒçš„ Web æœåŠ¡å™¨ï¼ˆå¦‚ Apacheã€Nginx æˆ– Node.jsï¼‰æ¥å®ç°ï¼Œè€Œä»Šå¤©æˆ‘ä»¬é€‰æ‹©çš„æ˜¯Node.jsï¼Œæ‰€ä»¥æ¥ä¸‹æ¥æˆ‘ä»¬å°†è¦è®²è§£çš„æ˜¯<strong>å¦‚ä½•ä½¿ç”¨ Node.js æ¥æ­å»ºä¿¡ä»¤æœåŠ¡å™¨</strong>ã€‚</p><p>å®é™…ä¸Šï¼ŒApacheã€Nginxå’ŒNode.jséƒ½æ˜¯éå¸¸ä¼˜ç§€ã€ä¸”æˆç†Ÿçš„WebæœåŠ¡å™¨ï¼Œå…¶ä¸­ Nginx å¯ä»¥è¯´æ˜¯æ€§èƒ½æœ€å¥½çš„WebæœåŠ¡å™¨äº†ï¼Œä½†<strong>ä»æœªæ¥çš„å‘å±•è§’åº¦æ¥è¯´ï¼ŒNode.jsåˆ™ä¼šæ›´æœ‰ä¼˜åŠ¿</strong>ã€‚</p><p><strong>Node.js çš„æœ€å¤§ä¼˜ç‚¹æ˜¯å¯ä»¥ä½¿ç”¨ JavaScript è¯­è¨€å¼€å‘æœåŠ¡å™¨ç¨‹åº</strong>ã€‚è¿™æ ·ä½¿å¾—å¤§é‡çš„å‰ç«¯åŒå­¦å¯ä»¥æ— ç¼è½¬åˆ°æœåŠ¡å™¨å¼€å‘ï¼Œç”šè‡³æœ‰å¯èƒ½å‰åç«¯ä½¿ç”¨åŒä¸€å¥—ä»£ç å®ç°ã€‚å¯¹äºä½¿ç”¨ JavaScript è¯­è¨€å®ç°å…¨æ ˆå¼€å‘è¿™ä¸€ç‚¹æ¥è¯´ï¼Œæˆ‘æƒ³æ— è®ºæ˜¯å¯¹äºä¸ªäººè¿˜æ˜¯å¯¹äºä¼ä¸šéƒ½æ˜¯æå¤§çš„è¯±æƒ‘ã€‚æ›´å¯è´µçš„æ˜¯ <strong>Node.js çš„ç”Ÿæ€é“¾éå¸¸å®Œæ•´</strong>ï¼Œæœ‰å„ç§å„æ ·çš„åŠŸèƒ½åº“ï¼Œä½ å¯ä»¥æ ¹æ®è‡ªå·±çš„éœ€è¦é€šè¿‡å®‰è£…å·¥å…·ï¼ˆå¦‚ NPMï¼‰å¿«é€Ÿå°†å®ƒä»¬å¼•å…¥åˆ°ä½ çš„é¡¹ç›®ä¸­ï¼Œè¿™æå¤§åœ°æé«˜äº† JavaScript ç ”å‘åŒå­¦çš„å¼€å‘æ•ˆç‡ã€‚</p><p>Node.js çš„æ ¸å¿ƒæ˜¯V8ï¼ˆJavaScriptï¼‰å¼•æ“ï¼ŒNode.jsé€šè¿‡å®ƒè§£æJavaScript è„šæœ¬æ¥è¾¾åˆ°æ§åˆ¶æœåŠ¡å™¨çš„ç›®çš„ã€‚å¯¹äº JavaScript åŒå­¦æ¥è¯´ï¼ŒNode.jsçš„å‡ºç°æ˜¯é©å‘½æ€§çš„ï¼Œå®ƒä¸ä»…è®© JavaScript åŒå­¦æˆä¸ºäº†å…¨æ ˆå¼€å‘å·¥ç¨‹å¸ˆï¼Œè€Œä¸”è¿˜è®©JavaScriptå¼€å‘åŒå­¦çš„å¹¸ç¦æŒ‡æ•°é£™å‡ï¼ŒçœŸæ­£åœ°æ„Ÿå—åˆ°äº† JavaScript æ— æ‰€ä¸èƒ½çš„èƒ½åŠ›ã€‚å¯¹äºæˆ‘è¿™æ ·çš„å¼€å‘â€œè€é¸Ÿâ€æ¥è¯´ï¼Œ10å¹´å‰è¿˜ä¸æ•¢æƒ³è±¡é€šè¿‡ JavaScript æ¥å†™æœåŠ¡å™¨ç¨‹åºå‘¢ï¼Œç°åœ¨å®ƒå´å·²æˆä¸ºç°å®ï¼</p><p>å½“ç„¶ï¼Œ Node.js ä¸ä»…å¯ä»¥è®©ä½ ç”¨ JavaScript æ§åˆ¶æœåŠ¡å™¨ï¼Œå®ƒè¿˜ä¸ºä½ ç•™äº†æ‹“å±•æ¥å£ï¼Œè¿™äº›æ‹“å±•æ¥å£ç”šè‡³å¯ä»¥è®©ä½ ä½¿ç”¨ C/C++ ä¸ºå®ƒç¼–å†™æ¨¡å—ï¼Œè¿™æ · Node.js çš„åŠŸèƒ½å°±æ›´åŠ å¼ºå¤§äº†ã€‚</p><h3>2. Node.jsçš„åŸºæœ¬å·¥ä½œåŸç†</h3><p><img src=\"https://static001.geekbang.org/resource/image/38/3f/380311a689cf4adc1dff6fdb91aa8b3f.png?wh=1142*692\" alt=\"\"></p><center><span class=\"reference\">Node.js å·¥ä½œåŸç†å›¾</span></center><p>Node.jsçš„å·¥ä½œåŸç†å¦‚ä¸Šå›¾æ‰€ç¤ºï¼Œå…¶æ ¸å¿ƒæ˜¯ V8 å¼•æ“ã€‚é€šè¿‡è¯¥å¼•æ“ï¼Œå¯ä»¥è®© JavaScript è°ƒç”¨ C/C++æ–¹æ³•æˆ–å¯¹è±¡ã€‚åè¿‡æ¥è®²ï¼Œé€šè¿‡å®ƒä¹Ÿå¯ä»¥è®© C/C++ è®¿é—®JavaScriptæ–¹æ³•å’Œå˜é‡ã€‚</p><p>Node.js é¦–å…ˆå°† JavaScript å†™å¥½çš„åº”ç”¨ç¨‹åºäº¤ç»™ V8 å¼•æ“è¿›è¡Œè§£æï¼ŒV8ç†è§£åº”ç”¨ç¨‹åºçš„è¯­ä¹‰åï¼Œå†è°ƒç”¨ Node.js åº•å±‚çš„ C/C++ APIå°†æœåŠ¡å¯åŠ¨èµ·æ¥ã€‚æ‰€ä»¥ <strong>Node.js çš„å¼ºå¤§å°±åœ¨äºJavaScript ä¸ C/C++ å¯ä»¥ç›¸äº’è°ƒç”¨ï¼Œä»è€Œè¾¾åˆ°ä½¿å…¶èƒ½åŠ›å¯ä»¥æ— é™æ‰©å±•çš„æ•ˆæœ</strong>ã€‚</p><p>æˆ‘ä»¬ä»¥Node.jså¼€å‘ä¸€ä¸ª HTTP æœåŠ¡ä¸ºä¾‹ï¼ŒNode.js æ‰“å¼€ä¾¦å¬çš„æœåŠ¡ç«¯å£åï¼Œåº•å±‚ä¼šè°ƒç”¨ libuv å¤„ç†è¯¥ç«¯å£çš„æ‰€æœ‰ HTTP è¯·æ±‚ã€‚å…¶ç½‘ç»œäº‹ä»¶å¤„ç†çš„è¿‡ç¨‹å°±å¦‚ä¸‹å›¾æ‰€ç¤ºï¼š</p><p><img src=\"https://static001.geekbang.org/resource/image/fe/6b/fe606ed87d72b94c4e65da9d6148b26b.png?wh=1142*746\" alt=\"\"></p><center><span class=\"reference\">Node.js äº‹ä»¶å¤„ç†æ¨¡å‹å›¾</span></center><p>å½“æœ‰ç½‘ç»œè¯·æ±‚è¿‡æ¥æ—¶ï¼Œé¦–å…ˆä¼šè¢«æ’å…¥åˆ°ä¸€ä¸ªäº‹ä»¶å¤„ç†é˜Ÿåˆ—ä¸­ã€‚libuvä¼šç›‘æ§è¯¥äº‹ä»¶é˜Ÿåˆ—ï¼Œå½“å‘ç°æœ‰äº‹ä»¶æ—¶ï¼Œå…ˆå¯¹è¯·æ±‚åšåˆ¤æ–­ï¼Œå¦‚æœæ˜¯ç®€å•çš„è¯·æ±‚ï¼Œå°±ç›´æ¥è¿”å›å“åº”äº†ï¼›å¦‚æœæ˜¯å¤æ‚è¯·æ±‚ï¼Œåˆ™ä»çº¿ç¨‹æ± ä¸­å–ä¸€ä¸ªçº¿ç¨‹è¿›è¡Œå¼‚æ­¥å¤„ç†ã€‚</p><p>çº¿ç¨‹å¤„ç†å®Œåï¼Œæœ‰ä¸¤ç§å¯èƒ½ï¼šä¸€ç§æ˜¯å·²ç»å¤„ç†å®Œæˆï¼Œåˆ™å‘ç”¨æˆ·å‘é€å“åº”ï¼›å¦ä¸€ç§æƒ…å†µæ˜¯è¿˜éœ€è¦è¿›ä¸€æ­¥å¤„ç†ï¼Œåˆ™å†ç”Ÿæˆä¸€ä¸ªäº‹ä»¶æ’å…¥åˆ°äº‹ä»¶é˜Ÿåˆ—ä¸­ç­‰å¾…å¤„ç†ã€‚äº‹ä»¶å¤„ç†å°±è¿™æ ·å¾ªç¯å¾€å¤ä¸‹å»ï¼Œæ°¸ä¸åœæ­‡ã€‚</p><h3>3. å®‰è£…ä¸ä½¿ç”¨ Node.js</h3><p>äº†è§£äº† Node.jsçš„åŸºæœ¬åŸç†åï¼Œæ¥ä¸‹æ¥æˆ‘ä»¬è¿˜æ˜¯è¦è„šè¸å®åœ°æ¥çœ‹çœ‹å…·ä½“å¦‚ä½•å®‰è£…ã€ä½¿ç”¨Node.jsã€‚</p><p><strong>ï¼ˆ1ï¼‰å®‰è£…Node.js</strong></p><p>ä¸åŒç¯å¢ƒä¸‹å®‰è£… Node.jsçš„æ–¹æ³•ä¹Ÿä¸ä¸€æ ·ï¼Œä¸è¿‡éƒ½å¾ˆç®€å•ã€‚</p><p>åœ¨Ubuntuç³»ç»Ÿä¸‹æ‰§è¡Œï¼š</p><pre><code>apt install nodejs\n</code></pre><p>æˆ–åœ¨Mac ç³»ç»Ÿä¸‹æ‰§è¡Œï¼š</p><pre><code>brew install nodejs\n</code></pre><p>é€šè¿‡ä»¥ä¸Šæ­¥éª¤ï¼ŒNode.js å¾ˆå¿«å°±å®‰è£…å¥½äº†ï¼ˆæˆ‘è¿™é‡Œå®‰è£…çš„ Node.jsç‰ˆæœ¬ä¸ºï¼šv8.10.0ï¼‰ã€‚</p><p><strong>ï¼ˆ2ï¼‰å®‰è£… NPM</strong></p><p>é™¤äº†å®‰è£… Node.js ä¹‹å¤–ï¼Œè¿˜è¦å®‰è£…NPMï¼ˆNode Package Managerï¼‰ï¼Œä¹Ÿå°±æ˜¯ Node.js çš„åŒ…ç®¡ç†å™¨ï¼Œæˆ–å«åŒ…å®‰è£…å·¥å…·ã€‚å®ƒä¸ Ubuntu ä¸‹çš„ APTï¼ˆAdvanced Package Toolï¼‰å‘½ä»¤æˆ– Mac ç³»ç»Ÿä¸‹çš„ BREW å‘½ä»¤ç±»ä¼¼ï¼Œæ˜¯ä¸“é—¨ç”¨æ¥ç®¡ç†å„ç§ä¾èµ–åº“çš„ã€‚</p><p>ä»¥Linuxä¸ºä¾‹ï¼Œåœ¨ APT æ²¡æœ‰å‡ºç°ä¹‹å‰ï¼Œåœ¨Linuxä¸Šå®‰è£…è½¯ä»¶æ˜¯ä»¶ç‰¹åˆ«éº»çƒ¦çš„äº‹å„¿ï¼Œæ¯”å¦‚è¦å®‰è£…ä¸€ä¸ªç¼–è¾‘å™¨ï¼Œå…¶åŸºæœ¬æ­¥éª¤æœ‰å¦‚ä¸‹:</p><ul>\n<li>å…ˆå°†è¿™ä¸ªå·¥å…·ï¼ˆç¼–è¾‘å™¨ï¼‰çš„æºç ä¸‹è½½ä¸‹æ¥ï¼›</li>\n<li>æ‰§è¡Œ./configure ç”ŸæˆMakefile æ–‡ä»¶ï¼›</li>\n<li>æ‰§è¡Œ make å‘½ä»¤å¯¹æºç è¿›è¡Œç¼–è¯‘ï¼›</li>\n<li>å¦‚æœç¼–è¯‘æˆåŠŸï¼Œæ‰§è¡Œ <code>make install</code> å°†å…¶å®‰è£…åˆ°æŒ‡å®šç›®å½•ä¸‹ï¼›</li>\n<li>å¦‚æœç¼–è¯‘è¿‡ç¨‹ä¸­å‘ç°è¿˜éœ€è¦å…¶ä»–åº“ï¼Œåˆ™è¦å¯¹ä¾èµ–åº“æ‰§è¡Œå‰é¢çš„4æ­¥ï¼Œä¹Ÿå°±æ˜¯å…ˆå°†ä¾èµ–åº“å®‰è£…å¥½ï¼Œç„¶åå†æ¥å®‰è£…è¯¥å·¥å…·ã€‚</li>\n</ul><p>ç”±è¿™ä½ å¯ä»¥çœ‹å‡ºï¼Œä»¥å‰åœ¨Linuxä¸‹å®‰è£…ä¸ªç¨‹åºæˆ–å·¥å…·æ˜¯å¤šä¹ˆéº»çƒ¦ã€‚</p><p>ä¸è¿‡ Linux æœ‰äº† APTå·¥å…·åï¼Œä¸€åˆ‡éƒ½å˜å¾—ç®€å•äº†ã€‚ä½ åªè¦æ‰§è¡Œ<code>apt install xxx</code>ä¸€æ¡å‘½ä»¤å°±å¥½äº†ï¼Œå®ƒä¼šå¸®ä½ å®Œæˆä¸Šé¢çš„ä¸€å †æ“ä½œã€‚</p><p>å¯¹äº Node.jsçš„å®‰è£…åŒ…ä¹Ÿæ˜¯å¦‚æ­¤ï¼Œ<strong>NPMå°±æ˜¯ç›¸å½“äº Linux ä¸‹çš„ APT å·¥å…·ï¼Œå®ƒçš„å‡ºç°å¤§å¤§æé«˜äº†JavaScript å¼€å‘äººå‘˜çš„å·¥ä½œæ•ˆç‡</strong>ã€‚</p><p>ä¸‹é¢æˆ‘ä»¬å°±æ¥çœ‹ä¸€ä¸‹å¦‚ä½•å®‰è£… NPM å·¥å…·ï¼Œå®é™…ä¸Šï¼ŒNPM çš„å®‰è£…å°±åƒå‰é¢å®‰è£… Node.js ä¸€æ ·ç®€å•ã€‚</p><p>åœ¨Ubuntuä¸‹æ‰§è¡Œï¼š</p><pre><code>apt install npm\n</code></pre><p>æˆ–åœ¨Macä¸‹æ‰§è¡Œï¼š</p><pre><code>brew install npm\n</code></pre><h3>4. Socket.ioçš„ä½¿ç”¨</h3><p>é™¤äº† Node.js å¤–ï¼Œæˆ‘ä»¬æœ€ç»ˆè¿˜è¦å€ŸåŠ©Socket.ioæ¥å®ç° WebRTC ä¿¡ä»¤æœåŠ¡å™¨ã€‚Socket.ioç‰¹åˆ«é€‚åˆç”¨æ¥å¼€å‘WebRTCçš„ä¿¡ä»¤æœåŠ¡å™¨ï¼Œé€šè¿‡å®ƒæ¥æ„å»ºä¿¡ä»¤æœåŠ¡å™¨å¤§å¤§ç®€åŒ–äº†ä¿¡ä»¤æœåŠ¡å™¨çš„å®ç°å¤æ‚åº¦ï¼Œè¿™ä¸»è¦æ˜¯å› ä¸ºå®ƒå†…ç½®äº†<strong>æˆ¿é—´</strong>çš„æ¦‚å¿µã€‚</p><p><img src=\"https://static001.geekbang.org/resource/image/d1/41/d172dc2cfab792759dbe2c1bc098ce41.png?wh=1142*585\" alt=\"\"></p><center><span class=\"reference\">Socket.io ä¸ Node.jså…³ç³»å›¾</span></center><p>ä¸Šå›¾æ˜¯ Socket.io ä¸ Node.jsé…åˆä½¿ç”¨çš„é€»è¾‘å…³ç³»å›¾ï¼Œå…¶é€»è¾‘éå¸¸ç®€å•ã€‚Socket.io åˆ†ä¸ºæœåŠ¡ç«¯å’Œå®¢æˆ·ç«¯ä¸¤éƒ¨åˆ†ã€‚æœåŠ¡ç«¯ç”± Node.jsåŠ è½½åä¾¦å¬æŸä¸ªæœåŠ¡ç«¯å£ï¼Œå®¢æˆ·ç«¯è¦æƒ³ä¸æœåŠ¡ç«¯ç›¸è¿ï¼Œé¦–å…ˆè¦åŠ è½½ Socket.io çš„å®¢æˆ·ç«¯åº“ï¼Œç„¶åè°ƒç”¨ <code>io.connect();</code>å³å¯ä¸æœåŠ¡ç«¯è¿æ¥ä¸Šã€‚</p><p>è¿™é‡Œéœ€è¦ç‰¹åˆ«å¼ºè°ƒçš„æ˜¯ Socket.io æ¶ˆæ¯çš„å‘é€ä¸æ¥æ”¶ã€‚Socket.io æœ‰å¾ˆå¤šç§å‘é€æ¶ˆæ¯çš„æ–¹å¼ï¼Œå…¶ä¸­æœ€å¸¸è§çš„æœ‰ä¸‹é¢å‡ ç§ï¼Œä¹Ÿæ˜¯ä½ å¿…é¡»è¦æŒæ¡çš„ã€‚</p><ul>\n<li>ç»™æœ¬æ¬¡è¿æ¥å‘æ¶ˆæ¯</li>\n</ul><pre><code>\tsocket.emit()\n</code></pre><ul>\n<li>ç»™æŸä¸ªæˆ¿é—´å†…æ‰€æœ‰äººå‘æ¶ˆæ¯</li>\n</ul><pre><code>\tio.in(room).emit()\n</code></pre><ul>\n<li>é™¤æœ¬è¿æ¥å¤–ï¼Œç»™æŸä¸ªæˆ¿é—´å†…æ‰€æœ‰äººå‘æ¶ˆæ¯</li>\n</ul><pre><code>\tsocket.to(room).emit()\n</code></pre><ul>\n<li>é™¤æœ¬è¿æ¥å¤–ï¼Œç»™æ‰€æœ‰äººå‘æ¶ˆæ¯</li>\n</ul><pre><code>\tsocket.broadcast.emit()\n</code></pre><p>ä½ ä¹Ÿå¯ä»¥çœ‹çœ‹ä¸‹é¢çš„ä¾‹å­ï¼Œå…¶ä¸­S è¡¨ç¤ºæœåŠ¡å™¨ï¼ŒC è¡¨ç¤ºå®¢æˆ·ç«¯ï¼Œå®ƒä»¬æ˜¯å‘é€æ¶ˆæ¯ä¸æ¥æ”¶æ¶ˆæ¯çš„æ¯”å¯¹ã€‚</p><ul>\n<li>å‘é€ command å‘½ä»¤</li>\n</ul><pre><code>\tS: socket.emit('cmdâ€™);\n\tC: socket.on('cmd',function(){...});\n</code></pre><ul>\n<li>å‘é€äº†ä¸€ä¸ª command å‘½ä»¤ï¼Œå¸¦ data æ•°æ®</li>\n</ul><pre><code>\tS: socket.emit('action', data);\n\tC: socket.on('action',function(data){...});\n</code></pre><ul>\n<li>å‘é€äº†commandå‘½ä»¤ï¼Œè¿˜æœ‰ä¸¤ä¸ªæ•°æ®</li>\n</ul><pre><code>\tS: socket.emit(action,arg1,arg2);\n\tC: socket.on('action',function(arg1,arg2){...});\n</code></pre><p>æœ‰äº†ä»¥ä¸Šè¿™äº›çŸ¥è¯†ï¼Œä½ å°±å¯ä»¥å®ç°ä¿¡ä»¤æ•°æ®é€šè®¯äº†ã€‚</p><h3>5. å®ç°ä¿¡ä»¤æœåŠ¡å™¨</h3><p>æ¥ä¸‹æ¥æˆ‘ä»¬æ¥çœ‹ä¸€ä¸‹ï¼Œå¦‚ä½•é€šè¿‡ Node.jsä¸‹çš„ Socket.io æ¥æ„å»ºä¸€ä¸ªæœåŠ¡å™¨ã€‚</p><p><strong>é¦–å…ˆæ˜¯å®¢æˆ·ç«¯ä»£ç ï¼Œä¹Ÿå°±æ˜¯åœ¨æµè§ˆå™¨é‡Œæ‰§è¡Œçš„ä»£ç </strong>ã€‚ä»¥ä¸‹æ˜¯index.htmlä»£ç ï¼š</p><pre><code>&lt;!DOCTYPE html&gt;\n&lt;html&gt;\n  &lt;head&gt;\n    &lt;title&gt;WebRTC client&lt;/title&gt;\n  &lt;/head&gt;\n  &lt;body&gt;\n    &lt;script src='/socket.io/socket.io.js'&gt;&lt;/script&gt;\n    &lt;script src='js/client.js'&gt;&lt;/script&gt;\n  &lt;/body&gt;\n&lt;/html&gt;\n</code></pre><p>è¯¥ä»£ç ååˆ†ç®€å•ï¼Œå°±æ˜¯åœ¨bodyé‡Œå¼•å…¥äº†ä¸¤æ®µ JavaScript ä»£ç ã€‚å…¶ä¸­ï¼Œsocket.io.js æ˜¯ç”¨æ¥ä¸æœåŠ¡ç«¯å»ºç«‹ Socket è¿æ¥çš„ï¼›client.js çš„ä½œç”¨æ˜¯åšä¸€äº›ä¸šåŠ¡é€»è¾‘ï¼Œå¹¶æœ€ç»ˆé€šè¿‡ Socket ä¸æœåŠ¡ç«¯é€šè®¯ã€‚</p><p>ä¸‹é¢æ˜¯client.jsçš„ä»£ç ï¼š</p><pre><code>var isInitiator;\n\nroom = prompt('Enter room name:'); //å¼¹å‡ºä¸€ä¸ªè¾“å…¥çª—å£\n\nconst socket = io.connect(); //ä¸æœåŠ¡ç«¯å»ºç«‹socketè¿æ¥\n\nif (room !== '') { //å¦‚æœæˆ¿é—´ä¸ç©ºï¼Œåˆ™å‘é€ &quot;create or join&quot; æ¶ˆæ¯\n  console.log('Joining room ' + room);\n  socket.emit('create or join', room);\n}\n\nsocket.on('full', (room) =&gt; { //å¦‚æœä»æœåŠ¡ç«¯æ”¶åˆ° &quot;full&quot; æ¶ˆæ¯\n  console.log('Room ' + room + ' is full');\n});\n\nsocket.on('empty', (room) =&gt; { //å¦‚æœä»æœåŠ¡ç«¯æ”¶åˆ° &quot;empty&quot; æ¶ˆæ¯\n  isInitiator = true;\n  console.log('Room ' + room + ' is empty');\n});\n\nsocket.on('join', (room) =&gt; { //å¦‚æœä»æœåŠ¡ç«¯æ”¶åˆ° â€œjoin&quot; æ¶ˆæ¯\n  console.log('Making request to join room ' + room);\n  console.log('You are the initiator!');\n});\n\nsocket.on('log', (array) =&gt; {\n  console.log.apply(console, array);\n});\n</code></pre><p>åœ¨è¯¥ä»£ç ä¸­ï¼Œé¦–å…ˆå¼¹å‡ºä¸€ä¸ªè¾“å…¥æ¡†ï¼Œè¦æ±‚ç”¨æˆ·å†™å…¥è¦åŠ å…¥çš„æˆ¿é—´ï¼›ç„¶åï¼Œé€šè¿‡ io.connect() å»ºç«‹ä¸æœåŠ¡ç«¯çš„è¿æ¥ï¼›æœ€åå†æ ¹æ®socketè¿”å›çš„æ¶ˆæ¯åšä¸åŒçš„å¤„ç†ï¼Œæ¯”å¦‚æ”¶åˆ°æˆ¿é—´æ»¡æˆ–ç©ºçš„æ¶ˆæ¯ç­‰ã€‚</p><p><strong>ä»¥ä¸Šæ˜¯å®¢æˆ·ç«¯ï¼ˆä¹Ÿå°±æ˜¯åœ¨æµè§ˆå™¨ï¼‰ä¸­æ‰§è¡Œçš„ä»£ç ã€‚ä¸‹é¢æˆ‘ä»¬æ¥çœ‹ä¸€ä¸‹æœåŠ¡ç«¯çš„å¤„ç†é€»è¾‘ã€‚</strong></p><p>æœåŠ¡å™¨ç«¯ä»£ç ï¼Œserver.jsæ˜¯è¿™æ ·çš„ï¼š</p><pre><code>const static = require('node-static');\nconst http = require('http');\nconst file = new(static.Server)();\nconst app = http.createServer(function (req, res) {\n  file.serve(req, res);\n}).listen(2013);\n\nconst io = require('socket.io').listen(app); //ä¾¦å¬ 2013\n\nio.sockets.on('connection', (socket) =&gt; {\n\n  // convenience function to log server messages to the client\n  function log(){ \n    const array = ['&gt;&gt;&gt; Message from server: ']; \n    for (var i = 0; i &lt; arguments.length; i++) {\n      array.push(arguments[i]);\n    } \n      socket.emit('log', array);\n  }\n\n  socket.on('message', (message) =&gt; { //æ”¶åˆ°messageæ—¶ï¼Œè¿›è¡Œå¹¿æ’­\n    log('Got message:', message);\n    // for a real app, would be room only (not broadcast)\n    socket.broadcast.emit('message', message); //åœ¨çœŸå®çš„åº”ç”¨ä¸­ï¼Œåº”è¯¥åªåœ¨æˆ¿é—´å†…å¹¿æ’­\n  });\n\n  socket.on('create or join', (room) =&gt; { //æ”¶åˆ° â€œcreate or joinâ€ æ¶ˆæ¯\n\n\tvar clientsInRoom = io.sockets.adapter.rooms[room];\n    var numClients = clientsInRoom ? Object.keys(clientsInRoom.sockets).length : 0; //æˆ¿é—´é‡Œçš„äººæ•°\n\n    log('Room ' + room + ' has ' + numClients + ' client(s)');\n    log('Request to create or join room ' + room);\n\n    if (numClients === 0){ //å¦‚æœæˆ¿é—´é‡Œæ²¡äºº\n      socket.join(room);\n      socket.emit('created', room); //å‘é€ &quot;created&quot; æ¶ˆæ¯\n    } else if (numClients === 1) { //å¦‚æœæˆ¿é—´é‡Œæœ‰ä¸€ä¸ªäºº\n\t  io.sockets.in(room).emit('join', room);\n      socket.join(room);\n      socket.emit('joined', room); //å‘é€ â€œjoinedâ€æ¶ˆæ¯\n    } else { // max two clients\n      socket.emit('full', room); //å‘é€ &quot;full&quot; æ¶ˆæ¯\n    }\n    socket.emit('emit(): client ' + socket.id +\n      ' joined room ' + room);\n    socket.broadcast.emit('broadcast(): client ' + socket.id +\n      ' joined room ' + room);\n\n  });\n\n});\n</code></pre><p>è¯¥æ®µä»£ç ä¸­ï¼Œåœ¨æœåŠ¡ç«¯å¼•å…¥äº† node-static åº“ï¼Œä½¿æœåŠ¡å™¨å…·æœ‰å‘å¸ƒé™æ€æ–‡ä»¶çš„åŠŸèƒ½ã€‚æœåŠ¡å™¨å…·æœ‰æ­¤åŠŸèƒ½åï¼Œå½“å®¢æˆ·ç«¯ï¼ˆæµè§ˆå™¨ï¼‰å‘æœåŠ¡ç«¯å‘èµ·è¯·æ±‚æ—¶ï¼ŒæœåŠ¡å™¨é€šè¿‡è¯¥æ¨¡å—è·å¾—å®¢æˆ·ç«¯ï¼ˆæµè§ˆå™¨ï¼‰è¿è¡Œçš„ä»£ç ï¼Œä¹Ÿå°±æ˜¯ä¸Šé¢æˆ‘ä»¬è®²åˆ°çš„ index.html å’Œ client.jsï¼Œä¸‹å‘ç»™å®¢æˆ·ç«¯ï¼ˆæµè§ˆå™¨ï¼‰ã€‚</p><p>æœåŠ¡ç«¯ä¾¦å¬ 2013 è¿™ä¸ªç«¯å£ï¼Œå¯¹ä¸åŒçš„æ¶ˆæ¯åšç›¸åº”çš„å¤„ç†ï¼š</p><ul>\n<li>æœåŠ¡å™¨æ”¶åˆ° message æ¶ˆæ¯æ—¶ï¼Œå®ƒä¼šç›´æ¥è¿›è¡Œå¹¿æ’­ï¼Œè¿™æ ·æ‰€æœ‰è¿æ¥åˆ°è¯¥æœåŠ¡å™¨çš„å®¢æˆ·ç«¯éƒ½ä¼šæ”¶åˆ°å¹¿æ’­çš„æ¶ˆæ¯ã€‚</li>\n<li>æœåŠ¡ç«¯æ”¶åˆ°â€œcreate or joinâ€æ¶ˆæ¯æ—¶ï¼Œå®ƒä¼šå¯¹æˆ¿é—´é‡Œçš„äººæ•°è¿›è¡Œç»Ÿè®¡ï¼Œå¦‚æœæˆ¿é—´é‡Œæ²¡æœ‰äººï¼Œåˆ™å‘é€â€œcreatedâ€æ¶ˆæ¯ï¼›å¦‚æœæˆ¿é—´é‡Œæœ‰ä¸€ä¸ªäººï¼Œå‘é€â€œjoinâ€æ¶ˆæ¯å’Œâ€œjoinedâ€æ¶ˆæ¯ï¼›å¦‚æœè¶…è¿‡ä¸¤ä¸ªäººï¼Œåˆ™å‘é€â€œfullâ€æ¶ˆæ¯ã€‚</li>\n</ul><p>è¦è¿è¡Œè¯¥ç¨‹åºï¼Œéœ€è¦ä½¿ç”¨ NPM å®‰è£… socket.io å’Œ<a href=\"https://github.com/cloudhead/node-static\">node-static</a>ï¼Œå®‰è£…æ–¹æ³•å¦‚ä¸‹ï¼š</p><pre><code>npm install socket.io\nnpm install node-static\n</code></pre><h2>å¯åŠ¨æœåŠ¡å™¨å¹¶æµ‹è¯•</h2><p>é€šè¿‡ä¸Šé¢çš„æ­¥éª¤ï¼Œä½ å°±ä½¿ç”¨â€œSocket.io + Node.jsâ€å®ç°äº†ä¸€ä¸ªä¿¡ä»¤æœåŠ¡å™¨ã€‚ç°åœ¨ä½ è¿˜å¯ä»¥é€šè¿‡ä¸‹é¢çš„å‘½ä»¤å°†æœåŠ¡å¯åŠ¨èµ·æ¥äº†ï¼š</p><pre><code>node server.js\n</code></pre><p>å¦‚æœä½ æ˜¯åœ¨æœ¬æœºä¸Šæ­å»ºçš„æœåŠ¡ï¼Œåˆ™å¯ä»¥åœ¨æµè§ˆå™¨ä¸­è¾“å…¥â€œlocalhost:2013â€ï¼Œç„¶ååœ¨æµè§ˆå™¨ä¸­æ–°å»ºä¸€ä¸ªtab ï¼Œåœ¨é‡Œè¾¹å†æ¬¡è¾“å…¥â€œlocalhost:2013â€ã€‚è¿™æ—¶ï¼Œä½ å°±å¯ä»¥é€šè¿‡æµè§ˆå™¨çš„æ§åˆ¶å°å»çœ‹çœ‹å‘ç”Ÿäº†ä»€ä¹ˆå§ï¼</p><p>æœ€åï¼Œå†è¯´ä¸€ä¸ªå¿«æ·é”®å°æŠ€å·§å§ï¼Œåœ¨Chromeä¸‹ï¼Œä½ å¯ä»¥ä½¿ç”¨Command-Option-Jæˆ–Ctrl-Shift-Jçš„DevToolså¿«é€Ÿè®¿é—®æ§åˆ¶å°ã€‚</p><h2>å°ç»“</h2><p>åœ¨æœ¬æ–‡ä¸­ï¼Œæˆ‘ä»¬ä»‹ç»äº† Node.js çš„å·¥ä½œåŸç†ã€Node.jsçš„å®‰è£…ä¸å¸ƒç½²ï¼Œä»¥åŠå¦‚ä½•ä½¿ç”¨â€œSokcet.io + Node.jsâ€å®ç° WebRTC ä¿¡ä»¤æ¶ˆæ¯æœåŠ¡å™¨ã€‚Socket.io ç”±äºæœ‰æˆ¿é—´çš„æ¦‚å¿µï¼Œæ‰€ä»¥ä¸WebRTCéå¸¸åŒ¹é…ï¼Œå› æ­¤ï¼Œç”¨å®ƒå¼€å‘WebRTCä¿¡ä»¤æœåŠ¡å™¨å°±ä¼šå¤§å¤§åœ°å‡å°‘å·¥ä½œé‡ã€‚</p><p>å¦å¤–ï¼Œæœ¬æ–‡ä¸­çš„ä¾‹å­è™½è¯´å¾ˆç®€å•ï¼Œä½†åœ¨åé¢çš„æ–‡ç« ä¸­æˆ‘ä¼šä»¥è¿™ä¸ªä¾‹å­ä¸ºåŸºç¡€ï¼Œåœ¨å…¶ä¸Šé¢ä¸æ–­å¢åŠ ä¸€äº›åŠŸèƒ½ï¼Œè¿™æ ·æœ€ç»ˆä½ å°±ä¼šçœ‹åˆ°ä¸€ä¸ªå®Œæ•´çš„Demoç¨‹åºã€‚æ‰€ä»¥ä½ ç°åœ¨è¿˜æ˜¯è¦å­¦ä¹ å¥½è¿™æ¯ä¸€ä¸ªçŸ¥è¯†ç‚¹ï¼Œæ‰“å¥½åŸºç¡€ï¼Œç§¯è·¬æ­¥æ‰èƒ½è‡³åƒé‡Œã€‚</p><h2>æ€è€ƒæ—¶é—´</h2><p>æ–‡ä¸­æ‰€è®²çš„JavaScriptä»£ç éœ€è¦è¿è¡Œåœ¨ä¸¤ä¸ªä¸åŒçš„ V8 å¼•æ“ä¸Šï¼Œä½ çŸ¥é“å®ƒä»¬çš„å¯¹åº”å…³ç³»å—ï¼Ÿ</p><p>æ¬¢è¿åœ¨ç•™è¨€åŒºä¸æˆ‘åˆ†äº«ä½ çš„æƒ³æ³•ï¼Œä¹Ÿæ¬¢è¿ä½ åœ¨ç•™è¨€åŒºè®°å½•ä½ çš„æ€è€ƒè¿‡ç¨‹ã€‚æ„Ÿè°¢é˜…è¯»ï¼Œå¦‚æœä½ è§‰å¾—è¿™ç¯‡æ–‡ç« å¯¹ä½ æœ‰å¸®åŠ©çš„è¯ï¼Œä¹Ÿæ¬¢è¿æŠŠå®ƒåˆ†äº«ç»™æ›´å¤šçš„æœ‹å‹ã€‚</p><p><a href=\"https://github.com/avdance/webrtc_web/tree/master/11_signal\">æ‰€åšDemoçš„GitHubé“¾æ¥ï¼ˆæœ‰éœ€è¦å¯ä»¥ç‚¹è¿™é‡Œï¼‰</a></p><p></p>","neighbors":{"left":{"article_title":"10 | WebRTC NATç©¿è¶ŠåŸç†","id":113560},"right":{"article_title":"12 | RTCPeerConnectionï¼šéŸ³è§†é¢‘å®æ—¶é€šè®¯çš„æ ¸å¿ƒ","id":116324}},"comments":[{"had_liked":false,"id":132384,"user_name":"èŠ±æœå±±ã®é…¸æ¢…æ±¤","can_delete":false,"product_type":"c1","uid":1606018,"ip_address":"","ucode":"E4A71E8AD52CB3","user_header":"https://thirdwx.qlogo.cn/mmopen/vi_32/DYAIOgq83eoicwtj6x3l7NEcODqsXHjUTjzbl99pesNbydQUSfR6IywcKKyyaY9AIhBS0bCz3R8icMRIploDdUQA/132","comment_is_top":false,"comment_ctime":1568104805,"is_pvip":false,"replies":[{"id":"50824","content":"very good!","user_name":"ä½œè€…å›å¤","comment_id":132384,"uid":"1507837","ip_address":"","utype":1,"ctime":1568195264,"user_name_real":"garrylee"}],"discussion_count":1,"race_medal":0,"score":"27337908581","product_id":100031801,"comment_content":"clientä»£ç è¿è¡Œäºæµè§ˆå™¨æ¸²æŸ“å¼•æ“ä¸­çš„V8å¼•æ“ï¼Œserverä»£ç è¿è¡ŒäºNode.jsçš„JSè¿è¡Œæ—¶çš„V8å¼•æ“éƒ¨åˆ†ã€‚ä¸€ä¸ªé¢å‘æ¸²æŸ“ä¸€ä¸ªé¢å‘æä¾›åå°æœåŠ¡ã€‚","like_count":7,"discussions":[{"author":{"id":1507837,"avatar":"https://static001.geekbang.org/account/avatar/00/17/01/fd/69869646.jpg","nickname":"éŸ³è§†é¢‘ä¸“å®¶-æè¶…","note":"","ucode":"5557943CF28441","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":466906,"discussion_content":"very good!","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1568195264,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":150099,"user_name":"jike","can_delete":false,"product_type":"c1","uid":1724147,"ip_address":"","ucode":"CD8BB7CD308DBE","user_header":"https://wx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTJaCVXshyiclaBQpxvIWQknKdEeicJ6vv69ZsjPmlIa69Ba32kXe10Djk4kBjiap4j6yuicTA1xaptFfA/132","comment_is_top":false,"comment_ctime":1573461864,"is_pvip":false,"replies":[{"id":"58303","content":"å¦‚æœä½ å¯¹ node ä¸ç†Ÿæ‚‰çš„è¯ï¼Œç¡®å®ä¼šæœ‰è¿™ç±»é—®é¢˜ã€‚å»ºè®®ä½ çœ‹ä¸€ä¸‹æˆ‘åœ¨imooc.comä¸­çš„webrtcå…¥é—¨ä¸å®æˆ˜çš„è§†é¢‘ï¼Œåœ¨é‚£ä¸ªè§†é¢‘ä¸­æœ‰è®²å…·ä½“çš„æ­¥éª¤ï¼","user_name":"ä½œè€…å›å¤","comment_id":150099,"uid":"1507837","ip_address":"","utype":1,"ctime":1573780720,"user_name_real":"garrylee"}],"discussion_count":1,"race_medal":0,"score":"10163396456","product_id":100031801,"comment_content":"ä¸æ‡‚ node çš„å°ç™½<br>å®¢æˆ·ç«¯è¿è¡ŒæŠ¥é”™ 404  http:&#47;&#47;127.0.0.1:8000&#47;socket.io&#47;?EIO=3&amp;transport=polling&amp;t=MvPeDk4ï¼›<br>æœåŠ¡ç«¯è¿è¡Œæ²¡æœ‰ä»»ä½•è¾“å‡º æµè§ˆå™¨ä¹Ÿè®¿é—®ä¸äº†","like_count":2,"discussions":[{"author":{"id":1507837,"avatar":"https://static001.geekbang.org/account/avatar/00/17/01/fd/69869646.jpg","nickname":"éŸ³è§†é¢‘ä¸“å®¶-æè¶…","note":"","ucode":"5557943CF28441","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":474064,"discussion_content":"å¦‚æœä½ å¯¹ node ä¸ç†Ÿæ‚‰çš„è¯ï¼Œç¡®å®ä¼šæœ‰è¿™ç±»é—®é¢˜ã€‚å»ºè®®ä½ çœ‹ä¸€ä¸‹æˆ‘åœ¨imooc.comä¸­çš„webrtcå…¥é—¨ä¸å®æˆ˜çš„è§†é¢‘ï¼Œåœ¨é‚£ä¸ªè§†é¢‘ä¸­æœ‰è®²å…·ä½“çš„æ­¥éª¤ï¼","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1573780720,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":122123,"user_name":"Ethan","can_delete":false,"product_type":"c1","uid":1245831,"ip_address":"","ucode":"A216242291A7BE","user_header":"https://static001.geekbang.org/account/avatar/00/13/02/87/047259c9.jpg","comment_is_top":false,"comment_ctime":1565307968,"is_pvip":false,"replies":[{"id":"44958","content":"å¯ä»¥ï¼Œç”¨websoketä½ è¦è‡ªå·±å†™ä¸€ä¸ªæˆ¿é—´æœåŠ¡å™¨","user_name":"ä½œè€…å›å¤","comment_id":122123,"uid":"1507837","ip_address":"","utype":1,"ctime":1565410053,"user_name_real":"garrylee"}],"discussion_count":1,"race_medal":0,"score":"10155242560","product_id":100031801,"comment_content":"å®¢æˆ·ç«¯ä¸€å®šè¦å¼•å…¥socket. ioå—ï¼Ÿå¯ä»¥ç›´æ¥ç”¨ websocket apiå—","like_count":2,"discussions":[{"author":{"id":1507837,"avatar":"https://static001.geekbang.org/account/avatar/00/17/01/fd/69869646.jpg","nickname":"éŸ³è§†é¢‘ä¸“å®¶-æè¶…","note":"","ucode":"5557943CF28441","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":462111,"discussion_content":"å¯ä»¥ï¼Œç”¨websoketä½ è¦è‡ªå·±å†™ä¸€ä¸ªæˆ¿é—´æœåŠ¡å™¨","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1565410053,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":310612,"user_name":"bohao","can_delete":false,"product_type":"c1","uid":1064024,"ip_address":"","ucode":"8BB2AFA9462FBE","user_header":"https://static001.geekbang.org/account/avatar/00/10/3c/58/81307481.jpg","comment_is_top":false,"comment_ctime":1630771439,"is_pvip":true,"discussion_count":1,"race_medal":0,"score":"5925738735","product_id":100031801,"comment_content":"æ–°ç‰ˆæœ¬çš„ socket.io ä»£ç éœ€è¦ä¿®æ”¹ä¸‹ï¼Œæ¯”å¦‚ io.sockets.adapter.rooms[room] æ˜¯ä¸ª Map&lt;String, Set&lt;String&gt;&gt;","like_count":1,"discussions":[{"author":{"id":2166878,"avatar":"https://static001.geekbang.org/account/avatar/00/21/10/5e/42f4faf7.jpg","nickname":"å¤©æ‹©","note":"","ucode":"ED2B08DB2F2B38","race_medal":4,"user_type":1,"is_pvip":true},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":538254,"discussion_content":"ç¡®å®å¦‚æ­¤ï¼Œè·å–æˆ¿é—´å½“å‰å¤§å°ï¼Œå¯ä»¥ç›´æ¥ä½¿ç”¨Setçš„sizeå±æ€§ï¼š\nvar myRoom = io.sockets.adapter.rooms.get(room);\nvar users = (myRoom)? myRoom.size : 0;\næ¯ä¸ªroomç»´æŠ¤çš„æ˜¯ä¸€ä¸ªsocket Setï¼š\nhttps://github.com/socketio/socket.io-adapter/blob/master/lib/index.ts","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1639384513,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":248293,"user_name":"å®‡å®™ä¹‹ç‹","can_delete":false,"product_type":"c1","uid":1981915,"ip_address":"","ucode":"5E6C28F8CCFF6D","user_header":"","comment_is_top":false,"comment_ctime":1600092068,"is_pvip":false,"replies":[{"id":"91440","content":"ä½ è§‰å¾—å‘¢ï¼Ÿå®é™…ä¸Šå®ƒä¼šåˆ©ç”¨æµè§ˆå™¨çš„è¿æ¥ï¼Œä½ å†å¥½å¥½ç†è§£ä¸€ä¸‹","user_name":"ä½œè€…å›å¤","comment_id":248293,"uid":"1507837","ip_address":"","utype":1,"ctime":1600529642,"user_name_real":"éŸ³è§†é¢‘ä¸“å®¶-æè¶…"}],"discussion_count":1,"race_medal":0,"score":"5895059364","product_id":100031801,"comment_content":"è€å¸ˆå¥½ï¼Œæœ‰ä¸ªé—®é¢˜ä¸æ˜ç™½ï¼Œsocket = io.connect(); æ²¡æŒ‡å®šç«¯å£ä¹Ÿèƒ½è¿æ¥é€šå—ï¼Ÿç¬¬ä¸€æ¬¡æ¥è§¦nodeï¼ŒåºŸäº†åŠå¤©åŠ²ï¼Œè¿™ç« æºç å’Œè¯¾ç¨‹ä¸å¤ªä¸€è‡´ï¼Œè¿è¡Œä¸äº†ï¼Œå®‰è£…å„ç§nodeæ¨¡å—åˆæŠŠserver.js åšäº†å¦‚ä¸‹ä¿®æ”¹ æš‚æ—¶å»æ‰äº†httpså’Œlog4jï¼Œå·²éƒ¨ç½²åˆ°æœåŠ¡å™¨æµ‹è¯•ï¼Œå¤§å®¶æœ‰è°ƒä¸é€šçš„å…ˆè¯•è¯•è¿™ä¸ªï¼Œæœ‰é—®é¢˜äº’ç›¸å¤šæ²Ÿé€š<br>&#39;use strict&#39;<br><br>var http = require(&#39;http&#39;);<br>var https = require(&#39;https&#39;);<br>var fs = require(&#39;fs&#39;);<br>var socketIo = require(&#39;socket.io&#39;);<br><br>var express = require(&#39;express&#39;);<br>var serveIndex = require(&#39;serve-index&#39;);<br><br>var USERCOUNT = 4;<br><br>var app = express();<br>app.use(serveIndex(&#39;.&#47;public&#39;));<br>app.use(express.static(&#39;.&#47;public&#39;));<br><br>&#47;&#47;http server<br>var http_server = http.createServer(app);<br>var io = socketIo.listen(http_server);<br><br>io.sockets.on(&#39;connection&#39;, (socket)=&gt; {<br><br>\tsocket.on(&#39;message&#39;, (room, data)=&gt;{<br>\t    console.log(&#39;message, room: &#39; + room + &quot;, data, type:&quot; + data);<br>\t\tsocket.to(room).emit(&#39;message&#39;,room, data+&#39;from server!&#39;);<br>\t});<br><br>\tsocket.on(&#39;join&#39;, (room)=&gt;{<br>\t\tsocket.join(room);<br>\t\tvar myRoom = io.sockets.adapter.rooms[room]; <br>\t\tvar users = (myRoom)? Object.keys(myRoom.sockets).length : 0;<br>\t\tconsole.log(&#39;the user number of room (&#39; + room + &#39;) is: &#39; + users);<br><br>\t\tif(users &lt; USERCOUNT){<br>\t\t\tsocket.emit(&#39;joined&#39;, room, socket.id); &#47;&#47;å‘ç»™é™¤è‡ªå·±ä¹‹å¤–çš„æˆ¿é—´å†…çš„æ‰€æœ‰äºº<br>\t\t\tif(users &gt; 1){<br>\t\t\t\tsocket.to(room).emit(&#39;otherjoin&#39;, room, socket.id);<br>\t\t\t}<br>\t\t<br>\t\t}else{<br>\t\t\tsocket.leave(room);\t<br>\t\t\tsocket.emit(&#39;full&#39;, room, socket.id);<br>\t\t}<br>\t});<br><br>\tsocket.on(&#39;leave&#39;, (room)=&gt;{<br><br>\t\tsocket.leave(room);<br><br>\t\tvar myRoom = io.sockets.adapter.rooms[room]; <br>\t\tvar users = (myRoom)? Object.keys(myRoom.sockets).length : 0;<br>\t\tconsole.log(&#39;the user number of room is: &#39; + users);<br><br>\t\tsocket.to(room).emit(&#39;bye&#39;, room, socket.id);<br>\t\tsocket.emit(&#39;leaved&#39;, room, socket.id);<br>\t});<br><br>});<br><br>http_server.listen(8080, &#39;0.0.0.0&#39;);<br><br><br><br>","like_count":1,"discussions":[{"author":{"id":1507837,"avatar":"https://static001.geekbang.org/account/avatar/00/17/01/fd/69869646.jpg","nickname":"éŸ³è§†é¢‘ä¸“å®¶-æè¶…","note":"","ucode":"5557943CF28441","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":505609,"discussion_content":"ä½ è§‰å¾—å‘¢ï¼Ÿå®é™…ä¸Šå®ƒä¼šåˆ©ç”¨æµè§ˆå™¨çš„è¿æ¥ï¼Œä½ å†å¥½å¥½ç†è§£ä¸€ä¸‹","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1600529642,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":193724,"user_name":"like_wind","can_delete":false,"product_type":"c1","uid":1755021,"ip_address":"","ucode":"2733C299AE56AE","user_header":"http://thirdwx.qlogo.cn/mmopen/vi_32/DYAIOgq83eolBabicK5OTVJJJlUA4wwRtwCohCb75ahtbiaopsicnG3HRQTBOVEUrRY1KYCRZH78cDweQllh0Jzeg/132","comment_is_top":false,"comment_ctime":1584954988,"is_pvip":false,"replies":[{"id":"73964","content":"æ˜¯çš„ï¼Œå°±æ˜¯æŒ‡åè€…â€œä¸€ä¸ªç›´æ’­é—´â€","user_name":"ä½œè€…å›å¤","comment_id":193724,"uid":"1507837","ip_address":"","utype":1,"ctime":1585037245,"user_name_real":"garrylee"}],"discussion_count":1,"race_medal":0,"score":"5879922284","product_id":100031801,"comment_content":"æ²¡å¤ªç†è§£è€å¸ˆè¯´çš„è¿™ä¸ªæˆ¿é—´çš„æ¦‚å¿µï¼Œæ–‡ä¸­æåˆ°çš„â€œæˆ¿é—´æ¦‚å¿µâ€æ˜¯æŒ‡å®¢æˆ·ç«¯å’ŒæœåŠ¡ç«¯çš„ä¸€ä¸ªè¿æ¥å°±æ˜¯ä¸€ä¸ªæˆ¿é—´å—ï¼Ÿè¿˜æ˜¯è¯´è¿™ä¸ªæˆ¿é—´æŒ‡çš„æ˜¯ä¸šåŠ¡ä¸Šçš„æŸä¸€ä¸ªæˆ¿é—´ï¼Œæ¯”å¦‚è¯´æŸç›´æ’­å¹³å°çš„ä¸€ä¸ªç›´æ’­é—´?","like_count":1,"discussions":[{"author":{"id":1507837,"avatar":"https://static001.geekbang.org/account/avatar/00/17/01/fd/69869646.jpg","nickname":"éŸ³è§†é¢‘ä¸“å®¶-æè¶…","note":"","ucode":"5557943CF28441","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":488637,"discussion_content":"æ˜¯çš„ï¼Œå°±æ˜¯æŒ‡åè€…â€œä¸€ä¸ªç›´æ’­é—´â€","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1585037245,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":160716,"user_name":"å¤©å¤©","can_delete":false,"product_type":"c1","uid":1429387,"ip_address":"","ucode":"277B665E8207CF","user_header":"https://static001.geekbang.org/account/avatar/00/15/cf/8b/2b4ef30f.jpg","comment_is_top":false,"comment_ctime":1576025432,"is_pvip":true,"replies":[{"id":"66625","content":"nodejs åº•å±‚ç”¨çš„ libuv, åœ¨ libuv ä¸­ä½¿ç”¨äº†çº¿ç¨‹æ± ï¼Œä½ å¯ä»¥çœ‹ä¸€ä¸‹libuvçš„æºç  https:&#47;&#47;github.com&#47;libuv&#47;libuv&#47;tree&#47;v1.x&#47;src","user_name":"ä½œè€…å›å¤","comment_id":160716,"uid":"1507837","ip_address":"","utype":1,"ctime":1579016230,"user_name_real":"garrylee"}],"discussion_count":1,"race_medal":0,"score":"5870992728","product_id":100031801,"comment_content":"è€å¸ˆï¼Œæ‚¨åœ¨ä»‹ç»node. jsçš„Reactoræ¨¡å¼æ—¶å’Œæˆ‘ä»¥å¾€ç†è§£çš„æœ‰ç‚¹å‡ºå…¥ã€‚æ‚¨è¯´é“æœ‰ä¸ªçº¿ç¨‹æ± çš„æ¦‚å¿µï¼Œæˆ‘çš„ç†è§£åº”è¯¥æ˜¯æ²¡æœ‰çš„å–”(è™½ç„¶æˆ‘ä»¬å¯ä»¥ä½¿ç”¨workeræ¥åˆ›å»ºï¼‰è¿˜è¯·æç‚¹ä¸€ä¸‹æˆ‘å‘¦ï¼Œæ¨æˆ‘ç¯‡æ–‡ç« ä¹Ÿè¡ŒğŸ˜è°¢è°¢å•¦","like_count":1,"discussions":[{"author":{"id":1507837,"avatar":"https://static001.geekbang.org/account/avatar/00/17/01/fd/69869646.jpg","nickname":"éŸ³è§†é¢‘ä¸“å®¶-æè¶…","note":"","ucode":"5557943CF28441","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":477459,"discussion_content":"nodejs åº•å±‚ç”¨çš„ libuv, åœ¨ libuv ä¸­ä½¿ç”¨äº†çº¿ç¨‹æ± ï¼Œä½ å¯ä»¥çœ‹ä¸€ä¸‹libuvçš„æºç  https://github.com/libuv/libuv/tree/v1.x/src","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1579016230,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":139683,"user_name":"dahaowenge","can_delete":false,"product_type":"c1","uid":1677266,"ip_address":"","ucode":"90E104E004F79C","user_header":"https://static001.geekbang.org/account/avatar/00/19/97/d2/daaed7d8.jpg","comment_is_top":false,"comment_ctime":1570704425,"is_pvip":false,"replies":[{"id":"54147","content":"ä½ è¦ä½¿ç”¨è‡ªå·±çš„è¯ä¹¦ï¼Œè¿™æ˜¯æˆ‘çš„è¯ä¹¦ä½ æ˜¯ä¸èƒ½ç”¨çš„ã€‚å¦å¤–è¦ä½¿ç”¨çœŸæ­£çš„è¯ä¹¦ï¼Œä½ å¯ä»¥é€šè¿‡è´­ä¹°åŸŸçš„ï¼Œç„¶åç”³è¯·å…è´¹è¯ä¹¦çš„æ–¹å¼è·å–ã€‚è´­ä¹°ä¸€ä¸ªåŸŸåæœ€ä¾¿å®œçš„ 6å…ƒã€‚ä½†å¦‚æœåœ¨å›½å†…è´­ä¹°åŸŸåçš„è¯ï¼Œè¿˜è¦è¿›è¡Œå¤‡æ¡ˆï¼Œè¿™ä¸ªåœ¨åŒ—äº¬éœ€è¦ 20å¤©çš„æ—¶é—´","user_name":"ä½œè€…å›å¤","comment_id":139683,"uid":"1507837","ip_address":"","utype":1,"ctime":1570818440,"user_name_real":"garrylee"}],"discussion_count":3,"race_medal":0,"score":"5865671721","product_id":100031801,"comment_content":"node serves.js     Error: ENOENT: no such file or directory, open &#39;.&#47;cert&#47;1557605_www.learningrtc.cn.key&#39;","like_count":1,"discussions":[{"author":{"id":1507837,"avatar":"https://static001.geekbang.org/account/avatar/00/17/01/fd/69869646.jpg","nickname":"éŸ³è§†é¢‘ä¸“å®¶-æè¶…","note":"","ucode":"5557943CF28441","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":470055,"discussion_content":"ä½ è¦ä½¿ç”¨è‡ªå·±çš„è¯ä¹¦ï¼Œè¿™æ˜¯æˆ‘çš„è¯ä¹¦ä½ æ˜¯ä¸èƒ½ç”¨çš„ã€‚å¦å¤–è¦ä½¿ç”¨çœŸæ­£çš„è¯ä¹¦ï¼Œä½ å¯ä»¥é€šè¿‡è´­ä¹°åŸŸçš„ï¼Œç„¶åç”³è¯·å…è´¹è¯ä¹¦çš„æ–¹å¼è·å–ã€‚è´­ä¹°ä¸€ä¸ªåŸŸåæœ€ä¾¿å®œçš„ 6å…ƒã€‚ä½†å¦‚æœåœ¨å›½å†…è´­ä¹°åŸŸåçš„è¯ï¼Œè¿˜è¦è¿›è¡Œå¤‡æ¡ˆï¼Œè¿™ä¸ªåœ¨åŒ—äº¬éœ€è¦ 20å¤©çš„æ—¶é—´","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1570818440,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1876823,"avatar":"https://thirdwx.qlogo.cn/mmopen/vi_32/X4ib36ADEvj76XaKD4OUY9k15KqWCAVCwibPicBxz6BBUfDrVolpYInn8zFOw3JBPtVw3L4Lkibaf2eLPemwGKzAXA/132","nickname":"Geek_427d0c","note":"","ucode":"D7A04138C4B8CB","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":350676,"discussion_content":"åˆ¶ä½œè‡ªå·±çš„è¯ä¹¦ã€‚æ–¹æ³•æ˜¯åœ¨å½“å‰ç›®å½•ä¸‹æ–°å»ºcertç›®å½•ï¼Œè¿›å»åæ‰§è¡Œä¸‰ä¸ªå‘½ä»¤ï¼š\nã€€ã€€openssl genrsa -out 1557605_www.learningrtc.cn.key 2048\nã€€ã€€openssl req -new -sha256 -key 1557605_www.learningrtc.cn.key -out csr.pem\nã€€ã€€openssl x509 -req -in csr.pem -signkey 1557605_www.learningrtc.cn.key -out 1557605_www.learningrtc.cn.pem","likes_number":1,"is_delete":false,"is_hidden":false,"ctime":1613976528,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1987829,"avatar":"http://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTJoOia8n2xdlIBYWVBmevjIuaMickvceJ2JX4IHOaibrmEWmia1gM29jhjLCJcYU9lSXLInNlToAbc5Gg/132","nickname":"å¼ ä¼Ÿ","note":"","ucode":"3A45B9536F91E9","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":368676,"discussion_content":"å¯ç”¨ï¼","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1618799341,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":128339,"user_name":"Jason","can_delete":false,"product_type":"c1","uid":1053390,"ip_address":"","ucode":"ABB3F1A63E102A","user_header":"https://static001.geekbang.org/account/avatar/00/10/12/ce/a8c8b5e8.jpg","comment_is_top":false,"comment_ctime":1566872314,"is_pvip":false,"replies":[{"id":"47571","content":"å®ç°äº†ï¼Œä¸è¿‡å¯¹ä»–çš„è®²è§£åœ¨ç¬¬23ç¯‡æ–‡ç« ä¸­æ‰ä¼šåšè¯¦ç»†ä»‹ç»","user_name":"ä½œè€…å›å¤","comment_id":128339,"uid":"1507837","ip_address":"","utype":1,"ctime":1566878489,"user_name_real":"garrylee"}],"discussion_count":1,"race_medal":0,"score":"5861839610","product_id":100031801,"comment_content":"è€å¸ˆå¥½ï¼Œé—®ä¸€ä¸‹ï¼Œ è¿™å¥—ç®€å•çš„ä¿¡ä»¤ç³»ç»Ÿï¼Œå·²ç»å®ç°äº†äº¤æ¢å„ç«¯sdpä¿¡æ¯çš„åŠŸèƒ½äº†å—ï¼Ÿ","like_count":1,"discussions":[{"author":{"id":1507837,"avatar":"https://static001.geekbang.org/account/avatar/00/17/01/fd/69869646.jpg","nickname":"éŸ³è§†é¢‘ä¸“å®¶-æè¶…","note":"","ucode":"5557943CF28441","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":464904,"discussion_content":"å®ç°äº†ï¼Œä¸è¿‡å¯¹ä»–çš„è®²è§£åœ¨ç¬¬23ç¯‡æ–‡ç« ä¸­æ‰ä¼šåšè¯¦ç»†ä»‹ç»","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1566878489,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":121971,"user_name":"è®¸ç«¥ç«¥","can_delete":false,"product_type":"c1","uid":1003005,"ip_address":"","ucode":"4B799C0C6BC678","user_header":"https://static001.geekbang.org/account/avatar/00/0f/4d/fd/0aa0e39f.jpg","comment_is_top":false,"comment_ctime":1565260053,"is_pvip":false,"replies":[{"id":"44824","content":"æ²¡é”™ï¼","user_name":"ä½œè€…å›å¤","comment_id":121971,"uid":"1507837","ip_address":"","utype":1,"ctime":1565278895,"user_name_real":"garrylee"}],"discussion_count":1,"race_medal":0,"score":"5860227349","product_id":100031801,"comment_content":"ä¸¤ä¸ªä¸åŒçš„ V8 å¼•æ“ä¸Šï¼Œä½ çŸ¥é“å®ƒä»¬çš„å¯¹åº”å…³ç³»å—<br>ä¸€ä¸ªæ˜¯nodejsæœåŠ¡ç«¯çš„V8ï¼Œä¸€ä¸ªæ˜¯æµè§ˆå™¨ä¸­å®¢æˆ·ç«¯çš„V8ã€‚","like_count":1,"discussions":[{"author":{"id":1507837,"avatar":"https://static001.geekbang.org/account/avatar/00/17/01/fd/69869646.jpg","nickname":"éŸ³è§†é¢‘ä¸“å®¶-æè¶…","note":"","ucode":"5557943CF28441","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":462033,"discussion_content":"æ²¡é”™ï¼","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1565278895,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":340033,"user_name":"å¿§å¤©å°é¸¡","can_delete":false,"product_type":"c1","uid":1073947,"ip_address":"","ucode":"A1412BDC108FD6","user_header":"https://static001.geekbang.org/account/avatar/00/10/63/1b/83ac7733.jpg","comment_is_top":false,"comment_ctime":1648548103,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1648548103","product_id":100031801,"comment_content":"è¿™clientå¯¹ä¸æ‡‚å‰ç«¯çš„äººæ¥è¯´ï¼Œå®Œå…¨è·‘ä¸èµ·æ¥","like_count":0},{"had_liked":false,"id":313329,"user_name":"noâ€†ne","can_delete":false,"product_type":"c1","uid":1768793,"ip_address":"","ucode":"15295B9864D4C7","user_header":"https://static001.geekbang.org/account/avatar/00/1a/fd/59/7f653e69.jpg","comment_is_top":false,"comment_ctime":1632379732,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1632379732","product_id":100031801,"comment_content":"æœ€æ–°çš„ç‰ˆæœ¬çš„socket.ioä¼šæœ‰ä¸å…¼å®¹é—®é¢˜(å¦‚æœåŠ¡å™¨ä»£ç é‡Œçš„socketIo.listen(https_server)ä¼šæŠ¥é”™)","like_count":0},{"had_liked":false,"id":258541,"user_name":"äººç”Ÿåœ¨äº‹","can_delete":false,"product_type":"c1","uid":1819983,"ip_address":"","ucode":"5CDDD20DDD9BC5","user_header":"https://static001.geekbang.org/account/avatar/00/1b/c5/4f/0a1c7334.jpg","comment_is_top":false,"comment_ctime":1604477915,"is_pvip":false,"replies":[{"id":"94549","content":"å°±æ˜¯å¼•å…¥ socket.ioåº“","user_name":"ä½œè€…å›å¤","comment_id":258541,"uid":"1507837","ip_address":"","utype":1,"ctime":1605004310,"user_name_real":"éŸ³è§†é¢‘ä¸“å®¶-æè¶…"}],"discussion_count":1,"race_medal":0,"score":"1604477915","product_id":100031801,"comment_content":"&lt;script src=&#39;&#47;socket.io&#47;socket.io.js&#39;&gt;&lt;&#47;script&gt;è¿™æ®µä»£ç æ²¡çœ‹åˆ°ï¼Œæè€å¸ˆã€‚ç¬¬ä¸€æ¬¡æ¥è§¦nodejså’Œsocket.io.jsï¼Œä¸å¤ªæ˜ç™½ï¼Œå¸Œæœ›æŒ‡å¯¼ä¸€ä¸‹<br>","like_count":0,"discussions":[{"author":{"id":1507837,"avatar":"https://static001.geekbang.org/account/avatar/00/17/01/fd/69869646.jpg","nickname":"éŸ³è§†é¢‘ä¸“å®¶-æè¶…","note":"","ucode":"5557943CF28441","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":508687,"discussion_content":"å°±æ˜¯å¼•å…¥ socket.ioåº“","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1605004310,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":258540,"user_name":"äººç”Ÿåœ¨äº‹","can_delete":false,"product_type":"c1","uid":1819983,"ip_address":"","ucode":"5CDDD20DDD9BC5","user_header":"https://static001.geekbang.org/account/avatar/00/1b/c5/4f/0a1c7334.jpg","comment_is_top":false,"comment_ctime":1604477601,"is_pvip":false,"replies":[{"id":"94535","content":"æŒ‰è¯´ä½ åº”è¯¥èƒ½æƒ³åˆ°æ‰å¯¹ï¼Œå®ƒä¸æµè§ˆå™¨ç”¨çš„åŒä¸€ä¸ªè¿æ¥","user_name":"ä½œè€…å›å¤","comment_id":258540,"uid":"1507837","ip_address":"","utype":1,"ctime":1605003035,"user_name_real":"éŸ³è§†é¢‘ä¸“å®¶-æè¶…"}],"discussion_count":2,"race_medal":0,"score":"1604477601","product_id":100031801,"comment_content":"æè€å¸ˆï¼Œæ–‡ç« å®ä¾‹é‡Œå®¢æˆ·ç«¯éƒ½æ²¡æœ‰æŒ‡æ˜è¿å“ªä¸ªç«¯å£ï¼ŒæœåŠ¡ç«¯æ€ä¹ˆç›‘å¬çš„å•Šï¼Ÿ","like_count":0,"discussions":[{"author":{"id":1507837,"avatar":"https://static001.geekbang.org/account/avatar/00/17/01/fd/69869646.jpg","nickname":"éŸ³è§†é¢‘ä¸“å®¶-æè¶…","note":"","ucode":"5557943CF28441","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":508686,"discussion_content":"æŒ‰è¯´ä½ åº”è¯¥èƒ½æƒ³åˆ°æ‰å¯¹ï¼Œå®ƒä¸æµè§ˆå™¨ç”¨çš„åŒä¸€ä¸ªè¿æ¥","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1605003035,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1935262,"avatar":"https://static001.geekbang.org/account/avatar/00/1d/87/9e/e18f55ec.jpg","nickname":"å¼ ä¸€ç”»","note":"","ucode":"53209E3BD46FC3","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":321206,"discussion_content":"æˆ‘é—®çš„å°±æ˜¯ä¸€æ ·çš„çš„é—®é¢˜ï¼Œæ²¡æœ‰æŒ‡æ˜å°±æ˜¯ç”¨çš„å½“å‰é¡µé¢è®¿é—®çš„é»˜è®¤ç«¯å£å’Œåœ°å€å»è®¿é—®","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1604547400,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":172488,"user_name":"SherwinFeng","can_delete":false,"product_type":"c1","uid":1747728,"ip_address":"","ucode":"1754290DCF5CB7","user_header":"https://wx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTJoNVHqRL5iatEoMgfFAaGFZxD8ic6CicxKI9Facp4bzAkNMAfaduSENlPOafs6dOGawibhNv3V9lVowQ/132","comment_is_top":false,"comment_ctime":1579188095,"is_pvip":false,"replies":[{"id":"70170","content":"çœ‹ä¸€ä¸‹æ˜¯ä¸æ˜¯å®¢æˆ·ç«¯ä¸æœåŠ¡ç«¯çš„å‚æ•°æ²¡æœ‰åŒ¹é…ä¸Šï¼Ÿ","user_name":"ä½œè€…å›å¤","comment_id":172488,"uid":"1507837","ip_address":"","utype":1,"ctime":1582430565,"user_name_real":"garrylee"}],"discussion_count":2,"race_medal":0,"score":"1579188095","product_id":100031801,"comment_content":"è€å¸ˆï¼Œæˆ‘è¿è¡Œäº†githubä¸Šçš„demoï¼Œé‡åˆ°äº†ä¸€ä¸ªé—®é¢˜ï¼š<br>clientç«¯ä¸èƒ½æ˜¾ç¤ºå‘é€å‡ºå»çš„æ¶ˆæ¯<br>å·²å°è¯•çš„æ’æŸ¥ï¼š<br>â‘ æŸ¥çœ‹äº†æ—¥å¿—å‘ç°clientå‘é€çš„æ¶ˆæ¯æœåŠ¡å™¨ç«¯å·²ç»æ¥æ”¶åˆ°äº†ï¼Œå¹¶ä¸”æ˜¾ç¤ºäº†æ¶ˆæ¯å†…å®¹ï¼ˆè¿™é‡Œè‡ªå·±ä¿®æ”¹äº†demoä¸­çš„debugä¿¡æ¯ï¼Œä»¥ä¾¿è®°å½•æ¶ˆæ¯å†…å®¹ï¼ŒåŸdemoåªèƒ½æ˜¾ç¤ºdata.typeï¼‰<br>â‘¡F12è°ƒè¯•æ—¶å‘ç°client.jsä¸­çš„ç›‘å¬â€œmessageâ€äº‹ä»¶æ²¡æœ‰æ‰§è¡Œ<br>è¿™æ˜¯ä»€ä¹ˆåŸå› é€ æˆå‘¢ï¼Ÿ","like_count":0,"discussions":[{"author":{"id":1507837,"avatar":"https://static001.geekbang.org/account/avatar/00/17/01/fd/69869646.jpg","nickname":"éŸ³è§†é¢‘ä¸“å®¶-æè¶…","note":"","ucode":"5557943CF28441","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":481756,"discussion_content":"çœ‹ä¸€ä¸‹æ˜¯ä¸æ˜¯å®¢æˆ·ç«¯ä¸æœåŠ¡ç«¯çš„å‚æ•°æ²¡æœ‰åŒ¹é…ä¸Šï¼Ÿ","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1582430565,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":2290293,"avatar":"https://static001.geekbang.org/account/avatar/00/22/f2/75/85105d71.jpg","nickname":"å²æ™¯å³°","note":"","ucode":"B1A1FEFADB1942","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":365546,"discussion_content":"å¥½åƒæ˜¯jionï¼ˆroomï¼‰è¿™ä¸ªæ–¹æ³•æ²¡æˆåŠŸï¼Œä¸çŸ¥é“ä½ çš„é—®é¢˜è§£å†³äº†æ²¡ï¼Œåˆšå­¦ä¹ ï¼Œä¹Ÿæ˜¯é‡åˆ°è¿™ä¸ªé—®é¢˜ã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1617835881,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":153776,"user_name":"äººç”Ÿè‹¦çŸ­","can_delete":false,"product_type":"c1","uid":1437661,"ip_address":"","ucode":"9F9BC22175969E","user_header":"https://static001.geekbang.org/account/avatar/00/15/ef/dd/3068679b.jpg","comment_is_top":false,"comment_ctime":1574305664,"is_pvip":false,"replies":[{"id":"59345","content":"åº”è¯¥æ˜¯ä½ çš„ç¯å¢ƒé—®é¢˜ï¼Œä½ çœ‹ä¸€ä¸‹ä½ çš„nodeç‰ˆæœ¬å’Œnpmç‰ˆæœ¬æ˜¯ä¸æ˜¯å¤ªä½äº†ï¼Ÿ","user_name":"ä½œè€…å›å¤","comment_id":153776,"uid":"1507837","ip_address":"","utype":1,"ctime":1574501091,"user_name_real":"garrylee"}],"discussion_count":2,"race_medal":0,"score":"1574305664","product_id":100031801,"comment_content":"è€å¸ˆä½ å¥½ï¼Œæˆ‘ä¸‹è½½äº†æ‚¨çš„ä»£ç ï¼Œæ›´æ”¹äº†certï¼Œä½†æ˜¯æŠ¥äº†ä¸€ä¸ªé”™è¯¯ï¼Œæˆ‘ä¸çŸ¥é“æ€ä¹ˆè§£å†³<br> node server.js <br>&#47;root&#47;node_modules&#47;streamroller&#47;lib&#47;RollingFileWriteStream.js:133<br>  async _shouldRoll() {<br>        ^^^^^^^^^^^<br><br>SyntaxError: Unexpected identifier<br>    at createScript (vm.js:56:10)<br>    at Object.runInThisContext (vm.js:97:10)<br>    at Module._compile (module.js:549:28)<br>    at Object.Module._extensions..js (module.js:586:10)<br>    at Module.load (module.js:494:32)<br>    at tryModuleLoad (module.js:453:12)<br>    at Function.Module._load (module.js:445:3)<br>    at Module.require (module.js:504:17)<br>    at require (internal&#47;module.js:20:19)<br>    at Object.&lt;anonymous&gt; (&#47;root&#47;node_modules&#47;streamroller&#47;lib&#47;index.js:2:27)<br><br>æ˜¯æˆ‘çš„ç¯å¢ƒæœ‰é—®é¢˜ä¹ˆ","like_count":0,"discussions":[{"author":{"id":1507837,"avatar":"https://static001.geekbang.org/account/avatar/00/17/01/fd/69869646.jpg","nickname":"éŸ³è§†é¢‘ä¸“å®¶-æè¶…","note":"","ucode":"5557943CF28441","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":475269,"discussion_content":"åº”è¯¥æ˜¯ä½ çš„ç¯å¢ƒé—®é¢˜ï¼Œä½ çœ‹ä¸€ä¸‹ä½ çš„nodeç‰ˆæœ¬å’Œnpmç‰ˆæœ¬æ˜¯ä¸æ˜¯å¤ªä½äº†ï¼Ÿ","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1574501091,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1437661,"avatar":"https://static001.geekbang.org/account/avatar/00/15/ef/dd/3068679b.jpg","nickname":"äººç”Ÿè‹¦çŸ­","note":"","ucode":"9F9BC22175969E","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":54969,"discussion_content":"æˆ‘è‡ªå·±è§£å†³äº†å“¦ï¼ŒçœŸæ˜¯ç¯å¢ƒçš„é—®é¢˜ã€‚centos7é»˜è®¤nodeçš„ç‰ˆæœ¬æ˜¯8ã€‚ã€‚å‡çº§äº†ä¸€ä¸‹å°±å¥½äº†","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1574329832,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":147399,"user_name":"è€Œç«‹æ–‹","can_delete":false,"product_type":"c1","uid":1087258,"ip_address":"","ucode":"5FED6E9E148195","user_header":"https://static001.geekbang.org/account/avatar/00/10/97/1a/389eab84.jpg","comment_is_top":false,"comment_ctime":1572862314,"is_pvip":false,"replies":[{"id":"57399","content":"webä¿¡ä»¤æœåŠ¡å™¨æ²¡æœ‰æ­å»ºå¥½å§ï¼","user_name":"ä½œè€…å›å¤","comment_id":147399,"uid":"1507837","ip_address":"","utype":1,"ctime":1573191671,"user_name_real":"garrylee"}],"discussion_count":2,"race_medal":0,"score":"1572862314","product_id":100031801,"comment_content":"è·‘èµ·æ¥æŠ¥å•¦ä¸ªé”™è¯¯ï¼Œé¡µé¢æ˜¾ç¤ºCannot GET ","like_count":0,"discussions":[{"author":{"id":1507837,"avatar":"https://static001.geekbang.org/account/avatar/00/17/01/fd/69869646.jpg","nickname":"éŸ³è§†é¢‘ä¸“å®¶-æè¶…","note":"","ucode":"5557943CF28441","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":473240,"discussion_content":"webä¿¡ä»¤æœåŠ¡å™¨æ²¡æœ‰æ­å»ºå¥½å§ï¼","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1573191671,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1876823,"avatar":"https://thirdwx.qlogo.cn/mmopen/vi_32/X4ib36ADEvj76XaKD4OUY9k15KqWCAVCwibPicBxz6BBUfDrVolpYInn8zFOw3JBPtVw3L4Lkibaf2eLPemwGKzAXA/132","nickname":"Geek_427d0c","note":"","ucode":"D7A04138C4B8CB","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":350696,"discussion_content":"æˆ‘ä¹Ÿæ˜¯æŠ¥ç›¸åŒçš„é”™è¯¯ï¼Œapp.use(serveIndex(&#39;./public&#39;));å’Œapp.use(express.static(&#39;./public&#39;));è¯´æ˜ï¼Œnode server.jså¯åŠ¨åï¼Œé¡¹ç›®çš„æ ¹ç›®å½•åœ¨publicæ–‡ä»¶å¤¹ä¸‹ï¼ˆpublicæ–‡ä»¶å¤¹å’Œserver.jsæ–‡ä»¶åœ¨åŒä¸€ä¸ªç›®å½•ä¸‹ï¼Œpublicæ–‡ä»¶å¤¹ä¸‹æœ‰index.htmlæ–‡ä»¶ã€cssæ–‡ä»¶å’Œjsæ–‡ä»¶å¤¹ç­‰ï¼‰ï¼Œæ‰€ä»¥éœ€è¦æŠŠcsså’Œclient.jsçš„ç›®å½•ç§»åˆ°publicä¸‹é¢","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1613982313,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":139681,"user_name":"dahaowenge","can_delete":false,"product_type":"c1","uid":1677266,"ip_address":"","ucode":"90E104E004F79C","user_header":"https://static001.geekbang.org/account/avatar/00/19/97/d2/daaed7d8.jpg","comment_is_top":false,"comment_ctime":1570704149,"is_pvip":false,"replies":[{"id":"54148","content":"åº”è¯¥æ˜¯ä½ çš„log4js æ²¡æœ‰è£…å¥½ï¼Œä½ å¯ä»¥æ‰¾ä¸ªæ‡‚nodejsçš„åŒå­¦å¸®å¿™å®‰è£…ä¸€ä¸‹ã€‚å®åœ¨ä¸è¡Œï¼Œä½ å¯ä»¥å°† log4jsæ³¨é‡Šæ‰ã€‚","user_name":"ä½œè€…å›å¤","comment_id":139681,"uid":"1507837","ip_address":"","utype":1,"ctime":1570818508,"user_name_real":"garrylee"}],"discussion_count":1,"race_medal":0,"score":"1570704149","product_id":100031801,"comment_content":"è€å¸ˆï¼Œç”¨çš„æ˜¯å®˜æ–¹demoï¼Œä½†æ˜¯è¿è¡Œnode server.jsæ—¶ï¼ŒæŠ¥é”™  Error: Cannot find module &#39;log4js&#39;","like_count":0,"discussions":[{"author":{"id":1507837,"avatar":"https://static001.geekbang.org/account/avatar/00/17/01/fd/69869646.jpg","nickname":"éŸ³è§†é¢‘ä¸“å®¶-æè¶…","note":"","ucode":"5557943CF28441","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":470054,"discussion_content":"åº”è¯¥æ˜¯ä½ çš„log4js æ²¡æœ‰è£…å¥½ï¼Œä½ å¯ä»¥æ‰¾ä¸ªæ‡‚nodejsçš„åŒå­¦å¸®å¿™å®‰è£…ä¸€ä¸‹ã€‚å®åœ¨ä¸è¡Œï¼Œä½ å¯ä»¥å°† log4jsæ³¨é‡Šæ‰ã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1570818508,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":130516,"user_name":"Geek_leoé•¿æ²™","can_delete":false,"product_type":"c1","uid":1617384,"ip_address":"","ucode":"2AEEAF499FBDC1","user_header":"","comment_is_top":false,"comment_ctime":1567476391,"is_pvip":false,"replies":[{"id":"48918","content":"MESH, SFU, MCUä¸‰ç§","user_name":"ä½œè€…å›å¤","comment_id":130516,"uid":"1507837","ip_address":"","utype":1,"ctime":1567517742,"user_name_real":"garrylee"}],"discussion_count":2,"race_medal":0,"score":"1567476391","product_id":100031801,"comment_content":"è€å¸ˆï¼Œè¦åšå¤šçŸ­åœ¨çº¿éŸ³è§†é¢‘çš„è¯æ˜¯ä¸æ˜¯å°±å¾—è€ƒè™‘mesh,router,mixè¿™ä¸‰ç§æ¶æ„å‘¢ã€‚","like_count":0,"discussions":[{"author":{"id":1507837,"avatar":"https://static001.geekbang.org/account/avatar/00/17/01/fd/69869646.jpg","nickname":"éŸ³è§†é¢‘ä¸“å®¶-æè¶…","note":"","ucode":"5557943CF28441","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":465990,"discussion_content":"MESH, SFU, MCUä¸‰ç§","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1567517742,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1617384,"avatar":"","nickname":"Geek_leoé•¿æ²™","note":"","ucode":"2AEEAF499FBDC1","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":7493,"discussion_content":"å¥½çš„ï¼Œè°¢è°¢è€å¸ˆ","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1567517903,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":129271,"user_name":"å°ç‹‚","can_delete":false,"product_type":"c1","uid":1197420,"ip_address":"","ucode":"08A2CFA90C4444","user_header":"https://static001.geekbang.org/account/avatar/00/12/45/6c/3393668d.jpg","comment_is_top":false,"comment_ctime":1567075541,"is_pvip":false,"replies":[{"id":"48412","content":"ä»£ç å·²ç»æäº¤äº†ï¼Œhttps:&#47;&#47;github.com&#47;avdance&#47;webrtc_web&#47;tree&#47;master&#47;11_signal","user_name":"ä½œè€…å›å¤","comment_id":129271,"uid":"1507837","ip_address":"","utype":1,"ctime":1567266232,"user_name_real":"garrylee"}],"discussion_count":1,"race_medal":0,"score":"1567075541","product_id":100031801,"comment_content":"è€å¸ˆ,æ˜¯å¦èƒ½å‘ä¸€ä¸‹è¿™èŠ‚çš„ä»£ç ","like_count":0,"discussions":[{"author":{"id":1507837,"avatar":"https://static001.geekbang.org/account/avatar/00/17/01/fd/69869646.jpg","nickname":"éŸ³è§†é¢‘ä¸“å®¶-æè¶…","note":"","ucode":"5557943CF28441","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":465374,"discussion_content":"ä»£ç å·²ç»æäº¤äº†ï¼Œhttps://github.com/avdance/webrtc_web/tree/master/11_signal","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1567266232,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":127074,"user_name":"hao11111205","can_delete":false,"product_type":"c1","uid":1617232,"ip_address":"","ucode":"E97F515CE3D7E3","user_header":"http://thirdwx.qlogo.cn/mmopen/vi_32/sIfDHQxDV6iaanrd8PcdVWZnke6nJmqBOLMx0iazR1yNN3FI6ib7PtXCfzicWcuEwSIqzfqiaFMf7PMYNPiaRibiaFHgcw/132","comment_is_top":false,"comment_ctime":1566550186,"is_pvip":false,"replies":[{"id":"47169","content":"æˆ‘è¿™ä¸¤å¤©æŠŠä»£ç æ”¾ä¸Šå»ï¼Œåˆ°æ—¶å€™ä½ å¯¹ç…§ç€çœ‹ä¸€ä¸‹å§ï¼","user_name":"ä½œè€…å›å¤","comment_id":127074,"uid":"1507837","ip_address":"","utype":1,"ctime":1566714518,"user_name_real":"garrylee"}],"discussion_count":1,"race_medal":0,"score":"1566550186","product_id":100031801,"comment_content":"è€å¸ˆï¼Œå¯åŠ¨æœåŠ¡ï¼ŒæŠ¥é”™ï¼Œä»€ä¹ˆåŸå› ï¼Ÿ<br>hao@hao-Aspire-4820TG:~$ node server.js<br>&#47;home&#47;hao&#47;node_modules&#47;debug&#47;src&#47;node.js:165<br>\tconst (namespace: name, useColors) = this;<br>\t                ^<br><br>SyntaxError: Unexpected token :<br>    at exports.runInThisContext (vm.js:53:16)<br>    at Module._compile (module.js:374:25)<br>    at Object.Module._extensions..js (module.js:417:10)<br>    at Module.load (module.js:344:32)<br>    at Function.Module._load (module.js:301:12)<br>    at Module.require (module.js:354:17)<br>    at require (internal&#47;module.js:12:17)<br>    at Object.&lt;anonymous&gt; (&#47;home&#47;hao&#47;node_modules&#47;debug&#47;src&#47;index.js:9:19)<br>    at Module._compile (module.js:410:26)<br>    at Object.Module._extensions..js (module.js:417:10)<br>","like_count":0,"discussions":[{"author":{"id":1507837,"avatar":"https://static001.geekbang.org/account/avatar/00/17/01/fd/69869646.jpg","nickname":"éŸ³è§†é¢‘ä¸“å®¶-æè¶…","note":"","ucode":"5557943CF28441","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":464308,"discussion_content":"æˆ‘è¿™ä¸¤å¤©æŠŠä»£ç æ”¾ä¸Šå»ï¼Œåˆ°æ—¶å€™ä½ å¯¹ç…§ç€çœ‹ä¸€ä¸‹å§ï¼","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1566714518,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":122171,"user_name":"Beast-Of-Prey","can_delete":false,"product_type":"c1","uid":1615956,"ip_address":"","ucode":"C8BAEB1EFA50EE","user_header":"https://static001.geekbang.org/account/avatar/00/18/a8/54/06da255b.jpg","comment_is_top":false,"comment_ctime":1565312898,"is_pvip":false,"replies":[{"id":"44959","content":"Http:&#47;&#47;file&#47;. ?è¿™ä¸ªå¼€å¤´ï¼Ÿä½ æ˜¯æœ¬åœ°æ–‡ä»¶è®¿é—®çš„ï¼Ÿ","user_name":"ä½œè€…å›å¤","comment_id":122171,"uid":"1507837","ip_address":"","utype":1,"ctime":1565410154,"user_name_real":"garrylee"}],"discussion_count":2,"race_medal":0,"score":"1565312898","product_id":100031801,"comment_content":"è€å¸ˆ http:&#47;&#47;file&#47;socket.io&#47;?EIO=3&amp;transport=polling&amp;t=MnpuVBE net::ERR_NAME_NOT_RESOLVED è¿™ä¸ªé”™è¯¯æ˜¯ä»€ä¹ˆåŸå› å¯¼è‡´çš„ï¼Ÿæˆ‘ç™¾åº¦äº† è¯´æ˜¯æµè§ˆå™¨è®¾ç½®äº†ä»£ç†ï¼Œä½†æ˜¯æˆ‘æ£€æŸ¥æˆ‘çš„æµè§ˆå™¨ï¼Œæ²¡æœ‰è¿›è¡Œè®¾ç½®å•Šã€‚","like_count":0,"discussions":[{"author":{"id":1507837,"avatar":"https://static001.geekbang.org/account/avatar/00/17/01/fd/69869646.jpg","nickname":"éŸ³è§†é¢‘ä¸“å®¶-æè¶…","note":"","ucode":"5557943CF28441","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":462131,"discussion_content":"Http://file/. ?è¿™ä¸ªå¼€å¤´ï¼Ÿä½ æ˜¯æœ¬åœ°æ–‡ä»¶è®¿é—®çš„ï¼Ÿ","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1565410154,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1615956,"avatar":"https://static001.geekbang.org/account/avatar/00/18/a8/54/06da255b.jpg","nickname":"Beast-Of-Prey","note":"","ucode":"C8BAEB1EFA50EE","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":4424,"discussion_content":"ç»ˆç«¯å¯çš„æœåŠ¡ æµè§ˆå™¨å¼€äº†2ä¸ªè¾“å…¥localhostï¼š2013çš„é¡µé¢ åº”è¯¥ä¹Ÿä¹ˆä»€ä¹ˆé—®é¢˜å•Š\n","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1565410318,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":122039,"user_name":"Beast-Of-Prey","can_delete":false,"product_type":"c1","uid":1615956,"ip_address":"","ucode":"C8BAEB1EFA50EE","user_header":"https://static001.geekbang.org/account/avatar/00/18/a8/54/06da255b.jpg","comment_is_top":false,"comment_ctime":1565273996,"is_pvip":false,"replies":[{"id":"44829","content":"æ˜¯åº“æ²¡æœ‰åŠ è½½å¯¹ï¼Œæ”¹ä¸ºè¿™æ ·è¯•è¯•  &lt;script src=&quot;https:&#47;&#47;cdnjs.cloudflare.com&#47;ajax&#47;libs&#47;socket.io&#47;2.0.3&#47;socket.io.js&quot;&gt;&lt;&#47;script&gt;","user_name":"ä½œè€…å›å¤","comment_id":122039,"uid":"1507837","ip_address":"","utype":1,"ctime":1565279401,"user_name_real":"garrylee"}],"discussion_count":1,"race_medal":0,"score":"1565273996","product_id":100031801,"comment_content":"è€å¸ˆ  æˆ‘æŒ‰æ­¥éª¤å®‰è£…äº† socket.io ä½†æ˜¯ æˆ‘æœ¬åœ° html åŠ è½½ socket.io.jsæ–‡ä»¶çš„æ—¶å€™ æç¤º2 ä¸ªé”™è¯¯ï¼Œ1ã€æ–‡ä»¶æœªå‘ç°ERR_FILE_NOT_FOUNDï¼Œ2ã€io æœªå®šä¹‰ io is not definedã€‚","like_count":0,"discussions":[{"author":{"id":1507837,"avatar":"https://static001.geekbang.org/account/avatar/00/17/01/fd/69869646.jpg","nickname":"éŸ³è§†é¢‘ä¸“å®¶-æè¶…","note":"","ucode":"5557943CF28441","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":462070,"discussion_content":"æ˜¯åº“æ²¡æœ‰åŠ è½½å¯¹ï¼Œæ”¹ä¸ºè¿™æ ·è¯•è¯•  &amp;lt;script src=&amp;quot;https://cdnjs.cloudflare.com/ajax/libs/socket.io/2.0.3/socket.io.js&amp;quot;&amp;gt;&amp;lt;/script&amp;gt;","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1565279401,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":121878,"user_name":"Beast-Of-Prey","can_delete":false,"product_type":"c1","uid":1615956,"ip_address":"","ucode":"C8BAEB1EFA50EE","user_header":"https://static001.geekbang.org/account/avatar/00/18/a8/54/06da255b.jpg","comment_is_top":false,"comment_ctime":1565241449,"is_pvip":false,"replies":[{"id":"44825","content":"èµï¼","user_name":"ä½œè€…å›å¤","comment_id":121878,"uid":"1507837","ip_address":"","utype":1,"ctime":1565278912,"user_name_real":"garrylee"}],"discussion_count":1,"race_medal":0,"score":"1565241449","product_id":100031801,"comment_content":"è¯»äº†å¥½å‡ é ","like_count":0,"discussions":[{"author":{"id":1507837,"avatar":"https://static001.geekbang.org/account/avatar/00/17/01/fd/69869646.jpg","nickname":"éŸ³è§†é¢‘ä¸“å®¶-æè¶…","note":"","ucode":"5557943CF28441","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":461986,"discussion_content":"èµï¼","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1565278912,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":121823,"user_name":"å½­åˆš","can_delete":false,"product_type":"c1","uid":1250060,"ip_address":"","ucode":"E59D05C1EADB99","user_header":"http://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTIDMOwpv5uMgy4HhoS0VPczxfXQldueafaaq2hznQx51nxZung0kYWukicNP3a3MFrhguVrjBwlwAg/132","comment_is_top":false,"comment_ctime":1565228788,"is_pvip":true,"replies":[{"id":"44827","content":"è°¢è°¢ï¼","user_name":"ä½œè€…å›å¤","comment_id":121823,"uid":"1507837","ip_address":"","utype":1,"ctime":1565279081,"user_name_real":"garrylee"}],"discussion_count":1,"race_medal":0,"score":"1565228788","product_id":100031801,"comment_content":"æœŸå¾…æ›´æ–° æ¯ç¯‡æ–‡ç« éƒ½èƒ½çœ‹å¥½å‡ æ¬¡ éƒ½æ˜¯ç²¾å","like_count":0,"discussions":[{"author":{"id":1507837,"avatar":"https://static001.geekbang.org/account/avatar/00/17/01/fd/69869646.jpg","nickname":"éŸ³è§†é¢‘ä¸“å®¶-æè¶…","note":"","ucode":"5557943CF28441","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":461963,"discussion_content":"è°¢è°¢ï¼","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1565279081,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]}]}