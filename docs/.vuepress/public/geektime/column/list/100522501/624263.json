{"id":624263,"title":"10ï½œç›‘æ§æ¦‚è®ºï¼ˆä¸‹ï¼‰ï¼šç›‘æ§æ•°æ®çš„é‡‡é›†æ–¹å¼åŠåŸç†","content":"<p>ä½ å¥½ï¼Œæˆ‘æ˜¯ç§¦æ™“è¾‰ã€‚</p><p><a href=\"https://time.geekbang.org/column/article/624099\">ä¸Šä¸€è®²</a>æˆ‘ä»¬ä»‹ç»äº†ç›‘æ§çš„å‡ ä¸ªæ–¹æ³•è®ºï¼ŒçŸ¥é“äº†å“ªäº›æŒ‡æ ‡æ¯”è¾ƒå…³é”®ï¼Œä½†æ˜¯å…·ä½“å¦‚ä½•é‡‡é›†å‘¢ï¼Ÿè¿™åˆæ˜¯ä¸€ä¸ªéå¸¸é‡è¦çš„è¯é¢˜ã€‚è¿™ä¸€è®²æˆ‘ä»¬å°±æ¥å‰–æä¸€ä¸‹å¸¸è§çš„é‡‡é›†æ•°æ®çš„æŠ€æœ¯æ‰‹æ®µï¼Œäº†è§£äº†è¿™äº›ï¼Œæˆ‘ä»¬å°±å¯ä»¥å†™è‡ªå·±çš„é‡‡é›†å™¨ï¼Œæˆ–è€…æ‰©å±•å¾ˆå¤šé‡‡é›†å™¨çš„èƒ½åŠ›äº†ï¼Œå¯¹å¾ˆå¤šç›‘æ§æ•°æ®ä¹Ÿä¼šæ‹¥æœ‰åŸç†å±‚é¢çš„ç†è§£ã€‚</p><p>ç¬¬ä¸€ä¸ªç‰ˆæœ¬çš„ <a href=\"https://github.com/open-falcon/falcon-plus\">Falcon-Agent</a> å’Œ <a href=\"https://github.com/flashcatcloud/categraf\">Categraf</a> éƒ½æ˜¯æˆ‘æ¥ä¸»ç¬”çš„ï¼Œåœ¨è®¾è®¡çš„è¿‡ç¨‹ä¸­ï¼Œæˆ‘æ·±åˆ»è®¤è¯†åˆ°é‡‡é›†æ–¹æ³•çš„å¤šæ ·æ€§ï¼Œæ¯”å¦‚è¯»å– <code>/proc</code> ç›®å½•ã€æ‰§è¡Œç³»ç»Ÿè°ƒç”¨ã€æ‰§è¡Œå‘½ä»¤è¡Œå·¥å…·ã€è¿œç¨‹é»‘ç›’æ¢æµ‹ã€è¿œç¨‹æ‹‰å–ç‰¹å®šåè®®çš„æ•°æ®ã€è¿åˆ°ç›®æ ‡ä¸Šå»æ‰§è¡ŒæŒ‡ä»¤è·å–è¾“å‡ºã€ä»£ç åŸ‹ç‚¹ã€æ—¥å¿—åˆ†ææå–ç­‰å„ç§å„æ ·çš„æ–¹æ³•ã€‚è¿™ä¸€è®²æˆ‘ä¼šä»ä¸­æŒ‘é€‰ä¸€äº›æ¯”è¾ƒå…¸å‹çš„æ‰‹æ®µåˆ†äº«ç»™ä½ ã€‚ä¸‹é¢æˆ‘ä»¬å°±æŒ‰ç…§ä½¿ç”¨é¢‘ç‡ä»é«˜åˆ°ä½ä¾æ¬¡çœ‹ä¸€ä¸‹ï¼Œå…ˆæ¥çœ‹è¯»å– <code>/proc</code> ç›®å½•çš„æ–¹å¼ã€‚</p><h2>è¯»å– <code>/proc</code> ç›®å½•</h2><p><code>/proc</code> æ˜¯ä¸€ä¸ªä½äºå†…å­˜ä¸­çš„ä¼ªæ–‡ä»¶ç³»ç»Ÿï¼Œè¯¥ç›®å½•ä¸‹ä¿å­˜çš„ä¸æ˜¯çœŸæ­£çš„æ–‡ä»¶å’Œç›®å½•ï¼Œè€Œæ˜¯ä¸€äº›â€œè¿è¡Œæ—¶â€ä¿¡æ¯ï¼ŒLinuxæ“ä½œç³»ç»Ÿå±‚é¢çš„å¾ˆå¤šç›‘æ§æ•°æ®ï¼Œæ¯”å¦‚å†…å­˜æ•°æ®ã€ç½‘å¡æµé‡ã€æœºå™¨è´Ÿè½½ç­‰ï¼Œéƒ½æ˜¯ä» <code>/proc</code> ä¸­è·å–çš„ä¿¡æ¯ã€‚</p><p>æˆ‘ä»¬å…ˆæ¥çœ‹ä¸€ä¸‹å†…å­˜ç›¸å…³çš„æŒ‡æ ‡ã€‚</p><pre><code class=\"language-bash\">[root@dev01.nj ~]# cat /proc/meminfo\nMemTotal:&nbsp; &nbsp; &nbsp; &nbsp; 7954676 kB\nMemFree:&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 211136 kB\nMemAvailable:&nbsp; &nbsp; 2486688 kB\nBuffers:&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 115068 kB\nCached:&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 2309836 kB\n...\n</code></pre><!-- [[[read_end]]] --><p>å†…å­˜æ€»é‡ã€å‰©ä½™é‡ã€å¯ç”¨é‡ã€Bufferã€Cachedç­‰æ•°æ®éƒ½å¯ä»¥è½»æ˜“æ‹¿åˆ°ã€‚å½“ç„¶ï¼Œ<code>/proc/meminfo</code> æ²¡æœ‰ä½¿ç”¨ç‡ã€å¯ç”¨ç‡è¿™æ ·çš„ç™¾åˆ†æ¯”æŒ‡æ ‡ï¼Œè¿™ç±»æŒ‡æ ‡éœ€è¦äºŒæ¬¡è®¡ç®—ï¼Œå¯ä»¥åœ¨å®¢æˆ·ç«¯é‡‡é›†å™¨ä¸­å®Œæˆï¼Œä¹Ÿå¯ä»¥åœ¨æœåŠ¡ç«¯æŸ¥è¯¢æ—¶ç°ç®—ã€‚</p><p>å†…å­˜ç›¸å…³çš„æŒ‡æ ‡éƒ½æ˜¯Gaugeç±»å‹çš„ï¼Œä¸‹é¢æˆ‘ä»¬å†æ¥çœ‹ä¸€ä¸‹ç½‘å¡æµé‡ç›¸å…³çš„æŒ‡æ ‡ï¼Œç½‘å¡ç›¸å…³çš„æ•°æ®éƒ½æ˜¯Counterç±»å‹çš„æ•°æ®ã€‚</p><pre><code class=\"language-bash\">[root@dev01.nj ~]# head -n3 /proc/net/dev\nInter-|&nbsp; &nbsp;Receive&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; |&nbsp; Transmit\n&nbsp;face |bytes&nbsp; &nbsp; packets errs drop fifo frame compressed multicast|bytes&nbsp; &nbsp; packets errs drop fifo colls carrier compressed\n&nbsp; eth0: 697407964307 2580235035&nbsp; &nbsp; 0&nbsp; &nbsp; 0&nbsp; &nbsp; 0&nbsp; &nbsp; &nbsp;0&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 0&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;0 1969289573661 3137865547&nbsp; &nbsp; 0&nbsp; &nbsp; 0&nbsp; &nbsp; 0&nbsp; &nbsp; &nbsp;0&nbsp; &nbsp; &nbsp; &nbsp;0&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 0\n</code></pre><p>æˆ‘çš„æœºå™¨ä¸Šç½‘å¡æ¯”è¾ƒå¤šï¼Œæ‰€ä»¥è¿™ä¸ªæ–‡ä»¶çš„å†…å®¹æœ‰å¾ˆå¤šè¡Œï¼Œé€šè¿‡headå‘½ä»¤åªæŸ¥çœ‹å‰é¢å‡ è¡Œï¼Œå¯ä»¥çœ‹åˆ°eth0ç½‘å¡çš„æŒ‡æ ‡å€¼ã€‚æ•´ä½“ä¸Šåˆ†ä¸¤éƒ¨åˆ†ï¼Œå‰ä¸€éƒ¨åˆ†æ˜¯ Receiveï¼Œè¡¨ç¤ºå…¥æ–¹å‘ï¼Œåä¸€éƒ¨åˆ†æ˜¯ Transmitï¼Œè¡¨ç¤ºå‡ºæ–¹å‘ã€‚697407964307è¿™ä¸ªå€¼è¡¨ç¤ºeth0ç½‘å¡å…¥æ–¹å‘æ”¶åˆ°çš„byteæ€»é‡ï¼Œ2580235035åˆ™è¡¨ç¤ºeth0ç½‘å¡å…¥æ–¹å‘æ”¶åˆ°çš„packetæ€»é‡ã€‚</p><p>æ³¨æ„äº†ï¼Œè¿™é‡Œæ‰€è°“çš„æ€»é‡ï¼Œæ˜¯æŒ‡æ“ä½œç³»ç»Ÿå¯åŠ¨ä»¥æ¥çš„ç´¯è®¡å€¼ã€‚ä»ç›‘æ§è§’åº¦ï¼Œé€šå¸¸æˆ‘ä»¬ä¸å…³æ³¨è¿™ä¸ªæ€»é‡ï¼Œè€Œæ˜¯å…³æ³¨æœ€è¿‘ä¸€åˆ†é’Ÿæˆ–è€…æœ€è¿‘ä¸€ç§’é’Ÿçš„æµé‡æ˜¯å¤šå°‘ï¼Œæ‰€ä»¥åœ¨æœåŠ¡ç«¯çœ‹å›¾çš„æ—¶å€™ï¼Œé€šå¸¸è¦ä½¿ç”¨irateå‡½æ•°åšäºŒæ¬¡è®¡ç®—ã€‚</p><p>çœ‹åˆ°è¿™é‡Œï¼Œä½ å¯èƒ½ä¼šè§‰å¾—ï¼ŒOSå±‚é¢çš„ç›‘æ§å¾ˆç®€å•ï¼Œä¸å°±æ˜¯è¯»å– <code>/proc</code> ç›®å½•ä¸‹çš„å†…å®¹å—ï¼Ÿè¿™å€’ä¹Ÿä¸å°½ç„¶ï¼Œæœ‰äº›æ•°æ®ä» <code>/proc</code> ä¸‹é¢æ˜¯æ‹¿ä¸åˆ°çš„ï¼Œæ¯”å¦‚ç¡¬ç›˜ä½¿ç”¨ç‡ã€‚æˆ‘ä»¬å¯ä»¥ä» <code>/proc/mounts</code> æ‹¿åˆ°æœºå™¨çš„æŒ‚è½½ç‚¹åˆ—è¡¨ï¼Œä½†å…·ä½“æ¯ä¸ªæŒ‚è½½ç‚¹çš„ä½¿ç”¨ç‡ï¼Œå°±éœ€è¦ç³»ç»Ÿè°ƒç”¨äº†ã€‚</p><p>OSå†…çš„æ•°æ®é‡‡é›†ï¼Œé™¤äº†è¯»å– <code>/proc</code> ç›®å½•ä¹‹å¤–ï¼Œä¹Ÿç»å¸¸ä¼šé€šè¿‡æ‰§è¡Œå‘½ä»¤è¡Œå·¥å…·çš„æ–¹å¼é‡‡é›†æŒ‡æ ‡ï¼Œä¸‹é¢æˆ‘ä»¬å†æ¥çœ‹ä¸€ä¸‹è¿™ç§æ–¹å¼ã€‚</p><h2>æ‰§è¡Œå‘½ä»¤è¡Œå·¥å…·</h2><p>è¿™ç§æ–¹å¼éå¸¸ç®€å•ï¼Œå°±æ˜¯è°ƒç”¨ä¸€ä¸‹ç³»ç»Ÿå‘½ä»¤ï¼Œè§£æè¾“å‡ºå°±å¯ä»¥äº†ã€‚æ¯”å¦‚æˆ‘ä»¬æƒ³è·å–9090ç«¯å£çš„ç›‘å¬çŠ¶æ€ï¼Œå¯ä»¥ä½¿ç”¨sså‘½ä»¤ <code>ss -tln|grep 9090</code>ï¼Œæƒ³è¦æ‹¿åˆ°å„ä¸ªåˆ†åŒºçš„ä½¿ç”¨ç‡å¯ä»¥é€šè¿‡dfå‘½ä»¤ <code>df -k</code>ã€‚ä½†æ˜¯è¿™ä¸ªæ–¹å¼ä¸å¤ªé€šç”¨ï¼Œæ€§èƒ½ä¹Ÿä¸å¥½ã€‚</p><p>å…ˆè¯´é€šç”¨æ€§é—®é¢˜ï¼Œå°±æ‹¿sså‘½ä»¤æ¥è¯´å§ï¼Œä¸æ˜¯æ‰€æœ‰çš„æœºå™¨éƒ½å®‰è£…äº†è¿™ä¸ªå‘½ä»¤è¡Œå·¥å…·ï¼Œè€Œä¸”ä¸åŒçš„å‘è¡Œç‰ˆæˆ–ä¸åŒssç‰ˆæœ¬ï¼Œå‘½ä»¤è¾“å‡ºå†…å®¹æ ¼å¼å¯èƒ½ä¸åŒã€‚æ€§èƒ½é—®é¢˜ä¹Ÿå®¹æ˜“ç†è§£ï¼Œè°ƒç”¨å‘½ä»¤è¡Œå·¥å…·æ˜¯éœ€è¦forkä¸€ä¸ªè¿›ç¨‹çš„ï¼Œç›¸æ¯”äºè¿›ç¨‹å†…çš„é€»è¾‘ï¼Œæ•ˆç‡å¤§æ‰“æŠ˜æ‰£ï¼Œä¸è¿‡ç›‘æ§é‡‡é›†é¢‘ç‡ä¸€èˆ¬éƒ½æ˜¯10ç§’èµ·æ­¥ï¼Œä¸é¢‘ç¹ï¼Œæ‰€ä»¥è¿™ä¸ªæ€§èƒ½é—®é¢˜å€’ä¸æ˜¯ä»€ä¹ˆå¤§äº‹ï¼Œå…³é”®è¿˜æ˜¯é€šç”¨æ€§é—®é¢˜ã€‚</p><p>è¯»å–æœ¬åœ° <code>/proc</code> ç›®å½•æˆ–æ‰§è¡Œå‘½ä»¤è¡Œå·¥å…·ï¼Œéƒ½æ˜¯åœ¨ç›®æ ‡ç›‘æ§æœºå™¨ä¸Šè¿›è¡Œçš„æ“ä½œã€‚æœ‰çš„æ—¶å€™ï¼Œæˆ‘ä»¬æ— æ³•åœ¨ç›®æ ‡æœºå™¨ä¸Šéƒ¨ç½²å®¢æˆ·ç«¯ç¨‹åºï¼Œè¿™æ—¶å€™å°±éœ€è¦é»‘ç›’æ¢æµ‹æ‰‹æ®µäº†ã€‚</p><h2>è¿œç¨‹é»‘ç›’æ¢æµ‹</h2><p>å…¸å‹çš„æ¢æµ‹æ‰‹æ®µæœ‰ä¸‰ç±»ï¼ŒICMPã€TCPå’ŒHTTPã€‚æœ‰ä¸€ä¸ªè½¯ä»¶å«Blackbox Exporterï¼Œå°±æ˜¯ä¸“é—¨ç”¨æ¥æ¢æµ‹çš„ï¼ŒCategrafã€Datadog-Agentç­‰é‡‡é›†å™¨ä¹Ÿéƒ½å¯ä»¥åšè¿™ç§æ¢æµ‹ã€‚</p><p>ICMPåè®®ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡Pingå·¥å…·åšæµ‹è¯•ï¼Œä½ å¯ä»¥çœ‹ä¸€ä¸‹è¿™ä¸ªä¾‹å­ã€‚</p><pre><code class=\"language-bash\">[root@dev01.nj ~]# ping -c 3 www.baidu.com\nPING www.a.shifen.com (180.101.49.13) 56(84) bytes of data.\n64 bytes from 180.101.49.13 (180.101.49.13): icmp_seq=1 ttl=251 time=1.41 ms\n64 bytes from 180.101.49.13 (180.101.49.13): icmp_seq=2 ttl=251 time=1.39 ms\n64 bytes from 180.101.49.13 (180.101.49.13): icmp_seq=3 ttl=251 time=1.38 ms\n\n--- www.a.shifen.com ping statistics ---\n3 packets transmitted, 3 received, 0% packet loss, time 2003ms\nrtt min/avg/max/mdev = 1.382/1.393/1.405/0.009 ms\n</code></pre><p>è¿™é‡Œæˆ‘ä»¬ä½¿ç”¨Pingå·¥å…·å‘Baiduå‘äº†3ä¸ªæ•°æ®åŒ…ï¼Œå¾—åˆ°äº†å¤šä¸ªæŒ‡æ ‡æ•°æ®ã€‚</p><ul>\n<li>ä¸¢åŒ…ç‡ï¼š0%</li>\n<li>min rttï¼š1.382</li>\n<li>avg rttï¼š1.393</li>\n<li>max rttï¼š1.405</li>\n<li>ttlï¼š251</li>\n</ul><p>ç›‘æ§é‡‡é›†å™¨å’Œæ‰‹å·¥Pingæµ‹è¯•çš„åŸç†æ˜¯ä¸€æ ·çš„ï¼Œä¹Ÿæ˜¯å‘å‡ ä¸ªåŒ…åšç»Ÿè®¡ã€‚ä¸è¿‡æœ‰äº›æœºå™¨æ˜¯ç¦Pingçš„ï¼Œè¿™æ—¶å€™æˆ‘ä»¬å°±å¯ä»¥é€šè¿‡TCPæˆ–HTTPæ¥æ¢æµ‹ã€‚å¯¹äºLinuxæœºå™¨ï¼Œä¸€èˆ¬æ˜¯ä¼šå¼€æ”¾sshdçš„22ç«¯å£ï¼Œé‚£æˆ‘ä»¬å°±å¯ä»¥ç”¨ç±»ä¼¼telnetçš„æ–¹å¼æ¢æµ‹æœºå™¨çš„22ç«¯å£ï¼Œå¦‚æœæˆåŠŸå°±è®¤ä¸ºæœºå™¨å­˜æ´»ã€‚</p><p>å¯¹äºHTTPåè®®çš„æ¢æµ‹ï¼Œé™¤äº†åŸºæœ¬çš„è¿é€šæ€§æµ‹è¯•ï¼Œè¿˜å¯ä»¥æ£€æŸ¥åè®®å†…å®¹ï¼Œæ¯”å¦‚è¦æ±‚è¿”å›çš„status codeå¿…é¡»æ˜¯200ï¼Œè¿”å›çš„response bodyå¿…é¡»åŒ…å«successå­—ç¬¦ä¸²ï¼Œå¦‚æœä»»ä½•ä¸€ä¸ªæ¡ä»¶æ²¡æœ‰æ»¡è¶³ï¼Œä»ç›‘æ§çš„è§’åº¦å°±è®¤ä¸ºæ˜¯å¼‚å¸¸çš„ã€‚</p><p>æœ‰é»‘ç›’ç›‘æ§ï¼Œè‡ªç„¶å°±æœ‰ç™½ç›’ç›‘æ§ã€‚é»‘ç›’ç›‘æ§æ˜¯æŠŠç›‘æ§å¯¹è±¡å½“æˆä¸€ä¸ªé»‘ç›’å­ï¼Œä¸å»äº†è§£å…¶å†…éƒ¨è¿è¡Œæœºç†ï¼Œåªæ˜¯é€šè¿‡å‡ ç§åè®®åšç®€å•æ¢æµ‹ã€‚ç™½ç›’ç›‘æ§ä¸ä¹‹ç›¸åï¼Œå®ƒè¦æ”¶é›†èƒ½å¤Ÿåæ˜ ç›‘æ§å¯¹è±¡å†…éƒ¨è¿è¡Œå¥åº·åº¦çš„æŒ‡æ ‡ã€‚ä½†æ˜¯ç›‘æ§å¯¹è±¡çš„å†…éƒ¨æŒ‡æ ‡ï¼Œä»å¤–éƒ¨å…¶å®æ˜¯æ— æ³•æ‹¿åˆ°çš„ï¼Œæ‰€ä»¥ç™½ç›’ç›‘æ§çš„æŒ‡æ ‡ï¼Œéœ€è¦ç›‘æ§å¯¹è±¡è‡ªèº«æƒ³åŠæ³•æš´éœ²å‡ºæ¥ã€‚æœ€å…¸å‹çš„æš´éœ²æ–¹å¼ï¼Œå°±æ˜¯æä¾›ä¸€ä¸ªHTTPæ¥å£ï¼Œåœ¨response bodyä¸­è¿”å›ç›‘æ§æŒ‡æ ‡çš„æ•°æ®ã€‚ä¸‹é¢æˆ‘ä»¬å°±æ¥çœ‹ä¸€ä¸‹è¿™ç§é‡‡é›†æ–¹å¼ã€‚</p><h2>æ‹‰å–ç‰¹å®šåè®®çš„æ•°æ®</h2><p>æœ‰å¾ˆå¤šç»„ä»¶éƒ½é€šè¿‡HTTPæ¥å£çš„æ–¹å¼ï¼Œæš´éœ²äº†è‡ªèº«çš„ç›‘æ§æŒ‡æ ‡ã€‚è¿™é‡Œæˆ‘ç»™ä½ ä¸¾å‡ ä¸ªä¾‹å­ï¼Œè®©ä½ æœ‰ä¸ªæ„Ÿæ€§çš„è®¤è¯†ï¼Œæ¯”å¦‚Elasticsearchçš„ <code>/_cluster/health</code> æ¥å£ã€‚</p><pre><code class=\"language-bash\">[root@dev01.nj ~]# curl&nbsp; -uelastic:Pass1223 http://10.206.0.7:9200/_cluster/health -s | jq .\n{\n&nbsp; \"cluster_name\": \"elasticsearch-cluster\",\n&nbsp; \"status\": \"yellow\",\n&nbsp; \"timed_out\": false,\n&nbsp; \"number_of_nodes\": 3,\n&nbsp; \"number_of_data_nodes\": 3,\n&nbsp; \"active_primary_shards\": 430,\n&nbsp; \"active_shards\": 430,\n&nbsp; \"relocating_shards\": 0,\n&nbsp; \"initializing_shards\": 0,\n&nbsp; \"unassigned_shards\": 430,\n&nbsp; \"delayed_unassigned_shards\": 0,\n&nbsp; \"number_of_pending_tasks\": 0,\n&nbsp; \"number_of_in_flight_fetch\": 0,\n&nbsp; \"task_max_waiting_in_queue_millis\": 0,\n&nbsp; \"active_shards_percent_as_number\": 50\n}\n</code></pre><p>æˆ‘ä»¬å¯ä»¥çœ‹åˆ°ï¼Œè¿”å›çš„å†…å®¹å¤§å¤šæ˜¯æŒ‡æ ‡æ•°å€¼ï¼Œè½¬æ¢æˆç›‘æ§æœåŠ¡ç«¯è¦æ±‚çš„æ•°æ®æ ¼å¼ï¼Œä¼ ä¸Šå»å³å¯ã€‚é™¤äº† <code>/_cluster/health</code> ï¼Œè¿˜å¯ä»¥æµ‹è¯•ä¸€ä¸‹ <code>/_cluster/stats</code>ï¼Œä¹Ÿèƒ½å¸®ä½ äº†è§£è¿™ç§è·å–æŒ‡æ ‡çš„æ–¹å¼ã€‚</p><p>é™¤äº†Elasticsearchï¼Œè¿˜æœ‰å¾ˆå¤šå…¶ä»–ç»„ä»¶ä¹Ÿæ˜¯ç”¨è¿™ç§æ–¹å¼æ¥æš´éœ²æŒ‡æ ‡çš„ï¼Œæ¯”å¦‚RabbitMQï¼Œè®¿é—® <code>/api/overview</code> å¯ä»¥æ‹¿åˆ°Messageæ•°é‡ã€Connectionæ•°é‡ç­‰æ¦‚è¦ä¿¡æ¯ã€‚å†æ¯”å¦‚ Kubeletï¼Œè®¿é—® <code>/stats/summary</code> å¯ä»¥æ‹¿åˆ°Nodeå’ŒPodç­‰å¾ˆå¤šæ¦‚è¦ä¿¡æ¯ã€‚</p><p>ä¸åŒçš„æ¥å£è¿”å›çš„å†…å®¹è™½ç„¶éƒ½æ˜¯æŒ‡æ ‡æ•°æ®ï¼Œä½†æ˜¯è¦æ¨ç»™ç›‘æ§æœåŠ¡ç«¯ï¼Œè¿˜æ˜¯è¦åšä¸€æ¬¡æ ¼å¼è½¬æ¢ï¼Œæ¯”å¦‚ç»Ÿä¸€è½¬æ¢ä¸º Prometheus çš„æ–‡æœ¬æ ¼å¼ã€‚è¦æ˜¯è¿™äº›ç»„ä»¶éƒ½ç›´æ¥æš´éœ² Prometheus çš„åè®®æ•°æ®å°±å¥½äº†ï¼Œä½¿ç”¨ç»Ÿä¸€çš„è§£æå™¨ï¼Œå°±èƒ½å¤§å¤§ç®€åŒ–ç›‘æ§é‡‡é›†é€»è¾‘ã€‚æ‰€å¹¸è¿™ä¸ªè¶‹åŠ¿æ­£åœ¨å‘ç”Ÿï¼Œä¸Šä¸€è®²æˆ‘ä»¬ä¹Ÿæåˆ°äº†ï¼Œåƒetcdã€CoreDNSã€æ–°ç‰ˆZooKeeperã€æ–°ç‰ˆRabbitMQã€nginx-vtsç­‰ï¼Œéƒ½å†…ç½®æš´éœ²äº† Prometheus åè®®æ•°æ®ï¼Œå¯è°“è¡Œä¸šå¹¸äº‹ã€‚</p><p>è¿™ç§æ‹‰å–ç›‘æ§æ•°æ®çš„æ–¹å¼è™½ç„¶éœ€è¦åšä¸€äº›æ•°æ®æ ¼å¼çš„è½¬æ¢ï¼Œä½†å¹¶ä¸å¤æ‚ã€‚å› ä¸ºç›®æ ‡å¯¹è±¡ä¼šæŠŠéœ€è¦ç›‘æ§çš„æ•°æ®ç›´æ¥é€šè¿‡æ¥å£æš´éœ²å‡ºæ¥ï¼Œç›‘æ§é‡‡é›†å™¨æŠŠæ•°æ®æ‹‰åˆ°æœ¬åœ°åšæ ¼å¼è½¬æ¢å³å¯ã€‚æ›´å¤æ‚çš„æ–¹å¼æ˜¯éœ€è¦æˆ‘ä»¬è¿æ¥åˆ°ç›®æ ‡å¯¹è±¡ä¸Šæ‰§è¡ŒæŒ‡ä»¤ï¼ŒMySQLã€Redisã€MongoDBç­‰éƒ½æ˜¯è¿™ç§æ–¹å¼ï¼Œä¸‹é¢æˆ‘ä»¬å°±æ¥ä¸€èµ·çœ‹ä¸€ä¸‹è¿™ç§é‡‡é›†æ–¹å¼çš„å·¥ä½œåŸç†ã€‚</p><h2>è¿æ¥åˆ°ç›®æ ‡å¯¹è±¡æ‰§è¡Œå‘½ä»¤</h2><p>ç›®å‰æœ€å¸¸ç”¨çš„æ•°æ®åº“å°±æ˜¯MySQLå’ŒRedisäº†ï¼Œæˆ‘ä»¬å°±æ‹¿è¿™ä¸¤ä¸ªç»„ä»¶æ¥ä¸¾ä¾‹ã€‚å…ˆè¯´MySQLï¼Œæˆ‘ä»¬ç»å¸¸éœ€è¦è·å–ä¸€äº›è¿æ¥ç›¸å…³çš„æŒ‡æ ‡æ•°æ®ï¼Œæ¯”å¦‚å½“å‰æœ‰å¤šå°‘è¿æ¥ï¼Œæ€»å…±æ‹’ç»äº†å¤šå°‘è¿æ¥ï¼Œæ€»å…±æ¥æ”¶è¿‡å¤šå°‘è¿æ¥ï¼Œç™»å½•MySQLå‘½ä»¤è¡Œï¼Œä½¿ç”¨ä¸‹é¢çš„å‘½ä»¤å¯ä»¥è·å–ã€‚</p><pre><code class=\"language-bash\">mysql&gt; show global status like '%onn%';\n+-----------------------------------------------+---------------------+\n| Variable_name&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;| Value&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;|\n+-----------------------------------------------+---------------------+\n| Aborted_connects&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; | 3212&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; |\n| Connection_errors_accept&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; | 0&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;|\n| Connection_errors_internal&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; | 0&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;|\n| Connection_errors_max_connections&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;| 0&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;|\n| Connection_errors_peer_address&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; | 0&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;|\n| Connection_errors_select&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; | 0&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;|\n| Connection_errors_tcpwrap&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;| 0&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;|\n| Connections&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;| 3281&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; |\n| Locked_connects&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;| 0&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;|\n| Max_used_connections&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; | 13&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; |\n| Max_used_connections_time&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;| 2022-10-30 16:41:35 |\n| Performance_schema_session_connect_attrs_lost | 0&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;|\n| Ssl_client_connects&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;| 0&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;|\n| Ssl_connect_renegotiates&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; | 0&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;|\n| Ssl_finished_connects&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;| 0&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;|\n| Threads_connected&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;| 1&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;|\n+-----------------------------------------------+---------------------+\n16 rows in set (0.01 sec)\n</code></pre><p>Threads_connected è¡¨ç¤ºå½“å‰æœ‰å¤šå°‘è¿æ¥ï¼ŒMax_used_connections è¡¨ç¤ºæ›¾ç»æœ€å¤šæœ‰å¤šå°‘è¿æ¥ï¼ŒConnectionsè¡¨ç¤ºæ€»è®¡æ¥æ”¶è¿‡å¤šå°‘è¿æ¥ã€‚å½“ç„¶ï¼Œé™¤äº†è¿æ¥æ•°ç›¸å…³çš„æŒ‡æ ‡ï¼Œé€šè¿‡ <code>show global status</code> è¿˜å¯ä»¥è·å–å¾ˆå¤šå…¶ä»–çš„æŒ‡æ ‡ï¼Œè¿™äº›æŒ‡æ ‡ç”¨äºè¡¨ç¤ºMySQLçš„è¿è¡ŒçŠ¶æ€ï¼Œéšç€å®ä¾‹è¿è¡Œï¼Œè¿™äº›æ•°æ®ä¼šåŠ¨æ€å˜åŒ–ã€‚</p><p>è¿˜æœ‰å¦ä¸€ä¸ªå‘½ä»¤ <code>show global variables</code> å¯ä»¥è·å–ä¸€äº›å…¨å±€å˜é‡ä¿¡æ¯ï¼Œæ¯”å¦‚ä½¿ç”¨ä¸‹é¢çš„å‘½ä»¤å¯ä»¥è·å–MySQLæœ€å¤§è¿æ¥æ•°ã€‚</p><pre><code class=\"language-bash\">mysql&gt; show global variables like '%onn%';\n+-----------------------------------------------+-----------------+\n| Variable_name&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;| Value&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;|\n+-----------------------------------------------+-----------------+\n| character_set_connection&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; | utf8&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; |\n| collation_connection&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; | utf8_general_ci |\n| connect_timeout&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;| 10&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; |\n| disconnect_on_expired_password&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; | ON&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; |\n| init_connect&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; |&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;|\n| max_connect_errors&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; | 100&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;|\n| max_connections&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;| 5000&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; |\n| max_user_connections&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; | 0&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;|\n| performance_schema_session_connect_attrs_size | 512&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;|\n+-----------------------------------------------+-----------------+\n9 rows in set (0.01 sec)\n</code></pre><p>å…¶ä¸­ max_connections å°±æ˜¯æœ€å¤§è¿æ¥æ•°ï¼Œè¿™ä¸ªæ•°å€¼é»˜è®¤æ˜¯151ã€‚åœ¨å¾ˆå¤šç”Ÿäº§ç¯å¢ƒä¸‹ï¼Œéƒ½åº”è¯¥è°ƒå¤§ï¼Œæ‰€ä»¥æˆ‘ä»¬è¦æŠŠè¿™ä¸ªæŒ‡æ ‡ä½œä¸ºä¸€ä¸ªå‘Šè­¦è§„åˆ™ç›‘æ§èµ·æ¥ï¼Œå¦‚æœå‘ç°è¿™ä¸ªæ•°å€¼å¤ªå°è¦åŠæ—¶å‘Šè­¦ã€‚</p><p>å½“ç„¶ï¼Œé™¤äº†åˆšæ‰ä»‹ç»çš„ä¸¤ä¸ªå‘½ä»¤ï¼Œæˆ‘ä»¬è¿˜å¯ä»¥æ‰§è¡Œå…¶ä»–å‘½ä»¤è·å–å…¶ä»–æ•°æ®åº“æŒ‡æ ‡ï¼Œæ¯”å¦‚ <code>show slave status</code> å¯ä»¥è·å–SlaveèŠ‚ç‚¹çš„ä¿¡æ¯ã€‚æ€»çš„æ¥çœ‹ï¼ŒMySQLç›‘æ§çš„åŸç†å°±æ˜¯ï¼Œè¿ä¸ŠMySQLåæ‰§è¡Œå„ç§SQLè¯­å¥ï¼Œè§£æç»“æœï¼Œè½¬æ¢ä¸ºç›‘æ§æ—¶åºæ•°æ®ã€‚</p><p>ä¸Šé¢ä¾‹å­ä¸­çš„SQLè¯­å¥éƒ½æ˜¯ç”¨æ¥è·å–MySQLå®ä¾‹è¿è¡ŒçŠ¶æ€çš„ã€‚å®é™…ä¸Šï¼Œæ—¢ç„¶å¯ä»¥æ‰§è¡ŒSQLè¯­å¥ï¼Œæˆ‘ä»¬å°±å¯ä»¥è‡ªå®šä¹‰ä¸€äº›SQLæ¥æŸ¥è¯¢ä¸šåŠ¡æ•°æ®ï¼Œè·å–ä¸šåŠ¡æŒ‡æ ‡ã€‚ä¸Šä¸€è®²æˆ‘ä»¬ä¹Ÿæåˆ°è¿‡ï¼Œä¸šåŠ¡æŒ‡æ ‡æ•°æ®æ˜¯æ•´ä¸ªç›‘æ§ä½“ç³»ä¸­ä»·å€¼æœ€å¤§çš„ï¼Œæˆ‘ä»¬è¦å¥½å¥½åˆ©ç”¨è¿™ä¸ªèƒ½åŠ›ã€‚</p><p>æ¯”å¦‚æœ‰ä¸ª orders è¡¨å­˜å‚¨äº†è®¢å•æ•°æ®ï¼Œé‚£æˆ‘ä»¬å°±å¯ä»¥ä½¿ç”¨ä¸‹é¢çš„è¯­å¥è·å–è®¢å•æ€»é‡ã€‚</p><pre><code class=\"language-bash\">select count(*) as order_total from orders\n</code></pre><p>æŠŠ order_total è¿™ä¸ªè¿”å›å€¼ä½œä¸ºæœ€ç»ˆçš„ç›‘æ§æ•°æ®ä¸ŠæŠ¥å³å¯ã€‚è¿™ç§æ–¹å¼å¯¹äºä¸€äº›æ¯”è¾ƒç®€å•çš„å•è¡¨åœºæ™¯è¿˜æ˜¯æŒºå¥½ç”¨çš„ã€‚ä½†å¦‚æœä¸šåŠ¡ä¾§æœ‰åˆ†åº“åˆ†è¡¨ï¼Œå°±éœ€è¦ç”¨ä¸€äº›æ›´å¤æ‚çš„æ‰‹æ®µæ¥è§£å†³äº†ã€‚</p><p>Redisä¹Ÿæ˜¯ç±»ä¼¼çš„ï¼Œæ¯”å¦‚æˆ‘ä»¬é€šè¿‡ redis-cli ç™»å½•åˆ°å‘½ä»¤è¡Œï¼Œæ‰§è¡Œ <code>info memory</code> å‘½ä»¤ï¼Œå°±å¯ä»¥çœ‹åˆ°å¾ˆå¤šå†…å­˜ç›¸å…³çš„æŒ‡æ ‡ã€‚</p><pre><code class=\"language-bash\">127.0.0.1:6379&gt; info memory\n# Memory\nused_memory:1345568\nused_memory_human:1.28M\nused_memory_rss:3653632\nused_memory_rss_human:3.48M\nused_memory_peak:1504640\nused_memory_peak_human:1.43M\nused_memory_peak_perc:89.43%\nused_memory_overhead:1103288\nused_memory_startup:1095648\nused_memory_dataset:242280\nused_memory_dataset_perc:96.94%\n...\n</code></pre><p>è™½ç„¶æˆ‘æŠŠè¾“å‡ºæˆªæ–­äº†ï¼Œä½†ä¹Ÿå¾ˆå®¹æ˜“çœ‹å‡ºæ‰€ä»¥ç„¶ï¼Œè¾“å‡ºçš„æŒ‡æ ‡æ˜¯Key:Valueçš„æ ¼å¼ï¼ŒValueéƒ¨åˆ†æœ‰çš„å¸¦ç€å•ä½ï¼Œè§£æçš„æ—¶å€™éœ€è¦æ³¨æ„ä¸€ä¸‹ï¼Œåšä¸€ä¸ªæ ¼å¼è½¬æ¢ã€‚</p><p>æœ‰äº›ä¸šåŠ¡æ•°æ®å¯èƒ½æ˜¯å­˜åœ¨Redisé‡Œçš„ï¼Œæ‰€ä»¥ç›‘æ§Redisä¸åªæ˜¯è·å–Redisè‡ªèº«çš„æŒ‡æ ‡ï¼Œè¿˜åº”è¯¥æ”¯æŒè‡ªå®šä¹‰å‘½ä»¤ï¼Œè·å–ä¸€äº›ä¸šåŠ¡æ•°æ®ï¼Œæ¯”å¦‚ä¸‹é¢çš„å‘½ä»¤ï¼Œç”¨äºè·å–è®¢å•æ€»é‡ã€‚</p><pre><code class=\"language-bash\">get /orders/total\n</code></pre><p>è¿™ä¸ªä¾‹å­æ˜¯å‡è®¾ä¸šåŠ¡ç¨‹åºä¼šè‡ªåŠ¨æ›´æ–° Redis Keyï¼š/orders/totalï¼Œç”¨è¿™ä¸ªKeyæ¥å­˜æ”¾è®¢å•æ€»é‡ã€‚</p><p><img src=\"https://static001.geekbang.org/resource/image/0f/32/0f6091c107b263bcd481c278d821ee32.jpg?wh=3038x1850\" alt=\"\" title=\"ç›‘æ§åˆ†å±‚æ¶æ„å›¾\"></p><p>è®²åˆ°è¿™é‡Œï¼Œæˆ‘ä»¬å°±æŠŠå¸¸è§çš„OSå’Œä¸­é—´ä»¶çš„ç›‘æ§è®²å®Œäº†ï¼ŒæŒ‰ç…§ä¸Šä¸€è®²çš„ç›‘æ§åˆ†å±‚æ¶æ„å›¾ï¼Œæ¥ä¸‹æ¥å°±æ˜¯åº”ç”¨ç›‘æ§å’Œä¸šåŠ¡ç›‘æ§ï¼Œåº”ç”¨ç›‘æ§å’Œä¸šåŠ¡ç›‘æ§æœ‰ä¸¤ç§å…¸å‹çš„é‡‡é›†æ‰‹æ®µï¼Œä¸€ä¸ªæ˜¯åŸ‹ç‚¹ï¼Œä¸€ä¸ªæ˜¯æ—¥å¿—è§£æã€‚</p><h2>ä»£ç åŸ‹ç‚¹</h2><p>æ‰€è°“çš„ä»£ç åŸ‹ç‚¹æ–¹å¼ï¼Œæ˜¯æŒ‡åº”ç”¨ç¨‹åºå†…åµŒä¸€äº›ç›‘æ§ç›¸å…³çš„SDKï¼Œåœ¨è¯·æ±‚çš„å…³é”®é“¾è·¯ä¸Šè°ƒç”¨SDKçš„æ–¹æ³•ï¼Œå‘Šè¯‰SDKå½“å‰æ˜¯ä¸ªä»€ä¹ˆè¯·æ±‚ã€è€—æ—¶å¤šå°‘ã€æ˜¯å¦æˆåŠŸä¹‹ç±»çš„ï¼ŒSDKæ±‡æ€»è¿™äº›æ•°æ®å¹¶äºŒæ¬¡è®¡ç®—ï¼Œæœ€ç»ˆæ¨ç»™ç›‘æ§æœåŠ¡ç«¯ã€‚</p><p>æ¯”å¦‚ä¸€ä¸ªç”¨Goå†™çš„Webç¨‹åºï¼Œæä¾›äº†10ä¸ªHTTPæ¥å£ï¼Œæˆ‘ä»¬æƒ³è·å–è¿™10ä¸ªæ¥å£çš„æˆåŠŸç‡å’Œå»¶è¿Ÿæ•°æ®ï¼Œé‚£å°±è¦å†™ç¨‹åºå®ç°è¿™äº›é€»è¾‘ï¼ŒåŒ…æ‹¬æ•°æ®é‡‡é›†ã€ç»Ÿè®¡ã€è½¬å‘ç»™æœåŠ¡ç«¯ç­‰ã€‚è¿™äº›ç›‘æ§ç›¸å…³çš„é€»è¾‘æ˜¯å…¸å‹çš„æ¨ªå‘éœ€æ±‚ï¼Œè¿™ä¸ªWebç¨‹åºæœ‰éœ€æ±‚ï¼Œå…¶ä»–çš„ç¨‹åºä¹Ÿæœ‰è¿™ä¸ªéœ€æ±‚ï¼Œæ‰€ä»¥å°±æŠŠè¿™éƒ¨åˆ†ä»£ç æŠ½è±¡æˆä¸€ä¸ªç»Ÿä¸€çš„Libï¼Œå³ä¸Šé¢æåˆ°çš„è¿™ä¸ªSDKï¼Œæ¯ä¸ªéœ€è¦ç›‘æ§é€»è¾‘çš„ç¨‹åºéƒ½å¯ä»¥å¤ç”¨è¿™ä¸ªSDKï¼Œæå‡æ•ˆç‡ã€‚</p><p>ä½†æ˜¯æ¯ä¸ªé¡¹ç›®éƒ½è¦è°ƒç”¨è¿™ä¸ªSDKçš„æ–¹æ³•ä»ç„¶æ˜¾å¾—å¾ˆå†—ä½™ï¼Œæ˜¯å¦æœ‰æ›´ç®€å•çš„åŠæ³•å‘¢ï¼Ÿæœ‰ï¼æ¯ä¸ªå…¬å¸å¯ä»¥å»ºç«‹ç»Ÿä¸€çš„æ¡†æ¶å¼€å‘å›¢é˜Ÿï¼Œå¼€å‘ç»Ÿä¸€çš„HTTPæ¡†æ¶ï¼Œåœ¨æ¡†æ¶é‡Œä½¿ç”¨AOPçš„ç¼–ç¨‹æ–¹å¼ï¼Œå†…ç½®é‡‡é›†è¿™äº›ç›‘æ§æ•°æ®ã€‚è¿™æ ·ä¸€æ¥ï¼Œåªè¦æŸä¸ªå›¢é˜Ÿç”¨äº†è¿™ä¸ªç»Ÿä¸€çš„HTTPæ¡†æ¶ï¼Œå°±è‡ªåŠ¨å…·å¤‡äº†ç›‘æ§åŸ‹ç‚¹èƒ½åŠ›ã€‚åŒç†ï¼Œæˆ‘ä»¬ä¹Ÿå¯ä»¥æ„å»ºç»Ÿä¸€çš„RPCè°ƒç”¨æ¡†æ¶ï¼Œç»Ÿä¸€çš„MySQLè°ƒç”¨æ¡†æ¶ï¼Œè¿™æ ·å°±é€æ­¥æ„å»ºäº†ç»Ÿä¸€ä¸”å®Œå¤‡çš„åº”ç”¨ç›‘æ§æ•°æ®æ”¶é›†ä½“ç³»ã€‚</p><p>è¿™ç§æ–¹å¼éœ€è¦å†…åµŒSDKï¼Œå¯¹ä»£ç æœ‰ä¾µå…¥æ€§ï¼Œæ˜¯å¦æœ‰æ›´ç®€å•çš„åŠæ³•å‘¢ï¼Ÿæœ‰ï¼å¯¹äºJavaè¿™ç§å­—èŠ‚ç è¯­è¨€ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨ JavaAgent æŠ€æœ¯ï¼ŒåŠ¨æ€ä¿®æ”¹å­—èŠ‚ç ï¼Œè‡ªåŠ¨è·å–ç›‘æ§æ•°æ®ï¼Œåˆ°Googleä¸Šé€šè¿‡å…³é”®è¯â€œjavaagent monitoringâ€å¯ä»¥æ‰¾åˆ°å¾ˆå¤šèµ„æ–™ã€‚</p><p>å½“ç„¶ï¼Œç°åœ¨ä¹Ÿå¼€å§‹æµè¡Œ eBPF æŠ€æœ¯ï¼Œæœ‰äº›å‚å•†åœ¨å°è¯•ï¼Œä½ ä¹Ÿå¯ä»¥å…³æ³¨ä¸‹ã€‚ä¸è¿‡åœ¨ç”Ÿäº§å®è·µä¸­ï¼Œæˆ‘è§‚å¯Ÿå¤§éƒ¨åˆ†å‚å•†è¿˜æ˜¯åœ¨ç”¨åŸ‹ç‚¹çš„æ–¹å¼é‡‡é›†ç›‘æ§æ•°æ®ï¼Œåé¢ç¬¬19è®²æˆ‘ä¼šä¸“é—¨ç»™ä½ æ¼”ç¤ºå¦‚ä½•åšåŸ‹ç‚¹ã€‚</p><p>å¯¹äºè‡ªç ”çš„ç¨‹åºï¼Œä»£ç åŸ‹ç‚¹æ˜¯æ²¡é—®é¢˜çš„ï¼Œä½†æ˜¯å¾ˆå¤šç¨‹åºå¯èƒ½æ˜¯å¤–é‡‡çš„ï¼Œæˆ‘ä»¬æ²¡æ³•ä¿®æ”¹å®ƒçš„æºä»£ç ï¼Œè¿™æ—¶å€™å°±è¦ä½¿ç”¨<strong>æ—¥å¿—è§£æ</strong>çš„æ–¹å¼äº†ã€‚ä¸€èˆ¬ç¨‹åºéƒ½ä¼šæ‰“å°æ—¥å¿—ï¼Œæˆ‘ä»¬å¯ä»¥å†™æ—¥å¿—è§£æç¨‹åºï¼Œä»æ—¥å¿—ä¸­æå–ä¸€äº›å…³é”®ä¿¡æ¯ï¼Œæ¯”å¦‚ä»ä¸šåŠ¡æ—¥å¿—ä¸­å¾ˆå®¹æ˜“æ‹¿åˆ°Exceptionå…³é”®å­—å‡ºç°çš„æ¬¡æ•°ï¼Œä»æ¥å…¥å±‚æ—¥å¿—ä¸­å¾ˆå®¹æ˜“å°±èƒ½æ‹¿åˆ°æŸä¸ªæ¥å£çš„è®¿é—®æ¬¡æ•°ã€‚è¿™éƒ¨åˆ†å†…å®¹æˆ‘ä»¬ä¼šåœ¨ç¬¬20è®²è¯¦ç»†æ¼”ç¤ºï¼Œè¿™é‡Œå°±ä¸è¿‡å¤šä»‹ç»äº†ã€‚</p><h2>å°ç»“</h2><p>ä»Šå¤©æˆ‘ä»¬ä»‹ç»äº†å¤šç§ç›‘æ§æ•°æ®çš„é‡‡é›†æ–¹å¼ï¼Œå¸®åŠ©æˆ‘ä»¬ä»åŸç†çš„è§’åº¦æ¥ç†è§£ç›‘æ§æ•°æ®é‡‡é›†è¿™éƒ¨åˆ†å†…å®¹ï¼Œåé¢å†é‡åˆ°ç›‘æ§æŒ‡æ ‡è·å–ä¸åˆ°çš„é—®é¢˜ï¼Œæˆ‘ä»¬ä¹Ÿå¯ä»¥ä»åŸç†ä¸Šåšä¸€äº›æ’æŸ¥ã€‚</p><p>æ€»çš„æ¥çœ‹ï¼ŒOSå±‚é¢çš„ç›‘æ§éœ€è¦æŠŠAgentéƒ¨ç½²åˆ°æœºå™¨é‡Œï¼Œè¯»å–ä¸€äº›æœ¬åœ°çš„ç‰¹æ®Šæ–‡ä»¶ï¼Œæ‰§è¡Œä¸€äº›å‘½ä»¤æ¥è·å–ç›‘æ§æ•°æ®ï¼›æ•°æ®åº“ã€ä¸­é—´ä»¶çš„ç›‘æ§ï¼Œå¤§éƒ½æ˜¯è¿œç¨‹é‡‡é›†ï¼Œåªæ˜¯åè®®å„å¼‚ï¼Œéœ€è¦åšä¸€å®šçš„é€‚é…ï¼›åº”ç”¨ç›‘æ§çš„è¯ï¼Œå…¸å‹çš„é‡‡é›†æ–¹å¼æœ‰ä¸¤ç§ï¼Œä¸€ä¸ªæ˜¯ä»£ç åŸ‹ç‚¹ï¼Œä¸€ä¸ªæ˜¯æ—¥å¿—è§£æã€‚æœ€åæˆ‘æŠŠè¿™ä¸€è®²çš„å†…å®¹æ€»ç»“æˆäº†ä¸€å¼ è„‘å›¾ï¼Œå¸®ä½ ç†è§£å’Œè®°å¿†ã€‚</p><p><img src=\"https://static001.geekbang.org/resource/image/24/4d/24f725a7d2cff0e1a0e4e799d68cf54d.jpg?wh=2617x2354\" alt=\"\"></p><h2>äº’åŠ¨æ—¶åˆ»</h2><p>å­¦å®Œè¿™ä¸€è®²çš„å†…å®¹ï¼Œæ˜¯ä¸æ˜¯æ„Ÿè§‰ç›‘æ§æ˜¯ä¸ªéå¸¸é©³æ‚çš„é¢†åŸŸï¼Ÿç¡®å®æ˜¯è¿™æ ·ï¼Œæˆ‘ä»¬è¿™ä¸€è®²åªä»‹ç»äº†ä¸€äº›å¸¸è§çš„ç›‘æ§æ•°æ®é‡‡é›†æ–¹æ³•ï¼Œå®é™…ä¸Šè¿˜æœ‰ä¸€äº›å…¶ä»–çš„æ–¹æ³•æ²¡æœ‰ä»‹ç»ï¼Œä½ è¿˜çŸ¥é“å“ªäº›æ–¹æ³•ï¼Œæ¬¢è¿åœ¨è¯„è®ºåŒºç•™è¨€ï¼Œæˆ‘ä»¬ä¸€èµ·è®¨è®ºï¼Œä¹Ÿæ¬¢è¿ä½ æŠŠä»Šå¤©çš„å†…å®¹åˆ†äº«ç»™ä½ èº«è¾¹çš„æœ‹å‹ï¼Œé‚€ä»–ä¸€èµ·å­¦ä¹ ã€‚æˆ‘ä»¬ä¸‹ä¸€è®²å†è§ï¼</p>","neighbors":{"left":{"article_title":"09ï½œç›‘æ§æ¦‚è®ºï¼ˆä¸Šï¼‰ï¼šæœ‰å“ªäº›æ–¹æ³•å¯ä»¥æŒ‡å¯¼ç›‘æ§æ•°æ®é‡‡é›†ï¼Ÿ","id":624099},"right":{"article_title":"11ï½œæœºå™¨ç›‘æ§ï¼šæ“ä½œç³»ç»Ÿæœ‰å“ªäº›æŒ‡æ ‡éœ€è¦é‡ç‚¹å…³æ³¨ï¼Ÿ","id":625436}},"comments":[{"had_liked":false,"id":367267,"user_name":"MrPolo","can_delete":false,"product_type":"c1","uid":1449101,"ip_address":"ä¸­å›½å°æ¹¾","ucode":"1B08F61A7099F8","user_header":"","comment_is_top":false,"comment_ctime":1675082754,"is_pvip":false,"replies":[{"id":133799,"content":"categrafã€grafana-agentï¼Œä¹Ÿæ˜¯æŠŠ3å—éƒ½åŒ…è¿›å»äº†ï¼Œåé¢çš„ç« èŠ‚ä¸»è¦æ˜¯ä¸“æ³¨metricsé‡‡é›†","user_name":"ä½œè€…å›å¤","user_name_real":"ç¼–è¾‘","uid":1001078,"ctime":1675146800,"ip_address":"åŒ—äº¬","comment_id":367267,"utype":1}],"discussion_count":1,"race_medal":0,"score":2,"product_id":100522501,"comment_content":"è«‹æ•™è€å¸«æœƒä»‹ç´¹åˆ° open telemetry é€™å¡Šå—ï¼Œæœ€è¿‘çœ‹åˆ°é€™ä¼¼ä¹æŠŠ logï¼Œtraceï¼Œmetric éƒ½åŒ…é€²å»äº†ï¼Ÿ","like_count":3,"discussions":[{"author":{"id":1001078,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/46/76/67e111da.jpg","nickname":"å·´è¾‰ç‰¹","note":"","ucode":"DCBB150A99548D","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":601208,"discussion_content":"categrafã€grafana-agentï¼Œä¹Ÿæ˜¯æŠŠ3å—éƒ½åŒ…è¿›å»äº†ï¼Œåé¢çš„ç« èŠ‚ä¸»è¦æ˜¯ä¸“æ³¨metricsé‡‡é›†","likes_number":1,"is_delete":false,"is_hidden":false,"ctime":1675146800,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"åŒ—äº¬","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":367224,"user_name":"hshopeful","can_delete":false,"product_type":"c1","uid":1200048,"ip_address":"æ¹–åŒ—","ucode":"EE8D6E0A40607E","user_header":"https://static001.geekbang.org/account/avatar/00/12/4f/b0/ab179368.jpg","comment_is_top":false,"comment_ctime":1675050228,"is_pvip":false,"replies":[{"id":133788,"content":"ğŸ‘ğŸ»","user_name":"ä½œè€…å›å¤","user_name_real":"ç¼–è¾‘","uid":1001078,"ctime":1675058057,"ip_address":"åŒ—äº¬","comment_id":367224,"utype":1}],"discussion_count":1,"race_medal":0,"score":2,"product_id":100522501,"comment_content":"åœ¨æˆ‘çš„è®¤çŸ¥èŒƒå›´å†…ï¼Œå…³äºç›‘æ§æ•°æ®çš„é‡‡é›†æ–¹å¼ï¼Œè€å¸ˆå·²ç»è®²å¾—å¾ˆå…¨é¢çš„ï¼Œè¿˜æœ‰ä¸€ç§æ–¹å¼å…¶å®è·Ÿä¸Šé¢çš„ç±»ä¼¼ï¼š\nå¾ˆå¤šå¹´ä¹‹å‰æœ‰äº›å¼€æºè½¯ä»¶ä¼šå°†è‡ªèº«è®¡ç®—å¥½çš„æŒ‡æ ‡ç»´æŠ¤åœ¨æœ¬åœ°æ—¥å¿—ä¸­ï¼Œagent è¯»å–æ—¥å¿—ï¼Œä¸éœ€è¦åšæ­£åˆ™åŒ¹é…ï¼Œç›´æ¥è·å–æŒ‡æ ‡ï¼›å½“ç„¶è¿™ç§æ–¹å¼éšç€ prometheus çš„æµè¡Œï¼Œè¿™äº›å¼€æºè½¯ä»¶éƒ½ä¼šå°†è®¡ç®—å¥½çš„æŒ‡æ ‡é€šè¿‡æ¥å£æä¾›å‡ºå»ã€‚\n\nè¿˜æœ‰å“ªäº›æ–¹å¼ï¼Œå¸Œæœ›è€å¸ˆèƒ½è®²ä¸€ä¸‹ï¼Œè°¢è°¢ï¼","like_count":3,"discussions":[{"author":{"id":1001078,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/46/76/67e111da.jpg","nickname":"å·´è¾‰ç‰¹","note":"","ucode":"DCBB150A99548D","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":601096,"discussion_content":"ğŸ‘ğŸ»","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1675058057,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"åŒ—äº¬","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":367671,"user_name":"Geek_986cad","can_delete":false,"product_type":"c1","uid":3183051,"ip_address":"åŒ—äº¬","ucode":"87520BB5DB89D4","user_header":"https://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTLneMESMlYsVSQBkOUlRRscKxryhvb871ZmShVtDicvlI2FhsSSk6q05GumnVPG39vvfQZzKtLFcaA/132","comment_is_top":false,"comment_ctime":1675414361,"is_pvip":false,"replies":[{"id":133928,"content":"ğŸ‘ğŸ»","user_name":"ä½œè€…å›å¤","user_name_real":"ç¼–è¾‘","uid":1001078,"ctime":1675425670,"ip_address":"åŒ—äº¬","comment_id":367671,"utype":1}],"discussion_count":1,"race_medal":0,"score":2,"product_id":100522501,"comment_content":"æ€è€ƒé¢˜ï¼š \næœ‰äº›ç›‘æ§ä¿¡æ¯å¹¶ä¸èƒ½ç›´æ¥é‡‡é›†ï¼Œä¹Ÿä¸èƒ½é€šè¿‡ç›‘æ§è½¯ä»¶å·²æœ‰çš„å‡½æ•°ç­‰åŠŸèƒ½è®¡ç®—å¾—å‡ºã€‚\næ¯”å¦‚æˆ‘ä»¬å¦‚æœå…³å¿ƒ mysql æ•°æ®åº“ 24h ä¹‹å†…çš„ä¸»ä»åˆ‡æ¢æ¬¡æ•°çš„ä¿¡æ¯ï¼Œ\nå¦‚æœæƒ³é‡‡é›†è¿™ç±»ä¿¡æ¯ï¼Œå°±éœ€è¦åœ¨è¢«é‡‡é›†ç«¯ç¼–å†™ç›‘æ§ç¨‹åºï¼Œæœ€åå†æŠŠæ•°æ®â€œæ¨â€ï¼Œâ€œæ‹‰â€åˆ°ç›‘æ§æœåŠ¡å™¨ã€‚","like_count":1,"discussions":[{"author":{"id":1001078,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/46/76/67e111da.jpg","nickname":"å·´è¾‰ç‰¹","note":"","ucode":"DCBB150A99548D","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":601861,"discussion_content":"ğŸ‘ğŸ»","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1675425670,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"åŒ—äº¬","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":367212,"user_name":"peter","can_delete":false,"product_type":"c1","uid":1058183,"ip_address":"åŒ—äº¬","ucode":"261C3FC001DE2D","user_header":"https://static001.geekbang.org/account/avatar/00/10/25/87/f3a69d1b.jpg","comment_is_top":false,"comment_ctime":1675043647,"is_pvip":false,"replies":[{"id":133789,"content":"1ï¼Œæ˜¯åŒæ—¶æœ€å¤§è¿æ¥æ•°ï¼Œå…·ä½“åº”è¯¥è®¾ç½®ä¸ºå¤šå¤§ï¼Œè·Ÿæœºå™¨èµ„æºå’Œä¸šåŠ¡ç›¸å…³ï¼Œå¯ä»¥ç»Ÿè®¡ä¸€ä¸‹ä½ ä»¬ç°æœ‰çš„åº“çš„æƒ…å†µ\n2ï¼Œä»€ä¹ˆç»Ÿä¸€æ¡†æ¶ï¼Ÿé‡‡é›†ä¹ˆï¼Ÿå¤§éƒ¨åˆ†agentéƒ½æ˜¯å¼€æºçš„ï¼Œæ¯”å¦‚Telegrafã€categrafã€Datadog-agentã€Grafana-agent","user_name":"ä½œè€…å›å¤","user_name_real":"ç¼–è¾‘","uid":1001078,"ctime":1675058445,"ip_address":"åŒ—äº¬","comment_id":367212,"utype":1}],"discussion_count":1,"race_medal":0,"score":2,"product_id":100522501,"comment_content":"è¯·æ•™è€å¸ˆä¸¤ä¸ªé—®é¢˜ï¼š\nQ1ï¼šMySQLçš„max_connectionsæ˜¯åŒæ—¶æœ€å¤§è¿æ¥æ•°å—ï¼Ÿ\næ–‡ä¸­æœ‰è¿™ä¸€å¥ï¼šâ€œmax_connections å°±æ˜¯æœ€å¤§è¿æ¥æ•°ï¼Œè¿™ä¸ªæ•°å€¼é»˜è®¤æ˜¯ 151â€ã€‚max_connectionsæ˜¯ç´¯è®¡è¿æ¥æ•°å—ï¼Ÿè¿˜æ˜¯åŒæ—¶æœ€å¤§è¿æ¥æ•°ï¼Ÿ\nå¦‚æœæ˜¯åŒæ—¶è¿æ¥æ•°ï¼Œè®¾ç½®ä¸º5000æ˜¯ä¸æ˜¯å¤ªå¤§äº†ï¼Ÿ\n\nQ2ï¼šç»Ÿä¸€æ¡†æ¶æ˜¯å¦æœ‰å¼€æºçš„å®ç°ï¼Ÿ","like_count":1,"discussions":[{"author":{"id":1001078,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/46/76/67e111da.jpg","nickname":"å·´è¾‰ç‰¹","note":"","ucode":"DCBB150A99548D","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":601097,"discussion_content":"1ï¼Œæ˜¯åŒæ—¶æœ€å¤§è¿æ¥æ•°ï¼Œå…·ä½“åº”è¯¥è®¾ç½®ä¸ºå¤šå¤§ï¼Œè·Ÿæœºå™¨èµ„æºå’Œä¸šåŠ¡ç›¸å…³ï¼Œå¯ä»¥ç»Ÿè®¡ä¸€ä¸‹ä½ ä»¬ç°æœ‰çš„åº“çš„æƒ…å†µ\n2ï¼Œä»€ä¹ˆç»Ÿä¸€æ¡†æ¶ï¼Ÿé‡‡é›†ä¹ˆï¼Ÿå¤§éƒ¨åˆ†agentéƒ½æ˜¯å¼€æºçš„ï¼Œæ¯”å¦‚Telegrafã€categrafã€Datadog-agentã€Grafana-agent","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1675058445,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"åŒ—äº¬","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":367281,"user_name":"å¥•","can_delete":false,"product_type":"c1","uid":1005391,"ip_address":"å¹¿ä¸œ","ucode":"73CEA468CE70C3","user_header":"https://static001.geekbang.org/account/avatar/00/0f/57/4f/6fb51ff1.jpg","comment_is_top":false,"comment_ctime":1675091082,"is_pvip":false,"replies":[{"id":133800,"content":"æ˜¯çš„","user_name":"ä½œè€…å›å¤","user_name_real":"ç¼–è¾‘","uid":1001078,"ctime":1675146818,"ip_address":"åŒ—äº¬","comment_id":367281,"utype":1}],"discussion_count":1,"race_medal":0,"score":2,"product_id":100522501,"comment_content":"Prometheus åè®®æ•°æ® æ˜¯ Prometheus å®šä¹‰å¥½çš„è§„èŒƒå—ï¼Ÿ å…¶ä»–ä¸­é—´ä»¶æŒ‰ç…§è¿™ä¸ªåè®®å®ç°ï¼ŒPrometheus å°±å¯ä»¥ç›´æ¥è§£æ","like_count":0,"discussions":[{"author":{"id":1001078,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/46/76/67e111da.jpg","nickname":"å·´è¾‰ç‰¹","note":"","ucode":"DCBB150A99548D","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":601209,"discussion_content":"æ˜¯çš„","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1675146819,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"åŒ—äº¬","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":367244,"user_name":"éš†å“¥","can_delete":false,"product_type":"c1","uid":1793362,"ip_address":"ç¦å»º","ucode":"C251D9F349997D","user_header":"https://static001.geekbang.org/account/avatar/00/1b/5d/52/21275675.jpg","comment_is_top":false,"comment_ctime":1675064788,"is_pvip":false,"replies":[{"id":133802,"content":"çœ‹ç›®å½•å°±çŸ¥é“äº†ï¼Œä¼šæœ‰ä¸€äº›æ¶‰åŠ","user_name":"ä½œè€…å›å¤","user_name_real":"ç¼–è¾‘","uid":1001078,"ctime":1675146875,"ip_address":"åŒ—äº¬","comment_id":367244,"utype":1}],"discussion_count":1,"race_medal":0,"score":2,"product_id":100522501,"comment_content":"è€å¸ˆï¼Œåé¢ä¼šè¯´k8så†…éƒ¨ç½²prometheså’Œå¦‚ä½•é…ç½®å‘Šè­¦è§„åˆ™å•¥çš„å˜›ï¼Œè¿™å—æ˜¯åˆšéœ€å‘¢ï¼ï¼ï¼","like_count":0,"discussions":[{"author":{"id":1001078,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/46/76/67e111da.jpg","nickname":"å·´è¾‰ç‰¹","note":"","ucode":"DCBB150A99548D","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":601211,"discussion_content":"çœ‹ç›®å½•å°±çŸ¥é“äº†ï¼Œä¼šæœ‰ä¸€äº›æ¶‰åŠ","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1675146875,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"åŒ—äº¬","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]}]}