{"id":87732,"title":"35 | 单元测试","content":"<h1>课件及源代码地址</h1><p><a href=\"https://gitee.com/geektime-geekbang/go_learning\">https://gitee.com/geektime-geekbang/go_learning</a></p><h2>书目推荐</h2><p><a href=\"time://mall?url=https%3A%2F%2Fh5.youzan.com%2Fv2%2Fgoods%2F1ycmk3uob0ryw\">《计算机程序的构造和解释》</a></p>","comments":[{"had_liked":false,"id":372139,"user_name":"陆凌枫","can_delete":false,"product_type":"c3","uid":1349513,"ip_address":"广东","ucode":"622DEFC9DACDBA","user_header":"https://static001.geekbang.org/account/avatar/00/14/97/89/51f532f8.jpg","comment_is_top":false,"comment_ctime":1680774291,"is_pvip":false,"replies":[{"id":141643,"content":"可以使用 github.com&#47;stretchr&#47;testify&#47;mock 等 mock 工具库","user_name":"作者回复","user_name_real":"编辑","uid":1008262,"ctime":1712155161,"ip_address":"北京","comment_id":372139,"utype":1}],"discussion_count":1,"race_medal":0,"score":2,"product_id":100024001,"comment_content":"实际情况中，很多需要测试逻辑方法里会包含请求外部接口或者数据库等。在go中这样的方法该怎么测试呢？","like_count":0,"discussions":[{"author":{"id":1008262,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/62/86/632ad029.jpg","nickname":"蔡超","note":"","ucode":"4C281BBF511238","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":641090,"discussion_content":"可以使用 github.com/stretchr/testify/mock 等 mock 工具库","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1712155161,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"北京","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2,\"source\":0}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":83502,"user_name":"强哥","can_delete":false,"product_type":"c3","uid":1206726,"ip_address":"","ucode":"3B8DC780FE4EF9","user_header":"https://static001.geekbang.org/account/avatar/00/12/69/c6/513df085.jpg","comment_is_top":false,"comment_ctime":1554629849,"is_pvip":false,"replies":null,"discussion_count":0,"race_medal":0,"score":2,"product_id":100024001,"comment_content":"单元测试里标准是不应该有if、for这种逻辑的判断，只要存在逻辑判断就还是需要但测进行覆盖。","like_count":7},{"had_liked":false,"id":234923,"user_name":"Aprelude","can_delete":false,"product_type":"c3","uid":1658796,"ip_address":"","ucode":"840D3F7A35AEEF","user_header":"https://static001.geekbang.org/account/avatar/00/19/4f/ac/80439ba7.jpg","comment_is_top":false,"comment_ctime":1594826723,"is_pvip":false,"replies":null,"discussion_count":1,"race_medal":0,"score":2,"product_id":100024001,"comment_content":"go test -v这个命令 是显示打印日志的吗","like_count":4,"discussions":[{"author":{"id":1556406,"avatar":"https://wx.qlogo.cn/mmopen/vi_32/iaXcnYOjwO39gSSyo0CprNeLxx6OF80KqPz69ErJKmibMSxn5YeM4VGD6ATBnUR045ibsYjQGlAAQo5r3iaTPydTbA/132","nickname":"docker131313","note":"","ucode":"5B24734D18B57C","race_medal":5,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":636380,"discussion_content":"测试用的","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1706052266,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":"北京","group_id":0},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":236998,"user_name":"lidashuang","can_delete":false,"product_type":"c3","uid":1104850,"ip_address":"","ucode":"560ABE8032760E","user_header":"https://static001.geekbang.org/account/avatar/00/10/db/d2/e29f8834.jpg","comment_is_top":false,"comment_ctime":1595646988,"is_pvip":false,"replies":null,"discussion_count":0,"race_medal":2,"score":2,"product_id":100024001,"comment_content":"推荐这个包 \ngithub.com&#47;stretchr&#47;testify&#47;assert","like_count":2},{"had_liked":false,"id":287642,"user_name":"escray","can_delete":false,"product_type":"c3","uid":1020525,"ip_address":"","ucode":"1F4204930E47C4","user_header":"https://static001.geekbang.org/account/avatar/00/0f/92/6d/becd841a.jpg","comment_is_top":false,"comment_ctime":1618065344,"is_pvip":true,"replies":null,"discussion_count":0,"race_medal":0,"score":2,"product_id":100024001,"comment_content":"前面的课程采用了单元测试的方法来写，但是应该都是不太规范的写法，到这一节介绍了相对规范的单元测试写法。\n\n之前写过一段时间的 Ruby，对于 Rails 的那种把程序代码和单元测试代码分开放置的“约定”比较喜欢，不知道 Go 语言这边有没有类似的框架。\n\nJava SprintCloud 的单元测试似乎也是采用了类似的布局。\n\n在导入 github.com&#47;stretchr&#47;testify&#47;assert 的时候，遇到了 permission deny 的问题，最终的解决方案，其实是在 GOROOT 的目录下，给了 pkg 目录控制权限，可能不太规范。\n\n```\nsudo chmod -R 777 pkg\n```\n\n有一点好奇，GOPATH、GOROOT、GOBIN 这三个环境变量的作用，特别是在相对高版本的 Go 语言这边。","like_count":0},{"had_liked":false,"id":120963,"user_name":"我在你的视线里","can_delete":false,"product_type":"c3","uid":1480312,"ip_address":"","ucode":"5373F30E75C07E","user_header":"https://static001.geekbang.org/account/avatar/00/16/96/78/eb86673c.jpg","comment_is_top":false,"comment_ctime":1565019108,"is_pvip":false,"replies":null,"discussion_count":3,"race_medal":0,"score":2,"product_id":100024001,"comment_content":"go语言的做项目的框架有。类似Python的fladk  django的框架","like_count":0,"discussions":[{"author":{"id":1246451,"avatar":"https://static001.geekbang.org/account/avatar/00/13/04/f3/a3ff8a58.jpg","nickname":"roseduan","note":"","ucode":"5BB69BB9D329EC","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":329146,"discussion_content":"beego","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1606318711,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1104850,"avatar":"https://static001.geekbang.org/account/avatar/00/10/db/d2/e29f8834.jpg","nickname":"lidashuang","note":"","ucode":"560ABE8032760E","race_medal":2,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":293711,"discussion_content":"gin","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1595647014,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1524242,"avatar":"https://static001.geekbang.org/account/avatar/00/17/42/12/928fa044.jpg","nickname":"杨阳","note":"","ucode":"88FA5140EEE153","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":210881,"discussion_content":"gin","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1584787610,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]}]}