{"id":455415,"title":"20 | å›¾åƒåˆ†å‰²ï¼ˆä¸‹ï¼‰ï¼šå¦‚ä½•æ„å»ºä¸€ä¸ªå›¾åƒåˆ†å‰²æ¨¡å‹ï¼Ÿ","content":"<p>ä½ å¥½ï¼Œæˆ‘æ˜¯æ–¹è¿œã€‚</p><p>åœ¨ä¸Šä¸€èŠ‚è¯¾ä¸­ï¼Œæˆ‘ä»¬æŒæ¡äº†å›¾åƒåˆ†å‰²çš„ç†è®ºçŸ¥è¯†ï¼Œä½ æ˜¯ä¸æ˜¯å·²ç»è¿«ä¸åŠå¾…è¦ä¸Šæ‰‹ä½“éªŒä¸€ä¸‹ï¼Œæ‰¾æ‰¾æ‰‹æ„Ÿäº†å‘¢ï¼Ÿ</p><p>ä»Šå¤©æˆ‘ä»¬å°±ä»å¤´å¼€å§‹ï¼Œæ¥å®Œæˆä¸€ä¸ªå›¾åƒåˆ†å‰²é¡¹ç›®ã€‚é¡¹ç›®çš„å†…å®¹æ˜¯ï¼Œå¯¹å›¾ç‰‡ä¸­çš„å°çŒ«è¿›è¡Œè¯­ä¹‰åˆ†å‰²ã€‚ä¸ºäº†å®ç°è¿™ä¸ªé¡¹ç›®ï¼Œæˆ‘ä¼šå¼•å…¥ä¸€ä¸ªç®€å•ä½†å®ç”¨çš„ç½‘ç»œç»“æ„ï¼šUNetã€‚é€šè¿‡è¿™èŠ‚è¯¾çš„å­¦ä¹ ï¼Œä½ ä¸ä½†èƒ½å†æ¬¡ä½“éªŒä¸€ä¸‹å®Œæ•´æœºå™¨å­¦ä¹ çš„æ¨¡å‹å®ç°è¿‡ç¨‹ï¼Œè¿˜èƒ½å®é™…è®­ç»ƒä¸€ä¸ªè¯­ä¹‰åˆ†å‰²æ¨¡å‹ã€‚</p><p>è¯¾ç¨‹ä»£ç ä½ å¯ä»¥ä»<a href=\"https://github.com/syuu1987/geekTime-semantic-segmentation/tree/main\">è¿™é‡Œ</a>ä¸‹è½½ã€‚</p><h2>æ•°æ®éƒ¨åˆ†</h2><p>æˆ‘ä»¬è¿˜æ˜¯ä»æœºå™¨å­¦ä¹ å¼€å‘ä¸‰ä»¶å¥—ï¼šæ•°æ®ã€è®­ç»ƒã€è¯„ä¼°è¯´èµ·ã€‚é¦–å…ˆæ˜¯æ•°æ®å‡†å¤‡éƒ¨åˆ†ï¼Œæˆ‘ä»¬å…ˆå¯¹è®­ç»ƒæ•°æ®è¿›è¡Œæ ‡è®°ï¼Œç„¶åå®Œæˆæ•°æ®è¯»å–å·¥ä½œã€‚</p><h3>åˆ†å‰²å›¾åƒçš„æ ‡è®°</h3><p>ä¹‹å‰ä¹Ÿæåˆ°è¿‡ï¼Œå›¾åƒåˆ†å‰²çš„å‡†å¤‡ç›¸æ¯”å›¾åƒåˆ†ç±»çš„å‡†å¤‡æ›´åŠ å¤æ‚ã€‚é‚£æˆ‘ä»¬å¦‚ä½•æ ‡è®°è¯­ä¹‰åˆ†å‰²æ‰€éœ€è¦çš„å›¾ç‰‡å‘¢ï¼Ÿåœ¨å›¾åƒåˆ†å‰²ä¸­ï¼Œæˆ‘ä»¬ä½¿ç”¨çš„æ¯å¼ å›¾ç‰‡éƒ½è¦æœ‰ä¸€å¼ ä¸ä¹‹å¯¹åº”çš„Maskï¼Œå¦‚ä¸‹æ‰€ç¤ºï¼š</p><p><img src=\"https://static001.geekbang.org/resource/image/c2/db/c258c4f2ffd1f819c662aa1e9f6a8cdb.jpg?wh=1024x640\" alt=\"å›¾ç‰‡\"><br>\n<img src=\"https://static001.geekbang.org/resource/image/1a/a0/1a35623ceccb0750cd8058568d847fa0.png?wh=1024x640\" alt=\"å›¾ç‰‡\"></p><p>ä¸ŠèŠ‚è¯¾æˆ‘ä»¬è¯´è¿‡ï¼ŒMaskå°±æ˜¯å«æœ‰åƒç´ ç±»åˆ«çš„ç‰¹å¾å›¾ã€‚ç»“åˆè¿™é‡Œçš„ç¤ºä¾‹å›¾ç‰‡ï¼Œæˆ‘ä»¬å¯ä»¥çœ‹åˆ°ï¼ŒMaskå°±æ˜¯åŸå›¾æ‰€å¯¹åº”çš„ä¸€å¼ å›¾ç‰‡ï¼Œå®ƒçš„æ¯ä¸ªä½ç½®éƒ½è®°å½•ç€åŸå›¾æ¯ä¸ªä½ç½®å¯¹åº”çš„åƒç´ ç±»åˆ«ã€‚å¯¹äºMaskçš„æ ‡è®°ï¼Œæˆ‘ä»¬éœ€è¦ä½¿ç”¨åˆ°Labelmeå·¥å…·ã€‚</p><p>æ ‡è®°çš„æ–¹æ³•ä¸€å…±åŒ…æ‹¬ä¸ƒæ­¥ï¼Œæˆ‘ä»¬æŒ¨ä¸ªçœ‹ä¸€ä¸‹ã€‚</p><p>ç¬¬ä¸€æ­¥ï¼Œä¸‹è½½å®‰è£…<a href=\"https://github.com/wkentaro/labelme\">Labelme</a>ã€‚æˆ‘ä»¬æŒ‰ç…§Githubä¸­çš„å®‰è£…æ–¹å¼è¿›è¡Œå®‰è£…å³å¯ã€‚å¦‚æœå®‰è£…æ¯”è¾ƒæ…¢çš„è¯ï¼Œä½ å¯ä»¥ä½¿ç”¨å›½å†…çš„é•œåƒï¼ˆä¾‹å¦‚æ¸…åçš„ï¼‰è¿›è¡Œå®‰è£…ã€‚</p><!-- [[[read_end]]] --><p>ç¬¬äºŒæ­¥ï¼Œæˆ‘ä»¬è¦å°†éœ€è¦æ ‡è®°çš„å›¾â½šæ”¾åˆ°â¼€ä¸ªâ½‚ä»¶å¤¹ä¸­ã€‚è¿™é‡Œæˆ‘æ˜¯å°†æ‰€æœ‰çŒ«çš„å›¾ç‰‡æ”¾å…¥åˆ°catsæ–‡ä»¶å¤¹ä¸­äº†ã€‚</p><p><img src=\"https://static001.geekbang.org/resource/image/f3/04/f3c8cc99959c74f363ec290558a51d04.png?wh=1722x882\" alt=\"å›¾ç‰‡\"></p><p>ç¬¬ä¸‰æ­¥ï¼Œæˆ‘ä»¬äº‹å…ˆå‡†å¤‡å¥½â¼€ä¸ªlabel.txtçš„â½‚ä»¶ï¼Œâ¾¥â¾¯æ¯â¼€â¾å†™å¥½çš„éœ€è¦æ ‡è®°çš„ç±»åˆ«ã€‚æˆ‘çš„label.txtå¦‚ä¸‹ï¼š</p><pre><code class=\"language-python\">__ignore__\n_background_\ncat\n</code></pre><p>è¿™é‡Œæˆ‘è¦æé†’ä½ çš„æ˜¯ï¼Œå‰ä¸¤è¡Œæœ€å¥½è¿™ä¹ˆå†™ã€‚ä¸è¿™æ ·å†™çš„è¯ï¼Œä½¿ç”¨label2voc.pyè½¬æ¢å°±ä¼šæŠ¥é”™ï¼Œä½†label2voc.pyä¸æ˜¯å”¯ä¸€çš„æ•°æ®è½¬æ¢æ–¹å¼ï¼ˆè¿˜å¯ä»¥ä½¿ç”¨labelme_json_to_datasetï¼Œä½†æ¨èä½ ä½¿ç”¨label2voc.pyï¼‰ã€‚ä»ç¬¬ä¸‰è¡Œå¼€å§‹ï¼Œè¡¨ç¤ºè¦æ ‡è®°çš„ç±»åˆ«ã€‚</p><p>ç¬¬å››æ­¥ï¼Œæ‰§è¡Œåé¢çš„è¿™æ¡å‘½ä»¤ï¼Œå°±ä¼šè‡ªåŠ¨å¯åŠ¨Labelmeã€‚</p><pre><code class=\"language-python\">labelme --labels labels.txt --nodata\n</code></pre><p>ç¬¬äº”æ­¥ï¼Œç‚¹æˆ‘ä»¬å‡»å·¦ä¾§çš„Open Dirï¼Œé€‰æ‹©ç¬¬äºŒæ­¥ä¸­çš„æ–‡ä»¶å¤¹ï¼Œå°±ä¼šè‡ªåŠ¨å¯¼å…¥éœ€è¦æ ‡è®°çš„å›¾ç‰‡ã€‚åœ¨å³ä¸‹è§’é€‰æ‹©éœ€è¦æ ‡è®°çš„æ–‡ä»¶åï¼Œä¼šè‡ªåŠ¨æ˜¾ç¤ºå‡ºæ¥ï¼Œå¦‚ä¸‹å›¾æ‰€ç¤ºã€‚</p><p><img src=\"https://static001.geekbang.org/resource/image/0d/81/0d37591417e44d51a21bac11f409c381.png?wh=1780x1470\" alt=\"å›¾ç‰‡\"></p><p>ç¬¬å…­æ­¥ï¼šç‚¹å‡»å·¦ä¾§çš„Create Polygonsã€‚å°±å¯ä»¥å¼€å§‹æ ‡æ³¨äº†ã€‚æ ‡è®°çš„æ–¹å¼å°±æ˜¯å°†å°çŒ«æ²¿ç€å®ƒçš„è¾¹ç•Œç»™åœˆå‡ºæ¥ï¼Œå½“å½¢æˆä¸€ä¸ªé—­ç¯çš„æ—¶å€™ï¼ŒLabelmeä¼šè‡ªåŠ¨æç¤ºä½ è¾“å…¥ç±»åˆ«ï¼Œæˆ‘ä»¬é€‰æ‹©catç±»å³å¯ã€‚</p><p>æ ‡è®°æˆåŠŸåï¼Œç»“æœå¦‚ä¸‹å›¾æ‰€ç¤ºã€‚</p><p><img src=\"https://static001.geekbang.org/resource/image/88/y6/888dc5b576ccc9629cd1f3fd2d9cbyy6.png?wh=1676x1438\" alt=\"å›¾ç‰‡\"></p><p>å½“æ ‡è®°å®Œæˆåï¼Œæˆ‘ä»¬éœ€è¦ä¿å­˜ä¸€ä¸‹ï¼Œä¿å­˜ä¹‹åä¼šç”Ÿæˆæ ‡è®°å¥½çš„jsonæ–‡ä»¶ã€‚å¦‚ä¸‹æ‰€ç¤ºï¼š</p><pre><code class=\"language-python\">fangyuan@geektime data $ ls cats\n1.jpeg&nbsp; 1.json&nbsp; 10.jpeg 10.json 2.jpeg&nbsp; 3.jpeg&nbsp; 4.jpeg&nbsp; 4.json\n</code></pre><p>ç¬¬ä¸ƒæ­¥ï¼Œæ‰§è¡Œä¸‹é¢çš„ä»£ç ï¼Œå°†æ ‡è®°å¥½çš„æ•°æ®è½¬æ¢æˆMaskã€‚</p><pre><code class=\"language-python\">python label2voc.py cats cats_output --label label.txt&nbsp;\n</code></pre><p>ä¸Šé¢ä»£ç é‡Œç”¨åˆ°çš„label2voc.pyï¼Œä½ å¯ä»¥é€šè¿‡åé¢è¿™ä¸ªé“¾æ¥è·å–å®ƒï¼š<a href=\"https://github.com/wkentaro/labelme/blob/main/examples/semantic_segmentation/labelme2voc.py\">https://github.com/wkentaro/labelme/blob/main/examples/semantic_segmentation/labelme2voc.py</a>ã€‚</p><p>å…¶ä¸­ï¼Œcatsä¸ºæ ‡è®°å¥½çš„æ•°æ®ï¼Œcats_outputä¸ºè¾“å‡ºæ–‡ä»¶å¤¹ã€‚åœ¨cats_outputä¸‹ä¼šè‡ªåŠ¨ç”Ÿæˆ4ä¸ªæ–‡ä»¶å¤¹ï¼Œæˆ‘ä»¬åªéœ€è¦ä¸¤ä¸ªæ–‡ä»¶å¤¹ï¼Œåˆ†åˆ«æ˜¯JPEGImagesï¼ˆè®­ç»ƒåŸå›¾ï¼‰ä¸SegmentationClassPNGï¼ˆè½¬æ¢åçš„Maskï¼‰ã€‚</p><p>åˆ°æ­¤ä¸ºæ­¢ï¼Œæˆ‘ä»¬çš„æ•°æ®å°±å‡†å¤‡å¥½äº†ã€‚æˆ‘ä¸€å…±æ ‡è®°äº†8å¼ å›¾ç‰‡ï¼Œå¦‚ä¸‹æ‰€ç¤ºã€‚å½“ç„¶äº†ï¼Œåœ¨å®é™…çš„é¡¹ç›®ä¸­éœ€è¦å¤§é‡æ ‡è®°å¥½çš„å›¾ç‰‡ï¼Œè¿™é‡Œä¸»è¦æ˜¯ä¸ºäº†æ–¹ä¾¿æ¼”ç¤ºã€‚</p><p><img src=\"https://static001.geekbang.org/resource/image/7c/1d/7ca1ecafd3ce893610c5eb89yy7ca51d.png?wh=686x285\" alt=\"å›¾ç‰‡\"></p><p><img src=\"https://static001.geekbang.org/resource/image/53/67/53e088956a41de56ea1010af8a2a6d67.png?wh=703x324\" alt=\"å›¾ç‰‡\"></p><p>åˆ°æ­¤ä¸ºæ­¢ï¼Œæ ‡è®°å·¥ä½œå®£å‘Šå®Œæˆã€‚</p><h3>æ•°æ®è¯»å–</h3><p>å®Œæˆäº†æ ‡è®°å·¥ä½œä¹‹åï¼Œæˆ‘ä»¬å°±è¦ç”¨PyTorchæŠŠè¿™äº›æ•°æ®ç»™è¯»å…¥è¿›æ¥äº†ï¼Œæˆ‘ä»¬æŠŠæ•°æ®ç›¸å…³çš„å†™åœ¨dataset.pyä¸­ã€‚å…·ä½“è¿˜æ˜¯å’Œä¹‹å‰è®²çš„ä¸€æ ·ï¼Œè¦ç»§æ‰¿Datasetç±»ï¼Œç„¶åå®ç°__init__ã€__len__å’Œ__getitem__æ–¹æ³•ã€‚</p><p>dataset.pyçš„ä»£ç å¦‚ä¸‹æ‰€ç¤ºï¼Œæˆ‘å·²ç»åœ¨ä»£ç ä¸­å†™å¥½æ³¨é‡Šäº†ï¼Œç›¸ä¿¡ç»“åˆæ³¨é‡Šä½ å¾ˆå®¹æ˜“å°±èƒ½é¢†ä¼šæ„æ€ã€‚</p><pre><code class=\"language-python\">import os\nimport torch\nimport numpy as np\n\nfrom torch.utils.data import Dataset\nfrom PIL import Image \n\n\nclass CatSegmentationDataset(Dataset):\n    \n    # æ¨¡å‹è¾“å…¥æ˜¯3é€šé“æ•°æ®\n    in_channels = 3\n    # æ¨¡å‹è¾“å‡ºæ˜¯1é€šé“æ•°æ®\n    out_channels = 1\n\n    def __init__(\n        self,\n        images_dir,\n        image_size=256,\n    ):\n\n        print(\"Reading images...\")\n        # åŸå›¾æ‰€åœ¨çš„ä½ç½®\n        image_root_path = images_dir + os.sep + 'JPEGImages'\n        # Maskæ‰€åœ¨çš„ä½ç½®\n        mask_root_path = images_dir + os.sep + 'SegmentationClassPNG'\n        # å°†å›¾ç‰‡ä¸Maskè¯»å…¥åï¼Œåˆ†åˆ«å­˜åœ¨image_slicesä¸mask_slicesä¸­\n        self.image_slices = []\n        self.mask_slices = []\n        for im_name in os.listdir(image_root_path):\n            # åŸå›¾ä¸maskçš„åå­—æ˜¯ç›¸åŒçš„ï¼Œåªä¸è¿‡æ˜¯åç¼€ä¸ä¸€æ ·\n            mask_name = im_name.split('.')[0] + '.png' \n\n            image_path = image_root_path + os.sep + im_name\n            mask_path = mask_root_path + os.sep + mask_name\n\n            im = np.asarray(Image.open(image_path).resize((image_size, image_size)))\n            mask = np.asarray(Image.open(mask_path).resize((image_size, image_size)))\n            self.image_slices.append(im / 255.)\n            self.mask_slices.append(mask)\n\n    def __len__(self):\n        return len(self.image_slices)\n\n    def __getitem__(self, idx):\n\n        image = self.image_slices[idx] \n        mask = self.mask_slices[idx] \n\n        # tensorçš„é¡ºåºæ˜¯ï¼ˆBatch_size, é€šé“ï¼Œé«˜ï¼Œå®½ï¼‰è€Œnumpyè¯»å…¥åçš„é¡ºåºæ˜¯(é«˜ï¼Œå®½ï¼Œé€šé“)\n        image = image.transpose(2, 0, 1)\n        # Maskæ˜¯å•é€šé“æ•°æ®ï¼Œæ‰€ä»¥è¦å†åŠ ä¸€ä¸ªç»´åº¦\n        mask = mask[np.newaxis, :, :]\n\n        image = image.astype(np.float32)\n        mask = mask.astype(np.float32)\n\n        return image, mask\n</code></pre><p>ç„¶åï¼Œæˆ‘ä»¬çš„è®­ç»ƒä»£ç å†™åœ¨train.pyä¸­ï¼Œtrain.pyä¸­çš„mainå‡½æ•°ä¸ºä¸»å‡½æ•°ï¼Œåœ¨mainä¸­ï¼Œæˆ‘ä»¬ä¼šè°ƒç”¨data_loadersæ¥åŠ è½½æ•°æ®ã€‚ä»£ç å¦‚ä¸‹æ‰€ç¤ºï¼š</p><pre><code class=\"language-python\">import torch\n\nfrom torch.utils.data import DataLoader \nfrom torch.utils.data import DataLoader\nfrom dataset import CatSegmentationDataset as Dataset\n\ndef data_loaders(args):\n    dataset_train = Dataset(\n        images_dir=args.images,\n        image_size=args.image_size,\n    )\n\n    loader_train = DataLoader(\n        dataset_train,\n        batch_size=args.batch_size,\n        shuffle=True,\n        num_workers=args.workers,\n    )\n\n    return loader_train\n\n# argsæ˜¯ä¼ å…¥çš„å‚æ•°\ndef main(args):\n    loader_train = data_loaders(args)\n</code></pre><p>ä»¥ä¸Šå°±æ˜¯æ•°æ®å¤„ç†çš„å…¨éƒ¨å†…å®¹äº†ã€‚æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬å†æ¥çœ‹çœ‹æ¨¡å‹è®­ç»ƒéƒ¨åˆ†çš„å†…å®¹ã€‚</p><h2>æ¨¡å‹è®­ç»ƒ</h2><p>æˆ‘ä»¬å…ˆæ¥å›å¿†ä¸€ä¸‹ï¼Œæ¨¡å‹è®­ç»ƒçš„è€ä¸‰æ ·ï¼Œåˆ†åˆ«æ˜¯ç½‘ç»œç»“æ„ã€æŸå¤±å‡½æ•°å’Œä¼˜åŒ–æ–¹æ³•ã€‚</p><p>å…ˆä»ç½‘ç»œç»“æ„è¯´èµ·ï¼Œä»Šå¤©æˆ‘è¦ä¸ºä½ ä»‹ç»ä¸€ä¸ªå«åšUNetçš„è¯­ä¹‰åˆ†å‰²ç½‘ç»œã€‚</p><h3>ç½‘ç»œç»“æ„ï¼šUNet</h3><p><a href=\"https://arxiv.org/pdf/1505.04597.pdf\">UNet</a>æ˜¯ä¸€ä¸ªéå¸¸å®ç”¨çš„ç½‘ç»œã€‚å®ƒæ˜¯ä¸€ä¸ªå…¸å‹çš„Encoder-Decoderç±»å‹çš„åˆ†å‰²ç½‘ç»œï¼Œç½‘ç»œç»“æ„éå¸¸ç®€å•ï¼Œå¦‚ä¸‹å›¾æ‰€ç¤ºã€‚</p><p><img src=\"https://static001.geekbang.org/resource/image/11/b9/1196c6fcff2fe8c601f608b01bf82ab9.jpg?wh=1920x1130\" alt=\"å›¾ç‰‡\" title=\"å›¾ç‰‡æ¥è‡ªè®ºæ–‡ï¼šhttps://arxiv.org/pdf/1505.04597.pdf\"></p><p>å®ƒçš„ç½‘ç»œç»“æ„è™½ç„¶ç®€å•ï¼Œä½†æ˜¯æ•ˆæœå¹¶ä¸â€œç®€å•â€ï¼Œæˆ‘åœ¨å¾ˆå¤šé¡¹ç›®ä¸­éƒ½ç”¨å®ƒä¸ä¸€äº›ä¸»æµçš„è¯­ä¹‰åˆ†å‰²åšå¯¹æ¯”ï¼Œè€ŒUNetéƒ½å–å¾—äº†éå¸¸å¥½çš„æ•ˆæœã€‚</p><p>æ•´ä½“ç½‘ç»œç»“æ„è·Ÿè®ºæ–‡ä¸­ç»™å‡ºçš„ç¤ºæ„å›¾ä¸€æ ·ï¼Œæˆ‘ä»¬é‡ç‚¹å»å…³æ³¨å‡ ä¸ªå®ç°ç»†èŠ‚ã€‚</p><p>ç¬¬ä¸€ç‚¹ï¼Œå›¾ä¸­æ¨ªå‘è“è‰²çš„ç®­å¤´ï¼Œå®ƒä»¬éƒ½æ˜¯é‡å¤çš„ç›¸åŒç»“æ„ï¼Œéƒ½æ˜¯ç”±ä¸¤ä¸ª3x3çš„å·ç§¯å±‚ç»„åˆè€Œæˆçš„ï¼Œåœ¨æ¯å±‚å·ç§¯ä¹‹åä¼šè·Ÿéšä¸€ä¸ªBNå±‚ä¸ReLUçš„æ¿€æ´»å±‚ã€‚æŒ‰ç…§<a href=\"https://time.geekbang.org/column/article/442442\">ç¬¬14èŠ‚è¯¾</a>è®²çš„ï¼Œè¿™ä¸€éƒ¨åˆ†é‡å¤çš„ç»„ç»‡æ˜¯å¯ä»¥å•ç‹¬æå–å‡ºæ¥çš„ã€‚æˆ‘ä»¬å…ˆæ¥åˆ›å»ºä¸€ä¸ªunet.pyæ–‡ä»¶ï¼Œç”¨æ¥å®šä¹‰ç½‘ç»œç»“æ„ã€‚</p><p>ç°åœ¨unet.pyä¸­åˆ›å»ºBlockç±»ï¼Œå®ƒæ˜¯ç”¨æ¥å®šä¹‰åˆšæ‰æ‰€è¯´çš„é‡å¤çš„å·ç§¯å—ï¼š</p><pre><code class=\"language-python\">class Block(nn.Module):\n\n&nbsp; &nbsp; def __init__(self, in_channels, features):\n&nbsp; &nbsp; &nbsp; &nbsp; super(Block, self).__init__()\n\n&nbsp; &nbsp; &nbsp; &nbsp; self.features = features\n&nbsp; &nbsp; &nbsp; &nbsp; self.conv1 = nn.Conv2d(\n&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; in_channels=in_channels,\n&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; out_channels=features,\n&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; kernel_size=3,\n&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; padding='same',\n&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; )\n&nbsp; &nbsp; &nbsp; &nbsp; self.conv2 = nn.Conv2d(\n&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; in_channels=features,\n&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; out_channels=features,\n&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; kernel_size=3,\n&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; padding='same',\n&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; )\n\n&nbsp; &nbsp; def forward(self, input):\n&nbsp; &nbsp; &nbsp; &nbsp; x = self.conv1(input)\n&nbsp; &nbsp; &nbsp; &nbsp; x = nn.BatchNorm2d(num_features=self.features)(x)\n&nbsp; &nbsp; &nbsp; &nbsp; x = nn.ReLU(inplace=True)(x)\n&nbsp; &nbsp; &nbsp; &nbsp; x = self.conv2(x)\n&nbsp; &nbsp; &nbsp; &nbsp; x = nn.BatchNorm2d(num_features=self.features)(x)\n&nbsp; &nbsp; &nbsp; &nbsp; x = nn.ReLU(inplace=True)(x)\n\n&nbsp; &nbsp; &nbsp; &nbsp; return x\n</code></pre><p>è¿™é‡Œéœ€è¦æ³¨æ„çš„æ˜¯ï¼ŒåŒä¸€ä¸ªå—å†…ï¼Œç‰¹å¾å›¾çš„å°ºå¯¸æ˜¯ä¸å˜çš„ï¼Œæ‰€ä»¥paddingä¸ºsameã€‚</p><p>ç¬¬äºŒç‚¹ï¼Œå°±æ˜¯ç»¿è‰²å‘ä¸Šçš„ç®­å¤´ï¼Œä¹Ÿå°±æ˜¯ä¸Šé‡‡æ ·çš„è¿‡ç¨‹ã€‚è¿™å—çš„å®ç°å°±æ˜¯é‡‡ç”¨ä¸Šä¸€èŠ‚è¯¾æ‰€è®²çš„è½¬ç½®å·ç§¯æ¥å®ç°çš„ã€‚</p><p>æœ€åä¸€ç‚¹ï¼Œæˆ‘ä»¬ç°åœ¨æ˜¯è¦å¯¹å°çŒ«è¿›è¡Œåˆ†å‰²ï¼Œä¹Ÿå°±æ˜¯è¯´ä¸€å…±æœ‰ä¸¤ä¸ªç±»åˆ«â€”â€”çŒ«ä¸èƒŒæ™¯ã€‚å¯¹äºäºŒåˆ†ç±»çš„é—®é¢˜ï¼Œæˆ‘ä»¬å¯ä»¥ç›´æ¥è¾“å‡ºä¸€å¼ ç‰¹å¾å›¾ï¼Œç„¶åé€šè¿‡æ¦‚ç‡æ¥è¿›è¡Œåˆ¤æ–­æ˜¯æ­£ä¾‹ï¼ˆçŒ«ï¼‰è¿˜æ˜¯è´Ÿä¾‹ï¼ˆèƒŒæ™¯ï¼‰ï¼Œä¹Ÿå°±æ˜¯ä¸‹é¢ä»£ç ä¸­çš„ç¬¬71è¡Œã€‚åŒæ—¶ï¼Œä¸‹è¿°ä»£ç ä¹Ÿè¡¥å…¨äº†unet.pyä¸­çš„æ‰€æœ‰ä»£ç ã€‚</p><pre><code class=\"language-python\">import torch\nimport torch.nn as nn\n\nclass Block(nn.Module):\n    ...\nclass UNet(nn.Module):\n\n&nbsp; &nbsp; def __init__(self, in_channels=3, out_channels=1, init_features=32):\n&nbsp; &nbsp; &nbsp; &nbsp; super(UNet, self).__init__()\n\n&nbsp; &nbsp; &nbsp; &nbsp; features = init_features\n&nbsp; &nbsp; &nbsp; &nbsp; self.conv_encoder_1 = Block(in_channels, features)\n&nbsp; &nbsp; &nbsp; &nbsp; self.conv_encoder_2 = Block(features, features * 2)\n&nbsp; &nbsp; &nbsp; &nbsp; self.conv_encoder_3 = Block(features * 2, features * 4)\n&nbsp; &nbsp; &nbsp; &nbsp; self.conv_encoder_4 = Block(features * 4, features * 8)\n\n&nbsp; &nbsp; &nbsp; &nbsp; self.bottleneck = Block(features * 8, features * 16)\n\n&nbsp; &nbsp; &nbsp; &nbsp; self.upconv4 = nn.ConvTranspose2d(\n&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; features * 16, features * 8, kernel_size=2, stride=2\n&nbsp; &nbsp; &nbsp; &nbsp; )\n&nbsp; &nbsp; &nbsp; &nbsp; self.conv_decoder_4 = Block((features * 8) * 2, features * 8)\n&nbsp; &nbsp; &nbsp; &nbsp; self.upconv3 = nn.ConvTranspose2d(\n&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; features * 8, features * 4, kernel_size=2, stride=2\n&nbsp; &nbsp; &nbsp; &nbsp; )\n&nbsp; &nbsp; &nbsp; &nbsp; self.conv_decoder_3 = Block((features * 4) * 2, features * 4)\n&nbsp; &nbsp; &nbsp; &nbsp; self.upconv2 = nn.ConvTranspose2d(\n&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; features * 4, features * 2, kernel_size=2, stride=2\n&nbsp; &nbsp; &nbsp; &nbsp; )\n&nbsp; &nbsp; &nbsp; &nbsp; self.conv_decoder_2 = Block((features * 2) * 2, features * 2)\n&nbsp; &nbsp; &nbsp; &nbsp; self.upconv1 = nn.ConvTranspose2d(\n&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; features * 2, features, kernel_size=2, stride=2\n&nbsp; &nbsp; &nbsp; &nbsp; )\n&nbsp; &nbsp; &nbsp; &nbsp; self.decoder1 = Block(features * 2, features)\n\n&nbsp; &nbsp; &nbsp; &nbsp; self.conv = nn.Conv2d(\n&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; in_channels=features, out_channels=out_channels, kernel_size=1\n&nbsp; &nbsp; &nbsp; &nbsp; )\n\n&nbsp; &nbsp; def forward(self, x):\n&nbsp; &nbsp; &nbsp; &nbsp; conv_encoder_1_1 = self.conv_encoder_1(x)\n&nbsp; &nbsp; &nbsp; &nbsp; conv_encoder_1_2 = nn.MaxPool2d(kernel_size=2, stride=2)(conv_encoder_1_1)\n\n&nbsp; &nbsp; &nbsp; &nbsp; conv_encoder_2_1 = self.conv_encoder_2(conv_encoder_1_2)\n&nbsp; &nbsp; &nbsp; &nbsp; conv_encoder_2_2 = nn.MaxPool2d(kernel_size=2, stride=2)(conv_encoder_2_1)\n\n&nbsp; &nbsp; &nbsp; &nbsp; conv_encoder_3_1 = self.conv_encoder_3(conv_encoder_2_2)\n&nbsp; &nbsp; &nbsp; &nbsp; conv_encoder_3_2 = nn.MaxPool2d(kernel_size=2, stride=2)(conv_encoder_3_1)\n\n&nbsp; &nbsp; &nbsp; &nbsp; conv_encoder_4_1 = self.conv_encoder_4(conv_encoder_3_2)\n&nbsp; &nbsp; &nbsp; &nbsp; conv_encoder_4_2 = nn.MaxPool2d(kernel_size=2, stride=2)(conv_encoder_4_1)\n\n&nbsp; &nbsp; &nbsp; &nbsp; bottleneck = self.bottleneck(conv_encoder_4_2)\n\n&nbsp; &nbsp; &nbsp; &nbsp; conv_decoder_4_1 = self.upconv4(bottleneck)\n&nbsp; &nbsp; &nbsp; &nbsp; conv_decoder_4_2 = torch.cat((conv_decoder_4_1, conv_encoder_4_1), dim=1)\n&nbsp; &nbsp; &nbsp; &nbsp; conv_decoder_4_3 = self.conv_decoder_4(conv_decoder_4_2)\n\n&nbsp; &nbsp; &nbsp; &nbsp; conv_decoder_3_1 = self.upconv3(conv_decoder_4_3)\n&nbsp; &nbsp; &nbsp; &nbsp; conv_decoder_3_2 = torch.cat((conv_decoder_3_1, conv_encoder_3_1), dim=1)\n&nbsp; &nbsp; &nbsp; &nbsp; conv_decoder_3_3 = self.conv_decoder_3(conv_decoder_3_2)\n\n&nbsp; &nbsp; &nbsp; &nbsp; conv_decoder_2_1 = self.upconv2(conv_decoder_3_3)\n&nbsp; &nbsp; &nbsp; &nbsp; conv_decoder_2_2 = torch.cat((conv_decoder_2_1, conv_encoder_2_1), dim=1)\n&nbsp; &nbsp; &nbsp; &nbsp; conv_decoder_2_3 = self.conv_decoder_2(conv_decoder_2_2)\n\n&nbsp; &nbsp; &nbsp; &nbsp; conv_decoder_1_1 = self.upconv1(conv_decoder_2_3)\n&nbsp; &nbsp; &nbsp; &nbsp; conv_decoder_1_2 = torch.cat((conv_decoder_1_1, conv_encoder_1_1), dim=1)\n&nbsp; &nbsp; &nbsp; &nbsp; conv_decoder_1_3 = self.decoder1(conv_decoder_1_2)\n\n&nbsp; &nbsp; &nbsp; &nbsp; return torch.sigmoid(self.conv(conv_decoder_1_3))\n</code></pre><p>åˆ°è¿™é‡Œï¼Œç½‘ç»œç»“æ„æˆ‘ä»¬å°±æ­å»ºå¥½äº†ï¼Œç„¶åæˆ‘ä»¬æ¥æˆ‘çœ‹çœ‹æŸå¤±å‡½æ•°ã€‚</p><h3>æŸå¤±å‡½æ•°ï¼šDice Loss</h3><p>è¿™é‡Œæˆ‘ä»¬æ¥çœ‹ä¸€ä¸‹è¯­ä¹‰åˆ†å‰²ä¸­å¸¸ç”¨çš„æŸå¤±å‡½æ•°ï¼ŒDice Lossã€‚</p><p>æƒ³è¦çŸ¥é“è¿™ä¸ªæŸå¤±å‡½æ•°å¦‚ä½•ç”Ÿæˆï¼Œä½ éœ€è¦å…ˆäº†è§£ä¸€ä¸ªè¯­ä¹‰åˆ†å‰²çš„è¯„ä»·æŒ‡æ ‡ï¼ˆä½†æ›´å¸¸ç”¨çš„è¿˜æ˜¯åé¢è¦è®²çš„çš„mIoUï¼‰ï¼Œå®ƒå°±æ˜¯Diceç³»æ•°ï¼Œå¸¸ç”¨äºè®¡ç®—ä¸¤ä¸ªé›†åˆçš„ç›¸ä¼¼åº¦ï¼Œå–å€¼èŒƒå›´åœ¨0-1ä¹‹é—´ã€‚</p><p>Diceç³»æ•°çš„å…¬å¼å¦‚ä¸‹ã€‚</p><p>$$Dice=\\frac{2|P\\cap G|}{|P|+|G|}$$</p><p>å…¶ä¸­ï¼Œ$|P\\cap G|$æ˜¯é›†åˆPä¸é›†åˆGä¹‹é—´äº¤é›†å…ƒç´ çš„ä¸ªæ•°ï¼Œ$|P|$å’Œ$|G|$åˆ†åˆ«è¡¨ç¤ºé›†åˆPå’ŒGçš„å…ƒç´ ä¸ªæ•°ã€‚åˆ†å­çš„ç³»æ•°2ï¼Œè¿™æ˜¯ä¸ºäº†æŠµæ¶ˆåˆ†æ¯ä¸­På’ŒGä¹‹é—´çš„å…±åŒå…ƒç´ ã€‚å¯¹è¯­ä¹‰åˆ†å‰²ä»»åŠ¡è€Œè¨€ï¼Œé›†åˆPå°±æ˜¯é¢„æµ‹å€¼çš„Maskï¼Œé›†åˆGå°±æ˜¯çœŸå®å€¼çš„Maskã€‚</p><p>æ ¹æ®Diceç³»æ•°æˆ‘ä»¬å°±èƒ½è®¾è®¡å‡ºä¸€ç§æŸå¤±å‡½æ•°ï¼Œä¹Ÿå°±æ˜¯Dice Lossã€‚å®ƒçš„è®¡ç®—å…¬å¼éå¸¸ç®€å•ï¼Œå¦‚ä¸‹æ‰€ç¤ºã€‚</p><p>$$Dice Loss=1-\\frac{2|P\\cap G|}{|P|+|G|}$$</p><p>ä»å…¬å¼ä¸­å¯ä»¥çœ‹å‡ºï¼Œå½“é¢„æµ‹å€¼çš„Maskä¸GTè¶Šç›¸ä¼¼ï¼ŒæŸå¤±å°±è¶Šå°ï¼›å½“é¢„æµ‹å€¼çš„Maskä¸GTå·®å¼‚åº¦è¶Šå¤§ï¼ŒæŸå¤±å°±è¶Šå¤§ã€‚</p><p>å¯¹äºäºŒåˆ†ç±»é—®é¢˜ï¼ŒGTåªæœ‰0å’Œ1ä¸¤ä¸ªå€¼ã€‚å½“æˆ‘ä»¬ç›´æ¥ä½¿ç”¨æ¨¡å‹è¾“å‡ºçš„é¢„æµ‹æ¦‚ç‡è€Œä¸æ˜¯ä½¿ç”¨é˜ˆå€¼å°†å®ƒä»¬è½¬æ¢ä¸ºäºŒå€¼Maskæ—¶ï¼Œè¿™ç§æŸå¤±å‡½æ•°å°±è¢«ç§°ä¸ºSoft Dice Lossã€‚æ­¤æ—¶ï¼Œ$|P\\cap G|$çš„å€¼è¿‘ä¼¼ä¸ºGTä¸é¢„æµ‹æ¦‚ç‡çŸ©é˜µçš„ç‚¹ä¹˜ã€‚</p><p>å®šä¹‰æŸå¤±å‡½æ•°çš„ä»£ç å¦‚ä¸‹ã€‚</p><pre><code class=\"language-python\">import torch.nn as nn\n\nclass DiceLoss(nn.Module):\n&nbsp; &nbsp; def __init__(self):\n&nbsp; &nbsp; &nbsp; &nbsp; super(DiceLoss, self).__init__()\n&nbsp; &nbsp; &nbsp; &nbsp; self.smooth = 1.0\n\n&nbsp; &nbsp; def forward(self, y_pred, y_true):\n&nbsp; &nbsp; &nbsp; &nbsp; assert y_pred.size() == y_true.size()\n&nbsp; &nbsp; &nbsp; &nbsp; y_pred = y_pred[:, 0].contiguous().view(-1)\n&nbsp; &nbsp; &nbsp; &nbsp; y_true = y_true[:, 0].contiguous().view(-1)\n&nbsp; &nbsp; &nbsp; &nbsp; intersection = (y_pred * y_true).sum()\n&nbsp; &nbsp; &nbsp; &nbsp; dsc = (2. * intersection + self.smooth) / (\n&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; y_pred.sum() + y_true.sum() + self.smooth\n&nbsp; &nbsp; &nbsp; &nbsp; )\n&nbsp; &nbsp; &nbsp; &nbsp; return 1. - dsc\n</code></pre><p>å…¶ä¸­ï¼Œself.smoothæ˜¯ä¸€ä¸ªå¹³æ»‘å€¼ï¼Œè¿™æ˜¯ä¸ºäº†é˜²æ­¢åˆ†å­å’Œåˆ†æ¯ä¸º0çš„æƒ…å†µã€‚</p><h3>è®­ç»ƒæµç¨‹</h3><p>æœ€åï¼Œæˆ‘ä»¬å°†æ¨¡å‹ã€æŸå¤±å‡½æ•°å’Œä¼˜åŒ–æ–¹æ³•ä¸²èµ·æ¥ï¼Œçœ‹ä¸‹æ•´ä½“çš„è®­ç»ƒæµç¨‹ï¼Œè®­ç»ƒçš„ä»£ç å¦‚ä¸‹ã€‚</p><pre><code class=\"language-python\">def main(args):\n&nbsp; &nbsp; makedirs(args)\n    # æ ¹æ®cudaå¯ç”¨æƒ…å†µé€‰æ‹©ä½¿ç”¨cpuæˆ–gpu\n&nbsp; &nbsp; device = torch.device(\"cpu\" if not torch.cuda.is_available() else args.device)\n    # åŠ è½½è®­ç»ƒæ•°æ®\n&nbsp; &nbsp; loader_train = data_loaders(args)\n    # å®ä¾‹åŒ–UNetç½‘ç»œæ¨¡å‹\n&nbsp; &nbsp; unet = UNet(in_channels=Dataset.in_channels, out_channels=Dataset.out_channels)\n&nbsp; &nbsp; # å°†æ¨¡å‹é€å…¥gpuæˆ–cpuä¸­\n    unet.to(device)\n    # æŸå¤±å‡½æ•°\n&nbsp; &nbsp; dsc_loss = DiceLoss()\n    # ä¼˜åŒ–æ–¹æ³•\n&nbsp; &nbsp; optimizer = optim.Adam(unet.parameters(), lr=args.lr)\n\n&nbsp; &nbsp; loss_train = []\n&nbsp; &nbsp; step = 0\n    # è®­ç»ƒnä¸ªEpoch\n&nbsp; &nbsp; for epoch in tqdm(range(args.epochs), total=args.epochs):\n&nbsp; &nbsp; &nbsp; &nbsp; unet.train()\n&nbsp; &nbsp; &nbsp; &nbsp; for i, data in enumerate(loader_train):\n&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; step += 1\n&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; x, y_true = data\n&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; x, y_true = x.to(device), y_true.to(device)\n&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; y_pred = unet(x)\n&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; optimizer.zero_grad()\n&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; loss = dsc_loss(y_pred, y_true)\n&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; loss_train.append(loss.item())\n&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; loss.backward()\n&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; optimizer.step()\n&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; if (step + 1) % 10 == 0:\n&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; print('Step ', step, 'Loss', np.mean(loss_train))\n&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; loss_train = []\n&nbsp; &nbsp; &nbsp; &nbsp; torch.save(unet, args.weights + '/unet_epoch_{}.pth'.format(epoch))\n</code></pre><p>éœ€è¦æ³¨æ„çš„ç‚¹ï¼Œæˆ‘éƒ½åœ¨æ³¨é‡Šä¸­è¿›è¡Œäº†è¯´æ˜ï¼Œä½ å¯ä»¥è‡ªå·±çœ‹ä¸€çœ‹ã€‚å…¶å®å°±æ˜¯æˆ‘ä»¬ä¸€ç›´è¯´çš„æ¨¡å‹è®­ç»ƒçš„é‚£å‡ ä»¶äº‹æƒ…ï¼šæ•°æ®åŠ è½½ã€æ„å»ºç½‘ç»œä»¥åŠè¿­ä»£æ›´æ–°ç½‘ç»œå‚æ•°ã€‚</p><p>æˆ‘ç”¨è®­ç»ƒæ•°æ®è®­ç»ƒäº†è‹¥å¹²ä¸ªEpochï¼ŒåŒæ—¶ä¹Ÿä¿å­˜äº†è‹¥å¹²ä¸ªæ¨¡å‹ï¼Œä¿å­˜ä¸ºpthæ ¼å¼ã€‚åˆ°è¿™é‡Œå°±å®Œæˆäº†æ¨¡å‹è®­ç»ƒçš„æ•´ä¸ªç¯èŠ‚ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨ä¿å­˜å¥½çš„æ¨¡å‹è¿›è¡Œé¢„æµ‹ï¼Œæ¥çœ‹çœ‹åˆ†å‰²æ•ˆæœå¦‚ä½•ã€‚</p><h2>æ¨¡å‹é¢„æµ‹</h2><p>ç°åœ¨æˆ‘ä»¬è¦ç”¨è®­ç»ƒç”Ÿæˆçš„æ¨¡å‹æ¥è¿›è¡Œè¯­ä¹‰åˆ†å‰²ï¼Œçœ‹çœ‹ç»“æœæ˜¯ä»€ä¹ˆæ ·å­çš„ã€‚</p><p>æ¨¡å‹é¢„æµ‹çš„ä»£ç å¦‚ä¸‹ã€‚</p><pre><code class=\"language-python\">import torch\nimport numpy as np\n\nfrom PIL import Image\n\nimg_size = (256, 256)\n# åŠ è½½æ¨¡å‹\nunet = torch.load('./weights/unet_epoch_51.pth')\nunet.eval()\n# åŠ è½½å¹¶å¤„ç†è¾“å…¥å›¾ç‰‡\nori_image = Image.open('data/JPEGImages/6.jpg')\nim = np.asarray(ori_image.resize(img_size))\nim = im / 255.\nim = im.transpose(2, 0, 1)\nim = im[np.newaxis, :, :]\nim = im.astype('float32')\n# æ¨¡å‹é¢„æµ‹\noutput = unet(torch.from_numpy(im)).detach().numpy()\n# æ¨¡å‹è¾“å‡ºè½¬åŒ–ä¸ºMaskå›¾ç‰‡\noutput = np.squeeze(output)\noutput = np.where(output&gt;0.5, 1, 0).astype(np.uint8)\nmask = Image.fromarray(output, mode='P')\nmask.putpalette([0,0,0, 0,128,0])\nmask = mask.resize(ori_image.size)\nmask.save('output.png')\n</code></pre><p>è¿™æ®µä»£ç ä¹Ÿå¾ˆå¥½ç†è§£ã€‚é¦–å…ˆï¼Œç”¨torch.loadå‡½æ•°åŠ è½½æ¨¡å‹ã€‚æ¥ç€åŠ è½½ä¸€å¼ å¾…åˆ†å‰²çš„å›¾ç‰‡ï¼Œå¹¶è¿›è¡Œæ•°æ®é¢„å¤„ç†ã€‚ç„¶åå°†å¤„ç†å¥½çš„æ•°æ®é€å…¥æ¨¡å‹ä¸­ï¼Œå¾—åˆ°é¢„æµ‹å€¼outputã€‚æœ€åå°†é¢„æµ‹å€¼è½¬åŒ–ä¸ºå¯è§†åŒ–çš„Maskå›¾ç‰‡è¿›è¡Œä¿å­˜ã€‚</p><p>è¾“å…¥å›¾ç‰‡ä¹Ÿå°±æ˜¯å¾…åˆ†å‰²çš„å›¾ç‰‡ï¼Œå¦‚ä¸‹å·¦å›¾æ‰€ç¤ºã€‚æœ€ç»ˆçš„è¾“å‡ºï¼Œå³å¯è§†åŒ–çš„Maskå›¾ç‰‡å¦‚ä¸‹å³å›¾æ‰€ç¤ºã€‚</p><table>\n<thead>\n<tr>\n<th style=\"text-align:left\"><img src=\"https://static001.geekbang.org/resource/image/c2/db/c258c4f2ffd1f819c662aa1e9f6a8cdb.jpeg?wh=1024x640\" alt=\"å›¾ç‰‡\"></th>\n<th style=\"text-align:left\"><img src=\"https://static001.geekbang.org/resource/image/fb/61/fbfecd56d8c31589890fcd05c7995461.png?wh=1024x640\" alt=\"å›¾ç‰‡\"></th>\n</tr>\n</thead>\n<tbody></tbody>\n</table><p>åœ¨å°†é¢„æµ‹å€¼è½¬åŒ–ä¸ºMaskå›¾ç‰‡çš„è¿‡ç¨‹ä¸­ï¼Œæœ€ç»ˆé¢„æµ‹å€¼çš„æ¦‚ç‡å¡äº†0.5çš„é˜ˆå€¼ï¼Œè¶…è¿‡é˜ˆå€¼çš„åƒç´ ç‚¹ï¼Œåœ¨outputçŸ©é˜µä¸­çš„å€¼ä¸º1ï¼Œè¡¨ç¤ºçŒ«çš„åŒºåŸŸï¼Œæ²¡æœ‰è¶…è¿‡é˜ˆå€¼çš„åƒç´ ç‚¹ï¼Œåœ¨outputçŸ©é˜µä¸­çš„å€¼ä¸º0ï¼Œè¡¨ç¤ºèƒŒæ™¯åŒºåŸŸã€‚</p><p>ä¸ºäº†å°†outputçŸ©é˜µè¾“å‡ºä¸ºå¯è§†åŒ–çš„å›¾åƒï¼Œæˆ‘ä»¬ä½¿ç”¨Image.fromarrayå‡½æ•°ï¼Œå°†Numpyçš„arrayè½¬åŒ–ä¸ºImageæ ¼å¼ï¼Œå¹¶å°†æ¨¡å¼è®¾ç½®ä¸ºâ€œPâ€ï¼Œå³è°ƒè‰²æ¿æ¨¡å¼ã€‚ç„¶åç”¨putpaletteå‡½æ•°æ¥ç»™Imageå¯¹è±¡ä¸Šè‰²ã€‚</p><p>å…¶ä¸­ï¼Œputpaletteå‡½æ•°çš„å‚æ•°æ˜¯ä¸€ä¸ªåˆ—è¡¨ï¼š[0, 0, 0, 0, 128, 0]ï¼Œåˆ—è¡¨å‰ä¸‰ä¸ªæ•°è¡¨ç¤ºå€¼ä¸º0çš„åƒç´ çš„RGBï¼ˆ[0, 0, 0]è¡¨ç¤ºé»‘è‰²ï¼‰ï¼Œåˆ—è¡¨åä¸‰ä¸ªæ•°è¡¨ç¤ºå€¼ä¸º1çš„åƒç´ çš„RGBï¼ˆ[0, 128, 0]è¡¨ç¤ºç»¿è‰²ï¼‰ã€‚è¿™æ ·ï¼Œæˆ‘ä»¬ä¿å­˜çš„Maskå›¾ç‰‡ï¼Œé»‘è‰²éƒ¨åˆ†å³ä¸ºèƒŒæ™¯åŒºåŸŸï¼Œç»¿è‰²éƒ¨åˆ†å³ä¸ºçŒ«çš„åŒºåŸŸã€‚</p><p>ä¸è¿‡ï¼Œè¿™æ ·åˆ†å¼€çš„è½®å»“å›¾ï¼Œå¯èƒ½æ— æ³•è®©æˆ‘ä»¬å¾ˆç›´è§‚åœ°çœ‹å‡ºè¯­ä¹‰åˆ†å‰²çš„æ•ˆæœã€‚æ‰€ä»¥æˆ‘ä»¬å°†åŸå›¾å’ŒMaskåˆæˆä¸€å¼ å›¾ç‰‡æ¥çœ‹çœ‹æ•ˆæœã€‚å…·ä½“çš„ä»£ç å¦‚ä¸‹ã€‚</p><pre><code class=\"language-python\">image = ori_image.convert('RGBA')\nmask = mask.convert('RGBA')\n# åˆæˆ\nimage_mask = Image.blend(image, mask, 0.3)\nimage_mask.save(\"output_mask.png\")\n</code></pre><p>é¦–å…ˆï¼Œæˆ‘ä»¬å°†åŸå›¾imageå’ŒMaskå›¾ç‰‡éƒ½è½¬æ¢ä¸ºâ€™RGBAâ€™å¸¦é€æ˜åº¦çš„æ¨¡å¼ã€‚ç„¶åä½¿ç”¨Image.blendå‡½æ•°å°†ä¸¤å¼ å›¾ç‰‡åˆæˆä¸€å¼ å›¾ç‰‡ï¼Œæœ€åä¸€ä¸ªå‚æ•°0.3è¡¨ç¤ºMaskå›¾ç‰‡é€æ˜åº¦ä¸º30%ï¼ŒåŸå›¾çš„é€æ˜åº¦ä¸º70%ã€‚<br>\næœ€ç»ˆçš„ç»“æœå¦‚ä¸‹å›¾æ‰€ç¤ºã€‚</p><p><img src=\"https://static001.geekbang.org/resource/image/4d/7b/4d804527a87cc92aab8173da85f0ff7b.png?wh=1024x640\" alt=\"å›¾ç‰‡\"></p><p>è¿™æ ·æˆ‘ä»¬å°±å¯ä»¥ç›´è§‚åœ°çœ‹å‡ºå“ªäº›åœ°æ–¹é¢„æµ‹å¾—ä¸å‡†ç¡®äº†ã€‚</p><h2>æ¨¡å‹è¯„ä¼°</h2><p>åœ¨è¯­ä¹‰åˆ†å‰²ä¸­ï¼Œå¸¸ç”¨çš„è¯„ä»·æŒ‡æ ‡æ˜¯mIoUã€‚mIoUå…¨ç§°ä¸ºmean Intersection over Unionï¼Œå³å¹³å‡äº¤å¹¶æ¯”ã€‚äº¤å¹¶æ¯”æ˜¯çœŸå®å€¼å’Œé¢„æµ‹å€¼çš„äº¤é›†å’Œå¹¶é›†ä¹‹æ¯”ã€‚</p><p>çœŸå®å€¼å°±æ˜¯æˆ‘ä»¬åˆšåˆšç”¨labelmeæ ‡æ³¨çš„Maskï¼Œä¹Ÿæ˜¯Ground Truthï¼ˆGTï¼‰ã€‚å¦‚ä¸‹å·¦å›¾æ‰€ç¤ºã€‚</p><p>é¢„æµ‹å€¼å°±æ˜¯æ¨¡å‹é¢„æµ‹å‡ºçš„Maskï¼Œç”¨Predictionè¡¨ç¤ºã€‚å¦‚åé¢å³å›¾æ‰€ç¤ºã€‚</p><table>\n<thead>\n<tr>\n<th style=\"text-align:left\"><img src=\"https://static001.geekbang.org/resource/image/61/0b/61afb79172dfa0bd652f237fd1c5bd0b.png?wh=1024x640\" alt=\"å›¾ç‰‡\"></th>\n<th style=\"text-align:left\"><img src=\"https://static001.geekbang.org/resource/image/c3/9d/c31ec50a2a67262728a9fd8e84a1729d.png?wh=1024x640\" alt=\"å›¾ç‰‡\"></th>\n</tr>\n</thead>\n<tbody></tbody>\n</table><p>äº¤é›†æ˜¯æŒ‡çœŸå®å€¼ä¸é¢„æµ‹å€¼çš„äº¤é›†ï¼Œå¦‚ä¸‹å›¾é»„è‰²åŒºåŸŸæ‰€ç¤ºã€‚å¹¶é›†æ˜¯æŒ‡çœŸå®å€¼ä¸é¢„æµ‹å€¼çš„å¹¶é›†ï¼Œå¦‚ä¸‹å›¾è“è‰²åŒºåŸŸæ‰€ç¤ºã€‚</p><p><img src=\"https://static001.geekbang.org/resource/image/53/29/53e81fae1ceb5f21a269c3a461c6b129.png?wh=1024x640\" alt=\"å›¾ç‰‡\"></p><p>é€šè¿‡ä¸Šé¢å‡ ä¸ªå›¾ï¼Œæˆ‘ä»¬å¾ˆå®¹æ˜“å°±èƒ½ç†è§£mIoUäº†ã€‚mIoUçš„å…¬å¼å¦‚ä¸‹æ‰€ç¤ºã€‚</p><p>$$mIoU=\\frac{1}{k}\\sum_{i=1}^{k}{\\frac{P\\cap G}{P\\cup G}}$$</p><p>å…¶ä¸­ï¼Œkä¸ºæ‰€æœ‰ç±»åˆ«æ•°ï¼Œåœ¨æˆ‘ä»¬çš„ä¾‹å­ä¸­ï¼Œåªæœ‰â€œcatâ€ä¸€ç±»ï¼Œå› æ­¤kä¸º1ï¼Œæˆ‘ä»¬é€šå¸¸ä¸å°†èƒŒæ™¯è®¡ç®—åˆ°mIoUä¸­ï¼›Pä¸ºé¢„æµ‹å€¼ï¼›Gæ˜¯çœŸå®å€¼ã€‚</p><h2>å°ç»“</h2><p>æ­å–œä½ ï¼Œå®Œæˆäº†ä»Šå¤©çš„å­¦ä¹ ä»»åŠ¡ã€‚è¿™èŠ‚è¯¾æˆ‘ä»¬ä¸€èµ·å®Œæˆäº†ä¸€ä¸ªå›¾åƒåˆ†å‰²é¡¹ç›®çš„å®è·µã€‚</p><p>é¦–å…ˆï¼Œæˆ‘å¸¦ä½ äº†è§£äº†å›¾åƒåˆ†å‰²çš„æ•°æ®å‡†å¤‡ï¼Œéœ€è¦ä½¿ç”¨Labelmeå·¥å…·ä¸ºå›¾åƒåšæ ‡è®°ã€‚æ•°æ®è´¨é‡çš„å¥½åå†³å®šäº†æœ€ç»ˆæ¨¡å‹çš„è´¨é‡ï¼Œæ‰€ä»¥ä½ è¦å¯¹æ•°æ®çš„æ ‡æ³¨å¥½å¥½æŠŠæ¡ã€‚åœ¨ä½¿ç”¨Labelmeæ ‡è®°å®Œæˆä¹‹åï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨label2voc.pyå°†jsonè½¬æ¢ä¸ºMaskã€‚</p><p>ä¹‹åæˆ‘ä»¬å­¦ä¹ äº†ä¸€ç§éå¸¸é«˜æ•ˆä¸”å®ç”¨çš„æ¨¡å‹â€“UNetï¼Œå¹¶ä½¿ç”¨PyTorchå®ç°äº†å…¶ç½‘ç»œç»“æ„ã€‚</p><p>ç„¶åï¼Œæˆ‘ä¸ºä½ è®²è§£äº†å›¾åƒåˆ†å‰²çš„è¯„ä¼°æŒ‡æ ‡mIoUå’ŒæŸå¤±å‡½æ•°Dice Lossã€‚</p><p>mIoUçš„å…¬å¼å¦‚ä¸‹ï¼š</p><p>$$mIoU=\\frac{1}{k}\\sum_{i=1}^{k}{\\frac{P\\cap G}{P\\cup G}}$$</p><p>mIoUä¸»è¦æ˜¯ä»é¢„æµ‹ç»“æœä¸GTçš„é‡åˆåº¦è¿™ä¸€è§’åº¦ï¼Œæ¥è¡¡é‡åˆ†å‰²æ¨¡å‹çš„å¥½ä¸åçš„ï¼Œå®ƒæ˜¯å›¾åƒåˆ†å‰²ä¸­ç»å¸¸ä½¿ç”¨çš„è¯„ä»·æŒ‡æ ‡ã€‚</p><p>æœ€åï¼Œæˆ‘ä»¬ä½¿ç”¨è®­ç»ƒå¥½çš„æ¨¡å‹è¿›è¡Œé¢„æµ‹ï¼Œå¹¶å¯¹åˆ†å‰²ç»“æœè¿›è¡Œäº†å¯è§†åŒ–ç»˜åˆ¶ã€‚ç›¸ä¿¡é€šè¿‡ä¹‹å‰å­¦ä¹ çš„å›¾åƒåˆ†ç±»é¡¹ç›®ä¸ä»Šå¤©å­¦ä¹ çš„å›¾åƒåˆ†å‰²é¡¹ç›®ï¼Œå¯¹äºå›¾åƒå¤„ç†ï¼Œä½ ä¼šè·å¾—æ›´æ·±å±‚æ¬¡çš„ç†è§£ã€‚</p><h2>æ¯è¯¾ä¸€ç»ƒ</h2><p>ä½ å¯ä»¥æ ¹æ®ä»Šå¤©çš„å†…å®¹ï¼Œè‡ªå·±åŠ¨æ‰‹è¯•è¯•å»ºç«‹ä¸€ä¸ªå›¾åƒåˆ†å‰²æ¨¡å‹ï¼Œç„¶åç”¨ä¸€å¼ å›¾ç‰‡æ¥æµ‹ä¸€ä¸‹æ•ˆæœå¦‚ä½•ã€‚</p><p>æ¬¢è¿ä½ åœ¨ç•™è¨€åŒºè·Ÿæˆ‘äº¤æµè®¨è®ºï¼Œä¹Ÿæ¨èä½ æŠŠä»Šå¤©çš„å†…å®¹åˆ†äº«ç»™æ›´å¤šåŒäº‹ã€æœ‹å‹ï¼Œæˆ‘ä»¬ä¸‹èŠ‚è¯¾è§ã€‚</p><h1></h1>","neighbors":{"left":{"article_title":"19 | å›¾åƒåˆ†å‰²ï¼ˆä¸Šï¼‰ï¼šè¯¦è§£å›¾åƒåˆ†å‰²åŸç†ä¸å›¾åƒåˆ†å‰²æ¨¡å‹","id":450898},"right":{"article_title":"21 | NLPåŸºç¡€ï¼ˆä¸Šï¼‰ï¼šè¯¦è§£è‡ªç„¶è¯­è¨€å¤„ç†åŸç†ä¸å¸¸ç”¨ç®—æ³•","id":460504}},"comments":[{"had_liked":false,"id":334251,"user_name":"å…‹bugä½“è´¨","can_delete":false,"product_type":"c1","uid":2860418,"ip_address":"","ucode":"F810FAB99C7799","user_header":"https://static001.geekbang.org/account/avatar/00/2b/a5/82/183bc76c.jpg","comment_is_top":false,"comment_ctime":1644828154,"is_pvip":false,"replies":[{"id":"122142","content":"hiï¼ŒåŸå› æ˜¯å¦‚æœåœ¨forwardä¸­ä½¿ç”¨äº†nnè°ƒç”¨ç½‘ç»œä¸­çš„å±‚çš„è¯ï¼Œå®ƒé»˜è®¤ä¼šæ”¾åœ¨cpuä¸Šè®¡ç®—ã€‚<br>è§£å†³çš„åŠæ³•å°±æ˜¯æŠŠbnå’Œreluæ”¾åˆ°__init__ä¸­ï¼Œå¦‚ä¸‹ä»£ç æ‰€ç¤ºã€‚<br><br>class Block(nn.Module):<br><br>    def __init__(self, in_channels, features):<br>        super().__init__()<br>        self.features = features<br><br>        self.conv1 = nn.Conv2d(<br>                            in_channels=in_channels,<br>                            out_channels=features,<br>                            kernel_size=3,<br>                            padding=&#39;same&#39;,<br>                        )<br>        self.bn1 = nn.BatchNorm2d(num_features=self.features)<br>        self.relu1 = nn.ReLU()<br>        self.conv2 = nn.Conv2d(<br>                            in_channels=features,<br>                            out_channels=features,<br>                            kernel_size=3,<br>                            padding=&#39;same&#39;,<br>                        )<br>        self.bn2 = nn.BatchNorm2d(num_features=self.features)<br>        self.relu2 = nn.ReLU()<br><br>    def forward(self, input):<br>        x = self.conv1(input)<br>        x = self.bn1(x)<br>        x = self.relu1(x)<br>        x = self.conv2(x)<br>        x = self.bn2(x)<br>        x = self.relu2(x)<br>        return x<br>åŒç†U-Netä¸­çš„poolingä¹Ÿè¦æ”¾åˆ°__init__()ä¸­ã€‚","user_name":"ä½œè€…å›å¤","user_name_real":"ç¼–è¾‘","uid":"2802608","ctime":1644913232,"ip_address":"","comment_id":334251,"utype":1}],"discussion_count":3,"race_medal":0,"score":"18824697338","product_id":100093301,"comment_content":"è€å¸ˆä½ å¥½ï¼ŒLossä¹Ÿè¦æ”¾åˆ°æ”¾åˆ°gpuåä¹Ÿä¼šæŠ¥å’Œä¹‹å‰ä¸€æ ·çš„é”™è¯¯ï¼šã€<br>Expected all tensors to be on the same device, but found at least two devices, cuda:0 and cpu! (when checking argument for argument weight in method wrapper__cudnn_batch_norm)<br>  File &quot;D:\\U-Net\\unet.py&quot;, line 25, in forward<br>    x = nn.BatchNorm2d(num_features=self.features)(x)<br>  File &quot;D:\\U-Net\\unet.py&quot;, line 67, in forward<br>    conv_encoder_1_1 = self.conv_encoder_1(x)<br>  File &quot;D:\\U-Net\\train.py&quot;, line 50, in main<br>    y_pred = unet(x)<br>  File &quot;D:\\U-Net\\train.py&quot;, line 136, in &lt;module&gt;<br>    main(args)<br>ã€‘<br>æˆ‘å°è¯•åœ¨unet.pyæ–‡ä»¶ä¸­çš„åˆ›å»ºclass UNetä¸­self.conv_encoder_1 = Block(in_channels, features)æ”¹ä¸ºï¼šself.conv_encoder_1 = Block(in_channels, features).to(device)åä¹Ÿæ²¡è§£å†³è¿™ä¸ªé—®é¢˜ï¼Œä¼šæŠ¥ä¸€æ ·çš„é”™ã€‚","like_count":4,"discussions":[{"author":{"id":2802608,"avatar":"https://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTK1ZkL9L7CEicI87xicpIhXAIhVdVWpJKBsD8Jpzg9iaAwFcDEhTvdRwuKItJS14mYznT2w2YQvn8QsQ/132","nickname":"æ–¹è¿œ","note":"","ucode":"248B1DE180EB4C","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":551157,"discussion_content":"hiï¼ŒåŸå› æ˜¯å¦‚æœåœ¨forwardä¸­ä½¿ç”¨äº†nnè°ƒç”¨ç½‘ç»œä¸­çš„å±‚çš„è¯ï¼Œå®ƒé»˜è®¤ä¼šæ”¾åœ¨cpuä¸Šè®¡ç®—ã€‚\nè§£å†³çš„åŠæ³•å°±æ˜¯æŠŠbnå’Œreluæ”¾åˆ°__init__ä¸­ï¼Œå¦‚ä¸‹ä»£ç æ‰€ç¤ºã€‚\n\nclass Block(nn.Module):\n\n    def __init__(self, in_channels, features):\n        super().__init__()\n        self.features = features\n\n        self.conv1 = nn.Conv2d(\n                            in_channels=in_channels,\n                            out_channels=features,\n                            kernel_size=3,\n                            padding=&#39;same&#39;,\n                        )\n        self.bn1 = nn.BatchNorm2d(num_features=self.features)\n        self.relu1 = nn.ReLU()\n        self.conv2 = nn.Conv2d(\n                            in_channels=features,\n                            out_channels=features,\n                            kernel_size=3,\n                            padding=&#39;same&#39;,\n                        )\n        self.bn2 = nn.BatchNorm2d(num_features=self.features)\n        self.relu2 = nn.ReLU()\n\n    def forward(self, input):\n        x = self.conv1(input)\n        x = self.bn1(x)\n        x = self.relu1(x)\n        x = self.conv2(x)\n        x = self.bn2(x)\n        x = self.relu2(x)\n        return x\nåŒç†U-Netä¸­çš„poolingä¹Ÿè¦æ”¾åˆ°__init__()ä¸­ã€‚","likes_number":1,"is_delete":false,"is_hidden":false,"ctime":1644913232,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":2,"child_discussions":[{"author":{"id":2860418,"avatar":"https://static001.geekbang.org/account/avatar/00/2b/a5/82/183bc76c.jpg","nickname":"å…‹bugä½“è´¨","note":"","ucode":"F810FAB99C7799","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":2802608,"avatar":"https://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTK1ZkL9L7CEicI87xicpIhXAIhVdVWpJKBsD8Jpzg9iaAwFcDEhTvdRwuKItJS14mYznT2w2YQvn8QsQ/132","nickname":"æ–¹è¿œ","note":"","ucode":"248B1DE180EB4C","race_medal":0,"user_type":2,"is_pvip":false},"discussion":{"id":551380,"discussion_content":"å¥½çš„ï¼Œæ„Ÿè°¢è€å¸ˆï¼å­¦ä¹ åˆ°äº†ğŸ™","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1645003284,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":551157,"ip_address":""},"score":551380,"extra":""},{"author":{"id":2802608,"avatar":"https://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTK1ZkL9L7CEicI87xicpIhXAIhVdVWpJKBsD8Jpzg9iaAwFcDEhTvdRwuKItJS14mYznT2w2YQvn8QsQ/132","nickname":"æ–¹è¿œ","note":"","ucode":"248B1DE180EB4C","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":2860418,"avatar":"https://static001.geekbang.org/account/avatar/00/2b/a5/82/183bc76c.jpg","nickname":"å…‹bugä½“è´¨","note":"","ucode":"F810FAB99C7799","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":551383,"discussion_content":"ä¸å®¢æ°”ä¸å®¢æ°”^^Â Â ","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1645003592,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":551380,"ip_address":""},"score":551383,"extra":""}]}]},{"had_liked":false,"id":346957,"user_name":"äºšæ—","can_delete":false,"product_type":"c1","uid":1018972,"ip_address":"","ucode":"4A5A6D24314B79","user_header":"https://static001.geekbang.org/account/avatar/00/0f/8c/5c/3f164f66.jpg","comment_is_top":false,"comment_ctime":1653559170,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"5948526466","product_id":100093301,"comment_content":"ç…§ç€æŠ„ï¼ŒæŠ„å‡ºæ¥äº†","like_count":1},{"had_liked":false,"id":344824,"user_name":"..................","can_delete":false,"product_type":"c1","uid":2980638,"ip_address":"","ucode":"3203CA634FC3A7","user_header":"https://static001.geekbang.org/account/avatar/00/2d/7b/1e/8bb7c7fe.jpg","comment_is_top":false,"comment_ctime":1651809546,"is_pvip":false,"replies":[{"id":"126006","content":"^^ æ„Ÿè°¢æ”¯æŒï¼ŒåŠ æ²¹","user_name":"ä½œè€…å›å¤","user_name_real":"ç¼–è¾‘","uid":"2802608","ctime":1652163178,"ip_address":"","comment_id":344824,"utype":1}],"discussion_count":1,"race_medal":0,"score":"5946776842","product_id":100093301,"comment_content":"çœŸçš„å¾ˆæ£’ï¼Œæˆ‘è¦äº²æ‰‹æ“ä½œä¸€é","like_count":1,"discussions":[{"author":{"id":2802608,"avatar":"https://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTK1ZkL9L7CEicI87xicpIhXAIhVdVWpJKBsD8Jpzg9iaAwFcDEhTvdRwuKItJS14mYznT2w2YQvn8QsQ/132","nickname":"æ–¹è¿œ","note":"","ucode":"248B1DE180EB4C","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":571267,"discussion_content":"^^ æ„Ÿè°¢æ”¯æŒï¼ŒåŠ æ²¹","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1652163178,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":331758,"user_name":"è“è‰²å¤©ç©º  å¥½èŒå•Š","can_delete":false,"product_type":"c1","uid":2642907,"ip_address":"","ucode":"2D4620E82BC4A2","user_header":"https://static001.geekbang.org/account/avatar/00/28/53/db/244953c6.jpg","comment_is_top":false,"comment_ctime":1642752330,"is_pvip":false,"replies":[{"id":"121299","content":"helloï¼Œä½ å¥½ï¼Œæˆ‘ä¼ åˆ°è¿™é‡Œäº†ã€‚<br>https:&#47;&#47;github.com&#47;syuu1987&#47;geekTime-semantic-segmentation&#47;tree&#47;main","user_name":"ä½œè€…å›å¤","user_name_real":"ç¼–è¾‘","uid":"2802608","ctime":1642987078,"ip_address":"","comment_id":331758,"utype":1}],"discussion_count":1,"race_medal":0,"score":"5937719626","product_id":100093301,"comment_content":"è€å¸ˆä½ å¥½ï¼Œè¯·é—®æœ‰è¿™èŠ‚è¯¾çš„å®Œæ•´ä»£ç åœ°å€å—ï¼Ÿ","like_count":1,"discussions":[{"author":{"id":2802608,"avatar":"https://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTK1ZkL9L7CEicI87xicpIhXAIhVdVWpJKBsD8Jpzg9iaAwFcDEhTvdRwuKItJS14mYznT2w2YQvn8QsQ/132","nickname":"æ–¹è¿œ","note":"","ucode":"248B1DE180EB4C","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":547978,"discussion_content":"helloï¼Œä½ å¥½ï¼Œæˆ‘ä¼ åˆ°è¿™é‡Œäº†ã€‚\nhttps://github.com/syuu1987/geekTime-semantic-segmentation/tree/main","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1642987078,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":326185,"user_name":"Geek_a95f0e","can_delete":false,"product_type":"c1","uid":2824511,"ip_address":"","ucode":"C0B7418FD1D2B5","user_header":"","comment_is_top":false,"comment_ctime":1639407259,"is_pvip":false,"replies":[{"id":"118449","content":"hi ä½ å¥½ã€‚æ„Ÿè°¢ä½ çš„ç•™è¨€ã€‚<br>è¿™å—å¯èƒ½æˆ‘è¯¯å¯¼ä½ äº†ï¼Œéƒ½æ˜¯ä¸€æ ·çš„ã€‚<br>Python3ä¸­super().__init__()ä»£æ›¿äº†Python2ä¸­çš„super(class_name,self).__init__() ","user_name":"ä½œè€…å›å¤","user_name_real":"ç¼–è¾‘","uid":"2802608","ctime":1639447249,"ip_address":"","comment_id":326185,"utype":1}],"discussion_count":2,"race_medal":0,"score":"5934374555","product_id":100093301,"comment_content":"æ–¹è€å¸ˆï¼Œå¯ä¸å¯ä»¥è§£é‡Šä¸€ä¸‹è‡ªå®šä¹‰ç±»ä¸­ super().__init__() å’Œsuper(class_name,self).__init__() æœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿ","like_count":1,"discussions":[{"author":{"id":2802608,"avatar":"https://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTK1ZkL9L7CEicI87xicpIhXAIhVdVWpJKBsD8Jpzg9iaAwFcDEhTvdRwuKItJS14mYznT2w2YQvn8QsQ/132","nickname":"æ–¹è¿œ","note":"","ucode":"248B1DE180EB4C","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":538564,"discussion_content":"hi ä½ å¥½ã€‚æ„Ÿè°¢ä½ çš„ç•™è¨€ã€‚\nè¿™å—å¯èƒ½æˆ‘è¯¯å¯¼ä½ äº†ï¼Œéƒ½æ˜¯ä¸€æ ·çš„ã€‚\nPython3ä¸­super().__init__()ä»£æ›¿äº†Python2ä¸­çš„super(class_name,self).__init__() ","likes_number":1,"is_delete":false,"is_hidden":false,"ctime":1639447249,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":1,"child_discussions":[{"author":{"id":2824511,"avatar":"","nickname":"Geek_a95f0e","note":"","ucode":"C0B7418FD1D2B5","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":2802608,"avatar":"https://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTK1ZkL9L7CEicI87xicpIhXAIhVdVWpJKBsD8Jpzg9iaAwFcDEhTvdRwuKItJS14mYznT2w2YQvn8QsQ/132","nickname":"æ–¹è¿œ","note":"","ucode":"248B1DE180EB4C","race_medal":0,"user_type":2,"is_pvip":false},"discussion":{"id":538619,"discussion_content":"å¥½çš„ï¼Œè°¢è°¢ã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1639455186,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":538564,"ip_address":""},"score":538619,"extra":""}]}]},{"had_liked":false,"id":323605,"user_name":"vcjmhg","can_delete":false,"product_type":"c1","uid":1526461,"ip_address":"","ucode":"B508D1E9B3F974","user_header":"http://thirdwx.qlogo.cn/mmopen/vi_32/j24oyxHcpB5AMR9pMO6fITqnOFVOncnk2T1vdu1rYLfq1cN6Sj7xVrBVbCvHXUad2MpfyBcE4neBguxmjIxyiaQ/132","comment_is_top":false,"comment_ctime":1638014229,"is_pvip":false,"replies":[{"id":"117498","content":"helloï¼Œå°ç‰©ä½“åˆ†å‰²ä¸å¥½çš„ä¸€ä¸ªåŸå› æ˜¯åœ¨backboneçš„ç‰¹å¾æå–è¿‡ç¨‹ä¸­ï¼Œå°ç‰©ä½“çš„ä¿¡æ¯å·²ç»è¢«å¿½ç•¥äº†ã€‚<br>ä¸¾ä¸ªä¾‹å­ï¼Œå‡è®¾è¾“å…¥æ˜¯256x256çš„æ•°æ®ï¼Œç»è¿‡å¤šå±‚çš„ç‰¹å¾æå–åç‰¹å¾å›¾ä¾æ¬¡ä¸º128x128ï¼Œ64x64ï¼Œ32x32ï¼Œ16x16ã€‚æœ‰å¯èƒ½å°ç‰©ä½“çš„ä¿¡æ¯åœ¨32x32é‚£é‡Œå°±æ¶ˆå¤±äº†ã€‚<br>ä»è¿™ä¸ªè§’åº¦å‡ºå‘ï¼Œå¯ä»¥çœ‹çœ‹èƒ½ä¸èƒ½è°ƒæ•´ç½‘ç»œæœ€å°çš„ç‰¹å¾å›¾çš„å¤§å°ï¼Œæ¥è§£å†³å°ç‰©ä½“åˆ†å‰²ä¸å¥½çš„é—®é¢˜ï¼ˆæ¯”å¦‚Unetä¸­ï¼Œåˆ é™¤æœ€åä¸€æ¬¡ä¸‹é‡‡æ ·ï¼‰ã€‚å¦å¤–ï¼Œä½ ä¹Ÿè¦çœ‹çœ‹å°ç‰©ä½“æ˜¯ä¸æ˜¯resizeåˆ°è®­ç»ƒæ•°æ®å°ºå¯¸çš„æ—¶å€™å·²ç»æ²¡æœ‰äº†ã€‚","user_name":"ä½œè€…å›å¤","user_name_real":"ç¼–è¾‘","uid":"2802608","ctime":1638147536,"ip_address":"","comment_id":323605,"utype":1}],"discussion_count":1,"race_medal":0,"score":"5932981525","product_id":100093301,"comment_content":"è€å¸ˆæ‚¨å¥½ï¼Œæˆ‘è‡ªå·±æœ‰å°è¯•å¤ç°deeplab v3+è¿™ä¸ªæ¯”è¾ƒä¸»æµçš„è¯­ä¹‰åˆ†å‰²ç½‘ç»œï¼Œç„¶åå‘ç°é’ˆå¯¹ä¸€äº›å°ºå¯¸è¾ƒå¤§çš„ç›®æ ‡å…¶åˆ†å‰²æ•ˆæœè¿˜æ˜¯æ¯”è¾ƒä¸é”™çš„ï¼Œä½†æ˜¯å¯¹å°çš„ç›®æ ‡åˆ†å‰²æ•ˆæœå¾ˆå·®ï¼Œç”šè‡³å¥½å¤šæ—¶å€™éƒ½åˆ†å‰²ä¸åˆ°ï¼Œè¯·é—®é’ˆå¯¹è¿™ç§å°ç›®æ ‡ï¼Œé™¤äº†åœ¨æ•°æ®é›†ä¸Šåšå¤„ç†å¤–ï¼Œè¿˜æœ‰å“ªäº›å¥½çš„å¤„ç†æˆ–è€…ä¼˜åŒ–æ–¹æ³•å‘¢ï¼Ÿ","like_count":1,"discussions":[{"author":{"id":2802608,"avatar":"https://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTK1ZkL9L7CEicI87xicpIhXAIhVdVWpJKBsD8Jpzg9iaAwFcDEhTvdRwuKItJS14mYznT2w2YQvn8QsQ/132","nickname":"æ–¹è¿œ","note":"","ucode":"248B1DE180EB4C","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":534230,"discussion_content":"helloï¼Œå°ç‰©ä½“åˆ†å‰²ä¸å¥½çš„ä¸€ä¸ªåŸå› æ˜¯åœ¨backboneçš„ç‰¹å¾æå–è¿‡ç¨‹ä¸­ï¼Œå°ç‰©ä½“çš„ä¿¡æ¯å·²ç»è¢«å¿½ç•¥äº†ã€‚\nä¸¾ä¸ªä¾‹å­ï¼Œå‡è®¾è¾“å…¥æ˜¯256x256çš„æ•°æ®ï¼Œç»è¿‡å¤šå±‚çš„ç‰¹å¾æå–åç‰¹å¾å›¾ä¾æ¬¡ä¸º128x128ï¼Œ64x64ï¼Œ32x32ï¼Œ16x16ã€‚æœ‰å¯èƒ½å°ç‰©ä½“çš„ä¿¡æ¯åœ¨32x32é‚£é‡Œå°±æ¶ˆå¤±äº†ã€‚\nä»è¿™ä¸ªè§’åº¦å‡ºå‘ï¼Œå¯ä»¥çœ‹çœ‹èƒ½ä¸èƒ½è°ƒæ•´ç½‘ç»œæœ€å°çš„ç‰¹å¾å›¾çš„å¤§å°ï¼Œæ¥è§£å†³å°ç‰©ä½“åˆ†å‰²ä¸å¥½çš„é—®é¢˜ï¼ˆæ¯”å¦‚Unetä¸­ï¼Œåˆ é™¤æœ€åä¸€æ¬¡ä¸‹é‡‡æ ·ï¼‰ã€‚å¦å¤–ï¼Œä½ ä¹Ÿè¦çœ‹çœ‹å°ç‰©ä½“æ˜¯ä¸æ˜¯resizeåˆ°è®­ç»ƒæ•°æ®å°ºå¯¸çš„æ—¶å€™å·²ç»æ²¡æœ‰äº†ã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1638147536,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":360994,"user_name":"æ±ªzZ","can_delete":false,"product_type":"c1","uid":1234757,"ip_address":"åŒ—äº¬","ucode":"8B93062A683902","user_header":"https://static001.geekbang.org/account/avatar/00/12/d7/45/d1621188.jpg","comment_is_top":false,"comment_ctime":1667097819,"is_pvip":true,"replies":[{"id":"131435","content":"ç†è®ºä¸Šï¼Œä»£ç æ˜¯è‚¯å®šèƒ½æ‰§è¡Œé€šè¿‡çš„ã€‚ä¸è¿‡æˆ‘å¯¹è§†é¢‘æ²¡æœ‰ç ”ç©¶ï¼Œä¸çŸ¥é“åˆ†å‰²æ•ˆæœå¦‚ä½•ã€‚","user_name":"ä½œè€…å›å¤","user_name_real":"ç¼–è¾‘","uid":"2802608","ctime":1667459648,"ip_address":"åŒ—äº¬","comment_id":360994,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1667097819","product_id":100093301,"comment_content":"æ–¹è€å¸ˆï¼Œè¯·æ•™ä¸€ä¸‹ï¼š<br>å¦‚æœæˆ‘ä¸æ˜¯å¯¹å›¾ç‰‡è¿›è¡Œè¯­ä¹‰åˆ†å‰²ï¼Œè€Œæ˜¯å¯¹ç±»ä¼¼è§†é¢‘ï¼Œæ¯”å¦‚ï¼ˆ400,384,288ï¼‰çš„æ•°æ®ç«‹æ–¹ä½“è¿›è¡Œè¯­ä¹‰åˆ†å‰²ï¼Œè¿˜å¯ä»¥ä½¿ç”¨unetå—ï¼Ÿå¦‚æœä½¿ç”¨çš„è¯ï¼Œè¿™ä¸ªç¤ºä¾‹é‡Œçš„é€šé“æ•°æ˜¯ä»3-&gt;512-&gt;32-&gt;1ï¼Œé‚£ä¹ˆè¿™ç§400é€šé“çš„è¯¥æ€ä¹ˆå¤„ç†ï¼Ÿ<br>è°¢è°¢ã€‚","like_count":0,"discussions":[{"author":{"id":2802608,"avatar":"https://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTK1ZkL9L7CEicI87xicpIhXAIhVdVWpJKBsD8Jpzg9iaAwFcDEhTvdRwuKItJS14mYznT2w2YQvn8QsQ/132","nickname":"æ–¹è¿œ","note":"","ucode":"248B1DE180EB4C","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":592519,"discussion_content":"ç†è®ºä¸Šï¼Œä»£ç æ˜¯è‚¯å®šèƒ½æ‰§è¡Œé€šè¿‡çš„ã€‚ä¸è¿‡æˆ‘å¯¹è§†é¢‘æ²¡æœ‰ç ”ç©¶ï¼Œä¸çŸ¥é“åˆ†å‰²æ•ˆæœå¦‚ä½•ã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1667459648,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"åŒ—äº¬"},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":357525,"user_name":"gavin","can_delete":false,"product_type":"c1","uid":1099142,"ip_address":"è¾½å®","ucode":"3D99ADC89699FE","user_header":"https://static001.geekbang.org/account/avatar/00/10/c5/86/1134c2f1.jpg","comment_is_top":false,"comment_ctime":1663334025,"is_pvip":false,"replies":[{"id":"130150","content":"æ‚¨å¥½ï¼Œå¤šåˆ†ç±»æ—¶è®©ç½‘ç»œæœ€ç»ˆè¾“å‡ºçš„ä¸ªæ•°ç­‰äºç±»åˆ«æ•°ï¼Œç„¶ååŠ softmaxå³å¯ã€‚","user_name":"ä½œè€…å›å¤","user_name_real":"ç¼–è¾‘","uid":"2802608","ctime":1663416879,"ip_address":"è¾½å®","comment_id":357525,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1663334025","product_id":100093301,"comment_content":"æ–¹è€å¸ˆï¼Œè¯·é—®ä¸€ä¸‹å¦‚æœæ˜¯å¤šåˆ†ç±»ï¼Œç‰¹å¾å›¾è¾“å‡ºè¦æ€ä¹ˆå¼„ï¼Ÿ","like_count":0,"discussions":[{"author":{"id":2802608,"avatar":"https://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTK1ZkL9L7CEicI87xicpIhXAIhVdVWpJKBsD8Jpzg9iaAwFcDEhTvdRwuKItJS14mYznT2w2YQvn8QsQ/132","nickname":"æ–¹è¿œ","note":"","ucode":"248B1DE180EB4C","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":587976,"discussion_content":"æ‚¨å¥½ï¼Œå¤šåˆ†ç±»æ—¶è®©ç½‘ç»œæœ€ç»ˆè¾“å‡ºçš„ä¸ªæ•°ç­‰äºç±»åˆ«æ•°ï¼Œç„¶ååŠ softmaxå³å¯ã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1663416879,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"è¾½å®"},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":355255,"user_name":"John(æ˜“ç­‹)","can_delete":false,"product_type":"c1","uid":1180202,"ip_address":"åŒ—äº¬","ucode":"BB4E58DD4B8F15","user_header":"https://static001.geekbang.org/account/avatar/00/12/02/2a/90e38b94.jpg","comment_is_top":false,"comment_ctime":1661229627,"is_pvip":true,"replies":[{"id":"129286","content":"hiï¼Œä½ å¥½ã€‚æ„Ÿè°¢ç•™è¨€ã€‚<br>è¿™ä¸ªå°ºå¯¸æ˜¯å–å†³äºç½‘ç»œçš„è®¾è®¡ã€‚<br>256x256çš„åˆ†å‰²ç»“æœæ˜¯å¯ä»¥resizeå›1024x640çš„ã€‚<br>å½“ç„¶ï¼Œå¦‚æœä½ è®¾è®¡çš„ç½‘ç»œçš„è¾“å…¥è¾“å‡ºæ”¯æŒ1024x640çš„ç­‰æ¯”ä¾‹ç¼©æ”¾ï¼Œä¹Ÿæ˜¯å¯ä»¥çš„ã€‚","user_name":"ä½œè€…å›å¤","user_name_real":"ç¼–è¾‘","uid":"2802608","ctime":1661319334,"ip_address":"åŒ—äº¬","comment_id":355255,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1661229627","product_id":100093301,"comment_content":"predict_single.py ä»£ç æ”¹äº†ä¸€ä¸‹æ–‡ä»¶çš„ç›¸å¯¹è·¯å¾„å¯ä»¥è·‘é€šï¼Œå‘ç°output.jpg å¤§å°ä¸º256x256. åŸå›¾å¾®1024x640. è¯·æ•™æ–¹è€å¸ˆï¼Œä¸ºå•¥è¯­ä¹‰åˆ†å‰²å‡ºæ¥çš„å›¾ç‰‡ä¸æ˜¯åŸå§‹å›¾ç‰‡çš„ç­‰æ¯”ç¼©å°å‘¢ï¼Ÿ è°¢è°¢<br>```<br>import torch<br>import numpy as np<br><br>from PIL import Image<br><br>img_size = (256, 256)<br>unet = torch.load(&#39;.&#47;ckpts&#47;unet_epoch_51.pth&#39;)<br><br>unet.eval()<br><br><br>im = np.asarray(Image.open(&#39;.&#47;data&#47;JPEGImages&#47;6.jpg&#39;).resize(img_size))<br><br>im = im &#47; 255.<br>im = im.transpose(2, 0, 1)<br>im = im[np.newaxis, :, :]<br>im = im.astype(&#39;float32&#39;)<br>output = unet(torch.from_numpy(im)).detach().numpy()<br><br>output = np.squeeze(output)<br>output = np.where(output&gt;0.5, 150, 0).astype(np.uint8)<br>print(output.shape, type(output))<br>im = Image.fromarray(output)<br>im.save(&#39;.&#47;output.jpg&#39;)<br>```","like_count":0,"discussions":[{"author":{"id":2802608,"avatar":"https://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTK1ZkL9L7CEicI87xicpIhXAIhVdVWpJKBsD8Jpzg9iaAwFcDEhTvdRwuKItJS14mYznT2w2YQvn8QsQ/132","nickname":"æ–¹è¿œ","note":"","ucode":"248B1DE180EB4C","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":585062,"discussion_content":"hiï¼Œä½ å¥½ã€‚æ„Ÿè°¢ç•™è¨€ã€‚\nè¿™ä¸ªå°ºå¯¸æ˜¯å–å†³äºç½‘ç»œçš„è®¾è®¡ã€‚\n256x256çš„åˆ†å‰²ç»“æœæ˜¯å¯ä»¥resizeå›1024x640çš„ã€‚\nå½“ç„¶ï¼Œå¦‚æœä½ è®¾è®¡çš„ç½‘ç»œçš„è¾“å…¥è¾“å‡ºæ”¯æŒ1024x640çš„ç­‰æ¯”ä¾‹ç¼©æ”¾ï¼Œä¹Ÿæ˜¯å¯ä»¥çš„ã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1661319334,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"åŒ—äº¬"},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":350348,"user_name":"ä¸‡åŒ–8af10b","can_delete":false,"product_type":"c1","uid":1916746,"ip_address":"","ucode":"A5A212C8AE843E","user_header":"https://static001.geekbang.org/account/avatar/00/1d/3f/4a/b1c9e5e3.jpg","comment_is_top":false,"comment_ctime":1656839600,"is_pvip":true,"replies":[{"id":"127493","content":"Hi, ä½ å¥½ï¼Œæ„Ÿè°¢ä½ çš„ç•™è¨€ã€‚<br>çœ‹èµ·æ¥æ˜¯ä½ è¦è°ƒç”¨ä½ è®­ç»ƒäº†51ä¸ªepochçš„æ¨¡å‹ï¼Œå¯ä»¥çœ‹çœ‹ä½ ä¿å­˜æˆ–è€…è°ƒç”¨çš„è·¯å¾„å†™æ²¡å†™é”™ã€‚","user_name":"ä½œè€…å›å¤","user_name_real":"ç¼–è¾‘","uid":"2802608","ctime":1656982070,"ip_address":"","comment_id":350348,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1656839600","product_id":100093301,"comment_content":"è¯·é—®&#47;weights&#47;unet_epoch_51.Pthæ‰¾ä¸åˆ°ï¼Œè°¢è°¢","like_count":0,"discussions":[{"author":{"id":2802608,"avatar":"https://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTK1ZkL9L7CEicI87xicpIhXAIhVdVWpJKBsD8Jpzg9iaAwFcDEhTvdRwuKItJS14mYznT2w2YQvn8QsQ/132","nickname":"æ–¹è¿œ","note":"","ucode":"248B1DE180EB4C","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":578701,"discussion_content":"Hi, ä½ å¥½ï¼Œæ„Ÿè°¢ä½ çš„ç•™è¨€ã€‚\nçœ‹èµ·æ¥æ˜¯ä½ è¦è°ƒç”¨ä½ è®­ç»ƒäº†51ä¸ªepochçš„æ¨¡å‹ï¼Œå¯ä»¥çœ‹çœ‹ä½ ä¿å­˜æˆ–è€…è°ƒç”¨çš„è·¯å¾„å†™æ²¡å†™é”™ã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1656982071,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":347260,"user_name":"zhangting","can_delete":false,"product_type":"c1","uid":2950861,"ip_address":"","ucode":"565BB6CEE694E0","user_header":"https://thirdwx.qlogo.cn/mmopen/vi_32/ajNVdqHZLLDm5eHbw1fuicJiaXercgBI48O0Idt2mHUElmZyBM4o119NkndU1SNpsv8rZzKFibj8z1FibFAdNEO3zw/132","comment_is_top":false,"comment_ctime":1653881453,"is_pvip":false,"replies":[{"id":"126647","content":"æ‚¨å¥½ï¼Œå·²ä¸Šä¼ è‡³github^^","user_name":"ä½œè€…å›å¤","user_name_real":"ç¼–è¾‘","uid":"2802608","ctime":1653958979,"ip_address":"","comment_id":347260,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1653881453","product_id":100093301,"comment_content":"è€å¸ˆï¼Œè¿™ä¸ªçŒ«çš„æ•°æ®é›†å¯ä»¥åˆ†äº«ä¸€ä¸‹ä¹ˆï¼Ÿ","like_count":0,"discussions":[{"author":{"id":2802608,"avatar":"https://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTK1ZkL9L7CEicI87xicpIhXAIhVdVWpJKBsD8Jpzg9iaAwFcDEhTvdRwuKItJS14mYznT2w2YQvn8QsQ/132","nickname":"æ–¹è¿œ","note":"","ucode":"248B1DE180EB4C","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":574288,"discussion_content":"æ‚¨å¥½ï¼Œå·²ä¸Šä¼ è‡³github^^","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1653958979,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":341050,"user_name":"Geek_709f77","can_delete":false,"product_type":"c1","uid":2843530,"ip_address":"","ucode":"25F56EFCD3795F","user_header":"","comment_is_top":false,"comment_ctime":1649314317,"is_pvip":true,"replies":[{"id":"124686","content":"å¯ä»¥æ ¹æ®è‡ªå·±æ“ä½œç³»ç»Ÿä»¥åŠå¼€å‘ideï¼Œå‚ç…§Githubä¸Šçš„ä¸‹è½½æ–¹å¼å†è¯•è¯•ï¼Œæ­£å¸¸æ¥è¯´Githubä¸Šæä¾›çš„åº”è¯¥æ²¡æœ‰é—®é¢˜ï½","user_name":"ç¼–è¾‘å›å¤","user_name_real":"ç¼–è¾‘","uid":"1501385","ctime":1649331697,"ip_address":"","comment_id":341050,"utype":2}],"discussion_count":1,"race_medal":0,"score":"1649314317","product_id":100093301,"comment_content":"lebelmeé‚£ä¸ªgithubä¸Šçš„zipåŒ…ä¸‹è½½åæ€ä¹ˆè§£å‹çš„æ—¶å€™æŠ¥æ–‡ä»¶å·²æŸåå•Šï¼Ÿ","like_count":0,"discussions":[{"author":{"id":1501385,"avatar":"https://static001.geekbang.org/account/avatar/00/16/e8/c9/59bcd490.jpg","nickname":"å¬æ°´çš„æ¹–","note":"","ucode":"B1759F90165D81","race_medal":0,"user_type":8,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":560445,"discussion_content":"å¯ä»¥æ ¹æ®è‡ªå·±æ“ä½œç³»ç»Ÿä»¥åŠå¼€å‘ideï¼Œå‚ç…§Githubä¸Šçš„ä¸‹è½½æ–¹å¼å†è¯•è¯•ï¼Œæ­£å¸¸æ¥è¯´Githubä¸Šæä¾›çš„åº”è¯¥æ²¡æœ‰é—®é¢˜ï½","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1649331697,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":8}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":340299,"user_name":"Cougar","can_delete":false,"product_type":"c1","uid":2952163,"ip_address":"","ucode":"C8507485ADF278","user_header":"https://static001.geekbang.org/account/avatar/00/2d/0b/e3/4b9cac41.jpg","comment_is_top":false,"comment_ctime":1648731477,"is_pvip":false,"replies":[{"id":"124463","content":"ä½ å¥½ï¼ŒCougarï¼Œæ„Ÿè°¢ç•™è¨€ã€‚<br>æ•°æ®æ ‡å‡†åŒ–çš„ä¸€ç§æ–¹å¼ï¼Œå‡å‡å€¼å†é™¤æ ‡å‡†å·®ä¹Ÿå¯ä»¥ã€‚","user_name":"ä½œè€…å›å¤","user_name_real":"ç¼–è¾‘","uid":"2802608","ctime":1648792142,"ip_address":"","comment_id":340299,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1648731477","product_id":100093301,"comment_content":"self.image_slices.append(im &#47; 255.)<br>è¯·é—®è¿™é‡Œä¸ºä»€ä¹ˆè¦é™¤ä»¥ä¸€ä¸ª255å‘¢","like_count":0,"discussions":[{"author":{"id":2802608,"avatar":"https://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTK1ZkL9L7CEicI87xicpIhXAIhVdVWpJKBsD8Jpzg9iaAwFcDEhTvdRwuKItJS14mYznT2w2YQvn8QsQ/132","nickname":"æ–¹è¿œ","note":"","ucode":"248B1DE180EB4C","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":559480,"discussion_content":"ä½ å¥½ï¼ŒCougarï¼Œæ„Ÿè°¢ç•™è¨€ã€‚\næ•°æ®æ ‡å‡†åŒ–çš„ä¸€ç§æ–¹å¼ï¼Œå‡å‡å€¼å†é™¤æ ‡å‡†å·®ä¹Ÿå¯ä»¥ã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1648792142,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":330076,"user_name":"dndidoflbup","can_delete":false,"product_type":"c1","uid":1201908,"ip_address":"","ucode":"69B726F947065F","user_header":"https://static001.geekbang.org/account/avatar/00/12/56/f4/6c57f148.jpg","comment_is_top":false,"comment_ctime":1641788059,"is_pvip":false,"replies":[{"id":"120262","content":"helloï¼Œdndidoflbupï¼Œæ„Ÿè°¢ä½ çš„ç•™è¨€ã€‚<br>å› ä¸ºç»å†äº†å››æ¬¡ä¸‹é‡‡æ ·ã€‚æ‰€ä»¥å®½é«˜å¿…é¡»æ˜¯èƒ½è¢«16æ•´é™¤çš„ã€‚","user_name":"ä½œè€…å›å¤","user_name_real":"ç¼–è¾‘","uid":"2802608","ctime":1641802468,"ip_address":"","comment_id":330076,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1641788059","product_id":100093301,"comment_content":"è€å¸ˆå¥½ï¼Œå¯¹äºè¾“å…¥å›¾ç‰‡çš„å°ºå¯¸æœ‰è¦æ±‚ä¹ˆï¼Œæˆ‘è‡ªå·±ç”¨900*900çš„å­¦ä¹ ï¼ŒæŠ¥é”™å¦‚ä¸‹ï¼š<br><br>conv_decoder_3_2 = torch.cat((conv_decoder_3_1, conv_encoder_3_1), dim=1)<br>RuntimeError: Sizes of tensors must match except in dimension 1. Expected size 224 but got size 225 for tensor number 1 in the list.","like_count":0,"discussions":[{"author":{"id":2802608,"avatar":"https://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTK1ZkL9L7CEicI87xicpIhXAIhVdVWpJKBsD8Jpzg9iaAwFcDEhTvdRwuKItJS14mYznT2w2YQvn8QsQ/132","nickname":"æ–¹è¿œ","note":"","ucode":"248B1DE180EB4C","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":545017,"discussion_content":"helloï¼Œdndidoflbupï¼Œæ„Ÿè°¢ä½ çš„ç•™è¨€ã€‚\nå› ä¸ºç»å†äº†å››æ¬¡ä¸‹é‡‡æ ·ã€‚æ‰€ä»¥å®½é«˜å¿…é¡»æ˜¯èƒ½è¢«16æ•´é™¤çš„ã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1641802468,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":327008,"user_name":"Geek_a95f0e","can_delete":false,"product_type":"c1","uid":2824511,"ip_address":"","ucode":"C0B7418FD1D2B5","user_header":"","comment_is_top":false,"comment_ctime":1639833149,"is_pvip":false,"replies":[{"id":"118978","content":"ä½ å¥½ï¼Œèƒ½æŠŠä½ çš„ä»£ç ç»™æˆ‘çœ‹çœ‹å˜›ï¼Ÿ","user_name":"ä½œè€…å›å¤","user_name_real":"ç¼–è¾‘","uid":"2802608","ctime":1639960941,"ip_address":"","comment_id":327008,"utype":1}],"discussion_count":2,"race_medal":0,"score":"1639833149","product_id":100093301,"comment_content":"æ–¹è€å¸ˆï¼Œç»è¿‡è¯•éªŒï¼Œæœ¬è¯¾è‡ªå®šä¹‰ç±»çš„datasetï¼Œåœ¨å®ä¾‹åŒ–æ—¶ï¼Œtransformå‚æ•°æ˜¯ä¸èµ·ä½œç”¨çš„ï¼Œè¯·é—®è¿™æ˜¯ä»€ä¹ˆåŸå› å‘¢ï¼Ÿå¦‚æœè¦è®©è‡ªå®šä¹‰ç±»çš„datasetä¹Ÿèƒ½å¯¹transformå‚æ•°èµ·ä½œç”¨ï¼Œè¯¥æ€ä¹ˆæ“ä½œå‘¢ï¼Ÿ","like_count":0,"discussions":[{"author":{"id":2802608,"avatar":"https://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTK1ZkL9L7CEicI87xicpIhXAIhVdVWpJKBsD8Jpzg9iaAwFcDEhTvdRwuKItJS14mYznT2w2YQvn8QsQ/132","nickname":"æ–¹è¿œ","note":"","ucode":"248B1DE180EB4C","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":540091,"discussion_content":"ä½ å¥½ï¼Œèƒ½æŠŠä½ çš„ä»£ç ç»™æˆ‘çœ‹çœ‹å˜›ï¼Ÿ","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1639960941,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":2824511,"avatar":"","nickname":"Geek_a95f0e","note":"","ucode":"C0B7418FD1D2B5","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":540815,"discussion_content":"è‡ªå®šä¹‰ç±»CatSegmentationDatasetçš„ä»£ç å’Œè¯¾ç¨‹ä¸€è‡´ï¼Œæµ‹è¯•ä»£ç å¦‚ä¸‹ï¼š\n\nfrom torchvision import transforms\ndataset_ToTensor=CatSegmentationDataset(&#39;./data/train/duck_output&#39;,\n                              transform=transforms.ToTensor())\n\ntensor_iter=iter(dataset_ToTensor)\nfor item in next(dataset_iter):\n    print(&#39;the type of item from dataset is: %s&#39;%type(item[0]))\n#è¾“å‡º\nthe type of item from dataset is: &lt;class &#39;numpy.ndarray&#39;&gt;\nthe type of item from dataset is: &lt;class &#39;numpy.ndarray&#39;&gt;\n\nä»ä»¥ä¸Šçœ‹æ¥ï¼Œtransforms.ToTensor()ä¼¼ä¹æ²¡æœ‰èµ·ä½œç”¨","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1640175976,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":326085,"user_name":"æé›„","can_delete":false,"product_type":"c1","uid":2805175,"ip_address":"","ucode":"ABC36CFEEEE41B","user_header":"https://static001.geekbang.org/account/avatar/00/2a/cd/b7/6efa2c68.jpg","comment_is_top":false,"comment_ctime":1639370414,"is_pvip":false,"replies":[{"id":"118290","content":"hiï¼Œä½ å¥½ï¼Œæé›„ã€‚<br>1ï¼‰Unetæ”¶æ•›é€Ÿåº¦å¾ˆå¿«ï¼Œä¸ä½¿ç”¨é¢„è®­ç»ƒæ¨¡å‹æ•ˆæœä¹Ÿä¸é”™ã€‚æˆ‘åœ¨æˆ‘çš„çœŸå®é¡¹ç›®ä¸­å°±æ²¡æœ‰ä½¿ç”¨é¢„è®­ç»ƒæ¨¡å‹ã€‚<br>2ï¼‰æ•°æ®é‡è‚¯å®šå¤šå¤šç›Šå–„äº†ã€‚<br>3) æˆ‘ç”¨çš„æ˜¯LabelImgï¼ˆhttps:&#47;&#47;github.com&#47;tzutalin&#47;labelImgï¼‰æ ‡è®°ç›®æ ‡æ£€æµ‹çš„æ•°æ®ï¼Œä¸è¿‡labelmeå¥½åƒä¹Ÿå¯ä»¥ï¼Œä½ å¯ä»¥ç ”ç©¶ç ”ç©¶^^ã€‚","user_name":"ä½œè€…å›å¤","user_name_real":"ä½œè€…","uid":"2802608","ctime":1639381891,"ip_address":"","comment_id":326085,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1639370414","product_id":100093301,"comment_content":"è€å¸ˆæ‚¨å¥½ï¼Œé¦–å…ˆæ„Ÿè°¢è€å¸ˆçš„ç®€æ´è®²è¿°ï¼Œä½†æˆ‘ä»æœ‰å‡ ä¸ªé—®é¢˜æƒ³è¯·æ•™ï¼š<br>ï¼ˆ1ï¼‰å…³äºä½¿ç”¨Unetèƒ½å¦ä½¿ç”¨é¢„è®­ç»ƒæ¨¡å‹ï¼Ÿæˆ–è€…è¯´æ˜¯å¦æœ‰é¢„è®­ç»ƒæ¨¡å‹ï¼Ÿ<br>ï¼ˆ2ï¼‰Unetçš„è®­ç»ƒæ•°æ®é‡æœ€å°‘å¤§è‡´ä¸ºå¤šå°‘å‘¢ï¼Ÿèƒ½å¦ç»™ä¸ªå…·ä½“çš„å‚è€ƒï¼Ÿ<br>ï¼ˆ3ï¼‰è€å¸ˆèƒ½å¦æ¨èä¸€ä¸ªç›®æ ‡æ£€æµ‹æ•°æ®æ ‡æ³¨å·¥å…·å‘¢ï¼Ÿæˆ‘æœ€è¿‘è¦æ ‡æ³¨ä¸€ä¸ªè‡ªå·±çš„ç›®æ ‡æ£€æµ‹æ•°æ®é›†ï¼Ÿ<br>æ„Ÿè°¢è€å¸ˆï¼ï¼ï¼","like_count":0,"discussions":[{"author":{"id":2802608,"avatar":"https://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTK1ZkL9L7CEicI87xicpIhXAIhVdVWpJKBsD8Jpzg9iaAwFcDEhTvdRwuKItJS14mYznT2w2YQvn8QsQ/132","nickname":"æ–¹è¿œ","note":"","ucode":"248B1DE180EB4C","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":538249,"discussion_content":"hiï¼Œä½ å¥½ï¼Œæé›„ã€‚\n1ï¼‰Unetæ”¶æ•›é€Ÿåº¦å¾ˆå¿«ï¼Œä¸ä½¿ç”¨é¢„è®­ç»ƒæ¨¡å‹æ•ˆæœä¹Ÿä¸é”™ã€‚æˆ‘åœ¨æˆ‘çš„çœŸå®é¡¹ç›®ä¸­å°±æ²¡æœ‰ä½¿ç”¨é¢„è®­ç»ƒæ¨¡å‹ã€‚\n2ï¼‰æ•°æ®é‡è‚¯å®šå¤šå¤šç›Šå–„äº†ã€‚\n3) æˆ‘ç”¨çš„æ˜¯LabelImgï¼ˆhttps://github.com/tzutalin/labelImgï¼‰æ ‡è®°ç›®æ ‡æ£€æµ‹çš„æ•°æ®ï¼Œä¸è¿‡labelmeå¥½åƒä¹Ÿå¯ä»¥ï¼Œä½ å¯ä»¥ç ”ç©¶ç ”ç©¶^^ã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1639381891,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":323734,"user_name":"zhaobk","can_delete":false,"product_type":"c1","uid":1291596,"ip_address":"","ucode":"30BEE12D2CF020","user_header":"https://static001.geekbang.org/account/avatar/00/13/b5/4c/6b9528f8.jpg","comment_is_top":false,"comment_ctime":1638147218,"is_pvip":false,"replies":[{"id":"117508","content":"helloï¼Œä½ å¥½ã€‚<br><br>ä½ çš„ç–‘é—®æ˜¯ä¸ºä»€ä¹ˆè¦å•ç‹¬å†™ä¸€ä¸ªBlockç±»å—ï¼Ÿ<br>ä¸å•ç‹¬ä¸€å†™ä¹Ÿå¯ä»¥ï¼Œå°±æ˜¯ä¸ªäººä¹ æƒ¯ã€‚<br><br>å¦‚æœç–‘é—®æ˜¯ä¸ºä»€ä¹ˆclass UNetä¸­æ˜¯åƒæ–‡ä¸­é‚£æ ·å †å å·ç§¯å±‚çš„è¯ã€‚<br>é‚£ä¹ˆå›ç­”æ˜¯æ ¹æ®è®ºæ–‡æ¥æ­å»ºçš„ã€‚<br><br>å¦‚æœéœ€è¦å®ç°å…¶ä»–ç®—æ³•ï¼Œå¯ä»¥ç›´æ¥ä½¿ç”¨torchvisionä¸­å°è£…å¥½çš„æ¨¡å‹ï¼Œæˆ–è€…æ‰¾æ‰¾æœ‰æ²¡æœ‰å·²ç»å®ç°å¥½çš„å¼€æºä»£ç ï¼Œç„¶ååŸºäºä»–ä»¬çš„ä»£ç åšæ”¹è¿›ã€‚<br>å®é™…ä¸Šï¼Œå¾ˆå°‘æœ‰é¡¹ç›®æ˜¯ä»0å¼€å§‹ä¸€ç‚¹ç‚¹å†™ä»£ç çš„ã€‚","user_name":"ä½œè€…å›å¤","user_name_real":"ç¼–è¾‘","uid":"2802608","ctime":1638150386,"ip_address":"","comment_id":323734,"utype":1}],"discussion_count":2,"race_medal":0,"score":"1638147218","product_id":100093301,"comment_content":"è€å¸ˆæ‚¨å¥½ã€‚å…³äºclass Block(nn.Module): class UNet(nn.Module):è¿™ä¸¤ä¸ªç±»ï¼Œæˆ‘æœ‰ç‚¹ä¸æ˜ç™½ï¼Œä¸ºä»€ä¹ˆè¦è¿™ä¹ˆå®ç°ï¼Ÿæ˜¯æ ¹æ®è®ºæ–‡æ¥æ­å»ºçš„å—ï¼Ÿå¦‚æœéœ€è¦å®ç°å…¶ä»–ç®—æ³•ï¼Œä¹Ÿæ˜¯è¦æ ¹æ®ç›¸å…³è®ºæ–‡æ¥è‡ªå·±æ­å»ºè¿™ç§ç»“æ„å—ï¼Ÿ","like_count":0,"discussions":[{"author":{"id":2802608,"avatar":"https://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTK1ZkL9L7CEicI87xicpIhXAIhVdVWpJKBsD8Jpzg9iaAwFcDEhTvdRwuKItJS14mYznT2w2YQvn8QsQ/132","nickname":"æ–¹è¿œ","note":"","ucode":"248B1DE180EB4C","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":534252,"discussion_content":"helloï¼Œä½ å¥½ã€‚\n\nä½ çš„ç–‘é—®æ˜¯ä¸ºä»€ä¹ˆè¦å•ç‹¬å†™ä¸€ä¸ªBlockç±»å—ï¼Ÿ\nä¸å•ç‹¬ä¸€å†™ä¹Ÿå¯ä»¥ï¼Œå°±æ˜¯ä¸ªäººä¹ æƒ¯ã€‚\n\nå¦‚æœç–‘é—®æ˜¯ä¸ºä»€ä¹ˆclass UNetä¸­æ˜¯åƒæ–‡ä¸­é‚£æ ·å †å å·ç§¯å±‚çš„è¯ã€‚\né‚£ä¹ˆå›ç­”æ˜¯æ ¹æ®è®ºæ–‡æ¥æ­å»ºçš„ã€‚\n\nå¦‚æœéœ€è¦å®ç°å…¶ä»–ç®—æ³•ï¼Œå¯ä»¥ç›´æ¥ä½¿ç”¨torchvisionä¸­å°è£…å¥½çš„æ¨¡å‹ï¼Œæˆ–è€…æ‰¾æ‰¾æœ‰æ²¡æœ‰å·²ç»å®ç°å¥½çš„å¼€æºä»£ç ï¼Œç„¶ååŸºäºä»–ä»¬çš„ä»£ç åšæ”¹è¿›ã€‚\nå®é™…ä¸Šï¼Œå¾ˆå°‘æœ‰é¡¹ç›®æ˜¯ä»0å¼€å§‹ä¸€ç‚¹ç‚¹å†™ä»£ç çš„ã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1638150386,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1291596,"avatar":"https://static001.geekbang.org/account/avatar/00/13/b5/4c/6b9528f8.jpg","nickname":"zhaobk","note":"","ucode":"30BEE12D2CF020","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":534266,"discussion_content":"è°¢è°¢è€å¸ˆã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1638152429,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":323435,"user_name":"å®˜","can_delete":false,"product_type":"c1","uid":1696727,"ip_address":"","ucode":"E3FF6D04B9846B","user_header":"https://static001.geekbang.org/account/avatar/00/19/e3/d7/d7b3505f.jpg","comment_is_top":false,"comment_ctime":1637903159,"is_pvip":false,"replies":[{"id":"117365","content":"ä¹Ÿå¯ä»¥ï¼Œå¾—æ”¹è¿›ä¸€ä¸‹ã€‚ä¸è¿‡ä»–å’Œdice losså¾ˆåƒã€‚","user_name":"ä½œè€…å›å¤","user_name_real":"ç¼–è¾‘","uid":"2802608","ctime":1637929293,"ip_address":"","comment_id":323435,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1637903159","product_id":100093301,"comment_content":"æ„Ÿè§‰mIoUä¹Ÿå¯ä»¥ç”¨åœ¨è¯­ä¹‰åˆ†å‰²æ¨¡å‹é‡Œï¼Œä¸çŸ¥é“æœ‰æ²¡æœ‰è¿™ç§å¯èƒ½","like_count":0,"discussions":[{"author":{"id":2802608,"avatar":"https://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTK1ZkL9L7CEicI87xicpIhXAIhVdVWpJKBsD8Jpzg9iaAwFcDEhTvdRwuKItJS14mYznT2w2YQvn8QsQ/132","nickname":"æ–¹è¿œ","note":"","ucode":"248B1DE180EB4C","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":533667,"discussion_content":"ä¹Ÿå¯ä»¥ï¼Œå¾—æ”¹è¿›ä¸€ä¸‹ã€‚ä¸è¿‡ä»–å’Œdice losså¾ˆåƒã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1637929293,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":323431,"user_name":"åé‡Œç§‹æ³¢ä¸èµ·é›¨","can_delete":false,"product_type":"c1","uid":1239581,"ip_address":"","ucode":"8440019270D50F","user_header":"https://static001.geekbang.org/account/avatar/00/12/ea/1d/1954451e.jpg","comment_is_top":false,"comment_ctime":1637901038,"is_pvip":false,"replies":[{"id":"117364","content":"è°¢è°¢è®¤å¯ï¼ŒåŠ æ²¹ğŸ˜Š","user_name":"ä½œè€…å›å¤","user_name_real":"ç¼–è¾‘","uid":"2802608","ctime":1637929203,"ip_address":"","comment_id":323431,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1637901038","product_id":100093301,"comment_content":"æ”¶è·é¢‡ä¸°","like_count":0,"discussions":[{"author":{"id":2802608,"avatar":"https://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTK1ZkL9L7CEicI87xicpIhXAIhVdVWpJKBsD8Jpzg9iaAwFcDEhTvdRwuKItJS14mYznT2w2YQvn8QsQ/132","nickname":"æ–¹è¿œ","note":"","ucode":"248B1DE180EB4C","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":533666,"discussion_content":"è°¢è°¢è®¤å¯ï¼ŒåŠ æ²¹ğŸ˜Š","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1637929203,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":323377,"user_name":"hbuelgr","can_delete":false,"product_type":"c1","uid":1723473,"ip_address":"","ucode":"D56AC31048AB49","user_header":"http://thirdwx.qlogo.cn/mmopen/vi_32/DYAIOgq83epJHlrZ1pcs2sxHpxW6EaDmUq8sMD85vm3hskWVn2LmlcUI84tARViam4vAuS0uVibpFq1uRAABff6g/132","comment_is_top":false,"comment_ctime":1637881804,"is_pvip":false,"replies":[{"id":"117363","content":"æ„Ÿè°¢è®¤å¯^^ï¼Œå¸Œæœ›ä¸ä½ ä¸€èµ·å­¦ä¹ è¿›æ­¥ã€‚","user_name":"ä½œè€…å›å¤","user_name_real":"ç¼–è¾‘","uid":"2802608","ctime":1637929185,"ip_address":"","comment_id":323377,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1637881804","product_id":100093301,"comment_content":"æ”¶è·å¾ˆå¤šï¼Œæ¯å¤©å¬å¬ã€‚","like_count":0,"discussions":[{"author":{"id":2802608,"avatar":"https://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTK1ZkL9L7CEicI87xicpIhXAIhVdVWpJKBsD8Jpzg9iaAwFcDEhTvdRwuKItJS14mYznT2w2YQvn8QsQ/132","nickname":"æ–¹è¿œ","note":"","ucode":"248B1DE180EB4C","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":533664,"discussion_content":"æ„Ÿè°¢è®¤å¯^^ï¼Œå¸Œæœ›ä¸ä½ ä¸€èµ·å­¦ä¹ è¿›æ­¥ã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1637929185,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]}]}