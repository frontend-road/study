{"id":429048,"title":"06 | Torchvision（上）：数据读取，训练开始的第一步","content":"<p>你好，我是方远。</p><p>今天起我们进入模型训练篇的学习。如果将模型看作一辆汽车，那么它的开发过程就可以看作是一套完整的生产流程，环环相扣、缺一不可。这些环节包括<strong>数据的读取、网络的设计、优化方法与损失函数的选择以及一些辅助的工具等</strong>。未来你将尝试构建自己的豪华汽车，或者站在巨人的肩膀上对前人的作品进行优化。</p><p>试想一下，如果你对这些基础环节所使用的方法都不清楚，你还能很好地进行下去吗？所以通过这个模块，我们的目标是先把基础打好。通过这模块的学习，对于PyTorch都为我们提供了哪些丰富的API，你就会了然于胸了。</p><p>Torchvision 是一个和 PyTorch 配合使用的 Python 包，包含很多图像处理的工具。我们先从数据处理入手，开始PyTorch的学习的第一步。这节课我们会先介绍Torchvision的常用数据集及其读取方法，在后面的两节课里，我再带你了解常用的图像处理方法与Torchvision其它有趣的功能。</p><h2>PyTorch中的数据读取</h2><p>训练开始的第一步，首先就是数据读取。PyTorch为我们提供了一种十分方便的数据读取机制，即使用Dataset类与DataLoader类的组合，来得到数据迭代器。在训练或预测时，数据迭代器能够输出每一批次所需的数据，并且对数据进行相应的预处理与数据增强操作。</p><!-- [[[read_end]]] --><p>下面我们分别来看下Dataset类与DataLoader类。</p><h3>Dataset类</h3><p>PyTorch中的Dataset类是一个抽象类，它可以用来表示数据集。我们通过继承Dataset类来自定义数据集的格式、大小和其它属性，后面就可以供DataLoader类直接使用。</p><p>其实这就表示，无论使用自定义的数据集，还是官方为我们封装好的数据集，其本质都是继承了Dataset类。而在继承Dataset类时，至少需要重写以下几个方法：</p><ul>\n<li>__init__()：构造函数，可自定义数据读取方法以及进行数据预处理；</li>\n<li>__len__()：返回数据集大小；</li>\n<li>__getitem__()：索引数据集中的某一个数据。</li>\n</ul><p>光看原理不容易理解，下面我们来编写一个简单的例子，看下如何使用Dataset类定义一个Tensor类型的数据集。</p><pre><code class=\"language-python\">import torch\nfrom torch.utils.data import Dataset\n\nclass MyDataset(Dataset):\n&nbsp; &nbsp; # 构造函数\n&nbsp; &nbsp; def __init__(self, data_tensor, target_tensor):\n&nbsp; &nbsp; &nbsp; &nbsp; self.data_tensor = data_tensor\n&nbsp; &nbsp; &nbsp; &nbsp; self.target_tensor = target_tensor\n&nbsp; &nbsp; # 返回数据集大小\n&nbsp; &nbsp; def __len__(self):\n&nbsp; &nbsp; &nbsp; &nbsp; return self.data_tensor.size(0)\n&nbsp; &nbsp; # 返回索引的数据与标签\n&nbsp; &nbsp; def __getitem__(self, index):\n&nbsp; &nbsp; &nbsp; &nbsp; return self.data_tensor[index], self.target_tensor[index]\n</code></pre><p>结合代码可以看到，我们定义了一个名字为MyDataset的数据集，在构造函数中，传入Tensor类型的数据与标签；在__len__函数中，直接返回Tensor的大小；在__getitem__函数中返回索引的数据与标签。</p><p>下面，我们来看一下如何调用刚才定义的数据集。首先随机生成一个10*3维的数据Tensor，然后生成10维的标签Tensor，与数据Tensor相对应。利用这两个Tensor，生成一个MyDataset的对象。查看数据集的大小可以直接用len()函数，索引调用数据可以直接使用下标。</p><pre><code class=\"language-python\"># 生成数据\ndata_tensor = torch.randn(10, 3)\ntarget_tensor = torch.randint(2, (10,)) # 标签是0或1\n\n# 将数据封装成Dataset\nmy_dataset = MyDataset(data_tensor, target_tensor)\n\n# 查看数据集大小\nprint('Dataset size:', len(my_dataset))\n'''\n输出：\nDataset size: 10\n'''\n\n# 使用索引调用数据\nprint('tensor_data[0]: ', my_dataset[0])\n'''\n输出:\ntensor_data[0]:  (tensor([ 0.4931, -0.0697,  0.4171]), tensor(0))\n'''\n</code></pre><h3>DataLoader类</h3><p>在实际项目中，如果数据量很大，考虑到内存有限、I/O速度等问题，在训练过程中不可能一次性的将所有数据全部加载到内存中，也不能只用一个进程去加载，所以就需要多进程、迭代加载，而DataLoader就是基于这些需要被设计出来的。</p><p>DataLoader是一个迭代器，最基本的使用方法就是传入一个Dataset对象，它会根据参数 batch_size的值生成一个batch的数据，节省内存的同时，它还可以实现多进程、数据打乱等处理。</p><p>DataLoader类的调用方式如下：</p><pre><code class=\"language-python\">from torch.utils.data import DataLoader\ntensor_dataloader = DataLoader(dataset=my_dataset, # 传入的数据集, 必须参数\n&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;batch_size=2,&nbsp; &nbsp; &nbsp;  # 输出的batch大小\n&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;shuffle=True,&nbsp; &nbsp; &nbsp;  # 数据是否打乱\n&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;num_workers=0)&nbsp; &nbsp;   # 进程数, 0表示只有主进程\n\n# 以循环形式输出\nfor data, target in tensor_dataloader:&nbsp;\n&nbsp; &nbsp; print(data, target)\n'''\n输出:\ntensor([[-0.1781, -1.1019, -0.1507],\n        [-0.6170,  0.2366,  0.1006]]) tensor([0, 0])\ntensor([[ 0.9451, -0.4923, -1.8178],\n        [-0.4046, -0.5436, -1.7911]]) tensor([0, 0])\ntensor([[-0.4561, -1.2480, -0.3051],\n        [-0.9738,  0.9465,  0.4812]]) tensor([1, 0])\ntensor([[ 0.0260,  1.5276,  0.1687],\n        [ 1.3692, -0.0170, -1.6831]]) tensor([1, 0])\ntensor([[ 0.0515, -0.8892, -0.1699],\n        [ 0.4931, -0.0697,  0.4171]]) tensor([1, 0])\n'''\n&nbsp;\n# 输出一个batch\nprint('One batch tensor data: ', iter(tensor_dataloader).next())\n'''\n输出:\nOne batch tensor data:  [tensor([[ 0.9451, -0.4923, -1.8178],\n        [-0.4046, -0.5436, -1.7911]]), tensor([0, 0])]\n'''\n</code></pre><p>结合代码，我们梳理一下DataLoader中的几个参数，它们分别表示：</p><ul>\n<li>dataset：Dataset类型，输入的数据集，必须参数；</li>\n<li>batch_size：int类型，每个batch有多少个样本；</li>\n<li>shuffle：bool类型，在每个epoch开始的时候，是否对数据进行重新打乱；</li>\n<li>num_workers：int类型，加载数据的进程数，0意味着所有的数据都会被加载进主进程，默认为0。</li>\n</ul><h2>什么是Torchvision</h2><p>PyTroch官方为我们提供了一些常用的图片数据集，如果你需要读取这些数据集，那么无需自己实现，只需要利用Torchvision就可以搞定。</p><p>Torchvision 是一个和 PyTorch 配合使用的 Python 包。它不只提供了一些常用数据集，还提供了几个已经搭建好的经典网络模型，以及集成了一些图像数据处理方面的工具，主要供数据预处理阶段使用。简单地说，Torchvision 库就是<strong>常用数据集+常见网络模型+常用图像处理方法</strong>。</p><p>Torchvision的安装方式同样非常简单，可以使用conda安装，命令如下：</p><pre><code class=\"language-plain\">conda install torchvision -c pytorch\n</code></pre><p>或使用pip进行安装，命令如下：</p><pre><code class=\"language-plain\">pip install torchvision\n</code></pre><p>Torchvision中默认使用的图像加载器是PIL，因此为了确保Torchvision正常运行，我们还需要安装一个Python的第三方图像处理库——Pillow库。Pillow提供了广泛的文件格式支持，强大的图像处理能力，主要包括图像储存、图像显示、格式转换以及基本的图像处理操作等。</p><p>使用conda安装Pillow的命令如下：</p><pre><code class=\"language-python\">conda&nbsp;install&nbsp;pillow\n</code></pre><p>使用pip安装Pillow的命令如下：</p><pre><code class=\"language-python\">pip install pillow\n</code></pre><h2>利用Torchvision读取数据</h2><p>安装好Torchvision之后，我们再来接着看看。Torchvision库为我们读取数据提供了哪些支持。</p><p>Torchvision库中的<code>torchvision.datasets</code>包中提供了丰富的图像数据集的接口。常用的图像数据集，例如MNIST、COCO等，这个模块都为我们做了相应的封装。</p><p>下表中列出了<code>torchvision.datasets</code>包所有支持的数据集。各个数据集的说明与接口，详见链接<a href=\"https://pytorch.org/vision/stable/datasets.html\">https://pytorch.org/vision/stable/datasets.html</a>。</p><p><img src=\"https://static001.geekbang.org/resource/image/5f/44/5fa4d9067fa79b140d9e7646e7f28544.jpg?wh=1920x1162\" alt=\"图片\"></p><p>这里我想提醒你注意，<code>torchvision.datasets</code>这个包本身并不包含数据集的文件本身，它的工作方式是先从网络上把数据集下载到用户指定目录，然后再用它的加载器把数据集加载到内存中。最后，把这个加载后的数据集作为对象返回给用户。</p><p>为了让你进一步加深对知识的理解，我们以MNIST数据集为例，来说明一下这个模块具体的使用方法。</p><h3>MNIST数据集简介</h3><p>MNIST数据集是一个著名的手写数字数据集，因为上手简单，在深度学习领域，手写数字识别是一个很经典的学习入门样例。</p><p>MNIST数据集是NIST数据集的一个子集，MNIST 数据集你可以通过<a href=\"http://yann.lecun.com/exdb/mnist/\">这里</a>下载。它包含了四个部分，我用表格的方式为你做了梳理。</p><p><img src=\"https://static001.geekbang.org/resource/image/b6/9d/b6f465e8d27ca7f7abc27932da46309d.jpg?wh=1920x1157\" alt=\"图片\"></p><p>MNIST数据集是ubyte格式存储，我们先将“训练集图片”解析成图片格式，来直观地看一看数据集具体是什么样子的。具体怎么解析，我在后面数据预览再展开。</p><p><img src=\"https://static001.geekbang.org/resource/image/08/15/08977ccc74a3d2055434174e545d0515.jpg?wh=1920x844\" alt=\"图片\"></p><h3>数据读取</h3><p>接下来，我们看一下如何使用Torchvision来读取MNIST数据集。</p><p>对于<code>torchvision.datasets</code>所支持的所有数据集，它都内置了相应的数据集接口。例如刚才介绍的MNIST数据集，<code>torchvision.datasets</code>就有一个MNIST的接口，接口内封装了从下载、解压缩、读取数据、解析数据等全部过程。</p><p>这些接口的工作方式差不多，都是先从网络上把数据集下载到指定目录，然后再用加载器把数据集加载到内存中，最后将加载后的数据集作为对象返回给用户。</p><p>以MNIST为例，我们可以用如下方式调用：</p><pre><code class=\"language-python\"># 以MNIST为例\nimport torchvision\nmnist_dataset = torchvision.datasets.MNIST(root='./data',\n&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;train=True,\n&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;transform=None,\n&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;target_transform=None,\n&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;download=True)\n</code></pre><p><code>torchvision.datasets.MNIST</code>是一个类，对它进行实例化，即可返回一个MNIST数据集对象。构造函数包括包含5个参数：</p><ul>\n<li>root：是一个字符串，用于指定你想要保存MNIST数据集的位置。如果download是Flase，则会从目标位置读取数据集；</li>\n<li>download：是布尔类型，表示是否下载数据集。如果为True，则会自动从网上下载这个数据集，存储到root指定的位置。如果指定位置已经存在数据集文件，则不会重复下载；</li>\n<li>train：是布尔类型，表示是否加载训练集数据。如果为True，则只加载训练数据。如果为False，则只加载测试数据集。<strong>这里需要注意，并不是所有的数据集都做了训练集和测试集的划分，这个参数并不一定是有效参数，具体需要参考官方接口说明文档</strong>；</li>\n<li>transform：用于对图像进行预处理操作，例如数据增强、归一化、旋转或缩放等。这些操作我们会在下节课展开讲解；</li>\n<li>target_transform：用于对图像标签进行预处理操作。</li>\n</ul><p>运行上述的代码，我们可以得到下图所示的效果。从图中我们可以看出，程序首先去指定的网址下载了MNIST数据集，然后进行了解压缩等操作。如果你再次运行相同的代码，则不会再有下载的过程。</p><p><img src=\"https://static001.geekbang.org/resource/image/dc/8a/dcec80c2aa0e63f5450c85b7cda5c88a.png?wh=1920x1387\" alt=\"图片\"></p><p>看到这，你可能还有疑问，好奇我们得到的mnist_dataset是什么呢？</p><p>如果你用type函数查看一下mnist_dataset的类型，就可以得到<code>torchvision.datasets.mnist.MNIST</code> ，而这个类是之前我们介绍过的Dataset类的派生类。相当于<code>torchvision.datasets</code> ，它已经帮我们写好了对Dataset类的继承，完成了对数据集的封装，我们直接使用即可。</p><p>这里我们主要以MNIST为例，进行了说明。其它的数据集使用方法类似，调用的时候你只要需要将类名“MNIST”换成其它数据集名字即可。</p><p>对于不同的数据集，数据格式都不尽相同，而<code>torchvision.datasets</code>则帮助我们完成了各种不同格式的数据的解析与读取，可以说十分便捷。而对于那些没有官方接口的图像数据集，我们也可以使用以<code>torchvision.datasets.ImageFolder</code>接口来自行定义，在图像分类的实战篇中，就是使用ImageFolder进行数据读取的，你可以到那个时候再看一看。</p><h3>数据预览</h3><p>完成了数据读取工作，我们得到的是对应的mnist_dataset，刚才已经讲过了，这是一个封装了的数据集。</p><p>如果想要查看mnist_dataset中的具体内容，我们需要把它转化为列表。（如果IOPub&nbsp;data&nbsp;rate超限，可以只加载测试集数据，令train=False）</p><pre><code class=\"language-python\">mnist_dataset_list = list(mnist_dataset)\nprint(mnist_dataset_list)\n</code></pre><p>执行结果如下图所示。</p><p><img src=\"https://static001.geekbang.org/resource/image/9c/12/9c7838a309b6e9ffa8yy33a44b00d312.png?wh=1920x434\" alt=\"图片\"></p><p>从运行结果中可以看出，转换后的数据集对象变成了一个元组列表，每个元组有两个元素，第一个元素是图像数据，第二个元素是图像的标签。</p><p>这里图像数据是PIL.Image.Image类型的，这种类型可以直接在Jupyter中显示出来。显示一条数据的代码如下。</p><pre><code class=\"language-python\">display(mnist_dataset_list[0][0])\nprint(\"Image label is:\", mnist_dataset_list[0][1])\n</code></pre><p>运行结果如下图所示。可以看出，数据集mnist_dataset中的第一条数据是图片手写数字“7”，对应的标签是“7”。</p><p><img src=\"https://static001.geekbang.org/resource/image/21/c3/211289da00fc13fd21f72573aee049c3.png?wh=1466x242\" alt=\"图片\"></p><p>好，如果你也得到了上面的运行结果，说明你的操作没问题，恭喜你成功完成了读取操作。</p><h2>小结</h2><p>恭喜你完成了这节课的学习。我们已经迈出了模型训练的第一步，学会了如何读取数据。</p><p>今天的重点就是掌握<strong>两种读取数据的方法，也就是自定义和读取常用图像数据集</strong>。</p><p>最通用的数据读取方法，就是自己定义一个Dataset的派生类。而读取常用的图像数据集，就可以利用PyTorch提供的视觉包Torchvision。</p><p>Torchvision库为我们读取数据提供了丰富的图像数据集的接口。我用手写数字识别这个经典例子，给你示范了如何使用Torchvision来读取MNIST数据集。</p><p><code>torchvision.datasets</code>继承了Dataset 类，它在预定义许多常用的数据集的同时，还预留了数据预处理与数据增强的接口。在下一节课中，我们就会接触到这些数据增强函数，并学习如何进行数据增强。</p><h2>每课一练</h2><p>在PyTorch中，我们要定义一个数据集，应该继承哪一个类呢？</p><p>欢迎你在留言区和我交流互动，也推荐你把这节课内容分享给更多的朋友、同事，跟他一起学习进步。</p>","neighbors":{"left":{"article_title":"05 | Tensor变形记：快速掌握Tensor切分、变形等方法","id":428186},"right":{"article_title":"07 | Torchvision（中）：数据增强，让数据更加多样性","id":429826}},"comments":[{"had_liked":false,"id":318088,"user_name":"超人不会飞","can_delete":false,"product_type":"c1","uid":2808296,"ip_address":"","ucode":"6F67096D5FFAFA","user_header":"https://thirdwx.qlogo.cn/mmopen/vi_32/SKmvhbNe9LMPQ0ib8ZqbJEfHicUxzxCSKVXiaibn7OrmXGUFQjkesgvODymZz4kibzqOGxuRq42t3sB2ibcBIIGWRgSg/132","comment_is_top":false,"comment_ctime":1635145356,"is_pvip":false,"replies":[{"id":"115320","content":"你好，超人不会飞。感谢你的留言。<br>tensor_dataloader是一个dataloader对象，用iter()强制类型转换成迭代器的对象，next()是输出迭代器下一个元素。^^","user_name":"作者回复","user_name_real":"方远","uid":"2802608","ctime":1635155852,"ip_address":"","comment_id":318088,"utype":1}],"discussion_count":3,"race_medal":0,"score":"23109981836","product_id":100093301,"comment_content":"tensor_dataloader 是一个迭代器<br>iter（tensor_dataloader)是一个迭代器对象<br><br>iter(tensor_dataloader).next() 是输出迭代器的下一个元素<br><br>兄弟们我这波理解到位不","like_count":5,"discussions":[{"author":{"id":2802608,"avatar":"https://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTK1ZkL9L7CEicI87xicpIhXAIhVdVWpJKBsD8Jpzg9iaAwFcDEhTvdRwuKItJS14mYznT2w2YQvn8QsQ/132","nickname":"方远","note":"","ucode":"248B1DE180EB4C","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":529097,"discussion_content":"你好，超人不会飞。感谢你的留言。\ntensor_dataloader是一个dataloader对象，用iter()强制类型转换成迭代器的对象，next()是输出迭代器下一个元素。^^","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1635155852,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":2808296,"avatar":"https://thirdwx.qlogo.cn/mmopen/vi_32/SKmvhbNe9LMPQ0ib8ZqbJEfHicUxzxCSKVXiaibn7OrmXGUFQjkesgvODymZz4kibzqOGxuRq42t3sB2ibcBIIGWRgSg/132","nickname":"超人不会飞","note":"","ucode":"6F67096D5FFAFA","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":408784,"discussion_content":"哦哦哦对，第一个是对象，实例化出来的对象","likes_number":1,"is_delete":false,"is_hidden":false,"ctime":1635323987,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":2028956,"avatar":"","nickname":"勿更改任何信息","note":"","ucode":"575185C69C05A3","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":408385,"discussion_content":"请问老师，代码部分在github上有完整链接吗？","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1635238916,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":317580,"user_name":"Spoon","can_delete":false,"product_type":"c1","uid":2676251,"ip_address":"","ucode":"5ADD84981EF8D7","user_header":"https://static001.geekbang.org/account/avatar/00/28/d6/1b/b0f912fd.jpg","comment_is_top":false,"comment_ctime":1634865757,"is_pvip":false,"replies":[{"id":"115110","content":"你好，Spoon。感谢你的留言。<br>数据是3维，标签是1维，一共有10条数据。<br>10*3是指data_tensor的size，10*1是指target_tensor的size。<br>torch.randint(2, (10,)) 这句代码的意思是指生成10个随机数，随机数的范围只能是0或者1。<br>可以运行下代码，分别打印一下data_tensor和target_tensor的内容，一看就能明白了：）","user_name":"作者回复","user_name_real":"方远","uid":"2802608","ctime":1634885193,"ip_address":"","comment_id":317580,"utype":1}],"discussion_count":4,"race_medal":0,"score":"10224800349","product_id":100093301,"comment_content":"老师好， 想问下。。为啥你说是10x3 维啊 数据不是2维的吗，下面标签不是一维的吗。。。有点confuse了。。<br>data_tensor = torch.randn(10, 3)<br>target_tensor = torch.randint(2, (10,)) # 标签是0或1","like_count":3,"discussions":[{"author":{"id":2802608,"avatar":"https://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTK1ZkL9L7CEicI87xicpIhXAIhVdVWpJKBsD8Jpzg9iaAwFcDEhTvdRwuKItJS14mYznT2w2YQvn8QsQ/132","nickname":"方远","note":"","ucode":"248B1DE180EB4C","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":528878,"discussion_content":"你好，Spoon。感谢你的留言。\n数据是3维，标签是1维，一共有10条数据。\n10*3是指data_tensor的size，10*1是指target_tensor的size。\ntorch.randint(2, (10,)) 这句代码的意思是指生成10个随机数，随机数的范围只能是0或者1。\n可以运行下代码，分别打印一下data_tensor和target_tensor的内容，一看就能明白了：）","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1634885193,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":2676251,"avatar":"https://static001.geekbang.org/account/avatar/00/28/d6/1b/b0f912fd.jpg","nickname":"Spoon","note":"","ucode":"5ADD84981EF8D7","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":407803,"discussion_content":"老师好， 打印出来是有2个[[的， 一般2维吧， 3个[[[ 才是3维，不过感觉10行3列， 每列算一个特征维度感觉也对。。。","likes_number":1,"is_delete":false,"is_hidden":false,"ctime":1635124539,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":2281586,"avatar":"https://static001.geekbang.org/account/avatar/00/22/d0/72/c16cf5db.jpg","nickname":"屋顶","note":"","ucode":"9C283F99059CFE","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":548207,"discussion_content":"10*3维，是说明tensor的形状是10*3，不是3维的意思吧","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1643080969,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":2034712,"avatar":"https://static001.geekbang.org/account/avatar/00/1f/0c/18/298a0eab.jpg","nickname":"小强","note":"","ucode":"D1B0DA58E4D969","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":409294,"discussion_content":"我打出来也是二维的","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1635410723,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":345766,"user_name":"JC","can_delete":false,"product_type":"c1","uid":1097553,"ip_address":"","ucode":"A95FACC6EE9851","user_header":"https://static001.geekbang.org/account/avatar/00/10/bf/51/1791ae60.jpg","comment_is_top":false,"comment_ctime":1652582597,"is_pvip":true,"discussion_count":0,"race_medal":0,"score":"5947549893","product_id":100093301,"comment_content":"国内直接下载MNIST数据集，可能会有些问题<br>可以通过本地下载文件，放入到某目录，然后在该目录下使用 python -m http.server 启动一个本地server<br>最后把 mnist.py 文件里的 mirrors 上方添加一行 http:&#47;&#47;localhost:8000&#47;MNIST&#47;","like_count":2},{"had_liked":false,"id":356257,"user_name":"孙新","can_delete":false,"product_type":"c1","uid":2875594,"ip_address":"北京","ucode":"A80038A479B943","user_header":"https://static001.geekbang.org/account/avatar/00/2b/e0/ca/adfaa551.jpg","comment_is_top":false,"comment_ctime":1662090011,"is_pvip":true,"replies":[{"id":"129680","content":"你好，孙新，感谢你的留言。<br>这个display()函数是Jupyter自带的，如果想在其他IDE中使用，可以尝试：<br>from IPython import display","user_name":"作者回复","user_name_real":"编辑","uid":"2802608","ctime":1662098771,"ip_address":"北京","comment_id":356257,"utype":1}],"discussion_count":2,"race_medal":0,"score":"1662090011","product_id":100093301,"comment_content":"display(mnist_dataset_list[0][0])  这一行没有成功，提示display错误<br>Traceback (most recent call last):<br>  File &quot;&lt;stdin&gt;&quot;, line 1, in &lt;module&gt;<br>NameError: name &#39;display&#39; is not defined<br>我用的环境有问题吗？还是说需要什么IDE才能出效果？<br>","like_count":0,"discussions":[{"author":{"id":2802608,"avatar":"https://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTK1ZkL9L7CEicI87xicpIhXAIhVdVWpJKBsD8Jpzg9iaAwFcDEhTvdRwuKItJS14mYznT2w2YQvn8QsQ/132","nickname":"方远","note":"","ucode":"248B1DE180EB4C","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":586305,"discussion_content":"你好，孙新，感谢你的留言。\n这个display()函数是Jupyter自带的，如果想在其他IDE中使用，可以尝试：\nfrom IPython import display","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1662098771,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"北京"},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":1,"child_discussions":[{"author":{"id":2875594,"avatar":"https://static001.geekbang.org/account/avatar/00/2b/e0/ca/adfaa551.jpg","nickname":"孙新","note":"","ucode":"A80038A479B943","race_medal":0,"user_type":1,"is_pvip":true},"reply_author":{"id":2802608,"avatar":"https://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTK1ZkL9L7CEicI87xicpIhXAIhVdVWpJKBsD8Jpzg9iaAwFcDEhTvdRwuKItJS14mYznT2w2YQvn8QsQ/132","nickname":"方远","note":"","ucode":"248B1DE180EB4C","race_medal":0,"user_type":2,"is_pvip":false},"discussion":{"id":586309,"discussion_content":"感谢老师，我后来也看到下一节有人在笔记里提了这个引用。这个引用貌似会导致display和print类似，我想要你文稿那种图片输出。我再研究下Jupyter，上午弄了一下不太对劲，没跑起来。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1662100694,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":586305,"ip_address":"辽宁"},"score":586309,"extra":""}]}]},{"had_liked":false,"id":353061,"user_name":"John(易筋)","can_delete":false,"product_type":"c1","uid":1180202,"ip_address":"北京","ucode":"BB4E58DD4B8F15","user_header":"https://static001.geekbang.org/account/avatar/00/12/02/2a/90e38b94.jpg","comment_is_top":false,"comment_ctime":1659103268,"is_pvip":true,"discussion_count":0,"race_medal":0,"score":"1659103268","product_id":100093301,"comment_content":"PIL Image Module<br>The Image module provides a class with the same name which is used to represent a PIL image. The module also provides a number of factory functions, including functions to load images from files, and to create new images.<br><br>Examples<br>Open, rotate, and display an image (using the default viewer)<br>The following script loads an image, rotates it 45 degrees, and displays it using an external viewer (usually xv on Unix, and the Paint program on Windows).<br><br>from PIL import Image<br>with Image.open(&quot;hopper.jpg&quot;) as im:<br>    im.rotate(45).show()<br>","like_count":0},{"had_liked":false,"id":352937,"user_name":"ACT","can_delete":false,"product_type":"c1","uid":2600235,"ip_address":"陕西","ucode":"8E5747D75045A7","user_header":"https://static001.geekbang.org/account/avatar/00/27/ad/2b/46b4a196.jpg","comment_is_top":false,"comment_ctime":1659023631,"is_pvip":true,"replies":[{"id":"128355","content":"👍🏻 ^^","user_name":"作者回复","user_name_real":"编辑","uid":"2802608","ctime":1659078723,"ip_address":"陕西","comment_id":352937,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1659023631","product_id":100093301,"comment_content":"Dataset","like_count":0,"discussions":[{"author":{"id":2802608,"avatar":"https://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTK1ZkL9L7CEicI87xicpIhXAIhVdVWpJKBsD8Jpzg9iaAwFcDEhTvdRwuKItJS14mYznT2w2YQvn8QsQ/132","nickname":"方远","note":"","ucode":"248B1DE180EB4C","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":581938,"discussion_content":"👍🏻 ^^","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1659078723,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"陕西"},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":352818,"user_name":"John(易筋)","can_delete":false,"product_type":"c1","uid":1180202,"ip_address":"北京","ucode":"BB4E58DD4B8F15","user_header":"https://static001.geekbang.org/account/avatar/00/12/02/2a/90e38b94.jpg","comment_is_top":false,"comment_ctime":1658969356,"is_pvip":true,"replies":[{"id":"128358","content":"👍🏻👍🏻👍🏻","user_name":"作者回复","user_name_real":"编辑","uid":"2802608","ctime":1659079588,"ip_address":"北京","comment_id":352818,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1658969356","product_id":100093301,"comment_content":"IOPub data rate 超限 解决 <br><br>This works for me in Mac and Windows (taken from here):<br><br>1. To create a jupyter_notebook_config.py file, with all the defaults commented out, you can use the following command line:<br><br>$ jupyter notebook --generate-config<br><br>2. Open the file and search for c.NotebookApp.iopub_data_rate_limit<br><br>3. 取消注释Comment out the line c.NotebookApp.iopub_data_rate_limit = 1000000 and change it to a higher default rate. l used c.NotebookApp.iopub_data_rate_limit = 10000000<br><br>参考：<br>https:&#47;&#47;stackoverflow.com&#47;questions&#47;43288550&#47;iopub-data-rate-exceeded-in-jupyter-notebook-when-viewing-image<br>","like_count":0,"discussions":[{"author":{"id":2802608,"avatar":"https://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTK1ZkL9L7CEicI87xicpIhXAIhVdVWpJKBsD8Jpzg9iaAwFcDEhTvdRwuKItJS14mYznT2w2YQvn8QsQ/132","nickname":"方远","note":"","ucode":"248B1DE180EB4C","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":581944,"discussion_content":"👍🏻👍🏻👍🏻","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1659079589,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"北京"},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":345767,"user_name":"JC","can_delete":false,"product_type":"c1","uid":1097553,"ip_address":"","ucode":"A95FACC6EE9851","user_header":"https://static001.geekbang.org/account/avatar/00/10/bf/51/1791ae60.jpg","comment_is_top":false,"comment_ctime":1652582650,"is_pvip":true,"replies":[{"id":"126215","content":"👍🏻👍🏻👍🏻 ^^","user_name":"作者回复","user_name_real":"编辑","uid":"2802608","ctime":1652669993,"ip_address":"","comment_id":345767,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1652582650","product_id":100093301,"comment_content":"国内直接下载MNIST数据集，可能会有些问题<br>可以通过本地下载文件，放入到某目录，然后在该目录下使用 python -m http.server 启动一个本地server<br>最后把 mnist.py 文件里的 mirrors 上方添加一行 http:&#47;&#47;localhost:8000&#47;MNIST&#47;","like_count":1,"discussions":[{"author":{"id":2802608,"avatar":"https://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTK1ZkL9L7CEicI87xicpIhXAIhVdVWpJKBsD8Jpzg9iaAwFcDEhTvdRwuKItJS14mYznT2w2YQvn8QsQ/132","nickname":"方远","note":"","ucode":"248B1DE180EB4C","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":572237,"discussion_content":"👍🏻👍🏻👍🏻 ^^","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1652669993,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":345367,"user_name":"亚林","can_delete":false,"product_type":"c1","uid":1018972,"ip_address":"","ucode":"4A5A6D24314B79","user_header":"https://static001.geekbang.org/account/avatar/00/0f/8c/5c/3f164f66.jpg","comment_is_top":false,"comment_ctime":1652236258,"is_pvip":false,"replies":[{"id":"126081","content":"👍🏻👍🏻^^<br>torch.utils.data.Dataset类","user_name":"作者回复","user_name_real":"编辑","uid":"2802608","ctime":1652249987,"ip_address":"","comment_id":345367,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1652236258","product_id":100093301,"comment_content":"Dataset","like_count":0,"discussions":[{"author":{"id":2802608,"avatar":"https://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTK1ZkL9L7CEicI87xicpIhXAIhVdVWpJKBsD8Jpzg9iaAwFcDEhTvdRwuKItJS14mYznT2w2YQvn8QsQ/132","nickname":"方远","note":"","ucode":"248B1DE180EB4C","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":571509,"discussion_content":"👍🏻👍🏻^^\ntorch.utils.data.Dataset类","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1652249988,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":343837,"user_name":"乐呵的hehe","can_delete":false,"product_type":"c1","uid":2952223,"ip_address":"","ucode":"E77E102206F038","user_header":"https://static001.geekbang.org/account/avatar/00/2d/0c/1f/fcc777e1.jpg","comment_is_top":false,"comment_ctime":1651073503,"is_pvip":false,"replies":[{"id":"125585","content":"您好，感谢留言。<br>因为设置了shuffle=True参数。<br>数据会shuffle一下","user_name":"作者回复","user_name_real":"编辑","uid":"2802608","ctime":1651133899,"ip_address":"","comment_id":343837,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1651073503","product_id":100093301,"comment_content":"老师，您好，下面这个问题，我也有些疑惑，但是我不在微信群里，您可以在这里再解释一下吗？谢谢！<br>-------------------------------------------------------------------<br>from torch.utils.data import DataLoader<br><br>tensor_dataloader = DataLoader(dataset=my_dataset, batch_size=2, shuffle=True,<br>                                               num_workers=0)# 进程数, 0表示只有主进程<br><br># 以循环形式输出<br>for data, target in tensor_dataloader: <br>    print(data, target)<br><br># 输出一个batch<br>print(&#39;One batch tensor data: &#39;, iter(tensor_dataloader).next())<br><br>输出结果：<br>tensor([[ 0.7989,  3.1884,  1.2282],<br><br>        [-0.6210, -0.9707,  2.5557]]) tensor([1, 0])<br><br>tensor([[-0.8162, -0.5454,  2.1312],<br><br>        [ 0.8296, -0.2082,  1.7351]]) tensor([0, 0])<br><br>tensor([[ 1.3808,  0.2034,  0.3342],<br><br>        [ 0.4650, -1.1422, -0.4364]]) tensor([1, 1])<br><br>tensor([[ 1.0286, -1.1956,  0.4743],<br><br>        [ 3.1708, -0.0568, -1.5444]]) tensor([1, 0])<br><br>tensor([[ 0.1358,  1.2954, -0.0674],<br><br>        [-0.7422, -0.2062,  2.4920]]) tensor([0, 0])<br><br>One batch tensor data:  [tensor([[ 3.1708, -0.0568, -1.5444],<br><br>        [-0.7422, -0.2062,  2.4920]]), tensor([0, 0])]<br><br>迭代器输出的tensor怎么会都不在一个batch里呢？正常情况下，不是应该输出第二个batch里的tensor嘛？","like_count":1,"discussions":[{"author":{"id":2802608,"avatar":"https://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTK1ZkL9L7CEicI87xicpIhXAIhVdVWpJKBsD8Jpzg9iaAwFcDEhTvdRwuKItJS14mYznT2w2YQvn8QsQ/132","nickname":"方远","note":"","ucode":"248B1DE180EB4C","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":568429,"discussion_content":"您好，感谢留言。\n因为设置了shuffle=True参数。\n数据会shuffle一下","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1651133899,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":341130,"user_name":"Geek_fc975d","can_delete":false,"product_type":"c1","uid":2459939,"ip_address":"","ucode":"05B6507FE4349B","user_header":"https://static001.geekbang.org/account/avatar/00/25/89/23/e71f180b.jpg","comment_is_top":false,"comment_ctime":1649381805,"is_pvip":false,"replies":[{"id":"124706","content":"谢谢反馈，很开心对你有帮助啊～希望后续内容一样能让你觉得不虚此行。","user_name":"编辑回复","user_name_real":"编辑","uid":"1501385","ctime":1649399182,"ip_address":"","comment_id":341130,"utype":2}],"discussion_count":1,"race_medal":0,"score":"1649381805","product_id":100093301,"comment_content":"这节课收获颇丰","like_count":0,"discussions":[{"author":{"id":1501385,"avatar":"https://static001.geekbang.org/account/avatar/00/16/e8/c9/59bcd490.jpg","nickname":"听水的湖","note":"","ucode":"B1759F90165D81","race_medal":0,"user_type":8,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":560591,"discussion_content":"谢谢反馈，很开心对你有帮助啊～希望后续内容一样能让你觉得不虚此行。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1649399182,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":8}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":341096,"user_name":"Geek_fc975d","can_delete":false,"product_type":"c1","uid":2459939,"ip_address":"","ucode":"05B6507FE4349B","user_header":"https://static001.geekbang.org/account/avatar/00/25/89/23/e71f180b.jpg","comment_is_top":false,"comment_ctime":1649343108,"is_pvip":false,"replies":[{"id":"124707","content":"hello，你好，感谢留言。<br>你是说这块吗？<br>print(&#39;One batch tensor data: &#39;, iter(tensor_dataloader).next())<br>不会啊，next()，是Python迭代器的内容，跟Pytorch没有关系。<br>具体你是怎么做的呢？","user_name":"作者回复","user_name_real":"编辑","uid":"2802608","ctime":1649403758,"ip_address":"","comment_id":341096,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1649343108","product_id":100093301,"comment_content":"为什么我只有__next__函数，而没有next()函数","like_count":0,"discussions":[{"author":{"id":2802608,"avatar":"https://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTK1ZkL9L7CEicI87xicpIhXAIhVdVWpJKBsD8Jpzg9iaAwFcDEhTvdRwuKItJS14mYznT2w2YQvn8QsQ/132","nickname":"方远","note":"","ucode":"248B1DE180EB4C","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":560609,"discussion_content":"hello，你好，感谢留言。\n你是说这块吗？\nprint(&#39;One batch tensor data: &#39;, iter(tensor_dataloader).next())\n不会啊，next()，是Python迭代器的内容，跟Pytorch没有关系。\n具体你是怎么做的呢？","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1649403759,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":327795,"user_name":"黑羽","can_delete":false,"product_type":"c1","uid":1233657,"ip_address":"","ucode":"80F49399DE99B7","user_header":"https://static001.geekbang.org/account/avatar/00/12/d2/f9/6c3ca4db.jpg","comment_is_top":false,"comment_ctime":1640309669,"is_pvip":false,"replies":[{"id":"119358","content":"你好，黑羽，谢谢留言。<br>最好是写一个类继承dataset，然后用dataloader来加载数据。<br>不使用dataset的话，你也得自己写一套代码完成相同的功能，那为什么不直接使用Pytorch提供的方法呢？^^","user_name":"作者回复","user_name_real":"编辑","uid":"2802608","ctime":1640324358,"ip_address":"","comment_id":327795,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1640309669","product_id":100093301,"comment_content":"老师，如果自己有一个图片的数据集，也需要先定义dataset类来读取吗","like_count":0,"discussions":[{"author":{"id":2802608,"avatar":"https://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTK1ZkL9L7CEicI87xicpIhXAIhVdVWpJKBsD8Jpzg9iaAwFcDEhTvdRwuKItJS14mYznT2w2YQvn8QsQ/132","nickname":"方远","note":"","ucode":"248B1DE180EB4C","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":541293,"discussion_content":"你好，黑羽，谢谢留言。\n最好是写一个类继承dataset，然后用dataloader来加载数据。\n不使用dataset的话，你也得自己写一套代码完成相同的功能，那为什么不直接使用Pytorch提供的方法呢？^^","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1640324359,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":326990,"user_name":"天凉好个秋","can_delete":false,"product_type":"c1","uid":2842361,"ip_address":"","ucode":"C61A17A9591C24","user_header":"https://static001.geekbang.org/account/avatar/00/2b/5e/f9/96896116.jpg","comment_is_top":false,"comment_ctime":1639816228,"is_pvip":false,"replies":[{"id":"118977","content":"你好，天凉好个秋。<br>是的。是因为把shuffle设置为True了。","user_name":"作者回复","user_name_real":"编辑","uid":"2802608","ctime":1639960879,"ip_address":"","comment_id":326990,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1639816228","product_id":100093301,"comment_content":"老师请问 迭代器输出的batch和for循环输出的batch不同的原因是设置了shuffle=True后，每次调用实例化对象后都会进行一次打乱吗？","like_count":0,"discussions":[{"author":{"id":2802608,"avatar":"https://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTK1ZkL9L7CEicI87xicpIhXAIhVdVWpJKBsD8Jpzg9iaAwFcDEhTvdRwuKItJS14mYznT2w2YQvn8QsQ/132","nickname":"方远","note":"","ucode":"248B1DE180EB4C","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":540090,"discussion_content":"你好，天凉好个秋。\n是的。是因为把shuffle设置为True了。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1639960879,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":326591,"user_name":"Geek_86b454","can_delete":false,"product_type":"c1","uid":2810813,"ip_address":"","ucode":"6450B391971AFB","user_header":"https://thirdwx.qlogo.cn/mmopen/vi_32/dQQR8nfd3k8zO9Z7TjOxSuRb3z6QH9Y7hGZibPuganp8Xspic2LPAIYggKafsP98U46Lc3X1BQ4qw9ROxLZXP4WA/132","comment_is_top":false,"comment_ctime":1639574095,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1639574095","product_id":100093301,"comment_content":"老师，我是个新手，我想请你帮个忙，能不能帮我下载到huggingface 的数据集glue，好几天了，我弄不好","like_count":0},{"had_liked":false,"id":320984,"user_name":"autiplex","can_delete":false,"product_type":"c1","uid":2817246,"ip_address":"","ucode":"6D8DB528CC3A3E","user_header":"https://static001.geekbang.org/account/avatar/00/2a/fc/de/6e2cb960.jpg","comment_is_top":false,"comment_ctime":1636611056,"is_pvip":false,"replies":[{"id":"116603","content":"你好，autiplex，感谢你的留言。<br>用conda安装软件的标准语法格式为：<br>conda install -c &lt;channel&gt; &lt;software&gt;<br>其中-c这个参数很重要，通过它来指定软件下载的镜像位置。<br><br>-c pytorch 代表去pytorch的官方镜像的列表中下载。（去pytorch的官网下载）","user_name":"作者回复","user_name_real":"方远","uid":"2802608","ctime":1636682415,"ip_address":"","comment_id":320984,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1636611056","product_id":100093301,"comment_content":"老师请问conda install torchvision -c pytorch 后面的-c pytorch代表什么","like_count":0,"discussions":[{"author":{"id":2802608,"avatar":"https://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTK1ZkL9L7CEicI87xicpIhXAIhVdVWpJKBsD8Jpzg9iaAwFcDEhTvdRwuKItJS14mYznT2w2YQvn8QsQ/132","nickname":"方远","note":"","ucode":"248B1DE180EB4C","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":530178,"discussion_content":"你好，autiplex，感谢你的留言。\n用conda安装软件的标准语法格式为：\nconda install -c &amp;lt;channel&amp;gt; &amp;lt;software&amp;gt;\n其中-c这个参数很重要，通过它来指定软件下载的镜像位置。\n\n-c pytorch 代表去pytorch的官方镜像的列表中下载。（去pytorch的官网下载）","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1636682415,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":320456,"user_name":"王珎","can_delete":false,"product_type":"c1","uid":2822974,"ip_address":"","ucode":"5074BA9DD3DE88","user_header":"https://static001.geekbang.org/account/avatar/00/2b/13/3e/d028cddd.jpg","comment_is_top":false,"comment_ctime":1636339952,"is_pvip":false,"replies":[{"id":"116184","content":"你好，王珎。感谢你的留言。<br>是的，要继承torch.utils.data.Dataset^^","user_name":"作者回复","user_name_real":"方远","uid":"2802608","ctime":1636350001,"ip_address":"","comment_id":320456,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1636339952","product_id":100093301,"comment_content":"在PyTorch中定义数据集，应该继承 Dataset 类","like_count":0,"discussions":[{"author":{"id":2802608,"avatar":"https://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTK1ZkL9L7CEicI87xicpIhXAIhVdVWpJKBsD8Jpzg9iaAwFcDEhTvdRwuKItJS14mYznT2w2YQvn8QsQ/132","nickname":"方远","note":"","ucode":"248B1DE180EB4C","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":529998,"discussion_content":"你好，王珎。感谢你的留言。\n是的，要继承torch.utils.data.Dataset^^","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1636350001,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":320288,"user_name":"clee","can_delete":false,"product_type":"c1","uid":1467446,"ip_address":"","ucode":"122875102B23A8","user_header":"","comment_is_top":false,"comment_ctime":1636203284,"is_pvip":false,"replies":[{"id":"116180","content":"你好，clee，谢谢你的留言。<br>可以尝试升级一下pillow的版本。<br>我的运行环境是：<br>Python 3.7.4<br>pillow 7.0.0<br>torchvision 0.10.0<br>供参考。","user_name":"作者回复","user_name_real":"方远","uid":"2802608","ctime":1636349513,"ip_address":"","comment_id":320288,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1636203284","product_id":100093301,"comment_content":"你好，我在引入PIL的时候遇到一个版本问题，没找到解决办法，请问是哪儿有问题呢？<br>ImportError: dlopen(&#47;Users&#47;xx&#47;opt&#47;anaconda3&#47;lib&#47;python3.8&#47;site-packages&#47;PIL&#47;_imaging.cpython-38-darwin.so, 2): Library not loaded: @rpath&#47;libjpeg.9.dylib<br>  Referenced from: &#47;Users&#47;xx&#47;opt&#47;anaconda3&#47;lib&#47;python3.8&#47;site-packages&#47;PIL&#47;_imaging.cpython-38-darwin.so<br>  Reason: Incompatible library version: _imaging.cpython-38-darwin.so requires version 14.0.0 or later, but libjpeg.9.dylib provides version 12.0.0","like_count":0,"discussions":[{"author":{"id":2802608,"avatar":"https://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTK1ZkL9L7CEicI87xicpIhXAIhVdVWpJKBsD8Jpzg9iaAwFcDEhTvdRwuKItJS14mYznT2w2YQvn8QsQ/132","nickname":"方远","note":"","ucode":"248B1DE180EB4C","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":529940,"discussion_content":"你好，clee，谢谢你的留言。\n可以尝试升级一下pillow的版本。\n我的运行环境是：\nPython 3.7.4\npillow 7.0.0\ntorchvision 0.10.0\n供参考。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1636349513,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":319687,"user_name":"林于翔","can_delete":false,"product_type":"c1","uid":2810184,"ip_address":"","ucode":"BCFE3F7520F8A0","user_header":"https://static001.geekbang.org/account/avatar/00/2a/e1/48/3a981e55.jpg","comment_is_top":false,"comment_ctime":1635909298,"is_pvip":false,"replies":[{"id":"115858","content":"你好，林于翔。谢谢你的留言。微信回复完了哈。","user_name":"作者回复","user_name_real":"方远","uid":"2802608","ctime":1635922030,"ip_address":"","comment_id":319687,"utype":1}],"discussion_count":4,"race_medal":0,"score":"1635909298","product_id":100093301,"comment_content":"from torch.utils.data import DataLoader<br>tensor_dataloader = DataLoader(dataset=my_dataset, # 传入的数据集, 必须参数<br>                               batch_size=2,       # 输出的batch大小<br>                               shuffle=True,       # 是否对数据进行重新打乱；<br>                               num_workers=0)      # 进程数, 0表示只有主进程<br><br># 以循环形式输出<br>for data, target in tensor_dataloader: <br>    print(data, target)<br><br># 输出一个batch<br>print(&#39;One batch tensor data: &#39;, iter(tensor_dataloader).next())<br><br><br>输出结果：<br>tensor([[ 0.7989,  3.1884,  1.2282],<br>        [-0.6210, -0.9707,  2.5557]]) tensor([1, 0])<br>tensor([[-0.8162, -0.5454,  2.1312],<br>        [ 0.8296, -0.2082,  1.7351]]) tensor([0, 0])<br>tensor([[ 1.3808,  0.2034,  0.3342],<br>        [ 0.4650, -1.1422, -0.4364]]) tensor([1, 1])<br>tensor([[ 1.0286, -1.1956,  0.4743],<br>        [ 3.1708, -0.0568, -1.5444]]) tensor([1, 0])<br>tensor([[ 0.1358,  1.2954, -0.0674],<br>        [-0.7422, -0.2062,  2.4920]]) tensor([0, 0])<br>One batch tensor data:  [tensor([[ 3.1708, -0.0568, -1.5444],<br>        [-0.7422, -0.2062,  2.4920]]), tensor([0, 0])]<br><br>迭代器输出的tensor怎么会都不在一个batch里呢？正常情况下，不是应该输出第二个batch里的tensor嘛？","like_count":0,"discussions":[{"author":{"id":2802608,"avatar":"https://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTK1ZkL9L7CEicI87xicpIhXAIhVdVWpJKBsD8Jpzg9iaAwFcDEhTvdRwuKItJS14mYznT2w2YQvn8QsQ/132","nickname":"方远","note":"","ucode":"248B1DE180EB4C","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":529724,"discussion_content":"你好，林于翔。谢谢你的留言。微信回复完了哈。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1635922030,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":3,"child_discussions":[{"author":{"id":2819782,"avatar":"https://static001.geekbang.org/account/avatar/00/2b/06/c6/40ad4ea7.jpg","nickname":"焦阳","note":"","ucode":"B0FDD1E4B41721","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":2802608,"avatar":"https://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTK1ZkL9L7CEicI87xicpIhXAIhVdVWpJKBsD8Jpzg9iaAwFcDEhTvdRwuKItJS14mYznT2w2YQvn8QsQ/132","nickname":"方远","note":"","ucode":"248B1DE180EB4C","race_medal":0,"user_type":2,"is_pvip":false},"discussion":{"id":530739,"discussion_content":"老师，能再回复一下吗，我也遇到了这个问题","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1637137448,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":529724,"ip_address":""},"score":530739,"extra":"{\"user_type\":1}"},{"author":{"id":1253923,"avatar":"https://static001.geekbang.org/account/avatar/00/13/22/23/16c3ea01.jpg","nickname":"zoob","note":"","ucode":"C4FE6AC20403B9","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":2802608,"avatar":"https://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTK1ZkL9L7CEicI87xicpIhXAIhVdVWpJKBsD8Jpzg9iaAwFcDEhTvdRwuKItJS14mYznT2w2YQvn8QsQ/132","nickname":"方远","note":"","ucode":"248B1DE180EB4C","race_medal":0,"user_type":2,"is_pvip":false},"discussion":{"id":559138,"discussion_content":"老师，我也遇到了这个问题。您能在这里解答吗？","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1648622786,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":529724,"ip_address":""},"score":559138,"extra":""},{"author":{"id":2952223,"avatar":"https://static001.geekbang.org/account/avatar/00/2d/0c/1f/fcc777e1.jpg","nickname":"乐呵的hehe","note":"","ucode":"E77E102206F038","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":2802608,"avatar":"https://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTK1ZkL9L7CEicI87xicpIhXAIhVdVWpJKBsD8Jpzg9iaAwFcDEhTvdRwuKItJS14mYznT2w2YQvn8QsQ/132","nickname":"方远","note":"","ucode":"248B1DE180EB4C","race_medal":0,"user_type":2,"is_pvip":false},"discussion":{"id":568107,"discussion_content":"老师，我也有这个疑问，可以在这里再解答一下吗？","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1651066907,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":529724,"ip_address":""},"score":568107,"extra":""}]}]},{"had_liked":false,"id":319053,"user_name":"Swaggy","can_delete":false,"product_type":"c1","uid":1238588,"ip_address":"","ucode":"EC042FC4862A9E","user_header":"https://static001.geekbang.org/account/avatar/00/12/e6/3c/b03ed9c2.jpg","comment_is_top":false,"comment_ctime":1635528295,"is_pvip":false,"replies":[{"id":"115647","content":"你好，Swaggy，感谢你的留言。<br>遇到这种问题我一般会这么排查。<br>首先看看，PyTorch、CUDA以及显卡驱动的型号是不是都对上了。<br>然后，看看，数据、模型、损失是否加cuda()了。<br>你可以用watch命令看看nvidia-smi，网络比较小，如果只用nvidia-smi看的话，可能没有卡到利用率高的时候，因为通过你的描述我感觉没用到GPU。<br>最后，给batch_size设置小一点看看。如果能确保在1.5.1中是用GPU训练的话，我觉得环境没配好的可能性大一点","user_name":"作者回复","user_name_real":"方远","uid":"2802608","ctime":1635586955,"ip_address":"","comment_id":319053,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1635528295","product_id":100093301,"comment_content":"老师好，我现在遇到一个问题，就是同一份代码，我在1.9.1中运行，会因为内存不足Kill掉，我开了htop和nvidia smi查看，一开始内存就直接拉满，下边的虚拟内存提示需要两倍的内存，然后GPU只用了五分之一还会横跳到0。一共300epochs 跑到第97-98epoch就会卡住不动，内存依旧拉满，六个CPU核心恢复正常状态，之前是一直拉满，然后GPU也恢复正常占用。我反复折腾了几次最后都只能强制关机。最后，我把环境换成1.5.1的版本，顺利跑完，只用了四百多秒。因为本身就是一个很简单的lstm网络，然后在新环境中内存占用一半多点，CPU全部拉满，GPU只用了五分之一多点。我想请问老师，我这种情况是为什么，版本区别这么大的吗？我遇到类似情况应该怎么排查，是不是我写的dataset部分有问题，因为本身数据量也不大，以mb计算的，网络更是很简单。对了，电脑配置CPU是i5-9600k，六核十二线程，GPU 2070单卡，内存16g。希望老师能指点迷津，非常感谢","like_count":0,"discussions":[{"author":{"id":2802608,"avatar":"https://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTK1ZkL9L7CEicI87xicpIhXAIhVdVWpJKBsD8Jpzg9iaAwFcDEhTvdRwuKItJS14mYznT2w2YQvn8QsQ/132","nickname":"方远","note":"","ucode":"248B1DE180EB4C","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":529476,"discussion_content":"你好，Swaggy，感谢你的留言。\n遇到这种问题我一般会这么排查。\n首先看看，PyTorch、CUDA以及显卡驱动的型号是不是都对上了。\n然后，看看，数据、模型、损失是否加cuda()了。\n你可以用watch命令看看nvidia-smi，网络比较小，如果只用nvidia-smi看的话，可能没有卡到利用率高的时候，因为通过你的描述我感觉没用到GPU。\n最后，给batch_size设置小一点看看。如果能确保在1.5.1中是用GPU训练的话，我觉得环境没配好的可能性大一点","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1635586955,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":318580,"user_name":"彭涛","can_delete":false,"product_type":"c1","uid":1890860,"ip_address":"","ucode":"86EACC03B46A37","user_header":"https://static001.geekbang.org/account/avatar/00/1c/da/2c/783413de.jpg","comment_is_top":false,"comment_ctime":1635339283,"is_pvip":false,"replies":[{"id":"115504","content":"你好，彭涛，谢谢你的留言。你重写__new__方法了吗？<br>如果是的话，可以试试删除重写。<br>如果还不好用的话，我需要看看代码的上下文信息。","user_name":"作者回复","user_name_real":"方远","uid":"2802608","ctime":1635343214,"ip_address":"","comment_id":318580,"utype":1}],"discussion_count":2,"race_medal":0,"score":"1635339283","product_id":100093301,"comment_content":"老师好，请问代码：<br>my_dataset = MyDataset(data_tensor, target_tensor)<br>报错：<br>TypeError: object.__new__() takes exactly one argument(the type to instantiate)<br>求解决方案，谢谢老师。","like_count":0,"discussions":[{"author":{"id":2802608,"avatar":"https://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTK1ZkL9L7CEicI87xicpIhXAIhVdVWpJKBsD8Jpzg9iaAwFcDEhTvdRwuKItJS14mYznT2w2YQvn8QsQ/132","nickname":"方远","note":"","ucode":"248B1DE180EB4C","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":529307,"discussion_content":"你好，彭涛，谢谢你的留言。你重写__new__方法了吗？\n如果是的话，可以试试删除重写。\n如果还不好用的话，我需要看看代码的上下文信息。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1635343214,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1890860,"avatar":"https://static001.geekbang.org/account/avatar/00/1c/da/2c/783413de.jpg","nickname":"彭涛","note":"","ucode":"86EACC03B46A37","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":532702,"discussion_content":"问题已解决，谢谢老师","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1637670129,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"user_type\":1}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":318385,"user_name":"夏阳","can_delete":false,"product_type":"c1","uid":2804801,"ip_address":"","ucode":"9392839CE55C22","user_header":"https://static001.geekbang.org/account/avatar/00/2a/cc/41/af863836.jpg","comment_is_top":false,"comment_ctime":1635264145,"is_pvip":false,"replies":[{"id":"115473","content":"你好，夏阳。感谢你的留言。<br>display的来源是：<br>from IPython.display import display<br>在jupyter中可以直接调用无需import。^^","user_name":"作者回复","user_name_real":"方远","uid":"2802608","ctime":1635295125,"ip_address":"","comment_id":318385,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1635264145","product_id":100093301,"comment_content":"我之前提的那个问题解决了。可能是因为我用的pycharm，显示Image图片的时候，需要用 image.show()函数。display（）函数不能正常显示图片。","like_count":0,"discussions":[{"author":{"id":2802608,"avatar":"https://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTK1ZkL9L7CEicI87xicpIhXAIhVdVWpJKBsD8Jpzg9iaAwFcDEhTvdRwuKItJS14mYznT2w2YQvn8QsQ/132","nickname":"方远","note":"","ucode":"248B1DE180EB4C","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":529217,"discussion_content":"你好，夏阳。感谢你的留言。\ndisplay的来源是：\nfrom IPython.display import display\n在jupyter中可以直接调用无需import。^^","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1635295125,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":318378,"user_name":"夏阳","can_delete":false,"product_type":"c1","uid":2804801,"ip_address":"","ucode":"9392839CE55C22","user_header":"https://static001.geekbang.org/account/avatar/00/2a/cc/41/af863836.jpg","comment_is_top":false,"comment_ctime":1635262157,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1635262157","product_id":100093301,"comment_content":"老师，这一段程序运行不了<br>display(mnist_dataset_list[0][0])<br>print(&quot;Image label is:&quot;, mnist_dataset_list[0][1])<br>反馈<br>NameError: name &#39;display&#39; is not defined","like_count":0},{"had_liked":false,"id":317785,"user_name":"BirthKnight","can_delete":false,"product_type":"c1","uid":2510165,"ip_address":"","ucode":"661C37DA320062","user_header":"","comment_is_top":false,"comment_ctime":1634965855,"is_pvip":false,"replies":[{"id":"115176","content":"你好，Geek_273c0b。感谢你的留言。在后面实战篇中的图像分类章节中，我们会模拟一个真实的项目，包括数据处理、模型训练、模型评估等，其中数据处理中就会讲解如何读取未做任何处理的原始图片数据。","user_name":"作者回复","user_name_real":"方远","uid":"2802608","ctime":1634988452,"ip_address":"","comment_id":317785,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1634965855","product_id":100093301,"comment_content":"老师您好。我尝试了下载MNIST数据集，然后把download设置为false，root设置为MNIST 下载文件的相对路径，发现无法找到。搜了下网上资料，发现torchvision在下载之后有一系列的预处理。老师能否讲下如何直接使用原生的MNIST数据集？","like_count":0,"discussions":[{"author":{"id":2802608,"avatar":"https://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTK1ZkL9L7CEicI87xicpIhXAIhVdVWpJKBsD8Jpzg9iaAwFcDEhTvdRwuKItJS14mYznT2w2YQvn8QsQ/132","nickname":"方远","note":"","ucode":"248B1DE180EB4C","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":528973,"discussion_content":"你好，Geek_273c0b。感谢你的留言。在后面实战篇中的图像分类章节中，我们会模拟一个真实的项目，包括数据处理、模型训练、模型评估等，其中数据处理中就会讲解如何读取未做任何处理的原始图片数据。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1634988452,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":317779,"user_name":"Sam Wang","can_delete":false,"product_type":"c1","uid":2804941,"ip_address":"","ucode":"CEBDCF5D448446","user_header":"","comment_is_top":false,"comment_ctime":1634961747,"is_pvip":false,"replies":[{"id":"115201","content":"你好，谢谢你的留言。<br>前后都有双下划线的函数是python的魔法函数。<br>那几个方法是在Dataset 类中定义的，<br>而我们继承 Dataset 类创建我们的Dataset的时候，至少需要重写那几个方法。关于前后都有双下划线函数的这块内容，你可以去看看Python有关的知识。^^","user_name":"作者回复","user_name_real":"方远","uid":"2802608","ctime":1635079205,"ip_address":"","comment_id":317779,"utype":1}],"discussion_count":2,"race_medal":0,"score":"1634961747","product_id":100093301,"comment_content":"为什么MyData中的两个method都用双前导和双末尾下划线？有什么约定吗还是编译不同？","like_count":0,"discussions":[{"author":{"id":2802608,"avatar":"https://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTK1ZkL9L7CEicI87xicpIhXAIhVdVWpJKBsD8Jpzg9iaAwFcDEhTvdRwuKItJS14mYznT2w2YQvn8QsQ/132","nickname":"方远","note":"","ucode":"248B1DE180EB4C","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":528968,"discussion_content":"你好，谢谢你的留言。\n前后都有双下划线的函数是python的魔法函数。\n那几个方法是在Dataset 类中定义的，\n而我们继承 Dataset 类创建我们的Dataset的时候，至少需要重写那几个方法。关于前后都有双下划线函数的这块内容，你可以去看看Python有关的知识。^^","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1635079205,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":2034680,"avatar":"https://static001.geekbang.org/account/avatar/00/1f/0b/f8/a9f695dc.jpg","nickname":"🚶","note":"","ucode":"527991CE01AF67","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":407476,"discussion_content":"魔法方法了解一下","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1635007357,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":317664,"user_name":"vcjmhg","can_delete":false,"product_type":"c1","uid":1526461,"ip_address":"","ucode":"B508D1E9B3F974","user_header":"http://thirdwx.qlogo.cn/mmopen/vi_32/j24oyxHcpB5AMR9pMO6fITqnOFVOncnk2T1vdu1rYLfq1cN6Sj7xVrBVbCvHXUad2MpfyBcE4neBguxmjIxyiaQ/132","comment_is_top":false,"comment_ctime":1634885484,"is_pvip":false,"replies":[{"id":"115173","content":"你好，vcjmhg，👍🏻👍🏻👍🏻👍🏻👍🏻。每次回答都很正确^^。加油~","user_name":"作者回复","user_name_real":"方远","uid":"2802608","ctime":1634988165,"ip_address":"","comment_id":317664,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1634885484","product_id":100093301,"comment_content":"应该继承torch.utils.data.Dataset类","like_count":0,"discussions":[{"author":{"id":2802608,"avatar":"https://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTK1ZkL9L7CEicI87xicpIhXAIhVdVWpJKBsD8Jpzg9iaAwFcDEhTvdRwuKItJS14mYznT2w2YQvn8QsQ/132","nickname":"方远","note":"","ucode":"248B1DE180EB4C","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":528921,"discussion_content":"你好，vcjmhg，👍🏻👍🏻👍🏻👍🏻👍🏻。每次回答都很正确^^。加油~","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1634988165,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":317621,"user_name":"IUniverse","can_delete":false,"product_type":"c1","uid":2620618,"ip_address":"","ucode":"077BB2291E25FA","user_header":"https://static001.geekbang.org/account/avatar/00/27/fc/ca/c1b8d9ca.jpg","comment_is_top":false,"comment_ctime":1634871060,"is_pvip":false,"replies":[{"id":"115174","content":"你好，IUniverse。感谢你留言。👍🏻👍🏻👍🏻👍🏻👍🏻答案是正确的^^。加油~","user_name":"作者回复","user_name_real":"方远","uid":"2802608","ctime":1634988200,"ip_address":"","comment_id":317621,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1634871060","product_id":100093301,"comment_content":"要继承Dataset类","like_count":0,"discussions":[{"author":{"id":2802608,"avatar":"https://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTK1ZkL9L7CEicI87xicpIhXAIhVdVWpJKBsD8Jpzg9iaAwFcDEhTvdRwuKItJS14mYznT2w2YQvn8QsQ/132","nickname":"方远","note":"","ucode":"248B1DE180EB4C","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":528905,"discussion_content":"你好，IUniverse。感谢你留言。👍🏻👍🏻👍🏻👍🏻👍🏻答案是正确的^^。加油~","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1634988200,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":317599,"user_name":"lwg0452","can_delete":false,"product_type":"c1","uid":1853479,"ip_address":"","ucode":"0B58A1C80F9074","user_header":"http://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTKyEJx6dG2dMuMz6swdfjNuw3HMoEAbtxprfdBUAyRpLFayxmwEiaYLs224LuAdwWu55ENLgsI8U4w/132","comment_is_top":false,"comment_ctime":1634867743,"is_pvip":false,"replies":[{"id":"115175","content":"你好，lwg0452。👍🏻👍🏻👍🏻👍🏻👍🏻👍🏻，每次的答案都非常正确^^。加油~","user_name":"作者回复","user_name_real":"方远","uid":"2802608","ctime":1634988267,"ip_address":"","comment_id":317599,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1634867743","product_id":100093301,"comment_content":"torch.utils.data.Dataset类","like_count":0,"discussions":[{"author":{"id":2802608,"avatar":"https://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTK1ZkL9L7CEicI87xicpIhXAIhVdVWpJKBsD8Jpzg9iaAwFcDEhTvdRwuKItJS14mYznT2w2YQvn8QsQ/132","nickname":"方远","note":"","ucode":"248B1DE180EB4C","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":528891,"discussion_content":"你好，lwg0452。👍🏻👍🏻👍🏻👍🏻👍🏻👍🏻，每次的答案都非常正确^^。加油~","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1634988267,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]}]}