{"id":562786,"title":"18ï½œRISC-VæŒ‡ä»¤ç²¾è®²ï¼ˆä¸‰ï¼‰ï¼šè·³è½¬æŒ‡ä»¤å®ç°ä¸è°ƒè¯•","content":"<p>ä½ å¥½ï¼Œæˆ‘æ˜¯LMOSã€‚</p><p>åœ¨<a href=\"https://time.geekbang.org/column/article/546957\">ç¬¬äº”èŠ‚è¯¾</a>ï¼Œæˆ‘ä»¬æ›¾ç»æåˆ°RV32Iæœ‰ä¸¤ç§è·³è½¬æŒ‡ä»¤ï¼Œå³æ— æ¡ä»¶è·³è½¬æŒ‡ä»¤å’Œæœ‰æ¡ä»¶çš„è·³è½¬æŒ‡ä»¤ã€‚</p><p>ä¸è¿‡ï¼Œå‰é¢æˆ‘ä»¬åªæ˜¯ç®€å•äº†è§£äº†è·³è½¬æŒ‡ä»¤é•¿ä»€ä¹ˆæ ·ï¼Œå¹¶æ²¡æœ‰æ·±å…¥è®²è§£ã€‚æ¥ä¸‹æ¥çš„ä¸¤èŠ‚è¯¾ï¼Œæˆ‘ä»¬å°±å¥½å¥½ç ”ç©¶ä¸€ä¸‹è·³è½¬æŒ‡ä»¤çš„åŸç†ï¼ŒæŒ¨ä¸ªæŒ‡ä»¤åšè°ƒè¯•ã€‚</p><p>è¿™èŠ‚è¯¾æˆ‘ä»¬ä»æºå¤´è¯´èµ·ï¼Œå¼„æ˜ç™½ä¸ºä»€ä¹ˆéœ€è¦æœ‰è·³è½¬æŒ‡ä»¤å­˜åœ¨ï¼Œç„¶åå†ç†Ÿæ‚‰ä¸€ä¸‹æ— æ¡ä»¶è·³è½¬æŒ‡ä»¤ã€‚è‡³äºæœ‰æ¡ä»¶è·³è½¬æŒ‡ä»¤ï¼Œæˆ‘ä»¬æ”¾åœ¨ä¸‹èŠ‚è¯¾ç»§ç»­å­¦ä¹ ã€‚è¿™èŠ‚è¯¾ä»£ç ï¼Œä½ å¯ä»¥ä»<a href=\"https://gitee.com/lmos/Geek-time-computer-foundation/tree/master/lesson18~19\">è¿™é‡Œ</a>ä¸‹è½½ã€‚</p><h2>ä¸ºä»€ä¹ˆè¦æœ‰è·³è½¬æŒ‡ä»¤</h2><p>æˆ‘ä»¬ä¸å¦¨å›å¿†ä¸€ä¸‹ï¼šCè¯­è¨€ä¸­ifã€forã€gotoç­‰æµç¨‹æ§åˆ¶è¯­å¥éƒ½æ˜¯å¦‚ä½•å®ç°çš„ï¼Ÿè¿˜æœ‰Cè¯­è¨€çš„å‡½æ•°æ˜¯å¦‚ä½•è°ƒç”¨å’Œè¿”å›çš„ï¼Ÿ</p><p>é€šè¿‡å‰é¢çš„å­¦ä¹ ï¼Œæˆ‘ä»¬äº†è§£åˆ°CPUæ‰§è¡ŒæŒ‡ä»¤æ˜¯ç”±PCå¯„å­˜å™¨æŒ‡å‘çš„ã€‚æ¯æ¬¡æ‰§è¡Œå®ŒæŒ‡ä»¤ï¼ŒCPUçš„PCå¯„å­˜å™¨å°±ä¼šè‡ªåŠ¨å¢åŠ ä¸€æ¡æŒ‡ä»¤å¤§å°çš„æ•°å€¼ï¼Œä½¿ä¹‹æŒ‡å‘ä¸‹ä¸€æ¡æŒ‡ä»¤ï¼Œå¦‚æ­¤å¾ªç¯ï¼Œè¿™å°±å¯¼è‡´CPUåªèƒ½åœ¨PCå¯„å­˜å™¨çš„å¼•å¯¼ä¸‹é¡ºåºåœ°æ‰§è¡ŒæŒ‡ä»¤ï¼Œè€ŒCè¯­è¨€å‡½æ•°å°±æ˜¯ä¸€æ¡æ¡æŒ‡ä»¤ç»„æˆçš„ã€‚æ˜¾ç„¶ï¼Œåªé è¿™æ ·çš„æœºåˆ¶ï¼ŒCè¯­è¨€æ— æ³•å®ç°æµç¨‹æ§åˆ¶å’Œå‡½æ•°çš„è°ƒç”¨ä¸è¿”å›ã€‚</p><p>å¦‚æœç°åœ¨æœ‰ä¸€ç§æœºåˆ¶ï¼Œå®ƒèƒ½å¤Ÿä¿®æ”¹CPUé‡ŒPCå¯„å­˜å™¨çš„å€¼ï¼Œæˆ–è€…æ ¹æ®ç‰¹å®šçš„æ¡ä»¶æ¥ä¿®æ”¹CPUçš„PCå¯„å­˜å™¨çš„å€¼ï¼Œè®©PCå¯„å­˜å™¨èƒ½æŒ‡å‘ç‰¹å®šçš„å†…å­˜åœ°å€ï¼Œè¯»å–é‡Œé¢çš„æŒ‡ä»¤å¹¶è¿è¡Œã€‚è¿™æ ·ï¼Œä¸Šè¿°é—®é¢˜å°±ä¼šè¿åˆƒè€Œè§£äº†ã€‚</p><!-- [[[read_end]]] --><p>è®©æˆ‘ç”¨ä¸€æ®µCè¯­è¨€ä»£ç ä¸ºä¾‹ï¼Œç»™ä½ åˆ†è§£ä¸€ä¸‹è¿™ä¸ªåŸç†ï¼Œå¦‚ä¸‹æ‰€ç¤ºï¼š</p><pre><code class=\"language-plain\">int add()\n{\n    int sum = 0;\n    for(int i = 0; i &lt; 100; i++)\n        sum++;\n    return sum;\n}\n</code></pre><p>ä¸Šè¿°ä»£ç ä¸­ï¼Œforå‡½æ•°åŒ…å«äº†æ¡ä»¶æµç¨‹æ§åˆ¶å’Œå¾ªç¯æµç¨‹æ§åˆ¶ã€‚åœ¨ç¼–è¯‘è¿‡ç¨‹ä¸­ï¼ŒCè¯­è¨€ç¼–è¯‘å™¨ä¼šå°†å®ƒæ‹†åˆ†ä¸ºä¸‰æ®µï¼Œä¼ªä»£ç å¦‚ä¸‹æ‰€ç¤ºï¼š</p><pre><code class=\"language-plain\">add:\n    int sum = 0;\n    int i = 0;\nlabel1:\n    i &lt; 100 = false goto lable2\n    sum++;\n    i++;\n    goto label1\nlable2:\n    return sum;\n</code></pre><p>ä»¥ä¸Šä¼ªä»£ç ä¸­çš„gotoç”¨æ¥ä¿®æ”¹CPUçš„PCå¯„å­˜å™¨çš„å€¼ï¼Œä½¿ä¹‹æŒ‡å‘lable1æˆ–è€…lable2ï¼Œè¿™æ ·CPUæ‰èƒ½æ‰§è¡Œä¸åŒçš„ä»£ç æ®µï¼Œä»è€Œå®ç°æµç¨‹æ§åˆ¶ã€‚<strong>è¿™é‡Œçš„gotoè¯­å¥å°±å¯¹åº”ç€åé¢è¦è®²çš„è·³è½¬æŒ‡ä»¤ã€‚</strong></p><p>è¯´åˆ°è¿™é‡Œï¼Œå¦‚æœä½ èƒ½å†æ¬¡æƒ³èµ·å›¾çµæœºçš„è¯»å¤´åœ¨é‚£æ¡æ— é™çš„çº¸å¸¦ä¸Šè·³æ¥è·³å»çš„æƒ…æ™¯ï¼Œå°±è¯´æ˜ä½ å·²ç»æ·±åˆ»ç†è§£äº†ä»£ç çš„æ‰§è¡ŒåŸç†ã€‚</p><p><img src=\"https://static001.geekbang.org/resource/image/51/7b/51b1c0668bc479c53d7c382e27b5b27b.jpg?wh=1920x819\" alt=\"å›¾ç‰‡\"></p><h2>RISC-Vçš„è·³è½¬æŒ‡ä»¤æ ¼å¼</h2><p>å‰é¢æˆ‘ä»¬è¯´äº†ï¼ŒCPUå¿…é¡»ä¾èµ–æŸä¸ªæœºåˆ¶ä¿®æ”¹PCå¯„å­˜å™¨çš„å€¼ï¼Œè®©ç¨‹åºèƒ½å¤Ÿè·³è½¬æ‰§è¡Œï¼Œè¾¾åˆ°ç¨‹åºæµç¨‹æ§åˆ¶çš„ç›®çš„ã€‚</p><p>è¿™ä¸ªæœºåˆ¶ç¦»ä¸å¼€CPUæä¾›çš„è·³è½¬æŒ‡ä»¤ï¼Œåªè¦æ‰§è¡Œè·³è½¬æŒ‡ä»¤å°±èƒ½ä¿®æ”¹PCå¯„å­˜å™¨äº†ã€‚åœ¨ç ”ç©¶æ— æ¡ä»¶è·³è½¬æŒ‡ä»¤ä¹‹å‰ï¼Œæˆ‘ä»¬å…ˆæ¥çœ‹çœ‹RISC-Vçš„è·³è½¬æŒ‡ä»¤æ ¼å¼ï¼Œå®ƒå¯¹åº”çš„æ±‡ç¼–è¯­å¥æ ¼å¼å¦‚ä¸‹ï¼š</p><pre><code class=\"language-plain\">æŒ‡ä»¤åŠ©è®°ç¬¦ ç›®æ ‡å¯„å­˜å™¨ï¼Œæºæ“ä½œæ•°1ï¼Œæºæ“ä½œæ•°2\n</code></pre><p>å¯¹äºæ— æ¡ä»¶è·³è½¬æŒ‡ä»¤æ¥è¯´ï¼Œ<strong>æŒ‡ä»¤åŠ©è®°ç¬¦å¯ä»¥æ˜¯jalå’Œjalrï¼Œç›®æ ‡å¯„å­˜å™¨å¯ä»¥æ˜¯ä»»ä½•é€šç”¨å¯„å­˜å™¨ï¼Œè€Œæºæ“ä½œæ•°1å¯ä»¥æ˜¯ä»»ä½•é€šç”¨å¯„å­˜å™¨ï¼Œæºæ“ä½œæ•°2å¯ä»¥æ˜¯ä»»ä½•é€šç”¨å¯„å­˜å™¨å’Œç«‹å³æ•°ã€‚</strong></p><p>ä¸ºä»€ä¹ˆæ˜¯ç›®æ ‡å¯„å­˜å™¨è€Œä¸æ˜¯PCå¯„å­˜å™¨å‘¢ï¼Ÿç»§ç»­å¾€ä¸‹çœ‹ï¼Œæˆ‘ä¼šå¸¦ä½ æ‰¾åˆ°ç­”æ¡ˆã€‚</p><h2>æ— æ¡ä»¶è·³è½¬æŒ‡ä»¤ï¼šjalæŒ‡ä»¤</h2><p>æˆ‘ä»¬å…ˆæ¥çœ‹çœ‹jalæŒ‡ä»¤ï¼Œè¿™æ˜¯ä¸€æ¡æ— æ¡ä»¶çš„è·³è½¬å¹¶é“¾æ¥çš„æŒ‡ä»¤ã€‚å®ƒçš„æ±‡ç¼–ä»£ç ä¹¦å†™å½¢å¼å¦‚ä¸‹ï¼š</p><pre><code class=\"language-plain\">jal rdï¼Œimm\n#jal æ— æ¡ä»¶çš„è·³è½¬å¹¶é“¾æ¥çš„æŒ‡ä»¤\n#rd ç›®æ ‡å¯„å­˜å™¨\n#imm ç«‹å³æ•°\n</code></pre><p>ä¸Šè¿°ä»£ç ä¸­ï¼Œrdå¯ä»¥æ˜¯ä»»ä½•é€šç”¨å¯„å­˜å™¨ã€‚ç«‹å³æ•°immä¸º20ä½äºŒè¿›åˆ¶æ•°æ®ã€‚æœ‰çš„æ–‡æ¡£é‡Œä¼šæŠŠimmç§°ä¸ºåç§»ï¼Œä¸ºäº†è¯¾ç¨‹å‰åæ–‡çš„ä¸€è‡´æ€§ï¼Œæˆ‘ä»¬ç»§ç»­æ²¿ç”¨ç«‹å³æ•°çš„å«æ³•ã€‚</p><p>jalå®Œæˆçš„æ“ä½œç”¨ä¼ªä»£ç æè¿°å¦‚ä¸‹ï¼š</p><pre><code class=\"language-plain\">rd = pc + 4ï¼›\npc = pc + ç¬¦å·æ‰©å±•ï¼ˆimm &lt;&lt; 1ï¼‰\n</code></pre><p>å¯¹ç…§ä»£ç ä¸éš¾å‘ç°ï¼ŒjalæŒ‡ä»¤é¦–å…ˆæŠŠpc+4ï¼Œå³ä¸‹ä¸€æ¡æŒ‡ä»¤åœ°å€é€ç»™äº†rdï¼Œç„¶åæŠŠPCå¯„å­˜å™¨ä¸­çš„32ä½æ— ç¬¦å·æ•°æ®åŠ ä¸Šimm&lt;&lt;1ï¼Œå¹¶ä¸”è¿›è¡Œ<strong>ç¬¦å·ä½æ‰©å±•</strong>ï¼ˆå› ä¸ºæŒ‡ä»¤æ€»æ˜¯2æˆ–è€…4å­—èŠ‚åœ°å€å¯¹é½çš„ï¼Œæ‰€ä»¥æœ€ä½ä½æ°¸è¿œä¸º0ï¼‰ï¼Œå†é€ç»™PCå¯„å­˜å™¨ã€‚è¿™æ ·å°±å®ç°äº†ç¨‹åºçš„è·³è½¬ã€‚</p><p>æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬ä¸€èµ·å†™ä»£ç éªŒè¯ä¸€ä¸‹ã€‚</p><p>ä¸ºäº†æ–¹ä¾¿è°ƒè¯•ï¼Œæˆ‘ä»¬çš„ä»£ç ç»„ç»‡ç»“æ„æ˜¯è¿™æ ·çš„ï¼šå†™ä¸€ä¸ªmain.cæ–‡ä»¶ï¼Œåœ¨é‡Œé¢å†™ä¸Šmainå‡½æ•°ï¼Œå› ä¸ºè¿™æ˜¯é“¾æ¥å™¨æ‰€éœ€è¦çš„ã€‚ç„¶åæˆ‘ä»¬éœ€è¦å†å†™ä¸€ä¸ªjal.Sæ–‡ä»¶ï¼Œç”¨æ±‡ç¼–åœ¨é‡Œé¢å†™ä¸Šjal_inså‡½æ•°ã€‚</p><p>ç±»ä¼¼çš„æ“ä½œå‰é¢ä¸¤èŠ‚è¯¾åå¤è¯•éªŒè¿‡ï¼Œå°±ä¸è¿‡å¤šé‡å¤äº†ã€‚ä»£ç å¦‚ä¸‹æ‰€ç¤ºï¼š</p><pre><code class=\"language-plain\">.text\n.global jal_ins\njal_ins:\n    jal a0ï¼Œimm_l1              #a0=add x0ï¼Œx0ï¼Œx0çš„åœ°å€ï¼Œè·³è½¬åˆ°imm_l1åœ°å€å¤„å¼€å§‹è¿è¡Œ\n    add x0ï¼Œx0ï¼Œx0              #ç›¸å½“äºnopï¼Œä»€ä¹ˆä¹Ÿä¸åš\n    add x0ï¼Œx0ï¼Œx0\nimm_l1:\n    jal a0ï¼Œimm_l2              #a0=imm_l2çš„åœ°å€ï¼Œè·³è½¬åˆ°imm_l2åœ°å€å¤„å¼€å§‹è¿è¡Œ\nimm_l2:\n    jr ra                       #å‡½æ•°è¿”å›\n</code></pre><p>æˆ‘å·²ç»æŠŠjal_inså‡½æ•°ä¸ºä½ å†™å¥½äº†ã€‚ç¬¬ä¸€æ¡æŒ‡ä»¤è·³è½¬åˆ°imm_l1åœ°å€å¤„å¼€å§‹è¿è¡Œï¼Œa0å¯„å­˜å™¨ä¿å­˜ä¸‹ä¸€æ¡æŒ‡ä»¤çš„åœ°å€ï¼Œå³add x0ï¼Œx0ï¼Œx0çš„åœ°å€ã€‚</p><p>è¿™æ¡æŒ‡ä»¤æ²¡ä»€ä¹ˆå®é™…çš„å®ç°ï¼Œx0æ˜¯ä¸ªåªè¯»å¯„å­˜å™¨ï¼Œå§‹ç»ˆè¿”å›0ã€‚imm_l1åœ°å€å¤„åˆæ˜¯ä¸€æ¡è·³è½¬æŒ‡ä»¤ï¼Œè·³è½¬åˆ°jr raæŒ‡ä»¤åœ°å€ï¼Œå³imm_l2å¤„å¼€å§‹è¿è¡Œã€‚a0ç­‰äºimm_l2çš„åœ°å€ï¼Œä¹Ÿä¼šä½œä¸ºå‡½æ•°çš„è¿”å›å€¼è¿”å›ã€‚</p><p>ä½ å¯ä»¥ç”¨VSCodeæ‰“å¼€å·¥ç¨‹ç›®å½•ï¼ŒæŒ‰ä¸‹â€œF5â€é”®è°ƒè¯•ä¸€ä¸‹ã€‚é¦–å…ˆï¼Œæˆ‘ä»¬æŠŠæ–­ç‚¹åœåœ¨jal a0ï¼Œimm_l1 æŒ‡ä»¤å¤„ï¼Œæ•ˆæœå¦‚ä¸‹æ‰€ç¤ºï¼š</p><p><img src=\"https://static001.geekbang.org/resource/image/d9/eb/d9d8d6e9af31bfab42b1373e0ef4d8eb.jpg?wh=1920x1018\" alt=\"å›¾ç‰‡\"></p><p>ä¸Šå›¾ä¸­çš„çŠ¶æ€æ˜¯æ‰§è¡Œjal a0ï¼Œimm_l1æŒ‡ä»¤ä¹‹å‰ï¼Œpcå¯„å­˜å™¨æŒ‡å‘0x10174åœ°å€ï¼Œè¿™ä¸ªåœ°å€å¯¹åº”çš„æ­£æ˜¯è¿™æ¡jal a0ï¼Œ imm_l1æŒ‡ä»¤ã€‚</p><p>æˆ‘ä»¬ä¸€æ—¦å•æ­¥è°ƒè¯•ï¼Œç¨‹åºä»£ç å°±ä¼šè·³åˆ°jal a0ï¼Œimm_l2 æŒ‡ä»¤å¤„ï¼Œpc + 12 ç­‰äº0x10180ï¼Œa0ç­‰äº0x10178ï¼ŒçŠ¶æ€å¦‚ä¸‹æ‰€ç¤ºï¼š</p><p><img src=\"https://static001.geekbang.org/resource/image/03/48/0307336c210c4e3dayyc806b7b7e3048.jpg?wh=1920x1018\" alt=\"å›¾ç‰‡\"></p><p>æœä¸å…¶ç„¶ï¼Œa0ç­‰äº0x10178ï¼Œè€Œpcç­‰äº0x10180ï¼Œæ­£æ˜¯jal a0ï¼Œimm_l2æŒ‡ä»¤ã€‚</p><p>æˆ‘ä»¬ç»§ç»­åšå•æ­¥è°ƒè¯•ï¼Œç¨‹åºä»£ç ä¼šè·³åˆ°jr ra æŒ‡ä»¤å¤„ï¼Œpc + 4 ç­‰äº0x10184ï¼Œa0ä¹Ÿä¼šç­‰äº0x10184ï¼Œå­˜æ”¾jr ra æŒ‡ä»¤çš„åœ°å€ï¼Œè€Œa0ä½œä¸ºå‡½æ•°çš„è¿”å›å€¼è¿›è¡Œè¿”å›ï¼Œä¹Ÿå°±æ˜¯jal_inså‡½æ•°æœ€åä¸€æ¡æŒ‡ä»¤çš„åœ°å€ã€‚</p><p>æˆ‘ä»¬å†æ¬¡è¿›è¡Œå•æ­¥è°ƒè¯•ï¼Œç¨‹åºå°†ä¼šå›åˆ°mainå‡½æ•°ä¸­ï¼Œå¹¶æ‰“å°å‡ºè¿”å›å€¼ï¼Œå¦‚ä¸‹æ‰€ç¤ºï¼š</p><p><img src=\"https://static001.geekbang.org/resource/image/62/b0/62acdb4fb770706a6cd00aacb7b10fb0.jpg?wh=1920x1018\" alt=\"å›¾ç‰‡\"></p><p>å¯ä»¥çœ‹åˆ°ï¼Œä¸Šå›¾ä¸­è¾“å‡ºçš„ç»“æœç¡®å®æ˜¯ç¬¦åˆé¢„æœŸçš„ï¼Œè¿™è¯´æ˜jalæŒ‡ä»¤çš„åŠŸèƒ½ç¡®å®è·Ÿæˆ‘ä»¬å‰é¢æè¿°çš„ä¸€è‡´ï¼Œèƒ½å¤Ÿæ— æ¡ä»¶è·³è½¬å¹¶é“¾æ¥ã€‚</p><h2>æ— æ¡ä»¶è·³è½¬æŒ‡ä»¤ï¼šjalræŒ‡ä»¤</h2><p>è®©æˆ‘ä»¬åŠ æŠŠåŠ²ï¼åœ¨jal.Sæ–‡ä»¶ä¸­å†å†™ä¸€ä¸ªå‡½æ•°â€”â€”jalr_inså‡½æ•°ã€‚åœ¨è¿™ä¸ªå‡½æ•°ä¸­ï¼Œæˆ‘ä»¬ç”¨jalræŒ‡ä»¤å®ç°å‡½æ•°è°ƒç”¨ï¼Œå…·ä½“å°±æ˜¯ç»™jalr_inså‡½æ•°ä¼ é€’ä¸€ä¸ªå‡½æ•°æŒ‡é’ˆï¼Œé€šè¿‡è¿™ä¸ªå‡½æ•°æŒ‡é’ˆè°ƒç”¨è¿™ä¸ªå‡½æ•°ã€‚</p><p>å†™ä»£ç ä¹‹å‰ï¼Œæˆ‘ä»¬å…ˆæ¥äº†è§£ä¸€ä¸‹jalræŒ‡ä»¤ï¼Œå®ƒåŒæ ·æ˜¯ä¸€æ¡æ— æ¡ä»¶çš„è·³è½¬å¹¶é“¾æ¥çš„æŒ‡ä»¤ã€‚jalræŒ‡ä»¤ä¸jalæŒ‡ä»¤å­—é¢ä¸Šçš„ä¸åŒç‚¹ï¼Œæ— éå°±æ˜¯å¤šäº†ä¸€ä¸ªå­—æ¯â€œrâ€ï¼Œè¿™ä¸ªâ€œrâ€è¡¨ç¤ºå¯„å­˜å™¨ï¼Œç›¸å½“äºjalæŒ‡ä»¤çš„å¯„å­˜å™¨ç‰ˆæœ¬ï¼Œèƒ½å¤Ÿé€šè¿‡å¯„å­˜å™¨ä¼ é€’è·³è½¬åœ°å€ã€‚</p><p>jalrçš„æ±‡ç¼–ä»£ç ä¹¦å†™å½¢å¼å¦‚ä¸‹ï¼š</p><pre><code class=\"language-plain\">jalr rdï¼Œrs1ï¼Œimm\n#jalr æ— æ¡ä»¶çš„è·³è½¬å¹¶é“¾æ¥çš„æŒ‡ä»¤\n#rd ç›®æ ‡å¯„å­˜å™¨\n#rs æºå¯„å­˜å™¨1\n#imm ç«‹å³æ•°\n</code></pre><p>ä¸Šè¿°ä»£ç ä¸­rdã€rs1å¯ä»¥æ˜¯ä»»ä½•é€šç”¨å¯„å­˜å™¨ï¼Œç«‹å³æ•°immä¸º12ä½äºŒè¿›åˆ¶æ•°æ®ã€‚jalrå®Œæˆçš„æ“ä½œç”¨ä¼ªä»£ç æè¿°å¦‚ä¸‹ï¼š</p><pre><code class=\"language-plain\">rd = pc + 4ï¼›\npc = (rs1 + ç¬¦å·æ‰©å±•(imm &lt;&lt; 1)) &amp; 0xfffffffe\n</code></pre><p>å¯¹æ¯”ä¹‹åæˆ‘ä»¬ä¸éš¾å‘ç°ï¼Œä»¥ä¸Šä»£ç ä¸­å’Œjalç›¸åŒçš„åœ°æ–¹æ˜¯ï¼Œå¼€å§‹ç¬¬ä¸€æ­¥ç”±jalræŒ‡ä»¤æŠŠpc+4ï¼Œå³ä¸‹ä¸€æ¡æŒ‡ä»¤åœ°å€é€ç»™rdã€‚</p><p>è€Œä¸åŒä¹‹å¤„æ˜¯ï¼ŒjalræŒ‡ä»¤çš„ä¸‹ä¸€æ­¥æ“ä½œ<strong>ä¼šè®©rs1ä¸­çš„32ä½æ— ç¬¦å·æ•°æ®åŠ ä¸Šimm&lt;&lt;1ï¼Œå¹¶ä¸”è¿›è¡Œç¬¦å·ä½æ‰©å±•åä¸ä¸Š0xfffffffe</strong>ï¼Œè¿™ä¹Ÿæ˜¯ä¸ºäº†æŒ‡ä»¤è¦ä»¥2å­—èŠ‚æˆ–è€…4å­—èŠ‚åœ°å€å¯¹é½ï¼Œæ‰€ä»¥æœ€ä½ä½å¿…é¡»ä¸º0ï¼Œå½¢æˆä¸€ä¸ªåœ°å€å€¼ã€‚å®Œæˆä»¥ä¸Šè¿‡ç¨‹åï¼Œè¿™ä¸ªåœ°å€å€¼ä¼šé€ç»™pcï¼Œä»è€Œå®ç°ç¨‹åºçš„è·³è½¬ã€‚</p><p>ä¸‹é¢æˆ‘ä»¬ä¸€èµ·å†™ä»£ç éªŒè¯ä¸€ä¸‹ã€‚</p><pre><code class=\"language-plain\">.global jalr_ins\njalr_ins:\n    addi spï¼Œspï¼Œ-16            #åœ¨æ ˆä¸­åˆ†é…16å­—èŠ‚çš„ç©ºé—´\n    sw  raï¼Œ0(sp)               #ä¿å­˜raå¯„å­˜å™¨åˆ°æ ˆä¸­\n    jalr raï¼Œa0ï¼Œ0              #ra = lw raï¼Œ0(sp)æŒ‡ä»¤çš„åœ°å€ï¼Œè·³è½¬åˆ°a0+0çš„åœ°å€å¤„å¼€å§‹è¿è¡Œ\n    lw raï¼Œ0(sp)                #ä»æ ˆä¸­æ¢å¤raå¯„å­˜å™¨\n    addi spï¼Œspï¼Œ16             #å›æ”¶æ ˆä¸­åˆ†é…çš„16å­—èŠ‚çš„ç©ºé—´\n    jr ra                       #å‡½æ•°è¿”å›\n</code></pre><p>è¿™æ®µä»£ç 3~4è¡Œå’Œ6~7è¡Œä»£ç çš„ä½œç”¨æ˜¯ï¼Œåœ¨æ ˆä¸­åˆ†é…å’Œå›æ”¶å†…å­˜ç©ºé—´çš„æŒ‡ä»¤ï¼Œç”¨äºä¿å­˜å’Œæ¢å¤raå¯„å­˜å™¨çš„å†…å®¹ã€‚</p><p>å› ä¸ºåœ¨ç¬¬5è¡Œä»£ç ä¸­ï¼Œè·³è½¬åˆ«çš„ä»£ç ä¸­è¿è¡Œï¼Œæ­£æ˜¯ç”¨raå¯„å­˜å™¨æ¥ä¿å­˜åœ°å€çš„ï¼Œç„¶è€Œåœ¨è·³è½¬åˆ°jalr_inså‡½æ•°å¤„è¿è¡Œçš„æ—¶å€™ï¼ŒåŒæ ·æ˜¯ä½¿ç”¨raå¯„å­˜å™¨ä¿å­˜è¿”å›åœ°å€çš„ï¼Œå¦‚æœä¸ä¿å­˜å’Œæ¢å¤raå¯„å­˜å™¨ï¼Œjalr_inså‡½æ•°å°†æ— æ³•è¿”å›ã€‚</p><p>ç°åœ¨æˆ‘ä»¬è°ƒè¯•ä¸€ä¸‹ï¼Œå¦‚ä¸‹æ‰€ç¤ºï¼š</p><p><img src=\"https://static001.geekbang.org/resource/image/90/84/9052204ac3659c792d2839f578333684.jpg?wh=1920x1018\" alt=\"å›¾ç‰‡\"></p><p>ä¸Šå›¾ä¸­æ˜¯æ‰§è¡Œjalr raï¼Œa0ï¼Œ0æŒ‡ä»¤ä¹‹å‰çš„çŠ¶æ€ï¼Œa0å¯„å­˜å™¨ä¸­çš„å€¼æ˜¯0x101a0ï¼Œè¿™æ­£æ˜¯testjalrå‡½æ•°çš„åœ°å€ã€‚è¿™æ¡æŒ‡ä»¤èƒ½å®Œæˆç±»ä¼¼å‡½æ•°è°ƒç”¨çš„åŠŸèƒ½ï¼Œæˆ‘ä»¬ä¸€æ—¦å•æ­¥è°ƒè¯•ï¼Œç¨‹åºå°±ä¼šè·³åˆ°testjalrå‡½æ•°å†…éƒ¨å¼€å§‹è¿è¡Œï¼ŒçŠ¶æ€å¦‚ä¸‹æ‰€ç¤ºï¼š</p><p><img src=\"https://static001.geekbang.org/resource/image/81/b2/815d11b5e132d81394972f56faf873b2.jpg?wh=1920x1018\" alt=\"å›¾ç‰‡\"></p><p>ç”±ä¸Šå›¾å¯çŸ¥ï¼Œjalr_inså‡½æ•°ç¡®å®è°ƒç”¨äº†testjalrå‡½æ•°ï¼Œä¹Ÿæ‰“å°å‡ºäº†testjalrçš„åœ°å€ã€‚ä¸‹ä¸€æ­¥å°†è¦æ‰§è¡Œtestjalrå‡½æ•°çš„è¿”å›è¯­å¥ï¼Œä¼šè¿”å›jalr_inså‡½æ•°çš„åœ°å€ã€‚</p><p>æˆ‘ä»¬ç»§ç»­åšå•æ­¥è°ƒè¯•ï¼Œçœ‹çœ‹èƒ½ä¸èƒ½è¿”å›åˆ°jalr_inså‡½æ•°ä¸­ï¼Œå¦‚ä¸‹æ‰€ç¤ºï¼š</p><p><img src=\"https://static001.geekbang.org/resource/image/66/ac/662e31d923a22760226deac72f00fbac.jpg?wh=1920x1018\" alt=\"å›¾ç‰‡\"></p><p>è°ƒè¯•ç»“æœéªŒè¯äº†ç¡®å®å¦‚æ­¤ï¼Œä»£ç æµç¨‹å†æ¬¡å›åˆ°äº†jalr_inså‡½æ•°ä¸­ã€‚åœ¨jalr_inså‡½æ•°ä¸­ï¼Œæˆ‘ä»¬æ¢å¤äº†ä¹‹å‰çš„raå¯„å­˜å™¨ï¼Œa0å¯„å­˜å™¨ä¸­ä¿å­˜ç€testjalrå‡½æ•°çš„è¿”å›å€¼ï¼Œå³jalr_inså‡½æ•°çš„åœ°å€ã€‚</p><p>ç»§ç»­å•æ­¥è°ƒè¯•ï¼Œä»£ç æµç¨‹å°±ä¼šå›åˆ°mainå‡½æ•°ã€‚</p><p><img src=\"https://static001.geekbang.org/resource/image/ce/8c/cefedce2892f208a06b5yy1b07b85a8c.jpg?wh=1920x1018\" alt=\"å›¾ç‰‡\"></p><p>å¦‚ä¸Šå›¾æ‰€ç¤ºï¼Œmainå‡½æ•°ä¸­ç»§ç»­æ‰“å°å‡ºäº†jalr_inså‡½æ•°çš„åœ°å€ï¼Œè¿™ä¸ªç»“æœæ˜¯æ­£ç¡®çš„ï¼Œä»£ç æµç¨‹ä¹Ÿç¬¦åˆé¢„æœŸã€‚</p><p>é€šè¿‡è°ƒè¯•ï¼Œæˆ‘ä»¬å·²ç»äº†è§£äº†jalã€jalræŒ‡ä»¤çš„åŠŸèƒ½ç»†èŠ‚ã€‚</p><p>ä¸‹é¢ï¼Œæˆ‘ä»¬æ¥çœ‹çœ‹jal_inså‡½æ•°å’Œjalr_inså‡½æ•°çš„äºŒè¿›åˆ¶æ•°æ®ã€‚å…¶å®æˆ‘ä»¬è°ƒè¯•bugæˆ–è€…åšé€†å‘å·¥ç¨‹ï¼Œå¾ˆå¤šæ—¶å€™éƒ½éœ€è¦ç ”ç©¶æœºå™¨ç ï¼Œæ­£å¥½å€Ÿè¿™æ¬¡ç ”ç©¶æŒ‡ä»¤çš„æœºä¼šï¼Œæˆ‘ä»¬ä¸€èµ·ç»ƒä¹ ä¸€ä¸‹æ€ä¹ˆåˆ†æã€‚</p><p>æˆ‘ä»¬æ‰“å¼€ç»ˆç«¯ï¼Œåˆ‡æ¢åˆ°å·¥ç¨‹ç›®å½•ä¸‹ï¼Œè¾“å…¥å‘½ä»¤ï¼šriscv64-unknown-elf-objdump -d ./main.elf &gt; ./main.insï¼Œå°±ä¼šå¾—åˆ°main.elfçš„åæ±‡ç¼–æ•°æ®æ–‡ä»¶main.insã€‚æ‰“å¼€è¿™ä¸ªæ–‡ä»¶ï¼Œå°±ä¼šçœ‹åˆ°jal_inså‡½æ•°å’Œjalr_inså‡½æ•°çš„äºŒè¿›åˆ¶æ•°æ®ï¼Œæˆ‘çš„æ“ä½œæˆªå›¾å¦‚ä¸‹æ‰€ç¤ºï¼š</p><p><img src=\"https://static001.geekbang.org/resource/image/51/10/51b0de8f80708709d25dfa463ae9d310.jpg?wh=1920x1018\" alt=\"å›¾ç‰‡\"></p><p>ä¸Šå›¾ä¸­çš„åæ±‡ç¼–ä»£ç ä¸­ä½¿ç”¨äº†ä¸€äº›ä¼ªæŒ‡ä»¤ï¼Œæ¯”å¦‚retçš„æœºå™¨ç æ˜¯0x00008067ï¼Œå®ƒå°±æ˜¯jr raï¼Œä½†æ˜¯jr raä¹Ÿæ˜¯ä¼ªæŒ‡ä»¤ï¼Œå®é™…çš„æŒ‡ä»¤æ˜¯jalr x0ï¼Œraï¼Œ0æŒ‡ä»¤ï¼Œä¼ªæŒ‡ä»¤æ˜¯ä¸ºäº†æ–¹ä¾¿æ±‡ç¼–ç¼–ç¨‹äººå‘˜æ‰ä½¿ç”¨çš„ã€‚</p><p>æˆ‘ä»¬å†æ¥è¯´è¯´ä¸Šå›¾ä¸­çš„æœºå™¨ç ï¼Œ0x0040056fä¸ºjal a0ï¼Œimm_l2ï¼ˆ0x10184ï¼‰ï¼Œ0x000500e7ä¸ºjalr raï¼Œa0ï¼Œ0ï¼Œå›¾é‡Œçš„jalr a0å°±æ˜¯jalr raï¼Œa0ï¼Œ0 ã€‚</p><p>æˆ‘ä»¬ç»§ç»­æ‹†åˆ†jalæŒ‡ä»¤å’ŒjalræŒ‡ä»¤çš„å„ä½æ®µçš„æ•°æ®ï¼Œçœ‹çœ‹å®ƒä»¬å…·ä½“æ˜¯å¦‚ä½•ç¼–ç çš„ã€‚ä½ ä¸å¦¨ç»“åˆåé¢çš„ç¤ºæ„å›¾æ¥ç†è§£ï¼š</p><p><img src=\"https://static001.geekbang.org/resource/image/9c/fd/9cd3052dd467580b88fa996d71d4c4fd.jpg?wh=1920x1246\" alt=\"å›¾ç‰‡\"></p><p>jalæŒ‡ä»¤ä¸jalræŒ‡ä»¤æ˜¯é æ“ä½œç åŒºåˆ†çš„ã€‚jalæŒ‡ä»¤çš„ç«‹å³æ•°éƒ¨åˆ†ç¼–ç éå¸¸ä¹±ï¼Œè¿™éƒ¨åˆ†è·ŸèŠ¯ç‰‡è®¾è®¡æœ‰å…³ï¼Œå°±ä¸æ·±å…¥è®¨è®ºäº†ï¼Œå…¶æ•°æ®æ­£å¸¸ç»„åˆèµ·æ¥æ˜¯0b00000000000000000010ï¼Œè¿™ä¸ªäºŒè¿›åˆ¶æ•°æ®å·¦ç§»1ä½ç­‰äºåå…­è¿›åˆ¶æ•°æ®0x4ã€‚ä¸ºä»€ä¹ˆæ˜¯è¿™æ ·å‘¢ï¼Ÿ</p><p>å›åˆ°å‰é¢çœ‹çœ‹jalæŒ‡ä»¤çš„æ“ä½œï¼Œä½ å°±æ˜ç™½äº†ï¼š<strong>pc+4æ­£å¥½æ˜¯imm_l2çš„åœ°å€å³0x10184ï¼Œè€ŒjalræŒ‡ä»¤ç¼–ç éå¸¸ç®€å•ï¼Œ12ä½ç«‹å³æ•°ä¸º0ï¼Œæºå¯„å­˜å™¨æ˜¯a0ï¼Œç›®æ ‡å¯„å­˜å™¨æ˜¯raï¼Œx1å¯„å­˜å™¨çš„ç¼–ç å°±æ˜¯1ã€‚</strong></p><p>åˆ°è¿™é‡Œï¼ŒjalæŒ‡ä»¤ä¸jalræŒ‡ä»¤æˆ‘ä»¬å°±è®²å®Œäº†ã€‚å®ƒä»¬éƒ½æ˜¯æ— æ¡ä»¶è·³è½¬æŒ‡ä»¤ï¼Œå¹¶ä¸”éƒ½å¯ä»¥ä¿å­˜è·³è½¬æŒ‡ä»¤çš„ä¸‹ä¸€æ¡æŒ‡ä»¤çš„åœ°å€ï¼Œç”¨äºè¿”å›ã€‚ä½†jalæŒ‡ä»¤ä¸jalræŒ‡ä»¤è·³è½¬çš„åœ°å€å¤§å°èŒƒå›´æœ‰å·®åˆ«ï¼Œè¿™ä¸»è¦å–å†³äºå®ƒä»¬åœ°å€æ•°æ®çš„ç¼–ç å½¢å¼å’Œè®¡ç®—æ–¹å¼ã€‚jalæŒ‡ä»¤æ˜¯ç”¨å½“å‰pcå€¼åŠ ä¸Š20ä½ç«‹å³æ•°ï¼ŒjalræŒ‡ä»¤æ˜¯é€šç”¨å¯„å­˜å™¨åŠ ä¸Š11ä½ç«‹å³æ•°ã€‚</p><h2>é‡ç‚¹å›é¡¾</h2><p>è¯´åˆ°è¿™é‡Œï¼Œè¿™èŠ‚è¯¾çš„å†…å®¹å°±å‘Šä¸€æ®µè½äº†ï¼Œæˆ‘æ¥ç»™ä½ åšä¸ªæ€»ç»“ã€‚</p><p>å› ä¸ºä¸ç®¡ä»€ä¹ˆç¨‹åºéƒ½ä¸èƒ½æ°¸æ— æ­¢å¢ƒåœ°é¡ºåºè¿è¡Œä¸‹å»ï¼Œæ‰€ä»¥éœ€è¦æ§åˆ¶ç¨‹åºæµç¨‹ï¼Œå¯¹æ•°æ®è¿›è¡Œæ¯”è¾ƒåˆ¤æ–­ï¼Œæ ¹æ®ç»“æœæ‰§è¡Œç›¸åº”çš„åŠ¨ä½œã€‚è¿™å°±éœ€è¦ç¨‹åºèƒ½å¤Ÿè·³è½¬ï¼Œæ‰€ä»¥ï¼Œä¸€å¥—æŒ‡ä»¤é›†é‡Œå°±å¿…é¡»è¦æœ‰è·³è½¬æŒ‡ä»¤æ¥æ”¯æŒã€‚</p><p>è·³è½¬æŒ‡ä»¤åˆåˆ†æˆæœ‰æ¡ä»¶è·³è½¬æŒ‡ä»¤å’Œæ— æ¡ä»¶è·³è½¬æŒ‡ä»¤ã€‚æˆ‘ä»¬æŒ‰ç…§å…ˆæ˜“åéš¾çš„é¡ºåºï¼Œè¿™èŠ‚è¯¾é‡ç‚¹ç ”ç©¶äº†æ— æ¡ä»¶çš„è·³è½¬æŒ‡ä»¤ï¼Œä¸€å…±æ˜¯ä¸¤æ¡æŒ‡ä»¤ï¼Œå³jalæŒ‡ä»¤å’ŒjalræŒ‡ä»¤ã€‚å®ƒä»¬åœ¨è·³è½¬çš„åŒæ—¶è¿˜èƒ½ä¿å­˜ä¸‹ä¸€æ¡æŒ‡ä»¤çš„åœ°å€ï¼Œè¿™ç±»æŒ‡ä»¤å¸¸ç”¨æ¥å®ç°é«˜çº§è¯­è¨€ï¼ˆå¦‚Cè¯­è¨€ï¼‰é‡Œçš„å‡½æ•°è°ƒç”¨ã€‚</p><p>è¿™èŠ‚è¯¾çš„è¦ç‚¹æˆ‘ç»™ä½ å‡†å¤‡äº†å¯¼å›¾ï¼Œä½ å¯ä»¥åšä¸ªå‚è€ƒã€‚è°ƒè¯•éªŒè¯ç¯èŠ‚ï¼Œæˆ‘å»ºè®®ä½ è‡ªå·±è¯¾ååŠ¨æ‰‹å¤šå¤šç»ƒä¹ ï¼ŒåŠ æ·±å°è±¡ã€‚</p><p><img src=\"https://static001.geekbang.org/resource/image/f9/eb/f9cd469ec5ed0bf565e43c1b2de015eb.jpg?wh=1920x1670\" alt=\"å›¾ç‰‡\"></p><p>ä¸‹èŠ‚è¯¾æˆ‘ä»¬ç»§ç»­ç ”ç©¶æœ‰æ¡ä»¶è·³è½¬æŒ‡ä»¤ï¼Œæ•¬è¯·æœŸå¾…ã€‚</p><h2>æ€è€ƒé¢˜</h2><p>æ—¢ç„¶å·²ç»æœ‰jalæŒ‡ä»¤äº†ï¼Œä¸ºä»€ä¹ˆè¿˜éœ€è¦jalræŒ‡ä»¤å‘¢ï¼Ÿ</p><p>æœŸå¾…ä½ åœ¨ç•™è¨€åŒºè®°å½•æ”¶è·æˆ–ç–‘é—®ï¼Œè®¤çœŸæ€è€ƒå’Œä¸»åŠ¨ç»ƒä¹ éƒ½èƒ½è®©ä½ åŠ æ·±å°è±¡ã€‚å¦‚æœæ„Ÿè§‰è¿™èŠ‚è¯¾è¿˜ä¸é”™ï¼Œä¹Ÿæ¨èä½ æŠŠè¿™èŠ‚è¯¾åˆ†äº«ç»™æ›´å¤šæœ‹å‹ã€‚</p>","neighbors":{"left":{"article_title":"17ï½œRISC-VæŒ‡ä»¤ç²¾è®²ï¼ˆäºŒï¼‰ï¼šç®—æœ¯æŒ‡ä»¤å®ç°ä¸è°ƒè¯•","id":561904},"right":{"article_title":"19ï½œRISC-VæŒ‡ä»¤ç²¾è®²ï¼ˆå››ï¼‰ï¼šè·³è½¬æŒ‡ä»¤å®ç°ä¸è°ƒè¯•","id":564716}},"comments":[{"had_liked":false,"id":356868,"user_name":"LockedX","can_delete":false,"product_type":"c1","uid":1683139,"ip_address":"æ¹–åŒ—","ucode":"19B82B910FC67F","user_header":"https://static001.geekbang.org/account/avatar/00/19/ae/c3/d930693b.jpg","comment_is_top":false,"comment_ctime":1662654193,"is_pvip":false,"replies":[{"id":129926,"content":"å˜¿å˜¿ æ˜¯çš„ ","user_name":"ä½œè€…å›å¤","user_name_real":"ç¼–è¾‘","uid":1345199,"ctime":1662884657,"ip_address":"æ¹–åŒ—","comment_id":356868,"utype":1}],"discussion_count":1,"race_medal":0,"score":2,"product_id":100117801,"comment_content":"jalæŒ‡ä»¤åªèƒ½è·³è½¬åŸºäºpcå¯„å­˜å™¨çš„åœ°å€ï¼Œå³pc+x\nè€Œjalrå¯ä»¥è·³è½¬åˆ°è‡ªå®šä¹‰å¯„å­˜å™¨çš„åœ°å€ï¼Œæ›´åŠ çµæ´»","like_count":1,"discussions":[{"author":{"id":1345199,"avatar":"https://static001.geekbang.org/account/avatar/00/14/86/af/99219321.jpg","nickname":"LMOS","note":"","ucode":"B037712C8B8B3C","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":587208,"discussion_content":"å˜¿å˜¿ æ˜¯çš„ ","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1662884657,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"æ¹–åŒ—","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":356517,"user_name":"è‹æµéƒå®“","can_delete":false,"product_type":"c1","uid":2729645,"ip_address":"æ¹–åŒ—","ucode":"AD07BD9CE03047","user_header":"https://static001.geekbang.org/account/avatar/00/29/a6/ad/e65aec4c.jpg","comment_is_top":false,"comment_ctime":1662376037,"is_pvip":false,"replies":[{"id":129931,"content":"å¯¹å•Š ä½ æ€è€ƒçš„å¾ˆæ·±å…¥","user_name":"ä½œè€…å›å¤","user_name_real":"ç¼–è¾‘","uid":1345199,"ctime":1662885228,"ip_address":"æ¹–åŒ—","comment_id":356517,"utype":1}],"discussion_count":1,"race_medal":0,"score":2,"product_id":100117801,"comment_content":"jalrå¤šäº†ä¸€ä¸ªæºå¯„å­˜å™¨ï¼Œæ—¢å¯ä»¥ä¸jaläº¤æ¢ä½¿ç”¨ç»„æˆç±»ä¼¼åç§»åœ°å€åŠ åŸºåœ°å€è¿›è¡Œåˆ†é¡µè·³è½¬ï¼ˆæ¨¡ä»¿x86ï¼Œå¯4kbä¸€ä¸ªåˆ†é¡µï¼‰ï¼Œè¿˜æœ‰ä¸€ä¸ªé‡è¦åŠŸèƒ½å°±æ˜¯ï¼Œjalrçš„ç«‹å³æ•°å¯å˜ä¸ºjalçš„æ“ä½œç åŠ ç›®æ ‡å¯„å­˜å™¨ï¼ˆå®ç°jalr-jalï¼‰ï¼Œjalçš„ç«‹å³æ•°å¯å˜ä¸ºjalrçš„æ“ä½œç åŠ ç›®æ ‡å¯„å­˜å™¨åŠ åŠŸèƒ½åŠ æºå¯„å­˜å™¨ï¼\nè¿™æ ·è®¾è®¡çš„å¥½å¤„æ–¹ä¾¿cpuè‡ªåŠ¨åŒ–ï¼Œæå‡æ•ˆç‡ï¼ˆæµæ°´çº¿ä¸åœè½¬ï¼Œäº¤æ›¿ä½¿ç”¨å‡å°‘å»å†…å­˜å–æŒ‡ä»¤æµªè´¹çš„æ—¶é—´ï¼Œæ–¹ä¾¿ä¸€æ¬¡æ€§æ‰§è¡Œå®Œä¸€ä¸ªç»†åˆ†é¡¹ç›®ï¼Œå¦‚çº¿ç¨‹ï¼‰","like_count":1,"discussions":[{"author":{"id":1345199,"avatar":"https://static001.geekbang.org/account/avatar/00/14/86/af/99219321.jpg","nickname":"LMOS","note":"","ucode":"B037712C8B8B3C","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":587214,"discussion_content":"å¯¹å•Š ä½ æ€è€ƒçš„å¾ˆæ·±å…¥","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1662885229,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"æ¹–åŒ—","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":363326,"user_name":"è´ºå®¾","can_delete":false,"product_type":"c1","uid":1338509,"ip_address":"æ¹–åŒ—","ucode":"197FF6EE194758","user_header":"https://static001.geekbang.org/account/avatar/00/14/6c/8d/9387b732.jpg","comment_is_top":false,"comment_ctime":1669540544,"is_pvip":false,"replies":[{"id":132461,"content":"éœ€è¦ç¬¦å·  jal.S ä¸­ ä½ è®¾ç½®åœ¨æ ‡å·å¤„å°±è¡Œäº† ","user_name":"ä½œè€…å›å¤","user_name_real":"ç¼–è¾‘","uid":1345199,"ctime":1670922761,"ip_address":"æ¹–åŒ—","comment_id":363326,"utype":1}],"discussion_count":1,"race_medal":0,"score":2,"product_id":100117801,"comment_content":"ä¸ºä»€ä¹ˆåœ¨æˆ‘çš„main.cæ–‡ä»¶ä¸­èƒ½è®¾ç½®æ–­ç‚¹ï¼Œè€Œåœ¨jal.S ä¸­å´ä¸èƒ½è®¾ç½®æ–­ç‚¹ï¼Œéœ€è¦åœ¨vscodeä¸­å®‰è£…ä»€ä¹ˆæ’ä»¶å—ï¼Ÿ","like_count":0,"discussions":[{"author":{"id":1345199,"avatar":"https://static001.geekbang.org/account/avatar/00/14/86/af/99219321.jpg","nickname":"LMOS","note":"","ucode":"B037712C8B8B3C","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":596373,"discussion_content":"éœ€è¦ç¬¦å·  jal.S ä¸­ ä½ è®¾ç½®åœ¨æ ‡å·å¤„å°±è¡Œäº† ","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1670922761,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"æ¹–åŒ—","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":357497,"user_name":"å—åŸå¿†æ½‡æ¹˜","can_delete":false,"product_type":"c1","uid":2738376,"ip_address":"æ¹–åŒ—","ucode":"95E0584C71BD7C","user_header":"https://static001.geekbang.org/account/avatar/00/29/c8/c8/d23a126b.jpg","comment_is_top":false,"comment_ctime":1663314229,"is_pvip":false,"replies":[{"id":130126,"content":"é“¾æ¥å™¨æ ¹æ® æŒ‡ä»¤å¤§å° è®¡ç®—çš„ ","user_name":"ä½œè€…å›å¤","user_name_real":"ç¼–è¾‘","uid":1345199,"ctime":1663395596,"ip_address":"æ¹–åŒ—","comment_id":357497,"utype":1}],"discussion_count":1,"race_medal":0,"score":2,"product_id":100117801,"comment_content":"è€å¸ˆï¼Œè¯·æ•™ä¸‹ï¼Œ    â€œæˆ‘ä»¬ä¸€æ—¦å•æ­¥è°ƒè¯•ï¼Œç¨‹åºä»£ç å°±ä¼šè·³åˆ° jal a0ï¼Œimm_l2 æŒ‡ä»¤å¤„ï¼Œpc + 12 ç­‰äº 0x10180ï¼Œa0 ç­‰äº 0x10178ï¼Œâ€  è¿™ä¸€å¥ä¸­çš„12æ˜¯æ€ä¹ˆè®¡ç®—çš„ï¼Œè·Ÿå‰é¢è¯´çš„ç¬¦å·æ‰©å±•æ€ä¹ˆå¯¹åº”çš„ï¼Œè¿™ä¸€ç‚¹æ²¡ææ˜ç™½ï¼Œ ï¼ˆ â€œpc = pc + ç¬¦å·æ‰©å±•ï¼ˆimm &lt;&lt; 1ï¼‰â€ï¼‰  è¿™é‡Œçš„immæ˜¯ä»€ä¹ˆï¼Œå·¦ç§»äº†ä¸€ä½ï¼Œæ˜¯immå·¦ç§»ä¸€ä½å˜æˆäº†12å—ï¼Œæˆ‘æ˜¯ç¡¬çœ‹çš„æ±‡ç¼–ä»£ç ä¸­é—´éš”äº†3æ¡æŒ‡ä»¤è¦åç§»12","like_count":0,"discussions":[{"author":{"id":1345199,"avatar":"https://static001.geekbang.org/account/avatar/00/14/86/af/99219321.jpg","nickname":"LMOS","note":"","ucode":"B037712C8B8B3C","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":587925,"discussion_content":"é“¾æ¥å™¨æ ¹æ® æŒ‡ä»¤å¤§å° è®¡ç®—çš„ ","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1663395597,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"æ¹–åŒ—","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":356442,"user_name":"TableBear","can_delete":false,"product_type":"c1","uid":1673990,"ip_address":"æ¹–åŒ—","ucode":"A2C0562EEA2725","user_header":"https://static001.geekbang.org/account/avatar/00/19/8b/06/fb3be14a.jpg","comment_is_top":false,"comment_ctime":1662314731,"is_pvip":false,"replies":[{"id":129934,"content":"å¯¹çš„","user_name":"ä½œè€…å›å¤","user_name_real":"ç¼–è¾‘","uid":1345199,"ctime":1662885311,"ip_address":"æ¹–åŒ—","comment_id":356442,"utype":1}],"discussion_count":1,"race_medal":0,"score":2,"product_id":100117801,"comment_content":"è¯¾åæ€è€ƒé¢˜ï¼š\njalçš„ç«‹å³æ•°åªæœ‰20ä½ï¼ŒåŠ ä¸Š2å­—èŠ‚å¯¹é½ã€‚åªèƒ½å¯»å€å½“å‰æŒ‡ä»¤å‰åå¤§çº¦1MBçš„åœ°å€ç©ºé—´ã€‚\næ•…è€Œæœ‰jalræŒ‡ä»¤å­˜åœ¨çš„å¿…è¦ã€‚ï¼ˆä¸çŸ¥é“å¯¹ä¸å¯¹ğŸ˜‚ï¼‰","like_count":0,"discussions":[{"author":{"id":1345199,"avatar":"https://static001.geekbang.org/account/avatar/00/14/86/af/99219321.jpg","nickname":"LMOS","note":"","ucode":"B037712C8B8B3C","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":587218,"discussion_content":"å¯¹çš„","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1662885311,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"æ¹–åŒ—","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]}]}