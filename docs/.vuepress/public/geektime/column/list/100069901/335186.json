{"id":335186,"title":"开篇词｜为什么你要学习etcd?","content":"<p>你好，我是唐聪，etcd活跃贡献者，腾讯资深工程师，欢迎你和我一起学习etcd。</p><p>开门见山，今天我想和你聊聊为什么要学习etcd。随着Kubernetes成为容器编排领域霸主，etcd也越来越火热，越来越多的软件工程师使用etcd去解决各类业务场景中遇到的痛点。你知道吗？etcd的GitHub star数已超过34.2K，它的应用场景相当广泛，从服务发现到分布式锁，从配置存储到分布式协调等等。可以说，etcd已经成为了云原生和分布式系统的存储基石。</p><p>另外，etcd作为最热门的云原生存储之一，在腾讯、阿里、Google、AWS、美团、字节跳动、拼多多、Shopee、明源云等公司都有大量的应用，覆盖的业务可不仅仅是Kubernetes相关的各类容器产品，更有视频、推荐、安全、游戏、存储、集群调度等核心业务。</p><h2>我想为你解决哪些问题？</h2><p>在工作和参与etcd社区贡献的过程中，我经常会收到各类问题咨询，同时自己也经历了各种问题。我相信你在使用Kubernetes、etcd的过程中，很可能也会遇到下面这些典型问题：</p><ul>\n<li>etcd Watch机制能保证事件不丢吗？（原理类）</li>\n<li>哪些因素会导致你的集群Leader发生切换? （稳定性类）</li>\n<li>为什么基于Raft实现的etcd还可能会出现数据不一致？（一致性类）</li>\n<li>为什么你删除了大量数据，db大小不减少？为何etcd社区建议db大小不要超过8G？（db大小类）</li>\n<li>为什么集群各节点磁盘I/O延时很低，写请求也会超时？（延时类）</li>\n<li>为什么你只存储了1个几百KB的key/value， etcd进程却可能耗费数G内存? （内存类）</li>\n<li>当你在一个namespace下创建了数万个Pod/CRD资源时，同时频繁通过标签去查询指定Pod/CRD资源时，APIServer和etcd为什么扛不住?（最佳实践类）</li>\n</ul><!-- [[[read_end]]] --><p>当然，你在学习和使用etcd、Kubernetes过程中遇到的问题肯定远远不止这些，下面我用思维导图给你总结了更多类似问题，你可以对照自身的经历去看一下。</p><p><img src=\"https://static001.geekbang.org/resource/image/7e/54/7e05c744ba292cf26c39d69101200554.jpg?wh=5378*2217\" alt=\"\"></p><p>这门课就是为了帮助你解决这些问题而生。不过你可能会想，你能把这些东西都讲明白么？我先和你聊聊我的个人etcd经历，你就知道我为什么有自信能带你学好etcd了。</p><h2>我和etcd的那些事</h2><p>本科毕业后，我通过校招加入了腾讯。不到一年的时间，我就主导完成了一个亿级用户的业务核心存储平滑迁移任务。</p><p>在2015到2017的这两年时间里，为了满足业务大量的Redis诉求，我基于Redis/Codis构建了大规模的排行榜和Redis集群平台服务，支撑了公司的多个重要业务。在这期间，我积累了大量的NoSQL数据库知识与经验，为后面工作转岗到To B，负责Kubernetes的元数据存储etcd奠定了良好的基础。</p><p>2017年后，我就开始接触Docker和Kubernetes，并通过Kubernetes来解决大规模Redis集群的治理问题，提升服务的可用性、降低运维成本。</p><p>2018年，我转岗到了腾讯云，负责Kubernetes集群存储etcd治理工作。我主导构建的云原生etcd平台，支持自动化的集群管理、调度、迁移、监控、巡检、备份，成功解决了集群大规模增长过程中的各类etcd稳定性问题，支撑了万级的Kubernetes和etcd集群。</p><p>etcd平台从解决Kubernetes etcd稳定性问题，到为各类云原生产品提供etcd基础服务，再到保障开箱即用的腾讯云etcd产品化服务，它发挥着重要作用。在这个过程中，我也见证了越来越多的软件工程师加入etcd的阵营，越来越多的产品使用etcd。目前，etcd作为腾讯众多产品的基础设施，服务用户已达数亿。</p><p>同时，我也遇到了很多问题，从内存泄露到数据不一致，从节点crash到性能慢，再到死锁、OOM等稳定性问题等等。最令我记忆犹新的是，我和小伙伴王超凡通过混沌工程发现并修复了多个数据不一致Bug，其中一个Bug已经存在近3年之久，而且很严重，重启就可能会触发数据不一致。</p><p>从解决类似上面的棘手Bug到提交稳定性、性能优化PR，从提交QoS特性设计方案、POC到给新的contributor review PR，通过一点点的积累，大量周末、凌晨时间的付出，我成为了2020年etcd社区的全球Top3活跃贡献者，与Google、AWS、阿里巴巴的小伙伴们，一起推动etcd项目越来越好，服务于全球开发者。</p><p>总结来说的话，过去几年我一直在与Redis、etcd打交道，一线的经历、解决的问题都让我收获良多，所以我也非常有自信能把这些经验都交付给你。</p><p>在业务实践方面，我成功解决过众多大规模业务增长过程中，遇到的存储稳定性、可扩展性等痛点，积累了丰富的理论知识、大规模集群的实战、治理经验，能直接帮助到你今后的工作。</p><p>另外，在etcd开源项目方面，我深度参与etcd开源项目的贡献经历，让我可以从开发者的视角，为你分析问题、梳理最佳实践、解读特性设计方案、阐述社区未来演进方向等等，帮助你深度理解etcd以及分布式服务。</p><h2>你应该怎么学etcd？</h2><p>在我看来，etcd学习其实可以分为大中小三个目标。最大的目标我当然是希望你能够用最低的学习成本，掌握etcd核心原理与最佳实践，让etcd为你所用，帮助你解决业务过程中的各类痛点，在工作中少踩坑、少交学费，多升职、多涨薪。</p><p>但是这个大的目标怎么实现呢？</p><p>我的答案是<strong>使用拆解法</strong>。下面我给你提出了学习这个专栏的一些中等大小目标，希望你能带着这些目标进行学习，每过一段时间，回过头来看看，这些目标实现了多少？</p><p>首先，你能知道什么是etcd，了解它的基本读写原理、核心特性和能解决什么问题。</p><p>然后，在使用etcd解决各类业务场景需求时，能独立判断etcd是否适合你的业务场景，并能设计出良好的存储结构，避免expensive request。</p><p>其次，在使用Kubernetes的过程中，你能清晰地知道你的每个操作背后的etcd是如何工作的，并遵循Kubernetes/etcd最佳实践，让你的Kubernetes集群跑得更快更稳。</p><p>接着，在运维etcd集群的时候，你能知道etcd集群核心监控指标，了解常见的坑，制定良好的巡检、监控策略，及时发现、规避问题，避免事故的产生。</p><p>最后，当你遇到etcd问题时，能自己分析为什么会出现这样的错误，并知道如何解决，甚至给社区提PR优化，做到知其然知其所以然。</p><p>做到以上五个目标其实也并不容易，别着急，我们接着往下拆分。为了让你实现以上五个目标，我把专栏分为了基础和实践两大主线。每个主线里都有一个一个的小目标，我们逐个攻破就容易多了。</p><p>基础篇主线是为了帮助你建立起对etcd的整体认知，搞懂读写请求、各个核心特性背后的原理，为我们后面的实践篇打下基础。</p><p>基础篇的学习也是一个中小型分布式存储系统从0到1的实现案例解读，学习它你收获的不仅仅是etcd，更是如何构建分布式存储系统的理论知识。</p><p>我把基础篇分为了以下的学习小目标：</p><ul>\n<li>etcd基础架构。通过为你梳理etcd前世今生、分析etcd读写流程，帮助你建立起对etcd的整体认知，了解一个分布式存储系统的基本模型、设计思想。</li>\n<li>Raft算法。通过为你介绍Raft算法在etcd中是如何工作的，帮助你了解etcd高可用、高可靠背后的核心原理。</li>\n<li>鉴权模块。通过介绍etcd的鉴权、授权体系，带你了解etcd是如何保护你的数据安全，以及各个鉴权机制的优缺点。</li>\n<li>租约模块。介绍etcd租约特性的实现，帮助你搞懂如何检测一个进程的存活性，为什么它可以用于Leader选举中。</li>\n<li>MVCC/Watch模块。通过这两个模块帮助你搞懂Kubernetes控制器编程模型背后的原理。</li>\n</ul><p>在介绍etcd原理的过程中，我也会从更上层的角度，为你解读分布式系统存储系统的核心技术难点是什么，常见的解决方案有哪些，以及为什么etcd要这样设计、实现。让你对整个分布式系统有更深层次的理解，明白不同存储系统只是在面对各自的业务场景的时候，选择了合适的技术方案，让你从本质上去理解分布式存储系统要解决的核心问题基本是一致的。</p><p>当然基础篇讲的远不止这些，关于基础篇的更多内容，你可以参考下面的etcd基础篇思维导图：</p><p><img src=\"https://static001.geekbang.org/resource/image/ed/ea/edf53f37c0725c9757e4ecb89982a7ea.jpg?wh=3920*2495\" alt=\"\"></p><p>通过基础篇掌握好etcd核心模块原理后，实践篇我将为你解读实际使用etcd时，可能会遇到的各种问题，帮助你提前避坑、遇到类似问题时能独立分析、解决。</p><p>我把实践篇分为以下的学习小目标：</p><ul>\n<li>问题篇。为你分析etcd使用过程中的各类典型问题，和你细聊各种异常现象背后的原理、最佳实践。</li>\n<li>性能优化篇。通过读写链路的分析，为你梳理可能影响etcd性能的每一个瓶颈。</li>\n<li>实战篇。带你从0到1亲手参与构建一个简易的分布式KV数据库，进一步提升你对分布式存储系统的认知。</li>\n<li>Kubernetes实践篇。为你分析etcd在Kubernetes中的应用，让你对Kubernetes原理有更深层次的理解。</li>\n<li>etcd应用篇。介绍etcd在分布式锁、配置系统、服务发现场景中的应用。</li>\n</ul><p>更多实践篇内容你可以参考下面的思维导图：</p><p><img src=\"https://static001.geekbang.org/resource/image/42/81/42eaa94b0f4f7a18895780e6f61ce381.jpg?wh=3912*2990\" alt=\"\"></p><p>这样一来，我们的学习目标就比较明确了。最终目标是让etcd为你所用，少踩坑、多升职加薪；而为了实现这个目标，我们需要从多方面提升自己对etcd的掌控能力，也就是实现中等目标；但进阶的难度还是比较大的，所以我们需要把一个个小目标当作基石（也就是每一节课的知识点学习），来达成个人能力的提升。</p><p>现在我们不妨就带着这些目标，共同开启etcd的学习之旅吧！</p>","neighbors":{"left":[],"right":{"article_title":"01 | etcd的前世今生：为什么Kubernetes使用etcd？","id":335204}},"comments":[{"had_liked":false,"id":275947,"user_name":"唐聪","can_delete":false,"product_type":"c1","uid":1009582,"ip_address":"","ucode":"99CB061EDF35EA","user_header":"https://static001.geekbang.org/account/avatar/00/0f/67/ae/37b492db.jpg","comment_is_top":true,"comment_ctime":1611725126,"is_pvip":false,"discussion_count":5,"race_medal":0,"score":"9.2233723949488005e+18","product_id":100069901,"comment_content":"非常感谢关注etcd专栏的同学们，大家在试读过程中，可能已经发现每讲比较长，大部分5000多字左右，就为了尽量给大家透彻的分享清楚，一两个问题。<br><br>希望通过好几个月周末与凌晨时间，总结出的15万多字文章，1百多张图，能帮助大家通过短短短短几个月的学习，快速获得我多年知识与丰富实战经验总结，提升大家对etcd的了解，少踩坑，一定会物有所值。<br><br>欢迎大家和我一起学习etcd。","like_count":84,"discussions":[{"author":{"id":1562991,"avatar":"https://static001.geekbang.org/account/avatar/00/17/d9/6f/62e027f4.jpg","nickname":"风有点儿大","note":"","ucode":"77A26CA32CE165","race_medal":0,"user_type":1,"is_pvip":true},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":588852,"discussion_content":"有etcd key 命名规范的相关文章吗？","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1664175542,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":"四川"},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":2187256,"avatar":"https://static001.geekbang.org/account/avatar/00/21/5f/f8/1d16434b.jpg","nickname":"陈麒文","note":"","ucode":"41475885FA5AD5","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":582537,"discussion_content":"初体验，安排，感谢老师分享","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1659498104,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":"福建"},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":2055809,"avatar":"https://static001.geekbang.org/account/avatar/00/1f/5e/81/82709d6e.jpg","nickname":"码小呆","note":"","ucode":"44532D6ABF9340","race_medal":0,"user_type":1,"is_pvip":true},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":575631,"discussion_content":"etcd 可以理解为是一个分布式的数据库吗?","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1654963389,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1226968,"avatar":"https://static001.geekbang.org/account/avatar/00/12/b8/d8/f81b5604.jpg","nickname":"hcyycb","note":"","ucode":"77FF6CA41F9E66","race_medal":0,"user_type":1,"is_pvip":true},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":548492,"discussion_content":"一周年过去了，这个专栏太好了，解决了ETCD学习中的很多疑问。一个专栏15万字，还有大家的评论都是精华。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1643213350,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":2361579,"avatar":"https://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTIqibLcIFMX3RvLbpK6m96cz7wWwFasyjU2ysPVZZjNCrJhCciapJIia5KichUiaAIA6S5ugT9GIgXx70A/132","nickname":"Geek_ece509","note":"","ucode":"0C6DF46E58095F","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":385319,"discussion_content":"老师，你这声音是合成的啊？","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1627002663,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":304848,"user_name":"xiaoyu","can_delete":false,"product_type":"c1","uid":1245915,"ip_address":"","ucode":"477617C15FB5CC","user_header":"https://static001.geekbang.org/account/avatar/00/13/02/db/5d227be5.jpg","comment_is_top":false,"comment_ctime":1627638426,"is_pvip":true,"replies":[{"id":"110270","content":"kubernetes的元数据存储，保存了你通过kubectl命令所看到的node&#47;pod&#47;deployment等各种资源、配置信息等","user_name":"作者回复","comment_id":304848,"uid":"1009582","ip_address":"","utype":1,"ctime":1627687728,"user_name_real":"唐聪"}],"discussion_count":1,"race_medal":0,"score":"27397442202","product_id":100069901,"comment_content":"正在学习kubernetes，之前不是很了解，所以etcd是什么，云原生存储？","like_count":6,"discussions":[{"author":{"id":1009582,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/67/ae/37b492db.jpg","nickname":"唐聪","note":"","ucode":"99CB061EDF35EA","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":524185,"discussion_content":"kubernetes的元数据存储，保存了你通过kubectl命令所看到的node/pod/deployment等各种资源、配置信息等","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1627687728,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":274764,"user_name":"@%初%@","can_delete":false,"product_type":"c1","uid":1053509,"ip_address":"","ucode":"2B8A6134675ED7","user_header":"https://static001.geekbang.org/account/avatar/00/10/13/45/16c60da2.jpg","comment_is_top":false,"comment_ctime":1611150969,"is_pvip":true,"replies":[{"id":"99696","content":"感谢你的支持，一起加油!","user_name":"作者回复","comment_id":274764,"uid":"1009582","ip_address":"","utype":1,"ctime":1611156506,"user_name_real":"tangcong"}],"discussion_count":1,"race_medal":0,"score":"23085987449","product_id":100069901,"comment_content":"等来了etcd,一起加油呦","like_count":5,"discussions":[{"author":{"id":1009582,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/67/ae/37b492db.jpg","nickname":"唐聪","note":"","ucode":"99CB061EDF35EA","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":514117,"discussion_content":"感谢你的支持，一起加油!","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1611156506,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":274736,"user_name":"jeffery","can_delete":false,"product_type":"c1","uid":1219972,"ip_address":"","ucode":"35E2DAA386FB86","user_header":"https://static001.geekbang.org/account/avatar/00/12/9d/84/171b2221.jpg","comment_is_top":false,"comment_ctime":1611139383,"is_pvip":false,"replies":[{"id":"99690","content":"嗯，后续有什么不清楚的，欢迎随时给我留言! 一起加油!","user_name":"作者回复","comment_id":274736,"uid":"1009582","ip_address":"","utype":1,"ctime":1611155906,"user_name_real":"tangcong"}],"discussion_count":1,"race_medal":0,"score":"23085975863","product_id":100069901,"comment_content":"终于来了！期待已久！按照老师的拆解法去执行！一定收获满满……","like_count":5,"discussions":[{"author":{"id":1009582,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/67/ae/37b492db.jpg","nickname":"唐聪","note":"","ucode":"99CB061EDF35EA","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":514104,"discussion_content":"嗯，后续有什么不清楚的，欢迎随时给我留言! 一起加油!","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1611155906,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":274910,"user_name":"无风","can_delete":false,"product_type":"c1","uid":1721922,"ip_address":"","ucode":"E131BEB496DCED","user_header":"https://static001.geekbang.org/account/avatar/00/1a/46/42/eaa0cc92.jpg","comment_is_top":false,"comment_ctime":1611216653,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"18791085837","product_id":100069901,"comment_content":"厉害了，看思维导图很清晰。<br>","like_count":4},{"had_liked":false,"id":276498,"user_name":"mmm","can_delete":false,"product_type":"c1","uid":1204710,"ip_address":"","ucode":"D825372FBC8297","user_header":"https://static001.geekbang.org/account/avatar/00/12/61/e6/fedd20dc.jpg","comment_is_top":false,"comment_ctime":1611975094,"is_pvip":false,"replies":[{"id":"100329","content":"嗯，可以先看看前面的基础篇文章，04 raft就可能会导致内存和leader频繁切换问题","user_name":"作者回复","comment_id":276498,"uid":"1009582","ip_address":"","utype":1,"ctime":1611999657,"user_name_real":"唐聪"}],"discussion_count":1,"race_medal":1,"score":"10201909686","product_id":100069901,"comment_content":"期待已久，赶紧交学费！leader频繁切换，几百kv却消耗几G内存都是工作中遇到过问题，一脸茫然，希望能在这里找到答案","like_count":2,"discussions":[{"author":{"id":1009582,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/67/ae/37b492db.jpg","nickname":"唐聪","note":"","ucode":"99CB061EDF35EA","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":514725,"discussion_content":"嗯，可以先看看前面的基础篇文章，04 raft就可能会导致内存和leader频繁切换问题","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1611999657,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":276138,"user_name":"无名氏","can_delete":false,"product_type":"c1","uid":1256121,"ip_address":"","ucode":"584E697AE276AB","user_header":"https://static001.geekbang.org/account/avatar/00/13/2a/b9/2bf8cc89.jpg","comment_is_top":false,"comment_ctime":1611808338,"is_pvip":false,"replies":[{"id":"100282","content":"一起学习，加油，一定能让你收获满满，少踩坑","user_name":"作者回复","comment_id":276138,"uid":"1009582","ip_address":"","utype":1,"ctime":1611845515,"user_name_real":"唐聪"}],"discussion_count":1,"race_medal":0,"score":"10201742930","product_id":100069901,"comment_content":"工作中正好用到，跟随大佬学习etcd","like_count":2,"discussions":[{"author":{"id":1009582,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/67/ae/37b492db.jpg","nickname":"唐聪","note":"","ucode":"99CB061EDF35EA","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":514613,"discussion_content":"一起学习，加油，一定能让你收获满满，少踩坑","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1611845515,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":274846,"user_name":"手机失联户","can_delete":false,"product_type":"c1","uid":1258691,"ip_address":"","ucode":"876DC3D73F8E3A","user_header":"https://static001.geekbang.org/account/avatar/00/13/34/c3/ed5881c6.jpg","comment_is_top":false,"comment_ctime":1611194752,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"10201129344","product_id":100069901,"comment_content":"etcd 实现的 Raft 算法模块是比较复杂的，很期待老师会怎么讲解这一部分","like_count":2},{"had_liked":false,"id":274706,"user_name":"linxs","can_delete":false,"product_type":"c1","uid":1006728,"ip_address":"","ucode":"0D860DF26FD150","user_header":"https://static001.geekbang.org/account/avatar/00/0f/5c/88/9575e5d3.jpg","comment_is_top":false,"comment_ctime":1611132895,"is_pvip":true,"replies":[{"id":"99689","content":"感谢支持，相信你一定能有所收获!","user_name":"作者回复","comment_id":274706,"uid":"1009582","ip_address":"","utype":1,"ctime":1611155841,"user_name_real":"tangcong"}],"discussion_count":1,"race_medal":0,"score":"10201067487","product_id":100069901,"comment_content":"从12月等到现在终于来了hhhh","like_count":2,"discussions":[{"author":{"id":1009582,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/67/ae/37b492db.jpg","nickname":"唐聪","note":"","ucode":"99CB061EDF35EA","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":514090,"discussion_content":"感谢支持，相信你一定能有所收获!","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1611155841,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":279663,"user_name":"小来子","can_delete":false,"product_type":"c1","uid":1879262,"ip_address":"","ucode":"4EDAF31E43B211","user_header":"https://static001.geekbang.org/account/avatar/00/1c/ac/de/68f35320.jpg","comment_is_top":false,"comment_ctime":1613895426,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"5908862722","product_id":100069901,"comment_content":"看到了学长的名字. 哈哈哈哈哈哈~","like_count":2},{"had_liked":false,"id":274886,"user_name":"于途","can_delete":false,"product_type":"c1","uid":1669343,"ip_address":"","ucode":"70300C6CCCEAF1","user_header":"https://static001.geekbang.org/account/avatar/00/19/78/df/424bdc4a.jpg","comment_is_top":false,"comment_ctime":1611209459,"is_pvip":true,"discussion_count":0,"race_medal":0,"score":"5906176755","product_id":100069901,"comment_content":"从去年11月盼到了现在。O(∩_∩)O哈哈~","like_count":1},{"had_liked":false,"id":274721,"user_name":"逍遥","can_delete":false,"product_type":"c1","uid":1013003,"ip_address":"","ucode":"570969BCFC96EF","user_header":"https://static001.geekbang.org/account/avatar/00/0f/75/0b/553d4ec4.jpg","comment_is_top":false,"comment_ctime":1611135909,"is_pvip":false,"replies":[{"id":"99691","content":"嗯，用在什么场景，具体是什么问题，我看看内容是否已经覆盖<br>","user_name":"作者回复","comment_id":274721,"uid":"1009582","ip_address":"","utype":1,"ctime":1611155991,"user_name_real":"tangcong"}],"discussion_count":1,"race_medal":0,"score":"5906103205","product_id":100069901,"comment_content":"之前两个项目简单用过，算大致了解怎么用，但是一些具体的细节或者深入的原理和问题背后的原因，就模糊了。这个课程很及时啊！紧跟大佬的步伐，冲呀","like_count":1,"discussions":[{"author":{"id":1009582,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/67/ae/37b492db.jpg","nickname":"唐聪","note":"","ucode":"99CB061EDF35EA","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":514100,"discussion_content":"嗯，用在什么场景，具体是什么问题，我看看内容是否已经覆盖\n","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1611155991,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":358289,"user_name":"风有点儿大","can_delete":false,"product_type":"c1","uid":1562991,"ip_address":"四川","ucode":"77A26CA32CE165","user_header":"https://static001.geekbang.org/account/avatar/00/17/d9/6f/62e027f4.jpg","comment_is_top":false,"comment_ctime":1664175452,"is_pvip":true,"discussion_count":0,"race_medal":0,"score":"1664175452","product_id":100069901,"comment_content":"你好，有ETCD key 命名规范的文章吗？","like_count":0},{"had_liked":false,"id":351419,"user_name":"雪原与星空之间","can_delete":false,"product_type":"c1","uid":1059200,"ip_address":"","ucode":"6E46FF7CA718B3","user_header":"https://static001.geekbang.org/account/avatar/00/10/29/80/e3a4962d.jpg","comment_is_top":false,"comment_ctime":1657778350,"is_pvip":true,"discussion_count":0,"race_medal":0,"score":"1657778350","product_id":100069901,"comment_content":"开始学习","like_count":0},{"had_liked":false,"id":311992,"user_name":"小高","can_delete":false,"product_type":"c1","uid":1283052,"ip_address":"","ucode":"FCD422249F7355","user_header":"https://static001.geekbang.org/account/avatar/00/13/93/ec/985675c8.jpg","comment_is_top":false,"comment_ctime":1631585806,"is_pvip":false,"replies":[{"id":"113222","content":"加油，建议再结合源码一起看看","user_name":"作者回复","comment_id":311992,"uid":"1009582","ip_address":"","utype":1,"ctime":1631852309,"user_name_real":"唐聪"}],"discussion_count":1,"race_medal":0,"score":"1631585806","product_id":100069901,"comment_content":"掌握etcd，就掌握了分布式系统的基础，加油，四刷了","like_count":0,"discussions":[{"author":{"id":1009582,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/67/ae/37b492db.jpg","nickname":"唐聪","note":"","ucode":"99CB061EDF35EA","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":526824,"discussion_content":"加油，建议再结合源码一起看看","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1631852309,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":310872,"user_name":"神毓逍遥","can_delete":false,"product_type":"c1","uid":2147220,"ip_address":"","ucode":"83351CB18B190E","user_header":"https://static001.geekbang.org/account/avatar/00/20/c3/94/e89ebc50.jpg","comment_is_top":false,"comment_ctime":1630941036,"is_pvip":true,"replies":[{"id":"112678","content":"感谢支持与认可，主要是基于https:&#47;&#47;github.com&#47;chaos-mesh&#47;chaos-mesh和etcd functional test(https:&#47;&#47;github.com&#47;etcd-io&#47;etcd&#47;tree&#47;main&#47;tests&#47;functional)、还有我们自己基于开发的一些chaos monkey，去随机restart&#47;kill etcd等","user_name":"作者回复","comment_id":310872,"uid":"1009582","ip_address":"","utype":1,"ctime":1631006347,"user_name_real":"唐聪"}],"discussion_count":2,"race_medal":0,"score":"1630941036","product_id":100069901,"comment_content":"第一边快扫而过，这是第二边，认真以待，老师的知识结构划分是很不错的，混沌工程如何发现数据不一致性的，这个可以提下吗？","like_count":0,"discussions":[{"author":{"id":1009582,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/67/ae/37b492db.jpg","nickname":"唐聪","note":"","ucode":"99CB061EDF35EA","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":526384,"discussion_content":"感谢支持与认可，主要是基于https://github.com/chaos-mesh/chaos-mesh和etcd functional test(https://github.com/etcd-io/etcd/tree/main/tests/functional)、还有我们自己基于开发的一些chaos monkey，去随机restart/kill etcd等","likes_number":1,"is_delete":false,"is_hidden":false,"ctime":1631006347,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":2933322,"avatar":"https://static001.geekbang.org/account/avatar/00/2c/c2/4a/22930340.jpg","nickname":"Biff","note":"","ucode":"0F89DF226EEB9F","race_medal":0,"user_type":1,"is_pvip":true},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":560101,"discussion_content":"提起混沌工程，一看就是老企鹅了哈哈\n","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1649172807,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":309787,"user_name":"Geek_edd932","can_delete":false,"product_type":"c1","uid":2364381,"ip_address":"","ucode":"50BB32FBF32648","user_header":"https://thirdwx.qlogo.cn/mmopen/vi_32/1pMbwZrAl5g8ZRC5SOlz9VQOVRGN5V1rFNwsmEehicGzxMRicGj330jNfwTE1MRLaZTdSvX8R2YJVEh8DrYnMVAQ/132","comment_is_top":false,"comment_ctime":1630333414,"is_pvip":false,"replies":[{"id":"112681","content":"一般场景下，建议先测试环境升级到v3.4最新版本，再升级到3.5版本，3.5才出没多久，建议再等等，先测试环境用起来。<br>升级的时候务必看看upgrade checklist, 有breaking changes api和其他已知bug,比如之前我们遇到的数据不一致bug.https:&#47;&#47;github.com&#47;etcd-io&#47;website&#47;blob&#47;main&#47;content&#47;en&#47;docs&#47;v3.5&#47;upgrades&#47;upgrade_3_3.md，测试环境搞完再搞生产，数据做好备份","user_name":"作者回复","comment_id":309787,"uid":"1009582","ip_address":"","utype":1,"ctime":1631006809,"user_name_real":"唐聪"}],"discussion_count":1,"race_medal":0,"score":"1630333414","product_id":100069901,"comment_content":"老师，请问一下，etcd集群从V3.3.18能零停机、滚动升级到V3.5.0吗？","like_count":0,"discussions":[{"author":{"id":1009582,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/67/ae/37b492db.jpg","nickname":"唐聪","note":"","ucode":"99CB061EDF35EA","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":526017,"discussion_content":"一般场景下，建议先测试环境升级到v3.4最新版本，再升级到3.5版本，3.5才出没多久，建议再等等，先测试环境用起来。\n升级的时候务必看看upgrade checklist, 有breaking changes api和其他已知bug,比如之前我们遇到的数据不一致bug.https://github.com/etcd-io/website/blob/main/content/en/docs/v3.5/upgrades/upgrade_3_3.md，测试环境搞完再搞生产，数据做好备份","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1631006809,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":309677,"user_name":"凡俗","can_delete":false,"product_type":"c1","uid":1977570,"ip_address":"","ucode":"47FBCD66BE5AD4","user_header":"https://static001.geekbang.org/account/avatar/00/1e/2c/e2/afa3867c.jpg","comment_is_top":false,"comment_ctime":1630299266,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1630299266","product_id":100069901,"comment_content":"玩Kubernetes的话，如果不能理解它的数据存储层面，那么还是不够深度","like_count":0},{"had_liked":false,"id":309346,"user_name":"StarOS","can_delete":false,"product_type":"c1","uid":2748792,"ip_address":"","ucode":"17AD3FA0F0FAA5","user_header":"https://static001.geekbang.org/account/avatar/00/29/f1/78/3ef66168.jpg","comment_is_top":false,"comment_ctime":1630055902,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1630055902","product_id":100069901,"comment_content":"团队上k8s的优雅姿势，不需要懂k8s，即可享受k8s带来的便利，体验产品 http:&#47;&#47;staros.cloud?hmsr=C16&amp;hmpl=A5<br>","like_count":0},{"had_liked":false,"id":292826,"user_name":"2014bduck","can_delete":false,"product_type":"c1","uid":1444202,"ip_address":"","ucode":"763159B1B4DEA8","user_header":"https://static001.geekbang.org/account/avatar/00/16/09/6a/1f2ef718.jpg","comment_is_top":false,"comment_ctime":1620996555,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1620996555","product_id":100069901,"comment_content":"问个小白问题etcd是念E&#47;T&#47;C&#47;D还是et-cee-dee","like_count":0},{"had_liked":false,"id":284719,"user_name":"湘问海","can_delete":false,"product_type":"c1","uid":1029328,"ip_address":"","ucode":"620592602C0E3A","user_header":"https://static001.geekbang.org/account/avatar/00/0f/b4/d0/8c5756be.jpg","comment_is_top":false,"comment_ctime":1616426610,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1616426610","product_id":100069901,"comment_content":"刚好需要学习一下Etcd ","like_count":0},{"had_liked":false,"id":284701,"user_name":"nullptr","can_delete":false,"product_type":"c1","uid":1283847,"ip_address":"","ucode":"D309EABB70F0BF","user_header":"https://static001.geekbang.org/account/avatar/00/13/97/07/7406fe30.jpg","comment_is_top":false,"comment_ctime":1616420986,"is_pvip":false,"replies":[{"id":"103451","content":"感谢nullptr同学支持","user_name":"作者回复","comment_id":284701,"uid":"1009582","ip_address":"","utype":1,"ctime":1616652583,"user_name_real":"唐聪"}],"discussion_count":1,"race_medal":0,"score":"1616420986","product_id":100069901,"comment_content":"从增值产品部就开始用simo大佬的redis，看到大佬的名字就来购买了。","like_count":0,"discussions":[{"author":{"id":1009582,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/67/ae/37b492db.jpg","nickname":"唐聪","note":"","ucode":"99CB061EDF35EA","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":517437,"discussion_content":"感谢nullptr同学支持","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1616652583,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":274942,"user_name":"若水","can_delete":false,"product_type":"c1","uid":1066925,"ip_address":"","ucode":"7574411163BBF9","user_header":"https://static001.geekbang.org/account/avatar/00/10/47/ad/f683df31.jpg","comment_is_top":false,"comment_ctime":1611223491,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1611223491","product_id":100069901,"comment_content":"请求一下：“Redis&#47;Codis 构建了大规模的排行榜”在这种排行榜中，如果针对多个候选ID进行批量投票，有没有好的实现方案。","like_count":0},{"had_liked":false,"id":274897,"user_name":"陈光辉","can_delete":false,"product_type":"c1","uid":1202006,"ip_address":"","ucode":"66CCBBD37A6200","user_header":"https://static001.geekbang.org/account/avatar/00/12/57/56/74cd397e.jpg","comment_is_top":false,"comment_ctime":1611213072,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1611213072","product_id":100069901,"comment_content":"迅速入坑，一起学习","like_count":0}]}