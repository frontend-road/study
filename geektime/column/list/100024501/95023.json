{"id":95023,"title":"28 | æ€ä¹ˆåº”å¯¹å„ç§å¯Œæ–‡æœ¬è¡¨ç°éœ€æ±‚ï¼Ÿ","content":"<p>ä½ å¥½ï¼Œæˆ‘æ˜¯æˆ´é“­ã€‚ä»Šå¤©ï¼Œæˆ‘è¦å’Œä½ åˆ†äº«çš„ä¸»é¢˜æ˜¯ï¼Œåœ¨iOSå¼€å‘ä¸­ï¼Œå¦‚ä½•å±•ç¤ºå¯Œæ–‡æœ¬çš„å†…å®¹ã€‚</p><p>åœ¨iOSå¼€å‘ä¸­ï¼Œå¯Œæ–‡æœ¬çš„å±•ç¤ºæ˜¯ä¸€ä¸ªéå¸¸å¸¸è§çš„éœ€æ±‚ã€‚ä¸ºäº†å¸®åŠ©ä½ æ›´å¥½åœ°äº†è§£å¦‚ä½•å±•ç¤ºå¯Œæ–‡æœ¬ï¼Œæˆ‘åœ¨ä»Šå¤©è¿™ç¯‡æ–‡ç« ä¸­ï¼Œä¼šç»“åˆä¸€ä¸ªé¡¹ç›®æ¥è·Ÿä½ è¯´è¯´é¢å¯¹å¯Œæ–‡æœ¬å±•ç¤ºéœ€æ±‚æ—¶ï¼Œè¦æ€ä¹ˆè€ƒè™‘å’Œå®ç°ã€‚è¿™æ ·ï¼Œä½ åœ¨è‡ªå·±çš„é¡¹ç›®ä¸­ï¼Œä¹Ÿå¯ä»¥å€Ÿé‰´ä»Šå¤©è¿™æ ·çš„å®ç°æ€è·¯å’Œæ–¹æ³•ã€‚</p><p>ç®€å•æ¥è¯´ï¼Œå¯Œæ–‡æœ¬å°±æ˜¯ä¸€æ®µæœ‰å±æ€§çš„å­—ç¬¦ä¸²ï¼Œå¯ä»¥åŒ…å«ä¸åŒå­—ä½“ã€ä¸åŒå­—å·ã€ä¸åŒèƒŒæ™¯ã€ä¸åŒé¢œè‰²ã€ä¸åŒå­—é—´è·çš„æ–‡å­—ï¼Œè¿˜å¯ä»¥è®¾ç½®æ®µè½ã€å›¾æ–‡æ··æ’ç­‰ç­‰å±æ€§ã€‚</p><p>æˆ‘ä»¥å‰åšè¿‡ä¸€ä¸ª <a href=\"https://github.com/ming1016/GCDFetchFeed\">RSS é˜…è¯»å™¨</a>ï¼Œé˜…è¯»å™¨å¯åŠ¨åï¼Œéœ€è¦æŠ“å–æœ€æ–°çš„ RSS å†…å®¹è¿›è¡Œå±•ç¤ºã€‚RSS é‡Œé¢çš„æ–‡ç« å†…å®¹å±äºå¯Œæ–‡æœ¬ï¼Œæ˜¯ç”¨HTMLæ ‡ç­¾æ¥æè¿°çš„ï¼ŒåŒ…å«äº†æ–‡å­—æ ·å¼ã€é“¾æ¥å’Œå›¾ç‰‡ã€‚</p><p>æ¯”å¦‚ï¼ŒRSSé˜…è¯»å™¨ä¸­çš„æŸç¯‡æ–‡ç« å†…å®¹å¦‚ä¸‹ï¼š</p><pre><code>&lt;item&gt;\n&lt;title&gt;æ¶‰å›½èµ„æµå¤±å«Œç–‘ ä¸œæ–¹å¹¿ç›Š6äº¿å…ƒå…¥è‚¡é”¤å­ç§‘æŠ€è¢«è°ƒæŸ¥&lt;/title&gt;\n&lt;link&gt;https://www.cnbeta.com/articles/tech/841851.htm&lt;/link&gt;\n&lt;description&gt;\n&lt;![CDATA[\n&lt;p&gt;&lt;strong&gt;æ®è™å—…å¾—åˆ°çš„ç‹¬å®¶æ¶ˆæ¯ï¼Œæˆéƒ½æˆååŒºç›‘å¯Ÿå§”å·²ç«‹æ¡ˆè°ƒæŸ¥â€œä¸œæ–¹å¹¿ç›Š6äº¿å…ƒå…¥è‚¡é”¤å­ç§‘æŠ€ï¼ˆåŒ—äº¬ï¼‰è‚¡ä»½æœ‰é™å…¬å¸â€äº‹å®œï¼Œè®¤ä¸ºè¿™ä¸ªé¡¹ç›®æœ‰å›½æœ‰èµ„äº§æµå¤±å«Œç–‘ã€‚&lt;/strong&gt;æˆååŒºç›‘å¯Ÿå§”å‘˜ä¼šæˆç«‹äº2018å¹´2æœˆï¼ŒæŒ‰ç…§ç®¡ç†æƒé™å¯¹å…¨åŒºè¡Œä½¿å…¬æƒåŠ›çš„å…¬èŒäººå‘˜ä¾æ³•å®è¡Œç›‘å¯Ÿï¼Œå±¥è¡Œç›‘ç£ã€è°ƒæŸ¥å’Œå¤„ç½®èŒè´£ã€‚&lt;/p&gt; &lt;a href=&quot;https://www.cnbeta.com/articles/tech/841851.htm&quot; target=&quot;_blank&quot;&gt;&lt;strong&gt;é˜…è¯»å…¨æ–‡&lt;/strong&gt;&lt;/a&gt;\n]]&gt;\n&lt;/description&gt;\n&lt;author&gt;ugmbbc&lt;/author&gt;\n&lt;source&gt;cnBeta.COM&lt;/source&gt;\n&lt;pubDate&gt;Sat, 27 Apr 2019 09:46:45 GMT&lt;/pubDate&gt;\n&lt;guid&gt;https://www.cnbeta.com/articles/tech/841851.htm&lt;/guid&gt;\n&lt;/item&gt;\n</code></pre><p>æ–‡ç« çš„ HTML ä»£ç å°±åœ¨ä¸Šé¢ RSS ä¸­çš„ description æ ‡ç­¾é‡Œã€‚è§£æå‡º RSS ä¸­æ‰€æœ‰æ–‡ç« çš„ HTML ä»£ç ï¼Œå¹¶å°†å®ƒä»¬ä¿å­˜åˆ°æœ¬åœ°æ•°æ®åº“ä¸­ã€‚</p><p>æ¥ä¸‹æ¥ï¼Œå¦‚ä½•å±•ç¤º HTML å†…å®¹å‘¢ï¼Ÿå½“æ—¶ï¼Œæˆ‘çš„ç¬¬ä¸€ååº”å°±æ˜¯ä½¿ç”¨ WebView æ§ä»¶æ¥å±•ç¤ºã€‚</p><h2>WebView</h2><p>ä½¿ç”¨ WebView æ˜¾ç¤ºæ–‡ç« åªéœ€è¦åˆ›å»ºä¸€ä¸ª UIWebView å¯¹è±¡ï¼Œè¿›è¡Œä¸€äº›åŸºæœ¬æ»šåŠ¨ç›¸å…³çš„è®¾ç½®ï¼Œç„¶åè¯»å– HTML å­—ç¬¦ä¸²å°±å¯ä»¥äº†ï¼Œå…·ä½“å®ç°ä»£ç å¦‚ä¸‹ï¼š</p><!-- [[[read_end]]] --><pre><code>self.wbView = [[UIWebView alloc] init];\nself.wbView.delegate = self;\n[self.view addSubview:self.wbView];\n[self.wbView mas_makeConstraints:^(MASConstraintMaker *make) {\n    make.top.left.right.bottom.equalTo(self.view);\n}];\nself.wbView.scalesPageToFit = YES; // ç¡®ä¿ç½‘é¡µçš„æ˜¾ç¤ºå°ºå¯¸å’Œå±å¹•å¤§å°ç›¸åŒ\nself.wbView.scrollView.directionalLockEnabled = YES; // åªåœ¨ä¸€ä¸ªæ–¹å‘æ»šåŠ¨\nself.wbView.scrollView.showsHorizontalScrollIndicator = NO; // ä¸æ˜¾ç¤ºå·¦å³æ»‘åŠ¨\n[self.wbView setOpaque:NO]; // é»˜è®¤æ˜¯é€æ˜çš„\n\n// è¯»å–æ–‡ç«  html å­—ç¬¦ä¸²è¿›è¡Œå±•ç¤º\n[self.wbView loadHTMLString:articleString baseURL:nil];\n</code></pre><p>å’Œ UIWebView çš„ loadRequest ç›¸æ¯”ï¼ŒUIWebView é€šè¿‡ loadHTMLString ç›´æ¥è¯»å– HTML ä»£ç ï¼Œçœå»äº†ç½‘ç»œè¯·æ±‚çš„æ—¶é—´ï¼Œå±•ç¤ºçš„é€Ÿåº¦éå¸¸å¿«ã€‚ä¸è¿‡ï¼ŒHTML é‡Œçš„å›¾ç‰‡èµ„æºè¿˜æ˜¯éœ€è¦é€šè¿‡ç½‘ç»œè¯·æ±‚æ¥è·å–ã€‚æ‰€ä»¥ï¼Œå¦‚æœèƒ½å¤Ÿåœ¨æ–‡ç« å±•ç¤ºä¹‹å‰å°±ç¼“å­˜ä¸‹å›¾ç‰‡ï¼Œé‚£ä¹ˆæ— éœ€ç­‰å¾…ï¼Œå°±èƒ½å¤Ÿå¿«é€Ÿå®Œæ•´åœ°å±•ç¤ºä¸°å¯Œçš„æ–‡ç« å†…å®¹äº†ã€‚</p><p>é‚£ä¹ˆï¼Œæˆ‘åº”è¯¥ä½¿ç”¨ä»€ä¹ˆæ–¹æ¡ˆæ¥ç¼“å­˜æ–‡ç« ä¸­çš„å›¾ç‰‡å‘¢ï¼Ÿ</p><p>åœ¨ Cocoa å±‚ä½¿ç”¨ NSURLProtocol å¯ä»¥æ‹¦æˆªæ‰€æœ‰ HTTP çš„è¯·æ±‚ï¼Œå› æ­¤æˆ‘å¯ä»¥åˆ©ç”¨ NSURLProtocol æ¥ç¼“å­˜æ–‡ç« ä¸­çš„å›¾ç‰‡ã€‚</p><p>æ¥ä¸‹æ¥ï¼Œæˆ‘å†æ¥å’Œä½ è¯´è¯´ï¼Œ<strong>å¦‚ä½•ç”¨æˆ‘å†™çš„ä¸€ä¸ª Web é¡µé¢é¢„åŠ è½½åº“</strong> <a href=\"https://github.com/ming1016/GCDFetchFeed/blob/master/GCDFetchFeed/GCDFetchFeed/STMURLCache.m\"><strong>STMURLCache</strong></a><strong>æ¥é¢„ç¼“å­˜ HTML é‡Œçš„å›¾ç‰‡ã€‚</strong>è¿™ä¸ªåº“ä½ ä¹Ÿå¯ä»¥åº”ç”¨åˆ°è‡ªå·±é¡¹ç›®ä¸­ã€‚</p><p><strong>é¦–å…ˆ</strong>ï¼Œæˆ‘éœ€è¦ä»æ•°æ®åº“ä¸­å–å‡ºæ‰€æœ‰æœªç¼“å­˜å›¾ç‰‡çš„æ–‡ç« å†…å®¹ HTMLã€‚å®ç°ä»£ç å¦‚ä¸‹ï¼š</p><pre><code>[[[[[SMDB shareInstance] selectAllUnCachedFeedItems] subscribeOn:[RACScheduler schedulerWithPriority:RACSchedulerPriorityDefault]] deliverOn:[RACScheduler mainThreadScheduler]] subscribeNext:^(NSMutableArray *x) {\n    // åœ¨æ•°æ®åº“ä¸­è·å–æ‰€æœ‰æœªç¼“å­˜çš„æ–‡ç« æ•°æ® x\n    NSMutableArray *urls = [NSMutableArray array];\n    if (x.count &gt; 0) {\n        self.needCacheCount = x.count;\n        for (SMFeedItemModel *aModel in x) {\n            // å°†æ–‡ç« æ•°æ®ä¸­çš„æ­£æ–‡å†…å®¹éƒ½å­˜åœ¨ urls æ•°ç»„ä¸­\n            [urls addObject:aModel.des];\n        }\n    }\n    ...\n    \n}];\n</code></pre><p>å¦‚ä¸Šé¢ä»£ç æ‰€ç¤ºï¼Œåœ¨æ•°æ®åº“ä¸­è·å–åˆ°æ‰€æœ‰æœªç¼“å­˜æ–‡ç« çš„æ•°æ®åï¼Œéå†æ‰€æœ‰æ•°æ®ï¼Œæå–æ–‡ç« æ•°æ®ä¸­çš„æ­£æ–‡ HTML å†…å®¹ä¿å­˜åˆ°ä¸€ä¸ªæ–°çš„æ•°ç»„ urls ä¸­ã€‚</p><p><strong>ç„¶å</strong>ï¼Œä½¿ç”¨ STMURLCache å¼€å§‹ä¾æ¬¡é¢„ä¸‹è½½æ–‡ç« ä¸­çš„å›¾ç‰‡è¿›è¡Œç¼“å­˜ã€‚å®ç°ä»£ç å¦‚ä¸‹ï¼š</p><pre><code>[[STMURLCache create:^(STMURLCacheMk *mk) {\n    mk.whiteUserAgent(@&quot;gcdfetchfeed&quot;).diskCapacity(1000 * 1024 * 1024);\n}] preloadByWebViewWithHtmls:[NSArray arrayWithArray:urls]].delegate = self;\n</code></pre><p>STMURLCache ä½¿ç”¨ preloadByWebViewWithHtmls æ–¹æ³•å»é¢„ç¼“å­˜æ‰€æœ‰å›¾ç‰‡ï¼Œåœ¨ STMURLCache åˆå§‹åŒ–æ—¶ï¼Œä¼šè®¾ç½® UserAgent ç™½åå•ï¼Œç›®çš„æ˜¯é¿å…é¢å¤–ç¼“å­˜äº†å…¶ä»–ä¸ç›¸å…³ UIWebView çš„å›¾ç‰‡ã€‚</p><p>ç¼“å­˜å›¾ç‰‡çš„æ ¸å¿ƒæŠ€æœ¯è¿˜æ˜¯ NSURLProtocolï¼ŒSTMURLCache æœ€ç»ˆä¹Ÿæ˜¯ä½¿ç”¨ NSURLProtocol æ¥ç¼“å­˜å›¾ç‰‡çš„ã€‚NSURLProtocol æ˜¯ä¸€ä¸ªæŠ½è±¡ç±»ï¼Œä¸“é—¨ç”¨æ¥å¤„ç†ç‰¹å®šåè®®çš„ URL æ•°æ®åŠ è½½ã€‚ä½ å¯ä»¥ä½¿ç”¨è‡ªå®šä¹‰ URL å¤„ç†çš„æ–¹å¼ï¼Œæ¥é‡æ–°å®šä¹‰ç³»ç»Ÿ URL åŠ è½½ã€‚STMURLCache ç¼“å­˜å›¾ç‰‡çš„å…·ä½“å®ç°ä»£ç ï¼Œä½ å¯ä»¥åœ¨ <a href=\"https://github.com/ming1016/GCDFetchFeed/blob/master/GCDFetchFeed/GCDFetchFeed/STMURLProtocol.m\">STMURLProtocol</a>è¿™ä¸ªç±»é‡ŒæŸ¥çœ‹ã€‚</p><p>STMURLProtocol ä¼šåœ¨æ‰€æœ‰ç½‘ç»œè¯·æ±‚çš„å…¥å£ canInitWithRequest æ–¹æ³•ä¸­åŠ ä¸Šè¿‡æ»¤æ¡ä»¶ï¼Œæ¯”å¦‚ STMURLCache åœ¨åˆå§‹åŒ–æ—¶è®¾ç½® UserAgent ç™½åå•ï¼Œè¿‡æ»¤ä»£ç å¦‚ä¸‹ï¼š</p><pre><code>// User-Agentæ¥è¿‡æ»¤\nif (sModel.whiteUserAgent.length &gt; 0) {\n    // åœ¨ HTTP header é‡Œå–å‡º User Agent\n    NSString *uAgent = [request.allHTTPHeaderFields objectForKey:@&quot;User-Agent&quot;];\n    if (uAgent) {\n        // ä¸åœ¨ç™½åå•ä¸­è¿”å› NOï¼Œä¸ä¼šè¿›è¡Œç¼“å­˜\n        if (![uAgent hasSuffix:sModel.whiteUserAgent]) {\n            return NO;\n        }\n    } else {\n        return NO;\n    }\n}\n</code></pre><p>UserAgent ç™½åå•è¿‡æ»¤ä¼šé€šè¿‡ request çš„ allHTTPHeaderFields è·å–åˆ°å½“å‰ç½‘ç»œè¯·æ±‚çš„ UserAgentï¼Œç„¶åå’Œå·²ç»è®¾ç½®çš„ UserAgent ç™½åå•åšæ¯”è¾ƒï¼šå¦‚æœåœ¨ç™½åå•ä¸­å°±è¿›è¡Œç¼“å­˜ï¼›å¦åˆ™ï¼Œå°±ä¸ä¼šç¼“å­˜ã€‚</p><p>STMURLProtocol è¿˜å¯ä»¥æ ¹æ®åŸŸåè¿›è¡Œè¿‡æ»¤ï¼Œè¿™æ ·å¯ä»¥çµæ´»ã€ç²¾ç¡®åœ°æ§åˆ¶ç¼“å­˜èŒƒå›´ã€‚å¦‚æœä½ è®¾ç½®äº†åŸŸåç™½åå•ï¼Œé‚£ä¹ˆåªæœ‰åœ¨ç™½åå•é‡Œçš„åŸŸåä¸‹çš„ç½‘ç»œè¯·æ±‚æ‰ä¼šæ‰§è¡Œç¼“å­˜ï¼Œè¿‡æ»¤ä»£ç å¦‚ä¸‹ï¼š</p><pre><code>//å¯¹äºåŸŸåç™½åå•çš„è¿‡æ»¤\nif (sModel.whiteListsHost.count &gt; 0) {\n    id isExist = [sModel.whiteListsHost objectForKey:request.URL.host];\n    // å¦‚æœå½“å‰è¯·æ±‚çš„åŸŸåä¸åœ¨ç™½åå•ä¸­ä¹Ÿä¼šè¿”å› NO\n    if (!isExist) {\n        return NO;\n    }\n}\n</code></pre><p>å¦‚ä»£ç æ‰€ç¤ºï¼Œå½“å‰ç½‘ç»œè¯·æ±‚çš„åŸŸåå¯ä»¥é€šè¿‡ request.URL.host å±æ€§è·å–åˆ°ï¼Œè·å–åˆ°ç½‘ç»œè¯·æ±‚çš„åŸŸååï¼Œå†å»çœ‹åŸŸåç™½åå•é‡Œæ˜¯å¦æœ‰ï¼Œå¦‚æœæœ‰å°±ç¼“å­˜ï¼Œæ²¡æœ‰å°±è¿”å› NOï¼Œä¸è¿›è¡Œç¼“å­˜æ“ä½œã€‚</p><p>åœ¨ canInitWithRequest æ–¹æ³•ä¸­æ»¡è¶³ç¼“å­˜æ¡ä»¶åï¼Œå¼€å§‹ç¼“å­˜çš„æ–¹æ³•æ˜¯ startLoadingã€‚startLoading æ–¹æ³•ä¼šåˆ¤æ–­å·²ç¼“å­˜å’Œæœªç¼“å­˜çš„æƒ…å†µï¼Œå¦‚æœæ²¡æœ‰ç¼“å­˜ä¼šå‘èµ·ç½‘ç»œè¯·æ±‚ï¼Œå°†è¯·æ±‚åˆ°çš„æ•°æ®ä¿å­˜åœ¨æœ¬åœ°ã€‚å¦‚æœæœ‰ç¼“å­˜ï¼Œåˆ™ä¼šç›´æ¥ä»æœ¬åœ°è¯»å–ç¼“å­˜ï¼Œå®ç°ä»£ç å¦‚ä¸‹ï¼š</p><pre><code>// ä»ç¼“å­˜é‡Œè¯»å–æ•°æ®\nNSData *data = [NSData dataWithContentsOfFile:self.filePath];\nNSURLResponse *response = [[NSURLResponse alloc] initWithURL:self.request.URL MIMEType:[otherInfo objectForKey:@&quot;MIMEType&quot;] expectedContentLength:data.length textEncodingName:[otherInfo objectForKey:@&quot;textEncodingName&quot;]];\n\n[self.client URLProtocol:self didReceiveResponse:response cacheStoragePolicy:NSURLCacheStorageNotAllowed];\n\n// ä½¿ç”¨ NSURLProtocolClient çš„ URLProtocol:didLoadData æ–¹æ³•åŠ è½½æœ¬åœ°æ•°æ®\n[self.client URLProtocol:self didLoadData:data];\n[self.client URLProtocolDidFinishLoading:self];\n</code></pre><p>å¦‚ä»£ç æ‰€ç¤ºï¼ŒSTMURLProtocol å…ˆé€šè¿‡ç¼“å­˜çš„è·¯å¾„è·å–åˆ°ç¼“å­˜çš„æ•°æ®ï¼Œå†ä½¿ç”¨ NSURLProtocolClient çš„ URLProtocol:didLoadData æ–¹æ³•åŠ è½½æœ¬åœ°ç¼“å­˜æ•°æ®ï¼Œä»¥å‡å°‘ç½‘ç»œè¯·æ±‚ã€‚</p><p>æ˜¾ç¤ºæ–‡ç« å†…å®¹æ—¶ä½¿ç”¨ NSURLProtocolï¼Œå¯¹äºé‚£äº›å·²ç»ç¼“å­˜è¿‡å›¾ç‰‡çš„æ–‡ç« å°±ä¸ç”¨å‘èµ·å›¾ç‰‡çš„ç½‘ç»œè¯·æ±‚ï¼Œæ˜¾ç¤ºçš„é€Ÿåº¦è·Ÿæœ¬åœ°åŠ è½½æ˜¾ç¤ºé€Ÿåº¦ä¸€æ ·å¿«ã€‚</p><p>è™½ç„¶é€šè¿‡ URLProtocol é‡æ–°å®šä¹‰ç³»ç»Ÿ URL åŠ è½½çš„æ–¹å¼ï¼Œæ¥ç›´æ¥è¯»å–é¢„ç¼“å­˜æå‡äº†åŠ è½½é€Ÿåº¦ï¼Œä½†åœ¨é•¿åˆ—è¡¨çš„ Cell ä¸Šå±•ç¤ºå¯Œæ–‡æœ¬ï¼Œå°±éœ€è¦æ€§èƒ½æ›´é«˜ã€å†…å­˜å ç”¨æ›´å°çš„æ–¹æ³•ã€‚é‚£ä¹ˆæ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬å†çœ‹çœ‹é™¤äº† UIWebView è¿˜æœ‰æ²¡æœ‰ä»€ä¹ˆæ–¹æ³•å¯ä»¥å±•ç¤ºå¯Œæ–‡æœ¬å‘¢ï¼Ÿ</p><p>å½“ç„¶è¿˜æœ‰äº†ã€‚</p><p>åœ¨é•¿åˆ—è¡¨è¿™ç§åœºæ™¯ä¸‹ï¼Œå¦‚æœä¸ç”¨ HTML æ¥æè¿°å¯Œæ–‡æœ¬çš„è¯ï¼Œæƒ³è¦ä½¿ç”¨åŸç”Ÿ iOS ä»£ç æ¥æè¿°å¯Œæ–‡æœ¬çš„è¯ï¼Œä½ è¿˜å¯ä»¥ä½¿ç”¨è‹¹æœå®˜æ–¹çš„<a href=\"https://developer.apple.com/documentation/appkit/textkit\">TextKit</a>å’Œ <a href=\"https://github.com/ibireme/YYText\">YYText</a>æ¥å±•ç¤ºã€‚</p><p>å…¶ä¸­ï¼ŒYYText ä¸ä»…å…¼å®¹ UILabel å’Œ UITextViewï¼Œåœ¨å¼‚æ­¥æ–‡å­—å¸ƒå±€å’Œæ¸²æŸ“ä¸Šçš„æ€§èƒ½ä¹Ÿéå¸¸å¥½ã€‚æ‰€ä»¥æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬å°±ä¸€èµ·çœ‹çœ‹ YYTextæ˜¯å¦‚ä½•å±•ç¤ºå¯Œæ–‡æœ¬çš„å§ã€‚</p><h2>YYText</h2><p>é›†æˆ YYText åˆ°ä½ çš„Appéå¸¸ç®€å•ï¼Œåªéœ€è¦åœ¨ Podfile ä¸­æ·»åŠ  pod â€˜YYTextâ€™ å°±å¯ä»¥äº†ã€‚ä¸‹é¢ä»£ç å±•ç¤ºäº†å¦‚ä½•å±•ç¤ºå›¾æ–‡æ··æ’çš„å¯Œæ–‡æœ¬ï¼š</p><pre><code>NSMutableAttributedString *text = [NSMutableAttributedString new];\nUIFont *font = [UIFont systemFontOfSize:16];\nNSMutableAttributedString *attachment = nil;\n  \n// åµŒå…¥ UIImage\nUIImage *image = [UIImage imageNamed:@&quot;dribbble64_imageio&quot;];\nattachment = [NSMutableAttributedString yy_attachmentStringWithContent:image contentMode:UIViewContentModeCenter attachmentSize:image.size alignToFont:font alignment:YYTextVerticalAlignmentCenter];\n[text appendAttributedString: attachment];\n  \n// åµŒå…¥ UIView\nUISwitch *switcher = [UISwitch new];\n[switcher sizeToFit];\nattachment = [NSMutableAttributedString yy_attachmentStringWithContent:switcher contentMode:UIViewContentModeBottom attachmentSize:switcher.size alignToFont:font alignment:YYTextVerticalAlignmentCenter];\n[text appendAttributedString: attachment];\n  \n// åµŒå…¥ CALayer\nCASharpLayer *layer = [CASharpLayer layer];\nlayer.path = ...\nattachment = [NSMutableAttributedString yy_attachmentStringWithContent:layer contentMode:UIViewContentModeBottom attachmentSize:switcher.size alignToFont:font alignment:YYTextVerticalAlignmentCenter];\n[text appendAttributedString: attachment];\n\n</code></pre><p>å¦‚ä»£ç æ‰€ç¤ºï¼ŒYYText å¯¹äºå¯Œæ–‡æœ¬çš„å›¾æ–‡æ··æ’ä½¿ç”¨çš„æ˜¯è‡ªå®šä¹‰çš„ NSMutableAttributedString åˆ†ç±»ï¼Œè‡ªå®šä¹‰åˆ†ç±»ä¸å…‰ç®€åŒ–äº† NSMutableAttributedStringï¼Œè¿˜å¢åŠ äº†åŠŸèƒ½ï¼Œé™¤äº†å›¾ç‰‡å¤–ï¼Œå¯ä»¥åµŒå…¥ UIView å’Œ CALayerã€‚</p><p>é€šè¿‡ä¸Šé¢ YYText æè¿°å¯Œæ–‡æœ¬çš„ä»£ç ï¼Œä½ ä¼šå‘ç°åŸç”Ÿä»£ç æè¿°å¯Œæ–‡æœ¬è·Ÿ HTML æ¯”ï¼Œæ—¢å¤æ‚åˆå•°å—¦ã€‚HTML ä»£ç æ›´æ˜“è¯»ã€æ›´å®¹æ˜“ç»´æŠ¤ï¼Œæ‰€ä»¥é™¤äº†é•¿åˆ—è¡¨å¤–ï¼Œæˆ‘å»ºè®®ä½ éƒ½ä½¿ç”¨ HTML æ¥æè¿°å¯Œæ–‡æœ¬ã€‚</p><p>å¯¹äº UIWebView å†…å­˜å ç”¨é«˜çš„é—®é¢˜ï¼Œä½ å¯ä»¥è€ƒè™‘ä½¿ç”¨ HTML ä»£ç è½¬åŸç”Ÿä»£ç çš„æ€è·¯è§£å†³ã€‚æ¯”å¦‚ï¼Œä½ å¯ä»¥å‚è€ƒæˆ‘ä»¥å‰åšçš„å°† HTML ä»£ç è½¬åŸç”Ÿä»£ç çš„ç¤ºä¾‹é¡¹ç›® <a href=\"https://github.com/ming1016/HTN\">HTN</a>é‡Œçš„è§£å†³æ€è·¯ã€‚</p><h2>å°ç»“</h2><p>ä»Šå¤©æˆ‘è·Ÿä½ ä»‹ç»äº†å¦‚ä½•é€šè¿‡ UIWebView å’Œ YYText æ¥å±•ç¤ºå¯Œæ–‡æœ¬ã€‚</p><p>UIWebView å±•ç¤ºçš„æ˜¯ä½¿ç”¨ HTML æè¿°çš„å¯Œæ–‡æœ¬ã€‚HTML æ˜¯æè¿°å¯Œæ–‡æœ¬æœ€ç®€å•å’Œæœ€å¸¸ç”¨çš„æ–¹å¼ï¼Œç›¸å¯¹äº YYText æˆ– TextKit é‚£æ ·æè¿°å¯Œæ–‡æœ¬çš„æ–¹å¼æ¥è¯´ï¼Œæ›´åŠ ç®€æ´å’Œæ ‡å‡†ã€‚ä¸è¿‡ï¼ŒUIWebView çš„ç¼ºç‚¹ä¹Ÿæ¯”è¾ƒæ˜æ˜¾ï¼ŒåŒæ—¶åˆ›å»ºå¤šä¸ª UIWebView å®ä¾‹ï¼Œå¯¹äºå†…å­˜çš„å ç”¨ä¼šéå¸¸å¤§ã€‚</p><p>æ‰€ä»¥ï¼Œæˆ‘å¯¹äºå¯Œæ–‡æœ¬å±•ç¤ºçš„å»ºè®®æ˜¯ï¼Œå¦‚æœæ˜¯åˆ—è¡¨å±•ç¤ºå¯Œæ–‡æœ¬å»ºè®®ä½¿ç”¨ TextKit æˆ–è€… YYTextï¼Œå…¶ä»–æƒ…å†µå¯ä»¥é€‰æ‹©ä½¿ç”¨ UIWebView æ¥å±•ç¤ºå¯Œæ–‡æœ¬ã€‚</p><h2>è¯¾åä½œä¸š</h2><p>ä½¿ç”¨ <a href=\"https://github.com/ming1016/GCDFetchFeed/blob/master/GCDFetchFeed/GCDFetchFeed/STMURLCache.m\">STMURLCache</a>é¢„åŠ è½½ä½ å·¥ç¨‹ä¸­çš„ä¸€ä¸ª Web é¡µé¢ï¼Œçœ‹çœ‹æ‰“å¼€é€Ÿåº¦æå‡äº†å¤šå°‘ï¼Œé¢„åŠ è½½æˆåŠŸåï¼Œåœ¨å¼±ç½‘ç¯å¢ƒå’Œæ— ç½‘ç»œçš„ç¯å¢ƒéƒ½å¯ä»¥è¯•è¯•ã€‚</p><p>æ„Ÿè°¢ä½ çš„æ”¶å¬ï¼Œæ¬¢è¿ä½ åœ¨è¯„è®ºåŒºç»™æˆ‘ç•™è¨€åˆ†äº«ä½ çš„è§‚ç‚¹ï¼Œä¹Ÿæ¬¢è¿æŠŠå®ƒåˆ†äº«ç»™æ›´å¤šçš„æœ‹å‹ä¸€èµ·é˜…è¯»ã€‚</p><p></p>","comments":[{"had_liked":false,"id":94396,"user_name":"å“ˆ","can_delete":false,"product_type":"c1","uid":1453904,"ip_address":"","ucode":"3F46ADFFBC94CE","user_header":"https://static001.geekbang.org/account/avatar/00/16/2f/50/b46a9b6a.jpg","comment_is_top":false,"comment_ctime":1557800560,"is_pvip":false,"replies":[{"id":"35017","content":"WKWebView æ€è·¯ç±»ä¼¼ï¼Œä½¿ç”¨WKURLSchemeHandlerå°±è¡Œ","user_name":"ä½œè€…å›å¤","user_name_real":"æˆ´é“­","uid":"1140280","ctime":1558851496,"ip_address":"","comment_id":94396,"utype":1}],"discussion_count":1,"race_medal":0,"score":"57392375408","product_id":100024501,"comment_content":"WKWebViewä¸å¥½å®ç°è¿™ç§æ•ˆæœå—ï¼ŸUIWebViewå·²ç»è¢«è‹¹æœæ·˜æ±°äº†å•Š","like_count":14,"discussions":[{"author":{"id":1140280,"avatar":"https://static001.geekbang.org/account/avatar/00/11/66/38/f9999b2b.jpg","nickname":"æˆ´é“­","note":"","ucode":"D61E685F962387","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":450048,"discussion_content":"WKWebView æ€è·¯ç±»ä¼¼ï¼Œä½¿ç”¨WKURLSchemeHandlerå°±è¡Œ","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1558851496,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":96025,"user_name":"ç†Š","can_delete":false,"product_type":"c1","uid":1406020,"ip_address":"","ucode":"C794160A03DD8B","user_header":"https://static001.geekbang.org/account/avatar/00/15/74/44/6d80dc8b.jpg","comment_is_top":false,"comment_ctime":1558313586,"is_pvip":false,"replies":[{"id":"35011","content":"wk çš„è¯ï¼Œå¯ä»¥äº†è§£ä¸‹ -[WKWebViewConfiguration setURLSchemeHandler:forURLScheme:]","user_name":"ä½œè€…å›å¤","user_name_real":"æˆ´é“­","uid":"1140280","ctime":1558847555,"ip_address":"","comment_id":96025,"utype":1}],"discussion_count":1,"race_medal":0,"score":"14443215474","product_id":100024501,"comment_content":"wkçš„NSURLProtolæ”¯æŒä¸å¤ªå¥½ï¼Œç”¨äº†ç½‘ä¸Šçš„ä¸€äº›æ–¹æ¡ˆï¼Œä¼šå¯¼è‡´ä¸€äº›å¥‡æ€ªçš„é—®é¢˜â€¦ã€‚å¾ˆè›‹ç–¼ã€‚ç°åœ¨éœ€æ±‚é‡Œé¢çš„ajaxè¯·æ±‚éƒ½ä¸å¥½å»æ‹¦æˆª","like_count":4,"discussions":[{"author":{"id":1140280,"avatar":"https://static001.geekbang.org/account/avatar/00/11/66/38/f9999b2b.jpg","nickname":"æˆ´é“­","note":"","ucode":"D61E685F962387","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":450682,"discussion_content":"wk çš„è¯ï¼Œå¯ä»¥äº†è§£ä¸‹ -[WKWebViewConfiguration setURLSchemeHandler:forURLScheme:]","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1558847555,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":94385,"user_name":"Happy_Home","can_delete":false,"product_type":"c1","uid":1454030,"ip_address":"","ucode":"E09B1C4D533809","user_header":"https://static001.geekbang.org/account/avatar/00/16/2f/ce/202cf0a3.jpg","comment_is_top":false,"comment_ctime":1557798547,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"14442700435","product_id":100024501,"comment_content":"è€å¸ˆï¼Œæƒ³é—®ä¸€ä¸‹ï¼Œä½ çš„é‚£ä¸ªé˜…è¯»å™¨é¡¹ç›®è²Œä¼¼ä¹Ÿå¯¼å…¥äº†DTCoreTextï¼Œå¯æ˜¯æ•´ä¸ªé¡¹ç›®ä¸­å¥½åƒå¹¶æ²¡æœ‰è¿ç”¨åˆ°ï¼ŒDTCoreTextå¥½åƒä¹Ÿæ˜¯å¯ä»¥ç›´æ¥å°†HTMLå­—ç¬¦ä¸²è½¬åŒ–ä¸ºå¯Œæ–‡æœ¬ï¼Œæ˜¯å‡ºäºä»€ä¹ˆåŸå› æ²¡æœ‰ä½¿ç”¨è€Œé€‰æ‹©UIWebViewçš„å‘¢","like_count":3},{"had_liked":false,"id":94362,"user_name":"Ace","can_delete":false,"product_type":"c1","uid":1010490,"ip_address":"","ucode":"D3B779A0E8264E","user_header":"https://static001.geekbang.org/account/avatar/00/0f/6b/3a/38de3fc4.jpg","comment_is_top":false,"comment_ctime":1557796089,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"14442697977","product_id":100024501,"comment_content":"YYKitçš„æƒ³æ³•å’Œæ–¹æ¡ˆç¡®å®ä¸é”™ï¼Œä¸è¿‡æ›¾ç»åœ¨å®è·µçš„æ—¶å€™ï¼Œé‡åˆ°æŸäº›ä¸æ˜¯å¾ˆå¸¸è§çš„è¯­è¨€é‡Œé¢çš„å­—ç¬¦éƒ¨åˆ†æ¸²æŸ“ä¸å‡ºæ¥ã€‚ã€‚ã€‚ä¸çŸ¥é“å¤§å®¶æœ‰æ²¡æœ‰é‡åˆ°è¿‡ï¼Œè¿™ä¸ªé—®é¢˜ä¸€ç›´æ²¡æœ‰è§£å†³ï¼Œåé¢å°±æ”¾å¼ƒä½¿ç”¨YYkitäº†ã€‚","like_count":3},{"had_liked":false,"id":94867,"user_name":"Ant","can_delete":false,"product_type":"c1","uid":1079563,"ip_address":"","ucode":"07E6374F91F61E","user_header":"https://static001.geekbang.org/account/avatar/00/10/79/0b/4346a253.jpg","comment_is_top":false,"comment_ctime":1557913537,"is_pvip":false,"replies":[{"id":"35014","content":"å¯ä»¥ç”¨ WKWebViewï¼Œæ€è·¯ç±»ä¼¼ï¼Œå®ç°ä¸Šç”¨ WKURLSchemeHandler","user_name":"ä½œè€…å›å¤","user_name_real":"æˆ´é“­","uid":"1140280","ctime":1558851050,"ip_address":"","comment_id":94867,"utype":1}],"discussion_count":1,"race_medal":0,"score":"10147848129","product_id":100024501,"comment_content":"åŒé—®ä¸ºå•¥ä¸ç”¨ WKWebView<br>","like_count":2,"discussions":[{"author":{"id":1140280,"avatar":"https://static001.geekbang.org/account/avatar/00/11/66/38/f9999b2b.jpg","nickname":"æˆ´é“­","note":"","ucode":"D61E685F962387","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":450238,"discussion_content":"å¯ä»¥ç”¨ WKWebViewï¼Œæ€è·¯ç±»ä¼¼ï¼Œå®ç°ä¸Šç”¨ WKURLSchemeHandler","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1558851050,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":94751,"user_name":"Geek_e1d503","can_delete":false,"product_type":"c1","uid":1459864,"ip_address":"","ucode":"5670711B17AB0B","user_header":"http://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTIOThWTmnhVX65gbpDVUJicQ1GO5YscfIiaLNicyNPz4eHDz1GwWlteJxRovgyjcfNwiaqFtic8Oibkat9g/132","comment_is_top":false,"comment_ctime":1557889070,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"10147823662","product_id":100024501,"comment_content":"èƒ½å¦æœ‰ä¸€å ‚è‹¹æœå®¡æ ¸çš„è¯¾ï¼Œæ¢³ç†å¸¸è§è¢«æ‹’åŸå› ï¼Ÿ","like_count":2},{"had_liked":false,"id":94717,"user_name":"è°­é¹","can_delete":false,"product_type":"c1","uid":1142009,"ip_address":"","ucode":"4A8120C4AA6F2F","user_header":"https://static001.geekbang.org/account/avatar/00/11/6c/f9/af80b4da.jpg","comment_is_top":false,"comment_ctime":1557884808,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"10147819400","product_id":100024501,"comment_content":"YYKit é‡Œé¢çš„ å°è£…runloop å’ŒGCDçš„éƒ¨åˆ† éå¸¸å¥½ç”¨","like_count":2},{"had_liked":false,"id":94920,"user_name":"Tristan","can_delete":false,"product_type":"c1","uid":1456669,"ip_address":"","ucode":"A9AF47D0B8FC08","user_header":"https://static001.geekbang.org/account/avatar/00/16/3a/1d/508fe169.jpg","comment_is_top":false,"comment_ctime":1557923705,"is_pvip":false,"discussion_count":2,"race_medal":0,"score":"5852891001","product_id":100024501,"comment_content":" NSMutableAttributedString * attrStr = [[NSMutableAttributedString alloc] initWithData:[htmlString dataUsingEncoding:NSUnicodeStringEncoding] options:@{ NSDocumentTypeDocumentAttribute: NSHTMLTextDocumentType } documentAttributes:nil error:nil];","like_count":1,"discussions":[{"author":{"id":1823275,"avatar":"https://static001.geekbang.org/account/avatar/00/1b/d2/2b/7a93d588.jpg","nickname":"ä½è°ƒçš„é­…åŠ›","note":"","ucode":"AE5CA2986B5A95","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":347005,"discussion_content":"æ€§èƒ½å¤ªå·®ï¼Œæ˜¾ç¤ºæ•ˆæœä¹Ÿä¸ç†æƒ³","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1612141384,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1472809,"avatar":"https://static001.geekbang.org/account/avatar/00/16/79/29/c8cd0399.jpg","nickname":"é²å¿—åˆš","note":"","ucode":"8E0A9DAE5E22D2","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":4713,"discussion_content":"å¦‚æœç½‘é¡µåŠ è½½éœ€è¦åç§’ï¼Œä¸»çº¿ç¨‹å°±ä¼šè¢«å¡åç§’ï¼Œè¿™æ–¹æ³•æœ‰ç‚¹å‘äºº","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1565682959,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":94371,"user_name":"å¹å•Šå¹å¹","can_delete":false,"product_type":"c1","uid":1455385,"ip_address":"","ucode":"FFB7D85C26145B","user_header":"https://static001.geekbang.org/account/avatar/00/16/35/19/4f9dc4b5.jpg","comment_is_top":false,"comment_ctime":1557797493,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"5852764789","product_id":100024501,"comment_content":"é“­å“¥ï¼Œgithubä¸ŠSTMURLCacheçš„å¼•ç”¨çš„æ–‡ä»¶æœ‰ç‚¹å¤šå•Šï¼Œéœ€è¦å…¨éƒ¨ä½¿ç”¨ï¼Ÿ","like_count":1},{"had_liked":false,"id":122319,"user_name":"Sun0010","can_delete":false,"product_type":"c1","uid":1263832,"ip_address":"","ucode":"92B35625DCEB9B","user_header":"https://static001.geekbang.org/account/avatar/00/13/48/d8/51ab657d.jpg","comment_is_top":false,"comment_ctime":1565338101,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1565338101","product_id":100024501,"comment_content":"- (NSCachedURLResponse *)localCacheResponeWithRequest:(NSURLRequest *)request<br>if (isExist == nil) {<br>            [self.responseDic setValue:[NSNumber numberWithBool:TRUE] forKey:request.URL.absoluteString];<br>            NSURLSession *session = [NSURLSession sharedSession];<br>            NSURLSessionDataTask *task = [session dataTaskWithRequest:request completionHandler:^(NSData * _Nullable data, NSURLResponse * _Nullable response, NSError * _Nullable error) {<br>                if (error) {<br>                    cachedResponse = nil;<br>                } else {<br>                    NSDictionary *dic = [NSDictionary dictionaryWithObjectsAndKeys:[NSString stringWithFormat:@&quot;%f&quot;,[date timeIntervalSince1970]],@&quot;time&quot;,response.MIMEType,@&quot;MIMEType&quot;,response.textEncodingName,@&quot;textEncodingName&quot;, nil];<br>                    BOOL resultO = [dic writeToFile:otherInfoPath atomically:YES];<br>                    BOOL result = [data writeToFile:filePath atomically:YES];<br>                    if (resultO == NO || result == NO) {<br>                    } else {<br>                    }<br>                    cachedResponse = [[NSCachedURLResponse alloc] initWithResponse:response data:data];<br>                }<br>            }];<br>            [task resume];<br>            return cachedResponse;<br>        }<br>        return nil;<br><br><br>å› ä¸º [session dataTaskWithRequest:request completionHandler:^]æ˜¯å¼‚æ­¥è¯·æ±‚ï¼Œæ‰€ä»¥ cachedResponse = [[NSCachedURLResponse alloc] initWithResponse:response data:data]; å…¶å®æ˜¯æ²¡ä»€ä¹ˆæ•ˆæœ?<br>","like_count":0},{"had_liked":false,"id":110316,"user_name":"findU","can_delete":false,"product_type":"c1","uid":1471551,"ip_address":"","ucode":"B3F26ED4E5A29D","user_header":"https://static001.geekbang.org/account/avatar/00/16/74/3f/52fa1e72.jpg","comment_is_top":false,"comment_ctime":1562229019,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1562229019","product_id":100024501,"comment_content":"è€å¸ˆï¼ŒWKURLSchemeHandleræ˜¯å†11.0ä¹‹åæ‰æ”¯æŒçš„APIï¼Œè€Œä¸”å¦‚æœç”¨WKä½¿ç”¨NSURLProtocolåšé™æ€èµ„æºç¼“å­˜çš„è¯éœ€è¦å¤„ç†è‹¹æœçš„ç§æœ‰APIï¼ˆå­˜åœ¨ä¸€å®šçš„è¢«æ‹’é£é™©ï¼‰ã€‚","like_count":0},{"had_liked":false,"id":101349,"user_name":"tomcat","can_delete":false,"product_type":"c1","uid":1133556,"ip_address":"","ucode":"A7CE9FEE5E03CD","user_header":"https://static001.geekbang.org/account/avatar/00/11/4b/f4/de7809c1.jpg","comment_is_top":false,"comment_ctime":1559786370,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1559786370","product_id":100024501,"comment_content":"ä¸€ä¸ªè‡ªå®šä¹‰çš„NSURLProtocolå¤„ç†ä¸€ç§äº‹æƒ…ï¼Œå¦‚æœæƒ³æ‹¦æˆªä¸€ä¸ªç½‘ç»œè¯·æ±‚ï¼Œç„¶åç»è¿‡å±‚å±‚è‡ªå®šä¹‰NSURLProtocolï¼ŒåŠŸè€—å’Œæ•ˆç‡æœ‰æ¯”è¾ƒå¤§çš„å½±å“å—ï¼Ÿ","like_count":0},{"had_liked":false,"id":98887,"user_name":"xilie","can_delete":false,"product_type":"c1","uid":1013805,"ip_address":"","ucode":"AFCC4E157F7830","user_header":"https://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTJVegfjqa0gM4hcRrBhZkIf7Uc5oeTMYsg6o5pd76IQlUoIIh2ic6P22xVEFtRnAzjyLtiaPVstkKug/132","comment_is_top":false,"comment_ctime":1559113198,"is_pvip":false,"discussion_count":2,"race_medal":0,"score":"1559113198","product_id":100024501,"comment_content":"é•¿åˆ—è¡¨ FPS æ€§èƒ½ä¼˜åŒ–çš„é—®é¢˜ï¼Œçœ‹åˆ°éƒ½ 9102 å¹´äº†ï¼Œè¿˜å¥½å¤šæ–‡ç« ä»‹ç»è®¡ç®—é«˜åº¦å¹¶ç¼“å­˜çš„æ–¹æ¡ˆï¼ŒSelf-Sizing è¿˜æ²¡æ™®åŠå—ï¼Ÿå¤§å®¶éƒ½è¿˜æ‰‹åŠ¨ç®—çš„å—ï¼Ÿæ€§èƒ½æ›´å¥½ï¼Ÿ","like_count":1,"discussions":[{"author":{"id":1471551,"avatar":"https://static001.geekbang.org/account/avatar/00/16/74/3f/52fa1e72.jpg","nickname":"findU","note":"","ucode":"B3F26ED4E5A29D","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":1002,"discussion_content":"è®¡ç®—é«˜åº¦ç¼“å­˜çš„æ–¹æ¡ˆæ–‡ç« éƒ½æ˜¯å„ç§æŠ„ä»¥å‰çš„è€ï¼ˆè¿‡æ—¶ï¼‰æ–‡ç« ã€‚å‘ç°ç°åœ¨ç½‘ç»œä¸Šç°åœ¨å……æ–¥ç€å¤§é‡ä½è´¨é‡åšæ–‡ï¼ˆæ‰€ä»¥æœé—®é¢˜åƒä¸‡åˆ«ä¸Šç™¾åº¦ï¼ŒğŸ˜‚ï¼‰ï¼Œå¦‚æœè‡ªå·±æ²¡æœ‰å¾ˆå¥½çš„åŸºç¡€çš„è¯å¾ˆå®¹æ˜“è¢«å¸¦è¿›æ²Ÿé‡Œã€‚","likes_number":1,"is_delete":false,"is_hidden":false,"ctime":1562229354,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1471617,"avatar":"https://static001.geekbang.org/account/avatar/00/16/74/81/b54fd36e.jpg","nickname":"åº","note":"","ucode":"690822796EAF36","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":410702,"discussion_content":"è®¡ç®—é«˜åº¦å¹¶ç¼“å­˜æˆ‘äº²æµ‹æ„Ÿè§‰æ¯”self-sizingæ€§èƒ½é«˜å•Š","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1635760417,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":98885,"user_name":"xilie","can_delete":false,"product_type":"c1","uid":1013805,"ip_address":"","ucode":"AFCC4E157F7830","user_header":"https://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTJVegfjqa0gM4hcRrBhZkIf7Uc5oeTMYsg6o5pd76IQlUoIIh2ic6P22xVEFtRnAzjyLtiaPVstkKug/132","comment_is_top":false,"comment_ctime":1559112979,"is_pvip":false,"discussion_count":1,"race_medal":0,"score":"1559112979","product_id":100024501,"comment_content":"çœ‹äº†ä¸‹ Github YYText çš„ä»£ç æ˜¯ 3 å¹´å‰çš„ï¼Œå‡ ç™¾ä¸ªæ²¡å…³çš„ issuesï¼Œæ²¡ç»´æŠ¤äº†å—ï¼Ÿè¿™ä¸ªåº“è¿˜é€‚åˆç°åœ¨ç”¨å—ï¼Ÿ","like_count":0,"discussions":[{"author":{"id":1471551,"avatar":"https://static001.geekbang.org/account/avatar/00/16/74/3f/52fa1e72.jpg","nickname":"findU","note":"","ucode":"B3F26ED4E5A29D","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":1000,"discussion_content":"è¿™ä¸ªåº“å¥½åƒä¸ç»´æŠ¤äº†","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1562229057,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":94383,"user_name":"æ·¡","can_delete":false,"product_type":"c1","uid":1456392,"ip_address":"","ucode":"6856CA319DE2F0","user_header":"https://static001.geekbang.org/account/avatar/00/16/39/08/09055b47.jpg","comment_is_top":false,"comment_ctime":1557798381,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1557798381","product_id":100024501,"comment_content":"æˆ‘æƒ³é—®ä¸‹å…³äºå¯Œæ–‡æœ¬é‡ŒåŒ…å«&lt;img scr=&#39;http:xxx&#39;&gt; è¿™ç§è¯¥æ€ä¹ˆå¤„ç†å‘¢ï¼Œå°¤å…¶æ˜¯åœ¨é•¿åˆ—è¡¨é‡Œ","like_count":0}]}