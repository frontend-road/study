{"id":109729,"title":"29 | Faraday网关代码解析（上）","content":"<ul>\n<li>\n<p>代码：<a href=\"https://gitee.com/geektime-geekbang/staffjoy\">https://gitee.com/geektime-geekbang/staffjoy</a></p>\n</li>\n<li>\n<p>课件：<a href=\"https://pan.baidu.com/s/1Q7eP3yZ1Vm8J2nhle5RzTQ\">https://pan.baidu.com/s/1Q7eP3yZ1Vm8J2nhle5RzTQ</a> 提取码: 1aeh</p>\n</li>\n</ul>","comments":[{"had_liked":false,"id":117579,"user_name":"面朝大海","can_delete":false,"product_type":"c3","uid":1600552,"ip_address":"","ucode":"E544A5441A0330","user_header":"https://static001.geekbang.org/account/avatar/00/18/6c/28/39a71e18.jpg","comment_is_top":false,"comment_ctime":1564098064,"is_pvip":false,"replies":[{"id":43153,"content":"ReverseProxyFilter通过FilterRegistrationBean注册到Spring容器环境中，Spring会自动将这个Filter注册到Web容器中。参考faraday项目源码中的config&#47;FaradayConfiguration这个Bean配置文件。","user_name":"作者回复","user_name_real":"杨波","uid":1030344,"ctime":1564146074,"ip_address":"","comment_id":117579,"utype":1}],"discussion_count":1,"race_medal":0,"score":2,"product_id":100031401,"comment_content":"请问Faraday网关，代码启动流程是怎样，ReverseProxyFilter怎么被调用？","like_count":1,"discussions":[{"author":{"id":1030344,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/b8/c8/c94d38a7.jpg","nickname":"杨波","note":"","ucode":"FA3418BB703BCA","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":460036,"discussion_content":"ReverseProxyFilter通过FilterRegistrationBean注册到Spring容器环境中，Spring会自动将这个Filter注册到Web容器中。参考faraday项目源码中的config/FaradayConfiguration这个Bean配置文件。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1564146074,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":226161,"user_name":"Geek_da9deb","can_delete":false,"product_type":"c3","uid":1317517,"ip_address":"","ucode":"724968A3A34334","user_header":"http://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTJOVESb7PSBa7SHZX3PEvrt0iaSDnUaSCMqfdIl3icT4o1SJbSDh8S3hqmJKrx0V3pgDWPcp1icxeXog/132","comment_is_top":false,"comment_ctime":1591967561,"is_pvip":false,"replies":[{"id":83694,"content":"这些final是通过Spring依赖注入促使化的，Spring容器会识别这些final，然后容器会用已经初始化好的其它bean(比如FaradayProperties&#47;ServerProperties等)，通过调用构造函数来初始化FaradayConfiguration这个Bean，同时也初始化这些final属性。","user_name":"作者回复","user_name_real":"杨波","uid":1030344,"ctime":1592321641,"ip_address":"","comment_id":226161,"utype":1}],"discussion_count":2,"race_medal":0,"score":2,"product_id":100031401,"comment_content":"老师您好，请问这几个final属性是怎么被初始化的，项目中咩有找到实列化或者配置FaradayConfiguration bean的代码呀？\npublic class FaradayConfiguration {\n\n    protected final FaradayProperties faradayProperties;\n    protected final ServerProperties serverProperties;\n    protected final StaffjoyPropreties staffjoyPropreties;\n    protected final AssetLoader assetLoader;\n\n    public FaradayConfiguration(FaradayProperties faradayProperties,\n                                ServerProperties serverProperties,\n                                StaffjoyPropreties staffjoyPropreties,\n                                AssetLoader assetLoader) {\n        this.faradayProperties = faradayProperties;\n        this.serverProperties = serverProperties;\n        this.staffjoyPropreties = staffjoyPropreties;\n        this.assetLoader = assetLoader;\n    }\n}","like_count":0,"discussions":[{"author":{"id":1030344,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/b8/c8/c94d38a7.jpg","nickname":"杨波","note":"","ucode":"FA3418BB703BCA","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":498130,"discussion_content":"这些final是通过Spring依赖注入促使化的，Spring容器会识别这些final，然后容器会用已经初始化好的其它bean(比如FaradayProperties/ServerProperties等)，通过调用构造函数来初始化FaradayConfiguration这个Bean，同时也初始化这些final属性。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1592321641,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1317517,"avatar":"http://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTJOVESb7PSBa7SHZX3PEvrt0iaSDnUaSCMqfdIl3icT4o1SJbSDh8S3hqmJKrx0V3pgDWPcp1icxeXog/132","nickname":"Geek_da9deb","note":"","ucode":"724968A3A34334","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":283820,"discussion_content":"谢谢老师，刚转JAVA，还在打基础。感谢老师解答这么初级的问题！","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1592374397,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":190290,"user_name":"jatham","can_delete":false,"product_type":"c3","uid":1857669,"ip_address":"","ucode":"08827292AEE807","user_header":"","comment_is_top":false,"comment_ctime":1584627174,"is_pvip":false,"replies":[{"id":73427,"content":"加油！","user_name":"作者回复","user_name_real":"杨波","uid":1030344,"ctime":1584792160,"ip_address":"","comment_id":190290,"utype":1}],"discussion_count":1,"race_medal":0,"score":2,"product_id":100031401,"comment_content":"跟波波老师多学习学习","like_count":0,"discussions":[{"author":{"id":1030344,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/b8/c8/c94d38a7.jpg","nickname":"杨波","note":"","ucode":"FA3418BB703BCA","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":487940,"discussion_content":"加油！","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1584792160,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":176515,"user_name":"Geek_n5jcko","can_delete":false,"product_type":"c3","uid":1439466,"ip_address":"","ucode":"833B47688ED00C","user_header":"http://thirdwx.qlogo.cn/mmopen/vi_32/JVOiclOoyFvgJHNXRgqB9RL9UUcQ7k4PByzbDiclrUR4rrSXQBEPpPOQoTSmO90RMPbfeT8d57UDlrOJ6b2gZiaRA/132","comment_is_top":false,"comment_ctime":1581078897,"is_pvip":false,"replies":[{"id":68606,"content":"Intellij IDE?\n\n根pom中不需要再引入springboot核心包，因为dependencyManagement中已经有spring-boot-dependencies pom的导入。\n\n你导入项目不成功，估计是环境问题，建议换个环境再试。","user_name":"作者回复","user_name_real":"杨波","uid":1030344,"ctime":1581165994,"ip_address":"","comment_id":176515,"utype":1}],"discussion_count":1,"race_medal":0,"score":2,"product_id":100031401,"comment_content":"想问下老师，github源码中根目录的pom文件没有\n&lt;parent&gt;\n        &lt;groupId&gt;org.springframework.boot&lt;&#47;groupId&gt;\n        &lt;artifactId&gt;spring-boot-starter-parent&lt;&#47;artifactId&gt;\n        &lt;version&gt;2.2.2.RELEASE&lt;&#47;version&gt;\n    &lt;&#47;parent&gt;\n那springboot的核心包有引进去吗？现在我看IDE里面一片红呀。","like_count":0,"discussions":[{"author":{"id":1030344,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/b8/c8/c94d38a7.jpg","nickname":"杨波","note":"","ucode":"FA3418BB703BCA","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":483128,"discussion_content":"Intellij IDE?\n\n根pom中不需要再引入springboot核心包，因为dependencyManagement中已经有spring-boot-dependencies pom的导入。\n\n你导入项目不成功，估计是环境问题，建议换个环境再试。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1581165994,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":175273,"user_name":"spencerfeng","can_delete":false,"product_type":"c3","uid":1206006,"ip_address":"","ucode":"03FA0628E5A950","user_header":"https://static001.geekbang.org/account/avatar/00/12/66/f6/d7578c8b.jpg","comment_is_top":false,"comment_ctime":1580637776,"is_pvip":false,"replies":[{"id":68189,"content":"staffjoy由若干个微服务(Account&#47;Company&#47;Bot&#47;WhoAmI&#47;Web&#47;MyAccount&#47;App等)共同组成，Faraday网关是所有微服务的统一转发入口。","user_name":"作者回复","user_name_real":"杨波","uid":1030344,"ctime":1580731143,"ip_address":"","comment_id":175273,"utype":1}],"discussion_count":1,"race_medal":0,"score":2,"product_id":100031401,"comment_content":"波波老师您好，请问这个微服务的入口是在哪里？谢谢","like_count":0,"discussions":[{"author":{"id":1030344,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/b8/c8/c94d38a7.jpg","nickname":"杨波","note":"","ucode":"FA3418BB703BCA","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":482672,"discussion_content":"staffjoy由若干个微服务(Account/Company/Bot/WhoAmI/Web/MyAccount/App等)共同组成，Faraday网关是所有微服务的统一转发入口。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1580731143,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":156927,"user_name":"Rule30","can_delete":false,"product_type":"c3","uid":1505406,"ip_address":"","ucode":"A1B265576BBFF8","user_header":"http://thirdwx.qlogo.cn/mmopen/vi_32/F4wluvVn7PE5nUyHptWZTEbDSZibTqCzLxRg51poajdFaoMSfCeQIq4hT2daaAe0N9wYgKicl0FyWibbZlLDUWBhw/132","comment_is_top":false,"comment_ctime":1574997508,"is_pvip":false,"replies":[{"id":60222,"content":"你好，staffjoy项目通过域名访问的话，端口都是默认80，faraday网关在收到来自不同子域(比如myaccount&#47;www等)的请求后，会根据路由表进行转发，换句话说faraday网关屏蔽了底层服务的不同端口，对外统一呈现80。\n\n建议先采用dev环境，也就是本地ide环境里头进行调试，可以跟踪到faraday网关，还有www服务的代码里头去(代码不多)，看看为何跳转不成功。如果还有问题，可加我微信解决(bulldog2015，说明来自极客时间的用户)。","user_name":"作者回复","user_name_real":"杨波","uid":1030344,"ctime":1575010576,"ip_address":"","comment_id":156927,"utype":1}],"discussion_count":1,"race_medal":0,"score":2,"product_id":100031401,"comment_content":"老师您好，我已经把程序跑起来了，switchhost也已经部署好了，但是跳转的时候没有按照网关路由转发的端口号进行跳转，在注册的时候跳转一直是80端口，请问需要检查哪方面的配置呢","like_count":0,"discussions":[{"author":{"id":1030344,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/b8/c8/c94d38a7.jpg","nickname":"杨波","note":"","ucode":"FA3418BB703BCA","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":476271,"discussion_content":"你好，staffjoy项目通过域名访问的话，端口都是默认80，faraday网关在收到来自不同子域(比如myaccount/www等)的请求后，会根据路由表进行转发，换句话说faraday网关屏蔽了底层服务的不同端口，对外统一呈现80。\n\n建议先采用dev环境，也就是本地ide环境里头进行调试，可以跟踪到faraday网关，还有www服务的代码里头去(代码不多)，看看为何跳转不成功。如果还有问题，可加我微信解决(bulldog2015，说明来自极客时间的用户)。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1575010576,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":135766,"user_name":"jshadow","can_delete":false,"product_type":"c3","uid":1149128,"ip_address":"","ucode":"5086660EBC4D21","user_header":"https://static001.geekbang.org/account/avatar/00/11/88/c8/1e8f99c8.jpg","comment_is_top":false,"comment_ctime":1569255836,"is_pvip":false,"replies":[{"id":52117,"content":"从你描述我没有看出具体什么问题，可以加我微信(bulldog2015，说明来自极客时间)，进一步了解细节。","user_name":"作者回复","user_name_real":"杨波","uid":1030344,"ctime":1569328512,"ip_address":"","comment_id":135766,"utype":1}],"discussion_count":1,"race_medal":0,"score":2,"product_id":100031401,"comment_content":"老师您好，请问项目里全局格式化处理BaseResponse Json格式的地方在哪里了？因为按照您的视频里，我这边返回的Json格式不太对，谢谢老师！","like_count":0,"discussions":[{"author":{"id":1030344,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/b8/c8/c94d38a7.jpg","nickname":"杨波","note":"","ucode":"FA3418BB703BCA","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":468332,"discussion_content":"从你描述我没有看出具体什么问题，可以加我微信(bulldog2015，说明来自极客时间)，进一步了解细节。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1569328512,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":126868,"user_name":"飞翔","can_delete":false,"product_type":"c3","uid":1068571,"ip_address":"","ucode":"65AF6AF292DAD6","user_header":"https://static001.geekbang.org/account/avatar/00/10/4e/1b/f4b786b9.jpg","comment_is_top":false,"comment_ctime":1566501510,"is_pvip":false,"replies":[{"id":47031,"content":"faraday依赖于一个sentry_dsn的配置，否则会启动失败(sentry是集中异常日志监控云服务)，你可以启用下面这个本地集中配置（注意修改文件名把.example去掉），\nhttps:&#47;&#47;github.com&#47;spring2go&#47;staffjoy&#47;blob&#47;master&#47;config&#47;application.yml.example\n\n你也可以先看后面第8章本地部署视频，里头有讲如何在本地ide里头运行fraday和staffjoy应用，包括需要先做哪些配置。","user_name":"作者回复","user_name_real":"杨波","uid":1030344,"ctime":1566565991,"ip_address":"","comment_id":126868,"utype":1}],"discussion_count":3,"race_medal":0,"score":2,"product_id":100031401,"comment_content":"老师 求教 话说我单独启动faraday 出现 这个错误\n22-08-2019 15:12:10.391 [restartedMain] ERROR io.sentry.SentryClientFactory.resolveDsn - Error creating valid DSN from: &#39;${SENTRY_DSN}&#39;.\njava.lang.IllegalArgumentException: Illegal character in path at index 1: ${SENTRY_DSN}\n\tat java.net.URI.create(URI.java:852)","like_count":0,"discussions":[{"author":{"id":1030344,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/b8/c8/c94d38a7.jpg","nickname":"杨波","note":"","ucode":"FA3418BB703BCA","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":464213,"discussion_content":"faraday依赖于一个sentry_dsn的配置，否则会启动失败(sentry是集中异常日志监控云服务)，你可以启用下面这个本地集中配置（注意修改文件名把.example去掉），\nhttps://github.com/spring2go/staffjoy/blob/master/config/application.yml.example\n\n你也可以先看后面第8章本地部署视频，里头有讲如何在本地ide里头运行fraday和staffjoy应用，包括需要先做哪些配置。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1566565991,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1106506,"avatar":"https://static001.geekbang.org/account/avatar/00/10/e2/4a/3f07e217.jpg","nickname":"王杰","note":"","ucode":"4E3B2A0F1C75F6","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":5942,"discussion_content":"application.yml.example  文件中\n staffjoy:\n  common:\n    sentry-dsn: https://80bbf4ae778b525f9fe72e2813cd5246@sentry.io/1271087\n需要怎么关联吗？","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1566543901,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1106506,"avatar":"https://static001.geekbang.org/account/avatar/00/10/e2/4a/3f07e217.jpg","nickname":"王杰","note":"","ucode":"4E3B2A0F1C75F6","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":5941,"discussion_content":"我在启动时候也出现这种情况，希望老师解答一下","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1566543725,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":118122,"user_name":"威威","can_delete":false,"product_type":"c3","uid":1610195,"ip_address":"","ucode":"9069ABDBB37426","user_header":"https://static001.geekbang.org/account/avatar/00/18/91/d3/908b1b72.jpg","comment_is_top":false,"comment_ctime":1564252262,"is_pvip":false,"replies":[{"id":43318,"content":"你好，Idea里头报错是因为没有启用lombok，请启用一下，方法可以在网上搜一下。我的微信号:bulldog2015，加微信说明来自极客时间。","user_name":"作者回复","user_name_real":"杨波","uid":1030344,"ctime":1564320371,"ip_address":"","comment_id":118122,"utype":1}],"discussion_count":1,"race_medal":0,"score":2,"product_id":100031401,"comment_content":"老师您好，源码下来在Idea里会报错，在AccountService中private final AccountRepo accountRepo 会提示 “variable accountRepo might not have been initialized”，另外在 下面的代码中也会提示“cannot resolve method build”，应该怎么解呢？您有微信吗？或者其他的渠道方便请教问题的，谢谢。\nAccount account = Account.builder()\n                .email(email).name(name).phoneNumber(phoneNumber)\n                .build();","like_count":0,"discussions":[{"author":{"id":1030344,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/b8/c8/c94d38a7.jpg","nickname":"杨波","note":"","ucode":"FA3418BB703BCA","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":460272,"discussion_content":"你好，Idea里头报错是因为没有启用lombok，请启用一下，方法可以在网上搜一下。我的微信号:bulldog2015，加微信说明来自极客时间。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1564320371,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":357573,"user_name":"Geek9285","can_delete":false,"product_type":"c3","uid":2830976,"ip_address":"天津","ucode":"2C637723CDF997","user_header":"","comment_is_top":false,"comment_ctime":1663408497,"is_pvip":false,"replies":null,"discussion_count":0,"race_medal":0,"score":2,"product_id":100031401,"comment_content":"老师您好，httpclient为什么要根据路由创建不同实例，我看httpclient exchange接口是需要完整的url参数的，也就是需要把目标服务host传进去，感觉一个实例也可以做这件事，创建多个httpclient的好处是什么","like_count":1},{"had_liked":false,"id":357574,"user_name":"Geek9285","can_delete":false,"product_type":"c3","uid":2830976,"ip_address":"天津","ucode":"2C637723CDF997","user_header":"","comment_is_top":false,"comment_ctime":1663408593,"is_pvip":false,"replies":null,"discussion_count":1,"race_medal":0,"score":3,"product_id":100031401,"comment_content":"老师您好，httpclient为什么要根据路由创建不同实例，我看httpclient exchange接口是需要完整的url参数的，也就是需要把目标服务host传进去，感觉一个实例也可以做这件事，创建多个httpclient的好处是什么","like_count":0,"discussions":[{"author":{"id":1117318,"avatar":"https://static001.geekbang.org/account/avatar/00/11/0c/86/8e52afb8.jpg","nickname":"花花大脸猫","note":"","ucode":"8ABDB3F7F4FB0F","race_medal":0,"user_type":1,"is_pvip":true},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":598812,"discussion_content":"我觉得可以尝试理解下PoolingHttpClientConnectionManager中maxTotal与maxPerRoute的想法，不过staffjoy源码里面应该是没有池化的逻辑在的。不过楼主的说法也没问题，确实可以共用","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1673099384,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":"江苏","group_id":0},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]}]}