{"id":86766,"title":"41 | çº¿æ€§å›å½’ï¼ˆä¸‹ï¼‰ï¼šå¦‚ä½•ä½¿ç”¨æœ€å°äºŒä¹˜æ³•è¿›è¡Œæ•ˆæœéªŒè¯ï¼Ÿ","content":"<p>ä½ å¥½ï¼Œæˆ‘æ˜¯é»„ç”³ã€‚</p><p>ä¸Šä¸€èŠ‚æˆ‘ä»¬å·²ç»è§£é‡Šäº†æœ€å°äºŒä¹˜æ³•çš„æ ¸å¿ƒæ€æƒ³å’Œå…·ä½“æ¨å¯¼è¿‡ç¨‹ã€‚ä»Šå¤©æˆ‘ä»¬å°±ç”¨å®é™…çš„æ•°æ®æ“ç»ƒä¸€ä¸‹ï¼Œè¿™æ ·ä½ çš„å°è±¡å°±ä¼šæ›´åŠ æ·±åˆ»ã€‚æˆ‘ä¼šä½¿ç”¨å‡ ä¸ªå…·ä½“çš„ä¾‹å­ï¼Œæ¼”ç¤ºä¸€ä¸‹å¦‚ä½•ä½¿ç”¨æœ€å°äºŒä¹˜æ³•çš„ç»“è®ºï¼Œé€šè¿‡è§‚æµ‹åˆ°çš„è‡ªå˜é‡å’Œå› å˜é‡å€¼ï¼Œæ¥æ¨ç®—ç³»æ•°ï¼Œå¹¶ä½¿ç”¨è¿™ä¸ªç³»æ•°æ¥è¿›è¡Œæ–°çš„é¢„æµ‹ã€‚</p><h2>åŸºäºæœ€å°äºŒä¹˜æ³•çš„æ±‚è§£</h2><p>å‡æƒ³æˆ‘ä»¬æ‰‹å¤´ä¸Šæœ‰ä¸€ä¸ªæ•°æ®é›†ï¼Œé‡Œé¢æœ‰3æ¡æ•°æ®è®°å½•ã€‚æ¯æ¡æ•°æ®è®°å½•æœ‰2ç»´ç‰¹å¾ï¼Œä¹Ÿå°±æ˜¯2ä¸ªè‡ªå˜é‡ï¼Œå’Œ1ä¸ªå› å˜é‡ã€‚</p><p><img src=\"https://static001.geekbang.org/resource/image/94/b4/9427dc10b0745cb5680e911e0d0d15b4.png?wh=1270*300\" alt=\"\"></p><p>å¦‚æœæˆ‘ä»¬å‡è®¾è¿™äº›è‡ªå˜é‡å’Œå› å˜é‡éƒ½æ˜¯çº¿æ€§çš„å…³ç³»ï¼Œé‚£ä¹ˆæˆ‘ä»¬å°±å¯ä»¥ä½¿ç”¨å¦‚ä¸‹è¿™ç§çº¿æ€§æ–¹ç¨‹ï¼Œæ¥è¡¨ç¤ºæ•°æ®é›†ä¸­çš„æ ·æœ¬ï¼š</p><p>$b_1Â·0+b_2Â·1=1.5$<br>\n$b_1Â·1-b_2Â·1=-0.5$<br>\n$b_1Â·2+b_2Â·8=14$</p><p>ä¹Ÿå°±æ˜¯è¯´ï¼Œæˆ‘ä»¬é€šè¿‡è§‚å¯Ÿæ•°æ®å·²çŸ¥äº†è‡ªå˜é‡$x_1$ã€$x_2$å’Œå› å˜é‡$y$çš„å€¼ï¼Œè€Œè¦æ±‚è§£çš„æ˜¯$b_1$å’Œ$b_2$è¿™ä¸¤ä¸ªç³»æ•°ã€‚å¦‚æœæˆ‘ä»¬èƒ½æ±‚å‡º$b_1$å’Œ$b_2$ï¼Œé‚£ä¹ˆåœ¨å¤„ç†æ–°æ•°æ®çš„æ—¶å€™ï¼Œå°±èƒ½æ ¹æ®æ–°çš„è‡ªå˜é‡$x_1$å’Œ$x_2$çš„å–å€¼ï¼Œæ¥é¢„æµ‹$y$çš„å€¼ã€‚</p><!-- [[[read_end]]] --><p>å¯æ˜¯æˆ‘ä»¬è¯´è¿‡ï¼Œç”±å®é™…é¡¹ç›®ä¸­çš„æ•°æ®é›†æ‰€æ„æˆçš„è¿™ç±»æ–¹ç¨‹ç»„ï¼Œåœ¨ç»å¤§å¤šæ•°æƒ…å†µä¸‹ï¼Œéƒ½æ²¡æœ‰ç²¾ç¡®è§£ã€‚æ‰€ä»¥è¿™ä¸ªæ—¶å€™æˆ‘ä»¬æ²¡æ³•ä½¿ç”¨ä¹‹å‰ä»‹ç»çš„é«˜æ–¯æ¶ˆå…ƒæ³•ï¼Œè€Œæ˜¯è¦è€ƒè™‘æœ€å°äºŒä¹˜æ³•ã€‚æ ¹æ®ä¸Šä¸€èŠ‚çš„ç»“è®ºï¼Œæˆ‘ä»¬çŸ¥é“å¯¹äºç³»æ•°çŸ©é˜µ$B$ï¼Œæœ‰ï¼š</p><p>$B=(Xâ€™X)^{-1}Xâ€™Y$</p><p>æ—¢ç„¶æœ‰äº†è¿™ä¸ªå…¬å¼ï¼Œè¦æ±‚$B$å°±ä¸éš¾äº†ï¼Œè®©æˆ‘ä»¬ä»æœ€åŸºæœ¬çš„å‡ ä¸ªçŸ©é˜µå¼€å§‹ã€‚</p><p><img src=\"https://static001.geekbang.org/resource/image/f2/9d/f2f70be34564a2e64071cd623d0e3f9d.png?wh=912*1028\" alt=\"\"></p><p>çŸ©é˜µ$(Xâ€™X)^{-1}$çš„æ±‚è§£ç¨å¾®ç¹çä¸€ç‚¹ã€‚é€†çŸ©é˜µçš„æ±‚æ³•æˆ‘è¿˜æ²¡è®²è§£è¿‡ï¼Œä¹‹å‰æˆ‘ä»¬è¯´è¿‡çº¿æ€§æ–¹ç¨‹ç»„ä¹‹ä¸­ï¼Œé«˜æ–¯æ¶ˆå…ƒå’Œå›ä»£çš„è¿‡ç¨‹ï¼Œå°±æ˜¯æŠŠç³»æ•°çŸ©é˜µå˜ä¸ºå•ä½çŸ©é˜µçš„è¿‡ç¨‹ã€‚æˆ‘ä»¬å¯ä»¥åˆ©ç”¨è¿™ç‚¹ï¼Œæ¥æ±‚è§£$X^{-1}$ã€‚æˆ‘ä»¬æŠŠåŸå§‹çš„ç³»æ•°çŸ©é˜µ$X$åˆ—åœ¨å·¦è¾¹ï¼Œç„¶åæŠŠå•ä½çŸ©é˜µåˆ—åœ¨å³è¾¹ï¼Œåƒ$[X | I]$è¿™ç§å½¢å¼ï¼Œå…¶ä¸­$I$è¡¨ç¤ºå•ä½çŸ©é˜µã€‚</p><p>ç„¶åæˆ‘ä»¬å¯¹å·¦ä¾§çš„çŸ©é˜µè¿›è¡Œé«˜æ–¯æ¶ˆå…ƒå’Œå›ä»£ï¼ŒæŠŠå·¦è¾¹çŸ©é˜µXå˜ä¸ºå•ä½çŸ©é˜µã€‚åŒæ—¶ï¼Œæˆ‘ä»¬ä¹ŸæŠŠè¿™ä¸ªç›¸åº”çš„çŸ©é˜µæ“ä½œè¿ç”¨åœ¨å³ä¾§ã€‚è¿™æ ·å½“å·¦ä¾§å˜ä¸ºå•ä½çŸ©é˜µä¹‹åï¼Œé‚£ä¹ˆå³ä¾§çš„çŸ©é˜µå°±æ˜¯åŸå§‹çŸ©é˜µ$X$çš„é€†çŸ©é˜µ$X^{-1}$ï¼Œå…·ä½“è¯æ˜å¦‚ä¸‹ï¼š</p><p>$[X | I]$<br>\n$[X^{-1}X | X^{-1}I]$<br>\n$[I | X^{-1}I]$<br>\n$[I | X^{-1}]$</p><p>å¥½äº†ï¼Œç»™å®šä¸‹é¢çš„$Xâ€™X$çŸ©é˜µä¹‹åï¼Œæˆ‘ä»¬ä½¿ç”¨ä¸Šè¿°æ–¹æ³•æ¥æ±‚$(Xâ€™X)^{-1}$ ã€‚æˆ‘æŠŠå…·ä½“çš„æ¨å¯¼è¿‡ç¨‹åˆ—åœ¨äº†è¿™é‡Œã€‚</p><p><img src=\"https://static001.geekbang.org/resource/image/1a/ad/1a6f3815a9895fc80f54124a1dae7cad.png?wh=1344*696\" alt=\"\"></p><p>æ±‚å‡º$(Xâ€™X)^{-1}$ä¹‹åï¼Œæˆ‘ä»¬å°±å¯ä»¥ä½¿ç”¨$B=(Xâ€™X)^{-1}Xâ€™Y$æ¥è®¡ç®—çŸ©é˜µBã€‚</p><p><img src=\"https://static001.geekbang.org/resource/image/fe/3d/fe4c0b674649e5a18b5992c71316253d.png?wh=1328*534\" alt=\"\"></p><p>æœ€ç»ˆï¼Œæˆ‘ä»¬æ±‚å‡ºç³»æ•°çŸ©é˜µä¸º$[1 1.5]$ï¼Œä¹Ÿå°±æ˜¯è¯´$b_1 = 1$, $b_2 = 1.5$ã€‚å®é™…ä¸Šï¼Œè¿™ä¸¤ä¸ªæ•°å€¼æ˜¯ç²¾ç¡®è§£ã€‚æˆ‘ä»¬ç”¨é«˜æ–¯æ¶ˆå…ƒä¹Ÿæ˜¯èƒ½è·å¾—åŒæ ·ç»“æœçš„ã€‚æ¥ä¸‹æ¥ï¼Œè®©æˆ‘ç¨å¾®ä¿®æ”¹ä¸€ä¸‹$y$å€¼ï¼Œè®©è¿™ä¸ªæ–¹ç¨‹ç»„æ²¡æœ‰ç²¾ç¡®è§£ã€‚</p><p>$b_1Â·0+b_2Â·1=1.4$<br>\n$b_1Â·1-b_2Â·1=-0.48$<br>\n$b_1Â·2+b_2Â·8=13.2$</p><p>ä½ å¯ä»¥å°è¯•é«˜æ–¯æ¶ˆå…ƒæ³•å¯¹è¿™ä¸ªæ–¹ç¨‹ç»„æ±‚è§£ï¼Œä½ ä¼šå‘ç°åªè¦ä¸¤ä¸ªæ–¹ç¨‹å°±èƒ½æ±‚å‡ºè§£ï¼Œä½†æ˜¯æ— è®ºæ˜¯å“ªä¸¤ä¸ªæ–¹ç¨‹æ±‚å‡ºçš„è§£ï¼Œéƒ½æ— æ³•æ»¡è¶³ç¬¬ä¸‰ä¸ªæ–¹ç¨‹ã€‚</p><p>é‚£ä¹ˆé€šè¿‡æœ€å°äºŒä¹˜æ³•ï¼Œæˆ‘ä»¬èƒ½ä¸èƒ½æ±‚å¯¼ä¸€ä¸ªè¿‘ä¼¼è§£ï¼Œä¿è¯_Îµ_è¶³å¤Ÿå°å‘¢ï¼Ÿä¸‹é¢ï¼Œè®©æˆ‘ä»¬éµå¾ªä¹‹å‰æ±‚è§£$(Xâ€™X)^{-1}Xâ€™Y$çš„è¿‡ç¨‹ï¼Œæ¥è®¡ç®—$B$ã€‚</p><p><img src=\"https://static001.geekbang.org/resource/image/f3/10/f3653f2fd1220936834777b62cced310.png?wh=1330*800\" alt=\"\"></p><p>è®¡ç®—å®Œæ¯•ä¹‹åï¼Œä½ ä¼šå‘ç°ä¸¤ä¸ªç³»æ•°çš„å€¼åˆ†åˆ«å˜ä¸º$b_1 = 0.938, b_2 = 1.415$ã€‚ç”±äºè¿™ä¸æ˜¯ç²¾ç¡®è§£ï¼Œæ‰€ä»¥è®©æˆ‘ä»¬çœ‹çœ‹æœ‰äº†è¿™ç³»æ•°çŸ©é˜µ$B$ä¹‹åï¼ŒåŸæœ‰çš„è§‚æµ‹æ•°æ®ä¸­ï¼ŒçœŸå®å€¼å’Œé¢„æµ‹å€¼çš„å·®åˆ«ã€‚</p><p>é¦–å…ˆæˆ‘ä»¬é€šè¿‡ç³»æ•°çŸ©é˜µ$B$å’Œè‡ªå˜é‡çŸ©é˜µ$X$è®¡ç®—å‡ºæ¥é¢„æµ‹å€¼ã€‚</p><p><img src=\"https://static001.geekbang.org/resource/image/a3/7a/a3cf56dc09e8e53304060a418ea9707a.png?wh=864*214\" alt=\"\"></p><p>ç„¶åæ˜¯æ ·æœ¬æ•°æ®ä¸­çš„è§‚æµ‹å€¼ã€‚è¿™é‡Œæˆ‘ä»¬å‡è®¾è¿™äº›å€¼æ˜¯çœŸå®å€¼ã€‚</p><p><img src=\"https://static001.geekbang.org/resource/image/a6/d9/a693f3f03a81c01d7f34e615ce473cd9.png?wh=296*238\" alt=\"\"></p><p>æ ¹æ®è¯¯å·®$Îµ$çš„å®šä¹‰ï¼Œæˆ‘ä»¬å¯ä»¥å¾—åˆ°ï¼š</p><p><img src=\"https://static001.geekbang.org/resource/image/94/20/947a02d7580305c8f3a6e19d64dbf120.png?wh=1460*144\" alt=\"\"></p><p>è¯´åˆ°è¿™é‡Œï¼Œä½ å¯èƒ½ä¼šæ€€ç–‘ï¼Œé€šè¿‡æœ€å°äºŒä¹˜æ³•æ‰€æ±‚å¾—çš„ç³»æ•°$b_1 = 0.949$å’Œ$b_2 = 1.415$ï¼Œæ˜¯ä¸æ˜¯èƒ½è®©$Îµ$æœ€å°å‘¢ï¼Ÿè¿™é‡Œï¼Œæˆ‘ä»¬éšæœºçš„ä¿®æ”¹ä¸€ä¸‹è¿™ä¸¤ä¸ªç³»æ•°ï¼Œå˜ä¸º$b_1 = 0.95$å’Œ$b_2 = 1.42$ï¼Œç„¶åæˆ‘ä»¬å†æ¬¡è®¡ç®—é¢„æµ‹çš„$y$å€¼å’Œ$Îµ$ã€‚</p><p><img src=\"https://static001.geekbang.org/resource/image/36/0e/36d8fb93ae5967f2e75cabd4da43890e.png?wh=842*236\" alt=\"\"></p><p>å¾ˆæ˜æ˜¾ï¼Œ0.064æ˜¯å¤§äºä¹‹å‰çš„0.0158ã€‚</p><p>è¿™ä¸¤æ¬¡è®¡ç®—é¢„æµ‹å€¼_y_çš„è¿‡ç¨‹ï¼Œå…¶å®ä¹Ÿæ˜¯æˆ‘ä»¬ä½¿ç”¨çº¿æ€§å›å½’ï¼Œå¯¹æ–°çš„æ•°æ®è¿›è¡Œé¢„æµ‹çš„è¿‡ç¨‹ã€‚ç®€çŸ­åœ°æ€»ç»“ä¸€ä¸‹ï¼Œçº¿æ€§å›å½’æ¨¡å‹æ ¹æ®å¤§é‡çš„è®­ç»ƒæ ·æœ¬ï¼Œæ¨ç®—å‡ºç³»æ•°çŸ©é˜µ$B$ï¼Œç„¶åæ ¹æ®æ–°æ•°æ®çš„è‡ªå˜é‡$X$å‘é‡æˆ–è€…çŸ©é˜µï¼Œè®¡ç®—å‡ºå› å˜é‡çš„å€¼ï¼Œä½œä¸ºæ–°æ•°æ®çš„é¢„æµ‹ã€‚</p><h2>Pythonä»£ç å®ç°</h2><p>è¿™ä¸€éƒ¨åˆ†ï¼Œæˆ‘ä»¬ä½¿ç”¨Pythonçš„ä»£ç ï¼Œæ¥éªŒè¯ä¸€ä¸‹ä¹‹å‰çš„æ¨ç®—ç»“æœæ˜¯ä¸æ˜¯æ­£ç¡®ï¼Œå¹¶çœ‹çœ‹æœ€å°äºŒä¹˜æ³•å’ŒPython sklearnåº“ä¸­çš„çº¿æ€§å›å½’ï¼Œè¿™ä¸¤ç§ç»“æœçš„å¯¹æ¯”ã€‚</p><p>é¦–å…ˆï¼Œæˆ‘ä»¬ä½¿ç”¨Python numpyåº“ä¸­çš„çŸ©é˜µæ“ä½œæ¥å®ç°æœ€å°äºŒä¹˜æ³•ã€‚ä¸»è¦çš„å‡½æ•°æ“ä½œæ¶‰åŠçŸ©é˜µçš„è½¬ç½®ã€ç‚¹ä¹˜å’Œæ±‚é€†ã€‚å…·ä½“çš„ä»£ç å’Œæ³¨é‡Šæˆ‘åˆ—åœ¨äº†ä¸‹æ–¹ã€‚</p><pre><code>from numpy import *\n\nx = mat([[0,1],[1,-1],[2,8]])\ny = mat([[1.4],[-0.48],[13.2]])\n\n# åˆ†åˆ«æ±‚å‡ºçŸ©é˜µX'ã€X'Xã€(X'X)çš„é€†\n# æ³¨æ„ï¼Œè¿™é‡Œçš„Iè¡¨ç¤ºé€†çŸ©é˜µè€Œä¸æ˜¯å•ä½çŸ©é˜µ\nprint(&quot;XçŸ©é˜µçš„è½¬ç½®X'ï¼š\\n&quot;, x.transpose())\nprint(&quot;\\nX'ç‚¹ä¹˜Xï¼š\\n&quot;, x.transpose().dot(x))\nprint(&quot;\\nX'XçŸ©é˜µçš„é€†\\n&quot;, (x.transpose().dot(x)).I)\n\nprint(&quot;\\nX'XçŸ©é˜µçš„é€†ç‚¹ä¹˜X'\\n&quot;, (x.transpose().dot(x)).I.dot(x.transpose()))\nprint(&quot;\\nç³»æ•°çŸ©é˜µBï¼š\\n&quot;, (x.transpose().dot(x)).I.dot(x.transpose()).dot(y))\n</code></pre><p>é€šè¿‡ä¸Šè¿°ä»£ç ï¼Œä½ å¯ä»¥çœ‹åˆ°æ¯ä¸€æ­¥çš„ç»“æœï¼Œä»¥åŠæœ€ç»ˆçš„çŸ©é˜µ$B$ã€‚ä½ å¯ä»¥æŠŠè¾“å‡ºç»“æœå’Œä¹‹å‰æ‰‹åŠ¨æ¨ç®—çš„ç»“æœè¿›è¡Œå¯¹æ¯”ï¼Œçœ‹çœ‹æ˜¯ä¸æ˜¯ä¸€è‡´ã€‚</p><p>é™¤æ­¤ä¹‹å¤–ï¼Œæˆ‘ä»¬è¿˜å¯æŠŠæœ€å°äºŒä¹˜æ³•çš„çº¿æ€§æ‹Ÿåˆç»“æœå’Œsklearnåº“ä¸­çš„LinearRegression().fit()å‡½æ•°çš„ç»“æœç›¸æ¯”è¾ƒï¼Œå…·ä½“çš„ä»£ç å’Œæ³¨é‡Šæˆ‘ä¹Ÿæ”¾åœ¨äº†è¿™é‡Œã€‚</p><pre><code>import pandas as pd\nfrom sklearn.linear_model import LinearRegression\n\ndf = pd.read_csv(&quot;/Users/shenhuang/Data/test.csv&quot;)\ndf_features = df.drop(['y'], axis=1)     #Dataframeä¸­é™¤äº†æœ€åä¸€åˆ—ï¼Œå…¶ä½™åˆ—éƒ½æ˜¯ç‰¹å¾ï¼Œæˆ–è€…è¯´è‡ªå˜é‡\ndf_targets = df['y']                     #Dataframeæœ€åä¸€åˆ—æ˜¯ç›®æ ‡å˜é‡ï¼Œæˆ–è€…è¯´å› å˜é‡\n\nprint(df_features, df_targets)\nregression = LinearRegression().fit(df_features, df_targets)        #ä½¿ç”¨ç‰¹å¾å’Œç›®æ ‡æ•°æ®ï¼Œæ‹Ÿåˆçº¿æ€§å›å½’æ¨¡å‹\nprint(regression.score(df_features, df_targets))        #æ‹Ÿåˆç¨‹åº¦çš„å¥½å\nprint(regression.intercept_)\nprint(regression.coef_)            #å„ä¸ªç‰¹å¾æ‰€å¯¹åº”çš„ç³»æ•°\n</code></pre><p>å…¶ä¸­ï¼Œtest.csvæ–‡ä»¶çš„å†…å®¹æˆ‘ä¹Ÿåˆ—åœ¨äº†è¿™é‡Œã€‚</p><p>$x_1,x_2,y$<br>\n$0,1,1.4$<br>\n$1,-1,-0.48$<br>\n$2,8,13.2$</p><p>è¿™æ ·å†™æ˜¯ä¸ºäº†æ–¹ä¾¿æˆ‘ä»¬ä½¿ç”¨pandasè¯»å–csvæ–‡ä»¶å¹¶åŠ è½½ä¸ºdataframeã€‚</p><p>åœ¨æœ€ç»ˆçš„ç»“æœä¸­ï¼Œ1.0è¡¨ç¤ºæ‹Ÿåˆç¨‹åº¦éå¸¸å¥½ï¼Œè€Œ-0.014545454545452863è¡¨ç¤ºä¸€ä¸ªæˆªè·ï¼Œ[0.94909091 1.41454545]è¡¨ç¤ºç³»æ•°$b_1$å’Œ$b_2$çš„å€¼ã€‚è¿™ä¸ªç»“æœå’Œæˆ‘ä»¬æœ€å°äºŒä¹˜æ³•çš„ç»“æœæœ‰æ‰€å·®åˆ«ï¼Œä¸»è¦åŸå› æ˜¯LinearRegression().fit()é»˜è®¤è€ƒè™‘äº†æœ‰çº¿æ€§å‡½æ•°å­˜åœ¨æˆªè·çš„æƒ…å†µã€‚é‚£ä¹ˆæˆ‘ä»¬ä½¿ç”¨æœ€å°äºŒä¹˜æ³•æ˜¯ä¸æ˜¯ä¹Ÿå¯ä»¥è€ƒè™‘æœ‰æˆªè·çš„æƒ…å†µå‘¢ï¼Ÿç­”æ¡ˆæ˜¯è‚¯å®šçš„ï¼Œä¸è¿‡æˆ‘ä»¬é¦–å…ˆè¦ç•¥å¾®ä¿®æ”¹ä¸€ä¸‹æ–¹ç¨‹ç»„å’ŒçŸ©é˜µ$X$ã€‚å¦‚æœæˆ‘ä»¬å‡è®¾æœ‰æˆªè·å­˜åœ¨ï¼Œé‚£ä¹ˆçº¿æ€§å›å½’æ–¹ç¨‹å°±è¦æ”¹å†™ä¸ºï¼š</p><p>$b_0+b_1Â·x_1+b_2Â·x_2+â€¦+b_{n-1}Â·x_{n-1}+b_nÂ·x_n=y$</p><p>å…¶ä¸­ï¼Œ$b_0$è¡¨ç¤ºæˆªè·ï¼Œè€Œæˆ‘ä»¬è¿™é‡Œçš„æ–¹ç¨‹ç»„ç”¨ä¾‹å°±è¦æ”¹å†™ä¸ºï¼š</p><p>$b_0+b_1Â·0+b_2Â·1=1.4$<br>\n$b_0+b_1Â·1-b_2Â·1=-0.48$<br>\n$b_0+b_1Â·2+b_2Â·8=13.2$</p><p>è€ŒçŸ©é˜µ$X$è¦æ”¹å†™ä¸ºï¼š</p><p><img src=\"https://static001.geekbang.org/resource/image/41/fb/417cf726043be38e7cf0a46a9eea3bfb.png?wh=350*228\" alt=\"\"></p><p>ç„¶åæˆ‘ä»¬å†æ‰§è¡Œä¸‹é¢è¿™æ®µä»£ç ã€‚</p><pre><code>from numpy import *\n\nx = mat([[1,0,1],[1,1,-1],[1,2,8]])\ny = mat([[1.4],[-0.48],[13.2]])\n\nprint(&quot;\\nç³»æ•°çŸ©é˜µBï¼š\\n&quot;, (x.transpose().dot(x)).I.dot(x.transpose()).dot(y))\n</code></pre><p>ä½ å°±ä¼šå¾—åˆ°ï¼š</p><pre><code> ç³»æ•°çŸ©é˜µBï¼š\n     [[-0.01454545]\n     [ 0.94909091]\n     [ 1.41454545]]\n\n</code></pre><p>è¿™ä¸ªç»“æœå’ŒLinearRegression().fit()çš„ç»“æœå°±ä¸€è‡´äº†ã€‚</p><p>éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œä½¿ç”¨çº¿æ€§å›å½’çš„æ—¶å€™ï¼Œæˆ‘ä»¬éƒ½æœ‰ä¸€ä¸ªå‰æå‡è®¾ï¼Œé‚£å°±æ˜¯æ•°æ®çš„è‡ªå˜é‡å’Œå› å˜é‡ä¹‹é—´å‘ˆç°çº¿æ€§å…³ç³»ã€‚å¦‚æœä¸æ˜¯çº¿æ€§å…³ç³»ï¼Œé‚£ä¹ˆä½¿ç”¨çº¿æ€§æ¨¡å‹æ¥æ‹Ÿåˆçš„æ•ˆæœä¸€å®šä¸å¥½ã€‚æ¯”å¦‚ï¼Œä¹‹å‰åœ¨è§£é‡Šæ¬ æ‹Ÿåˆçš„æ—¶å€™ï¼Œæˆ‘ç”¨è¿‡ä¸‹é¢è¿™ä¸ªä¾‹å­ã€‚</p><p><img src=\"https://static001.geekbang.org/resource/image/0b/a5/0b9f8c88a846626c74a803ee645bc1a5.png?wh=630*618\" alt=\"\"></p><p>ä¸Šé¢è¿™å¼ å›¾çš„æ•°æ®åˆ†å¸ƒå¹¶æ²¡æœ‰è¡¨è¾¾çº¿æ€§å…³ç³»ï¼Œæ‰€ä»¥æˆ‘ä»¬éœ€è¦å¯¹åŸå§‹çš„æ•°æ®è¿›è¡Œéçº¿æ€§çš„å˜æ¢ï¼Œæˆ–è€…æ˜¯ä½¿ç”¨éçº¿æ€§çš„æ¨¡å‹æ¥æ‹Ÿåˆã€‚</p><p>é‚£ä¹ˆï¼Œæˆ‘ä»¬å¦‚ä½•åˆ¤æ–­ä¸€ä¸ªæ•°æ®é›†æ˜¯ä¸æ˜¯èƒ½ç”¨çº¿æ€§æ¨¡å‹è¡¨ç¤ºå‘¢ï¼Ÿåœ¨çº¿æ€§å›å½’ä¸­ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨å†³å®šç³»æ•°R2ã€‚è¿™ä¸ªç»Ÿè®¡æŒ‡æ ‡ä½¿ç”¨äº†å›å½’å¹³æ–¹å’Œä¸æ€»å¹³æ–¹å’Œä¹‹æ¯”ï¼Œæ˜¯åæ˜ æ¨¡å‹æ‹Ÿåˆåº¦çš„é‡è¦æŒ‡æ ‡ã€‚å®ƒçš„å–å€¼åœ¨0åˆ°1ä¹‹é—´ï¼Œè¶Šæ¥è¿‘äº1è¡¨ç¤ºæ‹Ÿåˆçš„ç¨‹åº¦è¶Šå¥½ã€æ•°æ®åˆ†å¸ƒè¶Šæ¥è¿‘çº¿æ€§å…³ç³»ã€‚éšç€è‡ªå˜é‡ä¸ªæ•°çš„å¢åŠ ï¼ŒR2å°†ä¸æ–­å¢å¤§ï¼Œå› æ­¤æˆ‘ä»¬è¿˜éœ€è¦è€ƒè™‘æ–¹ç¨‹æ‰€åŒ…å«çš„è‡ªå˜é‡ä¸ªæ•°å¯¹R2çš„å½±å“ï¼Œè¿™ä¸ªæ—¶å€™å¯ä½¿ç”¨æ ¡æ­£çš„å†³å®šç³»æ•°Rc2ã€‚æ‰€ä»¥ï¼Œåœ¨ä½¿ç”¨å„ç§ç§‘å­¦è®¡ç®—åº“è¿›è¡Œçº¿æ€§å›å½’æ—¶ï¼Œä½ éœ€è¦å…³æ³¨R2æˆ–è€…Rc2ï¼Œæ¥çœ‹çœ‹æ˜¯ä¸æ˜¯ä¸€ä¸ªå¥½çš„çº¿æ€§æ‹Ÿåˆã€‚åœ¨ä¹‹å‰çš„ä»£ç å®è·µä¸­ï¼Œæˆ‘ä»¬æåˆ°çš„regression.scoreå‡½æ•°ï¼Œå…¶å®å°±æ˜¯è¿”å›äº†çº¿æ€§å›å½’çš„R2ã€‚</p><h2>æ€»ç»“</h2><p>ä»Šå¤©æˆ‘ä»¬ä½¿ç”¨äº†å…·ä½“çš„æ¡ˆä¾‹æ¥æ¨å¯¼æœ€å°äºŒä¹˜æ³•çš„è®¡ç®—è¿‡ç¨‹ï¼Œå¹¶ç”¨Pythonä»£ç è¿›è¡Œäº†éªŒè¯ã€‚é€šè¿‡æœ€è¿‘3èŠ‚çš„è®²è§£ï¼Œç›¸ä¿¡ä½ å¯¹çº¿æ€§æ–¹ç¨‹ç»„æ±‚ç²¾ç¡®è§£ã€æ±‚è¿‘ä¼¼è§£ã€ä»¥åŠå¦‚ä½•åœ¨çº¿æ€§å›å½’ä¸­è¿ç”¨è¿™äº›æ–¹æ³•ï¼Œæœ‰äº†æ›´åŠ æ·±å…¥çš„ç†è§£ã€‚</p><p>å®é™…ä¸Šï¼Œä»å¹¿ä¹‰ä¸Šæ¥è¯´ï¼Œæœ€å°äºŒä¹˜æ³•ä¸ä»…å¯ä»¥ç”¨äºçº¿æ€§å›å½’ï¼Œè¿˜å¯ä»¥ç”¨äºéçº¿æ€§çš„å›å½’ã€‚å…¶ä¸»è¦æ€æƒ³è¿˜æ˜¯è¦ç¡®ä¿è¯¯å·®Îµæœ€å°ï¼Œä½†æ˜¯ç”±äºç°åœ¨çš„å‡½æ•°æ˜¯éçº¿æ€§çš„ï¼Œæ‰€ä»¥ä¸èƒ½ä½¿ç”¨æ±‚å¤šå…ƒæ–¹ç¨‹æ±‚è§£çš„åŠæ³•æ¥å¾—åˆ°å‚æ•°ä¼°è®¡å€¼ï¼Œè€Œéœ€è¦é‡‡ç”¨è¿­ä»£çš„ä¼˜åŒ–ç®—æ³•æ¥æ±‚è§£ï¼Œæ¯”å¦‚æ¢¯åº¦ä¸‹é™æ³•ã€éšæœºæ¢¯åº¦ä¸‹é™æ³•å’Œç‰›é¡¿æ³•ã€‚</p><h2>æ€è€ƒé¢˜</h2><p>æˆ‘è¿™é‡Œç»™å‡ºä¸€ä¸ªæ–°çš„æ–¹ç¨‹ç»„ï¼Œè¯·é€šè¿‡æœ€å°äºŒä¹˜æ³•æ¨ç®—å‡ºç³»æ•°çš„è¿‘ä¼¼è§£ï¼Œå¹¶ä½¿ç”¨ä½ ç†Ÿæ‚‰çš„è¯­è¨€è¿›è¡ŒéªŒè¯ã€‚</p><p>$b_1+b_2Â·3+b_3Â·(-7)=-7.5$<br>\n$b_1Â·2+b_2Â·5+b_3Â·4=5.2$<br>\n$b_1Â·(-3)+b_2Â·(-7)+b_3Â·(-2)=-7.5$<br>\n$b_1Â·1+b_2Â·4+b_3Â·(-12)=-15$</p><p>æ¬¢è¿ç•™è¨€å’Œæˆ‘åˆ†äº«ï¼Œä¹Ÿæ¬¢è¿ä½ åœ¨ç•™è¨€åŒºå†™ä¸‹ä»Šå¤©çš„å­¦ä¹ ç¬”è®°ã€‚ä½ å¯ä»¥ç‚¹å‡»â€œè¯·æœ‹å‹è¯»â€ï¼ŒæŠŠä»Šå¤©çš„å†…å®¹åˆ†äº«ç»™ä½ çš„å¥½å‹ï¼Œå’Œä»–ä¸€èµ·ç²¾è¿›ã€‚</p>","comments":[{"had_liked":false,"id":89065,"user_name":"ä½™æ³½é”‹","can_delete":false,"product_type":"c1","uid":1003207,"ip_address":"","ucode":"5AB1499746C003","user_header":"https://static001.geekbang.org/account/avatar/00/0f/4e/c7/8c2d0a3d.jpg","comment_is_top":false,"comment_ctime":1556070918,"is_pvip":false,"discussion_count":0,"race_medal":1,"score":"14440972806","product_id":100021201,"comment_content":"import numpy as np<br>X = np.mat([[1, 3, -7], [2, 5, 4], [-3, -7, -2], [1, 4, -12]])<br>Y = np.mat([[-7.5], [5.2], [-7.5], [-15]])<br>B1 = X.transpose().dot(X).I<br>B2 = B1.dot(X.transpose())<br>B = B2.dot(Y)<br>&#39;&#39;&#39;<br>matrix([[12.01208791],<br>        [-4.35934066],<br>        [ 0.82527473]])<br>&#39;&#39;&#39;","like_count":3},{"had_liked":false,"id":231684,"user_name":"éª‘è¡Œçš„æŒæŸœJ","can_delete":false,"product_type":"c1","uid":1474214,"ip_address":"","ucode":"3163102651C653","user_header":"https://static001.geekbang.org/account/avatar/00/16/7e/a6/4e331ef4.jpg","comment_is_top":false,"comment_ctime":1593747448,"is_pvip":false,"replies":[{"id":"86132","content":"ä½ å¯ä»¥è¿™ä¹ˆæƒ³è±¡ï¼Œå¦‚æœåªçœ‹ä¸€ç»´å˜é‡ï¼Œé‚£ä¹ˆå°±æ˜¯åœ¨äºŒç»´å¹³é¢ä¸Šæ•°æ®åˆ†å¸ƒæ˜¯ä¸æ˜¯åƒä¸€æ ¹ç›´çº¿ï¼Œè€ŒåŒæ—¶çœ‹å¤šä¸ªå˜é‡ï¼Œå…¶å®å°±æ˜¯åœ¨å¤šç»´ç©ºé—´ä¸­çœ‹æ•°æ®åˆ†å¸ƒæ˜¯ä¸æ˜¯åƒä¸€æ ¹ç›´çº¿ï¼Œæ‰€ä»¥ä¸¤è€…å¹¶ä¸ä¸€æ ·ã€‚å¦‚æœåœ¨å¤šç»´ç©ºé—´ä¸­æœ‰ä¸€æ¡æ¯”è¾ƒå¥½çš„ç›´çº¿æ‹Ÿåˆï¼ŒæŠ•å½±åˆ°å•ç»´ç©ºé—´ï¼Œå°±ä¸ä¸€å®šèƒ½å¾ˆå¥½çš„æ‹Ÿåˆäº†ã€‚","user_name":"ä½œè€…å›å¤","user_name_real":"é»„ç”³","uid":"1275061","ctime":1594313791,"ip_address":"","comment_id":231684,"utype":1}],"discussion_count":1,"race_medal":0,"score":"10183682040","product_id":100021201,"comment_content":"æ„Ÿè°¢é»„è€å¸ˆ ä¹‹å‰ä¸€ç›´åªçŸ¥é“å»ºæ¨¡ï¼Œæ‹Ÿåˆï¼Œé¢„æµ‹ï¼Œä½†æ˜¯èƒŒåçš„æ•°å­¦åŸç†ä¸€ç›´æ²¡æœ‰å¾ˆç†è§£ï¼ï¼ï¼ç°åœ¨æœ‰ç§æç„¶å¤§æ‚Ÿçš„æ„Ÿè§‰ï¼åŸæ¥æ˜¯è¿™æ ·ï¼Œå½“å› å˜é‡å’Œè‡ªå˜é‡å‘ˆç°çº¿æ€§å…³ç³»ï¼Œå»ºæ¨¡è¿™ä¸€ç³»åˆ—åŠ¨ä½œéƒ½æ˜¯åŸºäºä¸Šé¢çº¿ä»£çš„åŸç†ï¼ğŸ˜ç»ˆäºgetåˆ°äº†å®ƒåœ¨æ±‚ä»€ä¹ˆäº†ï¼ï¼<br>PSï¼šåˆšåˆšè¯„è®ºæœ‰ä¸ªæœ‹å‹ä¹Ÿæé—®äº†å¦‚ä½•åˆ¤æ–­ä¸€ä¸ªæ•°æ®é›†å¯ä»¥ç”¨çº¿æ€§æ¨¡å‹ï¼Ÿå¯ä»¥ç”¨R2ï¼Œä¹Ÿå°±æ˜¯regression.scoreè¿™ä¸ªæ–¹æ³•ï¼Œ<br>æ‰€ä»¥è¯·é—®é»„è€å¸ˆï¼šæ˜¯åªæœ‰å…ˆå»ç”¨çº¿æ€§æ¨¡å‹æ‹Ÿåˆæ•°æ®é›†ï¼Œå†æ¥åˆ¤æ–­æ¨¡å‹æ˜¯å¦åˆé€‚å—ï¼Ÿ<br>è¿˜æ˜¯æˆ‘å¯ä»¥ä»æ‹¿åˆ°æ•°æ®é›†ä¸€å¼€å§‹ï¼Œç›´æ¥æŸ¥çœ‹æ¯ä¸ªè‡ªå˜é‡å’Œå› å˜é‡çš„å…³ç³»æ˜¯å¦å‘ˆçº¿æ€§å†æ¥å†³å®šçº¿æ€§æ¨¡å‹æ˜¯å¦åˆé€‚ï¼Ÿè°¢è°¢","like_count":2,"discussions":[{"author":{"id":1275061,"avatar":"https://static001.geekbang.org/account/avatar/00/13/74/b5/b68e3740.jpg","nickname":"é»„ç”³","note":"","ucode":"EE9AC074A322FF","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":500407,"discussion_content":"ä½ å¯ä»¥è¿™ä¹ˆæƒ³è±¡ï¼Œå¦‚æœåªçœ‹ä¸€ç»´å˜é‡ï¼Œé‚£ä¹ˆå°±æ˜¯åœ¨äºŒç»´å¹³é¢ä¸Šæ•°æ®åˆ†å¸ƒæ˜¯ä¸æ˜¯åƒä¸€æ ¹ç›´çº¿ï¼Œè€ŒåŒæ—¶çœ‹å¤šä¸ªå˜é‡ï¼Œå…¶å®å°±æ˜¯åœ¨å¤šç»´ç©ºé—´ä¸­çœ‹æ•°æ®åˆ†å¸ƒæ˜¯ä¸æ˜¯åƒä¸€æ ¹ç›´çº¿ï¼Œæ‰€ä»¥ä¸¤è€…å¹¶ä¸ä¸€æ ·ã€‚å¦‚æœåœ¨å¤šç»´ç©ºé—´ä¸­æœ‰ä¸€æ¡æ¯”è¾ƒå¥½çš„ç›´çº¿æ‹Ÿåˆï¼ŒæŠ•å½±åˆ°å•ç»´ç©ºé—´ï¼Œå°±ä¸ä¸€å®šèƒ½å¾ˆå¥½çš„æ‹Ÿåˆäº†ã€‚","likes_number":1,"is_delete":false,"is_hidden":false,"ctime":1594313791,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":214313,"user_name":"ç½—è€€é¾™@åå¿˜","can_delete":false,"product_type":"c1","uid":1917663,"ip_address":"","ucode":"3CEA258DE7F3C7","user_header":"https://static001.geekbang.org/account/avatar/00/1d/42/df/a034455d.jpg","comment_is_top":false,"comment_ctime":1588722546,"is_pvip":true,"discussion_count":0,"race_medal":5,"score":"10178657138","product_id":100021201,"comment_content":"èŒ¶è‰ºå¸ˆå­¦ç¼–ç¨‹<br><br>å› ä¸ºè¿˜ä¸ä¼šç¼–ç¨‹ï¼Œæˆ‘åªèƒ½ç”¨æ‰‹ç®—äº†â€¦â€¦<br><br>B=[1.463916<br>      -0.403059<br>      -0.616992]<br><br>ç„¶åå†ç®—äº†è¯¯å·®ï¼Œ23.907ï¼Œå—¯ï¼Œæˆ‘æœ‰98ï¼…çš„ä¿¡å¿ƒç›¸ä¿¡æˆ‘è¿™æ¬¡ç®—é”™äº†ã€‚<br><br>è€Œä¸”æˆ‘è¿˜ä¸çŸ¥é“åœ¨å“ªé‡Œæ‰¾é”™ã€‚<br><br>æˆ‘æƒ³åˆ°å¦‚æœæ˜¯æˆ‘åœ¨ç¼–å†™ç¨‹åºæ—¶å‡ºç°è¿™çŠ¶å†µï¼Œå¾ˆæœ‰å¯èƒ½ä¼šæ¯”è¿™æ›´æƒ¨â€¦â€¦","like_count":2},{"had_liked":false,"id":78599,"user_name":"Joe","can_delete":false,"product_type":"c1","uid":1337998,"ip_address":"","ucode":"EC76699640B7BF","user_header":"https://static001.geekbang.org/account/avatar/00/14/6a/8e/7b6ea886.jpg","comment_is_top":false,"comment_ctime":1553181089,"is_pvip":false,"replies":[{"id":"28693","content":"å†™å¾—å¾ˆå¥½ï¼Œè‡³äºé€†çŸ©é˜µæ›´å¥½çš„æ±‚æ³•ï¼Œæˆ‘è¦æŸ¥ä¸€ä¸‹èµ„æ–™çœ‹çœ‹æœ‰æ— æ›´ä¼˜çš„è§£ã€‚","user_name":"ä½œè€…å›å¤","user_name_real":"é»„ç”³","uid":"1275061","ctime":1553274772,"ip_address":"","comment_id":78599,"utype":1}],"discussion_count":1,"race_medal":0,"score":"10143115681","product_id":100021201,"comment_content":"å›ç­”ä¸ç–‘é—®ï¼š<br>1. éçº¿æ€§å…³ç³»çš„æ•°æ®æ‹Ÿåˆï¼Œå¯ä»¥å…ˆå°†è‡ªå˜é‡è½¬ä¸ºéçº¿æ€§ã€‚å¦‚è½¬åŒ–ä¸ºå¤šé¡¹å¼ï¼ˆsklearnçš„PolynomialFeaturesï¼‰ã€‚å†ç”¨çº¿æ€§å›å½’çš„æ–¹æ³•å»æ‹Ÿåˆã€‚<br>2. è¯·é—®è€å¸ˆå¯¹äºæ±‚è§£é€†çŸ©é˜µæœ‰æ²¡æœ‰ä»€ä¹ˆé«˜æ•ˆçš„æ–¹æ³•ï¼Ÿ<br>é™„ä¸Šä»¥å‰å†™çš„polyfitæ–¹æ³•ï¼Œè¯·è€å¸ˆæŒ‡ç‚¹ã€‚è°¢è°¢<br>    def oneDPolynomiaTransform(self, x_origin):<br>        &#39;&#39;&#39;<br>        @description: generate polynomial for 1D input data. rule: [x0, x0^2, x0^3,...,x0^degreee]<br>        @param {type} x_origin- data before transformed[nX1]<br>        @return: x_transformed- data after transformed[nXdegree]<br>        &#39;&#39;&#39;<br>        len_features = len(x_origin)<br>        # polynomial feature data after transformed.<br>        x_transformed = np.array([])<br>        for i in range(len_features):<br>            for j in range(self.degree+1):<br>                x_transformed = np.append(<br>                    x_transformed, [(x_origin[i])**(j)])<br>        x_transformed = x_transformed.reshape(-1, self.degree+1)<br>        return x_transformed","like_count":2,"discussions":[{"author":{"id":1275061,"avatar":"https://static001.geekbang.org/account/avatar/00/13/74/b5/b68e3740.jpg","nickname":"é»„ç”³","note":"","ucode":"EE9AC074A322FF","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":444158,"discussion_content":"å†™å¾—å¾ˆå¥½ï¼Œè‡³äºé€†çŸ©é˜µæ›´å¥½çš„æ±‚æ³•ï¼Œæˆ‘è¦æŸ¥ä¸€ä¸‹èµ„æ–™çœ‹çœ‹æœ‰æ— æ›´ä¼˜çš„è§£ã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1553274772,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":138268,"user_name":"Paul Shan","can_delete":false,"product_type":"c1","uid":1593140,"ip_address":"","ucode":"32D99989028284","user_header":"","comment_is_top":false,"comment_ctime":1570138759,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"5865106055","product_id":100021201,"comment_content":"é«˜æ–¯æ¶ˆå…ƒæ±‚å¾—æ˜¯ç²¾ç¡®è§£ã€‚<br>çº¿æ€§å›å½’æ±‚å¾—æ˜¯æœ€å¥½è¿‘ä¼¼è§£ï¼Œè¦†ç›–é«˜æ–¯æ¶ˆå…ƒèƒ½å¤„ç†çš„æƒ…å†µï¼Œä¹Ÿèƒ½åœ¨æ²¡æœ‰ç²¾ç¡®è§£çš„æ—¶å€™æ‰¾åˆ°è¿‘ä¼¼è§£ï¼Œè¿˜æä¾›æµ‹é‡è¿‘ä¼¼å‚æ•°ï¼Œæ˜¯å¤„ç†çº¿æ€§å…³ç³»çš„åˆ©å™¨ã€‚","like_count":1},{"had_liked":false,"id":87127,"user_name":"å®å½“çŒ«","can_delete":false,"product_type":"c1","uid":1360159,"ip_address":"","ucode":"175BB66517E21B","user_header":"https://static001.geekbang.org/account/avatar/00/14/c1/1f/cc77944d.jpg","comment_is_top":false,"comment_ctime":1555514522,"is_pvip":false,"replies":[{"id":"31344","content":"è¿™æ˜¯ä¸ªå¥½é—®é¢˜ï¼Œæˆ‘æŸ¥äº†sklearn.linear_modeå¥½åƒä¸æä¾›è¿™ä¸ªæ•°æ®ã€‚<br><br>ä½ å¯ä»¥å°è¯•ä¸€ä¸‹statsmodels.api.OLSè¿™ä¸ªåŒ…ï¼Œé‡Œé¢åº”è¯¥å¯ä»¥è¿”å›rsquared_adj","user_name":"ä½œè€…å›å¤","user_name_real":"é»„ç”³","uid":"1275061","ctime":1555533177,"ip_address":"","comment_id":87127,"utype":1}],"discussion_count":1,"race_medal":0,"score":"5850481818","product_id":100021201,"comment_content":"æ–‡ä¸­æœ‰æåˆ°ï¼Œå¦‚ä½•åˆ¤æ–­ä¸€ä¸ªæ•°æ®é›†æ˜¯å¦å¯ä»¥ç”¨çº¿æ€§æ¨¡å‹æ¥è¡¨ç¤ºï¼Œå¯ä»¥ä½¿ç”¨å†³å®šç³»æ•°R2ï¼Œéšç€è‡ªå˜é‡ä¸ªæ•°ä¸æ–­å¢åŠ ï¼ŒR2å°†ä¸æ–­å¢å¤§ï¼Œè¿™æ—¶éœ€è¦ç”¨Rc2ï¼Œè€Œå…¶ä¸­R2å°±æ˜¯regression.scoreï¼Œé‚£è¯·é—®Rc2æ˜¯åº“é‡Œé¢çš„ä»€ä¹ˆå‘¢ï¼Ÿ","like_count":1,"discussions":[{"author":{"id":1275061,"avatar":"https://static001.geekbang.org/account/avatar/00/13/74/b5/b68e3740.jpg","nickname":"é»„ç”³","note":"","ucode":"EE9AC074A322FF","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":447321,"discussion_content":"è¿™æ˜¯ä¸ªå¥½é—®é¢˜ï¼Œæˆ‘æŸ¥äº†sklearn.linear_modeå¥½åƒä¸æä¾›è¿™ä¸ªæ•°æ®ã€‚\n\nä½ å¯ä»¥å°è¯•ä¸€ä¸‹statsmodels.api.OLSè¿™ä¸ªåŒ…ï¼Œé‡Œé¢åº”è¯¥å¯ä»¥è¿”å›rsquared_adj","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1555533177,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":81575,"user_name":"qinggeouye","can_delete":false,"product_type":"c1","uid":1251536,"ip_address":"","ucode":"5B53EEDD7BEC9C","user_header":"https://static001.geekbang.org/account/avatar/00/13/18/d0/49b06424.jpg","comment_is_top":false,"comment_ctime":1553951796,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"5848919092","product_id":100021201,"comment_content":"&quot;&quot;&quot;<br>æ€è€ƒé¢˜åŒç†<br>&quot;&quot;&quot;<br>x = np.mat([[1, 3, -7], [2, 5, 4], [-3, -7, -2], [1, 4, -12]])<br>y = np.mat([[-7.5], [5.2], [-7.5], [-15]])<br>print(&quot;\\n ç³»æ•°çŸ©é˜µ B: \\n&quot;, (x.transpose().dot(x)).I.dot(x.transpose()).dot(y))<br><br> ç³»æ•°çŸ©é˜µ B: <br> [[12.01208791]<br> [-4.35934066]<br> [ 0.82527473]]","like_count":1},{"had_liked":false,"id":79582,"user_name":"Cest la vie","can_delete":false,"product_type":"c1","uid":1171130,"ip_address":"","ucode":"8CB3AE0DFE9ADF","user_header":"https://static001.geekbang.org/account/avatar/00/11/de/ba/f01dc860.jpg","comment_is_top":false,"comment_ctime":1553509277,"is_pvip":false,"replies":[{"id":"29213","content":"å¯ä»¥è€ƒè™‘åˆ°åé¢åŠ é¤çš„æ—¶å€™æ¥ä¸€ç¯‡","user_name":"ä½œè€…å›å¤","user_name_real":"é»„ç”³","uid":"1275061","ctime":1553616120,"ip_address":"","comment_id":79582,"utype":1}],"discussion_count":1,"race_medal":0,"score":"5848476573","product_id":100021201,"comment_content":"è€å¸ˆå¥½! åé¢å¯ä»¥æ¥ä¸€èŠ‚PLSåæœ€å°äºŒä¹˜çš„åŸç†è®²è§£å’Œåº”ç”¨ä¹ˆ","like_count":1,"discussions":[{"author":{"id":1275061,"avatar":"https://static001.geekbang.org/account/avatar/00/13/74/b5/b68e3740.jpg","nickname":"é»„ç”³","note":"","ucode":"EE9AC074A322FF","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":444549,"discussion_content":"å¯ä»¥è€ƒè™‘åˆ°åé¢åŠ é¤çš„æ—¶å€™æ¥ä¸€ç¯‡","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1553616120,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":357364,"user_name":"013923","can_delete":false,"product_type":"c1","uid":3035193,"ip_address":"ä¸Šæµ·","ucode":"1214DAADBCA848","user_header":"","comment_is_top":false,"comment_ctime":1663205535,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1663205535","product_id":100021201,"comment_content":"å­¦ä¹ äº†ï¼","like_count":0},{"had_liked":false,"id":256366,"user_name":"å»ºå¼º","can_delete":false,"product_type":"c1","uid":1397126,"ip_address":"","ucode":"62B03D0E0C64EC","user_header":"https://static001.geekbang.org/account/avatar/00/15/51/86/b5fd8dd8.jpg","comment_is_top":false,"comment_ctime":1603610460,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1603610460","product_id":100021201,"comment_content":"æ ¹æ®æœ€å°äºŒä¹˜æ³•ç³»æ•°è®¡ç®—æ¨¡å‹ï¼Œç”¨äº†ä¸€ä¸ªç®€å•çš„Pythonç¨‹åºè®¡ç®—ç³»æ•°çŸ©é˜µï¼Œç¨‹åºä»£ç ï¼š<br>import numpy as np<br># çŸ©é˜µX<br>X = np.array([[1, 3, -7]<br>            ,[2, 5, 4]<br>            ,[-3, -7, -2]<br>            ,[1, 4, -12]<br>             ]<br>            )<br># Xçš„è½¬ç½®X&#39;<br>TRANS_X = X.T<br><br># ç›®æ ‡å€¼å‘é‡Y<br>Y = np.array([[-7.5, 5.2, -7.5, -15]]).T<br><br># X&#39;X<br>B = TRANS_X.dot(X)<br><br># (X&#39;X)^-1<br>B = np.matrix(B).I<br><br># [(X&#39;X)^-1]X&#39;<br>B = B.dot(TRANS_X)<br><br># [(XX&#39;)^-1]X&#39;Y<br>B = B.dot(Y)<br><br>print(&#39;ç³»æ•°çŸ©é˜µï¼š&#39;)<br>print(B)<br><br>print(&#39;éªŒè¯ï¼š&#39;)<br>print(X.dot(B))<br><br>================ç¨‹åºè¾“å‡ºç»“æœ==================<br>ç³»æ•°çŸ©é˜µï¼š<br>[[12.01208791]<br> [-4.35934066]<br> [ 0.82527473]]<br>éªŒè¯ï¼š<br>[[ -6.84285714]<br> [  5.52857143]<br> [ -7.17142857]<br> [-15.32857143]]","like_count":0},{"had_liked":false,"id":179730,"user_name":"è§‚æœ›è€…","can_delete":false,"product_type":"c1","uid":1142107,"ip_address":"","ucode":"08F3D79D3C811D","user_header":"https://static001.geekbang.org/account/avatar/00/11/6d/5b/03763d38.jpg","comment_is_top":false,"comment_ctime":1582084781,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1582084781","product_id":100021201,"comment_content":"#ç”¨sklearnçš„åº“<br>df = pd.read_csv(&#39;data.csv&#39;)<br>regr = linear_model.LinearRegression()#äº§ç”Ÿçº¿æ€§æ‹Ÿåˆçš„å¯¹è±¡<br>X = df.loc[:,[&#39;x1&#39;,&#39;x2&#39;,&#39;x3&#39;]]<br>Y = df[&#39;y&#39;]<br>regr.fit(X, Y)#ä¼ å…¥æ‹Ÿåˆçš„æ•°æ®é›†<br>Y_pred = regr.predict(X)##é¢„æµ‹å€¼<br>print(&#39;Coefficients: \\n&#39;, regr.coef_)<br><br>#å¦‚æœç”¨å…¬å¼æ¥è®¡ç®—éœ€è¦åœ¨æ•°æ®ä¸­åŠ å…¥ æˆªè·ï¼ˆä¹Ÿå°±æ˜¯x=1çš„åˆ—ï¼‰ï¼Œè®¡ç®—å¦‚ä¸‹ï¼š<br>inter = pd.Series([1 for i in range(4)], name=&#39;X0&#39;)<br>X_inter = pd.concat([inter,X], axis=1)<br>B = min2mul(X_inter,Y)<br>print(&#39;Coefficients B: \\n&#39;, B)<br>def min2mul(X,Y):<br>    X_REV = np.transpose(X)##çŸ©é˜µè½¬ç½®<br>    X2 = np.linalg.inv(np.dot(X_REV,X))## è®¡ç®—(X&#39;X)^(-1)<br>    B = np.dot(np.dot(X2,X_REV),Y)<br>    return B","like_count":0},{"had_liked":false,"id":143507,"user_name":"Ronnyz","can_delete":false,"product_type":"c1","uid":1488280,"ip_address":"","ucode":"9F34527B1D343D","user_header":"https://static001.geekbang.org/account/avatar/00/16/b5/98/ffaf2aca.jpg","comment_is_top":false,"comment_ctime":1571721095,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1571721095","product_id":100021201,"comment_content":"from numpy import *\r<br>x=mat([[1,3,-7],[2,5,4],[-3,-7,-2],[1,4,-12]])\r<br>y=mat([[-7.5],[5.2],[-7.5],[-15]])\r<br>print(&quot;\\nç³»æ•°çŸ©é˜µB:\\n&quot;,(x.transpose().dot(x)).I.dot(x.transpose()).dot(y))<br><br>ç³»æ•°çŸ©é˜µB:\r<br> [[12.01208791]\r<br> [-4.35934066]\r<br> [ 0.82527473]]","like_count":0}]}