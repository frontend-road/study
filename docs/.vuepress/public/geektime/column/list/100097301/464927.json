{"id":464927,"title":"11 | çŸ¢é‡è¿ç®—ï¼šJavaçš„æœºå™¨å­¦ä¹ è¦æ¥äº†å—ï¼Ÿ","content":"<p>ä½ å¥½ï¼Œæˆ‘æ˜¯èŒƒå­¦é›·ã€‚ä»Šå¤©ï¼Œæˆ‘ä»¬è®¨è®ºJavaçš„çŸ¢é‡è¿ç®—ã€‚</p><p>Javaçš„çŸ¢é‡è¿ç®—ï¼Œæˆ‘å†™è¿™ç¯‡æ–‡ç« çš„æ—¶å€™è¿˜åœ¨å­µåŒ–æœŸï¼Œè¿˜æ²¡æœ‰å‘å¸ƒé¢„è§ˆç‰ˆã€‚æˆ‘ä»¬ä¹‹æ‰€ä»¥é€‰å–äº†è¿™æ ·ä¸€ä¸ªè¿˜å¤„äºå­µåŒ–æœŸçš„æŠ€æœ¯ï¼Œä¸»è¦æ˜¯å› ä¸ºè¿™ä¸ªæŠ€æœ¯ä»£è¡¨äº†Javaè¯­è¨€å‘å±•çš„ä¸€ä¸ªé‡è¦æ–¹å‘ï¼Œåœ¨æœªæ¥ä¸€å®šä¼šæœ‰ç€é‡è¦çš„å½±å“ã€‚æ—©ä¸€ç‚¹äº†è§£è¿™æ ·çš„æŠ€æœ¯ï¼Œé™¤äº†æ‰©å±•è§†é‡ä¹‹å¤–ï¼Œè¿˜èƒ½å¤Ÿå¸®åŠ©æˆ‘ä»¬åˆ¶å®šæœªæ¥å‡ å¹´è¦å­¦ä¹ æˆ–è€…è¦ä½¿ç”¨çš„æŠ€æœ¯è·¯çº¿ã€‚</p><p>æˆ‘ä»¬ä»é˜…è¯»æ¡ˆä¾‹å¼€å§‹ï¼Œçœ‹ä¸€çœ‹æ²¡æœ‰çŸ¢é‡è¿ç®—çš„æ—¶å€™ï¼ŒJavaæ˜¯æ€ä¹ˆæ”¯æŒç§‘å­¦è®¡ç®—çš„ï¼›ç„¶åï¼Œæˆ‘ä»¬å†çœ‹çœ‹çŸ¢é‡è¿ç®—èƒ½å¤Ÿå¸¦æ¥ä»€ä¹ˆæ ·çš„å˜åŒ–ã€‚</p><h2>é˜…è¯»æ¡ˆä¾‹</h2><p>æˆ‘æƒ³ï¼Œä½ å¯¹çº¿æ€§æ–¹ç¨‹ï¼ˆæˆ–è€…è¯´ä¸€æ¬¡æ–¹ç¨‹ï¼‰ä¸€å®šä¸é™Œç”Ÿã€‚ä¸€èˆ¬æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬å¯ä»¥æŠŠçº¿æ€§æ–¹ç¨‹è¡¨è¿°æˆä¸‹é¢çš„å½¢å¼ã€‚</p><p><img src=\"https://static001.geekbang.org/resource/image/ed/c8/edf1d437a318f298ef09769f76c37fc8.png?wh=1186x100\" alt=\"\"></p><p>å…¶ä¸­$a_{0}$ï¼Œ$a_{1}$ï¼Œ$a_{n-1}$è¡¨ç¤ºçš„æ˜¯å¸¸æ•°ï¼Œ$x_{0}$ï¼Œ$x_{1}$ï¼Œ$x_{n-1}$è¡¨ç¤ºçš„æ˜¯å˜é‡ï¼Œè€Œ$y$å°±è¡¨ç¤º$a_{i}$å’Œ$x_{i}$çš„ç»„åˆç»“æœã€‚$n$è¡¨ç¤ºæœªçŸ¥å˜é‡çš„æ•°ç›®ï¼Œé€šå¸¸ï¼Œæˆ‘ä»¬ä¹ŸæŠŠå®ƒç§°ä¸ºæ–¹ç¨‹çš„ç»´åº¦ã€‚</p><!-- [[[read_end]]] --><p>å¦‚æœç»™å®šæ–¹ç¨‹å¼å³è¾¹çš„å¸¸æ•°å’Œå˜é‡ï¼Œæˆ‘ä»¬å°±èƒ½è®¡ç®—å‡ºæ–¹ç¨‹å¼å·¦è¾¹çš„$y$æ•°å€¼äº†ã€‚é‚£ä¹ˆï¼Œè¯¥æ€ä¹ˆç”¨ä»£ç è¡¨ç¤ºè¿™ä¸ªæ–¹ç¨‹å¼å‘¢ï¼Ÿæˆ‘ä»¬å¯ä»¥æŠŠ$a_{0}$ï¼Œ$a_{1}$ï¼Œ$a_{n-1}$è¡¨ç¤ºçš„å¸¸æ•°æ”¾åˆ°ä¸€ä¸ªæ•°ç»„é‡Œï¼ŒæŠŠ$x_{0}$ï¼Œ$x_{1}$ï¼Œ$x_{n-1}$è¡¨ç¤ºçš„å˜é‡æ”¾åˆ°å¦å¤–ä¸€ä¸ªæ•°ç»„é‡Œã€‚ä¸‹é¢çš„ä»£ç é‡Œï¼Œå˜é‡aå’Œxå°±å¯ä»¥ç”¨æ¥è¡¨ç¤ºä¸€ä¸ªæœ‰å››ä¸ªç»´åº¦çš„ä¸€æ¬¡æ–¹ç¨‹ç»„ã€‚</p><pre><code class=\"language-java\">static final float[] a = new float[] {0.6F, 0.7F, 0.8F, 0.9F};\nstatic final float[] x = new float[] {1.0F, 2.0F, 3.0F, 4.0F};\n</code></pre><p>èƒ½ç”¨Javaçš„å˜é‡æ¥è¡¨ç¤ºä¸€æ¬¡æ–¹ç¨‹ï¼Œæˆ‘ä»¬ä¹Ÿå°±èƒ½å¤Ÿè®¡ç®—çº¿æ€§æ–¹ç¨‹çš„ç»“æœäº†ã€‚ä¸‹é¢çš„ä»£ç ï¼Œå°±æ˜¯ä¸€ä¸ªå®ç°çš„åŠæ³•ã€‚</p><pre><code class=\"language-java\">private static Returned&lt;Float&gt; sumInScalar(float[] a, float[] x) {\n    if (a == null || x == null || a.length != x.length) {\n        return new Returned.ErrorCode(-1);\n    }\n    float[] y = new float[a.length];\n    for (int i = 0; i &lt; a.length; i++) {\n        y[i] = a[i] * x[i];\n    }\n    float r = 0F;\n    for (int i = 0; i &lt; y.length; i++) {\n        r += y[i];\n    }\n    return new Returned.ReturnValue&lt;&gt;(r);\n}\n</code></pre><p>åœ¨ä¸Šé¢çš„ä»£ç é‡Œï¼Œæˆ‘ä»¬å…ˆè®¡ç®—$a_{i}$å’Œ$x_{i}$çš„ä¹˜ç§¯ï¼Œç„¶åå†è®¡ç®—ä¹˜ç§¯ç»“æœçš„æ€»å’Œã€‚å…¶ä¸­çš„ä¹˜æ³•è¿ç®—ï¼Œå°±æ˜¯æˆ‘ä»¬å¸¸è¯´çš„æ ‡é‡è¿ç®—ã€‚ä¸ºäº†æ–¹ä¾¿è®¨è®ºï¼Œæˆ‘æŠŠä¹˜æ³•è¿ç®—çš„ä»£ç å•ç‹¬æ‹¿å‡ºæ¥ï¼Œç²˜è´´åœ¨ä¸‹é¢ã€‚</p><pre><code class=\"language-java\">float[] y = new float[a.length];\nfor (int i = 0; i &lt; a.length; i++) {\n    y[i] = a[i] * x[i];\n}\n</code></pre><p>å¦‚æœæˆ‘ä»¬ä»”ç»†è§‚å¯Ÿçº¿æ€§æ–¹ç¨‹å°±ä¼šå‘ç°ï¼Œå¯¹äºæ¯ä¸€ä¸ªçº¬åº¦ï¼Œ$a_{i}$å’Œ$x_{i}$æ˜¯äº’ä¸å½±å“çš„ï¼Œ å½“ç„¶å®ƒä»¬çš„ä¹˜ç§¯ä¹Ÿæ˜¯äº’ä¸å½±å“çš„ã€‚æ—¢ç„¶æ¯ä¸ªç»´åº¦çš„è®¡ç®—éƒ½äº’ä¸å½±å“ï¼Œé‚£ä¹ˆæˆ‘ä»¬èƒ½ä¸èƒ½å¹¶è¡Œè®¡ç®—å‘¢ï¼Ÿ</p><h2>çŸ¢é‡è¿ç®—</h2><p>Javaçš„çŸ¢é‡è¿ç®—å°±æ˜¯ä½¿ç”¨å•ä¸ªæŒ‡ä»¤å¹¶è¡Œå¤„ç†å¤šä¸ªæ•°æ®çš„ä¸€ä¸ªå°è¯•ï¼ˆå•æŒ‡ä»¤å¤šæ•°æ®ï¼ŒSingle Instruction Multiple Dataï¼‰ã€‚</p><p>åœ¨ç°ä»£çš„å¾®å¤„ç†å™¨ï¼ˆCPUï¼‰ä¸­ï¼Œä¸€ä¸ªæ§åˆ¶å™¨å¯ä»¥æ§åˆ¶å¤šä¸ªå¹³è¡Œçš„å¤„ç†å•å…ƒï¼›åœ¨ç°ä»£çš„å›¾å½¢å¤„ç†å™¨ï¼ˆGPUï¼‰ä¸­å‘¢ï¼Œæ›´æ˜¯æ‹¥æœ‰å¼ºå¤§çš„å¹¶å‘å¤„ç†èƒ½åŠ›å’Œå¯ç¼–ç¨‹æµæ°´çº¿ã€‚è¿™äº›å¤„ç†å™¨å±‚é¢çš„æŠ€æœ¯ï¼Œä¸ºè½¯ä»¶å±‚é¢çš„å•æŒ‡ä»¤å¤šæ•°æ®å¤„ç†æä¾›äº†ç‰©ç†æ”¯æŒã€‚JavaçŸ¢é‡è¿ç®—çš„è®¾è®¡å’Œå®ç°ï¼Œä¹Ÿæ˜¯å¸Œæœ›èƒ½å¤Ÿå€ŸåŠ©ç°ä»£å¤„ç†å™¨çš„è¿™ç§èƒ½åŠ›ï¼Œæé«˜è¿ç®—çš„æ€§èƒ½ã€‚</p><p>ä¸ºäº†ä½¿ç”¨å•æŒ‡ä»¤å¤šæ•°æ®çš„æŒ‡ä»¤ï¼Œæˆ‘ä»¬éœ€è¦æŠŠä¸åŒæ•°æ®çš„è¿ç®—ç‹¬ç«‹å‡ºæ¥ï¼Œè®©å¹¶è¡Œè¿ç®—æˆä¸ºå¯èƒ½ã€‚è€Œæ•°å­¦é‡Œçš„çŸ¢é‡è¿ç®—ï¼Œæ°å¥½å°±èƒ½æ»¡è¶³è¿™æ ·çš„è¦æ±‚ã€‚</p><p>å¦‚æœä½¿ç”¨çŸ¢é‡ï¼Œæˆ‘ä»¬å¯ä»¥æŠŠçº¿æ€§æ–¹ç¨‹è¡¨è¿°æˆä¸‹é¢çš„å½¢å¼ï¼ˆä½¿ç”¨å‘é‡çš„æ•°é‡ç§¯å½¢å¼ï¼‰ï¼š</p><p><img src=\"https://static001.geekbang.org/resource/image/a5/0d/a588097f5d725f00ee33405a58a8950d.png?wh=1159x234\" alt=\"\"></p><p>å…¶ä¸­ï¼Œ$a$ï¼Œ$x$å’Œ$y^{'}$æ˜¯ä¸‰ä¸ªnç»´çš„çŸ¢é‡ã€‚</p><p><img src=\"https://static001.geekbang.org/resource/image/01/25/01de675d1d2f528068b246d013efbb25.png?wh=1083x192\" alt=\"\"><br>\nå¥½äº†ï¼Œç°åœ¨æˆ‘ä»¬å¯ä»¥çœ‹çœ‹Javaæ˜¯æ€ä¹ˆè¡¨è¾¾çŸ¢é‡çš„äº†ã€‚ä¸‹é¢ä»£ç é‡Œçš„å˜é‡aï¼Œå’Œå‰é¢é˜…è¯»æ¡ˆä¾‹é‡Œaæ˜¯ä¸€æ ·çš„ï¼Œå®ƒä»¥æ•°ç»„çš„å½¢å¼è¡¨ç¤ºï¼›å˜é‡vaï¼Œå°±æ˜¯å˜é‡açš„çŸ¢é‡è¡¨è¾¾å½¢å¼ã€‚fromArrayè¿™ä¸ªæ–¹æ³•ï¼Œå¯ä»¥æŠŠä¸€ä¸ªæ•°ç»„å˜é‡ï¼Œè½¬æ¢æˆä¸€ä¸ªçŸ¢é‡çš„å˜é‡ã€‚</p><pre><code class=\"language-java\">static final float[] a = new float[] {0.6F, 0.7F, 0.8F, 0.9F};\nstatic final FloatVector va =\n        FloatVector.fromArray(FloatVector.SPECIES_128, a, 0);\n        \nstatic final float[] x = new float[] {1.0F, 2.0F, 3.0F, 4.0F};\nstatic final FloatVector vx =\n        FloatVector.fromArray(FloatVector.SPECIES_128, x, 0);\n</code></pre><p>æœ‰äº†è¡¨ç¤ºçŸ¢é‡çš„åŠæ³•ï¼Œæˆ‘ä»¬å°±å¯ä»¥è¯•ç€ä½¿ç”¨çŸ¢é‡è¿ç®—çš„åŠæ³•ï¼Œæ¥è®¡ç®—çº¿æ€§æ–¹ç¨‹çš„ç»“æœäº†ã€‚ä¸‹é¢çš„ä»£ç ï¼Œå°±æ˜¯ä¸€ä¸ªç®€åŒ–äº†çš„å®ç°ã€‚</p><pre><code class=\"language-java\">private static Returned&lt;Float&gt; sumInVector(FloatVector va, FloatVector vx) {\n    if (va == null || vx == null || va.length() != vx.length()) {\n        return new Returned.ErrorCode(-1);\n    }\n    \n    // FloatVector vy = va.mul(vx);\n    float[] y = va.mul(vx).toArray();\n    \n    float r = 0F;\n    for (int i = 0; i &lt; y.length; i++) {\n        r += y[i];\n    }\n    return new Returned.ReturnValue&lt;&gt;(r);\n}\n</code></pre><p>è¿™ä¸ªè¿ç®—çš„å…³é”®éƒ¨åˆ†æ˜¯å…¶ä¸­çš„çŸ¢é‡è¿ç®—ï¼Œä¹Ÿå°±æ˜¯ä¸‹é¢è¿™è¡Œä»£ç ã€‚</p><pre><code class=\"language-java\">FloatVector vy = va.mul(vx);\n</code></pre><p>å’Œä¸Šé¢çš„æ ‡é‡è¿ç®—çš„åŠæ³•ç›¸æ¯”ï¼ŒçŸ¢é‡è¿ç®—çš„ä»£ç ç²¾ç®€äº†å¾ˆå¤šã€‚è¿™æ˜¯çŸ¢é‡è¿ç®—çš„ç¬¬ä¸€ä¸ªä¼˜ç‚¹ã€‚ä½†å®ƒçš„ä¼˜ç‚¹è¿˜ä¸æ­¢äºæ­¤ã€‚</p><p><img src=\"https://static001.geekbang.org/resource/image/e0/88/e001179cd54623b07ef99210ab13f388.jpg?wh=1920x583\" alt=\"å›¾ç‰‡\"></p><h2>é£™å‡çš„æ€§èƒ½</h2><p>æˆ‘ä»¬å‰é¢æåˆ°ï¼ŒJavaçŸ¢é‡è¿ç®—çš„è®¾è®¡ï¼Œä¸»è¦æ˜¯ä¸ºäº†æ€§èƒ½ã€‚ é‚£ä¹ˆï¼Œæ€§èƒ½çš„æå‡èƒ½æœ‰å¤šå¤§å‘¢ï¼Ÿ æˆ‘è‡ªå·±åšäº†ä¸€ä¸ªæ€§èƒ½æµ‹è¯•ã€‚è™½ç„¶è¿™ä¸ªç‰¹æ€§è¿˜å¤„äºå­µåŒ–æœŸï¼Œä½†æ˜¯å®ƒçš„æ€§èƒ½æµ‹è¯•ç»“æœè¿˜æ˜¯å¾ˆä»¤äººæŒ¯å¥‹çš„ã€‚ å°±ä¸Šé¢è¿™ä¸ªç®€å•çš„ã€å››ç»´çš„çŸ¢é‡æ¥è¯´ï¼Œå’Œæˆ‘ä»¬åœ¨é˜…è¯»æ¡ˆä¾‹é‡Œä½¿ç”¨çš„æ ‡é‡è¿ç®—ç›¸æ¯”ï¼ŒçŸ¢é‡è¿ç®—çš„æ€§èƒ½æé«˜äº†è¶³è¶³æœ‰10å€ã€‚</p><pre><code class=\"language-plain\">Benchmark                       Mode  Cnt           Score           Error  Units\nVectorBench.scalarComputation  thrpt   15   180635563.597 Â±  30893274.582  ops/s\nVectorBench.vectorComputation  thrpt   15  1839556188.443 Â± 153876900.442  ops/s\n</code></pre><p>å¯¹äºä¸€ä¸ªè¿˜å¤„äºå­µåŒ–é˜¶æ®µçš„å®ç°æ¥è¯´ï¼Œè¿™ä¹ˆå¤§çš„æ€§èƒ½æå‡æ˜¯æœ‰ç‚¹è¶…å‡ºé¢„æ–™çš„ã€‚</p><p>åœ¨å¯†ç å­¦å’Œæœºå™¨å­¦ä¹ é¢†åŸŸï¼Œé€šå¸¸éœ€è¦å¤„ç†å‡ ç™¾ç”šè‡³å‡ åƒç»´çš„æ•°æ®ã€‚ä¸€èˆ¬æƒ…å†µä¸‹ï¼Œä¸ºäº†èƒ½å¤Ÿä½¿ç”¨å¤„ç†å™¨çš„è®¡ç®—ä¼˜åŠ¿ï¼Œæˆ‘ä»¬ç»å¸¸éœ€è¦ç‰¹æ®Šçš„è®¾è®¡ä»¥åŠå†…åµŒäºJVMçš„æœ¬åœ°ä»£ç æ¥è·å¾—ç¡¬ä»¶åŠ é€Ÿã€‚è¿™æ ·çš„é™åˆ¶ï¼Œè®©æ™®é€šä»£ç çš„è®¡ç®—å¾ˆéš¾è·å¾—ç¡¬ä»¶åŠ é€Ÿçš„å¥½å¤„ã€‚</p><p>å¸Œæœ›æˆç†Ÿåçš„JavaçŸ¢é‡è¿ç®—ï¼Œèƒ½åœ¨è¿™äº›é¢†åŸŸæœ‰å‡ºè‰²çš„è¡¨ç°ï¼Œè®©æ™®é€šçš„ä»£ç è·å¾—å¤„ç†å™¨çš„å•æŒ‡ä»¤å¤šæ•°æ®çš„å¼ºå¤§è¿ç®—èƒ½åŠ›ã€‚æ¯•ç«Ÿï¼Œåªæœ‰å•æŒ‡ä»¤å¤šæ•°æ®çš„ä¼˜åŠ¿èƒ½å¤Ÿè¢«æ™®é€šçš„Javaåº”ç”¨ç¨‹åºå¹¿æ³›ä½¿ç”¨ï¼ŒJavaæ‰èƒ½åœ¨æœºå™¨å­¦ä¹ ã€ç§‘å­¦è®¡ç®—è¿™äº›é¢†åŸŸè·å¾—è®¡ç®—ä¼˜åŠ¿ã€‚</p><p>å¦‚æœä»æœºå™¨å­¦ä¹ åœ¨æœªæ¥çš„é‡è¦æ€§æ¥è¯´ï¼ŒJavaåœ¨ç§‘å­¦è®¡ç®—é¢†åŸŸçš„æ‹“å±•æ¥å¾—ä¹Ÿè®¸æ­£æ˜¯æ—¶å€™ã€‚</p><h2>æ€»ç»“</h2><p>å¥½ï¼Œåˆ°è¿™é‡Œï¼Œæˆ‘æ¥åšä¸ªå°ç»“ã€‚å‰é¢ï¼Œæˆ‘ä»¬è®¨è®ºäº†Javaçš„çŸ¢é‡è¿ç®—è¿™ä¸ªå°šå¤„äºå­µåŒ–é˜¶æ®µçš„æ–°ç‰¹æ€§ï¼Œå¯¹Javaçš„çŸ¢é‡è¿ç®—è¿™ä¸ªæ–°ç‰¹æ€§æœ‰äº†ä¸€ä¸ªåˆå§‹çš„å°è±¡ã€‚</p><p>å¦‚æœJavaçŸ¢é‡è¿ç®—æˆç†Ÿèµ·æ¥ï¼Œè®¸å¤šé¢†åŸŸéƒ½å¯ä»¥ä»è¿™ä¸ªæ–°ç‰¹æ€§ä¸­å—ç›Šï¼ŒåŒ…æ‹¬ä½†æ˜¯ä¸é™äºæœºå™¨å­¦ä¹ ã€çº¿æ€§ä»£æ•°ã€å¯†ç å­¦ã€é‡‘èå’ŒJDK æœ¬èº«çš„ä»£ç ã€‚</p><p>è¿™ä¸€æ¬¡å­¦ä¹ çš„ä¸»è¦ç›®çš„ï¼Œå°±æ˜¯è®©ä½ å¯¹çŸ¢é‡è¿ç®—æœ‰ä¸€ä¸ªåŸºæœ¬çš„å°è±¡ã€‚è¿™æ ·çš„è¯ï¼Œå¦‚æœä½ çš„ä»£ç é‡Œæœ‰å¤§é‡çš„æ•°å€¼è®¡ç®—ï¼Œä¹Ÿè®¸å¯ä»¥è€ƒè™‘åœ¨å°†æ¥ä½¿ç”¨çŸ¢é‡è¿ç®—è·å¾—ç¡¬ä»¶çš„å¹¶è¡Œè®¡ç®—èƒ½åŠ›ï¼Œå¤§å¹…åº¦æé«˜ä»£ç çš„æ€§èƒ½ã€‚</p><p>ç”±äºçŸ¢é‡è¿ç®—å°šå¤„äºå­µåŒ–é˜¶æ®µï¼Œç›®å‰æˆ‘ä»¬è¿˜ä¸éœ€è¦å­¦ä¹ å®ƒçš„APIï¼ŒçŸ¥é“Javaæœ‰è¿™ä¸ªå‘å±•æ–¹å‘ï¼Œå¹¶ä¸”èƒ½å¤Ÿæ€è€ƒä½ çš„ä»£ç æ½œåœ¨çš„æ”¹è¿›ç©ºé—´å°±è¶³å¤Ÿäº†ã€‚çŸ¥é“äº†è¿™ä¸ªæ–¹å‘ï¼Œç­‰JavaçŸ¢é‡è¿ç®—æ­£å¼å‘å¸ƒçš„æ—¶å€™ï¼Œä½ å°±å¯ä»¥å°½æ—©åœ°æ”¹è¿›ä½ çš„ä»£ç ï¼Œä»è€Œè·å¾—é¢†å…ˆçš„ä¼˜åŠ¿äº†ã€‚</p><p>å¦‚æœé¢è¯•ä¸­èŠåˆ°äº†æ•°å€¼è®¡ç®—çš„æ€§èƒ½ï¼Œä½ åº”è¯¥çŸ¥é“æœ‰çŸ¢é‡è¿ç®—è¿™ä¹ˆä¸€ä¸ªæ½œåœ¨çš„æ–¹å‘ï¼Œä»¥åŠâ€œå•æŒ‡ä»¤å¤šæ•°æ®â€è¿™ä¹ˆä¸€ä¸ªæœ¯è¯­ã€‚</p><h2>æ€è€ƒé¢˜</h2><p>å…¶å®ï¼Œä»Šå¤©çš„è¿™ä¸ªæ–°ç‰¹æ€§ï¼Œæ˜¯ç»ƒä¹ ä½¿ç”¨JShellå¿«é€Ÿå­¦ä¹ æ–°æŠ€æœ¯çš„ä¸€ä¸ªå¥½æœºä¼šã€‚ä½¿ç”¨é˜…è¯»æ¡ˆä¾‹é‡Œæä¾›çš„æ•°æ®ï¼Œä½ èƒ½å¤Ÿä½¿ç”¨JShellï¼Œå¿«é€Ÿåœ°è¡¨ç¤ºå‡ºä¸‹é¢çš„è¿™ä¸ªçŸ¢é‡å—ï¼Ÿ</p><p>$$y{'} = ax$$</p><p>éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œè¦æƒ³ä½¿ç”¨å­µåŒ–æœŸçš„JDKæŠ€æœ¯ï¼Œéœ€è¦åœ¨JShellé‡Œå¯¼å…¥å­µåŒ–æœŸçš„JDKæ¨¡å—ï¼Œå°±åƒä¸‹é¢çš„ä¾‹å­è¿™æ ·ã€‚</p><pre><code class=\"language-java\">$ jshell --add-modules jdk.incubator.vector -v\n|&nbsp; Welcome to JShell -- Version 17\n|&nbsp; For an introduction type: /help intro\n\njshell&gt; import jdk.incubator.vector.*;\n</code></pre><p>æ¬¢è¿ä½ åœ¨ç•™è¨€åŒºç•™è¨€ã€è®¨è®ºï¼Œåˆ†äº«ä½ çš„é˜…è¯»ä½“éªŒä»¥åŠä½ çš„è®¾è®¡å’Œä»£ç ã€‚æˆ‘ä»¬ä¸‹èŠ‚è¯¾è§ï¼</p><p>æ³¨ï¼šæœ¬æ–‡ä½¿ç”¨çš„å®Œæ•´çš„ä»£ç å¯ä»¥ä»<a href=\"https://github.com/XueleiFan/java-up/tree/main/src/main/java/co/ivi/jus/vector\">GitHub</a>ä¸‹è½½ï¼Œä½ å¯ä»¥é€šè¿‡ä¿®æ”¹<a href=\"https://github.com/XueleiFan/java-up/tree/main/src/main/java/co/ivi/jus/vector\">GitHub</a>ä¸Š<a href=\"https://github.com/XueleiFan/java-up/blob/main/src/main/java/co/ivi/jus/vector/review/xuelei/vector.jsh\">review template</a>ä»£ç ï¼Œå®Œæˆè¿™æ¬¡çš„æ€è€ƒé¢˜ã€‚å¦‚æœä½ æƒ³è¦åˆ†äº«ä½ çš„ä¿®æ”¹æˆ–è€…æƒ³å¬å¬è¯„å®¡çš„æ„è§ï¼Œè¯·æäº¤ä¸€ä¸ª GitHubçš„æ‹‰å–è¯·æ±‚ï¼ˆPull Requestï¼‰ï¼Œå¹¶æŠŠæ‹‰å–è¯·æ±‚çš„åœ°å€è´´åˆ°ç•™è¨€é‡Œã€‚è¿™ä¸€å°èŠ‚çš„æ‹‰å–è¯·æ±‚ä»£ç ï¼Œè¯·åœ¨<a href=\"https://github.com/XueleiFan/java-up/blob/main/src/main/java/co/ivi/jus/vector/review\">çŸ¢é‡è¿ç®—ä¸“ç”¨çš„ä»£ç è¯„å®¡ç›®å½•</a>ä¸‹ï¼Œå»ºä¸€ä¸ªä»¥ä½ çš„åå­—å‘½åçš„å­ç›®å½•ï¼Œä»£ç æ”¾åˆ°ä½ ä¸“æœ‰çš„å­ç›®å½•é‡Œã€‚æ¯”å¦‚ï¼Œæˆ‘çš„ä»£ç ï¼Œå°±æ”¾åœ¨vector/review/xueleiçš„ç›®å½•ä¸‹é¢ã€‚</p>","neighbors":{"left":{"article_title":"10 | Flowï¼Œæ˜¯å¼‚æ­¥ç¼–ç¨‹çš„ç»ˆæé€‰æ‹©å—ï¼Ÿ","id":464209},"right":{"article_title":"12 | å¤–éƒ¨å†…å­˜æ¥å£ï¼šé›¶æ‹·è´çš„éšœç¢è¿˜æœ‰å¤šå°‘ï¼Ÿ","id":465899}},"comments":[{"had_liked":false,"id":325299,"user_name":"aoe","can_delete":false,"product_type":"c1","uid":1121758,"ip_address":"","ucode":"1C6201EDB4E954","user_header":"https://static001.geekbang.org/account/avatar/00/11/1d/de/62bfa83f.jpg","comment_is_top":false,"comment_ctime":1638896477,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"18818765661","product_id":100097301,"comment_content":"çœ‹ä¸ªçƒ­é—¹","like_count":4},{"had_liked":false,"id":359365,"user_name":"if...else...","can_delete":false,"product_type":"c1","uid":2550743,"ip_address":"æµ™æ±Ÿ","ucode":"D0565908C99695","user_header":"https://static001.geekbang.org/account/avatar/00/26/eb/d7/90391376.jpg","comment_is_top":false,"comment_ctime":1665476696,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1665476696","product_id":100097301,"comment_content":"å­¦ä¹ æ‰“å¡ï¼ŒJavaçŸ¢é‡è¿ç®—","like_count":0},{"had_liked":false,"id":330724,"user_name":"å‘å…‰å¦‚æ˜Ÿ","can_delete":false,"product_type":"c1","uid":1087348,"ip_address":"","ucode":"1176C2EB6CC401","user_header":"https://static001.geekbang.org/account/avatar/00/10/97/74/49d150d7.jpg","comment_is_top":false,"comment_ctime":1642132435,"is_pvip":true,"replies":[{"id":"120619","content":"å—¨ï¼Œæˆ‘è¦æ˜¯å›ç­”äº†è¿™ä¸ªé—®é¢˜ï¼Œå°±ä¼šæš´éœ²æˆ‘å¯¹äºScalaçš„äº†è§£ä»…é™äºåå­—ã€‚å°ä¼™ä¼´ä»¬ï¼Œæœ‰äº†è§£çš„å—ï¼Ÿ å¸®å¿™å›ç­”ä¸€ä¸‹ï¼Ÿ","user_name":"ä½œè€…å›å¤","user_name_real":"ç¼–è¾‘","uid":"1111315","ctime":1642146548,"ip_address":"","comment_id":330724,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1642132435","product_id":100097301,"comment_content":"è¿™ä¸ªåŠŸèƒ½æ˜¯ä¸æ˜¯scalaå·²ç»å…·å¤‡äº†çš„","like_count":0,"discussions":[{"author":{"id":1111315,"avatar":"https://static001.geekbang.org/account/avatar/00/10/f5/13/78741b7b.jpg","nickname":"èŒƒå­¦é›·","note":"","ucode":"D7CBE4A33427BD","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":546062,"discussion_content":"å—¨ï¼Œæˆ‘è¦æ˜¯å›ç­”äº†è¿™ä¸ªé—®é¢˜ï¼Œå°±ä¼šæš´éœ²æˆ‘å¯¹äºScalaçš„äº†è§£ä»…é™äºåå­—ã€‚å°ä¼™ä¼´ä»¬ï¼Œæœ‰äº†è§£çš„å—ï¼Ÿ å¸®å¿™å›ç­”ä¸€ä¸‹ï¼Ÿ","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1642146548,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":326278,"user_name":"Jxin","can_delete":false,"product_type":"c1","uid":1251111,"ip_address":"","ucode":"4C03928388C413","user_header":"https://static001.geekbang.org/account/avatar/00/13/17/27/ec30d30a.jpg","comment_is_top":false,"comment_ctime":1639458240,"is_pvip":false,"replies":[{"id":"118532","content":"å“ˆå“ˆï¼Œæ¯ä¸ªäººçš„æ¡ˆå¤´ï¼Œéƒ½æœ‰ä¸€å †çš„æœªæ¥è®¡åˆ’ã€‚ å…¶å®ï¼Œè¿™æ˜¯å•æŒ‡ä»¤å¤šæ•°æ®æŠ€æœ¯åœ¨CPU&#47;GPUæŒ‡ä»¤é›†é‡Œæˆç†Ÿçš„ç»“æœã€‚","user_name":"ä½œè€…å›å¤","user_name_real":"ç¼–è¾‘","uid":"1111315","ctime":1639524144,"ip_address":"","comment_id":326278,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1639458240","product_id":100097301,"comment_content":"çŸ¢é‡è¿ç®—çš„ä»£ç å®ç°æ›´ç¬¦åˆooçš„é£æ ¼ã€‚å¹¶ä¸”çŸ¥é“èƒŒåè¿è¡Œé€»è¾‘ï¼Œç†è§£èµ·æ¥æ²¡ä»»ä½•éšœç¢ã€‚å“ªæ€•æ²¡æœ‰æ€§èƒ½æå‡ï¼Œå®ƒçš„æ¨è¡Œä¹Ÿæ²¡æœ‰å¤ªå¤§é—®é¢˜ï¼Œç›¸æ¯”æ ‡é‡åªæœ‰ä¼˜åŠ¿æ²¡æœ‰åŠ£åŠ¿ã€‚é‚£ä¹ˆé—®é¢˜æ¥äº†ï¼Œä¸ºä»€ä¹ˆåˆ°ç°åœ¨æ‰æ”¯æŒï¼Œä¹‹å‰ä¸æ”¯æŒæ˜¯å‡ºäºä»€ä¹ˆè€ƒè™‘å—ï¼Ÿ","like_count":0,"discussions":[{"author":{"id":1111315,"avatar":"https://static001.geekbang.org/account/avatar/00/10/f5/13/78741b7b.jpg","nickname":"èŒƒå­¦é›·","note":"","ucode":"D7CBE4A33427BD","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":538792,"discussion_content":"å“ˆå“ˆï¼Œæ¯ä¸ªäººçš„æ¡ˆå¤´ï¼Œéƒ½æœ‰ä¸€å †çš„æœªæ¥è®¡åˆ’ã€‚ å…¶å®ï¼Œè¿™æ˜¯å•æŒ‡ä»¤å¤šæ•°æ®æŠ€æœ¯åœ¨CPU/GPUæŒ‡ä»¤é›†é‡Œæˆç†Ÿçš„ç»“æœã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1639524144,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":325562,"user_name":"å“¦å¼æ‰äº†","can_delete":false,"product_type":"c1","uid":1232599,"ip_address":"","ucode":"1F89B1BA1EEF52","user_header":"https://static001.geekbang.org/account/avatar/00/12/ce/d7/8168e1bf.jpg","comment_is_top":false,"comment_ctime":1639021416,"is_pvip":true,"replies":[{"id":"118118","content":"ç¬¬ä¸€ä¸ªé—®é¢˜ï¼Œæˆ‘ä¹Ÿä¸çŸ¥é“è¯¥æ€ä¹ˆåŠã€‚æˆ‘ä½¿ç”¨çš„æ˜¯IDEAï¼ŒèŠ±è´¹äº†å¾ˆé•¿æ—¶é—´ï¼Œæˆ‘ä¹Ÿæ²¡ææ¸…æ¥šIDEAæ˜¯æ€ä¹ˆæ”¯æŒå­µåŒ–æœŸçš„ç‰¹æ€§çš„ã€‚æœ‰ç»éªŒçš„å°ä¼™ä¼´ä»¬å¸®å¸®å¿™ã€‚<br><br>ç¬¬äºŒä¸ªé—®é¢˜ï¼Œæˆ‘æ²¡æœ‰çœ‹åˆ°ä¸ºä»€ä¹ˆä¸å¯ä»¥ï¼Œåº”è¯¥å’Œè„šæœ¬å¤§å°æ²¡æœ‰å…³ç³»ã€‚","user_name":"ä½œè€…å›å¤","user_name_real":"ç¼–è¾‘","uid":"1111315","ctime":1639032865,"ip_address":"","comment_id":325562,"utype":1}],"discussion_count":2,"race_medal":0,"score":"1639021416","product_id":100097301,"comment_content":"é‡åˆ°çš„é—®é¢˜ï¼šç¨‹åºåŒ… jdk.incubator.vector å·²åœ¨æ¨¡å— jdk.incubator.vector ä¸­å£°æ˜, ä½†è¯¥æ¨¡å—ä¸åœ¨æ¨¡å—å›¾ä¸­ï¼›<br>å’¨è¯¢çš„é—®é¢˜ï¼šå¦‚æœç¨å¾®å¤§ä¸€ç‚¹çš„javaè„šæœ¬(ä¸€å †æµ‹è¯•ä»£ç )ï¼Œèƒ½ä½¿ç”¨jshellå¯¼å…¥æ‰§è¡Œä¹ˆï¼Ÿ","like_count":0,"discussions":[{"author":{"id":1111315,"avatar":"https://static001.geekbang.org/account/avatar/00/10/f5/13/78741b7b.jpg","nickname":"èŒƒå­¦é›·","note":"","ucode":"D7CBE4A33427BD","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":537319,"discussion_content":"ç¬¬ä¸€ä¸ªé—®é¢˜ï¼Œæˆ‘ä¹Ÿä¸çŸ¥é“è¯¥æ€ä¹ˆåŠã€‚æˆ‘ä½¿ç”¨çš„æ˜¯IDEAï¼ŒèŠ±è´¹äº†å¾ˆé•¿æ—¶é—´ï¼Œæˆ‘ä¹Ÿæ²¡ææ¸…æ¥šIDEAæ˜¯æ€ä¹ˆæ”¯æŒå­µåŒ–æœŸçš„ç‰¹æ€§çš„ã€‚æœ‰ç»éªŒçš„å°ä¼™ä¼´ä»¬å¸®å¸®å¿™ã€‚\n\nç¬¬äºŒä¸ªé—®é¢˜ï¼Œæˆ‘æ²¡æœ‰çœ‹åˆ°ä¸ºä»€ä¹ˆä¸å¯ä»¥ï¼Œåº”è¯¥å’Œè„šæœ¬å¤§å°æ²¡æœ‰å…³ç³»ã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1639032866,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1059926,"avatar":"https://static001.geekbang.org/account/avatar/00/10/2c/56/ff7a9730.jpg","nickname":"è®¸çµ","note":"","ucode":"0296EC9929B570","race_medal":0,"user_type":1,"is_pvip":true},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":537572,"discussion_content":"ç¬¬ä¸€ä¸ªé—®é¢˜ï¼Œæ˜¯éœ€è¦åœ¨srcä¸‹æ–°å»ºmodule-info.javaç±»ï¼Œå¼•å…¥æ–°çš„ç‰¹æ€§ã€‚\nmodule cn.ivi.jus {\n    requires jdk.incubator.foreign;\n    requires jdk.incubator.vector;\n    requires jmh.core;\n}\nåŒæ—¶éœ€è¦ä¿®å¤ä¸¤ä¸ªç±»çš„packageé”™è¯¯","likes_number":1,"is_delete":false,"is_hidden":false,"ctime":1639106565,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":325363,"user_name":"è¿‡å»  Sword  å°†æ¥","can_delete":false,"product_type":"c1","uid":1399935,"ip_address":"","ucode":"BC459EBEE00184","user_header":"https://static001.geekbang.org/account/avatar/00/15/5c/7f/3c46f3c5.jpg","comment_is_top":false,"comment_ctime":1638932012,"is_pvip":false,"replies":[{"id":"118063","content":"å—¯ï¼Œè¦æ˜¯è¯´ä¸€ä¸‹å°±å¥½äº†ã€‚ å­µåŒ–æœŸçš„ç‰¹æ€§ï¼Œ å»ºè®®ä½¿ç”¨æœ€æ–°ç‰ˆæœ¬çš„ã€‚","user_name":"ä½œè€…å›å¤","user_name_real":"ç¼–è¾‘","uid":"1111315","ctime":1638945916,"ip_address":"","comment_id":325363,"utype":1}],"discussion_count":2,"race_medal":0,"score":"1638932012","product_id":100097301,"comment_content":"è€å¸ˆï¼Œèƒ½å¦å’Œä¹‹å‰é‚£æ ·è¯´ä¸€ä¸‹æ–°ç‰¹æ€§åœ¨å“ªä¸ªç‰ˆæœ¬ä»¥é¢„è§ˆç‰ˆå‡ºæ¥çš„å‘¢ï¼Ÿä¸ªäººç”µè„‘è£…äº†17ï¼Œä½†æ˜¯åˆšåˆšæˆ‘åœ¨å…¬å¸ç”µè„‘jdk11è¾“å…¥FloatVectorå‘ç°å¹¶æ²¡æœ‰ğŸ˜‚","like_count":0,"discussions":[{"author":{"id":1111315,"avatar":"https://static001.geekbang.org/account/avatar/00/10/f5/13/78741b7b.jpg","nickname":"èŒƒå­¦é›·","note":"","ucode":"D7CBE4A33427BD","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":537049,"discussion_content":"å—¯ï¼Œè¦æ˜¯è¯´ä¸€ä¸‹å°±å¥½äº†ã€‚ å­µåŒ–æœŸçš„ç‰¹æ€§ï¼Œ å»ºè®®ä½¿ç”¨æœ€æ–°ç‰ˆæœ¬çš„ã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1638945916,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1337030,"avatar":"https://static001.geekbang.org/account/avatar/00/14/66/c6/d779dfb6.jpg","nickname":"æ¾æ¾","note":"","ucode":"EB2A80CF7BCA4B","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":537007,"discussion_content":"è¿˜æ²¡è¿›é¢„è§ˆç‰ˆï¼Œå±äºå­µåŒ–é˜¶æ®µï¼Œéœ€è¦æ‰‹åŠ¨å¯¼å…¥","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1638933523,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]}]}