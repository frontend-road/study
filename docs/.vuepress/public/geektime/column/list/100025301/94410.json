{"id":94410,"title":"12 | æˆ‘ä»¬ä¸ºä»€ä¹ˆéœ€è¦Sparkï¼Ÿ","content":"<p>ä½ å¥½ï¼Œæˆ‘æ˜¯è”¡å…ƒæ¥ ã€‚</p><p>ä»Šå¤©æˆ‘è¦ä¸ä½ åˆ†äº«çš„ä¸»é¢˜æ˜¯â€œæˆ‘ä»¬ä¸ºä»€ä¹ˆéœ€è¦Sparkâ€ã€‚</p><p>ä¹Ÿè®¸ä½ ä¹‹å‰æ²¡æœ‰åšè¿‡å¤§è§„æ¨¡æ•°æ®å¤„ç†çš„é¡¹ç›®ï¼Œä½†æ˜¯Sparkè¿™ä¸ªè¯æˆ‘ç›¸ä¿¡ä½ ä¸€å®šæœ‰æ‰€è€³é—»ã€‚</p><p>Sparkæ˜¯å½“ä»Šæœ€æµè¡Œçš„åˆ†å¸ƒå¼å¤§è§„æ¨¡æ•°æ®å¤„ç†å¼•æ“ï¼Œè¢«å¹¿æ³›åº”ç”¨åœ¨å„ç±»å¤§æ•°æ®å¤„ç†åœºæ™¯ã€‚</p><p>2009å¹´ï¼Œç¾å›½åŠ å·å¤§å­¦ä¼¯å…‹åˆ©åˆ†æ ¡çš„AMPå®éªŒå®¤å¼€å‘äº†Sparkã€‚2013å¹´ï¼ŒSparkæˆä¸ºApacheè½¯ä»¶åŸºé‡‘ä¼šæ——ä¸‹çš„å­µåŒ–é¡¹ç›®ã€‚</p><p>è€Œç°åœ¨ï¼ŒSparkå·²ç»æˆä¸ºäº†è¯¥åŸºé‡‘ä¼šç®¡ç†çš„é¡¹ç›®ä¸­æœ€æ´»è·ƒçš„ä¸€ä¸ªã€‚Sparkç¤¾åŒºä¹Ÿæ˜¯æˆé•¿è¿…é€Ÿï¼Œä¸ä»…æœ‰æ•°ä»¥åƒè®¡çš„ä¸ªäººè´¡çŒ®è€…åœ¨ä¸æ–­åœ°å¼€å‘ç»´æŠ¤ï¼Œè¿˜æœ‰å¾ˆå¤šå¤§å…¬å¸ä¹ŸåŠ å…¥äº†è¿™ä¸ªå¼€æºé¡¹ç›®ï¼Œå¦‚Databricksã€IBMå’Œåä¸ºã€‚</p><p>åœ¨æŠ€æœ¯ä¸æ–­é«˜é€Ÿæ›´è¿­çš„ç¨‹åºåœˆï¼Œä¸€ä¸ªæ–°å·¥å…·çš„å‡ºç°ä¸æµè¡Œï¼Œå¿…ç„¶æ˜¯å› ä¸ºå®ƒæ»¡è¶³äº†å¾ˆå¤§ä¸€éƒ¨åˆ†äººé•¿æœŸæœªè¢«æ»¡è¶³çš„éœ€æ±‚ï¼Œæˆ–æ˜¯è§£å†³äº†ä¸€ä¸ªé•¿æœŸè®©å¾ˆå¤šäººéš¾å—çš„ç—›ç‚¹ã€‚</p><p>æ‰€ä»¥ï¼Œåœ¨å­¦ä¸€ä¸ªæ–°æŠ€æœ¯ä¹‹å‰ï¼Œä½ æœ‰å¿…è¦å…ˆäº†è§£è¿™é—¨æŠ€æœ¯å‡ºç°çš„æ„ä¹‰ã€‚è¿™æ ·ï¼Œä½ æ‰èƒ½æ›´å¥½åœ°ç†è§£ï¼šå®ƒæ˜¯åº”ç”¨åˆ°ä»€ä¹ˆåœºæ™¯çš„ï¼Ÿä¸åŒç±»å·¥å…·ç›¸æ¯”ï¼Œå®ƒçš„ä¼˜ç¼ºç‚¹æ˜¯ä»€ä¹ˆï¼Ÿä»€ä¹ˆæ—¶å€™ç”¨å®ƒæ¯”å…¶å®ƒå·¥å…·å¥½ï¼ˆæˆ–å·®ï¼‰ï¼Ÿâ€¦â€¦</p><p>è‡³å°‘ç†è§£äº†è¿™äº›ï¼Œä½ æ‰å¥½è¯´è‡ªå·±æ˜¯çœŸæ­£æŒæ¡äº†è¿™ä¸ªå·¥å…·ï¼Œå¦åˆ™åªèƒ½è¯´æ˜¯æµ…å°è¾„æ­¢ï¼ŒåŠç”Ÿä¸ç†Ÿã€‚</p><p>å­¦ä¹ SparkåŒæ ·æ˜¯å¦‚æ­¤ã€‚</p><!-- [[[read_end]]] --><p>æˆ‘ä»¬é¦–å…ˆè¦é—®è‡ªå·±ï¼Œæ—¢ç„¶å·²ç»æœ‰äº†çœ‹ä¼¼å¾ˆæˆç†Ÿçš„Hadoopå’ŒMapReduceï¼Œä¸ºä»€ä¹ˆæˆ‘ä»¬è¿˜éœ€è¦Sparkï¼Ÿå®ƒèƒ½å¸®æˆ‘ä»¬è§£å†³ä»€ä¹ˆå®é™…é—®é¢˜ï¼Ÿç›¸æ¯”äºMapReduceï¼Œå®ƒçš„ä¼˜åŠ¿åˆæ˜¯ä»€ä¹ˆï¼Ÿ</p><h2>MapReduceçš„ç¼ºé™·</h2><p>MapReduceé€šè¿‡ç®€å•çš„Mapå’ŒReduceçš„æŠ½è±¡æä¾›äº†ä¸€ä¸ªç¼–ç¨‹æ¨¡å‹ï¼Œå¯ä»¥åœ¨ä¸€ä¸ªç”±ä¸Šç™¾å°æœºå™¨ç»„æˆçš„é›†ç¾¤ä¸Šå¹¶å‘å¤„ç†å¤§é‡çš„æ•°æ®é›†ï¼Œè€ŒæŠŠè®¡ç®—ç»†èŠ‚éšè—èµ·æ¥ã€‚å„ç§å„æ ·çš„å¤æ‚æ•°æ®å¤„ç†éƒ½å¯ä»¥åˆ†è§£ä¸ºMapæˆ–Reduceçš„åŸºæœ¬å…ƒç´ ã€‚</p><p>è¿™æ ·ï¼Œå¤æ‚çš„æ•°æ®å¤„ç†å¯ä»¥åˆ†è§£ä¸ºç”±å¤šä¸ªJobï¼ˆåŒ…å«ä¸€ä¸ªMapperå’Œä¸€ä¸ªReducerï¼‰ç»„æˆçš„æœ‰å‘æ— ç¯å›¾ï¼ˆDAGï¼‰ï¼Œç„¶åæ¯ä¸ªMapperå’ŒReduceræ”¾åˆ°Hadoopé›†ç¾¤ä¸Šæ‰§è¡Œï¼Œå°±å¯ä»¥å¾—å‡ºç»“æœã€‚</p><p>æˆ‘ä»¬åœ¨ç¬¬ä¸€è®²ä¸­è®²åˆ°è¿‡MapReduceè¢«ç¡…è°·ä¸€çº¿å…¬å¸æ·˜æ±°çš„ä¸¤å¤§ä¸»è¦åŸå› ï¼šé«˜æ˜‚çš„ç»´æŠ¤æˆæœ¬ã€æ—¶é—´æ€§èƒ½â€œè¾¾ä¸åˆ°â€ç”¨æˆ·çš„æœŸå¾…ã€‚ä¸è¿‡é™¤æ­¤ä¹‹å¤–ï¼ŒMapReduceè¿˜å­˜åœ¨è¯¸å¤šå±€é™ã€‚</p><p>ç¬¬ä¸€ï¼ŒMapReduceæ¨¡å‹çš„æŠ½è±¡å±‚æ¬¡ä½ï¼Œå¤§é‡çš„åº•å±‚é€»è¾‘éƒ½éœ€è¦å¼€å‘è€…æ‰‹å·¥å®Œæˆã€‚</p><p>æ‰“ä¸ªæ¯”æ–¹ï¼Œå†™MapReduceçš„åº”ç”¨å°±å¥½æ¯”ç”¨æ±‡ç¼–è¯­è¨€å»ç¼–å†™ä¸€ä¸ªå¤æ‚çš„æ¸¸æˆã€‚å¦‚æœä½ æ˜¯å¼€å‘è€…ï¼Œä½ ä¼šä¹ æƒ¯ç”¨æ±‡ç¼–è¯­è¨€ï¼Œè¿˜æ˜¯ä½¿ç”¨å„ç§é«˜çº§è¯­è¨€å¦‚Javaã€C++çš„ç°æœ‰æ¡†æ¶å‘¢ï¼Ÿ</p><p>ç¬¬äºŒï¼Œåªæä¾›Mapå’ŒReduceä¸¤ä¸ªæ“ä½œã€‚</p><p>å¾ˆå¤šç°å®çš„æ•°æ®å¤„ç†åœºæ™¯å¹¶ä¸é€‚åˆç”¨è¿™ä¸ªæ¨¡å‹æ¥æè¿°ã€‚å®ç°å¤æ‚çš„æ“ä½œå¾ˆæœ‰æŠ€å·§æ€§ï¼Œä¹Ÿä¼šè®©æ•´ä¸ªå·¥ç¨‹å˜å¾—åºå¤§ä»¥åŠéš¾ä»¥ç»´æŠ¤ã€‚</p><p>ä¸¾ä¸ªä¾‹å­ï¼Œä¸¤ä¸ªæ•°æ®é›†çš„Joinæ˜¯å¾ˆåŸºæœ¬è€Œä¸”å¸¸ç”¨çš„åŠŸèƒ½ï¼Œä½†æ˜¯åœ¨MapReduceçš„ä¸–ç•Œä¸­ï¼Œéœ€è¦å¯¹è¿™ä¸¤ä¸ªæ•°æ®é›†åšä¸€æ¬¡Mapå’ŒReduceæ‰èƒ½å¾—åˆ°ç»“æœã€‚è¿™æ ·æ¡†æ¶å¯¹äºå¼€å‘è€…éå¸¸ä¸å‹å¥½ã€‚æ­£å¦‚ç¬¬ä¸€è®²ä¸­æåˆ°çš„ï¼Œç»´æŠ¤ä¸€ä¸ªå¤šä»»åŠ¡åè°ƒçš„çŠ¶æ€æœºæˆæœ¬å¾ˆé«˜ï¼Œè€Œä¸”å¯æ‰©å±•æ€§éå¸¸å·®ã€‚</p><p>ç¬¬ä¸‰ï¼Œåœ¨Hadoopä¸­ï¼Œæ¯ä¸€ä¸ªJobçš„è®¡ç®—ç»“æœéƒ½ä¼šå­˜å‚¨åœ¨HDFSæ–‡ä»¶å­˜å‚¨ç³»ç»Ÿä¸­ï¼Œæ‰€ä»¥æ¯ä¸€æ­¥è®¡ç®—éƒ½è¦è¿›è¡Œç¡¬ç›˜çš„è¯»å–å’Œå†™å…¥ï¼Œå¤§å¤§å¢åŠ äº†ç³»ç»Ÿçš„å»¶è¿Ÿã€‚</p><p>ç”±äºè¿™ä¸€åŸå› ï¼ŒMapReduceå¯¹äºè¿­ä»£ç®—æ³•çš„å¤„ç†æ€§èƒ½å¾ˆå·®ï¼Œè€Œä¸”å¾ˆè€—èµ„æºã€‚å› ä¸ºè¿­ä»£çš„æ¯ä¸€æ­¥éƒ½è¦å¯¹HDFSè¿›è¡Œè¯»å†™ï¼Œæ‰€ä»¥æ¯ä¸€æ­¥éƒ½éœ€è¦å·®ä¸å¤šçš„ç­‰å¾…æ—¶é—´ã€‚</p><p>ç¬¬å››ï¼Œåªæ”¯æŒæ‰¹æ•°æ®å¤„ç†ï¼Œæ¬ ç¼ºå¯¹æµæ•°æ®å¤„ç†çš„æ”¯æŒã€‚</p><p>å› æ­¤ï¼Œåœ¨Hadoopæ¨å‡ºåï¼Œæœ‰å¾ˆå¤šäººæƒ³åŠæ³•å¯¹Hadoopè¿›è¡Œä¼˜åŒ–ï¼Œå…¶ä¸­å‘å±•åˆ°ç°åœ¨æœ€æˆç†Ÿçš„å°±æ˜¯Sparkã€‚</p><p>æ¥ä¸‹æ¥ï¼Œå°±è®©æˆ‘ä»¬çœ‹ä¸€ä¸‹Sparkæ˜¯å¦‚ä½•å¯¹ä¸Šè¿°é—®é¢˜è¿›è¡Œä¼˜åŒ–çš„ã€‚</p><h2>Sparkçš„ä¼˜åŠ¿</h2><p>Sparkæœ€åŸºæœ¬çš„æ•°æ®æŠ½è±¡å«ä½œå¼¹æ€§åˆ†å¸ƒå¼æ•°æ®é›†ï¼ˆResilient Distributed Dataset, RDDï¼‰ï¼Œå®ƒä»£è¡¨ä¸€ä¸ªå¯ä»¥è¢«åˆ†åŒºï¼ˆpartitionï¼‰çš„åªè¯»æ•°æ®é›†ï¼Œå®ƒå†…éƒ¨å¯ä»¥æœ‰å¾ˆå¤šåˆ†åŒºï¼Œæ¯ä¸ªåˆ†åŒºåˆæœ‰å¤§é‡çš„æ•°æ®è®°å½•ï¼ˆrecordï¼‰ã€‚</p><p>RDDæ˜¯Sparkæœ€åŸºæœ¬çš„æ•°æ®ç»“æ„ã€‚Sparkå®šä¹‰äº†å¾ˆå¤šå¯¹RDDçš„æ“ä½œã€‚å¯¹RDDçš„ä»»ä½•æ“ä½œéƒ½å¯ä»¥åƒå‡½æ•°å¼ç¼–ç¨‹ä¸­æ“ä½œå†…å­˜ä¸­çš„é›†åˆä¸€æ ·ç›´è§‚ã€ç®€ä¾¿ï¼Œä½¿å¾—å®ç°æ•°æ®å¤„ç†çš„ä»£ç éå¸¸ç®€çŸ­é«˜æ•ˆã€‚è¿™äº›æˆ‘ä»¬ä¼šåœ¨è¿™ä¸€æ¨¡å—ä¸­çš„åç»­æ–‡ç« ä¸­ä»”ç»†é˜è¿°ã€‚</p><p>Sparkæä¾›äº†å¾ˆå¤šå¯¹RDDçš„æ“ä½œï¼Œå¦‚Mapã€Filterã€flatMapã€groupByKeyå’ŒUnionç­‰ç­‰ï¼Œæå¤§åœ°æå‡äº†å¯¹å„ç§å¤æ‚åœºæ™¯çš„æ”¯æŒã€‚å¼€å‘è€…æ—¢ä¸ç”¨å†ç»å°½è„‘æ±æŒ–æ˜MapReduceæ¨¡å‹çš„æ½œåŠ›ï¼Œä¹Ÿä¸ç”¨ç»´æŠ¤å¤æ‚çš„MapReduceçŠ¶æ€æœºã€‚</p><p>ç›¸å¯¹äºHadoopçš„MapReduceä¼šå°†ä¸­é—´æ•°æ®å­˜æ”¾åˆ°ç¡¬ç›˜ä¸­ï¼ŒSparkä¼šæŠŠä¸­é—´æ•°æ®ç¼“å­˜åœ¨å†…å­˜ä¸­ï¼Œä»è€Œå‡å°‘äº†å¾ˆå¤šç”±äºç¡¬ç›˜è¯»å†™è€Œå¯¼è‡´çš„å»¶è¿Ÿï¼Œå¤§å¤§åŠ å¿«äº†å¤„ç†é€Ÿåº¦ã€‚</p><p>Databrickså›¢é˜Ÿæ›¾ç»åšè¿‡ä¸€ä¸ªå®éªŒï¼Œä»–ä»¬ç”¨Sparkæ’åºä¸€ä¸ª100TBçš„é™æ€æ•°æ®é›†ä»…ä»…ç”¨æ—¶23åˆ†é’Ÿã€‚è€Œä¹‹å‰ç”¨Hadoopåšåˆ°çš„æœ€å¿«è®°å½•ä¹Ÿç”¨äº†é«˜è¾¾72åˆ†é’Ÿã€‚æ­¤å¤–ï¼ŒSparkè¿˜åªç”¨äº†Hadoopæ‰€ç”¨çš„è®¡ç®—èµ„æºçš„1/10ï¼Œè€—æ—¶åªæœ‰Hadoopçš„1/3ã€‚</p><p>è¿™ä¸ªä¾‹å­å……åˆ†ä½“ç°å‡ºSparkæ•°æ®å¤„ç†çš„æœ€å¤§ä¼˜åŠ¿â€”â€”é€Ÿåº¦ã€‚</p><p>åœ¨æŸäº›éœ€è¦äº¤äº’å¼æŸ¥è¯¢å†…å­˜æ•°æ®çš„åœºæ™¯ä¸­ï¼ŒSparkçš„æ€§èƒ½ä¼˜åŠ¿æ›´åŠ æ˜æ˜¾ã€‚</p><p>æ ¹æ®Databrickså›¢é˜Ÿçš„ç»“æœæ˜¾ç¤ºï¼ŒSparkçš„å¤„ç†é€Ÿåº¦æ˜¯Hadoopçš„100å€ã€‚å³ä½¿æ˜¯å¯¹ç¡¬ç›˜ä¸Šçš„æ•°æ®è¿›è¡Œå¤„ç†ï¼ŒSparkçš„æ€§èƒ½ä¹Ÿè¾¾åˆ°äº†Hadoopçš„10å€ã€‚</p><p>ç”±äºSparkå¯ä»¥æŠŠè¿­ä»£è¿‡ç¨‹ä¸­æ¯ä¸€æ­¥çš„è®¡ç®—ç»“æœéƒ½ç¼“å­˜åœ¨å†…å­˜ä¸­ï¼Œæ‰€ä»¥éå¸¸é€‚ç”¨äºå„ç±»è¿­ä»£ç®—æ³•ã€‚</p><p>Sparkç¬¬ä¸€æ¬¡å¯åŠ¨æ—¶éœ€è¦æŠŠæ•°æ®è½½å…¥åˆ°å†…å­˜ï¼Œä¹‹åçš„è¿­ä»£å¯ä»¥ç›´æ¥åœ¨å†…å­˜é‡Œåˆ©ç”¨ä¸­é—´ç»“æœåšä¸è½åœ°çš„è¿ç®—ã€‚æ‰€ä»¥ï¼ŒåæœŸçš„è¿­ä»£é€Ÿåº¦å¿«åˆ°å¯ä»¥å¿½ç•¥ä¸è®¡ã€‚åœ¨å½“ä»Šæœºå™¨å­¦ä¹ å’Œäººå·¥æ™ºèƒ½å¤§çƒ­çš„ç¯å¢ƒä¸‹ï¼ŒSparkæ— ç–‘æ˜¯æ›´å¥½çš„æ•°æ®å¤„ç†å¼•æ“ã€‚</p><p>ä¸‹å›¾æ˜¯åœ¨Sparkå’ŒHadoopä¸Šè¿è¡Œé€»è¾‘å›å½’ç®—æ³•çš„è¿è¡Œæ—¶é—´å¯¹æ¯”ã€‚</p><p><img src=\"https://static001.geekbang.org/resource/image/54/3d/54e4df946206a4a2168a25af8814843d.png?wh=5083*3500\" alt=\"\"></p><p>å¯ä»¥çœ‹å‡ºï¼ŒHadoopåšæ¯ä¸€æ¬¡è¿­ä»£è¿ç®—çš„æ—¶é—´åŸºæœ¬ç›¸åŒï¼Œè€ŒSparké™¤äº†ç¬¬ä¸€æ¬¡è½½å…¥æ•°æ®åˆ°å†…å­˜ä»¥å¤–ï¼Œåˆ«çš„è¿­ä»£æ—¶é—´åŸºæœ¬å¯ä»¥å¿½ç•¥ã€‚</p><p>åœ¨ä»»åŠ¡ï¼ˆtaskï¼‰çº§åˆ«ä¸Šï¼ŒSparkçš„å¹¶è¡Œæœºåˆ¶æ˜¯å¤šçº¿ç¨‹æ¨¡å‹ï¼Œè€ŒMapReduceæ˜¯å¤šè¿›ç¨‹æ¨¡å‹ã€‚</p><p>å¤šè¿›ç¨‹æ¨¡å‹ä¾¿äºç»†ç²’åº¦æ§åˆ¶æ¯ä¸ªä»»åŠ¡å ç”¨çš„èµ„æºï¼Œä½†ä¼šæ¶ˆè€—è¾ƒå¤šçš„å¯åŠ¨æ—¶é—´ã€‚</p><p>è€ŒSparkåŒä¸€èŠ‚ç‚¹ä¸Šçš„ä»»åŠ¡ä»¥å¤šçº¿ç¨‹çš„æ–¹å¼è¿è¡Œåœ¨ä¸€ä¸ªJVMè¿›ç¨‹ä¸­ï¼Œå¯ä»¥å¸¦æ¥æ›´å¿«çš„å¯åŠ¨é€Ÿåº¦ã€æ›´é«˜çš„CPUåˆ©ç”¨ç‡ï¼Œä»¥åŠæ›´å¥½çš„å†…å­˜å…±äº«ã€‚</p><p>ä»å‰æ–‡ä¸­ä½ å¯ä»¥çœ‹å‡ºï¼ŒSparkä½œä¸ºæ–°çš„åˆ†å¸ƒå¼æ•°æ®å¤„ç†å¼•æ“ï¼Œå¯¹MapReduceè¿›è¡Œäº†å¾ˆå¤šæ”¹è¿›ï¼Œä½¿å¾—æ€§èƒ½å¤§å¤§æå‡ï¼Œå¹¶ä¸”æ›´åŠ é€‚ç”¨äºæ–°æ—¶ä»£çš„æ•°æ®å¤„ç†åœºæ™¯ã€‚</p><p>ä½†æ˜¯ï¼ŒSparkå¹¶ä¸æ˜¯ä¸€ä¸ªå®Œå…¨æ›¿ä»£Hadoopçš„å…¨æ–°å·¥å…·ã€‚</p><p>å› ä¸ºHadoopè¿˜åŒ…å«äº†å¾ˆå¤šç»„ä»¶ï¼š</p><ul>\n<li>æ•°æ®å­˜å‚¨å±‚ï¼šåˆ†å¸ƒå¼æ–‡ä»¶å­˜å‚¨ç³»ç»ŸHDFSï¼Œåˆ†å¸ƒå¼æ•°æ®åº“å­˜å‚¨çš„HBaseï¼›</li>\n<li>æ•°æ®å¤„ç†å±‚ï¼šè¿›è¡Œæ•°æ®å¤„ç†çš„MapReduceï¼Œè´Ÿè´£é›†ç¾¤å’Œèµ„æºç®¡ç†çš„YARNï¼›</li>\n<li>æ•°æ®è®¿é—®å±‚ï¼šHiveã€Pigã€Mahoutâ€¦â€¦</li>\n</ul><p>ä»ç‹­ä¹‰ä¸Šæ¥çœ‹ï¼ŒSparkåªæ˜¯MapReduceçš„æ›¿ä»£æ–¹æ¡ˆï¼Œå¤§éƒ¨åˆ†åº”ç”¨åœºæ™¯ä¸­ï¼Œå®ƒè¿˜è¦ä¾èµ–äºHDFSå’ŒHBaseæ¥å­˜å‚¨æ•°æ®ï¼Œä¾èµ–äºYARNæ¥ç®¡ç†é›†ç¾¤å’Œèµ„æºã€‚</p><p>å½“ç„¶ï¼ŒSparkå¹¶ä¸æ˜¯ä¸€å®šè¦ä¾é™„äºHadoopæ‰èƒ½ç”Ÿå­˜ï¼Œå®ƒè¿˜å¯ä»¥è¿è¡Œåœ¨Apache Mesosã€Kubernetesã€standaloneç­‰å…¶ä»–äº‘å¹³å°ä¸Šã€‚</p><p><img src=\"https://static001.geekbang.org/resource/image/bc/0c/bc01239280bb853ca1d00c0fb3a8150c.jpg?wh=3604*2329\" alt=\"\"></p><p>æ­¤å¤–ï¼Œä½œä¸ºé€šç”¨çš„æ•°æ®å¤„ç†å¹³å°ï¼ŒSparkæœ‰äº”ä¸ªä¸»è¦çš„æ‰©å±•åº“ï¼Œåˆ†åˆ«æ˜¯æ”¯æŒç»“æ„åŒ–æ•°æ®çš„Spark SQLã€å¤„ç†å®æ—¶æ•°æ®çš„Spark Streamingã€ç”¨äºæœºå™¨å­¦ä¹ çš„MLlibã€ç”¨äºå›¾è®¡ç®—çš„GraphXã€ç”¨äºç»Ÿè®¡åˆ†æçš„SparkRã€‚</p><p>è¿™äº›æ‰©å±•åº“ä¸Sparkæ ¸å¿ƒAPIé«˜åº¦æ•´åˆåœ¨ä¸€èµ·ï¼Œä½¿å¾—Sparkå¹³å°å¯ä»¥å¹¿æ³›åœ°åº”ç”¨åœ¨ä¸åŒæ•°æ®å¤„ç†åœºæ™¯ä¸­ã€‚</p><h2>å°ç»“</h2><p>é€šè¿‡ä»Šå¤©çš„å­¦ä¹ ï¼Œæˆ‘ä»¬äº†è§£äº†Sparkç›¸è¾ƒäºMapReduceçš„ä¸»è¦ä¼˜åŠ¿ï¼Œé‚£å°±æ˜¯å¿«ã€æ˜“äºå¼€å‘åŠç»´æŠ¤ï¼Œå’Œæ›´é«˜çš„é€‚ç”¨æ€§ã€‚æˆ‘ä»¬è¿˜åˆæ­¥æŒæ¡äº†Sparkç³»ç»Ÿçš„æ¶æ„ã€‚</p><p>MapReduceä½œä¸ºåˆ†å¸ƒå¼æ•°æ®å¤„ç†çš„å¼€å±±é¼»ç¥–ï¼Œè™½ç„¶æœ‰å¾ˆå¤šç¼ºé™·ï¼Œä½†æ˜¯å®ƒçš„è®¾è®¡æ€æƒ³ä¸ä»…æ²¡æœ‰è¿‡æ—¶ï¼Œè€Œä¸”è¿˜å½±å“äº†æ–°çš„æ•°æ®å¤„ç†ç³»ç»Ÿçš„è®¾è®¡ï¼Œå¦‚Sparkã€Stormã€Prestoã€Impalaç­‰ã€‚</p><p>Sparkå¹¶æ²¡æœ‰å…¨æ–°çš„ç†è®ºåŸºç¡€ï¼Œå®ƒæ˜¯ä¸€ç‚¹ç‚¹åœ°åœ¨å·¥ç¨‹å’Œå­¦æœ¯çš„ç»“åˆåŸºç¡€ä¸Šåšå‡ºæ¥çš„ã€‚å¯ä»¥è¯´ï¼Œå®ƒç«™åœ¨äº†Hadoopå’ŒMapReduceä¸¤ä¸ªå·¨äººçš„è‚©è†€ä¸Šã€‚åœ¨è¿™ä¸€æ¨¡å—ä¸­ï¼Œæˆ‘ä»¬ä¼šå¯¹Sparkçš„æ¶æ„ã€æ ¸å¿ƒæ¦‚å¿µã€APIä»¥åŠå„ä¸ªæ‰©å±•åº“è¿›è¡Œæ·±å…¥çš„è®¨è®ºï¼Œå¹¶ä¸”ç»“åˆå¸¸è§çš„åº”ç”¨ä¾‹å­è¿›è¡Œå®æˆ˜æ¼”ç»ƒï¼Œä»è€Œå¸®åŠ©ä½ å½»åº•æŒæ¡è¿™ä¸€å½“ä»Šæœ€æµè¡Œçš„æ•°æ®å¤„ç†å¹³å°ã€‚</p><h2>æ€è€ƒé¢˜</h2><p>ä½ è®¤ä¸ºæœ‰å“ªäº›MapReduceçš„ç¼ºç‚¹æ˜¯åœ¨Sparkæ¡†æ¶ä¸­ä¾ç„¶å­˜åœ¨çš„ï¼Ÿç”¨ä»€ä¹ˆæ€è·¯å¯ä»¥è§£å†³ï¼Ÿ</p><p>æ¬¢è¿ä½ æŠŠç­”æ¡ˆå†™åœ¨ç•™è¨€åŒºï¼Œä¸æˆ‘å’Œå…¶ä»–åŒå­¦ä¸€èµ·è®¨è®ºã€‚</p><p>å¦‚æœä½ è§‰å¾—æœ‰æ‰€æ”¶è·ï¼Œä¹Ÿæ¬¢è¿æŠŠæ–‡ç« åˆ†äº«ç»™ä½ çš„æœ‹å‹ã€‚</p><p></p>","comments":[{"had_liked":false,"id":94001,"user_name":"jon","can_delete":false,"product_type":"c1","uid":1253287,"ip_address":"","ucode":"5768A34E292CAA","user_header":"https://static001.geekbang.org/account/avatar/00/13/1f/a7/d379ca4f.jpg","comment_is_top":false,"comment_ctime":1557704922,"is_pvip":false,"replies":[{"id":"48503","content":"è¿™ä½åŒå­¦çš„ç†è§£å¾ˆå¯¹ï¼","user_name":"ä½œè€…å›å¤","user_name_real":"Xinyue Li","uid":"1502409","ctime":1567384701,"ip_address":"","comment_id":94001,"utype":1}],"discussion_count":1,"race_medal":0,"score":"173356396762","product_id":100025301,"comment_content":"mrç¼–ç¨‹æ¨¡å‹å•ä¸€ï¼Œç»´æŠ¤æˆæœ¬é«˜ï¼Œå¤šä¸ªjobæ‰§è¡Œæ—¶æ¯ä¸ªéƒ½è¦æ•°æ®è½ç›˜ã€‚è€Œsparkæ‹¥æœ‰æ›´é«˜çš„æŠ½è±¡çº§åˆ«rddï¼Œä¸€æ¬¡è¯»å–æ•°æ®åä¾¿å¯åœ¨å†…å­˜ä¸­è¿›è¡Œå¤šæ­¥è¿­ä»£è®¡ç®—ï¼Œå¯¹rddçš„è®¡ç®—æ˜¯å¤šçº¿ç¨‹å¹¶å‘çš„æ‰€æœ‰å¾ˆé«˜æ•ˆã€‚<br>ä½†æ˜¯sparkä¾ç„¶ä¼šå­˜åœ¨æ•°æ®å€¾æ–œçš„æƒ…å†µï¼Œåœ¨shuffleæ—¶æœ‰å¯èƒ½å¯¼è‡´ä¸€ä¸ªæˆä¸ºæ•°æ®çƒ­ç‚¹çš„æƒ…å†µ","like_count":41,"discussions":[{"author":{"id":1502409,"avatar":"https://static001.geekbang.org/account/avatar/00/16/ec/c9/45bfcba3.jpg","nickname":"Xinyue Li","note":"","ucode":"0CB92610C8B9FC","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":449864,"discussion_content":"è¿™ä½åŒå­¦çš„ç†è§£å¾ˆå¯¹ï¼","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1567384701,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":1}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":94223,"user_name":"æœ±åŒå­¦","can_delete":false,"product_type":"c1","uid":1514233,"ip_address":"","ucode":"2EF7D5A051712C","user_header":"https://static001.geekbang.org/account/avatar/00/17/1a/f9/180f347a.jpg","comment_is_top":false,"comment_ctime":1557747897,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"121816832185","product_id":100025301,"comment_content":"ä¼¼ä¹æ•°æ®å€¾æ–œæ˜¯æ‰€æœ‰åˆ†å¸ƒå¼è®¡ç®—å¼•æ“çš„é€šç—…","like_count":29},{"had_liked":false,"id":94045,"user_name":"JohnT3e","can_delete":false,"product_type":"c1","uid":1063982,"ip_address":"","ucode":"CF4AAAC933529C","user_header":"http://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTLdWHFCr66TzHS2CpCkiaRaDIk3tU5sKPry16Q7ic0mZZdy8LOCYc38wOmyv5RZico7icBVeaPX8X2jcw/132","comment_is_top":false,"comment_ctime":1557709500,"is_pvip":false,"replies":[{"id":"48510","content":"è¯´çš„å¾ˆå¥½ï¼","user_name":"ä½œè€…å›å¤","user_name_real":"Xinyue Li","uid":"1502409","ctime":1567386011,"ip_address":"","comment_id":94045,"utype":1}],"discussion_count":1,"race_medal":0,"score":"78867120828","product_id":100025301,"comment_content":"1. sparkæœ¬è´¨ä¸Šè¿˜æ˜¯æ‰¹å¤„ç†ï¼Œåªæ˜¯é€šè¿‡å¾®æ‰¹å¤„ç†æ¥å®ç°è¿‘å®æ—¶å¤„ç†ã€‚å¦‚æœéœ€è¦å®æ—¶å¤„ç†ï¼Œå¯ä»¥ä½¿ç”¨apache flinkï¼›<br>2. å°æ–‡ä»¶å¤„ç†ä¾ç„¶æœ‰æ€§èƒ½é—®é¢˜ï¼›<br>3. ä»éœ€è¦æ‰‹åŠ¨è°ƒä¼˜ï¼Œæ¯”å¦‚å¦‚ä½•è®©æ•°æ®åˆç†åˆ†åŒºï¼Œæ¥é¿å…æˆ–è€…å‡è½»æ•°æ®å€¾æ–œ","like_count":19,"discussions":[{"author":{"id":1502409,"avatar":"https://static001.geekbang.org/account/avatar/00/16/ec/c9/45bfcba3.jpg","nickname":"Xinyue Li","note":"","ucode":"0CB92610C8B9FC","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":449888,"discussion_content":"è¯´çš„å¾ˆå¥½ï¼","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1567386011,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":1}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":94088,"user_name":"aof","can_delete":false,"product_type":"c1","uid":1062864,"ip_address":"","ucode":"5815D63C4926BC","user_header":"https://static001.geekbang.org/account/avatar/00/10/37/d0/26975fba.jpg","comment_is_top":false,"comment_ctime":1557717111,"is_pvip":false,"replies":[{"id":"48525","content":"å¾ˆå¥½çš„æ€»ç»“","user_name":"ä½œè€…å›å¤","user_name_real":"Xinyue Li","uid":"1502409","ctime":1567389479,"ip_address":"","comment_id":94088,"utype":1}],"discussion_count":1,"race_medal":0,"score":"57392291959","product_id":100025301,"comment_content":"Sparkå’ŒMRçš„ä¸¤ä¸ªåŒºåˆ«ï¼š<br>1. MapReduceç¼–ç¨‹æ¨¡å‹ä¸­ï¼Œæ¯ä¸€å¯¹mapå’Œreduceéƒ½ä¼šç”Ÿæˆä¸€ä¸ªjobï¼Œè€Œä¸”æ¯ä¸€æ¬¡éƒ½æ˜¯å†™ç£ç›˜ï¼Œè¿™å°±é€ æˆè€å¸ˆæ‰€è¯´çš„å¯åŠ¨æ—¶é—´å˜é•¿ï¼Œè€Œä¸”ç»´æŠ¤èµ·æ¥æ¯”è¾ƒå¤æ‚ï¼›è€ŒSparkæ˜¯é“¾å¼è®¡ç®—ï¼Œåƒmapã€flatmapã€filterç­‰transformationç®—å­æ˜¯ä¸ä¼šè§¦å‘è®¡ç®—çš„ï¼Œåªæœ‰åœ¨é‡åˆ°åƒcountã€collectã€saveAsTableç­‰Actionç®—å­æ—¶ï¼Œæ‰ä¼šçœŸæ­£è§¦å‘ä¸€æ¬¡è®¡ç®—ï¼Œå¯¹åº”ä¼šç”Ÿæˆä¸€ä¸ªjobã€‚<br>2. MapReduceæ¯æ¬¡çš„MRç»“æœéƒ½æ˜¯ä¿å­˜åˆ°ç£ç›˜ï¼Œæ‰€ä»¥æ—¶é—´å¼€é”€å¤§ï¼›è€ŒSparkåœ¨æ‰§è¡Œåº”ç”¨ç¨‹åºæ˜¯ï¼Œä¸­é—´çš„å¤„ç†è¿‡ç¨‹ã€æ•°æ®(RDD)çš„ç¼“å­˜å’Œshuffleæ“ä½œç­‰éƒ½æ˜¯åœ¨å†…å­˜å…è®¸çš„æƒ…å†µä¸‹ï¼Œæ”¾åœ¨å†…å­˜ä¸­çš„ï¼Œæ‰€ä»¥è€—æ—¶çŸ­ã€‚","like_count":14,"discussions":[{"author":{"id":1502409,"avatar":"https://static001.geekbang.org/account/avatar/00/16/ec/c9/45bfcba3.jpg","nickname":"Xinyue Li","note":"","ucode":"0CB92610C8B9FC","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":449909,"discussion_content":"å¾ˆå¥½çš„æ€»ç»“","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1567389479,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":1}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":94053,"user_name":"é”¦","can_delete":false,"product_type":"c1","uid":1468298,"ip_address":"","ucode":"CB0EB4B68C468B","user_header":"https://static001.geekbang.org/account/avatar/00/16/67/8a/babd74dc.jpg","comment_is_top":false,"comment_ctime":1557710658,"is_pvip":false,"replies":[{"id":"48524","content":"çœ‹è¿‡åè¾¹è®²Sparkæµå¤„ç†çš„ç« èŠ‚å°±æ˜ç™½äº†ï¼ŒStormçš„ä¼˜åŠ¿æ˜¯çº¯å®æ—¶å¤„ç†ï¼Œå»¶è¿Ÿå¯ä»¥åˆ°æ¯«ç§’çº§ï¼Œæ‰€ä»¥è¯•ç”¨äºéœ€è¦ä½å»¶è¿Ÿçš„å®æ—¶åœºæ™¯ã€‚æˆ‘è®¤ä¸ºSparkåœ¨çº¯æµå¤„ç†ä¸Šå”¯ä¸€çš„ä¼˜åŠ¿æ˜¯ååé‡è¦é«˜ã€‚ä½†æ˜¯è€ƒè™‘ä½¿ç”¨Spark Streamingæœ€ä¸»è¦çš„ä¸€ä¸ªå› ç´ ï¼Œåº”è¯¥æ˜¯é’ˆå¯¹æ•´ä¸ªé¡¹ç›®è¿›è¡Œå®è§‚çš„è€ƒè™‘ï¼Œå³ï¼Œå¦‚æœä¸€ä¸ªé¡¹ç›®é™¤äº†å®æ—¶è®¡ç®—ä¹‹å¤–ï¼Œè¿˜åŒ…æ‹¬äº†ç¦»çº¿æ‰¹å¤„ç†ã€äº¤äº’å¼æŸ¥è¯¢ç­‰ä¸šåŠ¡åŠŸèƒ½ï¼Œè€Œä¸”å®æ—¶è®¡ç®—ä¸­ï¼Œå¯èƒ½è¿˜ä¼šç‰µæ‰¯åˆ°é«˜å»¶è¿Ÿæ‰¹å¤„ç†ã€äº¤äº’å¼æŸ¥è¯¢ç­‰åŠŸèƒ½ï¼Œé‚£ä¹ˆå°±åº”è¯¥é¦–é€‰Sparkç”Ÿæ€ï¼Œç”¨Spark Coreå¼€å‘ç¦»çº¿æ‰¹å¤„ç†ï¼Œç”¨Spark SQLå¼€å‘äº¤äº’å¼æŸ¥è¯¢ï¼Œç”¨Spark Streamingå¼€å‘å®æ—¶è®¡ç®—ï¼Œä¸‰è€…å¯ä»¥æ— ç¼æ•´åˆï¼Œç»™ç³»ç»Ÿæä¾›éå¸¸é«˜çš„å¯æ‰©å±•æ€§","user_name":"ä½œè€…å›å¤","user_name_real":"Xinyue Li","uid":"1502409","ctime":1567389295,"ip_address":"","comment_id":94053,"utype":1}],"discussion_count":1,"race_medal":0,"score":"40212416322","product_id":100025301,"comment_content":"Sparkæ˜¯åœ¨MapReduceçš„åŸºç¡€ä¸Šä¸€ç‚¹ç‚¹é€šè¿‡å·¥ç¨‹å’Œå­¦æœ¯ç›¸ç»“åˆåšå‡ºæ¥çš„ï¼Œé‚£ä¹ˆæ˜¯ä¸æ˜¯æ„å‘³ç€èƒŒåçš„ç†è®ºæ¨¡å‹éƒ½æ˜¯åˆ†æ²»æ€æƒ³ï¼Ÿ<br>ç›¸å¯¹äºMapReduceå¤šè¿›ç¨‹æ¨¡å‹æ¥è¯´ï¼ŒSparkåŸºäºå¤šçº¿ç¨‹æ¨¡å‹ï¼Œå¯åŠ¨é€Ÿåº¦æ›´å¿«ï¼ŒCpuåˆ©ç”¨ç‡æ›´å¥½å’Œå†…å­˜å…±äº«æ›´å¥½ã€‚<br>MapReduceåªæä¾›Mapå’ŒReduceæ“ä½œï¼Œè€ŒSparkä¸­æœ€åŸºæœ¬çš„å¼¹æ€§åˆ†å¸ƒå¼æ•°æ®ç»“æ„RDDï¼Œæä¾›ä¸°å¯Œçš„Apiï¼Œå¯¹æœºå™¨å­¦ä¹ ï¼Œäººå·¥æ™ºèƒ½æ›´å‹å¥½ï¼Œæ›´é€‚ç”¨äºç°ä»£æ•°æ®å¤„ç†åœºæ™¯ã€‚<br>MapReduceè®¡ç®—åçš„ä¸­é—´æ•°æ®éœ€è¦è½ç›˜ï¼Œè€ŒSparkçš„ä¸­é—´æ•°æ®ç¼“å­˜åœ¨å†…å­˜ä¸­ç”¨äºåç»­è¿­ä»£ï¼Œé€Ÿåº¦æ›´å¿«ã€‚<br>ç–‘é—®:Sparkç›¸å¯¹äºStormåœ¨æµè®¡ç®—ä¸­æœ‰å“ªäº›ä¼˜åŠ¿å‘¢ï¼Ÿ","like_count":10,"discussions":[{"author":{"id":1502409,"avatar":"https://static001.geekbang.org/account/avatar/00/16/ec/c9/45bfcba3.jpg","nickname":"Xinyue Li","note":"","ucode":"0CB92610C8B9FC","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":449894,"discussion_content":"çœ‹è¿‡åè¾¹è®²Sparkæµå¤„ç†çš„ç« èŠ‚å°±æ˜ç™½äº†ï¼ŒStormçš„ä¼˜åŠ¿æ˜¯çº¯å®æ—¶å¤„ç†ï¼Œå»¶è¿Ÿå¯ä»¥åˆ°æ¯«ç§’çº§ï¼Œæ‰€ä»¥è¯•ç”¨äºéœ€è¦ä½å»¶è¿Ÿçš„å®æ—¶åœºæ™¯ã€‚æˆ‘è®¤ä¸ºSparkåœ¨çº¯æµå¤„ç†ä¸Šå”¯ä¸€çš„ä¼˜åŠ¿æ˜¯ååé‡è¦é«˜ã€‚ä½†æ˜¯è€ƒè™‘ä½¿ç”¨Spark Streamingæœ€ä¸»è¦çš„ä¸€ä¸ªå› ç´ ï¼Œåº”è¯¥æ˜¯é’ˆå¯¹æ•´ä¸ªé¡¹ç›®è¿›è¡Œå®è§‚çš„è€ƒè™‘ï¼Œå³ï¼Œå¦‚æœä¸€ä¸ªé¡¹ç›®é™¤äº†å®æ—¶è®¡ç®—ä¹‹å¤–ï¼Œè¿˜åŒ…æ‹¬äº†ç¦»çº¿æ‰¹å¤„ç†ã€äº¤äº’å¼æŸ¥è¯¢ç­‰ä¸šåŠ¡åŠŸèƒ½ï¼Œè€Œä¸”å®æ—¶è®¡ç®—ä¸­ï¼Œå¯èƒ½è¿˜ä¼šç‰µæ‰¯åˆ°é«˜å»¶è¿Ÿæ‰¹å¤„ç†ã€äº¤äº’å¼æŸ¥è¯¢ç­‰åŠŸèƒ½ï¼Œé‚£ä¹ˆå°±åº”è¯¥é¦–é€‰Sparkç”Ÿæ€ï¼Œç”¨Spark Coreå¼€å‘ç¦»çº¿æ‰¹å¤„ç†ï¼Œç”¨Spark SQLå¼€å‘äº¤äº’å¼æŸ¥è¯¢ï¼Œç”¨Spark Streamingå¼€å‘å®æ—¶è®¡ç®—ï¼Œä¸‰è€…å¯ä»¥æ— ç¼æ•´åˆï¼Œç»™ç³»ç»Ÿæä¾›éå¸¸é«˜çš„å¯æ‰©å±•æ€§","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1567389295,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":1}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":94038,"user_name":"è’™å¼€å¼º","can_delete":false,"product_type":"c1","uid":1317706,"ip_address":"","ucode":"61B3183781B9F7","user_header":"https://static001.geekbang.org/account/avatar/00/14/1b/4a/f9df2d06.jpg","comment_is_top":false,"comment_ctime":1557709173,"is_pvip":false,"replies":[{"id":"48518","content":"Mapå’ŒReudceçš„Taskéƒ½æ˜¯è¿›ç¨‹çº§åˆ«çš„ï¼Œè¿™ä¹Ÿæ˜¯MapReduceå¹¿ä¸ºäººè¯Ÿç—…çš„åŸå› ","user_name":"ä½œè€…å›å¤","user_name_real":"Xinyue Li","uid":"1502409","ctime":1567386991,"ip_address":"","comment_id":94038,"utype":1}],"discussion_count":2,"race_medal":0,"score":"35917447541","product_id":100025301,"comment_content":"è€å¸ˆï¼Œä½ å¥½ï¼Œæˆ‘çœ‹ä½ ä¸“æ é‡Œè¯´åˆ°ï¼ŒMapReduce æ˜¯å¤šè¿›ç¨‹æ¨¡å‹ã€‚æˆ‘æœ‰ç‚¹ç–‘æƒ‘ï¼ŒMapReduceçš„mapé˜¶æ®µå’Œreduceé˜¶æ®µéƒ½æœ‰å¹¶è¡Œtaskè¿›è¡Œè¿è¡Œï¼Œå®ƒä»¬çš„taskä¸æ˜¯çº¿ç¨‹çº§åˆ«ä¹ˆã€‚","like_count":8,"discussions":[{"author":{"id":1502409,"avatar":"https://static001.geekbang.org/account/avatar/00/16/ec/c9/45bfcba3.jpg","nickname":"Xinyue Li","note":"","ucode":"0CB92610C8B9FC","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":449883,"discussion_content":"Mapå’ŒReudceçš„Taskéƒ½æ˜¯è¿›ç¨‹çº§åˆ«çš„ï¼Œè¿™ä¹Ÿæ˜¯MapReduceå¹¿ä¸ºäººè¯Ÿç—…çš„åŸå› ","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1567386991,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":1}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1134022,"avatar":"https://static001.geekbang.org/account/avatar/00/11/4d/c6/d4e85081.jpg","nickname":"çº³å…°æ®‹å¾·","note":"","ucode":"2CCEA4539748B4","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":1763,"discussion_content":"æ¯ä¸ªmap reduceéƒ½æ˜¯ä¸€ä¸ªå•ç‹¬çš„jvmï¼Œè€Œä¸” ä¸€ä¸ªmapä»»åŠ¡ç»“æŸ è¿™ä¸ªmapå¯¹åº”çš„jvmä¼šå…³é—­ï¼Œæ–°çš„mapè¦å¼€jvmï¼Œæ‰€ä»¥è¿™æ–¹é¢çš„å¼€é”€ä¹Ÿæ˜¯å¾ˆå½±å“mræ€§èƒ½çš„","likes_number":2,"is_delete":false,"is_hidden":false,"ctime":1562897940,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":94110,"user_name":"æ¥šç¿”style","can_delete":false,"product_type":"c1","uid":1174846,"ip_address":"","ucode":"E715F82C34A9AA","user_header":"https://static001.geekbang.org/account/avatar/00/11/ed/3e/c1725237.jpg","comment_is_top":false,"comment_ctime":1557722675,"is_pvip":false,"discussion_count":2,"race_medal":0,"score":"18737591859","product_id":100025301,"comment_content":"sparkcontextä¸èƒ½åœ¨é›†ç¾¤å…¨å±€å…±äº«ï¼Œæ¯”å¦‚æˆ‘submitäº†100ä¸ªsparkä»»åŠ¡ï¼Œæ¯ä¸ªä»»åŠ¡éƒ½è¦åˆå§‹åŒ–è‡ªå·±çš„scï¼Œè¿˜è¦é”€æ¯ï¼Œæ¯ä¸€æ¬¡çš„åˆ›å»ºé”€æ¯éƒ½å¾ˆè€—æ—¶ã€‚ è¿™å—æœ‰ä»€ä¹ˆç­–ç•¥å¯ä»¥ä¼˜åŒ–ä¸‹å—ï¼Ÿ è°¢è°¢","like_count":5,"discussions":[{"author":{"id":1093120,"avatar":"https://static001.geekbang.org/account/avatar/00/10/ae/00/58ad3a3b.jpg","nickname":"DYK","note":"","ucode":"21BDC80CCFD049","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":291079,"discussion_content":"sparklivy","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1594702388,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":1,"child_discussions":[{"author":{"id":1174846,"avatar":"https://static001.geekbang.org/account/avatar/00/11/ed/3e/c1725237.jpg","nickname":"æ¥šç¿”style","note":"","ucode":"E715F82C34A9AA","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":1093120,"avatar":"https://static001.geekbang.org/account/avatar/00/10/ae/00/58ad3a3b.jpg","nickname":"DYK","note":"","ucode":"21BDC80CCFD049","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":291723,"discussion_content":"\nlivyæˆ‘ç†è§£ä¹Ÿæ˜¯æ¨¡æ‹Ÿsparkï¼submitæäº¤.åªä¸è¿‡æ˜¯ç”¨restæ–¹å¼ï¼Œæœ¬è´¨è¿˜æ˜¯ä¸ªsubmit","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1594917770,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":291079,"ip_address":""},"score":291723,"extra":""}]}]},{"had_liked":false,"id":94049,"user_name":"miwucc","can_delete":false,"product_type":"c1","uid":1326429,"ip_address":"","ucode":"7935BD907119AE","user_header":"https://static001.geekbang.org/account/avatar/00/14/3d/5d/ac666969.jpg","comment_is_top":false,"comment_ctime":1557710254,"is_pvip":false,"replies":[{"id":"48529","content":"ä½ è¯´çš„å¾ˆå¥½ï¼Œè¿™ä¸¤ä¸ªé—®é¢˜éƒ½æ˜¯åˆ†å¸ƒå¼è®¡ç®—çš„ç—›ç‚¹ã€‚ç”¨Sparkçš„RDD APIæ²¡æœ‰è‡ªåŠ¨ä¼˜åŒ–æ•°æ®åˆ†åŒºï¼Œå¾ˆä¾èµ–å¼€å‘è€…æ‰‹åŠ¨è°ƒä¼˜ã€‚åè¾¹è®²åˆ°çš„Spark SQLçš„æ‰§è¡Œå¼•æ“ä¼šæœ‰è¿™æ–¹é¢çš„ä¼˜åŒ–ï¼Œæ€§èƒ½è¦æ˜¾è‘—ä¼˜äºRDDã€‚","user_name":"ä½œè€…å›å¤","user_name_real":"Xinyue Li","uid":"1502409","ctime":1567390669,"ip_address":"","comment_id":94049,"utype":1}],"discussion_count":1,"race_medal":0,"score":"18737579438","product_id":100025301,"comment_content":"æ„Ÿè§‰mapreduceé—ç•™çš„é—®é¢˜è¿˜æœ‰<br>1.æ•°æ®åˆ†ç‰‡åˆ†ä¸å¥½ï¼Œå¯¼è‡´æ•°æ®è¿‡äºé›†ä¸­åœ¨æŸæœºå™¨å¯¼è‡´æ•´ä½“å¤„ç†é€Ÿåº¦æ…¢æˆ–è€…æ— æ³•å¤„ç†é—®é¢˜ã€‚sparkè¿˜æ˜¯å…¨é ä½¿ç”¨è€…çš„åˆ†ç‰‡å‡½æ•°è¿˜æ˜¯è‡ªå·±æœ‰æ–¹æ³•å¯ä»¥åŠ¨æ€è°ƒåº¦ï¼Ÿ<br>2.å¯¹äºå®é™…å¤æ‚ä¸šåŠ¡ä¸­çš„å¤šjobå‰åä¾èµ–ï¼Œä¸ä¸šåŠ¡ç´§å¯†è€¦åˆçš„å¼‚å¸¸æ•æ‰ï¼Œå¤„ç†æœºåˆ¶æ˜¯å¦æœ‰æ›´å¥½çš„è§£å†³æ–¹æ³•ï¼Ÿ","like_count":5,"discussions":[{"author":{"id":1502409,"avatar":"https://static001.geekbang.org/account/avatar/00/16/ec/c9/45bfcba3.jpg","nickname":"Xinyue Li","note":"","ucode":"0CB92610C8B9FC","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":449891,"discussion_content":"ä½ è¯´çš„å¾ˆå¥½ï¼Œè¿™ä¸¤ä¸ªé—®é¢˜éƒ½æ˜¯åˆ†å¸ƒå¼è®¡ç®—çš„ç—›ç‚¹ã€‚ç”¨Sparkçš„RDD APIæ²¡æœ‰è‡ªåŠ¨ä¼˜åŒ–æ•°æ®åˆ†åŒºï¼Œå¾ˆä¾èµ–å¼€å‘è€…æ‰‹åŠ¨è°ƒä¼˜ã€‚åè¾¹è®²åˆ°çš„Spark SQLçš„æ‰§è¡Œå¼•æ“ä¼šæœ‰è¿™æ–¹é¢çš„ä¼˜åŒ–ï¼Œæ€§èƒ½è¦æ˜¾è‘—ä¼˜äºRDDã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1567390669,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":1}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":94623,"user_name":"æ¶µ","can_delete":false,"product_type":"c1","uid":1502742,"ip_address":"","ucode":"BB8575DB13F1E0","user_header":"https://static001.geekbang.org/account/avatar/00/16/ee/16/742956ac.jpg","comment_is_top":false,"comment_ctime":1557867232,"is_pvip":false,"replies":[{"id":"48509","content":"çœ‹è¿‡åè¾¹å‡ è®²ä½ å°±æ˜ç™½äº†ï¼ŒSparkæœ‰Spark Streamingå’ŒStructured Streamingçš„æµå¤„ç†æ¨¡å—ï¼Œæ‰€ä»¥å®ƒå¹¶ä¸æ˜¯åªèƒ½åšæ‰¹é‡å¤„ç†ã€‚","user_name":"ä½œè€…å›å¤","user_name_real":"Xinyue Li","uid":"1502409","ctime":1567385984,"ip_address":"","comment_id":94623,"utype":1}],"discussion_count":1,"race_medal":0,"score":"14442769120","product_id":100025301,"comment_content":"è€å¸ˆè®²åˆ°Hadoopçš„å››ä¸ªç¼ºé™·ï¼Œå‰ä¸‰ä¸ªéƒ½è®²åˆ°äº†Sparkçš„è§£å†³æ–¹æ¡ˆï¼Œæ¯”å¦‚æŠ½è±¡å±‚æ¬¡æ›´åˆç†ï¼Œæ˜“äºä½¿ç”¨ï¼Œå¯ç”¨çš„æ–¹æ³•æ›´å¤šï¼Œä¸é™äºmapå’Œreduceï¼Œè¿˜æœ‰å°†è¿­ä»£çš„è®¡ç®—ç»“æœæ”¾å…¥å†…å­˜ï¼Œæå‡è¿­ä»£è®¡ç®—çš„æ•ˆç‡ï¼Œé™ä½èƒ½è€—ã€‚ä½†æ˜¯æ²¡æœ‰æåˆ°ç¬¬å››ä¸ªåªèƒ½æ‰¹é‡å¤„ç†æ•°æ®çš„é—®é¢˜ã€‚è¿™æ˜¯ä¸æ˜¯Sparkçš„å±€é™?","like_count":4,"discussions":[{"author":{"id":1502409,"avatar":"https://static001.geekbang.org/account/avatar/00/16/ec/c9/45bfcba3.jpg","nickname":"Xinyue Li","note":"","ucode":"0CB92610C8B9FC","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":450143,"discussion_content":"çœ‹è¿‡åè¾¹å‡ è®²ä½ å°±æ˜ç™½äº†ï¼ŒSparkæœ‰Spark Streamingå’ŒStructured Streamingçš„æµå¤„ç†æ¨¡å—ï¼Œæ‰€ä»¥å®ƒå¹¶ä¸æ˜¯åªèƒ½åšæ‰¹é‡å¤„ç†ã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1567385984,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":1}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":94280,"user_name":"æŒ–çŸ¿çš„å°æˆˆ","can_delete":false,"product_type":"c1","uid":1503917,"ip_address":"","ucode":"2078A85139BD5D","user_header":"http://thirdwx.qlogo.cn/mmopen/vi_32/9chAb6SjxFiapSeicsAsGqzziaNlhX9d5aEt8Z0gUNsZJ9dICaDHqAypGvjv4Bx3PryHnj7OFnOXFOp7Ik21CVXEA/132","comment_is_top":false,"comment_ctime":1557758798,"is_pvip":false,"replies":[{"id":"48526","content":"å¾ˆå¥½çš„æ€»ç»“","user_name":"ä½œè€…å›å¤","user_name_real":"Xinyue Li","uid":"1502409","ctime":1567389576,"ip_address":"","comment_id":94280,"utype":1}],"discussion_count":1,"race_medal":0,"score":"14442660686","product_id":100025301,"comment_content":"1. MRã€Sparkéƒ½æœ‰shuffleï¼Œshuffleéš¾å…å‡ºç°æ•°æ®å€¾æ–œ<br>2.æµè®¡ç®—ä¸Šçš„ä¸è¶³ï¼šMRå°±ä¸è¯´äº†ï¼ŒSparkStreamingåªèƒ½ç®—å¾®æ‰¹å¤„ç†ï¼Œå°½ç®¡Sparkçš„StructStreamingå·²ç»åœ¨è¿™æ–¹é¢åšäº†æ”¹è¿›ï¼Œä½†æ˜¯æ€æƒ³è²Œä¼¼æ— æ³•æ”¹å˜ï¼Œsparkå°±æ˜¯ä»¥æ‰¹å¤„ç†çš„æ€æƒ³æ¥å¤„ç†æµæ•°æ®ï¼Œè¿™æ–¹é¢æ„Ÿè§‰æ²¡æ³•è·Ÿflinkæ¯”ï¼Œä¸è¿‡äº¤äº’å¼æŸ¥è¯¢ã€MLä»¥åŠç”Ÿæ€ä¸Šä¼šæ¯”flinkå¼º","like_count":4,"discussions":[{"author":{"id":1502409,"avatar":"https://static001.geekbang.org/account/avatar/00/16/ec/c9/45bfcba3.jpg","nickname":"Xinyue Li","note":"","ucode":"0CB92610C8B9FC","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":449997,"discussion_content":"å¾ˆå¥½çš„æ€»ç»“","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1567389576,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":1}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":101919,"user_name":"ç…å‰‘","can_delete":false,"product_type":"c1","uid":1504220,"ip_address":"","ucode":"4290D5C140F80F","user_header":"https://static001.geekbang.org/account/avatar/00/16/f3/dc/80b0cd23.jpg","comment_is_top":false,"comment_ctime":1560052269,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"10149986861","product_id":100025301,"comment_content":"Sparkåœ¨Shuffleé˜¶æ®µä¾ç„¶æœ‰å¯èƒ½äº§ç”Ÿå¤§é‡çš„å°æ–‡ä»¶ï¼Œå¤§é‡çš„éšæœºè¯»å†™é€ æˆç£ç›˜IOæ€§èƒ½ä¸‹é™ï¼Œ","like_count":3},{"had_liked":false,"id":94496,"user_name":"æ¨å®¶è£","can_delete":false,"product_type":"c1","uid":1259241,"ip_address":"","ucode":"3DA65396C7F002","user_header":"http://thirdwx.qlogo.cn/mmopen/vi_32/g1icQRbcv1QvJ5U8Cqk0ZqMH5PcMTXcZ8TpS5utE4SUzHcnJA3FYGelHykpzTfDh55ehE8JO9Zg9VGSJW7Wxibxw/132","comment_is_top":false,"comment_ctime":1557824832,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"10147759424","product_id":100025301,"comment_content":"æ€»ç”¨scala å†™spring cloudé¡¹ç›®ï¼Œå±äºæ€é¸¡ç”¨ç‰›åˆ€å—ï¼Ÿ","like_count":2},{"had_liked":false,"id":94123,"user_name":"ä¹¾é¹","can_delete":false,"product_type":"c1","uid":1046236,"ip_address":"","ucode":"D089EDA4ED8C1C","user_header":"https://static001.geekbang.org/account/avatar/00/0f/f6/dc/710a2cc7.jpg","comment_is_top":false,"comment_ctime":1557725175,"is_pvip":true,"replies":[{"id":"48506","content":"ç›¸ä¿¡ä½ çœ‹å®Œ21è®²åº”è¯¥å°±çŸ¥é“äº†ï¼ŒFlinkåœ¨æµå¤„ç†ä¸Šæœ‰å¤©ç„¶çš„ä¼˜åŠ¿ï¼Œè€ŒSparkè™½ç„¶æœ‰å„ç§æµå¤„ç†çš„æ¨¡å—ï¼Œä½†è¿˜æ˜¯åšæ‰¹å¤„ç†æ¯”è¾ƒæ“…é•¿ã€‚çœ‹å®Œ21è®²ä¸­Sparkå’ŒFlinkçš„å¯¹æ¯”ä¹‹åç›¸ä¿¡ä½ å¯ä»¥åšå‡ºé€‰æ‹©","user_name":"ä½œè€…å›å¤","user_name_real":"Xinyue Li","uid":"1502409","ctime":1567385716,"ip_address":"","comment_id":94123,"utype":1}],"discussion_count":1,"race_medal":0,"score":"10147659767","product_id":100025301,"comment_content":"sparkå’Œflinkï¼Œè¿™ä¸¤ä¸ªéƒ½æ˜¯åˆ†å¸ƒå¼æ•°æ®å¤„ç†æ¡†æ¶ï¼Œé¡¹ç›®ä¸­åº”è¯¥æ€ä¹ˆé€‰ï¼Ÿ","like_count":2,"discussions":[{"author":{"id":1502409,"avatar":"https://static001.geekbang.org/account/avatar/00/16/ec/c9/45bfcba3.jpg","nickname":"Xinyue Li","note":"","ucode":"0CB92610C8B9FC","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":449922,"discussion_content":"ç›¸ä¿¡ä½ çœ‹å®Œ21è®²åº”è¯¥å°±çŸ¥é“äº†ï¼ŒFlinkåœ¨æµå¤„ç†ä¸Šæœ‰å¤©ç„¶çš„ä¼˜åŠ¿ï¼Œè€ŒSparkè™½ç„¶æœ‰å„ç§æµå¤„ç†çš„æ¨¡å—ï¼Œä½†è¿˜æ˜¯åšæ‰¹å¤„ç†æ¯”è¾ƒæ“…é•¿ã€‚çœ‹å®Œ21è®²ä¸­Sparkå’ŒFlinkçš„å¯¹æ¯”ä¹‹åç›¸ä¿¡ä½ å¯ä»¥åšå‡ºé€‰æ‹©","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1567385716,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":1}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":115539,"user_name":"è¶æ—©","can_delete":false,"product_type":"c1","uid":1031970,"ip_address":"","ucode":"949FB3AA250D80","user_header":"https://static001.geekbang.org/account/avatar/00/0f/bf/22/26530e66.jpg","comment_is_top":false,"comment_ctime":1563614433,"is_pvip":false,"discussion_count":1,"race_medal":0,"score":"5858581729","product_id":100025301,"comment_content":"k8s,mesoséƒ½çŸ¥è¯†ç¼–æ’å·¥å…·å§ï¼Œé‚£å…·ä½“æ•°æ®å­˜å“ªé‡Œå‘¢","like_count":1,"discussions":[{"author":{"id":1032932,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/c2/e4/ad418d90.jpg","nickname":"é£","note":"","ucode":"2DEDB586E625C4","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":135504,"discussion_content":"Sparkä¸å­˜å‚¨æ•°æ®ï¼Œæ•°æ®ä»HDFSï¼ŒMongoï¼ŒESéƒ½å¯ä»¥","likes_number":3,"is_delete":false,"is_hidden":false,"ctime":1579095125,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":109347,"user_name":"darren","can_delete":false,"product_type":"c1","uid":1027735,"ip_address":"","ucode":"386736C90F32CA","user_header":"https://static001.geekbang.org/account/avatar/00/0f/ae/97/ba512167.jpg","comment_is_top":false,"comment_ctime":1562023820,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"5856991116","product_id":100025301,"comment_content":"å¯ä»¥ä¸ºæ¯ä¸ªè¿›ç¨‹è®¾å®šä½¿ç”¨èµ„æºï¼Œå¯¹æ¯ä¸ªçº¿ç¨‹å°±ä¸å¥½æ§åˆ¶","like_count":1},{"had_liked":false,"id":285417,"user_name":"èµ°åˆ€å£ ğŸ’°","can_delete":false,"product_type":"c1","uid":1581245,"ip_address":"","ucode":"C7E2B812A4A02C","user_header":"https://static001.geekbang.org/account/avatar/00/18/20/bd/5656b5d7.jpg","comment_is_top":false,"comment_ctime":1616802789,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1616802789","product_id":100025301,"comment_content":"è€å¸ˆï¼Œä¸ºå•¥ç”¨mrè¿›è¡Œjoinæ“ä½œä¼šæœ‰é—®é¢˜ï¼Œä½ æ–‡ç« é‡Œè¯´éœ€è¦å¯¹2ä¸ªæ•°æ®é›†åšmapå’Œreduceï¼Œéš¾é“sparkä¸æ˜¯å—ï¼Ÿ","like_count":0},{"had_liked":false,"id":247344,"user_name":"reven404","can_delete":false,"product_type":"c1","uid":1022868,"ip_address":"","ucode":"F84AAF2DC1D18F","user_header":"https://static001.geekbang.org/account/avatar/00/0f/9b/94/4977913a.jpg","comment_is_top":false,"comment_ctime":1599664061,"is_pvip":true,"discussion_count":0,"race_medal":0,"score":"1599664061","product_id":100025301,"comment_content":"å¦‚æœè¯´sparkæ˜¯æŠŠæ•°æ®åŠ è½½åˆ°å†…å­˜ä¸­è®¡ç®—ï¼Œé‚£æ˜¯æ€ä¹ˆæŠŠ100TBçš„æ•°æ®åŠ è½½åˆ°å†…å­˜é‡Œé¢çš„ï¼Ÿé›†ç¾¤è§„æ¨¡æ˜¯ï¼Ÿ","like_count":1},{"had_liked":false,"id":215372,"user_name":"åŒ—å†¥æœ‰é±¼","can_delete":false,"product_type":"c1","uid":1592243,"ip_address":"","ucode":"1690734A1061F4","user_header":"https://static001.geekbang.org/account/avatar/00/18/4b/b3/51bb33f2.jpg","comment_is_top":false,"comment_ctime":1588983733,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1588983733","product_id":100025301,"comment_content":"å¦‚HDFSå°æ–‡ä»¶é—®é¢˜ï¼Œæ•°æ®å€¾æ–œé—®é¢˜ï¼ŒOOMå†…å­˜æº¢å‡ºé—®é¢˜ï¼Œè¿˜æœ‰é…ç½®æ–‡ä»¶é¡¹è¿‡å¤šã€‚å› ä¸ºsparkå¤§é‡ä½¿ç”¨å†…å­˜ï¼Œæ›´å®¹æ˜“OOMã€‚åŒæ—¶ï¼Œå®é™…å¼€å‘ä¸­å‘ç°ï¼Œsparkä¸é€‚åˆé«˜å¹¶å‘ï¼Œå®¹æ˜“å‡ºç°å†…å­˜æ³„éœ²ã€‚ å¯¹äºæµå¼è¿™ä¸€å—ï¼ŒçŠ¶æ€ç®¡ç†ä¹Ÿä¸å¤ªå¥½ï¼Œè€ŒFlinkä»æ­å»ºæ¶æ„å¼€å§‹ï¼Œå°±æŠŠçŠ¶æ€ç®¡ç†è€ƒè™‘è¿›å»äº†â€¦","like_count":1},{"had_liked":false,"id":201634,"user_name":"ç‹å¤§é¾™","can_delete":false,"product_type":"c1","uid":1852401,"ip_address":"","ucode":"73A8A4428C911E","user_header":"https://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTIhkl44PZasVPBEDobjeyMhhNb50BwFbHic5aVsJz4zynN9PcqaEE3WwMND7Wrw9yzjYicUlqzdzFZA/132","comment_is_top":false,"comment_ctime":1585814622,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1585814622","product_id":100025301,"comment_content":"sparké€šè¿‡ç¼“å­˜å†…å­˜æé«˜æ•°æ®å¤„ç†æ•ˆç‡ï¼Œä½†æ˜¯å¦‚æœå¾ˆå¤šæ–‡ä»¶éœ€è¦åŒæ—¶å¤„ç†çš„è¯ï¼Œåº”è¯¥å½±å“å…¶æ€§èƒ½å§ï¼›<br>å¦å¤–æƒ³è¯·æ•™ä¸‹è€å¸ˆï¼Œå¦‚æœåŒæ—¶é€šè¿‡sparkè¿è¡Œæ•°æ®ï¼Œåœ¨å†…å­˜è¶³å¤Ÿçš„æƒ…å†µä¸‹ï¼Œæ˜¯å¹¶è¡Œå¤„ç†å—ï¼Ÿ","like_count":0},{"had_liked":false,"id":197414,"user_name":"ä¸è®°å¹´","can_delete":false,"product_type":"c1","uid":1045945,"ip_address":"","ucode":"287E40C68356DC","user_header":"https://static001.geekbang.org/account/avatar/00/0f/f5/b9/888fe350.jpg","comment_is_top":false,"comment_ctime":1585375152,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1585375152","product_id":100025301,"comment_content":"å½“å°æ–‡ä»¶è¿‡å¤šæ—¶MRï¼ŒSparkè¿ç®—æ•ˆç‡éƒ½ä¸‹é™çš„å¾ˆå‰å®³ã€‚æˆ‘è§‰å¾—è§£å†³æ–¹æ¡ˆå¯èƒ½åœ¨è®¡ç®—æ¡†æ¶ä¹‹å¤–ï¼Œé€šè¿‡æ•°æ®è´¨é‡ç®¡ç†ç³»ç»Ÿæ¥è§£å†³","like_count":0},{"had_liked":false,"id":194219,"user_name":"Eden2020","can_delete":false,"product_type":"c1","uid":1899158,"ip_address":"","ucode":"0DEE62F2335237","user_header":"https://static001.geekbang.org/account/avatar/00/1c/fa/96/4a7b7505.jpg","comment_is_top":false,"comment_ctime":1585038445,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1585038445","product_id":100025301,"comment_content":"å…¶å®sparkå’Œmrå°±æ˜¯å·®ä¸å¤šçš„ï¼Œå¾ˆå¤šmrçš„ä¼˜åŒ–çš„ç»“æœå°±æ˜¯sparkï¼Œsparké™å®šäº†ç¼–ç¨‹æ–¹å¼ï¼Œå…¶å®æ•°æ®å¤„ç†è¿˜æœ‰å¾ˆå¤šè¦è€ƒè™‘çš„ï¼Œæ¯”å¦‚å­˜å‚¨å‡è¡¡ï¼Œæœ€å°åŒ–è®¿é—®ï¼Œç´¢å¼•ï¼Œè§†å›¾å®æ—¶ç»´æŠ¤ç­‰ç­‰","like_count":0},{"had_liked":false,"id":157301,"user_name":"èµ°å°èª¿çš„å‡¡ä¸–æ—","can_delete":false,"product_type":"c1","uid":1011453,"ip_address":"","ucode":"EF3E5195D56188","user_header":"https://static001.geekbang.org/account/avatar/00/0f/6e/fd/6d0109c0.jpg","comment_is_top":false,"comment_ctime":1575105212,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1575105212","product_id":100025301,"comment_content":"è¯·æ•™ä¸‹è€å¸ˆï¼Œæˆ‘ä»¬æœ‰ä¸ªéœ€æ±‚ï¼šæ ¹æ®å„ç§è‡ªå®šä¹‰è§„åˆ™ï¼ˆæ¯”å¦‚åˆ†è¾¨ç‡ã€å¤§å°ç­‰ï¼‰è®¡ç®—æµ·é‡èµ„æºçš„åˆ†æ•°ï¼ˆèµ„æºå¯ä»¥æ˜¯å›¾ç‰‡ã€è§†é¢‘ã€éŸ³é¢‘ï¼‰ã€‚æ€»åˆ†100ï¼Œå›¾ç‰‡åˆ†è¾¨ç‡å¤ªå°æˆ–è§†é¢‘å¤ªå¤§éƒ½è¦æ‰£åˆ†ï¼Œæœ€åç®—å‡ºä¸€ä¸ªèµ„æºæ€»åˆ†ï¼Œè¿™ç§éœ€æ±‚å¯ä»¥ç”¨sparkå®ç°å—ï¼Ÿä¸»è¦è€ƒè™‘ç®—åˆ†è¿‡ç¨‹å¯èƒ½æ¯”è¾ƒè€—æ—¶ï¼Œä¸”èµ„æºæ•°é‡è¾ƒå¤šã€‚å¦‚æœå¯ä»¥çš„è¯å¦‚ä½•å®ç°å‘¢ï¼Ÿè€å¸ˆæ˜¯å¦å¯ä»¥æä¾›ä¸‹æ€è·¯ï¼Œæ„Ÿè°¢ï¼","like_count":0},{"had_liked":false,"id":108678,"user_name":"æ»©æ¶‚æ›³å°¾","can_delete":false,"product_type":"c1","uid":1187478,"ip_address":"","ucode":"40F650F2A419D4","user_header":"https://static001.geekbang.org/account/avatar/00/12/1e/96/c735ad6b.jpg","comment_is_top":false,"comment_ctime":1561852764,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1561852764","product_id":100025301,"comment_content":"æ€ä¹ˆæ„Ÿè§‰sparkç›¸æ¯”hadoopåªæ˜¯åšäº†ä¸€äº›å·¥ç¨‹ä¸Šçš„ä¼˜åŒ–ï¼Œå¤šçº¿ç¨‹vså¤šè¿›ç¨‹(ç±»æ¯”apache vs. nginx)ï¼Œå†…å­˜ç¼“å­˜ç£ç›˜æ•°æ®ï¼Œ... å­¦äº†åé¢çš„å†çœ‹","like_count":0},{"had_liked":false,"id":105112,"user_name":"13311195819","can_delete":false,"product_type":"c1","uid":1321508,"ip_address":"","ucode":"C0BAC32249A72D","user_header":"","comment_is_top":false,"comment_ctime":1560920613,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1560920613","product_id":100025301,"comment_content":"è€å¸ˆå¥½ï¼Œæ‚¨æ–‡ç« ä¸­æåˆ°â€œMapReduce çŠ¶æ€æœºâ€œï¼Œè¿™ä¸ªè¯è¯¥æ€ä¹ˆç†è§£å‘¢ï¼Ÿæ˜¯ä¸æ˜¯ç±»ä¼¼äºflinkä¸­stateçš„æ¦‚å¿µï¼Ÿ<br><br>","like_count":0},{"had_liked":false,"id":97498,"user_name":"ä¸€","can_delete":false,"product_type":"c1","uid":1220750,"ip_address":"","ucode":"28E0605EA1AE88","user_header":"https://static001.geekbang.org/account/avatar/00/12/a0/8e/6e4c7509.jpg","comment_is_top":false,"comment_ctime":1558685203,"is_pvip":false,"discussion_count":1,"race_medal":0,"score":"1558685203","product_id":100025301,"comment_content":"è€å¸ˆå¥½ï¼Œâ€œå¤šè¿›ç¨‹æ¨¡å‹ä¾¿äºç»†ç²’åº¦æ§åˆ¶æ¯ä¸ªä»»åŠ¡å ç”¨çš„èµ„æºâ€è¿™ä¸€å¥ä¸å¤ªç†è§£ï¼Œè¿›ç¨‹ä¸æ˜¯ç²—ç²’åº¦çš„æ¦‚å¿µå—ï¼Ÿä¸ºä»€ä¹ˆä»¥è¿›ç¨‹ä¸ºå•ä½çš„å¹¶å‘åè€Œä¾¿äºç»†ç²’åº¦çš„æ§åˆ¶æ¯ä¸ªä»»åŠ¡å ç”¨çš„èµ„æºå‘¢ï¼Ÿ","like_count":1,"discussions":[{"author":{"id":1048707,"avatar":"https://static001.geekbang.org/account/avatar/00/10/00/83/9329a697.jpg","nickname":"é©¬æ®¿å†›","note":"","ucode":"97FE6251C04E6D","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":24706,"discussion_content":"æ˜¯å› ä¸ºè¿›ç¨‹å±‚é¢çš„èµ„æºéš”ç¦»æ›´æ–¹ä¾¿å§","likes_number":1,"is_delete":false,"is_hidden":false,"ctime":1570244985,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":94150,"user_name":"å¤§é¹","can_delete":false,"product_type":"c1","uid":1004481,"ip_address":"","ucode":"F56D9D1DE892D8","user_header":"https://static001.geekbang.org/account/avatar/00/0f/53/c1/34bb9b24.jpg","comment_is_top":false,"comment_ctime":1557732400,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1557732400","product_id":100025301,"comment_content":"ä¸¤è€…å…±å­˜çš„æ•°æ®çƒ­ç‚¹é—®é¢˜ï¼Œä¾ç„¶éœ€è¦æ‰‹å·¥ä»‹å…¥ï¼Œä¸€ä¸ªæ–¹æ³•æ˜¯å‡å°‘æ— ç”¨çš„ä¿¡æ¯ï¼Œç¬¬äºŒä¸ªå°±æ˜¯å•ç‹¬å¤„ç†ä¸”åˆ†è€Œæ²»ä¹‹","like_count":0},{"had_liked":false,"id":94124,"user_name":"ç¨‹åºè®¾è®¡çš„è‰ºæœ¯","can_delete":false,"product_type":"c1","uid":1107847,"ip_address":"","ucode":"CA3817C11CD9E6","user_header":"https://static001.geekbang.org/account/avatar/00/10/e7/87/9ad59b98.jpg","comment_is_top":false,"comment_ctime":1557725958,"is_pvip":false,"replies":[{"id":"48527","content":"1. å¦‚æœåªæ˜¯å•æœºåœºæ™¯ä¸‹ï¼Œæ•ˆç‡ç¡®å®å·®ä¸å¤šã€‚Sparkæœ¬èº«å°±æ˜¯åˆ†å¸ƒå¼å¾—è®¡ç®—å¼•æ“ã€‚<br>2. è¿˜éœ€è¦æ›´å¤šä¿¡æ¯æ¥åˆ¤æ–­ï¼Œä¸èƒ½ä¸€æ¦‚è€Œè®ºã€‚","user_name":"ä½œè€…å›å¤","user_name_real":"Xinyue Li","uid":"1502409","ctime":1567390340,"ip_address":"","comment_id":94124,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1557725958","product_id":100025301,"comment_content":"æ‚¨å¥½ï¼Œæˆ‘æœ‰ä¸¤ä¸ªé—®é¢˜ï¼Œæœ€è¿‘åœ¨æŸåœºæ™¯é€‰å‹å¤„ç†æ–¹æ¡ˆæ—¶ï¼Œå¯¹äºsparkå¤„ç†æ–¹å¼ä¸‹ï¼š<br>1.å¦‚æœæ˜¯éé›†ç¾¤ä¸‹ä½¿ç”¨sparkï¼Œæ˜¯ä¸æ˜¯ä¸jvmå¤šçº¿ç¨‹å¤„ç†ä»»åŠ¡çš„æ•ˆç‡å·®ä¸å¤šï¼Ÿ<br>2.å¯¹äºåº“å­˜æ•°æ®ä¸è®¢å•æ˜ç»†çš„åŒ¹é…å’Œåº“å­˜æ ¡éªŒï¼Œæ˜¯å¦é€‚åˆä½¿ç”¨sparkæ¥å¤„ç†ï¼Ÿå¯¹äºåº“å­˜æ•°æ®æ¥è®²ï¼Œæ˜¯çƒ­ç‚¹æ•°æ®ï¼Œæ˜¯çœ‹æˆä¸¤ä¸ªæ•°æ®é›†åšunionè¿˜æ˜¯ä¸€ä¸ªè®¢å•æ•°æ®é›†ï¼Ÿè°¢è°¢","like_count":0,"discussions":[{"author":{"id":1502409,"avatar":"https://static001.geekbang.org/account/avatar/00/16/ec/c9/45bfcba3.jpg","nickname":"Xinyue Li","note":"","ucode":"0CB92610C8B9FC","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":449923,"discussion_content":"1. å¦‚æœåªæ˜¯å•æœºåœºæ™¯ä¸‹ï¼Œæ•ˆç‡ç¡®å®å·®ä¸å¤šã€‚Sparkæœ¬èº«å°±æ˜¯åˆ†å¸ƒå¼å¾—è®¡ç®—å¼•æ“ã€‚\n2. è¿˜éœ€è¦æ›´å¤šä¿¡æ¯æ¥åˆ¤æ–­ï¼Œä¸èƒ½ä¸€æ¦‚è€Œè®ºã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1567390340,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":1}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":94037,"user_name":"CoderLean","can_delete":false,"product_type":"c1","uid":1518409,"ip_address":"","ucode":"DC9E25428EDB3F","user_header":"https://static001.geekbang.org/account/avatar/00/17/2b/49/e94b2a35.jpg","comment_is_top":false,"comment_ctime":1557709122,"is_pvip":false,"replies":[{"id":"48514","content":"è¿™ä¸ªæˆ‘ä»¬åœ¨15è®²Spark SQLä¸­æœ‰è¯¦ç»†çš„è®²è§£å®ƒçš„å‘å±•å†ç¨‹ï¼Œå®ƒç¡®å®æ˜¯ç”¨æ¥è®©Sparkæ‘†è„±å¯¹Hiveçš„ä¾èµ–è€Œå‘å±•æ¥çš„ã€‚","user_name":"ä½œè€…å›å¤","user_name_real":"Xinyue Li","uid":"1502409","ctime":1567386129,"ip_address":"","comment_id":94037,"utype":1}],"discussion_count":2,"race_medal":0,"score":"1557709122","product_id":100025301,"comment_content":"Sparksqlæ˜¯ä¸æ˜¯ç”¨æ¥æ›¿ä»£hiveçš„ä¸€ä¸ªå·¥å…·","like_count":1,"discussions":[{"author":{"id":1502409,"avatar":"https://static001.geekbang.org/account/avatar/00/16/ec/c9/45bfcba3.jpg","nickname":"Xinyue Li","note":"","ucode":"0CB92610C8B9FC","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":449882,"discussion_content":"è¿™ä¸ªæˆ‘ä»¬åœ¨15è®²Spark SQLä¸­æœ‰è¯¦ç»†çš„è®²è§£å®ƒçš„å‘å±•å†ç¨‹ï¼Œå®ƒç¡®å®æ˜¯ç”¨æ¥è®©Sparkæ‘†è„±å¯¹Hiveçš„ä¾èµ–è€Œå‘å±•æ¥çš„ã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1567386129,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":1}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1503327,"avatar":"https://static001.geekbang.org/account/avatar/00/16/f0/5f/19d1a3ff.jpg","nickname":"ä½ èµ¢äº†","note":"","ucode":"D72375656E88C0","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":451,"discussion_content":"sparkæœ¬è´¨æ¥è®²æ˜¯ä¸€ä¸ªè®¡ç®—å¼•æ“ï¼Œhiveæ˜¯æ•°ä»“ï¼Œæ›¿ä»£ä¸äº†","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1561597367,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]}]}