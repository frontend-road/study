{"id":85158,"title":"38ä¸¨æ•°æ®å¯è§†åŒ–å®æˆ˜ï¼šå¦‚ä½•ç»™æ¯›ä¸æ˜“çš„æ­Œæ›²åšè¯äº‘å±•ç¤ºï¼Ÿ","content":"<p>ä»Šå¤©æˆ‘ä»¬åšä¸€ä¸ªæ•°æ®å¯è§†åŒ–çš„é¡¹ç›®ã€‚</p><p>æˆ‘ä»¬ç»å¸¸éœ€è¦å¯¹åˆ†æçš„æ•°æ®æå–å¸¸ç”¨è¯ï¼Œåšè¯äº‘å±•ç¤ºã€‚æ¯”å¦‚ä¸€äº›äº’è”ç½‘å…¬å¸ä¼šæŠ“å–ç”¨æˆ·çš„ç”»åƒï¼Œæˆ–è€…æ¯æ—¥è®¨è®ºè¯é¢˜çš„å…³é”®è¯ï¼Œå½¢æˆè¯äº‘å¹¶è¿›è¡Œå±•ç¤ºã€‚å†æˆ–è€…ï¼Œå‡å¦‚ä½ å–œæ¬¢æŸä¸ªæ­Œæ‰‹ï¼Œæƒ³äº†è§£è¿™ä¸ªæ­Œæ‰‹åˆ›ä½œçš„æ­Œæ›²ä¸­ç»å¸¸ç”¨åˆ°å“ªäº›è¯è¯­ï¼Œè¯äº‘å°±æ˜¯ä¸ªå¾ˆå¥½çš„å·¥å…·ã€‚æœ€åï¼Œåªéœ€è¦å°†è¯äº‘ç”Ÿæˆä¸€å¼ å›¾ç‰‡å°±å¯ä»¥ç›´è§‚åœ°çœ‹åˆ°ç»“æœã€‚</p><p>é‚£ä¹ˆåœ¨ä»Šå¤©çš„å®æˆ˜é¡¹ç›®é‡Œï¼Œæœ‰3ä¸ªç›®æ ‡éœ€è¦æŒæ¡ï¼š</p><ol>\n<li>\n<p>æŒæ¡è¯äº‘åˆ†æå·¥å…·ï¼Œå¹¶è¿›è¡Œå¯è§†åŒ–å‘ˆç°ï¼›</p>\n</li>\n<li>\n<p>æŒæ¡Pythonçˆ¬è™«ï¼Œå¯¹ç½‘é¡µçš„æ•°æ®è¿›è¡Œçˆ¬å–ï¼›</p>\n</li>\n<li>\n<p>æŒæ¡XPathå·¥å…·ï¼Œåˆ†ææå–æƒ³è¦çš„å…ƒç´  ã€‚</p>\n</li>\n</ol><h2>å¦‚ä½•åˆ¶ä½œè¯äº‘</h2><p>é¦–å…ˆæˆ‘ä»¬éœ€è¦äº†è§£ä»€ä¹ˆæ˜¯è¯äº‘ã€‚è¯äº‘ä¹Ÿå«æ–‡å­—äº‘ï¼Œå®ƒå¸®åŠ©æˆ‘ä»¬ç»Ÿè®¡æ–‡æœ¬ä¸­é«˜é¢‘å‡ºç°çš„è¯ï¼Œè¿‡æ»¤æ‰æŸäº›å¸¸ç”¨è¯ï¼ˆæ¯”å¦‚â€œä½œæ›²â€â€œä½œè¯â€ï¼‰ï¼Œå°†æ–‡æœ¬ä¸­çš„é‡è¦å…³é”®è¯è¿›è¡Œå¯è§†åŒ–ï¼Œæ–¹ä¾¿åˆ†æè€…æ›´å¥½æ›´å¿«åœ°äº†è§£æ–‡æœ¬çš„é‡ç‚¹ï¼ŒåŒæ—¶è¿˜å…·æœ‰ä¸€å®šçš„ç¾è§‚åº¦ã€‚</p><p>Pythonæä¾›äº†è¯äº‘å·¥å…·WordCloudï¼Œä½¿ç”¨pip install wordcloudå®‰è£…åï¼Œå°±å¯ä»¥åˆ›å»ºä¸€ä¸ªè¯äº‘ï¼Œæ„é€ æ–¹æ³•å¦‚ä¸‹ï¼š</p><pre><code>wc = WordCloud(\n    background_color='white',# è®¾ç½®èƒŒæ™¯é¢œè‰²\n    mask=backgroud_Image,# è®¾ç½®èƒŒæ™¯å›¾ç‰‡\n    font_path='./SimHei.ttf',  # è®¾ç½®å­—ä½“ï¼Œé’ˆå¯¹ä¸­æ–‡çš„æƒ…å†µéœ€è¦è®¾ç½®ä¸­æ–‡å­—ä½“ï¼Œå¦åˆ™æ˜¾ç¤ºä¹±ç \n    max_words=100, # è®¾ç½®æœ€å¤§çš„å­—æ•°\n    stopwords=STOPWORDS,# è®¾ç½®åœç”¨è¯\n\tmax_font_size=150,# è®¾ç½®å­—ä½“æœ€å¤§å€¼\n\twidth=2000,# è®¾ç½®ç”»å¸ƒçš„å®½åº¦\n\theight=1200,# è®¾ç½®ç”»å¸ƒçš„é«˜åº¦\n    random_state=30# è®¾ç½®å¤šå°‘ç§éšæœºçŠ¶æ€ï¼Œå³å¤šå°‘ç§é¢œè‰²\n)\n</code></pre><p>å®é™…ä¸ŠWordCloudè¿˜æœ‰æ›´å¤šçš„æ„é€ å‚æ•°ï¼Œä»£ç é‡Œå±•ç¤ºçš„æ˜¯ä¸€äº›ä¸»è¦å‚æ•°ï¼Œæˆ‘åœ¨ä»£ç ä¸­éƒ½æœ‰æ³¨é‡Šï¼Œä½ å¯ä»¥è‡ªå·±çœ‹ä¸‹ã€‚</p><p>åˆ›å»ºå¥½WordCloudç±»ä¹‹åï¼Œå°±å¯ä»¥ä½¿ç”¨wordcloud=generate(text)æ–¹æ³•ç”Ÿæˆè¯äº‘ï¼Œä¼ å…¥çš„å‚æ•°textä»£è¡¨ä½ è¦åˆ†æçš„æ–‡æœ¬ï¼Œæœ€åä½¿ç”¨wordcloud.tofile(â€œa.jpgâ€)å‡½æ•°ï¼Œå°†å¾—åˆ°çš„è¯äº‘å›¾åƒç›´æ¥ä¿å­˜ä¸ºå›¾ç‰‡æ ¼å¼æ–‡ä»¶ã€‚</p><!-- [[[read_end]]] --><p>ä½ ä¹Ÿå¯ä»¥ä½¿ç”¨Pythonçš„å¯è§†åŒ–å·¥å…·Matplotlibè¿›è¡Œæ˜¾ç¤ºï¼Œæ–¹æ³•å¦‚ä¸‹ï¼š</p><pre><code>import matplotlib.pyplot as plt\nplt.imshow(wordcloud)\nplt.axis(&quot;off&quot;)\nplt.show()\n</code></pre><p>éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œæˆ‘ä»¬ä¸éœ€è¦æ˜¾ç¤ºXè½´å’ŒYè½´çš„åæ ‡ï¼Œä½¿ç”¨plt.axis(â€œoffâ€)å¯ä»¥å°†åæ ‡è½´å…³é—­ã€‚</p><p>äº†è§£äº†å¦‚ä½•ä½¿ç”¨è¯äº‘å·¥å…·WordCloudä¹‹åï¼Œæˆ‘ä»¬å°†ä¸“æ å‰15èŠ‚çš„æ ‡é¢˜è¿›è¡Œè¯äº‘å¯è§†åŒ–ï¼Œå…·ä½“çš„ä»£ç å¦‚ä¸‹ï¼š</p><pre><code>#-*- coding:utf-8 -*-\nfrom wordcloud import WordCloud\nimport matplotlib.pyplot as plt\nimport jieba\nfrom PIL import Image\nimport numpy as np\n# ç”Ÿæˆè¯äº‘\ndef create_word_cloud(f):\n     print('æ ¹æ®è¯é¢‘è®¡ç®—è¯äº‘')\n     text = &quot; &quot;.join(jieba.cut(f,cut_all=False, HMM=True))\n     wc = WordCloud(\n           font_path=&quot;./SimHei.ttf&quot;,\n           max_words=100,\n           width=2000,\n           height=1200,\n    )\n     wordcloud = wc.generate(text)\n     # å†™è¯äº‘å›¾ç‰‡\n     wordcloud.to_file(&quot;wordcloud.jpg&quot;)\n     # æ˜¾ç¤ºè¯äº‘æ–‡ä»¶\n     plt.imshow(wordcloud)\n     plt.axis(&quot;off&quot;)\n     plt.show()\n\nf = 'æ•°æ®åˆ†æå…¨æ™¯å›¾åŠä¿®ç‚¼æŒ‡å—\\\nå­¦ä¹ æ•°æ®æŒ–æ˜çš„æœ€ä½³å­¦ä¹ è·¯å¾„æ˜¯ä»€ä¹ˆï¼Ÿ\\\nPythonåŸºç¡€è¯­æ³•ï¼šå¼€å§‹ä½ çš„Pythonä¹‹æ—…\\\nPythonç§‘å­¦è®¡ç®—ï¼šNumPy\\\nPythonç§‘å­¦è®¡ç®—ï¼šPandas\\\nå­¦ä¹ æ•°æ®åˆ†æè¦æŒæ¡å“ªäº›åŸºæœ¬æ¦‚å¿µï¼Ÿ\\\nç”¨æˆ·ç”»åƒï¼šæ ‡ç­¾åŒ–å°±æ˜¯æ•°æ®çš„æŠ½è±¡èƒ½åŠ›\\\næ•°æ®é‡‡é›†ï¼šå¦‚ä½•è‡ªåŠ¨åŒ–é‡‡é›†æ•°æ®ï¼Ÿ\\\næ•°æ®é‡‡é›†ï¼šå¦‚ä½•ç”¨å…«çˆªé±¼é‡‡é›†å¾®åšä¸Šçš„â€œD&amp;Gâ€è¯„è®ºï¼Ÿ\\\nPythonçˆ¬è™«ï¼šå¦‚ä½•è‡ªåŠ¨åŒ–ä¸‹è½½ç‹ç¥–è´¤æµ·æŠ¥ï¼Ÿ\\\næ•°æ®æ¸…æ´—ï¼šæ•°æ®ç§‘å­¦å®¶80%æ—¶é—´éƒ½èŠ±è´¹åœ¨äº†è¿™é‡Œï¼Ÿ\\\næ•°æ®é›†æˆï¼šè¿™äº›å¤§å·ä¸€å…±20äº¿ç²‰ä¸ï¼Ÿ\\\næ•°æ®å˜æ¢ï¼šå¤§å­¦æˆç»©è¦æ±‚æ­£æ€åˆ†å¸ƒåˆç†ä¹ˆï¼Ÿ\\\næ•°æ®å¯è§†åŒ–ï¼šæŒæ¡æ•°æ®é¢†åŸŸçš„ä¸‡é‡‘æ²¹æŠ€èƒ½\\\nä¸€æ¬¡å­¦ä¼šPythonæ•°æ®å¯è§†åŒ–çš„10ç§æŠ€èƒ½'\n</code></pre><p>è¿è¡Œç»“æœï¼š<br>\n<img src=\"https://static001.geekbang.org/resource/image/49/34/49b2c6a27345777922db4b6e31110434.png?wh=1725*1035\" alt=\"\"><br>\nä½ èƒ½ä»ç»“æœä¸­çœ‹å‡ºï¼Œè¿˜æ˜¯æœ‰ä¸€äº›å¸¸ç”¨è¯æ˜¾ç¤ºå‡ºæ¥äº†ï¼Œæ¯”å¦‚â€œä»€ä¹ˆâ€â€œè¦æ±‚â€â€œè¿™äº›â€ç­‰ï¼Œæˆ‘ä»¬å¯ä»¥æŠŠè¿™äº›è¯è®¾ç½®ä¸ºåœç”¨è¯ï¼Œç¼–å†™remove_stop_wordså‡½æ•°ï¼Œä»æ–‡æœ¬ä¸­å»æ‰ï¼š</p><pre><code># å»æ‰åœç”¨è¯\ndef remove_stop_words(f):\n     stop_words = ['å­¦ä¼š', 'å°±æ˜¯', 'ä»€ä¹ˆ']\n     for stop_word in stop_words:\n           f = f.replace(stop_word, '')\n     return f\n</code></pre><p>ç„¶ååœ¨ç»“ç®—è¯äº‘å‰è°ƒç”¨f = remove_stop_words(f)æ–¹æ³•ï¼Œæœ€åè¿è¡Œå¯ä»¥å¾—åˆ°å¦‚ä¸‹çš„ç»“æœï¼š</p><p><img src=\"https://static001.geekbang.org/resource/image/d0/ed/d0bd9cde1e1c0638976cef26b519fded.png?wh=1725*1035\" alt=\"\"><br>\nä½ èƒ½çœ‹å‡ºï¼Œå»æ‰åœç”¨è¯ä¹‹åçš„è¯äº‘æ›´åŠ æ¸…æ™°ï¼Œæ›´èƒ½ä½“ç°å‰15ç« çš„ä¸»è¦å†…å®¹ã€‚</p><h2>ç»™æ¯›ä¸æ˜“çš„æ­Œè¯åˆ¶ä½œè¯äº‘</h2><p>å‡è®¾æˆ‘ä»¬ç°åœ¨è¦ç»™æ¯›ä¸æ˜“çš„æ­Œè¯åšä¸ªè¯äº‘ï¼Œé‚£ä¹ˆéœ€è¦æ€ä¹ˆåšå‘¢ï¼Ÿæˆ‘ä»¬å…ˆæŠŠæ•´ä¸ªé¡¹ç›®çš„æµç¨‹æ¢³ç†ä¸‹ï¼š</p><p><img src=\"https://static001.geekbang.org/resource/image/7c/97/7cff33b392cec653ca2e68fbecd4ef97.jpg?wh=2337*776\" alt=\"\"></p><ol>\n<li>\n<p>åœ¨å‡†å¤‡é˜¶æ®µï¼šæˆ‘ä»¬ä¸»è¦ä½¿ç”¨Pythonçˆ¬è™«è·å–HTMLï¼Œç”¨XPathå¯¹æ­Œæ›²çš„IDã€åç§°è¿›è¡Œè§£æï¼Œç„¶åé€šè¿‡ç½‘æ˜“äº‘éŸ³ä¹çš„APIæ¥å£è·å–æ¯é¦–æ­Œçš„æ­Œè¯ï¼Œæœ€åå°†æ‰€æœ‰çš„æ­Œè¯åˆå¹¶å¾—åˆ°ä¸€ä¸ªå˜é‡ã€‚</p>\n</li>\n<li>\n<p>åœ¨è¯äº‘åˆ†æé˜¶æ®µï¼Œæˆ‘ä»¬éœ€è¦åˆ›å»ºWordCloudè¯äº‘ç±»ï¼Œåˆ†æå¾—åˆ°çš„æ­Œè¯æ–‡æœ¬ï¼Œæœ€åå¯è§†åŒ–ã€‚</p>\n</li>\n</ol><p>åŸºäºä¸Šé¢çš„æµç¨‹ï¼Œç¼–å†™ä»£ç å¦‚ä¸‹ï¼š</p><pre><code># -*- coding:utf-8 -*-\n# ç½‘æ˜“äº‘éŸ³ä¹ é€šè¿‡æ­Œæ‰‹IDï¼Œç”Ÿæˆè¯¥æ­Œæ‰‹çš„è¯äº‘\nimport requests\nimport sys\nimport re\nimport os\nfrom wordcloud import WordCloud\nimport matplotlib.pyplot as plt\nimport jieba\nfrom PIL import Image\nimport numpy as np\nfrom lxml import etree\n \nheaders = {\n       'Referer'  :'http://music.163.com',\n       'Host'     :'music.163.com',\n       'Accept'   :'text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,image/apng,*/*;q=0.8',\n       'User-Agent':'Chrome/10'\n    }\n \n# å¾—åˆ°æŸä¸€é¦–æ­Œçš„æ­Œè¯\ndef get_song_lyric(headers,lyric_url):\n    res = requests.request('GET', lyric_url, headers=headers)\n    if 'lrc' in res.json():\n       lyric = res.json()['lrc']['lyric']\n       new_lyric = re.sub(r'[\\d:.[\\]]','',lyric)\n       return new_lyric\n    else:\n       return ''\n       print(res.json())\n# å»æ‰åœç”¨è¯\ndef remove_stop_words(f):\n    stop_words = ['ä½œè¯', 'ä½œæ›²', 'ç¼–æ›²', 'Arranger', 'å½•éŸ³', 'æ··éŸ³', 'äººå£°', 'Vocal', 'å¼¦ä¹', 'Keyboard', 'é”®ç›˜', 'ç¼–è¾‘', 'åŠ©ç†', 'Assistants', 'Mixing', 'Editing', 'Recording', 'éŸ³ä¹', 'åˆ¶ä½œ', 'Producer', 'å‘è¡Œ', 'produced', 'and', 'distributed']\n    for stop_word in stop_words:\n       f = f.replace(stop_word, '')\n    return f\n# ç”Ÿæˆè¯äº‘\ndef create_word_cloud(f):\n    print('æ ¹æ®è¯é¢‘ï¼Œå¼€å§‹ç”Ÿæˆè¯äº‘!')\n    f = remove_stop_words(f)\n    cut_text = &quot; &quot;.join(jieba.cut(f,cut_all=False, HMM=True))\n    wc = WordCloud(\n       font_path=&quot;./wc.ttf&quot;,\n       max_words=100,\n       width=2000,\n       height=1200,\n    )\n    print(cut_text)\n    wordcloud = wc.generate(cut_text)\n    # å†™è¯äº‘å›¾ç‰‡\n    wordcloud.to_file(&quot;wordcloud.jpg&quot;)\n    # æ˜¾ç¤ºè¯äº‘æ–‡ä»¶\n    plt.imshow(wordcloud)\n    plt.axis(&quot;off&quot;)\n    plt.show()\n# å¾—åˆ°æŒ‡å®šæ­Œæ‰‹é¡µé¢ çƒ­é—¨å‰50çš„æ­Œæ›²IDï¼Œæ­Œæ›²å\ndef get_songs(artist_id):\n    page_url = 'https://music.163.com/artist?id=' + artist_id\n    # è·å–ç½‘é¡µHTML\n    res = requests.request('GET', page_url, headers=headers)\n    # ç”¨XPathè§£æ å‰50é¦–çƒ­é—¨æ­Œæ›²\n    html = etree.HTML(res.text)\n    href_xpath = &quot;//*[@id='hotsong-list']//a/@href&quot;\n    name_xpath = &quot;//*[@id='hotsong-list']//a/text()&quot;\n    hrefs = html.xpath(href_xpath)\n    names = html.xpath(name_xpath)\n    # è®¾ç½®çƒ­é—¨æ­Œæ›²çš„IDï¼Œæ­Œæ›²åç§°\n    song_ids = []\n    song_names = []\n    for href, name in zip(hrefs, names):\n       song_ids.append(href[9:])\n       song_names.append(name)\n       print(href, '  ', name)\n    return song_ids, song_names\n# è®¾ç½®æ­Œæ‰‹IDï¼Œæ¯›ä¸æ˜“ä¸º12138269\nartist_id = '12138269'\n[song_ids, song_names] = get_songs(artist_id)\n# æ‰€æœ‰æ­Œè¯\nall_word = ''\n# è·å–æ¯é¦–æ­Œæ­Œè¯\nfor (song_id, song_name) in zip(song_ids, song_names):\n    # æ­Œè¯API URL\n    lyric_url = 'http://music.163.com/api/song/lyric?os=pc&amp;id=' + song_id + '&amp;lv=-1&amp;kv=-1&amp;tv=-1'\n    lyric = get_song_lyric(headers, lyric_url)\n    all_word = all_word + ' ' + lyric\n    print(song_name)\n#æ ¹æ®è¯é¢‘ ç”Ÿæˆè¯äº‘\ncreate_word_cloud(all_word)\n</code></pre><p>è¿è¡Œç»“æœï¼š</p><p><img src=\"https://static001.geekbang.org/resource/image/ee/2c/ee24610141c2722660f2e4cb5824802c.png?wh=1725*1035\" alt=\"\"><br>\nè¿™ä¸ªè¿‡ç¨‹é‡Œæœ‰ä¸€äº›æ¨¡å—ï¼Œæˆ‘éœ€è¦è¯´æ˜ä¸‹ã€‚</p><p>é¦–å…ˆæˆ‘ç¼–å†™get_songså‡½æ•°ï¼Œå¯ä»¥å¾—åˆ°æŒ‡å®šæ­Œæ‰‹é¡µé¢ä¸­çƒ­é—¨å‰50çš„æ­Œæ›²IDï¼Œæ­Œæ›²åã€‚åœ¨è¿™ä¸ªå‡½æ•°é‡Œï¼Œæˆ‘ä½¿ç”¨requests.requestå‡½æ•°è·å–æ¯›ä¸æ˜“æ­Œæ‰‹é¡µé¢çš„HTMLã€‚è¿™é‡Œéœ€è¦ä¼ å…¥æŒ‡å®šçš„è¯·æ±‚å¤´ï¼ˆheadersï¼‰ï¼Œå¦åˆ™è·å–ä¸åˆ°å®Œæ•´çš„ä¿¡æ¯ã€‚ç„¶åç”¨XPathè§£æå¹¶è·å–æŒ‡å®šçš„å†…å®¹ï¼Œè¿™ä¸ªæ¨¡å—ä¸­ï¼Œæˆ‘æƒ³è·å–çš„æ˜¯æ­Œæ›²çš„é“¾æ¥å’Œåç§°ã€‚</p><p>å…¶ä¸­æ­Œæ›²çš„é“¾æ¥ç±»ä¼¼ /song?id=536099160 è¿™ç§å½¢å¼ï¼Œä½ èƒ½çœ‹åˆ°å­—ç¬¦ä¸²ç¬¬9ä½ä¹‹åï¼Œå°±æ˜¯æ­Œæ›²çš„IDã€‚</p><p>æœ‰å…³XPathè§£æçš„å†…å®¹ï¼Œæˆ‘åœ¨<a href=\"https://time.geekbang.org/column/article/76001\">ç¬¬10èŠ‚</a>è®²åˆ°è¿‡ï¼Œå¦‚æœä½ å¿˜è®°äº†ï¼Œå¯ä»¥çœ‹ä¸€ä¸‹ã€‚ä¸€èˆ¬æ¥è¯´ï¼ŒXPathè§£æ 99%çš„å¯èƒ½éƒ½æ˜¯ä»¥//å¼€å¤´ï¼Œå› ä¸ºä½ éœ€è¦è·å–æ‰€æœ‰ç¬¦åˆè¿™ä¸ªXPathçš„å†…å®¹ã€‚æˆ‘ä»¬é€šè¿‡åˆ†æHTMLä»£ç ï¼Œèƒ½çœ‹åˆ°ä¸€ä¸ªå…³é”®çš„éƒ¨åˆ†ï¼šid=â€˜hotsong-listâ€™ã€‚è¿™ä¸ªä»£è¡¨çƒ­é—¨æ­Œæ›²åˆ—è¡¨ï¼Œä¹Ÿæ­£æ˜¯æˆ‘ä»¬æƒ³è¦è§£æçš„å†…å®¹ã€‚æˆ‘ä»¬æƒ³è¦è·å–è¿™ä¸ªçƒ­é—¨æ­Œæ›²åˆ—è¡¨ä¸‹é¢æ‰€æœ‰çš„é“¾æ¥ï¼ŒXPathè§£æå°±å¯ä»¥å†™æˆ//*[@id=â€˜hotsong-listâ€™]//aã€‚ç„¶åä½ èƒ½çœ‹åˆ°æ­Œæ›²é“¾æ¥æ˜¯hrefå±æ€§ï¼Œæ­Œæ›²åç§°æ˜¯è¿™ä¸ªé“¾æ¥çš„æ–‡æœ¬ã€‚</p><p>è·å¾—æ­Œæ›²IDä¹‹åï¼Œæˆ‘ä»¬è¿˜éœ€è¦çŸ¥é“è¿™ä¸ªæ­Œæ›²çš„æ­Œè¯ï¼Œå¯¹åº”ä»£ç ä¸­çš„get_song_lyricå‡½æ•°ï¼Œåœ¨è¿™ä¸ªå‡½æ•°é‡Œè°ƒç”¨äº†ç½‘æ˜“äº‘çš„æ­Œè¯APIæ¥å£ï¼Œæ¯”å¦‚<a href=\"http://music.163.com/api/song/lyric?os=pc&amp;id=536099160&amp;lv=-1&amp;kv=-1&amp;tv=-1\">http://music.163.com/api/song/lyric?os=pc&amp;id=536099160&amp;lv=-1&amp;kv=-1&amp;tv=-1</a>ã€‚</p><p>ä½ èƒ½çœ‹åˆ°æ­Œè¯æ–‡ä»¶é‡Œé¢è¿˜ä¿å­˜äº†æ—¶é—´ä¿¡æ¯ï¼Œæˆ‘ä»¬éœ€è¦å»æ‰è¿™éƒ¨åˆ†ã€‚å› æ­¤æˆ‘ä½¿ç”¨äº†re.subå‡½æ•°ï¼Œé€šè¿‡æ­£åˆ™è¡¨è¾¾å¼åŒ¹é…ï¼Œå°†[]ä¸­æ•°å­—ä¿¡æ¯å»æ‰ï¼Œæ–¹æ³•ä¸ºre.sub(râ€™[\\d:.[]]â€™,â€™â€™,lyric)ã€‚</p><p>æœ€åæˆ‘ä»¬è¿˜éœ€è¦è®¾ç½®ä¸€äº›æ­Œè¯ä¸­å¸¸ç”¨çš„åœç”¨è¯ï¼Œæ¯”å¦‚â€œä½œè¯â€â€œä½œæ›²â€â€œç¼–æ›²â€ç­‰ï¼Œç¼–å†™remove_stop_wordså‡½æ•°ï¼Œå°†æ­Œè¯æ–‡æœ¬ä¸­çš„åœç”¨è¯å»æ‰ã€‚</p><p>æœ€åç¼–å†™create_word_cloudå‡½æ•°ï¼Œé€šè¿‡æ­Œè¯æ–‡æœ¬ç”Ÿæˆè¯äº‘æ–‡ä»¶ã€‚</p><h2>æ€»ç»“</h2><p>ä»Šå¤©æˆ‘ç»™ä½ è®²äº†è¯äº‘çš„å¯è§†åŒ–ã€‚åœ¨è¿™ä¸ªå®æˆ˜ä¸­ï¼Œä½ èƒ½çœ‹åˆ°å‰æœŸçš„æ•°æ®å‡†å¤‡åœ¨æ•´ä¸ªè¿‡ç¨‹ä¸­å äº†å¾ˆå¤§ä¸€éƒ¨åˆ†ã€‚å¦‚æœä½ ç”¨Pythonä½œä¸ºæ•°æ®é‡‡é›†å·¥å…·ï¼Œå°±éœ€è¦æŒæ¡Pythonçˆ¬è™«å’ŒXPathè§£æï¼ŒæŒæ¡è¿™ä¸¤ä¸ªå·¥å…·æœ€å¥½çš„æ–¹å¼å°±æ˜¯å¤šåšç»ƒä¹ ã€‚</p><p>æˆ‘ä»¬ä»Šå¤©è®²åˆ°äº†è¯äº‘å·¥å…·WordCloudï¼Œå®ƒæ˜¯ä¸€ä¸ªå¾ˆå¥½ç”¨çš„Pythonå·¥å…·ï¼Œå¯ä»¥å°†å¤æ‚çš„æ–‡æœ¬é€šè¿‡è¯äº‘å›¾çš„æ–¹å¼å‘ˆç°ã€‚éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œå½“æˆ‘ä»¬éœ€è¦ä½¿ç”¨ä¸­æ–‡å­—ä½“çš„æ—¶å€™ï¼Œæ¯”å¦‚é»‘ä½“SimHeiï¼Œå°±å¯ä»¥å°†WordCloudä¸­çš„font_pathå±æ€§è®¾ç½®ä¸ºSimHei.ttfï¼Œä½ ä¹Ÿå¯ä»¥è®¾ç½®å…¶ä»–è‰ºæœ¯å­—ä½“ï¼Œåœ¨ç»™æ¯›ä¸æ˜“çš„æ­Œè¯åšè¯äº‘å±•ç¤ºçš„æ—¶å€™ï¼Œæˆ‘ä»¬å°±ç”¨åˆ°äº†è‰ºæœ¯å­—ä½“ã€‚</p><p>ä½ å¯ä»¥ä»GitHubä¸Šä¸‹è½½å­—ä½“å’Œä»£ç ï¼š<a href=\"https://github.com/cystanford/word_cloud\">https://github.com/cystanford/word_cloud</a>ã€‚</p><p><img src=\"https://static001.geekbang.org/resource/image/0c/6d/0cbc5f3e4ecd41af9a872fd9b4aed06d.png?wh=1728*939\" alt=\"\"><br>\næœ€åç»™ä½ ç•™ä¸€é“æ€è€ƒé¢˜å§ã€‚æˆ‘æŠ“å–äº†æ¯›ä¸æ˜“ä¸»é¡µçš„æ­Œè¯ï¼Œæ˜¯ä»¥æ­Œæ‰‹ä¸»é¡µä¸ºç²’åº¦è¿›è¡Œçš„è¯äº‘å¯è§†åŒ–ã€‚å®é™…ä¸Šç½‘æ˜“äº‘éŸ³ä¹ä¹Ÿæœ‰æ­Œå•çš„APIï¼Œæ¯”å¦‚<a href=\"http://music.163.com/api/playlist/detail?id=753776811\">http://music.163.com/api/playlist/detail?id=753776811</a>ã€‚ä½ èƒ½ä¸èƒ½ç¼–å†™ä»£ç å¯¹æ­Œå•åšä¸ªè¯äº‘å±•ç¤ºï¼ˆæ¯”å¦‚æ­Œå•IDä¸º753776811ï¼‰å‘¢ï¼Ÿ</p><p>æ¬¢è¿ä½ åœ¨è¯„è®ºåŒºä¸æˆ‘åˆ†äº«ä½ çš„ç­”æ¡ˆï¼Œä¹Ÿæ¬¢è¿ç‚¹å‡»â€œè¯·æœ‹å‹è¯»â€ï¼ŒæŠŠè¿™ç¯‡æ–‡ç« åˆ†äº«ç»™ä½ çš„æœ‹å‹æˆ–è€…åŒäº‹ã€‚</p><p></p>","neighbors":{"left":{"article_title":"37ä¸¨æ•°æ®é‡‡é›†å®æˆ˜ï¼šå¦‚ä½•è‡ªåŠ¨åŒ–è¿è¥å¾®åšï¼Ÿ","id":84933},"right":{"article_title":"39ä¸¨æ•°æ®æŒ–æ˜å®æˆ˜ï¼ˆ1ï¼‰ï¼šä¿¡ç”¨å¡è¿çº¦ç‡åˆ†æ","id":85577}},"comments":[{"had_liked":false,"id":78033,"user_name":"third","can_delete":false,"product_type":"c1","uid":1025114,"ip_address":"","ucode":"9A37408A834F0B","user_header":"https://static001.geekbang.org/account/avatar/00/0f/a4/5a/e708e423.jpg","comment_is_top":false,"comment_ctime":1553059101,"is_pvip":false,"replies":[{"id":"64392","content":"Good Job","user_name":"ä½œè€…å›å¤","comment_id":78033,"uid":"1306094","ip_address":"","utype":1,"ctime":1577618226,"user_name_real":"cy"}],"discussion_count":2,"race_medal":0,"score":"14437960989","product_id":100021701,"comment_content":"from wordcloud import WordCloud<br>import matplotlib.pyplot as plt<br>import requests<br><br>headers = {<br>    &#39;Referer&#39;: &#39;http:&#47;&#47;music.163.com&#39;,<br>    &#39;Host&#39;: &#39;music.163.com&#39;,<br>    &#39;Accept&#39;: &#39;text&#47;html,application&#47;xhtml+xml,application&#47;xml;q=0.9,image&#47;webp,image&#47;apng,*&#47;*;q=0.8&#39;,<br>    &#39;User-Agent&#39;: &#39;Chrome&#47;10&#39;<br>}<br><br><br>def getsong(headers):<br>    url = &#39;http:&#47;&#47;music.163.com&#47;api&#47;playlist&#47;detail?id=753776811&#39;<br>    res = requests.request(&#39;GET&#39;, url, headers=headers)<br>    page = res.json()<br>    tracks=page[&#39;result&#39;][&#39;tracks&#39;]<br>    list = []<br>    for i in range(len(tracks)):<br>        Name = tracks[i][&quot;name&quot;]<br>        list.append(Name)<br>    return list<br><br><br>def create_WordCloud(list):<br>    print(&quot;æ ¹æºè¯é¢‘è®¡ç®—è¯äº‘&quot;)<br><br>    wc = WordCloud(<br>        font_path=&quot;simhei.ttf&quot;,<br>        max_words=100,  # è®¾ç½®æœ€å¤§å­—æ•°<br>        width=2000,  # è®¾ç½®ç”»å¸ƒå®½åº¦<br>        height=1200,  # è®¾ç½®ç”»å¸ƒé«˜åº¦<br>        random_state=100<br>    )<br>    wordcloud = wc.generate(list)<br>    # å†™è¯äº‘å›¾ç‰‡<br>    wordcloud.to_file(&quot;ä½œä¸š.jpg&quot;)<br>    # æ˜¾ç¤ºè¯äº‘æ–‡ä»¶<br>    plt.imshow(wordcloud)<br>    # ä¸éœ€è¦æ˜¾ç¤ºX&#47;Yè½´ï¼Œç”¨offå°†åæ ‡è½´å…³é—­<br>    plt.axis(&quot;off&quot;)<br>    plt.show()<br><br><br># å»æ‰åœç”¨è¯ä»¥åŠä¸­è‹±æ–‡æ··åˆçš„è¯<br>def remove_stop_words(f):<br>    stop_words = [&#39;(ä¼´å¥)&#39;, &#39;(Demoç‰ˆ)&#39;, &#39;(å¿…èƒœå®¢æ–°æ˜¥ç‰ˆ)&#39;]<br>    mixed_words = [&#39;Bonus Trackï¼šä¸€è¤ä¸€ç´ &#39;, &#39;Bonus Trackï¼šç»™ä½ ç»™æˆ‘&#39;]<br>    for stop_word in stop_words:<br>        f = f.replace(stop_word, &#39;&#39;)<br>    for mixed_word in mixed_words:<br>        f = f.replace(mixed_word, mixed_word[12:])<br>    return f<br><br>gerlists = getsong(headers)<br># è·å–æ­Œå•æ˜¯listç±»å‹ç›´æ¥è½¬åŒ–ä¸ºè½¬æ¢ä¸ºstr<br>lists_str = &quot; &quot;.join(gerlists)<br><br>lists = remove_stop_words(lists_str)<br>create_WordCloud(lists)","like_count":3,"discussions":[{"author":{"id":1306094,"avatar":"https://static001.geekbang.org/account/avatar/00/13/ed/ee/c4779b67.jpg","nickname":"cy","note":"","ucode":"50D653399A31F6","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":443942,"discussion_content":"Good Job","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1577618226,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1217329,"avatar":"https://static001.geekbang.org/account/avatar/00/12/93/31/abb7bfe3.jpg","nickname":"picoasis","note":"","ucode":"D5113416FF2B14","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":406173,"discussion_content":"# -*- coding:utf-8 -*-\n# ç½‘æ˜“äº‘éŸ³ä¹ é€šè¿‡æ­Œå•IDï¼Œç”Ÿæˆæ­Œå•ä¸­æ­Œåçš„è¯äº‘\n# url æ¥è‡ªç½‘é¡µç‰ˆçš„ç½‘æ˜“äº‘éŸ³ä¹, æ§åˆ¶å° \nimport requests\nfrom wordcloud import WordCloud\nimport matplotlib.pyplot as plt\nimport jieba\nfrom lxml import etree\nimport re\n#import pdb\nheaders = {\n    &#39;Referer&#39;: &#39;http://music.163.com&#39;,\n    &#39;Host&#39;: &#39;music.163.com&#39;,\n    &#39;Accept&#39;: &#39;text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,image/apng,*/*;q=0.8&#39;,\n    &#39;User-Agent&#39;: &#39;Chrome/10&#39;\n}\n\n# è·å–åˆ°æ­Œå•\ndef get_song_list(headers,song_list_url):\n    res = requests.request(&#34;GET&#34;,song_list_url,headers=headers, verify=False)\n    if res.status_code == 200:\n        xpathObj = etree.HTML(res.text)\n        href_xpath=&#39;//*[@id=&#34;song-list-pre-cache&#34;]//a/@href&#39;\n        name_xpath=&#39;//*[@id=&#34;song-list-pre-cache&#34;]//a/text()&#39;\n        #pdb.set_trace()\n        hrefs = xpathObj.xpath(href_xpath)\n        names = xpathObj.xpath(name_xpath)\n        #pdb.set_trace()\n        songs_id = []\n        songs_name = []\n        for href,name in zip(hrefs,names):\n            songs_id.append(re.sub(r&#39;\\D&#39;,&#39;&#39;,href))\n            songs_name.append(re.sub(r&#39;\\s&#39;,&#39;&#39;,name))\n        return songs_id,songs_name\n    else:\n        print(res.text)\n \n        \n# åˆ›å»ºè¯äº‘å±•ç¤º\ndef createWordcloud(f):\n    print(&#34;æ ¹æ®è¯é¢‘ç»“æœè¿›è¡Œè¯äº‘å±•ç¤ºï¼&#34;)\n    cut_text = &#34; &#34;.join(jieba.cut(f,cut_all=False,HMM=True))\n    wc = WordCloud(\n        font_path=&#34;STHeiti Light.ttc&#34;,\n        max_words=100,\n        width=2000,\n        height=1200,\n    )\n    wordcloud = wc.generate(cut_text)\n    wordcloud.to_file(&#34;song_list_wordcloud.jpg&#34;)\n    # è¯äº‘å±•ç¤º\n    plt.imshow(wordcloud)\n    plt.axis(&#34;off&#34;)\n    plt.show()\n\n# å¼€å§‹\nsong_list_id = &#39;2829883282&#39;\nsong_list_url = &#39;https://music.163.com/playlist?id=&#39; + song_list_id\n[songs_id,songs_name]= get_song_list(headers,song_list_url)\nall_songs_name = &#39;&#39;\nfor name in songs_name:\n    all_songs_name += name\n","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1634716986,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":75747,"user_name":"ç‹å½¬æˆ","can_delete":false,"product_type":"c1","uid":1015045,"ip_address":"","ucode":"386803B8FC2DD5","user_header":"https://static001.geekbang.org/account/avatar/00/0f/7d/05/4bad0c7c.jpg","comment_is_top":false,"comment_ctime":1552462791,"is_pvip":false,"replies":[{"id":"64429","content":"Good Job","user_name":"ä½œè€…å›å¤","comment_id":75747,"uid":"1306094","ip_address":"","utype":1,"ctime":1577619058,"user_name_real":"cy"}],"discussion_count":1,"race_medal":0,"score":"14437364679","product_id":100021701,"comment_content":"<br>ï¼ˆ2ï¼‰å°†æ­Œå•çš„æ­Œæ›²å¯¹åº”çš„æ­Œè¯ä½œè¯äº‘å±•ç¤º<br>import requests<br>import jieba<br>from wordcloud import WordCloud<br>import matplotlib.pyplot as plt<br><br><br>#å¾—åˆ°æŒ‡å®šæ­Œå•é¡µé¢çš„ å…¨éƒ¨æ­Œæ›²çš„æ­Œæ›²IDï¼Œæ­Œæ›²å<br>def get_songs(playlist_id):<br>    page_url=&#39;http:&#47;&#47;music.163.com&#47;api&#47;playlist&#47;detail?id=&#39;+playlist_id<br>    #è·å–ç½‘é¡µHTML<br>    res=requests.request(&#39;GET&#39;,page_url,headers=headers)<br>    # è¾“å‡ºæ­Œå•ä¸­æ­Œæ›²æ•°é‡<br>    print(len(res.json()[&#39;result&#39;][&#39;tracks&#39;]))<br><br>    # è®¾ç½®çƒ­é—¨æ­Œæ›²çš„IDï¼Œæ­Œæ›²åç§°<br>    song_ids=[]<br>    song_names=[]<br><br>    for i in range(len(res.json()[&#39;result&#39;][&#39;tracks&#39;])):<br>        names=res.json()[&#39;result&#39;][&#39;tracks&#39;][i][&#39;name&#39;]<br>        ids=res.json()[&#39;result&#39;][&#39;tracks&#39;][i][&#39;id&#39;]<br>        song_names.append(names)<br>        song_ids.append(ids)<br>        print(names,&#39; &#39;,ids)<br>    return song_names,song_ids<br> <br># å¾—åˆ°æŸä¸€é¦–æ­Œçš„æ­Œè¯<br>def get_song_lyric(headers,lyric_url):<br>    res = requests.request(&#39;GET&#39;, lyric_url, headers=headers)<br>    if &#39;lrc&#39; in res.json():<br>       lyric = res.json()[&#39;lrc&#39;][&#39;lyric&#39;]<br>       new_lyric = re.sub(r&#39;[\\d:.[\\]]&#39;,&#39;&#39;,lyric)<br>       return new_lyric<br>    else:<br>       return &#39;&#39;<br>       print(res.json())<br><br><br><br>#ç”Ÿæˆè¯äº‘<br>def create_word_cloud(f):<br>    print(&#39;æ ¹æ®è¯é¢‘ ç”Ÿæˆè¯äº‘&#39;)<br>    f=remove_stop_words(f)<br>    cut_text=&#39; &#39;.join(jieba.cut(f,cut_all=False,HMM=True))<br>    wc = WordCloud(<br>       font_path=&quot;.&#47;wc.ttf&quot;,<br>       max_words=100,<br>       width=2000,<br>       height=1200,<br>    )<br>    print(cut_text)<br>    wordcloud = wc.generate(cut_text)<br>    # å†™è¯äº‘å›¾ç‰‡<br>    wordcloud.to_file(&quot;wordcloud.jpg&quot;)<br>    # æ˜¾ç¤ºè¯äº‘æ–‡ä»¶<br>    plt.imshow(wordcloud)<br>    plt.axis(&quot;off&quot;)<br>    plt.show()<br>    <br><br># è®¾ç½®æ­Œå•IDï¼Œã€æ¯›ä¸æ˜“ | ä¸å–„è¨€è¾çš„æ·±æƒ…ã€‘ä¸º753776811<br>playlist_id=&#39;753776811&#39;<br>[song_names,song_ids]=get_songs(playlist_id)<br><br>#æ‰€æœ‰æ­Œè¯<br>all_word=&#39;&#39;<br># è·å–æ¯é¦–æ­Œæ­Œè¯<br>for (song_id, song_name) in zip(song_ids, song_names):<br>    # æ­Œè¯ API URL<br>    lyric_url = &#39;http:&#47;&#47;music.163.com&#47;api&#47;song&#47;lyric?os=pc&amp;id=&#39; + str(song_id) + &#39;&amp;lv=-1&amp;kv=-1&amp;tv=-1&#39;<br>    lyric = get_song_lyric(headers, lyric_url)<br>    all_word = all_word + &#39; &#39; + lyric<br>    print(song_name)<br><br>#æ ¹æ®è¯é¢‘ï¼Œç”Ÿæˆè¯äº‘<br>create_word_cloud(all_word)<br>","like_count":3,"discussions":[{"author":{"id":1306094,"avatar":"https://static001.geekbang.org/account/avatar/00/13/ed/ee/c4779b67.jpg","nickname":"cy","note":"","ucode":"50D653399A31F6","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":443012,"discussion_content":"Good Job","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1577619058,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":75646,"user_name":"è·³è·³","can_delete":false,"product_type":"c1","uid":1172803,"ip_address":"","ucode":"80B697B89E1A0B","user_header":"https://static001.geekbang.org/account/avatar/00/11/e5/43/7bc7cfe3.jpg","comment_is_top":false,"comment_ctime":1552443626,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"10142378218","product_id":100021701,"comment_content":"#éœ€è¦æ³¨æ„çš„æœ‰ä¸¤ç‚¹<br>#1.æ­Œå•è¿”å›çš„æ˜¯jsonæ–‡ä»¶ï¼Œget_songséœ€è¦å‚è€ƒget_songs_lyriè·å–<br>#2.list_urlä¸­é—´æ˜¯strç±»å‹ï¼Œæ³¨æ„ç±»å‹è½¬æ¢<br>#emmmï¼Œä»£ç å¤ªé•¿æ”¾ä¸ä¸‹äº†ï¼Œåˆ é™¤äº†ä¸€éƒ¨åˆ†å’Œè€å¸ˆä¸€æ ·çš„å‡½æ•°<br># -*- coding:utf-8 -*-<br># ç½‘æ˜“äº‘éŸ³ä¹ é€šè¿‡æ­Œå•IDï¼Œç”Ÿæˆè¯¥æ­Œå•çš„è¯äº‘<br>import requests<br>import sys<br>import re<br>import os<br>from wordcloud import WordCloud<br>import matplotlib.pyplot as plt<br>import jieba<br>from PIL import Image<br>import numpy as np<br>from lxml import etree<br>def get_songs(songlist):<br>    list_url=&#39;https:&#47;&#47;music.163.com&#47;api&#47;playlist&#47;detail?id=&#39;+songlist<br>    res = requests.request(&#39;GET&#39;, list_url, headers=headers)<br>    if &#39;result&#39; in res.json():<br>        for item in res.json()[&#39;result&#39;][&#39;tracks&#39;]: # è¯»å–jsonæ•°æ®ä¸­çš„æ¯ä¸€ä¸ªIDå’Œname<br>            song_ids.append(item[&#39;id&#39;]) <br>            song_names.append(item[&#39;name&#39;])<br>            print(item[&#39;id&#39;],&quot; &quot;,item[&#39;name&#39;])<br>            time.sleep(1) # è®¾ç½®åœç•™æ—¶é—´ï¼Œé˜²æ­¢â€œbad handshakeâ€<br>        return song_ids,song_names<br>    else:<br>        return &#39;&#39;<br>        print(res.json())<br># è®¾ç½®æ­Œå•<br>songlist = &#39;753776811&#39;<br>[song_ids, song_names] = get_songs(songlist)<br># æ‰€æœ‰æ­Œè¯<br>all_word = &#39;&#39;<br># è·å–æ¯é¦–æ­Œæ­Œè¯<br>for (song_id, song_name) in zip(song_ids, song_names):<br>    # æ­Œè¯ API URL<br>    list_url = &#39;http:&#47;&#47;music.163.com&#47;api&#47;song&#47;lyric?os=pc&amp;id=&#39; + str(song_id) + &#39;&amp;lv=-1&amp;kv=-1&amp;tv=-1&#39;<br>    lyric = get_song_lyric(headers, list_url)<br>    all_word = all_word + &#39; &#39; + lyric<br>    print(song_name)<br># æ ¹æ®è¯é¢‘ ç”Ÿæˆè¯äº‘<br>create_word_cloud(all_word)","like_count":2},{"had_liked":false,"id":74786,"user_name":"ä¸€è¯­ä¸­çš„","can_delete":false,"product_type":"c1","uid":1320112,"ip_address":"","ucode":"E1A0EFCEAD83B4","user_header":"https://static001.geekbang.org/account/avatar/00/14/24/b0/a6e0b03a.jpg","comment_is_top":false,"comment_ctime":1552298382,"is_pvip":false,"replies":[{"id":"64440","content":"Good Job","user_name":"ä½œè€…å›å¤","comment_id":74786,"uid":"1306094","ip_address":"","utype":1,"ctime":1577619302,"user_name_real":"cy"}],"discussion_count":1,"race_medal":0,"score":"10142232974","product_id":100021701,"comment_content":"ä»¥http:&#47;&#47;music.163.com&#47;api&#47;playlist&#47;detail?id=753776811ä¸­æ­Œå•ä¸ºä¾‹åšè¯äº‘å±•ç¤º<br>#-*- coding:utf-8 -*-<br>from wordcloud import WordCloud<br>import matplotlib.pyplot as plt<br>import requests<br><br>def getSonglists(url, headers):<br>    #æ ¹æ®æ­Œå•APIè·å–æ­Œæ›²åˆ—è¡¨<br>\t#å°†é¡µé¢ä¿¡æ¯è½¬æ¢ä¸ºjsonæ ¼å¼ä¾¿äºé€šè¿‡å­—å…¸å–å€¼<br>    r = requests.get(url, headers=headers)<br>    page_json = r.json()<br>    tracks = page_json[&quot;result&quot;][&quot;tracks&quot;]<br>    lists = []<br>    for i in  range(len(tracks)):<br>        listName = tracks[i][&quot;name&quot;]<br>        lists.append(listName)<br>    return lists<br><br>#ç”Ÿæˆè¯äº‘<br>def create_WordCloud(lists):<br>    print(&quot;æ ¹æºè¯é¢‘è®¡ç®—è¯äº‘&quot;)<br> <br>    wc = WordCloud(<br>        font_path = &quot;C:\\Windows\\Fonts\\simhei.ttf&quot;,  #è®¾ç½®ä¸­æ–‡å­—ä½“<br>        max_words = 100,             #è®¾ç½®æœ€å¤§å­—æ•°<br>        width = 2000,                #è®¾ç½®ç”»å¸ƒå®½åº¦<br>        height = 1200,                #è®¾ç½®ç”»å¸ƒé«˜åº¦<br>        random_state = 100<br>    )<br>    wordcloud = wc.generate(lists)<br>    #å†™è¯äº‘å›¾ç‰‡<br>    wordcloud.to_file(&quot;wordcloud.jpg&quot;)<br>    #æ˜¾ç¤ºè¯äº‘æ–‡ä»¶<br>    plt.imshow(wordcloud)<br>    #ä¸éœ€è¦æ˜¾ç¤ºX&#47;Yè½´ï¼Œç”¨offå°†åæ ‡è½´å…³é—­<br>    plt.axis(&quot;off&quot;)<br>    plt.show()<br><br>#å»æ‰åœç”¨è¯ä»¥åŠä¸­è‹±æ–‡æ··åˆçš„è¯<br>def remove_stop_words(f):<br>    stop_words = [&#39;(ä¼´å¥)&#39;, &#39;(Demoç‰ˆ)&#39;, &#39;(å¿…èƒœå®¢æ–°æ˜¥ç‰ˆ)&#39;]<br>    mixed_words = [&#39;Bonus Trackï¼šä¸€è¤ä¸€ç´ &#39;, &#39;Bonus Trackï¼šç»™ä½ ç»™æˆ‘&#39;]<br>    for stop_word in stop_words:<br>        f = f.replace(stop_word, &#39;&#39;)<br>    for mixed_word in mixed_words:<br>        f = f.replace(mixed_word, mixed_word[12:])<br>    return  f<br><br>if __name__ == &quot;__main__&quot;:<br><br>    headers = {<br>        &#39;Referer&#39;: &#39;http:&#47;&#47;music.163.com&#39;,<br>        &#39;Host&#39;: &#39;music.163.com&#39;,<br>        &#39;Accept&#39;: &#39;text&#47;html,application&#47;xhtml+xml,application&#47;xml;q=0.9,image&#47;webp,image&#47;apng,*&#47;*;q=0.8&#39;,<br>        &#39;User-Agent&#39;: &#39;Chrome&#47;10&#39;<br>    }<br>    url = &quot;http:&#47;&#47;music.163.com&#47;api&#47;playlist&#47;detail?id=753776811&quot;<br>    gerLists = getSonglists(url, headers)<br>\t#è·å–æ­Œå•æ˜¯listç±»å‹ï¼Œè½¬æ¢ä¸ºstrï¼Œé‚£ä¹ˆå°±ä¸å†éœ€è¦ç”¨jiebaåˆ†è¯<br>    lists_str = &quot; &quot;.join(gerLists)<br>\t<br>    lists = remove_stop_words(lists_str)<br>    create_WordCloud(lists)","like_count":2,"discussions":[{"author":{"id":1306094,"avatar":"https://static001.geekbang.org/account/avatar/00/13/ed/ee/c4779b67.jpg","nickname":"cy","note":"","ucode":"50D653399A31F6","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":442681,"discussion_content":"Good Job","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1577619302,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":185281,"user_name":"å»ºå¼º","can_delete":false,"product_type":"c1","uid":1397126,"ip_address":"","ucode":"62B03D0E0C64EC","user_header":"https://static001.geekbang.org/account/avatar/00/15/51/86/b5fd8dd8.jpg","comment_is_top":false,"comment_ctime":1583551663,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"5878518959","product_id":100021701,"comment_content":"# ç½‘æ˜“äº‘æ­Œå•è¯äº‘å›¾<br>import requests<br>import sys<br>import re<br>import os<br>from wordcloud import WordCloud<br>import matplotlib.pyplot as plt<br>import jieba<br>from PIL import Image<br>import numpy as np<br>from lxml import etree<br> <br>headers = {<br>       &#39;Referer&#39;  :&#39;http:&#47;&#47;music.163.com&#39;,<br>       &#39;Host&#39;     :&#39;music.163.com&#39;,<br>       &#39;Accept&#39;   :&#39;text&#47;html,application&#47;xhtml+xml,application&#47;xml;q=0.9,image&#47;webp,image&#47;apng,*&#47;*;q=0.8&#39;,<br>       &#39;User-Agent&#39;:&#39;Chrome&#47;10&#39;<br>    }<br><br># è·å–æ­Œå•<br>def get_songlist(artist_id):<br>#BEGIN<br>    page_url = &#39;https:&#47;&#47;music.163.com&#47;playlist?id=&#39; + artist_id<br>    # è·å–ç½‘é¡µHTML<br>    res = requests.request(&#39;GET&#39;, page_url, headers=headers)<br><br>    # ç”¨XPathä»ç½‘é¡µä¸­è§£ææ­Œå•<br>    html = etree.HTML(res.text)<br>    href_xpath = &quot;&#47;&#47;*[@id=&#39;song-list-pre-cache&#39;]&#47;&#47;a&#47;@href&quot;<br>    name_xpath = &quot;&#47;&#47;*[@id=&#39;song-list-pre-cache&#39;]&#47;&#47;a&#47;text()&quot;<br>    hrefs = html.xpath(href_xpath)<br>    names = html.xpath(name_xpath)<br><br>    # è·å–æ­Œæ›²çš„IDï¼Œæ­Œæ›²åç§°<br>    song_ids = []<br>    song_names = []<br>    for href, name in zip(hrefs, names):<br>       song_ids.append(href[9:])<br>       song_names.append(name)<br>       <br>    return song_ids, song_names<br>#END<br><br># åˆ¶ä½œè¯äº‘å›¾<br>def create_word_cloud(f):<br>#BEGIN<br>    print(&#39;æ ¹æ®è¯é¢‘ï¼Œå¼€å§‹ç”Ÿæˆè¯äº‘!&#39;)<br>    #f = remove_stop_words(f)<br>    cut_text = &quot; &quot;.join(jieba.cut(f,cut_all=False, HMM=True))<br>    wc = WordCloud(<br>       font_path=&quot;G:&#47;å¼€å‘å®éªŒåŒº&#47;å®éªŒæ•°æ®&#47;æ¯›ä¸æ˜“æ­Œå•è¯äº‘å›¾&#47;simhei.ttf&quot;,<br>       max_words=100,<br>       width=2000,<br>       height=1200,<br>    )<br>    print(cut_text)<br>    wordcloud = wc.generate(cut_text)<br>    # å†™è¯äº‘å›¾ç‰‡<br>    wordcloud.to_file(&quot;G:&#47;å¼€å‘å®éªŒåŒº&#47;å®éªŒæ•°æ®&#47;æ¯›ä¸æ˜“æ­Œå•è¯äº‘å›¾&#47;wordcloud.jpg&quot;)<br>    # æ˜¾ç¤ºè¯äº‘æ–‡ä»¶<br>    plt.imshow(wordcloud)<br>    plt.axis(&quot;off&quot;)<br>    plt.show()<br>#END<br><br># ä¸»ç¨‹åº<br>def main():<br>#BEGIN<br>    song_ids, song_names = get_songlist(&#39;753776811&#39;)<br><br>    all_song_name = &#39;&#39;<br>    for song_id, song_name in zip(song_ids, song_names):<br>        all_song_name = all_song_name + &#39; &#39; + song_name<br><br>    create_word_cloud(all_song_name)<br>    <br>#END<br><br>if __name__ == &#39;__main__&#39;:<br>    main()<br>","like_count":1},{"had_liked":false,"id":135364,"user_name":"Kyle","can_delete":false,"product_type":"c1","uid":1258042,"ip_address":"","ucode":"96DE706AAC9D97","user_header":"https://static001.geekbang.org/account/avatar/00/13/32/3a/2d8a2c67.jpg","comment_is_top":false,"comment_ctime":1569138800,"is_pvip":false,"replies":[{"id":"63779","content":"Good Job","user_name":"ä½œè€…å›å¤","comment_id":135364,"uid":"1306094","ip_address":"","utype":1,"ctime":1577541271,"user_name_real":"cy"}],"discussion_count":1,"race_medal":0,"score":"5864106096","product_id":100021701,"comment_content":"# -*- coding:utf-8 -*-<br># ç½‘æ˜“äº‘éŸ³ä¹ é€šè¿‡æ­Œæ‰‹IDï¼Œç”Ÿæˆè¯¥æ­Œæ‰‹çš„è¯äº‘<br>import requests<br>import os<br>import re<br>import sys<br>from wordcloud import WordCloud<br>import matplotlib.pyplot as plt<br>from PIL import Image<br>import numpy as np<br>import jieba<br>from lxml import etree<br><br>headers = {<br>    &#39;Referer&#39;: &#39;http:&#47;&#47;music.163.com&#39;,<br>    &#39;Host&#39;: &#39;music.163.com&#39;,<br>    &#39;Accept&#39;: &#39;text&#47;html,application&#47;xhtml+xml,application&#47;xml;q=0.9,image&#47;webp,image&#47;apng,*&#47;*;q=0.8&#39;,<br>    &#39;User-Agent&#39;: &#39;Chrome&#47;10&#39;<br>}<br><br># è·å–åˆ°æ­Œå•çš„ä¿¡æ¯<br>def get_song_list(headers,song_list_url):<br>    res = requests.request(&quot;GET&quot;,song_list_url,headers=headers)<br>    if &#39;result&#39; in res.json():<br>        all_song_list = &quot;&quot;<br>        for song_list in res.json()[&#39;result&#39;][&#39;tracks&#39;]:<br>            all_song_list = all_song_list + song_list[&#39;name&#39;]<br>            print(all_song_list)<br>        return all_song_list<br>    else:<br>        return &#39;&#39;<br><br># åˆ›å»ºè¯äº‘å±•ç¤º<br>def wordcloud(f):<br>    print(&quot;æ ¹æ®è¯é¢‘ç»“æœè¿›è¡Œè¯äº‘å±•ç¤ºï¼&quot;)<br>    cut_text = &quot; &quot;.join(jieba.cut(f,cut_all=False,HMM=True))<br>    wc = WordCloud(<br>        font_path=&quot;.&#47;wc.ttf&quot;,<br>        max_words=100,<br>        width=2000,<br>        height=1200,<br>    )<br>    wordcloud = wc.generate(cut_text)<br>    wordcloud.to_file(&quot;song_list_wordcloud.jpg&quot;)<br>    # è¯äº‘å±•ç¤º<br>    plt.imshow(wordcloud)<br>    plt.axis(&quot;off&quot;)<br>    plt.show()<br><br># è·å–æ­Œå•<br>song_list_id = &#39;753776811&#39;<br>song_list_url = &#39;http:&#47;&#47;music.163.com&#47;api&#47;playlist&#47;detail?id=&#39; + song_list_id<br>all_song_list_new = get_song_list(headers,song_list_url)<br>wordcloud(all_song_list_new)","like_count":1,"discussions":[{"author":{"id":1306094,"avatar":"https://static001.geekbang.org/account/avatar/00/13/ed/ee/c4779b67.jpg","nickname":"cy","note":"","ucode":"50D653399A31F6","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":468156,"discussion_content":"Good Job","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1577541271,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":89167,"user_name":"æ»¢","can_delete":false,"product_type":"c1","uid":1221511,"ip_address":"","ucode":"971A6F20AF3F9A","user_header":"https://static001.geekbang.org/account/avatar/00/12/a3/87/c415e370.jpg","comment_is_top":false,"comment_ctime":1556096173,"is_pvip":false,"replies":[{"id":"64220","content":"æ»¢åŒå­¦ä¸é”™å•Š~ ç»å¸¸åšä½œä¸šï¼ŒGood Job","user_name":"ä½œè€…å›å¤","comment_id":89167,"uid":"1306094","ip_address":"","utype":1,"ctime":1577614572,"user_name_real":"cy"}],"discussion_count":1,"race_medal":0,"score":"5851063469","product_id":100021701,"comment_content":"è¯¾åä½œä¸šï¼šè¯­è¨€Python3.6<br>import requests<br>import matplotlib.pyplot as plt<br>from wordcloud import WordCloud<br><br>#åˆ›å»ºè¯·æ±‚å¤´<br>headers = {<br>    &#39;Referer&#39;:&#39;http:&#47;&#47;music.163.com&#39;,<br>    &#39;Host&#39;:&#39;music.163.com&#39;,<br>    &#39;Accept&#39;:&#39;text&#47;html,application&#47;xhtml+xml,application&#47;xml;q=0.9,image&#47;Webp,image&#47;apng,*&#47;*;q=0.8&#39;,<br>    &#39;User-Agent&#39;:&#39;Chrome&#47;10&#39;<br>}<br><br>#è·å–æ­Œå•<br>def get_song_name(req_url):<br>    res = requests.request(&#39;GET&#39;,req_url,headers=headers)<br>    if &#39;tracks&#39; in res.json()[&#39;result&#39;]:<br>        tracks = res.json()[&#39;result&#39;][&#39;tracks&#39;]<br>        names = []<br>        for i in  range(len(tracks)):<br>            name = tracks[i][&#39;name&#39;]<br>            names.append(name)<br>        return names<br>    else:<br>        return &#39;&#39;<br><br>#è¿‡æ»¤åœç”¨è¯<br>def remove_stop_words(text):<br>    stop_words = [&#39;(ä¼´å¥)&#39;,&#39;Bonus Trackï¼š&#39;,&#39;(Demoç‰ˆ)&#39;]<br>    for stop_word in stop_words:<br>        text = text.replace(stop_word,&#39;&#39;)<br>    return text<br><br>path = &#39;&#47;Users&#47;apple&#47;Desktop&#47;GitHubProject&#47;Read mark&#47;æ•°æ®åˆ†æ&#47;geekTime&#47;data&#47;&#39;<br>#è·å¾—è¯äº‘<br>def create_wordcloud(text):<br>    #ç§»é™¤è¿‡æ»¤è¯<br>    text = remove_stop_words(text)<br>    wc = WordCloud(<br>        font_path = &quot;&#47;Library&#47;Fonts&#47;Arial Unicode.ttf&quot;,<br>        max_words = 100,<br>        width = 2000,<br>        height = 1200<br>    )<br>    wordcloud = wc.generate(text)<br>    wordcloud.to_file(path + &#39;wordcloud_homework.jpg&#39;)<br>    plt.imshow(wordcloud)<br>    plt.axis(&#39;off&#39;)<br>    plt.show()<br><br>#å¤„ç†æ­Œå•ï¼Œå½¢æˆè¯äº‘<br>request_url = &#39;http:&#47;&#47;music.163.com&#47;api&#47;playlist&#47;detail?id=753776811&#39;<br>content_list = get_song_name(request_url)<br>content = &quot; &quot;.join(content_list)<br>print(&#39;æ­Œå•ä¿¡æ¯---&#39;,content)<br>create_wordcloud(content)<br><br>--------------<br>æ­Œå•ä¿¡æ¯--- åˆ«å†é—¹äº† åœ¨æ— é£æ—¶ é‚£æ—¶çš„æˆ‘ä»¬ ä»æ— åˆ°æœ‰ ä¸€æ±Ÿæ°´ å€Ÿ æ¶ˆæ„ ä¸æŸ“ ç››å¤ å“å“Ÿ æ— é—® ä¸€è¤ä¸€ç´  å—ä¸€é“è¡— èŠ¬èŠ³ä¸€ç”Ÿ è¯·è®°ä½æˆ‘ é¡¹ç¾½è™å§¬ ç»™ä½ ç»™æˆ‘ æƒ³ä½ æƒ³ä½  æ„æ–™ä¹‹ä¸­ å¹³å‡¡çš„ä¸€å¤© åƒæˆ‘è¿™æ ·çš„äºº æ„Ÿè§‰è‡ªå·±æ˜¯å·¨æ˜Ÿ å¦‚æœæœ‰ä¸€å¤©æˆ‘å˜å¾—å¾ˆæœ‰é’± å€Ÿ (ä¼´å¥) æ¶ˆæ„ (ä¼´å¥) ç››å¤ (ä¼´å¥) å“å“Ÿ (ä¼´å¥) æƒ³ä½ æƒ³ä½  (ä¼´å¥) å—ä¸€é“è¡— (ä¼´å¥) ç»™ä½ ç»™æˆ‘ (ä¼´å¥) èŠ¬èŠ³ä¸€ç”Ÿ (ä¼´å¥) ä¸€è¤ä¸€ç´  (ä¼´å¥) å¹³å‡¡çš„ä¸€å¤© (ä¼´å¥) åƒæˆ‘è¿™æ ·çš„äºº (ä¼´å¥) å¦‚æœæœ‰ä¸€å¤©æˆ‘å˜å¾—å¾ˆæœ‰é’± (ä¼´å¥) å¦‚æœæœ‰ä¸€å¤©æˆ‘å˜å¾—å¾ˆæœ‰é’± (å¿…èƒœå®¢æ–°æ˜¥ç‰ˆ) Bonus Trackï¼šä¸€è¤ä¸€ç´  (Demoç‰ˆ) Bonus Trackï¼šç»™ä½ ç»™æˆ‘ (Demoç‰ˆ)<br>---------------<br>å›¾ç‰‡æ— æ³•å±•ç¤ºï¼Œå¸Œæœ›æå®¢å®è·µçš„PMèƒ½æå‡ºæ”¹è¿›æ–¹æ¡ˆï¼Œå‰ç«¯å’Œåå°å®ç°ä¸€ä¸‹ï¼ˆğŸ˜‚ğŸ˜‚ï¼‰ï¼Œç¥ä¸“æ è¶Šåšè¶Šå¥½","like_count":1,"discussions":[{"author":{"id":1306094,"avatar":"https://static001.geekbang.org/account/avatar/00/13/ed/ee/c4779b67.jpg","nickname":"cy","note":"","ucode":"50D653399A31F6","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":448041,"discussion_content":"æ»¢åŒå­¦ä¸é”™å•Š~ ç»å¸¸åšä½œä¸šï¼ŒGood Job","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1577614572,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":329294,"user_name":"piboye","can_delete":false,"product_type":"c1","uid":1066752,"ip_address":"","ucode":"7CFD8712857A85","user_header":"https://static001.geekbang.org/account/avatar/00/10/47/00/3202bdf0.jpg","comment_is_top":false,"comment_ctime":1641271943,"is_pvip":true,"discussion_count":0,"race_medal":0,"score":"1641271943","product_id":100021701,"comment_content":"æœ‰åœç”¨è¯çš„åº“å—ï¼Ÿ","like_count":0},{"had_liked":false,"id":316858,"user_name":"picoasis","can_delete":false,"product_type":"c1","uid":1217329,"ip_address":"","ucode":"D5113416FF2B14","user_header":"https://static001.geekbang.org/account/avatar/00/12/93/31/abb7bfe3.jpg","comment_is_top":false,"comment_ctime":1634570146,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1634570146","product_id":100021701,"comment_content":"åœ¨åˆ¶ä½œæ­Œè¯äº‘çš„ç¨‹åºä¸­ï¼Œget_song_lyricå‡½æ•°ï¼Œå¢åŠ äº†ä¸€ä¸ªæ­£åˆ™ä¿®æ”¹ï¼Œå»é™¤å¤§éƒ¨åˆ†çš„å·¥ä½œäººå‘˜çš„ä¿¡æ¯ã€‚<br>new_lyric1 = re.sub(r&#39;[\\d:.[\\]]&#39;,&#39;&#39;,lyric) #å»é™¤æ—¶é—´<br>new_lyric = re.sub(r&#39;\\s?.*[(byï¼š)ï¼š:ã€ã€‘@]+.*\\n?&#39;,&#39;&#39;,new_lyric1) #å»é™¤å·¥ä½œäººå‘˜<br><br>å› ä¸ºæ‰“å°æ­Œè¯å¯ä»¥å‘ç°ï¼Œæœ‰å¤§é‡çš„å·¥ä½œäººå‘˜ä¿¡æ¯ï¼ŒåŒºåˆ«äºæ­Œè¯ä¿¡æ¯ï¼Œç¬¦åˆæŸç§æ¨¡å¼ï¼Œè€Œä¸”å·¥ä½œäººå‘˜ä¿¡æ¯å¯¹æ­Œè¯äº‘å±•ç¤ºå½±å“ä¹Ÿå¾ˆå¤§ã€‚<br><br>å·¥ä½œäººå‘˜çš„ä¿¡æ¯ç¤ºä¾‹å¦‚ä¸‹ï¼š<br>             é¼“Drums byï¼šè’äº•åä¸€<br>             è´æ–¯ Bass byï¼šè®¸é’§<br>             å‰ä»– Guitars by  è®¸é’§<br>             é”®ç›˜ï¼†åˆæˆå™¨ Keysï¼†Synth by è®¸é’§<br>             å¼¦ä¹ç¼–å†™ Strings Arranged byï¼šèƒ¡é™æˆã€è®¸é’§<br>             å¼¦ä¹ç›‘åˆ¶ Strings Directed byï¼šèƒ¡é™æˆ<br>         ","like_count":0},{"had_liked":false,"id":307406,"user_name":"Siyige2727","can_delete":false,"product_type":"c1","uid":2723937,"ip_address":"","ucode":"59169A2250DD55","user_header":"https://thirdwx.qlogo.cn/mmopen/vi_32/rZ4LbfVYHpVxdibIvO5EyLwHDicm3R8EkjeibXTv91kMGP7hkNFbZ7NibPjEibVqRO2rXWkTLB96jNUM70RhuyD15GA/132","comment_is_top":false,"comment_ctime":1629085487,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1629085487","product_id":100021701,"comment_content":"Traceback (most recent call last):<br>  File &quot;&lt;input&gt;&quot;, line 58, in &lt;module&gt;<br>  File &quot;&lt;input&gt;&quot;, line 17, in get_song_name<br>KeyError: &#39;result&#39;","like_count":0},{"had_liked":false,"id":282872,"user_name":"é™ˆç‚«å®","can_delete":false,"product_type":"c1","uid":2452447,"ip_address":"","ucode":"A64E64108735C3","user_header":"","comment_is_top":false,"comment_ctime":1615449603,"is_pvip":false,"replies":[{"id":"103524","content":"ç½‘ä¸Šæœç´¢ç½‘æ˜“äº‘APIå¯ä»¥æŸ¥åˆ°","user_name":"ä½œè€…å›å¤","comment_id":282872,"uid":"1306094","ip_address":"","utype":1,"ctime":1616695234,"user_name_real":"cy"}],"discussion_count":1,"race_medal":0,"score":"1615449603","product_id":100021701,"comment_content":"APIæ˜¯æ€ä¹ˆæ‰¾åˆ°çš„ï¼Ÿ","like_count":0,"discussions":[{"author":{"id":1306094,"avatar":"https://static001.geekbang.org/account/avatar/00/13/ed/ee/c4779b67.jpg","nickname":"cy","note":"","ucode":"50D653399A31F6","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":516863,"discussion_content":"ç½‘ä¸Šæœç´¢ç½‘æ˜“äº‘APIå¯ä»¥æŸ¥åˆ°","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1616695234,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":257452,"user_name":"è¿›å‡»çš„çŸ®å­","can_delete":false,"product_type":"c1","uid":2218372,"ip_address":"","ucode":"39173CF9584C51","user_header":"https://static001.geekbang.org/account/avatar/00/21/d9/84/f1b10393.jpg","comment_is_top":false,"comment_ctime":1603976091,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1603976091","product_id":100021701,"comment_content":"ä¸é”™,è™½ç„¶è¿™äº›çŸ¥è¯†ç‚¹éƒ½ä¼š,ä½†å¤ç”¨è¾ƒå¼º,æ”¹ä¸ªidå°±æ˜¯å¦ä¸€ä¸ªæ­Œæ‰‹äº†,åªæ˜¯stopwordsä¹Ÿéœ€è¦æ”¹å˜","like_count":0},{"had_liked":false,"id":239830,"user_name":"Geeky_Ben","can_delete":false,"product_type":"c1","uid":1981878,"ip_address":"","ucode":"4889BFC8BF6EB3","user_header":"https://static001.geekbang.org/account/avatar/00/1e/3d/b6/e4a72acc.jpg","comment_is_top":false,"comment_ctime":1596674442,"is_pvip":false,"replies":[{"id":"103503","content":"wc = WordCloud(<br>       font_path=&quot;.&#47;wc.ttf&quot;,<br>       max_words=100,<br>       width=2000,<br>       height=1200,<br>    )<br>å…¶ä¸­font_pathå¯¹åº”çš„å­—ä½“è·¯å¾„ï¼Œæ”¹æˆä½ ç”µè„‘ä¸Šçš„è·¯å¾„å³å¯","user_name":"ä½œè€…å›å¤","comment_id":239830,"uid":"1306094","ip_address":"","utype":1,"ctime":1616690132,"user_name_real":"cy"}],"discussion_count":3,"race_medal":0,"score":"1596674442","product_id":100021701,"comment_content":"è€å¸ˆï¼Œä¸ºä»€ä¹ˆæˆ‘çš„ç»“æœæ˜¾ç¤º cannot open resource","like_count":1,"discussions":[{"author":{"id":1306094,"avatar":"https://static001.geekbang.org/account/avatar/00/13/ed/ee/c4779b67.jpg","nickname":"cy","note":"","ucode":"50D653399A31F6","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":503240,"discussion_content":"wc = WordCloud(\n       font_path=&amp;quot;./wc.ttf&amp;quot;,\n       max_words=100,\n       width=2000,\n       height=1200,\n    )\nå…¶ä¸­font_pathå¯¹åº”çš„å­—ä½“è·¯å¾„ï¼Œæ”¹æˆä½ ç”µè„‘ä¸Šçš„è·¯å¾„å³å¯","likes_number":1,"is_delete":false,"is_hidden":false,"ctime":1616690132,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":2273809,"avatar":"https://static001.geekbang.org/account/avatar/00/22/b2/11/455601cc.jpg","nickname":"Brown_W","note":"","ucode":"B2B5A98552BE47","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":324837,"discussion_content":"å­—ä½“æ¢ä¸€ä¸‹å°±å¥½äº†","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1605179421,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1914963,"avatar":"https://static001.geekbang.org/account/avatar/00/1d/38/53/738fa9b2.jpg","nickname":"7Color_æåº·é¾™","note":"","ucode":"0BCB00135C3F79","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":299984,"discussion_content":"æˆ‘ä¹Ÿæ˜¯\n","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1597897597,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":225899,"user_name":"å¦‚æœ","can_delete":false,"product_type":"c1","uid":1903660,"ip_address":"","ucode":"B34F3C5F304B4E","user_header":"https://static001.geekbang.org/account/avatar/00/1d/0c/2c/e905e970.jpg","comment_is_top":false,"comment_ctime":1591885068,"is_pvip":false,"replies":[{"id":"103736","content":"æ‰“å¼€å¼€å‘è€…å·¥å…·â€”â€”æ‰¾åˆ°https:&#47;&#47;music.163.com&#47;#&#47;artist?id=12138269å¯¹åº”çš„DOCæ–‡ä»¶ï¼Œåœ¨Requests Headersä¸­å¯ä»¥æ‰¾åˆ°acceptå¯¹åº”çš„å€¼ã€‚","user_name":"ä½œè€…å›å¤","comment_id":225899,"uid":"1306094","ip_address":"","utype":1,"ctime":1617039309,"user_name_real":"cy"}],"discussion_count":1,"race_medal":0,"score":"1591885068","product_id":100021701,"comment_content":"è€å¸ˆä½ å¥½ï¼Œè¯·é—®ä¸‹headeré‡Œçš„Acceptå‚æ•°æ˜¯æ€ä¹ˆæ¥çš„","like_count":0,"discussions":[{"author":{"id":1306094,"avatar":"https://static001.geekbang.org/account/avatar/00/13/ed/ee/c4779b67.jpg","nickname":"cy","note":"","ucode":"50D653399A31F6","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":498033,"discussion_content":"æ‰“å¼€å¼€å‘è€…å·¥å…·â€”â€”æ‰¾åˆ°https://music.163.com/#/artist?id=12138269å¯¹åº”çš„DOCæ–‡ä»¶ï¼Œåœ¨Requests Headersä¸­å¯ä»¥æ‰¾åˆ°acceptå¯¹åº”çš„å€¼ã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1617039309,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":205684,"user_name":"JustDoDT","can_delete":false,"product_type":"c1","uid":1127175,"ip_address":"","ucode":"6AF0B80F00EAEF","user_header":"https://static001.geekbang.org/account/avatar/00/11/33/07/8f351609.jpg","comment_is_top":false,"comment_ctime":1586702015,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1586702015","product_id":100021701,"comment_content":"äº¤ä½œä¸šï¼š<br>https:&#47;&#47;github.com&#47;LearningChanging&#47;Data-analysis-in-action&#47;tree&#47;master&#47;38-%E6%95%B0%E6%8D%AE%E5%8F%AF%E8%A7%86%E5%8C%96%E5%AE%9E%E6%88%98%EF%BC%9A%E5%A6%82%E4%BD%95%E7%BB%99%E6%AF%9B%E4%B8%8D%E6%98%93%E7%9A%84%E6%AD%8C%E6%9B%B2%E5%81%9A%E8%AF%8D%E4%BA%91%E5%B1%95%E7%A4%BA%EF%BC%9F","like_count":0},{"had_liked":false,"id":196690,"user_name":"å¼ è´º","can_delete":false,"product_type":"c1","uid":1283181,"ip_address":"","ucode":"0254E40FB3EB5F","user_header":"https://static001.geekbang.org/account/avatar/00/13/94/6d/5cd6e8c7.jpg","comment_is_top":false,"comment_ctime":1585303093,"is_pvip":true,"discussion_count":0,"race_medal":0,"score":"1585303093","product_id":100021701,"comment_content":"æµ…æ˜¾æ˜“æ‡‚","like_count":0},{"had_liked":false,"id":161967,"user_name":"GS","can_delete":false,"product_type":"c1","uid":1042618,"ip_address":"","ucode":"21C73A8CBD8093","user_header":"https://static001.geekbang.org/account/avatar/00/0f/e8/ba/6d318c08.jpg","comment_is_top":false,"comment_ctime":1576418593,"is_pvip":false,"replies":[{"id":"62581","content":"èµ è®¤çœŸåšä½œä¸šçš„GSåŒå­¦","user_name":"ä½œè€…å›å¤","comment_id":161967,"uid":"1306094","ip_address":"","utype":1,"ctime":1577070857,"user_name_real":"cy"}],"discussion_count":1,"race_medal":0,"score":"1576418593","product_id":100021701,"comment_content":"https:&#47;&#47;github.com&#47;leledada&#47;jupyter&#47;tree&#47;master&#47;wordcloud","like_count":0,"discussions":[{"author":{"id":1306094,"avatar":"https://static001.geekbang.org/account/avatar/00/13/ed/ee/c4779b67.jpg","nickname":"cy","note":"","ucode":"50D653399A31F6","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":477929,"discussion_content":"èµ è®¤çœŸåšä½œä¸šçš„GSåŒå­¦","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1577070857,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":161568,"user_name":"GS","can_delete":false,"product_type":"c1","uid":1042618,"ip_address":"","ucode":"21C73A8CBD8093","user_header":"https://static001.geekbang.org/account/avatar/00/0f/e8/ba/6d318c08.jpg","comment_is_top":false,"comment_ctime":1576234425,"is_pvip":false,"replies":[{"id":"62595","content":"æœ‰å¼‚å¸¸å¤„ç†ï¼Œå¾ˆå¥½","user_name":"ä½œè€…å›å¤","comment_id":161568,"uid":"1306094","ip_address":"","utype":1,"ctime":1577072761,"user_name_real":"cy"}],"discussion_count":1,"race_medal":0,"score":"1576234425","product_id":100021701,"comment_content":" if &#39;lrc&#39; in res.json():<br>        try:<br>            lyric = res.json()[&#39;lrc&#39;][&#39;lyric&#39;]<br>            new_lyric = re.sub(r&#39;[\\d:.[\\]]&#39;,&#39;&#39;,lyric)<br>            return new_lyric<br>        except:<br>            print(&#39;å‘ç”Ÿäº†å¼‚å¸¸-----------------------------------&#39;,lyric_url)<br>            return &#39;&#39;<br>    else:<br>        return &#39;&#39;","like_count":0,"discussions":[{"author":{"id":1306094,"avatar":"https://static001.geekbang.org/account/avatar/00/13/ed/ee/c4779b67.jpg","nickname":"cy","note":"","ucode":"50D653399A31F6","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":477765,"discussion_content":"æœ‰å¼‚å¸¸å¤„ç†ï¼Œå¾ˆå¥½","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1577072761,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":161567,"user_name":"GS","can_delete":false,"product_type":"c1","uid":1042618,"ip_address":"","ucode":"21C73A8CBD8093","user_header":"https://static001.geekbang.org/account/avatar/00/0f/e8/ba/6d318c08.jpg","comment_is_top":false,"comment_ctime":1576233892,"is_pvip":false,"replies":[{"id":"62584","content":"å¯¹çš„ å¾ˆå¥½çš„å»ºè®®","user_name":"ä½œè€…å›å¤","comment_id":161567,"uid":"1306094","ip_address":"","utype":1,"ctime":1577070934,"user_name_real":"cy"}],"discussion_count":1,"race_medal":0,"score":"1576233892","product_id":100021701,"comment_content":"è§£ææ­Œè¯çš„æ—¶å€™æœ€å¥½æ˜¯ç”¨try except åŒ…èµ·æ¥ï¼Œä¸ç„¶é‡åˆ°å¼‚å¸¸å°±ä¸èµ°äº†","like_count":0,"discussions":[{"author":{"id":1306094,"avatar":"https://static001.geekbang.org/account/avatar/00/13/ed/ee/c4779b67.jpg","nickname":"cy","note":"","ucode":"50D653399A31F6","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":477764,"discussion_content":"å¯¹çš„ å¾ˆå¥½çš„å»ºè®®","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1577070934,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":161178,"user_name":"#Yema","can_delete":false,"product_type":"c1","uid":1356100,"ip_address":"","ucode":"DEB70927BCC792","user_header":"https://static001.geekbang.org/account/avatar/00/14/b1/44/a0ccff54.jpg","comment_is_top":false,"comment_ctime":1576137918,"is_pvip":false,"replies":[{"id":"62640","content":"ç½‘æ˜“äº‘éŸ³ä¹æœ‰ä¸€äº›APIæ¥å£ï¼Œæ¯”å¦‚æ­Œè¯ï¼Œæ­Œæ›²ä¿¡æ¯ï¼Œå…³é”®è¯æœç´¢","user_name":"ä½œè€…å›å¤","comment_id":161178,"uid":"1306094","ip_address":"","utype":1,"ctime":1577080038,"user_name_real":"cy"}],"discussion_count":2,"race_medal":0,"score":"1576137918","product_id":100021701,"comment_content":"lyric_url = &#39;http:&#47;&#47;music.163.com&#47;api&#47;song&#47;lyric?os=pc&amp;id=&#39; + str(song_id) + &#39;&amp;lv=-1&amp;kv=-1<br>è€å¸ˆèƒ½è§£é‡Šä¸€ä¸‹è¿™ä¸ªurlæ˜¯ä»å“ªæ‰¾åˆ°çš„å—ï¼Ÿä¸ºä»€ä¹ˆåœ¨æµè§ˆå™¨æŠ“åŒ…é‡Œé¢æ²¡æœ‰æ‰¾åˆ°è¿™ä¸ªapiï¼Œæˆ‘æ‰¾åˆ°çš„apiæ˜¯ä¸€ä¸ªå¼‚æ­¥éœ€è¦å‘apiä¼ csrf_tokenæ‰èƒ½æ‹¿åˆ°æ­Œè¯","like_count":0,"discussions":[{"author":{"id":1306094,"avatar":"https://static001.geekbang.org/account/avatar/00/13/ed/ee/c4779b67.jpg","nickname":"cy","note":"","ucode":"50D653399A31F6","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":477628,"discussion_content":"ç½‘æ˜“äº‘éŸ³ä¹æœ‰ä¸€äº›APIæ¥å£ï¼Œæ¯”å¦‚æ­Œè¯ï¼Œæ­Œæ›²ä¿¡æ¯ï¼Œå…³é”®è¯æœç´¢","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1577080038,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1303362,"avatar":"https://static001.geekbang.org/account/avatar/00/13/e3/42/bcab280f.jpg","nickname":"ğŸ³Echo","note":"","ucode":"9FB56F144F1C57","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":337593,"discussion_content":"æˆ‘ä¹Ÿæ˜¯æœ‰åŒæ ·çš„é—®é¢˜ï¼Œæˆ‘ç™¾åº¦æœäº†ä¸‹æ–‡æ¡£ï¼Œä¹Ÿæ²¡æ‰¾åˆ°è€å¸ˆç”¨çš„æ¥å£- -\n","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1608985027,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":97254,"user_name":"æŒ å¤´ä¾ ","can_delete":false,"product_type":"c1","uid":1150474,"ip_address":"","ucode":"F96966832E2252","user_header":"https://static001.geekbang.org/account/avatar/00/11/8e/0a/31ec5392.jpg","comment_is_top":false,"comment_ctime":1558620722,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1558620722","product_id":100021701,"comment_content":"è€å¸« é€™å€‹æ­Œæ›²é é¢ä¸æ˜¯åŠ¨æ€åŠ è½½çš„å—ï¼Œæ€ä¹ˆå¯ä»¥ç›´æ¥ç”¨requestså‘€","like_count":0},{"had_liked":false,"id":97200,"user_name":"æŒ å¤´ä¾ ","can_delete":false,"product_type":"c1","uid":1150474,"ip_address":"","ucode":"F96966832E2252","user_header":"https://static001.geekbang.org/account/avatar/00/11/8e/0a/31ec5392.jpg","comment_is_top":false,"comment_ctime":1558608107,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1558608107","product_id":100021701,"comment_content":"è€å¸ˆå¯ä»¥ä»‹ç»ä¸€ä¸‹jiebaä¸­HMMå‚æ•°çš„ä½œç”¨å—","like_count":0},{"had_liked":false,"id":79536,"user_name":"ä¸Šå®˜","can_delete":false,"product_type":"c1","uid":1353145,"ip_address":"","ucode":"037968A8E0C566","user_header":"http://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTJAeZ2VCia2y3bW9N7EMfgBqX8WClXUydwaXDPcK7Bm3XaMnMKx7q5ffA0UuTeJmEusxtQAibf8djCA/132","comment_is_top":false,"comment_ctime":1553505877,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1553505877","product_id":100021701,"comment_content":"Traceback (most recent call last):<br>  File &quot;&#47;Users&#47;shangguan&#47;PycharmProjects&#47;LicenseRecognition&#47;geci.py&quot;, line 85, in &lt;module&gt;<br>    [song_ids, song_names] = get_songs(artist_id)<br>TypeError: &#39;NoneType&#39; object is not iterable<br><br>ä¸ºä»€ä¹ˆæŠ¥nonetypeï¼Ÿ<br>","like_count":0},{"had_liked":false,"id":75734,"user_name":"ç‹å½¬æˆ","can_delete":false,"product_type":"c1","uid":1015045,"ip_address":"","ucode":"386803B8FC2DD5","user_header":"https://static001.geekbang.org/account/avatar/00/0f/7d/05/4bad0c7c.jpg","comment_is_top":false,"comment_ctime":1552460905,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1552460905","product_id":100021701,"comment_content":"é¢˜ç›®ç†è§£ï¼ˆ1ï¼‰ï¼šå°†æ­Œå•çš„æ­Œæ›²åç§°ä½œè¯äº‘å±•ç¤º<br>-------<br>import requests<br>import jieba<br>from wordcloud import WordCloud<br>import matplotlib.pyplot as plt<br><br>headers = {<br>       &#39;Referer&#39;  :&#39;http:&#47;&#47;music.163.com&#39;,<br>       &#39;Host&#39;     :&#39;music.163.com&#39;,<br>       &#39;Accept&#39;   :&#39;text&#47;html,application&#47;xhtml+xml,application&#47;xml;q=0.9,image&#47;webp,image&#47;apng,*&#47;*;q=0.8&#39;,<br>       &#39;User-Agent&#39;:&#39;Chrome&#47;10&#39;<br>    }<br><br>#å¾—åˆ°æŒ‡å®šæ­Œå•é¡µé¢çš„ å…¨éƒ¨æ­Œæ›²çš„æ­Œæ›²IDï¼Œæ­Œæ›²å<br>def get_songs(playlist_id):<br>    page_url=&#39;http:&#47;&#47;music.163.com&#47;api&#47;playlist&#47;detail?id=&#39;+playlist_id<br>    #è·å–ç½‘é¡µHTML<br>    res=requests.request(&#39;GET&#39;,page_url,headers=headers)<br>    # è¾“å‡ºæ­Œå•ä¸­æ­Œæ›²æ•°é‡<br>    print(len(res.json()[&#39;result&#39;][&#39;tracks&#39;]))<br><br>    # è®¾ç½®çƒ­é—¨æ­Œæ›²çš„IDï¼Œæ­Œæ›²åç§°<br>    song_ids=[]<br>    song_names=[]<br><br>    for i in range(len(res.json()[&#39;result&#39;][&#39;tracks&#39;])):<br>        names=res.json()[&#39;result&#39;][&#39;tracks&#39;][i][&#39;name&#39;]<br>        ids=res.json()[&#39;result&#39;][&#39;tracks&#39;][i][&#39;id&#39;]<br>        song_names.append(names)<br>        song_ids.append(ids)<br>        print(names,&#39; &#39;,ids)<br>    return song_names,song_ids<br><br>#å»æ‰åœç”¨è¯<br>def remove_stop_words(f):<br>    stop_words=[&#39;Demo&#39;,&#39;ä¼´å¥&#39;,&#39;ç‰ˆ&#39;,&#39;å¿…èƒœå®¢&#39;,&#39;Bonus&#39;,&#39;Track&#39;]<br>    for stop_word in stop_words:<br>        f=f.replace(stop_word,&#39;&#39;)<br>    return f<br><br>#ç”Ÿæˆè¯äº‘<br>def create_word_cloud(f):<br>    print(&#39;æ ¹æ®è¯é¢‘ ç”Ÿæˆè¯äº‘&#39;)<br>    f=remove_stop_words(f)<br>    cut_text=&#39; &#39;.join(jieba.cut(f,cut_all=False,HMM=True))<br>    wc = WordCloud(<br>       font_path=&quot;.&#47;wc.ttf&quot;,<br>       max_words=100,<br>       width=2000,<br>       height=1200,<br>    )<br>    print(cut_text)<br>    wordcloud = wc.generate(cut_text)<br>    # å†™è¯äº‘å›¾ç‰‡<br>    wordcloud.to_file(&quot;wordcloud.jpg&quot;)<br>    # æ˜¾ç¤ºè¯äº‘æ–‡ä»¶<br>    plt.imshow(wordcloud)<br>    plt.axis(&quot;off&quot;)<br>    plt.show()<br>    <br><br># è®¾ç½®æ­Œå•IDï¼Œã€æ¯›ä¸æ˜“ | ä¸å–„è¨€è¾çš„æ·±æƒ…ã€‘ä¸º753776811<br>playlist_id=&#39;753776811&#39;<br>[song_names,song_ids]=get_songs(playlist_id)<br><br># å°†åˆ—è¡¨song_namesç”Ÿæˆå­—ç¬¦ä¸²<br>song_names_text=&quot; &quot;.join(song_names)<br><br>#æ ¹æ®è¯é¢‘ï¼Œç”Ÿæˆè¯äº‘<br>create_word_cloud(song_names_text)","like_count":0},{"had_liked":false,"id":74915,"user_name":"å¿—","can_delete":false,"product_type":"c1","uid":1307922,"ip_address":"","ucode":"805696CC72A0E2","user_header":"https://static001.geekbang.org/account/avatar/00/13/f5/12/a5383fff.jpg","comment_is_top":false,"comment_ctime":1552312973,"is_pvip":false,"replies":[{"id":"64438","content":"Good Job","user_name":"ä½œè€…å›å¤","user_name_real":"cy","uid":"1306094","ctime":1577619290,"ip_address":"","comment_id":74915,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1552312973","product_id":100021701,"comment_content":"æ€è€ƒé¢˜å…³é”®ä»£ç éƒ¨åˆ†ï¼š<br><br>import time<br>id_list = []<br>name_list = []<br># å¾—åˆ°æŸä¸€æ­Œå•é‡Œçš„æ¯ä¸€é¦–æ­ŒIDå’Œæ­Œå<br>def get_song_list(headers,list_url):<br>    res = requests.request(&#39;GET&#39;, list_url, headers=headers)<br>    if &#39;result&#39; in res.json():<br>        for item in res.json()[&#39;result&#39;][&#39;tracks&#39;]:   # è¯»å–jsonæ•°æ®ä¸­çš„æ¯ä¸€ä¸ªIDå’Œname<br>            id_list.append(item[&#39;id&#39;]) <br>            name_list.append(item[&#39;name&#39;])<br>            print(item[&#39;id&#39;],&quot; &quot;,item[&#39;name&#39;])<br>            time.sleep(1)      # è®¾ç½®åœç•™æ—¶é—´ï¼Œé˜²æ­¢â€œbad handshakeâ€<br>        return id_list,name_list<br>    else:<br>        return &#39;&#39;<br>        print(res.json())<br>        <br># è®¾ç½®æ­Œå•é“¾æ¥<br>list_url = &#39;https:&#47;&#47;music.163.com&#47;api&#47;playlist&#47;detail?id=753776811&#39;<br># è·å¾—æ­Œå•æ¯ä¸€é¦–æ­Œçš„IDå’Œname<br>get_song_list(headers,list_url)   <br>     <br>all_word_list = &#39;&#39;<br># è·å–æ¯é¦–æ­Œæ­Œè¯<br>for (song_id, song_name) in zip(id_list, name_list):<br>    # æ­Œè¯ API URL<br>    lyric_url = &#39;http:&#47;&#47;music.163.com&#47;api&#47;song&#47;lyric?os=pc&amp;id=&#39; + str(song_id) + &#39;&amp;lv=-1&amp;kv=-1&amp;tv=-1&#39;<br>    lyric = get_song_lyric(headers, lyric_url)<br>    all_word_list = all_word_list + &#39; &#39; + lyric<br>    print(song_name)<br>    <br># å»æ‰åœç”¨è¯<br>remove_stop_words(all_word_list)<br><br># æ ¹æ®è¯é¢‘ ç”Ÿæˆè¯äº‘<br>create_word_cloud(all_word_list)   ","like_count":0,"discussions":[{"author":{"id":1306094,"avatar":"https://static001.geekbang.org/account/avatar/00/13/ed/ee/c4779b67.jpg","nickname":"cy","note":"","ucode":"50D653399A31F6","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":442736,"discussion_content":"Good Job","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1577619290,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":74732,"user_name":"ä¸Šå–„è‹¥æ°´","can_delete":false,"product_type":"c1","uid":1432353,"ip_address":"","ucode":"FEECBBA65AC0CD","user_header":"https://static001.geekbang.org/account/avatar/00/15/db/21/26ff0240.jpg","comment_is_top":false,"comment_ctime":1552288349,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1552288349","product_id":100021701,"comment_content":"Traceback (most recent call last):<br>  File &quot;C:\\Program Files\\Python37\\lib\\site-packages\\IPython\\core\\interactiveshell.py&quot;, line 3267, in run_code<br>    exec(code_obj, self.user_global_ns, self.user_ns)<br>  File &quot;&lt;ipython-input-2-d883ef070907&gt;&quot;, line 1, in &lt;module&gt;<br>è¿è¡ŒæŠ¥é”™ï¼Œè¯·é—®æ˜¯ä»€ä¹ˆåŸå› ï¼Ÿ","like_count":0}]}