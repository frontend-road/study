{"id":113826,"title":"101 | 复杂列表页实现方案及IGListKit浅析","content":"<p><strong>PDF 课件和源代码下载地址：</strong></p><p><a href=\"https://gitee.com/geektime-geekbang/geektime-ios-course\">https://gitee.com/geektime-geekbang/geektime-ios-course</a></p>","comments":[{"had_liked":false,"id":188950,"user_name":"Geek_505ea2","can_delete":false,"product_type":"c3","uid":1797565,"ip_address":"","ucode":"62B07AAF7F6341","user_header":"https://static001.geekbang.org/account/avatar/00/1b/6d/bd/00fdade3.jpg","comment_is_top":false,"comment_ctime":1584438467,"is_pvip":false,"replies":[{"id":74581,"content":"我这边用 IGListKit (3.4.0) 这个版本跑起来没有发现这个问题。从断点和现象来看，应该是在设置listAdapter的collectionView属性时，IGListKit 强制要求这个collectionView必须要是IGListCollectionView的类型。我这边用当前的版本看源码没有这个IGParameterAssert，同时IGListAdapter中collectionView也声明的是UICollectionView。可以看下你这边IGListKit的版本，或者升级下IGListKit看下。如果还是没有解决问题，可以上传下代码我帮你看下","user_name":"作者回复","user_name_real":"zzz","uid":1041455,"ctime":1585379221,"ip_address":"","comment_id":188950,"utype":1}],"discussion_count":1,"race_medal":0,"score":2,"product_id":100025901,"comment_content":"IGParameterAssert([collectionView isKindOfClass:[IGListCollectionView class]]);\n老师您的源码run起来后打开推荐页面会崩溃，打了全局断点发现是\n  _listAdapter.collectionView = _collectionView;\n引起的，请问这个问题怎么是因为我的sdk版本太低了吗","like_count":0,"discussions":[{"author":{"id":1041455,"avatar":"http://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTKJ3dLlYr6tznfnZXJNsD7Jw48BVnFSib3RO3VWEN0pgebRY1jaR8YXLQ6iaAjTsFiamOWSA3UPAa37A/132","nickname":"Geek_e7jq8k","note":"","ucode":"352964E5D793DA","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":487574,"discussion_content":"我这边用 IGListKit (3.4.0) 这个版本跑起来没有发现这个问题。从断点和现象来看，应该是在设置listAdapter的collectionView属性时，IGListKit 强制要求这个collectionView必须要是IGListCollectionView的类型。我这边用当前的版本看源码没有这个IGParameterAssert，同时IGListAdapter中collectionView也声明的是UICollectionView。可以看下你这边IGListKit的版本，或者升级下IGListKit看下。如果还是没有解决问题，可以上传下代码我帮你看下","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1585379221,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":285150,"user_name":"Geek_b06087","can_delete":false,"product_type":"c3","uid":2403434,"ip_address":"","ucode":"6177875679AD32","user_header":"","comment_is_top":false,"comment_ctime":1616643289,"is_pvip":false,"replies":null,"discussion_count":0,"race_medal":0,"score":2,"product_id":100025901,"comment_content":"你好 请问一下 IGListKit的sectionController是按照不同类型的顺序展示的，比如说aCell都在一起用aSectionController，然后是bCell用bSectionController，然后是cCell用cSectionController这种布局样式。假如是页面的样式是几个aCell，然后几个bCell，然后再是几个aCell，然后才是从cCell。这种该怎么处理呢？我需要把第二个aCell合并到CSectionController处理么（给CSectionController添加两种cell样式）？或者是使用其他的方式？谢谢。\nfunc objects(for listAdapter: IGListAdapter) -&gt; [IGListDiffable] {\n    var items: [IGListDiffable] = [wxScanner.currentWeather] &#47;&#47; 这是一种a样式\n    items += pathfinder.messages as [IGListDiffable] &#47;&#47; b样式\n    items += loader.entries as [IGListDiffable] &#47;&#47; c样式\n    items += [wxScanner.currentWeather] as [IGListDiffable] &#47;&#47; a样式\n    items += pathfinder.messages as [IGListDiffable] &#47;&#47; b样式\n\n\n    return items.sorted(by: { (left: Any, right: Any) -&gt; Bool in\n      if let left = left as? DateSortable, let right = right as? DateSortable {\n        return left.date &gt; right.date\n      }\n      return false\n    })\n  }\nfunc listAdapter(_ listAdapter: IGListAdapter, sectionControllerFor object: Any) -&gt; IGListSectionController &amp; IGListSectionType {\n        if object is Message {\n          return MessageSectionController() &#47;&#47; b样式的sectionController\n        } else if object is Weather {\n          return WeatherSectionController() &#47;&#47; a样式的sectionController\n        } else {\n          return JournalSectionController() &#47;&#47; c样式的sectionController\n        }\n    }\n\n","like_count":0}]}