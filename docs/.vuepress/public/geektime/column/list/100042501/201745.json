{"id":201745,"title":"28丨案例：带宽消耗以及Swap（下）","content":"<p>上一篇文章我主要分析了带宽消耗，今天，我们来看一下分析的第二和第三阶段，也就是Swap分析和数据库分析。</p><h2>分析的第二阶段</h2><h3>Swap的原理和对TPS的影响</h3><p>前面有一个扣，是说swap多的问题。要理解swap为什么是黄的，得先知道什么是swap。我先画个简易的示意图。</p><p><img src=\"https://static001.geekbang.org/resource/image/1f/e5/1fd061cbf986f9cea3509bd4699ddbe5.jpg?wh=285*111\" alt=\"\"></p><p>这里先解释一下，对于一个Linux系统来说，如果配置并开启了swap分区，那么默认的swappiness参数是60。</p><p>swappiness是在内存reclaim的时候生效的，而reclaim方式同时有两个动作：1. 将file相关内存进行回收；2. 将anon内存交换到swap分区。</p><p>所以swapiness值越大，swap分区就用得越多。</p><p>对我们现在分析的这个系统来说，来看一下：</p><p><img src=\"https://static001.geekbang.org/resource/image/e2/7f/e29ec84d980fb9e667e41010b209427f.png?wh=735*268\" alt=\"\"></p><p>我们看到这里配置了一个内存为8G左右，已经使用了7G多了，swappiness配置为30%。</p><p>通过free看到现在只有145M的物理内存剩余，可用内存也只有254M了。<br>\n所以上面图中的swap飘黄也是很合理的喽！</p><p>下面我们就针对应用服务器的swap来看是不是可优化。</p><p>所有人都知道，当swap被用的时候，性能肯定会下降，所以在我的测试过程中，一般我都建议把swap直接关掉测试性能，有人说这样有什么问题？</p><!-- [[[read_end]]] --><p>那就是没有swap，让不常用的对象直接占用物理内存，如果物理内存不够用，就把对象删了，后面再创建，这时会增加的是major fault，那就增加好了，反正是要性能差的。</p><p>说得如此硬气，那在生产中怎么办呢？开还是关？有人觉得关了心里有安稳，有人觉得开着心里会安稳。而一个\b系统、一个容器、一个节点，如果容量控制的非常好的情况下，我建议关掉。开着它，也只是心里上的安慰，不会有TPS处理能力上的提升。</p><h3>瓶颈分析定位</h3><p>既然知道了上面的大概原理。对一个运行Tomcat应用的服务器来说，那肯定是要先检查一下JVM设置为多大。先执行ps命令，看一下Java进程吧。</p><p><img src=\"https://static001.geekbang.org/resource/image/8d/ba/8d6525787d1234c738f629389b5da5ba.png?wh=1359*180\" alt=\"\"></p><p>关键参数如下：</p><pre><code>JAVA_OPTS=&quot;$JAVA_OPTS -server -Xms2048M -Xmx8192m -XX:PermSize=256M -XX:MaxNewSize=2790m -XX:MaxPermSize=512m -XX:SurvivorRatio=8&quot;\n</code></pre><p>JVM是1.8.0_65。</p><p>这个参数配置有很大的问题。物理内存只有8个G，一个JVM heap就配置了8G，这让其他的东西怎么玩得起来？并且JDK是1.8了，配置permsize是又为啥呢？</p><p>虽说有多个地方配置不合理，但是我们也得要知道一下应该配置多少是合理的吧。</p><p>看参数的时候，JMX也配置上了，那就用工具来看吧。</p><p>首先来看一下系统资源。先看一下系统资源在压力下的表现：</p><p><img src=\"https://static001.geekbang.org/resource/image/ef/66/ef8154abc5d60e04752a5d9ea29d4966.png?wh=686*503\" alt=\"\"></p><ol>\n<li>队列已经出现，CS 2万多，in 2万多，说多不多。我们可以先放着。</li>\n<li>I/O没什么\b压力，swap也一直有值，我们要解决的就是它。</li>\n<li>us：sy接近2：1，这个是不良信号，记在心里，后面再说。</li>\n</ol><p>其次再看下JVM的情况：</p><p><img src=\"https://static001.geekbang.org/resource/image/d8/f1/d84de678e28c64b46b1b69b8b30b77f1.png?wh=1652*900\" alt=\"\"></p><p>CPU使用在应用上的时间达到60%，GC上没耗什么时间，并且从堆的回收\b能力上来看，比较正常，只是只用到了3G左右，这里有必要给8G吗？</p><p>线程活动的达到347，看起来还是在增加的，这里也可能是个问题点，只是现在我们不用关心，它还没跳出来。</p><p>从这个JVM状态上来看，它完全用不到8G。在这种状态下，还有另一个Tomat，并且另一个Tomcat中也没有配置-Xmx -Xms参数，当没有配置时，默认-Xmx是物理内存的1/4。再加上thread用的，所以swap飘黄也是吻合的。</p><h3>优化结果</h3><p>首先，我们把JVM配置成最简，JVM设置为4G。</p><pre><code>JAVA_OPTS=&quot;$JAVA_OPTS -server -Xms4096M -Xmx4096m&quot;\n</code></pre><p>perm区在1.8里都没有了，这几个参数也没啥用。在我的习惯中，MaxNewSize也是先看要用到多少，再决定配置不配置。有些应用自己不熟悉，也无法直接给出配置，只有测试之后再配置。</p><p>各部分配置为多大，都没有定数，要通过测试看需要多少。</p><p>而我们现在最重要的是先把性能调整上去，再考虑这些细节内容。这样修改JVM就是为了把物理内存使用率低下来，先不修改swapiness的比例是为了看下结果，如果用不到swap就不再调了，如果还是用了swap，再来调它。</p><p>当我们把JVM修改了之后，再执行起来场景。看到内容如下：</p><p><img src=\"https://static001.geekbang.org/resource/image/40/44/40116bf5ff367647f3f41143fd47fd44.png?wh=1494*895\" alt=\"\"></p><p>CPU使用率相对前面没有什么变化，但是堆4G只用到了1.5G，可见这个堆连4G都用不到。当然我们还是要分析下其他的内容。</p><p>还记得我们要解决的是什么问题吧？swap飘黄了！</p><p><img src=\"https://static001.geekbang.org/resource/image/d8/1f/d8ec1c105537e046a98440790462f91f.png?wh=1306*866\" alt=\"\"></p><p>从这张图可以看到Swapping不\b报警了！CPU占用70%左右。说明现在available的内存是充足的。</p><p>这时我们再看一下系统资源，首先是应用服务器系统资源。</p><p>应用服务器系统资源vmstat如下：</p><p><img src=\"https://static001.geekbang.org/resource/image/10/67/1002a324619b0fe3ba5d6a0d7af53e67.png?wh=682*572\" alt=\"\"></p><p>应用服务器系统资源top：</p><p><img src=\"https://static001.geekbang.org/resource/image/61/41/61b13011e46b803fef61dde5030e4541.png?wh=601*112\" alt=\"\"></p><p>应用服务器系统资源iftop:</p><p><img src=\"https://static001.geekbang.org/resource/image/41/de/4109d34df75fed3d71cdc842d516d9de.png?wh=387*63\" alt=\"\"></p><p>上图中可以看到，对比之前的资源，swap基本上没有了，CPU使用率多起来了。但是队列依旧长，sy CPU消耗还是有点多了。</p><p>应用服务器的si已经到了13.1%了，这个值要关注下，暂时还不能说是问题，但是接着增加下去，肯定会是问题。</p><p>网络已经超过70Mbps了，峰值上到87Mbps，这是一个好事，它说明现在处理的业务量确定多了。</p><p>接下来是数据库服务器系统资源：</p><p><img src=\"https://static001.geekbang.org/resource/image/85/27/851e322ad9561715a30fc1ce79052027.png?wh=702*486\" alt=\"\"></p><p>你可以看到数据库CPU都用到这么高了？</p><p><img src=\"https://static001.geekbang.org/resource/image/f3/2b/f36982dff7c811cbe9d5ca8d9cf0862b.png?wh=912*124\" alt=\"\"></p><p>TPS能到259.2了，较之前的221.5没有提升多少。但是我们解决了swap的问题，还是有了一点点的提升。</p><p>那下一个瓶颈在哪里呢？通过上面的数据库资源来看，数据库早就已经被用到了100%的CPU，队列也嗖嗖地涨到了好几十，高的都\b超过100了。</p><p>可见我们在处理\b应用服务器的时候，数据库这边\b已经早就吃不消了。那下面，我们就先把应用服务器的优化部分放一下，再去分析下一个短板：数据库。</p><h3>后续性能工作建议</h3><p>但是这里并不是说应用服务器的优化工作就完成了，还有一些部分需要做的。</p><ol>\n<li>优化JVM配置参数，至于应该配置成什么值，还需要再测试，可能会有人说，这个测试人员怎么知道呢？请你相信，如果这个值性能\b测试人员都测试不出来的话，一般的架构师也不可能知道该设置为多少。</li>\n<li>通过监控分析确定swapiness的值。</li>\n<li>网络带宽又快到占满了，如果TPS再提高，网络肯定又支撑不了。</li>\n</ol><p>这些扣也都放在这里。因为我们主要是找到系统的短板，并一一解决，才能使整体的TPS增加，虽说现在应用服务器上还有优化的空间，但是现在它不是最短的板。</p><p>我们在不忘记应用服务器这些问题的同时，再将目光转向数据库。</p><h2>分析的第三阶段</h2><h3>瓶颈分析定位</h3><p>先来看看数据库的系统\b资源。</p><p><img src=\"https://static001.geekbang.org/resource/image/dc/c4/dc2569aa95f7eab54930c479ee8b04c4.png?wh=661*147\" alt=\"\"></p><p>我在很多场合都在强调一个词：证据链。所以基本上分析也会是从OS层面开始。</p><p>但是证据链这个词说起来容易理解，实际上要想真的有链起来的能力，必须具有基础知识，像分析数据库就更明显。因为当我们不了解系统架构时，想说明一个事情就非常困难。</p><p>像上面的这个top，显然us CPU使用率非常地高，idle几乎没有了，只有一个si占了5.7%，这个si并不算高，我们在上一阶段看到的应用服务器的si都已经达到了13%了。</p><p>我们说si的高或者低，倒不是关键，关键的是它有没有成为我们的瓶颈点。在这个系统中，us cpu才是我们要关注的重点，因为它实在是太高了。</p><p>对于一个数据库来说，要干的事情就是执行SQL。当分析多了数据库之后，基本上也形成了套路。不管怎么样，还是先看一下基本的监控信息，以下截取一些Spotlight on MySQL的有用的图，如果你没有这个工具，用其他的监控工具也是一样的。</p><p><img src=\"https://static001.geekbang.org/resource/image/bd/09/bd2d900a6d737649dcccf53c81584409.png?wh=587*825\" alt=\"\"></p><p>从上面的图可以看到，CPU使用率99%，Query Cache 是OFF的。记下这个位置！</p><p><img src=\"https://static001.geekbang.org/resource/image/c2/1d/c2c538d0c263c6e87d77b3b78402151d.png?wh=1449*913\" alt=\"\"></p><p>从上图看到，负载队列非常长，但Disk I/O没多少，说明队列和\bI/O无关，只是CPU的队列，非常好！</p><p>Network也不算大，进出每秒5000多个包，我们再来看一下网络用到多少了？</p><p><img src=\"https://static001.geekbang.org/resource/image/3e/c7/3eb362a32b7bcaabce509dbd790286c7.png?wh=390*62\" alt=\"\"></p><p>峰值也才70Mbps左右，即使是100Mbps带宽，现在仍然认为有余量（注意！我这里说有余量是因为我同时也检查了网络队列，并没有阻塞，并不是只看了这个值就武断地做了判断）。</p><p><img src=\"https://static001.geekbang.org/resource/image/cf/63/cf347ab9406ffcb3a281f1ef4a646263.png?wh=1328*403\" alt=\"\"></p><p><img src=\"https://static001.geekbang.org/resource/image/23/ec/23e8f83c88e76c1c44badabaea44deec.png?wh=1390*830\" alt=\"\"></p><p>通过上面的图可以看到，每秒执行2500-3000的SQL，Sorts per second达到800-1000，Sort rows per second达到8000-10000。</p><p>session用得倒是也不多，但Miss Rates在压力过程中Query Cache都是在100%，并且从最上面的summary中可以看到Query Cache也是OFF的。</p><p>为什么没有在看到Query Cache是OFF的时候就敲黑板呢，这是因为在一些应用中，如果不是查询多的话，这个值OFF也不能说有问题，但是在这个应用中几乎所有的语句都是select，那这个Query Cache再不打开就说不过去了呀。这里先记录下这个问题，待会我们的优化动作就是打开Query Cache。</p><p>不管怎么说，对一个数据库来说，主要是执行SQL嘛，而对MySQL来说，不看slow log，还能看什么呢。</p><p>通过整理slow log，看到如下内容：</p><pre><code># Overall: 280 total, 1 unique, 0.59 QPS, 9.53x concurrency ______________\n# Time range: 2019-09-26T13:44:08 to 2019-09-26T13:52:06\n# Attribute          total     min     max     avg     95%  stddev  median\n# ============     ======= ======= ======= ======= ======= ======= =======\n# Exec time          4555s     12s     19s     16s     18s      2s     16s\n# Lock time           52ms   130us   662us   185us   273us    53us   167us\n# Rows sent              0       0       0       0       0       0       0\n# Rows examine      30.81M 112.69k 112.69k 112.69k 112.69k       0 112.69k\n# Query size       186.48k     682     682     682     682       0     682\n\n\n# Profile\n# Rank Query ID           Response time    Calls R/Call  V/M   Item\n# ==== ================== ================ ===== ======= ===== ===========\n#    1 0xBED932B8C940697E 4555.0867 100.0%   280 16.2682  0.16 SELECT test2\n</code></pre><p>什么情况？只有1 unique？0.59TPS？我前面的TPS可是有259.2，\b这结果一看就感觉不对。</p><p>查看一下long_query_time，配置成了10s，怪不得看不到慢SQL。</p><p>改long_query_time为1s，再跑一遍。看到如下结果：</p><pre><code># Overall: 620.47k total, 30 unique, 259.39 QPS, 16.76x concurrency ______\n# Time range: 2019-09-26T13:44:08 to 2019-09-26T14:24:00\n# Attribute          total     min     max     avg     95%  stddev  median\n# ============     ======= ======= ======= ======= ======= ======= =======\n# Exec time         40082s    88us     23s    65ms   323ms   649ms   332us\n# Lock time            61s    30us   363ms    97us   152us     1ms    69us\n# Rows sent          1.92M       0     633    3.25   21.45    7.43    0.99\n# Rows examine     987.99M       0 112.69k   1.63k  10.29k   5.49k  420.77\n# Query size       240.33M      89   1.52k  406.15  833.10  258.19  246.02\n\n\n# Profile\n# Rank Query ID           Response time    Calls  R/Call  V/M   Item\n# ==== ================== ================ ====== ======= ===== ==========\n#    1 0x160FA75270C56FB8 22892.5442 57.1%  65352  0.3503  0.16 SELECT test1\n#    2 0xBED932B8C940697E 15914.4501 39.7%    986 16.1404  0.44 SELECT test2\n#    4 0xF0AE7AFA7851C7E8   245.0176  0.6%    175  1.4001  0.11 SELECT test3\n#    5 0xFB5A64603A53BFCE    97.2016  0.2%     77  1.2624  0.04 SELECT test4\n#   14 0x1E088E88CDC208BE     8.7701  0.0%     14  0.6264  0.23 SELECT test5\n</code></pre><p>嗯，这看着顺眼多了。前两个SQL占了所有执行时间的96.8%！第一个SQL平均执行时间350ms，方差16%。而第二个语句更夸张，平均执行时间16s，方差44%。这得收拾！</p><p>但是要不要优化这样的SQL，我们就需要根据SQL的分析和业务的分析来判断了。这里我先把执行计划列出来看看。</p><p>SQL1的执行计划：</p><p><img src=\"https://static001.geekbang.org/resource/image/77/69/7746e95a65b8ca2537672ccd5a474c69.png?wh=1272*80\" alt=\"\"></p><ol>\n<li>没有分区。</li>\n<li>不包含子查询或者union操作。</li>\n<li>全表扫描。</li>\n<li>第一个表所查有70行，第二个表所查有631行，此值仅做为参考，并不精准。</li>\n<li>第一个表返回结果只占了读取行数的1.43%（优化点），第二个表返回结果只占了0.16%（优化点）。</li>\n<li>在第一个表中，Extra有一个值，using where。</li>\n<li>在第二个表中，Extra有一个值，Range checked for each record (index map: 0x1) 。</li>\n</ol><p>SQL2的执行计划：</p><p><img src=\"https://static001.geekbang.org/resource/image/ec/c4/ecbcccf81290dc50cb6192782500cfc4.png?wh=1357*79\" alt=\"\"></p><ol>\n<li>没有分区。</li>\n<li>不包含子查询或者union操作。</li>\n<li>非唯一索引查找，也列出了具体的索引。</li>\n<li>第一个表索引列上有102570行，第二个表索引列上有118行。此值仅做为参考，并不精准。</li>\n<li>第一个表返回结果只占了读取行数的3.33%（优化点），第二个表返回结果占了100%。</li>\n<li>在第一个表中，Extra有三个值，using index condition; using where; using filesort。</li>\n<li>在第二个表中，Extra有一个值，using where。</li>\n</ol><p>这里我要\b敲黑板了！！！你是不是不记得Extra这些值的含义了？是不是要\b祭出你的搜索引擎，要开始查了！</p><p>我们这里再来回顾一遍。</p><p>using where：对结果用where子句中的条件过滤。</p><p>Range checked for each record (index map: 0x1)：MySQL没有找到可以使用的索引，如果前面的表的列值已知，可能会部分使用索引。</p><p>using index condition：先条件过滤索引，找到所有符合索引条件的数据行，再用where子句中的条件做过滤。</p><p>using filesort：Query中有Order \bBy操作，又无法用索引完成排序，MySQL不得不选择相应的排序算法来实现。是不是对应上了前面的sorts per second？</p><p>知道了这些基础知识之后，下面再来看一下，两句语句很显然都有优化的空间，尽量使用filtered的比例能大一些，至于能不能用到索引，那就看业务的需要了，如果确实是要查很大的索引，表扫还能快点。所以这两个语句，要丢给开发做业务分析了。</p><h3>优化结果</h3><p>对数据库，我们有两个优化的方向还记得吧，第一个是SQL语句，第二个是 Query Cache。</p><p>我们先做第2个，将Query Cache开启，看一下效果如何。</p><pre><code>mysql&gt; show variables like 'query_cache%';\n</code></pre><p>查看结果如下：</p><pre><code>query_cache_type  ON\nquery_cache_size  1048576\n</code></pre><p>再执行起来场景，看系统资源：</p><p><img src=\"https://static001.geekbang.org/resource/image/a5/b7/a5fb75d8b6af58760d2eb7f9976df4b7.png?wh=633*145\" alt=\"\"></p><p>效果还不错哦，us CPU降到了50%以下。</p><p><img src=\"https://static001.geekbang.org/resource/image/81/e9/81652d6852324114300d4b36355f31e9.png?wh=383*56\" alt=\"\"></p><p>网络峰值时能达到90Mbps了，又快把带宽占完了。</p><p>查看网络队列：</p><p><img src=\"https://static001.geekbang.org/resource/image/29/8c/297e4d951b9b1aa3e439137aab87598c.png?wh=202*514\" alt=\"\"></p><p>再检查下队列，这时看到已经有接收队列了。</p><p><img src=\"https://static001.geekbang.org/resource/image/4a/09/4a813c91a6a79d3ff359666c581f3c09.png?wh=1133*386\" alt=\"\"></p><p>从TPS上来看，现在能到300多一点，同时网络接收发送加在一起8M左右。</p><h3>后续性能工作建议</h3><p>接下来数据库的优化方向就是优化SQL。</p><p>当然还有别的优化建议，我们将在后面再说。</p><h2>总结</h2><p>这个案例\b从一个概括的描述开始，到各阶段的分析定位，是一个非常完整的过程。从一个项目的角度上来说，现在是不是性能已经达标，要有两方面的判断。</p><ol>\n<li>技术方面来说，显然这系统还有很多优化的空间，我们在文中也留了不少的扣。</li>\n<li>业务方面来说，系统是否可以上线，就取决于业务指标了。</li>\n</ol><p>但是这个性能是不是已经做得完整了呢？显然还没有。现在只是调了一个节点而已。因为这是在测试环境中做的，硬件环境显得非常简单。线上部署结构也会包括\b分布式多节点集群等。所以从一个性能项目的角度来说，还远远没有结束。我想如果把这个项目完整地写下来，一本书的容量应该不\b为过。</p><p>从技术细节上来说，通过几个阶段的具体操作，可以让你有一个性能分析定位的宏观感受，这也是这两篇内容的初衷。性能优化是无止境的，我们要做的是以最少的时间和金钱成本，达到最大的优化效果。</p><h2>思考题</h2><p>这一篇文章延续上一篇的分析思路，你能讲一下Swap的原理和逻辑，以及分析思路吗？另外，慢SQL如何定位出来呢？</p><p>欢迎你在评论区写下你的思考，也欢迎把这篇文章分享给你的朋友或者同事，一起交流一下。</p>","comments":[{"had_liked":false,"id":184553,"user_name":"Geek_8e5c47","can_delete":false,"product_type":"c1","uid":1168193,"ip_address":"","ucode":"82ED291D6F661D","user_header":"https://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTJUHvicvia3fpBfsNh78uuUIhsLyrk0AwSN1Dau7pR3hrEsERANT6UyrSd3gIBVyQibD2nPRzkibJLxibA/132","comment_is_top":false,"comment_ctime":1583336155,"is_pvip":false,"replies":[{"id":"71376","content":"网络是netstat。慢查询是pt-quest-digest。","user_name":"作者回复","user_name_real":"高楼(Zee)","uid":"1785562","ctime":1583377929,"ip_address":"","comment_id":184553,"utype":1}],"discussion_count":1,"race_medal":0,"score":"23058172635","product_id":100042501,"comment_content":"慢查询信息和网络信息是使用什么命令查看到的啊？","like_count":6,"discussions":[{"author":{"id":1785562,"avatar":"https://static001.geekbang.org/account/avatar/00/1b/3e/da/e686a72b.jpg","nickname":"高楼(Zee)","note":"","ucode":"149202404A5ABC","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":486053,"discussion_content":"网络是netstat。慢查询是pt-quest-digest。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1583377929,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":220753,"user_name":"凯","can_delete":false,"product_type":"c1","uid":1405256,"ip_address":"","ucode":"60DB11CF72C7B0","user_header":"https://static001.geekbang.org/account/avatar/00/15/71/48/44df7f4e.jpg","comment_is_top":false,"comment_ctime":1590318939,"is_pvip":false,"replies":[{"id":"81881","content":"根据TPS来计算需要多少带宽，扩大的手段很明确。<br>外网的就只能买了。<br>内网就是换网络设备（路由、交换、网线、网卡等），就看是哪里限制的了。<br>","user_name":"作者回复","user_name_real":"高楼(Zee)","uid":"1785562","ctime":1590712737,"ip_address":"","comment_id":220753,"utype":1}],"discussion_count":2,"race_medal":0,"score":"10180253531","product_id":100042501,"comment_content":"如果真得示客户网络带宽导致瓶颈，有什么推荐的方法，比如10M带宽，如果要扩大的话，需要怎么扩大。扩大的到什么程度，","like_count":2,"discussions":[{"author":{"id":1785562,"avatar":"https://static001.geekbang.org/account/avatar/00/1b/3e/da/e686a72b.jpg","nickname":"高楼(Zee)","note":"","ucode":"149202404A5ABC","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":496229,"discussion_content":"根据TPS来计算需要多少带宽，扩大的手段很明确。\n外网的就只能买了。\n内网就是换网络设备（路由、交换、网线、网卡等），就看是哪里限制的了。\n","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1590712737,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1895690,"avatar":"http://thirdwx.qlogo.cn/mmopen/vi_32/PiajxSqBRaEKM7ibRxGAUM3oGFCKv8P3ibiaAUXXovQkuic8oYjTfFW1REAU4Fic3P2ChMXD9CRcs4icUwHYtosicbqiciaw/132","nickname":"ayla00","note":"","ucode":"F28770C1A81ECA","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":583657,"discussion_content":"如果是在内网部署的云环境呢？怎么看带宽和网络瓶颈","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1660275284,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":"山东"},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":215905,"user_name":"nelson","can_delete":false,"product_type":"c1","uid":1271183,"ip_address":"","ucode":"773BE75A23C1C9","user_header":"","comment_is_top":false,"comment_ctime":1589130078,"is_pvip":false,"replies":[{"id":"81947","content":"查询缓存的使用是有适用的场景的。在查询多的应用中，打开查询缓存是会有用的。<br>","user_name":"作者回复","user_name_real":"高楼(Zee)","uid":"1785562","ctime":1590739430,"ip_address":"","comment_id":215905,"utype":1}],"discussion_count":3,"race_medal":0,"score":"10179064670","product_id":100042501,"comment_content":"对于为什么打开查询缓存，没有给出相关的表和SQL，没有任何理论依据，而是直接打开缓存尝试。颇有实践主义的色彩。<br>现在十分不建议打开查询缓存，一旦数据更新之前费劲建立起来的缓存都全部清空了，另外实在命中率不高涂层消耗，除非在非常特殊的场景<br>另外在My SQL 8.0中，干脆废掉了查询缓存","like_count":3,"discussions":[{"author":{"id":1785562,"avatar":"https://static001.geekbang.org/account/avatar/00/1b/3e/da/e686a72b.jpg","nickname":"高楼(Zee)","note":"","ucode":"149202404A5ABC","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":494606,"discussion_content":"查询缓存的使用是有适用的场景的。在查询多的应用中，打开查询缓存是会有用的。\n","likes_number":1,"is_delete":false,"is_hidden":false,"ctime":1590739430,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":2161228,"avatar":"","nickname":"Geek_6a9aeb","note":"","ucode":"3CF1DDF2677FAC","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":581712,"discussion_content":"说白就是经验尝试而已 不就是配置测试嘛","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1658932921,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1168579,"avatar":"https://static001.geekbang.org/account/avatar/00/11/d4/c3/d41e8c79.jpg","nickname":"不将就","note":"","ucode":"9BEC01AEE1D885","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":322456,"discussion_content":"确实，现在后端缓存基本都redis这种，基于业务去做了","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1604746120,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":191844,"user_name":"小老鼠","can_delete":false,"product_type":"c1","uid":1257460,"ip_address":"","ucode":"C663A0C863A515","user_header":"https://static001.geekbang.org/account/avatar/00/13/2f/f4/2dede51a.jpg","comment_is_top":false,"comment_ctime":1584799915,"is_pvip":false,"replies":[{"id":"73494","content":"这个问题过于宽泛了，但是本着认真的态度，还是回复一下吧。<br>对于性能测试环境，只有一个可信的答案，那就是：和生产一致。 <br>生产用什么配置，测试就用什么配置是最靠谱的。<br>但是我们经常会遇到的是硬件环境会有区别。所以经常会有人在硬件不同上钻牛角尖，而不去考虑系统特性以及什么资源影响最大。<br>如果是CPU资源使用最多，我们只要去对比CPU能力也能比较个大概。<br><br>而虚拟机和docker能不能用于性能测试？当然可以。不管什么环境，都可以用于性能测试。<br>而现在我们用于应用级别的机器基本上都是虚拟机和docker。这必然是可以用的。<br><br>其核心是，这套硬件能提供的能力到底是什么样。而不用纠结是虚拟机还是docker还是物理机。","user_name":"作者回复","user_name_real":"高楼(Zee)","uid":"1785562","ctime":1584840779,"ip_address":"","comment_id":191844,"utype":1}],"discussion_count":1,"race_medal":0,"score":"10174734507","product_id":100042501,"comment_content":"在虚拟机或dock环境中可进行性能测试吗？","like_count":3,"discussions":[{"author":{"id":1785562,"avatar":"https://static001.geekbang.org/account/avatar/00/1b/3e/da/e686a72b.jpg","nickname":"高楼(Zee)","note":"","ucode":"149202404A5ABC","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":488269,"discussion_content":"这个问题过于宽泛了，但是本着认真的态度，还是回复一下吧。\n对于性能测试环境，只有一个可信的答案，那就是：和生产一致。 \n生产用什么配置，测试就用什么配置是最靠谱的。\n但是我们经常会遇到的是硬件环境会有区别。所以经常会有人在硬件不同上钻牛角尖，而不去考虑系统特性以及什么资源影响最大。\n如果是CPU资源使用最多，我们只要去对比CPU能力也能比较个大概。\n\n而虚拟机和docker能不能用于性能测试？当然可以。不管什么环境，都可以用于性能测试。\n而现在我们用于应用级别的机器基本上都是虚拟机和docker。这必然是可以用的。\n\n其核心是，这套硬件能提供的能力到底是什么样。而不用纠结是虚拟机还是docker还是物理机。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1584840779,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":191153,"user_name":"每天晒白牙","can_delete":false,"product_type":"c1","uid":1004698,"ip_address":"","ucode":"A1B102CD933DEA","user_header":"https://static001.geekbang.org/account/avatar/00/0f/54/9a/76c0af70.jpg","comment_is_top":false,"comment_ctime":1584750831,"is_pvip":false,"replies":[{"id":"73361","content":"以后我尽量多写这样的。哈哈。","user_name":"作者回复","user_name_real":"高楼(Zee)","uid":"1785562","ctime":1584754855,"ip_address":"","comment_id":191153,"utype":1}],"discussion_count":1,"race_medal":1,"score":"10174685423","product_id":100042501,"comment_content":"老师的功力太深厚了，感觉性能测试要会的东西很多，测试，开发，运维，架构等等，我是小开发，看这种排查问题的文章真是爽，要是能在工作中这样酣畅淋漓的排查，爽啊","like_count":3,"discussions":[{"author":{"id":1785562,"avatar":"https://static001.geekbang.org/account/avatar/00/1b/3e/da/e686a72b.jpg","nickname":"高楼(Zee)","note":"","ucode":"149202404A5ABC","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":488125,"discussion_content":"以后我尽量多写这样的。哈哈。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1584754855,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":274178,"user_name":"alley","can_delete":false,"product_type":"c1","uid":1129217,"ip_address":"","ucode":"C46DB6F84DB74F","user_header":"https://static001.geekbang.org/account/avatar/00/11/3b/01/7a0bfa9a.jpg","comment_is_top":false,"comment_ctime":1610891959,"is_pvip":false,"replies":[{"id":"99806","content":"看带宽，要看使用率和队列两个角度。通常我是用iftop和netstat。你也可以用其他命令。 ","user_name":"作者回复","user_name_real":"高楼(Zee)","uid":"1785562","ctime":1611311595,"ip_address":"","comment_id":274178,"utype":1}],"discussion_count":1,"race_medal":0,"score":"5905859255","product_id":100042501,"comment_content":"老师查看网络带宽满的命令是什么","like_count":2,"discussions":[{"author":{"id":1785562,"avatar":"https://static001.geekbang.org/account/avatar/00/1b/3e/da/e686a72b.jpg","nickname":"高楼(Zee)","note":"","ucode":"149202404A5ABC","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":513933,"discussion_content":"看带宽，要看使用率和队列两个角度。通常我是用iftop和netstat。你也可以用其他命令。 ","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1611311595,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":267285,"user_name":"李大.shu","can_delete":false,"product_type":"c1","uid":1183657,"ip_address":"","ucode":"54EA36C78BB33A","user_header":"https://static001.geekbang.org/account/avatar/00/12/0f/a9/d55838b9.jpg","comment_is_top":false,"comment_ctime":1607669213,"is_pvip":false,"replies":[{"id":"97078","content":"压时间长一点，看有没有oom。","user_name":"作者回复","user_name_real":"高楼(Zee)","uid":"1785562","ctime":1607737739,"ip_address":"","comment_id":267285,"utype":1}],"discussion_count":1,"race_medal":0,"score":"5902636509","product_id":100042501,"comment_content":"老师，我在一次性能测试过程中，cache的值一直上升，然后将物理内存占满后，cache的值趋于稳定，程序用的used也趋于稳定(内存利用率在45%左右)。但通过vmstat统计观察swpd的值一直在上涨，通过jconsole查看也没有内存泄漏的问题。压测了48小时，tps和响应时间都在要求的指标范围内，这种情况算是正常情况吗，有没有风险，我担心swpd继续涨下去会有问题","like_count":1,"discussions":[{"author":{"id":1785562,"avatar":"https://static001.geekbang.org/account/avatar/00/1b/3e/da/e686a72b.jpg","nickname":"高楼(Zee)","note":"","ucode":"149202404A5ABC","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":511579,"discussion_content":"压时间长一点，看有没有oom。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1607737739,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":266560,"user_name":"孙奕意","can_delete":false,"product_type":"c1","uid":1523938,"ip_address":"","ucode":"A591F865950397","user_header":"https://static001.geekbang.org/account/avatar/00/17/40/e2/c464a6f7.jpg","comment_is_top":false,"comment_ctime":1607394871,"is_pvip":false,"replies":[{"id":"96845","content":"jvirsualvm，远程用jmx就能连。","user_name":"作者回复","user_name_real":"高楼(Zee)","uid":"1785562","ctime":1607480813,"ip_address":"","comment_id":266560,"utype":1}],"discussion_count":1,"race_medal":0,"score":"5902362167","product_id":100042501,"comment_content":"文中JVM截图是jconsole工具的？在liunx系统上也可以用jconsole 进行JVM监控的吗？","like_count":1,"discussions":[{"author":{"id":1785562,"avatar":"https://static001.geekbang.org/account/avatar/00/1b/3e/da/e686a72b.jpg","nickname":"高楼(Zee)","note":"","ucode":"149202404A5ABC","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":511312,"discussion_content":"jvirsualvm，远程用jmx就能连。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1607480813,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":201128,"user_name":"TavisD","can_delete":false,"product_type":"c1","uid":1170820,"ip_address":"","ucode":"06421DD138ECAF","user_header":"https://static001.geekbang.org/account/avatar/00/11/dd/84/fe116a80.jpg","comment_is_top":false,"comment_ctime":1585720853,"is_pvip":false,"replies":[{"id":"75235","content":"这个没有区分，什么场景下发现问题就什么时候调。","user_name":"作者回复","user_name_real":"高楼(Zee)","uid":"1785562","ctime":1585726499,"ip_address":"","comment_id":201128,"utype":1}],"discussion_count":1,"race_medal":0,"score":"5880688149","product_id":100042501,"comment_content":"高老师，请教下JVM配置是用哪种测试场景去调优呢。比如系统有好几个应用，测试场景也有基准测试、混合测试，那是测基准测试时去调优JVM配置？还是混合测试时？还是所有的场景都要去做这个JVM调优配置？如果出现多个场景JVM的最佳配置不一样，是以哪个为准？","like_count":1,"discussions":[{"author":{"id":1785562,"avatar":"https://static001.geekbang.org/account/avatar/00/1b/3e/da/e686a72b.jpg","nickname":"高楼(Zee)","note":"","ucode":"149202404A5ABC","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":490248,"discussion_content":"这个没有区分，什么场景下发现问题就什么时候调。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1585726499,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":181181,"user_name":"hello","can_delete":false,"product_type":"c1","uid":1464199,"ip_address":"","ucode":"854500026E2187","user_header":"http://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTKhuGLVRYZibOTfMumk53Wn8Q0Rkg0o6DzTicbibCq42lWQoZ8lFeQvicaXuZa7dYsr9URMrtpXMVDDww/132","comment_is_top":false,"comment_ctime":1582513451,"is_pvip":false,"replies":[{"id":"70273","content":"多谢支持，你的收获就是我的动力。","user_name":"作者回复","user_name_real":"高楼(Zee)","uid":"1785562","ctime":1582520308,"ip_address":"","comment_id":181181,"utype":1}],"discussion_count":1,"race_medal":0,"score":"5877480747","product_id":100042501,"comment_content":"老师这两篇案例分析特别流畅，一口气看完，思路真的很清晰，感谢老师！","like_count":1,"discussions":[{"author":{"id":1785562,"avatar":"https://static001.geekbang.org/account/avatar/00/1b/3e/da/e686a72b.jpg","nickname":"高楼(Zee)","note":"","ucode":"149202404A5ABC","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":484949,"discussion_content":"多谢支持，你的收获就是我的动力。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1582520308,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":328282,"user_name":"Rachel","can_delete":false,"product_type":"c1","uid":1170712,"ip_address":"","ucode":"BD500B41764660","user_header":"https://static001.geekbang.org/account/avatar/00/11/dd/18/a51730da.jpg","comment_is_top":false,"comment_ctime":1640653603,"is_pvip":false,"replies":[{"id":"119584","content":"那就要有agent来收集数据了。","user_name":"作者回复","user_name_real":"编辑","uid":"1785562","ctime":1640686366,"ip_address":"","comment_id":328282,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1640653603","product_id":100042501,"comment_content":"监控工具可以安装在独立于应用服务器、数据库服务器、压力机等之外机器吗？","like_count":0,"discussions":[{"author":{"id":1785562,"avatar":"https://static001.geekbang.org/account/avatar/00/1b/3e/da/e686a72b.jpg","nickname":"高楼(Zee)","note":"","ucode":"149202404A5ABC","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":542229,"discussion_content":"那就要有agent来收集数据了。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1640686366,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":319734,"user_name":"林义的奥妙","can_delete":false,"product_type":"c1","uid":1982685,"ip_address":"","ucode":"3BD27CC75D0919","user_header":"https://static001.geekbang.org/account/avatar/00/1e/40/dd/a79ca0f0.jpg","comment_is_top":false,"comment_ctime":1635924887,"is_pvip":false,"replies":[{"id":"115951","content":"文中的意思是因为jvm只用到1.5G才把因为降一半。","user_name":"作者回复","user_name_real":"高楼(Zee)","uid":"1785562","ctime":1635984475,"ip_address":"","comment_id":319734,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1635924887","product_id":100042501,"comment_content":"老师，JVM的堆设置为原来的一半之后，为什么使用率就降底到1.5G左右？","like_count":0,"discussions":[{"author":{"id":1785562,"avatar":"https://static001.geekbang.org/account/avatar/00/1b/3e/da/e686a72b.jpg","nickname":"高楼(Zee)","note":"","ucode":"149202404A5ABC","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":529748,"discussion_content":"文中的意思是因为jvm只用到1.5G才把因为降一半。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1635984475,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":315880,"user_name":"lin~","can_delete":false,"product_type":"c1","uid":1786399,"ip_address":"","ucode":"6FFE0CE701E265","user_header":"https://thirdwx.qlogo.cn/mmopen/vi_32/VHujEJQglWzlG82auxYg4ibLccovhB8jBD1SMvqWZPdNf6fhTgK5wic5WHqbnR5sZF5Agrwgw39Q30Ccmib81qwBA/132","comment_is_top":false,"comment_ctime":1634029929,"is_pvip":false,"replies":[{"id":"114809","content":"在性能测试中，不建议使用swap。","user_name":"作者回复","user_name_real":"高楼(Zee)","uid":"1785562","ctime":1634690288,"ip_address":"","comment_id":315880,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1634029929","product_id":100042501,"comment_content":"老师，swap飘黄的逻辑有些疑问，这里swapiness设置为30，如果设置为80的话，在available mem不够的情况下还会飘黄么","like_count":0,"discussions":[{"author":{"id":1785562,"avatar":"https://static001.geekbang.org/account/avatar/00/1b/3e/da/e686a72b.jpg","nickname":"高楼(Zee)","note":"","ucode":"149202404A5ABC","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":528190,"discussion_content":"在性能测试中，不建议使用swap。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1634690288,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":272977,"user_name":"alley","can_delete":false,"product_type":"c1","uid":1129217,"ip_address":"","ucode":"C46DB6F84DB74F","user_header":"https://static001.geekbang.org/account/avatar/00/11/3b/01/7a0bfa9a.jpg","comment_is_top":false,"comment_ctime":1610375452,"is_pvip":false,"replies":[{"id":"99030","content":"多谢支持鼓励。","user_name":"作者回复","user_name_real":"高楼(Zee)","uid":"1785562","ctime":1610533535,"ip_address":"","comment_id":272977,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1610375452","product_id":100042501,"comment_content":"好厉害啊，干货满满，像侦探片一样，引人入胜。","like_count":0,"discussions":[{"author":{"id":1785562,"avatar":"https://static001.geekbang.org/account/avatar/00/1b/3e/da/e686a72b.jpg","nickname":"高楼(Zee)","note":"","ucode":"149202404A5ABC","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":513444,"discussion_content":"多谢支持鼓励。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1610533535,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":215076,"user_name":"万伟","can_delete":false,"product_type":"c1","uid":1975168,"ip_address":"","ucode":"0003AE49679705","user_header":"","comment_is_top":false,"comment_ctime":1588900912,"is_pvip":false,"replies":[{"id":"81968","content":"这个问题太笼统了。","user_name":"作者回复","user_name_real":"高楼(Zee)","uid":"1785562","ctime":1590744057,"ip_address":"","comment_id":215076,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1588900912","product_id":100042501,"comment_content":"您好，请问一下，Spotlight on Linux配置好ssh连接后，点connect为什么总报conection lost?<br>环境：<br>本地：win7          SpotlightonUnix_70.exe<br>linux：centos7","like_count":0,"discussions":[{"author":{"id":1785562,"avatar":"https://static001.geekbang.org/account/avatar/00/1b/3e/da/e686a72b.jpg","nickname":"高楼(Zee)","note":"","ucode":"149202404A5ABC","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":494304,"discussion_content":"这个问题太笼统了。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1590744057,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":181911,"user_name":"tt","can_delete":false,"product_type":"c1","uid":1489957,"ip_address":"","ucode":"7753B79AD5A9AC","user_header":"https://static001.geekbang.org/account/avatar/00/16/bc/25/1c92a90c.jpg","comment_is_top":false,"comment_ctime":1582678638,"is_pvip":false,"replies":[{"id":"70444","content":"哈哈，啥叫尸检？","user_name":"作者回复","user_name_real":"高楼(Zee)","uid":"1785562","ctime":1582683635,"ip_address":"","comment_id":181911,"utype":1}],"discussion_count":2,"race_medal":0,"score":"1582678638","product_id":100042501,"comment_content":"应用开发人员，但是啥都可能干，包括部分运维，还有性能和安全。对我来说，这两节课我要记住的就是：主机（节点）压不出来，那就是路（网络）出了问题。<br><br>遇到过的问题是网络链接释放不干净，导致CLOSE_WAIT大量出现，最后内存使用过多，导致进城挂了的事。作为开发，那时还没有这么多分析操作系统的知识。只能从网络一点着手。<br><br>老师能不能再补充一些事故后的“尸检”环节呀？","like_count":0,"discussions":[{"author":{"id":1785562,"avatar":"https://static001.geekbang.org/account/avatar/00/1b/3e/da/e686a72b.jpg","nickname":"高楼(Zee)","note":"","ucode":"149202404A5ABC","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":485165,"discussion_content":"哈哈，啥叫尸检？","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1582683635,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1489957,"avatar":"https://static001.geekbang.org/account/avatar/00/16/bc/25/1c92a90c.jpg","nickname":"tt","note":"","ucode":"7753B79AD5A9AC","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":186471,"discussion_content":"就是进程挂了以后，在生产现场直接分析，快速的得到一些直接的、初步的结论","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1582683859,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":181817,"user_name":"夜空中最亮的星","can_delete":false,"product_type":"c1","uid":1267566,"ip_address":"","ucode":"ADC3E7B6789955","user_header":"https://static001.geekbang.org/account/avatar/00/13/57/6e/b6795c44.jpg","comment_is_top":false,"comment_ctime":1582639153,"is_pvip":false,"replies":[{"id":"70427","content":"多谢支持，这样的案例我有很多。我只是随意选择几个。😀😀","user_name":"作者回复","user_name_real":"高楼(Zee)","uid":"1785562","ctime":1582674434,"ip_address":"","comment_id":181817,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1582639153","product_id":100042501,"comment_content":"这两篇案例很棒","like_count":0,"discussions":[{"author":{"id":1785562,"avatar":"https://static001.geekbang.org/account/avatar/00/1b/3e/da/e686a72b.jpg","nickname":"高楼(Zee)","note":"","ucode":"149202404A5ABC","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":485130,"discussion_content":"多谢支持，这样的案例我有很多。我只是随意选择几个。😀😀","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1582674434,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":181126,"user_name":"老姜","can_delete":false,"product_type":"c1","uid":1019835,"ip_address":"","ucode":"FB7962F08A9F3B","user_header":"https://static001.geekbang.org/account/avatar/00/0f/8f/bb/7068f251.jpg","comment_is_top":false,"comment_ctime":1582498418,"is_pvip":false,"replies":[{"id":"70275","content":"本篇用的是spotlight。","user_name":"作者回复","user_name_real":"高楼(Zee)","uid":"1785562","ctime":1582520374,"ip_address":"","comment_id":181126,"utype":1}],"discussion_count":1,"race_medal":3,"score":"1582498418","product_id":100042501,"comment_content":"mysql用的是什么监控工具？","like_count":1,"discussions":[{"author":{"id":1785562,"avatar":"https://static001.geekbang.org/account/avatar/00/1b/3e/da/e686a72b.jpg","nickname":"高楼(Zee)","note":"","ucode":"149202404A5ABC","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":484929,"discussion_content":"本篇用的是spotlight。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1582520374,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]}]}